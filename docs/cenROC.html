<!DOCTYPE html><html lang="en"><head><title>Help for package cenROC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cenROC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cenROC'><p>Estimation of the time-dependent ROC curve for right censored survival data</p></a></li>
<li><a href='#condS'><p>Compute the conditional survival function for Interval Censored Survival Data</p></a></li>
<li><a href='#Csurv'><p>Survival probability conditional to the observed data estimation for right censored data.</p></a></li>
<li><a href='#CV'><p>The cross-validation bandwidth selection for weighted data</p></a></li>
<li><a href='#dnorkernel'><p>Derivative of normal distribution</p></a></li>
<li><a href='#hds'><p>NASA Hypobaric Decompression Sickness Marker Data</p></a></li>
<li><a href='#ICsur'><p>Survival probability conditional on the observed data estimation for interval censored data</p></a></li>
<li><a href='#integ'><p>Numerical Integral function using Simpson's rule</p></a></li>
<li><a href='#IntROC'><p>Time-dependent ROC curve estimation for interval-censored survival data</p></a></li>
<li><a href='#ker_dis_i'><p>Distribution function without the ith observation</p></a></li>
<li><a href='#kfunc'><p>Function to evaluate the matrix of data vector minus the grid points divided by the bandwidth value.</p></a></li>
<li><a href='#kfunction'><p>Kernel distribution function</p></a></li>
<li><a href='#mayo'><p>Mayo Marker Data</p></a></li>
<li><a href='#muro'><p>The value of squared integral x^2 k(x) dx and integral x k(x) K(x) dx</p></a></li>
<li><a href='#NR'><p>The normal reference bandwidth selection for weighted data</p></a></li>
<li><a href='#PI'><p>The plug-in bandwidth selection for weighted data</p></a></li>
<li><a href='#RocFun'><p>ROC estimation function</p></a></li>
<li><a href='#wbw'><p>Function to select the bandwidth parameter needed for smoothing the time-dependent ROC curve.</p></a></li>
<li><a href='#wIQR'><p>Weighted inter-quartile range estimation</p></a></li>
<li><a href='#wquantile'><p>Weighted quartile estimation</p></a></li>
<li><a href='#wvar'><p>Weighted variance estimation</p></a></li>
<li><a href='#youden'><p>Computes optimal cutoff point using the Youden index criteria</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating Time-Dependent ROC Curve and AUC for Censored Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions to estimate a smoothed and a non-smoothed (empirical) time-dependent 
             receiver operating characteristic curve and the corresponding area under the receiver 
             operating characteristic curve and the optimal cutoff point for the right and interval 
             censored survival data. See Beyene and El Ghouch (2020)&lt;<a href="https://doi.org/10.1002%2Fsim.8671">doi:10.1002/sim.8671</a>&gt; and Beyene 
             and El Ghouch (2022) &lt;<a href="https://doi.org/10.1002%2Fbimj.202000382">doi:10.1002/bimj.202000382</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.0), icenReg, condSURV, survival, stats, graphics,
methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-27 03:57:11 UTC; m2kas</td>
</tr>
<tr>
<td>Author:</td>
<td>Kassu Mehari Beyene [aut, cre],
  Anouar El Ghouch [aut, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kassu Mehari Beyene &lt;kassu.mehari@wu.edu.et&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-27 08:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='cenROC'>Estimation of the time-dependent ROC curve for right censored survival data</h2><span id='topic+cenROC'></span>

<h3>Description</h3>

<p>This function computes the time-dependent ROC curve for right censored survival data using the cumulative sensitivity and dynamic specificity definitions.
The ROC curves can be either empirical (non-smoothed) or smoothed with/wtihout boundary correction. It also calculates the time-dependent area under the ROC curve (AUC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenROC(Y, M, censor, t, U = NULL, h = NULL, bw = "NR", method = "tra",
    ktype = "normal", ktype1 = "normal", B = 0, alpha = 0.05, plot = "TRUE")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenROC_+3A_y">Y</code></td>
<td>
<p>The numeric vector of event-times or observed times.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_m">M</code></td>
<td>
<p>The numeric vector of marker values for which the time-dependent ROC curves is computed.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_censor">censor</code></td>
<td>
<p>The censoring indicator, <code>1</code> if event, <code>0</code> otherwise.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_t">t</code></td>
<td>
<p>A scaler time point at which the time-dependent ROC curve is computed.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_u">U</code></td>
<td>
<p>The vector of grid points where the ROC curve is estimated. The default is a sequence of <code>151</code> numbers between <code>0</code> and <code>1</code>.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_h">h</code></td>
<td>
<p>A scaler for the bandwidth of Beran's weight calculaions. The defualt is the value obtained by using the method of Sheather and Jones (1991).</p>
</td></tr>
<tr><td><code id="cenROC_+3A_bw">bw</code></td>
<td>
<p>A character string specifying the bandwidth estimation method for the ROC itself. The possible options are &quot;<code>NR</code>&quot; for the normal reference, the plug-in &quot;<code>PI</code>&quot; and the cross-validation &quot;<code>CV</code>&quot;. The default is the &quot;<code>NR</code>&quot; normal reference method. The user can also introduce a numerical value.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_method">method</code></td>
<td>
<p>The method of ROC curve estimation. The possible options are &quot;<code>emp</code>&quot; emperical metod; &quot;<code>untra</code>&quot; smooth without boundary correction and &quot;<code>tra</code>&quot; is smooth ROC curve estimation with boundary correction. The default is the &quot;<code>tra</code>&quot; smooth ROC curve estimate with boundary correction.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel distribution to be used for smoothing the ROC curve: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;. By default, the &quot;<code>normal</code>&quot; kernel is used.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_ktype1">ktype1</code></td>
<td>
<p>A character string specifying the desired kernel needed for Beran weight calculation. The possible options are &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>tricube</code>&quot;, &quot;<code>boxcar</code>&quot;, &quot;<code>triangular</code>&quot;, or &quot;<code>quartic</code>&quot;. The defaults is &quot;<code>normal</code>&quot; kernel density.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_b">B</code></td>
<td>
<p>The number of bootstrap samples to be used for variance estimation. The default is <code>0</code>, no variance estimation.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. The default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="cenROC_+3A_plot">plot</code></td>
<td>
<p>The logical parameter to see the ROC curve plot. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The empirical (non-smoothed) ROC estimate and the smoothed ROC estimate with/without boundary correction can be obtained using this function.
The smoothed ROC curve estimators require selecting two bandwidth parametrs: one for Beran’s weight calculation and one for smoothing the ROC curve.
For the latter, three data-driven methods: the normal reference &quot;<code>NR</code>&quot;, the plug-in &quot;<code>PI</code>&quot; and the cross-validation &quot;<code>CV</code>&quot; were implemented.
To select the bandwidth parameter needed for Beran’s weight calculation, by default, the plug-in method of Sheather and Jones (1991) is used but it is also possible introduce a numeric value.
See Beyene and El Ghouch (2020) for details.
</p>


<h3>Value</h3>

<p>Returns the following items:
</p>
<p><code>ROC     </code> The vector of estimated ROC values. These will be numeric numbers between zero
</p>
<p> and one.
</p>
<p><code>U       </code> The vector of grid points used.
</p>
<p><code>AUC      </code> A data frame of dimension <code class="reqn">1 \times 4</code>. The columns are: AUC, standard error of AUC, the lower
</p>
<p>               and upper limits of bootstrap CI.
</p>
<p><code>bw       </code> The computed value of bandwidth. For the empirical method this is always <code>NA</code>.
</p>
<p><code>Dt      </code> The vector of estimated event status.
</p>
<p><code>M       </code> The vector of Marker values.
</p>


<h3>Author(s)</h3>

<p>Kassu Mehari Beyene and Anouar El Ghouch
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2020). Smoothed time-dependent receiver operating characteristic curve for right censored survival data. <em>Statistics in Medicine</em>. 39: 3373– 3396.
</p>
<p>Sheather, S. J. and Jones, M. C. (1991). A Reliable data-based bandwidth selection method for kernel density estimation. <em>Journal of the Royal Statistical Society</em>. Series B (Methodological) 53(3): 683–690.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cenROC)

data(mayo)

est = cenROC(Y=mayo$time, M=mayo$mayoscore5, censor=mayo$censor, t=365*6)
est$AUC

</code></pre>

<hr>
<h2 id='condS'>Compute the conditional survival function for Interval Censored Survival Data</h2><span id='topic+condS'></span>

<h3>Description</h3>

<p>A method to compute the survival function for the
interval censored survival data based on a spline function based constrained
maximum likelihood estimator. The maximization process of likelihood is
carried out by generalized gradient projection method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>condS(L, R, M, Delta, t, m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="condS_+3A_l">L</code></td>
<td>
<p>The numericvector of left limit of observed time. For left censored observations <code>L == 0</code>.</p>
</td></tr>
<tr><td><code id="condS_+3A_r">R</code></td>
<td>
<p>The numericvector of right limit of observed time. For right censored observation <code>R == inf</code>.</p>
</td></tr>
<tr><td><code id="condS_+3A_m">M</code></td>
<td>
<p>An array contains marker levels for the samples.</p>
</td></tr>
<tr><td><code id="condS_+3A_delta">Delta</code></td>
<td>
<p>An array of indicator for the censored type, use 1, 2, 3 for
event happened before the left bound time, within the defined time range, and
after.</p>
</td></tr>
<tr><td><code id="condS_+3A_t">t</code></td>
<td>
<p>A scalar indicates the predict time.</p>
</td></tr>
<tr><td><code id="condS_+3A_m">m</code></td>
<td>
<p>A scalar for the cutoff of the marker variable.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wu, Yuan; Zhang, Ying. Partially monotone tensor spline estimation
of the joint distribution function with bivariate current status data.
Ann. Statist. 40, 2012, 1609-1636 &lt;doi:10.1214/12-AOS1016&gt;
</p>

<hr>
<h2 id='Csurv'>Survival probability conditional to the observed data estimation for right censored data.</h2><span id='topic+Csurv'></span>

<h3>Description</h3>

<p>Survival probability conditional to the observed data estimation for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Csurv(Y, M, censor, t, h = NULL, kernel = "normal")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Csurv_+3A_y">Y</code></td>
<td>
<p>The numeric vector of event-times or observed times.</p>
</td></tr>
<tr><td><code id="Csurv_+3A_m">M</code></td>
<td>
<p>The numeric vector of marker values for which we want to compute the time-dependent ROC curves.</p>
</td></tr>
<tr><td><code id="Csurv_+3A_censor">censor</code></td>
<td>
<p>The censoring indicator, <code>1</code> if event, <code>0</code> otherwise.</p>
</td></tr>
<tr><td><code id="Csurv_+3A_t">t</code></td>
<td>
<p>A scaler time point at which we want to compute the time-dependent ROC curve.</p>
</td></tr>
<tr><td><code id="Csurv_+3A_h">h</code></td>
<td>
<p>A scaler for the bandwidth of Beran's weight calculaions. The defualt is using the method of Sheather and Jones (1991).</p>
</td></tr>
<tr><td><code id="Csurv_+3A_kernel">kernel</code></td>
<td>
<p>A character string giving the type kernel to be used: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, , &quot;<code>tricube</code>&quot;, &quot;<code>boxcar</code>&quot;, &quot;<code>triangular</code>&quot;, or &quot;<code>quartic</code>&quot;. The defaults is &quot;<code>normal</code>&quot; kernel density.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a vectors:
</p>
<p><code>positive    </code>    <code>P(T&lt;t|Y,censor,M)</code>.
</p>
<p><code>negative    </code>     <code>P(T&gt;t|Y,censor,M)</code>.
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2020). Smoothed time-dependent receiver operating characteristic curve for right censored survival data. <em>Statistics in Medicine</em>. 39: 3373– 3396.
</p>
<p>Li, Liang, Bo Hu and Tom Greene (2018).  A simple method to estimate the time-dependent receiver operating characteristic curve and the area under the curve with right censored data, <em>Statistical Methods in Medical Research</em>, 27(8): 2264-2278.
</p>
<p>Pablo Martínez-Camblor and Gustavo F. Bayón and Sonia Pérez-Fernández (2016). Cumulative/dynamic roc curve estimation, <em>Journal of Statistical Computation and Simulation</em>, 86(17): 3582-3594.
</p>

<hr>
<h2 id='CV'>The cross-validation bandwidth selection for weighted data</h2><span id='topic+CV'></span>

<h3>Description</h3>

<p>This function computes the data-driven bandwidth for smoothing the ROC (or distribution) function using the CV method of Beyene and El Ghouch (2020). This is an extension of the classical (unweighted) cross-validation bandwith selection method to the case of weighted data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CV(X, wt, ktype = "normal")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CV_+3A_x">X</code></td>
<td>
<p>The numeric data vector.</p>
</td></tr>
<tr><td><code id="CV_+3A_wt">wt</code></td>
<td>
<p>The non-negative weight vector.</p>
</td></tr>
<tr><td><code id="CV_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel to be used: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;. By default, the &quot;<code>normal</code>&quot; kernel is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bowman et al (1998) proposed the cross-validation bandwidth selection method for unweighted kernal smoothed distribution function. This method is implemented in the <code>R</code> package <code>kerdiest</code>.
We adapted this for the case of weighted data by incorporating the weight variable into the cross-validation function of Bowman's method. See Beyene and El Ghouch (2020) for details.
</p>


<h3>Value</h3>

<p>Returns the computed value for the bandwith parameter.
</p>


<h3>Author(s)</h3>

<p>Kassu Mehari Beyene and Anouar El Ghouch
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2020). Smoothed time-dependent receiver operating characteristic curve for right censored survival data. <em>Statistics in Medicine</em>. 39: 3373– 3396.
</p>
<p>Bowman A., Hall P. and Trvan T.(1998). Bandwidth selection for the smoothing of distribution functions. <em>Biometrika</em> 85:799-808.
</p>
<p>Quintela-del-Rio, A. and Estevez-Perez, G. (2015). <code>kerdiest:</code> Nonparametric kernel estimation of the distribution function, bandwidth selection and estimation of related functions. <code>R</code> package version 1.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cenROC)

X &lt;- rnorm(100) # random data vector
wt &lt;- runif(100) # weight vector

## Cross-validation bandwidth selection
CV(X = X, wt = wt)$bw


</code></pre>

<hr>
<h2 id='dnorkernel'>Derivative of normal distribution</h2><span id='topic+dnorkernel'></span>

<h3>Description</h3>

<p>Derivative of normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dnorkernel(ord, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dnorkernel_+3A_ord">ord</code></td>
<td>
<p>The order of derivative.</p>
</td></tr>
<tr><td><code id="dnorkernel_+3A_x">X</code></td>
<td>
<p>The numeric data vector.</p>
</td></tr>
</table>

<hr>
<h2 id='hds'>NASA Hypobaric Decompression Sickness Marker Data</h2><span id='topic+hds'></span>

<h3>Description</h3>

<p>This data contains the marker values with the left and right limits of the observed time for the subjects in NASA Hypobaric Decompression Sickness Data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hds)
</code></pre>


<h3>Format</h3>

<p>This is a data frame with 238 observations and 3 variables: L (left limit of the observed time), R (right limit of the observed time)
and M (marker). The marker is a score derived by combining the covariates Age, Sex, TR360, and Noadyn.
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2022). Time-dependent ROC curve estimation for interval-censored data. <em>Biometrical Journal</em>, 64, 1056– 1074.
</p>

<hr>
<h2 id='ICsur'>Survival probability conditional on the observed data estimation for interval censored data</h2><span id='topic+ICsur'></span>

<h3>Description</h3>

<p>Survival probability conditional on the observed data estimation for interval censored data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICsur(L, R, M, t, method, dist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ICsur_+3A_l">L</code></td>
<td>
<p>The numericvector of left limit of observed time. For left censored observations <code>L == 0</code>.</p>
</td></tr>
<tr><td><code id="ICsur_+3A_r">R</code></td>
<td>
<p>The numericvector of right limit of observed time. For right censored observation <code>R == inf</code>.</p>
</td></tr>
<tr><td><code id="ICsur_+3A_m">M</code></td>
<td>
<p>The numeric vector of marker value.</p>
</td></tr>
<tr><td><code id="ICsur_+3A_t">t</code></td>
<td>
<p>A scaler time point used to calculate the the ROC curve</p>
</td></tr>
<tr><td><code id="ICsur_+3A_method">method</code></td>
<td>
<p>A character indication type of modeling. This include nonparametric <code>"np"</code>,parmetric <code>"pa"</code> and semiparametric <code>"sp"</code>.</p>
</td></tr>
<tr><td><code id="ICsur_+3A_dist">dist</code></td>
<td>
<p>A character incating the type of distribution for parametric model. This includes are <code>"exponential"</code>, <code>"weibull"</code>, <code>"gamma"</code>, <code>"lnorm"</code>, <code>"loglogistic"</code> and <code>"generalgamma"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a vectors:
</p>
<p><code>positive    </code>    <code>P(T&lt;t|L,R,M)</code>.
</p>
<p><code>negative    </code>     <code>P(T&gt;t|L,R,M)</code>.
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2022). Time-dependent ROC curve estimation for interval-censored data. <em>Biometrical Journal</em>, 64, 1056– 1074.
</p>

<hr>
<h2 id='integ'>Numerical Integral function using Simpson's rule</h2><span id='topic+integ'></span>

<h3>Description</h3>

<p>Numerical Integral function using Simpson's rule
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integ(x, fx, method, n.pts = 256)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="integ_+3A_x">x</code></td>
<td>
<p>The numeric data vector.</p>
</td></tr>
<tr><td><code id="integ_+3A_fx">fx</code></td>
<td>
<p>The function.</p>
</td></tr>
<tr><td><code id="integ_+3A_method">method</code></td>
<td>
<p>The character string specifying method of numerical integration. The possible options are <code>trap</code> for trapezoidal rule and <code>simps</code> for simpson'r rule.</p>
</td></tr>
<tr><td><code id="integ_+3A_n.pts">n.pts</code></td>
<td>
<p>Number of points.</p>
</td></tr>
</table>

<hr>
<h2 id='IntROC'>Time-dependent ROC curve estimation for interval-censored survival data</h2><span id='topic+IntROC'></span>

<h3>Description</h3>

<p>This function computes the time-dependent ROC curve for interval censored survival data using the cumulative sensitivity and dynamic specificity definitions.
The ROC curves can be either empirical (non-smoothed) or smoothed with/without boundary correction. It also calculates the time-dependent AUC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IntROC(L, R, M, t, U = NULL, method = "emp", method2 = "pa", dist = "weibull",
        bw = NULL, ktype = "normal", len = 151, B = 0, alpha = 0.05, plot = "TRUE")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IntROC_+3A_l">L</code></td>
<td>
<p>The numericvector of left limit of observed time. For left censored observations <code>L == 0</code>.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_r">R</code></td>
<td>
<p>The numericvector of right limit of observed time. For right censored observation <code>R == inf</code>.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_m">M</code></td>
<td>
<p>The numeric vector of marker values.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_t">t</code></td>
<td>
<p>A scaler time point used to calculate the ROC curve.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_u">U</code></td>
<td>
<p>The numeric vector of cutoff values.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_method">method</code></td>
<td>
<p>The method of ROC curve estimation. The possible options are &quot;<code>emp</code>&quot; empirical metod; &quot;<code>untra</code>&quot; smooth without boundary correction and &quot;<code>tra</code>&quot; is smooth ROC curve estimation with boundary correction. The default is the &quot;<code>emp</code>&quot; empirical method.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_method2">method2</code></td>
<td>
<p>A character indication type of modeling. This include nonparametric <code>"np"</code>, parmetric <code>"pa"</code> and semiparametric <code>"sp"</code>. The default is the &quot;<code>np</code>&quot; parametric with weibull distribution.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_dist">dist</code></td>
<td>
<p>A character incating the type of distribution for parametric model. This includes are <code>"exponential"</code>, <code>"weibull"</code>, <code>"gamma"</code>, <code>"lnorm"</code>, <code>"loglogistic"</code> and <code>"generalgamma"</code>.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_bw">bw</code></td>
<td>
<p>A character string specifying the bandwidth estimation method. The possible options are &quot;<code>NR</code>&quot; for the normal reference, the plug-in &quot;<code>PI</code>&quot; and the cross-validation &quot;<code>CV</code>&quot;. The default is the &quot;<code>NR</code>&quot; normal reference method. It is also possible to use a numeric value.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel distribution to be used for smoothing the ROC curve: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;. By default, the &quot;<code>normal</code>&quot; kernel is used.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_len">len</code></td>
<td>
<p>The length of the grid points for ROC estimation. Default is <code>151</code>.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_b">B</code></td>
<td>
<p>The number of bootstrap samples to be used for variance estimation. The default is <code>0</code>, no variance estimation.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_alpha">alpha</code></td>
<td>
<p>The significance level. The default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="IntROC_+3A_plot">plot</code></td>
<td>
<p>The logigal parameter to see the ROC curve plot. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implments time-dependent ROC curve and the corresponding AUC using the model-band and nonparametric for the estimation of conditional survival function. The empirical (non-smoothed) ROC estimate and the smoothed ROC estimate with/without boundary correction can be obtained using this function.
The smoothed ROC curve estimators require selecting a bandwidth parametr for smoothing the ROC curve. To this end, three data-driven methods: the normal reference &quot;<code>NR</code>&quot;, the plug-in &quot;<code>PI</code>&quot; and the cross-validation &quot;<code>CV</code>&quot; were implemented.
See Beyene and El Ghouch (2020) for details.
</p>


<h3>Value</h3>

<p>Returns the following items:
</p>
<p><code>ROC     </code> The vector of estimated ROC values. These will be numeric numbers between zero
</p>
<p> and one.
</p>
<p><code>U       </code> The vector of grid points used.
</p>
<p><code>AUC      </code> A data frame of dimension <code class="reqn">1 \times 4</code>. The columns are: AUC, standard error of AUC, the lower
</p>
<p>               and upper limits of bootstrap CI.
</p>
<p><code>bw       </code> The computed value of bandwidth. For the empirical method this is always <code>NA</code>.
</p>
<p><code>Dt      </code> The vector of estimated event status.
</p>
<p><code>M       </code> The vector of Marker values.
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2022). Time-dependent ROC curve estimation for interval-censored data. <em>Biometrical Journal</em>, 64, 1056– 1074.
</p>
<p>Beyene, K. M. and El Ghouch A. (2020). Smoothed time-dependent receiver operating characteristic curve for right censored survival data. <em>Statistics in Medicine</em>. 39: 3373– 3396.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cenROC)

data(hds)

est = IntROC(L=hds$L, R=hds$R, M=hds$M, t=2)
est$AUC

</code></pre>

<hr>
<h2 id='ker_dis_i'>Distribution function without the ith observation</h2><span id='topic+ker_dis_i'></span>

<h3>Description</h3>

<p>Distribution function without the ith observation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ker_dis_i(X, y, wt, ktype, bw)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ker_dis_i_+3A_x">X</code></td>
<td>
<p>The numeric data vector.</p>
</td></tr>
<tr><td><code id="ker_dis_i_+3A_y">y</code></td>
<td>
<p>The vector where the kernel estimation is computed.</p>
</td></tr>
<tr><td><code id="ker_dis_i_+3A_wt">wt</code></td>
<td>
<p>The non-negative weight vector.</p>
</td></tr>
<tr><td><code id="ker_dis_i_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel to be used: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;.</p>
</td></tr>
<tr><td><code id="ker_dis_i_+3A_bw">bw</code></td>
<td>
<p>A numeric bandwidth value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the estimated value for the bandwith parameter.
</p>


<h3>Author(s)</h3>

<p>Kassu Mehari Beyene  and Anouar El Ghouch
</p>

<hr>
<h2 id='kfunc'>Function to evaluate the matrix of data vector minus the grid points divided by the bandwidth value.</h2><span id='topic+kfunc'></span>

<h3>Description</h3>

<p>Function to evaluate the matrix of data vector minus the grid points divided by the bandwidth value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kfunc(ktype = "normal", difmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kfunc_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel to be used: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;. By default, the &quot;<code>normal</code>&quot; kernel is used.</p>
</td></tr>
<tr><td><code id="kfunc_+3A_difmat">difmat</code></td>
<td>
<p>A numeric matrix of sample data (X) minus evaluation points (x0) divided by bandwidth value (bw).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the matrix resulting from evaluating <code>difmat</code>.
</p>

<hr>
<h2 id='kfunction'>Kernel distribution function</h2><span id='topic+kfunction'></span>

<h3>Description</h3>

<p>Kernel distribution function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kfunction(ktype, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kfunction_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel to be used: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;.</p>
</td></tr>
<tr><td><code id="kfunction_+3A_x">X</code></td>
<td>
<p>A numeric vector of sample data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector resulting from evaluating X.
</p>

<hr>
<h2 id='mayo'>Mayo Marker Data</h2><span id='topic+mayo'></span>

<h3>Description</h3>

<p>Two marker values with event time and censoring status for the subjects in Mayo PBC data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mayo)
</code></pre>


<h3>Format</h3>

<p>A data frame with 312 observations and 4 variables: time (event time/censoring time), censor (censoring
indicator), mayoscore4, mayoscore5. The two scores are derived from 4 and 5 covariates
respectively.
</p>


<h3>References</h3>

<p>Heagerty, P. J., and Zheng, Y. (2005). Survival model predictive accuracy and ROC curves. <em>Biometrics</em>, 61(1), 92-105.
</p>

<hr>
<h2 id='muro'>The value of squared integral x^2 k(x) dx and integral x k(x) K(x) dx</h2><span id='topic+muro'></span>

<h3>Description</h3>

<p>The value of squared integral x^2 k(x) dx and integral x k(x) K(x) dx
</p>


<h3>Usage</h3>

<pre><code class='language-R'>muro(ktype)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="muro_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel to be used: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;.</p>
</td></tr>
</table>

<hr>
<h2 id='NR'>The normal reference bandwidth selection for weighted data</h2><span id='topic+NR'></span>

<h3>Description</h3>

<p>This function computes the data-driven bandwidth for smoothing the ROC (or distribution) function using the NR method of Beyene and El Ghouch (2020). This is an extension of the classical (unweighted) normal reference bandwith selection method to the case of weighted data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NR(X, wt, ktype = "normal")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NR_+3A_x">X</code></td>
<td>
<p>The numeric data vector.</p>
</td></tr>
<tr><td><code id="NR_+3A_wt">wt</code></td>
<td>
<p>The non-negative weight vector.</p>
</td></tr>
<tr><td><code id="NR_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel to be used: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;. By default, the &quot;<code>normal</code>&quot; kernel is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Beyene and El Ghouch (2020) for details.
</p>


<h3>Value</h3>

<p>Returns the computed value for the bandwith parameter.
</p>


<h3>Author(s)</h3>

<p>Kassu Mehari Beyene and Anouar El Ghouch
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2020). Smoothed time-dependent receiver operating characteristic curve for right censored survival data. <em>Statistics in Medicine</em>. 39: 3373– 3396.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cenROC)

X &lt;- rnorm(100) # random data vector
wt &lt;- runif(100) # weight vector

## Normal reference bandwidth selection
NR(X = X, wt = wt)$bw

</code></pre>

<hr>
<h2 id='PI'>The plug-in bandwidth selection for weighted data</h2><span id='topic+PI'></span>

<h3>Description</h3>

<p>This function computes the data-driven bandwidth for smoothing the ROC (or distribution) function using the PI method of Beyene and El Ghouch (2020). This is an extension of the classical (unweighted) direct plug-in bandwith selection method to the case of weighted data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PI(X, wt, ktype = "normal")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PI_+3A_x">X</code></td>
<td>
<p>The numeric vector of random variable.</p>
</td></tr>
<tr><td><code id="PI_+3A_wt">wt</code></td>
<td>
<p>The non-negative weight vector.</p>
</td></tr>
<tr><td><code id="PI_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel to be used: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;. By default, the &quot;<code>normal</code>&quot; kernel is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Beyene and El Ghouch (2020) for details.
</p>


<h3>Value</h3>

<p>Returns the computed value for the bandwith parameter.
</p>


<h3>Author(s)</h3>

<p>Kassu Mehari Beyene and Anouar El Ghouch
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2020). Smoothed time-dependent receiver operating characteristic curve for right censored survival data. <em>Statistics in Medicine</em>. 39: 3373– 3396.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cenROC)

X &lt;- rnorm(100) # random data vector
wt &lt;- runif(100) # weight vector

## Plug-in bandwidth selection
PI(X = X, wt = wt)$bw

</code></pre>

<hr>
<h2 id='RocFun'>ROC estimation function</h2><span id='topic+RocFun'></span>

<h3>Description</h3>

<p>ROC estimation function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RocFun(U, D, M, bw = "NR", method, ktype)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RocFun_+3A_u">U</code></td>
<td>
<p>The vector of grid points where the ROC curve is estimated.</p>
</td></tr>
<tr><td><code id="RocFun_+3A_d">D</code></td>
<td>
<p>The event indicator.</p>
</td></tr>
<tr><td><code id="RocFun_+3A_m">M</code></td>
<td>
<p>The numeric vector of marker values for which the time-dependent ROC curves is computed.</p>
</td></tr>
<tr><td><code id="RocFun_+3A_bw">bw</code></td>
<td>
<p>The bandwidth parameter for smoothing the ROC function. The possible options are <code>NR</code> normal reference method; <code>PI</code> plug-in method and <code>CV</code> cross-validation method. The default is the <code>NR</code> normal reference method.</p>
</td></tr>
<tr><td><code id="RocFun_+3A_method">method</code></td>
<td>
<p>is the method of ROC curve estimation. The possible options are <code>emp</code> emperical metod; <code>untra</code> smooth without boundary correction and <code>tra</code> is smooth ROC curve estimation with boundary correction.</p>
</td></tr>
<tr><td><code id="RocFun_+3A_ktype">ktype</code></td>
<td>
<p>A character string giving the type kernel to be used: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Beyene K. Mehari and El Ghouch Anouar
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2020). Smoothed time-dependent receiver operating characteristic curve for right censored survival data. <em>Statistics in Medicine</em>. 39: 3373– 3396.
</p>

<hr>
<h2 id='wbw'>Function to select the bandwidth parameter needed for smoothing the time-dependent ROC curve.</h2><span id='topic+wbw'></span>

<h3>Description</h3>

<p>This function computes the data-driven bandwidth value for smoothing the ROC curve.
It contains three methods: the normal refrence, the plug-in and the cross-validation methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wbw(X, wt, bw = "NR", ktype = "normal")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wbw_+3A_x">X</code></td>
<td>
<p>The numeric data vector.</p>
</td></tr>
<tr><td><code id="wbw_+3A_wt">wt</code></td>
<td>
<p>The non-negative weight vector.</p>
</td></tr>
<tr><td><code id="wbw_+3A_bw">bw</code></td>
<td>
<p>A character string specifying the bandwidth selection method. The possible options are &quot;<code>NR</code>&quot; for the normal reference, the plug-in &quot;<code>PI</code>&quot; and cross-validation &quot;<code>CV</code>&quot;.</p>
</td></tr>
<tr><td><code id="wbw_+3A_ktype">ktype</code></td>
<td>
<p>A character string indicating the type of kernel function: &quot;<code>normal</code>&quot;, &quot;<code>epanechnikov</code>&quot;, &quot;<code>biweight</code>&quot;, or &quot;<code>triweight</code>&quot;. Default is &quot;<code>normal</code>&quot; kernel.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the estimated value for the bandwith parameter.
</p>


<h3>Author(s)</h3>

<p>Kassu Mehari Beyene and Anouar El Ghouch
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2020). Smoothed time-dependent receiver operating characteristic curve for right censored survival data. <em>Statistics in Medicine</em>. 39: 3373– 3396.
</p>

<hr>
<h2 id='wIQR'>Weighted inter-quartile range estimation</h2><span id='topic+wIQR'></span>

<h3>Description</h3>

<p>Weighted inter-quartile range estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wIQR(X, wt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wIQR_+3A_x">X</code></td>
<td>
<p>The numeric data vector.</p>
</td></tr>
<tr><td><code id="wIQR_+3A_wt">wt</code></td>
<td>
<p>The non-negative weight vector.</p>
</td></tr>
</table>

<hr>
<h2 id='wquantile'>Weighted quartile estimation</h2><span id='topic+wquantile'></span>

<h3>Description</h3>

<p>Weighted quartile estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wquantile(X, wt, p = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wquantile_+3A_x">X</code></td>
<td>
<p>The numeric data vector.</p>
</td></tr>
<tr><td><code id="wquantile_+3A_wt">wt</code></td>
<td>
<p>The non-negative weight vector.</p>
</td></tr>
<tr><td><code id="wquantile_+3A_p">p</code></td>
<td>
<p>The percentile value. The defult is 0.5.</p>
</td></tr>
</table>

<hr>
<h2 id='wvar'>Weighted variance estimation</h2><span id='topic+wvar'></span>

<h3>Description</h3>

<p>Weighted variance estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wvar(X, wt, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wvar_+3A_x">X</code></td>
<td>
<p>The numeric data vector.</p>
</td></tr>
<tr><td><code id="wvar_+3A_wt">wt</code></td>
<td>
<p>The non-negative weight vector.</p>
</td></tr>
<tr><td><code id="wvar_+3A_na.rm">na.rm</code></td>
<td>
<p>The character indicator wether to consider missing value(s) or not. The defult is FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='youden'>Computes optimal cutoff point using the Youden index criteria</h2><span id='topic+youden'></span>

<h3>Description</h3>

<p>This function computes the optimal cutoff point using the Youden index criteria of both right and interval censored time-to-event data.
The Youden index estimator can be either empirical (non-smoothed) or smoothed with/without boundary correction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>youden(est, plot = "FALSE")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="youden_+3A_est">est</code></td>
<td>
<p>The object returned either by <code>cenROC</code> or <code>IntROC</code>.</p>
</td></tr>
<tr><td><code id="youden_+3A_plot">plot</code></td>
<td>
<p>The logical parameter to see the ROC curve plot along with the Youden inex. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In medical decision-making, obtaining the optimal cutoff value is crucial to identify subject at high risk
of experiencing the event of interest.  Therefore, it is necessary to select a marker value that classifies subjects into
healthy and diseased groups. To this end, in the literature, several methods for selecting optimal cutoff point have been
proposed. In this package, we only included the Youden index criteria.
</p>


<h3>Value</h3>

<p>Returns the following items:
</p>
<p><code>Youden.index     </code> The maximum Youden index value.
</p>
<p><code>cutopt       </code> The optimal cutoff value.
</p>
<p><code>sens     </code> The sensitivity corresponding to the optimal cutoff value.
</p>
<p><code>spec      </code> The specificity corresponding to the optimal cutoff value.
</p>


<h3>References</h3>

<p>Beyene, K. M. and El Ghouch A. (2022). Time-dependent ROC curve estimation for interval-censored data. <em>Biometrical Journal</em>, 64, 1056– 1074.
</p>
<p>Youden, W.J. (1950). Index for rating diagnostic tests. <em>Cancer</em> 3, 32–35.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(cenROC)

# Right censored data
data(mayo)

resu &lt;- cenROC(Y=mayo$time, M=mayo$mayoscore5, censor=mayo$censor, t=365*6, plot="FALSE")
youden(resu,  plot="TRUE")

# Interval censored data
data(hds)

resu1 = IntROC(L=hds$L, R=hds$R, M=hds$M, t=2)
youden(resu1,  plot="TRUE")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
