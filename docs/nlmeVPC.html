<!DOCTYPE html><html lang="en"><head><title>Help for package nlmeVPC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlmeVPC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aqrVPC'><p>The visual predictive checks using the additive quantile regression (aqrVPC)</p></a></li>
<li><a href='#asVPC'><p>The average shifted visual predictive checks (asVPC)</p></a></li>
<li><a href='#bootVPC'><p>The bootstrap visual predictive checks.</p></a></li>
<li><a href='#coverageDetailplot'><p>The detailed coverage plot</p></a></li>
<li><a href='#coverageplot'><p>The coverage plot</p></a></li>
<li><a href='#FindBestCut'><p>Find the best cutoff values of binning for the visual predictive checks.</p></a></li>
<li><a href='#findQuantile'><p>Find quantiles of the original data.</p></a></li>
<li><a href='#findSIMQ'><p>Find quantiles of the simulated data using Rcpp</p></a></li>
<li><a href='#findSIMQuantile'><p>Find quantiles of the simulated data.</p></a></li>
<li><a href='#makeCOVbin'><p>Discretise numeric data into categorical data</p></a></li>
<li><a href='#NumericalCheck'><p>The numerical predictive checks</p></a></li>
<li><a href='#optK'><p>Find the optimal number of bins</p></a></li>
<li><a href='#origdata'>
<p>Pharmacokinetics of Theophylline with a different schedule of time.</p></a></li>
<li><a href='#quantVPC'><p>The quantified visual predictive check plot (QVPC)</p></a></li>
<li><a href='#simdata'>
<p>Simulation data</p></a></li>
<li><a href='#VPCgraph'><p>The original visual predictive check plot (VPC)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Visual Model Checking for Nonlinear Mixed Effect Model</td>
</tr>
<tr>
<td>Version:</td>
<td>2.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-12-22</td>
</tr>
<tr>
<td>Description:</td>
<td>Various visual and numerical diagnosis methods for the nonlinear mixed effect model, including visual predictive checks, numerical predictive checks, and coverage plots (Karlsson and Holford, 2008, <a href="https://www.page-meeting.org/?abstract=1434">https://www.page-meeting.org/?abstract=1434</a>).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), Hmisc</td>
</tr>
<tr>
<td>Imports:</td>
<td>quantreg, optimx, ggplot2, Rcpp, timeDate</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testit</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-22 04:58:36 UTC; EKLee</td>
</tr>
<tr>
<td>Author:</td>
<td>Eun-Kyung Lee [aut, cre],
  Eun-Hwa Kang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eun-Kyung Lee &lt;lee.eunk@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-22 05:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aqrVPC'>The visual predictive checks using the additive quantile regression (aqrVPC)</h2><span id='topic+aqrVPC'></span>

<h3>Description</h3>

<p>This function draws the visual predictive check (VPC) plot 
using additive quantile regression. The quantile 
regression methods are used to calculate quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aqrVPC(orig_data, 
       sim_data, 
       probs = c(0.1,0.5,0.9),
       conf.level = 0.95, 
       X_name = "TIME", 
       Y_name = "DV",
       MissingDV = NULL, 
       plot_caption = TRUE,
       DV_point = TRUE,
       plot_flag = TRUE,
       linesize = 0.7, 
       pointsize = 0.7, 
       captionsize = 10,
       qss_lambda = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aqrVPC_+3A_orig_data">orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_sim_data">sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_x_name">X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually &quot;TIME&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_y_name">Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually &quot;DV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_missingdv">MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually &quot;MDV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_plot_caption">plot_caption</code></td>
<td>
<p>Put caption with additional information if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_dv_point">DV_point</code></td>
<td>
<p>Draw point (X, Y) in the plot if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_plot_flag">plot_flag</code></td>
<td>
<p>Draw plot if TRUE; generate data for drawing plot if FALSE.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_linesize">linesize</code></td>
<td>
<p>Size of line in the plot.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_pointsize">pointsize</code></td>
<td>
<p>Size of point in the plot.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_captionsize">captionsize</code></td>
<td>
<p>Size of caption.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_qss_lambda">qss_lambda</code></td>
<td>
<p>Smoothing parameter in quantreg::qss function. 
Larger lambda produces a smoother fit.</p>
</td></tr>
<tr><td><code id="aqrVPC_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>aqrVPC plot or the values to draw aqrVPC plot.
</p>


<h3>References</h3>

<p>Koenker, Roger, and Kevin F. Hallock. &quot;Quantile regression.&quot; 
Journal of economic perspectives 15.4 (2001): 143-156.
</p>
<p>Jamsen, K. M., Patel, K., Nieforth, K., &amp; Kirkpatrick, C. M. 
(2018). A regression approach to visual predictive checks for
population pharmacometric models. CPT: pharmacometrics &amp; 
systems pharmacology, 7(10), 678-686.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(origdata)
data(simdata)
aqrVPC(origdata,simdata)

</code></pre>

<hr>
<h2 id='asVPC'>The average shifted visual predictive checks (asVPC)</h2><span id='topic+asVPC'></span>

<h3>Description</h3>

<p>This function draws the average shifted visual predictive check
(asVPC) plot. It calculates original and simulated data percentiles using 
the average shifted histogram method. After calculating percentiles with 
bin-related or distance-related weights, draw the VPC type plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asVPC(orig_data,
      sim_data,
      type = "CI",                
      weight_method = "bin",                  
      N_xbin = NULL,
      N_hist = NULL,
      probs = c(0.1,0.5,0.9),
      conf.level = 0.95,
      X_name = "TIME",
      Y_name = "DV",
      MissingDV = NULL,
      DV_point = TRUE,                
      CIvpc_type = "line",
      bin_grid = TRUE,                   
      plot_caption = TRUE,
      plot_flag = TRUE,
      linesize = 0.7,
      pointsize = 0.7,
      captionsize = 10,
      Kmethod = "cluster",                
      maxK = NULL,
      beta = 0.2,
      lambda = 0.3,
      R = 4,
      C1 = 2.5,
      C2 = 7.8,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="asVPC_+3A_orig_data">orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_sim_data">sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_type">type</code></td>
<td>
<p>Type of VPC graph; &quot;CI&quot;, &quot;percentile&quot;, or &quot;scatter&quot;.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_weight_method">weight_method</code></td>
<td>
<p>The way to put weight when the average shifted values are calculated. &quot;bin&quot; or &quot;distance&quot;.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_n_xbin">N_xbin</code></td>
<td>
<p>Number of bins in X variable. If NULL, optimal number of bins are automatically calcuated using optK function.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_n_hist">N_hist</code></td>
<td>
<p>The number of shifted histograms.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_x_name">X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually &quot;TIME&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="asVPC_+3A_y_name">Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually &quot;DV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="asVPC_+3A_missingdv">MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually &quot;MDV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="asVPC_+3A_dv_point">DV_point</code></td>
<td>
<p>Draw point (X, Y) in the plot if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_civpc_type">CIvpc_type</code></td>
<td>
<p>Type of CI area in VPC graph; &quot;line&quot; or &quot;segment&quot;.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_bin_grid">bin_grid</code></td>
<td>
<p>Draw grid lines for binning in X variable if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_plot_caption">plot_caption</code></td>
<td>
<p>Put caption with additional information if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_plot_flag">plot_flag</code></td>
<td>
<p>Draw plot if TRUE; generate data for drawing plot if FALSE.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_linesize">linesize</code></td>
<td>
<p>Size of line in the plot.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_pointsize">pointsize</code></td>
<td>
<p>Size of point in the plot.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_captionsize">captionsize</code></td>
<td>
<p>Size of caption.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_kmethod">Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning.&quot;cluster&quot; or &quot;kernel&quot;.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_maxk">maxK</code></td>
<td>
<p>The maximum number of bins.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_beta">beta</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_lambda">lambda</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_r">R</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_c1">C1</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_c2">C2</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="asVPC_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>asVPC plot or the values to draw asVPC plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(origdata)
data(simdata)
asVPC(origdata,simdata,type="CI",N_hist=3,weight_method="distance",N_xbin=8)
asVPC(origdata,simdata,type="CI",N_hist=3,weight_method="bin",N_xbin=8)


</code></pre>

<hr>
<h2 id='bootVPC'>The bootstrap visual predictive checks.</h2><span id='topic+bootVPC'></span>

<h3>Description</h3>

<p>This function draws the visual predictive check plot with bootstrapped data.
It compares the distribution of the simulated data to the distribution 
of the bootstrap samples that draw from the observed data. 
This plot reflects the uncertainty of the observed data and allows 
for more objective comparisons with the predicted median.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootVPC(orig_data,
        sim_data,
        B = 1000,                  
        N_xbin = NULL,
        conf.level = 0.95,
        X_name = "TIME",
        Y_name = "DV",
        subject_name = "ID",                  
        MissingDV = NULL,
        DV_point = TRUE,                  
        plot_caption = TRUE,                  
        plot_flag = TRUE,
        linesize = 0.7,
        pointsize = 0.7,
        Kmethod = "cluster",                
        maxK = NULL,
        beta = 0.2,
        lambda = 0.3,
        R = 4,                
        C1 = 2.5,
        C2 = 7.8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootVPC_+3A_orig_data">orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_sim_data">sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_b">B</code></td>
<td>
<p>Number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_n_xbin">N_xbin</code></td>
<td>
<p>Number of bins in X variable. If NULL, optimal number of bins are automatically calcuated using optK function.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_x_name">X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually &quot;TIME&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_y_name">Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually &quot;DV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_subject_name">subject_name</code></td>
<td>
<p>Name of subject variable in orig_data (usually &quot;ID&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_missingdv">MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually &quot;MDV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_dv_point">DV_point</code></td>
<td>
<p>Draw point (X, Y) in the plot if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_plot_caption">plot_caption</code></td>
<td>
<p>Put caption with additional information if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_plot_flag">plot_flag</code></td>
<td>
<p>Draw plot if TRUE; generate data for drawing plot if FALSE.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_linesize">linesize</code></td>
<td>
<p>Size of line in the plot.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_pointsize">pointsize</code></td>
<td>
<p>Size of point in the plot.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_kmethod">Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning.&quot;cluster&quot; or &quot;kernel&quot;.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_maxk">maxK</code></td>
<td>
<p>The maximum number of bins.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_beta">beta</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_lambda">lambda</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_r">R</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_c1">C1</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_c2">C2</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="bootVPC_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>bootVPC plot or the values to draw bootVPC plot.
</p>


<h3>References</h3>

<p>Post, T. M., et al. (2008)
Extensions to the visual predictive check for facilitate model performance
evaluation, Journal of pharmacokinetics and pharmacodynamics,
35(2), 185-202
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(origdata)
data(simdata)
bootVPC(origdata,simdata,N_xbin=8)

</code></pre>

<hr>
<h2 id='coverageDetailplot'>The detailed coverage plot</h2><span id='topic+coverageDetailplot'></span>

<h3>Description</h3>

<p>This function draws the detailed coverage plot for the 
specific prediction level to check over or under estimate regions 
in each prediction level. The percentages of observations above the 
prediction interval are calculated in each bin of the independent variable. 
Additionally, the percentages of observations below the prediction interval 
are calculated. The white dots in the plot represent the expected
percentages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverageDetailplot(orig_data,
                  sim_data,
                  N_xbin = NULL,
                  predL = 0.5,
                  conf.level = 0.95,
                  X_name = "TIME",
                  Y_name = "DV",
                  MissingDV = NULL,
                  Kmethod = "cluster",                
                  maxK = NULL,
                  beta = 0.2,
                  lambda = 0.3,
                  R = 4,
                  C1 = 2.5,
                  C2 = 7.8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coverageDetailplot_+3A_orig_data">orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_sim_data">sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_n_xbin">N_xbin</code></td>
<td>
<p>Number of bins in X variable. If NULL, optimal number of bins are automatically calcuated using optK function.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_predl">predL</code></td>
<td>
<p>Scalar of probability</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_x_name">X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually &quot;TIME&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_y_name">Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually &quot;DV&quot; in pharmacokinetic data)</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_missingdv">MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually &quot;MDV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_kmethod">Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning.&quot;cluster&quot; or &quot;kernel&quot;.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_maxk">maxK</code></td>
<td>
<p>The maximum number of bins</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_beta">beta</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_lambda">lambda</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_r">R</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_c1">C1</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_c2">C2</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageDetailplot_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the detailed coverage plot
</p>


<h3>References</h3>

<p>Post, T. M., et al. (2008)
Extensions to the visual predictive check for facilitate model performance
evaluation, Journal of pharmacokinetics and pharmacodynamics,
35(2), 185-202
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(origdata)
data(simdata)
coverageDetailplot(origdata,simdata,predL=0.5,N_xbin=8)

</code></pre>

<hr>
<h2 id='coverageplot'>The coverage plot</h2><span id='topic+coverageplot'></span>

<h3>Description</h3>

<p>The coverage plot is developed to help visually check 
the fitted model with the NPC result.
In each level of the predicted interval, the ratios between the expected 
number of points (Exp) outside the prediction interval and the observed 
number of data (Obs) outside the prediction interval are calculated.
These ratios on the upper and lower sides of the prediction interval 
are calculated separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverageplot(orig_data,
             sim_data,
             N_xbin = NULL,
             pred.level = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9),
             conf.level = 0.95,                         
             X_name = "TIME",
             Y_name = "DV",
             MissingDV = NULL,
             plot_flag = TRUE,
             linesize = 0.7,
             pointsize = 1.5,
             Kmethod = "cluster",                
             maxK = NULL,
             beta = 0.2,
             lambda = 0.3,
             R = 4,
             C1 = 2.5,
             C2 = 7.8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coverageplot_+3A_orig_data">orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_sim_data">sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_n_xbin">N_xbin</code></td>
<td>
<p>Number of bins in X variable. If NULL, optimal number of bins are automatically calculated using optK function.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_pred.level">pred.level</code></td>
<td>
<p>Numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_x_name">X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually &quot;TIME&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_y_name">Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually &quot;DV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_missingdv">MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually &quot;MDV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_plot_flag">plot_flag</code></td>
<td>
<p>Draw plot if TRUE; generate data for drawing plot if FALSE.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_linesize">linesize</code></td>
<td>
<p>Size of line in the plot.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_pointsize">pointsize</code></td>
<td>
<p>Size of point in the plot.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_kmethod">Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning.&quot;cluster&quot; or &quot;kernel&quot;.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_maxk">maxK</code></td>
<td>
<p>Yhe maximum number of bins.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_beta">beta</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_lambda">lambda</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_r">R</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_c1">C1</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_c2">C2</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="coverageplot_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>coverage plot
</p>


<h3>References</h3>

<p>Holford N, &amp; Karlsson M. (2008). &quot;A tutorial on visual predictive checks,
abstr 1434.&quot; Annual Meeting of the Populations Approach Group in Europe. www.page-meeting.org. 2008.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(origdata)
data(simdata)
coverageplot(origdata,simdata,N_xbin=8)


</code></pre>

<hr>
<h2 id='FindBestCut'>Find the best cutoff values of binning for the visual predictive checks.</h2><span id='topic+FindBestCut'></span>

<h3>Description</h3>

<p>By various rules, find the best cutoff values for a given 
number of bins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FindBestCut(X,
            K,
            beta = 0.2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FindBestCut_+3A_x">X</code></td>
<td>
<p>A numeric vector to divide into K bins.</p>
</td></tr>
<tr><td><code id="FindBestCut_+3A_k">K</code></td>
<td>
<p>Number of bins.</p>
</td></tr>
<tr><td><code id="FindBestCut_+3A_beta">beta</code></td>
<td>
<p>Additional parameter in the penalty. 
For more detailed explanation, see reference.</p>
</td></tr>
<tr><td><code id="FindBestCut_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The best cutoff values to make K bins using X and
the minimum within sums of square values for the binning
</p>


<h3>References</h3>

<p>Lavielle, M. and Bleakley, K.
(2011). Automatic data binning for improved visual 
diagnosis of pharmacometric models. 
Journal of pharmacokinetics and pharmacodynamics, 38(6), 861-871.
</p>
<p>VPC automatic binning algorithm in PsN 5.0.0 manual.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(origdata)
FindBestCut(origdata$TIME,K=10)
</code></pre>

<hr>
<h2 id='findQuantile'>Find quantiles of the original data.</h2><span id='topic+findQuantile'></span>

<h3>Description</h3>

<p>Find quantiles of the original data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findQuantile(Y,
            X,
            X_bin,
            probs=c(0.1,0.5,0.9),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findQuantile_+3A_y">Y</code></td>
<td>
<p>A numeric vector whose sample quantiles are wanted.</p>
</td></tr>
<tr><td><code id="findQuantile_+3A_x">X</code></td>
<td>
<p>A numeric vector corresponding to Y.</p>
</td></tr>
<tr><td><code id="findQuantile_+3A_x_bin">X_bin</code></td>
<td>
<p>Binning result from makeCOVbin function.</p>
</td></tr>
<tr><td><code id="findQuantile_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="findQuantile_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>quantiles of Y using X_bin
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(origdata)
CUT = FindBestCut(origdata$TIME,8)$cutoffs
time_bin = makeCOVbin(origdata$TIME,K=8,cutoffs = CUT)
findQuantile(origdata$DV,origdata$TIME,X_bin=time_bin)
</code></pre>

<hr>
<h2 id='findSIMQ'>Find quantiles of the simulated data using Rcpp</h2><span id='topic+findSIMQ'></span>

<h3>Description</h3>

<p>Find quantiles of the simulated data using Rcpp
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findSIMQ(SIM,
        X,
        Xbin,
        probs,
        confLevel,
        approx)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findSIMQ_+3A_sim">SIM</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="findSIMQ_+3A_x">X</code></td>
<td>
<p>A numeric vector corresponding to Y</p>
</td></tr>
<tr><td><code id="findSIMQ_+3A_xbin">Xbin</code></td>
<td>
<p>Binning result from makeCOVbin function</p>
</td></tr>
<tr><td><code id="findSIMQ_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of probabilities</p>
</td></tr>
<tr><td><code id="findSIMQ_+3A_conflevel">confLevel</code></td>
<td>
<p>Confidence level of the interval.</p>
</td></tr>
<tr><td><code id="findSIMQ_+3A_approx">approx</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>quantiles of SIM using xbin
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(origdata)
data(simdata)
CUT = FindBestCut(origdata$TIME,8)$cutoffs
time_bin = makeCOVbin(origdata$TIME,K=8,cutoffs = CUT)
findSIMQ(simdata,origdata$TIME,Xbin=time_bin,probs=c(0.1,0.5,0.9),
confLevel=0.95,approx=FALSE)
</code></pre>

<hr>
<h2 id='findSIMQuantile'>Find quantiles of the simulated data.</h2><span id='topic+findSIMQuantile'></span>

<h3>Description</h3>

<p>Find quantiles of the simulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findSIMQuantile(sim_data,
               X,
               X_bin,
               probs = c(0.1,0.5,0.9),
               conf.level = 0.95,
               approx = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findSIMQuantile_+3A_sim_data">sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="findSIMQuantile_+3A_x">X</code></td>
<td>
<p>A numeric vector corresponding to Y.</p>
</td></tr>
<tr><td><code id="findSIMQuantile_+3A_x_bin">X_bin</code></td>
<td>
<p>Binning result from makeCOVbin function.</p>
</td></tr>
<tr><td><code id="findSIMQuantile_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="findSIMQuantile_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td></tr>
<tr><td><code id="findSIMQuantile_+3A_approx">approx</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="findSIMQuantile_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>quantiles of sim_data using X_bin
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(origdata)
data(simdata)
CUT = FindBestCut(origdata$TIME,8)$cutoffs
time_bin = makeCOVbin(origdata$TIME,K=8,cutoffs = CUT)
findSIMQuantile(simdata,origdata$TIME,X_bin=time_bin)
</code></pre>

<hr>
<h2 id='makeCOVbin'>Discretise numeric data into categorical data</h2><span id='topic+makeCOVbin'></span>

<h3>Description</h3>

<p>Discretise numeric value into a categorical variable using 
the user-defined breaks. If cutoffs and the number of bins (K) is NULL, 
find the best number of bins using the optK function and find the best 
cutoff values using the FindBestCut function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeCOVbin(X,
           K,
           cutoffs,
           adjust0bin = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeCOVbin_+3A_x">X</code></td>
<td>
<p>A numeric vector corresponding to Y.</p>
</td></tr>
<tr><td><code id="makeCOVbin_+3A_k">K</code></td>
<td>
<p>Number of bins.</p>
</td></tr>
<tr><td><code id="makeCOVbin_+3A_cutoffs">cutoffs</code></td>
<td>
<p>A numeric vector of two or more unique cut points.</p>
</td></tr>
<tr><td><code id="makeCOVbin_+3A_adjust0bin">adjust0bin</code></td>
<td>
<p>Adjust bin with 0 observation if TRUE.</p>
</td></tr>
<tr><td><code id="makeCOVbin_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of binning and the summary of the binning results
</p>


<h3>References</h3>

<p>Lavielle, M. and Bleakley, K.
(2011). Automatic data binning for improved visual 
diagnosis of pharmacometric models. 
Journal of pharmacokinetics and pharmacodynamics, 38(6), 861-871.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(origdata)
CUT = FindBestCut(origdata$TIME,8)$cutoffs
makeCOVbin(origdata$TIME,K=8,cutoffs=CUT)
</code></pre>

<hr>
<h2 id='NumericalCheck'>The numerical predictive checks</h2><span id='topic+NumericalCheck'></span>

<h3>Description</h3>

<p>This function calculates the numerical predictive checks for 
each prediction level. For a given level of prediction, 
the predicted interval is calculated using the simulated data, 
and the number of observed data below the predicted interval is counted. 
The expected number of points below the predicted interval 
is also calculated and compared to the observed number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NumericalCheck(orig_data,
               sim_data,
               N_xbin = NULL,
               pred.level = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9),
               conf.level = 0.95,
               X_name = "TIME",
               Y_name = "DV",
               MissingDV = NULL,
               Kmethod = "cluster",                
               maxK = NULL,
               beta = 0.2,
               lambda = 0.3,
               R = 4,
               C1 = 2.5,
               C2 = 7.8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NumericalCheck_+3A_orig_data">orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_sim_data">sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_n_xbin">N_xbin</code></td>
<td>
<p>Number of bins in X variable. If NULL, optimal number of bins are automatically calcuated using optK function.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_pred.level">pred.level</code></td>
<td>
<p>Numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_x_name">X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually &quot;TIME&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_y_name">Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually &quot;DV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_missingdv">MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually &quot;MDV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_kmethod">Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning.&quot;cluster&quot; or &quot;kernel&quot;.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_maxk">maxK</code></td>
<td>
<p>The maximum number of bins.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_beta">beta</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_lambda">lambda</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_r">R</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_c1">C1</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_c2">C2</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="NumericalCheck_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of numerical predictive check
</p>


<h3>References</h3>

<p>Holford N, &amp; Karlsson M. (2008). &quot;A tutorial on visual predictive checks,
abstr 1434.&quot; Annual Meeting of the Populations Approach Group in Europe. www.page-meeting.org. 2008.
</p>
<p>Harling, Uekcert, K. 2018. VPC and NPC User Guide. ICON plc.
</p>
<p>https://github.com/UUPharmacometrics/PsN/releases/download/4.9.0/vpc_npc_userguide.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(origdata)
data(simdata)
NumericalCheck(origdata,simdata,N_xbin=8)$NPC

</code></pre>

<hr>
<h2 id='optK'>Find the optimal number of bins</h2><span id='topic+optK'></span>

<h3>Description</h3>

<p>This function automatically finds the optimal number of bins using dynamic programming.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optK(X,
     Kmethod = "cluster",
     maxK = 10,
     beta = 0.2,
     lambda = 0.3,
     R = 4,
     C1 = 2.5,
     C2 = 7.8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optK_+3A_x">X</code></td>
<td>
<p>Numeric vector corresponding to Y.</p>
</td></tr>
<tr><td><code id="optK_+3A_kmethod">Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning.&quot;cluster&quot; or &quot;kernel&quot;.</p>
</td></tr>
<tr><td><code id="optK_+3A_maxk">maxK</code></td>
<td>
<p>The maximum number of bins.</p>
</td></tr>
<tr><td><code id="optK_+3A_beta">beta</code></td>
<td>
<p>Additional parameter for automatic binning. For more detailed explanation, see reference.</p>
</td></tr>
<tr><td><code id="optK_+3A_lambda">lambda</code></td>
<td>
<p>Additional parameter for automatic binning. For more detailed explanation, see reference.</p>
</td></tr>
<tr><td><code id="optK_+3A_r">R</code></td>
<td>
<p>Additional parameter for automatic binning. For more detailed explanation, see reference.</p>
</td></tr>
<tr><td><code id="optK_+3A_c1">C1</code></td>
<td>
<p>Additional parameter for automatic binning. For more detailed explanation, see reference.</p>
</td></tr>
<tr><td><code id="optK_+3A_c2">C2</code></td>
<td>
<p>Additional parameter for automatic binning. For more detailed explanation, see reference.</p>
</td></tr>
<tr><td><code id="optK_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The optimal number of bins, the result of binning, and the summary of
binning including the penalty values up to the maximum number of bins
are returned.
</p>


<h3>References</h3>

<p>Lavielle, M. and Bleakley, K.
(2011). Automatic data binning for improved visual 
diagnosis of pharmacometric models. 
Journal of pharmacokinetics and pharmacodynamics, 38(6), 861-871.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(origdata)
optK(origdata$TIME)

</code></pre>

<hr>
<h2 id='origdata'>
Pharmacokinetics of Theophylline with a different schedule of time. 
</h2><span id='topic+origdata'></span>

<h3>Description</h3>

<p>The simulated Theoph data frame has 132 rows and 3 columns of data from an 
experiment on the pharmacokinetics of theophylline.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="origdata_+3A_id">ID</code></td>
<td>
<p>An ordered factor with levels 1, ..., 12 identifying the subject
on whom the observation was made. The ordering is by increasing the maximum
concentration of theophylline observed.</p>
</td></tr>
<tr><td><code id="origdata_+3A_time">TIME</code></td>
<td>
<p>Time since drug administration when the sample was drawn (hr).</p>
</td></tr>
<tr><td><code id="origdata_+3A_dv">DV</code></td>
<td>
<p>Theophylline concentration in the sample (mg/L).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(origdata)
dim(origdata)
</code></pre>

<hr>
<h2 id='quantVPC'>The quantified visual predictive check plot (QVPC)</h2><span id='topic+quantVPC'></span>

<h3>Description</h3>

<p>The quantified visual predictive check visually represents 
actual and unavailable observations around predicted medians, regardless 
of the density or shape of the observed data distribution, through the 
form of a percent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantVPC(orig_data,
         sim_data,
         N_xbin = NULL,
         prob = 0.5,
         X_name = "TIME",
         Y_name = "DV",
         MissingDV = NULL,
         Kmethod = "cluster",                
         maxK = NULL,
         beta = 0.2,
         lambda = 0.3,
         R = 4,
         C1 = 2.5,
         C2 = 7.8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantVPC_+3A_orig_data">orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_sim_data">sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_n_xbin">N_xbin</code></td>
<td>
<p>Number of bins in X variable. If NULL, optimal number of bins are automatically calcuated using optK function.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_prob">prob</code></td>
<td>
<p>Scalar of probability.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_x_name">X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually &quot;TIME&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_y_name">Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually &quot;DV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_missingdv">MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually &quot;MDV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_kmethod">Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning.&quot;cluster&quot; or &quot;kernel&quot;.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_maxk">maxK</code></td>
<td>
<p>The maximum number of bins.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_beta">beta</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_lambda">lambda</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_r">R</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_c1">C1</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_c2">C2</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="quantVPC_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>quantVPC plot
</p>


<h3>References</h3>

<p>Post, T.M., et al. (2008)
Extensions to the visual predictive check for facilitate model performance
evaluation, Journal of pharmacokinetics and pharmacodynamics,
35(2), 185-202
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(origdata)
data(simdata)
quantVPC(origdata,simdata,prob=0.5,N_xbin=8)

</code></pre>

<hr>
<h2 id='simdata'>
Simulation data
</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>Simulation data from the fitted model of the origdata
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
dim(simdata)
</code></pre>

<hr>
<h2 id='VPCgraph'>The original visual predictive check plot (VPC)</h2><span id='topic+VPCgraph'></span>

<h3>Description</h3>

<p>This function draws the original visual predictive check plot 
proposed by Holford &amp; Karlsson (2008). The visual predictive check plot is 
a graphical comparison of the distribution of observations and simulated data
from the fitted model. 
In the &quot;scatter&quot; type of the VPC plot, dots indicate the observed data. 
Two dashed blue lines and one solid line represent profiles of percentiles 
of the simulated data. If the fitted model represents the observed data well,
most observed data are between two dashed blue lines. In the &quot;percentile&quot; 
type of the VPC plot,  profiles of percentiles from the observed data are 
compared to profiles of percentiles from the simulated data. Red lines
represent profiles from the observed data, and blue lines represent 
profiles from the simulated data. If the fitted model represents the 
observed data well, two profiles in each percentile - one from the original
data and the other from the simulated data - are similar. In the &quot;CI&quot; 
type of the VPC plot, sky blue and pink areas represent the confidence 
areas of the profile in each percentile. These confidence areas were 
calculated from the simulated data. In this plot, it is necessary to
verify that the profiles of the original data are in confidence areas 
of each profile from the simulated data in each percentile. If each 
percentile line of the observed data is in the corresponding confidence
area, this can be evidence that the fitted model represents the observed 
data quite well. Otherwise, the fitted model needs to be improved.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VPCgraph(orig_data,
         sim_data,
         type = "CI",                   
         N_xbin = NULL,
         probs = c(0.1,0.5,0.9),
         conf.level = 0.95,
         X_name = "TIME",
         Y_name = "DV",
         MissingDV = NULL,
         DV_point = TRUE,
         CIvpc_type = "line",
         bin_grid = TRUE,
         plot_caption = TRUE,
         plot_flag = TRUE,
         linesize = 0.7,
         pointsize = 0.7,
         captionsize = 10,
         Kmethod = "cluster",                   
         maxK = NULL,
         beta = 0.2,
         lambda = 0.3,
         R = 4,
         C1 = 2.5,
         C2 = 7.8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VPCgraph_+3A_orig_data">orig_data</code></td>
<td>
<p>A data frame of original data with X and Y variable.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_sim_data">sim_data</code></td>
<td>
<p>A matrix of simulated data with only Y values collected.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_type">type</code></td>
<td>
<p>Type of VPC graph; &quot;CI&quot;, &quot;percentile&quot;, or &quot;scatter&quot;.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_n_xbin">N_xbin</code></td>
<td>
<p>Number of bins in X variable. If NULL, optimal number of bins are automatically calcuated using optK function.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level of the interval.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_x_name">X_name</code></td>
<td>
<p>Name of X variable in orig_data (usually &quot;TIME&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_y_name">Y_name</code></td>
<td>
<p>Name of Y variable in orig_data (usually &quot;DV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_missingdv">MissingDV</code></td>
<td>
<p>Name of missing indicator variable in orig_data, which have value 1 if missing, value 0 otherwise. (usually &quot;MDV&quot; in pharmacokinetic data).</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_dv_point">DV_point</code></td>
<td>
<p>Draw point (X, Y) in the plot if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_civpc_type">CIvpc_type</code></td>
<td>
<p>Type of CI area in VPC graph; &quot;line&quot; or &quot;segment&quot;.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_bin_grid">bin_grid</code></td>
<td>
<p>Draw grid lines for binning in X variable if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_plot_caption">plot_caption</code></td>
<td>
<p>Put caption with additional information if TRUE; omit if FALSE.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_plot_flag">plot_flag</code></td>
<td>
<p>Draw plot if TRUE; generate data for drawing plot if FALSE.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_linesize">linesize</code></td>
<td>
<p>Size of line in the plot.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_pointsize">pointsize</code></td>
<td>
<p>Size of point in the plot.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_captionsize">captionsize</code></td>
<td>
<p>Size of caption .</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_kmethod">Kmethod</code></td>
<td>
<p>The way to calculate the penalty in automatic binning.&quot;cluster&quot; or &quot;kernel&quot;.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_maxk">maxK</code></td>
<td>
<p>The maximum number of bins.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_beta">beta</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_lambda">lambda</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_r">R</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_c1">C1</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_c2">C2</code></td>
<td>
<p>Additional parameter for automatic binning, used in optK function.</p>
</td></tr>
<tr><td><code id="VPCgraph_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Visual predictive check plot or the values to draw VPC plot.
</p>


<h3>References</h3>

<p>Holford N, &amp; Karlsson M. (2008). &quot;A tutorial on visual predictive checks,
abstr 1434.&quot; Annual Meeting of the Populations Approach Group in Europe. www.page-meeting.org. 2008.
</p>
<p>Harling, Uekcert, K. 2018. VPC and NPC User Guide. ICON plc.
</p>
<p>https://github.com/UUPharmacometrics/PsN/releases/download/4.9.0/vpc_npc_userguide.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(origdata)
data(simdata)
VPCgraph(origdata,simdata,type="CI",X_name="TIME",Y_name="DV",N_xbin=8)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
