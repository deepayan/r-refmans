<!DOCTYPE html><html lang="en-US"><head><title>Help for package echarty</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {echarty}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+26ndash+3B+20Introduction+20+26ndash+3B'><p>echarty</p></a></li>
<li><a href='#ec.clmn'><p>Data column format</p></a></li>
<li><a href='#ec.data'><p>Data helper</p></a></li>
<li><a href='#ec.fromJson'><p>JSON to chart</p></a></li>
<li><a href='#ec.init'><p>Initialize command</p></a></li>
<li><a href='#ec.inspect'><p>Chart to JSON</p></a></li>
<li><a href='#ec.paxis'><p>Parallel Axis</p></a></li>
<li><a href='#ec.plugjs'><p>Install Javascript plugin from URL source</p></a></li>
<li><a href='#ec.theme'><p>Themes</p></a></li>
<li><a href='#ec.upd'><p>Update option lists</p></a></li>
<li><a href='#ec.util'><p>Utility functions</p></a></li>
<li><a href='#ecr.band'><p>Area band</p></a></li>
<li><a href='#ecr.ebars'><p>Error bars</p></a></li>
<li><a href='#ecs.exec'><p>Shiny: Execute a proxy command</p></a></li>
<li><a href='#ecs.output'><p>Shiny: UI chart</p></a></li>
<li><a href='#ecs.proxy'><p>Shiny: Create a proxy</p></a></li>
<li><a href='#ecs.render'><p>Shiny: Plot command to render chart</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Minimal R/Shiny Interface to JavaScript Library 'ECharts'</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-14</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Deliver the full functionality of 'ECharts' with minimal overhead. 'echarty' users build R lists for 'ECharts' API. Lean set of powerful commands.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>htmlwidgets, dplyr (&ge; 0.7.0), data.tree (&ge; 1.0.0),</td>
</tr>
<tr>
<td>Suggests:</td>
<td>htmltools (&ge; 0.5.0), shiny (&ge; 1.7.0), jsonlite, crosstalk,
testthat (&ge; 3.0.0), sf, leaflet (&ge; 2.2.0), knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (&ge; 2.0)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://helgasoft.github.io/echarty/">https://helgasoft.github.io/echarty/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/helgasoft/echarty/issues/">https://github.com/helgasoft/echarty/issues/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-14 08:31:14 UTC; gugu</td>
</tr>
<tr>
<td>Author:</td>
<td>Larry Helgason [aut, cre] (initial code from John Coene's library
    echarts4r)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Larry Helgason &lt;larry@helgasoft.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-15 22:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+26ndash+3B+20Introduction+20+26ndash+3B'>echarty</h2><span id='topic+--+20Introduction+20--'></span>

<h3>Description</h3>

<p>echarty
</p>


<h3>Details</h3>



<h4>Description</h4>

<p><strong>echarty</strong> provides a lean interface between R and Javascript library
<a href="https://echarts.apache.org/en/index.html">ECharts</a>.
We encourage users to follow the original ECharts <a href="https://echarts.apache.org/en/option.html">API documentation</a> to construct
charts with echarty.
Main command <strong>ec.init</strong> can set multiple native ECharts options to
build a chart.
The benefits - learn a very limited set of commands, and enjoy the
<strong>full functionality</strong> of ECharts.
</p>



<h4>Package Conventions</h4>

<p>pipe-friendly - supports both %&gt;% and |&gt;
commands have three prefixes to help with auto-completion:
</p>

<ul>
<li> <p><strong>ec.</strong> for general functions, like <em>ec.init</em>
</p>
</li>
<li> <p><strong>ecs.</strong> for Shiny functions, like <em>ecs.output</em>
</p>
</li>
<li> <p><strong>ecr.</strong> for rendering functions, like <em>ecr.band</em>
</p>
</li></ul>




<h4>Events</h4>

<p>For event handling in Shiny see sample code in
<a href="https://github.com/helgasoft/echarty/blob/main/demo/eshiny.R">eshiny.R</a>,
run as <code>demo(eshiny)</code>.
Echarty has three built-in event callbacks - <em>click</em>, <em>mouseover</em>,
<em>mouseout</em>. All other ECharts
<a href="https://echarts.apache.org/en/api.html#events">events</a> could be
initialized through <code>p$x$capture</code>. Another option is to use <code>p$x$on</code>
with JavaScript handlers, see code in
<a href="https://github.com/helgasoft/echarty/blob/main/demo/examples.R">examples</a>.
</p>



<h4>Widget <strong>x</strong> parameters</h4>

<p>These are <em>htmlwidget</em> and <em>ECharts</em> initialization parameters supported
by echarty. There are code samples for most of them in
<a href="https://github.com/helgasoft/echarty/blob/main/demo/examples.R">examples</a>:
</p>

<ul>
<li><p> capture = event name(s), to monitor events, usually in Shiny
</p>
</li>
<li><p> on = define JavaScript code for event handling, see
<a href="https://echarts.apache.org/en/api.html#echartsInstance.on">ECharts</a>
</p>
</li>
<li><p> registerMap = define a map from a geoJSON file, see
<a href="https://echarts.apache.org/en/api.html#echartsInstance.registerMap">ECharts</a>
</p>
</li>
<li><p> group = group-name of a chart, see
<a href="https://echarts.apache.org/en/api.html#echartsInstance.group">ECharts</a>
</p>
</li>
<li><p> connect = command to connect charts with same group-name, see
<a href="https://echarts.apache.org/en/api.html#echarts.connect">ECharts</a>
</p>
</li>
<li><p> locale = EN(default) or ZH, set from <em>locale</em> parameter of <em>ec.init</em>,
see <a href="https://echarts.apache.org/en/api.html#echarts.init">ECharts</a>.
</p>
</li>
<li><p> renderer = <em>canvas</em>(default) or <em>svg</em>, set from <em>renderer</em> in
<em>ec.init</em>, see
<a href="https://echarts.apache.org/en/api.html#echarts.init">ECharts</a>.
</p>
</li>
<li><p> jcode = custom JavaScript code to execute, set from <em>js</em> parameter of
<em>ec.init</em>
</p>
</li></ul>




<h4>R vs Javascript numbering</h4>

<p>R language counting starts from 1.
Javascript (JS) counting starts from 0.
<em>ec.init</em> supports R-counting of indexes (ex. encode) and dimension (ex.
visualMap).
<em>ec.upd</em> requires indexes and dimensions to be set with JS-counting.
</p>



<h4>Javascript built-in functions</h4>

<p>To allow access to charts from JS.
<em>ec_chart(id)</em> - get the chart object by id (former get_e_charts)
<em>ec_option(id)</em> - get the chartâ€™s option object by id (former
get_e_charts_opt)
Parameter <em>id</em> could be the internal variable <em>echwid</em>, or the value set
through <em>ec.init</em> parameter <em>elementId</em>. See demo code in
<a href="https://github.com/helgasoft/echarty/blob/main/demo/examples.R">examples</a>
</p>



<h4>Code examples</h4>

<p>Here is the complete list of sample code <strong>locations</strong>:
</p>

<ul>
<li><p> website
<a href="https://helgasoft.github.io/echarty/articles/gallery.html">gallery</a>
</p>
</li>
<li> <p><a href="https://github.com/helgasoft/echarty/blob/main/demo/examples.R">demo examples</a>
</p>
</li>
<li><p> Shiny code is in
<a href="https://github.com/helgasoft/echarty/blob/main/demo/eshiny.R">eshiny.R</a>,
run with <code>demo(eshiny)</code>
</p>
</li>
<li><p> demos on <a href="https://rpubs.com/echarty">RPubs</a>
</p>
</li>
<li><p> searchable <a href="https://gist.github.com/helgasoft">gists</a>
</p>
</li>
<li><p> answers to <a href="https://github.com/helgasoft/echarty/issues">Github issues</a>
</p>
</li>
<li><p> code in <a href="https://github.com/helgasoft/echarty/tree/main/tests/testthat">Github tests</a>
</p>
</li>
<li><p> command examples, like in <em>?ec.init</em>
</p>
</li></ul>




<h4>Global Options</h4>

<p>Options are set with R command
<a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/options">options</a>.
Echarty uses the following options:
</p>

<ul>
<li><p> echarty.theme = name of theme file, without extension, from folder
<code style="white-space: pre;">&#8288;/inst/themes&#8288;</code>
</p>
</li>
<li><p> echarty.font = font family name
</p>
</li>
<li><p> echarty.urlTiles = tiles URL template for leaflet maps
</p>
</li></ul>

<div class="sourceCode r"><pre># set/get global options
options('echarty.theme'='jazz') # set
getOption('echarty.theme')      # get
#&gt; [1] "jazz"
options('echarty.theme'=NULL)   # remove
</pre></div>


<hr>
<h2 id='ec.clmn'>Data column format</h2><span id='topic+ec.clmn'></span>

<h3>Description</h3>

<p>Helper function to display/format data column(s) by index or name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.clmn(col = NULL, ..., scale = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.clmn_+3A_col">col</code></td>
<td>
<p>A single column index(number) or column name(quoted string), <br />
or a <a href="base.html#topic+sprintf">sprintf</a> string template for multiple columns.<br />
NULL(default) for charts with single values like tree, pie.<br />
'json' to display tooltip with all available values to choose from.<br />
'log' to write all values in the JS console (F12) for debugging.<br />
Can contain JS function starting with <em>'function('</em> or <em>'(x) =&gt; {'</em>.<br /></p>
</td></tr>
<tr><td><code id="ec.clmn_+3A_...">...</code></td>
<td>
<p>Comma separated column indexes or names, only when <em>col</em> is <em>sprintf</em>. This allows formatting of multiple columns, as for a tooltip.<br /></p>
</td></tr>
<tr><td><code id="ec.clmn_+3A_scale">scale</code></td>
<td>
<p>A positive number, multiplier for numeric columns. When scale is 0, all numeric values are rounded.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is useful for attributes like formatter, color, symbolSize, label.<br />
Column indexes are counted in R and start with 1.<br />
Omit <em>col</em> or use index -1 for single values in tree/pie charts, <em>axisLabel.formatter</em> or <em>valueFormatter</em>. See <a href="#topic+ec.data">ec.data</a> dendrogram example.<br />
Column indexes are decimals for combo charts with multiple series, see <a href="#topic+ecr.band">ecr.band</a> example. The whole number part is the serie index, the decimal part is the column index inside.<br />
<em>col</em> as sprintf has the same placeholder <em>%@</em> for both column indexes or column names.<br />
<em>col</em> as sprintf can contain double quotes, but not single or backquotes.<br />
Template placeholders with formatting:<br />
</p>

<ul>
<li> <p><em>%@</em> will display column value as-is.<br />
</p>
</li>
<li> <p><em>%L@</em> will display a number in locale format, like '12,345.09'.<br />
</p>
</li>
<li> <p><em>%LR@</em> rounded number in locale format, like '12,345'.<br />
</p>
</li>
<li> <p><em>%R@</em> rounded number, like '12345'.<br />
</p>
</li>
<li> <p><em>%R2@</em> rounded number, two digits after decimal point.<br />
</p>
</li>
<li> <p><em>%M@</em> marker in series' color.<br />
For <em>trigger='axis'</em> (multiple series) one can use decimal column indexes.<br />
See definition above and example below.
</p>
</li></ul>



<h3>Value</h3>

<p>A JavaScript code string (usually a function) marked as executable, see <a href="htmlwidgets.html#topic+JS">JS</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
tmp &lt;- data.frame(Species = as.vector(unique(iris$Species)),
                  emoji = c('A','B','C'))
df &lt;- iris |&gt; inner_join(tmp)      # add 6th column emoji
df |&gt; group_by(Species) |&gt; ec.init(
  series.param= list(label= list(show= TRUE, formatter= ec.clmn('emoji'))),
  tooltip= list(formatter=
    # with sprintf template + multiple column indexes
    ec.clmn('%M@ species &lt;b&gt;%@&lt;/b&gt;&lt;br&gt;s.len &lt;b&gt;%@&lt;/b&gt;&lt;br&gt;s.wid &lt;b&gt;%@&lt;/b&gt;', 5,1,2))
)

# tooltip decimal indexes work with full data sets (no missing/partial data)
ChickWeight |&gt; mutate(Chick=as.numeric(Chick)) |&gt; filter(Chick&gt;47) |&gt; group_by(Chick) |&gt;
ec.init(
  tooltip= list(trigger='axis', 
                formatter= ec.clmn("48: %@&lt;br&gt;49: %@&lt;br&gt;50: %@", 1.1, 2.1, 3.1)),
  xAxis= list(type='category'), legend= list(formatter= 'Ch.{name}'),
  series.param= list(type='line', encode= list(x='Time', y='weight')),
)
</code></pre>

<hr>
<h2 id='ec.data'>Data helper</h2><span id='topic+ec.data'></span>

<h3>Description</h3>

<p>Make data lists from a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.data(df, format = "dataset", header = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.data_+3A_df">df</code></td>
<td>
<p>Required chart data as <strong>data.frame</strong>. <br />
Except when format is <em>dendrogram</em>, then df is a <strong>list</strong>, result of <a href="stats.html#topic+hclust">hclust</a> function.<br /></p>
</td></tr>
<tr><td><code id="ec.data_+3A_format">format</code></td>
<td>
<p>Output list format<br /> </p>

<ul>
<li> <p><strong>dataset</strong> = list to be used in <a href="https://echarts.apache.org/en/option.html#dataset.source">dataset</a> (default), or in <a href="https://echarts.apache.org/en/option.html#series-scatter.data">series.data</a> (without header). <br />
</p>
</li>
<li> <p><strong>values</strong> = list for customized <a href="https://echarts.apache.org/en/option.html#series-scatter.data">series.data</a> <br />
</p>
</li>
<li> <p><strong>names</strong> = named lists useful for named data like <a href="https://echarts.apache.org/en/option.html#series-sankey.links">sankey links</a>.
</p>
</li>
<li> <p><strong>dendrogram</strong> = build series data for Hierarchical Clustering dendrogram
</p>
</li>
<li> <p><strong>treePC</strong> = build series data for tree charts from parent/children data.frame
</p>
</li>
<li> <p><strong>treeTT</strong> = build series data for tree charts from data.frame like Titanic.<br />
</p>
</li>
<li> <p><strong>boxplot</strong> = build dataset and source lists, see Details
</p>
</li></ul>
</td></tr>
<tr><td><code id="ec.data_+3A_header">header</code></td>
<td>
<p>for dataset, to include the column names or not, default TRUE. Set it to FALSE for <a href="https://echarts.apache.org/en/option.html#series-scatter.data">series.data</a>.<br /></p>
</td></tr>
<tr><td><code id="ec.data_+3A_...">...</code></td>
<td>
<p>optional parameters<br />
Optional parameters for <strong>boxplot</strong> are:<br />
</p>

<ul>
<li> <p><em>layout</em> = 'h' for horizontal(default) or 'v' for vertical layout<br />
</p>
</li>
<li> <p><em>outliers</em> boolean to add outlier points (default FALSE)<br />
</p>
</li>
<li> <p><em>jitter</em> value for <a href="base.html#topic+jitter">jitter</a> of numerical values in second column, default 0 (no scatter). Adds scatter series on top of boxplot.<br />
</p>
</li></ul>

<p>Optional parameter for <strong>names</strong>:<br />
</p>

<ul>
<li> <p><em>nasep</em> = single character name separator for nested lists, see Examples. <br />
Purpose is to facilitate conversion from <em>data.frame</em> to nested named lists.<br />
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p><code>format='boxplot'</code> requires the first two <em>df</em> columns as: <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>column for the non-computational categorical axis<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>column with (numeric) data to compute the five boxplot values<br />
Additional grouping is supported on a column after the second. Groups will show in the legend, if enabled.<br />
Returns a <code>list(dataset, series, xAxis, yAxis)</code> to set params in <a href="#topic+ec.init">ec.init</a>.
Make sure there is enough data for computation, 4+ values per boxplot.<br />
<code>format='treeTT'</code> expects data.frame <em>df</em> columns <em>pathString,value,(optional itemStyle)</em> for <a href="data.tree.html#topic+FromDataFrameTable">FromDataFrameTable</a>.<br />
It will add column 'pct' with value percentage for each node. See example below.
</p>


<h3>Value</h3>

<p>A list for <em>dataset.source</em>, <em>series.data</em> or other lists:<br />
For boxplot - a named list, see Details and Examples <br />
For dendrogram &amp; treePC - a tree structure, see format in <a href="https://echarts.apache.org/en/option.html#series-tree.data">tree data</a>
</p>


<h3>See Also</h3>

<p>some live <a href="https://rpubs.com/echarty/data-models">code samples</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
ds &lt;- iris |&gt; relocate(Species) |&gt;
	 ec.data(format= 'boxplot', jitter= 0.1, layout= 'v')
ec.init(
  dataset= ds$dataset, series= ds$series, xAxis= ds$xAxis, yAxis= ds$yAxis,
  legend= list(show= TRUE), tooltip= list(show= TRUE)
)

hc &lt;- hclust(dist(USArrests), "complete")
ec.init(preset= FALSE,
  series= list(list(
    type= 'tree', orient= 'TB', roam= TRUE, initialTreeDepth= -1,
    data= ec.data(hc, format='dendrogram'),
    layout= 'radial', # symbolSize= ec.clmn(scale= 0.33),
    ## exclude added labels like 'pXX', leaving only the originals
    label= list(formatter= htmlwidgets::JS(
      "function(n) { out= /p\\d+/.test(n.name) ? '' : n.name; return out;}"))
  ))
)

# build required pathString,value and optional itemStyle columns
df &lt;- as.data.frame(Titanic) |&gt; rename(value= Freq) |&gt; mutate(
  pathString= paste('Titanic\nSurvival', Survived, Age, Sex, Class, sep='/'),
	 itemStyle= case_when(Survived=='Yes' ~"color='green'", TRUE ~"color='LightSalmon'")) |&gt;
	 select(pathString, value, itemStyle)
ec.init(
	  series= list(list(
		  data= ec.data(df, format='treeTT'),
		  type= 'tree', symbolSize= ec.clmn("(x) =&gt; {return Math.log(x)*10}")
	  )),
	  tooltip= list(formatter= ec.clmn('%@&lt;br&gt;%@%','value','pct'))
)

# column itemStyle_color will become itemStyle= list(color=...) in data list
# attribute names separator (nasep) is "_"
df &lt;- data.frame(name= c('A','B','C'), value= c(1,2,3), 
     itemStyle_color= c('chartreuse','lightblue','pink'),
     itemStyle_decal_symbol= c('rect','diamond','none'),
     emphasis_itemStyle_color= c('darkgreen','blue','red')
)
ec.init(series.param= list(type='pie', data= ec.data(df, 'names', nasep='_')))

</code></pre>

<hr>
<h2 id='ec.fromJson'>JSON to chart</h2><span id='topic+ec.fromJson'></span>

<h3>Description</h3>

<p>Convert JSON string or file to chart
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.fromJson(txt, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.fromJson_+3A_txt">txt</code></td>
<td>
<p>Could be one of the following:<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>class <em>url</em>, like <code>url('https://serv.us/cars.txt')</code><br />
<code style="white-space: pre;">&#8288;     &#8288;</code>class <em>file</em>, like <code>file('c:/temp/cars.txt','rb')</code><br />
<code style="white-space: pre;">&#8288;     &#8288;</code>class <em>json</em>, like <code>ec.inspect(p)</code>, for options or full<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>class <em>character</em>, JSON string with options only, see example below<br /></p>
</td></tr>
<tr><td><code id="ec.fromJson_+3A_...">...</code></td>
<td>
<p>Any attributes to pass to internal <a href="#topic+ec.init">ec.init</a> when <em>txt</em> is options only</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>txt</em> could be either a list of options (x$opts) to be set by <a href="https://echarts.apache.org/en/api.html#echartsInstance.setOption">setOption</a>,<br />
OR an entire <em>htmlwidget</em> generated thru <a href="#topic+ec.inspect">ec.inspect</a> with <em>target='full'</em>.<br />
The latter imports all JavaScript functions defined by the user.
</p>


<h3>Value</h3>

<p>An <em>echarty</em> widget.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>txt &lt;- '{
   "xAxis": { "data": ["Mon", "Tue", "Wed"]}, "yAxis": { },
   "series": { "type": "line", "data": [150, 230, 224] } }'
ec.fromJson(txt)  # text json
# outFile &lt;- 'c:/temp/cars.json'
# cars |&gt; ec.init() |&gt; ec.inspect(target='full', file=outFile)
# ec.fromJson(file(outFile, 'rb'))
# ec.fromJson(url('http://localhost/echarty/cars.json'))

ec.fromJson('https://helgasoft.github.io/echarty/test/pfull.json')
</code></pre>

<hr>
<h2 id='ec.init'>Initialize command</h2><span id='topic+ec.init'></span>

<h3>Description</h3>

<p>Required to build a chart. In most cases this will be the only command necessary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.init(
  df = NULL,
  preset = TRUE,
  ctype = "scatter",
  ...,
  series.param = NULL,
  tl.series = NULL,
  width = NULL,
  height = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.init_+3A_df">df</code></td>
<td>
<p>Optional data.frame to be preset as <a href="https://echarts.apache.org/en/option.html#dataset">dataset</a>, default NULL <br />
By default the first column is for X values, second column is for Y, and third is for Z when in 3D.<br />
Best practice is to have the grouping column placed last. Grouping column cannot be used as axis.<br />
Timeline requires a <em>grouped data.frame</em> to build its <a href="https://echarts.apache.org/en/option.html#options">options</a>.<br />
If grouping is on multiple columns, only the first one is used to determine settings.</p>
</td></tr>
<tr><td><code id="ec.init_+3A_preset">preset</code></td>
<td>
<p>Boolean (default TRUE). Build preset attributes like dataset, series, xAxis, yAxis, etc.<br />
When preset is FALSE, these attributes need to be set explicitly.<br /></p>
</td></tr>
<tr><td><code id="ec.init_+3A_ctype">ctype</code></td>
<td>
<p>Chart type, default is 'scatter'. Could be set in <em>series.param</em> instead.</p>
</td></tr>
<tr><td><code id="ec.init_+3A_...">...</code></td>
<td>
<p>Optional widget attributes. See Details. <br /></p>
</td></tr>
<tr><td><code id="ec.init_+3A_series.param">series.param</code></td>
<td>
<p>Additional attributes for single preset series, default is NULL.<br />
Defines a <strong>single</strong> series for both non-timeline and timeline charts. <br />
<strong>Multiple</strong> series should be defined directly with <em>series=list(list(type=...),list(type=...))</em> or added with <a href="#topic+ec.upd">ec.upd</a>.</p>
</td></tr>
<tr><td><code id="ec.init_+3A_tl.series">tl.series</code></td>
<td>
<p>Deprecated, use <em>timeline</em> and <em>series.param</em> instead.<br /></p>
</td></tr>
<tr><td><code id="ec.init_+3A_width">width</code>, <code id="ec.init_+3A_height">height</code></td>
<td>
<p>Optional valid CSS unit (like <code>'100%'</code>,
<code>'500px'</code>, <code>'auto'</code>) or a number, which will be coerced to a
string and have <code>'px'</code> appended.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Command <em>ec.init</em> creates a widget with <a href="htmlwidgets.html#topic+createWidget">createWidget</a>, then adds some ECharts features to it.<br />
Numerical indexes for series,visualMap,etc. are R-counted (1,2...)<br />
</p>
<p><strong>Presets</strong> <br />
When data.frame <strong>df</strong> is present, a <a href="https://echarts.apache.org/en/option.html#dataset">dataset</a> is preset. <br />
When <strong>df</strong> is grouped and <em>ctype</em> is not NULL, more datasets with legend and series are also preset. <br />
Plugin '3D' (load='3D') is required for GL series like <em>scatterGL, linesGL</em>, etc. <br />
Plugins 'leaflet' and 'world' preset <em>center</em> to the mean of all coordinates from <strong>df</strong>. <br />
Users can delete or overwrite any presets as needed. <br />
</p>
<p><strong>Widget attributes</strong> <br />
Optional echarty widget attributes include: <br />
</p>

<ul>
<li><p> elementId - Id of the widget, default is NULL(auto-generated)
</p>
</li>
<li><p> load - name(s) of plugin(s) to load. A character vector or comma-delimited string. default NULL.
</p>
</li>
<li><p> ask - prompt user before downloading plugins when <em>load</em> is present, FALSE by default
</p>
</li>
<li><p> js - single string or a vector with JavaScript expressions to evaluate.<br />
single: exposed <em>chart</em> object (most common)<br />
vector: <code style="white-space: pre;">&#8288;     &#8288;</code>see code in <a href="https://github.com/helgasoft/echarty/blob/main/demo/examples.R">examples</a><br />
<code style="white-space: pre;">&#8288;     &#8288;</code>First expression evaluated before initialization, exposed object <em>window</em> <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>Second is evaluated with exposed object <em>opts</em>. <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>Third is evaluated with exposed <em>chart</em> object after <em>opts</em> set.
</p>
</li>
<li><p> renderer - 'canvas'(default) or 'svg'
</p>
</li>
<li><p> locale - 'EN'(default) or 'ZH'. Use predefined or custom <a href="https://gist.github.com/helgasoft/0618c6537c45bfd9e86d3f9e1da497b8">like so</a>.
</p>
</li>
<li><p> useDirtyRect - enable dirty rectangle rendering or not, FALSE by default, see <a href="https://echarts.apache.org/en/api.html#echarts.init">here</a><br />
</p>
</li></ul>

<p><strong>Built-in plugins</strong> <br />
</p>

<ul>
<li><p> leaflet - Leaflet maps with customizable tiles, see <a href="https://github.com/gnijuohz/echarts-leaflet#readme">source</a><br />
</p>
</li>
<li><p> world - world map with country boundaries, see <a href="https://github.com/apache/echarts/tree/master/test/data/map/js">source</a> <br />
</p>
</li>
<li><p> lottie - support for <a href="https://lottiefiles.com">lotties</a> <br />
</p>
</li>
<li><p> ecStat - statistical tools, see<a href="https://github.com/ecomfe/echarts-stat">echarts-stat</a><br />
</p>
</li>
<li><p> custom - renderers for <a href="#topic+ecr.band">ecr.band</a> and <a href="#topic+ecr.ebars">ecr.ebars</a> <br />
Plugins with one-time installation: <br />
</p>
</li>
<li><p> 3D - support for 3D charts and WebGL acceleration, see <a href="https://github.com/ecomfe/echarts-gl">source</a> and <a href="https://echarts.apache.org/en/option-gl.html#series">docs</a> <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>This plugin is auto-loaded when 3D/GL axes/series are detected.<br />
</p>
</li>
<li><p> liquid - liquid fill, see <a href="https://github.com/ecomfe/echarts-liquidfill">source</a>  <br />
</p>
</li>
<li><p> gmodular - graph modularity, see <a href="https://github.com/ecomfe/echarts-graph-modularity">source</a>  <br />
</p>
</li>
<li><p> wordcloud - cloud of words, see <a href="https://github.com/ecomfe/echarts-wordcloud">source</a> <br />
or install your own third-party plugins.<br />
</p>
</li></ul>

<p><strong>Crosstalk</strong> <br />
Parameter <em>df</em> should be of type <a href="crosstalk.html#topic+SharedData">SharedData</a>, see <a href="https://helgasoft.github.io/echarty/articles/gallery.html#crosstalk-2d">more info</a>.<br />
Optional parameter <em>xtKey</em>: unique ID column name of data frame <em>df</em>. Must be same as <em>key</em> parameter used in <em>SharedData$new()</em>. If missing, a new column <em>XkeyX</em> will be appended to df.<br />
Enabling <em>crosstalk</em> will also generate an additional dataset called <em>Xtalk</em> and bind the <strong>first series</strong> to it.<br />
</p>
<p><strong>Timeline</strong> <br />
Defined by <em>series.param</em> for the <a href="https://echarts.apache.org/en/option.html#series">options series</a> and a <em>timeline</em> list for the <a href="https://echarts.apache.org/en/option.html#timeline">actual control</a>.
A grouped <em>df</em> is required, each group providing data for one option serie.
Timeline <a href="https://echarts.apache.org/en/option.html#timeline.data">data</a> and <a href="https://echarts.apache.org/en/option.html#options">options</a> will be preset for the chart.<br />
Each option title can include the current timeline item by adding a placeholder '%@' in title$text. See example below.<br />
Another preset is <em>encode(x=1,y=2,z=3)</em>, which are the first 3 columns of <em>df</em>. Parameter <em>z</em> is ignored in 2D. See Details below.<br />
Optional attribute <em>groupBy</em>, a <em>df</em> column name, can create series groups inside each timeline option.<br />
Options/timeline for hierarchical charts like graph,tree,treemap,sankey have to be built directly, see <a href="https://helgasoft.github.io/echarty/uc4.html">example</a>.
</p>
<p>Optional series attribute <a href="https://echarts.apache.org/en/option.html#series-line.encode">encode</a> defines which columns to use for the axes, depending on chart type and coordinate system: <br />
</p>

<ul>
<li><p> set <em>x</em> and <em>y</em> for coordinateSystem <em>cartesian2d</em>
</p>
</li>
<li><p> set <em>lng</em> and <em>lat</em> for coordinateSystem <em>geo</em> and <em>scatter</em> series
</p>
</li>
<li><p> set <em>value</em> and <em>name</em> for coordinateSystem <em>geo</em> and <em>map</em> series
</p>
</li>
<li><p> set <em>radius</em> and <em>angle</em> for coordinateSystem <em>polar</em>
</p>
</li>
<li><p> set <em>value</em> and <em>itemName</em> for <em>pie</em> chart.
</p>
</li></ul>

<p>Example: <code>encode(x='col3', y='col1')</code> binds xAxis to <em>df</em> column 'col3'.
</p>


<h3>Value</h3>

<p>A widget to plot, or to save and expand with more features.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # basic scatter chart from a data.frame, using presets
cars |&gt; ec.init()
 
 # grouping, tooltips, formatting
iris |&gt; dplyr::group_by(Species) |&gt; 
ec.init(        # init with presets
  tooltip= list(show= TRUE),
  series.param= list( 
    symbolSize= ec.clmn('Petal.Width', scale=7),
    tooltip= list(formatter= ec.clmn('Petal.Width: %@', 'Petal.Width'))
  )
)

data.frame(n=1:5) |&gt; dplyr::group_by(n) |&gt; ec.init(
  title= list(text= "gauge #%@"),
  timeline= list(show=TRUE, autoPlay=TRUE),
  series.param= list(type='gauge', max=5)
)

</code></pre>

<hr>
<h2 id='ec.inspect'>Chart to JSON</h2><span id='topic+ec.inspect'></span>

<h3>Description</h3>

<p>Convert chart to JSON string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.inspect(wt, target = "opts", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.inspect_+3A_wt">wt</code></td>
<td>
<p>An <code>echarty</code> widget as returned by <a href="#topic+ec.init">ec.init</a></p>
</td></tr>
<tr><td><code id="ec.inspect_+3A_target">target</code></td>
<td>
<p>type of resulting value: <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>'opts' - the htmlwidget <em>options</em> as JSON (default)<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>'full' - the <em>entire</em> htmlwidget as JSON<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>'data' - info about chart's embedded data (char vector)</p>
</td></tr>
<tr><td><code id="ec.inspect_+3A_...">...</code></td>
<td>
<p>Additional attributes to pass to <a href="jsonlite.html#topic+toJSON">toJSON</a><br />
'file' - optional file name to save to when target='full'<br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Must be invoked or chained as last command.<br />
target='full' will export all JavaScript custom code, ready to be used on import.<br />
See also <a href="#topic+ec.fromJson">ec.fromJson</a>.
</p>


<h3>Value</h3>

<p>A JSON string, except when <code>target</code> is 'data' - then
a character vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># extract JSON
json &lt;- cars |&gt; ec.init() |&gt; ec.inspect()
json

# get from JSON and modify plot
ec.fromJson(json) |&gt; ec.theme('macarons')

</code></pre>

<hr>
<h2 id='ec.paxis'>Parallel Axis</h2><span id='topic+ec.paxis'></span>

<h3>Description</h3>

<p>Build 'parallelAxis' for a parallel chart
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.paxis(dfwt = NULL, cols = NULL, minmax = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.paxis_+3A_dfwt">dfwt</code></td>
<td>
<p>An echarty widget OR a data.frame(regular or grouped)</p>
</td></tr>
<tr><td><code id="ec.paxis_+3A_cols">cols</code></td>
<td>
<p>A string vector with columns names in desired order</p>
</td></tr>
<tr><td><code id="ec.paxis_+3A_minmax">minmax</code></td>
<td>
<p>Boolean to add max/min limits or not, default TRUE</p>
</td></tr>
<tr><td><code id="ec.paxis_+3A_...">...</code></td>
<td>
<p>Additional attributes for <a href="https://echarts.apache.org/en/option.html#parallelAxis">parallelAxis</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function could be chained to <em>ec.init</em> or used with a <em>data.frame</em><br />
</p>


<h3>Value</h3>

<p>A list, see format in <a href="https://echarts.apache.org/en/option.html#parallelAxis">parallelAxis</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>iris |&gt; dplyr::group_by(Species) |&gt;    # chained
ec.init(ctype= 'parallel', series.param= list(lineStyle= list(width=3))) |&gt; 
ec.paxis(cols= c('Petal.Length','Petal.Width','Sepal.Width'))

mtcars |&gt; ec.init(ctype= 'parallel', 
   parallelAxis= ec.paxis(mtcars, cols= c('gear','cyl','hp','carb'), nameRotate= 45),
   series.param= list(smooth= TRUE)
)

</code></pre>

<hr>
<h2 id='ec.plugjs'>Install Javascript plugin from URL source</h2><span id='topic+ec.plugjs'></span>

<h3>Description</h3>

<p>Install Javascript plugin from URL source
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.plugjs(wt = NULL, source = NULL, ask = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.plugjs_+3A_wt">wt</code></td>
<td>
<p>A widget to add dependency to, see <a href="htmlwidgets.html#topic+createWidget">createWidget</a></p>
</td></tr>
<tr><td><code id="ec.plugjs_+3A_source">source</code></td>
<td>
<p>URL or file:// of a Javascript plugin, <br />
file name suffix is '.js'. Default is NULL.</p>
</td></tr>
<tr><td><code id="ec.plugjs_+3A_ask">ask</code></td>
<td>
<p>Boolean, to ask the user to download source if missing. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <em>source</em> is URL, the plugin file is installed with an optional popup prompt.<br />
When <em>source</em> is a file name (file://xxx.js), it is assumed installed and only a dependency is added.<br />
When <em>source</em> is invalid, an error message will be written in the chart's title.<br />
Called internally by <a href="#topic+ec.init">ec.init</a>. It is recommended to use <em>ec.init(load=...)</em> instead of <em>ec.plugjs</em>.
</p>


<h3>Value</h3>

<p>A widget with JS dependency added if successful, otherwise input wt
</p>


<h3>Examples</h3>

<pre><code class='language-R'># import map plugin and display two (lon,lat) locations
if (interactive()) {
  durl &lt;- paste0('https://raw.githubusercontent.com/apache/echarts/',
           'master/test/data/map/js/china-contour.js')
  ec.init(  # load= durl,
    geo = list(map= 'china-contour', roam= TRUE),
    series.param = list(
      type= 'scatter', coordinateSystem= 'geo',
      symbolSize= 9, itemStyle= list(color= 'red'),
      data= list(list(value= c(113, 40)), list(value= c(118, 39))) )
  ) |&gt; 
  ec.plugjs(durl)
}
</code></pre>

<hr>
<h2 id='ec.theme'>Themes</h2><span id='topic+ec.theme'></span>

<h3>Description</h3>

<p>Apply a pre-built or custom coded theme to a chart
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.theme(wt, name = "custom", code = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.theme_+3A_wt">wt</code></td>
<td>
<p>Required <code>echarty</code> widget as returned by <a href="#topic+ec.init">ec.init</a></p>
</td></tr>
<tr><td><code id="ec.theme_+3A_name">name</code></td>
<td>
<p>Name of existing theme file (without extension), or name of custom theme defined in <code>code</code>.</p>
</td></tr>
<tr><td><code id="ec.theme_+3A_code">code</code></td>
<td>
<p>Custom theme as JSON formatted string, default NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Just a few built-in themes are included in folder <code>inst/themes</code>.<br />
Their names are dark, gray, jazz, dark-mushroom and macarons.<br />
The entire ECharts theme collection could be found <a href="https://github.com/apache/echarts/tree/master/theme">here</a> and files copied if needed.<br />
To create custom themes or view predefined ones, visit <a href="https://echarts.apache.org/en/theme-builder.html">this site</a>.
</p>


<h3>Value</h3>

<p>An <code>echarty</code> widget.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mtcars |&gt; ec.init() |&gt; ec.theme('dark-mushroom')
cars |&gt; ec.init() |&gt; ec.theme('mine', code=
  '{"color": ["green","#eeaa33"], 
    "backgroundColor": "lemonchiffon"}')

</code></pre>

<hr>
<h2 id='ec.upd'>Update option lists</h2><span id='topic+ec.upd'></span>

<h3>Description</h3>

<p>Chain commands after ec.init to add or update chart items
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.upd(wt, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.upd_+3A_wt">wt</code></td>
<td>
<p>An echarty widget</p>
</td></tr>
<tr><td><code id="ec.upd_+3A_...">...</code></td>
<td>
<p>R commands to add/update chart option lists</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>ec.upd</em> makes changes to a chart already set by <a href="#topic+ec.init">ec.init</a>.<br />
It should be always piped(chained) after <a href="#topic+ec.init">ec.init</a>.<br />
All numerical indexes for series,visualMap,etc. are JS-counted starting at 0.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
df &lt;- data.frame(x= 1:30, y= runif(30, 5, 10), cat= sample(LETTERS[1:3],size=30,replace=TRUE)) |&gt;
  		mutate(lwr= y-runif(30, 1, 3), upr= y+runif(30, 2, 4))
band.df &lt;- df  |&gt; group_by(cat) |&gt; group_split()

df |&gt; group_by(cat) |&gt; 
ec.init(load='custom', ctype='line', 
        xAxis=list(data=c(0,unique(df$x)), boundaryGap=FALSE) ) |&gt; 
ec.upd({
  for(ii in 1:length(band.df))   # add bands to their respective groups
    series &lt;- append(series,   
      ecr.band(band.df[[ii]], 'lwr', 'upr', type='stack', smooth=FALSE,
         name= unique(band.df[[ii]]$cat), areaStyle= list(color=c('blue','green','yellow')[ii])) )
})
</code></pre>

<hr>
<h2 id='ec.util'>Utility functions</h2><span id='topic+ec.util'></span>

<h3>Description</h3>

<p>tabset, table layout, support for GIS shapefiles through library 'sf'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.util(..., cmd = "sf.series", js = NULL, event = "click")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ec.util_+3A_...">...</code></td>
<td>
<p>Optional parameters for the command <br />
for <em>sf.series</em> - see <a href="https://echarts.apache.org/en/option.html#series-scatter.type">points</a>, <a href="https://echarts.apache.org/en/option.html#series-lines.type">polylines</a>, polygons(itemStyle).<br />
for <em>tabset</em> parameters should be in format <em>name1=chart1, name2=chart2</em>, see example<br /></p>
</td></tr>
<tr><td><code id="ec.util_+3A_cmd">cmd</code></td>
<td>
<p>utility command, see Details</p>
</td></tr>
<tr><td><code id="ec.util_+3A_js">js</code></td>
<td>
<p>optional JavaScript function, default is NULL.</p>
</td></tr>
<tr><td><code id="ec.util_+3A_event">event</code></td>
<td>
<p>optional event name for cmd='morph'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>cmd = 'sf.series'</strong><br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Build <em>leaflet</em> or <a href="https://echarts.apache.org/en/option.html#geo.map">geo</a> map series from shapefiles.<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Supported types: POINT, MULTIPOINT, LINESTRING, MULTILINESTRING, POLYGON, MULTIPOLYGON <br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Coordinate system is <em>leaflet</em>(default), <em>geo</em> or <em>cartesian3D</em> (for POINT(xyz))<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Limitations:<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>polygons can have only their name in tooltip,  <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>assumes Geodetic CRS is WGS 84, for conversion use <a href="sf.html#topic+st_transform">st_transform</a> with <em>crs=4326</em>.<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Parameters:<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>df - value from <a href="sf.html#topic+st_read">st_read</a><br />
<code style="white-space: pre;">&#8288;     &#8288;</code>nid - optional column name for name-id used in tooltips<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>cs - optional <em>coordinateSystem</em> value, default 'leaflet'<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>verbose - optional, print shapefile item names in console<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Returns a list of chart series<br />
<strong>cmd = 'sf.bbox'</strong><br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Returns JavaScript code to position a map inside a bounding box from <a href="sf.html#topic+st_bbox">st_bbox</a>, for leaflet only.<br />
<strong>cmd = 'sf.unzip'</strong><br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Unzips a remote file and returns local file name of the unzipped .shp file<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>url - URL of remote zipped shapefile<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>shp - optional name of .shp file inside ZIP file if multiple exist. Do not add file extension. <br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Returns full name of unzipped .shp file, or error string starting with 'ERROR'<br />
<strong>cmd = 'geojson'</strong> <br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Custom series list from geoJson objects<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>geojson - object from <a href="jsonlite.html#topic+fromJSON">fromJSON</a><br />
<code style="white-space: pre;">&#8288;     &#8288;</code>cs - optional <em>coordinateSystem</em> value, default 'leaflet'<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>ppfill - optional fill color like '#F00', OR NULL for no-fill, for all Points and Polygons<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>nid - optional feature property for item name used in tooltips<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>... - optional custom series attributes like <em>itemStyle</em><br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Can display also geoJson <em>feature properties</em>: color; lwidth, ldash (lines); ppfill, radius (points)<br />
<strong>cmd = 'layout'</strong> <br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Multiple charts in table-like rows/columns format<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>... - List of charts<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>title - optional title for the entire set<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>rows - optional number of rows<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>cols - optional number of columns<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Returns a container <a href="htmltools.html#topic+div">div</a> in rmarkdown, otherwise <a href="htmltools.html#topic+browsable">browsable</a>.<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>For 3-4 charts one would use multiple series within a <a href="https://echarts.apache.org/en/option.html#grid">grid</a>. <br />
<code style="white-space: pre;">&#8288;  &#8288;</code>For greater number of charts <em>ec.util(cmd='layout')</em> comes in handy<br />
<strong>cmd = 'tabset'</strong> <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>... - a list name/chart pairs like <em>n1=chart1, n2=chart2</em>, each tab may contain a chart.<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>tabStyle - tab style string, see default <em>tabStyle</em> variable in the code<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Returns A) <a href="htmltools.html#topic+tagList">tagList</a> of tabs when in a pipe without '...' params, see example<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Returns B) <a href="htmltools.html#topic+browsable">browsable</a> when '...' params are provided by user<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Please note that sometimes those tabsets do not merge well inside advanced web pages.<br />
<strong>cmd = 'button'</strong> <br />
<code style="white-space: pre;">&#8288;  &#8288;</code>UI button to execute a JS function,<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>text - the button label<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>js - the JS function string<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>... - optional parameters for the <a href="https://echarts.apache.org/en/option.html#graphic.elements-rect.type">rect</a> element<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Returns a graphic.elements-<a href="https://echarts.apache.org/en/option.html#graphic.elements-rect.type">rect</a> element.<br />
<strong>cmd = 'morph'</strong> <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>... - a list of charts or chart option lists<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>event - name of event for switching charts. Default is <em>click</em>.<br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Returns a chart with ability to morph into other charts<br />
<strong>cmd = 'fullscreen'</strong> <br />
<code style="white-space: pre;">&#8288;  &#8288;</code>A toolbox feature to toggle fullscreen on/off. Works in a browser, not in RStudio.<br />
<strong>cmd = 'rescale'</strong> <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>v - input vector of numeric values to rescale<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>t - target range c(min,max), numeric vector of two<br />
<strong>cmd = 'level'</strong> <br />
<code style="white-space: pre;">&#8288;  &#8288;</code>Calculate vertical levels for timeline <em>line</em> charts, returns a numeric vector<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>df - data.frame with <em>from</em> and <em>to</em> columns<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>from - name of 'from' column<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>to - name of 'to' column<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
if (interactive()) {  # comm.out: Cran Fedora errors about some 'browser'
  library(sf)
  fname &lt;- system.file("shape/nc.shp", package="sf")
  nc &lt;- as.data.frame(st_read(fname))
  ec.init(load= c('leaflet', 'custom'),  # load custom for polygons
     js= ec.util(cmd= 'sf.bbox', bbox= st_bbox(nc$geometry)),
     series= ec.util(cmd= 'sf.series', df= nc, nid= 'NAME', itemStyle= list(opacity=0.3)),
     tooltip= list(formatter= '{a}')
  )

  htmltools::browsable(
    lapply(iris |&gt; group_by(Species) |&gt; group_split(), 
           function(x) {
     x |&gt; ec.init(ctype= 'scatter', title= list(text= unique(x$Species)))
           }) |&gt; 
    ec.util(cmd= 'tabset')
  )

  p1 &lt;- cars |&gt; ec.init(grid= list(top=26), height=333)  # move chart up
  p2 &lt;- mtcars |&gt; arrange(mpg) |&gt; ec.init(height=333, ctype='line')
  ec.util(cmd= 'tabset', cars= p1, mtcars= p2)


  cars |&gt; ec.init(
    graphic = list(
      ec.util(cmd='button', text='see type', right='center', top=20,
        js="function(a) {op=ec_option(echwid); alert(op.series[0].type);}")
    )
  )

  lapply(list('dark','macarons','gray','jazz','dark-mushroom'),
    function(x) cars |&gt; ec.init(grid= list(bottom=0)) |&gt; ec.theme(x) ) |&gt;
  ec.util(cmd='layout', cols= 2, title= 'my layout')
}

colors &lt;- c("blue","red","green")
cyls &lt;- as.character(sort(unique(mtcars$cyl)))
sers &lt;- lapply(mtcars |&gt; group_by(cyl) |&gt; group_split(), \(x) {
  cyl &lt;- as.character(unique(x$cyl))
  list(type='scatter', id=cyl, dataGroupId=cyl, 
       data= ec.data(x |&gt; select(mpg,hp)),
       universalTransition= TRUE)
})
oscatter &lt;- list(
  title= list(subtext='click points to morph'), 
  color= colors, tooltip= list(show=TRUE),
  xAxis= list(scale=TRUE, name='mpg'), yAxis= list(scale=TRUE, name='hp'),
  series= sers
)
opie &lt;- list(
  title= list(text= 'Average hp'), 
  color= colors, tooltip= list(show=TRUE),
  series= list(list(
    type= 'pie', label= list(show=TRUE), colorBy= 'data',
    data= ec.data(mtcars |&gt; group_by(cyl) |&gt; summarize(value= mean(hp)) |&gt;
       mutate(groupId= as.character(cyl), name= as.character(cyl)),'names'),
    universalTransition= list(enabled=TRUE, seriesKey= cyls)
  ))
)
ec.util(cmd='morph', oscatter, opie) 
  
</code></pre>

<hr>
<h2 id='ecr.band'>Area band</h2><span id='topic+ecr.band'></span>

<h3>Description</h3>

<p>A 'custom' serie with lower and upper boundaries
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecr.band(df = NULL, lower = NULL, upper = NULL, type = "polygon", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecr.band_+3A_df">df</code></td>
<td>
<p>A data.frame with lower and upper numerical columns and first column with X coordinates.</p>
</td></tr>
<tr><td><code id="ecr.band_+3A_lower">lower</code></td>
<td>
<p>The column name of band's lower boundary (string).</p>
</td></tr>
<tr><td><code id="ecr.band_+3A_upper">upper</code></td>
<td>
<p>The column name of band's upper boundary (string).</p>
</td></tr>
<tr><td><code id="ecr.band_+3A_type">type</code></td>
<td>
<p>Type of rendering
</p>

<ul>
<li><p> 'polygon' - by drawing a polygon as polyline from upper/lower points (default)
</p>
</li>
<li><p> 'stack' - by two <a href="https://echarts.apache.org/en/option.html#series-line.stack">stacked lines</a>
</p>
</li></ul>
</td></tr>
<tr><td><code id="ecr.band_+3A_...">...</code></td>
<td>
<p>More attributes for <a href="https://echarts.apache.org/en/option.html#series-line.type">serie</a></p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> type='polygon': coordinates of the two boundaries are chained into one polygon.<br />
<code style="white-space: pre;">&#8288;     &#8288;</code><em>xAxis type</em> could be 'category' or 'value'.<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>Set fill color with attribute <em>color</em>.
</p>
</li>
<li><p> type='stack': two <em>stacked</em> lines are drawn, the lower with customizable areaStyle.<br />
<code style="white-space: pre;">&#8288;     &#8288;</code><em>xAxis type</em> should be 'category' ! <br />
<code style="white-space: pre;">&#8288;     &#8288;</code>Set fill color with attribute <em>areaStyle$color</em>.<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>Optional tooltip formatter available in <em>band[[1]]$tipFmt</em>.
</p>
</li></ul>

<p>Optional parameter <em>name</em>, if given, will show up in legend. Legend merges all series with same name into one item.
</p>


<h3>Value</h3>

<p>A list of <strong>one serie</strong> when type='polygon', or list of <strong>two series</strong> when type='stack'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(222)
df &lt;- data.frame( x = 1:10, y = round(runif(10, 5, 10),2)) |&gt;
  dplyr::mutate(lwr= round(y-runif(10, 1, 3),2), upr= round(y+runif(10, 2, 4),2) )
banda &lt;- ecr.band(df, 'lwr', 'upr', type='stack', name='stak', areaStyle= list(color='green'))
#banda &lt;- ecr.band(df, 'lwr', 'upr', type='polygon', name='poly1')

df |&gt; ec.init( load='custom', # polygon only
  legend= list(show= TRUE),
  xAxis= list(type='category', boundaryGap=FALSE), # stack
  #xAxis= list(scale=T, min='dataMin'),            # polygon 
  series= append(
    list(list(type='line', color='blue', name='line1')),
    banda
  ),
  tooltip= list(trigger='axis', formatter= banda[[1]]$tipFmt)
)

</code></pre>

<hr>
<h2 id='ecr.ebars'>Error bars</h2><span id='topic+ecr.ebars'></span>

<h3>Description</h3>

<p>Custom series to display error-bars for scatter, bar or line series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecr.ebars(wt, encode = list(x = 1, y = c(2, 3, 4)), hwidth = 6, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecr.ebars_+3A_wt">wt</code></td>
<td>
<p>An echarty widget to add error bars to, see <a href="#topic+ec.init">ec.init</a>.</p>
</td></tr>
<tr><td><code id="ecr.ebars_+3A_encode">encode</code></td>
<td>
<p>Column selection for both axes (x &amp; y) as vectors, see <a href="https://echarts.apache.org/en/option.html#series-bar.encode">encode</a></p>
</td></tr>
<tr><td><code id="ecr.ebars_+3A_hwidth">hwidth</code></td>
<td>
<p>Half-width of error bar in pixels, default is 6.</p>
</td></tr>
<tr><td><code id="ecr.ebars_+3A_...">...</code></td>
<td>
<p>More parameters for <a href="https://echarts.apache.org/en/option.html#series-custom.type">custom serie</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Command should be called after <em>ec.init</em> where main series are set.<br />
<em>ecr.ebars</em> are custom series, so <em>ec.init(load='custom')</em> is required. <br />
Horizontal and vertical layouts supported, just switch <em>encode</em> values <em>x</em> and <em>y</em> for both for series and ecr.ebars.<br />
Have own default tooltip format showing <em>value, high &amp; low</em>.<br />
Grouped bar series are supported.<br />
Non-grouped series could be shown with formatter <em>riErrBarSimple</em> instead of <em>ecr.ebars</em>. This is limited to vertical only, see example below.<br />
Other limitations:<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>manually add axis type='category' when needed<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>error bars cannot have own name when data is grouped<br />
<code style="white-space: pre;">&#8288;     &#8288;</code>legend select/deselect will not re-position grouped error bars<br />
</p>


<h3>Value</h3>

<p>A widget with error bars added if successful, otherwise the input widget
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
df &lt;- mtcars |&gt; group_by(cyl,gear) |&gt; summarise(avg.mpg= round(mean(mpg),2)) |&gt;
  mutate(low = round(avg.mpg-cyl*runif(1),2), 
         high= round(avg.mpg+cyl*runif(1),2))
ec.init(df, load= 'custom', ctype= 'bar',
      xAxis= list(type='category'), tooltip= list(show=TRUE)) |&gt;
ecr.ebars(encode= list(y=c('avg.mpg','low','high'), x='gear'))
#ecr.ebars(encode= list(y=c(3,4,5), x=2))  # ok: data indexes

# same but horizontal
ec.init(df, load= 'custom',
  yAxis= list(type='category'), tooltip= list(show=TRUE),
  series.param= list(type='bar', encode= list(x='avg.mpg', y='gear') )) |&gt;
ecr.ebars(encode= list(x=c('avg.mpg','low','high'), y='gear'))

# ----- riErrBarSimple ------
df &lt;- mtcars |&gt; mutate(name= row.names(mtcars), hi= hp-drat*3, lo= hp+wt*3) |&gt; 
  filter(cyl==4) |&gt; select(name,hp,hi,lo)
ec.init(df, load= 'custom', legend= list(show=TRUE)) |&gt;
ec.upd({ series &lt;- append(series, list(
  list(type= 'custom', name= 'error',
    data= ec.data(df |&gt; select(name,hi,lo)),
    renderItem= htmlwidgets::JS('riErrBarSimple')
  )))
})

</code></pre>

<hr>
<h2 id='ecs.exec'>Shiny: Execute a proxy command</h2><span id='topic+ecs.exec'></span>

<h3>Description</h3>

<p>Once chart changes had been made, they need to be sent back to the widget for display
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecs.exec(proxy, cmd = "p_merge")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecs.exec_+3A_proxy">proxy</code></td>
<td>
<p>A <a href="#topic+ecs.proxy">ecs.proxy</a> object</p>
</td></tr>
<tr><td><code id="ecs.exec_+3A_cmd">cmd</code></td>
<td>
<p>Name of command, default is <em>p_merge</em><br />
The proxy commands are:<br />
<em>p_update</em> - add new series and axes<br />
<em>p_merge</em> - modify or add series features like style,marks,etc.<br />
<em>p_replace</em> - replace entire chart <br />
<em>p_del_serie</em> - delete a serie by index or name<br />
<em>p_del_marks</em> - delete marks of a serie<br />
<em>p_append_data</em> - add data to existing series<br />
<em>p_dispatch</em> - send action commands, see <a href="https://echarts.apache.org/en/api.html#echartsInstance.dispatchAction">documentation</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A proxy object to update the chart.
</p>


<h3>See Also</h3>

<p><a href="#topic+ecs.proxy">ecs.proxy</a>, <a href="#topic+ecs.render">ecs.render</a>, <a href="#topic+ecs.output">ecs.output</a> <br />
Read about event handling in <a href="#topic+--+20Introduction+20--">&ndash; Introduction &ndash;</a>, or from <a href="https://github.com/helgasoft/echarty/blob/main/demo/examples.R">examples</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
 # run with  demo(eshiny, package='echarty')
}

</code></pre>

<hr>
<h2 id='ecs.output'>Shiny: UI chart</h2><span id='topic+ecs.output'></span>

<h3>Description</h3>

<p>Placeholder for a chart in Shiny UI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecs.output(outputId, width = "100%", height = "400px")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecs.output_+3A_outputid">outputId</code></td>
<td>
<p>Name of output UI element.</p>
</td></tr>
<tr><td><code id="ecs.output_+3A_width">width</code>, <code id="ecs.output_+3A_height">height</code></td>
<td>
<p>Must be a valid CSS unit (like <code>'100%'</code>,
<code>'400px'</code>, <em>'auto'</em>) or a number, which will be coerced to a
string and have <em>'px'</em> appended.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An output or render function that enables the use of the widget within Shiny applications.
</p>


<h3>See Also</h3>

<p><a href="#topic+ecs.exec">ecs.exec</a> for example, <a href="htmlwidgets.html#topic+shinyWidgetOutput">shinyWidgetOutput</a> for return value.
</p>

<hr>
<h2 id='ecs.proxy'>Shiny: Create a proxy</h2><span id='topic+ecs.proxy'></span>

<h3>Description</h3>

<p>Create a proxy for an existing chart in Shiny UI. It allows to
add, merge, delete elements to a chart without reloading it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecs.proxy(id)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecs.proxy_+3A_id">id</code></td>
<td>
<p>Target chart id from the Shiny UI.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A proxy object to update the chart.
</p>


<h3>See Also</h3>

<p><a href="#topic+ecs.exec">ecs.exec</a> for example.
</p>

<hr>
<h2 id='ecs.render'>Shiny: Plot command to render chart</h2><span id='topic+ecs.render'></span>

<h3>Description</h3>

<p>This is the initial rendering of a chart in the UI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecs.render(wt, env = parent.frame(), quoted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecs.render_+3A_wt">wt</code></td>
<td>
<p>An <code>echarty</code> widget to generate the chart.</p>
</td></tr>
<tr><td><code id="ecs.render_+3A_env">env</code></td>
<td>
<p>The environment in which to evaluate <code>expr</code>.</p>
</td></tr>
<tr><td><code id="ecs.render_+3A_quoted">quoted</code></td>
<td>
<p>Is <code>expr</code> a quoted expression? default FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An output or render function that enables the use of the widget within Shiny applications.
</p>


<h3>See Also</h3>

<p><a href="#topic+ecs.exec">ecs.exec</a> for example, <a href="htmlwidgets.html#topic+shinyRenderWidget">shinyRenderWidget</a> for return value.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
