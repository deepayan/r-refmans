<!DOCTYPE html><html><head><title>Help for package cymruservices</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cymruservices}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cymruservices'><p>cymruservices is an R package that provides interfaces to various</p>
<a href="http://www.team-cymru.org/services.html">Team Cymru Services</a> including
The Bogon Refrerence, The IP to ASN Mapping Project and The Malware Hash Registry</a></li>
<li><a href='#bulk_origin'><p>Retrieves BGP Origin ASN info for a list of IPv4 addresses</p></a></li>
<li><a href='#bulk_origin_asn'><p>Retrieves BGP Origin ASN info for a list of ASN ids</p></a></li>
<li><a href='#bulk_peer'><p>Retrieves BGP Peer ASN info for a list of IPv4 addresses</p></a></li>
<li><a href='#cymru_active'><p>Check to see if Team Cymru WHOIS servers are up</p></a></li>
<li><a href='#flush'><p>Flush cached results</p></a></li>
<li><a href='#ipv4_bogons'><p>Retrieve list of IPv4 &quot;full bogons&quot; from Team Cymru webservice</p></a></li>
<li><a href='#ipv6_bogons'><p>Retrieve list of IPv6 &quot;full bogons&quot; from Team Cymru webservice</p></a></li>
<li><a href='#malware_hash'><p>Retrieves malware hash metadata from the Malware Hash Registry</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Query 'Team Cymru' 'IP' Address, Autonomous System Number
('ASN'), Border Gateway Protocol ('BGP'), Bogon and 'Malware'
Hash Data Services</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A toolkit for querying 'Team Cymru' <a href="http://team-cymru.org">http://team-cymru.org</a> 'IP'
    address, Autonomous System Number ('ASN'), Border Gateway Protocol ('BGP'), Bogon
    and 'Malware' Hash Data Services.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, stringi, memoise, pingr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1.9000</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-09-16 20:41:45 UTC; hrbrmstr</td>
</tr>
<tr>
<td>Author:</td>
<td>Bob Rudis <a href="https://orcid.org/0000-0001-5670-2640"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bob Rudis &lt;bob@rud.is&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-09-18 20:40:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='cymruservices'>cymruservices is an R package that provides interfaces to various
<a href="http://www.team-cymru.org/services.html">Team Cymru Services</a> including
The Bogon Refrerence, The IP to ASN Mapping Project and The Malware Hash Registry</h2><span id='topic+cymruservices'></span><span id='topic+cymruservices-package'></span>

<h3>Description</h3>

<p>cymruservices is an R package that provides interfaces to various
<a href="http://www.team-cymru.org/services.html">Team Cymru Services</a> including
The Bogon Refrerence, The IP to ASN Mapping Project and The Malware Hash Registry
</p>


<h3>Note</h3>

<p>A direct connection to TCP Port 43 (WHOIS) is required for most of these
API functions to work properly.
</p>


<h3>Author(s)</h3>

<p>Bob Rudis (bob@rud.is)
</p>

<hr>
<h2 id='bulk_origin'>Retrieves BGP Origin ASN info for a list of IPv4 addresses</h2><span id='topic+bulk_origin'></span>

<h3>Description</h3>

<p>Retrieves BGP Origin ASN info for a list of IPv4 addresses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bulk_origin(ips, timeout = getOption("timeout"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bulk_origin_+3A_ips">ips</code></td>
<td>
<p>vector of IPv4 address (character - dotted-decimal)</p>
</td></tr>
<tr><td><code id="bulk_origin_+3A_timeout">timeout</code></td>
<td>
<p>numeric: the timeout (in seconds) to be used for this connection.
Beware that some OSes may treat very large values as zero: however the
POSIX standard requires values up to 31 days to be supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of BGP Origin ASN lookup results
</p>

<ul>
<li> <p><code>as</code> - AS #
</p>
</li>
<li> <p><code>ip</code> - IPv4 (passed in)
</p>
</li>
<li> <p><code>bgp_refix</code> - BGP CIDR
</p>
</li>
<li> <p><code>cc</code> - Country code
</p>
</li>
<li> <p><code>registry</code> - Registry it falls under
</p>
</li>
<li> <p><code>allocated</code> - date it was allocated
</p>
</li>
<li> <p><code>as_ame</code> - AS name
</p>
</li></ul>

<p>If a socket connection cannot be made (i.e. a network problem on your
end or a service/network problem on their end), all columns will be
<code>NA</code>.
</p>


<h3>Note</h3>

<p>The Team Cymru's service is NOT a GeoIP service! Do not use this
function for that as your results will not be accurate.
Data is updated every 4 hours. Also,
A direct connection to TCP Port 43 (WHOIS) is required for most of these
API functions to work properly.
</p>


<h3>See Also</h3>

<p><a href="http://www.team-cymru.org/IP-ASN-mapping.html">http://www.team-cymru.org/IP-ASN-mapping.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
bulk_origin(c("68.22.187.5", "207.229.165.18", "198.6.1.65"))

## End(Not run)
</code></pre>

<hr>
<h2 id='bulk_origin_asn'>Retrieves BGP Origin ASN info for a list of ASN ids</h2><span id='topic+bulk_origin_asn'></span>

<h3>Description</h3>

<p>Retrieves BGP Origin ASN info for a list of ASN ids
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bulk_origin_asn(asns, timeout = getOption("timeout"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bulk_origin_asn_+3A_asns">asns</code></td>
<td>
<p>character vector of ASN ids (character)</p>
</td></tr>
<tr><td><code id="bulk_origin_asn_+3A_timeout">timeout</code></td>
<td>
<p>numeric: the timeout (in seconds) to be used for this connection.
Beware that some OSes may treat very large values as zero: however the
POSIX standard requires values up to 31 days to be supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of BGP Origin ASN lookup results
</p>

<ul>
<li> <p><code>as</code> - AS #
</p>
</li>
<li> <p><code>cc</code> - Country code
</p>
</li>
<li> <p><code>registry</code> - registry it falls under
</p>
</li>
<li> <p><code>allocated</code> - when it was allocated
</p>
</li>
<li> <p><code>as_name</code> - name associated with the allocation
</p>
</li></ul>

<p>If a socket connection cannot be made (i.e. a network problem on your
end or a service/network problem on their end), all columns will be
<code>NA</code>.
</p>


<h3>Note</h3>

<p>The Team Cymru's service is NOT a GeoIP service! Do not use this
function for that as your results will not be accurate.
Data is updated every 4 hours. Also,
A direct connection to TCP Port 43 (WHOIS) is required for most of these
API functions to work properly.
</p>


<h3>See Also</h3>

<p><a href="http://www.team-cymru.org/IP-ASN-mapping.html">http://www.team-cymru.org/IP-ASN-mapping.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
bulk_origin_asn(c(22822, 1273, 2381, 2603, 2914, 3257, 3356, 11164,
                  174, 286, 1299, 2914, 3257, 3356, 3549, 22822))

## End(Not run)
</code></pre>

<hr>
<h2 id='bulk_peer'>Retrieves BGP Peer ASN info for a list of IPv4 addresses</h2><span id='topic+bulk_peer'></span>

<h3>Description</h3>

<p>Retrieves BGP Peer ASN info for a list of IPv4 addresses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bulk_peer(ips, timeout = getOption("timeout"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bulk_peer_+3A_ips">ips</code></td>
<td>
<p>vector of IPv4 address (character - dotted-decimal)</p>
</td></tr>
<tr><td><code id="bulk_peer_+3A_timeout">timeout</code></td>
<td>
<p>numeric: the timeout (in seconds) to be used for this connection.
Beware that some OSes may treat very large values as zero: however the
POSIX standard requires values up to 31 days to be supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of BGP Peer ASN lookup results
</p>

<ul>
<li> <p><code>peer_as</code> - peer AS #
</p>
</li>
<li> <p><code>ip</code> - IPv4 (passsed in)
</p>
</li>
<li> <p><code>bgp_prefix</code> - BGP CIDR block
</p>
</li>
<li> <p><code>cc</code> - Country code
</p>
</li>
<li> <p><code>registry</code> - Registry it falls under
</p>
</li>
<li> <p><code>allocated</code> - date allocated
</p>
</li>
<li> <p><code>peer_as_name</code> - peer name
</p>
</li></ul>

<p>If a socket connection cannot be made (i.e. a network problem on your
end or a service/network problem on their end), all columns will be
<code>NA</code>.
</p>


<h3>Note</h3>

<p>The Team Cymru's service is NOT a GeoIP service! Do not use this
function for that as your results will not be accurate.
Data is updated every 4 hours. Also,
A direct connection to TCP Port 43 (WHOIS) is required for most of these
API functions to work properly.
</p>


<h3>See Also</h3>

<p><a href="http://www.team-cymru.org/IP-ASN-mapping.html">http://www.team-cymru.org/IP-ASN-mapping.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
bulk_peer(c("68.22.187.5", "207.229.165.18", "198.6.1.65"))

## End(Not run)
</code></pre>

<hr>
<h2 id='cymru_active'>Check to see if Team Cymru WHOIS servers are up</h2><span id='topic+cymru_active'></span>

<h3>Description</h3>

<p>Check to see if Team Cymru WHOIS servers are up
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cymru_active(timeout = 1, count = 3L, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cymru_active_+3A_timeout">timeout</code></td>
<td>
<p>how long to wait for a response (seconds). Default is one second.</p>
</td></tr>
<tr><td><code id="cymru_active_+3A_count">count</code></td>
<td>
<p>number of pings to issue. Default is three pings.</p>
</td></tr>
<tr><td><code id="cymru_active_+3A_verbose">verbose</code></td>
<td>
<p>be verbose in output? Default <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>cymru_active()
</code></pre>

<hr>
<h2 id='flush'>Flush cached results</h2><span id='topic+flush'></span>

<h3>Description</h3>

<p>Within a given R session, it will be highly unlikely that API responses
to calls to Team Cymru services will change if the parameters have
not varied (i.e. you use the same vector of IP addresses again). To
respect the resources that have beeen freely provided, all the API
functions cache their results.<br />
<br />
It may be advantageous or necessary to invalidate one or more of these
caches. This function allows for the invalidation of one or more (or all)
caches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flush(..., quiet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flush_+3A_...">...</code></td>
<td>
<p>strings naming cached results to flush. Can be any of
&quot;<code>origin</code>&quot;, &quot;<code>peer</code>&quot;, &quot;<code>asn</code>&quot;, &quot;<code>v4_bogons</code>&quot;,
&quot;<code>v6_bogons</code>&quot; or &quot;<code>hash</code>&quot;. If no parameters
are specified all caches will be flushed.</p>
</td></tr>
<tr><td><code id="flush_+3A_quiet">quiet</code></td>
<td>
<p>if <code>TRUE</code> no diagnostic or informative messages will be
displayed. If <code>FALSE</code> warnings for unknown cache names and
invalidation progress for valid caches will be displayed if
the session is interactive.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Invalid cache names will be ignored. If <code>quiet</code> is <code>FALSE</code>
and <code>flush</code> was called from an interactive session invalid
cache names will be noted.<br /><br /> Also, you will still need to
<code>force</code> the reloading of bogon lists if you are within the 4
hour window even if you invalided the memoised cache.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
flush("peer", "origin")
flush()

## End(Not run)
</code></pre>

<hr>
<h2 id='ipv4_bogons'>Retrieve list of IPv4 &quot;full bogons&quot; from Team Cymru webservice</h2><span id='topic+ipv4_bogons'></span>

<h3>Description</h3>

<p>The traditional bogon prefixes (IPV4), plus prefixes that have been allocated to
RIRs but not yet assigned by those RIRs to ISPs, end-users, etc. Updated every four hours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipv4_bogons(force = FALSE, cached_bogons = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipv4_bogons_+3A_force">force</code></td>
<td>
<p>force a refresh even if the time-frame (4-hours) is not up</p>
</td></tr>
<tr><td><code id="ipv4_bogons_+3A_cached_bogons">cached_bogons</code></td>
<td>
<p>if you pass in the previous result of a call to <code>ipv4_bogoons</code>
it will be returned if the refresh time constraint has not been met, otherwise
<code>NA</code> will be returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bogons are defined as Martians (private and reserved addresses defined by RFC 1918,
RFC 5735, and RFC 6598) and netblocks that have not been allocated to a regional
internet registry (RIR) by the Internet Assigned Numbers Authority.
</p>
<p>Fullbogons are a larger set which also includes IP space that has been allocated to
an RIR, but not assigned by that RIR to an actual ISP or other end-user. IANA maintains
a convenient IPv4 summary page listing allocated and reserved netblocks, and each RIR
maintains a list of all prefixes that they have assigned to end-users. Our bogon reference
pages include additional links and resources to assist those who wish to properly filter
bogon prefixes within their networks.
</p>


<h3>See Also</h3>

<p><a href="http://www.team-cymru.org/bogon-reference-http.html">http://www.team-cymru.org/bogon-reference-http.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
v4_bogons &lt;- ipv4_bogons()
v4_bogons &lt;- ipv4_bogons(cached_bogons=v4_bogons)

## End(Not run)
</code></pre>

<hr>
<h2 id='ipv6_bogons'>Retrieve list of IPv6 &quot;full bogons&quot; from Team Cymru webservice</h2><span id='topic+ipv6_bogons'></span>

<h3>Description</h3>

<p>IPv6 &quot;fullbogons&quot;, all IPv6 prefixes that have not been allocated to RIRs and
that have not been assigned by RIRs to ISPs, end-users, etc. Updated every four hours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipv6_bogons(force = FALSE, cached_bogons = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipv6_bogons_+3A_force">force</code></td>
<td>
<p>force a refresh even if the time-frame (4-hours) is not up</p>
</td></tr>
<tr><td><code id="ipv6_bogons_+3A_cached_bogons">cached_bogons</code></td>
<td>
<p>if you pass in the previous result of a call to <code>ipv6_bogoons</code>
it will be returned if the refresh time constraint has not been met, otherwise
<code>NA</code> will be returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bogons are defined as Martians (private and reserved addresses defined by RFC 1918,
RFC 5735, and RFC 6598) and netblocks that have not been allocated to a regional
internet registry (RIR) by the Internet Assigned Numbers Authority.
</p>
<p>Fullbogons are a larger set which also includes IP space that has been allocated to
an RIR, but not assigned by that RIR to an actual ISP or other end-user. IANA maintains
a convenient IPv4 summary page listing allocated and reserved netblocks, and each RIR
maintains a list of all prefixes that they have assigned to end-users. Our bogon reference
pages include additional links and resources to assist those who wish to properly filter
bogon prefixes within their networks.
</p>


<h3>See Also</h3>

<p><a href="http://www.team-cymru.org/bogon-reference-http.html">http://www.team-cymru.org/bogon-reference-http.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
v6_bogons &lt;- ipv6_bogons()
v6_bogons &lt;- ipv6_bogons(cached_bogons=v6_bogons)

## End(Not run)
</code></pre>

<hr>
<h2 id='malware_hash'>Retrieves malware hash metadata from the Malware Hash Registry</h2><span id='topic+malware_hash'></span>

<h3>Description</h3>

<p>The Malware Hash Registry (MHR) project is a look-up service similar to the
Team Cymru IP address to ASN mapping project. This project differs however,
in that you can query the service for a computed MD5 or SHA-1 hash of a file
and, if it is malware and the service knows about it, it returns the last
time it's seen it along with an approximate anti-virus detection percentage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>malware_hash(hashes, timeout = getOption("timeout"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="malware_hash_+3A_hashes">hashes</code></td>
<td>
<p>vector of IPv4 address (character - dotted-decimal)</p>
</td></tr>
<tr><td><code id="malware_hash_+3A_timeout">timeout</code></td>
<td>
<p>numeric: the timeout (in seconds) to be used for this connection.
Beware that some OSes may treat very large values as zero: however the
POSIX standard requires values up to 31 days to be supported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of BGP Origin ASN lookup results
</p>

<ul>
<li> <p><code>sha1_md5</code> - hash queried for
</p>
</li>
<li> <p><code>last_known_timestamp</code> - last known GMT timestamp associated with that hash
</p>
</li>
<li> <p><code>detection_pct</code> - detection percentage across a mix of AV packages
</p>
</li></ul>

<p>If a socket connection cannot be made (i.e. a network problem on your
end or a service/network problem on their end), all columns will be
<code>NA</code>.
</p>


<h3>Note</h3>

<p>Attempting to enumerate the malware registry via the public service
interface is not only impractical, it is also strictly prohibited.
Contact Team Cymru if the public interface is insufficient for your
needs and we may be able to come up with alternative arrangement. Also,
A direct connection to TCP Port 43 (WHOIS) is required for most of these
API functions to work properly.
</p>


<h3>See Also</h3>

<p><a href="http://www.team-cymru.org/IP-ASN-mapping.html">http://www.team-cymru.org/IP-ASN-mapping.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
malware_hash(c("1250ac278944a0737707cf40a0fbecd4b5a17c9d",
               "7697561ccbbdd1661c25c86762117613",
               "cbed16069043a0bf3c92fff9a99cccdc",
               "e6dc4f4d5061299bc5e76f5cd8d16610",
               "e1112134b6dcc8bed54e0e34d8ac272795e73d74"))

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
