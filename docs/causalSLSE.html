<!DOCTYPE html><html lang="en"><head><title>Help for package causalSLSE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {causalSLSE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.model'>
<p>Converter into Model Objects</p></a></li>
<li><a href='#causalSLSE'>
<p>Causal Effect Based on Semiparametric Least Squares Models</p></a></li>
<li><a href='#cslseModel'>
<p>Semiparametric Least Squares Estimator Model</p></a></li>
<li><a href='#estSLSE'>
<p>Least Squares Estimate of <code>cslseModel</code> or <code>slseModel</code> Objects</p></a></li>
<li><a href='#extract+2Ccslse-method'><p><code>extract</code> Method for <code>cslse</code> Objects</p></a></li>
<li><a href='#extract+2CslseFit-method'><p><code>extract</code> Method for <code>slseFit</code> Objects</p></a></li>
<li><a href='#llSplines'>
<p>Local Linear Splines Generator for Model Objects</p></a></li>
<li><a href='#nsw'><p>Lalonde Subsample of the National Supported Work Demonstration Data</p>
(NSW)</a></li>
<li><a href='#plot'><p>Plot of Predicted Outcome</p></a></li>
<li><a href='#predict'><p>Outcome Prediction</p></a></li>
<li><a href='#print'><p>Print Methods</p></a></li>
<li><a href='#selSLSE'>
<p>Knots Selection Method</p></a></li>
<li><a href='#simDat1'>
<p>Simulated Data</p></a></li>
<li><a href='#simDat2'>
<p>Simulated Data</p></a></li>
<li><a href='#simDat3'>
<p>Simulated Data</p></a></li>
<li><a href='#simDat4'>
<p>Simulated Data.</p></a></li>
<li><a href='#simDat5'>
<p>Simulated Data</p></a></li>
<li><a href='#slseKnots'>
<p>Knots Creator for Basis Functions</p></a></li>
<li><a href='#summary'><p>Summary Method for Fitted Models</p></a></li>
<li><a href='#update'><p>Update Methods</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.3-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-14</td>
</tr>
<tr>
<td>Title:</td>
<td>Semiparametric Least Squares Inference for Causal Effects</td>
</tr>
<tr>
<td>Description:</td>
<td>Several causal effects are measured using least squares regressions and basis function approximations. Backward and forward selection methods based on different criteria are used to select the basis functions.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Collate:</td>
<td>'cslse.R' 'slse.R' 'Fcslse.R'</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, sandwich, texreg, methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-16 20:43:38 UTC; pierrechausse</td>
</tr>
<tr>
<td>Author:</td>
<td>Pierre Chausse Developer [aut, cre],
  Mihai Giurcanu Developer [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pierre Chausse Developer &lt;pchausse@uwaterloo.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-17 11:32:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.model'>
Converter into Model Objects
</h2><span id='topic+as.model'></span><span id='topic+as.model.slseFit'></span><span id='topic+as.model.cslseFit'></span><span id='topic+as.model.cslse'></span>

<h3>Description</h3>

<p>When the information about a model is available, it reconstructs it and returns a valid model object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slseFit'
as.model(x, ...)

## S3 method for class 'cslseFit'
as.model(x, ...)

## S3 method for class 'cslse'
as.model(x, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.model_+3A_x">x</code></td>
<td>
<p>An object containing the model to extract.</p>
</td></tr>
<tr><td><code id="as.model_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to other methods. Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The method returns an object of class <code><a href="#topic+slseModel">slseModel</a></code> or
<code><a href="#topic+cslseModel">cslseModel</a></code>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat3)
mod &lt;- cslseModel(Y ~ Z | ~ X1 * X2, data = simDat3)
fit &lt;- estSLSE(mod)

## Extract the model from a cslseModel object

as.model(fit)

## Extract the model from a cslse object

cs &lt;- causalSLSE(mod)
as.model(cs)
</code></pre>

<hr>
<h2 id='causalSLSE'>
Causal Effect Based on Semiparametric Least Squares Models
</h2><span id='topic+causalSLSE'></span><span id='topic+causalSLSE.cslseModel'></span><span id='topic+causalSLSE.cslseFit'></span><span id='topic+causalSLSE.formula'></span>

<h3>Description</h3>

<p>This is the main method to estimate the causal effects using the semiparametric
least squares method. It returns an object of class
<code>cslse</code> and is registered for objects of class
<code><a href="#topic+cslseModel">cslseModel</a></code> and <code><a href="#topic+estSLSE">cslseFit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cslseModel'
causalSLSE(object,
                               selType=c("SLSE","BLSE","FLSE"),
                               selCrit = c("AIC", "BIC", "PVT"),
                               selVcov = c("HC0", "Classical", "HC1", "HC2", "HC3"),    
                               causal = c("ALL","ACT","ACE","ACN"),
                               pvalT = function(p) 1/log(p),
                               vcov.=vcovHC, reSelect=FALSE, ...)
## S3 method for class 'cslseFit'
causalSLSE(object, causal = c("ALL","ACT","ACE","ACN"),
                             vcov.=vcovHC, ...)
## S3 method for class 'formula'
causalSLSE(object, data, nbasis=function(n) n^0.3,
                             knots, 
                             selType=c("SLSE","BLSE","FLSE"),
                             selCrit = c("AIC", "BIC", "PVT"),
                             selVcov = c("HC0", "Classical", "HC1", "HC2", "HC3"),        
                             causal = c("ALL","ACT","ACE","ACN"),
                             pvalT = function(p) 1/log(p),
                             vcov.=vcovHC, reSelect=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="causalSLSE_+3A_object">object</code></td>
<td>
<p>An object of class <code>cslseModel</code> created by the
<code><a href="#topic+cslseModel">cslseModel</a></code> function, <code>cslseFit</code> created by <code><a href="#topic+estSLSE">estSLSE</a></code>
or <code>formula</code>.</p>
</td></tr>
<tr><td><code id="causalSLSE_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> with all variables included in <code>form</code>.</p>
</td></tr>
<tr><td><code id="causalSLSE_+3A_nbasis">nbasis</code></td>
<td>
<p>A function to determined the number of basis
functions. It has to  be a function of one argument, the sample
size.</p>
</td></tr> 
<tr><td><code id="causalSLSE_+3A_knots">knots</code></td>
<td>
<p>A list of knots for the treated and nontreated
groups. The list must be named using the group names. Each element
of the list is also a list  of length  equal to the number of
confounders. The choice for each confounders is NULL for no knots or
numeric for specific values. If missing, the knots are 
automatically generated.</p>
</td></tr>
<tr><td><code id="causalSLSE_+3A_seltype">selType</code></td>
<td>
<p>The method for selecting the knots. By default (SLSE),
all knots from the model are used.</p>
</td></tr> 
<tr><td><code id="causalSLSE_+3A_selcrit">selCrit</code></td>
<td>
<p>The criterion to select the knots.</p>
</td></tr>
<tr><td><code id="causalSLSE_+3A_causal">causal</code></td>
<td>
<p>What causal effect should we compute.</p>
</td></tr>
<tr><td><code id="causalSLSE_+3A_pvalt">pvalT</code></td>
<td>
<p>A function to determine the p-value threshold for the
significance of the coefficients. It has to be a function of one
parameter, which is the average number of knots in the model. This
value may differ across treatment group.</p>
</td></tr>
<tr><td><code id="causalSLSE_+3A_selvcov">selVcov</code></td>
<td>
<p>The type of least squares covariance matrix used to
compute the p-values needed for the selection.</p>
</td></tr>  
<tr><td><code id="causalSLSE_+3A_vcov.">vcov.</code></td>
<td>
<p>An alternative function to compute the covariance matrix
of the least squares estimators. The default is
<code><a href="sandwich.html#topic+vcovHC.default">vcovHC</a></code>. This function is used to
compute the standard errors of the causal effect estimators and the
SLSE coefficients.</p>
</td></tr>   
<tr><td><code id="causalSLSE_+3A_reselect">reSelect</code></td>
<td>
<p>By default, the stored selections are used. If
<code>reSelect</code> is set to <code>TRUE</code>, the selection is re-computed.</p>
</td></tr>  
<tr><td><code id="causalSLSE_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code>vcov.</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns an object of class <code>cslse</code>, which inherits from
the class <code>cslseFit</code>. It is a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>treated</code>, <code>nontreated</code></td>
<td>
<p>They are objects of class <code>slseFit</code>
obtained by <code><a href="#topic+estSLSE">estSLSE</a></code>.</p>
</td></tr>
<tr><td><code>ACE</code>, <code>ACT</code>, <code>ACN</code></td>
<td>
<p>Estimates of the average causal effect, the
causal effect on the treated and the causal effect on the
nontreated. Each of them is a vector of two elements: the estimate and
its estimated standard error. All three are included only if the
argument <code>causal</code> is set to <code>"ALL"</code>.</p>
</td></tr>
</table>
<p>Also, the object contains the following additional attributes:
</p>
<table role = "presentation">
<tr><td><code>treatedVar</code></td>
<td>
<p>The name of the variable in the dataset that represents
the treatment indicator.</p>
</td></tr>
<tr><td><code>groupInd</code></td>
<td>
<p>A named vector with the value of the treatment indicator
corresponding do each treatment group.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+estSLSE">estSLSE</a></code> for the  estimation of the model,
<code><a href="#topic+slseKnots">slseKnots</a></code> for the format of knots, and <code><a href="#topic+selSLSE">selSLSE</a></code>
and <code><a href="#topic+update.cslseModel">update</a></code> for the knots selection
and to understand how stored selections are used.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat3)

## A causal SLSE model with the outcome Y
## the treatment indicator Z and the confounders X1, X2 and X1:X2

mod1 &lt;- cslseModel(Y ~ Z | ~ X1 * X2, data = simDat3)

## The causal effects are estimated using the backward method and AIC criterion
## The HC1 type is used for the least squares covariance matrix

fit1 &lt;- causalSLSE(mod1, selType = "BLSE", type = "HC1")

## This is the same for formula objects

fit2 &lt;- causalSLSE(Y ~ Z | ~ X1 * X2, data = simDat3, selType = "BLSE", type = "HC1")
</code></pre>

<hr>
<h2 id='cslseModel'>
Semiparametric Least Squares Estimator Model
</h2><span id='topic+cslseModel'></span><span id='topic+slseModel'></span>

<h3>Description</h3>

<p>This function creates an object of class <code>cslseModel</code> or
<code>slseModel</code>. The former is a list of <code>slseModel</code> objects, one
for each treatment group. The model objects contain all specifications
about the model being estimated including the starting knots used to
construct the basis functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cslseModel(form, data, nbasis = function(n) n^0.3, 
           knots, groupInd=c(treated=1, nontreated=0))
slseModel(form, data, nbasis = function(n) n^0.3, 
           knots)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cslseModel_+3A_form">form</code></td>
<td>
<p>A formula for the regression in  the case of a simple spline
regression, or two formulas separated by <code>|</code>, one for the
outcome versus the treatment indicator and one of the
confounders. See the details and examples below.</p>
</td></tr> 
<tr><td><code id="cslseModel_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> that contains all variables included
in <code>form</code>.</p>
</td></tr> 
<tr><td><code id="cslseModel_+3A_nbasis">nbasis</code></td>
<td>
<p>A function to determined the number of basis
functions. It has to be a function of one argument, the sample
size.</p>
</td></tr> 
<tr><td><code id="cslseModel_+3A_knots">knots</code></td>
<td>
<p>An optional list of knots. For <code>cslseModel</code>, it must 
be a named list using the group names (treated and nontreated). Each element  
of the list is also a list  of length  equal to the number of
covariates. The choice for each covariate is NULL for no knots or
a numeric vector for specific knots. If missing, the knots are 
automatically generated.</p>
</td></tr>
<tr><td><code id="cslseModel_+3A_groupind">groupInd</code></td>
<td>
<p>A named vector with the group names and values. By
default, the treatment indicator defined in <code>form</code> is equal to
1 for the treated and 0 for the nontreated. For now, these are
the only allowed names, but the values can differ. In particular,
the treatment indicator may be a factor with character values. See
the example below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An object of class <code>slseModel</code> is a regression model with a
dependent variable and a set of covariates. We assume that the model can
be written as <code class="reqn">Y=f(X)+e</code>, where <code class="reqn">f(x)</code> is an
unknown function of the covariates that we approximate using linear
combinations of basis functions. For now, we only consider local linear 
splines defined by sets of knots, one for each covariate generated by
the <code><a href="stats.html#topic+model.matrix">model.matrix</a></code> of <code>form</code>. The knots are
automatically determined unless specified by the user. 
</p>
<p>An object of class <code>cslseModel</code> is a list of <code>slseModel</code>
objects, one for each treatment group. The assignment to a group is
determined by a treatment indicator, which is the right-hand side
variable in the formula to the left of <code>|</code> specified in
<code>form</code>. The formula to the right of <code>|</code> is used by
<code><a href="stats.html#topic+model.matrix">model.matrix</a></code> to generate a set of confounders for each
treatment group. See the example below and the vignette to more details.
</p>


<h3>Value</h3>

<p>The function <code>slseModel</code> creates a semiparametric least squares
model or a class <code>slseModel</code> object. It is a list with the
following elements:
</p>
<table role = "presentation">
<tr><td><code>slseForm</code></td>
<td>
<p>The formula for the semiparametric estimation. It links
the outcome variable with the matrix of basis functions.</p>
</td></tr>
<tr><td><code>form</code></td>
<td>
<p>The <code>form</code> argument passed to the function
<code>slseModel</code>.</p>
</td></tr>
<tr><td><code>nameY</code></td>
<td>
<p>The name of the variable representing the outcome</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>The dataset passed to the function <code>slseModel</code> with the
missing values, if any, omitted.</p>
</td></tr>
<tr><td><code>knots</code></td>
<td>
<p>An object of class <code><a href="#topic+slseKnots">slseKnots</a></code>. It is the set of
knots that define the local linear splines.</p>
</td></tr>
<tr><td><code>nameX</code></td>
<td>
<p>The names of all covariates included in the model. They are
all variables implied by the formula <code>form</code>, which may include
interactions and functions of variables.</p>
</td></tr>
<tr><td><code>nameS</code></td>
<td>
<p>The prefix added to the covariate names when the basis
functions are generated. By default, it is equal to <code>"U."</code></p>
</td></tr>
<tr><td><code>xlevels</code></td>
<td>
<p>When relevant, a list of levels of the factors included
in the model.</p>
</td></tr>
<tr><td><code>na</code></td>
<td>
<p>A vector of integer representing the observations omitted
because of missing values. It is <code>NULL</code> when there are no missing
values.</p>
</td></tr> 
</table>
<p>Note that other elements may be present if a knots selection has been
applied to the model.
</p>
<p>The function <code>cslseModel</code> creates an object of class
<code>cslseModel</code>. It is a list of <code>slseModel</code> objects, one for
each treatment group. It also contains the following additional
attributes:
</p>
<table role = "presentation">
<tr><td><code>treatedVar</code></td>
<td>
<p>The name of the variable in the dataset that represents
the treatment indicator.</p>
</td></tr>
<tr><td><code>groupInd</code></td>
<td>
<p>A named vector with the value of the treatment indicator
corresponding do each treatment group.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selSLSE">selSLSE</a></code> for additional elements that can be
included in the <code>slseModel</code> object, <code><a href="#topic+estSLSE">estSLSE</a></code> to see
how the model is estimated and <code><a href="#topic+slseKnots">slseKnots</a></code> for the format
of the knots</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat3)

## Y is the outcome and Z the treatment indicator
## The confounders are X1, X2 and X1:X2:

mod1 &lt;- cslseModel(Y ~ Z | ~ X1 * X2, data = simDat3)
mod1

## A simple SLSE for a regression model

mod2 &lt;- slseModel(Y ~ X1 * X2, data = simDat3)
mod2

## If the treatment indicator differs from 0-1

data(simDat4)
mod3 &lt;- cslseModel(Y ~ treat | ~ X1 * X2, data = simDat4,
                   groupInd = c(treated = "treat", nontreated = "notreat" ))
mod3
</code></pre>

<hr>
<h2 id='estSLSE'>
Least Squares Estimate of <code>cslseModel</code> or <code>slseModel</code> Objects
</h2><span id='topic+estSLSE'></span><span id='topic+estSLSE.cslseModel'></span><span id='topic+estSLSE.slseModel'></span>

<h3>Description</h3>

<p>This is the main function to estimate <code>cslseModel</code> or
<code>slseModel</code> objects. It generates the basis functions based on the
knots specified in the model and estimates it by least squares.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cslseModel'
estSLSE(model, selKnots, ...)

## S3 method for class 'slseModel'
estSLSE(model, selKnots, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estSLSE_+3A_model">model</code></td>
<td>
<p>A model of class <code><a href="#topic+cslseModel">cslseModel</a></code>  or
<code><a href="#topic+slseModel">slseModel</a></code>.</p>
</td></tr> 
<tr><td><code id="estSLSE_+3A_selknots">selKnots</code></td>
<td>
<p>An optional list of integers to select the knots from
the list of knots specified by the model. If the model is a
<code>cslseModel</code> object, it  must be a named list with the names
being either &quot;treated&quot;,  &quot;nontreated&quot; or both. By default, the knots
from the model stored in the element <code>knots</code> are used.</p>
</td></tr> 
<tr><td><code id="estSLSE_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to other methods. Currently
not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method for <code>slseModel</code> objects generates the matrix
of basis functions implied by the set of knots included in the model and 
estimate the model by the least squares. Let <code class="reqn">Y</code> be the
outcome and <code class="reqn">U</code> be the matrix of basis functions. Then, the
function estimates the model using the code <code>lm(Y~U)</code>.
</p>
<p>For <code>cslseModel</code>, we could estimate the model using
<code>lm(Y~Z+I(Z-1)+I(U0*(1-Z))+I(U1*Z))</code>, where <code>Z</code> is a binary
variable equal to 1 for the treated and 0 for the nontreated, and
<code>U0</code> and <code>U1</code> are the matrices of basis functions for the
nontreated and treated, but the model is estimated separately for each
group. Therefore, the function <code>estSLSE.cslseModel</code> calls the
function <code>estSLSE.slseModel</code> for each <code>slseModel</code> objects
included in the  <code>cslseModel</code> object.
</p>


<h3>Value</h3>

<p>It returns an object of class <code>slseFit</code> or <code>cslseFit</code>
depending on which method is called. An object of class <code>slseFit</code>
is a list with the following elements: 
</p>
<table role = "presentation">
<tr><td><code>LSE</code></td>
<td>
<p>This is the least squares estimate of the semiparametric
model. It is an object of class <code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>An object of class <code>slseModel</code>. It is the model that
is being estimated. The model may have been created by
<code><a href="#topic+slseModel">slseModel</a></code> or modified by <code><a href="#topic+selSLSE">selSLSE</a></code> or
<code><a href="#topic+update.slseModel">update</a></code>.</p>
</td></tr>
</table>
<p>An object of class <code>cslseFit</code> is a list of <code>slseFit</code> objects,
one for each treatment group. It also contains the following additional
attributes:
</p>
<table role = "presentation">
<tr><td><code>treatedVar</code></td>
<td>
<p>The name of the variable in the dataset that represents
the treatment indicator.</p>
</td></tr>
<tr><td><code>groupInd</code></td>
<td>
<p>A named vector with the value of the treatment indicator
corresponding do each treatment group.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat3)

## Estimating a causal semiparametric model

mod1 &lt;- cslseModel(Y ~ Z | ~ X1 * X2, data = simDat3)
fit1 &lt;- estSLSE(mod1)

## Estimating a semiparametric model

mod2 &lt;- slseModel(Y ~ X1 * X2, data = simDat3)
fit2 &lt;- estSLSE(mod2)
</code></pre>

<hr>
<h2 id='extract+2Ccslse-method'><code><a href="texreg.html#topic+extract">extract</a></code> Method for <code>cslse</code> Objects</h2><span id='topic+extract+2Ccslse-method'></span><span id='topic+extract.cslse'></span>

<h3>Description</h3>

<p><code><a href="texreg.html#topic+extract">extract</a></code> method for <code>cslse</code> objects created by the
<code><a href="#topic+causalSLSE">causalSLSE</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cslse'
extract(
    model,
    include.nobs = TRUE,
    include.nknots = TRUE,
    include.numcov = TRUE,
    include.rsquared = TRUE,
    include.adjrs=TRUE,
    separated.rsquared = FALSE,    
    which = c("ALL","ACE","ACT","ACN","ACE-ACT","ACE-ACN","ACT-ACN"),
    ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract+2B2Ccslse-method_+3A_model">model</code></td>
<td>
<p>A causal effect object created by
<code><a href="#topic+causalSLSE">causalSLSE</a></code>.</p>
</td></tr> 
<tr><td><code id="extract+2B2Ccslse-method_+3A_include.nobs">include.nobs</code></td>
<td>
<p>Report the number of obervations?</p>
</td></tr>
<tr><td><code id="extract+2B2Ccslse-method_+3A_include.nknots">include.nknots</code></td>
<td>
<p>Report the total number of knots for each group?</p>
</td></tr>
<tr><td><code id="extract+2B2Ccslse-method_+3A_include.numcov">include.numcov</code></td>
<td>
<p>Report the total number of covariates (including
interactions is any) per group?</p>
</td></tr>
<tr><td><code id="extract+2B2Ccslse-method_+3A_include.rsquared">include.rsquared</code></td>
<td>
<p>Report the R-squared of the final regression
estimtion</p>
</td></tr>
<tr><td><code id="extract+2B2Ccslse-method_+3A_include.adjrs">include.adjrs</code></td>
<td>
<p>Report the adjusted R-squared of the final
regression estimtion</p>
</td></tr>
<tr><td><code id="extract+2B2Ccslse-method_+3A_separated.rsquared">separated.rsquared</code></td>
<td>
<p>Should we print the R-squared separately for
each group? This applies as well to the adjusted R-squared. </p>
</td></tr>
<tr><td><code id="extract+2B2Ccslse-method_+3A_which">which</code></td>
<td>
<p>Which causal effect measures should be printed?</p>
</td></tr>
<tr><td><code id="extract+2B2Ccslse-method_+3A_...">...</code></td>
<td>
<p>Custom parameters, which are handed over to subroutines. Currently
not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns an object of class <code><a href="texreg.html#topic+texreg">texreg</a></code>.  
</p>

<hr>
<h2 id='extract+2CslseFit-method'><code><a href="texreg.html#topic+extract">extract</a></code> Method for <code>slseFit</code> Objects</h2><span id='topic+extract+2CslseFit-method'></span><span id='topic+extract.slseFit'></span>

<h3>Description</h3>

<p><code><a href="texreg.html#topic+extract">extract</a></code> method for <code>slseFit</code> objects created by the
<code><a href="#topic+estSLSE">estSLSE</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'slseFit'
extract(
  model,
  include.rsquared = TRUE,
  include.adjrs = TRUE, 
  include.nobs = TRUE,
  include.fstatistic = FALSE,
  include.rmse = FALSE,
  ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract+2B2CslseFit-method_+3A_model">model</code></td>
<td>
<p>A model estimated by <code><a href="#topic+estSLSE">estSLSE</a></code>.</p>
</td></tr> 
<tr><td><code id="extract+2B2CslseFit-method_+3A_include.rsquared">include.rsquared</code></td>
<td>
<p>Report the R-squared of the final regression
estimation</p>
</td></tr>
<tr><td><code id="extract+2B2CslseFit-method_+3A_include.adjrs">include.adjrs</code></td>
<td>
<p>Report the adjusted R-squared of the final
regression estimtion</p>
</td></tr>
<tr><td><code id="extract+2B2CslseFit-method_+3A_include.nobs">include.nobs</code></td>
<td>
<p>Report the number of obervations?</p>
</td></tr>
<tr><td><code id="extract+2B2CslseFit-method_+3A_include.fstatistic">include.fstatistic</code></td>
<td>
<p>Report the F-statistics?</p>
</td></tr>
<tr><td><code id="extract+2B2CslseFit-method_+3A_include.rmse">include.rmse</code></td>
<td>
<p>Report the RMSE?</p>
</td></tr>
<tr><td><code id="extract+2B2CslseFit-method_+3A_...">...</code></td>
<td>
<p>Custom parameters, which are handed over to subroutines. Currently
not in use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns an object of class <code><a href="texreg.html#topic+texreg">texreg</a></code>.  
</p>

<hr>
<h2 id='llSplines'>
Local Linear Splines Generator for Model Objects
</h2><span id='topic+llSplines'></span><span id='topic+llSplines.slseModel'></span><span id='topic+llSplines.cslseModel'></span>

<h3>Description</h3>

<p>It generates a matrix of basis functions using local linear splines. The
number of basis functions and the breaking points are determined by the
knot specifications of the <code>slseModel</code> or <code>cslseModel</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slseModel'
llSplines(object, ...)
## S3 method for class 'cslseModel'
llSplines(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="llSplines_+3A_object">object</code></td>
<td>
<p>A model of class <code><a href="#topic+slseModel">slseModel</a></code> or
<code><a href="#topic+cslseModel">cslseModel</a></code>.</p>
</td></tr>  
<tr><td><code id="llSplines_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to other methods. Currently
not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> The function returns a matrix of basis functions used to
estimate the semiparametric model. It is used directly as regressor in
<code><a href="stats.html#topic+lm">lm</a></code> as shown in the example below.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(simDat3)

## We manually estimate the semiparametric model

mod1 &lt;- slseModel(Y ~ X1 * X2, data = simDat3)
U &lt;- llSplines(mod1)
fit1 &lt;- lm(Y ~ U, data = simDat3)

## We use estSLSE instead (results are identical)

fit2 &lt;- estSLSE(mod1)

</code></pre>

<hr>
<h2 id='nsw'>Lalonde Subsample of the National Supported Work Demonstration Data
(NSW)</h2><span id='topic+nsw'></span>

<h3>Description</h3>

<p>This data was collected to evaluate the National Supported Work
(NSW) Demonstration project in Lalonde (1986).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nsw)</code></pre>


<h3>Format</h3>

<p>A data frame containing 9 variables. 
</p>

<dl>
<dt>treat</dt><dd><p>Treatment assignment</p>
</dd> 
<dt>age</dt><dd><p>Age</p>
</dd> 
<dt>ed</dt><dd><p>Years of Education</p>
</dd> 
<dt>black</dt><dd><p>1 if Black, 0 otherwise</p>
</dd> 
<dt>hisp</dt><dd><p>1 if Hispanic 0 otherwise</p>
</dd> 
<dt>married</dt><dd><p>1 if married 0 otherwise</p>
</dd> 
<dt>nodeg</dt><dd><p>1 if no college degree 0 otherwise</p>
</dd> 
<dt>re75</dt><dd><p>1975 earnings</p>
</dd> 
<dt>re78</dt><dd><p>1978 earnings</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dataset was obtained from the ATE package (see reference).
</p>


<h3>Source</h3>

<p>&quot;NSW Data Files&quot; from Rajeev Dehejia's website. URL:
<a href="http://users.nber.org/~rdehejia/data/.nswdata2.html">http://users.nber.org/~rdehejia/data/.nswdata2.html</a>
</p>
<p>&quot;National Supported Work Evaluation Study, 1975-1979: Public Use Files.&quot;
from the Interuniversity Consortium for Political and Social
Research. URL: <a href="http://www.icpsr.umich.edu/icpsrweb/ICPSR/studies/7865">http://www.icpsr.umich.edu/icpsrweb/ICPSR/studies/7865</a>
</p>


<h3>References</h3>

<p>Lalonde, R. (1986). &quot;Evaluating the Econometric Evaluations of Training Programs,&quot; American Economic Review, 76(4), 604-620.
</p>
<p>Dehejia R. and Wahba S. (1999).  &quot;Causal Effects in Non-Experimental Studies: Re-Evaluating the Evaluation of Training Programs,&quot; JASA 94 (448), 1053-1062.
</p>
<p>Asad Haris and Gary Chan (2015). ATE: Inference for Average Treatment
Effects using Covariate Balancing. R package version 0.2.0.
<a href="https://CRAN.R-project.org/package=ATE">https://CRAN.R-project.org/package=ATE</a>
</p>

<hr>
<h2 id='plot'>Plot of Predicted Outcome</h2><span id='topic+plot.cslseFit'></span><span id='topic+plot.slseFit'></span>

<h3>Description</h3>

<p>For objects of class <code>slseFit</code>, the method plots the predicted
outcome with respect to a given covariate. It is the same for objects of class
<code>cslseFit</code>, but the predicted outcome is plotted for each treatment
group separately.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cslseFit'
plot(x, y, which = y, interval = c("none", "confidence"), 
                        level = 0.95, fixedCov = list(),
                        vcov. = vcovHC,  add = FALSE, addToLegend = NULL,
                        addPoints = FALSE, FUN = mean,
                        plot=TRUE, graphPar=list(), ...)
## S3 method for class 'slseFit'
plot(x, y, which = y, interval = c("none", "confidence"), 
                       level = 0.95, fixedCov = NULL,
                       vcov. = vcovHC,  add = FALSE, 
                       addPoints = FALSE, FUN = mean,
                       plot=TRUE, graphPar=list(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>Object of class <code>cslseFit</code> or <code>slseFit</code> created by
<code><a href="#topic+estSLSE">estSLSE</a></code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_y">y</code></td>
<td>
<p>alias for <code>which</code> for compatibility with <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_which">which</code></td>
<td>
<p>Which covariate to plot against the outcome variable. It
could be an integer or a character.</p>
</td></tr>
<tr><td><code id="plot_+3A_interval">interval</code></td>
<td>
<p>The type of confidence interval. The default is
<code>none</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_level">level</code></td>
<td>
<p>The confidence interval level if included.</p>
</td></tr>
<tr><td><code id="plot_+3A_fixedcov">fixedCov</code></td>
<td>
<p>List of covariates to fix to
specific values for the nontreated and treated groups. By default,
covariates not selected by <code>which</code> are set to their group
specific sample means.</p>
</td></tr>
<tr><td><code id="plot_+3A_vcov.">vcov.</code></td>
<td>
<p>An alternative function to compute the covariance
matrix of the least squares estimates. The default is the
<code>vcovHC</code> method for <code>lm</code> objects.</p>
</td></tr>
<tr><td><code id="plot_+3A_add">add</code></td>
<td>
<p>Should the plot be added to an existing one?</p>
</td></tr>
<tr><td><code id="plot_+3A_addtolegend">addToLegend</code></td>
<td>
<p>A character string to add to the legend next to
treated and control.</p>
</td></tr>
<tr><td><code id="plot_+3A_addpoints">addPoints</code></td>
<td>
<p>Should we add the scatterplot of the outcome and
covariate on the graph?</p>
</td></tr>
<tr><td><code id="plot_+3A_fun">FUN</code></td>
<td>
<p>The function to determine the fixed value for the
covariates not fixed by <code>fixedCov</code>. The
default is <code>mean</code>.</p>
</td></tr> 
<tr><td><code id="plot_+3A_plot">plot</code></td>
<td>
<p>If set to <code>FALSE</code>, a <code>data.frame</code> is returned
for each group with the covariate selected by <code>which</code> and the
prediction.</p>
</td></tr>
<tr><td><code id="plot_+3A_graphpar">graphPar</code></td>
<td>
<p>A list of graphical parameters. See Details.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Additional argument to pass to the <code>vcov.</code> function.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The default set of parameters can be obtained by running the command
<code>causalSLSE:::.initPar()</code>. It returns a list of four elements:
<code>treated</code> for the parameter of the lines or points of the treated,
<code>nontreated</code> for the parameters of the nontreated, <code>common</code>
for the common parameters not specific to a group like the main title or
the axis labels, and <code>legend</code> for the legend parameters. The
elements <code>treated</code> and <code>nontreated</code> are lists of two elements:
<code>points</code> and <code>lines</code>, which are lists of graphical parameters
for the scatterplot (when <code>addPoints</code> is <code>TRUE</code>) and the
lines. The argument <code>graphPar</code> can be use to modify existing
parameters or to add new ones. It must respect the structure of the
initial list. See the example below.
</p>
<p>To fix covariates to the same values for both groups, <code>fixedCov</code> is
just a named list with values for the covariates associated with the
names. To fix the covariates to different values for the treated and
nontreated, <code>fixedCov</code> is a named list of at least 1 element with
names being either treated, nontreated or both. If only one group is
specified, the covariates for the other groups are determined by
<code>FUN</code>.
</p>


<h3>Value</h3>

<p>It returns <code>NULL</code> invisibly if the argument <code>plot</code> is
<code>TRUE</code>. Otherwise, it returns a <code>data.frame</code> with the
necessary variables to manually create the plot. For <code>slseModel</code>
objects, it is a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>Outcome</code></td>
<td>
<p>The outcome variable from the model. The name of this
element is the actual name of the outcome variable in the model.</p>
</td></tr>
<tr><td><code>which</code></td>
<td>
<p>The covariate selected by the argument <code>which</code>. The
name of this element is the name of the selected covariate.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>The predicted outcome from the model fit.</p>
</td></tr>
<tr><td><code>lower</code>, <code>upper</code></td>
<td>
<p>The lower and upper bounds of the confidence
interval. It is only available when the argument <code>interval</code> is
set to <code>"confidence"</code>.
</p>
</td></tr>
</table>
<p>Note that all returned variables are ordered with respect to the selected
covariates. See the example below.
</p>
<p>For <code>cslseModel</code>, the above list of variables is returned
separately for each treatment group. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat3)

##  For cslse objects

mod &lt;- cslseModel(Y ~ Z | ~ X1 + X2, data = simDat3)
fit &lt;- causalSLSE(mod) 
plot(fit, "X1")

## Let's change the type of points for the treated and lines for the
## nontreated

gpar &lt;- list(treated = list(points = list(pch = 24, col = 5)),
             nontreated = list(lines = list(lty = 5, col =
             "darkgreen")), common = list(xlab = "New X",  main =
             "Plot with changed parameters"))  

plot(fit, "X1", addPoints = TRUE, graphPar = gpar)

## For slseModel objects:

mod2 &lt;- slseModel(Y ~ X1 + X2, data = simDat3)
fit2 &lt;- estSLSE(mod2)
plot(fit2, "X1", interval = "confidence", addPoints = TRUE)

##  The same graph produced manually

p2 &lt;- plot(fit2, "X1", interval = "confidence", plot = FALSE)
plot(p2$X1, p2$Y, pch = 21, main = "Y against X1", xlab = "X1", ylab =
     "Y") 
lines(p2$X1, p2$fit, lwd = 2)
lines(p2$X1, p2$lower, lty = 3, lwd = 2)
lines(p2$X1, p2$upper, lty = 3, lwd = 2)
</code></pre>

<hr>
<h2 id='predict'>Outcome Prediction</h2><span id='topic+predict.cslseFit'></span><span id='topic+predict.slseFit'></span>

<h3>Description</h3>

<p>The method computes the predicted outcome for each group with standard
errors and confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'cslseFit'
predict(object, interval=c("none","confidence"),
                       se.fit=FALSE, newdata=NULL, level=0.95,
                       vcov.=vcovHC, ...)
## S3 method for class 'slseFit'
predict(object, interval=c("none","confidence"),
                       se.fit=FALSE, newdata=NULL, level=0.95,
                       vcov.=vcovHC, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_+3A_object">object</code></td>
<td>
<p>Object of class <code>cslseFit</code> or  <code>slseFit</code>
created by <code><a href="#topic+estSLSE">estSLSE</a></code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_interval">interval</code></td>
<td>
<p>If set to <code>"confidence"</code>, it returns the
predicted values along with the lower and upper bounds of the
confidence interval.</p>
</td></tr>   
<tr><td><code id="predict_+3A_se.fit">se.fit</code></td>
<td>
<p>Should the function return the standard errors of the 
predicted values?</p>
</td></tr>
<tr><td><code id="predict_+3A_level">level</code></td>
<td>
<p>The confidence interval level if interval is set to
<code>"confidence"</code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_newdata">newdata</code></td>
<td>
<p>A <code>data.frame</code> of new data. It must include values
for all covariates, and for the treatment indicator in the case of
<code>cslseFit</code> objects.</p>
</td></tr>
<tr><td><code id="predict_+3A_vcov.">vcov.</code></td>
<td>
<p>An alternative function to compute the covariance
matrix of the least squares estimates. The default is the
<code><a href="sandwich.html#topic+vcovHC.default">vcovHC</a></code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_...">...</code></td>
<td>
<p>Additional argument to pass to the <code>vcov.</code> function.</p>
</td></tr>  
</table>


<h3>Value</h3>

<p> For <code>slseFit</code> objects, it returns the predicted outcome if
<code>se.fit</code> is <code>FALSE</code> or a list of the following two elements
otherwise:
</p>
<table role = "presentation">
<tr><td><code>fit</code></td>
<td>
<p>The predicted outcome.</p>
</td></tr>
<tr><td><code>se.fit</code></td>
<td>
<p>The standard errors of the predicted outcomes.</p>
</td></tr>
</table>
<p>If the argument <code>confidence</code> is set to <code>"interval"</code>, the
predicted outcome is a matrix with the predicted outcome, and the
lower and upper bounds of the confidence intervals.
</p>
<p>For objects of class 'cslseFit', the same is returned for each
treatment group in a list. The elements of the list are <code>treated</code>
and <code>nontreated</code> (until the package allows for more than one
treatment).  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat3)
mod &lt;- cslseModel(Y ~ Z | ~ X1 + X2, data = simDat3)
fit &lt;- causalSLSE(mod)

## Predicting outcome for all observations

pr &lt;- predict(fit, interval = "confidence")

## Predicting outcome with new data

ndat &lt;- data.frame(X1 = c(-2, 1, 2, 3), X2 = c(-4, -2, 0, 1),
                   Z = c(1, 1, 0, 0))
predict(fit, newdata = ndat)

</code></pre>

<hr>
<h2 id='print'>Print Methods</h2><span id='topic+print.cslseModel'></span><span id='topic+print.slseModel'></span><span id='topic+print.cslse'></span><span id='topic+print.cslseFit'></span><span id='topic+print.slseFit'></span><span id='topic+print.slseKnots'></span><span id='topic+print.summary.cslse'></span><span id='topic+print.summary.cslseFit'></span><span id='topic+print.summary.slseFit'></span>

<h3>Description</h3>

<p>Print methods for different objects from the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cslseModel'
print(x, which=c("Model", "selKnots", "Pvalues"),
                           digits = max(3L, getOption("digits") - 3L), ...)
## S3 method for class 'slseModel'
print(x, which=c("Model", "selKnots", "Pvalues"),
                           digits = max(3L, getOption("digits") - 3L), ...)
## S3 method for class 'cslse'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
## S3 method for class 'cslseFit'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
## S3 method for class 'slseFit'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
## S3 method for class 'summary.cslse'
print(x, digits = max(3L, getOption("digits") - 3L),
                              signif.stars = getOption("show.signif.stars"),
                              beta=FALSE, knots = FALSE,...)
## S3 method for class 'summary.cslseFit'
print(x, groups, digits = max(3L, getOption("digits") - 3L),
                                signif.stars = getOption("show.signif.stars"),
                                ...)
## S3 method for class 'summary.slseFit'
print(x, digits = max(3L, getOption("digits") - 3L),
                                signif.stars = getOption("show.signif.stars"),
                                ...)
## S3 method for class 'slseKnots'
print(x, header=c("None", "All", "Select"),
                          digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>A model or a fit object.</p>
</td></tr>
<tr><td><code id="print_+3A_digits">digits</code></td>
<td>
<p>The number of digits to print.</p>
</td></tr>
<tr><td><code id="print_+3A_signif.stars">signif.stars</code></td>
<td>
<p>Should we print the significant stars?</p>
</td></tr>
<tr><td><code id="print_+3A_beta">beta</code></td>
<td>
<p>Should we print the coefficient matrix of the basis
functions?</p>
</td></tr> 
<tr><td><code id="print_+3A_knots">knots</code></td>
<td>
<p>Should we print the set of knots?</p>
</td></tr>
<tr><td><code id="print_+3A_which">which</code></td>
<td>
<p>What info we should print? It prints a summary of the
model when set to <code>"Model"</code>, the current knots when set to
<code>"selKnots"</code> and the p-values and initial knots when set to
<code>"Pvalues"</code>. For the latter, it is only available when a knots
selection method has been applied to the object.</p>
</td></tr> 
<tr><td><code id="print_+3A_header">header</code></td>
<td>
<p>What description of the object should be printed.</p>
</td></tr>
<tr><td><code id="print_+3A_groups">groups</code></td>
<td>
<p>The names of the group to be printed. By default,
they are all printed.</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>Argument for other types of objects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>All methods return <code>NULL</code> invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## For cslseModel objects

data(simDat3)
mod1 &lt;- cslseModel(Y ~ Z | ~ X1 * X2, data = simDat3)
print(mod1)

## For cslse objects

causal &lt;- causalSLSE(mod1)
print(causal)

## For summary.cslse objects

s &lt;- summary(causal)
print(s)

## For cslseFit objects

fit &lt;- estSLSE(mod1)
print(fit)

## For summary.cslseFit objects

summary(fit)
</code></pre>

<hr>
<h2 id='selSLSE'>
Knots Selection Method
</h2><span id='topic+selSLSE'></span><span id='topic+selSLSE.cslseModel'></span><span id='topic+selSLSE.slseModel'></span>

<h3>Description</h3>

<p>This is the main function to select the knots in <code>cslseModel</code> or
<code>slseModel</code> objects. It returns a model with an optimal set of
knots. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cslseModel'
selSLSE(model, selType=c("BLSE", "FLSE"),
        selCrit = c("AIC", "BIC", "PVT"), 
        pvalT = function(p) 1/log(p),
        vcovType = c("HC0", "Classical", "HC1", "HC2", "HC3"),
        reSelect=FALSE, ...)
## S3 method for class 'slseModel'
selSLSE(model, selType=c("BLSE", "FLSE"),
        selCrit = c("AIC", "BIC", "PVT"), 
        pvalT = function(p) 1/log(p),
        vcovType = c("HC0", "Classical", "HC1", "HC2", "HC3"),
        reSelect=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selSLSE_+3A_model">model</code></td>
<td>
<p>A model of class <code><a href="#topic+cslseModel">cslseModel</a></code> or
<code><a href="#topic+slseModel">slseModel</a></code>.</p>
</td></tr> 
<tr><td><code id="selSLSE_+3A_seltype">selType</code></td>
<td>
<p>The selection method: backward (<code>"BLSE"</code>) or
forward (<code>"FLSE"</code>).</p>
</td></tr> 
<tr><td><code id="selSLSE_+3A_selcrit">selCrit</code></td>
<td>
<p>The criterion to select the piecewise polynomial knots.</p>
</td></tr>
<tr><td><code id="selSLSE_+3A_pvalt">pvalT</code></td>
<td>
<p>A function to determine the p-value threshold for the
significance of the coefficients. It has to be a function of one
parameter, which is the average number of knots in the model.</p>
</td></tr>
<tr><td><code id="selSLSE_+3A_vcovtype">vcovType</code></td>
<td>
<p>The type of least squares covariance matrix used to
compute the p-values needed for the selection.</p>
</td></tr>
<tr><td><code id="selSLSE_+3A_reselect">reSelect</code></td>
<td>
<p>By default, the stored selections are used. If
<code>reSelect</code> is set to <code>TRUE</code>, the selection is re-computed.</p>
</td></tr>
<tr><td><code id="selSLSE_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to other methods. Currently
not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It selects the knots using one of the two methods, FLSE or BLSE, with
either the AIC, BIC or a p-value threshold (see the vignette for more
details). Any of these selection methods requires several least squares
estimations and it is performed only if the method has not been applied
yet and <code>reSelect</code> is set to <code>TRUE</code>. This is possible because
any new knots selection is saved into the returned model. A model may
have more than one selection saved into it. The active knots (the ones
used when we estimate the model) is stored into the element <code>knots</code>
of the model and the saved selections are stored into the element
<code>selections</code>. See below for what is included in this element.  
</p>
<p>Note that the selections for the three criteria AIC, BIC and PVT are
computed and saved automatically in the returned model when
<code>selCrit</code> is set to either <code>"AIC"</code> or <code>"BIC"</code>, because it
does not require many more operations to select them all once we do it
for AIC or BIC. However, it is only computed for PVT when <code>selCrit</code>
is set to <code>"PVT"</code>. 
</p>
<p>The knots are selected jointly for all treatment groups in
<code>cslseModel</code> objects. However, the active knots and all saved
selections are stored separately for each treatment group. For example,
the active knots for the treated in the <code>cslseModel</code> object
<code>mod</code> are stored in <code>mod$treated$knots</code>. See the Vignette for
more details.
</p>


<h3>Value</h3>

<p>The method returns an object of class <code><a href="#topic+slseModel">slseModel</a></code> or
<code><a href="#topic+cslseModel">cslseModel</a></code> depending on which object it is applied
to. When it does not already exist, the element <code>selections</code> is added
to the <code>slseModel</code> object (or to each <code>slseModel</code> object in
<code>cslseModel</code> objects). The element <code>selections</code> is a list with
one or more of the following elements:
</p>
<table role = "presentation">
<tr><td><code>originalKnots</code></td>
<td>
<p>The original knots as selected initially by
<code><a href="#topic+slseModel">slseModel</a></code> or <code><a href="#topic+cslseModel">cslseModel</a></code>. This element is
always included.</p>
</td></tr>
<tr><td><code>FLSE</code>, <code>BLSE</code></td>
<td>
<p>This is where selections based on the forward (FLSE) and
the backward (BLSE) methods are stored.</p>
</td></tr>
</table>
<p>Finally, <code>BLSE</code> and <code>FLSE</code> are lists that may contain the following elements:   
</p>
<table role = "presentation">
<tr><td><code>AIC</code>, <code>BIC</code></td>
<td>
<p>A list of integer vectors, one for each covariate in the
<code>slseModel</code> model. The vectors of integers indicate which sets the
original set of knots minimizes the AIC or the BIC.</p>
</td></tr>
<tr><td><code>PVT</code></td>
<td>
<p>Same as the AIC and BIC, but the selection is based on a p-value
threshold.</p>
</td></tr>
<tr><td><code>JAIC</code>, <code>JBIC</code></td>
<td>
<p>This criteria is for <code>cslseModel</code> models. It is
like the AIC and BIC, but it indicates that the AIC or BIC was
computes by estimating the models of all treatment groups
jointly. This selection is not the same as a selection group by group.</p>
</td></tr>
<tr><td><code>Threshold</code></td>
<td>
<p>The p-value threshold used for the PVT criterion.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>A list of p-values, one for each original knots. See
vignette for a definition of the p-values.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+slseModel">slseModel</a></code> and <code><a href="#topic+cslseModel">cslseModel</a></code> for model
objects description and <code><a href="#topic+update.slseModel">update</a></code> for
ways of selecting stored selections</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat3)
mod1 &lt;- cslseModel(Y~Z|~X1*X2, data=simDat3)
mod1 &lt;- selSLSE(mod1, selType="FLSE", selCrit="AIC")

## The following does not require additional computation
## because the selection is stored in mod1

mod1 &lt;- selSLSE(mod1, selType="FLSE", selCrit="BIC")


## But the following does

mod1 &lt;- selSLSE(mod1, selType="BLSE", selCrit="BIC")

## See one selection:

mod1$treated$selections$BLSE$JBIC

</code></pre>

<hr>
<h2 id='simDat1'>
Simulated Data
</h2><span id='topic+simDat1'></span>

<h3>Description</h3>

<p>This dataset is used in several documentation files to illustrate the
different functionalities of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simDat1")</code></pre>


<h3>Format</h3>

<p>A data frame with 300 observations on the following 9 variables. 
</p>

<dl>
<dt><code>X</code></dt><dd><p>Continuous Covariate</p>
</dd>
<dt><code>Z</code></dt><dd><p>Treatment indicator.</p>
</dd>
<dt><code>Y</code></dt><dd><p>Observed outcome.</p>
</dd>
<dt><code>Y1</code></dt><dd><p>Outcome for the treated (not observed in
practice).</p>
</dd>      
<dt><code>Y0</code></dt><dd><p>Outcome for the nontreated (not observed in
practice).</p>
</dd>
<dt><code>U01</code>, <code>U02</code></dt><dd><p>The true basis functions for the
nontreated.</p>
</dd> 
<dt><code>U11</code>, <code>U12</code></dt><dd><p>The true basis functions for the
treated.</p>
</dd>     
</dl>


<hr>
<h2 id='simDat2'>
Simulated Data
</h2><span id='topic+simDat2'></span>

<h3>Description</h3>

<p>This dataset is used in several documentation files to illustrate the
different functionalities of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simDat2")</code></pre>


<h3>Format</h3>

<p>A data frame with 300 observations on the following 11 variables. 
</p>

<dl>
<dt><code>X</code></dt><dd><p>Continuous Covariate</p>
</dd>
<dt><code>Z</code></dt><dd><p>Treatment indicator.</p>
</dd>
<dt><code>Y</code></dt><dd><p>Observed outcome.</p>
</dd>
<dt><code>Y1</code></dt><dd><p>Outcome for the treated (not observed in
practice).</p>
</dd>      
<dt><code>Y0</code></dt><dd><p>Outcome for the nontreated (not observed in
practice).</p>
</dd>
<dt><code>U01</code>, <code>U02</code>, <code>U03</code></dt><dd><p>The true basis functions
for the nontreated.</p>
</dd>  
<dt><code>U11</code>, <code>U12</code>, <code>U13</code></dt><dd><p>The true basis functions
for the treated.</p>
</dd>      
</dl>


<hr>
<h2 id='simDat3'>
Simulated Data
</h2><span id='topic+simDat3'></span>

<h3>Description</h3>

<p>This dataset is used in several documentation files to illustrate the
different functionalities of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simDat3")</code></pre>


<h3>Format</h3>

<p>A data frame with 300 observations on the following 16 variables. 
</p>

<dl>
<dt><code>X1</code></dt><dd><p>Continuous Covariate</p>
</dd>
<dt><code>X2</code></dt><dd><p>Continuous Covariate</p>
</dd>
<dt><code>Z</code></dt><dd><p>Treatment indicator.</p>
</dd>
<dt><code>Y</code></dt><dd><p>Observed outcome.</p>
</dd>
<dt><code>Y1</code></dt><dd><p>Outcome for the treated (not observed in
practice).</p>
</dd>      
<dt><code>Y0</code></dt><dd><p>Outcome for the nontreated (not observed in
practice).</p>
</dd>
<dt><code>U01</code>, <code>U02</code>, <code>U03</code>, <code>U04</code>,
<code>U05</code></dt><dd><p>The true basis functions for the nontreated.</p>
</dd>  
<dt><code>U11</code>, <code>U12</code>, <code>U13</code>, <code>U14</code>,
<code>U15</code></dt><dd><p>The true basis functions for the treated.</p>
</dd>      
</dl>


<hr>
<h2 id='simDat4'>
Simulated Data.
</h2><span id='topic+simDat4'></span>

<h3>Description</h3>

<p>This dataset is used in several documentation files to illustrate the
different functionalities of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simDat4")</code></pre>


<h3>Format</h3>

<p>A data frame with 500 observations on the following 7 variables. 
</p>

<dl>
<dt><code>Z</code></dt><dd><p>Treatment indicator.</p>
</dd>
<dt><code>Y</code></dt><dd><p>Observed outcome.</p>
</dd>
<dt><code>X1</code></dt><dd><p>Continuous covariates with a large proportion of
zeros.</p>
</dd>
<dt><code>X2</code></dt><dd><p>A categorical variable with 3 character levels (not expressed
as factor).</p>
</dd>
<dt><code>X3</code></dt><dd><p>A categorical variable with 3 numerical levels (not expressed
as factor).</p>
</dd>
<dt><code>X4</code></dt><dd><p>A binary variable.</p>
</dd>
<dt><code>treat</code></dt><dd><p>A character variable.</p>
</dd>          
</dl>


<hr>
<h2 id='simDat5'>
Simulated Data
</h2><span id='topic+simDat5'></span>

<h3>Description</h3>

<p>This dataset is used in several documentation files to illustrate the
different functionalities of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simDat5")</code></pre>


<h3>Format</h3>

<p>A data frame with 300 observations on the following 16 variables. 
</p>

<dl>
<dt><code>X1</code></dt><dd><p>Continuous Covariate</p>
</dd>
<dt><code>X2</code></dt><dd><p>Continuous Covariate</p>
</dd>
<dt><code>Z</code></dt><dd><p>Treatment indicator.</p>
</dd>
<dt><code>Y</code></dt><dd><p>Observed outcome.</p>
</dd>
<dt><code>Y1</code></dt><dd><p>Outcome for the treated (not observed in
practice).</p>
</dd>      
<dt><code>Y0</code></dt><dd><p>Outcome for the nontreated (not observed in
practice).</p>
</dd>
</dl>


<hr>
<h2 id='slseKnots'>
Knots Creator for Basis Functions
</h2><span id='topic+slseKnots'></span>

<h3>Description</h3>

<p>The function creates an object of class <code>slseKnots</code> for
semiparametric least squares models. It returns an object of 
class <code>slseKnots</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slseKnots(form, data, X, nbasis = function(n) n^0.3, 
          knots)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slseKnots_+3A_form">form</code></td>
<td>
<p>A formula that determines the covariates to include in
the regression. It is a regular formula and only the right hand side
is considered.</p>
</td></tr> 
<tr><td><code id="slseKnots_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> with all variables included in
<code>form</code>. It is required when <code>X</code> is missing.</p>
</td></tr>
<tr><td><code id="slseKnots_+3A_nbasis">nbasis</code></td>
<td>
<p>A function to determine the number of basis
functions. It has to be a function of one argument, the sample
size.</p>
</td></tr> 
<tr><td><code id="slseKnots_+3A_knots">knots</code></td>
<td>
<p>An optional list of knots. Each element of the list (one
for each covariate) is either a vector of numeric knots or it is
<code>NULL</code>. The latter implies that the number of knots is set to
0. If missing (the default), the knots are automatically generated
(see the details below).</p>
</td></tr>
<tr><td><code id="slseKnots_+3A_x">X</code></td>
<td>
<p>An optional matrix of covariates. When provided, <code>form</code>
is not needed.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The automatic selection is as follows. It is applied to each
variable created by the <code><a href="stats.html#topic+model.matrix">model.matrix</a></code> of <code>form</code> except for
the intercept:
</p>
<p>The number of knots is the ceiling of what the <code>nbasis</code> function
returns minus 1. Let <code>p-1</code> be the number of knots. Then, we
compute the <code>p+1</code> empirical quantiles of the variable for equally
spaced probabilities going from 0 to 1 and drop the first and last
ones. This is done using the function <code><a href="stats.html#topic+quantile">quantile</a></code> with
<code>type=1</code>. We then remove the duplicated values and the ones equal
to either the <code>min</code> or the <code>max</code> of the variable. if the number
of remaining knots is equal to 0, the set of knots for this variable
is set to <code>NULL</code>.
</p>
<p>For manual selection, see the vignette.
</p>


<h3>Value</h3>

<p>It returns an object of class <code>slseKnots</code>. It is a list for which
the length and names are respectively the number of columns and the
column names of the <code><a href="stats.html#topic+model.matrix">model.matrix</a></code> of <code>form</code> after
the intercept has been removed. Each element is a numeric vector of
knots, unless the number of knots is set to 0, in  which case it is
<code>NULL</code>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat3)
k &lt;- slseKnots(Y ~ X1 * X2, data = simDat3)
k

## We can extract the set for one variable

k$X1

</code></pre>

<hr>
<h2 id='summary'>Summary Method for Fitted Models</h2><span id='topic+summary.cslse'></span><span id='topic+summary.cslseFit'></span><span id='topic+summary.slseFit'></span>

<h3>Description</h3>

<p>The method computes summary statistics for estimated semiparametric and
causal models. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cslse'
summary(object, ...)
## S3 method for class 'cslseFit'
summary(object, vcov.=vcovHC, ...)
## S3 method for class 'slseFit'
summary(object, vcov.=vcovHC, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>A model estimated by <code><a href="#topic+estSLSE">estSLSE</a></code> or
<code><a href="#topic+causalSLSE">causalSLSE</a></code>.</p>
</td></tr> 
<tr><td><code id="summary_+3A_vcov.">vcov.</code></td>
<td>
<p>A function to compute the strandard error of the
least squares coefficients. The default is
<code><a href="sandwich.html#topic+vcovHC.default">vcovHC</a></code>.</p>
</td></tr>  
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>Argument for other types of objects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>summary.slseFit</code> returns the summary statistics of
the least squares estimation of <code><a href="#topic+slseModel">slseModel</a></code> objects
estimated by <code><a href="#topic+estSLSE">estSLSE</a></code>. It is an object of class
<code>summary.slseFit</code>, which is a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>The <code><a href="#topic+slseModel">slseModel</a></code> model being estimated.</p>
</td></tr>
<tr><td><code>lseSum</code></td>
<td>
<p>An object of class <code><a href="stats.html#topic+summary.lm">summary.lm</a></code>.</p>
</td></tr>
</table>
<p>The function <code>summary.cslseFit</code> returns an object of class
<code>summary.cslseFit</code>, which is a list of <code>summary.slseFit</code> objects,
one for each treatment group. 
</p>
<p>The function <code>summary.cslse</code> returns the summary statistics of the
causal effect estimates. It is an object of class <code>summary.cslse</code>,
which is a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>causal</code></td>
<td>
<p>A matrix with the causal effect estimates in the first
column, their standard errors in the second, their t-ratios in the
third and p-values in the fourth.</p>
</td></tr>
<tr><td><code>lse</code></td>
<td>
<p>A list of <code>summary.slseFit</code> objects, one for each
treatment group.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## A causal semiparametric model with causal effect estimates 

data(simDat3)
mod1 &lt;- cslseModel(Y ~ Z | ~ X1 * X2, data = simDat3)
CE &lt;- causalSLSE(mod1, selType = "BLSE")
summary(CE)

## A causal semiparametric model

fit &lt;- estSLSE(mod1)
summary(fit)

## A semiparametric model

mod2 &lt;- slseModel(Y ~ X1 * X2, data = simDat3)
fit2 &lt;- estSLSE(mod2)
summary(fit2)
</code></pre>

<hr>
<h2 id='update'>Update Methods</h2><span id='topic+update.cslseModel'></span><span id='topic+update.slseModel'></span><span id='topic+update.slseKnots'></span>

<h3>Description</h3>

<p>The method updates an object by modifying its specification. Currently,
it is used to change the set of knots by either selecting them manually
or by specifying the selection methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'cslseModel'
update(object, selType, selCrit="AIC",
                            selKnots, ...)

## S3 method for class 'slseModel'
update(object, selType, selCrit="AIC",
                           selKnots, ...)

## S3 method for class 'slseKnots'
update(object, selKnots, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_+3A_object">object</code></td>
<td>
<p>An object to be modified.</p>
</td></tr>
<tr><td><code id="update_+3A_selknots">selKnots</code></td>
<td>
<p>An optional list of integers to select the knots from
the original list of knots. If missing, the current knots are kept.</p>
</td></tr>  
<tr><td><code id="update_+3A_seltype">selType</code></td>
<td>
<p>The selection method: <code>"BLSE"</code> for the backward method, 
<code>"FLSE"</code> for the forward method or <code>"none"</code> to recover the
originnal set of knots.</p>
</td></tr>  
<tr><td><code id="update_+3A_selcrit">selCrit</code></td>
<td>
<p>The criterion to select the optimal set of knots.</p>
</td></tr>
<tr><td><code id="update_+3A_...">...</code></td>
<td>
<p>Argument for other types of objects. Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method for <code>slseKnots</code> is explained in the vignette, but it
is mostly used internally. For the model objects, the method can be used
to choose a set of knots already stored in the object. It avoids
having to re-compute them which can be computationally intensive for
large samples. It returns an error message if the type of selection
requested does not exist. In that case, you need to run the
<code>selSLSE</code> method. If the <code>selType</code> argument is set to
<code>None</code>, the method returns the  original model.  
</p>


<h3>Value</h3>

<p>It returns an object of the same class, but with a different set of knots.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selSLSE">selSLSE</a></code> for more details on how stored knots can
be selected from a model, <code><a href="#topic+slseModel">slseModel</a></code> for model
description and <code><a href="#topic+slseKnots">slseKnots</a></code> for the format of knots</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat3)
mod1 &lt;- cslseModel(Y ~ Z | ~ X1 * X2, data = simDat3)
mod2 &lt;- selSLSE(mod1, "BLSE", "AIC")

## We changed the knots to the BLSE-BIC selection
## already stored in the model object

update(mod2, "BLSE", "BIC")

## We recover the original set of knots

update(mod2, "None")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
