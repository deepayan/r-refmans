<!DOCTYPE html><html><head><title>Help for package BayesSenMC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesSenMC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BayesSenMC-package'><p>The 'BayesSenMC' package.</p></a></li>
<li><a href='#bd_meta'><p>Meta-analysis data on Bipolar Disorder diagnosis accuracy</p></a></li>
<li><a href='#correctedOR'><p>Model with constant nondifferential misclassification</p></a></li>
<li><a href='#crudeOR'><p>Model without misclassification</p></a></li>
<li><a href='#diffOR'><p>Model with differential misclassification</p></a></li>
<li><a href='#fixedCorrOR'><p>Model with nondifferential, correlated misclassification</p></a></li>
<li><a href='#logitOR'><p>Model with nondifferential, logit normal-distributed misclassification</p></a></li>
<li><a href='#nlmeNDiff'><p>Non-differential Generalized Linear Mixed Effects Model</p></a></li>
<li><a href='#paramEst'><p>Parameter estimates of the GLMM model</p></a></li>
<li><a href='#plotOR'><p>Plot Model</p></a></li>
<li><a href='#randCorrOR'><p>Model with nondifferential, randomly correlated misclassification</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Different Models of Posterior Distributions of Adjusted Odds
Ratio</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.5</td>
</tr>
<tr>
<td>Author:</td>
<td>Jinhui Yang, Haitao Chu, and Lifeng Lin</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jinhui Yang &lt;james.yangjinhui@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/formidify/BayesSenMC">https://github.com/formidify/BayesSenMC</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/formidify/BayesSenMC/issues">https://github.com/formidify/BayesSenMC/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Generates different posterior distributions of adjusted odds ratio under different priors of sensitivity and specificity, and plots the models for comparison. It also provides estimations for the specifications of the models using diagnostics of exposure status with a non-linear mixed effects model. It implements the methods that are first proposed in &lt;<a href="https://doi.org/10.1016%2Fj.annepidem.2006.04.001">doi:10.1016/j.annepidem.2006.04.001</a>&gt; and &lt;<a href="https://doi.org/10.1177%2F0272989X09353452">doi:10.1177/0272989X09353452</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 0.12.0), RcppParallel (&ge; 5.0.1), rstan (&ge;
2.18.1), rstantools (&ge; 2.1.1), dplyr, ggplot2, lme4</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.18.1), StanHeaders (&ge;
2.18.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-01 23:05:25 UTC; james</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-06 07:30:32 UTC</td>
</tr>
</table>
<hr>
<h2 id='BayesSenMC-package'>The 'BayesSenMC' package.</h2><span id='topic+BayesSenMC-package'></span><span id='topic+BayesSenMC'></span>

<h3>Description</h3>

<p>This package generates different posterior distributions of adjusted odds ratio under different priors of sensitivity and specificity, and plots the models for comparison. It also provides estimations for the specifications of the models using diagnostics of exposure status with a non-linear mixed effects model.
</p>


<h3>References</h3>

<p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.21.2. https://mc-stan.org
</p>

<hr>
<h2 id='bd_meta'>Meta-analysis data on Bipolar Disorder diagnosis accuracy</h2><span id='topic+bd_meta'></span>

<h3>Description</h3>

<p>Records the true positive, true negative, false positive and false negative
of each diagnosis accuracy study. Also includes the type of screening instruments
(Bipolar Spectrum diagnostic scale / HCL-21 / Mood disorder questionnaire), the cut-off
value for diagnostics, and the percentage of bipolar cases that were of bipolar disorder
type II or not specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bd_meta)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 55 rows and 8 columns.
</p>


<h3>Source</h3>

<p><a href="https://www.sciencedirect.com/science/article/pii/S0165032714006466">https://www.sciencedirect.com/science/article/pii/S0165032714006466</a>
</p>


<h3>References</h3>

<p>Carvalho et al. (2015) &quot;Screening for bipolar spectrum disorders: A comprehensive meta-analysis of accuracy studies&quot;. Journal of Affective Disorders 172: 337 - 346.
(<a href="https://www.sciencedirect.com/science/article/pii/S0165032714006466">ScienceDirect</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bd_meta)
</code></pre>

<hr>
<h2 id='correctedOR'>Model with constant nondifferential misclassification</h2><span id='topic+correctedOR'></span>

<h3>Description</h3>

<p>Generate a stanfit object corresponding to a posterior distribution of corrected odds ratio given nondifferential misclassification with Se and Sp (i.e., both are constant and at least one of Se or Sp is lower than 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correctedOR(
  a,
  N1,
  c,
  N0,
  prior_list = NULL,
  se = NULL,
  sp = NULL,
  logitpi0_prior = c(0, 10),
  lor_prior = c(0, 2),
  chains = 2,
  traceplot = FALSE,
  inc_warmup = FALSE,
  window = NULL,
  refresh = 0,
  seed = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correctedOR_+3A_a">a</code></td>
<td>
<p>number of exposed subjects in the case group.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_n1">N1</code></td>
<td>
<p>number of total subjects in the case group.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_c">c</code></td>
<td>
<p>number of exposed subjects in the control group.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_n0">N0</code></td>
<td>
<p>number of total subjects in the control group.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_prior_list">prior_list</code></td>
<td>
<p>list of priors. Can be replaced by the function call to <code>paramEst</code>, or a list of prior parameters (<code>se</code>, <code>sp</code>).
If <code>prior_list</code> is specified, the values for the function parameters <code>se</code> and <code>sp</code> will be disregarded.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_se">se</code></td>
<td>
<p>sensitivity. Do not have to specify this if <code>prior_list</code> is given - this will be disregarded.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_sp">sp</code></td>
<td>
<p>specificity. Do not have to specify this if <code>prior_list</code> is given - this will be disregarded.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_logitpi0_prior">logitpi0_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of <code>logit(pi0)</code>. Default to <code>c(0,10)</code>.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_lor_prior">lor_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of corrected log odds ratio. Default to <code>c(0,2)</code>.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_chains">chains</code></td>
<td>
<p>number of Markov Chains. Default to 2.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_traceplot">traceplot</code></td>
<td>
<p>Logical, defaulting to <code>FALSE</code>. If <code>TRUE</code> it will draw the <a href="rstan.html#topic+traceplot">traceplot</a> corresponding to one or more Markov chains.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_inc_warmup">inc_warmup</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. <code>TRUE</code> or <code>FALSE</code>, indicating whether or not to include the warmup sample in the
traceplot; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_window">window</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. A vector of length 2. Iterations between <code>window[1]</code> and <code>window[2]</code> will be shown in the plot.
The default shows all iterations if <code>inc_warmup</code> is <code>TRUE</code> and all iterations from the sampling period only if <code>inc_warmup</code> is <code>FALSE</code>.
If <code>inc_warmup</code> is <code>FALSE</code> the iterations specified in <code>window</code> do not include iterations from the warmup period.
The default number of iterations is 2000 unless otherwise specified in the optional <code>iter</code> argument.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_refresh">refresh</code></td>
<td>
<p>an integer value used to control how often the progress of sampling is reported. By default, the progress indicator is turned off, thus refresh &lt;= 0.
If on, refresh = max(iter/10, 1) is generally recommended.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_seed">seed</code></td>
<td>
<p>the seed for random number generation. Default to 0. See <a href="rstan.html#topic+stan">stan</a> for more details.</p>
</td></tr>
<tr><td><code id="correctedOR_+3A_...">...</code></td>
<td>
<p>optional parameters passed to <a href="rstan.html#topic+stan">stan</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a stanfit object of this model, which inherits stanfit class methods. See <a href="rstan.html#topic+rstan">rstan</a> for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Case-control study data of Bipolar Disorder with rheumatoid arthritis (Farhi et al. 2016)
# Data from \url{https://www.sciencedirect.com/science/article/pii/S0165032715303864#bib13}\

mod &lt;- nlmeNDiff(bd_meta, lower = 0) # see \code{nlmeNDiff()} for detailed example.
prior_list &lt;- paramEst(mod)
correctedOR(a = 66, N1 = 11782, c = 243, N0 = 57973, prior_list = prior_list,
chains = 3, iter = 10000)
</code></pre>

<hr>
<h2 id='crudeOR'>Model without misclassification</h2><span id='topic+crudeOR'></span>

<h3>Description</h3>

<p>Generate a stanfit object corresponding to a posterior distribution of uncorrected odds ratio given no misclassification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crudeOR(
  a,
  N1,
  c,
  N0,
  logitpi0_prior = c(0, 10),
  lor_prior = c(0, 2),
  chains = 2,
  traceplot = FALSE,
  inc_warmup = FALSE,
  window = NULL,
  refresh = 0,
  seed = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crudeOR_+3A_a">a</code></td>
<td>
<p>number of exposed subjects in the case group.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_n1">N1</code></td>
<td>
<p>number of total subjects in the case group.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_c">c</code></td>
<td>
<p>number of exposed subjects in the control group.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_n0">N0</code></td>
<td>
<p>number of total subjects in the control group.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_logitpi0_prior">logitpi0_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of <code>logit(pi0)</code>. Default to <code>c(0,10)</code>.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_lor_prior">lor_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of corrected log odds ratio. Default to <code>c(0,2)</code>.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_chains">chains</code></td>
<td>
<p>number of Markov Chains. Default to 2.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_traceplot">traceplot</code></td>
<td>
<p>Logical, defaulting to <code>FALSE</code>. If <code>TRUE</code> it will draw the <a href="rstan.html#topic+traceplot">traceplot</a> corresponding to one or more Markov chains.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_inc_warmup">inc_warmup</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. <code>TRUE</code> or <code>FALSE</code>, indicating whether or not to include the warmup sample in the
traceplot; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_window">window</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. A vector of length 2. Iterations between <code>window[1]</code> and <code>window[2]</code> will be shown in the plot.
The default shows all iterations if <code>inc_warmup</code> is <code>TRUE</code> and all iterations from the sampling period only if <code>inc_warmup</code> is <code>FALSE</code>.
If <code>inc_warmup</code> is <code>FALSE</code> the iterations specified in <code>window</code> do not include iterations from the warmup period.
The default number of iterations is 2000 unless otherwise specified in the optional <code>iter</code> argument.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_refresh">refresh</code></td>
<td>
<p>an integer value used to control how often the progress of sampling is reported. By default, the progress indicator is turned off, thus refresh &lt;= 0.
If on, refresh = max(iter/10, 1) is generally recommended.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_seed">seed</code></td>
<td>
<p>the seed for random number generation. Default to 0. See <a href="rstan.html#topic+stan">stan</a> for more details.</p>
</td></tr>
<tr><td><code id="crudeOR_+3A_...">...</code></td>
<td>
<p>optional parameters passed to <a href="rstan.html#topic+stan">stan</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a stanfit object of this model, which inherits stanfit class methods. See <a href="rstan.html#topic+rstan">rstan</a> for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Case-control study data of Bipolar Disorder with rheumatoid arthritis (Farhi et al. 2016)
# Data from \url{https://www.sciencedirect.com/science/article/pii/S0165032715303864#bib13}

# 3 MCMC chains with 10000 iterations each
crudeOR(a = 66, N1 = 11782, c = 243, N0 = 57973, chains = 3, iter = 10000)
</code></pre>

<hr>
<h2 id='diffOR'>Model with differential misclassification</h2><span id='topic+diffOR'></span>

<h3>Description</h3>

<p>Generate a stanfit object corresponding to a posterior distribution of corrected odds ratio given a four-variate differential misclassification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diffOR(
  a,
  N1,
  c,
  N0,
  mu,
  s.lg.se0,
  s.lg.se1,
  s.lg.sp0,
  s.lg.sp1,
  corr.sesp0,
  corr.sesp1,
  corr.group = 0,
  z = NULL,
  logitpi0_prior = c(0, 10),
  lor_prior = c(0, 2),
  chains = 2,
  traceplot = FALSE,
  inc_warmup = FALSE,
  window = NULL,
  refresh = 0,
  seed = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diffOR_+3A_a">a</code></td>
<td>
<p>number of exposed subjects in the case group.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_n1">N1</code></td>
<td>
<p>number of total subjects in the case group.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_c">c</code></td>
<td>
<p>number of exposed subjects in the control group.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_n0">N0</code></td>
<td>
<p>number of total subjects in the control group.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_mu">mu</code></td>
<td>
<p>vector of length 4; multivariate normal distribution of <code class="reqn">z \sim (mu, varz)</code>, where each <code class="reqn">\mu</code> corresponds to the logit mean of <code class="reqn">Se_0</code>, <code class="reqn">Se_1</code>, <code class="reqn">Sp_0</code> and <code class="reqn">Sp_1</code> (0 for controls, 1 for cases group).</p>
</td></tr>
<tr><td><code id="diffOR_+3A_s.lg.se0">s.lg.se0</code></td>
<td>
<p>standard deviation of logit Se in the control group.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_s.lg.se1">s.lg.se1</code></td>
<td>
<p>standard deviation of logit Se in the case group.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_s.lg.sp0">s.lg.sp0</code></td>
<td>
<p>standard deviation of logit Sp in the control group.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_s.lg.sp1">s.lg.sp1</code></td>
<td>
<p>standard deviation of logit Sp in the case group.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_corr.sesp0">corr.sesp0</code></td>
<td>
<p>correlation between Se_0 and Sp_0.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_corr.sesp1">corr.sesp1</code></td>
<td>
<p>correlation between Se_1 and Sp_1.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_corr.group">corr.group</code></td>
<td>
<p>correlation between Se_0 and Se_1, Sp_0 and Sp_1. Default to 0.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_z">z</code></td>
<td>
<p>vector of length 4; used as an initial value for <code class="reqn">z \sim (mu, varz)</code>. Default to mu.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_logitpi0_prior">logitpi0_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of <code>logit(pi0)</code>. Default to <code>c(0,10)</code>.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_lor_prior">lor_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of corrected log odds ratio. Default to <code>c(0,2)</code>.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_chains">chains</code></td>
<td>
<p>number of Markov Chains. Default to 2.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_traceplot">traceplot</code></td>
<td>
<p>Logical, defaulting to <code>FALSE</code>. If <code>TRUE</code> it will draw the <a href="rstan.html#topic+traceplot">traceplot</a> corresponding to one or more Markov chains.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_inc_warmup">inc_warmup</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. <code>TRUE</code> or <code>FALSE</code>, indicating whether or not to include the warmup sample in the
traceplot; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_window">window</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. A vector of length 2. Iterations between <code>window[1]</code> and <code>window[2]</code> will be shown in the plot.
The default shows all iterations if <code>inc_warmup</code> is <code>TRUE</code> and all iterations from the sampling period only if <code>inc_warmup</code> is <code>FALSE</code>.
If <code>inc_warmup</code> is <code>FALSE</code> the iterations specified in <code>window</code> do not include iterations from the warmup period.
The default number of iterations is 2000 unless otherwise specified in the optional <code>iter</code> argument.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_refresh">refresh</code></td>
<td>
<p>an integer value used to control how often the progress of sampling is reported. By default, the progress indicator is turned off, thus refresh &lt;= 0.
If on, refresh = max(iter/10, 1) is generally recommended.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_seed">seed</code></td>
<td>
<p>the seed for random number generation. Default to 0. See <a href="rstan.html#topic+stan">stan</a> for more details.</p>
</td></tr>
<tr><td><code id="diffOR_+3A_...">...</code></td>
<td>
<p>optional parameters passed to <a href="rstan.html#topic+stan">stan</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a stanfit object of this model, which inherits stanfit class methods. See <a href="rstan.html#topic+rstan">rstan</a> for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Case-control study data of Bipolar Disorder with rheumatoid arthritis (Farhi et al. 2016)
# Data from \url{https://www.sciencedirect.com/science/article/pii/S0165032715303864#bib13}

diffOR(a = 66, N1 = 11782, c = 243, N0 = 57973, mu = c(1.069, 1.069, 1.126, 1.126),
  s.lg.se0 = 0.712, s.lg.se1 = 0.712, s.lg.sp0 = 0.893, s.lg.sp1 = 0.893, corr.sesp0 = -0.377,
  corr.sesp1 = -0.377, corr.group = 0, chains = 3, iter = 10000)
</code></pre>

<hr>
<h2 id='fixedCorrOR'>Model with nondifferential, correlated misclassification</h2><span id='topic+fixedCorrOR'></span>

<h3>Description</h3>

<p>Generate a stanfit object corresponding to a posterior distribution of corrected odds ratio given nondifferential misclassification that extends from the logit model but allows there to be a fixed correlation between sentivity and specificity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixedCorrOR(
  a,
  N1,
  c,
  N0,
  prior_list = NULL,
  m.lg.se = NULL,
  m.lg.sp = NULL,
  s.lg.se = NULL,
  s.lg.sp = NULL,
  lg.se = NULL,
  lg.sp = NULL,
  rho = NULL,
  logitpi0_prior = c(0, 10),
  lor_prior = c(0, 2),
  chains = 2,
  traceplot = FALSE,
  inc_warmup = FALSE,
  window = NULL,
  refresh = 0,
  seed = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixedCorrOR_+3A_a">a</code></td>
<td>
<p>number of exposed subjects in the case group.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_n1">N1</code></td>
<td>
<p>number of total subjects in the case group.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_c">c</code></td>
<td>
<p>number of exposed subjects in the control group.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_n0">N0</code></td>
<td>
<p>number of total subjects in the control group.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_prior_list">prior_list</code></td>
<td>
<p>list of priors. Can be replaced by the function call to <code>paramEst</code>, or a list of prior parameters
(<code>m.lg.se</code>, <code>s.lg.se</code>, <code>m.lg.sp</code>, <code>s.lg.sp</code>, <code>rho</code>).
If <code>prior_list</code> is specified, the values for the corresponding function parameters will be disregarded.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_m.lg.se">m.lg.se</code></td>
<td>
<p>normal distribution of logit Se with (mean = m.lg.se, sd = s.lg.se). Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_m.lg.sp">m.lg.sp</code></td>
<td>
<p>conditional normal distribution of logit Sp given Se with (m.lg.sp, s.lg.sp). Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_s.lg.se">s.lg.se</code></td>
<td>
<p>standard deviation of logit Se. Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_s.lg.sp">s.lg.sp</code></td>
<td>
<p>standard deviation of logit Sp. Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_lg.se">lg.se</code></td>
<td>
<p>used as an initial value for logit Se. Default to <code>m.lg.se</code></p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_lg.sp">lg.sp</code></td>
<td>
<p>used as an initial value for logit Sp. Default to <code>m.lg.sp</code></p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_rho">rho</code></td>
<td>
<p>correlation between Se and Sp. Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_logitpi0_prior">logitpi0_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of <code>logit(pi0)</code>. Default to <code>c(0,10)</code>.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_lor_prior">lor_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of corrected log odds ratio. Default to <code>c(0,2)</code>.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_chains">chains</code></td>
<td>
<p>number of Markov Chains. Default to 2.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_traceplot">traceplot</code></td>
<td>
<p>Logical, defaulting to <code>FALSE</code>. If <code>TRUE</code> it will draw the <a href="rstan.html#topic+traceplot">traceplot</a> corresponding to one or more Markov chains.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_inc_warmup">inc_warmup</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. <code>TRUE</code> or <code>FALSE</code>, indicating whether or not to include the warmup sample in the
traceplot; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_window">window</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. A vector of length 2. Iterations between <code>window[1]</code> and <code>window[2]</code> will be shown in the plot.
The default shows all iterations if <code>inc_warmup</code> is <code>TRUE</code> and all iterations from the sampling period only if <code>inc_warmup</code> is <code>FALSE</code>.
If <code>inc_warmup</code> is <code>FALSE</code> the iterations specified in <code>window</code> do not include iterations from the warmup period.
The default number of iterations is 2000 unless otherwise specified in the optional <code>iter</code> argument.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_refresh">refresh</code></td>
<td>
<p>an integer value used to control how often the progress of sampling is reported. By default, the progress indicator is turned off, thus refresh &lt;= 0.
If on, refresh = max(iter/10, 1) is generally recommended.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_seed">seed</code></td>
<td>
<p>the seed for random number generation. Default to 0. See <a href="rstan.html#topic+stan">stan</a> for more details.</p>
</td></tr>
<tr><td><code id="fixedCorrOR_+3A_...">...</code></td>
<td>
<p>optional parameters passed to <a href="rstan.html#topic+stan">stan</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a stanfit object of this model, which inherits stanfit class methods. See <a href="rstan.html#topic+rstan">rstan</a> for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Case-control study data of Bipolar Disorder with rheumatoid arthritis (Farhi et al. 2016)
# Data from \url{https://www.sciencedirect.com/science/article/pii/S0165032715303864#bib13}

mod &lt;- nlmeNDiff(bd_meta, lower = 0) # see \code{nlmeNDiff()} for detailed example.
prior_list &lt;- paramEst(mod)
fixedCorrOR(a = 66, N1 = 11782, c = 243, N0 = 57973, prior_list = prior_list,
chains = 3, iter = 10000)
</code></pre>

<hr>
<h2 id='logitOR'>Model with nondifferential, logit normal-distributed misclassification</h2><span id='topic+logitOR'></span>

<h3>Description</h3>

<p>Generate a stanfit object corresponding to a posterior distribution of corrected odds ratio given nondifferential misclassification under a logit-transformed scaled bivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logitOR(
  a,
  N1,
  c,
  N0,
  prior_list = NULL,
  m.lg.se = NULL,
  m.lg.sp = NULL,
  s.lg.se = NULL,
  s.lg.sp = NULL,
  lg.se = NULL,
  lg.sp = NULL,
  logitpi0_prior = c(0, 10),
  lor_prior = c(0, 2),
  chains = 2,
  traceplot = FALSE,
  inc_warmup = FALSE,
  window = NULL,
  refresh = 0,
  seed = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logitOR_+3A_a">a</code></td>
<td>
<p>number of exposed subjects in the case group.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_n1">N1</code></td>
<td>
<p>number of total subjects in the case group.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_c">c</code></td>
<td>
<p>number of exposed subjects in the control group.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_n0">N0</code></td>
<td>
<p>number of total subjects in the control group.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_prior_list">prior_list</code></td>
<td>
<p>list of priors. Can be replaced by the function call to <code>paramEst</code>, or a list of prior parameters
(<code>m.lg.se</code>, <code>s.lg.se</code>, <code>m.lg.sp</code>, <code>s.lg.sp</code>).
If <code>prior_list</code> is specified, the values for the corresponding function parameters will be disregarded.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_m.lg.se">m.lg.se</code></td>
<td>
<p>normal distribution of logit Se with (mean = m.lg.se, sd = s.lg.se). Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_m.lg.sp">m.lg.sp</code></td>
<td>
<p>normal distribution of logit Sp with (m.lg.sp, s.lg.sp). Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_s.lg.se">s.lg.se</code></td>
<td>
<p>standard deviation of logit Se. Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_s.lg.sp">s.lg.sp</code></td>
<td>
<p>standard deviation of logit Sp. Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_lg.se">lg.se</code></td>
<td>
<p>used as an initial value for logit Se. Default to <code>m.lg.se</code></p>
</td></tr>
<tr><td><code id="logitOR_+3A_lg.sp">lg.sp</code></td>
<td>
<p>used as an initial value for logit Sp. Default to <code>m.lg.sp</code></p>
</td></tr>
<tr><td><code id="logitOR_+3A_logitpi0_prior">logitpi0_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of <code>logit(pi0)</code>. Default to <code>c(0,10)</code>.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_lor_prior">lor_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of corrected log odds ratio. Default to <code>c(0,2)</code>.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_chains">chains</code></td>
<td>
<p>number of Markov Chains. Default to 2.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_traceplot">traceplot</code></td>
<td>
<p>Logical, defaulting to <code>FALSE</code>. If <code>TRUE</code> it will draw the <a href="rstan.html#topic+traceplot">traceplot</a> corresponding to one or more Markov chains.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_inc_warmup">inc_warmup</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. <code>TRUE</code> or <code>FALSE</code>, indicating whether or not to include the warmup sample in the
traceplot; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_window">window</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. A vector of length 2. Iterations between <code>window[1]</code> and <code>window[2]</code> will be shown in the plot.
The default shows all iterations if <code>inc_warmup</code> is <code>TRUE</code> and all iterations from the sampling period only if <code>inc_warmup</code> is <code>FALSE</code>.
If <code>inc_warmup</code> is <code>FALSE</code> the iterations specified in <code>window</code> do not include iterations from the warmup period.
The default number of iterations is 2000 unless otherwise specified in the optional <code>iter</code> argument.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_refresh">refresh</code></td>
<td>
<p>an integer value used to control how often the progress of sampling is reported. By default, the progress indicator is turned off, thus refresh &lt;= 0.
If on, refresh = max(iter/10, 1) is generally recommended.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_seed">seed</code></td>
<td>
<p>the seed for random number generation. Default to 0. See <a href="rstan.html#topic+stan">stan</a> for more details.</p>
</td></tr>
<tr><td><code id="logitOR_+3A_...">...</code></td>
<td>
<p>optional parameters passed to <a href="rstan.html#topic+stan">stan</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a stanfit object of this model, which inherits stanfit class methods. See <a href="rstan.html#topic+rstan">rstan</a> for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Case-control study data of Bipolar Disorder with rheumatoid arthritis (Farhi et al. 2016)
# Data from \url{https://www.sciencedirect.com/science/article/pii/S0165032715303864#bib13}

mod &lt;- nlmeNDiff(bd_meta, lower = 0) # see \code{nlmeNDiff()} for detailed example.
prior_list &lt;- paramEst(mod)
logitOR(a = 66, N1 = 11782, c = 243, N0 = 57973, prior_list = prior_list,
chains = 3, iter = 10000)
</code></pre>

<hr>
<h2 id='nlmeNDiff'>Non-differential Generalized Linear Mixed Effects Model</h2><span id='topic+nlmeNDiff'></span>

<h3>Description</h3>

<p>Fit a bivariate generalized linear mixed-effects model (GLMM) for non-differential sensitivity and specificity using the <code>glmer</code> function in <code>lme4</code>.
Lower and upper bounds for Se and Sp can be specified according to the assumptions of the study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlmeNDiff(data, lower = 0.5, upper = 1, id = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlmeNDiff_+3A_data">data</code></td>
<td>
<p>a data frame containing the 2 by 2 data of the diagnostics table of exposure status for every study in a meta-analysis.
It contains at least 4 columns in the data named as following: <code>n11</code> indicates the true positives, <code>n01</code> the false positives,
<code>n00</code> the true negatives and <code>n10</code> the false negatives. Each column is a vector of same length,
which is the number of meta-analysis study results used in the model.</p>
</td></tr>
<tr><td><code id="nlmeNDiff_+3A_lower">lower</code></td>
<td>
<p>an optional argument specifying the lower bound assumption of Se and Sp. Default to 0.5 (or the lowest Se/Sp of all studies, whichever is lower), which provides the mild assumption that Se and Sp are better than chance.</p>
</td></tr>
<tr><td><code id="nlmeNDiff_+3A_upper">upper</code></td>
<td>
<p>an optional argument specifying the upper bound assumption of Se and Sp. Default to 1.</p>
</td></tr>
<tr><td><code id="nlmeNDiff_+3A_id">id</code></td>
<td>
<p>a TRUE of FALSE argument indicating if the supplied data has a <code>sid</code> column that gives same studies
the same subject ID. Default to FALSE, which assumes that all studies have different IDs.</p>
</td></tr>
<tr><td><code id="nlmeNDiff_+3A_...">...</code></td>
<td>
<p>optional parameters passed to <a href="lme4.html#topic+glmer">glmer</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns an object of class <a href="lme4.html#topic+merMod">merMod</a>.
Besides generic class methods, <code>paramEst()</code> is implemented in <code>BayesSenMC</code> to get the parameter estimates used in the Bayesian misclassification model functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bd_meta)

mod &lt;- nlmeNDiff(bd_meta, lower = 0)
</code></pre>

<hr>
<h2 id='paramEst'>Parameter estimates of the GLMM model</h2><span id='topic+paramEst'></span>

<h3>Description</h3>

<p>Get parameter estimates of the GLMM model to plug into modeling functions in <code>BayesSenMC</code> for Bayesian inference of adjusted odds ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paramEst(model, lower = 0.5, upper = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paramEst_+3A_model">model</code></td>
<td>
<p>a GLMM model built with the <code>nlmeNDiff()</code> function.</p>
</td></tr>
<tr><td><code id="paramEst_+3A_lower">lower</code></td>
<td>
<p>an optional argument matching the lower bound assumption of Se and Sp of the input <code>model</code>. Default to 0.5 as in <code>nlmeNDiff()</code>.</p>
</td></tr>
<tr><td><code id="paramEst_+3A_upper">upper</code></td>
<td>
<p>an optional argument matching the upper bound assumption of Se and Sp. Default to 1 as in <code>nlmeNDiff</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a list of parameter estimates which can be input into the Bayesian model functions in
<code>BayesSenMC</code>. <code>(m.lg.se, s.lg.se)</code> and <code>(m.lg.sp, s.lg.sp)</code> are the logit prior distributions for Se and Sp.
<code>se</code> and <code>sp</code> are the corresponding mean values given the logit prior means. <code>rho</code> is the correlation estimate between Se and
Sp. <code>m.fisher</code> is the Fisher's mean of the correlation assume a Fisher's distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bd_meta)

mod &lt;- nlmeNDiff(bd_meta, lower = 0) # see \code{nlmeNDiff()} for detailed example.
prior_list &lt;- paramEst(mod)
</code></pre>

<hr>
<h2 id='plotOR'>Plot Model</h2><span id='topic+plotOR'></span>

<h3>Description</h3>

<p>Plot the posterior distribution of adjusted odds ratio given the stanfit object. It also plots the density lines of crude/uncorrected odds ratio and corrected odds ratio with constant misclassification, assuming log-normality is true. If both Se and Sp are set to 1 (i.e., no misclassification), then only the density line of crude OR will be plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotOR(
  model,
  a,
  N1,
  c,
  N0,
  se = 1,
  sp = 1,
  x.min = 0,
  x.max = NULL,
  y.max = NULL,
  binwidth = 0.25,
  fill = "gray",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotOR_+3A_model">model</code></td>
<td>
<p>A stanfit object.</p>
</td></tr>
<tr><td><code id="plotOR_+3A_a">a</code></td>
<td>
<p>number of exposed subjects in the case group. Along with N1, c, N0, se and sp, they are used to plot probability density with no misclassification and constant misclassification as a comparison.</p>
</td></tr>
<tr><td><code id="plotOR_+3A_n1">N1</code></td>
<td>
<p>number of total subjects in the case group.</p>
</td></tr>
<tr><td><code id="plotOR_+3A_c">c</code></td>
<td>
<p>number of exposed subjects in the control group.</p>
</td></tr>
<tr><td><code id="plotOR_+3A_n0">N0</code></td>
<td>
<p>number of total subjects in the control group.</p>
</td></tr>
<tr><td><code id="plotOR_+3A_se">se</code></td>
<td>
<p>sensitivity. Default to 1. If no other values are specified for either se or sp, then only the density curve of corrected model will be drawn.</p>
</td></tr>
<tr><td><code id="plotOR_+3A_sp">sp</code></td>
<td>
<p>specificity. Default to 1.</p>
</td></tr>
<tr><td><code id="plotOR_+3A_x.min">x.min</code></td>
<td>
<p>shows only samples with corrected odds ratio larger or equal to <code>x.min</code>. Default to 0.</p>
</td></tr>
<tr><td><code id="plotOR_+3A_x.max">x.max</code></td>
<td>
<p>shows only samples with corrected odds ratio smaller or equal to <code>x.max</code>. Default to the largest OR in the posterior samples.</p>
</td></tr>
<tr><td><code id="plotOR_+3A_y.max">y.max</code></td>
<td>
<p>shows only samples or density line within the range of (0, <code>y.max</code>).</p>
</td></tr>
<tr><td><code id="plotOR_+3A_binwidth">binwidth</code></td>
<td>
<p>default to <code>0.25</code></p>
</td></tr>
<tr><td><code id="plotOR_+3A_fill">fill</code></td>
<td>
<p>default to <code>"gray"</code></p>
</td></tr>
<tr><td><code id="plotOR_+3A_...">...</code></td>
<td>
<p>optional additional arguments passed to <code>geom_histogram</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a <a href="ggplot2.html#topic+ggplot">ggplot</a> that can be further
customized using the ggplot2 package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Case-control study data of Bipolar Disorder with rheumatoid arthritis (Farhi et al. 2016)
# Data from \url{https://www.sciencedirect.com/science/article/pii/S0165032715303864#bib13}

library(ggplot2)
my.mod &lt;- randCorrOR(a = 66, N1 = 11782, c = 243, N0 = 57973, m.lg.se = 1.069,
m.lg.sp = 1.126, s.lg.se = 0.893, s.lg.sp = 0.712, m.z = -0.399, s.z = 0.139,
seed = 0)

my.plot &lt;- plotOR(my.mod, a = 66, N1 = 11782, c = 243, N0 = 57973, se = 0.744,
sp = 0.755, x.max = 3, y.max = 5, binwidth = 0.1) + ggtitle("Model with random correlation")

# the user can also directly extract the data from a stanfit object using the following
my.data &lt;- as.data.frame(my.mod)
</code></pre>

<hr>
<h2 id='randCorrOR'>Model with nondifferential, randomly correlated misclassification</h2><span id='topic+randCorrOR'></span>

<h3>Description</h3>

<p>Generate a stanfit object corresponding to a posterior distribution of corrected odds ratio given nondifferential misclassification that extends from the logit model but allows a random correlation between Sensitivity and Specificity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randCorrOR(
  a,
  N1,
  c,
  N0,
  prior_list = NULL,
  m.lg.se = NULL,
  m.lg.sp = NULL,
  s.lg.se = NULL,
  s.lg.sp = NULL,
  lg.se = NULL,
  lg.sp = NULL,
  m.z = NULL,
  s.z = NULL,
  z = NULL,
  logitpi0_prior = c(0, 10),
  lor_prior = c(0, 2),
  chains = 2,
  traceplot = FALSE,
  inc_warmup = FALSE,
  window = NULL,
  refresh = 0,
  seed = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randCorrOR_+3A_a">a</code></td>
<td>
<p>number of exposed subjects in the case group.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_n1">N1</code></td>
<td>
<p>number of total subjects in the case group.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_c">c</code></td>
<td>
<p>number of exposed subjects in the control group.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_n0">N0</code></td>
<td>
<p>number of total subjects in the control group.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_prior_list">prior_list</code></td>
<td>
<p>list of priors. Can be replaced by the function call to <code>paramEst</code>, or a list of prior parameters
(<code>m.lg.se</code>, <code>s.lg.se</code>, <code>m.lg.sp</code>, <code>s.lg.sp</code>, <code>m.z</code>, <code>s.z</code>).
If <code>prior_list</code> is specified, the values for the corresponding function parameters will be disregarded.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_m.lg.se">m.lg.se</code></td>
<td>
<p>normal distribution of logit Se with (mean = m.lg.se, sd = s.lg.se). Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_m.lg.sp">m.lg.sp</code></td>
<td>
<p>conditional normal distribution of logit Sp given Se with (m.lg.sp, s.lg.sp). Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_s.lg.se">s.lg.se</code></td>
<td>
<p>standard deviation of logit Se. Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_s.lg.sp">s.lg.sp</code></td>
<td>
<p>standard deviation of logit Sp. Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_lg.se">lg.se</code></td>
<td>
<p>used as an initial value for logit Se. Default to m.lg.se. Do not have to specify this if <code>prior_list</code> is given - it will be disregarded. Default to <code>m.lg.se</code></p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_lg.sp">lg.sp</code></td>
<td>
<p>used as an initial value for logit Sp. Default to m.lg.sp. Do not have to specify this if <code>prior_list</code> is given - it will be disregarded. Default to <code>m.lg.sp</code></p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_m.z">m.z</code></td>
<td>
<p>normal distribution of Z with (mean = m.z, sd = s.z). Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_s.z">s.z</code></td>
<td>
<p>normal distribution of Z with (mean = m.z, sd = s.z). Do not have to specify this if <code>prior_list</code> is given - it will be disregarded.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_z">z</code></td>
<td>
<p>used as an initial value of Fisher's Z transformed of rho, where correlation rho = (exp(2<em>z)-1)/(1+exp(2</em>z))). Do not have to specify this if <code>prior_list</code> is given - it will be disregarded. Default to <code>m.z</code></p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_logitpi0_prior">logitpi0_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of <code>logit(pi0)</code>. Default to <code>c(0,10)</code>.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_lor_prior">lor_prior</code></td>
<td>
<p>mean and sd of the prior normal distribution of corrected log odds ratio. Default to <code>c(0,2)</code>.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_chains">chains</code></td>
<td>
<p>number of Markov Chains. Default to 2.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_traceplot">traceplot</code></td>
<td>
<p>Logical, defaulting to <code>FALSE</code>. If <code>TRUE</code> it will draw the <a href="rstan.html#topic+traceplot">traceplot</a> corresponding to one or more Markov chains.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_inc_warmup">inc_warmup</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. <code>TRUE</code> or <code>FALSE</code>, indicating whether or not to include the warmup sample in the
traceplot; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_window">window</code></td>
<td>
<p>Only evaluated when <code>traceplot = TRUE</code>. A vector of length 2. Iterations between <code>window[1]</code> and <code>window[2]</code> will be shown in the plot.
The default shows all iterations if <code>inc_warmup</code> is <code>TRUE</code> and all iterations from the sampling period only if <code>inc_warmup</code> is <code>FALSE</code>.
If <code>inc_warmup</code> is <code>FALSE</code> the iterations specified in <code>window</code> do not include iterations from the warmup period.
The default number of iterations is 2000 unless otherwise specified in the optional <code>iter</code> argument.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_refresh">refresh</code></td>
<td>
<p>an integer value used to control how often the progress of sampling is reported. By default, the progress indicator is turned off, thus refresh &lt;= 0.
If on, refresh = max(iter/10, 1) is generally recommended.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_seed">seed</code></td>
<td>
<p>the seed for random number generation. Default to 0. See <a href="rstan.html#topic+stan">stan</a> for more details.</p>
</td></tr>
<tr><td><code id="randCorrOR_+3A_...">...</code></td>
<td>
<p>optional parameters passed to <a href="rstan.html#topic+stan">stan</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a stanfit object of this model, which inherits stanfit class methods. See <a href="rstan.html#topic+rstan">rstan</a> for more details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Case-control study data of Bipolar Disorder with rheumatoid arthritis (Farhi et al. 2016)
# Data from \url{https://www.sciencedirect.com/science/article/pii/S0165032715303864#bib13}

mod &lt;- nlmeNDiff(bd_meta, lower = 0) # see \code{nlmeNDiff()} for detailed example.
prior_list &lt;- paramEst(mod)
randCorrOR(a = 66, N1 = 11782, c = 243, N0 = 57973, prior_list = prior_list,
chains = 3, iter = 10000)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
