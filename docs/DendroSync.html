<!DOCTYPE html><html><head><title>Help for package DendroSync</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DendroSync}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bet.aSE'><p>Between-group synchrony for a homoscedastic unstructured model</p></a></li>
<li><a href='#bet.het.aSE'><p>Between-group synchrony for a heteroscedastic unstructured model</p></a></li>
<li><a href='#conifersIP'><p>Iberian Peninsula tree-ring width dataset</p></a></li>
<li><a href='#csbet.aSE'><p>Between-group synchrony for homoscedastic compound symmetry model</p></a></li>
<li><a href='#csbet.het.aSE'><p>Between-group synchrony for heteroscedastic compound symmetry model</p></a></li>
<li><a href='#cswi.aSE'><p>Within-group synchrony for homoscedastic compound symmetry model</p></a></li>
<li><a href='#cswi.het.aSE'><p>Within-group synchrony for heteroscedastic compound symmetry mixed models</p></a></li>
<li><a href='#dendro.varcov'><p>Fit variance-covariance mixed models on tree-ring chronologies</p></a></li>
<li><a href='#gen.aSE'><p>Within-group synchrony for homoscedastic models</p></a></li>
<li><a href='#gen.het.aSE'><p>Within-group synchrony for heteroscedastic mixed models</p></a></li>
<li><a href='#het.var'><p>Variances per varGroup stratum for heteroscedastic models</p></a></li>
<li><a href='#mod.table'><p>Function to calculate goodness-of-fit statistics for variance-covariance models</p></a></li>
<li><a href='#sync'><p>Calculate within- and between-group synchrony</p></a></li>
<li><a href='#sync.plot'><p>Plot within- and between-group synchrony</p></a></li>
<li><a href='#sync.trend'><p>Calculate temporal trends of synchrony</p></a></li>
<li><a href='#sync.trend.plot'><p>Plot temporal trends of synchrony</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Set of Tools for Calculating Spatial Synchrony Between
Tree-Ring Chronologies</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-26</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josu G. Alday &lt;josucham@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for the calculation and plotting of synchrony in 
      tree growth from tree-ring width chronologies (TRW index). It combines
      variance-covariance (VCOV) mixed modelling with functions that quantify 
      the degree to which the TRW chronologies contain a common temporal 
      signal. It also implements temporal trends in spatial synchrony using a 
      moving window. These methods can also be used with other kind of ecological
      variables that have temporal autocorrelation corrected.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.2), nlme, ggplot2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://bitbucket.org/josucham/dendrosync/src/issues/">https://bitbucket.org/josucham/dendrosync/src/issues/</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, gridExtra, methods</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Josu G. Alday (https://orcid.org/0000-0001-7510-8655),
        Tatiana A. Shestakova (https://orcid.org/0000-0002-5605-0299), 
        Victor Resco de Dios (https://orcid.org/0000-0002-5721-1656), 
        Jordi Voltas (https://orcid.org/0000-0003-4051-1158)</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-26 09:18:09 UTC; Josu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-26 09:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bet.aSE'>Between-group synchrony for a homoscedastic unstructured model</h2><span id='topic+bet.aSE'></span>

<h3>Description</h3>

<p>The function calculates the between-group synchrony (a^) and standard error (SE) for a homoscedastic unstructured model or full model (mUN).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bet.aSE(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bet.aSE_+3A_model">model</code></td>
<td>
<p>a class &quot;<code>lme</code>&quot; unstructured model (<code>mUN</code>) produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code> with <code>homoscedastic</code> equals <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates between-group synchrony for a homoscedastic unstructured model (mUN).
</p>


<h3>Value</h3>

<p>The function returns a <code>matrix</code> containing between-group synchrony and SE for each combination of <code>varGroup</code> levels. This function is used internally in <code><a href="#topic+sync">sync</a></code>.
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sync">sync</a></code> for a clear description of synchrony evaluation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate between-group synchrony and SE
 # for an unstructured homocedastic model of conifersIP data:
 data(conifersIP)
 
 #Fit the homoscedastic set of varcov models (mBE, mNE, mCS, mUN)
 # using taxonomic grouping criteria (ie. Species)
 ModHm &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conifersIP, homoscedastic = TRUE)
 summary(ModHm)
   
 #Obtain the unstructured model between-group synchrony and SE
 # for each varGroup stratum.
 bet.aSE(ModHm$mUN)#Unstructure
   
</code></pre>

<hr>
<h2 id='bet.het.aSE'>Between-group synchrony for a heteroscedastic unstructured model</h2><span id='topic+bet.het.aSE'></span>

<h3>Description</h3>

<p>The function calculates the between-group synchrony (a^) and standard error (SE) for a heteroscedastic unstructured model (mHeUN).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bet.het.aSE(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bet.het.aSE_+3A_model">model</code></td>
<td>
<p>a class &quot;<code>lme</code>&quot; unstructured model (<code>mHeUN</code>) produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code> with <code>homoscedastic</code> equals <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates between-group synchrony for a heteroscedastic unstructured model (mHeUN).
</p>


<h3>Value</h3>

<p>The function returns a <code>matrix</code> containing between-group synchrony and SE for each combination of <code>varGroup</code> levels. This function is used internally in <code><a href="#topic+sync">sync</a></code>.
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sync">sync</a></code> for a clear description of synchrony evaluation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate between-group synchrony and SE 
 ##for a heteroscedastic unstructured model for conifersIP data:
 data(conifersIP)
 
 #Fit the heteroscedastic set of varcov models (mBE, mHeNE, mHeCS, mHeUN)
 # using taxonomic grouping criteria (ie. Species)
 ModHt &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conifersIP, homoscedastic = FALSE)
 
 #between-group synchrony and SE for each varGroup stratum combination
 # in heteroscedastic unstructured models.
 bet.het.aSE(ModHt$mHeUN)#Unstructured model
 
</code></pre>

<hr>
<h2 id='conifersIP'>Iberian Peninsula tree-ring width dataset</h2><span id='topic+conifersIP'></span>

<h3>Description</h3>

<p>This dataset presents tree-ring width chronologies of residual indices published in Shestakova et al. (2016). The dataset contains 30 tree-ring width chronologies of conifer species from the Iberian Peninsula for the period 1950-1999. Tree species are represented by <em>Abies alba</em> Mill., <em>Pinus nigra</em> subsp. <em>salzmannii</em> (Dunal) Franco and <em>Pinus sylvestris</em> L. The sampling sites are distributed across three subregions (<em>north</em>, <em>centre</em> and <em>south</em>) of the Iberian Peninsula. Site chronologies are obtained by cross-dating tree-ring width series and posterior detrending and autocorrelation removal with the Friedman supersmoother spline and autoregressive modeling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(conifersIP)
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 30 tree-ring chronologies of residual indices for the period 1950-1999. The dataset includes three species (<em>Abies alba</em>, <em>Pinus nigra</em>, <em>Pinus sylvestris</em>) that are distributed across three regions (<em>north</em>, <em>centre</em> and <em>south</em>) in accordance with the latitudinal position of each sampling site.
<code>conifersIP</code> has following variables:
</p>

<ul>
<li><p>Year: year of tree-ring formation (1950-1999)
</p>
</li>
<li><p>Region: geographical region for Iberian Peninsula: north, centre, south
</p>
</li>
<li><p>Species: tree species: <em>Abies alba</em>, <em>Pinus nigra</em>, <em>Pinus sylvestris</em>
</p>
</li>
<li><p>Code: specific name of tree-ring width chronology
</p>
</li>
<li><p>TRW: residual indices of tree-ring width chronologies</p>
</li></ul>



<h3>References</h3>

<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>

<hr>
<h2 id='csbet.aSE'>Between-group synchrony for homoscedastic compound symmetry model</h2><span id='topic+csbet.aSE'></span>

<h3>Description</h3>

<p>The function calculates the between-group synchrony (a^) and standard error (SE) for homoscedastic compound symmetry model (mCS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csbet.aSE(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="csbet.aSE_+3A_model">model</code></td>
<td>
<p>a class &quot;<code>lme</code>&quot; compound symmetry model (<code>mCS</code>) produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code> with <code>homoscedastic</code> equals <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates between-group synchrony for homoscedastic compound symmetry model (mCS).
</p>


<h3>Value</h3>

<p>The function returns a <code>matrix</code> containing between-group synchrony and SE for each combination of <code>varGroup</code> levels. This function is used internally in <code><a href="#topic+sync">sync</a></code>.
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sync">sync</a></code> for a clear description of synchrony evaluation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate between-group homoscedastic synchrony and SE
 # for compound symmetry homocedastic model of conifersIP data:
 data(conifersIP)
 
 #Fit the homoscedastic set of varcov models (mBE, mNE, mCS, mUN)
 # using taxonomic grouping criteria (ie. Species)
 ModHm &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conifersIP, homoscedastic = TRUE)
 summary(ModHm)
   
 #Obtain the compound symmetry model between-group synchrony and SE
 # for each varGroup stratum.
 csbet.aSE (ModHm$mCS)#compound symmetry
   
</code></pre>

<hr>
<h2 id='csbet.het.aSE'>Between-group synchrony for heteroscedastic compound symmetry model</h2><span id='topic+csbet.het.aSE'></span>

<h3>Description</h3>

<p>The function calculates the between-group synchrony (a^) and standard error (SE) for heteroscedastic compound symmetry model (mHeCS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csbet.het.aSE(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="csbet.het.aSE_+3A_model">model</code></td>
<td>
<p>a class &quot;<code>lme</code>&quot; compound symmetry model (<code>mHeCS</code>) produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code> with <code>homoscedastic</code> equals <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates between-group synchrony for heteroscedastic compound symmetry models (mHeCS).
</p>


<h3>Value</h3>

<p>The function returns a <code>matrix</code> containing between-group synchrony and SE for each combination of <code>varGroup</code> levels. This function is used internally in <code><a href="#topic+sync">sync</a></code>.
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sync">sync</a></code> for a clear description of synchrony evaluation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate between-group synchrony and SE 
 ##for heteroscedastic compound symmetry model for conifersIP data:
 data(conifersIP)
 
 #Fit the heteroscedastic set of varcov models (mBE, mHeNE, mHeCS, mHeUN)
 # using taxonomic grouping criteria (ie. Species)
 ModHt &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conifersIP, homoscedastic = FALSE)
 
 #between-group synchrony and SE for each varGroup stratum combination
 # in heteroscedastic compound symmetry models.
 csbet.het.aSE(ModHt$mHeCS)
 
</code></pre>

<hr>
<h2 id='cswi.aSE'>Within-group synchrony for homoscedastic compound symmetry model</h2><span id='topic+cswi.aSE'></span>

<h3>Description</h3>

<p>The function calculates the within-group synchrony (a^) and standard error (SE) for homoscedastic compound symmetry models (mCS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cswi.aSE(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cswi.aSE_+3A_model">model</code></td>
<td>
<p>a class &quot;<code>lme</code>&quot; compound symmetry model (<code>mCS</code>) produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code> with <code>homoscedastic</code> equals <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates within-group synchrony for homoscedastic compound symmetry model (mCS).
</p>


<h3>Value</h3>

<p>The function returns a <code>matrix</code> containing within-group synchrony and SE for each combinations of <code>varGroup</code> levels. This function is used internally in <code><a href="#topic+sync">sync</a></code>.
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sync">sync</a></code> for a clear description of synchrony evaluation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate within-group homoscedastic synchrony and SE
 # for compound symmetry homocedastic model of conifersIP data:
 data(conifersIP)
 
 #Fit the homoscedastic set of varcov models (mBE, mNE, mCS, mUN)
 # using taxonomic grouping criteria (ie. Species)
 ModHm &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conifersIP, homoscedastic = TRUE)
 summary(ModHm)
   
 #Obtain the compound symmetry model within-group synchrony and SE
 # for each varGroup stratum.
 cswi.aSE(ModHm$mCS)#compound symmetry
   
</code></pre>

<hr>
<h2 id='cswi.het.aSE'>Within-group synchrony for heteroscedastic compound symmetry mixed models</h2><span id='topic+cswi.het.aSE'></span>

<h3>Description</h3>

<p>The function calculates for each <code>varGroup</code> stratum the synchrony (a^) and standard error (SE) for heteroscedastic compound symmetry models (mHeCS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cswi.het.aSE (model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cswi.het.aSE_+3A_model">model</code></td>
<td>
<p>a class &quot;<code>lme</code>&quot; model produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code> with <code>homoscedastic</code> equals <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the within-group synchrony values for each <code>varGroup</code> stratum based on the metodology described in Shestakova et al. (2014) and Shestakova et al. (2016). Note that this function is designed to work only in heteroscedastic compound symmetry mixed models (i.e. mHeCS).
</p>


<h3>Value</h3>

<p>The function returns a <code>matrix</code> containing  within-group synchrony and SE for each level of <code>varGroup</code>. This function is used internally in <code><a href="#topic+sync">sync</a></code>.
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sync">sync</a></code> for a clear description of synchrony evaluation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate within-group heterosdecastic synchrony and SE for conifersIP data:
 data(conifersIP)
 
 #Fit the heteroscedastic set of varcov models (mBE, mHeNE, mHeCS, mHeUN)
 # using taxonomic grouping criteria (i.e. Species)
 ModHt &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conifersIP, homoscedastic = FALSE)
 summary(ModHt)
   
 #Obtain the heteroscedastic compound symmetry 
 #within-group synchrony and SE for each varGroup stratum.
 cswi.het.aSE(ModHt$mHeCS)
 
 
</code></pre>

<hr>
<h2 id='dendro.varcov'>Fit variance-covariance mixed models on tree-ring chronologies</h2><span id='topic+dendro.varcov'></span>

<h3>Description</h3>

<p>The function calculates variance-covariance (VCOV) mixed models from a <code>data.frame</code> with tree-ring width index and years for each chronology following the methodology described in Shestakova et al. (2014). 
The mixed models relate tree-ring width (<code>Y</code>) against specific names of tree-ring width chronologies (<code>A</code>), using years and grouping variable as random factors to characterize the strength of the common signal across the grouping variable.
First, a linear mixed-effect model with null positive-definite matrix structure or broad evaluation is fitted and the subsequent models are consequently derived from it using the function <code>update</code>.
When a <code>data.frame</code> with tree-ring width index has NAs the models are fitted with <code><a href="stats.html#topic+na.action">na.action</a></code> = <code>na.omit</code>. Simultaneously, <code><a href="stats.html#topic+complete.cases">complete.cases</a></code> is applied to guarantee that rows have no missing values across the entire <code>data.frame</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dendro.varcov(formula, varTime = "", varGroup = "", data, 
                      homoscedastic = TRUE, null.mod = FALSE, all.mod = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dendro.varcov_+3A_formula">formula</code></td>
<td>
<p>a model <code>formula</code> such as <code>Y ~ A</code>, where <code>Y</code> is usually tree-ring width and <code>A</code> will be a factor variable such as the specific names of tree-ring width chronologies (<code><a href="#topic+conifersIP">conifersIP</a></code>) or <code>~1</code> for a null model.</p>
</td></tr>
<tr><td><code id="dendro.varcov_+3A_vartime">varTime</code></td>
<td>
<p>a <code>character</code> specifying the time variable to consider in calculating synchrony estimates. Models with varTime variable with less than 10 different time-points produce unreliable results.</p>
</td></tr>
<tr><td><code id="dendro.varcov_+3A_vargroup">varGroup</code></td>
<td>
<p>a <code>character</code> grouping variable. In dendrochronological studies different grouping strategies can be used. We used here two strategies following taxonomic (i.e. species) or geographic (i.e. region) criteria.</p>
</td></tr>
<tr><td><code id="dendro.varcov_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> with tree-ring chronologies, years and grouping variables as columns.</p>
</td></tr>
<tr><td><code id="dendro.varcov_+3A_homoscedastic">homoscedastic</code></td>
<td>
<p><code>logical</code> if <code>TRUE</code> models do not included an optional <code><a href="nlme.html#topic+varFunc">varFunc</a></code> object. If <code>FALSE</code> models will include a one-sided formula describing the within-group heteroscedasticity structure (<code><a href="nlme.html#topic+varIdent">varIdent</a></code>).</p>
</td></tr>
<tr><td><code id="dendro.varcov_+3A_null.mod">null.mod</code></td>
<td>
<p><code>logical</code> if <code>TRUE</code> only broad evaluation model will be fitted. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="dendro.varcov_+3A_all.mod">all.mod</code></td>
<td>
<p><code>logical</code> if <code>TRUE</code> all homoscedastic and heteroscedastic model types will be fitted. Default <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function fits a set of variance-covariance mixed models following Shestakova et al. (2014). A total of 7 different variance-covariance mixed models can be fitted: a null positive-definite matrix structure (mBE), and the homoscedastic and heteroscedastic versions of a diagonal positive-definite matrix structure (mNE, mHeNE), a positive-definite matrix with compound symmetry structure (mCS, mHeCS) and a general positive-definite matrix structure (mUN, mHeUN). Note that if null.mod is <code>TRUE</code> the function only fits broad evaluation model (mBE), this is set to <code>FALSE</code> by default. If all.mod is <code>TRUE</code> the function fits heteroscedastic and homoscesdastic versions of all models. This is set to <code>FALSE</code> by default, because for large-datasets it may take a long time to converge.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> containing the following components:
</p>
<ul>
<li><p>for <code>null.mod = TRUE</code>:</p>
</li></ul>

<table>
<tr><td><code>mBE</code></td>
<td>
<p> an object of class &quot;lme&quot; representing the linear mixed-effects model fit of null positive-definite matrix structure or broad evaluation. See <code><a href="nlme.html#topic+lmeObject">lmeObject</a></code> for the components of the fit.</p>
</td></tr>
</table>
<ul>
<li><p>for <code>homoscedastic = TRUE</code>:</p>
</li></ul>

<table>
<tr><td><code>mNE</code></td>
<td>
<p> an object of class &quot;lme&quot; representing the linear mixed-effects model fit of a diagonal positive-definite matrix structure or narrow evaluation. See <code><a href="nlme.html#topic+lmeObject">lmeObject</a></code> for the components of the fit.</p>
</td></tr> 
<tr><td><code>mCS</code></td>
<td>
<p> an object of class &quot;lme&quot; representing the linear mixed-effects model fit of a positive-definite matrix with compound symmetry structure. See <code><a href="nlme.html#topic+lmeObject">lmeObject</a></code> for the components of the fit.</p>
</td></tr>
<tr><td><code>mUN</code></td>
<td>
<p> an object of class &quot;lme&quot; representing the linear mixed-effects model fit of a general positive-definite matrix structure or unstructured. See <code><a href="nlme.html#topic+lmeObject">lmeObject</a></code> for the components of the fit.</p>
</td></tr> 
</table>
<ul>
<li><p>for <code>homoscedastic = FALSE</code>:</p>
</li></ul>

<table>
<tr><td><code>mHeNE</code></td>
<td>
<p> an object of class &quot;lme&quot; representing the linear mixed-effects model fit of the heteroscedastic variant of a diagonal positive-definite matrix structure or narrow evaluation. See <code><a href="nlme.html#topic+lmeObject">lmeObject</a></code> for the components of the fit.</p>
</td></tr>
<tr><td><code>mHeCS</code></td>
<td>
<p> an object of class &quot;lme&quot; representing the linear mixed-effects model fit of the heteroscedastic variant of a positive-definite matrix with compound symmetry structure. See <code><a href="nlme.html#topic+lmeObject">lmeObject</a></code> for the components of the fit.</p>
</td></tr> 
<tr><td><code>mHeUN</code></td>
<td>
<p> an object of class &quot;lme&quot; representing the linear mixed-effects model fit of the heteroscedastic variant of a general positive-definite matrix structure or unstructured. See <code><a href="nlme.html#topic+lmeObject">lmeObject</a></code> for the components of the fit.</p>
</td></tr> 
</table>
<ul>
<li><p>for <code>all.mod = TRUE</code>:</p>
</li></ul>

<table>
<tr><td><code>all.mod</code></td>
<td>
<p> The function returns the homoscedastic and heteroscedastic versions of all fitted models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="nlme.html#topic+lmeObject">lmeObject</a></code>, <code><a href="stats.html#topic+na.action">na.action</a></code>, <code><a href="stats.html#topic+complete.cases">complete.cases</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate variance-covariance models on Iberian Peninsula conifers
 # chronologies using two different grouping strategies.
 # Tree-ring width chronologies are grouped according to taxonomic (i.e. Species)
 # or geographic (i.e. Region) criteria.
 #User-defined homoscedastic or heteroscedastic variances can be fitted.
 data(conifersIP)
 
 #Chop the data from 1960 to 1989.
 conif.30 &lt;- conifersIP[conifersIP$Year&gt;1959 &amp; conifersIP$Year&lt;1990,]
 summary(conif.30$Year)
 
 ##Fit the homoscedastic set of varcov models (mBE, mNE, mCS, mUN)
 # using taxonomic grouping criteria (ie. Species)
 ModHm &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conif.30, homoscedastic = TRUE)
 
 summary(ModHm)# Class and length of list elements
 ModHm
 ModHm[2]#mNE fitted model results
 
 ##Fit the heteroscedastic set of varcov models (mBE, mHeNE, mHeCS, mHeUN) 
 # using geographic grouping criteria (ie. Region)
 ModHt &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Region", 
                        data = conif.30, homoscedastic = FALSE)
 
 summary(ModHt)# Class and length of list elements
 ModHt
 ModHt[3]#mHeCS fitted model results
       
                   
</code></pre>

<hr>
<h2 id='gen.aSE'>Within-group synchrony for homoscedastic models</h2><span id='topic+gen.aSE'></span>

<h3>Description</h3>

<p>The function calculates for each varGroup stratum the within-group synchrony (a^) and standard error (SE). However, it only works for homoscedastic broad evaluation, narrow evaluation and unstructured models (mBE, mNE, mUN).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.aSE(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen.aSE_+3A_model">model</code></td>
<td>
<p>a class &quot;<code>lme</code>&quot; model produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code> with <code>homoscedastic</code> equals <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the within-group synchrony values for each varGroup stratum based on the metodology described in Shestakova et al. (2014) and Shestakova et al. (2016). Note that this function is designed to work only in 3 homoscedastic models (mBE, mNE, mUN).
</p>


<h3>Value</h3>

<p>The function returns a <code>matrix</code> containing the synchrony and SE for each level of <code>varGroup</code>. This function is used internally in <code><a href="#topic+sync">sync</a></code>.
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sync">sync</a></code> for a clear description of synchrony evaluation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate within-group homoscedastic synchrony and SE for conifersIP data:
 data(conifersIP)
 
 #Fit the homoscedastic set of varcov models (mBE, mNE, mCS, mUN) 
 # using taxonomic grouping criteria (ie. Species)
 ModHm &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                         data = conifersIP, homoscedastic = TRUE)
 summary(ModHm)
   
 #Obtain the within-group synchrony and SE for each varGroup stratum.
 gen.aSE(ModHm$mBE)#Broad evaluation
 gen.aSE(ModHm$mUN)#Unstructured
 
</code></pre>

<hr>
<h2 id='gen.het.aSE'>Within-group synchrony for heteroscedastic mixed models</h2><span id='topic+gen.het.aSE'></span>

<h3>Description</h3>

<p>The function calculates for each <code>varGroup</code> stratum the synchrony (a^) and standard error (SE), but only for heteroscedastic unstructured and narrow evaluation mixed models (mHeNE, mHeUN).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.het.aSE (model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen.het.aSE_+3A_model">model</code></td>
<td>
<p>a class &quot;<code>lme</code>&quot; model produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code> with <code>homoscedastic</code> equals <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the within-group synchrony values for each <code>varGroup</code> stratum based on the metodology described in Shestakova et al. (2014) and Shestakova et al. (2016). Note that this function is designed to work only in heteroscedastic narrow evaluation and unstructured mixed models (ie. mHeNE and mHeUN).
</p>


<h3>Value</h3>

<p>The function returns a <code>matrix</code> containing  within-group synchrony and SE for each level of <code>varGroup</code>. This function is used internally in <code><a href="#topic+sync">sync</a></code>.
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sync">sync</a></code> for a clear description of synchrony evaluation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate within-group heterosdecastic synchrony and SE for conifersIP data:
 data(conifersIP)
 
 #Fit the heteroscedastic set of varcov models (mBE, mHeNE, mHeCS, mHeUN)
 # using taxonomic grouping criteria (i.e. Species)
 ModHt &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conifersIP, homoscedastic = FALSE)
 summary(ModHt)
   
 #Obtain the heteroscedastic within-group synchrony and SE for each varGroup stratum.
 gen.het.aSE(ModHt$mHeNE)#Narrow evaluation model
 gen.het.aSE(ModHt$mHeUN)#Unstructured model
 
</code></pre>

<hr>
<h2 id='het.var'>Variances per varGroup stratum for heteroscedastic models</h2><span id='topic+het.var'></span>

<h3>Description</h3>

<p>The function obtains the heteroscedastic variances for each <code>varGroup</code> elements for a selected model (mHeCS, mHeUN, mHeNE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>het.var(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="het.var_+3A_model">model</code></td>
<td>
<p>a class &quot;<code>lme</code>&quot; model produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code> with <code>homoscedastic</code> equals <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function extracts the variances for each <code>varGroup</code> stratum using the within-group heteroscedastic structure of the fitted models (<code>varIdent</code> constant variance per stratum).
Note that this function only works for heteroscedastic models: mHeCS, mHeNE,mHeUN.
</p>


<h3>Value</h3>

<p>The function returns a <code>numeric</code> vector containing the variance per each level of <code>varGroup</code>. They are used internally to calculate synchrony (<code><a href="#topic+sync">sync</a></code>).
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate within-group heteroscedastic variances for conifersIP data:
 data(conifersIP)
 
 #Fit the heteroscedastic set of models (mBE, mHeCS, mHeNE, mHeUN)
 # using taxonomic grouping criteria (i.e. Species)
 ModHt &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conifersIP, homoscedastic = FALSE)
 
 #Obtain the within-group variances for the model of interest
 het.var(ModHt$mHeCS)#Heterogeneous variant of compound symmetry model
 het.var(ModHt$mHeUN)#Heterogeneous unstructured model
 
</code></pre>

<hr>
<h2 id='mod.table'>Function to calculate goodness-of-fit statistics for variance-covariance models</h2><span id='topic+mod.table'></span>

<h3>Description</h3>

<p>The function provides a table to compare fitted variance-covariance (VCOV) mixed models by AIC, AICc, BIC and LogLik. The restricted log-likelihood (LogLik) statistics for different models can be compared by Chi-square test, while Akaike information criterion (AIC), corrected Akaike information criterion (AICc) and Bayesian information criterion (BIC) are in the smaller-is-better form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mod.table(modelList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mod.table_+3A_modellist">modelList</code></td>
<td>
<p>a <code>list</code> of variance-covariance (VCOV) mixed models of the type as produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a table to compare the fitted variance-covariance (VCOV) mixed models to the same data based on information criteria. The smaller AIC, AICc or BIC, the better fit. Also, LogLik value is included. 
AICc is calculated according to the formula AIC + 2*npar*(nobs/(nobs-npar-2)), where npar represents the number of parameters and nobs the number of observations in the fitted model.
</p>


<h3>Value</h3>

<p>The function returns a <code>data.frame</code> with rows corresponding to the objects and columns containing the following components:
</p>
<table>
<tr><td><code>n</code></td>
<td>
<p> the number of observations used in the model fit.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> the number of parameters in the fitted model.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p> Akaike's Information Criterion of the fitted model.</p>
</td></tr>
<tr><td><code>AICc</code></td>
<td>
<p> corrected Akaike's Information Criterion of the fitted model.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p> Bayesian Information Criterion of the fitted model.</p>
</td></tr>
<tr><td><code>LogLik</code></td>
<td>
<p>log-likelihood of the fitted model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Hurvich, C.M. &amp; Tsai, C.L. (1989). Regression and time series model selection in small samples. <em>Biometrika</em> 76: 297-307.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+AIC">AIC</a></code>, <code><a href="stats.html#topic+BIC">BIC</a></code>, <code><a href="stats.html#topic+logLik">logLik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Compare homoscedastic variance-covariance models on Iberian Peninsula
 # conifer ring chronologies using taxonomic grouping criteria (i.e. Species).
 data(conifersIP)
 ModHmSp &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                          data = conifersIP, homoscedastic = TRUE)
 
 mod.table(ModHmSp)# a data.frame containing information criterion values

 ## Compare homoscedastic variance-covariance models on Iberian Peninsula conifers
 # ring chronologies using geographic criteria (ie. Region).
 ModHmGoe &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Region", 
                           data = conifersIP, homoscedastic = TRUE)
 
 mod.table(ModHmGoe)

</code></pre>

<hr>
<h2 id='sync'>Calculate within- and between-group synchrony</h2><span id='topic+sync'></span>

<h3>Description</h3>

<p>The function calculates spatial synchrony from a <code>list</code> of fitted mixed models with variance-covariance structures of the type as produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code>. Within- and between- <code>varGroup</code> level synchrony are calculated, quantifying the degree to which the values of N chronologies contain a common temporal signal. Different models allow for the estimation of intraclass correlations either at the intragroup or intergroup level. The underlying idea is to split the mean correlation estimated between all possible pairs of chronologies drawn from the whole dataset into: (i) a mean correlation between pairs of chronologies for every group; and (ii) a mean correlation between pairs of chronologies for pairs of groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sync (modelList, modname = c("mBE", "mNE", "mCS", "mUN", "mHeNE",
                                    "mHeCS", "mHeUN"), trend.mBE = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sync_+3A_modellist">modelList</code></td>
<td>
<p>a <code>list</code> of the type as produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code>.</p>
</td></tr>
<tr><td><code id="sync_+3A_modname">modname</code></td>
<td>
<p>a <code>character</code> string of <code>"mBE"</code>, <code>"mNE"</code>, <code>"mCS"</code>, <code>"mUN"</code>, <code>"mHeNE"</code>, <code>"mHeCS"</code> or <code>"mHeUN"</code>, specifying the variance-covariance structures selected for syncrony evaluation.</p>
</td></tr>
<tr><td><code id="sync_+3A_trend.mbe">trend.mBE</code></td>
<td>
<p>a <code>logical</code> specifying if a broad evaluation model (mBE) output for each grouping level is reported. This is a special mBE output to plot synchrony trends with <code><a href="#topic+sync.trend.plot">sync.trend.plot</a></code>. Default <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the within- and between-group synchrony. For the more general (unstructured) model, the correlation of pairs of chronologies <code>i</code> and <code>i*</code> belonging to group <code>r</code> is:
</p>
<p style="text-align: center;"><code class="reqn">rho(Wi,Wi*) = cov(Wi,Wi*)/sqrt(Var(Wi)*Var(Wi*)) = sigma^2yr/sigma^2yr+sigma^2e</code>
</p>
 
<p>Where <code>Wi</code> is tree-ring width of <code>i</code>th chronology, <code>sigma^2yr</code> is a covariance between observations <code>Wi</code> and <code>Wi*</code> belonging to a group <code>r</code>, <code>sigma^2e</code> is a random deviation within the <code>r</code>th group.
Conversely, the correlation of pairs of chronologies <code>i</code> and <code>i*</code> belonging to groups <code>r</code> and <code>r*</code> is:
</p>
<p style="text-align: center;"><code class="reqn">rho(Wi,Wi*) = cov(Wi,Wi*)/sqrt(Var(Wi)*Var(Wi*)) =</code>
</p>

<p style="text-align: center;"><code class="reqn">sigma^2yr*/sqrt((sigma^2yr+sigma^2e)+(sigma^2yr*+sigma^2e))</code>
</p>
 
<p>Note that if no <code>modname</code> is provided a warning message appears indicating that synchrony will be only calculated for the first <code>modname</code> vector element, i.e. broad evaluation model (mBE).
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> containing the following components:
</p>
<ul>
<li><p>for within-group synchrony:</p>
</li></ul>

<table>
<tr><td><code>Modname</code></td>
<td>
<p>a column indicating the variance-covariance mixed models fit type:</p>
</td></tr>
</table>
<ul>
<li><p>mBE: null (or broad evaluation) structure.</p>
</li></ul>

<ul>
<li><p>mNE: homoscedastic variant of banded main diagonal (or narrow evaluation) structure.</p>
</li></ul>

<ul>
<li><p>mCS: homoscedastic variant of compound symmetry structure.</p>
</li></ul>

<ul>
<li><p>mUN: homoscedastic variant of unstructured (or full) structure.</p>
</li></ul>

<ul>
<li><p>mHeNE: heteroscedastic variant of banded main diagonal (or narrow evaluation) structure.</p>
</li></ul>

<ul>
<li><p>mHeCS: heteroscedastic variant of compound symmetry structure.</p>
</li></ul>

<ul>
<li><p>mHeUN: heteroscedastic variant of unstructured (or full) structure.</p>
</li></ul>

<table>
<tr><td><code>a_Group</code></td>
<td>
<p>a column representing the within-group synchrony.</p>
</td></tr>
<tr><td><code>SE_Group</code></td>
<td>
<p>standard error of each observation.</p>
</td></tr>
</table>
<ul>
<li><p>for between-group synchrony:</p>
</li></ul>

<table>
<tr><td><code>Modname</code></td>
<td>
<p>a column indicating the model fit type. See previous desription.</p>
</td></tr>
<tr><td><code>GroupName</code></td>
<td>
<p>a column indicating between-group <code>varGroup</code> pairwise combinations r and r*.</p>
</td></tr>
<tr><td><code>a_betw_Grp</code></td>
<td>
<p>a column indicating between-group <code>varGroup</code> synchrony.</p>
</td></tr> 
<tr><td><code>SE_betw_Grp</code></td>
<td>
<p>standard error of each observation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. <em>Tree Physiology</em> 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dendro.varcov">dendro.varcov</a></code> for models details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate synchrony for null.model (broad evaluation, mBE) and homoscedastic variant
 # of unstructured model (or full, mUN) for conifersIP data, 
 # and heteroscedastic variant for 1970-1999 period.
 data(conifersIP)
 
 ##Fit the homoscedastic set of varcov models (mBE, mNE, mCS, mUN) 
 #using taxonomic grouping criteria (i.e. Species)
 ModHm &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                        data = conifersIP, homoscedastic = TRUE)
 
 summary(ModHm)# Class and length of list elements
 
 #Synchrony for mBE and mUN models
 sync(ModHm, modname = "mBE")
 sync(ModHm, modname = "mUN")
 
 ##Chop the data from 1970 to 1999.
 conif.30 &lt;- conifersIP[conifersIP$Year&gt;1969 &amp; conifersIP$Year&lt;2000,]
 summary(conif.30$Year)
 
 #Fit the heteroscedastic set of variance covariance mixed models (mBE, mHeNE, mHeCS, mHeUN)
 # using taxonomic grouping criteria (ie. Species)
 ModHt30 &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                          data = conif.30, homoscedastic = FALSE)
 sync(ModHt30, modname = "mBE")
 sync(ModHt30, modname = "mHeUN")
 
</code></pre>

<hr>
<h2 id='sync.plot'>Plot within- and between-group synchrony</h2><span id='topic+sync.plot'></span>

<h3>Description</h3>

<p>The function creates dot plots of within- and between-group synchrony as produced by <code><a href="#topic+sync">sync</a></code> from a selected model produced by <code><a href="#topic+dendro.varcov">dendro.varcov</a></code>.
Note that broad evaluation model (mBE) can not be plotted since it produces only one value per model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sync.plot (syncList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sync.plot_+3A_synclist">syncList</code></td>
<td>
<p>a <code>list</code> of the type as produced by <code><a href="#topic+sync">sync</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function makes a dot plots for within- and between-group synchrony for a user defined <code>varGroup</code> and <code>varTime</code> period in <code><a href="#topic+dendro.varcov">dendro.varcov</a></code>.
</p>


<h3>Value</h3>

<p>Dotplot
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Plot homoscedastic narrow evaluation (mNE) and unstructured model (mUN)
 # synchronies for conifersIP data:
 data(conifersIP)
     
 ##Fit the homoscedastic set of varcov models (mBE, mNE, mCS, mUN)
 # using geographic grouping criteria (ie. Region)
 ModHm &lt;- dendro.varcov(TRW ~ Code, varTime = "Year", varGroup = "Region", 
                        data = conifersIP, homoscedastic = TRUE)
 
 sync.plot(sync(ModHm, modname = "mNE"))
 sync.plot(sync(ModHm, modname = "mUN"))


</code></pre>

<hr>
<h2 id='sync.trend'>Calculate temporal trends of synchrony</h2><span id='topic+sync.trend'></span>

<h3>Description</h3>

<p>The function calculates temporal trends of spatial synchrony from a <code>data.frame</code> with tree-ring width chronologies using a moving window as described in Shestakova et al. (2016). This method splits the time variable (<code>varTime</code>) in 30 years windows plus a 5 years lag, and in each window the within- or between-group level (<code>varGroup</code>) synchronies are calculated. The function can also be used to find synchrony with similar time series <code>data.frame</code> from other fields.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sync.trend (formula, varTime="", varGroup="", data,  window = 30, lag = 5, 
                    null.mod = TRUE, selection.method = c("AIC", "AICc", "BIC"), 
                    all.mod = FALSE, homoscedastic = TRUE, between.group = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sync.trend_+3A_formula">formula</code></td>
<td>
<p>a <code>formula</code> a typical model formula such as <code>Y ~ A</code>, where <code>Y</code> is usually tree-ring width and <code>A</code> may be a grouping factor such as the specific names of tree-ring width chronologies (<code><a href="#topic+conifersIP">conifersIP</a></code>).</p>
</td></tr>
<tr><td><code id="sync.trend_+3A_vartime">varTime</code></td>
<td>
<p>a <code>character</code> specifying the time variable to consider in calculating synchrony estimates. Models with less than 10 different time-points may produce unreliable results.</p>
</td></tr>
<tr><td><code id="sync.trend_+3A_vargroup">varGroup</code></td>
<td>
<p>a <code>character</code> grouping variable. In dendrochronological studies different grouping strategies can be used. We used here two strategies following taxonomic (i.e. species) or geographic (i.e. region) criteria.</p>
</td></tr>
<tr><td><code id="sync.trend_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> with tree-ring chronologies, years and grouping variables as columns.</p>
</td></tr>
<tr><td><code id="sync.trend_+3A_window">window</code></td>
<td>
<p>an <code>integer</code> specifying the window size (i.e. number of years) to be used to calculate synchrony. Must be greater than 20 (&gt;=20). Defaults to 20.</p>
</td></tr>
<tr><td><code id="sync.trend_+3A_lag">lag</code></td>
<td>
<p>an <code>integer</code> specifying the lag that the window is moving (i.e. number of vrTirs moving window) to be used to calculate synchrony. Must be greater than 1 (&gt;=1). Defaults to 5.</p>
</td></tr>
<tr><td><code id="sync.trend_+3A_null.mod">null.mod</code></td>
<td>
<p>a <code>logical</code> specifying if only the null model for general synchrony is fitted (broad evaluation, mBE). Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="sync.trend_+3A_selection.method">selection.method</code></td>
<td>
<p>a <code>character</code> string of <code>"AIC"</code>, <code>"AICc"</code> or <code>"BIC"</code>, specifying the information criterion used for model selection.</p>
</td></tr>
<tr><td><code id="sync.trend_+3A_all.mod">all.mod</code></td>
<td>
<p>a <code>logical</code> specifying if all homoscedastic and heteroscedastic models should be fitted. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="sync.trend_+3A_homoscedastic">homoscedastic</code></td>
<td>
<p>a <code>logical</code> specifying if models should be an optional <code>varFunc</code> object or one-sided formula describing the within-group heteroscedasticity structure. Default <code>TRUE</code></p>
</td></tr>
<tr><td><code id="sync.trend_+3A_between.group">between.group</code></td>
<td>
<p>a <code>logical</code> specifying if between-group synchrony is displayed instead of whitin-group synchrony. Default <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function fits by default (<code>"null.mod=T"</code>) the null model for general synchrony (broad evaluation, mBE) for a specified time window size and lag. If <code>"null.mod=F"</code> the function calculates <code>homoscedastic</code> or <code>heteroscedastic</code> versions of variance-covariance (VCOV) mixed models available (mBE, mNE, mCS, mUN, mHeNE, mHeCS, mHeUN; <code><a href="#topic+dendro.varcov">dendro.varcov</a></code>) for each time window size and lag selected. In each window the best model is chosen based on the minimum information criterion selected between &quot;AIC&quot;, &quot;AICc&quot; or &quot;BIC&quot;.
When no <code>selection.method</code> is defined by default AIC is used. 
If <code>"all.mod=T"</code> the functions fits the homoscedastic and heteroscedastic versions of the 7 models (this is a higly time consuming process).
</p>


<h3>Value</h3>

<p>The function returns a <code>data.frame</code> containing the following components:
</p>
<ul>
<li><p>for <code>null.mod</code> <code>TRUE</code>:</p>
</li></ul>

<table>
<tr><td><code>a_Group</code></td>
<td>
<p>a column representing the within-group synchrony (mBE).</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>standard error of each observation.</p>
</td></tr>
<tr><td><code>Windlag</code></td>
<td>
<p>a column representing the lag of the window used to split the time variable. A 0 value means that lag is 0, and then the defined time window starts from minimun varTime value.</p>
</td></tr>
<tr><td><code>varTime</code></td>
<td>
<p>a column representing the <code>varTime</code> variable.</p>
</td></tr>
</table>
<ul>
<li><p>for <code>null.mod</code> <code>FALSE</code>:</p>
</li></ul>

<table>
<tr><td><code>Modname</code></td>
<td>
<p>a column indicating the best model fit and the information criterion used.</p>
</td></tr>
<tr><td><code>GroupName</code></td>
<td>
<p>a column indicating levels of the <code>varGroup</code> for each time-window selected.</p>
</td></tr>
<tr><td><code>a_Group</code></td>
<td>
<p>a column indicating within-group synchrony for each <code>varGroup</code> level at time-window selected.</p>
</td></tr> 
<tr><td><code>a_betw_Grp</code></td>
<td>
<p>a column indicating between-group synchrony for each <code>varGroup</code> level at time-window selected. Only if <code>between.group</code> is set to <code>TRUE</code>.</p>
</td></tr> 
<tr><td><code>SE</code></td>
<td>
<p>standard error of each observation.</p>
</td></tr>
<tr><td><code>Windlag</code></td>
<td>
<p>a column representing the lag of the window used to split the time variable. A 0 value means that lag is 0, and then the defined time window starts from minimun varTime value.</p>
</td></tr>
<tr><td><code>varTime</code></td>
<td>
<p>a column representing the <code>varTime</code> variable window mean point.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>References</h3>

<p>Shestakova, T.A., Aguilera, M., Ferrio, J.P., Gutierrez, E. &amp; Voltas, J. (2014). Unravelling spatiotemporal tree-ring signals in Mediterranean oaks: a variance-covariance modelling approach of carbon and oxygen isotope ratios. Tree Physiology 34: 819-838.
</p>
<p>Shestakova, T.A., Gutierrez, E., Kirdyanov, A.V., Camarero, J.J., Genova, M., Knorre, A.A., Linares, J.C., Resco de Dios, V., Sanchez-Salguero, R. &amp; Voltas, J. (2016). Forests synchronize their growth in contrasting Eurasian regions in response to climate warming. <em>Proceedings of the National Academy of Sciences of the United States of America</em> 113: 662-667.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate  temporal trends of spatial synchrony for conifersIP data:
 data(conifersIP)
 
 ##Fit the null.model temporal trend (mBE) 
 #using taxonomic grouping criteria (i.e. Species)
 mBE.trend &lt;- sync.trend(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                          data = conifersIP, null.mod = TRUE, window = 30, lag = 5)
 
 mBE.trend# it returns a data.frame

## Not run:  
 ##Fit homoscedastic within-group trends (mBE, mNE, mCS, mUN) 
 # using geographic grouping criteria (i.e. Region)
 geo.trend &lt;- sync.trend(TRW ~ Code, varTime = "Year", varGroup = "Region", 
                         data = conifersIP, window = 30, lag = 5, 
                         null.mod = FALSE, homoscedastic = TRUE)
                         
 geo.trend#a data.frame with varGroup syncrony for each time window.
 
 ##Fit heteroscedastic between-group trends (mBE, mHeNE, mHeCS, mHeUN) 
 #using geographic grouping criteria (i.e. Region) and BIC
 geo.het.trend &lt;- sync.trend(TRW ~ Code, varTime = "Year", varGroup = "Region", 
                             data = conifersIP, window = 30, lag = 5, null.mod = FALSE, 
                             selection.method = c("BIC"), homoscedastic = FALSE, 
                             between.group = TRUE)
 geo.het.trend
 
 ##Fit homoscedastic and heterocedastic within-group trends
 # using taxonomic grouping criteria (i.e. Species) and BIC
 geo.tot.trend &lt;- sync.trend(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                             data = conifersIP, window = 30, lag = 5, 
                             selection.method = c("BIC"), all.mod = TRUE)
 geo.tot.trend
 
## End(Not run)

</code></pre>

<hr>
<h2 id='sync.trend.plot'>Plot temporal trends of synchrony</h2><span id='topic+sync.trend.plot'></span>

<h3>Description</h3>

<p>The function creates a line chart showing temporal trends of spatial synchrony from <code>data.frame</code> of the type as produced by <code><a href="#topic+sync.trend">sync.trend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sync.trend.plot (sync.trend.data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sync.trend.plot_+3A_sync.trend.data">sync.trend.data</code></td>
<td>
<p>a <code>data.frame</code> of the type as produced by <code><a href="#topic+sync.trend">sync.trend</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function makes a line chart showing synchrony trends across years from a data.frame produced by <code><a href="#topic+sync.trend">sync.trend</a></code>. Within- or between- group synchrony and SE are indicated for a selected time window. If synchrony is defined using using <code>null.mod = TRUE</code> (<code><a href="#topic+sync.trend">sync.trend</a></code>) only general synchrony is ploted. If synchrony is defined using using <code>null.mod = FALSE</code> (<code><a href="#topic+sync.trend">sync.trend</a></code>) different synchronies for each group variable (<code>varGroup</code>) are fitted with different colours for each stratum.
</p>


<h3>Value</h3>

<p>Line chart
</p>


<h3>Author(s)</h3>

<p>Josu G. Alday, Tatiana A. Shestakova, Victor Resco de Dios, Jordi Voltas
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculate temporal trends of synchrony for conifersIP data:
 data(conifersIP)
 
 ##Fit the null.model temporal trend (mBE) using taxonomic grouping criteria (i.e. Species)
 mBE.trend &lt;- sync.trend(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                          data = conifersIP, null.mod = TRUE, window = 30, lag = 5)
 
 mBE.trend# it returns a data.frame
 sync.trend.plot(mBE.trend)# Broad evaluation synchrony linechart

## Not run:  
 ##Fit homoscedastic within-group trends (mBE, mNE, mCS, mUN) 
 # using geographic grouping criteria (i.e. Region)
 geo.trend &lt;- sync.trend(TRW ~ Code, varTime = "Year", varGroup = "Region", 
                         data = conifersIP, window = 30, lag = 5, 
                         null.mod = FALSE, homoscedastic = TRUE)
 
 geo.trend#a data.frame with varGroup synchrony for each time window.
 sync.trend.plot(geo.trend)#Selected heteroscedastic between-group trends by AIC
 
 ##Fit heteroscedastic betwen-group trends (mBE, mHeNE, mHeCS, mHeUN) 
 # using geographic grouping criteria (i.e. Region) and AICc
 geo.het.trend &lt;- sync.trend(TRW ~ Code, varTime = "Year", varGroup = "Region", 
                    data = conifersIP, window = 30, lag = 5, null.mod = FALSE, 
                    selection.method = c("AICc"), homoscedastic = FALSE, between.group = TRUE)
 
 geo.het.trend
 sync.trend.plot(geo.het.trend)#Selected heteroscedastic between-group trends by AICc
 
 ##Fit homoscedastic and heteroscedastic within-group trends 
 # using taxonomic grouping criteria (i.e. Species) and BIC
 geo.tot.trend &lt;- sync.trend(TRW ~ Code, varTime = "Year", varGroup = "Species", 
                    data = conifersIP, window = 30, lag = 5, selection.method = c("BIC"),
                    null.mod = F, all.mod = TRUE)
 geo.tot.trend
 #Selected homoscedastic and heteroscedastic within-group trends by BIC
 sync.trend.plot(geo.tot.trend)
 
## End(Not run)
 

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
