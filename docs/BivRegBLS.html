<!DOCTYPE html><html><head><title>Help for package BivRegBLS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BivRegBLS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BivRegBLS-package'>
<p>Tolerance Intervals and Errors-in-Variables Regressions in Method Comparison Studies (Bridging Studies)</p></a></li>
<li><a href='#antilog.pred'><p>Back transforms the results if a logarithmic transformation is used</p></a></li>
<li><a href='#Aromatics'>
<p>Aromatics petroleum data</p></a></li>
<li><a href='#BLS'>
<p>Bivariate Least Square regression (BLS)</p></a></li>
<li><a href='#BLS.fit'>
<p>Fit a Bivariate Least Square regression (BLS): estimates table</p></a></li>
<li><a href='#BLS.ht'>
<p>Bivariate Least Square regression (BLS)</p></a></li>
<li><a href='#CBLS'>
<p>Correlated Bivariate Least Square regression (CBLS)</p></a></li>
<li><a href='#CBLS.fit'>
<p>Fit a Correlated Bivariate Least Square regression (CBLS): estimates table</p></a></li>
<li><a href='#desc.stat'>
<p>Descriptive statistics in method comparison studies</p></a></li>
<li><a href='#df.WS'>
<p>Degrees of freedom by Welch-Satterthwaite</p></a></li>
<li><a href='#DR'><p>Deming Regression</p></a></li>
<li><a href='#FullCIs.MD'>
<p>Confidence Intervals by CBLS with all potential solutions</p></a></li>
<li><a href='#FullCIs.XY'>
<p>Confidence Intervals from OLSv to OLSh by DR and BLS</p></a></li>
<li><a href='#GraphFullCIs.MD'>
<p>Plot all the CBLS potential solutions</p></a></li>
<li><a href='#GraphFullCIs.XY'>
<p>Plot all the DR and BLS potential solutions</p></a></li>
<li><a href='#lambdas'>
<p>Measurement error variances ratio</p></a></li>
<li><a href='#MD.horiz.lines'>
<p>Tolerance intervals in a (M,D) plot</p></a></li>
<li><a href='#MD.plot'>
<p>Display the CBLS regression, or univariate tolerance intervals in a (M,D) plot</p></a></li>
<li><a href='#OLSh'><p>Horizontal Ordinary Least Square regression</p></a></li>
<li><a href='#OLSv'><p>Vertical Ordinary Least Square regression</p></a></li>
<li><a href='#raw.plot'>
<p>Raw plot for descriptive statistics</p></a></li>
<li><a href='#SBP'>
<p>Systolic blood pressure data</p></a></li>
<li><a href='#XY.plot'>
<p>Display the BLS regression in a (X,Y) plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tolerance Interval and EIV Regression - Method Comparison
Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-10-10</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bernard G Francq &lt;BivRegBLS@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Assess the agreement in method comparison studies by tolerance intervals and errors-in-variables (EIV) regressions. The Ordinary Least Square regressions (OLSv and OLSh), the Deming Regression (DR), and the (Correlated)-Bivariate Least Square regressions (BLS and CBLS) can be used with unreplicated or replicated data. The BLS() and CBLS() are the two main functions to estimate a regression line, while XY.plot() and MD.plot() are the two main graphical functions to display, respectively an (X,Y) plot or (M,D) plot with the BLS or CBLS results. Four hyperbolic statistical intervals are provided: the Confidence Interval (CI), the Confidence Bands (CB), the Prediction Interval and the Generalized prediction Interval. Assuming no proportional bias, the (M,D) plot (Band-Altman plot) may be simplified by calculating univariate tolerance intervals (beta-expectation (type I) or beta-gamma content (type II)). Major updates from last version 1.0.0 are: title shortened, include the new functions BLS.fit() and CBLS.fit() as shortcut of the, respectively, functions BLS() and CBLS(). References: B.G. Francq, B. Govaerts (2016) &lt;<a href="https://doi.org/10.1002%2Fsim.6872">doi:10.1002/sim.6872</a>&gt;, B.G. Francq, B. Govaerts (2014) &lt;<a href="https://doi.org/10.1016%2Fj.chemolab.2014.03.006">doi:10.1016/j.chemolab.2014.03.006</a>&gt;, B.G. Francq, B. Govaerts (2014) <a href="http://publications-sfds.fr/index.php/J-SFdS/article/view/262">http://publications-sfds.fr/index.php/J-SFdS/article/view/262</a>, B.G. Francq (2013), PhD Thesis, UCLouvain, Errors-in-variables regressions to assess equivalence in method comparison studies, <a href="https://dial.uclouvain.be/pr/boreal/object/boreal%3A135862/datastream/PDF_01/view">https://dial.uclouvain.be/pr/boreal/object/boreal%3A135862/datastream/PDF_01/view</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), ellipse</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-10 21:02:59 UTC; Bernard</td>
</tr>
<tr>
<td>Author:</td>
<td>Bernard G Francq [cre, aut],
  Marion Berger [aut],
  Christophe Agut [ctb],
  Guy Mathieu [ctb],
  Armand Berges [ctb],
  Franck Pellissier [ctb],
  Veronique Onado [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-10 22:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='BivRegBLS-package'>
Tolerance Intervals and Errors-in-Variables Regressions in Method Comparison Studies (Bridging Studies)</h2><span id='topic+BivRegBLS-package'></span><span id='topic+BivRegBLS'></span>

<h3>Description</h3>

<p>Assess the agreement in method comparison studies by tolerance intervals and (correlated)-errors-in-variables regressions. The results can then be displayed in an (X,Y) plot or (M,D) plot (Bland-Atman plot). The vertical and horizontal Ordinary Least Square regressions (OLSv, OLSh), the Deming Regression (DR), and the (Correlated)-Bivariate Least Square regressions (BLS and CBLS) can be used with unreplicated or replicated data. The measurement error variances and their ratio (lambda) can be estimated by an unbiased estimator with replicated data. If lambda is unknown and not estimatable, there is no unique solution and all the potential solutions can be calculated from OLSv to OLSh in a (X,Y) plot (extreme solutions), or equivalently from a correlation (between the measurement errors in a Bland-Altman plot) -1 to +1 with the CBLS in a (M,D) plot. The <code><a href="#topic+BLS">BLS</a></code> and <code><a href="#topic+CBLS">CBLS</a></code> are the two main regressions. They provide a table of the estimates (estimates, standard error, confidence intervals and pvalues for separate and joint hypotheses), the coordinates of the joint confidence interval (confidence region, or ellipse), and the four following hyperbolic intervals: the Confidence Intervals (CI), the Confidence Bands (CB), the Predictive Intervals (PI), and the Generalized predictive Intervals (GI). The <code><a href="#topic+XY.plot">XY.plot</a></code> and <code><a href="#topic+MD.plot">MD.plot</a></code> are the two main graphical functions to display an (X,Y) plot or (M,D) plot with the desired results. If one can assume no proportional bias, the (M,D) plot may be simplified by calculating horizontal lines intervals with the beta-expectation tolerance interval (type I) or the beta-gamma content tolerance interval (type II).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> BivRegBLS</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-10-10</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> AGPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The most important functions are <code><a href="#topic+BLS">BLS</a></code> (Bivariate Least Square regression) and <code><a href="#topic+CBLS">CBLS</a></code> (Correlated Bivariate Least Square regression). The results can then be plotted with respectively the functions <code><a href="#topic+XY.plot">XY.plot</a></code> and <code><a href="#topic+MD.plot">MD.plot</a></code>. Univariate tolerance intervals (bounded by two straight lines in the (M,D) plot) for the differences by two measurement methods can be obtained by the function <code><a href="#topic+MD.horiz.lines">MD.horiz.lines</a></code>.</p>


<h3>Note</h3>

<p>BivRegBLS was developed with a partnership between the University of Glasgow and Sanofi under a Knowledge Exchange award: BGF lead researcher, MB project manager, and big thanks to the whole project team during this fantastic and wonderful journey: Christophe Agut, Armand Berges, Guy Mathieu, Franck Pellissier, Veronique Onado and Delphine Attonaty.
</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ &lt;BivRegBLS@gmail.com&gt;, Marion BERGER &lt;marion.berger@sanofi.com&gt;
<br /> Maintainer: Bernard G Francq &lt;BivRegBLS@gmail.com&gt;
</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br /> Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.
<br /> Francq BG. Errors-in-variables regressions to assess equivalence in method comparison studies. Ph.D. Thesis, UCLouvain, Institute of Statistics, Biostatistics and Actuarial science, Louvain-la-Neuve, Belgium, 2013.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
### Descriptive statistics
res=desc.stat(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
raw.plot(data.plot=res,xname="J",yname="S",graph="XY.bar.SEM")
### BLS regression in an (X,Y) plot
res.BLS=BLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10,qx=3,qy=3)
XY.plot(BLS.results=res.BLS,xname="J",yname="S",accept.int=10,accept.int.perc=FALSE)
### CBLS regression in an (M,D) plot
res.CBLS=CBLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
MD.plot(results=res.CBLS,xname="J",yname="S",
        accept.int=10,accept.int.perc=FALSE,include.int=TRUE,graph.int=c("CI","GI"))
### Univariate tolerance intervals in an (M,D) plot
res.MD.horiz=MD.horiz.lines(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10,pred.level=0.95)
MD.plot(results=res.MD.horiz,xname="J",yname="S",
        accept.int=10,accept.int.perc=FALSE,include.int=TRUE,graph.horiz.int=c("bTI","bgTI"))
</code></pre>

<hr>
<h2 id='antilog.pred'>Back transforms the results if a logarithmic transformation is used</h2><span id='topic+antilog.pred'></span>

<h3>Description</h3>

<p>If the data are log-normal, the user can apply a logarithmic transformation. Then, <code><a href="#topic+antilog.pred">antilog.pred</a></code> will automatically back-transform (exponentiate) the data and the predictions (hyperbolic intervals) obtained by the <code><a href="#topic+BLS">BLS</a></code>, <code><a href="#topic+CBLS">CBLS</a></code>, <code><a href="#topic+MD.horiz.lines">MD.horiz.lines</a></code>, <code><a href="#topic+FullCIs.XY">FullCIs.XY</a></code> or <code><a href="#topic+FullCIs.MD">FullCIs.MD</a></code> functions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>antilog.pred(results = NULL, base = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="antilog.pred_+3A_results">results</code></td>
<td>
<p>an object of class <code>BLS</code>, <code>CBLS</code>, <code>MD.horiz.lines</code>, <code>CIs.XY</code> or <code>CIs.MD</code>.</p>
</td></tr>
<tr><td><code id="antilog.pred_+3A_base">base</code></td>
<td>
<p> a character string or a numeric value. Options available are: 10 (default value) or &quot;e&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+antilog.pred">antilog.pred</a></code> is automatically called by the argument <code>antilog</code> in the functions <code><a href="#topic+XY.plot">XY.plot</a></code> or <code><a href="#topic+MD.plot">MD.plot</a></code>.</p>


<h3>Value</h3>

<p>An object of class <code>BLS</code>, <code>CBLS</code>, <code>MD.horiz.lines</code>, <code>CIs.XY</code> or <code>CIs.MD</code>.</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>See Also</h3>

<p><code><a href="#topic+BLS">BLS</a></code>, <code><a href="#topic+CBLS">CBLS</a></code>, <code><a href="#topic+MD.horiz.lines">MD.horiz.lines</a></code>, <code><a href="#topic+FullCIs.XY">FullCIs.XY</a></code>, <code><a href="#topic+FullCIs.MD">FullCIs.MD</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
SBPlog=SBP
SBPlog[,2:10]=log(SBPlog[,2:10])
res.BLS.log=BLS(data=SBPlog,xcol=c("J1","J2","J3"),ycol=8:10)
res.BLS=antilog.pred(results=res.BLS.log,base="e")
</code></pre>

<hr>
<h2 id='Aromatics'>
Aromatics petroleum data
</h2><span id='topic+Aromatics'></span>

<h3>Description</h3>

<p>Aromatics measurements in light and medium petroleum by HPLC and GC MS.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Aromatics)</code></pre>


<h3>Format</h3>

<p>A data frame with 35 observations on the following 8 variables:
</p>

<dl>
<dt><code>Sample</code></dt><dd><p> a factor with the sample type</p>
</dd>
<dt><code>Type</code></dt><dd><p> a factor with the following levels: HD (Heavy Diesel), LD (Light Diesel), LGO (Light Gas Oil), MGO (Medium Gas Oil).</p>
</dd>
<dt><code>HPLCmono</code></dt><dd><p> a numeric vector with the monoaromatics measurements by HPLC.</p>
</dd>
<dt><code>GCMSmono</code></dt><dd><p> a numeric vector with the monoaromatics measurements by GC MS.</p>
</dd>
<dt><code>HPLCdi</code></dt><dd><p> a numeric vector with the diaromatics measurements by HPLC.</p>
</dd>
<dt><code>GCMSdi</code></dt><dd><p> a numeric vector with the diaromatics measurements by GC MS.</p>
</dd>
<dt><code>HPLCtri</code></dt><dd><p> a numeric vector with the triaromatics measurements by HPLC.</p>
</dd>
<dt><code>GCMStri</code></dt><dd><p> a numeric vector with the triaromatics measurements by GC MS.</p>
</dd>
</dl>



<h3>Source</h3>

<p>C-A B Ferrer, B M Celis, A B Velandia, Development of a methodology to determine the aromatic structural distribution in light and medium petroleum fractions by HPLC. Cienc. Tecnol. Futuro, 2006; 3 (2), 149-162.</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Aromatics)
str(Aromatics)
head(Aromatics)
</code></pre>

<hr>
<h2 id='BLS'>
Bivariate Least Square regression (BLS)</h2><span id='topic+BLS'></span>

<h3>Description</h3>

<p>Estimate the (homoscedastic) Bivariate Least Square regression with unreplicated or replicated data (in a (X,Y) plot).</p>


<h3>Usage</h3>

<pre><code class='language-R'>BLS(data = NULL, xcol = 1, ycol = 2, var.x = NULL, var.y = NULL,
    df.var.x = Inf, df.var.y = Inf, ratio.var = NULL, conf.level = 0.95,
    pred.level = 0.95, npoints = 1000, qx = 1, qy = 1, xpred = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BLS_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="BLS_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="BLS_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="BLS_+3A_var.x">var.x</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device X if known.</p>
</td></tr>
<tr><td><code id="BLS_+3A_var.y">var.y</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device Y if known.</p>
</td></tr>
<tr><td><code id="BLS_+3A_df.var.x">df.var.x</code></td>
<td>
<p> a numeric variable for the degrees of freedom of the variance of the measurement error of device X if known.</p>
</td></tr>
<tr><td><code id="BLS_+3A_df.var.y">df.var.y</code></td>
<td>
<p> a numeric variable for the degrees of freedom of the variance of the measurement error of device Y if known.</p>
</td></tr>
<tr><td><code id="BLS_+3A_ratio.var">ratio.var</code></td>
<td>
<p> a numeric value for &lambda;, the ratio of the measurement error variances (Y over X) if known.</p>
</td></tr>
<tr><td><code id="BLS_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="BLS_+3A_pred.level">pred.level</code></td>
<td>
<p> a numeric value for the predictive level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="BLS_+3A_npoints">npoints</code></td>
<td>
<p> an integer (at least 10) for the number of points to smooth the hyperbolic curves.</p>
</td></tr>
<tr><td><code id="BLS_+3A_qx">qx</code></td>
<td>
<p> an integer to predict the mean of qy Y future values from the mean of qx X values (generalized interval).</p>
</td></tr>
<tr><td><code id="BLS_+3A_qy">qy</code></td>
<td>
<p> an integer to predict the mean of qy Y future values from the mean of qx X values (generalized interval).</p>
</td></tr>
<tr><td><code id="BLS_+3A_xpred">xpred</code></td>
<td>
<p> a numeric vector for customized predictions at given X values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>data</code> argument is mandatory. If the data are unreplicated, then the measurement error variances must be given or their ratio (&lambda;). The confidence level is used for the confidence intervals of the parameters (&lambda;_{XY}, &beta; (slope), &alpha; (intercept)), the hyperbolic confidence intervals  (the prediction of the expectation of Y for a given X) and the hyperbolic confidence bands. The predictive level is used for the hyperbolic predictive intervals (the prediction of a future Y for a given X) and the hyperbolic generalized intervals (the prediction of the mean of qy future Y values from a given (mean of) X).
<br /> The results (<code>Xij</code>, <code>Yik</code>, <code>Xi</code>, <code>Yi</code>, <code>nxi</code>, <code>nyi</code>, <code>variances_x</code>, <code>variances_y</code>) are reordered according to the increasing values of Xi (the X mean values).
</p>


<h3>Value</h3>

<p>A BLS class object, a list including the following elements:
</p>
<table>
<tr><td><code>Xij</code></td>
<td>
<p> a table with the (replicated) X measurements (replicates are in columns).</p>
</td></tr>
<tr><td><code>Yik</code></td>
<td>
<p> a table with the (replicated) Y measurements (replicates are in columns).</p>
</td></tr>
<tr><td><code>Xi</code></td>
<td>
<p> a vector with the means of the X measurements.</p>
</td></tr>
<tr><td><code>Yi</code></td>
<td>
<p> a vector with the means of the Y measurements.</p>
</td></tr>
<tr><td><code>nxi</code></td>
<td>
<p> a vector with the number of X replicates per sample (patient).</p>
</td></tr>
<tr><td><code>nyi</code></td>
<td>
<p> a vector with the number of Y replicates per sample (patient).</p>
</td></tr>
<tr><td><code>variances_x</code></td>
<td>
<p> a vector with the variances calculated on the X replicates per sample (patient).</p>
</td></tr>
<tr><td><code>variances_y</code></td>
<td>
<p> a vector with the variances calculated on the Y replicates per sample (patient).</p>
</td></tr>
<tr><td><code>Lambda.XY</code></td>
<td>
<p> a table with the value of &lambda;XY and its confidence interval.</p>
</td></tr>
<tr><td><code>Ellipse.BLS</code></td>
<td>
<p> a two columns matrix with the coordinates of the joint confidence interval (confidence region, ellipse) for the parameters (&beta;, &alpha;).</p>
</td></tr>
<tr><td><code>Estimate.BLS</code></td>
<td>
<p> a table (data frame) with the estimates of the intercept and the slope, standard error, confidence interval and pvalue (null hypothesis: slope = 1, intercept = 0).</p>
</td></tr>
<tr><td><code>Pred.BLS</code></td>
<td>
<p> a data frame with <code>npoints</code> rows (from the minimum to the maximum of the observed X values) and the following columns: the X values where the predictions are calculated (X0), the Y predicted values (Ypred), the lower and upper bounds of the confidence intervals, predictive intervals, generalized intervals and confidence bands.</p>
</td></tr>
<tr><td><code>xpred.BLS</code></td>
<td>
<p> a data frame with the customized predictions and the same columns than <code>Pred.BLS</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br /> Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.</p>


<h3>See Also</h3>

<p><code><a href="#topic+CBLS">CBLS</a></code>, <code><a href="#topic+BLS.fit">BLS.fit</a></code>, <code><a href="#topic+BLS.ht">BLS.ht</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
# BLS regression on replicated data
res.BLS1=BLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10,qx=3,qy=3,xpred=c(100,120,140,160))
# BLS regression on unreplicated data with measurement error variances previously estimated
res.BLS2=BLS(data=SBP,xcol=c("J1"),ycol="S1",var.x=80,var.y=50,df.var.x=100,df.var.y=100)
</code></pre>

<hr>
<h2 id='BLS.fit'>
Fit a Bivariate Least Square regression (BLS): estimates table</h2><span id='topic+BLS.fit'></span>

<h3>Description</h3>

<p>Estimate the (homoscedastic) Bivariate Least Square regression with unreplicated or replicated data: provide the estimates table</p>


<h3>Usage</h3>

<pre><code class='language-R'>BLS.fit(data = NULL, xcol = 1, ycol = 2, var.x = NULL, var.y = NULL,
    ratio.var = NULL, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BLS.fit_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="BLS.fit_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="BLS.fit_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="BLS.fit_+3A_var.x">var.x</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device X if known.</p>
</td></tr>
<tr><td><code id="BLS.fit_+3A_var.y">var.y</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device Y if known.</p>
</td></tr>
<tr><td><code id="BLS.fit_+3A_ratio.var">ratio.var</code></td>
<td>
<p> a numeric value for &lambda;, the ratio of the measurement error variances (Y over X) if known.</p>
</td></tr>
<tr><td><code id="BLS.fit_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>data</code> argument is mandatory. If the data are unreplicated, then the measurement error variances must be given or their ratio (&lambda;). The confidence level is used for the confidence intervals of the parameters (&beta; (slope), &alpha; (intercept)).
</p>


<h3>Value</h3>

<p>A table with the estimates of the intercept and the slope, standard error, confidence interval and pvalue (null hypothesis: slope = 1, intercept = 0).
</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br /> Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BLS">BLS</a></code>, <code><a href="#topic+CBLS">CBLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
# BLS regression on replicated data
res1=BLS.fit(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# BLS regression on unreplicated data with measurement error variances previously estimated
res2=BLS.fit(data=SBP,xcol="J1",ycol="S1",var.x=80,var.y=50)
</code></pre>

<hr>
<h2 id='BLS.ht'>
Bivariate Least Square regression (BLS)</h2><span id='topic+BLS.ht'></span>

<h3>Description</h3>

<p>Estimate the heteroscedastic Bivariate Least Square regression with replicated data or variance functions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BLS.ht(data = NULL, xcol = NULL, ycol = NULL, var.x.col = NULL, var.y.col = NULL,
       var.x.formula = NULL, var.y.formula = NULL, nxi.col = NULL, nyi.col = NULL,
       df.var.x.col = NULL, df.var.y.col = NULL, conf.level = 0.95, pred.level = 0.95,
       npoints = 1000, qx = 1, qy = 1, xpred = NULL, tol = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BLS.ht_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_var.x.col">var.x.col</code></td>
<td>
<p> a numeric or character variable to specify the column with the heteroscedastic variances of X.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_var.y.col">var.y.col</code></td>
<td>
<p> a numeric or character variable to specify the column with the heteroscedastic variances of Y.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_var.x.formula">var.x.formula</code></td>
<td>
<p> a character string with a formula related to X that will be interpreted as a variance function, i.e. var.x.formula=&quot;exp(2*X+3)&quot;.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_var.y.formula">var.y.formula</code></td>
<td>
<p> a character string with a formula related to Y that will be interpreted as a variance function, i.e. var.y.formula=&quot;exp(2*Y+3)&quot;.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_nxi.col">nxi.col</code></td>
<td>
<p> a numeric or character variable to specify the column with the number of replicates in X on which the variances were calculated.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_nyi.col">nyi.col</code></td>
<td>
<p> a numeric or character variable to specify the column with the number of replicates in Y on which the variances were calculated.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_df.var.x.col">df.var.x.col</code></td>
<td>
<p> a numeric or character variable to specify the column with the degrees of freedom of the heteroscedastic variances in X.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_df.var.y.col">df.var.y.col</code></td>
<td>
<p> a numeric or character variable to specify the column with the degrees of freedom of the heteroscedastic variances in Y.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_pred.level">pred.level</code></td>
<td>
<p> a numeric value for the predictive level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_npoints">npoints</code></td>
<td>
<p> an integer (at least 10) for the number of points to smooth the hyperbolic curves.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_qx">qx</code></td>
<td>
<p> an integer to predict the mean of qy Y future values from the mean of qx X values (generalized interval).</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_qy">qy</code></td>
<td>
<p> an integer value to predict the mean of qy Y future values from the mean of qx X values (generalized interval).</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_xpred">xpred</code></td>
<td>
<p> a numeric vector for customized predictions at given X values.</p>
</td></tr>
<tr><td><code id="BLS.ht_+3A_tol">tol</code></td>
<td>
<p> a numeric variable to change the tolerance for the BLS to converge.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data argument is mandatory. If the data are unreplicated, then the measurement error variances must be given. The confidence level is used for the confidence intervals of the parameters (&beta;, &alpha;), the hyperbolic confidence intervals  (the prediction of the expectation of Y for a given X) and the hyperbolic confidence bands. The predictive level is used for the hyperbolic predictive intervals (the prediction of a future Y for a given X) and the hyperbolic generalized intervals (the prediction of the mean of qy future Y values from a given (mean of) X).
<br /> The results (<code>Xij</code>, <code>Yik</code>, <code>Xi</code>, <code>Yi</code>, <code>nxi</code>, <code>nyi</code>, <code>variances_x</code>, <code>variances_y</code>) are reordered according to the increasing values of Xi (the X mean values).
</p>


<h3>Value</h3>

<p>A BLS.ht class object, a list including the following elements:
</p>
<table>
<tr><td><code>Xij</code></td>
<td>
<p> a table with the (replicated) X measurements (replicates are in columns).</p>
</td></tr>
<tr><td><code>Yik</code></td>
<td>
<p> a table with the (replicated) Y measurements (replicates are in columns).</p>
</td></tr>
<tr><td><code>Xi</code></td>
<td>
<p> a vector with the means of the X measurements.</p>
</td></tr>
<tr><td><code>Yi</code></td>
<td>
<p> a vector with the means of the Y measurements.</p>
</td></tr>
<tr><td><code>nxi</code></td>
<td>
<p> a vector with the number of X replicates per sample (patient).</p>
</td></tr>
<tr><td><code>nyi</code></td>
<td>
<p> a vector with the number of Y replicates per sample (patient).</p>
</td></tr>
<tr><td><code>variances_x</code></td>
<td>
<p> a vector with the variances calculated on the X replicates per sample (patient).</p>
</td></tr>
<tr><td><code>variances_y</code></td>
<td>
<p> a vector with the variances calculated on the Y replicates per sample (patient).</p>
</td></tr>
<tr><td><code>Ellipse.BLS.ht</code></td>
<td>
<p> a two columns matrix with the coordinates of the joint confidence interval  (confidence region, ellipse) for the parameters (&beta;, &alpha;).</p>
</td></tr>
<tr><td><code>Estimate.BLS.ht</code></td>
<td>
<p> a table (data frame) with the estimates of the intercept and the slope, standard error, confidence interval and pvalue (null hypothesis: slope = 1, intercept = 0).</p>
</td></tr>
<tr><td><code>Pred.BLS.ht</code></td>
<td>
<p> a data frame with npoints rows (from the minimum to the maximum of the observed X values) and the following columns: the X values where the predictions are calculated (X0), the Y predicted values (Ypred), the lower and upper bounds of the confidence interval, predictive interval, generalized interval and confidence bands.</p>
</td></tr>
<tr><td><code>xpred.BLS.ht</code></td>
<td>
<p> a data frame with the customized predictions and the same columns than <code>Pred.BLS.ht</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The prediction interval should be interpreted with caution as it is still under development.
</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG. Errors-in-variables regressions to assess equivalence in method comparison studies. Ph.D. Thesis, Universite Catholique de Louvain, Institute of Statistics, Biostatistics and Actuarial science, Louvain-la-Neuve, Belgium, 2013.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BLS">BLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
res.BLS.ht=BLS.ht(data=SBP,xcol=c("J1","J2","J3"),ycol=c("S1","S2","S3"))
</code></pre>

<hr>
<h2 id='CBLS'>
Correlated Bivariate Least Square regression (CBLS)</h2><span id='topic+CBLS'></span>

<h3>Description</h3>

<p>Estimate the Correlated Bivariate Least Square regression with replicated data (in a (M,D) plot) where M=(X+Y)/2 and D=Y-X.</p>


<h3>Usage</h3>

<pre><code class='language-R'>CBLS(data = NULL, xcol = 1, ycol = 2, var.x = NULL, var.y = NULL,
     df.var.x = Inf, df.var.y = Inf, ratio.var = NULL, conf.level = 0.95,
     pred.level = 0.95, npoints = 1000, qx = 1, qy = 1, xpred = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CBLS_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="CBLS_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="CBLS_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="CBLS_+3A_var.x">var.x</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device X if known.</p>
</td></tr>
<tr><td><code id="CBLS_+3A_var.y">var.y</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device Y if known.</p>
</td></tr>
<tr><td><code id="CBLS_+3A_df.var.x">df.var.x</code></td>
<td>
<p> a numeric variable for the degrees of freedom of the variance of the measurement error of device X if known.</p>
</td></tr>
<tr><td><code id="CBLS_+3A_df.var.y">df.var.y</code></td>
<td>
<p> a numeric variable for the degrees of freedom of the variance of the measurement error of device Y if known.</p>
</td></tr>
<tr><td><code id="CBLS_+3A_ratio.var">ratio.var</code></td>
<td>
<p> a numeric value for &lambda;, the ratio of the measurement error variances (Y over X) if known.</p>
</td></tr>
<tr><td><code id="CBLS_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="CBLS_+3A_pred.level">pred.level</code></td>
<td>
<p> a numeric value for the predictive level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="CBLS_+3A_npoints">npoints</code></td>
<td>
<p> an integer (at least 10) for the number of points to smooth the hyperbolic curves.</p>
</td></tr>
<tr><td><code id="CBLS_+3A_qx">qx</code></td>
<td>
<p> an integer to predict the mean of qy Y future values from the mean of qx X values (generalized interval).</p>
</td></tr>
<tr><td><code id="CBLS_+3A_qy">qy</code></td>
<td>
<p> an integer to predict the mean of qy Y future values from the mean of qx X values (generalized interval).</p>
</td></tr>
<tr><td><code id="CBLS_+3A_xpred">xpred</code></td>
<td>
<p> a numeric vector for customized predictions at given M values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data argument is mandatory. If the data are unreplicated, then the measurement error variances must be given or their ratio (&lambda;) in order to calculate the correlation, &rho;_{MD}, between the measurement errors of the differences (on the Y-axis) and the measurement errors of the means (on the X-axis). The confidence level is used for the confidence intervals of the parameters (&rho;_{MD}, &beta; (slope), &alpha; (intercept)), the hyperbolic confidence intervals  (the prediction of the expectation of Y for a given X) and the hyperbolic confidence bands. The predictive level is used for the hyperbolic predictive intervals (the prediction of a future Y for a given X) and the hyperbolic generalized intervals (the prediction of the mean of q future Y values for a given X).
</p>


<h3>Value</h3>

<p>A CBLS class object, a list including the following elements:
</p>
<table>
<tr><td><code>Xij</code></td>
<td>
<p> a table with the (replicated) X measurements (replicates are in columns).</p>
</td></tr>
<tr><td><code>Yik</code></td>
<td>
<p> a table with the (replicated) Y measurements (replicates are in columns).</p>
</td></tr>
<tr><td><code>Xi</code></td>
<td>
<p> a vector with the means of the X measurements.</p>
</td></tr>
<tr><td><code>Yi</code></td>
<td>
<p> a vector with the means of the Y measurements.</p>
</td></tr>
<tr><td><code>Mi</code></td>
<td>
<p> a vector with the means ((X+Y)/2) measurements.</p>
</td></tr>
<tr><td><code>Di</code></td>
<td>
<p> a vector with the differences (Y-X) measurements.</p>
</td></tr>
<tr><td><code>nxi</code></td>
<td>
<p> a vector with the number of X replicates per sample (patient).</p>
</td></tr>
<tr><td><code>nyi</code></td>
<td>
<p> a vector with the number of Y replicates per sample (patient).</p>
</td></tr>
<tr><td><code>variances_x</code></td>
<td>
<p> a vector with the variances calculated on the X replicates per sample (patient).</p>
</td></tr>
<tr><td><code>variances_y</code></td>
<td>
<p> a vector with the variances calculated on the Y replicates per sample (patient).</p>
</td></tr>
<tr><td><code>Rho.MD</code></td>
<td>
<p> a table with the value of &rho;MD (the correlation between the measurement errors of the means and the differences) and its confidence interval.</p>
</td></tr>
<tr><td><code>Ellipse.CBLS</code></td>
<td>
<p> a two columns matrix with the coordinates of the joint confidence interval (confidence region, ellipse) for the parameters (&beta;, &alpha;).</p>
</td></tr>
<tr><td><code>Estimate.CBLS</code></td>
<td>
<p> a table (data frame) with the estimates of the intercept and the slope, standard error, confidence interval and pvalue (null hypothesis: slope = 0, intercept = 0).</p>
</td></tr>
<tr><td><code>Pred.CBLS</code></td>
<td>
<p> a data frame with npoints rows (from the minimum to the maximum of the observed X values) and the following columns: the X values where the predictions are calculated (X0), the Y predicted values (Ypred), the lower and upper bounds of the confidence interval, predictive interval, generalized interval and confidence bands.</p>
</td></tr>
<tr><td><code>xpred.CBLS</code></td>
<td>
<p> a data frame with the customized predictions and the same columns than <code>Pred.CBLS</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BLS">BLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
# CBLS regression on replicated data
res.CBLS1=CBLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10,qx=3,qy=3,xpred=c(100,120,140,160))
# CBLS regression on unreplicated data with measurement error variances previously estimated
res.CBLS2=CBLS(data=SBP,xcol=c("J1"),ycol="S1",var.x=80,var.y=50,df.var.x=100,df.var.y=100)
</code></pre>

<hr>
<h2 id='CBLS.fit'>
Fit a Correlated Bivariate Least Square regression (CBLS): estimates table</h2><span id='topic+CBLS.fit'></span>

<h3>Description</h3>

<p>Estimate the Correlated Bivariate Least Square regression with replicated data in a (M,D) plot (Bland-Altman) where M=(X+Y)/2 and D=Y-X, provide the estimates table.</p>


<h3>Usage</h3>

<pre><code class='language-R'>CBLS.fit(data = NULL, xcol = 1, ycol = 2, var.x = NULL, var.y = NULL,
     ratio.var = NULL, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CBLS.fit_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="CBLS.fit_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="CBLS.fit_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="CBLS.fit_+3A_var.x">var.x</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device X if known.</p>
</td></tr>
<tr><td><code id="CBLS.fit_+3A_var.y">var.y</code></td>
<td>
<p> a numeric variable for the variance of the measurement error of device Y if known.</p>
</td></tr>
<tr><td><code id="CBLS.fit_+3A_ratio.var">ratio.var</code></td>
<td>
<p> a numeric value for &lambda;, the ratio of the measurement error variances (Y over X) if known.</p>
</td></tr>
<tr><td><code id="CBLS.fit_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data argument is mandatory. If the data are unreplicated, then the measurement error variances must be given or their ratio (&lambda;) in order to calculate the correlation, &rho;_{MD}, between the measurement errors of the differences (on the Y-axis) and the measurement errors of the means (on the X-axis). The confidence level is used for the confidence intervals of the parameters (&rho;_{MD}, &beta; (slope), &alpha; (intercept)).
</p>


<h3>Value</h3>

<p>A table with the estimates of the intercept and the slope, standard error, confidence interval and pvalue (null hypothesis: slope = 0, intercept = 0).
</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BLS">BLS</a></code>, <code><a href="#topic+CBLS">CBLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
# CBLS regression on replicated data
res1=CBLS.fit(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# CBLS regression on unreplicated data with measurement error variances previously estimated
res2=CBLS.fit(data=SBP,xcol=c("J1"),ycol="S1",var.x=80,var.y=50)
</code></pre>

<hr>
<h2 id='desc.stat'>
Descriptive statistics in method comparison studies</h2><span id='topic+desc.stat'></span>

<h3>Description</h3>

<p>Calculate several descriptive statistics in method comparison studies per device (X and Y) and per type of samples.</p>


<h3>Usage</h3>

<pre><code class='language-R'>desc.stat(data = NULL, xcol = 1, ycol = 2, IDcol = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="desc.stat_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="desc.stat_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="desc.stat_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="desc.stat_+3A_idcol">IDcol</code></td>
<td>
<p> a numeric or character variable to specify the column with the different IDs or type of samples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>IDcol</code> is null (as by default), the descriptive statistics are calculated for X and Y. Otherwise, the descriptive statistics are calculated for X and Y for each type of sample (each ID) (with a maximum of 30 different IDs). This information is also used to differentiate the observations on a raw plot when the function <code><a href="#topic+raw.plot">raw.plot</a></code> is used. In presence of missing values on X or Y and non-replicates, the rows with missing values are removed. In presence of replicates, the rows with missing values are removed if all Xi or all Yi are missing. 
<br /> The results (<code>Xij</code>, <code>Yik</code>, <code>Xi</code>, <code>Yi</code>, <code>nxi</code>, <code>nyi</code>, <code>variances_x</code>, <code>variances_y</code>) are reordered according to the increasing values of Xi (the X mean values).</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>Xij</code></td>
<td>
<p> a table with the (replicated) X measurements (replicates are in columns).</p>
</td></tr>
<tr><td><code>Yik</code></td>
<td>
<p> a table with the (replicated) Y measurements (replicates are in columns).</p>
</td></tr>
<tr><td><code>Xi</code></td>
<td>
<p> a vector with the means of the X measurements.</p>
</td></tr>
<tr><td><code>Yi</code></td>
<td>
<p> a vector with the means of the Y measurements.</p>
</td></tr>
<tr><td><code>IDs</code></td>
<td>
<p> a vector with the different IDs.</p>
</td></tr>
<tr><td><code>nxi</code></td>
<td>
<p> a vector with the number of X replicates per sample (patient).</p>
</td></tr>
<tr><td><code>nyi</code></td>
<td>
<p> a vector with the number of Y replicates per sample (patient).</p>
</td></tr>
<tr><td><code>variances_x</code></td>
<td>
<p> a vector with the variances calculated on the X replicates per sample (patient).</p>
</td></tr>
<tr><td><code>variances_y</code></td>
<td>
<p> a vector with the variances calculated on the Y replicates per sample (patient).</p>
</td></tr>
<tr><td><code>Order.Xi</code></td>
<td>
<p> a vector with the order of the means of the X replicates.</p>
</td></tr>
<tr><td><code>statistics</code></td>
<td>
<p> a table with different descriptive statistics per type of sample (rows): the number of sample (patient), the number of replicates in X and Y, the degrees of freedom of the measurement error variances in X and Y, the mean, the sum of squares (Sxx and Syy), the cross-product (Sxy), the variance, minimum, 1st quartile, median, 3rd quartile, maximum for X and Y, and the Pearson correlation coefficient and its square.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br /> Francq BG. Errors-in-variables regressions to assess equivalence in method comparison studies. Ph.D. Thesis, Universite Catholique de Louvain, Institute of Statistics, Biostatistics and Actuarial science, Louvain-la-Neuve, Belgium, 2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lambdas">lambdas</a></code>, <code><a href="#topic+raw.plot">raw.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(Aromatics)
res=desc.stat(data=Aromatics,xcol=3,ycol=4,IDcol=2)
</code></pre>

<hr>
<h2 id='df.WS'>
Degrees of freedom by Welch-Satterthwaite
</h2><span id='topic+df.WS'></span>

<h3>Description</h3>

<p>Calculate the degrees of freedom from the Welch-Satterthwaite equation for a linear combination of sample variances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.WS(variances = NULL, k = rep(1, length(variances)), dfs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df.WS_+3A_variances">variances</code></td>
<td>
<p> a numeric vector for the variances.</p>
</td></tr>
<tr><td><code id="df.WS_+3A_k">k</code></td>
<td>
<p> a numeric vector with the multiplicative constants.</p>
</td></tr>
<tr><td><code id="df.WS_+3A_dfs">dfs</code></td>
<td>
<p> a numeric vector with the degrees of freedom of each variance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>variances</code> argument is mandatory while other arguments are optional.
</p>


<h3>Value</h3>

<p>A numeric variable with the degrees of freedom of the linear combination of the variances.
</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Satterthwaite FE. An Approximate Distribution of Estimates of Variance Components. Biometrics Bulletin, 1946, 2: 110-114.
<br /> Welch BK. The generalization of &quot;student's&quot; problem when several different population variances are involved. Biometrika, 1947, 34: 28-35.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df.WS(variances=c(10,15,20),k=c(1.5,2,1.3),dfs=c(8,13,11))
</code></pre>

<hr>
<h2 id='DR'>Deming Regression</h2><span id='topic+DR'></span>

<h3>Description</h3>

<p>Estimate the Deming Regression (DR) with unreplicated or replicated data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DR(data = NULL, xcol = 1, ycol = 2, ratio.var = NULL, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DR_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="DR_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="DR_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="DR_+3A_ratio.var">ratio.var</code></td>
<td>
<p> a numeric value for &lambda; the ratio of the measurement error variances (Y over X) if known. Otherwise, it may be estimated with replicated data.</p>
</td></tr>
<tr><td><code id="DR_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The BLS regression is more general and includes the Deming Regression. The BLS regression provides more results and should, therefore, be used instead of DR.</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>Ellipse.DR</code></td>
<td>
<p> a two columns matrix with the coordinates of the joint confidence interval (confidence region, ellipse) for the parameters (&beta;, &alpha;).</p>
</td></tr>
<tr><td><code>Estimate.DR</code></td>
<td>
<p> a table (data frame) with the estimates of the intercept and the slope, standard error, confidence interval and pvalue (null hypothesis: slope = 1, intercept = 0). The exact confidence interval for the slope is also given.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems 2014; 134:123-139.
<br /> Tan CY, Iglewicz B. Measurement-methods comparisons and linear statistical relationship. Technometrics, 1999; 41(3):192-201.</p>


<h3>See Also</h3>

<p><code><a href="#topic+BLS">BLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
res.DR=DR(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
res.DR$Estimate.DR
data(Aromatics)
res.DR=DR(data=Aromatics,xcol=3,ycol=4,ratio.var=2)
</code></pre>

<hr>
<h2 id='FullCIs.MD'>
Confidence Intervals by CBLS with all potential solutions</h2><span id='topic+FullCIs.MD'></span>

<h3>Description</h3>

<p>Estimate the Correlated-Bivariate-Least Square regression (CBLS) for all potential solutions from &rho;MD=-1 to &rho;MD=1, in a (M,D) plot. This function is analogous to <code><a href="#topic+FullCIs.XY">FullCIs.XY</a></code> estimating all the BLS regressions from OLSv to OLSh in a (X,Y) plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FullCIs.MD(data = NULL, xcol = 1, ycol = 2,
           conf.level = 0.95, npoints = 1000, nlambdas = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FullCIs.MD_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="FullCIs.MD_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="FullCIs.MD_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="FullCIs.MD_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="FullCIs.MD_+3A_npoints">npoints</code></td>
<td>
<p> an integer (at least 10) for the number of points to smooth the hyperbolic curves.</p>
</td></tr>
<tr><td><code id="FullCIs.MD_+3A_nlambdas">nlambdas</code></td>
<td>
<p>an integer for the number of intermediate CBLS regressions (the two extreme CBLS are calculated by default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data argument is mandatory. This function is especially useful for unreplicated data with unknown &rho;MD (related to &lambda;XY, the ratio of the measurement error variances), as it calculates all the potential solutions. The different estimated regression lines are provided with the different confidence intervals.</p>


<h3>Value</h3>

<p>A CIs.MD class object, a list including the following elements:
</p>
<table>
<tr><td><code>Data.means</code></td>
<td>
<p> a table with the X and Y data (means of the replicated data if replicated), their means and differences.</p>
</td></tr>
<tr><td><code>Ellipses.CB</code></td>
<td>
<p> an array of dimension [<code>npoints</code>, 2 (intercept and slope), <code>nlambdas</code> + 2] with the coordinates of all the joint confidence intervals (confidence region, ellipses) from &rho;MD = -1 to &rho;MD = 1.</p>
</td></tr>
<tr><td><code>Slopes</code></td>
<td>
<p> a table (<code>nlambdas</code> + 2 rows) with all the slopes estimates and their approximate confidence intervals and pvalue (slope = 0).</p>
</td></tr>
<tr><td><code>Intercepts</code></td>
<td>
<p> a table (<code>nlambdas</code> + 2 rows) with all the intercepts estimates and their approximate confidence intervals and pvalue (intercept = 0).</p>
</td></tr>
<tr><td><code>Joints</code></td>
<td>
<p> a table (<code>nlambdas</code> + 2 rows) with all the pvalues of the joint hypothesis (slope = 0 and intercept = 0).</p>
</td></tr>
<tr><td><code>Hyperbolic.intervals</code></td>
<td>
<p> an array of dimension [<code>npoints</code>, 6 (X values, Y predictions, confidence interval and confidence bands), <code>nlambdas</code> + 2] with the hyperbolic confidence interval and confidence bands.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FullCIs.XY">FullCIs.XY</a></code>, <code><a href="#topic+CBLS">CBLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(Aromatics)
res.full=FullCIs.MD(data=Aromatics,xcol=3,ycol=4)
</code></pre>

<hr>
<h2 id='FullCIs.XY'>
Confidence Intervals from OLSv to OLSh by DR and BLS</h2><span id='topic+FullCIs.XY'></span>

<h3>Description</h3>

<p>Estimate the vertical and horizontal Ordinary least Square regressions, and several 'intermediate' Deming Regression (DR) and Bivariate Least Square (BLS), in a (X,Y) plot. The OLSv assumes no error on the X axis (&lambda;=Infinity), while the OLSh assumes no error on the Y axis (&lambda;=0). These two regressions are therefore 'extreme' regressions, while DR and BLS assume errors on both axes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FullCIs.XY(data = NULL, xcol = 1, ycol = 2,
           conf.level = 0.95, npoints = 1000, nlambdas = 13)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FullCIs.XY_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="FullCIs.XY_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="FullCIs.XY_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="FullCIs.XY_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="FullCIs.XY_+3A_npoints">npoints</code></td>
<td>
<p> an integer (at least 10) for the number of points to smooth the hyperbolic curves.</p>
</td></tr>
<tr><td><code id="FullCIs.XY_+3A_nlambdas">nlambdas</code></td>
<td>
<p>an integer for the number of intermediate DR and BLS regressions (between the OLSv and OLSh).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data argument is mandatory. This function is especially useful for unreplicated data with unknown &lambda; (the ratio of the measurement error variances), as it calculates all the potential solutions from OLSv to OLSh. The different estimated regression lines are provided with the different confidence intervals.</p>


<h3>Value</h3>

<p>A CIs.XY class object, a list including the following elements:
</p>
<table>
<tr><td><code>Data.means</code></td>
<td>
<p> a table with the X and Y data (means of the replicated data if replicated).</p>
</td></tr>
<tr><td><code>Ellipses.CB</code></td>
<td>
<p> an array of dimension [<code>npoints</code>, 2 (intercept and slope), <code>nlambdas</code> + 2] with the coordinates of all the joint confidence intervals (confidence region, ellipses) from OLSv to OLSh.</p>
</td></tr>
<tr><td><code>Slopes</code></td>
<td>
<p> a table (<code>nlambdas</code> + 2 rows) with all the slopes estimates from OLSv to OLSh including <code>nlambdas</code> intermediate values, the exact and approximate confidence intervals and pvalue (slope = 1).</p>
</td></tr>
<tr><td><code>Intercepts</code></td>
<td>
<p> a table (<code>nlambdas</code> + 2 rows) with all the intercepts estimates from OLSv to OLSh including <code>nlambdas</code> intermediate values, the approximate confidence intervals and pvalue (intercept = 0).</p>
</td></tr>
<tr><td><code>Joints</code></td>
<td>
<p> a table (<code>nlambdas</code> + 2 rows) with all the pvalues of the joint hypothesis (slope = 1 and intercept = 0) from OLSv to OLSh including intermediate <code>nlambdas</code> values.</p>
</td></tr>
<tr><td><code>Hyperbolic.intervals</code></td>
<td>
<p> an array of dimension [npoints, 6 (X values, Y predictions, confidence interval and confidence bands),nlambdas+2] with the hyperbolic confidence intervals and confidence bands from OLSv to OLSh including <code>nlambdas</code> intermediate values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.</p>


<h3>See Also</h3>

<p><code><a href="#topic+FullCIs.MD">FullCIs.MD</a></code>, <code><a href="#topic+BLS">BLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(Aromatics)
res.full=FullCIs.XY(data=Aromatics,xcol=3,ycol=4)
</code></pre>

<hr>
<h2 id='GraphFullCIs.MD'>
Plot all the CBLS potential solutions</h2><span id='topic+GraphFullCIs.MD'></span>

<h3>Description</h3>

<p>Display a plot with all the CBLS potential solutions in a (M,D) plot from &rho;_{MD} = -1 to &rho;_{MD} = 1 (useful for unreplicated data), choose between all the slopes (and their confidence intervals), all the intercepts (and their confidence intervals), all the confidence regions (ellipses), the two extreme confidence intervals (for the expectation of Y) or the two extreme confidence bands.</p>


<h3>Usage</h3>

<pre><code class='language-R'>GraphFullCIs.MD(FullCIs = NULL, CBLS.estimate = NULL, lambda = NULL,
                xname = "X", yname = "Y", antilog = NULL, graph = "joint.ellipse",
                accept.int = 0, accept.int.perc = FALSE, accept.int.threshold = NULL,
                include.H0 = TRUE, include.int = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GraphFullCIs.MD_+3A_fullcis">FullCIs</code></td>
<td>
<p> a CIs.MD class object.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_cbls.estimate">CBLS.estimate</code></td>
<td>
<p> a <code>CBLS</code> class object. The CBLS estimates (obtained, for example, with replicated data) will be superimposed on the plot.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_lambda">lambda</code></td>
<td>
<p>a lambdas class object. The value of &lambda; (ratio of the error measurement variances) will be converted to &rho; (correlation between the error measurement) and superimposed on the plot with its confidence interval.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_xname">xname</code></td>
<td>
<p> a character string for the name of the X device.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_yname">yname</code></td>
<td>
<p> a character string for the name of the Y device.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_antilog">antilog</code></td>
<td>
<p> a character string or a numeric value. This argument displays the CBLS results on the initial scales on the (M,D) plot if a logarithmic transformation was used prior to the CBLS function. Options available are: 10 or &quot;e&quot;.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_graph">graph</code></td>
<td>
<p> a character string for the type of graph: &quot;slope&quot; to plot all the slopes, &quot;intercept&quot; to plot all the intercepts,&quot;joint.ellipse&quot; to plot all the joint confidence intervals (ellipses), &quot;CI&quot; to plot the confidence intervals,&quot;CB&quot; to plot the confidence bands, &quot;all&quot; to plot all the plots on different windows.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_accept.int">accept.int</code></td>
<td>
<p> a numeric vector (length equal 1 or 2) for the value of &Delta;: |Y-X|&lt;&Delta; to assess whether two devices (X and Y) are equivalent or not. Two values of &Delta; can be entered to take into account the case where the equivalence threshold changes along the M axis.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_accept.int.perc">accept.int.perc</code></td>
<td>
<p> a logical variable (TRUE or FALSE) whether &Delta; needs to be interpreted in percentage: Y = X &#177; &Delta; %.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_accept.int.threshold">accept.int.threshold</code></td>
<td>
<p> a numeric value for the M threshold where the value of &Delta; changes if two &Delta; values are used in <code>accept.int</code>.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_include.h0">include.H0</code></td>
<td>
<p>a logical variable (TRUE or FALSE) whether the null hypothesis (slope = 0, intercept = 0) should lie on plot (in the case that the null hypothesis is out from the axes limits).</p>
</td></tr>
<tr><td><code id="GraphFullCIs.MD_+3A_include.int">include.int</code></td>
<td>
<p>a logical variable (TRUE or FALSE) whether the confidence intervals should lie entirely in the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ellipses are plotted in an (&beta;,&alpha;) coordinate system where the acceptance interval is a diamond. The slopes and the intercepts are plotted on the Y-axis with &rho; assigned on the X-axis. The confidence intervals and confidence bands are displayed on a (M,D) plot (Bland-Altman plot).</p>


<h3>Value</h3>

<p> The plot requested by the argument <code>graph</code>.</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br /> Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.</p>


<h3>See Also</h3>

<p><code><a href="#topic+MD.plot">MD.plot</a></code>, <code><a href="#topic+CBLS">CBLS</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
# Estimate all the solutions with the CBLS regression
res.full=FullCIs.MD(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Estimate the CBLS regression with replicated data
res.CBLS=CBLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Estimate the measurement error variances ratio
res.lambda=lambdas(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Plot all the results with all the potential solutions
#   and superimpose the CBLS regression estimated with replicated data
GraphFullCIs.MD(FullCIs=res.full,CBLS.estimate=res.CBLS,lambda=res.lambda,
                xname="J",yname="S",graph="all",accept.int=10,accept.int.perc=FALSE,include.H0=TRUE)
data(Aromatics)
# Estimate all the solutions with the CBLS regression
res.full=FullCIs.MD(data=Aromatics,xcol=3,ycol=4)
# Plot all the potential solutions for the confidence regions (ellipses)
GraphFullCIs.MD(FullCIs=res.full,xname="HPLC",yname="GC MS",graph="joint.ellipse")
# Plot all the potential solutions for the confidence intervals and add two acceptance intervals
GraphFullCIs.MD(FullCIs=res.full,xname="HPLC",yname="GC MS",graph="CI",
                accept.int=c(0.1,0.2),accept.int.threshold=15)
</code></pre>

<hr>
<h2 id='GraphFullCIs.XY'>
Plot all the DR and BLS potential solutions</h2><span id='topic+GraphFullCIs.XY'></span>

<h3>Description</h3>

<p>Display a plot with all the DR and BLS potential solutions from OLSv to OLSh (useful for unreplicated data), choose between all the slopes (and their confidence intervals), all the intercepts (and their confidence intervals), all the confidence region (ellipses), the two extreme confidence intervals (for the expectation of Y) or the two extreme confidence bands.</p>


<h3>Usage</h3>

<pre><code class='language-R'>GraphFullCIs.XY(FullCIs = NULL, BLS.estimate = NULL, lambda = NULL,
                xname = "X", yname = "Y", antilog = NULL, graph = "joint.ellipse",
                accept.int = 0, accept.int.perc = FALSE, accept.int.threshold = NULL,
                include.H0 = TRUE, include.int = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GraphFullCIs.XY_+3A_fullcis">FullCIs</code></td>
<td>
<p> a CIs.XY class object.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_bls.estimate">BLS.estimate</code></td>
<td>
<p>a BLS class object. The BLS estimates (obtained, for example, with replicated data) will be superimposed on the plot.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_lambda">lambda</code></td>
<td>
<p>a lambdas class object. The value of &lambda;_{XY} will be superimposed on the plot with its confidence interval.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_xname">xname</code></td>
<td>
<p> a character string for the name of the X device.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_yname">yname</code></td>
<td>
<p> a character string for the name of the Y device.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_antilog">antilog</code></td>
<td>
<p> a character string or a numeric value. This argument displays the BLS results on the initial scales on the (X,Y) plot if a logarithmic transformation was used prior to the BLS function. Options available are: 10 or &quot;e&quot;.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_graph">graph</code></td>
<td>
<p> a character string for the type of graph: &quot;slope&quot; to plot all the slopes, &quot;intercept&quot; to plot all the intercepts,&quot;joint.ellipse&quot; to plot all the joint confidence intervals (ellipses), &quot;CI&quot; to plot the confidence intervals,&quot;CB&quot; to plot the confidence bands, &quot;all&quot; to plot all the plots on different windows.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_accept.int">accept.int</code></td>
<td>
<p> a numeric vector (length equal 1 or 2) for the value of &Delta;: Y = X &#177; &Delta; to assess whether the two devices (X and Y) are equivalent or not. Two values of &Delta; can be entered to take into account the case where the equivalence threshold changes along the X axis.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_accept.int.perc">accept.int.perc</code></td>
<td>
<p> a logical variable (TRUE or FALSE) whether &Delta; needs to be interpreted in percentage: Y = X &#177; &Delta;%.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_accept.int.threshold">accept.int.threshold</code></td>
<td>
<p> a numeric value for the X threshold where the value of &Delta; changes if two &Delta; values are used in <code>accept.int</code>.</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_include.h0">include.H0</code></td>
<td>
<p>a logical variable (TRUE or FALSE) whether the null hypothesis (slope = 1, intercept = 0) should lie on plot (in the case that the null hypothesis is out from the axes limits).</p>
</td></tr>
<tr><td><code id="GraphFullCIs.XY_+3A_include.int">include.int</code></td>
<td>
<p>a logical variable (TRUE or FALSE) whether the confidence intervals should lie entirely in the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ellipses are plotted in an (&beta;,&alpha;) coordinate system where the acceptance interval is a diamond. The slopes and the intercepts are plotted on the Y-axis with &lambda;_{XY} assigned on the X-axis. The confidence intervals and confidence bands are displayed on a classical (X,Y) plot.</p>


<h3>Value</h3>

<p> The plot requested by the argument <code>graph</code>.</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.</p>


<h3>See Also</h3>

<p><code><a href="#topic+XY.plot">XY.plot</a></code>, <code><a href="#topic+BLS">BLS</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
# Estimate all the solutions with the DR and BLS regressions
res.full=FullCIs.XY(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Estimate the BLS regression with replicated data
res.BLS=BLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Estimate the measurement error variances ratio
res.lambda=lambdas(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Plot all the results with all the potential solutions
#   and superimpose the BLS regression estimated with replicated data
GraphFullCIs.XY(FullCIs=res.full,BLS.estimate=res.BLS,lambda=res.lambda,
                xname="J",yname="S",graph="all",accept.int=10,accept.int.perc=FALSE,include.H0=TRUE)
# Plot all the potential solutions for the confidence intervals and add two acceptance intervals
GraphFullCIs.XY(FullCIs=res.full,xname="J",yname="S",graph="CI",
                accept.int=c(8,12),accept.int.threshold=150,accept.int.perc=FALSE,include.H0=TRUE)
data(Aromatics)
# Estimate all the solutions with the BLS regression
res.full=FullCIs.XY(data=Aromatics,xcol=3,ycol=4)
# Plot all the potential solutions for the confidence regions (ellipses)
GraphFullCIs.XY(FullCIs=res.full,xname="HPLC",yname="GC MS",graph="joint.ellipse")
</code></pre>

<hr>
<h2 id='lambdas'>
Measurement error variances ratio</h2><span id='topic+lambdas'></span>

<h3>Description</h3>

<p>Calculate the measurement error variances ratio of two devices (Y over X): &lambda; and &lambda;_{XY}
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambdas(data = NULL, xcol = NULL, ycol = NULL, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambdas_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="lambdas_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X columns or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="lambdas_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y columns or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="lambdas_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data must be replicated to estimate the measurement error variances. If the number of replicates in X is equal to the number of replicates in Y, then &lambda; and &lambda;_{XY} are equal: &lambda; is the ratio (Y over X) of the measurement error variances, while &lambda;_{XY} is similar but takes also into account the number of replicates per device (nx and ny). Unbiased estimators (which is not the ratio of the two variances) for &lambda; and &lambda;_{XY} are also given.</p>


<h3>Value</h3>

<p>A lambdas class object, a table with 2 rows (&lambda; and &lambda;_{XY}) and their confidence intervals and pvalues in columns (the null hypothesized value is 1).
</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br /> Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.</p>


<h3>See Also</h3>

<p><code><a href="#topic+desc.stat">desc.stat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
lambdas(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
</code></pre>

<hr>
<h2 id='MD.horiz.lines'>
Tolerance intervals in a (M,D) plot</h2><span id='topic+MD.horiz.lines'></span>

<h3>Description</h3>

<p>Calculate agreement interval and tolerance intervals (bounded by 2 horizontal lines) for the differences (D=Y-X) in a (M,D) plot (also called Bland-Altman plot).</p>


<h3>Usage</h3>

<pre><code class='language-R'>MD.horiz.lines(data = NULL, xcol = 1, ycol = 2,
               pred.level = 0.95, TI.conf.level = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MD.horiz.lines_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="MD.horiz.lines_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="MD.horiz.lines_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="MD.horiz.lines_+3A_pred.level">pred.level</code></td>
<td>
<p> a numeric value for the predictive level (expressed between 0 and 1) of the tolerance intervals (beta expectation (type I) and beta gamma content (type II)).</p>
</td></tr>
<tr><td><code id="MD.horiz.lines_+3A_ti.conf.level">TI.conf.level</code></td>
<td>
<p> a numeric value for the confidence level of the beta gamma content tolerance interval (tolerance interval type II).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data argument is mandatory while other arguments are optional. If the data are replicated, the tolerance intervals predict where a future single difference (Di=Yi-Xi) will lie (and not an average difference). Tolerance intervals are better (than agreement interval) and should be preferred. The tolerance intervals are calculated on the univariate distribution of the differences (Di). These intervals are valid under the assumption that there is no proportional bias. If a pattern is observed, the <code><a href="#topic+CBLS">CBLS</a></code> function (CBLS regression) must be used (with its predictive intervals).</p>


<h3>Value</h3>

<p>A MD.horiz.lines class object: a list including the following elements:
</p>
<table>
<tr><td><code>data.MD</code></td>
<td>
<p> a table with the means ((X+Y)/2) and differences (Y-X).</p>
</td></tr>
<tr><td><code>Table.Differences</code></td>
<td>
<p> a table with one row and several descriptive statistics: the mean of the differences, the standard deviation of the mean difference (Di=Yi-Xi) and the standard deviation for a single difference (Yik-Xik), the minimum, 1st quartile, median, 3rd quartile, maximum and number of observations.</p>
</td></tr>
<tr><td><code>Intervals.horiz.lines</code></td>
<td>
<p> a table with 3 rows for the agreement interval, the beta expectation tolerance interval and the beta gamma content tolerance interval, with their interpretation (columns).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.</p>


<h3>See Also</h3>

<p><code><a href="#topic+CBLS">CBLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
res.MD.horiz=MD.horiz.lines(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10,pred.level=0.95)
res.MD.horiz$Intervals.horiz.lines
</code></pre>

<hr>
<h2 id='MD.plot'>
Display the CBLS regression, or univariate tolerance intervals in a (M,D) plot</h2><span id='topic+MD.plot'></span>

<h3>Description</h3>

<p>Display the CBLS regression in a (M,D) plot with or without hyperbolic confidence and/or predictive intervals, and an acceptance interval. Alternatively, univariate tolerance intervals which are bounded by two horizontal lines can be plotted.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MD.plot(results = NULL, xname = "X", yname = "Y", antilog = NULL,
        accept.int = 0, accept.int.perc = FALSE, accept.int.threshold = NULL,
        include.int = TRUE, graph.int = c("CB", "PI"), graph.horiz.int = c("bTI", "bgTI"),
        col.CBLS = 1, col.CI = 2, col.CB = 3, col.PI = 4, col.GI = 5, col.bTI = 3,
        col.bgTI = 4, lty.CBLS = 1, lty.CI = 1, lty.CB = 1, lty.PI = 1, lty.GI = 1,
        lty.bTI = 1, lty.bgTI = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MD.plot_+3A_results">results</code></td>
<td>
<p>a CBLS class object (obtained with the <code><a href="#topic+BLS">BLS</a></code> function) or a MD.horiz.lines class object (obtained with the <code><a href="#topic+MD.horiz.lines">MD.horiz.lines</a></code> function).</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_xname">xname</code></td>
<td>
<p> a character string for the name of the X device.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_yname">yname</code></td>
<td>
<p> a character string for the name of the Y device.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_antilog">antilog</code></td>
<td>
<p> a character string or a numeric value. This argument displays the CBLS or MD.horiz.lines results on the initial scales in the (M,D) plot if a logarithmic transformation was used prior to the CBLS or MD.horiz.lines functions. Options available are: 10 or &quot;e&quot;.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_accept.int">accept.int</code></td>
<td>
<p> a numeric vector (length equal 1 or 2) for the value of &Delta;: |Y-X|&lt;&Delta; to assess whether two devices (X and Y) are equivalent or not. Two values of &Delta; can be entered to take into account the case where the equivalence threshold changes along the M axis.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_accept.int.perc">accept.int.perc</code></td>
<td>
<p> a logical variable (TRUE or FALSE) whether &Delta; needs to be interpreted in percentage: Y = X &#177; &Delta;%.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_accept.int.threshold">accept.int.threshold</code></td>
<td>
<p> a numeric value for the M threshold where the value of &Delta; changes if two &Delta; values are used in <code>accept.int</code>.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_include.int">include.int</code></td>
<td>
<p> a logical variable (TRUE or FALSE) whether the hyperbolic intervals should lie entirely in the plot.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_graph.int">graph.int</code></td>
<td>
<p> a character vector for the hyperbolic curves to be displayed on the graph. Options are: &quot;CI&quot; (Confidence Intervals),&quot;CB&quot; (Confidence Bands),&quot;PI&quot; (Predictive Intervals),&quot;GI&quot; (Generalised Intervals).</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_graph.horiz.int">graph.horiz.int</code></td>
<td>
<p> if a MD.horiz.lines object is used, a character vector for the univariate tolerance intervals to be displayed on the graph. Options are: &quot;bTI&quot; (beta expectation tolerance interval or tolerance interval type I) and/or &quot;bgTI&quot; (beta gamma content tolerance interval or tolerance interval type II).</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_col.cbls">col.CBLS</code></td>
<td>
<p> a character string or a numeric variable for the colour of the CBLS regression line.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_col.ci">col.CI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the confidence intervals.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_col.cb">col.CB</code></td>
<td>
<p> a character string or a numeric variable for the colour of the confidence bands.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_col.pi">col.PI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the predictive intervals.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_col.gi">col.GI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the generalized intervals.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_col.bti">col.bTI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the beta expectation tolerance interval.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_col.bgti">col.bgTI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the beta gamma content tolerance interval.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_lty.cbls">lty.CBLS</code></td>
<td>
<p> a numeric variable for the type of line of the CBLS regression line.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_lty.ci">lty.CI</code></td>
<td>
<p> a numeric variable for the type of line for the confidence intervals.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_lty.cb">lty.CB</code></td>
<td>
<p> a numeric variable for the type of line for the confidence bands.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_lty.pi">lty.PI</code></td>
<td>
<p> a numeric variable for the type of line for the predictive intervals.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_lty.gi">lty.GI</code></td>
<td>
<p> a numeric variable for the type of line for the generalized intervals.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_lty.bti">lty.bTI</code></td>
<td>
<p> a numeric variable for the type of line for the beta expectation tolerance interval.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_lty.bgti">lty.bgTI</code></td>
<td>
<p> a numeric variable for the type of line for the beta gamma content tolerance interval.</p>
</td></tr>
<tr><td><code id="MD.plot_+3A_...">...</code></td>
<td>
<p> the common arguments from 'plot' or 'par' that may be used additionaly, such as xlim, ylim, xlab, ylab.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>results</code> argument is mandatory. The value of &Delta; (<code>accept.int</code>) is converted to percentage if antilog is used in a (M,D) plot to define 2 asymetric bounds (1- &Delta;/100, (100/(100-&Delta;)).</p>


<h3>Value</h3>

<p>An (M,D) plot in a new window.</p>


<h3>Note</h3>

<p>The limits of the axes and their labels are set automatically by the function. To compare different plots with fixed limits, use xlim and ylim. To write customized labels, use xlab and ylab.</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.</p>


<h3>See Also</h3>

<p><code><a href="#topic+XY.plot">XY.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
# Estimate the CBLS regression on replicated data
res.CBLS=CBLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Plot the results in a (M,D) plot with an acceptance interval
MD.plot(results=res.CBLS,xname="J",yname="S",accept.int=10,accept.int.perc=FALSE)
MD.plot(results=res.CBLS,xname="J",yname="S",accept.int=10,accept.int.perc=TRUE)
MD.plot(results=res.CBLS,xname="J",yname="S",accept.int=c(10,15),
        accept.int.perc=FALSE,accept.int.threshold=150)
</code></pre>

<hr>
<h2 id='OLSh'>Horizontal Ordinary Least Square regression</h2><span id='topic+OLSh'></span>

<h3>Description</h3>

<p>Fit a linear ordinary least square regression by minimising the residuals in a horizontal direction.</p>


<h3>Usage</h3>

<pre><code class='language-R'>OLSh(data = NULL, xcol = 1, ycol = 2, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OLSh_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="OLSh_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X columns or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="OLSh_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y columns or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="OLSh_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data argument is mandatory while other arugments are optional.
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>Ellipse.OLSh</code></td>
<td>
<p> a two columns matrix with the coordinates of the joint confidence interval (confidence region) for the parameters (&beta;, &alpha;).</p>
</td></tr>
<tr><td><code>Estimate.OLSh</code></td>
<td>
<p> a table (data frame) with the estimates of the intercept and the slope, standard error, confidence interval and pvalue (null hypothesis: slope = 1, intercept = 0).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The default value for xcol (ycol) is 1 (2) for the 1st (2nd) column. The confidence region for the OLSh parameters is 'distorted' as it results from the OLSv confidence region (ellipse).
</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ
</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+OLSv">OLSv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res.OLSh=OLSh(matrix(nrow=10,ncol=2,c((1:10)+rnorm(10),1:10)))
res.OLSh$Estimate.OLSh
</code></pre>

<hr>
<h2 id='OLSv'>Vertical Ordinary Least Square regression</h2><span id='topic+OLSv'></span>

<h3>Description</h3>

<p>Fit a linear ordinary least square regression by minimising the residuals in a vertical direction.</p>


<h3>Usage</h3>

<pre><code class='language-R'>OLSv(data = NULL, xcol = 1, ycol = 2, conf.level = 0.95, pred.level = 0.95,
     npoints = 1000, q = 1, xpred = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OLSv_+3A_data">data</code></td>
<td>
<p> a data set (data frame or matrix).</p>
</td></tr>
<tr><td><code id="OLSv_+3A_xcol">xcol</code></td>
<td>
<p> a numeric vector to specify the X column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="OLSv_+3A_ycol">ycol</code></td>
<td>
<p> a numeric vector to specify the Y column(s) or a character vector with the column names.</p>
</td></tr>
<tr><td><code id="OLSv_+3A_conf.level">conf.level</code></td>
<td>
<p> a numeric value for the confidence level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="OLSv_+3A_pred.level">pred.level</code></td>
<td>
<p> a numeric value for the predictive level (expressed between 0 and 1).</p>
</td></tr>
<tr><td><code id="OLSv_+3A_npoints">npoints</code></td>
<td>
<p> an integer (at least 10) for the number of points to smooth the hyperbolic curves.</p>
</td></tr>
<tr><td><code id="OLSv_+3A_q">q</code></td>
<td>
<p> an integer to predict the mean of q future values (generalized interval).</p>
</td></tr>
<tr><td><code id="OLSv_+3A_xpred">xpred</code></td>
<td>
<p> a numeric vector for customized predictions at given X values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data argument is mandatory while other arguments are optional. The confidence level is used for the confidence intervals of the parameters, the hyperbolic confidence intervals  (the prediction of the expectation of Y for a given X) and the hyperbolic confidence bands. The predictive level is used for the hyperbolic predictive intervals (the prediction of a future Y for a given X) and the hyperbolic generalized intervals (the prediction of the mean of q future Y values for a given X).
</p>


<h3>Value</h3>

<p>A list including the following elements:
</p>
<table>
<tr><td><code>Ellipse.OLSv</code></td>
<td>
<p> a two columns matrix with the coordinates of the joint confidence interval (confidence region, ellipse) for the parameters (&beta;, &alpha;).</p>
</td></tr>
<tr><td><code>Estimate.OLSv</code></td>
<td>
<p> a table (data frame) with the estimates of the intercept and the slope, standard error, confidence interval and pvalue (null hypothesis: slope = 1, intercept = 0).</p>
</td></tr>
<tr><td><code>Pred.OLSv</code></td>
<td>
<p> a data frame with npoints rows (from the minimum to the maximum of the observed X values) and the following columns: the X values where the predictions are calculated (X0), the Y predicted values (Ypred), the lower and upper bounds of the confidence intervals, predictive intervals, generalized intervals and confidence bands.</p>
</td></tr>
<tr><td><code>xpred.OLSv</code></td>
<td>
<p> a data frame with the customized predictions and the same columns than <code>Pred.OLSv</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p> The default value for xcol (ycol) is 1 (2) for the 1st (2nd) column.</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+OLSh">OLSh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res.OLSv=OLSv(matrix(nrow=10,ncol=2,c(1:10,(1:10)+rnorm(10))))
res.OLSv$Estimate.OLSv
</code></pre>

<hr>
<h2 id='raw.plot'>
Raw plot for descriptive statistics</h2><span id='topic+raw.plot'></span>

<h3>Description</h3>

<p>Display a plot with the raw data in an (X,Y) plot or (M,D) plot with or witout error bars.</p>


<h3>Usage</h3>

<pre><code class='language-R'>raw.plot(data.plot = NULL, xname = "X", yname = "Y", graph = "XY.means",
         col.ID = NULL, pch.ID = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raw.plot_+3A_data.plot">data.plot</code></td>
<td>
<p> a desc.stat class object (obtained by using the desc.stat function).</p>
</td></tr>
<tr><td><code id="raw.plot_+3A_xname">xname</code></td>
<td>
<p> a character string for the name of the X device.</p>
</td></tr>
<tr><td><code id="raw.plot_+3A_yname">yname</code></td>
<td>
<p> a character string for the name of the Y device.</p>
</td></tr>
<tr><td><code id="raw.plot_+3A_graph">graph</code></td>
<td>
<p> a character string for the kind of graph. Options available are: XY.means, XY.points, XY.bar.range, XY.bar.SEM, XY.bar.SD, MD.means.</p>
</td></tr>
<tr><td><code id="raw.plot_+3A_col.id">col.ID</code></td>
<td>
<p> a numeric or character vector describing the color of the points per ID.</p>
</td></tr>
<tr><td><code id="raw.plot_+3A_pch.id">pch.ID</code></td>
<td>
<p> a numeric vector describing the type of points per ID to plot the data.</p>
</td></tr>
<tr><td><code id="raw.plot_+3A_...">...</code></td>
<td>
<p> the common arguments from 'plot' or 'par' that may be used additionaly, such as xlim, ylim, xlab, ylab.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data.plot argument is mandatory. The labels of the X and Y axes are built by default with <code>xname</code> and <code>yname</code>, and with the type of <code>graph</code>. The arguments <code>col.ID</code> and <code>pch.ID</code> are useful if the argument <code>IDcol</code> was used in the function <code><a href="#topic+desc.stat">desc.stat</a></code>. <code>col.ID</code> and <code>pch.ID</code> are recycled if shorter than the number of IDs, i.e. if 3 colors are specified as col.ID=c(1,2,3) while there are 7 IDs, then the colors will be used as c(1,2,3,1,2,3,1).
<br /> With the argument <code>graph</code>, the option <code>XY.means</code> plots the mean measures in a (X,Y) plot, <code>XY.points</code> plots all the X (Y) replicated data centered on the means of Y (X), <code>XY.bar.range</code> plots the error bars from the minimum to the maximum (the range) of the replicates, <code>XY.bar.SEM</code> plots the error bars with the standard errors of the means, <code>XY.bar.SD</code> plots the error bars with the standard deviations, <code>MD.means</code> plots the mean measures in a (M,D) plot.
</p>


<h3>Value</h3>

<p>A plot in a new window.
</p>


<h3>Note</h3>

<p>The limits of the axes and the labels are set automatically by the function. To compare different plots with fixed limits, use xlim and ylim. To write customized labels, use xlab and ylab.</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems 2014; 134:123-139.</p>


<h3>See Also</h3>

<p><code><a href="#topic+XY.plot">XY.plot</a></code>, <code><a href="#topic+MD.plot">MD.plot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(Aromatics)
# Calculate the descriptive statistics
res=desc.stat(data=Aromatics,xcol=3,ycol=4,IDcol="Type")
# Plot the mean or single measures (it is the same for unreplicated data)
raw.plot(data.plot=res,xname="HPLC",yname="GC MS",graph="XY.means")
raw.plot(data.plot=res,xname="HPLC",yname="GC MS",graph="XY.points")
# Plot with customized colours and type of points per type of samples
raw.plot(data.plot=res,xname="HPLC",yname="GC MS",graph="XY.points",pch.ID=c(19,5,8),col.ID=c(1,2))
raw.plot(data.plot=res,xname="HPLC",yname="GC MS",graph="MD.means")
raw.plot(data.plot=res,xname="HPLC",yname="GC MS",graph="MD.means",col.ID=c(1,2,4))
data(SBP)
# Calculate the descriptive statistics
res=desc.stat(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10)
# Different plots to show the measurement uncertainties
raw.plot(data.plot=res,xname="J",yname="S",graph="XY.means")
raw.plot(data.plot=res,xname="J",yname="S",graph="XY.points")
raw.plot(data.plot=res,xname="J",yname="S",graph="XY.bar.range")
raw.plot(data.plot=res,xname="J",yname="S",graph="XY.bar.SD")
raw.plot(data.plot=res,xname="J",yname="S",graph="XY.bar.SEM")
raw.plot(data.plot=res,xname="J",yname="S",graph="MD.means")
</code></pre>

<hr>
<h2 id='SBP'>
Systolic blood pressure data
</h2><span id='topic+SBP'></span>

<h3>Description</h3>

<p>Systolic blood pressure measured by two devices on 85 patients: 3 times with a manual device by 2 operators and 3 times with a semi automatic device.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SBP)</code></pre>


<h3>Format</h3>

<p>A data frame with 85 observations and 10 variables.
</p>

<dl>
<dt><code>Subject</code></dt><dd><p>a numeric vector for the patient IDs.</p>
</dd>
<dt><code>J1</code></dt><dd><p>a numeric vector: the 1st measures obtained by operator J.</p>
</dd>
<dt><code>J2</code></dt><dd><p>a numeric vector: the 2nd measures obtained by operator J.</p>
</dd>
<dt><code>J3</code></dt><dd><p>a numeric vector: the 3rd measures obtained by operator J.</p>
</dd>
<dt><code>R1</code></dt><dd><p>a numeric vector: the 1st measures obtained by operator R.</p>
</dd>
<dt><code>R2</code></dt><dd><p>a numeric vector: the 2nd measures obtained by operator R.</p>
</dd>
<dt><code>R3</code></dt><dd><p>a numeric vector: the 3rd measures obtained by operator R.</p>
</dd>
<dt><code>S1</code></dt><dd><p>a numeric vector: the 1st measures obtained by the semi automatic device.</p>
</dd>
<dt><code>S2</code></dt><dd><p>a numeric vector: the 2nd measures obtained by the semi automatic device.</p>
</dd>
<dt><code>S3</code></dt><dd><p>a numeric vector: the 3rd measures obtained by the semi automatic device.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bland JM, Altman DG. Measuring agreement in method comparison studies. Statistical Methods in Medical Research, 1999; 8:135-160.</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SBP)
str(SBP)
head(SBP)
</code></pre>

<hr>
<h2 id='XY.plot'>
Display the BLS regression in a (X,Y) plot
</h2><span id='topic+XY.plot'></span>

<h3>Description</h3>

<p>Display the BLS regression in a (X,Y) plot with or without hyperbolic confidence and/or predictive intervals, and an acceptance interval.</p>


<h3>Usage</h3>

<pre><code class='language-R'>XY.plot(BLS.results = NULL, xname = "X", yname = "Y", antilog = NULL,
        accept.int = 0, accept.int.perc = FALSE, accept.int.threshold = NULL,
        graph.int = c("CB", "PI"), include.int = FALSE, col.BLS = 1, col.CI = 2,
        col.CB = 3, col.PI = 4, col.GI = 5, lty.BLS = 1, lty.CI = 1,
        lty.CB = 1, lty.PI = 1, lty.GI = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="XY.plot_+3A_bls.results">BLS.results</code></td>
<td>
<p>a BLS or BLS.ht class object (obtained with the <code><a href="#topic+BLS">BLS</a></code> or <code><a href="#topic+BLS.ht">BLS.ht</a></code> functions).</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_xname">xname</code></td>
<td>
<p> a character string for the name of the X device.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_yname">yname</code></td>
<td>
<p> a character string for the name of the Y device.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_antilog">antilog</code></td>
<td>
<p> a character string or a numeric value. This argument display the BLS results on the initial scales on the (X,Y) plot if a logarithmic transformation was used prior to the BLS function. Options available are: 10 or &quot;e&quot;.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_accept.int">accept.int</code></td>
<td>
<p> a numeric vector (length equal 1 or 2) for the value of &Delta;: Y = X &#177; &Delta; to assess whether two devices (X and Y) are equivalent or not. Two values of &Delta; can be entered to take into account the case where the equivalence threshold changes along the X axis.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_accept.int.perc">accept.int.perc</code></td>
<td>
<p> a logical variable (TRUE or FALSE) whether &Delta; needs to be interpreted in percentage: Y = X &#177; &Delta; %.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_accept.int.threshold">accept.int.threshold</code></td>
<td>
<p> a numeric value for the X threshold where the value of &Delta; changes if two &Delta; values are used in <code>accept.int</code>.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_graph.int">graph.int</code></td>
<td>
<p> a character vector for the hyperbolic curves to be displayed on the graph. Options are: &quot;CI&quot; (Confidence Intervals),&quot;CB&quot; (Confidence Bands),&quot;PI&quot; (Predictive Intervals),&quot;GI&quot; (Generalised Intervals).</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_include.int">include.int</code></td>
<td>
<p> a logical variable whether the hyperbolic intervals should lie entirely in the plot.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_col.bls">col.BLS</code></td>
<td>
<p> a character string or a numeric variable for the colour of the BLS regression line.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_col.ci">col.CI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the confidence intervals.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_col.cb">col.CB</code></td>
<td>
<p> a character string or a numeric variable for the colour of the confidence bands.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_col.pi">col.PI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the predictive intervals.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_col.gi">col.GI</code></td>
<td>
<p> a character string or a numeric variable for the colour of the generalized intervals.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_lty.bls">lty.BLS</code></td>
<td>
<p> a numeric variable for the type of line of the BLS regression line.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_lty.ci">lty.CI</code></td>
<td>
<p> a numeric variable for the type of line for the confidence intervals.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_lty.cb">lty.CB</code></td>
<td>
<p> a numeric variable for the type of line for the confidence bands.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_lty.pi">lty.PI</code></td>
<td>
<p> a numeric variable for the type of line for the predictive intervals.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_lty.gi">lty.GI</code></td>
<td>
<p> a numeric variable for the type of line for the generalized intervals.</p>
</td></tr>
<tr><td><code id="XY.plot_+3A_...">...</code></td>
<td>
<p> the common arguments from 'plot' or 'par' that may be used additionaly, such as xlim, ylim, xlab, ylab.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The BLS.result argument is mandatory.</p>


<h3>Value</h3>

<p>An (X,Y) plot in a new window.</p>


<h3>Note</h3>

<p>The limits of the axes and their labels are set automatically by the function. To compare different plots with fixed limits, use xlim and ylim. To write customized labels, use xlab and ylab.</p>


<h3>Author(s)</h3>

<p>Bernard G FRANCQ</p>


<h3>References</h3>

<p>Francq BG, Govaerts BB. How to regress and predict in a Bland-Altman plot? Review and contribution based on tolerance intervals and correlated-errors-in-variables models. Statistics in Medicine, 2016; 35:2328-2358.
<br /> Francq BG, Govaerts BB. Measurement methods comparison with errors-in-variables regressions. From horizontal to vertical OLS regression, review and new perspectives. Chemometrics and Intelligent Laboratory Systems, 2014; 134:123-139.
<br /> Francq BG, Govaerts BB. Hyperbolic confidence bands of errors-in-variables regression lines applied to method comparison studies. Journal de la Societe Francaise de Statistique 2014; 155(1):23-45.</p>


<h3>See Also</h3>

<p><code><a href="#topic+MD.plot">MD.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BivRegBLS)
data(SBP)
# Estimate the BLS regression on replicated data
res.BLS=BLS(data=SBP,xcol=c("J1","J2","J3"),ycol=8:10,qx=3,qy=3)
# Plot the results in a (X,Y) plot with an acceptance interval
XY.plot(BLS.results=res.BLS,xname="J",yname="S",accept.int=10,accept.int.perc=FALSE)
XY.plot(BLS.results=res.BLS,xname="J",yname="S",accept.int=10,accept.int.perc=TRUE)
XY.plot(BLS.results=res.BLS,xname="J",yname="S",accept.int=c(10,20),
        accept.int.perc=FALSE,accept.int.threshold=150)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
