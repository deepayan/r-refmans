<!DOCTYPE html><html lang="en"><head><title>Help for package cmbClust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cmbClust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cmbClust-package'>
<p>Conditional mixture modeling and model-based clustering</p></a></li>
<li><a href='#ais'><p>Australian Institute of Sport data</p></a></li>
<li><a href='#cmb.em'><p>Conditional mixture modeling by EM algorithm</p></a></li>
<li><a href='#cmb.plot'><p>Graphic display for the results of conditional mixture modeling and model-based clustering</p></a></li>
<li><a href='#cmb.search'><p>Optimal conditioning order search</p></a></li>
<li><a href='#smltn'>
<p>Simulated datasets</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-31</td>
</tr>
<tr>
<td>Title:</td>
<td>Conditional Mixture Modeling and Model-Based Clustering</td>
</tr>
<tr>
<td>Description:</td>
<td>Conditional mixture model fitted via EM (Expectation Maximization) algorithm for model-based clustering, including parsimonious procedure, optimal conditional order exploration, and visualization.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, parallel</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-02 21:24:12 UTC; wangy4</td>
</tr>
<tr>
<td>Author:</td>
<td>Yang Wang [aut, cre],
  Volodymyr Melnykov [aut],
  Stephen Moshier [ctb] (eigenvalue calculations in c),
  Rouben Rostamian [ctb] (memory allocation in c)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yang Wang &lt;wangy4@cofc.edu&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-03 16:10:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='cmbClust-package'>
Conditional mixture modeling and model-based clustering
</h2><span id='topic+cmbClust-package'></span>

<h3>Description</h3>

<p>The utility of this package includes fitting a conditional mixture model with EM (Expectation Maximization) algorithm, model-based clustering based on conditional mixture modeling, conditional mixture modeling with parsimonious procedures, and optimal conditional order exploration by using either a full search or the proposed searching algorithm, and illustration of clustering results through pairwise plots.</p>


<h3>Details</h3>

<p>Function 'cmb.em' runs the parsimonious conditional mixture modeling for a user-specified conditioning order.
</p>
<p>Function 'cmb.search' runs the 'cmb.em' procedure for all possible conditioning orders and determines the optimal order using BIC, or runs the proposed optimal order search algorithm and then the 'cmb.em' for the obtained optimal order.
</p>
<p>Function 'cmb.plot' builds pairwise plots to present clustering results from functions 'cmb.em' and 'cmb.search&quot;.
</p>


<h3>Author(s)</h3>

<p>Yang Wang and Volodymyr Melnykov.
</p>
<p>Maintainer: Yang Wang &lt;wangy4@cofc.edu&gt;
</p>


<h3>References</h3>

<p>Melnykov, V., and Wang, Y. (2023). Conditional mixture modeling and model-based clustering. <em>Pattern Recognition</em>, 133, p. 108994.
</p>

<hr>
<h2 id='ais'>Australian Institute of Sport data</h2><span id='topic+ais'></span>

<h3>Description</h3>

<p>The data set considers body characteristics from 102 male and 100 female athletes at the Australian Institute of Sport. It is collected for a study of how data on various features varied with sport body size and sex of athlete.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ais)</code></pre>


<h3>Format</h3>

 
<p>A data frame with 202 observations on the following 13 variables.
</p>

<dl>
<dt>sex</dt><dd><p>Factor with levels: <code>female</code>, <code>male</code>;</p>
</dd>
<dt>sport</dt><dd><p>Factor with levels: <code>B_Ball</code>, 
<code>Field</code>, <code>Gym</code>, <code>Netball</code>, <code>Row</code>
<code>Swim</code>, <code>T_400m</code>, <code>Tennis</code>, <code>T_Sprnt</code>, 
<code>W_Polo</code>;</p>
</dd>
<dt>RCC</dt><dd><p>Red cell count;</p>
</dd>
<dt>WCC</dt><dd><p>White cell count;</p>
</dd>
<dt>Hc</dt><dd><p>Hematocrit;</p>
</dd>
<dt>Hg</dt><dd><p>Hemoglobin;</p>
</dd>
<dt>Fe</dt><dd><p>Plasma ferritin concentration;</p>
</dd>
<dt>BMI</dt><dd><p>Body Mass Index;</p>
</dd>
<dt>SSF</dt><dd><p>Sum of skin folds;</p>
</dd>
<dt>Bfat</dt><dd><p>Body fat percentage;</p>
</dd>
<dt>LBM</dt><dd><p>Lean body mass;</p>
</dd>
<dt>Ht</dt><dd><p>Height, cm;</p>
</dd>
<dt>Wt</dt><dd><p>Weight, kg</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data have been made publicly available in connection with the book by Cook, R.D. and Weisberg, S. (1994, ISBN-10:0471008397).</p>


<h3>References</h3>

<p>Cook, R.D. and Weisberg, S. (1994). <em>An introduction to regression graphics</em>. John Wiley &amp; Sons.
</p>

<hr>
<h2 id='cmb.em'>Conditional mixture modeling by EM algorithm</h2><span id='topic+cmb.em'></span>

<h3>Description</h3>

<p>Runs conditional mixture modeling and model-based clustering by EM algorithm (Expectation Maximization) for a prespecified variables conditioning order. Runs variable selection procedure (forward, backward or stepwise) to achieve a parsimonious mixture model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmb.em(x, order = NULL, l, K, method = "stepwise", id0 = NULL, n.em = 200, em.iter = 5,
EM.iter = 200, nk.min = NULL, max.spur=5, tol = 1e-06, silent = FALSE, Parallel = FALSE,
n.cores = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmb.em_+3A_x">x</code></td>
<td>
<p> dataset matrix (n x p)</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_order">order</code></td>
<td>
<p> customized variables' conditioning order (length p)</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_l">l</code></td>
<td>
<p> order of polynomial regression model </p>
</td></tr>
<tr><td><code id="cmb.em_+3A_k">K</code></td>
<td>
<p> number of clusters</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_method">method</code></td>
<td>
<p>variable selection method (options 'stepwise', 'forward', 'backward' and 'none')</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_id0">id0</code></td>
<td>
<p>initial membership vector (length n)</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_n.em">n.em</code></td>
<td>
<p>number of short EM in an emEM procedure</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_em.iter">em.iter</code></td>
<td>
<p>maximum number of iterations of short EM in an emEM procedure</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_em.iter">EM.iter</code></td>
<td>
<p> maximum number of EM iterations</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_nk.min">nk.min</code></td>
<td>
<p>spurious output control</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_max.spur">max.spur</code></td>
<td>
<p>number of trials</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_tol">tol</code></td>
<td>
<p>tolerance level</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_silent">silent</code></td>
<td>
<p>output control (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_parallel">Parallel</code></td>
<td>
<p>parallel computing (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="cmb.em_+3A_n.cores">n.cores</code></td>
<td>
<p>number of cores in parallel computing</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In conditional mixture modeling, each component is modeled by a product of conditional distributions with the means expressed by polynomial regression functions depending on other variables. Polynomial regression function order <code>l</code> and the number of clusters <code>K</code> are prespecified by user. The model's initialization can be determined by passing a group membership vector to the argument <code>id</code>, or obtained by the emEM algorithm (the default setting) in the function. There are two arguments related to the emEM procedure, the number of short EM <code>n.em</code> and maximum number of iterations for short EM <code>em.iter</code>. By default, the <code>n.em = 200</code> and <code>em.iter = 5</code>. The method of variable selection can be specified as <code>method = "stepwise", "forward", "backward", or "none"</code> where <code>method = none</code> means no parsimonious procedure conducted. During the model fitting and variable selection phases, EM algorithm will be applied multiple times, where options <code>EM.iter</code> and <code>tol</code> are stopping criteria of EM iteration. The spurious output control argument <code>nk.min</code>, by default <code>nk.min = (l x (p - 1) + 1) x 2</code>, can be set by user. When spurious output is obtained, <code>cmb.em</code> will be rerun. The maximum number of rerunning is <code>max.spur</code>. 
</p>
<p>Notation: n - sample size, l - order of polynomial regression model, K - number of mixture components.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>input dataset</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>estimated regression models for each cluster (K x p matrix) </p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p> vector of estimated membership (length n)</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> estimated log likelihood</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p> Bayesian Information Criterion</p>
</td></tr>
<tr><td><code>Pi</code></td>
<td>
<p>vector of estimated mixing proportions (length K)</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p> matrix of estimated posterior probabilities (n x K)</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p> matrix of estimated regression parameters (K x (p + p(p-1)l/2) )</p>
</td></tr>
<tr><td><code>s2</code></td>
<td>
<p> matrix of estimated variance (K x p)</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p>applied conditioning order (length p)</p>
</td></tr>
<tr><td><code>n_pars</code></td>
<td>
<p> number of model parameters</p>
</td></tr>
</table>


<h3>References</h3>

<p>Biernacki C., Celeux G., Govaert G. (2003). Choosing Starting Values for the EM Algorithm for Getting the Highest Likelihood in Multivariate Gaussian Mixture Models. <em>Computational Statistics and Data Analysis</em>, 41(3-4), pp. 561-575.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
K &lt;- 3
l &lt;- 2
x &lt;- as.matrix(iris[,-5])
id.true &lt;- iris[,5]

# Run EM algorithm for fitting a conditioning mixture model 
obj &lt;- cmb.em(x = x, order = c(1,3,2,4), l, K, method = "stepwise", silent = FALSE,
Parallel = FALSE)
id.cmb &lt;- obj$id
table(id.true, id.cmb)
obj$BIC

</code></pre>

<hr>
<h2 id='cmb.plot'>Graphic display for the results of conditional mixture modeling and model-based clustering</h2><span id='topic+cmb.plot'></span>

<h3>Description</h3>

<p><code>cmb.plot</code> demonstrates the clustering results of functions <code>cmb.em</code> and <code>cmb.search</code>. A graph with a combination of pairwise scatter plot for data points, pairwise contour plot of estimated mixture density, and pairwise regression curves is produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmb.plot(obj, allcolors = NULL, allpch = NULL, lwd = 1, cex.text = 1, cex.point = 0.6, 
mar = c(0.6,0.6,0.6,0.6), oma = c(3.5,3.5,2.5,14), nlevels = 30)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmb.plot_+3A_obj">obj</code></td>
<td>
<p>output object of the function <code>cmb.em()</code> or <code>cmb.search()</code></p>
</td></tr>
<tr><td><code id="cmb.plot_+3A_allcolors">allcolors</code></td>
<td>
<p>colous of clusters (length K)</p>
</td></tr>
<tr><td><code id="cmb.plot_+3A_allpch">allpch</code></td>
<td>
<p>styles of data points in clusters (length K)</p>
</td></tr>
<tr><td><code id="cmb.plot_+3A_lwd">lwd</code></td>
<td>
<p>line width, a positive number, defaulting to 1</p>
</td></tr>
<tr><td><code id="cmb.plot_+3A_cex.text">cex.text</code></td>
<td>
<p>magnification of labels and titles, defaulting to 1</p>
</td></tr>		
<tr><td><code id="cmb.plot_+3A_cex.point">cex.point</code></td>
<td>
<p>magnification of plotting symbols, defaulting to 0.6</p>
</td></tr>
<tr><td><code id="cmb.plot_+3A_mar">mar</code></td>
<td>
<p>margin sizes of plots in lines of text (length 4)</p>
</td></tr>
<tr><td><code id="cmb.plot_+3A_oma">oma</code></td>
<td>
<p>outer margin sizes of a pairwise plot in lines of text (length 4)</p>
</td></tr>
<tr><td><code id="cmb.plot_+3A_nlevels">nlevels</code></td>
<td>
<p>number of contour levels, defaulting to 30</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function generates a graphic. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(4)
K &lt;- 3
l &lt;- 2
x &lt;- as.matrix(iris[,-5])

# Run EM algorithm for fitting a conditioning mixture model 

obj &lt;- cmb.em(x = x, order = c(1,2,3,4), l, K, method = "stepwise",
silent = TRUE, Parallel = FALSE)
cmb.plot(obj)
	
</code></pre>

<hr>
<h2 id='cmb.search'>Optimal conditioning order search</h2><span id='topic+cmb.search'></span>

<h3>Description</h3>

<p>Runs forward, backward, or stepwise variable selection procedure for obtaining the parsimonious conditional mixture models when all conditional orders are considered.
Alternatively, runs the optimal order search algorithm, and parsimonious conditional mixture modeling for the obtained order.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cmb.search(x, l, K, method = "stepwise", all.perms  = TRUE, id0 = NULL,  n.em = 200,
em.iter = 5, EM.iter = 200, nk.min = NULL, max.spur = 5, tol = 1e-06, silent = FALSE, 
Parallel = TRUE, n.cores = 4)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cmb.search_+3A_x">x</code></td>
<td>
<p> dataset matrix (n x p)</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_l">l</code></td>
<td>
<p> order of polynomial regression model </p>
</td></tr>
<tr><td><code id="cmb.search_+3A_k">K</code></td>
<td>
<p> number of clusters</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_method">method</code></td>
<td>
<p>  variable selection method (options 'stepwise', 'forward', 'backward' and 'none')</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_all.perms">all.perms</code></td>
<td>
<p>conditioning order search algorithm (<code>TRUE</code>: full search; <code>FALSE</code> proposed search algorithm) </p>
</td></tr>
<tr><td><code id="cmb.search_+3A_id0">id0</code></td>
<td>
<p> initial group membership (length n)</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_n.em">n.em</code></td>
<td>
<p> number of short EM in emEM procedure</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_em.iter">em.iter</code></td>
<td>
<p>maximum number of short EM iterations in emEM</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_em.iter">EM.iter</code></td>
<td>
<p> maximum number of EM iterations</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_nk.min">nk.min</code></td>
<td>
<p>spurious output control</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_max.spur">max.spur</code></td>
<td>
<p>number of trials</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_tol">tol</code></td>
<td>
<p>tolerance level</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_silent">silent</code></td>
<td>
<p>output control</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_parallel">Parallel</code></td>
<td>
<p>Parallel computing</p>
</td></tr>
<tr><td><code id="cmb.search_+3A_n.cores">n.cores</code></td>
<td>
<p>number of cores in parallel computing</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions 'cmb.search' and 'cmb.em' have common arguments except 'all.perm'. With <code>all.perms = TRUE</code>, a full search is applied to data, that is running parsimonious conditional mixture modeling for all orders and recognizing the optimal order based on the BIC. Then two lists are returned: <code>best.model</code> stores the results for the conditional mixture model with the optimal order, and <code>models</code> has results for all orders. With the option <code>all.perms = FALSE</code>, the optimal conditional order search algorithm is applied, and then only the list <code>best.model</code> is returned. 
</p>


<h3>Value</h3>

<p>The list <code>models</code> is returned when <code>all.perms = TRUE</code>.
</p>
<table role = "presentation">
<tr><td><code>best.model</code></td>
<td>
<p>  membership assignments and estimated parameters of mixture model with the optimal contioning order.
</p>

<dl>
<dt>data</dt><dd><p>the input dataset</p>
</dd>
<dt>model</dt><dd><p>estimated regression models for each cluster (K x p) </p>
</dd>
<dt>id</dt><dd><p> vector of estimated membership (length n)</p>
</dd>
<dt>loglik</dt><dd><p> estimated log likelihood</p>
</dd>
<dt>BIC </dt><dd><p>Bayesian Information Criterion </p>
</dd>
<dt>Pi   </dt><dd><p>vector of estimated mixing proportions (length K)</p>
</dd>
<dt>tau </dt><dd><p> matrix of estimated posterior probabilities  (n x K)</p>
</dd>
<dt>beta </dt><dd><p>matrix of estimated regression parameters (K x (p + p(p-1)l/2) )</p>
</dd>
<dt>s2 </dt><dd><p> matrix of estimated variances (K x p)</p>
</dd>
<dt>order</dt><dd><p>applied conditioning order length p</p>
</dd>
<dt>n_pars </dt><dd><p> number of parameters</p>
</dd>
</dl>

</td></tr>
<tr><td><code>models</code></td>
<td>
<p> membership assignments and model parameters of mixture models with all conditioning orders.
</p>

<dl>
<dt>model</dt><dd><p>list of estimated regression models for all clusters (K x p x p!) </p>
</dd>
<dt>id</dt><dd><p> p! vectors of estimated memberships (n x p!)</p>
</dd>
<dt>loglik</dt><dd><p> estimated log likelihood values (length p!)</p>
</dd>
<dt>BIC </dt><dd><p> Bayesian Information Criterion values (length p!)</p>
</dd>
<dt>Pi   </dt><dd><p> p! vectors of estimated mixing proportions  (K x p!)</p>
</dd>
<dt>tau </dt><dd><p> p! matrices of estimated posterior probabilities (K x p!)</p>
</dd>
<dt>beta </dt><dd><p> p! matrices of estimated regression parameters  (K x (p + p(p-1)l/2) x p! )</p>
</dd>
<dt>s2 </dt><dd><p> p! matrices of estimated variances (K x p x p!)</p>
</dd>
<dt>order</dt><dd><p>appled conditioning orders (p! x p )</p>
</dd>
<dt>n_pars </dt><dd><p> number of parameters in p! models (length p!)</p>
</dd>
</dl>
</td></tr>
</table>


<h3>See Also</h3>

<p>cmb.em
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
K = 3
l &lt;- 2
x &lt;- as.matrix(iris[,-5])


obj &lt;- cmb.search(x = x, l, K, method = "stepwise", all.perms = FALSE,
Parallel = FALSE, silent = FALSE)
obj$best.model$BIC


</code></pre>

<hr>
<h2 id='smltn'>
Simulated datasets
</h2><span id='topic+smltn'></span><span id='topic+smltn1'></span><span id='topic+smltn2'></span>

<h3>Description</h3>

<p>Datasets are simulated from conditional mixture models with different numbers of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(smltn)</code></pre>


<h3>Format</h3>

<p>Two datasets are stored in the data <code>smltn</code>. <code>smltn1</code> is a data matrix with 200 observations on two variables and one group membership; <code>smltn2</code> is a matrix with 300 observations on two variables and one group ID.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(smltn)
# view data matrices smltn1 and smltn2
print(smltn1)
print(smltn2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
