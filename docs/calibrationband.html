<!DOCTYPE html><html lang="en"><head><title>Help for package calibrationband</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {calibrationband}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calibration_bands'><p>Confidence bands for monotone probabilities</p></a></li>
<li><a href='#plot.calibrationband'><p>Plotting monotone confidence bands</p></a></li>
<li><a href='#print.calibrationband'><p>Print monotone confidence bands</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#summary.calibrationband'><p>summarize calibration band  object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calibration Bands</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Package to assess the calibration of probabilistic classifiers using confidence bands for monotonic functions. Besides testing the classical goodness-of-fit null hypothesis of perfect calibration, the confidence bands calculated within that package facilitate inverted goodness-of-fit tests whose rejection allows for a sought-after conclusion of a sufficiently well-calibrated model. The package creates flexible graphical tools to perform these tests.  For construction details see also Dimitriadis, DÃ¼mbgen, Henzi, Puke, Ziegel (2022) &lt;<a href="https://doi.org/10.48550/arXiv.2203.04065">doi:10.48550/arXiv.2203.04065</a>&gt;. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/marius-cp/calibrationband">https://github.com/marius-cp/calibrationband</a>,
<a href="https://marius-cp.github.io/calibrationband/">https://marius-cp.github.io/calibrationband/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, ggplot2, tibble, dplyr, tidyr, sp, methods, base, stats,
magrittr, rlang, tidyselect</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-08 14:49:15 UTC; mp</td>
</tr>
<tr>
<td>Author:</td>
<td>Timo Dimitriadis [aut],
  Alexander Henzi [aut],
  Marius Puke [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marius Puke &lt;marius.puke@uni-hohenheim.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-09 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calibration_bands'>Confidence bands for monotone probabilities</h2><span id='topic+calibration_bands'></span>

<h3>Description</h3>

<p>Confidence bands for monotone probabilities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibration_bands(
  x,
  y,
  alpha = 0.05,
  method = "standard",
  digits = NULL,
  nc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibration_bands_+3A_x">x</code></td>
<td>
<p>covariate.</p>
</td></tr>
<tr><td><code id="calibration_bands_+3A_y">y</code></td>
<td>
<p>response variable (in 0,1).</p>
</td></tr>
<tr><td><code id="calibration_bands_+3A_alpha">alpha</code></td>
<td>
<p>type one error probability (1 minus the confidence level).</p>
</td></tr>
<tr><td><code id="calibration_bands_+3A_method">method</code></td>
<td>
<p><code>"standard"</code> for the original method proposed in the
article, <code>"round"</code> for rounding the covariate, or <code>"YB"</code> for the bounds by Yang &amp; Barber
(2019).</p>
</td></tr>
<tr><td><code id="calibration_bands_+3A_digits">digits</code></td>
<td>
<p>number of digits for method <code>"round"</code>. Default is 2.
Has no effect for the other methods.</p>
</td></tr>
<tr><td><code id="calibration_bands_+3A_nc">nc</code></td>
<td>
<p>use non-crossing bands for method <code>"standard"</code> or
<code>"round"</code>. Has no effect for method <code>"YB"</code>. Default is
<code>FALSE</code>. See also <code>"summary(...,iso_test=TRUE)"</code> in this context.
Crossings allow to reject the null hypothesis of monotonicity in the calibration curve.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>calibrationband</code>, which is a list containing the following entries:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>bands</code> </td><td style="text-align: left;"> a tibble holding <code>x,lwr,upr</code> the lower and upper bound,
 for each value of <code>x</code>.
 The upper bound extends to the left and the lower bound to the right,
 that is, the upper bound for <code>x[i]&lt;s&lt;x[i+1]</code> is <code>upr[i+1]</code>,
 and the lower bound for <code>x[i]&lt;s&lt;x[i+1]</code> is <code>lwr[i]</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>cal</code> </td><td style="text-align: left;"> a tibble holding the areas/segments of calibration (<code>out=0</code>) and miscalibration (<code>out=1</code>).  </td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>bins</code> </td><td style="text-align: left;"> a tibble of the characteristics of the isotonic bins. </td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>cases</code> </td><td style="text-align: left;"> tibble of all predictions and observations.
 In addition it holds the column <code>isoy</code>, which is the isotonic
 regression of <code>y</code> at points <code>x</code>.   </td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>alpha</code> </td><td style="text-align: left;"> the given type one error probability (1 minus the nominal
 coverage of the band). </td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>method</code> </td><td style="text-align: left;"> the selected method for computing the band. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nc</code> </td><td style="text-align: left;"> the selected method for non-crossing.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>digits</code> </td><td style="text-align: left;"> the given digits for method <code>"round"</code>
    (or <code>NULL</code> for method <code>"standard"</code>).</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>time</code> </td><td style="text-align: left;"> time to compute the upper and lower band.
</td>
</tr>

</table>


<hr>
<h2 id='plot.calibrationband'>Plotting monotone confidence bands</h2><span id='topic+plot.calibrationband'></span><span id='topic+autoplot.calibrationband'></span><span id='topic+autolayer.calibrationband'></span>

<h3>Description</h3>

<p>Uses the <span class="pkg">ggplot2</span> package to illustrate monotone confidence bands to assess calibration of
prediction methods that issue probability forecasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'calibrationband'
autoplot(
  object,
  ...,
  approx.equi = NULL,
  cut.bands = FALSE,
  p_ribbon = NULL,
  p_isoreg = NULL,
  p_diag = NULL
)

## S3 method for class 'calibrationband'
autolayer(
  object,
  ...,
  approx.equi = NULL,
  cut.bands = FALSE,
  p_diag = NA,
  p_isoreg = NA,
  p_ribbon = NA
)

## S3 method for class 'calibrationband'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.calibrationband_+3A_object">object</code></td>
<td>
<p>object of class <code>calibrationband</code></p>
</td></tr>
<tr><td><code id="plot.calibrationband_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="plot.calibrationband_+3A_approx.equi">approx.equi</code></td>
<td>
<p>If <code>NULL</code>, the bands are drawn for each
prediction-realization pair. If it is a scalar, say <code>z</code>,  the bounds are
approximated at <code>z</code> equidistant point on the x-axis. Also see the effect of
<code>cut.bands</code> if a scalar is specified.
</p>
<p>In large data sets, <code>approx.equi = NULL</code>  might result in
capacity-consuming plots. In these cases, we recommend to set <code>approx.equi</code>
equal to a value that is at least 200.
</p>
<p>Note, we add important additional points the initial scalar of
<code>approx.equi</code> to assure accurate transition areas (changes between
miscalibrated and calibrated areas).</p>
</td></tr>
<tr><td><code id="plot.calibrationband_+3A_cut.bands">cut.bands</code></td>
<td>
<p>Cut the bands at most extreme prediction values.
Bands will not be extended to 0 and 1 respectively if option is set equal to true.</p>
</td></tr>
<tr><td><code id="plot.calibrationband_+3A_p_ribbon">p_ribbon</code></td>
<td>
<p>If non <code>NULL</code>, a ribbon is drawn. Contains a list of
arguments for <code>ggplot2::geom_polygon</code>. See details for default list settings.</p>
</td></tr>
<tr><td><code id="plot.calibrationband_+3A_p_isoreg">p_isoreg</code></td>
<td>
<p>If non <code>NULL</code> the isotonic regression curve is drawn.
Contains a list of arguments for <code>ggplot2::geom_line</code>. See details for default list settings.</p>
</td></tr>
<tr><td><code id="plot.calibrationband_+3A_p_diag">p_diag</code></td>
<td>
<p>If non <code>NULL</code>, the diagonal line is drawn.
Contains list of arguments for <code>ggplot2::geom_segment</code>.</p>
</td></tr>
<tr><td><code id="plot.calibrationband_+3A_x">x</code></td>
<td>
<p>object of class <code>calibrationband</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>When plotting the monotone confidence band, the upper bound should be
extended to the left, that is, the bound at <code>x[i]</code> is valid on the
interval <code>(x[i-1],x[i]]</code>. The lower bound should be extended to the
right, i.e. the bound at x[i] is extended to the interval <code>[x[i],x[i +
1])</code>. This function creates x and y values for correct plotting of these
bounds.
</p>
<p><code>autoplot</code> behaves like any <code>ggplot() + layer()</code> combination.
That means, customized plots should be created using <code>autoplot</code> and
<code>autolayer</code>.
</p>
<p>Setting any of the <code>p_*</code> arguments to <code>NA</code> disables that layer.
</p>
<p>Default parameter values for <code>p_*</code>
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>p_isoreg</code> </td><td style="text-align: left;"> <code>list(color = "darkgray")</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p_diag</code> </td><td style="text-align: left;"> <code>list(color = "black", fill="blue", alpha = .1)</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p_ribbon</code> </td><td style="text-align: left;"> <code> list(low = "gray", high = "red", guide = "none", limits=c(0,1))</code>
</td>
</tr>

</table>



<h3>Value</h3>

<p>An object inheriting from class <code>'ggplot'</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s=.8
n=10000
x &lt;- sort(runif(n))

p &lt;- function(x,s){p = 1/(1+((1/x*(1-x))^(s+1)));return(p)}
dat &lt;- data.frame(pr=x, y=rbinom(n,1,p(x,s)))

cb &lt;- calibration_bands(x=dat$pr, y=dat$y,alpha=0.05, method="round", digits =3)

#simple plotting
plot(cb)
autoplot(cb)

#customize the plot using  ggplot2::autolayer
autoplot(
cb,
approx.equi=NULL,
p_ribbon = NA
)+
ggplot2::autolayer(
cb,
p_ribbon = list(alpha = .3, fill = "gray", colour = "blue"),
)
</code></pre>

<hr>
<h2 id='print.calibrationband'>Print monotone confidence bands</h2><span id='topic+print.calibrationband'></span><span id='topic+print.summary.calibrationband'></span>

<h3>Description</h3>

<p>Printing methods for <code>'calibrationband'</code> and
<code>'summary.calibrationband'</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'calibrationband'
print(x, ...)

## S3 method for class 'summary.calibrationband'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.calibrationband_+3A_x">x</code></td>
<td>
<p>object of class <code>calibrationband</code></p>
</td></tr>
<tr><td><code id="print.calibrationband_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods;
in particular these passed to <code><a href="#topic+autoplot.calibrationband">autoplot.calibrationband</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.calibrationband</code> always sends an autoplot object to the
current graphics device and prints a summary to the console.
</p>


<h3>Value</h3>

<p>Invisibly returns <code>x</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoplot.calibrationband">autoplot.calibrationband</a></code>,
<code><a href="#topic+summary.calibrationband">summary.calibrationband</a></code>
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+autoplot'></span><span id='topic+autolayer'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ggplot2</dt><dd><p><code><a href="ggplot2.html#topic+autolayer">autolayer</a></code>, <code><a href="ggplot2.html#topic+autoplot">autoplot</a></code></p>
</dd>
</dl>

<hr>
<h2 id='summary.calibrationband'>summarize calibration band  object</h2><span id='topic+summary.calibrationband'></span>

<h3>Description</h3>

<p>An object of class <code>calibrationband</code> contains the calibration band
coordinates, the pairs of original observation and forecast values,
and the recalibrated forecasts obtained by isotonic regression.
The function <code>summary.reliabilitydiag</code> calculates the areas of
miscalibration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'calibrationband'
summary(object, ..., iso_test = FALSE, n = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.calibrationband_+3A_object">object</code></td>
<td>
<p>object of class <code>calibrationband</code></p>
</td></tr>
<tr><td><code id="summary.calibrationband_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="summary.calibrationband_+3A_iso_test">iso_test</code></td>
<td>
<p>with <code>default = FALSE</code>. If <code>TRUE</code>, the decision of the isotonicity test is reported along side the crossings of the band. If the <code>calibrationband</code> is calculated with <code>nc=TRUE</code>, the bands are re-estimated with <code>nc=FALSE</code> using <code>digits=3</code>. The <code>alpha</code> from the <code>calibrationband</code> is used.</p>
</td></tr>
<tr><td><code id="summary.calibrationband_+3A_n">n</code></td>
<td>
<p>number of rows in output table.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>'summary.reliability'</code> object, which is also a
tibble (see <code><a href="tibble.html#topic+tibble">tibble::tibble()</a></code>) with columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
min_x </td><td style="text-align: left;"> minimal x-coordinate of  misscalibration segment (ordered by length). </td>
</tr>
<tr>
 <td style="text-align: left;">
max_x </td><td style="text-align: left;"> maximal x-coordinate of  misscalibration segment (ordered by length).
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
s=.8
n=10000
x &lt;- sort(runif(n))

p &lt;- function(x,s){p = 1/(1+((1/x*(1-x))^(s+1)));return(p)}
dat &lt;- data.frame(pr=x, y=rbinom(n,1,p(x,s)))

cb &lt;- calibration_bands(x=dat$pr, y=dat$y,alpha=0.05, method="round", digits =3)

summary(cb)
print(summary(cb), n=5)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
