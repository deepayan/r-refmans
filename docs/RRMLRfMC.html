<!DOCTYPE html><html><head><title>Help for package RRMLRfMC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RRMLRfMC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Aupdate'><p>Aupdate</p></a></li>
<li><a href='#cogdat'><p>Cognitive Dataset</p></a></li>
<li><a href='#derivativeB'><p>derivativeB</p></a></li>
<li><a href='#derivatives'><p>derivatives</p></a></li>
<li><a href='#expand'><p>expand</p></a></li>
<li><a href='#Gupdate'><p>Gupdate</p></a></li>
<li><a href='#norm'><p>norm</p></a></li>
<li><a href='#rrmultinom'><p>rrmultinom</p></a></li>
<li><a href='#sdfun'><p>sdfun</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Reduced-Rank Multinomial Logistic Regression for Markov Chains</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit the reduced-rank multinomial logistic regression model for Markov
    chains developed by Wang, Abner, Fardo, Schmitt, Jicha, Eldik and Kryscio
    (2021)&lt;<a href="https://doi.org/10.1002%2Fsim.8923">doi:10.1002/sim.8923</a>&gt; in R. It combines the ideas of multinomial
    logistic regression in Markov chains and reduced-rank. It is very useful in 
    a study where multi-states model is assumed and each transition among the 
    states is controlled by a series of covariates. The key advantage is to 
    reduce the number of parameters to be estimated. The final coefficients for 
    all the covariates and the p-values for the interested covariates will be 
    reported. The p-values for the whole coefficient matrix can be calculated by 
    two bootstrap methods.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>nnet</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-04 19:05:32 UTC; pwa24</td>
</tr>
<tr>
<td>Author:</td>
<td>Pei Wang [aut, cre],
  Richard Kryscio [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pei Wang &lt;wangp33@miamioh.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-07 07:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='Aupdate'>Aupdate</h2><span id='topic+Aupdate'></span>

<h3>Description</h3>

<p>This function is used to update A matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Aupdate(Dfix, Gamma, Adata, R, p, q, I, iniA, eps, refA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Aupdate_+3A_dfix">Dfix</code></td>
<td>
<p>the coefficient matrix for study covariates</p>
</td></tr>
<tr><td><code id="Aupdate_+3A_gamma">Gamma</code></td>
<td>
<p>the G matrix value</p>
</td></tr>
<tr><td><code id="Aupdate_+3A_adata">Adata</code></td>
<td>
<p>the dataset</p>
</td></tr>
<tr><td><code id="Aupdate_+3A_r">R</code></td>
<td>
<p>the rank of reduced rank model</p>
</td></tr>
<tr><td><code id="Aupdate_+3A_p">p</code></td>
<td>
<p>the number of covariates in the dimension reduction</p>
</td></tr>
<tr><td><code id="Aupdate_+3A_q">q</code></td>
<td>
<p>the numbne of study covariates</p>
</td></tr>
<tr><td><code id="Aupdate_+3A_i">I</code></td>
<td>
<p>a U by U incidence matrix with elements; I(i,j)=1 if state j can be
accessed from state i in one step and 0 otherwise</p>
</td></tr>
<tr><td><code id="Aupdate_+3A_inia">iniA</code></td>
<td>
<p>initial value for the iteration</p>
</td></tr>
<tr><td><code id="Aupdate_+3A_eps">eps</code></td>
<td>
<p>the tolerance for convergence, default is 10^-5</p>
</td></tr>
<tr><td><code id="Aupdate_+3A_refa">refA</code></td>
<td>
<p>a vector of reference categories</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of outputs:
</p>

<ul>
<li><p> NewA: the updated A matrix
</p>
</li>
<li><p> loglikeA: the loglikelihood when updating A
</p>
</li></ul>


<hr>
<h2 id='cogdat'>Cognitive Dataset</h2><span id='topic+cogdat'></span>

<h3>Description</h3>

<p>A dataset containing the states and covariates of 649 participants enrolled in
the BRAiNS cohort at the University of Kentucky's Alzheimer's Disease Research
Center.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cogdat
</code></pre>


<h3>Format</h3>

<p>A data frame with 6240 rows and 14 columns:
</p>

<dl>
<dt>ID</dt><dd><p>used to denote the participants; from 1 to 649</p>
</dd>
<dt>visitno</dt><dd><p>used to denote the visit number for each participant</p>
</dd>
<dt>prstate</dt><dd><p>denote the previous state </p>
</dd>
<dt>custate</dt><dd><p>denote the current state</p>
</dd>
<dt>bagec</dt><dd><p>baseline age (centered at age 72)</p>
</dd>
<dt>famhx</dt><dd><p>family history of dementia</p>
</dd>
<dt>HBP</dt><dd><p>self reported high blood pressure</p>
</dd>
<dt>apoe4</dt><dd><p> at least one Apolipoprotein-E (APOE) gene <code class="reqn">\epsilon</code>4 allele</p>
</dd>
<dt>smk1</dt><dd><p>cigarette smoking level (none versus &lt; 10)</p>
</dd>
<dt>smk2</dt><dd><p>cigarette smoking level (11-19)</p>
</dd>
<dt>smk2</dt><dd><p>cigarette smoking level (&gt;= 20 pack years))</p>
</dd>
<dt>lowed</dt><dd><p>low education</p>
</dd>
<dt>headinj</dt><dd><p>self reported head injury</p>
</dd>
</dl>


<hr>
<h2 id='derivativeB'>derivativeB</h2><span id='topic+derivativeB'></span>

<h3>Description</h3>

<p>This function is used to calculate the loglikelihood with a given matrix B=AG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>derivativeB(B, I, zy, refd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="derivativeB_+3A_b">B</code></td>
<td>
<p>a numeric coefficient matrix</p>
</td></tr>
<tr><td><code id="derivativeB_+3A_i">I</code></td>
<td>
<p>U by U incidence matrix with elements; I(i,j)=1 if state j can be
accessed from state i in one step and 0 otherwise</p>
</td></tr>
<tr><td><code id="derivativeB_+3A_zy">zy</code></td>
<td>
<p>the variable values for a given observation</p>
</td></tr>
<tr><td><code id="derivativeB_+3A_refd">refd</code></td>
<td>
<p>a vector of reference categories</p>
</td></tr>
</table>


<h3>Value</h3>

<p>loglikelihood
</p>

<hr>
<h2 id='derivatives'>derivatives</h2><span id='topic+derivatives'></span>

<h3>Description</h3>

<p>This function is used calculate the derivative values (first and second derivatives
for Newton-Raphson method) and loglikelihood when updating A
</p>


<h3>Usage</h3>

<pre><code class='language-R'>derivatives(A, Gamma, Dmat, I, zy, refA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="derivatives_+3A_a">A</code></td>
<td>
<p>matrix with value from previous iteration</p>
</td></tr>
<tr><td><code id="derivatives_+3A_gamma">Gamma</code></td>
<td>
<p>G matrix values</p>
</td></tr>
<tr><td><code id="derivatives_+3A_dmat">Dmat</code></td>
<td>
<p>the coefficient matrix for the fixed variables,</p>
</td></tr>
<tr><td><code id="derivatives_+3A_i">I</code></td>
<td>
<p>a U by U incidence matrix with elements; I(i,j)=1 if state j can be
accessed from state i in one step and 0 otherwise</p>
</td></tr>
<tr><td><code id="derivatives_+3A_zy">zy</code></td>
<td>
<p>the variable values for a given observation</p>
</td></tr>
<tr><td><code id="derivatives_+3A_refa">refA</code></td>
<td>
<p>a vector of reference categories</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of outputs:
</p>

<ul>
<li><p> fird: the first derivative value
</p>
</li>
<li><p> secd: the second derivative value
</p>
</li>
<li><p> loglike: the loglikelihood
</p>
</li></ul>


<hr>
<h2 id='expand'>expand</h2><span id='topic+expand'></span>

<h3>Description</h3>

<p>This function is used to expand the Y(category) to a indicator vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand(pri, curr, I, refE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand_+3A_pri">pri</code></td>
<td>
<p>the prior state</p>
</td></tr>
<tr><td><code id="expand_+3A_curr">curr</code></td>
<td>
<p>the current state</p>
</td></tr>
<tr><td><code id="expand_+3A_i">I</code></td>
<td>
<p>a U by U incidence matrix with elements; I(i,j)=1 if state j can be
accessed from state i in one step and 0 otherwise</p>
</td></tr>
<tr><td><code id="expand_+3A_refe">refE</code></td>
<td>
<p>a vector with the reference categories</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ry: a indicator vector
</p>

<hr>
<h2 id='Gupdate'>Gupdate</h2><span id='topic+Gupdate'></span>

<h3>Description</h3>

<p>This function is used to update G matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gupdate(A, Gdata, p, q, I, refG)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Gupdate_+3A_a">A</code></td>
<td>
<p>numeric matrix</p>
</td></tr>
<tr><td><code id="Gupdate_+3A_gdata">Gdata</code></td>
<td>
<p>the dataset used to update G</p>
</td></tr>
<tr><td><code id="Gupdate_+3A_p">p</code></td>
<td>
<p>the number of covariates in the dimension reduction</p>
</td></tr>
<tr><td><code id="Gupdate_+3A_q">q</code></td>
<td>
<p>the numbne of study covariates</p>
</td></tr>
<tr><td><code id="Gupdate_+3A_i">I</code></td>
<td>
<p>a U by U incidence matrix with elements; I(i,j)=1 if state j can be
accessed from state i in one step and 0 otherwise</p>
</td></tr>
<tr><td><code id="Gupdate_+3A_refg">refG</code></td>
<td>
<p>a vector of reference categories</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of outputs:
</p>

<ul>
<li><p> NewG: the updated G matrix
</p>
</li>
<li><p> loglikeK: the loglikelihood when updating G
</p>
</li>
<li><p> sderr: standard errors for the coefficient matrix
</p>
</li></ul>


<hr>
<h2 id='norm'>norm</h2><span id='topic+norm'></span>

<h3>Description</h3>

<p>This function is used to normalize a vector to have unit length
</p>


<h3>Usage</h3>

<pre><code class='language-R'>norm(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="norm_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a normalized vector with length 1
</p>

<hr>
<h2 id='rrmultinom'>rrmultinom</h2><span id='topic+rrmultinom'></span>

<h3>Description</h3>

<p>This function is used to fit the reduced rank multinomial logistic regression
for markov chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rrmultinom(I, z1 = NULL, z2 = NULL, T, R, eps = 1e-05, ref = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rrmultinom_+3A_i">I</code></td>
<td>
<p>a U by U incidence matrix with elements; U is number of states; I(i,j)=1
if state j can be accessed from state i in one step and 0 otherwise</p>
</td></tr>
<tr><td><code id="rrmultinom_+3A_z1">z1</code></td>
<td>
<p>a n by p matrix with covariates involved in the dimension reduction(DR),
n is the number of subjects, p is the number of covariates involved in DR</p>
</td></tr>
<tr><td><code id="rrmultinom_+3A_z2">z2</code></td>
<td>
<p>a n by q matrix with study covariates (not in dimension reduction),
q is the number of study covariates</p>
</td></tr>
<tr><td><code id="rrmultinom_+3A_t">T</code></td>
<td>
<p>a M by 3 state matrix,
</p>

<ul>
<li><p> the first column is a subject number between 1,..,n;
</p>
</li>
<li><p> the second column is time;
</p>
</li>
<li><p> the third column is the state occupied by subject in column 1 at time indicated
in column 2
</p>
</li></ul>
</td></tr>
<tr><td><code id="rrmultinom_+3A_r">R</code></td>
<td>
<p>the rank</p>
</td></tr>
<tr><td><code id="rrmultinom_+3A_eps">eps</code></td>
<td>
<p>the tolerance for convergence; the default is 10^-5</p>
</td></tr>
<tr><td><code id="rrmultinom_+3A_ref">ref</code></td>
<td>
<p>a vector of reference categories; the default is NULL and if NULL
is used, the function will use the first category as the reference category
for each row</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of outputs:
</p>

<ul>
<li><p> Alpha: the final A matrix
</p>
</li>
<li><p> Gamma: the final G matrix
</p>
</li>
<li><p> Beta: the coefficient matrix for variables involved in reduced rank
</p>
</li>
<li><p> Dcoe: the coefficient matrix for the fixed variables
</p>
</li>
<li><p> Dsderr: the standard error matrix for the fixed variables
</p>
</li>
<li><p> Dpval: the p-value matrix for the fixed variables
</p>
</li>
<li><p> coemat: the overall coefficient matrix
</p>
</li>
<li><p> niter: the iteration number to get converged
</p>
</li>
<li><p> df: the degrees of freedom
</p>
</li>
<li><p> loglik: the final loglikelihood
</p>
</li>
<li><p> converge: three possible values with 0 means fail to converge, 1 means
converges, and 2 means the maximum iteration is achieved
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># generate the Markov chain
U=7
I1=I2=I3=rep(1,7)
I4=c(0,0,0,1,1,1,1)
I5=I6=I7=rep(0,7)
I=rbind(I1,I2,I3,I4,I5,I6,I7)
# prepare the data
data=cogdat
n=length(unique(data[,1]))
M=nrow(data)+n
Mc=0
z=matrix(0,n,9)
colnames(z)=colnames(data)[5:13]
T=matrix(0,M,3)
for(i in 1:n){
 subdat=data[which(data[,1]==i),,drop=FALSE]
 z[i,]=subdat[1,5:13]
 mc=nrow(subdat)
 T[(Mc+1):(Mc+mc+1),1]=i
 T[(Mc+1):(Mc+mc+1),2]=0:mc
 T[(Mc+1):(Mc+mc+1),3]=c(subdat[1,3],subdat[,4])
 Mc=Mc+mc+1
}
#z1=z[,c(1:3),drop=FALSE]
z2=z[,4,drop=FALSE]
# fit the model with rank 1
rrmultinom(I,z1=NULL,z2,T,1,eps=9,ref=c(1,1,1,4))

</code></pre>

<hr>
<h2 id='sdfun'>sdfun</h2><span id='topic+sdfun'></span>

<h3>Description</h3>

<p>This function is used get the standard error matrix from bootstrap method
It returns the matrices of standard error and p-value for the coefficient matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdfun(I, z1 = NULL, z2 = NULL, T, R, eps = 1e-05, B, tpoint = NULL, ref)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sdfun_+3A_i">I</code></td>
<td>
<p>a U by U incidence matrix with elements; U is the number of states;
I(i,j)=1 if state j can be accessed from state i in one step and 0 otherwise</p>
</td></tr>
<tr><td><code id="sdfun_+3A_z1">z1</code></td>
<td>
<p>a n by p matrix with covariates involved in the dimension reduction(DR),
n is the number of subjects, p is the number of covariates involved in DR</p>
</td></tr>
<tr><td><code id="sdfun_+3A_z2">z2</code></td>
<td>
<p>a n by q matrix with study covariates (not in dimension reduction),
q is the number of study covariates</p>
</td></tr>
<tr><td><code id="sdfun_+3A_t">T</code></td>
<td>
<p>a M by 3 state matrix,
</p>

<ul>
<li><p> the first column is a subject number between 1,..,n;
</p>
</li>
<li><p> the second column is time;
</p>
</li>
<li><p> the third column is the state occupied by subject in column 1 at time
indicated in column 2
</p>
</li></ul>
</td></tr>
<tr><td><code id="sdfun_+3A_r">R</code></td>
<td>
<p>the rank</p>
</td></tr>
<tr><td><code id="sdfun_+3A_eps">eps</code></td>
<td>
<p>the tolerance for convergence; the default is 10^-5</p>
</td></tr>
<tr><td><code id="sdfun_+3A_b">B</code></td>
<td>
<p>the bootstrap number</p>
</td></tr>
<tr><td><code id="sdfun_+3A_tpoint">tpoint</code></td>
<td>
<p>a matrix has two columns with the participants' visit information
about timeline</p>
</td></tr>
<tr><td><code id="sdfun_+3A_ref">ref</code></td>
<td>
<p>a vector of reference categories</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of outputs:
</p>

<ul>
<li><p> coe: the coefficient matrix of the original data
</p>
</li>
<li><p> sd: the standard error matrix
</p>
</li>
<li><p> pvalue: the p-value matrix
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># generate the Markov chain
U=7
I1=I2=I3=rep(1,7)
I4=c(0,0,0,1,1,1,1)
I5=I6=I7=rep(0,7)
I=rbind(I1,I2,I3,I4,I5,I6,I7)
# prepare the data
data=cogdat
n=length(unique(data[,1]))
M=nrow(data)+n
Mc=0
z=matrix(0,n,9)
colnames(z)=colnames(data)[5:13]
T=matrix(0,M,3)
for(i in 1:n){
  subdat=data[which(data[,1]==i),,drop=FALSE]
  z[i,]=subdat[1,5:13]
  mc=nrow(subdat)
  T[(Mc+1):(Mc+mc+1),1]=i
  T[(Mc+1):(Mc+mc+1),2]=0:mc
  T[(Mc+1):(Mc+mc+1),3]=c(subdat[1,3],subdat[,4])
 Mc=Mc+mc+1
}
#z1=z[,c(1:3),drop=FALSE]
z2=z[,4,drop=FALSE]
# find the standard deviation matrix for the model with rank 1
sdfun(I,z1=NULL,z2,T,1,eps = 9,2,ref=c(1,1,1,4))




</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
