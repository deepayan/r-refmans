<!DOCTYPE html><html><head><title>Help for package AVGAS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AVGAS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ABC'><p>Evaluating ABC for each fitted model<br /></p></a></li>
<li><a href='#AVGAS'><p>A Variable selection using Genetic AlgorithmS</p></a></li>
<li><a href='#cross'><p>Performing crossover<br /></p></a></li>
<li><a href='#detect'><p>Suggesting values for <code>r2</code></p></a></li>
<li><a href='#Extract'><p>Extracting specific columns from a data<br /></p></a></li>
<li><a href='#Genone'><p>Gathering useful information for first generation</p></a></li>
<li><a href='#initial'><p>Setting up initial candidate models<br /></p></a></li>
<li><a href='#mut'><p>Performing mutation<br /></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>A Variable Selection using Genetic Algorithms</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>We provide a stage-wise selection method using genetic algorithm which can perform fast interaction selection in high-dimensional linear regression models with two-way interaction effects under strong, weak, or no heredity condition. Ye, C.,and Yang,Y. (2019) &lt;<a href="https://doi.org/10.1109%2FTIT.2019.2913417">doi:10.1109/TIT.2019.2913417</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, Matrix, pracma, stats, dplyr, selectiveInference,
VariableScreening, ggplot2</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Author:</td>
<td>Leiyue Li [aut, cre],
  Chenglong Ye [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Leiyue Li &lt;lli289.git@gmail.com&gt;</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-20 13:15:20 UTC; lilli</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-20 16:20:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='ABC'>Evaluating ABC for each fitted model<br /></h2><span id='topic+ABC'></span>

<h3>Description</h3>

<p>This function evaluates ABC score for fitted model, one model at a time. For a model I,
the ABC is defined as
</p>
<p style="text-align: center;"><code class="reqn">ABC(I)=\sum\limits_{i=1}^n\bigg(Y_i-\hat{Y}_i^{I}\bigg)^2+2r_I\sigma^2+\lambda\sigma^2C_I.</code>
</p>

<p>When comparing ABC of fitted models to the same data set, the smaller
the ABC, the better fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ABC(
  X,
  y,
  heredity = "Strong",
  nmain.p,
  sigma = NULL,
  extract = "No",
  varind = NULL,
  interaction.ind = NULL,
  pi1 = 0.32,
  pi2 = 0.32,
  pi3 = 0.32,
  lambda = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ABC_+3A_x">X</code></td>
<td>
<p>Input data. An optional data frame, or numeric matrix of dimension
<code>n</code> by <code>nmain.p</code>. Note that the two-way interaction effects should not
be included in <code>X</code> because this function automatically generates the
corresponding two-way interaction effects if needed.</p>
</td></tr>
<tr><td><code id="ABC_+3A_y">y</code></td>
<td>
<p>Response variable. A <code>n</code>-dimensional vector, where <code>n</code> is the number
of observations in <code>X</code>.</p>
</td></tr>
<tr><td><code id="ABC_+3A_heredity">heredity</code></td>
<td>
<p>Whether to enforce Strong, Weak, or No heredity. Default is &quot;Strong&quot;.</p>
</td></tr>
<tr><td><code id="ABC_+3A_nmain.p">nmain.p</code></td>
<td>
<p>A numeric value that represents the total number of main effects
in <code>X</code>.</p>
</td></tr>
<tr><td><code id="ABC_+3A_sigma">sigma</code></td>
<td>
<p>The standard deviation of the noise term. In practice, sigma is usually
unknown. In such case, this function automatically estimate sigma using root mean
square error (RMSE). Default is NULL. Otherwise, users need to enter a numeric value.</p>
</td></tr>
<tr><td><code id="ABC_+3A_extract">extract</code></td>
<td>
<p>A either &quot;Yes&quot; or &quot;No&quot; logical vector that represents whether or not
to extract specific columns from <code>X</code>. Default is &quot;No&quot;.</p>
</td></tr>
<tr><td><code id="ABC_+3A_varind">varind</code></td>
<td>
<p>Only used when <code>extract = "Yes"</code>. A numeric vector of class
<code>c()</code> that specifies the indices of variables to be extracted from <code>X</code>.
If <code>varind</code> contains indices of two-way interaction effects, then this function
automatically generates corresponding two-way interaction effects from <code>X</code>.</p>
</td></tr>
<tr><td><code id="ABC_+3A_interaction.ind">interaction.ind</code></td>
<td>
<p>Only used when <code>extract = "Yes"</code>. A two-column numeric
matrix containing all possible two-way interaction effects. It must be generated
outside of this function using <code>t(utils::combn())</code> or <code>indchunked()</code>. See Example section for
details.</p>
</td></tr>
<tr><td><code id="ABC_+3A_pi1">pi1</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td></tr>
<tr><td><code id="ABC_+3A_pi2">pi2</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td></tr>
<tr><td><code id="ABC_+3A_pi3">pi3</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td></tr>
<tr><td><code id="ABC_+3A_lambda">lambda</code></td>
<td>
<p>A numeric value defined by users. Default is 10.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> For inputs <code>pi1</code>, <code>pi2</code>, and <code>pi3</code>, the number needs to
satisfy the condition: <code class="reqn">\pi_1+\pi_2+\pi_3=1-\pi_0</code> where <code class="reqn">\pi_0</code>
is a numeric value between 0 and 1, the smaller the better.
</p>
</li>
<li><p> For input <code>lambda</code>, the number needs to satisfy the condition:
<code class="reqn">\lambda\geq 5.1/log(2)</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A numeric value is returned. It represents the ABC score of the fitted model.
</p>


<h3>References</h3>

<p>Ye, C. and Yang, Y., 2019. <em>High-dimensional adaptive minimax sparse estimation with interactions.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Extract">Extract</a></code>, <code><a href="#topic+initial">initial</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># sigma is unknown
set.seed(0)
nmain.p &lt;- 4
interaction.ind &lt;- t(combn(4,2))
X &lt;- matrix(rnorm(50*4,1,0.1), 50, 4)
epl &lt;- rnorm(50,0,0.01)
y&lt;- 1+X[,1]+X[,2]+X[,3]+X[,4]+epl
ABC(X, y, nmain.p = 4, interaction.ind = interaction.ind)
ABC(X, y, nmain.p = 4, extract = "Yes",
    varind = c(1,2,5), interaction.ind = interaction.ind)
#'
# users want to enter a suggested value for sigma

# model with only one predictor
try(ABC(X, y, nmain.p = 4, extract = "Yes",
  varind = 1, interaction.ind = interaction.ind)) # warning message
</code></pre>

<hr>
<h2 id='AVGAS'>A Variable selection using Genetic AlgorithmS</h2><span id='topic+AVGAS'></span>

<h3>Description</h3>

<p>A Variable selection using Genetic AlgorithmS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AVGAS(
  X,
  y,
  heredity = "Strong",
  nmain.p,
  r1,
  r2,
  sigma = NULL,
  interaction.ind = NULL,
  lambda = 10,
  q = 40,
  allout = "No",
  interonly = "No",
  pi1 = 0.32,
  pi2 = 0.32,
  pi3 = 0.32,
  aprob = 0.9,
  dprob = 0.9,
  aprobm = 0.1,
  aprobi = 0.9,
  dprobm = 0.9,
  dprobi = 0.1,
  take = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AVGAS_+3A_x">X</code></td>
<td>
<p>Input data. An optional data frame, or numeric matrix of dimension
<code>n</code> by <code>nmain.p</code>. Note that the two-way interaction effects should not
be included in <code>X</code> because this function automatically generates the
corresponding two-way interaction effects if needed.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_y">y</code></td>
<td>
<p>Response variable. A <code>n</code>-dimensional vector, where <code>n</code> is the number
of observations in <code>X</code>.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_heredity">heredity</code></td>
<td>
<p>Whether to enforce Strong, Weak, or No heredity. Default is &quot;Strong&quot;.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_nmain.p">nmain.p</code></td>
<td>
<p>A numeric value that represents the total number of main effects
in <code>X</code>.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_r1">r1</code></td>
<td>
<p>A numeric value indicating the maximum number of main effects. This number
can be different from the <code>r1</code> defined in <code><a href="#topic+detect">detect</a></code>.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_r2">r2</code></td>
<td>
<p>A numeric value indicating the maximum number of interaction effects. This number
can be different from the <code>r1</code> defined in <code><a href="#topic+detect">detect</a></code>.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_sigma">sigma</code></td>
<td>
<p>The standard deviation of the noise term. In practice, sigma is usually
unknown. In such case, this function automatically estimate sigma using root mean
square error (RMSE). Default is NULL. Otherwise, users need to enter a numeric value.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_interaction.ind">interaction.ind</code></td>
<td>
<p>A two-column numeric matrix containing all possible
two-way interaction effects. It must be generated outside of this function
using <code>t(utils::combn())</code>. See Example section for details.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_lambda">lambda</code></td>
<td>
<p>A numeric value defined by users. Default is 10.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_q">q</code></td>
<td>
<p>A numeric value indicating the number of models in each generation (e.g.,
the population size). Default is 40.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_allout">allout</code></td>
<td>
<p>Whether to print all outputs from this function. A &quot;Yes&quot; or &quot;No&quot;
logical vector. Default is &quot;No&quot;. See Value section for details.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_interonly">interonly</code></td>
<td>
<p>Whether or not to consider fitted models with only two-way
interaction effects. A “Yes&quot; or &quot;No&quot; logical vector. Default is &quot;No&quot;.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_pi1">pi1</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_pi2">pi2</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_pi3">pi3</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_aprob">aprob</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The addition probability during mutation. Default is 0.9.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_dprob">dprob</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The deletion probability during mutation. Default is 0.9.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_aprobm">aprobm</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The main effect addition probability during addition. Default is 0.1.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_aprobi">aprobi</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The interaction effect addition probability during addition. Default is 0.9.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_dprobm">dprobm</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The main effect deletion probability during deletion. Default is 0.9.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_dprobi">dprobi</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The interaction effect deletion probability during deletion. Default is 0.1.</p>
</td></tr>
<tr><td><code id="AVGAS_+3A_take">take</code></td>
<td>
<p>Only used when <code>allout = "No"</code>. Number of top candidate models
to display. Default is 3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of output. The components are:
</p>
<table>
<tr><td><code>final_model</code></td>
<td>
<p>The final selected model.</p>
</td></tr>
<tr><td><code>cleaned_candidate_model</code></td>
<td>
<p>All candidate models where each row corresponding
to a fitted model; the first 1 to <code>r1 + r2</code> columns representing the predictor
indices in that model, and the last column is a numeric value representing the
ABC score of that fitted model. Duplicated models are not allowed.</p>
</td></tr>
<tr><td><code>InterRank</code></td>
<td>
<p>Rank of all candidate interaction effects. A two-column numeric
matrix. The first column contains indices of ranked two-way interaction effects, and the
second column contains its corresponding ABC score.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+initial">initial</a></code>, <code><a href="#topic+cross">cross</a></code>, <code><a href="#topic+mut">mut</a></code>, <code><a href="#topic+ABC">ABC</a></code>, <code><a href="#topic+Genone">Genone</a></code>, and <code><a href="#topic+Extract">Extract</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># allout = "No"


# allout = "Yes"

</code></pre>

<hr>
<h2 id='cross'>Performing crossover<br /></h2><span id='topic+cross'></span>

<h3>Description</h3>

<p>This function performs crossover which only stores all fitted models without
making any comparison. The selected indices in each fitted model will be
automatically re-ordered so that main effects comes first, followed by
two-way interaction effects, and zero reservation spaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cross(parents, heredity = "Strong", nmain.p, r1, r2, interaction.ind = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cross_+3A_parents">parents</code></td>
<td>
<p>A numeric matrix of dimension <code>q</code> by <code>r1+r2</code>,
obtained from <code>initial</code> or previous generation where each row corresponding
a fitted model and each column representing the predictor index in the fitted model.</p>
</td></tr>
<tr><td><code id="cross_+3A_heredity">heredity</code></td>
<td>
<p>Whether to enforce Strong, Weak, or No heredity. Default is &quot;Strong&quot;.</p>
</td></tr>
<tr><td><code id="cross_+3A_nmain.p">nmain.p</code></td>
<td>
<p>A numeric value that represents the total number of main effects
in <code>X</code>.</p>
</td></tr>
<tr><td><code id="cross_+3A_r1">r1</code></td>
<td>
<p>A numeric value indicating the maximum number of main effects.</p>
</td></tr>
<tr><td><code id="cross_+3A_r2">r2</code></td>
<td>
<p>A numeric value indicating the maximum number of interaction effects.</p>
</td></tr>
<tr><td><code id="cross_+3A_interaction.ind">interaction.ind</code></td>
<td>
<p>A two-column numeric matrix containing all possible
two-way interaction effects. It must be generated outside of this function
using <code>t(utils::combn())</code>. See Example section for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix <code>single.child.bit</code> is returned. Each row representing
a fitted model, and each column corresponding to the predictor index in the fitted model.
Duplicated models are allowed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+initial">initial</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Under Strong heredity
set.seed(0)
nmain.p &lt;- 4
interaction.ind &lt;- t(combn(4,2))
X &lt;- matrix(rnorm(50*4,1,0.1), 50, 4)
epl &lt;- rnorm(50,0,0.01)
y&lt;- 1+X[,1]+X[,2]+X[,1]*X[,2]+epl
p1 &lt;- initial(X, y, nmain.p = 4, r1 = 3, r2 = 3,
    interaction.ind = interaction.ind, q = 5)
c1 &lt;- cross(p1, nmain.p=4, r1 = 3, r2 = 3,
    interaction.ind = interaction.ind)
</code></pre>

<hr>
<h2 id='detect'>Suggesting values for <code>r2</code></h2><span id='topic+detect'></span>

<h3>Description</h3>

<p>This function suggests the values for <code>r2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect(
  X,
  y,
  heredity = "Strong",
  nmain.p,
  sigma = NULL,
  r1,
  r2,
  interaction.ind = NULL,
  pi1 = 0.32,
  pi2 = 0.32,
  pi3 = 0.32,
  lambda = 10,
  q = 40
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_+3A_x">X</code></td>
<td>
<p>Input data. An optional data frame, or numeric matrix of dimension
<code>n</code> by <code>nmain.p</code>. Note that the two-way interaction effects should not
be included in <code>X</code> because this function automatically generates the
corresponding two-way interaction effects if needed.</p>
</td></tr>
<tr><td><code id="detect_+3A_y">y</code></td>
<td>
<p>Response variable. A <code>n</code>-dimensional vector, where <code>n</code> is the number
of observations in <code>X</code>.</p>
</td></tr>
<tr><td><code id="detect_+3A_heredity">heredity</code></td>
<td>
<p>Whether to enforce Strong, Weak, or No heredity. Default is &quot;Strong&quot;.</p>
</td></tr>
<tr><td><code id="detect_+3A_nmain.p">nmain.p</code></td>
<td>
<p>A numeric value that represents the total number of main effects
in <code>X</code>.</p>
</td></tr>
<tr><td><code id="detect_+3A_sigma">sigma</code></td>
<td>
<p>The standard deviation of the noise term. In practice, sigma is usually
unknown. In such case, this function automatically estimate sigma using root mean
square error (RMSE). Default is NULL. Otherwise, users need to enter a numeric value.</p>
</td></tr>
<tr><td><code id="detect_+3A_r1">r1</code></td>
<td>
<p>A numeric value indicating the maximum number of main effects.</p>
</td></tr>
<tr><td><code id="detect_+3A_r2">r2</code></td>
<td>
<p>A numeric value indicating the maximum number of interaction effects.</p>
</td></tr>
<tr><td><code id="detect_+3A_interaction.ind">interaction.ind</code></td>
<td>
<p>A two-column numeric matrix containing all possible
two-way interaction effects. It must be generated outside of this function
using <code>t(utils::combn())</code>. See Example section for details.</p>
</td></tr>
<tr><td><code id="detect_+3A_pi1">pi1</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="detect_+3A_pi2">pi2</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="detect_+3A_pi3">pi3</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="detect_+3A_lambda">lambda</code></td>
<td>
<p>A numeric value defined by users. Default is 10.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="detect_+3A_q">q</code></td>
<td>
<p>A numeric value indicating the number of models in each generation (e.g.,
the population size). Default is 40.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of output. The components are:
</p>
<table>
<tr><td><code>InterRank</code></td>
<td>
<p>Rank of all candidate interaction effects. A two-column numeric
matrix. The first column contains indices of ranked two-way interaction effects, and the
second column contains its corresponding ABC score.</p>
</td></tr>
<tr><td><code>mainind.sel</code></td>
<td>
<p>Selected main effects.  A <code>r1</code>-dimensional vector.</p>
</td></tr>
<tr><td><code>mainpool</code></td>
<td>
<p>Ranked main effects in <code>X</code>.</p>
</td></tr>
<tr><td><code>plot</code></td>
<td>
<p>Plot of potential interaction effects and their corresponding ABC scores.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+initial">initial</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># under Strong heredity

# under No heredity
set.seed(0)
nmain.p &lt;- 4
interaction.ind &lt;- t(combn(4,2))
X &lt;- matrix(rnorm(50*4,1,0.1), 50, 4)
epl &lt;- rnorm(50,0,0.01)
y&lt;- 1+X[,1]+X[,2]+X[,1]*X[,2]+epl
d2 &lt;- detect(X, y, heredity = "No", nmain.p = 4, r1 = 3, r2 = 3,
    interaction.ind = interaction.ind, q = 5)

</code></pre>

<hr>
<h2 id='Extract'>Extracting specific columns from a data<br /></h2><span id='topic+Extract'></span>

<h3>Description</h3>

<p>This function extracts specific columns from <code>X</code> based on <code>varind</code>.
It provides an efficient procedure for conducting ABC evaluation,
especially when working with high-dimensional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Extract(X, varind, interaction.ind = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Extract_+3A_x">X</code></td>
<td>
<p>Input data. An optional data frame, or numeric matrix of dimension
<code>n</code> by <code>nmain.p</code>. Note that the two-way interaction effects should not
be included in <code>X</code> because this function automatically generates the
corresponding two-way interaction effects if needed.</p>
</td></tr>
<tr><td><code id="Extract_+3A_varind">varind</code></td>
<td>
<p>A numeric vector of class <code>c()</code> that specifies the indices
of variables to be extracted from <code>X</code>. Duplicated values are not allowed.
See Example section for details.</p>
</td></tr>
<tr><td><code id="Extract_+3A_interaction.ind">interaction.ind</code></td>
<td>
<p>A two-column numeric matrix containing all possible
two-way interaction effects. It must be generated outside of this function using
<code>t(utils::combn())</code>. See Example section for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please be aware that this function automatically renames column names
into a designated format (e.g., X.1, X.2 for main effects, and X.1X.2 for
interaction effect, etc), regardless of the original column names in <code>X</code>.
</p>
<p>Under no heredity condition, this function can be applied in the context of
interaction only linear regression models. See Example section for details.
</p>


<h3>Value</h3>

<p>A numeric matrix is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ABC">ABC</a></code>, <code><a href="#topic+initial">initial</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Extract main effect X1 and X2 from X1,...X4
set.seed(0)
X1 &lt;- matrix(rnorm(20), ncol = 4)
y1 &lt;- X1[, 2] + rnorm(5)
interaction.ind &lt;- t(combn(4,2))

# Extract main effect X1 and interaction effect X1X2 from X1,..X4
Extract(X1, varind = c(1,5), interaction.ind)

# Extract interaction effect X1X2 from X1,...X4
Extract(X1, varind = 5, interaction.ind)

# Extract using duplicated values in varind.
try(Extract(X1, varind = c(1,1), interaction.ind)) # this will not run
</code></pre>

<hr>
<h2 id='Genone'>Gathering useful information for first generation</h2><span id='topic+Genone'></span>

<h3>Description</h3>

<p>This function automatically ranks all candidate interaction effects under
Strong, Weak, or No heredity condition, compare and obtain first generation
candidate models. The selected models will be re-ordered so that main effects
come first, followed by interaction effects. Only two-way interaction effects
will be considered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Genone(
  X,
  y,
  heredity = "Strong",
  nmain.p,
  r1,
  r2,
  sigma = NULL,
  interaction.ind = NULL,
  lambda = 10,
  q = 40,
  allout = "No",
  interonly = "No",
  pi1 = 0.32,
  pi2 = 0.32,
  pi3 = 0.32,
  aprob = 0.9,
  dprob = 0.9,
  aprobm = 0.1,
  aprobi = 0.9,
  dprobm = 0.9,
  dprobi = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Genone_+3A_x">X</code></td>
<td>
<p>Input data. An optional data frame, or numeric matrix of dimension
<code>n</code> by <code>nmain.p</code>. Note that the two-way interaction effects should not
be included in <code>X</code> because this function automatically generates the
corresponding two-way interaction effects if needed.</p>
</td></tr>
<tr><td><code id="Genone_+3A_y">y</code></td>
<td>
<p>Response variable. A <code>n</code>-dimensional vector, where <code>n</code> is the number
of observations in <code>X</code>.</p>
</td></tr>
<tr><td><code id="Genone_+3A_heredity">heredity</code></td>
<td>
<p>Whether to enforce Strong, Weak, or No heredity. Default is &quot;Strong&quot;.</p>
</td></tr>
<tr><td><code id="Genone_+3A_nmain.p">nmain.p</code></td>
<td>
<p>A numeric value that represents the total number of main effects
in <code>X</code>.</p>
</td></tr>
<tr><td><code id="Genone_+3A_r1">r1</code></td>
<td>
<p>A numeric value indicating the maximum number of main effects.</p>
</td></tr>
<tr><td><code id="Genone_+3A_r2">r2</code></td>
<td>
<p>A numeric value indicating the maximum number of interaction effects.</p>
</td></tr>
<tr><td><code id="Genone_+3A_sigma">sigma</code></td>
<td>
<p>The standard deviation of the noise term. In practice, sigma is usually
unknown. In such case, this function automatically estimate sigma using root mean
square error (RMSE). Default is NULL. Otherwise, users need to enter a numeric value.</p>
</td></tr>
<tr><td><code id="Genone_+3A_interaction.ind">interaction.ind</code></td>
<td>
<p>A two-column numeric matrix containing all possible
two-way interaction effects. It must be generated outside of this function
using <code>t(utils::combn())</code>. See Example section for details.</p>
</td></tr>
<tr><td><code id="Genone_+3A_lambda">lambda</code></td>
<td>
<p>A numeric value defined by users. Default is 10.
For guidance on selecting an appropriate value, please refer to the Details section.</p>
</td></tr>
<tr><td><code id="Genone_+3A_q">q</code></td>
<td>
<p>A numeric value indicating the number of models in each generation (e.g.,
the population size). Default is 40.</p>
</td></tr>
<tr><td><code id="Genone_+3A_allout">allout</code></td>
<td>
<p>Whether to print all outputs from this function. A &quot;Yes&quot; or &quot;No&quot;
logical vector. Default is &quot;No&quot;. See Value section for details.</p>
</td></tr>
<tr><td><code id="Genone_+3A_interonly">interonly</code></td>
<td>
<p>Whether or not to consider fitted models with only two-way
interaction effects. A “Yes&quot; or &quot;No&quot; logical vector. Default is &quot;No&quot;.</p>
</td></tr>
<tr><td><code id="Genone_+3A_pi1">pi1</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="Genone_+3A_pi2">pi2</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="Genone_+3A_pi3">pi3</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="Genone_+3A_aprob">aprob</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The addition probability during mutation. Default is 0.9.</p>
</td></tr>
<tr><td><code id="Genone_+3A_dprob">dprob</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The deletion probability during mutation. Default is 0.9.</p>
</td></tr>
<tr><td><code id="Genone_+3A_aprobm">aprobm</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The main effect addition probability during addition. Default is 0.1.</p>
</td></tr>
<tr><td><code id="Genone_+3A_aprobi">aprobi</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The interaction effect addition probability during addition. Default is 0.9.</p>
</td></tr>
<tr><td><code id="Genone_+3A_dprobm">dprobm</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The main effect deletion probability during deletion. Default is 0.9.</p>
</td></tr>
<tr><td><code id="Genone_+3A_dprobi">dprobi</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The interaction effect deletion probability during deletion. Default is 0.1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of output. The components are:
</p>
<table>
<tr><td><code>newparents</code></td>
<td>
<p> New parents models used for t+1-th generation. A numeric matrix
of dimension <code>q</code> by <code>r1+r2</code> where each row represents a fitted model.
Duplicated models are allowed.</p>
</td></tr>
<tr><td><code>parents_models</code></td>
<td>
<p> A numeric matrix containing all fitted models from
<code><a href="#topic+initial">initial</a></code>, <code><a href="#topic+cross">cross</a></code>, and <code><a href="#topic+mut">mut</a></code> where each
row corresponding to a fitted model and each column representing the predictor
index in that model. Duplicated models are allowed.</p>
</td></tr>
<tr><td><code>parents_models_cleaned</code></td>
<td>
<p> A numeric matrix containing fitted models from
<code><a href="#topic+initial">initial</a></code>, <code><a href="#topic+cross">cross</a></code>, and <code><a href="#topic+mut">mut</a></code> with ABC scores.
Each row corresponding to a fitted model; the first 1 to <code>r1 + r2</code> columns
representing the predictor indices in that model, and the last column is a numeric value
representing the ABC score of that fitted model. Duplicated models are not allowed.</p>
</td></tr>
<tr><td><code>InterRank</code></td>
<td>
<p> Rank of all candidate interaction effects. A two-column numeric
matrix. The first column contains indices of ranked two-way interaction effects, and the
second column contains its corresponding ABC score.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+initial">initial</a></code>, <code><a href="#topic+cross">cross</a></code>, <code><a href="#topic+mut">mut</a></code>, <code><a href="#topic+ABC">ABC</a></code>, and <code><a href="#topic+Extract">Extract</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># allout = "No"
set.seed(0)
nmain.p &lt;- 4
interaction.ind &lt;- t(combn(4,2))
X &lt;- matrix(rnorm(50*4,1,0.1), 50, 4)
epl &lt;- rnorm(50,0,0.01)
y &lt;- 1+X[,1]+X[,2]+X[,1]*X[,2]+epl
g1 &lt;- Genone(X, y, nmain.p = 4, r1= 3, r2=3,
    interaction.ind = interaction.ind, q = 5)

# allout = "Yes"
g2 &lt;- Genone(X, y, nmain.p = 4, r1= 3, r2=3,
    interaction.ind = interaction.ind, q = 5, allout = "Yes")
</code></pre>

<hr>
<h2 id='initial'>Setting up initial candidate models<br /></h2><span id='topic+initial'></span>

<h3>Description</h3>

<p>This function automatically ranks all candidate interaction effects under
Strong, Weak, or No heredity condition and obtains initial candidate models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initial(
  X,
  y,
  heredity = "Strong",
  nmain.p,
  sigma = NULL,
  r1,
  r2,
  interaction.ind = NULL,
  pi1 = 0.32,
  pi2 = 0.32,
  pi3 = 0.32,
  lambda = 10,
  q = 40
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initial_+3A_x">X</code></td>
<td>
<p>Input data. An optional data frame, or numeric matrix of dimension
<code>n</code> by <code>nmain.p</code>. Note that the two-way interaction effects should not
be included in <code>X</code> because this function automatically generates the
corresponding two-way interaction effects if needed.</p>
</td></tr>
<tr><td><code id="initial_+3A_y">y</code></td>
<td>
<p>Response variable. A <code>n</code>-dimensional vector, where <code>n</code> is the number
of observations in <code>X</code>.</p>
</td></tr>
<tr><td><code id="initial_+3A_heredity">heredity</code></td>
<td>
<p>Whether to enforce Strong, Weak, or No heredity. Default is &quot;Strong&quot;.</p>
</td></tr>
<tr><td><code id="initial_+3A_nmain.p">nmain.p</code></td>
<td>
<p>A numeric value that represents the total number of main effects
in <code>X</code>.</p>
</td></tr>
<tr><td><code id="initial_+3A_sigma">sigma</code></td>
<td>
<p>The standard deviation of the noise term. In practice, sigma is usually
unknown. In such case, this function automatically estimate sigma using root mean
square error (RMSE). Default is NULL. Otherwise, users need to enter a numeric value.</p>
</td></tr>
<tr><td><code id="initial_+3A_r1">r1</code></td>
<td>
<p>A numeric value indicating the maximum number of main effects. This number
can be different from the <code>r1</code> defined in <code><a href="#topic+detect">detect</a></code>.</p>
</td></tr>
<tr><td><code id="initial_+3A_r2">r2</code></td>
<td>
<p>A numeric value indicating the maximum number of interaction effects.
This number can be different from the <code>r2</code> defined in <code><a href="#topic+detect">detect</a></code>.</p>
</td></tr>
<tr><td><code id="initial_+3A_interaction.ind">interaction.ind</code></td>
<td>
<p>A two-column numeric matrix containing all possible
two-way interaction effects. It must be generated outside of this function
using <code>t(utils::combn())</code>. See Example section for details.</p>
</td></tr>
<tr><td><code id="initial_+3A_pi1">pi1</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="initial_+3A_pi2">pi2</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="initial_+3A_pi3">pi3</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users. Default is 0.32.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="initial_+3A_lambda">lambda</code></td>
<td>
<p>A numeric value defined by users. Default is 10.
For guidance on selecting an appropriate value, please refer to <code><a href="#topic+ABC">ABC</a></code>.</p>
</td></tr>
<tr><td><code id="initial_+3A_q">q</code></td>
<td>
<p>A numeric value indicating the number of models in each generation (e.g.,
the population size). Default is 40.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of output. The components are:
</p>
<table>
<tr><td><code>initialize</code></td>
<td>
<p>Initial candidate models. A numeric matrix of dimension <code>q</code> by
<code>r1+r2</code> where each row represents a fitted model. Duplicated models are allowed.</p>
</td></tr>
<tr><td><code>InterRank</code></td>
<td>
<p>Rank of all candidate interaction effects. A two-column numeric
matrix. The first column contains indices of ranked two-way interaction effects, and the
second column contains its corresponding ABC score.</p>
</td></tr>
<tr><td><code>mainind.sel</code></td>
<td>
<p>Selected main effects.  A <code>r1</code>-dimensional vector.</p>
</td></tr>
<tr><td><code>mainpool</code></td>
<td>
<p>Ranked main effects in <code>X</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+ABC">ABC</a></code>, <code><a href="#topic+Extract">Extract</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Under Strong heredity
</code></pre>

<hr>
<h2 id='mut'>Performing mutation<br /></h2><span id='topic+mut'></span>

<h3>Description</h3>

<p>This function performs mutation which only stores all fitted models without
making any comparison. The selected indices in each fitted model will be
automatically re-ordered so that main effects comes first, followed by
two-way interaction effects, and zero reservation spaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mut(
  parents,
  heredity = "Strong",
  nmain.p,
  r1,
  r2,
  interaction.ind = NULL,
  interonly = "No",
  aprob = 0.9,
  dprob = 0.9,
  aprobm = 0.1,
  aprobi = 0.9,
  dprobm = 0.9,
  dprobi = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mut_+3A_parents">parents</code></td>
<td>
<p>A numeric matrix of dimension <code>q</code> by <code>r1+r2</code>,
obtained from <code>initial</code> or previous generation where each row corresponding
a fitted model and each column representing the predictor index in the fitted model.</p>
</td></tr>
<tr><td><code id="mut_+3A_heredity">heredity</code></td>
<td>
<p>Whether to enforce Strong, Weak, or No heredity. Default is &quot;Strong&quot;.</p>
</td></tr>
<tr><td><code id="mut_+3A_nmain.p">nmain.p</code></td>
<td>
<p>A numeric value that represents the total number of main effects
in <code>X</code>.</p>
</td></tr>
<tr><td><code id="mut_+3A_r1">r1</code></td>
<td>
<p>A numeric value indicating the maximum number of main effects.</p>
</td></tr>
<tr><td><code id="mut_+3A_r2">r2</code></td>
<td>
<p>A numeric value indicating the maximum number of interaction effects.</p>
</td></tr>
<tr><td><code id="mut_+3A_interaction.ind">interaction.ind</code></td>
<td>
<p>A two-column numeric matrix containing all possible
two-way interaction effects. It must be generated outside of this function
using <code>t(utils::combn())</code>. See Example section for details.</p>
</td></tr>
<tr><td><code id="mut_+3A_interonly">interonly</code></td>
<td>
<p>Whether or not to consider fitted models with only two-way
interaction effects. A “Yes&quot; or &quot;No&quot; logical vector. Default is &quot;No&quot;.</p>
</td></tr>
<tr><td><code id="mut_+3A_aprob">aprob</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The addition probability during mutation. Default is 0.9.</p>
</td></tr>
<tr><td><code id="mut_+3A_dprob">dprob</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The deletion probability during mutation. Default is 0.9.</p>
</td></tr>
<tr><td><code id="mut_+3A_aprobm">aprobm</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The main effect addition probability during addition. Default is 0.1.</p>
</td></tr>
<tr><td><code id="mut_+3A_aprobi">aprobi</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The interaction effect addition probability during addition. Default is 0.9.</p>
</td></tr>
<tr><td><code id="mut_+3A_dprobm">dprobm</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The main effect deletion probability during deletion. Default is 0.9.</p>
</td></tr>
<tr><td><code id="mut_+3A_dprobi">dprobi</code></td>
<td>
<p>A numeric value between 0 and 1, defined by users.
The interaction effect deletion probability during deletion. Default is 0.1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix <code>single.child.mutated</code> is returned. Each row representing
a fitted model, and each column corresponding to the predictor index in the fitted model.
Duplicated models are allowed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+initial">initial</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Under Strong heredity, interonly = "No"
set.seed(0)
nmain.p &lt;- 4
interaction.ind &lt;- t(combn(4,2))
X &lt;- matrix(rnorm(50*4,1,0.1), 50, 4)
epl &lt;- rnorm(50,0,0.01)
y &lt;- 1+X[,1]+X[,2]+X[,1]*X[,2]+epl
p1 &lt;- initial(X, y, nmain.p = 4, r1 = 3, r2 = 3,
    interaction.ind = interaction.ind, q = 5)
m1 &lt;- mut(p1, nmain.p = 4, r1 = 3, r2 = 3,
    interaction.ind =interaction.ind)
# Under Strong heredity, interonly = "Yes"
m2 &lt;- mut(p1, heredity = "No", nmain.p = 4, r1 = 3, r2 = 3,
    interaction.ind =interaction.ind, interonly = "Yes")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
