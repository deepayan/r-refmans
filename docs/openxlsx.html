<!DOCTYPE html><html lang="en-US"><head><title>Help for package openxlsx</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {openxlsx}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#openxlsx'><p>xlsx reading, writing and editing.</p></a></li>
<li><a href='#activeSheet'><p>Get/set active sheet of the workbook</p></a></li>
<li><a href='#addCreator'><p>Add another author to the meta data of the file.</p></a></li>
<li><a href='#addFilter'><p>Add column filters</p></a></li>
<li><a href='#addStyle'><p>Add a style to a set of cells</p></a></li>
<li><a href='#addWorksheet'><p>Add a worksheet to a workbook</p></a></li>
<li><a href='#all.equal'><p>Check equality of workbooks</p></a></li>
<li><a href='#as_POSIXct_utc'><p>Convert to POSIXct with timezone UTC</p></a></li>
<li><a href='#as.character.formula'><p><code>as.character.formula()</code></p></a></li>
<li><a href='#auto_heights'><p>Compute optimal row heights</p></a></li>
<li><a href='#buildWorkbook'><p>Build Workbook</p></a></li>
<li><a href='#cloneWorksheet'><p>Clone a worksheet to a workbook</p></a></li>
<li><a href='#col2int'><p>Convert Excel column to integer</p></a></li>
<li><a href='#conditionalFormat'><p>Add conditional formatting to cells</p></a></li>
<li><a href='#conditionalFormatting'><p>Add conditional formatting to cells</p></a></li>
<li><a href='#convertFromExcelRef'><p>Convert excel column name to integer index</p></a></li>
<li><a href='#convertToDate'><p>Convert from excel date number to R Date type</p></a></li>
<li><a href='#convertToDateTime'><p>Convert from excel time number to R POSIXct type.</p></a></li>
<li><a href='#copyWorkbook'><p>Copy a Workbook object.</p></a></li>
<li><a href='#createComment'><p>create a Comment object</p></a></li>
<li><a href='#createNamedRegion'><p>Create / delete a named region.</p></a></li>
<li><a href='#createStyle'><p>Create a cell style</p></a></li>
<li><a href='#createWorkbook'><p>Create a new Workbook object</p></a></li>
<li><a href='#dataValidation'><p>Add data validation to cells</p></a></li>
<li><a href='#deleteData'><p>Delete cell data</p></a></li>
<li><a href='#deleteDataColumn'><p>Deletes a whole column from a workbook</p></a></li>
<li><a href='#freezePane'><p>Freeze a worksheet pane</p></a></li>
<li><a href='#get_worksheet_entries'><p>Get entries from workbook worksheet</p></a></li>
<li><a href='#getBaseFont'><p>Return the workbook default font</p></a></li>
<li><a href='#getCellRefs'><p>Return excel cell coordinates from (x,y) coordinates</p></a></li>
<li><a href='#getCreators'><p>Get the names of the authors from the meta data of the file.</p></a></li>
<li><a href='#getDateOrigin'><p>Get the date origin an xlsx file is using</p></a></li>
<li><a href='#getNamedRegions'><p>Get named regions</p></a></li>
<li><a href='#getSheetNames'><p>Get names of worksheets</p></a></li>
<li><a href='#getStyles'><p>Returns a list of all styles in the workbook</p></a></li>
<li><a href='#getTables'><p>List Excel tables in a workbook</p></a></li>
<li><a href='#groupColumns'><p>Group columns</p></a></li>
<li><a href='#groupRows'><p>Group Rows</p></a></li>
<li><a href='#if_null_then'><p>If NULL then ...</p></a></li>
<li><a href='#insertImage'><p>Insert an image into a worksheet</p></a></li>
<li><a href='#insertPlot'><p>Insert the current plot into a worksheet</p></a></li>
<li><a href='#int2col'><p>Convert integer to Excel column</p></a></li>
<li><a href='#loadWorkbook'><p>Load an existing .xlsx file</p></a></li>
<li><a href='#makeHyperlinkString'><p>create Excel hyperlink string</p></a></li>
<li><a href='#mergeCells'><p>Merge cells within a worksheet</p></a></li>
<li><a href='#modifyBaseFont'><p>Modify the default font</p></a></li>
<li><a href='#names'><p>get or set worksheet names</p></a></li>
<li><a href='#openXL'><p>Open a Microsoft Excel file (xls/xlsx) or an openxlsx Workbook</p></a></li>
<li><a href='#openxlsx_options'><p>openxlsx Options</p></a></li>
<li><a href='#openxlsxFontSizeLookupTable'><p>Font Size Lookup tables</p></a></li>
<li><a href='#pageBreak'><p>add a page break to a worksheet</p></a></li>
<li><a href='#pageSetup'><p>Set page margins, orientation and print scaling</p></a></li>
<li><a href='#protectWorkbook'><p>Protect a workbook from modifications</p></a></li>
<li><a href='#protectWorksheet'><p>Protect a worksheet from modifications</p></a></li>
<li><a href='#read.xlsx'><p>Read from an Excel file or Workbook object</p></a></li>
<li><a href='#readWorkbook'><p>Read from an Excel file or Workbook object</p></a></li>
<li><a href='#removeCellMerge'><p>Create a new Workbook object</p></a></li>
<li><a href='#removeColWidths'><p>Remove column widths from a worksheet</p></a></li>
<li><a href='#removeComment'><p>Remove a comment from a cell</p></a></li>
<li><a href='#removeFilter'><p>Remove a worksheet filter</p></a></li>
<li><a href='#removeRowHeights'><p>Remove custom row heights from a worksheet</p></a></li>
<li><a href='#removeTable'><p>Remove an Excel table in a workbook</p></a></li>
<li><a href='#removeWorksheet'><p>Remove a worksheet from a workbook</p></a></li>
<li><a href='#renameWorksheet'><p>Rename a worksheet</p></a></li>
<li><a href='#replaceStyle'><p>Replace an existing cell style</p></a></li>
<li><a href='#saveWorkbook'><p>save Workbook to file</p></a></li>
<li><a href='#setColWidths'><p>Set worksheet column widths</p></a></li>
<li><a href='#setFooter'><p>Set footer for all worksheets</p></a></li>
<li><a href='#setHeader'><p>Set header for all worksheets</p></a></li>
<li><a href='#setHeaderFooter'><p>Set document headers and footers</p></a></li>
<li><a href='#setLastModifiedBy'><p>Set the author who modified the file last.</p></a></li>
<li><a href='#setRowHeights'><p>Set worksheet row heights</p></a></li>
<li><a href='#setWindowSize'><p>Set and Get Window Size for xlsx file</p></a></li>
<li><a href='#sheets'><p>Returns names of worksheets.</p></a></li>
<li><a href='#sheetVisibility'><p>Get/set worksheet visible state</p></a></li>
<li><a href='#sheetVisible'><p>Get worksheet visible state.</p></a></li>
<li><a href='#showGridLines'><p>Set worksheet gridlines to show or hide.</p></a></li>
<li><a href='#temp_xlsx'><p>helper function to create tempory directory for testing purpose</p></a></li>
<li><a href='#ungroupColumns'><p>Ungroup Columns</p></a></li>
<li><a href='#ungroupRows'><p>Ungroup Rows</p></a></li>
<li><a href='#worksheetOrder'><p>Order of worksheets in xlsx file</p></a></li>
<li><a href='#write.xlsx'><p>write data to an xlsx file</p></a></li>
<li><a href='#writeComment'><p>write a cell comment</p></a></li>
<li><a href='#writeData'><p>Write an object to a worksheet</p></a></li>
<li><a href='#writeDataTable'><p>Write to a worksheet as an Excel table</p></a></li>
<li><a href='#writeFormula'><p>Write a character vector as an Excel Formula</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Read, Write and Edit xlsx Files</td>
</tr>
<tr>
<td>Version:</td>
<td>4.2.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-25</td>
</tr>
<tr>
<td>Description:</td>
<td>Simplifies the creation of Excel .xlsx files by providing a
    high level interface to writing, styling and editing worksheets.
    Through the use of 'Rcpp', read/write times are comparable to the
    'xlsx' and 'XLConnect' packages with the added benefit of removing the
    dependency on Java.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ycphs.github.io/openxlsx/index.html">https://ycphs.github.io/openxlsx/index.html</a>,
<a href="https://github.com/ycphs/openxlsx">https://github.com/ycphs/openxlsx</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ycphs/openxlsx/issues">https://github.com/ycphs/openxlsx/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, methods, Rcpp, stats, stringi, utils, zip</td>
</tr>
<tr>
<td>Suggests:</td>
<td>curl, formula.tools, knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Collate:</td>
<td>'CommentClass.R' 'HyperlinkClass.R' 'RcppExports.R'
'class_definitions.R' 'StyleClass.R' 'WorkbookClass.R'
'asserts.R' 'baseXML.R' 'borderFunctions.R' 'build_workbook.R'
'chartsheet_class.R' 'conditional_formatting.R'
'data-fontSizeLookupTables.R' 'helperFunctions.R'
'loadWorkbook.R' 'onUnload.R' 'openXL.R' 'openxlsx-package.R'
'openxlsx.R' 'openxlsxCoerce.R' 'readWorkbook.R'
'setWindowSize.R' 'sheet_data_class.R' 'utils.R'
'workbook_column_widths.R' 'workbook_read_workbook.R'
'workbook_write_data.R' 'worksheet_class.R' 'wrappers.R'
'writeData.R' 'writeDataTable.R' 'writexlsx.R' 'zzz.R'</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-25 19:28:01 UTC; janmarvingarbuszus</td>
</tr>
<tr>
<td>Author:</td>
<td>Philipp Schauberger [aut],
  Alexander Walker [aut],
  Luca Braglia [ctb],
  Joshua Sturm [ctb],
  Jan Marvin Garbuszus [ctb, cre],
  Jordan Mark Barbone
    <a href="https://orcid.org/0000-0001-9788-3628"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  David Zimmermann [ctb],
  Reinhold Kainhofer [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Marvin Garbuszus &lt;jan.garbuszus@ruhr-uni-bochum.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-25 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='openxlsx'>xlsx reading, writing and editing.</h2><span id='topic+openxlsx-package'></span><span id='topic+openxlsx'></span>

<h3>Description</h3>

<p>openxlsx simplifies the the process of writing and styling Excel xlsx files from R
and removes the dependency on Java.
</p>


<h3>Details</h3>

<p>The openxlsx package uses global options, most to simplify formatting.  These
are stored in the <code>op.openxlsx</code> object.
</p>

<dl>
<dt>openxlsx.bandedCols</dt><dd><p>FALSE</p>
</dd>
<dt>openxlsx.bandedRows</dt><dd><p>TRUE</p>
</dd>
<dt>openxlsx.borderColour</dt><dd><p>&quot;black&quot;</p>
</dd>
<dt>openxlsx.borders</dt><dd><p>&quot;none&quot;</p>
</dd>
<dt>openxlsx.borderStyle</dt><dd><p>&quot;thin&quot;</p>
</dd>
<dt>openxlsx.compressionLevel</dt><dd><p>&quot;9&quot;</p>
</dd>
<dt>openxlsx.creator</dt><dd><p>&quot;&quot;</p>
</dd>
<dt>openxlsx.dateFormat</dt><dd><p>&quot;mm/dd/yyyy&quot;</p>
</dd>
<dt>openxlsx.datetimeFormat</dt><dd><p>&quot;yyyy-mm-dd hh:mm:ss&quot;</p>
</dd>
<dt>openxlsx.headerStyle</dt><dd><p>NULL</p>
</dd>
<dt>openxlsx.keepNA</dt><dd><p>FALSE</p>
</dd>
<dt>openxlsx.na.string</dt><dd><p>NULL</p>
</dd>
<dt>openxlsx.numFmt</dt><dd><p>NULL</p>
</dd>
<dt>openxlsx.orientation</dt><dd><p>&quot;portrait&quot;</p>
</dd>
<dt>openxlsx.paperSize</dt><dd><p>9</p>
</dd>
<dt>openxlsx.tabColour</dt><dd><p>&quot;TableStyleLight9&quot;</p>
</dd>
<dt>openxlsx.tableStyle</dt><dd><p>&quot;TableStyleLight9&quot;</p>
</dd>
<dt>openxlsx.withFilter</dt><dd><p>NA Whether to write data with or without a
filter. If NA will make filters with <code>writeDataTable</code> and will not for
<code>writeData</code></p>
</dd>
</dl>

<p>See the Formatting vignette for examples.
</p>
<p>Additional options
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jan Marvin Garbuszus <a href="mailto:jan.garbuszus@ruhr-uni-bochum.de">jan.garbuszus@ruhr-uni-bochum.de</a> [contributor]
</p>
<p>Authors:
</p>

<ul>
<li><p> Philipp Schauberger <a href="mailto:philipp@schauberger.co.at">philipp@schauberger.co.at</a>
</p>
</li>
<li><p> Alexander Walker <a href="mailto:Alexander.Walker1989@gmail.com">Alexander.Walker1989@gmail.com</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Luca Braglia [contributor]
</p>
</li>
<li><p> Joshua Sturm [contributor]
</p>
</li>
<li><p> Jordan Mark Barbone <a href="mailto:jmbarbone@gmail.com">jmbarbone@gmail.com</a> (<a href="https://orcid.org/0000-0001-9788-3628">ORCID</a>) [contributor]
</p>
</li>
<li><p> David Zimmermann <a href="mailto:david_j_zimmermann@hotmail.com">david_j_zimmermann@hotmail.com</a> [contributor]
</p>
</li>
<li><p> Reinhold Kainhofer <a href="mailto:reinhold@kainhofer.com">reinhold@kainhofer.com</a> [contributor]
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li><p><code>vignette("Introduction", package = "openxlsx")</code>
</p>
</li>
<li><p><code>vignette("formatting", package = "openxlsx")</code>
</p>
</li>
<li><p><code><a href="#topic+writeData">writeData()</a></code>
</p>
</li>
<li><p><code><a href="#topic+writeDataTable">writeDataTable()</a></code>
</p>
</li>
<li><p><code><a href="#topic+write.xlsx">write.xlsx()</a></code>
</p>
</li>
<li><p><code><a href="#topic+read.xlsx">read.xlsx()</a></code>
</p>
</li>
<li><p><code><a href="#topic+op.openxlsx">op.openxlsx()</a></code>
</p>
</li></ul>

<p>for examples
</p>

<hr>
<h2 id='activeSheet'>Get/set active sheet of the workbook</h2><span id='topic+activeSheet'></span><span id='topic+activeSheet+3C-'></span>

<h3>Description</h3>

<p>Get and set active sheet of the workbook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>activeSheet(wb)

activeSheet(wb) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="activeSheet_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="activeSheet_+3A_value">value</code></td>
<td>
<p>index of the active sheet or name of the active sheet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return the active sheet of the workbook
</p>


<h3>Author(s)</h3>

<p>Philipp Schauberger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
addWorksheet(wb, sheetName = "S1")
addWorksheet(wb, sheetName = "S2")
addWorksheet(wb, sheetName = "S3")

activeSheet(wb) # default value is the first sheet active
activeSheet(wb) &lt;- 1 ## active sheet S1
activeSheet(wb)
activeSheet(wb) &lt;- "S2" ## active sheet S2
activeSheet(wb)
</code></pre>

<hr>
<h2 id='addCreator'>Add another author to the meta data of the file.</h2><span id='topic+addCreator'></span>

<h3>Description</h3>

<p>Just a wrapper of wb$addCreator()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addCreator(wb, Creator)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addCreator_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="addCreator_+3A_creator">Creator</code></td>
<td>
<p>A string object with the name of the creator</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Philipp Schauberger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
addCreator(wb, "test")
</code></pre>

<hr>
<h2 id='addFilter'>Add column filters</h2><span id='topic+addFilter'></span>

<h3>Description</h3>

<p>Add excel column filters to a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addFilter(wb, sheet, rows, cols)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addFilter_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="addFilter_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="addFilter_+3A_rows">rows</code></td>
<td>
<p>A row number.</p>
</td></tr>
<tr><td><code id="addFilter_+3A_cols">cols</code></td>
<td>
<p>columns to add filter to.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>adds filters to worksheet columns, same as filter parameters in writeData.
writeDataTable automatically adds filters to first row of a table.
NOTE Can only have a single filter per worksheet unless using tables.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+writeData">writeData()</a></code>
</p>
<p><code><a href="#topic+addFilter">addFilter()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")
addWorksheet(wb, "Sheet 2")
addWorksheet(wb, "Sheet 3")

writeData(wb, 1, iris)
addFilter(wb, 1, row = 1, cols = 1:ncol(iris))

## Equivalently
writeData(wb, 2, x = iris, withFilter = TRUE)

## Similarly
writeDataTable(wb, 3, iris)
## Not run: 
saveWorkbook(wb, file = "addFilterExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='addStyle'>Add a style to a set of cells</h2><span id='topic+addStyle'></span>

<h3>Description</h3>

<p>Function adds a style to a specified set of cells.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addStyle(wb, sheet, style, rows, cols, gridExpand = FALSE, stack = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addStyle_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet.</p>
</td></tr>
<tr><td><code id="addStyle_+3A_sheet">sheet</code></td>
<td>
<p>A worksheet to apply the style to.</p>
</td></tr>
<tr><td><code id="addStyle_+3A_style">style</code></td>
<td>
<p>A style object returned from createStyle()</p>
</td></tr>
<tr><td><code id="addStyle_+3A_rows">rows</code></td>
<td>
<p>Rows to apply style to.</p>
</td></tr>
<tr><td><code id="addStyle_+3A_cols">cols</code></td>
<td>
<p>columns to apply style to.</p>
</td></tr>
<tr><td><code id="addStyle_+3A_gridexpand">gridExpand</code></td>
<td>
<p>If <code>TRUE</code>, style will be applied to all combinations of rows and cols.</p>
</td></tr>
<tr><td><code id="addStyle_+3A_stack">stack</code></td>
<td>
<p>If <code>TRUE</code> the new style is merged with any existing cell styles.  If FALSE, any
existing style is replaced by the new style.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createStyle">createStyle()</a></code>
</p>
<p>expand.grid
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See package vignette for more examples.

## Create a new workbook
wb &lt;- createWorkbook("My name here")

## Add a worksheets
addWorksheet(wb, "Expenditure", gridLines = FALSE)

## write data to worksheet 1
writeData(wb, sheet = 1, USPersonalExpenditure, rowNames = TRUE)

## create and add a style to the column headers
headerStyle &lt;- createStyle(
  fontSize = 14, fontColour = "#FFFFFF", halign = "center",
  fgFill = "#4F81BD", border = "TopBottom", borderColour = "#4F81BD"
)

## style for body
bodyStyle &lt;- createStyle(border = "TopBottom", borderColour = "#4F81BD")
addStyle(wb, sheet = 1, bodyStyle, rows = 2:6, cols = 1:6, gridExpand = TRUE)
setColWidths(wb, 1, cols = 1, widths = 21) ## set column width for row names column
## Not run: 
saveWorkbook(wb, "addStyleExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='addWorksheet'>Add a worksheet to a workbook</h2><span id='topic+addWorksheet'></span>

<h3>Description</h3>

<p>Add a worksheet to a Workbook object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addWorksheet(
  wb,
  sheetName,
  gridLines = openxlsx_getOp("gridLines", TRUE),
  tabColour = NULL,
  zoom = 100,
  header = openxlsx_getOp("header"),
  footer = openxlsx_getOp("footer"),
  evenHeader = openxlsx_getOp("evenHeader"),
  evenFooter = openxlsx_getOp("evenFooter"),
  firstHeader = openxlsx_getOp("firstHeader"),
  firstFooter = openxlsx_getOp("firstFooter"),
  visible = TRUE,
  paperSize = openxlsx_getOp("paperSize", 9),
  orientation = openxlsx_getOp("orientation", "portrait"),
  vdpi = openxlsx_getOp("vdpi", 300),
  hdpi = openxlsx_getOp("hdpi", 300)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addWorksheet_+3A_wb">wb</code></td>
<td>
<p>A Workbook object to attach the new worksheet</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_sheetname">sheetName</code></td>
<td>
<p>A name for the new worksheet</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_gridlines">gridLines</code></td>
<td>
<p>A logical. If <code>FALSE</code>, the worksheet grid lines will be hidden.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_tabcolour">tabColour</code></td>
<td>
<p>Colour of the worksheet tab. A valid colour (belonging to colours()) or a valid hex colour beginning with &quot;#&quot;</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_zoom">zoom</code></td>
<td>
<p>A numeric between 10 and 400. Worksheet zoom level as a percentage.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_header">header</code></td>
<td>
<p>document header. Character vector of length 3 corresponding to positions left, center, right. Use NA to skip a position.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_footer">footer</code></td>
<td>
<p>document footer. Character vector of length 3 corresponding to positions left, center, right. Use NA to skip a position.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_evenheader">evenHeader</code></td>
<td>
<p>document header for even pages.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_evenfooter">evenFooter</code></td>
<td>
<p>document footer for even pages.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_firstheader">firstHeader</code></td>
<td>
<p>document header for first page only.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_firstfooter">firstFooter</code></td>
<td>
<p>document footer for first page only.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_visible">visible</code></td>
<td>
<p>If FALSE, sheet is hidden else visible.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_papersize">paperSize</code></td>
<td>
<p>An integer corresponding to a paper size. See ?pageSetup for details.</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_orientation">orientation</code></td>
<td>
<p>One of &quot;portrait&quot; or &quot;landscape&quot;</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_vdpi">vdpi</code></td>
<td>
<p>Vertical DPI. Can be set with options(&quot;openxlsx.dpi&quot; = X) or options(&quot;openxlsx.vdpi&quot; = X)</p>
</td></tr>
<tr><td><code id="addWorksheet_+3A_hdpi">hdpi</code></td>
<td>
<p>Horizontal DPI. Can be set with options(&quot;openxlsx.dpi&quot; = X) or options(&quot;openxlsx.hdpi&quot; = X)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Headers and footers can contain special tags
</p>

<dl>
<dt><strong>&amp;[Page]</strong></dt><dd><p> Page number</p>
</dd>
<dt><strong>&amp;[Pages]</strong></dt><dd><p> Number of pages</p>
</dd>
<dt><strong>&amp;[Date]</strong></dt><dd><p> Current date</p>
</dd>
<dt><strong>&amp;[Time]</strong></dt><dd><p> Current time</p>
</dd>
<dt><strong>&amp;[Path]</strong></dt><dd><p> File path</p>
</dd>
<dt><strong>&amp;[File]</strong></dt><dd><p> File name</p>
</dd>
<dt><strong>&amp;[Tab]</strong></dt><dd><p> Worksheet name</p>
</dd>
</dl>



<h3>Value</h3>

<p>XML tree
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- createWorkbook("Fred")

## Add 3 worksheets
addWorksheet(wb, "Sheet 1")
addWorksheet(wb, "Sheet 2", gridLines = FALSE)
addWorksheet(wb, "Sheet 3", tabColour = "red")
addWorksheet(wb, "Sheet 4", gridLines = FALSE, tabColour = "#4F81BD")

## Headers and Footers
addWorksheet(wb, "Sheet 5",
  header = c("ODD HEAD LEFT", "ODD HEAD CENTER", "ODD HEAD RIGHT"),
  footer = c("ODD FOOT RIGHT", "ODD FOOT CENTER", "ODD FOOT RIGHT"),
  evenHeader = c("EVEN HEAD LEFT", "EVEN HEAD CENTER", "EVEN HEAD RIGHT"),
  evenFooter = c("EVEN FOOT RIGHT", "EVEN FOOT CENTER", "EVEN FOOT RIGHT"),
  firstHeader = c("TOP", "OF FIRST", "PAGE"),
  firstFooter = c("BOTTOM", "OF FIRST", "PAGE")
)

addWorksheet(wb, "Sheet 6",
  header = c("&amp;[Date]", "ALL HEAD CENTER 2", "&amp;[Page] / &amp;[Pages]"),
  footer = c("&amp;[Path]&amp;[File]", NA, "&amp;[Tab]"),
  firstHeader = c(NA, "Center Header of First Page", NA),
  firstFooter = c(NA, "Center Footer of First Page", NA)
)

addWorksheet(wb, "Sheet 7",
  header = c("ALL HEAD LEFT 2", "ALL HEAD CENTER 2", "ALL HEAD RIGHT 2"),
  footer = c("ALL FOOT RIGHT 2", "ALL FOOT CENTER 2", "ALL FOOT RIGHT 2")
)

addWorksheet(wb, "Sheet 8",
  firstHeader = c("FIRST ONLY L", NA, "FIRST ONLY R"),
  firstFooter = c("FIRST ONLY L", NA, "FIRST ONLY R")
)

## Need data on worksheet to see all headers and footers
writeData(wb, sheet = 5, 1:400)
writeData(wb, sheet = 6, 1:400)
writeData(wb, sheet = 7, 1:400)
writeData(wb, sheet = 8, 1:400)

## Save workbook
## Not run: 
saveWorkbook(wb, "addWorksheetExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='all.equal'>Check equality of workbooks</h2><span id='topic+all.equal'></span><span id='topic+all.equal.Workbook'></span>

<h3>Description</h3>

<p>Check equality of workbooks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Workbook'
all.equal(target, current, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="all.equal_+3A_target">target</code></td>
<td>
<p>A <code>Workbook</code> object</p>
</td></tr>
<tr><td><code id="all.equal_+3A_current">current</code></td>
<td>
<p>A <code>Workbook</code> object</p>
</td></tr>
<tr><td><code id="all.equal_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='as_POSIXct_utc'>Convert to POSIXct with timezone UTC</h2><span id='topic+as_POSIXct_utc'></span>

<h3>Description</h3>

<p>Convert to POSIXct with timezone UTC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_POSIXct_utc(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_POSIXct_utc_+3A_x">x</code></td>
<td>
<p>something as.POSIXct can convert</p>
</td></tr>
</table>

<hr>
<h2 id='as.character.formula'><code>as.character.formula()</code></h2><span id='topic+as.character.formula'></span>

<h3>Description</h3>

<p>This function exists to prevent conflicts with <code>as.character.formula</code> methods
from other packages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
as.character(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.character.formula_+3A_x">x</code></td>
<td>
<p>object to be coerced or tested.</p>
</td></tr>
<tr><td><code id="as.character.formula_+3A_...">...</code></td>
<td>
<p>Not implemented</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>base::as.character.default(x)</code>
</p>

<hr>
<h2 id='auto_heights'>Compute optimal row heights</h2><span id='topic+auto_heights'></span>

<h3>Description</h3>

<p>Compute optimal row heights for cell with fixed with and
enabled automatic row heights parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto_heights(
  wb,
  sheet,
  selected,
  fontsize = NULL,
  factor = 1,
  base_height = 15,
  extra_height = 12
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auto_heights_+3A_wb">wb</code></td>
<td>
<p>workbook</p>
</td></tr>
<tr><td><code id="auto_heights_+3A_sheet">sheet</code></td>
<td>
<p>worksheet</p>
</td></tr>
<tr><td><code id="auto_heights_+3A_selected">selected</code></td>
<td>
<p>selected rows</p>
</td></tr>
<tr><td><code id="auto_heights_+3A_fontsize">fontsize</code></td>
<td>
<p>font size, optional (get base font size by default)</p>
</td></tr>
<tr><td><code id="auto_heights_+3A_factor">factor</code></td>
<td>
<p>factor to manually adjust font width, e.g., for bold fonts,
optional</p>
</td></tr>
<tr><td><code id="auto_heights_+3A_base_height">base_height</code></td>
<td>
<p>basic row height, optional</p>
</td></tr>
<tr><td><code id="auto_heights_+3A_extra_height">extra_height</code></td>
<td>
<p>additional row height per new line of text, optional</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of indices of columns with fixed widths and optimal row heights
</p>


<h3>Author(s)</h3>

<p>David Breuer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create new workbook
wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet")
sheet &lt;- 1

## Write dummy data
long_string &lt;- "ABC ABC ABC ABC ABC ABC ABC ABC ABC ABC ABC"
writeData(wb, sheet, c("A", long_string, "CCC"), startCol = 2, startRow = 3)
writeData(wb, sheet, c(4, 5), startCol = 4, startRow = 3)

## Set column widths and get optimal row heights
setColWidths(wb, sheet, c(1,2,3,4), c(10,20,10,20))
auto_heights(wb, sheet, 1:5)

</code></pre>

<hr>
<h2 id='buildWorkbook'>Build Workbook</h2><span id='topic+buildWorkbook'></span>

<h3>Description</h3>

<p>Build a workbook from a data.frame or named list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildWorkbook(x, asTable = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buildWorkbook_+3A_x">x</code></td>
<td>
<p>A data.frame or a (named) list of objects that can be handled by
<code><a href="#topic+writeData">writeData()</a></code> or <code><a href="#topic+writeDataTable">writeDataTable()</a></code> to write to file</p>
</td></tr>
<tr><td><code id="buildWorkbook_+3A_astable">asTable</code></td>
<td>
<p>If <code>TRUE</code> will use <code><a href="#topic+writeDataTable">writeDataTable()</a></code> rather
than <code><a href="#topic+writeData">writeData()</a></code> to write <code>x</code> to the file (default:
<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="buildWorkbook_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+writeData">writeData()</a></code>,
<code><a href="#topic+writeDataTable">writeDataTable()</a></code>, <code><a href="#topic+setColWidths">setColWidths()</a></code> (see Optional
Parameters)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used as shortcut to create a workbook object from a
data.frame or named list.  If names are available in the list they will be
used as the worksheet names.  The parameters in <code>...</code> are collected
and passed to <code><a href="#topic+writeData">writeData()</a></code> or <code><a href="#topic+writeDataTable">writeDataTable()</a></code> to
initially create the Workbook objects then appropriate parameters are
passed to <code><a href="#topic+setColWidths">setColWidths()</a></code>.
</p>
<p>columns of x with class Date or POSIXt are automatically
styled as dates and datetimes respectively.
</p>


<h3>Value</h3>

<p>A Workbook object
</p>


<h3>Optional Parameters</h3>

<p><strong>createWorkbook Parameters</strong>
</p>

<dl>
<dt><strong>creator</strong></dt><dd><p> A string specifying the workbook author</p>
</dd>
</dl>

<p><strong>addWorksheet Parameters</strong>
</p>

<dl>
<dt><strong>sheetName</strong></dt><dd><p> Name of the worksheet</p>
</dd>
<dt><strong>gridLines</strong></dt><dd><p> A logical. If <code>FALSE</code>, the worksheet grid lines will be hidden.</p>
</dd>
<dt><strong>tabColour</strong></dt><dd><p> Colour of the worksheet tab. A valid colour (belonging to colours())
or a valid hex colour beginning with &quot;#&quot;.</p>
</dd>
<dt><strong>zoom</strong></dt><dd><p> A numeric between 10 and 400. Worksheet zoom level as a percentage.</p>
</dd>
</dl>

<p><strong>writeData/writeDataTable Parameters</strong>
</p>

<dl>
<dt><strong>startCol</strong></dt><dd><p> A vector specifying the starting column(s) to write df</p>
</dd>
<dt><strong>startRow</strong></dt><dd><p> A vector specifying the starting row(s) to write df</p>
</dd>
<dt><strong>xy</strong></dt><dd><p> An alternative to specifying startCol and startRow individually.
A vector of the form c(startCol, startRow)</p>
</dd>
<dt><strong>colNames or col.names</strong></dt><dd><p> If <code>TRUE</code>, column names of x are written.</p>
</dd>
<dt><strong>rowNames or row.names</strong></dt><dd><p> If <code>TRUE</code>, row names of x are written.</p>
</dd>
<dt><strong>headerStyle</strong></dt><dd><p> Custom style to apply to column names.</p>
</dd>
<dt><strong>borders</strong></dt><dd><p> Either &quot;surrounding&quot;, &quot;columns&quot; or &quot;rows&quot; or NULL.  If &quot;surrounding&quot;, a border is drawn around the
data.  If &quot;rows&quot;, a surrounding border is drawn a border around each row. If &quot;columns&quot;, a surrounding border is drawn with a border
between each column.  If &quot;<code>all</code>&quot; all cell borders are drawn.</p>
</dd>
<dt><strong>borderColour</strong></dt><dd><p> Colour of cell border</p>
</dd>
<dt><strong>borderStyle</strong></dt><dd><p> Border line style.</p>
</dd>
<dt><strong>keepNA</strong></dt><dd><p>If <code>TRUE</code>, NA values are converted to #N/A (or <code>na.string</code>, if not NULL) in Excel, else NA cells will be empty. Defaults to FALSE.</p>
</dd>
<dt><strong>na.string</strong></dt><dd><p>If not NULL, and if <code>keepNA</code> is <code>TRUE</code>, NA values are converted to this string in Excel. Defaults to NULL.</p>
</dd>
</dl>

<p><strong>freezePane Parameters</strong>
</p>

<dl>
<dt><strong>firstActiveRow</strong></dt><dd><p>Top row of active region to freeze pane.</p>
</dd>
<dt><strong>firstActiveCol</strong></dt><dd><p>Furthest left column of active region to freeze pane.</p>
</dd>
<dt><strong>firstRow</strong></dt><dd><p>If <code>TRUE</code>, freezes the first row (equivalent to firstActiveRow = 2)</p>
</dd>
<dt><strong>firstCol</strong></dt><dd><p>If <code>TRUE</code>, freezes the first column (equivalent to firstActiveCol = 2)</p>
</dd>
</dl>

<p><strong>colWidths Parameters</strong>
</p>

<dl>
<dt><strong>colWidths</strong></dt><dd><p>May be a single value for all columns (or &quot;auto&quot;), or a list of vectors that will be recycled for each sheet (see examples)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Jordan Mark Barbone
</p>


<h3>See Also</h3>

<p><code><a href="#topic+write.xlsx">write.xlsx()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(a = 1, b = 2)
wb &lt;- buildWorkbook(x)

y &lt;- list(a = x, b = x, c = x)
buildWorkbook(y, asTable = TRUE)
buildWorkbook(y, asTable = TRUE, tableStyle = "TableStyleLight8")

</code></pre>

<hr>
<h2 id='cloneWorksheet'>Clone a worksheet to a workbook</h2><span id='topic+cloneWorksheet'></span>

<h3>Description</h3>

<p>Clone a worksheet to a Workbook object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cloneWorksheet(wb, sheetName, clonedSheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cloneWorksheet_+3A_wb">wb</code></td>
<td>
<p>A Workbook object to attach the new worksheet</p>
</td></tr>
<tr><td><code id="cloneWorksheet_+3A_sheetname">sheetName</code></td>
<td>
<p>A name for the new worksheet</p>
</td></tr>
<tr><td><code id="cloneWorksheet_+3A_clonedsheet">clonedSheet</code></td>
<td>
<p>The name of the existing worksheet to be cloned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>XML tree
</p>


<h3>Author(s)</h3>

<p>Reinhold Kainhofer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- createWorkbook("Fred")

## Add 3 worksheets
addWorksheet(wb, "Sheet 1")
cloneWorksheet(wb, "Sheet 2", clonedSheet = "Sheet 1")

## Save workbook
## Not run: 
saveWorkbook(wb, "cloneWorksheetExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='col2int'>Convert Excel column to integer</h2><span id='topic+col2int'></span>

<h3>Description</h3>

<p>Converts an Excel column label to an integer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col2int(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="col2int_+3A_x">x</code></td>
<td>
<p>A character vector</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>col2int(LETTERS)
</code></pre>

<hr>
<h2 id='conditionalFormat'>Add conditional formatting to cells</h2><span id='topic+conditionalFormat'></span>

<h3>Description</h3>

<p>DEPRECATED! USE <code><a href="#topic+conditionalFormatting">conditionalFormatting()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conditionalFormat(
  wb,
  sheet,
  cols,
  rows,
  rule = NULL,
  style = NULL,
  type = "expression"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conditionalFormat_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="conditionalFormat_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="conditionalFormat_+3A_cols">cols</code></td>
<td>
<p>Columns to apply conditional formatting to</p>
</td></tr>
<tr><td><code id="conditionalFormat_+3A_rows">rows</code></td>
<td>
<p>Rows to apply conditional formatting to</p>
</td></tr>
<tr><td><code id="conditionalFormat_+3A_rule">rule</code></td>
<td>
<p>The condition under which to apply the formatting or a vector of colours. See examples.</p>
</td></tr>
<tr><td><code id="conditionalFormat_+3A_style">style</code></td>
<td>
<p>A style to apply to those cells that satisfy the rule. A Style object returned from createStyle()</p>
</td></tr>
<tr><td><code id="conditionalFormat_+3A_type">type</code></td>
<td>
<p>Either 'expression', 'colorscale' or 'databar'. If 'expression' the formatting is determined
by a formula.  If colorScale cells are coloured based on cell value. See examples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DEPRECATED! USE <code><a href="#topic+conditionalFormatting">conditionalFormatting()</a></code>
</p>
<p>Valid operators are &quot;&lt;&quot;, &quot;&lt;=&quot;, &quot;&gt;&quot;, &quot;&gt;=&quot;, &quot;==&quot;, &quot;!=&quot;. See Examples.
Default style given by: createStyle(fontColour = &quot;#9C0006&quot;, bgFill = &quot;#FFC7CE&quot;)
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createStyle">createStyle()</a></code>
</p>

<hr>
<h2 id='conditionalFormatting'>Add conditional formatting to cells</h2><span id='topic+conditionalFormatting'></span><span id='topic+databar'></span>

<h3>Description</h3>

<p>Add conditional formatting to cells
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conditionalFormatting(
  wb,
  sheet,
  cols,
  rows,
  rule = NULL,
  style = NULL,
  type = "expression",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conditionalFormatting_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="conditionalFormatting_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="conditionalFormatting_+3A_cols">cols</code></td>
<td>
<p>Columns to apply conditional formatting to</p>
</td></tr>
<tr><td><code id="conditionalFormatting_+3A_rows">rows</code></td>
<td>
<p>Rows to apply conditional formatting to</p>
</td></tr>
<tr><td><code id="conditionalFormatting_+3A_rule">rule</code></td>
<td>
<p>The condition under which to apply the formatting. See examples.</p>
</td></tr>
<tr><td><code id="conditionalFormatting_+3A_style">style</code></td>
<td>
<p>A style to apply to those cells that satisfy the rule. Default is createStyle(fontColour = &quot;#9C0006&quot;, bgFill = &quot;#FFC7CE&quot;)</p>
</td></tr>
<tr><td><code id="conditionalFormatting_+3A_type">type</code></td>
<td>
<p>Either 'expression', 'colourScale', 'databar', 'duplicates', 'beginsWith',
'endsWith', 'topN', 'bottomN', 'blanks', 'notBlanks', 'contains' or 'notContains' (case insensitive).</p>
</td></tr>
<tr><td><code id="conditionalFormatting_+3A_...">...</code></td>
<td>
<p>See below</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples.
</p>
<p>If type == &quot;expression&quot;
</p>

<ul>
<li><p>style is a Style object. See <code><a href="#topic+createStyle">createStyle()</a></code>
</p>
</li>
<li><p>rule is an expression. Valid operators are &quot;&lt;&quot;, &quot;&lt;=&quot;, &quot;&gt;&quot;, &quot;&gt;=&quot;, &quot;==&quot;, &quot;!=&quot;.
</p>
</li></ul>

<p>If type == &quot;colourScale&quot;
</p>

<ul>
<li><p>style is a vector of colours with length 2 or 3
</p>
</li>
<li><p>rule can be NULL or a vector of colours of equal length to styles
</p>
</li></ul>

<p>If type == &quot;databar&quot;
</p>

<ul>
<li><p>style is a vector of colours with length 2 or 3
</p>
</li>
<li><p>rule is a numeric vector specifying the range of the databar colours. Must be equal length to style
</p>
</li>
<li><p>...
</p>

<ul>
<li><p><strong>showvalue</strong> If FALSE the cell value is hidden. Default TRUE.
</p>
</li>
<li><p><strong>gradient</strong> If FALSE colour gradient is removed. Default TRUE.
</p>
</li>
<li><p><strong>border</strong> If FALSE the border around the database is hidden. Default TRUE.
</p>
</li></ul>


</li></ul>

<p>If type == &quot;duplicates&quot;
</p>

<ul>
<li><p>style is a Style object. See <code><a href="#topic+createStyle">createStyle()</a></code>
</p>
</li>
<li><p>rule is ignored.
</p>
</li></ul>

<p>If type == &quot;contains&quot;
</p>

<ul>
<li><p>style is a Style object. See <code><a href="#topic+createStyle">createStyle()</a></code>
</p>
</li>
<li><p>rule is the text to look for within cells
</p>
</li></ul>

<p>If type == &quot;between&quot;
</p>

<ul>
<li><p>style is a Style object. See <code><a href="#topic+createStyle">createStyle()</a></code>
</p>
</li>
<li><p>rule is a numeric vector of length 2 specifying lower and upper bound (Inclusive)
</p>
</li></ul>

<p>If type == &quot;blanks&quot;
</p>

<ul>
<li><p>style is a Style object. See <code><a href="#topic+createStyle">createStyle()</a></code>
</p>
</li>
<li><p>rule is ignored.
</p>
</li></ul>

<p>If type == &quot;notBlanks&quot;
</p>

<ul>
<li><p>style is a Style object. See <code><a href="#topic+createStyle">createStyle()</a></code>
</p>
</li>
<li><p>rule is ignored.
</p>
</li></ul>

<p>If type == &quot;topN&quot;
</p>

<ul>
<li><p>style is a Style object. See <code><a href="#topic+createStyle">createStyle()</a></code>
</p>
</li>
<li><p>rule is ignored
</p>
</li>
<li><p>...
</p>

<ul>
<li><p><strong>rank</strong> numeric vector of length 1 indicating number of highest values.
</p>
</li>
<li><p><strong>percent</strong> TRUE if you want top N percentage.
</p>
</li></ul>


</li></ul>

<p>If type == &quot;bottomN&quot;
</p>

<ul>
<li><p>style is a Style object. See <code><a href="#topic+createStyle">createStyle()</a></code>
</p>
</li>
<li><p>rule is ignored
</p>
</li>
<li><p>...
</p>

<ul>
<li><p><strong>rank</strong> numeric vector of length 1 indicating number of lowest values.
</p>
</li>
<li><p><strong>percent</strong> TRUE if you want bottom N percentage.
</p>
</li></ul>


</li></ul>



<h3>Author(s)</h3>

<p>Alexander Walker, Philipp Schauberger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createStyle">createStyle()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "cellIs")
addWorksheet(wb, "Moving Row")
addWorksheet(wb, "Moving Col")
addWorksheet(wb, "Dependent on")
addWorksheet(wb, "Duplicates")
addWorksheet(wb, "containsText")
addWorksheet(wb, "notcontainsText")
addWorksheet(wb, "beginsWith")
addWorksheet(wb, "endsWith")
addWorksheet(wb, "colourScale", zoom = 30)
addWorksheet(wb, "databar")
addWorksheet(wb, "between")
addWorksheet(wb, "topN")
addWorksheet(wb, "bottomN")
addWorksheet(wb, "containsBlanks")
addWorksheet(wb, "notContainsBlanks")
addWorksheet(wb, "logical operators")

negStyle &lt;- createStyle(fontColour = "#9C0006", bgFill = "#FFC7CE")
posStyle &lt;- createStyle(fontColour = "#006100", bgFill = "#C6EFCE")

## rule applies to all each cell in range
writeData(wb, "cellIs", -5:5)
writeData(wb, "cellIs", LETTERS[1:11], startCol = 2)
conditionalFormatting(wb, "cellIs",
  cols = 1,
  rows = 1:11, rule = "!=0", style = negStyle
)
conditionalFormatting(wb, "cellIs",
  cols = 1,
  rows = 1:11, rule = "==0", style = posStyle
)

## highlight row dependent on first cell in row
writeData(wb, "Moving Row", -5:5)
writeData(wb, "Moving Row", LETTERS[1:11], startCol = 2)
conditionalFormatting(wb, "Moving Row",
  cols = 1:2,
  rows = 1:11, rule = "$A1&lt;0", style = negStyle
)
conditionalFormatting(wb, "Moving Row",
  cols = 1:2,
  rows = 1:11, rule = "$A1&gt;0", style = posStyle
)

## highlight column dependent on first cell in column
writeData(wb, "Moving Col", -5:5)
writeData(wb, "Moving Col", LETTERS[1:11], startCol = 2)
conditionalFormatting(wb, "Moving Col",
  cols = 1:2,
  rows = 1:11, rule = "A$1&lt;0", style = negStyle
)
conditionalFormatting(wb, "Moving Col",
  cols = 1:2,
  rows = 1:11, rule = "A$1&gt;0", style = posStyle
)

## highlight entire range cols X rows dependent only on cell A1
writeData(wb, "Dependent on", -5:5)
writeData(wb, "Dependent on", LETTERS[1:11], startCol = 2)
conditionalFormatting(wb, "Dependent on",
  cols = 1:2,
  rows = 1:11, rule = "$A$1&lt;0", style = negStyle
)
conditionalFormatting(wb, "Dependent on",
  cols = 1:2,
  rows = 1:11, rule = "$A$1&gt;0", style = posStyle
)

## highlight cells in column 1 based on value in column 2
writeData(wb, "Dependent on", data.frame(x = 1:10, y = runif(10)), startRow = 15)
conditionalFormatting(wb, "Dependent on",
  cols = 1,
  rows = 16:25, rule = "B16&lt;0.5", style = negStyle
)
conditionalFormatting(wb, "Dependent on",
  cols = 1,
  rows = 16:25, rule = "B16&gt;=0.5", style = posStyle
)


## highlight duplicates using default style
writeData(wb, "Duplicates", sample(LETTERS[1:15], size = 10, replace = TRUE))
conditionalFormatting(wb, "Duplicates", cols = 1, rows = 1:10, type = "duplicates")

## cells containing text
fn &lt;- function(x) paste(sample(LETTERS, 10), collapse = "-")
writeData(wb, "containsText", sapply(1:10, fn))
conditionalFormatting(wb, "containsText", cols = 1, rows = 1:10, type = "contains", rule = "A")

## cells not containing text
fn &lt;- function(x) paste(sample(LETTERS, 10), collapse = "-")
writeData(wb, "containsText", sapply(1:10, fn))
conditionalFormatting(wb, "notcontainsText", cols = 1, 
                     rows = 1:10, type = "notcontains", rule = "A")


## cells begins with text
fn &lt;- function(x) paste(sample(LETTERS, 10), collapse = "-")
writeData(wb, "beginsWith", sapply(1:100, fn))
conditionalFormatting(wb, "beginsWith", cols = 1, rows = 1:100, type = "beginsWith", rule = "A")


## cells ends with text
fn &lt;- function(x) paste(sample(LETTERS, 10), collapse = "-")
writeData(wb, "endsWith", sapply(1:100, fn))
conditionalFormatting(wb, "endsWith", cols = 1, rows = 1:100, type = "endsWith", rule = "A")

## colourscale colours cells based on cell value
df &lt;- read.xlsx(system.file("extdata", "readTest.xlsx", package = "openxlsx"), sheet = 4)
writeData(wb, "colourScale", df, colNames = FALSE) ## write data.frame

## rule is a vector or colours of length 2 or 3 (any hex colour or any of colours())
## If rule is NULL, min and max of cells is used. Rule must be the same length as style or NULL.
conditionalFormatting(wb, "colourScale",
  cols = 1:ncol(df), rows = 1:nrow(df),
  style = c("black", "white"),
  rule = c(0, 255),
  type = "colourScale"
)

setColWidths(wb, "colourScale", cols = 1:ncol(df), widths = 1.07)
setRowHeights(wb, "colourScale", rows = 1:nrow(df), heights = 7.5)

## Databars
writeData(wb, "databar", -5:5)
conditionalFormatting(wb, "databar", cols = 1, rows = 1:11, type = "databar") ## Default colours

## Between
# Highlight cells in interval [-2, 2]
writeData(wb, "between", -5:5)
conditionalFormatting(wb, "between", cols = 1, rows = 1:11, type = "between", rule = c(-2, 2))

## Top N 
writeData(wb, "topN", data.frame(x = 1:10, y = rnorm(10)))
# Highlight top 5 values in column x
conditionalFormatting(wb, "topN", cols = 1, rows = 2:11, 
 style = posStyle, type = "topN", rank = 5)#'
# Highlight top 20 percentage in column y
conditionalFormatting(wb, "topN", cols = 2, rows = 2:11, 
 style = posStyle, type = "topN", rank = 20, percent = TRUE)

## Bottom N 
writeData(wb, "bottomN", data.frame(x = 1:10, y = rnorm(10)))
# Highlight bottom 5 values in column x
conditionalFormatting(wb, "bottomN", cols = 1, rows = 2:11, 
 style = negStyle, type = "topN", rank = 5)
# Highlight bottom 20 percentage in column y
conditionalFormatting(wb, "bottomN", cols = 2, rows = 2:11, 
 style = negStyle, type = "topN", rank = 20, percent = TRUE)
 
## cells containing blanks
sample_data &lt;- sample(c("X", NA_character_), 10, replace = TRUE)
writeData(wb, "containsBlanks", sample_data)
conditionalFormatting(wb, "containsBlanks", cols = 1, rows = 1:10, 
type = "blanks", style = negStyle)

## cells not containing blanks
sample_data &lt;- sample(c("X", NA_character_), 10, replace = TRUE)
writeData(wb, "notContainsBlanks", sample_data)
conditionalFormatting(wb, "notContainsBlanks", cols = 1, rows = 1:10, 
type = "notBlanks", style = posStyle)

## Logical Operators
# You can use Excels logical Operators
writeData(wb, "logical operators", 1:10)
conditionalFormatting(wb, "logical operators",
  cols = 1, rows = 1:10,
  rule = "OR($A1=1,$A1=3,$A1=5,$A1=7)"
)
## Not run: 
saveWorkbook(wb, "conditionalFormattingExample.xlsx", TRUE)

## End(Not run)


#########################################################################
## Databar Example

wb &lt;- createWorkbook()
addWorksheet(wb, "databar")

## Databars
writeData(wb, "databar", -5:5, startCol = 1)
conditionalFormatting(wb, "databar", cols = 1, rows = 1:11, type = "databar") ## Defaults

writeData(wb, "databar", -5:5, startCol = 3)
conditionalFormatting(wb, "databar", cols = 3, rows = 1:11, type = "databar", border = FALSE)

writeData(wb, "databar", -5:5, startCol = 5)
conditionalFormatting(wb, "databar",
  cols = 5, rows = 1:11,
  type = "databar", style = c("#a6a6a6"), showValue = FALSE
)

writeData(wb, "databar", -5:5, startCol = 7)
conditionalFormatting(wb, "databar",
  cols = 7, rows = 1:11,
  type = "databar", style = c("#a6a6a6"), showValue = FALSE, gradient = FALSE
)

writeData(wb, "databar", -5:5, startCol = 9)
conditionalFormatting(wb, "databar",
  cols = 9, rows = 1:11,
  type = "databar", style = c("#a6a6a6", "#a6a6a6"), showValue = FALSE, gradient = FALSE
)
## Not run: 
saveWorkbook(wb, file = "databarExample.xlsx", overwrite = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='convertFromExcelRef'>Convert excel column name to integer index</h2><span id='topic+convertFromExcelRef'></span>

<h3>Description</h3>

<p>Convert excel column name to integer index e.g. &quot;J&quot; to 10
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertFromExcelRef(col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertFromExcelRef_+3A_col">col</code></td>
<td>
<p>An excel column reference</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>convertFromExcelRef("DOG")
convertFromExcelRef("COW")

## numbers will be removed
convertFromExcelRef("R22")
</code></pre>

<hr>
<h2 id='convertToDate'>Convert from excel date number to R Date type</h2><span id='topic+convertToDate'></span>

<h3>Description</h3>

<p>Convert from excel date number to R Date type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertToDate(x, origin = "1900-01-01", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertToDate_+3A_x">x</code></td>
<td>
<p>A vector of integers</p>
</td></tr>
<tr><td><code id="convertToDate_+3A_origin">origin</code></td>
<td>
<p>date. Default value is for Windows Excel 2010</p>
</td></tr>
<tr><td><code id="convertToDate_+3A_...">...</code></td>
<td>
<p>additional parameters passed to as.Date()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Excel stores dates as number of days from some origin day
</p>


<h3>See Also</h3>

<p><code><a href="#topic+writeData">writeData()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 2014 April 21st to 25th
convertToDate(c(41750, 41751, 41752, 41753, 41754, NA))
convertToDate(c(41750.2, 41751.99, NA, 41753))
</code></pre>

<hr>
<h2 id='convertToDateTime'>Convert from excel time number to R POSIXct type.</h2><span id='topic+convertToDateTime'></span>

<h3>Description</h3>

<p>Convert from excel time number to R POSIXct type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertToDateTime(x, origin = "1900-01-01", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertToDateTime_+3A_x">x</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="convertToDateTime_+3A_origin">origin</code></td>
<td>
<p>date. Default value is for Windows Excel 2010</p>
</td></tr>
<tr><td><code id="convertToDateTime_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to as.POSIXct</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Excel stores dates as number of days from some origin date
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 2014-07-01, 2014-06-30, 2014-06-29
x &lt;- c(41821.8127314815, 41820.8127314815, NA, 41819, NaN)
convertToDateTime(x)
convertToDateTime(x, tz = "Australia/Perth")
convertToDateTime(x, tz = "UTC")
</code></pre>

<hr>
<h2 id='copyWorkbook'>Copy a Workbook object.</h2><span id='topic+copyWorkbook'></span>

<h3>Description</h3>

<p>Just a wrapper of wb$copy()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copyWorkbook(wb)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="copyWorkbook_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Workbook
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
wb2 &lt;- wb ## does not create a copy
wb3 &lt;- copyWorkbook(wb) ## wrapper for wb$copy()

addWorksheet(wb, "Sheet1") ## adds worksheet to both wb and wb2 but not wb3

names(wb)
names(wb2)
names(wb3)
</code></pre>

<hr>
<h2 id='createComment'>create a Comment object</h2><span id='topic+createComment'></span>

<h3>Description</h3>

<p>Create a cell Comment object to pass to writeComment()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createComment(
  comment,
  author = Sys.getenv("USERNAME"),
  style = NULL,
  visible = TRUE,
  width = 2,
  height = 4
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createComment_+3A_comment">comment</code></td>
<td>
<p>Comment text. Character vector.</p>
</td></tr>
<tr><td><code id="createComment_+3A_author">author</code></td>
<td>
<p>Author of comment. Character vector of length 1</p>
</td></tr>
<tr><td><code id="createComment_+3A_style">style</code></td>
<td>
<p>A Style object or list of style objects the same length as comment vector. See <code><a href="#topic+createStyle">createStyle()</a></code>.</p>
</td></tr>
<tr><td><code id="createComment_+3A_visible">visible</code></td>
<td>
<p>TRUE or FALSE. Is comment visible.</p>
</td></tr>
<tr><td><code id="createComment_+3A_width">width</code>, <code id="createComment_+3A_height">height</code></td>
<td>
<p>Width and height of textbook (in number of cells);
doubles are rounded with <code>base::round()</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+writeComment">writeComment()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")

c1 &lt;- createComment(comment = "this is comment")
writeComment(wb, 1, col = "B", row = 10, comment = c1)

s1 &lt;- createStyle(fontSize = 12, fontColour = "red", textDecoration = c("BOLD"))
s2 &lt;- createStyle(fontSize = 9, fontColour = "black")

c2 &lt;- createComment(comment = c("This Part Bold red\n\n", "This part black"), style = c(s1, s2))
c2

writeComment(wb, 1, col = 6, row = 3, comment = c2)
## Not run: 
saveWorkbook(wb, file = "createCommentExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='createNamedRegion'>Create / delete a named region.</h2><span id='topic+createNamedRegion'></span><span id='topic+deleteNamedRegion'></span>

<h3>Description</h3>

<p>Create / delete a named region
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createNamedRegion(wb, sheet, cols, rows, name, overwrite = FALSE)

deleteNamedRegion(wb, name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createNamedRegion_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="createNamedRegion_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="createNamedRegion_+3A_cols">cols</code></td>
<td>
<p>Numeric vector specifying columns to include in region</p>
</td></tr>
<tr><td><code id="createNamedRegion_+3A_rows">rows</code></td>
<td>
<p>Numeric vector specifying rows to include in region</p>
</td></tr>
<tr><td><code id="createNamedRegion_+3A_name">name</code></td>
<td>
<p>Name for region. A character vector of length 1. Note region names must be case-insensitive unique.</p>
</td></tr>
<tr><td><code id="createNamedRegion_+3A_overwrite">overwrite</code></td>
<td>
<p>Boolean. Overwrite if exists ? Default to FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Region is given by: min(cols):max(cols) X min(rows):max(rows)
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getNamedRegions">getNamedRegions()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create named regions
wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")

## specify region
writeData(wb, sheet = 1, x = iris, startCol = 1, startRow = 1)
createNamedRegion(
  wb = wb,
  sheet = 1,
  name = "iris",
  rows = 1:(nrow(iris) + 1),
  cols = 1:ncol(iris)
)


## using writeData 'name' argument
writeData(wb, sheet = 1, x = iris, name = "iris2", startCol = 10)

out_file &lt;- tempfile(fileext = ".xlsx")
## Not run: 
saveWorkbook(wb, out_file, overwrite = TRUE)

## see named regions
getNamedRegions(wb) ## From Workbook object
getNamedRegions(out_file) ## From xlsx file

## delete one
deleteNamedRegion(wb = wb, name = "iris2")
getNamedRegions(wb)

## read named regions
df &lt;- read.xlsx(wb, namedRegion = "iris")
head(df)

df &lt;- read.xlsx(out_file, namedRegion = "iris2")
head(df)

## End(Not run)

</code></pre>

<hr>
<h2 id='createStyle'>Create a cell style</h2><span id='topic+createStyle'></span>

<h3>Description</h3>

<p>Create a new style to apply to worksheet cells
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createStyle(
  fontName = NULL,
  fontSize = NULL,
  fontColour = NULL,
  numFmt = openxlsx_getOp("numFmt", "GENERAL"),
  border = NULL,
  borderColour = openxlsx_getOp("borderColour", "black"),
  borderStyle = openxlsx_getOp("borderStyle", "thin"),
  bgFill = NULL,
  fgFill = NULL,
  halign = NULL,
  valign = NULL,
  textDecoration = NULL,
  wrapText = FALSE,
  textRotation = NULL,
  indent = NULL,
  locked = NULL,
  hidden = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createStyle_+3A_fontname">fontName</code></td>
<td>
<p>A name of a font. Note the font name is not validated. If fontName is NULL,
the workbook base font is used. (Defaults to Calibri)</p>
</td></tr>
<tr><td><code id="createStyle_+3A_fontsize">fontSize</code></td>
<td>
<p>Font size. A numeric greater than 0.
If fontSize is NULL, the workbook base font size is used. (Defaults to 11)</p>
</td></tr>
<tr><td><code id="createStyle_+3A_fontcolour">fontColour</code></td>
<td>
<p>Colour of text in cell.  A valid hex colour beginning with &quot;#&quot;
or one of colours(). If fontColour is NULL, the workbook base font colours is used.
(Defaults to black)</p>
</td></tr>
<tr><td><code id="createStyle_+3A_numfmt">numFmt</code></td>
<td>
<p>Cell formatting
</p>

<ul>
<li><p><strong>GENERAL</strong>
</p>
</li>
<li><p><strong>NUMBER</strong>
</p>
</li>
<li><p><strong>CURRENCY</strong>
</p>
</li>
<li><p><strong>ACCOUNTING</strong>
</p>
</li>
<li><p><strong>DATE</strong>
</p>
</li>
<li><p><strong>LONGDATE</strong>
</p>
</li>
<li><p><strong>TIME</strong>
</p>
</li>
<li><p><strong>PERCENTAGE</strong>
</p>
</li>
<li><p><strong>FRACTION</strong>
</p>
</li>
<li><p><strong>SCIENTIFIC</strong>
</p>
</li>
<li><p><strong>TEXT</strong>
</p>
</li>
<li><p><strong>COMMA</strong>  for comma separated thousands
</p>
</li>
<li><p>For date/datetime styling a combination of d, m, y and punctuation marks
</p>
</li>
<li><p>For numeric rounding use &quot;0.00&quot; with the preferred number of decimal places
</p>
</li></ul>
</td></tr>
<tr><td><code id="createStyle_+3A_border">border</code></td>
<td>
<p>Cell border. A vector of &quot;top&quot;, &quot;bottom&quot;, &quot;left&quot;, &quot;right&quot; or a single string).
</p>

<dl>
<dt><strong>&quot;top&quot;</strong></dt><dd><p> Top border</p>
</dd>
<dt><strong>bottom</strong></dt><dd><p> Bottom border</p>
</dd>
<dt><strong>left</strong></dt><dd><p> Left border</p>
</dd>
<dt><strong>right</strong></dt><dd><p> Right border</p>
</dd>
<dt><strong>TopBottom</strong> or <strong>c(&quot;top&quot;, &quot;bottom&quot;)</strong></dt><dd><p> Top and bottom border</p>
</dd>
<dt><strong>LeftRight</strong> or <strong>c(&quot;left&quot;, &quot;right&quot;)</strong></dt><dd><p> Left and right border</p>
</dd>
<dt><strong>TopLeftRight</strong> or <strong>c(&quot;top&quot;, &quot;left&quot;, &quot;right&quot;)</strong></dt><dd><p> Top, Left and right border</p>
</dd>
<dt><strong>TopBottomLeftRight</strong> or <strong>c(&quot;top&quot;, &quot;bottom&quot;, &quot;left&quot;, &quot;right&quot;)</strong></dt><dd><p> All borders</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="createStyle_+3A_bordercolour">borderColour</code></td>
<td>
<p>Colour of cell border vector the same length as the number of sides specified in &quot;border&quot;
A valid colour (belonging to colours()) or a valid hex colour beginning with &quot;#&quot;</p>
</td></tr>
<tr><td><code id="createStyle_+3A_borderstyle">borderStyle</code></td>
<td>
<p>Border line style vector the same length as the number of sides specified in &quot;border&quot;
</p>

<dl>
<dt><strong>none</strong></dt><dd><p> No Border</p>
</dd>
<dt><strong>thin</strong></dt><dd><p> thin border</p>
</dd>
<dt><strong>medium</strong></dt><dd><p> medium border</p>
</dd>
<dt><strong>dashed</strong></dt><dd><p> dashed border</p>
</dd>
<dt><strong>dotted</strong></dt><dd><p> dotted border</p>
</dd>
<dt><strong>thick</strong></dt><dd><p> thick border</p>
</dd>
<dt><strong>double</strong></dt><dd><p> double line border</p>
</dd>
<dt><strong>hair</strong></dt><dd><p> Hairline border</p>
</dd>
<dt><strong>mediumDashed</strong></dt><dd><p> medium weight dashed border</p>
</dd>
<dt><strong>dashDot</strong></dt><dd><p> dash-dot border</p>
</dd>
<dt><strong>mediumDashDot</strong></dt><dd><p> medium weight dash-dot border</p>
</dd>
<dt><strong>dashDotDot</strong></dt><dd><p> dash-dot-dot border</p>
</dd>
<dt><strong>mediumDashDotDot</strong></dt><dd><p> medium weight dash-dot-dot border</p>
</dd>
<dt><strong>slantDashDot</strong></dt><dd><p> slanted dash-dot border</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="createStyle_+3A_bgfill">bgFill</code></td>
<td>
<p>Cell background fill colour.
A valid colour (belonging to colours()) or a valid hex colour beginning with &quot;#&quot;.
&ndash;  <strong>Use for conditional formatting styles only.</strong></p>
</td></tr>
<tr><td><code id="createStyle_+3A_fgfill">fgFill</code></td>
<td>
<p>Cell foreground fill colour.
A valid colour (belonging to colours()) or a valid hex colour beginning with &quot;#&quot;</p>
</td></tr>
<tr><td><code id="createStyle_+3A_halign">halign</code></td>
<td>
<p>Horizontal alignment of cell contents
</p>

<dl>
<dt><strong>left</strong></dt><dd><p> Left horizontal align cell contents</p>
</dd>
<dt><strong>right</strong></dt><dd><p> Right horizontal align cell contents</p>
</dd>
<dt><strong>center</strong></dt><dd><p> Center horizontal align cell contents</p>
</dd>
<dt><strong>justify</strong></dt><dd><p> Justify horizontal align cell contents</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="createStyle_+3A_valign">valign</code></td>
<td>
<p>A name
Vertical alignment of cell contents
</p>

<dl>
<dt><strong>top</strong></dt><dd><p> Top vertical align cell contents</p>
</dd>
<dt><strong>center</strong></dt><dd><p> Center vertical align cell contents</p>
</dd>
<dt><strong>bottom</strong></dt><dd><p> Bottom vertical align cell contents</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="createStyle_+3A_textdecoration">textDecoration</code></td>
<td>
<p>Text styling.
</p>

<dl>
<dt><strong>bold</strong></dt><dd><p> Bold cell contents</p>
</dd>
<dt><strong>strikeout</strong></dt><dd><p> Strikeout cell contents</p>
</dd>
<dt><strong>italic</strong></dt><dd><p> Italicise cell contents</p>
</dd>
<dt><strong>underline</strong></dt><dd><p> Underline cell contents</p>
</dd>
<dt><strong>underline2</strong></dt><dd><p> Double underline cell contents</p>
</dd>
<dt><strong>accounting</strong></dt><dd><p> Single accounting underline cell contents</p>
</dd>
<dt><strong>accounting2</strong></dt><dd><p> Double accounting underline cell contents</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="createStyle_+3A_wraptext">wrapText</code></td>
<td>
<p>Logical. If <code>TRUE</code> cell contents will wrap to fit in column.</p>
</td></tr>
<tr><td><code id="createStyle_+3A_textrotation">textRotation</code></td>
<td>
<p>Rotation of text in degrees. 255 for vertical text.</p>
</td></tr>
<tr><td><code id="createStyle_+3A_indent">indent</code></td>
<td>
<p>Horizontal indentation of cell contents.</p>
</td></tr>
<tr><td><code id="createStyle_+3A_locked">locked</code></td>
<td>
<p>Whether cell contents are locked (if worksheet protection is turned on)</p>
</td></tr>
<tr><td><code id="createStyle_+3A_hidden">hidden</code></td>
<td>
<p>Whether the formula of the cell contents will be hidden (if worksheet protection is turned on)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A style object
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addStyle">addStyle()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See package vignettes for further examples

## Modify default values of border colour and border line style
options("openxlsx.borderColour" = "#4F80BD")
options("openxlsx.borderStyle" = "thin")

## Size 18 Arial, Bold, left horz. aligned, fill colour #1A33CC, all borders,
style &lt;- createStyle(
  fontSize = 18, fontName = "Arial",
  textDecoration = "bold", halign = "left", fgFill = "#1A33CC", border = "TopBottomLeftRight"
)

## Red, size 24, Bold, italic, underline, center aligned Font, bottom border
style &lt;- createStyle(
  fontSize = 24, fontColour = rgb(1, 0, 0),
  textDecoration = c("bold", "italic", "underline"),
  halign = "center", valign = "center", border = "Bottom"
)

# borderColour is recycled for each border or all colours can be supplied

# colour is recycled 3 times for "Top", "Bottom" &amp; "Right" sides.
createStyle(border = "TopBottomRight", borderColour = "red")

# supply all colours
createStyle(border = "TopBottomLeft", borderColour = c("red", "yellow", "green"))
</code></pre>

<hr>
<h2 id='createWorkbook'>Create a new Workbook object</h2><span id='topic+createWorkbook'></span>

<h3>Description</h3>

<p>Create a new Workbook object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createWorkbook(
  creator = ifelse(.Platform$OS.type == "windows", Sys.getenv("USERNAME"),
    Sys.getenv("USER")),
  title = NULL,
  subject = NULL,
  category = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createWorkbook_+3A_creator">creator</code></td>
<td>
<p>Creator of the workbook (your name). Defaults to login username</p>
</td></tr>
<tr><td><code id="createWorkbook_+3A_title">title</code></td>
<td>
<p>Workbook properties title</p>
</td></tr>
<tr><td><code id="createWorkbook_+3A_subject">subject</code></td>
<td>
<p>Workbook properties subject</p>
</td></tr>
<tr><td><code id="createWorkbook_+3A_category">category</code></td>
<td>
<p>Workbook properties category</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Workbook object
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loadWorkbook">loadWorkbook()</a></code>
</p>
<p><code><a href="#topic+saveWorkbook">saveWorkbook()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- createWorkbook()

## Save workbook to working directory
## Not run: 
saveWorkbook(wb, file = "createWorkbookExample.xlsx", overwrite = TRUE)

## End(Not run)

## Set Workbook properties
wb &lt;- createWorkbook(
  creator = "Me",
  title = "title here",
  subject = "this &amp; that",
  category = "something"
)
</code></pre>

<hr>
<h2 id='dataValidation'>Add data validation to cells</h2><span id='topic+dataValidation'></span>

<h3>Description</h3>

<p>Add Excel data validation to cells
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataValidation(
  wb,
  sheet,
  cols,
  rows,
  type,
  operator,
  value,
  allowBlank = TRUE,
  showInputMsg = TRUE,
  showErrorMsg = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dataValidation_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="dataValidation_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="dataValidation_+3A_cols">cols</code></td>
<td>
<p>Contiguous columns to apply conditional formatting to</p>
</td></tr>
<tr><td><code id="dataValidation_+3A_rows">rows</code></td>
<td>
<p>Contiguous rows to apply conditional formatting to</p>
</td></tr>
<tr><td><code id="dataValidation_+3A_type">type</code></td>
<td>
<p>One of 'whole', 'decimal', 'date', 'time', 'textLength', 'list' (see examples)</p>
</td></tr>
<tr><td><code id="dataValidation_+3A_operator">operator</code></td>
<td>
<p>One of 'between', 'notBetween', 'equal',
'notEqual', 'greaterThan', 'lessThan', 'greaterThanOrEqual', 'lessThanOrEqual'</p>
</td></tr>
<tr><td><code id="dataValidation_+3A_value">value</code></td>
<td>
<p>a vector of length 1 or 2 depending on operator (see examples)</p>
</td></tr>
<tr><td><code id="dataValidation_+3A_allowblank">allowBlank</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="dataValidation_+3A_showinputmsg">showInputMsg</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="dataValidation_+3A_showerrormsg">showErrorMsg</code></td>
<td>
<p>logical</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")
addWorksheet(wb, "Sheet 2")

writeDataTable(wb, 1, x = iris[1:30, ])

dataValidation(wb, 1,
  col = 1:3, rows = 2:31, type = "whole",
  operator = "between", value = c(1, 9)
)

dataValidation(wb, 1,
  col = 5, rows = 2:31, type = "textLength",
  operator = "between", value = c(4, 6)
)


## Date and Time cell validation
df &lt;- data.frame(
  "d" = as.Date("2016-01-01") + -5:5,
  "t" = as.POSIXct("2016-01-01") + -5:5 * 10000
)

writeData(wb, 2, x = df)
dataValidation(wb, 2,
  col = 1, rows = 2:12, type = "date",
  operator = "greaterThanOrEqual", value = as.Date("2016-01-01")
)

dataValidation(wb, 2,
  col = 2, rows = 2:12, type = "time",
  operator = "between", value = df$t[c(4, 8)]
)
## Not run: 
saveWorkbook(wb, "dataValidationExample.xlsx", overwrite = TRUE)

## End(Not run)


######################################################################
## If type == 'list'
# operator argument is ignored.

wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")
addWorksheet(wb, "Sheet 2")

writeDataTable(wb, sheet = 1, x = iris[1:30, ])
writeData(wb, sheet = 2, x = sample(iris$Sepal.Length, 10))

dataValidation(wb, 1, col = 1, rows = 2:31, type = "list", value = "'Sheet 2'!$A$1:$A$10")

# openXL(wb)
</code></pre>

<hr>
<h2 id='deleteData'>Delete cell data</h2><span id='topic+deleteData'></span>

<h3>Description</h3>

<p>Delete contents and styling from a cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deleteData(wb, sheet, cols, rows, gridExpand = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deleteData_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="deleteData_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="deleteData_+3A_cols">cols</code></td>
<td>
<p>columns to delete data from.</p>
</td></tr>
<tr><td><code id="deleteData_+3A_rows">rows</code></td>
<td>
<p>Rows to delete data from.</p>
</td></tr>
<tr><td><code id="deleteData_+3A_gridexpand">gridExpand</code></td>
<td>
<p>If <code>TRUE</code>, all data in rectangle min(rows):max(rows) X min(cols):max(cols)
will be removed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## write some data
wb &lt;- createWorkbook()
addWorksheet(wb, "Worksheet 1")
x &lt;- data.frame(matrix(runif(200), ncol = 10))
writeData(wb, sheet = 1, x = x, startCol = 2, startRow = 3, colNames = FALSE)

## delete some data
deleteData(wb, sheet = 1, cols = 3:5, rows = 5:7, gridExpand = TRUE)
deleteData(wb, sheet = 1, cols = 7:9, rows = 5:7, gridExpand = TRUE)
deleteData(wb, sheet = 1, cols = LETTERS, rows = 18, gridExpand = TRUE)
## Not run: 
saveWorkbook(wb, "deleteDataExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='deleteDataColumn'>Deletes a whole column from a workbook</h2><span id='topic+deleteDataColumn'></span>

<h3>Description</h3>

<p>Deletes the whole column from a workbook, shifting the remaining columns to the left
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deleteDataColumn(wb, sheet, col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deleteDataColumn_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="deleteDataColumn_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="deleteDataColumn_+3A_col">col</code></td>
<td>
<p>A column to delete</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Zimmermann
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## write some data
wb &lt;- createWorkbook()
addWorksheet(wb, "tester")

for (i in seq(5)) {
  mat &lt;- data.frame(x = rep(paste0(int2col(i), i), 10))
  writeData(wb, sheet = 1, startRow = 1, startCol = i, mat)
  writeFormula(wb, sheet = 1, startRow = 12, startCol = i,
               x = sprintf("=COUNTA(%s2:%s11)", int2col(i), int2col(i)))
}
deleteDataColumn(wb, 1, col = 3)
## Not run: 
saveWorkbook(wb, "deleteDataColumnExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='freezePane'>Freeze a worksheet pane</h2><span id='topic+freezePane'></span>

<h3>Description</h3>

<p>Freeze a worksheet pane
</p>


<h3>Usage</h3>

<pre><code class='language-R'>freezePane(
  wb,
  sheet,
  firstActiveRow = NULL,
  firstActiveCol = NULL,
  firstRow = FALSE,
  firstCol = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="freezePane_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="freezePane_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="freezePane_+3A_firstactiverow">firstActiveRow</code></td>
<td>
<p>Top row of active region</p>
</td></tr>
<tr><td><code id="freezePane_+3A_firstactivecol">firstActiveCol</code></td>
<td>
<p>Furthest left column of active region</p>
</td></tr>
<tr><td><code id="freezePane_+3A_firstrow">firstRow</code></td>
<td>
<p>If <code>TRUE</code>, freezes the first row (equivalent to firstActiveRow = 2)</p>
</td></tr>
<tr><td><code id="freezePane_+3A_firstcol">firstCol</code></td>
<td>
<p>If <code>TRUE</code>, freezes the first column (equivalent to firstActiveCol = 2)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- createWorkbook("Kenshin")

## Add some worksheets
addWorksheet(wb, "Sheet 1")
addWorksheet(wb, "Sheet 2")
addWorksheet(wb, "Sheet 3")
addWorksheet(wb, "Sheet 4")

## Freeze Panes
freezePane(wb, "Sheet 1", firstActiveRow = 5, firstActiveCol = 3)
freezePane(wb, "Sheet 2", firstCol = TRUE) ## shortcut to firstActiveCol = 2
freezePane(wb, 3, firstRow = TRUE) ## shortcut to firstActiveRow = 2
freezePane(wb, 4, firstActiveRow = 1, firstActiveCol = "D")

## Save workbook
## Not run: 
saveWorkbook(wb, "freezePaneExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_worksheet_entries'>Get entries from workbook worksheet</h2><span id='topic+get_worksheet_entries'></span>

<h3>Description</h3>

<p>Get all entries from workbook worksheet without xml tags
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_worksheet_entries(wb, sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_worksheet_entries_+3A_wb">wb</code></td>
<td>
<p>workbook</p>
</td></tr>
<tr><td><code id="get_worksheet_entries_+3A_sheet">sheet</code></td>
<td>
<p>worksheet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of strings
</p>


<h3>Author(s)</h3>

<p>David Breuer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create new workbook
wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet")
sheet &lt;- 1

## Write dummy data
writeData(wb, sheet, c("A", "BB", "CCC"), startCol = 2, startRow = 3)
writeData(wb, sheet, c(4, 5), startCol = 4, startRow = 3)

## Get text entries
get_worksheet_entries(wb, sheet)

</code></pre>

<hr>
<h2 id='getBaseFont'>Return the workbook default font</h2><span id='topic+getBaseFont'></span>

<h3>Description</h3>

<p>Return the workbook default font
</p>
<p>Returns the base font used in the workbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBaseFont(wb)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getBaseFont_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create a workbook
wb &lt;- createWorkbook()
getBaseFont(wb)

## modify base font to size 10 Arial Narrow in red
modifyBaseFont(wb, fontSize = 10, fontColour = "#FF0000", fontName = "Arial Narrow")

getBaseFont(wb)
</code></pre>

<hr>
<h2 id='getCellRefs'>Return excel cell coordinates from (x,y) coordinates</h2><span id='topic+getCellRefs'></span>

<h3>Description</h3>

<p>Return excel cell coordinates from (x,y) coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCellRefs(cellCoords)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCellRefs_+3A_cellcoords">cellCoords</code></td>
<td>
<p>A data.frame with two columns coordinate pairs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Excel alphanumeric cell reference
</p>


<h3>Author(s)</h3>

<p>Philipp Schauberger, Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getCellRefs(data.frame(1, 2))
# "B1"
getCellRefs(data.frame(1:3, 2:4))
# "B1" "C2" "D3"
</code></pre>

<hr>
<h2 id='getCreators'>Get the names of the authors from the meta data of the file.</h2><span id='topic+getCreators'></span>

<h3>Description</h3>

<p>Just a wrapper of wb$getCreators()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCreators(wb)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getCreators_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of creators
</p>


<h3>Author(s)</h3>

<p>Philipp Schauberger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
getCreators(wb)
</code></pre>

<hr>
<h2 id='getDateOrigin'>Get the date origin an xlsx file is using</h2><span id='topic+getDateOrigin'></span>

<h3>Description</h3>

<p>Return the date origin used internally by an xlsx or xlsm file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDateOrigin(xlsxFile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDateOrigin_+3A_xlsxfile">xlsxFile</code></td>
<td>
<p>An xlsx or xlsm file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Excel stores dates as the number of days from either 1904-01-01 or 1900-01-01. This function
checks the date origin being used in an Excel file and returns is so it can be used in <code><a href="#topic+convertToDate">convertToDate()</a></code>
</p>


<h3>Value</h3>

<p>One of &quot;1900-01-01&quot; or &quot;1904-01-01&quot;.
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convertToDate">convertToDate()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## create a file with some dates
## Not run: 
write.xlsx(as.Date("2015-01-10") - (0:4), file = "getDateOriginExample.xlsx")
m &lt;- read.xlsx("getDateOriginExample.xlsx")

## convert to dates
do &lt;- getDateOrigin(system.file("extdata", "readTest.xlsx", package = "openxlsx"))
convertToDate(m[[1]], do)

## End(Not run)
</code></pre>

<hr>
<h2 id='getNamedRegions'>Get named regions</h2><span id='topic+getNamedRegions'></span>

<h3>Description</h3>

<p>Return a vector of named regions in a xlsx file or
Workbook object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNamedRegions(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getNamedRegions_+3A_x">x</code></td>
<td>
<p>An xlsx file or Workbook object</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+createNamedRegion">createNamedRegion()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create named regions
wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")

## specify region
writeData(wb, sheet = 1, x = iris, startCol = 1, startRow = 1)
createNamedRegion(
  wb = wb,
  sheet = 1,
  name = "iris",
  rows = 1:(nrow(iris) + 1),
  cols = 1:ncol(iris)
)


## using writeData 'name' argument to create a named region
writeData(wb, sheet = 1, x = iris, name = "iris2", startCol = 10)
## Not run: 
out_file &lt;- tempfile(fileext = ".xlsx")
saveWorkbook(wb, out_file, overwrite = TRUE)

## see named regions
getNamedRegions(wb) ## From Workbook object
getNamedRegions(out_file) ## From xlsx file

## read named regions
df &lt;- read.xlsx(wb, namedRegion = "iris")
head(df)

df &lt;- read.xlsx(out_file, namedRegion = "iris2")
head(df)

## End(Not run)

</code></pre>

<hr>
<h2 id='getSheetNames'>Get names of worksheets</h2><span id='topic+getSheetNames'></span>

<h3>Description</h3>

<p>Returns the worksheet names within an xlsx file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSheetNames(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSheetNames_+3A_file">file</code></td>
<td>
<p>An xlsx or xlsm file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of worksheet names.
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getSheetNames(system.file("extdata", "readTest.xlsx", package = "openxlsx"))
</code></pre>

<hr>
<h2 id='getStyles'>Returns a list of all styles in the workbook</h2><span id='topic+getStyles'></span>

<h3>Description</h3>

<p>Returns list of style objects in the workbook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStyles(wb)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getStyles_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+replaceStyle">replaceStyle()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load a workbook
wb &lt;- loadWorkbook(file = system.file("extdata", "loadExample.xlsx", package = "openxlsx"))
getStyles(wb)[1:3]
</code></pre>

<hr>
<h2 id='getTables'>List Excel tables in a workbook</h2><span id='topic+getTables'></span>

<h3>Description</h3>

<p>List Excel tables in a workbook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTables(wb, sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTables_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="getTables_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector of table names on the specified sheet
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
addWorksheet(wb, sheetName = "Sheet 1")
writeDataTable(wb, sheet = "Sheet 1", x = iris)
writeDataTable(wb, sheet = 1, x = mtcars, tableName = "mtcars", startCol = 10)

getTables(wb, sheet = "Sheet 1")
</code></pre>

<hr>
<h2 id='groupColumns'>Group columns</h2><span id='topic+groupColumns'></span>

<h3>Description</h3>

<p>Group a selection of columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupColumns(wb, sheet, cols, hidden = FALSE, level = -1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="groupColumns_+3A_wb">wb</code></td>
<td>
<p>A workbook object.</p>
</td></tr>
<tr><td><code id="groupColumns_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet.</p>
</td></tr>
<tr><td><code id="groupColumns_+3A_cols">cols</code></td>
<td>
<p>Indices of cols to group. Can be either a vector of indices to
group at the same level or a (named) list of numeric vectors of
indices to create multiple groupings at once. The names of the
entries determine the grouping level. If no names are given,
the <code>level</code> parameter is used as default.</p>
</td></tr>
<tr><td><code id="groupColumns_+3A_hidden">hidden</code></td>
<td>
<p>Logical vector. If TRUE the grouped columns are hidden. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="groupColumns_+3A_level">level</code></td>
<td>
<p>Grouping level (higher value indicates multiple nestings) for the
group. A vector to assign different grouping levels to the indices.
A value of -1 indicates that the grouping level should be derived
from the existing grouping (one level added)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Group columns together, with the option to hide them.
</p>
<p>NOTE: <code><a href="#topic+setColWidths">setColWidths()</a></code> has a conflicting <code>hidden</code> parameter; changing one will update the other.
</p>


<h3>Author(s)</h3>

<p>Joshua Sturm, Reinhold Kainhofer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ungroupColumns">ungroupColumns()</a></code> to ungroup columns. <code><a href="#topic+groupRows">groupRows()</a></code> for grouping rows.
</p>

<hr>
<h2 id='groupRows'>Group Rows</h2><span id='topic+groupRows'></span>

<h3>Description</h3>

<p>Group a selection of rows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupRows(wb, sheet, rows, hidden = FALSE, level = -1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="groupRows_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="groupRows_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="groupRows_+3A_rows">rows</code></td>
<td>
<p>Indices of rows to group. Can be either a vector of indices to group at the same level or a (named) list of numeric vectors of indices to create multiple groupings at once. The names of the entries determine the grouping level. If no names are given, the parameter level is used as default.</p>
</td></tr>
<tr><td><code id="groupRows_+3A_hidden">hidden</code></td>
<td>
<p>Logical vector. If TRUE the grouped columns are hidden. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="groupRows_+3A_level">level</code></td>
<td>
<p>Grouping level (higher value indicates multiple nestings) for the
group. A vector to assign different grouping levels to the indices.
A value of -1 indicates that the grouping level should be derived
from the existing grouping (one level added)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joshua Sturm
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ungroupRows">ungroupRows()</a></code> to ungroup rows. <code><a href="#topic+groupColumns">groupColumns()</a></code> for grouping columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, 'Sheet1')
addWorksheet(wb, 'Sheet2')

writeData(wb, "Sheet1", iris)
writeData(wb, "Sheet2", iris)

## create list of groups
# lines used for grouping (here: species)
grp &lt;- list(
  seq(2, 51),
  seq(52, 101),
  seq(102, 151)
)
# assign group levels
names(grp) &lt;- c("1","0","1")
groupRows(wb, "Sheet1", rows = grp)

# different grouping
names(grp) &lt;- c("1","2","3")
groupRows(wb, "Sheet2", rows = grp)

# alternatively, one can call groupRows multiple times
addWorksheet(wb, 'Sheet3')
writeData(wb, "Sheet3", iris)
groupRows(wb, "Sheet3", 2:51, level = 1)
groupRows(wb, "Sheet3", 102:151, level = 1)

addWorksheet(wb, 'Sheet4')
writeData(wb, "Sheet4", iris)
groupRows(wb, "Sheet4", 2:51, level = 1)
groupRows(wb, "Sheet4", 52:101, level = 2)
groupRows(wb, "Sheet4", 102:151, level = 3)

# Nested grouping can also be achieved without explicitly given the levels
addWorksheet(wb, 'Sheet5')
writeData(wb, "Sheet5", iris)
groupRows(wb, "Sheet5", 2:151)
groupRows(wb, "Sheet5", 52:151)
groupRows(wb, "Sheet5", 102:151)


</code></pre>

<hr>
<h2 id='if_null_then'>If NULL then ...</h2><span id='topic+if_null_then'></span><span id='topic++25+7C+7C+25'></span>

<h3>Description</h3>

<p>Replace NULL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %||% y
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="if_null_then_+3A_x">x</code></td>
<td>
<p>A value to check</p>
</td></tr>
<tr><td><code id="if_null_then_+3A_y">y</code></td>
<td>
<p>A value to substitute if x is null</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
x &lt;- NULL
x &lt;- x %||% "none"
x &lt;- x %||% NA

## End(Not run)

</code></pre>

<hr>
<h2 id='insertImage'>Insert an image into a worksheet</h2><span id='topic+insertImage'></span>

<h3>Description</h3>

<p>Insert an image into a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insertImage(
  wb,
  sheet,
  file,
  width = 6,
  height = 3,
  startRow = 1,
  startCol = 1,
  units = "in",
  dpi = 300,
  address
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="insertImage_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="insertImage_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="insertImage_+3A_file">file</code></td>
<td>
<p>An image file. Valid file types are: jpeg, png, bmp</p>
</td></tr>
<tr><td><code id="insertImage_+3A_width">width</code></td>
<td>
<p>Width of figure.</p>
</td></tr>
<tr><td><code id="insertImage_+3A_height">height</code></td>
<td>
<p>Height of figure.</p>
</td></tr>
<tr><td><code id="insertImage_+3A_startrow">startRow</code></td>
<td>
<p>Row coordinate of upper left corner of the image</p>
</td></tr>
<tr><td><code id="insertImage_+3A_startcol">startCol</code></td>
<td>
<p>Column coordinate of upper left corner of the image</p>
</td></tr>
<tr><td><code id="insertImage_+3A_units">units</code></td>
<td>
<p>Units of width and height. Can be &quot;in&quot;, &quot;cm&quot; or &quot;px&quot;</p>
</td></tr>
<tr><td><code id="insertImage_+3A_dpi">dpi</code></td>
<td>
<p>Image resolution used for conversion between units.</p>
</td></tr>
<tr><td><code id="insertImage_+3A_address">address</code></td>
<td>
<p>An optional character string specifying an external URL, relative or absolute path to a file, or mailto string (e.g. &quot;mailto:example@example.com&quot;) that will be opened when the image is clicked.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insertPlot">insertPlot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- createWorkbook("Ayanami")

## Add some worksheets
addWorksheet(wb, "Sheet 1")
addWorksheet(wb, "Sheet 2")
addWorksheet(wb, "Sheet 3")
addWorksheet(wb, "Sheet 4")

## Insert images
img &lt;- system.file("extdata", "einstein.jpg", package = "openxlsx")
insertImage(wb, "Sheet 1", img, startRow = 5, startCol = 3, width = 6, height = 5)
insertImage(wb, 2, img, startRow = 2, startCol = 2)
insertImage(wb, 3, img, width = 15, height = 12, startRow = 3, startCol = "G", units = "cm")
insertImage(wb, 4, img, address = "https://github.com/ycphs/openxlsx")

## Save workbook
## Not run: 
saveWorkbook(wb, "insertImageExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='insertPlot'>Insert the current plot into a worksheet</h2><span id='topic+insertPlot'></span>

<h3>Description</h3>

<p>The current plot is saved to a temporary image file using dev.copy.
This file is then written to the workbook using insertImage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insertPlot(
  wb,
  sheet,
  width = 6,
  height = 4,
  xy = NULL,
  startRow = 1,
  startCol = 1,
  fileType = "png",
  units = "in",
  dpi = 300
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="insertPlot_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="insertPlot_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="insertPlot_+3A_width">width</code></td>
<td>
<p>Width of figure. Defaults to 6in.</p>
</td></tr>
<tr><td><code id="insertPlot_+3A_height">height</code></td>
<td>
<p>Height of figure . Defaults to 4in.</p>
</td></tr>
<tr><td><code id="insertPlot_+3A_xy">xy</code></td>
<td>
<p>Alternate way to specify startRow and startCol.  A vector of length 2 of form (startcol, startRow)</p>
</td></tr>
<tr><td><code id="insertPlot_+3A_startrow">startRow</code></td>
<td>
<p>Row coordinate of upper left corner of figure.<code> xy[[2]]</code> when xy is given.</p>
</td></tr>
<tr><td><code id="insertPlot_+3A_startcol">startCol</code></td>
<td>
<p>Column coordinate of upper left corner of figure. <code>xy[[1]]</code> when xy is given.</p>
</td></tr>
<tr><td><code id="insertPlot_+3A_filetype">fileType</code></td>
<td>
<p>File type of image</p>
</td></tr>
<tr><td><code id="insertPlot_+3A_units">units</code></td>
<td>
<p>Units of width and height. Can be &quot;in&quot;, &quot;cm&quot; or &quot;px&quot;</p>
</td></tr>
<tr><td><code id="insertPlot_+3A_dpi">dpi</code></td>
<td>
<p>Image resolution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insertImage">insertImage()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Create a new workbook
wb &lt;- createWorkbook()

## Add a worksheet
addWorksheet(wb, "Sheet 1", gridLines = FALSE)

## create plot objects
require(ggplot2)
p1 &lt;- qplot(mpg,
  data = mtcars, geom = "density",
  fill = as.factor(gear), alpha = I(.5), main = "Distribution of Gas Mileage"
)
p2 &lt;- qplot(age, circumference,
  data = Orange, geom = c("point", "line"), colour = Tree
)

## Insert currently displayed plot to sheet 1, row 1, column 1
print(p1) # plot needs to be showing
insertPlot(wb, 1, width = 5, height = 3.5, fileType = "png", units = "in")

## Insert plot 2
print(p2)
insertPlot(wb, 1, xy = c("J", 2), width = 16, height = 10, fileType = "png", units = "cm")

## Save workbook
saveWorkbook(wb, "insertPlotExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='int2col'>Convert integer to Excel column</h2><span id='topic+int2col'></span>

<h3>Description</h3>

<p>Converts an integer to an Excel column label.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>int2col(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="int2col_+3A_x">x</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>int2col(1:10)
</code></pre>

<hr>
<h2 id='loadWorkbook'>Load an existing .xlsx file</h2><span id='topic+loadWorkbook'></span>

<h3>Description</h3>

<p>loadWorkbook returns a workbook object conserving styles and
formatting of the original .xlsx file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadWorkbook(file, xlsxFile = NULL, isUnzipped = FALSE, na.convert = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadWorkbook_+3A_file">file</code></td>
<td>
<p>A path to an existing .xlsx or .xlsm file</p>
</td></tr>
<tr><td><code id="loadWorkbook_+3A_xlsxfile">xlsxFile</code></td>
<td>
<p>alias for file</p>
</td></tr>
<tr><td><code id="loadWorkbook_+3A_isunzipped">isUnzipped</code></td>
<td>
<p>Set to TRUE if the xlsx file is already unzipped</p>
</td></tr>
<tr><td><code id="loadWorkbook_+3A_na.convert">na.convert</code></td>
<td>
<p>Should empty/blank cells be converted to <code>NA_character_</code>. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Workbook object.
</p>


<h3>Author(s)</h3>

<p>Alexander Walker, Philipp Schauberger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+removeWorksheet">removeWorksheet()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load existing workbook from package folder
wb &lt;- loadWorkbook(file = system.file("extdata", "loadExample.xlsx", package = "openxlsx"))
names(wb) # list worksheets
wb ## view object
## Add a worksheet
addWorksheet(wb, "A new worksheet")

## Save workbook
## Not run: 
saveWorkbook(wb, "loadExample.xlsx", overwrite = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='makeHyperlinkString'>create Excel hyperlink string</h2><span id='topic+makeHyperlinkString'></span>

<h3>Description</h3>

<p>Wrapper to create internal hyperlink string to pass to writeFormula(). Either link to external urls or local files or straight to cells of local Excel sheets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeHyperlinkString(sheet, row = 1, col = 1, text = NULL, file = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeHyperlinkString_+3A_sheet">sheet</code></td>
<td>
<p>Name of a worksheet</p>
</td></tr>
<tr><td><code id="makeHyperlinkString_+3A_row">row</code></td>
<td>
<p>integer row number for hyperlink to link to</p>
</td></tr>
<tr><td><code id="makeHyperlinkString_+3A_col">col</code></td>
<td>
<p>column number of letter for hyperlink to link to</p>
</td></tr>
<tr><td><code id="makeHyperlinkString_+3A_text">text</code></td>
<td>
<p>display text</p>
</td></tr>
<tr><td><code id="makeHyperlinkString_+3A_file">file</code></td>
<td>
<p>Excel file name to point to. If NULL hyperlink is internal.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+writeFormula">writeFormula()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Writing internal hyperlinks
wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet1")
addWorksheet(wb, "Sheet2")
addWorksheet(wb, "Sheet 3")
writeData(wb, sheet = 3, x = iris)

## External Hyperlink
x &lt;- c("https://www.google.com", "https://www.google.com.au")
names(x) &lt;- c("google", "google Aus")
class(x) &lt;- "hyperlink"

writeData(wb, sheet = 1, x = x, startCol = 10)


## Internal Hyperlink - create hyperlink formula manually
writeFormula(
  wb, "Sheet1",
  x = '=HYPERLINK(\"#Sheet2!B3\", "Text to Display - Link to Sheet2")',
  startCol = 3
)

## Internal - No text to display using makeHyperlinkString() function
writeFormula(
  wb, "Sheet1",
  startRow = 1,
  x = makeHyperlinkString(sheet = "Sheet 3", row = 1, col = 2)
)

## Internal - Text to display
writeFormula(
  wb, "Sheet1",
  startRow = 2,
  x = makeHyperlinkString(
    sheet = "Sheet 3", row = 1, col = 2,
    text = "Link to Sheet 3"
  )
)

## Link to file - No text to display
writeFormula(
  wb, "Sheet1",
  startRow = 4,
  x = makeHyperlinkString(
    sheet = "testing", row = 3, col = 10,
    file = system.file("extdata", "loadExample.xlsx", package = "openxlsx")
  )
)

## Link to file - Text to display
writeFormula(
  wb, "Sheet1",
  startRow = 3,
  x = makeHyperlinkString(
    sheet = "testing", row = 3, col = 10,
    file = system.file("extdata", "loadExample.xlsx", package = "openxlsx"),
    text = "Link to File."
  )
)

## Link to external file - Text to display
writeFormula(
  wb, "Sheet1",
  startRow = 10, startCol = 1,
  x = '=HYPERLINK("[C:/Users]", "Link to an external file")'
)

## Link to internal file
x = makeHyperlinkString(text = "test.png", file = "D:/somepath/somepicture.png")
writeFormula(wb, "Sheet1", startRow = 11, startCol = 1, x = x)

## Not run: 
saveWorkbook(wb, "internalHyperlinks.xlsx", overwrite = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='mergeCells'>Merge cells within a worksheet</h2><span id='topic+mergeCells'></span>

<h3>Description</h3>

<p>Merge cells within a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mergeCells(wb, sheet, cols, rows)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mergeCells_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="mergeCells_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="mergeCells_+3A_cols">cols</code></td>
<td>
<p>Columns to merge</p>
</td></tr>
<tr><td><code id="mergeCells_+3A_rows">rows</code></td>
<td>
<p>corresponding rows to merge</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As merged region must be rectangular, only min and max of cols and rows are used.
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+removeCellMerge">removeCellMerge()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- createWorkbook()

## Add a worksheet
addWorksheet(wb, "Sheet 1")
addWorksheet(wb, "Sheet 2")

## Merge cells: Row 2 column C to F (3:6)
mergeCells(wb, "Sheet 1", cols = 2, rows = 3:6)

## Merge cells:Rows 10 to 20 columns A to J (1:10)
mergeCells(wb, 1, cols = 1:10, rows = 10:20)

## Intersecting merges
mergeCells(wb, 2, cols = 1:10, rows = 1)
mergeCells(wb, 2, cols = 5:10, rows = 2)
mergeCells(wb, 2, cols = c(1, 10), rows = 12) ## equivalent to 1:10 as only min/max are used
# mergeCells(wb, 2, cols = 1, rows = c(1,10)) # Throws error because intersects existing merge

## remove merged cells
removeCellMerge(wb, 2, cols = 1, rows = 1) # removes any intersecting merges
mergeCells(wb, 2, cols = 1, rows = 1:10) # Now this works

## Save workbook
## Not run: 
saveWorkbook(wb, "mergeCellsExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='modifyBaseFont'>Modify the default font</h2><span id='topic+modifyBaseFont'></span>

<h3>Description</h3>

<p>Modify the default font for this workbook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modifyBaseFont(wb, fontSize = 11, fontColour = "black", fontName = "Calibri")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modifyBaseFont_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="modifyBaseFont_+3A_fontsize">fontSize</code></td>
<td>
<p>font size</p>
</td></tr>
<tr><td><code id="modifyBaseFont_+3A_fontcolour">fontColour</code></td>
<td>
<p>font colour</p>
</td></tr>
<tr><td><code id="modifyBaseFont_+3A_fontname">fontName</code></td>
<td>
<p>Name of a font</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The font name is not validated in anyway.  Excel replaces unknown font names
with Arial. Base font is black, size 11, Calibri.
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create a workbook
wb &lt;- createWorkbook()
addWorksheet(wb, "S1")
## modify base font to size 10 Arial Narrow in red
modifyBaseFont(wb, fontSize = 10, fontColour = "#FF0000", fontName = "Arial Narrow")

writeData(wb, "S1", iris)
writeDataTable(wb, "S1", x = iris, startCol = 10) ## font colour does not affect tables
## Not run: 
saveWorkbook(wb, "modifyBaseFontExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='names'>get or set worksheet names</h2><span id='topic+names'></span><span id='topic+names.Workbook'></span><span id='topic+names+3C-.Workbook'></span>

<h3>Description</h3>

<p>get or set worksheet names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Workbook'
names(x)

## S3 replacement method for class 'Workbook'
names(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="names_+3A_x">x</code></td>
<td>
<p>A <code>Workbook</code> object</p>
</td></tr>
<tr><td><code id="names_+3A_value">value</code></td>
<td>
<p>a character vector the same length as wb</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
addWorksheet(wb, "S1")
addWorksheet(wb, "S2")
addWorksheet(wb, "S3")

names(wb)
names(wb)[[2]] &lt;- "S2a"
names(wb)
names(wb) &lt;- paste("Sheet", 1:3)
</code></pre>

<hr>
<h2 id='openXL'>Open a Microsoft Excel file (xls/xlsx) or an openxlsx Workbook</h2><span id='topic+openXL'></span>

<h3>Description</h3>

<p>This function tries to open a Microsoft Excel
(xls/xlsx) file or an openxlsx Workbook with the proper
application, in a portable manner.
</p>
<p>In Windows (c) and Mac (c), it uses system default handlers,
given the file type.
</p>
<p>In Linux it searches (via <code>which</code>) for available xls/xlsx
reader applications (unless <code>options('openxlsx.excelApp')</code>
is set to the app bin path), and if it finds anything, sets
<code>options('openxlsx.excelApp')</code> to the program choosen by
the user via a menu (if many are present, otherwise it will
set the only available). Currently searched for apps are
Libreoffice/Openoffice (<code>soffice</code> bin), Gnumeric
(<code>gnumeric</code>) and Calligra Sheets (<code>calligrasheets</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>openXL(file=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="openXL_+3A_file">file</code></td>
<td>
<p>path to the Excel (xls/xlsx) file or Workbook object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luca Braglia
</p>


<h3>Examples</h3>

<pre><code class='language-R'># file example
example(writeData)
# openXL("writeDataExample.xlsx")

# (not yet saved) Workbook example
wb &lt;- createWorkbook()
x &lt;- mtcars[1:6, ]
addWorksheet(wb, "Cars")
writeData(wb, "Cars", x, startCol = 2, startRow = 3, rowNames = TRUE)
# openXL(wb)
</code></pre>

<hr>
<h2 id='openxlsx_options'>openxlsx Options</h2><span id='topic+openxlsx_options'></span><span id='topic+op.openxlsx'></span><span id='topic+openxlsx_getOp'></span><span id='topic+openxlsx_setOp'></span>

<h3>Description</h3>

<p>See and get the openxlsx options
</p>


<h3>Usage</h3>

<pre><code class='language-R'>op.openxlsx

openxlsx_getOp(x, default = NULL)

openxlsx_setOp(x, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="openxlsx_options_+3A_x">x</code></td>
<td>
<p>An option name (<code>"openxlsx."</code> prefix optional)</p>
</td></tr>
<tr><td><code id="openxlsx_options_+3A_default">default</code></td>
<td>
<p>A default value if <code>NULL</code></p>
</td></tr>
<tr><td><code id="openxlsx_options_+3A_value">value</code></td>
<td>
<p>The new value for the option (optional if x is a named list)</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 34.
</p>


<h3>Details</h3>

<p><code>openxlsx_getOp()</code> retrieves the <code>"openxlsx"</code> options found in
<code>op.openxlsx</code>.  If none are set (currently <code>NULL</code>) retrieves the
default option from <code>op.openxlsx</code>.  This will also check that the
intended option is a standard option (listed in <code>op.openxlsx</code>) and
will provide a warning otherwise.
</p>
<p><code>openxlsx_setOp()</code> is a safer way to set an option as it will first
check that the option is a standard option (as above) before setting.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>openxlsx_getOp("borders")
op.openxlsx[["openxlsx.borders"]]

</code></pre>

<hr>
<h2 id='openxlsxFontSizeLookupTable'>Font Size Lookup tables</h2><span id='topic+openxlsxFontSizeLookupTable'></span><span id='topic+openxlsxFontSizeLookupTableBold'></span>

<h3>Description</h3>

<p>Lookup tables for font size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>openxlsxFontSizeLookupTable

openxlsxFontSizeLookupTableBold
</code></pre>


<h3>Format</h3>

<p>A data.frame with column names corresponding to font names
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(openxlsxFontSizeLookupTable)
data(openxlsxFontSizeLookupTableBold)
</code></pre>

<hr>
<h2 id='pageBreak'>add a page break to a worksheet</h2><span id='topic+pageBreak'></span>

<h3>Description</h3>

<p>insert page breaks into a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pageBreak(wb, sheet, i, type = "row")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pageBreak_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="pageBreak_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="pageBreak_+3A_i">i</code></td>
<td>
<p>row or column number to insert page break.</p>
</td></tr>
<tr><td><code id="pageBreak_+3A_type">type</code></td>
<td>
<p>One of &quot;row&quot; or &quot;column&quot; for a row break or column break.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+addWorksheet">addWorksheet()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")
writeData(wb, sheet = 1, x = iris)

pageBreak(wb, sheet = 1, i = 10, type = "row")
pageBreak(wb, sheet = 1, i = 20, type = "row")
pageBreak(wb, sheet = 1, i = 2, type = "column")
## Not run: 
saveWorkbook(wb, "pageBreakExample.xlsx", TRUE)

## End(Not run)
## In Excel: View tab -&gt; Page Break Preview
</code></pre>

<hr>
<h2 id='pageSetup'>Set page margins, orientation and print scaling</h2><span id='topic+pageSetup'></span>

<h3>Description</h3>

<p>Set page margins, orientation and print scaling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pageSetup(
  wb,
  sheet,
  orientation = NULL,
  scale = 100,
  left = 0.7,
  right = 0.7,
  top = 0.75,
  bottom = 0.75,
  header = 0.3,
  footer = 0.3,
  fitToWidth = FALSE,
  fitToHeight = FALSE,
  paperSize = NULL,
  printTitleRows = NULL,
  printTitleCols = NULL,
  summaryRow = NULL,
  summaryCol = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pageSetup_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_orientation">orientation</code></td>
<td>
<p>Page orientation. One of &quot;portrait&quot; or &quot;landscape&quot;</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_scale">scale</code></td>
<td>
<p>Print scaling. Numeric value between 10 and 400</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_left">left</code></td>
<td>
<p>left page margin in inches</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_right">right</code></td>
<td>
<p>right page margin in inches</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_top">top</code></td>
<td>
<p>top page margin in inches</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_bottom">bottom</code></td>
<td>
<p>bottom page margin in inches</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_header">header</code></td>
<td>
<p>header margin in inches</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_footer">footer</code></td>
<td>
<p>footer margin in inches</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_fittowidth">fitToWidth</code></td>
<td>
<p>If <code>TRUE</code>, worksheet is scaled to fit to page width on printing.</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_fittoheight">fitToHeight</code></td>
<td>
<p>If <code>TRUE</code>, worksheet is scaled to fit to page height on printing.</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_papersize">paperSize</code></td>
<td>
<p>See details. Default value is 9 (A4 paper).</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_printtitlerows">printTitleRows</code></td>
<td>
<p>Rows to repeat at top of page when printing. Integer vector.</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_printtitlecols">printTitleCols</code></td>
<td>
<p>Columns to repeat at left when printing. Integer vector.</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_summaryrow">summaryRow</code></td>
<td>
<p>Location of summary rows in groupings. One of &quot;Above&quot; or &quot;Below&quot;.</p>
</td></tr>
<tr><td><code id="pageSetup_+3A_summarycol">summaryCol</code></td>
<td>
<p>Location of summary columns in groupings. One of &quot;Right&quot; or &quot;Left&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>paperSize is an integer corresponding to:
</p>

<dl>
<dt><strong>1</strong></dt><dd><p> Letter paper (8.5 in. by 11 in.)</p>
</dd>
<dt><strong>2</strong></dt><dd><p> Letter small paper (8.5 in. by 11 in.)</p>
</dd>
<dt><strong>3</strong></dt><dd><p> Tabloid paper (11 in. by 17 in.)</p>
</dd>
<dt><strong>4</strong></dt><dd><p> Ledger paper (17 in. by 11 in.)</p>
</dd>
<dt><strong>5</strong></dt><dd><p> Legal paper (8.5 in. by 14 in.)</p>
</dd>
<dt><strong>6</strong></dt><dd><p> Statement paper (5.5 in. by 8.5 in.)</p>
</dd>
<dt><strong>7</strong></dt><dd><p> Executive paper (7.25 in. by 10.5 in.)</p>
</dd>
<dt><strong>8</strong></dt><dd><p> A3 paper (297 mm by 420 mm)</p>
</dd>
<dt><strong>9</strong></dt><dd><p> A4 paper (210 mm by 297 mm)</p>
</dd>
<dt><strong>10</strong></dt><dd><p> A4 small paper (210 mm by 297 mm)</p>
</dd>
<dt><strong>11</strong></dt><dd><p> A5 paper (148 mm by 210 mm)</p>
</dd>
<dt><strong>12</strong></dt><dd><p> B4 paper (250 mm by 353 mm)</p>
</dd>
<dt><strong>13</strong></dt><dd><p> B5 paper (176 mm by 250 mm)</p>
</dd>
<dt><strong>14</strong></dt><dd><p> Folio paper (8.5 in. by 13 in.)</p>
</dd>
<dt><strong>15</strong></dt><dd><p> Quarto paper (215 mm by 275 mm)</p>
</dd>
<dt><strong>16</strong></dt><dd><p> Standard paper (10 in. by 14 in.)</p>
</dd>
<dt><strong>17</strong></dt><dd><p> Standard paper (11 in. by 17 in.)</p>
</dd>
<dt><strong>18</strong></dt><dd><p> Note paper (8.5 in. by 11 in.)</p>
</dd>
<dt><strong>19</strong></dt><dd><p> #9 envelope (3.875 in. by 8.875 in.)</p>
</dd>
<dt><strong>20</strong></dt><dd><p> #10 envelope (4.125 in. by 9.5 in.)</p>
</dd>
<dt><strong>21</strong></dt><dd><p> #11 envelope (4.5 in. by 10.375 in.)</p>
</dd>
<dt><strong>22</strong></dt><dd><p> #12 envelope (4.75 in. by 11 in.)</p>
</dd>
<dt><strong>23</strong></dt><dd><p> #14 envelope (5 in. by 11.5 in.)</p>
</dd>
<dt><strong>24</strong></dt><dd><p> C paper (17 in. by 22 in.)</p>
</dd>
<dt><strong>25</strong></dt><dd><p> D paper (22 in. by 34 in.)</p>
</dd>
<dt><strong>26</strong></dt><dd><p> E paper (34 in. by 44 in.)</p>
</dd>
<dt><strong>27</strong></dt><dd><p> DL envelope (110 mm by 220 mm)</p>
</dd>
<dt><strong>28</strong></dt><dd><p> C5 envelope (162 mm by 229 mm)</p>
</dd>
<dt><strong>29</strong></dt><dd><p> C3 envelope (324 mm by 458 mm)</p>
</dd>
<dt><strong>30</strong></dt><dd><p> C4 envelope (229 mm by 324 mm)</p>
</dd>
<dt><strong>31</strong></dt><dd><p> C6 envelope (114 mm by 162 mm)</p>
</dd>
<dt><strong>32</strong></dt><dd><p> C65 envelope (114 mm by 229 mm)</p>
</dd>
<dt><strong>33</strong></dt><dd><p> B4 envelope (250 mm by 353 mm)</p>
</dd>
<dt><strong>34</strong></dt><dd><p> B5 envelope (176 mm by 250 mm)</p>
</dd>
<dt><strong>35</strong></dt><dd><p> B6 envelope (176 mm by 125 mm)</p>
</dd>
<dt><strong>36</strong></dt><dd><p> Italy envelope (110 mm by 230 mm)</p>
</dd>
<dt><strong>37</strong></dt><dd><p> Monarch envelope (3.875 in. by 7.5 in.).</p>
</dd>
<dt><strong>38</strong></dt><dd><p> 6 3/4 envelope (3.625 in. by 6.5 in.)</p>
</dd>
<dt><strong>39</strong></dt><dd><p> US standard fanfold (14.875 in. by 11 in.)</p>
</dd>
<dt><strong>40</strong></dt><dd><p> German standard fanfold (8.5 in. by 12 in.)</p>
</dd>
<dt><strong>41</strong></dt><dd><p> German legal fanfold (8.5 in. by 13 in.)</p>
</dd>
<dt><strong>42</strong></dt><dd><p> ISO B4 (250 mm by 353 mm)</p>
</dd>
<dt><strong>43</strong></dt><dd><p> Japanese double postcard (200 mm by 148 mm)</p>
</dd>
<dt><strong>44</strong></dt><dd><p> Standard paper (9 in. by 11 in.)</p>
</dd>
<dt><strong>45</strong></dt><dd><p> Standard paper (10 in. by 11 in.)</p>
</dd>
<dt><strong>46</strong></dt><dd><p> Standard paper (15 in. by 11 in.)</p>
</dd>
<dt><strong>47</strong></dt><dd><p> Invite envelope (220 mm by 220 mm)</p>
</dd>
<dt><strong>50</strong></dt><dd><p> Letter extra paper (9.275 in. by 12 in.)</p>
</dd>
<dt><strong>51</strong></dt><dd><p> Legal extra paper (9.275 in. by 15 in.)</p>
</dd>
<dt><strong>52</strong></dt><dd><p> Tabloid extra paper (11.69 in. by 18 in.)</p>
</dd>
<dt><strong>53</strong></dt><dd><p> A4 extra paper (236 mm by 322 mm)</p>
</dd>
<dt><strong>54</strong></dt><dd><p> Letter transverse paper (8.275 in. by 11 in.)</p>
</dd>
<dt><strong>55</strong></dt><dd><p> A4 transverse paper (210 mm by 297 mm)</p>
</dd>
<dt><strong>56</strong></dt><dd><p> Letter extra transverse paper (9.275 in. by 12 in.)</p>
</dd>
<dt><strong>57</strong></dt><dd><p> SuperA/SuperA/A4 paper (227 mm by 356 mm)</p>
</dd>
<dt><strong>58</strong></dt><dd><p> SuperB/SuperB/A3 paper (305 mm by 487 mm)</p>
</dd>
<dt><strong>59</strong></dt><dd><p> Letter plus paper (8.5 in. by 12.69 in.)</p>
</dd>
<dt><strong>60</strong></dt><dd><p> A4 plus paper (210 mm by 330 mm)</p>
</dd>
<dt><strong>61</strong></dt><dd><p> A5 transverse paper (148 mm by 210 mm)</p>
</dd>
<dt><strong>62</strong></dt><dd><p> JIS B5 transverse paper (182 mm by 257 mm)</p>
</dd>
<dt><strong>63</strong></dt><dd><p> A3 extra paper (322 mm by 445 mm)</p>
</dd>
<dt><strong>64</strong></dt><dd><p> A5 extra paper (174 mm by 235 mm)</p>
</dd>
<dt><strong>65</strong></dt><dd><p> ISO B5 extra paper (201 mm by 276 mm)</p>
</dd>
<dt><strong>66</strong></dt><dd><p> A2 paper (420 mm by 594 mm)</p>
</dd>
<dt><strong>67</strong></dt><dd><p> A3 transverse paper (297 mm by 420 mm)</p>
</dd>
<dt><strong>68</strong></dt><dd><p> A3 extra transverse paper (322 mm by 445 mm)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Alexander Walker, Joshua Sturm
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "S1")
addWorksheet(wb, "S2")
writeDataTable(wb, 1, x = iris[1:30, ])
writeDataTable(wb, 2, x = iris[1:30, ], xy = c("C", 5))

## landscape page scaled to 50%
pageSetup(wb, sheet = 1, orientation = "landscape", scale = 50)

## portrait page scales to 300% with 0.5in left and right margins
pageSetup(wb, sheet = 2, orientation = "portrait", scale = 300, left = 0.5, right = 0.5)


## print titles
addWorksheet(wb, "print_title_rows")
addWorksheet(wb, "print_title_cols")

writeData(wb, "print_title_rows", rbind(iris, iris, iris, iris))
writeData(wb, "print_title_cols", x = rbind(mtcars, mtcars, mtcars), rowNames = TRUE)

pageSetup(wb, sheet = "print_title_rows", printTitleRows = 1) ## first row
pageSetup(wb, sheet = "print_title_cols", printTitleCols = 1, printTitleRows = 1)
## Not run: 
saveWorkbook(wb, "pageSetupExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='protectWorkbook'>Protect a workbook from modifications</h2><span id='topic+protectWorkbook'></span>

<h3>Description</h3>

<p>Protect or unprotect a workbook from modifications by the user in the graphical user interface. Replaces an existing protection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>protectWorkbook(
  wb,
  protect = TRUE,
  password = NULL,
  lockStructure = FALSE,
  lockWindows = FALSE,
  type = 1L
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="protectWorkbook_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="protectWorkbook_+3A_protect">protect</code></td>
<td>
<p>Whether to protect or unprotect the sheet (default=TRUE)</p>
</td></tr>
<tr><td><code id="protectWorkbook_+3A_password">password</code></td>
<td>
<p>(optional) password required to unprotect the workbook</p>
</td></tr>
<tr><td><code id="protectWorkbook_+3A_lockstructure">lockStructure</code></td>
<td>
<p>Whether the workbook structure should be locked</p>
</td></tr>
<tr><td><code id="protectWorkbook_+3A_lockwindows">lockWindows</code></td>
<td>
<p>Whether the window position of the spreadsheet should be locked</p>
</td></tr>
<tr><td><code id="protectWorkbook_+3A_type">type</code></td>
<td>
<p>Lock type, default 1. From the xml documentation: 1 - Document is password protected. 2 - Document is recommended to be opened as read-only. 4 - Document is enforced to be opened as read-only. 8 - Document is locked for annotation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Reinhold Kainhofer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "S1")
protectWorkbook(wb, protect = TRUE, password = "Password", lockStructure = TRUE)
## Not run: 
saveWorkbook(wb, "WorkBook_Protection.xlsx", overwrite = TRUE)

## End(Not run)
# Remove the protection
protectWorkbook(wb, protect = FALSE)
## Not run: 
saveWorkbook(wb, "WorkBook_Protection_unprotected.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='protectWorksheet'>Protect a worksheet from modifications</h2><span id='topic+protectWorksheet'></span>

<h3>Description</h3>

<p>Protect or unprotect a worksheet from modifications by the user in the graphical user interface. Replaces an existing protection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>protectWorksheet(
  wb,
  sheet,
  protect = TRUE,
  password = NULL,
  lockSelectingLockedCells = NULL,
  lockSelectingUnlockedCells = NULL,
  lockFormattingCells = NULL,
  lockFormattingColumns = NULL,
  lockFormattingRows = NULL,
  lockInsertingColumns = NULL,
  lockInsertingRows = NULL,
  lockInsertingHyperlinks = NULL,
  lockDeletingColumns = NULL,
  lockDeletingRows = NULL,
  lockSorting = NULL,
  lockAutoFilter = NULL,
  lockPivotTables = NULL,
  lockObjects = NULL,
  lockScenarios = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="protectWorksheet_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_protect">protect</code></td>
<td>
<p>Whether to protect or unprotect the sheet (default=TRUE)</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_password">password</code></td>
<td>
<p>(optional) password required to unprotect the worksheet</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockselectinglockedcells">lockSelectingLockedCells</code></td>
<td>
<p>Whether selecting locked cells is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockselectingunlockedcells">lockSelectingUnlockedCells</code></td>
<td>
<p>Whether selecting unlocked cells is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockformattingcells">lockFormattingCells</code></td>
<td>
<p>Whether formatting cells is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockformattingcolumns">lockFormattingColumns</code></td>
<td>
<p>Whether formatting columns is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockformattingrows">lockFormattingRows</code></td>
<td>
<p>Whether formatting rows is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockinsertingcolumns">lockInsertingColumns</code></td>
<td>
<p>Whether inserting columns is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockinsertingrows">lockInsertingRows</code></td>
<td>
<p>Whether inserting rows is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockinsertinghyperlinks">lockInsertingHyperlinks</code></td>
<td>
<p>Whether inserting hyperlinks is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockdeletingcolumns">lockDeletingColumns</code></td>
<td>
<p>Whether deleting columns is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockdeletingrows">lockDeletingRows</code></td>
<td>
<p>Whether deleting rows is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_locksorting">lockSorting</code></td>
<td>
<p>Whether sorting is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockautofilter">lockAutoFilter</code></td>
<td>
<p>Whether auto-filter is locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockpivottables">lockPivotTables</code></td>
<td>
<p>Whether pivot tables are locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockobjects">lockObjects</code></td>
<td>
<p>Whether objects are locked</p>
</td></tr>
<tr><td><code id="protectWorksheet_+3A_lockscenarios">lockScenarios</code></td>
<td>
<p>Whether scenarios are locked</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Reinhold Kainhofer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "S1")
writeDataTable(wb, 1, x = iris[1:30, ])
# Formatting cells / columns is allowed , but inserting / deleting columns is protected:
protectWorksheet(wb, "S1",
  protect = TRUE,
  lockFormattingCells = FALSE, lockFormattingColumns = FALSE,
  lockInsertingColumns = TRUE, lockDeletingColumns = TRUE
)

# Remove the protection
protectWorksheet(wb, "S1", protect = FALSE)
## Not run: 
saveWorkbook(wb, "pageSetupExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='read.xlsx'>Read from an Excel file or Workbook object</h2><span id='topic+read.xlsx'></span>

<h3>Description</h3>

<p>Read data from an Excel file or Workbook object into a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.xlsx(
  xlsxFile,
  sheet,
  startRow = 1,
  colNames = TRUE,
  rowNames = FALSE,
  detectDates = FALSE,
  skipEmptyRows = TRUE,
  skipEmptyCols = TRUE,
  rows = NULL,
  cols = NULL,
  check.names = FALSE,
  sep.names = ".",
  namedRegion = NULL,
  na.strings = "NA",
  fillMergedCells = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.xlsx_+3A_xlsxfile">xlsxFile</code></td>
<td>
<p>An xlsx file, Workbook object or URL to xlsx file.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to read data from.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_startrow">startRow</code></td>
<td>
<p>first row to begin looking for data.  Empty rows at the top of a file are always skipped,
regardless of the value of startRow.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_colnames">colNames</code></td>
<td>
<p>If <code>TRUE</code>, the first row of data will be used as column names.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_rownames">rowNames</code></td>
<td>
<p>If <code>TRUE</code>, first column of data will be used as row names.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_detectdates">detectDates</code></td>
<td>
<p>If <code>TRUE</code>, attempt to recognise dates and perform conversion.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_skipemptyrows">skipEmptyRows</code></td>
<td>
<p>If <code>TRUE</code>, empty rows are skipped else empty rows after the first row containing data
will return a row of NAs.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_skipemptycols">skipEmptyCols</code></td>
<td>
<p>If <code>TRUE</code>, empty columns are skipped.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_rows">rows</code></td>
<td>
<p>A numeric vector specifying which rows in the Excel file to read.
If NULL, all rows are read.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_cols">cols</code></td>
<td>
<p>A numeric vector specifying which columns in the Excel file to read.
If NULL, all columns are read.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_check.names">check.names</code></td>
<td>
<p>logical. If TRUE then the names of the variables in the data frame
are checked to ensure that they are syntactically valid variable names</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_sep.names">sep.names</code></td>
<td>
<p>One character which substitutes blanks in column names. By default, &quot;.&quot;</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_namedregion">namedRegion</code></td>
<td>
<p>A named region in the Workbook. If not NULL startRow, rows and cols parameters are ignored.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_na.strings">na.strings</code></td>
<td>
<p>A character vector of strings which are to be interpreted as NA. Blank cells will be returned as NA.</p>
</td></tr>
<tr><td><code id="read.xlsx_+3A_fillmergedcells">fillMergedCells</code></td>
<td>
<p>If TRUE, the value in a merged cell is given to all cells within the merge.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Formulae written using writeFormula to a Workbook object will not get picked up by read.xlsx().
This is because only the formula is written and left to be evaluated when the file is opened in Excel.
Opening, saving and closing the file with Excel will resolve this.
</p>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getNamedRegions">getNamedRegions()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
xlsxFile &lt;- system.file("extdata", "readTest.xlsx", package = "openxlsx")
df1 &lt;- read.xlsx(xlsxFile = xlsxFile, sheet = 1, skipEmptyRows = FALSE)
sapply(df1, class)

df2 &lt;- read.xlsx(xlsxFile = xlsxFile, sheet = 3, skipEmptyRows = TRUE)
df2$Date &lt;- convertToDate(df2$Date)
sapply(df2, class)
head(df2)

df2 &lt;- read.xlsx(
  xlsxFile = xlsxFile, sheet = 3, skipEmptyRows = TRUE,
  detectDates = TRUE
)
sapply(df2, class)
head(df2)

wb &lt;- loadWorkbook(system.file("extdata", "readTest.xlsx", package = "openxlsx"))
df3 &lt;- read.xlsx(wb, sheet = 2, skipEmptyRows = FALSE, colNames = TRUE)
df4 &lt;- read.xlsx(xlsxFile, sheet = 2, skipEmptyRows = FALSE, colNames = TRUE)
all.equal(df3, df4)

wb &lt;- loadWorkbook(system.file("extdata", "readTest.xlsx", package = "openxlsx"))
df3 &lt;- read.xlsx(wb,
  sheet = 2, skipEmptyRows = FALSE,
  cols = c(1, 4), rows = c(1, 3, 4)
)

## URL
##
## Not run: 
xlsxFile &lt;- "https://github.com/awalker89/openxlsx/raw/master/inst/readTest.xlsx"
head(read.xlsx(xlsxFile))

## End(Not run)

</code></pre>

<hr>
<h2 id='readWorkbook'>Read from an Excel file or Workbook object</h2><span id='topic+readWorkbook'></span>

<h3>Description</h3>

<p>Read data from an Excel file or Workbook object into a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readWorkbook(
  xlsxFile,
  sheet = 1,
  startRow = 1,
  colNames = TRUE,
  rowNames = FALSE,
  detectDates = FALSE,
  skipEmptyRows = TRUE,
  skipEmptyCols = TRUE,
  rows = NULL,
  cols = NULL,
  check.names = FALSE,
  sep.names = ".",
  namedRegion = NULL,
  na.strings = "NA",
  fillMergedCells = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readWorkbook_+3A_xlsxfile">xlsxFile</code></td>
<td>
<p>An xlsx file, Workbook object or URL to xlsx file.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the sheet to read data from.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_startrow">startRow</code></td>
<td>
<p>first row to begin looking for data.  Empty rows at the top of a file are always skipped,
regardless of the value of startRow.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_colnames">colNames</code></td>
<td>
<p>If <code>TRUE</code>, the first row of data will be used as column names.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_rownames">rowNames</code></td>
<td>
<p>If <code>TRUE</code>, first column of data will be used as row names.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_detectdates">detectDates</code></td>
<td>
<p>If <code>TRUE</code>, attempt to recognise dates and perform conversion.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_skipemptyrows">skipEmptyRows</code></td>
<td>
<p>If <code>TRUE</code>, empty rows are skipped else empty rows after the first row containing data
will return a row of NAs.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_skipemptycols">skipEmptyCols</code></td>
<td>
<p>If <code>TRUE</code>, empty columns are skipped.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_rows">rows</code></td>
<td>
<p>A numeric vector specifying which rows in the Excel file to read.
If NULL, all rows are read.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_cols">cols</code></td>
<td>
<p>A numeric vector specifying which columns in the Excel file to read.
If NULL, all columns are read.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_check.names">check.names</code></td>
<td>
<p>logical. If TRUE then the names of the variables in the data frame
are checked to ensure that they are syntactically valid variable names</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_sep.names">sep.names</code></td>
<td>
<p>One character which substitutes blanks in column names. By default, &quot;.&quot;</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_namedregion">namedRegion</code></td>
<td>
<p>A named region in the Workbook. If not NULL startRow, rows and cols parameters are ignored.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_na.strings">na.strings</code></td>
<td>
<p>A character vector of strings which are to be interpreted as NA. Blank cells will be returned as NA.</p>
</td></tr>
<tr><td><code id="readWorkbook_+3A_fillmergedcells">fillMergedCells</code></td>
<td>
<p>If TRUE, the value in a merged cell is given to all cells within the merge.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a data.frame of all data in worksheet.
</p>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getNamedRegions">getNamedRegions()</a></code>
</p>
<p><code><a href="#topic+read.xlsx">read.xlsx()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xlsxFile &lt;- system.file("extdata", "readTest.xlsx", package = "openxlsx")
df1 &lt;- readWorkbook(xlsxFile = xlsxFile, sheet = 1)

xlsxFile &lt;- system.file("extdata", "readTest.xlsx", package = "openxlsx")
df1 &lt;- readWorkbook(xlsxFile = xlsxFile, sheet = 1, rows = c(1, 3, 5), cols = 1:3)
</code></pre>

<hr>
<h2 id='removeCellMerge'>Create a new Workbook object</h2><span id='topic+removeCellMerge'></span>

<h3>Description</h3>

<p>Unmerges any merged cells that intersect
with the region specified by, min(cols):max(cols) X min(rows):max(rows)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeCellMerge(wb, sheet, cols, rows)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeCellMerge_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="removeCellMerge_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="removeCellMerge_+3A_cols">cols</code></td>
<td>
<p>vector of column indices</p>
</td></tr>
<tr><td><code id="removeCellMerge_+3A_rows">rows</code></td>
<td>
<p>vector of row indices</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mergeCells">mergeCells()</a></code>
</p>

<hr>
<h2 id='removeColWidths'>Remove column widths from a worksheet</h2><span id='topic+removeColWidths'></span>

<h3>Description</h3>

<p>Remove column widths from a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeColWidths(wb, sheet, cols)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeColWidths_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="removeColWidths_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="removeColWidths_+3A_cols">cols</code></td>
<td>
<p>Indices of columns to remove custom width (if any) from.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setColWidths">setColWidths()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- loadWorkbook(file = system.file("extdata", "loadExample.xlsx", package = "openxlsx"))

## remove column widths in columns 1 to 20
removeColWidths(wb, 1, cols = 1:20)
## Not run: 
saveWorkbook(wb, "removeColWidthsExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='removeComment'>Remove a comment from a cell</h2><span id='topic+removeComment'></span>

<h3>Description</h3>

<p>Remove a cell comment from a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeComment(wb, sheet, cols, rows, gridExpand = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeComment_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="removeComment_+3A_sheet">sheet</code></td>
<td>
<p>A vector of names or indices of worksheets</p>
</td></tr>
<tr><td><code id="removeComment_+3A_cols">cols</code></td>
<td>
<p>Columns to delete comments from</p>
</td></tr>
<tr><td><code id="removeComment_+3A_rows">rows</code></td>
<td>
<p>Rows to delete comments from</p>
</td></tr>
<tr><td><code id="removeComment_+3A_gridexpand">gridExpand</code></td>
<td>
<p>If <code>TRUE</code>, all data in rectangle min(rows):max(rows) X min(cols):max(cols)
will be removed.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+createComment">createComment()</a></code>
</p>
<p><code><a href="#topic+writeComment">writeComment()</a></code>
</p>

<hr>
<h2 id='removeFilter'>Remove a worksheet filter</h2><span id='topic+removeFilter'></span>

<h3>Description</h3>

<p>Removes filters from addFilter() and writeData()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeFilter(wb, sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeFilter_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="removeFilter_+3A_sheet">sheet</code></td>
<td>
<p>A vector of names or indices of worksheets</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")
addWorksheet(wb, "Sheet 2")
addWorksheet(wb, "Sheet 3")

writeData(wb, 1, iris)
addFilter(wb, 1, row = 1, cols = 1:ncol(iris))

## Equivalently
writeData(wb, 2, x = iris, withFilter = TRUE)

## Similarly
writeDataTable(wb, 3, iris)

## remove filters
removeFilter(wb, 1:2) ## remove filters
removeFilter(wb, 3) ## Does not affect tables!
## Not run: 
saveWorkbook(wb, file = "removeFilterExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='removeRowHeights'>Remove custom row heights from a worksheet</h2><span id='topic+removeRowHeights'></span>

<h3>Description</h3>

<p>Remove row heights from a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeRowHeights(wb, sheet, rows)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeRowHeights_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="removeRowHeights_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="removeRowHeights_+3A_rows">rows</code></td>
<td>
<p>Indices of rows to remove custom height (if any) from.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setRowHeights">setRowHeights()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- loadWorkbook(file = system.file("extdata", "loadExample.xlsx", package = "openxlsx"))

## remove any custom row heights in rows 1 to 10
removeRowHeights(wb, 1, rows = 1:10)
## Not run: 
saveWorkbook(wb, "removeRowHeightsExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='removeTable'>Remove an Excel table in a workbook</h2><span id='topic+removeTable'></span>

<h3>Description</h3>

<p>List Excel tables in a workbook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeTable(wb, sheet, table)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeTable_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="removeTable_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="removeTable_+3A_table">table</code></td>
<td>
<p>Name of table to remove. See <code><a href="#topic+getTables">getTables()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector of table names on the specified sheet
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
addWorksheet(wb, sheetName = "Sheet 1")
addWorksheet(wb, sheetName = "Sheet 2")
writeDataTable(wb, sheet = "Sheet 1", x = iris, tableName = "iris")
writeDataTable(wb, sheet = 1, x = mtcars, tableName = "mtcars", startCol = 10)


removeWorksheet(wb, sheet = 1) ## delete worksheet removes table objects

writeDataTable(wb, sheet = 1, x = iris, tableName = "iris")
writeDataTable(wb, sheet = 1, x = mtcars, tableName = "mtcars", startCol = 10)

## removeTable() deletes table object and all data
getTables(wb, sheet = 1)
removeTable(wb = wb, sheet = 1, table = "iris")
writeDataTable(wb, sheet = 1, x = iris, tableName = "iris", startCol = 1)

getTables(wb, sheet = 1)
removeTable(wb = wb, sheet = 1, table = "iris")
writeDataTable(wb, sheet = 1, x = iris, tableName = "iris", startCol = 1)
## Not run: 
saveWorkbook(wb = wb, file = "removeTableExample.xlsx", overwrite = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='removeWorksheet'>Remove a worksheet from a workbook</h2><span id='topic+removeWorksheet'></span>

<h3>Description</h3>

<p>Remove a worksheet from a Workbook object
</p>
<p>Remove a worksheet from a workbook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeWorksheet(wb, sheet)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeWorksheet_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="removeWorksheet_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load a workbook
wb &lt;- loadWorkbook(file = system.file("extdata", "loadExample.xlsx", package = "openxlsx"))

## Remove sheet 2
removeWorksheet(wb, 2)

## save the modified workbook
## Not run: 
saveWorkbook(wb, "removeWorksheetExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='renameWorksheet'>Rename a worksheet</h2><span id='topic+renameWorksheet'></span>

<h3>Description</h3>

<p>Rename a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>renameWorksheet(wb, sheet, newName)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="renameWorksheet_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet</p>
</td></tr>
<tr><td><code id="renameWorksheet_+3A_sheet">sheet</code></td>
<td>
<p>The name or index of the worksheet to rename</p>
</td></tr>
<tr><td><code id="renameWorksheet_+3A_newname">newName</code></td>
<td>
<p>The new name of the worksheet. No longer than 31 chars.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DEPRECATED. Use <code><a href="#topic+names">names()</a></code>
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Create a new workbook
wb &lt;- createWorkbook("CREATOR")

## Add 3 worksheets
addWorksheet(wb, "Worksheet Name")
addWorksheet(wb, "This is worksheet 2")
addWorksheet(wb, "Not the best name")

#' ## rename all worksheets
names(wb) &lt;- c("A", "B", "C")


## Rename worksheet 1 &amp; 3
renameWorksheet(wb, 1, "New name for sheet 1")
names(wb)[[1]] &lt;- "New name for sheet 1"
names(wb)[[3]] &lt;- "A better name"

## Save workbook
## Not run: 
saveWorkbook(wb, "renameWorksheetExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='replaceStyle'>Replace an existing cell style</h2><span id='topic+replaceStyle'></span>

<h3>Description</h3>

<p>Replace an existing cell style
</p>
<p>Replace a style object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replaceStyle(wb, index, newStyle)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="replaceStyle_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="replaceStyle_+3A_index">index</code></td>
<td>
<p>Index of style object to replace</p>
</td></tr>
<tr><td><code id="replaceStyle_+3A_newstyle">newStyle</code></td>
<td>
<p>A style to replace the existing style as position index</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getStyles">getStyles()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load a workbook
wb &lt;- loadWorkbook(file = system.file("extdata", "loadExample.xlsx", package = "openxlsx"))

## create a new style and replace style 2

newStyle &lt;- createStyle(fgFill = "#00FF00")

## replace style 2
getStyles(wb)[1:3] ## prints styles
replaceStyle(wb, 2, newStyle = newStyle)

## Save workbook
## Not run: 
saveWorkbook(wb, "replaceStyleExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='saveWorkbook'>save Workbook to file</h2><span id='topic+saveWorkbook'></span>

<h3>Description</h3>

<p>save a Workbook object to file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveWorkbook(wb, file, overwrite = FALSE, returnValue = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveWorkbook_+3A_wb">wb</code></td>
<td>
<p>A Workbook object to write to file</p>
</td></tr>
<tr><td><code id="saveWorkbook_+3A_file">file</code></td>
<td>
<p>A character string naming an xlsx file</p>
</td></tr>
<tr><td><code id="saveWorkbook_+3A_overwrite">overwrite</code></td>
<td>
<p>If <code>TRUE</code>, overwrite any existing file.</p>
</td></tr>
<tr><td><code id="saveWorkbook_+3A_returnvalue">returnValue</code></td>
<td>
<p>If <code>TRUE</code>, returns  <code>TRUE</code> in case of a success, else <code>FALSE</code>.
If flag is <code>FALSE</code>, then no return value is returned.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker, Philipp Schauberger
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createWorkbook">createWorkbook()</a></code>
</p>
<p><code><a href="#topic+addWorksheet">addWorksheet()</a></code>
</p>
<p><code><a href="#topic+loadWorkbook">loadWorkbook()</a></code>
</p>
<p><code><a href="#topic+writeData">writeData()</a></code>
</p>
<p><code><a href="#topic+writeDataTable">writeDataTable()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook and add a worksheet
wb &lt;- createWorkbook("Creator of workbook")
addWorksheet(wb, sheetName = "My first worksheet")

## Save workbook to working directory
## Not run: 
saveWorkbook(wb, file = "saveWorkbookExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='setColWidths'>Set worksheet column widths</h2><span id='topic+setColWidths'></span>

<h3>Description</h3>

<p>Set worksheet column widths to specific width or &quot;auto&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setColWidths(
  wb,
  sheet,
  cols,
  widths = 8.43,
  hidden = rep(FALSE, length(cols)),
  ignoreMergedCells = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setColWidths_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="setColWidths_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="setColWidths_+3A_cols">cols</code></td>
<td>
<p>Indices of cols to set width</p>
</td></tr>
<tr><td><code id="setColWidths_+3A_widths">widths</code></td>
<td>
<p>widths to set cols to specified in Excel column width units or &quot;auto&quot; for automatic sizing. The widths argument is
recycled to the length of cols.</p>
</td></tr>
<tr><td><code id="setColWidths_+3A_hidden">hidden</code></td>
<td>
<p>Logical vector. If TRUE the column is hidden.</p>
</td></tr>
<tr><td><code id="setColWidths_+3A_ignoremergedcells">ignoreMergedCells</code></td>
<td>
<p>Ignore any cells that have been merged with other cells in the calculation of &quot;auto&quot; column widths.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The global min and max column width for &quot;auto&quot; columns is set by (default values show):
</p>

<ul>
<li><p>options(&quot;openxlsx.minWidth&quot; = 3)
</p>
</li>
<li><p>options(&quot;openxlsx.maxWidth&quot; = 250) ## This is the maximum width allowed in Excel
</p>
</li></ul>

<p>NOTE: The calculation of column widths can be slow for large worksheets.
</p>
<p>NOTE: The <code>hidden</code> parameter may conflict with the one set in <code>groupColumns</code>; changing one will update the other.
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+removeColWidths">removeColWidths()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- createWorkbook()

## Add a worksheet
addWorksheet(wb, "Sheet 1")


## set col widths
setColWidths(wb, 1, cols = c(1, 4, 6, 7, 9), widths = c(16, 15, 12, 18, 33))

## auto columns
addWorksheet(wb, "Sheet 2")
writeData(wb, sheet = 2, x = iris)
setColWidths(wb, sheet = 2, cols = 1:5, widths = "auto")

## Save workbook
## Not run: 
saveWorkbook(wb, "setColWidthsExample.xlsx", overwrite = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='setFooter'>Set footer for all worksheets</h2><span id='topic+setFooter'></span>

<h3>Description</h3>

<p>DEPRECATED
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setFooter(wb, text, position = "center")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setFooter_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="setFooter_+3A_text">text</code></td>
<td>
<p>footer text. A character vector of length 1.</p>
</td></tr>
<tr><td><code id="setFooter_+3A_position">position</code></td>
<td>
<p>Position of text in footer. One of &quot;left&quot;, &quot;center&quot; or &quot;right&quot;</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
wb &lt;- createWorkbook("Edgar Anderson")
addWorksheet(wb, "S1")
writeDataTable(wb, "S1", x = iris[1:30, ], xy = c("C", 5))

## set all headers
setHeader(wb, "This is a header", position = "center")
setHeader(wb, "To the left", position = "left")
setHeader(wb, "On the right", position = "right")

## set all footers
setFooter(wb, "Center Footer Here", position = "center")
setFooter(wb, "Bottom left", position = "left")
setFooter(wb, Sys.Date(), position = "right")

saveWorkbook(wb, "headerFooterExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='setHeader'>Set header for all worksheets</h2><span id='topic+setHeader'></span>

<h3>Description</h3>

<p>DEPRECATED
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setHeader(wb, text, position = "center")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setHeader_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="setHeader_+3A_text">text</code></td>
<td>
<p>header text. A character vector of length 1.</p>
</td></tr>
<tr><td><code id="setHeader_+3A_position">position</code></td>
<td>
<p>Position of text in header. One of &quot;left&quot;, &quot;center&quot; or &quot;right&quot;</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
wb &lt;- createWorkbook("Edgar Anderson")
addWorksheet(wb, "S1")
writeDataTable(wb, "S1", x = iris[1:30, ], xy = c("C", 5))

## set all headers
setHeader(wb, "This is a header", position = "center")
setHeader(wb, "To the left", position = "left")
setHeader(wb, "On the right", position = "right")

## set all footers
setFooter(wb, "Center Footer Here", position = "center")
setFooter(wb, "Bottom left", position = "left")
setFooter(wb, Sys.Date(), position = "right")

saveWorkbook(wb, "headerHeaderExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='setHeaderFooter'>Set document headers and footers</h2><span id='topic+setHeaderFooter'></span>

<h3>Description</h3>

<p>Set document headers and footers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setHeaderFooter(
  wb,
  sheet,
  header = NULL,
  footer = NULL,
  evenHeader = NULL,
  evenFooter = NULL,
  firstHeader = NULL,
  firstFooter = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setHeaderFooter_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="setHeaderFooter_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="setHeaderFooter_+3A_header">header</code></td>
<td>
<p>document header. Character vector of length 3 corresponding to positions left, center, right. Use NA to skip a position.</p>
</td></tr>
<tr><td><code id="setHeaderFooter_+3A_footer">footer</code></td>
<td>
<p>document footer. Character vector of length 3 corresponding to positions left, center, right. Use NA to skip a position.</p>
</td></tr>
<tr><td><code id="setHeaderFooter_+3A_evenheader">evenHeader</code></td>
<td>
<p>document header for even pages.</p>
</td></tr>
<tr><td><code id="setHeaderFooter_+3A_evenfooter">evenFooter</code></td>
<td>
<p>document footer for even pages.</p>
</td></tr>
<tr><td><code id="setHeaderFooter_+3A_firstheader">firstHeader</code></td>
<td>
<p>document header for first page only.</p>
</td></tr>
<tr><td><code id="setHeaderFooter_+3A_firstfooter">firstFooter</code></td>
<td>
<p>document footer for first page only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Headers and footers can contain special tags
</p>

<dl>
<dt><strong>&amp;[Page]</strong></dt><dd><p> Page number</p>
</dd>
<dt><strong>&amp;[Pages]</strong></dt><dd><p> Number of pages</p>
</dd>
<dt><strong>&amp;[Date]</strong></dt><dd><p> Current date</p>
</dd>
<dt><strong>&amp;[Time]</strong></dt><dd><p> Current time</p>
</dd>
<dt><strong>&amp;[Path]</strong></dt><dd><p> File path</p>
</dd>
<dt><strong>&amp;[File]</strong></dt><dd><p> File name</p>
</dd>
<dt><strong>&amp;[Tab]</strong></dt><dd><p> Worksheet name</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addWorksheet">addWorksheet()</a></code> to set headers and footers when adding a worksheet
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()

addWorksheet(wb, "S1")
addWorksheet(wb, "S2")
addWorksheet(wb, "S3")
addWorksheet(wb, "S4")

writeData(wb, 1, 1:400)
writeData(wb, 2, 1:400)
writeData(wb, 3, 3:400)
writeData(wb, 4, 3:400)

setHeaderFooter(wb,
  sheet = "S1",
  header = c("ODD HEAD LEFT", "ODD HEAD CENTER", "ODD HEAD RIGHT"),
  footer = c("ODD FOOT RIGHT", "ODD FOOT CENTER", "ODD FOOT RIGHT"),
  evenHeader = c("EVEN HEAD LEFT", "EVEN HEAD CENTER", "EVEN HEAD RIGHT"),
  evenFooter = c("EVEN FOOT RIGHT", "EVEN FOOT CENTER", "EVEN FOOT RIGHT"),
  firstHeader = c("TOP", "OF FIRST", "PAGE"),
  firstFooter = c("BOTTOM", "OF FIRST", "PAGE")
)

setHeaderFooter(wb,
  sheet = 2,
  header = c("&amp;[Date]", "ALL HEAD CENTER 2", "&amp;[Page] / &amp;[Pages]"),
  footer = c("&amp;[Path]&amp;[File]", NA, "&amp;[Tab]"),
  firstHeader = c(NA, "Center Header of First Page", NA),
  firstFooter = c(NA, "Center Footer of First Page", NA)
)

setHeaderFooter(wb,
  sheet = 3,
  header = c("ALL HEAD LEFT 2", "ALL HEAD CENTER 2", "ALL HEAD RIGHT 2"),
  footer = c("ALL FOOT RIGHT 2", "ALL FOOT CENTER 2", "ALL FOOT RIGHT 2")
)

setHeaderFooter(wb,
  sheet = 4,
  firstHeader = c("FIRST ONLY L", NA, "FIRST ONLY R"),
  firstFooter = c("FIRST ONLY L", NA, "FIRST ONLY R")
)
## Not run: 
saveWorkbook(wb, "setHeaderFooterExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='setLastModifiedBy'>Set the author who modified the file last.</h2><span id='topic+setLastModifiedBy'></span>

<h3>Description</h3>

<p>Just a wrapper of wb$changeLastModifiedBy()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setLastModifiedBy(wb, LastModifiedBy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setLastModifiedBy_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="setLastModifiedBy_+3A_lastmodifiedby">LastModifiedBy</code></td>
<td>
<p>A string object with the name of the LastModifiedBy-User</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Philipp Schauberger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
setLastModifiedBy(wb, "test")
</code></pre>

<hr>
<h2 id='setRowHeights'>Set worksheet row heights</h2><span id='topic+setRowHeights'></span>

<h3>Description</h3>

<p>Set worksheet row heights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setRowHeights(
  wb,
  sheet,
  rows,
  heights,
  fontsize = NULL,
  factor = 1,
  base_height = 15,
  extra_height = 12,
  wrap = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setRowHeights_+3A_wb">wb</code></td>
<td>
<p>workbook object</p>
</td></tr>
<tr><td><code id="setRowHeights_+3A_sheet">sheet</code></td>
<td>
<p>name or index of a worksheet</p>
</td></tr>
<tr><td><code id="setRowHeights_+3A_rows">rows</code></td>
<td>
<p>indices of rows to set height</p>
</td></tr>
<tr><td><code id="setRowHeights_+3A_heights">heights</code></td>
<td>
<p>heights to set rows to specified in Excel column height units</p>
</td></tr>
<tr><td><code id="setRowHeights_+3A_fontsize">fontsize</code></td>
<td>
<p>font size, optional (get base font size by default)</p>
</td></tr>
<tr><td><code id="setRowHeights_+3A_factor">factor</code></td>
<td>
<p>factor to manually adjust font width, e.g., for bold fonts,
optional</p>
</td></tr>
<tr><td><code id="setRowHeights_+3A_base_height">base_height</code></td>
<td>
<p>basic row height, optional</p>
</td></tr>
<tr><td><code id="setRowHeights_+3A_extra_height">extra_height</code></td>
<td>
<p>additional row height per new line of text, optional</p>
</td></tr>
<tr><td><code id="setRowHeights_+3A_wrap">wrap</code></td>
<td>
<p>wrap text of entries which exceed the column width, optional</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+removeRowHeights">removeRowHeights()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create a new workbook
wb &lt;- createWorkbook()

## Add a worksheet
addWorksheet(wb, "Sheet")
sheet &lt;- 1

## Write dummy data
writeData(wb, sheet, "fixed w/fixed h", startCol = 1, startRow = 1)
writeData(wb, sheet, "fixed w/auto h ABC ABC ABC ABC ABC ABC ABC ABC ABC ABC ABC",
 startCol = 2, startRow = 2)
writeData(wb, sheet, "variable w/fixed h", startCol = 3, startRow = 3)

## Set column widths and row heights
setColWidths(wb, sheet, cols = c(1, 2, 3, 4), widths = c(10, 20, "auto", 20))
setRowHeights(wb, sheet, rows = c(1, 2, 8, 4, 6), heights = c(30, "auto", 15, 15, 30))

## Overwrite row 1 height
setRowHeights(wb, sheet, rows = 1, heights = 40)

## Save workbook
## Not run: 
saveWorkbook(wb, "setRowHeightsExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='setWindowSize'>Set and Get Window Size for xlsx file</h2><span id='topic+setWindowSize'></span><span id='topic+getWindowSize'></span>

<h3>Description</h3>

<p>Set and Get Window Size for xlsx file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setWindowSize(
  wb,
  xWindow = NULL,
  yWindow = NULL,
  windowWidth = NULL,
  windowHeight = NULL
)

getWindowSize(wb)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setWindowSize_+3A_wb">wb</code></td>
<td>
<p>A Workbook object</p>
</td></tr>
<tr><td><code id="setWindowSize_+3A_xwindow">xWindow</code></td>
<td>
<p>the horizontal coordinate of the top left corner of the window</p>
</td></tr>
<tr><td><code id="setWindowSize_+3A_ywindow">yWindow</code></td>
<td>
<p>the vertical coordinate of the top left corner of the window</p>
</td></tr>
<tr><td><code id="setWindowSize_+3A_windowwidth">windowWidth</code></td>
<td>
<p>the width of the window</p>
</td></tr>
<tr><td><code id="setWindowSize_+3A_windowheight">windowHeight</code></td>
<td>
<p>the height of the window
</p>
<p>Set the size and position of the window when you open the xlsx file.  The units are in twips.  See
<a href="https://learn.microsoft.com/en-us/dotnet/api/documentformat.openxml.spreadsheet.workbookview?view=openxml-2.8.1">Microsoft's documentation for the xlsx standard</a></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Create Workbook object and add worksheets
wb &lt;- createWorkbook()
addWorksheet(wb, "S1")
getWindowSize(wb)
setWindowSize(wb, windowWidth = 10000)
</code></pre>

<hr>
<h2 id='sheets'>Returns names of worksheets.</h2><span id='topic+sheets'></span>

<h3>Description</h3>

<p>DEPRECATED. Use names().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sheets(wb)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sheets_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DEPRECATED. Use <code><a href="#topic+names">names()</a></code>
</p>


<h3>Value</h3>

<p>Name of worksheet(s) for a given index
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+names">names()</a></code> to rename a worksheet in a Workbook
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Create a new workbook
wb &lt;- createWorkbook()

## Add some worksheets
addWorksheet(wb, "Worksheet Name")
addWorksheet(wb, "This is worksheet 2")
addWorksheet(wb, "The third worksheet")

## Return names of sheets, can not be used for assignment.
names(wb)
# openXL(wb)

names(wb) &lt;- c("A", "B", "C")
names(wb)
# openXL(wb)
</code></pre>

<hr>
<h2 id='sheetVisibility'>Get/set worksheet visible state</h2><span id='topic+sheetVisibility'></span><span id='topic+sheetVisibility+3C-'></span>

<h3>Description</h3>

<p>Get and set worksheet visible state
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sheetVisibility(wb)

sheetVisibility(wb) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sheetVisibility_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="sheetVisibility_+3A_value">value</code></td>
<td>
<p>a logical/character vector the same length as sheetVisibility(wb)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of worksheet names.
</p>
<p>Vector of &quot;hidden&quot;, &quot;visible&quot;, &quot;veryHidden&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
addWorksheet(wb, sheetName = "S1", visible = FALSE)
addWorksheet(wb, sheetName = "S2", visible = TRUE)
addWorksheet(wb, sheetName = "S3", visible = FALSE)

sheetVisibility(wb)
sheetVisibility(wb)[1] &lt;- TRUE ## show sheet 1
sheetVisibility(wb)[2] &lt;- FALSE ## hide sheet 2
sheetVisibility(wb)[3] &lt;- "hidden" ## hide sheet 3
sheetVisibility(wb)[3] &lt;- "veryHidden" ## hide sheet 3 from UI
</code></pre>

<hr>
<h2 id='sheetVisible'>Get worksheet visible state.</h2><span id='topic+sheetVisible'></span><span id='topic+sheetVisible+3C-'></span>

<h3>Description</h3>

<p>DEPRECATED - Use function 'sheetVisibility()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sheetVisible(wb)

sheetVisible(wb) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sheetVisible_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="sheetVisible_+3A_value">value</code></td>
<td>
<p>a logical vector the same length as sheetVisible(wb)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of worksheet names.
</p>
<p>TRUE if sheet is visible, FALSE if sheet is hidden
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
wb &lt;- createWorkbook()
addWorksheet(wb, sheetName = "S1", visible = FALSE)
addWorksheet(wb, sheetName = "S2", visible = TRUE)
addWorksheet(wb, sheetName = "S3", visible = FALSE)

sheetVisible(wb)
sheetVisible(wb)[1] &lt;- TRUE ## show sheet 1
sheetVisible(wb)[2] &lt;- FALSE ## hide sheet 2
</code></pre>

<hr>
<h2 id='showGridLines'>Set worksheet gridlines to show or hide.</h2><span id='topic+showGridLines'></span>

<h3>Description</h3>

<p>Set worksheet gridlines to show or hide.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showGridLines(wb, sheet, showGridLines = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="showGridLines_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="showGridLines_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="showGridLines_+3A_showgridlines">showGridLines</code></td>
<td>
<p>A logical. If <code>FALSE</code>, grid lines are hidden.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- loadWorkbook(file = system.file("extdata", "loadExample.xlsx", package = "openxlsx"))
names(wb) ## list worksheets in workbook
showGridLines(wb, 1, showGridLines = FALSE)
showGridLines(wb, "testing", showGridLines = FALSE)
## Not run: 
saveWorkbook(wb, "showGridLinesExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='temp_xlsx'>helper function to create tempory directory for testing purpose</h2><span id='topic+temp_xlsx'></span>

<h3>Description</h3>

<p>helper function to create tempory directory for testing purpose
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temp_xlsx(name = "temp_xlsx")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="temp_xlsx_+3A_name">name</code></td>
<td>
<p>for the temp file</p>
</td></tr>
</table>

<hr>
<h2 id='ungroupColumns'>Ungroup Columns</h2><span id='topic+ungroupColumns'></span>

<h3>Description</h3>

<p>Ungroup a selection of columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ungroupColumns(wb, sheet, cols)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ungroupColumns_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="ungroupColumns_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="ungroupColumns_+3A_cols">cols</code></td>
<td>
<p>Indices of columns to ungroup</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If column was previously hidden, it will now be shown
</p>


<h3>Author(s)</h3>

<p>Joshua Sturm
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ungroupRows">ungroupRows()</a></code> To ungroup rows
</p>

<hr>
<h2 id='ungroupRows'>Ungroup Rows</h2><span id='topic+ungroupRows'></span>

<h3>Description</h3>

<p>Ungroup a selection of rows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ungroupRows(wb, sheet, rows)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ungroupRows_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="ungroupRows_+3A_sheet">sheet</code></td>
<td>
<p>A name or index of a worksheet</p>
</td></tr>
<tr><td><code id="ungroupRows_+3A_rows">rows</code></td>
<td>
<p>Indices of rows to ungroup</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If row was previously hidden, it will now be shown
</p>


<h3>Author(s)</h3>

<p>Joshua Sturm
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ungroupColumns">ungroupColumns()</a></code>
</p>

<hr>
<h2 id='worksheetOrder'>Order of worksheets in xlsx file</h2><span id='topic+worksheetOrder'></span><span id='topic+worksheetOrder+3C-'></span>

<h3>Description</h3>

<p>Get/set order of worksheets in a Workbook object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worksheetOrder(wb)

worksheetOrder(wb) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="worksheetOrder_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="worksheetOrder_+3A_value">value</code></td>
<td>
<p>Vector specifying order to write worksheets to file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function does not reorder the worksheets within the workbook object, it simply
shuffles the order when writing to file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## setup a workbook with 3 worksheets
wb &lt;- createWorkbook()
addWorksheet(wb = wb, sheetName = "Sheet 1", gridLines = FALSE)
writeDataTable(wb = wb, sheet = 1, x = iris)

addWorksheet(wb = wb, sheetName = "mtcars (Sheet 2)", gridLines = FALSE)
writeData(wb = wb, sheet = 2, x = mtcars)

addWorksheet(wb = wb, sheetName = "Sheet 3", gridLines = FALSE)
writeData(wb = wb, sheet = 3, x = Formaldehyde)

worksheetOrder(wb)
names(wb)
worksheetOrder(wb) &lt;- c(1, 3, 2) # switch position of sheets 2 &amp; 3
writeData(wb, 2, 'This is still the "mtcars" worksheet', startCol = 15)
worksheetOrder(wb)
names(wb) ## ordering within workbook is not changed
## Not run: 
saveWorkbook(wb, "worksheetOrderExample.xlsx", overwrite = TRUE)

## End(Not run)
worksheetOrder(wb) &lt;- c(3, 2, 1)
## Not run: 
saveWorkbook(wb, "worksheetOrderExample2.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='write.xlsx'>write data to an xlsx file</h2><span id='topic+write.xlsx'></span>

<h3>Description</h3>

<p>write a data.frame or list of data.frames to an xlsx file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.xlsx(x, file, asTable = FALSE, overwrite = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.xlsx_+3A_x">x</code></td>
<td>
<p>A data.frame or a (named) list of objects that can be handled by
<code><a href="#topic+writeData">writeData()</a></code> or <code><a href="#topic+writeDataTable">writeDataTable()</a></code> to write to file</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_file">file</code></td>
<td>
<p>A file path to save the xlsx file</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_astable">asTable</code></td>
<td>
<p>If <code>TRUE</code> will use <code><a href="#topic+writeDataTable">writeDataTable()</a></code> rather
than <code><a href="#topic+writeData">writeData()</a></code> to write <code>x</code> to the file (default:
<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_overwrite">overwrite</code></td>
<td>
<p>Overwrite existing file (Defaults to <code>TRUE</code> as with <code>write.table</code>)</p>
</td></tr>
<tr><td><code id="write.xlsx_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+buildWorkbook">buildWorkbook()</a></code>; see details</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A workbook object
</p>


<h3>Optional Parameters</h3>

<p><strong>createWorkbook Parameters</strong>
</p>

<dl>
<dt><strong>creator</strong></dt><dd><p> A string specifying the workbook author</p>
</dd>
</dl>

<p><strong>addWorksheet Parameters</strong>
</p>

<dl>
<dt><strong>sheetName</strong></dt><dd><p> Name of the worksheet</p>
</dd>
<dt><strong>gridLines</strong></dt><dd><p> A logical. If <code>FALSE</code>, the worksheet grid lines will be hidden.</p>
</dd>
<dt><strong>tabColour</strong></dt><dd><p> Colour of the worksheet tab. A valid colour (belonging to colours())
or a valid hex colour beginning with &quot;#&quot;.</p>
</dd>
<dt><strong>zoom</strong></dt><dd><p> A numeric between 10 and 400. Worksheet zoom level as a percentage.</p>
</dd>
</dl>

<p><strong>writeData/writeDataTable Parameters</strong>
</p>

<dl>
<dt><strong>startCol</strong></dt><dd><p> A vector specifying the starting column(s) to write df</p>
</dd>
<dt><strong>startRow</strong></dt><dd><p> A vector specifying the starting row(s) to write df</p>
</dd>
<dt><strong>xy</strong></dt><dd><p> An alternative to specifying startCol and startRow individually.
A vector of the form c(startCol, startRow)</p>
</dd>
<dt><strong>colNames or col.names</strong></dt><dd><p> If <code>TRUE</code>, column names of x are written.</p>
</dd>
<dt><strong>rowNames or row.names</strong></dt><dd><p> If <code>TRUE</code>, row names of x are written.</p>
</dd>
<dt><strong>headerStyle</strong></dt><dd><p> Custom style to apply to column names.</p>
</dd>
<dt><strong>borders</strong></dt><dd><p> Either &quot;surrounding&quot;, &quot;columns&quot; or &quot;rows&quot; or NULL.  If &quot;surrounding&quot;, a border is drawn around the
data.  If &quot;rows&quot;, a surrounding border is drawn a border around each row. If &quot;columns&quot;, a surrounding border is drawn with a border
between each column.  If &quot;<code>all</code>&quot; all cell borders are drawn.</p>
</dd>
<dt><strong>borderColour</strong></dt><dd><p> Colour of cell border</p>
</dd>
<dt><strong>borderStyle</strong></dt><dd><p> Border line style.</p>
</dd>
<dt><strong>keepNA</strong></dt><dd><p>If <code>TRUE</code>, NA values are converted to #N/A (or <code>na.string</code>, if not NULL) in Excel, else NA cells will be empty. Defaults to FALSE.</p>
</dd>
<dt><strong>na.string</strong></dt><dd><p>If not NULL, and if <code>keepNA</code> is <code>TRUE</code>, NA values are converted to this string in Excel. Defaults to NULL.</p>
</dd>
</dl>

<p><strong>freezePane Parameters</strong>
</p>

<dl>
<dt><strong>firstActiveRow</strong></dt><dd><p>Top row of active region to freeze pane.</p>
</dd>
<dt><strong>firstActiveCol</strong></dt><dd><p>Furthest left column of active region to freeze pane.</p>
</dd>
<dt><strong>firstRow</strong></dt><dd><p>If <code>TRUE</code>, freezes the first row (equivalent to firstActiveRow = 2)</p>
</dd>
<dt><strong>firstCol</strong></dt><dd><p>If <code>TRUE</code>, freezes the first column (equivalent to firstActiveCol = 2)</p>
</dd>
</dl>

<p><strong>colWidths Parameters</strong>
</p>

<dl>
<dt><strong>colWidths</strong></dt><dd><p>May be a single value for all columns (or &quot;auto&quot;), or a list of vectors that will be recycled for each sheet (see examples)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Alexander Walker, Jordan Mark Barbone
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addWorksheet">addWorksheet()</a></code>
</p>
<p><code><a href="#topic+writeData">writeData()</a></code>
</p>
<p><code><a href="#topic+createStyle">createStyle()</a></code> for style parameters
</p>
<p><code><a href="#topic+buildWorkbook">buildWorkbook()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## write to working directory
options("openxlsx.borderColour" = "#4F80BD") ## set default border colour
## Not run: 
write.xlsx(iris, file = "writeXLSX1.xlsx", colNames = TRUE, borders = "columns")
write.xlsx(iris, file = "writeXLSX2.xlsx", colNames = TRUE, borders = "surrounding")

## End(Not run)


hs &lt;- createStyle(
  textDecoration = "BOLD", fontColour = "#FFFFFF", fontSize = 12,
  fontName = "Arial Narrow", fgFill = "#4F80BD"
)
## Not run: 
write.xlsx(iris,
  file = "writeXLSX3.xlsx",
  colNames = TRUE, borders = "rows", headerStyle = hs
)

## End(Not run)

## Lists elements are written to individual worksheets, using list names as sheet names if available
l &lt;- list("IRIS" = iris, "MTCATS" = mtcars, matrix(runif(1000), ncol = 5))
## Not run: 
write.xlsx(l, "writeList1.xlsx", colWidths = c(NA, "auto", "auto"))

## End(Not run)

## different sheets can be given different parameters
## Not run: 
write.xlsx(l, "writeList2.xlsx",
  startCol = c(1, 2, 3), startRow = 2,
  asTable = c(TRUE, TRUE, FALSE), withFilter = c(TRUE, FALSE, FALSE)
)

## End(Not run)

# specify column widths for multiple sheets
## Not run: 
write.xlsx(l, "writeList2.xlsx", colWidths = 20)
write.xlsx(l, "writeList2.xlsx", colWidths = list(100, 200, 300))
write.xlsx(l, "writeList2.xlsx", colWidths = list(rep(10, 5), rep(8, 11), rep(5, 5)))

## End(Not run)

</code></pre>

<hr>
<h2 id='writeComment'>write a cell comment</h2><span id='topic+writeComment'></span>

<h3>Description</h3>

<p>Write a Comment object to a worksheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeComment(wb, sheet, col, row, comment, xy = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeComment_+3A_wb">wb</code></td>
<td>
<p>A workbook object</p>
</td></tr>
<tr><td><code id="writeComment_+3A_sheet">sheet</code></td>
<td>
<p>A vector of names or indices of worksheets</p>
</td></tr>
<tr><td><code id="writeComment_+3A_col">col</code></td>
<td>
<p>Column a column number of letter</p>
</td></tr>
<tr><td><code id="writeComment_+3A_row">row</code></td>
<td>
<p>A row number.</p>
</td></tr>
<tr><td><code id="writeComment_+3A_comment">comment</code></td>
<td>
<p>A Comment object. See <code><a href="#topic+createComment">createComment()</a></code>.</p>
</td></tr>
<tr><td><code id="writeComment_+3A_xy">xy</code></td>
<td>
<p>An alternative to specifying <code>col</code> and
<code>row</code> individually.  A vector of the form
<code>c(col, row)</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+createComment">createComment()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")

c1 &lt;- createComment(comment = "this is comment")
writeComment(wb, 1, col = "B", row = 10, comment = c1)

s1 &lt;- createStyle(fontSize = 12, fontColour = "red", textDecoration = c("BOLD"))
s2 &lt;- createStyle(fontSize = 9, fontColour = "black")

c2 &lt;- createComment(comment = c("This Part Bold red\n\n", "This part black"), style = c(s1, s2))
c2

writeComment(wb, 1, col = 6, row = 3, comment = c2)
## Not run: 
saveWorkbook(wb, file = "writeCommentExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='writeData'>Write an object to a worksheet</h2><span id='topic+writeData'></span>

<h3>Description</h3>

<p>Write an object to worksheet with optional styling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeData(
  wb,
  sheet,
  x,
  startCol = 1,
  startRow = 1,
  array = FALSE,
  xy = NULL,
  colNames = TRUE,
  rowNames = FALSE,
  headerStyle = openxlsx_getOp("headerStyle"),
  borders = openxlsx_getOp("borders", "none"),
  borderColour = openxlsx_getOp("borderColour", "black"),
  borderStyle = openxlsx_getOp("borderStyle", "thin"),
  withFilter = openxlsx_getOp("withFilter", FALSE),
  keepNA = openxlsx_getOp("keepNA", FALSE),
  na.string = openxlsx_getOp("na.string"),
  name = NULL,
  sep = ", ",
  col.names,
  row.names
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeData_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet.</p>
</td></tr>
<tr><td><code id="writeData_+3A_sheet">sheet</code></td>
<td>
<p>The worksheet to write to. Can be the worksheet index or name.</p>
</td></tr>
<tr><td><code id="writeData_+3A_x">x</code></td>
<td>
<p>Object to be written. For classes supported look at the examples.</p>
</td></tr>
<tr><td><code id="writeData_+3A_startcol">startCol</code></td>
<td>
<p>A vector specifying the starting column to write to.</p>
</td></tr>
<tr><td><code id="writeData_+3A_startrow">startRow</code></td>
<td>
<p>A vector specifying the starting row to write to.</p>
</td></tr>
<tr><td><code id="writeData_+3A_array">array</code></td>
<td>
<p>A bool if the function written is of type array</p>
</td></tr>
<tr><td><code id="writeData_+3A_xy">xy</code></td>
<td>
<p>An alternative to specifying <code>startCol</code> and
<code>startRow</code> individually.  A vector of the form
<code>c(startCol, startRow)</code>.</p>
</td></tr>
<tr><td><code id="writeData_+3A_colnames">colNames</code></td>
<td>
<p>If <code>TRUE</code>, column names of x are written.</p>
</td></tr>
<tr><td><code id="writeData_+3A_rownames">rowNames</code></td>
<td>
<p>If <code>TRUE</code>, data.frame row names of x are written.</p>
</td></tr>
<tr><td><code id="writeData_+3A_headerstyle">headerStyle</code></td>
<td>
<p>Custom style to apply to column names.</p>
</td></tr>
<tr><td><code id="writeData_+3A_borders">borders</code></td>
<td>
<p>Either &quot;<code>none</code>&quot; (default), &quot;<code>surrounding</code>&quot;,
&quot;<code>columns</code>&quot;, &quot;<code>rows</code>&quot; or <em>respective abbreviations</em>.  If
&quot;<code>surrounding</code>&quot;, a border is drawn around the data.  If &quot;<code>rows</code>&quot;,
a surrounding border is drawn with a border around each row. If
&quot;<code>columns</code>&quot;, a surrounding border is drawn with a border between
each column. If &quot;<code>all</code>&quot; all cell borders are drawn.</p>
</td></tr>
<tr><td><code id="writeData_+3A_bordercolour">borderColour</code></td>
<td>
<p>Colour of cell border.  A valid colour (belonging to <code>colours()</code> or a hex colour code, eg see <a href="https://www.w3schools.com/colors/colors_picker.asp">here</a>).</p>
</td></tr>
<tr><td><code id="writeData_+3A_borderstyle">borderStyle</code></td>
<td>
<p>Border line style
</p>

<dl>
<dt><strong>none</strong></dt><dd><p> no border</p>
</dd>
<dt><strong>thin</strong></dt><dd><p> thin border</p>
</dd>
<dt><strong>medium</strong></dt><dd><p> medium border</p>
</dd>
<dt><strong>dashed</strong></dt><dd><p> dashed border</p>
</dd>
<dt><strong>dotted</strong></dt><dd><p> dotted border</p>
</dd>
<dt><strong>thick</strong></dt><dd><p> thick border</p>
</dd>
<dt><strong>double</strong></dt><dd><p> double line border</p>
</dd>
<dt><strong>hair</strong></dt><dd><p> hairline border</p>
</dd>
<dt><strong>mediumDashed</strong></dt><dd><p> medium weight dashed border</p>
</dd>
<dt><strong>dashDot</strong></dt><dd><p> dash-dot border</p>
</dd>
<dt><strong>mediumDashDot</strong></dt><dd><p> medium weight dash-dot border</p>
</dd>
<dt><strong>dashDotDot</strong></dt><dd><p> dash-dot-dot border</p>
</dd>
<dt><strong>mediumDashDotDot</strong></dt><dd><p> medium weight dash-dot-dot border</p>
</dd>
<dt><strong>slantDashDot</strong></dt><dd><p> slanted dash-dot border</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="writeData_+3A_withfilter">withFilter</code></td>
<td>
<p>If <code>TRUE</code> or <code>NA</code>, add filters to the column name row. NOTE can only have one filter per worksheet.</p>
</td></tr>
<tr><td><code id="writeData_+3A_keepna">keepNA</code></td>
<td>
<p>If <code>TRUE</code>, NA values are converted to #N/A (or <code>na.string</code>, if not NULL) in Excel, else NA cells will be empty.</p>
</td></tr>
<tr><td><code id="writeData_+3A_na.string">na.string</code></td>
<td>
<p>If not NULL, and if <code>keepNA</code> is <code>TRUE</code>, NA values are converted to this string in Excel.</p>
</td></tr>
<tr><td><code id="writeData_+3A_name">name</code></td>
<td>
<p>If not NULL, a named region is defined.</p>
</td></tr>
<tr><td><code id="writeData_+3A_sep">sep</code></td>
<td>
<p>Only applies to list columns. The separator used to collapse list columns to a character vector e.g. sapply(x$list_column, paste, collapse = sep).</p>
</td></tr>
<tr><td><code id="writeData_+3A_row.names">row.names</code>, <code id="writeData_+3A_col.names">col.names</code></td>
<td>
<p>Deprecated, please use <code>rowNames</code>, <code>colNames</code> instead</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Formulae written using writeFormula to a Workbook object will not get picked up by read.xlsx().
This is because only the formula is written and left to Excel to evaluate the formula when the file is opened in Excel.
</p>


<h3>Value</h3>

<p>invisible(0)
</p>


<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+writeDataTable">writeDataTable()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## See formatting vignette for further examples.

## Options for default styling (These are the defaults)
options("openxlsx.borderColour" = "black")
options("openxlsx.borderStyle" = "thin")
options("openxlsx.dateFormat" = "mm/dd/yyyy")
options("openxlsx.datetimeFormat" = "yyyy-mm-dd hh:mm:ss")
options("openxlsx.numFmt" = NULL)

## Change the default border colour to #4F81BD
options("openxlsx.borderColour" = "#4F81BD")


#####################################################################################
## Create Workbook object and add worksheets
wb &lt;- createWorkbook()

## Add worksheets
addWorksheet(wb, "Cars")
addWorksheet(wb, "Formula")


x &lt;- mtcars[1:6, ]
writeData(wb, "Cars", x, startCol = 2, startRow = 3, rowNames = TRUE)

#####################################################################################
## Bordering

writeData(wb, "Cars", x,
  rowNames = TRUE, startCol = "O", startRow = 3,
  borders = "surrounding", borderColour = "black"
) ## black border

writeData(wb, "Cars", x,
  rowNames = TRUE,
  startCol = 2, startRow = 12, borders = "columns"
)

writeData(wb, "Cars", x,
  rowNames = TRUE,
  startCol = "O", startRow = 12, borders = "rows"
)


#####################################################################################
## Header Styles

hs1 &lt;- createStyle(
  fgFill = "#DCE6F1", halign = "CENTER", textDecoration = "italic",
  border = "Bottom"
)

writeData(wb, "Cars", x,
  colNames = TRUE, rowNames = TRUE, startCol = "B",
  startRow = 23, borders = "rows", headerStyle = hs1, borderStyle = "dashed"
)


hs2 &lt;- createStyle(
  fontColour = "#ffffff", fgFill = "#4F80BD",
  halign = "center", valign = "center", textDecoration = "bold",
  border = "TopBottomLeftRight"
)

writeData(wb, "Cars", x,
  colNames = TRUE, rowNames = TRUE,
  startCol = "O", startRow = 23, borders = "columns", headerStyle = hs2
)




#####################################################################################
## Hyperlinks
## - vectors/columns with class 'hyperlink' are written as hyperlinks'

v &lt;- rep("https://CRAN.R-project.org/", 4)
names(v) &lt;- paste0("Hyperlink", 1:4) # Optional: names will be used as display text
class(v) &lt;- "hyperlink"
writeData(wb, "Cars", x = v, xy = c("B", 32))


#####################################################################################
## Formulas
## - vectors/columns with class 'formula' are written as formulas'

df &lt;- data.frame(
  x = 1:3, y = 1:3,
  z = paste0(paste0("A", 1:3 + 1L), paste0("B", 1:3 + 1L), sep = " + "),
  stringsAsFactors = FALSE
)

class(df$z) &lt;- c(class(df$z), "formula")

writeData(wb, sheet = "Formula", x = df)


#####################################################################################
## Save workbook
## Open in excel without saving file: openXL(wb)
## Not run: 
saveWorkbook(wb, "writeDataExample.xlsx", overwrite = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='writeDataTable'>Write to a worksheet as an Excel table</h2><span id='topic+writeDataTable'></span>

<h3>Description</h3>

<p>Write to a worksheet and format as an Excel table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeDataTable(
  wb,
  sheet,
  x,
  startCol = 1,
  startRow = 1,
  xy = NULL,
  colNames = TRUE,
  rowNames = FALSE,
  tableStyle = openxlsx_getOp("tableStyle", "TableStyleLight9"),
  tableName = NULL,
  headerStyle = openxlsx_getOp("headerStyle"),
  withFilter = openxlsx_getOp("withFilter", TRUE),
  keepNA = openxlsx_getOp("keepNA", FALSE),
  na.string = openxlsx_getOp("na.string"),
  sep = ", ",
  stack = FALSE,
  firstColumn = openxlsx_getOp("firstColumn", FALSE),
  lastColumn = openxlsx_getOp("lastColumn", FALSE),
  bandedRows = openxlsx_getOp("bandedRows", TRUE),
  bandedCols = openxlsx_getOp("bandedCols", FALSE),
  col.names,
  row.names
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeDataTable_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a
worksheet.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_sheet">sheet</code></td>
<td>
<p>The worksheet to write to. Can be the worksheet index or name.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_x">x</code></td>
<td>
<p>A dataframe.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_startcol">startCol</code></td>
<td>
<p>A vector specifying the starting column to write df</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_startrow">startRow</code></td>
<td>
<p>A vector specifying the starting row to write df</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_xy">xy</code></td>
<td>
<p>An alternative to specifying startCol and startRow individually.
A vector of the form c(startCol, startRow)</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_colnames">colNames</code></td>
<td>
<p>If <code>TRUE</code>, column names of x are written.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_rownames">rowNames</code></td>
<td>
<p>If <code>TRUE</code>, row names of x are written.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_tablestyle">tableStyle</code></td>
<td>
<p>Any excel table style name or &quot;none&quot; (see &quot;formatting&quot; vignette).</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_tablename">tableName</code></td>
<td>
<p>name of table in workbook. The table name must be unique.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_headerstyle">headerStyle</code></td>
<td>
<p>Custom style to apply to column names.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_withfilter">withFilter</code></td>
<td>
<p>If <code>TRUE</code> or <code>NA</code>, columns with have filters in the first row.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_keepna">keepNA</code></td>
<td>
<p>If <code>TRUE</code>, NA values are converted to #N/A (or <code>na.string</code>, if not NULL) in Excel, else NA cells will be empty.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_na.string">na.string</code></td>
<td>
<p>If not NULL, and if <code>keepNA</code> is <code>TRUE</code>, NA values are converted to this string in Excel.</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_sep">sep</code></td>
<td>
<p>Only applies to list columns. The separator used to collapse list columns to a character vector e.g. sapply(x$list_column, paste, collapse = sep).</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_stack">stack</code></td>
<td>
<p>If <code>TRUE</code> the new style is merged with any existing cell styles.  If FALSE, any
existing style is replaced by the new style.
<br /><br />
<br /><strong>The below options correspond to Excel table options:</strong>
<br />
<img src="../help/figures/tableoptions.png" width="40%" alt="Figure: table\_options.png" />
</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_firstcolumn">firstColumn</code></td>
<td>
<p>logical. If TRUE, the first column is bold</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_lastcolumn">lastColumn</code></td>
<td>
<p>logical. If TRUE, the last column is bold</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_bandedrows">bandedRows</code></td>
<td>
<p>logical. If TRUE, rows are colour banded</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_bandedcols">bandedCols</code></td>
<td>
<p>logical. If TRUE, the columns are colour banded</p>
</td></tr>
<tr><td><code id="writeDataTable_+3A_row.names">row.names</code>, <code id="writeDataTable_+3A_col.names">col.names</code></td>
<td>
<p>Deprecated, please use <code>rowNames</code>, <code>colNames</code> instead</p>
</td></tr>
</table>


<h3>Details</h3>

<p>columns of x with class Date/POSIXt, currency, accounting,
hyperlink, percentage are automatically styled as dates, currency, accounting,
hyperlinks, percentages respectively.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addWorksheet">addWorksheet()</a></code>
</p>
<p><code><a href="#topic+writeData">writeData()</a></code>
</p>
<p><code><a href="#topic+removeTable">removeTable()</a></code>
</p>
<p><code><a href="#topic+getTables">getTables()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see package vignettes for further examples.

#####################################################################################
## Create Workbook object and add worksheets
wb &lt;- createWorkbook()
addWorksheet(wb, "S1")
addWorksheet(wb, "S2")
addWorksheet(wb, "S3")


#####################################################################################
## -- write data.frame as an Excel table with column filters
## -- default table style is "TableStyleMedium2"

writeDataTable(wb, "S1", x = iris)

writeDataTable(wb, "S2",
  x = mtcars, xy = c("B", 3), rowNames = TRUE,
  tableStyle = "TableStyleLight9"
)

df &lt;- data.frame(
  "Date" = Sys.Date() - 0:19,
  "T" = TRUE, "F" = FALSE,
  "Time" = Sys.time() - 0:19 * 60 * 60,
  "Cash" = paste("$", 1:20), "Cash2" = 31:50,
  "hLink" = "https://CRAN.R-project.org/",
  "Percentage" = seq(0, 1, length.out = 20),
  "TinyNumbers" = runif(20) / 1E9, stringsAsFactors = FALSE
)

## openxlsx will apply default Excel styling for these classes
class(df$Cash) &lt;- c(class(df$Cash), "currency")
class(df$Cash2) &lt;- c(class(df$Cash2), "accounting")
class(df$hLink) &lt;- "hyperlink"
class(df$Percentage) &lt;- c(class(df$Percentage), "percentage")
class(df$TinyNumbers) &lt;- c(class(df$TinyNumbers), "scientific")

writeDataTable(wb, "S3", x = df, startRow = 4, rowNames = TRUE, tableStyle = "TableStyleMedium9")

#####################################################################################
## Additional Header Styling and remove column filters

writeDataTable(wb,
  sheet = 1, x = iris, startCol = 7, headerStyle = createStyle(textRotation = 45),
  withFilter = FALSE
)


#####################################################################################
## Save workbook
## Open in excel without saving file: openXL(wb)
## Not run: 
saveWorkbook(wb, "writeDataTableExample.xlsx", overwrite = TRUE)

## End(Not run)





#####################################################################################
## Pre-defined table styles gallery

wb &lt;- createWorkbook(paste0("tableStylesGallery.xlsx"))
addWorksheet(wb, "Style Samples")
for (i in 1:21) {
  style &lt;- paste0("TableStyleLight", i)
  writeDataTable(wb,
    x = data.frame(style), sheet = 1,
    tableStyle = style, startRow = 1, startCol = i * 3 - 2
  )
}

for (i in 1:28) {
  style &lt;- paste0("TableStyleMedium", i)
  writeDataTable(wb,
    x = data.frame(style), sheet = 1,
    tableStyle = style, startRow = 4, startCol = i * 3 - 2
  )
}

for (i in 1:11) {
  style &lt;- paste0("TableStyleDark", i)
  writeDataTable(wb,
    x = data.frame(style), sheet = 1,
    tableStyle = style, startRow = 7, startCol = i * 3 - 2
  )
}

## openXL(wb)
## Not run: 
saveWorkbook(wb, file = "tableStylesGallery.xlsx", overwrite = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='writeFormula'>Write a character vector as an Excel Formula</h2><span id='topic+writeFormula'></span>

<h3>Description</h3>

<p>Write a a character vector containing Excel formula to a worksheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeFormula(
  wb,
  sheet,
  x,
  startCol = 1,
  startRow = 1,
  array = FALSE,
  xy = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="writeFormula_+3A_wb">wb</code></td>
<td>
<p>A Workbook object containing a worksheet.</p>
</td></tr>
<tr><td><code id="writeFormula_+3A_sheet">sheet</code></td>
<td>
<p>The worksheet to write to. Can be the worksheet index or name.</p>
</td></tr>
<tr><td><code id="writeFormula_+3A_x">x</code></td>
<td>
<p>A character vector.</p>
</td></tr>
<tr><td><code id="writeFormula_+3A_startcol">startCol</code></td>
<td>
<p>A vector specifying the starting column to write to.</p>
</td></tr>
<tr><td><code id="writeFormula_+3A_startrow">startRow</code></td>
<td>
<p>A vector specifying the starting row to write to.</p>
</td></tr>
<tr><td><code id="writeFormula_+3A_array">array</code></td>
<td>
<p>A bool if the function written is of type array</p>
</td></tr>
<tr><td><code id="writeFormula_+3A_xy">xy</code></td>
<td>
<p>An alternative to specifying <code>startCol</code> and
<code>startRow</code> individually.  A vector of the form
<code>c(startCol, startRow)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently only the english version of functions are supported. Please don't use the local translation.
The examples below show a small list of possible formulas:
</p>

<ul>
<li><p>SUM(B2:B4)
</p>
</li>
<li><p>AVERAGE(B2:B4)
</p>
</li>
<li><p>MIN(B2:B4)
</p>
</li>
<li><p>MAX(B2:B4)
</p>
</li>
<li><p>...
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Alexander Walker
</p>


<h3>See Also</h3>

<p><code><a href="#topic+writeData">writeData()</a></code> <code><a href="#topic+makeHyperlinkString">makeHyperlinkString()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## There are 3 ways to write a formula

wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet 1")
writeData(wb, "Sheet 1", x = iris)

## SEE int2col() to convert int to Excel column label

## 1. -  As a character vector using writeFormula

v &lt;- c("SUM(A2:A151)", "AVERAGE(B2:B151)") ## skip header row
writeFormula(wb, sheet = 1, x = v, startCol = 10, startRow = 2)
writeFormula(wb, 1, x = "A2 + B2", startCol = 10, startRow = 10)


## 2. - As a data.frame column with class "formula" using writeData

df &lt;- data.frame(
  x = 1:3,
  y = 1:3,
  z = paste(paste0("A", 1:3 + 1L), paste0("B", 1:3 + 1L), sep = " + "),
  z2 = sprintf("ADDRESS(1,%s)", 1:3),
  stringsAsFactors = FALSE
)

class(df$z) &lt;- c(class(df$z), "formula")
class(df$z2) &lt;- c(class(df$z2), "formula")

addWorksheet(wb, "Sheet 2")
writeData(wb, sheet = 2, x = df)



## 3. - As a vector with class "formula" using writeData

v2 &lt;- c("SUM(A2:A4)", "AVERAGE(B2:B4)", "MEDIAN(C2:C4)")
class(v2) &lt;- c(class(v2), "formula")

writeData(wb, sheet = 2, x = v2, startCol = 10, startRow = 2)

## Save workbook
## Not run: 
saveWorkbook(wb, "writeFormulaExample.xlsx", overwrite = TRUE)

## End(Not run)


## 4. - Writing internal hyperlinks

wb &lt;- createWorkbook()
addWorksheet(wb, "Sheet1")
addWorksheet(wb, "Sheet2")
writeFormula(wb, "Sheet1", x = '=HYPERLINK("#Sheet2!B3", "Text to Display - Link to Sheet2")')

## Save workbook
## Not run: 
saveWorkbook(wb, "writeFormulaHyperlinkExample.xlsx", overwrite = TRUE)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
