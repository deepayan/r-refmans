<!DOCTYPE html><html><head><title>Help for package fmt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fmt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fmt'><p>Variance estimation of FMT method (Fully Moderated T-statistic)</p></a></li>
<li><a href='#plotFMT'><p>Plot fitting results from fmt function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Variance Estimation of FMT Method (Fully Moderated T-Statistic)</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>The FMT method computes posterior residual variances to be used in
  the denominator of a moderated t-statistic from a linear model analysis of
  gene expression data. It is an extension of the moderated t-statistic
  originally proposed by Smyth (2004) &lt;<a href="https://doi.org/10.2202%2F1544-6115.1027">doi:10.2202/1544-6115.1027</a>&gt;.
  LOESS local regression and empirical Bayesian method are used to estimate
  gene specific prior degrees of freedom and prior variance based on average
  gene intensity levels. The posterior residual variance in the denominator is
  a weighted average of prior and residual variance and the weights are prior
  degrees of freedom and residual variance degrees of freedom. The degrees of
  freedom of the moderated t-statistic is simply the sum of prior and residual
  variance degrees of freedom.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0), limma</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-02 12:29:29 UTC; yu18</td>
</tr>
<tr>
<td>Author:</td>
<td>Lianbo Yu [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lianbo Yu &lt;Lianbo.Yu@osumc.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-05 08:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fmt'>Variance estimation of FMT method (Fully Moderated T-statistic)</h2><span id='topic+fmt'></span>

<h3>Description</h3>

<p>This function computes posterior residual variances to be used
in the denominator of a moderated t-statistic from a linear model
analysis of gene expression data. It is an extension of the moderated
t-statistic originally proposed by Smyth (Statistical Applications in
Genetics and Molecular Biology, 2004;3:Article3). LOESS local regression
and empirical Bayesian method are used to estimate gene specific prior
degrees of freedom and prior variance based on average gene intensity levels.
The posterior residual variance in the denominator is a weighted average of
prior and residual variance and the weights are prior degrees of freedom
and residual variance degrees of freedom. The degrees of freedom of the
moderated t-statistic is simply the sum of prior and residual variance
degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmt(
  Amean,
  sigmasq,
  df,
  span1 = 0.5,
  span2 = 0.95,
  iter1 = 4,
  iter2 = 4,
  b = 20
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fmt_+3A_amean">Amean</code></td>
<td>
<p>average log intensity levels of all genes</p>
</td></tr>
<tr><td><code id="fmt_+3A_sigmasq">sigmasq</code></td>
<td>
<p>residual variances of all genes</p>
</td></tr>
<tr><td><code id="fmt_+3A_df">df</code></td>
<td>
<p>degrees of freedom for sigmasq</p>
</td></tr>
<tr><td><code id="fmt_+3A_span1">span1</code></td>
<td>
<p>span parameter in LOESS smoothing function, default is 0.5</p>
</td></tr>
<tr><td><code id="fmt_+3A_span2">span2</code></td>
<td>
<p>span parameter in LOESS smoothing function, default is 0.95</p>
</td></tr>
<tr><td><code id="fmt_+3A_iter1">iter1</code></td>
<td>
<p>iteration number in LOESS smoothing function, default is 4</p>
</td></tr>
<tr><td><code id="fmt_+3A_iter2">iter2</code></td>
<td>
<p>iteration number in LOESS smoothing function, default is 4</p>
</td></tr>
<tr><td><code id="fmt_+3A_b">b</code></td>
<td>
<p>number of genes on either side of moving average
window when calculating variance of log residual variances,
default is 20</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following components:
</p>
<p>'df.prior' the estimated prior degrees of freedom.
</p>
<p>'df.post' the estimated posterior degrees of freedom.
</p>
<p>'s2.prior' the estimated prior variance.
</p>
<p>'s2.post' the estimated posterior variance.
</p>
<p>'Ameansort' intermediate result.
</p>
<p>'eg' intermediate result.
</p>
<p>'egpred' intermediate result.
</p>
<p>'MAvar' intermediate result.
</p>
<p>'tri.d0' intermediate result.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate gene expression data for 1000 genes and 10 samples in two groups.
exp &lt;- rnorm(1000,8,2)
sd &lt;- 0.5*sqrt(4/rchisq(1000, df=7))
y &lt;- matrix(rnorm(1000*10, exp, sd),1000,10)
rownames(y) &lt;- paste("Gene",1:1000)
design &lt;- cbind(Grp1=1, Grp2vs1=c(0,0,0,0,0,1,1,1,1,1))

## limma fit
fit &lt;- lmFit(y,design)

## fmt fit
fmt.fit &lt;- fmt(fit$Amean, fit$sigma, fit$df.residual)

</code></pre>

<hr>
<h2 id='plotFMT'>Plot fitting results from fmt function</h2><span id='topic+plotFMT'></span>

<h3>Description</h3>

<p>This function provides fitting plots of fmt function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFMT(x, type, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotFMT_+3A_x">x</code></td>
<td>
<p>return list from fmt function</p>
</td></tr>
<tr><td><code id="plotFMT_+3A_type">type</code></td>
<td>
<p>type of plots</p>
</td></tr>
<tr><td><code id="plotFMT_+3A_...">...</code></td>
<td>
<p>extra parameters for plot function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
