<!DOCTYPE html><html><head><title>Help for package agfh</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {agfh}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adj_profile_likelihood_theta_var_maker'><p>Maker Function: Adjusted Profile Likelihood of Latent Variance</p></a></li>
<li><a href='#adj_resid_likelihood_theta_var_maker'><p>Maker Function: Adjusted Residual Likelihood of Latent Variance</p></a></li>
<li><a href='#agfh_theta_new_pred'><p>Agnostic Fay-Herriot Hierarchical Bayesian Model Predictions at Latent Level</p></a></li>
<li><a href='#anderson_darling'><p>Anderson-Darling Normality Test</p></a></li>
<li><a href='#beta_err_gen'><p>Generate Data with Beta Sampling Errors</p></a></li>
<li><a href='#cramer_vonmises'><p>Cramer-Von Mises Normality Test</p></a></li>
<li><a href='#gamma_err_gen'><p>Generate Data with Gamma Sampling Errors</p></a></li>
<li><a href='#hb_theta_new_pred'><p>Traditional Fay-Herriot Hierarchical Bayesian Model Predictions</p></a></li>
<li><a href='#kolmogorov_smirnov'><p>Kolmogorov-Smirnov Normality Test</p></a></li>
<li><a href='#make_agfh_sampler'><p>Maker Function: Agnostic Fay-Herriot Sampler</p></a></li>
<li><a href='#make_gibbs_sampler'><p>Maker Function: Traditional Fay-Herriot Gibbs Sampler</p></a></li>
<li><a href='#map_from_density'><p>Calculate the MAP Estimate from Posterior Samples</p></a></li>
<li><a href='#mse'><p>Calculate the Mean Squared Error Between two Vectors</p></a></li>
<li><a href='#null_gen'><p>Generate Data with Normal Sampling Errors</p></a></li>
<li><a href='#resid_likelihood_theta_var_maker'><p>Maker Function: Residual Likelihood of Latent Variance</p></a></li>
<li><a href='#RM_beta_eblue'><p>Traditional EBLUE Estimator of Beta</p></a></li>
<li><a href='#RM_theta_eblup'><p>Traditional EBLUP Estimator of Theta</p></a></li>
<li><a href='#RM_theta_new_pred'><p>Traditional EBLUP Estimator of Theta for new <code>X</code> values</p></a></li>
<li><a href='#RM_theta_var_moment_est'><p>Moment-Based Estimator of Latent Model Variance</p></a></li>
<li><a href='#shapiro_wilk'><p>Shaprio-Wilk Normality Test</p></a></li>
<li><a href='#test_u_normal'><p>Normality Test</p></a></li>
<li><a href='#theta_var_est_grid'><p>Basic Grid Optimizer for Likelihood</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-21</td>
</tr>
<tr>
<td>Title:</td>
<td>Agnostic Fay-Herriot Model for Small Area Statistics</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the Agnostic Fay-Herriot model, an extension of 
    the traditional small area model. In place of normal sampling errors, the 
    sampling error distribution is estimated with a Gaussian process to 
    accommodate a broader class of distributions. This flexibility is most 
    useful in the presence of bounded, multi-modal, or heavily skewed sampling 
    errors.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, goftest, ks, mvtnorm, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-21 16:42:03 UTC; marten</td>
</tr>
<tr>
<td>Author:</td>
<td>Marten Thompson [aut, cre, cph],
  Snigdhansu Chatterjee [ctb, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marten Thompson &lt;thom7058@umn.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-21 20:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='adj_profile_likelihood_theta_var_maker'>Maker Function: Adjusted Profile Likelihood of Latent Variance</h2><span id='topic+adj_profile_likelihood_theta_var_maker'></span>

<h3>Description</h3>

<p>A maker function that returns a function. The returned function is the adjusted profile likelihood of the data for a given (latent) variance, from Yoshimori &amp; Lahiri (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  adj_profile_likelihood_theta_var_maker(X, Y, D)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adj_profile_likelihood_theta_var_maker_+3A_x">X</code></td>
<td>
<p>observed independent data to be analyzed</p>
</td></tr>
<tr><td><code id="adj_profile_likelihood_theta_var_maker_+3A_y">Y</code></td>
<td>
<p>observed dependent data to be analyzed</p>
</td></tr>
<tr><td><code id="adj_profile_likelihood_theta_var_maker_+3A_d">D</code></td>
<td>
<p>known precisions of response <code>Y</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the adjusted profile likelihood as a function of the variance term in the latent model.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  X &lt;- matrix(1:10, ncol=1)
  Y &lt;- 2*X + rnorm(10, sd=1.1)
  D &lt;- rep(1, 10)
  adj.lik &lt;- adj_profile_likelihood_theta_var_maker(X, Y, D)
  adj.lik(0.5)
</code></pre>

<hr>
<h2 id='adj_resid_likelihood_theta_var_maker'>Maker Function: Adjusted Residual Likelihood of Latent Variance</h2><span id='topic+adj_resid_likelihood_theta_var_maker'></span>

<h3>Description</h3>

<p>A maker function that returns a function. The returned function is the adjusted residual likelihood of the data for a given (latent) variance, from Yoshimori &amp; Lahiri (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  adj_resid_likelihood_theta_var_maker(X, Y, D)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adj_resid_likelihood_theta_var_maker_+3A_x">X</code></td>
<td>
<p>observed independent data to be analyzed</p>
</td></tr>
<tr><td><code id="adj_resid_likelihood_theta_var_maker_+3A_y">Y</code></td>
<td>
<p>observed dependent data to be analyzed</p>
</td></tr>
<tr><td><code id="adj_resid_likelihood_theta_var_maker_+3A_d">D</code></td>
<td>
<p>known precisions of response <code>Y</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the adjusted residual likelihood as a function of the variance term in the latent model.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  X &lt;- matrix(1:10, ncol=1)
  Y &lt;- 2*X + rnorm(10, sd=1.1)
  D &lt;- rep(1, 10)
  adj.lik &lt;- adj_resid_likelihood_theta_var_maker(X, Y, D)
  adj.lik(0.5)
</code></pre>

<hr>
<h2 id='agfh_theta_new_pred'>Agnostic Fay-Herriot Hierarchical Bayesian Model Predictions at Latent Level</h2><span id='topic+agfh_theta_new_pred'></span>

<h3>Description</h3>

<p>Find predictions of <code class="reqn">\theta</code> using posterior samples from the AGFH model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  agfh_theta_new_pred(X_new, beta_samples, theta_var_samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agfh_theta_new_pred_+3A_x_new">X_new</code></td>
<td>
<p>single new independent data to be analyzed</p>
</td></tr>
<tr><td><code id="agfh_theta_new_pred_+3A_beta_samples">beta_samples</code></td>
<td>
<p>posterior samples of latent regression parameter</p>
</td></tr>
<tr><td><code id="agfh_theta_new_pred_+3A_theta_var_samples">theta_var_samples</code></td>
<td>
<p>posterior samples of latent variance parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>X_new</code> should be <code class="reqn">1</code> <code>x</code> <code class="reqn">p</code> shaped.
</p>
<p><code>beta_samples</code> and <code>theta_var_samples</code> should contain the same number of samples (columns for the former, length of the latter).
</p>


<h3>Value</h3>

<p>Vector containing n samples-many estimates of <code class="reqn">\theta</code> at <code>X_new</code>.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  p &lt;- 3
  n.post.samp &lt;- 10
  X.new &lt;- matrix(rep(1,p), nrow=1)
  beta.samp &lt;- matrix(rnorm(n.post.samp*p, mean=2, sd=0.1), ncol=n.post.samp)
  thvar.samp &lt;- runif(n.post.samp, 0.1, 1)

  th.preds &lt;- agfh_theta_new_pred(X.new, beta.samp, thvar.samp)
</code></pre>

<hr>
<h2 id='anderson_darling'>Anderson-Darling Normality Test</h2><span id='topic+anderson_darling'></span>

<h3>Description</h3>

<p>Test a sample against the null hypothesis that it comes from a standard Normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  anderson_darling(samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anderson_darling_+3A_samples">samples</code></td>
<td>
<p>vector of values to be tested</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wrapper function for corresponding functionality in <code>goftest</code>. Originally, from Anderson and Darling (1954).
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>authors of normality test applied i.e. 'Anderson Darling'</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>scalar value of test statistics</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>corresponding p-value of the test</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Anderson and Darling (1954) via <code>goftest</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  sample &lt;- rnorm(100)
  anderson_darling(sample)
</code></pre>

<hr>
<h2 id='beta_err_gen'>Generate Data with Beta Sampling Errors</h2><span id='topic+beta_err_gen'></span>

<h3>Description</h3>

<p>The traditional Fay-Herriot small area model has a Normal latent variable and Normal observed response errors. This method generates data with Normal latent variables and Beta errors on the response. Note that the sampling errors are transformed so their mean and variance match the the first two moments of the traditional model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  beta_err_gen (M, p, D, lambda, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta_err_gen_+3A_m">M</code></td>
<td>
<p>number of areal units</p>
</td></tr>
<tr><td><code id="beta_err_gen_+3A_p">p</code></td>
<td>
<p>dimension of regressors i.e. <code class="reqn">x \in R^p</code></p>
</td></tr>
<tr><td><code id="beta_err_gen_+3A_d">D</code></td>
<td>
<p>vector of precisions for response, length <code>M</code></p>
</td></tr>
<tr><td><code id="beta_err_gen_+3A_lambda">lambda</code></td>
<td>
<p>value of latent variance</p>
</td></tr>
<tr><td><code id="beta_err_gen_+3A_a">a</code></td>
<td>
<p>first shape parameter of Beta distribution</p>
</td></tr>
<tr><td><code id="beta_err_gen_+3A_b">b</code></td>
<td>
<p>second shape parameter of Beta distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>D</code></td>
<td>
<p>copy of argument 'D'</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>vector of length 'p' latent coefficients</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>copy of argument 'lambda'</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>matrix of independent variables</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>vector of latent effects</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>vector of responses</p>
</td></tr>
<tr><td><code>err</code></td>
<td>
<p>vector of sampling errors</p>
</td></tr>
<tr><td><code>name</code></td>
<td>
<p>name of sampling error distribution, including shape parameters</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- 50
  p &lt;- 3
  D &lt;- rep(0.1, M)
  lamb &lt;- 1/2
  dat &lt;- beta_err_gen(M, p, D, lamb, 1/2, 1/4)
</code></pre>

<hr>
<h2 id='cramer_vonmises'>Cramer-Von Mises Normality Test</h2><span id='topic+cramer_vonmises'></span>

<h3>Description</h3>

<p>Test a sample against the null hypothesis that it comes from a standard Normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  cramer_vonmises(samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cramer_vonmises_+3A_samples">samples</code></td>
<td>
<p>vector of values to be tested</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wrapper function for corresponding functionality in <code>goftest</code>. Originally developed in Cramer (1928), Mises (1931), and Smirnov (1936).
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>authors of normality test applied i.e. 'Cramer von Mises'</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>scalar value of test statistics</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>corresponding p-value of the test</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Cramer (1928), Mises (1931), and Smirnov (1936) via <code>goftest</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  sample &lt;- rnorm(100)
  cramer_vonmises(sample)
</code></pre>

<hr>
<h2 id='gamma_err_gen'>Generate Data with Gamma Sampling Errors</h2><span id='topic+gamma_err_gen'></span>

<h3>Description</h3>

<p>The traditional Fay-Herriot small area model has a Normal latent variable and Normal observed response errors. This method generates data with Normal latent variables and Gamma errors on the response. Note that the sampling errors are transformed so their mean and variance match the the first two moments of the traditional model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gamma_err_gen (M, p, D, lambda, shape, rate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gamma_err_gen_+3A_m">M</code></td>
<td>
<p>number of areal units</p>
</td></tr>
<tr><td><code id="gamma_err_gen_+3A_p">p</code></td>
<td>
<p>dimension of regressors i.e. <code class="reqn">x \in R^p</code></p>
</td></tr>
<tr><td><code id="gamma_err_gen_+3A_d">D</code></td>
<td>
<p>vector of precisions for response, length <code>M</code></p>
</td></tr>
<tr><td><code id="gamma_err_gen_+3A_lambda">lambda</code></td>
<td>
<p>value of latent variance</p>
</td></tr>
<tr><td><code id="gamma_err_gen_+3A_shape">shape</code></td>
<td>
<p>shape parameter of Gamma distribution</p>
</td></tr>
<tr><td><code id="gamma_err_gen_+3A_rate">rate</code></td>
<td>
<p>rate parameter of Gamma distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>D</code></td>
<td>
<p>copy of argument 'D'</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>vector of length 'p' latent coefficients</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>copy of argument 'lambda'</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>matrix of independent variables</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>vector of latent effects</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>vector of responses</p>
</td></tr>
<tr><td><code>err</code></td>
<td>
<p>vector of sampling errors</p>
</td></tr>
<tr><td><code>name</code></td>
<td>
<p>name of sampling error distribution, including shape and rate parameters</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- 50
  p &lt;- 3
  D &lt;- rep(0.1, M)
  lamb &lt;- 1/2
  dat &lt;- gamma_err_gen(M, p, D, lamb, 1/2, 10)
</code></pre>

<hr>
<h2 id='hb_theta_new_pred'>Traditional Fay-Herriot Hierarchical Bayesian Model Predictions</h2><span id='topic+hb_theta_new_pred'></span>

<h3>Description</h3>

<p>Find predictions using posterior samples from the traditional Fay-Herriot hierarchical bayesian model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  hb_theta_new_pred(X_new, beta_samples, theta_var_samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hb_theta_new_pred_+3A_x_new">X_new</code></td>
<td>
<p>single new independent data to be analyzed</p>
</td></tr>
<tr><td><code id="hb_theta_new_pred_+3A_beta_samples">beta_samples</code></td>
<td>
<p>posterior samples of latent regression parameter</p>
</td></tr>
<tr><td><code id="hb_theta_new_pred_+3A_theta_var_samples">theta_var_samples</code></td>
<td>
<p>posterior samples of latent variance parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>X_new</code> should be <code class="reqn">1</code> <code>x</code> <code class="reqn">p</code> shaped.
</p>
<p><code>beta_samples</code> and <code>theta_var_samples</code> should contain the same number of samples (columns for the former, length of the latter).
</p>


<h3>Value</h3>

<p>Vector containing n samples-many estimates of <code class="reqn">\theta</code> at <code>X_new</code>.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  p &lt;- 3
  n.post.samp &lt;- 10
  X.new &lt;- matrix(rep(1,p), nrow=1)
  beta.samp &lt;- matrix(rnorm(n.post.samp*p, mean=2, sd=0.1), ncol=n.post.samp)
  thvar.samp &lt;- runif(n.post.samp, 0.1, 1)

  th.preds &lt;- hb_theta_new_pred(X.new, beta.samp, thvar.samp)
</code></pre>

<hr>
<h2 id='kolmogorov_smirnov'>Kolmogorov-Smirnov Normality Test</h2><span id='topic+kolmogorov_smirnov'></span>

<h3>Description</h3>

<p>Test a sample against the null hypothesis that it comes from a standard Normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  kolmogorov_smirnov(samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kolmogorov_smirnov_+3A_samples">samples</code></td>
<td>
<p>vector of values to be tested</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wrapper function for corresponding functionality in <code>stats</code>. Originally, from Kolmogorov (1933).
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>name of normality test applied i.e. 'Komogorov Smirnov'</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>scalar value of test statistics</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>corresponding p-value from test</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Kolmogorov (1933) via <code>stats</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  sample &lt;- rnorm(100)
  kolmogorov_smirnov(sample)
</code></pre>

<hr>
<h2 id='make_agfh_sampler'>Maker Function: Agnostic Fay-Herriot Sampler</h2><span id='topic+make_agfh_sampler'></span>

<h3>Description</h3>

<p>A maker function that returns a function. The returned function is a sampler for the agnostic Fay-Herriot model.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_agfh_sampler_+3A_x">X</code></td>
<td>
<p>observed independent data to be analyzed</p>
</td></tr>
<tr><td><code id="make_agfh_sampler_+3A_y">Y</code></td>
<td>
<p>observed dependent data to be analyzed</p>
</td></tr>
<tr><td><code id="make_agfh_sampler_+3A_d">D</code></td>
<td>
<p>known precisions of response <code>Y</code></p>
</td></tr>
<tr><td><code id="make_agfh_sampler_+3A_var_gamma_a">var_gamma_a</code></td>
<td>
<p>latent variance prior parameter, <code>rgamma</code> shape</p>
</td></tr>
<tr><td><code id="make_agfh_sampler_+3A_var_gamma_b">var_gamma_b</code></td>
<td>
<p>latent variance prior parameter, <code>rgamma</code> rate</p>
</td></tr>
<tr><td><code id="make_agfh_sampler_+3A_s">S</code></td>
<td>
<p>vector of starting support values for <code class="reqn">g(\cdot)</code></p>
</td></tr>
<tr><td><code id="make_agfh_sampler_+3A_kern.a0">kern.a0</code></td>
<td>
<p>scalar variance parameter of GP kernel</p>
</td></tr>
<tr><td><code id="make_agfh_sampler_+3A_kern.a1">kern.a1</code></td>
<td>
<p>scalar lengthscale parameter of GP kernel</p>
</td></tr>
<tr><td><code id="make_agfh_sampler_+3A_kern.fuzz">kern.fuzz</code></td>
<td>
<p>scalar noise variance of kernel</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a Metropolis-within-Gibbs sampler of the agnostic Fay-Herriot model (AGFH).
</p>


<h3>Value</h3>

<p>Returns a sampler, itself a function of initial parameter values (a list with values for <code class="reqn">\beta, \theta</code>, the latent variance of <code class="reqn">\theta</code>, and starting values for <code class="reqn">g(.)</code>, typically zeros), number of samples, thinning rate, and scale of Metropolis-Hastings jumps for <code class="reqn">\theta</code> sampling.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  n &lt;- 10
  X &lt;- matrix(1:n, ncol=1)
  Y &lt;- 2*X + rnorm(n, sd=1.1)
  D &lt;- rep(1, n)
  ag &lt;- make_agfh_sampler(X, Y, D)

  params.init &lt;- list(
    beta=1,
    theta=rep(0,n),
    theta.var=1,
    gamma=rep(0,n)
  )
  ag.out &lt;- ag(params.init, 5, 1, 0.1)
</code></pre>

<hr>
<h2 id='make_gibbs_sampler'>Maker Function: Traditional Fay-Herriot Gibbs Sampler</h2><span id='topic+make_gibbs_sampler'></span>

<h3>Description</h3>

<p>A maker function that returns a function. The returned function is a Gibbs sampler for the traditional Fay-Herriot model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  make_gibbs_sampler(X, Y, D, var_gamma_a=1, var_gamma_b=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_gibbs_sampler_+3A_x">X</code></td>
<td>
<p>observed independent data to be analyzed</p>
</td></tr>
<tr><td><code id="make_gibbs_sampler_+3A_y">Y</code></td>
<td>
<p>observed dependent data to be analyzed</p>
</td></tr>
<tr><td><code id="make_gibbs_sampler_+3A_d">D</code></td>
<td>
<p>known precisions of response <code>Y</code></p>
</td></tr>
<tr><td><code id="make_gibbs_sampler_+3A_var_gamma_a">var_gamma_a</code></td>
<td>
<p>latent variance prior parameter, <code>rgamma</code> shape</p>
</td></tr>
<tr><td><code id="make_gibbs_sampler_+3A_var_gamma_b">var_gamma_b</code></td>
<td>
<p>latent variance prior parameter, <code>rgamma</code> rate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a Gibbs sampler, itself a function of initial parameter values (a list with values for <code class="reqn">\beta, \theta</code>, and latent variance of <code class="reqn">\theta</code>), number of samples, and thinning rate.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  n &lt;- 10
  X &lt;- matrix(1:n, ncol=1)
  Y &lt;- 2*X + rnorm(n, sd=1.1)
  D &lt;- rep(1, n)
  gib &lt;- make_gibbs_sampler(X, Y, D)

  params.init &lt;- list(
    beta=1,
    theta=rep(0,n),
    theta.var=1
  )
  gib.out &lt;- gib(params.init, 5, 1)
</code></pre>

<hr>
<h2 id='map_from_density'>Calculate the MAP Estimate from Posterior Samples</h2><span id='topic+map_from_density'></span>

<h3>Description</h3>

<p>Find maximum a posteriori estimate using posterior samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  map_from_density(param.ts, plot=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_from_density_+3A_param.ts">param.ts</code></td>
<td>
<p>vector of scalar samples</p>
</td></tr>
<tr><td><code id="map_from_density_+3A_plot">plot</code></td>
<td>
<p>boolean, plot or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Finds location of max of density from samples.
</p>


<h3>Value</h3>

<p>Scalar MAP estimate.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  n.post.samp &lt;- 10
  beta.samp &lt;- rnorm(n.post.samp, 0, 1/2)

  map_from_density(beta.samp)
</code></pre>

<hr>
<h2 id='mse'>Calculate the Mean Squared Error Between two Vectors</h2><span id='topic+mse'></span>

<h3>Description</h3>

<p>Merely wanted to use such a function by name; nothing fancy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mse(x,y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mse_+3A_x">x</code></td>
<td>
<p>vector of values</p>
</td></tr>
<tr><td><code id="mse_+3A_y">y</code></td>
<td>
<p>vector of values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar: the MSE between <code>x</code> and <code>y</code>.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  mse(seq(1:10), seq(10:1))
</code></pre>

<hr>
<h2 id='null_gen'>Generate Data with Normal Sampling Errors</h2><span id='topic+null_gen'></span>

<h3>Description</h3>

<p>The Fay-Herriot small area model has a Normal latent variable and Normal observed response. This generates data according to that specification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  null_gen (M, p, D, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="null_gen_+3A_m">M</code></td>
<td>
<p>number of areal units</p>
</td></tr>
<tr><td><code id="null_gen_+3A_p">p</code></td>
<td>
<p>dimension of regressors i.e. <code class="reqn">x \in R^p</code></p>
</td></tr>
<tr><td><code id="null_gen_+3A_d">D</code></td>
<td>
<p>vector of precisions for response, length <code>M</code></p>
</td></tr>
<tr><td><code id="null_gen_+3A_lambda">lambda</code></td>
<td>
<p>value of latent variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>D</code></td>
<td>
<p>copy of argument 'D'</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>vector of length 'p' latent coefficients</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>copy of argument 'lambda'</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>matrix of independent variables</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>vector of latent effects</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>vector of responses</p>
</td></tr>
<tr><td><code>err</code></td>
<td>
<p>vector of sampling errors</p>
</td></tr>
<tr><td><code>name</code></td>
<td>
<p>name of sampling error distribution</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  M &lt;- 50
  p &lt;- 3
  D &lt;- rep(0.1, M)
  lamb &lt;- 1/2
  dat &lt;- null_gen(M, p, D, lamb)
</code></pre>

<hr>
<h2 id='resid_likelihood_theta_var_maker'>Maker Function: Residual Likelihood of Latent Variance</h2><span id='topic+resid_likelihood_theta_var_maker'></span>

<h3>Description</h3>

<p>A maker function that returns a function. The returned function is the (non-adjusted) residual likelihood of the data for a given (latent) variance, from Yoshimori &amp; Lahiri (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  resid_likelihood_theta_var_maker(X, Y, D)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_likelihood_theta_var_maker_+3A_x">X</code></td>
<td>
<p>observed independent data to be analyzed</p>
</td></tr>
<tr><td><code id="resid_likelihood_theta_var_maker_+3A_y">Y</code></td>
<td>
<p>observed dependent data to be analyzed</p>
</td></tr>
<tr><td><code id="resid_likelihood_theta_var_maker_+3A_d">D</code></td>
<td>
<p>known precisions of response <code>Y</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the (non-adjusted) residual likelihood as a function of the variance term in the latent model.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  X &lt;- matrix(1:10, ncol=1)
  Y &lt;- 2*X + rnorm(10, sd=1.1)
  D &lt;- rep(1, 10)
  resid.lik &lt;- resid_likelihood_theta_var_maker(X, Y, D)
  resid.lik(0.5)
</code></pre>

<hr>
<h2 id='RM_beta_eblue'>Traditional EBLUE Estimator of Beta</h2><span id='topic+rm_beta_eblue'></span><span id='topic+RM_beta_eblue'></span>

<h3>Description</h3>

<p>Traditional EBLUE Estimator of Beta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  RM_beta_eblue(X, Y, D, theta_var_est)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RM_beta_eblue_+3A_x">X</code></td>
<td>
<p>observed independent data to be analyzed</p>
</td></tr>
<tr><td><code id="RM_beta_eblue_+3A_y">Y</code></td>
<td>
<p>observed dependent data to be analyzed</p>
</td></tr>
<tr><td><code id="RM_beta_eblue_+3A_d">D</code></td>
<td>
<p>known precisions of response <code>Y</code></p>
</td></tr>
<tr><td><code id="RM_beta_eblue_+3A_theta_var_est">theta_var_est</code></td>
<td>
<p>estimate of variance term for latent model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Traditional EBLUE estimator of beta.
</p>


<h3>Value</h3>

<p>Returns a vector estimate of beta.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  X &lt;- matrix(1:10, ncol=1)
  Y &lt;- 2*X + rnorm(10, sd=1.1)
  D &lt;- rep(1, 10)
  th.var.est &lt;- 0.1
  RM_beta_eblue(X, Y, D, th.var.est)
</code></pre>

<hr>
<h2 id='RM_theta_eblup'>Traditional EBLUP Estimator of Theta</h2><span id='topic+rm_theta_eblup'></span><span id='topic+RM_theta_eblup'></span>

<h3>Description</h3>

<p>Traditional EBLUP Estimator of Theta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  RM_theta_eblup(X, Y, D, theta.var.est)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RM_theta_eblup_+3A_x">X</code></td>
<td>
<p>observed independent data to be analyzed</p>
</td></tr>
<tr><td><code id="RM_theta_eblup_+3A_y">Y</code></td>
<td>
<p>observed dependent data to be analyzed</p>
</td></tr>
<tr><td><code id="RM_theta_eblup_+3A_d">D</code></td>
<td>
<p>known precisions of response <code>Y</code></p>
</td></tr>
<tr><td><code id="RM_theta_eblup_+3A_theta.var.est">theta.var.est</code></td>
<td>
<p>estimate of variance term for latent model; if <code>NA</code>, will automatically use method-of-moments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Traditional EBLUP estimator of latent values theta.
</p>


<h3>Value</h3>

<p>Returns a vector of estimates of theta.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  X &lt;- matrix(1:10, ncol=1)
  Y &lt;- 2*X + rnorm(10, sd=1.1)
  D &lt;- rep(1, 10)
  th.var.est &lt;- 0.1
  RM_theta_eblup(X, Y, D, th.var.est)

  RM_theta_eblup(X, Y, D)
</code></pre>

<hr>
<h2 id='RM_theta_new_pred'>Traditional EBLUP Estimator of Theta for new <code>X</code> values</h2><span id='topic+rm_theta_new_pred'></span><span id='topic+RM_theta_new_pred'></span>

<h3>Description</h3>

<p>Traditional EBLUP Estimator of Theta for new <code>X</code> values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  RM_theta_new_pred(X.new, beta.est)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RM_theta_new_pred_+3A_x.new">X.new</code></td>
<td>
<p>new independent data to be analyzed</p>
</td></tr>
<tr><td><code id="RM_theta_new_pred_+3A_beta.est">beta.est</code></td>
<td>
<p>estimate of regression term for latent model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simply <code>X</code>'<code>beta.est</code>
</p>


<h3>Value</h3>

<p>Returns a vector of estimates of theta.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  X &lt;- matrix(1:10, ncol=1)
  b &lt;- 1
  RM_theta_new_pred(X, b)
</code></pre>

<hr>
<h2 id='RM_theta_var_moment_est'>Moment-Based Estimator of Latent Model Variance</h2><span id='topic+rm_theta_var_moment_est'></span><span id='topic+RM_theta_var_moment_est'></span>

<h3>Description</h3>

<p>Simple moment-based estimator of the variance of the latent model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  RM_theta_var_moment_est(X, Y, D)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RM_theta_var_moment_est_+3A_x">X</code></td>
<td>
<p>observed independent data to be analyzed</p>
</td></tr>
<tr><td><code id="RM_theta_var_moment_est_+3A_y">Y</code></td>
<td>
<p>observed dependent data to be analyzed</p>
</td></tr>
<tr><td><code id="RM_theta_var_moment_est_+3A_d">D</code></td>
<td>
<p>known precisions of response <code>Y</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simple moment-based estimator of the variance of the latent model.
</p>


<h3>Value</h3>

<p>Returns a scalar estimate of variance.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  X &lt;- matrix(1:10, ncol=1)
  Y &lt;- 2*X + rnorm(10, sd=1.1)
  D &lt;- rep(1, 10)
  RM_theta_var_moment_est(X, Y, D)
</code></pre>

<hr>
<h2 id='shapiro_wilk'>Shaprio-Wilk Normality Test</h2><span id='topic+shapiro_wilk'></span>

<h3>Description</h3>

<p>Test a sample against the null hypothesis that it comes from a standard Normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  shapiro_wilk(samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shapiro_wilk_+3A_samples">samples</code></td>
<td>
<p>vector of values to be tested</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wrapper function for corresponding functionality in <code>stats</code>. Originally, from Shapiro and Wilk (1975).
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>authors of normality test applied i.e. 'Shapiro Wilk'</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>scalar value of test statistics</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>corresponding p-value of the test</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Shapiro and Wilk (1975) via <code>stats</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  sample &lt;- rnorm(100)
  shapiro_wilk(sample)
</code></pre>

<hr>
<h2 id='test_u_normal'>Normality Test</h2><span id='topic+test_u_normal'></span>

<h3>Description</h3>

<p>Test a sample against the null hypothesis that it comes from a standard Normal distribution with the specified test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  test_u_normal(samples, test)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_u_normal_+3A_samples">samples</code></td>
<td>
<p>vector of values to be tested</p>
</td></tr>
<tr><td><code id="test_u_normal_+3A_test">test</code></td>
<td>
<p>name of test, one of <code>'SW'</code>, <code>'KS'</code>, <code>'CM'</code>, <code>'AD'</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Convenience function for consistent syntax in calling <code>shapiro_wilk</code>, <code>kolmogorov_smirnov</code>, <code>cramer_vonmises</code>, and <code>anderson_darling</code> tests.
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>name</code></td>
<td>
<p>authors of normality test applied</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>scalar value of test statistics</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>corresponding p-value from test</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  sample &lt;- rnorm(100)
  test_u_normal(sample, 'SW')
</code></pre>

<hr>
<h2 id='theta_var_est_grid'>Basic Grid Optimizer for Likelihood</h2><span id='topic+theta_var_est_grid'></span>

<h3>Description</h3>

<p>A basic grid search optimizer. Here, used to estimate the variance in the latent model by maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  theta_var_est_grid(likelihood_theta_var)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theta_var_est_grid_+3A_likelihood_theta_var">likelihood_theta_var</code></td>
<td>
<p>some flavor of likelihood function in terms of latent variance</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>likelihood_theta_var</code> may be created using <code>adj_resid_likelihood_theta_var_maker</code> or similar.
</p>
<p>We recommended implementing a more robust optimizer.
</p>


<h3>Value</h3>

<p>The scalar value that optimizes <code>likelihood_theta_var</code>, or an error if this value is on the search boundary <code class="reqn">[10^{-6}, 10^2]</code>.
</p>


<h3>Source</h3>

<p>Marten Thompson thom7058@umn.edu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  X &lt;- matrix(1:10, ncol=1)
  Y &lt;- 2*X + rnorm(10, sd=1.1)
  D &lt;- rep(1, 10)
  adj.lik &lt;- adj_resid_likelihood_theta_var_maker(X, Y, D)
  theta_var_est_grid(adj.lik)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
