<!DOCTYPE html><html lang="en"><head><title>Help for package kgraph</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {kgraph}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe</p></a></li>
<li><a href='#+25+26lt+3B+26gt+3B+25'><p>Assignment pipe</p></a></li>
<li><a href='#+25+24+25'><p>Exposition pipe</p></a></li>
<li><a href='#build_kgraph'><p>Build a knowledge graph</p></a></li>
<li><a href='#build_kgraph_from_fit'><p>Build a knowledge graph from a fit object</p></a></li>
<li><a href='#cov_simi'><p>Covariance similarity</p></a></li>
<li><a href='#df_cuis_pairs'><p>A dataset containing CUIs pairs</p></a></li>
<li><a href='#df_embeds_dict'><p>A dictionary for the m_embeds object</p></a></li>
<li><a href='#df_phecode_pairs'><p>A dataset containing Phecode pairs</p></a></li>
<li><a href='#df_pval'><p>A dataset containing GWAS p-values</p></a></li>
<li><a href='#df_pval_dict'><p>A dictionary for the df_pval object</p></a></li>
<li><a href='#fit_embeds_kg'><p>Fit embeddings to a kgraph object</p></a></li>
<li><a href='#fit_embeds_to_pairs'><p>Fit embeds to pairs</p></a></li>
<li><a href='#gen_df_notpairs'><p>Generate null pairs</p></a></li>
<li><a href='#get_cutoff_threshold'><p>Get cut-off threshold</p></a></li>
<li><a href='#get_sgraph'><p>Wrapper to build a sgraph object fromk a kgraph object</p></a></li>
<li><a href='#m_embeds'><p>A dataset containing medical word embeddings</p></a></li>
<li><a href='#project_pairs'><p>Predict known pairs</p></a></li>
<li><a href='#reshape_multiple_traits'><p>Reshape multiple traits in example data</p></a></li>
<li><a href='#reshape_multiple_traits_dict'><p>Reshape multiple traits in example data dictionary</p></a></li>
<li><a href='#sparse_encode'><p>sparse_encode</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Knowledge Graphs Constructions and Visualizations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Knowledge graphs enable to efficiently visualize and gain insights into large-scale data analysis results, as p-values from multiple studies or embedding data matrices. The usual workflow is a user providing a data frame of association studies results and specifying target nodes, e.g. phenotypes, to visualize. The knowledge graph then shows all the features which are significantly associated with the phenotype, with the edges being proportional to the association scores. As the user adds several target nodes and grouping information about the nodes such as biological pathways, the construction of such graphs soon becomes complex. The 'kgraph' package aims to enable users to easily build such knowledge graphs, and provides two main features: first, to enable building a knowledge graph based on a data frame of concepts relationships, be it p-values or cosine similarities; second, to enable determining an appropriate cut-off on cosine similarities from a complete embedding matrix, to enable the building of a knowledge graph directly from an embedding matrix. The 'kgraph' package provides several display, layout and cut-off options, and has already proven useful to researchers to enable them to visualize large sets of p-value associations with various phenotypes, and to quickly be able to visualize embedding results. Two example datasets are provided to demonstrate these behaviors, and several live 'shiny' applications are hosted by the CELEHS laboratory and Parse Health, as the KESER Mental Health application <a href="https://keser-mental-health.parse-health.org/">https://keser-mental-health.parse-health.org/</a> based on Hong C. (2021) &lt;<a href="https://doi.org/10.1038%2Fs41746-021-00519-z">doi:10.1038/s41746-021-00519-z</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, htmltools, igraph, magrittr, opticskxi, plyr, pROC,
RColorBrewer, reshape2, sgraph, shiny</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bslib, data.table, DT, grid, knitr, nlpembeds, rmarkdown,
testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/thomaschln/kgraph">https://gitlab.com/thomaschln/kgraph</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://gitlab.com/thomaschln/kgraph/-/issues">https://gitlab.com/thomaschln/kgraph/-/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-10 08:53:09 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Charlon <a href="https://orcid.org/0000-0001-7497-0470"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Hongyi Yuan <a href="https://orcid.org/0000-0003-2597-1973"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  CELEHS [aut] (&lt;https://celehs.hms.harvard.edu&gt;),
  PARSE Health [aut] (&lt;https://parse-health.org&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Charlon &lt;charlon@protonmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-10 09:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>Pipe an object forward into a function or call expression.
Magrittr imported function, see details and examples in the magrittr package.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Result of rhs applied to lhs, see details in magrittr package.
</p>

<hr>
<h2 id='+25+26lt+3B+26gt+3B+25'>Assignment pipe</h2><span id='topic++25+3C+3E+25'></span>

<h3>Description</h3>

<p>Pipe an object forward into a function or call expression and update the
'lhs' object with the resulting value.
Magrittr imported function, see details and examples in the magrittr package.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26lt+2B3B+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>An object which serves both as the initial value and as target.</p>
</td></tr>
<tr><td><code id="+2B25+2B26lt+2B3B+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>a function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None, used to update the value of lhs.
</p>

<hr>
<h2 id='+25+24+25'>Exposition pipe</h2><span id='topic++25+24+25'></span>

<h3>Description</h3>

<p>Expose the names in 'lhs' to the 'rhs' expression.
Magrittr imported function, see details and examples in the magrittr package.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B24+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A list, environment, or a data.frame.</p>
</td></tr>
<tr><td><code id="+2B25+2B24+2B25_+3A_rhs">rhs</code></td>
<td>
<p>An expression where the names in lhs is available.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Result of rhs applied to one or several names of lhs.
</p>

<hr>
<h2 id='build_kgraph'>Build a knowledge graph</h2><span id='topic+build_kgraph'></span>

<h3>Description</h3>

<p>Build a knowledge graph
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_kgraph(
  selected_concepts,
  df_weights,
  df_dict = NULL,
  rm_single_groups = TRUE,
  df_sup_nodes = NULL,
  display_val_digits = 3,
  display_val_str = "\nCosine similarity: ",
  str_other = "Other",
  highlight_mult = TRUE,
  multiline_labs = TRUE,
  autoscale = TRUE,
  spring_weights = TRUE,
  n_max_edges = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_kgraph_+3A_selected_concepts">selected_concepts</code></td>
<td>
<p>Concepts of interest</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_df_weights">df_weights</code></td>
<td>
<p>Data frame with columns concept1, concept2, and weight;
typically the df_projs slot of the object returned by
function fit_embeds_to_pairs</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_df_dict">df_dict</code></td>
<td>
<p>Dictionary data frame, with columns id (matched to concepts
in df_weights), desc (for labels), color, and optionally
group.</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_rm_single_groups">rm_single_groups</code></td>
<td>
<p>Should groups with only one element be removed</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_df_sup_nodes">df_sup_nodes</code></td>
<td>
<p>Data frame of supplementary nodes (work in progress)</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_display_val_digits">display_val_digits</code></td>
<td>
<p>Number of weight digits to be displayed in labels</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_display_val_str">display_val_str</code></td>
<td>
<p>String to prefix to the displayed value</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_str_other">str_other</code></td>
<td>
<p>String to use for missing groups</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_highlight_mult">highlight_mult</code></td>
<td>
<p>Highlight nodes connected to multiple nodes of
interest.</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_multiline_labs">multiline_labs</code></td>
<td>
<p>Use multiline labels (shown when hovered on)</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_autoscale">autoscale</code></td>
<td>
<p>Perform scaling with sgraph::scale_graph</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_spring_weights">spring_weights</code></td>
<td>
<p>Use spring weights (reverts edges weights)</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_n_max_edges">n_max_edges</code></td>
<td>
<p>Threshold on number of edges</p>
</td></tr>
<tr><td><code id="build_kgraph_+3A_...">...</code></td>
<td>
<p>Passed to scale_kgraph</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Knowledge graph, list of slots df_nodes and df_links
</p>

<hr>
<h2 id='build_kgraph_from_fit'>Build a knowledge graph from a fit object</h2><span id='topic+build_kgraph_from_fit'></span>

<h3>Description</h3>

<p>Computes similarities for nodes of interest on the fly to avoid having to
deal with very large similarity matrices when number of features is large.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_kgraph_from_fit(selected_concepts, m_embeds, fit_kg, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_kgraph_from_fit_+3A_selected_concepts">selected_concepts</code></td>
<td>
<p>Concepts of interest</p>
</td></tr>
<tr><td><code id="build_kgraph_from_fit_+3A_m_embeds">m_embeds</code></td>
<td>
<p>Embeddings matrix</p>
</td></tr>
<tr><td><code id="build_kgraph_from_fit_+3A_fit_kg">fit_kg</code></td>
<td>
<p>Fit object</p>
</td></tr>
<tr><td><code id="build_kgraph_from_fit_+3A_...">...</code></td>
<td>
<p>Passed to build_kgraph</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Knowledge graph, list of slots df_nodes and df_links
</p>

<hr>
<h2 id='cov_simi'>Covariance similarity</h2><span id='topic+cov_simi'></span>

<h3>Description</h3>

<p>Covariance similarity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_simi(m_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_simi_+3A_m_data">m_data</code></td>
<td>
<p>Data matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Similarity matrixd
</p>

<hr>
<h2 id='df_cuis_pairs'>A dataset containing CUIs pairs</h2><span id='topic+df_cuis_pairs'></span>

<h3>Description</h3>

<p>The dataframe provides clinician-curated pairs of related of
medical concepts, useful to evaluate the performance of a
machine learning model. It's an extract of the PrimeKG database
(see vignette for URL).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("df_cuis_pairs")
</code></pre>


<h3>Format</h3>

<p>A dataframe with 2358 rows and 4 columns.
</p>


<h3>Details</h3>

<p>Each row defines a relationship between two CUIs, along with their textual
descriptions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('m_embeds')
data('df_cuis_pairs')

fit_kg = fit_embeds_kg(m_embeds, 'cosine',
                       df_pairs = df_cuis_pairs[c(1, 3)])
pROC::plot.roc(fit_kg$roc, print.auc = TRUE)

</code></pre>

<hr>
<h2 id='df_embeds_dict'>A dictionary for the m_embeds object</h2><span id='topic+df_embeds_dict'></span>

<h3>Description</h3>

<p>Dataframe with columns id (for the CUI), desc (textual
description), group and color (higher level groups)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("df_embeds_dict")
</code></pre>


<h3>Format</h3>

<p>A dataframe with 1118 rows and 4 columns.
</p>


<h3>Details</h3>

<p>Each row corresponds to one rowname of m_embeds.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('m_embeds')
data('df_embeds_dict')

fit_kg = fit_embeds_kg(m_embeds, 'cosine')
target_nodes_idxs = grep('suicide', df_embeds_dict$desc) %&gt;% head(2)
target_nodes = df_embeds_dict$id[target_nodes_idxs]

kg_obj = build_kgraph_from_fit(target_nodes, m_embeds, fit_kg,
                               df_dict = df_embeds_dict)

</code></pre>

<hr>
<h2 id='df_phecode_pairs'>A dataset containing Phecode pairs</h2><span id='topic+df_phecode_pairs'></span>

<h3>Description</h3>

<p>The dataframe provides clinician-curated pairs of related of
medical concepts, useful to evaluate the performance of a
machine learning model. It's an extract of the PrimeKG database
(see vignette for URL).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("df_phecode_pairs")
</code></pre>


<h3>Format</h3>

<p>A dataframe with 3288 rows and 4 columns.
</p>


<h3>Details</h3>

<p>Each row defines a relationship between two Phecodes, along with their textual
descriptions.
</p>

<hr>
<h2 id='df_pval'>A dataset containing GWAS p-values</h2><span id='topic+df_pval'></span>

<h3>Description</h3>

<p>This dataframe provides association scores between SNPs and
mantal health-related phenotypes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("df_pval")
</code></pre>


<h3>Format</h3>

<p>A dataframe with 364 rows and 3 columns
</p>


<h3>Details</h3>

<p>Each row defines an association between a SNP and a phenotype. Downloaded
from GWAS Catalog at https://www.ebi.ac.uk/gwas/efotraits/EFO_0007623.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('df_pval')

kg_obj = build_kgraph('EFO_0007623', df_pval)              

</code></pre>

<hr>
<h2 id='df_pval_dict'>A dictionary for the df_pval object</h2><span id='topic+df_pval_dict'></span>

<h3>Description</h3>

<p>Dataframe with columns id (for the phenotype or SNP identifier),
desc (textual description), group, and color
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("df_pval_dict")
</code></pre>


<h3>Format</h3>

<p>A dataframe with 333 rows and 4 columns.
</p>


<h3>Details</h3>

<p>Row IDs correspond to the identifiers found in columns concept1 and concept2
of the df_pval object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('df_pval')
data('df_pval_dict')

kg_obj = build_kgraph(c('EFO_0007623', 'EFO_0007624'), df_pval, df_pval_dict)              

</code></pre>

<hr>
<h2 id='fit_embeds_kg'>Fit embeddings to a kgraph object</h2><span id='topic+fit_embeds_kg'></span>

<h3>Description</h3>

<p>Build a fit_kgraph object to act as an intermediate between the embeddings
and the knowledge graph. If possible (i.e. if number of features is not too
large) compute all pair-wise similarities, otherwise determine the similarity
threshold using a number of random pairs. If a data frame of known pairs is
available, call fit_embeds_to_pairs which will produce an AUC and use the
threshold_projs parameter as the specificity threshold (e.g. the default
specificity of 0.9 corresponds to 10 percent false positives). Otherwise take the
quantile of similarity values corresponding to threshold_projs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_embeds_kg(
  m_embeds,
  similarity = c("cosine", "inprod", "cov_simi", "norm_inprod"),
  threshold_projs = 0.9,
  df_pairs = NULL,
  df_pairs_cols = 1:2,
  max_concepts = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_embeds_kg_+3A_m_embeds">m_embeds</code></td>
<td>
<p>Embedding matrix, rownames must be able to be matched to
concepts in df_pairs</p>
</td></tr>
<tr><td><code id="fit_embeds_kg_+3A_similarity">similarity</code></td>
<td>
<p>Similarity measure to be computed. One of 'inprod' (inner
product), 'cosine', 'cov_simi' (covariance similarity),
'norm_inprod' (normalized inner product).</p>
</td></tr>
<tr><td><code id="fit_embeds_kg_+3A_threshold_projs">threshold_projs</code></td>
<td>
<p>Specificity threshold to use for projections.
(default 0.9 is equivalent to 10 percent false positives,
and 0.95 to 5 percent false positives)</p>
</td></tr>
<tr><td><code id="fit_embeds_kg_+3A_df_pairs">df_pairs</code></td>
<td>
<p>Known relationships data frame</p>
</td></tr>
<tr><td><code id="fit_embeds_kg_+3A_df_pairs_cols">df_pairs_cols</code></td>
<td>
<p>Columns of df_pairs for identifiers, that map to
m_embeds rownames</p>
</td></tr>
<tr><td><code id="fit_embeds_kg_+3A_max_concepts">max_concepts</code></td>
<td>
<p>Maximum number of concepts to compute all pair-wise
similarities</p>
</td></tr>
<tr><td><code id="fit_embeds_kg_+3A_...">...</code></td>
<td>
<p>Passed to gen_df_notpairs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Knowledge graph, list of slots df_nodes and df_links
</p>

<hr>
<h2 id='fit_embeds_to_pairs'>Fit embeds to pairs</h2><span id='topic+fit_embeds_to_pairs'></span>

<h3>Description</h3>

<p>Fit an embeddings matrix to a dataframe of known pairs of related concepts.
Depending on matrix dimension, either compute all pair-wise similarities, or
only those existing in the known pairs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_embeds_to_pairs(
  m_embeds,
  df_pairs,
  df_pairs_cols = 1:2,
  similarity = c("inprod", "cosine", "cov_simi", "norm_inprod"),
  threshold_projs = 0.9,
  max_concepts = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_embeds_to_pairs_+3A_m_embeds">m_embeds</code></td>
<td>
<p>Embedding matrix, rownames must be able to be matched to
concepts in df_pairs</p>
</td></tr>
<tr><td><code id="fit_embeds_to_pairs_+3A_df_pairs">df_pairs</code></td>
<td>
<p>Known relationships data frame</p>
</td></tr>
<tr><td><code id="fit_embeds_to_pairs_+3A_df_pairs_cols">df_pairs_cols</code></td>
<td>
<p>Columns of df_pairs for identifiers, that map to
m_embeds rownames</p>
</td></tr>
<tr><td><code id="fit_embeds_to_pairs_+3A_similarity">similarity</code></td>
<td>
<p>Similarity measure to be computed. One of 'inprod' (inner
product), 'cosine', 'cov_simi' (covariance similarity),
'norm_inprod' (normalized inner product).</p>
</td></tr>
<tr><td><code id="fit_embeds_to_pairs_+3A_threshold_projs">threshold_projs</code></td>
<td>
<p>Specificity threshold to use for projections.
(default 0.9 is equivalent to 10 percent false positives,
and 0.95 to 5 percent false positives)</p>
</td></tr>
<tr><td><code id="fit_embeds_to_pairs_+3A_max_concepts">max_concepts</code></td>
<td>
<p>Maximum number of concepts to compute all pair-wise
similarities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object with slots roc (pROC::roc return), sims and truth (to
recompute partial AUCs using pROC), threshold_5fp (5 percent false positive
threshold), n_concepts (length of concepts in embeddings), and
df_projs (data frame listing pair-wise concepts similarities above
threshold_projs).
</p>

<hr>
<h2 id='gen_df_notpairs'>Generate null pairs</h2><span id='topic+gen_df_notpairs'></span>

<h3>Description</h3>

<p>Generate null pairs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_df_notpairs(
  ids,
  df_pairs = NULL,
  n_notpairs = if (is.null(df_pairs)) 1000 else nrow(df_pairs)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen_df_notpairs_+3A_ids">ids</code></td>
<td>
<p>Identifiers to sample from</p>
</td></tr>
<tr><td><code id="gen_df_notpairs_+3A_df_pairs">df_pairs</code></td>
<td>
<p>Known pairs data frame, to make sure no null pairs are in</p>
</td></tr>
<tr><td><code id="gen_df_notpairs_+3A_n_notpairs">n_notpairs</code></td>
<td>
<p>Direct parameter to set number of null pairs returned,
bypasses parameter type.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with columns concept1, concept2, weight
</p>

<hr>
<h2 id='get_cutoff_threshold'>Get cut-off threshold</h2><span id='topic+get_cutoff_threshold'></span>

<h3>Description</h3>

<p>Get cut-off threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cutoff_threshold(roc_obj, specificity_lvl = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_cutoff_threshold_+3A_roc_obj">roc_obj</code></td>
<td>
<p>Object returned by pROC::roc</p>
</td></tr>
<tr><td><code id="get_cutoff_threshold_+3A_specificity_lvl">specificity_lvl</code></td>
<td>
<p>Specificity threshold
(default 0.95 is equivalent to 5 percent false positives,
and 0.9 to 10 percent false positives)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Similarity value threshold
</p>

<hr>
<h2 id='get_sgraph'>Wrapper to build a sgraph object fromk a kgraph object</h2><span id='topic+get_sgraph'></span>

<h3>Description</h3>

<p>Wrapper to build a sgraph object fromk a kgraph object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sgraph(
  l_graph,
  colors_mapping = NULL,
  label_attrs = "label",
  igraph = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_sgraph_+3A_l_graph">l_graph</code></td>
<td>
<p>List of df_nodes and df_links dataframes</p>
</td></tr>
<tr><td><code id="get_sgraph_+3A_colors_mapping">colors_mapping</code></td>
<td>
<p>Output of get_colors_map</p>
</td></tr>
<tr><td><code id="get_sgraph_+3A_label_attrs">label_attrs</code></td>
<td>
<p>Column name of df_nodes that will be displayed</p>
</td></tr>
<tr><td><code id="get_sgraph_+3A_igraph">igraph</code></td>
<td>
<p>Intermediary igraph object, if already computed</p>
</td></tr>
<tr><td><code id="get_sgraph_+3A_...">...</code></td>
<td>
<p>Passed to sgraph::sgraph_clusters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sgraph htmlwidget object
</p>

<hr>
<h2 id='m_embeds'>A dataset containing medical word embeddings</h2><span id='topic+m_embeds'></span>

<h3>Description</h3>

<p>The embedding matrix has been fitted using Glove word
embeddings on 1,700 open-access publications related to
mental health.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("m_embeds")
</code></pre>


<h3>Format</h3>

<p>A matrix with 1122 rows and 100 columns.
</p>


<h3>Details</h3>

<p>Each row is the embedding vector of a CUI in 100 Glove dimensions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('m_embeds')

fit_kg = fit_embeds_kg(m_embeds, 'cosine')

</code></pre>

<hr>
<h2 id='project_pairs'>Predict known pairs</h2><span id='topic+project_pairs'></span>

<h3>Description</h3>

<p>Predict known pairs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>project_pairs(m_simi, threshold)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="project_pairs_+3A_m_simi">m_simi</code></td>
<td>
<p>Similarity matrix</p>
</td></tr>
<tr><td><code id="project_pairs_+3A_threshold">threshold</code></td>
<td>
<p>Similarity value threshold</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with columns concept1, concept2, weight
</p>

<hr>
<h2 id='reshape_multiple_traits'>Reshape multiple traits in example data</h2><span id='topic+reshape_multiple_traits'></span>

<h3>Description</h3>

<p>Reshape multiple traits in example data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reshape_multiple_traits(df_pval)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reshape_multiple_traits_+3A_df_pval">df_pval</code></td>
<td>
<p>Data frame of p-values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Reshaped data frame
</p>

<hr>
<h2 id='reshape_multiple_traits_dict'>Reshape multiple traits in example data dictionary</h2><span id='topic+reshape_multiple_traits_dict'></span>

<h3>Description</h3>

<p>Reshape multiple traits in example data dictionary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reshape_multiple_traits_dict(df_dict)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reshape_multiple_traits_dict_+3A_df_dict">df_dict</code></td>
<td>
<p>Data frame of p-values dictionary</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Reshaped data frame
</p>

<hr>
<h2 id='sparse_encode'>sparse_encode</h2><span id='topic+sparse_encode'></span>

<h3>Description</h3>

<p>Sparse encoding method by closest neighbors. 
Three methods are available:
- hard encoding: each patient's closest neighbors are set to 1, others
are set to 0
- soft encoding: each patient's closest neighbors distances are
transformed by the exponential norm, others are set to 0
- epsilon encoding: each patient's neighbors closer than the mean of
the distance matrix are transformed by the exponential norm and
others are set to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparse_encode(
  m_data,
  dist_method = "norm_inprod",
  encoding = c("epsilon", "hard", "soft"),
  sigma,
  n_neighbors = floor(nrow(m_data)/10),
  scale_obs = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sparse_encode_+3A_m_data">m_data</code></td>
<td>
<p>Numeric matrix</p>
</td></tr>
<tr><td><code id="sparse_encode_+3A_dist_method">dist_method</code></td>
<td>
<p>Distance method passed to qb_dist</p>
</td></tr>
<tr><td><code id="sparse_encode_+3A_encoding">encoding</code></td>
<td>
<p>Encoding method: one of hard, soft, or epsilon</p>
</td></tr>
<tr><td><code id="sparse_encode_+3A_sigma">sigma</code></td>
<td>
<p>Parameter for the exponential norm transform.
Default is mean of std. dev. of distance matrix columns</p>
</td></tr>
<tr><td><code id="sparse_encode_+3A_n_neighbors">n_neighbors</code></td>
<td>
<p>Number of neighbors (ignored in epsilon encoding)</p>
</td></tr>
<tr><td><code id="sparse_encode_+3A_scale_obs">scale_obs</code></td>
<td>
<p>Scale by observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Projected matrix
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
