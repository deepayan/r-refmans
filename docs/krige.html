<!DOCTYPE html><html lang="en"><head><title>Help for package krige</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {krige}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.matrix.semivariance'><p>Convert semivariance to a matrix object</p></a></li>
<li><a href='#as.mcmc.krige'><p>Convert <code>krige</code> object to an <code>mcmc</code> object</p></a></li>
<li><a href='#burnin'><p>Discard Burn-in Period of Kriging Model</p></a></li>
<li><a href='#congCombined'><p>Congressional District Public Opinion Ideology in 2010</p></a></li>
<li><a href='#ContrivedData'><p>Contrived Example Data</p></a></li>
<li><a href='#exponential.semivariance'><p>Parametric Exponential Semivariance</p></a></li>
<li><a href='#geweke'><p>Geweke Diagnostic for MCMC</p></a></li>
<li><a href='#heidel.welch'><p>Heidelberger and Welch Diagnostic for MCMC</p></a></li>
<li><a href='#krige'><p>krige: Geospatial Kriging with Metropolis Sampling</p></a></li>
<li><a href='#krige.posterior'><p>Posterior Distribution for the Kriging Process</p></a></li>
<li><a href='#lowerCombined'><p>State Legislative District (Lower Chambers) Public Opinion Ideology in 2010</p></a></li>
<li><a href='#mcmc.samples'><p>Extract MCMC Samples</p></a></li>
<li><a href='#metropolis.krige'><p>Sampling Technique Using Metropolis-Hastings</p></a></li>
<li><a href='#NY_subset'><p>New York State CCES Respondents in 2008</p></a></li>
<li><a href='#NYcity_subset'><p>New York City CCES Respondents in 2008</p></a></li>
<li><a href='#predict.krige'><p>Predictions by Kriging</p></a></li>
<li><a href='#semivariance'><p>Semivariance for Geospatial Data</p></a></li>
<li><a href='#semivariogram'><p>Semivariogram for Geospatial Data</p></a></li>
<li><a href='#stateCombined'><p>State Public Opinion Ideology in 2010</p></a></li>
<li><a href='#summary.krige'><p>Summarize Fitted Kriging Model</p></a></li>
<li><a href='#update.krige'><p>Update Model</p></a></li>
<li><a href='#upperCombined'><p>State Legislative District (Upper Chambers) Public Opinion Ideology in 2010</p></a></li>
<li><a href='#WVwells'><p>West Virginia Oil and Gas Production in 2012</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Geospatial Kriging with Metropolis Sampling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Jason S. Byers [aut, cre], Le Bao [aut], Jamie Carson [aut], Jeff Gill [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jason S. Byers &lt;jaybyers55@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates kriging models for geographical point-referenced data. Method is described in Gill (2020) &lt;<a href="https://doi.org/10.1177%2F1532440020930197">doi:10.1177/1532440020930197</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, stats, graphics, coda</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-30 14:08:06 UTC; jasonbyers</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-01 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.matrix.semivariance'>Convert semivariance to a matrix object</h2><span id='topic+as.matrix.semivariance'></span><span id='topic+as.data.frame.semivariance'></span>

<h3>Description</h3>

<p>Convert semivariance to a matrix object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'semivariance'
as.matrix(x, ...)

## S3 method for class 'semivariance'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.matrix.semivariance_+3A_x">x</code></td>
<td>
<p>An <code>semivariance</code> object created by <code>semivariance</code> or 
<code>exponential.semivariance</code>.</p>
</td></tr>
<tr><td><code id="as.matrix.semivariance_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>as.matrix</code> and <code>as.data.frame</code>
methods. Not supported for <code>semivariance</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The defaults of semivariance methods give a list or numeric vector. These
methods can convert the semivariance output list and vector to <code>matrix</code> or 
<code>data.frame</code>.
</p>


<h3>Value</h3>

<p>A matrix containing the computed distance and semivariance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize Data
summary(ContrivedData)

# Empirical semivariance for variable y
raw.var &lt;- semivariance(x=ContrivedData$y,coords = cbind(ContrivedData$s.1, 
  ContrivedData$s.2))
as.matrix(raw.var)

# Estimation using metropolis.krige()
#' # Set seed
set.seed(1241060320)

M &lt;- 100
#M&lt;-10000

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
   data = ContrivedData, n.iter = M, range.tol = 0.05)

# Parametric semivariance
parametric.var &lt;- semivariance(contrived.run)
as.matrix(parametric.var)
as.data.frame(parametric.var)

## End(Not run)

</code></pre>

<hr>
<h2 id='as.mcmc.krige'>Convert <code>krige</code> object to an <code>mcmc</code> object</h2><span id='topic+as.mcmc.krige'></span><span id='topic+as.mcmc.summary.krige'></span>

<h3>Description</h3>

<p>Convert MCMC matrix of posterior samples for use with the <span class="pkg">coda</span> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'krige'
as.mcmc(x, start = 1, end = x$n.iter, thin = 1, ...)

## S3 method for class 'summary.krige'
as.mcmc(x, start = 1, end = x$n.iter, thin = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.mcmc.krige_+3A_x">x</code></td>
<td>
<p>An <code>krige</code> or <code>summary.krige</code> object.</p>
</td></tr>
<tr><td><code id="as.mcmc.krige_+3A_start">start</code></td>
<td>
<p>The iteration number of the first observation.</p>
</td></tr>
<tr><td><code id="as.mcmc.krige_+3A_end">end</code></td>
<td>
<p>The iteration number of the last observation.</p>
</td></tr>
<tr><td><code id="as.mcmc.krige_+3A_thin">thin</code></td>
<td>
<p>The thinning interval between consecutive observations.</p>
</td></tr>
<tr><td><code id="as.mcmc.krige_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>mcmc()</code> methods of <code>coda</code>
package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function converts a <code>krige</code> output object to a Markov Chain 
Monte Carlo (mcmc) object used in <code>coda</code> as well as a variety of MCMC 
packages. It extracts the MCMC matrix of posterior samples from the output 
of <code>metropolis.krige</code> for further use with other MCMC packages and functions.
</p>


<h3>Value</h3>

<p>A <code>mcmc</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="coda.html#topic+as.mcmc">coda::as.mcmc()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize Data
summary(ContrivedData)

# Set seed
set.seed(1241060320)

#For simple illustration, we set to few iterations.
#In this case, a 10,000-iteration run converges to the true parameters.
#If you have considerable time and hardware, delete the # on the next line.
#10,000 iterations took 39 min. with 8 GB RAM &amp; a 1.5 GHz Quad-Core processor.
M &lt;- 100
#M&lt;-10000

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
                                  data = ContrivedData, n.iter = M, n.burnin = 20,
                                  range.tol = 0.05)
                                  
# Convert to mcmc object
mcmc.contrived.run &lt;- as.mcmc(contrived.run)
#mcmc.contrived.run &lt;- as.mcmc(summary(contrived.run))

# Diagnostics using MCMC packages
coda::raftery.diag(mcmc.contrived.run)
# superdiag::superdiag(mcmc.contrived.run) #NOT WORKING YET

## End(Not run)

</code></pre>

<hr>
<h2 id='burnin'>Discard Burn-in Period of Kriging Model</h2><span id='topic+burnin'></span><span id='topic+burnin.krige'></span><span id='topic+burnin.matrix'></span>

<h3>Description</h3>

<p>Discard burn-in period of a estimated model from <code>metropolis.krige</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>burnin(object, n.burnin)

## S3 method for class 'krige'
burnin(object, n.burnin = object$n.iter/2)

## S3 method for class 'matrix'
burnin(object, n.burnin = nrow(object)/2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="burnin_+3A_object">object</code></td>
<td>
<p>An <code>krige</code> object from the <code>metropolis.krige</code> function.</p>
</td></tr>
<tr><td><code id="burnin_+3A_n.burnin">n.burnin</code></td>
<td>
<p>The number of burnin iterations. Defaults to half of the iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function discard the burn-in period from the results of <code>metropolis.krige</code>.
It is generally used for discarding burn-in for <code>krige</code> object that keeps 
all the iterations.
</p>

<hr>
<h2 id='congCombined'>Congressional District Public Opinion Ideology in 2010</h2><span id='topic+congCombined'></span>

<h3>Description</h3>

<p>These data present measures of ideology in 2010 for 434 districts for the U.S. 
House of Representatives, recorded as the variable <code>krige.cong</code>. Forecasts 
are based on a kriging model fitted over the 2008 Cooperative Congressional 
Election Survey (CCES), paired with predictive data from the 2010 Census. Each 
district's public ideology is paired with the DW-NOMINATE common space score 
of each of its representative in 2011 (update from McCarty, Poole and Rosenthal 
1997). Eight districts have repeated observations in order to include the DW-NOMINATE 
score when a member was replaced mid-term.
</p>


<h3>Format</h3>

<p>The <code>congCombined</code> dataset has 442 observations and 12 variables. 4
34 out of 435 congressional districts are covered, with eight districts duplicated 
when a member was replaced mid-term.
</p>

<dl>
<dt><code>stateCD</code></dt><dd><p>Unique identifier for each congressional district by state. 
The first two digits are <code>STATEA</code>, and the second two are <code>cd</code>.</p>
</dd>
<dt><code>krige.cong</code></dt><dd><p>The ideology of the average citizen in the congressional district.</p>
</dd>
<dt><code>krige.state.var</code></dt><dd><p>The variance of ideology among the district's citizens.</p>
</dd>
<dt><code>cong</code></dt><dd><p>The term of Congress studied&ndash;112 for this dataset.</p>
</dd>
<dt><code>idno</code></dt><dd><p>Identification number for the House member&ndash;ICPSR numbers 
continued by Poole &amp; Rosenthal.</p>
</dd>
<dt><code>state</code></dt><dd><p>The ICPSR code for the state.</p>
</dd>
<dt><code>cd</code></dt><dd><p>The congressional district number.</p>
</dd>
<dt><code>statenm</code></dt><dd><p>The first seven letters of the state's name.</p>
</dd>
<dt><code>party</code></dt><dd><p>Political party of the House member. 100=Democrat, 200=Republican.</p>
</dd>
<dt><code>name</code></dt><dd><p>Last name of the House member, followed by first name if ambiguous.</p>
</dd>
<dt><code>dwnom1</code></dt><dd><p>First dimension DW-NOMINATE common space score for the House member. Higher values are usually interpreted as more right-wing, with lower values as more left-wing.</p>
</dd>
<dt><code>STATEA</code></dt><dd><p>The FIPS code for the state.</p>
</dd>
</dl>



<h3>Source</h3>


<p>Ansolabehere, Stephen. 2011. &quot;CCES, Common Content, 2008.&quot; Ver. 4.
</p>
<p>McCarty, Nolan M., Keith T. Poole and Howard Rosenthal. 1997. <em>Income 
Redistribution and the Realignment of American Politics</em>. American Enterprise 
Institude Studies on Understanding Economic Inequality. Washington: AEI Press.
</p>
<p>Minnesota Population Center. 2011. <em>National Historical Geographic Information 
System: Version 2.0.</em> Minneapolis, MN: University of Minnesota. &lsquo;<span class="samp">&#8288;https://www.nhgis.org&#8288;</span>&rsquo;

</p>


<h3>References</h3>

<p>Jeff Gill. 2020. Measuring Constituency Ideology Using Bayesian Universal Kriging. 
<em>State Politics &amp; Policy Quarterly</em>. <code>doi:10.1177/1532440020930197</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    
# Descriptive Statistics
summary(congCombined)

# Correlate House Members' DW-NOMINATE Scores with Public Opinion Ideology
cor(congCombined$dwnom1,congCombined$krige.cong)

# Plot House Members' DW-NOMINATE Scores against Public Opinion Ideology
plot(y=congCombined$dwnom1,x=congCombined$krige.cong,
   xlab="District Ideology (Kriging)", ylab="Legislator Ideology (1st Dim., Common Space)", 
   main="U.S. House of Representatives", type="n")
points(y=congCombined$dwnom1[congCombined$party==200],
   x=congCombined$krige.cong[congCombined$party==200],pch="R",col="red")
   points(y=congCombined$dwnom1[congCombined$party==100],
   x=congCombined$krige.cong[congCombined$party==100],pch="D",col="blue")
</code></pre>

<hr>
<h2 id='ContrivedData'>Contrived Example Data</h2><span id='topic+ContrivedData'></span>

<h3>Description</h3>

<p>These data are a simulated point-referenced geospatial data that serve to provide 
a clean example of a kriging model. There are 500 observations with coordinates 
located on a unit square.
</p>


<h3>Format</h3>

<p>The <code>ContrivedData</code> dataset has 500 observations and 5 variables.
</p>

<dl>
<dt><code>y</code></dt><dd><p>The outcome variable. Its true population functional form is 
<code class="reqn">y_s=0+1 x_{1s}+2 x_{2s}+\omega_{s}+\epsilon_{s}</code>. The true variance of 
<code class="reqn">\omega</code> is <code class="reqn">\sigma^2=0.5</code> and of <code class="reqn">\epsilon</code> is <code class="reqn">\tau^2=0.5</code>. 
The decay term that shapes spatial correlation levels is <code class="reqn">\phi=2.5</code>.</p>
</dd>
<dt><code>x.1</code></dt><dd><p>A predictor with a standard uniform distribution.</p>
</dd>
<dt><code>x.2</code></dt><dd><p>A predictor with a standard normal distribution.</p>
</dd>
<dt><code>s.1</code></dt><dd><p>Coordinate in eastings for each observation, distributed 
standard uniform.</p>
</dd>
<dt><code>s.2</code></dt><dd><p>Coordinate in northings for each observation, distributed 
standard uniform.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize example data
summary(ContrivedData)

# Initial OLS model
contrived.ols&lt;-lm(y~x.1+x.2,data=ContrivedData)
# summary(contrived.ols)

# Set seed
set.seed(1241060320)

#For simple illustration, we set to few iterations.
#In this case, a 10,000-iteration run converges to the true parameters.
#If you have considerable time and hardware, delete the # on the next line.
#10,000 iterations took 39 min. with 8 GB RAM &amp; a 1.5 GHz Quad-Core processor.
M &lt;- 100
#M&lt;-10000

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
   data = ContrivedData, n.iter = M, n.burnin=20, range.tol = 0.05)
# Alternatively, use burnin() after estimation  
#contrived.run &lt;- burnin(contrived.run, n.burnin=20)

# Summarize the results and examine results against true coefficients	
summary(contrived.run)
(TRUTH&lt;-c(0.5,2.5,0.5,0,1,2))

## End(Not run)
</code></pre>

<hr>
<h2 id='exponential.semivariance'>Parametric Exponential Semivariance</h2><span id='topic+exponential.semivariance'></span><span id='topic+exponential.semivariance.krige'></span><span id='topic+exponential.semivariance.default'></span>

<h3>Description</h3>

<p>This function returns the value of a parametric powered exponential semivariogram 
given the values of the parameters and the distance between observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exponential.semivariance(...)

## S3 method for class 'krige'
exponential.semivariance(object, ...)

## Default S3 method:
exponential.semivariance(nugget, decay, partial.sill, distance, power = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exponential.semivariance_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
<tr><td><code id="exponential.semivariance_+3A_object">object</code></td>
<td>
<p>A <code>krige</code> object of which the values of the estimates are used 
to calculate the exponential semivariance.</p>
</td></tr>
<tr><td><code id="exponential.semivariance_+3A_nugget">nugget</code></td>
<td>
<p>The value of the non-spatial variance, or nugget term.</p>
</td></tr>
<tr><td><code id="exponential.semivariance_+3A_decay">decay</code></td>
<td>
<p>The value of the decay term that sets the level of correlation given distance.</p>
</td></tr>
<tr><td><code id="exponential.semivariance_+3A_partial.sill">partial.sill</code></td>
<td>
<p>The value of the spatial variance, or partial sill term.</p>
</td></tr>
<tr><td><code id="exponential.semivariance_+3A_distance">distance</code></td>
<td>
<p>The distance among observations for which the semivariance value is desired.</p>
</td></tr>
<tr><td><code id="exponential.semivariance_+3A_power">power</code></td>
<td>
<p>The exponent specified in the powered exponential semivariogram. 
Defaults to 2, which corresponds to a Gaussian semivariance function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The models estimated by the <code>krige</code> package assume a powered exponential 
covariance structure. Each parametric covariance function for kriging models 
corresponds to a related semivariance function, given that highly correlated 
values will have a small variance in differences while uncorrelated values 
will vary widely. More specifically, semivariance is equal to half of the 
variance of the difference in a variable's values at a given distance. That is, 
the semivariance is defined as: <code class="reqn">\gamma(h)=0.5*E[X(s+h)-X(s)]^2</code>, where <code class="reqn">X</code> 
is the variable of interest, s is a location, and h is the distance from s 
to another location. 
</p>
<p>The powered exponential covariance structure implies that the semivariance 
follows the specific functional form of <code class="reqn">\gamma(d)=\tau^2+\sigma^2(1-\exp(-|\phi d|^p))</code> 
(Banerjee, Carlin, and Gelfand 2015, 27). A perk of this structure is that 
the special case of <em>p=1</em> implies the commonly-used exponential semivariogram, 
and the special case of <em>p=2</em> implies the commonly-used Gaussian semivariogram. 
Upon estimating a model, it is advisable to graph the functional form of the 
implied parametric semivariance structure. By substituting estimated values 
of the <code>nugget</code>, <code>decay</code>, and <code>partial.sill</code> terms, as well 
as specifying the correct <code>power</code> argument, it is possible to compute 
the implied semivariance from the model. The <code>distance</code> argument easily 
can be a vector of observed distance values.
</p>


<h3>Value</h3>

<p>A semivariance object. It will be a numeric vector with each bin's value 
of the semivariance.
</p>


<h3>References</h3>

<p>Sudipto Banerjee, Bradley P. Carlin, and Alan E. Gelfand. 2015. <em>Hierarchical 
Modeling and Analysis for Spatial Data</em>. 2nd ed. Boca Raton, FL: CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+semivariogram">semivariogram</a></code>, <code><a href="#topic+plot.semivariance">plot.semivariance</a></code>, <code><a href="#topic+exponential.semivariance">exponential.semivariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize data
summary(ContrivedData)

# Set seed
set.seed(1241060320)

M &lt;- 100

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
  data = ContrivedData, n.iter = M, range.tol = 0.05)
  
# Parametric powered exponential semivariogram
exponential.semivariance(contrived.run)

#OLS Model for Residuals
contrived.ols&lt;-lm(y~x.1+x.2,data=ContrivedData)

# Residual semivariance
(resid.semivar &lt;- semivariance(contrived.ols, coords = c("s.1", "s.2"), terms = "residual"))

# Parametric exponential semivariance
exponential.semivariance(nugget=0.5,decay=2.5,partial.sill=0.5, 
                         distance=as.numeric(names(resid.semivar)))

## End(Not run)

</code></pre>

<hr>
<h2 id='geweke'>Geweke Diagnostic for MCMC</h2><span id='topic+geweke'></span><span id='topic+geweke.krige'></span><span id='topic+geweke.summary.krige'></span><span id='topic+geweke.default'></span>

<h3>Description</h3>

<p>Conducts a Geweke convergence diagnostic on MCMC iterations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geweke(object, early.prop = 0.1, late.prop = 0.5, precision = 4)

## S3 method for class 'krige'
geweke(object, early.prop = 0.1, late.prop = 0.5, precision = 4)

## S3 method for class 'summary.krige'
geweke(object, early.prop = 0.1, late.prop = 0.5, precision = 4)

## Default S3 method:
geweke(object, early.prop = 0.1, late.prop = 0.5, precision = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geweke_+3A_object">object</code></td>
<td>
<p>An matrix or <code>krige</code>/<code>summary.krige</code> object for which 
a Geweke diagnostic is desired</p>
</td></tr>
<tr><td><code id="geweke_+3A_early.prop">early.prop</code></td>
<td>
<p>Proportion of iterations to use from the start of the chain.</p>
</td></tr>
<tr><td><code id="geweke_+3A_late.prop">late.prop</code></td>
<td>
<p>Proportion of iterations to use from the end of the chain.</p>
</td></tr>
<tr><td><code id="geweke_+3A_precision">precision</code></td>
<td>
<p>Number of digits of test statistics and p-values to print.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function currently works with <code>matrix</code>, <code>krige</code>, 
and <code>summary.krige</code> objects. It is a simplified version of the Geweke 
test for use with this package.
</p>
<p>Geweke's (1992) test for nonconvergence of a MCMC chain is to conduct a 
difference-of-means test that compares the mean early in the chain to the mean 
late in the chain. If the means are significantly different from each other, 
then this is evidence that the chain has not converged. The difference-of-means 
test is a simple z-ratio, though the standard error is estimated using the 
spectral density at zero to account for autocorrelation in the chain.
</p>


<h3>Value</h3>

<p>A <code>matrix</code> in which the first row consists of z-scores for tests 
of equal means for the first and last parts of the chain. The second row 
consists of the corresponding p-values. Each column of the matrix represents 
another parameter. For each column, a significant result is evidence that the 
chain has not converged for that parameter. Thus, a non-significant result 
is desired.
</p>


<h3>References</h3>

<p>John Geweke. 1992. &quot;Evaluating the Accuracy of Sampling-Based Approaches to 
the Calculation of Posterior Moments.&quot; In <em>Bayesian Statistics 4</em>, ed. 
J.M. Bernardo, J.O. Berger, A.P. Dawid, and A.F.M. Smith. Oxford: Clarendon 
Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+geweke.krige">geweke.krige</a></code>, <code><a href="#topic+geweke.summary.krige">geweke.summary.krige</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load Data
data(ContrivedData)

# Set seed
set.seed(1241060320)

M &lt;- 100

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
  data = ContrivedData, n.iter = M, range.tol = 0.05)

geweke(contrived.run, early.prop=0.5)
geweke(summary(contrived.run), early.prop=0.5)
geweke(contrived.run$mcmc.mat, early.prop=0.5)
# Note that the default proportions in the geweke() is more typical for longer run.

## End(Not run)

</code></pre>

<hr>
<h2 id='heidel.welch'>Heidelberger and Welch Diagnostic for MCMC</h2><span id='topic+heidel.welch'></span><span id='topic+heidel.welch.krige'></span><span id='topic+heidel.welch.summary.krige'></span><span id='topic+heidel.welch.default'></span>

<h3>Description</h3>

<p>Conducts a Heidelberger and Welch convergence diagnostic on MCMC iterations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heidel.welch(object, pvalue)

## S3 method for class 'krige'
heidel.welch(object, pvalue = 0.05)

## S3 method for class 'summary.krige'
heidel.welch(object, pvalue = 0.05)

## Default S3 method:
heidel.welch(object, pvalue = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="heidel.welch_+3A_object">object</code></td>
<td>
<p>An matrix or <code>krige</code>/<code>summary.krige</code> object for which 
a Heidelberger and Welch diagnostic is desired</p>
</td></tr>
<tr><td><code id="heidel.welch_+3A_pvalue">pvalue</code></td>
<td>
<p>Alpha level for significance tests. Defaults to 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function currently works with <code>matrix</code>, <code>krige</code>, 
and <code>summary.krige</code> objects. It is a simplified version of the Heidelberger 
and Welch test for use with this package.
</p>
<p>This is an adaptation of a function in Plummer et al.'s <code>coda</code> package. 
Heidelberger and Welch's (1993) test for nonconvergence. This version of the 
diagnostic only reports a Cramer-von Mises test and its corresponding p-value 
to determine if the chain is weakly stationary with comparisons of early 
portions of the chain to the end of the chain.
</p>


<h3>Value</h3>

<p>A <code>matrix</code> in which the first row consists of the values of the 
Cramer-von Mises test statistic for each parameter, and the second row consists 
of the corresponding p-values. Each column of the matrix represents another 
parameter of interest. A significant result serves as evidence of nonconvergence, 
so non-significant results are desired.
</p>


<h3>References</h3>

<p>Philip Heidelberger and Peter D. Welch. 1993. &quot;Simulation Run Length Control 
in the Presence of an Initial Transient.&quot; <em>Operations Research</em> 31:1109-1144.
</p>
<p>Martyn Plummer, Nicky Best, Kate Cowles and Karen Vines. 2006. &quot;CODA: Convergence 
Diagnosis and Output Analysis for MCMC.&quot; <em>R News</em> 6:7-11.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heidel.welch.krige">heidel.welch.krige</a></code>, <code><a href="#topic+heidel.welch.summary.krige">heidel.welch.summary.krige</a></code>, 
<code><a href="#topic+geweke">geweke</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load Data
data(ContrivedData)

# Set seed
set.seed(1241060320)

M &lt;- 100

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
  data = ContrivedData, n.iter = M, n.burnin = 20, range.tol = 0.05)

heidel.welch(contrived.run)
heidel.welch(summary(contrived.run))
heidel.welch(contrived.run$mcmc.mat)

## End(Not run)

</code></pre>

<hr>
<h2 id='krige'>krige: Geospatial Kriging with Metropolis Sampling</h2><span id='topic+krige'></span>

<h3>Description</h3>

<p>Estimates kriging models for geographical point-referenced data. Method is described '
in Gill (2020) &lt;doi:10.1177/1532440020930197&gt;.
</p>

<hr>
<h2 id='krige.posterior'>Posterior Distribution for the Kriging Process</h2><span id='topic+krige.posterior'></span>

<h3>Description</h3>

<p>This function finds the posterior density of a geospatial linear regression 
model given a point-referenced geospatial dataset and a set of parameter values. 
The function is useful for finding the optimum of or for sampling from the posterior 
distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>krige.posterior(
  tau2,
  phi,
  sigma2,
  beta,
  y,
  X,
  east,
  north,
  semivar.exp = 2,
  p.spatial.share = 0.5,
  p.range.share = 0.5,
  p.range.tol = 0.05,
  p.beta.var = 10,
  tot.var = var(y),
  local.Sigma = NULL,
  max.distance = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="krige.posterior_+3A_tau2">tau2</code></td>
<td>
<p>Value of the nugget, or non-spatial error variance.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_phi">phi</code></td>
<td>
<p>Value of the decay term, driving the level of spatial correlation.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_sigma2">sigma2</code></td>
<td>
<p>Value of the partial sill, or maximum spatial error variance.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_beta">beta</code></td>
<td>
<p>Coefficients from linear model.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_y">y</code></td>
<td>
<p>The outcome variable that is used in the kriging model.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_x">X</code></td>
<td>
<p>The matrix of explanatory variables used in the kriging model.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_east">east</code></td>
<td>
<p>Vector of eastings for all observations.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_north">north</code></td>
<td>
<p>Vector of northings for all observations.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_semivar.exp">semivar.exp</code></td>
<td>
<p>This exponent, which must be greater than 0 and less than or 
equal to 2, specifies a powered exponential correlation structure for the data. 
One widely used specification is setting this to 1, which yields an exponential 
correlation structure. Another common specification is setting this to 2 (the 
default), which yields a Gaussian correlation structure.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_p.spatial.share">p.spatial.share</code></td>
<td>
<p>Prior for proportion of unexplained variance that is spatial 
in nature. Must be greater than 0 and less than 1. Defaults to an even split.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_p.range.share">p.range.share</code></td>
<td>
<p>Prior for the effective range term, as a proportion of the 
maximum distance in the data. Users should choose the proportion of distance 
at which they think the spatial correlation will become negligible. Must be 
greater than 0. Values greater than 1 are permitted, but users should recognize 
that this implies that meaningful spatial correlation would persist outside 
of the convex hull of data. Defaults to half the maximum distance.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_p.range.tol">p.range.tol</code></td>
<td>
<p>Tolerance term for setting the effective range. At the distance 
where the spatial correlation drops below this term, it is judged that the 
effective range has been met. Users are typically advised to leave this at 
its default value of 0.05 unless they have strong reasons to choose another 
level. Must be greater than 0 and less than 1.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_p.beta.var">p.beta.var</code></td>
<td>
<p>Prior for the variance on zero-meaned normal priors on the 
regression coefficients. Defaults to 10.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_tot.var">tot.var</code></td>
<td>
<p>Combined variance between the nugget and partial sill. Defaults 
to the variance of y. The <code>metropolis.krige</code> function inserts the residual 
variance from a standard linear model.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_local.sigma">local.Sigma</code></td>
<td>
<p>The user is advised to ignore this option, or leave it the 
value of <code>NULL</code>. This option is included to reduce the number of computations 
required when this function is called by <code>metropolis.krige</code>.</p>
</td></tr>
<tr><td><code id="krige.posterior_+3A_max.distance">max.distance</code></td>
<td>
<p>The user is advised to ignore this option, or leave it the 
value of <code>NULL</code>. This option is included to reduce the number of computations 
required when this function is called by <code>metropolis.krige</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the posterior density for a kriging model. It is 
designed to be an internal function but is exported in the hope of it can be 
useful to some users. The function utilizes information provided about the 
parameters <code>tau2</code>, <code>phi</code>, <code>sigma2</code>, and <code>beta</code>. It also 
utilizes the observed data <code>y</code>, <code>X</code>, <code>east</code>, and <code>north</code>. 
Given a set of parameter values as well as the observed data, the function 
returns the posterior density for the specified model.
</p>


<h3>Value</h3>

<p>A single number that is the posterior density of the function, which is 
stored in object of class <code>matrix</code>.
</p>


<h3>References</h3>

<p>Jeff Gill. 2020. Measuring Constituency Ideology Using Bayesian Universal Kriging. 
<em>State Politics &amp; Policy Quarterly</em>. <code>doi:10.1177/1532440020930197</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Summarize Data
summary(ContrivedData)

#Initial OLS Model
contrived.ols&lt;-lm(y~x.1+x.2,data=ContrivedData);summary(contrived.ols)

#Define Covariate Matrix
covariates&lt;-cbind(1,ContrivedData$x.1,ContrivedData$x.2)

# Find the posterior density for the Contrived Data if all parameters were 1:
s.test &lt;- krige.posterior(tau2=1,phi=1,sigma2=1,beta=rep(1,ncol(covariates)), 
  y=ContrivedData$y,X=covariates,east=ContrivedData$s.1,north=ContrivedData$s.2)

# Print posterior density
s.test

</code></pre>

<hr>
<h2 id='lowerCombined'>State Legislative District (Lower Chambers) Public Opinion Ideology in 2010</h2><span id='topic+lowerCombined'></span>

<h3>Description</h3>

<p>These data present measures of ideology in 2010 for the districts for lower 
chambers of state legislatures, recorded as the variable <code>krige.lower</code>. 
49 states' chambers are covered&ndash;the Nebraska Unicameral is omitted here to be 
included in the file <code>upperCombined</code>. Forecasts are based on a kriging model 
fitted over the 2008 Cooperative Congressional Election Survey (CCES), paired 
with predictive data from the 2010 Census. Each district's public ideology is 
paired with a measure of the ideology of the State House member (or members) 
from the district (update from Shor and McCarty 2011).
</p>


<h3>Format</h3>

<p>The <code>lowerCombined</code> dataset has 5446 observations and 10 variables.
</p>

<dl>
<dt><code>st</code></dt><dd><p>Two-letter postal abbreviation for the state.</p>
</dd>
<dt><code>lower</code></dt><dd><p>The state legislative district number (lower chamber).</p>
</dd>     		
<dt><code>STATEA</code></dt><dd><p>The FIPS code for the state.</p>
</dd>
<dt><code>krige.lower</code></dt><dd><p>The ideology of the average citizen in the district.</p>
</dd>
<dt><code>lowerKluge</code></dt><dd><p>Combined index of <code>STATEA</code> followed by <code>lower</code>.</p>
</dd>
<dt><code>krige.lower.var</code></dt><dd><p>The variance of ideology among the district's citizens.</p>
</dd>
<dt><code>name</code></dt><dd><p>Last name of the state legislator, followed by first name and middle initial.</p>
</dd>
<dt><code>party</code></dt><dd><p>Political party of the legislator. D=Democrat, R=Republican, X=Other.</p>
</dd>
<dt><code>st_id</code></dt><dd><p>Temporary identifer variable. DO NOT USE.</p>
</dd>
<dt><code>np_score</code></dt><dd><p>Ideology score for the state legislator (lower chamber). 
Higher values are usually interpreted as more right-wing, with lower values as more left-wing.</p>
</dd>
</dl>



<h3>Source</h3>


<p>Ansolabehere, Stephen. 2011. &quot;CCES, Common Content, 2008.&quot; Ver. 4.
</p>
<p>Minnesota Population Center. 2011. <em>National Historical Geographic Information 
System: Version 2.0.</em> Minneapolis, MN: University of Minnesota. &lsquo;<span class="samp">&#8288;https://www.nhgis.org&#8288;</span>&rsquo;
</p>
<p>Shor, Boris and Nolan M. McCarty. 2011. &quot;The Ideological Mapping of American Legislatures.&quot; 
<em>American Political Science Review</em> 105(3):530-551.

</p>


<h3>References</h3>

<p>Jeff Gill. 2020. Measuring Constituency Ideology Using Bayesian Universal Kriging. 
<em>State Politics &amp; Policy Quarterly</em>. <code>doi:10.1177/1532440020930197</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Descriptive Statistics
summary(lowerCombined)

# Correlate Senators' DW-NOMINATE Scores with Public Opinion Ideology
cor(lowerCombined$np_score,lowerCombined$krige.lower,use="complete.obs")

# Plot Legislators' DW-NOMINATE Scores against Public Opinion Ideology
plot(y=lowerCombined$np_score,x=lowerCombined$krige.lower,
     xlab="District Ideology (Kriging)", ylab="Legislator Ideology (Shor &amp; McCarty)", 
     main="State Legislatures: Lower Chambers", type="n")#
points(y=lowerCombined$np_score[lowerCombined$party=="R"],
       x=lowerCombined$krige.lower[lowerCombined$party=="R"],pch=".",col="red")
points(y=lowerCombined$np_score[lowerCombined$party=="D"],
       x=lowerCombined$krige.lower[lowerCombined$party=="D"],pch=".",col="blue")    
</code></pre>

<hr>
<h2 id='mcmc.samples'>Extract MCMC Samples</h2><span id='topic+mcmc.samples'></span><span id='topic+mcmc.samples.krige'></span><span id='topic+mcmc.samples.summary.krige'></span><span id='topic+as.matrix.krige'></span><span id='topic+as.matrix.summary.krige'></span><span id='topic+as.data.frame.krige'></span><span id='topic+as.data.frame.summary.krige'></span>

<h3>Description</h3>

<p>Extract MCMC samples estimated by <code>metropolis.krige()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc.samples(object, as.matrix, as.data.frame, ...)

## S3 method for class 'krige'
mcmc.samples(object, as.matrix = !as.data.frame, as.data.frame = FALSE, ...)

## S3 method for class 'summary.krige'
mcmc.samples(object, as.matrix = !as.data.frame, as.data.frame = FALSE, ...)

## S3 method for class 'krige'
as.matrix(x, ...)

## S3 method for class 'summary.krige'
as.matrix(x, ...)

## S3 method for class 'krige'
as.data.frame(x, ...)

## S3 method for class 'summary.krige'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcmc.samples_+3A_object">object</code></td>
<td>
<p>A <code>krige</code>or <code>summary.krige</code> object from the <code>metropolis.krige</code> function.</p>
</td></tr>
<tr><td><code id="mcmc.samples_+3A_as.matrix">as.matrix</code></td>
<td>
<p>Logical values indicating if the output format should be a matrix. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="mcmc.samples_+3A_as.data.frame">as.data.frame</code></td>
<td>
<p>Logical values indicating if the output format should be a 
data.frame. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mcmc.samples_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>as.matrix</code> or <code>as.data.frame</code> methods.</p>
</td></tr>
<tr><td><code id="mcmc.samples_+3A_x">x</code></td>
<td>
<p>A <code>krige</code> or <code>summary.krige</code> object for <code>as.matrix</code> and <code>as.data.frame</code> methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function extracts the MCMC samples from the a <code>krige</code>or <code>summary.krige</code> 
object from the <code>metropolis.krige</code> function. Users can define the output by using <code>as.matrix</code>
or <code>as.data.frame</code>.
</p>


<h3>Value</h3>

<p>A <code>summary.krige</code> list object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.mcmc.krige">as.mcmc.krige</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize Data
summary(ContrivedData)

# Initial OLS model
contrived.ols&lt;-lm(y~x.1+x.2,data=ContrivedData)
# summary(contrived.ols)

# Set seed
set.seed(1241060320)

M &lt;- 100
#M&lt;-10000

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
   data = ContrivedData, n.iter = M, n.burnin = 20, range.tol = 0.05)
   
contrived.run.mat &lt;- mcmc.samples(contrived.run)

### Alternatively, use generic methods
contrived.run.mat &lt;- as.matrix(contrived.run)
contrived.run.df &lt;- as.data.frame(contrived.run)

## End(Not run)

</code></pre>

<hr>
<h2 id='metropolis.krige'>Sampling Technique Using Metropolis-Hastings</h2><span id='topic+metropolis.krige'></span>

<h3>Description</h3>

<p>This function performs Metropolis-Hastings sampling for a linear model specified 
over point-referenced geospatial data. It returns MCMC iterations, with which 
results of the geospatial linear model can be summarized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metropolis.krige(
  formula,
  coords,
  data,
  n.iter = 100,
  powered.exp = 2,
  n.burnin = 0,
  y,
  X,
  east,
  north,
  na.action = "na.fail",
  spatial.share = 0.5,
  range.share = 0.5,
  beta.var = 10,
  range.tol = 0.05,
  b.tune = 1,
  nugget.tune = 10,
  psill.tune = 1,
  distance.matrix = FALSE,
  progress.bar = "message",
  accept.rate.warning = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="metropolis.krige_+3A_formula">formula</code></td>
<td>
<p>An object of class <code><a href="stats.html#topic+formula">formula</a></code> (or one 
that can be coerced to that classes). A symbolic description of the model to 
be fitted. Alternatively, the model can be specified in <code>y</code> (a vector of
the outcome variable) and <code>X</code> (a matrix of explanatory variables).</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_coords">coords</code></td>
<td>
<p>A matrix of coordinates for all observations or a vector of variable 
names indicating the coordinates variables in the data. Alternatively, the 
coordinates can also be specified seperately using <code>east</code> and <code>north</code>.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_data">data</code></td>
<td>
<p>An data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of MCMC iterations (defaults to 100).</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_powered.exp">powered.exp</code></td>
<td>
<p>This exponent, which must be greater than 0 and less than 
or equal to 2, specifies a powered exponential correlation structure for the 
data. One widely used specification is setting this to 1, which yields an 
exponential correlation structure. Another common specification is setting 
this to 2 (the default), which yields a Gaussian correlation structure.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_n.burnin">n.burnin</code></td>
<td>
<p>Number of iterations that will be discarded for burnin (warmup).
The number of burnin should not be larger than <code>n.iter</code> and the default is 0.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_y">y</code></td>
<td>
<p>Alternative specification for the outcome variable that is used in the 
kriging model. If formula is used, this argument will be suppressed.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_x">X</code></td>
<td>
<p>Alternative specification for the matrix of explanatory variables used 
in the kriging model. Different forms of the variables such as transformations 
and interactions also need to be specified accordingly beforehand.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_east">east</code></td>
<td>
<p>Alternative specification for the vector of eastings for all observations.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_north">north</code></td>
<td>
<p>Alternative specification for the vector of northing for all observations.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data 
contain NAs. The default is &quot;na.fail.&quot; Another possible value is &quot;na.omit.&quot;</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_spatial.share">spatial.share</code></td>
<td>
<p>Prior for proportion of unexplained variance that is spatial 
in nature. Must be greater than 0 and less than 1. Defaults to an even split, 
valued at 0.5.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_range.share">range.share</code></td>
<td>
<p>Prior for the effective range term, as a proportion of the 
maximum distance in the data. Users should choose the proportion of distance 
at which they think the spatial correlation will become negligible. Must be 
greater than 0. Values greater than 1 are permitted, but users should recognize 
that this implies that meaningful spatial correlation would persist outside 
of the convex hull of data. Defaults to half the maximum distance, valued at 0.5.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_beta.var">beta.var</code></td>
<td>
<p>Prior for the variance on zero-meaned normal priors on the 
regression coefficients. Must be greater than 0. Defaults to 10.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_range.tol">range.tol</code></td>
<td>
<p>Tolerance term for setting the effective range. At the distance 
where the spatial correlation drops below this term, it is judged that the 
effective range has been met. The default value is the commonly-used 0.05. 
Must be greater than 0 and less than 1.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_b.tune">b.tune</code></td>
<td>
<p>Tuning parameter for candidate generation of regression coefficients 
that must be greater than 0. A value of 1 means that draws will be based on 
the variance-covariance matrix of coefficients from OLS. Larger steps are taken 
for values greater than 1, and smaller steps are taken for values from 0 to 1. 
Defaults to 1.0.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_nugget.tune">nugget.tune</code></td>
<td>
<p>Tuning parameter for candidate generation of the nugget term 
(<code>tau2</code>) that must be greater than 0. A value of 1 means that draws will 
be based on the typical variance of an inverse gamma distribution. <em>Smaller</em> 
steps are taken for values <em>greater</em> than 1, and <em>larger</em> steps are 
taken for <em>decimal</em> values from 0 to 1. Defaults to 10.0.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_psill.tune">psill.tune</code></td>
<td>
<p>Tuning parameter for candidate generation of the partial sill 
term (<code>sigma2</code>) that must be greater than 0. A value of 1 means that draws 
will be based on the typical variance of an inverse gamma distribution. 
<em>Smaller</em> steps are taken for values <em>greater</em> than 1, and <em>larger</em> 
steps are taken for <em>decimal</em> values from 0 to 1. Defaults to 1.0.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_distance.matrix">distance.matrix</code></td>
<td>
<p>Logical value indicates whether to save the distance matrix 
in the output object. Saving distance matrix can save time for furthur use such as
in <code>update()</code> function but may results in larger file size. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_progress.bar">progress.bar</code></td>
<td>
<p>Types of progress bar. The default is &quot;message&quot; and will 
report variance terms. Other possible values are &quot;TRUE&quot; (simple percentage) 
and &quot;FALSE&quot; (suppress the progress bar).</p>
</td></tr>
<tr><td><code id="metropolis.krige_+3A_accept.rate.warning">accept.rate.warning</code></td>
<td>
<p>Logical values indicating whether to show the warnings 
when the acceptance rates are too high or too low. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Analysts should use this function if they want to estimate a linear 
regression model in which each observation can be located at points in geographic 
space. That is, each observation is observed for a set of coordinates in eastings 
&amp; northings or longitude &amp; latitude. 
</p>
<p>Researchers must specify their model in the following manner: <code>formula</code>
should be a symbolic description of the model to be fitted; it is similar to 
<code>R</code> model syntax as used in <code>lm()</code>. In addition, a matrix of 
coordinates must be specified for the geospatial model in <code>coords</code>. <code>coords</code>
should be a matrix with two columns that specify west-east and north-south 
coordinates, respectively (ideally eastings and northings but possibly longitude 
and latitude). It can also be a vector of strings indicating the variables names 
of the coordinates in the <code>data</code>. <code>data</code> should be a data frame 
containing the variables in the model including both the formula and coordinates 
(if only the names are provided). Alternatively, users can also specify the 
variables using <code>y</code>, <code>X</code>, <code>east</code>, and <code>north</code> for outcome, 
explanatory, west-east coordinates, and north-south coordinates variables, 
respectively. This alternative specification is compatible with the one used 
in the early version of this package.
</p>
<p><code>n.iter</code> is the number of iterations to sample from the posterior distribution 
using the Metropolis-Hastings algorithm. This defaults to 100 iterations, but 
many more iterations would normally be preferred. <code>n.burnin</code> is set to 0
by default to preserve all the iterations since the kriging model usually takes 
a relatively long time to run. Users can set a number for burnin or use <code>burnin</code>
function afterwards to discard the burnin period. The output of the function 
prints the proportion of candidate values for the coefficients and for the 
variance terms accepted by the Metropolis-Hastings algorithm. Particularly 
low or high acceptance rates respectively may indicate slow mixing (requiring 
more iterations) or a transient state (leading to nonconvergence), so additional 
messages will print for extreme acceptance rates. Users may want to adjust the 
tuning parameters <code>b.tune</code>, <code>nugget.tune</code>, or <code>psill.tune</code>, 
or perhaps the tolerance parameter <code>range.tol</code> if the acceptance rate 
is too high or too low.
</p>
<p>The function returns a &quot;krige&quot; list object including the output MCMC matrix
of sampled values from the posterior distribution as well as the record of 
function arguments, model frame, acceptance rates, and standing parameters. 
Users can use the generic <code>summary</code> function to summarize the results or
extract the elements of the object for further use.
</p>


<h3>Value</h3>

<p>An object of class <code>krige</code> that includes the output MCMC matrix
of sampled values from the posterior distribution as well as the record of 
function arguments, model frame, acceptance rates, and standing parameters.
</p>


<h3>References</h3>

<p>Jeff Gill. 2020. Measuring Constituency Ideology Using Bayesian Universal Kriging. 
<em>State Politics &amp; Policy Quarterly</em>. <code>doi:10.1177/1532440020930197</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize example data
summary(ContrivedData)

# Initial OLS model
contrived.ols&lt;-lm(y~x.1+x.2,data=ContrivedData)
# summary(contrived.ols)

# Set seed
set.seed(1241060320)

#For simple illustration, we set to few iterations.
#In this case, a 10,000-iteration run converges to the true parameters.
#If you have considerable time and hardware, delete the # on the next line.
#10,000 iterations took 39 min. with 8 GB RAM &amp; a 1.5 GHz Quad-Core processor.
M &lt;- 100
#M&lt;-10000

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
   data = ContrivedData, n.iter = M, n.burnin=20, range.tol = 0.05)
# Alternatively, use burnin() after estimation  
#contrived.run &lt;- burnin(contrived.run, n.burnin=20)

# Summarize the results and examine results against true coefficients	
summary(contrived.run)
(TRUTH&lt;-c(0.5,2.5,0.5,0,1,2))

# Extract the MCMC matrix of the posterior distribution
contrived.run.mat &lt;- mcmc.samples(contrived.run)
head(contrived.run.mat)

# Diagnostics
geweke(contrived.run, early.prop=0.5)
heidel.welch(contrived.run)

# Semivariogram
### Semivariance
semivariance(contrived.run)
### Plot semivariogram
semivariogram(contrived.run)
### Alternatively, use generic plot() on a krige object
plot(contrived.run)

## End(Not run)

</code></pre>

<hr>
<h2 id='NY_subset'>New York State CCES Respondents in 2008</h2><span id='topic+NY_subset'></span>

<h3>Description</h3>

<p>These data are a subset of the 2008 Cooperative Congressional Election Survey 
(CCES) Common Content. Only 1108 respondents from the state of New York are included, 
with predictors drawn from Gill's (2020) model of self-reported ideology. The 
CCES data are merged with predictors on geographic location based on ZIP codes 
(from ArcGIS &amp; TomTom) and county ruralism (from the USDA).
</p>


<h3>Format</h3>

<p>The <code>NY_subset</code> dataset has 1108 observations and 26 variables.
</p>

<dl>
<dt><code>state</code></dt><dd><p>The state abbreviation of the respondent's residence.</p>
</dd>
<dt><code>zip</code></dt><dd><p>The respondent's ZIP code.</p>
</dd>
<dt><code>age</code></dt><dd><p>The age of the respondent in years.</p>
</dd>
<dt><code>female</code></dt><dd><p>An indicator of whether the respondent is female.</p>
</dd>
<dt><code>ideology</code></dt><dd><p>The respondent's self-reported ideology on a scale of 0 (liberal) to 100 (conservative).</p>
</dd>
<dt><code>educ</code></dt><dd><p>The respondent's level of education. 0=No Highschool, 
1=High School Graduate, 2=Some College, 3=2-year Degree, 4=4-year degree, 5=Post-Graduate.</p>
</dd>
<dt><code>race</code></dt><dd><p>The respondent's race. 1=White, 2=African American, 3=Nonwhite &amp; nonblack.</p>
</dd>
<dt><code>empstat</code></dt><dd><p>The respondent's employment status. 1=employed, 2=unemployed, 3=not in workforce.</p>
</dd>
<dt><code>ownership</code></dt><dd><p>Indicator for whether the respondent owns his or her own home.</p>
</dd>
<dt><code>inc14</code></dt><dd><p>The respondent's self reported income. 1=Less than $10,000, 
2=$10,000-$14,999, 3=$15,000-$19,000, 4=$20,000-$24,999, 5=$25,000-$29,999, 
6=$30,000-$39,999, 7=$40,000-$49,999, 8=$50,000-$59,999, 9=$60,000-$69,999, 
10=$70,000-$79,999, 11=$80,000-$89,999, 12=$100,000-$119,999, 13=$120,000-$149,999, 
14=$150,000 or more.</p>
</dd>
<dt><code>catholic</code></dt><dd><p>Indicator for whether the respondent is Catholic.</p>
</dd>
<dt><code>mormon</code></dt><dd><p>Indicator for whether the respondent is Mormon.</p>
</dd>
<dt><code>orthodox</code></dt><dd><p>Indicator for whether the respondent is Orthodox Christian.</p>
</dd>
<dt><code>jewish</code></dt><dd><p>Indicator for whether the respondent is Jewish.</p>
</dd>
<dt><code>islam</code></dt><dd><p>Indicator for whether the respondent is Muslim.</p>
</dd>
<dt><code>mainline</code></dt><dd><p>Indicator for whether the respondent is Mainline Christian.</p>
</dd>
<dt><code>evangelical</code></dt><dd><p>Indicator for whether the respondent is Evangelical Christian.</p>
</dd>
<dt><code>FIPS_Code</code></dt><dd><p>FIPS code of the repondent's state.</p>
</dd>
<dt><code>rural</code></dt><dd><p>Nine-point USDA scale of the ruralism of each county, with 
0 meaning the most urban and 8 meaning the most rural.</p>
</dd>
<dt><code>zipPop</code></dt><dd><p>Indicates the population of the repondent's ZIP code.</p>
</dd>
<dt><code>zipLandKM</code></dt><dd><p>Indicates the land area in square kilometers of the repondent's ZIP code.</p>
</dd>
<dt><code>weight</code></dt><dd><p>Survey weights created by the CCES.</p>
</dd>
<dt><code>cd</code></dt><dd><p>The congressional district the respondent resides in.</p>
</dd>
<dt><code>fipsCD</code></dt><dd><p>Index that fuses the state FIPS code in the first two 
digits and the congressional district number in the last two digits.</p>
</dd>
<dt><code>northings</code></dt><dd><p>Indicates the geographical location of the respondent in kilometer-based northings.</p>
</dd>
<dt><code>eastings</code></dt><dd><p>Indicates the geographical location of the respondent in kilometer-based eastings.</p>
</dd>
</dl>



<h3>Source</h3>


<p>Ansolabehere, Stephen. 2011. &quot;CCES, Common Content, 2008.&quot; Ver. 4.
</p>
<p>ArcGIS. 2012. &quot;USA ZIP Code Areas.&quot;  <a href="https://www.arcgis.com/home/item.html?id=8d2012a2016e484dafaac0451f9aea24">https://www.arcgis.com/home/item.html?id=8d2012a2016e484dafaac0451f9aea24</a>
</p>
<p>United States Department of Agriculture. 2013. &quot;2013 Rural-Urban Continuum Codes.&quot; <a href="https://www.ers.usda.gov/data-products/rural-urban-continuum-codes.aspx">https://www.ers.usda.gov/data-products/rural-urban-continuum-codes.aspx</a>

</p>


<h3>References</h3>

<p>Jeff Gill. 2020. Measuring Constituency Ideology Using Bayesian Universal Kriging. 
<em>State Politics &amp; Policy Quarterly</em>. <code>doi:10.1177/1532440020930197</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ny &lt;- NY_subset

#data cleaning
ny$cathOrth&lt;-ny$catholic+ny$orthodox
ny$consRelig&lt;-ny$mormon+ny$evangelical
ny$jewMus&lt;-ny$jewish+ny$islam

# Explanatory Variable Matrix
psrm.data &lt;-cbind(ny$age, ny$educ, I(ny$age*ny$educ), as.numeric(ny$race==2), 
       as.numeric(ny$race==3), ny$female, I(as.numeric(ny$race==2)*ny$female), 
       I(as.numeric(ny$race==3)*ny$female), ny$cathOrth, ny$consRelig, 
       ny$jewMus, ny$mainline, ny$rural, ny$ownership, 
       as.numeric(ny$empstat==2), as.numeric(ny$empstat==3),ny$inc14)

dimnames(psrm.data)[[2]] &lt;- c("Age", "Education", "Age.education", 
                             "African.American", "Nonwhite.nonblack","Female", 
                             "African.American.female", "Nonwhite.nonblack.female", 
                             "Catholic.Orthodox", "Evang.Mormon", "Jewish.Muslim", 
                             "Mainline","Ruralism", "Homeowner", "Unemployed",
                             "Not.in.workforce","Income")

# Outcome Variable
ideo &lt;- matrix(ny$ideology,ncol=1)

# Set Number of Iterations:
# WARNING: 20 iterations is intensive on many machines.
# This example was tuned on Amazon Web Services (EC2) over many hours
# with 20,000 iterations--unsuitable in 2020 for most desktop machines.
#M&lt;-20000 
M&lt;-100 
set.seed(1,kind="Mersenne-Twister")

# Estimate the Model
ny.fit &lt;- metropolis.krige(formula = ideo ~ psrm.data, coords = cbind(ny$eastings, ny$northings),
          powered.exp=1, n.iter=M, spatial.share=0.31,range.share=0.23,beta.var=10,
          range.tol=0.01, b.tune=0.1, nugget.tune=20, psill.tune=5)		
      
# Discard first 20% of Iterations as Burn-In (User Discretion Advised).
ny.fit &lt;- burnin(ny.fit, M/5)

# Summarize Results
summary(ny.fit)

#Convergence Diagnostics: Geweke and Heidelberger-Welch
geweke(ny.fit)
heidel.welch(ny.fit)

# Draw Semivariogram
semivariogram(ny.fit)

## End(Not run)     
</code></pre>

<hr>
<h2 id='NYcity_subset'>New York City CCES Respondents in 2008</h2><span id='topic+NYcity_subset'></span>

<h3>Description</h3>

<p>These data are a subset of the 2008 Cooperative Congressional Election Survey 
(CCES) Common Content. Only 568 respondents from New York City are included, 
with predictors drawn from Gill's (2020) model of self-reported ideology. The 
CCES data are merged with predictors on geographic location based on ZIP codes 
(from ArcGIS &amp; TomTom) and county ruralism (from the USDA).
</p>


<h3>Format</h3>

<p>The <code>NYcity_subset</code> dataset has 568 observations and 26 variables.
</p>

<dl>
<dt><code>state</code></dt><dd><p>The state abbreviation of the respondent's residence.</p>
</dd>
<dt><code>zip</code></dt><dd><p>The respondent's ZIP code.</p>
</dd>
<dt><code>age</code></dt><dd><p>The age of the respondent in years.</p>
</dd>
<dt><code>female</code></dt><dd><p>An indicator of whether the respondent is female.</p>
</dd>
<dt><code>ideology</code></dt><dd><p>The respondent's self-reported ideology on a scale of 0 (liberal) to 100 (conservative).</p>
</dd>
<dt><code>educ</code></dt><dd><p>The respondent's level of education. 0=No Highschool, 
1=High School Graduate, 2=Some College, 3=2-year Degree, 4=4-year degree, 5=Post-Graduate.</p>
</dd>
<dt><code>race</code></dt><dd><p>The respondent's race. 1=White, 2=African American, 3=Nonwhite &amp; nonblack.</p>
</dd>
<dt><code>empstat</code></dt><dd><p>The respondent's employment status. 1=employed, 2=unemployed, 3=not in workforce.</p>
</dd>
<dt><code>ownership</code></dt><dd><p>Indicator for whether the respondent owns his or her own home.</p>
</dd>
<dt><code>inc14</code></dt><dd><p>The respondent's self reported income. 1=Less than $10,000, 
2=$10,000-$14,999, 3=$15,000-$19,000, 4=$20,000-$24,999, 5=$25,000-$29,999, 
6=$30,000-$39,999, 7=$40,000-$49,999, 8=$50,000-$59,999, 9=$60,000-$69,999, 
10=$70,000-$79,999, 11=$80,000-$89,999, 12=$100,000-$119,999, 13=$120,000-$149,999, 
14=$150,000 or more.</p>
</dd>
<dt><code>catholic</code></dt><dd><p>Indicator for whether the respondent is Catholic.</p>
</dd>
<dt><code>mormon</code></dt><dd><p>Indicator for whether the respondent is Mormon.</p>
</dd>
<dt><code>orthodox</code></dt><dd><p>Indicator for whether the respondent is Orthodox Christian.</p>
</dd>
<dt><code>jewish</code></dt><dd><p>Indicator for whether the respondent is Jewish.</p>
</dd>
<dt><code>islam</code></dt><dd><p>Indicator for whether the respondent is Muslim.</p>
</dd>
<dt><code>mainline</code></dt><dd><p>Indicator for whether the respondent is Mainline Christian.</p>
</dd>
<dt><code>evangelical</code></dt><dd><p>Indicator for whether the respondent is Evangelical Christian.</p>
</dd>
<dt><code>FIPS_Code</code></dt><dd><p>FIPS code of the repondent's state.</p>
</dd>
<dt><code>rural</code></dt><dd><p>Nine-point USDA scale of the ruralism of each county, with 
0 meaning the most urban and 8 meaning the most rural.</p>
</dd>
<dt><code>zipPop</code></dt><dd><p>Indicates the population of the repondent's ZIP code.</p>
</dd>
<dt><code>zipLandKM</code></dt><dd><p>Indicates the land area in square kilometers of the repondent's ZIP code.</p>
</dd>
<dt><code>weight</code></dt><dd><p>Survey weights created by the CCES.</p>
</dd>
<dt><code>cd</code></dt><dd><p>The congressional district the respondent resides in.</p>
</dd>
<dt><code>fipsCD</code></dt><dd><p>Index that fuses the state FIPS code in the first two 
digits and the congressional district number in the last two digits.</p>
</dd>
<dt><code>northings</code></dt><dd><p>Indicates the geographical location of the respondent in kilometer-based northings.</p>
</dd>
<dt><code>eastings</code></dt><dd><p>Indicates the geographical location of the respondent in kilometer-based eastings.</p>
</dd>
</dl>



<h3>Source</h3>


<p>Ansolabehere, Stephen. 2011. &quot;CCES, Common Content, 2008.&quot; Ver. 4.
</p>
<p>ArcGIS. 2012. &quot;USA ZIP Code Areas.&quot;  <a href="https://www.arcgis.com/home/item.html?id=8d2012a2016e484dafaac0451f9aea24">https://www.arcgis.com/home/item.html?id=8d2012a2016e484dafaac0451f9aea24</a>
</p>
<p>United States Department of Agriculture. 2013. &quot;2013 Rural-Urban Continuum Codes.&quot; <a href="https://www.ers.usda.gov/data-products/rural-urban-continuum-codes.aspx">https://www.ers.usda.gov/data-products/rural-urban-continuum-codes.aspx</a>

</p>


<h3>References</h3>

<p>Jeff Gill. 2020. Measuring Constituency Ideology Using Bayesian Universal Kriging. 
<em>State Politics &amp; Policy Quarterly</em>. <code>doi:10.1177/1532440020930197</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>        
## Not run: 
nyc &lt;- NYcity_subset

#data cleaning
nyc$cathOrth&lt;-nyc$catholic+nyc$orthodox
nyc$consRelig&lt;-nyc$mormon+nyc$evangelical
nyc$jewMus&lt;-nyc$jewish+nyc$islam

# Explanatory Variable Matrix
psrm.data &lt;-cbind(nyc$age, nyc$educ, I(nyc$age*nyc$educ), as.numeric(nyc$race==2), 
       as.numeric(nyc$race==3), nyc$female, I(as.numeric(nyc$race==2)*nyc$female), 
       I(as.numeric(nyc$race==3)*nyc$female), nyc$cathOrth, nyc$consRelig, 
       nyc$jewMus, nyc$mainline, nyc$rural, nyc$ownership, 
       as.numeric(nyc$empstat==2), as.numeric(nyc$empstat==3),nyc$inc14)

dimnames(psrm.data)[[2]] &lt;- c("Age", "Education", "Age.education", 
                             "African.American", "Nonwhite.nonblack","Female", 
                             "African.American.female", "Nonwhite.nonblack.female", 
                             "Catholic.Orthodox", "Evang.Mormon", "Jewish.Muslim", 
                             "Mainline","Ruralism", "Homeowner", "Unemployed",
                             "Not.in.workforce","Income")

# Outcome Variable
ideo &lt;- matrix(nyc$ideology,ncol=1)

# WARNING: This example was tuned on Amazon Web Services (EC2) over many hours
# with 150,000 iterations--a strain in 2020 for most desktop machines.
# A test with few iterations allows illustration.
#M&lt;-150000 
M&lt;-150 
set.seed(1,kind="Mersenne-Twister")

# Estimate the Model
nyc.fit &lt;- metropolis.krige(formula = ideo ~ psrm.data, coords = cbind(nyc$eastings, nyc$northings),
          powered.exp=1, n.iter=M, spatial.share=0.31,range.share=0.23,beta.var=10,
          range.tol=0.01, b.tune=0.1, nugget.tune=20, psill.tune=5)		
      
# Discard first 20% of Iterations as Burn-In (User Discretion Advised).
nyc.fit &lt;- burnin(nyc.fit, M/5)

# Summarize Results
summary(nyc.fit)

#Convergence Diagnostics: Geweke and Heidelberger-Welch
geweke(nyc.fit)
heidel.welch(nyc.fit)

# Draw Semivariogram
semivariogram(nyc.fit)

## End(Not run)     
</code></pre>

<hr>
<h2 id='predict.krige'>Predictions by Kriging</h2><span id='topic+predict.krige'></span>

<h3>Description</h3>

<p>This function uses the results of a model estimated by <code>metropolis.krige</code> 
to make kriging-based predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'krige'
predict(object, newdata, credible = FALSE, new.X, new.east, new.north, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.krige_+3A_object">object</code></td>
<td>
<p>An <code>krige</code> object estimated by <code>metropolis.krige</code>.</p>
</td></tr>
<tr><td><code id="predict.krige_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with which 
to predict. If omitted, the fitted values are produced. Alternatively, the new 
data can be specified using <code>new.X</code>, <code>new.east</code>, and <code>new.north</code>.</p>
</td></tr>
<tr><td><code id="predict.krige_+3A_credible">credible</code></td>
<td>
<p>If a credible interval on predictions is desired, a user may 
specify a proportion between 0 and 1 to indicate the interval probability. 
For example, a value of 0.9 would create a 90% credible interval. If <code>NULL</code>, 
then no credible interval will be produced.</p>
</td></tr>
<tr><td><code id="predict.krige_+3A_new.x">new.X</code></td>
<td>
<p>The matrix of independent variables for observations to be predicted.</p>
</td></tr>
<tr><td><code id="predict.krige_+3A_new.east">new.east</code></td>
<td>
<p>Vector of eastings for observations to be predicted.</p>
</td></tr>
<tr><td><code id="predict.krige_+3A_new.north">new.north</code></td>
<td>
<p>Vector of northings for observations to be predicted.</p>
</td></tr>
<tr><td><code id="predict.krige_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>predict</code> methods. Not supported 
for <code>krige</code> objects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Analysts should use this function if they want to make kriged predictions 
for observations at new locations or predict fitted values at original locations. 
To do this, researchers first must estimate a model using the <code>metropolis.krige</code> 
function.
</p>
<p>After estimating the model, a <code>krige</code> object can provide information from 
the model fitted with <code>metropolis.krige</code>, including the original imput 
data, coordinates, and the model results themselves. The prediction will also 
use the same <code>powered.exp</code>. <code>new.data</code> can be specified for predicting 
the observations at new location. Otherwise, the fitted values for the original 
data and locations will be produced.
</p>
<p>By default, the function uses median values of parameters to make a single point 
prediction for every kriged data point. However, if the uses specifies a probability 
with the <code>credible</code> option, then the function will determine the predictions 
for all iterations of the MCMC sample. The point estimates will then be a median 
of these predictions, and a credible interval will be returned based on percentiles. 
Note that estimating a credible interval is substantially more intensive computationally, 
but has the benefit of reporting uncertainty in predictions.
</p>


<h3>Value</h3>

<p>An object of class <code>matrix</code> with one prediction per row. By default 
the matrix has one column, as only point predictions are returned. If the <code>credible</code> 
option is specified, there are three columns respectively indicating a point 
estimate (median prediction from MCMC), lower bound of the credible interval, 
and upper bound of the credible interval.
</p>


<h3>References</h3>

<p>Jeff Gill. 2020. Measuring Constituency Ideology Using Bayesian Universal Kriging. 
<em>State Politics &amp; Policy Quarterly</em>. <code>doi:10.1177/1532440020930197</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize Data
summary(ContrivedData)

# Initial OLS model
contrived.ols&lt;-lm(y~x.1+x.2,data=ContrivedData)
# summary(contrived.ols)

# Set seed
set.seed(1241060320)

M &lt;- 100
#M&lt;-10000

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
   data = ContrivedData, n.iter = M, range.tol = 0.05)
   
# Predict fitted values
predict(contrived.run)

# Predict new data
euler&lt;-c(0.2,0.7)
archimedes&lt;-c(0.3,0.1)
pythagoras&lt;-c(0.1,0.4)
mathematicians&lt;-rbind(euler,archimedes,pythagoras)
basel&lt;-c(0.1,0.8)
sicily&lt;-c(0.4,0.1)
samos&lt;-c(0.1,0.4)
new.locations&lt;-rbind(basel,sicily,samos)
newDf &lt;- as.data.frame(cbind(mathematicians, new.locations))
colnames(newDf) &lt;- c("x.1", "x.2", "s.1", "s.2")

# Make predictions from median parameter values:
(median.pred &lt;- predict(contrived.run, newdata = newDf))

# Make predictions with 90\
(cred.pred &lt;- predict(contrived.run, newdata = newDf, credible=0.9))

## End(Not run)

</code></pre>

<hr>
<h2 id='semivariance'>Semivariance for Geospatial Data</h2><span id='topic+semivariance'></span><span id='topic+semivariance.krige'></span><span id='topic+semivariance.lm'></span><span id='topic+semivariance.default'></span>

<h3>Description</h3>

<p>This function computes the empirical semivariance for a spatially-distributed 
variable. Based on the user's chosen level of coarsening, the semivariance is 
presented for various distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semivariance(object, ...)

## S3 method for class 'krige'
semivariance(object, bins = 13, terms = "all", plot = FALSE, ...)

## S3 method for class 'lm'
semivariance(
  object,
  bins = 13,
  coords,
  terms = c("raw", "residual"),
  east,
  north,
  plot = FALSE,
  ...
)

## Default S3 method:
semivariance(object, bins = 13, coords, data, east, north, plot = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="semivariance_+3A_object">object</code></td>
<td>
<p>An object for which the semivariance is desired. The object can 
be a <code>krige</code> object, a <code>lm</code> object, or a vector of variables (or 
variable names in the <code>data</code>).</p>
</td></tr>
<tr><td><code id="semivariance_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>semivariance</code> methods.</p>
</td></tr>
<tr><td><code id="semivariance_+3A_bins">bins</code></td>
<td>
<p>Number of bins into which distances should be divided. The observed 
distances will be split at equal intervals, and the semivariance will be computed 
within each interval. Defaults to 13 intervals.</p>
</td></tr>
<tr><td><code id="semivariance_+3A_terms">terms</code></td>
<td>
<p>A vector of strings specifies for which the semivariogram is created. 
Options are &quot;raw&quot; (the semivariogram for raw data), &quot;residual&quot; (the semivariogram
for residuals from linear regression).</p>
</td></tr>
<tr><td><code id="semivariance_+3A_plot">plot</code></td>
<td>
<p>Logical values indicates whether a graph of the empirical semivariogram 
should be presented with a run of the function. Default omits the plot and only 
returns semivariance values. See <code><a href="#topic+semivariogram">semivariogram</a></code> for additional 
plotting functions.</p>
</td></tr>
<tr><td><code id="semivariance_+3A_coords">coords</code></td>
<td>
<p>A matrix of coordinates for all observations or a vector of variable 
names indicating the coordinates variables in the data. Alternatively, the 
coordinates can also be specified separately using <code>east</code> and <code>north</code>.</p>
</td></tr>
<tr><td><code id="semivariance_+3A_east">east</code></td>
<td>
<p>Alternative specification for the vector of eastings for all observations.</p>
</td></tr>
<tr><td><code id="semivariance_+3A_north">north</code></td>
<td>
<p>Alternative specification for the vector of northing for all observations.</p>
</td></tr>
<tr><td><code id="semivariance_+3A_data">data</code></td>
<td>
<p>If object is a variable name, a data frame must be provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Semivariance is equal to half of the variance of the difference in a 
variable's values at a given distance. That is, the semivariance is defined 
as: <code class="reqn">\gamma(h)=0.5*E[X(s+h)-X(s)]^2</code>, where <code class="reqn">X</code> is the variable of 
interest, s is a location, and h is the distance from s to another location.
</p>
<p>The function can be applied to a variable, a fitted linear model (<code>lm</code> 
object) before fitting a spatial model or to a <code>krige</code> object or <code>semivariance</code>
object to assess the model fit. When applying to a variable, it will describes 
the raw data; for a <code>lm</code> object, the default will present empirical 
semivariogram for both the raw data and linear residuals. Users can also specify 
which semivariance is needed in the <code>terms</code> argument if there are multiple 
kinds of semivariogram can be plotted. A <code>semivariance</code> object can also 
be used to create semivariogram afterwards using generic <code>plot</code> function 
with more options.
</p>


<h3>Value</h3>

<p>A semivariance object. It will be a numeric vector with each bin's value 
of the semivariance if only one kind of semivariance is computed; a list including 
different kinds of semivariance if both raw and residual semivariance is computed.
</p>


<h3>References</h3>

<p>Sudipto Banerjee, Bradley P. Carlin, and Alan E. Gelfand. 2015. <em>Hierarchical 
Modeling and Analysis for Spatial Data</em>. 2nd ed. Boca Raton, FL: CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+semivariogram">semivariogram</a></code>, <code><a href="#topic+plot.semivariance">plot.semivariance</a></code>, <code><a href="#topic+exponential.semivariance">exponential.semivariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize example data
summary(ContrivedData)

# Empirical semivariance for variable y
semivariance(ContrivedData$y,coords = cbind(ContrivedData$s.1, ContrivedData$s.2))

# Initial OLS Model
contrived.ols&lt;-lm(y~x.1+x.2,data=ContrivedData); summary(contrived.ols)

# Empirical semivariance for ols fit
(sv.ols &lt;- semivariance(contrived.ols, coords = c("s.1","s.2"), bins=13))
plot(sv.ols)

# Estimation using metropolis.krige()
# Set seed
set.seed(1241060320)

M &lt;- 100

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
  data = ContrivedData, n.iter = M, range.tol = 0.05)
  
# Parametric semivariance
(sv.krige &lt;- semivariance(contrived.run, plot = TRUE))

# Convert to other format for further use
as.matrix(sv.krige)
as.data.frame(sv.krige)

## End(Not run)

</code></pre>

<hr>
<h2 id='semivariogram'>Semivariogram for Geospatial Data</h2><span id='topic+semivariogram'></span><span id='topic+semivariogram.krige'></span><span id='topic+plot.krige'></span><span id='topic+semivariogram.lm'></span><span id='topic+semivariogram.default'></span><span id='topic+semivariogram.semivariance'></span><span id='topic+plot.semivariance'></span>

<h3>Description</h3>

<p>This function creates semivariogram plots. It creates empirical semivariogram 
for raw data and <code>lm</code> object or parametric exponential semivariogram based 
on the estimation from <code>metropolis.krige</code>. Based on the user's chosen level 
of coarsening, the semivariogram is presented for various distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semivariogram(x, ...)

## S3 method for class 'krige'
semivariogram(x, ..., bins = 13, terms = "all", type, pch, lty, legend, col)

## S3 method for class 'krige'
plot(...)

## S3 method for class 'lm'
semivariogram(
  x,
  ...,
  coords,
  bins = 13,
  terms = c("raw", "residual"),
  east,
  north,
  type,
  legend,
  col,
  pch,
  lty
)

## Default S3 method:
semivariogram(
  x,
  ...,
  coords,
  data,
  bins = 13,
  east,
  north,
  type,
  pch,
  lty,
  col
)

## S3 method for class 'semivariance'
semivariogram(x, ..., type, pch, lty, legend, col)

## S3 method for class 'semivariance'
plot(x, ..., type, pch, lty, legend, col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="semivariogram_+3A_x">x</code></td>
<td>
<p>An object for which a semivariogram is desired. The object can 
be a <code>krige</code> object, a <code>semivariance</code> object, a <code>lm</code> object, 
or a vector of variables (or variable names in the <code>data</code>).</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>semivariogram</code> methods. 
Further arguments that can passed to <code>plot()</code> function can be specified
here.</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_bins">bins</code></td>
<td>
<p>Number of bins into which distances should be divided. The observed 
distances will be split at equal intervals, and the semivariance will be computed 
within each interval. Defaults to 13 intervals.</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_terms">terms</code></td>
<td>
<p>A vector of strings specifies for which the semivariogram is created. 
Options are &quot;raw&quot; (the semivariogram for raw data), &quot;residual&quot; (the semivariogram
for residuals from linear regression). &quot;parametric&quot; (the parametric powered 
exponential semivariogram based on the estimation from <code>metropolis.krige</code>). 
Defaults will create all the applicable plots.</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_type">type</code></td>
<td>
<p>A vector specify the type of plots for each term. Options are &quot;l&quot; 
(line plot) and &quot;p&quot; (scatter plot). Defaults to <code>c(raw = "p", residual = "p", 
parametric = "l")</code></p>
</td></tr>
<tr><td><code id="semivariogram_+3A_pch">pch</code></td>
<td>
<p>A vector specify the points symbols for scatter plot. Suppressed for 
line plot.</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_lty">lty</code></td>
<td>
<p>A vector specify the line type for line plot. Suppressed for 
scatter plot.</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_legend">legend</code></td>
<td>
<p>A logical argument for whether legend should be presented. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_col">col</code></td>
<td>
<p>A vector specify the color for each term. Defaults to <code>c(raw = "black", 
residual = "blue", parametric = "red")</code></p>
</td></tr>
<tr><td><code id="semivariogram_+3A_coords">coords</code></td>
<td>
<p>A matrix of coordinates for all observations or a vector of variable 
names indicating the coordinates variables in the data. Alternatively, the 
coordinates can also be specified separately using <code>east</code> and <code>north</code>.</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_east">east</code></td>
<td>
<p>Alternative specification for the vector of eastings for all observations.</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_north">north</code></td>
<td>
<p>Alternative specification for the vector of northing for all observations.</p>
</td></tr>
<tr><td><code id="semivariogram_+3A_data">data</code></td>
<td>
<p>If object is a variable name, a data frame must be provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates semivariograms for diagnosing the spatial relationship
that best describes the data and for diagnosing the degree to which the model 
fits the spatial relationship. With a view of the empirical semivariogram, 
a user can consult images of parametric semivariograms to determine whether 
an exponential, Gaussian, or other powered expoential function fit the data 
well, or if another style of semivariogram works better. Examining this also 
allows the user to develop priors such as the approximate split in variance 
between the nugget and partial sill as well as the approximate distance of 
the effective range. Semivariograms are explicitly tied to a corresponding 
spatial correlation function, so determining the former automatically implies 
the latter. See Banerjee, Carlin, and Gelfand for a fuller explanation, as 
well as a guidebook to semivariogram diagnosis (2015, 26-30).
</p>
<p>The function can be applied to a variable, a fitted linear model (<code>lm</code> 
object) before fitting a spatial model or to a <code>krige</code> object or <code>semivariance</code>
object to assess the model fit. When applying to a variable, it will describes 
the raw data; for a <code>lm</code> object, the default will present empirical 
semivariogram for both the raw data and linear residuals; when applying to a 
<code>krige</code> object, the default will present empirical semivariogram for the 
raw data and the residuals from linear fit, and the parametric semivariogram 
given the estimates from the geospatial model fitted in <code>metropolis.krige</code>; 
for a <code>semivariance</code> object, it will present a plot(s) for whichever the
semivariance is calculated. Users can also specify which semivariogram is needed 
in the <code>terms</code> argument if there are multiple kinds of semivariogram can 
be plotted. The plots are compatible to the arguments used in base <code>R</code> 
base graphics.
</p>


<h3>Value</h3>

<p>An semivariogram plot. For <code>krige</code> object, it will return empirical 
semivariograms for raw data and residuals of linear regression as well as a 
parametric powered exponential semivariogram given the values of the estimates 
from <code>metropolis.krige</code> as default.
</p>


<h3>References</h3>

<p>Sudipto Banerjee, Bradley P. Carlin, and Alan E. Gelfand. 2015. <em>Hierarchical 
Modeling and Analysis for Spatial Data</em>. 2nd ed. Boca Raton, FL: CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+semivariance">semivariance</a></code>, <code><a href="#topic+exponential.semivariance">exponential.semivariance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize Data
summary(ContrivedData)

# Empirical semivariagram for variable y
semivariogram(x=ContrivedData$y, coords = cbind(ContrivedData$s.1, ContrivedData$s.2))

# Initial OLS Model
contrived.ols&lt;-lm(y~x.1+x.2,data=ContrivedData)

# Empirical semivariagram for ols fit
semivariogram(contrived.ols, coords = c("s.1","s.2"), bins=13)

# Set seed
set.seed(1241060320)

M &lt;- 100
#M&lt;-10000

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
   data = ContrivedData, n.iter = M, range.tol = 0.05)
   
# Parametric semivariagram
semivariogram(contrived.run, bins=13, terms = c("raw", "residual", "parametric"),
  type= c(raw = "p", residual = "p", parametric = "l"), legend = TRUE, col = c("black", 
  "blue", "red"), pch = c(1,3,NA), lty = c(NA,NA,1))
  
# Alternatively, the generic function plot can also be applied to krige object
plot(contrived.run)

# Plot semivariance object
plot(semivariance(contrived.run, bins=13))

## End(Not run)

</code></pre>

<hr>
<h2 id='stateCombined'>State Public Opinion Ideology in 2010</h2><span id='topic+stateCombined'></span>

<h3>Description</h3>

<p>These data present measures of ideology in 2010 for the 50 American states, 
recorded as the variable <code>krige.state</code>. Forecasts are based on a kriging 
model fitted over the 2008 Cooperative Congressional Election Survey (CCES), 
paired with predictive data from the 2010 Census. Each state is listed twice, 
as each state's public ideology is paired with the DW-NOMINATE common space 
score of each of its two senators in 2011 (update from McCarty, Poole and 
Rosenthal 1997).
</p>


<h3>Format</h3>

<p>The <code>stateCombined</code> dataset has 100 observations (2 each for 50 states) and 13 variables.
</p>

<dl>
<dt><code>STATEA</code></dt><dd><p>The FIPS code for the state.</p>
</dd>
<dt><code>krige.state</code></dt><dd><p>The ideology of the average citizen in the state.</p>
</dd>
<dt><code>krige.state.var</code></dt><dd><p>The variance of ideology among the state's citizens.</p>
</dd>
<dt><code>cong</code></dt><dd><p>The term of Congress studied&ndash;112 for this dataset.</p>
</dd>
<dt><code>idno</code></dt><dd><p>Identification number for the senator&ndash;ICPSR numbers continued by Poole &amp; Rosenthal.</p>
</dd>
<dt><code>state</code></dt><dd><p>The ICPSR code for the state.</p>
</dd>
<dt><code>cd</code></dt><dd><p>The congressional district number&ndash;0 for senators.</p>
</dd>
<dt><code>statenm</code></dt><dd><p>The first seven letters of the state's name.</p>
</dd>
<dt><code>party</code></dt><dd><p>Political party of the senator. 100=Democrat, 200=Republican, 328=Independent.</p>
</dd>
<dt><code>name</code></dt><dd><p>Last name of the senator, followed by first name if ambiguous.</p>
</dd>
<dt><code>dwnom1</code></dt><dd><p>First dimension DW-NOMINATE common space score for the senator. 
Higher values are usually interpreted as more right-wing, with lower values as more left-wing.</p>
</dd>
<dt><code>stateCD</code></dt><dd><p>Combined index of <code>STATEA</code> followed by <code>cd</code>.</p>
</dd>
<dt><code>obama</code></dt><dd><p>Barack Obama's percentage of the two-party vote in the state in 2012.</p>
</dd>
</dl>



<h3>Source</h3>


<p>Ansolabehere, Stephen. 2011. &quot;CCES, Common Content, 2008.&quot; Ver. 4.
</p>
<p>McCarty, Nolan M., Keith T. Poole and Howard Rosenthal. 1997. <em>Income 
Redistribution and the Realignment of American Politics</em>. American Enterprise 
Institude Studies on Understanding Economic Inequality. Washington: AEI Press.
</p>
<p>Minnesota Population Center. 2011. <em>National Historical Geographic Information 
System: Version 2.0.</em> Minneapolis, MN: University of Minnesota. &lsquo;<span class="samp">&#8288;https://www.nhgis.org&#8288;</span>&rsquo;

</p>


<h3>References</h3>

<p>Jeff Gill. 2020. Measuring Constituency Ideology Using Bayesian Universal Kriging. 
<em>State Politics &amp; Policy Quarterly</em>. <code>doi:10.1177/1532440020930197</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Descriptive Statistics
summary(stateCombined)

# Correlate Senators' DW-NOMINATE Scores with Public Opinion Ideology
cor(stateCombined$krige.state,stateCombined$dwnom1)

# Plot Senators' DW-NOMINATE Scores against Public Opinion Ideology
plot(y=stateCombined$dwnom1,x=stateCombined$krige.state,
     xlab="State Ideology (Kriging)", ylab="Legislator Ideology (1st Dim., Common Space)", 
     main="U.S. Senate", type="n")
points(y=stateCombined$dwnom1[stateCombined$party==200],
       x=stateCombined$krige.state[stateCombined$party==200],pch="R",col="red")
points(y=stateCombined$dwnom1[stateCombined$party==100],
       x=stateCombined$krige.state[stateCombined$party==100],pch="D",col="blue")     
</code></pre>

<hr>
<h2 id='summary.krige'>Summarize Fitted Kriging Model</h2><span id='topic+summary.krige'></span>

<h3>Description</h3>

<p>Create a summary of a estimated model from <code>metropolis.krige</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'krige'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.krige_+3A_object">object</code></td>
<td>
<p>An <code>krige</code> object from the <code>metropolis.krige</code> function.</p>
</td></tr>
<tr><td><code id="summary.krige_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>summary</code> methods. Not supported for 
<code>krige</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates a summary of the model estimated by <code>metropolis.krige</code>.
The output includes both the parameters and estimates of the model.
</p>


<h3>Value</h3>

<p>A <code>summary.krige</code> list object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.mcmc.summary.krige">as.mcmc.summary.krige</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize data
summary(ContrivedData)

# Initial OLS model
contrived.ols&lt;-lm(y~x.1+x.2,data=ContrivedData)
# summary(contrived.ols)

# Set seed
set.seed(1241060320)

#For simple illustration, we set to few iterations.
#In this case, a 10,000-iteration run converges to the true parameters.
#If you have considerable time and hardware, delete the # on the next line.
#10,000 iterations took 39 min. with 8 GB RAM &amp; a 1.5 GHz Quad-Core processor.
M &lt;- 100
#M&lt;-10000

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
   data = ContrivedData, n.iter = M, range.tol = 0.05)

# Summary
summary(contrived.run)

## End(Not run)

</code></pre>

<hr>
<h2 id='update.krige'>Update Model</h2><span id='topic+update.krige'></span>

<h3>Description</h3>

<p>Update the Markov chain associated with the <code>metropolis.krige</code> model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'krige'
update(object, n.iter, n.burnin = 0, combine = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update.krige_+3A_object">object</code></td>
<td>
<p>An <code>krige</code> object from the <code>metropolis.krige</code> function.</p>
</td></tr>
<tr><td><code id="update.krige_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for the update run.</p>
</td></tr>
<tr><td><code id="update.krige_+3A_n.burnin">n.burnin</code></td>
<td>
<p>The number of burnin iterations. Defaults to 0.</p>
</td></tr>
<tr><td><code id="update.krige_+3A_combine">combine</code></td>
<td>
<p>Logical value indicate whether to combine the update run with 
original output.</p>
</td></tr>
<tr><td><code id="update.krige_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>update</code> methods. Not supported for 
<code>krige</code> objects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since MCMC calculations typically need to run relatively long. This 
function can continue the MCMC calculations by <code>metropolis.krige()</code>. 
The parameters of the original model and the estimated results from the previous
run are passed through the <code>krige</code> object. 
</p>
<p>As geospatial estimation can be computationally taxing, the users may want to 
preserve more iterations of the posterior samples. The <code>combine</code> argument 
can be used to indicate whether combine the updated run with previous results. 
This includes both the posterior samples and acceptance rates.
</p>


<h3>Value</h3>

<p>An object of class <code>krige</code> that includes the output MCMC matrix
of sampled values from the posterior distribution as well as the record of 
function arguments, model frame, acceptance rates, and standing parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Summarize Data
summary(ContrivedData)

# Set seed
set.seed(1241060320)

M &lt;- 100
#M&lt;-10000

contrived.run &lt;- metropolis.krige(y ~ x.1 + x.2, coords = c("s.1","s.2"), 
   data = ContrivedData, n.iter = M, range.tol = 0.05)
summary(contrived.run)

# Update run
contrived.run2 &lt;- update(contrived.run, n.iter = M, combine = TRUE)

summary(contrived.run2)
#plot(contrived.run2)

## End(Not run)

</code></pre>

<hr>
<h2 id='upperCombined'>State Legislative District (Upper Chambers) Public Opinion Ideology in 2010</h2><span id='topic+upperCombined'></span>

<h3>Description</h3>

<p>These data present measures of ideology in 2010 for the districts for upper 
chambers of state legislatures, recorded as the variable <code>krige.upper</code>. 
All 50 states' chambers are covered (including the Nebraska Unicameral). 
Forecasts are based on a kriging model fitted over the 2008 Cooperative Congressional 
Election Survey (CCES), paired with predictive data from the 2010 Census. Each 
district's public ideology is paired with a measure of the ideology of the State 
Senate member from the district (update from Shor and McCarty 2011).
</p>


<h3>Format</h3>

<p>The <code>upperCombined</code> dataset has 1989 observations and 10 variables.
</p>

<dl>
<dt><code>st</code></dt><dd><p>Two-letter postal abbreviation for the state.</p>
</dd>
<dt><code>upper</code></dt><dd><p>The state legislative district number (upper chamber).</p>
</dd>     		
<dt><code>STATEA</code></dt><dd><p>The FIPS code for the state.</p>
</dd>
<dt><code>krige.upper</code></dt><dd><p>The ideology of the average citizen in the district.</p>
</dd>
<dt><code>upperKluge</code></dt><dd><p>Combined index of <code>STATEA</code> followed by <code>upper</code>.</p>
</dd>
<dt><code>krige.upper.var</code></dt><dd><p>The variance of ideology among the district's citizens.</p>
</dd>
<dt><code>name</code></dt><dd><p>Last name of the state legislator, followed by first name and middle initial.</p>
</dd>
<dt><code>party</code></dt><dd><p>Political party of the legislator. D=Democrat, R=Republican, X=Other.</p>
</dd>
<dt><code>st_id</code></dt><dd><p>Temporary identifer variable. DO NOT USE.</p>
</dd>
<dt><code>np_score</code></dt><dd><p>Ideology score for the state legislator (upper chamber). 
Higher values are usually interpreted as more right-wing, with lower values as more left-wing.</p>
</dd>
</dl>



<h3>Source</h3>


<p>Ansolabehere, Stephen. 2011. &quot;CCES, Common Content, 2008.&quot; Ver. 4.
</p>
<p>Minnesota Population Center. 2011. <em>National Historical Geographic Information 
System: Version 2.0.</em> Minneapolis, MN: University of Minnesota. &lsquo;<span class="samp">&#8288;https://www.nhgis.org&#8288;</span>&rsquo;
</p>
<p>Shor, Boris and Nolan M. McCarty. 2011. &quot;The Ideological Mapping of American Legislatures.&quot; 
<em>American Political Science Review</em> 105(3):530-551.

</p>


<h3>References</h3>

<p>Jeff Gill. 2020. Measuring Constituency Ideology Using Bayesian Universal Kriging. 
<em>State Politics &amp; Policy Quarterly</em>. <code>doi:10.1177/1532440020930197</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Descriptive Statistics
summary(upperCombined)

# Correlate Senators' DW-NOMINATE Scores with Public Opinion Ideology
cor(upperCombined$np_score,upperCombined$krige.upper,use="complete.obs")

# Plot Legislators' DW-NOMINATE Scores against Public Opinion Ideology
plot(y=upperCombined$np_score,x=upperCombined$krige.upper,
     xlab="District Ideology (Kriging)", ylab="Legislator Ideology (Shor &amp; McCarty)", 
          main="State Legislatures: Upper Chambers", type="n")
points(y=upperCombined$np_score[upperCombined$party=="R"],
       x=upperCombined$krige.upper[upperCombined$party=="R"],pch=".",col="red")
points(y=upperCombined$np_score[upperCombined$party=="D"],
       x=upperCombined$krige.upper[upperCombined$party=="D"],pch=".",col="blue")
</code></pre>

<hr>
<h2 id='WVwells'>West Virginia Oil and Gas Production in 2012</h2><span id='topic+WVwells'></span>

<h3>Description</h3>

<p>These data are a subset of the West Virginia Geological and Economic Survey of 
2014. They contain information on the coordinates of wells that yielded at 
least some quantity of natural gas in 2012. In addition to coordinates, the 
data contain information on well ownership and operation, rock pressure at 
the well, elevation of the well, oil production, and gas production.
</p>


<h3>Format</h3>

<p>The <code>WVwells</code> dataset has 1949 observations and 18 variables.
</p>

<dl>
<dt><code>APINum</code></dt><dd><p>A 10-digit number in the format assigned by the American 
Petroleum Institute (API), consisting of a 2-digit state code, a 3-digit county 
code with leading zeroes, and a 5-digit permit number with leading zeroes. 
Data Source: West Virginia Department of Environmental Protection, Office 
of Oil &amp; Gas (WVDEP-OOG).</p>
</dd>
<dt><code>CntyCode</code></dt><dd><p>A 3-digit numeric code, assigned in numeric order by 
county name. Data Source: The county code for a well is assigned by WVDEP-OOG, 
based on the well location.</p>
</dd>
<dt><code>CntyName</code></dt><dd><p>The name of the county. Please see CntyCode (County Code) 
for a list of all West Virginia county names. Data Source: The county code for 
a well is assigned by WVDEP-OOG, based on the well location. The county name 
is a translation of the county code.</p>
</dd>
<dt><code>Operator</code></dt><dd><p>The name of the operator who owns the well at the time 
of reporting.  Data Source:  WVDEP-OOG plat; verified on the WR-35 completion record.</p>
</dd>
<dt><code>SurfaceOwn</code></dt><dd><p>The name of the owner of the surface property on which 
the well is located. Data Source: WVDEP-OOG plat; verified on the WR-35 completion 
record.</p>
</dd>
<dt><code>MineralOwn</code></dt><dd><p>Mineral Owner: The name of the owner of the mineral 
rights where the well is located. Data Source: WVDEP-OOG plat.</p>
</dd>
<dt><code>CompanyNum</code></dt><dd><p>The operator's serial number for the well. Data Source: 
WVDEP-OOG plat; verified on the WR-35 completion record.</p>
</dd>
<dt><code>WellNum</code></dt><dd><p>The operator's number for the well on the surface property 
(farm). Data Source: WVDEP-OOG plat; verified on the WR-35 completion record.</p>
</dd>
<dt><code>UTMESrf</code></dt><dd><p>Surface Location&ndash;Universal Transverse Mercator, Easting: 
The well location at the surface measured in meters to one decimal point, 
east of the central meridian in UTM Zone 17; datum: NAD83. Data Source: 
Taken directly from the plat if given as such. Otherwise, computed from 
the location reported on the plat. Suspect locations may be adjusted using 
various additional resources (e.g. topographic maps) if deemed necessary.</p>
</dd>
<dt><code>UTMNSrf</code></dt><dd><p>Surface Location&ndash;Universal Transverse Mercator, Northing: 
The well location at the surface measured in meters to one decimal point, north 
of the equator in UTM Zone 17; datum: NAD83. Data Source: Taken directly from 
the plat if given as such. Otherwise, computed from the location reported on 
the plat. Suspect locations may be adjusted using various additional resources 
(e.g. topographic maps) if deemed necessary.</p>
</dd>
<dt><code>LonSrf</code></dt><dd><p>Surface Location&ndash;Longitude: The well location at the 
surface measured to a precision of 6 decimal points, in degrees west of the 
Prime Meridian. Data Source: Taken directly from the plat if given as such. 
Otherwise, computed from the location reported on the plat. Suspect locations 
may be adjusted using various additional resources (e.g. topographic maps) 
if deemed necessary.</p>
</dd>
<dt><code>LatSrf</code></dt><dd><p>Surface Location&ndash;Latitude: The well location at the surface 
measured to a precision of 6 decimal points, in degrees north of the equator. 
Data Source: Taken directly from the plat if given as such. Otherwise, computed 
from the location reported on the plat. Suspect locations may be adjusted using 
various additional resources (e.g. topographic maps) if deemed necessary.</p>
</dd>
<dt><code>Elevation</code></dt><dd><p>Elevation: The height of the well in feet above mean 
sea level. Data Source: WVDEP-OOG plat; verified on the WR-35 completion record.</p>
</dd>
<dt><code>RockPres</code></dt><dd><p>Formation Rock Pressure at Surface: The pressure measured 
at the surface usually after stimulation, in pounds per square inch (psi). 
Data Source: WVDEP-OOG WR-35 comp#'   letion record, submitted by the operator 
to WVDEP-OOG.</p>
</dd>
<dt><code>GProd2012</code></dt><dd><p>2012 Gas Production Reported: The total gas production 
for the well for 2012 in thousands of cubic feet (MCF); includes all pay zones. 
Data Source: Production data reported by the operator to the State regulatory 
authority for Oil and Gas (WVDEP-OOG); WVGES obtained the data from WVDEP-OOG.</p>
</dd>
<dt><code>OProd2012</code></dt><dd><p>2012 Oil Production Reported: The total oil production 
for the well for 2012 in barrels (Bbl); includes all pay zones. Production 
data reported by the operator to the State regulatory authority for Oil and 
Gas (WVDEP-OOG); WVGES obtained the data from WVDEP-OOG.</p>
</dd>
<dt><code>logElevation</code></dt><dd><p>Logarithm of <code>Elevation</code>.</p>
</dd>
</dl>



<h3>Source</h3>


<p>West Virginia Geological and Economic Survey. 2014. &quot;WVMarcellusWellsCompleted102014.&quot; Morgantown, WV. 
<a href="http://www.wvgs.wvnet.edu/www/datastat/devshales.htm">http://www.wvgs.wvnet.edu/www/datastat/devshales.htm</a> Accessed via: FracTracker. 2019. 
&quot;West Virginia Oil &amp; Gas Activity.&quot; <a href="https://www.fractracker.org/map/us/west-virginia/">https://www.fractracker.org/map/us/west-virginia/</a>

</p>


<h3>References</h3>

<p>Jason S. Byers &amp; Jeff Gill. N.D. &quot;Applied Geospatial Data Modeling in the Big 
Data Era: Challenges and Solutions.&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Descriptive Statistics
summary(WVwells)

# Record means of predictors: 
# These are used BOTH to eliminate the intercept and to recover predictions later.
mean.logGas&lt;-mean(WVwells$logGProd2012);mean.logGas
mean.logElevation&lt;-mean(WVwells$logElevation);mean.logElevation
mean.RockPres&lt;-mean(WVwells$RockPres);mean.RockPres

# Outcome Variable, De-Meaned
WVwells$logGas &lt;- WVwells$logGProd2012-mean.logGas

# Explanatory Variable: DE-MEANED PREDICTORS AND NO CONSTANT TERM
# Because we deducted the mean from all predictors and the outcome,
# it is valid to do regression through the origin. 
WVwells$LogElevation &lt;- WVwells$logElevation-mean.logElevation
WVwells$RockPressure &lt;- WVwells$RockPres-mean.RockPres

# OLS Model
fracking.ols&lt;-lm(logGas~LogElevation+RockPressure-1, data = WVwells)
summary(fracking.ols)

intercept.mod&lt;-lm(logGProd2012~ logElevation+RockPres,data=WVwells)
summary(intercept.mod)

# Set Number of Iterations:
# WARNING: 100 iterations is intensive on many machines.
# This example was tuned on Amazon Web Services (EC2) over many hours
# with 5,000 iterations--unsuitable in 2020 for most desktop machines.
#M&lt;-5000
M&lt;-20

set.seed(1000, kind="Mersenne-Twister")#SET SEED FOR CONSISTENCY

# Trial Run, Linear Model of Ideology with Geospatial Errors Using Metropolis-Hastings:
wv.fit &lt;- metropolis.krige(logGas~LogElevation+RockPressure-1, coords = c("UTMESrf", "UTMNSrf"),
                           data = WVwells, n.iter=M, powered.exp=0.5, spatial.share=0.60, 
                           range.share=0.31, beta.var=1000, range.tol=0.1, b.tune=1, 
                           nugget.tune=1, psill.tune=30)

# Discard first 20% of Iterations as Burn-In (User Discretion Advised).
wv.fit &lt;- burnin(wv.fit, M/5)

# Summarize Results
summary(wv.fit)

# Convergence Diagnostics
# geweke(wv.fit) Not applicable due to few iterations.
heidel.welch(wv.fit)

# Draw Semivariogram
semivariogram(wv.fit)

# Predictive Data for Two Wells Tapped in 2013
well.1&lt;-c(log(1110)-mean.logElevation,1020-mean.RockPres)
well.2&lt;-c(log(643)-mean.logElevation,630-mean.RockPres)
site.1&lt;-c(557306.0, 4345265)
site.2&lt;-c(434515.7, 4258449)
well.newdata &lt;- as.data.frame(cbind(rbind(well.1,well.2),rbind(site.1,site.2)))
colnames(well.newdata)&lt;-c("LogElevation", "RockPressure", "UTMESrf","UTMNSrf")

# Make predictions from median parameter values:
(median.pred &lt;- predict(wv.fit, newdata = well.newdata))

# Prediction in thousands of cubic feet (MCF):
round(exp(median.pred+mean.logGas))

# Make predictions with 90\
(cred.pred &lt;- predict(wv.fit, newdata = well.newdata, credible = 0.9))

# Prediction in thousands of cubic feet (MCF) and the true yield in 2013:
Actual.Yield&lt;-c(471171, 7211)
round(cbind(exp(cred.pred+mean.logGas),Actual.Yield))

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
