<!DOCTYPE html><html lang="en"><head><title>Help for package quadVAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {quadVAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#block_cv'><p>Use Block Cross-Validation to Evaluate Models</p></a></li>
<li><a href='#compare_4_emo'><p>Compare estimated model with true model for 4-emotion model</p></a></li>
<li><a href='#find_index'><p>Find index of data that satisfies certain conditions</p></a></li>
<li><a href='#get_adj_mat'><p>Extract the adjacency matrix from a quadVAR object.</p></a></li>
<li><a href='#linear_quadVAR_network'><p>Linearize a quadVAR object to produce a network.</p></a></li>
<li><a href='#partial_plot'><p>Make a partial plot of a variable in a model</p>
This function takes a quadVAR model as input, and returns a plot of the partial effect of a variable on the dependent variable (controlling all other variables and the intercept), for higher and lower levels of the moderator variable split by the median.</a></li>
<li><a href='#predict.quadVAR'><p>Predict the values of the dependent variables using the quadVAR model</p></a></li>
<li><a href='#quadVAR'><p>Estimate lag-1 quadratic vector autoregression models</p></a></li>
<li><a href='#quadVAR_to_dyn_eqns'><p>Transform a quadVAR object to a list of dynamic equations.</p></a></li>
<li><a href='#sim_4_emo'><p>Simulate a 4-emotion model</p></a></li>
<li><a href='#true_model_4_emo'><p>True model for 4-emotion model</p></a></li>
<li><a href='#tune.fit'><p>Using the <strong>glmnet</strong> and <strong>ncvreg</strong> packages, fits a Generalized Linear Model or Cox Proportional Hazards Model using various methods for choosing the regularization parameter <code class="reqn">\lambda</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Quadratic Vector Autoregression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate quadratic vector autoregression models with the
    strong hierarchy using the Regularization Algorithm under Marginality
    Principle (RAMP) by Hao et al. (2018)
    &lt;<a href="https://doi.org/10.1080%2F01621459.2016.1264956">doi:10.1080/01621459.2016.1264956</a>&gt;, compare the performance with
    linear models, and construct networks with partial derivatives.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Sciurus365/quadVAR">https://github.com/Sciurus365/quadVAR</a>,
<a href="https://sciurus365.github.io/quadVAR/">https://sciurus365.github.io/quadVAR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Sciurus365/quadVAR/issues">https://github.com/Sciurus365/quadVAR/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, dplyr, ggplot2, magrittr, ncvreg, qgraph, RAMP, rlang,
shiny, shinythemes, stats, stringr, tibble, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>nonlinearTseries, remotes, SIS, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-11 14:08:33 UTC; jingm</td>
</tr>
<tr>
<td>Author:</td>
<td>Jingmeng Cui <a href="https://orcid.org/0000-0003-3421-8457"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jingmeng Cui &lt;jingmeng.cui@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-11 17:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code style="white-space: pre;">&#8288;magrittr::[\%&gt;\%][magrittr::pipe]&#8288;</code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='block_cv'>Use Block Cross-Validation to Evaluate Models</h2><span id='topic+block_cv'></span>

<h3>Description</h3>

<p>This function uses block cross-validation to evaluate a model. The data is split into blocks, and the model is fit on all but one block and evaluated on the remaining block. This process is repeated for each block, and the mean squared error is calculated for each model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>block_cv(
  data,
  dayvar = NULL,
  model,
  block = 10,
  lowerbound = -Inf,
  upperbound = Inf,
  detail = FALSE,
  metric = "MSE"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="block_cv_+3A_data">data</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="block_cv_+3A_dayvar">dayvar</code></td>
<td>
<p>A character string. The name of the variable that represents the day. This is required because this function use dayvar to specify the time point before the test block should not be used to predict the time point after the test block. If dayvar is not specified, in the original dataset, then please add one constant variable as dayvar, and specify it both here and in the function passed to <code>model</code>.</p>
</td></tr>
<tr><td><code id="block_cv_+3A_model">model</code></td>
<td>
<p>A function. The model to be evaluated. The function should take a data frame as its first argument and return a <code>quadVAR</code> object. It can be, for example, <code>function(x) quadVAR(x, vars = c("var1", "var2"))</code></p>
</td></tr>
<tr><td><code id="block_cv_+3A_block">block</code></td>
<td>
<p>An integer. The number of blocks to use in the cross-validation. The default is 10.</p>
</td></tr>
<tr><td><code id="block_cv_+3A_lowerbound">lowerbound</code></td>
<td>
<p>A numeric value or a vector with the same length as the number of variables that specifies the lower bound of the predicted values. If the predicted value is less than this value, it will be replaced by this value. The default value is -Inf.</p>
</td></tr>
<tr><td><code id="block_cv_+3A_upperbound">upperbound</code></td>
<td>
<p>A numeric value or a vector with the same length as the number of variables that specifies  the upper bound of the predicted values. If the predicted value is greater than this value, it will be replaced by this value. The default value is Inf.</p>
</td></tr>
<tr><td><code id="block_cv_+3A_detail">detail</code></td>
<td>
<p>A logical. If <code>TRUE</code>, the function will return the predictions for each model. The default is <code>FALSE</code>, which only returns the mean squared error for each model.</p>
</td></tr>
<tr><td><code id="block_cv_+3A_metric">metric</code></td>
<td>
<p>A character vector. The metric to be used to evaluate the model. The default is &quot;MSE&quot;, which calculates the mean squared error. The other option is &quot;MAE&quot;, which calculates the mean absolute error. Only effective when <code>detail = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on <code>detail</code>. If <code>FALSE</code>, it returns a list of mean squared errors for each model. If <code>TRUE</code>, it returns a list with the mean squared errors for each model, the true data, and the predictions for each model.
</p>

<hr>
<h2 id='compare_4_emo'>Compare estimated model with true model for 4-emotion model</h2><span id='topic+compare_4_emo'></span>

<h3>Description</h3>

<p>This function compares the estimated model with the true model for the 4-emotion model. It prints out the estimated coefficients and the true coefficients for the main effects and interaction effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_4_emo(model, silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_4_emo_+3A_model">model</code></td>
<td>
<p>The estimated model, using data simulated from <code><a href="#topic+sim_4_emo">sim_4_emo()</a></code>, and model estimated using <code><a href="#topic+quadVAR">quadVAR()</a></code>.</p>
</td></tr>
<tr><td><code id="compare_4_emo_+3A_silent">silent</code></td>
<td>
<p>Whether to print out the results.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Silently return data frame with the estimated coefficients and the true coefficients for the main effects and interaction effects, while printing out the results rounded to two digits if <code>silent = FALSE</code>.
</p>

<hr>
<h2 id='find_index'>Find index of data that satisfies certain conditions</h2><span id='topic+find_index'></span>

<h3>Description</h3>

<p>Find index of data that satisfies certain conditions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_index(data, dayvar, beepvar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_index_+3A_data">data</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="find_index_+3A_dayvar">dayvar</code></td>
<td>

<p>String indicating assessment day. Adding this argument makes sure that the first measurement of a day is not regressed on the last measurement of the previous day. IMPORTANT: only add this if the data has multiple observations per day.
</p>
</td></tr>
<tr><td><code id="find_index_+3A_beepvar">beepvar</code></td>
<td>

<p>Optional string indicating assessment beep per day. Adding this argument will cause non-consecutive beeps to be treated as missing!
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two vectors of indices.
</p>

<hr>
<h2 id='get_adj_mat'>Extract the adjacency matrix from a quadVAR object.</h2><span id='topic+get_adj_mat'></span>

<h3>Description</h3>

<p>Extract the adjacency matrix from a quadVAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_adj_mat(model, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_adj_mat_+3A_model">model</code></td>
<td>
<p>A quadVAR object.</p>
</td></tr>
<tr><td><code id="get_adj_mat_+3A_value">value</code></td>
<td>
<p>The <code>actual_value</code> in the output of <code><a href="#topic+linear_quadVAR_network">linear_quadVAR_network()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An adjacency matrix.
</p>

<hr>
<h2 id='linear_quadVAR_network'>Linearize a quadVAR object to produce a network.</h2><span id='topic+linear_quadVAR_network'></span><span id='topic+plot.linear_quadVAR_network'></span>

<h3>Description</h3>

<p>A quadVAR object is nonlinear, which means that the relationship between variables are not the same across different values of the variables. This function linearizes a quadVAR object by specifying the values of the variables that the linearized model will be based on, to facilitate interpretation. The linearized model is then expressed in an adjacency matrix, which can be used to produce a network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linear_quadVAR_network(model, value = NULL, value_standardized = TRUE)

## S3 method for class 'linear_quadVAR_network'
plot(x, interactive = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linear_quadVAR_network_+3A_model">model</code></td>
<td>
<p>A quadVAR object.</p>
</td></tr>
<tr><td><code id="linear_quadVAR_network_+3A_value">value</code></td>
<td>
<p>A numeric vector of length 1 or the same as the number of nodes, that specifies the values of the variables that the linearized model will be based on. If the length is 1, the same value will be used for all variables. The default value is <code>NULL</code>, in which case the value will be set to 0 in calculation, which means (if <code>value_standardized = TRUE</code>) the linearized model will be based on the mean values of all variables.</p>
</td></tr>
<tr><td><code id="linear_quadVAR_network_+3A_value_standardized">value_standardized</code></td>
<td>
<p>A logical value that specifies whether the input value is standardized or not. If TRUE, the input value will be regarded as standardized value, i.e., mean + <code>value</code> * sd (e.g., 0 is the mean, 1 is mean + sd, ...). If FALSE, the input value will regarded as in the raw scale of the input data. If the raw dataset was already standardized, this parameter does not have an effect. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="linear_quadVAR_network_+3A_x">x</code></td>
<td>
<p>A linear_quadVAR_network object.</p>
</td></tr>
<tr><td><code id="linear_quadVAR_network_+3A_interactive">interactive</code></td>
<td>
<p>Whether to produce an interactive plot using <code>shiny</code> (in which the user can change the values of variables interactively) or a static plot using <code><a href="qgraph.html#topic+qgraph">qgraph::qgraph()</a></code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="linear_quadVAR_network_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="qgraph.html#topic+qgraph">qgraph::qgraph()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A linear_quadVAR_network with the following elements:
</p>

<ul>
<li> <p><code>adj_mat</code>: the adjacency matrix of the linearized network.
</p>
</li>
<li> <p><code>standardized_value</code>: the standardized value that the linearized model is based on.
</p>
</li>
<li> <p><code>actual_value</code>: the value in the raw scale of the input data.
</p>
</li>
<li> <p><code>model</code>: the input quadVAR object.
</p>
</li>
<li> <p><code>value_standardized</code>: the same as the input.
</p>
</li></ul>



<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>plot(linear_quadVAR_network)</code>: Produce a plot for the linearized quadVAR model. If <code>interactive = FALSE</code>, the output will be a qgraph object, which can be further used to calculate centrality measures using, e.g., <code><a href="qgraph.html#topic+centrality">qgraph::centrality()</a></code> and <code><a href="qgraph.html#topic+CentAndClusfuns">qgraph::centralityPlot()</a></code>.
</p>
</li></ul>


<h3>References</h3>

<p>The idea of this linearization function is inspired by Kroc, E., &amp; Olvera Astivia, O. L. (2023). The case for the curve: Parametric regression with second- and third-order polynomial functions of predictors should be routine. Psychological Methods. https://doi.org/10.1037/met0000629
</p>

<hr>
<h2 id='partial_plot'>Make a partial plot of a variable in a model
This function takes a quadVAR model as input, and returns a plot of the partial effect of a variable on the dependent variable (controlling all other variables and the intercept), for higher and lower levels of the moderator variable split by the median.</h2><span id='topic+partial_plot'></span>

<h3>Description</h3>

<p>Make a partial plot of a variable in a model
This function takes a quadVAR model as input, and returns a plot of the partial effect of a variable on the dependent variable (controlling all other variables and the intercept), for higher and lower levels of the moderator variable split by the median.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partial_plot(model, y, x, moderator)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partial_plot_+3A_model">model</code></td>
<td>
<p>A quadVAR model</p>
</td></tr>
<tr><td><code id="partial_plot_+3A_y">y</code></td>
<td>
<p>The dependent variable</p>
</td></tr>
<tr><td><code id="partial_plot_+3A_x">x</code></td>
<td>
<p>The variable for which the partial effect is plotted</p>
</td></tr>
<tr><td><code id="partial_plot_+3A_moderator">moderator</code></td>
<td>
<p>The moderator variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>

<hr>
<h2 id='predict.quadVAR'>Predict the values of the dependent variables using the quadVAR model</h2><span id='topic+predict.quadVAR'></span>

<h3>Description</h3>

<p>Predict the values of the dependent variables using the quadVAR model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'quadVAR'
predict(
  object,
  newdata = NULL,
  donotpredict = NULL,
  lowerbound = -Inf,
  upperbound = Inf,
  with_const = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.quadVAR_+3A_object">object</code></td>
<td>
<p>A quadVAR object.</p>
</td></tr>
<tr><td><code id="predict.quadVAR_+3A_newdata">newdata</code></td>
<td>
<p>A data frame or tibble containing at least the values of the independent variables, dayvar, and beepvar (if used in model estimation). If NULL, the original data used to fit the model will be used.</p>
</td></tr>
<tr><td><code id="predict.quadVAR_+3A_donotpredict">donotpredict</code></td>
<td>
<p>NOT IMPLEMENTED YET! A character vector of the model names that are not used for prediction. Possible options include &quot;AR&quot;, &quot;VAR&quot;, &quot;VAR_full&quot;, &quot;quadVAR_full&quot;, &quot;all_others&quot;, with NULL as the default. If set &quot;all_others&quot;, then only a <code>quadVAR</code> model will be estimated. For datasets with large number of variables, you may set this parameter to &quot;quadVAR_full&quot; to save time.</p>
</td></tr>
<tr><td><code id="predict.quadVAR_+3A_lowerbound">lowerbound</code></td>
<td>
<p>A numeric value or a vector with the same length as the number of variables that specifies the lower bound of the predicted values. If the predicted value is less than this value, it will be replaced by this value. The default value is -Inf.</p>
</td></tr>
<tr><td><code id="predict.quadVAR_+3A_upperbound">upperbound</code></td>
<td>
<p>A numeric value or a vector with the same length as the number of variables that specifies  the upper bound of the predicted values. If the predicted value is greater than this value, it will be replaced by this value. The default value is Inf.</p>
</td></tr>
<tr><td><code id="predict.quadVAR_+3A_with_const">with_const</code></td>
<td>
<p>A logical value indicating whether to include the constant variables in the prediction. Those variables were automatically excluded in the estimation procedure. The default value is FALSE. When set to TRUE, the lowerbound and upperbound should be a vector with the same length as the number of variables in the model, including the constant variables. The values of the constant variables will be ignored though because their predicted values are always the same, which is the constant value in the input data.</p>
</td></tr>
<tr><td><code id="predict.quadVAR_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the <code><a href="RAMP.html#topic+predict.RAMP">RAMP::predict.RAMP()</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame or tibble containing the predicted values of the dependent variables. If a value cannot be predicted (e.g., because the corresponding previous time point is not in the data), it will be NA.
</p>

<hr>
<h2 id='quadVAR'>Estimate lag-1 quadratic vector autoregression models</h2><span id='topic+quadVAR'></span><span id='topic+print.quadVAR'></span><span id='topic+summary.quadVAR'></span><span id='topic+coef.quadVAR'></span><span id='topic+print.coef_quadVAR'></span><span id='topic+plot.quadVAR'></span>

<h3>Description</h3>

<p>This function estimate regularized nonlinear quadratic vector autoregression models with strong hierarchy using the <code><a href="RAMP.html#topic+RAMP">RAMP::RAMP()</a></code> algorithm, and also compare it with the linear AR, regularized VAR, and unregularized (full) VAR and quadratic VAR models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quadVAR(
  data,
  vars,
  dayvar = NULL,
  beepvar = NULL,
  penalty = "LASSO",
  tune = "EBIC",
  donotestimate = NULL,
  SIS_options = list(),
  RAMP_options = list()
)

## S3 method for class 'quadVAR'
print(x, ...)

## S3 method for class 'quadVAR'
summary(object, ...)

## S3 method for class 'quadVAR'
coef(object, ...)

## S3 method for class 'coef_quadVAR'
print(
  x,
  use_actual_names = TRUE,
  abbr = FALSE,
  minlength = 3,
  omit_zero = TRUE,
  digits = 2,
  row.names = FALSE,
  ...
)

## S3 method for class 'quadVAR'
plot(x, value = NULL, value_standardized = TRUE, interactive = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quadVAR_+3A_data">data</code></td>
<td>
<p>A <code>tibble</code>, data.frame, or matrix that represents a time series of vectors, with each row as a time step.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_vars">vars</code></td>
<td>
<p>A character vector of the variable names used in the model.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_dayvar">dayvar</code></td>
<td>

<p>String indicating assessment day. Adding this argument makes sure that the first measurement of a day is not regressed on the last measurement of the previous day. IMPORTANT: only add this if the data has multiple observations per day.
</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_beepvar">beepvar</code></td>
<td>

<p>Optional string indicating assessment beep per day. Adding this argument will cause non-consecutive beeps to be treated as missing!
</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_penalty">penalty</code></td>
<td>
<p>The penalty used for the linear and regularized VAR models. Possible options include &quot;LASSO&quot;, &quot;SCAD&quot;, &quot;MCP&quot;, with &quot;LASSO&quot; as the default.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_tune">tune</code></td>
<td>
<p>Tuning parameter selection method. Possible options include &quot;AIC&quot;, &quot;BIC&quot;, &quot;EBIC&quot;, with &quot;EBIC&quot; as the default.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_donotestimate">donotestimate</code></td>
<td>
<p>A character vector of the model names that are not estimated. Possible options include, &quot;NULL_model&quot;, &quot;AR&quot;, &quot;VAR&quot;, &quot;VAR_full&quot;, &quot;quadVAR_full&quot;, &quot;all_others&quot;, with NULL as the default. If set &quot;all_others&quot;, then only a <code>quadVAR</code> model will be estimated. For datasets with large number of variables, you may set this parameter to &quot;quadVAR_full&quot; to save time.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_sis_options">SIS_options</code></td>
<td>
<p>A list of other parameters for the <code><a href="SIS.html#topic+tune.fit">SIS::tune.fit()</a></code> function. This is used for the regularized  VAR models.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_ramp_options">RAMP_options</code></td>
<td>
<p>A list of other parameters for the <code><a href="RAMP.html#topic+RAMP">RAMP::RAMP()</a></code> function. This is used for the nonlinear quadratic VAR model.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_...">...</code></td>
<td>
<p>For <code>print.quadVAR</code>, additional arguments passed to <code><a href="#topic+print.coef_quadVAR">print.coef_quadVAR()</a></code>. For <code>print.coef_quadVAR</code>, additional arguments passed to <code><a href="base.html#topic+print.data.frame">print.data.frame()</a></code>.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_object">object</code>, <code id="quadVAR_+3A_x">x</code></td>
<td>
<p>An <code>quadVAR</code> object. (For <code>print.coef_quadVAR</code>, an <code>coef_quadVAR</code> object returned by <code><a href="#topic+coef.quadVAR">coef.quadVAR()</a></code>.)</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_use_actual_names">use_actual_names</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the actual variable names are used in the output. If <code>FALSE</code>, the names &quot;X1&quot;, &quot;X2&quot;, etc., are used in the output. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_abbr">abbr</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the output is abbreviated. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_minlength">minlength</code></td>
<td>
<p>the minimum length of the abbreviations.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_omit_zero">omit_zero</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the coefficients that are zero are omitted. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_digits">digits</code></td>
<td>
<p>the minimum number of significant digits to be used: see
<code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_row.names">row.names</code></td>
<td>
<p>logical (or character vector), indicating whether (or
what) row names should be printed.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_value">value</code></td>
<td>
<p>A numeric vector of length 1 or the same as the number of nodes, that specifies the values of the variables that the linearized model will be based on. If the length is 1, the same value will be used for all variables. The default value is <code>NULL</code>, in which case the value will be set to 0 in calculation, which means (if <code>value_standardized = TRUE</code>) the linearized model will be based on the mean values of all variables.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_value_standardized">value_standardized</code></td>
<td>
<p>A logical value that specifies whether the input value is standardized or not. If TRUE, the input value will be regarded as standardized value, i.e., mean + <code>value</code> * sd (e.g., 0 is the mean, 1 is mean + sd, ...). If FALSE, the input value will regarded as in the raw scale of the input data. If the raw dataset was already standardized, this parameter does not have an effect. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="quadVAR_+3A_interactive">interactive</code></td>
<td>
<p>Whether to produce an interactive plot using <code>shiny</code> (in which the user can change the values of variables interactively) or a static plot using <code><a href="qgraph.html#topic+qgraph">qgraph::qgraph()</a></code>. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>quadVAR</code> object that contains the following elements:
</p>

<ul>
<li> <p><code>NULL_model</code>: A list of NULL models for each variable.
</p>
</li>
<li> <p><code>AR_model</code>: A list of linear AR models for each variable.
</p>
</li>
<li> <p><code>VAR_model</code>: A list of regularized VAR models for each variable.
</p>
</li>
<li> <p><code>VAR_full_model</code>: A list of unregularized (full) VAR models for each variable.
</p>
</li>
<li> <p><code>quadVAR_model</code>: A list of regularized nonlinear quadratic VAR models for each variable.
</p>
</li>
<li> <p><code>quadVAR_full_model</code>: A list of unregularized (full) nonlinear quadratic VAR models for each variable.
</p>
</li>
<li> <p><code>data</code>,<code>vars</code>,<code>penalty</code>,<code>tune</code>,<code>SIS_options</code>,<code>RAMP_options</code>: The input arguments.
</p>
</li>
<li> <p><code>data_x</code>,<code>data_y</code>: The data directly used for modeling.
</p>
</li></ul>



<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print(quadVAR)</code>: Print the coefficients for a quadVAR object. See <code><a href="#topic+coef.quadVAR">coef.quadVAR()</a></code> and <code><a href="#topic+print.coef_quadVAR">print.coef_quadVAR()</a></code> for details.
</p>
</li>
<li> <p><code>summary(quadVAR)</code>: Summary of a quadVAR object. Different IC definitions used by different packages (which differ by a constant) are unified to make them comparable to each other.
</p>
</li>
<li> <p><code>coef(quadVAR)</code>: Extract the coefficients from a quadVAR object.
</p>
</li>
<li> <p><code>plot(quadVAR)</code>: Produce a plot for the linearized quadVAR model. Equivalent to first produce a linear quadVAR network using <code><a href="#topic+linear_quadVAR_network">linear_quadVAR_network()</a></code>, then use <code><a href="#topic+plot.linear_quadVAR_network">plot.linear_quadVAR_network()</a></code>.
</p>
</li></ul>


<h3>Functions</h3>


<ul>
<li> <p><code>print(coef_quadVAR)</code>: Print the coefficients from a quadVAR object.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+linear_quadVAR_network">linear_quadVAR_network()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1614)
data &lt;- sim_4_emo(time = 200, sd = 1)
plot(data[, "x1"])
qV1 &lt;- quadVAR(data, vars = c("x1", "x2", "x3", "x4"))
summary(qV1)
coef(qV1)
plot(qV1)
# Compare the estimation with the true model
plot(true_model_4_emo())
plot(qV1, value = 0, value_standardized = FALSE, layout = plot(true_model_4_emo())$layout)

</code></pre>

<hr>
<h2 id='quadVAR_to_dyn_eqns'>Transform a quadVAR object to a list of dynamic equations.</h2><span id='topic+quadVAR_to_dyn_eqns'></span>

<h3>Description</h3>

<p>Transform a quadVAR object to a list of dynamic equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quadVAR_to_dyn_eqns(model, minus_self = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quadVAR_to_dyn_eqns_+3A_model">model</code></td>
<td>
<p>A quadVAR object.</p>
</td></tr>
<tr><td><code id="quadVAR_to_dyn_eqns_+3A_minus_self">minus_self</code></td>
<td>
<p>Whether to subtract the term itself from the equation. If <code>TRUE</code>, the equation will be in the form of (0 =) <code> ... - X1</code>; if <code>FALSE</code>, the equation will be in the form of (X1 = )<code>...</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of dynamic equations in characters. You can also use <code><a href="rlang.html#topic+parse_expr">rlang::parse_expr()</a></code> to parse them into expressions.
</p>

<hr>
<h2 id='sim_4_emo'>Simulate a 4-emotion model</h2><span id='topic+sim_4_emo'></span>

<h3>Description</h3>

<p>This function simulates a 4-emotion model which is nonlinear, bistable, discrete, and (almost) centered to zero. Adapted from the model described by van de Leemput et al. (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_4_emo(time = 200, init = c(1.36, 1.36, 4.89, 4.89), sd = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_4_emo_+3A_time">time</code></td>
<td>
<p>The number of time steps to simulate.</p>
</td></tr>
<tr><td><code id="sim_4_emo_+3A_init">init</code></td>
<td>
<p>A vector of initial values for the four variables. Default is c(1.36, 1.36, 4.89, 4.89), which is one of the stable states of the model.</p>
</td></tr>
<tr><td><code id="sim_4_emo_+3A_sd">sd</code></td>
<td>
<p>The standard deviation of the noise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the simulated data.
</p>


<h3>References</h3>

<p>van de Leemput, I. A., Wichers, M., Cramer, A. O., Borsboom, D., Tuerlinckx, F., Kuppens, P., ... &amp; Scheffer, M. (2014). Critical slowing down as early warning for the onset and termination of depression. Proceedings of the National Academy of Sciences, 111(1), 87-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+true_model_4_emo">true_model_4_emo()</a></code>, <code><a href="#topic+compare_4_emo">compare_4_emo()</a></code>, <code><a href="#topic+quadVAR">quadVAR()</a></code>
</p>

<hr>
<h2 id='true_model_4_emo'>True model for 4-emotion model</h2><span id='topic+true_model_4_emo'></span><span id='topic+coef.true_model_4_emo'></span><span id='topic+print.true_model_4_emo'></span>

<h3>Description</h3>

<p>This function generate the true model for the 4-emotion model. It can used to compare the estimated model with the true model, or to plot the true model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>true_model_4_emo(...)

## S3 method for class 'true_model_4_emo'
coef(object, ...)

## S3 method for class 'true_model_4_emo'
print(x, which = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="true_model_4_emo_+3A_...">...</code></td>
<td>
<p>Not in use.</p>
</td></tr>
<tr><td><code id="true_model_4_emo_+3A_object">object</code></td>
<td>
<p>A true_model_4_emo object.</p>
</td></tr>
<tr><td><code id="true_model_4_emo_+3A_x">x</code></td>
<td>
<p>A true_model_4_emo object.</p>
</td></tr>
<tr><td><code id="true_model_4_emo_+3A_which">which</code></td>
<td>
<p>Which model to print out. There are four models in total, corresponding to the four variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A true_model_4_emo object.
</p>
<p>NULL, but prints out the true model.
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>coef(true_model_4_emo)</code>: This function returns the coefficients for the 4-emotion model. It is also used in other functions to generate the linearized version of the true model and to make plots. It returns a list of coefficients for the 4-emotion model, in the same format as <code><a href="#topic+coef.quadVAR">coef.quadVAR()</a></code>
</p>
</li>
<li> <p><code>print(true_model_4_emo)</code>: This function prints out the true model for the 4-emotion model in the same format as <code><a href="RAMP.html#topic+RAMP">RAMP::RAMP()</a></code>, to help users to compare the true model and the estimated model.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+true_model_4_emo">true_model_4_emo()</a></code>, <code><a href="#topic+compare_4_emo">compare_4_emo()</a></code>, <code><a href="#topic+quadVAR">quadVAR()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>coef(true_model_4_emo())
plot(true_model_4_emo())

if (interactive()) {
  # This code will only run in an interactive session
  plot(true_model_4_emo(), interactive = TRUE)
}
</code></pre>

<hr>
<h2 id='tune.fit'>Using the <strong>glmnet</strong> and <strong>ncvreg</strong> packages, fits a Generalized Linear Model or Cox Proportional Hazards Model using various methods for choosing the regularization parameter <code class="reqn">\lambda</code></h2><span id='topic+tune.fit'></span>

<h3>Description</h3>

<p>This function is modified from <code><a href="SIS.html#topic+tune.fit">SIS::tune.fit()</a></code>. It is used to tune the regularization parameter for the regularized VAR models. This wrapper is used because of the following reasons.
</p>

<ol>
<li><p> The original <code><a href="SIS.html#topic+tune.fit">SIS::tune.fit()</a></code> function does not return the value of the information criteria that we would like to use.
</p>
</li>
<li><p> We use the ncvreg package exclusively (so we removed the code using the glmnet package). This is to make the result more consistent, and also because the ncvreg package has better support for the calculation of information criteria.
</p>
</li>
<li><p> We also removed the generalized linear model (GLM) option, and the cross-validation option because we do not use them.
</p>
</li>
<li><p> We use stats::AIC() and stats::BIC() instead of the ones using SIS:::loglik() to make the calculation methods more consistent.
</p>
</li>
<li><p> We added <code>...</code> to allow the user to pass additional arguments to the ncvreg::ncvreg() function.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>tune.fit(
  x,
  y,
  family = "gaussian",
  penalty = c("SCAD", "MCP", "lasso"),
  concavity.parameter = switch(penalty, SCAD = 3.7, 3),
  tune = c("aic", "bic", "ebic"),
  type.measure = c("deviance", "class", "auc", "mse", "mae"),
  gamma.ebic = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tune.fit_+3A_x">x</code></td>
<td>
<p>The design matrix, of dimensions n * p, without an intercept. Each
row is an observation vector.</p>
</td></tr>
<tr><td><code id="tune.fit_+3A_y">y</code></td>
<td>
<p>The response vector of dimension n * 1. Quantitative for
<code>family='gaussian'</code>, non-negative counts for <code>family='poisson'</code>,
binary (0-1) for <code>family='binomial'</code>. For <code>family='cox'</code>, <code>y</code>
should be an object of class <code>Surv</code>, as provided by the function
<code>Surv()</code> in the package <span class="pkg">survival</span>.</p>
</td></tr>
<tr><td><code id="tune.fit_+3A_family">family</code></td>
<td>
<p>Response type (see above).</p>
</td></tr>
<tr><td><code id="tune.fit_+3A_penalty">penalty</code></td>
<td>
<p>The penalty to be applied in the regularized likelihood
subproblems. 'SCAD' (the default), 'MCP', or 'lasso' are provided.</p>
</td></tr>
<tr><td><code id="tune.fit_+3A_concavity.parameter">concavity.parameter</code></td>
<td>
<p>The tuning parameter used to adjust the concavity
of the SCAD/MCP penalty. Default is 3.7 for SCAD and 3 for MCP.</p>
</td></tr>
<tr><td><code id="tune.fit_+3A_tune">tune</code></td>
<td>
<p>Method for selecting the regularization parameter along the
solution path of the penalized likelihood problem. Options to provide a
final model include <code>tune='cv'</code>, <code>tune='aic'</code>, <code>tune='bic'</code>,
and <code>tune='ebic'</code>. See references at the end for details.</p>
</td></tr>
<tr><td><code id="tune.fit_+3A_type.measure">type.measure</code></td>
<td>
<p>Loss to use for cross-validation. Currently five
options, not all available for all models. The default is
<code>type.measure='deviance'</code>, which uses squared-error for gaussian models
(also equivalent to <code>type.measure='mse'</code> in this case), deviance for
logistic and poisson regression, and partial-likelihood for the Cox model.
Both <code>type.measure='class'</code> and <code>type.measure='auc'</code> apply only to
logistic regression and give misclassification error and area under the ROC
curve, respectively. <code>type.measure='mse'</code> or <code>type.measure='mae'</code>
(mean absolute error) can be used by all models except the <code>'cox'</code>;
they measure the deviation from the fitted mean to the response. For
<code>penalty='SCAD'</code> and <code>penalty='MCP'</code>, only
<code>type.measure='deviance'</code> is available.</p>
</td></tr>
<tr><td><code id="tune.fit_+3A_gamma.ebic">gamma.ebic</code></td>
<td>
<p>Specifies the parameter in the Extended BIC criterion
penalizing the size of the corresponding model space. The default is
<code>gamma.ebic=1</code>. See references at the end for details.</p>
</td></tr>
<tr><td><code id="tune.fit_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to the ncvreg::ncvreg() function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Original description from <code><a href="SIS.html#topic+tune.fit">SIS::tune.fit()</a></code>:
</p>
<p>This function fits a generalized linear model or a Cox proportional hazards model via penalized maximum likelihood, with available penalties as indicated in the <strong>glmnet</strong> and <strong>ncvreg</strong> packages. Instead of providing the whole regularization solution path, the function returns the solution at a unique value of <code class="reqn">\lambda</code>, the one optimizing the criterion specified in tune.
</p>


<h3>Value</h3>

<p>Returns an object with </p>
<table role = "presentation">
<tr><td><code>ix</code></td>
<td>
<p> The vector of indices of the
nonzero coefficients selected by the maximum penalized likelihood procedure
with <code>tune</code> as the method for choosing the regularization parameter.  </p>
</td></tr>
<tr><td><code>a0</code></td>
<td>
<p>The intercept of the final model selected by <code>tune</code>.  </p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>The vector of coefficients of the final model selected by
<code>tune</code>.  </p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>The fitted penalized regression object.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The corresponding lambda in the final model.</p>
</td></tr>
<tr><td><code>lambda.ind</code></td>
<td>
<p>The index on the solution path for the final model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jianqing Fan, Yang Feng, Diego Franco Saldana, Richard Samworth, and
Yichao Wu
</p>


<h3>References</h3>

<p>Jerome Friedman and Trevor Hastie and Rob Tibshirani (2010)
Regularization Paths for Generalized Linear Models Via Coordinate Descent.
<em>Journal of Statistical Software</em>, <b>33</b>(1), 1-22.
</p>
<p>Noah Simon and Jerome Friedman and Trevor Hastie and Rob Tibshirani (2011)
Regularization Paths for Cox's Proportional Hazards Model Via Coordinate
Descent. <em>Journal of Statistical Software</em>, <b>39</b>(5), 1-13.
</p>
<p>Patrick Breheny and Jian Huang (2011) Coordiante Descent Algorithms for
Nonconvex Penalized Regression, with Applications to Biological Feature
Selection. <em>The Annals of Applied Statistics</em>, <b>5</b>, 232-253.
</p>
<p>Hirotogu Akaike (1973) Information Theory and an Extension of the Maximum
Likelihood Principle. In <em>Proceedings of the 2nd International
Symposium on Information Theory</em>, BN Petrov and F Csaki (eds.), 267-281.
</p>
<p>Gideon Schwarz (1978) Estimating the Dimension of a Model. <em>The Annals
of Statistics</em>, <b>6</b>, 461-464.
</p>
<p>Jiahua Chen and Zehua Chen (2008) Extended Bayesian Information Criteria for
Model Selection with Large Model Spaces. <em>Biometrika</em>, <b>95</b>,
759-771.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
data("leukemia.train", package = "SIS")
y.train &lt;- leukemia.train[, dim(leukemia.train)[2]]
x.train &lt;- as.matrix(leukemia.train[, -dim(leukemia.train)[2]])
x.train &lt;- SIS::standardize(x.train)
model &lt;- tune.fit(x.train[, 1:3500], y.train, family = "binomial", tune = "bic")
model$ix
model$a0
model$beta


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
