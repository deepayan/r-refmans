<!DOCTYPE html><html><head><title>Help for package dacc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dacc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Covest'><p>Regularized estimators for covariance  matrix.</p></a></li>
<li><a href='#fingerprint'><p>Optimal Fingerprinting via total least square regression.</p></a></li>
<li><a href='#fingerprintCEE'><p>Optimal Fingerprinting with Estimating Equations.</p></a></li>
<li><a href='#simDat'><p>Sample Data Used in Simulation Studies of</p>
&quot;Regularized Fingerprinting in Detection and Attribution of Climate Change
with Weight Matrix Optimizing the Efficiency in Scaling Factor Estimation&quot;.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Detection and Attribution Analysis of Climate Change</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-08</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Conduct detection and attribution of climate change using methods including optimal fingerprinting via 
    generalized total least squares or estimating equation approach from Ma et al. (2023) &lt;<a href="https://doi.org/10.1175%2FJCLI-D-22-0681.1">doi:10.1175/JCLI-D-22-0681.1</a>&gt;. 
    Provide shrinkage estimators for covariance matrix from Ledoit and Wolf (2004) &lt;<a href="https://doi.org/10.1016%2FS0047-259X%2803%2900096-4">doi:10.1016/S0047-259X(03)00096-4</a>&gt;, 
    and Ledoit and Wolf (2017) &lt;<a href="https://doi.org/10.2139%2Fssrn.2383361">doi:10.2139/ssrn.2383361</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, stats, utils, Iso, pracma, janitor, magrittr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/LiYanStat/dacc">https://github.com/LiYanStat/dacc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/LiYanStat/dacc/issues">https://github.com/LiYanStat/dacc/issues</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-08 20:44:09 UTC; yzl0317</td>
</tr>
<tr>
<td>Author:</td>
<td>Yan Li [aut, cre],
  Kun Chen [aut],
  Jun Yan [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yan Li &lt;yan.4.li@uconn.edu&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-09 08:20:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='Covest'>Regularized estimators for covariance  matrix.</h2><span id='topic+Covest'></span>

<h3>Description</h3>

<p>This function estimate the covariance matrix under l2 loss and 
minimum variance loss, provide linear shrinkage estimator under 
l2 loss and nonlinear shrinkage estimator under minimum variance loss.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Covest(Z, method = c("mv", "l2"), bandwidth = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Covest_+3A_z">Z</code></td>
<td>
<p>n*p matirx with sample size n and dimension p. 
Replicates for computing the covariance matrix, should be centered.</p>
</td></tr>
<tr><td><code id="Covest_+3A_method">method</code></td>
<td>
<p>methods used for estimating the covariance matrix.</p>
</td></tr>
<tr><td><code id="Covest_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth for the &quot;mv&quot; estimator, 
default value are set to be list in (0.2, 0.5).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>regularized estimate of covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Yan Li
</p>


<h3>References</h3>

 
<ul>
<li><p>  Olivier Ledoit and Michael Wolf (2004),
A well-conditioned estimator for large-dimensional 
covariance matrices, <em>Journal of multivariate analysis</em>, 88(2), 365&ndash;411.
</p>
</li>
<li><p> Olivier Ledoit and Michael Wolf (2017), 
Direct nonlinear shrinkage estimation of 
large-dimensional covariance matrices, <em>Working Paper No. 264, UZH</em>.
</p>
</li>
<li><p> Li et al (2023),
Regularized fingerprinting in detection and attribution of climate change 
with weight matrix optimizing the efficiency in 
scaling factor estimation, <em>Ann. Appl. Stat.</em> 17(1), 225&ndash;239.</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## randomly generate a n * p matrix where n = 50, p = 100
Z &lt;- matrix(rnorm(50 * 100), nrow = 50, 100)
## linear shrinkage estimator under l2 loss
Cov.est &lt;- Covest(Z, method = "l2")$output
## nonlinear shrinkage estimator under minimum variance loss
Cov.est &lt;- Covest(Z, method = "mv", bandwidth = 0.35)$output
</code></pre>

<hr>
<h2 id='fingerprint'>Optimal Fingerprinting via total least square regression.</h2><span id='topic+fingerprint'></span>

<h3>Description</h3>

<p>This function detects the signal factors on the observed data via total 
least square linear regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fingerprint(
  X,
  Y,
  cov,
  nruns.X,
  ctlruns,
  precision = FALSE,
  conf.level = 0.9,
  conf.method = c("none", "TSB", "PBC", "both"),
  cov.method = c("l2", "mv"),
  B = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fingerprint_+3A_x">X</code></td>
<td>
<p>signal pattern to be detected.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_y">Y</code></td>
<td>
<p>observed data.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_cov">cov</code></td>
<td>
<p>Weight matrix used in prewhitening process, can be estimate of 
covariance matrix or precision matrix.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_nruns.x">nruns.X</code></td>
<td>
<p>number of ensembles to estimate the corresponding pattern. 
It is used as the scale of the covariance matrix for Xi.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_ctlruns">ctlruns</code></td>
<td>
<p>a group of independent control runs for estimating 
covariance matrix, which is used in two stage bootstrap and the parametric 
bootstrap calibration.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_precision">precision</code></td>
<td>
<p>indicator for precision matrix, if precision 
matrix estimate is used, precision should be set to TRUE.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for confidence interval estimation.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_conf.method">conf.method</code></td>
<td>
<p>method for calibrating the confidence intervals, including
no calibration (none), two stage bootstrap (TSB), and parametric bootstrap calibration (PBC).</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_cov.method">cov.method</code></td>
<td>
<p>method for estimation of covariance matrix in confidence 
interval procedure. It should be consistent to the method to get cov. (only valid if TSB or PBC is considered.)</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_b">B</code></td>
<td>
<p>number of replicates in two stage bootstrap and/or parametric bootstrap calibration, 
default value is 1000. (only valid if TSB or PBC is considered.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of the fitted model including point estimate and
interval estimate of coefficients and corresponding estimate of 
standard error.
</p>


<h3>Author(s)</h3>

<p>Yan Li
</p>


<h3>References</h3>

 
<ul>
<li><p>  Gleser (1981), Estimation in a Multivariate &quot;Errors in Variables&quot; 
Regression Model: Large Sample Results, <em>Ann. Stat.</em> 9(1) 24&ndash;44.
</p>
</li>
<li><p> Golub and Laon (1980), An Analysis of the Total Least Squares Problem,
<em>SIAM J. Numer. Anal</em>. 17(6) 883&ndash;893.
</p>
</li>
<li><p> Pesta (2012), Total least squares and bootstrapping with 
applications in calibration, <em>Statistics</em> 47(5), 966&ndash;991.
</p>
</li>
<li><p> Li et al (2021), Uncertainty in Optimal Fingerprinting is Underestimated, <em>Environ. Res. Lett.</em> 16(8) 084043.</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(simDat)
## set the true covariance matrix and expected pattern
Cov &lt;- simDat$Cov[[1]]
ANT &lt;- simDat$X[, 1]
NAT &lt;- simDat$X[, 2]
## estimate the covariance matrix
Z &lt;- MASS::mvrnorm(100, mu = rep(0, nrow(Cov)), Sigma = Cov)
## linear shrinkage estimator under l2 loss
Cov.est &lt;- Covest(Z, method = "l2")$output
## generate regression observation and pattern
nruns.X &lt;- c(1, 1)
Y &lt;- MASS::mvrnorm(n = 1, mu = ANT + NAT, Sigma = Cov)
X &lt;- cbind(MASS::mvrnorm(n = 1, mu = ANT, Sigma = Cov),
           MASS::mvrnorm(n = 1, mu = NAT, Sigma = Cov))
fingerprint(X, Y, Cov.est, nruns.X, ctlruns = Z, conf.method = "TSB", B = 5)
</code></pre>

<hr>
<h2 id='fingerprintCEE'>Optimal Fingerprinting with Estimating Equations.</h2><span id='topic+fingerprintCEE'></span>

<h3>Description</h3>

<p>This function estimates the signal factors and corresponding confidence 
interval via the estimating equation methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fingerprintCEE(
  Xtilde,
  Y,
  mruns,
  ctlruns.1,
  ctlruns.2,
  nS,
  nT,
  nB = 0,
  conf.level = 0.9,
  cal.a = TRUE,
  missing = FALSE,
  ridge = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fingerprintCEE_+3A_xtilde">Xtilde</code></td>
<td>
<p><code class="reqn">n \times p</code> matrix, signal pattern to be detected.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_y">Y</code></td>
<td>
<p><code class="reqn">n \times 1</code> matrix, length <code class="reqn">nS \times nT</code>, observed data.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_mruns">mruns</code></td>
<td>
<p>number of ensembles to estimate the corresponding pattern. 
It is used as the scale of the covariance matrix for Xi.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_ctlruns.1">ctlruns.1</code></td>
<td>
<p><code class="reqn">m \times n</code> matrix, a group of <code class="reqn">m</code> independent control 
runs for estimating covariance matrix, which is used in point estimation of 
the signal factors.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_ctlruns.2">ctlruns.2</code></td>
<td>
<p><code class="reqn">m \times n</code> matrix, another group of <code class="reqn">m</code> independent control 
runs for estimating the corresponding confidence interval of the signal factors, 
default same as ctlruns.1.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_ns">nS</code></td>
<td>
<p>number of locations for the observed responses.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_nt">nT</code></td>
<td>
<p>number of time steps for the observed responses.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_nb">nB</code></td>
<td>
<p>number of replicates in bootstrap for the bootstrapped variance and confidence 
interval estimations.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for confidence interval estimation.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_cal.a">cal.a</code></td>
<td>
<p>indicator for calculating the a value, otherwise use default value a = 1.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_missing">missing</code></td>
<td>
<p>indicator for whether missing values present in Y.</p>
</td></tr>
<tr><td><code id="fingerprintCEE_+3A_ridge">ridge</code></td>
<td>
<p>shrinkage value for adjusting the method for missing observations if missing = TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of the fitted model including point estimate and
interval estimate of beta and a coefficients and corresponding estimate of 
variance, together with the residuals for model diagnostics.
</p>


<h3>Author(s)</h3>

<p>Yan Li
</p>


<h3>References</h3>

 
<ul>
<li><p> Sai et al (2023), Optimal Fingerprinting with Estimating Equations,
<em>Journal of Climate</em> 36(20), 7109â€“-7122.</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## load the example dataset
data(simDat)
Cov &lt;- simDat$Cov[[1]]
ANT &lt;- simDat$X[, 1]
NAT &lt;- simDat$X[, 2]

## generate the simulated data set
## generate regression observation
Y &lt;- MASS::mvrnorm(n = 1, mu = ANT + NAT, Sigma = Cov)
## generate the forcing responses
mruns &lt;- c(1, 1)
Xtilde &lt;- cbind(MASS::mvrnorm(n = 1, mu = ANT, Sigma = Cov / mruns[1]),
                MASS::mvrnorm(n = 1, mu = NAT, Sigma = Cov / mruns[2]))
## control runs
ctlruns &lt;- MASS::mvrnorm(100, mu = rep(0, nrow(Cov)), Sigma = Cov)
## ctlruns1 for the point estimation and ctlruns2 for the interval estimation
ctlrun.1 &lt;- ctlrun.2 &lt;- ctlruns
## number of locations
nS &lt;- 25
## number of year steps
nT &lt;- 10
## call the function to estimate the signal factors via CEE
fingerprintCEE(Xtilde, Y, mruns, 
               ctlrun.1, ctlrun.2,
               nS, nT, nB = 10,
               conf.level = 0.9, 
               cal.a = TRUE,
               missing = FALSE, ridge = 0)
</code></pre>

<hr>
<h2 id='simDat'>Sample Data Used in Simulation Studies of 
&quot;Regularized Fingerprinting in Detection and Attribution of Climate Change 
with Weight Matrix Optimizing the Efficiency in Scaling Factor Estimation&quot;.</h2><span id='topic+simDat'></span>

<h3>Description</h3>

<p>A data list of designed covariance matrix and the expected responses 
to the two forcings ANT and NAT with name
<code>Cov</code> and <code>X</code>
where
</p>

<ul>
<li> <p><code>Cov</code>: a list of the true covariance matrices;
</p>
</li>
<li> <p><code>X</code>: a data matrix of the expected responses to external forcing;
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(simDat)
</code></pre>


<h3>Format</h3>

<p>A data list with two separate data sets.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
