<!DOCTYPE html><html><head><title>Help for package dacc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dacc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Covest'><p>Regularized estimators for covariance  matrix.</p></a></li>
<li><a href='#fingerprint'><p>Optimal Fingerprinting via total least square regression.</p></a></li>
<li><a href='#fpPrep'><p>Process netCDF4 Gridded Data into Format of the fingerprint() Function</p></a></li>
<li><a href='#globalDat'><p>Sample Dataset Used in Numerical Studies of</p>
&quot;Detection and Attribution Analysis of Temperature Changes with Estimating Equations&quot;.</a></li>
<li><a href='#simDat'><p>Sample Dataset in Simulation Studies of</p>
&quot;Regularized Fingerprinting in Detection and Attribution of Climate Change
with Weight Matrix Optimizing the Efficiency in Scaling Factor Estimation&quot;.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Detection and Attribution Analysis of Climate Change</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-26</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Conduct detection and attribution of climate change using methods including optimal fingerprinting via 
    generalized total least squares or estimating equation approach from Ma et al. (2023) &lt;<a href="https://doi.org/10.1175%2FJCLI-D-22-0681.1">doi:10.1175/JCLI-D-22-0681.1</a>&gt;. 
    Provide shrinkage estimators for covariance matrix from Ledoit and Wolf (2004) &lt;<a href="https://doi.org/10.1016%2FS0047-259X%2803%2900096-4">doi:10.1016/S0047-259X(03)00096-4</a>&gt;, 
    and Ledoit and Wolf (2017) &lt;<a href="https://doi.org/10.2139%2Fssrn.2383361">doi:10.2139/ssrn.2383361</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, stats, utils, Iso, pracma, janitor, magrittr, sp,
CFtime, ncdf4</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/LiYanStat/dacc">https://github.com/LiYanStat/dacc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/LiYanStat/dacc/issues">https://github.com/LiYanStat/dacc/issues</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-27 12:31:17 UTC; yzl0317</td>
</tr>
<tr>
<td>Author:</td>
<td>Yan Li [aut, cre],
  Kun Chen [aut],
  Jun Yan [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yan Li &lt;yan.4.li@uconn.edu&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-27 12:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Covest'>Regularized estimators for covariance  matrix.</h2><span id='topic+Covest'></span>

<h3>Description</h3>

<p>This function estimate the covariance matrix under l2 loss and 
minimum variance loss, provide linear shrinkage estimator under 
l2 loss and nonlinear shrinkage estimator under minimum variance loss.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Covest(Z, method = c("mv", "l2"), bandwidth = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Covest_+3A_z">Z</code></td>
<td>
<p>n*p matirx with sample size n and dimension p. 
Replicates for computing the covariance matrix, should be centered.</p>
</td></tr>
<tr><td><code id="Covest_+3A_method">method</code></td>
<td>
<p>methods used for estimating the covariance matrix.</p>
</td></tr>
<tr><td><code id="Covest_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth for the &quot;mv&quot; estimator, 
default value are set to be list in (0.2, 0.5).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>regularized estimate of covariance matrix.
</p>


<h3>Author(s)</h3>

<p>Yan Li
</p>


<h3>References</h3>

 
<ul>
<li><p>  Olivier Ledoit and Michael Wolf (2004),
A well-conditioned estimator for large-dimensional 
covariance matrices, <em>Journal of multivariate analysis</em>, 88(2), 365&ndash;411.
</p>
</li>
<li><p> Olivier Ledoit and Michael Wolf (2017), 
Direct nonlinear shrinkage estimation of 
large-dimensional covariance matrices, <em>Working Paper No. 264, UZH</em>.
</p>
</li>
<li><p> Li et al (2023),
Regularized fingerprinting in detection and attribution of climate change 
with weight matrix optimizing the efficiency in 
scaling factor estimation, <em>Ann. Appl. Stat.</em> 17(1), 225&ndash;239.</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## randomly generate a n * p matrix where n = 50, p = 100
Z &lt;- matrix(rnorm(50 * 100), nrow = 50, 100)
## linear shrinkage estimator under l2 loss
Cov.est &lt;- Covest(Z, method = "l2")$output
## nonlinear shrinkage estimator under minimum variance loss
Cov.est &lt;- Covest(Z, method = "mv", bandwidth = 0.35)$output
</code></pre>

<hr>
<h2 id='fingerprint'>Optimal Fingerprinting via total least square regression.</h2><span id='topic+fingerprint'></span>

<h3>Description</h3>

<p>This function estimates the signal factors and corresponding confidence 
interval via the estimating equation or total least squares.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fingerprint(
  Xtilde,
  Y,
  mruns,
  ctlruns.sigma,
  ctlruns.bhvar,
  S,
  T,
  B,
  method = c("EE", "PBC", "TS"),
  cov.method = c("l2", "mv"),
  conf.level = 0.9,
  missing = FALSE,
  cal.a = TRUE,
  ridge = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fingerprint_+3A_xtilde">Xtilde</code></td>
<td>
<p><code class="reqn">n \times p</code> matrix, signal pattern to be detected.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_y">Y</code></td>
<td>
<p><code class="reqn">n \times 1</code> matrix, length <code class="reqn">S \times T</code>, observed climate variable.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_mruns">mruns</code></td>
<td>
<p>number of ensembles to estimate the corresponding pattern. 
It is used as the scale of the covariance matrix for <code class="reqn">X_i</code>.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_ctlruns.sigma">ctlruns.sigma</code></td>
<td>
<p><code class="reqn">m \times n</code> matrix, a group of <code class="reqn">m</code> independent control 
runs for estimating covariance matrix, which is used in point estimation of 
the signal factors.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_ctlruns.bhvar">ctlruns.bhvar</code></td>
<td>
<p><code class="reqn">m \times n</code> matrix, another group of <code class="reqn">m</code> independent control 
runs for estimating the corresponding confidence interval of the signal factors, 
in EE or PBC approach should be same as ctlruns.sigma.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_s">S</code></td>
<td>
<p>number of locations for the observed responses.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_t">T</code></td>
<td>
<p>number of time steps for the observed responses.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_b">B</code></td>
<td>
<p>number of replicates in bootstrap procedure.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_method">method</code></td>
<td>
<p>for estimating the scaling factors and corresponding confidence interval</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_cov.method">cov.method</code></td>
<td>
<p>method for estimation of covariance matrix in confidence 
interval estimation of PBC method. (only for PBC method)</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for confidence interval estimation.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_missing">missing</code></td>
<td>
<p>indicator for whether missing values present in Y.</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_cal.a">cal.a</code></td>
<td>
<p>indicator for calculating the a value, otherwise use default value a = 1. (only for EE method)</p>
</td></tr>
<tr><td><code id="fingerprint_+3A_ridge">ridge</code></td>
<td>
<p>shrinkage value for adjusting the method for missing observations if missing = TRUE. (only for EE method)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of the fitted model including point estimate and
interval estimate of coefficients and corresponding estimate of standard error.
</p>


<h3>Author(s)</h3>

<p>Yan Li
</p>


<h3>References</h3>

 
<ul>
<li><p>  Gleser (1981), Estimation in a Multivariate &quot;Errors in Variables&quot; 
Regression Model: Large Sample Results, <em>Ann. Stat.</em> 9(1) 24&ndash;44.
</p>
</li>
<li><p> Golub and Laon (1980), An Analysis of the Total Least Squares Problem,
<em>SIAM J. Numer. Anal</em>. 17(6) 883&ndash;893.
</p>
</li>
<li><p> Pesta (2012), Total least squares and bootstrapping with 
applications in calibration, <em>Statistics</em> 47(5), 966&ndash;991.
</p>
</li>
<li><p> Li et al (2021), Uncertainty in Optimal Fingerprinting is Underestimated, 
<em>Environ. Res. Lett.</em> 16(8) 084043.
</p>
</li>
<li><p> Sai et al (2023), Optimal Fingerprinting with Estimating Equations,
<em>Journal of Climate</em> 36(20), 7109â€“-7122.
</p>
</li>
<li><p> Li et al (2024), Detection and Attribution Analysis of Temperature Changes with Estimating Equations,
<em>Submitted to Journal of Climate</em>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## load the example dataset
data(simDat)
Cov &lt;- simDat$Cov[[1]]
ANT &lt;- simDat$X[, 1]
NAT &lt;- simDat$X[, 2]

## generate the simulated data set
## generate regression observation
Y &lt;- MASS::mvrnorm(n = 1, mu = ANT + NAT, Sigma = Cov)
## generate the forcing responses
mruns &lt;- c(1, 1)
Xtilde &lt;- cbind(MASS::mvrnorm(n = 1, mu = ANT, Sigma = Cov / mruns[1]),
               MASS::mvrnorm(n = 1, mu = NAT, Sigma = Cov / mruns[2]))
## control runs
ctlruns &lt;- MASS::mvrnorm(100, mu = rep(0, nrow(Cov)), Sigma = Cov)
## ctlruns.sigma for the point estimation and ctlruns.bhvar for the interval estimation
ctlruns.sigma &lt;- ctlruns.bhvar &lt;- ctlruns
## number of locations
S &lt;- 25
## number of year steps
T &lt;- 10

## call the function to estimate the signal factors via EE
fingerprint(Xtilde, Y, mruns,
          ctlruns.sigma, ctlruns.bhvar,
          S, T, B = 10,
          method = "EE",
          conf.level = 0.9,
          cal.a = TRUE,
          missing = FALSE, ridge = 0)
</code></pre>

<hr>
<h2 id='fpPrep'>Process netCDF4 Gridded Data into Format of the fingerprint() Function</h2><span id='topic+fpPrep'></span>

<h3>Description</h3>

<p>This function detects the signal factors on the observed data via total 
least square linear regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fpPrep(
  datafile,
  variable,
  region = "GL",
  target.year,
  average = 5,
  reference = c(1961, 1990),
  regridding = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fpPrep_+3A_datafile">datafile</code></td>
<td>
<p>path to the netCDF4 gridded datafile to be processed</p>
</td></tr>
<tr><td><code id="fpPrep_+3A_variable">variable</code></td>
<td>
<p>the climate variable to be extracted</p>
</td></tr>
<tr><td><code id="fpPrep_+3A_region">region</code></td>
<td>
<p>the longitude and latitude boundary for selected region, 
should match the format of IPCC AR6 regions, the lon and lat of the vertices</p>
</td></tr>
<tr><td><code id="fpPrep_+3A_target.year">target.year</code></td>
<td>
<p>vector of length 2, the starting and ending year of the 
selected time period for D&amp;A analysis</p>
</td></tr>
<tr><td><code id="fpPrep_+3A_average">average</code></td>
<td>
<p>number of years for average on each gridbox, default is 5-year average</p>
</td></tr>
<tr><td><code id="fpPrep_+3A_reference">reference</code></td>
<td>
<p>vector of length 2, the starting and ending year of reference 
time period for computing anomalies</p>
</td></tr>
<tr><td><code id="fpPrep_+3A_regridding">regridding</code></td>
<td>
<p>whether the grid box should be regridded. Specify the size of 
the grid box, e.g., c(40, 30) for <code class="reqn">40^\circ \times 30^\circ</code> grid box.
If no regridding, leave empty</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataset of the processed gridded climate variables for Y, 
Xtilde or control runs
</p>


<h3>Author(s)</h3>

<p>Yan Li
</p>

<hr>
<h2 id='globalDat'>Sample Dataset Used in Numerical Studies of 
&quot;Detection and Attribution Analysis of Temperature Changes with Estimating Equations&quot;.</h2><span id='topic+globalDat'></span>

<h3>Description</h3>

<p>A list of the observations and expected responses 
to different external forcings with name
<code>Y</code>, <code>X</code>, <code>ctlruns</code>, <code>nruns.X</code> and <code>Xtilde</code>
where
</p>

<ul>
<li> <p><code>Y</code>: the <code class="reqn">5^\circ \times 5^\circ</code> gridded observations on global scale
</p>
</li>
<li> <p><code>X</code>: a data matrix of the expected responses to external forcing;
</p>
</li>
<li> <p><code>ctlruns</code>: replicates of control runs from pre-industrial simulations
</p>
</li>
<li> <p><code>nruns.X</code>: number of runs for the estimated responses to external forcings
</p>
</li>
<li> <p><code>Xtilde</code>: the selected estimated responses to external forcing ANT and NAT
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(globalDat)
</code></pre>


<h3>Format</h3>

<p>A data list with the observed and simulated data on global scale.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(globalDat)
</code></pre>

<hr>
<h2 id='simDat'>Sample Dataset in Simulation Studies of 
&quot;Regularized Fingerprinting in Detection and Attribution of Climate Change 
with Weight Matrix Optimizing the Efficiency in Scaling Factor Estimation&quot;.</h2><span id='topic+simDat'></span>

<h3>Description</h3>

<p>A data list of designed covariance matrix and the expected responses 
to the two forcings ANT and NAT with name
<code>Cov</code> and <code>X</code>
where
</p>

<ul>
<li> <p><code>Cov</code>: a list of the true covariance matrices;
</p>
</li>
<li> <p><code>X</code>: a data matrix of the expected responses to external forcing;
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(simDat)
</code></pre>


<h3>Format</h3>

<p>A data list with two separate data sets.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDat)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
