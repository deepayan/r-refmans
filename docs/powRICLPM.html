<!DOCTYPE html><html lang="en"><head><title>Help for package powRICLPM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {powRICLPM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#powRICLPM-package'><p>powRICLPM: Perform Power Analysis for the RI-CLPM and STARTS Model</p></a></li>
<li><a href='#check_Phi'><p>Check Interpretation <code>Phi</code> Argument</p></a></li>
<li><a href='#give'><p>Extract Information From <code>powRICLPM</code> Object</p></a></li>
<li><a href='#plot.powRICLPM'><p>Plot Results From <code>powRICLPM</code> Object</p></a></li>
<li><a href='#powRICLPM'><p>Power analysis for the RI-CLPM (and STARTS model)</p></a></li>
<li><a href='#powRICLPM_Mplus'><p>(superseded) Create Mplus Syntax for RI-CLPM Power Analysis</p></a></li>
<li><a href='#print.powRICLPM'><p>Print <code>powRICLPM</code> Object</p></a></li>
<li><a href='#summary.powRICLPM'><p>Summarize Results from <code>powRICLPM</code> Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Perform Power Analysis for the RI-CLPM and STARTS Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-10-26</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jeroen Mulder &lt;j.d.mulder@uu.nl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform user-friendly power analyses for the random
    intercept cross-lagged panel model (RI-CLPM) and the bivariate stable trait 
    autoregressive trait state (STARTS) model. The strategy as proposed by 
    Mulder (2023) &lt;<a href="https://doi.org/10.1080%2F10705511.2022.2122467">doi:10.1080/10705511.2022.2122467</a>&gt; is implemented. Extensions 
    include the use of parameter constraints over time, bounded estimation,
    generation of data with skewness and kurtosis, and the option to setup the power 
    analysis for Mplus. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://jeroendmulder.github.io/powRICLPM/">https://jeroendmulder.github.io/powRICLPM/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/JeroenDMulder/powRICLPM/issues/">https://github.com/JeroenDMulder/powRICLPM/issues/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), stats, utils</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, future.apply, lavaan (&ge; 0.6.7), lifecycle, progressr,
rlang, ggplot2, future</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-26 13:36:53 UTC; 5879167</td>
</tr>
<tr>
<td>Author:</td>
<td>Jeroen Mulder <a href="https://orcid.org/0000-0002-5553-0856"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Netherlands Organization for Scientific Research [fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-26 13:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='powRICLPM-package'>powRICLPM: Perform Power Analysis for the RI-CLPM and STARTS Model</h2><span id='topic+powRICLPM-package'></span>

<h3>Description</h3>

<p>Perform user-friendly power analyses for the random intercept cross-lagged panel model (RI-CLPM) and the bivariate stable trait autoregressive trait state (STARTS) model. The strategy as proposed by Mulder (2023) <a href="https://doi.org/10.1080/10705511.2022.2122467">doi:10.1080/10705511.2022.2122467</a> is implemented. Extensions include the use of parameter constraints over time, bounded estimation, generation of data with skewness and kurtosis, and the option to setup the power analysis for Mplus.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jeroen Mulder <a href="mailto:j.d.mulder@uu.nl">j.d.mulder@uu.nl</a> (<a href="https://orcid.org/0000-0002-5553-0856">ORCID</a>) [copyright holder]
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Netherlands Organization for Scientific Research [funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://jeroendmulder.github.io/powRICLPM/">https://jeroendmulder.github.io/powRICLPM/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/JeroenDMulder/powRICLPM/issues/">https://github.com/JeroenDMulder/powRICLPM/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='check_Phi'>Check Interpretation <code>Phi</code> Argument</h2><span id='topic+check_Phi'></span>

<h3>Description</h3>

<p>Write a textual interpretation of the values in <code>Phi</code>. This can be used to check if <code>Phi</code> has been correctly specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_Phi(Phi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_Phi_+3A_phi">Phi</code></td>
<td>
<p>A matrix, with standardized autoregressive effects (on the diagonal) and cross-lagged effects (off-diagonal) in the population. Columns represent predictors and rows represent outcomes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Correctly specified `Phi`
Phi1 &lt;- matrix(c(.4, .1, .2, .3), ncol = 2, byrow = TRUE)
check_Phi(Phi1)

# `Phi` with too large standardized effects
Phi2 &lt;- matrix(c(.6, .5, .4, .7), ncol = 2, byrow = TRUE)
Phi2 &lt;- check_Phi(Phi2)
</code></pre>

<hr>
<h2 id='give'>Extract Information From <code>powRICLPM</code> Object</h2><span id='topic+give'></span>

<h3>Description</h3>

<p>Extract information stored within a <code>powRICLPM</code> object (internally used by <code><a href="#topic+print.powRICLPM">print.powRICLPM</a></code> and <code><a href="#topic+summary.powRICLPM">summary.powRICLPM</a></code>). See &quot;Details&quot; for which pieces of information can be extracted. The information is presented by condition (i.e., sample size, number of time points, and ICC).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>give(from, what, parameter = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="give_+3A_from">from</code></td>
<td>
<p>A <code>powRICLPM</code> object</p>
</td></tr>
<tr><td><code id="give_+3A_what">what</code></td>
<td>
<p>A character string, denoting the information to extract, either &quot;conditions&quot;, &quot;estimation_problems&quot;, &quot;results&quot;, or &quot;names&quot;.</p>
</td></tr>
<tr><td><code id="give_+3A_parameter">parameter</code></td>
<td>
<p>(optional) When <code>what = "results"</code>, a character string denoting the parameter to extract the results for.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following information can be extracted from the <code>powRICLPM</code> object:
</p>

<ul>
<li> <p><code>conditions</code>: A <code>data.frame</code> with the different experimental conditions per row, where each condition is defined by a unique combination of sample size, number of time points and ICC.
</p>
</li>
<li> <p><code>estimation_problems</code>: The proportion of fatal errors, inadmissible values, or non-converged estimations (columns) per experimental conditions (row).
</p>
</li>
<li> <p><code>results</code>: The average estimate (<code>average</code>), minimum estimate (<code>minimum</code>), standard deviation of parameter estimates (<code>SD</code>), the average standard error (<code>SEavg</code>), the mean square error (<code>MSE</code>), the average width of the confidence interval (<code>accuracy</code>), the coverage rate (<code>coverage</code>), and the proportion of times the <em>p</em>-value was lower than the significance criterion (<code>power</code>). It requires setting the <code>parameter = "..."</code> argument.
</p>
</li>
<li> <p><code>names</code>: The parameter names in the condition with the least parameters (i.e., parameter names that apply to each experimental condition).
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>data.frame</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Return data frame with number of estimation problems per experimental condition
give(out_preliminary, "estimation_problems")

# Return data frame with performance measures for "wB2~wA1" per experimental condition
give(out_preliminary, "results", parameter = "wB2~wA1")

# Return character vector with parameter names
give(out_preliminary, "names")
</code></pre>

<hr>
<h2 id='plot.powRICLPM'>Plot Results From <code>powRICLPM</code> Object</h2><span id='topic+plot.powRICLPM'></span>

<h3>Description</h3>

<p>Visualizes (using <span class="pkg">ggplot2</span>) the results from a <code>powRICLPM</code> analysis, for a specific parameter, across all experimental conditions. By default, sample size is plotted on the x-axis, power on the y-axis, with results colored by the number of time points, wrapped by the proportion of between-unit variance, and shaped by the reliability. Optionally, other variables can be mapped to the y-axis, x-axis, color, shape, and facets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'powRICLPM'
plot(
  x,
  y = "power",
  ...,
  parameter = NULL,
  color_by = "time_points",
  shape_by = "reliability",
  facet_by = "ICC"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.powRICLPM_+3A_x">x</code></td>
<td>
<p>A <code>powRICLPM</code> object.</p>
</td></tr>
<tr><td><code id="plot.powRICLPM_+3A_y">y</code></td>
<td>
<p>(optional) A <code>character</code> string, specifying which outcome is plotted on the y-axis (see &quot;Details&quot;).</p>
</td></tr>
<tr><td><code id="plot.powRICLPM_+3A_...">...</code></td>
<td>
<p>(don't use)</p>
</td></tr>
<tr><td><code id="plot.powRICLPM_+3A_parameter">parameter</code></td>
<td>
<p>Character string of length 1, denoting the parameter to visualize the results for.</p>
</td></tr>
<tr><td><code id="plot.powRICLPM_+3A_color_by">color_by</code></td>
<td>
<p>Character string of length 1, denoting what variable to map to color (see &quot;Details&quot;).</p>
</td></tr>
<tr><td><code id="plot.powRICLPM_+3A_shape_by">shape_by</code></td>
<td>
<p>Character string of length 1, denoting what variable to map to point shapes (see &quot;Details&quot;).</p>
</td></tr>
<tr><td><code id="plot.powRICLPM_+3A_facet_by">facet_by</code></td>
<td>
<p>Character string of length 1, denoting what variable to facet by (see &quot;Details&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Mapping Options</h4>

<p>The following outcomes can be plotted on the y-axis:
</p>

<ul>
<li> <p><code>average</code>: The average estimate.
</p>
</li>
<li> <p><code>MSE</code>: The mean square error.
</p>
</li>
<li> <p><code>coverage</code>: The coverage rate
</p>
</li>
<li> <p><code>accuracy</code>: The average width of the confidence interval.
</p>
</li>
<li> <p><code>SD</code>: Standard deviation of parameter estimates.
</p>
</li>
<li> <p><code>SEAvg</code>: Average standard error.
</p>
</li>
<li> <p><code>bias</code>: The absolute difference between the average estimate and population value.
</p>
</li></ul>

<p>The following variables can be mapped to color, shape, and facet:
</p>

<ul>
<li> <p><code>sample_size</code>: Sample size.
</p>
</li>
<li> <p><code>time_points</code>: Time points.
</p>
</li>
<li> <p><code>ICC</code>: Intraclass correlation (ICC).
</p>
</li>
<li> <p><code>reliability</code>: Item-reliablity.
</p>
</li></ul>




<h3>Value</h3>

<p>A <code>ggplot2</code> object.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+give">give</a></code>: Extract information (e.g., performance measures) for a specific parameter, across all experimental conditions. This function is used internally by <code>plot.powRICLPM</code>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Visualize power for "wB2~wA1" across simulation conditions
plot(out_preliminary, parameter = "wB2~wA1")

# Visualize bias for "wB2~wA1" across simulation conditions
plot(out_preliminary, y = "bias", parameter = "wB2~wA1")

# Visualize coverage rate for "wB2~wA1" across simulation conditions
plot(out_preliminary, y = "coverage", parameter = "wB2~wA1")

# Visualize MSE for autoregressive effect across simulation conditions
plot(out_preliminary, y = "MSE", parameter = "wA2~wA1")

# Error: No parameter specified
try(plot(out_preliminary))
</code></pre>

<hr>
<h2 id='powRICLPM'>Power analysis for the RI-CLPM (and STARTS model)</h2><span id='topic+powRICLPM'></span>

<h3>Description</h3>

<p>Perform a Monte Carlo power analysis for the random intercept cross-lagged panel model (RI-CLPM) and the stable trait autoregressive trait state model (STARTS). This function computes performance metrics such as bias, mean square error, coverage, power, etc, for all model parameters, and can perform power analyses across multiple experimental conditions simultaneously. Conditions are defined in terms of sample size, number of time points, proportion of between-unit variance (ICC), and indicator reliability. See &quot;Details&quot; for information on (a) internal data simulation, (b) internal model estimation, (c) <code>powRICLPM</code>'s naming conventions of parameters, (d) parallel execution capabilities for speeding up the analysis, and (e) various extensions, such as the option to include measurement errors for data generation and estimation (i.e., the STARTS model), imposing various constraints over time, and many more.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powRICLPM(
  target_power = 0.8,
  search_lower = NULL,
  search_upper = NULL,
  search_step = 20,
  sample_size = NULL,
  time_points,
  ICC,
  RI_cor,
  Phi,
  within_cor,
  reliability = 1,
  skewness = 0,
  kurtosis = 0,
  estimate_ME = FALSE,
  significance_criterion = 0.05,
  alpha = NULL,
  reps = 20,
  bootstrap_reps = NULL,
  seed = NA,
  constraints = "none",
  bounds = FALSE,
  estimator = "ML",
  save_path = NULL,
  software = "lavaan"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powRICLPM_+3A_target_power">target_power</code></td>
<td>
<p>A numeric value between 0 and 1, denoting the targeted power level.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_search_lower">search_lower</code></td>
<td>
<p>A positive <code>integer</code>, denoting the lower bound of a range of sample sizes.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_search_upper">search_upper</code></td>
<td>
<p>A positive <code>integer</code>, denoting the upper bound of a range of sample sizes.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_search_step">search_step</code></td>
<td>
<p>A positive <code>integer</code>, denoting an increment in sample size.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_sample_size">sample_size</code></td>
<td>
<p>(optional) An <code>integer</code> (vector), indicating specific sample sizes at which to evaluate power, rather than specifying a range using the <code>search_*</code> arguments.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_time_points">time_points</code></td>
<td>
<p>An <code>integer</code> (vector) with elements at least larger than 3, indicating number of time points.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_icc">ICC</code></td>
<td>
<p>A <code>double</code> (vector) with elements between 0 and 1, denoting the proportion of (true score) variance at the between-unit level. When measurement error is included in the data generating model, ICC is computed as the variance of the random intercept factor divided by the true score variance (i.e., controlled for measurement error).</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_ri_cor">RI_cor</code></td>
<td>
<p>A <code>double</code> between 0 and 1, denoting the correlation between random intercepts.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_phi">Phi</code></td>
<td>
<p>A matrix, with standardized autoregressive effects (on the diagonal) and cross-lagged effects (off-diagonal) in the population. Columns represent predictors and rows represent outcomes.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_within_cor">within_cor</code></td>
<td>
<p>A <code>double</code> between 0 and 1, denoting the correlation between the within-unit components.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_reliability">reliability</code></td>
<td>
<p>(optional) A <code>numeric</code> vector with elements between 0 and 1, denoting the reliability of the variables (see &quot;Details&quot;).</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_skewness">skewness</code></td>
<td>
<p>(optional) A <code>numeric</code>, denoting the skewness values for the observed variables (see <code><a href="lavaan.html#topic+simulateData">simulateData</a></code>).</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_kurtosis">kurtosis</code></td>
<td>
<p>(optional) A <code>numeric</code> value, denoting the excess kurtosis values (i.e., compared to the kurtosis of a normal distribution) for the observed variables (see <code><a href="lavaan.html#topic+simulateData">simulateData</a></code>).</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_estimate_me">estimate_ME</code></td>
<td>
<p>(optional) A <code>logical</code>, denoting if measurement error variance should be estimated in the RI-CLPM (see &quot;Details&quot;).</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_significance_criterion">significance_criterion</code></td>
<td>
<p>(optional) A <code>double</code>, denoting the significance criterion.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_alpha">alpha</code></td>
<td>
<p>(don't use) Deprecated, use <code>significance_criterion</code> instead.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_reps">reps</code></td>
<td>
<p>A positive <code>integer</code>, denoting the number of Monte Carlo replications to be used during simulations.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_bootstrap_reps">bootstrap_reps</code></td>
<td>
<p>(superseded) Uncertainty regarding simulation estimates is now computed analytically based on Morris et al. (2017). This argument is not used anymore.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_seed">seed</code></td>
<td>
<p>An <code>integer</code> of length 1. If multiple cores are used, a seed will be used to generate a full L'Ecuyer-CMRG seed for all cores.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_constraints">constraints</code></td>
<td>
<p>(optional) A <code>character</code> string, specifying the type of constraints that should be imposed on the estimation model (see &quot;Details&quot;).</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_bounds">bounds</code></td>
<td>
<p>(optional) A <code>logical</code>, denoting if bounded estimation should be used for the latent variable variances in the model (see &quot;Details&quot;).</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_estimator">estimator</code></td>
<td>
<p>(optional) A <code>character</code> string of length 1, denoting the estimator to be used (default: <code>ML</code>, see &quot;Details&quot;).</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_save_path">save_path</code></td>
<td>
<p>A <code>character</code> string of length 1, naming the directory to save (data) files to (used for validation purposes of this package). Variables are saved in alphabetical and numerical order.</p>
</td></tr>
<tr><td><code id="powRICLPM_+3A_software">software</code></td>
<td>
<p>A <code>character</code> string of length, naming which software to use for simulations; either &quot;lavaan&quot; or &quot;Mplus&quot; (see &quot;Details&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A rationale for the power analysis strategy implemented in this package can be found in Mulder (2023).
</p>


<h4>Data Generation</h4>

<p>Data are generated using <code><a href="lavaan.html#topic+simulateData">simulateData</a></code> from the <span class="pkg">lavaan</span> package. Based on <code>Phi</code> and <code>within_cor</code>, the residual variances and covariances for the within-components at wave 2 and later are computed, such that the within-components themselves have a variance of 1. This implies that the lagged effects in <code>Phi</code> can be interpreted as standardized effects.</p>



<h4>Model Estimation using lavaan</h4>

<p>When <code>software = "lavaan"</code> (default), generated data are analyzed using <code><a href="lavaan.html#topic+lavaan">lavaan</a></code> from the <span class="pkg">lavaan</span> package. The default estimator is maximum likelihood (<code>ML</code>). Other maximum likelihood based estimators implemented in <a href="https://lavaan.ugent.be/tutorial/est.html"><span class="pkg">lavaan</span></a> can be specified as well. When skewed or kurtosed data are generated (using the <code>skewness</code> and <code>kurtosis</code> arguments), the estimator defaults to robust maximum likelihood <code>MLR</code>. The population parameter values are used as starting values.
</p>
<p>Parameter estimates from non-converged model solutions are discarded from the results. When <code>bounds = FALSE</code>, inadmissible parameter estimates from converged solutions (e.g., a negative random intercept variance) are discarded. When <code>bounds = TRUE</code>, inadmissible parameter estimates are retained following advice by De Jonckere and Rosseel (2022). The results include the minimum estimates for all parameters across replications to diagnose which parameter(s) might be the cause of the inadmissible solution.</p>



<h4>Using Mplus</h4>

<p>When <code>software = "Mplus"</code>, Mplus input files will be generated and saved into <code>save_path</code>. Note that it is not possible to generate skewed or kurtosed data in Mplus via the <code>powRICLPM</code> package. Furthermore, bounded estimation is not available in Mplus. Therefore, the <code>skewness</code>, <code>kurtosis</code>, and <code>bounds</code> will be ignored when <code>software = "Mplus"</code>. </p>



<h4>Naming Conventions Observed and Latent Variables</h4>

<p>The observed variables in the RI-CLPM are given default names, namely capital letters in alphabetical order, with numbers denoting the measurement occasion. For example, for a bivariate RICLPM with 3 time points, we observe <code>A1</code>, <code>A2</code>, <code>A3</code>, <code>B1</code>, <code>B2</code>, and <code>B3</code>. Their within-components are denoted by <code>wA1</code>, <code>wA2</code>, ..., <code>wB3</code>, respectively. The between-components have <code>RI_</code> prepended to the variable name, resulting in <code>RI_A</code> and <code>RI_B</code>.
</p>
<p>Parameters are denoted using <span class="pkg">lavaan</span> model syntax (see <a href="https://lavaan.ugent.be/tutorial/syntax1.html">the <span class="pkg">lavaan</span> website</a>). For example, the random intercept variances are denoted by <code>RI_A~~RI_A</code> and <code>RI_B~~RI_B</code>, the cross-lagged effects at the first wave as <code>wB2~wA1</code> and <code>wA2~wB1</code>, and the autoregressive effects as <code>wA2~wA1</code> and <code>wB2~wB1</code>. Use <code>give(object, "names")</code> to extract parameter names from the <code>powRICLPM</code> object.</p>



<h4>Parallel Processing and Progress Bar</h4>

<p>To speed up the analysis, power analysis for multiple experimental conditions can be executed in parallel. This has been implemented using <span class="pkg">future</span>. By default the analysis is executed sequentially (i.e., single-core). Parallel execution (i.e., multicore) can be setup using <code><a href="future.html#topic+plan">plan</a></code>, for example <code>plan(multisession, workers = 4)</code>. For more information and options, see <a href="https://future.futureverse.org/articles/future-1-overview.html#controlling-how-futures-are-resolved">https://future.futureverse.org/articles/future-1-overview.html#controlling-how-futures-are-resolved</a>.
</p>
<p>A progress bar displaying the status of the power analysis has been implemented using <span class="pkg">progressr</span>. By default, a simple progress bar will be shown. For more information on how to control this progress bar and several other notification options (e.g., auditory notifications), see <a href="https://progressr.futureverse.org">https://progressr.futureverse.org</a>.</p>



<h4>Extension: Measurement Errors (STARTS model)</h4>

<p>Including measurement error to the RI-CLPM makes the model equivalent to the bivariate STARTS model by Kenny and Zautra (2001) without constraints over time. Measurement error can be added to the generated data through the <code>reliability</code> argument. Setting the reliability-argument to 0.8 implies that 80 percent is the true score variance, and 20 measurement error variance. <code>ICC</code> then denotes the proportion of <em>true score variance</em> captured by the random intercept factors. Estimating measurement errors (i.e., the STARTS model) is done by setting <code>estimate_ME = TRUE</code>.</p>



<h4>Extension: Imposing Constraints</h4>

<p>The following constraints can be imposed on the estimation model using the <code>constraints = "..."</code> argument:
</p>

<ul>
<li> <p><code>lagged</code>: Time-invariant autoregressive and cross-lagged effects.
</p>
</li>
<li> <p><code>residuals</code>: Time-invariant residual variances.
</p>
</li>
<li> <p><code>within</code>: Time-invariant lagged effects and residual variances.
</p>
</li>
<li> <p><code>stationarity</code>: Constraints such that at the within-unit level a stationary process is estimated. This included time-invariant lagged effects, and constraints on the residual variances.
</p>
</li>
<li> <p><code>ME</code>: Time-invariant measurement error variances. Only possible when <code>estimate_ME = TRUE</code>.
</p>
</li></ul>




<h4>Extension: Bounded Estimation</h4>

<p>Bounded estimation is useful to avoid nonconvergence in small samples. Here, automatic wide bounds are used as advised by De Jonckere and Rosseel (2022), see <code>optim.bounds</code> in <code><a href="lavaan.html#topic+lavOptions">lavOptions</a></code>. This option can only be used when no constraints are imposed on the estimation model.</p>



<h3>Value</h3>

<p>An object of class <code>powRICLPM</code>, upon which <code>summary()</code>, <code>print()</code>, and <code>plot()</code> can be used. The returned object is a <code>list</code> with a <code>conditions</code> and <code>session</code> element. <code>condition</code> itself is a <code>list</code> of experimental conditions, where each element is again a <code>list</code> containing the input and output of the power analysis for that particular experimental condition. <code>session</code> is a <code>list</code> containing information common to all experimental conditions.
</p>


<h3>Author(s)</h3>

<p>Jeroen D. Mulder <a href="mailto:j.d.mulder@uu.nl">j.d.mulder@uu.nl</a>
</p>


<h3>References</h3>

<p>De Jonckere, J., &amp; Rosseel, Y. (2022). Using bounded estimation to avoid nonconvergence in small sample structural equation modeling. <em>Structural Equation Modeling</em>, <em>29</em>(3), 412-427. <a href="https://doi.org/10.1080/10705511.2021.1982716">doi:10.1080/10705511.2021.1982716</a>
</p>
<p>Kenny, D. A., &amp; Zautra, A. (2001). Trait–state models for longitudinal data. <em>New methods for the analysis of change</em> (pp. 243–263). American Psychological Association. <a href="https://doi.org/10.1037/10409-008">doi:10.1037/10409-008</a>
</p>
<p>Mulder, J. D. (2022). Power analysis for the random intercept cross-lagged panel model using the <em>powRICLPM</em> R-package. <em>Structural Equation Modeling</em>. <a href="https://doi.org/10.1080/10705511.2022.2122467">doi:10.1080/10705511.2022.2122467</a>
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+summary.powRICLPM">summary.powRICLPM</a></code>: Summarize the setup of <code>powRICLPM</code> object.
</p>
</li>
<li> <p><code><a href="#topic+give">give</a></code>: Extract information from <code>powRICLPM</code> objects.
</p>
</li>
<li> <p><code><a href="#topic+plot.powRICLPM">plot.powRICLPM</a></code>: Visualize results <code>powRICLPM</code> object for a specific parameter.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Define population parameters for lagged effects
Phi &lt;- matrix(c(.4, .1, .2, .3), ncol = 2, byrow = TRUE)

# (optional) Set up parallel computing (i.e., multicore, speeding up the analysis)
library(future)
library(progressr)
future::plan(multisession, workers = 6)

## Not run: 
# Run analysis (`reps` is small, because this is an example)
with_progress({
  out_preliminary &lt;- powRICLPM(
    target_power = 0.8,
    search_lower = 500,
    search_upper = 700,
    search_step = 100,
    time_points = c(3, 4),
    ICC = c(0.4, 0.6),
    reliability = c(1, 0.8),
    RI_cor = 0.3,
    Phi = Phi,
    within_cor = 0.3,
    reps = 100,
    seed = 1234
  )
})

## End(Not run)



</code></pre>

<hr>
<h2 id='powRICLPM_Mplus'>(superseded) Create Mplus Syntax for RI-CLPM Power Analysis</h2><span id='topic+powRICLPM_Mplus'></span>

<h3>Description</h3>

<p>The function <code>powRICLPM_Mplus</code> has been superseded and is no longer available in the current version of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powRICLPM_Mplus(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powRICLPM_Mplus_+3A_...">...</code></td>
<td>
<p>(don't use)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functionality previously provided by <code>powRICLPM_Mplus</code> has been replaced by <code>powRICLPM</code>, where you can now set <code>software = "Mplus"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+powRICLPM">powRICLPM()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  # Use `software = "Mplus"` to setup power analysis for Mplus
  out_preliminary &lt;- powRICLPM(
    target_power = 0.8,
    search_lower = 500,
    search_upper = 700,
    search_step = 100,
    time_points = c(3, 4),
    ICC = c(0.4, 0.6),
    reliability = c(1, 0.8),
    RI_cor = 0.3,
    Phi = Phi,
    within_cor = 0.3,
    reps = 1000,
    seed = 1234,
    software = "Mplus"
  )

## End(Not run)
</code></pre>

<hr>
<h2 id='print.powRICLPM'>Print <code>powRICLPM</code> Object</h2><span id='topic+print.powRICLPM'></span>

<h3>Description</h3>

<p><code>print.powRICLPM</code> prints a table listing all experimental conditions contained in the <code>powRICLPM</code> object, as well as the frequency of the estimation problems that occurred in each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'powRICLPM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.powRICLPM_+3A_x">x</code></td>
<td>
<p>A <code>powRICLPM</code> object.</p>
</td></tr>
<tr><td><code id="print.powRICLPM_+3A_...">...</code></td>
<td>
<p>(don't use)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>

<hr>
<h2 id='summary.powRICLPM'>Summarize Results from <code>powRICLPM</code> Object</h2><span id='topic+summary.powRICLPM'></span>

<h3>Description</h3>

<p>S3 method for class <code>powRICLPM</code>. <code>summary.powRICLPM</code> summarizes the setup and results of the <code>powRICLPM</code> analysis. Depending on the arguments that are set, <code>summary.powRICLPM</code> provides a different summary (see &quot;Details&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'powRICLPM'
summary(
  object,
  ...,
  parameter = NULL,
  sample_size = NULL,
  time_points = NULL,
  ICC = NULL,
  reliability = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.powRICLPM_+3A_object">object</code></td>
<td>
<p>A <code>powRICLPM</code> object.</p>
</td></tr>
<tr><td><code id="summary.powRICLPM_+3A_...">...</code></td>
<td>
<p>(don't use)</p>
</td></tr>
<tr><td><code id="summary.powRICLPM_+3A_parameter">parameter</code></td>
<td>
<p>Character string of length 1 denoting the parameter to visualize the results for.</p>
</td></tr>
<tr><td><code id="summary.powRICLPM_+3A_sample_size">sample_size</code></td>
<td>
<p>(optional) An <code>integer</code>, denoting the sample size of the experimental condition of interest.</p>
</td></tr>
<tr><td><code id="summary.powRICLPM_+3A_time_points">time_points</code></td>
<td>
<p>(optional) An <code>integer</code>, denoting the number of time points of the experimental condition of interest.</p>
</td></tr>
<tr><td><code id="summary.powRICLPM_+3A_icc">ICC</code></td>
<td>
<p>(optional) A <code>double</code>, denoting the proportion of variance at the between-unit level of the experimental condition of interest.</p>
</td></tr>
<tr><td><code id="summary.powRICLPM_+3A_reliability">reliability</code></td>
<td>
<p>(optional) An <code>integer</code>, denoting the reliability of the indicators of the experimental condition of interest.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.powRICLPM</code> provides a different summary of the <code>powRICLPM</code> object, depending on the additional arguments that are set:
</p>

<ul>
<li><p> When <code>sample_size = ...</code>, <code>time_points = ...</code>, <code>ICC = ...</code>, and <code>reliability</code> are set: Estimation information and results for all parameters across experimental conditions.
</p>
</li>
<li><p> When <code>parameter = "..."</code> is set: Estimation information and results for a specific parameter across all experimental conditions.
</p>
</li>
<li><p> No additional arguments: Characteristics of the different experimental conditions are summarized, as well as session info (information that applies to all conditions, such the number of replications, etc.).
</p>
</li></ul>



<h4>Interpretation Output</h4>

<p>Depending on the arguments that you set, <code>summary()</code> prints a table with different analysis outcomes in the columns and where each row refers to a different experimental condition. The following information is available:
</p>

<ul>
<li> <p><code>Sample size</code>, <code>Time points</code>, <code>ICC</code>, <code>Reliability</code>: The experimental condition that the row refers to.
</p>
</li>
<li> <p><code>Population</code>: The true value of the parameter.
</p>
</li>
<li> <p><code>Avg</code>: The average (across replications) parameter estimate.
</p>
</li>
<li> <p><code>Bias</code>: The difference between the population value and the average parameter estimate.
</p>
</li>
<li> <p><code>Min</code>: The lowest (across replications) parameter estimate.
</p>
</li>
<li> <p><code>SD</code>: The standard deviation of the parameter estimate over replications.
</p>
</li>
<li> <p><code>SEAvg</code>: The average (across replications) standard error of the parameter estimate.
</p>
</li>
<li> <p><code>MSE</code>: The parameter mean square error, combining a parameter's bias and efficiency.
</p>
</li>
<li> <p><code>Accuracy</code>: The average (across replications) width of the confidence interval.
</p>
</li>
<li> <p><code>Cover</code>: The coverage rate, representing the proportion of times (across replications) the true parameter estimate fell in the confidence interval.
</p>
</li>
<li> <p><code>Power</code>: The proportion of times (across replications) the confidence interval did not contain zero.
</p>
</li>
<li> <p><code>Error</code>: The number of replications that failed to run (i.e., <code>lavaan()</code> produced an error).
</p>
</li>
<li> <p><code>Not converged</code>: The number of replications that did not converge to a solution.
</p>
</li>
<li> <p><code>Inadmissible</code>: The number of replications that converged to an inadmissible solution (e.g., a variance estimated to be lower than zero).
</p>
</li></ul>




<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Get setup of powRICLPM analysis and convergence issues
summary(out_preliminary)

# Performance measures for "wB2~wA1" parameter across experimental conditions
summary(out_preliminary, parameter = "wB2~wA1")

# Performance measures for all parameters, for specific experimental condition
summary(out_preliminary, sample_size = 700, time_points = 4, ICC = .3, reliability = 1)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
