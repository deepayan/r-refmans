<!DOCTYPE html><html><head><title>Help for package seawaveQ</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {seawaveQ}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#seawaveQ-package'><p>A model and utilities for analyzing trends in chemical</p>
concentrations in streams with a seasonal wave (seawave) and
adjustment for streamflow (Q) and other ancillary variables
(Q) and other ancillary variables</a></li>
<li><a href='#cenScatPlot'><p>Scatter plot of water-quality data</p></a></li>
<li><a href='#combineData'><p>Combine water-quality sample data and continuous ancillary</p>
variables</a></li>
<li><a href='#compwaveconv'><p>Seasonal Wave Computation</p></a></li>
<li><a href='#cqwMoRivOmaha'><p>Continuously monitored (daily) data for 06610000 Missouri River at Omaha, Neb.</p></a></li>
<li><a href='#examplecavdat'><p>Example continuous ancillary variable data.</p></a></li>
<li><a href='#examplecavmat'><p>Example continuous ancillary variable matrix.</p></a></li>
<li><a href='#examplecdatsub'><p>Example water-quality data.</p></a></li>
<li><a href='#examplecentmp'><p>Example logical vector.</p></a></li>
<li><a href='#exampleclog'><p>Example of logarithmically transformed concentration data.</p></a></li>
<li><a href='#exampleqwcols'><p>Example data indicators.</p></a></li>
<li><a href='#examplestpars'><p>Example matrix for internal use.</p></a></li>
<li><a href='#exampletndlin'><p>Example numeric vector used internally.</p></a></li>
<li><a href='#exampletndlinpr'><p>Example numeric vector used internally.</p></a></li>
<li><a href='#exampletseas'><p>Example numeric vector used internally.</p></a></li>
<li><a href='#exampletseaspr'><p>Example numeric vector used internally.</p></a></li>
<li><a href='#exampletyr'><p>Example numeric vector used internally.</p></a></li>
<li><a href='#exampletyrpr'><p>Example numeric vector used internally.</p></a></li>
<li><a href='#fitMod'><p>Internal function that fits the seawaveQ model.</p></a></li>
<li><a href='#fitswavecav'><p>Fit seasonal wave and continuous ancillary data for trend</p>
analysis</a></li>
<li><a href='#IllRivValleyCty'><p>Water-quality data for 05586100 Illinois River at Valley City, Ill.</p></a></li>
<li><a href='#loadCalculations'><p>Calculate annual loads and summarize trends</p></a></li>
<li><a href='#pesticideTrendCalcs'><p>Summarize linear trends</p></a></li>
<li><a href='#prepData'><p>Prepares concentration data and continuous ancillary data</p></a></li>
<li><a href='#qwMoRivOmaha'><p>Water-quality data for 06610000 Missouri River at Omaha, Nebr.</p></a></li>
<li><a href='#seawaveQPlots'><p>Internal function that generates plots of data and model results.</p></a></li>
<li><a href='#seawaveQPlots2'><p>Internal function that generates plots of data and model results.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-12-14</td>
</tr>
<tr>
<td>Title:</td>
<td>SEAWAVE-Q Model</td>
</tr>
<tr>
<td>Author:</td>
<td>Karen R. Ryberg [aut, cre],
  Aldo V. Vecchia [aut],
  Benjamin York [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karen R. Ryberg &lt;kryberg@usgs.gov&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), survival, rms, lubridate, reshape2, plyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>waterData</td>
</tr>
<tr>
<td>Description:</td>
<td>A model and utilities for analyzing trends in chemical concentrations in streams with a seasonal wave (seawave) and adjustment for streamflow (Q) and other ancillary variables. See Ryberg and York, 2020, &lt;<a href="https://doi.org/10.3133%2Fofr20201082">doi:10.3133/ofr20201082</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited | file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://doi.org/10.3133/ofr20201082">https://doi.org/10.3133/ofr20201082</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Copyright:</td>
<td>This software is in the public domain because it contains
materials that originally came from the United States
Geological Survey, an agency of the United States Department of
Interior. For more information, see the official USGS copyright
policy at
https://www.usgs.gov/visual-id/credit_usgs.html#copyright</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-12-14 20:35:19 UTC; kryberg</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-12-15 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='seawaveQ-package'>A model and utilities for analyzing trends in chemical 
concentrations in streams with a seasonal wave (seawave) and 
adjustment for streamflow (Q) and other ancillary variables 
(Q) and other ancillary variables</h2><span id='topic+seawaveQ-package'></span><span id='topic+seawaveQ'></span>

<h3>Description</h3>

<p>An R package for the U.S. Geological Survey seawaveQ model, a 
parametric regression model specifically designed for analyzing 
seasonal- and flow-related variability and trends in pesticide 
concentrations.  See Vecchia and others (2008) for the original 
description of the model and see Sullivan and others (2009), 
Vecchia and others (2009), Ryberg and others (2010), 
Ryberg and others (2014), Ryberg and Gilliom (2015), 
and Oelsner and others (2017) and for applications of 
the model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> seawaveQ</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020--12--14</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Unlimited | file LICENSE </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Karen R. Ryberg <a href="mailto:kryberg@usgs.gov">kryberg@usgs.gov</a> and 
Aldo V. Vecchia <a href="mailto:avecchia@usgs.gov">avecchia@usgs.gov</a>
</p>


<h3>References</h3>

<p>Oelsner, G.P., Sprague, L.A., Murphy, J.C., Zuellig, R.E., Johnson, H.M., 
Ryberg, K.R., Falcone, J.A., Stets, E.G., Vecchia, A.V., Riskin, M.L., 
De Cicco, L.A., Mills, T.J., and Farmer, W.H., 2017, Water-quality trends 
in the nation's rivers and streams, 1972&ndash;2012&mdash;Data preparation, statistical 
methods, and trend results: U. S. Geological Survey Scientific Investigations 
Report 2017&ndash;5006, 136 p., <a href="https://doi.org/10.3133/sir20175006">https://doi.org/10.3133/sir20175006</a>.
</p>
<p>Ryberg, K.R. and Gilliom, R.J., 2015, Trends in pesticide concentrations 
and use for major rivers of the United States: Science of The Total Environment, 
v. 538, p. 431&ndash;444,  <a href="https://doi.org/10.1016/j.scitotenv.2015.06.095">https://doi.org/10.1016/j.scitotenv.2015.06.095</a>.
</p>
<p>Ryberg, K.R. and Vecchia, A.V., 2013, seawaveQ&mdash;An R package providing 
a model and utilities for analyzing trends in chemical concentrations 
in streams with a seasonal wave (seawave) and adjustment for 
streamflow (Q) and other ancillary variables: U.S. Geological Survey 
Open-File Report 2013&ndash;1255, 13 p., with 3 appendixes, 
<a href="https://dx.doi.org/10.3133/ofr20131255">https://dx.doi.org/10.3133/ofr20131255</a>.
</p>
<p>Ryberg, K.R. and York, B.C., 2020, seawaveQ&mdash;An R package providing 
a model and utilities for analyzing trends in chemical concentrations 
in streams with a seasonal wave (seawave) and adjustment for 
streamflow (Q) and other ancillary variables, Version 2.0.0: U.S. Geological 
Survey Open-File Report 2020&ndash;1082, 25 p., with 4 appendixes.
</p>
<p>Ryberg, K.R., Vecchia, A.V., Gilliom, R.J., and Martin, J.D., 2014, 
Pesticide trends in major rivers of the United States, 1992&ndash;2010: 
U.S. Geological Survey Scientific Investigations Report 2014&ndash;5135, 
74 p., <a href="https://pubs.er.usgs.gov/publication/sir20145135">https://pubs.er.usgs.gov/publication/sir20145135</a>.
</p>
<p>Ryberg, K.R., Vecchia, A.V., Martin, J.D., Gilliom, R.J., 2010, Trends 
in pesticide concentrations in urban streams in the United States, 
1992&ndash;2008: U.S. Geological Survey Scientific Investigations Report 
2010&ndash;5139, 101 p., <a href="https://pubs.usgs.gov/sir/2010/5139/">https://pubs.usgs.gov/sir/2010/5139/</a>.
</p>
<p>Sullivan, D.J., Vecchia, A.V., Lorenz, D.L., Gilliom, R.J., Martin, 
J.D., 2009, Trends in pesticide concentrations in corn-belt streams, 
1996&ndash;2006: U.S. Geological Survey Scientific Investigations Report 
2009&ndash;5132, 75 p., <a href="https://pubs.usgs.gov/sir/2009/5132/">https://pubs.usgs.gov/sir/2009/5132/</a>.
</p>
<p>Vecchia, A.V., Gilliom, R.J., Sullivan, D.J., Lorenz, D.L., and 
Martin, J.D., 2009, Trends in concentrations and use of agricultural 
herbicides for Corn Belt rivers, 1996&ndash;2006: Environmental Science 
and Technology, v. 43, no. 24, p. 9096&ndash;9102.
</p>
<p>Vecchia, A.V., Martin, J.D., and Gilliom, R.J., 2008, Modeling 
variability and  trends in pesticide concentrations in streams: 
Journal of the American Water Resources Association, v. 44, no. 5, p. 
1308&ndash;1324, <a href="https://dx.doi.org/10.1111/j.1752-1688.2008.00225.x">https://dx.doi.org/10.1111/j.1752-1688.2008.00225.x</a>.
</p>

<hr>
<h2 id='cenScatPlot'>Scatter plot of water-quality data</h2><span id='topic+cenScatPlot'></span>

<h3>Description</h3>

<p>Function to generate a scatter plot that indicates censored and 
estimated water-quality concentrations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenScatPlot(
  data,
  datescol = "dates",
  pname,
  qwcols = c("R", "P"),
  site = "",
  xlabel = "",
  ylabel = "Concentration",
  legpos = "topright",
  legcex = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cenScatPlot_+3A_data">data</code></td>
<td>
<p>is the dataset with columns that begin with P followed 
by alphanumeric characters indicating concentration data and columns 
that begin with R followed by alphanumeric characters that match those 
of the concentration data indicating qualification codes. See example 
datasets for more information about the data format, see 
<code><a href="#topic+IllRivValleyCty">IllRivValleyCty</a></code> and <code><a href="#topic+qwMoRivOmaha">qwMoRivOmaha</a></code>.</p>
</td></tr>
<tr><td><code id="cenScatPlot_+3A_datescol">datescol</code></td>
<td>
<p>is the column label for the dates column.</p>
</td></tr>
<tr><td><code id="cenScatPlot_+3A_pname">pname</code></td>
<td>
<p>is the column heading (parameter name) for the 
particular water-quality constituent to be plotted (omit 
the  starting character, for example for sulfate data indicated by 
P00945, enter &quot;00945&quot;).</p>
</td></tr>
<tr><td><code id="cenScatPlot_+3A_qwcols">qwcols</code></td>
<td>
<p>is a character vector with the beginning of the
column headers for remarks code (default is R), and beginning of 
column headers for concentration data (default is P for parameter).</p>
</td></tr>
<tr><td><code id="cenScatPlot_+3A_site">site</code></td>
<td>
<p>is a label for the plot title indicating the site where
the water-quality samples were collected.</p>
</td></tr>
<tr><td><code id="cenScatPlot_+3A_xlabel">xlabel</code></td>
<td>
<p>is the label for the x-axis, defaults to no label.</p>
</td></tr>
<tr><td><code id="cenScatPlot_+3A_ylabel">ylabel</code></td>
<td>
<p>is the label for the y-axis.</p>
</td></tr>
<tr><td><code id="cenScatPlot_+3A_legpos">legpos</code></td>
<td>
<p>is the position of the legend, see <a href="graphics.html#topic+legend">legend</a>.</p>
</td></tr>
<tr><td><code id="cenScatPlot_+3A_legcex">legcex</code></td>
<td>
<p>is a numerical value giving the amount by which the 
legend text and symbols should be magnified relative to the default, 
1.</p>
</td></tr>
<tr><td><code id="cenScatPlot_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <a href="graphics.html#topic+plot">plot</a> method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the qualification, or remark, column associated
with water-quality concentration values to indicate which samples are 
unqualified, which are estimated, and which are censored.
A blank remark field or an &quot;_&quot; indicates that the concentration 
value is not qualified; an &quot;E&quot; indicates the value has been 
estimated; and a less than symbol, &quot;&lt;&quot;, indicates the value has been 
censored as less than a minimum reporting level.  See Oblinger 
Childress and others (1999) for information on the minimum reporting level 
and the definition of &quot;E&quot; for U.S. Geological Survey data.  Other users may 
have a different definition of the minimum reporting level, but 
censored values need to be qualified with a &quot;&lt;&quot;.  Using the &quot;E&quot; code is 
optional.
</p>


<h3>Value</h3>

<p>A scatter plot
</p>


<h3>Author(s)</h3>

<p>Karen R. Ryberg
</p>


<h3>References</h3>

<p>Oblinger Childress, C.J., Foreman, W.T., Connor, B.F., and Maloney, 
T.J., 1999, New reporting procedures based on long-term method 
detection levels and some considerations for interpretations of 
water-quality data provided by the U.S. Geological Survey: U.S. 
Geological Survey Open-File Report 99&ndash;193, 19 p.,
<a href="https://water.usgs.gov/owq/OFR_99-193/index.html">https://water.usgs.gov/owq/OFR_99-193/index.html</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
# scatter plot of Simazine concentrations
cenScatPlot(IllRivValleyCty, pname = "04035")
# scatter plot with many additional plotting arguments
par(las = 1, tcl = 0.5)
cenScatPlot(IllRivValleyCty, pname = "04035", 
            site = "05586100 Illinois River at Valley City, IL",
            ylabel = "Simazine concentration, in micrograms per liter", 
            legcex = 0.7, ylim = c(0, 0.4), yaxs = "i", cex.lab = 0.9, 
            cex.axis = 0.9, xlim = c(as.Date("1996-01-01", "%Y-%m-%d"), 
            as.Date("2012-01-01", "%Y-%m-%d")), xaxs = "i", xaxt = "n")
axdates &lt;- c("1996-01-01", "2000-01-01", "2004-01-01", "2008-01-01",
           "2012-01-01")
axis(1, as.Date(axdates, "%Y-%m-%d"), 
     labels = c("1996", "2000", "2004", "2008", "2012"), cex.axis = 0.9)
</code></pre>

<hr>
<h2 id='combineData'>Combine water-quality sample data and continuous ancillary 
variables</h2><span id='topic+combineData'></span>

<h3>Description</h3>

<p>Function to combine water-quality sample data and continuous (daily) 
ancillary variables and drop unnecessary columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combineData(qwdat, cqwdat, qwcols = c("staid", "dates", "R", "P"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combineData_+3A_qwdat">qwdat</code></td>
<td>
<p>is the dataset containing water-quality sample data with 
columns that begin with a P (or other user-defined indicator) followed 
by alphanumeric characters. These columns are concentration data. In 
addition there need to be columns that begin with an R (or other user-
defined indicator) followed by alphanumeric characters that match those 
of the associated concentration data. The R columns contain data 
qualification codes. See example datasets for more information about 
the data format, <a href="#topic+IllRivValleyCty">IllRivValleyCty</a> and <a href="#topic+qwMoRivOmaha">qwMoRivOmaha</a>. This 
package assumes that the data are in micrograms per liter.</p>
</td></tr>
<tr><td><code id="combineData_+3A_cqwdat">cqwdat</code></td>
<td>
<p>is the dataset containing variables that can be used as 
explanatory variables for the seawaveQ model. See example dataset
for more information about the data format <a href="#topic+cqwMoRivOmaha">cqwMoRivOmaha</a>. These 
are daily values with no missing values allowed between the first and 
the last date in the dataset.</p>
</td></tr>
<tr><td><code id="combineData_+3A_qwcols">qwcols</code></td>
<td>
<p>is a character vector with column headings for 
a station (location) identifier, a dates column identifier, beginning 
of column headers for remarks code (default is R), and beginning of 
column headers for concentration data (default is P for parameter).</p>
</td></tr>
</table>


<h3>Format</h3>

<p>A data frame with the number of rows equal to the number of rows
in the data frame indicated by qwdat. The number of columns depend 
on the two input data frames. Minimally there will be a station 
identification column, a dates column, a column of qualification codes,
and a column of water-quality data.
</p>


<h3>Value</h3>

<p>A data frame
</p>


<h3>Note</h3>

<p>The columns indicated by qwcols[1:2] are used to
combine the datasets. The first column is the station identifier and 
the second column is the date column. These two column headings must 
be the same in the two datasets being combined and the dates in the 
datasets being combined must be of class Date and use the same 
format.
</p>


<h3>Author(s)</h3>

<p>Karen R. Ryberg and Aldo V. Vecchia
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
MoRivOmaha &lt;- combineData(qwdat = qwMoRivOmaha, cqwdat = cqwMoRivOmaha, 
qwcols = c("staid", "dates", "R", "P"))
</code></pre>

<hr>
<h2 id='compwaveconv'>Seasonal Wave Computation</h2><span id='topic+compwaveconv'></span>

<h3>Description</h3>

<p>Function to compute seasonal wave.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compwaveconv(cmaxt, jmod, hlife)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compwaveconv_+3A_cmaxt">cmaxt</code></td>
<td>
<p>is the time of the maximum chemical concentration, decimal
time in years.</p>
</td></tr>
<tr><td><code id="compwaveconv_+3A_jmod">jmod</code></td>
<td>
<p>is the choice of model or pulse input function, an integer 
1 through 14.</p>
</td></tr>
<tr><td><code id="compwaveconv_+3A_hlife">hlife</code></td>
<td>
<p>is the model half-life in months, 1 to 4 months</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of size 361 with discrete values of the 
seasonal wave for decimal season <code>seq(0,1,1/360)</code>.
</p>


<h3>Note</h3>

<p>The seasonal wave is a dimensionless, periodic function of time 
with an annual cycle, similar to a mixture of sine and cosine functions 
often used to model seasonality in concentration data. However, the 
seasonal wave is better suited for modeling seasonal behavior of 
pesticide data than a mixture of sines and cosines. The pulse input 
function, represented by jmod, has either one or two distinct 
application seasons (when pesticides may be transported to the stream) 
of lengths from 1 to 6 months. Therefore, 56 (14x4) choices for the 
wave function are available.
The numeric vector is a discrete approximation of the continuous wave 
function defined on the interval 0 to 1.
</p>


<h3>Author(s)</h3>

<p>Aldo V. Vecchia
</p>


<h3>References</h3>

<p>Vecchia, A.V., Martin, J.D., and Gilliom, R.J., 2008, 
Modeling variability and trends in pesticide concentrations in streams: 
JAWRA Journal of the American Water Resources Association, v. 44, p. 
1308&ndash;1324, <a href="https://doi.org/10.1111/j.1752-1688.2008.00225.x">https://doi.org/10.1111/j.1752-1688.2008.00225.x</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># evaluate seasonal wave for specified decimal seasons
# these example decimal dates represent days at points 0.25, 0.5, and 
# 0.75 percent of the way through the year and the end of the year
dseas &lt;- c(0.25, 0.5, 0.75, 1)
swave &lt;- compwaveconv(cmaxt = 0.483, jmod = 2, hlife = 4)
swave[floor(360 * dseas)]
plot(seq(0, 1, 1/360), swave, typ = "l")
</code></pre>

<hr>
<h2 id='cqwMoRivOmaha'>Continuously monitored (daily) data for 06610000 Missouri River at Omaha, Neb.</h2><span id='topic+cqwMoRivOmaha'></span>

<h3>Description</h3>

<p>Continuously monitored (daily) streamflow and sediment data for U.S. Geological 
Survey streamgage 06610000 Missouri River at Omaha, Neb., and streamflow and 
sediment anomalies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cqwMoRivOmaha</code></pre>


<h3>Format</h3>

<p>A data frame containing 2,922 daily observations of two hydrologic variables,
streamflow and sediment, and streamflow and sediment anomalies.
There are  eight variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
        staid </td><td style="text-align: left;"> character </td><td style="text-align: left;"> USGS Station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
        dates </td><td style="text-align: left;"> date </td><td style="text-align: left;"> date water-quality sample collected </td>
</tr>
<tr>
 <td style="text-align: left;">
        dflow </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> daily mean streamflow, cubic feet per second </td>
</tr>
<tr>
 <td style="text-align: left;">
        flowa30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
        flowa1 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 1-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
        dsed </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> daily mean sediment concentration, milligrams per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
        seda30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30-day sediment anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
        seda1 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 1-day sediment anomaly
        </td>
</tr>

</table>



<h3>Details</h3>

<p>The streamflow and sediment anomalies were generated using the R package 
waterData (Ryberg and Vecchia, 2012).
</p>


<h3>Note</h3>

<p>See Ryberg and Vecchia (2012) for more information on calculating the anomalies and for
additional references documenting the use of streamflow anomalies in water-quality trend
analysis studies. 
</p>


<h3>Source</h3>

<p>Data provided by Patrick Phillips, U.S. Geological Survey,
New York Water Science Center.</p>


<h3>References</h3>

<p>Ryberg, K.R., and Vecchia, A.V., 2012, waterData&mdash;An R package for 
retrieval, analysis, and anomaly calculation of daily hydrologic time 
series data, version 1.0.0: U.S. Geological Survey Open-File Report 
2012&ndash;1168, 8 p. [(]Also available at 
<a href="http://pubs.usgs.gov/of/2012/1168/">http://pubs.usgs.gov/of/2012/1168/</a>.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(swData)
  
  # summary of water-quality concentrations
  apply(cqwMoRivOmaha[,3:8], 2, summary)
</code></pre>

<hr>
<h2 id='examplecavdat'>Example continuous ancillary variable data.</h2><span id='topic+examplecavdat'></span>

<h3>Description</h3>

<p>This is an example of the continuous ancillary data that is passed 
internally to subfunctions of <code><a href="#topic+fitswavecav">fitswavecav</a></code>.  It is provided
here for use with examples of internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>examplecavdat</code></pre>


<h3>Format</h3>

<p>A data frame containing 2,893 data variables and 30-day and 
1-day streamflow anomalies (Ryberg and Vecchia, 2012).
</p>

<table>
<tr>
 <td style="text-align: left;">
  yrx </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Year </td>
</tr>
<tr>
 <td style="text-align: left;">
  mox </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Month </td>
</tr>
<tr>
 <td style="text-align: left;">
  dax </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Day </td>
</tr>
<tr>
 <td style="text-align: left;">
  jdayx </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Julian day from first day water year for start year in <code><a href="#topic+fitswavecav">fitswavecav</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;">
  flowa30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
  flowa1 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 1-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>References</h3>

<p>Ryberg, K.R., and Vecchia, A.V., 2012, waterData&ndash;An R package for retrieval,
analysis, and anomaly calculation of daily hydrologic time series data, 
version 1.0: U.S. Geological Survey Open-File Report 2012&ndash;1168, 8 p.
[Also available at <a href="http://pubs.usgs.gov/of/2012/1168/">http://pubs.usgs.gov/of/2012/1168/</a>.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
head(examplecavdat)
</code></pre>

<hr>
<h2 id='examplecavmat'>Example continuous ancillary variable matrix.</h2><span id='topic+examplecavmat'></span>

<h3>Description</h3>

<p>This is an example of the continuous ancillary matrix that is passed 
internally to subfunctions of <code><a href="#topic+fitswavecav">fitswavecav</a></code>.  It is provided
here for use with examples of internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>examplecavmat</code></pre>


<h3>Format</h3>

<p>A matrix containing 115 30-day and 1-day streamflow anomalies 
(Ryberg and Vecchia, 2012).
</p>

<table>
<tr>
 <td style="text-align: left;">
  flowa30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
  flowa1 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 1-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
head(examplecavmat)
</code></pre>

<hr>
<h2 id='examplecdatsub'>Example water-quality data.</h2><span id='topic+examplecdatsub'></span>

<h3>Description</h3>

<p>This is an example of the water-quality data that is passed 
internally to subfunctions of <code><a href="#topic+fitswavecav">fitswavecav</a></code>.  It is provided
here for use with examples of internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>examplecdatsub</code></pre>


<h3>Format</h3>

<p>A data frame containing 115 observations of 10 variables.  The date variables
were internally calculated.  The columns R04041 and P04041 are a subset of 
<code><a href="#topic+qwMoRivOmaha">qwMoRivOmaha</a></code> and the 30-day and 1-day streamflow and sediment anomalies 
are a subset of <code><a href="#topic+cqwMoRivOmaha">cqwMoRivOmaha</a></code>.
</p>

<table>
<tr>
 <td style="text-align: left;">
  yrc </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Year </td>
</tr>
<tr>
 <td style="text-align: left;">
  moc </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Month </td>
</tr>
<tr>
 <td style="text-align: left;">
  dac </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Day </td>
</tr>
<tr>
 <td style="text-align: left;">
  jdayc </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Julian day from first day of start year in <code><a href="#topic+fitswavecav">fitswavecav</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;">
  flowa30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
  flowa1 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 1-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
  seda30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30-day sediment anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
  seda1 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 1-day sediment anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>See Also</h3>

<p><code><a href="#topic+qwMoRivOmaha">qwMoRivOmaha</a></code>
<code><a href="#topic+cqwMoRivOmaha">cqwMoRivOmaha</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(swData)
  head(examplecdatsub)
</code></pre>

<hr>
<h2 id='examplecentmp'>Example logical vector.</h2><span id='topic+examplecentmp'></span>

<h3>Description</h3>

<p>This is an example of data that is passed 
internally to subfunctions of <code><a href="#topic+fitswavecav">fitswavecav</a></code>. This logical
vector indicates which water-quality values are censored. It is provided
here for use with examples of the internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>examplecentmp</code></pre>


<h3>Format</h3>

<p>A logical vector of 115 observations.
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
examplecentmp
</code></pre>

<hr>
<h2 id='exampleclog'>Example of logarithmically transformed concentration data.</h2><span id='topic+exampleclog'></span>

<h3>Description</h3>

<p>This is an example of data that is used internally by <a href="#topic+fitMod">fitMod</a> and  
passed to its subfunction <code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code>.  This numeric
vector represents the base-10 logarithm of the water-quality concentrations.  
It is provided here for use with examples of the internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampleclog</code></pre>


<h3>Format</h3>

<p>A numeric vector of 115 observations.
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
exampleclog
</code></pre>

<hr>
<h2 id='exampleqwcols'>Example data indicators.</h2><span id='topic+exampleqwcols'></span>

<h3>Description</h3>

<p>This is an example of the character vector used to indicate which 
columns represent qualification codes and which represent water-quality 
concentration data.  It is provided here for use with examples of the 
internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampleqwcols</code></pre>


<h3>Format</h3>

<p>A numeric vector of 115 observations.
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>See Also</h3>

<p><code><a href="#topic+prepData">prepData</a></code>
<code><a href="#topic+fitMod">fitMod</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(swData)
  exampleqwcols
</code></pre>

<hr>
<h2 id='examplestpars'>Example matrix for internal use.</h2><span id='topic+examplestpars'></span>

<h3>Description</h3>

<p>This is an example of data that is passed 
internally to subfunctions of <code><a href="#topic+fitswavecav">fitswavecav</a></code>.  It is provided
here for use with examples of the internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>examplestpars</code></pre>


<h3>Format</h3>

<p>A numeric matrix of two rows and 15 columns.<br />
column  description<br />
1  mclass, model class, 1 for linear models, 2 for those with restricted cubic splines<br />
2  model chosen (a number 1-56), this number represents both the pulse input function and the half-life<br />
3  is the scale factor from the <code>survreg.object</code><br />
4  is the likelihood for the model chosen<br />
5  is the coefficient for the model intercept <br />
6  is the coefficient for the seasonal wave component of the model <br />
7  is the coefficient for the trend component of the model <br />
8  is the coefficient for the 30-day flow anomaly <br />
9  is the coefficient for the 1-day flow anomaly <br />
10 is the standard error for the intercept term  <br />
11 is the standard error for the seasonal wave term  <br />
12 is the standard error for the trend term  <br />
13 is the standard error for the 30-day flow anomaly term  <br />
14 is the standard error for the 1-day flow anomaly term  <br />
15 is cmaxt, the decimal season of maximum concentration <br />
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>See Also</h3>

<p><code><a href="#topic+fitswavecav">fitswavecav</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(swData)
  examplestpars
</code></pre>

<hr>
<h2 id='exampletndlin'>Example numeric vector used internally.</h2><span id='topic+exampletndlin'></span>

<h3>Description</h3>

<p>This is an example of data that is passed 
internally to <code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code>.  This numeric
vector contains trend coefficients for the water-quality samples.  
It is provided here for use with examples of the internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampletndlin</code></pre>


<h3>Format</h3>

<p>A numeric vector of 115 observations.
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha,
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
head(exampletndlin)
</code></pre>

<hr>
<h2 id='exampletndlinpr'>Example numeric vector used internally.</h2><span id='topic+exampletndlinpr'></span>

<h3>Description</h3>

<p>This is an example of data that is passed 
internally to <code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code>.  This numeric
vector contains trend coefficients for a continuous water-quality prediction
based on the continuous ancillary variables.  
It is provided here for use with examples of the internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampletndlinpr</code></pre>


<h3>Format</h3>

<p>A numeric vector of 2,893 observations.
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
head(exampletndlinpr)
</code></pre>

<hr>
<h2 id='exampletseas'>Example numeric vector used internally.</h2><span id='topic+exampletseas'></span>

<h3>Description</h3>

<p>This is an example of data that is passed 
internally to <code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code>.  This numeric
vector contains decimal seasonal (0-1) values for the water-quality 
samples. It is provided here for use with examples of the internal 
functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampletseas</code></pre>


<h3>Format</h3>

<p>A numeric vector of 115 observations.
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
head(exampletseas)
</code></pre>

<hr>
<h2 id='exampletseaspr'>Example numeric vector used internally.</h2><span id='topic+exampletseaspr'></span>

<h3>Description</h3>

<p>This is an example of data that is passed 
internally to <code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code>.  This numeric
vector contains decimal seasonal (0-1) values for the continuous
ancillary data. It is provided here for use with examples of the internal 
functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampletseaspr</code></pre>


<h3>Format</h3>

<p>A numeric vector of 2,893 observations.
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
head(exampletseaspr)
</code></pre>

<hr>
<h2 id='exampletyr'>Example numeric vector used internally.</h2><span id='topic+exampletyr'></span>

<h3>Description</h3>

<p>This is an example of data that is passed 
internally to <code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code>.  This numeric
vector contains decimal dates for the water-quality samples.  
It is provided here for use with examples of the internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampletyr</code></pre>


<h3>Format</h3>

<p>A numeric vector of 115 observations.
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
head(exampletyr)
</code></pre>

<hr>
<h2 id='exampletyrpr'>Example numeric vector used internally.</h2><span id='topic+exampletyrpr'></span>

<h3>Description</h3>

<p>This is an example of data that is passed 
internally to <code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code>.  This numeric
vector contains decimal dates for continuous ancillary variables.  
It is provided here for use with examples of the internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampletyrpr</code></pre>


<h3>Format</h3>

<p>A numeric vector of 2,893 observations.
</p>


<h3>Source</h3>

<p>Internal data captured from the following function call:
</p>
<pre>fitswavecav(cdat=modMoRivOmaha, cavdat=cqwMoRivOmaha, 
                       tanm="myexample", pnames=c("04041"), yrstart=1995, 
                       yrend=2003, tndbeg=1995, tndend=2003, 
                       iwcav=c("flowa30","flowa1"), dcol="dates", 
                       qwcols=c("R","P"))</pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
head(exampletyrpr)
</code></pre>

<hr>
<h2 id='fitMod'>Internal function that fits the seawaveQ model.</h2><span id='topic+fitMod'></span>

<h3>Description</h3>

<p>fitMod is called from within <a href="#topic+fitswavecav">fitswavecav</a> but
can be invoked directly. It fits the seawaveQ model and returns the 
results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitMod(
  cdatsub,
  cavdat,
  yrstart,
  yrend,
  tndbeg,
  tndend,
  tanm,
  pnames,
  qwcols,
  mclass = 1,
  numk = 4,
  plotfile = FALSE,
  textfile = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitMod_+3A_cdatsub">cdatsub</code></td>
<td>
<p>is the concentration data.</p>
</td></tr>
<tr><td><code id="fitMod_+3A_cavdat">cavdat</code></td>
<td>
<p>is the continuous (daily) ancillary data.</p>
</td></tr>
<tr><td><code id="fitMod_+3A_yrstart">yrstart</code></td>
<td>
<p>is the starting year of the analysis (treated as January
1 of that year).</p>
</td></tr>
<tr><td><code id="fitMod_+3A_yrend">yrend</code></td>
<td>
<p>is the ending year of the analysis (treated as December 31
of that year).</p>
</td></tr>
<tr><td><code id="fitMod_+3A_tndbeg">tndbeg</code></td>
<td>
<p>is the beginning (in whole or decimal years) of the 
trend period.</p>
</td></tr>
<tr><td><code id="fitMod_+3A_tndend">tndend</code></td>
<td>
<p>is the end (in whole or decimal years) of the trend 
period.</p>
</td></tr>
<tr><td><code id="fitMod_+3A_tanm">tanm</code></td>
<td>
<p>is a character identifier that names the trend 
analysis run.  It is used to label output files.</p>
</td></tr>
<tr><td><code id="fitMod_+3A_pnames">pnames</code></td>
<td>
<p>is the parameter (water-quality constituents) to 
analyze (if using USGS parameters, omit the starting 'P', such as 
&quot;00945&quot; for sulfate).</p>
</td></tr>
<tr><td><code id="fitMod_+3A_qwcols">qwcols</code></td>
<td>
<p>is a character vector with the beginning of the
column headers for remarks code (default is R), and beginning of 
column headers for concentration data (default is P for parameter).</p>
</td></tr>
<tr><td><code id="fitMod_+3A_mclass">mclass</code></td>
<td>
<p>indicates the class of model to use.
A class 1 model is the the traditional SEAWAVE-Q model that has a
linear time trend. A class 2 model is a newer option for longer
trend periods that uses a set of restricted cubic splines on the 
time variable to provide a more flexible model. The default is 1.
(Harrell, 2010, 2018).</p>
</td></tr>
<tr><td><code id="fitMod_+3A_numk">numk</code></td>
<td>
<p>is the number of knots in the restricted cubic spline model
(mclass = 2). The default is 4, and the recommended number is 3&ndash;7.</p>
</td></tr>
<tr><td><code id="fitMod_+3A_plotfile">plotfile</code></td>
<td>
<p>is by default FALSE. True will write pdf files of plots to 
the user's file system.</p>
</td></tr>
<tr><td><code id="fitMod_+3A_textfile">textfile</code></td>
<td>
<p>is by default FALSE. True will write text output files
to the user's file system. These files are useful for detailed model 
comparisons, documenting session information, and for model archives.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PDF file (if plotfile is TRUE) containing plots (see 
<code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code>), a text file showing the best model survival 
regression call and results, and a list. The first element of the list 
contains information about the data and the model(s) selected (see 
<code><a href="#topic+examplestpars">examplestpars</a></code>). The second element of the list contains 
the summary of the survival regression call. The third element of the 
list is itself a list containing the observed concentrations (censored 
and uncensored) and the predicted concentrations used by 
<code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code> or <code><a href="#topic+seawaveQPlots2">seawaveQPlots2</a></code> to generate the 
plots.
</p>


<h3>Author(s)</h3>

<p>Aldo V. Vecchia and Karen R. Ryberg
</p>


<h3>References</h3>

<p>Allison, P.D., 1995, Survival analysis using the SAS system&mdash;A 
practical guide: Cary, N.C., SAS Institute, Inc., 304 p.
</p>
<p>Harrell, F.E., Jr., 2010, Regression modeling strategies&mdash;With
applications to linear models, logistic regression, and survival
analysis: New York, Springer-Verlag, 568 p.
</p>
<p>Harrell, F.E., Jr., 2018, rms&mdash;Regression modeling strategies: 
R package version 5.1-2, <a href="https://CRAN.R-project.org/package=rms">https://CRAN.R-project.org/package=rms</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
myRes &lt;- fitMod(cdatsub = examplecdatsub, cavdat = examplecavdat, 
yrstart = 1995, yrend = 2003, tndbeg = 1995, tndend = 2003, tanm = "myfit3", 
pnames = c("04041"), qwcols = c("R", "P"), plotfile = FALSE,
textfile = FALSE)
</code></pre>

<hr>
<h2 id='fitswavecav'>Fit seasonal wave and continuous ancillary data for trend 
analysis</h2><span id='topic+fitswavecav'></span>

<h3>Description</h3>

<p>Function to prepare data and fit the seawaveQ model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitswavecav(
  cdat,
  cavdat,
  tanm = "trend1",
  pnames,
  yrstart = 0,
  yrend = 0,
  tndbeg = 0,
  tndend = 0,
  iwcav = c("none"),
  dcol = "dates",
  qwcols = c("R", "P"),
  mclass = 1,
  numk = 4,
  alpha = 0.1,
  bootRCS = FALSE,
  nboot = 1000,
  plotfile = FALSE,
  textfile = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitswavecav_+3A_cdat">cdat</code></td>
<td>
<p>is the concentration data</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_cavdat">cavdat</code></td>
<td>
<p>is the continuous (daily) ancillary data</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_tanm">tanm</code></td>
<td>
<p>is a character identifier that names the trend 
analysis run.  It is used to label output files.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_pnames">pnames</code></td>
<td>
<p>are the parameters (water-quality constituents) to 
analyze (omit the starting character, for example for sulfate data 
indicated by P00945, enter &quot;00945&quot;).</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_yrstart">yrstart</code></td>
<td>
<p>is the starting year of the analysis (treated as January
1 of that year). Zero means the start date will be determined by the 
start date of cavdat, the continuous ancillary data.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_yrend">yrend</code></td>
<td>
<p>is the ending year of the analysis (treated as December 31
of that year). Zero means the end date will be determined by the end 
date of cavdat, the continuous ancillary data.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_tndbeg">tndbeg</code></td>
<td>
<p>is the beginning (in whole or decimal years) of the 
trend period. Zero means the begin date will be the beginning of the
concentration data, cdat.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_tndend">tndend</code></td>
<td>
<p>is the end of the trend (treated as December 31
of that year). Zero means the end date will be the end of the 
concentration data, cdat.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_iwcav">iwcav</code></td>
<td>
<p>is a character vector indicating which continuous
ancillary variables to include, if none are used for analysis,
use iwcav=c(&quot;none&quot;).</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_dcol">dcol</code></td>
<td>
<p>is the column name for the dates, should be the same for 
both cdat and cavdat</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_qwcols">qwcols</code></td>
<td>
<p>is a character vector with the beginning of the
column headers for remarks code (default is R), and beginning of 
column headers for concentration data (default is P for parameter).</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_mclass">mclass</code></td>
<td>
<p>indicates the class of model to use.
A class 1 model is the traditional SEAWAVE-Q model that has a
linear time trend. A class 2 model is a newer option for longer
trend periods that uses a set of restricted cubic splines on the 
time variable to provide a more flexible model.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_numk">numk</code></td>
<td>
<p>is the number of knots in the restricted cubic spline model.
The default is 4, and the recommended number is 3&ndash;7.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_alpha">alpha</code></td>
<td>
<p>is the significance level or alpha values for statistical
significance and confidence intervals.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_bootrcs">bootRCS</code></td>
<td>
<p>is a logical value indicating whether or not to perform
block bootstrapping for an attained significance level for the trend
with restricted cubic splines. No bootstrapping is performed for the linear
trend model.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_nboot">nboot</code></td>
<td>
<p>is the number of bootstrap replicates. A large number, 10,000,
is recommended, but this takes a long time.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_plotfile">plotfile</code></td>
<td>
<p>is by default FALSE. True will write pdf files of plots to 
the user's file system.</p>
</td></tr>
<tr><td><code id="fitswavecav_+3A_textfile">textfile</code></td>
<td>
<p>is by default FALSE. True will write text output files
to the user's file system. These files are useful for detailed model 
comparisons, documenting session information, and for model archives.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>The data frame returned as the first element of the output list has 
one row for each chemical analyzed and the number of columns depends on the 
number of continuous ancillary variables used. The general format is as 
follows: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
 pname </td><td style="text-align: left;"> character </td><td style="text-align: left;"> parameter analyzed</td>
</tr>
<tr>
 <td style="text-align: left;">
 mclass </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a value of 1 or 2</td>
</tr>
<tr>
 <td style="text-align: left;">
 jmod </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the choice of pulse input function, an 
 integer 1--14 </td>
</tr>
<tr>
 <td style="text-align: left;">
 hlife </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the model half-life in months, an integer, 1 to 
 4 months </td>
</tr>
<tr>
 <td style="text-align: left;">
 cmaxt </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the decimal season of maximum concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
 scl </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the scale factor from the 
 <code>survreg.object</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
 loglik </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the log-likelihood for the model </td>
</tr>
<tr>
 <td style="text-align: left;">
 cint </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> coefficient for model intercept </td>
</tr>
<tr>
 <td style="text-align: left;">
 cwave </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> coefficient for the seasonal wave </td>
</tr>
<tr>
 <td style="text-align: left;">
 ctnd[alpahnumeric] </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> coefficient(s) for the trend component(s) of model </td>
</tr>
<tr>
 <td style="text-align: left;">
 c[alphanumeric] </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 0 or more coefficients for the 
 continuous ancillary variables</td>
</tr>
<tr>
 <td style="text-align: left;">
 seint </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> standard error for the intercept </td>
</tr>
<tr>
 <td style="text-align: left;">
 sewave </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> standard error for the seasonal wave </td>
</tr>
<tr>
 <td style="text-align: left;">
 setnd[alphanumeric] </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> standard error for the trend component(s) </td>
</tr>
<tr>
 <td style="text-align: left;">
 se[alphanumeric] </td><td style="text-align: left;"> numeric </td><td style="text-align: left;">  0 or more standard errors for the 
 continuous ancillary variables</td>
</tr>
<tr>
 <td style="text-align: left;">
 pvaltnd[alphanumeric] </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the <em>p</em>-value for the trend component(s) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The data frame returned as the sixth element of the output list has 
one row for each chemical analyzed. The general format for linear models is
described in <code><a href="#topic+pesticideTrendCalcs">pesticideTrendCalcs</a></code>. The format for restricted
cubic spline models is as described as follows: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
  pname </td><td style="text-align: left;"> character </td><td style="text-align: left;"> parameter analyzed</td>
</tr>
<tr>
 <td style="text-align: left;">
 mclass </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> A value of 1 or 2</td>
</tr>
<tr>
 <td style="text-align: left;">
 baseConc </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the concentration at the beginning of the trend
 period </td>
</tr>
<tr>
 <td style="text-align: left;">
 endCon </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the concentration at the end of the trend
 period </td>
</tr>
<tr>
 <td style="text-align: left;">
 rcsctndPpor </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the concentration trend in percent over the 
 trend period </td>
</tr>
<tr>
 <td style="text-align: left;">
 rcsctndOrigPORPercentBase </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the conc. trend in 
 original units over period of record (calc. based on percent per 
 year and base conc.) </td>
</tr>
<tr>
 <td style="text-align: left;">
 pvalrcstnd </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> <em>p</em>-value, attained significance level, based on 
 bootstrapping </td>
</tr>
<tr>
 <td style="text-align: left;">
 ctndlklhd </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> trend likelihood </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Details</h3>

<p>Fits the seawaveQ model (Vecchia and others, 2008) using a seasonal 
wave and continuous ancillary variables (streamflow anomalies and other 
continuous variables such as conductivity or sediment) to model water 
quality. The version in the 2.0.0 update to the R package has an
option to use restricted cubic splines as a more flexible definition
of the temporal trend.
</p>


<h3>Value</h3>

<p>A PDF file containing plots of the data and modeled 
concentration, a text file containing a summary of the survival 
regression call for each model selected, and a list. The first element
of the list is a data frame described under format. The second element
of the list is the summary of the survival regression call. The third 
element is the observed concentration data (censored and uncensored). 
The fourth element is the concentration data predicted by the model.  
The fifth element provides summary statistics for the predicted 
concentrations. The sixth element is a data frame that provides a summary of 
the trends with the columns pname (parameter name), mclass (a value of 1, 
indicating a linear trend model, a value of 2 for models using restricted
cubic splines), and the columns describing the trends. For linear models  
see <code><a href="#topic+pesticideTrendCalcs">pesticideTrendCalcs</a></code>. For models with restricted cubic
splines, see the format section. See Ryberg and York (2020) for additional
details.
</p>


<h3>Note</h3>

<p>The assumed data format is one with columns for water-quality
concentration values and a related column for qualification of 
those values, such as in the case of left-censored values less 
than a particular value. For example, a water-quality sample
was collected and the laboratory analysis indicated that the 
concentration was less than 0.01 micrograms per liter. The 
USGS parameter code for simazine is 04035 (U.S. Geological Survey, 
2018b). When the data are retrieved through the National Water 
Information System: Web Interface 
(<a href="https://waterdata.usgs.gov/nwis">https://waterdata.usgs.gov/nwis</a>; U.S. Geological Survey, 2018a), 
the concentration values are in a column labeled P04035 and the 
qualification information, or remark codes, are in a column labeled 
R04035. To use this function, the argument pnames would be the unique 
identifier for simazine values and qualifications, 04035, and the 
qwcols argument would be c(&quot;R&quot;, &quot;P&quot;) to indicate that the 
qualification column starts with an R and the values column starts with 
a P. <br />
</p>
<p>Other users may have data in different formats that can be 
modified to use with this function. For example, a user may have
concentration values and qualification codes in one column, such
as a column labeled simazine with the values 0.05, 0.10, &lt;0.01, 
&lt;0.01, and 0.90. In this case, the less thans and any other 
qualification codes should be placed in a separate column. The
column names for the qualification codes and the concentration values
should be the same with the exception of different beginning
letters to indicate which column is which. The columns could be
named Rsimazine and Psimazine. Then the argument pnames = &quot;simazine&quot; 
and the argument qwcols = c(&quot;R&quot;, &quot;P&quot;). <br />
</p>
<p>Users should exercise caution when their water-quality data have 
multiple censoring limits and may want to recensor the data to a 
single censoring level. Censoring and recensoring issues are discussed
in the text and Appendix 1 of Ryberg and others (2010).
</p>
<p>None of the variations of SEAWAVE is a simple model. The model complexity 
increases with flow anomalies and with the addition of restricted cubic 
splines. As the number of parameters in the model increases or the degree
of censoring increases, the sample size must also increase. See Ryberg 
and others (2020) for more details on sample size.
</p>


<h3>Author(s)</h3>

<p>Aldo V. Vecchia and Karen R. Ryberg
</p>


<h3>References</h3>

<p>Ryberg, K.R. and York, B.C., 2020, seawaveQ&mdash;An R package providing a model 
and utilities for analyzing trends in chemical concentrations in streams with 
a seasonal wave (seawave) and adjustment for streamflow (Q) and other 
ancillary variables: U.S. Geological Survey Open-File Report 2020&ndash;1082, 25 
p., with 4 appendixes.
</p>
<p>Ryberg, K.R., Vecchia, A.V., Martin, J.D., and Gilliom, R.J., 2010, 
Trends in pesticide concentrations in urban streams in the United 
States, 1992&ndash;2008: U.S. Geological Survey Scientific Investigations 
Report 2010&ndash;5139, 101 p., <a href="https://pubs.usgs.gov/sir/2010/5139/">https://pubs.usgs.gov/sir/2010/5139/</a>.
</p>
<p>U.S. Geological Survey, 2018a, National Water Information System: 
Web Interface, accessed July 7, 2018, at
<a href="https://waterdata.usgs.gov/nwis">https://waterdata.usgs.gov/nwis</a>.
</p>
<p>U.S. Geological Survey, 2018b, Parameter code definition: National 
Water Information System: Web Interface, accessed July 18, 2018,
at <a href="https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes">https://nwis.waterdata.usgs.gov/usa/nwis/pmcodes</a>.
</p>
<p>Vecchia, A.V., Martin, J.D., and Gilliom, R.J., 2008, Modeling 
variability and trends in pesticide concentrations in streams: 
Journal of the American Water Resources Association, v. 44, no. 5, p. 
1308&ndash;1324, <a href="https://dx.doi.org/10.1111/j.1752-1688.2008.00225.x">https://dx.doi.org/10.1111/j.1752-1688.2008.00225.x</a>.
</p>


<h3>See Also</h3>

<p>The functions that <code>fitswavecav</code> calls internally: <br />
<code><a href="#topic+prepData">prepData</a></code> and <code><a href="#topic+fitMod">fitMod</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
modMoRivOmaha &lt;- combineData(qwdat = qwMoRivOmaha, cqwdat = cqwMoRivOmaha)
myfitLinearTrend &lt;- fitswavecav(cdat = modMoRivOmaha, cavdat = cqwMoRivOmaha, 
tanm = "myfitLinearTrend", pnames = c("04035", "04037", "04041"), yrstart = 1995, 
yrend = 2003, tndbeg = 1995, tndend = 2003, iwcav = c("flowa30", "flowa1"), 
dcol = "dates", qwcols = c("R", "P"))
# trend model results
myfitLinearTrend[[1]]
# example regression call
myfitLinearTrend[[2]][[1]]
# first few lines of observed concentrations
head(myfitLinearTrend[[3]])
# first few lines of predicted concentrations
head(myfitLinearTrend[[4]])
# summary statistics for predicted concentrations
myfitLinearTrend[[5]]
# summary of trends
myfitLinearTrend[[6]]
myfitRCSTrend &lt;- fitswavecav(cdat = modMoRivOmaha, cavdat = cqwMoRivOmaha, 
tanm = "myfitRCSTrend", pnames = c("04035", "04037", "04041"), yrstart = 1995, 
yrend = 2003, tndbeg = 1995, tndend = 2003, iwcav = c("flowa30", "flowa1"), 
dcol = "dates", qwcols = c("R", "P"), mclass = 2, numk = 4, bootRCS = FALSE,
plotfile = FALSE, textfile = FALSE)
</code></pre>

<hr>
<h2 id='IllRivValleyCty'>Water-quality data for 05586100 Illinois River at Valley City, Ill.</h2><span id='topic+IllRivValleyCty'></span>

<h3>Description</h3>

<p>Scatterplots of water-quality data for 05586100 Illinois River at 
Valley City, Ill.
<img src="../help/figures/05586100Simazine.png" alt="Simazine concentrations in the
  Illinois River at Valley City, Ill." /> <br />  
<img src="../help/figures/05586100Prometon.png" alt="Prometon concentrations in the
  Illinois River at Valley City, Ill." /> <br />
<img src="../help/figures/05586100Metribuzin.png" alt="Metribuzin concentrations in the
  Illinois River at Valley City, Ill." /> <br />
<img src="../help/figures/05586100EPTC.png" alt="EPTC concentrations in the
  Illinois River at Valley City, Ill." /> <br />  
  
  


</p>


<h3>Usage</h3>

<pre><code class='language-R'>IllRivValleyCty</code></pre>


<h3>Format</h3>

<p>A data frame containing 168 water-quality samples for 4 constituents.  
There are  20 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
   site </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Site abbreviation for study </td>
</tr>
<tr>
 <td style="text-align: left;">
   staid </td><td style="text-align: left;"> character </td><td style="text-align: left;"> USGS Station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
   dates </td><td style="text-align: left;"> date </td><td style="text-align: left;"> Date water-quality sample collected </td>
</tr>
<tr>
 <td style="text-align: left;">
   yrc </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Year </td>
</tr>
<tr>
 <td style="text-align: left;">
   moc </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Month </td>
</tr>
<tr>
 <td style="text-align: left;">
   dac </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Day </td>
</tr>
<tr>
 <td style="text-align: left;">
   jdayc </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Julian day from first day of associated streamflow data used </td>
</tr>
<tr>
 <td style="text-align: left;">
   R04035 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
   P04035 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Simazine, water, filtered, recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
   R04037 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
   P04037 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Prometon, water, filtered, recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
   R82630 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
   P82630 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Metribuzin, water, filtered, recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
   R82668 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
   P82668 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> EPTC, water, filtered (0.7 micron glass fiber filter), recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
   dflow </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Streamflow, cubic feet per second </td>
</tr>
<tr>
 <td style="text-align: left;">
   flowa30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
   flowa1 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 1-day streamflow anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
   dsed </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Sediment concentration, milligrams per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
   seda30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30-day sediment anomaly </td>
</tr>
<tr>
 <td style="text-align: left;">
   seda1 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 1-day sediment anomaly
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Chemical concentration data are in the columns that start with a P and are 
followed by a number.  Qualification codes for the concentration data are in 
the columns that start with an R followed by the same numbers as the 
associated concentration data.  For example, column P04035 indicates simazine 
data, 04035, being the U.S. Geological Survey parameter code for simazine.
The qualification codes for the simazine concentrations are found in 
the column R04035, indicating a U.S. Geological Survey remark code.
Remark codes include _ or nothing, indicating no qualification of the 
value in the associated concentration field; &lt;, indicating a censored
value that is less than the number reported in the associated 
concentration field; and E, indicating that the value has been estimated.
See Oblinger Childress and others (1999) for information on the remark codes 
used by the U.S. Geological Survey.
The streamflow and sediment anomalies were generated using the R package 
waterData (Ryberg and Vecchia, 2012).
</p>


<h3>Source</h3>

<p>Data provided by Patrick Phillips, U.S. Geological Survey,
New York Water Science Center.</p>


<h3>References</h3>

<p>Oblinger Childress, C.J., Foreman, W.T., Connor, B.F., and Maloney, T.J.,
1999, New reporting procedures based on long-term method detection levels
and some considerations for interpretations of water-quality data provided
by the U.S. Geological Survey Open-File Report 99&ndash;193, 19 p. [Also 
available at <a href="https://water.usgs.gov/owq/OFR_99-193/index.html">https://water.usgs.gov/owq/OFR_99-193/index.html</a>.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)

# summary of water-quality concentrations
apply(IllRivValleyCty[, grep("P[[:digit:]]", 
dimnames(IllRivValleyCty)[[2]])], 2, summary)

# scatter plot of simazine concentrations
cenScatPlot(IllRivValleyCty, pname = "04035")

# Simazine scatter plot with many additional plotting arguments

par(las = 1, tcl = 0.5)
cenScatPlot(IllRivValleyCty, pname = "04035", 
            site = "05586100 Illinois River at Valley City, Ill.",
            ylabel = "Simazine concentration, in micrograms per liter", 
            legcex = 0.7, 
            ylim = c(0, 0.4), yaxs = "i", 
            xlim = c(as.Date("1996-01-01"), as.Date("2012-01-01")), 
            xaxs = "i", xaxt = "n")
axdates &lt;- c("1996-01-01", "2000-01-01", "2004-01-01", "2008-01-01",
           "2012-01-01")
axis(1, as.Date(axdates), labels = c("1996", "2000", "2004", "2008", "2012"))

# Prometon scatter plot
cenScatPlot(IllRivValleyCty, pname = "04037", 
            site = "05586100 Illinois River at Valley City, Ill.",
            ylabel = "Prometon concentration, in micrograms per liter", 
            legcex = 0.7, 
            ylim = c(0, 0.06), yaxs = "i", 
            xlim=c(as.Date("1996-01-01"), as.Date("2012-01-01")), xaxs = "i", 
            xaxt = "n")
axdates&lt;-c("1996-01-01", "2000-01-01", "2004-01-01", "2008-01-01", "2012-01-01")
axis(1, as.Date(axdates), labels = c("1996", "2000", "2004", "2008","2012"))

# Metribuzin scatter plot
cenScatPlot(IllRivValleyCty, pname="82630", 
            site="05586100 Illinois River at Valley City, Ill.",
            ylabel="Metribuzin concentration, in micrograms per liter", 
            legcex=0.7, 
            ylim=c(0,0.3), yaxs="i", cex.lab=0.9, cex.axis=0.9,
            xlim=c(as.Date("1996-01-01"), 
                   as.Date("2012-01-01")), xaxs="i", 
            xaxt="n")
axdates&lt;-c("1996-01-01", "2000-01-01", "2004-01-01", "2008-01-01", 
           "2012-01-01")
axis(1, as.Date(axdates), labels=c("1996", "2000", "2004", "2008",
                                               "2012"), cex.axis=0.9)
# EPTC scatter plot
cenScatPlot(IllRivValleyCty, pname = "82668", 
            site = "05586100 Illinois River at Valley City, Ill.",
            ylabel = "EPTC concentration, in micrograms per liter", 
            legcex = 0.7, ylim = c(0, 0.08), yaxs = "i", 
            xlim=c(as.Date("1996-01-01"), as.Date("2012-01-01")), 
            xaxs = "i", xaxt = "n")
axdates &lt;- c("1996-01-01", "2000-01-01", "2004-01-01", "2008-01-01", 
           "2012-01-01")
axis(1, as.Date(axdates), labels = c("1996", "2000", "2004", "2008","2012"))
</code></pre>

<hr>
<h2 id='loadCalculations'>Calculate annual loads and summarize trends</h2><span id='topic+loadCalculations'></span>

<h3>Description</h3>

<p>Function to calculate pesticide loads in kilograms per year and summarize trends.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadCalculations(
  dailyDat,
  pestPredict,
  modRes,
  concTrends,
  yrtype = 1,
  alpha = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadCalculations_+3A_dailydat">dailyDat</code></td>
<td>
<p>is the daily streamflow data in the form of a data frame
with three columns representing a station ID, date, and streamflow.</p>
</td></tr>
<tr><td><code id="loadCalculations_+3A_pestpredict">pestPredict</code></td>
<td>
<p>is the continuous (daily) estimation of pesticide
concentrations for one or more pesticides at a single site. This should be
in the form of the fourth element of the list returned by <code>fitswavecav</code>.</p>
</td></tr>
<tr><td><code id="loadCalculations_+3A_modres">modRes</code></td>
<td>
<p>is the first element of the list returned by <code>fitswavecav</code> 
and includes the scale parameter for one or more pesticide trend models at
a single site. The scale parameter is used in the bias correction.</p>
</td></tr>
<tr><td><code id="loadCalculations_+3A_conctrends">concTrends</code></td>
<td>
<p>the SEAWAVE-Q trend in flow-normalized annual load. Cannot 
be different (computationally) from the trend in flow-normalized annual 
concentration when there is no trend in flow (Oelsner and others, 2017).</p>
</td></tr>
<tr><td><code id="loadCalculations_+3A_yrtype">yrtype</code></td>
<td>
<p>allows one to calculate annual loads based on a calendar 
year or a water year, where a water year is the 12-month period October 1 
through September 30 designated by the calendar year in which it ends. A 
yrtype of 1 represents a calendar year and is the default because that
is the way the original model was developed. A yrtype of 2 represents a
water year.</p>
</td></tr>
<tr><td><code id="loadCalculations_+3A_alpha">alpha</code></td>
<td>
<p>is the significance level or alpha value for statistical
significance and confidence intervals.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>The first data frame returned has one row for each pesticide-year at
a particular site and four columns. The general format is as follows: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
 pstaid </td><td style="text-align: left;"> character </td><td style="text-align: left;"> the station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
 pcode </td><td style="text-align: left;"> character </td><td style="text-align: left;"> the parameter code for which a load was calculated</td>
</tr>
<tr>
 <td style="text-align: left;">
 year or wyear </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the year or water year for which a load was calculated </td>
</tr>
<tr>
 <td style="text-align: left;">
 load </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the load in kilograms per year </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The second data frame returned has one row for each pesticide at
a particular site and 11 columns. The general format is as follows: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
 pcode </td><td style="text-align: left;"> character </td><td style="text-align: left;"> the parameter code for which a load trend was calculated</td>
</tr>
<tr>
 <td style="text-align: left;">
 mclass </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a value of 1 or 2</td>
</tr>
<tr>
 <td style="text-align: left;">
 mclass </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a value of 1 or 2</td>
</tr>
<tr>
 <td style="text-align: left;">
 alpha </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a significance level </td>
</tr>
<tr>
 <td style="text-align: left;">
 ltndPpor </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the load trend in percent over the period of record </td>
</tr>
<tr>
 <td style="text-align: left;">
 luciPpor </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the load upper confidence interval for the trend in</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> percent over the period of record </td>
</tr>
<tr>
 <td style="text-align: left;">
 llciPpor </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the load lower confidence interval for the trend in</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> percent over the period of record </td>
</tr>
<tr>
 <td style="text-align: left;">
 baseLoad </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the base load, the load for the first year of trend period </td>
</tr>
<tr>
 <td style="text-align: left;">
 ltndOrigPORPercentBase </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the load trend in original units over</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> the period of record</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (calculation based on percent per year and base load)</td>
</tr>
<tr>
 <td style="text-align: left;">
 luciOrigPORPercentBase </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the load trend upper confidence interval</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> for the trend in original units over the period of record</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (calculation based on percent per year and base load)</td>
</tr>
<tr>
 <td style="text-align: left;">
 llciOrigPORPercentBase </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the load trend lower confidence interval</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> for the trend in original units over the period of record</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (calculation based on percent per year and base load)</td>
</tr>
<tr>
 <td style="text-align: left;">
 ltndlklhd </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> is the load trend likelihood </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Details</h3>

<p>Parameter load (mass) is the product of water-quality concentration 
(a mass per volume) and an associated streamflow rate (volume per time). This
function generates an annual time series of pesticide loads on either a
calendar year basis or a water year basis and summarizes load trends.
</p>


<h3>Value</h3>

<p>Two data frames, the first contains the annual loads, the second
contains the trend summary.
</p>


<h3>Note</h3>

<p>In this load calculation function, daily pesticide concentration 
estimates provided by the <code>fitswavecav</code> function are corrected for 
retransformation bias (the concentration model is built on the base-10 
logarithm of concentration; therefore, a bias correction is required when 
transforming back to the original units) and then used to calculate daily 
loads. The bias correction is based on the quasi-maximum likelihood estimator 
(Cohn and others, 1989) that was developed for natural logarithms, with an 
adjustment for the base-10 logarithm of the concentration. To calculate 
loads, the bias-corrected concentration estimates (assumed to be in 
micrograms per liter) are multiplied by daily streamflow and a constant, 
0.892998605, which converts the load units 
(micrograms per liter * cubic feet per second) to kilograms per year. 
Daily loads are summed to annual values. See page 70 and equation 26 of 
Oelsner and others (2017) for further details regarding the load 
calculation and bias correction.
Users may modify this function to convert to units other than kilograms
per year.
</p>


<h3>Author(s)</h3>

<p>Karen R. Ryberg
</p>


<h3>References</h3>

<p>Cohn, T.A., DeLong, L.L., Gilroy, E.J., Hirsch, R.M., and Wells, D.K., 1989, 
Estimating constituent loads: Water Resources Research, v. 25, no. 5, 
p. 937&ndash;942.
</p>
<p>Oelsner, G.P., Sprague, L.A., Murphy, J.C., Zuellig, R.E., Johnson, H.M., 
Ryberg, K.R., Falcone, J.A., Stets, E.G., Vecchia, A.V., Riskin, M.L., 
De Cicco, L.A., Mills, T.J., and Farmer, W.H., 2017, Water-quality trends in 
the Nation's rivers and streams, 1972&ndash;2012&mdash;Data preparation, statistical 
methods, and trend results (ver. 2.0, October 2017): U.S. Geological Survey 
Scientific Investigations Report 2017&ndash;5006, 136 p., 
<a href="https://doi.org/10.3133/sir20175006">https://doi.org/10.3133/sir20175006</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
modMoRivOmaha &lt;- combineData(qwdat = qwMoRivOmaha, cqwdat = cqwMoRivOmaha)
myfit1 &lt;- fitswavecav(cdat = modMoRivOmaha, cavdat = cqwMoRivOmaha, 
tanm = "myfit1", pnames = c("04035", "04037", "04041"), yrstart = 1995, 
yrend = 2003, tndbeg = 1995, tndend = 2003, iwcav = c("flowa30", "flowa1"), 
dcol = "dates", qwcols = c("R", "P"))
MoRivOmahaLoadsYr &lt;- loadCalculations(cqwMoRivOmaha[, 1:3], myfit1[[4]], 
myfit1[[1]], myfit1[[6]])
MoRivOmahaLoadsYr
</code></pre>

<hr>
<h2 id='pesticideTrendCalcs'>Summarize linear trends</h2><span id='topic+pesticideTrendCalcs'></span>

<h3>Description</h3>

<p>Internal function to summarize the trend results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pesticideTrendCalcs(
  tndbeg,
  tndend,
  ctnd,
  pval,
  alpha,
  setnd,
  scl,
  baseConc,
  mclass
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pesticideTrendCalcs_+3A_tndbeg">tndbeg</code></td>
<td>
<p>is the beginning (in whole or decimal years) of the 
trend period. Zero means the begin date will be the beginning of the
concentration data, cdat.</p>
</td></tr>
<tr><td><code id="pesticideTrendCalcs_+3A_tndend">tndend</code></td>
<td>
<p>is the end of the trend (treated as December 31
of that year). Zero means the end date will be the end of the 
concentration data, cdat.</p>
</td></tr>
<tr><td><code id="pesticideTrendCalcs_+3A_ctnd">ctnd</code></td>
<td>
<p>is the concentration trend, the coefficient on the time variable.</p>
</td></tr>
<tr><td><code id="pesticideTrendCalcs_+3A_pval">pval</code></td>
<td>
<p>is the p-value for the linear trend component.</p>
</td></tr>
<tr><td><code id="pesticideTrendCalcs_+3A_alpha">alpha</code></td>
<td>
<p>is the significance level or alpha value for statistical
significance and confidence intervals.</p>
</td></tr>
<tr><td><code id="pesticideTrendCalcs_+3A_setnd">setnd</code></td>
<td>
<p>is the standard error for the linear trend component.</p>
</td></tr>
<tr><td><code id="pesticideTrendCalcs_+3A_scl">scl</code></td>
<td>
<p>is the scale factor from the <code>survreg.object</code>.</p>
</td></tr>
<tr><td><code id="pesticideTrendCalcs_+3A_baseconc">baseConc</code></td>
<td>
<p>is the base concentration, the median concentration 
(midpoint of the trend line) for the first year of the trend analysis .</p>
</td></tr>
<tr><td><code id="pesticideTrendCalcs_+3A_mclass">mclass</code></td>
<td>
<p>indicates the class of model to use.
A class 1 model is the the traditional SEAWAVE-Q model that has a
linear time trend. A class 2 model is a newer option for longer
trend periods that uses a set of restricted cubic splines on the 
time variable to provide a more flexible model.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>The data frame returned has one row for each chemical analyzed 
and the number of columns are defined as follows: <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
 pname </td><td style="text-align: left;"> character </td><td style="text-align: left;"> parameter analyzed </td>
</tr>
<tr>
 <td style="text-align: left;">
 mclass </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a value of 1 or 2</td>
</tr>
<tr>
 <td style="text-align: left;">
 alpha </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> a significance level </td>
</tr>
<tr>
 <td style="text-align: left;">
 ctndPpor </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the concentration trend in percent over the period of record </td>
</tr>
<tr>
 <td style="text-align: left;">
 cuciPpor </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the concentration upper confidence interval for the trend in</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> percent over the period of record </td>
</tr>
<tr>
 <td style="text-align: left;">
 clciPpor </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the concentration lower confidence interval for the trend in</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> percent over the period of record </td>
</tr>
<tr>
 <td style="text-align: left;">
 baseConc </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the base concentration, median concentration or midpoint of</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> trend line, for first year of trend period </td>
</tr>
<tr>
 <td style="text-align: left;">
 ctndOrigPORPercentBase </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the concentration trend in original units over</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> the period of record</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (calculation based on percent per year and base concentration)</td>
</tr>
<tr>
 <td style="text-align: left;">
 cuciOrigPORPercentBase </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the concentration trend upper confidence interval</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> for the trend in original units over the period of record</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (calculation based on percent per year and base concentration)</td>
</tr>
<tr>
 <td style="text-align: left;">
 clciOrigPORPercentBase </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> the concentration trend lower confidence interval</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> for the trend in original units over the period of record</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td><td style="text-align: left;"> (calculation based on percent per year and base concentration)</td>
</tr>
<tr>
 <td style="text-align: left;">
 ctndlklhd </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> is the concentration trend likelihood </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Details</h3>

<p>pesticideTrendCalcs is called from within <a href="#topic+fitswavecav">fitswavecav</a>
</p>


<h3>Value</h3>

<p>The data frame returned has one row for each chemical analyzed and
summaries of the trend.
</p>


<h3>Note</h3>

<p>Based on trend calculations used to display and summarize pesticide
trends here <a href="https://nawqatrends.wim.usgs.gov/swtrends/">https://nawqatrends.wim.usgs.gov/swtrends/</a>.
A likelihood value that is the functional equivalent of the two-sided 
p-value associated with the significance level of the trend was 
determined as follows:
Likelihood = (1 - (p-value / 2)), where p-value is the 
p-value for the trend coefficient (Oelsner and others, 2017).
</p>


<h3>Author(s)</h3>

<p>Karen R. Ryberg
</p>


<h3>References</h3>

<p>Oelsner, G.P., Sprague, L.A., Murphy, J.C., Zuellig, R.E., Johnson, H.M., 
Ryberg, K.R., Falcone, J.A., Stets, E.G., Vecchia, A.V., Riskin, M.L., 
De Cicco, L.A., Mills, T.J., and Farmer, W.H., 2017, Water-quality trends in 
the Nation's rivers and streams, 1972&ndash;2012&mdash;Data preparation, statistical 
methods, and trend results (ver. 2.0, October 2017): U.S. Geological Survey 
Scientific Investigations Report 2017&ndash;5006, 136 p., 
<a href="https://doi.org/10.3133/sir20175006">https://doi.org/10.3133/sir20175006</a>.
</p>

<hr>
<h2 id='prepData'>Prepares concentration data and continuous ancillary data</h2><span id='topic+prepData'></span>

<h3>Description</h3>

<p>prepData is usually called from within <a href="#topic+fitswavecav">fitswavecav</a> but
can be invoked directly. It performs some date calculations, removes
rows with missing values for concentration or continuous variables, 
and returns the  concentration and continuous ancillary data to
be used by <a href="#topic+fitswavecav">fitswavecav</a> and its other internal functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepData(cdat, cavdat, yrstart, yrend, dcol, pnames, iwcav, qwcols)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepData_+3A_cdat">cdat</code></td>
<td>
<p>is the concentration data.</p>
</td></tr>
<tr><td><code id="prepData_+3A_cavdat">cavdat</code></td>
<td>
<p>is the continuous (daily) ancillary data.</p>
</td></tr>
<tr><td><code id="prepData_+3A_yrstart">yrstart</code></td>
<td>
<p>is the starting year of the analysis (treated as January
1 of that year). Zero means the start date will be determined by the 
start date of cavdat, the continuous ancillary data.</p>
</td></tr>
<tr><td><code id="prepData_+3A_yrend">yrend</code></td>
<td>
<p>is the ending year of the analysis (treated as December 31
of that year).  Zero means the end date will be determined by the end 
date of cavdat, the continuous ancillary data.</p>
</td></tr>
<tr><td><code id="prepData_+3A_dcol">dcol</code></td>
<td>
<p>is the column name for the dates, should be the same for 
both cdat and cavdat.</p>
</td></tr>
<tr><td><code id="prepData_+3A_pnames">pnames</code></td>
<td>
<p>are the parameters (water-quality constituents) to 
analyze (if using USGS parameters, omit the starting 'P', such as 
&quot;00945&quot; for sulfate).</p>
</td></tr>
<tr><td><code id="prepData_+3A_iwcav">iwcav</code></td>
<td>
<p>is a character variable indicating which continuous
ancillary variables to include, if none use iwcav=c(&quot;none&quot;).</p>
</td></tr>
<tr><td><code id="prepData_+3A_qwcols">qwcols</code></td>
<td>
<p>is a character vector with the beginning of the
column headers for remarks code (default is R), and beginning of 
column headers for concentration data (default is P for parameter).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The first element is the concentration data with
additional date information, missing values removed, and extra columns
removed. The second element is the continuous ancillary data with
additional date information, missing values removed, and extra columns
removed.
</p>


<h3>Author(s)</h3>

<p>Aldo V. Vecchia and Karen R. Ryberg
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
modMoRivOmaha&lt;-combineData(qwdat=qwMoRivOmaha, cqwdat=cqwMoRivOmaha)
preppedDat &lt;- prepData(modMoRivOmaha, cqwMoRivOmaha, yrstart=1995, 
yrend=2003, dcol="dates", pnames=c("04035", "04037", "04041"),  
iwcav=c("flowa30","flowa1"), qwcols=c("R","P"))
</code></pre>

<hr>
<h2 id='qwMoRivOmaha'>Water-quality data for 06610000 Missouri River at Omaha, Nebr.</h2><span id='topic+qwMoRivOmaha'></span>

<h3>Description</h3>

<p>Scatterplots of water-quality data for 06610000 Missouri River at Omaha, Nebr.
</p>
<p><img src="../help/figures/06610000Simazine.png" alt="Simazine concentrations in the
                                          Missouri River at Omaha, Nebr." /> <br />  
<img src="../help/figures/06610000Prometon.png" alt="Prometon concentrations in the
                                          Missouri River at Omaha, Nebr." /> <br />
<img src="../help/figures/06610000Cyanazine.png" alt="Cyanazine concentrations in the
                                          Missouri River at Omaha, Nebr." /> <br />
<img src="../help/figures/06610000Metolachlor.png" alt="Metolachlor concentrations in the
                                          Missouri River at Omaha, Nebr." /> <br />
<img src="../help/figures/06610000Alachlor.png" alt="Alachlor concentrations in the
                                          Missouri River at Omaha, Nebr." /> <br />
<img src="../help/figures/06610000Metribuzin.png" alt="Metribuzin concentrations in the
                                            Missouri River at Omaha, Nebr." /> <br />
<img src="../help/figures/06610000Trifluralin.png" alt="Trifluralin concentrations in the
                                            Missouri River at Omaha, Nebr." /> <br />
<img src="../help/figures/06610000EPTC.png" alt="EPTC concentrations in the
                                      Missouri River at Omaha, Nebr." /> <br />  
  
  






</p>


<h3>Usage</h3>

<pre><code class='language-R'>qwMoRivOmaha</code></pre>


<h3>Format</h3>

<p>A data frame containing 115 water-quality samples for eight 
chemical constituents.  There are  20 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
          staid </td><td style="text-align: left;"> character </td><td style="text-align: left;"> USGS Station identification number </td>
</tr>
<tr>
 <td style="text-align: left;">
          dates </td><td style="text-align: left;"> date </td><td style="text-align: left;"> Date water-quality sample collected </td>
</tr>
<tr>
 <td style="text-align: left;">
          times </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Time sample was collected </td>
</tr>
<tr>
 <td style="text-align: left;">
          R04035 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
          P04035 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Simazine, water, filtered, recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
          R04037 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
          P04037 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Prometon, water, filtered, recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
          R04041 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
          P04041 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Cyanazine, water, filtered, recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
          R39415 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
          P39415 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Metolachlor, water, filtered, recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
          R46342 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
          P46342 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Alachlor, water, filtered, recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
          R82630 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
          P82630 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Metribuzin, water, filtered, recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
          R82661 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
          P82661 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Trifluralin, water, filtered (0.7 micron glass fiber filter), recoverable, micrograms per liter </td>
</tr>
<tr>
 <td style="text-align: left;">
          R82668 </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Remark code (blank, _, &lt;, or E) </td>
</tr>
<tr>
 <td style="text-align: left;">
          P82668 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> EPTC, water, filtered (0.7 micron glass fiber filter), recoverable, micrograms per liter
        </td>
</tr>

</table>



<h3>Details</h3>

<p>Chemical concentration data are in the columns that start with a P and are 
followed by a number.  Qualification codes for the concentration data are in 
the columns that start with an R followed by the same numbers as the 
associated concentration data.  For example, column P04035 indicates   
simazine data, 04035, being the U.S. Geological Survey parameter code 
for simazine.  The qualification codes for the simazine concentrations 
are found in the column R04035, indicating a U.S. Geological Survey 
remark code.  Remark codes include _ or nothing, indicating no 
qualification of the value in the associated concentration field; &lt;,
indicating a censored value that is less than the number reported in the
associated concentration field; and E, indicating that the value has 
been estimated. See Oblinger Childress and others (1999) for information 
on the remark codes used by the U.S. Geological Survey.
</p>


<h3>Source</h3>

<p>Data provided by Patrick Phillips, U.S. Geological Survey,
New York Water Science Center.</p>


<h3>References</h3>

<p>Oblinger Childress, C.J., Foreman, W.T., Connor, B.F., and Maloney, T.J.,
1999, New reporting procedures based on long-term method detection levels
and some considerations for interpretations of water-quality data provided
by the U.S. Geological Survey Open-File Report 99&ndash;193, 19 p. [Also 
available at <a href="http://water.usgs.gov/owq/OFR_99-193/index.html">http://water.usgs.gov/owq/OFR_99-193/index.html</a>.]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(swData)
  
  # summary of water-quality concentrations
  apply(qwMoRivOmaha[, grep("P[[:digit:]]", dimnames(qwMoRivOmaha)[[2]])], 
  2, summary)

  # scatter plot of Simazine concentrations
  cenScatPlot(qwMoRivOmaha, pname = "04035")
  
  # scatter plot with many additional plotting arguments
  par(las = 1, tcl = 0.5)
  cenScatPlot(qwMoRivOmaha, pname = "04035", 
              site = "06610000 Missouri River at Omaha, Nebr.",
              ylabel = "Simazine concentration, in micrograms per liter", 
              legcex = 0.7, qwcols = c("R", "P"),
              ylim = c(0, 0.1), yaxs = "i", 
              xlim = c(as.Date("1996-01-01"), as.Date("2004-01-01")), 
              xaxs = "i", xaxt = "n")
  axdates &lt;- c("1996-01-01", "1998-01-01", "2000-01-01", "2002-01-01", 
            "2004-01-01")
  axis(1, as.Date(axdates), labels = c("1996", "1998", "2000", "2002", "2004"))
  
  # Prometon scatter plot
  cenScatPlot(qwMoRivOmaha, pname = "04037", 
              site = "06610000 Missouri River at Omaha, Nebr.",
              ylabel = "Prometon concentration, in micrograms per liter", 
              legcex = 0.7, qwcols = c("R", "P"),
              ylim = c(0, 0.1), yaxs = "i", 
              xlim = c(as.Date("1996-01-01"), 
                     as.Date("2004-01-01")), xaxs = "i", xaxt = "n")
  axdates &lt;- c("1996-01-01", "1998-01-01", "2000-01-01", "2002-01-01", 
             "2004-01-01")
  axis(1, as.Date(axdates), labels = c("1996", "1998", "2000", "2002", "2004"))

  # Cyanazine scatter plot
  cenScatPlot(qwMoRivOmaha, pname = "04041", 
              site = "06610000 Missouri River at Omaha, Nebr.",
              ylabel = "Cyanazine concentration, in micrograms per liter",
              legcex = 0.7, qwcols = c("R", "P"), 
              ylim = c(0.001, 5), yaxs = "i", 
              xlim = c(as.Date("1996-01-01"), as.Date("2004-01-01")), 
              xaxs = "i", xaxt = "n", log = "y")
  axdates &lt;- c("1996-01-01", "1998-01-01", "2000-01-01", "2002-01-01", 
             "2004-01-01")
  axis(1, as.Date(axdates), labels = c("1996", "1998", "2000", "2002", "2004"))

  # Metolachlor scatter plot
  cenScatPlot(qwMoRivOmaha, pname = "39415", 
              site = "06610000 Missouri River at Omaha, Nebr.",
              ylabel = "Metolachlor concentration, in micrograms per liter",
              legcex = 0.7, qwcols = c("R", "P"),
              ylim = c(0.001,5), yaxs = "i", 
              xlim = c(as.Date("1996-01-01"), as.Date("2004-01-01")), 
              xaxs = "i", xaxt = "n", log = "y", legpos = "bottomleft")
  axdates &lt;- c("1996-01-01", "1998-01-01", "2000-01-01", "2002-01-01", 
             "2004-01-01")
  axis(1, as.Date(axdates), labels = c("1996", "1998", "2000", "2002", "2004"))

  # Alachlor scatter plot
  cenScatPlot(qwMoRivOmaha, pname = "46342", 
              site = "06610000 Missouri River at Omaha, Nebr.",
              ylabel = "Alachlor concentration, in micrograms per liter", 
              legcex = 0.7, qwcols = c("R", "P"),
              ylim = c(0, 0.1), yaxs = "i", 
              xlim = c(as.Date("1996-01-01"), as.Date("2004-01-01")), 
              xaxs = "i", xaxt = "n")
  axdates &lt;- c("1996-01-01", "1998-01-01", "2000-01-01", "2002-01-01", 
             "2004-01-01")
  axis(1, as.Date(axdates), labels = c("1996", "1998", "2000", "2002", "2004"))
  
  # Metribuzin scatter plot
  cenScatPlot(qwMoRivOmaha, pname = "82630", 
              site = "06610000 Missouri River at Omaha, Nebr.",
              ylabel = "Metribuzin concentration, in micrograms per liter",
              legcex = 0.7, qwcols = c("R", "P"),
              ylim = c(0, 0.1), yaxs = "i", 
              xlim = c(as.Date("1996-01-01"), as.Date("2004-01-01")), 
              xaxs = "i", xaxt = "n")
  axdates &lt;- c("1996-01-01", "1998-01-01", "2000-01-01", "2002-01-01", 
             "2004-01-01")
  axis(1, as.Date(axdates), labels = c("1996", "1998", "2000", "2002", "2004"))

  # Trifluralin scatter plot
  cenScatPlot(qwMoRivOmaha, pname = "82661", 
              site = "06610000 Missouri River at Omaha, Nebr.",
              ylabel = "Trifluralin concentration, in micrograms per liter",
              legcex = 0.7, qwcols = c("R", "P"),
              ylim = c(0, 0.03), yaxs = "i", 
              xlim = c(as.Date("1996-01-01"), as.Date("2004-01-01")), 
              xaxs = "i", xaxt = "n")
  axdates&lt;-c("1996-01-01", "1998-01-01", "2000-01-01", "2002-01-01", 
             "2004-01-01")
  axis(1, as.Date(axdates), labels = c("1996", "1998", "2000", "2002", "2004"))

  # EPTC scatter plot
  cenScatPlot(qwMoRivOmaha, pname = "82668", 
              site = "06610000 Missouri River at Omaha, Nebr.",
              ylabel = "EPTC concentration, in micrograms per liter", 
              legcex = 0.7, qwcols = c("R", "P"),
              ylim = c(0.001, 1), yaxs = "i",
              xlim = c(as.Date("1996-01-01"), as.Date("2004-01-01")), 
              xaxs = "i", xaxt = "n", log = "y")
  axdates &lt;- c("1996-01-01", "1998-01-01", "2000-01-01", "2002-01-01", 
             "2004-01-01")
  axis(1, as.Date(axdates), labels =c ("1996", "1998", "2000", "2002", "2004"))
</code></pre>

<hr>
<h2 id='seawaveQPlots'>Internal function that generates plots of data and model results.</h2><span id='topic+seawaveQPlots'></span>

<h3>Description</h3>

<p>seawaveQPlots is usually called from within <code><a href="#topic+fitMod">fitMod</a></code> but
can be invoked directly. It generates plots of data and model results, 
as well as diagnostic plots, and returns the observed and predicted 
concentrations so that users may plot the concentrations using 
their own functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seawaveQPlots(
  stpars,
  cmaxt,
  tseas,
  tseaspr,
  tndlin,
  tndlinpr,
  cdatsub,
  cavdat,
  cavmat,
  clog,
  centmp,
  yrstart,
  yrend,
  tyr,
  tyrpr,
  pnames,
  tanm,
  mclass = 1,
  plotfile = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seawaveQPlots_+3A_stpars">stpars</code></td>
<td>
<p>is a matrix of information about the best seawaveQ model
for the concentration data, see <code><a href="#topic+examplestpars">examplestpars</a></code>.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_cmaxt">cmaxt</code></td>
<td>
<p>is the decimal season of maximum chemical concentration.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_tseas">tseas</code></td>
<td>
<p>is the decimal season of each concentration value in 
cdatsub.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_tseaspr">tseaspr</code></td>
<td>
<p>is the decimal season date used to model concentration 
using the continuous data set cavdat.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_tndlin">tndlin</code></td>
<td>
<p>is the decimal time centered on the midpoint of the trend
for the sample data, cdatasub.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_tndlinpr">tndlinpr</code></td>
<td>
<p>is the decimal time centered on the midpoint of the 
trend for the continuous data, cavdat.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_cdatsub">cdatsub</code></td>
<td>
<p>is the concentration data.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_cavdat">cavdat</code></td>
<td>
<p>is the continuous (daily) ancillary data.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_cavmat">cavmat</code></td>
<td>
<p>is a matrix containing the continuous ancillary 
variables.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_clog">clog</code></td>
<td>
<p>is a vector of the base-10 logarithms of the concentration 
data.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_centmp">centmp</code></td>
<td>
<p>is a logical vector indicating which concentration values
are censored.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_yrstart">yrstart</code></td>
<td>
<p>is the starting year of the analysis (treated as January
1 of that year).</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_yrend">yrend</code></td>
<td>
<p>is the ending year of the analysis (treated as December 31
of that year).</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_tyr">tyr</code></td>
<td>
<p>is a vector of decimal dates for the concentration data.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_tyrpr">tyrpr</code></td>
<td>
<p>is a vector of decimal dates for the continuous ancillary
variables.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_pnames">pnames</code></td>
<td>
<p>is the parameter (water-quality constituents) to 
analyze (if using USGS parameters, omit the starting 'P', such as 
&quot;00945&quot; for sulfate).</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_tanm">tanm</code></td>
<td>
<p>is a character identifier that names the trend 
analysis run.  It is used to label output files.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_mclass">mclass</code></td>
<td>
<p>has not been implemented yet, but will provide
additional model options.</p>
</td></tr>
<tr><td><code id="seawaveQPlots_+3A_plotfile">plotfile</code></td>
<td>
<p>is by default FALSE. True will write pdf files of plots to 
the user's file system.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PDF file containing plots of the data and modeled 
concentrations and regression diagnostic plots and a list containing
the observed concentrations (censored and uncensored) and the predicted
concentrations used for the plot.
</p>


<h3>Note</h3>

<p>The plotting position used for representing censored values in 
the plots produced by <code><a href="#topic+seawaveQPlots">seawaveQPlots</a></code> is an important 
consideration for interpreting model fit. Plotting values obtained by 
using the censoring limit, or something smaller such as one-half of the 
censoring limit, produce plots that are difficult to interpret if there 
are a large number of censored values. Therefore, to make the plots 
more representative of diagnostic plots used for standard 
(non-censored) regression, a method for substituting randomized 
residuals in place of censored residuals was used. If a 
log-transformed concentration is censored at a particular limit, 
<code>logC &lt; L</code>, then the residual for that concentration is censored 
as well, <code>logC - fitted(logC) &lt; L - fitted(logC) = rescen</code>. In 
that case, a randomized residual was generated from a conditional 
normal distribution <br /> <br />
<code>resran  &lt;-  scl * qnorm(runif(1) * pnorm(rescen / scl))</code>, <br /> <br />
where <code>scl</code> is the scale parameter from the survival regression model, 
<code>pnorm</code> is the R function for computing cumulative normal 
probabilities, <code>runif</code> is the R function for generating a 
random variable from the uniform distribution, and <code>qnorm</code> 
is the R function for computing quantiles of the normal distribution.  
Under the assumption that the model residuals are uncorrelated, 
normally distributed random variables with mean zero and standard 
deviation <code>scl</code>, the randomized residuals generated in this manner are an 
unbiased sample of the true (but unknown) residuals for the censored 
data. This is an application of the probability integral transform 
(Mood and others, 1974) to generate random variables from continuous 
distributions. The plotting position used a censored concentration is 
<code>fitted(logC) + resran</code>. Note that each time a new model fit is 
performed, a new set of randomized residuals is generated and thus the 
plotting positions for censored values can change.
</p>


<h3>Author(s)</h3>

<p>Aldo V. Vecchia and Karen R. Ryberg
</p>


<h3>References</h3>

<p>Mood, A.M., Graybill, F.A., and Boes, D.C., 1974, Introduction to the 
theory of statistics (3rd ed.): New York, McGraw-Hill, Inc., 564 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swData)
myPlots &lt;- seawaveQPlots(stpars=examplestpars, cmaxt=0.4808743, 
tseas=exampletseas, tseaspr=exampletseaspr, tndlin=exampletndlin,
tndlinpr=exampletndlinpr, cdatsub=examplecdatsub, cavdat=examplecavdat, 
cavmat=examplecavmat, clog=exampleclog, centmp=examplecentmp, 
yrstart=1995, yrend=2003, tyr=exampletyr, tyrpr=exampletyrpr, 
pnames=c("04041"), tanm="examplePlots04041", plotfile = FALSE)
</code></pre>

<hr>
<h2 id='seawaveQPlots2'>Internal function that generates plots of data and model results.</h2><span id='topic+seawaveQPlots2'></span>

<h3>Description</h3>

<p>seawaveQPlots2 is usually called from within <code><a href="#topic+fitMod">fitMod</a></code> but
can be invoked directly. It generates plots of data and model results, 
as well as diagnostic plots, and returns the observed and predicted 
concentrations so that users may plot the concentrations using 
their own functions. This is the version for models that use
restricted cubic splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seawaveQPlots2(
  stpars,
  cmaxt,
  tseas,
  tseaspr,
  tndrcs,
  tndrcspr,
  cdatsub,
  cavdat,
  cavmat,
  clog,
  centmp,
  yrstart,
  yrend,
  tyr,
  tyrpr,
  pnames,
  tanm,
  mclass = 2,
  numk,
  plotfile = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seawaveQPlots2_+3A_stpars">stpars</code></td>
<td>
<p>is a matrix of information about the best seawaveQ model
for the concentration data, see <code><a href="#topic+examplestpars">examplestpars</a></code>.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_cmaxt">cmaxt</code></td>
<td>
<p>is the decimal season of maximum chemical concentration.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_tseas">tseas</code></td>
<td>
<p>is the decimal season of each concentration value in 
cdatsub.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_tseaspr">tseaspr</code></td>
<td>
<p>is the decimal season date used to model concentration 
using the continuous data set cavdat.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_tndrcs">tndrcs</code></td>
<td>
<p>is the decimal time centered on the midpoint of the trend
for the sample data, cdatasub, then converted to a linear tail-restricted 
cubic spline with a particular number of knots (Harrell, 2010, 2018).</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_tndrcspr">tndrcspr</code></td>
<td>
<p>is the decimal time centered on the midpoint of the 
trend for the continuous data, cavdat, then converted to a linear 
tail-restricted cubic spline using the knots from tndrcs.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_cdatsub">cdatsub</code></td>
<td>
<p>is the concentration data.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_cavdat">cavdat</code></td>
<td>
<p>is the continuous (daily) ancillary data.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_cavmat">cavmat</code></td>
<td>
<p>is a matrix containing the continuous ancillary 
variables.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_clog">clog</code></td>
<td>
<p>is a vector of the base-10 logarithms of the concentration 
data.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_centmp">centmp</code></td>
<td>
<p>is a logical vector indicating which concentration values
are censored.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_yrstart">yrstart</code></td>
<td>
<p>is the starting year of the analysis (treated as January
1 of that year).</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_yrend">yrend</code></td>
<td>
<p>is the ending year of the analysis (treated as December 31
of that year).</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_tyr">tyr</code></td>
<td>
<p>is a vector of decimal dates for the concentration data.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_tyrpr">tyrpr</code></td>
<td>
<p>is a vector of decimal dates for the continuous ancillary
variables.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_pnames">pnames</code></td>
<td>
<p>is the parameter (water-quality constituents) to 
analyze (if using USGS parameters, omit the starting 'P', such as 
&quot;00945&quot; for sulfate).</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_tanm">tanm</code></td>
<td>
<p>is a character identifier that names the trend 
analysis run. It is used to label output files.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_mclass">mclass</code></td>
<td>
<p>indicates the class of model to use.
A class 1 model is the traditional SEAWAVE-Q model that has a
linear time trend. A class 2 model is a newer option for longer
trend periods that uses a set of restricted cubic splines on the 
time variable to provide a more flexible model.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_numk">numk</code></td>
<td>
<p>is the number of knots in the restricted cubic spline model.
The default is 4, and the recommended number is 3&ndash;7.</p>
</td></tr>
<tr><td><code id="seawaveQPlots2_+3A_plotfile">plotfile</code></td>
<td>
<p>is by default FALSE. True will write pdf files of plots to 
the user's file system.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PDF file (if plotfile is TRUE) containing plots of the data and 
modeled concentrations and regression diagnostic plots and a list containing
the observed concentrations (censored and uncensored) and the predicted
concentrations used for the plot.
</p>


<h3>Note</h3>

<p>The plotting position used for representing censored values in 
the plots produced by <code><a href="#topic+seawaveQPlots2">seawaveQPlots2</a></code> is an important 
consideration for interpreting model fit. Plotting values obtained by 
using the censoring limit, or something smaller such as one-half of the 
censoring limit, produce plots that are difficult to interpret if there 
are a large number of censored values. Therefore, to make the plots 
more representative of diagnostic plots used for standard 
(non-censored) regression, a method for substituting randomized 
residuals in place of censored residuals was used. If a 
log-transformed concentration is censored at a particular limit, 
<code>logC &lt; L</code>, then the residual for that concentration is censored 
as well, <code>logC - fitted(logC) &lt; L - fitted(logC) = rescen</code>. In 
that case, a randomized residual was generated from a conditional 
normal distribution <br /> <br />
<code>resran  &lt;-  scl * qnorm(runif(1) * pnorm(rescen / scl))</code>, <br /> <br />
where <code>scl</code> is the scale parameter from the survival regression model, 
<code>pnorm</code> is the R function for computing cumulative normal 
probabilities, <code>runif</code> is the R function for generating a 
random variable from the uniform distribution, and <code>qnorm</code> 
is the R function for computing quantiles of the normal distribution.  
Under the assumption that the model residuals are uncorrelated, 
normally distributed random variables with mean zero and standard 
deviation <code>scl</code>, the randomized residuals generated in this manner are an 
unbiased sample of the true (but unknown) residuals for the censored 
data. This is an application of the probability integral transform 
(Mood and others, 1974) to generate random variables from continuous 
distributions. The plotting position used for a censored concentration is 
<code>fitted(logC) + resran</code>. Note that each time a new model fit is 
performed, a new set of randomized residuals is generated and thus the 
plotting positions for censored values can change.
</p>


<h3>Author(s)</h3>

<p>Aldo V. Vecchia and Karen R. Ryberg
</p>


<h3>References</h3>

<p>Harrell, F.E., Jr., 2010, Regression modeling strategies&mdash;With
applications to linear models, logistic regression, and survival
analysis: New York, Springer-Verlag, 568 p.
</p>
<p>Harrell, F.E., Jr., 2018, rms&mdash;Regression modeling strategies: 
R package version 5.1-2, <a href="https://CRAN.R-project.org/package=rms">https://CRAN.R-project.org/package=rms</a>.
</p>
<p>Mood, A.M., Graybill, F.A., and Boes, D.C., 1974, Introduction to the  
theory of statistics (3d ed.): New York, McGraw-Hill, Inc., 564 p.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
