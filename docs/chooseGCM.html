<!DOCTYPE html><html lang="en"><head><title>Help for package chooseGCM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {chooseGCM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#closestdist_gcms'><p>Distance between General Circulation Models (GCMs)</p></a></li>
<li><a href='#compare_gcms'><p>Compare General Circulation Models (GCMs)</p></a></li>
<li><a href='#cor_gcms'><p>Compute and Plot Correlation Matrix for a Set of General Circulation Models</p></a></li>
<li><a href='#dist_gcms'><p>Distance Between GCMs</p></a></li>
<li><a href='#env_gcms'><p>General Circulation Model (GCM) Environmental Distribution</p></a></li>
<li><a href='#flatten_gcms'><p>Flatten General Circulation Models (GCMs)</p></a></li>
<li><a href='#hclust_gcms'><p>Hierarchical Clustering of GCMs</p></a></li>
<li><a href='#import_gcms'><p>Import GCM Data to R</p></a></li>
<li><a href='#kmeans_gcms'><p>Perform K-Means Clustering on GCMs</p></a></li>
<li><a href='#montecarlo_gcms'><p>Perform Monte Carlo Permutations on GCMs</p></a></li>
<li><a href='#optk_gcms'><p>Optimize the number of clusters for a dataset</p></a></li>
<li><a href='#summary_gcms'><p>Summarize General Circulation Model (GCM) Data</p></a></li>
<li><a href='#transform_gcms'><p>Transform General Circulation Model (GCM) Stacks</p></a></li>
<li><a href='#worldclim_data'><p>Download WorldClim v2.1 Bioclimatic Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Selecting General Circulation Models for Species Distribution
Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luíz Esser &lt;luizesser@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods to help selecting General Circulation Models (GCMs) 
    in the context of projecting models to future scenarios. It is provided
    clusterization algorithms, distance and correlation metrics, as well as
    a tailor-made algorithm to detect the optimum subset of GCMs that recreate
    the environment of all GCMs as proposed in Esser et al. (2025) &lt;<a href="https://doi.org/10.1111%2Fgcb.70008">doi:10.1111/gcb.70008</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, cluster, cowplot, factoextra, ggcorrplot, ggplot2,
graphics, httr, methods, reshape2, stats, terra, usedist, utils</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tictoc, testthat, sf, knitr, raster, rmarkdown, stars</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://luizesser.github.io/chooseGCM/">https://luizesser.github.io/chooseGCM/</a>,
<a href="https://github.com/luizesser/chooseGCM">https://github.com/luizesser/chooseGCM</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/luizesser/chooseGCM/issues">https://github.com/luizesser/chooseGCM/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-16 04:20:58 UTC; luizesser</td>
</tr>
<tr>
<td>Author:</td>
<td>Dayani Bailly <a href="https://orcid.org/0000-0002-6954-9902"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Reginaldo Ré <a href="https://orcid.org/0000-0001-6452-3466"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Marcos R. Lima <a href="https://orcid.org/0000-0002-5901-0911"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Luíz Esser <a href="https://orcid.org/0000-0003-2982-7223"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-16 09:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='closestdist_gcms'>Distance between General Circulation Models (GCMs)</h2><span id='topic+closestdist_gcms'></span>

<h3>Description</h3>

<p>This function compares future climate projections from multiple General Circulation Models (GCMs)
based on their similarity in terms of bioclimatic variables. It computes distance metrics between
GCMs and identifies subsets of GCMs that are similar to the global set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>closestdist_gcms(
  s,
  var_names = c("bio_1", "bio_12"),
  study_area = NULL,
  scale = TRUE,
  k = NULL,
  method = "euclidean",
  minimize_difference = TRUE,
  max_difference = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="closestdist_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="closestdist_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector with names of the bioclimatic variables to compare, or 'all'
to include all available variables.</p>
</td></tr>
<tr><td><code id="closestdist_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted.
Defines the study area for cropping and masking the rasters.</p>
</td></tr>
<tr><td><code id="closestdist_gcms_+3A_scale">scale</code></td>
<td>
<p>Logical. Whether to apply centering and scaling to the data. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="closestdist_gcms_+3A_k">k</code></td>
<td>
<p>Numeric. The number of GCMs to include in the subset. If <code>NULL</code> (default), stopping criteria are applied.</p>
</td></tr>
<tr><td><code id="closestdist_gcms_+3A_method">method</code></td>
<td>
<p>The distance method to use. Default is &quot;euclidean&quot;. Possible values are: &quot;euclidean&quot;,
&quot;maximum&quot;, &quot;manhattan&quot;, &quot;canberra&quot;, &quot;binary&quot;, &quot;minkowski&quot;, &quot;pearson&quot;, &quot;spearman&quot;, or &quot;kendall&quot;. See <code>?dist_gcms</code>.</p>
</td></tr>
<tr><td><code id="closestdist_gcms_+3A_minimize_difference">minimize_difference</code></td>
<td>
<p>Logical. If <code>k = NULL</code>, the function will search for the optimal
value of <code>k</code> by adding GCMs to the subset until the mean distance starts to diverge from the
global mean distance. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="closestdist_gcms_+3A_max_difference">max_difference</code></td>
<td>
<p>Numeric. A distance threshold to stop searching for the optimal subset.
If <code>NULL</code>, no threshold is set. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>minimize_difference</code> option searches for the best value of <code>k</code> by progressively
adding GCMs to the subset. The function monitors the mean distance between the subset of GCMs and
the global mean distance, stopping when the distance begins to increase.
The <code>max_difference</code> option sets a maximum distance difference. If the mean distance between
the subset GCMs exceeds this threshold, the function stops searching and returns the current subset.
</p>


<h3>Value</h3>

<p>A set of GCMs that have a mean distance closer to the global mean distance of all GCMs provided in <code>s</code>.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cor_gcms">cor_gcms</a></code> <code><a href="#topic+dist_gcms">dist_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
closestdist_gcms(s, var_names, study_area, method = "euclidean")

</code></pre>

<hr>
<h2 id='compare_gcms'>Compare General Circulation Models (GCMs)</h2><span id='topic+compare_gcms'></span>

<h3>Description</h3>

<p>This function compares future climate projections from multiple General Circulation Models (GCMs) based on their similarity in terms of variables. The function uses three clustering algorithms — k-means, hierarchical clustering, and closestdist — to group GCMs, and generates visualizations for the resulting clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_gcms(
  s,
  var_names = c("bio_1", "bio_12"),
  study_area = NULL,
  scale = TRUE,
  k = 3,
  clustering_method = "closestdist"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="compare_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector with the names of the variables to compare, or 'all' to include all available variables.</p>
</td></tr>
<tr><td><code id="compare_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted. Defines the study area for cropping and masking the rasters.</p>
</td></tr>
<tr><td><code id="compare_gcms_+3A_scale">scale</code></td>
<td>
<p>Logical. Whether to apply centering and scaling to the data. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="compare_gcms_+3A_k">k</code></td>
<td>
<p>Numeric. The number of clusters to use for k-means clustering.</p>
</td></tr>
<tr><td><code id="compare_gcms_+3A_clustering_method">clustering_method</code></td>
<td>
<p>Character. The clustering method to use. One of: &quot;kmeans&quot;, &quot;hclust&quot;, or &quot;closestdist&quot;. Default is &quot;closestdist&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two items: <code>suggested_gcms</code> (the names of the GCMs suggested for further analysis) and <code>statistics_gcms</code> (a grid of plots visualizing the clustering results).
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
compare_gcms(s, var_names, study_area, k = 3, clustering_method = "closestdist")

</code></pre>

<hr>
<h2 id='cor_gcms'>Compute and Plot Correlation Matrix for a Set of General Circulation Models</h2><span id='topic+cor_gcms'></span>

<h3>Description</h3>

<p>This function computes and visualizes the correlation matrix for a set of General Circulation Models (GCMs) based on their variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor_gcms(
  s,
  var_names = c("bio_1", "bio_12"),
  study_area = NULL,
  scale = TRUE,
  method = "pearson"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cor_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="cor_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector with names of the variables to compare, or 'all' to include all variables.</p>
</td></tr>
<tr><td><code id="cor_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted. Defines the study area for cropping and masking the rasters.</p>
</td></tr>
<tr><td><code id="cor_gcms_+3A_scale">scale</code></td>
<td>
<p>Logical. Whether to apply centering and scaling to the data. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="cor_gcms_+3A_method">method</code></td>
<td>
<p>Character. The correlation method to use. Default is &quot;pearson&quot;. Possible values are: &quot;pearson&quot;, &quot;kendall&quot;, or &quot;spearman&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing two items: <code>cor_matrix</code> (the calculated correlations between GCMs) and <code>cor_plot</code> (a plot visualizing the correlation matrix).
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform_gcms">transform_gcms</a></code> <code><a href="#topic+flatten_gcms">flatten_gcms</a></code> <code><a href="#topic+summary_gcms">summary_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
cor_gcms(s, var_names, study_area, method = "pearson")

</code></pre>

<hr>
<h2 id='dist_gcms'>Distance Between GCMs</h2><span id='topic+dist_gcms'></span>

<h3>Description</h3>

<p>This function compares future climate projections from multiple General Circulation Models (GCMs) based on their similarity in terms of variables. It calculates distance metrics and plots the results on a heatmap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_gcms(
  s,
  var_names = c("bio_1", "bio_12"),
  study_area = NULL,
  scale = TRUE,
  method = "euclidean"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="dist_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector of names of the variables to compare, or 'all' to include all variables.</p>
</td></tr>
<tr><td><code id="dist_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted. Defines the study area for cropping and masking the rasters.</p>
</td></tr>
<tr><td><code id="dist_gcms_+3A_scale">scale</code></td>
<td>
<p>Logical. Whether to apply centering and scaling to the data. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="dist_gcms_+3A_method">method</code></td>
<td>
<p>Character. The correlation method to use. Default is &quot;euclidean&quot;. Possible values are: &quot;euclidean&quot;, &quot;maximum&quot;, &quot;manhattan&quot;, &quot;canberra&quot;, &quot;binary&quot;, &quot;minkowski&quot;, &quot;pearson&quot;, &quot;spearman&quot;, or &quot;kendall&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing two items: <code>distances</code> (the calculated distances between GCMs) and <code>heatmap</code> (a plot displaying the heatmap).
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform_gcms">transform_gcms</a></code> <code><a href="#topic+flatten_gcms">flatten_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
dist_gcms(s, var_names, study_area, method = "euclidean")

</code></pre>

<hr>
<h2 id='env_gcms'>General Circulation Model (GCM) Environmental Distribution</h2><span id='topic+env_gcms'></span>

<h3>Description</h3>

<p>This function visualizes GCM data in environmental space, with options to highlight clusters or specific GCMs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>env_gcms(
  s,
  var_names = c("bio_1", "bio_12"),
  study_area = NULL,
  highlight = "sum",
  resolution = 25,
  title = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="env_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="env_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector of names of the variables to include, or 'all' to include all variables.</p>
</td></tr>
<tr><td><code id="env_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted. Defines the study area for cropping and masking the rasters.</p>
</td></tr>
<tr><td><code id="env_gcms_+3A_highlight">highlight</code></td>
<td>
<p>Character. A vector of GCM names to be highlighted. All other GCMs will appear in grey.</p>
</td></tr>
<tr><td><code id="env_gcms_+3A_resolution">resolution</code></td>
<td>
<p>Numeric. The resolution to be used in the plot. Default is <code>25</code>.</p>
</td></tr>
<tr><td><code id="env_gcms_+3A_title">title</code></td>
<td>
<p>Character. The title of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot displaying the environmental space for the specified GCMs.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary_gcms">summary_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
env_gcms(s, var_names, study_area, highlight = "sum")
env_gcms(s, var_names, study_area, highlight = c("ae", "ch", "cr"))

</code></pre>

<hr>
<h2 id='flatten_gcms'>Flatten General Circulation Models (GCMs)</h2><span id='topic+flatten_gcms'></span>

<h3>Description</h3>

<p>Scale and flatten a list of GCMs <code>data.frame</code>s.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flatten_gcms(s)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flatten_gcms_+3A_s">s</code></td>
<td>
<p>A list of transformed <code>data.frame</code>s representing GCMs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with columns as GCMs and rows as values from each cell to each variable.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform_gcms">transform_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
s_trans &lt;- transform_gcms(s, var_names, study_area)
flattened_gcms &lt;- flatten_gcms(s_trans)

</code></pre>

<hr>
<h2 id='hclust_gcms'>Hierarchical Clustering of GCMs</h2><span id='topic+hclust_gcms'></span>

<h3>Description</h3>

<p>This function performs hierarchical clustering on a random subset of raster values and produces a dendrogram visualization of the clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hclust_gcms(
  s,
  var_names = c("bio_1", "bio_12"),
  study_area = NULL,
  scale = TRUE,
  k = 3,
  n = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hclust_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="hclust_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector of names of the variables to include, or 'all' to include all variables.</p>
</td></tr>
<tr><td><code id="hclust_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted.
Defines the study area for cropping and masking the rasters.</p>
</td></tr>
<tr><td><code id="hclust_gcms_+3A_scale">scale</code></td>
<td>
<p>Logical. Should the data be centered and scaled? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="hclust_gcms_+3A_k">k</code></td>
<td>
<p>Integer. The number of clusters to identify.</p>
</td></tr>
<tr><td><code id="hclust_gcms_+3A_n">n</code></td>
<td>
<p>Integer. The number of values to use in the clustering. If <code>NULL</code> (default), all data is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dendrogram visualizing the clusters and the suggested GCMs.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform_gcms">transform_gcms</a></code> <code><a href="#topic+flatten_gcms">flatten_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
hclust_gcms(s, var_names, study_area, k = 4, n = 500)

</code></pre>

<hr>
<h2 id='import_gcms'>Import GCM Data to R</h2><span id='topic+import_gcms'></span>

<h3>Description</h3>

<p>This function imports GCM stack files from a folder into R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_gcms(
  path = "input_data/WorldClim_data_gcms",
  extension = ".tif",
  recursive = TRUE,
  gcm_names = NULL,
  var_names = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_gcms_+3A_path">path</code></td>
<td>
<p>Character. A string specifying the path to the GCM files.</p>
</td></tr>
<tr><td><code id="import_gcms_+3A_extension">extension</code></td>
<td>
<p>Character. The file extension of the stack files. Default is <code>".tif"</code>, the standard extension for WorldClim 2.1 data.</p>
</td></tr>
<tr><td><code id="import_gcms_+3A_recursive">recursive</code></td>
<td>
<p>Logical. Should the function import stacks recursively (i.e., search for files within subfolders)? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="import_gcms_+3A_gcm_names">gcm_names</code></td>
<td>
<p>Character. A vector of names to assign to each GCM.</p>
</td></tr>
<tr><td><code id="import_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector of names to assign to each variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of stacks, where each element corresponds to a GCM from the specified path.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+worldclim_data">worldclim_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = c("bio1", "bio12"))

</code></pre>

<hr>
<h2 id='kmeans_gcms'>Perform K-Means Clustering on GCMs</h2><span id='topic+kmeans_gcms'></span>

<h3>Description</h3>

<p>This function performs k-means clustering on a distance matrix and produces a scatter plot of the resulting clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kmeans_gcms(
  s,
  var_names = c("bio_1", "bio_12"),
  study_area = NULL,
  scale = TRUE,
  k = 3,
  method = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kmeans_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="kmeans_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector of names of the variables to include, or 'all' to include all variables.</p>
</td></tr>
<tr><td><code id="kmeans_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted.
Defines the study area for cropping and masking the rasters.</p>
</td></tr>
<tr><td><code id="kmeans_gcms_+3A_scale">scale</code></td>
<td>
<p>Logical. Should the data be centered and scaled? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="kmeans_gcms_+3A_k">k</code></td>
<td>
<p>Integer. The number of clusters to create.</p>
</td></tr>
<tr><td><code id="kmeans_gcms_+3A_method">method</code></td>
<td>
<p>Character. The method for distance matrix computation. Default is &quot;euclidean.&quot; Possible values are:
&quot;euclidean,&quot; &quot;maximum,&quot; &quot;manhattan,&quot; &quot;canberra,&quot; &quot;binary,&quot; or &quot;minkowski.&quot; If <code>NULL</code>, clustering will be performed on the raw variable data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scatter plot showing the resulting clusters and the suggested GCMs.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform_gcms">transform_gcms</a></code> <code><a href="#topic+flatten_gcms">flatten_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
kmeans_gcms(s, var_names, study_area, k = 3)

</code></pre>

<hr>
<h2 id='montecarlo_gcms'>Perform Monte Carlo Permutations on GCMs</h2><span id='topic+montecarlo_gcms'></span>

<h3>Description</h3>

<p>This function performs Monte Carlo permutations on a distance matrix and produces a violin plot showing the mean distance between subsets of the distance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>montecarlo_gcms(
  s,
  var_names = c("bio_1", "bio_12"),
  study_area = NULL,
  scale = TRUE,
  perm = 10000,
  dist_method = "euclidean",
  clustering_method = "closestdist",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="montecarlo_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="montecarlo_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector of names of the variables to include, or 'all' to include all variables.</p>
</td></tr>
<tr><td><code id="montecarlo_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted.
Defines the study area for cropping and masking the rasters.</p>
</td></tr>
<tr><td><code id="montecarlo_gcms_+3A_scale">scale</code></td>
<td>
<p>Logical. Should the data be centered and scaled? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="montecarlo_gcms_+3A_perm">perm</code></td>
<td>
<p>Integer. The number of permutations to perform.</p>
</td></tr>
<tr><td><code id="montecarlo_gcms_+3A_dist_method">dist_method</code></td>
<td>
<p>Character. The method for distance matrix computation. Default is &quot;euclidean.&quot; Possible values are:
&quot;euclidean,&quot; &quot;maximum,&quot; &quot;manhattan,&quot; &quot;canberra,&quot; &quot;binary,&quot; or &quot;minkowski.&quot; If <code>NULL</code>, clustering will be performed on the raw variable data.</p>
</td></tr>
<tr><td><code id="montecarlo_gcms_+3A_clustering_method">clustering_method</code></td>
<td>
<p>Character. The method for clustering. Default is &quot;closestdist.&quot; Possible values are: &quot;kmeans,&quot; &quot;hclust,&quot; or &quot;closestdist.&quot;</p>
</td></tr>
<tr><td><code id="montecarlo_gcms_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the clustering function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A violin plot showing the results. The dashed red line and red dots represent the mean absolute distance between subsets of GCMs using the clustering approach. The violin plot is generated from Monte Carlo permutations, selecting random subsets of GCMs from the provided set.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hclust_gcms">hclust_gcms</a></code> <code><a href="#topic+env_gcms">env_gcms</a></code> <code><a href="#topic+kmeans_gcms">kmeans_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
montecarlo_gcms(s, var_names, study_area)

</code></pre>

<hr>
<h2 id='optk_gcms'>Optimize the number of clusters for a dataset</h2><span id='topic+optk_gcms'></span>

<h3>Description</h3>

<p>This function performs clustering analysis on a dataset and determines the optimal number of clusters based on a specified method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optk_gcms(
  s,
  var_names = c("bio_1", "bio_12"),
  study_area = NULL,
  cluster = "kmeans",
  method = "wss",
  n = NULL,
  nstart = 10,
  K.max = 10,
  B = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optk_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models.</p>
</td></tr>
<tr><td><code id="optk_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector with the names of the variables to compare OR 'all'.</p>
</td></tr>
<tr><td><code id="optk_gcms_+3A_study_area">study_area</code></td>
<td>
<p>Extent object, or any object from which an Extent object can be extracted. An object that defines the study area for cropping and masking the rasters.</p>
</td></tr>
<tr><td><code id="optk_gcms_+3A_cluster">cluster</code></td>
<td>
<p>A character string specifying the method to build the clusters. Options are 'kmeans' (default) or 'hclust'.</p>
</td></tr>
<tr><td><code id="optk_gcms_+3A_method">method</code></td>
<td>
<p>A character string specifying the method to use for determining the optimal number of clusters. Options are 'wss' for within-cluster sum of squares, 'silhouette' for average silhouette width, and 'gap_stat' for the gap statistic method. Default is 'wss'.</p>
</td></tr>
<tr><td><code id="optk_gcms_+3A_n">n</code></td>
<td>
<p>An integer specifying the number of randomly selected samples to use in the clustering analysis. If NULL (default), all data is used.</p>
</td></tr>
<tr><td><code id="optk_gcms_+3A_nstart">nstart</code></td>
<td>
<p>Numeric. The number of random sets to be chosen. Default is 10. Argument is passed to 'stats::kmeans()'.</p>
</td></tr>
<tr><td><code id="optk_gcms_+3A_k.max">K.max</code></td>
<td>
<p>Numeric. The maximum number of clusters to consider. Default is 10. Argument is passed to 'factoextra::fviz_nbclust()'.</p>
</td></tr>
<tr><td><code id="optk_gcms_+3A_b">B</code></td>
<td>
<p>Integer. The number of Monte Carlo (“bootstrap”) samples. Default is 100. Argument is passed to 'cluster::clusGap()'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object representing the optimal number of clusters.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform_gcms">transform_gcms</a></code> <code><a href="#topic+flatten_gcms">flatten_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
optk_gcms(s, var_names, study_area)

</code></pre>

<hr>
<h2 id='summary_gcms'>Summarize General Circulation Model (GCM) Data</h2><span id='topic+summary_gcms'></span>

<h3>Description</h3>

<p>This function summarizes GCM data by calculating various statistics for each variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_gcms(s, var_names = c("bio_1", "bio_12"), study_area = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="summary_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector of names of the variables to include, or 'all' to include all variables.</p>
</td></tr>
<tr><td><code id="summary_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted.
Defines the study area for cropping and masking the rasters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the summary statistics for each variable.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transform_gcms">transform_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
summary_gcms(s, var_names, study_area)

</code></pre>

<hr>
<h2 id='transform_gcms'>Transform General Circulation Model (GCM) Stacks</h2><span id='topic+transform_gcms'></span>

<h3>Description</h3>

<p>This function transforms a list of GCM stacks by subsetting it to include only the variables
specified in <code>var_names</code>, reprojecting it to match the CRS of <code>study_area</code>,
cropping and masking it to <code>study_area</code>, and returning a list of data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_gcms(s, var_names = c("bio_1", "bio_12"), study_area = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transform_gcms_+3A_s">s</code></td>
<td>
<p>A list of stacks of General Circulation Models (GCMs).</p>
</td></tr>
<tr><td><code id="transform_gcms_+3A_var_names">var_names</code></td>
<td>
<p>Character. A vector of names of the variables to include, or 'all' to include all variables.</p>
</td></tr>
<tr><td><code id="transform_gcms_+3A_study_area">study_area</code></td>
<td>
<p>An Extent object, or any object from which an Extent object can be extracted.
Defines the study area for cropping and masking the rasters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames, where each element corresponds to a GCM in the input list.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary_gcms">summary_gcms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_names &lt;- c("bio_1", "bio_12")
s &lt;- import_gcms(system.file("extdata", package = "chooseGCM"), var_names = var_names)
study_area &lt;- terra::ext(c(-80, -30, -50, 10)) |&gt; terra::vect(crs="epsg:4326")
transform_gcms(s, var_names, study_area)

</code></pre>

<hr>
<h2 id='worldclim_data'>Download WorldClim v2.1 Bioclimatic Data</h2><span id='topic+worldclim_data'></span>

<h3>Description</h3>

<p>This function allows downloading data from WorldClim v2.1 (https://www.worldclim.org/data/index.html) for multiple GCMs, time periods, and SSPs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>worldclim_data(period = 'current', variable = 'bioc', year = '2030',
gcm = 'mi', ssp = '126', resolution = 10, path = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="worldclim_data_+3A_period">period</code></td>
<td>
<p>Character. Can be 'current' or 'future'.</p>
</td></tr>
<tr><td><code id="worldclim_data_+3A_variable">variable</code></td>
<td>
<p>Character. Specifies which variables to retrieve. Possible entries are:
'tmax', 'tmin', 'prec', and/or 'bioc'.</p>
</td></tr>
<tr><td><code id="worldclim_data_+3A_year">year</code></td>
<td>
<p>Character or vector. Specifies the year(s) to retrieve data for. Possible entries are:
'2030', '2050', '2070', and/or '2090'.</p>
</td></tr>
<tr><td><code id="worldclim_data_+3A_gcm">gcm</code></td>
<td>
<p>Character or vector. Specifies the GCM(s) to consider for future scenarios. See the table below for available options.</p>
</td></tr>
<tr><td><code id="worldclim_data_+3A_ssp">ssp</code></td>
<td>
<p>Character or vector. SSP(s) for future data. Possible entries are: '126', '245', '370', and/or '585'.</p>
</td></tr>
<tr><td><code id="worldclim_data_+3A_resolution">resolution</code></td>
<td>
<p>Numeric. Specifies the resolution. Possible values are 10, 5, 2.5, or 30 arcseconds.</p>
</td></tr>
<tr><td><code id="worldclim_data_+3A_path">path</code></td>
<td>
<p>Character. Directory path to save the downloaded files. Default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a folder in <code>path</code>.
All downloaded data will be stored in this folder.
Note: While it is possible to retrieve a large volume of data, it is not recommended to do so due to the large file sizes.
For example, datasets at 30 arcseconds resolution can exceed 4 GB. If the function fails to retrieve large datasets,
consider increasing the timeout by setting <code>options(timeout = 600)</code>. This will increase the timeout to 10 minutes.
</p>
<p>Available GCMs to be used in the <code>gcm</code> argument:</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>CODE</strong> </td><td style="text-align: right;"> <strong>GCM</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
   ac </td><td style="text-align: right;"> ACCESS-CM2 </td>
</tr>
<tr>
 <td style="text-align: left;">
   ae </td><td style="text-align: right;"> ACCESS-ESM1-5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   bc </td><td style="text-align: right;"> BCC-CSM2-MR </td>
</tr>
<tr>
 <td style="text-align: left;">
   ca </td><td style="text-align: right;"> CanESM5 </td>
</tr>
<tr>
 <td style="text-align: left;">
   cc </td><td style="text-align: right;"> CanESM5-CanOE </td>
</tr>
<tr>
 <td style="text-align: left;">
   ce </td><td style="text-align: right;"> CMCC-ESM2 </td>
</tr>
<tr>
 <td style="text-align: left;">
   cn </td><td style="text-align: right;"> CNRM-CM6-1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   ch </td><td style="text-align: right;"> CNRM-CM6-1-HR </td>
</tr>
<tr>
 <td style="text-align: left;">
   cr </td><td style="text-align: right;"> CNRM-ESM2-1 </td>
</tr>
<tr>
 <td style="text-align: left;">
   ec </td><td style="text-align: right;"> EC-Earth3-Veg </td>
</tr>
<tr>
 <td style="text-align: left;">
   ev </td><td style="text-align: right;"> EC-Earth3-Veg-LR </td>
</tr>
<tr>
 <td style="text-align: left;">
   fi </td><td style="text-align: right;"> FIO-ESM-2-0 </td>
</tr>
<tr>
 <td style="text-align: left;">
   gf </td><td style="text-align: right;"> GFDL-ESM4 </td>
</tr>
<tr>
 <td style="text-align: left;">
   gg </td><td style="text-align: right;"> GISS-E2-1-G </td>
</tr>
<tr>
 <td style="text-align: left;">
   gh </td><td style="text-align: right;"> GISS-E2-1-H </td>
</tr>
<tr>
 <td style="text-align: left;">
   hg </td><td style="text-align: right;"> HadGEM3-GC31-LL </td>
</tr>
<tr>
 <td style="text-align: left;">
   in </td><td style="text-align: right;"> INM-CM4-8 </td>
</tr>
<tr>
 <td style="text-align: left;">
   ic </td><td style="text-align: right;"> INM-CM5-0 </td>
</tr>
<tr>
 <td style="text-align: left;">
   ip </td><td style="text-align: right;"> IPSL-CM6A-LR </td>
</tr>
<tr>
 <td style="text-align: left;">
   me </td><td style="text-align: right;"> MIROC-ES2L </td>
</tr>
<tr>
 <td style="text-align: left;">
   mi </td><td style="text-align: right;"> MIROC6 </td>
</tr>
<tr>
 <td style="text-align: left;">
   mp </td><td style="text-align: right;"> MPI-ESM1-2-HR </td>
</tr>
<tr>
 <td style="text-align: left;">
   ml </td><td style="text-align: right;"> MPI-ESM1-2-LR </td>
</tr>
<tr>
 <td style="text-align: left;">
   mr </td><td style="text-align: right;"> MRI-ESM2-0 </td>
</tr>
<tr>
 <td style="text-align: left;">
   uk </td><td style="text-align: right;"> UKESM1-0-LL </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>This function does not return any value.
</p>


<h3>Author(s)</h3>

<p>Luíz Fernando Esser (luizesser@gmail.com)
https://luizfesser.wordpress.com
</p>


<h3>References</h3>

<p>https://www.worldclim.org/data/index.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# download data from multiple periods:
year &lt;- c("2050", "2090")
worldclim_data("future", "bioc", year, "mi", "126", 10, path=tempdir())

# download data from one specific period:
worldclim_data("future", "bioc", "2070", "mi", "585", 10, path=tempdir())


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
