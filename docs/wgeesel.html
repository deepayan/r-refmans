<!DOCTYPE html><html><head><title>Help for package wgeesel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {wgeesel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#data_sim'>
<p>Simulate longitudinal data</p></a></li>
<li><a href='#drgee'>
<p>Fit Doubly Robust Weighted Generalized Estimating Equations</p></a></li>
<li><a href='#imps'><p>Inpatient Multidimensional Psychiatric Scale (IMPS)</p></a></li>
<li><a href='#MLIC.gee'>
<p>MLIC and MLICC for Weighted GEE</p></a></li>
<li><a href='#MQIC.gee'>
<p>MQIC and MQICu for GEE</p></a></li>
<li><a href='#ohio'><p>Ohio Children Wheeze Status</p></a></li>
<li><a href='#QIC.gee'>
<p>QIC and QICu for GEE</p></a></li>
<li><a href='#QICW.gee'>
<p>QICWr and QICWp for WGEE</p></a></li>
<li><a href='#RJ.gee'>
<p>RJC for GEE</p></a></li>
<li><a href='#RJ2.gee'>
<p>Corrected RJC for GEE</p></a></li>
<li><a href='#seizure'><p>Epiliptic Seizures</p></a></li>
<li><a href='#wgee'>
<p>Fit Weighted Generalized Estimating Equations (WGEE)</p></a></li>
<li><a href='#wgeesel-internal'><p>Internal wgeesel Functions</p></a></li>
<li><a href='#wgeesel-package'>
<p>Weighted Generalized Estimating Equations and Model Selection</p></a></li>
<li><a href='#WRsquare.gee'>
<p>Weighted R Square for WGEE</p></a></li>
<li><a href='#ylag'>
<p>Generate subject-level lagged response</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Weighted Generalized Estimating Equations and Model Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-06</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Cong Xu &lt;congxu17@gmail.com&gt;, Zheng Li &lt;zheng.li@outlook.com&gt;, 
          Ming Wang &lt;mwang@phs.psu.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zheng Li &lt;zheng.li@outlook.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Weighted generalized estimating equations (WGEE) is an extension of generalized linear models to longitudinal clustered data by incorporating the correlation within-cluster when data is missing at random (MAR). The parameters in mean, scale correlation structures are estimated based on quasi-likelihood. Multiple model selection criterion are provided for selection of mean model and working correlation structure based on WGEE/GEE.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, stats, geepack, bindata, PoisNor,CRTgeeDR</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-07 21:35:53 UTC; joe</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-09 05:08:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='data_sim'>
Simulate longitudinal data
</h2><span id='topic+data_sim'></span>

<h3>Description</h3>

<p>The function generate correlated normal, Bernoulli or Poisson longitudinal data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_sim(id, rho, phi, x, beta, x_mis, para, corstr, family, lag_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data_sim_+3A_id">id</code></td>
<td>

<p>subject id
</p>
</td></tr>
<tr><td><code id="data_sim_+3A_rho">rho</code></td>
<td>

<p>with-in cluster correlation.
</p>
</td></tr>
<tr><td><code id="data_sim_+3A_phi">phi</code></td>
<td>

<p>scale parameter in the variance covariance matrix.
</p>
</td></tr>
<tr><td><code id="data_sim_+3A_x">x</code></td>
<td>

<p>covariate associated with the response.
</p>
</td></tr>
<tr><td><code id="data_sim_+3A_beta">beta</code></td>
<td>

<p>coefficients associated with x.
</p>
</td></tr>
<tr><td><code id="data_sim_+3A_x_mis">x_mis</code></td>
<td>

<p>covariates associated with missing model.
</p>
</td></tr>
<tr><td><code id="data_sim_+3A_para">para</code></td>
<td>

<p>coefficients associated with x_mis.
</p>
</td></tr>
<tr><td><code id="data_sim_+3A_corstr">corstr</code></td>
<td>

<p>a character string specifies the working correlation structure. The following are permitted: &quot;independence&quot;, &quot;exchangeable&quot;,&quot;ar1&quot;.
</p>
</td></tr>
<tr><td><code id="data_sim_+3A_family">family</code></td>
<td>

<p>a description of the error distribution and link function to be used in the model. This is a character string naming a family function. The following are permitted: &quot;gaussian&quot;, &quot;binary&quot;, &quot;poisson&quot;.
</p>
</td></tr>
<tr><td><code id="data_sim_+3A_lag_level">lag_level</code></td>
<td>

<p>specify how many lags of response y will affect missing probability.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generate normal, poisson and binary longitudinal data based on the specified variance-covariance matrix.
</p>


<h3>Value</h3>

<table>
<tr><td><code>data</code></td>
<td>
<p>simulated dataset</p>
</td></tr>
<tr><td><code>prob_miss</code></td>
<td>
<p>missing percentage of the response y</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cong Xu, Zheng Li and Ming Wang
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=500
id=rep(1:n,each=3)
rho=1
phi=1
x=cbind(1,rnorm(length(id)))
beta=c(1,1)
x_mis=cbind(1,rnorm(length(id)))
para=c(1,1,1)
data_sim(id,rho,phi,x,beta,x_mis,para,"independent","gaussian",lag_level = 1)
</code></pre>

<hr>
<h2 id='drgee'>
Fit Doubly Robust Weighted Generalized Estimating Equations
</h2><span id='topic+drgee'></span>

<h3>Description</h3>

<p>Analyzes longitudinal data with doubly robust augmented GEE approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drgee(model,outcomemodel, data, id, family, corstr, scale = NULL, 
       mismodel = NULL, nameTRT, maxit=200, tol=0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drgee_+3A_model">model</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="drgee_+3A_outcomemodel">outcomemodel</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the ouctome model
</p>
</td></tr>
<tr><td><code id="drgee_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="drgee_+3A_id">id</code></td>
<td>

<p>a vector which identifies the clusters. The length of &quot;id&quot; should be the same as
the number of observations. Data are assumed to be sorted so that observations
on a cluster are contiguous rows for all entities in the formula. 
</p>
</td></tr>
<tr><td><code id="drgee_+3A_family">family</code></td>
<td>

<p>a description of the error distribution and link function to be used in the model. This is a character string naming a family function. The following are permitted: &quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;.
</p>
</td></tr>
<tr><td><code id="drgee_+3A_corstr">corstr</code></td>
<td>

<p>a character string specifies the working correlation structure. The following are permitted:
&quot;independence&quot;, &quot;exchangeable&quot;, &quot;ar1&quot;,&quot;unstructured&quot;.
</p>
</td></tr>
<tr><td><code id="drgee_+3A_nametrt">nameTRT</code></td>
<td>

<p>name of the variable containing information for the treatment
</p>
</td></tr>
<tr><td><code id="drgee_+3A_scale">scale</code></td>
<td>

<p>a numeric variable giving the value to which the scale parameter should be fixed; if NA, the scale parameter is not fixed.
</p>
</td></tr>
<tr><td><code id="drgee_+3A_mismodel">mismodel</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the missingness model to be fitted. 
</p>
</td></tr>
<tr><td><code id="drgee_+3A_maxit">maxit</code></td>
<td>
<p>maximum iteration number for Newton-Raphson algorithm.</p>
</td></tr>
<tr><td><code id="drgee_+3A_tol">tol</code></td>
<td>

<p>the tolorance for the Newton-Raphson algorithm to converge.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Analyzes longitudinal data with doubly robust augmented GEE approach. 
</p>


<h3>Value</h3>

<p>An object of type 'CRTgeeDR'
</p>


<h3>Author(s)</h3>

<p>Zheng Li, Cong Xu and Ming Wang
</p>


<h3>References</h3>

<p>Augmented GEE for improving efficiency and validity of estimation in cluster randomized trials by leveraging cluster-and individual-level covariates -2012-Stephens A., Tchetgen Tchetgen E. and De Gruttola V. : <em>Stat Med</em> 31(10)-915-930.
</p>


<h3>See Also</h3>

<p>https://cran.r-project.org/web/packages/CRTgeeDR/index.html
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(imps)
fit &lt;- drgee(IMPS79 ~ Drug+Sex+Time, IMPS79 ~ Drug+Sex+Time,
      data=imps, id=imps$ID, family="gaussian",nameTRT="Drug",
       corstr="exchangeable", scale=NULL, mismodel= R ~ Drug+Time)
</code></pre>

<hr>
<h2 id='imps'>Inpatient Multidimensional Psychiatric Scale (IMPS)</h2><span id='topic+imps'></span>

<h3>Description</h3>

<p>The <code>imps</code> data frame has 1544 rows and 8 columns. The data is from National Institute of the Mental Health Schizophrenia Collaborative Study, where the effect of chlorpromazine, fluphenazine, or thioridazine treatment on the overall severity of the schizophrenia disorder is of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(imps)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>ID</dt><dd><p>patient ID</p>
</dd>
<dt>IMPS79</dt><dd><p>the severity of the schizophrenia disorder (ranges from 0 to 7)</p>
</dd>
<dt>Week</dt><dd><p>the fixed visit time</p>
</dd>
<dt>Drug</dt><dd><p>the indicator of treatment (1: chlorphromazine, fluphenazine, or thioridazine treatment; 0: placebo)</p>
</dd>
<dt>Sex</dt><dd><p>the indicator of sex of the patients (1: male; 0: female) </p>
</dd>    
<dt>R</dt><dd><p>an indicator of the missingness (1: observed; 0: missing) </p>
</dd>
<dt>Time</dt><dd><p>square root of the Week covariate</p>
</dd>
<dt>Y</dt><dd><p>an indicator if IMPS <code class="reqn">&gt;=4</code> </p>
</dd>
</dl>



<h3>Source</h3>

<p>Gibbons, R.D. and Hedeker, D., 1994. Application of random-effects probit regression models. <em>Journal of consulting and clinical psychology</em>, 62(2), p.285.
</p>


<h3>References</h3>

<p>Shen, C. W., &amp; Chen, Y. H. (2012). Model selection for generalized estimating equations accommodating dropout missingness. <em>Biometrics</em>, 68(4), 1046-1054.
</p>

<hr>
<h2 id='MLIC.gee'>
MLIC and MLICC for Weighted GEE
</h2><span id='topic+MLIC.gee'></span>

<h3>Description</h3>

<p>Calculate the MLIC (missing longitudinal information
criterion) for selection of mean model, and the MLICC (missing longitudinal information correlation
criterion) for selection of working correlation structure, based on the expected quadratic loss and the WGEE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLIC.gee(object,object_full)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLIC.gee_+3A_object">object</code></td>
<td>

<p>a fitted model object of class <code>"wgee"</code>.
</p>
</td></tr>
<tr><td><code id="MLIC.gee_+3A_object_full">object_full</code></td>
<td>

<p>a fitted model object of class <code>"wgee"</code>: the largest candidate model under consideration to be fitted. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a data frame of MLIC, MLICC and Wquad_loss.
</p>


<h3>Note</h3>

<p>MLIC and MLICC model selection criterion for longitudinal data criterion with dropouts or monotone missingness under the assumption of MAR.
</p>


<h3>Author(s)</h3>

<p>Cong Xu, Zheng Li and Ming Wang
</p>


<h3>References</h3>

<p>Robins, J.M., Rotnitzky, A. and Zhao, L.P., 1995. Analysis of semiparametric regression models for repeated outcomes in the presence of missing data. <em>Journal of the American Statistical Association</em>, 90(429), pp.106-121.
</p>
<p>Shen, C.W. and Chen, Y.H., 2012. Model selection for generalized estimating equations accommodating dropout missingness. <em>Biometrics</em>, 68(4), pp.1046-1054.
</p>
<p>Shen, C.W. and Chen, Y.H., 2013. Model selection of generalized estimating equations with multiply imputed longitudinal data. <em>Biometrical Journal</em>, 55(6), pp.899-911.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wgee">wgee</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(imps)
fit1 &lt;- wgee (Y ~ Drug+Sex+Time,data=imps,id=imps$ID,family="binomial",
             corstr="exchangeable",scale=NULL,mismodel= R ~ Drug+Time)

fit_f &lt;- wgee (Y ~ Drug+Sex+Time+Time*Sex+Time*Drug,data=imps,id=imps$ID, family="binomial",
              corstr="exchangeable",scale=NULL,mismodel= R ~ Drug+Time)
###not run#####
##MLIC.gee(fit1,fit_f)

</code></pre>

<hr>
<h2 id='MQIC.gee'>
MQIC and MQICu for GEE
</h2><span id='topic+MQIC.gee'></span>

<h3>Description</h3>

<p>Calculate MQIC (Modified QIC) and MQIC<code class="reqn">_{u}</code>. MQIC is an asymptotic unbiased estimator of the risk function based on the independent quasi-likelihood. MQIC and original QIC may have non-negligible effect for model selection, especially when the true correlation structure completely different from the working correlation structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MQIC.gee(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MQIC.gee_+3A_object">object</code></td>
<td>
<p>a fitted model object of class <code>"wgee"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list of MQIC, MQIC<code class="reqn">_{u}</code> and Quasi-likelihood.
</p>


<h3>Author(s)</h3>

<p>Cong Xu, Zheng Li and Ming Wang
</p>


<h3>References</h3>

<p>Pan, W., 2001. Akaike's information criterion in generalized estimating equations. <em>Biometrics</em>, 57(1), pp.120-125.
</p>
<p>Gosho, M., Hamada, C., and Yoshimura, I. (2011). Modifications of QIC and CIC for Selecting a Working Correlation Structure in the Generalized Estimating Equation Method. <em>Japanese Journal of Biometrics</em>, 32(1), 1-12.
</p>
<p>Imori, S., 2013. On Properties of QIC in Generalized Estimating Equations. <em>Hiroshima University</em>, pp.1-8.
</p>


<h3>See Also</h3>

<p><code><a href="geepack.html#topic+geeglm">geeglm</a></code> (<span class="pkg">geepack</span>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(imps)

fit &lt;- wgee(IMPS79 ~ Drug+Sex+Time, data=imps,id=imps$ID,family="gaussian",
             corstr="independence")
MQIC.gee(fit)


data(ohio)

fit2 &lt;- wgee(resp ~ age + smoke+age:smoke, data=ohio, id=ohio$id, 
             family="binomial", corstr="independence")
MQIC.gee(fit2)


</code></pre>

<hr>
<h2 id='ohio'>Ohio Children Wheeze Status</h2><span id='topic+ohio'></span>

<h3>Description</h3>

<p>The <code>ohio</code> data frame has 2148 rows and 4 columns. The dataset is a
subset of the six-city study, a longitudinal study of the health effects
of air pollution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ohio)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>resp</dt><dd><p>an indicator of wheeze status (1=yes, 0=no)</p>
</dd>
<dt>id</dt><dd><p>a numeric vector for subject id</p>
</dd>
<dt>age</dt><dd><p>a numeric vector of age, 0 to 9 years old</p>
</dd>
<dt>smoke</dt><dd><p>an indicator of maternal smoking at the first year of
the study (1=yes, 0=no)</p>
</dd>
</dl>



<h3>References</h3>

<p>Fitzmaurice, G.M. and Laird, N.M. (1993) A likelihood-based method for
analyzing longitudinal binary responses, <em>Biometrika</em> <b>80</b>: 141&ndash;151.
</p>


<h3>See Also</h3>

<p><code><a href="geepack.html#topic+ohio">ohio</a></code> (<span class="pkg">geepack</span>)
</p>

<hr>
<h2 id='QIC.gee'>
QIC and QICu for GEE
</h2><span id='topic+QIC.gee'></span>

<h3>Description</h3>

<p>Calculate quasi-likelihood under the independence model criterion (QIC) and QIC<code class="reqn">_{u}</code> based on GEE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QIC.gee(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QIC.gee_+3A_object">object</code></td>
<td>
<p>a fitted model object of class <code>"wgee"</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a vector of QIC, QIC<code class="reqn">_{u}</code> and Quasi-likelihood.
</p>


<h3>Note</h3>

<p>QIC can be used to select the best correlation structure and the best fitting model in GEE analyses. The GEE is fitted by <code><a href="geepack.html#topic+geeglm">geeglm</a></code> (<span class="pkg">geepack</span>). QIC<code class="reqn">_{u}</code> is a simplified version of QIC, which can not be applied to select the optimal working correlation structure. <code><a href="geepack.html#topic+geeglm">geeglm</a></code> (<span class="pkg">geepack</span>) only works for complete data. Thus if there are NAâ€™s in data, the missing values are automatically removed by <code><a href="stats.html#topic+na.omit">na.omit</a></code>.
</p>


<h3>Author(s)</h3>

<p>Cong Xu, Zheng Li and Ming Wang
</p>


<h3>References</h3>

<p>Liang, K.Y. and Zeger, S.L., 1986. Longitudinal data analysis using generalized linear models. <em>Biometrika</em>, pp.13-22.
</p>
<p>Pan, W., 2001. Akaike's information criterion in generalized estimating equations. <em>Biometrics</em>, 57(1), pp.120-125.
</p>
<p>Prentice, R.L. and Zhao, L.P., 1991. Estimating equations for parameters in means and covariances of multivariate discrete and continuous responses. <em>Biometrics</em>, pp.825-839.
</p>


<h3>See Also</h3>

<p><code><a href="geepack.html#topic+geeglm">geeglm</a></code> (<span class="pkg">geepack</span>). <span class="pkg">MuMIn</span> also provides QIC value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(imps)
fit &lt;- wgee(Y ~ Drug+Sex+Time, data=imps, id=imps$ID, family="binomial",
            corstr="exchangeable")

QIC.gee(fit)

data(seizure)
###reshapre the seizure data to "long" format
seiz.long &lt;- reshape(seizure, varying=list(c("base","y1", "y2", "y3", "y4")),
                      v.names="y", times=0:4, direction="long")
seiz.long &lt;- seiz.long[order(seiz.long$id, seiz.long$time),]

fit &lt;- wgee(y ~ age + trt + time, data=seiz.long, id=seiz.long$id, 
            family="poisson", corstr="independence")

QIC.gee(fit)
</code></pre>

<hr>
<h2 id='QICW.gee'>
QICWr and QICWp for WGEE
</h2><span id='topic+QICW.gee'></span>

<h3>Description</h3>

<p>Calculate the QICW<code class="reqn">_{r}</code> and QICW<code class="reqn">_{p}</code> (an information criterion based on the weighted quasi-likelihood function) for selection of mean model and correlation structure based on the WGEE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QICW.gee(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QICW.gee_+3A_object">object</code></td>
<td>
<p>a fitted model object of class <code>"wgee"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a data frame of QICW<code class="reqn">_{r}</code>, QICW<code class="reqn">_{p}</code> and Wquasi_lik.
</p>


<h3>Note</h3>

<p>QICW<code class="reqn">_{r}</code> can be used for variable selection and for selecting the correlation structure in WGEE analyses. QICW<code class="reqn">_{p}</code> is a simplified version of QICW<code class="reqn">_{r}</code>, which can not be applied to select the optimal working correlation structure in WGEE.
</p>


<h3>Author(s)</h3>

<p>Cong Xu, Zheng Li and Ming Wang
</p>


<h3>References</h3>

<p>Gosho, M., 2015. Model selection in the weighted generalized estimating equations for longitudinal data with dropout. <em>Biometrical Journal</em>.
</p>
<p>Platt, R.W., Brookhart, M.A., Cole, S.R., Westreich, D. and Schisterman, E.F., 2013. An information criterion for marginal structural models. <em>Statistics in medicine</em>, 32(8), pp.1383-1393.
</p>
<p>Robins, J.M., Rotnitzky, A. and Zhao, L.P., 1995. Analysis of semiparametric regression models for repeated outcomes in the presence of missing data. <em>Journal of the American Statistical Association</em>, 90(429), pp.106-121.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wgee">wgee</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(imps)

### variable selection by QICWr, not rum###
#fit &lt;- wgee(IMPS79 ~ Drug+Sex+Time, mismodel= R ~ Drug+Time, data=imps,
##           id=imps$ID, family="gaussian", corstr="exchangeable")
##QICW.gee(fit)

#fit &lt;- wgee(IMPS79 ~ Drug+Sex+Time+Time:Sex+Time:Drug, mismodel= R ~ Drug+Time,
#        data=imps, id=imps$ID, family="gaussian", corstr="exchangeable")
##QICW.gee(fit)
</code></pre>

<hr>
<h2 id='RJ.gee'>
RJC for GEE
</h2><span id='topic+RJ.gee'></span>

<h3>Description</h3>

<p>Calculate RJC (Rotnitzky-Jewell information criterion) based on GEE. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RJ.gee(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RJ.gee_+3A_object">object</code></td>
<td>

<p>a fitted model object of class <code>"wgee"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rotnitzky-Jewell information criterion (RJC) is usually used for working correlation structure selection.
</p>


<h3>Value</h3>

<p>Return the value of the Rotnitzky-Jewell information criterion (RJ). 
</p>


<h3>Author(s)</h3>

<p>Cong Xu, Zheng Li and Ming Wang
</p>


<h3>References</h3>

<p>Rotnitzky, A. and Jewell, N.P., 1990. Hypothesis testing of regression parameters in semiparametric generalized linear models for cluster correlated data. <em>Biometrika</em>, pp.485-497.
</p>


<h3>See Also</h3>

<p><code><a href="geepack.html#topic+geeglm">geeglm</a></code> (<span class="pkg">geepack</span>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ohio)

fit &lt;- wgee(resp ~ age + smoke+age:smoke, data=ohio, id=ohio$id, 
            family="binomial", corstr="exchangeable")
       
RJ.gee(fit)

</code></pre>

<hr>
<h2 id='RJ2.gee'>
Corrected RJC for GEE
</h2><span id='topic+RJ2.gee'></span>

<h3>Description</h3>

<p>Calculate corrected RJC (Rotnitzky-Jewell information criterion) based on GEE with a modified robust variance estimator. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RJ2.gee(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RJ2.gee_+3A_object">object</code></td>
<td>

<p>a fitted model object of class <code>"wgee"</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return the value of the corrected Rotnitzky-Jewell information criterion (RJC). 
</p>


<h3>Note</h3>

<p><code><a href="#topic+RJ2.gee">RJ2.gee</a></code> can only handle balanced data (data with dropout missingness). Two assumptions should be satisfied. (A1) The conditional variance of <code class="reqn">Y_{ij}</code> given <code class="reqn">X_{ij}</code> is correctly specified; (A2) A common correlation structure, <code class="reqn">Rc</code>, exists across all subjects. If there is missingness, one can group the subjects by the cluter size of the response variable. And, calculate the modified robust variance in each group to get the pooled estimate of the variance. 
</p>


<h3>Author(s)</h3>

<p>Cong Xu, Zheng Li and Ming Wang
</p>


<h3>References</h3>

<p>Rotnitzky, A. and Jewell, N.P., 1990. Hypothesis testing of regression parameters in semiparametric generalized linear models for cluster correlated data. <em>Biometrika</em>, pp.485-497.
</p>
<p>Wang, M. and Long, Q., 2011. Modified robust variance estimator for generalized estimating equations with improved small-sample performance. <em>Statistics in Medicine</em>, 30(11), pp. 1278-1291.
</p>


<h3>See Also</h3>

<p><code><a href="geepack.html#topic+geeglm">geeglm</a></code> (<span class="pkg">geepack</span>), <code><a href="#topic+RJ.gee">RJ.gee</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ohio)

fit &lt;- wgee(resp ~ age + smoke+age:smoke, data=ohio, id=ohio$id, 
            family="binomial",corstr="exchangeable")
RJ2.gee(fit)       

</code></pre>

<hr>
<h2 id='seizure'>Epiliptic Seizures</h2><span id='topic+seizure'></span>

<h3>Description</h3>

<p>The dataset has the number of epiliptic seizures in each of four two-week 
intervals,and in a baseline eight-week inverval, for treatment and control 
groups with a total of 59 individuals. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(seizure)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>y1</dt><dd><p>the number of epiliptic seizures in the 1st 2-week
interval</p>
</dd>
<dt>y2</dt><dd><p>the number of epiliptic seizures in the 2nd 2-week
interval</p>
</dd>
<dt>y3</dt><dd><p>the number of epiliptic seizures in the 3rd 2-week
interval</p>
</dd>
<dt>y4</dt><dd><p>the number of epiliptic seizures in the 4th 2-week
interval</p>
</dd>    
<dt>trt</dt><dd><p>an indicator of treatment</p>
</dd>
<dt>base</dt><dd><p>the number of epilitic seizures in a baseline 8-week
interval</p>
</dd>
<dt>age</dt><dd><p>a numeric vector of subject age</p>
</dd>
</dl>



<h3>Source</h3>

<p>Thall, P.F. and Vail S.C. (1990)
Some covariance models for longitudinal count data with
overdispersion. <em>Biometrics</em> <b>46</b>: 657&ndash;671.
</p>


<h3>References</h3>

<p>Diggle, P.J., Liang, K.Y., and Zeger, S.L. (1994)
Analysis of Longitudinal Data. Clarendon Press.
</p>


<h3>See Also</h3>

<p><code><a href="geepack.html#topic+seizure">seizure</a></code> (<span class="pkg">geepack</span>)
</p>

<hr>
<h2 id='wgee'>
Fit Weighted Generalized Estimating Equations (WGEE)
</h2><span id='topic+wgee'></span>

<h3>Description</h3>

<p><code><a href="#topic+wgee">wgee</a></code> fits weighted generalized estimating equations (WGEE) with Newton Raphson algorithm. <code><a href="#topic+wgee">wgee</a></code> has a syntax similar to <code><a href="stats.html#topic+glm">glm</a></code> and returns an object similar to a <code><a href="stats.html#topic+glm">glm</a></code> object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wgee(model, data, id, family, corstr, scale = NULL, mismodel = NULL, maxit=200, tol=0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wgee_+3A_model">model</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.
</p>
</td></tr>
<tr><td><code id="wgee_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.
</p>
</td></tr>
<tr><td><code id="wgee_+3A_id">id</code></td>
<td>

<p>a vector which identifies the clusters. The length of &quot;id&quot; should be the same as
the number of observations. Data are assumed to be sorted so that observations
on a cluster are contiguous rows for all entities in the formula. 
</p>
</td></tr>
<tr><td><code id="wgee_+3A_family">family</code></td>
<td>

<p>a description of the error distribution and link function to be used in the model. This is a character string naming a family function. The following are permitted: &quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;.
</p>
</td></tr>
<tr><td><code id="wgee_+3A_corstr">corstr</code></td>
<td>

<p>a character string specifies the working correlation structure. The following are permitted:
&quot;independence&quot;, &quot;exchangeable&quot;, &quot;ar1&quot;,&quot;unstructured&quot;.
</p>
</td></tr>
<tr><td><code id="wgee_+3A_scale">scale</code></td>
<td>

<p>a numeric variable giving the value to which the scale parameter should be fixed; if NA, the scale parameter is not fixed.
</p>
</td></tr>
<tr><td><code id="wgee_+3A_mismodel">mismodel</code></td>
<td>

<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the missingness model to be fitted. 
</p>
</td></tr>
<tr><td><code id="wgee_+3A_maxit">maxit</code></td>
<td>

<p>maximum iteration number for Newton-Raphson algorithm.
</p>
</td></tr>
<tr><td><code id="wgee_+3A_tol">tol</code></td>
<td>

<p>the tolorance for the Newton-Raphson algorithm to converge.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+wgee">wgee</a></code> analyzes longitudinal data with missing values by weighted genralized estimating equations (WGEE), proposed by Robins, Totnizky and Zhao (1995). WGEE can handle missing at random problem. The standard error of the estimates are calculated as described in (Fitzmaurice, Laird, and Ware, 2011) and Preisser, Lohman, and Rathouz (2002).
</p>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p> covariate effect estimates</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p> variance covariances estimates for beta</p>
</td></tr>
<tr><td><code>w_r_square</code></td>
<td>
<p> weighted R square for continuous data</p>
</td></tr>
<tr><td><code>mu_fit</code></td>
<td>
<p> fitted values of response</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>scale estimates</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>rho estimates</p>
</td></tr>
<tr><td><code>weight</code></td>
<td>
<p>The weight of response y</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>WGEE model structure</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>covariates in WGEE</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>response in WGEE</p>
</td></tr>
<tr><td><code>mis_fit</code></td>
<td>
<p>esimates of the missingness model</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the function to be called</p>
</td></tr>
<tr><td><code>id</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>corstr</code></td>
<td>
<p>as input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zheng Li, Cong Xu and Ming Wang
</p>


<h3>References</h3>

<p>Fitzmaurice, G.M., Laird, N.M. and Ware, J.H., 2012. <em>Applied longitudinal analysis (Vol. 998)</em>. John Wiley &amp; Sons.
</p>
<p>Liang, K.Y. and Zeger, S.L., 1986. Longitudinal data analysis using generalized linear models. <em>Biometrika</em>, pp.13-22.
</p>
<p>Preisser, J.S., Lohman, K.K. and Rathouz, P.J., 2002. Performance of weighted estimating equations for longitudinal binary data with drop-outs missing at random. <em>Statistics in medicine</em>, 21(20), pp.3035-3054.
</p>
<p>Robins, J.M., Rotnitzky, A. and Zhao, L.P., 1995. Analysis of semiparametric regression models for repeated outcomes in the presence of missing data. <em>Journal of the American Statistical Association</em>, 90(429), pp.106-121.
</p>
<p>Rubin, D.B., 1976. Inference and missing data. <em>Biometrika</em>, pp.581-592.
</p>


<h3>See Also</h3>

<p><code><a href="geepack.html#topic+geeglm">geeglm</a></code> (<span class="pkg">geepack</span>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####Example1
data(imps)

fit &lt;- wgee(IMPS79 ~ Drug+Sex+Time, data=imps, id=imps$ID, family="gaussian",
            corstr="exchangeable", scale=NULL, mismodel= R ~ Drug+Time)

#####Example2
data(seizure)

###reshapre the seizure data to "long" format
seiz.long &lt;- reshape(seizure,
                     varying=list(c("base","y1", "y2", "y3", "y4")),
                     v.names="y", times=0:4, direction="long")
seiz.long &lt;- seiz.long[order(seiz.long$id, seiz.long$time),]

###create missing value for seiz.long dataset
set.seed(12345)
obs &lt;- exp(9+seiz.long$age*(-0.2))/(1+exp(9+seiz.long$age*(-0.2)))
R &lt;- lapply(unique(seiz.long$id),function(x){
  idx=which(seiz.long$id==x)
  r=c()
  r[1]=1
  for(j in 2:length(idx)){
    if(r[j-1]==1){
      r[j]=rbinom(1,1,obs[idx[j]])
    }
    else r[j]=0
  }
  return(r)
})
remove_id &lt;- which(sapply(R,sum)==1)
remove_idx &lt;- which(seiz.long$id %in% remove_id==1)
seiz.long &lt;- cbind(seiz.long,R=unlist(R))[-remove_idx,]
seiz.long$y_mis &lt;- ifelse(seiz.long$R,seiz.long$y,NA)

###fit WGEE, not run ###
fit &lt;- wgee(y_mis ~ age + trt + time, data=seiz.long, id=seiz.long$id,family="poisson",
            corstr="exchangeable",scale=NULL, mismodel= R ~ age)

</code></pre>

<hr>
<h2 id='wgeesel-internal'>Internal wgeesel Functions</h2><span id='topic+mat.prod'></span><span id='topic+E_i_est'></span><span id='topic+newton_raphson'></span><span id='topic+us_matrix'></span><span id='topic+V_w_est'></span><span id='topic+binary_fun'></span><span id='topic+cluster.size'></span><span id='topic+cluster_est'></span><span id='topic+cont_fun'></span><span id='topic+cormax.ar1'></span><span id='topic+cormax.exch'></span><span id='topic+cormax.ind'></span><span id='topic+count_fun'></span><span id='topic+cs_con_str_est'></span><span id='topic+phi_con_str_est'></span><span id='topic+print.wgee'></span><span id='topic+summary.wgee'></span>

<h3>Description</h3>

<p>Internal <span class="pkg">wgeesel</span> functions.
</p>

<hr>
<h2 id='wgeesel-package'>
Weighted Generalized Estimating Equations and Model Selection
</h2><span id='topic+wgeesel-package'></span><span id='topic+wgeesel'></span>

<h3>Description</h3>

<p>Weighted Generalized estimating equations (WGEE) is an extension of generalized linear models to longitudinal or clustered data by incorporating the correlation within-cluster when data is missing at random (MAR). The parameters in mean, scale, correlation structures are estimate based on quasi-likelihood. The package <span class="pkg">wgeesel</span> also contains model selection criteria for variable selection in the mean model and for the selection of a working correlation structure in longitudinal data with dropout or monotone missingness using WGEE.
</p>


<h3>Details</h3>

<p>The collection of functions includes:
</p>

<dl>
<dt><code><a href="#topic+wgee">wgee</a></code></dt><dd><p>estimates parameters based on WGEE in
mean, scale, and correlation structures, through mean link, scale link, and correlation link.</p>
</dd>
<dt><code><a href="#topic+QIC.gee">QIC.gee</a></code>, <code><a href="#topic+MQIC.gee">MQIC.gee</a></code>, <code><a href="#topic+RJ.gee">RJ.gee</a></code></dt><dd><p>calculate the QIC (QIC<code class="reqn">_{u}</code>), MQIC (MQIC<code class="reqn">_{u}</code>), Rotnitzky-Jewell criteria for variable selection in the mean model and/or selection of a working correlation structure in GEE (unbalanced data is allowed).</p>
</dd>
<dt><code><a href="#topic+MLIC.gee">MLIC.gee</a></code>, <code><a href="#topic+QICW.gee">QICW.gee</a></code></dt><dd><p>calculate the MLIC (MLICC) and QICW<code class="reqn">_{r}</code> (QICW<code class="reqn">_{p}</code>) for variable selection in the mean model and the selection of a working correlation structure in WGEE, which can accommodate dropout missing at random (MAR).</p>
</dd> 
<dt><code><a href="#topic+data_sim">data_sim</a></code></dt><dd><p>can simulate longitudinal response data in different distribution (gaussian, binomial, poisson) with drop missingness.</p>
</dd>
</dl>

<p>For a complete list of functions, use <code>library(help = "wgeesel")</code>.
</p>


<h3>Author(s)</h3>

<p>Cong Xu <a href="mailto:congxu17@gmail.com">congxu17@gmail.com</a>, 
Zheng Li <a href="mailto:zheng.li@outlook.com">zheng.li@outlook.com</a>, 
Ming Wang <a href="mailto:mwang@phs.psu.edu">mwang@phs.psu.edu</a>
</p>
<p>Maintainer:
Zheng Li <a href="mailto:zheng.li@outlook.com">zheng.li@outlook.com</a>
</p>


<h3>References</h3>

<p>Liang, K.Y. and Zeger, S.L., 1986. Longitudinal data analysis using generalized linear models. <em>Biometrika</em>, pp.13-22.
</p>
<p>Preisser, J.S., Lohman, K.K. and Rathouz, P.J., 2002. Performance of weighted estimating equations for longitudinal binary data with drop-outs missing at random. <em>Statistics in medicine</em>, 21(20), pp.3035-3054.
</p>
<p>Robins, J.M., Rotnitzky, A. and Zhao, L.P., 1995. Analysis of semiparametric regression models for repeated outcomes in the presence of missing data. <em>Journal of the American Statistical Association</em>, 90(429), pp.106-121.
</p>
<p>Shen, C. W., &amp; Chen, Y. H. (2012). Model selection for generalized estimating equations accommodating dropout missingness. <em>Biometrics</em>, 68(4), 1046-1054.
</p>
<p>Wang, M., 2014. Generalized Estimating Equations in Longitudinal Data Analysis: A Review and Recent Developments. <em>Advances in Statistics</em>, 2014.
</p>


<h3>See Also</h3>

<p>GEE methods exist for <code><a href="geepack.html#topic+geeglm">geeglm</a></code> (<span class="pkg">geepack</span>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(imps)

fit &lt;- wgee(Y ~ Drug+Sex+Time,data=imps,id=imps$ID,family="binomial",
            corstr="exchangeable",scale=NULL,mismodel= R ~ Drug+Time)

</code></pre>

<hr>
<h2 id='WRsquare.gee'>
Weighted R Square for WGEE
</h2><span id='topic+WRsquare.gee'></span>

<h3>Description</h3>

<p>Calculate the weighted <code class="reqn">R^2</code> (missing longitudinal information criterion) for selection of mean model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WRsquare.gee(object, weight_mean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WRsquare.gee_+3A_object">object</code></td>
<td>
<p>a fitted model object of class <code>"wgee"</code>.</p>
</td></tr>
<tr><td><code id="WRsquare.gee_+3A_weight_mean">weight_mean</code></td>
<td>

<p>logical; whether weighted mean of the response should be used for weighted R square.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list of weighted R square.
</p>


<h3>Author(s)</h3>

<p>Zheng Li, Cong Xu and Ming Wang
</p>


<h3>References</h3>

<p>Nelder, J.A. and Baker, R.J., 1972. <em>Generalized linear models</em>. Encyclopedia of statistical sciences.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wgee">wgee</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(imps)

fit &lt;- wgee(Y ~ Drug+Sex+Time, data=imps, id=imps$ID, family="binomial",
            corstr="exchangeable",scale=NULL,mismodel= R ~ Drug+Time)
WRsquare.gee(fit, weight_mean=TRUE)
</code></pre>

<hr>
<h2 id='ylag'>
Generate subject-level lagged response
</h2><span id='topic+ylag'></span>

<h3>Description</h3>

<p>Suppose you have longitudinal response y and it's subject id. This function generates lagged y for each subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ylag(id,y,lag,na=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ylag_+3A_id">id</code></td>
<td>

<p>subject id
</p>
</td></tr>
<tr><td><code id="ylag_+3A_y">y</code></td>
<td>

<p>response
</p>
</td></tr>
<tr><td><code id="ylag_+3A_lag">lag</code></td>
<td>

<p>how many lags for y
</p>
</td></tr>
<tr><td><code id="ylag_+3A_na">na</code></td>
<td>

<p>logical; whether remain NAs in the response when lag <code class="reqn">&gt;1</code>. Default to FALSE and output 0s instead of NAs.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a vector of lagged y
</p>


<h3>Author(s)</h3>

<p>Cong Xu, Zheng Li and Ming Wang
</p>


<h3>Examples</h3>

<pre><code class='language-R'>id &lt;- rep(c(1:20),each=3)
y &lt;- rnorm(length(id))
ylag(id,y,1) #lag=1
ylag(id,y,2,na=FALSE) #lag=2
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
