<!DOCTYPE html><html><head><title>Help for package FHDI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FHDI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FHDI-package'><p>Fractional Hot Deck Imputation</p></a></li>
<li><a href='#FHDI_CellMake'><p>Imputation Cell Creation</p></a></li>
<li><a href='#FHDI_CellProb'><p>Joint Cell Probabilities for Incomplete Categorical Data</p></a></li>
<li><a href='#FHDI_Driver'><p>Main Driver of Fractional Hot Deck Imputation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-08-21</td>
</tr>
<tr>
<td>Title:</td>
<td>Fractional Hot Deck and Fully Efficient Fractional Imputation</td>
</tr>
<tr>
<td>Author:</td>
<td>Inho Cho [aut, cre],
  Jaekwang Kim [aut],
  Jongho Im [aut],
  Yicheng Yang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Inho Cho &lt;icho@iastate.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Impute general multivariate missing data with the fractional hot deck imputation based on Jaekwang Kim (2011) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2Fasq073">doi:10.1093/biomet/asq073</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a>,
<a href="https://sites.google.com/view/jaekwangkim/software">https://sites.google.com/view/jaekwangkim/software</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://sites.google.com/site/ichoddcse2017/home/type-of-trainings/r-package-fhdi">https://sites.google.com/site/ichoddcse2017/home/type-of-trainings/r-package-fhdi</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-21 19:54:01 UTC; ihcho_000</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-22 06:30:30 UTC</td>
</tr>
</table>
<hr>
<h2 id='FHDI-package'>Fractional Hot Deck Imputation</h2><span id='topic+FHDI-package'></span><span id='topic+FHDI'></span>

<h3>Description</h3>

<p>Perform fractional hot deck imputation or perform fully efficient fractional imputation. This package is partially supported by the NSF grant CSSI 1931380.</p>


<h3>Details</h3>

<p>FHDI_Driver(daty, datr=NULL, datz=NULL, s_op_imputation=&quot;FEFI&quot;, i_op_SIS=0, 
s_op_SIS=&quot;global&quot;, s_op_cellmake=&quot;knn&quot;, top_corr_var=100, i_op_variance=1, M=5, k=5, w=NULL, id=NULL, 
s_op_merge=&quot;fixed&quot;, categorical=NULL)
</p>


<h3>Author(s)</h3>

<p>Author: Inho Cho [aut, cre], Jaekwang Kim [aut], Jongho Im [aut], Yicheng Yang [aut]
<a href="mailto:icho@iastate.edu">icho@iastate.edu</a></p>


<h3>References</h3>

<p>Im, J., Cho, I.H. and Kim, J.K. (2018). FHDI: An <b>R</b> Package for Fractional Hot-Deck Imputation. <em>The R Journal</em>. 10(1), pp. 140-154; 
Im, J., Kim, J.K. and Fuller, W.A. (2015). Two-phase sampling approach to fractional hot deck imputation, <em>Proceeding of the Survey Research Methods Section</em>, Americal Statistical Association, Seattle, WA. 
</p>


<h3>See Also</h3>

<p>FHDI_CellMake and FHDI_CellProb</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Toy Example ### 
# y : multi-variate vector
# r : indicator corresponding to missingness in y

set.seed(1345) 
n=100 
rho=0.5 
e1=rnorm(n,0,1) 
e2=rnorm(n,0,1) 
e3=rgamma(n,1,1) 
e4=rnorm(n,0,sd=sqrt(3/2))

y1=1+e1 
y2=2+rho*e1+sqrt(1-rho^2)*e2 
y3=y1+e3 
y4=-1+0.5*y3+e4

r1=rbinom(n,1,prob=0.6) 
r2=rbinom(n,1,prob=0.7) 
r3=rbinom(n,1,prob=0.8) 
r4=rbinom(n,1,prob=0.9)

y1[r1==0]=NA 
y2[r2==0]=NA 
y3[r3==0]=NA 
y4[r4==0]=NA

daty=cbind(y1,y2,y3,y4)

result_FEFI=FHDI_Driver(daty, s_op_imputation="FEFI", k=3)
result_FHDI=FHDI_Driver(daty, s_op_imputation="FHDI", M=5, k=3)
result_FHDI_merging=FHDI_Driver(daty, s_op_imputation="FHDI", s_op_cellmake="merging", M=5, k=3)
FEFI_SIS=FHDI_Driver(daty, i_op_SIS=2, s_op_SIS="intersection", k=3)

names(result_FEFI)
names(result_FHDI)
names(result_FHDI_merging)
names(FEFI_SIS)
</code></pre>

<hr>
<h2 id='FHDI_CellMake'>Imputation Cell Creation</h2><span id='topic+FHDI_CellMake'></span>

<h3>Description</h3>

<p>Perform a categorization procedure on the continuous raw data and then create imputation cells through a built-in merge algorithm. This package is partially supported by the NSF grant CSSI 1931380.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FHDI_CellMake(daty, datr=NULL, k=5, w=NULL, id=NULL, i_op_SIS=0, 
              s_op_SIS="global", s_op_cellmake="knn", top_corr_var=100, 
              s_op_merge="fixed", categorical=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FHDI_CellMake_+3A_daty">daty</code></td>
<td>
<p>raw data matrix (nrow_y, ncol_y) containing missing values. Each row must have at least one observed value, and no completely missing (blank) rows are allowed.</p>
</td></tr>
<tr><td><code id="FHDI_CellMake_+3A_datr">datr</code></td>
<td>
<p>response indicator matrix with the same dimensions as daty. Each response is recorded with 0 for missing value and 1 for observed value. If NULL, automatically filled with 1 or 0 according to daty.</p>
</td></tr> 
<tr><td><code id="FHDI_CellMake_+3A_k">k</code></td>
<td>
<p>the number of total categories per variable. Default = 5. The maximum is 35 since 9 integers (1-9) and 26 alphabet letters (a-z) are used. When a scalar value is given, all variables will have the same number of categories, while when a vector is given, i.e., k(ncol_y), each variable may have a different number of categories.</p>
</td></tr>
<tr><td><code id="FHDI_CellMake_+3A_w">w</code></td>
<td>
<p>sampling weight for each row of daty. Default = 1.0 if NULL. When a scalar value is given, all rows will have the same weight, while when a vector is given, i.e., w(nrow_y), each row may have a different sampling weight.</p>
</td></tr>
<tr><td><code id="FHDI_CellMake_+3A_id">id</code></td>
<td>
<p>index for each row. Default = 1:nrow_y if NULL.</p>
</td></tr>
<tr><td><code id="FHDI_CellMake_+3A_i_op_sis">i_op_SIS</code></td>
<td>
<p>(FHDI Version &gt;= 1.4) the desired number of reduced variables after the sure independence screening per each missing pattern. Default = 0 means no variable reduction and uses all variables. Range must be &lt;= ncol_y.</p>
</td></tr>  
<tr><td><code id="FHDI_CellMake_+3A_s_op_sis">s_op_SIS</code></td>
<td>
<p>(FHDI Version &gt;= 1.4) &quot;intersection&quot; for sure independence screening with an intersection of simple correlation, &quot;union&quot; for sure independence screening with a union of simple correlation, or default = &quot;global&quot; for sure independence screening with a global ranking of simple correlation.</p>
</td></tr>
<tr><td><code id="FHDI_CellMake_+3A_s_op_cellmake">s_op_cellmake</code></td>
<td>
<p>(FHDI Version &gt;= 1.4) option for different methods of cell construction with deficient donors. &quot;merging&quot; for adopting cell collapsing and merging or default = &quot;knn&quot; for adopting the k-nearest neighbors in terms of the Euclidean distance.</p>
</td></tr>
<tr><td><code id="FHDI_CellMake_+3A_top_corr_var">top_corr_var</code></td>
<td>
<p>(FHDI Version &gt;= 1.4) the number of top-ranking variables based on simple correlation with default 100.</p>
</td></tr>
<tr><td><code id="FHDI_CellMake_+3A_s_op_merge">s_op_merge</code></td>
<td>
<p>option for random cell make. Default = &quot;fixed&quot; using the same seed number; &quot;rand&quot; using a purely random seed number.</p>
</td></tr>
<tr><td><code id="FHDI_CellMake_+3A_categorical">categorical</code></td>
<td>
<p>(FHDI Version &gt;1.3) index vector indicating non-collapsible categorical variables. Default = zero vector of size ncol_y. For instance, when categorical=c(1,0), the first variable (i.e., 1st column) is considered strictly to be non-collapsible and categorical, thus no automatic cell-collapse will take place while the second variable (i.e., 2nd column) is considered as a continuous or collapsible categorical variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates imputation cells with the given number of categories k. 
If the input value k is given a scalar, the same number of categories is applied to all variables for initial discretization. 
Imputation cells are created to assign at least two donors on each missing unit. 
The donors have the same cell values with the observed parts of the missing unit. 
From version &gt;= 1.4, the sure independence screening method (Fan and Lv 2008) has been incorporated to perform variable reduction for each missing pattern, which is useful for high dimensional (i.e., big-p) datasets. 
Besides, we provide an alternative method using k-nearest neighbors to speed up the convergence of cell construction with deficient donors, which is useful for big-p datasets.
</p>


<h3>Value</h3>

<table>
<tr><td><code>data</code></td>
<td>
<p>matrix of raw data (nrow_y, ncol_y) attached with id and weights, w.</p>
</td></tr>
<tr><td><code>cell</code></td>
<td>
<p>categorized matrix of y. A real value is categorized into 1~k categories with 0 meaning missing value.</p>
</td></tr>
<tr><td><code>cell.resp</code></td>
<td>
<p>unique patterns of respondents (donors) that are fully observed.</p>
</td></tr>
<tr><td><code>cell.non.resp</code></td>
<td>
<p>unique patterns of nonrespondents that have at least one missing item.</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>reprint of the sampling weights &quot;w&quot; initially defined by the user.</p>
</td></tr>
<tr><td><code>s_op_merge</code></td>
<td>
<p>reprint of the option &quot;s_op_merge&quot; initially defined by the user.</p>
</td></tr>  
<tr><td><code>i_op_SIS</code></td>
<td>
<p>reprint of the option &quot;i_op_SIS&quot; initially defined by the user.</p>
</td></tr>
<tr><td><code>s_op_SIS</code></td>
<td>
<p>reprint of the option &quot;s_op_SIS&quot; initially defined by the user.</p>
</td></tr>
<tr><td><code>s_op_cellmake</code></td>
<td>
<p>reprint of the option &quot;s_op_cellmake&quot; initially defined by the user.</p>
</td></tr>
<tr><td><code>top_corr_var</code></td>
<td>
<p>reprint of the option &quot;top_corr_var&quot; initially defined by the user.</p>
</td></tr>
<tr><td><code>cell.selected</code></td>
<td>
<p>list of selected variables for each unique pattern of nonrespondents that have at least one missing item. Note that all the observed variables of a unique missing pattern will be selected if i_op_SIS is greater than the number of observed variables of the unique missing pattern; otherwise, the deficient selected variables are replaced by 0s.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Cho, In Ho (maintainer)
<a href="mailto:icho@iastate.edu">icho@iastate.edu</a>
Dr. Kim, Jae Kwang
<a href="mailto:jkim@iastate.edu">jkim@iastate.edu</a>
Dr. Im, Jong Ho
<a href="mailto:ijh38@yonsei.ac.kr">ijh38@yonsei.ac.kr</a>
Yicheng Yang, Graduate Research Assistant
</p>


<h3>References</h3>

<p>Im, J., Cho, I.H. and Kim, J.K. (2018). FHDI: An <b>R</b> Package for Fractional Hot-Deck Imputation. <em>The R Journal</em>. 10(1), pp. 140-154; 
Im, J., Kim, J.K. and Fuller, W.A. (2015). Two-phase sampling approach to fractional hot deck imputation, <em>Proceeding of the Survey Research Methods Section</em>, Americal Statistical Association, Seattle, WA. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Toy Example ### 
# y : multi-variate vector
# r : indicator corresponding to missingness in y

set.seed(1345) 
n=100 
rho=0.5 
e1=rnorm(n,0,1) 
e2=rnorm(n,0,1) 
e3=rgamma(n,1,1) 
e4=rnorm(n,0,sd=sqrt(3/2))

y1=1+e1 
y2=2+rho*e1+sqrt(1-rho^2)*e2 
y3=y1+e3 
y4=-1+0.5*y3+e4

r1=rbinom(n,1,prob=0.6) 
r2=rbinom(n,1,prob=0.7) 
r3=rbinom(n,1,prob=0.8) 
r4=rbinom(n,1,prob=0.9)

y1[r1==0]=NA 
y2[r2==0]=NA 
y3[r3==0]=NA 
y4[r4==0]=NA

daty=cbind(y1,y2,y3,y4)

result_CM=FHDI_CellMake(daty, k=3, s_op_merge="fixed")
result_CM_merging=FHDI_CellMake(daty, k=3, s_op_cellmake ="merging", s_op_merge="fixed")
result_CM_reduced=FHDI_CellMake(daty, k=3, i_op_SIS=2, s_op_SIS="intersection", s_op_merge="fixed")
names(result_CM)
names(result_CM_merging)
names(result_CM_reduced)
</code></pre>

<hr>
<h2 id='FHDI_CellProb'>Joint Cell Probabilities for Incomplete Categorical Data</h2><span id='topic+FHDI_CellProb'></span>

<h3>Description</h3>

<p>Calculate the joint cell probabilities for multivariate missing data using the expectation-maximization (EM) algorithm. This package is partially supported by the NSF grant CSSI 1931380.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FHDI_CellProb(datz, w=NULL, id=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FHDI_CellProb_+3A_datz">datz</code></td>
<td>
<p>multivariate incomplete categorical data prepared by cell collapsing and merging algorithm.</p>
</td></tr>
<tr><td><code id="FHDI_CellProb_+3A_w">w</code></td>
<td>
<p>samping weight. Default = 1.0 if NULL. a scalar or w(nrow_y).</p>
</td></tr>
<tr><td><code id="FHDI_CellProb_+3A_id">id</code></td>
<td>
<p>index for each unit. Default = 1:nrow_y if NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The joint cell probabilities are estimated using EM by weighting method. The algorithm computes the maximum likelihood estimates 
of the joint cell probabilities under missing at random assumption. 
Note that the variable reduction (ver. &gt;= 1.4) with sure independence screening method is not applicable to a separate CellProb task. 
The input incomplete categorical data should be generated by cell make with the cell collapsing and merging algorithm.</p>


<h3>Value</h3>

<table>
<tr><td><code>cellpr</code></td>
<td>
<p>table of the joint cell probability. The name of a cell is linked to the user-defined categories in &quot;k&quot;: e.g., name &quot;325&quot; denotes 3rd, 2nd, 5th categories for three variables, respectively, whereas &quot;a1c&quot; denotes 10th, 1st, 12th categories.</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>reprint of the sampling weights &quot;w&quot; initially defined by the user.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Cho, In Ho (maintainer)
<a href="mailto:icho@iastate.edu">icho@iastate.edu</a>
Dr. Kim, Jae Kwang
<a href="mailto:jkim@iastate.edu">jkim@iastate.edu</a>
Dr. Im, Jong Ho
<a href="mailto:ijh38@yonsei.ac.kr">ijh38@yonsei.ac.kr</a>
Yicheng Yang, Graduate Research Assistant
</p>


<h3>References</h3>

<p>Im, J., Cho, I.H. and Kim, J.K. (2018). FHDI: An <b>R</b> Package for Fractional Hot-Deck Imputation. <em>The R Journal</em>. 10(1), pp. 140-154; 
Im, J., Kim, J.K. and Fuller, W.A. (2015). Two-phase sampling approach to fractional hot deck imputation, <em>Proceeding of the Survey Research Methods Section</em>, Americal Statistical Association, Seattle, WA.;  
Ibrahim, J.G. (1990). Incomplete data in generalized linear models. <em>Journal of the American Statistical Assocation</em> <b>85</b>, 765-769. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Toy Example ### 
# y : trivariate variables
# r : indicator corresponding to missingness in y

set.seed(1345) 
n=100 
rho=0.5 
e1=rnorm(n,0,1) 
e2=rnorm(n,0,1) 
e3=rgamma(n,1,1) 
e4=rnorm(n,0,sd=sqrt(3/2))

y1=1+e1 
y2=2+rho*e1+sqrt(1-rho^2)*e2 
y3=y1+e3 
y4=-1+0.5*y3+e4

r1=rbinom(n,1,prob=0.6) 
r2=rbinom(n,1,prob=0.7) 
r3=rbinom(n,1,prob=0.8) 
r4=rbinom(n,1,prob=0.9)

y1[r1==0]=NA 
y2[r2==0]=NA 
y3[r3==0]=NA 
y4[r4==0]=NA

daty=cbind(y1,y2,y3,y4)

result_CM=FHDI_CellMake(daty, k=5, s_op_cellmake="merging", s_op_merge="fixed")
datz=result_CM$cell
result_CP=FHDI_CellProb(datz)
names(result_CP)
</code></pre>

<hr>
<h2 id='FHDI_Driver'>Main Driver of Fractional Hot Deck Imputation</h2><span id='topic+FHDI_Driver'></span>

<h3>Description</h3>

<p>Fully efficient fractional imputation (FEFI) or fractional hot deck imputation (FHDI) is implemented to fill in missing values in incomplete data. This package is partially supported by the NSF grant CSSI 1931380.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FHDI_Driver(daty, datr=NULL, datz=NULL, s_op_imputation="FEFI", 
 i_op_SIS=0, s_op_SIS="global", s_op_cellmake="knn", top_corr_var=100, 
 i_op_variance=1, M=5, k=5, w=NULL, id=NULL, 
 s_op_merge="fixed", categorical=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FHDI_Driver_+3A_daty">daty</code></td>
<td>
<p>raw data matrix (nrow_y, ncol_y) containing missing values. Each row must have at least one observed value, and no completely missing (blank) rows are allowed.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_datr">datr</code></td>
<td>
<p>response indicator matrix with the same dimensions as daty. Each response is recorded with 0 for missing value and 1 for observed value. If NULL, automatically filled with 1 or 0 according to daty.</p>
</td></tr> 
<tr><td><code id="FHDI_Driver_+3A_datz">datz</code></td>
<td>
<p>imputation cell matrix. If daty is a set of continuous data, datz can be obtained using <code><a href="#topic+FHDI_CellMake">FHDI_CellMake</a>.</code></p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_s_op_imputation">s_op_imputation</code></td>
<td>
<p>&quot;FEFI&quot; for fully efficient fractional imputation or &quot;FHDI&quot; for fractional hot deck imputation.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_i_op_sis">i_op_SIS</code></td>
<td>
<p>(FHDI Version &gt;= 1.4) the desired number of reduced variables after the sure independence screening per each missing pattern. Default = 0 means no variable reduction and uses all variables. Range must be &lt;= ncol_y.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_s_op_sis">s_op_SIS</code></td>
<td>
<p>(FHDI Version &gt;= 1.4) &quot;intersection&quot; for sure independence screening with an intersection of simple correlation, &quot;union&quot; for sure independence screening with a union of simple correlation, or default = &quot;global&quot; for sure independence screening with a global ranking of simple correlation.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_s_op_cellmake">s_op_cellmake</code></td>
<td>
<p>(FHDI Version &gt;= 1.4) option for different methods of cell construction with deficient donors. &quot;merging&quot; for adopting cell collapsing and merging or default = &quot;knn&quot; for adopting the k-nearest neighbors in terms of the Euclidean distance.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_top_corr_var">top_corr_var</code></td>
<td>
<p>(FHDI Version &gt;= 1.4) the number of top-ranking variables based on simple correlation with default 100.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_i_op_variance">i_op_variance</code></td>
<td>
<p>1: perform Jackknife variance estimation; 0: no variance estimation.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_m">M</code></td>
<td>
<p>the number of donors for FHDI with default 5.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_k">k</code></td>
<td>
<p>the number of total categories per variable. Default = 5. The maximum is 35 since 9 integers (1-9) and 26 alphabet letters (a-z) are used. When a scalar value is given, all variables will have the same number of categories, while when a vector is given, i.e., k(ncol_y), each variable may have a different number of categories.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_w">w</code></td>
<td>
<p>sampling weight for each row of daty. Default = 1.0 if NULL. When a scalar value is given, all rows will have the same weight, while when a vector is given, i.e., w(nrow_y), each row may have a different sampling weight.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_id">id</code></td>
<td>
<p>index for each row. Default = 1:nrow_y if NULL.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_s_op_merge">s_op_merge</code></td>
<td>
<p>option for random cell make. Default = &quot;fixed&quot; using the same seed number; &quot;rand&quot; using a purely random seed number.</p>
</td></tr>
<tr><td><code id="FHDI_Driver_+3A_categorical">categorical</code></td>
<td>
<p>(FHDI Version &gt;1.3) index vector indicating non-collapsible categorical variables. Default = zero vector of size ncol_y. For instance, when categorical=c(1,0), the first variable (i.e., 1st column) is considered strictly to be non-collapsible and categorical, thus no automatic cell-collapse will take place while the second variable (i.e., 2nd column) is considered as a continuous or collapsible categorical variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the FEFI method, all possible donors are assigned to each missing unit with the FEFI fractional weights. In the FHDI method, 
M (&gt;1) donors are selected with the probability proportional to the FEFI fractional weights. Thus, the imputed values have equal 
fractional weights in general.
</p>
<p>The jackknife replicated weights are produced as the default output. The replicated weights are presented by the 
product of replicated sampling weights and replicated fractional weights. Thus, the replicated weights can be directly used 
to compute the variance estimate of the estimators. 
From version &gt;= 1.4, the sure independence screening method (Fan and Lv 2008) has been incorporated to perform variable reduction for each missing pattern, which is useful for high dimensional (i.e., big-p) datasets. 
Besides, we provide an alternative method using k-nearest neighbors to speed up the convergence of cell construction with deficient donors, which is useful for big-p datasets.
</p>


<h3>Value</h3>

<table>
<tr><td><code>fimp.data</code></td>
<td>
<p>imputation results with fractional weights in the form of a matrix consisting of ID, donor id (FID), weight (WGT), fractional weight (FWGT), and fractionally imputed data.</p>
</td></tr>
<tr><td><code>simp.data</code></td>
<td>
<p>imputed data in the format of single imputation. The same shape as daty.</p>
</td></tr>
<tr><td><code>imp.mean</code></td>
<td>
<p>the mean estimates of each variable (first row) and the estimated standard error of each variable (second row). If input argument &quot;i_op_variance=0&quot; then this output is not produced.</p>
</td></tr>
<tr><td><code>rep.weight</code></td>
<td>
<p>replication fractional weights for variance estimation. If input argument &quot;i_op_variance=0&quot; then this output is not produced.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>reprint of the number of donors M for FHDI defined by the user.</p>
</td></tr>
<tr><td><code>s_op_imputation</code></td>
<td>
<p>reprint of the option &quot;s_op_imputation&quot; initially defined by the user.</p>
</td></tr>  
<tr><td><code>i_op_merge</code></td>
<td>
<p>reprint of the option &quot;i_op_merge&quot; initially defined by the user.</p>
</td></tr>  
<tr><td><code>i_op_SIS</code></td>
<td>
<p>reprint of the option &quot;i_op_SIS&quot; initially defined by the user.</p>
</td></tr>
<tr><td><code>s_op_SIS</code></td>
<td>
<p>reprint of the option &quot;s_op_SIS&quot; initially defined by the user.</p>
</td></tr>
<tr><td><code>s_op_cellmake</code></td>
<td>
<p>reprint of the option &quot;s_op_cellmake&quot; initially defined by the user.</p>
</td></tr>
<tr><td><code>top_corr_var</code></td>
<td>
<p>reprint of the option &quot;top_corr_var&quot; initially defined by the user.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Cho, In Ho (maintainer)
<a href="mailto:icho@iastate.edu">icho@iastate.edu</a>
Dr. Kim, Jae Kwang
<a href="mailto:jkim@iastate.edu">jkim@iastate.edu</a>
Dr. Im, Jong Ho
<a href="mailto:ijh38@yonsei.ac.kr">ijh38@yonsei.ac.kr</a>
Yicheng Yang, Graduate Research Assistant
</p>


<h3>References</h3>

<p>Im, J., Cho, I.H. and Kim, J.K. (2018). FHDI: An <b>R</b> Package for Fractional Hot-Deck Imputation. <em>The R Journal</em>. 10(1), pp. 140-154; 
Im, J., Kim, J.K. and Fuller, W.A. (2015). Two-phase sampling approach to fractional hot deck imputation, <em>Proceeding of the Survey Research Methods Section</em>, Americal Statistical Association, Seattle, WA. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Toy Example ### 
# y : multi-variate vector
# r : indicator corresponding to missingness in y

set.seed(1345) 
n=100 
rho=0.5 
e1=rnorm(n,0,1) 
e2=rnorm(n,0,1) 
e3=rgamma(n,1,1) 
e4=rnorm(n,0,sd=sqrt(3/2))

y1=1+e1 
y2=2+rho*e1+sqrt(1-rho^2)*e2 
y3=y1+e3 
y4=-1+0.5*y3+e4

r1=rbinom(n,1,prob=0.6) 
r2=rbinom(n,1,prob=0.7) 
r3=rbinom(n,1,prob=0.8) 
r4=rbinom(n,1,prob=0.9)

y1[r1==0]=NA 
y2[r2==0]=NA 
y3[r3==0]=NA 
y4[r4==0]=NA

daty=cbind(y1,y2,y3,y4)

result_FEFI=FHDI_Driver(daty, s_op_imputation="FEFI", k=3)
result_FHDI=FHDI_Driver(daty, s_op_imputation="FHDI", M=5, k=3)
result_FHDI_merging=FHDI_Driver(daty, s_op_imputation="FHDI", s_op_cellmake="merging", M=5, k=3)
FEFI_SIS=FHDI_Driver(daty, i_op_SIS=2, s_op_SIS="intersection", k=3)

names(result_FEFI)
names(result_FHDI)
names(result_FHDI_merging)
names(FEFI_SIS)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
