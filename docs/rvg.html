<!DOCTYPE html><html lang="en"><head><title>Help for package rvg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rvg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#body_add_vg'><p>Defunct Functions in Package rvg</p></a></li>
<li><a href='#dml'><p>Wrap plot instructions for DrawingML plotting in Powerpoint</p></a></li>
<li><a href='#dml_pptx'><p>DrawingML graphic device for Microsoft PowerPoint</p></a></li>
<li><a href='#dml_xlsx'><p>DrawingML graphic device for Microsoft Excel</p></a></li>
<li><a href='#ph_with.dml'><p>add a plot output as vector graphics into a PowerPoint object</p></a></li>
<li><a href='#xl_add_vg'><p>add a plot output as vector graphics into an Excel object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>R Graphics Devices for 'Office' Vector Graphics Output</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Vector Graphics devices for 'Microsoft PowerPoint' and 
 'Microsoft Excel'. Functions extending package 'officer' are provided to 
 embed 'DrawingML' graphics into 'Microsoft PowerPoint' presentations and 
 'Microsoft Excel' workbooks.</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>libpng</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, Rcpp (&ge; 0.12.12), officer (&ge; 0.6.2), gdtools (&ge;
0.3.3), xml2 (&ge; 1.0.0), rlang</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, gdtools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, grid</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ardata-fr.github.io/officeverse/">https://ardata-fr.github.io/officeverse/</a>,
<a href="https://davidgohel.github.io/rvg/">https://davidgohel.github.io/rvg/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/davidgohel/rvg/issues">https://github.com/davidgohel/rvg/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-27 07:29:13 UTC; davidgohel</td>
</tr>
<tr>
<td>Author:</td>
<td>David Gohel [aut, cre],
  ArData [cph],
  Bob Rudis [ctb] (the javascript code used by function set_attr),
  Francois Brunetti [ctb] (clipping algorithms)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Gohel &lt;david.gohel@ardata.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-27 15:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='body_add_vg'>Defunct Functions in Package rvg</h2><span id='topic+body_add_vg'></span>

<h3>Description</h3>

<p>Defunct Functions in Package rvg
</p>


<h3>Usage</h3>

<pre><code class='language-R'>body_add_vg(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="body_add_vg_+3A_...">...</code></td>
<td>
<p>unused argument</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>body_add_vg()</code> is removed and can be replaced by <code>officer::body_add_img</code>.
</p>

<hr>
<h2 id='dml'>Wrap plot instructions for DrawingML plotting in Powerpoint</h2><span id='topic+dml'></span>

<h3>Description</h3>

<p>A simple wrapper to mark
the plot instructions as Vector Graphics instructions. It produces
an object of class 'dml' with a corresponding method <code><a href="officer.html#topic+ph_with">ph_with</a></code>.
</p>
<p>The function enable usage of any R plot with argument <code>code</code> and with
ggplot objects with argument <code>ggobj</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dml(
  code,
  ggobj = NULL,
  bg = "white",
  fonts = list(),
  pointsize = 12,
  editable = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dml_+3A_code">code</code></td>
<td>
<p>plotting instructions</p>
</td></tr>
<tr><td><code id="dml_+3A_ggobj">ggobj</code></td>
<td>
<p>ggplot object to print. argument code will be ignored if this
argument is supplied.</p>
</td></tr>
<tr><td><code id="dml_+3A_bg">bg</code>, <code id="dml_+3A_fonts">fonts</code>, <code id="dml_+3A_pointsize">pointsize</code>, <code id="dml_+3A_editable">editable</code></td>
<td>
<p>Parameters passed to <code><a href="#topic+dml_pptx">dml_pptx</a></code></p>
</td></tr>
<tr><td><code id="dml_+3A_...">...</code></td>
<td>
<p>unused arguments</p>
</td></tr>
</table>


<h3>background color</h3>

<p>When dealing with a ggplot object argument <code>bg</code> will have no effect
because ggplot theme is specifying background color, don't forget
to define the colors you want in the theme:
</p>
<div class="sourceCode"><pre>theme(
  panel.background = element_rect(fill = "#EFEFEF"),
  plot.background = element_rect(fill = "wheat"))
</pre></div>


<h3>See Also</h3>

<p><code><a href="#topic+ph_with.dml">ph_with.dml</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>anyplot &lt;- dml(code = barplot(1:5, col = 2:6), bg = "wheat")

library(officer)
doc &lt;- read_pptx()
doc &lt;- add_slide(doc, "Title and Content", "Office Theme")
doc &lt;- ph_with(doc, anyplot, location = ph_location_fullsize())
fileout &lt;- tempfile(fileext = ".pptx")
# fileout &lt;- "vg.pptx"
print(doc, target = fileout)
</code></pre>

<hr>
<h2 id='dml_pptx'>DrawingML graphic device for Microsoft PowerPoint</h2><span id='topic+dml_pptx'></span>

<h3>Description</h3>

<p>Graphics devices for Microsoft PowerPoint DrawingML format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dml_pptx(
  file = "Rplots.dml",
  width = 6,
  height = 6,
  offx = 1,
  offy = 1,
  bg = "white",
  fonts = list(),
  pointsize = 12,
  editable = TRUE,
  id = 1L,
  last_rel_id = 1L,
  raster_prefix = "raster_",
  standalone = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dml_pptx_+3A_file">file</code></td>
<td>
<p>the file where output will appear.</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_height">height</code>, <code id="dml_pptx_+3A_width">width</code></td>
<td>
<p>Height and width in inches.</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_offx">offx</code>, <code id="dml_pptx_+3A_offy">offy</code></td>
<td>
<p>top and left origin of the plot</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_bg">bg</code></td>
<td>
<p>Default background color for the plot (defaults to &quot;white&quot;).</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_fonts">fonts</code></td>
<td>
<p>Named list of font names to be aliased with
fonts installed on your system. If unspecified, the R default
families <code>sans</code>, <code>serif</code>, <code>mono</code> and <code>symbol</code>
are aliased to the family returned by <code><a href="gdtools.html#topic+match_family">match_family</a>()</code>.
</p>
<p>When you use specific fonts, you will need that font installed on your system.
This can be check with package <code>gdtools</code> and function <code>gdtools::font_family_exists()</code>.
</p>
<p>An example: <code>list(sans = "Roboto", serif = "Times", mono = "Courier")</code>.</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_pointsize">pointsize</code></td>
<td>
<p>default point size.</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_editable">editable</code></td>
<td>
<p>should vector graphics elements (points, text, etc.) be editable.</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_id">id</code></td>
<td>
<p>specifies a unique identifier (integer) within the slide
that will contain the DrawingML instructions.</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_last_rel_id">last_rel_id</code></td>
<td>
<p>specifies the last unique identifier (integer)
within relationship file that will be used to reference embedded
raster images if any.</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_raster_prefix">raster_prefix</code></td>
<td>
<p>string value used as prefix for png
files produced when raster objects are printed on the
graphical device.</p>
</td></tr>
<tr><td><code id="dml_pptx_+3A_standalone">standalone</code></td>
<td>
<p>produce a standalone drawingml file? If <code>FALSE</code>, omits
xml header and namespaces.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+Devices">Devices</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dml_pptx(file = tempfile())
plot(1:11, (-5:5)^2, type = "b", main = "Simple Example")
dev.off()

</code></pre>

<hr>
<h2 id='dml_xlsx'>DrawingML graphic device for Microsoft Excel</h2><span id='topic+dml_xlsx'></span>

<h3>Description</h3>

<p>Graphics devices for Microsoft Excel DrawingML format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dml_xlsx(
  file = "Rplots.dml",
  width = 6,
  height = 6,
  offx = 1,
  offy = 1,
  bg = "white",
  fonts = list(),
  pointsize = 12,
  editable = TRUE,
  id = 1L,
  last_rel_id = 1L,
  raster_prefix = "raster_",
  standalone = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dml_xlsx_+3A_file">file</code></td>
<td>
<p>the file where output will appear.</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_height">height</code>, <code id="dml_xlsx_+3A_width">width</code></td>
<td>
<p>Height and width in inches.</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_offx">offx</code>, <code id="dml_xlsx_+3A_offy">offy</code></td>
<td>
<p>top and left origin of the plot</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_bg">bg</code></td>
<td>
<p>Default background color for the plot (defaults to &quot;white&quot;).</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_fonts">fonts</code></td>
<td>
<p>Named list of font names to be aliased with
fonts installed on your system. If unspecified, the R default
families <code>sans</code>, <code>serif</code>, <code>mono</code> and <code>symbol</code>
are aliased to the family returned by <code><a href="gdtools.html#topic+match_family">match_family</a>()</code>.</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_pointsize">pointsize</code></td>
<td>
<p>default point size.</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_editable">editable</code></td>
<td>
<p>should vector graphics elements (points, text, etc.) be editable.</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_id">id</code></td>
<td>
<p>specifies a unique identifier (integer) within the slide
that will contain the DrawingML instructions.</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_last_rel_id">last_rel_id</code></td>
<td>
<p>specifies the last unique identifier (integer)
within relationship file that will be used to reference embedded
raster images if any.</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_raster_prefix">raster_prefix</code></td>
<td>
<p>string value used as prefix for png
files produced when raster objects are printed on the
graphical device.</p>
</td></tr>
<tr><td><code id="dml_xlsx_+3A_standalone">standalone</code></td>
<td>
<p>produce a standalone drawingml file? If <code>FALSE</code>, omits
xml header and namespaces.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+Devices">Devices</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dml_xlsx(file = tempfile())
plot(1:11, (-5:5)^2, type = "b", main = "Simple Example")
dev.off()

</code></pre>

<hr>
<h2 id='ph_with.dml'>add a plot output as vector graphics into a PowerPoint object</h2><span id='topic+ph_with.dml'></span>

<h3>Description</h3>

<p>produces a vector graphics output from R plot instructions
stored in a <code><a href="#topic+dml">dml</a></code> object and add the result in an <code>rpptx</code>
object produced by <code><a href="officer.html#topic+read_pptx">read_pptx</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dml'
ph_with(x, value, location, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ph_with.dml_+3A_x">x</code></td>
<td>
<p>a pptx device</p>
</td></tr>
<tr><td><code id="ph_with.dml_+3A_value">value</code></td>
<td>
<p><code><a href="#topic+dml">dml</a></code> object</p>
</td></tr>
<tr><td><code id="ph_with.dml_+3A_location">location</code></td>
<td>
<p>a location for a placeholder.</p>
</td></tr>
<tr><td><code id="ph_with.dml_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>anyplot &lt;- dml(code = barplot(1:5, col = 2:6), bg = "wheat")

library(officer)
doc &lt;- read_pptx()
doc &lt;- add_slide(doc, "Title and Content", "Office Theme")
doc &lt;- ph_with(doc, anyplot, location = ph_location_fullsize())

fileout &lt;- tempfile(fileext = ".pptx")
print(doc, target = fileout)
</code></pre>

<hr>
<h2 id='xl_add_vg'>add a plot output as vector graphics into an Excel object</h2><span id='topic+xl_add_vg'></span>

<h3>Description</h3>

<p>produces a vector graphics output from R plot instructions
and add the result in an Excel sheet.
by <code><a href="officer.html#topic+read_xlsx">read_xlsx</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl_add_vg(x, sheet, code, left, top, width, height, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xl_add_vg_+3A_x">x</code></td>
<td>
<p>an <code>rxlsx</code> object produced by <code>officer::read_xlsx</code></p>
</td></tr>
<tr><td><code id="xl_add_vg_+3A_sheet">sheet</code></td>
<td>
<p>sheet label/name</p>
</td></tr>
<tr><td><code id="xl_add_vg_+3A_code">code</code></td>
<td>
<p>plot instructions</p>
</td></tr>
<tr><td><code id="xl_add_vg_+3A_left">left</code>, <code id="xl_add_vg_+3A_top">top</code></td>
<td>
<p>left and top origin of the plot on the slide in inches.</p>
</td></tr>
<tr><td><code id="xl_add_vg_+3A_height">height</code>, <code id="xl_add_vg_+3A_width">width</code></td>
<td>
<p>Height and width in inches.</p>
</td></tr>
<tr><td><code id="xl_add_vg_+3A_...">...</code></td>
<td>
<p>arguments passed on to <code><a href="#topic+dml_xlsx">dml_xlsx</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(officer)
my_ws &lt;- read_xlsx()
my_ws &lt;- xl_add_vg(my_ws,
  sheet = "Feuil1",
  code = barplot(1:5, col = 2:6), width = 6, height = 6, left = 1, top = 2
)
fileout &lt;- tempfile(fileext = ".xlsx")
print(my_ws, target = fileout)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
