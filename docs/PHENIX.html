<!DOCTYPE html><html lang="en"><head><title>Help for package PHENIX</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PHENIX}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PHENIX-package'><p>size-controlled phenotypic integration index</p></a></li>
<li><a href='#cor.par'><p>Partial correlation</p></a></li>
<li><a href='#paeonia'><p>phenotypic integration example dataset #1</p></a></li>
<li><a href='#pint'><p>Phenotypic integration index by Wagner</p></a></li>
<li><a href='#pint.boot'><p>Phenotypic integration (by Wagner) bootstrap intervals</p></a></li>
<li><a href='#pint.jack'><p>Phenotypic integration (by Wagner) jackknife resampling</p></a></li>
<li><a href='#pint.p'><p>Phenotypic integration index (by Wagner) significance test</p></a></li>
<li><a href='#pintsc'><p>size-controlled phenotypic integration</p></a></li>
<li><a href='#pintsc.boot'><p>size-controlled phenotypic integration bootstrap intervals</p></a></li>
<li><a href='#pintsc.jack'><p>size-controlled phenotypic integration jackknife resampling</p></a></li>
<li><a href='#pintsc.p'><p>size-controlled phenotypic integration index significance test</p></a></li>
<li><a href='#tussilago'><p>phenotypic integration example dataset #2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phenotypic Integration Index</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-06-02</td>
</tr>
<tr>
<td>Author:</td>
<td>R. Torices, A. J. Muñoz-Pajares</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>A. J. Muñoz-Pajares &lt;ajesusmp@cibio.up.pt&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>ppcor, SuppDists</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to estimate the size-controlled phenotypic integration index, a novel method by Torices &amp; Méndez (2014) to solve problems due to individual size when estimating integration (namely, larger individuals have larger components, which will drive a correlation between components only due to resource availability that might obscure the observed measures of integration). In addition, the package also provides the classical estimation by Wagner (1984), bootstrapping and jackknife methods to calculate confidence intervals and a significance test for both integration indices.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-06-02 09:41:42 UTC; ajesusmp</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-06-02 13:09:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='PHENIX-package'>size-controlled phenotypic integration index</h2><span id='topic+PHENIX-package'></span>

<h3>Description</h3>

<p>PHENIX estimates a phenotypic integration index taking into account the size of the studied organ. For that, the magnitude of phenotypic integration between a set of traits in a population is quantified by the variance of the eigenvalues of the partial-correlation matrix (Torices &amp; Méndez 2014). This partial-correlation matrix assess the correlation structure between all traits after controlling by the organ size. In addition, PHENIX also computes the integration values based on the correlation matrix between traits (Wagner 1984). Confidence intervals of both indices are calculated by bootstrapping and jackknife and the statistical significance is calculated by simulating a null distribution.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PHENIX</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-1-22</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>R. Torices, A.J. Muñoz-Pajares
</p>
<p>Maintainer: A.J. Muñoz-Pajares to &lt;ajesusmp@cibio.up.pt&gt;
</p>


<h3>References</h3>

<p>R Torices, AJ Muñoz-Pajares (2015). PHENIX: An R package to estimate a size-controlled phenotypic integration index Applications in plant sciences 3 (5) DOI: 10.3732/apps.1400104
</p>

<hr>
<h2 id='cor.par'>Partial correlation</h2><span id='topic+cor.par'></span>

<h3>Description</h3>

<p>This function calculates the partial correlation matrix between a set of traits and a third control variable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor.par(traits, c.trait, trait.names = FALSE, silent=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cor.par_+3A_traits">traits</code></td>
<td>
<p>a dataframe or a matrix object containing traits as columns and individuals as rows</p>
</td></tr>
<tr><td><code id="cor.par_+3A_c.trait">c.trait</code></td>
<td>
<p>a vector containing the third control variable to estimate partial correlations, for instance: organ size or individual size</p>
</td></tr>
<tr><td><code id="cor.par_+3A_trait.names">trait.names</code></td>
<td>
<p>a logical. If 'FALSE' (default), trait names in the output are defined as &quot;Trait 1&quot;, &quot;Trait 2&quot;, ..., &quot;Trait n&quot;. If 'TRUE', output trait names are the same than those in the input dataframe</p>
</td></tr>
<tr><td><code id="cor.par_+3A_silent">silent</code></td>
<td>
<p>a logical. If 'FALSE' (default), return a warning message if any row contains missing data (and is removed from the original dataset before computation). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is utilised internally by <code><a href="#topic+pintsc">pintsc</a></code> and <code><a href="#topic+pintsc.boot">pintsc.boot</a></code> to estimate the phenotypic integration index from partial correlations. Rows containing missing values are removed.</p>


<h3>Value</h3>

<p>A matrix with the pairwise partial correlation between traits.</p>


<h3>Author(s)</h3>

<p>R. Torices, A.J. Muñoz-Pajares</p>


<h3>See Also</h3>

<p><code><a href="ppcor.html#topic+pcor">pcor</a></code>, <code><a href="ppcor.html#topic+pcor.test">pcor.test</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Dataset from Torices &amp; Méndez (2014)
# This data set represents the dry mass (in grams) of inflorescence components of the sunflower
# species Tussilago farfara. The inflorescences were dissected in 'SCAPE', 'RECEPTACLE', 'MALEFL'
# (male flowers), 'OVAR' (reproductive part of female flowers), and 'RAYS' (the petaloid ray of
# female flower). Furthermore in the last column the total weight of the inflorescence is added
# 'TOTALSIZE'

data(tussilago)
print(tussilago)
cor.par(tussilago[,1:5], tussilago[,6], trait.names=TRUE) # NA automatically removed

traits&lt;-na.exclude(tussilago) # NA manually removed
cor.par(traits[,1:5], traits[,6], trait.names=TRUE)
</code></pre>

<hr>
<h2 id='paeonia'>phenotypic integration example dataset #1</h2><span id='topic+paeonia'></span>

<h3>Description</h3>

<p>phenotypic integration example dataset from Méndez &amp; Traveset (2003).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(paeonia)</code></pre>


<h3>Details</h3>

<p>This data set represents the dry mass (in grams) of inflorescence components of the herbaceous perennial plant <em>Paeonia cambessedesii</em>. Variables include mass for 'PETIOLE',	'RECEPTACLE',	'SEPAL', 'LEAF_ACC',	'PETAL',	'STAMEN', and	'CARPEL'. 'LEAF_ACC' represent the dry mass of the accessory leaf (subtending the flower but close to the sepals).	Furthermore the first and last columns include the individual number ('ID') and the total weight of the inflorescence ('TOTAL').</p>


<h3>Author(s)</h3>

<p>M. Méndez, A. Traveset</p>


<h3>References</h3>

<p>Méndez, M. &amp; Traveset, A. 2003. Sexual allocation in single-flowered individuals of a hermaphroditic species in relation to plant and flower size. Oecologia 137:69-75.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(paeonia)
</code></pre>

<hr>
<h2 id='pint'>Phenotypic integration index by Wagner</h2><span id='topic+pint'></span>

<h3>Description</h3>

<p>Estimates phenotypic integration indices based on the variance of the eigenvalues of the correlation matrix between phenotypic traits following Wagner (1984).</p>


<h3>Usage</h3>

<pre><code class='language-R'>pint(traits)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pint_+3A_traits">traits</code></td>
<td>
<p>a dataframe or a matrix object containing traits as columns and individuals as rows</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the phenotypic integration index (PINT) using the correlation
matrix following Wagner (1984), as well as a phenotypic integration index (PINT.c) corrected by the number
of traits and individuals of each population. The uncorrected estimate is also expressed as percentage 
depending on the maximum possible integration levels.</p>


<h3>Value</h3>

<p> A list with five elements containing:
</p>
<table role = "presentation">
<tr><td><code>PINT:</code></td>
<td>
<p>The phenotypic integration index.</p>
</td></tr>
<tr><td><code>RelPINT:</code></td>
<td>
<p>Percentage of maximum possible integration.</p>
</td></tr>
<tr><td><code>PINT.c:</code></td>
<td>
<p>Corrected phenotypic integration index.</p>
</td></tr>
<tr><td><code>N:</code></td>
<td>
<p>Number of observations used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>R. Torices, A.J. Muñoz-Pajares</p>


<h3>References</h3>

<p>Cheverud, J.M., Wagner, G.P. &amp; Dow, M.M. 1989. Methods for the comparative analysis of variation patterns. Systematic Zoology 38:201–213
</p>
<p>Pavlicev, M., Cheverud, J.M. &amp; Wagner, G.P. 2009. Measuring morphological integration using eigenvaluev ariance. Evolutionary Biology 36:157–170
</p>
<p>Wagner, G.P. 1984. On the eigenvalue distribution of genetic and phenotypic dispersion matrices: evidence for a nonrandom organization of quantitative character variation. Journal of Mathematical Biology 21:77–95
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pint.p">pint.p</a></code>, <code><a href="#topic+pint.boot">pint.boot</a></code>, <code><a href="#topic+pint.jack">pint.jack</a></code>, <code><a href="#topic+pintsc">pintsc</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Dataset from Torices &amp; Méndez (2014)
# This data set represents the dry mass (in grams) of inflorescence components of the sunflower
# species Tussilago farfara. The inflorescences were dissected in 'SCAPE', 'RECEPTACLE', 'MALEFL'
# (male flowers), 'OVAR' (reproductive part of female flowers), and 'RAYS' (the petaloid ray of
# female flower). Furthermore in the last column the total weight of the inflorescence is added
# 'TOTALSIZE'

data(tussilago)
pint (tussilago[,1:5]) # the last column is not included since represents the total size
# NOTE that the number of observations used by the function was 18 instead 29 that were
# included in the 'tussilago' data set. Missing values were removed. 
</code></pre>

<hr>
<h2 id='pint.boot'>Phenotypic integration (by Wagner) bootstrap intervals</h2><span id='topic+pint.boot'></span>

<h3>Description</h3>

<p>This function estimates the confidence intervals of the phenotypic integration index (Wagner, 1984) using bootstrap.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pint.boot(traits, replicates = 1000, verbose=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pint.boot_+3A_traits">traits</code></td>
<td>
<p>a dataframe or a matrix object containing traits as columns and individuals as rows</p>
</td></tr>
<tr><td><code id="pint.boot_+3A_replicates">replicates</code></td>
<td>
<p>a numeric, the number of randomizations (1000 by default)</p>
</td></tr>
<tr><td><code id="pint.boot_+3A_verbose">verbose</code></td>
<td>
<p>a logic, if TRUE, values obtained during the bootstrap resampling are also reported.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rows containing missing values are removed.</p>


<h3>Value</h3>

<p>A matrix with two columns and nine rows. Columns contain information for the uncorrected and corrected indices whereas rows contain mean, median, standard deviation (SD), standard error (SE), lower and higher confidence interval at 99%, lower and higher confidence interval at 95%, and the number of randomizations.</p>


<h3>Author(s)</h3>

<p>R. Torices, A.J. Muñoz-Pajares</p>


<h3>References</h3>

<p>Cheverud, J.M., Wagner, G.P. &amp; Dow, M.M. 1989. Methods for the comparative analysis of variation patterns. Systematic Zoology 38:201–213
</p>
<p>Pavlicev, M., Cheverud, J.M. &amp; Wagner, G.P. 2009. Measuring morphological integration using eigenvaluev ariance. Evolutionary Biology 36:157–170
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pint">pint</a></code>, <code><a href="#topic+pint.p">pint.p</a></code>, <code><a href="#topic+pintsc.boot">pintsc.boot</a></code>, <code><a href="#topic+pint.jack">pint.jack</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Dataset from Torices &amp; Méndez (2014)
# This data set represents the dry mass (in grames) of inflorescence components of the sunflower
# species Tussilago farfara. The inflorescences were dissected in 'SCAPE', 'RECEPTACLE', 'MALEFL'
# (male flowers), 'OVAR' (reproductive part of female flowers), and 'RAYS' (the petaloid ray of
# female flower). Furthermore in the last column the total weight of the inflorescence is added
# 'TOTALSIZE'

data(tussilago)
pint.boot(tussilago[,1:5], 100)
# The phenotypic integration intervals do not include 0.
# For faster execution, we used 100 replicates in this example.
# For real data set increase this number:
# pint.boot(tussilago[,1:5], 5000)
</code></pre>

<hr>
<h2 id='pint.jack'>Phenotypic integration (by Wagner) jackknife resampling</h2><span id='topic+pint.jack'></span>

<h3>Description</h3>

<p>This function estimates the confidence intervals of the phenotypic integration index (Wagner, 1984) using jackknife resampling.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pint.jack(traits,n.remove=1, verbose=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pint.jack_+3A_traits">traits</code></td>
<td>
<p>a dataframe or a matrix object containing traits as columns and individuals as rows</p>
</td></tr>
<tr><td><code id="pint.jack_+3A_n.remove">n.remove</code></td>
<td>
<p>a numeric, the number of individuals to remove on every jackknife iteration</p>
</td></tr>
<tr><td><code id="pint.jack_+3A_verbose">verbose</code></td>
<td>
<p>a logic, if TRUE, values obtained during the jackknife resampling are also reported.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For every iteration, this function removes a given number of individuals before estimating phenotypic integration indices. Then, the process is repeated until all the possible combinations of this number of individuals have been removed. Rows containing missing values are removed.</p>


<h3>Value</h3>

<p>A matrix with two columns and nine rows. Columns contain information for the uncorrected and corrected indices whereas rows contain mean, median, standard deviation (SD), standard error (SE), lower and higher confidence interval at 99%, lower and higher confidence interval at 95%, and the number of iterations.</p>


<h3>Author(s)</h3>

<p>A.J. Muñoz-Pajares, R. Torices</p>


<h3>References</h3>

<p>Cheverud, J.M., Wagner, G.P. &amp; Dow, M.M. 1989. Methods for the comparative analysis of variation patterns. Systematic Zoology 38:201–213
</p>
<p>Pavlicev, M., Cheverud, J.M. &amp; Wagner, G.P. 2009. Measuring morphological integration using eigenvaluev ariance. Evolutionary Biology 36:157–170
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pint">pint</a></code>, <code><a href="#topic+pint.p">pint.p</a></code>, <code><a href="#topic+pintsc.jack">pintsc.jack</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Dataset from Torices &amp; Méndez (2014)
# This data set represents the dry mass (in grames) of inflorescence components of the sunflower
# species Tussilago farfara. The inflorescences were dissected in 'SCAPE', 'RECEPTACLE', 'MALEFL'
# (male flowers), 'OVAR' (reproductive part of female flowers), and 'RAYS' (the petaloid ray of
# female flower). Furthermore in the last column the total weight of the inflorescence is added
# 'TOTALSIZE'

data(tussilago)
pint.jack(tussilago[,1:5], 1) # Replicates are obtained removing one individual
pint.jack(tussilago[,1:5], 3) # Replicates are obtained removing three individuals
</code></pre>

<hr>
<h2 id='pint.p'>Phenotypic integration index (by Wagner) significance test</h2><span id='topic+pint.p'></span>

<h3>Description</h3>

<p>Estimates p-values for the phenotypic integration index described by Wagner (1984). For that, it generates a null distribution based on product–moment correlations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pint.p(traits,n.replicates=1000,N.Pearson=15,plot="Results",tails=1)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pint.p_+3A_traits">traits</code></td>
<td>
<p>a dataframe or a matrix object containing traits as columns and individuals as rows</p>
</td></tr>
<tr><td><code id="pint.p_+3A_n.replicates">n.replicates</code></td>
<td>
<p>a numeric, number of randomizations to estimate the null distribution (1000 by default)</p>
</td></tr>
<tr><td><code id="pint.p_+3A_n.pearson">N.Pearson</code></td>
<td>
<p>a numeric (&gt;2) to shape the distribution probability to sample the correlation matrix. See  Details.</p>
</td></tr>
<tr><td><code id="pint.p_+3A_plot">plot</code></td>
<td>
<p>a string. Possible values are &quot;Results&quot; or &quot;R&quot; to display the simulated null distribution and the observed value as a histogram; and &quot;Pearson.distribution&quot; or &quot;P&quot; to check the distribution generated by the N.Pearson parameter to produce the correlation matrix. Any other value will produce no plot.</p>
</td></tr>
<tr><td><code id="pint.p_+3A_tails">tails</code></td>
<td>
<p>possible values are 1 and 2 to set the test for one or two tails. By default is set to 1, because values of integration are expected to be higher in the real than in the simulated dataset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a set of theoretical correlation matrices, with as many rows and columns as the number of variables contained in 'traits'. Values in this matrix are randomly drawn using a Pearson product moment correlation coefficient distribution (as implemented in the SuppDists package). The distribution is shaped by the N.Pearson value as follows: 
</p>
<p>N.Pearson = 3 increases frequency for extreme values (that is -1 and +1).
</p>
<p>N.Pearson = 4 generates a uniform distribution (similar probability for all values).
</p>
<p>N.Pearson &gt; 5 increases frequency for central values (that is, 0).
</p>
<p>The option plot=&quot;Pearson.distribution&quot; or plot=&quot;P&quot; displays the distribution used to generate the theoretical correlation matrices. This plot produces an histogram with 100,000 observations taken from the distribution shaped by the N.Pearson value.
</p>


<h3>Value</h3>

<p> A list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>Simulated.cor</code></td>
<td>
<p>The simulated theoretical correlation matrices.</p>
</td></tr>
<tr><td><code>Simulated.int</code></td>
<td>
<p>The phenotypic integration indices estimated on the simulated matrices.</p>
</td></tr>
<tr><td><code>Simulated.Range</code></td>
<td>
<p>The range (minimum-maximum) of phenotypic integration indices estimated on the simulated matrices.</p>
</td></tr>
<tr><td><code>Simulated.Mean</code></td>
<td>
<p>The mean of phenotypic integration indices estimated on the simulated matrices.</p>
</td></tr>
<tr><td><code>Real.int</code></td>
<td>
<p>The phenotypic integration indices estimated on the real dataset.</p>
</td></tr>
<tr><td><code>Summary</code></td>
<td>
<p>A data frame containing the integration indices (as rows) for the real and simulated dataset and the p-value (as columns)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.J. Muñoz-Pajares, R. Torices</p>


<h3>References</h3>

<p>Harder, L.D. 2009. Questions about floral (dis)integration. New Phytologist 183:247–248. 
</p>
<p>Ordano, M., Fornoni, J., Boege, K. &amp; Domínguez, C.A. 2008. The adaptive value of phenotypic floral integration. New Phytologist 179:1183–1192.
</p>
<p>Wagner, G.P. 1984. On the eigenvalue distribution of genetic and phenotypic dispersion matrices: evidence for a non-random organization of quantitative character variation. Journal of Mathematical Biology 21:77–95.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pint">pint</a></code>, <code><a href="#topic+pint.boot">pint.boot</a></code>, <code><a href="#topic+pint.jack">pint.jack</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(tussilago)
# Using a uniform distribution to generate the correlation matrices:
## A) Showing uniform distribution
unif1&lt;-pint.p(traits=tussilago,n.replicates=1000, N.Pearson=4,plot="P")

## B) Showing the resulting null distribution and the real value (red line)
unif2&lt;-pint.p(traits=tussilago,n.replicates=1000, N.Pearson=4,plot="R")

dev.new()
# Using a non-uniform distribution to generate the correlation matrices:
## A) Showing the Pearson product moment correlation coefficient distribution
prmo1&lt;-pint.p(traits=tussilago,n.replicates=1000, N.Pearson=15,plot="P")
## B) Showing the resulting null distribution and the real value (red line)
prmo2&lt;-pint.p(traits=tussilago,n.replicates=1000, N.Pearson=15,plot="R")

# Comparing the uniform and the non-uniform distributions
# as in Harder New Phytologist (2009) 183: 247-248

vari&lt;-2 #variable to plot (INT.c)
toplot1&lt;-unif2$Simulated.int[vari,]
toplot2&lt;-prmo2$Simulated.int[vari,]
HIST&lt;-hist(as.matrix(toplot2),plot=FALSE)
MaxY&lt;-max(HIST$density)

Max&lt;-max(toplot1,toplot2)
Min&lt;-min(HIST$mids)
 plot(c(1,2),xlim=c((Min-0.05*Max),(Max+0.05*Max)),ylim=c(0,(MaxY+0.05*MaxY)),
type="n",ylab="Density",xlab="Maximum integration (percentage)")
 hist(as.matrix(toplot1),add=TRUE,freq=FALSE,breaks=28)
 hist(as.matrix(toplot2),add=TRUE,freq=FALSE,col="grey",breaks=8)
# And the real value as a red line:
abline(v=prmo1$Real[vari],lty=2, col="red")

</code></pre>

<hr>
<h2 id='pintsc'>size-controlled phenotypic integration</h2><span id='topic+pintsc'></span>

<h3>Description</h3>

<p>This function estimates the phenotypic integration indices controlling by a third variable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pintsc(traits,control=NA)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pintsc_+3A_traits">traits</code></td>
<td>
<p>a dataframe or a matrix object containing traits as columns and individuals as rows</p>
</td></tr>
<tr><td><code id="pintsc_+3A_control">control</code></td>
<td>
<p>a vector containing the variable to control by size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates the same set of indices than <code><a href="#topic+pint">pint</a></code> but from partial correlation
matrix instead of the correlation matrix: PINTsc: The variance of the eigenvalues using the partial correlation
matrix instead of a correlation matrix. Torices &amp; Méndez (2014) proposed this index for analysing phenotypic
integration of resource allocation to different components in an individual or a given organ when resource
allocation data come from observational studies in which resource availability is not controlled and therefore
could lead to components correlations only by the fact of different resource availability. Thus, PINT can be
estimated using the matrix of partial correlations in which size of the organ or individual is used as the third
control variable. PINTsc.c: The PINTsc corrected by the number of traits and individuals of each population.
RelPINTsc: The same as RelPINT but estimated with the partial correlation matrix.
</p>
<p>Rows containing missing values are removed.</p>


<h3>Value</h3>

<p> A list with five elements containing:
</p>
<table role = "presentation">
<tr><td><code>PINTsc:</code></td>
<td>
<p>The phenotypic integration index.</p>
</td></tr>
<tr><td><code>RelPINTsc:</code></td>
<td>
<p>Percentage of maximum possible integration.</p>
</td></tr>
<tr><td><code>PINTsc.c:</code></td>
<td>
<p>Corrected phenotypic integration index.</p>
</td></tr>
<tr><td><code>N:</code></td>
<td>
<p>Number of observations used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>R. Torices, A.J. Muñoz-Pajares</p>


<h3>References</h3>

<p>Torices, R. &amp; Méndez, M. 2014. Resource allocation to inflorescence components is highly integrated despite differences between allocation currencies and sites. International Journal of Plant Science 175(6):713–723.</p>


<h3>See Also</h3>

<p><code><a href="#topic+pint">pint</a></code>, <code><a href="#topic+pintsc.boot">pintsc.boot</a></code>, <code><a href="#topic+pintsc.p">pintsc.p</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Dataset from Torices &amp; Méndez (2014)
# This data set represents the dry mass (in grams) of inflorescence components of the sunflower
# species Tussilago farfara. The inflorescences were dissected in 'SCAPE', 'RECEPTACLE', 'MALEFL'
# (male flowers), 'OVAR' (reproductive part of female flowers), and 'RAYS' (the petaloid ray of
# female flower). Furthermore in the last column the total weight of the inflorescence is added
#'TOTALSIZE'

data(tussilago)

# To estimate the PINT indices controlling by a third variable
# it is mandatory to define the "control" variable. Otherwise, it gives an error:
#
# pintsc(traits=tussilago)
pintsc(traits=tussilago[,1:5],control=tussilago[,6])
</code></pre>

<hr>
<h2 id='pintsc.boot'>size-controlled phenotypic integration bootstrap intervals</h2><span id='topic+pintsc.boot'></span>

<h3>Description</h3>

<p>This function estimates the confidence intervals of the phenotypic integration index controlling by a third variable using bootstrap.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pintsc.boot(traits, control=NA, replicates = 1000, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pintsc.boot_+3A_traits">traits</code></td>
<td>
<p>a dataframe or a matrix object containing traits as columns and individuals as rows</p>
</td></tr>
<tr><td><code id="pintsc.boot_+3A_control">control</code></td>
<td>
<p>a vector containing the variable to control by size.</p>
</td></tr>
<tr><td><code id="pintsc.boot_+3A_replicates">replicates</code></td>
<td>
<p>a numeric, the number of randomizations (1000 by default).</p>
</td></tr>
<tr><td><code id="pintsc.boot_+3A_verbose">verbose</code></td>
<td>
<p>a logic, if TRUE, values obtained during the bootstrap resampling are also reported.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rows containing missing values are removed.</p>


<h3>Value</h3>

<p>A matrix with two columns and nine rows. Columns contain information for the uncorrected and corrected indices whereas rows contain mean, median, standard deviation (SD), standard error (SE), lower and higher confidence interval at 99%, lower and higher confidence interval at 95%, and the number of randomizations.</p>


<h3>Author(s)</h3>

<p>R. Torices, A.J. Muñoz-Pajares</p>


<h3>See Also</h3>

<p><code><a href="#topic+pintsc">pintsc</a></code>, <code><a href="#topic+pint.boot">pint.boot</a></code>, <code><a href="#topic+pintsc.jack">pintsc.jack</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Dataset from Torices &amp; Méndez (2014)
# This data set represents the dry mass (in grams) of inflorescence components of the sunflower
# species Tussilago farfara. The inflorescences were dissected in 'SCAPE', 'RECEPTACLE', 'MALEFL'
# (male flowers), 'OVAR' (reproductive part of female flowers), and 'RAYS' (the petaloid ray of
# female flower). Furthermore in the last column the total weight of the inflorescence is added
# 'TOTALSIZE'

data(tussilago)

# Iit is mandatory to define the "control" variable. Otherwise, it gives an error:
# pintsc.boot(tussilago, 5000)
pintsc.boot(traits=tussilago[,1:5], replicates=100, control=tussilago[,6])
# The phenotypic integration index intervals do not include 0.
# For faster execution, we used 100 replicates in this example.
# For real data set increase this number:
# pintsc.boot(traits=tussilago[,1:5], replicates=5000, control=tussilago[,6])
</code></pre>

<hr>
<h2 id='pintsc.jack'>size-controlled phenotypic integration jackknife resampling</h2><span id='topic+pintsc.jack'></span>

<h3>Description</h3>

<p>This function estimates the confidence intervals of the phenotypic integration index controlling by a third variable using jackknife resampling.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pintsc.jack(traits, control=NA, n.remove = 1, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pintsc.jack_+3A_traits">traits</code></td>
<td>
<p>a dataframe or a matrix object containing traits as columns and individuals as rows</p>
</td></tr>
<tr><td><code id="pintsc.jack_+3A_control">control</code></td>
<td>
<p>a vector containing the variable to control by size.</p>
</td></tr>
<tr><td><code id="pintsc.jack_+3A_n.remove">n.remove</code></td>
<td>
<p>a numeric, the number of individuals to remove on every jackknife iteration</p>
</td></tr>
<tr><td><code id="pintsc.jack_+3A_verbose">verbose</code></td>
<td>
<p>a logic, if TRUE, values obtained during the jackknife resampling are also reported.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For every iteration, this function removes a given number of individuals before estimating phenotypic integration indices. Then, the process is repeated until all the possible combinations of this number of individuals have been removed. Rows containing missing values are removed.</p>


<h3>Value</h3>

<p>A matrix with two columns and nine rows. Columns contain information for the uncorrected and corrected indices whereas rows contain mean, median, standard deviation (SD), standard error (SE), lower and higher confidence interval at 99%, lower and higher confidence interval at 95%, and the number of randomizations.</p>


<h3>Author(s)</h3>

<p>A.J. Muñoz-Pajares, R. Torices</p>


<h3>See Also</h3>

<p><code><a href="#topic+pintsc">pintsc</a></code>, <code><a href="#topic+pint.boot">pint.boot</a></code>, <code><a href="#topic+pint.jack">pint.jack</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Dataset from Torices &amp; Méndez (2014)
# This data set represents the dry mass (in grams) of inflorescence components of the sunflower
# species Tussilago farfara. The inflorescences were dissected in 'SCAPE', 'RECEPTACLE', 'MALEFL'
# (male flowers), 'OVAR' (reproductive part of female flowers), and 'RAYS' (the petaloid ray of
# female flower). Furthermore in the last column the total weight of the inflorescence is added
# 'TOTALSIZE'

data(tussilago)

# Iit is mandatory to define the "control" variable. Otherwise, it gives an error:
# pintsc.jack(tussilago, 1)
pintsc.jack(traits=tussilago[,1:5], control=tussilago[,6], 1)
</code></pre>

<hr>
<h2 id='pintsc.p'>size-controlled phenotypic integration index significance test</h2><span id='topic+pintsc.p'></span>

<h3>Description</h3>

<p>Estimates p-values for the size-controlled phenotypic integration index by generating a null distribution based on product–moment correlations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pintsc.p(traits,control=NA,n.replicates=1000,N.Pearson=15,plot="Results",tails=1)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pintsc.p_+3A_traits">traits</code></td>
<td>
<p>a dataframe or a matrix object containing traits as columns and individuals as rows</p>
</td></tr>
<tr><td><code id="pintsc.p_+3A_control">control</code></td>
<td>
<p>a vector containing the variable to control by size.</p>
</td></tr>
<tr><td><code id="pintsc.p_+3A_n.replicates">n.replicates</code></td>
<td>
<p>a numeric, number of randomizations to estimate the null distribution (1000 by default)</p>
</td></tr>
<tr><td><code id="pintsc.p_+3A_n.pearson">N.Pearson</code></td>
<td>
<p>a numeric (&gt;2) to shape the distribution probability to sample the correlation matrix. See  Details.</p>
</td></tr>
<tr><td><code id="pintsc.p_+3A_plot">plot</code></td>
<td>
<p>a string. Possible values are &quot;Results&quot; or &quot;R&quot; to display the simulated null distribution and the observed value as a histogram; and &quot;Pearson.distribution&quot; or &quot;P&quot; to check the distribution generated by the N.Pearson parameter to produce the correlation matrix. Any other value will produce no plot.</p>
</td></tr>
<tr><td><code id="pintsc.p_+3A_tails">tails</code></td>
<td>
<p>possible values are 1 and 2 to set the test for one or two tails. By default is set to 1, because values of integration are expected to be higher in the real than in the simulated dataset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a set of theoretical correlation matrices, with as many rows and columns as the number of variables contained in 'traits'. Values in this matrix are randomly drawn using a Pearson product moment correlation coefficient distribution (as implemented in the SuppDists package). The distribution is shaped by the N.Pearson value as follows: 
</p>
<p>N.Pearson = 3 increases frequency for extreme values (that is -1 and +1).
</p>
<p>N.Pearson = 4 generates a uniform distribution (similar probability for all values).
</p>
<p>N.Pearson &gt; 5 increases frequency for central values (that is, 0).
</p>
<p>The option plot=&quot;Pearson.distribution&quot; or plot=&quot;P&quot; displays the distribution used to generate the theoretical correlation matrices. This plot produces an histogram with 100,000 observations taken from the distribution shaped by the N.Pearson value.
</p>


<h3>Value</h3>

<p> A list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>Simulated.cor</code></td>
<td>
<p>The simulated theoretical correlation matrices.</p>
</td></tr>
<tr><td><code>Simulated.int</code></td>
<td>
<p>The phenotypic integration indices estimated on the simulated matrices.</p>
</td></tr>
<tr><td><code>Simulated.Range</code></td>
<td>
<p>The range (minimum-maximum) of phenotypic integration indices estimated on the simulated matrices.</p>
</td></tr>
<tr><td><code>Simulated.Mean</code></td>
<td>
<p>The mean of phenotypic integration indices estimated on the simulated matrices.</p>
</td></tr>
<tr><td><code>Real.int</code></td>
<td>
<p>The phenotypic integration indices estimated on the real dataset.</p>
</td></tr>
<tr><td><code>Summary</code></td>
<td>
<p>A data frame containing the integration indices (as rows) for the real and simulated dataset and the p-value (as columns)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>A.J. Muñoz-Pajares, R. Torices</p>


<h3>References</h3>

<p>Harder, L.D. 2009. Questions about floral (dis)integration. New Phytologist 183:247–248. 
</p>
<p>Ordano, M., Fornoni, J., Boege, K. &amp; Domínguez, C.A. 2008. The adaptive value of phenotypic floral integration. New Phytologist 179:1183–1192.
</p>
<p>Wagner, G.P. 1984. On the eigenvalue distribution of genetic and phenotypic dispersion matrices: evidence for a non-random organization of quantitative character variation. Journal of Mathematical Biology 21:77–95.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pintsc">pintsc</a></code>, <code><a href="#topic+pintsc.boot">pintsc.boot</a></code>, <code><a href="#topic+pintsc.jack">pintsc.jack</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(tussilago)

# Using a uniform distribution to generate the correlation matrices:

## A) Showing uniform distribution
unif1&lt;-pintsc.p(traits=tussilago[,1:5], control=tussilago[,6],
n.replicates=1000, N.Pearson=4, plot="P")

## B) Showing the resulting null distribution and the real value (red line)
unif2&lt;-pintsc.p(traits=tussilago[,1:5], control=tussilago[,6],
n.replicates=1000, N.Pearson=4, plot="R")

# Using a non-uniform distribution to generate the correlation matrices:

dev.new()
## A) Showing the Pearson product moment correlation coefficient distribution
prmo1&lt;-pintsc.p(traits=tussilago[,1:5], control=tussilago[,6],
n.replicates=1000, N.Pearson=15, plot="P")

## B) Showing the resulting null distribution and the real value (red line)
prmo2&lt;-pintsc.p(traits=tussilago[,1:5], control=tussilago[,6],
n.replicates=1000, N.Pearson=15, plot="R")

# Comparing the uniform and the non-uniform distributions
# as in Harder New Phytologist (2009) 183: 247–248

vari&lt;-2 #variable to plot (INT.c)
toplot1&lt;-unif2$Simulated.int[vari,]
toplot2&lt;-prmo2$Simulated.int[vari,]
HIST&lt;-hist(as.matrix(toplot2),plot=FALSE)
MaxY&lt;-max(HIST$density)

Max&lt;-max(toplot1,toplot2)
Min&lt;-min(HIST$mids)
 plot(c(1,2),xlim=c((Min-0.05*Max),(Max+0.05*Max)),ylim=c(0,(MaxY+0.05*MaxY)),
type="n",ylab="Density",xlab="Maximum integration (percentage)")

 hist(as.matrix(toplot1),add=TRUE,freq=FALSE,breaks=28)
 hist(as.matrix(toplot2),add=TRUE,freq=FALSE,col="grey",breaks=18)
# And the real value as a red line:
abline(v=prmo1$Real[vari],lty=2, col="red")

</code></pre>

<hr>
<h2 id='tussilago'>phenotypic integration example dataset #2</h2><span id='topic+tussilago'></span>

<h3>Description</h3>

<p>phenotypic integration example dataset from Torices &amp; Méndez (2014).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tussilago)</code></pre>


<h3>Details</h3>

<p>This data set represents the dry mass (in grams) of inflorescence components of the sunflower species <em>Tussilago farfara</em>. The inflorescences were dissected in 'SCAPE', 'RECEPTACLE', 'MALEFL' (male flowers), 'OVAR' (reproductive part of female flowers), and 'RAYS' (the petaloid ray of female flower). Furthermore in the last column the total weight of the inflorescence is added 'TOTALSIZE'.</p>


<h3>Author(s)</h3>

<p>R. Torices, M. Méndez</p>


<h3>References</h3>

<p>Torices, R. &amp; Méndez, M. 2014. Resource allocation to inflorescence components is highly integrated despite differences between allocation currencies and sites. International Journal of Plant Science 175(6):713–723.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tussilago)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
