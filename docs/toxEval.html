<!DOCTYPE html><html><head><title>Help for package toxEval</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {toxEval}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.toxEval'><p>toxEval helper functions</p></a></li>
<li><a href='#clean_endPoint_info'><p>clean_endPoint_info</p></a></li>
<li><a href='#create_toxEval'><p>Load and check toxEval data</p></a></li>
<li><a href='#createLink'><p>createLink</p></a></li>
<li><a href='#end_point_info'><p>Endpoint information from ToxCast</p></a></li>
<li><a href='#endpoint_hits_DT'><p>Rank endpoints by category</p></a></li>
<li><a href='#explore_endpoints'><p>Explore data in the Shiny Application</p></a></li>
<li><a href='#filter_groups'><p>Filter endPoints based on groups and assays.</p></a></li>
<li><a href='#get_ACC'><p>Get the ACC values for a selection of chemicals</p></a></li>
<li><a href='#get_chemical_summary'><p>Compute EAR values</p></a></li>
<li><a href='#get_concentration_summary'><p>Create concentration summary</p></a></li>
<li><a href='#graph_chem_data'><p>Prepare boxplot data</p></a></li>
<li><a href='#hits_by_groupings_DT'><p>Biological hits per category</p></a></li>
<li><a href='#hits_summary_DT'><p>Summary of hits per site/category</p></a></li>
<li><a href='#make_tox_map'><p>Create an interactive map of the data</p></a></li>
<li><a href='#plot_chemical_boxplots'><p>Grouped Boxplots</p></a></li>
<li><a href='#plot_tox_endpoints'><p>EndPoint boxplots</p></a></li>
<li><a href='#plot_tox_endpoints2'><p>EndPoint boxplots with faceting option</p></a></li>
<li><a href='#plot_tox_heatmap'><p>Plot EAR heat maps</p></a></li>
<li><a href='#plot_tox_stacks'><p>Plot stacked bar charts</p></a></li>
<li><a href='#rank_sites_DT'><p>Rank sites by EAR</p></a></li>
<li><a href='#remove_flags'><p>Remove endpoints with specific data quality flags from data</p></a></li>
<li><a href='#summary.toxEval'><p>Summary of tox_list</p></a></li>
<li><a href='#tox_chemicals'><p>ToxCast Chemical Information</p></a></li>
<li><a href='#ToxCast_ACC'><p>ACC values included with toxEval.</p></a></li>
<li><a href='#toxEval-package'><p>Analyze ToxCast data in relation to measured concentrations.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Exploring Biological Relevance of Environmental Chemistry
Observations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Data analysis package for estimating potential biological effects from chemical concentrations in environmental samples. Included are a set of functions to analyze, visualize, and organize measured concentration data as it relates to user-selected chemical-biological interaction benchmark data such as water quality criteria. The intent of these analyses is to develop a better understanding of the potential biological relevance of environmental chemistry data. Results can be used to prioritize which chemicals at which sites may be of greatest concern. These methods are meant to be used as a screening technique to predict potential for biological influence from chemicals that ultimately need to be validated with direct biological assays. A description of the analysis can be found in Blackwell (2017) &lt;<a href="https://doi.org/10.1021%2Facs.est.7b01613">doi:10.1021/acs.est.7b01613</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>This software is in the public domain because it contains
materials that originally came from the United States
Geological Survey, an agency of the United States Department of
Interior. For more information, see the official USGS copyright
policy at
https://www.usgs.gov/visual-id/credit_usgs.html#copyright</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, tidyr, DT (&ge; 0.1.24), leaflet (&ge; 1.0.0), ggplot2 (&ge;
3.0.0), magrittr, shiny, shinydashboard, RColorBrewer, readxl,
tools, shinyAce, shinycssloaders</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, testthat, knitr, here, tcpl, openxlsx, covr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DOI-USGS/toxEval/issues">https://github.com/DOI-USGS/toxEval/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>true</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-07 20:04:30 UTC; ldecicco</td>
</tr>
<tr>
<td>Author:</td>
<td>Laura DeCicco <a href="https://orcid.org/0000-0002-3915-9487"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Steven Corsi <a href="https://orcid.org/0000-0003-0583-5536"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Daniel Villeneuve <a href="https://orcid.org/0000-0003-2801-0203"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Brett Blackwell <a href="https://orcid.org/0000-0003-1296-4539"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Gerald Ankley <a href="https://orcid.org/0000-0002-9937-615X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Alison Appling [rev] (Reviewed for USGS),
  Dalma Martinovic [rev] (Reviewed for USGS)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Laura DeCicco &lt;ldecicco@usgs.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-08 07:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.toxEval'>toxEval helper functions</h2><span id='topic+as.toxEval'></span>

<h3>Description</h3>

<p>A small collection of helper functions for toxEval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.toxEval(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.toxEval_+3A_x">x</code></td>
<td>
<p>list or toxEval object</p>
</td></tr>
<tr><td><code id="as.toxEval_+3A_...">...</code></td>
<td>
<p>data frames to override data within the original x list.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"
full_path &lt;- file.path(path_to_tox, file_name)
tox_list &lt;- create_toxEval(full_path)

# To over-ride one of the data frames:
chem_data &lt;- data.frame(
  CAS = "21145-77-7",
  Value = 1,
  "Sample Date" = as.Date("2012-01-01"),
  SiteID = "USGS-04249000"
)
tox_list_new &lt;- as.toxEval(tox_list, chem_data)

</code></pre>

<hr>
<h2 id='clean_endPoint_info'>clean_endPoint_info</h2><span id='topic+clean_endPoint_info'></span>

<h3>Description</h3>

<p>Define a subset of the ToxCast database for relevance to toxEval analyses.
Subsetting is done based upon methods defined by Blackwell et al., 2017 (
<a href="https://doi.org/10.1021/acs.est.7b01613">doi:10.1021/acs.est.7b01613</a>).
Specifically, this function removes endPoints that are ATG sources with
signal loss, and NVS with signal gain (basically: some assay/signal combinations
are removed because they target non-specific endpoints). Also, this function adds additional
categories to intended_target_family and intended_target_family_sub as
described in the paper linked above.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_endPoint_info(end_point_info)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_endPoint_info_+3A_end_point_info">end_point_info</code></td>
<td>
<p>Data frame Endpoint information from ToxCast.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The returned data frame is based on end_point_info, but with some endPoints
filtered out and some additional categories in intended_target_family and
intended_target_family_sub. The names in intended_target_family
are revised to look more appealing in graphs and tables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>end_point_info &lt;- end_point_info
nrow(end_point_info)
cleaned_ep &lt;- clean_endPoint_info(end_point_info)
nrow(cleaned_ep)
</code></pre>

<hr>
<h2 id='create_toxEval'>Load and check toxEval data</h2><span id='topic+create_toxEval'></span>

<h3>Description</h3>

<p>This function is used to load a data file for analysis in the form of a
single Excel file. The Excel file should include 3 mandatory sheets named
&quot;Data&quot;, &quot;Chemicals&quot;, and &quot;Sites&quot;. Additionally there are 2 optional sheets:
&quot;Exclude&quot; and &quot;Benchmarks&quot;. This function creates a data frame for each
sheet,  perform basic checks on the data to assure that required columns are
included for each sheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_toxEval(excel_file_path, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_toxEval_+3A_excel_file_path">excel_file_path</code></td>
<td>
<p>Path to Excel file that contains at least 3 sheets: Data, Chemicals, and Sites,
and could optionally contain Exclude and Benchmarks.</p>
</td></tr>
<tr><td><code id="create_toxEval_+3A_...">...</code></td>
<td>
<p>data frames to override data within the original x list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Required columns in the Data sheet include &quot;CAS&quot;, &quot;SiteID&quot;, &quot;Value&quot;, and
&quot;Sample Date&quot;. The &quot;Value&quot; column includes concentration measurements in
units of <code class="reqn">\mu</code>g/L. &quot;Sample Date&quot; can be either a date or date/time or an integer.
Additional columns may be included for user purposes, but will not be used in
toxEval.
</p>
<p>Required columns in the Chemical sheet include &quot;CAS&quot;, &quot;Class&quot;. &quot;CAS&quot; values in
this sheet must exactly match corresponding &quot;CAS&quot; values in the Data sheet. The
&quot;Class&quot; designation allows  data to be grouped in a user-specified way. For
example, in a data set of multiple pesticides, it may be valuable to explore
differences and similarities to of insecticides, herbicides and fungicides.
Additional columns may be included for user purposes, but will not be used in
toxEval.
</p>
<p>Required columns in the Sites sheet includes &quot;SiteID&quot;, &quot;Short Name&quot;, and for
the Shiny application &quot;dec_lat&quot;,&quot;dec_lon&quot;. Values in the &quot;SiteID&quot; column in
this sheet exactly match corresponding values in the &quot;SiteID&quot; column in the
Data sheet. Additional columns may be included for user purposes, but will not
be used in toxEval.
</p>
<p>When using the optional sheet Exclude, columns required include &quot;CAS&quot; and
&quot;endPoint&quot;. These are used to exclude particular chemicals (via CAS),
ToxCast endpoints (via endPoint), or a unique chemical/endpoint combination.
Additional columns may be included for user purposes, but will not be used
in toxEval.
</p>
<p>When using the optional sheet Benchmarks, columns required include &quot;CAS&quot;,
&quot;endPoint&quot;,&quot;ACC_value&quot; and &quot;chnm&quot;. This sheet is used to over-ride the
functions using endpoints from the ToxCast database, allowing the user
to import endpoint information from other sources. It could also be useful
for reproducing results in the future (for example, if after ToxCast updates,
analysis with an older version of ToxCast may be reproduced by including the
selected ToxCast endpoint database in this sheet. Additional columns may be included for user
purposes, but will not be used in toxEval.
</p>
<p>For more information, see the &quot;Prepare Data&quot; vignette: <a href="../doc/PrepareData.html"><code>vignette("PrepareData", package = "toxEval")</code></a>.
</p>
<p>All remaining toxEval functions use data from via the list that is returned
from this function.
</p>


<h3>Value</h3>

<p>The object returned from this function contains a list of between
three and five data frames. The minimum data frames returned are chem_data
(containing at least the columns: &quot;CAS&quot;, &quot;SiteID&quot;, &quot;Value&quot;, &quot;Sample Date&quot;),
chem_info (containing at least the columns: &quot;CAS&quot;, &quot;Class&quot;), and
chem_site (containing at least the columns: &quot;SiteID&quot;, &quot;Short Name&quot;. For the
Shiny app, &quot;dec_lat&quot; and &quot;dec_lon&quot; are also required). The optional data
frames are exclusions (containing at least the columns: &quot;CAS&quot; and &quot;endPoint&quot;),
and benchmarks (containing at least the columns: &quot;CAS&quot;, &quot;endPoint&quot;,
&quot;ACC_value&quot; and &quot;chnm&quot;)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"
excel_file_path &lt;- file.path(path_to_tox, file_name)
tox_list &lt;- create_toxEval(excel_file_path)
</code></pre>

<hr>
<h2 id='createLink'>createLink</h2><span id='topic+createLink'></span>

<h3>Description</h3>

<p>Create links
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createLink(cas)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createLink_+3A_cas">cas</code></td>
<td>
<p>character</p>
</td></tr>
</table>

<hr>
<h2 id='end_point_info'>Endpoint information from ToxCast</h2><span id='topic+end_point_info'></span>

<h3>Description</h3>

<p>Downloaded on October 2022 from ToxCast. The file name of the
raw data was &quot;assay_annotation_information_invitrodb_v3_5.xlsx&quot; from the zip file
&quot;INVITRODB_V3_5_SUMMARY&quot; folder. At the time
of the toxEval package release, these data were found at:
<a href="https://www.epa.gov/comptox-tools/exploring-toxcast-data">https://www.epa.gov/comptox-tools/exploring-toxcast-data</a>
in the section marked &quot;Download Assay Information&quot;, in the
ToxCast &amp; Tox21 high-throughput assay information data set.
</p>


<h3>Value</h3>

<p>data frame with 72 columns. The columns and definitions
are discussed in the &quot;ToxCast Assay Annotation Version 1.0 Data User Guide (PDF)&quot; (see source).
The column &quot;Relevance Category&quot; was included for consideration of 
grouping/filtering endpoints based on user goals.
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.23645/epacomptox.6062479.v3">doi:10.23645/epacomptox.6062479.v3</a>
</p>


<h3>References</h3>

<p>U.S. EPA. 2014. ToxCast Assay Annotation Data User Guide.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>end_point_info &lt;- end_point_info
head(end_point_info[, 1:5])
</code></pre>

<hr>
<h2 id='endpoint_hits_DT'>Rank endpoints by category</h2><span id='topic+endpoint_hits_DT'></span><span id='topic+endpoint_hits'></span>

<h3>Description</h3>

<p>The <code>endpoint_hits_DT</code> (data.table (DT) option) and <code>endpoint_hits</code>
(data frame option) functions create tables with one row per endPoint, and
one column per category(&quot;Biological&quot;, &quot;Chemical&quot;, or &quot;Chemical Class&quot;). The
values in the table are the number of sites where the EAR exceeded the
user-defined EAR hit_threshold in that endpoint/category combination. If the
category &quot;Chemical&quot; is chosen, an &quot;info&quot; link is provided to the
chemical information available in the &quot;Comptox Dashboard&quot;
<a href="https://comptox.epa.gov/dashboard/">https://comptox.epa.gov/dashboard/</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>endpoint_hits_DT(
  chemical_summary,
  category = "Biological",
  mean_logic = FALSE,
  sum_logic = TRUE,
  hit_threshold = 0.1,
  include_links = TRUE
)

endpoint_hits(
  chemical_summary,
  category = "Biological",
  mean_logic = FALSE,
  sum_logic = TRUE,
  hit_threshold = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="endpoint_hits_DT_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code>get_chemical_summary</code></p>
</td></tr>
<tr><td><code id="endpoint_hits_DT_+3A_category">category</code></td>
<td>
<p>Character. Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="endpoint_hits_DT_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical.  <code>TRUE</code> displays the mean sample from each site,
FALSE displays the maximum sample from each site.</p>
</td></tr>
<tr><td><code id="endpoint_hits_DT_+3A_sum_logic">sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> indicates that EAR values are not considered to be
additive and often will be a more appropriate choice for traditional
benchmarks as opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="endpoint_hits_DT_+3A_hit_threshold">hit_threshold</code></td>
<td>
<p>Numeric. EAR threshold defining a &quot;hit&quot;.</p>
</td></tr>
<tr><td><code id="endpoint_hits_DT_+3A_include_links">include_links</code></td>
<td>
<p>Logical. whether or not to include a link to the ToxCast
dashboard. Only needed for the &quot;Chemical&quot; category.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tables show slightly different results when choosing to explore data
from a single site rather than all sites. The value displayed in this
instance is the number of samples with hits rather than the number of sites
with hits.
</p>


<h3>Value</h3>

<p>data frame with one row per endpoint that had a hit (based on the
hit_threshold). The columns are based on the category.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is the example workflow:
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

hits_df &lt;- endpoint_hits(chemical_summary, category = "Biological")
endpoint_hits_DT(chemical_summary, category = "Biological")
endpoint_hits_DT(chemical_summary, category = "Chemical Class")
endpoint_hits_DT(chemical_summary, category = "Chemical")

</code></pre>

<hr>
<h2 id='explore_endpoints'>Explore data in the Shiny Application</h2><span id='topic+explore_endpoints'></span>

<h3>Description</h3>

<p>Open an interactive app in a browser. Using this
function is a quick and convenient way
to explore data. For more customization, the R-code to
produce each graph and table is displayed in the app. That is
a good starting-point for a custom analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>explore_endpoints(browse = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="explore_endpoints_+3A_browse">browse</code></td>
<td>
<p>Logical. Use browser for running Shiny app.</p>
</td></tr>
</table>

<hr>
<h2 id='filter_groups'>Filter endPoints based on groups and assays.</h2><span id='topic+filter_groups'></span>

<h3>Description</h3>

<p>This function provides a mechanism to specify 3 levels of information in the
supplied data frame <code><a href="#topic+end_point_info">end_point_info</a></code> to be used in subsequent analysis steps.
First, the user specifies the ToxCast assay annotation using the 'groupCol'
argument, which is a column header in 'end_point_info'. Second, the user
specifies the families of assays to use. Finally, the user can choose to
remove specific group(s) from the category. The default is to remove
'Background Measurement' and 'Undefined'. Choices for this should be
reconsidered based on individual study objectives.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_groups(
  ep,
  groupCol = "intended_target_family",
  assays = c("ACEA", "APR", "ATG", "NVS", "OT", "TOX21", "CEETOX", "LTEA", "CLD",
    "TANGUAY", "CCTE_PADILLA", "CCTE", "STM", "ARUNA", "CCTE_SHAFER", "CPHEA_STOKER",
    "CCTE_GLTED", "UPITT", "UKN", "ERF", "TAMU", "IUF", "CCTE_MUNDY", "UTOR", "VALA"),
  remove_groups = c("Background Measurement", "Undefined")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_groups_+3A_ep">ep</code></td>
<td>
<p>Data frame containing Endpoint information from ToxCast</p>
</td></tr>
<tr><td><code id="filter_groups_+3A_groupcol">groupCol</code></td>
<td>
<p>Character name of ToxCast annotation column to use as a group category</p>
</td></tr>
<tr><td><code id="filter_groups_+3A_assays">assays</code></td>
<td>
<p>Vector of assays to use in the data analysis. Possible values are &quot;ACEA&quot;, &quot;APR&quot;, &quot;ATG&quot;,
&quot;NVS&quot;, &quot;OT&quot;, &quot;TOX21&quot;, &quot;CEETOX&quot;, &quot;LTEA&quot;, &quot;CLD&quot;, &quot;TANGUAY&quot;, &quot;CCTE_PADILLA&quot;, &quot;BSK&quot; ,
&quot;CCTE&quot;, &quot;STM&quot;, &quot;ARUNA&quot;, &quot;CCTE_SHAFER&quot;, &quot;CPHEA_STOKER&quot;, &quot;CCTE_GLTED&quot;, &quot;UPITT&quot;, &quot;UKN&quot;,
&quot;ERF&quot;, &quot;TAMU&quot;, &quot;IUF&quot;, &quot;CCTE_MUNDY&quot;, &quot;UTOR&quot;, &quot;VALA&quot;. By default, the
&quot;BSK&quot; (BioSeek) assay is removed.</p>
</td></tr>
<tr><td><code id="filter_groups_+3A_remove_groups">remove_groups</code></td>
<td>
<p>Vector of groups within the selected 'groupCol' to remove.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default category ('groupCol') is 'intended_target_family'. Depending
on the study, other categories may be more relevant. The best resource on these
groupings is the &quot;ToxCast Assay Annotation Data User Guide&quot;.
It defines &quot;intended_target_family&quot; as &quot;the target family of the
objective target for the assay&quot;. Much more detail can be discovered in that documentation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>end_point_info &lt;- end_point_info
cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
head(filtered_ep)
</code></pre>

<hr>
<h2 id='get_ACC'>Get the ACC values for a selection of chemicals</h2><span id='topic+get_ACC'></span>

<h3>Description</h3>

<p>The <code>get_ACC</code> function retrieves the activity concentration at cutoff
(ACC) values for specified chemicals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ACC(CAS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ACC_+3A_cas">CAS</code></td>
<td>
<p>Vector of CAS.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data used in toxEval were combined from files in the
&quot;INVITRODB_V3_LEVEL5&quot; directory that were included in the October 2018
release of the ToxCast database. The function <code>get_ACC</code> will
convert the ACC values in the ToxCast database from units of (log <code class="reqn">\mu</code>M)
to units of <code class="reqn">\mu</code>g/L, and reformat the data as input to toxEval.
</p>


<h3>Value</h3>

<p>data frame with columns CAS, chnm, flags, endPoint, ACC, MlWt, and ACC_value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CAS &lt;- c("121-00-6", "136-85-6", "80-05-7", "84-65-1", "5436-43-1", "126-73-8")
ACC &lt;- get_ACC(CAS)
head(ACC)
</code></pre>

<hr>
<h2 id='get_chemical_summary'>Compute EAR values</h2><span id='topic+get_chemical_summary'></span>

<h3>Description</h3>

<p>This function computes Exposure:Activity ratios using user-provided measured
concentration data from the output of <code><a href="#topic+create_toxEval">create_toxEval</a></code>,
and joins the data with the activity concentration at cutoff data provided by
ToxCast.Data from ToxCast is included with this package, but alternative
benchmark data can be provided to perform the same &quot;toxEval&quot; analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_chemical_summary(
  tox_list,
  ACC = NULL,
  filtered_ep = "All",
  chem_data = NULL,
  chem_site = NULL,
  chem_info = NULL,
  exclusion = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_chemical_summary_+3A_tox_list">tox_list</code></td>
<td>
<p>List with data frames for chem_data, chem_info, chem_site,
and optionally exclusions and benchmarks. Created with <code><a href="#topic+create_toxEval">create_toxEval</a></code>.</p>
</td></tr>
<tr><td><code id="get_chemical_summary_+3A_acc">ACC</code></td>
<td>
<p>Data frame with columns: CAS, chnm, endPoint, and ACC_value
for specific chemical/endpoint combinations generated using the
<code><a href="#topic+get_ACC">get_ACC</a></code> function. EndPoints with specific data quality flags
may optionally be removed using the <code><a href="#topic+remove_flags">remove_flags</a></code> function.</p>
</td></tr>
<tr><td><code id="get_chemical_summary_+3A_filtered_ep">filtered_ep</code></td>
<td>
<p>Data frame with columns: endPoints, groupCol. Default is <code>"All"</code>, where no
filtering occurs.</p>
</td></tr>
<tr><td><code id="get_chemical_summary_+3A_chem_data">chem_data</code></td>
<td>
<p><em>Optional</em> data frame with (at least) columns: CAS, SiteID, and Value. Default is <code>NULL</code>.
The argument will over-ride what is in tox_list.</p>
</td></tr>
<tr><td><code id="get_chemical_summary_+3A_chem_site">chem_site</code></td>
<td>
<p><em>Optional</em> data frame with (at least) columns: SiteID, and Short Name. Default is <code>NULL</code>.
The argument will over-ride what is in tox_list.</p>
</td></tr>
<tr><td><code id="get_chemical_summary_+3A_chem_info">chem_info</code></td>
<td>
<p><em>Optional</em> data frame with (at least) columns: CAS, and class. Default is <code>NULL</code>.
The argument will over-ride what is in tox_list.</p>
</td></tr>
<tr><td><code id="get_chemical_summary_+3A_exclusion">exclusion</code></td>
<td>
<p><em>Optional</em> data frame with (at least) columns: CAS and endPoint. Default is <code>NULL</code>.
The argument will over-ride what is in tox_list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To use the data provided by the package, a sample workflow is shown below
in the examples. The examples include retrieving the ToxCast (ACC) values
that are used to calculate EARs, choosing endPoints that should be ignored
based on data quality &quot;flags&quot; in the ToxCast database, and removing groups of
endPoints that may not be important to the analysis at hand.
</p>


<h3>Value</h3>

<p>a data frame with the columns: CAS, chnm (chemical name
as a factor), site, date, EAR, Bio_category, shortName (of site), Class. The output of this
function is where you find EAR values for every chemical/endpoint combination.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"
full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)

chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)
head(chemical_summary)
</code></pre>

<hr>
<h2 id='get_concentration_summary'>Create concentration summary</h2><span id='topic+get_concentration_summary'></span>

<h3>Description</h3>

<p>Use this function to create a chemical_summary, but instead
of using any benchmarks, the EAR column is simply
the concentration. The output of this function can be used
in any of the plotting or table functions in the same way
that the output of <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_concentration_summary(
  tox_list,
  chem_data = NULL,
  chem_site = NULL,
  chem_info = NULL,
  tox_names = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_concentration_summary_+3A_tox_list">tox_list</code></td>
<td>
<p>List with data frames for chem_data, chem_info, and chem_site.
Created with <code><a href="#topic+create_toxEval">create_toxEval</a></code>.</p>
</td></tr>
<tr><td><code id="get_concentration_summary_+3A_chem_data">chem_data</code></td>
<td>
<p><em>Optional</em> data frame with (at least) columns: CAS, SiteID, and Value. Default is <code>NULL</code>.
The argument will over-ride what is in tox_list.</p>
</td></tr>
<tr><td><code id="get_concentration_summary_+3A_chem_site">chem_site</code></td>
<td>
<p><em>Optional</em> data frame with (at least) columns: SiteID, and Short Name. Default is <code>NULL</code>.
The argument will over-ride what is in tox_list.</p>
</td></tr>
<tr><td><code id="get_concentration_summary_+3A_chem_info">chem_info</code></td>
<td>
<p><em>Optional</em> data frame with (at least) columns: CAS, and class. Default is <code>NULL</code>.
The argument will over-ride what is in tox_list.</p>
</td></tr>
<tr><td><code id="get_concentration_summary_+3A_tox_names">tox_names</code></td>
<td>
<p>Logical whether to use the provided chemical names from the ToxCast or not. If
there is not a match by CAS, the function will look for a column &quot;Chemical&quot; in the &quot;Chemical&quot;
tab. If that column doesn't exist, it will create a (not good!) name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with the columns: CAS, chnm (chemical name
as a factor), site, date, EAR (which is just concentration), Bio_category, shortName (of site), Class. The output of this
function is where you find EAR values for every chemical/endpoint combination.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"
full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

chemical_summary_conc &lt;- get_concentration_summary(tox_list)
head(chemical_summary_conc)
plot_tox_boxplots(chemical_summary_conc,
  category = "Chemical",
  x_label = "Concentration [ug/L]"
)
</code></pre>

<hr>
<h2 id='graph_chem_data'>Prepare boxplot data</h2><span id='topic+graph_chem_data'></span><span id='topic+tox_boxplot_data'></span><span id='topic+side_by_side_data'></span>

<h3>Description</h3>

<p>A set of functions to prepare the data for boxplots. Often, these
functions are used within the plotting functions. They are exported however
to allow custom graphs to be created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graph_chem_data(
  chemical_summary,
  ...,
  manual_remove = NULL,
  mean_logic = FALSE,
  sum_logic = TRUE
)

tox_boxplot_data(
  chemical_summary,
  category = "Biological",
  manual_remove = NULL,
  mean_logic = FALSE,
  sum_logic = TRUE
)

side_by_side_data(
  gd_left,
  gd_right,
  left_title = "Left",
  right_title = "Right"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graph_chem_data_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="graph_chem_data_+3A_...">...</code></td>
<td>
<p>Additional group_by arguments. This can be handy for creating facet graphs.</p>
</td></tr>
<tr><td><code id="graph_chem_data_+3A_manual_remove">manual_remove</code></td>
<td>
<p>Vector of categories to remove.</p>
</td></tr>
<tr><td><code id="graph_chem_data_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td></tr>
<tr><td><code id="graph_chem_data_+3A_sum_logic">sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="graph_chem_data_+3A_category">category</code></td>
<td>
<p>Character. Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="graph_chem_data_+3A_gd_left">gd_left</code></td>
<td>
<p>Data frame that must include the columns chnm, Class, and either EAR or meanEAR.</p>
</td></tr>
<tr><td><code id="graph_chem_data_+3A_gd_right">gd_right</code></td>
<td>
<p>Data frame that must include the columns chnm, Class, and either EAR or meanEAR.</p>
</td></tr>
<tr><td><code id="graph_chem_data_+3A_left_title">left_title</code></td>
<td>
<p>Character that will be associated with the &quot;gd_left&quot; data
frame in a column named &quot;guide_side&quot;.</p>
</td></tr>
<tr><td><code id="graph_chem_data_+3A_right_title">right_title</code></td>
<td>
<p>Character that will be associated with the &quot;gd_right&quot; data
frame in a column named &quot;guide_side&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function side_by_side_data will combine two data frames,
either the output of <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code> or <code><a href="#topic+graph_chem_data">graph_chem_data</a></code>,
into a single data frame. The important work here is that the chemicals
and classes factor levels are ordered primarily based on &quot;gd_left&quot;, but
include &quot;gd_right&quot; when the contents are mismatched.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"
full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)

chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)
# Let's say we want to compare 2 chemical summaries
# We'll look at one summing EARs, and with concentrations
# First, we need a chemical summary for concentrations:
chemical_summary_conc &lt;- get_concentration_summary(tox_list)

gd_tox &lt;- graph_chem_data(chemical_summary)
gd_conc &lt;- graph_chem_data(chemical_summary_conc)

ch_combo &lt;- side_by_side_data(gd_tox, gd_conc,
  left_title = "ToxCast",
  right_title = "Concentrations"
)
plot_chemical_boxplots(ch_combo, guide_side,
  x_label = ""
) +
  ggplot2::facet_grid(. ~ guide_side, scales = "free_x")
</code></pre>

<hr>
<h2 id='hits_by_groupings_DT'>Biological hits per category</h2><span id='topic+hits_by_groupings_DT'></span><span id='topic+hits_by_groupings'></span>

<h3>Description</h3>

<p>The <code>hits_by_groupings_DT</code> (DT option) and
<code>hits_by_groupings</code> (data frame option) functions create tables
with one row per category(&quot;Biological&quot;, &quot;Chemical&quot;, or &quot;Chemical Class&quot;).
The columns indicate the &quot;Biological&quot; groupings. The values in the table
signify how many sites have samples with EARs that exceeded the hit_threshold
for that particular &quot;Biological&quot;/category combination. If the user chooses
&quot;Biological&quot; as the category, it is a simple 2-column table of &quot;Biological&quot;
groupings and number of sites (nSites).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hits_by_groupings_DT(
  chemical_summary,
  category = "Biological",
  mean_logic = FALSE,
  sum_logic = TRUE,
  hit_threshold = 0.1
)

hits_by_groupings(
  chemical_summary,
  category,
  mean_logic = FALSE,
  sum_logic = TRUE,
  hit_threshold = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hits_by_groupings_DT_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="hits_by_groupings_DT_+3A_category">category</code></td>
<td>
<p>Character. Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="hits_by_groupings_DT_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical.  <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td></tr>
<tr><td><code id="hits_by_groupings_DT_+3A_sum_logic">sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="hits_by_groupings_DT_+3A_hit_threshold">hit_threshold</code></td>
<td>
<p>Numeric threshold defining a &quot;hit&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tables result in slightly different results for a single site, displaying
the number of samples with hits rather than the number of sites.
</p>


<h3>Value</h3>

<p>data frame with one row per category, and one column per Biological grouping.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is the example workflow:
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

site_df &lt;- hits_by_groupings(chemical_summary, category = "Biological")

hits_by_groupings_DT(chemical_summary, category = "Biological")
hits_by_groupings_DT(chemical_summary, category = "Chemical Class")
hits_by_groupings_DT(chemical_summary, category = "Chemical")

</code></pre>

<hr>
<h2 id='hits_summary_DT'>Summary of hits per site/category</h2><span id='topic+hits_summary_DT'></span><span id='topic+hits_summary'></span>

<h3>Description</h3>

<p>The <code>hits_summary_DT</code> (DT option) and <code>hits_summary</code> (data frame
option) functions create tables information on the number of
<code>hit_threshold</code> exceedances per site for each individual grouping. The
table has one row per group per site that has <code>hit_threshold</code>
exceedances. For example, if &quot;Biological&quot; is the category, and a
site has EAR levels above the specified <code>hit_threshold</code> for &quot;DNA
Binding&quot; and &quot;Nuclear Receptors&quot;, that site will have 2 rows of data in this
table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hits_summary_DT(
  chemical_summary,
  category = "Biological",
  sum_logic = TRUE,
  hit_threshold = 0.1
)

hits_summary(chemical_summary, category, hit_threshold = 0.1, sum_logic = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hits_summary_DT_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="hits_summary_DT_+3A_category">category</code></td>
<td>
<p>Character. Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="hits_summary_DT_+3A_sum_logic">sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="hits_summary_DT_+3A_hit_threshold">hit_threshold</code></td>
<td>
<p>Numeric threshold defining a &quot;hit&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each row, there are 4 columns. Site and category (as defined by the category
argument) define the row. &quot;Samples with hits&quot; are how many samples exceeded the
hit_threshold for the specified category at the specified site. &quot;Number of
Samples&quot; indicates how many samples were collected at an individual site
based on unique date.
</p>
<p>The tables contain slightly different results for evaluation of a single site.
There are three columns (the Site column is dropped), and rather than one row
per site/category, there is one row per category.
</p>


<h3>Value</h3>

<p>data frame with with one row per unique site/category combination. The columns
are site, category, Samples with Hits, and Number of Samples.
</p>
<p>data frame with columns &quot;Hits per Sample&quot;, &quot;Individual Hits&quot;,
&quot;nSample&quot;, &quot;site&quot;, and &quot;category&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is the example workflow:
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

stats_group &lt;- hits_summary(chemical_summary, "Biological")

hits_summary_DT(chemical_summary, category = "Biological")
hits_summary_DT(chemical_summary, category = "Chemical Class")
hits_summary_DT(chemical_summary, category = "Chemical")

</code></pre>

<hr>
<h2 id='make_tox_map'>Create an interactive map of the data</h2><span id='topic+make_tox_map'></span><span id='topic+map_tox_data'></span>

<h3>Description</h3>

<p>The function <code>make_tox_map</code> creates a <code><a href="leaflet.html#topic+leaflet">leaflet</a></code> map
of the sites. This function places symbols at the location of each site in the data
file that represent the magnitude of EAR (color) and the number of
samples in the data set (size). This is the only function that requires
&quot;dec_lon&quot; and &quot;dec_lat&quot; (decimal longitude and decimal latitude) in the
data frame specified for the chem_site argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_tox_map(
  chemical_summary,
  chem_site,
  category = "Biological",
  mean_logic = FALSE,
  sum_logic = TRUE
)

map_tox_data(
  chemical_summary,
  chem_site,
  category = "Biological",
  mean_logic = FALSE,
  sum_logic = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_tox_map_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="make_tox_map_+3A_chem_site">chem_site</code></td>
<td>
<p>Data frame containing the columns SiteID, site_grouping,
Short Name, dec_lon, and dec_lat.</p>
</td></tr>
<tr><td><code id="make_tox_map_+3A_category">category</code></td>
<td>
<p>Character. Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="make_tox_map_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical.  <code>TRUE</code> displays the mean EAR from each site,
<code>FALSE</code> displays the maximum EAR from each site.</p>
</td></tr>
<tr><td><code id="make_tox_map_+3A_sum_logic">sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>map_tox_data</code> calculates the statistics for the map. It
my be useful on it's own.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is the example workflow:
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)
tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

make_tox_map(chemical_summary, tox_list$chem_site, "Biological")
make_tox_map(chemical_summary, tox_list$chem_site, "Chemical Class")
make_tox_map(chemical_summary, tox_list$chem_site, "Chemical")

</code></pre>

<hr>
<h2 id='plot_chemical_boxplots'>Grouped Boxplots</h2><span id='topic+plot_chemical_boxplots'></span><span id='topic+plot_tox_boxplots'></span>

<h3>Description</h3>

<p>The <code>plot_tox_boxplots</code> function creates a set of boxplots representing EAR
values computed with the <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code> function, and
dependent on the choice of several input options. See &quot;Summarizing the data&quot;
in the Introduction vignette: <a href="../doc/Introduction.html#summarize_data"><code>vignette("Introduction", package = "toxEval")</code></a>.
for a description of how the EAR values are computed, aggregated,
and summarized. Choosing &quot;Chemical Class&quot; in the category argument
will generate separate boxplots for each unique class. &quot;Chemical&quot; will generate
boxplots for each individual chemical, and &quot;Biological&quot; will generate boxplots
for each group in the selected ToxCast annotation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_chemical_boxplots(
  chemical_summary,
  ...,
  manual_remove = NULL,
  mean_logic = FALSE,
  sum_logic = TRUE,
  plot_ND = TRUE,
  font_size = NA,
  title = NA,
  x_label = NA,
  palette = NA,
  hit_threshold = NA,
  site_counts = "count"
)

plot_tox_boxplots(
  chemical_summary,
  category = "Biological",
  manual_remove = NULL,
  mean_logic = FALSE,
  sum_logic = TRUE,
  plot_ND = TRUE,
  font_size = NA,
  title = NA,
  x_label = NA,
  palette = NA,
  hit_threshold = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_chemical_boxplots_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_...">...</code></td>
<td>
<p>Additional group_by arguments. This can be handy for creating facet graphs.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_manual_remove">manual_remove</code></td>
<td>
<p>Vector of categories to remove.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_sum_logic">sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_plot_nd">plot_ND</code></td>
<td>
<p>Logical. Whether or not to plot &quot;Biological&quot; groupings,
&quot;Chemical Class&quot; groupings, or &quot;Chemical&quot; that do not have any detections.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_font_size">font_size</code></td>
<td>
<p>Numeric value to adjust the axis font size.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_title">title</code></td>
<td>
<p>Character title for plot. Default is NA which produces no title.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_x_label">x_label</code></td>
<td>
<p>Character for x label. Default is NA which produces an automatic label.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_palette">palette</code></td>
<td>
<p>Vector of color palette for boxplot fill. Can be a named vector
to specify specific colors for specific categories.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_hit_threshold">hit_threshold</code></td>
<td>
<p>Numeric threshold defining a &quot;hit&quot;.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_site_counts">site_counts</code></td>
<td>
<p>This describes how to calculate the left-side counts.
Default is &quot;count&quot; which is number of sites with detections. &quot;frequency&quot; 
would calculate a percentage of detections. This assumes all 
non-detects have been included as 0 for a value. &quot;none&quot; is the
final option which can be to remove those labels. Custom labels
could then be constructed after this function is run.</p>
</td></tr>
<tr><td><code id="plot_chemical_boxplots_+3A_category">category</code></td>
<td>
<p>Character. Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is also possible to display a threshold line using the hit_threshold argument.
The graph will then include the number of sites with detections, the threshold
line, and the number of &quot;hits&quot; indicating how many sites that have EAR values
exceeding the hit_threshold.
</p>
<p>The graph shows a slightly different result for a single site. For a single
site graph, the number of chemicals that were detected and have associated endpoint
ACCs represented are displayed.
</p>
<p>The functions <code>plot_tox_boxplots</code> and <code>graph_chem_data</code> are functions that perform
the statistical calculations to create the plot. <code>graph_chem_data</code> is specific
to the &quot;Chemical&quot; plot, and <code>plot_tox_boxplots</code> is for &quot;Biological&quot; and
&quot;Chemical Class&quot;.
</p>
<p>Box plots are standard Tukey representations. See &quot;Box plot details&quot; in the Basic Workflow vignette:
<a href="../doc/basicWorkflow.html#box_plot_details"><code>vignette("basicWorkflow", package = "toxEval")</code></a>
for more information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is the example workflow:
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)
ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)
plot_tox_boxplots(chemical_summary, "Biological")


plot_tox_boxplots(chemical_summary, "Chemical Class")
plot_tox_boxplots(chemical_summary, "Chemical")


cbPalette &lt;- c(
  "#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442",
  "#0072B2", "#D55E00", "#CC79A7"
)
graphData &lt;- tox_boxplot_data(
  chemical_summary = chemical_summary,
  category = "Biological"
)
cbValues &lt;- colorRampPalette(cbPalette)(length(levels(graphData$category)))
names(cbValues) &lt;- levels(graphData$category)

plot_tox_boxplots(chemical_summary,
  hit_threshold = 0.1,
  category = "Biological",
  palette = cbValues,
  title = "Maximum EAR per site, grouped by biological activity groupings"
)

plot_tox_boxplots(chemical_summary,
  category = "Chemical", x_label = "EAR"
)
single_site &lt;- dplyr::filter(chemical_summary, site == "USGS-04024000")
plot_tox_boxplots(single_site,
  category = "Biological"
)
plot_tox_boxplots(single_site,
  category = "Chemical", hit_threshold = 0.001
)

</code></pre>

<hr>
<h2 id='plot_tox_endpoints'>EndPoint boxplots</h2><span id='topic+plot_tox_endpoints'></span>

<h3>Description</h3>

<p>The <code>plot_tox_endpoints</code> function creates a set of boxplots representing EAR
values for each endPoint based on the selected data. A subset of data is first
chosen by specifying a group in the filterBy argument. The
filterBy argument must match one of the unique options in the category.
For example, if the category is &quot;Chemical Class&quot;, then the filterBy argument
must be one of the defined &quot;Chemical Class&quot; options such as &quot;Herbicide&quot;.
A boxplot is generated for each endPoint. The EAR values that are used to
create the boxplots are the mean or maximum (as defined by mean_logic) for each
site as described in &quot;Summarizing the data&quot;in the Introduction vignette:
<a href="../doc/Introduction.html#summarize_data"><code>vignette("Introduction", package = "toxEval")</code></a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_tox_endpoints(
  chemical_summary,
  category = "Biological",
  filterBy = "All",
  manual_remove = NULL,
  hit_threshold = NA,
  mean_logic = FALSE,
  sum_logic = TRUE,
  font_size = NA,
  title = NA,
  x_label = NA,
  palette = NA,
  top_num = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_tox_endpoints_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_category">category</code></td>
<td>
<p>Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_filterby">filterBy</code></td>
<td>
<p>Character. Either &quot;All&quot; or one of the filtered categories.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_manual_remove">manual_remove</code></td>
<td>
<p>Vector of categories to remove.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_hit_threshold">hit_threshold</code></td>
<td>
<p>Numeric threshold defining a &quot;hit&quot;.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_sum_logic">sum_logic</code></td>
<td>
<p>logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_font_size">font_size</code></td>
<td>
<p>Numeric to adjust the axis font size.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_title">title</code></td>
<td>
<p>Character title for plot.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_x_label">x_label</code></td>
<td>
<p>Character for x label. Default is NA which produces an automatic label.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_palette">palette</code></td>
<td>
<p>Vector of color palette for fill. Can be a named vector
to specify specific color for specific categories.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints_+3A_top_num">top_num</code></td>
<td>
<p>Integer number of endpoints to include in the graph. If NA, all
endpoints will be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Box plots are standard Tukey representations. See &quot;Box plot details&quot; in the Basic Workflow vignette:
<a href="../doc/basicWorkflow.html#box_plot_details"><code>vignette("basicWorkflow", package = "toxEval")</code></a>
for more information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is the example workflow:
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)
ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

plot_tox_endpoints(chemical_summary,
  filterBy = "Cell Cycle",
  top_num = 10
)

plot_tox_endpoints(chemical_summary,
  filterBy = "Cell Cycle",
  top_num = 10,
  x_label = "EAR"
)

plot_tox_endpoints(chemical_summary,
  category = "Chemical Class", filterBy = "PAHs",
  top_num = 10, hit_threshold = 0.001
)

plot_tox_endpoints(chemical_summary, category = "Chemical", filterBy = "Atrazine")
plot_tox_endpoints(chemical_summary, category = "Chemical", top_num = 10)
single_site &lt;- dplyr::filter(chemical_summary, site == "USGS-04024000")
plot_tox_endpoints(single_site, category = "Chemical", top_num = 10)

</code></pre>

<hr>
<h2 id='plot_tox_endpoints2'>EndPoint boxplots with faceting option</h2><span id='topic+plot_tox_endpoints2'></span>

<h3>Description</h3>

<p>The <code>plot_tox_endpoints2</code> function creates a set of boxplots representing EAR
values for each endPoint based on the selected data. A subset of data is first
chosen by specifying a group in the <code>filterBy</code> argument. The
<code>filterBy</code> argument must match one of the unique options in the category.
For example, if the category is &quot;Chemical Class&quot;, then the <code>filterBy</code> argument
must be one of the defined &quot;Chemical Class&quot; options such as &quot;Herbicide&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_tox_endpoints2(
  cs,
  ...,
  category = "Chemical",
  filterBy = "All",
  manual_remove = NULL,
  hit_threshold = NA,
  mean_logic = FALSE,
  sum_logic = TRUE,
  font_size = NA,
  title = NA,
  x_label = NA,
  palette = NA,
  top_num = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_tox_endpoints2_+3A_cs">cs</code></td>
<td>
<p>Data.frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_...">...</code></td>
<td>
<p>Additional group_by arguments. This can be handy for creating facet graphs.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_category">category</code></td>
<td>
<p>Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_filterby">filterBy</code></td>
<td>
<p>Character. Either &quot;All&quot; or one of the filtered categories.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_manual_remove">manual_remove</code></td>
<td>
<p>Vector of categories to remove.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_hit_threshold">hit_threshold</code></td>
<td>
<p>Numeric threshold defining a &quot;hit&quot;.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_sum_logic">sum_logic</code></td>
<td>
<p>logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_font_size">font_size</code></td>
<td>
<p>Numeric to adjust the axis font size.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_title">title</code></td>
<td>
<p>Character title for plot.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_x_label">x_label</code></td>
<td>
<p>Character for x label. Default is NA which produces an automatic label.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_palette">palette</code></td>
<td>
<p>Vector of color palette for fill. Can be a named vector
to specify specific color for specific categories.</p>
</td></tr>
<tr><td><code id="plot_tox_endpoints2_+3A_top_num">top_num</code></td>
<td>
<p>Integer number of endpoints to include in the graph. If NA, all
endpoints will be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The difference between this function and the
<code><a href="#topic+plot_tox_endpoints">plot_tox_endpoints</a></code> is that
the ... arguments allow for customized faceting. To include this in
the original toxEval function, backward compatibility would be broken.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)
ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
cs &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)
cs$guide_side &lt;- "A"

cs2 &lt;- cs
cs2$guide_side &lt;- "B"

cs_double &lt;- rbind(cs, cs2)

plot_tox_endpoints2(cs_double, guide_side,
  top_num = 10
) +
  ggplot2::facet_grid(. ~ guide_side, scales = "free_x")

</code></pre>

<hr>
<h2 id='plot_tox_heatmap'>Plot EAR heat maps</h2><span id='topic+plot_tox_heatmap'></span>

<h3>Description</h3>

<p>The <code>plot_tox_heatmap</code> function creates a heat (tile) map with sites on the x-axis,
a specified grouping on the y-axis (defined by the category argument), and color shading
defining the mean or maximum EAR. See &quot;Summarizing the data&quot; in the Introduction vignette:
<a href="../doc/Introduction.html#summarize_data"><code>vignette("Introduction", package = "toxEval")</code></a> for a description on how the
EAR values are computed, aggregated, and summarized. The y-axis grouping can be &quot;Biological&quot;,
&quot;Chemical Class&quot;, or &quot;Chemical&quot;. When specifying the &quot;Chemical&quot; option, a secondary y-axis
is automatically included to group chemicals into chemical class. The function computes
default breaks for the color scale to match the spread of the data, but breaks can also
be customized with the breaks argument.
This is a function where it may be ideal to create a custom order to the sites
(for example, west-to-east). See the above section &quot;Custom configuration&quot;
<a href="../doc/Introduction.html#custom_config"><code>vignette("Introduction", package = "toxEval")</code></a> for instructions on how to convert
the character vector sites to a factor with ordered levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_tox_heatmap(
  chemical_summary,
  chem_site,
  category = "Biological",
  breaks = c(1e-05, 1e-04, 0.001, 0.01, 0.1, 1, 10),
  manual_remove = NULL,
  mean_logic = FALSE,
  sum_logic = TRUE,
  plot_ND = TRUE,
  font_size = NA,
  title = NA,
  legend_lab = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_tox_heatmap_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_chem_site">chem_site</code></td>
<td>
<p>Data frame with columns SiteID, site_grouping, and Short Name.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_category">category</code></td>
<td>
<p>Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_breaks">breaks</code></td>
<td>
<p>Numerical vector to define data bins and legend breaks.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_manual_remove">manual_remove</code></td>
<td>
<p>Vector of categories to remove.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical.  <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_sum_logic">sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_plot_nd">plot_ND</code></td>
<td>
<p>Logical. Whether or not to plot &quot;Biological&quot; groupings,
&quot;Chemical Class&quot; groupings, or &quot;Chemical&quot; that do not have any detections.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_font_size">font_size</code></td>
<td>
<p>Numeric value to adjust the axis font size.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_title">title</code></td>
<td>
<p>Character title for plot.</p>
</td></tr>
<tr><td><code id="plot_tox_heatmap_+3A_legend_lab">legend_lab</code></td>
<td>
<p>Character label for legend. Default is NA which produces an automatic label.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there are site/parameters (chemical/chemical class/biological grouping) combinations that
don't have data, those areas are represented by an &quot;X&quot;. If there are 0 values,
they are considered &quot;non-detects&quot;, and represented with a distinct color.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"
full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)

chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

# Order the site_groupings:
tox_list$chem_site$site_grouping &lt;- factor(tox_list$chem_site$site_grouping,
  levels = c(
    "Lake Superior",
    "Lake Michigan",
    "Lake Huron",
    "Lake Erie",
    "Lake Ontario"
  )
)

# Order sites:
sitesOrdered &lt;- c(
  "StLouis", "Nemadji", "WhiteWI", "Bad", "Montreal",
  "PresqueIsle", "Ontonagon", "Sturgeon", "Tahquamenon", "Burns",
  "IndianaHC", "StJoseph", "PawPaw", "Kalamazoo", "GrandMI",
  "Milwaukee", "Muskegon", "WhiteMI", "PereMarquette", "Manitowoc",
  "Manistee", "Fox", "Oconto", "Peshtigo", "Menominee",
  "Indian", "Cheboygan", "Ford", "Escanaba", "Manistique",
  "ThunderBay", "AuSable", "Rifle", "Saginaw", "BlackMI",
  "Clinton", "Rouge", "HuronMI", "Raisin", "Maumee",
  "Portage", "Sandusky", "HuronOH", "Vermilion", "BlackOH",
  "Rocky", "Cuyahoga", "GrandOH", "Cattaraugus", "Tonawanda",
  "Genesee", "Oswego", "BlackNY", "Oswegatchie", "Grass",
  "Raquette", "StRegis"
)

tox_list$chem_site$`Short Name` &lt;- factor(tox_list$chem_site$`Short Name`,
  levels = sitesOrdered
)

plot_tox_heatmap(chemical_summary, 
                 tox_list$chem_site,
                 category = "Chemical Class")
              
plot_tox_heatmap(chemical_summary,
                 tox_list$chem_site,
                 category = "Chemical",
                 legend_lab = "EAR"
)

single_site &lt;- dplyr::filter(chemical_summary, site == "USGS-04024000")

plot_tox_heatmap(
  chemical_summary = single_site,
  chem_site = dplyr::filter(tox_list$chem_site, 
                            SiteID == "USGS-04024000"),
  category = "Chemical Class"
)
plot_tox_heatmap(
  chemical_summary = single_site,
  chem_site = dplyr::filter(tox_list$chem_site, SiteID == "USGS-04024000"),
  category = "Chemical"
)

</code></pre>

<hr>
<h2 id='plot_tox_stacks'>Plot stacked bar charts</h2><span id='topic+plot_tox_stacks'></span>

<h3>Description</h3>

<p>The <code>plot_tox_stacks</code> function creates a set of boxplots representing EAR
values computed with the <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code> function, and
dependent on the choice of several input options. See &quot;Summarizing the data&quot;
in the Introduction vignette: <a href="../doc/Introduction.html#summarize_data"><code>vignette("Introduction", package = "toxEval")</code></a>
for a description on how the EAR values are computed, aggregated, and summarized.
Choosing &quot;Chemical Class&quot; in the category argument will generate separate stacked
bars for each unique class. &quot;Chemical&quot; will generate stacked bars for each individual
chemical, and &quot;Biological&quot; will generate stacked bars for each group in the selected
ToxCast annotation. The legend can optionally be turned on or off using the
include_legend argument. It may be impractical for instance to show the
legend for &quot;Chemical&quot; if there are hundreds of chemicals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_tox_stacks(
  chemical_summary,
  chem_site,
  category = "Biological",
  mean_logic = FALSE,
  sum_logic = TRUE,
  manual_remove = NULL,
  include_legend = TRUE,
  font_size = NA,
  title = NA,
  y_label = NA,
  top_num = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_tox_stacks_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_chem_site">chem_site</code></td>
<td>
<p>Data frame with at least columns SiteID, site_grouping, and Short Name.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_category">category</code></td>
<td>
<p>Character. Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_sum_logic">sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_manual_remove">manual_remove</code></td>
<td>
<p>Vector of categories to remove.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_include_legend">include_legend</code></td>
<td>
<p>Logical. Used to include legend or not.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_font_size">font_size</code></td>
<td>
<p>Numeric value to adjust the axis font size.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_title">title</code></td>
<td>
<p>Character title for plot.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_y_label">y_label</code></td>
<td>
<p>Character for x label. Default is NA which produces an automatic label.</p>
</td></tr>
<tr><td><code id="plot_tox_stacks_+3A_top_num">top_num</code></td>
<td>
<p>Integer number to include in the graph. If NA, all
data will be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The graph displays a slightly different result for a single site. Providing
data with only one site displays each individual sample as a stacked bar
rather than the mean or maximum for a site.
</p>
<p>This is a function where it may be ideal to create a custom order to the sites
(for example, west-to-east). See the above section &quot;Custom configuration&quot;
<a href="../doc/Introduction.html#custom_config"><code>vignette("Introduction", package = "toxEval")</code></a> for instructions on how to convert
the character vector sites to a factor with ordered levels.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is the example workflow:
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

plot_tox_stacks(chemical_summary, tox_list$chem_site, "Biological")


plot_tox_stacks(chemical_summary, tox_list$chem_site, "Chemical Class")
plot_tox_stacks(chemical_summary, tox_list$chem_site, "Chemical", include_legend = FALSE)
plot_tox_stacks(chemical_summary, tox_list$chem_site, "Chemical", top_num = 5, y_label = "EAR")

single_site &lt;- dplyr::filter(chemical_summary, site == "USGS-04024000")
plot_tox_stacks(single_site, tox_list$chem_site, "Chemical", top_num = 5)
plot_tox_stacks(single_site,
  chem_site = tox_list$chem_site,
  category = "Chemical", top_num = 5, y_label = "EAR"
)

</code></pre>

<hr>
<h2 id='rank_sites_DT'>Rank sites by EAR</h2><span id='topic+rank_sites_DT'></span><span id='topic+rank_sites'></span>

<h3>Description</h3>

<p>The <code>rank_sites_DT</code> (DT option) and <code>rank_sites</code> (data frame option) functions
create tables with one row per site. Columns represent the maximum or mean EAR
(depending on the mean_logic argument) for each category (&quot;Chemical Class&quot;,
&quot;Chemical&quot;, or &quot;Biological&quot;) and the frequency of the maximum or mean EAR
exceeding a user specified hit_threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank_sites_DT(
  chemical_summary,
  category = "Biological",
  mean_logic = FALSE,
  sum_logic = TRUE,
  hit_threshold = 0.1
)

rank_sites(
  chemical_summary,
  category,
  hit_threshold = 0.1,
  mean_logic = FALSE,
  sum_logic = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rank_sites_DT_+3A_chemical_summary">chemical_summary</code></td>
<td>
<p>Data frame from <code><a href="#topic+get_chemical_summary">get_chemical_summary</a></code>.</p>
</td></tr>
<tr><td><code id="rank_sites_DT_+3A_category">category</code></td>
<td>
<p>Character. Either &quot;Biological&quot;, &quot;Chemical Class&quot;, or &quot;Chemical&quot;.</p>
</td></tr>
<tr><td><code id="rank_sites_DT_+3A_mean_logic">mean_logic</code></td>
<td>
<p>Logical.  <code>TRUE</code> displays the mean sample from each site,
<code>FALSE</code> displays the maximum sample from each site.</p>
</td></tr>
<tr><td><code id="rank_sites_DT_+3A_sum_logic">sum_logic</code></td>
<td>
<p>Logical. <code>TRUE</code> sums the EARs in a specified grouping,
<code>FALSE</code> does not. <code>FALSE</code> may be better for traditional benchmarks as
opposed to ToxCast benchmarks.</p>
</td></tr>
<tr><td><code id="rank_sites_DT_+3A_hit_threshold">hit_threshold</code></td>
<td>
<p>Numeric threshold defining a &quot;hit&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tables show slightly different results for a single site. Rather than multiple
columns for categories, there is now 1 row per category (since the site is known).
</p>


<h3>Value</h3>

<p>data frame with one row per site, and the mas or mean EAR and frequency of
hits based on the category.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is the example workflow:
path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"

full_path &lt;- file.path(path_to_tox, file_name)

tox_list &lt;- create_toxEval(full_path)

ACC &lt;- get_ACC(tox_list$chem_info$CAS)
ACC &lt;- remove_flags(ACC)

cleaned_ep &lt;- clean_endPoint_info(end_point_info)
filtered_ep &lt;- filter_groups(cleaned_ep)
chemical_summary &lt;- get_chemical_summary(tox_list, ACC, filtered_ep)

stats_df &lt;- rank_sites(chemical_summary, "Biological")

rank_sites_DT(chemical_summary, category = "Biological")
rank_sites_DT(chemical_summary, category = "Chemical Class")
rank_sites_DT(chemical_summary, category = "Chemical")

</code></pre>

<hr>
<h2 id='remove_flags'>Remove endpoints with specific data quality flags from data</h2><span id='topic+remove_flags'></span>

<h3>Description</h3>

<p>Through the ToxCast program quality assurance procedures, information
is examined and at times, it is necessary to assign a data quality flag
to a specific chemical/assay result. A toxEval user may want to include
or exclude assay results with certain flags depending on the objectives
of a given study. Assay results with specific data quality flags assigned
to them can be removed based on their designated flag with the
<code>remove_flags</code> function. The flags included in ToxCast, and the associated
flagsShort value (used in the remove_flags function) are as follows:
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Flag</strong> </td><td style="text-align: left;"> <strong>flagsShort</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
Borderline active* </td><td style="text-align: left;"> Borderline* </td>
</tr>
<tr>
 <td style="text-align: left;">
Only highest conc above baseline, active* </td><td style="text-align: left;"> OnlyHighest* </td>
</tr>
<tr>
 <td style="text-align: left;">
Only one conc above baseline, active </td><td style="text-align: left;"> OneAbove </td>
</tr>
<tr>
 <td style="text-align: left;">
Noisy data </td><td style="text-align: left;"> Noisy </td>
</tr>
<tr>
 <td style="text-align: left;">
Hit-call potentially confounded by overfitting </td><td style="text-align: left;"> HitCall </td>
</tr>
<tr>
 <td style="text-align: left;">
Gain AC50 &lt; lowest conc &amp; loss AC50 &lt; mean conc* </td><td style="text-align: left;"> GainAC50* </td>
</tr>
<tr>
 <td style="text-align: left;">
Biochemical assay with &lt; 50% efficacy* </td><td style="text-align: left;"> Biochemical* </td>
</tr>
<tr>
 <td style="text-align: left;">
Less than 50% efficacy </td><td style="text-align: left;"> LessThan50 </td>
</tr>
<tr>
 <td style="text-align: left;">
AC50 less than lowest concentration tested* </td><td style="text-align: left;"> ACCLessThan* </td>
</tr>
<tr>
 <td style="text-align: left;">
GNLSmodel </td><td style="text-align: left;"> GNLSmodel </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Asterisks indicate flags removed in the function as default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_flags(
  ACC,
  flagsShort = c("Borderline", "OnlyHighest", "GainAC50", "Biochemical", "ACCLessThan")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_flags_+3A_acc">ACC</code></td>
<td>
<p>data frame with columns: casn, chnm, endPoint, and ACC_value</p>
</td></tr>
<tr><td><code id="remove_flags_+3A_flagsshort">flagsShort</code></td>
<td>
<p>vector of flags to to trigger REMOVAL of chemical:endPoint
combination. Possible values are &quot;Borderline&quot;, &quot;OnlyHighest&quot;, &quot;OneAbove&quot;,
&quot;Noisy&quot;, &quot;HitCall&quot;, &quot;GainAC50&quot;, &quot;Biochemical&quot;,&quot;LessThan50&quot;,&quot;ACCLessThan&quot;,&quot;GNLSmodel&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>CAS &lt;- c("121-00-6", "136-85-6", "80-05-7", "84-65-1", "5436-43-1", "126-73-8")
ACC &lt;- get_ACC(CAS)
nrow(ACC)
ACC &lt;- remove_flags(ACC)
nrow(ACC)
</code></pre>

<hr>
<h2 id='summary.toxEval'>Summary of tox_list</h2><span id='topic+summary.toxEval'></span>

<h3>Description</h3>

<p>A &quot;tox_list&quot; object is created from <code>create_toxEval</code>. It
is a list of  5 data frames: chem_data, chem_info,
chem_site, exclusions, and benchmarks. This function returns
a message with how many chemicals have ToxCast information,
and returns a vector of which chemicals do not have ToxCast information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'toxEval'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.toxEval_+3A_object">object</code></td>
<td>
<p>toxEval object with &quot;chem_info&quot; data frame included.</p>
</td></tr>
<tr><td><code id="summary.toxEval_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>path_to_tox &lt;- system.file("extdata", package = "toxEval")
file_name &lt;- "OWC_data_fromSup.xlsx"
excel_file_path &lt;- file.path(path_to_tox, file_name)
tox_list &lt;- create_toxEval(excel_file_path)
summary(tox_list)
</code></pre>

<hr>
<h2 id='tox_chemicals'>ToxCast Chemical Information</h2><span id='topic+tox_chemicals'></span>

<h3>Description</h3>

<p>Downloaded from the CompTox database on October 2022.
<a href="https://comptox.epa.gov/dashboard/">https://comptox.epa.gov/dashboard/</a>. Additional columns were
added based on the information from the &quot;INVITRODB_V3_5_LEVEL5&quot; data.
</p>


<h3>Value</h3>

<p>data frame with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
Column </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
DSSTox_Substance_Id </td><td style="text-align: left;"> DSSTox_Substance_Id</td>
</tr>
<tr>
 <td style="text-align: left;">
Substance_Name </td><td style="text-align: left;"> Commen chemical name </td>
</tr>
<tr>
 <td style="text-align: left;">
Structure_MolWt </td><td style="text-align: left;"> Molecular weight </td>
</tr>
<tr>
 <td style="text-align: left;">
DTXCID </td><td style="text-align: left;"> DTXCID</td>
</tr>
<tr>
 <td style="text-align: left;">
Substance_CASRN </td><td style="text-align: left;"> CASRN </td>
</tr>
<tr>
 <td style="text-align: left;">
INCHIKEY </td><td style="text-align: left;"> INCHIKEY</td>
</tr>
<tr>
 <td style="text-align: left;">
SMILES </td><td style="text-align: left;"> SMILES</td>
</tr>
<tr>
 <td style="text-align: left;">
Total_tested </td><td style="text-align: left;"> Total number of ToxCast assays tested</td>
</tr>
<tr>
 <td style="text-align: left;">
Active </td><td style="text-align: left;"> Number of ToxCast assays flagged as active </td>
</tr>
<tr>
 <td style="text-align: left;">
min_concentration </td><td style="text-align: left;"> Minimum concentration tested in ToxCast (ug/L) </td>
</tr>
<tr>
 <td style="text-align: left;">
max_concentration </td><td style="text-align: left;"> Maximum concentration tested in ToxCast (ug/L) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>data frame with columns:
&quot;Substance_Name&quot;,&quot;Substance_CASRN&quot;,
&quot;Structure_MolWt&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(tox_chemicals)
</code></pre>

<hr>
<h2 id='ToxCast_ACC'>ACC values included with toxEval.</h2><span id='topic+ToxCast_ACC'></span>

<h3>Description</h3>

<p>Downloaded on October 2022 from ToxCast. The data were
combined from files in the &quot;INVITRODB_V3_5_LEVEL5&quot; folder.
At the time of toxEval package release, this information was found:
<a href="https://www.epa.gov/comptox-tools/exploring-toxcast-data">https://www.epa.gov/comptox-tools/exploring-toxcast-data</a>
in the &quot;ToxCast &amp; Tox21 Data Spreadsheet&quot; data set.
ACC values are the in the &quot;ACC&quot; column (winning model) and units are
log micro-Molarity (log <code class="reqn">\mu</code>M).
</p>


<h3>Value</h3>

<p>data frame with columns CAS, chnm (chemical name), flags, endPoint, and ACC (value).
</p>


<h3>Source</h3>

<p><a href="https://www.epa.gov/comptox-tools/exploring-toxcast-data">https://www.epa.gov/comptox-tools/exploring-toxcast-data</a>
</p>


<h3>References</h3>

<p>Toxicology, EPA's National Center for Computational (2020):
ToxCast and Tox21 Data Spreadsheet. figshare. Dataset.
<a href="https://doi.org/10.23645/epacomptox.6062479.v3">doi:10.23645/epacomptox.6062479.v3</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(ToxCast_ACC)
</code></pre>

<hr>
<h2 id='toxEval-package'>Analyze ToxCast data in relation to measured concentrations.</h2><span id='topic+toxEval'></span><span id='topic+toxEval-package'></span>

<h3>Description</h3>

<p><code>toxEval</code> includes a set of functions to analyze, visualize, and
organize measured concentration data as it relates to ToxCast data
(default) or other user-selected chemical-biological interaction
benchmark data such as water quality criteria. The intent of
these analyses is to develop a better understanding of the potential
biological relevance of environmental chemistry data. Results can
be used to prioritize which chemicals at which sites may be of
greatest concern. These methods are meant to be used as a screening
technique to predict potential for biological influence from chemicals
that ultimately need to be validated with direct biological assays.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> toxEval</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Unlimited for this package, dependencies have more restrictive licensing.</td>
</tr>
<tr>
 <td style="text-align: left;">
Copyright: </td><td style="text-align: left;"> This software is in the public domain because it contains materials
that originally came from the United States Geological Survey, an agency of
the United States Department of Interior. For more information, see the
official USGS copyright policy at
https://www.usgs.gov/visual-id/credit_usgs.html#copyright</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Laura De Cicco <a href="mailto:ldecicco@usgs.gov">ldecicco@usgs.gov</a>. Steven Corsi
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li><p> Report bugs at <a href="https://github.com/DOI-USGS/toxEval/issues">https://github.com/DOI-USGS/toxEval/issues</a>
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
