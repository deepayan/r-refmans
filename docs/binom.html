<!DOCTYPE html><html><head><title>Help for package binom</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {binom}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#binom-internal'><p>Internal binom functions</p></a></li>
<li><a href='#binom.bayes'><p>Binomial confidence intervals using Bayesian inference</p></a></li>
<li><a href='#binom.cloglog'><p>Binomial confidence intervals using the cloglog parameterization</p></a></li>
<li><a href='#binom.confint'><p>Binomial confidence intervals</p></a></li>
<li><a href='#binom.coverage'><p>Probability coverage for binomial confidence intervals</p></a></li>
<li><a href='#binom.length'><p>Expected length for binomial confidence intervals</p></a></li>
<li><a href='#binom.logit'><p>Binomial confidence intervals using the logit parameterization</p></a></li>
<li><a href='#binom.lrt'><p>Binomial confidence intervals using the lrt likelihood</p></a></li>
<li><a href='#binom.optim'><p>Optimal binomial confidence intervals</p></a></li>
<li><a href='#binom.plot'><p>Coverage plots for binomial confidence intervals</p></a></li>
<li><a href='#binom.power'><p>Power curves for binomial parameterizations</p></a></li>
<li><a href='#binom.probit'><p>Binomial confidence intervals using the probit parameterization</p></a></li>
<li><a href='#binom.profile'><p>Binomial confidence intervals using the profile likelihood</p></a></li>
<li><a href='#binom.sim'><p>Simulates confidence intervals for binomial data</p></a></li>
<li><a href='#cloglog.sample.size'><p>Power and sample size</p></a></li>
<li><a href='#tkbinom.power'><p>Power curves for binomial parameterizations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Binomial Confidence Intervals for Several Parameterizations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2014-01-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Sundar Dorai-Raj &lt;sundar.dorai-raj@pdf.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Constructs confidence intervals on the probability of
        success in a binomial experiment via several parameterizations.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sundar Dorai-Raj &lt;sdorairaj@gmail.com&gt;</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lattice, polynom, tcltk, ggplot2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-02 10:19:37 UTC; hornik</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-02 13:01:46 UTC</td>
</tr>
</table>
<hr>
<h2 id='binom-internal'>Internal binom functions</h2><span id='topic+var.asymp'></span><span id='topic+var.cloglog'></span><span id='topic+var.logit'></span><span id='topic+var.probit'></span><span id='topic+ldbinom'></span>

<h3>Description</h3>

<p>Internal functions for binom package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var.asymp(p, n = 1)
var.cloglog(p, n = 1)
var.logit(p, n = 1)
var.probit(p, n = 1)
ldbinom(x, size, prob, log = TRUE)
</code></pre>


<h3>Details</h3>

<p>Internal functions for binom package.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>

<hr>
<h2 id='binom.bayes'>Binomial confidence intervals using Bayesian inference</h2><span id='topic+binom.bayes'></span><span id='topic+binom.bayes.densityplot'></span>

<h3>Description</h3>

<p>Uses a beta prior on the probability of success for a binomial
distribution, determines a two-sided confidence interval from a beta
posterior. A plotting function is also provided to show the
probability regions defined by each confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.bayes(x, n,
            conf.level = 0.95,
            type = c("highest", "central"),
            prior.shape1 = 0.5,
            prior.shape2 = 0.5,
            tol = .Machine$double.eps^0.5,
            maxit = 1000, ...)

binom.bayes.densityplot(bayes,
                        npoints = 500,
                        fill.central = "lightgray",
                        fill.lower = "steelblue",
                        fill.upper = fill.lower,
                        alpha = 0.8, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.bayes_+3A_x">x</code></td>
<td>
<p>Vector of number of successes in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence interval.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_type">type</code></td>
<td>
<p>The type of confidence interval (see Details).</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_prior.shape1">prior.shape1</code></td>
<td>
<p>The value of the first shape parameter to be used in the prior beta.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_prior.shape2">prior.shape2</code></td>
<td>
<p>The value of the second shape parameter to be used in the prior beta.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_tol">tol</code></td>
<td>
<p>A tolerance to be used in determining the highest probability density interval.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations to be used in determining
the highest probability interval.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_bayes">bayes</code></td>
<td>
<p>The output <code>data.frame</code> from <code>binom.bayes</code>.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_npoints">npoints</code></td>
<td>
<p>The number of points to use to draw the density
curves. Higher numbers give smoother densities.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_fill.central">fill.central</code></td>
<td>
<p>The color for the central density.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_fill.lower">fill.lower</code>, <code id="binom.bayes_+3A_fill.upper">fill.upper</code></td>
<td>
<p>The color(s) for the upper and lower
density.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_alpha">alpha</code></td>
<td>
<p>The alpha value for controlling transparency.</p>
</td></tr>
<tr><td><code id="binom.bayes_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using the conjugate beta prior on the distribution of p (the
probability of success) in a binomial experiment, constructs a
confidence interval from the beta posterior. From Bayes theorem the
posterior distribution of p given the data x is:
</p>
<p><code>p|x ~ Beta(x + prior.shape1, n - x + prior.shape2)</code>
</p>
<p>The default prior is Jeffrey's prior which is a Beta(0.5, 0.5)
distribution. Thus the posterior mean is <code>(x + 0.5)/(n + 1)</code>.
</p>
<p>The default type of interval constructed is &quot;highest&quot; which computes
the highest probability density (hpd) interval which assures the
shortest interval possible. The hpd intervals will achieve a
probability that is within tol of the specified conf.level. Setting
type to &quot;central&quot; constructs intervals that have equal tail
probabilities.
</p>
<p>If 0 or n successes are observed, a one-sided confidence interval is
returned.
</p>


<h3>Value</h3>

<p>For <code>binom.bayes</code>, a <code>data.frame</code> containing the observed
proportions and the lower and upper bounds of the confidence interval.
</p>
<p>For <code>binom.bayes.densityplot</code>, a <code>ggplot</code> object that can
printed to a graphics device, or have additional layers added.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>References</h3>

<p>Gelman, A., Carlin, J. B., Stern, H. S., and Rubin, D. B. (1997)
<em>Bayesian Data Analysis</em>, London, U.K.: Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.cloglog">binom.cloglog</a></code>,
<code><a href="#topic+binom.logit">binom.logit</a></code>, <code><a href="#topic+binom.probit">binom.probit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Example using highest probability density.
hpd &lt;- binom.bayes(
  x = 0:10, n = 10, type = "highest", conf.level = 0.8, tol = 1e-9)
print(hpd)
binom.bayes.densityplot(hpd)
# Remove the extremes from the plot since they make things hard
# to see.
binom.bayes.densityplot(hpd[hpd$x != 0 &amp; hpd$x != 10, ])

# Example using central probability.
central &lt;- binom.bayes(
  x = 0:10, n = 10, type = "central", conf.level = 0.8, tol = 1e-9)
print(central)
binom.bayes.densityplot(central)
# Remove the extremes from the plot since they make things hard
# to see.
binom.bayes.densityplot(central[central$x != 0 &amp; central$x != 10, ])

</code></pre>

<hr>
<h2 id='binom.cloglog'>Binomial confidence intervals using the cloglog parameterization</h2><span id='topic+binom.cloglog'></span>

<h3>Description</h3>

<p>Uses the complementary log (cloglog) parameterization on the observed
proportion to construct confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.cloglog(x, n, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.cloglog_+3A_x">x</code></td>
<td>
<p>Vector of number of successes in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.cloglog_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.cloglog_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence
interval.</p>
</td></tr>
<tr><td><code id="binom.cloglog_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For derivations see <em>doc/binom.pdf</em>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the observed
proportions and  the lower and upper bounds of the confidence
interval.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.bayes">binom.bayes</a></code>,
<code><a href="#topic+binom.logit">binom.logit</a></code>, <code><a href="#topic+binom.probit">binom.probit</a></code>, <code><a href="#topic+binom.coverage">binom.coverage</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.cloglog(x = 0:10, n = 10)
</code></pre>

<hr>
<h2 id='binom.confint'>Binomial confidence intervals</h2><span id='topic+binom.agresti.coull'></span><span id='topic+binom.asymp'></span><span id='topic+binom.confint'></span><span id='topic+binom.exact'></span><span id='topic+binom.prop.test'></span><span id='topic+binom.wilson'></span>

<h3>Description</h3>

<p>Uses eight different methods to obtain a confidence interval on the binomial probability. </p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.confint(x, n, conf.level = 0.95, methods = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.confint_+3A_x">x</code></td>
<td>
<p>Vector of number of successes in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.confint_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.confint_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence interval.</p>
</td></tr>
<tr><td><code id="binom.confint_+3A_methods">methods</code></td>
<td>
<p>Which method to use to construct the interval. Any
combination of <code>c("exact", "ac", "asymptotic", "wilson",
      "prop.test", "bayes", "logit", "cloglog", "probit")</code> is allowed. Default is
<code>"all"</code>. </p>
</td></tr>
<tr><td><code id="binom.confint_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>binom.bayes</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nine methods are allowed for constructing the confidence interval(s):
</p>

<ul>
<li><p><code>exact</code> - Pearson-Klopper method. See also
<code><a href="stats.html#topic+binom.test">binom.test</a></code>.
</p>
</li>
<li><p><code>asymptotic</code> - the text-book definition for confidence
limits on a single proportion using the Central Limit Theorem.
</p>
</li>
<li><p><code>agresti-coull</code> - Agresti-Coull method. For a 95% confidence
interval, this method does not use the concept   of &quot;adding 2
successes and 2 failures,&quot; but rather uses the formulas explicitly
described in the following link:
http://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval#Agresti-Coull_Interval.

</p>
</li>
<li><p><code>wilson</code> - Wilson method.
</p>
</li>
<li><p><code>prop.test</code> - equivalent to <code>prop.test(x = x, n = n,
    conf.level = conf.level)$conf.int</code>.
</p>
</li>
<li><p><code>bayes</code> - see <code><a href="#topic+binom.bayes">binom.bayes</a></code>.
</p>
</li>
<li><p><code>logit</code> - see <code><a href="#topic+binom.logit">binom.logit</a></code>.
</p>
</li>
<li><p><code>cloglog</code> - see <code><a href="#topic+binom.cloglog">binom.cloglog</a></code>.
</p>
</li>
<li><p><code>probit</code> - see <code><a href="#topic+binom.probit">binom.probit</a></code>.
</p>
</li>
<li><p><code>profile</code> - see <code><a href="#topic+binom.profile">binom.profile</a></code>.
</p>
</li></ul>

<p>By default all eight are estimated for each value of <code>x</code> and/or
<code>n</code>. For the &quot;logit&quot;, &quot;cloglog&quot;, &quot;probit&quot;, and &quot;profile&quot;
methods, the cases where <code>x == 0</code> or <code>x == n</code> are treated
separately. Specifically, the lower bound is replaced by
<code>(alpha/2)^n</code> and the upper bound is replaced by <code>(1-alpha/2)^n</code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the observed proportions and
the lower and upper bounds of the confidence interval for all the
methods in <code>"methods"</code>.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>References</h3>

<p>A. Agresti and B.A. Coull (1998), Approximate is better than &quot;exact&quot;
for interval estimation of binomial proportions, <em>American
Statistician</em>, <b>52</b>:119-126.
</p>
<p>R.G. Newcombe, Logit confidence intervals and the inverse sinh
transformation (2001), <em>American Statistician</em>, <b>55</b>:200-202.
</p>
<p>L.D. Brown, T.T. Cai and A. DasGupta (2001), Interval estimation for a
binomial proportion (with discussion), <em>Statistical Science</em>,
<b>16</b>:101-133.
</p>
<p>Gelman, A., Carlin, J. B., Stern, H. S., and Rubin, D. B. (1997)
<em>Bayesian Data Analysis</em>, London, U.K.: Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.bayes">binom.bayes</a></code>, <code><a href="#topic+binom.logit">binom.logit</a></code>,
<code><a href="#topic+binom.probit">binom.probit</a></code>, <code><a href="#topic+binom.cloglog">binom.cloglog</a></code>,
<code><a href="#topic+binom.coverage">binom.coverage</a></code>, <code><a href="stats.html#topic+prop.test">prop.test</a></code>,
<code><a href="stats.html#topic+binom.test">binom.test</a></code> for comparison to method
<code>"exact"</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.confint(x = c(2, 4), n = 100, tol = 1e-8)
</code></pre>

<hr>
<h2 id='binom.coverage'>Probability coverage for binomial confidence intervals</h2><span id='topic+binom.coverage'></span>

<h3>Description</h3>

<p>Determines the probability coverage for a binomial confidence interval. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.coverage(p, n, conf.level = 0.95, method = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.coverage_+3A_p">p</code></td>
<td>
<p>The (true) probability of success in a binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.coverage_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment. </p>
</td></tr>
<tr><td><code id="binom.coverage_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence interval. </p>
</td></tr>
<tr><td><code id="binom.coverage_+3A_method">method</code></td>
<td>
<p>Either a character string to be passed to
<code><a href="#topic+binom.confint">binom.confint</a></code> or a function that computes the upper
and lower confidence bound for a binomial proportion. If a function
is supplied, the first three arguments must be the same as
<code><a href="#topic+binom.confint">binom.confint</a></code> and the return value of the function
must be a <code>data.frame</code> with column headers <code>"method"</code>,
<code>"lower"</code>, and <code>"upper"</code>. See <code><a href="#topic+binom.confint">binom.confint</a></code>
for available methods. Default is <code>"all"</code>.
</p>
</td></tr>
<tr><td><code id="binom.coverage_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to
<code><a href="#topic+binom.confint">binom.confint</a></code>. Only used when method is either
<code>"bayes"</code> or <code>"profile"</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Derivations are based on the results given in the references. Methods
whose coverage probabilities are consistently closer to 0.95 are more
desireable. Thus, Wilson's, logit, and cloglog appear to be good for
this sample size, while Jeffreys, asymptotic, and prop.test are
poor. Jeffreys is a variation of Bayes using prior shape parameters of
0.5 and having equal probabilities in the tail. The Jeffreys'
equal-tailed interval was created using binom.bayes using (0.5,0.5) as
the prior shape parameters and <code>type = "central"</code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the <code>"method"</code> used, <code>"n"</code>, <code>"p"</code>,
and the coverage probability, <code>C(p,n)</code>.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com)</p>


<h3>References</h3>

<p>L.D. Brown, T.T. Cai and A. DasGupta (2001), Interval
estimation for a binomial proportion (with discussion), <em>Statistical
Science</em>, <b>16</b>:101-133.
</p>
<p>L.D. Brown, T.T. Cai and A. DasGupta (2002), Confidence Intervals for
a Binomial Proportion and Asymptotic Expansions, <em>Annals of Statistics</em>,
<b>30</b>:160-201.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.length">binom.length</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.coverage(p = 0.5, n = 50)
</code></pre>

<hr>
<h2 id='binom.length'>Expected length for binomial confidence intervals</h2><span id='topic+binom.length'></span>

<h3>Description</h3>

<p>Determines the expected length for a binomial confidence interval. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.length(p, n, conf.level = 0.95, method = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.length_+3A_p">p</code></td>
<td>
<p>The (true) probability of success in a binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.length_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment. </p>
</td></tr>
<tr><td><code id="binom.length_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence interval. </p>
</td></tr>
<tr><td><code id="binom.length_+3A_method">method</code></td>
<td>
<p>Either a character string to be passed to
<code><a href="#topic+binom.confint">binom.confint</a></code> or a function that computes the upper
and lower confidence bound for a binomial proportion. If a function
is supplied, the first three arguments must be the same as
<code><a href="#topic+binom.confint">binom.confint</a></code> and the return value of the function
must be a <code>data.frame</code> with column headers <code>"method"</code>,
<code>"lower"</code> and <code>"upper"</code>. See <code><a href="#topic+binom.confint">binom.confint</a></code>
for available methods. Default is <code>"all"</code>.
</p>
</td></tr>
<tr><td><code id="binom.length_+3A_...">...</code></td>
<td>
<p>Additional parameters to be passed to
<code><a href="#topic+binom.confint">binom.confint</a></code>. Only used when method is either
<code>"bayes"</code> or <code>"profile"</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Derivations are based on the results given in the references. Methods
whose length probabilities are consistently closer to 0.95 are more
desireable. Thus, Wilson's, logit, and cloglog appear to be good for
this sample size, while Jeffreys, asymptotic, and prop.test are
poor. Jeffreys is a variation of Bayes using prior shape parameters of
0.5 and having equal probabilities in the tail. The Jeffreys'
equal-tailed interval was created using binom.bayes using (0.5,0.5) as
the prior shape parameters and <code>type = "central"</code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the <code>"method"</code> used, <code>"n"</code>, <code>"p"</code>,
and the average length, <code>L(p,n)</code>.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com)</p>


<h3>References</h3>

<p>L.D. Brown, T.T. Cai and A. DasGupta (2001), Interval
estimation for a binomial proportion (with discussion), <em>Statistical
Science</em>, <b>16</b>:101-133.
</p>
<p>L.D. Brown, T.T. Cai and A. DasGupta (2002), Confidence Intervals for
a Binomial Proportion and Asymptotic Expansions, <em>Annals of Statistics</em>,
<b>30</b>:160-201.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.coverage">binom.coverage</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.length(p = 0.5, n = 50)
</code></pre>

<hr>
<h2 id='binom.logit'>Binomial confidence intervals using the logit parameterization</h2><span id='topic+binom.logit'></span>

<h3>Description</h3>

<p>Uses the logistic (logit) parameterization on the observed
proportion to construct confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.logit(x, n, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.logit_+3A_x">x</code></td>
<td>
<p>Vector of number of successes in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.logit_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.logit_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence
interval.</p>
</td></tr>
<tr><td><code id="binom.logit_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For derivations see <em>doc/binom.pdf</em>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the observed
proportions and  the lower and upper bounds of the confidence
interval.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.bayes">binom.bayes</a></code>,
<code><a href="#topic+binom.logit">binom.logit</a></code>, <code><a href="#topic+binom.probit">binom.probit</a></code>, <code><a href="#topic+binom.coverage">binom.coverage</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.logit(x = 0:10, n = 10)
</code></pre>

<hr>
<h2 id='binom.lrt'>Binomial confidence intervals using the lrt likelihood</h2><span id='topic+binom.lrt'></span>

<h3>Description</h3>

<p>Uses the lrt likelihood on the observed
proportion to construct confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.lrt(x, n, conf.level = 0.95, bayes = FALSE, conf.adj = FALSE, plot
= FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.lrt_+3A_x">x</code></td>
<td>
<p>Vector of number of successes in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.lrt_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.lrt_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence
interval.</p>
</td></tr>
<tr><td><code id="binom.lrt_+3A_bayes">bayes</code></td>
<td>
<p>logical; if <code>TRUE</code> use a Bayesian correction at the
edges. Specfically, a beta prior with shape parameters 0.5 is used.
If <code>bayes</code> is numeric, it is assumed to be the parameters
to beta distribution.</p>
</td></tr>
<tr><td><code id="binom.lrt_+3A_conf.adj">conf.adj</code></td>
<td>
<p>logical; if <code>TRUE</code> 0 or 100% successes return a
one-sided confidence interval</p>
</td></tr>
<tr><td><code id="binom.lrt_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> a plot showing the the square root
of the binomial deviance with reference lines for mean, lower, and
upper bounds. This argument can also be a <code><a href="base.html#topic+list">list</a></code> of plotting parameters
to be passed to <code><a href="lattice.html#topic+xyplot">xyplot</a></code>.</p>
</td></tr>
<tr><td><code id="binom.lrt_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals are based on profiling the binomial deviance in the
neighbourhood of the MLE. If <code>x == 0</code> or <code>x == n</code> and
<code>bayes</code> is <code>TRUE</code>, then a Bayesian adjustment is made to move
the log-likelihood function away from <code>Inf</code>. Specifically, these
values are replaced by <code>(x + 0.5)/(n + 1)</code>, which is the posterier
mode of <code>f(p|x)</code> using Jeffrey's prior on <code>p</code>. Furthermore, if
<code>conf.adj</code> is <code>TRUE</code>, then the upper (or lower) bound uses
a <code>1 - alpha</code> confidence level. Typically, the
observed mean will not be inside the estimated confidence interval. 
If <code>bayes</code> is <code>FALSE</code>, then the Clopper-Pearson exact method
is used on the endpoints. This tends to make confidence intervals at the
end too conservative, though the observed mean is guaranteed to be
within the estimated confidence limits.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the observed
proportions and  the lower and upper bounds of the confidence
interval.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.bayes">binom.bayes</a></code>, <code><a href="#topic+binom.cloglog">binom.cloglog</a></code>,
<code><a href="#topic+binom.logit">binom.logit</a></code>, <code><a href="#topic+binom.probit">binom.probit</a></code>, <code><a href="#topic+binom.coverage">binom.coverage</a></code>,
<code><a href="MASS.html#topic+confint">confint</a></code> in package MASS,
<code><a href="stats.html#topic+family">family</a></code>, <code><a href="stats.html#topic+glm">glm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.lrt(x = 0:10, n = 10)
</code></pre>

<hr>
<h2 id='binom.optim'>Optimal binomial confidence intervals</h2><span id='topic+binom.optim'></span>

<h3>Description</h3>

<p>Uses optimization to minimize the integrated mean squared error
between the calculated coverage and the desired confidence level
for a given binomial confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.optim(n, conf.level = 0.95, method = binom.lrt,
            k = n%/%2 + 1, p0 = 0, transform = TRUE,
            plot = FALSE, tol = .Machine$double.eps^0.5,
            start = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.optim_+3A_n">n</code></td>
<td>
<p>The number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.optim_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence
interval.</p>
</td></tr>
<tr><td><code id="binom.optim_+3A_method">method</code></td>
<td>
<p>The method used to estimate the confidence interval.</p>
</td></tr>
<tr><td><code id="binom.optim_+3A_k">k</code></td>
<td>
<p>See Details.</p>
</td></tr>
<tr><td><code id="binom.optim_+3A_p0">p0</code></td>
<td>
<p>The minimum probability of success to allow in the
optimization. See Details.</p>
</td></tr>
<tr><td><code id="binom.optim_+3A_transform">transform</code></td>
<td>
<p>logical; If <code>TRUE</code> the optimizer will do an
unconstrained optimization on the signficance probability in the
logit space.</p>
</td></tr>
<tr><td><code id="binom.optim_+3A_plot">plot</code></td>
<td>
<p>logical; If <code>TRUE</code> the results are sent to <code><a href="#topic+binom.plot">binom.plot</a></code>.</p>
</td></tr>
<tr><td><code id="binom.optim_+3A_tol">tol</code></td>
<td>
<p>The minimum significance level to allow in the
optimization. See Details.</p>
</td></tr>
<tr><td><code id="binom.optim_+3A_start">start</code></td>
<td>
<p>A starting value on the optimal confidence level.</p>
</td></tr>
<tr><td><code id="binom.optim_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function minimizes the squared error between the expected coverage
probability and the desired confidence level.
</p>
<p style="text-align: center;"><code class="reqn">\alpha_{opt}=\arg\min_{\alpha}\int_{0}^{1}[C(p,n)-(1-\alpha)^2dp</code>
</p>

<p>The optimizer will adjust confidence intervals for all <code>x</code> =
<code>0</code> to <code>n</code> depending on the value of <code>k</code> provided. If
<code>k</code> is one, only the confidence levels for <code>x</code> = <code>0</code> and
<code>n</code> are adjusted. If <code>k</code> = <code>[n/2]</code> then all confidence
intervals are adjusted. This assumes the confidence intervals are the
same length for <code>x</code> = <code>x[k]</code> and <code>x[n - k + 1]</code>, which is
the case for all methods provided in this package except
<code><a href="#topic+binom.cloglog">binom.cloglog</a></code>.</p>


<h3>Value</h3>

<p>A <code>list</code> with the following elements:
</p>
<table>
<tr><td><code>par</code></td>
<td>
<p>Final confidence levels. The length of this vector is
<code>k</code>.</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>The final minimized value from <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p>The number of function and gradient calls from
<code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>Convergence code from <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>Any message returned by the L-BFGS-B or BFGS
optimizer.</p>
</td></tr>
<tr><td><code>confint</code></td>
<td>
<p>A <code>data.frame</code> returned from a call to
<code>method</code> using the optimized confidence levels.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.plot">binom.plot</a></code>,
<code><a href="#topic+binom.coverage">binom.coverage</a></code>, <code><a href="stats.html#topic+optim">optim</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.optim(10, k = 1) ## determine optimal significance for x = 0, 10 only
binom.optim(3, method = binom.wilson) ## determine optimal significance for all x
</code></pre>

<hr>
<h2 id='binom.plot'>Coverage plots for binomial confidence intervals</h2><span id='topic+binom.plot'></span>

<h3>Description</h3>

<p>Constructs coverage plots for binomial confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.plot(n, method = binom.lrt, np = 500,
           conf.level = 0.95, actual = conf.level,
           type = c("xyplot", "levelplot"),
           tol = .Machine$double.eps^0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.plot_+3A_n">n</code></td>
<td>
<p>The number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.plot_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence
interval.</p>
</td></tr>
<tr><td><code id="binom.plot_+3A_np">np</code></td>
<td>
<p>Number of points to use in the plot.</p>
</td></tr>
<tr><td><code id="binom.plot_+3A_method">method</code></td>
<td>
<p>The method used to estimate the confidence interval.</p>
</td></tr>
<tr><td><code id="binom.plot_+3A_actual">actual</code></td>
<td>
<p>The actual confidence interval used in the confidence
interval. See Details.</p>
</td></tr>
<tr><td><code id="binom.plot_+3A_type">type</code></td>
<td>
<p>See Details.</p>
</td></tr>
<tr><td><code id="binom.plot_+3A_tol">tol</code></td>
<td>
<p>The minimum probability of success to use in the plot.</p>
</td></tr>
<tr><td><code id="binom.plot_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to
<code><a href="lattice.html#topic+panel.xyplot">panel.xyplot</a></code> or <code><a href="lattice.html#topic+panel.levelplot">panel.levelplot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>type</code> is <code>"xyplot"</code>, a line plot is created with
coverage on the y-axis and binomial probability on the x-axis.
A separate panel for every <code>n</code> is provided. If <code>actual</code> is
provided then a horizontal reference line is added to the plot. This
is only useful when <code>actual</code> is different from <code>conf.level</code>,
as is the case when calling <code><a href="#topic+binom.optim">binom.optim</a></code>.
</p>
<p>If <code>type</code> is <code>"levelplot"</code>, a image plot is created with
<code>x</code> = <code>0</code> to <code>n</code> on the vertical axis and binomial
probability on the horizontal axis. Each row in the plot will be the
confidence level for a given <code>x</code>. The color of the confidence
interval is determined by the coverage probability. The argument
<code>n</code> must only be of length one. If not, only the first <code>n</code>
will be used and a warning is issued.
</p>
<p>In either plot type, the number of points at which the coverage
probability is determined is specified by <code>np</code>. Increasing
<code>np</code> gives a finer granularity but performance will suffer.
</p>


<h3>Value</h3>

<p>An object of class <code>trellis</code>.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.optim">binom.optim</a></code>,
<code><a href="lattice.html#topic+xyplot">xyplot</a></code>, <code><a href="lattice.html#topic+levelplot">levelplot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.plot(5, type = "levelplot")
binom.plot(c(3, 5, 10, 25), type = "xyplot")
</code></pre>

<hr>
<h2 id='binom.power'>Power curves for binomial parameterizations</h2><span id='topic+binom.power'></span>

<h3>Description</h3>

<p>Uses Wald statistics to compute power curves for several parameterizations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.power(p.alt,
            n = 100,
            p = 0.5,
            alpha = 0.05,
            phi = 1,
            alternative = c("two.sided", "greater", "less"),
            method = c("cloglog", "logit", "probit", "asymp", "lrt", "exact"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.power_+3A_p.alt">p.alt</code></td>
<td>
<p>A vector of success probabilities under the alternative
hypothesis.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_n">n</code></td>
<td>
<p>A vector representing the number of independent trials in the
binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_p">p</code></td>
<td>
<p>A vector of success probabilities under the null hypothesis.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_alpha">alpha</code></td>
<td>
<p>A vector of type-I error rates.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_phi">phi</code></td>
<td>
<p>A vector determining the overdispersion parameter for each
binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_alternative">alternative</code></td>
<td>
<p>Type of alternative hypothesis.</p>
</td></tr>
<tr><td><code id="binom.power_+3A_method">method</code></td>
<td>
<p>The method used to compute power.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For derivations see <em>doc/binom.pdf</em>. <code>p.alt</code>, <code>n</code>,
<code>p</code>, <code>alpha</code>, and <code>phi</code> can all be vectors. The length
of each argument will be expanded to the longest length. The function
assumes the lengths are equal or can be wrapped for multiple values.
</p>


<h3>Value</h3>

<p>The estimated probability of detecting the difference between
<code>p.alt</code> and <code>p</code>.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.bayes">binom.bayes</a></code>,
<code><a href="#topic+binom.logit">binom.logit</a></code>, <code><a href="#topic+binom.probit">binom.probit</a></code>, <code><a href="#topic+binom.coverage">binom.coverage</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.power(0.95, alternative = "greater")
</code></pre>

<hr>
<h2 id='binom.probit'>Binomial confidence intervals using the probit parameterization</h2><span id='topic+binom.probit'></span>

<h3>Description</h3>

<p>Uses the probit parameterization on the observed
proportion to construct confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.probit(x, n, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.probit_+3A_x">x</code></td>
<td>
<p>Vector of number of successes in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.probit_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.probit_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence
interval.</p>
</td></tr>
<tr><td><code id="binom.probit_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For derivations see <em>doc/binom.pdf</em>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the observed
proportions and  the lower and upper bounds of the confidence
interval.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.bayes">binom.bayes</a></code>,
<code><a href="#topic+binom.probit">binom.probit</a></code>, <code><a href="#topic+binom.logit">binom.logit</a></code>, <code><a href="#topic+binom.coverage">binom.coverage</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.probit(x = 0:10, n = 10)
</code></pre>

<hr>
<h2 id='binom.profile'>Binomial confidence intervals using the profile likelihood</h2><span id='topic+binom.profile'></span>

<h3>Description</h3>

<p>Uses the profile likelihood on the observed
proportion to construct confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.profile(x, n, conf.level = 0.95, maxsteps = 50,
              del = zmax/5, bayes = TRUE, plot = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.profile_+3A_x">x</code></td>
<td>
<p>Vector of number of successes in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.profile_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.profile_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence
interval.</p>
</td></tr>
<tr><td><code id="binom.profile_+3A_maxsteps">maxsteps</code></td>
<td>
<p>The maximum number of steps to take in the profiles.</p>
</td></tr>
<tr><td><code id="binom.profile_+3A_del">del</code></td>
<td>
<p>The size of the step to take</p>
</td></tr>
<tr><td><code id="binom.profile_+3A_bayes">bayes</code></td>
<td>
<p>logical; if <code>TRUE</code> use a Bayesian correction at the
edges.</p>
</td></tr>
<tr><td><code id="binom.profile_+3A_plot">plot</code></td>
<td>
<p>logical; if <code>TRUE</code> plot the profile with a
<code>spline</code> fit.</p>
</td></tr>
<tr><td><code id="binom.profile_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals are based on profiling the binomial deviance in the
neighbourhood of the MLE. If <code>x == 0</code> or <code>x == n</code> and
<code>bayes</code> is <code>TRUE</code>, then a Bayesian adjustment is made to move
the log-likelihood function away from <code>Inf</code>. Specifically, these
values are replaced by <code>(x + 0.5)/(n + 1)</code>, which is the posterier
mode of <code>f(p|x)</code> using Jeffrey's prior on <code>p</code>. Typically, the
observed mean will not be inside the estimated confidence interval. 
If <code>bayes</code> is <code>FALSE</code>, then the Clopper-Pearson exact method
is used on the endpoints. This tends to make confidence intervals at the
end too conservative, though the observed mean is guaranteed to be
within the estimated confidence limits.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the observed
proportions and  the lower and upper bounds of the confidence
interval.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.bayes">binom.bayes</a></code>, <code><a href="#topic+binom.cloglog">binom.cloglog</a></code>,
<code><a href="#topic+binom.logit">binom.logit</a></code>, <code><a href="#topic+binom.probit">binom.probit</a></code>, <code><a href="#topic+binom.coverage">binom.coverage</a></code>,
<code><a href="MASS.html#topic+confint">confint</a></code> in package MASS,
<code><a href="stats.html#topic+family">family</a></code>, <code><a href="stats.html#topic+glm">glm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.profile(x = 0:10, n = 10)
</code></pre>

<hr>
<h2 id='binom.sim'>Simulates confidence intervals for binomial data</h2><span id='topic+binom.sim'></span>

<h3>Description</h3>

<p>Simulates binomial data for testing confidence interval coverage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.sim(M = 200, n = 100, p = 0.5, conf.level = 0.95, methods = "all",  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.sim_+3A_m">M</code></td>
<td>
<p>Number of simulations to create.</p>
</td></tr>
<tr><td><code id="binom.sim_+3A_n">n</code></td>
<td>
<p>Vector of number of independent trials in the binomial experiment.</p>
</td></tr>
<tr><td><code id="binom.sim_+3A_p">p</code></td>
<td>
<p>Probability of success under the null hypothesis.</p>
</td></tr>
<tr><td><code id="binom.sim_+3A_conf.level">conf.level</code></td>
<td>
<p>The level used in computing the confidence interval.</p>
</td></tr>
<tr><td><code id="binom.sim_+3A_methods">methods</code></td>
<td>
<p>The method used to compute power.</p>
</td></tr>
<tr><td><code id="binom.sim_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code><a href="#topic+binom.confint">binom.confint</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>M</code> binomial observations are created using <code>rbinom(M, n,
    p)</code>. The average number of times a confidence interval covers
<code>p</code> is returned.
</p>


<h3>Value</h3>

<p>The estimated coverage based on which method is requested.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.bayes">binom.bayes</a></code>,
<code><a href="#topic+binom.logit">binom.logit</a></code>, <code><a href="#topic+binom.probit">binom.probit</a></code>, <code><a href="#topic+binom.coverage">binom.coverage</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.sim(p = 0.95, method = "lrt")
</code></pre>

<hr>
<h2 id='cloglog.sample.size'>Power and sample size</h2><span id='topic+cloglog.sample.size'></span>

<h3>Description</h3>

<p>Power and sample size for a binomial proportion using the cloglog parameterization. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cloglog.sample.size(p.alt, n = NULL, p = 0.5, power = 0.8, alpha = 0.05,
                    alternative = c("two.sided", "greater", "less"), exact.n = FALSE,
                    recompute.power = FALSE, phi = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cloglog.sample.size_+3A_p.alt">p.alt</code></td>
<td>
<p>The alternative proportion in a one-sample test.</p>
</td></tr>
<tr><td><code id="cloglog.sample.size_+3A_n">n</code></td>
<td>
<p>The sample size in a one-sample test. </p>
</td></tr>
<tr><td><code id="cloglog.sample.size_+3A_p">p</code></td>
<td>
<p>The null proportion in a one-sample test. Default is 0.5. </p>
</td></tr>
<tr><td><code id="cloglog.sample.size_+3A_power">power</code></td>
<td>
<p>The desired power level. Default is 0.80.</p>
</td></tr>
<tr><td><code id="cloglog.sample.size_+3A_alpha">alpha</code></td>
<td>
<p>The desired alpha level - probability of a Type I
error. Default is 0.05.
</p>
</td></tr>
<tr><td><code id="cloglog.sample.size_+3A_alternative">alternative</code></td>
<td>
<p>Nature of alternative hypothesis. One of
&quot;two.sided&quot;, &quot;greater&quot;, &quot;less&quot;.
</p>
</td></tr>
<tr><td><code id="cloglog.sample.size_+3A_exact.n">exact.n</code></td>
<td>
<p>logical; If <code>TRUE</code>, the computed sample size will
not be rounded up. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cloglog.sample.size_+3A_recompute.power">recompute.power</code></td>
<td>
<p>logical; If <code>TRUE</code>, after the sample size
is computed, the power will be recomputed. This is only advantageous
when the sample size is rounded up. Default is <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="cloglog.sample.size_+3A_phi">phi</code></td>
<td>
<p>Dispersion parameter by which to inflate (<code>phi &gt; 1</code>) or
deflate (<code>phi &lt; 1</code>) variance. Default is 1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to calculate sample size, power or minimum
detectable difference. It determines what to compute base on the
arguments provided. If <code>p.alt</code> is given, but <code>n</code> is not, then
sample size is computed. If <code>p.alt</code> is given along with <code>n</code>,
then the power is computed. If only <code>n</code> is provided, the minimum
detectable difference is computed using the default power of 0.80.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the power, sample size and all of the
input which was used to perform the computations.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com)</p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.confint">binom.confint</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>cloglog.sample.size(p.alt = 0.8)
cloglog.sample.size(n = 20)
cloglog.sample.size(n = 20, power = 0.9)
</code></pre>

<hr>
<h2 id='tkbinom.power'>Power curves for binomial parameterizations</h2><span id='topic+tkbinom.power'></span>

<h3>Description</h3>

<p>A Tcl/Tk graphics wrapper for <code><a href="#topic+binom.power">binom.power</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  tkbinom.power()
</code></pre>


<h3>Details</h3>

<p>A wrapper for <code><a href="#topic+binom.power">binom.power</a></code> that creates power curves
based on user input.
</p>


<h3>Author(s)</h3>

<p>Sundar Dorai-Raj (sdorairaj@gmail.com) </p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.power">binom.power</a></code>, <code><a href="#topic+binom.confint">binom.confint</a></code>, <code><a href="#topic+binom.bayes">binom.bayes</a></code>,
<code><a href="#topic+binom.logit">binom.logit</a></code>, <code><a href="#topic+binom.probit">binom.probit</a></code>, <code><a href="#topic+binom.coverage">binom.coverage</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.power(0.95, alternative = "greater")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
