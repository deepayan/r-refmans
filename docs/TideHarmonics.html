<!DOCTYPE html><html lang="en"><head><title>Help for package TideHarmonics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TideHarmonics}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Broome'><p>Sea-Level Data At Broome</p></a></li>
<li><a href='#CapeFerguson'><p>Sea-Level Data At Cape Ferguson</p></a></li>
<li><a href='#coef.tide'><p>Coefficients For Tidal Object</p></a></li>
<li><a href='#Darwin'><p>Sea-Level Data At Darwin</p></a></li>
<li><a href='#Esperance'><p>Sea-Level Data At Esperance</p></a></li>
<li><a href='#ftide'><p>Fit Tidal Data</p></a></li>
<li><a href='#harmonics'><p>Table Of All 409 Harmonic Constituents</p></a></li>
<li><a href='#hc114'><p>Names Of Commonly Used Harmonic Constituents</p></a></li>
<li><a href='#Hillarys'><p>Sea-Level Data At Hillarys</p></a></li>
<li><a href='#lambdas'><p>Calculates Astronomical Longitudes</p></a></li>
<li><a href='#nodal_adj'><p>Calculate nodal corrections.</p></a></li>
<li><a href='#plagtz'><p>Convert Phase Lag</p></a></li>
<li><a href='#plot.tide'><p>Plot Tidal Object</p></a></li>
<li><a href='#PortKembla'><p>Sea-Level Data At Port Kembla</p></a></li>
<li><a href='#Portland'><p>Sea-Level Data At Portland</p></a></li>
<li><a href='#predict.tide'><p>Predict The Tide Using Tidal Object</p></a></li>
<li><a href='#print.tide'><p>Print Tidal Object</p></a></li>
<li><a href='#spdlunar'><p>Speeds For Basic Astronomical Periods</p></a></li>
<li><a href='#Thevenard'><p>Sea-Level Data At Thevenard</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.1-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-05-04</td>
</tr>
<tr>
<td>Title:</td>
<td>Harmonic Analysis of Tides</td>
</tr>
<tr>
<td>Author:</td>
<td>Alec Stephenson.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alec Stephenson &lt;alec_stephenson@hotmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements harmonic analysis of tidal and sea-level data.
  Over 400 harmonic tidal constituents can be estimated, all with 
  daily nodal corrections. Time-varying mean sea-levels can also
  be used.</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-05-04 07:35:56 UTC; ste6an</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-05-04 08:16:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='Broome'>Sea-Level Data At Broome</h2><span id='topic+Broome'></span>

<h3>Description</h3>

<p>The <code>Broome</code> data frame has 26304 rows and 2 variables. It
gives hourly sea-levels in metres (above Tide Gauge Zero) recorded 
by the tide gauge within the (UTC) years of 2012-2014. The sea-levels 
are in the second column. The first column is a POSIXct object 
giving the dates and times in UTC.
</p>
<p>Broome is one of the sites currently used for the Australian
Baseline Sea-Level Monitoring Project (ABSLMP). Hourly data for
these sites is available from the Australian Bureau of
Meteorology.
</p>
<p>To obtain the sea-level in AHD (Australian Height Datum), you
will need to subtract 5.322 metres from the values given in the
dataset.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Broome</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>DateTime</dt><dd><p>A POSIXct object where times are in UTC.</p>
</dd>
<dt>SeaLevel</dt><dd><p>The sea-level in metres above Tide Gauge Zero. 
Any missing or erroneous data points are set to NA.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Australian Bureau of Meteorology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code></p>

<hr>
<h2 id='CapeFerguson'>Sea-Level Data At Cape Ferguson</h2><span id='topic+CapeFerguson'></span>

<h3>Description</h3>

<p>The <code>CapeFerguson</code> data frame has 26304 rows and 2 variables. It
gives hourly sea-levels in metres (above Tide Gauge Zero) recorded 
by the tide gauge within the (UTC) years of 2012-2014. The sea-levels 
are in the second column. The first column is a POSIXct object 
giving the dates and times in UTC.
</p>
<p>Cape Ferguson is one of the sites currently used for the Australian
Baseline Sea-Level Monitoring Project (ABSLMP). Hourly data for
these sites is available from the Australian Bureau of
Meteorology.
</p>
<p>To obtain the sea-level in AHD (Australian Height Datum), you
will need to subtract 1.590 metres from the values given in the
dataset.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CapeFerguson</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>DateTime</dt><dd><p>A POSIXct object where times are in UTC.</p>
</dd>
<dt>SeaLevel</dt><dd><p>The sea-level in metres above Tide Gauge Zero. 
Any missing or erroneous data points are set to NA.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Australian Bureau of Meteorology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code></p>

<hr>
<h2 id='coef.tide'>Coefficients For Tidal Object</h2><span id='topic+coef.tide'></span>

<h3>Description</h3>

<p>Give coefficients and harmonic constituents of a tidal object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tide'
coef(object, hc = FALSE, mat = hc, utc = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.tide_+3A_object">object</code></td>
<td>
<p>An object of class <code>'tide'</code>.</p>
</td></tr>
<tr><td><code id="coef.tide_+3A_hc">hc</code></td>
<td>
<p>If <code>TRUE</code>, returns harmonic constituent values, 
in order of decreasing amplitude. If <code>mat</code> is <code>FALSE</code>,
a vector is returned containing the amplitudes and then the phase 
lags. If <code>mat</code> is <code>TRUE</code>, a four column matrix is 
returned, with the amplitudes, phase lags, sine coefficients and
cosine coefficients in the columns.</p>
</td></tr>
<tr><td><code id="coef.tide_+3A_mat">mat</code></td>
<td>
<p>If <code>TRUE</code>, a matrix is returned.</p>
</td></tr>
<tr><td><code id="coef.tide_+3A_utc">utc</code></td>
<td>
<p>The phase lags are given in UTC plus or minus <code>utc</code>
hours. For example, if Australian Eastern Standard Time is required,
use positive 10. If Pacific Standard Time is required, use negative 8.</p>
</td></tr>
<tr><td><code id="coef.tide_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector or numeric matrix of sine and cosine coefficients,
or of amplitudes and phase lags. The phase lags are with respect to
the time zone specified by the <code>utc</code> argument, which is UTC by 
default.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+predict.tide">predict.tide</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>hfit1 &lt;- ftide(Hillarys$SeaLevel, Hillarys$DateTime, hc60)
hfit2 &lt;- ftide(Hillarys$Sea, Hillarys$Date, hc7, smsl=TRUE)
coef(hfit1, hc = TRUE)
coef(hfit2)
coef(hfit2, mat = TRUE)
coef(hfit2, hc = TRUE)
coef(hfit2, hc = TRUE, mat = FALSE)
</code></pre>

<hr>
<h2 id='Darwin'>Sea-Level Data At Darwin</h2><span id='topic+Darwin'></span>

<h3>Description</h3>

<p>The <code>Darwin</code> data frame has 26304 rows and 2 variables. It
gives hourly sea-levels in metres (above Tide Gauge Zero) recorded 
by the tide gauge within the (UTC) years of 2012-2014. The sea-levels 
are in the second column. The first column is a POSIXct object 
giving the dates and times in UTC.
</p>
<p>Darwin is one of the sites currently used for the Australian
Baseline Sea-Level Monitoring Project (ABSLMP). Hourly data for
these sites is available from the Australian Bureau of
Meteorology.
</p>
<p>To obtain the sea-level in AHD (Australian Height Datum), you
will need to subtract 4.105 metres from the values given in the
dataset.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Darwin</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>DateTime</dt><dd><p>A POSIXct object where times are in UTC.</p>
</dd>
<dt>SeaLevel</dt><dd><p>The sea-level in metres above Tide Gauge Zero. 
Any missing or erroneous data points are set to NA.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Australian Bureau of Meteorology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code></p>

<hr>
<h2 id='Esperance'>Sea-Level Data At Esperance</h2><span id='topic+Esperance'></span>

<h3>Description</h3>

<p>The <code>Esperance</code> data frame has 26304 rows and 2 variables. It
gives hourly sea-levels in metres (above Tide Gauge Zero) recorded 
by the tide gauge within the (UTC) years of 2012-2014. The sea-levels 
are in the second column. The first column is a POSIXct object 
giving the dates and times in UTC.
</p>
<p>Esperance is one of the sites currently used for the Australian
Baseline Sea-Level Monitoring Project (ABSLMP). Hourly data for
these sites is available from the Australian Bureau of
Meteorology.
</p>
<p>To obtain the sea-level in AHD (Australian Height Datum), you
will need to subtract 0.707 metres from the values given in the
dataset.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Esperance</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>DateTime</dt><dd><p>A POSIXct object where times are in UTC.</p>
</dd>
<dt>SeaLevel</dt><dd><p>The sea-level in metres above Tide Gauge Zero. 
Any missing or erroneous data points are set to NA.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Australian Bureau of Meteorology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code></p>

<hr>
<h2 id='ftide'>Fit Tidal Data</h2><span id='topic+ftide'></span>

<h3>Description</h3>

<p>Fit tidal data using any of over 400 harmonic constituents.
Daily nodal corrections and time-varying mean sea-levels
can be used. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ftide(x, dto, hcn = TideHarmonics::hc60, astlon = c("task","cartwright"),
   nodal = TRUE, smsl = FALSE, span = 0.75, degree = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ftide_+3A_x">x</code></td>
<td>
<p>A numeric vector or time series object giving the
sea-levels. Missing values are allowed.</p>
</td></tr>
<tr><td><code id="ftide_+3A_dto">dto</code></td>
<td>
<p>A date/time vector of the same length as <code>x</code>,
which should be a POSIXct object or something which can be 
converted to a POSIXct object. If no time zone is given then 
UTC is assumed. No missing values are allowed.</p>
</td></tr>
<tr><td><code id="ftide_+3A_hcn">hcn</code></td>
<td>
<p>A vector of constituent names. Some in-built vectors
of names can be used: hc4, hc7, hc37, hc60 and hc114. If not
specified, the vector hc60 is used by default.</p>
</td></tr>
<tr><td><code id="ftide_+3A_astlon">astlon</code></td>
<td>
<p>The longitude formula to be used. The default
&quot;task&quot; is the formulas use in the TASK-2000 software. The
alternative &quot;cartwright&quot; uses Cartwright(1982).</p>
</td></tr>
<tr><td><code id="ftide_+3A_nodal">nodal</code></td>
<td>
<p>Should nodal corrections be be used?</p>
</td></tr>
<tr><td><code id="ftide_+3A_smsl">smsl</code></td>
<td>
<p>If <code>TRUE</code>, then a smooth curve is fitted to
the mean sea-level based on the loess function. This is 
designed to account for smooth changes at periods longer
than the lowest speed harmonic, which by default is the
solar annual term Sa.</p>
</td></tr>
<tr><td><code id="ftide_+3A_span">span</code>, <code id="ftide_+3A_degree">degree</code></td>
<td>
<p>Arguments passed to the loess function.</p>
</td></tr>
<tr><td><code id="ftide_+3A_...">...</code></td>
<td>
<p>Passed to the linear model function <code>lm</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first removes the mean sea-level from the data
(which by default is a single number) and the fits a linear 
model without intercept to sine and cosine terms defined by 
the specified harmonics. This (by default) includes nodal
corrections. The sine and cosine coefficients can then be used 
to derive the amplitude and phases. See the package vignette
for details.
</p>
<p>Different names are used by various organizations for identical 
constituents. This package is designed to be robust, so that 
any common name can be used. In the output, the name will get 
converted to the set of names that we employ.
</p>
<p>For constituents based on underlying components, we use our own
(logical) naming scheme rather than the (totally confusing) 
historical scheme. See <code><a href="#topic+harmonics">harmonics</a></code> and the package 
vignette for details. Either scheme should work for the input
vector <code>hcn</code>.
</p>
<p>The UTC time zone is assumed by default. Even if a different
time zone is used, the phase lags will be calculated in UTC.
The <code>utc</code> argument of <code>coef.tide</code> can be used to
derive phase lags for different time zones.
</p>
<p>An error will be produced if two specified harmonic
components have virtually identical speeds (specifically, if the 
first five Doodson numbers are the same), even if the nodal 
corrections are different. This is to avoid numerical problems
in the linear model fit, because these components will be
difficult (or impossible) to identify separately.
</p>
<p>The slowest harmonics in the default hc60 vector is the annual 
solar term Sa. If you do not have at least one year of data you 
should not include Sa. The fastest harmonics in hc60 have periods 
of just over 4 hours. If your frequency of observation is more 
than 2 hours you should not include the faster constituents.  
</p>


<h3>Value</h3>

<p>A list object of class <code>c('tide','lm')</code>. This is exactly the
save as a standard <code>lm</code> object but with the following
additional components
</p>
<table role = "presentation">
<tr><td><code>fval</code></td>
<td>
<p>The form factor, which in terms of amplitudes is
calculated as (K1+O1)/(M2+S2). This component and the two
components given below are only available if all four of these
harmonics are included in the fit.</p>
</td></tr>
<tr><td><code>features1</code></td>
<td>
<p>A vector of fitted features that are relevant 
for semi-diurnal sites. MLWS = Mean Low Water Springs. MLWN =
Mean Low Water Neaps. MSL = Mean Sea-Level. MHWN = Mean High 
Water Neaps. MHWS = Mean High Water Springs.</p>
</td></tr>
<tr><td><code>features2</code></td>
<td>
<p>A vector of fitted features that are relevant 
for diurnal or mixed semi-diurnal sites. MLLW = Mean Lower Low 
Water. MHLW = Mean Higher Low Water. MSL = Mean Sea-Level. MLHW =
Mean Lower High Water. MHHW = Mean Higher High Water.</p>
</td></tr>
<tr><td><code>cfmat</code></td>
<td>
<p>A matrix of sine and cosine coefficients, in the
same order as the <code>hcn</code> vector.</p>
</td></tr>
<tr><td><code>cfmat</code></td>
<td>
<p>A matrix of amplitudes, phase lags, sine and cosine 
coefficients, ordered by decreasing amplitude.</p>
</td></tr>
<tr><td><code>origin</code></td>
<td>
<p>The POSIXct value used as the origin, which is in
the centre of the <code>dto</code> vector.</p>
</td></tr>
<tr><td><code>vn0</code></td>
<td>
<p>A named vector containing reference signals (equilibrium
phases) in degrees for each harmonic constituent.</p>
</td></tr>
<tr><td><code>msl</code></td>
<td>
<p>The mean sea level, either a vector (if <code>smsl</code> is 
<code>TRUE</code>) or a single number (if <code>smsl</code> is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code>lobj</code></td>
<td>
<p>The fitted loess object if <code>smsl</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>nodal</code></td>
<td>
<p>The nodal argument.</p>
</td></tr>
<tr><td><code>astlon</code></td>
<td>
<p>The astlon argument.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+harmonics">harmonics</a></code>, <code><a href="#topic+hc114">hc114</a></code>, <code><a href="#topic+plot.tide">plot.tide</a></code>, <code><a href="#topic+predict.tide">predict.tide</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hfit1 &lt;- ftide(Hillarys$SeaLevel, Hillarys$DateTime, hc60)
hfit2 &lt;- ftide(Hillarys$Sea, Hillarys$Date, hc7, smsl=TRUE)
hfit1
hfit2
</code></pre>

<hr>
<h2 id='harmonics'>Table Of All 409 Harmonic Constituents</h2><span id='topic+harmonics'></span>

<h3>Description</h3>

<p>The <code>harmonics</code> data frame has 409 rows and 12 variables. It
shows the standard list of tidal constituents as provided by the
IHO tidal committee. 
</p>
<p>Some corrections and adjustments have been made to the standard 
list; these are documented in the package vignette. We also use
a different naming scheme which is more logical and consistent.
Our names are given in the <code>name</code> column. The traditional
names are given in the <code>sname</code> column. Either can be used
in the code.
</p>
<p>We have retained lower case characters and have used the first 
three characters for greek letters e.g. the1 for theta1. The code
has been written for robustness and will still work if you use upper
case characters and/or full names for greek letters.
</p>
<p>There are many variations of constituent names and I have attempted 
to write the software so that it will work whatever names are used. 
For example, NOAA uses RHO rather than the more common rho1 or RHO1.
The names RHO and RHO1 are therefore automatically converted to rho1.
TASK-2000 uses LAMDA1 (with the B missing), which is automatically
converted to lam1.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>harmonics</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>name</dt><dd><p>The name of the constituent, which is unique.</p>
</dd>
<dt>sname</dt><dd><p>The standard name of the constituent, which is also unique.</p>
</dd>
<dt>speed</dt><dd><p>The speed (angular frequency) in degrees per hour. 
Derived from the Doodson number. To calculate the period in hours,
divide 360 by the speed.</p>
</dd>
<dt>code</dt><dd><p>The extended Doodson code.</p>
</dd>
<dt>i1</dt><dd><p>The first Doodson number.</p>
</dd>
<dt>i2</dt><dd><p>The second Doodson number.</p>
</dd>
<dt>i3</dt><dd><p>The third Doodson number.</p>
</dd>
<dt>i4</dt><dd><p>The forth Doodson number.</p>
</dd>
<dt>i5</dt><dd><p>The fifth Doodson number (always zero).</p>
</dd>
<dt>i6</dt><dd><p>The sixth Doodson number (mostly zero).</p>
</dd>
<dt>phi</dt><dd><p>The phase constant in degrees.</p>
</dd>
<dt>nodal</dt><dd><p>The type of nodal correction, as taken from the standard list.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Standard list of tidal constituents of the IHO tidal committee.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+hc114">hc114</a></code></p>

<hr>
<h2 id='hc114'>Names Of Commonly Used Harmonic Constituents</h2><span id='topic+hc114'></span><span id='topic+task'></span><span id='topic+hc60'></span><span id='topic+hc37'></span><span id='topic+noaa'></span><span id='topic+hc7'></span><span id='topic+hc4'></span>

<h3>Description</h3>

<p>These vectors give names of commonly used harmonic constituents.
</p>
<p>The <code>hc114</code> vector gives the first 114 of the 115 constituents
listed in the TASK-2000 software manual. The order is the same as
that given in the manual. The 115th constituent has the same speed 
(but a different nodal correction) as the constituent L2. It is 
omitted because it probably not sensible to include both.
</p>
<p>The <code>hc60</code> vector gives the first 60 of the 115 constituents
listed in the TASK-2000 software manual. The order is the same as
that given in the manual (which is in order of speed).
</p>
<p>The <code>hc37</code> vector gives the 37 constituents that are used by
the NOAA, in the sense that they are publicly available on the
NOAA website (for USA sites). They are listed in NOAA order. Note
that NOAA uses constituents S6 and M8, but neither are contained in
<code>hc60</code>, and S6 is not contained in <code>hc114</code>.
</p>
<p>The <code>hc7</code> vector gives the seven major constituents 
M2 S2 N2 K2 K1 O1 P1.
</p>
<p>The <code>hc4</code> vector gives the four major constituents 
M2 S2 K1 O1. Unless you are investigating single constituents,
it is recommended that these four are always included because
they are fundamental to the classification of a site as
semi-diurnal, mixed semi-diurnal or diurnal. 
</p>
<p>The <code>task</code> vector gives the same constituents as <code>hc114</code>
but using the TASK-2000 names. The <code>noaa</code> vector gives the 
same constituents as <code>hc37</code> but using the NOAA names.
The package is written to be robust to different naming schemes,
and therefore any of these vectors can be used as the <code>hcn</code>
argument to the <code>ftide</code> function.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hc114
task
hc60
hc37
noaa
hc7
hc4
</code></pre>


<h3>Format</h3>

<p>Character vectors of different lengths.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code></p>

<hr>
<h2 id='Hillarys'>Sea-Level Data At Hillarys</h2><span id='topic+Hillarys'></span>

<h3>Description</h3>

<p>The <code>Hillarys</code> data frame has 26304 rows and 2 variables. It
gives hourly sea-levels in metres (above Tide Gauge Zero) recorded 
by the tide gauge within the (UTC) years of 2012-2014. The sea-levels 
are in the second column. The first column is a POSIXct object 
giving the dates and times in UTC.
</p>
<p>Hillarys is one of the sites currently used for the Australian
Baseline Sea-Level Monitoring Project (ABSLMP). Hourly data for
these sites is available from the Australian Bureau of
Meteorology.
</p>
<p>To obtain the sea-level in AHD (Australian Height Datum), you
will need to subtract 0.763 metres from the values given in the
dataset.
</p>
<p>Hillarys is located in the south-west of Australia, where tides
are typically diurnal (i.e. one high tide per day). The 
amplitudes of K1 and O1 will likely be larger than the 
amplitudes of M2 and S2.
</p>
<p>This dataset is is used for the examples in the help files.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hillarys</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>DateTime</dt><dd><p>A POSIXct object where times are in UTC.</p>
</dd>
<dt>SeaLevel</dt><dd><p>The sea-level in metres above Tide Gauge Zero. 
Any missing or erroneous data points are set to NA.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Australian Bureau of Meteorology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code></p>

<hr>
<h2 id='lambdas'>Calculates Astronomical Longitudes</h2><span id='topic+lambdas'></span>

<h3>Description</h3>

<p>Calculates astronomical longitudes for given days.
Mainly for internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  lambdas(dvec, astlon = c("task","cartwright"), ...)  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lambdas_+3A_dvec">dvec</code></td>
<td>
<p>A vector of days. Should be a Date object or an
object that can be converted to a Date object.</p>
</td></tr>
<tr><td><code id="lambdas_+3A_astlon">astlon</code></td>
<td>
<p>The longitude formula to be used. The default
&quot;task&quot; is the formulas use in the TASK-2000 software. The
alternative &quot;cartwright&quot; uses Cartwright(1982).</p>
</td></tr>
<tr><td><code id="lambdas_+3A_...">...</code></td>
<td>
<p>Passed to the as.Date function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix. Values are in degrees and given in the 
interval [0,360]. The rows represent astronomical periods 
of increasing length: sidereal month (s), tropical year (h), 
lunar perigee (p), lunar nodal (N), sun's perihelion (ph).
These correspond to the last five Doodson numbers.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>days &lt;- seq(as.Date("2012-12-30"), as.Date("2013-01-08"), 1)
lambdas(days)
</code></pre>

<hr>
<h2 id='nodal_adj'>Calculate nodal corrections.</h2><span id='topic+nodal_adj'></span>

<h3>Description</h3>

<p>Calculates nodal corrections from astronomical longitudes (lambdas).
Mainly for internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nodal_adj(lambp, lambN, lambph, indegree = TRUE, outdegree = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nodal_adj_+3A_lambp">lambp</code></td>
<td>
<p>Lambdas for the lunar perigee (p).</p>
</td></tr>
<tr><td><code id="nodal_adj_+3A_lambn">lambN</code></td>
<td>
<p>Lambdas for the lunar nodal (N).</p>
</td></tr>
<tr><td><code id="nodal_adj_+3A_lambph">lambph</code></td>
<td>
<p>Lambdas for the sun's perihelion (ph).</p>
</td></tr>
<tr><td><code id="nodal_adj_+3A_indegree">indegree</code></td>
<td>
<p>If <code>FALSE</code>, the lambdas are in radians. 
Degrees are assumed by default.</p>
</td></tr>
<tr><td><code id="nodal_adj_+3A_outdegree">outdegree</code></td>
<td>
<p>If <code>FALSE</code>, the returned phase 
corrections are in radians. Degrees are produced by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements, where both are matrices with 409 rows,
which correspond to the 409 harmonic constituents available in the
package. The first element <code>fn</code> gives the amplitude corrections.
The second element <code>un</code> gives the phase corrections.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+lambdas">lambdas</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>days &lt;- seq(as.Date("2012-12-30"), as.Date("2013-01-08"), 1)
lamb &lt;- lambdas(days)
nodal_adj(lamb[3,], lamb[4,], lamb[5,])
</code></pre>

<hr>
<h2 id='plagtz'>Convert Phase Lag</h2><span id='topic+plagtz'></span>

<h3>Description</h3>

<p>Converts phase lags between different time zones.
Mainly for internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  plagtz(plag, tzd, indegree = TRUE, outdegree = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plagtz_+3A_plag">plag</code></td>
<td>
<p>A named numeric vector of phase lags, where the
names must correspond to the harmonic components. The names
must be those used by this package, which are in the first
column of the <code>harmonics</code> object.</p>
</td></tr>
<tr><td><code id="plagtz_+3A_tzd">tzd</code></td>
<td>
<p>The time difference in hours. For example, when
converting from UTC to Australian Eastern Standard Time (AEST), 
this value must be positive 10.</p>
</td></tr>
<tr><td><code id="plagtz_+3A_indegree">indegree</code></td>
<td>
<p>If <code>FALSE</code>, the <code>plag</code> phase lags 
are in radians. Degrees are assumed by default.</p>
</td></tr>
<tr><td><code id="plagtz_+3A_outdegree">outdegree</code></td>
<td>
<p>If <code>FALSE</code>, the returned phase lags 
are in radians. Degrees are produced by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector. By convention, phase lags are given in the
interval [0,360] for degrees or [0,2pi] for radians.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+coef.tide">coef.tide</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pvec &lt;- c(M2 = 34.2, S2 = 256.8)
plagtz(pvec, tzd = 10)
</code></pre>

<hr>
<h2 id='plot.tide'>Plot Tidal Object</h2><span id='topic+plot.tide'></span>

<h3>Description</h3>

<p>Plot line traces of estimated tide levels against time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tide'
plot(x, from, to, by = NULL, split = FALSE, which = NULL, 
  msl = !split, ask = split &amp;&amp; dev.interactive(), main = NULL, 
  xlab = "Times", ylab = "Level", ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.tide_+3A_x">x</code></td>
<td>
<p>An object of class <code>'tide'</code>.</p>
</td></tr>
<tr><td><code id="plot.tide_+3A_from">from</code></td>
<td>
<p>Time and date from which to plot. Should be a POSIXct
object or something which can be converted to a POSIXct object.
If no time zone is given then UTC is assumed.</p>
</td></tr>
<tr><td><code id="plot.tide_+3A_to">to</code></td>
<td>
<p>Time and date up to which to plot. Should be a POSIXct
object or something which can be converted to a POSIXct object.
If no time zone is given then UTC is assumed.</p>
</td></tr>
<tr><td><code id="plot.tide_+3A_by">by</code></td>
<td>
<p>The time interval in hours between calculated tidal 
predictions. If <code>NULL</code>, then the time interval is that which
produces 1000 evaluations between <code>from</code> and <code>to</code>.</p>
</td></tr>
<tr><td><code id="plot.tide_+3A_split">split</code></td>
<td>
<p>If <code>TRUE</code>, plot values for harmonic constituents
separately. Otherwise, the constituents are summed.</p>
</td></tr>
<tr><td><code id="plot.tide_+3A_which">which</code></td>
<td>
<p>If <code>NULL</code>, use all fitted harmonic constituents.
If not <code>NULL</code>, then should be a character vector giving the names
of the selected constituents.</p>
</td></tr>
<tr><td><code id="plot.tide_+3A_msl">msl</code></td>
<td>
<p>Add the mean sea-level to the plots? A time-varying mean
sea-level will be used if this has been implemented for the tidal 
object.</p>
</td></tr>
<tr><td><code id="plot.tide_+3A_xlab">xlab</code>, <code id="plot.tide_+3A_ylab">ylab</code></td>
<td>
<p>Graphical parameters.</p>
</td></tr>
<tr><td><code id="plot.tide_+3A_main">main</code>, <code id="plot.tide_+3A_ask">ask</code></td>
<td>
<p>Graphical parameters.</p>
</td></tr>
<tr><td><code id="plot.tide_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed through to plotting
functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that nodal corrections and time-varying mean sea-levels will 
be used if and only if they were implemented for the tidal object.
The longitude formulas will also be the same as those used for the
tidal object.
</p>
<p>The dates/times plotted on the x-axis correspond to the time zone
used for the <code>from</code> object.  
</p>


<h3>Value</h3>

<p>A list of times and predictions is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+predict.tide">predict.tide</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>hfit1 &lt;- ftide(Hillarys$SeaLevel, Hillarys$DateTime, hc60)
hfit2 &lt;- ftide(Hillarys$Sea, Hillarys$Date, hc7, smsl=TRUE)
t1 &lt;- as.POSIXct("2012-12-31 23:00", tz = "UTC")
t2 &lt;- as.POSIXct("2013-01-02 14:00", tz = "UTC")
plot(hfit1, t1, t2)
plot(hfit2, t1, t2, split = TRUE)
plot(hfit2, t1, t2, split = TRUE, which = c("M2","S2"))
plot(hfit2, t1, t2, which = "M2", msl = FALSE)
</code></pre>

<hr>
<h2 id='PortKembla'>Sea-Level Data At Port Kembla</h2><span id='topic+PortKembla'></span>

<h3>Description</h3>

<p>The <code>PortKembla</code> data frame has 26304 rows and 2 variables. It
gives hourly sea-levels in metres (above Tide Gauge Zero) recorded 
by the tide gauge within the (UTC) years of 2012-2014. The sea-levels 
are in the second column. The first column is a POSIXct object 
giving the dates and times in UTC.
</p>
<p>Port Kembla is one of the sites currently used for the Australian
Baseline Sea-Level Monitoring Project (ABSLMP). Hourly data for
these sites is available from the Australian Bureau of
Meteorology.
</p>
<p>To obtain the sea-level in AHD (Australian Height Datum), you
will need to subtract 0.872 metres from the values given in the
dataset.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PortKembla</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>DateTime</dt><dd><p>A POSIXct object where times are in UTC.</p>
</dd>
<dt>SeaLevel</dt><dd><p>The sea-level in metres above Tide Gauge Zero. 
Any missing or erroneous data points are set to NA.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Australian Bureau of Meteorology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code></p>

<hr>
<h2 id='Portland'>Sea-Level Data At Portland</h2><span id='topic+Portland'></span>

<h3>Description</h3>

<p>The <code>Portland</code> data frame has 26304 rows and 2 variables. It
gives hourly sea-levels in metres (above Tide Gauge Zero) recorded 
by the tide gauge within the (UTC) years of 2012-2014. The sea-levels 
are in the second column. The first column is a POSIXct object 
giving the dates and times in UTC.
</p>
<p>Portland is one of the sites currently used for the Australian
Baseline Sea-Level Monitoring Project (ABSLMP). Hourly data for
these sites is available from the Australian Bureau of
Meteorology.
</p>
<p>To obtain the sea-level in AHD (Australian Height Datum), you
will need to subtract 0.507 metres from the values given in the
dataset.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Portland</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>DateTime</dt><dd><p>A POSIXct object where times are in UTC.</p>
</dd>
<dt>SeaLevel</dt><dd><p>The sea-level in metres above Tide Gauge Zero. 
Any missing or erroneous data points are set to NA.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Australian Bureau of Meteorology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code></p>

<hr>
<h2 id='predict.tide'>Predict The Tide Using Tidal Object</h2><span id='topic+predict.tide'></span>

<h3>Description</h3>

<p>Predict the tide values at specified times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tide'
predict(object, from, to, by = NULL, split = FALSE, 
  which = NULL, msl = !split, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.tide_+3A_object">object</code></td>
<td>
<p>An object of class <code>'tide'</code>.</p>
</td></tr>
<tr><td><code id="predict.tide_+3A_from">from</code></td>
<td>
<p>Time and date from which to calculate tide values. 
Should be a POSIXct object or something which can be converted 
to a POSIXct object. If no time zone is given then UTC is 
assumed.</p>
</td></tr>
<tr><td><code id="predict.tide_+3A_to">to</code></td>
<td>
<p>Time and date up to which to calculate tide values. 
Should be a POSIXct object or something which can be converted 
to a POSIXct object. If no time zone is given then UTC is 
assumed.</p>
</td></tr>
<tr><td><code id="predict.tide_+3A_by">by</code></td>
<td>
<p>The time interval in hours between calculated tidal 
predictions. If <code>NULL</code>, then the time interval is that which
produces 1000 evaluations between <code>from</code> and <code>to</code>.</p>
</td></tr>
<tr><td><code id="predict.tide_+3A_split">split</code></td>
<td>
<p>If <code>TRUE</code>, predictions are given for harmonic 
constituents separately. Otherwise, the constituents are summed.</p>
</td></tr>
<tr><td><code id="predict.tide_+3A_which">which</code></td>
<td>
<p>If <code>NULL</code>, use all fitted harmonic constituents.
If not NULL, then should be a character vector giving the names
of the selected constituents.</p>
</td></tr>
<tr><td><code id="predict.tide_+3A_msl">msl</code></td>
<td>
<p>Add the mean sea-level to the predictions? A time-varying 
mean sea-level will be used if this has been implemented for the tidal 
object.</p>
</td></tr>
<tr><td><code id="predict.tide_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that nodal corrections and time-varying mean sea-levels will 
be used if and only if they were implemented for the tidal object.
The longitude formulas will also be the same as those used for the
tidal object.  
</p>


<h3>Value</h3>

<p>A numeric vector of predictions (if <code>split</code> is <code>FALSE</code>) or
a numeric matrix of predictions (if <code>split</code> is <code>TRUE</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+plot.tide">plot.tide</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>hfit1 &lt;- ftide(Hillarys$SeaLevel, Hillarys$DateTime, hc60)
hfit2 &lt;- ftide(Hillarys$Sea, Hillarys$Date, hc7, smsl=TRUE)
t1 &lt;- as.POSIXct("2012-12-31 23:00", tz = "UTC")
t2 &lt;- as.POSIXct("2013-01-01 14:00", tz = "UTC")
predict(hfit1, t1, t2)
predict(hfit2, t1, t2, split = TRUE)
predict(hfit2, t1, t2, split = TRUE, which = c("M2","S2"))
predict(hfit2, t1, t2, which = "M2", msl = FALSE)
</code></pre>

<hr>
<h2 id='print.tide'>Print Tidal Object</h2><span id='topic+print.tide'></span>

<h3>Description</h3>

<p>Printing a tidal object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tide'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.tide_+3A_x">x</code></td>
<td>
<p>An object of class <code>'tide'</code>.</p>
</td></tr>
<tr><td><code id="print.tide_+3A_digits">digits</code></td>
<td>
<p>Number of printed digits.</p>
</td></tr>
<tr><td><code id="print.tide_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A different features vector is printed based on whether the form factor
is less than 0.5 (indicating a semi-diurnal site) or greater than or 
equal to 0.5 (indicating a diurnal or mixed semi-diurnal site). If the 
four harmonic constituents M2 S2 K1 O1 are not included in the fit, then
the features vector cannot be calculated and is not printed.
</p>
<p>Phase lags are always printed with respect to UTC. The <code>utc</code> 
argument of <code>coef.tide</code> can be used to produce phase lags for 
different time zones.  
</p>


<h3>Value</h3>

<p>The tidal object is invisibly returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+coef.tide">coef.tide</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>hfit1 &lt;- ftide(Hillarys$SeaLevel, Hillarys$DateTime, hc60)
hfit2 &lt;- ftide(Hillarys$Sea, Hillarys$Date, hc7, smsl=TRUE)
hfit1
hfit2
</code></pre>

<hr>
<h2 id='spdlunar'>Speeds For Basic Astronomical Periods</h2><span id='topic+spdlunar'></span><span id='topic+spdsolar'></span>

<h3>Description</h3>

<p>The <code>spdlunar</code> vector contains speeds (angular frequencies) in
degrees per msh (mean solar hour) for the astronomic periods 
corresponding to the six digits of the (lunar) Doodson number.
The periods are given by (i) the mean lunar day (ii) the sidereal month
(iii) the tropical year (iv) the perigeal cycle of the moon (v)
the nodal cycle of the moon (vi) the perihelion cycle of the sun.
</p>
<p>The <code>spdsolar</code> vector contains speeds (angular frequencies) in
degrees per msh (mean solar hour) for the astronomic periods 
corresponding to the six digits of the solar Doodson number.
It is the same as <code>spdlunar</code> except that the first value
corresponds to the mean solar day instead of the mean lunar day.
</p>
<p>To obtain the astronomic periods in msh, take the inverse of the vector 
and multiply by 360.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spdlunar
spdsolar
</code></pre>


<h3>Format</h3>

<p>Numeric vectors of length six.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+harmonics">harmonics</a></code>
</p>

<hr>
<h2 id='Thevenard'>Sea-Level Data At Thevenard</h2><span id='topic+Thevenard'></span>

<h3>Description</h3>

<p>The <code>Thevenard</code> data frame has 26304 rows and 2 variables. It
gives hourly sea-levels in metres (above Tide Gauge Zero) recorded 
by the tide gauge within the (UTC) years of 2012-2014. The sea-levels 
are in the second column. The first column is a POSIXct object 
giving the dates and times in UTC.
</p>
<p>Thevenard is one of the sites currently used for the Australian
Baseline Sea-Level Monitoring Project (ABSLMP). Hourly data for
these sites is available from the Australian Bureau of
Meteorology.
</p>
<p>To obtain the sea-level in AHD (Australian Height Datum), you
will need to subtract 0.993 metres from the values given in the
dataset.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Thevenard</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>DateTime</dt><dd><p>A POSIXct object where times are in UTC.</p>
</dd>
<dt>SeaLevel</dt><dd><p>The sea-level in metres above Tide Gauge Zero. 
Any missing or erroneous data points are set to NA.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Australian Bureau of Meteorology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftide">ftide</a></code>, <code><a href="#topic+harmonics">harmonics</a></code></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
