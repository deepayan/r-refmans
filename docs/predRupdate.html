<!DOCTYPE html><html lang="en-US"><head><title>Help for package predRupdate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {predRupdate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#predRupdate-package'><p>predRupdate: Prediction Model Validation and Updating</p></a></li>
<li><a href='#dummy_vars'><p>Create dummy variables for all categorical/factor variables in a data.frame</p></a></li>
<li><a href='#inv_logit'><p>Apply the inverse logit function to an input</p></a></li>
<li><a href='#logit'><p>Apply a logit transformation to an input</p></a></li>
<li><a href='#map_newdata'><p>Map new data to a predinfo object</p></a></li>
<li><a href='#pred_input_info'><p>Input information about an existing prediction model</p></a></li>
<li><a href='#pred_predict'><p>Make predictions from an existing prediction model</p></a></li>
<li><a href='#pred_stacked_regression'><p>Perform Stacked Regression on Existing Prediction Models</p></a></li>
<li><a href='#pred_update'><p>Perform Model Updating on an Existing Prediction Model</p></a></li>
<li><a href='#pred_val_probs'><p>Validate Predicted Probabilities</p></a></li>
<li><a href='#pred_validate'><p>Validate an existing prediction</p></a></li>
<li><a href='#SYNPM'><p>SYNthetic Prediction Models (SYNPM) and Validation dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Prediction Model Validation and Updating</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Evaluate the predictive performance of an existing (i.e. previously 
    developed) prediction/ prognostic model given relevant information about the 
    existing prediction model (e.g. coefficients) and a new dataset. Provides a 
    range of model updating methods that help tailor the existing model to the 
    new dataset; see Su et al. (2018) &lt;<a href="https://doi.org/10.1177%2F0962280215626466">doi:10.1177/0962280215626466</a>&gt;. Techniques 
    to aggregate multiple existing prediction models on the new data are also 
    provided; see Debray et al. (2014) &lt;<a href="https://doi.org/10.1002%2Fsim.6080">doi:10.1002/sim.6080</a>&gt; and Martin et al. 
    (2018) &lt;<a href="https://doi.org/10.1002%2Fsim.7586">doi:10.1002/sim.7586</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/GlenMartin31/predRupdate">https://github.com/GlenMartin31/predRupdate</a>,
<a href="https://glenmartin31.github.io/predRupdate/">https://glenmartin31.github.io/predRupdate/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/GlenMartin31/predRupdate/issues">https://github.com/GlenMartin31/predRupdate/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, stats, survival, pROC, ggplot2, rlang, ggpubr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-23 14:08:27 UTC; glenmartin</td>
</tr>
<tr>
<td>Author:</td>
<td>Glen P. Martin <a href="https://orcid.org/0000-0002-3410-9472"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  David Jenkins [aut, cph],
  Matthew Sperrin [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Glen P. Martin &lt;glen.martin31@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-23 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='predRupdate-package'>predRupdate: Prediction Model Validation and Updating</h2><span id='topic+predRupdate'></span><span id='topic+predRupdate-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Evaluate the predictive performance of an existing (i.e. previously developed) prediction/ prognostic model given relevant information about the existing prediction model (e.g. coefficients) and a new dataset. Provides a range of model updating methods that help tailor the existing model to the new dataset; see Su et al. (2018) <a href="https://doi.org/10.1177/0962280215626466">doi:10.1177/0962280215626466</a>. Techniques to aggregate multiple existing prediction models on the new data are also provided; see Debray et al. (2014) <a href="https://doi.org/10.1002/sim.6080">doi:10.1002/sim.6080</a> and Martin et al. (2018) <a href="https://doi.org/10.1002/sim.7586">doi:10.1002/sim.7586</a>).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Glen P. Martin <a href="mailto:glen.martin31@gmail.com">glen.martin31@gmail.com</a> (<a href="https://orcid.org/0000-0002-3410-9472">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> David Jenkins <a href="mailto:david.jenkins-5@manchester.ac.uk">david.jenkins-5@manchester.ac.uk</a> [copyright holder]
</p>
</li>
<li><p> Matthew Sperrin <a href="mailto:matthew.sperrin@manchester.ac.uk">matthew.sperrin@manchester.ac.uk</a> [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/GlenMartin31/predRupdate">https://github.com/GlenMartin31/predRupdate</a>
</p>
</li>
<li> <p><a href="https://glenmartin31.github.io/predRupdate/">https://glenmartin31.github.io/predRupdate/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/GlenMartin31/predRupdate/issues">https://github.com/GlenMartin31/predRupdate/issues</a>
</p>
</li></ul>


<hr>
<h2 id='dummy_vars'>Create dummy variables for all categorical/factor variables in a data.frame</h2><span id='topic+dummy_vars'></span>

<h3>Description</h3>

<p>Create dummy/indicator variables for all categorical variables in a
data.frame. Can be used as a pre-processing step before calling other
functions within the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dummy_vars(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dummy_vars_+3A_df">df</code></td>
<td>
<p>a data.frame on which to make dummy variables for each
categorical/factor variable, based on contrasts.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame matching <code>df</code> but where each categorical
variable in <code>df</code> is replaced with indicator variables. All
combinations of the indicator/dummy variable are returned. Naming
convention of the new dummy variables is variable_level. For example, a
factor variable in <code>df</code> named &quot;colour&quot; with levels &quot;red&quot;, &quot;green&quot; and
&quot;purple&quot; will be replaced with three columns (the new dummy variables),
named colour_red,  colour_green and colour_purple.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred_input_info">pred_input_info</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dummy_vars(data.frame("Colour" = factor(sample(c("red",
                                                 "azure",
                                                 "green",
                                                 "white"),
                                              500,
                                              replace = TRUE))))
</code></pre>

<hr>
<h2 id='inv_logit'>Apply the inverse logit function to an input</h2><span id='topic+inv_logit'></span>

<h3>Description</h3>

<p><code>inv_logit</code> applies the inverse-logit transformation (expit/ logistic
function) to convert a vector of values between -Inf and Inf, to values
between 0 and 1. Used to convert the linear predictor of a logistic
regression model into a probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inv_logit(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inv_logit_+3A_x">x</code></td>
<td>
<p>Numeric vector with values between -Inf and Inf.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of probabilities (i.e. values between 0 and 1)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logit">logit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>inv_logit(-2)
inv_logit(c(-2,-1,0,1,2))
</code></pre>

<hr>
<h2 id='logit'>Apply a logit transformation to an input</h2><span id='topic+logit'></span>

<h3>Description</h3>

<p><code>logit</code> applies the logit transformation to convert a vector of values
between 0 and 1, to values between -Inf and Inf. Used to convert a
probability from a logistic regression model onto the linear predictor scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logit(p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logit_+3A_p">p</code></td>
<td>
<p>Numeric vector of probabilities (i.e. values between 0 and 1) that
will be transformed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector, with values between -Inf and Inf
</p>


<h3>See Also</h3>

<p><code><a href="#topic+inv_logit">inv_logit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logit(0.5)
logit(c(0.1, 0.2, 0.3))
</code></pre>

<hr>
<h2 id='map_newdata'>Map new data to a predinfo object</h2><span id='topic+map_newdata'></span>

<h3>Description</h3>

<p>This function takes a <code>predinfo</code> object and applies (maps) a new data to
this object to check there is consistency between the two. This function is
not usually called directly, but rather within  other functions within the
package, such as <code>pred_predict</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_newdata(
  x,
  new_data,
  binary_outcome = NULL,
  survival_time = NULL,
  event_indicator = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map_newdata_+3A_x">x</code></td>
<td>
<p>an object of class &quot;predinfo&quot;.</p>
</td></tr>
<tr><td><code id="map_newdata_+3A_new_data">new_data</code></td>
<td>
<p>data.frame upon which the prediction model should be applied
(for subsequent validation/model updating/model aggregation).</p>
</td></tr>
<tr><td><code id="map_newdata_+3A_binary_outcome">binary_outcome</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed binary outcomes (should be
coded 0 and 1 for non-event and event, respectively). Only relevant for
<code>model_type</code>=&quot;logistic&quot;; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any outcomes.</p>
</td></tr>
<tr><td><code id="map_newdata_+3A_survival_time">survival_time</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival times. Only relevant
for <code>model_type</code>=&quot;survival&quot;; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any survival outcomes.</p>
</td></tr>
<tr><td><code id="map_newdata_+3A_event_indicator">event_indicator</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival indicator (1 for
event, 0 for censoring). Only relevant for <code>model_type</code>=&quot;survival&quot;;
leave as <code>NULL</code> otherwise. Leave as <code>NULL</code> if <code>new_data</code>
does not contain any survival outcomes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function maps a new dataset onto a <code>pred_info</code> object. The
new dataset might be a validation dataset (to test the performance of the
existing prediction model) and/or it might be the dataset on which one
wishes to apply model updating methods to revise the model. In any case,
this should be specified in <code>new_data</code> as a data.frame. Each row
should be an observation (e.g. patient) and each variable/column should be
a predictor variable. The predictor variables need to include (as a
minimum) all of the predictor variables that are included in the existing
prediction model (i.e., each of the variable names supplied to
<code><a href="#topic+pred_input_info">pred_input_info</a></code>, through the <code>model_info</code> parameter,
must match the name of a variables in <code>new_data</code>).
</p>
<p>Any factor variables within <code>new_data</code> must be converted to dummy
(0/1) variables before calling this function. <code><a href="#topic+dummy_vars">dummy_vars</a></code> can
help with this.
</p>
<p><code>binary_outcome</code>, <code>survival_time</code> and <code>event_indicator</code> are
used to specify the outcome variable(s) within <code>new_data</code>, if relevant
(use <code>binary_outcome</code> if <code>model_type</code> = &quot;logistic&quot;, or use
<code>survival_time</code> and <code>event_indicator</code> if <code>model_type</code> =
&quot;survival&quot;). For example, if validating an existing model, then these
inputs specify the columns of <code>new_data</code> that will be used for
assessing predictive performance of the predictions in the validation
dataset. If <code>new_data</code> does not contain outcomes, then leave these
inputs to the default of <code>NULL</code>.
</p>


<h3>Value</h3>

<p>Returns a list of the predinfo object, the new_data, and outcomes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#as above, this function is not usually called directly, but an example of
#such use is:
model1 &lt;- pred_input_info(model_type = "logistic",
                          model_info = SYNPM$Existing_logistic_models[1,])
map_newdata(x = model1,
            new_data = SYNPM$ValidationData[1:10,],
            binary_outcome = "Y")

</code></pre>

<hr>
<h2 id='pred_input_info'>Input information about an existing prediction model</h2><span id='topic+pred_input_info'></span>

<h3>Description</h3>

<p>Input coefficient information about one or multiple existing prediction
model(s), for use in other functions in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_input_info(
  model_type = c("logistic", "survival"),
  model_info,
  cum_hazard = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred_input_info_+3A_model_type">model_type</code></td>
<td>
<p>specifies the type of model that the existing prediction
model is based on; possible options are: </p>
 <ul>
<li> <p><code>"logistic"</code>
indicates that the existing model was based on a logistic regression model
(default) </p>
</li>
<li> <p><code>"survival"</code> indicates that the existing model was
based on a survival regression model </p>
</li></ul>
<p> If multiple models are being
entered, then all models need to be of the same type - otherwise call
function multiple times for each type of model.</p>
</td></tr>
<tr><td><code id="pred_input_info_+3A_model_info">model_info</code></td>
<td>
<p>a data.frame that contains the coefficients of the existing
prediction model(s). Each column should be a predictor variable (with the
name of the column being the name of the predictor variable), with the
values being the coefficients, taken exactly as published from the existing
prediction model(s). Multiple existing prediction models should be
specified by entering multiple rows. If a predictor variable is not present
in a given model then enter that cell of the data.frame as NA. See
examples.</p>
</td></tr>
<tr><td><code id="pred_input_info_+3A_cum_hazard">cum_hazard</code></td>
<td>
<p>A data.frame with two columns: (1) time, and (2) estimated
cumulative baseline hazard at that time. The first column (time) should be
named 'time' and the second (cumulative baseline hazard) should be named
'hazard'. Only relevant if <code>model_type</code> is &quot;survival&quot;; leave as NULL
otherwise. If multiple existing models entered, and model_type = survival,
then <code>cum_hazard</code> should be supplied as list of length equal to number
of models.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will structure the relevant information about one or
more existing prediction model(s) into a standardised format, such that it
can be used within other functions in the package.
</p>
<p>First, the existing prediction model(s) will have a functional form (i.e.
the linear predictor of the model); this will be taken as being a linear
combination of the variables specified by the columns of <code>model_info</code>.
</p>
<p>Second, each of the predictor variables of the existing prediction model(s)
will have a published coefficient (e.g. log-odds-ratio or
log-hazard-ratio), which should each be given as the values of
<code>model_info</code>. If entering information about multiple existing
prediction models, then <code>model_info</code> will contain multiple rows (one
per existing model). Here, if a given model does not contain a predictor
variable that is included in another model, then set as NA; see examples of
this below.
</p>
<p>In the case of <code>model_type</code> = &quot;logistic&quot;, then <code>model_info</code> must
contain a column named as &quot;Intercept&quot;, which gives the intercept
coefficient of each of the existing logistic regression models (taken
exactly as previously published); this should be the first column of
<code>model_info</code>.
</p>
<p>If <code>model_type</code> = &quot;survival&quot;, then the baseline cumulative hazard of
the model(s) can be specified in <code>cum_hazard</code>. If the baseline
cumulative hazard of the existing survival model is not available, then
leave as NULL; this will limit any validation metrics that can be
calculated.
</p>
<p>Note, the column names of <code>model_info</code> should match columns in any new
data that the existing model(s) will be applied to (i.e. any new data that
will be provided to other functions within the package should have
corresponding predictor variables entered through <code>model_info</code>). See
<code><a href="#topic+pred_predict">pred_predict</a></code>, <code><a href="#topic+pred_validate">pred_validate</a></code>,
<code><a href="#topic+pred_update">pred_update</a></code> and <code><a href="#topic+pred_stacked_regression">pred_stacked_regression</a></code> for
more information.
</p>


<h3>Value</h3>

<p><code><a href="#topic+pred_input_info">pred_input_info</a></code> returns an object of class
&quot;<code>predinfo</code>&quot;, with child classes per <code>model_type</code>. This is a
standardised format, such that it can be used with other functions in the
package. An object of class &quot;<code>predinfo</code>&quot; is a list containing the
following components:
</p>
 <ul>
<li><p>M = the number of existing models that information has been
entered about </p>
</li>
<li><p>model_type = this is the type of model that
the existing prediction model is based upon (&quot;logistic&quot; or &quot;survival&quot;)
</p>
</li>
<li><p>coefs = this is the set of (previously estimated) coefficients for
each predictor variable </p>
</li>
<li><p>coef_names = gives the names of each
predictor variable </p>
</li>
<li><p>formula = this is the functional form of the
model's linear predictor </p>
</li>
<li><p>cum_hazard = if supplied, this is the
cumulative baseline hazard of the existing model(s)</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>#Example 1 - logistic regression existing model
# create a data.frame of the model coefficients, with columns being variables
coefs_table &lt;- data.frame("Intercept" = -3.4,
                          "SexM" = 0.306,
                          "Smoking_Status" = 0.628,
                          "Diabetes" = 0.499,
                          "CKD" = 0.538)
#pass this into pred_input_info()
Existing_Logistic_Model &lt;- pred_input_info(model_type = "logistic",
                                           model_info = coefs_table)
summary(Existing_Logistic_Model)

#Example 2 - survival model example; uses an example dataset within the
#             package.
pred_input_info(model_type = "survival",
                model_info = SYNPM$Existing_TTE_models[2,],
                cum_hazard = SYNPM$TTE_mod2_baseline)

#Example 3 - Input information about multiple models
summary(pred_input_info(model_type = "logistic",
                        model_info = SYNPM$Existing_logistic_models))

</code></pre>

<hr>
<h2 id='pred_predict'>Make predictions from an existing prediction model</h2><span id='topic+pred_predict'></span>

<h3>Description</h3>

<p>Use an existing prediction model to estimate predicted risks of the outcome
for each observation in a new dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_predict(
  x,
  new_data,
  binary_outcome = NULL,
  survival_time = NULL,
  event_indicator = NULL,
  time_horizon = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred_predict_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>predinfo</code>&quot; produced by calling
<code><a href="#topic+pred_input_info">pred_input_info</a></code>.</p>
</td></tr>
<tr><td><code id="pred_predict_+3A_new_data">new_data</code></td>
<td>
<p>data.frame upon which predictions are obtained using the
prediction model.</p>
</td></tr>
<tr><td><code id="pred_predict_+3A_binary_outcome">binary_outcome</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed binary outcomes (should be
coded 0 and 1 for non-event and event, respectively). Only relevant for
<code>model_type</code>=&quot;logistic&quot;; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any outcomes.</p>
</td></tr>
<tr><td><code id="pred_predict_+3A_survival_time">survival_time</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival times. Only relevant
for <code>model_type</code>=&quot;survival&quot;; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any survival outcomes.</p>
</td></tr>
<tr><td><code id="pred_predict_+3A_event_indicator">event_indicator</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival indicator (1 for
event, 0 for censoring). Only relevant for <code>model_type</code>=&quot;survival&quot;;
leave as <code>NULL</code> otherwise. Leave as <code>NULL</code> if <code>new_data</code>
does not contain any survival outcomes.</p>
</td></tr>
<tr><td><code id="pred_predict_+3A_time_horizon">time_horizon</code></td>
<td>
<p>for survival models, an integer giving the time horizon
(post baseline) at which a prediction is required (i.e.
the t at which P(T&lt;t) should be estimated). Currently, this must match a
time in x$cum_hazard. If left as NULL, no predicted risks will be returned,
just the linear predictor.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes the relevant information about the existing
prediction model (as supplied by calling <code><a href="#topic+pred_input_info">pred_input_info</a></code>),
and returns the linear predictor and predicted risks for each
individual/observation in <code>new_data</code>.
</p>
<p>If the existing prediction model is based on logistic regression (i.e., if
x$model_type == &quot;logistic&quot;), the predicted risks will be the predicted
probability of the binary outcome conditional on the predictor variables in
the new data (i.e., P(Y=1 | X)). If the existing prediction model is
based on a time-to-event/survival model (i.e., if x$model_type ==
&quot;survival&quot;), the predicted risks can only be calculated if a baseline
cumulative hazard is provided; in this case, the predicted risks will be one
minus the survival probability (i.e., 1 - S(T&gt;time horizon
| X)).
</p>
<p><code>new_data</code> should be a data.frame, where each row should be an
observation (e.g. patient) and each variable/column should be a predictor
variable. The predictor variables need to include (as a minimum) all of the
predictor variables that are included in the existing prediction model
(i.e., each of the variable names supplied to
<code><a href="#topic+pred_input_info">pred_input_info</a></code>, through the <code>model_info</code> parameter,
must match the name of a variables in <code>new_data</code>).
Any factor variables within <code>new_data</code> must be converted to dummy
(0/1) variables before calling this function. <code><a href="#topic+dummy_vars">dummy_vars</a></code> can
help with this. See examples.
</p>
<p><code>binary_outcome</code>, <code>survival_time</code> and <code>event_indicator</code> are
used to specify the outcome variable(s) within <code>new_data</code> (use
<code>binary_outcome</code> if <code>x$model_type</code> = &quot;logistic&quot;, or use
<code>survival_time</code> and <code>event_indicator</code> if <code>x$model_type</code> =
&quot;survival&quot;).
</p>


<h3>Value</h3>

<p><code><a href="#topic+pred_predict">pred_predict</a></code> returns a list containing the following
components: </p>
 <ul>
<li><p>LinearPredictor = the linear predictor for each
observation in the new data (i.e., the linear combination of the models
predictor variables and their corresponding coefficients)
</p>
</li>
<li><p>PredictedRisk = the predicted risk for each observation in the new
data </p>
</li>
<li><p>TimeHorizon = for survival models, an integer giving the time
horizon at which a prediction is made </p>
</li>
<li><p>Outcomes = vector of
outcomes/endpoints (if available). </p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+pred_input_info">pred_input_info</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1 - logistic regression existing model - shows handling of factor variables
coefs_table &lt;- data.frame("Intercept" = -3.4,
                          "Sex_M" = 0.306,
                          "Smoking_Status" = 0.628)
existing_Logistic_Model &lt;- pred_input_info(model_type = "logistic",
                                           model_info = coefs_table)
new_df &lt;- data.frame("Sex" = as.factor(c("M", "F", "M", "M", "F", "F", "M")),
                     "Smoking_Status" = c(1, 0, 0, 1, 1, 0, 1))
#new_df has a factor variable, so needs indicator variables creating before pred_predict:
new_df_indicators &lt;- dummy_vars(new_df)
pred_predict(x = existing_Logistic_Model,
             new_data = new_df_indicators)

#Example 2 - survival model example; uses an example dataset within the
#             package. Multiple existing models
model2 &lt;- pred_input_info(model_type = "survival",
                          model_info = SYNPM$Existing_TTE_models,
                          cum_hazard = list(SYNPM$TTE_mod1_baseline,
                                                SYNPM$TTE_mod2_baseline,
                                                SYNPM$TTE_mod3_baseline))
pred_predict(x = model2,
             new_data = SYNPM$ValidationData[1:10,],
             survival_time = "ETime",
             event_indicator = "Status",
             time_horizon = 5)

</code></pre>

<hr>
<h2 id='pred_stacked_regression'>Perform Stacked Regression on Existing Prediction Models</h2><span id='topic+pred_stacked_regression'></span>

<h3>Description</h3>

<p>This function takes a set of existing prediction models, and uses the new
dataset to combine/aggregate them into a single 'meta-model', as described in
Debray et al. 2014.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_stacked_regression(
  x,
  positivity_constraint = FALSE,
  new_data,
  binary_outcome = NULL,
  survival_time = NULL,
  event_indicator = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred_stacked_regression_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>predinfo</code>&quot; produced by calling
<code><a href="#topic+pred_input_info">pred_input_info</a></code> containing information on at least two
existing prediction models.</p>
</td></tr>
<tr><td><code id="pred_stacked_regression_+3A_positivity_constraint">positivity_constraint</code></td>
<td>
<p>TRUE/FALSE denoting if the weights within the
stacked regression model should be constrained to be non-negative (TRUE) or
should be allowed to take any value (FALSE). See details.</p>
</td></tr>
<tr><td><code id="pred_stacked_regression_+3A_new_data">new_data</code></td>
<td>
<p>data.frame upon which the prediction models should be
aggregated.</p>
</td></tr>
<tr><td><code id="pred_stacked_regression_+3A_binary_outcome">binary_outcome</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed binary outcomes (should be
coded 0 and 1 for non-event and event, respectively). Only relevant for
<code>model_type</code>=&quot;logistic&quot;; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any outcomes.</p>
</td></tr>
<tr><td><code id="pred_stacked_regression_+3A_survival_time">survival_time</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival times. Only relevant
for <code>x$model_type</code>=&quot;survival&quot;; leave as <code>NULL</code> otherwise.</p>
</td></tr>
<tr><td><code id="pred_stacked_regression_+3A_event_indicator">event_indicator</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival indicator (1 for
event, 0 for censoring). Only relevant for <code>x$model_type</code>=&quot;survival&quot;;
leave as <code>NULL</code> otherwise.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a set of (previously estimated) prediction
models that were each originally developed for the same prediction task,
and pool/aggregate these into a single prediction model (meta-model) using
stacked regression based on new data (data not used to develop any of the
existing models). The methodological details can be found in Debray et al.
2014.
</p>
<p>Given that the existing models are likely to be highly co-linear (since
they were each developed for the same prediction task), it has been
suggested to impose a positivity constraint on the weights of the stacked
regression model (Debray et al. 2014.). If <code>positivity_constraint</code> is
set to TRUE, then the stacked regression model will be estimated by
optimising the (log-)likelihood using bound constrained optimization
(&quot;L-BFGS-B&quot;). This is currently only implemented for logistic regression
models (i.e., if <code>x$model_type</code>=&quot;logistic&quot;). For survival models,
positivity_constraint = FALSE.
</p>
<p><code>new_data</code> should be a data.frame, where each row should be an
observation (e.g. patient) and each variable/column should be a predictor
variable. The predictor variables need to include (as a minimum) all of the
predictor variables that are included in the existing prediction models
(i.e., each of the variable names supplied to
<code><a href="#topic+pred_input_info">pred_input_info</a></code>, through the <code>model_info</code> parameter,
must match the name of a variables in <code>new_data</code>).
</p>
<p>Any factor variables within <code>new_data</code> must be converted to dummy
(0/1) variables before calling this function. <code><a href="#topic+dummy_vars">dummy_vars</a></code> can
help with this. See <code><a href="#topic+pred_predict">pred_predict</a></code> for examples.
</p>
<p><code>binary_outcome</code>, <code>survival_time</code> and <code>event_indicator</code> are
used to specify the outcome variable(s) within <code>new_data</code> (use
<code>binary_outcome</code> if <code>x$model_type</code> = &quot;logistic&quot;, or use
<code>survival_time</code> and <code>event_indicator</code> if <code>x$model_type</code> =
&quot;survival&quot;).
</p>


<h3>Value</h3>

<p>A object of class &quot;<code>predSR</code>&quot;. This is the same as that detailed
in <code><a href="#topic+pred_input_info">pred_input_info</a></code>, with the added element containing the
estimates of the meta-model obtained by stacked regression.
</p>


<h3>References</h3>

<p>Debray, T.P., Koffijberg, H., Nieboer, D., Vergouwe, Y.,
Steyerberg, E.W. and Moons, K.G. (2014), Meta-analysis and aggregation of
multiple published prediction models. <em>Statistics in Medicine</em>, 33:
2341-2362
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred_input_info">pred_input_info</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>LogisticModels &lt;- pred_input_info(model_type = "logistic",
                                  model_info = SYNPM$Existing_logistic_models)
SR &lt;- pred_stacked_regression(x = LogisticModels,
                              new_data = SYNPM$ValidationData,
                              binary_outcome = "Y")
summary(SR)

#Survival model example:
TTModels &lt;- pred_input_info(model_type = "survival",
                            model_info = SYNPM$Existing_TTE_models,
                            cum_hazard = list(SYNPM$TTE_mod1_baseline,
                                                  SYNPM$TTE_mod2_baseline,
                                                  SYNPM$TTE_mod3_baseline))
SR &lt;- pred_stacked_regression(x = TTModels,
                              new_data = SYNPM$ValidationData,
                              survival_time = "ETime",
                              event_indicator = "Status")
summary(SR)

</code></pre>

<hr>
<h2 id='pred_update'>Perform Model Updating on an Existing Prediction Model</h2><span id='topic+pred_update'></span>

<h3>Description</h3>

<p>This function takes an existing (previously developed) prediction model and
applies various model updating methods to tailor/adapt it to a new dataset.
Various levels of updating are possible, ranging from model re-calibration to
model refit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_update(
  x,
  update_type = c("intercept_update", "recalibration", "refit"),
  new_data,
  binary_outcome = NULL,
  survival_time = NULL,
  event_indicator = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred_update_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>predinfo</code>&quot; produced by calling
<code><a href="#topic+pred_input_info">pred_input_info</a></code> containing information on exactly one
existing prediction model.</p>
</td></tr>
<tr><td><code id="pred_update_+3A_update_type">update_type</code></td>
<td>
<p>character variable specifying the level of updating that
is required.</p>
</td></tr>
<tr><td><code id="pred_update_+3A_new_data">new_data</code></td>
<td>
<p>data.frame upon which the prediction models should be
updated.</p>
</td></tr>
<tr><td><code id="pred_update_+3A_binary_outcome">binary_outcome</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed binary outcomes (should be
coded 0 and 1 for non-event and event, respectively). Only relevant for
<code>model_type</code>=&quot;logistic&quot;; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any outcomes.</p>
</td></tr>
<tr><td><code id="pred_update_+3A_survival_time">survival_time</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival times. Only relevant
for <code>x$model_type</code>=&quot;survival&quot;; leave as <code>NULL</code> otherwise.</p>
</td></tr>
<tr><td><code id="pred_update_+3A_event_indicator">event_indicator</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival indicator (1 for
event, 0 for censoring). Only relevant for <code>x$model_type</code>=&quot;survival&quot;;
leave as <code>NULL</code> otherwise.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a single existing (previously estimated)
prediction model, and apply various model discrete model updating methods
(see Su et al. 2018) to tailor the model to a new dataset.
</p>
<p>The type of updating method is selected with the <code>update_type</code>
parameter, with options: &quot;intercept_update&quot;, &quot;recalibration&quot; and &quot;refit&quot;.
&quot;intercept_update&quot; corrects the overall calibration-in-the-large of the
model, through altering the model intercept (or baseline hazard) to suit
the new dataset. This is achieved by fitting a logistic model (if the
existing model is of type logistic) or time-to-event model (if the existing
model if of type survival) to the new dataset, with the linear predictor as
the only covariate, with the coefficient fixed at unity (i.e. as an
offset). &quot;recalibration&quot; corrects the calibration-in-the-large and any
under/over-fitting, by fitting a logistic model (if the existing model is
of type logistic) or time-to-event model (if the existing model if of type
survival) to the new dataset, with the linear predictor as the only
covariate. Finally, &quot;refit&quot; takes the original model structure and
re-estimates all coefficients; this has the effect as re-developing the
original model in the new data.
</p>
<p><code>new_data</code> should be a data.frame, where each row should be an
observation (e.g. patient) and each variable/column should be a predictor
variable. The predictor variables need to include (as a minimum) all of the
predictor variables that are included in the existing prediction model
(i.e., each of the variable names supplied to
<code><a href="#topic+pred_input_info">pred_input_info</a></code>, through the <code>model_info</code> parameter,
must match the name of a variables in <code>new_data</code>).
</p>
<p>Any factor variables within <code>new_data</code> must be converted to dummy
(0/1) variables before calling this function. <code><a href="#topic+dummy_vars">dummy_vars</a></code> can
help with this. See <code><a href="#topic+pred_predict">pred_predict</a></code> for examples.
</p>
<p><code>binary_outcome</code>, <code>survival_time</code> and <code>event_indicator</code> are
used to specify the outcome variable(s) within <code>new_data</code> (use
<code>binary_outcome</code> if <code>x$model_type</code> = &quot;logistic&quot;, or use
<code>survival_time</code> and <code>event_indicator</code> if <code>x$model_type</code> =
&quot;survival&quot;).
</p>


<h3>Value</h3>

<p>A object of class &quot;<code>predUpdate</code>&quot;. This is the same as that
detailed in <code><a href="#topic+pred_input_info">pred_input_info</a></code>, with the added element
containing the estimates of the model updating and the update type.
</p>


<h3>References</h3>

<p>Su TL, Jaki T, Hickey GL, Buchan I, Sperrin M. A review of
statistical updating methods for clinical prediction models. <em>Stat Methods
Med Res</em>. 2018 Jan;27(1):185-197. doi: 10.1177/0962280215626466.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred_input_info">pred_input_info</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1 - update time-to-event model by updating the baseline hazard in new dataset
model1 &lt;- pred_input_info(model_type = "survival",
                          model_info = SYNPM$Existing_TTE_models[1,],
                          cum_hazard = SYNPM$TTE_mod1_baseline)
recalibrated_model1 &lt;- pred_update(x = model1,
                                   update_type = "intercept_update",
                                   new_data = SYNPM$ValidationData,
                                   survival_time = "ETime",
                                   event_indicator = "Status")
summary(recalibrated_model1)

</code></pre>

<hr>
<h2 id='pred_val_probs'>Validate Predicted Probabilities</h2><span id='topic+pred_val_probs'></span>

<h3>Description</h3>

<p>This function is included for situations where one has a vector of predicted
probabilities from a model and a vector of observed binary outcomes that we
wish to validate the predictions against. See <code><a href="#topic+pred_validate">pred_validate</a></code> for
the main validation function of this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_val_probs(binary_outcome, Prob, cal_plot = TRUE, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred_val_probs_+3A_binary_outcome">binary_outcome</code></td>
<td>
<p>vector of binary outcomes (coded as 1 if outcome
happened, and 0 otherwise). Must be of same length as Prob</p>
</td></tr>
<tr><td><code id="pred_val_probs_+3A_prob">Prob</code></td>
<td>
<p>vector of predicted probabilities. Must be of same length of
binary_outcome.</p>
</td></tr>
<tr><td><code id="pred_val_probs_+3A_cal_plot">cal_plot</code></td>
<td>
<p>indicate if a flexible calibration plot should be produced
(TRUE) or not (FALSE).</p>
</td></tr>
<tr><td><code id="pred_val_probs_+3A_level">level</code></td>
<td>
<p>the confidence level required for all performance metrics.
Defaults at 95%. Must be a value between 0 and 1.</p>
</td></tr>
<tr><td><code id="pred_val_probs_+3A_...">...</code></td>
<td>
<p>further plotting arguments for the calibration plot. See Details
below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a vector of observed binary outcomes, and a
corresponding vector of predicted risks (e.g. from a logistic regression
CPM), and calculates measures of predictive performance. The function is
intended as a standalone way of validating predicted risks against binary
outcomes outside of the usual pred_input_info() -&gt; pred_validate() package
workflow. See <code><a href="#topic+pred_validate">pred_validate</a></code> for the main validation function
of this package.
</p>
<p>Various metrics of calibration (agreement between the observed risk and the
predicted risks, across the full risk range) and discrimination (ability
of the model to distinguish between those who develop the outcome and
those who do not) are calculated. For calibration, the observed-to-expected
ratio, calibration intercept and calibration slopes are estimated. The
calibration intercept is estimated by fitting a logistic regression model
to the observed binary outcomes, with the linear predictor of the model as
an offset. For calibration slope, a logistic regression model is fit to the
observed binary outcome with the linear predictor from the model as the
only covariate. For discrimination, the function estimates the area under
the receiver operating characteristic curve (AUC). Various other metrics
are also calculated to assess overall accuracy (Brier score, Cox-Snell R2).
</p>
<p>A flexible calibration plot is produced. Specify parameter
<code>cal_plot</code> to indicate whether a calibration plot should be produced
(TRUE), or not (FALSE). See <code><a href="#topic+pred_validate">pred_validate</a></code> for details on
this plot, and details of optional plotting arguments.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>predvalidate</code>&quot;, which is a list containing
relevant calibration and discrimination measures. See
<code><a href="#topic+pred_validate">pred_validate</a></code> for details.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred_input_info">pred_input_info</a></code>, <code><a href="#topic+pred_validate">pred_validate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate some data for purposes of example illustration
set.seed(1234)
x1 &lt;- rnorm(2000)
LP &lt;- -2 + (0.5*x1)
PR &lt;- 1/(1+exp(-LP))
y &lt;- rbinom(2000, 1, PR)

#fit hypothetical model to the simulated data
mod &lt;- glm(y[1:1000] ~ x1[1:1000], family = binomial(link="logit"))

#obtain the predicted risks from the model
pred_risk &lt;- predict(mod, type = "response",
                      newdata = data.frame("x1" = x1[1001:2000]))

#Use pred_val_probs to validate the predicted risks against the
#observed outcomes
summary(pred_val_probs(binary_outcome = y[1001:2000],
                        Prob = pred_risk,
                        cal_plot = FALSE))
</code></pre>

<hr>
<h2 id='pred_validate'>Validate an existing prediction</h2><span id='topic+pred_validate'></span>

<h3>Description</h3>

<p>Validate an existing prediction model, to calculate the predictive
performance against a new (validation) dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_validate(
  x,
  new_data,
  binary_outcome = NULL,
  survival_time = NULL,
  event_indicator = NULL,
  time_horizon = NULL,
  level = 0.95,
  cal_plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred_validate_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>predinfo</code>&quot; produced by calling
<code><a href="#topic+pred_input_info">pred_input_info</a></code>.</p>
</td></tr>
<tr><td><code id="pred_validate_+3A_new_data">new_data</code></td>
<td>
<p>data.frame upon which the prediction model should be
evaluated.</p>
</td></tr>
<tr><td><code id="pred_validate_+3A_binary_outcome">binary_outcome</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed binary outcomes (should be
coded 0 and 1 for non-event and event, respectively). Only relevant for
<code>model_type</code>=&quot;logistic&quot;; leave as <code>NULL</code> otherwise. Leave as
<code>NULL</code> if <code>new_data</code> does not contain any outcomes.</p>
</td></tr>
<tr><td><code id="pred_validate_+3A_survival_time">survival_time</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival times. Only relevant
for <code>x$model_type</code>=&quot;survival&quot;; leave as <code>NULL</code> otherwise.</p>
</td></tr>
<tr><td><code id="pred_validate_+3A_event_indicator">event_indicator</code></td>
<td>
<p>Character variable giving the name of the column in
<code>new_data</code> that represents the observed survival indicator (1 for
event, 0 for censoring). Only relevant for <code>x$model_type</code>=&quot;survival&quot;;
leave as <code>NULL</code> otherwise.</p>
</td></tr>
<tr><td><code id="pred_validate_+3A_time_horizon">time_horizon</code></td>
<td>
<p>for survival models, an integer giving the time horizon
(post baseline) at which a prediction is required. Currently, this must
match a time in x$cum_hazard.</p>
</td></tr>
<tr><td><code id="pred_validate_+3A_level">level</code></td>
<td>
<p>the confidence level required for all performance metrics.
Defaults at 95%. Must be a value between 0 and 1.</p>
</td></tr>
<tr><td><code id="pred_validate_+3A_cal_plot">cal_plot</code></td>
<td>
<p>indicate if a flexible calibration plot should be produced
(TRUE) or not (FALSE).</p>
</td></tr>
<tr><td><code id="pred_validate_+3A_...">...</code></td>
<td>
<p>further plotting arguments for the calibration plot. See Details
below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes an existing prediction model formatted according
to <code><a href="#topic+pred_input_info">pred_input_info</a></code>, and calculates measures of predictive
performance on new data (e.g., within an external validation study). The
information about the existing prediction model should first be inputted by
calling <code><a href="#topic+pred_input_info">pred_input_info</a></code>, before passing the resulting object
to <code>pred_validate</code>.
</p>
<p><code>new_data</code> should be a data.frame, where each row should be an
observation (e.g. patient) and each variable/column should be a predictor
variable. The predictor variables need to include (as a minimum) all of the
predictor variables that are included in the existing prediction model
(i.e., each of the variable names supplied to
<code><a href="#topic+pred_input_info">pred_input_info</a></code>, through the <code>model_info</code> parameter,
must match the name of a variables in <code>new_data</code>).
</p>
<p>Any factor variables within <code>new_data</code> must be converted to dummy
(0/1) variables before calling this function. <code><a href="#topic+dummy_vars">dummy_vars</a></code> can
help with this. See <code><a href="#topic+pred_predict">pred_predict</a></code> for examples.
</p>
<p><code>binary_outcome</code>, <code>survival_time</code> and <code>event_indicator</code> are
used to specify the outcome variable(s) within <code>new_data</code> (use
<code>binary_outcome</code> if <code>x$model_type</code> = &quot;logistic&quot;, or use
<code>survival_time</code> and <code>event_indicator</code> if <code>x$model_type</code> =
&quot;survival&quot;).
</p>
<p>In the case of validating a logistic regression model, this function
assesses the predictive performance of the predicted risks against an
observed binary outcome. Various metrics of calibration (agreement between
the observed risk and the predicted risks, across the full risk range) and
discrimination (ability of the model to distinguish between those who
develop the outcome and those who do not) are calculated. For calibration,
the observed-to-expected ratio, calibration intercept and calibration
slopes are estimated. The calibration intercept is estimated by fitting a
logistic regression model to the observed binary outcomes, with the linear
predictor of the model as an offset. For calibration slope, a logistic
regression model is fit to the observed binary outcome with the linear
predictor from the model as the only covariate. For discrimination, the
function estimates the area under the receiver operating characteristic
curve (AUC). Various other metrics are also calculated to assess overall
accuracy (Brier score, Cox-Snell R2).
</p>
<p>In the case of validating a survival prediction model, this function
assesses the predictive performance of the linear predictor and
(optionally) the predicted event probabilities at a fixed time horizon
against an observed time-to-event outcome. Various metrics of calibration
and discrimination are calculated. For calibration, the
observed-to-expected ratio at the specified <code>time_horizon</code> (if
predicted risks are available through specification of <code>x$cum_hazard</code>)
and calibration slope are produced. For discrimination, Harrell's
C-statistic is calculated.
</p>
<p>For both model types, a flexible calibration plot is produced (for survival
models, the cumulative baseline hazard must be available in the
<code>predinfo</code> object, <code>x$cum_hazard</code>). Specify parameter
<code>cal_plot</code> to indicate whether a calibration plot should be produced
(TRUE), or not (FALSE). The calibration plot is produced by regressing the
observed outcomes against a cubic spline of the logit of predicted risks
(for a logistic model) or the complementary log-log of the predicted risks
(for a survival model). Users can specify the following additional
parameters to <code><a href="#topic+pred_validate">pred_validate</a></code> to modify the calibration plot:
</p>

<ul>
<li> <p><code>xlim</code> as a numeric vector of length 2, giving the lower and
upper range of the x-axis scale - defaults at 0 and 1. Changes here should
match changes to the <code>ylim</code> such that the plot remains 'square'.
</p>
</li>
<li> <p><code>ylim</code> as a numeric vector of length 2, giving the lower and
upper range of the y-axis scale - defaults at 0 and 1. Changes here should
match changes to the <code>xlim</code> such that the plot remains 'square'.
</p>
</li>
<li> <p><code>xlab</code> string giving the x-axis label. Defaults as
&quot;Predicted Probability&quot;.
</p>
</li>
<li> <p><code>ylab</code> string giving the x-axis label. Defaults as
&quot;Observed Probability&quot;.
</p>
</li>
<li> <p><code>pred_rug</code> TRUE/FALSE of whether a 'rug' should be placed
along the x-axis of the calibration plot showing the distribution of
predicted risks. Defaults as FALSE in favour of examining the
box-plot/violin plot that is produced.
</p>
</li>
<li> <p><code>cal_plot_n_sample</code> numeric value (less than nrow(new_data))
giving a random subset of observations to render the calibration plot
over. The calibration plot is always created using all data, but for
rendering speed in large datasets, it can sometimes be useful to render
the plot over a smaller (random) subset of observations.
Final (e.g. publication-ready) plots should always show the full plot,
so a warning is created if users enter a value of cal_plot_n_sample.
</p>
</li></ul>



<h3>Value</h3>

<p><code><a href="#topic+pred_validate">pred_validate</a></code> returns an object of class
&quot;<code>predvalidate</code>&quot;, with child classes per <code>model_type</code>. This is a
list of performance metrics, estimated by applying the existing prediction
model to the new_data. An object of class &quot;<code>predvalidate</code>&quot; is a list
containing relevant calibration and discrimination measures. For logistic
regression models, this will include observed:expected ratio,
calibration-intercept, calibration slope, area under the ROC curve,
R-squared, and Brier Score. For survival models, this will include
observed:expected ratio (if <code>cum_hazard</code> is provided to <code>x</code>),
calibration slope, and Harrell's C-statistic. Optionally, a flexible
calibration plot is also produced, along with a box-plot and violin plot of
the predicted risk distribution.
</p>
<p>The <code>summary</code> function can be used to extract and print summary
performance results (calibration and discrimination metrics). The graphical
assessments of performance can be extracted using <code>plot</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred_input_info">pred_input_info</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Example 1 - multiple existing model, with outcome specified; uses
#            an example dataset within the package
model1 &lt;- pred_input_info(model_type = "logistic",
                          model_info = SYNPM$Existing_logistic_models)
val_results &lt;- pred_validate(x = model1,
                             new_data = SYNPM$ValidationData,
                             binary_outcome = "Y",
                             cal_plot = FALSE)
summary(val_results)

</code></pre>

<hr>
<h2 id='SYNPM'>SYNthetic Prediction Models (SYNPM) and Validation dataset</h2><span id='topic+SYNPM'></span>

<h3>Description</h3>

<p>A list containing: (1) information on some (synthetic) existing prediction
models (representing those available/published, which we want to validate in
another independent dataset); and (2) a synthetic dataset that we wish to
validate/update the models on.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SYNPM
</code></pre>


<h3>Format</h3>

<p>A list with six elements.
</p>

<ol>
<li><p>The first element is a
data frame with the information about three existing binary (logistic
regression) models for a binary outcome at one year
</p>
</li>
<li><p>The second element is a data frame with the information about three
existing time-to-event (Cox) models for the time-to-event outcome
</p>
</li>
<li><p>The third, fourth and fifth elements are the cumulative baseline
hazard information for the three time-to-event model
</p>
</li>
<li><p>The sixth element is the (synthetic) validation dataset on which we want to
validate the existing models. The dataset has 20000 rows and 8 variables:
</p>
 <dl>
<dt>Age</dt><dd><p>The age of the individual at baseline</p>
</dd> <dt>SexM</dt><dd><p>The
sex of the individual (1 = male; 0 = female)</p>
</dd>
<dt>Smoking_Status</dt><dd><p>Indicates whether the individual was or is a smoker
(1=previous/ current smoker, 0=non-smoker)</p>
</dd> <dt>Diabetes</dt><dd><p>Indicates
whether the individual has diabetes (1=diabetic, 0=not diabetic)</p>
</dd>
<dt>Creatinine</dt><dd><p>The Creatinine value for the individual (mg/dL)</p>
</dd>
<dt>ETime</dt><dd><p>The time from baseline until either the event or censoring</p>
</dd>
<dt>Status</dt><dd><p>Indicator of whether the patient experienced the event or was censored at ETime</p>
</dd>
<dt>Y</dt><dd><p>Binary indicator of whether the individual experienced the event by 1 time-unit</p>
</dd> </dl>
 
</li></ol>



<h3>Source</h3>

<p>Simulated Data; see <a href="https://github.com/GlenMartin31/predRupdate">https://github.com/GlenMartin31/predRupdate</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
