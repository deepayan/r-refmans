<!DOCTYPE html><html lang="en"><head><title>Help for package jmcm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {jmcm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acd_estimation'><p>Fit Joint Mean-Covariance Models based on ACD</p></a></li>
<li><a href='#aids'><p>Aids Data</p></a></li>
<li><a href='#bootcurve'><p>Plot Fitted Curves and Corresponding Confidence Interval using</p>
bootstrapping method</a></li>
<li><a href='#cattle'><p>Cattle Data</p></a></li>
<li><a href='#getJMCM'><p>Extract or Get Generalized Components from a Fitted Joint Mean</p>
Covariance Model</a></li>
<li><a href='#hpc_estimation'><p>Fit Joint Mean-Covariance Models based on HPC</p></a></li>
<li><a href='#jmcm'><p>Fit Joint Mean-Covariance Models</p></a></li>
<li><a href='#jmcmControl'><p>Control of Joint Mean Covariance Model Fitting</p></a></li>
<li><a href='#jmcmMod-class'><p>Class &quot;jmcmMod&quot; of Fitted Joint Mean-Covariance Models.</p></a></li>
<li><a href='#mcd_estimation'><p>Fit Joint Mean-Covariance Models based on MCD</p></a></li>
<li><a href='#meanplot'><p>Plot Fitted Mean Curves</p></a></li>
<li><a href='#modular'><p>Modular Functions for Joint Mean Covariance Model Fits</p></a></li>
<li><a href='#regressogram'><p>Plot Sample Regressograms and Fitted Curves</p></a></li>
<li><a href='#show+2CjmcmMod-method'><p>Print information for jmcmMod-class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Joint Mean-Covariance Models using 'Armadillo' and S4</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.4</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jianxin Pan &lt;Jianxin.Pan@manchester.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit joint mean-covariance models for longitudinal data. The models
    and their components are represented using S4 classes and methods. The core
    computational algorithms are implemented using the 'Armadillo' C++ library
    for numerical linear algebra and 'RcppArmadillo' glue.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Formula, methods, Rcpp (&ge; 0.12.14)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo (&ge; 0.9.900.1.0), roptim</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Jianxin Pan [aut, cre],
  Yi Pan [aut]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ypan1988/jmcm/">https://github.com/ypan1988/jmcm/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ypan1988/jmcm/issues">https://github.com/ypan1988/jmcm/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-11 21:27:18 UTC; yipan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-12 08:40:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='acd_estimation'>Fit Joint Mean-Covariance Models based on ACD</h2><span id='topic+acd_estimation'></span>

<h3>Description</h3>

<p>Fit joint mean-covariance models based on ACD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acd_estimation(m, Y, X, Z, W, start, mean, trace = FALSE, profile = TRUE,
  errormsg = FALSE, covonly = FALSE, optim_method = "default")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="acd_estimation_+3A_m">m</code></td>
<td>
<p>an integer vector of numbers of measurements for subject.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_y">Y</code></td>
<td>
<p>a vector of responses for all subjects.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_x">X</code></td>
<td>
<p>model matrix for the mean structure model.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_z">Z</code></td>
<td>
<p>model matrix for the diagonal matrix.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_w">W</code></td>
<td>
<p>model matrix for the lower triangular matrix.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_start">start</code></td>
<td>
<p>starting values for the parameters in the model.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_mean">mean</code></td>
<td>
<p>when covonly is true, it is used as the given mean.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_trace">trace</code></td>
<td>
<p>the values of the objective function and the parameters are
printed for all the trace'th iterations.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_profile">profile</code></td>
<td>
<p>whether parameters should be estimated sequentially using the
idea of profile likelihood or not.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_errormsg">errormsg</code></td>
<td>
<p>whether or not the error message should be print.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_covonly">covonly</code></td>
<td>
<p>estimate the covariance structure only, and use given mean.</p>
</td></tr>
<tr><td><code id="acd_estimation_+3A_optim_method">optim_method</code></td>
<td>
<p>optimization method, choose &quot;default&quot; or &quot;BFGS&quot;(vmmin in
R).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mcd_estimation">mcd_estimation</a></code> for joint mean covariance model fitting
based on MCD, <code><a href="#topic+hpc_estimation">hpc_estimation</a></code> for joint mean covariance
model fitting based on HPC.
</p>

<hr>
<h2 id='aids'>Aids Data</h2><span id='topic+aids'></span>

<h3>Description</h3>

<p>The aids dataset comprises a total of 2376 CD4+ cell counts for 369 HIV
infected men with a follow up period of approximately eight and half year.
The number of measurements for each individual varies from 1 to 12 and the
times are not equally spaced. The CD4+ cell data are highly unbalanced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aids)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2376 rows and 8 variables</p>


<h3>Details</h3>


<ul>
<li><p> id: subject id
</p>
</li>
<li><p> time: measurement time
</p>
</li>
<li><p> cd4: CD4+ cell count
</p>
</li></ul>


<hr>
<h2 id='bootcurve'>Plot Fitted Curves and Corresponding Confidence Interval using
bootstrapping method</h2><span id='topic+bootcurve'></span>

<h3>Description</h3>

<p>Plot fitted curves and corresponding 95% confidence interval
using bootstrapping method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootcurve(object, nboot)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootcurve_+3A_object">object</code></td>
<td>
<p>a fitted joint mean covariance model of class &quot;jmcmMod&quot;, i.e.,
typically the result of jmcm().</p>
</td></tr>
<tr><td><code id="bootcurve_+3A_nboot">nboot</code></td>
<td>
<p>number of the bootstrap replications.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# It may take hours for large bootstrap replications
fit.mcd &lt;- jmcm(I(sqrt(cd4)) | id | time ~ 1 | 1, data=aids,
  triple = c(8, 1, 3), cov.method = 'mcd', control = jmcmControl(trace=T))
bootcurve(fit.mcd, nboot = 1000)

## End(Not run)

</code></pre>

<hr>
<h2 id='cattle'>Cattle Data</h2><span id='topic+cattle'></span>

<h3>Description</h3>

<p>Kenward (1987) reported an experiment in which cattle were assigned randomly
to two treatment groups A and B, and their body weights were recorded in
kilogram. Thirty animals received treatment A and another 30 received
treatment B. The animals were weighted 11 times over a 133-day period; the
first 10 measurements for each animal were made at two-week intervals and the
last measurement was made one week later. Since no observation was missing,
it is considered to be a balanced longitudinal dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cattle)
</code></pre>


<h3>Format</h3>

<p>A data frame with 660 rows and 4 variables</p>


<h3>Details</h3>


<ul>
<li><p> id: subject id
</p>
</li>
<li><p> day: measurement time
</p>
</li>
<li><p> group: Treatment A or Treatment B
</p>
</li>
<li><p> weight: cattle weight
</p>
</li></ul>


<hr>
<h2 id='getJMCM'>Extract or Get Generalized Components from a Fitted Joint Mean
Covariance Model</h2><span id='topic+getJMCM'></span><span id='topic+getJMCM.jmcmMod'></span>

<h3>Description</h3>

<p>Extract (or &quot;get&quot;) &quot;components&quot; - in a generalized sense - from
a fitted joint mean covariance model from an object of class &quot;jmcmMod&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getJMCM(object, name, sub.num)

## S3 method for class 'jmcmMod'
getJMCM(object, name = c("m", "Y", "X", "Z", "W", "D", "T",
  "Sigma", "mu", "n2loglik", "grad", "hess", "theta", "beta", "lambda", "gamma",
  "loglik", "BIC", "iter", "triple"), sub.num = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getJMCM_+3A_object">object</code></td>
<td>
<p>a fitted joint mean covariance model of class &quot;jmcmMod&quot;, i.e.,
typically the result of jmcm().</p>
</td></tr>
<tr><td><code id="getJMCM_+3A_name">name</code></td>
<td>
<p>a character vector specifying the name(s) of the &quot;component&quot;.
</p>
<p>When sub.num is not specified or equal to 0, possible values are:
</p>

<dl>
<dt><code>"m"</code></dt><dd><p>a vector of number of measurement for each subject</p>
</dd>
<dt><code>"Y"</code></dt><dd><p>response vector</p>
</dd>
<dt><code>"X"</code></dt><dd><p>model matrix for mean structure</p>
</dd>
<dt><code>"Z"</code></dt><dd><p>model matrix for covariance structure (the diagonal
matrix)</p>
</dd>
<dt><code>"W"</code></dt><dd><p>model matrix for covariance structure (the lower
triangular matrix)</p>
</dd>
<dt><code>"theta"</code></dt><dd><p>parameter estimates of joint mean covariance model</p>
</dd>
<dt><code>"beta"</code></dt><dd><p>parameter estimates for mean structure model</p>
</dd>
<dt><code>"lambda"</code></dt><dd><p>parameter estimates for covariace structure (the
diagonal matrix)</p>
</dd>
<dt><code>"gamma"</code></dt><dd><p>parameter estimates for covariance structure (the
lower triangular matrix)</p>
</dd>
<dt><code>"loglik"</code></dt><dd><p>log-likelihood, except for a constant</p>
</dd>
<dt><code>"BIC"</code></dt><dd><p>Bayesian information criterion</p>
</dd>
<dt><code>"iter"</code></dt><dd><p>number of iterations until convergence</p>
</dd>
<dt><code>"triple"</code></dt><dd><p>(p, d, q)</p>
</dd>
</dl>

<p>When sub.num is specified, possible values are:
</p>

<dl>
<dt><code>"m"</code></dt><dd><p>number of measurements for subject i</p>
</dd>
<dt><code>"Y"</code></dt><dd><p>response vector for subject i</p>
</dd>
<dt><code>"X"</code></dt><dd><p>model matrix of subject i for mean structure </p>
</dd>
<dt><code>"Z"</code></dt><dd><p>model matrix of subject i for covariance structure (the
diagonal matrix)</p>
</dd>
<dt><code>"W"</code></dt><dd><p>model matrix of subject i for covariance structure (the
lower triangular matrix)</p>
</dd>
<dt><code>"D"</code></dt><dd><p>the estimated diagonal matrix for subject i</p>
</dd>
<dt><code>"T"</code></dt><dd><p>the estimated lower triangular matrix for subject i</p>
</dd>
<dt><code>"Sigma"</code></dt><dd><p>the estimated covariance matrix for subject i</p>
</dd>
<dt><code>"mu"</code></dt><dd><p>the estimated mean for subject i</p>
</dd>
<dt><code>"n2loglik"</code></dt><dd><p>the estimated -2l(theta)</p>
</dd>
<dt><code>"grad"</code></dt><dd><p>the estimated gradient</p>
</dd>
<dt><code>"hess"</code></dt><dd><p>the estimated Hessian matrix</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="getJMCM_+3A_sub.num">sub.num</code></td>
<td>
<p>refer to i's subject</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>jmcmMod</code>: Extract or Get Generalized Components from a Fitted Joint
Mean Covariance Model
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>fit.mcd &lt;- jmcm(I(sqrt(cd4)) | id | time ~ 1 | 1, data = aids,
  triple = c(8, 1, 3), cov.method = 'mcd')

beta &lt;- getJMCM(fit.mcd, "beta")
BIC  &lt;- getJMCM(fit.mcd, "BIC")
Di   &lt;- getJMCM(fit.mcd, "D", 10)

</code></pre>

<hr>
<h2 id='hpc_estimation'>Fit Joint Mean-Covariance Models based on HPC</h2><span id='topic+hpc_estimation'></span>

<h3>Description</h3>

<p>Fit joint mean-covariance models based on HPC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hpc_estimation(m, Y, X, Z, W, start, mean, trace = FALSE, profile = TRUE,
  errormsg = FALSE, covonly = FALSE, optim_method = "default")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hpc_estimation_+3A_m">m</code></td>
<td>
<p>an integer vector of numbers of measurements for subject.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_y">Y</code></td>
<td>
<p>a vector of responses for all subjects.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_x">X</code></td>
<td>
<p>model matrix for the mean structure model.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_z">Z</code></td>
<td>
<p>model matrix for the diagonal matrix.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_w">W</code></td>
<td>
<p>model matrix for the lower triangular matrix.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_start">start</code></td>
<td>
<p>starting values for the parameters in the model.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_mean">mean</code></td>
<td>
<p>when covonly is true, it is used as the given mean.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_trace">trace</code></td>
<td>
<p>the values of the objective function and the parameters are
printed for all the trace'th iterations.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_profile">profile</code></td>
<td>
<p>whether parameters should be estimated sequentially using the
idea of profile likelihood or not.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_errormsg">errormsg</code></td>
<td>
<p>whether or not the error message should be print.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_covonly">covonly</code></td>
<td>
<p>estimate the covariance structure only, and use given mean.</p>
</td></tr>
<tr><td><code id="hpc_estimation_+3A_optim_method">optim_method</code></td>
<td>
<p>optimization method, choose &quot;default&quot; or &quot;BFGS&quot;(vmmin in
R).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mcd_estimation">mcd_estimation</a></code> for joint mean covariance model fitting
based on MCD, <code><a href="#topic+acd_estimation">acd_estimation</a></code> for joint mean covariance
model fitting based on ACD.
</p>

<hr>
<h2 id='jmcm'>Fit Joint Mean-Covariance Models</h2><span id='topic+jmcm'></span>

<h3>Description</h3>

<p>Fit a joint mean-covariance model to longitudinal data, via
maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jmcm(formula, data = NULL, triple = c(3, 3, 3), cov.method = c("mcd",
  "acd", "hpc"), optim.method = c("default", "BFGS"),
  control = jmcmControl(), start = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jmcm_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing the covariates
for both the mean and covariance matrix part of the model, with the response,
the corresponding subject id and measurement time on the left of a operator~,
divided by vertical bars (&quot;|&quot;).</p>
</td></tr>
<tr><td><code id="jmcm_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables named in formula.</p>
</td></tr>
<tr><td><code id="jmcm_+3A_triple">triple</code></td>
<td>
<p>an integer vector of length three containing the degrees of the
three polynomial functions for the mean structure, the log innovation
-variances and the autoregressive or moving average coefficients when 'mcd'
or 'acd' is specified for cov.method. It refers to the degree for the mean
structure, variances and angles when 'hpc' is specified for cov.method.</p>
</td></tr>
<tr><td><code id="jmcm_+3A_cov.method">cov.method</code></td>
<td>
<p>covariance structure modelling method,
choose 'mcd' (Pourahmadi 1999), 'acd' (Chen and Dunson 2013) or 'hpc'
(Zhang et al. 2015).</p>
</td></tr>
<tr><td><code id="jmcm_+3A_optim.method">optim.method</code></td>
<td>
<p>optimization method, choose 'default' or 'BFGS' (vmmin in R)</p>
</td></tr>
<tr><td><code id="jmcm_+3A_control">control</code></td>
<td>
<p>a list (of correct class, resulting from jmcmControl())
containing control parameters, see the *jmcmControl documentation for
details.</p>
</td></tr>
<tr><td><code id="jmcm_+3A_start">start</code></td>
<td>
<p>starting values for the parameters in the model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pan J, Pan Y (2017). &quot;jmcm: An R Package for Joint Mean-Covariance Modeling of Longitudinal Data.&quot; <em>Journal of Statistical Software</em>, 82(9), 1&ndash;29.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cattleA &lt;- cattle[cattle$group=='A', ]
fit.mcd &lt;- jmcm(weight | id | I(ceiling(day/14 + 1)) ~ 1 | 1,
data=cattleA, triple = c(8, 4, 3), cov.method = 'mcd', 
control = jmcmControl(trace = TRUE, ignore.const.term = FALSE, 
original.poly.order = TRUE))
</code></pre>

<hr>
<h2 id='jmcmControl'>Control of Joint Mean Covariance Model Fitting</h2><span id='topic+jmcmControl'></span>

<h3>Description</h3>

<p>Construct control structures for joint mean covariance model
fitting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jmcmControl(trace = FALSE, profile = TRUE, ignore.const.term = TRUE,
  original.poly.order = FALSE, errormsg = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jmcmControl_+3A_trace">trace</code></td>
<td>
<p>whether or not the value of the objective function and the
parameters should be print on every trace'th iteration.</p>
</td></tr>
<tr><td><code id="jmcmControl_+3A_profile">profile</code></td>
<td>
<p>whether or not parameters should be estimated sequentially
using the idea of profile likelihood.</p>
</td></tr>
<tr><td><code id="jmcmControl_+3A_ignore.const.term">ignore.const.term</code></td>
<td>
<p>whether or not the constant term should be considered 
when calculating log-likelihood and BIC.
function</p>
</td></tr>
<tr><td><code id="jmcmControl_+3A_original.poly.order">original.poly.order</code></td>
<td>
<p>whether or not the original poly order p q d should 
be used</p>
</td></tr>
<tr><td><code id="jmcmControl_+3A_errormsg">errormsg</code></td>
<td>
<p>whether or not the error message should be print</p>
</td></tr>
</table>

<hr>
<h2 id='jmcmMod-class'>Class &quot;jmcmMod&quot; of Fitted Joint Mean-Covariance Models.</h2><span id='topic+jmcmMod-class'></span>

<h3>Description</h3>

<p>Class &quot;jmcmMod&quot; of Fitted Joint Mean-Covariance Models.
</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code></dt><dd><p>the matched call</p>
</dd>
<dt><code>opt</code></dt><dd><p>the optimization result returned by optimizeJmcm</p>
</dd>
<dt><code>args</code></dt><dd><p>arguments m, Y, X, Z, W, time</p>
</dd>
<dt><code>triple</code></dt><dd><p>an integer vector of length three containing the degrees of the
three polynomial functions for the mean structure, the log innovation
-variances and the autoregressive or moving average coefficients when
'mcd' or 'acd' is specified for cov.method. It refers to the mean structure,
variances and angles when 'hpc' is specified for cov.method.</p>
</dd>
<dt><code>devcomp</code></dt><dd><p>the deviance components list</p>
</dd>
</dl>

<hr>
<h2 id='mcd_estimation'>Fit Joint Mean-Covariance Models based on MCD</h2><span id='topic+mcd_estimation'></span>

<h3>Description</h3>

<p>Fit joint mean-covariance models based on MCD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcd_estimation(m, Y, X, Z, W, start, mean, trace = FALSE, profile = TRUE,
  errormsg = FALSE, covonly = FALSE, optim_method = "default")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcd_estimation_+3A_m">m</code></td>
<td>
<p>an integer vector of numbers of measurements for subject.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_y">Y</code></td>
<td>
<p>a vector of responses for all subjects.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_x">X</code></td>
<td>
<p>model matrix for the mean structure model.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_z">Z</code></td>
<td>
<p>model matrix for the diagonal matrix.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_w">W</code></td>
<td>
<p>model matrix for the lower triangular matrix.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_start">start</code></td>
<td>
<p>starting values for the parameters in the model.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_mean">mean</code></td>
<td>
<p>when covonly is true, it is used as the given mean.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_trace">trace</code></td>
<td>
<p>the values of the objective function and the parameters are
printed for all the trace'th iterations.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_profile">profile</code></td>
<td>
<p>whether parameters should be estimated sequentially using the
idea of profile likelihood or not.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_errormsg">errormsg</code></td>
<td>
<p>whether or not the error message should be print.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_covonly">covonly</code></td>
<td>
<p>estimate the covariance structure only, and use given mean.</p>
</td></tr>
<tr><td><code id="mcd_estimation_+3A_optim_method">optim_method</code></td>
<td>
<p>optimization method, choose &quot;default&quot; or &quot;BFGS&quot;(vmmin in
R).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+acd_estimation">acd_estimation</a></code> for joint mean covariance model fitting
based on ACD, <code><a href="#topic+hpc_estimation">hpc_estimation</a></code> for joint mean covariance
model fitting based on HPC.
</p>

<hr>
<h2 id='meanplot'>Plot Fitted Mean Curves</h2><span id='topic+meanplot'></span>

<h3>Description</h3>

<p>plot fitted mean curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meanplot(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meanplot_+3A_object">object</code></td>
<td>
<p>a fitted joint mean covariance model of class &quot;jmcmMod&quot;, i.e.,
typically the result of jmcm().</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>cattleA &lt;- cattle[cattle$group=='A', ]
fit.mcd &lt;- jmcm(weight | id | I(ceiling(day/14 + 1)) ~ 1 | 1, data=cattleA,
  triple = c(8, 3, 4), cov.method = 'mcd')
meanplot(fit.mcd)

</code></pre>

<hr>
<h2 id='modular'>Modular Functions for Joint Mean Covariance Model Fits</h2><span id='topic+modular'></span><span id='topic+ldFormula'></span><span id='topic+optimizeJmcm'></span><span id='topic+mkJmcmMod'></span>

<h3>Description</h3>

<p>Modular Functions for joint mean covariance model fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldFormula(formula, data = NULL, triple = c(3, 3, 3), cov.method = c("mcd",
  "acd", "hpc"), optim.method = c("default", "BFGS"),
  control = jmcmControl(), start = NULL)

optimizeJmcm(m, Y, X, Z, W, time, cov.method, optim.method, control, start)

mkJmcmMod(opt, args, triple, cov.method, optim.method, mc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modular_+3A_formula">formula</code></td>
<td>
<p>a two-sided linear formula object describing the covariates
for both the mean and covariance matrix part of the model, with the response,
the corresponding subject id and measurement time on the left of a operator~,
divided by vertical bars (&quot;|&quot;).</p>
</td></tr>
<tr><td><code id="modular_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables named in formula.</p>
</td></tr>
<tr><td><code id="modular_+3A_triple">triple</code></td>
<td>
<p>an integer vector of length three containing the degrees of the
three polynomial functions for the mean structure, the log innovation
-variances and the autoregressive or moving average coefficients when 'mcd'
or 'acd' is specified for cov.method. It refers to the degree for the mean
structure, variances and angles when 'hpc' is specified for cov.method.</p>
</td></tr>
<tr><td><code id="modular_+3A_cov.method">cov.method</code></td>
<td>
<p>covariance structure modelling method,
choose 'mcd' (Pourahmadi 1999), 'acd' (Chen and Dunson 2013) or 'hpc'
(Zhang et al. 2015).</p>
</td></tr>
<tr><td><code id="modular_+3A_optim.method">optim.method</code></td>
<td>
<p>optimization method, choose 'default' or 'BFGS' (vmmin in R)</p>
</td></tr>
<tr><td><code id="modular_+3A_control">control</code></td>
<td>
<p>a list (of correct class, resulting from jmcmControl())
containing control parameters, see the *jmcmControl documentation for
details.</p>
</td></tr>
<tr><td><code id="modular_+3A_start">start</code></td>
<td>
<p>starting values for the parameters in the model.</p>
</td></tr>
<tr><td><code id="modular_+3A_m">m</code></td>
<td>
<p>an integer vector of number of measurements for each subject.</p>
</td></tr>
<tr><td><code id="modular_+3A_y">Y</code></td>
<td>
<p>a vector of responses for all subjects.</p>
</td></tr>
<tr><td><code id="modular_+3A_x">X</code></td>
<td>
<p>model matrix for mean structure model.</p>
</td></tr>
<tr><td><code id="modular_+3A_z">Z</code></td>
<td>
<p>model matrix for the diagonal matrix.</p>
</td></tr>
<tr><td><code id="modular_+3A_w">W</code></td>
<td>
<p>model matrix for the lower triangular matrix.</p>
</td></tr>
<tr><td><code id="modular_+3A_time">time</code></td>
<td>
<p>a vector of time from the data.</p>
</td></tr>
<tr><td><code id="modular_+3A_opt">opt</code></td>
<td>
<p>optimized results returned by optimizeJmcm.</p>
</td></tr>
<tr><td><code id="modular_+3A_args">args</code></td>
<td>
<p>arguments returned by ldFormula.</p>
</td></tr>
<tr><td><code id="modular_+3A_mc">mc</code></td>
<td>
<p>matched call from the calling function.</p>
</td></tr>
</table>

<hr>
<h2 id='regressogram'>Plot Sample Regressograms and Fitted Curves</h2><span id='topic+regressogram'></span>

<h3>Description</h3>

<p>Plot the sample regressograms based on the sample covariance
matrix and superimpose the corresponding fitted curves to check the model
fitting when the longitudinal dataset is balanced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regressogram(object, time)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regressogram_+3A_object">object</code></td>
<td>
<p>a fitted joint mean covariance model of class &quot;jmcmMod&quot;, i.e.,
typically the result of jmcm().</p>
</td></tr>
<tr><td><code id="regressogram_+3A_time">time</code></td>
<td>
<p>a vector of obeservation time points</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>cattleA &lt;- cattle[cattle$group=='A', ]
fit.mcd &lt;- jmcm(weight | id | I(ceiling(day/14 + 1)) ~ 1 | 1, data=cattleA,
  triple = c(8, 3, 4), cov.method = 'mcd')
regressogram(fit.mcd, time = 1:11)

</code></pre>

<hr>
<h2 id='show+2CjmcmMod-method'>Print information for jmcmMod-class</h2><span id='topic+show+2CjmcmMod-method'></span>

<h3>Description</h3>

<p>Print information for jmcmMod-class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'jmcmMod'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show+2B2CjmcmMod-method_+3A_object">object</code></td>
<td>
<p>a fitted joint mean covariance model of class &quot;jmcmMod&quot;, i.e.,
typically the result of jmcm().</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
