<!DOCTYPE html><html><head><title>Help for package dynamicTreeCut</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dynamicTreeCut}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cutreeDynamic'><p>Adaptive Branch Pruning of Hierarchical Clustering Dendrograms</p></a></li>
<li><a href='#cutreeDynamicTree'><p>Dynamic Dendrogram Pruning Based on Dendrogram Only</p></a></li>
<li><a href='#cutreeHybrid'><p>Hybrid Adaptive Tree Cut for Hierarchical Clustering Dendrograms</p></a></li>
<li><a href='#dynamicTreeCut-package'>
<p>Methods for Detection of Clusters in Hierarchical Clustering Dendrograms</p></a></li>
<li><a href='#indentSpaces'><p>Spaces for Indented Output</p></a></li>
<li><a href='#merge2Clusters'>
<p>Merge Two Clusters</p></a></li>
<li><a href='#printFlush'><p>Print Arguments and Flush the Console</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.63-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-03-10</td>
</tr>
<tr>
<td>Title:</td>
<td>Methods for Detection of Clusters in Hierarchical Clustering
Dendrograms</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Langfelder &lt;Peter.Langfelder@gmail.com&gt; and Bin Zhang &lt;binzhang.ucla@gmail.com&gt;, 
        with contributions from Steve Horvath &lt;SHorvath@mednet.ucla.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Langfelder &lt;Peter.Langfelder@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.3.0), stats</td>
</tr>
<tr>
<td>ZipData:</td>
<td>no</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains methods for detection of clusters in hierarchical clustering dendrograms.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting/">http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-03-10 18:25:27 UTC; plangfelder</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-03-11 00:39:02</td>
</tr>
</table>
<hr>
<h2 id='cutreeDynamic'>Adaptive Branch Pruning of Hierarchical Clustering Dendrograms</h2><span id='topic+cutreeDynamic'></span>

<h3>Description</h3>

<p>This wrapper provides a common access point for two methods of adaptive branch pruning of hierarchical
clustering dendrograms. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutreeDynamic(
      dendro, cutHeight = NULL, minClusterSize = 20,

      # Basic tree cut options
      method = "hybrid", distM = NULL,
      deepSplit = (ifelse(method=="hybrid", 1, FALSE)),

      # Advanced options
      maxCoreScatter = NULL, minGap = NULL,
      maxAbsCoreScatter = NULL, minAbsGap = NULL,

      minSplitHeight = NULL, minAbsSplitHeight = NULL,

      # External (user-supplied) measure of branch split
      externalBranchSplitFnc = NULL, minExternalSplit = NULL,
      externalSplitOptions = list(),
      externalSplitFncNeedsDistance = NULL,
      assumeSimpleExternalSpecification = TRUE,

      # PAM stage options
      pamStage = TRUE, pamRespectsDendro = TRUE,
      useMedoids = FALSE, maxDistToLabel = NULL,
      maxPamDist = cutHeight,
      respectSmallClusters = TRUE,

      # Various options
      verbose = 2, indent = 0)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cutreeDynamic_+3A_dendro">dendro</code></td>
<td>
<p>A hierarchical clustering dendorgram such as one returned by <code>hclust</code>.  </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_cutheight">cutHeight</code></td>
<td>
<p>Maximum joining heights that will be considered. For <code>method=="tree"</code> it
defaults to 0.99. For <code>method=="hybrid"</code> it defaults to 99% of the range between the 5th
percentile and the maximum of the joining heights on the dendrogram.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_minclustersize">minClusterSize</code></td>
<td>
<p>Minimum cluster size.  </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_method">method</code></td>
<td>
<p>Chooses the method to use. Recognized values are &quot;hybrid&quot; and &quot;tree&quot;.  </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_distm">distM</code></td>
<td>
<p>Only used for method &quot;hybrid&quot;. The distance matrix used as input to <code>hclust</code>. If not
given and <code>method == "hybrid"</code>, the function will issue a warning and default to <code>method =
"tree"</code>.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_deepsplit">deepSplit</code></td>
<td>
<p>For method &quot;hybrid&quot;, can be either logical or integer in the range 0 to 4. For method
&quot;tree&quot;, must be logical. In both cases, provides a rough control over sensitivity to cluster splitting.
The higher the value (or if <code>TRUE</code>), the more and smaller clusters will be produced. For the
&quot;hybrid&quot; method, a finer control can be achieved via <code>maxCoreScatter</code> and <code>minGap</code> below.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_maxcorescatter">maxCoreScatter</code></td>
<td>
<p>Only used for method &quot;hybrid&quot;. 
Maximum scatter of the core for a branch to be a cluster, given as the fraction of <code>cutHeight</code>
relative to the 5th percentile of joining heights. See Details.  </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_mingap">minGap</code></td>
<td>
<p>Only used for method &quot;hybrid&quot;. 
Minimum cluster gap given as the fraction of the difference between <code>cutHeight</code> and the 5th
percentile of joining heights.  </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_maxabscorescatter">maxAbsCoreScatter</code></td>
<td>
<p>Only used for method &quot;hybrid&quot;. 
Maximum scatter of the core for a branch to be a cluster given as absolute heights. If given, overrides
<code>maxCoreScatter</code>.  </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_minabsgap">minAbsGap</code></td>
<td>
<p>Only used for method &quot;hybrid&quot;. 
Minimum cluster gap given as absolute height difference. If given, overrides <code>minGap</code>.  </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_minsplitheight">minSplitHeight</code></td>
<td>
<p>Minimum split height given as the fraction of the difference between
<code>cutHeight</code> and the 5th percentile of joining heights. Branches merging below this height will
automatically be merged. Defaults to zero but is used only if <code>minAbsSplitHeight</code> below is
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_minabssplitheight">minAbsSplitHeight</code></td>
<td>
<p>Minimum split height given as an absolute height.
Branches merging below this height will automatically be merged. If not given (default), will be determined 
from <code>minSplitHeight</code> above.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_externalbranchsplitfnc">externalBranchSplitFnc</code></td>
<td>
<p>Optional function to evaluate split (dissimilarity) between two branches.
Either a single function or a list in which each component is a function (see
<code>assumeSimpleExternalSpecification</code> below for how to specify a single function).
Each function can be specified by name (a character string) or the actual function object.
Each given function must take arguments <code>branch1</code> and <code>branch2</code> that specify the 
indices of objects in
the two branches whose dissimilarity is to be evaluated, and possibly other arguments. It must return a
number that quantifies the dissimilarity of the two branches. The returned value will be compared to
<code>minExternalSplit</code> (see below). This argument is only used for  method &quot;hybrid&quot;.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_minexternalsplit">minExternalSplit</code></td>
<td>
<p>Thresholds to decide whether two branches should be merged. 
It should be a numeric vector of the same length as the number of functions in
<code>externalBranchSplitFnc</code> above. 
Only used for method &quot;hybrid&quot;. </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_externalsplitoptions">externalSplitOptions</code></td>
<td>
<p>Further arguments to function <code>externalBranchSplitFnc</code>. If only one
external function is specified in <code>externalBranchSplitFnc</code> above, <code>externalSplitOptions</code> 
can be a named
list of arguments or a list with one component that is in turn  the named list of further arguments for
<code>externalBranchSplitFnc[[1]]</code>. The argument <code>assumeSimpleExternalSpecification</code> controls which of
the two possibilities should be assumed. If multiple functions are specified in <code>externalBranchSplitFnc</code>,
<code>externalSplitOptions</code>
must be a list in which each component is a named list giving the further arguments for the corresponding 
function in  <code>externalBranchSplitFnc</code>. Only used for method &quot;hybrid&quot;.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_externalsplitfncneedsdistance">externalSplitFncNeedsDistance</code></td>
<td>
<p>Optional specification of whether the external branch split
functions need the distance matrix as one of their arguments. Either <code>NULL</code> or a logical vector with
one element per branch split function  that specifies whether the corresponding branch split function
expects the distance matrix as one of its arguments. The default <code>NULL</code> is interpreted as a vector of
<code>TRUE</code>. When dealing with a large number of objects, setting this argument to <code>FALSE</code> whenever 
possible can prevent unnecessary memory utilization.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_assumesimpleexternalspecification">assumeSimpleExternalSpecification</code></td>
<td>
<p>Logical: when <code>minExternalSplit</code> above is a scalar (has
length 1), should the function assume a simple specification of <code>externalBranchSplitFnc</code> and
<code>externalSplitOptions</code>? If <code>TRUE</code>, <code>externalBranchSplitFnc</code> is taken as the function
specification and <code>externalSplitOptions</code> the named list of options. This is suitable for simple direct
calls of this function. If <code>FALSE</code>, <code>externalBranchSplitFnc</code> is assumed to be a list with a
single component which specifies the function, and <code>externalSplitOptions</code> is a list with one
component that is in turn the named list of further arguments for <code>externalBranchSplitFnc[[1]]</code>.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_pamstage">pamStage</code></td>
<td>
<p>Only used for method &quot;hybrid&quot;.  If TRUE, the second (PAM-like) stage will be performed.  </p>
</td></tr>  
<tr><td><code id="cutreeDynamic_+3A_pamrespectsdendro">pamRespectsDendro</code></td>
<td>
<p>Logical, only used for method &quot;hybrid&quot;. If <code>TRUE</code>, the PAM stage will
respect the dendrogram in the sense that objects and small clusters will only be assigned to clusters
that belong to the same branch that the objects or small clusters being assigned belong to.
</p>
</td></tr>    
<tr><td><code id="cutreeDynamic_+3A_usemedoids">useMedoids</code></td>
<td>
<p>Only used for method &quot;hybrid&quot; and only if <code>labelUnlabeled==TRUE</code>.
If TRUE, the second stage will be use object to medoid distance; if FALSE, it
will use average object to cluster distance. The default (FALSE) is recommended. </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_maxdisttolabel">maxDistToLabel</code></td>
<td>
<p>Deprecated, use <code>maxPamDist</code> instead. Only used for method &quot;hybrid&quot; and only if
<code>labelUnlabeled==TRUE</code>.
Maximum object distance to closest cluster that will result in the object
assigned to that cluster. </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_maxpamdist">maxPamDist</code></td>
<td>
<p>Only used for method &quot;hybrid&quot; and only if <code>labelUnlabeled==TRUE</code>. 
Maximum object distance to closest cluster that will result in the object
assigned to that cluster. Defaults to <code>cutHeight</code>. </p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_respectsmallclusters">respectSmallClusters</code></td>
<td>
<p>Only used for method &quot;hybrid&quot; and only if <code>labelUnlabeled==TRUE</code>.
If TRUE, branches that failed to be clusters in stage 1 only because of
insufficient size will be assigned together in stage 2. If FALSE, all objects will be assigned
individually.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_verbose">verbose</code></td>
<td>
<p>Controls the verbosity of the output. 0 will make the function completely quiet,
values up to 4 gradually increase verbosity.</p>
</td></tr>
<tr><td><code id="cutreeDynamic_+3A_indent">indent</code></td>
<td>
<p>Controls indentation of printed messages (see <code>verbose</code> above). Each unit
adds two spaces before printed messages; useful when several functions' output is to be nested. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper for two related but different methods for cluster detection in hierarchical
clustering dendrograms.
</p>
<p>In order to make the shape parameters <code>maxCoreScatter</code> and <code>minGap</code> more universal, their
values are interpreted relative to <code>cutHeight</code> and the 5th percetile of the merging heights (we
arbitrarily chose the 5th percetile rather than the minimum for reasons of stability). Thus, the absolute
maximum allowable core scatter is calculated as <code>maxCoreScatter * (cutHeight - refHeight) +
refHeight</code> and the absolute minimum allowable gap as <code>minGap * (cutHeight - refHeight)</code>, where
<code>refHeight</code> is the 5th percentile of the merging heights.
</p>


<h3>Value</h3>

<p>A vector of numerical labels giving assignment of objects to modules. Unassigned objects are labeled
0, the largest module has label 1, next largest 2 etc.
</p>


<h3>Author(s)</h3>

<p>Peter Langfelder, <a href="mailto:Peter.Langfelder@gmail.com">Peter.Langfelder@gmail.com</a>
</p>


<h3>References</h3>

<p>Langfelder P, Zhang B, Horvath S, 2007.
<a href="http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting">http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="#topic+cutreeHybrid">cutreeHybrid</a></code>, <code><a href="#topic+cutreeDynamicTree">cutreeDynamicTree</a></code>.
</p>

<hr>
<h2 id='cutreeDynamicTree'>Dynamic Dendrogram Pruning Based on Dendrogram Only</h2><span id='topic+cutreeDynamicTree'></span>

<h3>Description</h3>

<p>Detect clusters in a hierarchical dendrogram using a variable cut height approach. Uses only the
information in the dendrogram itself is used (which may give incorrect assignment for outlying objects).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutreeDynamicTree(dendro, maxTreeHeight = 1, deepSplit = TRUE, minModuleSize = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cutreeDynamicTree_+3A_dendro">dendro</code></td>
<td>
<p>Hierarchical clustering dendrogram such produced by <code><a href="stats.html#topic+hclust">hclust</a></code>.</p>
</td></tr>
<tr><td><code id="cutreeDynamicTree_+3A_maxtreeheight">maxTreeHeight</code></td>
<td>
<p>Maximum joining height of objects to be considered part of clusters.</p>
</td></tr>
<tr><td><code id="cutreeDynamicTree_+3A_deepsplit">deepSplit</code></td>
<td>
<p>If <code>TRUE</code>, method will favor sensitivity and produce more smaller clusters. When
<code>FALSE</code>, there will be fewer bigger clusters.</p>
</td></tr>
<tr><td><code id="cutreeDynamicTree_+3A_minmodulesize">minModuleSize</code></td>
<td>
<p>Minimum module size. Branches containing fewer than <code>minModuleSize</code> objects
will be left unlabeled.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A variable height branch pruning technique for dendrograms produced by hierarchical clustering.
Initially, branches are cut off at the height <code>maxTreeHeight</code>; the resulting clusters are then
examined for substructure and if subclusters are detected, they are assigned separate labels. Subclusters
are detected by structure and are required to have a minimum of <code>minModuleSize</code> objects on them to
be assigned a separate label. A rough degree of control over what it means to be a subcluster is
implemented by the parameter <code>deepSplit</code>.
</p>


<h3>Value</h3>

<p>A vector of numerical labels giving assignment of objects to modules. Unassigned objects are labeled 0,
the largest module has label 1, next largest 2 etc.
</p>


<h3>Author(s)</h3>

<p> Bin Zhang, <a href="mailto:binzhang.ucla@gmail.com">binzhang.ucla@gmail.com</a>, with contributions by Peter Langfelder,
<a href="mailto:Peter.Langfelder@gmail.com">Peter.Langfelder@gmail.com</a>.</p>


<h3>References</h3>

 
<p><a href="http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting">http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="#topic+cutreeHybrid">cutreeHybrid</a></code></p>

<hr>
<h2 id='cutreeHybrid'>Hybrid Adaptive Tree Cut for Hierarchical Clustering Dendrograms</h2><span id='topic+cutreeHybrid'></span>

<h3>Description</h3>

<p>Detect clusters in a dendorgram produced by the function <code>hclust</code>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutreeHybrid(
      # Input data: basic tree cutiing
      dendro, distM,

      # Branch cut criteria and options
      cutHeight = NULL, minClusterSize = 20, deepSplit = 1,

      # Advanced options
      maxCoreScatter = NULL, minGap = NULL,
      maxAbsCoreScatter = NULL, minAbsGap = NULL,

      minSplitHeight = NULL, minAbsSplitHeight = NULL,

      # External (user-supplied) measure of branch split
      externalBranchSplitFnc = NULL, minExternalSplit = NULL,
      externalSplitOptions = list(),
      externalSplitFncNeedsDistance = NULL,
      assumeSimpleExternalSpecification = TRUE,


      # PAM stage options
      pamStage = TRUE, pamRespectsDendro = TRUE,
      useMedoids = FALSE,
      maxPamDist = cutHeight,
      respectSmallClusters = TRUE,

      # Various options
      verbose = 2, indent = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cutreeHybrid_+3A_dendro">dendro</code></td>
<td>
<p>a hierarchical clustering dendorgram such as one returned by <code>hclust</code>.  </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_distm">distM</code></td>
<td>
<p>Distance matrix that was used as input to <code>hclust</code>.  </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_cutheight">cutHeight</code></td>
<td>
<p>Maximum joining heights that will be considered. It defaults to 99
of the range between the 5th percentile and the maximum of the joining heights on the dendrogram.  </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_minclustersize">minClusterSize</code></td>
<td>
<p>Minimum cluster size.  </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_deepsplit">deepSplit</code></td>
<td>
<p>Either logical or integer in the range 0 to 4. Provides a rough control over 
sensitivity to cluster splitting. The higher the value, the more and smaller clusters will be produced. 
A finer control can be achieved via <code>maxBranchCor</code>, <code>minBranchSplit</code>, 
<code>maxCoreScatter</code> and <code>minGap</code> below.</p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_maxcorescatter">maxCoreScatter</code></td>
<td>
<p> Maximum scatter of the core for a branch to be a cluster, given as the fraction
of <code>cutHeight</code> relative to the 5th percentile of joining heights. See Details.  </p>
</td></tr> 
<tr><td><code id="cutreeHybrid_+3A_mingap">minGap</code></td>
<td>
<p>Minimum cluster gap given as the fraction of the difference between <code>cutHeight</code> and
the 5th percentile of joining heights.  </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_maxabscorescatter">maxAbsCoreScatter</code></td>
<td>
<p>Maximum scatter of the core for a branch to be a cluster given as absolute
heights. If given, overrides <code>maxCoreScatter</code>.  </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_minabsgap">minAbsGap</code></td>
<td>
<p> Minimum cluster gap given as absolute height difference. If given, overrides
<code>minGap</code>.  </p>
</td></tr> 
<tr><td><code id="cutreeHybrid_+3A_minsplitheight">minSplitHeight</code></td>
<td>
<p>Minimum split height given as the fraction of the difference between
<code>cutHeight</code> and the 5th percentile of joining heights. Branches merging below this height will
automatically be merged. Defaults to zero but is used only if <code>minAbsSplitHeight</code> below is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_minabssplitheight">minAbsSplitHeight</code></td>
<td>
<p>Minimum split height given as an absolute height.
Branches merging below this height will automatically be merged. If not given (default), will be determined
from <code>minSplitHeight</code> above.</p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_externalbranchsplitfnc">externalBranchSplitFnc</code></td>
<td>
<p>Optional function to evaluate split (dissimilarity) between two branches.
Either a single function or a list in which each component is a function (see
<code>assumeSimpleExternalSpecification</code> below for how to specify a single function).
Each function can be specified by name (a character string) or the actual function object.
Each given function must take arguments <code>branch1</code> and <code>branch2</code> that specify the
indices of objects in
the two branches whose dissimilarity is to be evaluated, and possibly other arguments. It must return a
number that quantifies the dissimilarity of the two branches. The returned value will be compared to
<code>minExternalSplit</code> (see below). This argument is only used for  method &quot;hybrid&quot;.</p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_minexternalsplit">minExternalSplit</code></td>
<td>
<p>Thresholds to decide whether two branches should be merged. 
It should be a numeric vector of the same length as the number of functions in
<code>externalBranchSplitFnc</code> above. 
Only used for method &quot;hybrid&quot;. </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_externalsplitoptions">externalSplitOptions</code></td>
<td>
<p>Further arguments to function <code>externalBranchSplitFnc</code>. If only one 
external function is specified in <code>externalBranchSplitFnc</code> above, <code>externalSplitOptions</code> 
can be a named
list of arguments or a list with one component that is in turn  the named list of further arguments for
<code>externalBranchSplitFnc[[1]]</code>. The argument <code>assumeSimpleExternalSpecification</code> controls which of 
the two possibilities should be assumed. If multiple functions are specified in
<code>externalBranchSplitFnc</code>,
<code>externalSplitOptions</code>
must be a list in which each component is a named list giving the further arguments for the corresponding 
function in  <code>externalBranchSplitFnc</code>. Only used for method &quot;hybrid&quot;.</p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_externalsplitfncneedsdistance">externalSplitFncNeedsDistance</code></td>
<td>
<p>Optional specification of whether the external branch split
functions need the distance matrix as one of their arguments. Either <code>NULL</code> or a logical vector with
one element per branch split function  that specifies whether the corresponding branch split function
expects the distance matrix as one of its arguments. The default <code>NULL</code> is interpreted as a vector of
<code>TRUE</code>. When dealing with a large number of objects, setting this argument to <code>FALSE</code> whenever
possible can prevent unnecessary memory utilization.</p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_assumesimpleexternalspecification">assumeSimpleExternalSpecification</code></td>
<td>
<p>Logical: when <code>minExternalSplit</code> above is a scalar (has
length 1), should the function assume a simple specification of <code>externalBranchSplitFnc</code> and
<code>externalSplitOptions</code>? If <code>TRUE</code>, <code>externalBranchSplitFnc</code> is taken as the function
specification and <code>externalSplitOptions</code> the named list of options. This is suitable for simple direct
calls of this function. If <code>FALSE</code>, <code>externalBranchSplitFnc</code> is assumed to be a list with a
single component which specifies the function, and <code>externalSplitOptions</code> is a list with one
component that is in turn the named list of further arguments for <code>externalBranchSplitFnc[[1]]</code>.</p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_pamstage">pamStage</code></td>
<td>
<p>Logical, only used for method &quot;hybrid&quot;.  If <code>TRUE</code>, the second (PAM-like) stage will be performed.
</p>
</td></tr>    
<tr><td><code id="cutreeHybrid_+3A_pamrespectsdendro">pamRespectsDendro</code></td>
<td>
<p>Logical, only used for method &quot;hybrid&quot;. 
If <code>TRUE</code>, the PAM stage will
respect the dendrogram in the sense an object can be PAM-assigned only to clusters that lie below it on 
the branch that the object is merged into.
See <code><a href="#topic+cutreeDynamic">cutreeDynamic</a></code> for more details. </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_usemedoids">useMedoids</code></td>
<td>
<p>if TRUE, the second stage will be use object to medoid distance; if FALSE, it
will use average object to cluster distance. The default (FALSE) is recommended. </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_maxpamdist">maxPamDist</code></td>
<td>
<p>Maximum object distance to closest cluster that will result in the object
assigned to that cluster. Defaults to <code>cutHeight</code>. </p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_respectsmallclusters">respectSmallClusters</code></td>
<td>
<p>If TRUE, branches that failed to be clusters in stage 1 only because of
insufficient size will be assigned together in stage 2. If FALSE, all objects will be assigned
individually.</p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_verbose">verbose</code></td>
<td>
<p>Controls the verbosity of the output. 0 will make the function completely quiet,
values up to 4 gradually increase verbosity.</p>
</td></tr>
<tr><td><code id="cutreeHybrid_+3A_indent">indent</code></td>
<td>
<p>Controls indentation of printed messages (see <code>verbose</code> above). Each unit
adds two spaces before printed messages; useful when several functions' output is to be nested. </p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The function detects clusters in a hierarchical dendrogram based on the shape of branches on the
dendrogram. For details on the method, see
<a href="http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting">http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting</a>.
</p>
<p>In order to make the shape parameters <code>maxCoreScatter</code> and <code>minGap</code> more universal, their
values are interpreted relative to <code>cutHeight</code> and the 5th percetile of the merging heights (we
arbitrarily chose the 5th percetile rather than the minimum for reasons of stability). Thus, the absolute
maximum allowable core scatter is calculated as <code>maxCoreScatter * (cutHeight - refHeight) +
refHeight</code> and the absolute minimum allowable gap as <code>minGap * (cutHeight - refHeight)</code>, where
<code>refHeight</code> is the 5th percentile of the merging heights.
</p>


<h3>Value</h3>

<p>A list containg the following elements:
</p>
<table>
<tr><td><code>labels</code></td>
<td>
<p>Numerical labels of clusters, with 0 meaning unassigned, label 1 labeling the largest
cluster etc.  </p>
</td></tr>
<tr><td><code>cores</code></td>
<td>
<p>Numerical labels indicating cores of found clusters.  </p>
</td></tr>
<tr><td><code>smallLabels</code></td>
<td>
<p>Numerical labels for branches that failed to be recognized clusters only
because of insufficient number of objects.</p>
</td></tr>
<tr><td><code>mergeDiagnostics</code></td>
<td>
<p>A data.frame with one row  per merge in the input dendrogram. The columns give the
values of the various merging criteria used by the algorithm. Missing data indicate that at least one of the
&quot;branches&quot; merged was actually a singleton (single node) and hence the branch merging was automatic. </p>
</td></tr>
<tr><td><code>mergeCriteria</code></td>
<td>
<p>Values of the merging thresholds. Either a copy of the corresponding input thresholds
or values determined by <code>deepSplit</code>. </p>
</td></tr>
<tr><td><code>branches</code></td>
<td>
<p>A list detailing the deteced branch structure.  </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Langfelder, <a href="mailto:Peter.Langfelder@gmail.com">Peter.Langfelder@gmail.com</a>
</p>


<h3>References</h3>

<p>Langfelder P, Zhang B, Horvath S, 2007.
<a href="http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting">http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="stats.html#topic+as.dist">as.dist</a></code> 
</p>

<hr>
<h2 id='dynamicTreeCut-package'>
Methods for Detection of Clusters in Hierarchical Clustering Dendrograms
</h2><span id='topic+dynamicTreeCut-package'></span><span id='topic+dynamicTreeCut'></span>

<h3>Description</h3>

<p>Contains methods for detection of clusters in hierarchical
clustering dendrograms.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> dynamicTreeCut</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.63-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-03-10</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R, stats</td>
</tr>
<tr>
 <td style="text-align: left;">
ZipData: </td><td style="text-align: left;"> no</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL version 2 or newer</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> 
http://www.genetics.ucla.edu/labs/horvath/CoexpressionNetwork/BranchCutting/</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index:
</p>
<pre>
cutreeDynamic           Adaptive branch pruning of hierarchical
                        clustering dendrograms.
cutreeDynamicTree       Dynamic dendrogram pruning based on dendrogram
                        only
cutreeHybrid            Hybrid adaptive tree cut for hierarchical
                        clustering dendrograms.
indentSpaces            Spaces for indented output.
merge2Clusters          Merge two clusters
printFlush              Print arguments and flush the console.
treecut-package         Methods for detection of clusters in
                        hierarchical clustering dendrograms.
</pre>


<h3>Author(s)</h3>

<p>Peter Langfelder &lt;Peter.Langfelder@gmail.com&gt; and Bin Zhang
&lt;binzhang.ucla@gmail.com&gt;, with contributions from Steve
Horvath &lt;SHorvath@mednet.ucla.edu&gt;
</p>
<p>Maintainer: Peter Langfelder &lt;Peter.Langfelder@gmail.com&gt;
</p>

<hr>
<h2 id='indentSpaces'>Spaces for Indented Output</h2><span id='topic+indentSpaces'></span>

<h3>Description</h3>

<p>Returns a character string containing two times <code>indent</code> spaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indentSpaces(indent = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indentSpaces_+3A_indent">indent</code></td>
<td>
<p>Desired level of indentation. The number of returned spaces will be twice this
argument.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string containing spaces, of length twice <code>indent</code>. </p>


<h3>Author(s)</h3>

<p>Peter Langfelder, <a href="mailto:Peter.Langfelder@gmail.com">Peter.Langfelder@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spaces = indentSpaces(0);
print(paste(spaces, "This output is not indented..."));
spaces = indentSpaces(1);
print(paste(spaces, "...while this one is."))
</code></pre>

<hr>
<h2 id='merge2Clusters'>
Merge Two Clusters
</h2><span id='topic+merge2Clusters'></span>

<h3>Description</h3>

<p>Merge 2 clusters into 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge2Clusters(labels, mainClusterLabel, minorClusterLabel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge2Clusters_+3A_labels">labels</code></td>
<td>

<p>a vector or factor giving the cluster labels
</p>
</td></tr>
<tr><td><code id="merge2Clusters_+3A_mainclusterlabel">mainClusterLabel</code></td>
<td>

<p>label of the first merged cluster. The merged cluster will have this label.
</p>
</td></tr>
<tr><td><code id="merge2Clusters_+3A_minorclusterlabel">minorClusterLabel</code></td>
<td>

<p>label of the second merged cluster.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector or factor of the merged labels.
</p>


<h3>Author(s)</h3>

<p>Bin Zhang and Peter Langfelder
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
options(stringsAsFactors = FALSE);

# Works with character labels:
labels = c(rep("grey", 5), rep("blue", 2), rep("red", 3))
merge2Clusters(labels, "blue", "red")

# Works with factor labels:
labelsF = factor(labels)
merge2Clusters(labelsF, "blue", "red")

# Works also with numeric labels:

labelsN = as.numeric(factor(labels))
labelsN
merge2Clusters(labelsF, 1, 3)


</code></pre>

<hr>
<h2 id='printFlush'>Print Arguments and Flush the Console</h2><span id='topic+printFlush'></span>

<h3>Description</h3>

<p>Passes all its arguments unchaged to the standard <code>print</code> function; after the
execution of print it flushes the console, if possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printFlush(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printFlush_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to the standard <code><a href="base.html#topic+print">print</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Passes all its arguments unchaged to the standard <code>print</code> function; after the
execution of print it flushes the console, if possible.
</p>


<h3>Value</h3>

<p>Returns the value of the <code><a href="base.html#topic+print">print</a></code> function.</p>


<h3>Author(s)</h3>

<p>Peter Langfelder, <a href="mailto:Peter.Langfelder@gmail.com">Peter.Langfelder@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+print">print</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
