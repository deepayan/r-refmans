<!DOCTYPE html><html><head><title>Help for package tgram</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tgram}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#juniperus'>
<p>Traqueid Measurements in Juniperus thurifera</p></a></li>
<li><a href='#standz.all'>
<p>Vaganov Normalized Tracheidogram</p></a></li>
<li><a href='#tgram'>
<p>Compute Tracheidograms</p></a></li>
<li><a href='#traq.profile'>
<p>Light Throughout a Microscopic Section of Juniperus Wood</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Compute and Plot Tracheidograms</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-11-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcelino de la Cruz and Lucia DeSoto</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcelino de la Cruz &lt;marcelino.delacruz@urjc.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to compute and plot tracheidograms, as in De Soto et al. (2011) &lt;<a href="https://doi.org/10.1139%2Fx11-045">doi:10.1139/x11-045</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>zoo</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-11-24 21:52:11 UTC; marcelino</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-11-24 23:31:50 UTC</td>
</tr>
</table>
<hr>
<h2 id='juniperus'>
Traqueid Measurements in Juniperus thurifera
</h2><span id='topic+juniperus'></span>

<h3>Description</h3>

<p>An example of traqueid measurements to standarize with function <code>tgram</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(juniperus)</code></pre>


<h3>Format</h3>

<p>A data frame with 77 observations on the following 4 variables.
</p>

<dl>
<dt><code>traqueidogram</code></dt><dd><p>Numeric vector indicating the traqueidogram to which each measurement belongs</p>
</dd>
<dt><code>lumen.wall</code></dt><dd><p>A factor indicating if the measurement is lumen (<code>l</code>)or wall (<code>w</code>)</p>
</dd>
<dt><code>order</code></dt><dd><p>Position of the measurement in the ordered sequence within each traqueidogram</p>
</dd>
<dt><code>width.um</code></dt><dd><p>Width (micrometres) of each measurement</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(juniperus)
cosa &lt;- with(juniperus, 
                  standz.all(traq=width.um, series=traqueidogram,
                                 wl=lumen.wall, w.char="w", G=20)
                  ) 

plot(cosa, type="l")

</code></pre>

<hr>
<h2 id='standz.all'>
Vaganov Normalized Tracheidogram
</h2><span id='topic+standz.all'></span><span id='topic+standz'></span><span id='topic+plot.standz.all'></span>

<h3>Description</h3>

<p>The function produces a normalized tracheidogram, i.e. a curve showing variations in cell parameters as a function of the cell position within an annual ring, following the procedure of Vaganov (1990). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standz.all(traq, series, wl = NULL, w.char = NULL, order = NULL, G = 30)
standz(tgl1, G=30)

## S3 method for class 'standz.all'
plot(x, which=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="standz.all_+3A_traq">traq</code></td>
<td>

<p>A vector with the ordered sequences of measurements for each tracheidogram.
</p>
</td></tr>
<tr><td><code id="standz.all_+3A_series">series</code></td>
<td>

<p>A vector of indicator values (i.e. a factor) with each level indicating each unique tracheidogram.
</p>
</td></tr>
<tr><td><code id="standz.all_+3A_wl">wl</code></td>
<td>

<p>A vector indicating if the measurement is wall or lumen.
</p>
</td></tr>
<tr><td><code id="standz.all_+3A_w.char">w.char</code></td>
<td>

<p>Character used in <code>wl</code> to indicate &quot;wall&quot;.
</p>
</td></tr>
<tr><td><code id="standz.all_+3A_order">order</code></td>
<td>

<p>Vector indicating the ordering of each measurement in each lumen or wall series within a tracheidogram.
</p>
</td></tr>
<tr><td><code id="standz.all_+3A_g">G</code></td>
<td>

<p>Number of cells to get the original measurements normalized to.
</p>
</td></tr>
<tr><td><code id="standz.all_+3A_tgl1">tgl1</code></td>
<td>

<p>Vector with the ordered sequences of measurements of a single tracheidogram.
</p>
</td></tr>
<tr><td><code id="standz.all_+3A_x">x</code></td>
<td>

<p>An object of class <code>standz.all</code> resulting from applying the standz.all function.
</p>
</td></tr>
<tr><td><code id="standz.all_+3A_which">which</code></td>
<td>

<p>One of NULL, &quot;w&quot;, or any other character. This produces the plot function to draw all the tracheidograms together, only the &quot;wall&quot; traqueidograms or only the &quot;lumen&quot; ones, respectively.
</p>
</td></tr>
<tr><td><code id="standz.all_+3A_...">...</code></td>
<td>

<p>Additional graphical parameters passed to <code>link{plot}</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>standz</code> returns a vector of length <em>G</em> with the normalized values. 
<code>standz.all</code> returns an object of class <code>standz.all</code>. Basically a list with the following elements:
</p>
<table>
<tr><td><code>data.stdz</code></td>
<td>
<p>A matrix with <em>G</em> columns and as many rows as unique wall and lumen tracheidograms were in the original data, each with the normalized values of each tracheidogram.</p>
</td></tr>
<tr><td><code>which.w</code></td>
<td>
<p>Vector indicating which rows in <code>data.stdz</code> are &quot;wall&quot; tracheidograms. </p>
</td></tr>
<tr><td><code>which.l</code></td>
<td>
<p>Vector indicating which rows in <code>data.stdz</code> are &quot;lumen&quot; tracheidograms. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz Rot and Lucia DeSoto
</p>


<h3>References</h3>

<p>Vaganov, E.A. 1990. The tracheidogram method in tree-ring analysis and its application.  In: Cook E.R., Kairiukstis L.A., eds.  <em> Methods of dendrochronology: applications in the environmental sciences </em> . Kluwer Academic Publishers. Dordrecht, the Netherlands. pp. 63-76.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(juniperus)

cosa &lt;- with(juniperus,
                  standz.all(traq=width.um, series=traqueidogram,
                                wl=lumen.wall, w.char="w", G=20)
                  )

plot(cosa, type="l")
plot(cosa, type="l", which="w")
plot(cosa, type="l", which="l", add=TRUE)

standz(with(juniperus,width.um[traqueidogram==1 &amp; lumen.wall =="l"]), G=20)

lines(1:20,
      standz(with(juniperus,width.um[traqueidogram==1 &amp; lumen.wall =="l"]), G=20),
      lwd=3)

</code></pre>

<hr>
<h2 id='tgram'>
Compute Tracheidograms
</h2><span id='topic+tgram'></span><span id='topic+plot.tgram'></span>

<h3>Description</h3>

<p>Function to compute tracheidograms from microscopic measurements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tgram(traq, val50 = 50, xlim = NULL, ylim = NULL, mw = 1, plotit = TRUE)

## S3 method for class 'tgram'
plot(x, xlim = NULL, ylim = NULL, colores = c("red", "green"),
      leyenda = c("lumen", "double wall"), lwd = 2,
      add = FALSE,traq.0 = TRUE, bg.legend = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tgram_+3A_traq">traq</code></td>
<td>

<p>microscopic light profile. A vector with the light measurements or a <code>data.frame</code> or <code>matrix</code> with two columns. In this case, the first column contains pixel order (i.e. position along the x axis) and the second one contains the light (i.e. &quot;y&quot;) lectures.
</p>
</td></tr>
<tr><td><code id="tgram_+3A_val50">val50</code></td>
<td>

<p>&quot;y-value&quot; at wich measurements should be made.
</p>
</td></tr>
<tr><td><code id="tgram_+3A_mw">mw</code></td>
<td>

<p>integer. Width of the rolling window to smooth the original data.
</p>
</td></tr>
<tr><td><code id="tgram_+3A_plotit">plotit</code></td>
<td>

<p>logical. should the original data and the computed tracheidogram be drawn?
</p>
</td></tr>
<tr><td><code id="tgram_+3A_xlim">xlim</code></td>
<td>

<p>extent of the x-axis. A vector of length 2. 
</p>
</td></tr>
<tr><td><code id="tgram_+3A_ylim">ylim</code></td>
<td>

<p>extent of the y-axis. A vector of length 2. 
</p>
</td></tr>
<tr><td><code id="tgram_+3A_x">x</code></td>
<td>

<p>an object of class tgram, resulting from <code>tgram</code> function.
</p>
</td></tr>
<tr><td><code id="tgram_+3A_colores">colores</code></td>
<td>

<p>a vector of length 2, with the colors to draw the lumen and wall measurements, respectively. 
</p>
</td></tr>
<tr><td><code id="tgram_+3A_leyenda">leyenda</code></td>
<td>

<p>a vector of length 2 with the legend to appear in the plot. By default leyenda =c(&quot;lumen&quot;,&quot;double wall&quot;).
</p>
</td></tr>
<tr><td><code id="tgram_+3A_lwd">lwd</code></td>
<td>

<p>width of the lines in the legend. 
</p>
</td></tr>
<tr><td><code id="tgram_+3A_add">add</code></td>
<td>

<p>logical. If TRUE, add to a current plot.
</p>
</td></tr>
<tr><td><code id="tgram_+3A_traq.0">traq.0</code></td>
<td>

<p>logical. If TRUE, draw the original measurements.
</p>
</td></tr>
<tr><td><code id="tgram_+3A_bg.legend">bg.legend</code></td>
<td>

<p>background color for the legend.
</p>
</td></tr>
<tr><td><code id="tgram_+3A_...">...</code></td>
<td>

<p>additional graphical parameters.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpouse of this fucntion is obtaining cell anatomical data from microscopic light measurements (see DeSoto et al. for details of data adquisition). The microscopic lectures are first smoothed with a rolling window (using function <code><a href="zoo.html#topic+rollmean">rollmean</a></code> of package <code>zoo</code>, using the selected width <code>mw</code>. Then, the smoothed curve is &quot;cut&quot; at the  treshold value <code>val50</code> and the distances among the intersection points are computed. This provides an ordered sequence of  lumen diameters (LD) and double wall thikness (DWT) measurements. From this sequence some other anatomical measurements are computed. Radial cell wall thickness is computed as <em> CWT[t] = 1/2 * (DWT[t]/2 + DWT[t+1]/2) </em>. Tracheid diameter is computed as <em> TD[t] = DWT[t]/2 + LD[t] + DWT[t+1]/2</em>.
</p>


<h3>Value</h3>

<p>tgram returns an object of class <em>tgram</em>, bassically a list with 
</p>
<table>
<tr><td><code>traq</code></td>
<td>
<p>original data.</p>
</td></tr>
<tr><td><code>traq0</code></td>
<td>
<p>if <code>traq</code> was a 2 column matrix, then <code>traq0</code> returns the same object. If <code>traq</code> was a vector,  <code>traq0</code> returns a two column matrix (first column with pixel position and second with ligh lectures).</p>
</td></tr>
<tr><td><code>cut.points</code></td>
<td>
<p>two column matrix with the coordinates of the intersection of <em>y = val50</em> and the smoothed curve.</p>
</td></tr>
<tr><td><code>what</code></td>
<td>
<p>vector indicating if the computed distances are of lumen (1) or double wall (2) .</p>
</td></tr>
<tr><td><code>distances</code></td>
<td>
<p>ordered sequence of the computed distances (both of lumen and double wall).</p>
</td></tr>
<tr><td><code>LD</code></td>
<td>
<p>ordered sequence of lumen diameters.</p>
</td></tr>
<tr><td><code>DWT</code></td>
<td>
<p>ordered sequence of double wall thickness. </p>
</td></tr>
<tr><td><code>mw</code></td>
<td>
<p>width of the rolling window employed to smooth the data.</p>
</td></tr>
<tr><td><code>CWT</code></td>
<td>
<p>ordered sequence of radial cell wall thikness'.</p>
</td></tr>
<tr><td><code>TD</code></td>
<td>
<p>ordered sequence of tracheid diameters.</p>
</td></tr>
<tr><td><code>LD_CWT_ratio</code></td>
<td>
<p>ordered sequence of LD/CWT ratio.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz Rot and Lucia DeSoto
</p>


<h3>References</h3>

<p>DeSoto, L., De la Cruz, M. &amp; Fonti, P. 2011. Intra-annual pattern of tracheid size in the Mediterranean Juniperus thurifera as indicator for seasonal water stress. <em>Canadian Journal of Forest Research</em>  41: 1280-1294.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(traq.profile)

plot(tgram(traq.profile, mw=10),leyenda=c("lumen","double wall"),
        xlab="distance pixel", ylab="grey value",ylim=c(0,250),
        bg.legend="white")



</code></pre>

<hr>
<h2 id='traq.profile'>
Light Throughout a Microscopic Section of Juniperus Wood 
</h2><span id='topic+traq.profile'></span>

<h3>Description</h3>

<p>A measurement of light intensity troughout a sequence of pixels in a microscopic section of <em>Juniperus thurifera</em> wood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(traq.profile)</code></pre>


<h3>Format</h3>

<p>A data frame with 883 observations on the following 2 variables.
</p>

<dl>
<dt><code>X1</code></dt><dd><p>Pixel position in the sequence</p>
</dd>
<dt><code>Y1</code></dt><dd><p>Light intensity</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(traq.profile)
tgram(traq.profile, mw=10)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
