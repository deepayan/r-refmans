<!DOCTYPE html><html><head><title>Help for package zeitgebr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {zeitgebr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cwt_spectrogram'><p>Computes a spectrogram using CWT</p></a></li>
<li><a href='#dams_sample'><p>A behavr table with approximately ten days of DAM2 recording for 32 fruit flies.</p>
The first 10, the following 11 and the last 11 animals have long, short and wild type period,
respectively (see <code>meta(dams_sample)</code>).</a></li>
<li><a href='#find_peaks'><p>Find peaks in a periodogram</p></a></li>
<li><a href='#periodogram'><p>Computes periodograms</p></a></li>
<li><a href='#periodogram_methods'><p>Methods For Computing Periodograms</p></a></li>
<li><a href='#spectrogram'><p>Computes spectrogram</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Analysis of Circadian Behaviours</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-04-22</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Use behavioural variables to compute period, rhythmicity and other circadian parameters.
  Methods include computation of chi square periodograms (Sokolove and Bushell (1978) &lt;<a href="https://doi.org/10.1016%2F0022-5193%2878%2990022-X">doi:10.1016/0022-5193(78)90022-X</a>&gt;),
  Lomb-Scargle periodograms (Lomb (1976) &lt;<a href="https://doi.org/10.1007%2FBF00648343">doi:10.1007/BF00648343</a>&gt;, Scargle (1982) &lt;<a href="https://doi.org/10.1086%2F160554">doi:10.1086/160554</a>&gt;, Ruf (1999) &lt;<a href="https://doi.org/10.1076%2Fbrhm.30.2.178.1422">doi:10.1076/brhm.30.2.178.1422</a>&gt;),
  and autocorrelation-based periodograms.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.00), behavr</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, lomb, pracma, WaveletComp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, covr, knitr, ggetho, damr, xsp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/rethomics/zeitgebr">https://github.com/rethomics/zeitgebr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rethomics/zeitgebr/issues">https://github.com/rethomics/zeitgebr/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-24 00:54:58 UTC; quentin</td>
</tr>
<tr>
<td>Author:</td>
<td>Quentin Geissmann [aut, cre],
  Luis Garcia [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Quentin Geissmann &lt;qgeissmann@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-25 14:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='cwt_spectrogram'>Computes a spectrogram using CWT</h2><span id='topic+cwt_spectrogram'></span>

<h3>Description</h3>

<p>A port of Continuous Wavelet transform to <code>rethomics</code>.
This function is intended to be used as an argument in the <a href="#topic+spectrogram">spectrogram</a> wrapper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cwt_spectrogram(x, period_range = c(hours(1), hours(32)),
  sampling_rate = 1/mins(1), resolution = 1/64,
  summary_time_window = mins(30))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cwt_spectrogram_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="cwt_spectrogram_+3A_period_range">period_range</code></td>
<td>
<p>vector of size 2 defining minimal and maximal range of period to study (in seconds)</p>
</td></tr>
<tr><td><code id="cwt_spectrogram_+3A_sampling_rate">sampling_rate</code></td>
<td>
<p>the &ndash; implicitly regular &ndash; sampling rate of x (in hertz)</p>
</td></tr>
<tr><td><code id="cwt_spectrogram_+3A_resolution">resolution</code></td>
<td>
<p>the period resolution of the CWT (i.e. the number of suboctaves)</p>
</td></tr>
<tr><td><code id="cwt_spectrogram_+3A_summary_time_window">summary_time_window</code></td>
<td>
<p>the sampling period after post-processing.
Values of power are avegraged over this time window, for each period.</p>
</td></tr>
</table>


<h3>See Also</h3>


<ul>
<li> <p><a href="#topic+spectrogram">spectrogram</a> &ndash; to apply this fucntion to all indivvidual, with some preprocessing.
</p>
</li>
<li> <p><a href="WaveletComp.html#topic+analyze.wavelet">WaveletComp::analyze.wavelet</a> &ndash; the orginal function for <code>cwt_spectrogram</code>
</p>
</li></ul>


<hr>
<h2 id='dams_sample'>A behavr table with approximately ten days of DAM2 recording for 32 fruit flies.
The first 10, the following 11 and the last 11 animals have long, short and wild type period,
respectively (see <code>meta(dams_sample)</code>).</h2><span id='topic+dams_sample'></span>

<h3>Description</h3>

<p>A behavr table with approximately ten days of DAM2 recording for 32 fruit flies.
The first 10, the following 11 and the last 11 animals have long, short and wild type period,
respectively (see <code>meta(dams_sample)</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dams_sample
</code></pre>


<h3>Format</h3>

<p>An object of class <code>behavr</code> (inherits from <code>data.table</code>, <code>data.frame</code>) with 415040 rows and 3 columns.</p>


<h3>Author(s)</h3>

<p>Luis Garcia
</p>


<h3>References</h3>

<p>Raw data stored at <a href="https://github.com/rethomics/zeitgebr/tree/master/raw_data">https://github.com/rethomics/zeitgebr/tree/master/raw_data</a>
</p>

<hr>
<h2 id='find_peaks'>Find peaks in a periodogram</h2><span id='topic+find_peaks'></span>

<h3>Description</h3>

<p>This function locates the peaks in a pregenerated periodogram.
Detection is based on <a href="pracma.html#topic+findpeaks">pracma::findpeaks</a>.
Only the significant (i.e. <code>power &gt; signif_threshold</code>) peaks are extracted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_peaks(data, n_peaks = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_peaks_+3A_data">data</code></td>
<td>
<p><a href="behavr.html#topic+behavr">behavr::behavr</a> table representing a periodogram, as returned by <a href="#topic+periodogram">periodogram</a></p>
</td></tr>
<tr><td><code id="find_peaks_+3A_n_peaks">n_peaks</code></td>
<td>
<p>maximal numbers of peak to be detected</p>
</td></tr>
</table>


<h3>Value</h3>

<p><a href="behavr.html#topic+behavr">behavr::behavr</a> table that is <code>data</code> with an extra column <code>peak</code>.
<code>peak</code> is filled with zeros except for rows match a peak.
In which case, rows have an integer value corresponding to the rank of the peak (e.g. 1 for the first peak).
</p>


<h3>References</h3>


<ul>
<li> <p><a href="https://rethomics.github.io/zeitgebr.html">zeitgebr tutorial</a> &ndash; the relevant rehtomics tutorial
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li> <p><a href="#topic+periodogram">periodogram</a> &ndash; to generate a periodogram in a first place
</p>
</li>
<li> <p><a href="ggetho.html#topic+geom_peak">ggetho::geom_peak</a> &ndash; a layer to show peaks on a periodogram
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(dams_sample)
# only four ndividuals for the sake of the example
dt &lt;- dams_sample[xmv(region_id) %in% c(1, 7, 21, 31)]
per_dt_xs &lt;- periodogram(activity, dt, FUN = chi_sq_periodogram)
per_dt_xs_with_peaks &lt;- find_peaks(per_dt_xs)
per_dt_xs_with_peaks[peak == 1]
</code></pre>

<hr>
<h2 id='periodogram'>Computes periodograms</h2><span id='topic+periodogram'></span>

<h3>Description</h3>

<p>This function builds periodograms, with one of several methods, for each individual of a <a href="behavr.html#topic+behavr">behavr</a> table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>periodogram(var, data, period_range = c(hours(16), hours(32)),
  resample_rate = 1/mins(15), alpha = 0.01, FUN = chi_sq_periodogram,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="periodogram_+3A_var">var</code></td>
<td>
<p>variable to analyse</p>
</td></tr>
<tr><td><code id="periodogram_+3A_data">data</code></td>
<td>
<p><a href="behavr.html#topic+behavr">behavr</a> table</p>
</td></tr>
<tr><td><code id="periodogram_+3A_period_range">period_range</code></td>
<td>
<p>vector of size 2 defining minimal and maximal range of period to study (in seconds)</p>
</td></tr>
<tr><td><code id="periodogram_+3A_resample_rate">resample_rate</code></td>
<td>
<p>frequency to resample (up or down) the data at (in hertz)</p>
</td></tr>
<tr><td><code id="periodogram_+3A_alpha">alpha</code></td>
<td>
<p>significance level</p>
</td></tr>
<tr><td><code id="periodogram_+3A_fun">FUN</code></td>
<td>
<p>function used to compute periodogram (see <a href="#topic+periodogram_methods">periodogram_methods</a>)</p>
</td></tr>
<tr><td><code id="periodogram_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to FUN</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="behavr.html#topic+behavr">behavr::behavr</a> table.
In addition to the metadata, it contains data that encodes a periodogram (i.e. power vs period).
The data contains the columns:
</p>

<ul>
<li> <p><code>power</code> &ndash; the power the or equivalent (according to <code>FUN</code>)
</p>
</li>
<li> <p><code>period</code> &ndash; the period at which <code>power</code> is computed (in seconds)
</p>
</li>
<li> <p><code>p_value</code> &ndash; the p value associated to the power estimation
</p>
</li>
<li> <p><code>signif threshold</code> &ndash; the threshold above which power is considered significant
</p>
</li></ul>



<h3>References</h3>


<ul>
<li> <p><a href="https://rethomics.github.io/zeitgebr.html">zeitgebr tutorial</a> &ndash; the relevant rehtomics tutorial
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li> <p><a href="#topic+periodogram_methods">periodogram_methods</a> &ndash; the list of built-in methods
</p>
</li>
<li> <p><a href="#topic+find_peaks">find_peaks</a> &ndash; to find peaks in the periodogram
</p>
</li>
<li> <p><a href="ggetho.html#topic+ggperio">ggetho::ggperio</a> &ndash; to plot periodograms
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(dams_sample)
# only four individuals for the sake of the example
dt &lt;- dams_sample[xmv(region_id) %in% c(1, 7, 21, 31)]
pdt &lt;- periodogram(activity, dt, FUN = ls_periodogram, oversampling = 4)
pdt &lt;- periodogram(activity, dt, FUN = chi_sq_periodogram)

require(ggetho)
ggperio(pdt, aes(colour=period_group)) + stat_pop_etho()


</code></pre>

<hr>
<h2 id='periodogram_methods'>Methods For Computing Periodograms</h2><span id='topic+periodogram_methods'></span><span id='topic+ac_periodogram'></span><span id='topic+chi_sq_periodogram'></span><span id='topic+cwt_periodogram'></span><span id='topic+fourier_periodogram'></span><span id='topic+ls_periodogram'></span>

<h3>Description</h3>

<p>These functions provides a series of methods to assess periodicity of circadian processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ac_periodogram(x, period_range = c(hours(16), hours(32)),
  sampling_rate = 1/mins(1), alpha = 0.05)

chi_sq_periodogram(x, period_range = c(hours(16), hours(32)),
  sampling_rate = 1/mins(1), alpha = 0.05,
  time_resolution = hours(0.1))

cwt_periodogram(x, period_range = c(hours(16), hours(32)),
  sampling_rate = 1/mins(1), alpha = 0.05, resolution = 1/512,
  n_sim = 10)

fourier_periodogram(x, period_range = c(hours(16), hours(32)),
  sampling_rate = 1/mins(1), alpha = 0.05)

ls_periodogram(x, period_range = c(hours(16), hours(32)),
  sampling_rate = 1/mins(1), alpha = 0.05, oversampling = 8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="periodogram_methods_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="periodogram_methods_+3A_period_range">period_range</code></td>
<td>
<p>vector of size 2 defining minimal and maximal range of period to study (in seconds)</p>
</td></tr>
<tr><td><code id="periodogram_methods_+3A_sampling_rate">sampling_rate</code></td>
<td>
<p>the &ndash; implicitly regular &ndash; sampling rate of x (in hertz)</p>
</td></tr>
<tr><td><code id="periodogram_methods_+3A_alpha">alpha</code></td>
<td>
<p>significance level</p>
</td></tr>
<tr><td><code id="periodogram_methods_+3A_time_resolution">time_resolution</code></td>
<td>
<p>the resolution of periods to scan</p>
</td></tr>
<tr><td><code id="periodogram_methods_+3A_resolution">resolution</code></td>
<td>
<p>the period resolution of the CWT (i.e. the number of suboctaves)</p>
</td></tr>
<tr><td><code id="periodogram_methods_+3A_n_sim">n_sim</code></td>
<td>
<p>the number of shuffling simulation to compute p-value (see <a href="WaveletComp.html#topic+analyze.wavelet">WaveletComp::analyze.wavelet</a>)</p>
</td></tr>
<tr><td><code id="periodogram_methods_+3A_oversampling">oversampling</code></td>
<td>
<p>the oversampling factor (see <a href="lomb.html#topic+lsp">lomb::lsp</a>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="data.table.html#topic+data.table">data.table</a> with the columns:
</p>

<ul>
<li> <p><code>period</code> &ndash; the period (in s)
</p>
</li>
<li> <p><code>power</code> &ndash; the power (or equivalent) for a given period
</p>
</li>
<li> <p><code>p_value</code> &ndash; the significance of the power
</p>
</li>
<li> <p><code>signif_threshold</code> &ndash; the significance threshold of the power (at alpha)
</p>
</li></ul>



<h3>References</h3>


<ul>
<li> <p><a href="https://rethomics.github.io/zeitgebr.html">zeitgebr tutorial</a> &ndash; the relevant rehtomics tutorial
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li> <p><a href="lomb.html#topic+lsp">lomb::lsp</a>  &ndash; the orginal function for <code>ls_periodogram</code>
</p>
</li>
<li> <p><a href="xsp.html#topic+chiSqPeriodogram">xsp::chiSqPeriodogram</a> &ndash; code modified from
</p>
</li>
<li> <p><a href="stats.html#topic+acf">stats::acf</a> &ndash; the orginal function for <code>ac_periodogram</code>
</p>
</li>
<li> <p><a href="WaveletComp.html#topic+analyze.wavelet">WaveletComp::analyze.wavelet</a> &ndash; the orginal function for <code>cwt_periodogram</code>
</p>
</li></ul>


<hr>
<h2 id='spectrogram'>Computes spectrogram</h2><span id='topic+spectrogram'></span>

<h3>Description</h3>

<p>This function builds spectrogram, using CWT, for each individual of a <a href="behavr.html#topic+behavr">behavr</a> table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectrogram(var, data, period_range = c(hours(16), hours(32)),
  resample_rate = 1/mins(15), FUN = cwt_spectrogram, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spectrogram_+3A_var">var</code></td>
<td>
<p>variable to analyse</p>
</td></tr>
<tr><td><code id="spectrogram_+3A_data">data</code></td>
<td>
<p><a href="behavr.html#topic+behavr">behavr</a> table</p>
</td></tr>
<tr><td><code id="spectrogram_+3A_period_range">period_range</code></td>
<td>
<p>vector of size 2 defining minimal and maximal range of period to study (in seconds)</p>
</td></tr>
<tr><td><code id="spectrogram_+3A_resample_rate">resample_rate</code></td>
<td>
<p>frequency to resample (up or down) the data at (in hertz)</p>
</td></tr>
<tr><td><code id="spectrogram_+3A_fun">FUN</code></td>
<td>
<p>function used to compute spectrograms (so far, only CWT is implemented via <a href="#topic+cwt_spectrogram">cwt_spectrogram</a>)</p>
</td></tr>
<tr><td><code id="spectrogram_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to FUN</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A spectrogram is a estimation of the local periodicity of a signal at a given time.
In the context of circadian rhythm, it can be useful to understand how infradian rhythms change along the day or,
for instance, how circadian rhythm change ver the course of an multi-day experiment.
</p>


<h3>Value</h3>

<p>A <a href="behavr.html#topic+behavr">behavr::behavr</a> table.
In addition to the metadata, it contains data that encodes a spectrogram (i.e. power vs period).
The data contains the columns:
</p>

<ul>
<li> <p><code>t</code> &ndash; the time (in s) (same range the input time)
</p>
</li>
<li> <p><code>period</code> &ndash; the period at which the <code>power</code> is computed, for a given <code>t</code> (in s)
</p>
</li>
<li> <p><code>power</code> &ndash; the power the or equivalent (according to <code>FUN</code>)
</p>
</li>
<li> <p><code>ridge</code> &ndash; a logical defining whether the point (<code>t</code> and <code>period</code>) is a ridge
</p>
</li></ul>



<h3>References</h3>


<ul>
<li> <p><a href="https://rethomics.github.io/ggetho.html#spectrograms">spectrogram tutorial</a> &ndash; the relevant rehtomics tutorial
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li> <p><a href="#topic+periodogram">periodogram</a> &ndash; to compute periodogram instead
</p>
</li>
<li> <p><a href="#topic+cwt_spectrogram">cwt_spectrogram</a> &ndash; The dunction use to compute individual spectrograms
</p>
</li>
<li> <p><a href="ggetho.html#topic+ggspectro">ggetho::ggspectro</a> &ndash; to plot spectrograms
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(dams_sample)
dt &lt;- dams_sample[id %in% dams_sample[meta=TRUE, ,id[1:5]]]
spect_dt &lt;- spectrogram(activity, dt)


require(ggetho)
ggspectro(spect_dt) +
        stat_tile_etho() +
        scale_y_log10() +
        facet_wrap(~ id)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
