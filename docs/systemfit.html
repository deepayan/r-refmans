<!DOCTYPE html><html><head><title>Help for package systemfit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {systemfit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bread.systemfit'><p>Bread for Sandwiches</p></a></li>
<li><a href='#coef.systemfit'><p>Coefficients of systemfit object</p></a></li>
<li><a href='#confint.systemfit'><p>Confidence intervals of coefficients</p></a></li>
<li><a href='#correlation.systemfit'><p>Correlation between Predictions from Equation i and j</p></a></li>
<li><a href='#createSystemfitModel'><p>Create a Model for systemfit</p></a></li>
<li><a href='#estfun.systemfit'><p>Extract Gradients of the Objective Function at each Observation</p></a></li>
<li><a href='#fitted.systemfit'><p>Fitted values</p></a></li>
<li><a href='#formula.systemfit'><p>Model Formulae of systemfit Objects</p></a></li>
<li><a href='#GrunfeldGreene'><p>Grunfeld Data as published by Greene (2003)</p></a></li>
<li><a href='#hausman.systemfit'><p>Hausman Test</p></a></li>
<li><a href='#KleinI'><p>Klein Model I</p></a></li>
<li><a href='#Kmenta'><p>Partly Artificial Data on the U. S. Economy</p></a></li>
<li><a href='#linearHypothesis.systemfit'><p>Test Linear Hypothesis</p></a></li>
<li><a href='#logLik.systemfit'><p>Log-Likelihood value of systemfit object</p></a></li>
<li><a href='#lrtest.systemfit'><p>Likelihood Ratio test for Equation Systems</p></a></li>
<li><a href='#model.frame.systemfit'><p>Extracting the Data of a systemfit Object</p></a></li>
<li><a href='#model.matrix.systemfit'><p>Construct Design Matrices for Systems of Equations</p></a></li>
<li><a href='#nlsystemfit'><p>Nonlinear Equation System Estimation</p></a></li>
<li><a href='#ppine'><p>Tree Growth Data for Ponderosa Pine</p></a></li>
<li><a href='#predict.systemfit'><p>Predictions from System Estimation</p></a></li>
<li><a href='#print.confint.systemfit'><p>Print confidence intervals of coefficients</p></a></li>
<li><a href='#print.nlsystemfit'><p>Print output of nlsystemfit estimation</p></a></li>
<li><a href='#print.systemfit'><p>Print results of systemfit estimation</p></a></li>
<li><a href='#residuals.systemfit'><p>Residuals of systemfit object</p></a></li>
<li><a href='#se.ratio.systemfit'><p>Ratio of the Standard Errors</p></a></li>
<li><a href='#summary.nlsystemfit'><p>Summary of nlsystemfit estimation</p></a></li>
<li><a href='#summary.systemfit'><p>Summary of systemfit estimation</p></a></li>
<li><a href='#systemfit'><p>Linear Equation System Estimation</p></a></li>
<li><a href='#systemfit-internal'><p>Internal systemfit functions</p></a></li>
<li><a href='#systemfit.control'><p>Create list of control parameters for systemfit</p></a></li>
<li><a href='#terms.systemfit'><p>Model Terms of systemfit Objects</p></a></li>
<li><a href='#vcov.systemfit'><p>Variance covariance matrix of coefficients</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1-30</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-22</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating Systems of Simultaneous Equations</td>
</tr>
<tr>
<td>Author:</td>
<td>Arne Henningsen and Jeff D. Hamann</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arne Henningsen &lt;arne.henningsen@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), Matrix, car (&ge; 2.0-0), lmtest</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, plm (&ge; 1.0-1), sem (&ge; 2.0-0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats (&ge; 2.14.0), sandwich (&ge; 2.2-9), MASS, methods</td>
</tr>
<tr>
<td>Description:</td>
<td>Econometric estimation of simultaneous
 systems of linear and nonlinear equations using Ordinary Least
 Squares (OLS), Weighted Least Squares (WLS), Seemingly Unrelated
 Regressions (SUR), Two-Stage Least Squares (2SLS), Weighted
 Two-Stage Least Squares (W2SLS), and Three-Stage Least Squares (3SLS)
 as suggested, e.g., by Zellner (1962) &lt;<a href="https://doi.org/10.2307%2F2281644">doi:10.2307/2281644</a>&gt;,
 Zellner and Theil (1962) &lt;<a href="https://doi.org/10.2307%2F1911287">doi:10.2307/1911287</a>&gt;, and
 Schmidt (1990) &lt;<a href="https://doi.org/10.1016%2F0304-4076%2890%2990127-F">doi:10.1016/0304-4076(90)90127-F</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-forge.r-project.org/projects/systemfit/">https://r-forge.r-project.org/projects/systemfit/</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-22 13:15:35 UTC; gsl324</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-22 17:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bread.systemfit'>Bread for Sandwiches</h2><span id='topic+bread.systemfit'></span>

<h3>Description</h3>

<p>Extract the estimator for the bread of sandwhiches
(see <code><a href="sandwich.html#topic+bread">bread</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'systemfit'
bread( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bread.systemfit_+3A_x">x</code></td>
<td>
<p>an object of class <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="bread.systemfit_+3A_...">...</code></td>
<td>
<p>further arguments (currently ignored).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Quadratic symmetric matrix,
which is an estimator for the expectation of the negative derivative 
of the estimating function (see <code><a href="#topic+estfun.systemfit">estfun.systemfit</a></code>).
</p>


<h3>Warnings</h3>

<p>The <span class="pkg">sandwich</span> package must be loaded before this method
can be used.
</p>
<p>This method might not be suitable for specific formulas 
for 3SLS estimations in case of unbalanced systems
or different instruments for different equations.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen
</p>


<h3>See Also</h3>

<p><code><a href="sandwich.html#topic+bread">bread</a></code>, <code><a href="#topic+systemfit">systemfit</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )
inst &lt;- ~ income + farmPrice + trend

## OLS estimation
fitols &lt;- systemfit( system, "OLS", data = Kmenta )

## obtain the bread
library( "sandwich" )
bread( fitols )

## this is only true for OLS models
all.equal( bread( fitols ),
   solve( crossprod( model.matrix( fitols ) ) / 40 ) )


## 2SLS estimation
fit2sls &lt;- systemfit( system, "2SLS", inst = inst, data = Kmenta )

## obtain the bread
bread( fit2sls )

## this is only true for 2SLS models
all.equal( bread( fit2sls ),
   solve( crossprod( model.matrix( fit2sls, which = "xHat" ) ) / 40 ) )


## iterated SUR estimation
fitsur &lt;- systemfit( system, "SUR", data = Kmenta, maxit = 100 )

## obtain the bread
bread( fitsur )

## this should be true for SUR and WLS models
all.equal( bread( fitsur ),
   solve( t( model.matrix( fitsur ) ) %*%
      (  ( solve( fitsur$residCovEst ) %x% diag( nrow( Kmenta ) ) ) %*% 
      model.matrix( fitsur ) ) / 40 ), check.attributes = FALSE )


## 3SLS estimation
fit3sls &lt;- systemfit( system, "3SLS", inst = inst, data = Kmenta )

## obtain the bread
bread( fit3sls )

## this should be true for 3SLS and W2SLS models
all.equal( bread( fit3sls ),
   solve( t( model.matrix( fit3sls, which = "xHat" ) ) %*%
      (  ( solve( fit3sls$residCovEst ) %x% diag( nrow( Kmenta ) ) ) %*% 
      model.matrix( fit3sls, which = "xHat" ) ) / 40 ), check.attributes = FALSE )
</code></pre>

<hr>
<h2 id='coef.systemfit'>Coefficients of systemfit object</h2><span id='topic+coef.systemfit'></span><span id='topic+coef.systemfit.equation'></span><span id='topic+coef.summary.systemfit'></span><span id='topic+coef.summary.systemfit.equation'></span>

<h3>Description</h3>

<p>These functions extract the coefficients from an object returned by
<code><a href="#topic+systemfit">systemfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
coef( object, modified.regMat = FALSE, ... )

   ## S3 method for class 'systemfit.equation'
coef( object, ... )

   ## S3 method for class 'summary.systemfit'
coef( object, modified.regMat = FALSE, ... )

   ## S3 method for class 'summary.systemfit.equation'
coef( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.systemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>systemfit</code>,
<code>systemfit.equation</code>, <code>summary.systemfit</code>, or
<code>summary.systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="coef.systemfit_+3A_modified.regmat">modified.regMat</code></td>
<td>
<p>logical. If <code>TRUE</code>,
the coefficients of the modified regressor matrix
(original regressor matrix post-multiplied by <code>restrict.regMat</code>)
rather than the coefficients of the original regressor matrix
are returned.</p>
</td></tr>
<tr><td><code id="coef.systemfit_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>coef.systemfit</code> returns a vector of all estimated coefficients.
</p>
<p><code>coef.systemfit.equation</code> returns a vector of the estimated coefficients
of a single equation.
</p>
<p><code>coef.summary.systemfit</code> returns a matrix of all estimated coefficients,
their standard errors, t-values, and p-values.
</p>
<p><code>coef.summary.systemfit.equation</code> returns a matrix of the estimated
coefficients of a single equation, their standard errors, t-values,
and p-values.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+coef">coef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS on each of the equations in the system
fitols &lt;- systemfit( system, data = Kmenta )

## all coefficients
coef( fitols )
coef( summary( fitols ) )

## coefficients of the first equation
coef( fitols$eq[[1]] )
coef( summary( fitols$eq[[1]] ) )

## coefficients of the second equation
coef( fitols$eq[[2]] )
coef( summary( fitols$eq[[2]] ) )

## estimation with restriction by modifying the regressor matrix
modReg &lt;- matrix( 0, 7, 6 )
colnames( modReg ) &lt;- c( "demIntercept", "demPrice", "demIncome",
   "supIntercept", "supPrice2", "supTrend" )
modReg[ 1, "demIntercept" ] &lt;- 1
modReg[ 2, "demPrice" ]     &lt;- 1
modReg[ 3, "demIncome" ]    &lt;- 1
modReg[ 4, "supIntercept" ] &lt;- 1
modReg[ 5, "supPrice2" ]    &lt;- 1
modReg[ 6, "supPrice2" ]    &lt;- 1
modReg[ 7, "supTrend" ]     &lt;- 1
fitols3 &lt;- systemfit( system, data = Kmenta, restrict.regMat = modReg )
coef( fitols3, modified.regMat  = TRUE )
coef( fitols3 )
</code></pre>

<hr>
<h2 id='confint.systemfit'>Confidence intervals of coefficients</h2><span id='topic+confint.systemfit'></span><span id='topic+confint.systemfit.equation'></span>

<h3>Description</h3>

<p>These functions calculate the confidence intervals of the
coefficients from an object returned by <code><a href="#topic+systemfit">systemfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
confint( object, parm = NULL, level = 0.95,
      useDfSys = NULL, ... )

   ## S3 method for class 'systemfit.equation'
confint( object, parm, level = 0.95,
      useDfSys = NULL, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.systemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>systemfit</code> or <code>systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="confint.systemfit_+3A_parm">parm</code></td>
<td>
<p>not used yet.</p>
</td></tr>
<tr><td><code id="confint.systemfit_+3A_level">level</code></td>
<td>
<p>confidence level.</p>
</td></tr>
<tr><td><code id="confint.systemfit_+3A_usedfsys">useDfSys</code></td>
<td>
<p>logical. Use the degrees of freedom of the whole system
(in place of the degrees of freedom of the single equation)
to calculate the confidence intervals of the coefficients.
If it not specified (<code>NULL</code>), it is set to <code>TRUE</code>
if restrictions on the coefficients are imposed and <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="confint.systemfit_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>confint.systemfit</code>, which is a matrix
with columns giving lower and upper confidence limits
for each estimated coefficient. These will be labelled as
(1-level)/2 and 1 - (1-level)/2 in % (by default 2.5% and 97.5%).
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>,
<code><a href="#topic+print.confint.systemfit">print.confint.systemfit</a></code>, <code><a href="stats.html#topic+confint">confint</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS on each of the equations in the system
fitols &lt;- systemfit( system, data = Kmenta )

## confidence intervals of all coefficients
confint( fitols )

## confidence intervals of the coefficients of the first equation
confint( fitols$eq[[1]] )

## confidence intervals of the coefficients of the second equation
confint( fitols$eq[[2]] )
</code></pre>

<hr>
<h2 id='correlation.systemfit'>Correlation between Predictions from Equation i and j</h2><span id='topic+correlation.systemfit'></span>

<h3>Description</h3>

<p><code>correlation</code> returns a vector of the correlations
between the predictions of two equations in a set of equations. The
correlation between the predictions is defined as,
</p>
<p style="text-align: center;"><code class="reqn">
    r_{ijk} = \frac{x'_{ik}C_{ij}x_{jk}}{\sqrt{(x'_{ik}C_{ii}x_{ik})(x'_{jk}C_{jj}x_{jk})}}
  </code>
</p>

<p>where <code class="reqn">r_{ijk}</code> is the correlation between the predicted values of
equation i and j and  <code class="reqn">C_{ij}</code> is the cross-equation variance-covariance
matrix between equations i and j.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correlation.systemfit( results, eqni, eqnj )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correlation.systemfit_+3A_results">results</code></td>
<td>
<p>an object of type <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="correlation.systemfit_+3A_eqni">eqni</code></td>
<td>
<p>index for equation i</p>
</td></tr>
<tr><td><code id="correlation.systemfit_+3A_eqnj">eqnj</code></td>
<td>
<p>index for equation j</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>correlation</code> returns a vector of the correlations between the
predicted values in equation i and equation j.
</p>


<h3>Author(s)</h3>

<p>Jeff D. Hamann <a href="mailto:jeff.hamann@forestinformatics.com">jeff.hamann@forestinformatics.com</a></p>


<h3>References</h3>

<p>Greene, W. H. (1993)
<em>Econometric Analysis, Second Edition</em>, Macmillan.
</p>
<p>Hasenauer, H; Monserud, R and T. Gregoire. (1998)
Using Simultansous Regression Techniques with Individual-Tree Growth Models.
<em>Forest Science</em>. 44(1):87-95
</p>
<p>Kmenta, J. (1997)
<em>Elements of Econometrics, Second Edition</em>, University of
Michigan Publishing
</p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
inst &lt;- ~ income + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform 2SLS on each of the equations in the system
fit2sls &lt;- systemfit( system, "2SLS", inst = inst, data = Kmenta )
print( fit2sls )
print( fit2sls$rcov )

## perform the 3SLS
fit3sls &lt;- systemfit( system, "3SLS", inst = inst, data = Kmenta )
print( fit3sls )
print( "covariance of residuals used for estimation (from 2sls)" )
print( fit3sls$rcovest )
print( "covariance of residuals" )
print( fit3sls$rcov )

## examine the correlation between the predicted values
## of suppy and demand by plotting the correlation over
## the value of q
r12 &lt;- correlation.systemfit( fit3sls, 1, 2 )
plot( Kmenta$consump, r12, main="correlation between predictions from supply and demand" )
</code></pre>

<hr>
<h2 id='createSystemfitModel'>Create a Model for systemfit</h2><span id='topic+createSystemfitModel'></span>

<h3>Description</h3>

<p>This function creates a model that can be estimated by <code>systemfit</code>.
The data, disturbances, and &mdash; if not provided by the user &mdash;
the coefficients as well as the disturbance covariance matrix
are generated by random numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createSystemfitModel( nEq, nRegEq, nObs, coef = NULL, sigma = NULL )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createSystemfitModel_+3A_neq">nEq</code></td>
<td>
<p>the number of equations.</p>
</td></tr>
<tr><td><code id="createSystemfitModel_+3A_nregeq">nRegEq</code></td>
<td>
<p>the number of regressors in each equation
(without the intercept).</p>
</td></tr>
<tr><td><code id="createSystemfitModel_+3A_nobs">nObs</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code id="createSystemfitModel_+3A_coef">coef</code></td>
<td>
<p>an optional vector of coefficients.</p>
</td></tr>
<tr><td><code id="createSystemfitModel_+3A_sigma">sigma</code></td>
<td>
<p>an optional covariance matrix of the disturbance terms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>createSystemfitModel</code> returns a list with following elements:
</p>
<table>
<tr><td><code>formula</code></td>
<td>
<p>a list of the model equations
(objects of class <code>formula</code>).</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a <code>data.frame</code> that contains the data.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>a vector of (true) coefficients.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>the covariance matrix of the disturbance terms.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## create a model by random numbers
systemfitModel &lt;- createSystemfitModel( 3, 4, 100 )

## estimate this model by "SUR"
fitsur &lt;- systemfit( systemfitModel$formula, "SUR", data = systemfitModel$data )

## compare the "true" and the estimated coefficients
cbind( systemfitModel$coef, coef( fitsur ) )
</code></pre>

<hr>
<h2 id='estfun.systemfit'>Extract Gradients of the Objective Function at each Observation</h2><span id='topic+estfun.systemfit'></span>

<h3>Description</h3>

<p>Extract the gradients of the objective function 
with respect to the coefficients 
evaluated at each observation 
(&lsquo;Empirical Estimating Function&rsquo;, 
see <code><a href="sandwich.html#topic+estfun">estfun</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'systemfit'
estfun( x, residFit = TRUE, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estfun.systemfit_+3A_x">x</code></td>
<td>
<p>an object of class <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="estfun.systemfit_+3A_residfit">residFit</code></td>
<td>
<p>logical. 
If <code>FALSE</code>, the residuals are calculated based on observed regressors.
If <code>TRUE</code>, the residuals are calculated based on fitted regressors.
This argument is ignored if no instrumental variable are used.</p>
</td></tr>
<tr><td><code id="estfun.systemfit_+3A_...">...</code></td>
<td>
<p>further arguments (currently ignored).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of gradients of the objective function
with respect to the coefficients
evaluated at each observation.
</p>


<h3>Warnings</h3>

<p>The <span class="pkg">sandwich</span> package must be loaded before this method
can be used.
</p>
<p>In specific estimations with the 3SLS method,
not all columns of the matrix returned by the <code>estfun</code> method
sum up to zero,
which indicates that an inappropriate estimating function is returned.
This can be either with argument <code>residFit</code> set to <code>TRUE</code> 
or with this argument set to <code>FALSE</code>
or even in both cases.
This problem depends on the formula used for the 3SLS estimation
and seems to be related to unbalanced systems and
systems where different instruments are used in different equations.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen
</p>


<h3>See Also</h3>

<p><code><a href="sandwich.html#topic+estfun">estfun</a></code>, <code><a href="#topic+systemfit">systemfit</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )
inst &lt;- ~ income + farmPrice + trend

## OLS estimation
fitols &lt;- systemfit( system, "OLS", data = Kmenta )

## obtain the estimation function
library( "sandwich" )
estfun( fitols )

## this is only true for OLS models
all.equal( estfun( fitols ),
   unlist( residuals( fitols ) ) * model.matrix( fitols ) )

# each column should sum up to (approximately) zero
colSums( estfun( fitols ) )


## 2SLS estimation
fit2sls &lt;- systemfit( system, "2SLS", inst = inst, data = Kmenta )

## obtain the estimation function
estfun( fit2sls )

## this is only true for 2SLS models
all.equal( estfun( fit2sls ),
   drop( rep( Kmenta$consump, 2 ) -  model.matrix( fit2sls, which = "xHat" ) %*% 
   coef( fit2sls ) ) * model.matrix( fit2sls, which = "xHat" ) )
all.equal( estfun( fit2sls, residFit = FALSE ),
   unlist( residuals( fit2sls ) ) * model.matrix( fit2sls, which = "xHat" ) )

# each column should sum up to (approximately) zero
colSums( estfun( fit2sls ) )
colSums( estfun( fit2sls, residFit = FALSE ) )


## iterated SUR estimation
fitsur &lt;- systemfit( system, "SUR", data = Kmenta, maxit = 100 )

## obtain the estimation function
estfun( fitsur )

## this should be true for SUR and WLS models
all.equal( estfun( fitsur ),
   unlist( residuals( fitsur ) ) * 
   ( ( solve( fitsur$residCovEst ) %x% diag( nrow( Kmenta ) ) ) %*% 
      model.matrix( fitsur ) ), check.attributes = FALSE )

# each column should sum up to (approximately) zero
colSums( estfun( fitsur ) )


## 3SLS estimation
fit3sls &lt;- systemfit( system, "3SLS", inst = inst, data = Kmenta )

## obtain the estimation function
estfun( fit3sls )
estfun( fit3sls, residFit = FALSE )

## this should be true for 3SLS and W2SLS models
all.equal( estfun( fit3sls ),
   drop( rep( Kmenta$consump, 2 ) -  
   model.matrix( fit2sls, which = "xHat" ) %*% coef( fit3sls ) ) * 
   ( ( solve( fit3sls$residCovEst ) %x% diag( nrow( Kmenta ) ) ) %*% 
      model.matrix( fit3sls, which = "xHat" ) ), check.attributes = FALSE )
all.equal( estfun( fit3sls, residFit = FALSE ),
   unlist( residuals( fit3sls ) ) * 
   ( ( solve( fit3sls$residCovEst ) %x% diag( nrow( Kmenta ) ) ) %*% 
      model.matrix( fit3sls, which = "xHat" ) ), check.attributes = FALSE )

# each column should sum up to (approximately) zero
colSums( estfun( fit3sls ) )
colSums( estfun( fit3sls, residFit = FALSE ) )
</code></pre>

<hr>
<h2 id='fitted.systemfit'>Fitted values</h2><span id='topic+fitted.systemfit'></span><span id='topic+fitted.systemfit.equation'></span>

<h3>Description</h3>

<p>These functions extract the fitted values
from an object returned by <code><a href="#topic+systemfit">systemfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
fitted( object, ... )

   ## S3 method for class 'systemfit.equation'
fitted( object, na.rm = FALSE, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.systemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>systemfit</code> or
<code>systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="fitted.systemfit_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether <code>NA</code> values
(corresponding to observations that were not included in the estimation)
should be removed from the vector of fitted values
before it is returned.</p>
</td></tr>
<tr><td><code id="fitted.systemfit_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>fitted.systemfit</code> returns a data.frame of all fitted values,
where each column contains the fitted values of one equation.
</p>
<p><code>fitted.systemfit.equation</code> returns a vector of the fitted values
of a single equation.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS on each of the equations in the system
fitols &lt;- systemfit( system, data = Kmenta )

## all fitted values
fitted( fitols )

## fitted values of the first equation
fitted( fitols$eq[[1]] )

## fitted values of the second equation
fitted( fitols$eq[[2]] )
</code></pre>

<hr>
<h2 id='formula.systemfit'>Model Formulae of systemfit Objects</h2><span id='topic+formula.systemfit'></span><span id='topic+formula.systemfit.equation'></span>

<h3>Description</h3>

<p>This method extracts the model formulae
from fitted objects returned by <code><a href="#topic+systemfit">systemfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
formula( x, ... )
   ## S3 method for class 'systemfit.equation'
formula( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula.systemfit_+3A_x">x</code></td>
<td>
<p>an object of class <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="formula.systemfit_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>formula.systemfit.equation</code> returns the formula
of a single equation of a <code>systemfit</code> object.
<code>formula.systemfit.equation</code> returns a list of formulae:
one formula object for each equation
of the <code>systemfit</code> object.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+formula">formula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform a SUR estimation
fitsur &lt;- systemfit( system, "SUR", data = Kmenta )

## formula of the second equation
formula( fitsur$eq[[2]] )

## all formulae of the system
formula( fitsur )
</code></pre>

<hr>
<h2 id='GrunfeldGreene'>Grunfeld Data as published by Greene (2003)</h2><span id='topic+GrunfeldGreene'></span>

<h3>Description</h3>

<p>Panel data on 5 US firms for the years 1935-1954.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   data("GrunfeldGreene")
</code></pre>


<h3>Format</h3>

<p>A data frame containing 20 annual observations on 3 variables for 5 firms.
</p>

<dl>
<dt>invest</dt><dd><p>gross investment.</p>
</dd>
<dt>value</dt><dd><p>market value of the firm (at the end of the previous year).</p>
</dd>
<dt>capital</dt><dd><p>capital stock of the firm (at the end of the previous year).</p>
</dd>
<dt>firm</dt><dd><p>name of the firm (&quot;General Motors&quot;, &quot;Chrysler&quot;,
&quot;General Electric&quot;, &quot;Westinghouse&quot; or &quot;US Steel&quot;).</p>
</dd>
<dt>year</dt><dd><p>year.</p>
</dd>
</dl>



<h3>Details</h3>

<p>There exist several different versions of this data set,
and this version is considered incorrect
(see <a href="https://web.archive.org/web/20170426034143/http://web.stanford.edu/~clint/bench/grunfeld.htm">https://web.archive.org/web/20170426034143/http://web.stanford.edu/~clint/bench/grunfeld.htm</a> for details).
However, we provide this incorrect version to replicate the results
published in Theil (1971) and Greene (2003).
A correct version of this data set with 5 additional firms
is available in the <code>Ecdat</code> package
(data set <code>Grunfeld</code>).
</p>


<h3>Source</h3>

<p>Greene (2003), Appendix F, Data Sets Used in Applications, Table F13.1.
<a href="https://pages.stern.nyu.edu/~wgreene/Text/econometricanalysis.htm">https://pages.stern.nyu.edu/~wgreene/Text/econometricanalysis.htm</a>
(a subset of this data set is available in Theil (1971), p. 296).
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Prentice Hall,
Upper Saddle River (NJ).
</p>
<p>Grunfeld, Y. (1958). <em>The Determinants of Corporate Investment</em>,
Unpublished Ph.D. Dissertation, University of Chicago.
</p>
<p>Theil, Henri (1971). <em>Principles of Econometrics</em>,
John Wiley &amp; Sons, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Repeating the OLS and SUR estimations in Greene (2003, pp. 351)
data( "GrunfeldGreene" )
if( requireNamespace( 'plm', quietly = TRUE ) ) {
library( "plm" )
GGPanel &lt;- pdata.frame( GrunfeldGreene, c( "firm", "year" ) )
formulaGrunfeld &lt;- invest ~ value + capital
# OLS
greeneOls &lt;- systemfit( formulaGrunfeld, "OLS",
   data = GGPanel )
summary( greeneOls )
sapply( greeneOls$eq, function(x){return(summary(x)$ssr/20)} ) # sigma^2
# OLS Pooled
greeneOlsPooled &lt;- systemfit( formulaGrunfeld, "OLS",
   data = GGPanel, pooled = TRUE )
summary( greeneOlsPooled )
sum( sapply( greeneOlsPooled$eq, function(x){return(summary(x)$ssr)}) )/97 # sigma^2
# SUR
greeneSur &lt;- systemfit( formulaGrunfeld, "SUR",
   data = GGPanel, methodResidCov = "noDfCor" )
summary( greeneSur )
# SUR Pooled
greeneSurPooled &lt;- systemfit( formulaGrunfeld, "SUR",
   data = GGPanel, pooled = TRUE, methodResidCov = "noDfCor",
   residCovWeighted = TRUE )
summary( greeneSurPooled )

## Repeating the OLS and SUR estimations in Theil (1971, pp. 295, 300)
GrunfeldTheil &lt;- subset( GrunfeldGreene,
   firm %in% c( "General Electric", "Westinghouse" ) )
GTPanel &lt;- pdata.frame( GrunfeldTheil, c( "firm", "year" ) )
formulaGrunfeld &lt;- invest ~ value + capital
# OLS
theilOls &lt;- systemfit( formulaGrunfeld, "OLS",
   data = GTPanel )
summary( theilOls )
# SUR
theilSur &lt;- systemfit( formulaGrunfeld, "SUR",
   data = GTPanel, methodResidCov = "noDfCor" )
summary( theilSur )
}
</code></pre>

<hr>
<h2 id='hausman.systemfit'>Hausman Test</h2><span id='topic+hausman.systemfit'></span>

<h3>Description</h3>

<p><code>hausman.systemfit</code> returns the Hausman statistic for a specification test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   hausman.systemfit( results2sls, results3sls )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hausman.systemfit_+3A_results2sls">results2sls</code></td>
<td>
<p>result of a <em>2SLS</em> (limited information) estimation
returned by <code><a href="#topic+systemfit">systemfit</a></code>.</p>
</td></tr>
<tr><td><code id="hausman.systemfit_+3A_results3sls">results3sls</code></td>
<td>
<p>result of a <em>3SLS</em> (full information) estimation
returned by <code><a href="#topic+systemfit">systemfit</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypotheses of the test is that all exogenous variables are
uncorrelated with all disturbance terms.
Under this hypothesis both the 2SLS and the 3SLS estimator are consistent
but only the 3SLS estimator is (asymptotically) efficient.
Under the alternative hypothesis the 2SLS estimator is consistent
but the 3SLS estimator is inconsistent.
</p>
<p>The Hausman test statistic is
</p>
<p style="text-align: center;"><code class="reqn">m = ( b_2 - b_3 )' ( V_2 - V_3 ) ( b_2 - b_3 ) </code>
</p>

<p>where $b_2$ and $V_2$ are the estimated coefficients and their variance
covariance matrix of a <em>2SLS</em> estimation and
$b_3$ and $V_3$ are the estimated coefficients and their variance
covariance matrix of a <em>3SLS</em> estimation.
</p>


<h3>Value</h3>

<p><code>hausman.systemfit</code> returns a list of the class
<code>htest</code> that contains following elements:
</p>
<table>
<tr><td><code>q</code></td>
<td>
<p>vector of the differences between the estimated coefficients.</p>
</td></tr>
<tr><td><code>qVar</code></td>
<td>
<p>variance covariance matrix of <code>q</code> (difference between the
variance covariance matrices of the estimated coefficients).</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>the Hausman test statistic.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>P-value of the test.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string describing this test.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>name of the data.frame used for estimation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff D. Hamann <a href="mailto:jeff.hamann@forestinformatics.com">jeff.hamann@forestinformatics.com</a>,<br />
Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Greene, W. H. (1993)
<em>Econometric Analysis, Fifth Edition</em>, Macmillan.
</p>
<p>Hausman, J. A. (1978)
Specification Tests in Econometrics. <em>Econometrica</em>. 46:1251-1271.
</p>
<p>Kmenta, J. (1997)
<em>Elements of Econometrics, Second Edition</em>, University of
Michigan Publishing
</p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
inst &lt;- ~ income + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform the estimations
fit2sls &lt;- systemfit( system, "2SLS", inst = inst, data = Kmenta )
fit3sls &lt;- systemfit( system, "3SLS", inst = inst, data = Kmenta )

## perform the Hausman test
h &lt;- hausman.systemfit( fit2sls, fit3sls )
print( h )
</code></pre>

<hr>
<h2 id='KleinI'>Klein Model I</h2><span id='topic+KleinI'></span>

<h3>Description</h3>

<p>Data for Klein's (1950) Model I of the US economy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("KleinI")</code></pre>


<h3>Format</h3>

<p>A data frame containing annual observations from 1920 to 1941
</p>

<dl>
<dt>year</dt><dd><p>Year.</p>
</dd>
<dt>consump</dt><dd><p>Consumption.</p>
</dd>
<dt>corpProf</dt><dd><p>Corporate profits.</p>
</dd>
<dt>corpProfLag</dt><dd><p>Corporate profits of the previous year.</p>
</dd>
<dt>privWage</dt><dd><p>Private wage bill.</p>
</dd>
<dt>invest</dt><dd><p>Investment.</p>
</dd>
<dt>capitalLag</dt><dd><p>Capital stock of the previous year.</p>
</dd>
<dt>gnp</dt><dd><p>Gross national product.</p>
</dd>
<dt>gnpLag</dt><dd><p>Gross national product of the previous year.</p>
</dd>
<dt>govWage</dt><dd><p>Government wage bill.</p>
</dd>
<dt>govExp</dt><dd><p>Government spending.</p>
</dd>
<dt>taxes</dt><dd><p>Taxes.</p>
</dd>
<dt>wages</dt><dd><p>Sum of private and government wage bill.</p>
</dd>
<dt>trend</dt><dd><p>time trend measured as years from 1931.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Greene (2003), Appendix F, Data Sets Used in Applications, Table F15.1.
</p>
<p><a href="https://pages.stern.nyu.edu/~wgreene/Text/econometricanalysis.htm">https://pages.stern.nyu.edu/~wgreene/Text/econometricanalysis.htm</a>
</p>


<h3>References</h3>

<p>Greene, W.H. (2003). <em>Econometric Analysis</em>, 5th edition. Prentice Hall,
Upper Saddle River (NJ).
</p>
<p>Klein, L. (1950). <em>Economic Fluctuations in the United States, 1921&ndash;1941</em>.
John Wiley, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Repeating the estimations of Klein's (1950) Model I
## in Greene (2003, pp. 381 and 412)
data( "KleinI" )
eqConsump  &lt;- consump ~ corpProf + corpProfLag + wages
eqInvest   &lt;- invest ~ corpProf + corpProfLag + capitalLag
eqPrivWage &lt;- privWage ~ gnp + gnpLag + trend
inst &lt;- ~ govExp + taxes + govWage + trend + capitalLag + corpProfLag + gnpLag
system &lt;- list( Consumption = eqConsump, Investment = eqInvest,
   PrivateWages = eqPrivWage )
# OLS
kleinOls &lt;- systemfit( system, data = KleinI )
summary( kleinOls )
# 2SLS
klein2sls &lt;- systemfit( system, "2SLS", inst = inst, data = KleinI,
   methodResidCov = "noDfCor" )
summary( klein2sls )
# 3SLS
klein3sls &lt;- systemfit( system, "3SLS", inst = inst, data = KleinI,
   methodResidCov = "noDfCor" )
summary( klein3sls )
# I3SLS
kleinI3sls &lt;- systemfit( system, "3SLS", inst = inst, data = KleinI,
   methodResidCov = "noDfCor", maxit = 500 )
summary( kleinI3sls )
</code></pre>

<hr>
<h2 id='Kmenta'>Partly Artificial Data on the U. S. Economy</h2><span id='topic+Kmenta'></span>

<h3>Description</h3>

<p>These are partly contrived data from Kmenta (1986), constructed
to illustrate estimation of a simultaneous-equation model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   data("Kmenta")
</code></pre>


<h3>Format</h3>

<p>This data frame contains 20 annual observations of 5 variables:
</p>

<dl>
<dt>consump</dt><dd><p>food consumption per capita.</p>
</dd>
<dt>price</dt><dd><p>ratio of food prices to general consumer prices.</p>
</dd>
<dt>income</dt><dd><p>disposable income in constant dollars.</p>
</dd>
<dt>farmPrice</dt><dd><p>ratio of preceding year's prices received by farmers
to general consumer prices.</p>
</dd>
<dt>trend</dt><dd><p>time trend in years.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The exogenous variables <code>income</code>, <code>farmPrice</code>,
and <code>trend</code> are based on real data;
the endogenous variables <code>price</code> and <code>consump</code>
were generated by simulation.
</p>


<h3>Source</h3>

<p>Kmenta (1986), Table 13-1, p. 687.
</p>


<h3>References</h3>

<p>Kmenta, J. (1986). <em>Elements of Econometrics</em>, Second Edition,
Macmillan, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Replicating the estimations in Kmenta (1986), p. 712, Tab 13-2
data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
inst &lt;- ~ income + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## OLS estimation
fitOls &lt;- systemfit( system, data = Kmenta )
summary( fitOls )

## 2SLS estimation
fit2sls &lt;- systemfit( system, "2SLS", inst = inst, data = Kmenta )
summary( fit2sls )

## 3SLS estimation
fit3sls &lt;- systemfit( system, "3SLS", inst = inst, data = Kmenta )
summary( fit3sls )

## I3LS estimation
fitI3sls &lt;- systemfit( system, "3SLS", inst = inst, data = Kmenta,
   maxit = 250 )
summary( fitI3sls )
</code></pre>

<hr>
<h2 id='linearHypothesis.systemfit'>Test Linear Hypothesis</h2><span id='topic+linearHypothesis.systemfit'></span>

<h3>Description</h3>

<p>Testing linear hypothesis on the coefficients of a system of equations
by an F-test or Wald-test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
linearHypothesis( model,
      hypothesis.matrix, rhs = NULL, test = c( "FT", "F", "Chisq" ),
      vcov. = NULL, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linearHypothesis.systemfit_+3A_model">model</code></td>
<td>
<p>a fitted object of type <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="linearHypothesis.systemfit_+3A_hypothesis.matrix">hypothesis.matrix</code></td>
<td>
<p>matrix (or vector) giving linear combinations
of coefficients by rows,
or a character vector giving the hypothesis in symbolic form
(see documentation of <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>
in package &quot;car&quot; for details).</p>
</td></tr>
<tr><td><code id="linearHypothesis.systemfit_+3A_rhs">rhs</code></td>
<td>
<p>optional right-hand-side vector for hypothesis,
with as many entries as rows in the hypothesis matrix;
if omitted, it defaults to a vector of zeroes.</p>
</td></tr>
<tr><td><code id="linearHypothesis.systemfit_+3A_test">test</code></td>
<td>
<p>character string, &quot;<code>FT</code>&quot;, &quot;<code>F</code>&quot;, or &quot;<code>Chisq</code>&quot;,
specifying whether to compute
Theil's finite-sample F test (with approximate F distribution),
the finite-sample Wald test (with approximate F distribution),
or the large-sample Wald test
(with asymptotic Chi-squared distribution).</p>
</td></tr>
<tr><td><code id="linearHypothesis.systemfit_+3A_vcov.">vcov.</code></td>
<td>
<p>a function for estimating the covariance matrix
of the regression coefficients or an estimated covariance matrix
(function <code>vcov</code> is used by default).</p>
</td></tr>
<tr><td><code id="linearHypothesis.systemfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to
<code><a href="car.html#topic+linearHypothesis.default">linearHypothesis.default</a></code> (package &quot;car&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Theil's <code class="reqn">F</code> statistic for sytems of equations is
</p>
<p style="text-align: center;"><code class="reqn">F = \frac{
      ( R \hat{b} - q )'
      ( R ( X' ( \Sigma \otimes I )^{-1} X )^{-1} R' )^{-1}
      ( R \hat{b} - q ) /
      j
   }{
      \hat{e}' ( \Sigma \otimes I )^{-1} \hat{e} /
      ( M \cdot T - K )
   } </code>
</p>

<p>where <code class="reqn">j</code> is the number of restrictions,
<code class="reqn">M</code> is the number of equations,
<code class="reqn">T</code> is the number of observations per equation,
<code class="reqn">K</code> is the total number of estimated coefficients, and
<code class="reqn">\Sigma</code> is the estimated residual covariance matrix.
Under the null hypothesis, <code class="reqn">F</code> has an approximate <code class="reqn">F</code> distribution
with <code class="reqn">j</code> and <code class="reqn">M \cdot T - K</code> degrees of freedom
(Theil, 1971, p. 314).
</p>
<p>The <code class="reqn">F</code> statistic for a Wald test is
</p>
<p style="text-align: center;"><code class="reqn"> F = \frac{
      ( R \hat{b} - q )'
      ( R \, \widehat{Cov} [ \hat{b} ] R' )^{-1}
      ( R \hat{b} - q )
   }{
      j
   } </code>
</p>

<p>Under the null hypothesis, <code class="reqn">F</code> has an approximate <code class="reqn">F</code> distribution
with <code class="reqn">j</code> and <code class="reqn">M \cdot T - K</code> degrees of freedom
(Greene, 2003, p. 346).
</p>
<p>The <code class="reqn">\chi^2</code> statistic for a Wald test is
</p>
<p style="text-align: center;"><code class="reqn"> W =
      ( R \hat{b} - q )'
      ( R \widehat{Cov} [ \hat{b} ] R' )^{-1}
      ( R \hat{b} - q )
   </code>
</p>

<p>Asymptotically, <code class="reqn">W</code> has a <code class="reqn">\chi^2</code>
distribution with <code class="reqn">j</code> degrees of freedom
under the null hypothesis
(Greene, 2003, p. 347).
</p>


<h3>Value</h3>

<p>An object of class <code>anova</code>,
which contains the residual degrees of freedom in the model,
the difference in degrees of freedom,
the test statistic (either F or Wald/Chisq)
and the corresponding p value.
See documentation of <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>
in package &quot;car&quot;.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>References</h3>

<p>Greene, W. H. (2003)
<em>Econometric Analysis, Fifth Edition</em>, Prentice Hall.
</p>
<p>Theil, Henri (1971)
<em>Principles of Econometrics</em>, John Wiley &amp; Sons, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>
(package &quot;car&quot;),
<code><a href="#topic+lrtest.systemfit">lrtest.systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## unconstrained SUR estimation
fitsur &lt;- systemfit( system, method = "SUR", data=Kmenta )

# create hypothesis matrix to test whether beta_2 = \beta_6
R1 &lt;- matrix( 0, nrow = 1, ncol = 7 )
R1[ 1, 2 ] &lt;- 1
R1[ 1, 6 ] &lt;- -1
# the same hypothesis in symbolic form
restrict1 &lt;- "demand_price - supply_farmPrice = 0"

## perform Theil's F test
linearHypothesis( fitsur, R1 )  # rejected
linearHypothesis( fitsur, restrict1 )

## perform Wald test with F statistic
linearHypothesis( fitsur, R1, test = "F" )  # rejected
linearHypothesis( fitsur, restrict1 )

## perform Wald-test with chi^2 statistic
linearHypothesis( fitsur, R1, test = "Chisq" )  # rejected
linearHypothesis( fitsur, restrict1, test = "Chisq" )

# create hypothesis matrix to test whether beta_2 = - \beta_6
R2 &lt;- matrix( 0, nrow = 1, ncol = 7 )
R2[ 1, 2 ] &lt;- 1
R2[ 1, 6 ] &lt;- 1
# the same hypothesis in symbolic form
restrict2 &lt;- "demand_price + supply_farmPrice = 0"

## perform Theil's F test
linearHypothesis( fitsur, R2 )  # accepted
linearHypothesis( fitsur, restrict2 )

## perform Wald test with F statistic
linearHypothesis( fitsur, R2, test = "F" )  # accepted
linearHypothesis( fitsur, restrict2 )

## perform Wald-test with chi^2 statistic
linearHypothesis( fitsur, R2, test = "Chisq" )  # accepted
linearHypothesis( fitsur, restrict2, test = "Chisq" )
</code></pre>

<hr>
<h2 id='logLik.systemfit'>Log-Likelihood value of systemfit object</h2><span id='topic+logLik.systemfit'></span>

<h3>Description</h3>

<p>This method calculates the log-likelihood value
of a fitted object returned by <code><a href="#topic+systemfit">systemfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
logLik( object, residCovDiag = FALSE, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.systemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="logLik.systemfit_+3A_residcovdiag">residCovDiag</code></td>
<td>
<p>logical.
If this argument is set to <code>TRUE</code>,
the residual covaraince matrix
that is used for calculating the log-likelihood value
is assumed to be diagonal,
i.e. all covariances are set to zero.
This may be desirable for models
estimated by OLS, 2SLS, WLS, and W2SLS.</p>
</td></tr>
<tr><td><code id="logLik.systemfit_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The residual covariance matrix
that is used for calculating the log-likelihood value 
is calculated based on the actually obtained (final) residuals
(not correcting for degrees of freedom).
In case of systems of equations with unequal numbers of observations,
the calculation of the residual covariance matrix
is only based on the residuals/observations
that are available in all equations.
</p>


<h3>Value</h3>

<p>A numeric scalar (the log-likelihood value) with 2 attributes:
<code>nobs</code> (total number of observations in all equations) and
<code>df</code> (number of free parameters, i.e. coefficients
+ elements of the residual covariance matrix).
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+logLik">logLik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform a SUR estimation
fitsur &lt;- systemfit( system, "SUR", data = Kmenta )

## residuals of all equations
logLik( fitsur )
</code></pre>

<hr>
<h2 id='lrtest.systemfit'>Likelihood Ratio test for Equation Systems</h2><span id='topic+lrtest.systemfit'></span>

<h3>Description</h3>

<p>Testing linear hypothesis on the coefficients of a system of equations
by a Likelihood Ratio test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
lrtest( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrtest.systemfit_+3A_object">object</code></td>
<td>
<p>a fitted model object of class <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="lrtest.systemfit_+3A_...">...</code></td>
<td>
<p>further fitted model objects of class <code>systemfit</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lrtest.systemfit</code> consecutively compares
the fitted model object <code>object</code>
with the models passed in <code>...</code>.
</p>
<p>The LR-statistic for sytems of equations is
</p>
<p style="text-align: center;"><code class="reqn">
   LR = T \cdot \left(
      log \left| \hat{ \hat{ \Sigma } }_r \right|
      - log \left| \hat{ \hat{ \Sigma } }_u \right|
      \right)
   </code>
</p>

<p>where <code class="reqn">T</code> is the number of observations per equation, and
<code class="reqn">\hat{\hat{\Sigma}}_r</code> and <code class="reqn">\hat{\hat{\Sigma}}_u</code> are
the residual covariance matrices calculated by formula &quot;0&quot;
(see <code><a href="#topic+systemfit">systemfit</a></code>)
of the restricted and unrestricted estimation, respectively.
Asymptotically, <code class="reqn">LR</code> has a <code class="reqn">\chi^2</code>
distribution with <code class="reqn">j</code> degrees of freedom
under the null hypothesis
(Green, 2003, p. 349).
</p>


<h3>Value</h3>

<p>An object of class <code>anova</code>,
which contains the log-likelihood value,
degrees of freedom, the difference in degrees of freedom,
likelihood ratio Chi-squared statistic and corresponding p value.
See documentation of <code><a href="lmtest.html#topic+lrtest">lrtest</a></code>
in package &quot;lmtest&quot;.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>References</h3>

<p>Greene, W. H. (2003)
<em>Econometric Analysis, Fifth Edition</em>, Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="lmtest.html#topic+lrtest">lrtest</a></code>
(package &quot;lmtest&quot;),
<code><a href="#topic+linearHypothesis.systemfit">linearHypothesis.systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## unconstrained SUR estimation
fitsur &lt;- systemfit( system, "SUR", data = Kmenta )

# create restriction matrix to impose \eqn{beta_2 = \beta_6}
R1 &lt;- matrix( 0, nrow = 1, ncol = 7 )
R1[ 1, 2 ] &lt;- 1
R1[ 1, 6 ] &lt;- -1

## constrained SUR estimation
fitsur1 &lt;- systemfit( system, "SUR", data = Kmenta, restrict.matrix = R1 )

## perform LR-test
lrTest1 &lt;- lrtest( fitsur1, fitsur )
print( lrTest1 )   # rejected

# create restriction matrix to impose \eqn{beta_2 = - \beta_6}
R2 &lt;- matrix( 0, nrow = 1, ncol = 7 )
R2[ 1, 2 ] &lt;- 1
R2[ 1, 6 ] &lt;- 1

## constrained SUR estimation
fitsur2 &lt;- systemfit( system, "SUR", data = Kmenta, restrict.matrix = R2 )

## perform LR-test
lrTest2 &lt;- lrtest( fitsur2, fitsur )
print( lrTest2 )   # accepted
</code></pre>

<hr>
<h2 id='model.frame.systemfit'>Extracting the Data of a systemfit Object</h2><span id='topic+model.frame.systemfit'></span><span id='topic+model.frame.systemfit.equation'></span>

<h3>Description</h3>

<p>These functions return the data used by <code><a href="#topic+systemfit">systemfit</a></code>
to estimate a system of equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
model.frame( formula, ... )

   ## S3 method for class 'systemfit.equation'
model.frame( formula, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.frame.systemfit_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>systemfit</code> or
<code>systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="model.frame.systemfit_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>model.frame.systemfit</code> returns a simple data frame
(without a 'terms' attribute) that contains all variables
used to estimate the entire system of equations.
</p>
<p><code>model.frame.systemfit.equation</code> returns a model frame
(data frame with a 'terms' attribute) that contains
all variables used to estimate the respective equation.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+model.frame">model.frame</a></code>, and
<code><a href="#topic+model.matrix.systemfit">model.matrix.systemfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS of the system
fitols &lt;- systemfit( system, data = Kmenta )

## data used to estimate the entire system
model.frame( fitols )

## data used to estimate the first equation
model.frame( fitols$eq[[ 1 ]] )
</code></pre>

<hr>
<h2 id='model.matrix.systemfit'>Construct Design Matrices for Systems of Equations</h2><span id='topic+model.matrix.systemfit'></span><span id='topic+model.matrix.systemfit.equation'></span>

<h3>Description</h3>

<p>These functions create design matrices from objects
returned by <code><a href="#topic+systemfit">systemfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
model.matrix( object, which = "x", ... )

   ## S3 method for class 'systemfit.equation'
model.matrix( object, which = "x", ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.systemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>systemfit</code> or
<code>systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="model.matrix.systemfit_+3A_which">which</code></td>
<td>
<p>character string: 
<code>"x"</code> indicates the usual model matrix of the regressors,
<code>"xHat"</code> indicates the model matrix of the fitted regressors,
<code>"z"</code> indicates the matrix of instrumental variables.</p>
</td></tr>
<tr><td><code id="model.matrix.systemfit_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>model.matrix.systemfit</code> returns a design matrix to estimate
the specified system of equations.
</p>
<p><code>model.matrix.systemfit.equation</code> returns a design matrix to estimate
the specified formula of the respective equation.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>, and
<code><a href="#topic+model.frame.systemfit">model.frame.systemfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS of the system
fitols &lt;- systemfit( system, data = Kmenta )

## design matrix of the entire system
model.matrix( fitols )

## design matrix of the first equation
model.matrix( fitols$eq[[ 1 ]] )
</code></pre>

<hr>
<h2 id='nlsystemfit'>Nonlinear Equation System Estimation</h2><span id='topic+nlsystemfit'></span>

<h3>Description</h3>

<p>Fits a set of structural nonlinear equations using Ordinary Least
Squares (OLS), Seemingly Unrelated Regression (SUR),
Two-Stage Least Squares (2SLS), Three-Stage Least Squares (3SLS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'> nlsystemfit( method="OLS", eqns, startvals,
                     eqnlabels=c(as.character(1:length(eqns))), inst=NULL,
                     data=list(), solvtol=.Machine$double.eps,
                     maxiter=1000, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlsystemfit_+3A_method">method</code></td>
<td>
<p>the estimation method, one of &quot;OLS&quot;, &quot;SUR&quot;, &quot;2SLS&quot;,
&quot;3SLS&quot;.</p>
</td></tr>
<tr><td><code id="nlsystemfit_+3A_eqns">eqns</code></td>
<td>
<p>a list of structural equations to be estimated.</p>
</td></tr>
<tr><td><code id="nlsystemfit_+3A_startvals">startvals</code></td>
<td>
<p>a list of starting values for the coefficients.</p>
</td></tr>
<tr><td><code id="nlsystemfit_+3A_eqnlabels">eqnlabels</code></td>
<td>
<p>an optional list of character vectors of names
for the equation labels.</p>
</td></tr>
<tr><td><code id="nlsystemfit_+3A_inst">inst</code></td>
<td>
<p>one-sided model formula specifying instrumental variables
or a list of one-sided model formulas if different instruments should
be used for the different equations (only needed for 2SLS, 3SLS and
GMM estimations).</p>
</td></tr>
<tr><td><code id="nlsystemfit_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment from which
nlsystemfit is called.</p>
</td></tr>
<tr><td><code id="nlsystemfit_+3A_solvtol">solvtol</code></td>
<td>
<p>tolerance for detecting linear dependencies in the columns
of X in the <code><a href="Matrix.html#topic+qr">qr</a></code> function calls.</p>
</td></tr>
<tr><td><code id="nlsystemfit_+3A_maxiter">maxiter</code></td>
<td>
<p>the maximum number of iterations for the <code><a href="stats.html#topic+nlm">nlm</a></code> function.</p>
</td></tr>
<tr><td><code id="nlsystemfit_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The nlsystemfit function relies on <code><a href="stats.html#topic+nlm">nlm</a></code> to perform the
minimization of the objective functions and the <code><a href="Matrix.html#topic+qr">qr</a></code> set
of functions.
</p>
<p>A system of nonlinear equations can be written as:
</p>
<p style="text-align: center;"><code class="reqn">\epsilon_{t} = q( y_t, x_t, \theta )</code>
</p>

<p style="text-align: center;"><code class="reqn">z_{t} = Z( x_t )</code>
</p>

<p>where <code class="reqn">\epsilon_{t}</code> are the residuals from the y observations and
the function evaluated at the coefficient estimates.
</p>
<p>The objective functions for the methods are:
</p>

<table>
<tr>
 <td style="text-align: left;">
    
    Method </td><td style="text-align: center;"> Instruments </td><td style="text-align: center;"> Objective Function </td><td style="text-align: center;"> Covariance of
    <code class="reqn">\theta</code></td>
</tr>
<tr>
 <td style="text-align: left;"> 
    OLS </td><td style="text-align: center;"> no </td><td style="text-align: center;"> <code class="reqn">r'r</code> </td><td style="text-align: center;"> <code class="reqn">(X(diag(S)^{-1}\bigotimes
      I)X)^{-1}</code></td>
</tr>
<tr>
 <td style="text-align: left;"> 
    SUR </td><td style="text-align: center;"> no </td><td style="text-align: center;"> <code class="reqn">r'(diag(S)_{OLS}^{-1}\bigotimes I)r</code> </td><td style="text-align: center;">
    <code class="reqn">(X(S^{-1}\bigotimes I)X)^{-1}</code></td>
</tr>
<tr>
 <td style="text-align: left;"> 
    2SLS </td><td style="text-align: center;"> yes </td><td style="text-align: center;"> <code class="reqn">r'(I \bigotimes W)r</code> </td><td style="text-align: center;">
    <code class="reqn">(X(diag(S)^{-1}\bigotimes I)X)^{-1}</code></td>
</tr>
<tr>
 <td style="text-align: left;"> 
    3SLS </td><td style="text-align: center;"> yes </td><td style="text-align: center;"> <code class="reqn">r'(S_{2SLS}^{-1} \bigotimes W)r</code> </td><td style="text-align: center;">
    <code class="reqn">(X(diag(S)^{-1}\bigotimes W)X)^{-1}</code> 
  </td>
</tr>

</table>

<p>where, r is a column vector for the residuals for each equation, S is
variance-covariance matrix between the equations
(<code class="reqn">\hat{\sigma}_{ij} = (\hat{e}_i' \hat{e}_j) /
    \sqrt{(T - k_i)*(T - k_j)}</code>), X is matrix of the
partial derivates with respect to the coefficients, W is a matrix of the
instrument variables <code class="reqn">Z(Z'Z)^{-1}Z</code>, Z is a matrix of the
instrument variables, and I is an nxn identity matrix.
</p>
<p>The SUR and 3SLS methods requires two solutions. The first solution
for the SUR is an OLS solution to obtain the variance-covariance
matrix. The 3SLS uses the variance-covatiance from a 2SLS solution,
then fits all the equations simultaneously.
</p>
<p>The user should be aware that the function is <b>VERY</b> sensative to
the starting values and the nlm function may not converge. The nlm
function will be called with the <code>typsize</code> argument set the
absolute values of the starting values for the OLS and 2SLS
methods. For the SUR and 3SLS methods, the <code>typsize</code> argument is
set to the absolute values of the resulting OLS and 2SLS coefficient
estimates from the nlm result structre. In addition, the starting
values for the SUR and 3SLS methods are obtained from the OLS and 2SLS
coefficient estimates to shorten the number of iterations. The number of
iterations reported in the summary are only those used in the last
call to nlm, thus the number of iterations in the OLS portion of the
SUR fit and the 2SLS portion of the 3SLS fit are not included.
</p>


<h3>Value</h3>

<p><code>nlsystemfit</code> returns a list of the class <code>nlsystemfit.system</code> and
contains all results that belong to the whole system.
This list contains one special object: &quot;eq&quot;. It is a list and contains
one object for each estimated equation. These objects are of the class
<code>nlsystemfit.equation</code> and contain the results that belong only to the
regarding equation.
</p>
<p>The objects of the class <code>nlsystemfit.system</code> and
<code>nlsystemfit.equation</code> have the following components (the elements of
the latter are marked with an asterisk (<code class="reqn">*</code>)):
</p>
<table>
<tr><td><code>eq</code></td>
<td>
<p>a list object that contains a list object for each equation.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>estimation method.</p>
</td></tr>
<tr><td><code>resids</code></td>
<td>
<p>an <code class="reqn">n \times g</code> matrix of the residuals.</p>
</td></tr>
<tr><td><code>g</code></td>
<td>
<p>number of equations.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>total number of observations.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>total number of coefficients.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>vector of all estimated coefficients.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>estimated standard errors of <code>b</code>.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>t values for <code>b</code>.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>p values for <code>b</code>.</p>
</td></tr>
<tr><td><code>bcov</code></td>
<td>
<p>estimated covariance matrix of <code>b</code>.</p>
</td></tr>
<tr><td><code>rcov</code></td>
<td>
<p>estimated residual covariance matrix.</p>
</td></tr>
<tr><td><code>drcov</code></td>
<td>
<p>determinant of <code>rcov</code>.</p>
</td></tr>
<tr><td><code>rcovest</code></td>
<td>
<p>residual covariance matrix used for estimation (only SUR and 3SLS).</p>
</td></tr>
<tr><td><code>rcor</code></td>
<td>
<p>estimated residual correlation matrix.</p>
</td></tr>
<tr><td><code>nlmest</code></td>
<td>
<p>results from the nlm function call</p>
</td></tr>
<tr><td><code>solvetol</code></td>
<td>
<p>tolerance level when inverting a matrix or calculating a determinant.</p>
</td></tr>
</table>
<p>## elements of the class nlsystemfit.eq
</p>
<table>
<tr><td><code>eq</code></td>
<td>
<p>a list that contains the results that belong to the individual equations.</p>
</td></tr>
<tr><td><code>eqnlabel*</code></td>
<td>
<p>the equation label of the ith equation (from the labels list).</p>
</td></tr>
<tr><td><code>formula*</code></td>
<td>
<p>model formula of the ith equation.</p>
</td></tr>
<tr><td><code>n*</code></td>
<td>
<p>number of observations of the ith equation.</p>
</td></tr>
<tr><td><code>k*</code></td>
<td>
<p>number of coefficients/regressors in the ith equation.</p>
</td></tr>
<tr><td><code>df*</code></td>
<td>
<p>degrees of freedom of the ith equation.</p>
</td></tr>
<tr><td><code>b*</code></td>
<td>
<p>estimated coefficients of the ith equation.</p>
</td></tr>
<tr><td><code>se*</code></td>
<td>
<p>estimated standard errors of <code>b</code>.</p>
</td></tr>
<tr><td><code>t*</code></td>
<td>
<p>t values for <code>b</code>.</p>
</td></tr>
<tr><td><code>p*</code></td>
<td>
<p>p values for <code>b</code>.</p>
</td></tr>
<tr><td><code>covb*</code></td>
<td>
<p>estimated covariance matrix of <code>b</code>.</p>
</td></tr>
<tr><td><code>predicted*</code></td>
<td>
<p>vector of predicted values of the ith equation.</p>
</td></tr>
<tr><td><code>residuals*</code></td>
<td>
<p>vector of residuals of the ith equation.</p>
</td></tr>
<tr><td><code>ssr*</code></td>
<td>
<p>sum of squared residuals of the ith equation.</p>
</td></tr>
<tr><td><code>mse*</code></td>
<td>
<p>estimated variance of the residuals (mean of squared errors) of the ith equation.</p>
</td></tr>
<tr><td><code>s2*</code></td>
<td>
<p>estimated variance of the residuals (<code class="reqn">\hat{\sigma}^2</code>) of the ith equation.</p>
</td></tr>
<tr><td><code>rmse*</code></td>
<td>
<p>estimated standard error of the residulas (square root of mse) of the ith equation.</p>
</td></tr>
<tr><td><code>s*</code></td>
<td>
<p>estimated standard error of the residuals (<code class="reqn">\hat{\sigma}</code>) of the ith equation.</p>
</td></tr>
<tr><td><code>r2*</code></td>
<td>
<p>R-squared (coefficient of determination).</p>
</td></tr>
<tr><td><code>adjr2*</code></td>
<td>
<p>adjusted R-squared value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff D. Hamann <a href="mailto:jeff.hamann@forestinformatics.com">jeff.hamann@forestinformatics.com</a> </p>


<h3>References</h3>

<p>Gallant, R. H. (1987)
<em>Nonlinear Equation Estimation</em>, John Wiley and Sons, 610 pp.
</p>
<p>SAS Institute (1999)
<em>SAS/ETS User's Guide, Version 8</em>, Cary NC: SAS Institute 1546 pp.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+nlm">nlm</a></code>, and <code><a href="Matrix.html#topic+qr">qr</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library( systemfit )
data( ppine )

hg.formula &lt;- hg ~ exp( h0 + h1*log(tht) + h2*tht^2 + h3*elev + h4*cr)
dg.formula &lt;- dg ~ exp( d0 + d1*log(dbh) + d2*hg + d3*cr + d4*ba  )
labels &lt;- list( "height.growth", "diameter.growth" )
inst &lt;- ~ tht + dbh + elev + cr + ba
start.values &lt;- c(h0=-0.5, h1=0.5, h2=-0.001, h3=0.0001, h4=0.08,
                  d0=-0.5, d1=0.009, d2=0.25, d3=0.005, d4=-0.02 )
model &lt;- list( hg.formula, dg.formula )

model.ols &lt;- nlsystemfit( "OLS", model, start.values, data=ppine, eqnlabels=labels )
print( model.ols )

model.sur &lt;- nlsystemfit( "SUR", model, start.values, data=ppine, eqnlabels=labels )
print( model.sur )

model.2sls &lt;- nlsystemfit( "2SLS", model, start.values, data=ppine,
   eqnlabels=labels, inst=inst )
print( model.2sls )

model.3sls &lt;- nlsystemfit( "3SLS", model, start.values, data=ppine,
                                    eqnlabels=labels, inst=inst )
print( model.3sls )
</code></pre>

<hr>
<h2 id='ppine'>Tree Growth Data for Ponderosa Pine</h2><span id='topic+ppine'></span>

<h3>Description</h3>

<p>A subset of tree growth observations from a Ponderosa pine growth database.
</p>
<p>The <code>ppine</code> data frame has 166 rows and 8 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ppine)</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>elev</dt><dd>
<p>Altitude of the plot, in feet above mean sea level.
</p>
</dd>
<dt>smi</dt><dd>
<p>Summer moisture index is the ratio of growing season heating
degree days to growing season precipitation.
</p>
</dd>
<dt>dbh</dt><dd>
<p>Diameter of the tree at breast height (4.5 feet).
</p>
</dd>
<dt>tht</dt><dd>
<p>Total stem height for the tree.
</p>
</dd>
<dt>cr</dt><dd>
<p>Crown ratio code. The scale is from 1 to 9 where a crown class of
one represents a crown ratio between 0 and 15 percent. A crown
ratio code of 2 represents a crown ratio value between 16 and
25%,...,8=76-85%, 9 &gt;=85%.
</p>
</dd>
<dt>ba</dt><dd>
<p>Plot basal area at the beginning of the growth period.
</p>
</dd>
<dt>dg</dt><dd>
<p>Five-year diameter increment.
</p>
</dd>
<dt>hg</dt><dd>
<p>Five-year height increment.
</p>
</dd>
</dl>



<h3>Details</h3>

<p>The exogenous variables are <code>elev</code>, <code>smi</code>, <code>dbh</code>,
<code>tht</code>, <code>cr</code>, and <code>ba</code>; the endogenous variables
<code>dg</code> and <code>hg</code>. There are no lagged  variables in the dataset
and the observations are for a single remeasurement.
</p>
<p>The data was provided by the USDA Forest Service Intermountain
Research Station.
</p>





<h3>Source</h3>

<p>William R. Wykoff <a href="mailto:wwykoff@fs.fed.us">wwykoff@fs.fed.us</a> <em>Rocky Mountain Research Station, 1221 South Main Street, Moscow, ID 83843</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ppine)
</code></pre>

<hr>
<h2 id='predict.systemfit'>Predictions from System Estimation</h2><span id='topic+predict.systemfit'></span><span id='topic+predict.systemfit.equation'></span>

<h3>Description</h3>

<p>Returns the predicted values, their standard errors and the
confidence limits of prediction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'systemfit'
predict( object, newdata = NULL,
                             se.fit = FALSE, se.pred = FALSE,
                             interval = "none", level=0.95,
                             useDfSys = NULL, ... )

## S3 method for class 'systemfit.equation'
predict( object, newdata = NULL,
                             se.fit = FALSE, se.pred = FALSE,
                             interval = "none", level=0.95,
                             useDfSys = NULL, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.systemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>systemfit</code> or
<code>systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="predict.systemfit_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with
which to predict.  If it is <code>NULL</code>, the fitted values are returned.</p>
</td></tr>
<tr><td><code id="predict.systemfit_+3A_se.fit">se.fit</code></td>
<td>
<p>return the standard error of the fitted values?</p>
</td></tr>
<tr><td><code id="predict.systemfit_+3A_se.pred">se.pred</code></td>
<td>
<p>return the standard error of prediction?</p>
</td></tr>
<tr><td><code id="predict.systemfit_+3A_interval">interval</code></td>
<td>
<p>Type of interval calculation (&quot;none&quot;, &quot;confidence&quot;
or &quot;prediction&quot;)</p>
</td></tr>
<tr><td><code id="predict.systemfit_+3A_level">level</code></td>
<td>
<p>Tolerance/confidence level.</p>
</td></tr>
<tr><td><code id="predict.systemfit_+3A_usedfsys">useDfSys</code></td>
<td>
<p>logical. Use the degrees of freedom of the whole system
(in place of the degrees of freedom of the single equation)
to calculate the confidence or prediction intervals.
If it not specified (<code>NULL</code>), it is set to <code>TRUE</code>
if restrictions on the coefficients are imposed and <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="predict.systemfit_+3A_...">...</code></td>
<td>
<p>additional optional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variance of the fitted values
(used to calculate the standard errors of the fitted values
and the &quot;confidence interval&quot;) is calculated by
<code class="reqn">Var[E[y^0]-\hat{y}^0]=x^0 \; Var[b] \; {x^0}'</code><br />
The variances of the predicted values
(used to calculate the standard errors of the predicted values
and the &quot;prediction intervals&quot;) is calculated by
<code class="reqn">Var[y^0-\hat{y}^0]=\hat{\sigma}^2+x^0 \; Var[b] \; {x^0}'</code>
</p>


<h3>Value</h3>

<p><code>predict.systemfit</code> returns a dataframe that
contains for each equation the predicted values
(&quot;&lt;eqnLable&gt;.pred&quot;) and if requested
the standard errors of the fitted values (&quot;&lt;eqnLable&gt;.se.fit&quot;),
the standard errors of the prediction (&quot;&lt;eqnLable&gt;.se.pred&quot;),
and the lower (&quot;&lt;eqnLable&gt;.lwr&quot;) and upper (&quot;&lt;eqnLable&gt;.upr&quot;)
limits of the confidence or prediction interval(s).
</p>
<p><code>predict.systemfit.equation</code> returns a dataframe that
contains the predicted values (&quot;fit&quot;) and if requested
the standard errors of the fitted values (&quot;se.fit&quot;),
the standard errors of the prediction (&quot;se.pred&quot;),
and the lower (&quot;lwr&quot;) and upper (&quot;upr&quot;)
limits of the confidence or prediction interval(s).
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>References</h3>

<p>Greene, W. H. (2003)
<em>Econometric Analysis, Fifth Edition</em>, Macmillan.
</p>
<p>Gujarati, D. N. (1995)
<em>Basic Econometrics, Third Edition</em>, McGraw-Hill.
</p>
<p>Kmenta, J. (1997)
<em>Elements of Econometrics, Second Edition</em>, University of
Michigan Publishing.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+predict">predict</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## OLS estimation
fitols &lt;- systemfit( system, data=Kmenta )

## predicted values and limits
predict( fitols )

## predicted values of the first equation
predict( fitols$eq[[1]] )

## predicted values of the second equation
predict( fitols$eq[[2]] )
</code></pre>

<hr>
<h2 id='print.confint.systemfit'>Print confidence intervals of coefficients</h2><span id='topic+print.confint.systemfit'></span>

<h3>Description</h3>

<p>This function prints the confidence intervals of the coefficients
of the estimated equation system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'confint.systemfit'
print( x, digits=3, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.confint.systemfit_+3A_x">x</code></td>
<td>
<p>an object of type <code>confint.systemfit</code>.</p>
</td></tr>
<tr><td><code id="print.confint.systemfit_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>
<tr><td><code id="print.confint.systemfit_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="#topic+confint.systemfit">confint.systemfit</a></code>
and  <code><a href="#topic+confint.systemfit.equation">confint.systemfit.equation</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS on each of the equations in the system
fitols &lt;- systemfit( system, data = Kmenta )

## calculate and print the confidence intervals
## of all coefficients
ci &lt;- confint( fitols )
print( ci, digits=4 )

## calculate and print the confidence intervals
## of the coefficients of the second equation
ci2 &lt;- confint( fitols$eq[[2]] )
print( ci2, digits=4 )
</code></pre>

<hr>
<h2 id='print.nlsystemfit'>Print output of nlsystemfit estimation</h2><span id='topic+print.nlsystemfit.system'></span><span id='topic+print.nlsystemfit.equation'></span>

<h3>Description</h3>

<p>These functions print a summary of the estimated equation system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'nlsystemfit.system'
print( x, digits=6, ... )

   ## S3 method for class 'nlsystemfit.equation'
print( x, digits=6, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nlsystemfit_+3A_x">x</code></td>
<td>
<p>an object of class <code>nlsystemfit.system</code> or
<code>nlsystemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="print.nlsystemfit_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>
<tr><td><code id="print.nlsystemfit_+3A_...">...</code></td>
<td>
<p>not used by user.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff D. Hamann <a href="mailto:jeff.hamann@forestinformatics.com">jeff.hamann@forestinformatics.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+nlsystemfit">nlsystemfit</a></code>, <code><a href="#topic+summary.nlsystemfit.system">summary.nlsystemfit.system</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library( systemfit )
data( ppine )

hg.formula &lt;- hg ~ exp( h0 + h1*log(tht) + h2*tht^2 + h3*elev + h4*cr)
dg.formula &lt;- dg ~ exp( d0 + d1*log(dbh) + d2*hg + d3*cr + d4*ba  )
labels &lt;- list( "height.growth", "diameter.growth" )
inst &lt;- ~ tht + dbh + elev + cr + ba
start.values &lt;- c(h0=-0.5, h1=0.5, h2=-0.001, h3=0.0001, h4=0.08,
                  d0=-0.5, d1=0.009, d2=0.25, d3=0.005, d4=-0.02 )
model &lt;- list( hg.formula, dg.formula )

model.ols &lt;- nlsystemfit( "OLS", model, start.values, data=ppine, eqnlabels=labels )
print( model.ols )

model.3sls &lt;- nlsystemfit( "3SLS", model, start.values, data=ppine,
                                    eqnlabels=labels, inst=inst )
print( model.3sls )
</code></pre>

<hr>
<h2 id='print.systemfit'>Print results of systemfit estimation</h2><span id='topic+print.systemfit'></span><span id='topic+print.systemfit.equation'></span>

<h3>Description</h3>

<p>These functions print a few results of the estimated equation system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
print( x,
      digits = max( 3, getOption("digits") - 1 ), ... )

   ## S3 method for class 'systemfit.equation'
print( x,
      digits = max( 3, getOption("digits") - 1 ), ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.systemfit_+3A_x">x</code></td>
<td>
<p>an object of class <code>systemfit</code> or <code>systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="print.systemfit_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>
<tr><td><code id="print.systemfit_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff D. Hamann <a href="mailto:jeff.hamann@forestinformatics.com">jeff.hamann@forestinformatics.com</a>,<br />
Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="#topic+summary.systemfit">summary.systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS on each of the equations in the system
fitols &lt;- systemfit( system, data = Kmenta )

## results of the whole system
print( fitols )

## results of the first equation
print( fitols$eq[[1]] )

## results of the second equation
print( fitols$eq[[2]] )
</code></pre>

<hr>
<h2 id='residuals.systemfit'>Residuals of systemfit object</h2><span id='topic+residuals.systemfit'></span><span id='topic+residuals.systemfit.equation'></span>

<h3>Description</h3>

<p>These functions extract the residuals
from an object returned by
<code><a href="#topic+systemfit">systemfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
residuals( object, ... )

   ## S3 method for class 'systemfit.equation'
residuals( object, na.rm = FALSE, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.systemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>systemfit</code> or
<code>systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="residuals.systemfit_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether <code>NA</code> values
(corresponding to observations that were not included in the estimation)
should be removed from the vector of residuals
before it is returned.</p>
</td></tr>
<tr><td><code id="residuals.systemfit_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>residuals.systemfit</code> returns a data.frame of residuals,
where each column contains the residuals of one equation.
</p>
<p><code>residuals.systemfit.equation</code> returns a vector of residuals.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS on each of the equations in the system
fitols &lt;- systemfit( system, data = Kmenta )

## residuals of all equations
residuals( fitols )

## residuals of the first equation
residuals( fitols$eq[[1]] )

## residuals of the second equation
residuals( fitols$eq[[2]] )
</code></pre>

<hr>
<h2 id='se.ratio.systemfit'>Ratio of the Standard Errors</h2><span id='topic+se.ratio.systemfit'></span>

<h3>Description</h3>

<p><code>se.ratio.systemfit</code> returns a vector of the ratios of the
standard errors of the predictions for two equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>se.ratio.systemfit( resultsi, resultsj, eqni )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="se.ratio.systemfit_+3A_resultsi">resultsi</code></td>
<td>
<p>an object of type <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="se.ratio.systemfit_+3A_resultsj">resultsj</code></td>
<td>
<p>an object of type <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="se.ratio.systemfit_+3A_eqni">eqni</code></td>
<td>
<p>index for equation to obtain the ratio of standard errors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>se.ratio</code> returns a vector of the standard errors of the ratios
for the predictions between the predicted values in equation i and
equation j.
</p>


<h3>Author(s)</h3>

<p>Jeff D. Hamann <a href="mailto:jeff.hamann@forestinformatics.com">jeff.hamann@forestinformatics.com</a></p>


<h3>References</h3>

<p>Hasenauer, H; Monserud, R and T. Gregoire. (1998)
Using Simultaneous Regression Techniques with Individual-Tree Growth Models.
<em>Forest Science</em>. 44(1):87-95
</p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code> and <code><a href="#topic+correlation.systemfit">correlation.systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
inst &lt;- ~ income + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform 2SLS on each of the equations in the system
fit2sls &lt;- systemfit( system, "2SLS", inst = inst, data = Kmenta )
fit3sls &lt;- systemfit( system, "3SLS", inst = inst, data = Kmenta )

## print the results from the fits
print( fit2sls )
print( fit3sls )
print( "covariance of residuals used for estimation (from 2sls)" )
print( fit3sls$residCovEst )
print( "covariance of residuals" )
print( fit3sls$residCov )

## examine the improvement of 3SLS over 2SLS by computing
## the ratio of the standard errors of the estimates
improve.ratio &lt;- se.ratio.systemfit( fit2sls, fit3sls, 2 )
print( "summary values for the ratio in the std. err. for the predictions" )
print( summary( improve.ratio ) )
</code></pre>

<hr>
<h2 id='summary.nlsystemfit'>Summary of nlsystemfit estimation</h2><span id='topic+summary.nlsystemfit.system'></span><span id='topic+summary.nlsystemfit.equation'></span>

<h3>Description</h3>

<p>These functions print a summary of the estimated equation system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'nlsystemfit.system'
summary( object, ... )

   ## S3 method for class 'nlsystemfit.equation'
summary( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.nlsystemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>nlsystemfit.system</code> or
<code>nlsystemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="summary.nlsystemfit_+3A_...">...</code></td>
<td>
<p>not used by user.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff D. Hamann <a href="mailto:jeff.hamann@forestinformatics.com">jeff.hamann@forestinformatics.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+nlsystemfit">nlsystemfit</a></code>, <code><a href="#topic+print.nlsystemfit.system">print.nlsystemfit.system</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library( systemfit )
data( ppine )

hg.formula &lt;- hg ~ exp( h0 + h1*log(tht) + h2*tht^2 + h3*elev + h4*cr)
dg.formula &lt;- dg ~ exp( d0 + d1*log(dbh) + d2*hg + d3*cr + d4*ba  )
labels &lt;- list( "height.growth", "diameter.growth" )
inst &lt;- ~ tht + dbh + elev + cr + ba
start.values &lt;- c(h0=-0.5, h1=0.5, h2=-0.001, h3=0.0001, h4=0.08,
                  d0=-0.5, d1=0.009, d2=0.25, d3=0.005, d4=-0.02 )
model &lt;- list( hg.formula, dg.formula )

model.ols &lt;- nlsystemfit( "OLS", model, start.values, data=ppine, eqnlabels=labels )
print( model.ols )

model.3sls &lt;- nlsystemfit( "3SLS", model, start.values, data=ppine,
                                    eqnlabels=labels, inst=inst )
print( model.3sls )
</code></pre>

<hr>
<h2 id='summary.systemfit'>Summary of systemfit estimation</h2><span id='topic+summary.systemfit'></span><span id='topic+summary.systemfit.equation'></span><span id='topic+print.summary.systemfit'></span><span id='topic+print.summary.systemfit.equation'></span>

<h3>Description</h3>

<p>These functions create and print summary results
of the estimated equation system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
summary( object, useDfSys = NULL,
      residCov = TRUE, equations = TRUE, ... )

   ## S3 method for class 'systemfit.equation'
summary( object, useDfSys = NULL, ... )

   ## S3 method for class 'summary.systemfit'
print( x,
      digits = max( 3, getOption("digits") - 1 ),
      residCov = x$printResidCov, equations = x$printEquations, ... )

   ## S3 method for class 'summary.systemfit.equation'
print( x,
      digits = max( 3, getOption("digits") - 1 ), ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.systemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>systemfit</code> or
<code>systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="summary.systemfit_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.systemfit</code> or
<code>summary.systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="summary.systemfit_+3A_usedfsys">useDfSys</code></td>
<td>
<p>logical. Use the degrees of freedom of the whole system
(in place of the degrees of freedom of the single equation)
to calculate prob values for the t-test of individual coefficients.
If it not specified (<code>NULL</code>), it is set to <code>TRUE</code>
if restrictions on the coefficients are imposed and <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="summary.systemfit_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>
<tr><td><code id="summary.systemfit_+3A_residcov">residCov</code></td>
<td>
<p>logical. If <code>TRUE</code>,
the residual correlation matrix, the residual covariance matrix,
and its determinant are printed.</p>
</td></tr>
<tr><td><code id="summary.systemfit_+3A_equations">equations</code></td>
<td>
<p>logical. If <code>TRUE</code>,
summary results of each equation are printed.
If <code>FALSE</code>, just the coefficients are printed.</p>
</td></tr>
<tr><td><code id="summary.systemfit_+3A_...">...</code></td>
<td>
<p>not used by user.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Applying <code>summary</code> on an object of class <code>systemfit</code>
returns a list of class <code>summary.systemfit</code>.
Applying <code>summary</code> on an object of class
<code>systemfit.equation</code>
returns a list of class
<code>summary.systemfit.equation</code>.
An object of class <code>summary.systemfit</code>
contains all results that belong to the whole system.
This list contains one special object: <code>eq</code>.
This is a list and contains objects of class
<code>summary.systemfit.equation</code>.
These objects contain the results that belong to each of the eatimated equations.
</p>
<p>The objects of classes <code>summary.systemfit</code> and
<code>summary.systemfit.equation</code>
have the following components
(elements that are marked with a <code class="reqn">*</code> are available only in objects of
class <code>summary.systemfit</code>;
elements that are marked with a <code class="reqn">+</code> are available only in objects of
class <code>summary.systemfit.equation</code>):
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>estimation method.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>residuals.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>a matrix with columns for the estimated coefficients,
their standard errors, t-statistic and corresponding (two-sided) p-values.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom, a 2-vector, where the first element is the number
of coefficients and the second element is the number of observations minus
the number of coefficients.</p>
</td></tr>
<tr><td><code>coefCov</code></td>
<td>
<p>estimated covariance matrix of the coefficients.</p>
</td></tr>
<tr><td><code>call*</code></td>
<td>
<p>the matched call of <code>systemfit</code>.</p>
</td></tr>
<tr><td><code>ols.r.squared*</code></td>
<td>
<p>OLS <code class="reqn">R^2</code> value of the entire system.</p>
</td></tr>
<tr><td><code>mcelroy.r.squared*</code></td>
<td>
<p>McElroy's <code class="reqn">R^2</code> value for the system.</p>
</td></tr>
<tr><td><code>iter*</code></td>
<td>
<p>number of iteration steps (only if the estimation is iterated).</p>
</td></tr>
<tr><td><code>control*</code></td>
<td>
<p>list of control parameters used for the estimation.</p>
</td></tr>
<tr><td><code>residCov*</code></td>
<td>
<p>estimated residual covariance matrix.</p>
</td></tr>
<tr><td><code>residCovEst*</code></td>
<td>
<p>residual covariance matrix used for estimation (only SUR and 3SLS).</p>
</td></tr>
<tr><td><code>residCor*</code></td>
<td>
<p>correlation matrix of the residuals.</p>
</td></tr>
<tr><td><code>detResidCov*</code></td>
<td>
<p>determinant of <code>residCov</code>.</p>
</td></tr>
<tr><td><code>eqnLabel+</code></td>
<td>
<p>equation label.</p>
</td></tr>
<tr><td><code>eqnNo+</code></td>
<td>
<p>equation number.</p>
</td></tr>
<tr><td><code>terms+</code></td>
<td>
<p>the 'terms' object used for the respective equation.</p>
</td></tr>
<tr><td><code>r.squared+</code></td>
<td>
<p><code class="reqn">R^2</code> value of the respective equation.</p>
</td></tr>
<tr><td><code>adj.r.squared+</code></td>
<td>
<p>adjusted <code class="reqn">R^2</code> value of the respective equation.</p>
</td></tr>
<tr><td><code>sigma+</code></td>
<td>
<p>estimated standard error of the residuals
of the respective equation.</p>
</td></tr>
<tr><td><code>ssr+</code></td>
<td>
<p>sum of squared residuals of the respective equation.</p>
</td></tr>
<tr><td><code>printResidCov*</code></td>
<td>
<p>argument <code>residCov</code>.</p>
</td></tr>
<tr><td><code>printEquations*</code></td>
<td>
<p>argument <code>equations</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jeff D. Hamann <a href="mailto:jeff.hamann@forestinformatics.com">jeff.hamann@forestinformatics.com</a>,<br />
Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="#topic+print.systemfit">print.systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
inst &lt;- ~ income + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS on each of the equations in the system
fitols &lt;- systemfit( system, data = Kmenta )

## results of the system
summary( fitols )

## short results of the system
summary( fitols, residCov = FALSE, equations = FALSE )

## results of the first equation
summary( fitols$eq[[1]] )

## results of the second equation
summary( fitols$eq[[2]] )
</code></pre>

<hr>
<h2 id='systemfit'>Linear Equation System Estimation</h2><span id='topic+systemfit'></span>

<h3>Description</h3>

<p>Fits a set of linear structural equations using Ordinary Least
Squares (OLS), Weighted Least Squares (WLS), Seemingly Unrelated Regression (SUR),
Two-Stage Least Squares (2SLS), Weighted Two-Stage Least Squares (W2SLS)
or Three-Stage Least Squares (3SLS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>systemfit( formula, method = "OLS",
           inst=NULL, data=list(),
           restrict.matrix = NULL, restrict.rhs = NULL, restrict.regMat = NULL,
           pooled = FALSE, control = systemfit.control( ... ), ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="systemfit_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>formula</code>
(for single-equation models)
or (typically) a list of objects of class <code>formula</code>
(for multiple-equation models);
if argument <code>data</code> is of class <code>pdata.frame</code>
(created with <code>pdata.frame()</code>),
this argument must be a single object of class <code>formula</code>
that represents the formula to be estimated for all individuals.</p>
</td></tr>
<tr><td><code id="systemfit_+3A_method">method</code></td>
<td>
<p>the estimation method, one of &quot;OLS&quot;, &quot;WLS&quot;, &quot;SUR&quot;,
&quot;2SLS&quot;, &quot;W2SLS&quot;, or &quot;3SLS&quot; (see details);
iterated estimation methods can be specified by setting control parameter
<code>maxiter</code> larger than 1 (e.g. 500).</p>
</td></tr>
<tr><td><code id="systemfit_+3A_inst">inst</code></td>
<td>
<p>one-sided model formula specifying the instrumental variables
(including exogenous explanatory variables)
or a list of one-sided model formulas if different instruments should
be used for the different equations (only needed for 2SLS, W2SLS, and
3SLS estimations).</p>
</td></tr>
<tr><td><code id="systemfit_+3A_data">data</code></td>
<td>
<p>an optional data frame
containing the variables in the model.
By default the variables are taken from the environment from which
systemfit is called.</p>
</td></tr>
<tr><td><code id="systemfit_+3A_restrict.matrix">restrict.matrix</code></td>
<td>
<p>an optional j x k matrix to impose linear
restrictions on the coefficients by <code>restrict.matrix</code> * <code class="reqn">b</code> = <code>restrict.rhs</code>
(j = number of restrictions, k = number of all coefficients,
<code class="reqn">b</code> = vector of all coefficients)
or a character vector giving the restrictions in symbolic form
(see documentation of <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>
in package &quot;car&quot; for details).
The number and the names of the coefficients can be obtained
by estimating the system without restrictions and applying
the <code>coef</code> method to the returned object.</p>
</td></tr>
<tr><td><code id="systemfit_+3A_restrict.rhs">restrict.rhs</code></td>
<td>
<p>an optional vector with j elements to impose linear
restrictions (see <code>restrict.matrix</code>); default is a vector
that contains j zeros.</p>
</td></tr>
<tr><td><code id="systemfit_+3A_restrict.regmat">restrict.regMat</code></td>
<td>
<p>an optional matrix to impose restrictions
on the coefficients by post-multiplying the regressor matrix
with this matrix (see details).</p>
</td></tr>
<tr><td><code id="systemfit_+3A_control">control</code></td>
<td>
<p>list of control parameters.
The default is constructed by the function <code><a href="#topic+systemfit.control">systemfit.control</a></code>.
See the documentation of <code><a href="#topic+systemfit.control">systemfit.control</a></code> for details.</p>
</td></tr>
<tr><td><code id="systemfit_+3A_pooled">pooled</code></td>
<td>
<p>logical, restrict coefficients to be equal in all equations
(only for panel-like data).</p>
</td></tr>
<tr><td><code id="systemfit_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="#topic+systemfit.control">systemfit.control</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation of systems of equations with unequal numbers
of observations has not been thoroughly tested yet.
Currently, <code>systemfit</code> calculates the residual covariance matrix
only from the residuals/observations that are available
in all equations.
</p>
<p>If argument <code>data</code> is of class <code>pdata.frame</code>
(created with <code>pdata.frame()</code> and thus, contains panel data in long format),
argument <code>formula</code> must be a single equation
that is applied to all individuals.
In this case, argument <code>pooled</code> specifies
whether the coefficients are restricted to be equal for all
individuals.
</p>
<p>If argument <code>restrict.regMat</code> is specified,
the regressor matrix <code class="reqn">X</code> is post-multiplied by this matrix:
<code class="reqn">X^{*} = X \cdot</code> <code>restrict.regMat</code>.
Then, this modified regressor matrix <code class="reqn">X^{*}</code> is used for the
estimation of the coefficient vector <code class="reqn">b^{*}</code>.
This means that the coefficients of the original regressors (<code class="reqn">X</code>),
vector <code class="reqn">b</code>,
can be represented by <code class="reqn">b =</code> <code>restrict.regMat</code> <code class="reqn">\cdot b^{*}</code>.
If <code>restrict.regMat</code> is a non-singular quadratic matrix,
there are no restrictions on the coefficients imposed,
but the coefficients <code class="reqn">b^{*}</code> are linear combinations of
the original coefficients <code class="reqn">b</code>.
If <code>restrict.regMat</code> has less columns than rows,
linear restrictions are imposed on the coefficients <code class="reqn">b</code>.
However, imposing linear restrictions
by the <code>restrict.regMat</code> matrix is less flexible than
by providing the matrix <code>restrict.matrix</code> and the
vector <code>restrict.rhs</code>.
The advantage of imposing restrictions on the coefficients
by the matrix <code>restrict.regMat</code> is that the matrix,
which has to be inverted during the estimation,
gets smaller by this procedure, while it gets larger
if the restrictions are imposed by <code>restrict.matrix</code> and <code>restrict.rhs</code>.
</p>
<p>In the context of multi-equation models, 
the term &ldquo;weighted&rdquo; in &ldquo;weighted least squares&rdquo; (WLS) and
&ldquo;weighted two-stage least squares&rdquo; (W2SLS) means
that the <em>equations</em> might have different weights
and <em>not</em>
that the <em>observations</em> have different weights.
</p>
<p>It is important to realize the limitations on estimating the residuals
covariance matrix imposed by the number of observations <code class="reqn">T</code>
in each equation.
With <code class="reqn">g</code> equations we estimate <code class="reqn">g*(g+1)/2</code> elements using
<code class="reqn">T*g</code> observations total.
Beck and Katz (1995,1993) discuss the issue and the resulting overconfidence
when the ratio of <code class="reqn">T/g</code> is small (e.g. 3).
Even for <code class="reqn">T/g=5</code> the estimate is unstable both numerically
and statistically
and the 95
approximately <code class="reqn">[0.5*\sigma^2, 3*\sigma^2]</code>,
which is inadequate precision if the covariance matrix will be used
for simulation of asset return paths either for investment or risk
management decisions.
For a starter on models with large cross-sections see Reichlin (2002).
[This paragraph has been provided by Stephen C. Bond &ndash; Thanks!]
</p>


<h3>Value</h3>

<p><code>systemfit</code> returns a list of the class <code>systemfit</code> and
contains all results that belong to the whole system.
This list contains one special object: &quot;eq&quot;. It is a list and contains
one object for each estimated equation. These objects are of the class
<code>systemfit.equation</code> and contain the results that belong only to the
regarding equation.
</p>
<p>The objects of the class <code>systemfit</code> and
<code>systemfit.equation</code> have the following components (the elements of
the latter are marked with an asterisk (<code class="reqn">*</code>)):
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>estimation method.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>total number of linear independent coefficients
= number of coefficients minus number of linear restrictions.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>degrees of freedom of the whole system.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>number of iteration steps.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>vector of all estimated coefficients.</p>
</td></tr>
<tr><td><code>coefCov</code></td>
<td>
<p>estimated covariance matrix of <code>coefficients</code>.</p>
</td></tr>
<tr><td><code>residCov</code></td>
<td>
<p>estimated residual covariance matrix.</p>
</td></tr>
<tr><td><code>residCovEst</code></td>
<td>
<p>residual covariance matrix used for estimation
(only WLS, W2SLS, SUR and 3SLS).</p>
</td></tr>
<tr><td><code>restrict.matrix</code></td>
<td>
<p>the restriction matrix.</p>
</td></tr>
<tr><td><code>restrict.rhs</code></td>
<td>
<p>the restriction vector.</p>
</td></tr>
<tr><td><code>restrict.regMat</code></td>
<td>
<p>matrix used to impose restrictions
on the coefficients by post-multiplying the regressor matrix
with this matrix.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>list of control parameters used for the estimation.</p>
</td></tr>
<tr><td><code>panelLike</code></td>
<td>
<p>logical. Was this an analysis with panel-like data?</p>
</td></tr>
</table>
<p>## elements of the class systemfit.eq
</p>
<table>
<tr><td><code>eq</code></td>
<td>
<p>a list that contains the results that belong to the individual equations.</p>
</td></tr>
<tr><td><code>eqnLabel*</code></td>
<td>
<p>the label of this equation.</p>
</td></tr>
<tr><td><code>eqnNo*</code></td>
<td>
<p>the number of this equation.</p>
</td></tr>
<tr><td><code>terms*</code></td>
<td>
<p>the 'terms' object used for the ith equation.</p>
</td></tr>
<tr><td><code>inst*</code></td>
<td>
<p>instruments of the ith equation (only 2SLS, W2SLS, and 3SLS).</p>
</td></tr>
<tr><td><code>termsInst*</code></td>
<td>
<p>the 'terms' object of the instruments 
used for the ith equation (only 2SLS, W2SLS, and 3SLS).</p>
</td></tr>
<tr><td><code>rank*</code></td>
<td>
<p>number of linear independent coefficients in the ith equation
(differs from the number of coefficients only if there are
restrictions that are not cross-equation).</p>
</td></tr>
<tr><td><code>nCoef.sys*</code></td>
<td>
<p>total number of coefficients in all equations.</p>
</td></tr>
<tr><td><code>rank.sys*</code></td>
<td>
<p>total number of linear independent coefficients
in all equations.</p>
</td></tr>
<tr><td><code>df.residual*</code></td>
<td>
<p>degrees of freedom of the ith equation.</p>
</td></tr>
<tr><td><code>df.residual.sys*</code></td>
<td>
<p>degrees of freedom of the whole system.</p>
</td></tr>
<tr><td><code>coefficients*</code></td>
<td>
<p>estimated coefficients of the ith equation.</p>
</td></tr>
<tr><td><code>covb*</code></td>
<td>
<p>estimated covariance matrix of <code>coefficients</code>.</p>
</td></tr>
<tr><td><code>model*</code></td>
<td>
<p>if requested (the default), the model frame of the ith equation.</p>
</td></tr>
<tr><td><code>modelInst*</code></td>
<td>
<p>if requested (the default), the model frame 
of the instrumental variables of the ith equation 
(only 2SLS, W2SLS, and 3SLS).</p>
</td></tr>
<tr><td><code>x*</code></td>
<td>
<p>if requested, the model matrix of the ith equation.</p>
</td></tr>
<tr><td><code>y*</code></td>
<td>
<p>if requested, the response of the ith equation.</p>
</td></tr>
<tr><td><code>z*</code></td>
<td>
<p>if requested, the matrix of instrumental variables
of the ith equation (only 2SLS, W2SLS, and 3SLS).</p>
</td></tr>
<tr><td><code>fitted.values*</code></td>
<td>
<p>vector of fitted values of the ith equation.</p>
</td></tr>
<tr><td><code>residuals*</code></td>
<td>
<p>vector of residuals of the ith equation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a>,<br />
Jeff D. Hamann <a href="mailto:jeff.hamann@forestinformatics.com">jeff.hamann@forestinformatics.com</a>
</p>


<h3>References</h3>

<p>Beck, N.; J.N. Katz (1995)
What to do (and not to do) with Time-Series Cross-Section Data,
<em>The American Political Science Review</em>, 89, pp. 634-647.
</p>
<p>Beck, N.; J.N. Katz; M.R. Alvarez; G. Garrett; P. Lange (1993)
Government Partisanship, Labor Organization, and Macroeconomic Performance:
a Corrigendum, <em>American Political Science Review</em>, 87,
pp. 945-48.
</p>
<p>Greene, W. H. (2003)
<em>Econometric Analysis, Fifth Edition</em>, Prentice Hall.
</p>
<p>Judge, George G.; W. E. Griffiths; R. Carter Hill; Helmut Luetkepohl and Tsoung-Chao Lee (1985)
<em>The Theory and Practice of Econometrics, Second Edition</em>, Wiley.
</p>
<p>Kmenta, J. (1997)
<em>Elements of Econometrics, Second Edition</em>, University of
Michigan Publishing.
</p>
<p>Reichlin, L. (2002)
<em>Factor models in large cross-sections of time series</em>,
Working Paper, ECARES and CEPR.
</p>
<p>Schmidt, P. (1990)
<em>Three-Stage Least Squares with different Instruments for different equations</em>,
Journal of Econometrics 43, p. 389-394.
</p>
<p>Theil, H. (1971)
<em>Principles of Econometrics</em>, Wiley, New York.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code> and <code><a href="#topic+nlsystemfit">nlsystemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## OLS estimation
fitols &lt;- systemfit( system, data=Kmenta )
print( fitols )

## OLS estimation with 2 restrictions
Rrestr &lt;- matrix(0,2,7)
Rrestr[1,3] &lt;-  1
Rrestr[1,7] &lt;- -1
Rrestr[2,2] &lt;- -1
Rrestr[2,5] &lt;-  1
qrestr &lt;- c( 0, 0.5 )
fitols2 &lt;- systemfit( system, data = Kmenta,
                      restrict.matrix = Rrestr, restrict.rhs = qrestr )
print( fitols2 )

## OLS estimation with the same 2 restrictions in symbolic form
restrict &lt;- c( "demand_income - supply_trend = 0",
   "- demand_price + supply_price = 0.5" )
fitols2b &lt;- systemfit( system, data = Kmenta, restrict.matrix = restrict )
print( fitols2b )

# test whether both restricted estimators are identical
all.equal( coef( fitols2 ), coef( fitols2b ) )

## OLS with restrictions on the coefficients by modifying the regressor matrix
## with argument restrict.regMat
modReg &lt;- matrix( 0, 7, 6 )
colnames( modReg ) &lt;- c( "demIntercept", "demPrice", "demIncome",
   "supIntercept", "supPrice2", "supTrend" )
modReg[ 1, "demIntercept" ] &lt;- 1
modReg[ 2, "demPrice" ]     &lt;- 1
modReg[ 3, "demIncome" ]    &lt;- 1
modReg[ 4, "supIntercept" ] &lt;- 1
modReg[ 5, "supPrice2" ]    &lt;- 1
modReg[ 6, "supPrice2" ]    &lt;- 1
modReg[ 7, "supTrend" ]     &lt;- 1
fitols3 &lt;- systemfit( system, data = Kmenta, restrict.regMat = modReg )
print( fitols3 )


## iterated SUR estimation
fitsur &lt;- systemfit( system, "SUR", data = Kmenta, maxit = 100 )
print( fitsur )

## 2SLS estimation
inst &lt;- ~ income + farmPrice + trend
fit2sls &lt;- systemfit( system, "2SLS", inst = inst, data = Kmenta )
print( fit2sls )

## 2SLS estimation with different instruments in each equation
inst1 &lt;- ~ income + farmPrice
inst2 &lt;- ~ income + farmPrice + trend
instlist &lt;- list( inst1, inst2 )
fit2sls2 &lt;- systemfit( system, "2SLS", inst = instlist, data = Kmenta )
print( fit2sls2 )

## 3SLS estimation with GMM-3SLS formula
inst &lt;- ~ income + farmPrice + trend
fit3sls &lt;- systemfit( system, "3SLS", inst = inst, data = Kmenta,
   method3sls = "GMM" )
print( fit3sls )


## Examples how to use systemfit() with panel-like data
## Repeating the SUR estimations in Greene (2003, p. 351)
data( "GrunfeldGreene" )
if( requireNamespace( 'plm', quietly = TRUE ) ) {
library( "plm" )
GGPanel &lt;- pdata.frame( GrunfeldGreene, c( "firm", "year" ) )
formulaGrunfeld &lt;- invest ~ value + capital
# SUR
greeneSur &lt;- systemfit( formulaGrunfeld, "SUR",
   data = GGPanel, methodResidCov = "noDfCor" )
summary( greeneSur )
# SUR Pooled
greeneSurPooled &lt;- systemfit( formulaGrunfeld, "SUR",
   data = GGPanel, pooled = TRUE, methodResidCov = "noDfCor",
   residCovWeighted = TRUE )
summary( greeneSurPooled )
}

## Further examples are in the documentation to the data sets
## 'KleinI' and 'GrunfeldGreene'.
</code></pre>

<hr>
<h2 id='systemfit-internal'>Internal systemfit functions</h2><span id='topic+knls'></span>

<h3>Description</h3>

<p>Internal systemfit functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>knls( theta, eqns, data, fitmethod="OLS", parmnames, instr=NULL, S=NULL )
</code></pre>


<h3>Details</h3>

<p>These functions are no the called by the user.
The knls is the driver function that is passed to the nlm call in
<code><a href="#topic+nlsystemfit">nlsystemfit</a></code>. 
</p>

<hr>
<h2 id='systemfit.control'>Create list of control parameters for systemfit</h2><span id='topic+systemfit.control'></span>

<h3>Description</h3>

<p>Create a list of control pararameters for function <code><a href="#topic+systemfit">systemfit</a></code>.
All control parameters that are not passed to this function
are set to default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>systemfit.control(
      maxiter = 1,
      tol = 1e-5,
      methodResidCov = "geomean",
      centerResiduals = FALSE,
      residCovRestricted = TRUE,
      residCovWeighted = FALSE,
      method3sls = "GLS",
      singleEqSigma = NULL,
      useMatrix = TRUE,
      solvetol = .Machine$double.eps,
      model = TRUE,
      x = FALSE,
      y = FALSE,
      z = FALSE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="systemfit.control_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations for WLS, SUR, W2SLS and
3SLS estimations.</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_tol">tol</code></td>
<td>
<p>tolerance level indicating when to stop the iteration (only
WLS, SUR, W2SLS and 3SLS estimations).</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_methodresidcov">methodResidCov</code></td>
<td>
<p>method for calculating the estimated residual covariance
matrix, one of &quot;noDfCor&quot;, &quot;geomean&quot;, &quot;max&quot;, or &quot;Theil&quot; (see details).</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_centerresiduals">centerResiduals</code></td>
<td>
<p>logical. Subtract the means from the residuals
of each equation before calculating the estimated residual covariance matrix.</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_residcovrestricted">residCovRestricted</code></td>
<td>
<p>logical. If 'FALSE'
the residual covariance matrix for a WLS, SUR, W2SLS, or 3SLS estimation
is obtained from an unrestricted first-step estimation.</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_residcovweighted">residCovWeighted</code></td>
<td>
<p>logical. If 'TRUE'
the residual covariance matrix for a SUR or 3SLS estimation
is obtained from a WLS or W2SLS estimation.</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_method3sls">method3sls</code></td>
<td>
<p>method for calculating the 3SLS estimator,
one of &quot;GLS&quot;, &quot;IV&quot;, &quot;GMM&quot;, &quot;Schmidt&quot;, or &quot;EViews&quot; (see details).</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_singleeqsigma">singleEqSigma</code></td>
<td>
<p>logical. use different <code class="reqn">\sigma^2</code>s for each
single equation to calculate the covariance matrix and the
standard errors of the coefficients (only OLS and 2SLS)?
If <code>singleEqSigma</code> is <code>NULL</code>, it is automatically determined:
It is set to <code>TRUE</code>, if restrictions on the coefficients are imposed,
and it is set to <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_usematrix">useMatrix</code></td>
<td>
<p>logical. Use package <code>Matrix</code> for matrix calculations?</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_solvetol">solvetol</code></td>
<td>
<p>tolerance level for detecting linear dependencies
when inverting a matrix or calculating a determinant (see
<code><a href="Matrix.html#topic+solve">solve</a></code> and <code><a href="Matrix.html#topic+det">det</a></code>).</p>
</td></tr>
<tr><td><code id="systemfit.control_+3A_model">model</code>, <code id="systemfit.control_+3A_x">x</code>, <code id="systemfit.control_+3A_y">y</code>, <code id="systemfit.control_+3A_z">z</code></td>
<td>

<p>logical. If 'TRUE' the corresponding components of the fit
(the model frame, the model matrix, the response, and
the matrix of instruments, respectively) are returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the estimation is iterated
(WLS, SUR, W2SLS or 3SLS estimation with <code>maxiter</code>&gt;1),
the convergence criterion is
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{ \frac{ \sum_i (b_{i,g} - b_{i,g-1})^2 }{ \sum_i b_{i,g-1}^2 }}
      &lt; \code{tol}</code>
</p>

<p>(<code class="reqn">b_{i,g}</code> is the ith coefficient of the gth iteration step).
</p>
<p>The method for calculating the estimated covariance matrix of the residuals
(<code class="reqn">\hat{\Sigma}</code>) can be one of the following
(see Judge et al., 1985, p. 469): <br />
if methodResidCov='noDfCor':
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = \frac{\hat{e}_i' \hat{e}_j}{T}</code>
</p>

<p>if methodResidCov='geomean':
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = \frac{\hat{e}_i' \hat{e}_j}
         {\sqrt{(T - k_i)*(T - k_j)}}</code>
</p>

<p>if methodResidCov='Theil':
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = \frac{\hat{e}_i' \hat{e}_j}{T - k_i - k_j
      + tr[X_i(X_i'X_i)^{-1}X_i'X_j(X_j'X_j)^{-1}X_j']}</code>
</p>

<p>if methodResidCov='max':
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}_{ij} = \frac{\hat{e}_i' \hat{e}_j}
         {T - \max( k_i, k_j)}</code>
</p>

<p>If <code class="reqn"> i = j</code>, the formulas 'geomean', 'Theil', and 'max' are equal.
All these three formulas yield unbiased estimators
for the diagonal elements of the residual covariance matrix.
If <code class="reqn">i \neq j</code>, only formula 'Theil' yields an unbiased estimator for the residual
covariance matrix, but it is not neccessarily positive semidefinit. Thus, it is
doubtful whether formula 'Theil' is really superior to formula 'noDfCor'
(Theil, 1971, p. 322).
</p>
<p>The methods for calculating the 3SLS estimator lead to identical results
if the same instruments are used in all equations. If different instruments
are used in the different equations, only the GMM-3SLS estimator (&quot;GMM&quot;)
and the 3SLS estimator proposed by Schmidt (1990) (&quot;Schmidt&quot;) are consistent,
whereas &quot;GMM&quot; is efficient relative to &quot;Schmidt&quot; (see Schmidt, 1990).
</p>
<p>If <code>residCovWeighted</code> is <code>TRUE</code>,
<code><a href="#topic+systemfit">systemfit</a></code> does a OLS or 2SLS estimation in a first step.
It uses the residuals from the first-step estimation
to calculate the residual covariance matrix
that is used in a second-step WLS or W2SLS estimation.
Then, it uses the residuals from the second-step estimation
to calculate the residual covariance matrix
that is used in a final SUR or 3SLS estimation.
This three-step method is the default method of command &quot;TSCS&quot;
in the software LIMDEP that carries out &quot;SUR&quot; estimations
in which all coefficient vectors are constrained to be equal
(personal information from W.H. Greene, 2006/02/16).
If no cross-equation restrictions are imposed,
<code>residCovWeighted</code> has no effect on the estimation results.
</p>


<h3>Value</h3>

<p>A list of the above components.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Judge, George G.; W. E. Griffiths; R. Carter Hill; Helmut Luetkepohl and Tsoung-Chao Lee (1985)
<em>The Theory and Practice of Econometrics, Second Edition</em>, Wiley.
</p>
<p>Schmidt, P. (1990)
<em>Three-Stage Least Squares with different Instruments for different equations</em>,
Journal of Econometrics 43, p. 389-394.
</p>
<p>Theil, H. (1971)
<em>Principles of Econometrics</em>, Wiley, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
eqSystem &lt;- list( demand = eqDemand, supply = eqSupply )

## SUR estimation: calculation of residual covariance
## matrix without correction for degrees of freedom
fitsur &lt;- systemfit( eqSystem, "SUR", data = Kmenta,
    control = systemfit.control( methodResidCov = "noDfCor" ) )
print( fitsur )
</code></pre>

<hr>
<h2 id='terms.systemfit'>Model Terms of systemfit Objects</h2><span id='topic+terms.systemfit'></span><span id='topic+terms.systemfit.equation'></span>

<h3>Description</h3>

<p>This method extracts the model terms
from fitted objects returned by <code><a href="#topic+systemfit">systemfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
terms( x, ... )
   ## S3 method for class 'systemfit.equation'
terms( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="terms.systemfit_+3A_x">x</code></td>
<td>
<p>an object of class <code>systemfit</code>.</p>
</td></tr>
<tr><td><code id="terms.systemfit_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>terms.systemfit.equation</code> returns the model terms
of a single equation of a <code>systemfit</code> object.
<code>terms.systemfit.equation</code> returns a list of model terms:
one model term object for each equation
of the <code>systemfit</code> object.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+terms">terms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform a SUR estimation
fitsur &lt;- systemfit( system, "SUR", data = Kmenta )

## model terms of the second equation
terms( fitsur$eq[[ 2 ]] )

## all model terms of the system
terms( fitsur )
</code></pre>

<hr>
<h2 id='vcov.systemfit'>Variance covariance matrix of coefficients</h2><span id='topic+vcov.systemfit'></span><span id='topic+vcov.systemfit.equation'></span>

<h3>Description</h3>

<p>These functions extract the variance covariance matrix of the
coefficients from an object returned by
<code><a href="#topic+systemfit">systemfit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   ## S3 method for class 'systemfit'
vcov( object, modified.regMat = FALSE, ... )

   ## S3 method for class 'systemfit.equation'
vcov( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.systemfit_+3A_object">object</code></td>
<td>
<p>an object of class <code>systemfit</code> or
<code>systemfit.equation</code>.</p>
</td></tr>
<tr><td><code id="vcov.systemfit_+3A_modified.regmat">modified.regMat</code></td>
<td>
<p>logical. If <code>TRUE</code>,
the covariance matrix of the coefficients of the modified regressor matrix
(original regressor matrix post-multiplied by <code>restrict.regMat</code>)
rather than the covariance matrix of the coefficients
of the original regressor matrix
is returned.</p>
</td></tr>
<tr><td><code id="vcov.systemfit_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>vcov.systemfit</code> returns the variance covariance matrix
of all estimated coefficients.
</p>


<h3>Author(s)</h3>

<p>Arne Henningsen <a href="mailto:arne.henningsen@googlemail.com">arne.henningsen@googlemail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+systemfit">systemfit</a></code>, <code><a href="stats.html#topic+vcov">vcov</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( "Kmenta" )
eqDemand &lt;- consump ~ price + income
eqSupply &lt;- consump ~ price + farmPrice + trend
system &lt;- list( demand = eqDemand, supply = eqSupply )

## perform OLS on each of the equations in the system
fitols &lt;- systemfit( system, data = Kmenta )

## variance covariance matrix of all coefficients
vcov( fitols )

## variance covariance matrix of the coefficients in the first equation
vcov( fitols$eq[[1]] )

## variance covariance matrix of the coefficients in the second equation
vcov( fitols$eq[[2]] )

## estimation with restriction by modifying the regressor matrix
modReg &lt;- matrix( 0, 7, 6 )
colnames( modReg ) &lt;- c( "demIntercept", "demPrice", "demIncome",
   "supIntercept", "supPrice2", "supTrend" )
modReg[ 1, "demIntercept" ] &lt;- 1
modReg[ 2, "demPrice" ]     &lt;- 1
modReg[ 3, "demIncome" ]    &lt;- 1
modReg[ 4, "supIntercept" ] &lt;- 1
modReg[ 5, "supPrice2" ]    &lt;- 1
modReg[ 6, "supPrice2" ]    &lt;- 1
modReg[ 7, "supTrend" ]     &lt;- 1
fitsur &lt;- systemfit( system, "SUR", data = Kmenta, restrict.regMat = modReg )
vcov( fitsur, modified.regMat  = TRUE )
vcov( fitsur )
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
