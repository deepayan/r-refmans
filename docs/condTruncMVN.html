<!DOCTYPE html><html><head><title>Help for package condTruncMVN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {condTruncMVN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#condtMVN'><p>Conditional Truncated Multivariate Normal Parameters</p></a></li>
<li><a href='#dcmvtruncnorm'><p>Density of the Conditional Truncated Multivariate Normal</p></a></li>
<li><a href='#pcmvtruncnorm'><p>CDF for the Conditional Truncated Multivariate Normal</p></a></li>
<li><a href='#rcmvtruncnorm'><p>Random Sample from Conditional Truncated Multivariate Normal</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.0.2</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Conditional Truncated Multivariate Normal Distribution</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul M. Hargarten &lt;hargartenp@vcu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes the density and probability for the conditional truncated multivariate normal (Horrace (2005) p. 4, &lt;<a href="https://doi.org/10.1016%2Fj.jmva.2004.10.007">doi:10.1016/j.jmva.2004.10.007</a>&gt;). Also draws random samples from this distribution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>condMVNorm(&ge; 2020.1), matrixNormal(&ge; 0.0.1), tmvmixnorm(&ge;
1.0.2), tmvtnorm(&ge; 1.4-10), truncnorm(&ge; 1.0-8)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>formatR, knitr, rmarkdown, roxygen2, sessioninfo, spelling,
testthat</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/phargarten2/condTruncMVN/issues">https://github.com/phargarten2/condTruncMVN/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-10 17:55:52 UTC; pablo</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul M. Hargarten [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-17 12:50:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='condtMVN'>Conditional Truncated Multivariate Normal Parameters</h2><span id='topic+condtMVN'></span>

<h3>Description</h3>

<p>Suppose that <strong>Z = (X,Y)</strong> is from a fully-joint multivariate normal distribution of dimension <em>n</em> with <code>mean</code> and covariance matrix <code>sigma</code> truncated between <code>lower</code> and <code>upper</code>. This function provides the parameters for the conditional mean and covariance matrix of <strong>Y</strong> given <strong>X</strong>. See the vignette for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>condtMVN(
  mean,
  sigma,
  lower,
  upper,
  dependent.ind,
  given.ind,
  X.given,
  init = rep(0, length(mean))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="condtMVN_+3A_mean">mean</code></td>
<td>
<p>the mean vector for Z of length of n</p>
</td></tr>
<tr><td><code id="condtMVN_+3A_sigma">sigma</code></td>
<td>
<p>the symmetric and positive-definite covariance matrix of dimension n x n of Z.</p>
</td></tr>
<tr><td><code id="condtMVN_+3A_lower">lower</code></td>
<td>
<p>a vector of lower bounds of length n that truncate Z</p>
</td></tr>
<tr><td><code id="condtMVN_+3A_upper">upper</code></td>
<td>
<p>a vector of upper bounds of length n that truncate Z</p>
</td></tr>
<tr><td><code id="condtMVN_+3A_dependent.ind">dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td></tr>
<tr><td><code id="condtMVN_+3A_given.ind">given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditioning variable X.  If specified as integer vector of length zero or left unspecified, the unconditional density is returned.</p>
</td></tr>
<tr><td><code id="condtMVN_+3A_x.given">X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. This should be of the same length as <code>given.ind</code></p>
</td></tr>
<tr><td><code id="condtMVN_+3A_init">init</code></td>
<td>
<p>initial value used for random generation of truncated multivariate normal in a Gibbs sampler. Default: A vector of zeros, equal to the number of components. For details, see tmvmixnorm::<code><a href="tmvmixnorm.html#topic+rtmvn">rtmvn</a></code>().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first four arguments are the parameters of multivariate normal and the truncation space. <code>dependent.ind, given.ind, X.given, init</code> are all arguments that determines the conditional truncated MVN.
</p>
<p>Using the full data <strong>Z</strong>, the conditional mean and conditional variance of <strong>Y|X</strong> are determined (Wang, 2006). Additionally, to reflect the reduced dimension of <strong>Y|X</strong>, the truncation limits are also adjusted.
</p>
<p>See the vignette for more information.
</p>


<h3>Value</h3>

<p>Returns a list of: </p>

<ul>
<li><p> condMean - conditional mean of <strong>Y|X</strong>
</p>
</li>
<li><p> condVar - conditional variance of <strong>Y|X</strong>
</p>
</li>
<li><p> condLower - the lower bound of <strong>Y|X</strong>
</p>
</li>
<li><p> condUpper - the upper bound of <strong>Y|X</strong>
</p>
</li>
<li><p> condInit - the initial values adjusted to match the dimension of <strong>Y|X</strong>. These are used to randomly generate the truncated multivariate normal <a href="#topic+rcmvtruncnorm">rcmvtruncnorm</a>.
</p>
</li></ul>



<h3>Note</h3>

<p>This function is based on <code><a href="condMVNorm.html#topic+condMVN">condMVN</a></code> from the <strong>condMVNorm</strong> package.
</p>


<h3>References</h3>

<p>Wang, R. 2006. Appendix A: Marginal and conditional distributions of multivariate normal distribution. <a href="http://fourier.eng.hmc.edu/e161/lectures/gaussianprocess/node7.html">http://fourier.eng.hmc.edu/e161/lectures/gaussianprocess/node7.html</a>.
</p>


<h3>See Also</h3>

<p><code><a href="condMVNorm.html#topic+cmvnorm">cmvnorm</a></code>, <code><a href="mvtnorm.html#topic+pmvnorm">pmvnorm</a></code>, <code><a href="mvtnorm.html#topic+Mvnorm">Mvnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Suppose X2,X3,X5|X2,X4 ~ N_3(1, Sigma) and truncated between -10 and 10.
d &lt;- 5
rho &lt;- 0.9
Sigma &lt;- matrix(0, nrow = d, ncol = d)
Sigma &lt;- rho^abs(row(Sigma) - col(Sigma))

# Conditional Truncated Normal Parameters
condtMVN(mean = rep(1, d),
  sigma = Sigma,
  lower = rep(-10, d),
  upper = rep(10, d),
  dependent.ind = c(2, 3, 5),
  given.ind = c(1, 4), X.given = c(1, -1)
)
</code></pre>

<hr>
<h2 id='dcmvtruncnorm'>Density of the Conditional Truncated Multivariate Normal</h2><span id='topic+dcmvtruncnorm'></span>

<h3>Description</h3>

<p>Calculates the density of truncated conditional multivariate normal Y|X: <code class="reqn">f(Y = y | X = X.given)</code>. See the vignette for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcmvtruncnorm(
  y,
  mean,
  sigma,
  lower,
  upper,
  dependent.ind,
  given.ind,
  X.given,
  log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcmvtruncnorm_+3A_y">y</code></td>
<td>
<p>vector or matrix of quantiles of Y. If a matrix, each row is taken to be a quantile. This is the quantity that the density is calculated from.</p>
</td></tr>
<tr><td><code id="dcmvtruncnorm_+3A_mean">mean</code></td>
<td>
<p>the mean vector for Z of length of n</p>
</td></tr>
<tr><td><code id="dcmvtruncnorm_+3A_sigma">sigma</code></td>
<td>
<p>the symmetric and positive-definite covariance matrix of dimension n x n of Z.</p>
</td></tr>
<tr><td><code id="dcmvtruncnorm_+3A_lower">lower</code></td>
<td>
<p>a vector of lower bounds of length n that truncate Z</p>
</td></tr>
<tr><td><code id="dcmvtruncnorm_+3A_upper">upper</code></td>
<td>
<p>a vector of upper bounds of length n that truncate Z</p>
</td></tr>
<tr><td><code id="dcmvtruncnorm_+3A_dependent.ind">dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td></tr>
<tr><td><code id="dcmvtruncnorm_+3A_given.ind">given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditioning variable X.  If specified as integer vector of length zero or left unspecified, the unconditional density is returned.</p>
</td></tr>
<tr><td><code id="dcmvtruncnorm_+3A_x.given">X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. This should be of the same length as <code>given.ind</code></p>
</td></tr>
<tr><td><code id="dcmvtruncnorm_+3A_log">log</code></td>
<td>
<p>logical; if <code>TRUE</code>, densities d are given as log(d).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Horrace, W.C. 2005. Some results on the multivariate truncated normal distribution. Journal of Multivariate Analysis, 94, 209â€“221. <a href="https://surface.syr.edu/cgi/viewcontent.cgi?article=1149&amp;context=ecn">https://surface.syr.edu/cgi/viewcontent.cgi?article=1149&amp;context=ecn</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: X2,X3,X5|X2,X4 ~ N_3(1, Sigma)
# truncated between -10 and 10.
d &lt;- 5
rho &lt;- 0.9
Sigma &lt;- matrix(0, nrow = d, ncol = d)
Sigma &lt;- rho^abs(row(Sigma) - col(Sigma))

# Log-density of 0
dcmvtruncnorm(
  rep(0, 3),
  mean = rep(1, 5),
  sigma = Sigma,
  lower = rep(-10, 5),
  upper = rep(10, d),
  dependent.ind = c(2, 3, 5),
  given.ind = c(1, 4), X.given = c(1, -1),
  log = TRUE
)
</code></pre>

<hr>
<h2 id='pcmvtruncnorm'>CDF for the Conditional Truncated Multivariate Normal</h2><span id='topic+pcmvtruncnorm'></span>

<h3>Description</h3>

<p>Computes the distribution function for  a conditional truncated multivariate normal random variate <strong>Y|X</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcmvtruncnorm(
  lowerY,
  upperY,
  mean,
  sigma,
  lower,
  upper,
  dependent.ind,
  given.ind,
  X.given,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcmvtruncnorm_+3A_lowery">lowerY</code></td>
<td>
<p>the vector of lower limits for <strong>Y|X</strong>. Passed to tmvtnorm::<code><a href="tmvtnorm.html#topic+ptmvnorm">ptmvnorm</a></code>().</p>
</td></tr>
<tr><td><code id="pcmvtruncnorm_+3A_uppery">upperY</code></td>
<td>
<p>the vector of upper limits for <strong>Y|X</strong>. Must be greater than lowerY. Passed to tmvtnorm::<code><a href="tmvtnorm.html#topic+ptmvnorm">ptmvnorm</a></code>().</p>
</td></tr>
<tr><td><code id="pcmvtruncnorm_+3A_mean">mean</code></td>
<td>
<p>the mean vector for Z of length of n</p>
</td></tr>
<tr><td><code id="pcmvtruncnorm_+3A_sigma">sigma</code></td>
<td>
<p>the symmetric and positive-definite covariance matrix of dimension n x n of Z.</p>
</td></tr>
<tr><td><code id="pcmvtruncnorm_+3A_lower">lower</code></td>
<td>
<p>a vector of lower bounds of length n that truncate Z</p>
</td></tr>
<tr><td><code id="pcmvtruncnorm_+3A_upper">upper</code></td>
<td>
<p>a vector of upper bounds of length n that truncate Z</p>
</td></tr>
<tr><td><code id="pcmvtruncnorm_+3A_dependent.ind">dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td></tr>
<tr><td><code id="pcmvtruncnorm_+3A_given.ind">given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditioning variable X.  If specified as integer vector of length zero or left unspecified, the unconditional density is returned.</p>
</td></tr>
<tr><td><code id="pcmvtruncnorm_+3A_x.given">X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. This should be of the same length as <code>given.ind</code></p>
</td></tr>
<tr><td><code id="pcmvtruncnorm_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to tmvtnorm::<code><a href="tmvtnorm.html#topic+ptmvnorm">ptmvnorm</a></code>(). The CDF is calculated using the Genz algorithm based on these arguments: maxpts, abseps, and releps.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the probability that <strong>Y|X</strong> is between <code>lowerY</code> and <code>upperY</code>. Z = (X, Y) is the fully joint multivariate normal distribution with mean equal mean and covariance matrix sigma, truncated between lower and upper.  See the vignette for more information.
</p>


<h3>Note</h3>

<p>For one-dimension conditionals <strong>Y|X</strong>, this function uses the ptruncnorm() function in the truncnorm package. Otherwise, this function uses tmvtnorm::<code><a href="tmvtnorm.html#topic+ptmvnorm">ptmvnorm</a></code>().
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Let X2,X3,X5|X2,X4 ~ N_3(1, Sigma)
# truncated between -10 and 10.
d &lt;- 5
rho &lt;- 0.9
Sigma &lt;- matrix(0, nrow = d, ncol = d)
Sigma &lt;- rho^abs(row(Sigma) - col(Sigma))

# Find P(-0.5 &lt; X2,X3,X5 &lt; 0 | X2,X4)
pcmvtruncnorm(rep(-0.5, 3), rep(0, 3),
  mean = rep(1, d),
  sigma = Sigma,
  lower = rep(-10, d),
  upper = rep(10, d),
  dependent.ind = c(2, 3, 5),
  given.ind = c(1, 4), X.given = c(1, -1)
)

# Example 2: Let X1| X2 = 1, X3 = -1, X4 = 1, X5 = -1 ~ N(1, Sigma) truncated
# between -10 and 10. Find P(-0.5 &lt; X1 &lt; 0 | X2 = 1, X3 = -1, X4 = 1, X5 = -1).
pcmvtruncnorm(-0.5, 0,
  mean = rep(1, d),
  sigma = Sigma,
  lower = rep(-10, d),
  upper = rep(10, d),
  dependent.ind = 1,
  given.ind = 2:5, X.given = c(1, -1, 1, -1)
)
</code></pre>

<hr>
<h2 id='rcmvtruncnorm'>Random Sample from Conditional Truncated Multivariate Normal</h2><span id='topic+rcmvtruncnorm'></span>

<h3>Description</h3>

<p>Randomly samples from conditional truncated multivariate normal distribution variate, <strong>Y|X</strong>, where <strong>Z = (X, Y)</strong> is the fully joint multivariate normal distribution with <code>mean</code>, covariance matrix <code>sigma</code>, and truncated between <code>lower</code> and <code>upper</code>.  See the vignette for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcmvtruncnorm(
  n,
  mean,
  sigma,
  lower,
  upper,
  dependent.ind,
  given.ind,
  X.given,
  init = rep(0, length(mean)),
  burn = 10L,
  thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rcmvtruncnorm_+3A_n">n</code></td>
<td>
<p>number of random samples desired (sample size).</p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_mean">mean</code></td>
<td>
<p>the mean vector for Z of length of n</p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_sigma">sigma</code></td>
<td>
<p>the symmetric and positive-definite covariance matrix of dimension n x n of Z.</p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_lower">lower</code></td>
<td>
<p>a vector of lower bounds of length n that truncate Z</p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_upper">upper</code></td>
<td>
<p>a vector of upper bounds of length n that truncate Z</p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_dependent.ind">dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_given.ind">given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditioning variable X.  If specified as integer vector of length zero or left unspecified, the unconditional density is returned.</p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_x.given">X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. This should be of the same length as <code>given.ind</code></p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_init">init</code></td>
<td>
<p>initial value used for random generation of truncated multivariate normal in a Gibbs sampler. Default: A vector of zeros, equal to the number of components. For details, see tmvmixnorm::<code><a href="tmvmixnorm.html#topic+rtmvn">rtmvn</a></code>().</p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_burn">burn</code></td>
<td>
<p>the burn-in, which is the number of initial iterations to be discarded. Default: 10. Passed to <code><a href="tmvmixnorm.html#topic+rtmvn">rtmvn</a></code>().</p>
</td></tr>
<tr><td><code id="rcmvtruncnorm_+3A_thin">thin</code></td>
<td>
<p>thinning lag (default as <code>1</code>).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Uses <code><a href="tmvmixnorm.html#topic+rtmvn">rtmvn</a></code> from the <strong>tmvmixnorm</strong> package to find the random variate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate 2 random numbers from X2,X3,X5|X2,X4 ~ N_3(1, Sigma)
# truncated between -10 and 10.
d &lt;- 5
rho &lt;- 0.9
Sigma &lt;- matrix(0, nrow = d, ncol = d)
Sigma &lt;- rho^abs(row(Sigma) - col(Sigma))

set.seed(2342)
rcmvtruncnorm(2,
  mean = rep(1, d),
  sigma = Sigma,
  lower = rep(-10, d),
  upper = rep(10, d),
  dependent.ind = c(2, 3, 5),
  given.ind = c(1, 4), X.given = c(1, -1)
)

# Example 2: Generate two random numbers from
# X1|X2, X3, X4, X5 ~ N(1, Sigma) truncated between -10 and 10.
set.seed(2342)
rcmvtruncnorm(2,
  mean = rep(1, d),
  sigma = Sigma,
  lower = rep(-10, d),
  upper = rep(10, d),
  dependent.ind = 1,
  given.ind = 2:5, X.given = c(1, -1, 1, -1)
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
