<!DOCTYPE html><html><head><title>Help for package RFCCA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RFCCA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#data'><p>Generated example data</p></a></li>
<li><a href='#global.significance'><p>Global significance test</p></a></li>
<li><a href='#plot.vimp.rfcca'><p>Plot variable importance measures for rfcca objects</p></a></li>
<li><a href='#predict.rfcca'><p>Predict method for rfcca objects</p></a></li>
<li><a href='#print.rfcca'><p>Print summary output of a RFCCA analysis</p></a></li>
<li><a href='#rfcca'><p>Random Forest with Canonical Correlation Analysis</p></a></li>
<li><a href='#RFCCA-package'><p>RFCCA: A package for computing canonical correlations depending on</p>
subject-related covariates with random forests</a></li>
<li><a href='#vimp.rfcca'><p>Variable importance for rfcca objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Random Forest with Canonical Correlation Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Random Forest with Canonical Correlation Analysis (RFCCA) is a 
  random forest method for estimating the canonical correlations between two 
  sets of variables depending on the subject-related covariates. The trees are 
  built with a splitting rule specifically designed to partition the data to 
  maximize the canonical correlation heterogeneity between child nodes. The 
  method is described in Alakus et al. (2021) &lt;<a href="https://doi.org/10.1093%2Fbioinformatics%2Fbtab158">doi:10.1093/bioinformatics/btab158</a>&gt;. 
  'RFCCA' uses 'randomForestSRC' package (Ishwaran and Kogalur, 2020) by 
  freezing at the version 2.9.3. The custom splitting rule feature is utilised 
  to apply the proposed splitting rule. The 'randomForestSRC' package implements 
  'OpenMP' by default, contingent upon the support provided by the target 
  architecture and operating system. In this package, 'LAPACK' and 'BLAS' 
  libraries are used for matrix decompositions.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>CCA, PMA</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/calakus/RFCCA">https://github.com/calakus/RFCCA</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/calakus/RFCCA/issues">https://github.com/calakus/RFCCA/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-06 18:11:26 UTC; cansualakus</td>
</tr>
<tr>
<td>Author:</td>
<td>Cansu Alakus [aut, cre],
  Denis Larocque [aut],
  Aurelie Labbe [aut],
  Hemant Ishwaran [ctb] (Author of included randomForestSRC codes),
  Udaya B. Kogalur [ctb] (Author of included randomForestSRC codes),
  Intel Corporation [cph] (Copyright holder of included LAPACKE codes),
  Keita Teranishi [ctb] (Author of included cblas_dgemm.c codes)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cansu Alakus &lt;cansu.alakus@hec.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-09 00:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='data'>Generated example data</h2><span id='topic+data'></span>

<h3>Description</h3>

<p>A generated data set containing three sets of variables: X, Y, Z. The
canonical correlation between X and Y depends on some of the Z variables. The
sample size is 300. Z1-Z5 are the important variables for the varying
correlation between X and Y. Z6-Z7 are the noise variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data
</code></pre>


<h3>Format</h3>

<p>A list with three elements namely X, Y, Z. Each element has 300 rows.
X has 2 columns, Y has 2 columns and Z has 7 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load generated example data
data(data, package = "RFCCA")

</code></pre>

<hr>
<h2 id='global.significance'>Global significance test</h2><span id='topic+global.significance'></span>

<h3>Description</h3>

<p>This function runs a permutation test to evaluates the global effect of
subject-related covariates (Z). Returns an estimated <em>p</em>-value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>global.significance(
  X,
  Y,
  Z,
  ntree = 200,
  mtry = NULL,
  nperm = 500,
  nodesize = NULL,
  nodedepth = NULL,
  nsplit = 10,
  Xcenter = TRUE,
  Ycenter = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="global.significance_+3A_x">X</code></td>
<td>
<p>The first multivariate data set which has <code class="reqn">n</code> observations and
<code class="reqn">px</code> variables. A data.frame of numeric values.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_y">Y</code></td>
<td>
<p>The second multivariate data set which has <code class="reqn">n</code> observations and
<code class="reqn">py</code> variables. A data.frame of numeric values.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_z">Z</code></td>
<td>
<p>The set of subject-related covariates which has <code class="reqn">n</code> observations
and <code class="reqn">pz</code> variables. Used in random forest growing. A data.frame with
numeric values and factors.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_ntree">ntree</code></td>
<td>
<p>Number of trees.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_mtry">mtry</code></td>
<td>
<p>Number of z-variables randomly selected as candidates for
splitting a node. The default is <code class="reqn">pz/3</code> where <code class="reqn">pz</code> is the number of
z variables. Values are always rounded up.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_nperm">nperm</code></td>
<td>
<p>Number of permutations.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_nodesize">nodesize</code></td>
<td>
<p>Forest average number of unique data points in a terminal
node. The default is the <code class="reqn">3 * (px+py)</code> where <code class="reqn">px</code> and <code class="reqn">py</code> are
the number of x and y variables, respectively.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_nodedepth">nodedepth</code></td>
<td>
<p>Maximum depth to which a tree should be grown. In the
default, this parameter is ignored.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_nsplit">nsplit</code></td>
<td>
<p>Non-negative integer value for the number of random splits to
consider for each candidate splitting variable. When zero or <code>NULL</code>,
all possible splits considered.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_xcenter">Xcenter</code></td>
<td>
<p>Should the columns of X be centered? The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="global.significance_+3A_ycenter">Ycenter</code></td>
<td>
<p>Should the columns of Y be centered? The default is
<code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>(rfcca,globalsignificance)</code> which is a list
with the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The original call to <code>global.significance</code>.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p><em>p</em>-value, see below for details.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size of the data (<code>NA</code>'s are omitted).</p>
</td></tr>
<tr><td><code>ntree</code></td>
<td>
<p>Number of trees grown.</p>
</td></tr>
<tr><td><code>nperm</code></td>
<td>
<p>Number of permutations.</p>
</td></tr>
<tr><td><code>mtry</code></td>
<td>
<p>Number of variables randomly selected for splitting at each
node.</p>
</td></tr>
<tr><td><code>nodesize</code></td>
<td>
<p>Minimum forest average number of unique data points in a
terminal node.</p>
</td></tr>
<tr><td><code>nodedepth</code></td>
<td>
<p>Maximum depth to which a tree is allowed to be grown.</p>
</td></tr>
<tr><td><code>nsplit</code></td>
<td>
<p>Number of randomly selected split points.</p>
</td></tr>
<tr><td><code>xvar</code></td>
<td>
<p>Data frame of x-variables.</p>
</td></tr>
<tr><td><code>xvar.names</code></td>
<td>
<p>A character vector of the x-variable names.</p>
</td></tr>
<tr><td><code>yvar</code></td>
<td>
<p>Data frame of y-variables.</p>
</td></tr>
<tr><td><code>yvar.names</code></td>
<td>
<p>A character vector of the y-variable names.</p>
</td></tr>
<tr><td><code>zvar</code></td>
<td>
<p>Data frame of z-variables.</p>
</td></tr>
<tr><td><code>zvar.names</code></td>
<td>
<p>A character vector of the z-variable names.</p>
</td></tr>
<tr><td><code>predicted.oob</code></td>
<td>
<p>OOB predicted canonical correlations for training
observations based on the selected final canonical correlation estimation
method.</p>
</td></tr>
<tr><td><code>predicted.perm</code></td>
<td>
<p>Predicted canonical correlations for the permutations.
A matrix of predictions with observations on the rows and permutations on
the columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We perform a hypothesis test to evaluate the global effect of the
subject-related covariates on distinguishing between canonical correlations.
Define the unconditional canonical correlation between <code class="reqn">X</code> and
<code class="reqn">Y</code> as <code class="reqn">\rho_{CCA}(X,Y)</code> which is found by computing CCA with
all <code class="reqn">X</code> and <code class="reqn">Y</code>, and the conditional canonical correlation between
<code class="reqn">X</code> and <code class="reqn">Y</code> given <code class="reqn">Z</code> as <code class="reqn">\rho(X,Y | Z)</code> which is found by
<code>rfcca()</code>. If there is a global effect of <code class="reqn">Z</code> on correlations
between <code class="reqn">X</code> and <code class="reqn">Y</code>, <code class="reqn">\rho(X,Y | Z)</code> should be significantly
different from <code class="reqn">\rho_{CCA}(X,Y)</code>. We conduct a permutation test
for the null hypothesis </p>
<p style="text-align: center;"><code class="reqn">H_0 : \rho(X,Y | Z) = \rho_{CCA}(X,Y)</code>
</p>

<p>We estimate a <em>p</em>-value with the permutation test. If the <em>p</em>-value is
less than the pre-specified significance level <code class="reqn">\alpha</code>, we reject the
null hypothesis.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rfcca">rfcca</a></code>
<code><a href="#topic+predict.rfcca">predict.rfcca</a></code>
<code><a href="#topic+print.rfcca">print.rfcca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load generated example data
data(data, package = "RFCCA")
set.seed(2345)

global.significance(X = data$X, Y = data$Y, Z = data$Z, ntree = 40,
  nperm = 5)


</code></pre>

<hr>
<h2 id='plot.vimp.rfcca'>Plot variable importance measures for rfcca objects</h2><span id='topic+plot.vimp.rfcca'></span><span id='topic+plot.vimp'></span>

<h3>Description</h3>

<p>Plots variable importance measures (VIMP) for subject-related z-variables for
training data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rfcca'
plot.vimp(x, sort = TRUE, ndisp = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.vimp.rfcca_+3A_x">x</code></td>
<td>
<p>An object of class (rfcca,grow) or (rfcca,predict).</p>
</td></tr>
<tr><td><code id="plot.vimp.rfcca_+3A_sort">sort</code></td>
<td>
<p>Should the z-variables be sorted according to their variable
importance measures in the plot? The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.vimp.rfcca_+3A_ndisp">ndisp</code></td>
<td>
<p>Number of z-variables to display in the plot. If <code>sort</code>=
<code>TRUE</code>, the most important <code>ndisp</code> z-variables will be plotted.
Otherwise, the first <code>ndisp</code> z-variables in the original call will be
plotted. The default value is <code>NULL</code> which will plot all of the
z-variables.</p>
</td></tr>
<tr><td><code id="plot.vimp.rfcca_+3A_...">...</code></td>
<td>
<p>Optional arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly, the variable importance measures that were plotted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vimp.rfcca">vimp.rfcca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load generated example data
data(data, package = "RFCCA")
set.seed(2345)

## train rfcca
rfcca.obj &lt;- rfcca(X = data$X, Y = data$Y, Z = data$Z, ntree = 100,
  importance = TRUE)

## plot vimp
plot.vimp(rfcca.obj)

</code></pre>

<hr>
<h2 id='predict.rfcca'>Predict method for rfcca objects</h2><span id='topic+predict.rfcca'></span>

<h3>Description</h3>

<p>Obtain predicted canonical correlations using a rfcca forest for training or
new data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rfcca'
predict(
  object,
  newdata,
  membership = FALSE,
  finalcca = c("cca", "scca", "rcca"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.rfcca_+3A_object">object</code></td>
<td>
<p>An object of class <code>(rfcca,grow)</code> created by the function
<code>rfcca</code>.</p>
</td></tr>
<tr><td><code id="predict.rfcca_+3A_newdata">newdata</code></td>
<td>
<p>Test data of the set of subject-related covariates (Z). A
data.frame with numeric values and factors. If missing, the out-of-bag
predictions in <code>object</code> is returned.</p>
</td></tr>
<tr><td><code id="predict.rfcca_+3A_membership">membership</code></td>
<td>
<p>Should terminal node membership information be returned?</p>
</td></tr>
<tr><td><code id="predict.rfcca_+3A_finalcca">finalcca</code></td>
<td>
<p>Which CCA should be used for final canonical correlation
estimation? Choices are <code>cca</code>, <code>scca</code> and <code>rcca</code>, see
<code><a href="#topic+rfcca">rfcca</a></code> for details. The default is <code>cca</code>.</p>
</td></tr>
<tr><td><code id="predict.rfcca_+3A_...">...</code></td>
<td>
<p>Optional arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>(rfcca,predict)</code> which is a list with the
following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The original grow call to <code>rfcca</code>.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size of the test data (<code>NA</code>'s are omitted). If
<code>newdata</code> is missing, sample size of the training set.</p>
</td></tr>
<tr><td><code>ntree</code></td>
<td>
<p>Number of trees grown.</p>
</td></tr>
<tr><td><code>xvar</code></td>
<td>
<p>Data frame of x-variables.</p>
</td></tr>
<tr><td><code>xvar.names</code></td>
<td>
<p>A character vector of the x-variable names.</p>
</td></tr>
<tr><td><code>yvar</code></td>
<td>
<p>Data frame of y-variables.</p>
</td></tr>
<tr><td><code>yvar.names</code></td>
<td>
<p>A character vector of the y-variable names.</p>
</td></tr>
<tr><td><code>zvar</code></td>
<td>
<p>Data frame of test z-variables. If <code>newdata</code> is missing,
data frame of training z-variables.</p>
</td></tr>
<tr><td><code>zvar.names</code></td>
<td>
<p>A character vector of the z-variable names.</p>
</td></tr>
<tr><td><code>forest</code></td>
<td>
<p>The <code>(rfcca,grow)</code> forest.</p>
</td></tr>
<tr><td><code>membership</code></td>
<td>
<p>A matrix recording terminal node membership for the test
data where each cell represents the node number that an observation falls
in for that tree.</p>
</td></tr>
<tr><td><code>predicted</code></td>
<td>
<p>Test set predicted canonical correlations based on the
selected final canonical correlation estimation method. If <code>newdata</code>
is missing, OOB predictions for training observations.</p>
</td></tr>
<tr><td><code>predicted.coef</code></td>
<td>
<p>Predicted canonical weight vectors for x- and y-
variables.</p>
</td></tr>
<tr><td><code>finalcca</code></td>
<td>
<p>The selected CCA used for final canonical correlation
estimations.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+rfcca">rfcca</a></code>
<code><a href="#topic+vimp.rfcca">vimp.rfcca</a></code>
<code><a href="#topic+print.rfcca">print.rfcca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load generated example data
data(data, package = "RFCCA")
set.seed(2345)

## define train/test split
smp &lt;- sample(1:nrow(data$X), size = round(nrow(data$X) * 0.7),
  replace = FALSE)
train.data &lt;- lapply(data, function(x) {x[smp, ]})
test.Z &lt;- data$Z[-smp, ]

## train rfcca
rfcca.obj &lt;- rfcca(X = train.data$X, Y = train.data$Y, Z = train.data$Z,
  ntree = 100)

## predict without new data (OOB predictions will be returned)
pred.obj &lt;- predict(rfcca.obj)
pred.oob &lt;- pred.obj$predicted

## predict with new test data
pred.obj2 &lt;- predict(rfcca.obj, newdata = test.Z)
pred &lt;- pred.obj2$predicted

## print predict objects
print(pred.obj)
print(pred.obj2)


</code></pre>

<hr>
<h2 id='print.rfcca'>Print summary output of a RFCCA analysis</h2><span id='topic+print.rfcca'></span>

<h3>Description</h3>

<p>Print summary output of a RFCCA analysis. This is the default print method
for the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rfcca'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rfcca_+3A_x">x</code></td>
<td>
<p>An object of class <code>(rfcca,grow)</code>, <code>(rfcca,predict)</code> or
<code>(rfcca,globalsignificance)</code>.</p>
</td></tr>
<tr><td><code id="print.rfcca_+3A_...">...</code></td>
<td>
<p>Optional arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load generated example data
data(data, package = "RFCCA")
set.seed(2345)

## train rfcca
rfcca.obj &lt;- rfcca(X = data$X, Y = data$Y, Z = data$Z, ntree = 100,
  importance = TRUE)

## print the grow object
print(rfcca.obj)

</code></pre>

<hr>
<h2 id='rfcca'>Random Forest with Canonical Correlation Analysis</h2><span id='topic+rfcca'></span>

<h3>Description</h3>

<p>Estimates the canonical correlations between two sets of variables depending
on the subject-related covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rfcca(
  X,
  Y,
  Z,
  ntree = 200,
  mtry = NULL,
  nodesize = NULL,
  nodedepth = NULL,
  nsplit = 10,
  importance = FALSE,
  finalcca = c("cca", "scca", "rcca"),
  bootstrap = TRUE,
  samptype = c("swor", "swr"),
  sampsize = if (samptype == "swor") function(x) {
     x * 0.632
 } else function(x)
    {
     x
 },
  forest = TRUE,
  membership = FALSE,
  bop = TRUE,
  Xcenter = TRUE,
  Ycenter = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rfcca_+3A_x">X</code></td>
<td>
<p>The first multivariate data set which has <code class="reqn">n</code> observations and
<code class="reqn">px</code> variables. A data.frame of numeric values.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_y">Y</code></td>
<td>
<p>The second multivariate data set which has <code class="reqn">n</code> observations and
<code class="reqn">py</code> variables. A data.frame of numeric values.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_z">Z</code></td>
<td>
<p>The set of subject-related covariates which has <code class="reqn">n</code> observations
and <code class="reqn">pz</code> variables. Used in random forest growing. A data.frame with
numeric values and factors.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_ntree">ntree</code></td>
<td>
<p>Number of trees.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_mtry">mtry</code></td>
<td>
<p>Number of z-variables randomly selected as candidates for
splitting a node. The default is <code class="reqn">pz/3</code> where <code class="reqn">pz</code> is the number of
z variables. Values are always rounded up.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_nodesize">nodesize</code></td>
<td>
<p>Forest average number of unique data points in a terminal
node. The default is the <code class="reqn">3 * (px+py)</code> where <code class="reqn">px</code> and <code class="reqn">py</code> are
the number of x and y variables, respectively.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_nodedepth">nodedepth</code></td>
<td>
<p>Maximum depth to which a tree should be grown. In the
default, this parameter is ignored.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_nsplit">nsplit</code></td>
<td>
<p>Non-negative integer value for the number of random splits to
consider for each candidate splitting variable. When zero or <code>NULL</code>,
all possible splits considered.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_importance">importance</code></td>
<td>
<p>Should variable importance of z-variables be assessed? The
default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_finalcca">finalcca</code></td>
<td>
<p>Which CCA should be used for final canonical correlation
estimation? Choices are <code>cca</code>, <code>scca</code> and <code>rcca</code>, see below
for details. The default is <code>cca</code>.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_bootstrap">bootstrap</code></td>
<td>
<p>Should the data be bootstrapped? The default value is
<code>TRUE</code> which bootstraps the data by sampling without replacement.
If <code>FALSE</code> is chosen, the data is not bootstrapped. It is not possible
to return OOB predictions and variable importance measures if <code>FALSE</code>
is chosen.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_samptype">samptype</code></td>
<td>
<p>Type of bootstrap. Choices are <code>swor</code> (sampling without
replacement/sub-sampling) and <code>swr</code> (sampling with replacement/
bootstrapping). The default action here (as in <code>randomForestSRC</code>) is
sampling without replacement.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_sampsize">sampsize</code></td>
<td>
<p>Size of sample to draw. For sampling without replacement, by
default it is .632 times the sample size. For sampling with replacement, it
is the sample size.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_forest">forest</code></td>
<td>
<p>Should the forest object be returned? It is used for prediction
on new data. The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_membership">membership</code></td>
<td>
<p>Should terminal node membership and inbag information be
returned?</p>
</td></tr>
<tr><td><code id="rfcca_+3A_bop">bop</code></td>
<td>
<p>Should the Bag of Observations for Prediction (BOP) for training
observations be returned? The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_xcenter">Xcenter</code></td>
<td>
<p>Should the columns of X be centered? The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_ycenter">Ycenter</code></td>
<td>
<p>Should the columns of Y be centered? The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="rfcca_+3A_...">...</code></td>
<td>
<p>Optional arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>(rfcca,grow)</code> which is a list with the
following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The original call to <code>rfcca</code>.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size of the data (<code>NA</code>'s are omitted).</p>
</td></tr>
<tr><td><code>ntree</code></td>
<td>
<p>Number of trees grown.</p>
</td></tr>
<tr><td><code>mtry</code></td>
<td>
<p>Number of variables randomly selected for splitting at each
node.</p>
</td></tr>
<tr><td><code>nodesize</code></td>
<td>
<p>Minimum forest average number of unique data points in a
terminal node.</p>
</td></tr>
<tr><td><code>nodedepth</code></td>
<td>
<p>Maximum depth to which a tree is allowed to be grown.</p>
</td></tr>
<tr><td><code>nsplit</code></td>
<td>
<p>Number of randomly selected split points.</p>
</td></tr>
<tr><td><code>xvar</code></td>
<td>
<p>Data frame of x-variables.</p>
</td></tr>
<tr><td><code>xvar.names</code></td>
<td>
<p>A character vector of the x-variable names.</p>
</td></tr>
<tr><td><code>yvar</code></td>
<td>
<p>Data frame of y-variables.</p>
</td></tr>
<tr><td><code>yvar.names</code></td>
<td>
<p>A character vector of the y-variable names.</p>
</td></tr>
<tr><td><code>zvar</code></td>
<td>
<p>Data frame of z-variables.</p>
</td></tr>
<tr><td><code>zvar.names</code></td>
<td>
<p>A character vector of the z-variable names.</p>
</td></tr>
<tr><td><code>leaf.count</code></td>
<td>
<p>Number of terminal nodes for each tree in the forest.
Vector of length <code>ntree</code>.</p>
</td></tr>
<tr><td><code>bootstrap</code></td>
<td>
<p>Was the data bootstrapped?</p>
</td></tr>
<tr><td><code>forest</code></td>
<td>
<p>If <code>forest=TRUE</code>, the <code>rfcca</code> forest object is
returned. This object is used for prediction with new data.</p>
</td></tr>
<tr><td><code>membership</code></td>
<td>
<p>A matrix recording terminal node membership where each
cell represents the node number that an observations falls in for that
tree.</p>
</td></tr>
<tr><td><code>importance</code></td>
<td>
<p>Variable importance measures (VIMP) for each z-variable.</p>
</td></tr>
<tr><td><code>inbag</code></td>
<td>
<p>A matrix recording inbag membership where each cell represents
whether the observation is in the bootstrap sample in the corresponding
tree.</p>
</td></tr>
<tr><td><code>predicted.oob</code></td>
<td>
<p>OOB predicted canonical correlations for training
observations based on the selected final canonical correlation estimation
method.</p>
</td></tr>
<tr><td><code>predicted.coef</code></td>
<td>
<p>Predicted canonical weight vectors for x- and y-
variables.</p>
</td></tr>
<tr><td><code>bop</code></td>
<td>
<p>If <code>bop=TRUE</code>, a list containing BOP for each training
observation is returned.</p>
</td></tr>
<tr><td><code>finalcca</code></td>
<td>
<p>The selected CCA used for final canonical correlation
estimations.</p>
</td></tr>
<tr><td><code>rfsrc.grow</code></td>
<td>
<p>An object of class <code>(rfsrc,grow)</code> is returned. This
object is used for prediction with training or new data.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><em>Final canonical correlation estimation:</em></dt><dd><p>Final canonical
correlation can be computed with CCA (Hotelling, 1936), Sparse CCA (Witten
et al., 2009) or Regularized CCA (Vinod,1976; Leurgans et al., 1993). If
Regularized CCA will be used, <code class="reqn">\lambda_1</code> and <code class="reqn">\lambda_2</code> should be
specified.</p>
</dd>
</dl>



<h3>References</h3>

<p>Hotelling, H. (1936). Relations between two sets of variates.
Biometrika, 28(3/4), 321–377.
</p>
<p>Leurgans, S. E., Moyeed, R. A., &amp; Silverman, B. W. (1993).
Canonical correlation analysis when the data are curves. Journal of the
Royal Statistical Society: Series B (Methodological), 55(3), 725-740.
</p>
<p>Vinod, H.D. (1976). Canonical ridge and econometrics of joint
production. Journal of econometrics, 4(2), 147–166.
</p>
<p>Witten, D. M., Tibshirani, R., &amp; Hastie, T. (2009). A penalized
matrix decomposition, with applications to sparse principal components and
canonical correlation analysis. Biostatistics, 10(3), 515-534.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.rfcca">predict.rfcca</a></code>
<code><a href="#topic+global.significance">global.significance</a></code>
<code><a href="#topic+vimp.rfcca">vimp.rfcca</a></code>
<code><a href="#topic+print.rfcca">print.rfcca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load generated example data
data(data, package = "RFCCA")
set.seed(2345)

## define train/test split
smp &lt;- sample(1:nrow(data$X), size = round(nrow(data$X) * 0.7),
  replace = FALSE)
train.data &lt;- lapply(data, function(x) {x[smp, ]})
test.Z &lt;- data$Z[-smp, ]

## train rfcca
rfcca.obj &lt;- rfcca(X = train.data$X, Y = train.data$Y, Z = train.data$Z,
  ntree = 100, importance = TRUE)

## print the grow object
print(rfcca.obj)

## get the OOB predictions
pred.oob &lt;- rfcca.obj$predicted.oob

## predict with new test data
pred.obj &lt;- predict(rfcca.obj, newdata = test.Z)
pred &lt;- pred.obj$predicted

## get the variable importance measures
z.vimp &lt;- rfcca.obj$importance

## train rfcca and estimate the final canonical correlations with "scca"
rfcca.obj2 &lt;- rfcca(X = train.data$X, Y = train.data$Y, Z = train.data$Z,
  ntree = 100, finalcca = "scca")


</code></pre>

<hr>
<h2 id='RFCCA-package'>RFCCA: A package for computing canonical correlations depending on
subject-related covariates with random forests</h2><span id='topic+RFCCA-package'></span>

<h3>Description</h3>

<p>RFCCA is a random forest method for estimating the canonical correlations
between two sets of variables depending on the subject-related covariates.
The trees are built with a splitting rule specifically designed to partition
the data to maximize the canonical correlation heterogeneity between child
nodes. RFCCA uses 'randomForestSRC' package (Ishwaran and Kogalur, 2020) by
freezing at the version 2.9.3. The custom splitting rule feature is utilised
to apply the proposed splitting rule. The method is described in Alakus et
al. (2021).
</p>


<h3>RFCCA functions</h3>

<p><code><a href="#topic+rfcca">rfcca</a></code>
<code><a href="#topic+predict.rfcca">predict.rfcca</a></code>
<code><a href="#topic+global.significance">global.significance</a></code>
<code><a href="#topic+vimp.rfcca">vimp.rfcca</a></code>
<code><a href="#topic+plot.vimp.rfcca">plot.vimp.rfcca</a></code>
<code><a href="#topic+print.rfcca">print.rfcca</a></code>
</p>


<h3>References</h3>

<p>Alakus, C., Larocque, D., Jacquemont, S., Barlaam, F., Martin,
C.-O., Agbogba, K., Lippe, S., and Labbe, A. (2021). Conditional canonical
correlation estimation based on covariates with random forests.
Bioinformatics, 37(17), 2714-2721.
</p>
<p>Ishwaran, H., Kogalur, U. (2020). Fast Unified Random Forests for
Survival, Regression, and Classification (RF-SRC). R package version 2.9.3,
<a href="https://cran.r-project.org/package=randomForestSRC">https://cran.r-project.org/package=randomForestSRC</a>.
</p>

<hr>
<h2 id='vimp.rfcca'>Variable importance for rfcca objects</h2><span id='topic+vimp.rfcca'></span><span id='topic+vimp'></span>

<h3>Description</h3>

<p>Calculates variable importance measures (VIMP) for subject-related
z-variables for training data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rfcca'
vimp(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vimp.rfcca_+3A_object">object</code></td>
<td>
<p>An object of class (rfcca,grow).</p>
</td></tr>
<tr><td><code id="vimp.rfcca_+3A_...">...</code></td>
<td>
<p>Optional arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>(rfcca,predict)</code> which is a list with the
following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>The original grow call to <code>rfcca</code>.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size of the data (<code>NA</code>'s are omitted).</p>
</td></tr>
<tr><td><code>ntree</code></td>
<td>
<p>Number of trees grown.</p>
</td></tr>
<tr><td><code>zvar</code></td>
<td>
<p>Data frame of z-variables.</p>
</td></tr>
<tr><td><code>zvar.names</code></td>
<td>
<p>A character vector of the z-variable names.</p>
</td></tr>
<tr><td><code>predicted.oob</code></td>
<td>
<p>OOB predicted canonical correlations for training
observations based on the selected final canonical correlation estimation
method.</p>
</td></tr>
<tr><td><code>finalcca</code></td>
<td>
<p>The selected CCA used for final canonical correlation
estimations.</p>
</td></tr>
<tr><td><code>importance</code></td>
<td>
<p>Variable importance measures (VIMP) for each z-variable.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.vimp.rfcca">plot.vimp.rfcca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load generated example data
data(data, package = "RFCCA")
set.seed(2345)

## train rfcca
rfcca.obj &lt;- rfcca(X = data$X, Y = data$Y, Z = data$Z, ntree = 100)

## get variable importance measures
vimp.obj &lt;- vimp(rfcca.obj)
vimp.z &lt;- vimp.obj$importance

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
