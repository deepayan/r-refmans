<!DOCTYPE html><html lang="en"><head><title>Help for package bfpwr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bfpwr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bf01'><p>z-test Bayes factor</p></a></li>
<li><a href='#nbf01'><p>Sample size determination for z-test Bayes factor</p></a></li>
<li><a href='#nmbf01'><p>Normal moment prior Bayes factor</p></a></li>
<li><a href='#nnmbf01'><p>Sample size determination for normal moment prior Bayes factor</p></a></li>
<li><a href='#ntbf01'><p>Sample size calculations for <code class="reqn">t</code>-test Bayes factor</p></a></li>
<li><a href='#pbf01'><p>Cumulative distribution function of the z-test Bayes factor</p></a></li>
<li><a href='#plot.power.bftest'><p>Plot method for class <code>"power.bftest"</code></p></a></li>
<li><a href='#pnmbf01'><p>Cumulative distribution function of the normal moment prior Bayes factor</p></a></li>
<li><a href='#powerbf01'><p>Power and sample size calculations for z-test Bayes factor</p></a></li>
<li><a href='#powernmbf01'><p>Power and sample size calculations for normal moment prior Bayes</p>
factor</a></li>
<li><a href='#powertbf01'><p>Power and sample size calculations for <code class="reqn">t</code>-test Bayes factor</p></a></li>
<li><a href='#print.power.bftest'><p>Print method for class <code>"power.bftest"</code></p></a></li>
<li><a href='#ptbf01'><p>Cumulative distribution function of the t-test Bayes factor</p></a></li>
<li><a href='#tbf01'><p>t-test Bayes factor</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-10-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Samuel Pawel <a href="https://orcid.org/0000-0003-2779-320X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Samuel Pawel &lt;samuel.pawel@uzh.ch&gt;</td>
</tr>
<tr>
<td>Title:</td>
<td>Power and Sample Size Calculations for Bayes Factor Analysis</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements z-test, t-test, and normal moment prior Bayes factors based on summary statistics, along with functionality to perform corresponding power and sample size calculations as described in Pawel and Held (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2406.19940">doi:10.48550/arXiv.2406.19940</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>lamW</td>
</tr>
<tr>
<td>Suggests:</td>
<td>roxygen2, tinytest, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/SamCH93/bfpwr">https://github.com/SamCH93/bfpwr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/SamCH93/bfpwr/issues">https://github.com/SamCH93/bfpwr/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-25 09:04:38 UTC; sam</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-28 12:01:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='bf01'>z-test Bayes factor</h2><span id='topic+bf01'></span>

<h3>Description</h3>

<p>This function computes the Bayes factor that quantifies the
evidence that the data (in the form of an asymptotically normally
distributed parameter estimate with standard error) provide for a point
null hypothesis with a normal prior assigned to the parameter under the
alternative. The standard error is assumed to be known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf01(estimate, se, null = 0, pm, psd, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bf01_+3A_estimate">estimate</code></td>
<td>
<p>Parameter estimate</p>
</td></tr>
<tr><td><code id="bf01_+3A_se">se</code></td>
<td>
<p>Standard error of the parameter estimate</p>
</td></tr>
<tr><td><code id="bf01_+3A_null">null</code></td>
<td>
<p>Parameter value under the point null hypothesis. Defaults to
<code>0</code></p>
</td></tr>
<tr><td><code id="bf01_+3A_pm">pm</code></td>
<td>
<p>Mean of the normal prior assigned to the parameter under the
alternative</p>
</td></tr>
<tr><td><code id="bf01_+3A_psd">psd</code></td>
<td>
<p>Standard deviation of the normal prior assigned to the parameter
under the alternative. Set to <code>0</code> to obtain a point prior at the
prior mean</p>
</td></tr>
<tr><td><code id="bf01_+3A_log">log</code></td>
<td>
<p>Logical indicating whether the natural logarithm of the Bayes
factor should be returned. Defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bayes factor in favor of the null hypothesis over the alternative (BF
&gt; 1 indicates evidence for the null hypothesis, whereas BF &lt; 1 indicates
evidence for the alternative)
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bf01(estimate = 0.2, se = 0.05, null = 0, pm = 0, psd = 2)

</code></pre>

<hr>
<h2 id='nbf01'>Sample size determination for z-test Bayes factor</h2><span id='topic+nbf01'></span>

<h3>Description</h3>

<p>This function computes the required sample size to obtain a
Bayes factor (<a href="#topic+bf01">bf01</a>) more extreme than a threshold <code>k</code> with a
specified target power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nbf01(
  k,
  power,
  usd,
  null = 0,
  pm,
  psd,
  dpm = pm,
  dpsd = psd,
  nrange = c(1, 10^5),
  lower.tail = TRUE,
  integer = TRUE,
  analytical = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nbf01_+3A_k">k</code></td>
<td>
<p>Bayes factor threshold</p>
</td></tr>
<tr><td><code id="nbf01_+3A_power">power</code></td>
<td>
<p>Target power</p>
</td></tr>
<tr><td><code id="nbf01_+3A_usd">usd</code></td>
<td>
<p>Unit standard deviation, the standard error of the parameter
estimate based on <code class="reqn">\code{n}=1</code>, see details</p>
</td></tr>
<tr><td><code id="nbf01_+3A_null">null</code></td>
<td>
<p>Parameter value under the point null hypothesis. Defaults to
<code>0</code></p>
</td></tr>
<tr><td><code id="nbf01_+3A_pm">pm</code></td>
<td>
<p>Mean of the normal prior assigned to the parameter under the
alternative in the analysis</p>
</td></tr>
<tr><td><code id="nbf01_+3A_psd">psd</code></td>
<td>
<p>Standard deviation of the normal prior assigned to the parameter
under the alternative in the analysis. Set to <code>0</code> to obtain a point
prior at the prior mean</p>
</td></tr>
<tr><td><code id="nbf01_+3A_dpm">dpm</code></td>
<td>
<p>Mean of the normal design prior assigned to the parameter.
Defaults to the same value as the analysis prior <code>pm</code></p>
</td></tr>
<tr><td><code id="nbf01_+3A_dpsd">dpsd</code></td>
<td>
<p>Standard deviation of the normal design prior assigned to the
parameter. Defaults to the same value as the analysis prior <code>psd</code></p>
</td></tr>
<tr><td><code id="nbf01_+3A_nrange">nrange</code></td>
<td>
<p>Sample size search range over which numerical search is
performed. Defaults to <code>c(1, 10^5)</code></p>
</td></tr>
<tr><td><code id="nbf01_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical indicating whether Pr(BF <code class="reqn">\leq</code> <code>k</code>)
(<code>TRUE</code>) or Pr(BF <code class="reqn">&gt;</code> <code>k</code>) (<code>FALSE</code>) should be
computed. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="nbf01_+3A_integer">integer</code></td>
<td>
<p>Logical indicating whether only integer valued sample sizes
should be returned. If <code>TRUE</code> the required sample size is rounded to
the next larger integer. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="nbf01_+3A_analytical">analytical</code></td>
<td>
<p>Logical indicating whether analytical (if available) or
numerical method should be used. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="nbf01_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>stats::uniroot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the standard error of the future parameter
estimate is of the form <code class="reqn">\code{se} =\code{usd}/\sqrt{\code{n}}</code>. For example, for normally distributed data with known
standard deviation <code>sd</code> and two equally sized groups of size
<code>n</code>, the standard error of an estimated standardized mean difference
is <code class="reqn">\code{se} = \code{sd}\sqrt{2/n}</code>, so the
corresponding unit standard deviation is <code class="reqn">\code{usd} =
    \code{sd}\sqrt{2}</code>. See the vignette for more
information.
</p>


<h3>Value</h3>

<p>The required sample size to achieve the specified power
</p>


<h3>Note</h3>

<p>A warning message will be displayed in case that the specified target
power is not achievable under the specified analysis and design priors.
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+pbf01">pbf01</a>, <a href="#topic+powerbf01">powerbf01</a>, <a href="#topic+bf01">bf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## point alternative (analytical and numerical solution available)
nbf01(k = 1/10, power = 0.9, usd = 1, null = 0, pm = 0.5, psd = 0,
      analytical = c(TRUE, FALSE), integer = FALSE)

## standardized mean difference (usd = sqrt(2), effective sample size = per group size)
nbf01(k = 1/10, power = 0.9, usd = sqrt(2), null = 0, pm = 0, psd = 1)
## this is the sample size per group (assuming equally sized groups)

## z-transformed correlation (usd = 1, effective sample size = n - 3)
nbf01(k = 1/10, power = 0.9, usd = 1, null = 0, pm = 0.2, psd = 0.5)
## have to add 3 to obtain the actual sample size

## log hazard/odds ratio (usd = 2, effective sample size = total number of events)
nbf01(k = 1/10, power = 0.9, usd = 2, null = 0, pm = 0, psd = sqrt(0.5))
## have to convert the number of events to a sample size

</code></pre>

<hr>
<h2 id='nmbf01'>Normal moment prior Bayes factor</h2><span id='topic+nmbf01'></span>

<h3>Description</h3>

<p>This function computes the Bayes factor that quantifies the
evidence that the data (in the form of an asymptotically normally
distributed parameter estimate with standard error) provide for a point
null hypothesis with a normal moment prior assigned to the parameter
under the alternative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nmbf01(estimate, se, null = 0, psd, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nmbf01_+3A_estimate">estimate</code></td>
<td>
<p>Parameter estimate</p>
</td></tr>
<tr><td><code id="nmbf01_+3A_se">se</code></td>
<td>
<p>Standard error of the parameter estimate</p>
</td></tr>
<tr><td><code id="nmbf01_+3A_null">null</code></td>
<td>
<p>Parameter value under the point null hypothesis. Defaults to
<code>0</code></p>
</td></tr>
<tr><td><code id="nmbf01_+3A_psd">psd</code></td>
<td>
<p>Spread of the normal moment prior assigned to the parameter under
the alternative. The modes of the prior are located at
<code class="reqn">\pm\sqrt{2}\,\code{psd}</code></p>
</td></tr>
<tr><td><code id="nmbf01_+3A_log">log</code></td>
<td>
<p>Logical indicating whether the natural logarithm of the Bayes
factor should be returned. Defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>A normal moment prior has density <code class="reqn">f(x \mid \code{null},
    \code{psd}) = N(x \mid \code{null}, \code{psd}^2) \times (x -
    \code{null})/ \code{psd}^2</code> with
<code class="reqn">N(x \mid m, v)</code> the normal density with mean <code class="reqn">m</code> and
variance <code class="reqn">v</code> evaluated at <code class="reqn">x</code>.
</p>


<h3>Value</h3>

<p>Bayes factor in favor of the null hypothesis over the alternative (BF
&gt; 1 indicates evidence for the null hypothesis, whereas BF &lt; 1 indicates
evidence for the alternative)
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>References</h3>

<p>Johnson, V. E. and Rossell, D. (2010). On the use of non-local
prior densities in Bayesian hypothesis tests. Journal of the Royal
Statistical Society: Series B (Statistical Methodology), 72(2):143–170.
<a href="https://doi.org/10.1111/j.1467-9868.2009.00730.x">doi:10.1111/j.1467-9868.2009.00730.x</a>
</p>
<p>Pramanik, S. and Johnson, V. E. (2024). Efficient alternatives for Bayesian
hypothesis tests in psychology. Psychological Methods, 29(2):243–261.
<a href="https://doi.org/10.1037/met0000482">doi:10.1037/met0000482</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+nmbf01">nmbf01</a>, <a href="#topic+pnmbf01">pnmbf01</a>, <a href="#topic+nnmbf01">nnmbf01</a>, <a href="#topic+powernmbf01">powernmbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nmbf01(estimate = 0.25, se = 0.05, null = 0, psd = 0.5/sqrt(2)) # mode at 0.5

</code></pre>

<hr>
<h2 id='nnmbf01'>Sample size determination for normal moment prior Bayes factor</h2><span id='topic+nnmbf01'></span>

<h3>Description</h3>

<p>This function computes the required sample size to obtain a
normal moment prior Bayes factor (<a href="#topic+nbf01">nbf01</a>) more extreme than a
threshold <code>k</code> with a specified target power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnmbf01(
  k,
  power,
  usd,
  null = 0,
  psd,
  dpm,
  dpsd,
  nrange = c(1, 10^5),
  lower.tail = TRUE,
  integer = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nnmbf01_+3A_k">k</code></td>
<td>
<p>Bayes factor threshold</p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_power">power</code></td>
<td>
<p>Target power</p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_usd">usd</code></td>
<td>
<p>Unit standard deviation, the standard error of the parameter
estimate based on <code class="reqn">\code{n}=1</code>, see details</p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_null">null</code></td>
<td>
<p>Parameter value under the point null hypothesis. Defaults to
<code>0</code></p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_psd">psd</code></td>
<td>
<p>Spread of the normal moment prior assigned to the parameter under
the alternative in the analysis. The modes of the prior are located at
<code class="reqn">\pm\sqrt{2}\,\code{psd}</code></p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_dpm">dpm</code></td>
<td>
<p>Mean of the normal design prior assigned to the parameter</p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_dpsd">dpsd</code></td>
<td>
<p>Standard deviation of the normal design prior assigned to the
parameter. Set to 0 to obtain a point prior at the design prior mean</p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_nrange">nrange</code></td>
<td>
<p>Sample size search range over which numerical search is
performed. Defaults to <code>c(1, 10^5)</code></p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical indicating whether Pr(BF <code class="reqn">\leq</code> <code>k</code>)
(<code>TRUE</code>) or Pr(BF <code class="reqn">&gt;</code> <code>k</code>) (<code>FALSE</code>) should be
computed. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_integer">integer</code></td>
<td>
<p>Logical indicating whether only integer valued sample sizes
should be returned. If <code>TRUE</code> the required sample size is rounded to
the next larger integer. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="nnmbf01_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>stats::uniroot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the standard error of the future parameter
estimate is of the form <code class="reqn">\code{se} =\code{usd}/\sqrt{\code{n}}</code>. For example, for normally distributed data with known
standard deviation <code>sd</code> and two equally sized groups of size
<code>n</code>, the standard error of an estimated standardized mean difference
is <code class="reqn">\code{se} = \code{sd}\sqrt{2/n}</code>, so the
corresponding unit standard deviation is <code class="reqn">\code{usd} =
    \code{sd}\sqrt{2}</code>. See the vignette for more
information.
</p>


<h3>Value</h3>

<p>The required sample size to achieve the specified power
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+nmbf01">nmbf01</a>, <a href="#topic+pnmbf01">pnmbf01</a>, <a href="#topic+powernmbf01">powernmbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nnmbf01(k = 1/10, power = 0.9, usd = 1, null = 0, psd = 0.5/sqrt(2), dpm = 0.5, dpsd = 0)
</code></pre>

<hr>
<h2 id='ntbf01'>Sample size calculations for <code class="reqn">t</code>-test Bayes factor</h2><span id='topic+ntbf01'></span>

<h3>Description</h3>

<p>This function computes the required sample size to obtain a
<code class="reqn">t</code>-test Bayes factor (<a href="#topic+tbf01">tbf01</a>) more extreme than a threshold
<code>k</code> with a specified target power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ntbf01(
  k,
  power,
  null = 0,
  plocation = 0,
  pscale = 1/sqrt(2),
  pdf = 1,
  type = c("two.sample", "one.sample", "paired"),
  alternative = c("two.sided", "less", "greater"),
  dpm = plocation,
  dpsd = pscale,
  lower.tail = TRUE,
  integer = TRUE,
  nrange = c(2, 10^4),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ntbf01_+3A_k">k</code></td>
<td>
<p>Bayes factor threshold</p>
</td></tr>
<tr><td><code id="ntbf01_+3A_power">power</code></td>
<td>
<p>Target power</p>
</td></tr>
<tr><td><code id="ntbf01_+3A_null">null</code></td>
<td>
<p>Standardized mean difference under the point null hypothesis.
Defaults to <code>0</code></p>
</td></tr>
<tr><td><code id="ntbf01_+3A_plocation">plocation</code></td>
<td>
<p><code class="reqn">t</code> prior location. Defaults to <code>0</code></p>
</td></tr>
<tr><td><code id="ntbf01_+3A_pscale">pscale</code></td>
<td>
<p><code class="reqn">t</code> prior scale. Defaults to <code>1/sqrt(2)</code></p>
</td></tr>
<tr><td><code id="ntbf01_+3A_pdf">pdf</code></td>
<td>
<p><code class="reqn">t</code> prior degrees of freedom. Defaults to <code>1</code> (a Cauchy
prior)</p>
</td></tr>
<tr><td><code id="ntbf01_+3A_type">type</code></td>
<td>
<p>Type of <code class="reqn">t</code>-test. Can be <code>"two.sample"</code> (default),
<code>"one.sample"</code>, or <code>"paired"</code></p>
</td></tr>
<tr><td><code id="ntbf01_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the test. Can be either <code>"two.sided"</code>
(default), <code>"less"</code>, or <code>"greater"</code>. The latter two truncate
the analysis prior to negative and positive effects, respectively. If set
to <code>"less"</code> or <code>"greater"</code>, the power is only computed based on
data with effect estimates in the direction of the alternative</p>
</td></tr>
<tr><td><code id="ntbf01_+3A_dpm">dpm</code></td>
<td>
<p>Mean of the normal design prior assigned to the standardized mean
difference. Defaults to the analysis prior location</p>
</td></tr>
<tr><td><code id="ntbf01_+3A_dpsd">dpsd</code></td>
<td>
<p>Standard deviation of the normal design prior assigned to the
standardized mean difference. Set to <code>0</code> to obtain a point prior at
the design prior mean. Defaults to the analysis prior scale</p>
</td></tr>
<tr><td><code id="ntbf01_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical indicating whether Pr(BF <code class="reqn">\leq</code> <code>k</code>)
(<code>TRUE</code>) or Pr(BF <code class="reqn">&gt;</code> <code>k</code>) (<code>FALSE</code>) should be
computed. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="ntbf01_+3A_integer">integer</code></td>
<td>
<p>Logical indicating whether only integer valued sample sizes
should be returned. If <code>TRUE</code> the required sample size is rounded to
the next larger integer. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="ntbf01_+3A_nrange">nrange</code></td>
<td>
<p>Sample size search range over which numerical search is
performed. Defaults to <code>c(2, 10^4)</code></p>
</td></tr>
<tr><td><code id="ntbf01_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>stats::uniroot</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The required sample size to achieve the specified power
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+ptbf01">ptbf01</a>, <a href="#topic+powertbf01">powertbf01</a>, <a href="#topic+tbf01">tbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## example from Schönbrodt and Wagenmakers (2018, p.135)
 ntbf01(k = 1/6, power = 0.95, dpm = 0.5, dpsd = 0, alternative = "greater")
 ntbf01(k = 1/6, power = 0.95, dpm = 0.5, dpsd = 0.1, alternative = "greater")
 ntbf01(k = 6, power = 0.95, dpm = 0, dpsd = 0, alternative = "greater",
        lower.tail = FALSE, nrange = c(2, 10000))

</code></pre>

<hr>
<h2 id='pbf01'>Cumulative distribution function of the z-test Bayes factor</h2><span id='topic+pbf01'></span>

<h3>Description</h3>

<p>This function computes the probability of obtaining a Bayes
factor (<a href="#topic+bf01">bf01</a>) more extreme than a threshold <code>k</code> with a
specified sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pbf01(k, n, usd, null = 0, pm, psd, dpm = pm, dpsd = psd, lower.tail = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pbf01_+3A_k">k</code></td>
<td>
<p>Bayes factor threshold</p>
</td></tr>
<tr><td><code id="pbf01_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="pbf01_+3A_usd">usd</code></td>
<td>
<p>Unit standard deviation, the standard error of the parameter
estimate based on <code class="reqn">\code{n}=1</code>, see details</p>
</td></tr>
<tr><td><code id="pbf01_+3A_null">null</code></td>
<td>
<p>Parameter value under the point null hypothesis. Defaults to
<code>0</code></p>
</td></tr>
<tr><td><code id="pbf01_+3A_pm">pm</code></td>
<td>
<p>Mean of the normal prior assigned to the parameter under the
alternative in the analysis</p>
</td></tr>
<tr><td><code id="pbf01_+3A_psd">psd</code></td>
<td>
<p>Standard deviation of the normal prior assigned to the parameter
under the alternative in the analysis. Set to <code>0</code> to obtain a point
prior at the prior mean</p>
</td></tr>
<tr><td><code id="pbf01_+3A_dpm">dpm</code></td>
<td>
<p>Mean of the normal design prior assigned to the parameter.
Defaults to the same value as the analysis prior <code>pm</code></p>
</td></tr>
<tr><td><code id="pbf01_+3A_dpsd">dpsd</code></td>
<td>
<p>Standard deviation of the normal design prior assigned to the
parameter. Defaults to the same value as the analysis prior <code>psd</code></p>
</td></tr>
<tr><td><code id="pbf01_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical indicating whether Pr(BF <code class="reqn">\leq</code> <code>k</code>)
(<code>TRUE</code>) or Pr(BF <code class="reqn">&gt;</code> <code>k</code>) (<code>FALSE</code>) should be
computed. Defaults to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the standard error of the future parameter
estimate is of the form <code class="reqn">\code{se} =\code{usd}/\sqrt{\code{n}}</code>. For example, for normally distributed data with known
standard deviation <code>sd</code> and two equally sized groups of size
<code>n</code>, the standard error of an estimated standardized mean difference
is <code class="reqn">\code{se} = \code{sd}\sqrt{2/n}</code>, so the
corresponding unit standard deviation is <code class="reqn">\code{usd} =
    \code{sd}\sqrt{2}</code>. See the vignette for more
information.
</p>


<h3>Value</h3>

<p>The probability that the Bayes factor is less or greater (depending
on the specified <code>lower.tail</code>) than the specified threshold <code>k</code>
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+nbf01">nbf01</a>, <a href="#topic+powerbf01">powerbf01</a>, <a href="#topic+bf01">bf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## point alternative (psd = 0)
pbf01(k = 1/10, n = 200, usd = 2, null = 0, pm = 0.5, psd = 0)

## normal alternative (psd &gt; 0)
pbf01(k = 1/10, n = 100, usd = 2, null = 0, pm = 0.5, psd = 2)

## design prior is the null hypothesis (dpm = 0, dpsd = 0)
pbf01(k = 10, n = 1000, usd = 2, null = 0, pm = 0.3, psd = 2, dpm = 0, dpsd = 0, lower.tail = FALSE)

## draw a power curve
nseq &lt;- round(exp(seq(log(10), log(10000), length.out = 100)))
plot(nseq, pbf01(k = 1/10, n = nseq, usd = 2, null = 0, pm = 0.3, psd = 0), type = "l",
     xlab = "n", ylab = bquote("Pr(BF"["01"] &lt;= 1/10 * ")"), ylim = c(0, 1),
     log = "x", las = 1)

## standardized mean difference (usd = sqrt(2), effective sample size = per group size)
n &lt;- 30
pbf01(k = 1/10, n = n, usd = sqrt(2), null = 0, pm = 0, psd = 1)

## z-transformed correlation (usd = 1, effective sample size = n - 3)
n &lt;- 100
pbf01(k = 1/10, n = n - 3, usd = 1, null = 0, pm = 0.2, psd = 0.5)

## log hazard/odds ratio (usd = 2, effective sample size = total number of events)
nevents &lt;- 100
pbf01(k = 1/10, n = nevents, usd = 2, null = 0, pm = 0, psd = sqrt(0.5))

</code></pre>

<hr>
<h2 id='plot.power.bftest'>Plot method for class <code>"power.bftest"</code></h2><span id='topic+plot.power.bftest'></span>

<h3>Description</h3>

<p>Plot method for class <code>"power.bftest"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'power.bftest'
plot(x, nlim = c(2, 500), ngrid = 100, plot = TRUE, nullplot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.power.bftest_+3A_x">x</code></td>
<td>
<p>Object of class <code>"power.bftest"</code></p>
</td></tr>
<tr><td><code id="plot.power.bftest_+3A_nlim">nlim</code></td>
<td>
<p>Range of sample sizes over which the power should be computed.
Defaults to <code>c(2, 500)</code></p>
</td></tr>
<tr><td><code id="plot.power.bftest_+3A_ngrid">ngrid</code></td>
<td>
<p>Number of grid point for which power should be computed.
Defaults to 100</p>
</td></tr>
<tr><td><code id="plot.power.bftest_+3A_plot">plot</code></td>
<td>
<p>Logical indicating whether data should be plotted. If
<code>FALSE</code> only the data used for plotting are returned.</p>
</td></tr>
<tr><td><code id="plot.power.bftest_+3A_nullplot">nullplot</code></td>
<td>
<p>Logcal indicating whether a second plot with the power in
favor of the null (using a Bayes factor threshold of 1/k) should be
created. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="plot.power.bftest_+3A_...">...</code></td>
<td>
<p>Other arguments (for consistency with the generic)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots power curves (if specified) and invisibly returns a list of
data frames containing the data underlying the power curves
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+powerbf01">powerbf01</a>, <a href="#topic+powertbf01">powertbf01</a>, <a href="#topic+powernmbf01">powernmbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ssd1 &lt;- powerbf01(k = 1/6, power = 0.95, pm = 0, psd = 1/sqrt(2), dpm = 0.5, dpsd = 0)
plot(ssd1, nlim = c(1, 8000))

power1 &lt;- powerbf01(k = 1/2, n = 120, pm = 0, psd = 1/sqrt(2), dpm = 0.5, dpsd = 0)
plot(power1, nlim = c(1, 1000))

</code></pre>

<hr>
<h2 id='pnmbf01'>Cumulative distribution function of the normal moment prior Bayes factor</h2><span id='topic+pnmbf01'></span>

<h3>Description</h3>

<p>This function computes the probability of obtaining a normal
moment prior Bayes factor (<a href="#topic+nmbf01">nmbf01</a>) more extreme than a threshold
<code>k</code> with a specified sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pnmbf01(k, n, usd, null = 0, psd, dpm, dpsd, lower.tail = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pnmbf01_+3A_k">k</code></td>
<td>
<p>Bayes factor threshold</p>
</td></tr>
<tr><td><code id="pnmbf01_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="pnmbf01_+3A_usd">usd</code></td>
<td>
<p>Unit standard deviation, the standard error of the parameter
estimate based on <code class="reqn">\code{n}=1</code>, see details</p>
</td></tr>
<tr><td><code id="pnmbf01_+3A_null">null</code></td>
<td>
<p>Parameter value under the point null hypothesis. Defaults to
<code>0</code></p>
</td></tr>
<tr><td><code id="pnmbf01_+3A_psd">psd</code></td>
<td>
<p>Spread of the normal moment prior assigned to the parameter under
the alternative in the analysis. The modes of the prior are located at
<code class="reqn">\pm\sqrt{2}\,\code{psd}</code></p>
</td></tr>
<tr><td><code id="pnmbf01_+3A_dpm">dpm</code></td>
<td>
<p>Mean of the normal design prior assigned to the parameter</p>
</td></tr>
<tr><td><code id="pnmbf01_+3A_dpsd">dpsd</code></td>
<td>
<p>Standard deviation of the normal design prior assigned to the
parameter. Set to 0 to obtain a point prior at the design prior mean</p>
</td></tr>
<tr><td><code id="pnmbf01_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical indicating whether Pr(BF <code class="reqn">\leq</code> <code>k</code>)
(<code>TRUE</code>) or Pr(BF <code class="reqn">&gt;</code> <code>k</code>) (<code>FALSE</code>) should be
computed. Defaults to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is assumed that the standard error of the future parameter
estimate is of the form <code class="reqn">\code{se} =\code{usd}/\sqrt{\code{n}}</code>. For example, for normally distributed data with known
standard deviation <code>sd</code> and two equally sized groups of size
<code>n</code>, the standard error of an estimated standardized mean difference
is <code class="reqn">\code{se} = \code{sd}\sqrt{2/n}</code>, so the
corresponding unit standard deviation is <code class="reqn">\code{usd} =
    \code{sd}\sqrt{2}</code>. See the vignette for more
information.
</p>


<h3>Value</h3>

<p>The probability that the Bayes factor is less or greater (depending
on the specified <code>lower.tail</code>) than the specified threshold <code>k</code>
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+nmbf01">nmbf01</a>, <a href="#topic+nnmbf01">nnmbf01</a>, <a href="#topic+powernmbf01">powernmbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## point desing prior (psd = 0)
pnmbf01(k = 1/10, n = 200, usd = 2, null = 0, psd = 0.5/sqrt(2), dpm = 0.5, dpsd = 0)

## normal design prior to incorporate parameter uncertainty (psd &gt; 0)
pnmbf01(k = 1/10, n = 200, usd = 2, null = 0, psd = 0.5/sqrt(2), dpm = 0.5, dpsd = 0.25)

## design prior is the null hypothesis (dpm = 0, dpsd = 0)
pnmbf01(k = 10, n = 200, usd = 2, null = 0, psd = 0.5/sqrt(2), dpm = 0, dpsd = 0,
        lower.tail = FALSE)

</code></pre>

<hr>
<h2 id='powerbf01'>Power and sample size calculations for z-test Bayes factor</h2><span id='topic+powerbf01'></span>

<h3>Description</h3>

<p>Compute probability that z-test Bayes factor is smaller than a
specified threshold (the power), or determine sample size to obtain a
target power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerbf01(
  n = NULL,
  power = NULL,
  k = 1/10,
  sd = 1,
  null = 0,
  pm,
  psd,
  type = c("two.sample", "one.sample", "paired"),
  dpm = pm,
  dpsd = psd,
  nrange = c(1, 10^5)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powerbf01_+3A_n">n</code></td>
<td>
<p>Sample size (per group for two-sample tests). Has to be <code>NULL</code>
if <code>power</code> is specified. Defaults to <code>NULL</code></p>
</td></tr>
<tr><td><code id="powerbf01_+3A_power">power</code></td>
<td>
<p>Target power. Has to be <code>NULL</code> if <code>n</code> is specified.
Defaults to <code>NULL</code></p>
</td></tr>
<tr><td><code id="powerbf01_+3A_k">k</code></td>
<td>
<p>Bayes factor threshold. Defaults to <code>1/10</code>, Jeffreys' threshold
for 'strong evidence' against the null hypothesis</p>
</td></tr>
<tr><td><code id="powerbf01_+3A_sd">sd</code></td>
<td>
<p>Standard deviation of one observation (for <code>type =
"two.sample"</code> or <code>type = "one.sample"</code>) or of one difference within
a pair of observations (<code>type = "paired"</code>). Is assumed to be known.
Defaults to <code>1</code></p>
</td></tr>
<tr><td><code id="powerbf01_+3A_null">null</code></td>
<td>
<p>Mean difference under the point null hypothesis. Defaults to
<code>0</code></p>
</td></tr>
<tr><td><code id="powerbf01_+3A_pm">pm</code></td>
<td>
<p>Mean of the normal prior assigned to the mean difference under the
alternative in the analysis</p>
</td></tr>
<tr><td><code id="powerbf01_+3A_psd">psd</code></td>
<td>
<p>Standard deviation of the normal prior assigned to the mean
difference under the alternative in the analysis. Set to <code>0</code> to
obtain a point prior at the prior mean</p>
</td></tr>
<tr><td><code id="powerbf01_+3A_type">type</code></td>
<td>
<p>The type of test. One of <code>"two.sample"</code>,
<code>"one.sample"</code>, <code>"paired"</code>. Defaults to <code>"two.sample"</code></p>
</td></tr>
<tr><td><code id="powerbf01_+3A_dpm">dpm</code></td>
<td>
<p>Mean of the normal design prior assigned to the mean difference.
Defaults to the same value as the analysis prior <code>pm</code></p>
</td></tr>
<tr><td><code id="powerbf01_+3A_dpsd">dpsd</code></td>
<td>
<p>Standard deviation of the normal design prior assigned to the
mean difference. Defaults to the same value as the analysis prior
<code>psd</code></p>
</td></tr>
<tr><td><code id="powerbf01_+3A_nrange">nrange</code></td>
<td>
<p>Sample size search range over which numerical search is
performed (only taken into account when <code>n</code> is <code>NULL</code>).
Defaults to <code>c(1, 10^5)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides a similar interface as
<code>stats::power.t.test</code>. It also assumes that the data are continuous
and that the parameter of interest is either a mean or a (standardized)
mean difference. For some users, the low-level functions <a href="#topic+nbf01">nbf01</a> (to
directly compute the sample size for a fixed power) and <a href="#topic+pbf01">pbf01</a> (to
directly compute the power for a fixed sample size) may also be useful
because they can be used for other data and parameter types.
</p>


<h3>Value</h3>

<p>Object of class <code>"power.bftest"</code>, a list of the arguments
(including the computed one) augmented with <code>method</code> and <code>note</code>
elements
</p>


<h3>Note</h3>

<p>A warning message will be displayed in case that the specified target
power is not achievable under the specified analysis and design priors.
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+plot.power.bftest">plot.power.bftest</a>, <a href="#topic+nbf01">nbf01</a>, <a href="#topic+pbf01">pbf01</a>, <a href="#topic+bf01">bf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## determine power
powerbf01(n = 100, pm = 0, psd = 1, dpm = 0.5, dpsd = 0)

## determine sample size
powerbf01(power = 0.99, pm = 0, psd = 1, dpm = 0.5, dpsd = 0)

</code></pre>

<hr>
<h2 id='powernmbf01'>Power and sample size calculations for normal moment prior Bayes
factor</h2><span id='topic+powernmbf01'></span>

<h3>Description</h3>

<p>Compute probability that normal moment prior Bayes factor is
smaller than a specified threshold (the power), or determine sample size
to obtain a target power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powernmbf01(
  n = NULL,
  power = NULL,
  k = 1/10,
  sd = 1,
  null = 0,
  psd,
  type = c("two.sample", "one.sample", "paired"),
  dpm,
  dpsd,
  nrange = c(1, 10^5)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powernmbf01_+3A_n">n</code></td>
<td>
<p>Sample size (per group for two-sample tests). Has to be <code>NULL</code>
if <code>power</code> is specified. Defaults to <code>NULL</code></p>
</td></tr>
<tr><td><code id="powernmbf01_+3A_power">power</code></td>
<td>
<p>Target power. Has to be <code>NULL</code> if <code>n</code> is specified.
Defaults to <code>NULL</code></p>
</td></tr>
<tr><td><code id="powernmbf01_+3A_k">k</code></td>
<td>
<p>Bayes factor threshold. Defaults to <code>1/10</code>, Jeffreys' threshold
for 'strong evidence' against the null hypothesis</p>
</td></tr>
<tr><td><code id="powernmbf01_+3A_sd">sd</code></td>
<td>
<p>Standard deviation of one observation (for <code>type =
"two.sample"</code> or <code>type = "one.sample"</code>) or of one difference within
a pair of observations (<code>type = "paired"</code>). Is assumed to be known.
Defaults to <code>1</code></p>
</td></tr>
<tr><td><code id="powernmbf01_+3A_null">null</code></td>
<td>
<p>Parameter value under the point null hypothesis. Defaults to
<code>0</code></p>
</td></tr>
<tr><td><code id="powernmbf01_+3A_psd">psd</code></td>
<td>
<p>Spread of the normal moment prior assigned to the parameter under
the alternative in the analysis. The modes of the prior are located at
<code class="reqn">\pm\sqrt{2}\,\code{psd}</code></p>
</td></tr>
<tr><td><code id="powernmbf01_+3A_type">type</code></td>
<td>
<p>The type of test. One of <code>"two.sample"</code>,
<code>"one.sample"</code>, <code>"paired"</code>. Defaults to <code>"two.sample"</code></p>
</td></tr>
<tr><td><code id="powernmbf01_+3A_dpm">dpm</code></td>
<td>
<p>Mean of the normal design prior assigned to the parameter</p>
</td></tr>
<tr><td><code id="powernmbf01_+3A_dpsd">dpsd</code></td>
<td>
<p>Standard deviation of the normal design prior assigned to the
parameter. Set to 0 to obtain a point prior at the design prior mean</p>
</td></tr>
<tr><td><code id="powernmbf01_+3A_nrange">nrange</code></td>
<td>
<p>Sample size search range over which numerical search is
performed (only taken into account when <code>n</code> is <code>NULL</code>).
Defaults to <code>c(1, 10^5)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides a similar interface as
<code>stats::power.t.test</code>. It also assumes that the data are continuous
and that the parameter of interest is either a mean or a (standardized)
mean difference. For some users, the low-level functions <a href="#topic+nnmbf01">nnmbf01</a>
(to directly compute the sample size for a fixed power) and
<a href="#topic+pnmbf01">pnmbf01</a> (to directly compute the power for a fixed sample size)
may also be useful because they can be used for other data and parameter
types.
</p>


<h3>Value</h3>

<p>Object of class <code>"power.bftest"</code>, a list of the arguments
(including the computed one) augmented with <code>method</code> and <code>note</code>
elements
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+plot.power.bftest">plot.power.bftest</a>, <a href="#topic+nnmbf01">nnmbf01</a>, <a href="#topic+pnmbf01">pnmbf01</a>, <a href="#topic+nmbf01">nmbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## determine power
powernmbf01(n = 100, psd = 1, dpm = 0.5, dpsd = 0)

## determine sample size
powernmbf01(power = 0.99, psd = 1, dpm = 0.5, dpsd = 0)

</code></pre>

<hr>
<h2 id='powertbf01'>Power and sample size calculations for <code class="reqn">t</code>-test Bayes factor</h2><span id='topic+powertbf01'></span>

<h3>Description</h3>

<p>Compute probability that <code class="reqn">t</code>-test Bayes factor is smaller
than a specified threshold (the power), or determine sample size to
obtain a target power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powertbf01(
  n = NULL,
  power = NULL,
  k = 1/10,
  null = 0,
  plocation = 0,
  pscale = 1/sqrt(2),
  pdf = 1,
  type = c("two.sample", "one.sample", "paired"),
  alternative = c("two.sided", "less", "greater"),
  dpm = plocation,
  dpsd = pscale,
  nrange = c(2, 10^4)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="powertbf01_+3A_n">n</code></td>
<td>
<p>Sample size (per group)</p>
</td></tr>
<tr><td><code id="powertbf01_+3A_power">power</code></td>
<td>
<p>Target power. Has to be <code>NULL</code> if <code>n</code> is specified.
Defaults to <code>NULL</code></p>
</td></tr>
<tr><td><code id="powertbf01_+3A_k">k</code></td>
<td>
<p>Bayes factor threshold. Defaults to <code>1/10</code>, Jeffreys' threshold
for 'strong evidence' against the null hypothesis</p>
</td></tr>
<tr><td><code id="powertbf01_+3A_null">null</code></td>
<td>
<p>Standardized mean difference under the point null hypothesis.
Defaults to <code>0</code></p>
</td></tr>
<tr><td><code id="powertbf01_+3A_plocation">plocation</code></td>
<td>
<p><code class="reqn">t</code> prior location. Defaults to <code>0</code></p>
</td></tr>
<tr><td><code id="powertbf01_+3A_pscale">pscale</code></td>
<td>
<p><code class="reqn">t</code> prior scale. Defaults to <code>1/sqrt(2)</code></p>
</td></tr>
<tr><td><code id="powertbf01_+3A_pdf">pdf</code></td>
<td>
<p><code class="reqn">t</code> prior degrees of freedom. Defaults to <code>1</code> (a Cauchy
prior)</p>
</td></tr>
<tr><td><code id="powertbf01_+3A_type">type</code></td>
<td>
<p>Type of <code class="reqn">t</code>-test. Can be <code>"two.sample"</code> (default),
<code>"one.sample"</code>, or <code>"paired"</code></p>
</td></tr>
<tr><td><code id="powertbf01_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the test. Can be either <code>"two.sided"</code>
(default), <code>"less"</code>, or <code>"greater"</code>. The latter two truncate
the analysis prior to negative and positive effects, respectively. If set
to <code>"less"</code> or <code>"greater"</code>, the power is only computed based on
data with effect estimates in the direction of the alternative</p>
</td></tr>
<tr><td><code id="powertbf01_+3A_dpm">dpm</code></td>
<td>
<p>Mean of the normal design prior assigned to the standardized mean
difference. Defaults to the analysis prior location</p>
</td></tr>
<tr><td><code id="powertbf01_+3A_dpsd">dpsd</code></td>
<td>
<p>Standard deviation of the normal design prior assigned to the
standardized mean difference. Set to <code>0</code> to obtain a point prior at
the design prior mean. Defaults to the analysis prior scale</p>
</td></tr>
<tr><td><code id="powertbf01_+3A_nrange">nrange</code></td>
<td>
<p>Sample size search range over which numerical search is
performed (only taken into account when <code>n</code> is <code>NULL</code>).
Defaults to <code>c(2, 10^4)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides a similar interface as
<code>stats::power.t.test</code>. For some users, the low-level functions
<a href="#topic+ntbf01">ntbf01</a> (to directly compute the sample size for a fixed power) and
<a href="#topic+ptbf01">ptbf01</a> (to directly compute the power for a fixed sample size) may
also be useful.
</p>


<h3>Value</h3>

<p>Object of class <code>"power.bftest"</code>, a list of the arguments
(including the computed one) augmented with <code>method</code> and <code>note</code>
elements
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+plot.power.bftest">plot.power.bftest</a>, <a href="#topic+ptbf01">ptbf01</a>, <a href="#topic+ntbf01">ntbf01</a>, <a href="#topic+tbf01">tbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## determine power
powertbf01(n = 146, k = 1/6, dpm = 0.5, dps = 0, alternative = "greater")

## determine sample size
powertbf01(power = 0.95, k = 1/6, dpm = 0.5, dps = 0, alternative = "greater")

</code></pre>

<hr>
<h2 id='print.power.bftest'>Print method for class <code>"power.bftest"</code></h2><span id='topic+print.power.bftest'></span>

<h3>Description</h3>

<p>Print method for class <code>"power.bftest"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'power.bftest'
print(x, digits = getOption("digits"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.power.bftest_+3A_x">x</code></td>
<td>
<p>Object of class <code>"power.bftest"</code></p>
</td></tr>
<tr><td><code id="print.power.bftest_+3A_digits">digits</code></td>
<td>
<p>Number of digits for formatting of numbers</p>
</td></tr>
<tr><td><code id="print.power.bftest_+3A_...">...</code></td>
<td>
<p>Other arguments (for consistency with the generic)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints text summary in the console and invisibly returns the
<code>"power.bftest"</code> object
</p>


<h3>Note</h3>

<p>Function adapted from <code>stats:::print.power.htest</code> written by Peter
Dalgaard
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+powerbf01">powerbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>powerbf01(power = 0.95, pm = 0, psd = 1, dpm = 0.5, dpsd = 0)
powerbf01(power = 0.95, pm = 0, psd = 1, dpm = 0.5, dpsd = 0, type = "one.sample")
powerbf01(power = 0.95, pm = 0, psd = 1, dpm = 0.5, dpsd = 0, type = "paired")
powerbf01(power = 0.95, pm = 1, psd = 0, dpm = 0.8, dpsd = 0, type = "paired")

</code></pre>

<hr>
<h2 id='ptbf01'>Cumulative distribution function of the t-test Bayes factor</h2><span id='topic+ptbf01'></span>

<h3>Description</h3>

<p>This function computes the probability of obtaining a
<code class="reqn">t</code>-test Bayes factor (<a href="#topic+tbf01">tbf01</a>) more extreme than a threshold
<code>k</code> with a specified sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptbf01(
  k,
  n,
  n1 = n,
  n2 = n,
  null = 0,
  plocation = 0,
  pscale = 1/sqrt(2),
  pdf = 1,
  dpm = plocation,
  dpsd = pscale,
  type = c("two.sample", "one.sample", "paired"),
  alternative = c("two.sided", "less", "greater"),
  lower.tail = TRUE,
  drange = "adaptive",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ptbf01_+3A_k">k</code></td>
<td>
<p>Bayes factor threshold</p>
</td></tr>
<tr><td><code id="ptbf01_+3A_n">n</code></td>
<td>
<p>Sample size (per group)</p>
</td></tr>
<tr><td><code id="ptbf01_+3A_n1">n1</code></td>
<td>
<p>Sample size in group 1 (only required for two-sample <code class="reqn">t</code>-test
with unequal group sizes)</p>
</td></tr>
<tr><td><code id="ptbf01_+3A_n2">n2</code></td>
<td>
<p>Sample size in group 2 (only required for two-sample <code class="reqn">t</code>-test
with unequal group sizes)</p>
</td></tr>
<tr><td><code id="ptbf01_+3A_null">null</code></td>
<td>
<p>Standardized mean difference under the point null hypothesis.
Defaults to <code>0</code></p>
</td></tr>
<tr><td><code id="ptbf01_+3A_plocation">plocation</code></td>
<td>
<p><code class="reqn">t</code> prior location. Defaults to <code>0</code></p>
</td></tr>
<tr><td><code id="ptbf01_+3A_pscale">pscale</code></td>
<td>
<p><code class="reqn">t</code> prior scale. Defaults to <code>1/sqrt(2)</code></p>
</td></tr>
<tr><td><code id="ptbf01_+3A_pdf">pdf</code></td>
<td>
<p><code class="reqn">t</code> prior degrees of freedom. Defaults to <code>1</code> (a Cauchy
prior)</p>
</td></tr>
<tr><td><code id="ptbf01_+3A_dpm">dpm</code></td>
<td>
<p>Mean of the normal design prior assigned to the standardized mean
difference. Defaults to the analysis prior location</p>
</td></tr>
<tr><td><code id="ptbf01_+3A_dpsd">dpsd</code></td>
<td>
<p>Standard deviation of the normal design prior assigned to the
standardized mean difference. Set to <code>0</code> to obtain a point prior at
the design prior mean. Defaults to the analysis prior scale</p>
</td></tr>
<tr><td><code id="ptbf01_+3A_type">type</code></td>
<td>
<p>Type of <code class="reqn">t</code>-test. Can be <code>"two.sample"</code> (default),
<code>"one.sample"</code>, or <code>"paired"</code></p>
</td></tr>
<tr><td><code id="ptbf01_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the test. Can be either <code>"two.sided"</code>
(default), <code>"less"</code>, or <code>"greater"</code>. The latter two truncate
the analysis prior to negative and positive effects, respectively. If set
to <code>"less"</code> or <code>"greater"</code>, the power is only computed based on
data with effect estimates in the direction of the alternative</p>
</td></tr>
<tr><td><code id="ptbf01_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical indicating whether Pr(BF <code class="reqn">\leq</code> <code>k</code>)
(<code>TRUE</code>) or Pr(BF <code class="reqn">&gt;</code> <code>k</code>) (<code>FALSE</code>) should be
computed. Defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="ptbf01_+3A_drange">drange</code></td>
<td>
<p>Standardized mean difference search range over which the
critical values are searched for. Can be either set to a numerical range
or to <code>"adaptive"</code> (default) which determines the range in an
adaptive way from the other input parameters</p>
</td></tr>
<tr><td><code id="ptbf01_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>stats::uniroot</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The probability that the Bayes factor is less or greater (depending
on the specified <code>lower.tail</code>) than the specified threshold <code>k</code>
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>See Also</h3>

<p><a href="#topic+tbf01">tbf01</a>, <a href="#topic+ntbf01">ntbf01</a>, <a href="#topic+powertbf01">powertbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example from Schönbrodt and Wagenmakers (2018, p. 135)
ptbf01(k = 1/6, n = 146, dpm = 0.5, dpsd = 0, alternative = "greater")
ptbf01(k = 6, n = 146, dpm = 0, dpsd = 0, alternative = "greater",
       lower.tail = FALSE)

## two-sided
ptbf01(k = 1/6, n = 146, dpm = 0.5, dpsd = 0)
ptbf01(k = 6, n = 146, dpm = 0, dpsd = 0, lower.tail = FALSE)

## one-sample test
ptbf01(k = 1/6, n = 146, dpm = 0.5, dpsd = 0, alternative = "greater", type = "one.sample")

</code></pre>

<hr>
<h2 id='tbf01'>t-test Bayes factor</h2><span id='topic+tbf01'></span>

<h3>Description</h3>

<p>This function computes the Bayes factor that forms the basis of
the informed Bayesian <code class="reqn">t</code>-test from Gronau et al. (2020). The Bayes
factor quantifies the evidence that the data provide for the null
hypothesis that the standardized mean difference (SMD) is zero against
the alternative that the SMD is non-zero. A location-scale
<code class="reqn">t</code>-distribution is assumed for the SMD under the alternative
hypothesis. The Jeffreys-Zellner-Siow (JZS) Bayes factor (Rouder et al.,
2009) is obtained as a special case by setting the location of the prior
to zero and the prior degrees of freedom to one, which is the default.
</p>
<p>The data are summarized by <code class="reqn">t</code>-statistics and sample sizes. The
following types of <code class="reqn">t</code>-statistics are accepted:
</p>

<ul>
<li><p> Two-sample <code class="reqn">t</code>-test where the SMD represents the standardized
mean difference between two group means (assuming equal variances in
both groups)
</p>
</li>
<li><p> One-sample <code class="reqn">t</code>-test where the SMD represents the standardized
mean difference to the null value
</p>
</li>
<li><p> Paired <code class="reqn">t</code>-test where the SMD represents the standardized mean
change score
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>tbf01(
  t,
  n,
  n1 = n,
  n2 = n,
  plocation = 0,
  pscale = 1/sqrt(2),
  pdf = 1,
  type = c("two.sample", "one.sample", "paired"),
  alternative = c("two.sided", "less", "greater"),
  log = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tbf01_+3A_t">t</code></td>
<td>
<p><code class="reqn">t</code>-statistic</p>
</td></tr>
<tr><td><code id="tbf01_+3A_n">n</code></td>
<td>
<p>Sample size (per group)</p>
</td></tr>
<tr><td><code id="tbf01_+3A_n1">n1</code></td>
<td>
<p>Sample size in group 1 (only required for two-sample <code class="reqn">t</code>-test
with unequal group sizes)</p>
</td></tr>
<tr><td><code id="tbf01_+3A_n2">n2</code></td>
<td>
<p>Sample size in group 2 (only required for two-sample <code class="reqn">t</code>-test
with unequal group sizes)</p>
</td></tr>
<tr><td><code id="tbf01_+3A_plocation">plocation</code></td>
<td>
<p><code class="reqn">t</code> prior location. Defaults to <code>0</code></p>
</td></tr>
<tr><td><code id="tbf01_+3A_pscale">pscale</code></td>
<td>
<p><code class="reqn">t</code> prior scale. Defaults to <code>1/sqrt(2)</code></p>
</td></tr>
<tr><td><code id="tbf01_+3A_pdf">pdf</code></td>
<td>
<p><code class="reqn">t</code> prior degrees of freedom. Defaults to <code>1</code> (a Cauchy
prior)</p>
</td></tr>
<tr><td><code id="tbf01_+3A_type">type</code></td>
<td>
<p>Type of <code class="reqn">t</code>-test. Can be <code>"two.sample"</code> (default),
<code>"one.sample"</code>, or <code>"paired"</code></p>
</td></tr>
<tr><td><code id="tbf01_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the test. Can be either <code>"two.sided"</code>
(default), <code>"less"</code>, or <code>"greater"</code>. The latter two truncate
the analysis prior to negative and positive effects, respectively.</p>
</td></tr>
<tr><td><code id="tbf01_+3A_log">log</code></td>
<td>
<p>Logical indicating whether the natural logarithm of the Bayes
factor should be returned. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="tbf01_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>stats::integrate</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Bayes factor is implemented as in equation (5) in Gronau et al.
(2020), and using suitable truncation in case of one-sided alternatives.
Integration is performed numerically with <code>stats::integrate</code>.
</p>


<h3>Value</h3>

<p>Bayes factor in favor of the null hypothesis over the alternative (BF
&gt; 1 indicates evidence for the null hypothesis, whereas BF &lt; 1 indicates
evidence for the alternative)
</p>


<h3>Author(s)</h3>

<p>Samuel Pawel
</p>


<h3>References</h3>

<p>Rouder, J. N., Speckman, P. L., Sun, D., Morey, R. D., Iverson,
G. (2009). Bayesian <code class="reqn">t</code> tests for accepting and rejecting the null
hypothesis. Psychonomic Bulletin &amp; Review, 16(2):225-237.
<a href="https://doi.org/10.3758/PBR.16.2.225">doi:10.3758/PBR.16.2.225</a>
</p>
<p>Gronau, Q. F., Ly., A., Wagenmakers, E.J. (2020). Informed Bayesian
<code class="reqn">t</code>-Tests. The American Statistician, 74(2):137-143.
<a href="https://doi.org/10.1080/00031305.2018.1562983">doi:10.1080/00031305.2018.1562983</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+powertbf01">powertbf01</a>, <a href="#topic+ptbf01">ptbf01</a>, <a href="#topic+ntbf01">ntbf01</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## analyses from Rouder et al. (2009):
## values from Table 1
tbf01(t = c(0.69, 3.20), n = 100, pscale = 1, type = "one.sample")
## examples from p. 232
tbf01(t = c(2.24, 2.03), n = 80, pscale = 1, type = "one.sample")

## analyses from Gronau et al. (2020) section 3.2:
## informed prior
tbf01(t = -0.90, n1 = 53, n2 = 57, plocation = 0.350, pscale = 0.102, pdf = 3,
      alternative = "greater", type = "two.sample")
## default (one-sided) prior
tbf01(t = -0.90, n1 = 53, n2 = 57, plocation = 0, pscale = 1/sqrt(2), pdf = 1,
      alternative = "greater", type = "two.sample")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
