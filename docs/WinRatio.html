<!DOCTYPE html><html lang="en"><head><title>Help for package WinRatio</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {WinRatio}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#WinRatio-package'>
<p>Win Ratio for Prioritized Outcomes and 95% Confidence Interval</p></a></li>
<li><a href='#is.binary'><p>Binary Vectors</p></a></li>
<li><a href='#summary.WinRatio'><p>Summarizing Win Ratio Results</p></a></li>
<li><a href='#winratio'><p>Win Ratio for Prioritized Outcomes and 95% Confidence Interval</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Win Ratio for Prioritized Outcomes and 95% Confidence Interval</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Kevin Duarte, 
  Joao Pedro Ferreira</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kevin Duarte &lt;k.duarte@chru-nancy.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate the win ratio for prioritized outcomes and the 95% confidence interval based on Bebu and Lachin (2016) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxv032">doi:10.1093/biostatistics/kxv032</a>&gt;. Three type of outcomes can be analyzed: survival "failure-time" events, repeated survival "failure-time" events and continuous or ordinal "non-failure time" events that are captured at specific time-points in the study.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), tidyverse (&ge; 1.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.5), dplyr, magrittr, tidyselect</td>
</tr>
<tr>
<td>Suggests:</td>
<td>survival</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-19 20:52:26 UTC; U002453</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-23 08:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='WinRatio-package'>
Win Ratio for Prioritized Outcomes and 95% Confidence Interval
</h2><span id='topic+WinRatio-package'></span>

<h3>Description</h3>

<p>Calculate the win ratio for prioritized outcomes and the 95% confidence interval based on Bebu and Lachin (2016). Three type of outcomes can be analyzed: survival &quot;failure-time&quot; events, repeated survival &quot;failure-time&quot; events and continuous or ordinal &quot;non-failure time&quot; events that are captured at specific time-points in the study.
</p>


<h3>Author(s)</h3>

<p>Kevin Duarte, 
Joao Pedro Ferreira
</p>
<p>Maintainer: Kevin Duarte &lt;k.duarte@chru-nancy.fr&gt;
</p>


<h3>References</h3>

<p>Pocock S.J., Ariti C.A., Collier T.J., Wang D. The win ratio: a new approach to the analysis of composite endpoints in clinical trials based on clinical priorities. <em>Eur Heart Journal</em>. 2012; <b>33</b>:176-182.
DOI: <a href="https://doi.org/10.1093/eurheartj/ehr352">10.1093/eurheartj/ehr352</a>.
</p>
<p>Bebu I. and Lachin J.M. Large sample inference for a win ratio analysis of a composite outcome based on prioritized components. <em>Biostatistics</em>. 2016; <b>17</b>:178-187.
DOI: <a href="https://doi.org/10.1093/biostatistics/kxv032">10.1093/biostatistics/kxv032</a>.
</p>

<hr>
<h2 id='is.binary'>Binary Vectors</h2><span id='topic+is.binary'></span>

<h3>Description</h3>

<p>is.binary is used to test if a vector is of binary type, i.e. if a vector contains only 0 and/or 1 values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.binary(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.binary_+3A_x">x</code></td>
<td>
<p>a vector to be tested.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>is.binary returns TRUE or FALSE depending on whether a vector is of binary type or not.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 &lt;- runif(100, 0, 1)
x2 &lt;- ifelse(x1 &lt; 0.5, 1, 0)
is.binary(x1)
is.binary(x2)
</code></pre>

<hr>
<h2 id='summary.WinRatio'>Summarizing Win Ratio Results</h2><span id='topic+summary.WinRatio'></span>

<h3>Description</h3>

<p>This function is used for summarizing the results for class <code>'WinRatio'</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'WinRatio'
summary(object, ..., digits = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.WinRatio_+3A_object">object</code></td>
<td>
<p>an object of class <code>'WinRatio'</code>.</p>
</td></tr>
<tr><td><code id="summary.WinRatio_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
<tr><td><code id="summary.WinRatio_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing win ratio and 95% confidence interval.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## For examples see example(winratio)
</code></pre>

<hr>
<h2 id='winratio'>Win Ratio for Prioritized Outcomes and 95% Confidence Interval</h2><span id='topic+winratio'></span>

<h3>Description</h3>

<p>Calculate the win ratio for prioritized outcomes and the 95% confidence interval based on Bebu and Lachin (2016). Three type of outcomes can be analyzed: survival &quot;failure-time&quot; events, repeated survival &quot;failure-time&quot; events and continuous or ordinal &quot;non-failure time&quot; events that are captured at specific time-points in the study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>winratio(id, trt, active = NULL, outcomes, fu, data, keep.matrix = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="winratio_+3A_id">id</code></td>
<td>

<p>a string indicating the patient ID variable. The patient ID variable must not contain missing values or duplicates.
</p>
</td></tr>
<tr><td><code id="winratio_+3A_trt">trt</code></td>
<td>

<p>a string indicating the treatment variable. The variable can be of any type (binary, numeric, character, factor) and must imperatively have 2 unique values/levels.
</p>
</td></tr>
<tr><td><code id="winratio_+3A_active">active</code></td>
<td>

<p>a numeric or string value used to define the active treatment group for the calculation of the win ratio. If <code>active = NULL</code> (default value), active group is automatically determined according to the type of treatment variable:
</p>

<ul>
<li><p> binary variable: active group = 1.
</p>
</li>
<li><p> numeric variable: active group = maximum value.
</p>
</li>
<li><p> character variable: active group = last string after sorting the character variable in ascending order.
</p>
</li>
<li><p> factor variable: active group = last level.
</p>
</li></ul>

</td></tr>
<tr><td><code id="winratio_+3A_outcomes">outcomes</code></td>
<td>
<p>a list used to define all outcomes in order of priority. 
The first element to be defined must be the outcome considered as being of greater clinical importance, usually this outcome is a fatal event. 
Each element must be a character vector of length 3 or a character list of length 3 depending on the type of outcome (survival event, repeated survival event, continuous or ordinal event): 
</p>

<ul>
<li>
<p>for survival events, the element is a character vector <code>c(x, "s", y)</code>, where <code>x</code> is a string indicating the name of the event variable, <code>"s"</code> indicating that this outcome is a &quot;failure-time&quot; event, and <code>y</code> is a string indicating the name of the time-to-event variable.
 
</p>
</li>
<li>
<p>for repeated survival events, note <code>k</code> the maximum number of events observed during follow-up, the element is a character list <code>list(x, "r", y)</code>, where <code>x = c(x1, ..., xk)</code> is a character vector of length <code>k</code> indicating the name of event variables, <code>"r"</code> indicating that this outcome is a &quot;failure-time&quot; repeated event, and <code>y = c(y1, ..., yk)</code> is a character vector of length <code>k</code> indicating the name of time-to-event variables corresponding to the event variables.

</p>
</li>
<li>
<p>for continuous or ordinal events, the element is a character vector <code>c(x, "c", d)</code>, where <code>x</code> is a string indicating the name of the continuous or ordinal variable, <code>"c"</code> indicating that this outcome is a continuous or ordinal event, and <code>d</code> is a string with two options <code>"&lt;"</code> or <code>"&gt;"</code> indicating the direction of deterioration or worsening.

</p>
</li></ul>

</td></tr>
<tr><td><code id="winratio_+3A_fu">fu</code></td>
<td>

<p>a string indicating the name of the follow-up time variable.
</p>
</td></tr>
<tr><td><code id="winratio_+3A_data">data</code></td>
<td>

<p>a data frame containing all the variables listed in the <code>id</code>, <code>trt</code>, <code>outcomes</code> and <code>fu</code> arguments.
</p>
</td></tr>
<tr><td><code id="winratio_+3A_keep.matrix">keep.matrix</code></td>
<td>

<p>a logical value indicating if the 'win-loss' matrix is kept. Default value is <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>'win-loss' matrix</h4>

<p>Let <code>n1</code> the number of patients in the active group and <code>n0</code> the number of patients in the other group. 
The 'win-loss' matrix is a matrix <code>M</code> of dimension <code>n1 x n0</code> with its element <code>M[i,j]</code> is defined as:
</p>
<p><code>M[i,j] = 1</code> if <code>i</code> wins against <code>j</code> on 1st outcome,
</p>
<p><code>M[i,j] = -1</code> if <code>i</code> loses against <code>j</code> on 1st outcome,
</p>
<p><code>M[i,j] = k</code> if <code>i</code> wins on outcome <code>k</code> after ties with <code>j</code> on outcomes <code>1</code> to <code>(k-1)</code>,
</p>
<p><code>M[i,j] = -k</code> if <code>i</code> loses on outcome <code>k</code> after ties with <code>j</code> on outcomes <code>1</code> to <code>(k-1)</code>,
</p>
<p><code>M[i,j] = 0</code> if <code>i</code> and <code>j</code> ties on all outcomes.
</p>



<h3>Value</h3>

<table role = "presentation">
<tr><td><code>call</code></td>
<td>

<p>a list with all arguments entered <code>list(id, trt, active, outcomes, fu, data, keep.matrix)</code>.
</p>
</td></tr>
<tr><td><code>group1</code></td>
<td>

<p>the value/level of the active group (group 1).
</p>
</td></tr>
<tr><td><code>group0</code></td>
<td>

<p>the value/level of the other group (group 0).
</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>

<p>the number of subjects in group 1.</p>
</td></tr>
<tr><td><code>n0</code></td>
<td>

<p>the number of subjects in group 0.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>

<p>the total number of subjects.</p>
</td></tr>
<tr><td><code>wins</code></td>
<td>

<p>a vector of numbers of 'winners' for each outcome.
</p>
</td></tr>
<tr><td><code>loss</code></td>
<td>

<p>a vector of numbers of 'losers' for each outcome.
</p>
</td></tr>
<tr><td><code>total.wins</code></td>
<td>

<p>the total number of 'winners'.
</p>
</td></tr>
<tr><td><code>total.loss</code></td>
<td>

<p>the total number of 'losers'.
</p>
</td></tr>
<tr><td><code>total.ties</code></td>
<td>

<p>the total number of ties.
</p>
</td></tr>
<tr><td><code>wr</code></td>
<td>

<p>the win ratio.
</p>
</td></tr>
<tr><td><code>v</code></td>
<td>

<p>the estimated variance of win ratio.
</p>
</td></tr>
<tr><td><code>z</code></td>
<td>

<p>the value of the test statistic.
</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>

<p>the p-value of the test.
</p>
</td></tr>
<tr><td><code>wr.lower</code></td>
<td>

<p>the lower end of the 95% confidence interval.
</p>
</td></tr>
<tr><td><code>wr.upper</code></td>
<td>

<p>the upper end of the 95% confidence interval.
</p>
</td></tr>
<tr><td><code>wr.matrix</code></td>
<td>

<p>the 'win-loss' matrix (only if <code>keep.matrix = T</code>). See details above.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Load survival package to use the dataset 'bladder1'
library(survival)

# Creation of dataset 'df' with 3 outcomes:
#   Outcome 1: death (survival event)
#   Outcome 2: cancer recurrence (repeated survival event)
#   Outcome 3: size of largest initial tumour (continuous event) 
data1 &lt;- bladder1  %&gt;%  
  mutate(trt = if_else(treatment == "placebo", "Placebo", "Treatment")) %&gt;%
  group_by(id) %&gt;% 
  mutate(death = if_else(max(status) %in% c(2, 3), 1, 0),
         t2death = max(stop)) %&gt;% 
  ungroup() %&gt;%
  select(id, trt, death, t2death, number, size) %&gt;% 
 unique()

data2 &lt;- bladder1 %&gt;% 
  filter(status == 1) %&gt;% 
  select(id, t2recurr = stop) %&gt;%
  mutate(recurr = 1) %&gt;% 
  arrange(id, t2recurr) %&gt;% 
  group_by(id) %&gt;% 
  mutate(nrecurr = row_number()) %&gt;% 
  ungroup() %&gt;% 
  full_join((data1 %&gt;% select(id)), by = "id") %&gt;% 
  complete(id, nrecurr) %&gt;%
  filter(!is.na(nrecurr)) %&gt;% 
  full_join((data1 %&gt;% select(id, t2death)), by = "id") %&gt;% 
  mutate(
    recurr = replace(recurr, is.na(recurr), 0),
    t2recurr = if_else(is.na(t2recurr), t2death, t2recurr)
  ) %&gt;% 
  select(id, nrecurr, recurr, t2recurr)

data3 &lt;- data2 %&gt;% 
  pivot_wider(id_cols = "id", names_from =  nrecurr, 
              values_from = recurr, names_prefix  = "recurr") 

data4 &lt;- data2 %&gt;% 
  pivot_wider(id_cols = "id", names_from =  nrecurr, 
              values_from = t2recurr, names_prefix  = "t2recurr") 

data5 &lt;- full_join(data3, data4, by = "id")

df &lt;- full_join(data1, data5, by = "id")

# Calculate the win ratio
wr &lt;- winratio(id = "id", trt = "trt", active = "Treatment", 
               outcomes = list(outc1 = c("death", "s", "t2death"),
                               outc2 = list(paste0("recurr", 1:9), "r", paste0("t2recurr", 1:9)),
                               outc3 = c("size", "c", "&gt;")), 
               fu = "t2death", data = df)
summary(wr)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
