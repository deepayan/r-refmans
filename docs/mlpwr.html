<!DOCTYPE html><html><head><title>Help for package mlpwr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mlpwr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#example.simfun'><p>Example simulation functions</p></a></li>
<li><a href='#extensions_results'><p>Results of the extensions vignette</p></a></li>
<li><a href='#find.design'><p>Find optimal study designs</p></a></li>
<li><a href='#plot.designresult'><p>Plot search result</p></a></li>
<li><a href='#print.summary.designresult'><p>Print Summary of the search result</p></a></li>
<li><a href='#simulations_data'><p>Display info on the generated data</p></a></li>
<li><a href='#summary.designresult'><p>Summary of the search result</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>A Power Analysis Toolbox to Find Cost-Efficient Study Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>We implement a surrogate modeling algorithm to guide simulation-based
    sample size planning. The method is described in detail in a recent preprint
    (Zimmer &amp; Debelak (2022) &lt;<a href="https://doi.org/10.31234%2Fosf.io%2Ftnhb2">doi:10.31234/osf.io/tnhb2</a>&gt;).
    It supports multiple study design parameters and optimization with respect to a
    cost function. It can find optimal designs that correspond to a desired 
    statistical power or that fulfill a cost constraint.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/flxzimmer/mlpwr">https://github.com/flxzimmer/mlpwr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/flxzimmer/mlpwr/issues">https://github.com/flxzimmer/mlpwr/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, stats, DiceKriging, digest, ggplot2, randtoolbox,
rlist, WeightSVM, rgenoud</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, lme4, lmerTest, mirt, pwr, rmarkdown, simr, sn, tidyr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-07 10:29:51 UTC; felix</td>
</tr>
<tr>
<td>Author:</td>
<td>Felix Zimmer <a href="https://orcid.org/0000-0002-8127-0007"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Rudolf Debelak <a href="https://orcid.org/0000-0001-8900-2106"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felix Zimmer &lt;felix.zimmer@mail.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-07 10:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='example.simfun'>Example simulation functions</h2><span id='topic+example.simfun'></span>

<h3>Description</h3>

<p>These simulation functions can be loaded as examples or templates. They correspond to the functions in the 'simulation_functions' vignette. The vignette contains the code and a description of the simfuns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example.simfun(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="example.simfun_+3A_name">name</code></td>
<td>
<p>Name of the simulation function as a character. Currently available are: 'ttest','anova','glm2','irt1','irt2','multi2'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The returned object is the simulation function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simfun = example.simfun('ttest')
simfun(400)

</code></pre>

<hr>
<h2 id='extensions_results'>Results of the extensions vignette</h2><span id='topic+extensions_results'></span>

<h3>Description</h3>

<p>Since the Monte Carlo simulations required to generate the results in the extensions vignette can be time-consuming, we have precomputed them and included them as a data file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extensions_results
</code></pre>


<h3>Format</h3>

<p>A list with designresult objects created in the vignette &quot;extensions&quot;
</p>

<hr>
<h2 id='find.design'>Find optimal study designs</h2><span id='topic+find.design'></span>

<h3>Description</h3>

<p>Perform a surrogate modeling approach to search for optimal study design parameters. For further guidance on how to use the package and the <code>find.design</code> function specifically, see the <a href="https://github.com/flxzimmer/mlpwr">Readme.md file</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.design(
  simfun,
  boundaries,
  power = NULL,
  evaluations = 4000,
  ci = NULL,
  ci_perc = 0.95,
  time = NULL,
  costfun = NULL,
  cost = NULL,
  surrogate = NULL,
  n.startsets = 4,
  init.perc = 0.2,
  setsize = NULL,
  continue = NULL,
  dat = NULL,
  silent = FALSE,
  autosave_dir = NULL,
  control = list(),
  goodvals = "high",
  aggregate_fun = mean,
  noise_fun = "bernoulli",
  integer = TRUE,
  use_noise = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.design_+3A_simfun">simfun</code></td>
<td>
<p>function to generate hypothesis test results with. Takes design parameters as input and outputs a logical (result of the hypothesis test). The function can take the designs through one argument as a vector or through multiple arguments. For example, function(x) where x is later used with x=c(n,k) for two design parameters n and k is valid. Also valid is a definition using function(n,k).</p>
</td></tr>
<tr><td><code id="find.design_+3A_boundaries">boundaries</code></td>
<td>
<p>list containing lower and upper bounds of the design space. The list should consist of named vectors, each containing the upper and lower bound for the respective design parameter dimensions. For one design parameter dimension, can also be a vector containing the upper and lower bounds.</p>
</td></tr>
<tr><td><code id="find.design_+3A_power">power</code></td>
<td>
<p>numeric; desired statistical power</p>
</td></tr>
<tr><td><code id="find.design_+3A_evaluations">evaluations</code></td>
<td>
<p>integer; number of simfun evaluations to be performed before termination</p>
</td></tr>
<tr><td><code id="find.design_+3A_ci">ci</code></td>
<td>
<p>numeric; desired width of the confidence interval at the predicted value on termination.</p>
</td></tr>
<tr><td><code id="find.design_+3A_ci_perc">ci_perc</code></td>
<td>
<p>numeric; specifying the desired confidence interval, e.g. 95% or 99%.</p>
</td></tr>
<tr><td><code id="find.design_+3A_time">time</code></td>
<td>
<p>integer; seconds until termination</p>
</td></tr>
<tr><td><code id="find.design_+3A_costfun">costfun</code></td>
<td>
<p>function that takes a vector of design parameters as input and outputs a cost, e.g. monetary costs. Necessary for simfuns with multiple input dimensions.</p>
</td></tr>
<tr><td><code id="find.design_+3A_cost">cost</code></td>
<td>
<p>numeric; cost threshold. Design parameter set with highest power is searched among sets that fulfill this cost threshold.</p>
</td></tr>
<tr><td><code id="find.design_+3A_surrogate">surrogate</code></td>
<td>
<p>character; which surrogate model should be used. The default is 'logreg' for one design parameter and 'gpr' for multiple design parameters. The current options are: 'gpr', 'svr', 'logreg', 'reg' for one-dimensional designs and 'gpr' and 'svr' for multi-dimensional designs.</p>
</td></tr>
<tr><td><code id="find.design_+3A_n.startsets">n.startsets</code></td>
<td>
<p>integer; number of startsets used per dimension of simfun</p>
</td></tr>
<tr><td><code id="find.design_+3A_init.perc">init.perc</code></td>
<td>
<p>numeric; percentage of evaluations used for the initialization phase</p>
</td></tr>
<tr><td><code id="find.design_+3A_setsize">setsize</code></td>
<td>
<p>The number of draws from the simfun in each iteration</p>
</td></tr>
<tr><td><code id="find.design_+3A_continue">continue</code></td>
<td>
<p>Object of class designresult as created by the find.design function. Will be used to continue the search, using all collected simulation results so far.</p>
</td></tr>
<tr><td><code id="find.design_+3A_dat">dat</code></td>
<td>
<p>list of data from a previous design result.</p>
</td></tr>
<tr><td><code id="find.design_+3A_silent">silent</code></td>
<td>
<p>logical; suppresses output during the search.</p>
</td></tr>
<tr><td><code id="find.design_+3A_autosave_dir">autosave_dir</code></td>
<td>
<p>character; file location for saving the dat object after each update.</p>
</td></tr>
<tr><td><code id="find.design_+3A_control">control</code></td>
<td>
<p>list specifying arguments passed to the surrogate models. For example, list(covtype='gauss') can be used with the gpr surrogate to use a different covariance structure than the default.</p>
</td></tr>
<tr><td><code id="find.design_+3A_goodvals">goodvals</code></td>
<td>
<p>character indicating whether higher or lower criterion values are preferable given equal cost; the default is &quot;high&quot; for statistical power, the other option is &quot;low&quot;.</p>
</td></tr>
<tr><td><code id="find.design_+3A_aggregate_fun">aggregate_fun</code></td>
<td>
<p>function to aggregate results of the evaluations of the simulation function; the default is <code>mean</code>, as for statistical power.</p>
</td></tr>
<tr><td><code id="find.design_+3A_noise_fun">noise_fun</code></td>
<td>
<p>function to calculate the noise or variance of the aggregated results of the Monte Carlo evaluations; can also be the character value &quot;bernoulli&quot; (default) to indicate the variance of the Bernoulli distribution used for statistical power. This function is <code class="reqn">p(1-p)/n</code>, where <code class="reqn">p</code> is the statistical power and <code class="reqn">n</code> is the number of performed evaluations.</p>
</td></tr>
<tr><td><code id="find.design_+3A_integer">integer</code></td>
<td>
<p>logical  indicating whether the design parameters are integers or not; the default is <code>TRUE</code>, which is suitable for sample size, for example.</p>
</td></tr>
<tr><td><code id="find.design_+3A_use_noise">use_noise</code></td>
<td>
<p>logical indicating whether noise variance should be used; the default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>function returns an object of class designresult
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## T-test example:

# Load a simulation function
simfun &lt;- example.simfun('ttest')
# Perform the search
ds &lt;- find.design(simfun = simfun, boundaries = c(100,300), power = .95)
# Output the results
summary(ds)
# Plot results
plot(ds)

## Two-dimensional simulation function:

simfun &lt;- example.simfun('anova')
# Perform the search
ds &lt;- find.design(simfun = simfun,
 costfun = function(n,n.groups) 5*n+20*n.groups,
 boundaries = list(n = c(10, 150), n.groups = c(5, 30)),
 power = .95)
# Output the results
summary(ds)
# Plot results
plot(ds)


##  Mixed model example with a custom, two-dimensional simulation function:

library(lme4)
library(lmerTest)

# Simulation function
simfun_multilevel &lt;- function(n.per.school,n.schools) {

  # generate data
  group = rep(1:n.schools,each=n.per.school)
  pred = factor(rep(c("old","new"),n.per.school*n.schools),levels=c("old","new"))
  dat = data.frame(group = group, pred = pred)

  params &lt;- list(theta = c(.5,0,.5), beta = c(0,1),sigma = 1.5)
  names(params$theta) = c("group.(Intercept)","group.prednew.(Intercept)","group.prednew")
  names(params$beta) = c("(Intercept)","prednew")
  dat$y &lt;- simulate.formula(~pred + (1 + pred | group), newdata = dat, newparams = params)[[1]]

  # test hypothesis
  mod &lt;- lmer(y ~ pred + (1 + pred | group), data = dat)
  pvalue &lt;- summary(mod)[["coefficients"]][2,"Pr(&gt;|t|)"]
  pvalue &lt; .01
}
# Cost function
costfun_multilevel &lt;- function(n.per.school, n.schools) {
  100 * n.per.school + 200 * n.schools
}
# Perform the search, can take a few minutes to run
ds &lt;- find.design(simfun = simfun_multilevel, costfun = costfun_multilevel,
boundaries = list(n.per.school = c(5, 25), n.schools = c(10, 30)), power = .95,
evaluations = 1000)
# Output the results
summary(ds)
# Plot results
plot(ds)


</code></pre>

<hr>
<h2 id='plot.designresult'>Plot search result</h2><span id='topic+plot.designresult'></span>

<h3>Description</h3>

<p>Plot a one- or two-dimensional graph of the result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designresult'
plot(
  x,
  design = NULL,
  adderrorbars = NULL,
  addribbon = NULL,
  trim = TRUE,
  type = "heat",
  color.width = 0.15,
  color.gradient = "diverging",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.designresult_+3A_x">x</code></td>
<td>
<p>Object of class designresult as created by the find.design function.</p>
</td></tr>
<tr><td><code id="plot.designresult_+3A_design">design</code></td>
<td>
<p>Specify a design as a list. Can be used to make a 1D plot for a two-dimensional simfun. Set NA for the dimension that should be plotted and set a value for all others. For example: design=list(n=NA,k=9)</p>
</td></tr>
<tr><td><code id="plot.designresult_+3A_adderrorbars">adderrorbars</code></td>
<td>
<p>logical. Plots errorbars in the 1D plot if TRUE. Default is FALSE (also if specified as NULL).</p>
</td></tr>
<tr><td><code id="plot.designresult_+3A_addribbon">addribbon</code></td>
<td>
<p>logical. Adds ribbon in the 1D plot if TRUE. Default is TRUE (also if specified as NULL).</p>
</td></tr>
<tr><td><code id="plot.designresult_+3A_trim">trim</code></td>
<td>
<p>logical. Option to trim the plotting area for the 2D line plot. The trimmed area is the area where the line is plotted. Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot.designresult_+3A_type">type</code></td>
<td>
<p>character indicating the type of the 2D plot. Can be 'heat'(default) or 'line'.</p>
</td></tr>
<tr><td><code id="plot.designresult_+3A_color.width">color.width</code></td>
<td>
<p>numeric. Option for the diverging colormap in the 2D plot. Width of the blue-white colorband.</p>
</td></tr>
<tr><td><code id="plot.designresult_+3A_color.gradient">color.gradient</code></td>
<td>
<p>character indicating whether the 2D plot should have a &quot;diverging&quot; color gradient (white-blue-white, default) or a &quot;linear&quot; color gradient (blue-red)</p>
</td></tr>
<tr><td><code id="plot.designresult_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load a simulation function
simfun = example.simfun('ttest')
# Perform the search
ds = find.design(simfun = simfun, boundaries = c(100,300), power = .95)
# Plot results
plot(ds)
</code></pre>

<hr>
<h2 id='print.summary.designresult'>Print Summary of the search result</h2><span id='topic+print.summary.designresult'></span>

<h3>Description</h3>

<p>Print Summary of the search result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.designresult'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.designresult_+3A_x">x</code></td>
<td>
<p>Object of class designresult as created by the find.design function</p>
</td></tr>
<tr><td><code id="print.summary.designresult_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class summary.designresult
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load a simulation function
simfun = example.simfun('ttest')
# Perform the search
ds = find.design(simfun = simfun, boundaries = c(100,300), power = .95)
# Output the results
summary(ds)
</code></pre>

<hr>
<h2 id='simulations_data'>Display info on the generated data</h2><span id='topic+simulations_data'></span>

<h3>Description</h3>

<p>Output a data frame that, for each set of design parameters, includes the cost, the estimated power and SE, the surrogate model estimated power and SE, and the number of performed evaluations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulations_data(ds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulations_data_+3A_ds">ds</code></td>
<td>
<p>Object of class designresult as created by the find.design function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The raw power is estimated using the ratio of significant hypothesis tests among the performed evaluations. The raw SE is estimated using <code class="reqn">p(1-p)/n</code> with <code class="reqn">p</code> being the raw power and <code class="reqn">n</code> being the number of performed evaluations.
</p>
<p>For the estimation of SE using a surrogate model, GPR is employed because it is capable of variance estimation, unlike the other surrogate models.
</p>


<h3>Value</h3>

<p>A data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load a simulation function
simfun &lt;- example.simfun('ttest')
# Perform the search
ds &lt;- find.design(simfun = simfun, boundaries = c(100,300), power = .95)
# Display more info on the collected data
simulations_data(ds)

</code></pre>

<hr>
<h2 id='summary.designresult'>Summary of the search result</h2><span id='topic+summary.designresult'></span>

<h3>Description</h3>

<p>Produce summary statistics of the results and the algorithm run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'designresult'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.designresult_+3A_object">object</code></td>
<td>
<p>Object of class designresult as created by the find.design function</p>
</td></tr>
<tr><td><code id="summary.designresult_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class summary.designresult
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load a simulation function
simfun = example.simfun('ttest')
# Perform the search
ds = find.design(simfun = simfun, boundaries = c(100,300), power = .95)
# Output the results
summary(ds)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
