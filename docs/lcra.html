<!DOCTYPE html><html><head><title>Help for package lcra</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lcra}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#express'><p>Small simulated data set</p></a></li>
<li><a href='#latent3'><p>Simulated data set number 2 (continuous regression outcome)</p></a></li>
<li><a href='#latent3_binary'><p>Simulated data set number 2 (discrete regression outcome)</p></a></li>
<li><a href='#lcra'><p>Joint Bayesian Latent Class and Regression Analysis</p></a></li>
<li><a href='#paper_sim'><p>Simulated data set (continuous regression outcome)</p></a></li>
<li><a href='#paper_sim_binary'><p>Simulated data set (discrete regression outcome)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1.5</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Joint Latent Class and Regression Models</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Description:</td>
<td>For fitting Bayesian joint latent class and regression models using
    Gibbs sampling. See the documentation for the model.
    The technical details of the model implemented here are described in Elliott,
    Michael R., Zhao, Zhangchen, Mukherjee, Bhramar, Kanaya, Alka, Needham,
    Belinda L., "Methods to account for uncertainty in latent class assignments when
    using latent classes as predictors in regression models, with application to
    acculturation strategy measures" (2020) In press at Epidemiology
    &lt;<a href="https://doi.org/10.1097%2FEDE.0000000000001139">doi:10.1097/EDE.0000000000001139</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rlang, coda, rjags</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R2WinBUGS, gtools</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS 4.x.y or WinBUGS 1.4</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/umich-biostatistics/lcra">https://github.com/umich-biostatistics/lcra</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/umich-biostatistics/lcra/issues">https://github.com/umich-biostatistics/lcra/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-05 21:42:15 UTC; mk</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Elliot [aut],
  Zhangchen Zhao [aut],
  Michael Kleinsasser [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Kleinsasser &lt;biostat-cran-manager@umich.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-08 17:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='express'>Small simulated data set</h2><span id='topic+express'></span>

<h3>Description</h3>

<p>Simulated data set with continuous regression outcome. The data set contains
150 observations of 8 variables, which include 5 manifest variables,
and two regressors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>express
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 150 rows and 8 columns.
</p>


<h3>Details</h3>


<dl>
<dt>y </dt><dd><p>Discrete regression outcome of interest</p>
</dd>
<dt>Z1 </dt><dd><p>Categorical manifest variable 1</p>
</dd>
<dt>Z2 </dt><dd><p>Categorical manifest variable 2</p>
</dd>
<dt>Z3 </dt><dd><p>Categorical manifest variable 3</p>
</dd>
<dt>Z4 </dt><dd><p>Categorical manifest variable 4</p>
</dd>
<dt>Z5 </dt><dd><p>Categorical manifest variable 5</p>
</dd>
<dt>x1 </dt><dd><p>Continuous predictor variable</p>
</dd>
<dt>x2 </dt><dd><p>Continuous predictor variable</p>
</dd>
</dl>


<hr>
<h2 id='latent3'>Simulated data set number 2 (continuous regression outcome)</h2><span id='topic+latent3'></span>

<h3>Description</h3>

<p>Simulated data set with continuous regression outcome. The data set contains
350 observations of 16 variables, which include 12 manifest variables,
and four regressors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latent3
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 350 rows and 17 columns.
</p>


<h3>Details</h3>


<dl>
<dt>y </dt><dd><p>Discrete regression outcome of interest</p>
</dd>
<dt>Z1 </dt><dd><p>Categorical manifest variable 1</p>
</dd>
<dt>Z2 </dt><dd><p>Categorical manifest variable 2</p>
</dd>
<dt>Z3 </dt><dd><p>Categorical manifest variable 3</p>
</dd>
<dt>Z4 </dt><dd><p>Categorical manifest variable 4</p>
</dd>
<dt>Z5 </dt><dd><p>Categorical manifest variable 5</p>
</dd>
<dt>Z6 </dt><dd><p>Categorical manifest variable 6</p>
</dd>
<dt>Z7 </dt><dd><p>Categorical manifest variable 7</p>
</dd>
<dt>Z8 </dt><dd><p>Categorical manifest variable 8</p>
</dd>
<dt>Z9 </dt><dd><p>Categorical manifest variable 9</p>
</dd>
<dt>Z10 </dt><dd><p>Categorical manifest variable 10</p>
</dd>
<dt>Z11 </dt><dd><p>Categorical manifest variable 11</p>
</dd>
<dt>Z12 </dt><dd><p>Categorical manifest variable 12</p>
</dd>
<dt>x1 </dt><dd><p>Continuous predictor variable</p>
</dd>
<dt>x2 </dt><dd><p>Continuous predictor variable</p>
</dd>
<dt>x3 </dt><dd><p>Continuous predictor variable</p>
</dd>
<dt>x4 </dt><dd><p>Continuous predictor variable</p>
</dd>
</dl>


<hr>
<h2 id='latent3_binary'>Simulated data set number 2 (discrete regression outcome)</h2><span id='topic+latent3_binary'></span>

<h3>Description</h3>

<p>Simulated data set with discrete regression outcome. The data set contains
350 observations of 16 variables, which include 12 manifest variables,
and four regressors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>latent3_binary
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 350 rows and 17 columns.
</p>


<h3>Details</h3>


<dl>
<dt>y </dt><dd><p>Discrete regression outcome of interest</p>
</dd>
<dt>Z1 </dt><dd><p>Categorical manifest variable 1</p>
</dd>
<dt>Z2 </dt><dd><p>Categorical manifest variable 2</p>
</dd>
<dt>Z3 </dt><dd><p>Categorical manifest variable 3</p>
</dd>
<dt>Z4 </dt><dd><p>Categorical manifest variable 4</p>
</dd>
<dt>Z5 </dt><dd><p>Categorical manifest variable 5</p>
</dd>
<dt>Z6 </dt><dd><p>Categorical manifest variable 6</p>
</dd>
<dt>Z7 </dt><dd><p>Categorical manifest variable 7</p>
</dd>
<dt>Z8 </dt><dd><p>Categorical manifest variable 8</p>
</dd>
<dt>Z9 </dt><dd><p>Categorical manifest variable 9</p>
</dd>
<dt>Z10 </dt><dd><p>Categorical manifest variable 10</p>
</dd>
<dt>Z11 </dt><dd><p>Categorical manifest variable 11</p>
</dd>
<dt>Z12 </dt><dd><p>Categorical manifest variable 12</p>
</dd>
<dt>x1 </dt><dd><p>Continuous predictor variable</p>
</dd>
<dt>x2 </dt><dd><p>Continuous predictor variable</p>
</dd>
<dt>x3 </dt><dd><p>Continuous predictor variable</p>
</dd>
<dt>x4 </dt><dd><p>Continuous predictor variable</p>
</dd>
</dl>


<hr>
<h2 id='lcra'>Joint Bayesian Latent Class and Regression Analysis</h2><span id='topic+lcra'></span>

<h3>Description</h3>

<p>Given a set of categorical manifest outcomes, identify unmeasured class membership
among subjects, and use latent class membership to predict regression outcome
jointly with a set of regressors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lcra(
  formula,
  data,
  family,
  nclasses,
  manifest,
  sampler = "JAGS",
  inits = NULL,
  dir,
  n.chains = 3,
  n.iter = 2000,
  n.burnin = n.iter/2,
  n.thin = 1,
  n.adapt = 1000,
  useWINE = FALSE,
  WINE,
  debug = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lcra_+3A_formula">formula</code></td>
<td>
<p>If formula = NULL, LCA without regression model is fitted. If
a regression model is to be fitted, specify a formula using R standard syntax,
e.g., Y ~ age + sex + trt. Do not include manifest variables in the regression
model specification. These will be appended internally as latent classes.</p>
</td></tr>
<tr><td><code id="lcra_+3A_data">data</code></td>
<td>
<p>data.frame with the column names specified in the regression formula
and the manifest argument. The columns used in the regression formula can be of
any type and will be dealt with using normal R behaviour. The manifest variable
columns, however, must be coded as numeric using positive integers. For example,
if one of the manifest outcomes takes on values 'Dislike', 'Neutral',
and 'like', then code them as 1, 2, and 3.</p>
</td></tr>
<tr><td><code id="lcra_+3A_family">family</code></td>
<td>
<p>a description of the error distribution to
be used in the model. Currently the options are c(&quot;gaussian&quot;) with identity
link and c(&quot;binomial&quot;) which uses a logit link.</p>
</td></tr>
<tr><td><code id="lcra_+3A_nclasses">nclasses</code></td>
<td>
<p>numeric, number of latent classes</p>
</td></tr>
<tr><td><code id="lcra_+3A_manifest">manifest</code></td>
<td>
<p>character vector containing the names of each manifest variable,
e.g., manifest = c(&quot;Z1&quot;, &quot;med_3&quot;, &quot;X5&quot;). The values of the manifest columns must
be numerically coded with levels 1 through n_levels, where n_levels is the number
of levels for the ith manifest variable. The function will throw an error message
if they are not coded properly.</p>
</td></tr>
<tr><td><code id="lcra_+3A_sampler">sampler</code></td>
<td>
<p>which MCMC sampler to use? lcra relies on Gibbs sampling,
where the options are &quot;WinBUGS&quot; or &quot;JAGS&quot;. sampler = &quot;JAGS&quot; is the default,
and is recommended</p>
</td></tr>
<tr><td><code id="lcra_+3A_inits">inits</code></td>
<td>
<p>list of initial values. Defaults will be set if nothing
is specified. Inits must be a list with n.chains elements; each element of the list
is itself a list of starting values for the model.</p>
</td></tr>
<tr><td><code id="lcra_+3A_dir">dir</code></td>
<td>
<p>Specify full path to the directory where you want
to store the model file.</p>
</td></tr>
<tr><td><code id="lcra_+3A_n.chains">n.chains</code></td>
<td>
<p>number of Markov chains.</p>
</td></tr>
<tr><td><code id="lcra_+3A_n.iter">n.iter</code></td>
<td>
<p>number of total iterations per chain including burn-in.</p>
</td></tr>
<tr><td><code id="lcra_+3A_n.burnin">n.burnin</code></td>
<td>
<p>length of burn-in, i.e., number of iterations to discard
at the beginning. Default is n.iter/2.</p>
</td></tr>
<tr><td><code id="lcra_+3A_n.thin">n.thin</code></td>
<td>
<p>thinning rate. Must be a positive integer. Set n.thin &gt; 1 to save
memory and computing time if n.iter is large.</p>
</td></tr>
<tr><td><code id="lcra_+3A_n.adapt">n.adapt</code></td>
<td>
<p>number of adaptive samples to take when using JAGS. See the
JAGS documentation for more information.</p>
</td></tr>
<tr><td><code id="lcra_+3A_usewine">useWINE</code></td>
<td>
<p>logical, attempt to use the Wine emulator to run WinBUGS, defaults
to FALSE on Windows and TRUE otherwise.</p>
</td></tr>
<tr><td><code id="lcra_+3A_wine">WINE</code></td>
<td>
<p>character, path to WINE binary file. If not provided, the program will
attempt to find the WINE installation on your machine.</p>
</td></tr>
<tr><td><code id="lcra_+3A_debug">debug</code></td>
<td>
<p>logical, keep WinBUGS open debug, inspect chains and summary.</p>
</td></tr>
<tr><td><code id="lcra_+3A_...">...</code></td>
<td>
<p>other arguments to bugs(). Run ?bugs to see list of possible
arguments to pass into bugs.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>lcra allows for two different Gibbs samplers to be used. The options are
WinBUGS or JAGS. If you are not on a Windows system, WinBUGS can be
very difficult to get working. For this reason, JAGS is the default.
</p>
<p>For further instructions on using WinBUGS, read this:
</p>

<ul>
<li><p> Microsoft Windows: no problems or additional set-up required
</p>
</li>
<li><p> Linux, Mac OS X, Unix: possible with the Wine emulator via useWine = TRUE.
Wine is a standalone program needed to emulate a Windows system on non-Windows
machines.
</p>
</li></ul>

<p>The manifest variable columns in <strong>data</strong> must be coded as numeric with positive
numbers. For example, if one of the manifest outcomes takes on values 'Dislike', 'Neutral',
and 'like', then code them as 1, 2, and 3.
</p>
<p><strong>Model Definition</strong>
</p>
<p>The LCRA model is as follows:
</p>
<p><img src="../help/figures/model1.png" alt="model1.png" />
<img src="../help/figures/model2.png" alt="model2.png" />
</p>
<p>The following priors are the default and cannot be altered by the user:
</p>
<p><img src="../help/figures/model3.png" alt="model3.png" />
<img src="../help/figures/model4.png" alt="model4.png" />
</p>
<p>Please note also that the reference category for latent classes in the outcome
model output is always the Jth latent class in the output, and the bugs
output is defined by the Latin equivalent of the model parameters
(beta, alpha, tau, pi, theta). Also, the bugs output includes the variable true,
which corresponds to the MCMC draws of C_i, i = 1,...,n, as well as the MCMC
draws of the deviance (DIC) statistic. Finally the bugs output for pi
is stored in a three dimensional array corresponding to (class, variable, category),
where category is indexed by 1 through maximum K_l; for variables where the number of
categories is less than maximum K_l, these cells will be set to NA. The parameters
outputted by the lcra function currently are not user definable.
</p>


<h3>Value</h3>

<p>Return type depends on the sampler chosen.
</p>
<p>If sampler = &quot;WinBUGS&quot;, then the return object is:
WinBUGS object and lists of draws and summaries. Use fit$ to browse options.
</p>
<p>If sampler = &quot;JAGS&quot;, then the return object is:
An MCMC list of class <strong>mcmc.list</strong>, which can be analyzed with the coda package.
Each column is a parameter and each row is a draw. You can extract a parameter
by name, e.g., fit[,&quot;beta[1]&quot;]. For a list of all parameter names from the fit,
call colnames(as.matrix(fit)), which returns a character vector with the names.
</p>


<h3>References</h3>

<p>&quot;Methods to account for uncertainty in latent class assignments
when using latent classes as predictors in regression models, with application
to acculturation strategy measures&quot; (2020) In press at Epidemiology.
doi:10.1097/EDE.0000000000001139
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("rjags")){

# quick example

inits = list(list(theta = c(0.33, 0.33, 0.34), beta = rep(0, length = 3), 
                  alpha = rep(0, length = 2), tau = 0.5, true = rep(1, length = nrow(express))))

fit = lcra(formula = y ~ x1 + x2, family = "gaussian", data = express,
           nclasses = 3, inits = inits, manifest = paste0("Z", 1:5),
           n.chains = 1, n.iter = 50)

data('paper_sim')

# Set initial values
inits =
  list(
    list(theta = c(0.33, 0.33, 0.34), beta = rep(0, length = 3),
         alpha = rep(0, length = 2), tau = 0.5, true = rep(1, length = 100)),
    list(theta = c(0.33, 0.33, 0.34), beta = rep(0, length = 3),
         alpha = rep(0, length = 2), tau = 0.5, true = rep(1, length = 100)),
    list(theta = c(0.33, 0.33, 0.34), beta = rep(0, length = 3),
         alpha = rep(0, length = 2), tau = 0.5, true = rep(1, length = 100))
  )

# Fit model 1
fit.gaus_paper = lcra(formula = Y ~ X1 + X2, family = "gaussian",
                      data = paper_sim, nclasses = 3, manifest = paste0("Z", 1:10),
                      inits = inits, n.chains = 3, n.iter = 5000)

# Model 1 results
library(coda)

summary(fit.gaus_paper)
plot(fit.gaus_paper)


# simulated examples

library(gtools) # for Dirichel distribution

# with binary response 

n &lt;- 500

X1 &lt;- runif(n, 2, 8)
X2 &lt;- rbinom(n, 1, .5)
Cstar &lt;- rnorm(n, .25 * X1 - .75 * X2, 1)
C &lt;- 1 * (Cstar &lt;= .8) + 2 * ((Cstar &gt; .8) &amp; (Cstar &lt;= 1.6)) + 3 * (Cstar &gt; 1.6)

pi1 &lt;- rdirichlet(10, c(5, 4, 3, 2, 1))
pi2 &lt;- rdirichlet(10, c(1, 3, 5, 3, 1))
pi3 &lt;- rdirichlet(10, c(1, 2, 3, 4, 5))

Z1&lt;-(C==1)*t(rmultinom(n,1,pi1[1,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[1,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[1,]))%*%c(1:5)
Z2&lt;-(C==1)*t(rmultinom(n,1,pi1[2,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[2,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[2,]))%*%c(1:5)
Z3&lt;-(C==1)*t(rmultinom(n,1,pi1[3,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[3,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[3,]))%*%c(1:5)
Z4&lt;-(C==1)*t(rmultinom(n,1,pi1[4,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[4,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[4,]))%*%c(1:5)
Z5&lt;-(C==1)*t(rmultinom(n,1,pi1[5,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[5,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[5,]))%*%c(1:5)
Z6&lt;-(C==1)*t(rmultinom(n,1,pi1[6,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[6,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[6,]))%*%c(1:5)
Z7&lt;-(C==1)*t(rmultinom(n,1,pi1[7,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[7,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[7,]))%*%c(1:5)
Z8&lt;-(C==1)*t(rmultinom(n,1,pi1[8,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[8,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[8,]))%*%c(1:5)
Z9&lt;-(C==1)*t(rmultinom(n,1,pi1[9,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[9,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[9,]))%*%c(1:5)
Z10&lt;-(C==1)*t(rmultinom(n,1,pi1[10,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[10,]))%*%c(1:5)+(C==3)*t(rmultinom(n,1,pi3[10,]))%*%c(1:5)

Z &lt;- cbind(Z1, Z2, Z3, Z4, Z5, Z6, Z7, Z8, Z9, Z10)

Y &lt;- rbinom(n, 1, exp(-1 - .1*X1 + X2 + 2*(C == 1) + 1*(C == 2)) / 
              (1 + exp(1 - .1*X1 + X2 + 2*(C == 1) + 1*(C == 2))))

mydata = data.frame(Y, X1, X2, Z1, Z2, Z3, Z4, Z5, Z6, Z7, Z8, Z9, Z10)

inits = list(list(theta = c(0.33, 0.33, 0.34), beta = rep(0, length = 3),
                  alpha = rep(0, length = 2), true = rep(1, length = nrow(mydata))))

fit = lcra(formula = Y ~ X1 + X2, family = "binomial", data = mydata,
           nclasses = 3, inits = inits, manifest = paste0("Z", 1:10),
           n.chains = 1, n.iter = 1000)

summary(fit)
plot(fit)

# with continuous response

n &lt;- 500

X1 &lt;- runif(n, 2, 8)
X2 &lt;- rbinom(n, 1, .5)
Cstar &lt;- rnorm(n, .25*X1 - .75*X2, 1)
C &lt;- 1 * (Cstar &lt;= .8) + 2*((Cstar &gt; .8) &amp; (Cstar &lt;= 1.6)) + 3*(Cstar &gt; 1.6)

pi1 &lt;- rdirichlet(10, c(5, 4, 3, 2, 1))
pi2 &lt;- rdirichlet(10, c(1, 3, 5, 3, 1))
pi3 &lt;- rdirichlet(10, c(1, 2, 3, 4, 5))
pi4 &lt;- rdirichlet(10, c(1, 1, 1, 1, 1))

Z1&lt;-(C==1)*t(rmultinom(n,1,pi1[1,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[1,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[1,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[1,]))%*%c(1:5)
Z2&lt;-(C==1)*t(rmultinom(n,1,pi1[2,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[2,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[2,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[2,]))%*%c(1:5)
Z3&lt;-(C==1)*t(rmultinom(n,1,pi1[3,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[3,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[3,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[3,]))%*%c(1:5)
Z4&lt;-(C==1)*t(rmultinom(n,1,pi1[4,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[4,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[4,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[4,]))%*%c(1:5)
Z5&lt;-(C==1)*t(rmultinom(n,1,pi1[5,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[5,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[5,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[5,]))%*%c(1:5)
Z6&lt;-(C==1)*t(rmultinom(n,1,pi1[6,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[6,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[6,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[6,]))%*%c(1:5)
Z7&lt;-(C==1)*t(rmultinom(n,1,pi1[7,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[7,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[7,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[7,]))%*%c(1:5)
Z8&lt;-(C==1)*t(rmultinom(n,1,pi1[8,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[8,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[8,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[8,]))%*%c(1:5)
Z9&lt;-(C==1)*t(rmultinom(n,1,pi1[9,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[9,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[9,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[9,]))%*%c(1:5)
Z10&lt;-(C==1)*t(rmultinom(n,1,pi1[10,]))%*%c(1:5)+(C==2)*
  t(rmultinom(n,1,pi2[10,]))%*%c(1:5)+(C==3)*
  t(rmultinom(n,1,pi3[10,]))%*%c(1:5)+(C==4)*t(rmultinom(n,1,pi4[10,]))%*%c(1:5)

Z &lt;- cbind(Z1, Z2, Z3, Z4, Z5, Z6, Z7, Z8, Z9, Z10)

Y &lt;- rnorm(n, 10 - .5*X1 + 2*X2 + 2*(C == 1) + 1*(C == 2), 1)

mydata = data.frame(Y, X1, X2, Z1, Z2, Z3, Z4, Z5, Z6, Z7, Z8, Z9, Z10)

inits = list(list(theta = c(0.33, 0.33, 0.34), beta = rep(0, length = 3),
                  alpha = rep(0, length = 2), true = rep(1, length = nrow(mydata)), 
                  tau = 0.5))

fit = lcra(formula = Y ~ X1 + X2, family = "gaussian", data = mydata,
           nclasses = 3, inits = inits, manifest = paste0("Z", 1:10),
           n.chains = 1, n.iter = 1000)

summary(fit)
plot(fit)


}
</code></pre>

<hr>
<h2 id='paper_sim'>Simulated data set (continuous regression outcome)</h2><span id='topic+paper_sim'></span>

<h3>Description</h3>

<p>Simulated data set with continuous regression outcome. The data set contains
100 observations of 13 variables, which include 10 manifest variables,
and two regressors - one continuous and one dummy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paper_sim
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 100 rows and 13 columns.
</p>


<h3>Details</h3>


<dl>
<dt>Y </dt><dd><p>Continuous regression outcome of interest</p>
</dd>
<dt>Z1 </dt><dd><p>Categorical manifest variable 1</p>
</dd>
<dt>Z2 </dt><dd><p>Categorical manifest variable 2</p>
</dd>
<dt>Z3 </dt><dd><p>Categorical manifest variable 3</p>
</dd>
<dt>Z4 </dt><dd><p>Categorical manifest variable 4</p>
</dd>
<dt>Z5 </dt><dd><p>Categorical manifest variable 5</p>
</dd>
<dt>Z6 </dt><dd><p>Categorical manifest variable 6</p>
</dd>
<dt>Z7 </dt><dd><p>Categorical manifest variable 7</p>
</dd>
<dt>Z8 </dt><dd><p>Categorical manifest variable 8</p>
</dd>
<dt>Z9 </dt><dd><p>Categorical manifest variable 9</p>
</dd>
<dt>Z10 </dt><dd><p>Categorical manifest variable 10</p>
</dd>
<dt>X1 </dt><dd><p>Continuous predictor variable</p>
</dd>
<dt>X2 </dt><dd><p>Categorical variable with values 1, 0</p>
</dd>
</dl>


<hr>
<h2 id='paper_sim_binary'>Simulated data set (discrete regression outcome)</h2><span id='topic+paper_sim_binary'></span>

<h3>Description</h3>

<p>Simulated data set with discrete regression outcome. The data set contains
100 observations of 13 variables, which include 10 manifest variables,
and two regressors - one continuous and one dummy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paper_sim_binary
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 100 rows and 13 columns.
</p>


<h3>Details</h3>


<dl>
<dt>Y </dt><dd><p>Discrete regression outcome of interest</p>
</dd>
<dt>Z1 </dt><dd><p>Categorical manifest variable 1</p>
</dd>
<dt>Z2 </dt><dd><p>Categorical manifest variable 2</p>
</dd>
<dt>Z3 </dt><dd><p>Categorical manifest variable 3</p>
</dd>
<dt>Z4 </dt><dd><p>Categorical manifest variable 4</p>
</dd>
<dt>Z5 </dt><dd><p>Categorical manifest variable 5</p>
</dd>
<dt>Z6 </dt><dd><p>Categorical manifest variable 6</p>
</dd>
<dt>Z7 </dt><dd><p>Categorical manifest variable 7</p>
</dd>
<dt>Z8 </dt><dd><p>Categorical manifest variable 8</p>
</dd>
<dt>Z9 </dt><dd><p>Categorical manifest variable 9</p>
</dd>
<dt>Z10 </dt><dd><p>Categorical manifest variable 10</p>
</dd>
<dt>X1 </dt><dd><p>Continuous predictor variable</p>
</dd>
<dt>X2 </dt><dd><p>Categorical variable with values 1, 0</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
