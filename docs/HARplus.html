<!DOCTYPE html><html lang="en"><head><title>Help for package HARplus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HARplus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compare_var_structure'><p>Compare Variable Structures Across SL4 and HAR Objects</p></a></li>
<li><a href='#export_data'><p>Export Data to Various Formats (CSV/STATA/TEXT/RDS/XLSX)</p></a></li>
<li><a href='#export_hierarchy_to_excel'><p>Export Hierarchical Pivot Table to Excel (Internal)</p></a></li>
<li><a href='#get_data_by_dims'><p>Extract Data by Dimension Patterns from SL4 or HAR Objects</p></a></li>
<li><a href='#get_data_by_var'><p>Extract Variable Data from SL4 or HAR Objects</p></a></li>
<li><a href='#get_dim_elements'><p>Get Dimension Elements from SL4 and HAR Objects</p></a></li>
<li><a href='#get_dim_info'><p>Extract and Organize Dimension Metadata (Internal)</p></a></li>
<li><a href='#get_dim_patterns'><p>Get Dimension Patterns from SL4 and HAR Objects</p></a></li>
<li><a href='#get_original_pattern'><p>Retrieve the Original Dimension Pattern (Internal)</p></a></li>
<li><a href='#get_var_structure'><p>Get Variable Structure Summary from SL4 and HAR Objects</p></a></li>
<li><a href='#group_data_by_dims'><p>Group Data by Dimension Patterns in SL4 or HAR Objects</p></a></li>
<li><a href='#load_harplus'><p>Load and Process GEMPACK HAR Files (Internal)</p></a></li>
<li><a href='#load_harx'><p>Load and Process HAR Files with Header Selection</p></a></li>
<li><a href='#load_sl4x'><p>Load and Process SL4 Files with Enhanced Options</p></a></li>
<li><a href='#pattern_match'><p>Match Patterns with Optional Mixing (Internal)</p></a></li>
<li><a href='#pivot_data'><p>Pivot Data from SL4 or HAR Objects</p></a></li>
<li><a href='#pivot_data_hierarchy'><p>Create Hierarchical Pivot Table from SL4 or HAR Objects</p></a></li>
<li><a href='#process_decomp_level'><p>Process Decomposition Levels in Data Frames (Internal)</p></a></li>
<li><a href='#process_export_report'><p>Process and Export Report (Internal)</p></a></li>
<li><a href='#process_pattern'><p>Extract and Process Pattern-Matched Variables (Internal)</p></a></li>
<li><a href='#rename_col'><p>Rename Columns in a Data Frame (Internal)</p></a></li>
<li><a href='#rename_dims'><p>Rename Dimensions in SL4 or HAR Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Enhanced R Package for 'GEMPACK' .har and .sl4 Files</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for processing and analyzing .har and .sl4 files, making it easier 
    for 'GEMPACK' users and 'GTAP' researchers to handle large economic datasets. 
    It simplifies the management of multiple experiment results, enabling faster 
    and more efficient comparisons without complexity. Users can extract, restructure, 
    and merge data seamlessly, ensuring compatibility across different tools. 
    The processed data can be exported and used in 'R', 'Stata', 'Python', 'Julia', or 
    any software that supports Text, CSV, or 'Excel' formats.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bodysbobb/HARplus/issues/">https://github.com/bodysbobb/HARplus/issues/</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/bodysbobb/HARplus/">https://github.com/bodysbobb/HARplus/</a>,
<a href="https://bodysbobb.github.io/HARplus/">https://bodysbobb.github.io/HARplus/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>openxlsx, haven, stats, utils, tidyr, tools, tidyselect</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-12 02:09:52 UTC; b_pat</td>
</tr>
<tr>
<td>Author:</td>
<td>Pattawee Puangchit [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pattawee Puangchit &lt;ppuangch@purdue.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-13 13:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='compare_var_structure'>Compare Variable Structures Across SL4 and HAR Objects</h2><span id='topic+compare_var_structure'></span>

<h3>Description</h3>

<p>Compares variable structures across multiple SL4 and HAR datasets to ensure compatibility.
Identifies matching and mismatched variable structures, helping users diagnose inconsistencies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_var_structure(variables = NULL, ..., keep_unique = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_var_structure_+3A_variables">variables</code></td>
<td>
<p>Character vector. Variable names to compare. Use <code>NULL</code> or <code>"ALL"</code> to compare all variables.</p>
</td></tr>
<tr><td><code id="compare_var_structure_+3A_...">...</code></td>
<td>
<p>Named SL4 or HAR objects to compare.</p>
</td></tr>
<tr><td><code id="compare_var_structure_+3A_keep_unique">keep_unique</code></td>
<td>
<p>Logical. If <code>TRUE</code>, returns unique variable structures across datasets instead of checking for compatibility. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Verifies whether variables have consistent structures across multiple datasets.
</p>
</li>
<li><p> Ensures correct ordering of dimensions and checks for structural compatibility.
</p>
</li>
<li><p> If <code>keep_unique = TRUE</code>, returns a list of unique variable structures instead of performing a direct comparison.
</p>
</li>
<li><p> Useful for merging or aligning datasets before further processing.
</p>
</li>
<li><p> Helps detect differences in variable dimensions, which may arise due to model updates or dataset variations.
</p>
</li></ul>



<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>match</code>: A data frame listing variables with identical structures across datasets.
</p>
</li>
<li> <p><code>diff</code>: A data frame listing variables with mismatched structures, useful for debugging and alignment.
</p>
</li>
<li><p> If <code>keep_unique = TRUE</code>, instead of <code>match</code> and <code>diff</code>, returns a data frame with distinct variable structures across datasets.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_var_structure">get_var_structure</a></code>, <code><a href="#topic+get_dim_patterns">get_dim_patterns</a></code>, <code><a href="#topic+get_dim_elements">get_dim_elements</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import sample data:
har_data1 &lt;- load_harx(system.file("extdata", "TAR10-WEL.har", package = "HARplus"))
har_data2 &lt;- load_harx(system.file("extdata", "SUBT10-WEL.har", package = "HARplus"))

# Compare structure for a single variable across multiple datasets
compare_var_structure("A", har_data1, har_data2)

# Compare structure for multiple variables across multiple datasets
comparison_multiple &lt;- compare_var_structure(c("A", "E1"), har_data1, har_data2)

# Extract unique variable structures across multiple datasets
unique_vars &lt;- compare_var_structure("ALL", har_data1, har_data2, keep_unique = TRUE)

</code></pre>

<hr>
<h2 id='export_data'>Export Data to Various Formats (CSV/STATA/TEXT/RDS/XLSX)</h2><span id='topic+export_data'></span>

<h3>Description</h3>

<p>Exports structured SL4 or HAR data to multiple file formats, including CSV, Stata, TXT, RDS, and XLSX.
Supports nested lists, automatic subfolder creation, and multi-sheet Excel exports.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_data(
  data,
  output_path,
  format = "csv",
  prefix = "",
  create_subfolder = FALSE,
  multi_sheet_xlsx = FALSE,
  xlsx_filename = NULL,
  report_output = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="export_data_+3A_data">data</code></td>
<td>
<p>A list or data frame. The SL4 or HAR data to export.</p>
</td></tr>
<tr><td><code id="export_data_+3A_output_path">output_path</code></td>
<td>
<p>Character. The base output directory or file path.</p>
</td></tr>
<tr><td><code id="export_data_+3A_format">format</code></td>
<td>
<p>Character. The export format (<code>"csv"</code>, <code>"stata"</code>, <code>"txt"</code>, <code>"rds"</code>, <code>"xlsx"</code>). Default is <code>"csv"</code>.</p>
</td></tr>
<tr><td><code id="export_data_+3A_prefix">prefix</code></td>
<td>
<p>Character. An optional prefix added to exported file names. Default is <code>""</code> (empty).</p>
</td></tr>
<tr><td><code id="export_data_+3A_create_subfolder">create_subfolder</code></td>
<td>
<p>Logical. If <code>TRUE</code>, creates a subfolder for each format. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="export_data_+3A_multi_sheet_xlsx">multi_sheet_xlsx</code></td>
<td>
<p>Logical. If TRUE, exports lists as multi-sheet XLSX files.</p>
</td></tr>
<tr><td><code id="export_data_+3A_xlsx_filename">xlsx_filename</code></td>
<td>
<p>An optional filename for the XLSX file (used when <code>multi_sheet_xlsx = TRUE</code>).</p>
</td></tr>
<tr><td><code id="export_data_+3A_report_output">report_output</code></td>
<td>
<p>Logical. If TRUE, generates an export report.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Supports exporting data in <code>"csv"</code>, <code>"stata"</code>, <code>"txt"</code>, <code>"rds"</code>, and <code>"xlsx"</code> formats.
</p>
</li>
<li><p> Handles nested lists and exports each data frame individually.
</p>
</li>
<li><p> Optionally creates subfolders for each format (<code>create_subfolder = TRUE</code>).
</p>
</li>
<li><p> Customizes file names using <code>prefix</code>.
</p>
</li>
<li><p> When multi_sheet_xlsx = TRUE, all exported data is stored in a <strong>single Excel workbook</strong>, with each dataset as a separate sheet.
</p>
</li></ul>


<ul>
<li><p> If exporting to Stata (<code>"stata"</code> format), column names containing <code>.</code> will be replaced with <code style="white-space: pre;">&#8288;_&#8288;</code> to ensure compatibility.
</p>
</li>
<li><p> If <code>multi_sheet_xlsx = TRUE</code>, list elements are exported as separate sheets in a single XLSX file.
</p>
</li>
<li><p> The function creates necessary directories if they do not exist.
</p>
</li></ul>



<h3>Value</h3>

<p>A list containing the file paths of the exported data.
</p>


<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_data">pivot_data</a></code>, <code><a href="#topic+get_data_by_var">get_data_by_var</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Import sample data:
sl4_data &lt;- load_sl4x(system.file("extdata", "TAR10.sl4", package = "HARplus"))

# Extract data
data_multiple &lt;- get_data_by_var(c("qo", "pca"), sl4_data)

# Export
export_data(data_multiple, file.path(tempdir(), "output_directory"), 
           format = c("csv", "xlsx", "stata", "txt", "rds"),
           create_subfolder = TRUE,
           multi_sheet_xlsx = TRUE)


</code></pre>

<hr>
<h2 id='export_hierarchy_to_excel'>Export Hierarchical Pivot Table to Excel (Internal)</h2><span id='topic+export_hierarchy_to_excel'></span>

<h3>Description</h3>

<p>Internal function to export hierarchical pivot tables to Excel with formatted headers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_hierarchy_to_excel(pivot_df, file_path, xlsx_filename = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="export_hierarchy_to_excel_+3A_pivot_df">pivot_df</code></td>
<td>
<p>A hierarchical pivot object created by pivot_data_hierarchy().</p>
</td></tr>
<tr><td><code id="export_hierarchy_to_excel_+3A_file_path">file_path</code></td>
<td>
<p>Character. The file path for Excel export.</p>
</td></tr>
<tr><td><code id="export_hierarchy_to_excel_+3A_xlsx_filename">xlsx_filename</code></td>
<td>
<p>Character. The name for the Excel file when using multi_sheet_xlsx. If NULL, uses the name of the dataset. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns NULL.
</p>

<hr>
<h2 id='get_data_by_dims'>Extract Data by Dimension Patterns from SL4 or HAR Objects</h2><span id='topic+get_data_by_dims'></span>

<h3>Description</h3>

<p>Retrieves structured data from SL4 or HAR objects based on specified dimension patterns.
Supports multiple experiments and merging datasets while maintaining structured dimension metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_by_dims(
  patterns = NULL,
  ...,
  experiment_names = NULL,
  subtotal_level = FALSE,
  rename_cols = NULL,
  merge_data = FALSE,
  pattern_mix = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_by_dims_+3A_patterns">patterns</code></td>
<td>
<p>Character vector. Dimension patterns to extract. Use <code>"ALL"</code> or <code>NULL</code> to extract all available patterns.</p>
</td></tr>
<tr><td><code id="get_data_by_dims_+3A_...">...</code></td>
<td>
<p>One or more SL4 or HAR data objects loaded using <code>load_sl4x()</code> or <code>load_harx()</code>.</p>
</td></tr>
<tr><td><code id="get_data_by_dims_+3A_experiment_names">experiment_names</code></td>
<td>
<p>Character vector. Names assigned to each dataset. If <code>NULL</code>, names are inferred.</p>
</td></tr>
<tr><td><code id="get_data_by_dims_+3A_subtotal_level">subtotal_level</code></td>
<td>
<p>Character or logical. Determines which decomposition levels to retain:
</p>

<ul>
<li> <p><code>"total"</code>: Keeps only <code>"TOTAL"</code> values.
</p>
</li>
<li> <p><code>"decomposed"</code>: Keeps only decomposed values (excludes <code>"TOTAL"</code>).
</p>
</li>
<li> <p><code>"all"</code>: Keeps all rows.
</p>
</li>
<li> <p><code>TRUE</code>: Equivalent to <code>"all"</code>, retaining both <code>"TOTAL"</code> and decomposed values.
</p>
</li>
<li> <p><code>FALSE</code>: Equivalent to <code>"total"</code>, keeping only <code>"TOTAL"</code> values.
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_data_by_dims_+3A_rename_cols">rename_cols</code></td>
<td>
<p>Named vector. Column name replacements (<code>c("old_name" = "new_name")</code>).</p>
</td></tr>
<tr><td><code id="get_data_by_dims_+3A_merge_data">merge_data</code></td>
<td>
<p>Logical. If <code>TRUE</code>, attempts to merge data across multiple experiments. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="get_data_by_dims_+3A_pattern_mix">pattern_mix</code></td>
<td>
<p>Logical. If <code>TRUE</code>, allows flexible pattern matching, ignoring dimension order. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Extracts variables matching specified dimension patterns.
</p>
</li>
<li><p> Allows for flexible pattern matching (<code>pattern_mix = TRUE</code>).
</p>
</li>
<li><p> Supports merging data across multiple experiments (<code>merge_data = TRUE</code>).
</p>
</li>
<li><p> Provides column renaming functionality (<code>rename_cols</code>).
</p>
</li>
<li><p> Handles subtotal filtering (<code>subtotal_level</code>), controlling whether <code>"TOTAL"</code> or decomposed values are retained.
</p>
</li></ul>



<h3>Value</h3>

<p>A structured list of extracted data:
</p>

<ul>
<li><p> If <code>merge_data = FALSE</code>, returns a named list where each element corresponds to an experiment.
</p>
</li>
<li><p> If <code>merge_data = TRUE</code>, returns a named list of all merged data
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_data_by_var">get_data_by_var</a></code>, <code><a href="#topic+group_data_by_dims">group_data_by_dims</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import sample data:
sl4_data &lt;- load_sl4x(
  system.file("extdata", "TAR10.sl4", package = "HARplus")
)
sl4_data1 &lt;- load_sl4x(
  system.file("extdata", "SUBT10.sl4", package = "HARplus")
)

# Extract data for a single dimension pattern
data_single_pattern &lt;- get_data_by_dims(
  "comm*reg",
  sl4_data
)

# Extract multiple dimension patterns
data_multiple_patterns &lt;- get_data_by_dims(
  c("comm*reg", "REG*ACTS"),
  sl4_data
)

# Extract all dimension patterns separately from multiple datasets
data_all_patterns &lt;- get_data_by_dims(
  NULL,
  sl4_data, sl4_data1,
  merge_data = FALSE
)

# Merge data for identical patterns across multiple datasets
data_merged_patterns &lt;- get_data_by_dims(
  NULL,
  sl4_data, sl4_data1,
  merge_data = TRUE
)

# Merge data while allowing interchangeable dimensions (e.g., A*B = B*A)
data_pattern_mixed &lt;- get_data_by_dims(
  NULL,
  sl4_data, sl4_data1,
  merge_data = TRUE,
  pattern_mix = TRUE
)

# Retain only "TOTAL" values
data_total_only &lt;- get_data_by_dims(
  "comm*reg",
  sl4_data,
  subtotal_level = "total"
)
data_total_only_alt &lt;- get_data_by_dims(
  "comm*reg",
  sl4_data,
  subtotal_level = FALSE
)

# Retain only decomposed components
data_decomposed_only &lt;- get_data_by_dims(
  "comm*reg",
  sl4_data,
  subtotal_level = "decomposed"
)

# Retain all value levels
data_all_decomp &lt;- get_data_by_dims(
  "comm*reg",
  sl4_data,
  subtotal_level = "all"
)
data_all_decomp_alt &lt;- get_data_by_dims(
  "comm*reg",
  sl4_data,
  subtotal_level = TRUE
)

# Rename specific columns
data_renamed &lt;- get_data_by_dims(
  "comm*reg",
  sl4_data,
  rename_cols = c(REG = "Region", COMM = "Commodity")
)

# Merge data with custom experiment names
data_merged_experiments &lt;- get_data_by_dims(
  "comm*reg",
  sl4_data, sl4_data1,
  experiment_names = c("EXP1", "EXP2"),
  merge_data = TRUE
)

</code></pre>

<hr>
<h2 id='get_data_by_var'>Extract Variable Data from SL4 or HAR Objects</h2><span id='topic+get_data_by_var'></span>

<h3>Description</h3>

<p>Extracts structured data for one or more variables from SL4 or HAR objects,
transforming array-like data into a tidy format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_by_var(
  var_names = NULL,
  ...,
  experiment_names = NULL,
  subtotal_level = FALSE,
  rename_cols = NULL,
  merge_data = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_by_var_+3A_var_names">var_names</code></td>
<td>
<p>Character vector. Variable names to extract. Use <code>"ALL"</code> or <code>NULL</code> to extract all available variables.</p>
</td></tr>
<tr><td><code id="get_data_by_var_+3A_...">...</code></td>
<td>
<p>One or more SL4 or HAR data objects loaded using <code>load_sl4x()</code> or <code>load_harx()</code>.</p>
</td></tr>
<tr><td><code id="get_data_by_var_+3A_experiment_names">experiment_names</code></td>
<td>
<p>Character vector. Names assigned to each dataset. If <code>NULL</code>, names are inferred.</p>
</td></tr>
<tr><td><code id="get_data_by_var_+3A_subtotal_level">subtotal_level</code></td>
<td>
<p>Character or logical. Determines which decomposition levels to retain:
</p>

<ul>
<li> <p><code>"total"</code>: Keeps only <code>"TOTAL"</code> values.
</p>
</li>
<li> <p><code>"decomposed"</code>: Keeps only decomposed values (excludes <code>"TOTAL"</code>).
</p>
</li>
<li> <p><code>"all"</code>: Keeps all rows.
</p>
</li>
<li> <p><code>TRUE</code>: Equivalent to <code>"all"</code>, retaining both <code>"TOTAL"</code> and decomposed values.
</p>
</li>
<li> <p><code>FALSE</code>: Equivalent to <code>"total"</code>, keeping only <code>"TOTAL"</code> values.
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_data_by_var_+3A_rename_cols">rename_cols</code></td>
<td>
<p>Named vector. Column name replacements (<code>c("old_name" = "new_name")</code>).</p>
</td></tr>
<tr><td><code id="get_data_by_var_+3A_merge_data">merge_data</code></td>
<td>
<p>Logical. If <code>TRUE</code>, attempts to merge data across multiple experiments. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Retrieves specific variables, multiple variables, or all available variables from SL4 or HAR datasets.
</p>
</li>
<li><p> Supports merging data from multiple experiments (<code>merge_data = TRUE</code>).
</p>
</li>
<li><p> Allows renaming of column names (<code>rename_cols</code>).
</p>
</li>
<li><p> Handles subtotal filtering (<code>subtotal_level</code>), controlling whether <code>"TOTAL"</code> or decomposed values are retained.
</p>
</li></ul>



<h3>Value</h3>

<p>A list of structured data:
</p>

<ul>
<li><p> If <code>merge_data = FALSE</code>, returns a named list where each element corresponds to an experiment.
</p>
</li>
<li><p> If <code>merge_data = TRUE</code>, returns a named list of all merged data
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>, , <code><a href="#topic+group_data_by_dims">group_data_by_dims</a></code>, <code><a href="#topic+load_sl4x">load_sl4x</a></code>, <code><a href="#topic+load_harx">load_harx</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import sample data:
sl4_data &lt;- load_sl4x(system.file("extdata", "TAR10.sl4", package = "HARplus"))
sl4_data1 &lt;- load_sl4x(system.file("extdata", "SUBT10.sl4", package = "HARplus"))

# Extract a single variable
data_qo &lt;- get_data_by_var("qo", sl4_data)

# Extract multiple variables
data_multiple &lt;- get_data_by_var(c("qo", "qgdp"), sl4_data)

# Extract all variables separately from multiple datasets
data_all &lt;- get_data_by_var(NULL, sl4_data, sl4_data1, merge_data = FALSE)

# Merge variable data across multiple datasets
data_merged &lt;- get_data_by_var(NULL, sl4_data, sl4_data1, merge_data = TRUE)

# Retain only "TOTAL" values, removing decomposed components (subtotal_level = "total" or FALSE)
data_total_only &lt;- get_data_by_var("qo", sl4_data, subtotal_level = "total")
data_total_only_alt &lt;- get_data_by_var("qo", sl4_data, subtotal_level = FALSE)

# Retain only decomposed components, removing "TOTAL" (subtotal_level = "decomposed")
data_decomposed_only &lt;- get_data_by_var("qo", sl4_data, subtotal_level = "decomposed")

# Retain all value levels (subtotal_level = "all" or TRUE)
data_all_decomp &lt;- get_data_by_var("qo", sl4_data, subtotal_level = "all")
data_all_decomp_alt &lt;- get_data_by_var("qo", sl4_data, subtotal_level = TRUE)

# Rename specific columns
data_renamed &lt;- get_data_by_var("qo", sl4_data, rename_cols = c(REG = "Region", COMM = "Commodity"))

# Merge data across multiple datasets with custom experiment names
data_merged_experiments &lt;- get_data_by_var("qo", sl4_data, sl4_data1,
experiment_names = c("EXP1", "EXP2"),
merge_data = TRUE)

</code></pre>

<hr>
<h2 id='get_dim_elements'>Get Dimension Elements from SL4 and HAR Objects</h2><span id='topic+get_dim_elements'></span>

<h3>Description</h3>

<p>Extracts and lists unique dimension elements (e.g., <code>REG</code>, <code>COMM</code>, <code>ACTS</code>) from one or more datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dim_elements(..., keep_unique = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_dim_elements_+3A_...">...</code></td>
<td>
<p>One or more structured SL4 or HAR objects containing dimension information.</p>
</td></tr>
<tr><td><code id="get_dim_elements_+3A_keep_unique">keep_unique</code></td>
<td>
<p>Logical. If <code>TRUE</code>, returns only unique dimension elements across inputs. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing unique dimension elements.
</p>


<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_dim_patterns">get_dim_patterns</a></code>, <code><a href="#topic+get_var_structure">get_var_structure</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import sample data:
sl4_data1 &lt;- load_sl4x(system.file("extdata", "TAR10.sl4", package = "HARplus"))
sl4_data2 &lt;- load_sl4x(system.file("extdata", "SUBT10.sl4", package = "HARplus"))


# Extract dimension elements from a single dataset
get_dim_elements(sl4_data1)

# Extract dimension elements from multiple datasets
get_dim_elements(sl4_data1, sl4_data2)

# Extract unique dimension elements across datasets
get_dim_elements(sl4_data1, sl4_data2, keep_unique = TRUE)

</code></pre>

<hr>
<h2 id='get_dim_info'>Extract and Organize Dimension Metadata (Internal)</h2><span id='topic+get_dim_info'></span>

<h3>Description</h3>

<p>A helper function that extracts and structures dimension-related metadata
from a given dimension structure. Used internally in <code>get_var_structure()</code>
and <code>compare_var_structure()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dim_info(dim_info)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_dim_info_+3A_dim_info">dim_info</code></td>
<td>
<p>A list containing dimension metadata, including:
</p>

<ul>
<li> <p><code>dimension_string</code>: A textual representation of dimensions (e.g., <code>"REG*COMM*YEAR"</code>).
</p>
</li>
<li> <p><code>dimension_names</code>: A character vector of dimension names.
</p>
</li>
<li> <p><code>dimension_sizes</code>: A numeric vector indicating the size of each dimension.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Retrieves structured metadata for variables in SL4 and HAR datasets.
</p>
</li>
<li><p> Computes data shape and ensures consistency in dimension structures.
</p>
</li>
<li><p> Helps determine observation counts and column sizes for variable summaries.
</p>
</li></ul>



<h3>Value</h3>

<p>A structured list containing:
</p>

<ul>
<li> <p><code>dimension_string</code>: The original dimension string.
</p>
</li>
<li> <p><code>dim_size</code>: The number of dimensions.
</p>
</li>
<li> <p><code>data_shape</code>: A formatted string representing the data shape (e.g., <code>"10x20x30"</code>).
</p>
</li>
<li> <p><code>col_size</code>: The product of all dimension sizes except the first, representing column count.
</p>
</li>
<li> <p><code>n_obs</code>: The first dimension size, typically representing the number of observations.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_var_structure">get_var_structure</a></code>, <code><a href="#topic+compare_var_structure">compare_var_structure</a></code>
</p>

<hr>
<h2 id='get_dim_patterns'>Get Dimension Patterns from SL4 and HAR Objects</h2><span id='topic+get_dim_patterns'></span>

<h3>Description</h3>

<p>Extracts and lists unique dimension patterns (e.g., <code>REG*COMM</code>, <code>REG*REG*ACTS</code>) from one or more datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dim_patterns(..., keep_unique = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_dim_patterns_+3A_...">...</code></td>
<td>
<p>One or more structured SL4 or HAR objects containing dimension information.</p>
</td></tr>
<tr><td><code id="get_dim_patterns_+3A_keep_unique">keep_unique</code></td>
<td>
<p>Logical. If <code>TRUE</code>, returns only unique dimension patterns. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Extracts dimension structure details from the dataset.
</p>
</li>
<li><p> If multiple datasets are provided, combines their dimension information.
</p>
</li>
<li><p> If <code>keep_unique = TRUE</code>, returns only distinct dimension patterns.
</p>
</li></ul>



<h3>Value</h3>

<p>A data frame containing:
</p>

<ul>
<li> <p><code>DimPattern</code>: The unique dimension patterns.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_dim_elements">get_dim_elements</a></code>, <code><a href="#topic+get_var_structure">get_var_structure</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import sample data:
sl4_data &lt;- load_sl4x(system.file("extdata", "TAR10.sl4", package = "HARplus"))
sl4_data2 &lt;- load_sl4x(system.file("extdata", "SUBT10.sl4", package = "HARplus"))

# Extract dimension patterns
get_dim_patterns(sl4_data)

# Extract only unique dimension patterns across datasets
get_dim_patterns(sl4_data, sl4_data2, keep_unique = TRUE)

</code></pre>

<hr>
<h2 id='get_original_pattern'>Retrieve the Original Dimension Pattern (Internal)</h2><span id='topic+get_original_pattern'></span>

<h3>Description</h3>

<p>A helper function that finds the original dimension pattern name in an SL4 or HAR dataset
that matches a given pattern. Used internally in <code>get_data_by_dims()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_original_pattern(pattern, data_obj, mix_patterns = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_original_pattern_+3A_pattern">pattern</code></td>
<td>
<p>Character. The pattern to search for in dimension structures.</p>
</td></tr>
<tr><td><code id="get_original_pattern_+3A_data_obj">data_obj</code></td>
<td>
<p>An SL4 or HAR object containing dimension information.</p>
</td></tr>
<tr><td><code id="get_original_pattern_+3A_mix_patterns">mix_patterns</code></td>
<td>
<p>Logical. If <code>TRUE</code>, allows dimension order to vary when matching patterns.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Performs a case-insensitive comparison to identify matching dimension patterns.
</p>
</li>
<li><p> Supports flexible pattern matching when <code>mix_patterns = TRUE</code>, allowing dimension order to vary.
</p>
</li>
<li><p> Returns the standardized dimension pattern name as stored in the dataset.
</p>
</li></ul>



<h3>Value</h3>

<p>The original dimension pattern name as a character string, or <code>NULL</code> if no match is found.
</p>


<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pattern_match">pattern_match</a></code>, <code><a href="#topic+process_pattern">process_pattern</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>
</p>

<hr>
<h2 id='get_var_structure'>Get Variable Structure Summary from SL4 and HAR Objects</h2><span id='topic+get_var_structure'></span>

<h3>Description</h3>

<p>Generates a summary of the variables within one or more SL4 or HAR objects, listing their
dimension sizes, structures, and optionally, column and observation counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_var_structure(variables = NULL, ..., include_col_size = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_var_structure_+3A_variables">variables</code></td>
<td>
<p>Character vector. Variable names to summarize. Use <code>NULL</code> or <code>"ALL"</code> to summarize all variables.</p>
</td></tr>
<tr><td><code id="get_var_structure_+3A_...">...</code></td>
<td>
<p>One or more SL4 or HAR objects created using <code>load_sl4x()</code> or <code>load_harx()</code>.</p>
</td></tr>
<tr><td><code id="get_var_structure_+3A_include_col_size">include_col_size</code></td>
<td>
<p>Logical. If <code>TRUE</code>, includes column and observation counts. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Extracts dimension structures for variables in one or more SL4 or HAR datasets.
</p>
</li>
<li><p> If <code>include_col_size = TRUE</code>, adds column and observation counts.
</p>
</li>
<li><p> Supports multiple datasets and returns results as a named list, with each dataset’s summary stored separately.
</p>
</li>
<li><p> Can summarize specific variables or <code>"ALL"</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A named list, where each element contains a data frame with:
</p>

<ul>
<li> <p><code>Variable</code>: The variable name.
</p>
</li>
<li> <p><code>Dimensions</code>: The associated dimensions.
</p>
</li>
<li> <p><code>DimSize</code>: The number of dimensions.
</p>
</li>
<li> <p><code>DataShape</code>: The shape of the data (e.g., <code style="white-space: pre;">&#8288;10x20x30&#8288;</code>).
</p>
</li>
<li> <p><code>No.Col</code>: (Optional) The number of columns.
</p>
</li>
<li> <p><code>No.Obs</code>: (Optional) The number of observations.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_dim_patterns">get_dim_patterns</a></code>, <code><a href="#topic+get_dim_elements">get_dim_elements</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import data sample:
sl4_data &lt;- load_sl4x(system.file("extdata", "TAR10.sl4", package = "HARplus"))
sl4_data1 &lt;- load_sl4x(system.file("extdata", "SUBT10.sl4", package = "HARplus"))

# Get summary for all variables in a single dataset
get_var_structure(data_obj = sl4_data)

# Get summary for specific variables
get_var_structure(c("gdp", "trade"), sl4_data)

# Include column and observation counts
get_var_structure("ALL", sl4_data, include_col_size = TRUE)

# Compare structures across multiple datasets
get_var_structure("ALL", sl4_data, sl4_data1)

# Include column and observation counts across multiple datasets
get_var_structure("ALL", sl4_data, sl4_data1, include_col_size = TRUE)

</code></pre>

<hr>
<h2 id='group_data_by_dims'>Group Data by Dimension Patterns in SL4 or HAR Objects</h2><span id='topic+group_data_by_dims'></span>

<h3>Description</h3>

<p>Groups extracted SL4 or HAR data based on specified dimension structures and priority rules.
Supports automatic renaming, merging, subtotal filtering, and structured metadata handling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_data_by_dims(
  patterns = NULL,
  ...,
  priority,
  rename_cols = NULL,
  experiment_names = NULL,
  subtotal_level = FALSE,
  auto_rename = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="group_data_by_dims_+3A_patterns">patterns</code></td>
<td>
<p>Character vector. Dimension patterns to extract. Use <code>"ALL"</code> or <code>NULL</code> to extract all available patterns.</p>
</td></tr>
<tr><td><code id="group_data_by_dims_+3A_...">...</code></td>
<td>
<p>One or more SL4 or HAR objects loaded using <code>load_sl4x()</code> or <code>load_harx()</code>.</p>
</td></tr>
<tr><td><code id="group_data_by_dims_+3A_priority">priority</code></td>
<td>
<p>Named list. Specifies priority dimension elements (<code>c("group_name" = c("dim1", "dim2"))</code>).</p>
</td></tr>
<tr><td><code id="group_data_by_dims_+3A_rename_cols">rename_cols</code></td>
<td>
<p>Named vector. Column name replacements (<code>c("old_name" = "new_name")</code>).</p>
</td></tr>
<tr><td><code id="group_data_by_dims_+3A_experiment_names">experiment_names</code></td>
<td>
<p>Character vector. Names assigned to each dataset. If <code>NULL</code>, names are inferred.</p>
</td></tr>
<tr><td><code id="group_data_by_dims_+3A_subtotal_level">subtotal_level</code></td>
<td>
<p>Character or logical. Determines which decomposition levels to retain:
</p>

<ul>
<li> <p><code>"total"</code>: Keeps only <code>"TOTAL"</code> values.
</p>
</li>
<li> <p><code>"decomposed"</code>: Keeps only decomposed values (excludes <code>"TOTAL"</code>).
</p>
</li>
<li> <p><code>"all"</code>: Keeps all rows.
</p>
</li>
<li> <p><code>TRUE</code>: Equivalent to <code>"all"</code>, retaining both <code>"TOTAL"</code> and decomposed values.
</p>
</li>
<li> <p><code>FALSE</code>: Equivalent to <code>"total"</code>, keeping only <code>"TOTAL"</code> values.
</p>
</li></ul>
</td></tr>
<tr><td><code id="group_data_by_dims_+3A_auto_rename">auto_rename</code></td>
<td>
<p>Logical. If <code>TRUE</code>, automatically renames dimensions for consistency. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Groups extracted variables based on dimension elements.
</p>
</li>
<li><p> Applies predefined priority rules to structure the data.
</p>
</li>
<li><p> Allows automatic renaming of dimensions (<code>auto_rename = TRUE</code>).
</p>
</li>
<li><p> Supports merging of grouped data across multiple experiments.
</p>
</li>
<li><p> Handles subtotal filtering (<code>subtotal_level</code>), controlling whether <code>"TOTAL"</code> or decomposed values are retained.
</p>
</li></ul>



<h3>Value</h3>

<p>A structured list of grouped data:
</p>

<ul>
<li><p> A named list where each element corresponds to a dimension size group (e.g., &quot;2D&quot;, &quot;3D&quot;).
</p>
</li>
<li><p> Each group contains dimension-grouped data based on priority rules.
</p>
</li>
<li><p> If unmerged data exists, includes a report attribute detailing merge issues.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>, <code><a href="#topic+get_data_by_var">get_data_by_var</a></code>, <code><a href="#topic+load_sl4x">load_sl4x</a></code>, <code><a href="#topic+load_harx">load_harx</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import sample data
sl4_data1 &lt;- load_sl4x(system.file("extdata", "TAR10.sl4", package = "HARplus"))
sl4_data2 &lt;- load_sl4x(system.file("extdata", "SUBT10.sl4", package = "HARplus"))

# Case 1: Multiple priority levels (Sector then Region) with auto_rename
priority_list &lt;- list(
  "Sector" = c("COMM", "ACTS"),
  "Region" = c("REG")
)
grouped_data_multiple &lt;- group_data_by_dims(
  patterns = "ALL",
  sl4_data1,
  priority = priority_list,
  auto_rename = TRUE
)

# Case 2: Single priority (Region only) with auto_rename
priority_list &lt;- list("Region" = c("REG"))
grouped_data_single &lt;- group_data_by_dims(
  patterns = "ALL",
  sl4_data1, sl4_data2,
  priority = priority_list,
  auto_rename = TRUE
)

# Case 3: Multiple priorities without auto_rename
priority_list &lt;- list(
  "Sector" = c("COMM", "ACTS"),
  "Region" = c("REG")
)
grouped_data_no_rename &lt;- group_data_by_dims(
  patterns = "ALL",
  sl4_data1,
  priority = priority_list,
  auto_rename = FALSE
)
</code></pre>

<hr>
<h2 id='load_harplus'>Load and Process GEMPACK HAR Files (Internal)</h2><span id='topic+load_harplus'></span>

<h3>Description</h3>

<p>Reads a GEMPACK HAR file and efficiently extracts structured data while maintaining
compatibility with standard HAR formats. This implementation builds upon the foundational
work of the <strong>HARr</strong> package, reorganizing the process for improved execution speed,
memory management, and handling of sparse data structures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_harplus(con, coefAsname = FALSE, lowercase = TRUE, select_header = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load_harplus_+3A_con">con</code></td>
<td>
<p>Character or connection. The file path to the HAR file or an open binary connection.</p>
</td></tr>
<tr><td><code id="load_harplus_+3A_coefasname">coefAsname</code></td>
<td>
<p>Logical. If <code>TRUE</code>, replaces four-letter headers with coefficient names when available. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="load_harplus_+3A_lowercase">lowercase</code></td>
<td>
<p>Logical. If <code>TRUE</code>, converts all string values to lowercase. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="load_harplus_+3A_select_header">select_header</code></td>
<td>
<p>Character vector. Specific headers to extract; if <code>NULL</code>, reads all headers.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong>Efficient File Reading:</strong> Reads large HAR files in chunks for better performance.
</p>
</li>
<li> <p><strong>Optimized Memory Usage:</strong> Reduces unnecessary allocations and improves cleanup.
</p>
</li>
<li> <p><strong>Streamlined Header Processing:</strong> Ensures accurate extraction of dimension metadata.
</p>
</li>
<li> <p><strong>Supports Sparse Data Structures:</strong> Handles <code>RESPSE</code> and <code>REFULL</code> headers efficiently.
</p>
</li></ul>

<p><strong>Supported HAR Header Types:</strong>
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;1CFULL&#8288;</code>: Character headers
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;2IFULL&#8288;</code>: Integer headers
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;2RFULL&#8288;</code>: Real headers
</p>
</li>
<li> <p><code>REFULL</code>: Real headers with extended metadata
</p>
</li>
<li> <p><code>RESPSE</code>: Sparse real headers
</p>
</li></ul>



<h3>Value</h3>

<p>A structured list where:
</p>

<ul>
<li><p> Each element corresponds to a header in the HAR file.
</p>
</li>
<li><p> Names are either header names or coefficient names (if <code>coefAsname = TRUE</code>).
</p>
</li>
<li><p> Data maintains its original dimensions and attributes.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+load_sl4x">load_sl4x</a></code>, <code><a href="#topic+load_harx">load_harx</a></code>
</p>

<hr>
<h2 id='load_harx'>Load and Process HAR Files with Header Selection</h2><span id='topic+load_harx'></span>

<h3>Description</h3>

<p>Reads a GEMPACK HAR file and extracts structured data while maintaining compatibility
with standard HAR formats. Provides flexibility in naming conventions and header selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_harx(
  file_path,
  coefAsname = FALSE,
  lowercase = FALSE,
  select_header = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load_harx_+3A_file_path">file_path</code></td>
<td>
<p>Character. The file path to the HAR file.</p>
</td></tr>
<tr><td><code id="load_harx_+3A_coefasname">coefAsname</code></td>
<td>
<p>Logical. If <code>TRUE</code>, replaces four-letter headers with coefficient names when available. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="load_harx_+3A_lowercase">lowercase</code></td>
<td>
<p>Logical. If <code>TRUE</code>, converts all variable names to lowercase. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="load_harx_+3A_select_header">select_header</code></td>
<td>
<p>Character vector. Specific headers to read; if <code>NULL</code>, all headers are read. Example: <code>select_header = c("A", "E1")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Uses <code>load_harplus()</code> internally for efficient HAR file reading.
</p>
</li>
<li><p> Allows optional conversion of variable names to lowercase (<code>lowercase = TRUE</code>).
</p>
</li>
<li><p> Supports coefficient-based naming (<code>coefAsname = TRUE</code>).
</p>
</li>
<li><p> Enables selective header extraction via <code>select_header = c("A", "E1")</code>.
</p>
</li>
<li><p> Returns structured data with explicit dimension names and sizes.
</p>
</li></ul>



<h3>Value</h3>

<p>A structured list containing:
</p>

<ul>
<li> <p><code>data</code>: Extracted HAR variable data stored as matrices, arrays, or vectors.
</p>
</li>
<li> <p><code>dimension_info</code>: A list with:
</p>

<ul>
<li> <p><code>dimension_string</code>: A textual representation of dimensions (e.g., &quot;REG<em>COMM</em>YEAR&quot;).
</p>
</li>
<li> <p><code>dimension_names</code>: The names of each dimension.
</p>
</li>
<li> <p><code>dimension_sizes</code>: The size of each dimension.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+load_sl4x">load_sl4x</a></code>, <code><a href="#topic+get_data_by_var">get_data_by_var</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Path to example files
har_path &lt;- system.file("extdata", "TAR10-WEL.har", package = "HARplus")

# Basic loading
har_data &lt;- load_harx(har_path)

# Load with coefficient names
har_data_coef &lt;- load_harx(har_path, coefAsname = TRUE)

# Load with lowercase names
har_data_lower &lt;- load_harx(har_path, lowercase = TRUE)

# Load specific headers
har_selected &lt;- load_harx(har_path, select_header = c("A", "E1"))

# Load with multiple options
har_combined &lt;- load_harx(har_path,
                         coefAsname = TRUE,
                         lowercase = TRUE,
                         select_header = c("A", "E1"))

</code></pre>

<hr>
<h2 id='load_sl4x'>Load and Process SL4 Files with Enhanced Options</h2><span id='topic+load_sl4x'></span>

<h3>Description</h3>

<p>Reads an SL4 file and processes its structured data into an enhanced SL4 object.
Extracts structured variable information, dimensions, and handles subtotal columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_sl4x(file_path, lowercase = FALSE, select_header = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load_sl4x_+3A_file_path">file_path</code></td>
<td>
<p>Character. The full path to the SL4 file to be read.</p>
</td></tr>
<tr><td><code id="load_sl4x_+3A_lowercase">lowercase</code></td>
<td>
<p>Logical. If <code>TRUE</code>, converts all variable names to lowercase. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="load_sl4x_+3A_select_header">select_header</code></td>
<td>
<p>Character vector. Specific headers to extract; if <code>NULL</code>, all headers are read.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Uses <code>load_harplus()</code> internally for optimized SL4 file reading.
</p>
</li>
<li><p> Extracts variable names, dimension structures, and metadata.
</p>
</li>
<li><p> Converts variable names to lowercase if <code>lowercase = TRUE</code>.
</p>
</li>
<li><p> Allows the selection of specific headers using <code>select_header</code>.
</p>
</li>
<li><p> Returns structured data with explicit dimension names and sizes.
</p>
</li></ul>



<h3>Value</h3>

<p>A structured list containing:
</p>

<ul>
<li> <p><code>data</code>: Extracted SL4 variable data, stored as arrays or matrices.
</p>
</li>
<li> <p><code>dimension_info</code>: A list with:
</p>

<ul>
<li> <p><code>dimension_string</code>: A textual representation of dimensions (e.g., &quot;REG<em>COMM</em>YEAR&quot;).
</p>
</li>
<li> <p><code>dimension_names</code>: The names of each dimension.
</p>
</li>
<li> <p><code>dimension_sizes</code>: The size of each dimension.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+load_harx">load_harx</a></code>, <code><a href="#topic+get_data_by_var">get_data_by_var</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Path to example files
sl4_path &lt;- system.file("extdata", "TAR10.sl4", package = "HARplus")

# Basic loading
sl4_data &lt;- load_sl4x(sl4_path)

# Load with lowercase names
sl4_data_lower &lt;- load_sl4x(sl4_path, lowercase = TRUE)

# Load specific headers
sl4_selected &lt;- load_sl4x(sl4_path, select_header = c("qo", "qgdp"))

</code></pre>

<hr>
<h2 id='pattern_match'>Match Patterns with Optional Mixing (Internal)</h2><span id='topic+pattern_match'></span>

<h3>Description</h3>

<p>Compares two patterns to determine if they match, with an option to allow flexible dimension order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pattern_match(pattern1, pattern2, mix_patterns = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pattern_match_+3A_pattern1">pattern1</code></td>
<td>
<p>A character string representing the first pattern.</p>
</td></tr>
<tr><td><code id="pattern_match_+3A_pattern2">pattern2</code></td>
<td>
<p>A character string representing the second pattern.</p>
</td></tr>
<tr><td><code id="pattern_match_+3A_mix_patterns">mix_patterns</code></td>
<td>
<p>Logical; if <code>TRUE</code>, allows dimension order to be ignored during comparison.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Performs case-insensitive pattern matching.
</p>
</li>
<li><p> If <code>mix_patterns = TRUE</code>, allows patterns to match even if dimensions are in different order.
</p>
</li></ul>



<h3>Value</h3>

<p>Logical; <code>TRUE</code> if the patterns match, <code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_original_pattern">get_original_pattern</a></code>, <code><a href="#topic+process_pattern">process_pattern</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>
</p>

<hr>
<h2 id='pivot_data'>Pivot Data from SL4 or HAR Objects</h2><span id='topic+pivot_data'></span>

<h3>Description</h3>

<p>Transforms long-format SL4 or HAR data into wide format by pivoting selected columns.
Supports both single data frames and nested lists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pivot_data(data_obj, pivot_cols, name_repair = "unique")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pivot_data_+3A_data_obj">data_obj</code></td>
<td>
<p>A list or data frame. The SL4 or HAR data to pivot.</p>
</td></tr>
<tr><td><code id="pivot_data_+3A_pivot_cols">pivot_cols</code></td>
<td>
<p>Character vector. Column names to use as pivot keys.</p>
</td></tr>
<tr><td><code id="pivot_data_+3A_name_repair">name_repair</code></td>
<td>
<p>Character. Method for handling duplicate column names (<code>"unique"</code>, <code>"minimal"</code>, <code>"universal"</code>). Default is <code>"unique"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Uses <code>tidyr::pivot_wider()</code> internally to reshape data.
</p>
</li>
<li><p> Allows multiple columns to be pivoted simultaneously.
</p>
</li>
<li><p> Recursively processes nested lists, ensuring all data frames are transformed.
</p>
</li></ul>



<h3>Value</h3>

<p>A transformed data object where the specified <code>pivot_cols</code> are pivoted into wide format.
</p>


<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_data_by_var">get_data_by_var</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import sample data:
sl4_data &lt;- load_sl4x(system.file("extdata", "TAR10.sl4", package = "HARplus"))

# Extract multiple variables
data_multiple &lt;- get_data_by_var(c("qo", "qxs"), sl4_data)

# Pivot a single column
pivoted_data &lt;- pivot_data(data_multiple, pivot_cols = "REG")

# Pivot multiple columns
pivoted_data_multi &lt;- pivot_data(data_multiple, pivot_cols = c("REG", "COMM"))

</code></pre>

<hr>
<h2 id='pivot_data_hierarchy'>Create Hierarchical Pivot Table from SL4 or HAR Objects</h2><span id='topic+pivot_data_hierarchy'></span>

<h3>Description</h3>

<p>Creates hierarchical pivot tables from structured SL4 or HAR data, with optional Excel export.
Supports both single data frames and nested lists, preserving dimension hierarchies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pivot_data_hierarchy(
  data_obj,
  pivot_cols,
  name_repair = "unique",
  export = FALSE,
  file_path = NULL,
  xlsx_filename = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pivot_data_hierarchy_+3A_data_obj">data_obj</code></td>
<td>
<p>A list or data frame. The SL4 or HAR data to pivot.</p>
</td></tr>
<tr><td><code id="pivot_data_hierarchy_+3A_pivot_cols">pivot_cols</code></td>
<td>
<p>Character vector. Column names to use as pivot keys in order of hierarchy.</p>
</td></tr>
<tr><td><code id="pivot_data_hierarchy_+3A_name_repair">name_repair</code></td>
<td>
<p>Character. Method for handling duplicate column names
(<code>"unique"</code>, <code>"minimal"</code>, <code>"universal"</code>). Default is <code>"unique"</code>.</p>
</td></tr>
<tr><td><code id="pivot_data_hierarchy_+3A_export">export</code></td>
<td>
<p>Logical. If <code>TRUE</code>, exports result to Excel. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="pivot_data_hierarchy_+3A_file_path">file_path</code></td>
<td>
<p>Character. Required if export = TRUE. The path for Excel export.</p>
</td></tr>
<tr><td><code id="pivot_data_hierarchy_+3A_xlsx_filename">xlsx_filename</code></td>
<td>
<p>Character. The name for the Excel file when using multi_sheet_xlsx. If NULL, uses the name of the dataset. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Transforms data into hierarchical pivot format with nested column headers.
</p>
</li>
<li><p> Supports multiple pivot columns in specified order (e.g., REG &gt; COMM).
</p>
</li>
<li><p> Handles both single data frames and nested list structures.
</p>
</li>
<li><p> Optional direct export to Excel with formatted hierarchical headers.
</p>
</li>
<li><p> Uses efficient data processing with tidyr and openxlsx.
</p>
</li></ul>



<h3>Value</h3>

<p>A pivoted data object with hierarchical structure:
</p>

<ul>
<li><p> If input is a data frame: Returns a hierarchical pivot table.
</p>
</li>
<li><p> If input is a list: Returns a nested list of hierarchical pivot tables.
</p>
</li>
<li><p> If export = TRUE: Invisibly returns the pivoted object after Excel export.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_data">pivot_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Import sample data:
sl4_data &lt;- load_sl4x(system.file("extdata", "TAR10.sl4", package = "HARplus"))

# Extract data
data_multiple &lt;- get_data_by_var(c("qo", "pca"), sl4_data)

# Create hierarchical pivot without export
pivot_hier &lt;- pivot_data_hierarchy(data_multiple, 
                                   pivot_cols = c("REG", "COMM"))

# Create and export to Excel in one step
pivot_export &lt;- pivot_data_hierarchy(data_multiple, 
                                     pivot_cols = c("REG", "COMM"),
                                     export = TRUE,
                                     file_path = file.path(tempdir(), "pivot_output.xlsx"))


</code></pre>

<hr>
<h2 id='process_decomp_level'>Process Decomposition Levels in Data Frames (Internal)</h2><span id='topic+process_decomp_level'></span>

<h3>Description</h3>

<p>A helper function that filters data based on decomposition levels in the <code>"Subtotal"</code> column.
Used internally in <code>get_data_by_var()</code>, <code>get_data_by_dims()</code>, and <code>group_data_by_dims()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_decomp_level(df, subtotal_level)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_decomp_level_+3A_df">df</code></td>
<td>
<p>A data frame containing a <code>"Subtotal"</code> column.</p>
</td></tr>
<tr><td><code id="process_decomp_level_+3A_subtotal_level">subtotal_level</code></td>
<td>
<p>Character or logical. Determines which values to retain:
</p>

<ul>
<li> <p><code>"total"</code>: Keeps only <code>"TOTAL"</code> values.
</p>
</li>
<li> <p><code>"decomposed"</code>: Keeps only decomposed values (excludes <code>"TOTAL"</code>).
</p>
</li>
<li> <p><code>"all"</code>: Keeps all rows.
</p>
</li>
<li> <p><code>TRUE</code>: Equivalent to <code>"all"</code> (keeps both <code>"TOTAL"</code> and decomposed values).
</p>
</li>
<li> <p><code>FALSE</code>: Equivalent to <code>"total"</code> (keeps only <code>"TOTAL"</code> values, removing decomposed components).
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> If <code>subtotal_level = "total"</code>, <strong>keeps only <code>"TOTAL"</code> values</strong>, removing all decomposed components.
</p>
</li>
<li><p> If <code>subtotal_level = "decomposed"</code>, <strong>keeps only decomposed components</strong>, removing <code>"TOTAL"</code>.
</p>
</li>
<li><p> If <code>subtotal_level = "all"</code>, <strong>keeps both <code>"TOTAL"</code> and decomposed values</strong> (no filtering).
</p>
</li>
<li><p> If <code>subtotal_level = TRUE</code> (logical), it is <strong>equivalent to <code>"all"</code></strong>, meaning all values are kept.
</p>
</li>
<li><p> If <code>subtotal_level = FALSE</code> (logical), it is <strong>equivalent to <code>"total"</code></strong>, meaning only <code>"TOTAL"</code> values are kept, and decomposed components are removed.
</p>
</li>
<li><p> Filtering is applied <strong>only when both <code>"TOTAL"</code> and decomposed values exist</strong>.
</p>
</li></ul>



<h3>Value</h3>

<p>A filtered data frame based on the specified decomposition level.
</p>


<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_data_by_var">get_data_by_var</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>, <code><a href="#topic+group_data_by_dims">group_data_by_dims</a></code>
</p>

<hr>
<h2 id='process_export_report'>Process and Export Report (Internal)</h2><span id='topic+process_export_report'></span>

<h3>Description</h3>

<p>Generates a summary report of variables and their corresponding output files
from structured SL4 or HAR data. The report is saved as an Excel file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_export_report(data, output_path, prefix = "", data_name = "data")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_export_report_+3A_data">data</code></td>
<td>
<p>A structured SL4 or HAR object or a nested list of data frames.</p>
</td></tr>
<tr><td><code id="process_export_report_+3A_output_path">output_path</code></td>
<td>
<p>A character string specifying the output directory or file path.</p>
</td></tr>
<tr><td><code id="process_export_report_+3A_prefix">prefix</code></td>
<td>
<p>A character string to prepend to the exported filenames.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Extracts unique variable names and their associated export filenames.
</p>
</li>
<li><p> Handles nested list structures by recursively traversing them.
</p>
</li>
<li><p> The output report is saved as an Excel file named <code>"Report_&lt;data_name&gt;.xlsx"</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+export_data">export_data</a></code>
</p>

<hr>
<h2 id='process_pattern'>Extract and Process Pattern-Matched Variables (Internal)</h2><span id='topic+process_pattern'></span>

<h3>Description</h3>

<p>A helper function that extracts and processes variables matching a specified pattern
within an SL4 or HAR data object. Used internally in <code>get_data_by_dims()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_pattern(pattern, data_obj, exp_name, pattern_mix = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_pattern_+3A_pattern">pattern</code></td>
<td>
<p>Character. The pattern to match against dimension structures.</p>
</td></tr>
<tr><td><code id="process_pattern_+3A_data_obj">data_obj</code></td>
<td>
<p>An SL4 or HAR object containing dimension information and data.</p>
</td></tr>
<tr><td><code id="process_pattern_+3A_exp_name">exp_name</code></td>
<td>
<p>Character. The experiment name assigned to the extracted data.</p>
</td></tr>
<tr><td><code id="process_pattern_+3A_pattern_mix">pattern_mix</code></td>
<td>
<p>Logical. If <code>TRUE</code>, allows pattern matching to ignore dimension order.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Searches for variables whose dimension structures match the given pattern.
</p>
</li>
<li><p> Supports flexible pattern matching when <code>pattern_mix = TRUE</code>, allowing dimension order to vary.
</p>
</li>
<li><p> Extracted data is converted into a tidy format, preserving dimension structures.
</p>
</li>
<li><p> Standardizes <code>"Subtotal"</code> column naming for consistency across datasets.
</p>
</li>
<li><p> Ensures only non-empty extracted variables are retained.
</p>
</li></ul>



<h3>Value</h3>

<p>A data frame containing processed data for the matching pattern, or <code>NULL</code> if no matches are found.
</p>


<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_original_pattern">get_original_pattern</a></code>, <code><a href="#topic+pattern_match">pattern_match</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>
</p>

<hr>
<h2 id='rename_col'>Rename Columns in a Data Frame (Internal)</h2><span id='topic+rename_col'></span>

<h3>Description</h3>

<p>A helper function that renames columns in a data frame based on a specified mapping.
Used internally in <code>get_var_structure()</code>, <code>get_data_by_dims()</code>, and <code>rename_dims()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rename_col(df, rename_cols)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rename_col_+3A_df">df</code></td>
<td>
<p>A data frame containing columns to be renamed.</p>
</td></tr>
<tr><td><code id="rename_col_+3A_rename_cols">rename_cols</code></td>
<td>
<p>A named vector where names are existing column names,
and values are the corresponding new names.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Replaces column names according to the provided <code>rename_cols</code> mapping.
</p>
</li>
<li><p> Ensures no duplicate column names by appending numerical suffixes when necessary.
</p>
</li>
<li><p> Helps standardize column names across SL4 and HAR datasets.
</p>
</li></ul>



<h3>Value</h3>

<p>A modified data frame with renamed columns.
</p>


<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_var_structure">get_var_structure</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>, <code><a href="#topic+rename_dims">rename_dims</a></code>
</p>

<hr>
<h2 id='rename_dims'>Rename Dimensions in SL4 or HAR Objects</h2><span id='topic+rename_dims'></span>

<h3>Description</h3>

<p>Renames dimension and list names in structured SL4 or HAR objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rename_dims(data_obj, mapping_df, rename_list_names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rename_dims_+3A_data_obj">data_obj</code></td>
<td>
<p>A structured SL4 or HAR object.</p>
</td></tr>
<tr><td><code id="rename_dims_+3A_mapping_df">mapping_df</code></td>
<td>
<p>A two-column data frame where the first column (<code>old</code>) contains the current names,
and the second column (<code>new</code>) contains the new names.</p>
</td></tr>
<tr><td><code id="rename_dims_+3A_rename_list_names">rename_list_names</code></td>
<td>
<p>Logical. If <code>TRUE</code>, renames list element names. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> Replaces old dimension names with new ones as specified in <code>mapping_df</code>.
</p>
</li>
<li><p> If <code>rename_list_names = TRUE</code>, renames list element names as well.
</p>
</li>
<li><p> Ensures consistency across SL4 and HAR datasets.
</p>
</li></ul>



<h3>Value</h3>

<p>The modified SL4 or HAR object with updated dimension names and, optionally, updated list names.
</p>


<h3>Author(s)</h3>

<p>Pattawee Puangchit
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_data_by_var">get_data_by_var</a></code>, <code><a href="#topic+get_data_by_dims">get_data_by_dims</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import sample data:
sl4_data &lt;- load_sl4x(system.file("extdata", "TAR10.sl4", package = "HARplus"))

# Define a renaming map
mapping_df &lt;- data.frame(
  old = c("REG", "COMM"),
  new = c("Region", "Commodity")
)

# Rename columns in the dataset
rename_dims(sl4_data, mapping_df)

# Rename both columns and list names
rename_dims(sl4_data, mapping_df, rename_list_names = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
