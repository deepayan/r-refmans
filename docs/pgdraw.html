<!DOCTYPE html><html lang="en"><head><title>Help for package pgdraw</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pgdraw}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pgdraw-package'><p>The pgdraw package</p></a></li>
<li><a href='#pgdraw'><p>Generate random samples from the Polya-Gamma distribution, PG(b,c)</p></a></li>
<li><a href='#pgdraw.moments'><p>Compute exact first and second moments for the Polya-Gamma distribution, PG(b, c)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generate Random Samples from the Polya-Gamma Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-02-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel F. Schmidt [aut, cph, cre],
  Enes Makalic [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel F. Schmidt &lt;daniel.schmidt@monash.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Generates random samples from the Polya-Gamma distribution using an implementation of the algorithm described in J. Windle's PhD thesis (2013) <a href="https://repositories.lib.utexas.edu/bitstream/handle/2152/21842/WINDLE-DISSERTATION-2013.pdf">https://repositories.lib.utexas.edu/bitstream/handle/2152/21842/WINDLE-DISSERTATION-2013.pdf</a>. The underlying implementation is in C.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.16)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-02-19 01:26:45 UTC; dschmidt</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-02-19 13:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='pgdraw-package'>The pgdraw package</h2><span id='topic+pgdraw-package'></span>

<h3>Description</h3>

<p>This package contains a function to generates random samples from the Polya-Gamma 
distribution using an implementation of the algorithm described in J. Windle's PhD thesis. 
A frequent application of this distribution is in Bayesian analysis of logistic regression models.
</p>


<h3>Details</h3>

<p>The underlying implementation is in C.
</p>
<p>For usage, see the examples in <code><a href="#topic+pgdraw">pgdraw</a></code> and <code><a href="#topic+pgdraw.moments">pgdraw.moments</a></code>.
</p>


<h3>Note</h3>

<p>To cite this package please reference: 
</p>
<p>Makalic, E. &amp; Schmidt, D. F.
High-Dimensional Bayesian Regularised Regression with the BayesReg Package
arXiv:1611.06649 [stat.CO], 2016 <a href="https://arxiv.org/pdf/1611.06649.pdf">https://arxiv.org/pdf/1611.06649.pdf</a>
</p>
<p>A MATLAB-compatible implementation of the sampler in this package can be obtained from:
</p>
<p><a href="http://dschmidt.org/?page_id=189">http://dschmidt.org/?page_id=189</a>
</p>


<h3>Author(s)</h3>

<p>Daniel Schmidt <a href="mailto:daniel.schmidt@monash.edu">daniel.schmidt@monash.edu</a> 
</p>
<p>Faculty of Information Technology, Monash University, Australia
</p>
<p>Enes Makalic <a href="mailto:emakalic@unimelb.edu.au">emakalic@unimelb.edu.au</a>
</p>
<p>Centre for Epidemiology and Biostatistics, The University of Melbourne, Australia
</p>


<h3>References</h3>

<p>Jesse Bennett Windle
Forecasting High-Dimensional, Time-Varying Variance-Covariance Matrices
with High-Frequency Data and Sampling Polya-Gamma Random Variates for
Posterior Distributions Derived from Logistic Likelihoods  
PhD Thesis, 2013 
</p>
<p>Bayesian Inference for Logistic Models Using Polya-Gamma Latent Variables
Nicholas G. Polson, James G. Scott and Jesse Windle
Journal of the American Statistical Association
Vol. 108, No. 504, pp. 1339&ndash;1349, 2013
</p>
<p>Chung, Y.: Simulation of truncated gamma variables 
Korean Journal of Computational &amp; Applied Mathematics, 1998, 5, 601-610
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgdraw">pgdraw</a></code>, <code><a href="#topic+pgdraw.moments">pgdraw.moments</a></code>
</p>

<hr>
<h2 id='pgdraw'>Generate random samples from the Polya-Gamma distribution, PG(b,c)</h2><span id='topic+pgdraw'></span>

<h3>Description</h3>

<p>Generate random samples from the Polya-Gamma distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgdraw(b, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pgdraw_+3A_b">b</code></td>
<td>
<p>Either a single integer scalar, or a vector of integers, corresponding to the
'b' parameter for the PG(b,c) distribution. If <code>b</code> is a scalar, then
the same value is paired with every value in <code>c</code>; if <code>b</code> is a vector
then it must be of the same length as the <code>c</code> parameter.</p>
</td></tr>
<tr><td><code id="pgdraw_+3A_c">c</code></td>
<td>
<p>A vector of real numbers corresponding to the 'c' parameter for the PG(b,c) distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of samples from the Polya-Gamma distribution, one for each entry of <code>c</code>
</p>


<h3>Details</h3>

<p>This code generates random variates from the Polya-Gamma distribution with desired 'b' and 'c' parameters.
The underlying code is written in C and is an implementation of the algorithm described in J. Windle's PhD thesis.
</p>
<p>The main application of the Polya-Gamma distribution is in Bayesian analysis as it 
allows for a data augmentation (via a scale mixture of normals) approach for representation
of the logistic regression likelihood (see Example 2 below).
</p>


<h3>Note</h3>

<p>To cite this package please reference: 
</p>
<p>Makalic, E. &amp; Schmidt, D. F.
High-Dimensional Bayesian Regularised Regression with the BayesReg Package
arXiv:1611.06649 [stat.CO], 2016 <a href="https://arxiv.org/pdf/1611.06649.pdf">https://arxiv.org/pdf/1611.06649.pdf</a>
</p>
<p>A MATLAB-compatible implementation of the sampler in this package can be obtained from:
</p>
<p><a href="http://dschmidt.org/?page_id=189">http://dschmidt.org/?page_id=189</a>
</p>


<h3>References</h3>

<p>Jesse Bennett Windle
Forecasting High-Dimensional, Time-Varying Variance-Covariance Matrices
with High-Frequency Data and Sampling Polya-Gamma Random Variates for
Posterior Distributions Derived from Logistic Likelihoods,  
PhD Thesis, 2013 
</p>
<p>Bayesian Inference for Logistic Models Using Polya-Gamma Latent Variables
Nicholas G. Polson, James G. Scott and Jesse Windle,
Journal of the American Statistical Association
Vol. 108, No. 504, pp. 1339&ndash;1349, 2013
</p>
<p>Chung, Y.: Simulation of truncated gamma variables,
Korean Journal of Computational &amp; Applied Mathematics, 1998, 5, 601-610
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgdraw.moments">pgdraw.moments</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -----------------------------------------------------------------
# Example 1: Simulated vs exact moments
u = matrix(1,1e6,1)
x = pgdraw(1,0.5*u)
mean(x)
var(x)
pgdraw.moments(1,0.5)

x = pgdraw(2,2*u)
mean(x)
var(x)
pgdraw.moments(2,2)


# -----------------------------------------------------------------
# Example 2: Simple logistic regression
#   Sample from the following Bayesian hierarchy:
#    y_i ~ Be(1/(1+exp(-b)))
#    b   ~ uniform on R (improper)
#
#   which is equivalent to
#    y_i - 1/2 ~ N(b, 1/omega2_i)
#    omega2_i  ~ PG(1,0)
#    b         ~ uniform on R
#
sample_simple_logreg &lt;- function(y, nsamples)
{
  n = length(y)
  omega2 = matrix(1,n,1)   # Polya-Gamma latent variables
  beta   = matrix(0,nsamples,1)
  
  for (i in 1:nsamples)
  {
    # Sample 'beta'
    s = sum(omega2)
    m = sum(y-1/2)/s
    beta[i] = rnorm(1, m, sqrt(1/s))
    # Sample P-G L.Vs
    omega2 = pgdraw(1, matrix(1,n,1)*beta[i])
  }
  return(beta)
}

# 3 heads, 7 tails; ML estimate of p = 3/10 = 0.3
y = c(1,1,1,0,0,0,0,0,0,0)  

# Sample
b = sample_simple_logreg(y, 1e4)
hist(x=b)

# one way of estimating of 'p' from posterior samples
1/(1+exp(-mean(b)))         


</code></pre>

<hr>
<h2 id='pgdraw.moments'>Compute exact first and second moments for the Polya-Gamma distribution, PG(b, c)</h2><span id='topic+pgdraw.moments'></span>

<h3>Description</h3>

<p>Compute exact first and second moments for the Polya-Gamma distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgdraw.moments(b, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pgdraw.moments_+3A_b">b</code></td>
<td>
<p>The 'b' parameter of the Polya-Gamma distribution.</p>
</td></tr>
<tr><td><code id="pgdraw.moments_+3A_c">c</code></td>
<td>
<p>The 'c' parameter of the Polya-Gamma distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the mean and variance.
</p>


<h3>Details</h3>

<p>This code computes the exact mean and variance of the Polya-Gamma distribution for the specified parameters.
</p>


<h3>References</h3>

<p>Jesse Bennett Windle
Forecasting High-Dimensional, Time-Varying Variance-Covariance Matrices
with High-Frequency Data and Sampling Polya-Gamma Random Variates for
Posterior Distributions Derived from Logistic Likelihoods  
PhD Thesis, 2013 
</p>
<p>Bayesian Inference for Logistic Models Using Polya-Gamma Latent Variables
Nicholas G. Polson, James G. Scott and Jesse Windle
Journal of the American Statistical Association
Vol. 108, No. 504, pp. 1339&ndash;1349, 2013
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgdraw">pgdraw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -----------------------------------------------------------------
# Example: Simulated vs exact moments

u = matrix(1,1e6,1)
x = pgdraw(1,0.5*u)
mean(x)
var(x)
pgdraw.moments(1,0.5)

x = pgdraw(2,2*u)
mean(x)
var(x)
pgdraw.moments(2,2)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
