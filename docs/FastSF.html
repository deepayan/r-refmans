<!DOCTYPE html><html><head><title>Help for package FastSF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FastSF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ffused'><p>Fast Fused Regression</p></a></li>
<li><a href='#ffused.ada'><p>Adaptive Fast Fused Regression</p></a></li>
<li><a href='#fsf'><p>Fast Structural Filtering</p></a></li>
<li><a href='#fsf.ada'><p>Adaptive Fast Structural Filtering</p></a></li>
<li><a href='#fsfused'><p>Fast Sparse Fused Regression</p></a></li>
<li><a href='#fsfused.ada'><p>Adaptive Fast Sparse Fused Regression</p></a></li>
<li><a href='#ftf'><p>Fast Trend Filtering</p></a></li>
<li><a href='#ftf.ada'><p>Adaptive Fast Trend Filtering</p></a></li>
<li><a href='#l0fused_c'><p>L0 Fused Regression</p></a></li>
<li><a href='#l0gen_c'><p>L0 Generalized Regression</p></a></li>
<li><a href='#l0tf_c'><p>L0 Trend Filtering</p></a></li>
<li><a href='#plotl0'><p>Plot L0 fitted value</p></a></li>
<li><a href='#sl0fused_c'><p>Sparse L0 Fused Regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fast Structural Filtering</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Canhong Wen &lt;wencanhong@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of the fast structural filtering with L0 penalty. It includes an adaptive polynomial estimator by minimizing the least squares error with constraints on the number of breaks in their (k + 1)-st discrete derivative, for a chosen integer k &gt;= 0. It also includes generalized structure sparsity constraint, i.e., graph trend filtering. This package is implemented via the primal dual active set algorithm, which formulates estimates and residuals as primal and dual variables, and utilizes efficient active set selection strategies based on the properties of the primal and dual variables.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.10), limSolve</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-07-19 02:38:29 UTC; user2</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-07-19 07:32:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='ffused'>Fast Fused Regression</h2><span id='topic+ffused'></span>

<h3>Description</h3>

<p>This is a fast calculation function that solves the L0 fused problem via the primal dual active set algorithm. It fits a piecewise constant regression model by minimizing the least squares error with constraints on the number of breaks in their 1-st discrete derivative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ffused(y, s, K.max=5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffused_+3A_y">y</code></td>
<td>
<p>Response sequence to be fitted.</p>
</td></tr>
<tr><td><code id="ffused_+3A_s">s</code></td>
<td>
<p>Number of knots in the piecewise constant(breaks in the derivative), default is 10.</p>
</td></tr>
<tr><td><code id="ffused_+3A_k.max">K.max</code></td>
<td>
<p>The maximum number of steps for the algorithm to take before termination. Default is 5.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>The observed response vector. Useful for plotting and other methods.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Primal coefficient. The indexes of the nonzero values correspond to the locations of the breaks. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotl0">plotl0</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(111)
n &lt;- 1000
sigma &lt;- 0.5
y0 &lt;- rep(0,n)
y0[100:150] &lt;- 2.5
y0[400:600] &lt;- -2.4
y0[800:810] &lt;- 4
y &lt;- y0 + sigma*rnorm(n)

re = ffused(y, s = 8, K.max = 5)


</code></pre>

<hr>
<h2 id='ffused.ada'>Adaptive Fast Fused Regression</h2><span id='topic+ffused.ada'></span>

<h3>Description</h3>

<p>This is a fast calculation function that solves the L0 fused problem via the primal dual active set algorithm. It fits a piecewise constant regression model by minimizing the number of breaks in derivative with constraints on the least squares error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ffused.ada(y, tau = 1, s.max = 20, eps = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ffused.ada_+3A_y">y</code></td>
<td>
<p>Numeric vector of inputs.</p>
</td></tr>
<tr><td><code id="ffused.ada_+3A_tau">tau</code></td>
<td>
<p>Step length for searching the best model, i.e., in the t-th iteration, a model with tau*t knots will be fitted.</p>
</td></tr>
<tr><td><code id="ffused.ada_+3A_s.max">s.max</code></td>
<td>
<p>The maximum nubmer of knots in the piecewise constant(breaks in the (k+1)-st derivative), default is 20</p>
</td></tr>
<tr><td><code id="ffused.ada_+3A_eps">eps</code></td>
<td>
<p>Early stop criterion. The algorithm stops when mean squared error is less than eps</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>The observed response vector. Useful for plotting and other methods.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Primal coefficient. The indexes of the nonzero values correspond to the locations of the breaks. </p>
</td></tr>
<tr><td><code>beta.all</code></td>
<td>
<p>Solution path of fitted value, beta, corresponding to different degrees of freedom.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>A vector giving an unbiased estimate of the degrees of freedom of the fit, i.e., the number of nonzero values in <code>v</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ffused">ffused</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(111)
n &lt;- 1000
sigma &lt;- 0.5
y0 &lt;- rep(0,n)
y0[100:150] &lt;- 2.5
y0[400:600] &lt;- -2.4
y0[800:810] &lt;- 4
y &lt;- y0 + sigma*rnorm(n)


re = ffused.ada(y, tau = 1, s.max = 10)

</code></pre>

<hr>
<h2 id='fsf'>Fast Structural Filtering</h2><span id='topic+fsf'></span>

<h3>Description</h3>

<p>This function solves the generalized structural filtering problem via the primal dual active set algorithm. It fits a non-parametric regression model by minimizing the least squares error with penalty matrix D on coefficient beta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> fsf(y, D, s = 20, K.max = 5, ddinv=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fsf_+3A_y">y</code></td>
<td>
<p>Response sequence to be filtered.</p>
</td></tr>
<tr><td><code id="fsf_+3A_d">D</code></td>
<td>
<p>Penalty matrix on coeffient beta.</p>
</td></tr>
<tr><td><code id="fsf_+3A_s">s</code></td>
<td>
<p>Number of knots in the penalized coefficient(breaks in the <code>D*beta</code>), default is 20.</p>
</td></tr>
<tr><td><code id="fsf_+3A_k.max">K.max</code></td>
<td>
<p>The maximum number of steps for the algorithm to take before termination. Default is 5.</p>
</td></tr>
<tr><td><code id="fsf_+3A_ddinv">ddinv</code></td>
<td>
<p>The inverse matrix of <code>D*t(D)</code>, could be NULL input.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>The observed response vector. Useful for plotting and other methods.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Primal coefficient. The indexes of the nonzero values correspond to the locations of the breaks in <code>D*beta</code>. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotl0">plotl0</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(limSolve)
n &lt;- 1000
sigma &lt;- 0.5
y0 &lt;- rep(0,n)
y0[100:150] &lt;- 2
y0[400:600] &lt;- -1
y0[800:810] &lt;- 4
y &lt;- y0 + sigma*rnorm(n)
y[800:810] &lt;- y0[800:810] + sigma*rnorm(11)
D0 &lt;- matrix(0, n-1,n)
diag(D0) &lt;- -1
for(i in 1:(n-1)) D0[i,i+1] &lt;- 1
m &lt;- dim(D0)[1]

re = fsf(y, D0)

</code></pre>

<hr>
<h2 id='fsf.ada'>Adaptive Fast Structural Filtering</h2><span id='topic+fsf.ada'></span>

<h3>Description</h3>

<p>This is a function that solves the structural filtering problem with L0 penalty via the primal dual active set algorithm. It fits a non-parametric regression model by minimizing the number of nonzero values in D*beta with constraints on the least squares error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> fsf.ada(y, D, tau=1, s.max=20,  eps=0.1, ddinv=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fsf.ada_+3A_y">y</code></td>
<td>
<p>Response sequence to be filtered.</p>
</td></tr>
<tr><td><code id="fsf.ada_+3A_d">D</code></td>
<td>
<p>Penalty matrix on coeffient beta.</p>
</td></tr>
<tr><td><code id="fsf.ada_+3A_tau">tau</code></td>
<td>
<p>Step length for searching the best model, i.e., in the t-th iteration, a model with tau*t knots will be fitted.</p>
</td></tr>
<tr><td><code id="fsf.ada_+3A_s.max">s.max</code></td>
<td>
<p>The maximum nubmer of knots in the penalized coefficient(breaks in <code>D*beta</code>, default is 20</p>
</td></tr>
<tr><td><code id="fsf.ada_+3A_eps">eps</code></td>
<td>
<p>Early stop criterion. The algorithm stops when mean squared error is less than eps.</p>
</td></tr>
<tr><td><code id="fsf.ada_+3A_ddinv">ddinv</code></td>
<td>
<p>The inverse matrix of <code>D*t(D)</code>, could be NULL input.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>The observed response vector. Useful for plotting and other methods.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Primal coefficient. The indexes of the nonzero values correspond to the locations of the breaks. </p>
</td></tr>
<tr><td><code>beta.all</code></td>
<td>
<p>Solution path of fitted value, beta, corresponding to different degrees of freedom.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>A vector giving an unbiased estimate of the degrees of freedom of the fit, i.e., the number of nonzero values in <code>v</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotl0">plotl0</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(limSolve)
n &lt;- 1000
sigma &lt;- 0.5
y0 &lt;- rep(0,n)
y0[100:150] &lt;- 2
y0[400:600] &lt;- -1
y0[800:810] &lt;- 4
y &lt;- y0 + sigma*rnorm(n)
y[800:810] &lt;- y0[800:810] + sigma*rnorm(11)
D0 &lt;- matrix(0, n-1,n)
diag(D0) &lt;- -1
for(i in 1:(n-1)) D0[i,i+1] &lt;- 1
ddt &lt;- D0%*%t(D0)
ddinv&lt;- Solve.banded(ddt, 1,1, B = diag(1,dim(D0)[1]))

re &lt;- fsf.ada(y, D0, tau = 1, s.max = 10, eps = 0.1, ddinv = ddinv)

</code></pre>

<hr>
<h2 id='fsfused'>Fast Sparse Fused Regression</h2><span id='topic+fsfused'></span>

<h3>Description</h3>

<p>This is a function that solves the L0 fused problem via the primal dual active set algorithm in sparse condition. It fits a piecewise constant regression model by minimizing the least squares error with constraints on the number of breaks in their discrete derivative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> fsfused(y, s = 10, T, K.max=5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fsfused_+3A_y">y</code></td>
<td>
<p>Response sequence to be fitted.</p>
</td></tr>
<tr><td><code id="fsfused_+3A_s">s</code></td>
<td>
<p>Number of knots in the piecewise constant(breaks in the derivative), default is 10.</p>
</td></tr>
<tr><td><code id="fsfused_+3A_t">T</code></td>
<td>
<p>Number of non-zero values in fitted coefficient.</p>
</td></tr>
<tr><td><code id="fsfused_+3A_k.max">K.max</code></td>
<td>
<p>The maximum number of steps for the algorithm to take before termination. Default is 5.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>The observed response vector. Useful for plotting and other methods.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Primal coefficient. The indexes of the nonzero values correspond to the locations of the breaks. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotl0">plotl0</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 1000
sigma &lt;- 0.5
y0 &lt;- rep(0,n)
y0[100:150] &lt;- 2.5
y0[400:600] &lt;- -2.4
y0[800:810] &lt;- 4
y &lt;- y0 + sigma*rnorm(n)

re = fsfused(y, s = 10, T = 300)

</code></pre>

<hr>
<h2 id='fsfused.ada'>Adaptive Fast Sparse Fused Regression</h2><span id='topic+fsfused.ada'></span>

<h3>Description</h3>

<p>This is a function that solves the L0 fused problem via the primal dual active set algorithm in sparse condition. It fits a piecewise constant regression model by minimizing the number of breaks in derivative with constraints on the least squares error.</p>


<h3>Usage</h3>

<pre><code class='language-R'> fsfused.ada(y, tau=1, s.max=20, T, eps=0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fsfused.ada_+3A_y">y</code></td>
<td>
<p>Numeric vector of inputs.</p>
</td></tr>
<tr><td><code id="fsfused.ada_+3A_tau">tau</code></td>
<td>
<p>Step length for searching the best model, i.e., in the t-th iteration, a model with tau*t knots will be fitted.</p>
</td></tr>
<tr><td><code id="fsfused.ada_+3A_s.max">s.max</code></td>
<td>
<p>The maximum nubmer of knots in the piecewise constant(breaks in the (k+1)-st derivative), default is 20</p>
</td></tr>
<tr><td><code id="fsfused.ada_+3A_t">T</code></td>
<td>
<p>Number of non-zero values in fitted coefficient.</p>
</td></tr>
<tr><td><code id="fsfused.ada_+3A_eps">eps</code></td>
<td>
<p>Early stop criterion. The algorithm stops when mean squared error is less than eps</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>The observed response vector. Useful for plotting and other methods.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Primal coefficient. The indexes of the nonzero values correspond to the locations of the breaks. </p>
</td></tr>
<tr><td><code>beta.all</code></td>
<td>
<p>Solution path of fitted value, beta, corresponding to different degrees of freedom.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>A vector giving an unbiased estimate of the degrees of freedom of the fit, i.e., the number of nonzero values in <code>v</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fsfused">fsfused</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1000
sigma &lt;- 0.5
y0 &lt;- rep(0,n)
y0[100:150] &lt;- 2.5
y0[400:600] &lt;- -2.4
y0[800:810] &lt;- 4
y &lt;- y0 + sigma*rnorm(n)

re = fsfused.ada(y, tau=1, s.max=10, T = 260, eps=1.2*sigma^2)


</code></pre>

<hr>
<h2 id='ftf'>Fast Trend Filtering</h2><span id='topic+ftf'></span>

<h3>Description</h3>

<p>This function solves the structural filtering problem via the primal dual active set algorithm. It fits a k-th order piecewise polynomial by minimizing the least squares error with constraints on the number of breaks in their (k + 1)-st discrete derivative, for a chosen integer k &gt;= 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ftf(y, k = 1, s = 20, K.max = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ftf_+3A_y">y</code></td>
<td>
<p>Numeric vector of inputs.</p>
</td></tr>
<tr><td><code id="ftf_+3A_k">k</code></td>
<td>
<p>An integer specifying the desired order of the piecewise polyomial produced by the solution of the trend filtering problem. Must be non-negative, and the default to 1 (linear trend filtering).</p>
</td></tr>
<tr><td><code id="ftf_+3A_s">s</code></td>
<td>
<p>Number of knots in the piecewise polynomial(breaks in the (k+1)-st derivative), default is 20.</p>
</td></tr>
<tr><td><code id="ftf_+3A_k.max">K.max</code></td>
<td>
<p>The maximum number of steps for the algorithm to take before termination. Default is 5.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The L0 trend filtering fits an adaptive piecewise polynomial to linearly ordered observations with contraints on the number of knots, for a chosen integer k &gt;= 0. The knots or the breaks in their (k + 1)-st discrete derivative are chosen adaptively based on the observations.
</p>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>The observed response vector. Useful for plotting and other methods.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Filtered value.</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Primal coefficient. The indexes of the nonzero values correspond to the locations of the breaks. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotl0">plotl0</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)

sigma &lt;- 0.5
y0 &lt;- c((10:30)/3, (40:10)/4, 2:8)
y &lt;- y0 + sigma*rnorm(length(y0))
re &lt;- ftf(y, k = 1, s = 5)


</code></pre>

<hr>
<h2 id='ftf.ada'>Adaptive Fast Trend Filtering</h2><span id='topic+ftf.ada'></span>

<h3>Description</h3>

<p>This is a function that adaptively solves the trend filtering problem with L0 penalty via the primal dual active set algorithm. It fits a k-th order piecewise polynomial by minimizing the number of breaks in the (k + 1)-st discrete derivative with the constraints on the least squares error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ftf.ada(y, k = 1, tau = 1, s.max=20, eps=0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ftf.ada_+3A_y">y</code></td>
<td>
<p>Numeric vector of inputs.</p>
</td></tr>
<tr><td><code id="ftf.ada_+3A_k">k</code></td>
<td>
<p>An integer specifying the desired order of the piecewise polyomial produced by the solution of the trend filtering problem. Must be non-negative, and the default to 1 (linear trend filtering).</p>
</td></tr>
<tr><td><code id="ftf.ada_+3A_tau">tau</code></td>
<td>
<p>Step length for searching the best model, i.e., in the t-th iteration, a model with tau*t knots will be fitted.</p>
</td></tr>
<tr><td><code id="ftf.ada_+3A_s.max">s.max</code></td>
<td>
<p>The maximum nubmer of knots in the piecewise polynomial(breaks in the (k+1)-st derivative), default is 20</p>
</td></tr>
<tr><td><code id="ftf.ada_+3A_eps">eps</code></td>
<td>
<p>Early stop criterion. The algorithm stops when mean squared error is less than eps</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The L0 trend filtering fits an adaptive piecewise polynomial to linearly ordered observations with contraints on the number of knots, for a chosen integer k &gt;= 0. The knots or the breaks in their (k + 1)-st discrete derivative are chosen adaptively based on the observations.
</p>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>The observed response vector. Useful for plotting and other methods.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Filtered value</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Primal coefficient. The indexes of the nonzero values correspond to the locations of the breaks. </p>
</td></tr>
<tr><td><code>beta.all</code></td>
<td>
<p>Solution path of filtered value, beta, corresponding to different degrees of freedom.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>A vector giving an unbiased estimate of the degrees of freedom of the fit, i.e., the number of nonzero values in <code>v</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ftf">ftf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)

sigma &lt;- 0.5
y0 &lt;- c((10:30)/3, (40:10)/4, 2:8)
y &lt;- y0 + sigma*rnorm(length(y0))
re &lt;- ftf.ada(y, k = 1, s.max = 5)


</code></pre>

<hr>
<h2 id='l0fused_c'>L0 Fused Regression</h2><span id='topic+l0fused_c'></span>

<h3>Description</h3>

<p>This is a cpp function used for R function l0fused.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> l0fused_c(y, T0, max_steps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l0fused_c_+3A_y">y</code></td>
<td>
<p>Response sequence to be fitted.</p>
</td></tr>
<tr><td><code id="l0fused_c_+3A_t0">T0</code></td>
<td>
<p>Number of knots in the piecewise constant(breaks in the derivative), i.e., the same as s.</p>
</td></tr>
<tr><td><code id="l0fused_c_+3A_max_steps">max_steps</code></td>
<td>
<p>The maximum number of steps for the algorithm to take before termination, i.e., the same as K.max.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Dual coefficient.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Primal coefficient.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>

<hr>
<h2 id='l0gen_c'>L0 Generalized Regression</h2><span id='topic+l0gen_c'></span>

<h3>Description</h3>

<p>This is a cpp function used for R function l0gen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> l0gen_c(y, D, T0, max_steps, ddinv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l0gen_c_+3A_y">y</code></td>
<td>
<p>Response sequence to be filtered.</p>
</td></tr>
<tr><td><code id="l0gen_c_+3A_d">D</code></td>
<td>
<p>Penalty matrix on coeffient beta.</p>
</td></tr>
<tr><td><code id="l0gen_c_+3A_t0">T0</code></td>
<td>
<p>Number of knots in the penalized coefficient(breaks in the <code>D*beta</code>), same as s.</p>
</td></tr>
<tr><td><code id="l0gen_c_+3A_max_steps">max_steps</code></td>
<td>
<p>The maximum number of steps for the algorithm to take before termination. Same as K.max.</p>
</td></tr>
<tr><td><code id="l0gen_c_+3A_ddinv">ddinv</code></td>
<td>
<p>The inverse matrix of <code>D*t(D)</code>, could be NULL input.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Dual coefficient.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Primal coefficient.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>

<hr>
<h2 id='l0tf_c'>L0 Trend Filtering</h2><span id='topic+l0tf_c'></span>

<h3>Description</h3>

<p>This is a cpp function used for R function l0tf.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> l0tf_c(y, k0, T0, max_steps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l0tf_c_+3A_y">y</code></td>
<td>
<p>Numeric vector of inputs.</p>
</td></tr>
<tr><td><code id="l0tf_c_+3A_k0">k0</code></td>
<td>
<p>An integer specifying the desired order of the piecewise polyomial produced by the solution of the trend filtering problem. </p>
</td></tr>
<tr><td><code id="l0tf_c_+3A_t0">T0</code></td>
<td>
<p>Number of knots in the piecewise polynomial(breaks in the (k+1)-st derivative).</p>
</td></tr>
<tr><td><code id="l0tf_c_+3A_max_steps">max_steps</code></td>
<td>
<p>The maximum number of steps for the algorithm to take before termination. </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Dual coefficient.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Primal coefficient.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>

<hr>
<h2 id='plotl0'>Plot L0 fitted value</h2><span id='topic+plotl0'></span>

<h3>Description</h3>

<p>This is a function that plots the fitted results of L0 method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> plotl0(re)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotl0_+3A_re">re</code></td>
<td>
<p>The list generated by functions in FastSF package. For a given degree of freedom, plot the fitted value of L0 method. For adaptive situations, plot the MSE of every model under different degrees of freedom.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>

<hr>
<h2 id='sl0fused_c'>Sparse L0 Fused Regression</h2><span id='topic+sl0fused_c'></span>

<h3>Description</h3>

<p>This is a cpp function used for R function sl0fused.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> sl0fused_c(y, T0, T02, max_steps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sl0fused_c_+3A_y">y</code></td>
<td>
<p>Response sequence to be fitted.</p>
</td></tr>
<tr><td><code id="sl0fused_c_+3A_t0">T0</code></td>
<td>
<p>Number of knots in the piecewise constant(breaks in the derivative).</p>
</td></tr>
<tr><td><code id="sl0fused_c_+3A_t02">T02</code></td>
<td>
<p>Number of non-zero values in fitted coefficient.</p>
</td></tr>
<tr><td><code id="sl0fused_c_+3A_max_steps">max_steps</code></td>
<td>
<p>The maximum number of steps for the algorithm to take before termination. </p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>Fitted value.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Dual coefficient.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Primal coefficient.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Dual coefficient.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Canhong Wen, Xueqin Wang, Yanhe Shen, Aijun Zhang</p>


<h3>References</h3>

<p>Wen,C., Wang, X., Shen, Y., and Zhang, A. (2017). &quot;L0 trend filtering&quot;, technical report.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
