<!DOCTYPE html><html><head><title>Help for package csci</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {csci}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#controlCSCI'>
<p>Function for control parameters for algorithms used in CSCI.</p></a></li>
<li><a href='#CSCI'>
<p>Pointwise Confidence Intervals for Current Status Data</p></a></li>
<li><a href='#csci-package'>
<p>Current Status Confidence Intervals</p></a></li>
<li><a href='#hepABulg'>
<p>Hepatitis A Data from Bulgaria</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Current Status Confidence Intervals</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-12-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Sungwook Kim</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael P. Fay &lt;mfay@niaid.nih.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates pointwise confidence intervals for the cumulative distribution function of the event time for current status data, data where each individual is assessed at one time to see if they had the event or not by the assessment time.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), exactci</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-12-03 21:25:32 UTC; faym</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-12-07 09:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='controlCSCI'>
Function for control parameters for algorithms used in CSCI.
</h2><span id='topic+controlCSCI'></span>

<h3>Description</h3>

<p>Allows chainging of default parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>controlCSCI(power = 2/3, 
   quan_p = c(0.25, 0.5, 0.75, 0.8, 0.85, 0.9, 0.95, 0.99), 
   xp_hat = c(0.06402, 0.28506, 0.80694, 0.98729, 1.22756, 1.60246, 2.26916, 3.8363), 
   intF = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="controlCSCI_+3A_power">power</code></td>
<td>

<p>for defining m in the algorithm when <code>type='VALID'</code>: m=ceiling(n^power), where n=length(C)
</p>
</td></tr>
<tr><td><code id="controlCSCI_+3A_quan_p">quan_p</code></td>
<td>

<p>quantile associated with xp_hat, used when <code>type='LIKELIHOOD'</code>
</p>
</td></tr>
<tr><td><code id="controlCSCI_+3A_xp_hat">xp_hat</code></td>
<td>

<p>estimated quantile of the distribution of the log likelihood ratio (see e.g., Table 2 of Banerjee and WWellner, 2001),
used when <code>type='LIKELIHOOD'</code>
</p>
</td></tr>
<tr><td><code id="controlCSCI_+3A_intf">intF</code></td>
<td>

<p>numer of intervals to partition the F space (F=c(1:(intF-1)/intF)), 
used when <code>type='LIKELIHOOD'</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>power</code>, see Kim, et al 2020. For details on the other values, see the code for the <code>type='LIKELIHOOD'</code> algorithm and Banerjee and Wellner, 2001. 
</p>


<h3>Value</h3>

<p>A list of the argument values. 




</p>


<h3>References</h3>

<p>Banerjee, M. and J. A. Wellner (2001). Likelihood ratio tests for monotone functions.
Ann. Statist. 29 (6), 1699-1731.
</p>
<p>Kim, S, Fay, MP, Proschan, MA (2020). Valid and Approximately Valid Confidence Intervals for Current Status Data.
(see <a href="https://arxiv.org/abs/1805.06488">https://arxiv.org/abs/1805.06488</a>).
</p>

<hr>
<h2 id='CSCI'>
Pointwise Confidence Intervals for Current Status Data
</h2><span id='topic+CSCI'></span>

<h3>Description</h3>

<p>Calculates several different methods for getting pointwise confidence intervals for current st
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CSCI(C, D, times=NULL, type = c("VALID", "ABA", "LIKELIHOOD"), 
   conf.level = 0.95, control=controlCSCI())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CSCI_+3A_c">C</code></td>
<td>

<p>a vector of assessement times
</p>
</td></tr>
<tr><td><code id="CSCI_+3A_d">D</code></td>
<td>

<p>a vector of indicators of event at or before the assessment time
</p>
</td></tr>
<tr><td><code id="CSCI_+3A_times">times</code></td>
<td>

<p>a vector of times, t, to give the confidence interval for the event time distribution, F(t). If NULL then set to <code>sort(unique(C))</code>.
</p>
</td></tr>
<tr><td><code id="CSCI_+3A_type">type</code></td>
<td>

<p>type of confidence interval, either &quot;VALID&quot;, &quot;ABA&quot;, or &quot;LIKELIHOOD&quot; (see details)
</p>
</td></tr>
<tr><td><code id="CSCI_+3A_conf.level">conf.level</code></td>
<td>

<p>confidence level for intervals (for <code>type="LIKELIHOOD"</code> only specific values are allowed, see note)
</p>
</td></tr>
<tr><td><code id="CSCI_+3A_control">control</code></td>
<td>

<p>list with parameters for algorithms, see <code><a href="#topic+controlCSCI">controlCSCI</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function does three types of pointwise confidence intervals for the cumulative distribution function for the event time at the times specified by <code>times</code>. When <code>type="VALID"</code> the function gives a method that guarantees that the coverage will be at least nominal, but the confidence intervals are not ensured to be monotonic over the times of interest. When <code>type="ABA"</code> the function 
gives an approximate method that 
does not guarantee coverage, but has been shown by simulation to have good coverage for 
smoothly changing distributions,
and it does ensure monotonicity (see Kim, et al, 2020). 
When <code>type="LIKELIHOOD"</code> the function gives an asymptotic likelihood ratio test-based confidence interval that does not guarantee coverage
(Banerjee and Wellner, 2001).
</p>


<h3>Value</h3>

<p>A list with 2 objects:
</p>
<table>
<tr><td><code>ciTable_all</code></td>
<td>
<p>data.frame with NPMLE and associated confidence intervals for all possible time values (not output for type='LIKELIHOOD')</p>
</td></tr>
<tr><td><code>ciTable_times</code></td>
<td>
<p>data.frame with NPMLE and assoicated confidence intervals for the values of 'times' argument</p>
</td></tr>

</table>


<h3>Note</h3>

<p>Because the likelihood ratio test goes to a non-standard asymptotic distribution, we do not calculate quantiles from that distribution, but take them from Table 2 of Banerjee and Wellner (2001). Because of this, when <code>type="LIKELIHOOD"</code> then 
conf.level must be one of 0.25,0.50,0.75,0.80,0.85,0.90,0.95, or 0.99.</p>


<h3>Author(s)</h3>

<p>Sungwook Kim
</p>


<h3>References</h3>

<p>Banerjee, M. and J. A. Wellner (2001). Likelihood ratio tests for monotone functions.
Ann. Statist. 29 (6), 1699-1731.
</p>
<p>Kim, S, Fay, MP, Proschan, MA (2020). Valid and Approximately Valid Confidence Intervals for Current Status Data.
(see <a href="https://arxiv.org/abs/1805.06488">https://arxiv.org/abs/1805.06488</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hepABulg)
CSCI(C=hepABulg$age,D=hepABulg$testPos,type="VALID")

</code></pre>

<hr>
<h2 id='csci-package'>
Current Status Confidence Intervals
</h2><span id='topic+csci-package'></span><span id='topic+csci-package'></span>

<h3>Description</h3>

<p>Calculates pointwise confidence intervals for the cumulative distribution function of the event time for current status data, data where each individual is assessed at one time to see if they had the event or not by the assessment time.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> csci</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Current Status Confidence Intervals</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.9.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-12-02</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Sungwook Kim</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Michael P. Fay &lt;mfay@niaid.nih.gov&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Calculates pointwise confidence intervals for the cumulative distribution function of the event time for current status data, data where each individual is assessed at one time to see if they had the event or not by the assessment time.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.5.0), exactci</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
CSCI                    Pointwise Confidence Intervals for Current
                        Status Data
controlCSCI             Function for control parameters for algorithms
                        used in CSCI.
csci-package            Current Status Confidence Intervals
hepABulg                Hepatitis A Data from Bulgaria
</pre>
<p>The package only has one main function <code><a href="#topic+CSCI">CSCI</a></code> and one data set <code><a href="#topic+hepABulg">hepABulg</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sungwook Kim
</p>
<p>Maintainer: Michael P. Fay &lt;mfay@niaid.nih.gov&gt;
</p>

<hr>
<h2 id='hepABulg'>
Hepatitis A Data from Bulgaria
</h2><span id='topic+hepABulg'></span>

<h3>Description</h3>

<p>Hepatitis A data from Bulgaria, collected from school-children and blood donors by Prof. G. Frosner, Munich (from Keiding, 1991, Table 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("hepABulg")</code></pre>


<h3>Format</h3>

<p>A data frame with 850 observations on the following 2 variables.
</p>

<dl>
<dt><code>age</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>testPos</code></dt><dd><p>a numeric vector, Hepatitis A positive=1, or not=0</p>
</dd>
</dl>



<h3>Details</h3>

<p>Each row in the data frame represents an individual and the age tested in years and the results of the hepatitis A test (1=positive, 0=negative). Ages of the individuals range from 1 to 86 years old.
</p>


<h3>Source</h3>

<p>Keiding, N (1991). Age-specific Incidence and Prevalence: a Statistical Perspective. JRSS A 154(3): 371-412 (Table 2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hepABulg)
head(hepABulg)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
