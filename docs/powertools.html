<!DOCTYPE html><html lang="en"><head><title>Help for package powertools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {powertools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#altprimary'><p>Power calculation for multiple alternative (at least one) primary continuous endpoints</p>
assuming known covariance matrix</a></li>
<li><a href='#anova1way.c.bal'><p>Power calculation for one-way balanced analysis of variance contrast test</p></a></li>
<li><a href='#anova1way.c.unbal'><p>Power calculation for one-way unbalanced analysis of variance contrast test</p></a></li>
<li><a href='#anova1way.F.bal'><p>Power calculation for balanced one-way ANOVA omnibus F test</p></a></li>
<li><a href='#anova1way.F.unbal'><p>Power calculation for unbalanced one-way analysis of variance omnibus F test</p></a></li>
<li><a href='#anova2way.c.bal'><p>Power calculation for two-way balanced analysis of variance contrast test</p></a></li>
<li><a href='#anova2way.c.unbal'><p>Power calculation for two-way unbalanced analysis of variance contrast test</p></a></li>
<li><a href='#anova2way.F.bal'><p>Power calculation for two-way balanced analysis of variance F tests</p></a></li>
<li><a href='#anova2way.F.unbal'><p>Power calculation for two-way unbalanced analysis of variance F tests</p></a></li>
<li><a href='#anova2way.se.bal'><p>Power calculation for test of simple effect for two-way balanced analysis of variance</p></a></li>
<li><a href='#anova2way.se.unbal'><p>Power calculation for test of simple effect for two-way unbalanced analysis of variance</p></a></li>
<li><a href='#check.many'><p>Internal-use function for quality checking sets of parameters</p></a></li>
<li><a href='#check.param'><p>Internal-use function for quality checking individual parameters</p></a></li>
<li><a href='#chisq.gof'><p>Power calculation for chi-square goodness-of-fit test</p></a></li>
<li><a href='#chisq.indep'><p>Power calculation for chi-square test of independence</p></a></li>
<li><a href='#ci.mean'><p>Power calculation for precision analysis (confidence interval) for one mean</p></a></li>
<li><a href='#ci.meandiff'><p>Power calculation for precision analysis (confidence interval) for a difference between two means</p></a></li>
<li><a href='#coprimary.t'><p>Power calculations for multiple co-primary continuous endpoints assuming unknown covariance matrix</p></a></li>
<li><a href='#coprimary.z'><p>Power calculations for multiple co-primary continuous endpoints assuming known covariance matrix</p></a></li>
<li><a href='#corr.1samp'><p>Power calculation for test of one correlation coefficient</p></a></li>
<li><a href='#corr.2samp'><p>Power calculation for comparing two correlation coefficients</p></a></li>
<li><a href='#crt.long.cont'><p>Power for test of treatment effect in longitudinal cluster randomized trial with baseline measurement</p></a></li>
<li><a href='#crt.means.r'><p>Correlation between a cluster mean at baseline and follow up</p></a></li>
<li><a href='#crt.parallel.bin'><p>Power calculation for cluster randomized trial with binary outcome</p></a></li>
<li><a href='#crt.parallel.cont'><p>Power for cluster randomized trial with continuous outcome</p></a></li>
<li><a href='#crt.parallel.hte'><p>Power for detecting treatment effect heterogeneity in a cluster randomized trial with a continuous outcome</p></a></li>
<li><a href='#crt.varexplore'><p>Variance exploration for cluster randomized trials with binary outcomes</p></a></li>
<li><a href='#crt.xo.cont'><p>Power for test of treatment effect in 2x2 crossover cluster randomized trial</p></a></li>
<li><a href='#es.anova.f'><p>Cohen f effect size calculation for one- or two- way analysis of variance</p></a></li>
<li><a href='#es.d'><p>Cohen d effect size calculation for one or two means</p></a></li>
<li><a href='#es.fsq'><p>Cohen f-squared effect size for overall F test in multiple linear regression</p></a></li>
<li><a href='#es.h'><p>Cohen h effect size calculation for two proportions</p></a></li>
<li><a href='#es.q'><p>Cohen q effect size calculation for two correlation coefficients</p></a></li>
<li><a href='#es.w'><p>Cohen w effect size calculation for chi-square tests</p></a></li>
<li><a href='#irgtt.bin'><p>Power for individual randomized group treatment trial with binary outcome</p></a></li>
<li><a href='#irgtt.cont'><p>Power for individually randomized group treatment trial with continuous outcome</p></a></li>
<li><a href='#irt.hte'><p>Power for detecting treatment effect heterogeneity in an individually randomized trial with a continuous outcome</p></a></li>
<li><a href='#matrix.format'><p>Internal-use function for displaying matrices in function outputs</p></a></li>
<li><a href='#mlrF.overall'><p>Power calculation for a multiple linear regression overall F test</p></a></li>
<li><a href='#mlrF.partial'><p>Power calculation for a multiple linear regression partial F test</p></a></li>
<li><a href='#ms.varexplore'><p>Variance exploration for a multisite trial with a binary outcome</p></a></li>
<li><a href='#multisite.bin'><p>Power for a multisite trial with a binary outcome</p></a></li>
<li><a href='#multisite.cont'><p>Power for test of average treatment effect in a multisite trial</p></a></li>
<li><a href='#multisite.hte'><p>Power for test of heterogeneity of treatment effect in a multisite trial</p></a></li>
<li><a href='#prop.1samp'><p>Power calculation for one-sample proportion test</p></a></li>
<li><a href='#prop.2samp'><p>Power calculation for two-sample proportion test</p></a></li>
<li><a href='#prop.paired'><p>Power calculation for McNemar test of two correlated proportions</p></a></li>
<li><a href='#prop.test.equiv'><p>Power calculation for test of equivalence of two proportions</p></a></li>
<li><a href='#propodds'><p>Power calculations for ordinal categorical variable under proportional odds assumption</p></a></li>
<li><a href='#ranksum'><p>Power calculation for rank-sum test</p></a></li>
<li><a href='#re.clustsize.bin'><p>Relative efficiency of a cluster randomized trial with binary outcome</p>
with varying cluster sizes</a></li>
<li><a href='#re.clustsize.cont'><p>Relative efficiency of a cluster randomized trial with continuous outcome</p>
with varying cluster sizes</a></li>
<li><a href='#relrisk'><p>Power calculation for relative risk</p></a></li>
<li><a href='#signedrank'><p>Power calculation for signed-rank test</p></a></li>
<li><a href='#signtest'><p>Power calculation for sign test</p></a></li>
<li><a href='#slr'><p>Power calculation for a simple linear regression</p></a></li>
<li><a href='#ttest.1samp'><p>Power calculation for one-sample t test</p></a></li>
<li><a href='#ttest.2samp'><p>Power calculation for two-sample t test</p></a></li>
<li><a href='#ttest.paired'><p>Power calculation for paired t test</p></a></li>
<li><a href='#ztest.1samp'><p>Power calculation for one-sample z test</p></a></li>
<li><a href='#ztest.2samp'><p>Power calculation for two-sample z test</p></a></li>
<li><a href='#ztest.paired'><p>Power calculation for paired z test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Power and Sample Size Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Catherine M. Crespi &lt;ccrespi@ucla.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Power and sample size calculations for a variety of study designs and 
    outcomes. Methods include t tests, ANOVA (including tests for interactions, 
    simple effects and contrasts), proportions, categorical data (chi-square tests 
    and proportional odds), linear, logistic and Poisson regression, alternative 
    and coprimary endpoints, power for confidence intervals, correlation 
    coefficient tests, cluster randomized trials, individually randomized group 
    treatment trials, multisite trials, treatment-by-covariate interaction effects 
    and nonparametric tests of location. Utilities are provided for 
    computing various effect sizes. Companion package to the book 
    "Power and Sample Size in R", Crespi (2025, ISBN:9781138591622). </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/powerandsamplesize/powertools">https://github.com/powerandsamplesize/powertools</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/powerandsamplesize/powertools/issues">https://github.com/powerandsamplesize/powertools/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, PowerTOST, Hmisc, stats, knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-20 22:55:09 UTC; ccrespi</td>
</tr>
<tr>
<td>Author:</td>
<td>Catherine M. Crespi [aut, cre],
  Zichen Liu [aut],
  Kristen M. McGreevy [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-21 08:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='altprimary'>Power calculation for multiple alternative (at least one) primary continuous endpoints
assuming known covariance matrix</h2><span id='topic+altprimary'></span>

<h3>Description</h3>

<p>Calculates power and sample size for the case of comparing two groups on the means of K
continuous endpoints and concluding that the trial is a 'success' if the
null hypothesis is rejected for at least one of the K endpoints.
All mean differences must be specified as positive; the scale for some outcomes may need to be reversed
to meet this condition. All tests are assumed to be upper-tailed, one-sided tests. Can
solve for power, n1, n.ratio or alpha.
</p>
<p>To use a Bonferroni correction for multiple comparisons, specify alpha as
the desired familywise error rate (FWER) divided by K. For example, for one-sided FWER of 0.025
and K = 2 endpoints, specify alpha as 0.0125.
</p>
<p>Either sd and rho or Sigma must be specified.
</p>
<p>A known covariance matrix is assumed, which can result in a slight overestimate of power and
underestimate of required sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>altprimary(
  K,
  n1 = NULL,
  n.ratio = 1,
  delta = NULL,
  Sigma,
  sd,
  rho,
  alpha = 0.025,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="altprimary_+3A_k">K</code></td>
<td>
<p>The number of endpoints.</p>
</td></tr>
<tr><td><code id="altprimary_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="altprimary_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="altprimary_+3A_delta">delta</code></td>
<td>
<p>A vector of length K of the true mean differences mu1k - mu2k; must all be positive.</p>
</td></tr>
<tr><td><code id="altprimary_+3A_sigma">Sigma</code></td>
<td>
<p>The covariance matrix of the K outcomes, of dimension K x K.</p>
</td></tr>
<tr><td><code id="altprimary_+3A_sd">sd</code></td>
<td>
<p>A vector of length K of the standard deviations of the K outcomes.</p>
</td></tr>
<tr><td><code id="altprimary_+3A_rho">rho</code></td>
<td>
<p>A vector of length 0.5<em>K</em>(K-1) of the correlations among the K outcomes.</p>
</td></tr>
<tr><td><code id="altprimary_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate) for each test; defaults to 0.025.
A one-sided test is assumed.</p>
</td></tr>
<tr><td><code id="altprimary_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="altprimary_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sozu T, Sugimoto T, Hamasaki T, Evans SR (2015)
Sample Size Determination in Clinical Trials with Multiple Endpoints.
Springer International Publishing, Switzerland.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>altprimary(K = 2, n1 = 100, delta = c(0.4, 0.5), sd = c(1, 1), rho = 0.3,
alpha = 0.025 / 2, power = NULL)

Sigma &lt;- matrix(c(1, 0.3, 0.3, 0.3, 1, 0.3, 0.3, 0.3, 1), nrow = 3, ncol = 3)
altprimary(K = 3, n1 = 100, delta = c(0.2, 0.2, 0.4), Sigma = Sigma,
   alpha = 0.025 / 3, power = NULL)
</code></pre>

<hr>
<h2 id='anova1way.c.bal'>Power calculation for one-way balanced analysis of variance contrast test</h2><span id='topic+anova1way.c.bal'></span>

<h3>Description</h3>

<p>Performs sample size and power calculations for a test of a contrast in a one-way
ANOVA with balanced data (that is, equal sized groups). Can be used to solve for
power, n (sample size per group), or alpha. For unbalanced data, see
anova1way.c.unbal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova1way.c.bal(
  n = NULL,
  mvec = NULL,
  cvec = NULL,
  sd = 1,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova1way.c.bal_+3A_n">n</code></td>
<td>
<p>The sample size per group.</p>
</td></tr>
<tr><td><code id="anova1way.c.bal_+3A_mvec">mvec</code></td>
<td>
<p>A vector of group means c(mu1, mu2, ...).</p>
</td></tr>
<tr><td><code id="anova1way.c.bal_+3A_cvec">cvec</code></td>
<td>
<p>A vector of contrast coefficients c(c1, c2, ...).</p>
</td></tr>
<tr><td><code id="anova1way.c.bal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each group; defaults to 1.</p>
</td></tr>
<tr><td><code id="anova1way.c.bal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova1way.c.bal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova1way.c.bal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova1way.c.bal_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="anova1way.c.bal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>anova1way.c.bal(n = 20, mvec = c(5, 10, 12), cvec = c(1, -1, 0), sd = 10, alpha = 0.025)
anova1way.c.bal(n = 20, mvec = c(5, 10, 12), cvec = c(1, 0, -1), sd = 10, alpha = 0.025)
</code></pre>

<hr>
<h2 id='anova1way.c.unbal'>Power calculation for one-way unbalanced analysis of variance contrast test</h2><span id='topic+anova1way.c.unbal'></span>

<h3>Description</h3>

<p>Calculates power for a test of a contrast in a one-way
ANOVA with unbalanced data (that is, unequal sized groups). This function
only solves for power. For a one-way balanced ANOVA,
(equal group sizes), anova1way.c.bal can also be used, and will solve for
quantities other than power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova1way.c.unbal(
  nvec = NULL,
  mvec = NULL,
  cvec = NULL,
  sd = NULL,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova1way.c.unbal_+3A_nvec">nvec</code></td>
<td>
<p>A vector of group sample sizes c(n1, n2, ...).</p>
</td></tr>
<tr><td><code id="anova1way.c.unbal_+3A_mvec">mvec</code></td>
<td>
<p>A vector of group mvec c(mu1, mu2, ...).</p>
</td></tr>
<tr><td><code id="anova1way.c.unbal_+3A_cvec">cvec</code></td>
<td>
<p>A vector of contrast coefficients c(c1, c2, ...).</p>
</td></tr>
<tr><td><code id="anova1way.c.unbal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each group.</p>
</td></tr>
<tr><td><code id="anova1way.c.unbal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova1way.c.unbal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova1way.c.unbal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova1way.c.unbal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed power).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>anova1way.c.unbal(nvec = c(20, 20, 20), mvec = c(5, 10, 12), cvec = c(1, -1, 0),
sd = 10, alpha = 0.025)
anova1way.c.unbal(nvec = c(20, 20, 20), mvec = c(5, 10, 12), cvec = c(1, 0, -1),
sd = 10, alpha = 0.025)
</code></pre>

<hr>
<h2 id='anova1way.F.bal'>Power calculation for balanced one-way ANOVA omnibus F test</h2><span id='topic+anova1way.F.bal'></span>

<h3>Description</h3>

<p>This function performs power and sample size calculations for the overall (omnibus) F test
in a balanced (equal-sized groups) one-way analysis of variance (ANOVA). Can be used to solve for
power, n (sample size per group), or alpha.
For an unbalanced one-way
ANOVA F test (that is, unequal group sample sizes), use 'anova1way.F.unbal'.
For contrast tests in a one-way ANOVA, see 'anova1way.c.bal' and 'anova1way.c.unbal'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova1way.F.bal(
  n = NULL,
  mvec = NULL,
  sd = 1,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova1way.F.bal_+3A_n">n</code></td>
<td>
<p>The sample size per group.</p>
</td></tr>
<tr><td><code id="anova1way.F.bal_+3A_mvec">mvec</code></td>
<td>
<p>A vector of group means c(mu1, mu2, ...).</p>
</td></tr>
<tr><td><code id="anova1way.F.bal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each group; defaults to 1.</p>
</td></tr>
<tr><td><code id="anova1way.F.bal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova1way.F.bal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova1way.F.bal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova1way.F.bal_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="anova1way.F.bal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>anova1way.F.bal(n = 20, mvec = c(5, 10, 12), sd = 10)
anova1way.F.bal(n = NULL, mvec = c(-0.25, 0.25), sd = 1, Rsq = 0.5^2, ncov = 1, power = 0.8)
</code></pre>

<hr>
<h2 id='anova1way.F.unbal'>Power calculation for unbalanced one-way analysis of variance omnibus F test</h2><span id='topic+anova1way.F.unbal'></span>

<h3>Description</h3>

<p>Performs power calculation for an unbalanced (unequal group sizes)
one-way ANOVA omnibus F test, which tests for any differences among group means.
This function solves for power given other parameters. For balanced data
(equal-sized groups), anova1way.F.bal can be used and solves for more
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova1way.F.unbal(
  nvec = NULL,
  mvec = NULL,
  sd = NULL,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova1way.F.unbal_+3A_nvec">nvec</code></td>
<td>
<p>A vector of group sample sizes c(n1, n2, ...).</p>
</td></tr>
<tr><td><code id="anova1way.F.unbal_+3A_mvec">mvec</code></td>
<td>
<p>A vector of group mvec c(mu1, mu2, ...).</p>
</td></tr>
<tr><td><code id="anova1way.F.unbal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each group.</p>
</td></tr>
<tr><td><code id="anova1way.F.unbal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova1way.F.unbal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova1way.F.unbal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova1way.F.unbal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed power).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>anova1way.F.unbal(nvec = c(10, 20, 30), mvec = c(5, 10, 12), sd = 10)
</code></pre>

<hr>
<h2 id='anova2way.c.bal'>Power calculation for two-way balanced analysis of variance contrast test</h2><span id='topic+anova2way.c.bal'></span>

<h3>Description</h3>

<p>Performs sample size and power calculations for a test of a contrast
between levels of a factor in a two-way
ANOVA with balanced data (that is, equal sized cells). Can be used to solve for
power, n (sample size per cell), or alpha. For unbalanced data, see
anova2way.c.unbal. For a test of a contrast among cell means, see
anova2way.se.bal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova2way.c.bal(
  n = NULL,
  mmatrix = NULL,
  cvec = NULL,
  factor = c("a", "b"),
  sd = 1,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova2way.c.bal_+3A_n">n</code></td>
<td>
<p>The sample size per cell</p>
</td></tr>
<tr><td><code id="anova2way.c.bal_+3A_mmatrix">mmatrix</code></td>
<td>
<p>A matrix of cell means (see example).</p>
</td></tr>
<tr><td><code id="anova2way.c.bal_+3A_cvec">cvec</code></td>
<td>
<p>A vector of contrast coefficients c(c1, c2, ...).</p>
</td></tr>
<tr><td><code id="anova2way.c.bal_+3A_factor">factor</code></td>
<td>
<p>Either &quot;a&quot; for rows or &quot;b&quot; for columns depending on which factor the contrast test is being made on.</p>
</td></tr>
<tr><td><code id="anova2way.c.bal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each cell; defaults to 1.</p>
</td></tr>
<tr><td><code id="anova2way.c.bal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.c.bal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.c.bal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova2way.c.bal_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="anova2way.c.bal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.3), nrow = 2, byrow = TRUE)
anova2way.c.bal(n = 30, mmatrix = mmatrix, cvec = c(1, 0, -1), factor = "b",
sd = 2, alpha = 0.05)
</code></pre>

<hr>
<h2 id='anova2way.c.unbal'>Power calculation for two-way unbalanced analysis of variance contrast test</h2><span id='topic+anova2way.c.unbal'></span>

<h3>Description</h3>

<p>Calculates power for a test of a contrast between levels of a factor in a two-way
ANOVA with unbalanced data (that is, unequal cell sizes).
This function
only solves for power. For a two-way balanced ANOVA,
(equal cell sizes), anova2way.c.bal can also be used, and will solve for
quantities other than power. For a test of a contrast among cell means, see
anova2way.se.unbal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova2way.c.unbal(
  nmatrix = nmatrix,
  mmatrix = NULL,
  cvec = NULL,
  factor = c("a", "b"),
  sd = NULL,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova2way.c.unbal_+3A_nmatrix">nmatrix</code></td>
<td>
<p>A matrix of cell sample sizes (see example).</p>
</td></tr>
<tr><td><code id="anova2way.c.unbal_+3A_mmatrix">mmatrix</code></td>
<td>
<p>A matrix of cell means (see example).</p>
</td></tr>
<tr><td><code id="anova2way.c.unbal_+3A_cvec">cvec</code></td>
<td>
<p>A vector of contrast coefficients c(c1, c2, ...).</p>
</td></tr>
<tr><td><code id="anova2way.c.unbal_+3A_factor">factor</code></td>
<td>
<p>Either &quot;a&quot; (rows) or &quot;b&quot; (columns) depending on which factor the contrast test is being made on.</p>
</td></tr>
<tr><td><code id="anova2way.c.unbal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each cell.</p>
</td></tr>
<tr><td><code id="anova2way.c.unbal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.c.unbal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.c.unbal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova2way.c.unbal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nmatrix &lt;- matrix(c(30, 30, 30, 30, 30, 30), nrow = 2, byrow = TRUE)
mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.3), nrow = 2, byrow = TRUE)
anova2way.c.unbal(nmatrix = nmatrix, mmatrix = mmatrix, cvec = c(1, 0, -1),
factor = "b", sd = 2, alpha = 0.05)
</code></pre>

<hr>
<h2 id='anova2way.F.bal'>Power calculation for two-way balanced analysis of variance F tests</h2><span id='topic+anova2way.F.bal'></span>

<h3>Description</h3>

<p>Performs sample size and power calculations for F tests in a two-way
ANOVA with balanced data (that is, equal cell sizes). For a given
matrix of cell means, computes power or required cell size
for each factor and for their interaction, if an interaction is present.
For unbalanced data (unequal cell sizes),
see anova2way.F.unbal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova2way.F.bal(
  n = NULL,
  mmatrix = NULL,
  sd = 1,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova2way.F.bal_+3A_n">n</code></td>
<td>
<p>The sample size per cell</p>
</td></tr>
<tr><td><code id="anova2way.F.bal_+3A_mmatrix">mmatrix</code></td>
<td>
<p>A matrix of cell means (see example).</p>
</td></tr>
<tr><td><code id="anova2way.F.bal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each cell; defaults to 1.</p>
</td></tr>
<tr><td><code id="anova2way.F.bal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.F.bal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.F.bal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova2way.F.bal_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="anova2way.F.bal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.9), nrow = 2, byrow = TRUE)
anova2way.F.bal(n = 30, mmatrix = mmatrix, sd = 2, alpha = 0.05)
mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.3), nrow = 2, byrow = TRUE)
anova2way.F.bal(n = 30, mmatrix = mmatrix, sd = 2, alpha = 0.05)
mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.9), nrow = 2, byrow = TRUE)
anova2way.F.bal(n = 30, mmatrix = mmatrix, sd = 2, Rsq = 0.4, ncov = 1, alpha = 0.05)
</code></pre>

<hr>
<h2 id='anova2way.F.unbal'>Power calculation for two-way unbalanced analysis of variance F tests</h2><span id='topic+anova2way.F.unbal'></span>

<h3>Description</h3>

<p>Performs sample size and power calculations for F tests in a two-way
ANOVA with unbalanced data (that is, unequal sized cells). For given
matrix of cell means and matrix of cell sample sizes, computes power
for each factor and for their interaction, if an interaction is present.
This function does not solve for cell sizes.
For balanced data (equal cell sizes),
see anova2way.F.unbal, which can solve for cell size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova2way.F.unbal(
  nmatrix = NULL,
  mmatrix = NULL,
  sd = NULL,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova2way.F.unbal_+3A_nmatrix">nmatrix</code></td>
<td>
<p>A matrix of cell sample sizes (see example).</p>
</td></tr>
<tr><td><code id="anova2way.F.unbal_+3A_mmatrix">mmatrix</code></td>
<td>
<p>A matrix of cell means (see example).</p>
</td></tr>
<tr><td><code id="anova2way.F.unbal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each cell</p>
</td></tr>
<tr><td><code id="anova2way.F.unbal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.F.unbal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.F.unbal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova2way.F.unbal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed power).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nmatrix &lt;- matrix(c(30, 30, 30, 30, 30, 30), nrow = 2, byrow = TRUE)
mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.9), nrow = 2, byrow = TRUE)
anova2way.F.unbal(nmatrix = nmatrix, mmatrix = mmatrix, sd = 2, alpha = 0.05)
nmatrix &lt;- matrix(c(30, 30, 30, 30, 30, 30), nrow = 2, byrow = TRUE)
mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.3), nrow = 2, byrow = TRUE)
anova2way.F.unbal(nmatrix = nmatrix, mmatrix = mmatrix, sd = 2, alpha = 0.05)
nmatrix &lt;- matrix(c(30, 30, 30, 30, 30, 30), nrow = 2, byrow = TRUE)
mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.9), nrow = 2, byrow = TRUE)
anova2way.F.unbal(nmatrix = nmatrix, mmatrix = mmatrix, sd = 2, Rsq = 0.4^2,
ncov = 1, alpha = 0.05)
</code></pre>

<hr>
<h2 id='anova2way.se.bal'>Power calculation for test of simple effect for two-way balanced analysis of variance</h2><span id='topic+anova2way.se.bal'></span>

<h3>Description</h3>

<p>Conducts power and sample size calculations for a test of a simple effect in a two-way
balanced (equal cell sizes) ANOVA. A &quot;simple effect&quot; is a contrast among the cell means.
For a test of a contrast in an unbalanced (unequal
cell sizes) two-way ANOVA, see anova2way.se.unbal. For a test of contrast among
factor levels, see anova2way.c.bal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova2way.se.bal(
  n = NULL,
  mmatrix = NULL,
  cmatrix = NULL,
  sd = 1,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova2way.se.bal_+3A_n">n</code></td>
<td>
<p>The sample size per cell.</p>
</td></tr>
<tr><td><code id="anova2way.se.bal_+3A_mmatrix">mmatrix</code></td>
<td>
<p>A matrix of cell means (see example).</p>
</td></tr>
<tr><td><code id="anova2way.se.bal_+3A_cmatrix">cmatrix</code></td>
<td>
<p>A matrix of contrast coefficients (see example).</p>
</td></tr>
<tr><td><code id="anova2way.se.bal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each cell; defaults to 1.</p>
</td></tr>
<tr><td><code id="anova2way.se.bal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.se.bal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.se.bal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova2way.se.bal_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="anova2way.se.bal_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="anova2way.se.bal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.3), nrow = 2, byrow = TRUE)
cmatrix &lt;- matrix(c(-1, 0, 0, 1, 0, 0), nrow = 2, byrow = TRUE)
anova2way.se.bal(n = 30, mmatrix = mmatrix, cmatrix = cmatrix, sd = 2, alpha = 0.025)
</code></pre>

<hr>
<h2 id='anova2way.se.unbal'>Power calculation for test of simple effect for two-way unbalanced analysis of variance</h2><span id='topic+anova2way.se.unbal'></span>

<h3>Description</h3>

<p>Conducts power calculations for a test of a simple effect in a two-way
unbalanced (unequal cell sizes) ANOVA.
A &quot;simple effect&quot; is a contrast among the cell means.
This function does not solve for sample size.
For a test of a contrast in a balanced (equal
cell sizes) two-way ANOVA, anova2way.se.bal can also be used and can
solve for sample size. For a test of contrast among
factor levels, see anova2way.c.unbal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova2way.se.unbal(
  nmatrix = NULL,
  mmatrix = NULL,
  cmatrix = NULL,
  sd = 0,
  Rsq = 0,
  ncov = 0,
  alpha = 0.05,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova2way.se.unbal_+3A_nmatrix">nmatrix</code></td>
<td>
<p>A matrix of sample sizes (see example).</p>
</td></tr>
<tr><td><code id="anova2way.se.unbal_+3A_mmatrix">mmatrix</code></td>
<td>
<p>A matrix of group means (see example).</p>
</td></tr>
<tr><td><code id="anova2way.se.unbal_+3A_cmatrix">cmatrix</code></td>
<td>
<p>A matrix of contrast coefficients (see example).</p>
</td></tr>
<tr><td><code id="anova2way.se.unbal_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each group.</p>
</td></tr>
<tr><td><code id="anova2way.se.unbal_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.se.unbal_+3A_ncov">ncov</code></td>
<td>
<p>The number of covariates adjusted for in the model; defaults to 0.</p>
</td></tr>
<tr><td><code id="anova2way.se.unbal_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="anova2way.se.unbal_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="anova2way.se.unbal_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed power).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nmatrix &lt;- matrix(c(30, 30, 30, 30, 30, 30), nrow = 2, byrow = TRUE)
mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.3), nrow = 2, byrow = TRUE)
cmatrix &lt;- matrix(c(-1, 0, 0, 1, 0, 0), nrow = 2, byrow = TRUE)
anova2way.se.unbal(nmatrix = nmatrix, mmatrix = mmatrix, cmatrix = cmatrix,
sd = 2, alpha = 0.025)
</code></pre>

<hr>
<h2 id='check.many'>Internal-use function for quality checking sets of parameters</h2><span id='topic+check.many'></span>

<h3>Description</h3>

<p>Internal-use function for quality checking sets of parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.many(paramlist = NULL, type = c("oneof"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.many_+3A_paramlist">paramlist</code></td>
<td>
<p>The list of parameters being checked.</p>
</td></tr>
<tr><td><code id="check.many_+3A_type">type</code></td>
<td>
<p>The expected type of parameter: currently only supports &quot;oneof&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the check passes, returns nothing. If the check does not pass, throw an error.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 10
power &lt;- NULL
check.many(list(N, power), "oneof")
</code></pre>

<hr>
<h2 id='check.param'>Internal-use function for quality checking individual parameters</h2><span id='topic+check.param'></span>

<h3>Description</h3>

<p>Internal-use function for quality checking individual parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.param(
  param = NULL,
  type = c("req", "num", "unit", "uniti", "unitii", "pos", "int", "bool", "vals", "min",
    "mini", "vec", "mat", "sum"),
  valslist = NULL,
  min = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.param_+3A_param">param</code></td>
<td>
<p>The parameter being checked.</p>
</td></tr>
<tr><td><code id="check.param_+3A_type">type</code></td>
<td>
<p>The expected type of parameter: one of &quot;req&quot;, &quot;num&quot;, &quot;unit(i)(i)&quot;, &quot;pos&quot;, &quot;int&quot;, &quot;bool&quot;, &quot;vals&quot;, &quot;min(i)&quot;, &quot;vec&quot;, &quot;mat&quot;, &quot;sum&quot;.</p>
</td></tr>
<tr><td><code id="check.param_+3A_valslist">valslist</code></td>
<td>
<p>If the type is &quot;vals&quot;, a list of allowed values.</p>
</td></tr>
<tr><td><code id="check.param_+3A_min">min</code></td>
<td>
<p>If the type is &quot;min&quot; or &quot;mini&quot;, a lower bound.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the check passes, returns nothing. If the check does not pass, throw an error.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>power &lt;- 0.8
check.param(power, "unit")
</code></pre>

<hr>
<h2 id='chisq.gof'>Power calculation for chi-square goodness-of-fit test</h2><span id='topic+chisq.gof'></span>

<h3>Description</h3>

<p>Performs sample size and power calculations for chi-square goodness-of-fit test,
which is used to test whether a sample of data arises from a population with a specific
discrete distribution.
This function can solve for power, total sample size or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq.gof(
  p0vec = NULL,
  p1vec = NULL,
  N = NULL,
  alpha = 0.05,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chisq.gof_+3A_p0vec">p0vec</code></td>
<td>
<p>Vector of probabilities for the specified population distribution. Must sum to 1.</p>
</td></tr>
<tr><td><code id="chisq.gof_+3A_p1vec">p1vec</code></td>
<td>
<p>Vector of expected probabilities for the sample. Must sum to 1.</p>
</td></tr>
<tr><td><code id="chisq.gof_+3A_n">N</code></td>
<td>
<p>The total number of observations.</p>
</td></tr>
<tr><td><code id="chisq.gof_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="chisq.gof_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="chisq.gof_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>chisq.gof(p0vec = c(0.5, 0.3, 0.2), p1vec = c(0.7, 0.15, 0.15), N = 50)
</code></pre>

<hr>
<h2 id='chisq.indep'>Power calculation for chi-square test of independence</h2><span id='topic+chisq.indep'></span>

<h3>Description</h3>

<p>Performs power and sample size calculations for a chi-square test of independence.
The user inputs a matrix of cell probabilities for a two-way table. The function computes
the power (or required total sample size) for a test of no association between the two factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq.indep(pmatrix = NULL, N = NULL, alpha = 0.05, power = NULL, v = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chisq.indep_+3A_pmatrix">pmatrix</code></td>
<td>
<p>The two-way probability table under the alternative hypothesis. The probabilities must sum to 1.</p>
</td></tr>
<tr><td><code id="chisq.indep_+3A_n">N</code></td>
<td>
<p>The total number of observations.</p>
</td></tr>
<tr><td><code id="chisq.indep_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="chisq.indep_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="chisq.indep_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>chisq.indep(pmatrix = matrix(c(0.050, 0.350, 0.100, 0.075, 0.250, 0.175),
nrow = 2, byrow = TRUE), N = 230)
chisq.indep(pmatrix = matrix(c(0.3, 0.2, 0.4, 0.1), nrow = 2, byrow = TRUE), N = 200)
</code></pre>

<hr>
<h2 id='ci.mean'>Power calculation for precision analysis (confidence interval) for one mean</h2><span id='topic+ci.mean'></span>

<h3>Description</h3>

<p>Calculates the &quot;power&quot; of a confidence interval for one mean, that is, the probability
of achieving a 100(1 - alpha) percent confidence interval with halfwidth not greater
than a specified value. Can solve for power, N or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ci.mean(
  N = NULL,
  halfwidth = NULL,
  sd = 1,
  alpha = 0.05,
  power = NULL,
  cond = FALSE,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ci.mean_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="ci.mean_+3A_halfwidth">halfwidth</code></td>
<td>
<p>The desired halfwidth.</p>
</td></tr>
<tr><td><code id="ci.mean_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation; defaults to 1.</p>
</td></tr>
<tr><td><code id="ci.mean_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="ci.mean_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="ci.mean_+3A_cond">cond</code></td>
<td>
<p>Specify whether to use unconditional or conditional probability. Defaults to FALSE (unconditional).</p>
</td></tr>
<tr><td><code id="ci.mean_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The unconditional probability is the probability of obtaining the desired precision
(i.e., that the observed halfwidth does not exceed the desired halfwidth)
regardless of whether or not the confidence interval includes the true parameter value.
The conditional probability is the probability of both obtaining the desired precision and having
the interval include the true parameter value.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ci.mean(N = NULL, halfwidth = 0.25, power = 0.8)
ci.mean(N = 62, halfwidth = 0.25, power = NULL)
ci.mean(N = 73, halfwidth = 0.25, cond = TRUE)
</code></pre>

<hr>
<h2 id='ci.meandiff'>Power calculation for precision analysis (confidence interval) for a difference between two means</h2><span id='topic+ci.meandiff'></span>

<h3>Description</h3>

<p>Calculates the &quot;power&quot; of a confidence interval for a difference between two means, that is, the probability
of achieving a 100(1 - alpha) percent confidence interval with halfwidth not greater
than a specified value. This function can solve for power, n1, n.ratio or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ci.meandiff(
  n1 = NULL,
  n.ratio = 1,
  halfwidth = NULL,
  sd = 1,
  alpha = 0.05,
  power = NULL,
  cond = FALSE,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ci.meandiff_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="ci.meandiff_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="ci.meandiff_+3A_halfwidth">halfwidth</code></td>
<td>
<p>The desired halfwidth for the difference in means.</p>
</td></tr>
<tr><td><code id="ci.meandiff_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation; defaults to 1. Equal SDs in each group are assumed.</p>
</td></tr>
<tr><td><code id="ci.meandiff_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="ci.meandiff_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="ci.meandiff_+3A_cond">cond</code></td>
<td>
<p>Specify using unconditional or conditional probability. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="ci.meandiff_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The unconditional probability is the probability of obtaining the desired precision
(i.e., that the observed halfwidth does not exceed the desired halfwidth)
regardless of whether or not the confidence interval includes the true parameter value.
The conditional probability is the probability of both obtaining the desired precision and having
the interval include the true parameter value.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ci.meandiff(n1 = NULL, halfwidth = 0.25, power = 0.8)
ci.meandiff(n1 = 134, halfwidth = 0.25, cond = TRUE)
</code></pre>

<hr>
<h2 id='coprimary.t'>Power calculations for multiple co-primary continuous endpoints assuming unknown covariance matrix</h2><span id='topic+coprimary.t'></span>

<h3>Description</h3>

<p>Computes power for test involving multiple co-primary continuous endpoints, assuming that the
covariance matrix (variances and covariances between endpoints) is unknown and therefore t-based test
statistics will be used. Studies with co-primary endpoints use “all-or-none” testing procedures and
only declare the trial to be a “success” if all endpoints are affirmed. All true mean differences
must be positive (the scale for some outcomes may need to be reversed
to meet this condition) and upper-tailed one-sided tests are assumed.
For known covariance matrix, see coprimary.z.
</p>
<p>Either sd and rho or Sigma must be specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coprimary.t(
  K,
  n1 = NULL,
  n.ratio = 1,
  delta = NULL,
  Sigma,
  sd,
  rho,
  alpha = 0.025,
  power = NULL,
  M = 10000,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coprimary.t_+3A_k">K</code></td>
<td>
<p>The number of endpoints.</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_delta">delta</code></td>
<td>
<p>A vector of length K of the true mean differences mu1k - mu2k; must all be positive.</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_sigma">Sigma</code></td>
<td>
<p>The covariance matrix of the K outcomes, of dimension K x K.</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_sd">sd</code></td>
<td>
<p>A vector of length K of the standard deviations of the K outcomes.</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_rho">rho</code></td>
<td>
<p>A vector of length 0.5<em>K</em>(K-1) of the correlations among the K outcomes.</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.025. A one-sided test is assumed.</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_m">M</code></td>
<td>
<p>Number of simulated values for the covariance matrix, simulated from Wishart distribution. Defaults
to 10000.</p>
</td></tr>
<tr><td><code id="coprimary.t_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Crespi et al. (2025) for more details.
This function is based on the power.unknown.var function from the mpe R package and material from
Sozu T, Sugimoto T, Hamasaki T, Evans SR. (2015) Sample Size Determination in Clinical Trials
with Multiple Endpoints. Springer International Publishing, Switzerland.
</p>
<p>This function can be computationally intensive and slow when solving for sample size.
Smaller M can descrease computation time.
The function coprimary.z provides a close approximation and is much faster.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># M is set to 10 in these examples to reduce runtime;
# please increase M or do not specify M (defaults to M = 10000) for optimal results
coprimary.t(K = 2, n1 = 100, delta = c(0.4, 0.5), sd = c(1, 1), rho = 0.3, alpha = 0.025,
power = NULL, M = 10)

Sigma &lt;- matrix(c(1, 0.3, 0.3, 0.3, 1, 0.3, 0.3, 0.3, 1), nrow = 3, ncol = 3)
coprimary.t(K = 3, n1 = 200, delta = c(0.2, 0.3, 0.4), Sigma = Sigma, alpha = 0.025,
power = NULL, M = 10)
</code></pre>

<hr>
<h2 id='coprimary.z'>Power calculations for multiple co-primary continuous endpoints assuming known covariance matrix</h2><span id='topic+coprimary.z'></span>

<h3>Description</h3>

<p>Computes power for test involving multiple co-primary continuous endpoints, assuming that the
covariance matrix (variances and covariances between endpoints) is known and therefore z-based test
statistics will be used. Studies with co-primary endpoints use “all-or-none” testing procedures and
only declare the trial to be a “success” if all endpoints are affirmed. All true mean differences
must be positive (the scale for some outcomes may need to be reversed
to meet this condition) and upper-tailed one-sided tests are assumed.
For the more realistic case that the covariance matrix is not known, see coprimary.t.
</p>
<p>Either sd and rho or Sigma must be specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coprimary.z(
  K,
  n1 = NULL,
  n.ratio = 1,
  delta = NULL,
  Sigma,
  sd,
  rho,
  alpha = 0.025,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coprimary.z_+3A_k">K</code></td>
<td>
<p>The number of endpoints.</p>
</td></tr>
<tr><td><code id="coprimary.z_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="coprimary.z_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="coprimary.z_+3A_delta">delta</code></td>
<td>
<p>A vector of length K of the true mean differences mu1k - mu2k; must all be positive.</p>
</td></tr>
<tr><td><code id="coprimary.z_+3A_sigma">Sigma</code></td>
<td>
<p>The covariance matrix of the K outcomes, of dimension K x K.</p>
</td></tr>
<tr><td><code id="coprimary.z_+3A_sd">sd</code></td>
<td>
<p>A vector of length K of the standard deviations of the K outcomes.</p>
</td></tr>
<tr><td><code id="coprimary.z_+3A_rho">rho</code></td>
<td>
<p>A vector of length 0.5<em>K</em>(K-1) of the correlations among the K outcomes.</p>
</td></tr>
<tr><td><code id="coprimary.z_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.025. A one-sided test is assumed.</p>
</td></tr>
<tr><td><code id="coprimary.z_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="coprimary.z_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Crespi et al. (2025) for more details.
This function is based on the power.known.var function from the mpe R package and material from
Sozu T, Sugimoto T, Hamasaki T, Evans SR. (2015) Sample Size Determination in Clinical Trials
with Multiple Endpoints. Springer International Publishing, Switzerland.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>coprimary.z(K = 2, n1 = 100, delta = c(0.4, 0.5), sd = c(1, 1), rho = 0.3,
alpha = 0.025, power = NULL)

Sigma &lt;- matrix(c(1, 0.3, 0.3, 0.3, 1, 0.3, 0.3, 0.3, 1), nrow = 3, ncol = 3)
coprimary.z(K = 3, n1 = NULL, delta = c(0.2, 0.3, 0.4), Sigma = Sigma, alpha = 0.025, power = 0.8)

</code></pre>

<hr>
<h2 id='corr.1samp'>Power calculation for test of one correlation coefficient</h2><span id='topic+corr.1samp'></span>

<h3>Description</h3>

<p>Calculates power and sample size for a test that the correlation coefficient in a single population
is equal to (or less than or greater than) a specified value. Can solve for power, N or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr.1samp(
  N = NULL,
  rho0 = 0,
  rhoA = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr.1samp_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="corr.1samp_+3A_rho0">rho0</code></td>
<td>
<p>The correlation coefficient under the null hypothesis; defaults to 0.</p>
</td></tr>
<tr><td><code id="corr.1samp_+3A_rhoa">rhoA</code></td>
<td>
<p>The correlation coefficient under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="corr.1samp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="corr.1samp_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="corr.1samp_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="corr.1samp_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>corr.1samp(N = 100, rhoA = 0.2, sides = 1)
corr.1samp(N = 100, rho0 = 0.2, rhoA = 0.4, sides = 1)
</code></pre>

<hr>
<h2 id='corr.2samp'>Power calculation for comparing two correlation coefficients</h2><span id='topic+corr.2samp'></span>

<h3>Description</h3>

<p>Calculates power and sample size for a test that the correlation coefficients in two groups/populations
are equal. Can solve for power, n1, n.ratio or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr.2samp(
  n1 = NULL,
  n.ratio = 1,
  rho1 = NULL,
  rho2 = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr.2samp_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="corr.2samp_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="corr.2samp_+3A_rho1">rho1</code></td>
<td>
<p>The correlation coefficient in group 1.</p>
</td></tr>
<tr><td><code id="corr.2samp_+3A_rho2">rho2</code></td>
<td>
<p>The correlation coefficient in group 2.</p>
</td></tr>
<tr><td><code id="corr.2samp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="corr.2samp_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="corr.2samp_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="corr.2samp_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>corr.2samp(n1 = 300, rho1 = 0.3, rho2 = 0.1, sides = 1)
</code></pre>

<hr>
<h2 id='crt.long.cont'>Power for test of treatment effect in longitudinal cluster randomized trial with baseline measurement</h2><span id='topic+crt.long.cont'></span>

<h3>Description</h3>

<p>This function computes power and sample size for a cluster randomized trial in which a continuous
outcome variable is measured during both baseline and follow-up periods among
the cluster members, and it is planned that the outcome data will be analyzed using
a linear mixed model in which the dependent variable vector includes both baseline and follow up
measurements and there is a random intercept for cluster.
This function can solve for power, J1, J.ratio, m or delta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crt.long.cont(
  m = NULL,
  J1 = NULL,
  J.ratio = 1,
  delta = NULL,
  sd = 1,
  icc = 0,
  cac = 0,
  sac = 0,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crt.long.cont_+3A_m">m</code></td>
<td>
<p>The number of subjects measured during each cluster-period.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_j1">J1</code></td>
<td>
<p>The number of clusters in arm 1.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_j.ratio">J.ratio</code></td>
<td>
<p>The ratio J2/J1 between the number of clusters in the two arms; defaults to 1 (equal clusters per arm).</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_delta">delta</code></td>
<td>
<p>The difference between the intervention and control means under the alternative minus the difference under the null hypothesis.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_sd">sd</code></td>
<td>
<p>The total standard deviation of the outcome variable; defaults to 1.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_icc">icc</code></td>
<td>
<p>The within-cluster, within-period intraclass correlation coefficient; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_cac">cac</code></td>
<td>
<p>The cluster autocorrelation; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_sac">sac</code></td>
<td>
<p>The subject autocorrelation; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="crt.long.cont_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The intraclass correlation coefficient (icc) is the correlation between
two observations from different subjects in the same cluster and same time period.
Denote the correlation between observations from two
different subjects in the same cluster but different time periods as iccb.
The cluster autocorrelation (cac) is iccb/icc and is interpreted as the proportion of
the cluster-level variance that is time-invariant.
Denote the correlation between two observations from the same subject
in different time periods as rhoa.
The subject autocorrelation (sac) is (rhoa - icc)/(iccb - icc) and is interpreted as
the proportion of the subject-level variance that is time-invariant.
The sac is only relevant for design in which the same subjects are measured at both baseline and follow up.
If different subjects are measured during different time periods, sac should be set to zero.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>crt.long.cont(m = 30, J1 = 8, delta = 0.3, icc = 0.05, cac = 0.4, sac = 0.5)
</code></pre>

<hr>
<h2 id='crt.means.r'>Correlation between a cluster mean at baseline and follow up</h2><span id='topic+crt.means.r'></span>

<h3>Description</h3>

<p>For a cluster randomized trial with a continuous outcome, this function calculates the correlation
between a cluster's mean at baseline and at follow up based on various inputs.
For cross-sectional sampling of subjects,
that is, different subjects are measured at baseline and follow up, specify sac = 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crt.means.r(m, icc, cac, sac)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crt.means.r_+3A_m">m</code></td>
<td>
<p>The number of measurements in each cluster at baseline and follow up.</p>
</td></tr>
<tr><td><code id="crt.means.r_+3A_icc">icc</code></td>
<td>
<p>The intraclass correlation coefficient.</p>
</td></tr>
<tr><td><code id="crt.means.r_+3A_cac">cac</code></td>
<td>
<p>The cluster autocorrelation.</p>
</td></tr>
<tr><td><code id="crt.means.r_+3A_sac">sac</code></td>
<td>
<p>The subject autocorrelation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The computed correlation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>crt.means.r(m = 30, icc = 0.05, cac = 0.4, sac = 0.5)
</code></pre>

<hr>
<h2 id='crt.parallel.bin'>Power calculation for cluster randomized trial with binary outcome</h2><span id='topic+crt.parallel.bin'></span>

<h3>Description</h3>

<p>This function performs power and sample size calculations for a two-arm cluster randomized trial
with a binary outcome. It assumes the outcome analysis will be conducted using a mixed effect logistic
regression model that has a random intercept for cluster. Equal allocation of clusters to arms
is assumed. Can solve for power, J, m or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crt.parallel.bin(
  m = NULL,
  m.sd = 0,
  J = NULL,
  pc = NULL,
  pt = NULL,
  sigma.u = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crt.parallel.bin_+3A_m">m</code></td>
<td>
<p>The number of subjects per cluster.</p>
</td></tr>
<tr><td><code id="crt.parallel.bin_+3A_m.sd">m.sd</code></td>
<td>
<p>The standard deviation of cluster sizes (provide if unequal number of participants per cluster); defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.parallel.bin_+3A_j">J</code></td>
<td>
<p>The total number of clusters (over both arms).</p>
</td></tr>
<tr><td><code id="crt.parallel.bin_+3A_pc">pc</code></td>
<td>
<p>The probability of the outcome in control clusters.</p>
</td></tr>
<tr><td><code id="crt.parallel.bin_+3A_pt">pt</code></td>
<td>
<p>The probability of the outcome in treatment clusters.</p>
</td></tr>
<tr><td><code id="crt.parallel.bin_+3A_sigma.u">sigma.u</code></td>
<td>
<p>Standard deviation of the cluster random effect (random intercept).</p>
</td></tr>
<tr><td><code id="crt.parallel.bin_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="crt.parallel.bin_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="crt.parallel.bin_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="crt.parallel.bin_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For help selecting a reasonable value for sigma.u, consider using the crt.varexplore function.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>crt.parallel.bin(m = 60, J = NULL, pc = 0.25, pt = 0.15, sigma.u = 0.3, power = 0.8)
crt.parallel.bin(m = 60, m.sd = 1, J = NULL, pc = 0.25, pt = 0.15, sigma.u = 0.3, power = 0.8)
</code></pre>

<hr>
<h2 id='crt.parallel.cont'>Power for cluster randomized trial with continuous outcome</h2><span id='topic+crt.parallel.cont'></span>

<h3>Description</h3>

<p>This function performs power and sample size calculations for a two-arm cluster randomized trial
with a continuous, normal outcome. Can solve for power, J1, J.ratio, m or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crt.parallel.cont(
  m = NULL,
  m.sd = 0,
  J1 = NULL,
  J.ratio = 1,
  delta = NULL,
  sd = 1,
  icc1 = 0,
  icc2 = 0,
  ncov = 0,
  RsqB = 0,
  RsqW = 0,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crt.parallel.cont_+3A_m">m</code></td>
<td>
<p>The number of subjects per cluster or the mean cluster size (if unequal number of participants per cluster).</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_m.sd">m.sd</code></td>
<td>
<p>The standard deviation of cluster sizes (provide if unequal number of participants per cluster); defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_j1">J1</code></td>
<td>
<p>The number of clusters in arm 1.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_j.ratio">J.ratio</code></td>
<td>
<p>The ratio J2/J1 between the number of clusters in the two arms; defaults to 1 (equal clusters per arm).</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_delta">delta</code></td>
<td>
<p>The difference between the intervention and control means under the alternative minus the difference under the null hypothesis.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_sd">sd</code></td>
<td>
<p>The total standard deviation of the outcome variable; defaults to 1.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_icc1">icc1</code></td>
<td>
<p>The intraclass correlation coefficient in arm 1; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_icc2">icc2</code></td>
<td>
<p>The intraclass correlation coefficient in arm 2; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_ncov">ncov</code></td>
<td>
<p>The number of cluster-level and individual-level covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_rsqb">RsqB</code></td>
<td>
<p>The estimated proportion of total variance explained by cluster-level covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_rsqw">RsqW</code></td>
<td>
<p>The estimated proportion of total variance explained by individual-level covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="crt.parallel.cont_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>crt.parallel.cont(m = 30, J1 = 8, delta = 0.4, icc1 = 0.05, icc2 = 0.05)
crt.parallel.cont(m = NULL, J1 = 6, delta = 0.5, icc1 = 0.05, icc2 = 0.05, power = 0.8)
crt.parallel.cont(m = 25, m.sd = 15, J1 = NULL, delta = 0.3, icc1 = 0.05,
icc2 = 0.05, power = 0.8)
crt.parallel.cont(m = 20, J1 = 15, delta = 0.3, icc1 = 0.05, icc2 = 0.05,
RsqB = 0.1, ncov = 1, sides = 1)
</code></pre>

<hr>
<h2 id='crt.parallel.hte'>Power for detecting treatment effect heterogeneity in a cluster randomized trial with a continuous outcome</h2><span id='topic+crt.parallel.hte'></span>

<h3>Description</h3>

<p>This function performs power and sample size calculations for detecting a treatment-by-covariate
interaction effect in a two-arm cluster randomized trial
with a continuous outcome when the data will be analyzed using a linear mixed effects model
(random intercept for cluster and fixed effect for the treatment-by-covariate interaction).
Can solve for power, beta, J1, J.ratio or m.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crt.parallel.hte(
  m = NULL,
  J1 = NULL,
  J.ratio = 1,
  beta = NULL,
  sd.x = NULL,
  sd.yx = NULL,
  icc.x = 0,
  icc.yx = 0,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crt.parallel.hte_+3A_m">m</code></td>
<td>
<p>The number of subjects per cluster.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_j1">J1</code></td>
<td>
<p>The number of clusters in arm 1.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_j.ratio">J.ratio</code></td>
<td>
<p>The ratio J2/J1 between the number of clusters in the two arms; defaults to 1 (equal clusters per arm).</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_beta">beta</code></td>
<td>
<p>The regression coefficient for the treatment-by-covariate interaction term.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_sd.x">sd.x</code></td>
<td>
<p>The standard deviation of the covariate.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_sd.yx">sd.yx</code></td>
<td>
<p>The standard deviation of the outcome variable adjusting for the covariate.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_icc.x">icc.x</code></td>
<td>
<p>The intraclass correlation coefficient for the covariate; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_icc.yx">icc.yx</code></td>
<td>
<p>The intraclass correlation coefficient for the outcome adjusting for the covariate; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="crt.parallel.hte_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is based on Yang et al (2020). If the covariate is a cluster-level covariate,
then icc.x should be set to 1 (the covariate does not vary within cluster).
</p>
<p>Yang S, Li F, Starks MA, Hernandez AF, Mentz RJ, Choudhury KR (2020) Sample size requirements for detecting
treatment effect heterogeneity in cluster randomized trials. Statistics in Medicine 39:4218-4237.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>crt.parallel.hte(beta = 1, m = 27, J1 = 20, sd.x = 12.7, sd.yx = 71, icc.x = 0.08, icc.yx = 0.04)
</code></pre>

<hr>
<h2 id='crt.varexplore'>Variance exploration for cluster randomized trials with binary outcomes</h2><span id='topic+crt.varexplore'></span>

<h3>Description</h3>

<p>This function can be used to help select a plausible value for the variance/SD of the
random intercept for cluster in a cluster randomized trial with a binary outcome.
Based on user-supplied values of the outcome proportions in the two arms,
the function outputs, for a range of possible values of the SD of the
random intercept, the intervals within which we expect about 95% of the cluster-level
proportions to lie in each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crt.varexplore(pc, pt, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crt.varexplore_+3A_pc">pc</code></td>
<td>
<p>The probability of the outcome in control clusters.</p>
</td></tr>
<tr><td><code id="crt.varexplore_+3A_pt">pt</code></td>
<td>
<p>The probability of the outcome in treatment clusters.</p>
</td></tr>
<tr><td><code id="crt.varexplore_+3A_print">print</code></td>
<td>
<p>Whether or not to print the results in a table; defaults to TRUE. To retrieve the results even when print = FALSE, assign the function output to an object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The use of this function is illustrated in Crespi CM (2025) Power and Sample Size in R.
</p>


<h3>Value</h3>

<p>A list of the arguments and a dataframe of outputs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>crt.varexplore(pc = 0.25, pt = 0.15)
output &lt;- crt.varexplore(pc = 0.25, pt = 0.15, print = FALSE)
output$pc
</code></pre>

<hr>
<h2 id='crt.xo.cont'>Power for test of treatment effect in 2x2 crossover cluster randomized trial</h2><span id='topic+crt.xo.cont'></span>

<h3>Description</h3>

<p>Power and sample size calculation for a 2x2 crossover cluster randomized trial.
Can solve for power, number of clusters per arm (assumes equal number of
cluster per arm), m, delta or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crt.xo.cont(
  m = NULL,
  J.arm = NULL,
  delta = NULL,
  sd = 1,
  icc = 0,
  icca = 0,
  iccb = NULL,
  cac = NULL,
  sac = 0,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crt.xo.cont_+3A_m">m</code></td>
<td>
<p>The number of subjects measured during each cluster-period.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_j.arm">J.arm</code></td>
<td>
<p>The number of clusters in each arm.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_delta">delta</code></td>
<td>
<p>The difference between the intervention and control means under the alternative minus the difference under the null hypothesis.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_sd">sd</code></td>
<td>
<p>The total standard deviation of the outcome variable; defaults to 1.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_icc">icc</code></td>
<td>
<p>The within-cluster, within-period intraclass correlation coefficient; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_icca">icca</code></td>
<td>
<p>The  within-cluster, within-subject correlation (correlation between two measurements within the same subject); defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_iccb">iccb</code></td>
<td>
<p>The within-cluster, between-period intraclass correlation coefficient. Either iccb OR cac must be specified.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_cac">cac</code></td>
<td>
<p>The cluster autocorrelation. Either iccb OR cac must be specified.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_sac">sac</code></td>
<td>
<p>The subject autocorrelation; defaults to 0.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.05.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="crt.xo.cont_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>crt.xo.cont(m = 30, J.arm = 4, delta = 0.3, icc = 0.05, cac = 0.8, sac = 0.4)
crt.xo.cont(m = 30, J.arm = 4, delta = 0.3, icc = 0.05, icca = 0.42, iccb = 0.04)
crt.xo.cont(m = 30, J.arm = 4, delta = 0.3, icc = 0.05, cac = 0.5)
</code></pre>

<hr>
<h2 id='es.anova.f'>Cohen f effect size calculation for one- or two- way analysis of variance</h2><span id='topic+es.anova.f'></span>

<h3>Description</h3>

<p>Calculates teh Cohen f effect size for a one- or two-way ANOVA.
Takes as input the cell or group means for a one- or two-way ANOVA and the common
standard deviation and outputs the f effect size, as defined by Cohen (1988). Note that
this effect size calculation is only valid when cell/group sizes are equal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>es.anova.f(means = NULL, sd = NULL, v = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="es.anova.f_+3A_means">means</code></td>
<td>
<p>A vector or matrix of group means.</p>
</td></tr>
<tr><td><code id="es.anova.f_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation within each group.</p>
</td></tr>
<tr><td><code id="es.anova.f_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cohen J (1988) Statistical Power Analysis for the Behavioral Sciences, 2nd edition.
Lawrence Erlbaum Associates, Hillsdale, New Jersey
</p>


<h3>Value</h3>

<p>Various calculated f effect sizes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>es.anova.f(means = c(5, 10, 12), sd = 10)
mmatrix &lt;- matrix(c(9.3, 8.9, 8.5, 8.7, 8.3, 7.9), nrow = 2, byrow = TRUE)
es.anova.f(means = mmatrix, sd = 2)
</code></pre>

<hr>
<h2 id='es.d'>Cohen d effect size calculation for one or two means</h2><span id='topic+es.d'></span>

<h3>Description</h3>

<p>This function takes as inputs a difference between two means and a standard deviation
and outputs the d effect size as defined by Cohen (1988),
also called the standardized mean difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>es.d(delta = NULL, sd = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="es.d_+3A_delta">delta</code></td>
<td>
<p>If one mean: muA (the true mean) - mu0 (the mean under the null). If two means: DeltaA (the true difference mu1 - mu2) - Delta0 (the difference under the null).</p>
</td></tr>
<tr><td><code id="es.d_+3A_sd">sd</code></td>
<td>
<p>The estimated standard deviation; defaults to 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cohen J (1988) Statistical Power Analysis for the Behavioral Sciences, 2nd edition.
Lawrence Erlbaum Associates, Hillsdale, New Jersey
</p>


<h3>Value</h3>

<p>A list of the arguments and the d effect size.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>es.d(delta = 6.5 - 5.7, sd = 0.4)
</code></pre>

<hr>
<h2 id='es.fsq'>Cohen f-squared effect size for overall F test in multiple linear regression</h2><span id='topic+es.fsq'></span>

<h3>Description</h3>

<p>Computes the f-squared (r^2) effect size for an overall F test in a multiple linear regression model
based on the model R^2 (Rsq). Based on Cohen (1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>es.fsq(Rsq = 0.02)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="es.fsq_+3A_rsq">Rsq</code></td>
<td>
<p>The squared sample multiple correlation coefficient.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cohen J (1988) Statistical Power Analysis for the Behavioral Sciences, 2nd edition.
Lawrence Erlbaum Associates, Hillsdale, New Jersey
</p>


<h3>Value</h3>

<p>A list of the arguments and the f^2 effect size.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>es.fsq(Rsq = 0.02)
</code></pre>

<hr>
<h2 id='es.h'>Cohen h effect size calculation for two proportions</h2><span id='topic+es.h'></span>

<h3>Description</h3>

<p>Takes as input the outcome proportions in two groups and returns the h effect size
as defined by Cohen (1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>es.h(p1 = NULL, p2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="es.h_+3A_p1">p1</code></td>
<td>
<p>The outcome proportion in group 1.</p>
</td></tr>
<tr><td><code id="es.h_+3A_p2">p2</code></td>
<td>
<p>The outcome proportion in group 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cohen J (1988) Statistical Power Analysis for the Behavioral Sciences, 2nd edition.
Lawrence Erlbaum Associates, Hillsdale, New Jersey
</p>


<h3>Value</h3>

<p>A list of the arguments and the h effect size.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>es.h(p1 = 0.8, p2 = 0.6)
</code></pre>

<hr>
<h2 id='es.q'>Cohen q effect size calculation for two correlation coefficients</h2><span id='topic+es.q'></span>

<h3>Description</h3>

<p>Calculates the q effect size for comparing two correlation coefficients. Based on Cohen (1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>es.q(rho1 = NULL, rho2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="es.q_+3A_rho1">rho1</code></td>
<td>
<p>The correlation coefficient in group 1.</p>
</td></tr>
<tr><td><code id="es.q_+3A_rho2">rho2</code></td>
<td>
<p>The correlation coefficient in group 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cohen J (1988) Statistical Power Analysis for the Behavioral Sciences, 2nd edition.
Lawrence Erlbaum Associates, Hillsdale, New Jersey
</p>


<h3>Value</h3>

<p>A list of the arguments and the q effect size.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>es.q(rho1 = 0.3, rho2 = 0.1)
</code></pre>

<hr>
<h2 id='es.w'>Cohen w effect size calculation for chi-square tests</h2><span id='topic+es.w'></span>

<h3>Description</h3>

<p>Calculates the w effect size for chi-square tests. For chi-square goodness of fit tests, specify
p0vec and p1vec. For chi-square tests of independence, provide a matrix of cell probabilities.
Based on Cohen (1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>es.w(p0vec = NULL, p1vec = NULL, pmatrix = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="es.w_+3A_p0vec">p0vec</code></td>
<td>
<p>The first vector of probabilities. Both p0vec and p1vec, or pmatrix must be specified.</p>
</td></tr>
<tr><td><code id="es.w_+3A_p1vec">p1vec</code></td>
<td>
<p>The second vector of probabilities. Both p0vec and p1vec, or pmatrix must be specified.</p>
</td></tr>
<tr><td><code id="es.w_+3A_pmatrix">pmatrix</code></td>
<td>
<p>The two-way probability table. Both p0vec and p1vec, or pmatrix must be specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Cohen J (1988) Statistical Power Analysis for the Behavioral Sciences, 2nd edition.
Lawrence Erlbaum Associates, Hillsdale, New Jersey
</p>


<h3>Value</h3>

<p>A list of the arguments and the w effect size.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>es.w(p0vec = c(0.5, 0.3, 0.2), p1vec = c(0.7, 0.2, 0.1))
es.w(pmatrix = matrix(c(0.050, 0.350, 0.100, 0.075, 0.250, 0.175), nrow = 2, byrow = TRUE))
</code></pre>

<hr>
<h2 id='irgtt.bin'>Power for individual randomized group treatment trial with binary outcome</h2><span id='topic+irgtt.bin'></span>

<h3>Description</h3>

<p>Computes power and sample size for an individually randomized group treatment trial with
a binary outcome, in which after individual randomization, individuals in the
intervention/treatment arm are clustered. Can solve for power, J, m, n, or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>irgtt.bin(
  m = NULL,
  J = NULL,
  n = NULL,
  p1 = NULL,
  p2 = NULL,
  icc = 0,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="irgtt.bin_+3A_m">m</code></td>
<td>
<p>The number of subjects per cluster in the intervention arm.</p>
</td></tr>
<tr><td><code id="irgtt.bin_+3A_j">J</code></td>
<td>
<p>The total number of clusters in the intervention arm.</p>
</td></tr>
<tr><td><code id="irgtt.bin_+3A_n">n</code></td>
<td>
<p>The total number of participants in the control arm.</p>
</td></tr>
<tr><td><code id="irgtt.bin_+3A_p1">p1</code></td>
<td>
<p>The probability of the outcome in the control arm.</p>
</td></tr>
<tr><td><code id="irgtt.bin_+3A_p2">p2</code></td>
<td>
<p>The probability of the outcome in the intervention arm.</p>
</td></tr>
<tr><td><code id="irgtt.bin_+3A_icc">icc</code></td>
<td>
<p>The intraclass correlation coefficient in the intervention arm; defaults to 0.</p>
</td></tr>
<tr><td><code id="irgtt.bin_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="irgtt.bin_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="irgtt.bin_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two-sided hypothesis test.</p>
</td></tr>
<tr><td><code id="irgtt.bin_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>irgtt.bin(m = 20, J = 5, n = 100, p1 = 0.8, p2 = 0.6, icc = 0.04, sides = 2)
irgtt.bin(m = 20, J = 6, n = 120, p1 = 0.8, p2 = 0.6, icc = 0.04, sides = 2)
</code></pre>

<hr>
<h2 id='irgtt.cont'>Power for individually randomized group treatment trial with continuous outcome</h2><span id='topic+irgtt.cont'></span>

<h3>Description</h3>

<p>Computes power and sample size for an individually randomized group treatment trial with
a continuous outcome, in which after individual randomization, individuals in the
intervention/treatment arm are clustered. Can solve for power, J, m, n, delta or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>irgtt.cont(
  m = NULL,
  J = NULL,
  n = NULL,
  delta = NULL,
  sd = 1,
  icc = 0,
  Theta = 1,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  tol = .Machine$double.eps^0.25,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="irgtt.cont_+3A_m">m</code></td>
<td>
<p>The number of subjects per cluster in the intervention arm.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_j">J</code></td>
<td>
<p>The total number of clusters in the intervention arm.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_n">n</code></td>
<td>
<p>The total number of participants in the control arm.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_delta">delta</code></td>
<td>
<p>The difference between the intervention and control means under the alternative minus the difference under the null hypothesis.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_sd">sd</code></td>
<td>
<p>The total standard deviation of the outcome variable in the control arm; defaults to 1.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_icc">icc</code></td>
<td>
<p>The intraclass correlation coefficient in the treatment arm; defaults to 0.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_theta">Theta</code></td>
<td>
<p>The ratio of the total variance in the intervention and control arms; defaults to 1.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two-sided hypothesis test.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_tol">tol</code></td>
<td>
<p>The desired accuracy (convergence tolerance) for uniroot.</p>
</td></tr>
<tr><td><code id="irgtt.cont_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Power is solved for using noncentral t or F distribution; other quantities
(for example, sample sizes) are solved
for using normal approximation.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>irgtt.cont(m = 10, J = 12, n = 120, delta = 0.4, icc = 0.05, Theta = 1, power = NULL)
irgtt.cont(m = 10, J = 12, n = NULL, delta = 0.4, icc = 0.05, Theta = 1, power = 0.8)
</code></pre>

<hr>
<h2 id='irt.hte'>Power for detecting treatment effect heterogeneity in an individually randomized trial with a continuous outcome</h2><span id='topic+irt.hte'></span>

<h3>Description</h3>

<p>This function performs power and sample size calculations for detecting a treatment-by-covariate
interaction effect in a two-arm randomized trial
with a continuous outcome. Can solve for power, beta, n1 or n.ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>irt.hte(
  n1 = NULL,
  n.ratio = 1,
  beta = NULL,
  sd.x = NULL,
  sd.yx = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="irt.hte_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="irt.hte_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="irt.hte_+3A_beta">beta</code></td>
<td>
<p>The regression coefficient for the treatment-by-covariate interaction term.</p>
</td></tr>
<tr><td><code id="irt.hte_+3A_sd.x">sd.x</code></td>
<td>
<p>The standard deviation of the covariate.</p>
</td></tr>
<tr><td><code id="irt.hte_+3A_sd.yx">sd.yx</code></td>
<td>
<p>The standard deviation of the outcome variable adjusting for the covariate.</p>
</td></tr>
<tr><td><code id="irt.hte_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="irt.hte_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="irt.hte_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="irt.hte_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shieh G (2009) Detecting interaction effects in moderated multiple regression with continuous variables:
power and sample size considerations. Organizational Research Methods 12(3):510-528.
</p>
<p>Yang S, Li F, Starks MA, Hernandez AF, Mentz RJ, Choudhury KR (2020) Sample size requirements for detecting
treatment effect heterogeneity in cluster randomized trials. Statistics in Medicine 39:4218-4237.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>irt.hte(n1 = 540, n.ratio = 1, beta = 1, sd.x = 12.7, sd.yx = 71)
</code></pre>

<hr>
<h2 id='matrix.format'>Internal-use function for displaying matrices in function outputs</h2><span id='topic+matrix.format'></span>

<h3>Description</h3>

<p>Internal-use function for displaying matrices in function outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix.format(matrix = NULL, nspaces = 18)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matrix.format_+3A_matrix">matrix</code></td>
<td>
<p>The matrix to be displayed.</p>
</td></tr>
<tr><td><code id="matrix.format_+3A_nspaces">nspaces</code></td>
<td>
<p>The number of white spaces before the matrix; defaults to 18.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix printed as a string with rows separated by newline.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>matrix &lt;- matrix(c(1, 2, 3, 4), nrow = 2)
matrix.format(matrix = matrix)
</code></pre>

<hr>
<h2 id='mlrF.overall'>Power calculation for a multiple linear regression overall F test</h2><span id='topic+mlrF.overall'></span>

<h3>Description</h3>

<p>Conducts power and sample size calculations for an overall (or omnibus) F test
in a multiple linear regression model.
This is a test that all coefficients other than the intercept are equal to zero.
Can solve for power, N or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlrF.overall(
  N = NULL,
  p = NULL,
  Rsq = NULL,
  fsq = NULL,
  alpha = 0.05,
  power = NULL,
  random = FALSE,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mlrF.overall_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="mlrF.overall_+3A_p">p</code></td>
<td>
<p>The number of predictors.</p>
</td></tr>
<tr><td><code id="mlrF.overall_+3A_rsq">Rsq</code></td>
<td>
<p>The squared population multiple correlation coefficient.</p>
</td></tr>
<tr><td><code id="mlrF.overall_+3A_fsq">fsq</code></td>
<td>
<p>The f-squared effect size. Either Rsq OR fsq must be specified.</p>
</td></tr>
<tr><td><code id="mlrF.overall_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.05.</p>
</td></tr>
<tr><td><code id="mlrF.overall_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="mlrF.overall_+3A_random">random</code></td>
<td>
<p>Whether the values of the predictors are random; defaults to FALSE.</p>
</td></tr>
<tr><td><code id="mlrF.overall_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either Rsq OR fsq must be specified. These are related as fsq = Rsq/(1-Rsq).
Rsq is the proportion of the total variation in Y that is explained by
linear relationship with the predictors. Specifying random = TRUE
yields a calculation in which Y and the predictors are assumed to have
a multivariate normal distribution; see Crespi (2025).
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mlrF.overall(N = 400, p = 2, Rsq = 0.02)
mlrF.overall(N = 400, p = 2, fsq = 0.02 / (1 - 0.02))
mlrF.overall(N = 109, p = 1, Rsq = 0.3^2)
mlrF.overall(N = 50, p = 1, Rsq = 0.2)
mlrF.overall(N = 50, p = 3, Rsq = 0.2)
mlrF.overall(N = 50, p = 5, Rsq = 0.2)
mlrF.overall(N = 400, p = 2, Rsq = 0.02, random = TRUE)
</code></pre>

<hr>
<h2 id='mlrF.partial'>Power calculation for a multiple linear regression partial F test</h2><span id='topic+mlrF.partial'></span>

<h3>Description</h3>

<p>Conducts power and sample size calculations for a partial F test
in a multiple linear regression model.
This is a test that one or more coefficients are equal to zero
after controlling for a set of control predictors.
Can solve for power, N or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlrF.partial(
  N = NULL,
  p = NULL,
  q = NULL,
  pc = NULL,
  Rsq.red = NULL,
  Rsq.full = NULL,
  alpha = 0.05,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mlrF.partial_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="mlrF.partial_+3A_p">p</code></td>
<td>
<p>The number of control predictors.</p>
</td></tr>
<tr><td><code id="mlrF.partial_+3A_q">q</code></td>
<td>
<p>The number of test predictors.</p>
</td></tr>
<tr><td><code id="mlrF.partial_+3A_pc">pc</code></td>
<td>
<p>The partial correlation coefficient. Either both Rsq terms OR pc must be specified.</p>
</td></tr>
<tr><td><code id="mlrF.partial_+3A_rsq.red">Rsq.red</code></td>
<td>
<p>The squared population multiple correlation coefficient for the reduced model. Either both Rsq terms OR pc must be specified.</p>
</td></tr>
<tr><td><code id="mlrF.partial_+3A_rsq.full">Rsq.full</code></td>
<td>
<p>The squared population multiple correlation coefficient for the full model. Either both Rsq terms OR pc must be specified.</p>
</td></tr>
<tr><td><code id="mlrF.partial_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.05.</p>
</td></tr>
<tr><td><code id="mlrF.partial_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="mlrF.partial_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mlrF.partial(N = 80, p = 3, q = 2, Rsq.red = 0.25, Rsq.full = 0.35)
mlrF.partial(N = 150, p = 4, pc = 0.2)
</code></pre>

<hr>
<h2 id='ms.varexplore'>Variance exploration for a multisite trial with a binary outcome</h2><span id='topic+ms.varexplore'></span>

<h3>Description</h3>

<p>This function can be used to help select a plausible value for the variance/SD of the
random intercept for site in a multisite trial with a binary outcome.
Based on user-supplied values of the outcome proportions in the two conditions,
this function outputs, for a range of possible values of the SD, the intervals
within which we expect about 95% of the site-specific
odds ratios to lie.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ms.varexplore(pc, pt, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ms.varexplore_+3A_pc">pc</code></td>
<td>
<p>The probability of the outcome in control clusters.</p>
</td></tr>
<tr><td><code id="ms.varexplore_+3A_pt">pt</code></td>
<td>
<p>The probability of the outcome in treatment clusters.</p>
</td></tr>
<tr><td><code id="ms.varexplore_+3A_print">print</code></td>
<td>
<p>Whether or not to print the results in a table; defaults to TRUE. To retrieve the results even when print = FALSE, assign the function output to an object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In a multisite trial design, participants are randomized to conditions within site.
The use of this function is illustrated in Crespi CM (2025) Power and Sample Size in R.
</p>


<h3>Value</h3>

<p>A list containing the calculated OR and a dataframe of outputs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ms.varexplore(pc = 0.1, pt = 0.2)
output &lt;- ms.varexplore(pc = 0.1, pt = 0.2, print = FALSE)
output$OR
</code></pre>

<hr>
<h2 id='multisite.bin'>Power for a multisite trial with a binary outcome</h2><span id='topic+multisite.bin'></span>

<h3>Description</h3>

<p>Performs power and sample size calculations for a multisite trial with a
binary outcome. Can solve for power, J, m or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multisite.bin(
  m = NULL,
  alloc.ratio = 1,
  J = NULL,
  pc = NULL,
  pt = NULL,
  sigma.u = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multisite.bin_+3A_m">m</code></td>
<td>
<p>The total number of subjects in condition 1 + condition 2.</p>
</td></tr>
<tr><td><code id="multisite.bin_+3A_alloc.ratio">alloc.ratio</code></td>
<td>
<p>The allocation ratio of condition 1/condition 2 within site; defaults to 1.</p>
</td></tr>
<tr><td><code id="multisite.bin_+3A_j">J</code></td>
<td>
<p>The total number of sites.</p>
</td></tr>
<tr><td><code id="multisite.bin_+3A_pc">pc</code></td>
<td>
<p>The probability of the outcome in the control condition.</p>
</td></tr>
<tr><td><code id="multisite.bin_+3A_pt">pt</code></td>
<td>
<p>The probability of the outcome in the treatment condition.</p>
</td></tr>
<tr><td><code id="multisite.bin_+3A_sigma.u">sigma.u</code></td>
<td>
<p>Standard deviation of the treatment effect across sites.</p>
</td></tr>
<tr><td><code id="multisite.bin_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.05.</p>
</td></tr>
<tr><td><code id="multisite.bin_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="multisite.bin_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="multisite.bin_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In a multisite trial design, participants are randomized to conditions
within site. Consider using ms.varexplore to select plausible values
for sigma.u.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>multisite.bin(m = 30, J = 25, pc = 0.1, pt = 0.2, sigma.u = 0.4, power = NULL)
multisite.bin(m = 30, J = NULL, pc = 0.1, pt = 0.2, sigma.u = 0.4, power = 0.9)
</code></pre>

<hr>
<h2 id='multisite.cont'>Power for test of average treatment effect in a multisite trial</h2><span id='topic+multisite.cont'></span>

<h3>Description</h3>

<p>Performs power and sample size calculations for a multisite trial with a
continuous (normal) outcome variable. Can solve for power, J, m or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multisite.cont(
  m = NULL,
  m.sd = 0,
  alloc.ratio = 1,
  J = NULL,
  delta = NULL,
  sd = 1,
  icc0 = NULL,
  icc1 = NULL,
  Rsq = 0,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multisite.cont_+3A_m">m</code></td>
<td>
<p>The mean cluster/site size (number of participants per site).</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_m.sd">m.sd</code></td>
<td>
<p>The standard deviation of cluster/site sizes (provide if unequal number of participants per site);
defaults to 0.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_alloc.ratio">alloc.ratio</code></td>
<td>
<p>The allocation ratio of condition 2/condition 1 within site; defaults to 1.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_j">J</code></td>
<td>
<p>The total number of sites.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_delta">delta</code></td>
<td>
<p>The difference between the condition 1 and condition 2 means under the alternative
minus the difference under the null hypothesis.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_sd">sd</code></td>
<td>
<p>The total standard deviation of the outcome variable; defaults to 1.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_icc0">icc0</code></td>
<td>
<p>The proportion of total variance of the outcome attributable to variation in site-level means.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_icc1">icc1</code></td>
<td>
<p>The proportion of total variance of the outcome attributable to variation in the treatment effect across sites.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_rsq">Rsq</code></td>
<td>
<p>The estimated R^2 for regressing the outcome on the covariates; defaults to 0.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="multisite.cont_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In a multisite trial design, participants are randomized to conditions
within site.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>multisite.cont(m = 20, J = 10, delta = 3, sd = sqrt(40), icc0 = 0.1, icc1 = 0)
multisite.cont(m = 20, J = 10, delta = 3, sd = sqrt(48), icc0 = 0.095, icc1 = 0.048)
multisite.cont(m = 20, alloc.ratio = 1.5, J = 10, delta = 0.43, icc0 = 0.095, icc1 = 0.048)
multisite.cont(m = 10, J = NULL, delta = 0.5, sd = 1, icc0 = 0, icc1 = 0.05, power = 0.8)
multisite.cont(m = 20, m.sd = 5, J = 10, delta = 3, sd = sqrt(48), icc0 = 0.095, icc1 = 0.048)
multisite.cont(m = 20, J = 10, delta = 3, sd = sqrt(48), icc0 = 0.095,
icc1 = 0.048, Rsq = 0.5^2)
</code></pre>

<hr>
<h2 id='multisite.hte'>Power for test of heterogeneity of treatment effect in a multisite trial</h2><span id='topic+multisite.hte'></span>

<h3>Description</h3>

<p>Calculates power for a test of heterogeneity of the treatment effect
in a multisite trial with a continuous outcome variable. In particular,
let sigma.u1^2 be the variance of the site-level treatment effects.
The test of heterogeneity tests the null hypothesis that sigma.u1^2 = 0
versus the alternative that sigma.u1^2 &gt; 0.
Can solve for power, J, or m.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multisite.hte(
  m = NULL,
  alloc.ratio = 1,
  J = NULL,
  VR = NULL,
  alpha = 0.05,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multisite.hte_+3A_m">m</code></td>
<td>
<p>The mean number of subjects per site.</p>
</td></tr>
<tr><td><code id="multisite.hte_+3A_alloc.ratio">alloc.ratio</code></td>
<td>
<p>The allocation ratio of intervention/control subjects per site; defaults to 1.</p>
</td></tr>
<tr><td><code id="multisite.hte_+3A_j">J</code></td>
<td>
<p>The total number of sites.</p>
</td></tr>
<tr><td><code id="multisite.hte_+3A_vr">VR</code></td>
<td>
<p>The variance ratio (variance of the site-level treatment effects divided by variance of
observations within sites) under the alternative.</p>
</td></tr>
<tr><td><code id="multisite.hte_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="multisite.hte_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="multisite.hte_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Crespi CM (2025) for details.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed power).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>multisite.hte(m = 10, J = 30, VR = 8 / 36)
</code></pre>

<hr>
<h2 id='prop.1samp'>Power calculation for one-sample proportion test</h2><span id='topic+prop.1samp'></span>

<h3>Description</h3>

<p>Performs power and sample size calculations for a one-sample test of a proportion.
Calculations use the large-sample normal approximation to the binomial. Can solve
for power, N or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prop.1samp(
  N = NULL,
  p0 = NULL,
  pA = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prop.1samp_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="prop.1samp_+3A_p0">p0</code></td>
<td>
<p>The proportion under the null.</p>
</td></tr>
<tr><td><code id="prop.1samp_+3A_pa">pA</code></td>
<td>
<p>The true proportion.</p>
</td></tr>
<tr><td><code id="prop.1samp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="prop.1samp_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="prop.1samp_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="prop.1samp_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prop.1samp(N = NULL, p0 = 0.2, pA = 0.3, power = 0.8, sides = 1)
prop.1samp(N = NULL, p0 = 0.4, pA = 0.5, power = 0.8, sides = 1)

</code></pre>

<hr>
<h2 id='prop.2samp'>Power calculation for two-sample proportion test</h2><span id='topic+prop.2samp'></span>

<h3>Description</h3>

<p>Performs power and sample size calculations for two-sample tests of proportions
using normal approximation to the binomial. Can solve for power, n1, n.ratio
or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prop.2samp(
  n1 = NULL,
  n.ratio = 1,
  p1 = NULL,
  p2 = NULL,
  margin = 0,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prop.2samp_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="prop.2samp_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="prop.2samp_+3A_p1">p1</code></td>
<td>
<p>The proportion in group 1.</p>
</td></tr>
<tr><td><code id="prop.2samp_+3A_p2">p2</code></td>
<td>
<p>The proportion in group 2.</p>
</td></tr>
<tr><td><code id="prop.2samp_+3A_margin">margin</code></td>
<td>
<p>The margin of noninferiority or superiority; defaults to 0.</p>
</td></tr>
<tr><td><code id="prop.2samp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="prop.2samp_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="prop.2samp_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="prop.2samp_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a noninferiority or superiority by a margin test, a one-sided test should be used. See Crespi (2025)
for more guidance. For an equivalence test for two proportions, see the prop.test.equiv.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prop.2samp(n1 = NULL, p1 = 0.6, p2 = 0.8, alpha = 0.025, power = 0.9, sides = 1)
prop.2samp(n1 = NULL, p1 = 0.25, p2 = 0.25, margin = 0.1, alpha = 0.025, power = 0.8, sides = 1)
</code></pre>

<hr>
<h2 id='prop.paired'>Power calculation for McNemar test of two correlated proportions</h2><span id='topic+prop.paired'></span>

<h3>Description</h3>

<p>Performs power and sample size calculation for McNemar test of two correlated
proportions using normal approximation. Can solve for power, N or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prop.paired(
  N = NULL,
  p1 = NULL,
  p2 = NULL,
  phi = NULL,
  paid = NULL,
  dpr = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prop.paired_+3A_n">N</code></td>
<td>
<p>The sample size; the number of pairs.</p>
</td></tr>
<tr><td><code id="prop.paired_+3A_p1">p1</code></td>
<td>
<p>The outcome proportion under condition 1.</p>
</td></tr>
<tr><td><code id="prop.paired_+3A_p2">p2</code></td>
<td>
<p>The outcome proportion under condition 2.</p>
</td></tr>
<tr><td><code id="prop.paired_+3A_phi">phi</code></td>
<td>
<p>The correlation between the two responses from an individual.</p>
</td></tr>
<tr><td><code id="prop.paired_+3A_paid">paid</code></td>
<td>
<p>The smaller of the two discordant probabilities. Either p1, p2 and phi, OR paid and dpr must be specified.</p>
</td></tr>
<tr><td><code id="prop.paired_+3A_dpr">dpr</code></td>
<td>
<p>The discordant proportion ratio. Must be greater than or equal to 1. Either p1, p2, and phi, OR paid and dpr must be specified.</p>
</td></tr>
<tr><td><code id="prop.paired_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="prop.paired_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="prop.paired_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="prop.paired_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either p1, p2 and phi, OR paid and dpr must be specified.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prop.paired(N = NULL, p1 = 0.8, p2 = 0.9, phi = 0, power = 0.9, sides = 2)
prop.paired(N = NULL, paid = 0.08, dpr = 0.18 / 0.08, power = 0.9, sides = 2)
</code></pre>

<hr>
<h2 id='prop.test.equiv'>Power calculation for test of equivalence of two proportions</h2><span id='topic+prop.test.equiv'></span>

<h3>Description</h3>

<p>Performs power and sample size calculations for a test of equivalence for two
proportions. Can solve for power, n1, n.ratio or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prop.test.equiv(
  n1 = NULL,
  n.ratio = 1,
  p1 = NULL,
  p2 = NULL,
  margin = NULL,
  alpha = 0.05,
  power = NULL,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prop.test.equiv_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="prop.test.equiv_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="prop.test.equiv_+3A_p1">p1</code></td>
<td>
<p>The outcome proportion in group 1.</p>
</td></tr>
<tr><td><code id="prop.test.equiv_+3A_p2">p2</code></td>
<td>
<p>The outcome proportion in group 2.</p>
</td></tr>
<tr><td><code id="prop.test.equiv_+3A_margin">margin</code></td>
<td>
<p>The equivalence margin.</p>
</td></tr>
<tr><td><code id="prop.test.equiv_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.05.</p>
</td></tr>
<tr><td><code id="prop.test.equiv_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="prop.test.equiv_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prop.test.equiv(n1 = NULL, p1 = 0.5, p2 = 0.5, margin = 0.1, alpha = 0.05, power = 0.8)
</code></pre>

<hr>
<h2 id='propodds'>Power calculations for ordinal categorical variable under proportional odds assumption</h2><span id='topic+propodds'></span>

<h3>Description</h3>

<p>Performs power and sample size calculation for a comparison of two groups on
an ordinal categorical response variable.
Assumes that response probabilities follow the proportional
odds assumption. Can solve for power, n1, n.ratio and alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>propodds(pC, OR, n1, n.ratio = 1, alpha = 0.05, power = NULL, v = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="propodds_+3A_pc">pC</code></td>
<td>
<p>Vector of response probabilities in control group (group 1). Must sum to 1. Categories are ordered from best to worst.</p>
</td></tr>
<tr><td><code id="propodds_+3A_or">OR</code></td>
<td>
<p>Odds ratio when the alternative is true. Must be greater than 1.</p>
</td></tr>
<tr><td><code id="propodds_+3A_n1">n1</code></td>
<td>
<p>Sample size for group 1 (control group).</p>
</td></tr>
<tr><td><code id="propodds_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="propodds_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="propodds_+3A_power">power</code></td>
<td>
<p>The specified level of power; defaults to 0.8.</p>
</td></tr>
<tr><td><code id="propodds_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Whitehead J. (1993) Sample size calculations for ordered categorical data.
Statistics in Medicine, 12(24):2257–2271
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(Hmisc)
pC &lt;- c(0.2, 0.5, 0.2, 0.1)
propodds(pC = pC, OR = 2.5, n1 = 65, n.ratio = 1, alpha = 0.05)
</code></pre>

<hr>
<h2 id='ranksum'>Power calculation for rank-sum test</h2><span id='topic+ranksum'></span>

<h3>Description</h3>

<p>This function performs power and sample size calculations for the
Wilcoxon-Mann-Whitney rank-sum test, also called the Mann-Whitney U test,
which is the nonparametric analog of the two independent sample t test.
Calculations are based on the approximation given by
Noether (1987) Sample size determination for some common nonparametric tests. JASA 82(398):645-647.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ranksum(
  n1 = NULL,
  n.ratio = 1,
  p = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ranksum_+3A_n1">n1</code></td>
<td>
<p>The sample size in group 1.</p>
</td></tr>
<tr><td><code id="ranksum_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="ranksum_+3A_p">p</code></td>
<td>
<p>The probability that an observation in group 2 is greater than an observation in group 1 (P(Y&gt;X).</p>
</td></tr>
<tr><td><code id="ranksum_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="ranksum_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="ranksum_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two-sided hypothesis test.</p>
</td></tr>
<tr><td><code id="ranksum_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to symmetry, the power for p is equal to the power for 1 - p. Therefore,
when solving for p, two values, p and 1 - p, are returned.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ranksum(n1 = 10, n.ratio = 1, p = 0.8, alpha = 0.05, power = NULL, sides = 2)
</code></pre>

<hr>
<h2 id='re.clustsize.bin'>Relative efficiency of a cluster randomized trial with binary outcome
with varying cluster sizes</h2><span id='topic+re.clustsize.bin'></span>

<h3>Description</h3>

<p>For a binary outcome, computes the relative efficiency (ratio of the variances) of a cluster randomized trial
with varying cluster sizes to that of a cluster randomized trial with constant cluster sizes,
assuming equal total number of subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>re.clustsize.bin(m, m.sd, pc, pt, sigma.u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="re.clustsize.bin_+3A_m">m</code></td>
<td>
<p>The number of subjects per cluster or the mean cluster size (if unequal number of participants per cluster).</p>
</td></tr>
<tr><td><code id="re.clustsize.bin_+3A_m.sd">m.sd</code></td>
<td>
<p>The standard deviation of cluster sizes (in case of unequal number of participants per cluster).</p>
</td></tr>
<tr><td><code id="re.clustsize.bin_+3A_pc">pc</code></td>
<td>
<p>The probability of the outcome in control clusters.</p>
</td></tr>
<tr><td><code id="re.clustsize.bin_+3A_pt">pt</code></td>
<td>
<p>The probability of the outcome in treatment clusters.</p>
</td></tr>
<tr><td><code id="re.clustsize.bin_+3A_sigma.u">sigma.u</code></td>
<td>
<p>Standard deviation of the cluster random effect.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Candel MJJM and van Breukelen GJP (2010) Sample size adjustments for varying cluster sizes in
cluster randomized trials with binary outcomes analyzed with second-order PQL mixed logistic regression.
Statistics in Medicine 29(14):1488-1501.
</p>


<h3>Value</h3>

<p>The computed RE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>re.clustsize.bin(m = 60, m.sd = 45, pc = 0.25, pt = 0.15, sigma.u = 0.3)
</code></pre>

<hr>
<h2 id='re.clustsize.cont'>Relative efficiency of a cluster randomized trial with continuous outcome
with varying cluster sizes</h2><span id='topic+re.clustsize.cont'></span>

<h3>Description</h3>

<p>For a continuous outcome, computes the relative efficiency (ratio of the variances) of a cluster randomized trial
with varying cluster sizes to that of a cluster randomized trial with constant cluster sizes,
assuming equal total number of subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>re.clustsize.cont(m, m.sd, icc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="re.clustsize.cont_+3A_m">m</code></td>
<td>
<p>The number of subjects per cluster or the mean cluster size (if unequal number of participants per cluster).</p>
</td></tr>
<tr><td><code id="re.clustsize.cont_+3A_m.sd">m.sd</code></td>
<td>
<p>The standard deviation of cluster sizes (in case of unequal number of participants per cluster).</p>
</td></tr>
<tr><td><code id="re.clustsize.cont_+3A_icc">icc</code></td>
<td>
<p>The intraclass correlation coefficient. For a multisite trial this is icc1. For a CRT this is the average of the 2 icc's.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The computed RE.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>re.clustsize.cont(m = 25, m.sd = 15, icc = 0.05)
</code></pre>

<hr>
<h2 id='relrisk'>Power calculation for relative risk</h2><span id='topic+relrisk'></span>

<h3>Description</h3>

<p>Performs power and sample size calculations for a test of relative risk, p2/p1.
Can solve for power, N1, n.ratio or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relrisk(
  n1 = NULL,
  n.ratio = 1,
  p1 = NULL,
  p2 = NULL,
  RR0 = 1,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="relrisk_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="relrisk_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="relrisk_+3A_p1">p1</code></td>
<td>
<p>The proportion in group 1.</p>
</td></tr>
<tr><td><code id="relrisk_+3A_p2">p2</code></td>
<td>
<p>The proportion in group 2.</p>
</td></tr>
<tr><td><code id="relrisk_+3A_rr0">RR0</code></td>
<td>
<p>The relative risk under the null (p2/p1); defaults to 1.</p>
</td></tr>
<tr><td><code id="relrisk_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="relrisk_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="relrisk_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="relrisk_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>relrisk(n1 = NULL, n.ratio = 1/6, p1 = 0.1, p2 = 0.1 * 2, power = 0.8)
</code></pre>

<hr>
<h2 id='signedrank'>Power calculation for signed-rank test</h2><span id='topic+signedrank'></span>

<h3>Description</h3>

<p>The signed-rank test is a nonparametric alternative to a one-sample or paired t test. This function
performs power and sample size calculations for the signed-rank test using Noether's approximation;
see Noether (1987) Sample size determination for some common nonparametric tests. JASA 82(398):645-647.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signedrank(
  N = NULL,
  ps = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signedrank_+3A_n">N</code></td>
<td>
<p>The sample size; number of observations or paired differences.</p>
</td></tr>
<tr><td><code id="signedrank_+3A_ps">ps</code></td>
<td>
<p>The probability that the sum of two values exceeds zero when the alternative hypothesis is true.</p>
</td></tr>
<tr><td><code id="signedrank_+3A_alpha">alpha</code></td>
<td>
<p>The significance level or type 1 error rate; defaults to 0.05.</p>
</td></tr>
<tr><td><code id="signedrank_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="signedrank_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two-sided hypothesis test.</p>
</td></tr>
<tr><td><code id="signedrank_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Due to symmetry, the power for p is equal to the power for 1 - p. Therefore,
when solving for p, two values, p and 1 - p, are returned.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>signedrank(N = 20, ps = 0.87, power = NULL, sides = 2)
</code></pre>

<hr>
<h2 id='signtest'>Power calculation for sign test</h2><span id='topic+signtest'></span>

<h3>Description</h3>

<p>The sign test is a nonparametric one-sample test of location, specifically,
a test of whether the median
equals (or is less than or greater than) zero. Its typical use is in place of
a one-sample or paired t test when the normality assumption is violated.
This function performs power and sample size calculations for a sign test
using the normal approximation to the binomial distribution, based on
Noether (1987) Sample size determination for some common nonparametric tests. JASA 82(398):645-647.
</p>
<p>Power calculation
for an exact sign test using the exact binomial test can be performed
using the power_binom_test function from the MESS package;
see Crespi CM (2025) Power and Sample Size in R. Routledge, New York, NY.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signtest(N = NULL, p = NULL, alpha = 0.05, power = NULL, sides = 2, v = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signtest_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="signtest_+3A_p">p</code></td>
<td>
<p>The probability of a positive difference when the alternative hypothesis is true.</p>
</td></tr>
<tr><td><code id="signtest_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="signtest_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="signtest_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two-sided hypothesis test.</p>
</td></tr>
<tr><td><code id="signtest_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When solving for p, two values, p and 1 - p, are returned.
For a two-sided test, due to symmetry, the power for p is equal to the power for 1 - p.
For a one-sided upper-tailed test (rejecting null hypothesis when median &gt; 0), select the higher value.
For a one-sided lower-tailed test (rejecting null hypothesis when median &lt; 0), select the lower value.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>signtest(N = 40, p = 0.7, power = NULL, alpha = 0.05, sides = 1)
</code></pre>

<hr>
<h2 id='slr'>Power calculation for a simple linear regression</h2><span id='topic+slr'></span>

<h3>Description</h3>

<p>Performs sample size and power calculations for a simple linear regression.
Can solve for power, N or alpha. Required inputs include the values of the
slope regression coefficient under the null hypothesis and the alternative,
the variance of the covariate X, and the SD of the error. Power calculations
for a simple linear regression can also be conducted using the mlrF.overall function,
which requires fewer inputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slr(
  N = NULL,
  beta10 = 0,
  beta1A = NULL,
  var.x = NULL,
  sigma.e = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slr_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="slr_+3A_beta10">beta10</code></td>
<td>
<p>The slope regression coefficient under the null hypothesis; defaults to 0.</p>
</td></tr>
<tr><td><code id="slr_+3A_beta1a">beta1A</code></td>
<td>
<p>The slope regression coefficient under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="slr_+3A_var.x">var.x</code></td>
<td>
<p>The variance of the covariate X.</p>
</td></tr>
<tr><td><code id="slr_+3A_sigma.e">sigma.e</code></td>
<td>
<p>The standard deviation of the error terms.</p>
</td></tr>
<tr><td><code id="slr_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="slr_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="slr_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="slr_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Yi = beta0 + beta1 * Xi + ei, i = 1,...,N
slr(N = 100, beta10 = 1, beta1A = 1.5, var.x = 25, sigma.e = 10, sides = 1)
</code></pre>

<hr>
<h2 id='ttest.1samp'>Power calculation for one-sample t test</h2><span id='topic+ttest.1samp'></span>

<h3>Description</h3>

<p>This function computes power and sample size for a one-sample t test.
Can solve for power, N, delta, sd or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest.1samp(
  N = NULL,
  delta = NULL,
  sd = 1,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttest.1samp_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="ttest.1samp_+3A_delta">delta</code></td>
<td>
<p>muA (the true mean) - mu0 (the mean under the null).</p>
</td></tr>
<tr><td><code id="ttest.1samp_+3A_sd">sd</code></td>
<td>
<p>The standard deviation; defaults to 1.</p>
</td></tr>
<tr><td><code id="ttest.1samp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="ttest.1samp_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="ttest.1samp_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two-sided hypothesis test.</p>
</td></tr>
<tr><td><code id="ttest.1samp_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ttest.1samp(N = 36, delta = 4.9 - 5.7, sd = 2, sides = 1)
ttest.1samp(N = 36, delta = 6.3 - 5.7, sd = 2, sides = 1)
ttest.1samp(N = 36, delta = 4.9 - 5.7, sd = 2, sides = 2)
ttest.1samp(delta = 0.6, sd = 1, power = 0.8, sides = 1)
</code></pre>

<hr>
<h2 id='ttest.2samp'>Power calculation for two-sample t test</h2><span id='topic+ttest.2samp'></span>

<h3>Description</h3>

<p>This function computes power and sample size for a two-sample t test.
Unequal sample sizes and/or unequal variances in the two groups are allowed.
Can solve for power, n1, n.ratio, sd1, sd.ratio, delta or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest.2samp(
  n1 = NULL,
  n.ratio = 1,
  delta = NULL,
  sd1 = 1,
  sd.ratio = 1,
  df.method = c("welch", "classical"),
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttest.2samp_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="ttest.2samp_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="ttest.2samp_+3A_delta">delta</code></td>
<td>
<p>DeltaA (true difference mu1 - mu2) - Delta0 (difference under the null). For a noninferiority
or superiority by a margin test,
the margin should be subtracted, that is, delta = DeltaA - Delta0 - margin.</p>
</td></tr>
<tr><td><code id="ttest.2samp_+3A_sd1">sd1</code></td>
<td>
<p>The standard deviation for group 1; defaults to 1 (equal standard deviations in the two groups).</p>
</td></tr>
<tr><td><code id="ttest.2samp_+3A_sd.ratio">sd.ratio</code></td>
<td>
<p>The ratio sd2/sd1 between the standard deviations of the two groups.</p>
</td></tr>
<tr><td><code id="ttest.2samp_+3A_df.method">df.method</code></td>
<td>
<p>Method for calculating the degrees of freedom: &quot;welch&quot; (default) or &quot;classical&quot;, which is n1+n2-2.</p>
</td></tr>
<tr><td><code id="ttest.2samp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="ttest.2samp_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="ttest.2samp_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="ttest.2samp_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a noninferiority or superiority by a margin test, the margin should be subtracted
as part of the specification of delta and a one-sided test should be used. See Crespi (2025)
for specific guidance. For an equivalence test for two means, see the sampleN.TOST function from the
PowerTOST package.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ttest.2samp(n1 = 50, delta = 2, sd1 = 5, sides = 1)
ttest.2samp(n1 = NULL, n.ratio = 2, delta = 0.5, sd1 = 1, power = 0.8, sides = 2)
ttest.2samp(n1 = 49, n.ratio = 2, delta = 0.5, sd1 = 1, power = NULL, sides = 2)
ttest.2samp(n1 = 25, n.ratio = 3, delta = 3, sd1 = 4, sd.ratio = 1.5, alpha = 0.025, sides = 1)
ttest.2samp(n1 = NULL, delta = 0.5, sd1 = 1, power = 0.8, sides = 2)
</code></pre>

<hr>
<h2 id='ttest.paired'>Power calculation for paired t test</h2><span id='topic+ttest.paired'></span>

<h3>Description</h3>

<p>Performs power and sample size calculations for a paired t test.
Can solve for power, N, delta or alpha.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest.paired(
  N = NULL,
  delta = NULL,
  sd1 = 1,
  sd2 = 1,
  rho = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttest.paired_+3A_n">N</code></td>
<td>
<p>The sample size; if the observations are paired differences, this is the number of pairs.</p>
</td></tr>
<tr><td><code id="ttest.paired_+3A_delta">delta</code></td>
<td>
<p>DeltaA (the true mean difference) - Delta0 (the mean difference under the null).</p>
</td></tr>
<tr><td><code id="ttest.paired_+3A_sd1">sd1</code></td>
<td>
<p>The pre standard deviation; defaults to 1.</p>
</td></tr>
<tr><td><code id="ttest.paired_+3A_sd2">sd2</code></td>
<td>
<p>The post standard deviation; defaults to 1.</p>
</td></tr>
<tr><td><code id="ttest.paired_+3A_rho">rho</code></td>
<td>
<p>The correlation between pre and post measurements on the same individual.</p>
</td></tr>
<tr><td><code id="ttest.paired_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="ttest.paired_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="ttest.paired_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="ttest.paired_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ttest.paired(N = NULL, delta = 4, sd1 = 10, sd2 = 10, rho = 0.4, power = 0.8, sides = 2)
</code></pre>

<hr>
<h2 id='ztest.1samp'>Power calculation for one-sample z test</h2><span id='topic+ztest.1samp'></span>

<h3>Description</h3>

<p>This function performs power and sample size calculations for a one-sample z test
which is analogous to a one-sample t test with the variance assumed to be known.
This function is provided largely for pedagogical purposes; in general,
for real studies, the one-sample t test procedure should be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ztest.1samp(
  N = NULL,
  delta = NULL,
  sd = 1,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ztest.1samp_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="ztest.1samp_+3A_delta">delta</code></td>
<td>
<p>muA (the true mean) - mu0 (the mean under the null).</p>
</td></tr>
<tr><td><code id="ztest.1samp_+3A_sd">sd</code></td>
<td>
<p>The standard deviation; defaults to 1.</p>
</td></tr>
<tr><td><code id="ztest.1samp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="ztest.1samp_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="ztest.1samp_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="ztest.1samp_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ztest.1samp(N = NULL, delta = 6.5 - 5.7, sd = 2, power = 0.8, sides = 2)
ztest.1samp(N = 40, delta = NULL, sd = 1, power = 0.9, sides = 2)
ztest.1samp(N = NULL, delta = 0.6, sd = 1, power = 0.8, sides = 1)
</code></pre>

<hr>
<h2 id='ztest.2samp'>Power calculation for two-sample z test</h2><span id='topic+ztest.2samp'></span>

<h3>Description</h3>

<p>This function performs power and sample size calculations for a two-sample z test. which is
analogous to a two-sample t test but with the variances assumed to be known.
The function allows for unequal sample sizes and/or variances in the two groups.
This function is provided largely for pedagogical purposes; in general,
for real studies, the two-sample t test procedure should be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ztest.2samp(
  n1 = NULL,
  n.ratio = 1,
  delta = NULL,
  sd1 = 1,
  sd.ratio = 1,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ztest.2samp_+3A_n1">n1</code></td>
<td>
<p>The sample size for group 1.</p>
</td></tr>
<tr><td><code id="ztest.2samp_+3A_n.ratio">n.ratio</code></td>
<td>
<p>The ratio n2/n1 between the sample sizes of two groups; defaults to 1 (equal group sizes).</p>
</td></tr>
<tr><td><code id="ztest.2samp_+3A_delta">delta</code></td>
<td>
<p>DeltaA (true difference mu1 - mu2) - Delta0 (difference under the null). For a noninferiority
or superiority by a margin test,
the margin should be subtracted, that is, delta = DeltaA - Delta0 - margin.</p>
</td></tr>
<tr><td><code id="ztest.2samp_+3A_sd1">sd1</code></td>
<td>
<p>The standard deviation for group 1; defaults to 1 (equal standard deviations in the two groups).</p>
</td></tr>
<tr><td><code id="ztest.2samp_+3A_sd.ratio">sd.ratio</code></td>
<td>
<p>The ratio sd2/sd1 between the standard deviations of the two groups.</p>
</td></tr>
<tr><td><code id="ztest.2samp_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="ztest.2samp_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="ztest.2samp_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="ztest.2samp_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a noninferiority or superiority by a margin test, the margin should be subtracted
as part of the specification of delta and a one-sided test should be used. See Crespi (2025)
for specific guidance.
</p>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ztest.2samp(n1 = NULL, n.ratio = 1, delta = 0.5, sd1 = 1, power = 0.8, sides = 2)
</code></pre>

<hr>
<h2 id='ztest.paired'>Power calculation for paired z test</h2><span id='topic+ztest.paired'></span>

<h3>Description</h3>

<p>This function performs power and sample size calculations for a paired z test which is
analogous to a paired t test with variance assumed to be known.
This function is provided largely for pedagogical purposes; in general,
for real studies, the paired t test procedure should be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ztest.paired(
  N = NULL,
  delta = NULL,
  sd1 = 1,
  sd2 = 1,
  rho = NULL,
  alpha = 0.05,
  power = NULL,
  sides = 2,
  v = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ztest.paired_+3A_n">N</code></td>
<td>
<p>The sample size; the number of pairs.</p>
</td></tr>
<tr><td><code id="ztest.paired_+3A_delta">delta</code></td>
<td>
<p>DeltaA (the true mean difference) - Delta0 (the mean difference under the null).</p>
</td></tr>
<tr><td><code id="ztest.paired_+3A_sd1">sd1</code></td>
<td>
<p>The pre standard deviation; defaults to 1.</p>
</td></tr>
<tr><td><code id="ztest.paired_+3A_sd2">sd2</code></td>
<td>
<p>The post standard deviation; defaults to 1.</p>
</td></tr>
<tr><td><code id="ztest.paired_+3A_rho">rho</code></td>
<td>
<p>The correlation between pre and post measurements on the same individual; defaults to 0.</p>
</td></tr>
<tr><td><code id="ztest.paired_+3A_alpha">alpha</code></td>
<td>
<p>The significance level (type 1 error rate); defaults to 0.05.</p>
</td></tr>
<tr><td><code id="ztest.paired_+3A_power">power</code></td>
<td>
<p>The specified level of power.</p>
</td></tr>
<tr><td><code id="ztest.paired_+3A_sides">sides</code></td>
<td>
<p>Either 1 or 2 (default) to specify a one- or two- sided hypothesis test.</p>
</td></tr>
<tr><td><code id="ztest.paired_+3A_v">v</code></td>
<td>
<p>Either TRUE for verbose output or FALSE (default) to output computed argument only.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the arguments (including the computed one).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ztest.paired(N = NULL, delta = 4, sd1 = 10, sd2 = 10, rho = 0.4, power = 0.8, sides = 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
