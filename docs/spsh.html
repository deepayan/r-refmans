<!DOCTYPE html><html><head><title>Help for package spsh</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spsh}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#spsh-package'><p>spsh: Estimation and Prediction of Parameters of Various Soil Hydraulic Property Models</p></a></li>
<li><a href='#gofFun'><p>Goodness-of-fit and Information Criteria</p></a></li>
<li><a href='#Ibeta'><p>Incomplete Beta Function</p></a></li>
<li><a href='#inipopFun'><p>Generates an Initial Population of Transformed Soil Hydraulic Property Model Parameters</p></a></li>
<li><a href='#KvapFun'><p>Calculates the Isothermal Water Vapour Conductivity</p></a></li>
<li><a href='#logLikFun.norm'><p>Calculation of the Log-likelihood assuming Identially, Independenzly and Normally Distributed errors</p></a></li>
<li><a href='#numMualem'><p>Function to Numerically Compute the Mualem Integral</p></a></li>
<li><a href='#ptf.cW'><p>Title Corrected Weynants et al. (2009) Pedotransfer Function</p></a></li>
<li><a href='#ptf.vG2BW'><p>Parameter Transfer Function for Weber et al.(2019) model.</p></a></li>
<li><a href='#resFun'><p>Calculation of the Objective Function Value</p></a></li>
<li><a href='#shpdata1'><p>Measured soil hydraulic property data</p></a></li>
<li><a href='#shypEstFun'><p>Wrapper function for the Estimation of Soil Hydrologic Property Model Parameters</p></a></li>
<li><a href='#shypFun'><p>Wrapper Function for all Supported Soil Hydraulic Property Models</p></a></li>
<li><a href='#shypFun.01110'><p>van Genuchten-Mualem Soil Hydraulic Proptery Model</p></a></li>
<li><a href='#shypFun.01210'><p>van Genuchten-Mualem bimodal Soil Hydraulic Propterty Model</p></a></li>
<li><a href='#shypFun.01310'><p>van Genuchten-Mualem trimodal Soil Hydraulic Propterty Model</p></a></li>
<li><a href='#shypFun.02110'><p>Unimodal Kosugi-Mualem Model (2 Parameter Model)</p></a></li>
<li><a href='#shypFun.03110'><p>Unimodal Fredlund-Xing - Mualem Model</p></a></li>
<li><a href='#shypFun.04110'><p>Unimodal Brooks-Corey Model</p></a></li>
<li><a href='#sncFun'><p>Non-capillary Saturation Function to Extend Other Functions</p></a></li>
<li><a href='#sncFun.01110'><p>Unimodal van Genuchten Non-Capillary Saturation Model</p></a></li>
<li><a href='#sncFun.02110'><p>Unimodal Kosugi Non-Capillary Saturation Model</p></a></li>
<li><a href='#sncFun.04110'><p>Unimodal Brooks-Corey Non-Capillary Saturation Model</p></a></li>
<li><a href='#transBoundFun'><p>Creates Parameter Transformation and Backtransformation Rules for the Estimation Procedure</p></a></li>
<li><a href='#transFun'><p>Parameter Transformation and Back-transformation</p></a></li>
<li><a href='#weightFun'><p>Specification of Weights for the Data Groups Retention Data and Conductivity Data.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation and Prediction of Parameters of Various Soil
Hydraulic Property Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-03-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Tobias KD Weber [aut, cre], Efstathios Diamantopoulos [ctb], Melanie Weynants [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tobias KD Weber &lt;tobias.weber@uni-hohenheim.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates model parameters of soil hydraulic property functions by inverting measured data. A wide range of hydraulic models, weighting schemes,
    global optimization algorithms, Markov chain Monte Carlo samplers, and extended statistical analyses of results are provided.
	Prediction of soil hydraulic property model parameters and common soil properties using pedotransfer functions is facilitated. 
	Parameter estimation is based on identically and independentally distributed (weighted) model residuals, and simple model selection criteria (Hoege, M., Woehling, T., and Nowak, W. (2018) &lt;<a href="https://doi.org/10.1002%2F2017WR021902">doi:10.1002/2017WR021902</a>&gt;) can be calculated.
	The included models are the van Genuchten-Mualem in its unimodal, bimodal and trimodal form, the the Kosugi 2 parametric-Mualem model, and the Fredlund-Xing model.
	All models can be extended to account for non-capillary water storage and conductivity (Weber, T.K.D., Durner, W., Streck, T. and Diamantopoulos, E. (2019) &lt;<a href="https://doi.org/10.1029%2F2018WR024584">doi:10.1029/2018WR024584</a>&gt;. 
	The isothermal vapour conductivity (Saito, H., Simunek, J. and Mohanty, B.P. (2006) &lt;<a href="https://doi.org/10.2136%2Fvzj2006.0007">doi:10.2136/vzj2006.0007</a>&gt;) is calculated based on 
	volumetric air space and a selection of different tortuosity models: 
	(Grable, A.R., Siemer, E.G. (1968) &lt;<a href="https://doi.org/10.2136%2Fsssaj1968.03615995003200020011x">doi:10.2136/sssaj1968.03615995003200020011x</a>&gt;, Lai, S.H., Tiedje J.M., Erickson, E. (1976) &lt;<a href="https://doi.org/10.2136%2Fsssaj1976.03615995004000010006x">doi:10.2136/sssaj1976.03615995004000010006x</a>&gt;,
	Moldrup, P., Olesen, T., Rolston, D.E., and Yamaguchi, T. (1997) &lt;<a href="https://doi.org/10.1097%2F00010694-199709000-00004">doi:10.1097/00010694-199709000-00004</a>&gt;, Moldrup, P., Olesen, T., Yoshikawa, S., Komatsu, T., and Rolston, D.E. (2004) &lt;<a href="https://doi.org/10.2136%2Fsssaj2004.7500">doi:10.2136/sssaj2004.7500</a>&gt;, 
	Moldrup, P., Olesen, T., Yoshikawa, S., Komatsu, T., and Rolston, D.E. (2005) &lt;<a href="https://doi.org/10.1097%2F01.ss.0000196768.44165.1f">doi:10.1097/01.ss.0000196768.44165.1f</a>&gt;, Millington, R.J., Quirk, J.P. (1961) &lt;<a href="https://doi.org/10.1039%2FTF9615701200">doi:10.1039/TF9615701200</a>&gt;,
	Penman, H.L. (1940) &lt;<a href="https://doi.org/10.1017%2FS0021859600048164">doi:10.1017/S0021859600048164</a>&gt;, and Xu, X, Nieber, J.L. Gupta, S.C. (1992) &lt;<a href="https://doi.org/10.2136%2Fsssaj1992.03615995005600060014x">doi:10.2136/sssaj1992.03615995005600060014x</a>&gt;). 	</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>DEoptim (&ge; 2.2.4), lhs (&ge; 0.16.0), pracma (&ge; 2.1.4), FME
(&ge; 1.3.5), hypergeo (&ge; 1.2-13)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-25 20:43:00 UTC; tkdweber</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-06 16:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='spsh-package'>spsh: Estimation and Prediction of Parameters of Various Soil Hydraulic Property Models</h2><span id='topic+spsh'></span><span id='topic+spsh-package'></span>

<h3>Description</h3>

<p>Estimates model parameters of soil hydraulic property functions by inverting measured data. A wide range of hydraulic models, weighting schemes,
global optimization algorithms, Markov chain Monte Carlo samplers, and extended statistical analyses of results are provided.
Prediction of soil hydraulic property model parameters and common soil properties using pedotransfer functions is facilitated. 
Parameter estimation is based on identically and independentally distributed (weighted) model residuals, and simple model selection criteria (Hoege, M., Woehling, T., and Nowak, W. (2018) &lt;doi:10.1002/2017WR021902&gt;) can be calculated.
The included models are the van Genuchten-Mualem in its unimodal, bimodal and trimodal form, the the Kosugi 2 parametric-Mualem model, and the Fredlund-Xing model.
All models can be extended to account for non-capillary water storage and conductivity (Weber, T.K.D., Durner, W., Streck, T. and Diamantopoulos, E. (2019) &lt;doi:10.1029/2018WR024584&gt;. 
The isothermal vapour conductivity (Saito, H., Simunek, J. and Mohanty, B.P. (2006) &lt;doi:10.2136/vzj2006.0007&gt;) is calculated based on 
volumetric air space and a selection of different tortuosity models: 
(Grable, A.R., Siemer, E.G. (1968) &lt;doi:10.2136/sssaj1968.03615995003200020011x&gt;, Lai, S.H., Tiedje J.M., Erickson, E. (1976) &lt;doi:10.2136/sssaj1976.03615995004000010006x&gt;,
Moldrup, P., Olesen, T., Rolston, D.E., and Yamaguchi, T. (1997) &lt;doi:10.1097/00010694-199709000-00004&gt;, Moldrup, P., Olesen, T., Yoshikawa, S., Komatsu, T., and Rolston, D.E. (2004) &lt;doi:10.2136/sssaj2004.7500&gt;, 
Moldrup, P., Olesen, T., Yoshikawa, S., Komatsu, T., and Rolston, D.E. (2005) &lt;doi:10.1097/01.ss.0000196768.44165.1f&gt;, Millington, R.J., Quirk, J.P. (1961) &lt;doi:10.1039/TF9615701200&gt;,
Penman, H.L. (1940) &lt;doi:10.1017/S0021859600048164&gt;, and Xu, X, Nieber, J.L. Gupta, S.C. (1992) &lt;doi:10.2136/sssaj1992.03615995005600060014x&gt;).
</p>

<hr>
<h2 id='gofFun'>Goodness-of-fit and Information Criteria</h2><span id='topic+gofFun'></span>

<h3>Description</h3>

<p>Calculates goodness-of-fit criteria and the likelihood-based Akaike 
and Bayesian Information Criterion based on a given parameter set,
typically from the estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofFun(
  phat,
  shpmodel = "01110",
  retdata = NULL,
  condata = NULL,
  weight,
  psel,
  ivap.query = NULL,
  hclip.query = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gofFun_+3A_phat">phat</code></td>
<td>
<p>Vector of non-transformed (back-transformed) model parameters after estimation, i.e. the best fit or maximum likelihood estimate.</p>
</td></tr>
<tr><td><code id="gofFun_+3A_shpmodel">shpmodel</code></td>
<td>
<p>Character specifying the soil hydraulic property model.</p>
</td></tr>
<tr><td><code id="gofFun_+3A_retdata">retdata</code></td>
<td>
<p>Dataframe or matrix with 2 columns. The first with pressure head values in log<sub>10</sub> [cm], i.e. pF values, and the second with volumetric water contents in [cm cm-3].</p>
</td></tr>
<tr><td><code id="gofFun_+3A_condata">condata</code></td>
<td>
<p>Dataframe or matrix with 2 columns. The first with pressure head values in log<sub>10</sub> [cm], i.e. pF values, and the second with hydraulic conductivity values log<sub>10</sub> [cm d-1].</p>
</td></tr>
<tr><td><code id="gofFun_+3A_weight">weight</code></td>
<td>
<p>List of the model residual weights used or estimated by the parameter estimation scheme, to calculate the weighted statistical analyses.</p>
</td></tr>
<tr><td><code id="gofFun_+3A_psel">psel</code></td>
<td>
<p>Vector specifying the selected parameters for the parameter estimation from <code>parL</code>.</p>
</td></tr>
<tr><td><code id="gofFun_+3A_ivap.query">ivap.query</code></td>
<td>
<p>Specification of <em>ivap</em> method, if FALSE selected, no isothermal vapour conductivity is consideredSee <code>Details</code></p>
</td></tr>
<tr><td><code id="gofFun_+3A_hclip.query">hclip.query</code></td>
<td>
<p>Implemented purely for future compatability. Currently no use. See <code>Details</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Output for data groups.
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>th</code></td><td style="text-align: left;">      <code>list</code> with goodness of fit statistics for the retention curve <em>see below</em></td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>logKh</code></td><td style="text-align: left;">   <code>list</code>with output same as <code>th</code> but for the log<sub>10</sub> fitted conductivity curve</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>combined</code></td><td style="text-align: left;"><code>list</code> with <code>AIC</code>, <code>AICc</code>, and <code>BIC</code> calculated for the multi-objective function if arguments <code>retdata</code> and <code>condata</code> are both <code>!NULL</code></td>
</tr>
<tr>
 <td style="text-align: left;">
   </td>
</tr>

</table>

<p>Statistical analyses of the inverse modelling results.
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>me</code></td><td style="text-align: left;">mean (weighted) error</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>mae</code></td><td style="text-align: left;">mean absolute (weighted) error</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>mse</code></td><td style="text-align: left;">mean squared (weighted) error</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>rss</code></td><td style="text-align: left;">sum of squared (weighted) errors</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>rmse</code></td><td style="text-align: left;">root mean squared (weighted) error</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>AIC</code></td><td style="text-align: left;">Akaike Information Criteria</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>AICc</code></td><td style="text-align: left;">corrected Akaike Information Criteria</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>BIC</code></td><td style="text-align: left;">Bayesian Information Criteria</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>m</code></td><td style="text-align: left;">number of observations</td>
</tr>
<tr>
 <td style="text-align: left;">
            </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>HÃƒÂ¶ge M, WÃƒÂ¶hling T, Nowak W (2018).
&ldquo;A Primer for Model Selection: The Decisive Role of Model Complexity.&rdquo;
<em>Water Resources Research</em>, <b>54</b>(3), 1688&ndash;1715.
doi: <a href="https://doi.org/10.1002/2017WR021902">10.1002/2017WR021902</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("shpdata1")
retdata &lt;- shpdata1$TS1$wrc
condata &lt;- shpdata1$TS1$hcc
condata &lt;- condata[!is.na(condata[,1]),]
# Parameter list
parL &lt;- list("p" = c("thr"= 0.05, "ths" = 0.45, "alf1" = 0.01, "n" = 2, "Ks" = 100, "tau" = .5),
             "psel" = c(1, 1, 0, 1, 1, 1),
             "plo" = c(0.001 , 0.2, 0.001, 1.1, 1, -2),
             "pup" = c(0.3, 0.95, 1, 10, 1e4, 10)
             )
# Calulation of the goodness of fit.
gofL &lt;-gofFun(parL$p, shpmodel = "01110", retdata = retdata, condata = condata, 
              weight = weightFun(weightmethod = "fix1"), parL$psel, 
              ivap.query = NULL, hclip.query = FALSE)
</code></pre>

<hr>
<h2 id='Ibeta'>Incomplete Beta Function</h2><span id='topic+Ibeta'></span>

<h3>Description</h3>

<p>Calculation of the incomplete beta function used in<a href="#topic+sncFun.01110">sncFun.01110</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ibeta(z, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ibeta_+3A_z">z</code></td>
<td>
<p>Vector of <code>n</code> model parameters.</p>
</td></tr>
<tr><td><code id="Ibeta_+3A_a">a</code></td>
<td>
<p>Vector of <code>n</code> model parameters.</p>
</td></tr>
<tr><td><code id="Ibeta_+3A_b">b</code></td>
<td>
<p>Vector of <code>n</code> model parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>a=1</code> or <code>a=1/n</code> and <code>b=0</code>, this implementation cannot evaluate values for <code>z &lt; 1.014</code>.
</p>


<h3>Value</h3>

<p>Returns a vector of numerical values
</p>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = seq(.5, 4.2 , length = 20)
alf = 0.1
n = 2
y = 1 + (alf * 10^x)^n

result &lt;- Ibeta(z = y, a = 1, b = 0 )

</code></pre>

<hr>
<h2 id='inipopFun'>Generates an Initial Population of Transformed Soil Hydraulic Property Model Parameters</h2><span id='topic+inipopFun'></span>

<h3>Description</h3>

<p>Draws a Latin Hypercube Sample from a set of uniform distributions in the transformed parameter space,in creating a Latin Hypercube Design. This function uses the Columnwise Pairwise (CP) algorithm to generate an optimal design with respect to the S optimality criterion, as implemented in <a href="lhs.html#topic+lhs">lhs</a>-package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inipopFun(p, psel, plo, pup, trans.L, Npop = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inipopFun_+3A_p">p</code></td>
<td>
<p>vector of model parameters</p>
</td></tr>
<tr><td><code id="inipopFun_+3A_psel">psel</code></td>
<td>
<p><code>vector</code> of selectors</p>
</td></tr>
<tr><td><code id="inipopFun_+3A_plo">plo</code></td>
<td>
<p><code>vector</code> of lower boundary values of non-transformed parameters</p>
</td></tr>
<tr><td><code id="inipopFun_+3A_pup">pup</code></td>
<td>
<p><code>vector</code> of upper boundary values of non-transformed parameters</p>
</td></tr>
<tr><td><code id="inipopFun_+3A_trans.l">trans.L</code></td>
<td>
<p><code>list</code> of transformation/backtransformation operators with same length as <code>p</code>, <code>psel</code>, <code>plo</code>, and <code>pup</code>.</p>
</td></tr>
<tr><td><code id="inipopFun_+3A_npop">Npop</code></td>
<td>
<p><code>integer</code> of initial population size</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces and optimum latin hypercube sample from a bounded uniform distribution.
</p>


<h3>Value</h3>

<p><code>n</code> draws of <code>k</code> parameters in an <code>n x k</code> Latin Hypercube Sample matrix with values uniformly distributed on user specified bounds.
</p>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="lhs.html#topic+optimumLHS">optimumLHS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example based on soil hydraulic property model parameters of shpmodel = "01110" parameters
parL &lt;- list("p" = c("thr"= 0.05, "ths" = 0.45, "alf1" = 0.01, "n" = 2, "Ks" = 100, "tau" = .5),
             "psel" = c(1, 1, 0, 1, 1, 1),
             "plo" = c(0.001 , 0.2, 0.001, 1.1, 1, -2),
             "pup" = c(0.3, 0.95, 1, 10, 1e4, 10)
)
# rules for the parameter transformation
ptransfit&lt;- c(function(x)x, function(x)x,log10,
              function(x)log10(x-1),log10 , function(x)x)
# get latin hypercube sample. 
test.inipop &lt;- inipopFun(parL$p, parL$psel,
                         parL$plo, parL$pup, ptransfit, Npop = 20)
# plot the latin hypercube 
pairs(test.inipop)


</code></pre>

<hr>
<h2 id='KvapFun'>Calculates the Isothermal Water Vapour Conductivity</h2><span id='topic+KvapFun'></span>

<h3>Description</h3>

<p>Calculates the isothermal vapour conductivity as a function of modelled volumetric air content. Different
models are implemented enabling the calculation of the relative gas diffusion coefficient (Ds/Do), based on 
different expressions for an effective tortuosity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KvapFun(
  p,
  por = p[2],
  retFun = NA,
  theta = NA,
  model = "MQ61",
  Temp = 20,
  m = 3,
  pF = seq(-3, 7, length = 501),
  output = "log10",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KvapFun_+3A_p">p</code></td>
<td>
<p>vector of soil hydraulic property model parameters, cf resp soil hydraulic property model for details.</p>
</td></tr>
<tr><td><code id="KvapFun_+3A_por">por</code></td>
<td>
<p>skalar value giving the fraction of a porous' media porosity [ - ]( value between [0, 1] ), defaults to the saturated water content.</p>
</td></tr>
<tr><td><code id="KvapFun_+3A_retfun">retFun</code></td>
<td>
<p>soil hydraulic property function has to be specified if models <code>PMQ</code>, <code>TPM</code> or <code>TPEM</code> are used, necessary to calculate the air content at <code>h = 100</code> cm for the parameter <code>eps100</code>.</p>
</td></tr>
<tr><td><code id="KvapFun_+3A_theta">theta</code></td>
<td>
<p>vector of numerical volumetric water contents [0,1] at which the air content is to be calculated.</p>
</td></tr>
<tr><td><code id="KvapFun_+3A_model">model</code></td>
<td>
<p>Implemented models (specify as character):
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>B</code></td><td style="text-align: left;">Buckingham (1904) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>P</code></td><td style="text-align: left;">Penman (1940) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>MQ60</code></td><td style="text-align: left;"> Millington and Quirck (1960) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>MQ61</code></td><td style="text-align: left;"> Millington and Quirck (1961)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>GS</code></td><td style="text-align: left;">Grable and Siemer (1968) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>L</code></td><td style="text-align: left;">Lai et al. (1976) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>PMQ</code></td><td style="text-align: left;">Moldrup et al. (1997) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>TPM</code></td><td style="text-align: left;">Moldrup et al. (2004) </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>TPEM</code></td><td style="text-align: left;">Moldrup et al. (2005) </td>
</tr>
<tr>
 <td style="text-align: left;">
      
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="KvapFun_+3A_temp">Temp</code></td>
<td>
<p>Soil tempereature [ deg C ], defaults to 20.</p>
</td></tr>
<tr><td><code id="KvapFun_+3A_m">m</code></td>
<td>
<p><code>PMQ</code> model parameter, default <code>m = 3</code>.</p>
</td></tr>
<tr><td><code id="KvapFun_+3A_pf">pF</code></td>
<td>
<p>monotonically increasing pF values, defined as log10(| pressure head [ cm ]).</p>
</td></tr>
<tr><td><code id="KvapFun_+3A_output">output</code></td>
<td>
<p>Defaults to <code>log10</code> indicates the isothermal vapour conductivity is returned as log<sub>10</sub>(conductivity), if <code>ouput != log10</code>,
the output will be in non-transformed values.</p>
</td></tr>
<tr><td><code id="KvapFun_+3A_...">...</code></td>
<td>
<p>more arguments to be passed to <code>retFun</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>More reading on the models reference is made to suggested in (Weber et al. 2019)
</p>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>Weber TK, Durner W, Streck T, Diamantopoulos E (2019).
&ldquo;A modular framework for modelling unsaturated soil hydraulic properties over the full moisture range.&rdquo;
<em>Water Resources Research</em>.
ISSN 0043-1397, doi: <a href="https://doi.org/10.1029/2018WR024584">10.1029/2018WR024584</a>.<br /><br />
<b>Buckingham, E.</b> (1904). Contributions to Our Knowledge of the Aeration Status of Soils, Bulletin 25, USDA Bureau of Soils, Washington, DC.
</p>
<p><b>Grable, A.R.; Siemer, E.G.</b> (1968).Effects of Bulk Density, Aggregate Size, and Soil Water Suction on Oxygen Diffusion, Redox Potentials, and Elongation of Corn Roots. Soil Sci. Soc. Am. Proc., 32, pp. 180-186. &lt;doi:10.2136/sssaj1968.03615995003200020011x&gt;. 
</p>
<p><b>Lai, S.H.; Tiedje J.M.; Erickson, E.</b> (1976). In situ Measurement of Gas Diffusion Coefficient in Soils. Soil Sci. Soc. Am. J., 40, pp. 3-6. &lt;doi:10.2136/sssaj1976.03615995004000010006x&gt;. 
</p>
<p><b>Moldrup, P.; Olesen, T.; Rolston, D.E.; and Yamaguchi, T.</b> (1997). Modeling Diffusion and Reaction in Soils: Vii. Predicting Gas and Ion Diffusivity in Undisturbed and Sieved Soils. Soil Science. 162 (9): pp. 632-640. 
</p>
<p><b>Moldrup, P.; Olesen, T.; Yoshikawa, S.; Komatsu, T.; and Rolston, D.E.</b> (2004). Three-Porosity Model for Predicting the Gas Diffusion Coefficient in Undisturbed Soil. Soil Sci. Soc. Am. J. 68 (3).pp. 750-759. &lt;doi:10.2136/sssaj2004.7500&gt;.
</p>
<p><b>Moldrup, P.; Olesen, T.; Yoshikawa, S.; Komatsu, T.; and Rolston, D.E.</b> (2005). Predictive-Descriptive Models for Gas and Solute Diffusion Coefficients in Variably Saturated Porous Media Coupled to Pore-Size Distribution: II. Gas Diffusivity in Undisturbed Soil. Soil Sci., 170, pp. 854-866. &lt;doi:10.1097/01.ss.0000196768.44165.1f&gt;.
</p>
<p><b>Millington, R.J.; Quirk, J.P.</b> (1960). Millington, R. J., and Quirk. J.M.
Transport in porous media. pp. 97-106. In: F.A. Van Beren, et al. (ed.) Trans. Int. Congr. Soil Sci., 7 th,
Vol. 1, Madison, Wl. 14-24 Aug. 1960. Elsevier, Amsterdam.
</p>
<p><b>Millington, R.J.; Quirk, J.P.</b> (1961). Permeability of Porous Solids. Trans. Faraday Soc., 1961, 57, pp. 1200-1207. &lt;doi:10.1039/TF9615701200&gt;.
</p>
<p><b>Penman, H.L.</b> (1940). Gas and vapour movements in the soil: I. The diffusion of vapours through porous solids. J. Agric. Sci., 30: pp. 437-462. &lt;doi:10.1017/S0021859600048164&gt;. 
</p>
<p><b>Xu, X; Nieber, J.L. Gupta, S.C.</b> (1992). Compaction Effect on the Gas Diffusion Coefficient in Soils. Soil Sci. Soc. Am. J.,56, pp. 1743-1750. &lt;doi:10.2136/sssaj1992.03615995005600060014x&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># | pressure head |
pF &lt;- seq(-3, 7, length = 201)
h &lt;- 10^pF
# van Genuchten-Mualem model parameters
p &lt;- c(0.08, .42, .05, 1.5, 100, .5)
# calculate soil hydraulic property values
shypL &lt;- shypFun.01110(p, h)
# clculate the isothermal vapour conductivity
kvap &lt;- KvapFun(p, por = p[2], retFun = NA, theta = shypL$theta, model = "MQ61", 
                Temp = 20, m = 3, pF, output = "log10")

</code></pre>

<hr>
<h2 id='logLikFun.norm'>Calculation of the Log-likelihood assuming Identially, Independenzly and Normally Distributed errors</h2><span id='topic+logLikFun.norm'></span>

<h3>Description</h3>

<p>Calculates the i-th log-likelihood of each <em>y-yhat</em> pair as described in (Seber and Wild 2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLikFun.norm(y, yhat, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLikFun.norm_+3A_y">y</code></td>
<td>
<p>A vector of <code>n</code> observed properties/variables of interest.</p>
</td></tr>
<tr><td><code id="logLikFun.norm_+3A_yhat">yhat</code></td>
<td>
<p>A vector of <code>n</code> model simulated properties/variables of interest.</p>
</td></tr>
<tr><td><code id="logLikFun.norm_+3A_sigma">sigma</code></td>
<td>
<p>A vector of length 1 considering homoscedastic residuals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The underlying assumption is, that the model residuals (errors) are independently, and identically distributed (i.i.d.) following a normal distribution.
Alternatively consider using <a href="base.html#topic+base">dnorm</a>.
</p>


<h3>Value</h3>

<p><em>log-likelihood</em> value of an normal distribution with N~(0, <em>sigma^2</em>)
</p>


<h3>Note</h3>

<p>The assumption of i.i.d. and normal distribution is best investigated <em>a posteriori</em>.
</p>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>Seber GAF, Wild CJ (2004).
<em>Nonlinear regression</em>,  Wiley series in probability and mathematical statistics.
Wiley, New York.
ISBN 978-0-471-47135-6.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># homoscedastic residuals
sig.s  &lt;- .01
y.scat &lt;- rnorm(100, 0, sig.s)
yhat   &lt;- (1:100)^1.2
y      &lt;- yhat + y.scat
sum(logLikFun.norm(y, yhat, sig.s))
plot(yhat-y)
</code></pre>

<hr>
<h2 id='numMualem'>Function to Numerically Compute the Mualem Integral</h2><span id='topic+numMualem'></span>

<h3>Description</h3>

<p>This function will calculate numerically Mualems Integral (Mualem 1976) and return Hydraulic Conductivity Values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>numMualem(h, scap, pcon = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="numMualem_+3A_h">h</code></td>
<td>
<p>vector of length <code>l</code> pressure head values.</p>
</td></tr>
<tr><td><code id="numMualem_+3A_scap">scap</code></td>
<td>
<p>Capillary saturation [cm3 cm-3].</p>
</td></tr>
<tr><td><code id="numMualem_+3A_pcon">pcon</code></td>
<td>
<p>vector of soil hydraulic conductivity model parameters, the first argument is <code>q</code> and the second <code>r</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The numerical solution of Mualems integral relies on the trapezoidal rul of integration.
</p>


<h3>Value</h3>

<p>returns a vector of length <code>l</code> of calulcated conductivity values at <code>h</code>.
</p>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>Mualem Y (1976).
&ldquo;New Model for predicting hydraulic conductivity of unsaturated porous media.&rdquo;
<em>Water Resources Research</em>, <b>12</b>(3), 513&ndash;522.
ISSN 0043-1397, <a href="http://www.scopus.com/inward/record.url?eid=2-s2.0-0016961814&amp;partnerID=40&amp;md5=e3773c228d43852dad22d656738389c9">http://www.scopus.com/inward/record.url?eid=2-s2.0-0016961814&amp;partnerID=40&amp;md5=e3773c228d43852dad22d656738389c9</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>h &lt;- 10^seq(-3, 6.8, length = 501)
p = c(.05, .5, .01, 1.8, 100, .5)
shyp.L &lt;- shypFun.01110(p, h)

Ks &lt;- p[5]
tau &lt;- p[6]
Se &lt;- shyp.L[['Se']]
Khrnum &lt;- numMualem(h, pcon = tau, scap = Se) 

Khnum &lt;- Ks * Se^tau * Khrnum

plot(log10(h), log10(shyp.L[['Kh']]), ylim = c(-10, 2.3), 
     xlim = c(-1,6), ylab = "log10 Kunsat [ cm/d ]", xlab = "pF [ - ]", type = "l", lwd = 8)
lines(log10(h), log10(Khnum), col = "red", lwd = 2)
</code></pre>

<hr>
<h2 id='ptf.cW'>Title Corrected Weynants et al. (2009) Pedotransfer Function</h2><span id='topic+ptf.cW'></span>

<h3>Description</h3>

<p>Title Corrected Weynants et al. (2009) Pedotransfer Function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptf.cW(CLAY, SAND, BD, OC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptf.cW_+3A_clay">CLAY</code></td>
<td>
<p>A vector of <code>n</code> elements with soil clay content (particle diameters &lt;= 2 x 10e-6 m), in percent [0, 100]).</p>
</td></tr>
<tr><td><code id="ptf.cW_+3A_sand">SAND</code></td>
<td>
<p>A vector of <code>n</code> elements with soil sand content (particle diameters &lt; 2 mm and &gt; 50 x 10e-6 m), in percent [0, 100]).</p>
</td></tr>
<tr><td><code id="ptf.cW_+3A_bd">BD</code></td>
<td>
<p>A vector of <code>n</code> elements with soil bulk density (g/cm3).</p>
</td></tr>
<tr><td><code id="ptf.cW_+3A_oc">OC</code></td>
<td>
<p>A vector of <code>n</code> elements with soil organic carbon content, in percent [0, 100].</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Pedotransfer function returns the van Genuchten - Mualem model parameters given <code>CLAY</code>, <code>SAND</code>, <code>BD</code>, and <code>OC</code>.
The correction of the original paper presented by (Weynants et al. 2009), were made by (WeihermÃ¼ller et al. 2017), which is implemented.
</p>


<h3>Note</h3>

<p>The PTF is not suitable for predicting the hydraulic conductivity curve at pressured heads &gt; -6 cm (Weynants et al. 2009).
</p>


<h3>Author(s)</h3>

<p>Melanie Weynants, <a href="mailto:mweynants@gmail.com">mweynants@gmail.com</a>
</p>
<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>Weynants M, Vereecken H, Javaux M (2009).
&ldquo;Revisiting Vereecken Pedotransfer Functions: Introducing a Closed-Form Hydraulic Model.&rdquo;
<em>Vadose Zone Journal</em>, <b>8</b>(1), 86.
ISSN 1539-1663, doi: <a href="https://doi.org/10.2136/vzj2008.0062">10.2136/vzj2008.0062</a>.
WeihermÃ¼ller L, Herbst M, Javaux M, Weynants M (2017).
&ldquo;Erratum to &ldquo;Revisiting Vereecken Pedotransfer Functions: Introducing a Closed-Form Hydraulic Model&rdquo;.&rdquo;
<em>Vadose Zone Journal</em>, <b>16</b>(1), 0.
ISSN 1539-1663, doi: <a href="https://doi.org/10.2136/vzj2008.0062er">10.2136/vzj2008.0062er</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result &lt;- ptf.cW(CLAY = .4, SAND = .4, BD = 1.6, OC = .5)

</code></pre>

<hr>
<h2 id='ptf.vG2BW'>Parameter Transfer Function for Weber et al.(2019) model.</h2><span id='topic+ptf.vG2BW'></span>

<h3>Description</h3>

<p>Predicts (Weber et al. 2019) model parameters in the van Genuchten-Mualem variant <em>01110FM</em>, from given van Genuchten-Mualem parameters 
for the constrained van Genuchten-Mualem model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptf.vG2BW(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ptf.vG2BW_+3A_x">x</code></td>
<td>
<p>vector of 6 van Genuchten-Model parameters. The order is sensitive see for <code><a href="#topic+shypFun.01110">shypFun.01110</a></code>
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>thr</code></td><td style="text-align: left;">Residual water content (-), alway equal to zero</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>ths</code></td><td style="text-align: left;">Saturated water content (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>alf1</code></td><td style="text-align: left;">Shape parameter (cm^-1)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>n1</code></td><td style="text-align: left;">Shape parameter (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Ks</code></td><td style="text-align: left;">Hydraulic conductivity at 0 potential (cm/day)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>tau</code></td><td style="text-align: left;">Shape parameter (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
 </td>
</tr>

</table>
</td></tr>
</table>


<h3>Details</h3>

<p>Pedotransfer function returns the van Genuchten - Mualem model <code><a href="#topic+shypFun.01110">shypFun.01110</a></code> parameters in the Brunswick-Model variant <em>01110FM</em>, based on previously determined van Genuchten-Mualem parameters. The transfer function is based on an ordinary linear regression between the i-th <em>01110</em> and <em>01110FM</em>. The paraemeters
were based on model parameter estimation to a dataset of &gt;400 samples with retention and conductivity measurements.
</p>


<h3>Value</h3>


<table>
<tr>
 <td style="text-align: left;">
     <code>thsnc</code></td><td style="text-align: left;">Saturated water content of the non-capillary part.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>thsc</code></td><td style="text-align: left;">Saturated water content of the capillary part.</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>alf</code></td><td style="text-align: left;">Shape parameter (cm^-1)</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>n</code></td><td style="text-align: left;">Shape parameter (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Ksc</code></td><td style="text-align: left;">Saturated hydraulic conductivity of the capillary part [cm day-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>tau</code></td><td style="text-align: left;">Shape parameter (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>Ksnc</code></td><td style="text-align: left;">Saturated hydraulic conductivity of the non-capillary part [cm day-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>a</code></td><td style="text-align: left;">slope of the non-capillary unsaturated conductivity [ - ]</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>h0</code></td><td style="text-align: left;">anker point at which the water content is 0
     </td>
</tr>

</table>



<h3>Note</h3>

<p>The parameter transfer function was derived by weighted linear regression with weights in <code>x</code> and <code>y</code>, 
by regressing the estimated the Brunswick model parameters in the Genuchten Mualem variant (Weber et al. 2019) 
inferred from matching measured soil water retention and hydraulic conductivity data against the constrained van Genuchten model parameters. 
The regression of <code>alf1</code> and <code>Ks</code>, and <code>(n-1)</code> was done in the <code>log[10])</code>-transformed space,
and <code>Kncs</code> is a fixed value of 10^-1.72.
</p>


<h3>Author(s)</h3>

<p>Efstathios Diamantopoulos , <a href="mailto:ed@plen.ku.dk">ed@plen.ku.dk</a>
</p>
<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+shypFun">shypFun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p      &lt;- c(0.08, 0.42, 0.01, 1.5, 100, 0.5)
result &lt;- ptf.vG2BW(p)

</code></pre>

<hr>
<h2 id='resFun'>Calculation of the Objective Function Value</h2><span id='topic+resFun'></span>

<h3>Description</h3>

<p>Contains the objective functions to calculate (weighted) sum of squared residuals or likelihoods.
The assumption made is that the residuals are identically, independantly and normally distributed.
The normal distribution of the model residuals is standardly given with mean = 0, and variance = 1.if weighting is not considered.
There are three methods to consider weights: a) fixed skalar values for each data type, b) a vector of weights for each 
data type. The vector has to have the same length as the vector of the data type.
c) It is possible to estimate the
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resFun(
  p,
  shpmodel = "01110",
  retdata = NULL,
  condata = NULL,
  pretrans = NULL,
  weight = NULL,
  method = "rss",
  trim.query = FALSE,
  ivap.query = NULL,
  hclip.query = FALSE,
  parL = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resFun_+3A_p">p</code></td>
<td>
<p>Vector of model parameters handed used to calculate the soil hydraulic property model values in <a href="#topic+shypFun">shypFun</a>.
Depends on <code>shpmodel</code> and the pressure head values specified in <code>retdata</code> and <code>condata</code></p>
</td></tr>
<tr><td><code id="resFun_+3A_shpmodel">shpmodel</code></td>
<td>
<p>Character identifying the soil hydraulic property model. See <a href="#topic+shypFun">shypFun</a>.</p>
</td></tr>
<tr><td><code id="resFun_+3A_retdata">retdata</code></td>
<td>
<p>A dataframe or matrix with 2 columns. The first with pressure head values in [cm] and the second with volumetric water contents in [cm cm-3].</p>
</td></tr>
<tr><td><code id="resFun_+3A_condata">condata</code></td>
<td>
<p>A dataframe or matrix with 2 columns. The first with pressure head values in [cm] and the second with hydraulic conductivity values in log10[cm d-1].</p>
</td></tr>
<tr><td><code id="resFun_+3A_pretrans">pretrans</code></td>
<td>
<p>A vector to back transform the parameters before the soil hydraulic property function values calculated.</p>
</td></tr>
<tr><td><code id="resFun_+3A_weight">weight</code></td>
<td>
<p>Specification of weight method. See <a href="#topic+weightFun">weightFun</a>.</p>
</td></tr>
<tr><td><code id="resFun_+3A_method">method</code></td>
<td>

<table>
<tr>
 <td style="text-align: left;">
    <code>rss</code></td><td style="text-align: left;">Default for the optimisation algortihm DEoptim. resFun returns skalar sum of squared (weighted) residuals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>res</code></td><td style="text-align: left;">Weighted residuals are computed and returnd. Required for post hoc analyses. </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>-2logLik</code></td><td style="text-align: left;">-2 * log-likelihood is returned. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="resFun_+3A_trim.query">trim.query</code></td>
<td>
<p>Default <code>FALSE</code>. If a trimodal soil hydraulic property function is used, this has to be specified by setting the argument to (<em>TRUE</em>) which ensures the sum of modal <code>weights == 1</code>.</p>
</td></tr>
<tr><td><code id="resFun_+3A_ivap.query">ivap.query</code></td>
<td>
<p>Default is <code>FALSE</code>, and no <em>ivap</em> method is specified. See <a href="#topic+KvapFun">KvapFun</a></p>
</td></tr>
<tr><td><code id="resFun_+3A_hclip.query">hclip.query</code></td>
<td>
<p>Implemented purely for future compatability.</p>
</td></tr>
<tr><td><code id="resFun_+3A_parl">parL</code></td>
<td>
<p>Defaults to <code>NULL</code>, only inserted for compatbility with <code>modMCMC</code> used in <a href="#topic+shypEstFun">shypEstFun</a>. <code>modMCMC</code>, only
handled parameters which are estimated, other model parameters need to be passed through parL. See Details of <a href="#topic+shypEstFun">shypEstFun</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Model errors may be specified or estimated as nuisance parameters weighting the data classes. In case the model error !=1, the output statistics are weighted accordingly.
</p>


<h3>Value</h3>

<p>Returns scalar of sum of squared (weighted) residuals or vector of weighted residuals, as specified by 
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>user</code></td><td style="text-align: left;">user defined weights</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>none</code></td><td style="text-align: left;">no weights are considered, i.e. no measurement error assumed</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>range</code></td><td style="text-align: left;">rescaling (normalization of observations to the intervall [0,1]</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>fix1</code></td><td style="text-align: left;">fixed scalar weight for THETA is 1/0.05^2 and weight for log10K is 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>est1</code></td><td style="text-align: left;">Two scalar model weights 1/sigma_i^2 are treated as free parameters to be estimated by inversion, one for <code>THETA</code> and one for <code>log10K</code>. Only simultaneously estimateable</td>
</tr>
<tr>
 <td style="text-align: left;">
    </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># load data
data("shpdata1")

# observations
retdata &lt;- shpdata1$LFH1$wrc[!is.na(shpdata1$LFH1$wrc[,1]),]
condata &lt;- shpdata1$LFH1$hcc

# 7 - resFun ------------------------------------------------------------
# soil hydraulic property model parameters, van Genuchten-Mualem
p &lt;- c("thr" = 0.16, "ths" = 0.46, "alf1" = 0.03, "n1" = 1.42, "Ks" = 26, "tau" = .5)

# calculate weighted residuals
wres &lt;- resFun(p, retdata = retdata, condata = condata, pretrans = NULL,
               weight = list("wth" = 0.0025, "wKh" = 1), method = "res", trim = FALSE)

## residuals of the soil water retention curve [-]
theta.wres &lt;- wres[1:dim(retdata)[1]]

## residuals of the log10 hydraulic conductivity curve [cm/d]
log10K.wres &lt;- wres[(dim(retdata)[1]+1) : length(wres)]

</code></pre>

<hr>
<h2 id='shpdata1'>Measured soil hydraulic property data</h2><span id='topic+shpdata1'></span>

<h3>Description</h3>

<p>Data from evaporation experiments using the UMS HYPROP device
on two soils with different textures 
Data ist reported in [cm3 cm-3]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(shpdata1)
</code></pre>


<h3>Format</h3>

<p>An object of class /code&quot;list&quot;.</p>


<h3>Source</h3>

<p>none
</p>


<h3>References</h3>

<p>Kettcheson, Price, Weber (2018):  Initial variability, evolution and model parameterization 
of the soil hydrophysical properties of a reclaimed oil sands watershed and constructed wetland, in revision.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(shpdata1)
ticksatmin &lt;- -2
tcllen &lt;- 0.4
ticksat   &lt;- seq(ticksatmin,5,1) 
pow &lt;- ticksatmin:5    

TS.wrc &lt;- shpdata1$TS1$wrc; TS.hcc &lt;- shpdata1$LFH1$wrc
TS.hcc &lt;- shpdata1$TS1$hcc; LFH.hcc &lt;- shpdata1$LFH1$hcc
                                                                                           
# PLOT THE MEASURED WATER RETENTION CURVE
plot(TS.wrc[,1:2]  , ylim = c(.1,.50), xlim = c(0,4), ylab = "", xlab = "", 
col = "darkgrey", axes=FALSE, main = "Measured Water Retention Curve")
points(TS.wrc[,1:2], pch = 4,col = "darkblue")
legend("topright", c("TS1", "LFH1"), pch = c(1,4), bty = "n", cex=1.2, 
col = c("darkgrey","darkblue"))
axis(1, at = pow, labels = parse(text = paste('10^',(pow), sep = "")),tcl = tcllen)  
axis(2, tcl = tcllen)
axis(4, labels = NA, tcl = tcllen)
axis(3, labels = NA, tcl = tcllen)  
mtext("pressure head |h| [cm]", 1, cex = 1.2, line = 2.8)
mtext("vol. water content [ - ]", 2, cex = 1.2, line = 2.8)
box()

# PLOT THE MEASURED HYDRAULIC CONDUCTIVITY CURVE

plot(TS.hcc, ylim = c(-8,2), xlim = c(0,4), ylab = "", xlab = "", col = "darkgrey", 
axes = FALSE, main = "Measured Hydraulic Conductivity Curve")
points(TS.hcc, pch = 4, col = "darkblue")

legend("topright", c("TS1", "LFH1"), pch = c(1,4), bty = "n", cex = 1.2, 
col = c("darkgrey","darkblue"))

axis(1, at = pow, labels = parse(text = paste('10^',(pow), sep = "")), tcl = tcllen)  
axis(2, tcl = tcllen)
axis(4, labels = NA, tcl = tcllen)
axis(3, labels = NA, tcl = tcllen) 

mtext("log10 K [cm/d]", 2, cex = 1.2, line = 2.8)
mtext("pressure head |h| [cm]",1 , cex = 1.2, line = 2.8)
box()
</code></pre>

<hr>
<h2 id='shypEstFun'>Wrapper function for the Estimation of Soil Hydrologic Property Model Parameters</h2><span id='topic+shypEstFun'></span>

<h3>Description</h3>

<p>Estimates model parameters of implemented soil hydraulic property functions. 
This function sets up the parameter estimation, given a set of arguments, and enables minimisation of (weighted) 
sum of squared residuals, assuming independent and identically distributed model residuals.
More information on the options is given in the <em>Details</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shypEstFun(
  shpmodel = "01110",
  parL,
  retdata,
  condata,
  ivap = NULL,
  hclip = FALSE,
  weightmethod = "none",
  LikModel = "rss",
  ALG = "DE",
  set.itermax = 200,
  ALGoptions = NULL,
  lhs.query = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shypEstFun_+3A_shpmodel">shpmodel</code></td>
<td>

<table>
<tr>
 <td style="text-align: left;">Character specifying the soil hydraulic property model. Currently valid models as documented in <a href="#topic+shypFun">shypFun</a> and are:</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>01110</code> constrained unimodal van Genuchten-Mualem.</td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>01210</code> constrained bimodal van Genuchten-Mualem.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>01310</code> constrained trimodal van Genuchten-Mualem.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>02110</code> unimodel Kosugi 2 parametric-Mualem model (Kosugi, 1996)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>03110</code> unimodel Fredlund-Xing-Mualem model, with the contraint of m = 1-1/n (Fredlund D.G., and A. Xing, 1994)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypEstFun_+3A_parl">parL</code></td>
<td>
<p><code>list</code> of 4 vectors with named vectors, the order in the list is sensitive.
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>p</code></td><td style="text-align: left;">vector with length <code>l</code> of model specific initial parameters, has to coincide with the chosen soil hydraulic property model.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>psel</code></td><td style="text-align: left;">vector with length <code>l</code> identifying which parameters are to be estimated</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>plo</code></td><td style="text-align: left;">vector of lower bounds (non-transformed parameter boundaries)</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>pup</code></td><td style="text-align: left;">vector of upper bounds (non-transformed parameters boundaries)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypEstFun_+3A_retdata">retdata</code></td>
<td>
<p>A dataframe or matrix with 2 columns. The first with log10 values of pressure head values in [cm] and the second with volumetric water contents in [cm cm-3].</p>
</td></tr>
<tr><td><code id="shypEstFun_+3A_condata">condata</code></td>
<td>
<p>A dataframe or matrix with 2 columns. The first with log10 values of pressure head values in [cm] and the second with hydraulic conductivity values log10[cm d-1].</p>
</td></tr>
<tr><td><code id="shypEstFun_+3A_ivap">ivap</code></td>
<td>
<p>Specification if isothermal vapour conductivity after Saito et al. (2006) is accounted, defaults to <code>NULL</code> and no isothermal vapour conducitvity is considered. See Details.</p>
</td></tr>
<tr><td><code id="shypEstFun_+3A_hclip">hclip</code></td>
<td>
<p>Implemented for future development reasons and is not yet functional. Specification if the hydraulic conductivity model should be 'clipped', i.e. constrained to a maxium pore diamater as introduced by Iden et al. (2015), defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shypEstFun_+3A_weightmethod">weightmethod</code></td>
<td>
<p>Specification of weight method. The implemented methods are
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>none</code></td><td style="text-align: left;">no weights are considered, i.e. no measurement error assumed</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>range</code></td><td style="text-align: left;">normalization of observations to the intervall [0,1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>fix1</code></td><td style="text-align: left;">fixed scalar weight for THETA is 0.05^2 and weight for log10K is 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>est1</code></td><td style="text-align: left;">Two scalar model weights (\$1/sigma^2) are treated as free parameters to be estimated by inversion, one for <code>THETA</code> and one for <code>log10K</code></td>
</tr>
<tr>
 <td style="text-align: left;">
      </td>
</tr>

</table>

<p>Alternatively, a list of vectors can be provided specifying the user given model weights (\$1/sigma^2). Either as skalar for each data class, or a vector with the same length as the number of data points given for each of the measurements in the respective data class.
The length of the list has to coincide with the data groups.</p>
</td></tr>
<tr><td><code id="shypEstFun_+3A_likmodel">LikModel</code></td>
<td>
<p>Specification of inverse modelling type. Has to be specified but implemented for future compatability)
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>rss</code></td><td style="text-align: left;">Default for the optimisation algorithm <code>DEoptim</code>. <code>resFun</code> returns skalar sum of squared (weighted) residuals</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>-2loglik</code></td><td style="text-align: left;">Specified if <code>ALG == -2*log-likelihood</code> value, which is minimised assuming Gaussian and i.i.d (weighted) residuals</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypEstFun_+3A_alg">ALG</code></td>
<td>
<p>Select global optimisation algorithm or a Markov chain Monte Carlos (MCMC) sampler.
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>DE</code></td><td style="text-align: left;">Default for the optimisation algortihm DEoptim. resFun returns a skalar sum of squared (weighted) residuals if <code>LikModel == "rss"</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>modMCMC</code></td><td style="text-align: left;">Default for the DRAM (Delayed Rejection Adaption Metropolis) algrothim implemented in <code>modMCMC</code> of the FME package. 
resFun returns a skalar -2loglik and <code>LikModel = "-2logLik"</code> has to be specified.</td>
</tr>
<tr>
 <td style="text-align: left;">
   </td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypEstFun_+3A_set.itermax">set.itermax</code></td>
<td>
<p>Integer specifying the maximum number of iterations <code>default = 200</code>.</p>
</td></tr>
<tr><td><code id="shypEstFun_+3A_algoptions">ALGoptions</code></td>
<td>
<p>A list with named entries setting the algorithm options. Each list element name is required to be identical with the names
as documented in the respective algortihm help <a href="DEoptim.html#topic+DEoptim.control">DEoptim.control</a> and <a href="FME.html#topic+modMCMC">modMCMC</a>. <br />
<code>set.itermax</code> overrides the maximum iterations argument.</p>
</td></tr>
<tr><td><code id="shypEstFun_+3A_lhs.query">lhs.query</code></td>
<td>
<p>default <code>FALSE</code>, <code>TRUE</code> will produce a Latin Hypercube Sample for the initial population when using <code>DEoptim</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several in-built methods for weighting the (multi-) objective function residuals are available, they may be specified, or estimated as nuisance parameters for the two data groups. More details see <code>weightFun</code>.
Weights are the inverse of the squared standard deviation of the residuals (variance).
</p>
<p>Generally, soil hydraulic property model parameters are estimated as transformed parameters: log10 for alpha_i, Ks, and log10 for n_i-1, Kc, Knc
</p>
<p>For model codes in <em>ivap</em> please refer to <a href="#topic+KvapFun">KvapFun</a>.
</p>
<p>Parallel computing for package <code>DEoptim</code> is not supported. And the optional arguments in <code>modMCMC</code> are not supported.
</p>


<h3>Value</h3>

<p><code>list</code> returns the result of the optimisation algrorithm or MCMC sampler and all settings.
</p>
<table>
<tr><td><code>settings</code></td>
<td>
<p>a <code>list</code> with output of the optimisation and summary of settings:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>weigth</code></td><td style="text-align: left;">the <code>list</code> with weights for the retention and conductivity data. </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>parL</code></td><td style="text-align: left;"> the <code>list</code> of initial and selected model parameters, and upper and lower bounds.</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>transL</code></td><td style="text-align: left;">list of parameter transformation rules used</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>shpmodel</code></td><td style="text-align: left;">the used soil hydraulic property model</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>ivap</code></td><td style="text-align: left;">isothermal vapour conductivity model</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>hclip</code></td><td style="text-align: left;">for future compatability</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>LikModel</code></td><td style="text-align: left;">the adopted method to calculate the objective function value</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>data</code></td><td style="text-align: left;"> a <code>list</code> of 2 objects with a) retention data and b) conductivity data used for the parameter estimation.
</td>
</tr>

</table>

</td></tr>
<tr><td><code>out</code></td>
<td>
<p>result of algorithm function <code>DEoptim</code> or <code>modMCMC</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("shpdata1")
retdata &lt;- shpdata1$TS1$wrc
condata &lt;- shpdata1$TS1$hcc
condata &lt;- condata[!is.na(condata[,1]),]

weightmethod &lt;- "range"
ivap         &lt;- NULL
set.itermax  &lt;- 1
LikModel     &lt;- "rss" # ALTERNATIVE OPTION: LikModel = "-2logLik"
ALG          &lt;- "DE"       # ALTERNATIVE OPTION: ALG = "modMCMC"

parL&lt;-list("p"=c("thr"=0.05,"ths"=0.45,"alf1"=0.01,"n"=2,"Ks"=100,"tau"=.5),
          "psel" = c(1, 1, 1, 1, 1, 1),
          "plo"= c(0.001 , 0.2 , 0.001 , 1.1, 1, -2),
          "pup"= c(0.3 , 0.8 , .1, 11 , 1e4, 10))

out &lt;- shypEstFun(shpmodel = "01110", 
                 parL = parL, 
                 retdata = retdata, condata = condata, 
                 ivap = ivap, 
                 hclip = FALSE, 
                 weightmethod = weightmethod,
                 LikModel = LikModel, 
                 ALG = ALG, 
                 set.itermax = set.itermax,
                 lhs.query = FALSE)
\dontshow{
}
\donttest{
data("shpdata1")
retdata &lt;- ret &lt;- shpdata1$TS1$wrc
condata &lt;- con &lt;- shpdata1$TS1$hcc
condata &lt;- condata[!is.na(condata[,1]),]

---
     
#  1 SET VARIABLES --------------------
#  VARIABLES FOR PLOTTING
{pF &lt;- seq(-3, 6.8, length = 201)
h &lt;- 10^pF
ticksatmin &lt;- -2
tcllen &lt;- 0.4
ticksat &lt;- seq(ticksatmin,5,1)
pow &lt;- ticksatmin:6

#  VARIABLES FOR THE FITTING ALGORITHM
weightmethod = "range"
ivap = NULL
set.itermax = 3e1
LikModel = "rss" # ALTERNATIVE OPTION: LikModel = "-2logLik"
ALG = "DE"       # ALTERNATIVE OPTION: ALG = "modMCMC"
shpmodel.v &lt;- c("01110", "01110FM") 

plot.query = FALSE
no.shps &lt;- length(shpmodel.v)

#  initialising lists
out.L &lt;- vector("list", no.shps)
gof.L &lt;- vector("list", no.shps)
}
# Run comparison
for (i in 1:2) {
     shpmodel = shpmodel.v[i]
     # INITIAL PARAMETERS, BOUNDS, and SELECTED PARAMETERS FOR FITTING
     switch(shpmodel,
    "01110" = {
          
          # van Genuchten-Mualem Model parameters
          parL&lt;-list("p"=c("thr"=0.05,"ths"=0.45,"alf1"=0.01,"n"=2,"Ks"=100,"tau"=.5),
                     "psel" = c(1, 1, 1, 1, 1, 1),
                     "plo"= c(0.001 , 0.2 , 0.001 , 1.1, 1, -2),
                     "pup"= c(0.3 , 0.8 , .1, 11 , 1e4, 10)
          )
    },
    
    "01110FM" = {
          
          # van Genuchten-Mualem Model parameters + BRUNSWICK MODEL
          parL&lt;-list("p"=c("thr"=0.05,"ths"=0.45,"alf1"=0.01,"n"=2,"Ksc"=100,
                           "tau"=.5,"Ksnc"=1e-4,"a"=1.5,"h0"=6.8),
                     "psel" = c( 1,1, 1 ,1 , 1,1,1, 0, 0),
                     "plo"= c(0.001 , 0.1 , 0.001 , 1.1, 1,0,1e-6 , 1, 6.5),
                     "pup"= c(0.35, 0.7 , .1, 11 , 1e4,10 ,1e0, 2, 6.9)
          )
    },
    stop("Enter a meaningful shpmodel")
     )
     
     out &lt;- shypEstFun(shpmodel = shpmodel, 
                parL = parL, 
                retdata = retdata, condata = condata, 
                ivap = ivap, 
                hclip = FALSE, 
                weightmethod = weightmethod,
                LikModel = LikModel, 
                ALG = ALG, 
                set.itermax = set.itermax
                ,lhs.query = FALSE)
     
     out$model &lt;- shpmodel.v[i]
     out.L[[i]] &lt;- out
     
     
     #  Calculate the soil hydraulic properties for the plot
     if(ALG == "DE"){
           p &lt;- out$out$optim$phattrans
     }
     
     if(ALG == "modMCMC"){
           p &lt;- out$out$bestpartrans
     }
     
     if(weightmethod =="est1"){
           np &lt;- length(p)
           p &lt;- p[-c(np-1, np)]
           if(ALG =="modMCMC"){
                 parL$p[which(parL$psel==1)] &lt;- p
                 p &lt;- parL$p
           }
     }
     
     if(plot.query==TRUE){
           
           shyp.L&lt;-shypFun(p,h,shpmodel=shpmodel.v[i],ivap.query=ivap)
           
           if(shpmodel == c("01110")){
                 
                 wrc&lt;-shyp.L$theta
                 hcc&lt;-log10(shyp.L$Kh)
                 
                 # PLOT THE WATER RETENTION CURVE
                 par(mfrow=c(1,2),tcl=tcllen)
                 plot(retdata,ylim=c(.0,.50),xlim=c(0,6.8),ylab="",xlab="",
                      col="darkgrey",axes=FALSE,main="WaterRetentionCurve",cex=2)
                 lines(log10(abs(h)),wrc,col="darkblue",lwd=2)
                 legend("topright",c("observed","simulated"),pch=c(1,NA),
                        lty=c(NA,1),lwd=2,bty="n",cex=1.3,col=c("darkgrey","darkblue"))
                 axis(1,at=pow,labels=parse(text=paste('10^',(pow),sep="")),tcl=tcllen)
                 axis(2,tcl=tcllen)
                 axis(4,labels=NA)
                 axis(3,labels=NA)
                 mtext("pressurehead|h|[cm]",1,cex=1.2,line=2.8)
                 mtext("vol.watercontent[-]",2,cex=1.2,line=2.8)
                 box()
                 
                 # PLOT THE MEASURED HYDRAULIC CONDUCTIVITY CURVE
                 plot(condata,ylim=c(-8,2),xlim=c(0,6.8),ylab="",xlab="",col="darkgrey",
                      axes=FALSE,main="HydraulicConductivityCurve",cex=2)
                 lines(log10(abs(h)),hcc,col="darkblue",lwd=2)
                 legend("topright",c("observed","simulated"),pch=c(1,NA),
                        lty=c(NA,1),lwd=2,bty="n",cex=1.3,col=c("darkgrey","darkblue"))
                 axis(1,at=pow,labels=parse(text=paste('10^',(pow),sep="")),tcl=tcllen)
                 axis(2)
                 axis(4,labels=NA)
                 axis(3,labels=NA)
                 mtext("log10K[cm/d]",2,cex=1.2,line=2.8)
                 mtext("pressurehead|h|[cm]",1,cex=1.2,line=2.8)
                 box()
                 par(mfrow=c(1,1))
                 
           }
           
           if(shpmodel == "01110FM"){
                 
                 wrc&lt;-shyp.L$theta
                 wrccap&lt;-shyp.L$thetacap
                 wrcnc&lt;-shyp.L$thetanc
                 
                 hcc&lt;-log10(shyp.L$Kh)
                 hcccap&lt;-log10(shyp.L$Kcap)
                 hccnc&lt;-log10(shyp.L$Knc)
                 hcvap&lt;-log10(shyp.L$Kvap)
                 
                 par(mfrow=c(1,2),tcl=tcllen)
                 plot(retdata,ylim=c(.0,.50),xlim=c(0,6.8),ylab="",xlab="",
                      col="darkgrey",axes=FALSE,main="WaterRetentionCurve",cex=2)
                 lines(log10(h),wrccap,col="brown",lwd=2)
                 lines(log10(h),wrcnc,col="brown",lwd=2,lty=2)
                 lines(log10(h),wrc,col="darkblue",lwd=2)
                 
                 legend("topright",c("observed","simulated"),pch=c(1,NA),
                        lty=c(NA,1),lwd=2,bty="n",cex=1.3,col=c("darkgrey","darkblue"))
                 axis(1,at=pow,labels=parse(text=paste('10^',(pow),sep="")),tcl=tcllen)
                 axis(2,tcl=tcllen)
                 axis(4,labels=NA)
                 axis(3,labels=NA)
                 mtext("pressurehead|h|[cm]",1,cex=1.2,line=2.8)
                 mtext("vol.watercontent[-]",2,cex=1.2,line=2.8)
                 box()
                 
                 #  PLOT THE HYDRAULIC CONDUCTIVITY CURVE
                 plot(condata,ylim=c(-8,max(max(condata[,1]),max(hcc)))
                      ,xlim=c(0,6.8),ylab="",xlab="",col="darkgrey",
                      axes=FALSE,main="HydraulicConductivityCurve",cex=2)
                 lines(log10(h),hcccap,col="brown",lwd=2)
                 lines(log10(h),hccnc,col="brown",lwd=2,lty=2)
                 lines(log10(h),hcc,col="darkblue",lwd=2)
                 lines(log10(h),hcvap,col="darkblue",lwd=2)
                 legend("topright",c("observed","simulated"),pch=c(1,NA),
                        lty=c(NA,1),lwd=2,bty="n",cex=1.3,col=c("darkgrey","darkblue"))
                 axis(1,at=pow,labels=parse(text=paste('10^',(pow),sep="")),tcl=tcllen)
                 axis(2)
                 axis(4,labels=NA)
                 axis(3,labels=NA)
                 mtext("log10K[cm/d]",2,cex=1.2,line=2.8)
                 mtext("pressurehead|h|[cm]",1,cex=1.2,line=2.8)
                 box()
                 par(mfrow=c(1,1))
           }
     }
     phattrans.m &lt;- out$out$optim$phattrans
     gof.L[[i]]&lt;-gofFun(phattrans.m,shpmodel=shpmodel.v[i],retdata=retdata,condata=condata,
                        out.L[[i]]$settings$weight,parL$psel,ivap.query=NULL,hclip.query=FALSE)
}

statstab3 &lt;- cbind("th_rmse" = unlist(lapply(lapply(gof.L, `[[`, "th"), '[[', "rmse")),
                  "log10Kh_rmse" = unlist(lapply(lapply(gof.L, `[[`, "log10Kh"), '[[', "rmse"))
)
}

## End(Not run) 
</code></pre>

<hr>
<h2 id='shypFun'>Wrapper Function for all Supported Soil Hydraulic Property Models</h2><span id='topic+shypFun'></span>

<h3>Description</h3>

<p>This function allows to select soil hydraulic property models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shypFun(p, h, shpmodel = "01110", ivap.query = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shypFun_+3A_p">p</code></td>
<td>
<p>Vector of the model parameters, order is sensitve cf respective model documentation.</p>
</td></tr>
<tr><td><code id="shypFun_+3A_h">h</code></td>
<td>
<p>Pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
<tr><td><code id="shypFun_+3A_shpmodel">shpmodel</code></td>
<td>
<p>character
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>01110</code></td><td style="text-align: left;">unimodel van Genuchten-Mualem model, with the contraint of m = 1-1/n (van
Genuchten 1980)</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>01210</code></td><td style="text-align: left;">bimodel van Genuchten-Mualem model, with the contraint of m_i = 1-1/n_i (Durner 1994)</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>01310</code></td><td style="text-align: left;">trimodal van Genuchten-Mualem model, with the contraint of m_i = 1-1/n_i (Durner 1994)</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>02110</code></td><td style="text-align: left;">unimodel Kosugi 2 parametric-Mualem model (Kosugi 1996)</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>03110</code></td><td style="text-align: left;">unimodel Fredlund-Xing-Mualem model, with the contraint of m = 1-1/n (Fredlund and Xing 1994)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypFun_+3A_ivap.query">ivap.query</code></td>
<td>

<table>
<tr>
 <td style="text-align: left;">
<code>NULL</code></td><td style="text-align: left;">no isothermal vapour conductivity will be calculated with <code>Kvap</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;">Model type for isothermal vapour conductivity, see Details of function <a href="#topic+KvapFun">KvapFun</a> for model codes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>list</code> with calculated soil hydraulic properties at specified <code>h</code>:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>calculated volumetric moisture content</p>
</td></tr>
<tr><td><code>Se</code></td>
<td>
<p>calculated saturation</p>
</td></tr>
<tr><td><code>Scap</code></td>
<td>
<p>effective saturation (of the capillary part if <code>FM</code> is specified</p>
</td></tr>
<tr><td><code>cap</code></td>
<td>
<p>specific water capacity function (of the capillary part if <code>FM</code> is specified</p>
</td></tr>
<tr><td><code>psd</code></td>
<td>
<p>pore size distribution (of the capillary part if <code>FM</code> is specified</p>
</td></tr>
<tr><td><code>Kh</code></td>
<td>
<p>total hydraulic conductivity</p>
</td></tr>
</table>
<p>if <code>FM</code> specified, additionally:
</p>
<table>
<tr><td><code>thetacap</code></td>
<td>
<p>calculated volumetric moisture content of the capillary part</p>
</td></tr>
<tr><td><code>thetanc</code></td>
<td>
<p>calculated volumetric moisture content of the non-capillary part</p>
</td></tr>
<tr><td><code>Snc</code></td>
<td>
<p>effective saturation of the non-capillary part</p>
</td></tr>
<tr><td><code>Kcap</code></td>
<td>
<p>hydraulic conductivity of the capillary</p>
</td></tr>
<tr><td><code>Knc</code></td>
<td>
<p>hydraulic conductivity of the non-capillary</p>
</td></tr>
<tr><td><code>Kvap</code></td>
<td>
<p>isothermal vapour conductivity</p>
</td></tr>
<tr><td><code>Krcap</code></td>
<td>
<p>relative hydraulic conductivity of the capillary</p>
</td></tr>
<tr><td><code>Krnc</code></td>
<td>
<p>relative hydraulic conductivity of the non-capillary</p>
</td></tr>
</table>


<h3>Note</h3>

<p>the function is used to assign a new function variable with a function which calculates the soil hydraulic properties 
according to sepcified <code>shpmodel</code> and model specified by <code>ivap.query</code>
</p>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>Durner W (1994).
&ldquo;Hydraulic conductivity estimation for soils with heterogeneous pore structure.&rdquo;
<em>Water Resources Research</em>, <b>30</b>(2), 211&ndash;223.
ISSN 0043-1397.<br />
Fredlund DG, Xing A (1994).
&ldquo;Equations for the soil-water characteristic curve.&rdquo;
<em>Canadian Geotechnical Journal</em>, <b>31</b>(4), 521&ndash;532.
ISSN 00083674 (ISSN), doi: <a href="https://doi.org/10.1139/t94-061">10.1139/t94-061</a>.
Kosugi K (1996).
&ldquo;Lognormal distribution model for unsaturated soil hydraulic properties.&rdquo;
<em>Water Resources Research</em>, <b>32</b>(9), 2697&ndash;2703.
ISSN 0043-1397.
van
Genuchten MT (1980).
&ldquo;Closed-form equation for predicting the hydraulic conductivity of unsaturated soils.&rdquo;
<em>Soil Science Society of America Journal</em>, <b>44</b>(5), 892&ndash;898.
ISSN 03615995 (ISSN).
Weber TK, Durner W, Streck T, Diamantopoulos E (2019).
&ldquo;A modular framework for modelling unsaturated soil hydraulic properties over the full moisture range.&rdquo;
<em>Water Resources Research</em>.
ISSN 0043-1397, doi: <a href="https://doi.org/10.1029/2018WR024584">10.1029/2018WR024584</a>.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 data("shpdata1")
 retdata &lt;- shpdata1$LFH1$wrc[!is.na(shpdata1$LFH1$wrc[,1]),]
 condata &lt;- shpdata1$LFH1$hcc
 
 # assign auxiliary variables
 pF &lt;- seq(-3, 6.8, length = 501)
 h &lt;- 10^pF
 
 # assign list of parameters for the van Genuchten-Mualem model
 parL &lt;- list("p" = c("thr"= 0.05, "ths" = 0.45, "alf1" = 0.01, "n" = 2, "Ks" = 100, "tau" = .5),
              "psel" = c(1, 1, 0, 1, 1, 1),
              "plo" = c(0.001 , 0.2, 0.001, 1.1, 1, -2),
              "pup" = c(0.3, 0.95, 1, 10, 1e4, 10))
 
 # calculate soil hydraulic property function values
 
 shyp.L &lt;- shypFun(parL$p, h, shpmodel = "01110", ivap.query = NULL)
 wrc &lt;- shyp.L$theta
 hcc &lt;- log10(shyp.L$Kh)
 
 # # PLOT THE MEASURED WATER RETENTION CURVE
 ticksatmin &lt;- -2
 tcllen &lt;- 0.4
 ticksat &lt;- seq(ticksatmin,5,1)
 pow &lt;- ticksatmin:6
 
 par(mfrow = c(1,2), tcl = tcllen)
 plot(retdata, ylim = c(.0,.50), xlim = c(0, 6.8), ylab = "", xlab = "",
      col = "darkgrey", axes = FALSE, main = "Water Retention Curve", cex = 2)
 lines(log10(h), wrc, col = "darkblue", lwd = 2)
 legend("topright", c("observed", "simulated"),pch = c(1,NA),
        lty = c(NA,1), lwd = 2, bty = "n", cex = 1.3,col = c("darkgrey", "darkblue"))
 axis(1, at = pow, labels = parse(text = paste('10^',(pow), sep = "")), tcl = tcllen)
 axis(2, tcl = tcllen)
 axis(4, labels = NA)
 axis(3, labels = NA)
 mtext("pressure head |h| [cm]", 1, cex = 1.2, line = 2.8)
 mtext("vol. water content [ - ]", 2, cex = 1.2, line = 2.8)
 box()
 
 # PLOT THE MEASURED HYDRAULIC CONDUCTIVITY CURVE
 plot(condata, ylim = c(-8,2), xlim = c(0, 6.8), ylab = "", xlab = "", col = "darkgrey",
      axes = FALSE, main = "Hydraulic Conductivity Curve", cex = 2)
 lines(log10(h), hcc, col = "darkblue", lwd = 2)
 legend("topright", c("observed", "simulated"), pch = c(1,NA),
        lty = c(NA,1), lwd = 2, bty = "n", cex = 1.3, col = c("darkgrey","darkblue"))
 axis(1, at = pow, labels = parse(text = paste('10^',(pow), sep = "")), tcl = tcllen)
 axis(2)
 axis(4, labels = NA)
 axis(3, labels = NA)
 mtext("log10 K [cm/d]", 2, cex = 1.2, line = 2.8)
 mtext("pressure head |h| [cm]",1 , cex = 1.2, line = 2.8)
 box()
 par(mfrow = c(1,1))
 
 ## Not run: 
 # HOW TO WRITE A MATER.IN FOR HYDRUS-1D
 
 mater_out &lt;- cbind(shyp.L[['theta']], h, shyp.L[['Kh']], abs(shyp.L[['cap']]))
 
 materWriteFun &lt;- function(mater_out.L, path = getwd(), sample) {
       
       # Function to write a Mater.in
       
       # ARGUMENTS
       
       # mater_outdata frame of 4 columns of calculated SHP values at h and length n. 
       # 1. Column: THETA
       # 2. Column: H(negative pressure heads)
       # 3. Column: K
       # 4. Column: C(positive)
       # path character specifying the path where the MATER.IN should be saved
       # sample optional chr for sample name: NULL = no name given
       
       n &lt;- dim(mater_out)[1]
       sink(file.path(path, paste(sample, "MATER.IN", sep = "")))
       cat(c("iCap", "\n", "1", "\n", "NTab", "\n", n, "\n"))
       cat(c("\t","THETA", "\t\t\t","H","\t\t\t","K","\t\t\t","C"))
       cat("\n")
       
       write.table(format(mater_out, justify = "right"),
                   row.names = FALSE, col.names = FALSE, quote = FALSE)
       sink()
 }
 
## End(Not run)
</code></pre>

<hr>
<h2 id='shypFun.01110'>van Genuchten-Mualem Soil Hydraulic Proptery Model</h2><span id='topic+shypFun.01110'></span>

<h3>Description</h3>

<p>van Genuchten-Mualem functions for the retention and hydraulic conductivity curves (van
Genuchten 1980).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shypFun.01110(p, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shypFun.01110_+3A_p">p</code></td>
<td>
<p>vector of the 6 van Genuchten-Mualem model parameters, the order is sensitve and has to be given as:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>thr</code></td><td style="text-align: left;">residual water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>ths</code></td><td style="text-align: left;">saturated water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>alf1</code></td><td style="text-align: left;">van Genuchten alpha [cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>n1</code></td><td style="text-align: left;">van Genuchten n [-]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>Ks</code></td><td style="text-align: left;">saturated conductivity [cm d-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>tau</code></td><td style="text-align: left;">exponent of <code>Se</code> in the capillary conductivity model, sometimes denoted in the literature as <code>l</code> [-]
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypFun.01110_+3A_h">h</code></td>
<td>
<p>pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function solves analytically the spec. water capacity function and integral to the capillary bundle model.
It can be extended by the Brunswick model to account for non-capillary storage and conductivity (Weber et al. 2019).
</p>


<h3>Value</h3>

<p>returns a <code>list</code> with calculations at specified <code>h</code>:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>calculated volumetric moisture content</p>
</td></tr>
<tr><td><code>Se</code></td>
<td>
<p>calculated saturation</p>
</td></tr>
<tr><td><code>cap</code></td>
<td>
<p>specific water capacity function</p>
</td></tr>
<tr><td><code>psd</code></td>
<td>
<p>pore size distribution</p>
</td></tr>
<tr><td><code>Kh</code></td>
<td>
<p>Hydraulic conductivity values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>van
Genuchten MT (1980).
&ldquo;Closed-form equation for predicting the hydraulic conductivity of unsaturated soils.&rdquo;
<em>Soil Science Society of America Journal</em>, <b>44</b>(5), 892&ndash;898.
ISSN 03615995 (ISSN).
Weber TK, Durner W, Streck T, Diamantopoulos E (2019).
&ldquo;A modular framework for modelling unsaturated soil hydraulic properties over the full moisture range.&rdquo;
<em>Water Resources Research</em>.
ISSN 0043-1397, doi: <a href="https://doi.org/10.1029/2018WR024584">10.1029/2018WR024584</a>.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p      &lt;- c(0.1, 0.4, 0.01, 2, 100, .5)
h      &lt;- 10^seq(-2, 6.8, length = 197)
shyp.L &lt;- shypFun.01110(p, h)
</code></pre>

<hr>
<h2 id='shypFun.01210'>van Genuchten-Mualem bimodal Soil Hydraulic Propterty Model</h2><span id='topic+shypFun.01210'></span>

<h3>Description</h3>

<p>bimodal van Genuchten-Mualem functions (Durner model) for the retention and hydraulic conductivity curves (Durner 1994).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shypFun.01210(p, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shypFun.01210_+3A_p">p</code></td>
<td>
<p>vector of the 9 van Genuchten-Mualem model parameters, order is sensitve and has to be given as:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>thr</code></td><td style="text-align: left;">residual water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>ths</code></td><td style="text-align: left;">saturated water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>alf1</code></td><td style="text-align: left;">van Genuchten alpha [cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>n1</code></td><td style="text-align: left;">van Genuchten n [-]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>w1</code></td><td style="text-align: left;">fraction of the first modality [-], <code>w2</code> is internally computed as <code>w2 = 1-w1</code></td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>alf2</code></td><td style="text-align: left;">van Genuchten alpha of the second modality[cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>n2</code></td><td style="text-align: left;">van Genuchten n of the second modality [-]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>Ks</code></td><td style="text-align: left;">saturated conductivity [cm d-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>tau</code></td><td style="text-align: left;">exponent of <code>Se</code> in the capillary conductivity model, sometimes denoted in the literature as <code>l</code> [-]
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypFun.01210_+3A_h">h</code></td>
<td>
<p>pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function solves analytically the spec. water capacity function and integral to the capillary bundle model.
</p>


<h3>Value</h3>

<p>returns a <code>list</code> with calculations at specified <code>h</code>:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>calculated volumetric moisture content</p>
</td></tr>
<tr><td><code>Se</code></td>
<td>
<p>calculated saturation</p>
</td></tr>
<tr><td><code>cap</code></td>
<td>
<p>specific water capacity function</p>
</td></tr>
<tr><td><code>psd</code></td>
<td>
<p>pore size distribution</p>
</td></tr>
<tr><td><code>Kh</code></td>
<td>
<p>Hydraulic conductivity values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>Durner W (1994).
&ldquo;Hydraulic conductivity estimation for soils with heterogeneous pore structure.&rdquo;
<em>Water Resources Research</em>, <b>30</b>(2), 211&ndash;223.
ISSN 0043-1397.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- c("thr" = 0.1, "ths" = 0.4, alf1 = 0.5, "n1" = 3,
       "w1" = .6, "alf2" = 0.01, "n2" = 1.6, 
       "Ks" = 100, "tau" = .5)
h &lt;- 10^seq(-2, 6.8, length = 197)
shyp.L &lt;- shypFun.01210(p, h)

</code></pre>

<hr>
<h2 id='shypFun.01310'>van Genuchten-Mualem trimodal Soil Hydraulic Propterty Model</h2><span id='topic+shypFun.01310'></span>

<h3>Description</h3>

<p>trimodal van Genuchten-Mualem functions for the retention and hydraulic conductivity curves (Durner 1994).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shypFun.01310(p, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shypFun.01310_+3A_p">p</code></td>
<td>
<p>vector of the 9 van Genuchten-Mualem model parameters, order is sensitve and has to be given as:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>thr</code></td><td style="text-align: left;">residual water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>ths</code></td><td style="text-align: left;">saturated water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>alf1</code></td><td style="text-align: left;">van Genuchten alpha [cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>n1</code></td><td style="text-align: left;">van Genuchten n [-]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>w1</code></td><td style="text-align: left;">fraction of the first modality [-], <code>w2</code> is internally computed as <code>w2 = 1-w1</code></td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>alf2</code></td><td style="text-align: left;">van Genuchten alpha of the second modality[cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>n2</code></td><td style="text-align: left;">van Genuchten n of the second modality [-]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>w2</code></td><td style="text-align: left;">fraction of the second modality [-], <code>w3</code> is internally computed as <code>w3 = 1-w1-w2</code>, in <code>resFun</code> ensures <code>w3 &gt;=0</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>alf3</code></td><td style="text-align: left;">van Genuchten alpha of the third modality[cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>n3</code></td><td style="text-align: left;">van Genuchten n of the third modality [-]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>Ks</code></td><td style="text-align: left;">saturated conductivity [cm d-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>tau</code></td><td style="text-align: left;">exponent of <code>Se</code> in the capillary conductivity model, sometimes denoted in the literature as <code>l</code> [-]
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypFun.01310_+3A_h">h</code></td>
<td>
<p>pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function solves analytically the spec. water capacity function and integral to the capillary bundle model.
</p>


<h3>Value</h3>

<p>returns a <code>list</code> with calculations at specified <code>h</code>:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>calculated volumetric moisture content</p>
</td></tr>
<tr><td><code>Se</code></td>
<td>
<p>calculated saturation</p>
</td></tr>
<tr><td><code>cap</code></td>
<td>
<p>specific water capacity function</p>
</td></tr>
<tr><td><code>psd</code></td>
<td>
<p>pore size distribution</p>
</td></tr>
<tr><td><code>Kh</code></td>
<td>
<p>Hydraulic conductivity values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>Durner W (1994).
&ldquo;Hydraulic conductivity estimation for soils with heterogeneous pore structure.&rdquo;
<em>Water Resources Research</em>, <b>30</b>(2), 211&ndash;223.
ISSN 0043-1397.<br />
</p>


<h3>See Also</h3>

<p>Weber TK, Durner W, Streck T, Diamantopoulos E (2019).
&ldquo;A modular framework for modelling unsaturated soil hydraulic properties over the full moisture range.&rdquo;
<em>Water Resources Research</em>.
ISSN 0043-1397, doi: <a href="https://doi.org/10.1029/2018WR024584">10.1029/2018WR024584</a>.<br />
Weber TKD, Iden SC, Durner W (2017).
&ldquo;Unsaturated hydraulic properties of Sphagnum moss and peat reveal trimodal pore-size distributions.&rdquo;
<em>Water Resources Research</em>, <b>53</b>(1), 415&ndash;434.
ISSN 0043-1397, doi: <a href="https://doi.org/10.1002/2016WR019707">10.1002/2016WR019707</a>.<br />
Weber TKD, Iden SC, Durner W (2017).
&ldquo;A pore-size classification for peat bogs derived from unsaturated hydraulic properties.&rdquo;
<em>Hydrology and Earth System Sciences</em>, <b>21</b>(12), 6185&ndash;6200.
ISSN 1607-7938, doi: <a href="https://doi.org/10.5194/hess-21-6185-2017">10.5194/hess-21-6185-2017</a>.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- c("thr" = 0.1, "ths" = 0.4, alf1 = .5, "n1" = 3,
       "w1" = .5, "alf2" = 0.01, "n2" = 2, 
       "w2" = .3, "alf3" = 0.01, "n3" = 1.6, 
       "Ks" = 100, "tau" = .5)
h &lt;- 10^seq(-2, 6.8, length = 197)
shyp.L &lt;- shypFun.01310(p, h)

</code></pre>

<hr>
<h2 id='shypFun.02110'>Unimodal Kosugi-Mualem Model (2 Parameter Model)</h2><span id='topic+shypFun.02110'></span>

<h3>Description</h3>

<p>Calculates the soil hydraulic property function values based on given pressure heads (Kosugi 1996).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shypFun.02110(p, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shypFun.02110_+3A_p">p</code></td>
<td>
<p>vector of the 6 Kosugi-Mualem model parameters, order is sensitve and has to be given as:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>thr</code></td><td style="text-align: left;">residual water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>ths</code></td><td style="text-align: left;">saturated water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>hm</code></td><td style="text-align: left;">air entry pressure head [cm]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>sigma</code></td><td style="text-align: left;">width of pore size distribution [ - ]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>Ks</code></td><td style="text-align: left;">saturated conductivity [cm d-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>tau</code></td><td style="text-align: left;">exponent of <code>Se</code> in the capillary conductivity model, sometimes denoted in the literature as <code>l</code> [-]</td>
</tr>
<tr>
 <td style="text-align: left;">
         </td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypFun.02110_+3A_h">h</code></td>
<td>
<p>pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function solves analytically the spec. water capacity function and integral to the capillary bundle model.
</p>


<h3>Value</h3>

<p>returns a <code>list</code> with calculations at specified <code>h</code>:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>calculated volumetric moisture content</p>
</td></tr>
<tr><td><code>Se</code></td>
<td>
<p>calculated saturation</p>
</td></tr>
<tr><td><code>cap</code></td>
<td>
<p>specific water capacity function</p>
</td></tr>
<tr><td><code>psd</code></td>
<td>
<p>pore size distribution</p>
</td></tr>
<tr><td><code>Kh</code></td>
<td>
<p>Hydraulic conductivity values</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kosugi K (1996).
&ldquo;Lognormal distribution model for unsaturated soil hydraulic properties.&rdquo;
<em>Water Resources Research</em>, <b>32</b>(9), 2697&ndash;2703.
ISSN 0043-1397.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p      &lt;- c(0.1, 0.4, 100, 2, 100, .5)
h      &lt;- 10^seq(-2, 6.8, length = 197)
shyp.L &lt;- shypFun.02110(p, h)
</code></pre>

<hr>
<h2 id='shypFun.03110'>Unimodal Fredlund-Xing - Mualem Model</h2><span id='topic+shypFun.03110'></span>

<h3>Description</h3>

<p>Calculates the soil hydraulic property function values based on given pressure heads. The function calculates the base function of Fredlund and Xing (Fredlund and Xing 1994).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shypFun.03110(p, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shypFun.03110_+3A_p">p</code></td>
<td>
<p>vector of the 6 van Genuchten-Mualem model parameters, order is sensitve and has to be given as:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>thr</code></td><td style="text-align: left;">residual water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>ths</code></td><td style="text-align: left;">saturated water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>alf1</code></td><td style="text-align: left;">inverse of the air entry pressure head [cm]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>n1</code></td><td style="text-align: left;">width of pore size distribution [ - ]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>Ks</code></td><td style="text-align: left;">saturated conductivity [cm d-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>tau</code></td><td style="text-align: left;">exponent of <code>Se</code> in the capillary conductivity model, sometimes denoted in the literature as <code>l</code> [ - ]</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypFun.03110_+3A_h">h</code></td>
<td>
<p>pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function numerically solves the spec. water capacity function and integral to Mualem's conductivity model.
</p>


<h3>Value</h3>

<p>returns a <code>list</code> with calculations at specified <code>h</code>:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>calculated volumetric moisture content</p>
</td></tr>
<tr><td><code>Se</code></td>
<td>
<p>calculated saturation</p>
</td></tr>
<tr><td><code>cap</code></td>
<td>
<p>specific water capacity function</p>
</td></tr>
<tr><td><code>psd</code></td>
<td>
<p>pore size distribution</p>
</td></tr>
<tr><td><code>Kh</code></td>
<td>
<p>Hydraulic conductivity values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>Fredlund DG, Xing A (1994).
&ldquo;Equations for the soil-water characteristic curve.&rdquo;
<em>Canadian Geotechnical Journal</em>, <b>31</b>(4), 521&ndash;532.
ISSN 00083674 (ISSN), doi: <a href="https://doi.org/10.1139/t94-061">10.1139/t94-061</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p      &lt;- c(0.1, 0.4, 0.01, 2, 100, .5)
h      &lt;- 10^seq(-2, 6.8, length = 197)
shyp.L &lt;- shypFun.03110(p, h)
</code></pre>

<hr>
<h2 id='shypFun.04110'>Unimodal Brooks-Corey Model</h2><span id='topic+shypFun.04110'></span>

<h3>Description</h3>

<p>Calculates the soil hydraulic property function values based on given pressure heads (Kosugi 1996).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shypFun.04110(p, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shypFun.04110_+3A_p">p</code></td>
<td>
<p>vector of the 6 Brooks-Corey model parameters, order is sensitve and has to be given as:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>thr</code></td><td style="text-align: left;">residual water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>ths</code></td><td style="text-align: left;">saturated water water content [cm cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>alf</code></td><td style="text-align: left;">air entry pressure head [cm^-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>bet</code></td><td style="text-align: left;">effective model parameter [ - ]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>Ks</code></td><td style="text-align: left;">saturated conductivity [cm d-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>tau</code></td><td style="text-align: left;">exponent of <code>Se</code> in the capillary conductivity model, sometimes denoted in the literature as <code>l</code> [-]</td>
</tr>
<tr>
 <td style="text-align: left;">
         </td>
</tr>

</table>
</td></tr>
<tr><td><code id="shypFun.04110_+3A_h">h</code></td>
<td>
<p>pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function solves analytically the spec. water capacity function and integral to the capillary bundle model.
</p>


<h3>Value</h3>

<p>returns a <code>list</code> with calculations at specified <code>h</code>:
</p>
<table>
<tr><td><code>theta</code></td>
<td>
<p>calculated volumetric moisture content</p>
</td></tr>
<tr><td><code>Se</code></td>
<td>
<p>calculated saturation</p>
</td></tr>
<tr><td><code>cap</code></td>
<td>
<p>returns NA; not supported</p>
</td></tr>
<tr><td><code>psd</code></td>
<td>
<p>returns NA; not supported</p>
</td></tr>
<tr><td><code>Kh</code></td>
<td>
<p>Hydraulic conductivity values</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The Muealm integral is solved numerically
</p>


<h3>References</h3>

<p>Brooks RH, Corey AT (1964).
<em>Hydraulic Properties of Porous Media</em>.
Hydrology Papers No 3, Colorado State University, Fort Collings, Colorado.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p      &lt;- c(0.1, 0.4, .01, .3, 100, .5)
h      &lt;- 10^seq(-2, 6.8, length = 197)
shyp.L &lt;- shypFun.04110(p, h)
</code></pre>

<hr>
<h2 id='sncFun'>Non-capillary Saturation Function to Extend Other Functions</h2><span id='topic+sncFun'></span>

<h3>Description</h3>

<p>The general purpose method to calculate numerically the effective non-capillary saturation is directly obtained from any arbritrary expression for the 
rescaled capillary saturation function as described by (Weber et al. 2019). Examples of capillary saturation functions are the well known (van
Genuchten 1980), (Kosugi 1996), (Fredlund and Xing 1994) functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sncFun(h, scap)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sncFun_+3A_h">h</code></td>
<td>
<p>A vector of <code>n</code> pressure head values for which <code>scap</code> was calculated</p>
</td></tr>
<tr><td><code id="sncFun_+3A_scap">scap</code></td>
<td>
<p>vector of <code>n</code> monotonically decreasing capillary saturation function values calculated by <code>shypFun</code>, rescaled between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of <code>n</code> elements with calculated saturation content of the non-capillary part.
</p>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>References</h3>

<p>van
Genuchten MT (1980).
&ldquo;Closed-form equation for predicting the hydraulic conductivity of unsaturated soils.&rdquo;
<em>Soil Science Society of America Journal</em>, <b>44</b>(5), 892&ndash;898.
ISSN 03615995 (ISSN).<br />
Kosugi K (1996).
&ldquo;Lognormal distribution model for unsaturated soil hydraulic properties.&rdquo;
<em>Water Resources Research</em>, <b>32</b>(9), 2697&ndash;2703.
ISSN 0043-1397.<br />
Fredlund DG, Xing A (1994).
&ldquo;Equations for the soil-water characteristic curve.&rdquo;
<em>Canadian Geotechnical Journal</em>, <b>31</b>(4), 521&ndash;532.
ISSN 00083674 (ISSN), doi: <a href="https://doi.org/10.1139/t94-061">10.1139/t94-061</a>.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># set variables
p &lt;- c(0.1, 0.4, 0.01, 2, 100, .5)
h &lt;- 10^seq(-2, 6.8, length = 197)

# Calculate the capillary and non-capillary saturation function.
Se &lt;- shypFun(p, h, shpmodel = "01110")$Se     
Snc &lt;- sncFun(Se)

</code></pre>

<hr>
<h2 id='sncFun.01110'>Unimodal van Genuchten Non-Capillary Saturation Model</h2><span id='topic+sncFun.01110'></span>

<h3>Description</h3>

<p>Analytical implementation of the non-capillary saturation function (van
Genuchten 1980).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sncFun.01110(p_snc, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sncFun.01110_+3A_p_snc">p_snc</code></td>
<td>
<p>vector of the 2 van Genuchten Mualem model and h0, the order is sensitve and has to be given as:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>alf1</code></td><td style="text-align: left;">van Genuchten alpha [cm-3]</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>n1</code></td><td style="text-align: left;">van Genuchten n [-]</td>
</tr>
<tr>
 <td style="text-align: left;">
   <code>h0</code></td><td style="text-align: left;">pressure head representing oven dryness given in pF, i.e. log[10](|pressure head| [cm])</td>
</tr>
<tr>
 <td style="text-align: left;">
         </td>
</tr>

</table>
</td></tr>
<tr><td><code id="sncFun.01110_+3A_h">h</code></td>
<td>
<p>pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is Eq. Table 1-C1 in insertRefStreck.2020spsh using eq 21 which can be used
to accelerate the convergence of the sum.
The analytical solution presented in <code>sncFun.01110</code> only requires the Brooks-Corey model parameters
</p>


<h3>Value</h3>

<p>returns a <code>list</code> with calculations at specified <code>h</code>:
</p>
<table>
<tr><td><code>snc</code></td>
<td>
<p>non-capillary saturation</p>
</td></tr>
</table>


<h3>References</h3>

<p>van
Genuchten MT (1980).
&ldquo;Closed-form equation for predicting the hydraulic conductivity of unsaturated soils.&rdquo;
<em>Soil Science Society of America Journal</em>, <b>44</b>(5), 892&ndash;898.
ISSN 03615995 (ISSN).
Weber TK, Durner W, Streck T, Diamantopoulos E (2019).
&ldquo;A modular framework for modelling unsaturated soil hydraulic properties over the full moisture range.&rdquo;
<em>Water Resources Research</em>.
ISSN 0043-1397, doi: <a href="https://doi.org/10.1029/2018WR024584">10.1029/2018WR024584</a>.
Streck T, Weber TKD (2020).
&ldquo;Analytical expressions for noncapillary soil water retention based on popular capillary retention models, accepted.&rdquo;
<em>Vadose Zone Journal</em>.
ISSN 15391663 (ISSN).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p      &lt;- c(0.1, 0.4, .01, 2, 100, .5)
# add h0
p_snc  &lt;- c(p[3:4], 6.8)
h      &lt;- 10^seq(-2, 6.8, length = 197)
Se     &lt;- shypFun.01110(p, h)$Se
snc    &lt;- sncFun.01110(p_snc, h)
</code></pre>

<hr>
<h2 id='sncFun.02110'>Unimodal Kosugi Non-Capillary Saturation Model</h2><span id='topic+sncFun.02110'></span>

<h3>Description</h3>

<p>Analytical implementation of the non-capillary saturation function for the (Kosugi 1996).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sncFun.02110(p_snc, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sncFun.02110_+3A_p_snc">p_snc</code></td>
<td>
<p>vector of the 2 Kosugi saturation model parameters, and h0 sensitve and has to be given as:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>hm</code></td><td style="text-align: left;">air entry pressure head [cm]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>sigma</code></td><td style="text-align: left;">width of pore size distribution [ - ]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>h0</code></td><td style="text-align: left;">pressure head representing oven dryness given in pF, i.e. log[10](|pressure head| [cm])</td>
</tr>
<tr>
 <td style="text-align: left;">
         </td>
</tr>

</table>
</td></tr>
<tr><td><code id="sncFun.02110_+3A_h">h</code></td>
<td>
<p>pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is Eq. Table 1-B in insertRefStreck.2020spsh
The analytical solution presented in <code>sncFun.02110</code> only requires the Kosugi specific model parameters and <code>h0</code>
</p>


<h3>Value</h3>

<p>returns a <code>list</code> with calculations at specified <code>h</code>:
</p>
<table>
<tr><td><code>snc</code></td>
<td>
<p>non-capillary saturation</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kosugi K (1996).
&ldquo;Lognormal distribution model for unsaturated soil hydraulic properties.&rdquo;
<em>Water Resources Research</em>, <b>32</b>(9), 2697&ndash;2703.
ISSN 0043-1397.
Streck T, Weber TKD (2020).
&ldquo;Analytical expressions for noncapillary soil water retention based on popular capillary retention models, accepted.&rdquo;
<em>Vadose Zone Journal</em>.
ISSN 15391663 (ISSN).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p      &lt;- c(0.1, 0.4, 100, 2, 100, .5)
# add h0
p_snc  &lt;- c(p[3:4], 6.8)
h      &lt;- 10^seq(-2, 6.8, length = 197)
Se     &lt;- shypFun.02110(p, h)$Se
snc    &lt;- sncFun.02110(p_snc, h)
</code></pre>

<hr>
<h2 id='sncFun.04110'>Unimodal Brooks-Corey Non-Capillary Saturation Model</h2><span id='topic+sncFun.04110'></span>

<h3>Description</h3>

<p>Analytical implementation of the non-capillary saturation function from the Brooks-Corey function (Brooks and Corey 1964).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sncFun.04110(p_snc, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sncFun.04110_+3A_p_snc">p_snc</code></td>
<td>
<p>vector of the 2 Brooks-Corey model parameters, order is sensitve and has to be given as:
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>alf</code></td><td style="text-align: left;">air entry pressure head [cm^-1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>bet</code></td><td style="text-align: left;">effective model parameter [ - ]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>h0</code></td><td style="text-align: left;">pressure head representing oven dryness given in pF, i.e. log[10](|pressure head| [cm])</td>
</tr>
<tr>
 <td style="text-align: left;">
         </td>
</tr>

</table>
</td></tr>
<tr><td><code id="sncFun.04110_+3A_h">h</code></td>
<td>
<p>pressure heads [cm] for which the corresponding retention and conductivity values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is Eq. Table 1-A  in insertRefStreck.2020spsh
The analytical solution presented in <code>sncFun.04110</code> only requires the Brooks-Corey model specific parameters and <code>h0</code>.
</p>


<h3>Value</h3>

<p>returns a <code>list</code> with calculations at specified <code>h</code>:
</p>
<table>
<tr><td><code>snc</code></td>
<td>
<p>non-capillary saturation</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brooks RH, Corey AT (1964).
<em>Hydraulic Properties of Porous Media</em>.
Hydrology Papers No 3, Colorado State University, Fort Collings, Colorado.
Streck T, Weber TKD (2020).
&ldquo;Analytical expressions for noncapillary soil water retention based on popular capillary retention models, accepted.&rdquo;
<em>Vadose Zone Journal</em>.
ISSN 15391663 (ISSN).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p     &lt;- c(0.1, 0.4, .02, 2, 100, .5)
p_snc &lt;- c(p[3:4], 6.8)
h     &lt;- 10^seq(-2, 6.8, length = 197)
Se    &lt;- shypFun.04110(p, h)$Se
snc   &lt;- sncFun.04110(p_snc, h)
</code></pre>

<hr>
<h2 id='transBoundFun'>Creates Parameter Transformation and Backtransformation Rules for the Estimation Procedure</h2><span id='topic+transBoundFun'></span>

<h3>Description</h3>

<p>Creates Parameter Transformation and Backtransformation Rules for the Estimation Procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transBoundFun(parL, shpmodel, weightmethod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transBoundFun_+3A_parl">parL</code></td>
<td>
<p>a list with 4 numeric vectors specifying:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>p</code></td><td style="text-align: left;">Vector of model parameters, has to coincide with the chosen soil hydraulic property model. If <code>weightmethod == est1</code> then two additional nuisance parameters, need to be specified and concatenated to the vector of soil hydraulic property model parameters, a first, for THETA and a second for log10K)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>psel</code></td><td style="text-align: left;">vector identifying which parameters are to be estimatedmodel parameters, has to coincide with the chosen soil hydraulic property model</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>plo</code></td><td style="text-align: left;">vector of lower bounds (non-transformed parameter boundaries)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>pup</code></td><td style="text-align: left;">vector of upper bounds (non-transformed parameters boundaries)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="transBoundFun_+3A_shpmodel">shpmodel</code></td>
<td>
<p>A string specifying the selected soil hydraulic property model.</p>
</td></tr>
<tr><td><code id="transBoundFun_+3A_weightmethod">weightmethod</code></td>
<td>
<p>A string specifying the selected weigthing method, if weightmethod == &quot;est1&quot; is TRUE, then <code>parL</code> is modified to account for nuisance parameters).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended for the function <code>shypEstFun</code> so that lists with set rules for the transformation and back-transformation of the soil hydraulic model
parameters are enabled. In general, the following rules apply <code>log10</code> transformation for the model parameters <code class="reqn">\alpha_i</code>, <code>n_i-1</code>, <code>K_s</code>, <code>K_sc</code>, <code>K_snc</code>.
</p>
<p>The function is meant for internal use in <code>shypEstFun</code>.
</p>


<h3>Value</h3>

<p>a list of two lists. One of the sub-lists is <code>parL</code> but with transformed parameters, and the second, <code>transL</code> with model specific transformation and back-transformation rules.
</p>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
parL &lt;- list("p" = c("thr"= 0.05, "ths" = 0.45, "alf1" = 0.01, "n" = 2, "Ks" = 100, "tau" = .5),
            "psel" = c(1, 1, 0, 1, 1, 1),
            "plo" = c(0.001 , 0.2, 0.001, 1.1, 1, -2),
            "pup" = c(0.3, 0.95, 1, 10, 1e4, 10))

# transformation and back-transformation of parameter vectors
for(k in c("p", "plo", "pup")){
     for (j in c("none")){
           parL.trans &lt;- transBoundFun(parL, shpmodel = "01110", weightmethod = j)
           
           p_trans &lt;- transFun(parL[[k]], parL.trans$transL$ptrans)
           p_retrans &lt;- transFun(p_trans, parL.trans$transL$pretrans)
           
           stopifnot(sum(p_retrans != parL[[k]])==0)
     }
}


</code></pre>

<hr>
<h2 id='transFun'>Parameter Transformation and Back-transformation</h2><span id='topic+transFun'></span>

<h3>Description</h3>

<p>Enables the transformation and backtransformation of parameters. 
This is widely considered advantageous during parameter estimation as the parameter space in the transformed is well-behaved, e.g. with normally distributed posteriors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transFun(par.vec, trans.L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transFun_+3A_par.vec">par.vec</code></td>
<td>
<p>Vector of <code>n</code> model parameters.</p>
</td></tr>
<tr><td><code id="transFun_+3A_trans.l">trans.L</code></td>
<td>
<p>list of <code>n</code> transformation/backtransformation operators, transformation and backtransformatio rules have to be antonyms and position in vector has to coincide with that in <code>par.vec</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Transformation rules are:</p>
<p style="text-align: center;"><code class="reqn">log10 \alpha_i,log10 n_i-1,log10 Ks,log10 \omega,log10 Ksc, and log10 Ksnc</code>
</p>
<p>.
</p>


<h3>Value</h3>

<p>Returns transformed parameters as specificef by trans.L.
</p>


<h3>Note</h3>

<p>The function is used to transform the parameter space and enabling optimisation or MCMC sampling to be more efficient.
</p>


<h3>Author(s)</h3>

<p>Tobias KD Weber , <a href="mailto:tobias.weber@uni-hohenheim.de">tobias.weber@uni-hohenheim.de</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># van Genuchten-Mualem Model parameters
parL &lt;- list("p" = c("thr"= 0.05, "ths" = 0.45, "alf1" = 0.01, "n" = 2, "Ks" = 100, "tau" = .5),
             "psel" = c(1, 1, 0, 1, 1, 1),
             "plo" = c(0.001 , 0.2, 0.001, 1.1, 1, -2),
             "pup" = c(0.3, 0.95, 1, 10, 1e4, 10)
)
# Two lists, one with function to transform, the other to back-transform model parameters
ptransfit &lt;- c(function(x)x, function(x)x,log10,function(x)log10(x-1),log10, function(x)x)
pretransfit &lt;- c(function(x)x, function(x)x,function(x)10^x, 
                 function(x)10^x+1,function(x)10^x,function(x)x)
# Transform
p_trans &lt;- transFun(parL$p, ptransfit)

</code></pre>

<hr>
<h2 id='weightFun'>Specification of Weights for the Data Groups Retention Data and Conductivity Data.</h2><span id='topic+weightFun'></span>

<h3>Description</h3>

<p>Weights can be fixed to suggested standards, fixed by the user, or estimated as additional nuisance parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightFun(weightmethod = "fix1", retdata, condata, parL = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightFun_+3A_weightmethod">weightmethod</code></td>
<td>
<p>Character specifying the method of selecting model weights, cd Details.</p>
</td></tr>
<tr><td><code id="weightFun_+3A_retdata">retdata</code></td>
<td>
<p>A dataframe or matrix with 2 columns. The first with pressure head values in [cm] and the second with volumetric water contents in [cm cm-3].</p>
</td></tr>
<tr><td><code id="weightFun_+3A_condata">condata</code></td>
<td>
<p>A dataframe or matrix with 2 columns. The first with pressure head values in [cm] and the second with hydraulic conductivity values log10[cm d-1].</p>
</td></tr>
<tr><td><code id="weightFun_+3A_parl">parL</code></td>
<td>
<p>Defaults to <code>NA</code> has to be provided if <code>weightmethod == "est1"</code> . See Details of (<a href="#topic+shypEstFun">shypEstFun</a> for explanation of <code>parL</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Character specifying <code>weightmethod</code>
</p>

<table>
<tr>
 <td style="text-align: left;">
      <code>user</code></td><td style="text-align: left;">user defined weights</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>none</code></td><td style="text-align: left;">no weights are considered, i.e. no measurement error assumed</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>range</code></td><td style="text-align: left;">rescaling (normalization of observations to the intervall [0,1]</td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>fix1</code></td><td style="text-align: left;">fixed scalar weight for THETA is 0.05^2 and weight for log10K is 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>fix2</code></td><td style="text-align: left;">vector with the length of number of observations as given in <code>retdata</code> and <code>condata</code> are given, fixed to weight for THETA is 0.05^2 and weight for log10K is 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
      <code>est1</code></td><td style="text-align: left;">Two scalar model weights (sigma^-2) are treated as free parameters to be estimated by inversion, one for <code>THETA</code> and one for <code>log10K</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>If <code>weightmethod</code> is set to <code>est1</code> and <code>parL</code> is given as an extra argument, the function returns a list wich is concatenated to the <code>parL</code> used in <code>shypEstFun</code>
providing extra information on the nuisance parameters. Alternatively, <code>parL</code> can be passed as an argument to <code>shypEstFun</code> directly, accounting for the two additional nuisance parameters at the end of the respective vectors.
</p>


<h3>Value</h3>

<p>The function returns a <code>list</code> of <code>weights</code> as specified through <code>weightmethod</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1 | fixed weights
weight.fix.L &lt;- weightFun("fix1") 

# Example 2 | range of measure data
data(shpdata1)

wrc &lt;- shpdata1$TS1$wrc
hcc &lt;- shpdata1$TS1$hcc
# Remove NAs
hcc &lt;- shpdata1$TS1$hcc[!is.na(shpdata1$TS1$hcc[,1] ),]
weight.fix.L &lt;- weightFun("range", wrc, hcc) 

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
