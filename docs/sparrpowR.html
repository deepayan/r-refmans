<!DOCTYPE html><html><head><title>Help for package sparrpowR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sparrpowR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#jitter_power'><p>Power of SRR function for previously collected data.</p></a></li>
<li><a href='#pval_correct'><p>Calculate p-value corrections for multiple testing</p></a></li>
<li><a href='#sparrpowR-package'><p>The sparrpowR Package: Power Analysis to Detect Spatial Relative Risk Clusters</p></a></li>
<li><a href='#spatial_data'><p>Simulate random data for SRR function</p></a></li>
<li><a href='#spatial_plots'><p>Plots for statistical power estimates of the SRR function</p></a></li>
<li><a href='#spatial_power'><p>Power of SRR function for randomly generated data.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Power Analysis to Detect Spatial Relative Risk Clusters</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-23</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ian D. Buller &lt;ian.buller@alumni.emory.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate the statistical power to detect clusters using kernel-based 
        spatial relative risk functions that are estimated using the 'sparr' package.
        Details about the 'sparr' package methods can be found in the tutorial: Davies
        et al. (2018) &lt;<a href="https://doi.org/10.1002%2Fsim.7577">doi:10.1002/sim.7577</a>&gt;. Details about kernel density estimation 
        can be found in J. F. Bithell (1990) &lt;<a href="https://doi.org/10.1002%2Fsim.4780090616">doi:10.1002/sim.4780090616</a>&gt;. More 
        information about relative risk functions using kernel density estimation can 
        be found in J. F. Bithell (1991) &lt;<a href="https://doi.org/10.1002%2Fsim.4780101112">doi:10.1002/sim.4780101112</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (&ge; 2.0)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>doFuture, doRNG, fields, foreach, future, graphics, grDevices,
iterators, lifecycle, sparr, spatstat.geom, spatstat.random,
stats, terra</td>
</tr>
<tr>
<td>Suggests:</td>
<td>geojsonsf, ggmap, ggplot2, sf, spatstat.data, spelling,
testthat, tidyterra, R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/machiela-lab/sparrpowR">https://github.com/machiela-lab/sparrpowR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/machiela-lab/sparrpowR/issues">https://github.com/machiela-lab/sparrpowR/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-23 14:46:58 UTC; ian.buller</td>
</tr>
<tr>
<td>Author:</td>
<td>Ian D. Buller <a href="https://orcid.org/0000-0001-9477-8582"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Derek W. Brown <a href="https://orcid.org/0000-0001-8393-1713"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Mitchell J. Machiela
    <a href="https://orcid.org/0000-0001-6538-9705"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Timothy A. Myers [ctb],
  NCI [cph, fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-23 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='jitter_power'>Power of SRR function for previously collected data.</h2><span id='topic+jitter_power'></span>

<h3>Description</h3>

<p>Compute the statistical power of a spatial relative risk function using previously collected data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jitter_power(
  obs_data,
  sim_total = 2,
  samp_control = c("uniform", "CSR", "MVN"),
  s_control = 1,
  alpha = 0.05,
  p_correct = "none",
  parallel = FALSE,
  n_core = 2,
  verbose = TRUE,
  ...,
  cascon = lifecycle::deprecated(),
  lower_tail = lifecycle::deprecated(),
  upper_tail = lifecycle::deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jitter_power_+3A_obs_data">obs_data</code></td>
<td>
<p>A bivariate point pattern (a multitype point pattern of object of class &quot;ppp&quot;) with two types of points in a factor valued mark.</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_sim_total">sim_total</code></td>
<td>
<p>Integer, specifying the number of simulation iterations to perform.</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_samp_control">samp_control</code></td>
<td>
<p>Character string specifying whether to randomize the control locations uniformly (<code>samp_control="uniform"</code>), with complete spatial randomness (<code>samp_control="CSR"</code>), or multivariate normal (<code>samp_control="MVN"</code>).</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_s_control">s_control</code></td>
<td>
<p>Optional. Numeric value for the standard deviation of the multivariate normal distribution in the units of the <code>obs_data</code>. The default value (1) assumes a unit square window. Ignored if Ignored if <code>samp_control="uniform"</code> or <code>samp_control="CSR"</code>.</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_alpha">alpha</code></td>
<td>
<p>Optional. Numeric value of the critical p-value (default=0.05).</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_p_correct">p_correct</code></td>
<td>
<p>Optional. Character string specifying whether to apply a correction for multiple comparisons including a False Discovery Rate <code>p_correct = "FDR"</code>, a Sidak correction <code>p_correct = "uncorrelated Sidak"</code>, and a Bonferroni correction <code>p_correct = "uncorrelated Bonferroni"</code>. If <code>p_correct = "none"</code> (the default), then no correction is applied.</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_parallel">parallel</code></td>
<td>
<p>Logical. If TRUE, will execute the function in parallel. If FALSE (the default), will not execute the function in parallel.</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_n_core">n_core</code></td>
<td>
<p>Optional. Integer specifying the number of CPU cores on current host to use for parallelization (the default is 2 cores).</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If TRUE (the default), will print function progress during execution. If FALSE, will not print.</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="sparr.html#topic+risk">risk</a></code> to select bandwidth, edge correction, and resolution.</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_cascon">cascon</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> <code>cascon</code> is no longer supported and this function will output power for case-only and case/control clustering. This argument has been moved to <code>spatial_plots</code> function.</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_lower_tail">lower_tail</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> <code>lower_tail</code> is no longer supported; this function uses <code>alpha</code> to set the critical p-value.</p>
</td></tr>
<tr><td><code id="jitter_power_+3A_upper_tail">upper_tail</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> <code>upper_tail</code> is no longer supported; this function uses <code>alpha</code> to set the critical p-value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the statistical power of the spatial relative risk function (nonparametric estimate of relative risk by kernel smoothing) for previously collected studies with known case and control locations.
</p>
<p>The function uses the <code><a href="sparr.html#topic+risk">risk</a></code> function to estimate the spatial relative risk function and forces the <code>tolerate</code> argument to be TRUE in order to calculate asymptotic p-values.
</p>
<p>If <code>samp_control = "uniform"</code> the control locations are randomly generated uniformly within the dow of <code>obs_data</code>. By default, the resolution is an integer value of 128 and can be specified using the <code>resolution</code> argument in the internally called <code><a href="sparr.html#topic+risk">risk</a></code> function.
</p>
<p>If <code>samp_control = "CSR"</code> the control locations are randomly generated assuming complete spatial randomness (homogeneous Poisson process) within the dow of <code>obs_data</code> with a <code>lambda = number of controls / [resolution x resolution]</code>. By default, the resolution is an integer value of 128 and can be specified using the <code>resolution</code> argument in the internally called <code><a href="sparr.html#topic+risk">risk</a></code> function.
</p>
<p>If <code>samp_control = "MVN"</code> the control locations are randomly generated assuming a multivariate normal distribution <em>centered at each observed location</em>. The optional argument <code>s_control</code> specifies the standard deviation of the multivariate normal distribution (1 by default) in the units of the <code>obs_data</code>.
</p>
<p>The function computes a one-sided hypothesis test for case clustering (<code>alpha = 0.05</code> by default). The function also computes a two-sided hypothesis test for case clustering and control clustering (lower tail = 0.025 and upper tail = 0.975).
</p>
<p>The function has functionality for a correction for multiple testing. If <code>p_correct = "FDR"</code>, calculates a False Discovery Rate by Benjamini and Hochberg. If <code>p_correct = "Sidak"</code>, calculates a Sidak correction. If <code>p_correct = "Bonferroni"</code>, calculates a Bonferroni correction. If <code>p_correct = "none"</code> (the default), then the function does not account for multiple testing and uses the uncorrected <code>alpha</code> level. See the internal <code>pval_correct</code> function documentation for more details.
</p>


<h3>Value</h3>

<p>An object of class &quot;list&quot;. This is a named list with the following components:
</p>

<dl>
<dt><code>sim</code></dt><dd><p>An object of class 'rrs' for the first iteration of simulated data.</p>
</dd>
<dt><code>out</code></dt><dd><p>An object of class 'rrs' for the observed spatial relative risk function without randomization.</p>
</dd>
<dt><code>rr_mean</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the mean relative risk values at each gridded knot.</p>
</dd>
<dt><code>pval_mean</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the mean asymptotic p-value at each gridded knot.</p>
</dd>
<dt><code>rr_sd</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the standard deviation of relative risk values at each gridded knot.</p>
</dd>
<dt><code>pval_prop_cascon</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the proportion of asymptotic p-values that were significant for both case and control locations at each gridded knot.</p>
</dd>
<dt><code>pval_prop_cas</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the proportion of asymptotic p-values that were significant for only case locations at each gridded knot.</p>
</dd>
<dt><code>rx</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the x-coordinates of each gridded knot.</p>
</dd>
<dt><code>ry</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the y-coordinates of each gridded knot.</p>
</dd>
<dt><code>n_cas</code></dt><dd><p>Vector of length <code>sim_total</code> of the number of case locations simulated in each iteration.</p>
</dd>
<dt><code>n_con</code></dt><dd><p>Vector of length <code>sim_total</code> of the number of control locations simulated in each iteration.</p>
</dd>
<dt><code>bandw</code></dt><dd><p>Vector of length <code>sim_total</code> of the bandwidth (of numerator) used in each iteration.</p>
</dd>
<dt><code>s_obs</code></dt><dd><p>Vector of length <code>sim_total</code> of the global s statistic.</p>
</dd>
<dt><code>t_obs</code></dt><dd><p>Vector of length <code>sim_total</code> of the global t statistic.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>Vector of length <code>sim_total</code> of the (un)corrected critical p-values.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="sparr.html#topic+risk">risk</a></code> for additional arguments for bandwidth selection, edge correction, and resolution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using the 'chorley' data set from 'spatstat.data' package
 data(chorley, package="spatstat.data")
 f1 &lt;- jitter_power(obs_data = unique(chorley),
                    samp_control = "CSR",
                    verbose = FALSE)

</code></pre>

<hr>
<h2 id='pval_correct'>Calculate p-value corrections for multiple testing</h2><span id='topic+pval_correct'></span>

<h3>Description</h3>

<p>Internal function to calculate various p-value corrections for use within the <code><a href="#topic+spatial_power">spatial_power</a></code> and <code><a href="#topic+jitter_power">jitter_power</a></code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pval_correct(
  input,
  type = c("FDR", "Sidak", "Bonferroni"),
  alpha = 0.05,
  nbc = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pval_correct_+3A_input">input</code></td>
<td>
<p>An object of class 'rrs' from the <code><a href="#topic+spatial_power">spatial_power</a></code> or <code><a href="#topic+jitter_power">jitter_power</a></code> function.</p>
</td></tr>
<tr><td><code id="pval_correct_+3A_type">type</code></td>
<td>
<p>Character string specifying which correction for multiple comparisons. Options include a False Discovery Rate <code>p_correct = "FDR"</code>, a Sidak correction <code>p_correct = "Sidak"</code>, and a Bonferroni correction <code>p_correct = "Bonferroni"</code>.</p>
</td></tr>
<tr><td><code id="pval_correct_+3A_alpha">alpha</code></td>
<td>
<p>Numeric. The alpha level for significance threshold (default in <code><a href="#topic+spatial_power">spatial_power</a></code> and <code><a href="#topic+jitter_power">jitter_power</a></code> functions is 0.05).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides functionality for multiple testing correction in five ways:
</p>

<ol>
<li><p> Computes a False Discovery Rate by Benjamini and Hochberg <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">doi:10.1111/j.2517-6161.1995.tb02031.x</a> (<code>p_correct = "FDR"</code>) by: 1) sorting the p-values (p_i) of each knot in ascending order (p_1 &lt;= p_2 &lt;= ... &lt;= p_m), 2) starting from p_m find the first p_i for which p_i &lt;= (i/m) * alpha.
</p>
</li>
<li><p> Computes a Sidak correction <a href="https://doi.org/10.2307/2283989">doi:10.2307/2283989</a> (<code>p_correct = "Sidak"</code>) by 1 - (1 - <code>alpha</code>) ^ (1 / total number of gridded knots across the estimated surface). The default in the <code><a href="sparr.html#topic+risk">risk</a></code> function is a resolution of 128 x 128 or n = 16,384 knots and a custom resolution can be specified using the <code>resolution</code> argument within the <code><a href="sparr.html#topic+risk">risk</a></code> function.
</p>
</li>
<li><p> Computes a Bonferroni correction (<code>p_correct = "Bonferroni"</code>) by <code>alpha</code> / total number of gridded knots across the estimated surface. The default in the <code><a href="sparr.html#topic+risk">risk</a></code> function is a resolution of 128 x 128 or n = 16,384 knots and a custom resolution can be specified using the <code>resolution</code> argument within the <code><a href="sparr.html#topic+risk">risk</a></code> function.
</p>
</li></ol>



<h3>Value</h3>

<p>An object of class 'numeric' with the corrected alpha level.
</p>

<hr>
<h2 id='sparrpowR-package'>The sparrpowR Package: Power Analysis to Detect Spatial Relative Risk Clusters</h2><span id='topic+sparrpowR-package'></span><span id='topic+sparrpowR'></span>

<h3>Description</h3>

<p>Computes the statistical power for the spatial relative risk function.
</p>


<h3>Details</h3>

<p>For a two-group comparison (e.g., cases v. controls) the 'sparrpowR' package calculates the statistical power to detect clusters using the kernel-based spatial relative risk function that is estimated using the 'sparr' package. Details about the 'sparr' package methods can be found in the tutorial: Davies et al. (2018) <a href="https://doi.org/10.1002/sim.7577">doi:10.1002/sim.7577</a>. Details about kernel density estimation can be found in J. F. Bithell (1990) <a href="https://doi.org/10.1002/sim.4780090616">doi:10.1002/sim.4780090616</a>. More information about relative risk functions using kernel density estimation can be found in J. F. Bithell (1991) <a href="https://doi.org/10.1002/sim.4780101112">doi:10.1002/sim.4780101112</a>.
</p>
<p>This package provides a function to compute the statistical power for the spatial relative risk function with various theoretical spatial sampling strategies. The 'sparrpowR' package also provides a function to compute the statistical power for the spatial relative risk function for scenarios where one group (e.g., cases) have been observed and a theoretical sampling strategy for the second group (e.g., controls) is desired. The 'sparrpowR' package also provides visualization of data and statistical power.
</p>
<p>Key content of the 'sparrpowR' package include:<br />
</p>
<p><b>Theoretical Spatial Sampling</b>
</p>
<p><code><a href="#topic+spatial_data">spatial_data</a></code> Generates random two-group data for a spatial relative risk function.
</p>
<p><b>Statistical Power</b>
</p>
<p><code><a href="#topic+spatial_power">spatial_power</a></code> Computes the statistical power of a spatial relative risk function using randomly generated data.
</p>
<p><code><a href="#topic+jitter_power">jitter_power</a></code> Computes the statistical power of a spatial relative risk function using previously collected data.
</p>
<p><b>Data Visualization</b>
</p>
<p><code><a href="#topic+spatial_plots">spatial_plots</a></code> Visualizes multiple plots of output from <code><a href="#topic+spatial_data">spatial_data</a></code>, <code><a href="#topic+spatial_power">spatial_power</a></code> and <code><a href="#topic+jitter_power">jitter_power</a></code> functions.
</p>


<h3>Dependencies</h3>

<p>The 'sparrpowR' package relies heavily upon <code>sparr</code>, <code>spatstat.random</code>, <code>spatstat.geom</code>, and <code>terra</code> for computing the statistical power and visualizing the output. Computation can be performed in parallel using <code>doFuture</code>, <code><a href="future.html#topic+multisession">multisession</a></code>, <code>doRNG</code>, and <code><a href="foreach.html#topic+foreach">foreach</a></code>. Basic visualizations rely on the <code><a href="spatstat.geom.html#topic+plot.ppp">plot.ppp</a></code> and <code><a href="fields.html#topic+image.plot">image.plot</a></code> functions.
</p>


<h3>Author(s)</h3>

<p>Ian D. Buller<br /> <em>Social &amp; Scientific Systems, Inc., a division of DLH Corporation, Silver Spring, Maryland, USA (current); Occupational and Environmental Epidemiology Branch, Division of Cancer Epidemiology and Genetics, National Cancer Institute, National Institutes of Health, Rockville, Maryland, USA (original)</em><br />
</p>
<p>Maintainer: I.D.B. <a href="mailto:ian.buller@alumni.emory.edu.gov">ian.buller@alumni.emory.edu.gov</a>
</p>

<hr>
<h2 id='spatial_data'>Simulate random data for SRR function</h2><span id='topic+spatial_data'></span>

<h3>Description</h3>

<p>Generate random two-group data for a spatial relative risk function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatial_data(
  win = spatstat.geom::unit.square(),
  sim_total = 2,
  x_case,
  y_case,
  samp_case = c("uniform", "MVN", "CSR", "IPP"),
  samp_control = c("uniform", "systematic", "MVN", "CSR", "IPP", "clustered"),
  x_control = NULL,
  y_control = NULL,
  n_case = NULL,
  n_control = NULL,
  npc_control = NULL,
  r_case = NULL,
  r_control = NULL,
  s_case = NULL,
  s_control = NULL,
  l_case = NULL,
  l_control = NULL,
  e_control = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatial_data_+3A_win">win</code></td>
<td>
<p>Window in which to simulate the random data. An object of class &quot;owin&quot; or something acceptable to <code><a href="spatstat.geom.html#topic+as.owin">as.owin</a></code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_sim_total">sim_total</code></td>
<td>
<p>Integer, specifying the number of simulation iterations to perform.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_x_case">x_case</code></td>
<td>
<p>Numeric value, or numeric vector, of x-coordinate(s) of case cluster(s).</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_y_case">y_case</code></td>
<td>
<p>Numeric value, or numeric vector, of y-coordinate(s) of case cluster(s).</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_samp_case">samp_case</code></td>
<td>
<p>Character string specifying whether to randomize the case locations uniformly (<code>samp_control = "uniform"</code>), multivariate normal (<code>samp_control = "MVN"</code>), with complete spatial randomness (<code>samp_control = "CSR"</code>), or using the inhomogeneous Poisson process (<code>samp_control = "IPP"</code>) around each case centroid.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_samp_control">samp_control</code></td>
<td>
<p>Character string specifying whether to randomize the control locations uniformly (<code>samp_control = "uniform"</code>), systematically (<code>samp_control = "systematic"</code>), multivariate normal (<code>samp_control = "MVN"</code>), with complete spatial randomness (<code>samp_control = "CSR"</code>), using the inhomogeneous Poisson process (<code>samp_control = "IPP"</code>), or a realization of the Neyman-Scott cluster process (<code>samp_control = "clustered"</code>).</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_x_control">x_control</code></td>
<td>
<p>Numeric value, or numeric vector, of x-coordinate(s) of case cluster(s). Ignored if <code>samp_control != "MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_y_control">y_control</code></td>
<td>
<p>Numeric value, or numeric vector, of y-coordinate(s) of case cluster(s). Ignored if <code>samp_control != "MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_n_case">n_case</code></td>
<td>
<p>Numeric value, or numeric vector, of the sample size for case locations in each cluster.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_n_control">n_control</code></td>
<td>
<p>Numeric value, or numeric vector, of the sample size for control locations in each cluster.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_npc_control">npc_control</code></td>
<td>
<p>Optional. Numeric value of the number of clusters of control locations. Ignored if <code>samp_control != "clustered"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_r_case">r_case</code></td>
<td>
<p>Optional. Numeric value, or numeric vector, of radius (radii) of case cluster(s) in the units of <code>win</code>. Ignored if <code>samp_case = "MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_r_control">r_control</code></td>
<td>
<p>Optional. Numeric value, or numeric vector, of radius (radii) of control cluster(s) in the units of <code>win</code>. Ignored if <code>samp_control != "clustered"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_s_case">s_case</code></td>
<td>
<p>Optional. Numeric value, or numeric vector, for the standard deviation(s) of the multivariate normal distribution for case locations in the units of <code>win</code>. Ignored if <code>samp_control != "MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_s_control">s_control</code></td>
<td>
<p>Optional. Numeric value, or numeric vector, for the standard deviation(s) of the multivariate normal distribution for control locations in the units of <code>win</code>. Ignored if <code>samp_control != "MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_l_case">l_case</code></td>
<td>
<p>Optional. A single positive number, a vector of positive numbers, a function(x,y, ...), or a pixel image. Intensity of the Poisson process for case clusters. Ignored if <code>samp_control != "IPP"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_l_control">l_control</code></td>
<td>
<p>Optional. A single positive number, a vector of positive numbers, a function(x,y, ...), or a pixel image. Intensity of the Poisson process for control clusters. Ignored if <code>samp_control = "uniform"</code>, <code>samp_control = "systematic"</code>, <code>samp_control = "MVN"</code>, or <code>samp_control = "CSR"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_e_control">e_control</code></td>
<td>
<p>Optional. A single non-negative number for the size of the expansion of the simulation window for generating parent points. Ignored if <code>samp_control != "clustered"</code>.</p>
</td></tr>
<tr><td><code id="spatial_data_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="spatstat.random.html#topic+runifdisc">runifdisc</a></code>, <code><a href="spatstat.geom.html#topic+disc">disc</a></code>, <code><a href="spatstat.random.html#topic+rpoispp">rpoispp</a></code>, <code><a href="spatstat.geom.html#topic+rsyst">rsyst</a></code>, or <code><a href="spatstat.random.html#topic+rNeymanScott">rNeymanScott</a></code> depending on <code>samp_control</code> or <code>samp_control</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates random data for a spatial relative risk function (nonparametric estimate of relative risk by kernel smoothing) using various random point pattern generators from the <code>spatstat.random</code> package to generate data.
</p>
<p>If <code>samp_case = "uniform"</code> the case locations are randomly generated uniformly within a disc of radius <code>r_case</code> (or discs of radii <code>r_case</code>) centered at coordinates (<code>x_case</code>, <code>y_case</code>).
</p>
<p>If <code>samp_case = "MVN"</code> the case locations are randomly generated assuming a multivariate normal distribution centered at coordinates (<code>x_case</code>, <code>y_case</code>) with a standard deviation of <code>s_case</code>.
</p>
<p>If <code>samp_case = "CSR"</code> the case locations are randomly generated assuming complete spatial randomness (homogeneous Poisson process) within a disc of radius <code>r_case</code> (or discs of radii <code>r_case</code>) centered at coordinates (<code>x_case</code>, <code>y_case</code>) with <code>lambda = n_case / area of disc</code>.
</p>
<p>If <code>samp_case = "IPP"</code> the case locations are randomly generated assuming an inhomogeneous Poisson process with a disc of radius <code>r_case</code> (or discs of radii <code>r_case</code>) centered at coordinates (<code>x_case</code>, <code>y_case</code>) with <code>lambda = l_case</code>, a function.
</p>
<p>If <code>samp_control = "uniform"</code> the control locations are randomly generated uniformly within the window <code>win</code>.
</p>
<p>If <code>samp_control = "systematic"</code> the control locations are randomly generated systematically within the window <code>win</code> consisting of a grid of equally-spaced points with a random common displacement.
</p>
<p>If <code>samp_control = "MVN"</code> the control locations are randomly generated assuming a multivariate normal distribution centered at coordinates (<code>x_control</code>, <code>y_control</code>) with a standard deviation of <code>s_control</code>.
</p>
<p>If <code>samp_control = "CSR"</code> the control locations are randomly generated assuming complete spatial randomness (homogeneous Poisson process) within the window <code>win</code> with a <code>lambda = n_control / [resolution x resolution]</code>. By default, the resolution is an integer value of 128 and can be specified using the <code>resolution</code> argument in the internally called <code><a href="sparr.html#topic+risk">risk</a></code> function.
</p>
<p>If <code>samp_control = "IPP"</code> the control locations are randomly generated assuming an inhomogeneous Poisson process within the window <code>win</code> with a <code>lambda = l_control</code>, a function.
</p>
<p>If <code>samp_control = "clustered"</code> the control locations are randomly generated with a realization of the Neyman-Scott process within the window <code>win</code> with the intensity of the Poisson process cluster centres (<code>kappa = l_control</code>), the size of the expansion of the simulation window for generative parent points (<code>e_control</code>), and the radius (or radii) of the disc for each cluster (<code>r_control</code>).
</p>


<h3>Value</h3>

<p>An object of class &quot;ppplist&quot;. This is a list of marked point patterns that have a single mark with two levels: case and control.
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.random.html#topic+runifdisc">runifdisc</a></code>, <code><a href="spatstat.geom.html#topic+disc">disc</a></code>, <code><a href="spatstat.random.html#topic+rpoispp">rpoispp</a></code>, <code><a href="spatstat.geom.html#topic+rsyst">rsyst</a></code>, or <code><a href="spatstat.random.html#topic+rNeymanScott">rNeymanScott</a></code> for additional arguments for random point pattern generation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> spatial_data(x_case = c(0.25, 0.5, 0.75),
              y_case = c(0.75, 0.25, 0.75),
              samp_case = "MVN", 
              samp_control = "MVN",
              x_control = c(0.25, 0.5, 0.75),
              y_control = c(0.75, 0.25, 0.75),
              n_case = 100,
              n_control = c(100,500,300),
              s_case = c(0.05,0.01,0.05),
              s_control = 0.05,
              verbose = FALSE)
 

</code></pre>

<hr>
<h2 id='spatial_plots'>Plots for statistical power estimates of the SRR function</h2><span id='topic+spatial_plots'></span>

<h3>Description</h3>

<p>Create multiple plots of output from <code><a href="#topic+spatial_data">spatial_data</a></code>, <code><a href="#topic+spatial_power">spatial_power</a></code> and <code><a href="#topic+jitter_power">jitter_power</a></code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatial_plots(
  input,
  p_thresh = 0.8,
  cascon = FALSE,
  n_sim = 1,
  cols = c("#000000", "#CCCCCC", "#FF0000", "#0000FF"),
  chars = c(1, 1),
  sizes = c(1, 1),
  scale = 1,
  plot_pts = TRUE,
  plot_title = TRUE,
  plot_text = FALSE,
  plot_axes = FALSE,
  plot_square = FALSE,
  horizontal = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatial_plots_+3A_input">input</code></td>
<td>
<p>An object of class &quot;ppplist&quot; from the <code><a href="#topic+spatial_data">spatial_data</a></code> function or an object of class &quot;list&quot; from the <code><a href="#topic+spatial_power">spatial_power</a></code> or <code><a href="#topic+jitter_power">jitter_power</a></code> functions.</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_p_thresh">p_thresh</code></td>
<td>
<p>A numeric value between 0 and 1 (default = 0.8) for the power threshold.</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_cascon">cascon</code></td>
<td>
<p>Logical. If TRUE, displays the statistical power to detect case clusters and control clusters (two-tailed hypothesis). If FALSE (the default), displays the statistical power to detect case clusters only (one-tailed, lower-tail hypothesis).</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_n_sim">n_sim</code></td>
<td>
<p>Integer. The number of simulated iterations to plot. The default is one (1).</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_cols">cols</code></td>
<td>
<p>Character string of length four (4) specifying the colors for plotting: 1) insufficiently powered, 2) sufficiently powered, 3) case locations, 4) control locations. The default colors in hex are <code>c("#000000", "#CCCCCC", "#FF0000", "#0000FF")</code> or <code>c("grey0", "grey80", "red", "blue")</code>.</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_chars">chars</code></td>
<td>
<p>Vector of integers or character string of length two (2) for symbols of case and control locations. Default is <code>c(1,1)</code>.</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_sizes">sizes</code></td>
<td>
<p>Vector of integers of length two (2) for the size of the symbols for case and control locations. Default is <code>c(1,1)</code>.</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_scale">scale</code></td>
<td>
<p>Integer. A graphical expansion factor (default is 1) for text (and point) size within plots. Intended for scaling plot features with plot resolution.</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_plot_pts">plot_pts</code></td>
<td>
<p>Logical. If TRUE (the default), the points from the first simulation iteration will be added to second plot. Not if FALSE.</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_plot_title">plot_title</code></td>
<td>
<p>Logical. If TRUE (the default), a title will be included in the plot(s). Not if FALSE.</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_plot_text">plot_text</code></td>
<td>
<p>Logical. If TRUE, the local statistical power will be printed at each grid cell. Not if FALSE (the default).</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_plot_axes">plot_axes</code></td>
<td>
<p>Logical. If TRUE, the axes with labels will be included in the plot(s). Not if FALSE (the default).</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_plot_square">plot_square</code></td>
<td>
<p>Logical. If TRUE, the plot will have margins with similar units. Not if FALSE (the default).</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_horizontal">horizontal</code></td>
<td>
<p>Logical. If TRUE (the default), the color key will be displayed horizontally, below the plots. If FALSE, the color key will be displayed vertically, to the right of the plots.</p>
</td></tr>
<tr><td><code id="spatial_plots_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="spatstat.geom.html#topic+plot.ppp">plot.ppp</a></code> and <code><a href="fields.html#topic+image.plot">image.plot</a></code> for additional graphical features.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function produces up to three plots: 1) example input, 2) local power, and 3) local power above a threshold if the input is from the <code><a href="#topic+spatial_power">spatial_power</a></code> r <code><a href="#topic+jitter_power">jitter_power</a></code> functions. If the input is from the <code><a href="#topic+spatial_data">spatial_data</a></code> function, this function will only display the first plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # run spatial_power(), jitter_power(), or spatial_data()
 sim_power &lt;- spatial_power(x_case = c(0.25, 0.5, 0.75),
                            y_case = c(0.75, 0.25, 0.75),
                            samp_case = "MVN", 
                            samp_control = "MVN",
                            x_control = c(0.25, 0.5, 0.75),
                            y_control = c(0.75, 0.25, 0.75),
                            n_case = 100,
                            n_control = c(100,500,300),
                            s_case = c(0.05,0.01,0.05),
                            s_control = 0.05,
                            verbose = FALSE)
               
 # run spatial_plots()
 spatial_plots(input = sim_power)


</code></pre>

<hr>
<h2 id='spatial_power'>Power of SRR function for randomly generated data.</h2><span id='topic+spatial_power'></span>

<h3>Description</h3>

<p>Compute the statistical power of a spatial relative risk function using randomly generated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatial_power(
  win = spatstat.geom::unit.square(),
  sim_total = 2,
  x_case,
  y_case,
  samp_case = c("uniform", "MVN", "CSR", "IPP"),
  samp_control = c("uniform", "systematic", "MVN", "CSR", "IPP", "clustered"),
  x_control = NULL,
  y_control = NULL,
  n_case = NULL,
  n_control = NULL,
  npc_control = NULL,
  r_case = NULL,
  r_control = NULL,
  s_case = NULL,
  s_control = NULL,
  l_case = NULL,
  l_control = NULL,
  e_control = NULL,
  alpha = 0.05,
  p_correct = "none",
  verbose = TRUE,
  parallel = FALSE,
  n_core = 2,
  ...,
  cascon = lifecycle::deprecated(),
  lower_tail = lifecycle::deprecated(),
  upper_tail = lifecycle::deprecated()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatial_power_+3A_win">win</code></td>
<td>
<p>Window in which to simulate the random data. An object of class &quot;owin&quot; or something acceptable to <code><a href="spatstat.geom.html#topic+as.owin">as.owin</a></code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_sim_total">sim_total</code></td>
<td>
<p>Integer, specifying the number of simulation iterations to perform.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_x_case">x_case</code></td>
<td>
<p>Numeric value, or numeric vector, of x-coordinate(s) of case cluster(s).</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_y_case">y_case</code></td>
<td>
<p>Numeric value, or numeric vector, of y-coordinate(s) of case cluster(s).</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_samp_case">samp_case</code></td>
<td>
<p>Character string specifying whether to randomize the case locations uniformly (<code>samp_control="uniform"</code>), multivariate normal (<code>samp_control="MVN"</code>), with complete spatial randomness (<code>samp_control="CSR"</code>), or using the inhomogeneous Poisson process (<code>samp_control="IPP"</code>) around each case centroid.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_samp_control">samp_control</code></td>
<td>
<p>Character string specifying whether to randomize the control locations uniformly (<code>samp_control="uniform"</code>), systematically (<code>samp_control="systematic"</code>), multivariate normal (<code>samp_control="MVN"</code>), with complete spatial randomness (<code>samp_control="CSR"</code>), using the inhomogeneous Poisson process (<code>samp_control="IPP"</code>), or a realization of the Neyman-Scott cluster process (<code>samp_control="clustered"</code>).</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_x_control">x_control</code></td>
<td>
<p>Numeric value, or numeric vector, of x-coordinate(s) of case cluster(s). Ignored if <code>samp_control!="MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_y_control">y_control</code></td>
<td>
<p>Numeric value, or numeric vector, of y-coordinate(s) of case cluster(s). Ignored if <code>samp_control!="MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_n_case">n_case</code></td>
<td>
<p>Numeric value, or numeric vector, of the sample size for case locations in each cluster.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_n_control">n_control</code></td>
<td>
<p>Numeric value, or numeric vector, of the sample size for control locations in each cluster.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_npc_control">npc_control</code></td>
<td>
<p>Optional. Numeric value of the number of clusters of control locations. Ignored if <code>samp_control!="clustered"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_r_case">r_case</code></td>
<td>
<p>Optional. Numeric value, or numeric vector, of radius (radii) of case cluster(s) in the units of <code>win</code>. Ignored if <code>samp_case="MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_r_control">r_control</code></td>
<td>
<p>Optional. Numeric value, or numeric vector, of radius (radii) of control cluster(s) in the units of <code>win</code>. Ignored if <code>samp_control!="clustered"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_s_case">s_case</code></td>
<td>
<p>Optional. Numeric value, or numeric vector, for the standard deviation(s) of the multivariate normal distribution for case locations in the units of <code>win</code>. Ignored if <code>samp_control!="MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_s_control">s_control</code></td>
<td>
<p>Optional. Numeric value, or numeric vector, for the standard deviation(s) of the multivariate normal distribution for control locations in the units of <code>win</code>. Ignored if <code>samp_control!="MVN"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_l_case">l_case</code></td>
<td>
<p>Optional. A single positive number, a vector of positive numbers, a function(x,y, ...), or a pixel image. Intensity of the Poisson process for case clusters. Ignored if <code>samp_control!="IPP"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_l_control">l_control</code></td>
<td>
<p>Optional. A single positive number, a vector of positive numbers, a function(x,y, ...), or a pixel image. Intensity of the Poisson process for control clusters. Ignored if <code>samp_control="uniform"</code>, <code>samp_control="systematic"</code>, <code>samp_control="MVN"</code>, or <code>samp_control="CSR"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_e_control">e_control</code></td>
<td>
<p>Optional. A single non-negative number for the size of the expansion of the simulation window for generating parent points. Ignored if <code>samp_control!="clustered"</code>.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_alpha">alpha</code></td>
<td>
<p>Optional. Numeric value of the critical p-value (default=0.05).</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_p_correct">p_correct</code></td>
<td>
<p>Optional. Character string specifying whether to apply a correction for multiple comparisons including a False Discovery Rate <code>p_correct = "FDR"</code>, a Sidak correction <code>p_correct = "uncorrelated Sidak"</code>, and a Bonferroni correction <code>p_correct = "uncorrelated Bonferroni"</code>. If <code>p_correct = "none"</code> (the default), then no correction is applied.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If TRUE (the default), will print function progress during execution. If FALSE, will not print.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_parallel">parallel</code></td>
<td>
<p>Logical. If TRUE, will execute the function in parallel. If FALSE (the default), will not execute the function in parallel.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_n_core">n_core</code></td>
<td>
<p>Optional. Integer specifying the number of CPU cores on current host to use for parallelization (the default is 2 cores).</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="spatstat.random.html#topic+runifdisc">runifdisc</a></code>, <code><a href="spatstat.geom.html#topic+disc">disc</a></code>, <code><a href="spatstat.random.html#topic+rpoispp">rpoispp</a></code>, <code><a href="spatstat.geom.html#topic+rsyst">rsyst</a></code>, or <code><a href="spatstat.random.html#topic+rNeymanScott">rNeymanScott</a></code> depending on <code>samp_control</code> or <code>samp_control</code>. Arguments also passed to <code><a href="sparr.html#topic+risk">risk</a></code> to select bandwidth, edge correction, and resolution.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_cascon">cascon</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> <code>cascon</code> is no longer supported and this function will output power for case-only and case/control clustering. This argument has been moved to <code>spatial_plots</code> function.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_lower_tail">lower_tail</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> <code>lower_tail</code> is no longer supported; this function uses <code>alpha</code> to set the critical p-value.</p>
</td></tr>
<tr><td><code id="spatial_power_+3A_upper_tail">upper_tail</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> <code>lupper_tail</code> is no longer supported; this function uses <code>alpha</code> to set the critical p-value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the statistical power of the spatial relative risk function (nonparametric estimate of relative risk by kernel smoothing) for randomly generated data using various random point pattern generators from the <code>spatstat.random</code> package.
</p>
<p>The function uses the <code><a href="sparr.html#topic+risk">risk</a></code> function to estimate the spatial relative risk function and forces the <code>tolerate</code> argument to be TRUE in order to calculate asymptotic p-values.
</p>
<p>If <code>samp_case = "uniform"</code> the case locations are randomly generated uniformly within a disc of radius <code>r_case</code> (or discs of radii <code>r_case</code>) centered at coordinates (<code>x_case</code>, <code>y_case</code>).
</p>
<p>If <code>samp_case = "MVN"</code> the case locations are randomly generated assuming a multivariate normal distribution centered at coordinates (<code>x_case</code>, <code>y_case</code>) with a standard deviation of <code>s_case</code>.
</p>
<p>If <code>samp_case = "CSR"</code> the case locations are randomly generated assuming complete spatial randomness (homogeneous Poisson process) within a disc of radius <code>r_case</code> (or discs of radii <code>r_case</code>) centered at coordinates (<code>x_case</code>, <code>y_case</code>) with <code>lambda = n_case / area of disc</code>.
</p>
<p>If <code>samp_case = "IPP"</code> the case locations are randomly generated assuming an inhomogeneous Poisson process with a disc of radius <code>r_case</code> (or discs of radii <code>r_case</code>) centered at coordinates (<code>x_case</code>, <code>y_case</code>) with <code>lambda = l_case</code>, a function.
</p>
<p>If <code>samp_control = "uniform"</code> the control locations are randomly generated uniformly within the window <code>win</code>.
</p>
<p>If <code>samp_control = "systematic"</code> the control locations are randomly generated systematically within the window <code>win</code> consisting of a grid of equally-spaced points with a random common displacement.
</p>
<p>If <code>samp_control = "MVN"</code> the control locations are randomly generated assuming a multivariate normal distribution centered at coordinates (<code>x_control</code>, <code>y_control</code>) with a standard deviation of <code>s_control</code>.
</p>
<p>If <code>samp_control = "CSR"</code> the control locations are randomly generated assuming complete spatial randomness (homogeneous Poisson process) within the window <code>win</code> with a <code>lambda = n_control / [resolution x resolution]</code> By default, the resolution is an integer value of 128 and can be specified using the <code>resolution</code> argument in the internally called <code><a href="sparr.html#topic+risk">risk</a></code> function.
</p>
<p>If <code>samp_control = "IPP"</code> the control locations are randomly generated assuming an inhomogeneous Poisson process within the window <code>win</code> with a <code>lambda = l_control</code>, a function.
</p>
<p>If <code>samp_control = "clustered"</code> the control locations are randomly generated with a realization of the Neyman-Scott process within the window <code>win</code> with the intensity of the Poisson process cluster centres (<code>kappa = l_control</code>), the size of the expansion of the simulation window for generative parent points (<code>e_control</code>), and the radius (or radii) of the disc for each cluster (<code>r_control</code>).
</p>
<p>The function computes a one-sided hypothesis test for case clustering (<code>alpha = 0.05</code> by default). The function also computes a two-sided hypothesis test for case clustering and control clustering (lower tail = 0.025 and upper tail = 0.975).
</p>
<p>The function has functionality for a correction for multiple testing. If <code>p_correct = "FDR"</code>, calculates a False Discovery Rate by Benjamini and Hochberg. If <code>p_correct = "Sidak"</code>, calculates a Sidak correction. If <code>p_correct = "Bonferroni"</code>, calculates a Bonferroni correction. If <code>p_correct = "none"</code> (the default), then the function does not account for multiple testing and uses the uncorrected <code>alpha</code> level. See the internal <code>pval_correct</code> function documentation for more details.
</p>


<h3>Value</h3>

<p>An object of class &quot;list&quot;. This is a named list with the following components:
</p>

<dl>
<dt><code>sim</code></dt><dd><p>An object of class 'rrs' for the first iteration of simulated data.</p>
</dd>
<dt><code>out</code></dt><dd><p>An object of class 'rrs' for the observed spatial relative risk function without randomization.</p>
</dd>
<dt><code>rr_mean</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the mean relative risk values at each gridded knot.</p>
</dd>
<dt><code>pval_mean</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the mean asymptotic p-value at each gridded knot.</p>
</dd>
<dt><code>rr_sd</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the standard deviation of relative risk values at each gridded knot.</p>
</dd>
<dt><code>pval_prop_cascon</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the proportion of asymptotic p-values that were significant for both case and control locations at each gridded knot.</p>
</dd>
<dt><code>pval_prop_cas</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the proportion of asymptotic p-values that were significant for only case locations at each gridded knot.</p>
</dd>
<dt><code>rx</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the x-coordinates of each gridded knot.</p>
</dd>
<dt><code>ry</code></dt><dd><p>Vector of length <code>[resolution x resolution]</code> of the y-coordinates of each gridded knot.</p>
</dd>
<dt><code>n_cas</code></dt><dd><p>Vector of length <code>sim_total</code> of the number of case locations simulated in each iteration.</p>
</dd>
<dt><code>n_con</code></dt><dd><p>Vector of length <code>sim_total</code> of the number of control locations simulated in each iteration.</p>
</dd>
<dt><code>bandw</code></dt><dd><p>Vector of length <code>sim_total</code> of the bandwidth (of numerator) used in each iteration.</p>
</dd>
<dt><code>s_obs</code></dt><dd><p>Vector of length <code>sim_total</code> of the global s statistic.</p>
</dd>
<dt><code>t_obs</code></dt><dd><p>Vector of length <code>sim_total</code> of the global t statistic.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>Vector of length <code>sim_total</code> of the (un)corrected critical p-values.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'> spatial_power(x_case = c(0.25, 0.5, 0.75),
               y_case = c(0.75, 0.25, 0.75),
               samp_case = "MVN", 
               samp_control = "MVN",
               x_control = c(0.25, 0.5, 0.75),
               y_control = c(0.75, 0.25, 0.75),
               n_case = 100,
               n_control = c(100,500,300),
               s_case = c(0.05,0.01,0.05),
               s_control = 0.05,
               verbose = FALSE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
