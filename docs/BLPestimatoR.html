<!DOCTYPE html><html lang="en"><head><title>Help for package BLPestimatoR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BLPestimatoR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BLP_data'><p>Prepares data and parameters related to the BLP algorithm for estimation.</p></a></li>
<li><a href='#demographicData_cereal'><p>Draws for observed heterogeneity in Nevo's cereal example.</p></a></li>
<li><a href='#dstddelta_wrap'><p>Calculates derivatives of all shares with respect to all mean utilities in a given market.</p></a></li>
<li><a href='#dstdtheta_wrap'><p>Calculates derivatives of all shares with respect to all non-linear parameters in a given market.</p></a></li>
<li><a href='#dummies_cars'><p>Ownership matrix in BLP's car example.</p></a></li>
<li><a href='#estimateBLP'><p>Performs a BLP demand estimation.</p></a></li>
<li><a href='#get_elasticities'><p>Calculates elasticities for a given variable and market.</p></a></li>
<li><a href='#getDelta_wrap'><p>Performs a contration mapping for a given set of non-linear parameters.</p></a></li>
<li><a href='#getJacobian_wrap'><p>Calculating the Jacobian for a given set of non-linear parameters and mean utilities.</p></a></li>
<li><a href='#getShareInfo'><p>Calculates information related to predicted shares for a given set of non-linear parameters and data.</p></a></li>
<li><a href='#gmm_obj_wrap'><p>Calculating the GMM objective for a given set of non-linear parameters.</p></a></li>
<li><a href='#originalDraws_cereal'><p>Draws for unobserved heterogeneity in Nevo's cereal example.</p></a></li>
<li><a href='#productData_cars'><p>Product data of BLP's car example.</p></a></li>
<li><a href='#productData_cereal'><p>Product data of Nevo's cereal example.</p></a></li>
<li><a href='#simulate_BLP_dataset'><p>This function creates a simulated BLP dataset.</p></a></li>
<li><a href='#theta_guesses_cereal'><p>Parameter starting guesses for Nevo's cereal example.</p></a></li>
<li><a href='#update_BLP_data'><p>Updates the set of linear, exogenous, random coefficient, share or mean utility variable in the data object.</p></a></li>
<li><a href='#w_guesses_cereal'><p>Mean utility starting guesses for Nevo's cereal example.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Performs a BLP Demand Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.4</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Brunner (aut), Constantin Weiser (ctr), Andre Romahn (ctr)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Brunner &lt;daniel.brunner@hhu.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the estimation algorithm to perform the demand estimation described in Berry, Levinsohn and Pakes (1995) &lt;<a href="https://doi.org/10.2307%2F2171802">doi:10.2307/2171802</a>&gt; . The routine uses analytic gradients and offers a large number of implemented integration methods and optimization routines.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.9), mvQuad, numDeriv, randtoolbox, Formula, stats
, Matrix, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-03 15:26:36 UTC; brunned</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-03 15:52:31 UTC</td>
</tr>
</table>
<hr>
<h2 id='BLP_data'>Prepares data and parameters related to the BLP algorithm for estimation.</h2><span id='topic+BLP_data'></span>

<h3>Description</h3>

<p>Prepares data and parameters related to the BLP algorithm for estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BLP_data(
  model,
  market_identifier,
  product_identifier,
  par_delta,
  group_structure = NULL,
  additional_variables = NULL,
  productData,
  demographic_draws,
  integration_accuracy,
  integration_method,
  integration_draws,
  integration_weights,
  integration_seed,
  blp_inner_tol = 1e-09,
  blp_inner_maxit = 10000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BLP_data_+3A_model">model</code></td>
<td>
<p>the model to be estimated in R's formula syntax,</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_market_identifier">market_identifier</code></td>
<td>
<p>character specifying the market identifier (variable name must be included in <code>productData</code>),</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_product_identifier">product_identifier</code></td>
<td>
<p>character specifying the product identifier (variable name must be included in <code>productData</code>),</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_par_delta">par_delta</code></td>
<td>
<p>optional: numeric vector with values for the mean utility (variable name must be included in <code>productData</code>),</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_group_structure">group_structure</code></td>
<td>
<p>optional: character specifying a group structure for clustered standard erros (variable name must be included in <code>productData</code>),</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_additional_variables">additional_variables</code></td>
<td>
<p>optional: character vector specifying variables you want to keep for later analysis (variable names must be included in <code>productData</code>)</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_productdata">productData</code></td>
<td>
<p>data.frame with product characteristics,</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_demographic_draws">demographic_draws</code></td>
<td>
<p>optional: list with demographic draws for each market to consider observed heterogeneity (see details),</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_integration_accuracy">integration_accuracy</code></td>
<td>
<p>integer specifying integration accuracy,</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_integration_method">integration_method</code></td>
<td>
<p>character specifying integration method,</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_integration_draws">integration_draws</code></td>
<td>
<p>numeric matrix of manually provided integration draws (see details),</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_integration_weights">integration_weights</code></td>
<td>
<p>numeric vector of manually provided integration weights,</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_integration_seed">integration_seed</code></td>
<td>
<p>seed for the draws of Monte Carlo based integration,</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_blp_inner_tol">blp_inner_tol</code></td>
<td>
<p>tolerance for the contraction mapping (default: 1e-9),</p>
</td></tr>
<tr><td><code id="BLP_data_+3A_blp_inner_maxit">blp_inner_maxit</code></td>
<td>
<p>maximum iterations for the contraction mapping (default: 10000)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For any form of user provided integration draws, i.e. <code>integration_draws</code> (unobserved heterogeneity)
or <code>demographic_draws</code> (observed heterogeneity), list entries must be named and contain the variable <code>market_identifier</code> to allow market matching.
Each line in these list entries contains the draws for one market.
In case of unobserved heterogeneity, list names must match the random coefficients from the model formula.
The <code>par_delta</code> argument provides the variable name for mean utilitys. For example, in the estimation algorithm these values are used as starting guesses in the contraction mapping.
Another example is the evaluation of the GMM, which is also based on the provided mean utilitys.
If you need to update <code>par_delta</code> or any other variable in the data object, use <code>update_BLP_data</code>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>blp_data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

</code></pre>

<hr>
<h2 id='demographicData_cereal'>Draws for observed heterogeneity in Nevo's cereal example.</h2><span id='topic+demographicData_cereal'></span>

<h3>Description</h3>

<p>Draws for observed heterogeneity in Nevo's cereal example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demographicData_cereal
</code></pre>


<h3>Format</h3>

<p>Draws for observed heterogeneity for each demographic.
</p>

<dl>
<dt>cdid</dt><dd><p>market identifier,</p>
</dd>
<dt>draws_</dt><dd><p>20 draws differing across markets.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0">https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0</a>
</p>

<hr>
<h2 id='dstddelta_wrap'>Calculates derivatives of all shares with respect to all mean utilities in a given market.</h2><span id='topic+dstddelta_wrap'></span>

<h3>Description</h3>

<p>Calculates derivatives of all shares with respect to all mean utilities in a given market.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dstddelta_wrap(blp_data, par_theta2, market, printLevel = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dstddelta_wrap_+3A_blp_data">blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code>,</p>
</td></tr>
<tr><td><code id="dstddelta_wrap_+3A_par_theta2">par_theta2</code></td>
<td>
<p>matrix with column and rownames providing a starting value for the optimization routine (see details),</p>
</td></tr>
<tr><td><code id="dstddelta_wrap_+3A_market">market</code></td>
<td>
<p>character specifying the market in which derivatives are calculated,</p>
</td></tr>
<tr><td><code id="dstddelta_wrap_+3A_printlevel">printLevel</code></td>
<td>
<p>level of output information (default = 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NA's in <code>par_theta2</code> entries indicate the exclusion from estimation, i.e. the coefficient is assumed to be zero.
If only unobserved heterogeneity is used (no demographics), the column name of <code>par_theta2</code> must be &quot;unobs_sd&quot;.
With demographics the colnames must match the names of provided demographics (as in <code>demographic_draws</code>) and &quot;unobs_sd&quot;.
Row names of <code>par_theta2</code> must match random coefficients as specified in <code>model</code>. Constants must be named &quot;(Intercept)&quot;.
</p>


<h3>Value</h3>

<p>Returns a numeric matrix with derivatives.
Cell in row i and col j is the derivative of share i with respect to mean utility j.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

theta2 &lt;- matrix(c(0.5,2), nrow=2)
rownames(theta2) &lt;- c("x1","x2")
colnames(theta2) &lt;- "unobs_sd"

derivatives2 &lt;- dstddelta_wrap(  blp_data=blp_data,
                                  par_theta2 = theta2,
                                 market = 2)
</code></pre>

<hr>
<h2 id='dstdtheta_wrap'>Calculates derivatives of all shares with respect to all non-linear parameters in a given market.</h2><span id='topic+dstdtheta_wrap'></span>

<h3>Description</h3>

<p>Calculates derivatives of all shares with respect to all non-linear parameters in a given market.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dstdtheta_wrap(blp_data, par_theta2, market, printLevel = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dstdtheta_wrap_+3A_blp_data">blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code>,</p>
</td></tr>
<tr><td><code id="dstdtheta_wrap_+3A_par_theta2">par_theta2</code></td>
<td>
<p>matrix with column and rownames providing a starting value for the optimization routine (see details),</p>
</td></tr>
<tr><td><code id="dstdtheta_wrap_+3A_market">market</code></td>
<td>
<p>character specifying the market in which derivatives are calculated,</p>
</td></tr>
<tr><td><code id="dstdtheta_wrap_+3A_printlevel">printLevel</code></td>
<td>
<p>level of output information (default = 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NA's in <code>par_theta2</code> entries indicate the exclusion from estimation, i.e. the coefficient is assumed to be zero.
If only unobserved heterogeneity is used (no demographics), the column name of <code>par_theta2</code> must be &quot;unobs_sd&quot;.
With demographics the colnames must match the names of provided demographics (as in <code>demographic_draws</code>) and &quot;unobs_sd&quot;.
Row names of <code>par_theta2</code> must match random coefficients as specified in <code>model</code>. Constants must be named &quot;(Intercept)&quot;.
</p>


<h3>Value</h3>

<p>Returns a numeric matrix with derivatives.
Cell in row i and col j is the derivative of share i with respect to parameter j.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

theta2 &lt;- matrix(c(0.5,2), nrow=2)
rownames(theta2) &lt;- c("x1","x2")
colnames(theta2) &lt;- "unobs_sd"

derivatives1 &lt;- dstdtheta_wrap(  blp_data=blp_data,
                                  par_theta2 = theta2,
                                 market = 2)
</code></pre>

<hr>
<h2 id='dummies_cars'>Ownership matrix in BLP's car example.</h2><span id='topic+dummies_cars'></span>

<h3>Description</h3>

<p>Ownership matrix in BLP's car example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dummies_cars
</code></pre>


<h3>Format</h3>

<p>Dummy variables.
</p>

<dl>
<dt>column i</dt><dd><p>1, if product in row j is produced by firm i, 0 otherwise</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0">https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0</a>
</p>

<hr>
<h2 id='estimateBLP'>Performs a BLP demand estimation.</h2><span id='topic+estimateBLP'></span>

<h3>Description</h3>

<p>Performs a BLP demand estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateBLP(
  blp_data,
  par_theta2,
  solver_method = "BFGS",
  solver_maxit = 10000,
  solver_reltol = 1e-06,
  standardError = "heteroskedastic",
  extremumCheck = FALSE,
  printLevel = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimateBLP_+3A_blp_data">blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code>,</p>
</td></tr>
<tr><td><code id="estimateBLP_+3A_par_theta2">par_theta2</code></td>
<td>
<p>matrix with column and rownames providing a starting value for the optimization routine (see details),</p>
</td></tr>
<tr><td><code id="estimateBLP_+3A_solver_method">solver_method</code></td>
<td>
<p>character specifying the solver method in <code>optim</code> (further arguments can be passed to <code>optim</code> by ...)</p>
</td></tr>
<tr><td><code id="estimateBLP_+3A_solver_maxit">solver_maxit</code></td>
<td>
<p>integer specifying maximum iterations for the optimization routine (default=10000),</p>
</td></tr>
<tr><td><code id="estimateBLP_+3A_solver_reltol">solver_reltol</code></td>
<td>
<p>integer specifying tolerance for the optimization routine (default= 1e-6),</p>
</td></tr>
<tr><td><code id="estimateBLP_+3A_standarderror">standardError</code></td>
<td>
<p>character specifying assumptions about the GMM residual (homoskedastic , heteroskedastic (default), or cluster)</p>
</td></tr>
<tr><td><code id="estimateBLP_+3A_extremumcheck">extremumCheck</code></td>
<td>
<p>if <code>TRUE</code>, second derivatives are checked for the existence of minimum at the point estimate (default = FALSE),</p>
</td></tr>
<tr><td><code id="estimateBLP_+3A_printlevel">printLevel</code></td>
<td>
<p>level of output information ranges from 0 (no GMM results) to 4 (every norm in the contraction mapping)</p>
</td></tr>
<tr><td><code id="estimateBLP_+3A_...">...</code></td>
<td>
<p>additional arguments for <code>optim</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>NA's in <code>par_theta2</code> entries indicate the exclusion from estimation, i.e. the coefficient is assumed to be zero.
If only unobserved heterogeneity is used (no demographics), the column name of <code>par_theta2</code> must be &quot;unobs_sd&quot;.
With demographics the colnames must match the names of provided demographics (as in <code>demographic_draws</code>) and &quot;unobs_sd&quot;.
Row names of <code>par_theta2</code> must match random coefficients as specified in <code>model</code>. Constants must be named &quot;(Intercept)&quot;.
</p>


<h3>Value</h3>

<p>Returns an object of class &quot;blp_est&quot;. This object contains, among others, all estimates for preference parameters and standard errors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

theta_guesses &lt;- matrix(c(0.5,2), nrow=2)
rownames(theta_guesses) &lt;- c("x1","x2")
colnames(theta_guesses) &lt;- "unobs_sd"

blp_est &lt;- estimateBLP(blp_data =blp_data,
                       par_theta2 = theta_guesses,
                       extremumCheck = FALSE ,
                       printLevel = 1 )
summary(blp_est)

</code></pre>

<hr>
<h2 id='get_elasticities'>Calculates elasticities for a given variable and market.</h2><span id='topic+get_elasticities'></span>

<h3>Description</h3>

<p>Calculates elasticities for a given variable and market.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_elasticities(
  blp_data,
  share_info,
  theta_lin,
  variable,
  products,
  market,
  printLevel = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_elasticities_+3A_blp_data">blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code>,</p>
</td></tr>
<tr><td><code id="get_elasticities_+3A_share_info">share_info</code></td>
<td>
<p>object with individual and aggregated choice probabilities created by the function <code>getShareInfo</code>,</p>
</td></tr>
<tr><td><code id="get_elasticities_+3A_theta_lin">theta_lin</code></td>
<td>
<p>linear parameter of the variable for which elasticities are calculated for,</p>
</td></tr>
<tr><td><code id="get_elasticities_+3A_variable">variable</code></td>
<td>
<p>character specifying a variable for which elasticities are calculated for,</p>
</td></tr>
<tr><td><code id="get_elasticities_+3A_products">products</code></td>
<td>
<p>optional: character vector of specific products,</p>
</td></tr>
<tr><td><code id="get_elasticities_+3A_market">market</code></td>
<td>
<p>character specifying the market in which elasticities are calculated</p>
</td></tr>
<tr><td><code id="get_elasticities_+3A_printlevel">printLevel</code></td>
<td>
<p>level of output information (default = 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix with elasticities. Value in row j and col i for a variable x,
gives the effect of a change in product i's characteristic x on the share of product j.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                             Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                             Xexo = c("x1", "x2", "x3", "x4", "x5"),
                             Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                             true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                                    Xlin.true.price = -0.2,
                                                    Xrandom.true = rep(2,K),
                                                    instrument.effects = rep(2,10),
                                                    instrument.Xexo.effects = rep(1,5)),
                             price.endogeneity = list( mean.xi = -2,
                                                       mean.eita = 0,
                                                       cov = cbind( c(1,0.7), c(0.7,1))),
                             printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

theta_guesses &lt;- matrix(c(0.5,2), nrow=2)
rownames(theta_guesses) &lt;- c("x1","x2")
colnames(theta_guesses) &lt;- "unobs_sd"

shareObj &lt;- getShareInfo(  blp_data=blp_data,
                           par_theta2 = theta_guesses,
                           printLevel = 1)


get_elasticities(blp_data=blp_data,
                 share_info = shareObj ,
                 theta_lin = 1,
                 variable = "price",
                 products = c("4","20"),
                 market = 1)

</code></pre>

<hr>
<h2 id='getDelta_wrap'>Performs a contration mapping for a given set of non-linear parameters.</h2><span id='topic+getDelta_wrap'></span>

<h3>Description</h3>

<p>Performs a contration mapping for a given set of non-linear parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDelta_wrap(blp_data, par_theta2, printLevel = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDelta_wrap_+3A_blp_data">blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code>,</p>
</td></tr>
<tr><td><code id="getDelta_wrap_+3A_par_theta2">par_theta2</code></td>
<td>
<p>matrix with column and rownames providing a starting value for the optimization routine (see details),</p>
</td></tr>
<tr><td><code id="getDelta_wrap_+3A_printlevel">printLevel</code></td>
<td>
<p>level of output information (default = 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NA's in <code>par_theta2</code> entries indicate the exclusion from estimation, i.e. the coefficient is assumed to be zero.
If only unobserved heterogeneity is used (no demographics), the column name of <code>par_theta2</code> must be &quot;unobs_sd&quot;.
With demographics the colnames must match the names of provided demographics (as in <code>demographic_draws</code>) and &quot;unobs_sd&quot;.
Row names of <code>par_theta2</code> must match random coefficients as specified in <code>model</code>. Constants must be named &quot;(Intercept)&quot;.
</p>
<p>Starting guesses for the contraction mapping are provided with <code>BLP_data</code>.
</p>


<h3>Value</h3>

<p>Returns an object of class &quot;blp_cm&quot; with results from the contraction mapping.
</p>

<dl>
<dt><code>delta</code></dt><dd><p>resulting vector of mean utilities after the contraction mapping</p>
</dd>
<dt><code>counter</code></dt><dd><p>inner iterations needed to convergence</p>
</dd>
<dt><code>sij</code></dt><dd><p>market share integral evaluations for each product (in rows) for the final mean utility</p>
</dd> </dl>



<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

theta_guesses &lt;- matrix(c(0.5,2), nrow=2)
rownames(theta_guesses) &lt;- c("x1","x2")
colnames(theta_guesses) &lt;- "unobs_sd"

delta_eval &lt;- getDelta_wrap(  blp_data=blp_data,
                              par_theta2 = theta_guesses,
                              printLevel = 4)

</code></pre>

<hr>
<h2 id='getJacobian_wrap'>Calculating the Jacobian for a given set of non-linear parameters and mean utilities.</h2><span id='topic+getJacobian_wrap'></span>

<h3>Description</h3>

<p>Calculating the Jacobian for a given set of non-linear parameters and mean utilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getJacobian_wrap(blp_data, par_theta2, printLevel = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getJacobian_wrap_+3A_blp_data">blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code>,</p>
</td></tr>
<tr><td><code id="getJacobian_wrap_+3A_par_theta2">par_theta2</code></td>
<td>
<p>matrix with column and rownames providing the evaluation point (see details),</p>
</td></tr>
<tr><td><code id="getJacobian_wrap_+3A_printlevel">printLevel</code></td>
<td>
<p>level of output information (default = 1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NA's in <code>par_theta2</code> entries indicate the exclusion from estimation, i.e. the coefficient is assumed to be zero.
If only unobserved heterogeneity is used (no demographics), the column name of <code>par_theta2</code> must be &quot;unobs_sd&quot;.
With demographics the colnames must match the names of provided demographics (as in <code>demographic_draws</code>) and &quot;unobs_sd&quot;.
Row names of <code>par_theta2</code> must match random coefficients as specified in <code>model</code>. Constants must be named &quot;(Intercept)&quot;.
</p>


<h3>Value</h3>

<p>Returns a matrix with the jacobian (products in rows, parameters in columns).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

theta_guesses &lt;- matrix(c(0.5,2), nrow=2)
rownames(theta_guesses) &lt;- c("x1","x2")
colnames(theta_guesses) &lt;- "unobs_sd"

jacobian &lt;- getJacobian_wrap(blp_data=blp_data,
                             par_theta2 = theta_guesses,
                             printLevel = 2)
head(jacobian)
</code></pre>

<hr>
<h2 id='getShareInfo'>Calculates information related to predicted shares for a given set of non-linear parameters and data.</h2><span id='topic+getShareInfo'></span>

<h3>Description</h3>

<p>Calculates information related to predicted shares for a given set of non-linear parameters and data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getShareInfo(blp_data, par_theta2, printLevel = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getShareInfo_+3A_blp_data">blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code> (provides, among others, mean utilitys and integration draws),</p>
</td></tr>
<tr><td><code id="getShareInfo_+3A_par_theta2">par_theta2</code></td>
<td>
<p>matrix with column and rownames providing the evaluation point (see details),</p>
</td></tr>
<tr><td><code id="getShareInfo_+3A_printlevel">printLevel</code></td>
<td>
<p>level of output information (default = 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with information related to predicted shares.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )

model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

theta_guesses &lt;- matrix(c(0.5,2), nrow=2)
rownames(theta_guesses) &lt;- c("x1","x2")
colnames(theta_guesses) &lt;- "unobs_sd"

shares &lt;- getShareInfo(  blp_data=blp_data,
                           par_theta2 = theta_guesses,
                           printLevel = 4)

</code></pre>

<hr>
<h2 id='gmm_obj_wrap'>Calculating the GMM objective for a given set of non-linear parameters.</h2><span id='topic+gmm_obj_wrap'></span>

<h3>Description</h3>

<p>Calculating the GMM objective for a given set of non-linear parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmm_obj_wrap(blp_data, par_theta2, printLevel = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gmm_obj_wrap_+3A_blp_data">blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code>,</p>
</td></tr>
<tr><td><code id="gmm_obj_wrap_+3A_par_theta2">par_theta2</code></td>
<td>
<p>matrix with column and rownames providing a starting value for the optimization routine (see details),</p>
</td></tr>
<tr><td><code id="gmm_obj_wrap_+3A_printlevel">printLevel</code></td>
<td>
<p>level of output information ranges from 1 (no GMM results) to 4 (every norm in the contraction mapping)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>NA's in <code>par_theta2</code> entries indicate the exclusion from estimation, i.e. the coefficient is assumed to be zero.
If only unobserved heterogeneity is used (no demographics), the column name of <code>par_theta2</code> must be &quot;unobs_sd&quot;.
With demographics the colnames must match the names of provided demographics (as in <code>demographic_draws</code>) and &quot;unobs_sd&quot;.
Row names of <code>par_theta2</code> must match random coefficients as specified in <code>model</code>. Constants must be named &quot;(Intercept)&quot;.
</p>


<h3>Value</h3>

<p>Returns a list with results from the GMM evaluation.
</p>

<dl>
<dt><code>local_min</code></dt><dd><p>GMM point evaluation</p>
</dd>
<dt><code>gradient</code></dt><dd><p>GMM derivative with respect to non-linear parameters</p>
</dd>
<dt><code>delta</code></dt><dd><p>result of the contraction mapping</p>
</dd>
<dt><code>xi</code></dt><dd><p>residuals of GMM evaluation</p>
</dd> </dl>



<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

theta_guesses &lt;- matrix(c(0.5,2), nrow=2)
rownames(theta_guesses) &lt;- c("x1","x2")
colnames(theta_guesses) &lt;- "unobs_sd"

gmm &lt;- gmm_obj_wrap(  blp_data=blp_data,
                      par_theta2 = theta_guesses,
                      printLevel = 2)
gmm$local_min

</code></pre>

<hr>
<h2 id='originalDraws_cereal'>Draws for unobserved heterogeneity in Nevo's cereal example.</h2><span id='topic+originalDraws_cereal'></span>

<h3>Description</h3>

<p>Draws for unobserved heterogeneity in Nevo's cereal example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>originalDraws_cereal
</code></pre>


<h3>Format</h3>

<p>Each list entry contains draws (unobserved heterogeneity) for a random coefficient.
</p>

<dl>
<dt>cdid</dt><dd><p>market identifier,</p>
</dd>
<dt>draws_</dt><dd><p>20 draws differing across markets.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0">https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0</a>
</p>

<hr>
<h2 id='productData_cars'>Product data of BLP's car example.</h2><span id='topic+productData_cars'></span>

<h3>Description</h3>

<p>Product data of BLP's car example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>productData_cars
</code></pre>


<h3>Format</h3>

<p>A data frame with product data of 2217 cars in 20 markets.
</p>

<dl>
<dt>share</dt><dd><p>car market share,</p>
</dd>
<dt>price</dt><dd><p>car price,</p>
</dd>
<dt>hpwt</dt><dd><p>horsepower-weight ratio,</p>
</dd>
<dt>air</dt><dd><p>1, if car has air conditioning, 0 otherwise,</p>
</dd>
<dt>mpg</dt><dd><p>market identifier,</p>
</dd>
<dt>space</dt><dd><p>length times width of the car,</p>
</dd>
<dt>const</dt><dd><p>constant,</p>
</dd>
<dt>id</dt><dd><p>uniquely identifies a car,</p>
</dd>
<dt>cdid</dt><dd><p>uniquely identifies the market of a product,</p>
</dd>
<dt>firmid</dt><dd><p>uniquely identifies the firm of a product (corresponds to column number in the ownership matrix).</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0">https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0</a>
</p>

<hr>
<h2 id='productData_cereal'>Product data of Nevo's cereal example.</h2><span id='topic+productData_cereal'></span>

<h3>Description</h3>

<p>Product data of Nevo's cereal example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>productData_cereal
</code></pre>


<h3>Format</h3>

<p>A data frame with product data of 24 cereals in each of 94 markets.
</p>

<dl>
<dt>share</dt><dd><p>cereals market share,</p>
</dd>
<dt>price</dt><dd><p>cereals price,</p>
</dd>
<dt>const</dt><dd><p>constant,</p>
</dd>
<dt>sugar</dt><dd><p>cereals sugar,</p>
</dd>
<dt>mushy</dt><dd><p>cereals mushy,</p>
</dd>
<dt>cdid</dt><dd><p>market identifier,</p>
</dd>
<dt>product_id</dt><dd><p>uniquely identifies a product in a market,</p>
</dd>
<dt>productdummy</dt><dd><p>uniquely identifies a product in a market,</p>
</dd>
<dt>IV1</dt><dd><p>1. instrument,</p>
</dd>
<dt>IV2</dt><dd><p>2. instrument,</p>
</dd>
<dt>IV3</dt><dd><p>3. instrument,</p>
</dd>
<dt>IV4</dt><dd><p>4. instrument,</p>
</dd>
<dt>IV5</dt><dd><p>5. instrument,</p>
</dd>
<dt>IV6</dt><dd><p>6. instrument,</p>
</dd>
<dt>IV7</dt><dd><p>7. instrument,</p>
</dd>
<dt>IV8</dt><dd><p>8. instrument,</p>
</dd>
<dt>IV9</dt><dd><p>9. instrument,</p>
</dd>
<dt>IV10</dt><dd><p>10. instrument,</p>
</dd>
<dt>IV11</dt><dd><p>11. instrument,</p>
</dd>
<dt>IV12</dt><dd><p>12. instrument,</p>
</dd>
<dt>IV13</dt><dd><p>13. instrument,</p>
</dd>
<dt>IV14</dt><dd><p>14. instrument,</p>
</dd>
<dt>IV15</dt><dd><p>15. instrument,</p>
</dd>
<dt>IV16</dt><dd><p>16. instrument,</p>
</dd>
<dt>IV17</dt><dd><p>17. instrument,</p>
</dd>
<dt>IV18</dt><dd><p>18. instrument,</p>
</dd>
<dt>IV19</dt><dd><p>19. instrument,</p>
</dd>
<dt>IV20</dt><dd><p>20. instrument</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0">https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0</a>
</p>

<hr>
<h2 id='simulate_BLP_dataset'>This function creates a simulated BLP dataset.</h2><span id='topic+simulate_BLP_dataset'></span>

<h3>Description</h3>

<p>This function creates a simulated BLP dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_BLP_dataset(
  nmkt,
  nbrn,
  Xlin,
  Xexo,
  Xrandom,
  instruments,
  true.parameters = list(),
  price.endogeneity = list(mean.xi = -2, mean.eita = 0, cov = cbind(c(1, 0.7), c(0.7,
    1))),
  printlevel = 1,
  seed
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_BLP_dataset_+3A_nmkt">nmkt</code></td>
<td>
<p>number of markets</p>
</td></tr>
<tr><td><code id="simulate_BLP_dataset_+3A_nbrn">nbrn</code></td>
<td>
<p>number of products</p>
</td></tr>
<tr><td><code id="simulate_BLP_dataset_+3A_xlin">Xlin</code></td>
<td>
<p>character vector specifying the set of linear variables</p>
</td></tr>
<tr><td><code id="simulate_BLP_dataset_+3A_xexo">Xexo</code></td>
<td>
<p>character vector specifying the set of exogenous variables (subset of <code>Xlin</code>)</p>
</td></tr>
<tr><td><code id="simulate_BLP_dataset_+3A_xrandom">Xrandom</code></td>
<td>
<p>character vector specifying the set of random coefficients (subset of <code>Xlin</code>)</p>
</td></tr>
<tr><td><code id="simulate_BLP_dataset_+3A_instruments">instruments</code></td>
<td>
<p>character vector specifying the set of instrumental variables</p>
</td></tr>
<tr><td><code id="simulate_BLP_dataset_+3A_true.parameters">true.parameters</code></td>
<td>
<p>list with parameters of the DGP
</p>

<dl>
<dt><code>Xlin.true.except.price</code></dt><dd><p>&quot;true&quot; linear coefficients in utility function except price</p>
</dd>
<dt><code>Xlin.true.price</code></dt><dd><p>&quot;true&quot; linear price coefficient in utility function</p>
</dd>
<dt><code>Xrandom.true</code></dt><dd><p>&quot;true&quot; set of random coefficients</p>
</dd>
<dt><code>instrument.effects</code></dt><dd><p>&quot;true&quot; coefficients of instrumental variables to explain endogenous price</p>
</dd>
<dt><code>instrument.Xexo.effects</code></dt><dd><p>&quot;true&quot; coefficients of exogenous variables to explain endogenous price</p>
</dd> </dl>
</td></tr>
<tr><td><code id="simulate_BLP_dataset_+3A_price.endogeneity">price.endogeneity</code></td>
<td>
<p>list with arguments of the multivariate normal
distribution
</p>

<dl>
<dt><code>mean.xi</code></dt><dd><p>controls for the mean of the error term in the utility function</p>
</dd>
<dt><code>mean.eita</code></dt><dd><p>controls for the mean of the error term in the price function</p>
</dd>
<dt><code>cov</code></dt><dd><p>controls for the covariance of <code>xi</code> and <code>eita</code> </p>
</dd></dl>
</td></tr>
<tr><td><code id="simulate_BLP_dataset_+3A_printlevel">printlevel</code></td>
<td>
<p>0 (no output) 1 (summary of generated data)</p>
</td></tr>
<tr><td><code id="simulate_BLP_dataset_+3A_seed">seed</code></td>
<td>
<p>seed for the random number generator</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dataset is balanced, so every market has the same amount of products.
Only unobserved heterogeneity can be considered.
Variables that enter the equation as a Random Coefficient or
exogenously must be included in the set of linear variables.
The <code>parameter.list</code> argument specifies the &quot;true&quot; effect on the
individual utility for each component. Prices are generated endogenous
as a function of exogenous variables and instruments, where the
respective effect sizes are specified in <code>instrument.effects</code>
and <code>instrument.Xexo.effects</code>. Error terms <code>xi</code> and <code>eita</code>
are drawn from a multivariate normal distribution, whose
parameters can be set in <code>price.endogeneity</code>. Market shares
are generated by MLHS integration rule with 10000 nodes.
</p>


<h3>Value</h3>

<p>Returns a simulated BLP dataset.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients

</code></pre>

<hr>
<h2 id='theta_guesses_cereal'>Parameter starting guesses for Nevo's cereal example.</h2><span id='topic+theta_guesses_cereal'></span>

<h3>Description</h3>

<p>Parameter starting guesses for Nevo's cereal example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta_guesses_cereal
</code></pre>


<h3>Format</h3>

<p>A matrix with 4 random coefficients (rows) and columns for 4 demographics and one unobserved heterogeneity column (5 cols in total).
</p>


<h3>Source</h3>

<p><a href="https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0">https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0</a>
</p>

<hr>
<h2 id='update_BLP_data'>Updates the set of linear, exogenous, random coefficient, share or mean utility variable in the data object.</h2><span id='topic+update_BLP_data'></span>

<h3>Description</h3>

<p>Updates the set of linear, exogenous, random coefficient, share or mean utility variable in the data object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_BLP_data(data_update, blp_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_BLP_data_+3A_data_update">data_update</code></td>
<td>
<p>data.frame with variables to update (must contain the market_identifier and product_identifier variables as in <code>blp_data</code>),</p>
</td></tr>
<tr><td><code id="update_BLP_data_+3A_blp_data">blp_data</code></td>
<td>
<p>data object created by the function <code>BLP_data</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>blp_data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K&lt;-2 #number of random coefficients
data &lt;- simulate_BLP_dataset(nmkt = 25, nbrn = 20,
                        Xlin = c("price", "x1", "x2", "x3", "x4", "x5"),
                        Xexo = c("x1", "x2", "x3", "x4", "x5"),
                        Xrandom = paste0("x",1:K),instruments = paste0("iv",1:10),
                        true.parameters = list(Xlin.true.except.price = rep(0.2,5),
                                               Xlin.true.price = -0.2,
                                               Xrandom.true = rep(2,K),
                                               instrument.effects = rep(2,10),
                                               instrument.Xexo.effects = rep(1,5)),
                        price.endogeneity = list( mean.xi = -2,
                                                  mean.eita = 0,
                                                  cov = cbind( c(1,0.7), c(0.7,1))),
                        printlevel = 0, seed = 234234 )


model &lt;- as.formula("shares ~  price + x1 + x2 + x3 + x4 + x5 |
                    x1 + x2 + x3 + x4 + x5 |
                    0+ x1 + x2 |
                    iv1 + iv2 + iv3 + iv4 + iv5 + iv6 + iv7 + iv8 +iv9 +iv10" )

blp_data &lt;- BLP_data(model = model, market_identifier="cdid",
                     product_id = "prod_id",
                     productData = data,
                     integration_method = "MLHS" ,
                     integration_accuracy = 40,
                     integration_seed = 1)

new_data &lt;- data.frame(price = seq(1,10,length.out=500),
                       x1 =  seq(2,10,length.out=500),
                       cdid = sort(rep(1:25,20)),
                       prod_id = rep(1:20,25) )
blp_data_example_updated &lt;-update_BLP_data(blp_data = blp_data,
                                           data_update = new_data)

</code></pre>

<hr>
<h2 id='w_guesses_cereal'>Mean utility starting guesses for Nevo's cereal example.</h2><span id='topic+w_guesses_cereal'></span>

<h3>Description</h3>

<p>Mean utility starting guesses for Nevo's cereal example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_guesses_cereal
</code></pre>


<h3>Format</h3>

<p>A numeric vector of 2256 values.
</p>


<h3>Source</h3>

<p><a href="https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0">https://dataverse.harvard.edu/file.xhtml?persistentId=doi:10.7910/DVN/26803/SOF9FW&amp;version=1.0</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
