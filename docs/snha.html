<!DOCTYPE html><html><head><title>Help for package snha</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {snha}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#snha-package'><p> snha package - association chain graphs from correlation networks</p></a></li>
<li><a href='#as.list.snha'><p>return a list representation for an snha graph object</p></a></li>
<li><a href='#decathlon88'><p>Men Decathlon data from the 1988 Olympics</p></a></li>
<li><a href='#plot.snha'><p>display network or correlation matrices of snha graphs</p></a></li>
<li><a href='#snha'><p>Initialize a snha object with data.</p></a></li>
<li><a href='#snha_get_chains'><p>Return the chains of an snha graph as data frame</p></a></li>
<li><a href='#snha_graph2data'><p>create correlated data for the given adjacency matrix representing</p>
a directed graph or an undirected graph</a></li>
<li><a href='#snha_layout'><p>Determine graph layouts</p></a></li>
<li><a href='#snha_ll'><p>log-likelihood for the given snha graph and the given chain</p></a></li>
<li><a href='#snha_rsquare'><p>linear model based r-square values for given data and graph</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Creating Correlation Networks using St. Nicolas House Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-13</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Detlef Groth &lt;dgroth@uni-potsdam.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Create correlation networks using St. Nicolas House Analysis ('SNHA'). 
    The package can be used for visualizing multivariate data similar to Principal
    Component Analysis or Multidimensional Scaling using a ranking approach.
    In contrast to 'MDS' and 'PCA', 'SNHA' uses a network approach to explore
    interacting variables. 
    For details see 'Hermanussen et. al. 2021', &lt;<a href="https://doi.org/10.3390%2Fijerph18041741">doi:10.3390/ijerph18041741</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mittelmark/snha">https://github.com/mittelmark/snha</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mittelmark/snha/issues">https://github.com/mittelmark/snha/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Collate:</td>
<td>ll.R asgp.R priv.R snha.R</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-13 15:45:59 UTC; groth</td>
</tr>
<tr>
<td>Author:</td>
<td>Detlef Groth <a href="https://orcid.org/0000-0002-9441-3978"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-14 11:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='snha-package'> snha package - association chain graphs from correlation networks</h2><span id='topic+snha-package'></span>

<h3>Description</h3>

<p>The snha package can be used to construct association chain graphs  
based on the St. Nicolas House Analysis (SNHA) algorithm as described in Groth et. al. 2019. 
and Hermanussen et. al. 2021.</p>


<h3>Details</h3>

<p>The package provides the following functions: 
Function for graph generation from data: 
</p>
 
<dl>
<dt><a href="#topic+snha">snha(data)</a></dt><dd><p>applys the SNHA method on the data and returns  
a new snha graph object</p>
</dd> 
</dl>
 
<p>S3 methods for snha graphs: 
</p>
 
<dl>
<dt><a href="#topic+plot.snha">plot.snha(x)</a></dt><dd><p>plots a snha graph</p>
</dd> 
<dt><a href="#topic+as.list.snha">as.list.snha(x)</a></dt><dd><p>return a list 
representation of a snha graph object</p>
</dd> 
</dl>
 
<p>Utility functions: 
</p>
 
<dl>
<dt><a href="#topic+snha_get_chains">snha_get_chains(g)</a></dt><dd><p>returns the chains found  
by the algorithm as matrix</p>
</dd> 
<dt><a href="#topic+snha_graph2data">snha_graph2data(A)</a></dt><dd><p>create for the given 
adjacency matrix some data with the appropiate correlations</p>
</dd> 
<dt><a href="#topic+snha_layout">snha_layout(g)</a></dt><dd><p>calculate layout coordinates  
for the given graph or adjacency matrix</p>
</dd> 
<dt><a href="#topic+snha_ll">snha_ll(g,chain)</a></dt><dd><p>calculate log-likelihood for  
the given chain of the snha graph</p>
</dd> 
<dt><a href="#topic+snha_rsquare">snha_rsquare(data,g)</a></dt><dd><p>for given data and graph  
or adjacency matrix calculate linear model r-square value</p>
</dd> 
</dl>
 


<h3>Value</h3>

<p>No return value</p>


<h3>Author(s)</h3>

<p>Detlef Groth &lt;dgroth@uni-potsdam.de&gt;</p>


<h3>References</h3>

 
 
<ul>
<li><p> Groth, D., Scheffler, C., &amp; Hermanussen, M. (2019).  
Body height in stunted Indonesian children depends directly on parental education and not  
via a nutrition mediated pathway -  
Evidence from tracing association chains by St. Nicolas House Analysis.  
<em>Anthropologischer Anzeiger</em>, 76 No. 5 (2019), p. 445 - 451. 
doi: <a href="https://doi.org/10.1127/anthranz/2019/1027">10.1127/anthranz/2019/1027</a> 
</p>
</li>
<li><p> Hermanussen, M., Assmann, &amp; Groth, D. (2021). 
Chain Reversion for Detecting Associations in Interacting Variables - St. Nicolas House Analysis. 
<em>International Journal of Environmental Research and Public Health</em>. 
18, 4 (2021). doi: <a href="https://doi.org/10.3390/ijerph18041741">10.3390/ijerph18041741</a>. 
</p>
</li>
<li><p> Novine, M., Mattsson, C. C., &amp; Groth, D. (2021). 
Network reconstruction based on synthetic data generated by a Monte Carlo 
approach. <em>Human Biology and Public Health</em>, 3:26. 
doi: <a href="https://doi.org/10.52905/hbph2021.3.26">10.52905/hbph2021.3.26</a> 
</p>
</li></ul>
 


<h3>Examples</h3>

<pre><code class='language-R'> 
library(MASS) 
data(birthwt) 
as=snha(birthwt[,-1]) 
plot(as) 
as$theta 
ls(as) 
data(decathlon88) 
head(decathlon88) 
dec=snha(decathlon88,method="spearman",alpha=0.1) 
plot(dec,layout='sam') 
</code></pre>

<hr>
<h2 id='as.list.snha'>return a list representation for an snha graph object</h2><span id='topic+as.list.snha'></span>

<h3>Description</h3>

<p>The function 'as.list.snha' provides a S3 method to convert 
a snha graph object into a list object which can be for instance used  
to write a report into an XLSX file  using the library openxlsx.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'snha'
as.list(x,...)</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="as.list.snha_+3A_x">x</code></td>
<td>
<p> snha graph object created with the snha function</p>
</td></tr> 
<tr><td><code id="as.list.snha_+3A_...">...</code></td>
<td>
<p> additional arguments, delegated to the list command</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>list object with the components:  
'chains' (the association chain), 
'data' (original data), 
'theta' (adjacency matrix,  
'sigma' (correlations),  
'p.value' (correlation p-values) 
</p>


<h3>See Also</h3>

<p><a href="#topic+plot.snha">plot.snha</a>, <a href="#topic+snha">snha</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>  
data(swiss) 
as=snha(swiss,method="spearman",alpha=0.1) 
result=as.list(as) 
ls(result) 
result$settings 
# can be writte as xlsx file for instance like: 
# library(openxlsx) 
# write.xlsx(result,file="some-result.xlsx") 
</code></pre>

<hr>
<h2 id='decathlon88'>Men Decathlon data from the 1988 Olympics</h2><span id='topic+decathlon88'></span>

<h3>Description</h3>

<p>A subset of data from the Decathlon from the 1988 Olympic games. 
Included are all athletes which finished with more than 7000 points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decathlon88</code></pre>


<h3>Format</h3>

<p>A data frame with 33 rows and 10 columns:
</p>

<dl>
<dt>disc</dt><dd><p>discus results in m</p>
</dd>
<dt>high</dt><dd><p>high jump results in m</p>
</dd>
<dt>jave</dt><dd><p>javelin through results in m</p>
</dd>
<dt>long</dt><dd><p>long jump results in m</p>
</dd>
<dt>pole</dt><dd><p>pole vault results in m</p>
</dd>
<dt>shot</dt><dd><p>shot put results in m</p>
</dd>
<dt>X100</dt><dd><p>running speed over 100m in km/h</p>
</dd>
<dt>X110</dt><dd><p>running speed over 110m hurdles in km/h</p>
</dd>
<dt>X1500</dt><dd><p>running speed over 1500m in km/h</p>
</dd>
<dt>X400</dt><dd><p>running speed over 400m in km/h</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://en.wikipedia.org/wiki/Athletics_at_the_1988_Summer_Olympics_-_Men's_decathlon&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(decathlon88)
head(decathlon88)
A=snha(decathlon88,method="spearman",alpha=0.1)
cols=rep("salmon",10)
cols[names(A$data) %in% c("jave","shot","disc","pole")]="skyblue"
plot(A,layout="sam",vertex.color=cols,vertex.size=8,cex=1.2,edge.width=5)
snha_rsquare(A)

</code></pre>

<hr>
<h2 id='plot.snha'>display network or correlation matrices of snha graphs</h2><span id='topic+plot.snha'></span>

<h3>Description</h3>

<p>The function 'plot.snha' provides a simple display of network  
graphs correlation matrices using  filled circles (vertices) to represent 
variables and edges which connect the vertices with high absolute.  
correlation values. Positive correlations are shown in black, negative 
correlations are shown in red. For more information see the details 
section. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
## S3 method for class 'snha'
plot( 
 x, 
 type = "network", 
 layout = "circle", 
 vertex.color = "salmon", 
 cex = 1, 
 vertex.size = 5, 
 edge.width = 2, 
 edge.color = c("grey70", "red"), 
 edge.text = NULL, 
 edge.cex = 0.8, 
 edge.pch = 0, 
 noise = FALSE, 
 hilight.chain = NULL, 
 chain.color = c("black", "red"), 
 star.center = NULL, 
 plot.labels = TRUE, 
 lty = 1, 
 threshold = c(0.25, 0.5, 0.75), 
 interactive = FALSE, 
 ... 
) 
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="plot.snha_+3A_x">x</code></td>
<td>
<p>snha graph object usually created with the 'snha' function or an 
adjacency matrix</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_type">type</code></td>
<td>
<p>character string specifying the plot type either 'network' or 
'         cor', default: 'network'</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_layout">layout</code></td>
<td>
<p>graph layout for plotting one of 'circle', 'sam', 'samd', 
'grid', 'mds', 'mdsd', 'star', default: 'circle'</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_vertex.color">vertex.color</code></td>
<td>
<p>default color for the vertices, either a single value, 
all vertices have hen this color or a vector of values, 
for different colors for the nodes, default: 'salmon'</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_cex">cex</code></td>
<td>
<p>size of the vertex labels which are plotted on the vertices, default: 1</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_vertex.size">vertex.size</code></td>
<td>
<p>number how large the vertices should be plotted, default: 5</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_edge.width">edge.width</code></td>
<td>
<p>number on how strong the edges should be plotted, if 
edge.width=0, then the number is based on the correlation values,  
default: 2</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_edge.color">edge.color</code></td>
<td>
<p>color to be plotted for edges. Usually vector of length two. 
First color for positive correlations, second color for negative 
correlations. Default: c('grey','red')</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_edge.text">edge.text</code></td>
<td>
<p>optional matrix to give edge labels, default: NULL</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_edge.cex">edge.cex</code></td>
<td>
<p>character expansion for edge labels, default: 0.8</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_edge.pch">edge.pch</code></td>
<td>
<p>plotting character which should be placed below the edge.text, 
default: 0</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_noise">noise</code></td>
<td>
<p>should be noise added to the layout. Sometimes useful if nodes 
are too close. Default: FALSE</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_hilight.chain">hilight.chain</code></td>
<td>
<p>which chain should be highlighted,  
default: NULL (no chain highlight)</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_chain.color">chain.color</code></td>
<td>
<p>which color for chain edges, default: black</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_star.center">star.center</code></td>
<td>
<p>the centered node if layout is 'start', must be 
a character string for the node name, default: NULL</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_plot.labels">plot.labels</code></td>
<td>
<p>should node labels plotted, default: TRUE</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_lty">lty</code></td>
<td>
<p>line type for standard edges in the graph, default: 1</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_threshold">threshold</code></td>
<td>
<p>cutoff values for bootstrap probabilities for drawing edges 
as dotted, broken lines and solid lines, default: c(0.25,0.5,0.75)</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_interactive">interactive</code></td>
<td>
<p>switch into interactive mode where you can click in the 
graph and move nodes with two clicks, first selecting the node, 
second click gives the new coordinates for the node, default: FALSE</p>
</td></tr> 
<tr><td><code id="plot.snha_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This is a plot function to display networks or correlation matrices 
of 'snha' graph objects.  
In case of bootstrapping the graph by using the 'snha' function with the 'prob=TRUE'  
option lines in style full, broken and dotted lines are drawn if 
they are found in more than 75, 50 or 25 percent of all re-samplings. 
You can change these limits by using the 'threshold' argument.</p>


<h3>Value</h3>

<p>returns the layout of the plotted network or NULL if type is 'corrplot' 
(invisible)</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
data(swiss) 
sw.g=snha(swiss,method='spearman') 
sw.g$theta 
round(sw.g$sigma,2) 
plot(sw.g,type='network',layout='circle') 
plot(sw.g,type='network',layout='sam') 
plot(sw.g,type='corplot') 
# adding correlation values 
plot(sw.g,edge.text=round(sw.g$sigma,2),edge.cex=1.2,edge.pch=15) 
sw.g=snha(swiss,method='spearman',prob=TRUE) 
sw.g$theta 
sw.g$probabilities 
plot(sw.g,type='network',layout='sam') 
sw.g$chains 
# plot chains for a node 
plot(sw.g,layout="sam",lty=2,hilight.chain="Infant.Mortality", 
 edge.width=3,edge.color=c("black","red")) 
# an example for an adjacency matrix 
M=matrix(rbinom(100,1, 0.2),nrow=10,ncol=10) 
diag(M)=0 
colnames(M)=rownames(M)=LETTERS[1:10] 
plot.snha(M) 
</code></pre>

<hr>
<h2 id='snha'>Initialize a snha object with data.</h2><span id='topic+snha'></span>

<h3>Description</h3>

 
<p>The main entry function to initialize a snha object with data where 
variables are in columns and items are in rows 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>snha( 
  data, 
  alpha=0.05, 
  method='pearson', 
  threshold=0.01, 
  check.singles=FALSE, 
  prob=FALSE, 
  prob.threshold=0.2, 
  prob.n=25) 
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="snha_+3A_data">data</code></td>
<td>
<p>a data frame where network nodes are the row names and data 
variables are in the columns.</p>
</td></tr> 
<tr><td><code id="snha_+3A_alpha">alpha</code></td>
<td>
<p>confidence threshold for p-value edge cutting after all chains 
were generated, default: 0.05.</p>
</td></tr> 
<tr><td><code id="snha_+3A_method">method</code></td>
<td>
<p>method to calculate correlation/association values, can be 
'pearson', 'spearman' or 'kendall', default: 'pearson'.</p>
</td></tr> 
<tr><td><code id="snha_+3A_threshold">threshold</code></td>
<td>
<p>R-squared correlation coefficient threshold for which 
r-square values should be used for chain generation, r=0.1 is r-square of 
0.01, default: 0.01.</p>
</td></tr> 
<tr><td><code id="snha_+3A_check.singles">check.singles</code></td>
<td>
<p>should isolated nodes connected with sufficient high R^2 
and significance, default: FALSE.</p>
</td></tr> 
<tr><td><code id="snha_+3A_prob">prob</code></td>
<td>
<p>should be probabilities computed for each edge using 
bootstrapping. Only in this case the parameters starting with prob are used, 
default: FALSE</p>
</td></tr> 
<tr><td><code id="snha_+3A_prob.threshold">prob.threshold</code></td>
<td>
<p>threshold to set an edge, a value of 0.5 means, that 
the edge must be found in 50% of all samplings, default: 0.2</p>
</td></tr> 
<tr><td><code id="snha_+3A_prob.n">prob.n</code></td>
<td>
<p>number of bootstrap samples to be taken, default: 25</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>A snha graph data object with the folling components: 
</p>
 
<dl>
<dt>chains</dt><dd><p>association chains building the graph</p>
</dd> 
<dt>data</dt><dd><p>representing the original input data</p>
</dd> 
<dt>p.values</dt><dd><p>matrix with p-values for the pairwise correlations</p>
</dd> 
<dt>probabilities</dt><dd><p>in case of re-samplings, the proportion how often the chain was found</p>
</dd> 
<dt>sigma</dt><dd><p>correlation matrix used for the algorithm</p>
</dd> 
<dt>theta</dt><dd><p>adjacency  matrix found by the SNHA method</p>
</dd> 
</dl>
 


<h3>See Also</h3>

 <p><a href="#topic+plot.snha">plot.snha</a></p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(swiss) 
sw.g=snha(swiss,method='spearman') 
# what objects are there? 
ls(sw.g) 
sw.g$theta 
round(sw.g$sigma,2) 
sw.g=snha(swiss,method='spearman',check.singles=TRUE,prob=TRUE) 
sw.g$theta 
sw.g$probabilities 
</code></pre>

<hr>
<h2 id='snha_get_chains'>Return the chains of an snha graph as data frame</h2><span id='topic+snha_get_chains'></span>

<h3>Description</h3>

<p>This is a utility function to return the chains which 
constructs the graph as a matrix.</p>


<h3>Usage</h3>

<pre><code class='language-R'>snha_get_chains(graph)</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="snha_get_chains_+3A_graph">graph</code></td>
<td>
<p>a snha graph object</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>matrix with one chain per row, shorter chains are filled up with empty strings</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(swiss) 
sw.g=snha(swiss) 
snha_get_chains(sw.g) 
</code></pre>

<hr>
<h2 id='snha_graph2data'>create correlated data for the given adjacency matrix representing 
a directed graph or an undirected graph</h2><span id='topic+snha_graph2data'></span>

<h3>Description</h3>

<p>This function is a short implementation of the Monte Carlo 
algorithm described in Novine et. al. 2022.</p>


<h3>Usage</h3>

<pre><code class='language-R'>snha_graph2data( 
  A, 
  n=100, 
  iter=50, 
  val=100, 
  sd=2, 
  prop=0.025, 
  noise=1, 
  method="mc" 
  ) 
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="snha_graph2data_+3A_a">A</code></td>
<td>
<p>an adjacency matrix</p>
</td></tr> 
<tr><td><code id="snha_graph2data_+3A_n">n</code></td>
<td>
<p>number of values, measurements per node, default: 100</p>
</td></tr> 
<tr><td><code id="snha_graph2data_+3A_iter">iter</code></td>
<td>
<p>number of iterations, default: 50</p>
</td></tr> 
<tr><td><code id="snha_graph2data_+3A_sd">sd</code></td>
<td>
<p>initial standard deviation, default: 2</p>
</td></tr> 
<tr><td><code id="snha_graph2data_+3A_val">val</code></td>
<td>
<p>initial node value, default: 100</p>
</td></tr> 
<tr><td><code id="snha_graph2data_+3A_prop">prop</code></td>
<td>
<p>proportion of the target node value take from the source node, 
default: 0.025</p>
</td></tr> 
<tr><td><code id="snha_graph2data_+3A_noise">noise</code></td>
<td>
<p>sd for the noise value added after each iteration using rnorm 
function with mean 0, default: 1</p>
</td></tr> 
<tr><td><code id="snha_graph2data_+3A_method">method</code></td>
<td>
<p>method for data generation, either 'mc' for using Monte Carlo 
simulation or 'pc' for using a precision matrix, default: 'mc'</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>matrix with the node names as rows and samplings in the columns</p>


<h3>References</h3>

 
 
<ul>
<li><p> Novine, M., Mattsson, C. C., &amp; Groth, D. (2021). 
Network reconstruction based on synthetic data generated by a Monte Carlo approach.  
<em>Human Biology and Public Health</em>, 3:26. 
doi: <a href="https://doi.org/10.52905/hbph2021.3.26">10.52905/hbph2021.3.26</a> 
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'> 
opar=par(mfrow=c(1,2),mai=rep(0.2,4)) 
A=matrix(0,nrow=6,ncol=6) 
rownames(A)=colnames(A)=LETTERS[1:6] 
A[1:2,3]=1 
A[3,4]=1 
A[4,5:6]=1 
A[5,6]=1 
plot.snha(A,layout="circle");  
data=snha_graph2data(A) 
round(cor(t(data)),2) 
P=snha(t(data)) 
plot(P,layout="circle") 
par(opar) 
</code></pre>

<hr>
<h2 id='snha_layout'>Determine graph layouts</h2><span id='topic+snha_layout'></span>

<h3>Description</h3>

<p>This function returns xy coordinates for a given input 
adjacency matrix or snha graph. It is useful if you like to plot 
the same set of nodes with different edge connections  
in the same layout.</p>


<h3>Usage</h3>

<pre><code class='language-R'>snha_layout( 
   A, 
   mode='sam', 
   method='pearson',  
   noise=FALSE,  
   star.center=NULL, 
   interactive=FALSE) 
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="snha_layout_+3A_a">A</code></td>
<td>
<p>an adjacency matrix or an snha graph object</p>
</td></tr> 
<tr><td><code id="snha_layout_+3A_mode">mode</code></td>
<td>
<p>character string for the layout type, can be either  
'mds' (mds on graph using shortest paths), 'mdsd' (mds on data) 
'sam' (sammon on graph), 'samd' (sammon on data), 
'circle', 'grid' or 'star', default: 'sam'</p>
</td></tr> 
<tr><td><code id="snha_layout_+3A_method">method</code></td>
<td>
<p>method for calculating correlation distance if mode is either 
'mdsd' or 'samd', default: 'pearson'</p>
</td></tr> 
<tr><td><code id="snha_layout_+3A_noise">noise</code></td>
<td>
<p>should some noise be added, default: FALSE</p>
</td></tr> 
<tr><td><code id="snha_layout_+3A_star.center">star.center</code></td>
<td>
<p>the centered node if layout is 'star', must be 
a character string for the node name, default: NULL</p>
</td></tr> 
<tr><td><code id="snha_layout_+3A_interactive">interactive</code></td>
<td>
<p>switch into interactive mode where you can click in the 
graph and move nodes with two clicks, first selecting the node, second click 
gives the new coordinates for the node, default: FALSE</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>matrix with x and y columns for the layout</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(swiss) 
sw.s=snha(swiss,method='spearman') 
sw.p=snha(swiss,method='pearson') 
lay=snha_layout(sw.s,mode='sam') 
plot(sw.s,layout=lay) 
plot(sw.p,layout=lay) 
plot(sw.s,layout='star',star.center='Education') 
rn1=rnorm(nrow(swiss)) 
nswiss=cbind(swiss,Rn1=rn1) 
plot(snha(nswiss,method='spearman'),layout='sam') 
plot(snha(nswiss,method='spearman'),layout='samd', 
  vertex.size=2,vertex.color='beige') 
</code></pre>

<hr>
<h2 id='snha_ll'>log-likelihood for the given snha graph and the given chain</h2><span id='topic+snha_ll'></span>

<h3>Description</h3>

<p>This function returns the log-likelihood for the given snha 
graph and the given chain. If the 'block.p.value' is lower than 0.05 than 
that the chain is not sufficient to capture the variable dependencies, 
p-values above 0.05 indicate a good coverage of the chain for the linear 
dependencies between the nodes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>snha_ll(graph,chain=NULL)</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="snha_ll_+3A_graph">graph</code></td>
<td>
<p>a snha graph object</p>
</td></tr> 
<tr><td><code id="snha_ll_+3A_chain">chain</code></td>
<td>
<p>a chain object of a snha graph, if not given a data frame with 
the values is returned for all chains, default: NULL</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>list with the following components: 'll.total', 'll.chain', 
'll.rest', 'll.block', data frame 'df' with the columns 'chisq', 'p.value', 
'block.df', 'block.ch', 'block.p.value'. If chain is not given an overall 
summary is made for all chains an returned as data frame.</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
data(swiss) 
sw.g=snha(swiss) 
snha_ll(sw.g,sw.g$chain$Catholic) 
head(snha_ll(sw.g)) 
</code></pre>

<hr>
<h2 id='snha_rsquare'>linear model based r-square values for given data and graph</h2><span id='topic+snha_rsquare'></span>

<h3>Description</h3>

<p> The function 'snha_rsquare' calculates for given data and  
a graph the covered r-squared values by  a linear model for each node.  
The linear model predicts each node by an additive mode  
using it's neighbor nodes in the graph.</p>


<h3>Usage</h3>

<pre><code class='language-R'>snha_rsquare(data,graph=NULL)</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="snha_rsquare_+3A_data">data</code></td>
<td>
<p>data matrix or data frame where variables 
are in columns and samples in rows or a snha graph</p>
</td></tr> 
<tr><td><code id="snha_rsquare_+3A_graph">graph</code></td>
<td>
<p> graph object or adjacency matrix of an (un)directed graph, not 
needed if data is a snha graph, default: NULL.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>vector of rsquare values for each node of the graph</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
# random adjacency matrix 
A=matrix(rbinom(100,1, 0.2),nrow=10,ncol=10) 
diag(A)=0 
colnames(A)=rownames(A)=LETTERS[1:10] 
# random data 
data=matrix(rnorm(1000),ncol=10) 
colnames(data)=colnames(A) 
snha_rsquare(data,A) 
# real data 
data(swiss) 
sw.s=snha(swiss,method='spearman') 
rsqs=snha_rsquare(sw.s) 
plot(sw.s,main=paste("r =",round(mean(rsqs,2))), 
   layout='star',star.center='Examination') 
# some colors for r-square values 
vcols=paste("grey",seq(80,40,by=-10),sep="") 
scols=as.character(cut(snha_rsquare(swiss,sw.s$theta), 
   breaks=c(0,0.1,0.3,0.5,0.7,1),labels=vcols)) 
plot(sw.s,main=paste("r =",round(mean(snha_rsquare(swiss,sw.s$theta)),2)), 
   vertex.color=scols ,layout='star',star.center='Examination', 
   vertex.size=10,edge.color=c('black','red'),edge.width=3) 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
