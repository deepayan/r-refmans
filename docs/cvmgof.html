<!DOCTYPE html><html><head><title>Help for package cvmgof</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cvmgof}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acgm.bandwidth.selection.linkfunction'><p>Bandwidth selection of the link function under the null hypothesis</p></a></li>
<li><a href='#acgm.linkfunction.estim'><p>Local linear estimation of the regression function</p></a></li>
<li><a href='#acgm.statistics'><p>Local test statistic for the regression function</p></a></li>
<li><a href='#acgm.test.bootstrap'><p>Local test for the regression function</p></a></li>
<li><a href='#cvmgof'><p>cvmgof</p></a></li>
<li><a href='#df.bandwidth.selection.linkfunction'><p>Bandwidth selection of the link function under the null hypothesis</p></a></li>
<li><a href='#df.cdf.estim'><p>Local linear estimation of the conditional distribution function</p></a></li>
<li><a href='#df.linkfunction.estim'><p>Local linear estimation of the regression function</p></a></li>
<li><a href='#df.statistics'><p>Global test statistic for the conditional distribution function</p></a></li>
<li><a href='#df.test.bootstrap'><p>Global test for the conditional distribution function</p></a></li>
<li><a href='#kernel.function.epan'><p>Epanechnikov kernel</p></a></li>
<li><a href='#kernel.function.gauss'><p>Gaussian kernel</p></a></li>
<li><a href='#kernel.function.quart'><p>Quartic kernel</p></a></li>
<li><a href='#vkgmss.bandwidth.selection.linkfunction'><p>Bandwidth selection of the link function under the null hypothesis</p></a></li>
<li><a href='#vkgmss.linkfunction.estim'><p>Kernel estimation of the regression function</p></a></li>
<li><a href='#vkgmss.residuals.cdf.estim'><p>Kernel estimation of the error distribution</p></a></li>
<li><a href='#vkgmss.sd.estim'><p>Kernel estimation of the standard deviation function</p></a></li>
<li><a href='#vkgmss.statistics'><p>Local test statistic for the regression function</p></a></li>
<li><a href='#vkgmss.test.bootstrap'><p>Local test for the regression function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Cramer-von Mises Goodness-of-Fit Tests</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Romain Azais &lt;romain.azais@inria.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>It is devoted to Cramer-von Mises goodness-of-fit tests.
    It implements three statistical methods based on Cramer-von Mises statistics to estimate and test a regression model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.cecill.info/licences/Licence_CeCILL_V2-en.txt">CeCILL version 2</a> | <a href="https://www.cecill.info/licences/Licence_CeCILL_V2.1-en.txt">CECILL-2.1</a> [expanded from: CeCILL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>FALSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>lattice</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-11 14:53:31 UTC; romain</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-11 22:20:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='acgm.bandwidth.selection.linkfunction'>Bandwidth selection of the link function under the null hypothesis</h2><span id='topic+acgm.bandwidth.selection.linkfunction'></span>

<h3>Description</h3>

<p>This function computes the optimal bandwidth of the link function under the null hypothesis</p>


<h3>Usage</h3>

<pre><code class='language-R'>acgm.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0, linkfunction.H0,
		kernel.function = kernel.function.epan, verbose = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acgm.bandwidth.selection.linkfunction_+3A_data.x.h0">data.X.H0</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="acgm.bandwidth.selection.linkfunction_+3A_data.y.h0">data.Y.H0</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="acgm.bandwidth.selection.linkfunction_+3A_linkfunction.h0">linkfunction.H0</code></td>
<td>
<p>regression function under the null hypothesis</p>
</td></tr>
<tr><td><code id="acgm.bandwidth.selection.linkfunction_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the regression function. Default option is &quot;kernel.function.epan&quot; which corresponds to the Epanechnikov kernel function.</p>
</td></tr>
<tr><td><code id="acgm.bandwidth.selection.linkfunction_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the R function plots the link function (regression function) under the null hypothesis and the local linear link function estimation on a same graph. Default option is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>J. T. Alcala, J. A. Cristobal, and W. Gonzalez Manteiga. Goodness-of-fit test for linear
models based on local polynomials. <em>Statistics &amp; Probability Letters</em>, 42(1), 39:46, 1999.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Bandwidth selection under H0
#
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# data.X.H0 = runif(n,min=0,max=5)
# data.Y.H0 = linkfunction.H0(data.X.H0)+rnorm(n,mean=0,sd=0.3)
#
# h.opt.acgm = acgm.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
</code></pre>

<hr>
<h2 id='acgm.linkfunction.estim'>Local linear estimation of the regression function</h2><span id='topic+acgm.linkfunction.estim'></span>

<h3>Description</h3>

<p>This function computes the local linear estimation of the regression function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>acgm.linkfunction.estim(x, data.X, data.Y, bandwidth,
		kernel.function = kernel.function.epan)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acgm.linkfunction.estim_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="acgm.linkfunction.estim_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function.</p>
</td></tr>
<tr><td><code id="acgm.linkfunction.estim_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function.</p>
</td></tr>
<tr><td><code id="acgm.linkfunction.estim_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth used to obtain the nonparametric estimator of the regression function.</p>
</td></tr>
<tr><td><code id="acgm.linkfunction.estim_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the regression function. Default option is &quot;kernel.function.epan&quot; which corresponds to the Epanechnikov kernel function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inappropriate bandwidth or x choices can produce &quot;NaN&quot; values in link function estimates.</p>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>J. T. Alcala, J. A. Cristobal, and W. Gonzalez Manteiga. Goodness-of-fit test for linear
models based on local polynomials. <em>Statistics &amp; Probability Letters</em>, 42(1), 39:46, 1999.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block

# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Estimation of the link function
#
# bandwidth = 0.75 # Here, the bandwidth is arbitrarily fixed
#
# xgrid = seq(0,5,by=0.1)
# ygrid_acgm = acgm.linkfunction.estim(xgrid,data.X,data.Y,bandwidth)
#
# plot(xgrid,ygrid_acgm,type='l',lty=1,lwd=2,xlab='X',ylab='Y',ylim=c(0.25,2.5))
# lines(xgrid,0.2*xgrid^2-xgrid+2,lwd=0.5,col='gray')
</code></pre>

<hr>
<h2 id='acgm.statistics'>Local test statistic for the regression function</h2><span id='topic+acgm.statistics'></span>

<h3>Description</h3>

<p>This function computes the local test statistic for the regression function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>acgm.statistics(data.X, data.Y, linkfunction.H0,
		bandwidth = "optimal",
		kernel.function = kernel.function.epan,
		integration.step = 0.01,
		verbose = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acgm.statistics_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function.</p>
</td></tr>
<tr><td><code id="acgm.statistics_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function.</p>
</td></tr>
<tr><td><code id="acgm.statistics_+3A_linkfunction.h0">linkfunction.H0</code></td>
<td>
<p>the regression function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="acgm.statistics_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth used to obtain the nonparametric estimator of the regression function. If <code>bandwidth</code> = &quot;optimal&quot;, the optimal bandwidth of the regression function under the null hypothesis is computed. Default option is &quot;optimal&quot;.</p>
</td></tr>
<tr><td><code id="acgm.statistics_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of theregression function. Default option is &quot;kernel.function.epan&quot;.</p>
</td></tr>
<tr><td><code id="acgm.statistics_+3A_integration.step">integration.step</code></td>
<td>
<p>a numeric value specifying integration step. Default is <code>integration.step</code> = 0.01.</p>
</td></tr>
<tr><td><code id="acgm.statistics_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the R function displays the optimal bandwidth value obtained under the null hypothesis. Default option is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>J. T. Alcala, J. A. Cristobal, and W. Gonzalez Manteiga. Goodness-of-fit test for linear
models based on local polynomials. <em>Statistics &amp; Probability Letters</em>, 42(1), 39:46, 1999.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Bandwidth selection under H0
#
# # We want to test if the link function is f(x)=0.2*x^2-x+2
# # The answer is yes (see the definition of data.Y above)
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# data.X.H0 = runif(n,min=0,max=5)
# data.Y.H0 = linkfunction.H0(data.X.H0)+rnorm(n,mean=0,sd=0.3)
#
# h.opt.acgm = acgm.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
#
# ########################################################################
#
# # Test statistics under H0
#
# acgm.statistics(data.X,data.Y,linkfunction.H0,h.opt.acgm)
</code></pre>

<hr>
<h2 id='acgm.test.bootstrap'>Local test for the regression function</h2><span id='topic+acgm.test.bootstrap'></span>

<h3>Description</h3>

<p>A local test for the regression function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>acgm.test.bootstrap(data.X, data.Y, linkfunction.H0, risk,
	 bandwidth = "optimal",
   kernel.function = kernel.function.epan,
   bootstrap = c(50, "Mammen"),
   integration.step = 0.01,
   verbose=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acgm.test.bootstrap_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function.</p>
</td></tr>
<tr><td><code id="acgm.test.bootstrap_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function.</p>
</td></tr>
<tr><td><code id="acgm.test.bootstrap_+3A_linkfunction.h0">linkfunction.H0</code></td>
<td>
<p>the regression function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="acgm.test.bootstrap_+3A_risk">risk</code></td>
<td>
<p>a numeric value specifying the risk of rejecting the null hypothesis. The value (1-risk) corresponds to the confidence level of the statistical test.</p>
</td></tr>
<tr><td><code id="acgm.test.bootstrap_+3A_bandwidth">bandwidth</code></td>
<td>
<p>the bandwidth used to obtain the nonparametric estimator of the regression function. If <code>bandwidth</code> = &quot;optimal&quot;, the optimal bandwidth of the regression function under the null hypothesis is computed. Default option is &quot;optimal&quot;.</p>
</td></tr>
<tr><td><code id="acgm.test.bootstrap_+3A_kernel.function">kernel.function</code></td>
<td>
<p>the kernel function used to obtain the nonparametric estimator of the regression function. Default option is &quot;kernel.function.epan&quot;.</p>
</td></tr>
<tr><td><code id="acgm.test.bootstrap_+3A_bootstrap">bootstrap</code></td>
<td>
<p>a numeric vector of length 2. The first value specifies the number of bootstrap datasets (default is &quot;50&quot;). The second value specifies the distribution used for the wild bootstrap resampling.The default is &quot;Mammen&quot; and the other options are &quot;Rademacher&quot; or &quot;Gaussian&quot;.</p>
</td></tr>
<tr><td><code id="acgm.test.bootstrap_+3A_integration.step">integration.step</code></td>
<td>
<p>a numeric value specifying integration step. Default is <code>integration.step</code> = 0.01.</p>
</td></tr>
<tr><td><code id="acgm.test.bootstrap_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the R function displays the optimal bandwidth value obtained under the null hypothesis. Default option is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From <code>data.X</code> and <code>data.Y</code> datasets, wild bootstrap datasets (&quot;50&quot; by default) are built. From each bootstrap dataset, a bootstrap test statistic is computed. The test statistic under the null hypothesis is compared to the distribution of the bootstrap statistics. The test is rejected if the test statistic under the null hypothesis is greater than the (1-<code>risk</code>)-quantile of the empirical distribution of the bootstrap statistics.
</p>
<p>An inappropriate bandwidth choice can produce &quot;NaN&quot; values in test statistics.
</p>


<h3>Value</h3>

<p><code>acgm.test.bootstrap</code> returns a list containing the following components:
</p>
<table>
<tr><td><code>decision</code></td>
<td>
<p>the statistical decision made on whether to reject the null hypothesis or not.</p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>the bandwidth used to build the statistics test.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>the p-value of the test statistics.</p>
</td></tr>
<tr><td><code>test_statistics</code></td>
<td>
<p>the test statistics value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>J. T. Alcala, J. A. Cristobal, and W. Gonzalez Manteiga. Goodness-of-fit test for linear
models based on local polynomials. <em>Statistics &amp; Probability Letters</em>, 42(1), 39:46, 1999.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Test (bootstrap) under H0
#
# # We want to test if the link function is f(x)=0.2*x^2-x+2
# # The answer is yes (see the definition of data.Y above)
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# test_acgm.H0 = acgm.test.bootstrap(data.X,data.Y,linkfunction.H0,
#                                    0.05,bandwidth='optimal',bootstrap=c(50,'Mammen'),
#                                    integration.step = 0.01)
#
#
# ########################################################################
#
# # Test (bootstrap) under H1
#
# # We want to test if the link function is f(x)=0.5*cos(x)+1
# # The answer is no (see the definition of data.Y above)
#
# linkfunction.H1=function(x){0.8*cos(x)+1}
#
# test_acgm.H1 = acgm.test.bootstrap(data.X,data.Y,linkfunction.H1,0.05,
#                                    bandwidth='optimal',bootstrap=c(50,'Mammen'),
#                                    integration.step = 0.01)
</code></pre>

<hr>
<h2 id='cvmgof'>cvmgof</h2><span id='topic+cvmgof-package'></span><span id='topic+cvmgof'></span>

<h3>Description</h3>

<p>It implements three goodness-of-fit tests to test the validity of the regression function in the regression model. Two of them (Alcala <em>et al.</em> '99 and Van Keilegom <em>et al.</em> '12) are &ldquo;directional&rdquo; in that they detect departures from mainly the regression function assumption of the model or &ldquo;global&rdquo; (Ducharme and Ferrigno '12) with the conditional distribution function. The establishment of such statistical tests requires nonparametric estimators and the use of wild bootstrap methods for the simulations.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> cvmgof</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-01-11</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Cecill</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>J. T. Alcala, J. A. Cristobal, and W. Gonzalez Manteiga. Goodness-of-fit test for linear
models based on local polynomials. <em>Statistics &amp; Probability Letters</em>, 42(1), 39:46, 1999.
</p>
<p>G. R. Ducharme and S. Ferrigno. An omnibus test of goodness-of-fit for conditional distributions
with applications to regression models. <em>Journal of Statistical Planning and
Inference</em>, 142, 2748:2761, 2012.
</p>
<p>I. Van Keilegom, W. Gonzalez Manteiga, and C. Sanchez Sellero. Goodness-of-fit tests in
parametric regression based on the estimation of the error distribution. <em>Test</em>, 17, 401:415,
2008.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+acgm.test.bootstrap">acgm.test.bootstrap</a></code>
</p>
<p><code><a href="#topic+df.test.bootstrap">df.test.bootstrap</a></code>
</p>
<p><code><a href="#topic+vkgmss.test.bootstrap">vkgmss.test.bootstrap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># require(lattice) # Only for plotting conditional CDF

########################################################################
# Simulation

set.seed(1)
# The following example tests are computed from only 25 data points
# The seed is fixed to avoid NA in estimates

# Data simulation
n = 25 # Dataset size
data.X = runif(n,min=0,max=5) # X
data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
# plot(data.X,data.Y,xlab='X',ylab='Y',pch='+')

########################################################################
# Estimation of the link function (uncomment the following code block)

# bandwidth = 0.75 # Here, the bandwidth is arbitrarily fixed
#
# xgrid = seq(0,5,by=0.1)
# ygrid_df = df.linkfunction.estim(xgrid,data.X,data.Y,bandwidth)
# ygrid_acgm = acgm.linkfunction.estim(xgrid,data.X,data.Y,bandwidth)
# ygrid_vkgmss = vkgmss.linkfunction.estim(xgrid,data.X,data.Y,bandwidth)
#
# plot(xgrid,ygrid_df,type='l',col='blue',lty=1,lwd=2,xlab='X',ylab='Y',ylim=c(0.25,2.5))
# lines(xgrid,ygrid_acgm,type='l',col='red',lty=2,lwd=2)
# lines(xgrid,ygrid_vkgmss,type='l',col='dark green',lty=3,lwd=2)
# lines(xgrid,0.2*xgrid^2-xgrid+2,lwd=0.5,col='gray')
# # Ducharme and Ferrigno: blue
# # Alcala et al.: red
# # Van Keilegom et al.: dark green
# # true link function: gray
#
# # Estimation of the conditional CDF (only Ducharme and Ferrigno estimator)
# xgrid = seq(0.5,4.5,by=0.1)
# ygrid = seq(-1,3,by=0.1)
# cdf_df = df.cdf.estim(xgrid,ygrid,data.X,data.Y,bandwidth)
#
# wireframe(cdf_df, drape=TRUE,
#           col.regions=rainbow(100),
#           zlab='CDF(y|x)',
#           xlab='x',ylab='y',zlim=c(0,1.01))
#
# # Estimation of residuals cdf (only Van Keilegom et al. estimator)
#
# egrid = seq(-5,5,by=0.1)
# res.cdf_vkgmss = vkgmss.residuals.cdf.estim(egrid,data.X,data.Y,0.5)
#
# plot(egrid,res.cdf_vkgmss,type='l',xlab='e',ylab='CDF(e)')
#
# # Estimation of residuals standard deviation (only Van Keilegom et al. estimator)
#
# sd_vkgmss = vkgmss.sd.estim(xgrid,data.X,data.Y,bandwidth)
#
# plot(xgrid,sd_vkgmss, type='l',xlab='X',ylab='SD(X)')
# abline(h=0.3)

########################################################################
# Bandwidth selection under H0 (uncomment the following code block)

# # We want to test if the link function is f(x)=0.2*x^2-x+2
# # The answer is yes (see the definition of data.Y above)
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# data.X.H0 = runif(n,min=0,max=5)
# data.Y.H0 = linkfunction.H0(data.X.H0)+rnorm(n,mean=0,sd=0.3)
#
# h.opt.df = df.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
# h.opt.acgm = acgm.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
# h.opt.vkgmss = vkgmss.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
# # Ducharme and Ferrigno: 1.184604
# # Alcala et al.: 0.7716453
# # Van Keilegom et al.: 0.6780543

########################################################################
# Test statistics under H0 (uncomment the following code block)

# # Remainder:
# # Ducharme and Ferrigno test is on the conditional CDF and not on the link function
# # Thus we need to define the conditional CDF associated
# # with the link function under H0 to evaluate this test
# # Alcala et al. and Van Keilegom et al. tests are on the link function
#
# # Optimal bandwidths estimated at the previous step
# h.opt.df = 1.184604
# h.opt.acgm = 0.7716453
# h.opt.vkgmss = 0.6780543
#
# cond_cdf.H0 = function(x,y)
# {
#   out=matrix(0,nrow=length(x),ncol=length(y))
#   for (i in 1:length(x)){
#     x0=x[i]
#     out[i,]=pnorm(y-linkfunction.H0(x0),0,0.3)
#   }
#   out
# }
# # cond_cdf.H0 is the conditional CDF associated with linkfunction.H0
# # with additive Gaussian noise (standard deviation=0.3)
#
# df.statistics(data.X,data.Y,cond_cdf.H0,h.opt.df)
# acgm.statistics(data.X,data.Y,linkfunction.H0,h.opt.acgm)
# vkgmss.statistics(data.X,data.Y,linkfunction.H0,h.opt.vkgmss)

########################################################################
# Test (bootstrap) under H0

h.opt.df = 1.184604 # Optimal bandwidth estimated above

linkfunction.H0 = function(x){0.2*x^2-x+2}
cond_cdf.H0 = function(x,y)
{
  out=matrix(0,nrow=length(x),ncol=length(y))
  for (i in 1:length(x)){
    x0=x[i]
    out[i,]=pnorm(y-linkfunction.H0(x0),0,0.3)
  }
  out
}

test_df.H0 = df.test.bootstrap(data.X,data.Y,cond_cdf.H0,
                               0.05,h.opt.df,bootstrap=c(20,'Mammen'),
                               integration.step = 0.1)
test_acgm.H0 = acgm.test.bootstrap(data.X,data.Y,linkfunction.H0,
                                   0.05,bandwidth='optimal',bootstrap=c(20,'Mammen'),
                                   verbose=FALSE,integration.step = 0.1)
test_vkgmss.H0 = vkgmss.test.bootstrap(data.X,data.Y,linkfunction.H0,
                                       0.05,bandwidth='optimal',bootstrap=c(20,'Mammen'),
                                       verbose=FALSE)

# test_acgm$decision is a string: 'accept H0' or 'reject H0'
# test_acgm$bandwidth is a float (optimal bandwidth under H0
# (only for Alcala and Van Keilegom tests) if bandwidth = 'optimal')
# test_acgm$pvalue is a float but it could be a string
# ('&lt; 0.02' for instance or 'None' if the test can not be evaluated)
# test_acgm$test_statistics is a float but it could be a string
# ('None' if the test can not be evaluated)

# The 3 tests accept H0

########################################################################
# Test (bootstrap) under H1 (uncomment the following code block)

# # We want to test if the link function is f(x)=0.5*cos(x)+1
# # The answer is no (see the definition of data.Y above)
#
# linkfunction.H1=function(x){0.8*cos(x)+1}
#
# plot(xgrid,linkfunction.H0(xgrid),type='l',ylim=c(-1,2))
# lines(xgrid,linkfunction.H1(xgrid),type='l')
#
# data.X.H1 = data.X.H0
# data.Y.H1 = linkfunction.H1(data.X.H1)+rnorm(n,mean=0,sd=0.3)
# h.opt.df = df.bandwidth.selection.linkfunction(data.X.H1, data.Y.H1,linkfunction.H1)
#
# cond_cdf.H1=function(x,y)
# {
#   out=matrix(0,nrow=length(x),ncol=length(y))
#   for (i in 1:length(x)){
#     x0=x[i]
#     out[i,]=pnorm(y-linkfunction.H1(x0),0,0.3)
#   }
#   out
# }
#
# test_df.H1 = df.test.bootstrap(data.X,data.Y,cond_cdf.H1,
#                                0.05,h.opt.df,bootstrap=c(20,'Mammen'),
#                                integration.step = 0.1)
# test_acgm.H1 = acgm.test.bootstrap(data.X,data.Y,linkfunction.H1,
#                                    0.05,bandwidth='optimal',bootstrap=c(20,'Mammen'),
#                                    integration.step = 0.1,verbose=FALSE)
# test_vkgmss.H1 = vkgmss.test.bootstrap(data.X,data.Y,linkfunction.H1,
#                                        0.05,bandwidth='optimal',bootstrap=c(20,'Mammen'),
#                                        verbose=FALSE)
#
# # From only 25 points, only Van Keilegom et al. test rejects H0
# # while Ducharme and Ferrigno and Alcala et al. tests accept H0

########################################################################
</code></pre>

<hr>
<h2 id='df.bandwidth.selection.linkfunction'>Bandwidth selection of the link function under the null hypothesis</h2><span id='topic+df.bandwidth.selection.linkfunction'></span>

<h3>Description</h3>

<p>This function computes the optimal bandwidth of the link function under the null hypothesis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0, linkfunction.H0,
		kernel.function = kernel.function.epan, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df.bandwidth.selection.linkfunction_+3A_data.x.h0">data.X.H0</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="df.bandwidth.selection.linkfunction_+3A_data.y.h0">data.Y.H0</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="df.bandwidth.selection.linkfunction_+3A_linkfunction.h0">linkfunction.H0</code></td>
<td>
<p>regression function under the null hypothesis</p>
</td></tr>
<tr><td><code id="df.bandwidth.selection.linkfunction_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the conditional distribution function. Default option is &quot;kernel.function.epan&quot; which corresponds to the Epanechnikov kernel function.</p>
</td></tr>
<tr><td><code id="df.bandwidth.selection.linkfunction_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the R function plots the link function (regression function) under the null hypothesis and the local linear link function estimation on a same graph. Default option is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>G. R. Ducharme and S. Ferrigno. An omnibus test of goodness-of-fit for conditional distributions
with applications to regression models. <em>Journal of Statistical Planning and
Inference</em>, 142, 2748:2761, 2012.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Bandwidth selection under H0
#
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# data.X.H0 = runif(n,min=0,max=5)
# data.Y.H0 = linkfunction.H0(data.X.H0)+rnorm(n,mean=0,sd=0.3)
#
# h.opt.df = df.bandwidth.selection.linkfunction(data.X.H0 , data.Y.H0,linkfunction.H0)
</code></pre>

<hr>
<h2 id='df.cdf.estim'>Local linear estimation of the conditional distribution function</h2><span id='topic+df.cdf.estim'></span>

<h3>Description</h3>

<p>This function computes the local linear estimation of the conditional distribution function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.cdf.estim(x, y, data.X, data.Y, bandwidth, kernel.function = kernel.function.epan)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df.cdf.estim_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="df.cdf.estim_+3A_y">y</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="df.cdf.estim_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.cdf.estim_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.cdf.estim_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.cdf.estim_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the conditional distribution function. Default option is &quot;kernel.function.epan&quot; which corresponds to the Epanechnikov kernel function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inappropriate bandwidth, x or y choices can produce &quot;NaN&quot; values in cumulative distribution function estimates.</p>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>G. R. Ducharme and S. Ferrigno. An omnibus test of goodness-of-fit for conditional distributions
with applications to regression models. <em>Journal of Statistical Planning and
Inference</em>, 142, 2748:2761, 2012.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)

require(lattice) # Only for plotting conditional CDF

# Data simulation
n = 25 # Dataset size
data.X = runif(n,min=0,max=5) # X
data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y

########################################################################

# Estimation of the link function

bandwidth = 0.75 # Here, the bandwidth is arbitrarily fixed

# Estimation of the conditional CDF
xgrid = seq(0.5,4.5,by=0.1)
ygrid = seq(-1,3,by=0.1)
cdf_df = df.cdf.estim(xgrid,ygrid,data.X,data.Y,bandwidth)

wireframe(cdf_df, drape=TRUE,
          col.regions=rainbow(100),zlab='CDF(y|x)',xlab='x',ylab='y',zlim=c(0,1.01))
</code></pre>

<hr>
<h2 id='df.linkfunction.estim'>Local linear estimation of the regression function</h2><span id='topic+df.linkfunction.estim'></span>

<h3>Description</h3>

<p>This function computes the local linear estimation of the regression function using the local linear estimation of the conditional distribution function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.linkfunction.estim(x, data.X, data.Y, bandwidth,
		kernel.function = kernel.function.epan)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df.linkfunction.estim_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="df.linkfunction.estim_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.linkfunction.estim_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.linkfunction.estim_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.linkfunction.estim_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the conditional distribution function. Default option is &quot;kernel.function.epan&quot; which corresponds to the Epanechnikov kernel function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inappropriate bandwidth or x choices can produce &quot;NaN&quot; values in link function estimates.</p>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>G. R. Ducharme and S. Ferrigno. An omnibus test of goodness-of-fit for conditional distributions
with applications to regression models. <em>Journal of Statistical Planning and
Inference</em>, 142, 2748:2761, 2012.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Estimation of the link function
#
# bandwidth = 0.75 # Here, the bandwidth is arbitrarily fixed
#
# xgrid = seq(0,5,by=0.1)
# ygrid_df = df.linkfunction.estim(xgrid,data.X,data.Y,bandwidth)
#
# plot(xgrid,ygrid_df,type='l',lty=1,lwd=2,xlab='X',ylab='Y',ylim=c(0.25,2.5))
# lines(xgrid,0.2*xgrid^2-xgrid+2,lwd=0.5,col='gray')
</code></pre>

<hr>
<h2 id='df.statistics'>Global test statistic for the conditional distribution function</h2><span id='topic+df.statistics'></span>

<h3>Description</h3>

<p>This function computes the global test statistic for the conditional distribution function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.statistics(data.X, data.Y, cdf.H0, bandwidth,
    kernel.function = kernel.function.epan, integration.step = 0.01)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df.statistics_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.statistics_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.statistics_+3A_cdf.h0">cdf.H0</code></td>
<td>
<p>the conditional distribution function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="df.statistics_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.statistics_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the conditional distribution function. Default option is &quot;kernel.function.epan&quot;.</p>
</td></tr>
<tr><td><code id="df.statistics_+3A_integration.step">integration.step</code></td>
<td>
<p>a numeric value specifying integration step. Default is <code>integration.step</code> = 0.01.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An inappropriate bandwidth choice can produce &quot;NaN&quot; values in cumulative distribution function estimates.</p>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>G. R. Ducharme and S. Ferrigno. An omnibus test of goodness-of-fit for conditional distributions
with applications to regression models. <em>Journal of Statistical Planning and
Inference</em>, 142, 2748:2761, 2012.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Bandwidth selection under H0
#
# # We want to test if the link function is f(x)=0.2*x^2-x+2
# # The answer is yes (see the definition of data.Y above)
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# data.X.H0 = runif(n,min=0,max=5)
# data.Y.H0 = linkfunction.H0(data.X.H0)+rnorm(n,mean=0,sd=0.3)
#
# h.opt.df = df.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
#
# ########################################################################
#
# # Test statistics under H0
#
# cond_cdf.H0 = function(x,y)
# {
#   out=matrix(0,nrow=length(x),ncol=length(y))
#   for (i in 1:length(x)){
#     x0=x[i]
#     out[i,]=pnorm(y-linkfunction.H0(x0),0,0.3)
#   }
#   out
# }
# # cond_cdf.H0 is the conditional CDF associated with linkfunction.H0
# # with additive Gaussian noise (standard deviation=0.3)
#
# df.statistics(data.X,data.Y,cond_cdf.H0,h.opt.df)
</code></pre>

<hr>
<h2 id='df.test.bootstrap'>Global test for the conditional distribution function</h2><span id='topic+df.test.bootstrap'></span>

<h3>Description</h3>

<p>A global test for the conditional distribution function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.test.bootstrap(data.X, data.Y, cdf.H0, risk, bandwidth,
    kernel.function = kernel.function.epan,
    bootstrap = c(50, "Mammen"),
    integration.step = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df.test.bootstrap_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.test.bootstrap_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.test.bootstrap_+3A_cdf.h0">cdf.H0</code></td>
<td>
<p>the conditional distribution function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="df.test.bootstrap_+3A_risk">risk</code></td>
<td>
<p>a numeric value specifying the risk of rejecting the null hypothesis. The value (1-<code>risk</code>) corresponds to the confidence level of the statistical test.</p>
</td></tr>
<tr><td><code id="df.test.bootstrap_+3A_bandwidth">bandwidth</code></td>
<td>
<p>the bandwidth used to obtain the nonparametric estimator of the conditional distribution function.</p>
</td></tr>
<tr><td><code id="df.test.bootstrap_+3A_kernel.function">kernel.function</code></td>
<td>
<p>the kernel function used to obtain the nonparametric estimator of the conditional distribution function. Default option is &quot;kernel.function.epan&quot;.</p>
</td></tr>
<tr><td><code id="df.test.bootstrap_+3A_bootstrap">bootstrap</code></td>
<td>
<p>a numeric vector of length 2. The first value specifies the number of bootstrap datasets (default is &quot;50&quot;). The second value specifies the distribution used for the wild bootstrap resampling.The default is &quot;Mammen&quot; and the other options are &quot;Rademacher&quot; or &quot;Gaussian&quot;.</p>
</td></tr>
<tr><td><code id="df.test.bootstrap_+3A_integration.step">integration.step</code></td>
<td>
<p>a numeric value specifying integration step. Default is <code>integration.step</code> = 0.01.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From <code>data.X</code> and <code>data.Y</code> datasets, wild bootstrap datasets (&quot;50&quot; by default) are built. From each bootstrap dataset, a bootstrap test statistic is computed. The test statistic under the null hypothesis is compared to the distribution of the bootstrap statistics. The test is rejected if the test statistic under the null hypothesis is greater than the (1-<code>risk</code>)-quantile of the empirical distribution of the bootstrap statistics.
</p>
<p>An inappropriate bandwidth choice can produce &quot;NaN&quot; values in test statistics.
</p>


<h3>Value</h3>

<p><code>df.test.bootstrap</code> returns a list containing the following components:
</p>
<table>
<tr><td><code>decision</code></td>
<td>
<p>the statistical decision made on whether to reject the null hypothesis or not.</p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>the bandwidth used to build the statistics test.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>the p-value of the test statistics.</p>
</td></tr>
<tr><td><code>test_statistics</code></td>
<td>
<p>the test statistics value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>G. R. Ducharme and S. Ferrigno. An omnibus test of goodness-of-fit for conditional distributions
with applications to regression models. <em>Journal of Statistical Planning and
Inference</em>, 142, 2748:2761, 2012.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
#
# ########################################################################
#
# # Bandwidth selection under H0
#
# # We want to test if the link function is f(x)=0.2*x^2-x+2
# # The answer is yes (see the definition of data.Y above)
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# data.X.H0 = runif(n,min=0,max=5)
# data.Y.H0 = linkfunction.H0(data.X.H0)+rnorm(n,mean=0,sd=0.3)
#
# h.opt.df = df.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
#
# ########################################################################
#
# # Test (bootstrap) under H0
#
# # Remainder:
# # Ducharme and Ferrigno test is on the conditional CDF and not on the link function
# # Thus we need to define the conditional CDF associated
# # with the link function under H0 to evaluate this test
#
# cond_cdf.H0 = function(x,y)
# {
#   out=matrix(0,nrow=length(x),ncol=length(y))
#   for (i in 1:length(x)){
#     x0=x[i]
#     out[i,]=pnorm(y-linkfunction.H0(x0),0,0.3)
#   }
#   out
# }
# # cond_cdf.H0 is the conditional CDF associated with linkfunction.H0
# # with additive Gaussian noise (standard deviation=0.3)
#
# # Test (bootstrap) under H0
#
# test_df.H0 = df.test.bootstrap(data.X,data.Y,cond_cdf.H0,
#                                0.05,h.opt.df,bootstrap=c(50,'Mammen'),
#                                integration.step = 0.01)
#
# ########################################################################
#
# # Test (bootstrap) under H1
#
# # We want to test if the link function is f(x)=0.5*cos(x)+1
# # The answer is no (see the definition of data.Y above)
#
# linkfunction.H1=function(x){0.8*cos(x)+1}
#
# data.X.H1 = data.X.H0
# data.Y.H1 = linkfunction.H1(data.X.H1)+rnorm(n,mean=0,sd=0.3)
# h.opt.df = df.bandwidth.selection.linkfunction(data.X.H1, data.Y.H1,linkfunction.H1)
#
# cond_cdf.H1=function(x,y)
# {
#   out=matrix(0,nrow=length(x),ncol=length(y))
#   for (i in 1:length(x)){
#     x0=x[i]
#     out[i,]=pnorm(y-linkfunction.H1(x0),0,0.3)
#   }
#   out
# }
#
# test_df.H1 = df.test.bootstrap(data.X,data.Y,cond_cdf.H1,
#                                0.05,h.opt.df,bootstrap=c(50,'Mammen'),
#                                integration.step = 0.01)
</code></pre>

<hr>
<h2 id='kernel.function.epan'>Epanechnikov kernel</h2><span id='topic+kernel.function.epan'></span>

<h3>Description</h3>

<p>This function computes the Epanechnikov kernel used to estimate the conditional distribution function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel.function.epan(u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel.function.epan_+3A_u">u</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>J. Fan and I. Gijbels. Local polynomial modelling and its applications. <em>Chapman &amp; Hall</em>,
London, 1996.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = runif(10)  #simulating a uniform random sample
kernel.function.epan(x)
</code></pre>

<hr>
<h2 id='kernel.function.gauss'>Gaussian kernel</h2><span id='topic+kernel.function.gauss'></span>

<h3>Description</h3>

<p>This function computes the Gaussian kernel used to estimate the conditional distribution function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel.function.gauss(u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel.function.gauss_+3A_u">u</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>J. Fan and I. Gijbels. Local polynomial modelling and its applications. <em>Chapman &amp; Hall</em>,
London, 1996.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = runif(10)  #simulating a uniform random sample
kernel.function.gauss(x)
</code></pre>

<hr>
<h2 id='kernel.function.quart'>Quartic kernel</h2><span id='topic+kernel.function.quart'></span>

<h3>Description</h3>

<p>This function computes the Quartic kernel used to estimate the conditional distribution function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernel.function.quart(u)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kernel.function.quart_+3A_u">u</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>J. Fan and I. Gijbels. Local polynomial modelling and its applications. <em>Chapman &amp; Hall</em>,
London, 1996.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = runif(10)  # simulating a uniform random sample
kernel.function.quart(x)
</code></pre>

<hr>
<h2 id='vkgmss.bandwidth.selection.linkfunction'>Bandwidth selection of the link function under the null hypothesis</h2><span id='topic+vkgmss.bandwidth.selection.linkfunction'></span>

<h3>Description</h3>

<p>This function computes the optimal bandwidth of the link function under the null hypothesis</p>


<h3>Usage</h3>

<pre><code class='language-R'>vkgmss.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0, linkfunction.H0,
		kernel.function = kernel.function.epan, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vkgmss.bandwidth.selection.linkfunction_+3A_data.x.h0">data.X.H0</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="vkgmss.bandwidth.selection.linkfunction_+3A_data.y.h0">data.Y.H0</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the regression function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="vkgmss.bandwidth.selection.linkfunction_+3A_linkfunction.h0">linkfunction.H0</code></td>
<td>
<p>regression function under the null hypothesis</p>
</td></tr>
<tr><td><code id="vkgmss.bandwidth.selection.linkfunction_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the regression function. Default option is &quot;kernel.function.epan&quot; which corresponds to the Epanechnikov kernel function.</p>
</td></tr>
<tr><td><code id="vkgmss.bandwidth.selection.linkfunction_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the R function plots the link function (regression function) under the null hypothesis and the nonparametric link function estimation on a same graph. Default option is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>I. Van Keilegom, W. Gonzalez Manteiga, and C. Sanchez Sellero. Goodness-of-fit tests in
parametric regression based on the estimation of the error distribution. <em>Test</em>, 17, 401:415,
2008.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Bandwidth selection under H0
#
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# data.X.H0 = runif(n,min=0,max=5)
# data.Y.H0 = linkfunction.H0(data.X.H0)+rnorm(n,mean=0,sd=0.3)
#
# h.opt.vkgmss = vkgmss.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
</code></pre>

<hr>
<h2 id='vkgmss.linkfunction.estim'>Kernel estimation of the regression function</h2><span id='topic+vkgmss.linkfunction.estim'></span>

<h3>Description</h3>

<p>This function computes the kernel (Nadaraya-Watson) estimation of the regression function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>vkgmss.linkfunction.estim(x, data.X, data.Y, bandwidth,
		kernel.function = kernel.function.epan)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vkgmss.linkfunction.estim_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="vkgmss.linkfunction.estim_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the kernel estimator of the regression function.</p>
</td></tr>
<tr><td><code id="vkgmss.linkfunction.estim_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the kernel estimator of the regression function.</p>
</td></tr>
<tr><td><code id="vkgmss.linkfunction.estim_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth used to obtain the kernel estimator of the regression function.</p>
</td></tr>
<tr><td><code id="vkgmss.linkfunction.estim_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the kernel estimator of the regression function. Default option is &quot;kernel.function.epan&quot; which corresponds to the Epanechnikov kernel function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inappropriate bandwidth or x choices can produce &quot;NaN&quot; values in link function estimates.</p>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>I. Van Keilegom, W. Gonzalez Manteiga, and C. Sanchez Sellero. Goodness-of-fit tests in
parametric regression based on the estimation of the error distribution. <em>Test</em>, 17, 401:415,
2008.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Estimation of the link function
#
# bandwidth = 0.75 # Here, the bandwidth is arbitrarily fixed
#
# xgrid = seq(0,5,by=0.1)
# ygrid_vkgmss = vkgmss.linkfunction.estim(xgrid,data.X,data.Y,bandwidth)
#
# plot(xgrid,ygrid_vkgmss,type='l',lty=1,lwd=2,xlab='X',ylab='Y',ylim=c(0.25,2.5))
# lines(xgrid,0.2*xgrid^2-xgrid+2,lwd=0.5,col='gray')
</code></pre>

<hr>
<h2 id='vkgmss.residuals.cdf.estim'>Kernel estimation of the error distribution</h2><span id='topic+vkgmss.residuals.cdf.estim'></span>

<h3>Description</h3>

<p>This function computes the kernel (Nadaraya-Watson) estimation of the error distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>vkgmss.residuals.cdf.estim(u, data.X, data.Y, bandwidth,
		kernel.function = kernel.function.epan)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vkgmss.residuals.cdf.estim_+3A_u">u</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="vkgmss.residuals.cdf.estim_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the error distribution.</p>
</td></tr>
<tr><td><code id="vkgmss.residuals.cdf.estim_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the error distribution.</p>
</td></tr>
<tr><td><code id="vkgmss.residuals.cdf.estim_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth used to obtain the nonparametric estimator of the error distribution.</p>
</td></tr>
<tr><td><code id="vkgmss.residuals.cdf.estim_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the error distribution. Default option is &quot;kernel.function.epan&quot; which corresponds to the Epanechnikov kernel function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inappropriate bandwidth or u choices can produce &quot;NaN&quot; values in error distribution estimates.</p>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>I. Van Keilegom, W. Gonzalez Manteiga, and C. Sanchez Sellero. Goodness-of-fit tests in
parametric regression based on the estimation of the error distribution. <em>Test</em>, 17, 401:415,
2008.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Estimation of residuals cdf
#
# bandwidth = 0.75 # Here, the bandwidth is arbitrarily fixed
#
# egrid = seq(-5,5,by=0.1)
# res.cdf = vkgmss.residuals.cdf.estim(egrid,data.X,data.Y,0.5)
#
# plot(egrid,res.cdf , type='l',xlab='e',ylab='CDF(e)')
</code></pre>

<hr>
<h2 id='vkgmss.sd.estim'>Kernel estimation of the standard deviation function</h2><span id='topic+vkgmss.sd.estim'></span>

<h3>Description</h3>

<p>This function computes the kernel (Nadaraya-Watson) estimation of the standard deviation function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>vkgmss.sd.estim(x, data.X, data.Y, bandwidth,
		kernel.function = kernel.function.epan)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vkgmss.sd.estim_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="vkgmss.sd.estim_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the kernel estimator of the standard deviation function.</p>
</td></tr>
<tr><td><code id="vkgmss.sd.estim_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the kernel estimator of the standard deviation function.</p>
</td></tr>
<tr><td><code id="vkgmss.sd.estim_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth used to obtain the kernel estimator of the standard deviation function.</p>
</td></tr>
<tr><td><code id="vkgmss.sd.estim_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the kernel estimator of the standard deviation function. Default option is &quot;kernel.function.epan&quot; which corresponds to the Epanechnikov kernel function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Inappropriate bandwidth or x choices can produce &quot;NaN&quot; values in function estimates.</p>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>I. Van Keilegom, W. Gonzalez Manteiga, and C. Sanchez Sellero. Goodness-of-fit tests in
parametric regression based on the estimation of the error distribution. <em>Test</em>, 17, 401:415,
2008.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Estimation of residuals standard deviation
#
# bandwidth = 0.75 # Here, the bandwidth is arbitrarily fixed
#
# xgrid = seq(0,5,by=0.1)
# sd = vkgmss.sd.estim(xgrid,data.X,data.Y,bandwidth)
#
# plot(xgrid,sd , type='l',xlab='X',ylab='SD(X)')
# abline(h=0.3)
</code></pre>

<hr>
<h2 id='vkgmss.statistics'>Local test statistic for the regression function</h2><span id='topic+vkgmss.statistics'></span>

<h3>Description</h3>

<p>This function computes the local test statistic for the regression function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>vkgmss.statistics(data.X, data.Y, linkfunction.H0,
		bandwidth = "optimal", kernel.function = kernel.function.epan,
		verbose=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vkgmss.statistics_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the error distribution.</p>
</td></tr>
<tr><td><code id="vkgmss.statistics_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the error distribution.</p>
</td></tr>
<tr><td><code id="vkgmss.statistics_+3A_linkfunction.h0">linkfunction.H0</code></td>
<td>
<p>the regression function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="vkgmss.statistics_+3A_bandwidth">bandwidth</code></td>
<td>
<p>bandwidth used to obtain the nonparametric estimator of the error distribution. If <code>bandwidth</code>=&quot;optimal&quot;, the optimal bandwidth of the regression function under the null hypothesis is computed. Default option is &quot;optimal&quot;.</p>
</td></tr>
<tr><td><code id="vkgmss.statistics_+3A_kernel.function">kernel.function</code></td>
<td>
<p>kernel function used to obtain the nonparametric estimator of the error distribution. Default option is &quot;kernel.function.epan&quot;.</p>
</td></tr>
<tr><td><code id="vkgmss.statistics_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the R function displays the optimal bandwidth value obtained under the null hypothesis. Default option is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>I. Van Keilegom, W. Gonzalez Manteiga, and C. Sanchez Sellero. Goodness-of-fit tests in
parametric regression based on the estimation of the error distribution. <em>Test</em>, 17, 401:415,
2008.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Bandwidth selection under H0
#
# # We want to test if the link function is f(x)=0.2*x^2-x+2
# # The answer is yes (see the definition of data.Y above)
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# data.X.H0 = runif(n,min=0,max=5)
# data.Y.H0 = linkfunction.H0(data.X.H0)+rnorm(n,mean=0,sd=0.3)
#
# h.opt.vkgmss = vkgmss.bandwidth.selection.linkfunction(data.X.H0, data.Y.H0,linkfunction.H0)
#
# ########################################################################
#
# # Test statistics under H0
#
# vkgmss.statistics(data.X,data.Y,linkfunction.H0,h.opt.vkgmss)
</code></pre>

<hr>
<h2 id='vkgmss.test.bootstrap'>Local test for the regression function</h2><span id='topic+vkgmss.test.bootstrap'></span>

<h3>Description</h3>

<p>A local test for the regression function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>vkgmss.test.bootstrap(data.X, data.Y, linkfunction.H0, risk,
    bandwidth = "optimal", kernel.function = kernel.function.epan,
    bootstrap = c(50, "Mammen"), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vkgmss.test.bootstrap_+3A_data.x">data.X</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the error distribution.</p>
</td></tr>
<tr><td><code id="vkgmss.test.bootstrap_+3A_data.y">data.Y</code></td>
<td>
<p>a numeric data vector used to obtain the nonparametric estimator of the error distribution.</p>
</td></tr>
<tr><td><code id="vkgmss.test.bootstrap_+3A_linkfunction.h0">linkfunction.H0</code></td>
<td>
<p>the regression function under the null hypothesis.</p>
</td></tr>
<tr><td><code id="vkgmss.test.bootstrap_+3A_risk">risk</code></td>
<td>
<p>a numeric value specifying the risk of rejecting the null hypothesis. The value (1-<code>risk</code>) corresponds to the confidence level of the statistical test.</p>
</td></tr>
<tr><td><code id="vkgmss.test.bootstrap_+3A_bandwidth">bandwidth</code></td>
<td>
<p>the bandwidth used to obtain the nonparametric estimator of the error distribution. If <code>bandwidth</code>=&quot;optimal&quot;, the optimal bandwidth of the regression function under the null hypothesis is computed. Default option is &quot;optimal&quot;.</p>
</td></tr>
<tr><td><code id="vkgmss.test.bootstrap_+3A_kernel.function">kernel.function</code></td>
<td>
<p>the kernel function used to obtain the nonparametric estimator of the error distribution. Default option is &quot;kernel.function.epan&quot;.</p>
</td></tr>
<tr><td><code id="vkgmss.test.bootstrap_+3A_bootstrap">bootstrap</code></td>
<td>
<p>a numeric vector of length 2. The first value specifies the number of bootstrap datasets (default is &quot;50&quot;). The second value specifies the distribution used for the wild bootstrap resampling.The default is &quot;Mammen&quot; and the other options are &quot;Rademacher&quot; or &quot;Gaussian&quot;.</p>
</td></tr>
<tr><td><code id="vkgmss.test.bootstrap_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the R function displays the optimal bandwidth value obtained under the null hypothesis. Default option is <code>TRUE</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>From <code>data.X</code> and <code>data.Y</code> datasets, wild bootstrap datasets (&quot;50&quot; by default) are built. From each bootstrap dataset, a bootstrap test statistic is computed. The test statistic under the null hypothesis is compared to the distribution of the bootstrap statistics. The test is rejected if the test statistic under the null hypothesis is greater than the (1-<code>risk</code>)-quantile of the empirical distribution of the bootstrap statistics.
</p>
<p>An inappropriate bandwidth choice can produce &quot;NaN&quot; values in test statistics.
</p>


<h3>Value</h3>

<p><code>vkgmss.test.bootstrap</code> returns a list containing the following components:
</p>
<table>
<tr><td><code>decision</code></td>
<td>
<p>the statistical decision made on whether to reject the null hypothesis or not.</p>
</td></tr>
<tr><td><code>bandwidth</code></td>
<td>
<p>the bandwidth used to build the statistics test.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>the p-value of the test statistics.</p>
</td></tr>
<tr><td><code>test_statistics</code></td>
<td>
<p>the test statistics value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Romain Azais, Sandie Ferrigno and Marie-Jose Martinez</p>


<h3>References</h3>

<p>I. Van Keilegom, W. Gonzalez Manteiga, and C. Sanchez Sellero. Goodness-of-fit tests in
parametric regression based on the estimation of the error distribution. <em>Test</em>, 17, 401:415,
2008.
</p>
<p>R. Azais, S. Ferrigno and M-J Martinez. cvmgof: An R package for Cramer-von Mises goodness-of-fit tests in regression models. Submitted. January 2021.<a href="https://hal.archives-ouvertes.fr/hal-03101612">hal-03101612</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Uncomment the following code block
#
# set.seed(1)
#
# # Data simulation
# n = 25 # Dataset size
# data.X = runif(n,min=0,max=5) # X
# data.Y = 0.2*data.X^2-data.X+2+rnorm(n,mean=0,sd=0.3) # Y
#
# ########################################################################
#
# # Test (bootstrap) under H0
#
# # We want to test if the link function is f(x)=0.2*x^2-x+2
# # The answer is yes (see the definition of data.Y above)
# # We generate a dataset under H0 to estimate the optimal bandwidth under H0
#
# linkfunction.H0 = function(x){0.2*x^2-x+2}
#
# test_vkgmss.H0 = vkgmss.test.bootstrap(data.X,data.Y,linkfunction.H0,
#                                        0.05,bandwidth='optimal',
#                                        bootstrap=c(50,'Mammen'))
#
#
# ########################################################################
#
# # Test (bootstrap) under H1
#
# # We want to test if the link function is f(x)=0.5*cos(x)+1
# # The answer is no (see the definition of data.Y above)
#
# linkfunction.H1=function(x){0.8*cos(x)+1}
#
# test_vkgmss.H1 = vkgmss.test.bootstrap(data.X,data.Y,linkfunction.H1,
#                                        0.05,bandwidth='optimal',
#                                        bootstrap=c(50,'Mammen'))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
