<!DOCTYPE html><html lang="en"><head><title>Help for package GeoTox</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GeoTox}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GeoTox-package'><p>GeoTox: Spatiotemporal Mixture Risk Assessment</p></a></li>
<li><a href='#calc_concentration_response'><p>Calculate the mixture response from one of three different approaches:</p>
IA, GCA, or Hazard Quotient</a></li>
<li><a href='#calc_independent_action'><p>Independent Action</p></a></li>
<li><a href='#calc_internal_dose'><p>Calculate internal chemical dose</p></a></li>
<li><a href='#calc_invitro_concentration'><p>Calculate <em>in vitro</em> concentration</p></a></li>
<li><a href='#calculate_response'><p>Calculate response</p></a></li>
<li><a href='#compute_sensitivity'><p>Compute response sensitivity to parameter variation.</p></a></li>
<li><a href='#fit_hill'><p>Fit 2- or 3-parameter Hill model</p></a></li>
<li><a href='#geo_tox_data'><p>GeoTox Data</p></a></li>
<li><a href='#GeoTox'><p>GeoTox S3 object</p></a></li>
<li><a href='#get_fixed_age'><p>Get <code>C_ss</code> Data for Fixed Age</p></a></li>
<li><a href='#get_fixed_css'><p>Get Fixed <code>C_ss</code> Data</p></a></li>
<li><a href='#get_fixed_obesity'><p>Get <code>C_ss</code> Data for Fixed Obesity Status</p></a></li>
<li><a href='#get_fixed_other'><p>Get median <code>C_ss</code> Values</p></a></li>
<li><a href='#get_fixed_params'><p>Get <code>C_ss</code> Data for Fixed <code>C_ss</code> Generation Parameters</p></a></li>
<li><a href='#hill_conc'><p>Hill model concentration</p></a></li>
<li><a href='#hill_val'><p>Hill model response</p></a></li>
<li><a href='#plot_exposure'><p>Plot exposure data.</p></a></li>
<li><a href='#plot_hill'><p>Plot Hill equation fits.</p></a></li>
<li><a href='#plot_resp'><p>Plot response data</p></a></li>
<li><a href='#plot_sensitivity'><p>Plot results of sensitivity analysis.</p></a></li>
<li><a href='#resp_quantiles'><p>Get response quantiles</p></a></li>
<li><a href='#sample_Css'><p>Sample from pre-generated <code>C_ss</code> data</p></a></li>
<li><a href='#sensitivity_analysis'><p>Perform sensitivity analysis</p></a></li>
<li><a href='#set_boundaries'><p>Set GeoTox boundaries</p></a></li>
<li><a href='#set_hill_params'><p>Set Hill parameters for a GeoTox object.</p></a></li>
<li><a href='#simulate_age'><p>Simulate ages</p></a></li>
<li><a href='#simulate_exposure'><p>Simulate external exposure</p></a></li>
<li><a href='#simulate_inhalation_rate'><p>Simulate inhalation rates</p></a></li>
<li><a href='#simulate_obesity'><p>Simulate obesity status</p></a></li>
<li><a href='#simulate_population'><p>Simulate population data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Spatiotemporal Mixture Risk Assessment</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Connecting spatiotemporal exposure to individual and
    population-level risk via source-to-outcome continuum modeling. The package,
    methods, and case-studies are described in Messier, Reif, and Marvel (2024)
    &lt;<a href="https://doi.org/10.1101%2F2024.09.23.24314096">doi:10.1101/2024.09.23.24314096</a>&gt; and Eccles et al. (2023)
    &lt;<a href="https://doi.org/10.1016%2Fj.scitotenv.2022.158905">doi:10.1016/j.scitotenv.2022.158905</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://niehs.github.io/GeoTox/">https://niehs.github.io/GeoTox/</a>, <a href="https://github.com/NIEHS/GeoTox">https://github.com/NIEHS/GeoTox</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, ggridges, rlang, sf, stats, stringr, tibble,
tidyr, tidyselect, truncnorm, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggpubr, httk, httr2, knitr, purrr, readr, readxl, rmarkdown,
scales, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/NIEHS/GeoTox/issues">https://github.com/NIEHS/GeoTox/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-14 17:29:09 UTC; marvelsw</td>
</tr>
<tr>
<td>Author:</td>
<td>Skylar Marvel <a href="https://orcid.org/0000-0002-2971-9743"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  David Reif <a href="https://orcid.org/0000-0001-7815-6767"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Kyle Messier <a href="https://orcid.org/0000-0001-9508-9623"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Spatiotemporal Exposures and Toxicology Group [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kyle Messier &lt;kyle.messier@nih.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-15 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='GeoTox-package'>GeoTox: Spatiotemporal Mixture Risk Assessment</h2><span id='topic+GeoTox-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Connecting spatiotemporal exposure to individual and population-level risk via source-to-outcome continuum modeling. The package, methods, and case-studies are described in Messier, Reif, and Marvel (2024) <a href="https://doi.org/10.1101/2024.09.23.24314096">doi:10.1101/2024.09.23.24314096</a> and Eccles et al. (2023) <a href="https://doi.org/10.1016/j.scitotenv.2022.158905">doi:10.1016/j.scitotenv.2022.158905</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Kyle Messier <a href="mailto:kyle.messier@nih.gov">kyle.messier@nih.gov</a> (<a href="https://orcid.org/0000-0001-9508-9623">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Skylar Marvel <a href="mailto:skylar.marvel@nih.gov">skylar.marvel@nih.gov</a> (<a href="https://orcid.org/0000-0002-2971-9743">ORCID</a>)
</p>
</li>
<li><p> David Reif <a href="mailto:david.reif@nih.gov">david.reif@nih.gov</a> (<a href="https://orcid.org/0000-0001-7815-6767">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Spatiotemporal Exposures and Toxicology Group [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://niehs.github.io/GeoTox/">https://niehs.github.io/GeoTox/</a>
</p>
</li>
<li> <p><a href="https://github.com/NIEHS/GeoTox">https://github.com/NIEHS/GeoTox</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/NIEHS/GeoTox/issues">https://github.com/NIEHS/GeoTox/issues</a>
</p>
</li></ul>


<hr>
<h2 id='calc_concentration_response'>Calculate the mixture response from one of three different approaches:
IA, GCA, or Hazard Quotient</h2><span id='topic+calc_concentration_response'></span>

<h3>Description</h3>

<p>Calculate the combined response of multiple chemicals. It calculates the
generalized concentration addition response, the independent action
response, and a hazard quotient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_concentration_response(
  C_invitro,
  hill_params,
  max_mult = 1.5,
  fixed = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_concentration_response_+3A_c_invitro">C_invitro</code></td>
<td>
<p>in vitro concentrations</p>
</td></tr>
<tr><td><code id="calc_concentration_response_+3A_hill_params">hill_params</code></td>
<td>
<p>output from <code>fit_hill()</code></p>
</td></tr>
<tr><td><code id="calc_concentration_response_+3A_max_mult">max_mult</code></td>
<td>
<p>upper bound multiplier for max response</p>
</td></tr>
<tr><td><code id="calc_concentration_response_+3A_fixed">fixed</code></td>
<td>
<p>if TRUE, sd = 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of data frames
</p>


<h3>Examples</h3>

<pre><code class='language-R'>C_invitro &lt;- list(
  matrix(1:8 / 1e3, ncol = 2, dimnames = list(NULL, c("c1", "c2"))),
  matrix(9:16 / 1e3, ncol = 2, dimnames = list(NULL, c("c1", "c2")))
)
hill_params &lt;- fit_hill(
  data.frame(chem = rep(c("c1", "c2"), each = 3),
             logc = c(-1, 0, 1, 0, 1, 2),
             resp = c(10, 5, 0, 4, 2, 0) / 10),
  chem = "chem"
)

calc_concentration_response(C_invitro, hill_params)
calc_concentration_response(C_invitro, hill_params, fixed = TRUE)
</code></pre>

<hr>
<h2 id='calc_independent_action'>Independent Action</h2><span id='topic+calc_independent_action'></span>

<h3>Description</h3>

<p>Calculate independent action response for a set of chemicals with Hill
concentration-response curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_independent_action(conc, max, AC50, Emax, n = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_independent_action_+3A_conc">conc</code></td>
<td>
<p>concentrations in regular space</p>
</td></tr>
<tr><td><code id="calc_independent_action_+3A_max">max</code></td>
<td>
<p>maximal (asymptotic) responses</p>
</td></tr>
<tr><td><code id="calc_independent_action_+3A_ac50">AC50</code></td>
<td>
<p>concentrations of half-maximal response</p>
</td></tr>
<tr><td><code id="calc_independent_action_+3A_emax">Emax</code></td>
<td>
<p>maximum mixture response</p>
</td></tr>
<tr><td><code id="calc_independent_action_+3A_n">n</code></td>
<td>
<p>Hill coefficients (slopes)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The concentration is computed as:
</p>
<p style="text-align: center;"><code class="reqn">
  IA = E_{max} \times
  \left(
    1 - \prod\limits_{i} \left(1 - \frac{x_i}{E_{max}}\right)
  \right),
</code>
</p>

<p>where <code class="reqn">x_i = hill\_val(conc_i, max_i, AC50_i, n_i)</code> is the Hill model
response function for each chemical.
</p>


<h3>Value</h3>

<p>response value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hill_val">hill_val</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n_chem &lt;- 5
conc &lt;- 10^sample(-1:4, n_chem, replace = TRUE)
max &lt;- 80 * runif(n_chem)
AC50 &lt;- 10^(5 * runif(n_chem) - 1)
Emax &lt;- 100

calc_independent_action(conc, max, AC50, Emax)
</code></pre>

<hr>
<h2 id='calc_internal_dose'>Calculate internal chemical dose</h2><span id='topic+calc_internal_dose'></span>

<h3>Description</h3>

<p>Estimate the internal dose from inhalation of a chemical given inhalation
rate, time, and body weight
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_internal_dose(C_ext, IR, time = 1, BW = 1, scaling = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_internal_dose_+3A_c_ext">C_ext</code></td>
<td>
<p>ambient chemical concentration in <code class="reqn">\frac{mg}{m^3}</code></p>
</td></tr>
<tr><td><code id="calc_internal_dose_+3A_ir">IR</code></td>
<td>
<p>inhalation rate in <code class="reqn">\frac{m^3}{day}</code></p>
</td></tr>
<tr><td><code id="calc_internal_dose_+3A_time">time</code></td>
<td>
<p>total time in <code class="reqn">days</code></p>
</td></tr>
<tr><td><code id="calc_internal_dose_+3A_bw">BW</code></td>
<td>
<p>body weight in <code class="reqn">kg</code></p>
</td></tr>
<tr><td><code id="calc_internal_dose_+3A_scaling">scaling</code></td>
<td>
<p>scaling factor encompassing any required unit adjustments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input <code>C_ext</code> must be a matrix or list of matrices. Input <code>IR</code> must be an
atomic vector or list of atomic vectors. The <code>time</code>, <code>BW</code> and <code>scaling</code>
arguments are scalars.
</p>
<p>The internal dose is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">D_{int} = \frac{C_{ext} \times IR \times time}{BW} \times scaling</code>
</p>



<h3>Value</h3>

<p>list of matrices containing internal chemical doses in
<code class="reqn">\frac{mg}{kg}</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single population
C_ext &lt;- matrix(1:15, ncol = 3)
IR &lt;- 1:5
calc_internal_dose(C_ext, IR)

# Multiple populations
C_ext &lt;- list(
  "a" = matrix(1:15 / 10, ncol = 3),
  "b" = matrix(1:8, ncol = 2)
)
IR &lt;- list(1:5, 1:4 / 2)
calc_internal_dose(C_ext, IR)

</code></pre>

<hr>
<h2 id='calc_invitro_concentration'>Calculate <em>in vitro</em> concentration</h2><span id='topic+calc_invitro_concentration'></span>

<h3>Description</h3>

<p>Estimate the <em>in vitro</em> equivalent plasma concentration given internal
chemical dose and steady-state plasma concentration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_invitro_concentration(D_int, C_ss = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_invitro_concentration_+3A_d_int">D_int</code></td>
<td>
<p>internal chemical dose in <code class="reqn">\frac{mg}{kg}</code></p>
</td></tr>
<tr><td><code id="calc_invitro_concentration_+3A_c_ss">C_ss</code></td>
<td>
<p>steady-state plasma concentration in <code class="reqn">\frac{\mu M}{mg / kg}</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input <code>D_int</code> must be a matrix or list of matrices. Input <code>C_ss</code> must be a
numeric atomic vector or matrix, or a list of those types.
</p>
<p>The <em>in vitro</em> equivalent plasma concentration is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">C_{plasma} = C_{ss} \times D_{int}</code>
</p>



<h3>Value</h3>

<p>list of matrices containing concentrations in <code class="reqn">\mu M</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single population
D_int &lt;- matrix(1:15, ncol = 3)
C_ss &lt;- 1:5
calc_invitro_concentration(D_int, C_ss)

# Multiple populations
D_int &lt;- list(
  "a" = matrix(1:15 / 10, ncol = 3),
  "b" = matrix(1:8, ncol = 2)
)
C_ss &lt;- list(1:5, 1:4 / 2)
calc_invitro_concentration(D_int, C_ss)

</code></pre>

<hr>
<h2 id='calculate_response'>Calculate response</h2><span id='topic+calculate_response'></span>

<h3>Description</h3>

<p>Calculate mixture response for GeoTox population data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_response(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_response_+3A_x">x</code></td>
<td>
<p>GeoTox object</p>
</td></tr>
<tr><td><code id="calculate_response_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other functions. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Additional parameters include <code>time</code>, <code>BW</code>, and <code>scaling</code> for
<a href="#topic+calc_internal_dose">calc_internal_dose</a>, and <code>max_mult</code> for <a href="#topic+calc_concentration_response">calc_concentration_response</a>.
</p>


<h3>Value</h3>

<p>The same object with additional fields added or updated
</p>


<h3>See Also</h3>

<p><a href="#topic+calc_internal_dose">calc_internal_dose</a>, <a href="#topic+calc_invitro_concentration">calc_invitro_concentration</a>,
<a href="#topic+calc_concentration_response">calc_concentration_response</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use a subset of the package data for demonstration purposes
set.seed(2357)
n &lt;- 10 # Population size
m &lt;- 5 # Number of regions
idx &lt;- if (m &lt; 100) sample(1:100, m) else 1:100

# Create GeoTox object and populate required fields
geoTox &lt;- GeoTox() |&gt;
  # Simulate populations for each region
  simulate_population(age = split(geo_tox_data$age, ~FIPS)[idx],
                      obesity = geo_tox_data$obesity[idx, ],
                      exposure = split(geo_tox_data$exposure, ~FIPS)[idx],
                      simulated_css = geo_tox_data$simulated_css,
                      n = n) |&gt;
  # Estimated Hill parameters
  set_hill_params(geo_tox_data$dose_response |&gt;
                    fit_hill(assay = "endp", chem = "casn") |&gt;
                    dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed))

# Response computations can now be done
geoTox &lt;- geoTox |&gt; calculate_response()
</code></pre>

<hr>
<h2 id='compute_sensitivity'>Compute response sensitivity to parameter variation.</h2><span id='topic+compute_sensitivity'></span>

<h3>Description</h3>

<p>Compute response sensitivity to parameter variation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_sensitivity(
  x,
  vary = c("age", "obesity", "css_params", "fit_params", "C_ext"),
  max_mult = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_sensitivity_+3A_x">x</code></td>
<td>
<p>GeoTox object.</p>
</td></tr>
<tr><td><code id="compute_sensitivity_+3A_vary">vary</code></td>
<td>
<p>which parameter to vary.</p>
</td></tr>
<tr><td><code id="compute_sensitivity_+3A_max_mult">max_mult</code></td>
<td>
<p>input for <a href="#topic+calc_concentration_response">calc_concentration_response</a> step.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>output from <a href="#topic+calc_concentration_response">calc_concentration_response</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use a subset of the package data for demonstration purposes
set.seed(2357)
n &lt;- 10 # Population size
m &lt;- 5 # Number of regions
idx &lt;- if (m &lt; 100) sample(1:100, m) else 1:100

# Create GeoTox object and populate required fields
geoTox &lt;- GeoTox() |&gt;
  # Simulate populations for each region
  simulate_population(age = split(geo_tox_data$age, ~FIPS)[idx],
                      obesity = geo_tox_data$obesity[idx, ],
                      exposure = split(geo_tox_data$exposure, ~FIPS)[idx],
                      simulated_css = geo_tox_data$simulated_css,
                      n = n) |&gt;
  # Estimated Hill parameters
  set_hill_params(geo_tox_data$dose_response |&gt;
                    fit_hill(assay = "endp", chem = "casn") |&gt;
                    dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed))

# Sensitivity computations can now be done
age_resp &lt;- geoTox |&gt; compute_sensitivity()
obesity_resp &lt;- geoTox |&gt; compute_sensitivity(vary = "obesity")
</code></pre>

<hr>
<h2 id='fit_hill'>Fit 2- or 3-parameter Hill model</h2><span id='topic+fit_hill'></span>

<h3>Description</h3>

<p>Fit 2- or 3-parameter Hill model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_hill(
  x,
  conc = "logc",
  resp = "resp",
  fixed_slope = TRUE,
  chem = NULL,
  assay = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_hill_+3A_x">x</code></td>
<td>
<p>data frame of dose response data.</p>
</td></tr>
<tr><td><code id="fit_hill_+3A_conc">conc</code></td>
<td>
<p>column name of base-10 log scaled concentration.</p>
</td></tr>
<tr><td><code id="fit_hill_+3A_resp">resp</code></td>
<td>
<p>column name of response.</p>
</td></tr>
<tr><td><code id="fit_hill_+3A_fixed_slope">fixed_slope</code></td>
<td>
<p>if TRUE, slope is fixed at 1.</p>
</td></tr>
<tr><td><code id="fit_hill_+3A_chem">chem</code></td>
<td>
<p>(optional) column name of chemical identifiers.</p>
</td></tr>
<tr><td><code id="fit_hill_+3A_assay">assay</code></td>
<td>
<p>(optional) column name of assay identifiers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optional <code>chem</code> and <code>assay</code> identifiers can be used to fit multiple
chemicals and/or assays. Returned columns <code>tp</code> is the top asymptote and
<code>logAC50</code> is the 50% response concentration. If the computation of the
standard deviations of these two parameters fails, then the standard
deviation is set equal to the parameter estimate and is indicated by the
respective imputed flag being TRUE.
</p>


<h3>Value</h3>

<p>data frame of fit parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Multiple assays, multiple chemicals
df &lt;- geo_tox_data$dose_response
fit_hill(df, assay = "endp", chem = "casn")

# Single assay, multiple chemicals
df &lt;- geo_tox_data$dose_response |&gt;
  dplyr::filter(endp == "TOX21_H2AX_HTRF_CHO_Agonist_ratio")
fit_hill(df, chem = "casn")

# Single assay, single chemical
df &lt;- geo_tox_data$dose_response |&gt;
  dplyr::filter(endp == "TOX21_H2AX_HTRF_CHO_Agonist_ratio",
                casn == "510-15-6")
fit_hill(df)
# 3-parameter Hill model
fit_hill(df, fixed_slope = FALSE)
</code></pre>

<hr>
<h2 id='geo_tox_data'>GeoTox Data</h2><span id='topic+geo_tox_data'></span>

<h3>Description</h3>

<p>Sample data for use in vignettes and function examples. See the Package
Data vignette, <code>vignette("package_data", package = "GeoTox")</code>, for
details on how this data was gathered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geo_tox_data
</code></pre>


<h3>Format</h3>

<p>A list with items:
</p>

<dl>
<dt>exposure</dt><dd><p>2019 AirToxScreen exposure concentrations for a subset of
chemicals in North Carolina counties.</p>
</dd>
<dt>dose_response</dt><dd><p>Subset of chemicals curated by ICE cHTS as active
within a set of assays.</p>
</dd>
<dt>age</dt><dd><p>County population estimates for 7/1/2019 in North Carolina.</p>
</dd>
<dt>obesity</dt><dd><p>CDC PLACES obesity data for North Carolina counties in
2020.</p>
</dd>
<dt>simulated_css</dt><dd><p>Simulated steady-state plasma concentrations for
various age groups and obesity status combinations.</p>
</dd>
<dt>boundaries</dt><dd><p>County and state boundaries for North Carolina in 2019.</p>
</dd>
</dl>


<hr>
<h2 id='GeoTox'>GeoTox S3 object</h2><span id='topic+GeoTox'></span><span id='topic+plot.GeoTox'></span>

<h3>Description</h3>

<p>An S3 object that can be used to help organize the data and results of a
GeoTox analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GeoTox()

## S3 method for class 'GeoTox'
plot(x, type = c("resp", "hill", "exposure", "sensitivity"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GeoTox_+3A_x">x</code></td>
<td>
<p>GeoTox object.</p>
</td></tr>
<tr><td><code id="GeoTox_+3A_type">type</code></td>
<td>
<p>type of plot.</p>
</td></tr>
<tr><td><code id="GeoTox_+3A_...">...</code></td>
<td>
<p>arguments passed to subsequent methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a GeoTox S3 object
</p>


<h3>See Also</h3>

<p><a href="#topic+plot_resp">plot_resp</a>, <a href="#topic+plot_hill">plot_hill</a>, <a href="#topic+plot_exposure">plot_exposure</a>, <a href="#topic+plot_sensitivity">plot_sensitivity</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use a subset of the package data for demonstration purposes
set.seed(2357)
n &lt;- 10 # Population size
m &lt;- 5 # Number of regions
idx &lt;- if (m &lt; 100) sample(1:100, m) else 1:100

geoTox &lt;- GeoTox() |&gt; 
  # Set region and group boundaries (for plotting)
  set_boundaries(region = geo_tox_data$boundaries$county,
                 group  = geo_tox_data$boundaries$state) |&gt; 
  # Simulate populations for each region
  simulate_population(age           = split(geo_tox_data$age, ~FIPS)[idx],
                      obesity       = geo_tox_data$obesity[idx, ],
                      exposure      = split(geo_tox_data$exposure, ~FIPS)[idx],
                      simulated_css = geo_tox_data$simulated_css,
                      n             = n) |&gt; 
  # Estimated Hill parameters
  set_hill_params(geo_tox_data$dose_response |&gt;
                    fit_hill(assay = "endp", chem = "casn") |&gt; 
                    dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed)) |&gt;
  # Calculate response
  calculate_response() |&gt;
  # Perform sensitivity analysis
  sensitivity_analysis()

# Print GeoTox object
geoTox

# Plot hill fits
plot(geoTox, type = "hill")
# Plot exposure data
plot(geoTox, type = "exposure", ncol = 5)
# Plot response data
plot(geoTox)
plot(geoTox, assays = "TOX21_H2AX_HTRF_CHO_Agonist_ratio")
# Plot sensitivity data
plot(geoTox, type = "sensitivity")
plot(geoTox, type = "sensitivity", assay = "TOX21_H2AX_HTRF_CHO_Agonist_ratio")
</code></pre>

<hr>
<h2 id='get_fixed_age'>Get <code>C_ss</code> Data for Fixed Age</h2><span id='topic+get_fixed_age'></span>

<h3>Description</h3>

<p>Get <code>C_ss</code> Data for Fixed Age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fixed_age(simulated_css, age)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_fixed_age_+3A_simulated_css">simulated_css</code></td>
<td>
<p>list of pre-generated <code>C_ss</code> data, for details see:
<code>vignette("package_data", package = "GeoTox")</code>.</p>
</td></tr>
<tr><td><code id="get_fixed_age_+3A_age">age</code></td>
<td>
<p>list of atomic vectors containing ages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of matrices containing median <code>C_ss</code> values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_fixed_age(simulated_css = geo_tox_data$simulated_css,
              age = list(c(25, 35, 55), c(15, 60)))
</code></pre>

<hr>
<h2 id='get_fixed_css'>Get Fixed <code>C_ss</code> Data</h2><span id='topic+get_fixed_css'></span>

<h3>Description</h3>

<p>Get <code>C_ss</code> values for use in <a href="#topic+sensitivity_analysis">sensitivity_analysis</a> and <a href="#topic+compute_sensitivity">compute_sensitivity</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fixed_css(simulated_css, age, obesity, C_ss)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_fixed_css_+3A_simulated_css">simulated_css</code></td>
<td>
<p>list of pre-generated <code>C_ss</code> data, for details see:
<code>vignette("package_data", package = "GeoTox")</code>.</p>
</td></tr>
<tr><td><code id="get_fixed_css_+3A_age">age</code></td>
<td>
<p>list of atomic vectors containing ages.</p>
</td></tr>
<tr><td><code id="get_fixed_css_+3A_obesity">obesity</code></td>
<td>
<p>list of atomic vectors containing obesity status.</p>
</td></tr>
<tr><td><code id="get_fixed_css_+3A_c_ss">C_ss</code></td>
<td>
<p>list of matrices containing <code>C_ss</code> values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of matrices or atomic vectors containing <code>C_ss</code> values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define inputs
age &lt;- list(c(25, 35, 55),
            c(15, 60))
obesity &lt;- list(c("Obese", "Normal", "Obese"),
                c("Normal", "Normal"))
C_ss &lt;- sample_Css(simulated_css = geo_tox_data$simulated_css,
                   age = age,
                   obesity = obesity)

# Get fixed C_ss data
get_fixed_css(simulated_css = geo_tox_data$simulated_css,
              age = age,
              obesity = obesity,
              C_ss = C_ss)
</code></pre>

<hr>
<h2 id='get_fixed_obesity'>Get <code>C_ss</code> Data for Fixed Obesity Status</h2><span id='topic+get_fixed_obesity'></span>

<h3>Description</h3>

<p>Get <code>C_ss</code> Data for Fixed Obesity Status
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fixed_obesity(simulated_css, obesity)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_fixed_obesity_+3A_simulated_css">simulated_css</code></td>
<td>
<p>list of pre-generated <code>C_ss</code> data, for details see:
<code>vignette("package_data", package = "GeoTox")</code>.</p>
</td></tr>
<tr><td><code id="get_fixed_obesity_+3A_obesity">obesity</code></td>
<td>
<p>list of atomic vectors containing obesity status.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of matrices containing median <code>C_ss</code> values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_fixed_obesity(simulated_css = geo_tox_data$simulated_css,
                  obesity = list(c("Obese", "Normal", "Obese"),
                                 c("Normal", "Normal")))
</code></pre>

<hr>
<h2 id='get_fixed_other'>Get median <code>C_ss</code> Values</h2><span id='topic+get_fixed_other'></span>

<h3>Description</h3>

<p>Get median <code>C_ss</code> Values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fixed_other(C_ss)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_fixed_other_+3A_c_ss">C_ss</code></td>
<td>
<p>list of matrices containing <code>C_ss</code> data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of atomic vectors containing median <code>C_ss</code> values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate input C_ss data
age &lt;- list(c(25, 35, 55),
            c(15, 60))
obesity &lt;- list(c("Obese", "Normal", "Obese"),
                c("Normal", "Normal"))
C_ss &lt;- sample_Css(simulated_css = geo_tox_data$simulated_css,
                   age = age,
                   obesity = obesity)

# Get median C_ss values
get_fixed_other(C_ss)
</code></pre>

<hr>
<h2 id='get_fixed_params'>Get <code>C_ss</code> Data for Fixed <code>C_ss</code> Generation Parameters</h2><span id='topic+get_fixed_params'></span>

<h3>Description</h3>

<p>Get <code>C_ss</code> Data for Fixed <code>C_ss</code> Generation Parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fixed_params(simulated_css, age)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_fixed_params_+3A_simulated_css">simulated_css</code></td>
<td>
<p>list of pre-generated <code>C_ss</code> data, for details see:
<code>vignette("package_data", package = "GeoTox")</code>.</p>
</td></tr>
<tr><td><code id="get_fixed_params_+3A_age">age</code></td>
<td>
<p>list of atomic vectors containing ages.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of matrices containing <code>C_ss</code> values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_fixed_params(simulated_css = geo_tox_data$simulated_css,
                 age = list(c(25, 35, 55), c(15, 60)))
</code></pre>

<hr>
<h2 id='hill_conc'>Hill model concentration</h2><span id='topic+hill_conc'></span>

<h3>Description</h3>

<p>Calculate the concentration in regular space for a given response value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hill_conc(resp, max, AC50, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hill_conc_+3A_resp">resp</code></td>
<td>
<p>response value</p>
</td></tr>
<tr><td><code id="hill_conc_+3A_max">max</code></td>
<td>
<p>maximal (asymptotic) response</p>
</td></tr>
<tr><td><code id="hill_conc_+3A_ac50">AC50</code></td>
<td>
<p>concentration of half-maximal response</p>
</td></tr>
<tr><td><code id="hill_conc_+3A_n">n</code></td>
<td>
<p>Hill coefficient (slope)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a regular space version of
<a href="https://cran.r-project.org/package=tcpl">tcpl::tcplHillConc()</a>.
</p>
<p>The concentration is computed as:
</p>
<p style="text-align: center;"><code class="reqn">conc = AC50 * (\frac{max}{resp} - 1)^{-1 / n}</code>
</p>



<h3>Value</h3>

<p>concentration in regular space
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hill_val">hill_val</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hill_conc(c(0.2, 0.5, 0.75), 1, 0.01, 1)
hill_conc(c(0.2, 0.5, 0.9), 1, c(0.1, 0.01, 0.001), 2)
</code></pre>

<hr>
<h2 id='hill_val'>Hill model response</h2><span id='topic+hill_val'></span>

<h3>Description</h3>

<p>Calculate the response for a given concentration in regular space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hill_val(conc, max, AC50, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hill_val_+3A_conc">conc</code></td>
<td>
<p>concentration in regular space</p>
</td></tr>
<tr><td><code id="hill_val_+3A_max">max</code></td>
<td>
<p>maximal (asymptotic) response</p>
</td></tr>
<tr><td><code id="hill_val_+3A_ac50">AC50</code></td>
<td>
<p>concentration of half-maximal response</p>
</td></tr>
<tr><td><code id="hill_val_+3A_n">n</code></td>
<td>
<p>Hill coefficient (slope)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a regular space version of
<a href="https://cran.r-project.org/package=tcpl">tcpl::tcplHillVal()</a>.
</p>
<p>The Hill model is defined as:
</p>
<p style="text-align: center;"><code class="reqn">resp = \frac{max}{1 + (\frac{AC50}{conc})^{n}}</code>
</p>



<h3>Value</h3>

<p>response value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hill_conc">hill_conc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hill_val(c(0.0025, 0.01, 0.03), 1, 0.01, 1)
hill_val(c(0.05, 0.01, 0.003), 1, c(0.1, 0.01, 0.001), 2)
</code></pre>

<hr>
<h2 id='plot_exposure'>Plot exposure data.</h2><span id='topic+plot_exposure'></span>

<h3>Description</h3>

<p>Plot exposure data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_exposure(
  exposure,
  region_boundary,
  group_boundary = NULL,
  chem_label = "chnm",
  ncol = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_exposure_+3A_exposure">exposure</code></td>
<td>
<p>list of exposure data named by region label.</p>
</td></tr>
<tr><td><code id="plot_exposure_+3A_region_boundary">region_boundary</code></td>
<td>
<p>&quot;sf&quot; data.frame mapping features to a &quot;geometry&quot;
column. Used to color regions.</p>
</td></tr>
<tr><td><code id="plot_exposure_+3A_group_boundary">group_boundary</code></td>
<td>
<p>(optional) &quot;sf&quot; data.frame containing a &quot;geometry&quot;
column. Used to draw outlines.</p>
</td></tr>
<tr><td><code id="plot_exposure_+3A_chem_label">chem_label</code></td>
<td>
<p>label for facet_wrap.</p>
</td></tr>
<tr><td><code id="plot_exposure_+3A_ncol">ncol</code></td>
<td>
<p>number of columns to wrap.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load package data
exposure &lt;- split(geo_tox_data$exposure, ~FIPS)
region_boundary &lt;- geo_tox_data$boundaries$county
group_boundary &lt;- geo_tox_data$boundaries$state

# Plot county exposure data
# Use CASN as label to avoid long chemical names
plot_exposure(exposure,
              region_boundary,
              chem_label = "casn",
              ncol = 5)

# Add state boundaries
plot_exposure(exposure,
              region_boundary,
              group_boundary = group_boundary,
              chem_label = "casn",
              ncol = 5)
</code></pre>

<hr>
<h2 id='plot_hill'>Plot Hill equation fits.</h2><span id='topic+plot_hill'></span>

<h3>Description</h3>

<p>Plot Hill equation fits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_hill(hill_params, xlim = c(-1, 4))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_hill_+3A_hill_params">hill_params</code></td>
<td>
<p>output from <code><a href="#topic+fit_hill">fit_hill</a></code>.</p>
</td></tr>
<tr><td><code id="plot_hill_+3A_xlim">xlim</code></td>
<td>
<p>log-10 scaled concentration limits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Multiple assays, multiple chemicals
df &lt;- geo_tox_data$dose_response
plot_hill(fit_hill(df, assay = "endp", chem = "casn"))

# Single assay, multiple chemicals
df &lt;- geo_tox_data$dose_response |&gt;
  dplyr::filter(endp == "TOX21_H2AX_HTRF_CHO_Agonist_ratio")
fig &lt;- plot_hill(fit_hill(df, chem = "casn"))
fig
# Modify plot
fig + ggplot2::guides(color = ggplot2::guide_legend(title = "Chemical\nCASN"))

# Single assay, single chemical
df &lt;- geo_tox_data$dose_response |&gt;
  dplyr::filter(endp == "TOX21_H2AX_HTRF_CHO_Agonist_ratio",
                casn == "510-15-6")
plot_hill(fit_hill(df))
# 3-parameter Hill model
plot_hill(fit_hill(df, fixed_slope = FALSE))
</code></pre>

<hr>
<h2 id='plot_resp'>Plot response data</h2><span id='topic+plot_resp'></span>

<h3>Description</h3>

<p>Plot response data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_resp(
  df,
  region_boundary,
  group_boundary = NULL,
  assay_quantiles = c(Median = 0.5),
  summary_quantiles = c(`10th percentile` = 0.1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_resp_+3A_df">df</code></td>
<td>
<p>output from <a href="#topic+resp_quantiles">resp_quantiles</a>.</p>
</td></tr>
<tr><td><code id="plot_resp_+3A_region_boundary">region_boundary</code></td>
<td>
<p>&quot;sf&quot; data.frame mapping features to a &quot;geometry&quot;
column. Used to color map regions.</p>
</td></tr>
<tr><td><code id="plot_resp_+3A_group_boundary">group_boundary</code></td>
<td>
<p>&quot;sf&quot; data.frame containing a &quot;geometry&quot; column. Used
to draw outlines around groups of regions.</p>
</td></tr>
<tr><td><code id="plot_resp_+3A_assay_quantiles">assay_quantiles</code></td>
<td>
<p>named numeric vector of assay quantile labels.</p>
</td></tr>
<tr><td><code id="plot_resp_+3A_summary_quantiles">summary_quantiles</code></td>
<td>
<p>named numeric vector of summary quantile labels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use example boundary data from package
region_boundary &lt;- geo_tox_data$boundaries$county
group_boundary &lt;- geo_tox_data$boundaries$state
n &lt;- nrow(region_boundary)

# Single assay quantile
df &lt;- data.frame(id = region_boundary$FIPS,
                 metric = "GCA.Eff",
                 assay_quantile = 0.5,
                 value = runif(n)^3)
# Default plot
plot_resp(df, region_boundary)
# Add group boundary, a state border in this case
plot_resp(df, region_boundary, group_boundary)
# Change quantile label
plot_resp(df, region_boundary, group_boundary,
          assay_quantiles = c("Q50" = 0.5))

# Multiple assay quantiles
df &lt;- data.frame(id = rep(region_boundary$FIPS, 2),
                 metric = "GCA.Eff",
                 assay_quantile = rep(c(0.25, 0.75), each = n),
                 value = c(runif(n)^3, runif(n)^3 + 0.15))
plot_resp(df, region_boundary, group_boundary,
          assay_quantiles = c("Q25" = 0.25, "Q75" = 0.75))

# Summary quantiles
df &lt;- data.frame(id = rep(region_boundary$FIPS, 4),
                 assay_quantile = rep(rep(c(0.25, 0.75), each = n), 2),
                 summary_quantile = rep(c(0.05, 0.95), each = n * 2),
                 metric = "GCA.Eff",
                 value = c(runif(n)^3, runif(n)^3 + 0.15,
                           runif(n)^3 + 0.7, runif(n)^3 + 0.85))
plot_resp(df, region_boundary, group_boundary,
          assay_quantiles = c("A_Q25" = 0.25, "A_Q75" = 0.75),
          summary_quantiles = c("S_Q05" = 0.05, "S_Q95" = 0.95))
</code></pre>

<hr>
<h2 id='plot_sensitivity'>Plot results of sensitivity analysis.</h2><span id='topic+plot_sensitivity'></span>

<h3>Description</h3>

<p>Plot results of sensitivity analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sensitivity(
  x,
  metric = "GCA.Eff",
  assay = NULL,
  y = "",
  xlab = metric,
  ylab = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_sensitivity_+3A_x">x</code></td>
<td>
<p>GeoTox object.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_metric">metric</code></td>
<td>
<p>metric to plot. Valid choices are &quot;GCA.Eff&quot;, &quot;IA.Eff&quot;,
&quot;GCA.HQ.10&quot;, and &quot;IA.HQ.10&quot;.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_assay">assay</code></td>
<td>
<p>which assay to plot, if multiple exist.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_y">y</code></td>
<td>
<p>y value or text for bottom of ridge plot.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.</p>
</td></tr>
<tr><td><code id="plot_sensitivity_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Required GeoTox fields are generated by first running [calculate_response]
# and [sensitivity_analysis] on a GeoTox object. This will create the fields
# `resp` and `sensitivity`. For this example, dummy data will be used.
make_data &lt;- function(n = 5, metric = "GCA.Eff") {
  list(stats::setNames(data.frame(1:n, runif(n)),
                       c("sample", metric)))
}

geoTox &lt;- GeoTox()
geoTox$resp &lt;- make_data()
geoTox$sensitivity &lt;- list(age = make_data(),
                           obesity = make_data(),
                           css_params = make_data(),
                           fit_params = make_data(),
                           C_ext = make_data())

plot_sensitivity(geoTox)
</code></pre>

<hr>
<h2 id='resp_quantiles'>Get response quantiles</h2><span id='topic+resp_quantiles'></span>

<h3>Description</h3>

<p>Get response quantiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resp_quantiles(
  resp,
  metric = c("GCA.Eff", "IA.Eff", "GCA.HQ.10", "IA.HQ.10"),
  assays = NULL,
  assay_summary = FALSE,
  assay_quantiles = c(Median = 0.5),
  summary_quantiles = c(`10th percentile` = 0.1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="resp_quantiles_+3A_resp">resp</code></td>
<td>
<p>calculated mixture response output from
<a href="#topic+calc_concentration_response">calc_concentration_response</a>.</p>
</td></tr>
<tr><td><code id="resp_quantiles_+3A_metric">metric</code></td>
<td>
<p>response metric, one of &quot;GCA.Eff&quot;, &quot;IA.Eff&quot;, &quot;GCA.HQ.10&quot;
or &quot;IA.HQ.10&quot;.</p>
</td></tr>
<tr><td><code id="resp_quantiles_+3A_assays">assays</code></td>
<td>
<p>assays to summarize. If NULL and multiple assays exist, then
the first assay is used.</p>
</td></tr>
<tr><td><code id="resp_quantiles_+3A_assay_summary">assay_summary</code></td>
<td>
<p>boolean indicating whether to summarize across assays.</p>
</td></tr>
<tr><td><code id="resp_quantiles_+3A_assay_quantiles">assay_quantiles</code></td>
<td>
<p>numeric vector of assay quantiles.</p>
</td></tr>
<tr><td><code id="resp_quantiles_+3A_summary_quantiles">summary_quantiles</code></td>
<td>
<p>numeric vector of quantiles to compute across all
assay quantiles.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The columns of the returned data frame will vary based on the inputs. If
assays is specified and assay_summary is FALSE, then the resulting data
frame will have an assay column. If assay_summary is TRUE, then the data
frame will have an summary_quantile column.
</p>


<h3>Value</h3>

<p>data frame with computed response quantiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Dummy response data
resp &lt;- list(
  "r1" = data.frame(assay = c("a1", "a1", "a2", "a2"),
                    sample = c(1, 2, 1, 2),
                    GCA.Eff = c(1, 2, 3, 4),
                    IA.Eff = c(5, 6, 7, 8),
                    "GCA.HQ.10" = c(9, 10, 11, 12),
                    "IA.HQ.10" = c(13, 14, 15, 16)))

# Summarize single assay
resp_quantiles(resp)
# Specify assay
resp_quantiles(resp, assays = "a1")
# Specify quantiles
resp_quantiles(resp, assays = "a1", assay_quantiles = c(0.25, 0.75))
# Specify metric
resp_quantiles(resp, assays = "a1", metric = "IA.HQ.10")

# Summarize across assays
resp_quantiles(resp, assay_summary = TRUE)
# Specify quantiles
suppressWarnings(
  resp_quantiles(resp,
                 assay_summary = TRUE,
                 assay_quantiles = c(0.25, 0.75),
                 summary_quantiles = c(0.1, 0.9))
)
</code></pre>

<hr>
<h2 id='sample_Css'>Sample from pre-generated <code>C_ss</code> data</h2><span id='topic+sample_Css'></span>

<h3>Description</h3>

<p>Sample from pre-generated <code>C_ss</code> data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_Css(simulated_css, age, obesity)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_Css_+3A_simulated_css">simulated_css</code></td>
<td>
<p>list of pre-generated <code>C_ss</code> data, for details see:
<code>vignette("package_data", package = "GeoTox")</code>.</p>
</td></tr>
<tr><td><code id="sample_Css_+3A_age">age</code></td>
<td>
<p>list or atomic vector of ages.</p>
</td></tr>
<tr><td><code id="sample_Css_+3A_obesity">obesity</code></td>
<td>
<p>list or atomic vector of obesity status.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of matrices containing <code>C_ss</code> values. Columns are sorted to have
consistent order across functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Vector inputs
sample_Css(geo_tox_data$simulated_css,
           c(15, 25, 35),
           c("Normal", "Obese", "Normal"))

# List inputs
sample_Css(geo_tox_data$simulated_css,
           list(c(34, 29), 55),
           list(c("Obese", "Normal"), "Normal"))
</code></pre>

<hr>
<h2 id='sensitivity_analysis'>Perform sensitivity analysis</h2><span id='topic+sensitivity_analysis'></span>

<h3>Description</h3>

<p>Perform sensitivity analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity_analysis(x, max_mult = list(NULL, NULL, NULL, 1.2, NULL))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sensitivity_analysis_+3A_x">x</code></td>
<td>
<p>GeoTox object.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_+3A_max_mult">max_mult</code></td>
<td>
<p>numeric list of length 5 for each step of the sensitivity
analysis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This wrapper function will sequentially call the <a href="#topic+compute_sensitivity">compute_sensitivity</a>
function with inputs <code>age</code>, <code>obesity</code>, <code>css_params</code>, <code>fit_params</code>, and
<code>C_ext</code>. The results will be returned as a named list and stored in the
<code>sensitivity</code> field of the input GeoTox object.
</p>
<p>Values of <code>NULL</code> in the <code>max_mult</code> input will use the default value stored
in the <code>GeoTox</code> object (<code>x$par$resp$max_mult</code>). When a <code>GeoTox</code> object is
created this is initialized at <code>1.5</code>, but can be changed via the
<a href="#topic+calculate_response">calculate_response</a> function or directly in the object.
</p>


<h3>Value</h3>

<p>The same GeoTox object with added <code>sensitivity</code> field.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute_sensitivity">compute_sensitivity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use a subset of the package data for demonstration purposes
set.seed(2357)
n &lt;- 10 # Population size
m &lt;- 5 # Number of regions
idx &lt;- if (m &lt; 100) sample(1:100, m) else 1:100

# Create GeoTox object and populate required fields
geoTox &lt;- GeoTox() |&gt;
  # Simulate populations for each region
  simulate_population(age = split(geo_tox_data$age, ~FIPS)[idx],
                      obesity = geo_tox_data$obesity[idx, ],
                      exposure = split(geo_tox_data$exposure, ~FIPS)[idx],
                      simulated_css = geo_tox_data$simulated_css,
                      n = n) |&gt;
  # Estimated Hill parameters
  set_hill_params(geo_tox_data$dose_response |&gt;
                    fit_hill(assay = "endp", chem = "casn") |&gt;
                    dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed))

# Sensitivity analysis can now be done
geoTox &lt;- geoTox |&gt; sensitivity_analysis()
</code></pre>

<hr>
<h2 id='set_boundaries'>Set GeoTox boundaries</h2><span id='topic+set_boundaries'></span>

<h3>Description</h3>

<p>Set GeoTox boundaries
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_boundaries(x, region = NULL, group = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_boundaries_+3A_x">x</code></td>
<td>
<p>GeoTox object.</p>
</td></tr>
<tr><td><code id="set_boundaries_+3A_region">region</code></td>
<td>
<p>&quot;sf&quot; data.frame mapping features to a &quot;geometry&quot; column. Used
when coloring map regions.</p>
</td></tr>
<tr><td><code id="set_boundaries_+3A_group">group</code></td>
<td>
<p>&quot;sf&quot; data.frame containing a &quot;geometry&quot; column. Used to draw
outlines around groups of regions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>same GeoTox object with boundaries set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>geoTox &lt;- GeoTox() |&gt; 
  set_boundaries(region = geo_tox_data$boundaries$county,
                 group  = geo_tox_data$boundaries$state)
</code></pre>

<hr>
<h2 id='set_hill_params'>Set Hill parameters for a GeoTox object.</h2><span id='topic+set_hill_params'></span>

<h3>Description</h3>

<p>Set Hill parameters for a GeoTox object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_hill_params(x, hill_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_hill_params_+3A_x">x</code></td>
<td>
<p>GeoTox object.</p>
</td></tr>
<tr><td><code id="set_hill_params_+3A_hill_params">hill_params</code></td>
<td>
<p>output of <a href="#topic+fit_hill">fit_hill</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>same GeoTox object with Hill parameters set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hill_params &lt;- geo_tox_data$dose_response |&gt;
  fit_hill(chem = "casn", assay = "endp") |&gt;
  dplyr::filter(!tp.sd.imputed, !logAC50.sd.imputed)

geoTox &lt;- GeoTox() |&gt; 
  set_hill_params(hill_params)
</code></pre>

<hr>
<h2 id='simulate_age'>Simulate ages</h2><span id='topic+simulate_age'></span>

<h3>Description</h3>

<p>Simulate ages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_age(x, n = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_age_+3A_x">x</code></td>
<td>
<p>data frame or list of data frames containing population data for age
groups. Each data frame must contain columns &quot;AGEGRP&quot; and &quot;TOT_POP&quot;.</p>
</td></tr>
<tr><td><code id="simulate_age_+3A_n">n</code></td>
<td>
<p>simulated sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each data frame must contain 19 rows. The first row represents the total
population of all age groups while the next 18 rows represent age groups
from 0 to 89 in increments of 5 years.
</p>


<h3>Value</h3>

<p>List of arrays containing simulated ages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single data frame
x &lt;- data.frame(AGEGRP = 0:18, TOT_POP = 0)
# populate only age range 40-44, set population total of all ages
x$TOT_POP[c(1, 10)] &lt;- 100
simulate_age(x, 5)

# List of 2 data frames
y &lt;- data.frame(AGEGRP = 0:18, TOT_POP = 0)
# populate age ranges 5-9 and 50-54
y$TOT_POP[c(3, 12)] &lt;- 10
# set population total for all age groups
y$TOT_POP[1] &lt;- sum(y$TOT_POP)
simulate_age(list(x = x, y = y), 15)

</code></pre>

<hr>
<h2 id='simulate_exposure'>Simulate external exposure</h2><span id='topic+simulate_exposure'></span>

<h3>Description</h3>

<p>Simulate external exposure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_exposure(
  x,
  expos_mean = "mean",
  expos_sd = "sd",
  expos_label = "casn",
  n = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_exposure_+3A_x">x</code></td>
<td>
<p>data frame or list of data frames containing exposure data.</p>
</td></tr>
<tr><td><code id="simulate_exposure_+3A_expos_mean">expos_mean</code></td>
<td>
<p>column name of mean values.</p>
</td></tr>
<tr><td><code id="simulate_exposure_+3A_expos_sd">expos_sd</code></td>
<td>
<p>column name of standard deviations.</p>
</td></tr>
<tr><td><code id="simulate_exposure_+3A_expos_label">expos_label</code></td>
<td>
<p>column name of labeling term, required if <code>x</code> has more
than one row.</p>
</td></tr>
<tr><td><code id="simulate_exposure_+3A_n">n</code></td>
<td>
<p>simulated sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of matrices containing inhalation rates. Matrix columns are
named using the values in the <code>expos_label</code> column for more than one data
frame row. Columns are sorted to have consistent order across functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single data frame
x &lt;- data.frame(mean = 1:3, sd = (1:3) / 10, casn = letters[1:3])
simulate_exposure(x, n = 5)

# List of 2 data frames
y &lt;- data.frame(mean = 4:6, sd = 0.1, casn = letters[1:3])
simulate_exposure(list(loc1 = x, loc2 = y), n = 5)

# Input has custom column names
z &lt;- data.frame(ave = 1:3, stdev = (1:3) / 10, chnm = letters[1:3])
simulate_exposure(z,
                  expos_mean = "ave",
                  expos_sd = "stdev",
                  expos_label = "chnm",
                  n = 5)

</code></pre>

<hr>
<h2 id='simulate_inhalation_rate'>Simulate inhalation rates</h2><span id='topic+simulate_inhalation_rate'></span>

<h3>Description</h3>

<p>Simulate inhalation rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_inhalation_rate(x, IR_params = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_inhalation_rate_+3A_x">x</code></td>
<td>
<p>atomic vector or list of atomic vectors containing ages.</p>
</td></tr>
<tr><td><code id="simulate_inhalation_rate_+3A_ir_params">IR_params</code></td>
<td>
<p>(optional) data frame with columns &quot;age&quot;, &quot;mean&quot; and &quot;sd&quot;.
See details for more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The age column of the optional <code>IR_params</code> data frame should be in ascending
order and represent the lower value of age groups for the corresponding mean
and sd values. When not provided, the default values will come from Table 6.7
of EPA's 2011 Exposure Factors Handbook using the mean of male and female
values.
</p>


<h3>Value</h3>

<p>List of atomic vectors containing inhalation rates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Single atomic vector
ages &lt;- sample(1:100, 6, replace = TRUE)
simulate_inhalation_rate(ages)

# List of atomic vectors
ages &lt;- list(
  sample(1:100, 5, replace = TRUE),
  sample(1:100, 3, replace = TRUE)
)
simulate_inhalation_rate(ages)

# Custom IR_params
IR_params &lt;- data.frame("age" = c(0, 20, 50),
                        "mean" = c(0.5, 0.3, 0.2),
                        "sd" = c(0.1, 0.06, 0.03))
simulate_inhalation_rate(c(15, 30, 65), IR_params)

</code></pre>

<hr>
<h2 id='simulate_obesity'>Simulate obesity status</h2><span id='topic+simulate_obesity'></span>

<h3>Description</h3>

<p>Simulate obesity status
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_obesity(
  x,
  obes_prev = "OBESITY_CrudePrev",
  obes_sd = "OBESITY_SD",
  obes_label = "FIPS",
  n = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_obesity_+3A_x">x</code></td>
<td>
<p>data frame containing obesity data as a percentage from 0 to 100.</p>
</td></tr>
<tr><td><code id="simulate_obesity_+3A_obes_prev">obes_prev</code></td>
<td>
<p>column name of prevalence.</p>
</td></tr>
<tr><td><code id="simulate_obesity_+3A_obes_sd">obes_sd</code></td>
<td>
<p>column name of standard deviation.</p>
</td></tr>
<tr><td><code id="simulate_obesity_+3A_obes_label">obes_label</code></td>
<td>
<p>column name of labeling term, required if <code>x</code> has more than
one row.</p>
</td></tr>
<tr><td><code id="simulate_obesity_+3A_n">n</code></td>
<td>
<p>simulated sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of arrays containing simulated obesity status.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Input has default column names
df &lt;- data.frame(OBESITY_CrudePrev = c(20, 50, 80),
                 OBESITY_SD = c(5, 5, 5),
                 FIPS = letters[1:3])
simulate_obesity(df, n = 5)

# Input has custom column names
df &lt;- data.frame(prev = c(20, 50, 80),
                 sd = c(5, 5, 5),
                 label = letters[1:3])
simulate_obesity(df,
                 obes_prev = "prev",
                 obes_sd = "sd",
                 obes_label = "label",
                 n = 5)

</code></pre>

<hr>
<h2 id='simulate_population'>Simulate population data</h2><span id='topic+simulate_population'></span>

<h3>Description</h3>

<p>Simulate population data for given input fields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_population(
  x,
  age = NULL,
  obesity = NULL,
  exposure = NULL,
  simulated_css = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_population_+3A_x">x</code></td>
<td>
<p>GeoTox object.</p>
</td></tr>
<tr><td><code id="simulate_population_+3A_age">age</code></td>
<td>
<p>input <code>x</code> to function <a href="#topic+simulate_age">simulate_age</a>. After simulating ages, the
inhalation rate is subsequently calculated using <a href="#topic+simulate_inhalation_rate">simulate_inhalation_rate</a>.</p>
</td></tr>
<tr><td><code id="simulate_population_+3A_obesity">obesity</code></td>
<td>
<p>input <code>x</code> to function <a href="#topic+simulate_obesity">simulate_obesity</a>.</p>
</td></tr>
<tr><td><code id="simulate_population_+3A_exposure">exposure</code></td>
<td>
<p>input <code>x</code> to function <a href="#topic+simulate_exposure">simulate_exposure</a>.</p>
</td></tr>
<tr><td><code id="simulate_population_+3A_simulated_css">simulated_css</code></td>
<td>
<p>input <code>simulated_css</code> to functions <a href="#topic+sample_Css">sample_Css</a> and
<a href="#topic+get_fixed_css">get_fixed_css</a>.</p>
</td></tr>
<tr><td><code id="simulate_population_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other functions. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Additional parameters include <code>n</code> for sample size,
<code>IR_params</code> for <a href="#topic+simulate_inhalation_rate">simulate_inhalation_rate</a>,
<code>obes_prev</code>, <code>obes_sd</code>, and <code>obes_label</code> for <a href="#topic+simulate_obesity">simulate_obesity</a>,
and <code>expos_mean</code>, <code>expos_sd</code>, and <code>expos_label</code> for <a href="#topic+simulate_exposure">simulate_exposure</a>.
</p>


<h3>Value</h3>

<p>The same object with simulated fields added.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use a subset of the package data for demonstration purposes
set.seed(2357)
n &lt;- 10 # Population size
m &lt;- 5 # Number of regions
idx &lt;- if (m &lt; 100) sample(1:100, m) else 1:100

# Create GeoTox object
geoTox &lt;- GeoTox() |&gt;
  # Simulate populations for each region
  simulate_population(age = split(geo_tox_data$age, ~FIPS)[idx],
                      obesity = geo_tox_data$obesity[idx, ],
                      exposure = split(geo_tox_data$exposure, ~FIPS)[idx],
                      simulated_css = geo_tox_data$simulated_css,
                      n = n)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
