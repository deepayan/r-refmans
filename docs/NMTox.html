<!DOCTYPE html><html lang="en"><head><title>Help for package NMTox</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NMTox}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adjPlot'><p>Plot the adjusted p-values, raw p-values and FDR level</p></a></li>
<li><a href='#FrCtrl'><p>Create a frequency table of the control values</p></a></li>
<li><a href='#Frtab'><p>Generate the number of unique values, the list of unique values, or the number</p>
of observations of specified variable(s)</a></li>
<li><a href='#Frtab.sub'><p>Count the number of observations for each unique value of a variable on a</p>
subset of data</a></li>
<li><a href='#geninvitro'><p>Genetic toxicity in vitro dataset</p></a></li>
<li><a href='#Isoplot'><p>Create plot(s) of the observations, the sample means and the fitted isotonic</p>
regression curve</a></li>
<li><a href='#IsoPlot.nm'><p>Create a plot of the observations, sample means and fitted isotonic</p>
regression curve for one nanomaterial</a></li>
<li><a href='#IsoPval.nm'><p>Calculate p-values based on permutation for both increasing and</p>
decreasing ordered alternatives</a></li>
<li><a href='#Isotest'><p>Calculate the test statistics and p-values for testing monotonic trend</p></a></li>
<li><a href='#IsoTest.nm'><p>Calculate the value of the test statistics for testing monotonic trend</p></a></li>
<li><a href='#nm400'><p>NM-400 in vitro dataset</p></a></li>
<li><a href='#nmplot'><p>Create plots of the dose and the response for each nanomaterial in the</p>
dataset</a></li>
<li><a href='#nmplot.cat'><p>Create plots of the dose and the response grouped by a variable</p></a></li>
<li><a href='#nmplot.n'><p>Create plots of the dose and the response for every unique value of a certain</p>
variable</a></li>
<li><a href='#nmplot.ncat'><p>Create plots of the dose and the response differentiated by specified</p>
variables</a></li>
<li><a href='#SplitData'><p>Split the data of each nanomaterial into different subsets of data</p></a></li>
<li><a href='#SubsetData'><p>Create a subset of data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dose-Response Relationship Analysis of Nanomaterial Toxicity</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rahmasari Nur Azizah &lt;rahma.azizah@uhasselt.be&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform an exploration and a preliminary analysis on the dose-
    response relationship of nanomaterial toxicity. Several functions are
    provided for data exploration, including functions for creating a subset of
    dataset, frequency tables and plots. Inference for order restricted dose-
    response data is performed by testing the significance of monotonic
    dose-response relationship, using Williams, Marcus, M, Modified M and 
    Likelihood ratio tests. Several methods of multiplicity adjustment 
    are also provided. Description of the methods can be found in <a href="https://github.com/rahmasarina/dose-response-analysis/blob/main/Methodology.pdf">https://github.com/rahmasarina/dose-response-analysis/blob/main/Methodology.pdf</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>gridExtra, dplyr, ggplot2, Iso, tidyr, forcats</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-31 23:54:26 UTC; u0135148</td>
</tr>
<tr>
<td>Author:</td>
<td>Rahmasari Nur Azizah [aut, cre],
  Geert Verheyen [aut, ths],
  Sabine Van Miert [aut, ths],
  Ziv Shkedy [aut, ths]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-01 15:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='adjPlot'>Plot the adjusted p-values, raw p-values and FDR level</h2><span id='topic+adjPlot'></span>

<h3>Description</h3>

<p>This function generates plots of adjusted p-values, raw p-values and selected
FDR level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjPlot(data.nm, data.control, id, nano, response, dose, end, end.cat,
  unit, unit.cat, stat=c("E2","Williams","Marcus","M","ModM"), niter,
  method=c("BH","BY"), control.opt=c("same","all"), set.seed, vars, FDR)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adjPlot_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_response">response</code></td>
<td>
<p>Response (endpoint value)</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_stat">stat</code></td>
<td>
<p>Test statistics (&quot;<code>E2</code>&quot; for the global likelihood test,
&quot;<code>Williams</code>&quot; for Williams test, &quot;<code>Marcus</code>&quot; for Marcus test,
&quot;<code>M</code>&quot; for M test or &quot;<code>ModM</code>&quot; for modified M test)</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_niter">niter</code></td>
<td>
<p>Number of permutations</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_method">method</code></td>
<td>
<p>Method used to adjust for the multiplicity</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_control.opt">control.opt</code></td>
<td>
<p>Option for the control doses if <code>unit</code> and
<code>unit.cat</code> are specified. If only control doses with the same unit of
measurement as the non-control ones are included, then specify
&quot;<code>same</code>&quot; in the <code>control.opt</code>. If all control doses with any
units of measurement are included, then specify &quot;<code>all</code>&quot;.</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_set.seed">set.seed</code></td>
<td>
<p>Specify seed</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_vars">vars</code></td>
<td>
<p>Variable(s) used to subset the data</p>
</td></tr>
<tr><td><code id="adjPlot_+3A_fdr">FDR</code></td>
<td>
<p>The desired FDR to control</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>This function calculates the p-values for each nanomaterial in the
dataset (or for each subset of data). The different types of nanomaterials
are identified by their names. Therefore, if some control values are named
differently (see: <code><a href="#topic+geninvitro">geninvitro</a></code> dataset and the <code>Examples</code>),
a separate dataset containing only these values first needs to be created.
Controls in the new dataset can be linked to the non-control observations
belonging to the same experiment through the identifier of the experiment
(the linking is performed inside this function). In this situation, it is
necessary to have an indicator that can identify different experiments (such
as experiment ID).
</p>
</li>
<li><p>If all controls in the dataset are named according to the related
nanomaterial names, <code>data.control</code> and <code>id</code> do not need to be
specified.
</p>
</li>
<li><p>If doses used in the experiment are all measured in the same unit of
measurement, then specify &quot;<code>same</code>&quot; in <code>control.opt</code>.
</p>
</li>
<li><p>Plots can also be generated for subsets of data in each nanomaterial,
by specifying the variables used to split the data in <code>vars</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>This function generates plots of adjusted p-values, raw p-values and
selected FDR for both directions (up and down) of the trend
</p>


<h3>References</h3>

<p>Lin D., Pramana, S., Verbeke, T., and Shkedy, Z. (2015). IsoGene:
Order-Restricted Inference for Microarray Experiments. R package version
1.0-24. <a href="https://CRAN.R-project.org/package=IsoGene">https://CRAN.R-project.org/package=IsoGene</a>
</p>
<p>Lin D., Shkedy Z., Yekutieli D., Amaratunga D., and Bijnens, L. (editors).
(2012) Modeling Doseresponse Microarray Data in Early Drug Development
Experiments Using R. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"), include=FALSE)
#
adjPlot(data.nm=invitrodata, data.control=controldata, id="experimentID",
nano="name", response="value", dose="concentration", end="endpoint",
end.cat="DNA STRAND BREAKS", unit="concentration_unit", unit.cat="ug/cm2",
stat="E2", niter=1000, method="BH", control.opt="same",
set.seed = 1234, FDR=0.05)

</code></pre>

<hr>
<h2 id='FrCtrl'>Create a frequency table of the control values</h2><span id='topic+FrCtrl'></span>

<h3>Description</h3>

<p>This function provides a table containing the frequencies of the control
values and the number of available data in the specified dataset. Since it is
possible to have a dose with different units of measurement in one dataset,
this function helps in showing how many control values are available for each
nanomaterial for a specific unit of measurement of the dose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FrCtrl(data.nm, data.control, id, nano, dose, end, end.cat, unit,
  unit.cat, vars)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FrCtrl_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="FrCtrl_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="FrCtrl_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="FrCtrl_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="FrCtrl_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="FrCtrl_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="FrCtrl_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="FrCtrl_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="FrCtrl_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="FrCtrl_+3A_vars">vars</code></td>
<td>
<p>Variables used to subset the data</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>This function performs data exploration for each nanomaterial in the
dataset (or for each subset of data). The different types of nanomaterials
are identified by their names. Therefore, if some control values are named
differently (see: <code><a href="#topic+geninvitro">geninvitro</a></code> dataset and the <code>Examples</code>),
a separate dataset containing only these values first needs to be created.
Controls in the new dataset can be linked to the non-control observations
belonging to the same experiment through the identifier of the experiment
(the linking is performed inside this function). In this situation, it is
necessary to have an indicator that can identify different experiments (such
as experiment ID).
</p>
</li>
<li><p>If all controls in the dataset are named according to the related
nanomaterial names, <code>data.control</code> and <code>id</code> do not need to be
specified.
</p>
</li>
<li><p>The exploration can also be performed on the subsets of data by
splitting the data of each nanomaterial according to the variable(s)
specified in <code>vars</code>
</p>
</li></ul>



<h3>Value</h3>

<p>The value returned from <code>FrCtrl</code> is a table containing:
</p>

<ul>
<li><p><code>Freq(Dose=0.0).same</code>: frequency of control values with dose
measured in <code>unit.cat</code>
</p>
</li>
<li><p><code>Freq(obs).same</code>: number of observations with dose measured in
<code>unit.cat</code>
</p>
</li>
<li><p><code>Freq(Dose=0.0).all</code>: frequency of control values with dose
measured <code>unit.cat</code> and in other units of measurement
</p>
</li>
<li><p><code>Freq(obs).all</code>: number of observations with dose measured in
<code>unit.cat</code> and control dose measured in any units,
</p>
</li></ul>

<p>for each nanomaterial or subset of data
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"), include=FALSE)

# Frequency of controls for each nanomaterial in geninvitro dataset
# with DNA STRAND BREAKS as the toxicity endpoint and concentration
# measured in "ug/cm2":
#
FrCtrl(data.nm=invitrodata, data.control=controldata, nano="name",
       end="endpoint", end.cat="DNA STRAND BREAKS", id="experimentID",
       dose="concentration", unit="concentration_unit", unit.cat="ug/cm2")

# Frequency of controls for each cell type in each nanomaterial
# (in geninvitro dataset) with DNA STRAND BREAKS as the toxicity
# endpoint and concentration measured in "ug/cm2":
#
FrCtrl(data.nm=invitrodata, data.control=controldata, nano="name",
       end="endpoint", end.cat="DNA STRAND BREAKS", id="experimentID",
       dose="concentration", unit="concentration_unit", unit.cat="ug/cm2",
       vars="celltype")
</code></pre>

<hr>
<h2 id='Frtab'>Generate the number of unique values, the list of unique values, or the number
of observations of specified variable(s)</h2><span id='topic+Frtab'></span>

<h3>Description</h3>

<p>This function produces the number of unique values, the list of unique
values, or the number of observations of certain variable(s) in the dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Frtab(data, x, cat, val, opt=c("un", "list", "obs", "ls.obs"),
  na.rm=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Frtab_+3A_data">data</code></td>
<td>
<p>Dataset</p>
</td></tr>
<tr><td><code id="Frtab_+3A_x">x</code></td>
<td>
<p>Variable(s) to be explored</p>
</td></tr>
<tr><td><code id="Frtab_+3A_cat">cat</code></td>
<td>
<p>Variable used to group or subset the data</p>
</td></tr>
<tr><td><code id="Frtab_+3A_val">val</code></td>
<td>
<p>Specific value of variable <code>cat</code>. If <code>val</code> is specified,
then only result for this value will be shown.</p>
</td></tr>
<tr><td><code id="Frtab_+3A_opt">opt</code></td>
<td>
<p>Options for the result: If <code>opt</code> is <code>un</code>, then the
number of unique values of <code>x</code> will be counted. If <code>opt</code> is
<code>list</code>, then the list of unique values of <code>x</code> will be
generated. If <code>opt</code> is <code>obs</code>, then the number of observations of
<code>x</code> will be counted. If <code>opt</code> is <code>ls.obs</code>, then the number
of observations for each unique value will be generated.</p>
</td></tr>
<tr><td><code id="Frtab_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>na.rm</code> is <code>FALSE</code> (the default), then missing
values are not removed from the dataset. If <code>na.rm</code>=<code>TRUE</code>, then
missing values are removed from the dataset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function generates the number of unique values, the list of
unique values, or the number of observations of specified variable(s).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# List of nanomaterial in geninvitro dataset:
Frtab(data=geninvitro, x="name", opt="list")

# How many types of endpoint are measured in geninvitro data?
Frtab(data=geninvitro, x="endpoint", opt="un")

# How many observations are available for variable "unit"?
Frtab(data=geninvitro, x="unit", opt="obs")

# How many types of endpoint and nanomaterial are available in geninvitro data?
Frtab(data=geninvitro, x=c("name","endpoint"), opt="un")

# How many types of endpoint are available for each nanomaterial
# in geninvitro data?
Frtab(data=geninvitro, x="endpoint", cat="name", opt="un")

# How many observations are available for each endpoint in each nanomaterial?
Frtab(data=geninvitro, x=c("name","endpoint"), opt="ls.obs")

# How many observations with "DNA STRAND BREAKS" as the endpoint are available
# for each nanomaterial in geninvitro data?
Frtab(data=geninvitro, x="name", cat="endpoint", val="DNA STRAND BREAKS",
opt="ls.obs")


</code></pre>

<hr>
<h2 id='Frtab.sub'>Count the number of observations for each unique value of a variable on a
subset of data</h2><span id='topic+Frtab.sub'></span>

<h3>Description</h3>

<p>This function counts the number of observations for each unique value of a
variable on a subset of data. The subset of data is created according to the
specified endpoint and unit of measurement of the dose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Frtab.sub(data.nm, data.control, id, nano, dose, end, end.cat, unit,
  unit.cat, control.opt=c("same","all"), x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Frtab.sub_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_control.opt">control.opt</code></td>
<td>
<p>Option for the control doses. If only control doses with
the same unit of measurement as the non-control ones are included, then
specify &quot;<code>same</code>&quot; in the <code>control.opt</code>. If all control doses with
any units of measurement are included, then specify &quot;<code>all</code>&quot;.</p>
</td></tr>
<tr><td><code id="Frtab.sub_+3A_x">x</code></td>
<td>
<p>Variable to be explored</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>This function counts for each nanomaterial in the dataset. The
different types of nanomaterials are identified by their names. Therefore, if
some control values are named differently (see: <code><a href="#topic+geninvitro">geninvitro</a></code>
dataset and the <code>Examples</code>), a separate dataset containing only these
values first needs to be created. Controls in the new dataset can be linked
to the non-control observations belonging to the same experiment through the
identifier of the experiment (the linking is performed inside this function).
In this situation, it is necessary to have an indicator that can identify
different experiments (such as experiment ID).
</p>
</li>
<li><p>If all controls in the dataset are named according to the related
nanomaterial names, <code>data.control</code> and <code>id</code> do not need to be
specified.
</p>
</li>
<li><p>If doses used in the experiment are all measured in the same unit of
measurement, then specify &quot;<code>same</code>&quot; in <code>control.opt</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>This function generates a table containing the number of observations
for each unique value of a variable on a subset of data
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control",
             "Control", "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control",
             "Control", "medium", "medium + BSA", "untreated"), include=FALSE)

# Frequency of each unique value of the dose for each nanomaterial
# in geninvitro dataset, with DNA STRAND BREAKS as the toxicity endpoint
# and only observations with concentration measured in "ug/cm2" are considered:
#
Frtab.sub(data.nm=invitrodata, data.control=controldata, nano="name",
           end="endpoint", end.cat="DNA STRAND BREAKS", id="experimentID",
           dose="concentration", unit="concentration_unit", unit.cat="ug/cm2",
           control.opt="same", x="concentration")

</code></pre>

<hr>
<h2 id='geninvitro'>Genetic toxicity in vitro dataset</h2><span id='topic+geninvitro'></span>

<h3>Description</h3>

<p>This dataset contains the result of genetic toxicity in vitro studies and
variables related to the experiments for several different nanomaterials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(geninvitro)
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<ul>
<li><p>name: Project-assigned name of the nanomaterial
</p>
</li>
<li><p>publicname: A widely accepted unique identifier
</p>
</li>
<li><p>supplier: Supplier/project where the data is originated from
</p>
</li>
<li><p>experimentID: Identifier of the experiment
</p>
</li>
<li><p>method: Method/assay used in the experiment
</p>
</li>
<li><p>studyprovider: Study provider
</p>
</li>
<li><p>endpoint: Toxicity endpoint measure
</p>
</li>
<li><p>value: Endpoint value
</p>
</li>
<li><p>unit: Unit of the endpoint
</p>
</li>
<li><p>celltype: Type of the cell used in the experiment
</p>
</li>
<li><p>treatment: Indicator of the treatment
</p>
</li>
<li><p>exptimeunit: Unit of measurement of the exposure time
</p>
</li>
<li><p>exptime: Exposure time
</p>
</li>
<li><p>concentration_unit: Unit of measurement of the concentration
in variable <em>concentration</em>
</p>
</li>
<li><p>concentration: Concentration of the nanomaterial
</p>
</li>
<li><p>concentration_ml_unit: Unit of measurement of the concentration
in variable <em>concentration_ml</em>
</p>
</li>
<li><p>concentration_ml: Concentration of the nanomaterial in amount per
ml
</p>
</li></ul>



<h3>Details</h3>

<p>Since some of the controls in geninvitro dataset are not named
according to the nanomaterial names, the experiment identifier (ID) can be
used to identify which control values are related to which nanomaterial.
</p>


<h3>Source</h3>

<p>This dataset was obtained from
<a href="https://www.anses.fr/en/content/nanogenotox-project">https://www.anses.fr/en/content/nanogenotox-project</a> (NanoGenotox
project) and it was extracted from eNanoMapper database
<a href="https://search.data.enanomapper.net/">https://search.data.enanomapper.net/</a>
</p>
<p>The NANOGENOTOX Joint Action received funding from the European Union, in
the framework of the Health Programme under Grant Agreement n2009 21.
</p>
<p>Supported by European Union's Horizon 2020 research and innovation
programme under grant agreement No 814426 - NanoInformaTIX
<a href="https://www.nanoinformatix.eu/">https://www.nanoinformatix.eu/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(geninvitro)
</code></pre>

<hr>
<h2 id='Isoplot'>Create plot(s) of the observations, the sample means and the fitted isotonic
regression curve</h2><span id='topic+Isoplot'></span>

<h3>Description</h3>

<p>This function creates plot(s) of the observations, the sample means and the
fitted isotonic regression curve for one or more nanomaterials simultaneously
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Isoplot(data.nm, data.control, id, nano, response, dose, end, end.cat,
  unit, unit.cat, dose.type=c("dose","log"), type = c("continuous",
  "ordinal"), control.opt=c("same","all"), add.curve = TRUE, vars, nrow=1,
  ncol=1, xlabel="Dose", ylabel="Response")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Isoplot_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_response">response</code></td>
<td>
<p>Response (endpoint value)</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_dose.type">dose.type</code></td>
<td>
<p>Type of the dose to be plotted (&quot;dose&quot; for dose and &quot;log&quot;
for log(dose))</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_type">type</code></td>
<td>
<p>Type of the dose (continuous or ordinal)</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_control.opt">control.opt</code></td>
<td>
<p>Option for the control doses if <code>unit</code> and
<code>unit.cat</code> are specified. If only control doses with the same unit of
measurement as the non-control ones are included, then specify
&quot;<code>same</code>&quot; in the <code>control.opt</code>. If all control doses with any
units of measurement are included, then specify &quot;<code>all</code>&quot;.</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_add.curve">add.curve</code></td>
<td>
<p>Adding curve to the plot</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_vars">vars</code></td>
<td>
<p>Variable(s) used to subset the data</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_nrow">nrow</code></td>
<td>
<p>Number of row in the plotting space</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_ncol">ncol</code></td>
<td>
<p>Number of column in the plotting space</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_xlabel">xlabel</code></td>
<td>
<p>Label for x-axis</p>
</td></tr>
<tr><td><code id="Isoplot_+3A_ylabel">ylabel</code></td>
<td>
<p>Label for y-axis</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>This function performs data exploration for each nanomaterial in the
dataset (or for each subset of data). The different types of nanomaterials
are identified by their names. Therefore, if some control values are named
differently (see: <code><a href="#topic+geninvitro">geninvitro</a></code> dataset and the <code>Examples</code>),
a separate dataset containing only these values first needs to be created.
Controls in the new dataset can be linked to the non-control observations
belonging to the same experiment through the identifier of the experiment
(the linking is performed inside this function). In this situation, it is
necessary to have an indicator that can identify different experiments (such
as experiment ID).
</p>
</li>
<li><p>If all controls in the dataset are named according to the related
nanomaterial names, <code>data.control</code> and <code>id</code> do not need to be
specified.
</p>
</li>
<li><p>If doses used in the experiment are all measured in the same unit of
measurement, then specify &quot;<code>same</code>&quot; in <code>control.opt</code>.
</p>
</li>
<li><p>Dose-response plot can also be generated for subsets of data in each
nanomaterial by specifying the variables used to split the data in
<code>vars</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>This function produces plot(s) consisting of observation data points,
sample mean for each dose and fitted isotonic regression curve
</p>


<h3>References</h3>

<p>Lin D., Pramana, S., Verbeke, T., and Shkedy, Z. (2015). IsoGene:
Order-Restricted Inference for Microarray Experiments. R package version
1.0-24. <a href="https://CRAN.R-project.org/package=IsoGene">https://CRAN.R-project.org/package=IsoGene</a>
</p>
<p>Lin D., Shkedy Z., Yekutieli D., Amaratunga D., and Bijnens, L. (editors).
(2012) Modeling Doseresponse Microarray Data in Early Drug Development
Experiments Using R. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"), include=FALSE)
#
# Generate dose-response plots for geninvitro, with DNA STRAND BREAKS
# as the endpoint, concentrations measured in "ug/cm2"
# and control doses measured in any units of measurement:
#
Isoplot(data.nm=invitrodata, data.control=controldata, id="experimentID",
        nano="name", response="value", dose="concentration", end="endpoint",
        end.cat="DNA STRAND BREAKS", unit="concentration_unit", unit.cat="ug/cm2",
        dose.type="dose", control.opt="all")

# Example 2:
# Split geninvitro data according to the cell type, method, study provider and
# unit of the concentration and generate dose-response plot for each subset
# of data with DNA STRAND BREAKS as the endpoint:
#
Isoplot(data.nm=invitrodata, data.control=controldata, id="experimentID",
        nano="name", response="value", dose="concentration", end="endpoint",
        end.cat="DNA STRAND BREAKS",  dose.type="dose",
        vars=c("celltype","method","studyprovider","concentration_unit"),
        nrow=2, ncol=2)

</code></pre>

<hr>
<h2 id='IsoPlot.nm'>Create a plot of the observations, sample means and fitted isotonic
regression curve for one nanomaterial</h2><span id='topic+IsoPlot.nm'></span>

<h3>Description</h3>

<p>This function generates a dose-response plot (scatter plot) of the
observations, sample means and fitted isotonic regression curve for one
nanomaterial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IsoPlot.nm(data.nm, dose, response, type = c("continuous", "ordinal"),
  add.curve = TRUE, nano.cat = NULL, xlabel="Dose", ylabel="Response")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IsoPlot.nm_+3A_data.nm">data.nm</code></td>
<td>
<p>Dataset of a particular nanomaterial</p>
</td></tr>
<tr><td><code id="IsoPlot.nm_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration (with the same unit of measurement)</p>
</td></tr>
<tr><td><code id="IsoPlot.nm_+3A_response">response</code></td>
<td>
<p>Response (a certain endpoint value)</p>
</td></tr>
<tr><td><code id="IsoPlot.nm_+3A_type">type</code></td>
<td>
<p>Type of the dose</p>
</td></tr>
<tr><td><code id="IsoPlot.nm_+3A_add.curve">add.curve</code></td>
<td>
<p>Adding curve to the plot</p>
</td></tr>
<tr><td><code id="IsoPlot.nm_+3A_nano.cat">nano.cat</code></td>
<td>
<p>Title of the plot (referring to the name of the nanomaterial)</p>
</td></tr>
<tr><td><code id="IsoPlot.nm_+3A_xlabel">xlabel</code></td>
<td>
<p>label for the x-axis of the plot</p>
</td></tr>
<tr><td><code id="IsoPlot.nm_+3A_ylabel">ylabel</code></td>
<td>
<p>label for the y-axis of the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to be used inside the function
<code><a href="#topic+Isoplot">Isoplot</a></code>. However, it can also be used to generate a plot
for one nanomaterial, with a particular unit of measurement of the dose and
for a certain toxicity endpoint.
</p>


<h3>Value</h3>

<p>This function produces a plot of the observations, sample means and
fitted isotonic regression curve for one nanomaterial
</p>


<h3>References</h3>

<p>Lin D., Pramana, S., Verbeke, T., and Shkedy, Z. (2015). IsoGene:
Order-Restricted Inference for Microarray Experiments. R package version
1.0-24. <a href="https://CRAN.R-project.org/package=IsoGene">https://CRAN.R-project.org/package=IsoGene</a>
</p>
<p>Lin D., Shkedy Z., Yekutieli D., Amaratunga D., and Bijnens, L. (editors).
(2012) Modeling Doseresponse Microarray Data in Early Drug Development
Experiments Using R. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#nm400 contains the result of genetic toxicity in vitro study of NM-400
#(Multi-walled carbon nanotubes) with associated controls
IsoPlot.nm(data.nm=nm400, dose="concentration", response="value",
           nano.cat="Multi-walled carbon nanotubes", xlabel="Concentration",
           ylabel="DNA STRAND BREAKS")
</code></pre>

<hr>
<h2 id='IsoPval.nm'>Calculate p-values based on permutation for both increasing and
decreasing ordered alternatives</h2><span id='topic+IsoPval.nm'></span>

<h3>Description</h3>

<p>This function calculates p-values based on permutation. The plots of
the null distribution and the observed test statistic under increasing and
decreasing ordered alternatives are also given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IsoPval.nm(data.nm, dose, response, stat=c("E2", "Williams","Marcus",
  "M", "ModM"), niter, nano.cat=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IsoPval.nm_+3A_data.nm">data.nm</code></td>
<td>
<p>Nanomaterial dataset</p>
</td></tr>
<tr><td><code id="IsoPval.nm_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration (with the same unit of measurement)</p>
</td></tr>
<tr><td><code id="IsoPval.nm_+3A_response">response</code></td>
<td>
<p>Response (a certain endpoint value)</p>
</td></tr>
<tr><td><code id="IsoPval.nm_+3A_stat">stat</code></td>
<td>
<p>Test statistics (&quot;<code>E2</code>&quot; for the global likelihood test,
&quot;<code>Williams</code>&quot; for Williams test, &quot;<code>Marcus</code>&quot; for Marcus test,
&quot;<code>M</code>&quot; for M test or &quot;<code>ModM</code>&quot; for modified M test)</p>
</td></tr>
<tr><td><code id="IsoPval.nm_+3A_niter">niter</code></td>
<td>
<p>Number of permutations</p>
</td></tr>
<tr><td><code id="IsoPval.nm_+3A_nano.cat">nano.cat</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to be used inside the function
<code><a href="#topic+Isotest">Isotest</a></code>. However, it can also be used to calculate p-values
and generate the plot for one nanomaterial, with a particular unit of
measurement of the dose, for a certain toxicity endpoint.
</p>


<h3>Value</h3>

<p>This value provides p-values based on the permutation, the plot of
the null distribution and the observed test statistics.
</p>


<h3>References</h3>

<p>Lin D., Pramana, S., Verbeke, T., and Shkedy, Z. (2015). IsoGene:
Order-Restricted Inference for Microarray Experiments. R package version
1.0-24. <a href="https://CRAN.R-project.org/package=IsoGene">https://CRAN.R-project.org/package=IsoGene</a>
</p>
<p>Lin D., Shkedy Z., Yekutieli D., Amaratunga D., and Bijnens, L. (editors).
(2012) Modeling Doseresponse Microarray Data in Early Drug Development
Experiments Using R. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Isotest">Isotest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#nm400 contains the result of genetic toxicity in vitro study of NM-400
#(Multi-walled carbon nanotubes) with associated controls
IsoPval.nm(data.nm=nm400, dose="concentration", response="value",
           stat="E2", niter=1000)
</code></pre>

<hr>
<h2 id='Isotest'>Calculate the test statistics and p-values for testing monotonic trend</h2><span id='topic+Isotest'></span>

<h3>Description</h3>

<p>This function provides the value of the test statistics, p-values, plot of
the null distribution and the observed test statistics, and adjusted p-values
according to the method chosen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Isotest(data.nm, data.control, id, nano, response, dose, end, end.cat,
  unit, unit.cat, stat=c("E2","Williams","Marcus","M","ModM"), niter,
  method=p.adjust.methods, control.opt=c("same","all"), set.seed, vars)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Isotest_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="Isotest_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="Isotest_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="Isotest_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="Isotest_+3A_response">response</code></td>
<td>
<p>Response (endpoint value)</p>
</td></tr>
<tr><td><code id="Isotest_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="Isotest_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="Isotest_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="Isotest_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="Isotest_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="Isotest_+3A_stat">stat</code></td>
<td>
<p>Test statistics (&quot;<code>E2</code>&quot; for the global likelihood test,
&quot;<code>Williams</code>&quot; for Williams test, &quot;<code>Marcus</code>&quot; for Marcus test,
&quot;<code>M</code>&quot; for M test or &quot;<code>ModM</code>&quot; for modified M test)</p>
</td></tr>
<tr><td><code id="Isotest_+3A_niter">niter</code></td>
<td>
<p>Number of permutations</p>
</td></tr>
<tr><td><code id="Isotest_+3A_method">method</code></td>
<td>
<p>Method used to adjust for the multiplicity (see <code>p.adjust.methods</code>)</p>
</td></tr>
<tr><td><code id="Isotest_+3A_control.opt">control.opt</code></td>
<td>
<p>Option for the control doses if <code>unit</code> and
<code>unit.cat</code> are specified. If only control doses with the same unit of
measurement as the non-control ones are included, then specify
&quot;<code>same</code>&quot; in the <code>control.opt</code>. If all control doses with any
units of measurement are included, then specify &quot;<code>all</code>&quot;.</p>
</td></tr>
<tr><td><code id="Isotest_+3A_set.seed">set.seed</code></td>
<td>
<p>Specify seed</p>
</td></tr>
<tr><td><code id="Isotest_+3A_vars">vars</code></td>
<td>
<p>Variable(s) used to subset the data</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>This function performs trend testing for each nanomaterial in the
dataset (or for each subset of data). The different types of nanomaterials
are identified by their names. Therefore, if some control values are named
differently (see: <code><a href="#topic+geninvitro">geninvitro</a></code> dataset and the <code>Examples</code>),
a separate dataset containing only these values first needs to be created.
Controls in the new dataset can be linked to the non-control observations
belonging to the same experiment through the identifier of the experiment
(the linking is performed inside this function). In this situation, it is
necessary to have an indicator that can identify different experiments (such
as experiment ID).
</p>
</li>
<li><p>If all controls in the dataset are named according to the related
nanomaterial names, <code>data.control</code> and <code>id</code> do not need to be
specified.
</p>
</li>
<li><p>If doses used in the experiment are all measured in the same unit of
measurement, then specify &quot;<code>same</code>&quot; in <code>control.opt</code>.
</p>
</li>
<li><p>Trend testing can also be performed for subsets of data in each
nanomaterial, by specifying the variables used to split the data in
<code>vars</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>This function calculates the value for the test statistics, the
p-value (and its plot) based on the permutation, the adjusted p-value and
the more likely direction of the monotonic trend.
</p>


<h3>References</h3>

<p>Lin D., Pramana, S., Verbeke, T., and Shkedy, Z. (2015). IsoGene:
Order-Restricted Inference for Microarray Experiments. R package version
1.0-24. <a href="https://CRAN.R-project.org/package=IsoGene">https://CRAN.R-project.org/package=IsoGene</a>
</p>
<p>Lin D., Shkedy Z., Yekutieli D., Amaratunga D., and Bijnens, L. (editors).
(2012) Modeling Doseresponse Microarray Data in Early Drug Development
Experiments Using R. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"), include=FALSE)
#
# Perform test for the monotonic trend in geninvitro, with DNA STRAND BREAKS
# as the endpoint, concentrations measured in "ug/cm2" and control doses
# measured in any units of measurement:
#
Isotest(data.nm=invitrodata, data.control=controldata, id="experimentID",
        nano="name", response="value", dose="concentration", end="endpoint",
        end.cat="DNA STRAND BREAKS", unit="concentration_unit", unit.cat="ug/cm2",
        stat="E2", niter=1000, method="BH", control.opt="all", set.seed=1234)

#' # Example 2:
# Split geninvitro according to the endpoint and unit of the concentration
# and then perform test for the monotonic trend for each subset of data:
#
Isotest(data.nm=invitrodata, data.control=controldata,
        id="experimentID", nano="name", dose="concentration",
        response="value", stat="E2", niter=1000, method="BH", set.seed=1234,
        vars=c("endpoint","concentration_unit"))
</code></pre>

<hr>
<h2 id='IsoTest.nm'>Calculate the value of the test statistics for testing monotonic trend</h2><span id='topic+IsoTest.nm'></span>

<h3>Description</h3>

<p>This function provides the value of the test statistics (the global
likelihood test, Williams, Marcus, M or modified M test) for one nanomaterial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IsoTest.nm(data.nm, dose, response, stat=c("E2", "Williams","Marcus",
  "M", "ModM"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IsoTest.nm_+3A_data.nm">data.nm</code></td>
<td>
<p>Nanomaterial dataset</p>
</td></tr>
<tr><td><code id="IsoTest.nm_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration (with the same unit of measurement)</p>
</td></tr>
<tr><td><code id="IsoTest.nm_+3A_response">response</code></td>
<td>
<p>Response (a certain endpoint value)</p>
</td></tr>
<tr><td><code id="IsoTest.nm_+3A_stat">stat</code></td>
<td>
<p>Test statistics (&quot;<code>E2</code>&quot; for the global likelihood test,
&quot;<code>Williams</code>&quot; for Williams test, &quot;<code>Marcus</code>&quot; for Marcus test,
&quot;<code>M</code>&quot; for M test or &quot;<code>ModM</code>&quot; for modified M test)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to be used inside the function
<code><a href="#topic+Isotest">Isotest</a></code>. However, it can also be used to obtain the value of
a specified test statistics for one nanomaterial, with a particular unit of
measurement of the dose, for a certain toxicity endpoint.
</p>


<h3>Value</h3>

<p>This function calculates the value of the specified test statistics
for one nanomaterial
</p>


<h3>References</h3>

<p>Lin D., Pramana, S., Verbeke, T., and Shkedy, Z. (2015). IsoGene:
Order-Restricted Inference for Microarray Experiments. R package version
1.0-24. <a href="https://CRAN.R-project.org/package=IsoGene">https://CRAN.R-project.org/package=IsoGene</a>
</p>
<p>Lin D., Shkedy Z., Yekutieli D., Amaratunga D., and Bijnens, L. (editors).
(2012) Modeling Doseresponse Microarray Data in Early Drug Development
Experiments Using R. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Isotest">Isotest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#nm400 contains the result of genetic toxicity in vitro study of NM-400
#(Multi-walled carbon nanotubes) with associated controls
IsoTest.nm(data.nm=nm400, dose="concentration", response="value", stat="E2")
</code></pre>

<hr>
<h2 id='nm400'>NM-400 in vitro dataset</h2><span id='topic+nm400'></span>

<h3>Description</h3>

<p>This dataset contains the result of genetic toxicity in vitro study of NM-400
(Multi-walled carbon nanotubes) with associated controls and variables
related to the experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nm400)
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<ul>
<li><p>name: Project-assigned name of the nanomaterial
</p>
</li>
<li><p>publicname: A widely accepted unique identifier
</p>
</li>
<li><p>supplier: Supplier/project where the data is originated from
</p>
</li>
<li><p>experimentID: Identifier of the experiment
</p>
</li>
<li><p>method: Method/assay used in the experiment
</p>
</li>
<li><p>studyprovider: Study provider
</p>
</li>
<li><p>endpoint: Toxicity endpoint measure
</p>
</li>
<li><p>value: Endpoint value
</p>
</li>
<li><p>unit: Unit of the endpoint
</p>
</li>
<li><p>celltype: Type of the cell used in the experiment
</p>
</li>
<li><p>treatment: Indicator of the treatment
</p>
</li>
<li><p>exptimeunit: Unit of measurement of the exposure time
</p>
</li>
<li><p>exptime: Exposure time
</p>
</li>
<li><p>concentration_unit: Unit of measurement of the concentration in
variable <em>concentration</em>
</p>
</li>
<li><p>concentration: Concentration of the nanomaterial
</p>
</li>
<li><p>concentration_ml_unit: Unit of measurement of the concentration
in variable <em>concentration_ml</em>
</p>
</li>
<li><p>concentration_ml: Concentration of the nanomaterial in amount per
ml
</p>
</li></ul>



<h3>Source</h3>

<p>This dataset was obtained from
<a href="https://www.anses.fr/en/content/nanogenotox-project">https://www.anses.fr/en/content/nanogenotox-project</a> (NanoGenotox
project) and it was extracted from eNanoMapper database
<a href="https://search.data.enanomapper.net/">https://search.data.enanomapper.net/</a>
</p>
<p>The NANOGENOTOX Joint Action received funding from the European Union, in
the framework of the Health Programme under Grant Agreement n2009 21.
</p>
<p>Supported by European Union's Horizon 2020 research and innovation
programme under grant agreement No 814426 - NanoInformaTIX
<a href="https://www.nanoinformatix.eu/">https://www.nanoinformatix.eu/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nm400)



</code></pre>

<hr>
<h2 id='nmplot'>Create plots of the dose and the response for each nanomaterial in the
dataset</h2><span id='topic+nmplot'></span>

<h3>Description</h3>

<p>This function generates scatter plots of the dose and the response for each
nanomaterial in the dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nmplot(data.nm, data.control, id, nano, response, dose, end, end.cat,
  unit, unit.cat, type=c("dose","log"), control.opt=c("same","all"), vars,
  nrow=1, ncol=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nmplot_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="nmplot_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="nmplot_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="nmplot_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="nmplot_+3A_response">response</code></td>
<td>
<p>Response (endpoint value)</p>
</td></tr>
<tr><td><code id="nmplot_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="nmplot_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="nmplot_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="nmplot_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="nmplot_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="nmplot_+3A_type">type</code></td>
<td>
<p>Type of the dose to be plotted (&quot;<code>dose</code>&quot; for dose and
&quot;<code>log</code>&quot; for log(dose))</p>
</td></tr>
<tr><td><code id="nmplot_+3A_control.opt">control.opt</code></td>
<td>
<p>Option for the control doses if <code>unit</code> and
<code>unit.cat</code> are specified. If only control doses with the same unit of
measurement as the non-control ones are included, then specify
&quot;<code>same</code>&quot; in the <code>control.opt</code>. If all control doses with any
units of measurement are included, then specify &quot;<code>all</code>&quot;.</p>
</td></tr>
<tr><td><code id="nmplot_+3A_vars">vars</code></td>
<td>
<p>Variables used to subset the data</p>
</td></tr>
<tr><td><code id="nmplot_+3A_nrow">nrow</code></td>
<td>
<p>Number of row in the plotting space (default is 1)</p>
</td></tr>
<tr><td><code id="nmplot_+3A_ncol">ncol</code></td>
<td>
<p>Number of column in the plotting space (default is 1)</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>This function generates plots for each nanomaterial in the dataset (or
for each subset of data). The different types of nanomaterials are identified
by their names. Therefore, if some control values are named differently (see:
<code><a href="#topic+geninvitro">geninvitro</a></code> dataset and the <code>Examples</code>), a separate dataset
containing only these values first needs to be created. Controls in the new
dataset can be linked to the non-control observations belonging to the same
experiment through the identifier of the experiment (the linking is performed
inside this function). In this situation, it is necessary to have an
indicator that can identify different experiments (such as experiment ID).
</p>
</li>
<li><p>If all controls in the dataset are named according to the related
nanomaterial names, <code>data.control</code> and <code>id</code> do not need to be
specified.
</p>
</li>
<li><p>If doses used in the experiment are all measured in the same unit of
measurement, then specify &quot;<code>same</code>&quot; in <code>control.opt</code>.
</p>
</li>
<li><p>Dose-response plot can also be generated for subsets of data in each
nanomaterial, by specifying the variables used to split the data in
<code>vars</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>This function produces plots of the dose and the response for each
nanomaterial in the dataset
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"), include=FALSE)
#
# Generate dose-response plot for geninvitro, with DNA STRAND BREAKS as the
# endpoint, concentrations measured in ug/cm2 and controls measured in any
# units of measurement:
#
nmplot(data.nm=invitrodata, data.control=controldata, id="experimentID",
       nano="name", response="value", dose="concentration", end="endpoint",
       end.cat="DNA STRAND BREAKS", unit="concentration_unit",
       unit.cat="ug/cm2", type="dose", control.opt="all")

# Example 2:
# Split geninvitro data according to the cell type and unit of the
# concentration and generate dose-response plot for each
# subset of data with DNA STRAND BREAKS as the endpoint:
#
nmplot(data.nm=invitrodata, data.control=controldata, id="experimentID",
       nano="name", response="value", dose="concentration", end="endpoint",
       end.cat="DNA STRAND BREAKS", type="dose", nrow=2, ncol=2,
       vars=c("celltype","concentration_unit"))

</code></pre>

<hr>
<h2 id='nmplot.cat'>Create plots of the dose and the response grouped by a variable</h2><span id='topic+nmplot.cat'></span>

<h3>Description</h3>

<p>This function generates scatter plots of the dose and the response, with the
colour of the data points differentiated according to the value of a
variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nmplot.cat(data.nm, data.control, id, nano, response, dose, end,
  end.cat, unit, unit.cat, x.cat, type = c("dose", "log"), control.opt =
  c("same", "all"), vars, nrow = 1, ncol = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nmplot.cat_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_response">response</code></td>
<td>
<p>Response (endpoint value)</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_x.cat">x.cat</code></td>
<td>
<p>Variable used to differentiate the colour of the
data points in the plot(s)</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_type">type</code></td>
<td>
<p>Type of the dose to be plotted (&quot;<code>dose</code>&quot; for dose and
&quot;<code>log</code>&quot; for log(dose))</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_control.opt">control.opt</code></td>
<td>
<p>Option for the control doses if <code>unit</code> and
<code>unit.cat</code> are specified. If only control doses with
the same unit of measurement as the non-control ones are included, then
specify &quot;<code>same</code>&quot; in the <code>control.opt</code>. If all control doses with
any units of measurement are included, then specify &quot;<code>all</code>&quot;.</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_vars">vars</code></td>
<td>
<p>Variable(s) used to subset the data</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows in the plotting space (default is 1)</p>
</td></tr>
<tr><td><code id="nmplot.cat_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns in the plotting space (default is 1)</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>This function generates plots for each nanomaterial in the dataset (or
for each subset of data). The different types of nanomaterials are identified
by their names. Therefore, if some control values are named differently (see:
<code><a href="#topic+geninvitro">geninvitro</a></code> dataset and the <code>Examples</code>), a separate dataset
containing only these values first needs to be created. Controls in the new
dataset can be linked to the non-control observations belonging to the same
experiment through the identifier of the experiment (the linking is performed
inside this function). In this situation, it is necessary to have an
indicator that can identify different experiments (such as experiment ID).
</p>
</li>
<li><p>If all controls in the dataset are named according to the related
nanomaterial names, <code>data.control</code> and <code>id</code> do not need to be
specified.
</p>
</li>
<li><p>If doses used in the experiment are all measured in the same unit of
measurement, then specify &quot;<code>same</code>&quot; in <code>control.opt</code>.
</p>
</li>
<li><p>Dose-response plot can also be generated for subsets of data in each
nanomaterial by specifying the variables used to split the data in
<code>vars</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>This function produces scatter plots of the dose and the response,
grouped by a certain variable
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"), include=FALSE)

# Generate dose-response plots for geninvitro, with DNA STRAND BREAKS as
# the endpoint, concentrations measured in "ug/cm2" and control doses
# measured in any units of measurement (different colours represent different
# study providers):
#
nmplot.cat(data.nm=invitrodata, data.control=controldata, id="experimentID",
           nano="name", response="value", dose="concentration", end="endpoint",
           end.cat="DNA STRAND BREAKS", unit="concentration_unit", unit.cat="ug/cm2",
           x.cat="studyprovider", type="dose", control.opt="all",
           nrow=1, ncol=1)

# Example 2:
# Split geninvitro data according to the method, study provider and unit of
# the concentration, and generate dose-response plot for each subset of data
# with DNA STRAND BREAKS as the endpoint (different colours represent
# different cell types):
#
nmplot.cat(data.nm=invitrodata, data.control=controldata, id="experimentID",
           nano="name", response="value", dose="concentration", end="endpoint",
           end.cat="DNA STRAND BREAKS",  x.cat="celltype", type="dose",
           vars=c("method","studyprovider","concentration_unit"),
           nrow=2, ncol=2)
</code></pre>

<hr>
<h2 id='nmplot.n'>Create plots of the dose and the response for every unique value of a certain
variable</h2><span id='topic+nmplot.n'></span>

<h3>Description</h3>

<p>This function generates scatter plots of the dose and the response for every
unique value of a specified variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nmplot.n(data.nm, data.control, id, nano, response, dose, end,
  end.cat, unit, unit.cat, cat, type=c("dose","log"),
  control.opt=c("same","all"), nrow=1, ncol=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nmplot.n_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_response">response</code></td>
<td>
<p>Response (endpoint value)</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_cat">cat</code></td>
<td>
<p>Plot is generated for every unique value of <code>cat</code></p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_type">type</code></td>
<td>
<p>Type of the dose to be plotted (&quot;<code>dose</code>&quot; for dose and
&quot;<code>log</code>&quot; for log(dose))</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_control.opt">control.opt</code></td>
<td>
<p>Option for the control doses. If only control doses with
the same unit of measurement as the non-control ones are included, then
specify &quot;<code>same</code>&quot; in the <code>control.opt</code>. If all control doses with
any units of measurement are included, then specify &quot;<code>all</code>&quot;.</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows in the plotting space (default is 1)</p>
</td></tr>
<tr><td><code id="nmplot.n_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns in the plotting space (default is 1)</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>This function generates plots for each nanomaterial in the dataset. The
different types of nanomaterials are identified by their names. Therefore, if
some control values are named differently (see: <code><a href="#topic+geninvitro">geninvitro</a></code>
dataset and the <code>Examples</code>), a separate dataset containing only these
values first needs to be created. Controls in the new dataset can be linked
to the non-control observations belonging to the same experiment through the
identifier of the experiment (the linking is performed inside this function).
In this situation, it is necessary to have an indicator that can identify
different experiments (such as experiment ID).
</p>
</li>
<li><p>If all controls in the dataset are named according to the related
nanomaterial names, <code>data.control</code> and <code>id</code> do not need to be
specified.
</p>
</li>
<li><p>If doses used in the experiment are all measured in the same unit of
measurement, then specify &quot;<code>same</code>&quot; in <code>control.opt</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>This function produces scatter plots of the dose and the response for
every unique value of a specified variable
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"), include=FALSE)

# Generate dose-response plots for geninvitro, with DNA STRAND BREAKS as
# the endpoint, concentrations measured in "ug/cm2" and control doses
# measured in any units of measurement (plot is generated for each study
# provider):
#
nmplot.n(data.nm=invitrodata, data.control=controldata, id="experimentID",
         nano="name", response="value", dose="concentration", end="endpoint",
         end.cat="DNA STRAND BREAKS", unit="concentration_unit",
         unit.cat="ug/cm2", cat="studyprovider", type="dose",
         control.opt ="all", nrow=1, ncol=1)
</code></pre>

<hr>
<h2 id='nmplot.ncat'>Create plots of the dose and the response differentiated by specified
variables</h2><span id='topic+nmplot.ncat'></span>

<h3>Description</h3>

<p>This function generates scatter plots of the dose and the response for every
unique value of a certain variable, with the colour of the data points
differentiated according to the value of another variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nmplot.ncat(data.nm, data.control, id, nano, response, dose, end,
  end.cat, unit, unit.cat,  cat, x.cat, type=c("dose","log"),
  control.opt=c("same","all"), nrow=1, ncol=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nmplot.ncat_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_response">response</code></td>
<td>
<p>Response (endpoint value)</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_cat">cat</code></td>
<td>
<p>Plot is generated for every unique value of <code>cat</code></p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_x.cat">x.cat</code></td>
<td>
<p>Variable used to differentiate the colour of the data points in
the plot(s)</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_type">type</code></td>
<td>
<p>Type of the dose to be plotted (&quot;<code>dose</code>&quot; for dose and
&quot;<code>log</code>&quot; for log(dose))</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_control.opt">control.opt</code></td>
<td>
<p>Option for the control doses. If only control doses with
the same unit of measurement as the non-control ones are included, then
specify &quot;<code>same</code>&quot; in the <code>control.opt</code>. If all control doses with
any units of measurement are included, then specify &quot;<code>all</code>&quot;.</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_nrow">nrow</code></td>
<td>
<p>Number of rows in the plotting space (default is 1)</p>
</td></tr>
<tr><td><code id="nmplot.ncat_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns in the plotting space (default is 1)</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>This function generates plots for each nanomaterial in the dataset. The
different types of nanomaterials are identified by their names. Therefore, if
some control values are named differently (see: <code><a href="#topic+geninvitro">geninvitro</a></code>
dataset and the <code>Examples</code>), a separate dataset containing only these
values first needs to be created. Controls in the new dataset can be linked
to the non-control observations belonging to the same experiment through the
identifier of the experiment (the linking is performed inside this function).
In this situation, it is necessary to have an indicator that can identify
different experiments (such as experiment ID).
</p>
</li>
<li><p>If all controls in the dataset are named according to the related
nanomaterial names, <code>data.control</code> and <code>id</code> do not need to be
specified.
</p>
</li>
<li><p>If doses used in the experiment are all measured in the same unit of
measurement, then specify &quot;<code>same</code>&quot; in <code>control.opt</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>This function produces dose-response plots for every unique value of
a certain variable, with different colours of data points based on the
value of another variable
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"), include=FALSE)

# Generate dose-response plots for geninvitro, with DNA STRAND BREAKS as
# the endpoint and concentrations measured in "ug/cm2" (plot is generated for
# each study provider, with different colours represent different
# experiments):
#
nmplot.ncat(data.nm=invitrodata, data.control=controldata,
            id="experimentID", nano="name", response="value",
            dose="concentration", end="endpoint", end.cat="DNA STRAND BREAKS",
            unit="concentration_unit", unit.cat="ug/cm2", cat="studyprovider",
            x.cat="experimentID", type="dose", control.opt="same", nrow=1,
            ncol=1)

</code></pre>

<hr>
<h2 id='SplitData'>Split the data of each nanomaterial into different subsets of data</h2><span id='topic+SplitData'></span>

<h3>Description</h3>

<p>This function splits the data of each nanomaterial into different subsets of
data according to the unique values of selected variable(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SplitData(data.nm, data.control, id, nano, dose, end, end.cat, unit,
  unit.cat, control.opt=c("same","all"), vars)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SplitData_+3A_data.nm">data.nm</code></td>
<td>
<p>Data containing the result of toxicity study</p>
</td></tr>
<tr><td><code id="SplitData_+3A_data.control">data.control</code></td>
<td>
<p>Data of control values</p>
</td></tr>
<tr><td><code id="SplitData_+3A_id">id</code></td>
<td>
<p>Identifier of the experiment</p>
</td></tr>
<tr><td><code id="SplitData_+3A_nano">nano</code></td>
<td>
<p>Name of the nanomaterial</p>
</td></tr>
<tr><td><code id="SplitData_+3A_dose">dose</code></td>
<td>
<p>Dose or concentration</p>
</td></tr>
<tr><td><code id="SplitData_+3A_end">end</code></td>
<td>
<p>Toxicity endpoint</p>
</td></tr>
<tr><td><code id="SplitData_+3A_end.cat">end.cat</code></td>
<td>
<p>Specific toxicity endpoint of interest</p>
</td></tr>
<tr><td><code id="SplitData_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="SplitData_+3A_unit.cat">unit.cat</code></td>
<td>
<p>Specific unit of measurement of the dose</p>
</td></tr>
<tr><td><code id="SplitData_+3A_control.opt">control.opt</code></td>
<td>
<p>Option for the control doses if <code>unit</code> and
<code>unit.cat</code> are specified. If only control doses with the same unit of
measurement as the non-control ones are included, then specify
&quot;<code>same</code>&quot; in the <code>control.opt</code>. If all control doses with any
units of measurement are included, then specify &quot;<code>all</code>&quot;.</p>
</td></tr>
<tr><td><code id="SplitData_+3A_vars">vars</code></td>
<td>
<p>Variables used to split the data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function splits the data of each nanomaterial into different
subsets of data according to the unique values of selected variable(s)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1:
# Create a dataset containing controls (which are named differently)
# from geninvitro dataset:
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"))

# Exclude controls (which are named differently) from geninvitro dataset:
invitrodata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
             "medium", "medium + BSA", "untreated"), include=FALSE)
#
# Split geninvitro data according to the cell type, method, study provider,
# unit of the concentration and the type of the endpoint:
datasub&lt;-SplitData(data.nm=invitrodata, data.control=controldata,
                   id="experimentID", nano="name", dose="concentration",
                   vars=c("celltype", "method","studyprovider",
                   "concentration_unit","endpoint"))

# Example 2:
# Split geninvitro data with DNA STRAND BREAKS as the endpoint, according
# to the cell type, method, study provider, and unit of the concentration:
datasub2&lt;-SplitData(data.nm=invitrodata, data.control=controldata,
                    id="experimentID", nano="name", dose="concentration",
                    end="endpoint", end.cat="DNA STRAND BREAKS",
                    vars=c("celltype","method","studyprovider",
                    "concentration_unit"))

# Example 3:
# Split geninvitro data with DNA STRAND BREAKS as the endpoint and
# concentration measured in ug/cm2, according to the cell type:
datasub3&lt;-SplitData(data.nm=invitrodata, data.control=controldata,
                    id="experimentID", nano="name", dose="concentration",
                    end="endpoint", end.cat="DNA STRAND BREAKS",
                    unit="concentration_unit", unit.cat="ug/cm2",
                    control.opt="same", vars="celltype")
</code></pre>

<hr>
<h2 id='SubsetData'>Create a subset of data</h2><span id='topic+SubsetData'></span>

<h3>Description</h3>

<p>This function creates a subset of dataset according to specified criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SubsetData(data, x, x.cat, include = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SubsetData_+3A_data">data</code></td>
<td>
<p>Data, structured in a dataframe</p>
</td></tr>
<tr><td><code id="SubsetData_+3A_x">x</code></td>
<td>
<p>Variable(s) used to subset the data</p>
</td></tr>
<tr><td><code id="SubsetData_+3A_x.cat">x.cat</code></td>
<td>
<p>Specific criteria (value(s)) of <code>x</code> used to subset the data</p>
</td></tr>
<tr><td><code id="SubsetData_+3A_include">include</code></td>
<td>
<p>Include/exclude value specified in <code>x.cat</code>. If
<code>include = TRUE</code> (default value), then observations with
<code>x</code> = <code>x.cat</code> are selected. If <code>include = FALSE</code>, then
observations with value specified in <code>x.cat</code> will be omitted from the
subset of the data.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p>If there are several variable <code>x</code> used as criteria to subset the
data, <code>x.cat</code> can be written as <code>list(... , ...)</code>
</p>
</li>
<li><p>Values in <code>x.cat</code> should be specified in the same order as the
<code>x</code>'s
</p>
</li></ul>



<h3>Value</h3>

<p>This function returns a subset of data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create data of NM-400 (Multi-walled carbon nanotubes) from geninvitro dataset
data.sub&lt;-SubsetData(data=geninvitro, x="name",
x.cat="NM-400 (Multi-walled carbon nanotubes)", include = TRUE)

# Create data of NM-400 (Multi-walled carbon nanotubes)
# with DNA STRAND BREAKS as the endpoint from geninvitro dataset
data.sub&lt;-SubsetData(data=geninvitro, x=c("name","endpoint"),
x.cat=list("NM-400 (Multi-walled carbon nanotubes)","DNA STRAND BREAKS"),
include=TRUE)

# Exclude NM-400 (Multi-walled carbon nanotubes) from geninvitro dataset
data.sub&lt;-SubsetData(data=geninvitro, x="name",
x.cat="NM-400 (Multi-walled carbon nanotubes)", include = FALSE)

# Create data of NM-400 (Multi-walled carbon nanotubes)
# and NM-110 (Zinc Oxide, uncoated) from geninvitro dataset
data.sub&lt;-SubsetData(data=geninvitro, x="name",
x.cat=c("NM-400 (Multi-walled carbon nanotubes)",
"NM-110 (Zinc Oxide, uncoated)"), include = TRUE)

# Create data of NM-400 (Multi-walled carbon nanotubes)
# and NM-110 (Zinc Oxide, uncoated), with DNA STRAND BREAKS as the endpoint
data.sub&lt;-SubsetData(data=geninvitro, x=c("name","endpoint"),
x.cat=list(c("NM-400 (Multi-walled carbon nanotubes)",
"NM-110 (Zinc Oxide, uncoated)"),"DNA STRAND BREAKS"),include = TRUE)

# Create a new dataset containing only control values from geninvitro dataset
controldata&lt;-SubsetData(data=geninvitro, x="name", x.cat=c("control", "Control",
"medium", "medium + BSA", "untreated"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
