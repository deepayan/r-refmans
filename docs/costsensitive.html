<!DOCTYPE html><html lang="en"><head><title>Help for package costsensitive</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {costsensitive}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cost.proportionate.classifier'><p>Cost-Proportionate Classifier</p></a></li>
<li><a href='#predict.costprop'><p>Predict method for Cost-Proportionate Classifier</p></a></li>
<li><a href='#predict.rovr'><p>Predict method for Regression One-Vs-Rest</p></a></li>
<li><a href='#predict.wap'><p>Predict method for Weighted All-Pairs</p></a></li>
<li><a href='#predict.wovr'><p>Predict method for Weighted One-Vs-Rest</p></a></li>
<li><a href='#print.costprop'><p>Get information about Cost-Proportionate classifier object</p></a></li>
<li><a href='#print.rovr'><p>Get information about Regression One-Vs-Rest object</p></a></li>
<li><a href='#print.wap'><p>Get information about Weighted All-Pairs object</p></a></li>
<li><a href='#print.wovr'><p>Get information about Weighted One-Vs-Rest object</p></a></li>
<li><a href='#regression.one.vs.rest'><p>Regression One-Vs-Rest</p></a></li>
<li><a href='#summary.costprop'><p>Get information about Cost-Proportionate classifier object</p></a></li>
<li><a href='#summary.rovr'><p>Get information about Regression One-Vs-Rest object</p></a></li>
<li><a href='#summary.wap'><p>Get information about Weighted All-Pairs object</p></a></li>
<li><a href='#summary.wovr'><p>Get information about Weighted One-Vs-Rest object</p></a></li>
<li><a href='#weighted.all.pairs'><p>Weighted All-Pairs</p></a></li>
<li><a href='#weighted.one.vs.rest'><p>Weighted One-Vs-Rest</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Cost-Sensitive Multi-Class Classification</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2.10</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-07-28</td>
</tr>
<tr>
<td>Author:</td>
<td>David Cortes</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Cortes &lt;david.cortes.rivera@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Reduction-based techniques for cost-sensitive multi-class classification, in which each observation has a different cost for classifying it into one class, and the goal is to predict the class with the minimum expected cost for each new observation.
	Implements Weighted All-Pairs (Beygelzimer, A., Langford, J., &amp; Zadrozny, B., 2008, &lt;<a href="https://doi.org/10.1007%2F978-0-387-79361-0_1">doi:10.1007/978-0-387-79361-0_1</a>&gt;), Weighted One-Vs-Rest (Beygelzimer, A., Dani, V., Hayes, T., Langford, J., &amp; Zadrozny, B., 2005, <a href="https://dl.acm.org/citation.cfm?id=1102358">https://dl.acm.org/citation.cfm?id=1102358</a>) and Regression One-Vs-Rest.
	Works with arbitrary classifiers taking observation weights, or with regressors. Also implements cost-proportionate rejection sampling for working with classifiers
	that don't accept observation weights.</td>
</tr>
<tr>
<td>Suggests:</td>
<td>parallel</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/david-cortes/costsensitive">https://github.com/david-cortes/costsensitive</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-07-28 09:51:28 UTC; david</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-07-28 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cost.proportionate.classifier'>Cost-Proportionate Classifier</h2><span id='topic+cost.proportionate.classifier'></span>

<h3>Description</h3>

<p>Fits a classifier with sample weights by reducing the problem to classification
without sample weights through rejection sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cost.proportionate.classifier(X, y, weights, classifier, nsamples = 10,
  extra_rej_const = 0.1, nthreads = 1, seed = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cost.proportionate.classifier_+3A_x">X</code></td>
<td>
<p>Features/Covariates for each observation.</p>
</td></tr>
<tr><td><code id="cost.proportionate.classifier_+3A_y">y</code></td>
<td>
<p>Class for each observation.</p>
</td></tr>
<tr><td><code id="cost.proportionate.classifier_+3A_weights">weights</code></td>
<td>
<p>Weights for each observation.</p>
</td></tr>
<tr><td><code id="cost.proportionate.classifier_+3A_classifier">classifier</code></td>
<td>
<p>Base classifier to use.</p>
</td></tr>
<tr><td><code id="cost.proportionate.classifier_+3A_nsamples">nsamples</code></td>
<td>
<p>Number of resamples to take.</p>
</td></tr>
<tr><td><code id="cost.proportionate.classifier_+3A_extra_rej_const">extra_rej_const</code></td>
<td>
<p>Extra rejection constant - the higher, the smaller each sample ends up being,
but the smallest the chance that the highest-weighted observations would end up in each sample.</p>
</td></tr>
<tr><td><code id="cost.proportionate.classifier_+3A_nthreads">nthreads</code></td>
<td>
<p>Number of parallel threads to use (not available on Windows systems). Note
that, unlike the Python version, this is not a shared memory model and each additional thread will
require more memory from the system. Not recommended to use when the algorithm is itself parallelized.</p>
</td></tr>
<tr><td><code id="cost.proportionate.classifier_+3A_seed">seed</code></td>
<td>
<p>Random seed to use for the random number generation.</p>
</td></tr>
<tr><td><code id="cost.proportionate.classifier_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to 'classifier'.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Beygelzimer, A., Langford, J., &amp; Zadrozny, B. (2008). Machine learning techniques-reductions between prediction quality metrics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### example here requires 'caret' package
library(costsensitive)
data(iris)
set.seed(1)
X &lt;- iris[, c("Sepal.Length", "Sepal.Width", "Petal.Length", "Petal.Width")]
y &lt;- factor(iris$Species == "setosa", labels = c("class1", "class2"))
weights &lt;- rgamma(100, 1)
classifier &lt;- caret::train
model &lt;- cost.proportionate.classifier(X, y, weights, classifier,
  method = "glm", family = "binomial",
  trControl=caret::trainControl(method="none"), tuneLength=1)
predict(model, X, aggregation = "raw", type = "raw")
predict(model, X, aggregation = "weighted", type = "prob")

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.costprop'>Predict method for Cost-Proportionate Classifier</h2><span id='topic+predict.costprop'></span>

<h3>Description</h3>

<p>Predicts either the class or score according to predictions from classifiers fit to different
resamples each. Be aware that the base classifier with which it was built must provide appropriate outputs
that match with the arguments passed here ('type' and 'criterion'). This is usually managed through argument
'type' that goes to its 'predict' method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'costprop'
predict(object, newdata, aggregation = "raw",
  output_type = "score", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.costprop_+3A_object">object</code></td>
<td>
<p>An object of class 'costprop' as output by function 'cost.proportionate.classifier'.</p>
</td></tr>
<tr><td><code id="predict.costprop_+3A_newdata">newdata</code></td>
<td>
<p>New data on which to make predictions.</p>
</td></tr>
<tr><td><code id="predict.costprop_+3A_aggregation">aggregation</code></td>
<td>
<p>One of &quot;raw&quot; (will take the class according to votes from each classifier. The predictions from
classifiers must in turn be 1-dimensional vectors with the predicted class, not probabilities, scores, or two-dimensional
arrays - in package 'caret' for example, this corresponds to 'type = &quot;raw&quot;'), or &quot;weighted&quot; (will take a weighted
vote according to the probabilities or scores predicted by each classifier. The predictions from classifiers must in turn
be either 1-dimensional vectors with the predicted probability/score, or two-dimensional matrices with the second
column having the probability/score for the positive class = in package 'caret' for example, this corresponds to 'type = &quot;prob').</p>
</td></tr>
<tr><td><code id="predict.costprop_+3A_output_type">output_type</code></td>
<td>
<p>One of &quot;class&quot; (will output the predicted class) or &quot;score&quot; (will output the predicted score).</p>
</td></tr>
<tr><td><code id="predict.costprop_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the predict method of the base classifier.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### example here requires 'caret' package
library(costsensitive)
data(iris)
set.seed(1)
X &lt;- X &lt;- iris[, c("Sepal.Length", "Sepal.Width", "Petal.Length", "Petal.Width")]
y &lt;- factor(iris$Species == "setosa", labels = c("class1", "class2"))
weights &lt;- rgamma(100, 1)
classifier &lt;- caret::train
model &lt;- cost.proportionate.classifier(X, y, weights, classifier,
  method = "glm", family = "binomial",
  trControl=caret::trainControl(method="none"), tuneLength=1)
predict(model, X, aggregation = "raw", type = "raw")
predict(model, X, aggregation = "weighted", type = "prob")

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.rovr'>Predict method for Regression One-Vs-Rest</h2><span id='topic+predict.rovr'></span>

<h3>Description</h3>

<p>Predicts either class with expected minimum cost or the expected cost (less is better) for new data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rovr'
predict(object, newdata, type = "class", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.rovr_+3A_object">object</code></td>
<td>
<p>An object of class 'rovr' as output by function 'regression.one.vs.rest'.</p>
</td></tr>
<tr><td><code id="predict.rovr_+3A_newdata">newdata</code></td>
<td>
<p>New data on which to make predictions.</p>
</td></tr>
<tr><td><code id="predict.rovr_+3A_type">type</code></td>
<td>
<p>One of &quot;class&quot; (will output the class with minimum expected cost) or &quot;score&quot;
(will output the predicted cost for each class, i.e. less is better).</p>
</td></tr>
<tr><td><code id="predict.rovr_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the predict method of the base regressor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When passing 'type = &quot;class&quot;', a vector with class numbers or names (if the cost matrix had them).
When passing 'type = &quot;score&quot;', will output a 'data.frame' with the same number of columns as 'C' (passed to
the 'regression.one.vs.rest' function) and the predicted cost for each observation and class.
</p>

<hr>
<h2 id='predict.wap'>Predict method for Weighted All-Pairs</h2><span id='topic+predict.wap'></span>

<h3>Description</h3>

<p>Predicts either the class with expected minimum cost or scores (more is better) for new data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wap'
predict(object, newdata, type = "class",
  criterion = "most-wins", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.wap_+3A_object">object</code></td>
<td>
<p>An object of class 'wap' as output by function 'weighted.all.pairs'.</p>
</td></tr>
<tr><td><code id="predict.wap_+3A_newdata">newdata</code></td>
<td>
<p>New data on which to make predictions.</p>
</td></tr>
<tr><td><code id="predict.wap_+3A_type">type</code></td>
<td>
<p>One of &quot;class&quot; (will output the class with minimum expected cost) or &quot;score&quot;
(will output the predicted score for each class, i.e. more is better).</p>
</td></tr>
<tr><td><code id="predict.wap_+3A_criterion">criterion</code></td>
<td>
<p>One of &quot;goodness&quot; (will use the sum of probabilities output by each classifier) or &quot;most-wins&quot;
(will use the predicted class by each classifier).</p>
</td></tr>
<tr><td><code id="predict.wap_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the predict method of the base classifier.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When passing 'type = &quot;class&quot;', a vector with class numbers or names (if the cost matrix had them).
When passing 'type = &quot;score&quot;', will output a 'matrix' with the same number of columns as 'C' (passed to
the 'weighted.all.pairs' function) and the predicted score for each observation and class.
</p>

<hr>
<h2 id='predict.wovr'>Predict method for Weighted One-Vs-Rest</h2><span id='topic+predict.wovr'></span>

<h3>Description</h3>

<p>Predicts either the class with expected minimum cost or scores (more is better) for new data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wovr'
predict(object, newdata, type = "class", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.wovr_+3A_object">object</code></td>
<td>
<p>An object of class 'wovr' as output by function 'weighted.one.vs.rest'.</p>
</td></tr>
<tr><td><code id="predict.wovr_+3A_newdata">newdata</code></td>
<td>
<p>New data on which to make predictions.</p>
</td></tr>
<tr><td><code id="predict.wovr_+3A_type">type</code></td>
<td>
<p>One of &quot;class&quot; (will output the class with minimum expected cost) or &quot;score&quot;
(will output the predicted score for each class, i.e. more is better).</p>
</td></tr>
<tr><td><code id="predict.wovr_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the predict method of the base classifier.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When passing 'type = &quot;class&quot;', a vector with class numbers or names (if the cost matrix had them).
When passing 'type = &quot;score&quot;', will output a 'data.frame' with the same number of columns as 'C' (passed to
the 'weighted.one.vs.rest' function) and the predicted score for each observation and class.
</p>

<hr>
<h2 id='print.costprop'>Get information about Cost-Proportionate classifier object</h2><span id='topic+print.costprop'></span>

<h3>Description</h3>

<p>Prints basic information about a 'costprop' object
(Number of samples, rejection constant, random seed, class names, classifier class).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'costprop'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.costprop_+3A_x">x</code></td>
<td>
<p>An object of class &quot;costprop&quot;.</p>
</td></tr>
<tr><td><code id="print.costprop_+3A_...">...</code></td>
<td>
<p>Extra arguments (not used).</p>
</td></tr>
</table>

<hr>
<h2 id='print.rovr'>Get information about Regression One-Vs-Rest object</h2><span id='topic+print.rovr'></span>

<h3>Description</h3>

<p>Prints basic information about a 'rovr' object
(Number of classes, regressor class).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rovr'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.rovr_+3A_x">x</code></td>
<td>
<p>An object of class &quot;rovr&quot;.</p>
</td></tr>
<tr><td><code id="print.rovr_+3A_...">...</code></td>
<td>
<p>Extra arguments (not used).</p>
</td></tr>
</table>

<hr>
<h2 id='print.wap'>Get information about Weighted All-Pairs object</h2><span id='topic+print.wap'></span>

<h3>Description</h3>

<p>Prints basic information about a 'wap' object
(Number of classes and classifiers, classifier class).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wap'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.wap_+3A_x">x</code></td>
<td>
<p>An object of class &quot;wap&quot;.</p>
</td></tr>
<tr><td><code id="print.wap_+3A_...">...</code></td>
<td>
<p>Extra arguments (not used).</p>
</td></tr>
</table>

<hr>
<h2 id='print.wovr'>Get information about Weighted One-Vs-Rest object</h2><span id='topic+print.wovr'></span>

<h3>Description</h3>

<p>Prints basic information about a 'wovr' object
(Number of classes, classifier class).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wovr'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.wovr_+3A_x">x</code></td>
<td>
<p>An object of class &quot;wovr&quot;.</p>
</td></tr>
<tr><td><code id="print.wovr_+3A_...">...</code></td>
<td>
<p>Extra arguments (not used).</p>
</td></tr>
</table>

<hr>
<h2 id='regression.one.vs.rest'>Regression One-Vs-Rest</h2><span id='topic+regression.one.vs.rest'></span>

<h3>Description</h3>

<p>Creates a cost-sensitive classifier by creating one regressor per
class to predict cost. Takes as input a regressor rather than a classifier.
The objective is to create a model that would predict the
class with the minimum cost.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regression.one.vs.rest(X, C, regressor, nthreads = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regression.one.vs.rest_+3A_x">X</code></td>
<td>
<p>The data (covariates/features).</p>
</td></tr>
<tr><td><code id="regression.one.vs.rest_+3A_c">C</code></td>
<td>
<p>matrix(n_samples, n_classes) Costs for each class for each observation.</p>
</td></tr>
<tr><td><code id="regression.one.vs.rest_+3A_regressor">regressor</code></td>
<td>
<p>function(X, y, ...) -&gt; object, that would create regressor with method 'predict'.</p>
</td></tr>
<tr><td><code id="regression.one.vs.rest_+3A_nthreads">nthreads</code></td>
<td>
<p>Number of parallel threads to use (not available on Windows systems). Note
that, unlike the Python version, this is not a shared memory model and each additional thread will
require more memory from the system. Not recommended to use when the algorithm is itself parallelized.</p>
</td></tr>
<tr><td><code id="regression.one.vs.rest_+3A_...">...</code></td>
<td>
<p>Extra arguments to pass to 'regressor'.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Beygelzimer, A., Langford, J., &amp; Zadrozny, B. (2008). Machine learning techniques-reductions between prediction quality metrics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(costsensitive)
wrapped.lm &lt;- function(X, y, ...) {
	return(lm(y ~ ., data = X, ...))
}
set.seed(1)
X &lt;- data.frame(feature1 = rnorm(100), feature2 = rnorm(100), feature3 = runif(100))
C &lt;- data.frame(cost1 = rgamma(100, 1), cost2 = rgamma(100, 1), cost3 = rgamma(100, 1))
model &lt;- regression.one.vs.rest(X, C, wrapped.lm)
predict(model, X, type = "class")
predict(model, X, type = "score")
print(model)
</code></pre>

<hr>
<h2 id='summary.costprop'>Get information about Cost-Proportionate classifier object</h2><span id='topic+summary.costprop'></span>

<h3>Description</h3>

<p>Prints basic information about a 'costprop' object
(Number of samples, rejection constant, random seed, class names, classifier class).
Same as function 'print'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'costprop'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.costprop_+3A_object">object</code></td>
<td>
<p>An object of class &quot;costprop&quot;.</p>
</td></tr>
<tr><td><code id="summary.costprop_+3A_...">...</code></td>
<td>
<p>Extra arguments (not used).</p>
</td></tr>
</table>

<hr>
<h2 id='summary.rovr'>Get information about Regression One-Vs-Rest object</h2><span id='topic+summary.rovr'></span>

<h3>Description</h3>

<p>Prints basic information about a 'rovr' object
(Number of classes, regressor class). Same as function 'print'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rovr'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.rovr_+3A_object">object</code></td>
<td>
<p>An object of class &quot;rovr&quot;.</p>
</td></tr>
<tr><td><code id="summary.rovr_+3A_...">...</code></td>
<td>
<p>Extra arguments (not used).</p>
</td></tr>
</table>

<hr>
<h2 id='summary.wap'>Get information about Weighted All-Pairs object</h2><span id='topic+summary.wap'></span>

<h3>Description</h3>

<p>Prints basic information about a 'wap' object
(Number of classes and classifiers, classifier class). Same as function 'print'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wap'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.wap_+3A_object">object</code></td>
<td>
<p>An object of class &quot;wap&quot;.</p>
</td></tr>
<tr><td><code id="summary.wap_+3A_...">...</code></td>
<td>
<p>Extra arguments (not used).</p>
</td></tr>
</table>

<hr>
<h2 id='summary.wovr'>Get information about Weighted One-Vs-Rest object</h2><span id='topic+summary.wovr'></span>

<h3>Description</h3>

<p>Prints basic information about a 'wovr' object
(Number of classes, classifier class). Same as function 'print'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wovr'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.wovr_+3A_object">object</code></td>
<td>
<p>An object of class &quot;wovr&quot;.</p>
</td></tr>
<tr><td><code id="summary.wovr_+3A_...">...</code></td>
<td>
<p>Extra arguments (not used).</p>
</td></tr>
</table>

<hr>
<h2 id='weighted.all.pairs'>Weighted All-Pairs</h2><span id='topic+weighted.all.pairs'></span>

<h3>Description</h3>

<p>Creates a cost-sensitive classifier by creating one classifier per
pair of classes to predict cost. Takes as input a classifier accepting observation weights.
The objective is to create a model that would predict the
class with the minimum cost.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted.all.pairs(X, C, classifier, predict_type_prob = "prob",
  wap_weights = TRUE, nthreads = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weighted.all.pairs_+3A_x">X</code></td>
<td>
<p>The data (covariates/features).</p>
</td></tr>
<tr><td><code id="weighted.all.pairs_+3A_c">C</code></td>
<td>
<p>matrix(n_samples, n_classes) Costs for each class for each observation.</p>
</td></tr>
<tr><td><code id="weighted.all.pairs_+3A_classifier">classifier</code></td>
<td>
<p>function(X, y, weights=w, ...) -&gt; object, that would create a classifier with method 'predict'.
The 'y' vector passed to it is of class 'integer' with values 0/1 only.</p>
</td></tr>
<tr><td><code id="weighted.all.pairs_+3A_predict_type_prob">predict_type_prob</code></td>
<td>
<p>argument to pass to method 'predict' from the classifier passed to 'classifier'
in order to output probabilities (must be between zero and one) instead of classes
(i.e. 'predict(object, newdata, type=predict_type_prob')).</p>
</td></tr>
<tr><td><code id="weighted.all.pairs_+3A_wap_weights">wap_weights</code></td>
<td>
<p>Whether to use the weighting technique from the 'Weighted-All-Pairs' algorithm.</p>
</td></tr>
<tr><td><code id="weighted.all.pairs_+3A_nthreads">nthreads</code></td>
<td>
<p>Number of parallel threads to use (not available on Windows systems). Note
that, unlike the Python version, this is not a shared memory model and each additional thread will
require more memory from the system. Not recommended to use when the algorithm is itself parallelized.</p>
</td></tr>
<tr><td><code id="weighted.all.pairs_+3A_...">...</code></td>
<td>
<p>Extra arguments to pass to 'classifier'.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Beygelzimer, A., Langford, J., &amp; Zadrozny, B. (2008). Machine learning techniques-reductions between prediction quality metrics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(costsensitive)
wrapped.logistic &lt;- function(X, y, weights, ...) {
	return(glm(y ~ ., data = X, weights = weights, family = "quasibinomial", ...))
}
set.seed(1)
X &lt;- data.frame(feature1 = rnorm(100), feature2 = rnorm(100), feature3 = runif(100))
C &lt;- data.frame(cost1 = rgamma(100, 1), cost2 = rgamma(100, 1), cost3 = rgamma(100, 1))
model &lt;- weighted.all.pairs(X, C, wrapped.logistic, predict_type_prob = "response")
predict(model, X, type = "class")
predict(model, X, type = "score")
print(model)

</code></pre>

<hr>
<h2 id='weighted.one.vs.rest'>Weighted One-Vs-Rest</h2><span id='topic+weighted.one.vs.rest'></span>

<h3>Description</h3>

<p>Creates a cost-sensitive classifier by creating one classifier per
class to predict cost. Takes as input a classifier accepting observation weights.
The objective is to create a model that would predict the
class with the minimum cost.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weighted.one.vs.rest(X, C, classifier, predict_type_prob = "prob",
  wap_weights = FALSE, nthreads = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weighted.one.vs.rest_+3A_x">X</code></td>
<td>
<p>The data (covariates/features).</p>
</td></tr>
<tr><td><code id="weighted.one.vs.rest_+3A_c">C</code></td>
<td>
<p>matrix(n_samples, n_classes) Costs for each class for each observation.</p>
</td></tr>
<tr><td><code id="weighted.one.vs.rest_+3A_classifier">classifier</code></td>
<td>
<p>function(X, y, weights=w, ...) -&gt; object, that would create a classifier with method 'predict'.
The 'y' vector passed to it is of class 'integer' with values 0/1 only.</p>
</td></tr>
<tr><td><code id="weighted.one.vs.rest_+3A_predict_type_prob">predict_type_prob</code></td>
<td>
<p>argument to pass to method 'predict' from the classifier passed to 'classifier'
in order to output probabilities or numeric scores instead of classes
(i.e. 'predict(object, newdata, type=predict_type_prob')).</p>
</td></tr>
<tr><td><code id="weighted.one.vs.rest_+3A_wap_weights">wap_weights</code></td>
<td>
<p>Whether to use the weighting technique from the 'Weighted-All-Pairs' algorithm.</p>
</td></tr>
<tr><td><code id="weighted.one.vs.rest_+3A_nthreads">nthreads</code></td>
<td>
<p>Number of parallel threads to use (not available on Windows systems). Note
that, unlike the Python version, this is not a shared memory model and each additional thread will
require more memory from the system. Not recommended to use when the algorithm is itself parallelized.</p>
</td></tr>
<tr><td><code id="weighted.one.vs.rest_+3A_...">...</code></td>
<td>
<p>Extra arguments to pass to 'classifier'.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Beygelzimer, A., Dani, V., Hayes, T., Langford, J., &amp; Zadrozny, B. (2005, August). Error limiting reductions between classification tasks.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(costsensitive)
wrapped.logistic &lt;- function(X, y, weights, ...) {
	return(glm(y ~ ., data = X, weights = weights, family = "quasibinomial", ...))
}
set.seed(1)
X &lt;- data.frame(feature1 = rnorm(100), feature2 = rnorm(100), feature3 = runif(100))
C &lt;- data.frame(cost1 = rgamma(100, 1), cost2 = rgamma(100, 1), cost3 = rgamma(100, 1))
model &lt;- weighted.one.vs.rest(X, C, wrapped.logistic, predict_type_prob = "response")
predict(model, X, type = "class")
predict(model, X, type = "score")
print(model)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
