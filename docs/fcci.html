<!DOCTYPE html><html><head><title>Help for package fcci</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fcci}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fcci-package'><p>fcci: Feldman-Cousins Confidence Intervals</p></a></li>
<li><a href='#confint_binom'><p>Binomial proportion confidence intervals</p></a></li>
<li><a href='#confint_pois'><p>Poisson rate confidence intervals</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Feldman-Cousins Confidence Intervals</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Valerio Gherardi &lt;vgherard840@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>
	Provides support for building Feldman-Cousins confidence intervals 
	[G. J. Feldman and R. D. Cousins (1998) &lt;<a href="https://doi.org/10.1103%2FPhysRevD.57.3873">doi:10.1103/PhysRevD.57.3873</a>&gt;].</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, assertthat, rlang</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/vgherard/fcci">https://github.com/vgherard/fcci</a>, <a href="https://vgherard.github.io/fcci/">https://vgherard.github.io/fcci/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/vgherard/fcci/issues">https://github.com/vgherard/fcci/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-03 17:50:26 UTC; valerio</td>
</tr>
<tr>
<td>Author:</td>
<td>Valerio Gherardi <a href="https://orcid.org/0000-0002-8215-3013"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-07 13:53:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='fcci-package'>fcci: Feldman-Cousins Confidence Intervals</h2><span id='topic+fcci'></span><span id='topic+fcci-package'></span>

<h3>Description</h3>

<p>Provides support for building Feldman-Cousins confidence intervals 
[G. J. Feldman and R. D. Cousins (1998) &lt;doi:10.1103/PhysRevD.57.3873&gt;].
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Valerio Gherardi <a href="mailto:vgherard@sissa.it">vgherard@sissa.it</a> (<a href="https://orcid.org/0000-0002-8215-3013">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/vgherard/fcci">https://github.com/vgherard/fcci</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/vgherard/fcci/issues">https://github.com/vgherard/fcci/issues</a>
</p>
</li></ul>


<hr>
<h2 id='confint_binom'>Binomial proportion confidence intervals</h2><span id='topic+confint_binom'></span>

<h3>Description</h3>

<p>Build confidence intervals for binomial proportions using the Feldman-Cousins
construction (Feldman and Cousins, 1998).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confint_binom(n, N, cl = 0.95, acc = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint_binom_+3A_n">n</code></td>
<td>
<p>number of successes. Numeric vector of length one.</p>
</td></tr>
<tr><td><code id="confint_binom_+3A_n">N</code></td>
<td>
<p>number of trials. Numeric vector of length one.</p>
</td></tr>
<tr><td><code id="confint_binom_+3A_cl">cl</code></td>
<td>
<p>confidence level for the returned confidence interval.
A number between zero and one.</p>
</td></tr>
<tr><td><code id="confint_binom_+3A_acc">acc</code></td>
<td>
<p>required accuracy in the confidence interval endpoints.
A positive number.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details on the Feldman-Cousins construction can be found in the
documentation page of <a href="#topic+confint_pois">confint_pois</a>.
</p>


<h3>Value</h3>

<p>a numeric vector of length two, containing the confidence interval
endpoints.
</p>


<h3>References</h3>

<p>Feldman, Gary J. and Cousins, Robert D.
&quot;Unified approach to the classical statistical analysis of small signals&quot;
<em>Phys. Rev. D</em> <strong>57</strong>, issue 7 (1998): 3873-3889.
</p>


<h3>See Also</h3>

<p><a href="#topic+confint_pois">confint_pois</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>confint_binom(50, 100, cl = 0.95, acc = 1e-3)
</code></pre>

<hr>
<h2 id='confint_pois'>Poisson rate confidence intervals</h2><span id='topic+confint_pois'></span>

<h3>Description</h3>

<p>Build confidence intervals for the rate of a Poisson random variable using
the Feldman-Cousins construction (Feldman and Cousins, 1998).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confint_pois(
  n,
  b = 0,
  cl = 0.95,
  acc = 0.001 * (max(n - b, 0) + 1),
  lambda_min = NULL,
  lambda_max = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint_pois_+3A_n">n</code></td>
<td>
<p>number of events. Numeric vector of length one.</p>
</td></tr>
<tr><td><code id="confint_pois_+3A_b">b</code></td>
<td>
<p>expected number of background events. Numeric vector of length one
or three (see Details).</p>
</td></tr>
<tr><td><code id="confint_pois_+3A_cl">cl</code></td>
<td>
<p>confidence level for the returned confidence interval.
A number between zero and one.</p>
</td></tr>
<tr><td><code id="confint_pois_+3A_acc">acc</code></td>
<td>
<p>required accuracy in the confidence interval endpoints.
A positive number.</p>
</td></tr>
<tr><td><code id="confint_pois_+3A_lambda_min">lambda_min</code>, <code id="confint_pois_+3A_lambda_max">lambda_max</code></td>
<td>
<p>window of Poisson rate
values for whom the Neyman belt construction is performed. Numeric vectors of
length one or <code>NULL</code> (see Details). For advanced users only, use the
default value (<code>NULL</code>) if unsure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Feldman-Cousins confidence intervals construction
(Feldman and Cousins, 1998) provides a unified treatment for the estimation
of Poisson rates, which
produces consistent results for both the common case, where the number of
observed events <code>n</code> is greater than the number of background events
<code>b</code>, and the boundary cases, when <code>n</code> is equal or even less than
<code>b</code>. In these last cases, a naive treatment can lead to either
overcovering (that is, unnecessarily large confidence intervals;
this is the case for, <em>e.g.</em>, the intervals returned from
<code>stats::poisson.test</code> for zero events and no background) or,
even worse, undercovering and/or non-sensical confidence intervals
(relevant examples can be found in (Feldman and Cousins, 1998)).
</p>
<p>In order to find confidence intervals, the standard Neyman construction
is performed over a grid of values for the estimated rate. The search
interval can be controlled through the parameters <code>lambda_min</code> and
<code>lambda_max</code>; if these are left as default (<code>NULL</code>), they are
estimated automatically based on a rough estimate, which should be adequate
in a large majority of cases.
</p>
<p>The argument <code>b</code> controls the expected number of background events,
which would differ from zero if some of the event counts are expected
to correspond to spurious events. In other words, the number of total counts
<code>n</code> is assumed to follow a Poisson distribution with rate
<code>lambda + b</code>, with <code>b</code> known and <code>lambda</code> unknown and to be
estimated.
</p>
<p>The original reference discusses a minor correction to confidence intervals,
which ensures that the produced upper limits are decreasing functions of
<code>b</code>.
This is computationally intensive and not necessary for the correctness of
Feldman-Cousins confidence intervals, but may facilitate interpretation for
e.g. sensitivity analyses.
The correction can be implemented by providing a length three numeric to the
<code>b</code> argument, such that <code>b[[1]]</code> is the expected background rate as
before, while <code>b[[2]]</code> and <code>b[[3]]</code> represent a maximum value
for <code>b</code> and a grid step. The construction is repeated over the whole
grid of <code>b</code> values and the actual upper limit is chosen as the
greatest upper limit encountered in the sequence of intervals so constructed.
</p>


<h3>Value</h3>

<p>a numeric vector of length two, containing the confidence interval
endpoints.
</p>


<h3>References</h3>

<p>Feldman, Gary J. and Cousins, Robert D.
&quot;Unified approach to the classical statistical analysis of small signals&quot;
<em>Phys. Rev. D</em> <strong>57</strong>, issue 7 (1998): 3873-3889.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>confint_pois(n = 10, cl = 0.68)
confint_pois(n = 10, b = 5, cl = 0.68)

# Compare:
confint_pois(n = 0, cl = 0.95)
# with:
poisson.test(x = 0, conf.level = 0.95)$conf.int
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
