<!DOCTYPE html><html><head><title>Help for package nspmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nspmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#betablockers'><p>Beta-blockers Data</p></a></li>
<li><a href='#brca'><p>Z-values of BRCA Data</p></a></li>
<li><a href='#cnm'><p>Maximum Likelihood Estimation of a Nonparametric Mixture Model</p></a></li>
<li><a href='#cnmms'><p>Maximum Likelihood Estimation of a Semiparametric Mixture Model</p></a></li>
<li><a href='#cvps'><p>Class &lsquo;cvps&rsquo;</p></a></li>
<li><a href='#disc'><p>Class &lsquo;disc&rsquo;</p></a></li>
<li><a href='#lungcancer'><p>Lung Cancer Data</p></a></li>
<li><a href='#mlogit'><p>Class &lsquo;mlogit&rsquo;</p></a></li>
<li><a href='#npnorm'><p>Class &lsquo;npnorm&rsquo;</p></a></li>
<li><a href='#nppois'><p>Class &lsquo;nppois&rsquo;</p></a></li>
<li><a href='#plot.nspmix'><p>Class 'nspmix'</p></a></li>
<li><a href='#plotgrad'><p>Plot the Gradient Function</p></a></li>
<li><a href='#thai'><p>Illness Spells and Frequencies of Thai Preschool Children</p></a></li>
<li><a href='#toxo'><p>Toxoplasmosis Data</p></a></li>
<li><a href='#whist'><p>Weighted Histograms</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Nonparametric and Semiparametric Mixture Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-09-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Yong Wang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yong Wang &lt;yongwang@auckland.ac.nz&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>lsei</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics,methods,stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Mainly for maximum likelihood estimation of nonparametric
             and semiparametric mixture models, but can also be used
             for fitting finite mixtures. The algorithms are
             developed in Wang (2007)
             &lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2007.00583.x">doi:10.1111/j.1467-9868.2007.00583.x</a>&gt; and Wang (2010)
             &lt;<a href="https://doi.org/10.1007%2Fs11222-009-9117-z">doi:10.1007/s11222-009-9117-z</a>&gt;.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.stat.auckland.ac.nz/~yongwang/">https://www.stat.auckland.ac.nz/~yongwang/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-19 01:54:01 UTC; yong</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-20 14:40:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='betablockers'>Beta-blockers Data</h2><span id='topic+betablockers'></span>

<h3>Description</h3>

<p>Contains the data of the 22-center clinical trial of beta-blockers for
reducing mortality after myocardial infarction.
</p>


<h3>Format</h3>

<p>A numeric matrix with four columns:
</p>
<p>center: center identification code.
</p>
<p>deaths: the number of deaths in the center.
</p>
<p>total: the number of patients taking beta-blockers in the center.
</p>
<p>treatment: 0 for control, and 1 for treatment.
</p>


<h3>Source</h3>

<p>Aitkin, M. (1999). A general maximum likelihood analysis of variance
components in generalized linear models. <em>Biometrics</em>, <b>55</b>,
117-128.
</p>


<h3>References</h3>

<p>Wang, Y. (2010). Maximum likelihood computation for fitting semiparametric
mixture models. <em>Statistics and Computing</em>, <b>20</b>, 75-86.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlogit">mlogit</a></code>,<code><a href="#topic+cnmms">cnmms</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(betablockers)
x = mlogit(betablockers)
cnmms(x)


</code></pre>

<hr>
<h2 id='brca'>Z-values of BRCA Data</h2><span id='topic+brca'></span>

<h3>Description</h3>

<p>Contains 3226 <code class="reqn">z</code>-values computed by Efron (2004) from the data obtained
in a well-known microarray experiment concerning two types of genetic
mutations causing increased breast cancer risk, BRCA1 and BRCA2.
</p>


<h3>Format</h3>

<p>A numeric vector containing 3226 <code class="reqn">z</code>-values.
</p>


<h3>References</h3>

<p>Efron, B. (2004). Large-scale simultaneous hypothesis testing: the choice of
a null hypothesis. <em>Journal of the American Statistical Association</em>,
<b>99</b>, 96-104.
</p>
<p>Wang, Y. (2007). On fast computation of the non-parametric maximum
likelihood estimate of a mixing distribution. <em>Journal of the Royal
Statistical Society, Ser. B</em>, <b>69</b>, 185-198.
</p>
<p>Wang, Y. and C.-S. Chee (2012). Density estimation using nonparametric and
semiparametric mixtures. <em>Statistical Modelling: An International
Journal</em>, <b>12</b>, 67-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npnorm">npnorm</a></code>,<code><a href="#topic+cnm">cnm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(brca)
x = npnorm(brca)
plot(cnm(x), x)


</code></pre>

<hr>
<h2 id='cnm'>Maximum Likelihood Estimation of a Nonparametric Mixture Model</h2><span id='topic+cnm'></span>

<h3>Description</h3>

<p>Function <code>cnm</code> can be used to compute the maximum likelihood estimate
of a nonparametric mixing distribution (NPMLE) that has a one-dimensional
mixing parameter. or simply the mixing proportions with support points held
fixed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cnm(
  x,
  init = NULL,
  model = c("npmle", "proportions"),
  maxit = 100,
  tol = 1e-06,
  grid = 100,
  plot = c("null", "gradient", "probability"),
  verbose = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cnm_+3A_x">x</code></td>
<td>
<p>a data object of some class that is fully defined by the user. The
user needs to supply certain functions as described below.</p>
</td></tr>
<tr><td><code id="cnm_+3A_init">init</code></td>
<td>
<p>list of user-provided initial values for the mixing distribution
<code>mix</code> and the structural parameter <code>beta</code>.</p>
</td></tr>
<tr><td><code id="cnm_+3A_model">model</code></td>
<td>
<p>the type of model that is to estimated: the non-parametric MLE
(if <code>npmle</code>), or mixing proportions only (if <code>proportions</code>).</p>
</td></tr>
<tr><td><code id="cnm_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr><td><code id="cnm_+3A_tol">tol</code></td>
<td>
<p>a tolerance value needed to terminate an algorithm. Specifically,
the algorithm is terminated, if the increase of the log-likelihood value
after an iteration is less than <code>tol</code>.</p>
</td></tr>
<tr><td><code id="cnm_+3A_grid">grid</code></td>
<td>
<p>number of grid points that are used by the algorithm to locate
all the local maxima of the gradient function. A larger number increases the
chance of locating all local maxima, at the expense of an increased
computational cost. The locations of the grid points are determined by the
function <code>gridpoints</code> provided by each individual mixture family, and
they do not have to be equally spaced. If needed, a <code>gridpoints</code>
function may choose to return a different number of grid points than
specified by <code>grid</code>.</p>
</td></tr>
<tr><td><code id="cnm_+3A_plot">plot</code></td>
<td>
<p>whether a plot is produced at each iteration. Useful for
monitoring the convergence of the algorithm. If <code>="null"</code>, no plot is
produced. If <code>="gradient"</code>, it plots the gradient curves and if
<code>="probability"</code>, the <code>plot</code> function defined by the user for the
class is used.</p>
</td></tr>
<tr><td><code id="cnm_+3A_verbose">verbose</code></td>
<td>
<p>verbosity level for printing intermediate results in each
iteration, including none (= 0), the log-likelihood value (= 1), the maximum
gradient (= 2), the support points of the mixing distribution (= 3), the
mixing proportions (= 4), and if available, the value of the structural
parameter beta (= 5).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A finite mixture model has a density of the form
</p>
<p style="text-align: center;"><code class="reqn">f(x; \pi, \theta, \beta) = \sum_{j=1}^k \pi_j f(x; \theta_j,
\beta).</code>
</p>

<p>where <code class="reqn">\pi_j \ge 0</code> and <code class="reqn">\sum_{j=1}^k \pi_j </code><code class="reqn"> =1</code>.
</p>
<p>A nonparametric mixture model has a density of the form
</p>
<p style="text-align: center;"><code class="reqn">f(x; G) = \int f(x; \theta) d G(\theta),</code>
</p>
<p> where <code class="reqn">G</code> is a mixing distribution that is
completely unspecified. The maximum likelihood estimate of the nonparametric
<code class="reqn">G</code>, or the NPMLE of <code class="reqn">G</code>, is known to be a discrete distribution
function.
</p>
<p>Function <code>cnm</code> implements the CNM algorithm that is proposed in Wang
(2007) and the hierarchical CNM algorithm of Wang and Taylor (2013). The
implementation is generic using S3 object-oriented programming, in the sense
that it works for an arbitrary family of mixture models defined by the user.
The user, however, needs to supply the implementations of the following
functions for their self-defined family of mixture models, as they are
needed internally by function <code>cnm</code>:
</p>
<p><code>initial(x, beta, mix, kmax)</code>
</p>
<p><code>valid(x, beta)</code>
</p>
<p><code>logd(x, beta, pt, which)</code>
</p>
<p><code>gridpoints(x, beta, grid)</code>
</p>
<p><code>suppspace(x, beta)</code>
</p>
<p><code>length(x)</code>
</p>
<p><code>print(x, ...)</code>
</p>
<p><code>weight(x, ...)</code>
</p>
<p>While not needed by the algorithm for finding the solution, one may also
implement
</p>
<p><code>plot(x, mix, beta, ...)</code>
</p>
<p>so that the fitted model can be shown graphically in a user-defined way.
Inside <code>cnm</code>, it is used when <code>plot="probability"</code> so that the
convergence of the algorithm can be graphically monitored.
</p>
<p>For creating a new class, the user may consult the implementations of these
functions for the families of mixture models included in the package, e.g.,
<code>npnorm</code> and <code>nppois</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>family</code></td>
<td>
<p>the name of the mixture family that is used to fit to the
data.</p>
</td></tr>
<tr><td><code>num.iterations</code></td>
<td>
<p>number of iterations required by the algorithm</p>
</td></tr>
<tr><td><code>max.gradient</code></td>
<td>
<p>maximum value of the gradient function, evaluated at the
beginning of the final iteration</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>convergence code. <code>=0</code> means a success, and
<code>=1</code> reaching the maximum number of iterations</p>
</td></tr>
<tr><td><code>ll</code></td>
<td>
<p>log-likelihood value at convergence</p>
</td></tr>
<tr><td><code>mix</code></td>
<td>
<p>MLE of the mixing distribution, being an object of the class
<code>disc</code> for discrete distributions.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>value of the structural parameter, that is held fixed throughout
the computation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2007). On fast computation of the non-parametric maximum
likelihood estimate of a mixing distribution. <em>Journal of the Royal
Statistical Society, Ser. B</em>, <b>69</b>, 185-198.
</p>
<p>Wang, Y. (2010). Maximum likelihood computation for fitting semiparametric
mixture models. <em>Statistics and Computing</em>, <b>20</b>, 75-86
</p>
<p>Wang, Y. and Taylor, S. M. (2013). Efficient computation of nonparametric
survival functions via a hierarchical mixture formulation. <em>Statistics
and Computing</em>, <b>23</b>, 713-725.
</p>


<h3>See Also</h3>

<p><code><a href="lsei.html#topic+nnls">nnls</a></code>, <code><a href="#topic+npnorm">npnorm</a></code>, <code><a href="#topic+nppois">nppois</a></code>,
<code><a href="#topic+cnmms">cnmms</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Simulated data
x = rnppois(1000, disc(c(1,4), c(0.7,0.3))) # Poisson mixture
(r = cnm(x))
plot(r, x)

x = rnpnorm(1000, disc(c(0,4), c(0.3,0.7)), sd=1) # Normal mixture
plot(cnm(x), x)                        # sd = 1
plot(cnm(x, init=list(beta=0.5)), x)   # sd = 0.5
mix0 = disc(seq(min(x$v),max(x$v), len=100)) # over a finite grid
plot(cnm(x, init=list(beta=0.5, mix=mix0), model="p"),
    x, add=TRUE, col="blue")          # An approximate NPMLE

## Real-world data
data(thai)
plot(cnm(x &lt;- nppois(thai)), x)     # Poisson mixture

data(brca)
plot(cnm(x &lt;- npnorm(brca)), x)     # Normal mixture


</code></pre>

<hr>
<h2 id='cnmms'>Maximum Likelihood Estimation of a Semiparametric Mixture Model</h2><span id='topic+cnmms'></span><span id='topic+cnmpl'></span><span id='topic+cnmap'></span>

<h3>Description</h3>

<p>Functions <code>cnmms</code>, <code>cnmpl</code> and <code>cnmap</code> can be used to compute
the maximum likelihood estimate of a semiparametric mixture model that has a
one-dimensional mixing parameter. The types of mixture models that can be
computed include finite, nonparametric and semiparametric ones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cnmms(x, init=NULL, maxit=1000, model=c("spmle","npmle"), tol=1e-6,
     grid=100, kmax=Inf, plot=c("null", "gradient", "probability"),
     verbose=0)
cnmpl(x, init=NULL, tol=1e-6, tol.npmle=tol*1e-4, grid=100, maxit=1000,
     plot=c("null", "gradient", "probability"), verbose=0)
cnmap(x, init=NULL, maxit=1000, tol=1e-6, grid=100, plot=c("null",
     "gradient"), verbose=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cnmms_+3A_x">x</code></td>
<td>
<p>a data object of some class that can be defined fully by the user</p>
</td></tr>
<tr><td><code id="cnmms_+3A_init">init</code></td>
<td>
<p>list of user-provided initial values for the mixing distribution
<code>mix</code> and the structural parameter <code>beta</code></p>
</td></tr>
<tr><td><code id="cnmms_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="cnmms_+3A_model">model</code></td>
<td>
<p>the type of model that is to estimated: non-parametric MLE
(<code>npmle</code>) or semi-parametric MLE (<code>spmle</code>).</p>
</td></tr>
<tr><td><code id="cnmms_+3A_tol">tol</code></td>
<td>
<p>a tolerance value that is used to terminate an algorithm.
Specifically, the algorithm is terminated, if the relative increase of the
log-likelihood value after an iteration is less than <code>tol</code>. If an
algorithm converges rapidly enough, then <code>-log10(tol)</code> is roughly the
number of accurate digits in log-likelihood.</p>
</td></tr>
<tr><td><code id="cnmms_+3A_grid">grid</code></td>
<td>
<p>number of grid points that are used by the algorithm to locate
all the local maxima of the gradient function. A larger number increases the
chance of locating all local maxima, at the expense of an increased
computational cost. The locations of the grid points are determined by the
function <code>gridpoints</code> provided by each individual mixture family, and
they do not have to be equally spaced. If needed, an individual
<code>gridpoints</code> function may return a different number of grid points than
specified by <code>grid</code>.</p>
</td></tr>
<tr><td><code id="cnmms_+3A_kmax">kmax</code></td>
<td>
<p>upper bound on the number of support points. This is
particularly useful for fitting a finite mixture model.</p>
</td></tr>
<tr><td><code id="cnmms_+3A_plot">plot</code></td>
<td>
<p>whether a plot is produced at each iteration. Useful for
monitoring the convergence of the algorithm. If <code>null</code>, no plot is
produced. If <code>gradient</code>, it plots the gradient curves and if
<code>probability</code>, the <code>plot</code> function defined by the user of the
class is used.</p>
</td></tr>
<tr><td><code id="cnmms_+3A_verbose">verbose</code></td>
<td>
<p>verbosity level for printing intermediate results in each
iteration, including none (= 0), the log-likelihood value (= 1), the maximum
gradient (= 2), the support points of the mixing distribution (= 3), the
mixing proportions (= 4), and if available, the value of the structural
parameter beta (= 5).</p>
</td></tr>
<tr><td><code id="cnmms_+3A_tol.npmle">tol.npmle</code></td>
<td>
<p>a tolerance value that is used to terminate the computing
of the NPMLE internally.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>cnmms</code> can also be used to compute the maximum likelihood
estimate of a finite or nonparametric mixture model.
</p>
<p>A finite mixture model has a density of the form
</p>
<p style="text-align: center;"><code class="reqn">f(x; \pi, \theta, \beta) = \sum_{j=1}^k \pi_j f(x; \theta_j,
\beta).</code>
</p>

<p>where <code class="reqn">pi_j \ge 0</code> and <code class="reqn">\sum_{j=1}^k pi_j </code><code class="reqn"> =1</code>.
</p>
<p>A nonparametric mixture model has a density of the form
</p>
<p style="text-align: center;"><code class="reqn">f(x; G) = \int f(x; \theta) d G(\theta),</code>
</p>
<p> where <code class="reqn">G</code> is a mixing distribution that is
completely unspecified. The maximum likelihood estimate of the nonparametric
<code class="reqn">G</code>, or the NPMLE of $<code class="reqn">G</code>, is known to be a discrete distribution
function.
</p>
<p>A semiparametric mixture model has a density of the form
</p>
<p style="text-align: center;"><code class="reqn">f(x; G, \beta) = \int f(x; \theta, \beta) d G(\theta),</code>
</p>

<p>where <code class="reqn">G</code> is a mixing distribution that is completely unspecified and
<code class="reqn">\beta</code> is the structural parameter.
</p>
<p>Of the three functions, <code>cnmms</code> is recommended for most problems; see
Wang (2010).
</p>
<p>Functions <code>cnmms</code>, <code>cnmpl</code> and <code>cnmap</code> implement the
algorithms CNM-MS, CNM-PL and CNM-AP that are described in Wang (2010).
Their implementations are generic using S3 object-oriented programming, in
the sense that they can work for an arbitrary family of mixture models that
is defined by the user. The user, however, needs to supply the
implementations of the following functions for their self-defined family of
mixture models, as they are needed internally by the functions above:
</p>
<p><code>initial(x, beta, mix, kmax)</code>
</p>
<p><code>valid(x, beta)</code>
</p>
<p><code>logd(x, beta, pt, which)</code>
</p>
<p><code>gridpoints(x, beta, grid)</code>
</p>
<p><code>suppspace(x, beta)</code>
</p>
<p><code>length(x)</code>
</p>
<p><code>print(x, ...)</code>
</p>
<p><code>weight(x, ...)</code>
</p>
<p>While not needed by the algorithms, one may also implement
</p>
<p><code>plot(x, mix, beta, ...)</code>
</p>
<p>so that the fitted model can be shown graphically in a way that the user
desires.
</p>
<p>For creating a new class, the user may consult the implementations of these
functions for the families of mixture models included in the package, e.g.,
<code>cvp</code> and <code>mlogit</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>family</code></td>
<td>
<p>the class of the mixture family that is used to fit to the
data.</p>
</td></tr>
<tr><td><code>num.iterations</code></td>
<td>
<p>Number of iterations required by the algorithm</p>
</td></tr>
<tr><td><code>grad</code></td>
<td>
<p>For <code>cnmms</code>, it contains the values of the gradient
function at the support points and the first derivatives of the
log-likelihood with respect to theta and beta. For <code>cnmpl</code>, it contains
only the first derivatives of the log-likelihood with respect to beta. For
<code>cnmap</code>, it contains only the gradient of <code>beta</code>.</p>
</td></tr>
<tr><td><code>max.gradient</code></td>
<td>
<p>Maximum value of the gradient function, evaluated at the
beginning of the final iteration. It is only given by function
<code>cnmap</code>.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>convergence code. <code>=0</code> means a success, and
<code>=1</code> reaching the maximum number of iterations</p>
</td></tr>
<tr><td><code>ll</code></td>
<td>
<p>log-likelihood value at convergence</p>
</td></tr>
<tr><td><code>mix</code></td>
<td>
<p>MLE of the mixing distribution, being an object of the class
<code>disc</code> for discrete distributions</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>MLE of the structural parameter</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2007). On fast computation of the non-parametric maximum
likelihood estimate of a mixing distribution. <em>Journal of the Royal
Statistical Society, Ser. B</em>, <b>69</b>, 185-198.
</p>
<p>Wang, Y. (2010). Maximum likelihood computation for fitting semiparametric
mixture models. <em>Statistics and Computing</em>, <b>20</b>, 75-86
</p>


<h3>See Also</h3>

<p><code><a href="lsei.html#topic+nnls">nnls</a></code>, <code><a href="#topic+cnm">cnm</a></code>, <code><a href="#topic+cvp">cvp</a></code>,
<code><a href="#topic+cvps">cvps</a></code>, <code><a href="#topic+mlogit">mlogit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Compute the MLE of a finite mixture
x = rnpnorm(100, disc(c(0,4), c(0.7,0.3)), sd=1)
for(k in 1:6) plot(cnmms(x, kmax=k), x, add=(k&gt;1), comp="null", col=k+1,
                  main="Finite Normal Mixtures")
legend("topright", 0.3, leg=paste0("k = ",1:6), lty=1, lwd=2, col=2:7)

## Compute a semiparametric MLE
# Common variance problem 
x = rcvps(k=50, ni=5:10, mu=c(0,4), pr=c(0.7,0.3), sd=3)
cnmms(x)              # CNM-MS algorithm
cnmpl(x)              # CNM-PL algorithm
cnmap(x)              # CNM-AP algorithm

# Logistic regression with a random intercept
x = rmlogit(k=30, gi=3:5, ni=6:10, pt=c(0,4), pr=c(0.7,0.3),
           beta=c(0,3))
cnmms(x)

data(toxo)            # k = 136
cnmms(mlogit(toxo))

</code></pre>

<hr>
<h2 id='cvps'>Class &lsquo;cvps&rsquo;</h2><span id='topic+cvps'></span><span id='topic+cvp'></span><span id='topic+rcvp'></span><span id='topic+rcvps'></span><span id='topic+print.cvps'></span>

<h3>Description</h3>

<p>These functions can be used to study a common variance problem (CVP), where
univariate observations fall in known groups. Observations in each group are
assumed to have the same mean, but different groups may have different
means. All observations are assumed to have a common variance, despite their
different means, hence giving the name of the problem. It is a
random-effects problem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvps(x)
rcvp(k, ni=2, mu=0, pr=1, sd=1)
rcvps(k, ni=2, mu=0, pr=1, sd=1)
## S3 method for class 'cvps'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvps_+3A_x">x</code></td>
<td>
<p>CVP data in the raw form as an argument in <code>cvps</code>, or an
object of class <code>cvps</code> in <code>print.cvps</code>.</p>
</td></tr>
<tr><td><code id="cvps_+3A_k">k</code></td>
<td>
<p>the number of groups.</p>
</td></tr>
<tr><td><code id="cvps_+3A_ni">ni</code></td>
<td>
<p>a numeric vector that gives the sample size in each group.</p>
</td></tr>
<tr><td><code id="cvps_+3A_mu">mu</code></td>
<td>
<p>a numeric vector for all the theoretical means.</p>
</td></tr>
<tr><td><code id="cvps_+3A_pr">pr</code></td>
<td>
<p>a numeric vector for all the probabilities associated with the
theoretical means.</p>
</td></tr>
<tr><td><code id="cvps_+3A_sd">sd</code></td>
<td>
<p>a scalar for the standard deviation that is common to all
observations.</p>
</td></tr>
<tr><td><code id="cvps_+3A_...">...</code></td>
<td>
<p>arguments passed on to function <code>print</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Class <code>cvps</code> is used to store the CVP data in a summarized form.
</p>
<p>Function <code>cvps</code> creates an object of class <code>cvps</code>, given a matrix
that stores the values (column 2) and their grouping information (column 1).
</p>
<p>Function <code>rcvp</code> generates a random sample in the raw form for a common
variance problem, where the means follow a discrete distribution.
</p>
<p>Function <code>rcvps</code> generates a random sample in the summarized form for a
common variance problem, where the means follow a discrete distribution.
</p>
<p>Function <code>print.cvps</code> prints the CVP data given in the summarized form.
</p>
<p>The raw form of the CVP data is a two-column matrix, where each row
represents an observation. The two columns along each row give,
respectively, the group membership (<code>group</code>) and the value (<code>x</code>)
of an observation.
</p>
<p>The summarized form of the CVP data is a four-column matrix, where each row
represents the summarized data for all observations in a group. The four
columns along each row give, respectively, the group number (<code>group</code>),
the number of observations in the group (<code>ni</code>), the sample mean of the
observations in the group (<code>mi</code>), and the residual sum of squares of
the observations in the group (<code>ri</code>).
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Neyman, J. and Scott, E. L. (1948). Consistent estimates based on partially
consistent observations. <em>Econometrica</em>, <b>16</b>, 1-32.
</p>
<p>Kiefer, J. and Wolfowitz, J. (1956). Consistency of the maximum likelihood
estimator in the presence of infinitely many incidental parameters.
<em>Ann. Math. Stat.</em>, <b>27</b>, 886-906.
</p>
<p>Wang, Y. (2010). Maximum likelihood computation for fitting semiparametric
mixture models. <em>Statistics and Computing</em>, <b>20</b>, 75-86.
</p>


<h3>See Also</h3>

<p><code><a href="lsei.html#topic+nnls">nnls</a></code>, <code><a href="#topic+cnmms">cnmms</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

x = rcvps(k=50, ni=5:10, mu=c(0,4), pr=c(0.7,0.3), sd=3)
cnmms(x)              # CNM-MS algorithm
cnmpl(x)              # CNM-PL algorithm
cnmap(x)              # CNM-AP algorithm


</code></pre>

<hr>
<h2 id='disc'>Class &lsquo;disc&rsquo;</h2><span id='topic+disc'></span><span id='topic+print.disc'></span>

<h3>Description</h3>

<p>Class <code>disc</code> is used to represent an arbitrary univariate discrete
distribution with a finite number of support points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disc(pt, pr=1)
## S3 method for class 'disc'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="disc_+3A_pt">pt</code></td>
<td>
<p>a numeric vector for support points.</p>
</td></tr>
<tr><td><code id="disc_+3A_pr">pr</code></td>
<td>
<p>a numeric vector for probability values at the support points.</p>
</td></tr>
<tr><td><code id="disc_+3A_x">x</code></td>
<td>
<p>an object of class <code>disc</code>.</p>
</td></tr>
<tr><td><code id="disc_+3A_...">...</code></td>
<td>
<p>arguments passed on to function <code>print</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>disc</code> creates an object of class <code>disc</code>, given the
support points and probability values at these points.
</p>
<p>Function <code>print.disc</code> prints the discrete distribution.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cnm">cnm</a></code>, <code><a href="#topic+cnmms">cnmms</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

(d = disc(pt=c(0,4), pr=c(0.3,0.7)))

</code></pre>

<hr>
<h2 id='lungcancer'>Lung Cancer Data</h2><span id='topic+lungcancer'></span>

<h3>Description</h3>

<p>Contains the data of 14 studies of the effect of smoking on lung cancer.
</p>


<h3>Format</h3>

<p>A numeric matrix with four columns:
</p>
<p>study: study identification code.
</p>
<p>lungcancer: the number of people diagnosed with lung cancer.
</p>
<p>size: the number of people in the study.
</p>
<p>smoker: 0 for smoker, and 1 for non-smoker.
</p>


<h3>Source</h3>

<p>Booth, J. G. and Hobert, J. P. (1999). Maximizing generalized linear mixed
model likelihoods with an automated Monte Carlo EM algorithm. <em>Journal
of the Royal Statistical Society, Ser. B</em>, <b>61</b>, 265-285.
</p>


<h3>References</h3>

<p>Wang, Y. (2010). Maximum likelihood computation for fitting semiparametric
mixture models. <em>Statistics and Computing</em>, <b>20</b>, 75-86.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlogit">mlogit</a></code>,<code><a href="#topic+cnmms">cnmms</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(lungcancer)
x = mlogit(lungcancer)
cnmms(x)


</code></pre>

<hr>
<h2 id='mlogit'>Class &lsquo;mlogit&rsquo;</h2><span id='topic+mlogit'></span><span id='topic+rmlogit'></span>

<h3>Description</h3>

<p>These functions can be used to fit a binomial logistic regression model that
has a random intercept to clustered observations. Observations in each
cluster are assumed to have the same intercept, while different clusters may
have different intercepts. This is a mixed-effects problem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlogit(x)
rmlogit(k, gi=2, ni=2, pt=0, pr=1, beta=1, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlogit_+3A_x">x</code></td>
<td>
<p>a numeric matrix with four or more columns that stores clustered
data.</p>
</td></tr>
<tr><td><code id="mlogit_+3A_k">k</code></td>
<td>
<p>the number of groups or clusters.</p>
</td></tr>
<tr><td><code id="mlogit_+3A_gi">gi</code></td>
<td>
<p>a numeric vector that gives the sample size in each group.</p>
</td></tr>
<tr><td><code id="mlogit_+3A_ni">ni</code></td>
<td>
<p>a numeric vector for the number of Bernoulli trials for each
observation.</p>
</td></tr>
<tr><td><code id="mlogit_+3A_pt">pt</code></td>
<td>
<p>a numeric vector for all the support points.</p>
</td></tr>
<tr><td><code id="mlogit_+3A_pr">pr</code></td>
<td>
<p>a numeric vector for all the probabilities associated with the
support points.</p>
</td></tr>
<tr><td><code id="mlogit_+3A_beta">beta</code></td>
<td>
<p>a numeric vector for the fixed coefficients of the covariates of
the observation.</p>
</td></tr>
<tr><td><code id="mlogit_+3A_x">X</code></td>
<td>
<p>the numeric matrix as the design matrix. If missing, a random
matrix is created from a normal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Class <code>mlogit</code> is used to store data for fitting the binomial logistic
regression model with a random intercept.
</p>
<p>Function <code>mlogit</code> creates an object of class <code>mlogit</code>, given a
matrix with four or more columns that stores, respectively, the
group/cluster membership (column 1), the number of ones or successes in the
Bernoulli trials (column 2), the number of the Bernoulli trials (column 3),
and the covariates (columns 4+).
</p>
<p>Function <code>rmlogit</code> generates a random sample that is saved as an object
of class <code>mlogit</code>.
</p>
<p>An object of class <code>mlogit</code> contains a matrix with four or more
columns, that stores, respectively, the group/cluster membership (column 1),
the number of ones or successes in the Bernoulli trials (column 2), the
number of the Bernoulli trials (column 3), and the covariates (columns 4+).
</p>
<p>It also has two additional attributes that facilitate the computing by
function <code>cmmms</code>. The first attribute is <code>ui</code>, which stores the
unique values of group memberships, and the second is <code>gi</code>, the number
of observations in each unique group.
</p>
<p>It is convenient to use function <code>mlogit</code> to create an object of class
<code>mlogit</code>.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Kiefer, J. and Wolfowitz, J. (1956). Consistency of the maximum likelihood
estimator in the presence of infinitely many incidental parameters.
<em>Ann. Math. Stat.</em>, <b>27</b>, 886-906.
</p>
<p>Wang, Y. (2010). Maximum likelihood computation for fitting semiparametric
mixture models. <em>Statistics and Computing</em>, <b>20</b>, 75-86.
</p>


<h3>See Also</h3>

<p><code><a href="lsei.html#topic+nnls">nnls</a></code>, <code><a href="#topic+cnmms">cnmms</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

x = rmlogit(k=30, gi=3:5, ni=6:10, pt=c(0,4), pr=c(0.7,0.3),
           beta=c(0,3))    
cnmms(x)

### Real-world data
# Random intercept logistic model
data(toxo)
cnmms(mlogit(toxo))

data(betablockers)
cnmms(mlogit(betablockers))

data(lungcancer)
cnmms(mlogit(lungcancer))

</code></pre>

<hr>
<h2 id='npnorm'>Class &lsquo;npnorm&rsquo;</h2><span id='topic+npnorm'></span><span id='topic+rnpnorm'></span><span id='topic+plot.npnorm'></span>

<h3>Description</h3>

<p>Class <code>npnorm</code> can be used to store data that will be
processed as those of a nonparametric normal mixture. There are
several functions associated with the class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npnorm(v, w=1)
rnpnorm(n, mix=disc(0), sd=1)
## S3 method for class 'npnorm'
plot(x, mix, beta, breaks=NULL, col="red", len=100,
    add=FALSE, border.col=NULL, border.lwd=1,
    fill="lightgrey", main, lwd=2, lty=1, xlab="Data",
    ylab="Density", components=c("proportions","curves","null"),
    lty.components=2, lwd.components=2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npnorm_+3A_v">v</code></td>
<td>
<p>a numeric vector that stores the values of a sample.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_w">w</code></td>
<td>
<p>a numeric vector that stores the corresponding weights/frequencies
of the observations.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_n">n</code></td>
<td>
<p>the sample size.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_mix">mix</code></td>
<td>
<p>an object of class <code>disc</code>, for a discrete distribution.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_beta">beta</code></td>
<td>
<p>the structural parameter.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_sd">sd</code></td>
<td>
<p>a scalar for the component standard deviation that is common to
all components.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_x">x</code></td>
<td>
<p>an object of class <code>npnorm</code>.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_breaks">breaks</code></td>
<td>
<p>the rough number bins used for plotting the histogram.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_col">col</code></td>
<td>
<p>the color of the density curve to be plotted.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_len">len</code></td>
<td>
<p>the number of points roughly used to plot the density curve over
the interval of length 8 times the component standard deviation around each
component mean.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_add">add</code></td>
<td>
<p>if <code>FALSE</code>, creates a new plot; if <code>TRUE</code>, adds the
plot to the existing one.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_border.col">border.col</code></td>
<td>
<p>color for the border of histogram boxes.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_border.lwd">border.lwd</code></td>
<td>
<p>line width for the border of histogram boxes.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_fill">fill</code></td>
<td>
<p>color to fill in the histogram boxes.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_components">components</code></td>
<td>
<p>if <code>proportions</code> (default), also show the support
points and mixing proportions; if <code>curves</code>, also show the component
density curves; if <code>null</code>, components are not shown.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_lty.components">lty.components</code>, <code id="npnorm_+3A_lwd.components">lwd.components</code></td>
<td>
<p>line type and width for the component
curves.</p>
</td></tr>
<tr><td><code id="npnorm_+3A_main">main</code>, <code id="npnorm_+3A_lwd">lwd</code>, <code id="npnorm_+3A_lty">lty</code>, <code id="npnorm_+3A_xlab">xlab</code>, <code id="npnorm_+3A_ylab">ylab</code></td>
<td>
<p>arguments for graphical parameters (see
<code>par</code>).</p>
</td></tr>
<tr><td><code id="npnorm_+3A_...">...</code></td>
<td>
<p>arguments passed on to function <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>npnorm</code> creates an object of class <code>npnorm</code>,
given values and weights/frequencies.
</p>
<p>Function <code>rnpnorm</code> generates a random sample from a normal
mixture and saves the data as an object of class <code>npnorm</code>.
</p>
<p>Function <code>plot.npnorm</code> plots the normal mixture.
</p>
<p>When <code>components="proportions"</code>, the component means are
shown on the horizontal line of density 0. The vertical lines
going upwardly at the support points are proportional to the
mixing proportions at these points.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2007). On fast computation of the non-parametric maximum
likelihood estimate of a mixing distribution. <em>Journal of the Royal
Statistical Society, Ser. B</em>, <b>69</b>, 185-198.
</p>


<h3>See Also</h3>

<p><code><a href="lsei.html#topic+nnls">nnls</a></code>, <code><a href="#topic+cnm">cnm</a></code>, <code><a href="#topic+cnmms">cnmms</a></code>,
<code><a href="#topic+plot.nspmix">plot.nspmix</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mix = disc(pt=c(0,4), pr=c(0.3,0.7))  # a discrete distribution
x = rnpnorm(200, mix, sd=1)
plot(x, mix, beta=1)

</code></pre>

<hr>
<h2 id='nppois'>Class &lsquo;nppois&rsquo;</h2><span id='topic+nppois'></span><span id='topic+rnppois'></span><span id='topic+plot.nppois'></span>

<h3>Description</h3>

<p>Class <code>nppois</code> is used to store data that will be processed as those of
a nonparametric Poisson mixture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nppois(v, w=1)
rnppois(n, mix=disc(1))
## S3 method for class 'nppois'
plot(x, mix, beta, col="red", add=FALSE,
    components=TRUE, main="nppois", lwd=1, lty=1, xlab="Data",
    ylab="Density", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nppois_+3A_v">v</code></td>
<td>
<p>a numeric vector that stores the values of a sample.</p>
</td></tr>
<tr><td><code id="nppois_+3A_w">w</code></td>
<td>
<p>a numeric vector that stores the corresponding weights/frequencies
of the observations.</p>
</td></tr>
<tr><td><code id="nppois_+3A_n">n</code></td>
<td>
<p>the sample size.</p>
</td></tr>
<tr><td><code id="nppois_+3A_x">x</code></td>
<td>
<p>an object of class <code>nppois</code>.</p>
</td></tr>
<tr><td><code id="nppois_+3A_mix">mix</code></td>
<td>
<p>an object of class <code>disc</code>.</p>
</td></tr>
<tr><td><code id="nppois_+3A_beta">beta</code></td>
<td>
<p>the structural parameter, which is not really needed for the
Poisson mixture.</p>
</td></tr>
<tr><td><code id="nppois_+3A_col">col</code></td>
<td>
<p>the color of the density curve to be plotted.</p>
</td></tr>
<tr><td><code id="nppois_+3A_add">add</code></td>
<td>
<p>if <code>FALSE</code>, creates a new plot; if <code>TRUE</code>, adds the
plot to the existing one.</p>
</td></tr>
<tr><td><code id="nppois_+3A_components">components</code></td>
<td>
<p>if <code>TRUE</code>, also show the support points and mixing
proportions.</p>
</td></tr>
<tr><td><code id="nppois_+3A_main">main</code>, <code id="nppois_+3A_lwd">lwd</code>, <code id="nppois_+3A_lty">lty</code>, <code id="nppois_+3A_xlab">xlab</code>, <code id="nppois_+3A_ylab">ylab</code></td>
<td>
<p>arguments for graphical parameters (see
<code>par</code>).</p>
</td></tr>
<tr><td><code id="nppois_+3A_...">...</code></td>
<td>
<p>arguments passed on to function <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>nppois</code> creates an object of class <code>nppois</code>, given
values and weights/frequencies.
</p>
<p>Function <code>rnppois</code> generates a random sample from a Poisson mixture and
saves the data as an object of class <code>nppois</code>.
</p>
<p>Function <code>plot.nppois</code> plots the Poisson mixture.
</p>
<p>When <code>components=TRUE</code>, the support points are shown on the horizontal
line of density 0. The component density curves, weighted appropriately, are
also shown.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2007). On fast computation of the non-parametric maximum
likelihood estimate of a mixing distribution. <em>Journal of the Royal
Statistical Society, Ser. B</em>, <b>69</b>, 185-198.
</p>


<h3>See Also</h3>

<p><code><a href="lsei.html#topic+nnls">nnls</a></code>, <code><a href="#topic+cnm">cnm</a></code>, <code><a href="#topic+cnmms">cnmms</a></code>,
<code><a href="#topic+plot.nspmix">plot.nspmix</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mix = disc(pt=c(1,4), pr=c(0.3,0.7))
x = rnppois(200, mix)
plot(x, mix)

</code></pre>

<hr>
<h2 id='plot.nspmix'>Class 'nspmix'</h2><span id='topic+plot.nspmix'></span><span id='topic+nspmix'></span>

<h3>Description</h3>

<p>Class <code>nspmix</code> is an object returned by function <code>cnm</code>,
<code>cnmms</code>, <code>cnmpl</code> or <code>cnmap</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nspmix'
plot(x, data, type=c("probability","gradient"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.nspmix_+3A_x">x</code></td>
<td>
<p>an object of a mixture model class</p>
</td></tr>
<tr><td><code id="plot.nspmix_+3A_data">data</code></td>
<td>
<p>a data set from the mixture model</p>
</td></tr>
<tr><td><code id="plot.nspmix_+3A_type">type</code></td>
<td>
<p>the type of function to be plotted: the probability model of the
mixture family (<code>probability</code>), or the gradient function
(<code>gradient</code>).</p>
</td></tr>
<tr><td><code id="plot.nspmix_+3A_...">...</code></td>
<td>
<p>arguments passed on to the <code>plot</code> function called.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>plot.nspmix</code> plots either the mixture model, if the family of
the mixture provides an implementation of the generic <code>plot</code> function,
or the gradient function.
</p>
<p><code>data</code> must belong to a mixture family, as specified by its class.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2007). On fast computation of the non-parametric maximum
likelihood estimate of a mixing distribution. <em>Journal of the Royal
Statistical Society, Ser. B</em>, <b>69</b>, 185-198.
</p>
<p>Wang, Y. (2010). Maximum likelihood computation for fitting semiparametric
mixture models. <em>Statistics and Computing</em>, <b>20</b>, 75-86
</p>


<h3>See Also</h3>

<p><code><a href="lsei.html#topic+nnls">nnls</a></code>, <code><a href="#topic+cnm">cnm</a></code>, <code><a href="#topic+cnmms">cnmms</a></code>,
<code><a href="#topic+cnmpl">cnmpl</a></code>, <code><a href="#topic+cnmap">cnmap</a></code>, <code><a href="#topic+npnorm">npnorm</a></code>,
<code><a href="#topic+nppois">nppois</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Poisson mixture
x = rnppois(200, disc(c(1,4), c(0.7,0.3)))
r = cnm(x)
plot(r, x, "p")
plot(r, x, "g")

## Normal mixture
x = rnpnorm(200, mix=disc(c(0,4), c(0.3,0.7)), sd=1)
r = cnm(x, init=list(beta=0.5))   # sd = 0.5
plot(r, x, "p")
plot(r, x, "g")

</code></pre>

<hr>
<h2 id='plotgrad'>Plot the Gradient Function</h2><span id='topic+plotgrad'></span>

<h3>Description</h3>

<p>Function <code>plotgrad</code> plots the gradient function or its first derivative
of a nonparametric mixture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotgrad(
  x,
  mix,
  beta,
  len = 500,
  order = 0,
  col = "blue",
  col2 = "red",
  add = FALSE,
  main = paste0("Class: ", class(x)),
  xlab = expression(theta),
  ylab = paste0("Gradient (order = ", order, ")"),
  cex = 1,
  pch = 1,
  lwd = 1,
  xlim,
  ylim,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotgrad_+3A_x">x</code></td>
<td>
<p>a data object of a mixture model class.</p>
</td></tr>
<tr><td><code id="plotgrad_+3A_mix">mix</code></td>
<td>
<p>an object of class 'disc', for a discrete mixing distribution.</p>
</td></tr>
<tr><td><code id="plotgrad_+3A_beta">beta</code></td>
<td>
<p>the structural parameter.</p>
</td></tr>
<tr><td><code id="plotgrad_+3A_len">len</code></td>
<td>
<p>number of points used to plot the smooth curve.</p>
</td></tr>
<tr><td><code id="plotgrad_+3A_order">order</code></td>
<td>
<p>the order of the derivative of the gradient function to be
plotted. If 0, it is the gradient function itself.</p>
</td></tr>
<tr><td><code id="plotgrad_+3A_col">col</code></td>
<td>
<p>color for the curve.</p>
</td></tr>
<tr><td><code id="plotgrad_+3A_col2">col2</code></td>
<td>
<p>color for the support points.</p>
</td></tr>
<tr><td><code id="plotgrad_+3A_add">add</code></td>
<td>
<p>if <code>FALSE</code>, create a new plot; if <code>TRUE</code>, add the curve
and points to the current one.</p>
</td></tr>
<tr><td><code id="plotgrad_+3A_main">main</code>, <code id="plotgrad_+3A_xlab">xlab</code>, <code id="plotgrad_+3A_ylab">ylab</code>, <code id="plotgrad_+3A_cex">cex</code>, <code id="plotgrad_+3A_pch">pch</code>, <code id="plotgrad_+3A_lwd">lwd</code>, <code id="plotgrad_+3A_xlim">xlim</code>, <code id="plotgrad_+3A_ylim">ylim</code></td>
<td>
<p>arguments for graphical
parameters (see <code>par</code>).</p>
</td></tr>
<tr><td><code id="plotgrad_+3A_...">...</code></td>
<td>
<p>arguments passed on to function <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>data</code> must belong to a mixture family, as specified by its class.
</p>
<p>The support points are shown on the horizontal line of gradient 0. The
vertical lines going downwards at the support points are proportional to the
mixing proportions at these points.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2007). On fast computation of the non-parametric maximum
likelihood estimate of a mixing distribution. <em>Journal of the Royal
Statistical Society, Ser. B</em>, <b>69</b>, 185-198.
</p>
<p>Wang, Y. (2010). Maximum likelihood computation for fitting semiparametric
mixture models. <em>Statistics and Computing</em>, <b>20</b>, 75-86
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.nspmix">plot.nspmix</a></code>, <code><a href="lsei.html#topic+nnls">nnls</a></code>, <code><a href="#topic+cnm">cnm</a></code>,
<code><a href="#topic+cnmms">cnmms</a></code>, <code><a href="#topic+npnorm">npnorm</a></code>, <code><a href="#topic+nppois">nppois</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Poisson mixture
x = rnppois(200, disc(c(1,4), c(0.7,0.3)))
r = cnm(x)
plotgrad(x, r$mix)

## Normal mixture
x = rnpnorm(200, disc(c(0,4), c(0.3,0.7)), sd=1)
r = cnm(x, init=list(beta=0.5))   # sd = 0.5
plotgrad(x, r$mix, r$beta)


</code></pre>

<hr>
<h2 id='thai'>Illness Spells and Frequencies of Thai Preschool Children</h2><span id='topic+thai'></span>

<h3>Description</h3>

<p>Contains the results of a cohort study in north-east Thailand in which 602
preschool children participated. For each child, the number of illness
spells <code class="reqn">x</code>, such as fever, cough or running nose, is recorded for all
2-week periods from June 1982 to September 1985. The frequency for each
value of <code class="reqn">x</code> is saved in the data set.
</p>


<h3>Format</h3>

<p>A data frame with 24 rows and 2 variables:
</p>
<p>x: values of <code class="reqn">x</code>.
</p>
<p>freq: frequencies for each value of <code class="reqn">x</code>.
</p>


<h3>Source</h3>

<p>Bohning, D. (2000). <em>Computer-assisted Analysis of Mixtures and
Applications: Meta-analysis, Disease Mapping, and Others</em>. Boca Raton:
Chapman and Hall-CRC.
</p>


<h3>References</h3>

<p>Wang, Y. (2007). On fast computation of the non-parametric maximum
likelihood estimate of a mixing distribution. <em>Journal of the Royal
Statistical Society, Ser. B</em>, <b>69</b>, 185-198.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nppois">nppois</a></code>,<code><a href="#topic+cnm">cnm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(thai)
x = nppois(thai)
plot(cnm(x), x)


</code></pre>

<hr>
<h2 id='toxo'>Toxoplasmosis Data</h2><span id='topic+toxo'></span>

<h3>Description</h3>

<p>Contains the number of subjects testing positively for toxoplasmosis in 34
cities of El Salvador, with various rainfalls.
</p>


<h3>Format</h3>

<p>A numeric matrix with four columns:
</p>
<p>city: city identification code.
</p>
<p>y: the number of subjects testing positively for toxoplasmosis.
</p>
<p>n: the number of subjects tested.
</p>
<p>rainfall: the annual rainfall of the city, in meters.
</p>


<h3>References</h3>

<p>Efron, B. (1986). Double exponential families and their use in generalized
linear regression. <em>Journal of the American Statistical Association</em>,
<b>81</b>, 709-721.
</p>
<p>Aitkin, M. (1996). A general maximum likelihood analysis of overdispersion
in generalised linear models. <em>Statistics and Computing</em>, <b>6</b>,
251-262.
</p>
<p>Wang, Y. (2010). Maximum likelihood computation for fitting semiparametric
mixture models. <em>Statistics and Computing</em>, <b>20</b>, 75-86.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlogit">mlogit</a></code>,<code><a href="#topic+cnmms">cnmms</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(toxo)
x = mlogit(toxo)
cnmms(x)


</code></pre>

<hr>
<h2 id='whist'>Weighted Histograms</h2><span id='topic+whist'></span>

<h3>Description</h3>

<p>Plots or computes the histogram with observations with
multiplicities/weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whist(
  x,
  w = 1,
  breaks = "Sturges",
  plot = TRUE,
  freq = NULL,
  xlim = NULL,
  ylim = NULL,
  xlab = "Data",
  ylab = NULL,
  main = NULL,
  add = FALSE,
  col = NULL,
  border = NULL,
  lwd = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="whist_+3A_x">x</code></td>
<td>
<p>a vector of values for which the histogram is desired.</p>
</td></tr>
<tr><td><code id="whist_+3A_w">w</code></td>
<td>
<p>a vector of multiplicities/weights for the values in <code>x</code>.</p>
</td></tr>
<tr><td><code id="whist_+3A_breaks">breaks</code>, <code id="whist_+3A_plot">plot</code>, <code id="whist_+3A_freq">freq</code>, <code id="whist_+3A_xlim">xlim</code>, <code id="whist_+3A_ylim">ylim</code>, <code id="whist_+3A_xlab">xlab</code>, <code id="whist_+3A_ylab">ylab</code>, <code id="whist_+3A_main">main</code>, <code id="whist_+3A_add">add</code>, <code id="whist_+3A_col">col</code>, <code id="whist_+3A_border">border</code>, <code id="whist_+3A_lwd">lwd</code></td>
<td>
<p>These
arguments have similar functionalities to their namesakes in function
<code>hist</code>.</p>
</td></tr>
<tr><td><code id="whist_+3A_...">...</code></td>
<td>
<p>arguments passed on to function <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Just like <code>hist</code>, <code>whist</code> can either plot the histogram or compute
the values that define the histogram, by setting <code>plot</code> to <code>TRUE</code>
or <code>FALSE</code>.
</p>
<p>The histogram can either be the one for frequencies or density, by setting
<code>freq</code> to <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+hist">hist</a></code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
