<!DOCTYPE html><html><head><title>Help for package spfa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spfa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fscores'><p>Computing EAP scores</p></a></li>
<li><a href='#plotitem.cont'><p>Item level perspective plots or contour plots for spfa models</p></a></li>
<li><a href='#simdata'><p>simdata</p></a></li>
<li><a href='#spfa'><p>Fitting Semi-parametric Factor Analysis Model</p></a></li>
<li><a href='#spfa_example'><p>spfa_example</p></a></li>
<li><a href='#spfa-package'><p>Semiparametric Factor Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Semi-Parametric Factor Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-25</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yang Liu &lt;yliu87@umd.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation, scoring, and plotting functions for the semi-parametric factor model proposed by Liu &amp; Wang (2022) &lt;<a href="https://doi.org/10.1007%2Fs11336-021-09832-8">doi:10.1007/s11336-021-09832-8</a>&gt; and Liu &amp; Wang (2023) &lt;<a href="https://arxiv.org/abs/2303.10079">arXiv:2303.10079</a>&gt;. Both the conditional densities of observed responses given the latent factors and the joint density of latent factors are estimated non-parametrically. Functional parameters are approximated by smoothing splines, whose coefficients are estimated by penalized maximum likelihood using an expectation-maximization (EM) algorithm. E- and M-steps can be parallelized on multi-thread computing platforms that support 'OpenMP'. Both continuous and unordered categorical response variables are supported.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, Rcpp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-26 00:43:04 UTC; wwang</td>
</tr>
<tr>
<td>Author:</td>
<td>Yang Liu [cre, aut],
  Weimeng Wang [aut, ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-26 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fscores'>Computing EAP scores</h2><span id='topic+fscores'></span>

<h3>Description</h3>

<p>Computing EAP scores
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fscores(
  data,
  fit,
  dimension = rep(0, ncol(data)),
  discrete = rep(FALSE, ncol(data)),
  normal = TRUE,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fscores_+3A_data">data</code></td>
<td>
<p>data to be scored</p>
</td></tr>
<tr><td><code id="fscores_+3A_fit">fit</code></td>
<td>
<p>the function return from fitting a <code>spfa</code> model.</p>
</td></tr>
<tr><td><code id="fscores_+3A_dimension">dimension</code></td>
<td>
<p>a vector of integers containing indicators of the latent factor. The default is rep(0, ncol(data)) indicating all item loads on the same latent factor.</p>
</td></tr>
<tr><td><code id="fscores_+3A_discrete">discrete</code></td>
<td>
<p>a vector of <code>TRUE</code> or <code>FALSE</code> indicating whether the item is discrete with <code>TRUE</code> indicating the item is a discrete variable. The length of the vector should be the same as the number of columns of the input data.</p>
</td></tr>
<tr><td><code id="fscores_+3A_normal">normal</code></td>
<td>
<p>a logical value <code>TRUE</code> or <code>FALSE</code> indicating which density is used to rescale y.</p>
</td></tr>
<tr><td><code id="fscores_+3A_control">control</code></td>
<td>
<p>a list of technical control variables. See <code><a href="#topic+spfa">spfa</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EAP scores for the fitted spfa model and reliability
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RT &lt;- spfa::simdata[,1:8]
myeaps &lt;- fscores(data = RT, fit = spfa::spfa_example, 
dimension = rep( 0, ncol(RT)), discrete = rep(FALSE, ncol(RT) ))
</code></pre>

<hr>
<h2 id='plotitem.cont'>Item level perspective plots or contour plots for spfa models</h2><span id='topic+plotitem.cont'></span><span id='topic+plotitem.disc'></span><span id='topic+plotgroup'></span>

<h3>Description</h3>

<p>For continuous response data use <code>plotitem.cont</code> whereas discrete response data use <code>plotitem.disc</code>. For joint continuous and discrete data, use <code>plotgroup</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotitem.cont(
  param,
  nquad = 21,
  npoints = 101,
  xlim = c(-2.5, 2.5),
  ylim = c(0, 1),
  normal = TRUE,
  FUN = NULL,
  plot = TRUE,
  type = "contour",
  ...
)

plotitem.disc(
  param,
  ncat,
  npoints = 101,
  xlim = c(-2.5, 2.5),
  normal = TRUE,
  FUN = NULL,
  plot = TRUE,
  col = 1:ncat,
  lty = rep(1, ncat),
  ...
)

plotgroup(
  param,
  nquad = 21,
  npoints = 101,
  lim = c(-2.5, 2.5),
  normal = TRUE,
  plot = TRUE,
  type = "contour",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotitem.cont_+3A_param">param</code></td>
<td>
<p>parameter vector estimated from <code><a href="#topic+spfa">spfa</a></code> model</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_nquad">nquad</code></td>
<td>
<p>an integer value of number of quadrature points. Default is 21</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_npoints">npoints</code></td>
<td>
<p>an integer value of number of x and y levels in the plot</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_xlim">xlim</code></td>
<td>
<p>the x limits of the plot. Two numerical values indicating the lower and upper limits</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_ylim">ylim</code></td>
<td>
<p>the y limits of the plot. Two numerical values indicating the lower and upper limits of the density. Note y is rescaled to a uniform [0,1] distribution.</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_normal">normal</code></td>
<td>
<p>a logical value <code>TRUE</code> or <code>FALSE</code> indicating which density is used to rescale y.</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_fun">FUN</code></td>
<td>
<p>a user supplied function to rescale.</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_plot">plot</code></td>
<td>
<p>a logical value <code>TRUE</code> or <code>FALSE</code> indicating whether the plot is visualized.</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_type">type</code></td>
<td>
<p>the type of plot to be visualized. The default is the contour plot <code><a href="graphics.html#topic+contour">contour</a></code>. It can also be changed to &quot;<code>persp</code>&quot; indicating perspective plots.</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="graphics.html#topic+contour">contour</a></code> and <code><a href="graphics.html#topic+persp">persp</a></code></p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_ncat">ncat</code></td>
<td>
<p>an integer value indicating the number of categories for the discrete item.</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_col">col</code></td>
<td>
<p>color of the line.</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="plotitem.cont_+3A_lim">lim</code></td>
<td>
<p>limit</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plots. Item level perspective and contour plot
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+contour">contour</a></code> and <code><a href="graphics.html#topic+persp">persp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Contour plot of the first item 

plotitem.cont(spfa::spfa_example$par[[1]])
</code></pre>

<hr>
<h2 id='simdata'>simdata</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>There are 16 columns with 1000 rows. The first 8 columns contain continuous item response time data and the last 8 columns with discrete item responses. 
Among the discrete items, there are 4 dichotomous and 4 four-category ones.
</p>

<hr>
<h2 id='spfa'>Fitting Semi-parametric Factor Analysis Model</h2><span id='topic+spfa'></span>

<h3>Description</h3>

<p><code>spfa</code> fits a unidimensional or two-dimension factor analysis spfa model 
using penalized maximum likelihood estimation. A unidimensional spfa model can
handle discrete response data (i.e., item responses including binary responses
and polytomous responses) or continuous response data (e.g., response time). 
A two-dimensional <code>spfa</code> model can only handle simple structure model 
with two latent factors load to continuous and discrete response data, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spfa(
  data,
  dimension = rep(0, ncol(data)),
  discrete = rep(FALSE, ncol(data)),
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spfa_+3A_data">data</code></td>
<td>
<p>a matrix that consists of item responses with missing data coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="spfa_+3A_dimension">dimension</code></td>
<td>
<p>a vector of integers containing indicators of the latent factor. The default is <code>rep(0, ncol(data))</code> indicating all item load on the same latent factor.</p>
</td></tr>
<tr><td><code id="spfa_+3A_discrete">discrete</code></td>
<td>
<p>a vector of <code>TRUE</code> or <code>FALSE</code> indicating whether the item is discrete. <code>TRUE</code>: discrete variable. The length of the vector should be the same as the number of columns of the input data.</p>
</td></tr>
<tr><td><code id="spfa_+3A_control">control</code></td>
<td>
<p>a list containing technical parameters for estimation. May be: 
</p>

<ul>
<li> <p><code>shortpar</code> a list containing the starting values of spfa model parameters for each item.
</p>
</li>
<li>  <p><code>pos</code> a list containing positivity constraints
</p>
</li>
<li>  <p><code>lmbd</code> a vector of the penalty parameter (lambda). Default value is a vector of 1s. 
</p>
</li>
<li> <p><code>n_basis</code> number of basis. Default is 11. 
</p>
</li>
<li>  <p><code>n_quad</code> number of quadrature points. Default is 21
</p>
</li>
<li>  <p><code>maxit_em</code> the maximum number of iterations for the EM cycles. Default is 500.
</p>
</li>
<li> <p><code>maxit_mstep</code> the maximum number of iterations for the mstep optimizer.
</p>
</li>
<li> <p><code>maxit_start</code> 
</p>
</li>
<li> <p><code>tol_em</code> tolerance for the EM convergence. Default is 1e-4.
</p>
</li>
<li> <p><code>tol_mstep</code> tolerance for the m-step optimizer. Default is 1e-6.
</p>
</li>
<li> <p><code>n_thrd</code> number of cores used for the penalized EM algorithm to run. Default is 1. 
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>a list including spfa model parameter estimates and marginal log-likelihood.
</p>


<h3>References</h3>

<p>Liu, Y., &amp; Wang, W. (2022). Semiparametric Factor Analysis for Item-Level Response Time Data. <em>Psychometrika, 87</em>(2), 666â€“692. <a href="https://doi.org/10.1007/s11336-021-09832-8">doi:10.1007/s11336-021-09832-8</a>
</p>
<p>Liu, Y., &amp; Wang, W. (2023). What Can We Learn from a Semiparametric Factor Analysis of Item Responses and Response Time? An Illustration with the PISA 2015 Data. Retrieved from <a href="https://arxiv.org/abs/2303.10079">https://arxiv.org/abs/2303.10079</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # load item response time data 
 RT &lt;- spfa::simdata[,1:8]
 
 # Fit a unidimensional spfa model with continuous data (Response time)


 
spfa_example &lt;- spfa(data = RT, 
       dimension = rep(0, ncol(RT)), 
       discrete = rep(FALSE, ncol(RT)))
       
 
 # In the spfa pacakge, the output of spfa_example can be directly extracted. 
 # See example code below:
 
 spfa::spfa_example$shortpar
 
 # Visualize the result for item 1 as an example 
 
 plotitem.cont(spfa::spfa_example$par[[1]])
</code></pre>

<hr>
<h2 id='spfa_example'>spfa_example</h2><span id='topic+spfa_example'></span>

<h3>Description</h3>

<p>An R object containing an example output from fitting an spfa model using the following code:
# RT &lt;- spfa::simdata[,1:8]
# spfa_example &lt;- spfa(data = RT, dimension = rep(0, ncol(RT)), discrete = rep(FALSE, ncol(RT)))
</p>

<hr>
<h2 id='spfa-package'>Semiparametric Factor Analysis</h2><span id='topic+spfa-package'></span>

<h3>Description</h3>

<p>The package provides estimation, scoring, and plotting functions for the semiparametric parametric factor model proposed by Liu &amp; Wang (2022; 2023). Both the conditional densities of observed responses given the latent factors and the joint density of latent factors are estimated nonparametrically. Functional parameters are approximated by smoothing splines, whose coefficients are estimated by penalized maximum likelihood using an expectation-maximization (EM) algorithm. E- and M-steps can be parallelized on multi-thread computing platforms that support OpenMP. Both continuous and unordered categorical response variables are supported.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
