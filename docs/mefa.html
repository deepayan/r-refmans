<!DOCTYPE html><html lang="en"><head><title>Help for package mefa</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mefa}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mefa'><p>Create an Object of Class 'mefa'</p></a></li>
<li><a href='#aggregate.mefa'><p>Extract and Aggregate Objects of Class 'mefa'</p></a></li>
<li><a href='#aoplot'>
<p>Abundance-Occupancy Plot</p></a></li>
<li><a href='#as.data.frame.dist'>
<p>Manipulation Tools for Class 'dist'</p></a></li>
<li><a href='#as.mefa'><p>Conversion Among Various Object Classes</p></a></li>
<li><a href='#dolina'><p>The Dolina Dataset</p></a></li>
<li><a href='#fill.na'><p>Replace &lt;NA&gt; Values with Nearest Above Values</p></a></li>
<li><a href='#image.dist'>
<p>Image Plot of a 'dist' Object</p></a></li>
<li><a href='#label'><p>Assign Label to an Object and Return It</p></a></li>
<li><a href='#mat2list'>
<p>Matrix Manipulation Tools</p></a></li>
<li><a href='#mefaCheck'><p>Check and Compare Object(s) of Class 'mefa'</p></a></li>
<li><a href='#mefaCrosstab'><p>Cross Tabulate an Object of Class 'stcs'</p></a></li>
<li><a href='#mefadocs'><p>Display Package Documentation</p></a></li>
<li><a href='#mefalogo'><p>Schematic Plot of an Object of Class 'mefa'</p></a></li>
<li><a href='#mefaNestedless'><p>Make Non-Nested 'mefa' Object</p></a></li>
<li><a href='#mefaTables'><p>Subsetting and Ordering of Related Data Tables</p></a></li>
<li><a href='#mefaweb'><p>Open 'mefa' Website</p></a></li>
<li><a href='#melt'><p>Melt (Convert) an Object of Class 'mefa' Into 'stcs'</p></a></li>
<li><a href='#plot.mefa'><p>Plotting Methods for Object of Class 'mefa' and 'stcs'</p></a></li>
<li><a href='#qvector'><p>Ordinal Transformation of a Vector</p></a></li>
<li><a href='#rep.data.frame'><p>Inflate (repeat) a Data Frame</p></a></li>
<li><a href='#report.mefa'><p>Write Report of an Object of Class 'mefa' into File</p></a></li>
<li><a href='#stcs'><p>Create an Object of Class 'stcs'</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Data Handling in Ecology and Biogeography</td>
</tr>
<tr>
<td>Version:</td>
<td>3.2-9</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-05-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Solymos</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Solymos &lt;psolymos@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A framework package aimed to provide standardized computational environment for specialist work via object classes to represent the data coded by samples, taxa and segments (i.e. subpopulations, repeated measures). It supports easy processing of the data along with cross tabulation and relational data tables for samples and taxa. An object of class &lsquo;mefa&rsquo; is a project specific compendium of the data and can be easily used in further analyses. Methods are provided for extraction, aggregation, conversion, plotting, summary and reporting of &lsquo;mefa&rsquo; objects. Reports can be generated in plain text or LaTeX format. Vignette contains worked examples.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, vegan, mefa4, Matrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/psolymos/mefa">https://github.com/psolymos/mefa</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/psolymos/mefa/issues">https://github.com/psolymos/mefa/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-20 04:07:54 UTC; Peter</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-20 12:30:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='mefa'>Create an Object of Class 'mefa'</h2><span id='topic+mefa-package'></span><span id='topic+mefa'></span><span id='topic+is.mefa'></span><span id='topic+print.mefa'></span><span id='topic+summary.mefa'></span><span id='topic+print.summary.mefa'></span><span id='topic+dim.mefa'></span><span id='topic+dimnames.mefa'></span>

<h3>Description</h3>

<p>An object of class 'mefa' is a compendium of a crosstabulated taxa-by-samples (count) data, and optionally (count) data for segments, and linked tables for samples and taxa. The 'mefa' term stand for an acronym of '<strong>me</strong>ta<strong>fa</strong>unistics', indicating that data processing is a critical and often time consuming step before data analysis. The 'mefa' package aims to help in this respect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mefa(xtab, samp = NULL, taxa = NULL, id.samp = NULL, id.taxa = NULL,
segment = TRUE, nested = FALSE, drop.zero = FALSE, drop.index = FALSE,
xtab.fixed = TRUE)
## S3 method for class 'mefa'
is(x)
## S3 method for class 'mefa'
print(x, nlist = 10, ...)
## S3 method for class 'mefa'
summary(object, nlist = 10, ...)
## S3 method for class 'summary.mefa'
print(x, nlist, ...)
## S3 method for class 'mefa'
dim(x)
## S3 method for class 'mefa'
dimnames(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mefa_+3A_xtab">xtab</code></td>
<td>
<p>data. Can be an object of class 'stcs', or a matrix or data frame. Can be count (integer) or non-integer.</p>
</td></tr>
<tr><td><code id="mefa_+3A_samp">samp</code></td>
<td>
<p>a data frame containing rows for samples, or <code>NULL</code>. See argument <code>xtab.fixed</code> and details for sample matching options.</p>
</td></tr>
<tr><td><code id="mefa_+3A_taxa">taxa</code></td>
<td>
<p>a data frame containing rows for taxa, or <code>NULL</code>. See argument <code>xtab.fixed</code> and details for taxa matching options.</p>
</td></tr>
<tr><td><code id="mefa_+3A_id.samp">id.samp</code></td>
<td>
<p><code>NULL</code> if sample names for matching are the rownames of <code>samp</code>, otherwise, the index refers to the column of <code>samp</code> where the names are located.</p>
</td></tr>
<tr><td><code id="mefa_+3A_id.taxa">id.taxa</code></td>
<td>
<p><code>NULL</code> if taxa names for matching are the rownames of <code>taxa</code>, otherwise, the index refers to the column of <code>taxa</code> where the names are located.</p>
</td></tr>
<tr><td><code id="mefa_+3A_segment">segment</code></td>
<td>
<p>logical, whether information in the segments column of the 'stcs' object should be used (<code>TRUE</code>, default). It has no effect when <code>xtab</code> is matrix or data frame.</p>
</td></tr>
<tr><td><code id="mefa_+3A_nested">nested</code></td>
<td>
<p>logical, whether segments should be nested within each other from the first to the last (<code>TRUE</code>) or not (<code>FALSE</code>, default).</p>
</td></tr>
<tr><td><code id="mefa_+3A_drop.zero">drop.zero</code></td>
<td>
<p>logical, if <code>TRUE</code> empty samples are removed from the result (can be useful before multivariate analyses). Otherwise, empty rows are left intact (<code>FALSE</code>, default).</p>
</td></tr>
<tr><td><code id="mefa_+3A_drop.index">drop.index</code></td>
<td>
<p>logical, whether columns of the samples and taxa tables containing the names used for matching should be removed (<code>TRUE</code>) to reduce redundancy or not (<code>FALSE</code>, default). This argument has effect only if <code>id.samp</code> and <code>id.taxa</code> are not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="mefa_+3A_xtab.fixed">xtab.fixed</code></td>
<td>
<p>logical, if <code>TRUE</code> (default) the <code>samp</code> and <code>taxa</code> tables are subsetted and ordered according to the names of <code>xtab</code>. If <code>FALSE</code>, <code>xtab</code> is also subsetted according to the intersect of the names. Row and column ordering is determined by <code>xtab</code> in either cases.</p>
</td></tr>
<tr><td><code id="mefa_+3A_x">x</code>, <code id="mefa_+3A_object">object</code></td>
<td>
<p>an object of class 'mefa'.</p>
</td></tr>
<tr><td><code id="mefa_+3A_nlist">nlist</code></td>
<td>
<p>number of elements in the list of segment names to print. List of segment names is truncated at 10 by default.</p>
</td></tr>
<tr><td><code id="mefa_+3A_...">...</code></td>
<td>
<p>other arguments passed to functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Main goals of the <code>mefa</code> function are to (1) convert a long formatted object of 'stcs' into a crosstabulated and optionally segmented 'mefa' object and (2) link this crosstabulation with tables of samples and taxa. The segments can be nested within each other. This feature can be useful, if segments represent e.g. subsequent sampling periods (years) and the the aim is to detect effects of data accumulation over time.
</p>
<p>A mefa object can be viewed as a project oriented compendium of the data. It contains 3 dimensional (samples, taxa, segments) representation of the count data and data tables for samples and taxa. Segments contain information on some particular internal division of the data (sub populations, method specific partitions, repeated measures), but it has technical significance. Thus data tables for segments are not supported.
</p>
<p>Input values may contain non-integer values as well.
</p>
<p>If the input <code>xtab</code> is a matrix, dimnames are necessary if either <code>samp</code> or <code>taxa</code> tables are provided. In other cases, dimnames are not necessary. In this way, simple statistics can be returned for the matrix.
</p>
<p>The print method returns basic information, instead of a long structural representation.
</p>
<p>The summary contains statistics calculated from the 'mefa' object (species richness, number of individuals, occupancy, abundance, total sum, matrix fill, etc., see 'Value' section). The list can be recalled by e.g. <code>unclass(summary(x))</code>, elements of the list e.g. <code>summary(x)$s.rich</code>.
</p>
<p>Methods for extracting, subsetting, plotting and reporting 'mefa' objects are discussed elsewhere (see links in 'See also' section). On how the 'mefa' objects can be used in further analyses, see 'Examples' and the vignette (<code>vignette("mefa")</code>).
</p>
<p>When the <code>as.mefa</code> function is used with a 'mefa' object as argument, samples and taxa tables are used when <code>samp</code> and <code>taxa</code> arguments are missing. If the aim is to redefine these tables, those also can be given.
</p>


<h3>Value</h3>

<p>The <code>mefa</code> function returns an object of class 'mefa'. It is a list with 5 elements:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>the function call.</p>
</td></tr>
<tr><td><code>xtab</code></td>
<td>
<p>crosstabulated count data, rows are samples, columns are taxa.</p>
</td></tr>
<tr><td><code>segm</code></td>
<td>
<p>list of matrices if segments are used, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>samp</code></td>
<td>
<p>a data frame for sample related data (rows correspond to samples) if provided, otherwise <code>NULL</code>.</p>
</td></tr>
<tr><td><code>taxa</code></td>
<td>
<p>a data frame for taxa related data (rows correspond to taxa) if provided, otherwise <code>NULL</code>.</p>
</td></tr>
</table>
<p>The <code>summary.mefa</code> function returns a list invisibly, with elements:
<code>s.rich</code>: vector with species richness values for the samples,
<code>s.abu</code>: vector with number of individuals values for the samples,
<code>t.occ</code>: number of sites occupied by each species,
<code>t.abu</code>: abundances of each species,
<code>ntot</code>: total number of individuals,
<code>mfill</code>: matrix fill,
<code>nsamp</code>: number of samples,
<code>ntaxa</code>: number of taxa,
<code>nsegm</code>: number of segments,
<code>segment</code>: vector of segment names,
<code>call</code>: the function call from the 'mefa' object,
<code>nested, drop.zero, xtab.fixed</code>: attributes of the 'mefa' object.
</p>
<p>The method <code>dim</code> returns a vector of length 3 with values for number of samples, number of taxa and number of segments in the 'mefa' object. The third value is 1 in cases, when <code>s$segm</code> is <code>NULL</code> (because it is 1 undefined segment essentially identical to the matrix <code>x$xtab</code>, thus no need for a replicate).
</p>
<p>The <code>dimnames</code> method returns a list of three character vectors for names of samples, taxa and segments. These can be <code>NULL</code> as well.
</p>


<h3>Note</h3>

<p>The <code>mefa</code> function alone can be used instead of the combination of object classes <code>xcount</code> and <code>xorder</code> used in older (&lt; 2.0) versions of the <strong>mefa</strong> package. Further it is also extended by previously undocumented features.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p>Further methods are discussed on separate help pages: see <code><a href="#topic++5B.mefa">[.mefa</a></code> and <code><a href="#topic+aggregate.mefa">aggregate.mefa</a></code> for extracting and aggregating the data, <code><a href="#topic+melt.mefa">melt.mefa</a></code> for redefining segments or melting data into long format, <code><a href="#topic+report.mefa">report.mefa</a></code> for generating report into file, and <code><a href="#topic+plot.mefa">plot.mefa</a></code> <code><a href="#topic+boxplot.mefa">boxplot.mefa</a></code> and <code><a href="#topic+image.mefa">image.mefa</a></code> for graphical display.
</p>
<p>See <code><a href="#topic+as.mefa">as.mefa</a></code> for coercion methods.
</p>
<p>See <code><a href="base.html#topic+table">table</a></code> and <code><a href="stats.html#topic+xtabs">xtabs</a></code> functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count, dol.samp, dol.taxa)
## Input is stcs
x1 &lt;- mefa(stcs(dol.count))
x1
## Input is matrix
x2 &lt;- mefa(x1$xtab)
x2
## Attach data frame for samples
x3 &lt;- mefa(stcs(dol.count), dol.samp)
x3
## Attach data frame for samples and taxa
x4 &lt;- mefa(stcs(dol.count), dol.samp, dol.taxa)
x4
## Methods
## (chapter 'See also' provides
## links for further methods)
summary(x4)
## Descriptives inside the summary
unclass(summary(x4))
## Testing mefa objects
is(x4, "mefa")
## Removing empty samples
as.mefa(x4, drop.zero = TRUE)
## Dimensions
dim(x4)
## Dimnames
dimnames(x4)
## Simple examples how to use mefa objects in analyis
## GLM on sample abundances
mod &lt;- glm(summary(x4)$s.abu ~ .^2,
    data = x4$samp, family = quasipoisson)
summary(mod)
## See the demo and vignette for more examples
# demo(mefa)
# vignette("mefa")
## Cluster analysis of community matrix
x5 &lt;- aggregate(x4, c("method", "microhab"))
h &lt;- hclust(dist(x5$xtab))
plot(h)
</code></pre>

<hr>
<h2 id='aggregate.mefa'>Extract and Aggregate Objects of Class 'mefa'</h2><span id='topic+aggregate.mefa'></span><span id='topic++5B.mefa'></span><span id='topic+xtab'></span><span id='topic+samp'></span><span id='topic+taxa'></span><span id='topic+segm'></span>

<h3>Description</h3>

<p>These methods are useful when extracting or aggregating 'mefa' objects. The count data matrix, the matrices for segments and the linked tables of samples and taxa are extracted or aggregated at the same time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mefa'
aggregate(x, by.samp = NULL, by.taxa = NULL, ...)
## S3 method for class 'mefa'
x[i = 1:dim(x)[1], j = 1:dim(x)[2], k = 1:dim(x)[3], drop = FALSE]
xtab(x, ...)
samp(x, ...)
taxa(x, ...)
segm(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aggregate.mefa_+3A_x">x</code></td>
<td>
<p>an object of class 'mefa'.</p>
</td></tr>
<tr><td><code id="aggregate.mefa_+3A_by.samp">by.samp</code></td>
<td>
<p>a vector with length as the number of samples and more than one unique values to use aggregating samples.</p>
</td></tr>
<tr><td><code id="aggregate.mefa_+3A_by.taxa">by.taxa</code></td>
<td>
<p>a vector with length as the number of taxa and more than one unique values to use aggregating taxa.</p>
</td></tr>
<tr><td><code id="aggregate.mefa_+3A_i">i</code>, <code id="aggregate.mefa_+3A_j">j</code>, <code id="aggregate.mefa_+3A_k">k</code></td>
<td>
<p>index value or a vector of indices for samples, taxa and segments, respectively. Can be numeric or character. Negative numeric values indicate items to be excluded.</p>
</td></tr>
<tr><td><code id="aggregate.mefa_+3A_drop">drop</code></td>
<td>
<p>logical, if <code>TRUE</code> the unused factor leves in the linked tables for samples and species will be dropped after extraction. If <code>FALSE</code> (default) unused factor levels are left intact.</p>
</td></tr>
<tr><td><code id="aggregate.mefa_+3A_...">...</code></td>
<td>
<p>other arguments passed to the generic function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a 'mefa' object is aggregated, either or both tables for samples and taxa (depending on if the aggregation was made by rows, columns or both) are set to <code>NULL</code>. Because aggregation is not straightforward for data frames with mixed type of data (e.g. factors, character vectors), and the applied function (mean, sum, etc.) depends on the type of the numeric variables. Consequently, if new data table is needed, that must be defined again by the function <code><a href="#topic+mefa">mefa</a></code>. If the original data frame contained only numeric columns, it can be easily aggregated if the function to apply is known. For factors and numeric columns, however, such aggregation is not defined.
</p>
<p>The ordering of dimensions follow the ordering of the indices in the extraction call, except for nested subsets, when sequence of nested segments is not allowed to be affected by the extraction (error message is given). The extracting method retains samples and taxa tables as well. If non-nested segments are extracted, the <code>x$xtab</code> matrix will contain the sum of segments, and not the original values of <code>x$xtab</code>. Thus if a resulting 'mefa' object has only one segment, it will be identical to the <code>x$xtab</code> matrix. If nested segments are extracted, <code>x$xtab</code> will be identical to the last segment and not the sum of segments. See the examples for these differences. If the original object had nested segments and the first is excluded, segment names change as a result. If only one segment remains in the result, the nested attribute is turned off.
</p>
<p>If the aggregation is done over a vector that is not part of the tables inside the 'mefa' object, it must have a class attribute to be recognised, use e.g. the <code><a href="base.html#topic+as.factor">as.factor</a></code> function (see 'Examples').
</p>
<p>The resulting 'mefa' object must contain at least 2 samples and 2 taxa.
</p>
<p>Extractor functions <code>xtab</code>, <code>samp</code>, <code>taxa</code>, and <code>segm</code> extract the corresponding element from the 'mefa' object.
</p>


<h3>Value</h3>

<p>An object of class 'mefa'.
</p>


<h3>Note</h3>

<p>The <code>aggregate</code> method replaces the function <code>strify</code>, the <code>[</code> method replaces the function <code>exclmf</code> of the old (&lt; 2.0) versions of the <strong>mefa</strong> package.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mefa">mefa</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count, dol.samp, dol.taxa)
x &lt;- mefa(stcs(dol.count), dol.samp, dol.taxa)
## These two are identical
aggregate(x, "microhab")
aggregate(x, x$samp$microhab, inside = FALSE)
## Interaction
aggregate(x, c("method", "microhab"))
## Both samples and taxa tables
aggregate(x, "microhab", "familia")
## To use a factor
aggregate(x, "microhab", as.factor(rbinom(dim(x)[2], 1, 0.5)))
## Extraction
x[1:10, ]
x[, 1:5]
x[, , "broken"]
x[1:10, 1:5]
x[1:10, 1:5, 2]
## Note factor levels
y &lt;- x[which(x$samp$method == "time"), ]
levels(y$samp$method)
z &lt;- x[which(x$samp$method == "time"), drop = TRUE]
levels(z$samp$method)
## Note the differences in total sums
y &lt;- mefa(stcs(dol.count), dol.samp, dol.taxa, nested = TRUE)
x[ , , 2]
y[ , , 2]
</code></pre>

<hr>
<h2 id='aoplot'>
Abundance-Occupancy Plot
</h2><span id='topic+aoplot'></span><span id='topic+aoplot.default'></span>

<h3>Description</h3>

<p>Abundance-occupancy plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aoplot(x, ...)
## Default S3 method:
aoplot(x, log = TRUE, xlab, ylab, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aoplot_+3A_x">x</code></td>
<td>

<p>An object, possibly a matrix.
</p>
</td></tr>
<tr><td><code id="aoplot_+3A_log">log</code></td>
<td>

<p>Logical, if abundance values should be log10 transformed.
</p>
</td></tr>
<tr><td><code id="aoplot_+3A_xlab">xlab</code>, <code id="aoplot_+3A_ylab">ylab</code></td>
<td>

<p>Axis labels, can be missing for default labels.
</p>
</td></tr>
<tr><td><code id="aoplot_+3A_...">...</code></td>
<td>

<p>Other arguments passed to <code><a href="base.html#topic+plot">plot</a></code> function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Column sums of <code>x</code> (species abundances) are plotted against 
column sums of the binarized <code>x</code> (species occupancy).
</p>


<h3>Value</h3>

<p>Creates a plot as a side effect.
</p>
<p>Invisibly returns abundance and occurrence values in a matrix.
</p>


<h3>Author(s)</h3>

<p>Peter Solymos &lt;solymos@ualberta.ca&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count)
x &lt;- mefa(stcs(dol.count))
aoplot(x)
</code></pre>

<hr>
<h2 id='as.data.frame.dist'>
Manipulation Tools for Class 'dist'
</h2><span id='topic+vec2dist'></span><span id='topic+is.dist'></span><span id='topic+stack.dist'></span>

<h3>Description</h3>

<p>Converts a 'dist' object into vector and vice versa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vec2dist(x, size, labels = NULL, diag = FALSE, upper = FALSE, 
call = FALSE, method = NULL)
is.dist(x)
## S3 method for class 'dist'
stack(x, dim.names = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.data.frame.dist_+3A_x">x</code></td>
<td>

<p>A vector or a 'dist' object.
</p>
</td></tr>
<tr><td><code id="as.data.frame.dist_+3A_size">size</code></td>
<td>

<p>Integer, the number of observations in the dataset (see <code><a href="stats.html#topic+dist">dist</a></code>).
</p>
</td></tr>
<tr><td><code id="as.data.frame.dist_+3A_labels">labels</code>, <code id="as.data.frame.dist_+3A_diag">diag</code>, <code id="as.data.frame.dist_+3A_upper">upper</code>, <code id="as.data.frame.dist_+3A_call">call</code>, <code id="as.data.frame.dist_+3A_method">method</code></td>
<td>

<p>Logical, setting attributes of the distance object (see <code><a href="stats.html#topic+dist">dist</a></code>).
</p>
</td></tr>
<tr><td><code id="as.data.frame.dist_+3A_dim.names">dim.names</code></td>
<td>

<p>Logical, if <code>TRUE</code>, names stored in the <code>Labels</code> attribute of the 
<code>dist</code> object are returned as factors instead of row/column indices.
</p>
</td></tr>
<tr><td><code id="as.data.frame.dist_+3A_...">...</code></td>
<td>

<p>Other arguments passed to functions.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>vec2dist</code> returns an object of class <code>dist</code>.
</p>
<p><code>is.dist</code> returns a logical statement about the class of the object.
</p>
<p><code>stack.dist</code> returns a data frame with comuns <code>row</code> for row id's, <code>col</code> for column
id's and <code>dist</code> for the distance values.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vec2dist(1:3, 3)
vec2dist(1:3, 3, diag = TRUE)
vec2dist(1:3, 3, diag = TRUE, upper = TRUE)
vec2dist(1:3, 3, labels=letters[1:3])
x &lt;- dist(1:5)
attr(x, "Labels") &lt;- LETTERS[1:5]
x
is.dist(x)
stack(x)
stack(x, dim.names = TRUE)
</code></pre>

<hr>
<h2 id='as.mefa'>Conversion Among Various Object Classes</h2><span id='topic+as.Mefa'></span><span id='topic+as.Xtab'></span><span id='topic+as.mefa'></span><span id='topic+as.mefa.default'></span><span id='topic+as.mefa.array'></span><span id='topic+as.mefa.list'></span><span id='topic+as.stcs'></span><span id='topic+as.stcs.default'></span><span id='topic+as.data.frame.stcs'></span><span id='topic+as.array.mefa'></span><span id='topic+as.list.mefa'></span><span id='topic+as.matrix.mefa'></span><span id='topic+as.data.frame.mefa'></span><span id='topic+mss'></span><span id='topic+msr'></span><span id='topic+mts'></span><span id='topic+mtr'></span>

<h3>Description</h3>

<p>These functions coerce into class 'mefa' or 'stcs'; or converts 'mefa' or 'stcs' obects into a 'data.frame', 'matrix', 'array', 'list'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.stcs(x, ...)
## Default S3 method:
as.stcs(x, ...)
as.mefa(x, ...)
as.Mefa(x, ...)
as.Xtab(x, ...)
## Default S3 method:
as.mefa(x, samp, taxa, ...)
## S3 method for class 'array'
as.mefa(x, ...)
## S3 method for class 'list'
as.mefa(x, ...)
## S3 method for class 'mefa'
as.matrix(x, ...)
## S3 method for class 'mefa'
as.array(x, ...)
## S3 method for class 'mefa'
as.list(x, ...)
## S3 method for class 'stcs'
as.data.frame(x, ...)
## S3 method for class 'mefa'
as.data.frame(x, ..., fun, name, make.unique = FALSE)
mss(x, name, make.unique = FALSE, ...)
msr(x, name, make.unique = FALSE, ...)
mts(x, name, make.unique = FALSE, ...)
mtr(x, name, make.unique = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.mefa_+3A_x">x</code></td>
<td>
<p>an object of class 'mefa'.</p>
</td></tr>
<tr><td><code id="as.mefa_+3A_samp">samp</code></td>
<td>
<p>a data frame containing rows for samples, or <code>NULL</code>. See argument <code>xtab.fixed</code> and details for sample matching options.</p>
</td></tr>
<tr><td><code id="as.mefa_+3A_taxa">taxa</code></td>
<td>
<p>a data frame containing rows for taxa, or <code>NULL</code>. See argument <code>xtab.fixed</code> and details for taxa matching options.</p>
</td></tr>
<tr><td><code id="as.mefa_+3A_fun">fun</code></td>
<td>
<p>a function to determine what to return, see details. It has no default, because the choice is not trivial.</p>
</td></tr>
<tr><td><code id="as.mefa_+3A_name">name</code></td>
<td>
<p>optional character vector, names to return if not all possible elements are needed, see details.</p>
</td></tr>
<tr><td><code id="as.mefa_+3A_make.unique">make.unique</code></td>
<td>
<p>logical, useful to use <code>make.unique = TRUE</code> if names to return are non-unique, see details.</p>
</td></tr>
<tr><td><code id="as.mefa_+3A_...">...</code></td>
<td>
<p>other arguments passed to the generic function <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The usage of most of these coercion methods is trivial. Arrays and lists can be coerced into 'mefa' objects as if those were the <code>segm</code> element of it (either nested, or non nested). The reverse is true, when coercing an object of class 'mefa' into list or array, the <code>segm</code> element is used.
</p>
<p>Coercing among object classes 'matrix' and 'mefa' is done via using the <code>xtab</code> element.
</p>
<p>By <code>as.data.frame.mefa</code>, four kinds of data frames can be returned, depending on the function used as the <code>fun</code> argument:
<code>mss</code> returns summary statistics for samples (richness and abundance) and <code>x$samp</code>;
<code>msr</code> returns raw data (<code>x$xtab</code>) and <code>x$samp</code>;
<code>mts</code> returns summary statistics for taxa (occurrence and abundance) and <code>x$taxa</code>;
<code>mtr</code> returns raw data (<code>t(x$xtab)</code>) and <code>x$taxa</code>.
</p>
<p>The <code>name</code> can be used if only a subset of the summary statistics, or raw data should be returned. The character vector should contain names of elements to return (see examples).
</p>
<p>It might (rarely) occur, that names of the summary statistics, or the raw data and the column names of the sample/taxa table overlap (contains names that are common in the two set). In this case, the <code>make.unique = TRUE</code> can be used to resolve non-uniqueness and avoid the error message produced otherwise.
</p>
<p>The functions supplied as the <code>fun</code> argument can be used separately. Although the usage of the <code>as.data.frame</code> method is more transparent.
</p>


<h3>Value</h3>

<p>An object of class 'stcs', 'mefa', 'matrix', 'array', 'list' or 'data.frame', depending on the method used.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mefa">mefa</a></code>, <code><a href="#topic+stcs">stcs</a></code>, <code><a href="base.html#topic+as.matrix">as.matrix</a></code>, <code><a href="base.html#topic+as.list">as.list</a></code>, <code><a href="base.html#topic+as.array">as.array</a></code>, <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count, dol.samp, dol.taxa)
x &lt;- mefa(stcs(dol.count), dol.samp, dol.taxa)
## These two are equivalent
as.data.frame(x, fun = mss)
mss(x)
## Return only two species
as.data.frame(x, fun = msr, c("iiso", "ppyg"))
## Taxa table and summary
as.data.frame(x, fun = mts)
## Taxa table and raw data transpose
as.data.frame(x, fun = mtr)
## Why is it useful?
## Instead of
glm(x$xtab[,"amin"] ~ microhab + method, data = x$samp, family = poisson)
## it is more convenient to use
glm(amin ~ microhab + method, data = msr(x), family = poisson)
</code></pre>

<hr>
<h2 id='dolina'>The Dolina Dataset</h2><span id='topic+dol.count'></span><span id='topic+dol.samp'></span><span id='topic+dol.taxa'></span>

<h3>Description</h3>

<p>Data were collected in dolines (sinkholes, karstic depressions) of Northeast Hungary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dol.count)
data(dol.samp)
data(dol.taxa)
</code></pre>


<h3>Format</h3>

<p>The <code>dol.count</code> data set is a data frame with 297 observations on the following 4 variables.
</p>

<dl>
<dt><code>samp</code></dt><dd><p>a factor with levels for samples.</p>
</dd>
<dt><code>taxa</code></dt><dd><p>a factor with levels for the species.</p>
</dd>
<dt><code>count</code></dt><dd><p>a numeric vector with count data.</p>
</dd>
<dt><code>segm</code></dt><dd><p>a factor with levels for segments.</p>
</dd>
</dl>

<p>The <code>dol.samp</code> data set is a data frame with 24 observations on the following 2 variables.
</p>

<dl>
<dt><code>microhab</code></dt><dd><p>a factor with levels <code>dead.wood</code> <code>litter</code> <code>live.wood</code> <code>rock</code> for microhabitats.</p>
</dd>
<dt><code>method</code></dt><dd><p>a factor with levels <code>time</code> <code>quadrat</code> for the sampling method applied.</p>
</dd>
</dl>

<p>The <code>dol.taxa</code> data set is a data frame with 121 observations on the following 4 variables.
</p>

<dl>
<dt><code>species</code></dt><dd><p>a factor with levels the species names.</p>
</dd>
<dt><code>author</code></dt><dd><p>a factor with levels for authors of the species and description dates (accents are removed).</p>
</dd>
<dt><code>familia</code></dt><dd><p>a factor with levels for family level classification.</p>
</dd>
<dt><code>size</code></dt><dd><p>a numeric vector for major shell dimension of the adult specimen.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data sets are results of the 'DOLINA 2007' expedition (Vilisics et al. 2008). Species characteristics are based on Kerney et al. (1983). The full dataset (S\'olymos &amp;  Kemencei 2008) from which this example was derived is available at the Dataverse Network (hdl:1902.1/12060) with the code to make the subsetting.
</p>


<h3>Source</h3>

<p>S\'olymos, P.,  Kemencei, Z. (2008) Methodological study data set of land snails from the Dolina 2007 project. Available at the Dataverse Network: hdl:1902.1/12060.
</p>
<p>S\'olymos, P., Kemencei, Z., P\'all-Gergely, B., Farkas, R., Vilisics, F., Hornung, E. (2009) Does shell accumulation matter in micro scale land snail surveys? <em>Malacologia</em>, <b>51</b>, 389&ndash;393.
</p>
<p>Vilisics, F., Nagy, A., S\'olymos, P., Farkas, R., Kemencei, Z., P\'all-Gergely, B., Kisfali, M., Hornung, E. (2008) Data on the terrestrial isopoda fauna of the Als\'o-hegy, Aggtelek National Park, Hungary. <em>Folia Faunistica Slovaca</em> <b>13</b>, 9&ndash;12.
</p>
<p>Kerney, M. P., Cameron, R. A. D., Jungbluth, J. H. (1983) <em>Die Landschnecken Nord- und Mitteleuropas</em>. P. Parey, Hamburg-Berlin, 384 p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count)
str(dol.count)
data(dol.samp)
str(dol.samp)
data(dol.taxa)
str(dol.taxa)
</code></pre>

<hr>
<h2 id='fill.na'>Replace &lt;NA&gt; Values with Nearest Above Values</h2><span id='topic+fill.na'></span>

<h3>Description</h3>

<p>The function replaces <code>&lt;NA&gt;</code> values with the nearest values above them in the same column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill.na(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill.na_+3A_x">x</code></td>
<td>
<p>a vector, a matrix or a data frame.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is useful when converting a 'notebook style' data into an 'stcs' object. The 'notebook style' data means that observations are registered in a non-redundant way, e.g. when typing in a spreadsheet.
</p>


<h3>Value</h3>

<p>A matrix or a data frame.
</p>


<h3>Note</h3>

<p>This function is not vectorized, so can be a bit slow for large data sets.</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stcs">stcs</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(
    samp = c("s1",NA,"s2",NA,"s3","s4"),
    taxa = c("t1",NA,"s1","s2","s3",NA),
    count = c(1, 2, 10, 3, 4, 1),
    segm = c("male","female","male","female","male","male"))
x
fill.na(x)
fill.na(c(1:4, NA))
</code></pre>

<hr>
<h2 id='image.dist'>
Image Plot of a 'dist' Object
</h2><span id='topic+image.dist'></span>

<h3>Description</h3>

<p>Image plot of a 'dist' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dist'
image(x, grad, lab = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="image.dist_+3A_x">x</code></td>
<td>

<p>An object of class 'dist', not a similarity matrix.
</p>
</td></tr>
<tr><td><code id="image.dist_+3A_grad">grad</code></td>
<td>

<p>Gradient to use for ordering the observations in <code>x</code>.
</p>
</td></tr>
<tr><td><code id="image.dist_+3A_lab">lab</code></td>
<td>

<p>Labels to use at the left axis, can be a character vector.
</p>
</td></tr>
<tr><td><code id="image.dist_+3A_...">...</code></td>
<td>

<p>Other graphical parameters passed to <code><a href="graphics.html#topic+image">image</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates an image plot as a side effect.
</p>
<p>Invisibly returns plotted values.
</p>


<h3>Author(s)</h3>

<p>Peter Solymos &lt;solymos@ualberta.ca&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count, dol.samp)
m &lt;- mefa(stcs(dol.count), dol.samp)
d &lt;- dist(m$xtab)
g &lt;- with(m$samp, interaction(microhab, method))
image(d)
</code></pre>

<hr>
<h2 id='label'>Assign Label to an Object and Return It</h2><span id='topic+label'></span><span id='topic+label+3C-'></span>

<h3>Description</h3>

<p>This function assigns a label to any kind of object. The label later can be retrieved and reused.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>label(x)
label(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="label_+3A_value">value</code></td>
<td>
<p>any expression.</p>
</td></tr>
<tr><td><code id="label_+3A_x">x</code></td>
<td>
<p>any object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The label can be any expression assigned to any object. It is stored as a character attribute. Inheritance is not implemented, so by any transformation of the object into another one, the label is lost.
</p>


<h3>Value</h3>

<p>Print out the label value.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10
x
## Assign a character
label(x) &lt;- "x is a vector"
x
## Get back the label
label(x)
## Note the effect of deparsing
label(x) &lt;- 1:10
label(x)
</code></pre>

<hr>
<h2 id='mat2list'>
Matrix Manipulation Tools
</h2><span id='topic+mat2list'></span><span id='topic+mfill'></span><span id='topic+rdrop'></span><span id='topic+cdrop'></span>

<h3>Description</h3>

<p>Converts a matrix to a list, calculates matrix fill, or exclude rows/columns with certain rox/column sums.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mat2list(x, MARGIN = 1)
mfill(x)
rdrop(x, cutoff = 0, attrib = FALSE)
cdrop(x, cutoff = 0, attrib = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mat2list_+3A_x">x</code></td>
<td>

<p>A vector or matrix to be converted. <code>cdrop</code> and <code>rdrop</code> can take mefa objects as argument.
</p>
</td></tr>
<tr><td><code id="mat2list_+3A_margin">MARGIN</code></td>
<td>

<p>Margin in <code>c(1, 2)</code>, indicating respectively rows or colums to be listed.
</p>
</td></tr>
<tr><td><code id="mat2list_+3A_cutoff">cutoff</code></td>
<td>

<p>Numeric, exclude rows/columns with sums &lt;= <code>cutoff</code>.
</p>
</td></tr>
<tr><td><code id="mat2list_+3A_attrib">attrib</code></td>
<td>

<p>Logical, if a vector of excluded rows/columns should be attached to the return value as an attribute.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mat2list</code> returns a list of length <code>nrow(x)</code> or <code>ncol(x)</code> depending on <code>MARGIN</code>.
Elements are rows/columns of <code>x</code>. Dimnames are retained as names.
</p>
<p><code>mfill</code> returns a single number with the matrix fill value.
</p>
<p><code>rdrop</code> and <code>cdrop</code> returns the original object but excluding rows (<code>rdrop</code>), or columns (<code>cdrop</code>)
that has sum &lt;= <code>cutoff</code>. Excluded row/colum numbers and specifications are stored in the <code>"exclude"</code> attribute of <code>attrib = TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:12, 3, 4)
rownames(x) &lt;- letters[1:3]
colnames(x) &lt;- LETTERS[1:4]
mat2list(x, 1)
mat2list(x, 2)
x[2, ] &lt;- 0
x[, 2] &lt;- 0
mfill(x)
mfill(x) == sum(x &gt; 0) / prod(dim(x))
rdrop(x)
cdrop(x)
cdrop(x, cutoff = 5)
cdrop(x, cutoff = 22) # be careful
</code></pre>

<hr>
<h2 id='mefaCheck'>Check and Compare Object(s) of Class 'mefa'</h2><span id='topic+mefaCheck'></span><span id='topic+mefaCompare'></span>

<h3>Description</h3>

<p>The functions evaluates the internal structute of a 'mefa' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mefaCheck(x)
mefaCompare(x1, x2, strict = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mefaCheck_+3A_x">x</code>, <code id="mefaCheck_+3A_x1">x1</code>, <code id="mefaCheck_+3A_x2">x2</code></td>
<td>
<p>an object of class 'mefa'.</p>
</td></tr>
<tr><td><code id="mefaCheck_+3A_strict">strict</code></td>
<td>
<p>logical, if <code>TRUE</code> the function checks if ordering of dimnames are the same, otherwise it compares only matching.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>mefaCheck</code> returns a list, first element is logical with <code>TRUE</code> indicating that all requirements are met. If this is <code>FALSE</code>, following elements of the list describe the encountered problems as characters.  <code>mefaCheck</code> is called by the <code><a href="#topic+is.mefa">is.mefa</a></code> function.
</p>
<p><code>mefaCompare</code> compares two mefa objects. If all dimnames, and the corresponding values in the <code>xtab</code> and <code>segm</code> parts are identical, the result is <code>TRUE</code>, and otherwise <code>FALSE</code>. Different ordering of dimnames allowed, the comparison is based on the numeric values determined by dimnames.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mefa">mefa</a></code>, <code><a href="#topic+is.mefa">is.mefa</a></code>, <code><a href="base.html#topic+all.equal.list">all.equal.list</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(rpois(20,1), 5, 4)
m &lt;- mefa(x)
mefaCheck(m)
data(dol.count)
x1 &lt;- mefa(stcs(dol.count))
x2 &lt;- mefa(melt(x1))
mefaCompare(x1, x2)
mefaCompare(x1, x2, strict = TRUE)
</code></pre>

<hr>
<h2 id='mefaCrosstab'>Cross Tabulate an Object of Class 'stcs'</h2><span id='topic+mefaCrosstab'></span>

<h3>Description</h3>

<p>The function makes cross tabulation of an object of class 'stcs'. Similar to the <code><a href="base.html#topic+table">table</a></code> function but handles specialities of the 'stcs' object class (i.e. removes 'pseudo species' created to indicate empty samples). This is used internally by the function <code><a href="#topic+mefa">mefa</a></code> to make 3 dimensional representation of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mefaCrosstab(x, segment = FALSE, nested = FALSE, drop.zero = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mefaCrosstab_+3A_x">x</code></td>
<td>
<p>an object of class 'stcs'.</p>
</td></tr>
<tr><td><code id="mefaCrosstab_+3A_segment">segment</code></td>
<td>
<p>logical, if <code>TRUE</code>, the crosstabulation is made in 2 dimensions by the <code>samp</code> (sample) and <code>taxa</code> columns of the <code>x</code>. Otherwise, crosstabulation is made in 3 dimensions by the <code>samp</code>, <code>taxa</code> and <code>segm</code> (segment) columns.</p>
</td></tr>
<tr><td><code id="mefaCrosstab_+3A_nested">nested</code></td>
<td>
<p>logical, if <code>FALSE</code> count values of each segments are independent, if <code>TRUE</code> crosstabulated matrices are summed up in a nested fashion from segment level 1 to the number of segments (it is indicated in the segment levels as well).</p>
</td></tr>
<tr><td><code id="mefaCrosstab_+3A_drop.zero">drop.zero</code></td>
<td>
<p>argument passed to the function <code><a href="#topic+stcs">stcs</a></code>, indicating whether empty samples (with zero sum) should be removed prior to cross tabulation (<code>TRUE</code>), or not (<code>FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cross tabulation of an object of class 'stcs' is made by the function <code><a href="stats.html#topic+xtabs">xtabs</a></code>, whic accepts non-integer values too.
</p>


<h3>Value</h3>

<p>It returs a matrix if <code>segment = FALSE</code> or a list with matrices for the segments if <code>segment = TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+stcs">stcs</a></code>, <code><a href="#topic+mefa">mefa</a></code>, <code><a href="#topic+rep.data.frame">rep.data.frame</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(sample = LETTERS[c(1,1,2,2,3,4)],
    species = c(letters[c(5,5,5,6,7)], "zero.pseudo"),
    count = c(1,2,10,3,4,0), segment = letters[c(8,9,8,9,8,8)])
y &lt;- stcs(x)
mefaCrosstab(y)
mefaCrosstab(y, segment = TRUE)
mefaCrosstab(y, segment = TRUE, nested = TRUE)
## Examples for non-integer data
y[1:5, 3] &lt;- y[1:5, 3] + 0.123
mefaCrosstab(y)
mefaCrosstab(y, segment = TRUE)
</code></pre>

<hr>
<h2 id='mefadocs'>Display Package Documentation</h2><span id='topic+mefadocs'></span>

<h3>Description</h3>

<p>Display package documentation using <code>pager</code> or <code>pdfviewer</code>
defined in <code><a href="base.html#topic+options">options</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mefadocs(doc = c("ChangeLog","SampleReport"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mefadocs_+3A_doc">doc</code></td>
<td>
<p>The name of the document (partial match, case sensitive). </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>"ChangeLog"</code> contains version history, <code>"SampleReport"</code> shows an example LaTeX document how to use <code><a href="#topic+report.mefa">report.mefa</a></code> to prepare <code><a href="utils.html#topic+Sweave">Sweave</a></code> reports based on faunistic data.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos (<a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>) adapted Jari Oksanen's <code><a href="vegan.html#topic+vegandocs">vegandocs</a></code> function in the <strong>vegan</strong> package.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
mefadocs("Change")
mefadocs("Sample")

## End(Not run)
</code></pre>

<hr>
<h2 id='mefalogo'>Schematic Plot of an Object of Class 'mefa'</h2><span id='topic+mefalogo'></span>

<h3>Description</h3>

<p>Plots a shematic representation of and object of class 'mefa', or alternatively plots a colored logo of the <strong>mefa</strong> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mefalogo(type = c("cont", "fill"), labels = c("str", "r"),
adj=c(0,0), scale=c(1,1), new = TRUE, cex = 1, ann=FALSE, axes=FALSE,
xlim=c(0,10)*scale[1]+adj[1], ylim=c(0,10)*scale[2]+adj[2], ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mefalogo_+3A_type">type</code></td>
<td>
<p>character, <code>"cont"</code> is for drawing only black contours, <code>"fill"</code> is for filled polygons.</p>
</td></tr>
<tr><td><code id="mefalogo_+3A_labels">labels</code></td>
<td>
<p>character, <code>"str"</code> for labelling according to the general structure of a 'mefa' object, <code>"r"</code> places a big <code>R</code> letter in the middle (for logo).</p>
</td></tr>
<tr><td><code id="mefalogo_+3A_adj">adj</code></td>
<td>
<p>numeric values to adjust the dimensions of the polygons.</p>
</td></tr>
<tr><td><code id="mefalogo_+3A_scale">scale</code></td>
<td>
<p>a numeric value to rescale the dimensions of the polygons.</p>
</td></tr>
<tr><td><code id="mefalogo_+3A_new">new</code></td>
<td>
<p>logical, if a new plot (<code>TRUE</code>) should be drawn, or just adding the polygons and labels to an existing one (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="mefalogo_+3A_cex">cex</code></td>
<td>
<p>numeric, argument for scaling the labels.</p>
</td></tr>
<tr><td><code id="mefalogo_+3A_ann">ann</code></td>
<td>
<p>logical, annotations of the plot (see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="mefalogo_+3A_axes">axes</code></td>
<td>
<p>logical, drawing axes or not (see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="mefalogo_+3A_xlim">xlim</code>, <code id="mefalogo_+3A_ylim">ylim</code></td>
<td>
<p>extreme values for the x and y axes.</p>
</td></tr>
<tr><td><code id="mefalogo_+3A_...">...</code></td>
<td>
<p>other arguments passed to the function <code>plot</code>, see <code><a href="graphics.html#topic+par">par</a></code>. Only effective if <code>new = TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function was developed for depicting the general structure of the 'mefa' objects. The colored logo version can be used in presentations as well.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mefalogo()
mefalogo("fill", "r")
</code></pre>

<hr>
<h2 id='mefaNestedless'>Make Non-Nested 'mefa' Object</h2><span id='topic+mefaNestedless'></span>

<h3>Description</h3>

<p>The functions makes a non-nested 'mefa' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mefaNestedless(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mefaNestedless_+3A_x">x</code></td>
<td>
<p>an objects of class 'mefa' with nested segments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class 'mefa', with non-nested segments. This function is internally used by the <code><a href="#topic+melt.mefa">melt.mefa</a></code> function.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mefa">mefa</a></code>, <code><a href="#topic+is.mefa">is.mefa</a></code>, <code><a href="#topic+melt.mefa">melt.mefa</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count)
x &lt;- mefa(stcs(dol.count), nested = TRUE)
x
y &lt;- mefaNestedless(x)
y
</code></pre>

<hr>
<h2 id='mefaTables'>Subsetting and Ordering of Related Data Tables</h2><span id='topic+mefaTables'></span>

<h3>Description</h3>

<p>This function is called by the <code><a href="#topic+mefa">mefa</a></code> function to subset the community data matrix and the related data frames, but can be applied more generally for subsetting and ordering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mefaTables(xtab, dframe, margin, index = NULL,
drop.index = FALSE, xtab.fixed = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mefaTables_+3A_xtab">xtab</code></td>
<td>
<p>a data matrix.</p>
</td></tr>
<tr><td><code id="mefaTables_+3A_dframe">dframe</code></td>
<td>
<p>a data frame.</p>
</td></tr>
<tr><td><code id="mefaTables_+3A_margin">margin</code></td>
<td>
<p>margin of the <code>xtab</code> matrix to use row (<code>margin = 1</code>) or column (<code>margin = 2</code>) names in comparison with the rownames of <code>dframe</code>.</p>
</td></tr>
<tr><td><code id="mefaTables_+3A_index">index</code></td>
<td>
<p>if <code>NULL</code> rownames are used directly, else it can be used to set which column of <code>dframe</code> should be used as rowname and for comparison.</p>
</td></tr>
<tr><td><code id="mefaTables_+3A_drop.index">drop.index</code></td>
<td>
<p>logical, should the <code>index</code> column of <code>dframe</code> be deleted (if <code>index != NULL</code>).</p>
</td></tr>
<tr><td><code id="mefaTables_+3A_xtab.fixed">xtab.fixed</code></td>
<td>
<p>logical, if <code>TRUE</code> the <code>xtab</code> matrix is left intact, and <code>dframe</code> is subsetted accordingly. If <code>FALSE</code>, both <code>xtab</code> and <code>dframe</code> are subsetted, and returned values are based on the the intersect of the compared names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with elements <code>xtab</code> (matrix) and <code>dtab</code> (data frame), corresponding to the subsetted <code>xtab</code> and <code>dframe</code> data sets, respectively. Original column and row orderings in the input matrix <code>xtab</code> are preserved.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mefa">mefa</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(rpois(20,1), 5, 4)
## Note the reverse alphabetical names
rownames(x) &lt;- letters[5:1]
x
f &lt;- data.frame(matrix(rnorm(30), 10, 3))
rownames(f) &lt;- letters[1:10]
f
## Reverse alphabetical names preserved
mefaTables(x, f, 1)
## Now result is the intersect
rownames(f) &lt;- letters[3:12]
mefaTables(x, f, 1, xtab.fixed = FALSE)
</code></pre>

<hr>
<h2 id='mefaweb'>Open 'mefa' Website</h2><span id='topic+mefaweb'></span>

<h3>Description</h3>

<p>Opens the 'mefa' website in the default navigator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mefaweb()
</code></pre>


<h3>Details</h3>

<p>The website contains resources for the 'mefa' package, please check out for more. Thank you!
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
mefaweb()

## End(Not run)
</code></pre>

<hr>
<h2 id='melt'>Melt (Convert) an Object of Class 'mefa' Into 'stcs'</h2><span id='topic+melt'></span><span id='topic+melt.mefa'></span>

<h3>Description</h3>

<p>The function converts a wide formatted 'mefa' object into a long formatted 'stcs' object. The resulting segment column can take various formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>melt(x, ...)
## S3 method for class 'mefa'
melt(x, segm.var = NULL, by.samp = TRUE,
raw.out = FALSE, drop.zero = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="melt_+3A_x">x</code></td>
<td>
<p>an object of class 'mefa'.</p>
</td></tr>
<tr><td><code id="melt_+3A_segm.var">segm.var</code></td>
<td>
<p><code>NULL</code> (default) or column indices of samples (if <code>by.samp = TRUE</code>) or taxa tables (if <code>by.samp = FALSE</code>). If it refers to more than one column, their interaction is taken. If <code>NULL</code>, the resulting segment column is filled with <code>"undefined"</code>.</p>
</td></tr>
<tr><td><code id="melt_+3A_by.samp">by.samp</code></td>
<td>
<p>logical, if <code>TRUE</code> (default) <code>segm.var</code> is taken from the samples table (<code>x$samp</code>), if <code>FALSE</code> <code>segm.var</code> is taken from the taxa table (<code>x$taxa</code>).</p>
</td></tr>
<tr><td><code id="melt_+3A_raw.out">raw.out</code></td>
<td>
<p>logical, whether the result should contain all the zeros that is in the crosstabulated (wide) matrix (<code>TRUE</code>) or not (<code>FALSE</code>, default). Removing the zeros is straightforward for sparse matrices. But empty samples can be retained if <code>drop.zero = FALSE</code>.</p>
</td></tr>
<tr><td><code id="melt_+3A_drop.zero">drop.zero</code></td>
<td>
<p>logical, whether samples with zero total count should be leaved out (<code>TRUE</code>) or not (<code>FALSE</code>, default).</p>
</td></tr>
<tr><td><code id="melt_+3A_...">...</code></td>
<td>
<p>other arguments passed to the function <code><a href="#topic+stcs">stcs</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a 'mefa' objet has original segments and <code>segm.var = NULL</code>, the function returns original segments. In this case, the <code>raw.out = TRUE</code> cannot be applied (because segments have different zero samples, so the option is meaningless). If the 'mefa' object contains only a data matrix without dimnames, rows and columns are numbered before melting.
</p>
<p>Besides the goal to convert from wide format to long format, this 'mefa' specific implementation is also useful, if a segment is not coded along with the long formatted database, but can be found in a linked table of samples or species. In this way, a 'mefa' object with new segments can be defined easily.
</p>
<p>If melting is done with a vector that is not part of the tables inside the 'mefa' object, it must have a class attribute to be recognised, use e.g. the <code><a href="base.html#topic+as.factor">as.factor</a></code> function (see 'Examples').
</p>


<h3>Value</h3>

<p>An object of class 'stsc' if <code>raw = FALSE</code>, pure 'data.frame' otherwise (because the zero count flag cannot be applied).
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count, dol.samp, dol.taxa)
x &lt;- mefa(stcs(dol.count), dol.samp, dol.taxa)
## Long format with original segments
melt(x)
## Long format with undefined segment
melt(as.mefa(x, segment = FALSE))
## These two are identical
melt(x, "microhab")
melt(x, x$samp$microhab) ## this is a factor
## Using a simple vector as factor
melt(x, as.factor(rbinom(dim(x)[1], 1, 0.5)))
## Interaction
melt(x, c("method", "microhab"))
## From taxa table
melt(x, "familia", by.samp = FALSE)
## Example for non-integer data
y &lt;- x$xtab
y[y &gt; 0] &lt;-  y[y &gt; 0] + 0.123
z &lt;- mefa(y)
melt(z)
</code></pre>

<hr>
<h2 id='plot.mefa'>Plotting Methods for Object of Class 'mefa' and 'stcs'</h2><span id='topic+plot.mefa'></span><span id='topic+boxplot.mefa'></span><span id='topic+image.mefa'></span><span id='topic+plot.stcs'></span><span id='topic+boxplot.stcs'></span><span id='topic+image.stcs'></span>

<h3>Description</h3>

<p>Various methods for plotting objects of class 'mefa'.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mefa'
plot(x, stat = 1:4, type = c("hist", "rank"),
trafo = c("none", "log", "ratio"), show = TRUE, ylab, xlab, ...)
## S3 method for class 'mefa'
boxplot(x, stat = 1:4, all = TRUE, show = TRUE, ylab, xlab, ...)
## S3 method for class 'mefa'
image(x, segm=NULL, trafo=c("none", "log", "bins", "prab"), 
probs = seq(0, 1, 0.05), ordering = TRUE, reverse = TRUE, names = FALSE,
show = TRUE, ylab, xlab, ...)
## S3 method for class 'stcs'
plot(x, stat = 1:4, type = c("hist", "rank"),
trafo = c("none", "log", "ratio"), show = TRUE, ylab, xlab, ...)
## S3 method for class 'stcs'
boxplot(x, stat = 1:4, all = TRUE, show = TRUE, ylab, xlab, ...)
## S3 method for class 'stcs'
image(x, segm=NULL, trafo=c("none", "log", "bins", "prab"), 
probs = seq(0, 1, 0.05), ordering = TRUE, reverse = TRUE, names = FALSE,
show = TRUE, ylab, xlab, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mefa_+3A_x">x</code></td>
<td>
<p>an object of class 'mefa' or 'stcs'.</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_stat">stat</code></td>
<td>
<p>numeric, to determine which characteristic to plot. <code>1</code>: number of species in samples (default), <code>2</code>: total number of individuals in samples, <code>3</code>: number of occurrences per taxa, <code>4</code> number of individuals per taxa.</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_type">type</code></td>
<td>
<p>character, <code>"hist"</code> produces barchart for discrete values and histogram for continuous values (default), <code>"rank"</code> ranked curves based on the characteristic defined by <code>stat</code>.</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_trafo">trafo</code></td>
<td>
<p>character, transformation of the plotted variable. <code>"none"</code>: no transformation (default), <code>"log"</code>: logarithmic transformation (base 10), <code>"ratio"</code>: normalizes values by the maximum and rescales to the [0, 1] interval (useful for plotting multiple rank abundance curves), <code>"bins"</code>: recodes the values according to quantiles based on <code>probs</code>, <code>"prab"</code>: presence absence transformation of count data.</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_all">all</code></td>
<td>
<p>logical, if <code>TRUE</code> values of <code>stat</code> is plotted for all segments too on the boxplot.</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_ylab">ylab</code>, <code id="plot.mefa_+3A_xlab">xlab</code></td>
<td>
<p>character to overwrite default label for the y and x axes. If <code>NULL</code>, than default labels are returned on the plot.</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_segm">segm</code></td>
<td>
<p>if <code>NULL</code> the <code>x$xtab</code> matrix is used for plotting. Otherways, this defines the segment (one element in <code>x$segm</code>) for plotting (can be numeric or character with the name of the segment).</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_probs">probs</code></td>
<td>
<p>numeric vector of probabilities with values in [0, 1] (passed internally to <code><a href="#topic+qvector">qvector</a></code>).</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_ordering">ordering</code></td>
<td>
<p>logical, if <code>TRUE</code> (default) the samples-by-taxa matrix is ordered by row and columns sums, if <code>FALSE</code> row and columns are not rearranged.</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_reverse">reverse</code></td>
<td>
<p>logical, if the values to plot should be reversed (<code>TRUE</code>, default, original zero values are lightly, while higher values are strongly coloured) or not (<code>FALSE</code>). This is related to <code>col</code> argument of the generic function <code><a href="graphics.html#topic+image">image</a></code>. Currently, <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code> is the default color scheme.</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_names">names</code></td>
<td>
<p>logical, it labels samples and taxa in the plot using names in <code>x</code>. If it is a logical vector of length 2, sample and taxa names are returned accordingly.</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_show">show</code></td>
<td>
<p>logical, produce a plot (<code>TRUE</code>) or not (<code>FALSE</code>). <code>FALSE</code> can be useful, if the returned plotted values are reused (e.g. the matrix returned invisibly <code>image</code> can be used by <code><a href="graphics.html#topic+filled.contour">filled.contour</a></code>, or multiple values are used in one plot).</p>
</td></tr>
<tr><td><code id="plot.mefa_+3A_...">...</code></td>
<td>
<p>further arguments to pass to plotting functions. See especially <code>zlim</code> and <code>col</code> arguments of the generic function <code><a href="graphics.html#topic+image">image</a></code>, and arguments for the generic function <code><a href="graphics.html#topic+boxplot">boxplot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot</code> returns barchart/histogram, or ranked curve of summary statistics (number of species, individuals in samples, number of occurrences or abundance of taxa) based on the <code>x$xtab</code> matrix of the 'mefa' objects. These values are basically returned by <code><a href="#topic+summary.mefa">summary.mefa</a></code>.
</p>
<p><code>boxplot</code> returns box-and-whiskers plots for the summary statistics based on matrices for each segments in <code>x$segm</code>.
</p>
<p><code>image</code> creates a grid of colored rectangles with colors corresponding to the values in the segment defined by the argument <code>segm</code>. If <code>ordering = TRUE</code>, the ordering of the segment will be based on the <code>x$xtab</code> matrix and not on the matrix for the segment itself. This is due to better comparison among segments.
</p>
<p>All graphical display methods for objects of class 'stcs' are based on the conversion of the object into 'mefa', and than the respective plotting method is applied. The conversion is made based on the default <code>mefa</code> settings (e.g. with segments). If more control is needed over the object structure, use the <code>mefa</code> function to coerce to a more appropriate class for this.
</p>


<h3>Value</h3>

<p>All methods produce a plot if <code>show = TRUE</code>, and return the plotted values invisibly, or visibly if <code>show = FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+image">image</a></code>, <code><a href="base.html#topic+plot">plot</a></code>, <code><a href="graphics.html#topic+boxplot">boxplot</a></code>, <code><a href="graphics.html#topic+filled.contour">filled.contour</a></code>, <code><a href="graphics.html#topic+par">par</a></code>, <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code>, <code><a href="grDevices.html#topic+topo.colors">topo.colors</a></code>, <code><a href="grDevices.html#topic+terrain.colors">terrain.colors</a></code>, <code><a href="grDevices.html#topic+rainbow">rainbow</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count, dol.samp, dol.taxa)
x &lt;- mefa(stcs(dol.count), dol.samp, dol.taxa)
## Frequency distributions
opar &lt;- par(mfrow=c(2,2))
plot(x, 1)
plot(x, 2)
plot(x, 3)
plot(x, 4)
par(opar)
## Ranked curves
opar &lt;- par(mfrow=c(2,2))
plot(x, 1, type="rank")
plot(x, 2, type="rank")
plot(x, 3, type="rank")
plot(x, 4, type="rank")
par(opar)
## Boxplot for segments
opar &lt;- par(mfrow=c(2,2))
boxplot(x, 1)
boxplot(x, 2)
boxplot(x, 3)
boxplot(x, 4)
par(opar)
## Image (levelplot)
## comparing all and the segments
opar &lt;- par(mfrow=c(1,3))
image(x, trafo = "bins", main = "All segments")
image(x, segm = 1, trafo = "bins", main = dimnames(x)$segm[1])
image(x, segm = 2, trafo = "bins", main = dimnames(x)$segm[2])
par(opar)
## For black and white, with names
image(x, col = grey(seq(0, 1, 0.1)), names = TRUE)
## For nice colors other than default
opar &lt;- par(mfrow=c(1,2))
image(x[,,"fresh"], col = topo.colors(10),
main = "Fresh")
image(x[,,"broken"], col = terrain.colors(10),
main = "Broken")
par(opar)
</code></pre>

<hr>
<h2 id='qvector'>Ordinal Transformation of a Vector</h2><span id='topic+qvector'></span>

<h3>Description</h3>

<p>Converts a numeric vector into an ordinal one based on quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qvector(x, probs = seq(0, 1, 0.25), na.rm = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qvector_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="qvector_+3A_probs">probs</code></td>
<td>
<p>numeric vector of probabilities with values in [0, 1] used by <code><a href="stats.html#topic+quantile">quantile</a></code>.</p>
</td></tr>
<tr><td><code id="qvector_+3A_na.rm">na.rm</code></td>
<td>
<p>logical, if true, any <code>NA</code> and <code>NaN</code>s are removed from <code>x</code> before the quantiles are computed.</p>
</td></tr>
<tr><td><code id="qvector_+3A_...">...</code></td>
<td>
<p>further arguments passed to the function <code><a href="stats.html#topic+quantile">quantile</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length the same as the input vector, containing the respective (upper) quantile values.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+quantile">quantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(20)
x
y &lt;- qvector(x)
y
rbind(x, y)
plot(x, y, type="h")
</code></pre>

<hr>
<h2 id='rep.data.frame'>Inflate (repeat) a Data Frame</h2><span id='topic+rep.data.frame'></span>

<h3>Description</h3>

<p>The function inflates a data frame based on count values in a vector corresponding the rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame'
rep(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rep.data.frame_+3A_x">x</code></td>
<td>
<p>a matrix or data frame, but can be a vector.</p>
</td></tr>
<tr><td><code id="rep.data.frame_+3A_...">...</code></td>
<td>
<p>arguments passed to the function <code><a href="base.html#topic+rep">rep</a></code>, i.e. <code>times</code>,
<code>length.out</code> and <code>each</code> (see explanation there).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each rows of the data frame <code>x</code> will be repeated as many times as the corresponding value in e.g. the vector <code>times</code>. This function is called internally by the function <code><a href="#topic+stcs">stcs</a></code>.
</p>


<h3>Value</h3>

<p>A data frame with columns as in the original (<code>x</code>) and e.g. <code>sum(times)</code> number of rows.</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stcs">stcs</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(sample = LETTERS[c(1,1,2,2,3)],
    species = letters[c(5,5,5,6,7)],
    count = c(1,2,10,3,4), segment = letters[c(8,9,8,9,8)])
x
rep(x[,c(1,2,4)], times = x[,3])
rep(x[,c(1,2,4)], each = 2)
</code></pre>

<hr>
<h2 id='report.mefa'>Write Report of an Object of Class 'mefa' into File</h2><span id='topic+report.mefa'></span><span id='topic+report'></span>

<h3>Description</h3>

<p>The data of the 'mefa' object is written into a file in a standard format used by most local journals for publishing distribution data of organisms. The aim is to provide an exporting facility that can directly be used for generating reports, parts of research papers, or supplementary materials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report(x, ...)
## S3 method for class 'mefa'
report(x, filename, segment = FALSE, n = NULL,
    by.taxa = TRUE, samp.var = NULL, drop.redundant = NULL,
    collapse = TRUE, taxa.name = NULL, author.name = NULL,
    taxa.order = NULL, grouping = FALSE, tex = FALSE, binary = FALSE,
    tex.control = list(ital.taxa = TRUE, noindent = TRUE, 
    bold.sect = TRUE, bold.1st = TRUE, vspace1 = 0.5, vspace2 = 0.2),
    sep = c(",", ":", "(", ":", ",", ")", ";"), dir = getwd(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="report.mefa_+3A_x">x</code></td>
<td>
<p>an object of class 'mefa'.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_filename">filename</code></td>
<td>
<p>character, the name of the file to be written into the working directory or a directory defined by the <code>outdir</code> argument.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_segment">segment</code></td>
<td>
<p>logical, if <code>NULL</code> (default) segments are not distinguished in the output. If <code>TRUE</code> all (<code>n = NULL</code>) or some of the segments are used and distinguished.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_n">n</code></td>
<td>
<p>segments to be used. If <code>NULL</code> all segments are used, if not <code>NULL</code>, give names of the segments to be used (only if <code>segment = TRUE</code>).</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_by.taxa">by.taxa</code></td>
<td>
<p>logical, whether the main sectioning should be made according to taxa (<code>TRUE</code>, default) or samples (<code>FALSE</code>, currently not implemented).</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_samp.var">samp.var</code></td>
<td>
<p>variables in the samples table (<code>x$samp</code>) to be used in the report. Variables appear in the order given here.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_drop.redundant">drop.redundant</code></td>
<td>
<p>logical, whether redundant elements should be dropped (an integer up to <code>length(samp.var)-1</code>) or not (<code>NULL</code>, default).</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_collapse">collapse</code></td>
<td>
<p>logical, if <code>TRUE</code> samples with identical values in <code>samp.var</code> for a given species are collapsed to avoid redundancy.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_taxa.name">taxa.name</code></td>
<td>
<p>column in the taxa table (<code>x$taxa</code>) where the taxa names are stored. By default (<code>NULL</code>) <code>dimnames(x)$taxa</code> is used.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_author.name">author.name</code></td>
<td>
<p>column in the taxa table (<code>x$taxa</code>) where the authors' names and dates of descriptions are stored. By default it is not used (<code>NULL</code>). If specified, these follow the species names in the report.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_taxa.order">taxa.order</code></td>
<td>
<p>column in the taxa table (<code>x$taxa</code>) where the variable for ordering is stored. By default (<code>NULL</code>) <code>taxa.name</code> is used for ordering.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_grouping">grouping</code></td>
<td>
<p>logical, whether all records of a given species should be collapsed into single paragraph without grouping (<code>FALSE</code>, default), or grouped into separate paragraphs (<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_tex">tex</code></td>
<td>
<p>logical, whether to generate formatted LaTeX output (<code>TRUE</code>) or plain text file (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_binary">binary</code></td>
<td>
<p>logical, if <code>TRUE</code> the result will contains count data.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_tex.control">tex.control</code></td>
<td>
<p>a list with LaTex formatting options (if <code>tex = TRUE</code>). The <code>ital.taxa</code> controls italicised taxa names, <code>noindent</code> controls indentation of paragraphs, <code>bold.sect</code> controls boldface type of paragraph openings, <code>bold.1st</code> controls the boldface type of first elements of each record of a given species, <code>vspace1</code> controls the space between species blocks, <code>vspace2</code> controls the space between paragraphs of the same species (if <code>gouping = FALSE</code>).</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_sep">sep</code></td>
<td>
<p>character vector of length 7. The 1st separates values in <code>samp.var</code>, 2nd is placed between values of <code>samp.var</code> if redundant elements were dropped, 3rd is the opening character before count data, 4th stands after the segment name, 5th separates values of segments, 6th is the closing character after the count data, 7th separates the records.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_dir">dir</code></td>
<td>
<p>character, full path of the directory where the file should be written (working directory is then restored). If <code>NULL</code>, the current working directory is used.</p>
</td></tr>
<tr><td><code id="report.mefa_+3A_...">...</code></td>
<td>
<p>further arguments potentially passed (currently there are none).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The resulting file can be recycled by copy-and-pasting into a document (if <code>tex = FALSE</code>) or be included into a LaTeX report (e.g. via the package <code>Sweave</code>, see <code>mefadocs("SampleReport")</code>). Contrary to the many arguments, the default values do not need much modifications in most of the cases (see examples).
</p>


<h3>Value</h3>

<p>Writes a file into the working (or a specified) directory.
</p>


<h3>Note</h3>

<p>The <code>by.taxa = FALSE</code> option is not yet implemented.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mefa">mefa</a></code>, <code><a href="base.html#topic+write">write</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dol.count, dol.samp, dol.taxa)
x &lt;- mefa(stcs(dol.count), dol.samp, dol.taxa)
## Not run: 
## Plain text
## Count values from x$xtab
report(x, "report-all.txt")
## Count values for each segments
report(x, "report-segm-all.txt",
    samp.var = c("method","microhab"), segment = TRUE)
## LaTeX formatting
report(x, "report-all.tex", tex=TRUE)
## For how to include into a TeX or Rnw file, see:
mefadocs("SampleReport")

## End(Not run)
</code></pre>

<hr>
<h2 id='stcs'>Create an Object of Class 'stcs'</h2><span id='topic+stcs'></span><span id='topic+is.stcs'></span><span id='topic+summary.stcs'></span>

<h3>Description</h3>

<p>This function creates object of class 'stcs' from a data frame. This is the primary format for long (database style) data sets in the <strong>mefa</strong> package. The 'stcs' object can be converted into an object of class 'mefa' with the function <code>mefa</code>. The function name 'stcs' refers to first letters of column names of the resulting object: <strong>s</strong>amples, <strong>t</strong>axa, <strong>c</strong>ounts, <strong>s</strong>egments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stcs(dframe, expand = FALSE, drop.zero = FALSE, zero.pseudo = "zero.pseudo")
## S3 method for class 'stcs'
is(x)
## S3 method for class 'stcs'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stcs_+3A_dframe">dframe</code></td>
<td>
<p>a data frame with 2-4 columns. If 2 columns are provided, it is assumed that first column contains sample, while second taxa names. If 3 columns are provided, the first two is treated as sample and taxa names, while the third is treated as count if numeric (either integer or non-integer values can be supplied), and segment if character or factor. If 4 columns are provided, those are assumed to be in the samples, taxa, count, segment order.</p>
</td></tr>
<tr><td><code id="stcs_+3A_expand">expand</code></td>
<td>
<p>logical, whether the object should be (<code>TRUE</code>) expanded (via the function <code><a href="#topic+rep.data.frame">rep.data.frame</a></code>) or not (<code>FALSE</code>, default). If expanded, each rows correspond to one individual observation (value of the <code>count</code> column is 1) or a zero sample. <code>expand = TRUE</code> works only with integer values.</p>
</td></tr>
<tr><td><code id="stcs_+3A_drop.zero">drop.zero</code></td>
<td>
<p>logical, whether samples with zero total count should be left out (<code>TRUE</code>) or not (<code>FALSE</code>, default).</p>
</td></tr>
<tr><td><code id="stcs_+3A_zero.pseudo">zero.pseudo</code></td>
<td>
<p>character, value in the <code>taxa</code> column that indicates zero samples. If it is a vector of length 2, first element is used for taxa names, second for segment names to indicate zero samples.</p>
</td></tr>
<tr><td><code id="stcs_+3A_x">x</code>, <code id="stcs_+3A_object">object</code></td>
<td>
<p>an object of class 'stcs'.</p>
</td></tr>
<tr><td><code id="stcs_+3A_...">...</code></td>
<td>
<p>further arguments passed to the function <code>stcs</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the data are in a long (database style) format, the <code>stcs</code> function prepares the ground for the <code>mefa</code> function to make the cross tabulation. But if only a crosstabulated matrix is needed, the <code><a href="base.html#topic+table">table</a></code> function can be applies as well (in this case be sure to set <code>expand = TRUE</code>, and this is only for integer data), or alternatively see the <code><a href="stats.html#topic+xtabs">xtabs</a></code> or <code><a href="#topic+mefaCrosstab">mefaCrosstab</a></code> functions (these accepts non-integer data). For subsetting, simply use extraction methods available for data frames (<code><a href="base.html#topic++5B.data.frame">[.data.frame</a></code>).
</p>
<p>The summary contains statistics calculated after coercing the object into the class 'mefa'.
</p>
<p>Methods for extracting, subsetting are the same as for data frame objects. Plotting 'stcs' objects are discussed elsewhere (see links in 'See also' section).
</p>


<h3>Value</h3>

<p>Returns an object of class 'stcs' with 4 columns. The column names are converted consistently into <code>samp</code> for samples, <code>taxa</code> for taxa names, <code>count</code> for counts and <code>segm</code> for segment names.
</p>
<p>The class has its own methods (i.e. <code>is</code>, <code>as.stcs</code>, <code>summary</code> and <code>plot</code>), but also has a <code>data.frame</code> class attribute. Thus other methods that available for data frames are applicable to an object of class 'stcs' (e.g. <code>print</code>, <code>str</code>).
</p>


<h3>Note</h3>

<p>The <code>stcs</code> function nearly equivalent to the <code>sscount</code> function in older (&lt; 2.0) versions of the <strong>mefa</strong> package.
</p>


<h3>Author(s)</h3>

<p>P\'eter S\'olymos, <a href="mailto:solymos@ualberta.ca">solymos@ualberta.ca</a>
</p>


<h3>References</h3>

<p>S\'olymos P. (2008) mefa: an R package for handling and reporting count data. <em>Community Ecology</em> <b>9</b>, 125&ndash;127.
</p>
<p>S\'olymos P. (2009) Processing ecological data in R with the mefa package. <em>Journal of Statistical Software</em> <b>29(8)</b>, 1&ndash;28. <a href="https://doi.org/10.18637/jss.v029.i08">doi:10.18637/jss.v029.i08</a>
</p>
<p><a href="http://mefa.r-forge.r-project.org/">http://mefa.r-forge.r-project.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+data.frame">data.frame</a></code>, <code><a href="base.html#topic+summary.data.frame">summary.data.frame</a></code>, <code><a href="utils.html#topic+str">str</a></code>, <code><a href="base.html#topic+table">table</a></code>
</p>
<p>See <code><a href="#topic+plot.stcs">plot.stcs</a></code> <code><a href="#topic+boxplot.stcs">boxplot.stcs</a></code> and <code><a href="#topic+image.stcs">image.stcs</a></code> for graphical display options.
</p>
<p>See <code><a href="#topic+as.stcs">as.stcs</a></code> for coercion methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## General long format data
x &lt;- data.frame(
    sample = paste("Sample", c(1,1,2,2,3,4), sep="."),
    species = c(paste("Species", c(1,1,1,2,3), sep="."),  "zero.pseudo"),
    count = c(1,2,10,3,4,0),
    segment = letters[c(6,13,6,13,6,6)])
x
## Long format as stcs
y &lt;- stcs(x)
y
## Methods
as.stcs(x)
is(y, "stcs")
is(y, "data.frame")
## Effects of arguments
stcs(x, expand = TRUE)
stcs(x, drop.zero = TRUE)
stcs(x, zero.pseudo = "pseudo.secies")
## Input options
stcs(x[,1:2])
stcs(x[,1:3])
stcs(x[,c(1:2,4)])
## The Dolina dataset
data(dol.count)
dol &lt;- stcs(dol.count)
dol
plot(dol)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
