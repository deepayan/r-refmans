<!DOCTYPE html><html><head><title>Help for package VPdtw</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VPdtw}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dilation'><p> Compute a morphological dilation of a signal</p></a></li>
<li><a href='#reference'><p> GC-MS Chromatogram</p></a></li>
<li><a href='#VPdtw'><p>Variable Penalty Dynamic Time Warping function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Variable Penalty Dynamic Time Warping</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1-14</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-07-03</td>
</tr>
<tr>
<td>Description:</td>
<td>Variable Penalty Dynamic Time Warping (VPdtw) for aligning chromatographic signals. With an appropriate penalty this method performs good alignment of chromatographic data without deforming the peaks (Clifford, D., Stone, G., Montoliu, I., Rezzi S., Martin F., Guy P., Bruce S., and Kochhar S.(2009) &lt;<a href="https://doi.org/10.1021%2Fac802041e">doi:10.1021/ac802041e</a>&gt;; Clifford, D. and Stone, G. (2012) &lt;<a href="https://doi.org/10.18637%2Fjss.v047.i08">doi:10.18637/jss.v047.i08</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ethanbass/VPdtw/">https://github.com/ethanbass/VPdtw/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ethanbass/VPdtw/issues">https://github.com/ethanbass/VPdtw/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-10 20:17:13 UTC; ethanbass</td>
</tr>
<tr>
<td>Author:</td>
<td>David Clifford [aut],
  Glenn Stone [aut],
  Ethan Bass <a href="https://orcid.org/0000-0002-6175-6739"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ethan Bass &lt;ethanbass@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-14 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dilation'> Compute a morphological dilation of a signal </h2><span id='topic+dilation'></span>

<h3>Description</h3>

<p>A dilation is a moving local maximum over a window of specific fixed
width specified by span. This dilation is computed first in one
direction and then in the other. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dilation(y, span)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dilation_+3A_y">y</code></td>
<td>
<p>signal, a numeric vector</p>
</td></tr>
<tr><td><code id="dilation_+3A_span">span</code></td>
<td>
<p> the width of the moving window, integer </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A dilation is a method often used in mathematical morphology and image
analysis (Soille 1999). This function is for vectors not matrices or
images though applying it to rows and columns of a matrix will give
the corresponding results. 
</p>
<p>An erosion of a vector or image can also be computed easily from this
by computing the dilation of -1 times the vector and transforming
back.
</p>
<p>We recommend using a dilation to form a <code>penalty</code> for use in
<code>VPdtw</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>res</code></td>
<td>
<p>Dilation of y with width span</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> David Clifford </p>


<h3>References</h3>

<p> Soille, P. Morphological Image Analysis: Principles and
Applications; Springer: New York, 1999. </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1 - dilation of a signal
data(reference)
dref &lt;- dilation(reference,150)
plot(reference,log="y",type="l")
lines(dref,col=2)

## Example 2 - dilation of an image
BIN &lt;- (volcano&gt;177)
dBIN &lt;- t(apply(BIN,1,dilation,span=5))
dBIN &lt;- apply(dBIN,2,dilation,span=5)
oldpar &lt;- par(no.readonly = TRUE)
par(mfrow=c(2,2))
image(volcano)
image(BIN)
image(dBIN)
par(oldpar)
</code></pre>

<hr>
<h2 id='reference'> GC-MS Chromatogram</h2><span id='topic+reference'></span><span id='topic+query'></span>

<h3>Description</h3>

<p>GC-MS chromatogram from a wine sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(reference)</code></pre>


<h3>Format</h3>

<p>A numeric vector of length 10018</p>


<h3>Details</h3>

<p>This together with the <code>query</code> data are used in the VPdtw
examples. The alignment of these two signals is usually carried out on
the log scale. Plotting of this signal is best done also on the log
scale (see example below).
</p>


<h3>Source</h3>

<p>Amalia Berna, Stephen Trowell, CSIRO Food Futures Flagship
</p>


<h3>References</h3>

<p>Amalia Z. Berna, Stephen Trowell, David Clifford, Wies Cynkar, Daniel
Cozzolino, Geographical origin of Sauvignon Blanc wines predicted by
mass spectrometry and metal oxide based electronic nose, Analytica
Chimica Acta, Volume 648, Issue 2, 26 August 2009, Pages 146-152, ISSN
0003-2670, DOI: 10.1016/j.aca.2009.06.056.  Keywords: Sauvignon Blanc;
Electronic nose; Gas chromatography-mass spectrometry; Prediction
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(reference)
data(query)
plot(reference,log="y",type="l",main="Gas Chromatogram",ylab="log(intensity)",lwd=2,col=1)
lines(query,col=2)

</code></pre>

<hr>
<h2 id='VPdtw'>Variable Penalty Dynamic Time Warping function</h2><span id='topic+VPdtw'></span><span id='topic+print.VPdtw'></span><span id='topic+plot.VPdtw'></span>

<h3>Description</h3>

<p>Use variable penalty dynamic time warping to align one (or many)
query signal(s) to a master signal. Penalties are incurred whenever a
non-diagonal move is taken. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VPdtw(reference, query, penalty = 0, maxshift = 50, 
      Reference.type = c("random","median","mean","trimmed"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VPdtw_+3A_reference">reference</code></td>
<td>
<p> Reference signal, NULL or a vector, see details.</p>
</td></tr>
<tr><td><code id="VPdtw_+3A_query">query</code></td>
<td>
<p> Query signal, a vector or matrix, see details </p>
</td></tr>
<tr><td><code id="VPdtw_+3A_penalty">penalty</code></td>
<td>
<p> Penalty term, a vector of same length as reference
(not checked) or a matrix. See details. Default is 0 repeated to the
length of reference</p>
</td></tr>
<tr><td><code id="VPdtw_+3A_maxshift">maxshift</code></td>
<td>
<p> Maximum allowable shift, an integer</p>
</td></tr>
<tr><td><code id="VPdtw_+3A_reference.type">Reference.type</code></td>
<td>
<p>Choices for <code>reference</code> if NULL is input</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs variable penalty dynamic time warping of <code>query</code> to
<code>reference</code>. Sakoe Chiba dtw used with width <code>maxshift</code>.
</p>
<p>The basic operation aligns a <code>query</code> vector to a
<code>reference</code> vector.
</p>
<p>If <code>reference</code> is not specified and <code>query</code> is a matrix
then the <code>reference</code> is created based on the value of
<code>Reference.type</code>. The four choices are <code>random</code>,
<code>median</code>, <code>mean</code> and <code>trimmed</code>. These choose a column
of <code>query</code> at random as a reference, or the piecewise median,
mean or trimmed mean (with trim=0.1) with missing values removed.
</p>
<p>If <code>query</code> is a matrix and <code>penalty</code> is a vector then the
same penalty is used to align each column of <code>query</code> to the
<code>reference</code>. Different alignment paths are chosen for each
column of the <code>query</code> matrix.
</p>
<p>If <code>query</code> is a vector and <code>penalty</code> is a matrix then the
<code>query</code> is aligned to the <code>reference</code> several times, using
each column of the <code>penalty</code> matrix in turn as the penalty for
the alignment.
</p>
<p>If <code>query</code> and <code>penalty</code> are matrices then nothing
happens. If you wish to align many query vectors and test many
penalty vectors at the same time then do the appropriate looping (over
queries, or penalties) outside of <code>VPdtw</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>xVals</code></td>
<td>
<p>For plotting everything to correct index</p>
</td></tr>
<tr><td><code>reference</code></td>
<td>
<p>reference vector used by VPdtw expanded by NAs for plotting</p>
</td></tr>
<tr><td><code>query</code></td>
<td>
<p>query passed to VPdtw</p>
</td></tr>
<tr><td><code>penalty</code></td>
<td>
<p>penalty passed to VPdtw</p>
</td></tr>
<tr><td><code>warpedQuery</code></td>
<td>
<p>result of alignment, same class as query</p>
</td></tr>
<tr><td><code>shift</code></td>
<td>
<p>shifts required to achieve alignment</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>Summary information about the alignment. Used for <code>print.VPdtw</code></p>
</td></tr>
<tr><td><code>information</code></td>
<td>
<p>Information about the alignment. Used for <code>print.VPdtw</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Clifford, Glenn Stone</p>


<h3>References</h3>

<p> Alignment Using Variable Penalty Dynamic Time Warping by CLIFFORD, 
D; STONE, G; MONTOLIU, I; et al. ANALYTICAL CHEMISTRY Volume: 81 Issue: 3 Pages:
1000-1007 Published: 2009</p>


<h3>See Also</h3>

<p>Also check out the <a href="dtw.html#topic+dtw">dtw</a> package by 
Toni Giorgino which covers many variations of dynamic time warping.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Citation
  citation("VPdtw")

  ## Basic Examples of zero-penalty DTW

  ## Example of exact fit in the middle
  query &lt;- c(1,5,4,3,9,8,5,2,6,5,4)
  reference &lt;- c(rnorm(5),query,rnorm(5))
  lambda &lt;- rep(0,length(reference))
  maxshift &lt;- 11
  res &lt;- VPdtw(reference,query,lambda,maxshift)
  plot(res)
  res

  ## Example of exact fit on one side
  reference &lt;- c(1,5,4,3,9,8,5,2,6,5,4)
  query &lt;- c(rnorm(5),reference)
  reference &lt;- c(reference,rnorm(5))
  lambda &lt;- rep(0,length(reference))
  maxshift &lt;- 6
  res &lt;- VPdtw(reference,query,lambda,maxshift)
  plot(res)
  res

  ## Example of exact fit on the other side
  reference &lt;- c(1,5,4,3,9,8,5,2,6,5,4)
  query &lt;- c(reference,rnorm(5))
  reference &lt;- c(rnorm(5),reference)
  lambda &lt;- rep(0,length(reference))
  maxshift &lt;- 6
  res &lt;- VPdtw(reference,query,lambda,maxshift)
  plot(res)
  res

  ## Example of exact fit except where one query gets dropped and its all on one side
  reference &lt;- c(1,5,4,3,9,8,5,2,6,5,4)
  query &lt;- c(reference[1:5],20,reference[6:11])
  reference &lt;- c(rnorm(5),reference)
  query &lt;- c(query,rnorm(5))
  lambda &lt;- rep(0,length(reference))
  maxshift &lt;- 6
  res &lt;- VPdtw(reference,query,lambda,maxshift)
  plot(res)
  res
  
## Examples that use penalty term. Examples with long signals

data(reference)
data(query)
## Do alignment on log scale
reference &lt;- log(reference)
query &lt;- log(query)

## VPdtw
result &lt;- VPdtw(reference=reference[1:2500],query=query[1:2500],
                penalty=dilation(reference[1:2500],150)/4,maxshift=150)
plot(result)
result

## Zero penalty DTW
result2 &lt;- VPdtw(reference=reference[1:2500],query=query[1:2500],
                 penalty=rep(0,length(reference)),maxshift=150)
plot(result2)

## Try both penalties at the same time
penalty &lt;- dilation(reference,350)/5
penalty &lt;- cbind(penalty,rep(0,length(penalty)))

result &lt;- VPdtw(reference,query,penalty=penalty,maxshift=350)
plot(result,"After")
plot(result,"Shift")
result

## All three plots at once
plot(result)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
