<!DOCTYPE html><html><head><title>Help for package rkt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rkt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pie1'>
<p>Example data for rkt function</p></a></li>
<li><a href='#pie1w'>
<p>Example data for rkt function</p></a></li>
<li><a href='#print.rkt'>
<p>print Method for class rkt</p></a></li>
<li><a href='#rkt'>
<p>Mann Kendall test and Seasonal and Regional Kendall tests (SKT/RKT)</p></a></li>
<li><a href='#rkt-package'>
<p>Mann-Kendall Test, Seasonal and Regional Kendall Tests</p></a></li>
<li><a href='#sign1'>
<p>modified sign() fucntion for SKT taking into account missing data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Mann-Kendall Test, Seasonal and Regional Kendall Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Aldo Marchetto</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aldo Marchetto &lt;aldo.marchetto@cnr.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains function rkt which computes the Mann-Kendall test (MK) and the Seasonal and the Regional Kendall Tests for trend (SKT and RKT) and  Theil-Sen's slope estimator. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-07 21:11:30 UTC; aldo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-08 08:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='pie1'>
Example data for rkt function
</h2><span id='topic+pie1'></span>

<h3>Description</h3>

<p>Bulk open field deposition collected in Val Sessera (Italy) in 1998-2010, volume weighted monthly averages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pie1)</code></pre>


<h3>Format</h3>

<p>A data frame with 156 observations on the following 5 variables.
</p>

<dl>
<dt><code>Year</code></dt><dd><p>sampling year</p>
</dd>
<dt><code>Month</code></dt><dd><p>sampling month</p>
</dd>
<dt><code>mm</code></dt><dd><p>amount of precipitation (mm)</p>
</dd>
<dt><code>SO4</code></dt><dd><p>sulphate concentration (mg/L)</p>
</dd>
<dt><code>NO3</code></dt><dd><p>nitate concentration (mg N/L)</p>
</dd>
</dl>



<h3>Details</h3>

<p>SO4 shows a highly significant decreasing trend, 
NO3 shows a moderately significant decreasing trend
and mm no significant trend
</p>


<h3>Source</h3>

<p>Marchetto A., Rogora M. &amp; Arisci S. 2013 Trend analysis of atmospheric deposition data: a comparison of statistical approaches. Atmospheric Environment <b>64</b>, 95-102<br /> <br />
Rogora M., Mosello R., Arisci S., Brizzio M., Barbieri A., Balestrini R., Waldner P., Schmitt M., Stahli M.,Thimonier A., Kalina M., Puxbaum H., Nickus U., Ulrich E., Probst A. 2006 An overview of atmospheric deposition chemistry over the Alps: Present status and long-term trends. Hydrobiologia <b>562</b>, 17&ndash;40
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pie1)
rkt(pie1$Year,pie1$SO4,pie1$Month,pie1$mm,TRUE)
</code></pre>

<hr>
<h2 id='pie1w'>
Example data for rkt function
</h2><span id='topic+pie1w'></span>

<h3>Description</h3>

<p>Bulk open field deposition collected in Val Sessera (Italy) in 1998-2007. Raw  weekly data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pie1)</code></pre>


<h3>Format</h3>

<p>A data frame with 718 observations on the following 4 variables.
</p>

<dl>
<dt><code>Date</code></dt><dd><p>sampling date (year+decimals)</p>
</dd>
<dt><code>mm</code></dt><dd><p>amount of precipitation (mm)</p>
</dd>
<dt><code>SO4</code></dt><dd><p>sulphate concentration (mg/L)</p>
</dd>
<dt><code>NO3</code></dt><dd><p>nitate concentration (mg N/L)</p>
</dd>
</dl>



<h3>Details</h3>

<p>SO4 shows a decreasing trend
NO3 and mm show no significant trend
</p>


<h3>Source</h3>

<p>Marchetto A., Rogora M. &amp; Arisci S. 2013 Trend analysis of atmospheric deposition data: a comparison of statistical approaches. Atmospheric Environment <b>64</b>, 95-102<br /> <br />
Rogora M., Mosello R., Arisci S., Brizzio M., Barbieri A., Balestrini R., Waldner P., Schmitt M., Stahli M.,Thimonier A., Kalina M., Puxbaum H., Nickus U., Ulrich E., Probst A. 2006 An overview of atmospheric deposition chemistry over the Alps: Present status and long-term trends. Hydrobiologia <b>562</b>, 17&ndash;40
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pie1w)
rkt(pie1w$Date,pie1w$SO4)
</code></pre>

<hr>
<h2 id='print.rkt'>
print Method for class rkt
</h2><span id='topic+print.rkt'></span>

<h3>Description</h3>

<p>The results of the test(s) and the slope are printed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rkt'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rkt_+3A_x">x</code></td>
<td>

<p>an object of class rkt, i.e. the output of the rkt function
</p>
</td></tr>
<tr><td><code id="print.rkt_+3A_...">...</code></td>
<td>

<p>any additional argument
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL
</p>


<h3>Author(s)</h3>

<p>Aldo Marchetto &lt;aldo.marchetto@cnr.it&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pie1)

ex&lt;-rkt(pie1$Year,pie1$SO4,pie1$Month,pie1$mm,TRUE)
print(ex)
</code></pre>

<hr>
<h2 id='rkt'>
Mann Kendall test and Seasonal and Regional Kendall tests (SKT/RKT)
</h2><span id='topic+rkt'></span>

<h3>Description</h3>

<p>Computes the Mann-Kendall test (MK) and the Seasonal and the Regional Kendall Tests for trend (SKT and RKT) and  Theil-Sen's slope estimator.<br />
When a covariable is defined, this function also computes partial RKT and SKT.<br />
To allow for non-regular sampling dates, input data should be vectors, not time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rkt(date, y, block, cv, correct = F, rep = "e")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rkt_+3A_date">date</code></td>
<td>

<p>a mandatory vector of numerical data representing dates, as years or years+decimal. If correction for intra-block correlation is required, dates will be truncated to the year, and no more than one value per block per year will be considered. If two equal dates (or truncated dates) are found, the behaviour of the program is determined by rep
</p>
</td></tr>
<tr><td><code id="rkt_+3A_y">y</code></td>
<td>

<p>a mandatory vector of measured data. In this vector, missing data are allowed.
</p>
</td></tr>
<tr><td><code id="rkt_+3A_block">block</code></td>
<td>

<p>an optional vector of positive integer numbers representing blocks, i.e. sites, seasons or months, or a code combining both sites and seasons/months. If no blocks are defined, the result will be the Mann-Kendall test.
</p>
</td></tr>
<tr><td><code id="rkt_+3A_cv">cv</code></td>
<td>

<p>an optional vector containing a covariable, such as river flow or deposition amount. In this vector, missing data are allowed
</p>
</td></tr>
<tr><td><code id="rkt_+3A_correct">correct</code></td>
<td>

<p>a boolean value. If correct is FALSE, no correction for correlation between blocks is performed. If correct is TRUE, dates are truncated and the correction for correlation between blocks is performed. Note that the truncation is performed in any case, while the correction is performed only if there are more than one block, and more than nine years of data. Default value is FALSE.	
</p>
</td></tr>
<tr><td><code id="rkt_+3A_rep">rep</code></td>
<td>

<p>a character value. If rep is set to &quot;a&quot;, data sharing the same date (or truncated date if correct is TRUE) are averaged. If rep is set to &quot;m&quot;, their median is used. For any other value of rep, an error is produced if two or more data share the same date (or truncated date if correct is TRUE). The latter is the default behaviour of the program.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The MK test for trend analysis was first proposed by Mann (1945).<br />
Hirsch et al. (1982) derived SKT for trend analysis of monthly data in a single site using seasons as the blocking variable, and Helsel and Franse (2006) extended it to a regional test using sites as the blocking variable (RKT).<br />
The correction for correlation among blocks was introduced by Hirsch &amp; Slack (1984), and the partial test was proposed by Libiseller &amp; Grimvall (2002).<br />
At least 4 data are required for each block.<br />
Correction for correlation between blocks is not performed if less than 10 years of data are available.<br />
If correct is FALSE, data are not required to be sampled monthly or yearly.<br />
</p>


<h3>Value</h3>

<p>A list with class rkt is returned with the following components: 
</p>
<table>
<tr><td><code>sl</code></td>
<td>
<p>two sided p-value 
</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Kendall's score
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Theil-Sen's slope for MK, Seasonal (or Regional) Kendall Slope estimator for SKT and RKT
</p>
</td></tr>
<tr><td><code>varS</code></td>
<td>
<p>variance of S
</p>
</td></tr>
<tr><td><code>sl.corrected</code></td>
<td>
<p>two sided p-value, after correction for intra-block correlation
</p>
</td></tr>
<tr><td><code>varS.corrected</code></td>
<td>
<p>variance of S, after correction for intra-block correlation
</p>
</td></tr>
<tr><td><code>partial.S</code></td>
<td>
<p>partial Kendall's score, if a covariable is present
</p>
</td></tr>
<tr><td><code>partial.sl</code></td>
<td>
<p>two sided p-value of the partial test, if a covariable is present
</p>
</td></tr>
<tr><td><code>partial.varS</code></td>
<td>
<p>partial variance of S, if a covariable is present
</p>
</td></tr>
<tr><td><code>partial.sl.corrected</code></td>
<td>
<p>two sided p-value of the partial test, after correction for intra-block correlation, if a covariable is present
</p>
</td></tr>
<tr><td><code>partial.varS.corrected</code></td>
<td>
<p>partial variance of S, after correction for intra-block correlation, if a covariable is present
</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Kendall tau 
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>All items are returned in any case. When a test is not performed, relative items are set to NA.<br />
To consider data sharing the same dates as ties in the time domain, please use Kendall function in the Kendall package.<br />
For time series with multiple detection limits, please refer to the NADA package.
</p>


<h3>Author(s)</h3>

<p>Aldo Marchetto &lt;aldo.marchetto@cnr.it&gt;
</p>


<h3>References</h3>

<p>Helsel D.R., Frans L.M. 2006 The regional Kendall test for trend: Environmental Science and Technology <b>40</b>, 4066&ndash;4073<br /><br />
Helsel D.R., Mueller D.K., Slack J.R. 2006 <em>Computer program for the Kendall family of trend tests</em> U.S. Geological Survey Scientific Investigations Report 2005-5275, 4 pp.<br /><br />
Hirsch R.M., Slack J.R., Smith R.A. Techniques of trend ananlyis for monthly water quality data. Water Resources Research <b>18</b>, 107-121<br /><br />
Hirsch R.M., Slack J.R. 1984 A nonparametric test for seasonal data with serial dependance. Water Resources Research <b>20</b>, 727-732<br /><br />
Libiseller C., Grimvall A. 2002 Perfomance of partial Mann-Kendall tests for trend detection in the presence of covariates. Environmetrics <b>13</b>, 71-84<br /><br />
Mann H.B. 1945. Nonparametric tests against trend. Econometrica <b>13</b>, 245-249
Marchetto A., Rogora M., Arisci S. 2013 Trend analysis of atmospheric deposition data: a comparison of statistical approaches. Atmospheric Environment <b>64</b>, 95&ndash;102<br /><br />
</p>


<h3>See Also</h3>

<p>print.rkt
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# monthly data
#
data(pie1)
ex&lt;-rkt(pie1$Year,pie1$SO4,pie1$Month,pie1$mm,TRUE)
print(ex)
#
# weekly data, no intrablock correction
#

data(pie1w)
ex&lt;-rkt(pie1w$Date,pie1w$SO4)
print(ex)
#
# monthly data, hydrological years (oct-sep) as in USGS program
#
data(pie1)
ex&lt;-rkt(pie1$Year+floor(pie1$Month/10),pie1$SO4,pie1$Month,,TRUE)
print(ex)
</code></pre>

<hr>
<h2 id='rkt-package'>
Mann-Kendall Test, Seasonal and Regional Kendall Tests
</h2><span id='topic+rkt-package'></span>

<h3>Description</h3>

<p>Contains function rkt which computes the Mann-Kendall test (MK) and the Seasonal and the Regional Kendall Tests for trend (SKT and RKT) and  Theil-Sen's slope estimator. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> rkt</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.7</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-02-07</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This function computes the Mann-Kendall test (MK) and the Seasonal and the Regional Kendall Tests for trend (SKT and RKT) and  Sen's slope estimator.<br />
MK, SKT and RKT are tests for monotonic trend in time series based on the Kendall rank correlation.<br />
SKT and RKT are intrablock tests in which test statistics are computed for each season or month (SKT) or for each site (RKT) and combined in an overall test.<br />
In RKT, seasonality can be accounted for by using a blocking variable combining both sites and seasons, such as (site * 12 + month).<br />
When a covariable is defined, this function also computes partial RKT and SKT. <br />
To allow for non-regular sampling dates, input data should be vectors, not time series.
</p>


<h3>Author(s)</h3>

<p>Maintainer: Aldo Marchetto &lt;aldo.marchetto@cnr.it&gt;
</p>


<h3>References</h3>

<p>Marchetto A., Rogora M., Arisci S. 2013 Trend analysis of atmospheric deposition data: a comparison of statistical approaches. Atmospheric Environment <b>64</b>, 95&ndash;102<br /><br />
Helsel D.R., Frans L.M. 2006 The regional Kendall test for trend: Environmental Science and Technology <b>40</b>, 4066&ndash;4073<br /><br />
Helsel D.R., Mueller D.K., Slack J.R. 2006 <em>Computer program for the Kendall family of trend tests</em> U.S. Geological Survey Scientific Investigations Report 2005-5275, 4 pp.<br /><br />
Hirsch R.M., Slack J.R., Smith R.A. Techniques of trend ananlyis for monthly water quality data. Water Resources Research <b>18</b>, 107-121<br /><br />
Hirsch R.M., Slack J.R. 1984 A nonparametric test for seasonal data with serial dependance. Water Resources Research <b>20</b>, 727-732<br /><br />
Libiseller C., Grimvall A. 2002 Perfomance of partial Mann-Kendall tests for trend detection in the presence of covariates. Environmetrics <b>13</b>, 71-84<br /><br />
Mann H.B. 1945. Nonparametric tests against trend. Econometrica <b>13</b>, 245-249
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
# monthly data, using covariate and intra-block correction
#
data(pie1)
ex&lt;-rkt(pie1$Year,pie1$SO4,pie1$Month,pie1$mm,TRUE)
print(ex)
#
# weekly data, no intrablock correction
#
data(pie1w)
ex&lt;-rkt(pie1w$Date,pie1w$SO4)
print(ex)
#
# monthly data, hydrological years (oct-sep) as in USGS program
#
data(pie1)
ex&lt;-rkt(pie1$Year+floor(pie1$Month/10),pie1$SO4,pie1$Month,,TRUE)
print(ex)
#
</code></pre>

<hr>
<h2 id='sign1'>
modified sign() fucntion for SKT taking into account missing data
</h2><span id='topic+sign1'></span>

<h3>Description</h3>

<p>differ from sign as it return 0 when x is NA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sign1(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sign1_+3A_x">x</code></td>
<td>

<p>any number
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>1 if x &gt; 0
-1 if x &lt; 0
0 if x = 0 or x = NA
</p>


<h3>Note</h3>

<p>used by rkt
</p>


<h3>Author(s)</h3>

<p>Aldo Marchetto
</p>


<h3>References</h3>

<p>Hirsch R.M. &amp; Slack J.R. 1984. A nonparametric test for seasonal data with serial dependance. Water Resources Research, 20: 727-732</p>


<h3>See Also</h3>

<p>rkt
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a&lt;-1
sign1(a)
a&lt;-NA
sign1(a)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
