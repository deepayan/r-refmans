<!DOCTYPE html><html lang="en"><head><title>Help for package fkbma</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fkbma}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.rjMCMC'><p>Extract Posterior Mean Coefficients from rjMCMC Results</p></a></li>
<li><a href='#credint'><p>Credible Intervals for rjMCMC Results</p></a></li>
<li><a href='#fitted.rjMCMC'><p>Fitted values from Reversible Jump MCMC (rjMCMC) Model Results</p></a></li>
<li><a href='#fittedExposureEff'><p>Fitted exposure effect values from Reversible Jump MCMC (rjMCMC) Model Results</p></a></li>
<li><a href='#getEffectiveSubspace'><p>Get Effective Subspace</p></a></li>
<li><a href='#pip'><p>Compute Posterior Inclusion Probabilities (PIPs) for rjMCMC Results</p></a></li>
<li><a href='#plot.rjMCMC'><p>Plotting function for <code>rjMCMC</code> results</p></a></li>
<li><a href='#plotHistTrace'><p>Generate Histogram and Trace Plots for MCMC Samples</p></a></li>
<li><a href='#predict.rjMCMC'><p>Predict from Reversible Jump MCMC (rjMCMC) Model Results</p></a></li>
<li><a href='#predictExposureEff'><p>Predict Exposure Effect</p></a></li>
<li><a href='#print.rjMCMC'><p>Print a summary of results from from Reversible Jump MCMC (rjMCMC)</p></a></li>
<li><a href='#rhats'><p>Calculate and Print Rhat Diagnostics for rjMCMC Results</p></a></li>
<li><a href='#rjMCMC'><p>Run Reversible Jump MCMC (rjMCMC) Procedure</p></a></li>
<li><a href='#simulated_data'><p>A synthetic dataset with continuous and binary covariates and a binary treatment variable (<code>trt</code>).</p></a></li>
<li><a href='#summary.rjMCMC'><p>Summarize Results from Reversible Jump MCMC (rjMCMC)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Free Knot-Bayesian Model Averaging</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lara Maleyeff &lt;lara.maleyeff@mcgill.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of Bayesian adaptive enrichment clinical trial using Free-Knot Bayesian Model Averaging (FK-BMA) method of Maleyeff et al. (2024) for Gaussian data. Maleyeff, L., Golchi, S., Moodie, E. E. M., &amp; Hudson, M. (2024) "An adaptive enrichment design using Bayesian model averaging for selection and threshold-identification of predictive variables" &lt;<a href="https://doi.org/10.1093%2Fbiomtc%2Fujae141">doi:10.1093/biomtc/ujae141</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>rstan, matrixStats, splines, dplyr, coda, MASS, ggplot2,
cowplot, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-05 19:35:56 UTC; laramaleyeff</td>
</tr>
<tr>
<td>Author:</td>
<td>Lara Maleyeff [aut, cre],
  Shirin Golchi [aut],
  Erica E. M. Moodie [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-06 03:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.rjMCMC'>Extract Posterior Mean Coefficients from rjMCMC Results</h2><span id='topic+coef.rjMCMC'></span>

<h3>Description</h3>

<p>This function extracts the posterior means of the intercept, exposure parameters,
and binary parameters from the results of an rjMCMC model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rjMCMC'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.rjMCMC_+3A_object">object</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, which includes:
</p>

<dl>
<dt>fixed_param</dt><dd><p>Matrix of posterior samples for exposure intercept and main effect.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix of posterior samples for binary variable parameters.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for candidate variables.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices containing fitted values for spline terms across iterations.</p>
</dd>
<dt>data_fit</dt><dd><p>Original dataset used in the <code>rjMCMC</code> procedure.</p>
</dd>
<dt>candsplineinter</dt><dd><p>Names of continuous candidate predictive spline variables.</p>
</dd>
<dt>candsplinevars</dt><dd><p>Names of continuous candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>Names of binary candidate variables.</p>
</dd>
<dt>candinter</dt><dd><p>Names of interaction terms, which can include spline variables.</p>
</dd>
<dt>mcmc_specs</dt><dd><p>MCMC sampler specifications, including the number of iterations, burn-in, thinning, and chains.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="coef.rjMCMC_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to other methods or functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the posterior mean of the intercept, exposure, and binary parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)


results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")
coef(results)

</code></pre>

<hr>
<h2 id='credint'>Credible Intervals for rjMCMC Results</h2><span id='topic+credint'></span>

<h3>Description</h3>

<p>This function calculates the posterior mean and credible intervals for parameters
from the rjMCMC results, including both intercept/exposure parameters and binary parameters.
The credible intervals are computed based on the specified confidence level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>credint(results, level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="credint_+3A_results">results</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, including posterior samples.</p>
</td></tr>
<tr><td><code id="credint_+3A_level">level</code></td>
<td>
<p>The level for the credible intervals (default is 0.95).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with estimates, lower, and upper bounds of the credible intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)


results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")
credint(results)

</code></pre>

<hr>
<h2 id='fitted.rjMCMC'>Fitted values from Reversible Jump MCMC (rjMCMC) Model Results</h2><span id='topic+fitted.rjMCMC'></span>

<h3>Description</h3>

<p>This function generates posterior fitted values from an rjMCMC model based on the provided data.
It combines the fixed effects, spline terms, and binary parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rjMCMC'
fitted(object, newdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.rjMCMC_+3A_object">object</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, which includes:
</p>

<dl>
<dt>fixed_param</dt><dd><p>Matrix of posterior samples for exposure intercept and main effect.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix of posterior samples for binary variable parameters.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for candidate variables.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices containing fitted values for spline terms across iterations.</p>
</dd>
<dt>data_fit</dt><dd><p>Original dataset used in the <code>rjMCMC</code> procedure.</p>
</dd>
<dt>candsplineinter</dt><dd><p>Names of continuous candidate predictive spline variables.</p>
</dd>
<dt>candsplinevars</dt><dd><p>Names of continuous candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>Names of binary candidate variables.</p>
</dd>
<dt>candinter</dt><dd><p>Names of interaction terms, which can include spline variables.</p>
</dd>
<dt>mcmc_specs</dt><dd><p>MCMC sampler specifications, including the number of iterations, burn-in, thinning, and chains.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="fitted.rjMCMC_+3A_newdata">newdata</code></td>
<td>
<p>A data frame for which fitted values are to be computed. If NA, the original fitted data is used.</p>
</td></tr>
<tr><td><code id="fitted.rjMCMC_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to other methods or functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of fitted values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)

results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
           outcome = "Y", factor_var = "trt")

newdata = data.frame(Z_1 = 1, Z_2 = 1, Z_3 = 1, Z_4 = 1, Z_5 = 1,
                   trt = 1, X_1 = seq(0,1,by=0.01))
fitted(results)
fitted(results,newdata)

</code></pre>

<hr>
<h2 id='fittedExposureEff'>Fitted exposure effect values from Reversible Jump MCMC (rjMCMC) Model Results</h2><span id='topic+fittedExposureEff'></span>

<h3>Description</h3>

<p>This function generates posterior fitted exposure effects from an rjMCMC model based on the provided data.
It combines the fixed effects, spline terms, and binary parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fittedExposureEff(results, newdata = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fittedExposureEff_+3A_results">results</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, which includes:
</p>

<dl>
<dt>fixed_param</dt><dd><p>Matrix of posterior samples for exposure intercept and main effect.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix of posterior samples for binary variable parameters.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for candidate variables.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices containing fitted values for spline terms across iterations.</p>
</dd>
<dt>data_fit</dt><dd><p>Original dataset used in the <code>rjMCMC</code> procedure.</p>
</dd>
<dt>candsplineinter</dt><dd><p>Names of continuous candidate predictive spline variables.</p>
</dd>
<dt>candsplinevars</dt><dd><p>Names of continuous candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>Names of binary candidate variables.</p>
</dd>
<dt>candinter</dt><dd><p>Names of interaction terms, which can include spline variables.</p>
</dd>
<dt>mcmc_specs</dt><dd><p>MCMC sampler specifications, including the number of iterations, burn-in, thinning, and chains.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="fittedExposureEff_+3A_newdata">newdata</code></td>
<td>
<p>A data frame for which fitted values are to be computed. If NA, the original fitted data is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of fitted values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)
results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")
newdata = data.frame(Z_1 = 1, Z_2 = 1, Z_3 = 1, Z_4 = 1, Z_5 = 1,
                   trt = 1, X_1 = seq(0,1,by=0.01))
fittedExposureEff(results)
fittedExposureEff(results,newdata)

</code></pre>

<hr>
<h2 id='getEffectiveSubspace'>Get Effective Subspace</h2><span id='topic+getEffectiveSubspace'></span>

<h3>Description</h3>

<p>This function identifies the &quot;effective subspace&quot; where exposure is effective
based on posterior inference results from the FK-BMA model. It analyzes interaction terms
between exposure and covariates, allowing for both binary and continuous variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEffectiveSubspace(results, newdata = NULL, alpha = 0.05, pip_cutoff = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getEffectiveSubspace_+3A_results">results</code></td>
<td>
<p>A fitted model object from <code>rjMCMC</code>.</p>
</td></tr>
<tr><td><code id="getEffectiveSubspace_+3A_newdata">newdata</code></td>
<td>
<p>Optional. A new dataset for evaluating the effective subspace.
If <code>NULL</code>, the function uses <code>results$data_fit</code>.</p>
</td></tr>
<tr><td><code id="getEffectiveSubspace_+3A_alpha">alpha</code></td>
<td>
<p>Numeric. The alpha level used for computing quantiles. Default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="getEffectiveSubspace_+3A_pip_cutoff">pip_cutoff</code></td>
<td>
<p>Numeric. The minimum Posterior Inclusion Probability (PIP)
threshold for selecting covariates. Default is <code>0.1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The function computes the posterior exposure effect for each observation in the
dataset using the <code>fittedExposureEff</code> function and evaluates its quantiles at the
specified <code>alpha</code> level.
</p>
</li>
<li><p> Binary variables with high posterior inclusion probabilities (PIP) are used to define
subgroups, and the corresponding effective subspaces for a continuous variable
are identified by checking where the exposure effect quantiles are strictly positive.
</p>
</li>
<li><p> If the number of binary variables is <code>&lt;= 3</code> and there is exactly one continuous variable,
the function describes the effective subspace in terms of disjoint intervals.
</p>
</li>
<li><p> For more complex cases, a warning is issued suggesting alternative methods such as
Bayesian regression trees for interpretation.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following components:
</p>
<table role = "presentation">
<tr><td><code>quantiles</code></td>
<td>
<p>A vector of quantile values for the exposure effect in the new dataset.</p>
</td></tr>
<tr><td><code>is_effective_subspace</code></td>
<td>
<p>A logical vector indicating whether the exposure effect is
positive in the effective subspace.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)

results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")
getEffectiveSubspace(results)

</code></pre>

<hr>
<h2 id='pip'>Compute Posterior Inclusion Probabilities (PIPs) for rjMCMC Results</h2><span id='topic+pip'></span>

<h3>Description</h3>

<p>This function returns the posterior inclusion probabilities (PIPs) for all variables,
including the intercept and exposure, based on the results from an rjMCMC model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pip(results)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pip_+3A_results">results</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, which includes:
</p>

<dl>
<dt>fixed_param</dt><dd><p>Matrix of posterior samples for exposure intercept and main effect.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix of posterior samples for binary variable parameters.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for candidate variables.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices containing fitted values for spline terms across iterations.</p>
</dd>
<dt>data_fit</dt><dd><p>Original dataset used in the <code>rjMCMC</code> procedure.</p>
</dd>
<dt>candsplineinter</dt><dd><p>Names of continuous candidate predictive spline variables.</p>
</dd>
<dt>candsplinevars</dt><dd><p>Names of continuous candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>Names of binary candidate variables.</p>
</dd>
<dt>candinter</dt><dd><p>Names of interaction terms, which can include spline variables.</p>
</dd>
<dt>mcmc_specs</dt><dd><p>MCMC sampler specifications, including the number of iterations, burn-in, thinning, and chains.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with the PIPs for the intercept, exposure, and other variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)

results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")
pip(results)

</code></pre>

<hr>
<h2 id='plot.rjMCMC'>Plotting function for <code>rjMCMC</code> results</h2><span id='topic+plot.rjMCMC'></span>

<h3>Description</h3>

<p>This function generates plots for model results from <code>rjMCMC</code> based on specified sample type, effect type, and plot type.
The function is flexible for various combinations of <code>sample_type</code>, <code>effect_type</code>, and <code>plot_type</code>, as outlined below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rjMCMC'
plot(
  x,
  ...,
  variables = NULL,
  sample_type = "fitted",
  effect_type = "exposure_effect",
  plot_type = "cred",
  level = 0.95,
  aux_vars = list(),
  facet_by = NULL,
  pip_cutoff = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.rjMCMC_+3A_x">x</code></td>
<td>
<p>A fitted model object from <code>rjMCMC</code>.</p>
</td></tr>
<tr><td><code id="plot.rjMCMC_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to other methods or functions.</p>
</td></tr>
<tr><td><code id="plot.rjMCMC_+3A_variables">variables</code></td>
<td>
<p>A vector of variable names to include in the plot. Automatically set to continuous variables if <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.rjMCMC_+3A_sample_type">sample_type</code></td>
<td>
<p>Character string specifying the type of sample: &quot;fitted&quot;, &quot;predictive&quot;, or &quot;estimand&quot;.
&quot;fitted&quot; and &quot;predictive&quot; are compatible with <code>plot_type = "cred"</code>.
&quot;estimand&quot; is compatible with <code>plot_type = "hist"</code> or &quot;trace&quot; (only used for individual parameter trajectories).</p>
</td></tr>
<tr><td><code id="plot.rjMCMC_+3A_effect_type">effect_type</code></td>
<td>
<p>Character string indicating the effect type: &quot;exposure_effect&quot; or &quot;outcome&quot;.
For &quot;exposure_effect&quot;, the function plots the fitted or predictive effect of exposure; for &quot;outcome&quot;, it plots
outcome values without interaction with exposure.</p>
</td></tr>
<tr><td><code id="plot.rjMCMC_+3A_plot_type">plot_type</code></td>
<td>
<p>Character string specifying the plot type: &quot;cred&quot; for credible interval plots, or &quot;hist&quot;/&quot;trace&quot; for histogram or trace plots
of individual parameters (only for <code>sample_type = "estimand"</code>).</p>
</td></tr>
<tr><td><code id="plot.rjMCMC_+3A_level">level</code></td>
<td>
<p>Numeric value for the credible interval level (default is 0.95).</p>
</td></tr>
<tr><td><code id="plot.rjMCMC_+3A_aux_vars">aux_vars</code></td>
<td>
<p>A list of auxiliary variables and their fixed values. Each element name must match a model variable.</p>
</td></tr>
<tr><td><code id="plot.rjMCMC_+3A_facet_by">facet_by</code></td>
<td>
<p>A vector of variable names to facet by in the plot. Automatically set to binary model variables if <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.rjMCMC_+3A_pip_cutoff">pip_cutoff</code></td>
<td>
<p>Numeric threshold for the posterior inclusion probability (PIP) of model variables to include in the plot.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong>Sample and Plot Compatibility</strong>:
</p>

<ul>
<li><p> For <code>sample_type = "estimand"</code>, only <code>plot_type = "hist"</code> or &quot;trace&quot; is allowed, as these are designed to visualize the posterior distribution
or MCMC trajectory of individual parameters. Parameters like <code>intercept</code>, <code>trt</code>, and <code>sigma</code> are agnostic to <code>effect_type</code> as they
do not interact with exposure.
</p>
</li>
<li> <p><code>plot_type = "cred"</code> is designed for use with <code>sample_type = "fitted"</code> or &quot;predictive&quot; and shows credible intervals for the outcome (y-axis)
across biomarker values (x-axis) by covariate pattern. <code>effect_type</code> controls whether the exposure effect or main effect is displayed.
</p>
</li></ul>

</li>
<li> <p><strong>Effect Types</strong>:
</p>

<ul>
<li> <p><code>outcome</code> plots either the fitted or predictive values without exposure interaction, allowing for exposure (<code>trt</code>) values to be specified.
</p>
</li>
<li> <p><code>exposure_effect</code> plots the interaction of the exposure effect across different covariate patterns.
</p>
</li></ul>

</li></ul>



<h3>Value</h3>

<p>A <code>ggplot2</code> object or a grid of plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)

results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")
plot(results, sample_type = "fitted", effect_type = "exposure_effect", plot_type = "cred")
plot(results, sample_type = "estimand", plot_type = "hist")

</code></pre>

<hr>
<h2 id='plotHistTrace'>Generate Histogram and Trace Plots for MCMC Samples</h2><span id='topic+plotHistTrace'></span>

<h3>Description</h3>

<p>This internal function creates histogram or trace plots for MCMC samples from an <code>rjMCMC</code> model,
displaying the posterior distributions or sampling trajectories of specified variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotHistTrace(
  results,
  variables = NULL,
  sample_type = "fitted",
  effect_type = "exposure_effect",
  plot_type = "cred",
  aux_vars = list(),
  facet_by = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotHistTrace_+3A_results">results</code></td>
<td>
<p>A fitted model object from <code>rjMCMC</code>.</p>
</td></tr>
<tr><td><code id="plotHistTrace_+3A_variables">variables</code></td>
<td>
<p>A vector of variable names to include in the plot, representing the estimand or covariates of interest.</p>
</td></tr>
<tr><td><code id="plotHistTrace_+3A_sample_type">sample_type</code></td>
<td>
<p>Character string specifying the sample type: <code>"estimand"</code>, <code>"fitted"</code>, or <code>"predictive"</code>.
When set to <code>"estimand"</code>, the function plots individual parameters from the posterior.
For <code>"fitted"</code> or <code>"predictive"</code>, it uses posterior samples for one individualâ€™s
fitted or predictive values.</p>
</td></tr>
<tr><td><code id="plotHistTrace_+3A_plot_type">plot_type</code></td>
<td>
<p>Character string specifying the plot type: <code>"hist"</code> for histogram or <code>"trace"</code> for trace plots.
<code>"hist"</code> shows the distribution of parameter values, while <code>"trace"</code> displays MCMC sampling trajectories.</p>
</td></tr>
<tr><td><code id="plotHistTrace_+3A_aux_vars">aux_vars</code></td>
<td>
<p>A list of auxiliary variables and their values. Used to generate data for <code>fitted</code> or <code>predictive</code> values.
Each element name should correspond to a model variable.</p>
</td></tr>
<tr><td><code id="plotHistTrace_+3A_facet_by">facet_by</code></td>
<td>
<p>A vector of variable names to facet by in the plot. Automatically set to binary model variables if <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong>Sample and Plot Compatibility</strong>:
</p>

<ul>
<li><p> For <code>sample_type = "estimand"</code>, only <code>plot_type = "hist"</code> or &quot;trace&quot; is compatible, as it represents the posterior
distribution or MCMC trajectory of individual parameters.
</p>
</li>
<li><p> For <code>sample_type = "fitted"</code> or <code>"predictive"</code>, this function plots either the main effect
(no interaction with exposure) or exposure effect for an individual using auxiliary variable values.
</p>
</li></ul>

</li>
<li> <p><strong>Effect Types</strong>:
</p>

<ul>
<li><p> For <code>sample_type = "fitted"</code> or <code>"predictive"</code>, <code>"outcome"</code> generates plots without exposure interaction,
and <code>"exposure_effect"</code> plots the interaction effect with exposure.
</p>
</li></ul>

</li></ul>



<h3>Value</h3>

<p>A <code>ggplot2</code> object displaying histograms or trace plots of the MCMC samples.
</p>


<h3>Note</h3>

<p>This is an internal function not intended for direct use by package users.
</p>

<hr>
<h2 id='predict.rjMCMC'>Predict from Reversible Jump MCMC (rjMCMC) Model Results</h2><span id='topic+predict.rjMCMC'></span>

<h3>Description</h3>

<p>This function generates posterior predictions from an rjMCMC model based on the provided data.
It combines the fixed effects, spline terms, and binary parameters, and includes residual variance
in the predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rjMCMC'
predict(object, newdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.rjMCMC_+3A_object">object</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, which includes:
</p>

<dl>
<dt>fixed_param</dt><dd><p>Matrix of posterior samples for exposure intercept and main effect.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix of posterior samples for binary variable parameters.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for candidate variables.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices containing fitted values for spline terms across iterations.</p>
</dd>
<dt>data_fit</dt><dd><p>Original dataset used in the <code>rjMCMC</code> procedure.</p>
</dd>
<dt>candsplineinter</dt><dd><p>Names of continuous candidate predictive spline variables.</p>
</dd>
<dt>candsplinevars</dt><dd><p>Names of continuous candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>Names of binary candidate variables.</p>
</dd>
<dt>candinter</dt><dd><p>Names of interaction terms, which can include spline variables.</p>
</dd>
<dt>mcmc_specs</dt><dd><p>MCMC sampler specifications, including the number of iterations, burn-in, thinning, and chains.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="predict.rjMCMC_+3A_newdata">newdata</code></td>
<td>
<p>A data frame for which predictions are to be made. If NA, the original fitted data is used.</p>
</td></tr>
<tr><td><code id="predict.rjMCMC_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to other methods or functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of predicted values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)

results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
           outcome = "Y", factor_var = "trt")
predict(results)

</code></pre>

<hr>
<h2 id='predictExposureEff'>Predict Exposure Effect</h2><span id='topic+predictExposureEff'></span>

<h3>Description</h3>

<p>This function predicts the exposure effect for new data based the Reversible Jump MCMC (rjMCMC) results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictExposureEff(results, newdata = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predictExposureEff_+3A_results">results</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, which includes:
</p>

<dl>
<dt>fixed_param</dt><dd><p>Matrix of posterior samples for exposure intercept and main effect.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix of posterior samples for binary variable parameters.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for candidate variables.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices containing fitted values for spline terms across iterations.</p>
</dd>
<dt>data_fit</dt><dd><p>Original dataset used in the <code>rjMCMC</code> procedure.</p>
</dd>
<dt>candsplineinter</dt><dd><p>Names of continuous candidate predictive spline variables.</p>
</dd>
<dt>candsplinevars</dt><dd><p>Names of continuous candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>Names of binary candidate variables.</p>
</dd>
<dt>candinter</dt><dd><p>Names of interaction terms, which can include spline variables.</p>
</dd>
<dt>mcmc_specs</dt><dd><p>MCMC sampler specifications, including the number of iterations, burn-in, thinning, and chains.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="predictExposureEff_+3A_newdata">newdata</code></td>
<td>
<p>A data frame for which predicted values are to be computed If NA, the original fitted data is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function:
</p>

<ul>
<li><p> Checks if the required columns in <code>results$candinter</code> are present in <code>newdata</code>.
</p>
</li>
<li><p> Computes the fitted posterior exposure effect based on main exposure effects, spline interactions, and binary interactions.
</p>
</li>
<li><p> Adds noise to the fitted posterior using the residual variance <code>results$sigma_sq</code> to generate predictive posterior samples.
</p>
</li></ul>

<p>Spline interactions are handled by interpolating the spline coefficients for the values in <code>newdata</code>.
</p>


<h3>Value</h3>

<p>A matrix of predictive posterior samples for the exposure effect, where each row corresponds to a posterior sample
and each column corresponds to an observation in <code>newdata</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)

results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")
newdata = data.frame(Z_1 = 1, Z_2 = 1, Z_3 = 1, Z_4 = 1, Z_5 = 1,
                   trt = 1, X_1 = seq(0,1,by=0.01))
predictExposureEff(results)
predictExposureEff(results,newdata)

</code></pre>

<hr>
<h2 id='print.rjMCMC'>Print a summary of results from from Reversible Jump MCMC (rjMCMC)</h2><span id='topic+print.rjMCMC'></span>

<h3>Description</h3>

<p>This function provides a detailed summary of the results from the <code>rjMCMC</code> procedure, including
model information, parameter estimates, posterior inclusion probabilities, convergence diagnostics,
and plots for spline terms. The function also prints the model formula with <code>fbs()</code> notation for spline terms,
indicating the use of free-knot B-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rjMCMC'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.rjMCMC_+3A_x">x</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, which includes:
</p>

<dl>
<dt>fixed_param</dt><dd><p>Matrix of posterior samples for exposure intercept and main effect.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix of posterior samples for binary variable parameters.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for candidate variables.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices containing fitted values for spline terms across iterations.</p>
</dd>
<dt>data_fit</dt><dd><p>Original dataset used in the <code>rjMCMC</code> procedure.</p>
</dd>
<dt>candsplineinter</dt><dd><p>Names of continuous candidate predictive spline variables.</p>
</dd>
<dt>candsplinevars</dt><dd><p>Names of continuous candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>Names of binary candidate variables.</p>
</dd>
<dt>candinter</dt><dd><p>Names of interaction terms, which can include spline variables.</p>
</dd>
<dt>mcmc_specs</dt><dd><p>MCMC sampler specifications, including the number of iterations, burn-in, thinning, and chains.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="print.rjMCMC_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to other methods or functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces detailed summaries similar to those from <code>brms</code>, including
diagnostics, estimates, posterior inclusion probabilities, and spline effects. The spline terms
are wrapped in <code>fbs()</code> notation, indicating the use of free-knot B-splines in the model. If the sampler
did not converge, a warning is issued. The function also allows the user to view diagnostic plots for fitted
exposure effects.
</p>


<h3>Value</h3>

<p>Prints the following summary information:
</p>

<dl>
<dt>Model Formula</dt><dd><p>The model formula with spline terms wrapped in <code>fbs()</code>, indicating free-knot B-splines, and interaction terms appropriately formatted.</p>
</dd>
<dt>Convergence Diagnostics</dt><dd><p>Reports any convergence issues based on Geweke diagnostics.</p>
</dd>
<dt>MCMC Sampler Arguments</dt><dd><p>Displays MCMC sampler arguments, including the number of posterior samples, burn-in, thinning, and chains.</p>
</dd>
<dt>Parameter Estimates</dt><dd><p>Posterior mean, standard error, 95% credible intervals, effective sample size (ESS), Gelman-Rubin statistic (Rhat), and posterior inclusion probabilities (PIP) for binary parameters, exposure intercept, and exposure effect.</p>
</dd>
<dt>Gaussian Family Parameters</dt><dd><p>Posterior summary for the residual standard error (sigma).</p>
</dd>
<dt>Posterior Inclusion Probabilities for Splines</dt><dd><p>Prints the posterior inclusion probabilities for spline terms.</p>
</dd>
<dt>Plots for Fitted Exposure Effects</dt><dd><p>Plots the mean and 95% credible intervals for each spline term vs fitted exposure effects.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)


results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
           outcome = "Y", factor_var = "trt")
print(results)

</code></pre>

<hr>
<h2 id='rhats'>Calculate and Print Rhat Diagnostics for rjMCMC Results</h2><span id='topic+rhats'></span>

<h3>Description</h3>

<p>This function calculates the Rhat diagnostic for convergence based on the posterior samples
of individual exposure effects, intercept, and main exposure effect from an rjMCMC model.
It prints the median, minimum, and maximum Rhat values for the exposure effects, as well as
the Rhat for the intercept and exposure effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rhats(results)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rhats_+3A_results">results</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, which includes:
</p>

<dl>
<dt>fixed_param</dt><dd><p>Matrix of posterior samples for exposure intercept and main effect.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix of posterior samples for binary variable parameters.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for candidate variables.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices containing fitted values for spline terms across iterations.</p>
</dd>
<dt>data_fit</dt><dd><p>Original dataset used in the <code>rjMCMC</code> procedure.</p>
</dd>
<dt>candsplineinter</dt><dd><p>Names of continuous candidate predictive spline variables.</p>
</dd>
<dt>candsplinevars</dt><dd><p>Names of continuous candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>Names of binary candidate variables.</p>
</dd>
<dt>candinter</dt><dd><p>Names of interaction terms, which can include spline variables.</p>
</dd>
<dt>mcmc_specs</dt><dd><p>MCMC sampler specifications, including the number of iterations, burn-in, thinning, and chains.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates R-hat statistics to assess MCMC convergence for both exposure effects and model parameters.
Diagnostic plots are generated to visually inspect the chains across iterations.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<dl>
<dt>Rhat_trt_eff_posterior</dt><dd><p>Vector of R-hat values for each individual's exposure effect.</p>
</dd>
<dt>Rhat_inter</dt><dd><p>R-hat value for the intercept parameter.</p>
</dd>
<dt>Rhat_factor_var</dt><dd><p>R-hat value for the main effect of exposure.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)

results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")
rhats(results)

</code></pre>

<hr>
<h2 id='rjMCMC'>Run Reversible Jump MCMC (rjMCMC) Procedure</h2><span id='topic+rjMCMC'></span>

<h3>Description</h3>

<p>This function performs a Reversible Jump MCMC (rjMCMC) procedure to generate the posterior distribution,
using Bayesian model averaging and free-knot B-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rjMCMC(
  data,
  candsplinevars,
  candbinaryvars,
  candinter,
  outcome,
  factor_var,
  mcmc_specs = NULL,
  prior_params = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rjMCMC_+3A_data">data</code></td>
<td>
<p>A data frame containing the observations, including the following columns:
</p>

<dl>
<dt>factor_var</dt><dd><p>Exposure group binary indicator.</p>
</dd>
<dt>outcome</dt><dd><p>Continuous-valued outcome.</p>
</dd>
<dt>candsplinevars</dt><dd><p>All candidate spline variables as described in <code>candsplinevars</code>.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>All candidate binary variables as described in <code>candbinaryvars</code>.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="rjMCMC_+3A_candsplinevars">candsplinevars</code></td>
<td>
<p>A vector of names for continuous predictive candidate variables (default = NULL).</p>
</td></tr>
<tr><td><code id="rjMCMC_+3A_candbinaryvars">candbinaryvars</code></td>
<td>
<p>A vector of names for binary predictive candidate variables (default = NULL).</p>
</td></tr>
<tr><td><code id="rjMCMC_+3A_candinter">candinter</code></td>
<td>
<p>A vector indicating which of the candidate variables are tailoring (default = NULL).</p>
</td></tr>
<tr><td><code id="rjMCMC_+3A_outcome">outcome</code></td>
<td>
<p>A string indicating the name of the continuous outcome variable in data.</p>
</td></tr>
<tr><td><code id="rjMCMC_+3A_factor_var">factor_var</code></td>
<td>
<p>A string indicating the name of the binary exposure variable in data.</p>
</td></tr>
<tr><td><code id="rjMCMC_+3A_mcmc_specs">mcmc_specs</code></td>
<td>
<p>A list containing:
</p>

<dl>
<dt>iter</dt><dd><p>Number of total iterations per chain (including warmup; default = 4000).</p>
</dd>
<dt>warmup</dt><dd><p>Number of warmup/burn-in samples per chain (default = 2000).</p>
</dd>
<dt>thin</dt><dd><p>Thinning parameter (default = 1).</p>
</dd>
<dt>chain</dt><dd><p>Number of chains (default = 4).</p>
</dd>
<dt>sigma_v</dt><dd><p>Proposal variance for &quot;jump&quot; terms (default = 0.1).</p>
</dd>
<dt>bma</dt><dd><p>Boolean indicating whether to include Bayesian model averaging step (default = TRUE).</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="rjMCMC_+3A_prior_params">prior_params</code></td>
<td>
<p>A list containing prior parameters:
</p>

<dl>
<dt>lambda_1</dt><dd><p>Prior parameter for the number of terms in the model (default = 0.1).</p>
</dd>
<dt>lambda_2</dt><dd><p>Prior parameter for the number of knots in each spline (default = 1).</p>
</dd>
<dt>a_0</dt><dd><p>Shape parameter for inverse gamma prior on individual-level variance (default = 0.01).</p>
</dd>
<dt>b_0</dt><dd><p>Rate parameter for inverse gamma prior on individual-level variance (default = 0.01).</p>
</dd>
<dt>degree</dt><dd><p>Degree of B-splines (default = 3).</p>
</dd>
<dt>k_max</dt><dd><p>Maximum number of knots for each spline term (default = 9).</p>
</dd>
<dt>w</dt><dd><p>Window for proposing knot location changes (default = 1).</p>
</dd>
<dt>sigma_B</dt><dd><p>Prior normal variance for model coefficients (default = sqrt(20)).</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>An rjMCMC object with the following components:
</p>

<dl>
<dt>accept_var</dt><dd><p>Matrix indicating the acceptance of variable inclusion/removal for each iteration.</p>
</dd>
<dt>accept_add_knot</dt><dd><p>Matrix indicating acceptance of knot addition for each spline term across iterations.</p>
</dd>
<dt>accept_remove_knot</dt><dd><p>Matrix indicating acceptance of knot removal for each spline term across iterations.</p>
</dd>
<dt>accept_move_knot</dt><dd><p>Matrix indicating acceptance of knot movement for each spline term across iterations.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices, one per spline interaction term, containing fitted spline values across iterations.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix containing posterior samples of binary variable parameters.</p>
</dd>
<dt>inter_trt_param</dt><dd><p>Matrix containing posterior samples of the treatment intercept and main effect.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop</dt><dd><p>Matrix indicating the inclusion of variables across iterations (1 for included, 0 for excluded).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for all candidate variables (spline and binary).</p>
</dd>
<dt>k</dt><dd><p>Matrix indicating the number of knots for each spline term across iterations.</p>
</dd>
<dt>trt_eff_posterior</dt><dd><p>Matrix of posterior treatment effect estimates, including spline effects.</p>
</dd>
<dt>data_fit</dt><dd><p>The original dataset passed to the function.</p>
</dd>
<dt>candsplineinter</dt><dd><p>A character vector indicating the spline interaction terms.</p>
</dd>
<dt>candsplinevars</dt><dd><p>A character vector of candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>A character vector of candidate binary variables.</p>
</dd>
<dt>candinter</dt><dd><p>A character vector of interaction terms with treatment (can include splines and binary variables).</p>
</dd>
<dt>mcmc_specs</dt><dd><p>The MCMC specifications used in the procedure.</p>
</dd>
<dt>prior_params</dt><dd><p>The prior parameters used in the procedure.</p>
</dd>
</dl>



<h3>References</h3>

<p>Maleyeff, L., Golchi, S., Moodie, E. E. M., &amp; Hudson, M. (2024) &quot;An adaptive
enrichment design using Bayesian model averaging for selection and threshold-identification
of predictive variables&quot; <a href="doi:10.1093/biomtc/ujae141">doi:10.1093/biomtc/ujae141</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)

results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")

</code></pre>

<hr>
<h2 id='simulated_data'>A synthetic dataset with continuous and binary covariates and a binary treatment variable (<code>trt</code>).</h2><span id='topic+simulated_data'></span>

<h3>Description</h3>

<p>This dataset was generated using the formula:
<code class="reqn">Y = 2 * Z_1 + 2 * X_1 + 2 * Z_1 * trt + \cos(X_1 \cdot 2 \pi) * trt + \epsilon</code>,
where <code class="reqn">\epsilon \sim N(0, 0.5)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simulated_data)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 8 variables:
</p>

<dl>
<dt>X_1</dt><dd><p>A continuous variable sampled from <code>U(0, 1)</code>.</p>
</dd>
<dt>Z_1</dt><dd><p>A binary variable sampled from <code>Bernoulli(0.35)</code>.</p>
</dd>
<dt>Z_2</dt><dd><p>A binary variable sampled from <code>Bernoulli(0.5)</code>.</p>
</dd>
<dt>Z_3</dt><dd><p>A binary variable sampled from <code>Bernoulli(0.65)</code>.</p>
</dd>
<dt>Z_4</dt><dd><p>A binary variable sampled from <code>Bernoulli(0.2)</code>.</p>
</dd>
<dt>Z_5</dt><dd><p>A binary variable sampled from <code>Bernoulli(0.35)</code>.</p>
</dd>
<dt>trt</dt><dd><p>A binary treatment variable sampled from <code>Bernoulli(0.5)</code>.</p>
</dd>
<dt>Y</dt><dd><p>The outcome variable calculated using the formula above.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(simulated_data)
head(simulated_data)
</code></pre>

<hr>
<h2 id='summary.rjMCMC'>Summarize Results from Reversible Jump MCMC (rjMCMC)</h2><span id='topic+summary.rjMCMC'></span>

<h3>Description</h3>

<p>This function provides a detailed summary of the results from the <code>rjMCMC</code> procedure, including
model information, parameter estimates, posterior inclusion probabilities, convergence diagnostics,
and plots for spline terms. The function also prints the model formula with <code>fbs()</code> notation for spline terms,
indicating the use of free-knot B-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rjMCMC'
summary(object, digits = 3, level = 0.95, pip_cutoff = 0.1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.rjMCMC_+3A_object">object</code></td>
<td>
<p>An object of class rjMCMC containing the output from the <code>rjMCMC</code> procedure, which includes:
</p>

<dl>
<dt>fixed_param</dt><dd><p>Matrix of posterior samples for exposure intercept and main effect.</p>
</dd>
<dt>binary_param</dt><dd><p>Matrix of posterior samples for binary variable parameters.</p>
</dd>
<dt>sigma_sq</dt><dd><p>Matrix of posterior samples for the residual variance (sigma squared).</p>
</dd>
<dt>vars_prop_summ</dt><dd><p>Posterior inclusion probabilities for candidate variables.</p>
</dd>
<dt>splines_fitted</dt><dd><p>List of matrices containing fitted values for spline terms across iterations.</p>
</dd>
<dt>data_fit</dt><dd><p>Original dataset used in the <code>rjMCMC</code> procedure.</p>
</dd>
<dt>candsplineinter</dt><dd><p>Names of continuous candidate predictive spline variables.</p>
</dd>
<dt>candsplinevars</dt><dd><p>Names of continuous candidate spline variables.</p>
</dd>
<dt>candbinaryvars</dt><dd><p>Names of binary candidate variables.</p>
</dd>
<dt>candinter</dt><dd><p>Names of interaction terms, which can include spline variables.</p>
</dd>
<dt>mcmc_specs</dt><dd><p>MCMC sampler specifications, including the number of iterations, burn-in, thinning, and chains.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="summary.rjMCMC_+3A_digits">digits</code></td>
<td>
<p>Number of digits in summary output (default = 3)</p>
</td></tr>
<tr><td><code id="summary.rjMCMC_+3A_level">level</code></td>
<td>
<p>Credible interval level (default = 0.95)</p>
</td></tr>
<tr><td><code id="summary.rjMCMC_+3A_pip_cutoff">pip_cutoff</code></td>
<td>
<p>Posterior inclusion probability cutoff for reporting effective sample size
and R-squared (default = 0.10)</p>
</td></tr>
<tr><td><code id="summary.rjMCMC_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to other methods or functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces detailed summaries similar to those from <code>brms</code>, including
diagnostics, estimates, posterior inclusion probabilities, and spline effects. The spline terms
are wrapped in <code>fbs()</code> notation, indicating the use of free-knot B-splines in the model. If the sampler
did not converge, a warning is issued. The function also allows the user to view diagnostic plots for fitted
exposure effects.
</p>


<h3>Value</h3>

<p>Prints the following summary information:
</p>

<dl>
<dt>Model Formula</dt><dd><p>The model formula with spline terms wrapped in <code>fbs()</code>, indicating free-knot B-splines, and interaction terms appropriately formatted.</p>
</dd>
<dt>Convergence Diagnostics</dt><dd><p>Reports any convergence issues based on Geweke diagnostics.</p>
</dd>
<dt>MCMC Sampler Arguments</dt><dd><p>Displays MCMC sampler arguments, including the number of posterior samples, burn-in, thinning, and chains.</p>
</dd>
<dt>Parameter Estimates</dt><dd><p>Posterior mean, standard error, 95% credible intervals, effective sample size (ESS), Gelman-Rubin statistic (Rhat), and posterior inclusion probabilities (PIP) for binary parameters, exposure intercept, and exposure effect.</p>
</dd>
<dt>Gaussian Family Parameters</dt><dd><p>Posterior summary for the residual standard error (sigma).</p>
</dd>
<dt>Posterior Inclusion Probabilities for Splines</dt><dd><p>Prints the posterior inclusion probabilities for spline terms.</p>
</dd>
<dt>Plots for Fitted Exposure Effects</dt><dd><p>Plots the mean and 95% credible intervals for each spline term vs fitted exposure effects.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# Example dataset
data("simulated_data")

candsplinevars &lt;- c("X_1")
candbinaryvars &lt;- paste0("Z_", 1:5)
candinter &lt;- c(candsplinevars, candbinaryvars)

results &lt;- rjMCMC(simulated_data, candsplinevars, candbinaryvars, candinter,
                  outcome = "Y", factor_var = "trt")
summary(results)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
