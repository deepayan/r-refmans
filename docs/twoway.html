<!DOCTYPE html><html><head><title>Help for package twoway</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {twoway}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anova.twoway'><p>ANOVA summary for a two-way table, including Tukey Additivity Test</p></a></li>
<li><a href='#Arizona'><p>Mean monthly temperatures in Arizona</p></a></li>
<li><a href='#as.data.frame.twoway'><p>Convert a twoway object to a data frame</p>
This function converts a <code>"twoway"</code> object to a <code>data.frame</code></a></li>
<li><a href='#as.twoway'><p>Create an initial twoway object representing the data before fitting</p></a></li>
<li><a href='#drugs'><p>Scores for 5 subjects after being given each of 4 drugs</p></a></li>
<li><a href='#hstart'><p>Number of U.S. housing starts by month for the years 1965 &ndash; 1973</p></a></li>
<li><a href='#insectCounts'><p>Counts of an insect for the combinations of 4 treatments and 6 areas of a field</p></a></li>
<li><a href='#ladder_power'><p>Find the nearest ladder-of-powers representation of a power transformation</p></a></li>
<li><a href='#meanfit'><p>Fit a two-way table using row and column means</p></a></li>
<li><a href='#medianfit'><p>Fit a two-way table using median polish</p></a></li>
<li><a href='#plot.twoway'><p>Plot methods for two-way tables</p></a></li>
<li><a href='#print.twoway'><p>Print method for two-way tables</p></a></li>
<li><a href='#residuals.twoway'><p>Extract residuals from a twoway object</p></a></li>
<li><a href='#sentRT'><p>Reaction times for T/F judgments</p></a></li>
<li><a href='#taskRT'><p>Data on reaction times for various tasks and topics</p></a></li>
<li><a href='#to_long'><p>Reshape a data.frame or matrix to a long data.frame</p></a></li>
<li><a href='#twoway'><p>Analysis of a two-way table with one observation per cell</p></a></li>
<li><a href='#twoway.formula'><p>Formula method for twoway analysis using a dataset in long format</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Two-Way Tables</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Friendly &lt;friendly@yorku.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Carries out analyses of two-way tables with one observation per cell, together with graphical displays
    for an additive fit and
    a diagnostic plot for removable 'non-additivity' via a power transformation of the response.
    It implements Tukey's Exploratory Data Analysis (1973) &lt;ISBN: 978-0201076165&gt; methods, including a
    1-degree-of-freedom test for row*column 'non-additivity', linear in the row and column effects.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/friendly/twoway">https://github.com/friendly/twoway</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/friendly/twoway/issues">https://github.com/friendly/twoway/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-25 21:46:13 UTC; friendly</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Friendly <a href="https://orcid.org/0000-0002-3237-0941"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Richard M. Heiberger [aut],
  John Fox [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-26 06:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anova.twoway'>ANOVA summary for a two-way table, including Tukey Additivity Test</h2><span id='topic+anova.twoway'></span>

<h3>Description</h3>

<p>Test for a 1-df interaction in two-way ANOVA table by the Tukey test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'twoway'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.twoway_+3A_object">object</code></td>
<td>
<p>a <code>class("twoway")</code> object</p>
</td></tr>
<tr><td><code id="anova.twoway_+3A_...">...</code></td>
<td>
<p>other arguments passed down, but not used here</p>
</td></tr>
</table>


<h3>Details</h3>

<p>At present, this function simply gives the results of the ANOVAs for the additive model, the model including the 1 df
term for non-additivity, and an <code>anova()</code> comparison of the two.
The analysis is based on row and column means.
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sentRT)
sent.2way &lt;- twoway(sentRT)
anova(sent.2way)
</code></pre>

<hr>
<h2 id='Arizona'>Mean monthly temperatures in Arizona</h2><span id='topic+Arizona'></span>

<h3>Description</h3>

<p>This is the data set used by Tukey (1977) for the initial examples of twoway tables
</p>


<h3>Format</h3>

<p>a matrix of 7 rows (Month) and 3 columns (City) where the value is mean
monthly temperature in degrees F. The matrix has a <code>responseName</code> attribute, <code>"Temperature"</code></p>


<h3>References</h3>

<p>Tukey, J. W. (1977). <em>Exploratory Data Analysis</em>, Reading MA: Addison-Wesley. Exhibit 1 of chapter 10, p. 333
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Arizona)
(AR.2way &lt;-twoway(Arizona, method="median"))

## plot(AR.2way)
</code></pre>

<hr>
<h2 id='as.data.frame.twoway'>Convert a twoway object to a data frame
This function converts a <code>"twoway"</code> object to a <code>data.frame</code></h2><span id='topic+as.data.frame.twoway'></span>

<h3>Description</h3>

<p>The rows and columns of the data table are strung out in standard R order in a vector, joined with row and column labels.
Additional columns are added, representing the calculated values used in the two-way display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'twoway'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.twoway_+3A_x">x</code></td>
<td>
<p>a <code>"twoway"</code> object</p>
</td></tr>
<tr><td><code id="as.data.frame.twoway_+3A_...">...</code></td>
<td>
<p>other arguments, presently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with <code class="reqn">r \times c</code> rows corresponding to the input data table, and the following columns
</p>

<dl>
<dt>row</dt><dd><p>row labels</p>
</dd>
<dt>col</dt><dd><p>column labels</p>
</dd>
<dt>data</dt><dd><p>the data value in the cell</p>
</dd>
<dt>fit</dt><dd><p>the fitted value, </p>
</dd>
<dt>roweff</dt><dd><p>the row effect</p>
</dd>
<dt>coleff</dt><dd><p>the column effect</p>
</dd>
<dt>nonadd</dt><dd><p>the 1 df for non-additivity value</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(sentRT)
sent.2way &lt;- twoway(sentRT)
as.data.frame(sent.2way)

</code></pre>

<hr>
<h2 id='as.twoway'>Create an initial twoway object representing the data before fitting</h2><span id='topic+as.twoway'></span><span id='topic+as.twoway.matrix'></span>

<h3>Description</h3>

<p>Create an initial twoway object representing the data before fitting
</p>
<p>Method for matrix input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.twoway(x, ...)

## S3 method for class 'matrix'
as.twoway(x, ..., name = deparse(substitute(x)),
  responseName = name, varNames = names(dimnames(x)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.twoway_+3A_x">x</code></td>
<td>
<p>a numeric matrix or numeric data frame with rownames</p>
</td></tr>
<tr><td><code id="as.twoway_+3A_...">...</code></td>
<td>
<p>other arguments, unused here</p>
</td></tr>
<tr><td><code id="as.twoway_+3A_name">name</code></td>
<td>
<p>Name of the data matrix</p>
</td></tr>
<tr><td><code id="as.twoway_+3A_responsename">responseName</code></td>
<td>
<p>Name of the response variable</p>
</td></tr>
<tr><td><code id="as.twoway_+3A_varnames">varNames</code></td>
<td>
<p>Names of the row and column variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>c("twoway")</code> with all effects(roweff, coleff, overall) set to zero, and <code>method="Initial"</code>
</p>


<h3>Author(s)</h3>

<p>Richard M. Heiberger
</p>
<p>Richard M. Heiberger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(taskRT)
as.twoway(taskRT)

</code></pre>

<hr>
<h2 id='drugs'>Scores for 5 subjects after being given each of 4 drugs</h2><span id='topic+drugs'></span>

<h3>Description</h3>

<p>The original source is Winer (1971), p. 268.  This was used as an example in Friendly (1991).
</p>


<h3>References</h3>

<p>Friendly, M. (1991). <em>SAS System for Statistical Graphics</em> Cary, NC: SAS Institute, Output 7.28
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(drugs)
twoway(drugs)
</code></pre>

<hr>
<h2 id='hstart'>Number of U.S. housing starts by month for the years 1965 &ndash; 1973</h2><span id='topic+hstart'></span>

<h3>Description</h3>

<p>Number of U.S. housing starts by month for the years 1965 &ndash; 1973
</p>


<h3>Format</h3>

<p>a 9 x 12 matrix, where the entries are the number of housing starts, in thousands</p>


<h3>References</h3>

<p>Becker, Chambers &amp; Wilks (1988), <em>The New S Language</em>, Brooks Cole.
Friendly, M. (1991). <em>SAS System for Statistical Graphics</em> Cary, NC: SAS Institute, p.380
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hstart.2way &lt;- twoway(hstart, method="mean")
plot(hstart.2way)
</code></pre>

<hr>
<h2 id='insectCounts'>Counts of an insect for the combinations of 4 treatments and 6 areas of a field</h2><span id='topic+insectCounts'></span>

<h3>Description</h3>

<p>Counts of numbers of an insect, <em>Leptinotarsa decemlineata</em> (the
Colorado potato beetle), each of which is the sum for two plots treated
alike, for all combinations of 4 treatments and 6 areas of the field chosen
to be relatively homogeneous.
</p>


<h3>Format</h3>

<p>a 4 x 6 matrix, where the rows are treatments and the columns are areas of a field.</p>


<h3>Details</h3>

<p>These data are used in Tukey (1977) Exhibit 1 of Ch 11 and throughout the chapter as examples of
median polish. Because the data are counts, either a sqrt or log transformation would be
reasonable.
</p>


<h3>References</h3>

<p>Tukey, J. W. (1977). <em>Exploratory Data Analysis</em>, Reading MA: Addison-Wesley. Exhibit 1 of chapter 111
</p>


<h3>Examples</h3>

<pre><code class='language-R'>insect.2way &lt;- twoway(insectCounts, method="median")
print(insect.2way, digits=2)

plot(insect.2way)
plot(insect.2way, which="diagnose")

# try sqrt transformation
insect.sqrt &lt;- twoway(sqrt(insectCounts), method="median")
print(insect.sqrt, digits=2)

plot(insect.sqrt)
plot(insect.sqrt, which="diagnose")
</code></pre>

<hr>
<h2 id='ladder_power'>Find the nearest ladder-of-powers representation of a power transformation</h2><span id='topic+ladder_power'></span>

<h3>Description</h3>

<p>The input power value is rounded to the nearest integer or fractional powers, <code class="reqn">\pm 1/3, 1/2</code>.
The function is presently designed just for display purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ladder_power(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ladder_power_+3A_p">p</code></td>
<td>
<p>A numeric power, for use as a transformation of a response, y, of the form <code class="reqn">y^p</code>,
where <code>p=0</code> is interpreted to mean <code class="reqn">log(y)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>In use, the transformation via the ladder of powers usually attaches a minus sign to
the transformation when the <code>power &lt; 0</code>, so that the order of the response values
are preserved under the transformation. Thus, a result of <code>power = -0.5</code> is interpreted
to mean <code class="reqn">-1 / \sqrt{y}</code>.
</p>


<h3>Value</h3>

<p>a named list of two elements: <code>power</code>, the ladder-of-power value, and
<code>name</code>, the name for the transformation
</p>


<h3>References</h3>

<p>Tukey, J. W. (1977). <em>Exploratory Data Analysis</em>, Reading MA: Addison-Wesley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ladder_power(0.6)
ladder_power(-0.6)
</code></pre>

<hr>
<h2 id='meanfit'>Fit a two-way table using row and column means</h2><span id='topic+meanfit'></span>

<h3>Description</h3>

<p>Fit a two-way table using row and column means
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meanfit(x, ..., na.rm=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meanfit_+3A_x">x</code></td>
<td>
<p>a numeric matrix or data frame</p>
</td></tr>
<tr><td><code id="meanfit_+3A_...">...</code></td>
<td>
<p>other arguments passed down</p>
</td></tr>
<tr><td><code id="meanfit_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values be removed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>c("twoway")</code> with the following named components:
</p>

<dl>
<dt>overall</dt><dd><p>the fitted constant term.</p>
</dd>
<dt>roweff</dt><dd><p>the fitted row effects.</p>
</dd>
<dt>coleff</dt><dd><p>the fitted column effects.</p>
</dd>
<dt>residuals</dt><dd><p>the residuals.</p>
</dd>
<dt>name</dt><dd><p>the name of the dataset.</p>
</dd>
<dt>rownames</dt><dd><p>the names for the rows</p>
</dd>
<dt>colnames</dt><dd><p>the names for the columns</p>
</dd>
<dt>method</dt><dd><p>&quot;median&quot;</p>
</dd>
</dl>


<hr>
<h2 id='medianfit'>Fit a two-way table using median polish</h2><span id='topic+medianfit'></span>

<h3>Description</h3>

<p>Fit a two-way table using median polish
</p>


<h3>Usage</h3>

<pre><code class='language-R'>medianfit(x, trace.iter = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="medianfit_+3A_x">x</code></td>
<td>
<p>a numeric matrix or data frame</p>
</td></tr>
<tr><td><code id="medianfit_+3A_trace.iter">trace.iter</code></td>
<td>
<p>whether to give verbose output of iteration history in median polish.</p>
</td></tr>
<tr><td><code id="medianfit_+3A_...">...</code></td>
<td>
<p>other arguments passed down</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>c("twoway", "medpolish")</code> with the following named components:
</p>

<dl>
<dt>overall</dt><dd><p>the fitted constant term.</p>
</dd>
<dt>roweff</dt><dd><p>the fitted row effects.</p>
</dd>
<dt>coleff</dt><dd><p>the fitted column effects.</p>
</dd>
<dt>residuals</dt><dd><p>the residuals.</p>
</dd>
<dt>name</dt><dd><p>the name of the dataset.</p>
</dd>
<dt>rownames</dt><dd><p>the names for the rows</p>
</dd>
<dt>colnames</dt><dd><p>the names for the columns</p>
</dd>
<dt>method</dt><dd><p>&quot;median&quot;</p>
</dd>
</dl>


<hr>
<h2 id='plot.twoway'>Plot methods for two-way tables</h2><span id='topic+plot.twoway'></span><span id='topic+plot.twoway.fit'></span><span id='topic+plot.twoway.diagnose'></span>

<h3>Description</h3>

<p>Plots either the fitted values and residuals under additivity or
a diagnostic plot for removable non-additivity by a power transformation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'twoway'
plot(x, which = c("fit", "diagnose"), ...,
  na.rm=any(is.na(x$residuals)))

## S3 method for class 'twoway.fit'
plot(x, main = paste0("Tukey two-way fit plot for ",
  x$name, " (method: ", x$method, ")"), xlab = expression(hat(mu) *
  " + Column Effect - Row Effect"), ylab = expression("Fit = " * hat(mu)
  * " + Column Effect + Row Effect"), rfactor = 1, rcolor = c("blue",
  "red"), lwd = 3, ylim = NULL, ...,
  na.rm=any(is.na(x$residuals)))

## S3 method for class 'twoway.diagnose'
plot(x, annotate = TRUE, jitter = FALSE,
  smooth = FALSE, pch = 16, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.twoway_+3A_x">x</code></td>
<td>
<p>a <code>class("twoway")</code> object</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_which">which</code></td>
<td>
<p>one of <code>"fit"</code> or <code>"diagnose"</code></p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_...">...</code></td>
<td>
<p>other arguments, passed to <code>plot</code></p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_na.rm">na.rm</code></td>
<td>
<p>logical. Should missing values be removed?</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_main">main</code></td>
<td>
<p>plot title</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_xlab">xlab</code></td>
<td>
<p>X axis label</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_ylab">ylab</code></td>
<td>
<p>Y axis label</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_rfactor">rfactor</code></td>
<td>
<p>draw lines for <code>abs(residuals) &gt; rfactor*sqrt(MSPE)</code></p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_rcolor">rcolor</code></td>
<td>
<p>a vector of length 2 giving the color of lines for positive and negative residuals</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_lwd">lwd</code></td>
<td>
<p>line width for residual lines in the fit plot</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_ylim">ylim</code></td>
<td>
<p>Y axis limits</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_annotate">annotate</code></td>
<td>
<p>A logical value; if <code>TRUE</code>, the slope and power are displayed in the diagnostic plot</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_jitter">jitter</code></td>
<td>
<p>A logical value; if <code>TRUE</code>, the comparison values in the plot are jittered to avoid overplotting</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_smooth">smooth</code></td>
<td>
<p>A logical value; if <code>TRUE</code>, a smoothed <code><a href="stats.html#topic+loess">loess</a></code> curve is added to the plot</p>
</td></tr>
<tr><td><code id="plot.twoway_+3A_pch">pch</code></td>
<td>
<p>Plot character for point symbols in the diagnostic plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the <code>which="fit"</code> plot, the basic result comes from a plot of the row effects against the column fitted
values, which appears as a rectangular grid in these coordinates.  Rotating this 45 degrees counterclockwise give a plot
in which the vertical coordinate is the fitted value for the two-way table, and the horizontal coordinate is the column fit
minus the row effect.  The spacing of the grid lines for the rows and columns of the table show the relative magnitudes of the
row/column means or medians.
</p>
<p>For the <code>which="diagnose"</code> plot, the interaction residuals from an additive model, <code class="reqn">y_{ij} = \mu + \alpha_i + \beta_j</code>,
are plotted against the estimated components <code class="reqn">\alpha_i \beta_j / \mu</code>. If this plot shows a substantially non-zero
slope, <code class="reqn">b</code>, this analysis suggests that a power transformation, <code class="reqn"> y \rightarrow y^(1-b)</code> might reduce the
apparent interaction effects.
</p>
<p>For both plots, if you want to directly compare the result of <code>method="mean"</code> and <code>method="median"</code>, it is
essential to set the same <code>xlim</code> and <code>ylim</code> axes in the call.
</p>


<h3>Value</h3>

<p>The diagnostic plot invisibly returns a list with elements <code>c("slope", "power")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(taskRT)
tw &lt;- twoway(taskRT)
tw
twmed &lt;- twoway(taskRT, method="median")
twmed
plot(tw,    xlim=c(2,7), ylim=c(2,7)) ## use the same xlim and ylim, for comparison
plot(twmed, xlim=c(2,7), ylim=c(2,7))

plot(tw,    which="diagnose", xlim=c(-.19, .19), ylim=c(-.5, .55))
plot(twmed, which="diagnose", xlim=c(-.19, .19), ylim=c(-.5, .55))

data(insectCounts)
twi &lt;- twoway(insectCounts)
twimed &lt;- twoway(insectCounts, method="median")

plot(twi,    xlim=c(-250, 700), ylim=c(-180, 900))
plot(twimed, xlim=c(-250, 700), ylim=c(-180, 900))

plot(twi,    which="diagnose", xlim=c(-160, 170), ylim=c(-200, 400))  ## power = .1
plot(twimed, which="diagnose", xlim=c(-160, 170), ylim=c(-200, 400))  ## power = .3

</code></pre>

<hr>
<h2 id='print.twoway'>Print method for two-way tables</h2><span id='topic+print.twoway'></span>

<h3>Description</h3>

<p>Print method for two-way tables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'twoway'
print(x, digits = getOption("digits"), border = 2,
  zapsmall = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.twoway_+3A_x">x</code></td>
<td>
<p>a numeric matrix</p>
</td></tr>
<tr><td><code id="print.twoway_+3A_digits">digits</code></td>
<td>
<p>number of digits to print</p>
</td></tr>
<tr><td><code id="print.twoway_+3A_border">border</code></td>
<td>
<p>if 0, the components <code>"twoway"</code> object (<code>"overall", "roweff", "coleff", "residuals"</code>) are printed separately;
if 1, the row, column and overall effects are joined to the residuals in a single table.
if 2, row, column, overall and residuals are joined, and decorated with horizontal and vertical rules</p>
</td></tr>
<tr><td><code id="print.twoway_+3A_zapsmall">zapsmall</code></td>
<td>
<p>a logical value; if <code>TRUE</code> small residuals are printed as 0.</p>
</td></tr>
<tr><td><code id="print.twoway_+3A_...">...</code></td>
<td>
<p>other arguments passed down</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Friendly, Richard Heiberger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(taskRT)
task.2way &lt;- twoway(taskRT)
print(task.2way)
print(task.2way, border=0)

data(sentRT)
sent.2way &lt;- twoway(sentRT)
print(sent.2way)
print(sent.2way, border=1)

</code></pre>

<hr>
<h2 id='residuals.twoway'>Extract residuals from a twoway object</h2><span id='topic+residuals.twoway'></span><span id='topic+fitted.twoway'></span>

<h3>Description</h3>

<p>Extract residuals from a twoway object
</p>
<p>Extract fitted values from a twoway object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'twoway'
residuals(object, nonadd = FALSE, ...)

## S3 method for class 'twoway'
fitted(object, nonadd = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.twoway_+3A_object">object</code></td>
<td>
<p>A <code>class="twoway"</code> object</p>
</td></tr>
<tr><td><code id="residuals.twoway_+3A_nonadd">nonadd</code></td>
<td>
<p>If <code>TRUE</code>, the 1 degree of freedom term for non-additivity is subtracted from the additive residuals</p>
</td></tr>
<tr><td><code id="residuals.twoway_+3A_...">...</code></td>
<td>
<p>other arguments (unused)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of residuals corresponding to the data supplied to <code>twoway</code>
</p>
<p>A numeric matrix of fitted values corresponding to the data supplied to <code>twoway</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(taskRT)
task.2way &lt;- twoway(taskRT)
residuals(task.2way)
residuals(task.2way, nonadd=TRUE)

sum(residuals(task.2way)^2)               #  SSE for additive model
sum(residuals(task.2way, nonadd=TRUE)^2)  # SSPE, non-additive model
data(taskRT)
task.2way &lt;- twoway(taskRT)
fitted(task.2way)
fitted(task.2way, nonadd=TRUE)

</code></pre>

<hr>
<h2 id='sentRT'>Reaction times for T/F judgments</h2><span id='topic+sentRT'></span>

<h3>Description</h3>

<p>A demonstration 3 x 3 two-way table composed of reaction times for
three subjects making T/F judgments on three types of sentences
</p>


<h3>References</h3>

<p>Friendly, M. (1991). <em>SAS System for Statistical Graphics</em> Cary, NC: SAS Institute, Table 7.2
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sentRT)
twoway(sentRT)
</code></pre>

<hr>
<h2 id='taskRT'>Data on reaction times for various tasks and topics</h2><span id='topic+taskRT'></span>

<h3>Description</h3>

<p>A demonstration 3 x 4 two-way table composed of reaction times for
tasks varying in difficulty, with content on different topics.
</p>


<h3>Format</h3>

<p>A matrix of 3 rows and 4 columns, where the rows are the task difficulty levels and the columns are the the topics.
The cell values are average reaction times (in sec.). The matrix has a <code>responseName</code> attribute, <code>"RT"</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(taskRT)
twoway(taskRT)
twoway(taskRT, method="median")
</code></pre>

<hr>
<h2 id='to_long'>Reshape a data.frame or matrix to a long data.frame</h2><span id='topic+to_long'></span><span id='topic+to_wide'></span>

<h3>Description</h3>

<p>Reshape a data.frame or matrix to a long data.frame
</p>
<p>Reshape a data.frame or matrix to a wide data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_long(wide, rowname = NULL, colname = NULL,
  responseName = deparse(substitute(wide)), varNames = c("Row", "Col"))

to_wide(long, row = 1, col = 2, response = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_long_+3A_wide">wide</code></td>
<td>
<p>A data.frame or matrix in wide form</p>
</td></tr>
<tr><td><code id="to_long_+3A_rowname">rowname</code></td>
<td>
<p>Name for the row variable</p>
</td></tr>
<tr><td><code id="to_long_+3A_colname">colname</code></td>
<td>
<p>Name for the column variable</p>
</td></tr>
<tr><td><code id="to_long_+3A_responsename">responseName</code></td>
<td>
<p>Name for the response variable.  If <code>wide</code> is a matrix with an attribute that begins with
<code>"response"</code>, that value is taken as the <code>responseName</code>.  Otherwise, the name of the <code>wide</code>
object is used.</p>
</td></tr>
<tr><td><code id="to_long_+3A_varnames">varNames</code></td>
<td>
<p>Default names for the row and column variables if not passed as <code>rowname</code> or <code>colname</code></p>
</td></tr>
<tr><td><code id="to_long_+3A_long">long</code></td>
<td>
<p>A data.frame in long form</p>
</td></tr>
<tr><td><code id="to_long_+3A_row">row</code></td>
<td>
<p>Column index or quoted name of the row variable</p>
</td></tr>
<tr><td><code id="to_long_+3A_col">col</code></td>
<td>
<p>Column index or quoted name of the column variable</p>
</td></tr>
<tr><td><code id="to_long_+3A_response">response</code></td>
<td>
<p>Column index or quoted name of the response variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame in long format
</p>


<h3>Author(s)</h3>

<p>Michael Friendly and Richard M. Heiberger
</p>
<p>Michael Friendly and Richard M. Heiberger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Arizona.long &lt;- to_long(Arizona, varNames=c("Month", "City"))
Arizona.long

Arizona.long &lt;- to_long(Arizona, varNames=c("Month", "City"))
# back the other way
to_wide(Arizona.long)
</code></pre>

<hr>
<h2 id='twoway'>Analysis of a two-way table with one observation per cell</h2><span id='topic+twoway'></span><span id='topic+twoway.default'></span>

<h3>Description</h3>

<p>Fits an additive model using either row and column means or Tukey's median polish procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twoway(x, ...)

## Default S3 method:
twoway(x, method = c("mean", "median"), ...,
  name = deparse(substitute(x)), responseName = attr(x, "response"),
  varNames = names(dimnames(x)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twoway_+3A_x">x</code></td>
<td>
<p>a numeric matrix or data frame.</p>
</td></tr>
<tr><td><code id="twoway_+3A_...">...</code></td>
<td>
<p>other arguments passed down</p>
</td></tr>
<tr><td><code id="twoway_+3A_method">method</code></td>
<td>
<p>one of <code>"mean"</code> or <code>"median"</code></p>
</td></tr>
<tr><td><code id="twoway_+3A_name">name</code></td>
<td>
<p>name for the input dataset</p>
</td></tr>
<tr><td><code id="twoway_+3A_responsename">responseName</code></td>
<td>
<p>name for the response variable</p>
</td></tr>
<tr><td><code id="twoway_+3A_varnames">varNames</code></td>
<td>
<p>names for the Row and Column variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>rownames(x)</code> are used as the levels of the row factor and the <code>colnames(x</code>) are
the levels of the column factor.
For a numeric matrix, the function uses the <code>names(dimnames(x))</code> as the names of these
variables, and, if present, a <code>responseName</code> attribute as the name for the response variable.
</p>


<h3>Value</h3>

<p>An object of class <code>c("twoway")</code> with the following named components:
</p>

<dl>
<dt>overall</dt><dd><p>the fitted constant term.</p>
</dd>
<dt>roweff</dt><dd><p>the fitted row effects.</p>
</dd>
<dt>coleff</dt><dd><p>the fitted column effects.</p>
</dd>
<dt>residuals</dt><dd><p>the residuals.</p>
</dd>
<dt>name</dt><dd><p>the name of the dataset.</p>
</dd>
<dt>rownames</dt><dd><p>the names for the rows</p>
</dd>
<dt>colnames</dt><dd><p>the names for the columns</p>
</dd>
<dt>method</dt><dd><p>the fitting method</p>
</dd>
<dt>varNames</dt><dd><p>the names of the row and column variables</p>
</dd>
<dt>responseName</dt><dd><p>the name of the response variable</p>
</dd>
<dt>compValue</dt><dd><p>the comparison values, for the diagnostic plot</p>
</dd>
<dt>slope</dt><dd><p>the slope value, for the diagnostic plot</p>
</dd>
<dt>power</dt><dd><p>the suggested power transformation, <code>1-slope</code></p>
</dd>
</dl>

<p>An object of class <code>"twoway"</code>, but supplemented by additional components used for labeling
</p>


<h3>Author(s)</h3>

<p>Michael Friendly
</p>


<h3>References</h3>

<p>Tukey, J. W. (1977). <em>Exploratory Data Analysis</em>, Reading MA: Addison-Wesley.
Friendly, M. (1991). <em>SAS System for Statistical Graphics</em> Cary, NC: SAS Institute
</p>


<h3>See Also</h3>

<p>code<a href="#topic+twoway.formula">twoway.formula</a>, code<a href="stats.html#topic+medpolish">medpolish</a>
</p>
<p><code><a href="#topic+medianfit">medianfit</a></code>, <code><a href="#topic+meanfit">meanfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(taskRT)
twoway(taskRT)

</code></pre>

<hr>
<h2 id='twoway.formula'>Formula method for twoway analysis using a dataset in long format</h2><span id='topic+twoway.formula'></span>

<h3>Description</h3>

<p>The formula method reshapes the data set from long to wide format and calls the default method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
twoway(formula, data, subset, na.action, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twoway.formula_+3A_formula">formula</code></td>
<td>
<p>A formula of the form <code>response ~ rowvar + colvar</code>, where <code>response</code> is numeric</p>
</td></tr>
<tr><td><code id="twoway.formula_+3A_data">data</code></td>
<td>
<p>The name of the data set, containing a row vector, column factor and a numeric response</p>
</td></tr>
<tr><td><code id="twoway.formula_+3A_subset">subset</code></td>
<td>
<p>An expression to subset the data (unused)</p>
</td></tr>
<tr><td><code id="twoway.formula_+3A_na.action">na.action</code></td>
<td>
<p>What to do with NAs? (unused)</p>
</td></tr>
<tr><td><code id="twoway.formula_+3A_...">...</code></td>
<td>
<p>other arguments, passed down</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Friendly and Richard Heiberger
</p>


<h3>References</h3>

<p>the conversion of long to wide in a formula method was suggested on
<a href="https://stackoverflow.com/questions/50469320/how-to-write-a-formula-method-that-converts-long-to-wide">https://stackoverflow.com/questions/50469320/how-to-write-a-formula-method-that-converts-long-to-wide</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>longRT &lt;- to_long(taskRT)
twoway(RT ~ Task + Topic, data=longRT)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
