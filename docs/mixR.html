<!DOCTYPE html><html lang="en"><head><title>Help for package mixR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mixR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mixR-package'><p>Finite Mixture Modeling for Raw and Binned Data</p></a></li>
<li><a href='#bin'><p>Binning the Raw Data</p></a></li>
<li><a href='#bs.test'><p>Bootstrap Likelihood Ratio Test for Finite Mixture Models</p></a></li>
<li><a href='#density.mixfitEM'><p>The Density of Finite Mixture Models</p></a></li>
<li><a href='#initz'><p>Initialization of the EM Algorithm</p></a></li>
<li><a href='#mixfit'><p>Finite Mixture Modeling for Raw Data and Binned Data</p></a></li>
<li><a href='#plot.bootEM'><p>Plot Bootstrap Likelihood Ratio Test</p></a></li>
<li><a href='#plot.mixfitEM'><p>Plotting the Fitted Mixture Models</p></a></li>
<li><a href='#plot.selectEM'><p>Plot Method for Class <code>selectEM</code></p></a></li>
<li><a href='#print.mixfitEM'><p>Print Method for Class <code>mixfitEM</code></p></a></li>
<li><a href='#print.selectEM'><p>Print Method for Class <code>selectEM</code></p></a></li>
<li><a href='#reinstate'><p>Reinstate the Binned Data to the Raw Data</p></a></li>
<li><a href='#rmixgamma'><p>Generating Random Data From A Gamma Mixture Model</p></a></li>
<li><a href='#rmixlnorm'><p>Generating Random Data From A Lognormal Mixture Model</p></a></li>
<li><a href='#rmixnormal'><p>Generating Random Data From A Normal Mixture Model</p></a></li>
<li><a href='#rmixweibull'><p>Generating Random Data From A Weibull Mixture Model</p></a></li>
<li><a href='#select'><p>Finite Mixture Model Selection by Information Criterion</p></a></li>
<li><a href='#Stamp'><p>1872 Hidalgo Stamp Data</p></a></li>
<li><a href='#Stamp2'><p>1872 Hidalgo Stamp Data (Binned)</p></a></li>
<li><a href='#to_k_lambda_weibull'><p>Parameter Conversion for Weibull Distribution</p></a></li>
<li><a href='#to_mu_sd_gamma'><p>Parameter Conversion for Gamma Distribution</p></a></li>
<li><a href='#to_mu_sd_lnorm'><p>Parameter Conversion for Lognormal Distribution</p></a></li>
<li><a href='#to_mu_sd_weibull'><p>Parameter Conversion for Weibull Distribution</p></a></li>
<li><a href='#to_mulog_sdlog_lnorm'><p>Parameter Conversion for Lognormal Distribution</p></a></li>
<li><a href='#to_shape_rate_gamma'><p>Parameter Conversion for Gamma Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Finite Mixture Modeling for Raw and Binned Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-10-19</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Youjiao Yu &lt;jiaoisjiao@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs maximum likelihood estimation for finite mixture models for families including Normal, Weibull, Gamma and Lognormal by using EM algorithm, together with Newton-Raphson algorithm or bisection method when necessary. It also conducts mixture model selection by using information criteria or bootstrap likelihood ratio test. The data used for mixture model fitting can be raw data or binned data. The model fitting process is accelerated by using R package 'Rcpp'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 4.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.5.1), graphics, Rcpp (&ge; 1.0.13), stats</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Youjiao Yu [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, testthat, mockery</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-19 23:41:18 UTC; youjiao</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-20 04:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mixR-package'>Finite Mixture Modeling for Raw and Binned Data</h2><span id='topic+mixR'></span><span id='topic+mixR-package'></span>

<h3>Description</h3>

<p>The package <code>mixR</code> performs maximum likelihood estimation for finite
mixture models for families including Normal, Weibull, Gamma and Lognormal via EM algorithm.
It also conducts model selection by using information criteria or bootstrap likelihood ratio
test. The data used for mixture model fitting can be raw data or binned data. The model fitting
is accelerated by using R package Rcpp.
</p>


<h3>Details</h3>

<p>Finite mixture models can be represented by
</p>
<p style="text-align: center;"><code class="reqn">f(x; \Phi) = \sum_{j = 1}^g \pi_j f_j(x; \theta_j)</code>
</p>

<p>where <code class="reqn">f(x; \Phi)</code> is the probability density function (p.d.f.) or probability mass function
(p.m.f.) of the mixture model, <code class="reqn">f_j(x; \theta_j)</code> is the p.d.f. or p.m.f. of the <code class="reqn">j</code>th
component of the mixture model, <code class="reqn">\pi_j</code> is the proportion of the <code class="reqn">j</code>th component and
<code class="reqn">\theta_j</code> is the parameter of the <code class="reqn">j</code>th component, which can be a scalar or a vector,
<code class="reqn">\Phi</code> is a vector of all the parameters of the mixture model. The maximum likelihood
estimate of the parameter vector <code class="reqn">\Phi</code> can be obtained by using
the EM algorithm (Dempster <em>et al</em>, 1977).
The binned data is present sometimes instead of the raw data, for the reason of storage
convenience or necessity. The binned data is recorded in the form of <code class="reqn">(a_i, b_i, n_i)</code>
where <code class="reqn">a_i</code> is the lower bound of the <code class="reqn">i</code>th bin, <code class="reqn">b_i</code> is
the upper bound of the <code class="reqn">i</code>th bin, and <code class="reqn">n_i</code> is the number of observations that fall
in the <code class="reqn">i</code>th bin, for <code class="reqn">i = 1, \dots, r</code>, and <code class="reqn">r</code> is the total number of bins.
</p>
<p>To obtain maximum likelihood estimate of the finite mixture model for binned data, we can
introduce two types of latent variables <code class="reqn">x</code> and <code class="reqn">z</code>, where<code class="reqn">x</code> represents the
value of the unknown raw data, and <code class="reqn">z</code> is a vector of zeros and one indicating the
component that <code class="reqn">x</code> belongs to. To use the EM algorithm we first write the complete-data
log-likelihood
</p>
<p style="text-align: center;"><code class="reqn">Q(\Phi; \Phi^{(p)}) = \sum_{j = 1}^{g} \sum_{i = 1}^r n_i z^{(p)} [\log f(x^{(p)}; \theta_j)
 + \log \pi_j ]</code>
</p>

<p>where <code class="reqn">z^{(p)}</code> is the expected value of <code class="reqn">z</code> given the estimated value of <code class="reqn">\Phi</code>
and expected value <code class="reqn">x^{(p)}</code> at <code class="reqn">p</code>th iteration. The estimated value of <code class="reqn">\Phi</code>
can be updated iteratively via the E-step, in which we estimate <code class="reqn">\Phi</code> by maximizing
the complete-data loglikelihood, and M-step, in which we calculate the expected value of
the latent variables <code class="reqn">x</code> and <code class="reqn">z</code>. The EM algorithm is terminated by using a stopping
rule.
The M-step of the EM algorithm may or may not have closed-form solution (e.g. the Weibull
mixture model or Gamma mixture model). If not, an iterative approach like Newton's algorithm
or bisection method may be used.
</p>
<p>For a given data set, when we have no prior information about the number of components
<code class="reqn">g</code>, its value should be estimated from the data. Because mixture models don't satisfy
the regularity condition for the likelihood ratio test (which requires that the true
parameter under the null hypothesis should be in the interior of the parameter space
of the full model under the alternative hypothesis), a bootstrap approach is usually
used in the literature (see McLachlan (1987, 2004), Feng and McCulloch (1996)). The general
step of bootstrap likelihood ratio test is as follows.
</p>

<ol>
<li><p> For the given data <code class="reqn">x</code>, estimate <code class="reqn">\Phi</code> under both the null and the alternative
hypothesis to get <code class="reqn">\hat\Phi_0</code> and <code class="reqn">\hat\Phi_1</code>. Calculate the observed log-likelihood
<code class="reqn">\ell(x; \hat\Phi_0)</code> and <code class="reqn">\ell(x; \hat\Phi_1)</code>. The likelihood ratio test
statistic is defined as
</p>
<p style="text-align: center;"><code class="reqn">w_0 = -2(\ell(x; \hat\Phi_0) - \ell(x; \hat\Phi_1)).</code>
</p>

</li>
<li><p> Generate random data of the same size as the original data <code class="reqn">x</code> from the model
under the null hypothesis using estimated parameter <code class="reqn">\hat\Phi_0</code>, then repeat step
1 using the simulated data. Repeat this process for <code class="reqn">B</code> times to get a vector of the
simulated likelihood ratio test statistics <code class="reqn">w_1^{1}, \dots, w_1^{B}</code>.
</p>
</li>
<li><p> Calculate the empirical p-value
</p>
<p style="text-align: center;"><code class="reqn">p = \frac{1}{B} \sum_{i=1}^B I(w_1^{(i)} &gt; w_0)</code>
</p>

<p>where <code class="reqn">I</code> is the indicator function.
</p>
</li></ol>

<p>This package does the following three things.
</p>

<ol>
<li><p> Fitting finite mixture models for both raw data and binned data by using
EM algorithm, together with Newton-Raphson algorithm and bisection method.
</p>
</li>
<li><p> Do parametric bootstrap likelihood ratio test for two candidate models.
</p>
</li>
<li><p> Do model selection by Bayesian information criterion.
</p>
</li></ol>

<p>To speed up computation, the EM algorithm is fulfilled in C++ by using Rcpp
(Eddelbuettel and Francois (2011)).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Youjiao Yu <a href="mailto:jiaoisjiao@gmail.com">jiaoisjiao@gmail.com</a>
</p>


<h3>References</h3>

<p>Dempster, A. P., Laird, N. M., and Rubin, D. B. Maximum likelihood from incomplete data
via the EM algorithm. <em>Journal of the royal statistical society. Series B
(methodological)</em>, pages 1-38, 1977.
</p>
<p>Dirk Eddelbuettel and Romain Francois (2011). Rcpp: Seamless R and C++ Integration.
<em>Journal of Statistical Software</em>, 40(8), 1-18. URL http://www.jstatsoft.org/v40/i08/.
</p>
<p>Efron, B. Bootstrap methods: Another look at the jackknife. <em>Ann. Statist.</em>,
7(1):1-26, 01 1979.
</p>
<p>Feng, Z. D. and McCulloch, C. E. Using bootstrap likelihood ratios in finite mixture
models. <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>,
pages 609-617, 1996.
</p>
<p>Lo, Y., Mendell, N. R., and Rubin, D. B. Testing the number of components in a normal
mixture. <em>Biometrika</em>, 88(3):767-778, 2001.
</p>
<p>McLachlan, G. J. On bootstrapping the likelihood ratio test statistic for the number
of components in a normal mixture. <em>Applied statistics</em>, pages 318-324, 1987.
</p>
<p>McLachlan, G. and Jones, P. Fitting mixture models to grouped and truncated data via
the EM algorithm. <em>Biometrics</em>, pages 571-578, 1988.
</p>
<p>McLachlan, G. and Peel, D. <em>Finite mixture models</em>. John Wiley &amp; Sons, 2004.
</p>

<hr>
<h2 id='bin'>Binning the Raw Data</h2><span id='topic+bin'></span>

<h3>Description</h3>

<p>This function creates a binned data set from the raw data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin(x, brks)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bin_+3A_x">x</code></td>
<td>
<p>a numeric vector of raw data</p>
</td></tr>
<tr><td><code id="bin_+3A_brks">brks</code></td>
<td>
<p>a numeric vector in increasing order, representing the bin values within each of which 
we want to calculate the frequency of the data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a numeric vector, the function <code>bin</code> creates a binned data set with bin values provided
by <code>brks</code>. Fitting mixture models with a large data set may be slow, especially when
we want to fit non-normal mixture models. Binning the data with a relatively
small bin width speeds up the computation of EM algorithm while at the same time keeps the
precision of the estimation result.
</p>


<h3>Value</h3>

<p>The function <code>bin</code> returns a matrix with three columns, representing the value of the left bin, the value of the right bin and the number of observations in <code>x</code> that falls in each bin.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reinstate">reinstate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(99)
x &lt;- rmixnormal(200, c(0.5, 0.5), c(2, 5), c(1, 1))
data &lt;- bin(x, seq(-2, 10, 0.1))
fit1 &lt;- mixfit(x, ncomp = 2)
fit2 &lt;- mixfit(data, ncomp = 2)

</code></pre>

<hr>
<h2 id='bs.test'>Bootstrap Likelihood Ratio Test for Finite Mixture Models</h2><span id='topic+bs.test'></span>

<h3>Description</h3>

<p>This function performs the likelihood ratio test by parametric bootstrapping for two mixture
models with different number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bs.test(
  x,
  ncomp = c(1, 2),
  family = c("normal", "weibull", "gamma", "lnorm"),
  B = 100,
  ev = FALSE,
  mstep.method = c("bisection", "newton"),
  init.method = c("kmeans", "hclust"),
  tol = 1e-06,
  max_iter = 500
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bs.test_+3A_x">x</code></td>
<td>
<p>a numeric vector for the raw data or a three-column matrix for the binned data.</p>
</td></tr>
<tr><td><code id="bs.test_+3A_ncomp">ncomp</code></td>
<td>
<p>a vector of two positive integers specifying the number of components of the
mixture model under the null and alternative hypothesis.
The first integer should be smaller than the second one. The default value is
<code>c(1, 2)</code>.</p>
</td></tr>
<tr><td><code id="bs.test_+3A_family">family</code></td>
<td>
<p>a character string specifying the family of the mixture model, which can be one
of <code>normal</code>, <code>weibull</code>, <code>gamma</code>, or <code>lnorm</code> (default <code>normal</code>).</p>
</td></tr>
<tr><td><code id="bs.test_+3A_b">B</code></td>
<td>
<p>the number of bootstrap iterations (default 100).</p>
</td></tr>
<tr><td><code id="bs.test_+3A_ev">ev</code></td>
<td>
<p>a logical value indicating whether the variance of each component should be the same
or not (default <code>FALSE</code> for <code>Normal</code> family and ignored for other family members).</p>
</td></tr>
<tr><td><code id="bs.test_+3A_mstep.method">mstep.method</code></td>
<td>
<p>the method used in M-step of EM algorithm for <code>weibull</code> or
<code>gamma</code> family. It is ignored for <code>normal</code> or <code>lnorm</code> family,
which has closed-form solution in the M-step. The default value is <code>bisection</code>.</p>
</td></tr>
<tr><td><code id="bs.test_+3A_init.method">init.method</code></td>
<td>
<p>a character string specifying the method used for providing the initial values
for the parameters for the EM algorithm. It can be one of <code>kmeans</code> or <code>hclust</code>. The default is
<code>kmeans</code></p>
</td></tr>
<tr><td><code id="bs.test_+3A_tol">tol</code></td>
<td>
<p>the tolerance for the stopping rule of EM algorithm. It is the value to stop
EM algorithm when the two consecutive iterations produces log-likelihood with difference
less than <code>tol</code>. The default value is 1e-6.</p>
</td></tr>
<tr><td><code id="bs.test_+3A_max_iter">max_iter</code></td>
<td>
<p>the maximum number of iterations for the EM algorithm (default 500).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the given data <code>x</code> and the specified family, the function <code>bs.test</code> conducts
a bootstrap likelihood ratio test for two mixture models with the number of components
under the null and the alternative hypothesis specified in <code>ncomp</code>.
</p>


<h3>Value</h3>

<p>The function <code>bs.test</code> returns an object of class <code>bootEM</code> which
contains the following three items.
</p>
<table role = "presentation">
<tr><td><code>pvalue</code></td>
<td>
<p>The p-value of the bootstrap likelihood ratio test</p>
</td></tr>
<tr><td><code>w0</code></td>
<td>
<p>the observed likelihood ratio test statistic</p>
</td></tr>
<tr><td><code>w1</code></td>
<td>
<p>a vector of simulated likelihood ratio test statistics</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.bootEM">plot.bootEM</a></code>, <code><a href="#topic+mixfit">mixfit</a></code>, <code><a href="#topic+select">select</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## testing normal mixture models with 2 and 3 components
set.seed(100)
x &lt;- rmixnormal(200, c(0.5, 0.5), c(2, 5), c(1, 0.7))
ret &lt;- bs.test(x, ncomp = c(2, 3), B = 30)
ret

## (not run) testing Weibull mixture models with 2 and 3 components
## set.seed(101)
## x &lt;- rmixweibull(200, c(0.3, 0.4, 0.3), c(2, 5, 8), c(1, 0.6, 0.8))
## ret &lt;- bs.test(x, ncomp = c(2, 3), family = "weibull", B = 30)
## ret

## (not run) testing Gamma mixture models with 1 and 2 components
## set.seed(102)
## x &lt;- rgamma(200, 2, 1)
## ret &lt;- bs.test(x, ncomp = c(1, 2), family = "gamma", B = 30)
## ret

</code></pre>

<hr>
<h2 id='density.mixfitEM'>The Density of Finite Mixture Models</h2><span id='topic+density.mixfitEM'></span>

<h3>Description</h3>

<p>This function calculates the probability density of a finite mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixfitEM'
density(x, at, smoothness = 512, cut = 3.8, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="density.mixfitEM_+3A_x">x</code></td>
<td>
<p>an object of class <code>mixfitEM</code></p>
</td></tr>
<tr><td><code id="density.mixfitEM_+3A_at">at</code></td>
<td>
<p>a scalar or a numeric vector of locations where densities are calculated</p>
</td></tr>
<tr><td><code id="density.mixfitEM_+3A_smoothness">smoothness</code></td>
<td>
<p>a positive integer controlling the smoothness of the density curve (default 512).
The higher this value is, the more locations of the mixture model the density is calculated.</p>
</td></tr>
<tr><td><code id="density.mixfitEM_+3A_cut">cut</code></td>
<td>
<p>the number of standard deviations away the density is to be computed (default 3.8)</p>
</td></tr>
<tr><td><code id="density.mixfitEM_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>density.mixfitEM</code> is the method of the generic function
<code>density</code> for the class <code>mixfitEM</code>.
</p>


<h3>Value</h3>

<p>This function returns a list of class <code>densityEM</code>, which contains the following
items.
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>a scalar or a numeric vector of locations where densities are calculated.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>a vector of the densities of the mixture model at the corresponding locations in <code>x</code></p>
</td></tr>
<tr><td><code>comp</code></td>
<td>
<p>a matrix with columns representing the densities of each component in the mixture model at the corresponding locations in <code>x</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mixfit">mixfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(102)
x &lt;- rmixnormal(200, c(0.5, 0.5), c(2, 5), c(1, 0.7))
fit1 &lt;- mixfit(x, ncomp = 2)
d1 = density(fit1)
d2 = density(fit1, at = 0)

</code></pre>

<hr>
<h2 id='initz'>Initialization of the EM Algorithm</h2><span id='topic+initz'></span>

<h3>Description</h3>

<p>This function returns the mean and standard deviation of each component by using
K-means clustering or hierarchical clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initz(x, ncomp, init.method = c("kmeans", "hclust"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initz_+3A_x">x</code></td>
<td>
<p>a numeric vector of the raw data or a three-column matrix of the binned data</p>
</td></tr>
<tr><td><code id="initz_+3A_ncomp">ncomp</code></td>
<td>
<p>a positive integer specifying the number of components for a mixture model</p>
</td></tr>
<tr><td><code id="initz_+3A_init.method">init.method</code></td>
<td>
<p>the method used for providing initial values, which can be one of
<code>kmeans</code> or <code>hclust</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>initz</code> returns the mean and standard deviation of each component
of a mixture model by using K-means clustering algorithm, or hierarchical clustering
method. It is used for automatically selecting initial values for the EM algorithm,
so as to enable mixture model selection by bootstrapping likelihood ratio test or
using information criteria.
</p>


<h3>Value</h3>

<p><code>initz</code> returns a list with three items
</p>
<table role = "presentation">
<tr><td><code>pi</code></td>
<td>
<p>a numeric vector of component proportions</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>a numeric vector of component means</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>a numeric vector of component standard deviations</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rmixnormal(500, c(0.5, 0.5), c(2, 5), c(1, 0.7))
data &lt;- bin(x, seq(-2, 8, 0.25))
par1 &lt;- initz(x, 2)
par2 &lt;- initz(data, 2)

</code></pre>

<hr>
<h2 id='mixfit'>Finite Mixture Modeling for Raw Data and Binned Data</h2><span id='topic+mixfit'></span>

<h3>Description</h3>

<p>This function is used to perform the maximum likelihood estimation for
a variety of finite mixture models for both raw and binned data by using
the EM algorithm, together with Newton-Raphson algorithm or bisection method when necessary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixfit(
  x,
  ncomp = NULL,
  family = c("normal", "weibull", "gamma", "lnorm"),
  pi = NULL,
  mu = NULL,
  sd = NULL,
  ev = FALSE,
  mstep.method = c("bisection", "newton"),
  init.method = c("kmeans", "hclust"),
  tol = 1e-06,
  max_iter = 500
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mixfit_+3A_x">x</code></td>
<td>
<p>a numeric vector for the raw data or a three-column matrix for the binned data</p>
</td></tr>
<tr><td><code id="mixfit_+3A_ncomp">ncomp</code></td>
<td>
<p>a positive integer specifying the number of components of the mixture model</p>
</td></tr>
<tr><td><code id="mixfit_+3A_family">family</code></td>
<td>
<p>a character string specifying the family of the mixture model. It can only be
one element from <code>normal</code>, <code>weibull</code>, <code>gamma</code> or <code>lnorm</code>.</p>
</td></tr>
<tr><td><code id="mixfit_+3A_pi">pi</code></td>
<td>
<p>a vector of the initial value for the proportion</p>
</td></tr>
<tr><td><code id="mixfit_+3A_mu">mu</code></td>
<td>
<p>a vector of the initial value for the mean</p>
</td></tr>
<tr><td><code id="mixfit_+3A_sd">sd</code></td>
<td>
<p>a vector of the initial value for the standard deviation</p>
</td></tr>
<tr><td><code id="mixfit_+3A_ev">ev</code></td>
<td>
<p>a logical value controlling whether each component has the same variance when
fitting normal mixture models. It is ignored when fitting other mixture models. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mixfit_+3A_mstep.method">mstep.method</code></td>
<td>
<p>a character string specifying the method used in M-step of the EM algorithm
when fitting weibull or gamma mixture models. It can be either <code>bisection</code> or <code>newton</code>.
The default is <code>bisection</code>.</p>
</td></tr>
<tr><td><code id="mixfit_+3A_init.method">init.method</code></td>
<td>
<p>a character string specifying the method used for providing initial values
for the parameters for EM algorithm. It can be one of <code>kmeans</code> or <code>hclust</code>. The default is
<code>kmeans</code></p>
</td></tr>
<tr><td><code id="mixfit_+3A_tol">tol</code></td>
<td>
<p>the tolerance for the stopping rule of EM algorithm. It is the value to stop EM algorithm when the two
consecutive iterations produces loglikelihood with difference less than <code>tol</code>. The default value is 1e-6.</p>
</td></tr>
<tr><td><code id="mixfit_+3A_max_iter">max_iter</code></td>
<td>
<p>the maximum number of iterations for the EM algorithm (default 500).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>mixfit</code> is the core function in this package. It is used to perform
the maximum likelihood estimation for finite mixture models from the families of normal,
weibull, gamma or lognormal by using the EM algorithm. When the family is <code>weibull</code>
or <code>gamma</code>, the M-step of the EM algorithm has no closed-form solution and we can
use Newton algorithm by specifying <code>method = "newton"</code> or use bisection method by
specifying <code>method = "bisection"</code>.
</p>
<p>The initial values of the EM algorithm can be provided by specifying the proportion of each
component <code>pi</code>, the mean of each component <code>mu</code> and the standard deviation of
each component <code>sd</code>. If one or more of these initial values are not provided, then
their values are estimated by using K-means clustering method or hierarchical clustering
method. If all of <code>pi</code>, <code>mu</code>, and <code>sd</code>
are not provided, then <code>ncomp</code> should be provided so initial values are automatically
generated. For the normal mixture models, we can
control whether each component has the same variance or not.
</p>


<h3>Value</h3>

<p>the function <code>mixfit</code> return an object of class <code>mixfitEM</code>, which contains a list of
different number of items when fitting different mixture models. The common items include
</p>
<table role = "presentation">
<tr><td><code>pi</code></td>
<td>
<p>a numeric vector representing the estimated proportion of each component</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>a numeric vector representing the estimated mean of each component</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>a numeric vector representing the estimated standard deviation of each component</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>a positive integer recording the number of EM iteration performed</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>the loglikelihood of the estimated mixture model for the data <code>x</code></p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>the value of AIC of the estimated model for the data <code>x</code></p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>the value of BIC of the estimated model for the data <code>x</code></p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data <code>x</code></p>
</td></tr>
<tr><td><code>comp.prob</code></td>
<td>
<p>the probability that <code>x</code> belongs to each component</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the family the mixture model belongs to</p>
</td></tr>
</table>
<p>For the Weibull mixture model, the following extra items are returned.
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>a numeric vector representing the estimated shape parameter of each component</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>a numeric vector representing the estimated scale parameter of each component</p>
</td></tr>
</table>
<p>For the Gamma mixture model, the following extra items are returned.
</p>
<table role = "presentation">
<tr><td><code>alpha</code></td>
<td>
<p>a numeric vector representing the estimated shape parameter of each component</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>a numeric vector representing the estimated rate parameter of each component</p>
</td></tr>
</table>
<p>For the lognormal mixture model, the following extra items are returned.
</p>
<table role = "presentation">
<tr><td><code>mulog</code></td>
<td>
<p>a numeric vector representing the estimated logarithm mean of each component</p>
</td></tr>
<tr><td><code>sdlog</code></td>
<td>
<p>a numeric vector representing the estimated logarithm standard deviation of
each component</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.mixfitEM">plot.mixfitEM</a></code>, <code><a href="#topic+density.mixfitEM">density.mixfitEM</a></code>,
<code><a href="#topic+select">select</a></code>, <code><a href="#topic+bs.test">bs.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## fitting the normal mixture models
set.seed(103)
x &lt;- rmixnormal(200, c(0.3, 0.7), c(2, 5), c(1, 1))
data &lt;- bin(x, seq(-1, 8, 0.25))
fit1 &lt;- mixfit(x, ncomp = 2)  # raw data
fit2 &lt;- mixfit(data, ncomp = 2)  # binned data
fit3 &lt;- mixfit(x, pi = c(0.5, 0.5), mu = c(1, 4), sd = c(1, 1))  # providing the initial values
fit4 &lt;- mixfit(x, ncomp = 2, ev = TRUE)  # setting the same variance

## (not run) fitting the weibull mixture models
## x &lt;- rmixweibull(200, c(0.3, 0.7), c(2, 5), c(1, 1))
## data &lt;- bin(x, seq(0, 8, 0.25))
## fit5 &lt;- mixfit(x, ncomp = 2, family = "weibull")  # raw data
## fit6 &lt;- mixfit(data, ncomp = 2, family = "weibull")  # binned data

## (not run) fitting the Gamma mixture models
## x &lt;- rmixgamma(200, c(0.3, 0.7), c(2, 5), c(1, 1))
## data &lt;- bin(x, seq(0, 8, 0.25))
## fit7 &lt;- mixfit(x, ncomp = 2, family = "gamma")  # raw data
## fit8 &lt;- mixfit(data, ncomp = 2, family = "gamma")  # binned data

## (not run) fitting the lognormal mixture models
## x &lt;- rmixlnorm(200, c(0.3, 0.7), c(2, 5), c(1, 1))
## data &lt;- bin(x, seq(0, 8, 0.25))
## fit9 &lt;- mixfit(x, ncomp = 2, family = "lnorm")  # raw data
## fit10 &lt;- mixfit(data, ncomp = 2, family = "lnorm")  # binned data

</code></pre>

<hr>
<h2 id='plot.bootEM'>Plot Bootstrap Likelihood Ratio Test</h2><span id='topic+plot.bootEM'></span>

<h3>Description</h3>

<p>This function is the plot method for the class <code>bootEM</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bootEM'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bootEM_+3A_x">x</code></td>
<td>
<p>an object of class <code>bootEM</code>, which is the output of the function <code><a href="#topic+bs.test">bs.test</a></code>.</p>
</td></tr>
<tr><td><code id="plot.bootEM_+3A_...">...</code></td>
<td>
<p>the other parameters passed to the function <code><a href="graphics.html#topic+hist">hist</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The histogram of the bootstrap LRT statistics <code class="reqn">w_1</code> is plotted, with the
observed LRT statistic imposed in a red vertical line.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bs.test">bs.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## plotting the bootstrap LRT result
set.seed(100)
x &lt;- rmixnormal(200, c(0.5, 0.5), c(2, 5), c(1, 0.7))
ret &lt;- bs.test(x, ncomp = c(2, 3), B = 30)
plot(ret)

</code></pre>

<hr>
<h2 id='plot.mixfitEM'>Plotting the Fitted Mixture Models</h2><span id='topic+plot.mixfitEM'></span>

<h3>Description</h3>

<p>This is the plot method for the class <code>mixfitEM</code>. It is used to plot the fitted mixture models
by using base R plotting system or using the package ggplot2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixfitEM'
plot(
  x,
  theme = NULL,
  add_hist = TRUE,
  add_poly = TRUE,
  add_legend = TRUE,
  smoothness = 512,
  trans = 0.5,
  cut = 3.8,
  xlab,
  ylab,
  title,
  breaks,
  plot.title = element_text(hjust = 0.5),
  axis.text.x = element_text(),
  axis.text.y = element_text(),
  axis.title.x = element_text(),
  axis.title.y = element_text(),
  legend.title = element_text(),
  legend.text = element_text(),
  legend.position = "right",
  legend.direction = ifelse(legend.position %in% c("top", "bottom"), "horizontal",
    "vertical"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mixfitEM_+3A_x">x</code></td>
<td>
<p>an object of class <code>mixfitEM</code>, an output from the function <code><a href="#topic+mixfit">mixfit</a></code></p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_theme">theme</code></td>
<td>
<p>a string the specifies the appearance of the plot, which is from the ggplot2 and could
be one of'gray', 'bw' (default), 'linedraw', 'light', 'dark', 'minimal', 'classic', or 'void'.</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_add_hist">add_hist</code></td>
<td>
<p>a logical value specifying whether a histogram of data should be plotted</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_add_poly">add_poly</code></td>
<td>
<p>a logical value specifying whether a polygon of each component should be plotted.</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_add_legend">add_legend</code></td>
<td>
<p>a logical value specifying whether the legend should be plotted.</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_smoothness">smoothness</code></td>
<td>
<p>a positive integer controlling the smoothness of the density curve in the plot.
The default value is 512 and increasing this value will produce smoother curve.</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_trans">trans</code></td>
<td>
<p>the transparency of the polygons if they are plotted (default 0.5)</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_cut">cut</code></td>
<td>
<p>the number of standard deviations from the center of each component we want to plot 
the density (default 3.8)</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_xlab">xlab</code></td>
<td>
<p>the label for x axis</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_ylab">ylab</code></td>
<td>
<p>the label for y axis</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_title">title</code></td>
<td>
<p>the title of the plot</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_breaks">breaks</code></td>
<td>
<p>the number of bins used for plotting the histogram</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_plot.title">plot.title</code></td>
<td>
<p>an object returned by element_text() to specify the appearance of the title</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_axis.text.x">axis.text.x</code></td>
<td>
<p>an object returned by element_text() to specify the appearance of the x axis</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_axis.text.y">axis.text.y</code></td>
<td>
<p>an object returned by element_text() to specify the appearance of the y axis</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_axis.title.x">axis.title.x</code></td>
<td>
<p>an object returned by element_text() to specify the appearance of the label along x axis</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_axis.title.y">axis.title.y</code></td>
<td>
<p>an object returned by element_text() to specify the appearance of the label along y axis</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_legend.title">legend.title</code></td>
<td>
<p>an object returned by element_text() to specify the appearance of the legend title</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_legend.text">legend.text</code></td>
<td>
<p>an object returned by element_text() to specify the appearance of the legend text</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_legend.position">legend.position</code></td>
<td>
<p>the position of the legend, could be 'right'(default), 'right', 'top', or 'bottom'</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_legend.direction">legend.direction</code></td>
<td>
<p>the direction of the legend, could be 'vertical' (default) or 'horizontal'</p>
</td></tr>
<tr><td><code id="plot.mixfitEM_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>plot.mixfitEM</code> is used for plotting an object of class <code>mixfitEM</code>, which is
an output of the function <code><a href="#topic+mixfit">mixfit</a></code>. Users can choose base R plotting system or ggplot2
(the package ggplot2 needs to be installed).
plotting system. The plot is a density plot of the fitted mixture model imposed on top of a histogram.
The parameters that control the appearance of the histogram and the density curve can be changed.
The density curve of each component can be shown or hidden.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mixfit">mixfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rmixnormal(200, c(0.3, 0.7), c(2, 5), c(1, 0.7))
mod &lt;- mixfit(x, ncomp = 2)
plot(mod)
plot(mod, theme = 'classic') 

</code></pre>

<hr>
<h2 id='plot.selectEM'>Plot Method for Class <code>selectEM</code></h2><span id='topic+plot.selectEM'></span>

<h3>Description</h3>

<p>This function plots the result of mixture model selection by BIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'selectEM'
plot(x, leg.loc = "topright", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.selectEM_+3A_x">x</code></td>
<td>
<p>an object of class <code>selectEM</code>, which is an output of the function <code><a href="#topic+select">select</a></code>.</p>
</td></tr>
<tr><td><code id="plot.selectEM_+3A_leg.loc">leg.loc</code></td>
<td>
<p>the location of the legend, which is the same as the first argument of the function</p>
</td></tr>
<tr><td><code id="plot.selectEM_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>plot</code>
<code><a href="graphics.html#topic+legend">legend</a></code>. The default value is &quot;topright&quot;. The user can change its location
(to &quot;topleft&quot;, &quot;bottom right&quot; etc.) if the visual plot conflicts with the legend.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>plot.selectEM</code> is the plot method for the class <code>selectEM</code>. It plots
the number of components against the corresponding value of BIC. It is used to visually display
the mixture model selection result by BIC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+select">select</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rmixnormal(200, c(0.3, 0.7), c(2, 5), c(1, 1))
res &lt;- select(x, ncomp = 1:3)
plot(res)

</code></pre>

<hr>
<h2 id='print.mixfitEM'>Print Method for Class <code>mixfitEM</code></h2><span id='topic+print.mixfitEM'></span>

<h3>Description</h3>

<p>This function is the print method for the <code>mixfitEM</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixfitEM'
print(x, digits = getOption("digits"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.mixfitEM_+3A_x">x</code></td>
<td>
<p>an object of class <code>mixfitEM</code></p>
</td></tr>
<tr><td><code id="print.mixfitEM_+3A_digits">digits</code></td>
<td>
<p>the digits to print for the values in the print output. The default
value is from the global option <code>getOption("digits")</code>.</p>
</td></tr>
<tr><td><code id="print.mixfitEM_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>print</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print.mixfitEM</code> prints the value of the parameters of a fitted mixture model, together
with some other information like the number of iterations of the EM algorithm, the loglikelihood,
the value of AIC and BIC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mixfit">mixfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rmixnormal(200, c(0.5, 0.5), c(2, 5), c(1, 0.7))
fit &lt;- mixfit(x, ncomp = 2)
print(x)

</code></pre>

<hr>
<h2 id='print.selectEM'>Print Method for Class <code>selectEM</code></h2><span id='topic+print.selectEM'></span>

<h3>Description</h3>

<p>The function prints the result of mixture model selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'selectEM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.selectEM_+3A_x">x</code></td>
<td>
<p>an object of class <code>selectEM</code></p>
</td></tr>
<tr><td><code id="print.selectEM_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>print</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>print.selectEM</code> is the print method for the class <code>selectEM</code>, which is the output
of the function <code>select</code>. It prints a data frame which contains the following information of each
candidate mixture models: the number of components, whether the variance is the same for each component
in a mixture model (only for normal), the value of BIC, and an indicator of the best model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+select">select</a></code>
</p>

<hr>
<h2 id='reinstate'>Reinstate the Binned Data to the Raw Data</h2><span id='topic+reinstate'></span>

<h3>Description</h3>

<p>This function creates a numeric vector approximating the raw data from binned data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reinstate(data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reinstate_+3A_data">data</code></td>
<td>
<p>a three-column matrix representing the raw data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>reinstate</code> creates a numeric vector by generating <code class="reqn">n_i</code>
random data from the Uniform distribution <code class="reqn">U(a_i, b_i)</code> for <code class="reqn">i = 1, \dots, r</code>
and then combine all random data together. <code class="reqn">a_i, b_i, n_i</code>
are the first, second and the third column of the matrix <code>data</code>
and <code class="reqn">r</code> is the number of bins.
It is used for enabling parameter initialization for EM algorithm when we fit mixture
models for binned data.
</p>


<h3>Value</h3>

<p>The function returns a numeric vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bin">bin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100)
data &lt;- bin(x, seq(-3, 3, 0.25))
y &lt;- reinstate(data)

</code></pre>

<hr>
<h2 id='rmixgamma'>Generating Random Data From A Gamma Mixture Model</h2><span id='topic+rmixgamma'></span>

<h3>Description</h3>

<p>The function <code>rmixgamma</code> generates random data from a Gamma mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmixgamma(n, pi, mu, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmixgamma_+3A_n">n</code></td>
<td>
<p>a positive integer specifying the number of observations we want to generate from the mixture model</p>
</td></tr>
<tr><td><code id="rmixgamma_+3A_pi">pi</code></td>
<td>
<p>a numeric vector for the proportion of each component</p>
</td></tr>
<tr><td><code id="rmixgamma_+3A_mu">mu</code></td>
<td>
<p>a numeric vector for the mean of each component</p>
</td></tr>
<tr><td><code id="rmixgamma_+3A_sd">sd</code></td>
<td>
<p>a numeric vector for the standard deviation of each component</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of random data from each component <code class="reqn">n_0</code> (a vector) is generated from a multinomial
distribution Multinom<code class="reqn">(n, pi)</code>. Then the random data from each component is generated with
the sample sized specified in <code class="reqn">n_0</code> and parameters of Gamma distributions specified in
<code>mu</code> and <code>sd</code>.
</p>


<h3>Value</h3>

<p>The function <code>rmixgamma</code> returns a numeric vector of random data from the specified Gamma mixture model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmixnormal">rmixnormal</a></code>, <code><a href="#topic+rmixweibull">rmixweibull</a></code>, <code><a href="#topic+rmixlnorm">rmixlnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rmixgamma(1000, c(0.4, 0.6), c(2, 5), c(1, 0.5))
hist(x, breaks = 40)

</code></pre>

<hr>
<h2 id='rmixlnorm'>Generating Random Data From A Lognormal Mixture Model</h2><span id='topic+rmixlnorm'></span>

<h3>Description</h3>

<p>The function <code>rmixlnorm</code> generates random data from a lognormal mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmixlnorm(n, pi, mu, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmixlnorm_+3A_n">n</code></td>
<td>
<p>a positive integer specifying the number of observations we want to generate from the mixture model</p>
</td></tr>
<tr><td><code id="rmixlnorm_+3A_pi">pi</code></td>
<td>
<p>a numeric vector for the proportion of each component</p>
</td></tr>
<tr><td><code id="rmixlnorm_+3A_mu">mu</code></td>
<td>
<p>a numeric vector for the mean of each component</p>
</td></tr>
<tr><td><code id="rmixlnorm_+3A_sd">sd</code></td>
<td>
<p>a numeric vector for the standard deviation of each component</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of random data from each component <code class="reqn">n_0</code> (a vector) is generated from a multinomial
distribution Multinom<code class="reqn">(n, pi)</code>. Then the random data from each component is generated with
the sample sized specified in <code class="reqn">n_0</code> and parameters of lognormal distributions specified in
<code>mu</code> and <code>sd</code>.
</p>


<h3>Value</h3>

<p>The function <code>rmixlnorm</code> returns a numeric vector of random data from the specified lognormal mixture model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmixnormal">rmixnormal</a></code>, <code><a href="#topic+rmixweibull">rmixweibull</a></code>, <code><a href="#topic+rmixgamma">rmixgamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rmixlnorm(1000, c(0.4, 0.6), c(2, 5), c(1, 0.5))
hist(x, breaks = 40)

</code></pre>

<hr>
<h2 id='rmixnormal'>Generating Random Data From A Normal Mixture Model</h2><span id='topic+rmixnormal'></span>

<h3>Description</h3>

<p>The function <code>rmixnormal</code> generates random data from a normal mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmixnormal(n, pi, mu, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmixnormal_+3A_n">n</code></td>
<td>
<p>a positive integer specifying the number of observations we want to generate from the mixture model</p>
</td></tr>
<tr><td><code id="rmixnormal_+3A_pi">pi</code></td>
<td>
<p>a numeric vector for the proportion of each component</p>
</td></tr>
<tr><td><code id="rmixnormal_+3A_mu">mu</code></td>
<td>
<p>a numeric vector for the mean of each component</p>
</td></tr>
<tr><td><code id="rmixnormal_+3A_sd">sd</code></td>
<td>
<p>a numeric vector for the standard deviation of each component</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of random data from each component <code class="reqn">n_0</code> (a vector) is generated from a multinomial
distribution Multinom<code class="reqn">(n, pi)</code>. Then the random data from each component is generated with
the sample sized specified in <code class="reqn">n_0</code> and parameters of normal distributions specified in
<code>mu</code> and <code>sd</code>.
</p>


<h3>Value</h3>

<p>The function <code>rmixnormal</code> returns a numeric vector of random data from the specified normal mixture model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmixweibull">rmixweibull</a></code>, <code><a href="#topic+rmixgamma">rmixgamma</a></code>, <code><a href="#topic+rmixlnorm">rmixlnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rmixnormal(1000, c(0.4, 0.6), c(2, 5), c(1, 0.5))
hist(x, breaks = 40)

</code></pre>

<hr>
<h2 id='rmixweibull'>Generating Random Data From A Weibull Mixture Model</h2><span id='topic+rmixweibull'></span>

<h3>Description</h3>

<p>The function <code>rmixweibull</code> generates random data from a normal Weibull model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmixweibull(n, pi, mu, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rmixweibull_+3A_n">n</code></td>
<td>
<p>a positive integer specifying the number of observations we want to generate from the mixture model</p>
</td></tr>
<tr><td><code id="rmixweibull_+3A_pi">pi</code></td>
<td>
<p>a numeric vector for the proportion of each component</p>
</td></tr>
<tr><td><code id="rmixweibull_+3A_mu">mu</code></td>
<td>
<p>a numeric vector for the mean of each component</p>
</td></tr>
<tr><td><code id="rmixweibull_+3A_sd">sd</code></td>
<td>
<p>a numeric vector for the standard deviation of each component</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of random data from each component <code class="reqn">n_0</code> (a vector) is generated from a multinomial
distribution Multinom<code class="reqn">(n, pi)</code>. Then the random data from each component is generated with
the sample sized specified in <code class="reqn">n_0</code> and parameters of Weibull distributions specified in
<code>mu</code> and <code>sd</code>.
</p>


<h3>Value</h3>

<p>The function <code>rmixweibull</code> returns a numeric vector of random data from the specified Weibull mixture model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmixnormal">rmixnormal</a></code>, <code><a href="#topic+rmixgamma">rmixgamma</a></code>, <code><a href="#topic+rmixlnorm">rmixlnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rmixweibull(1000, c(0.4, 0.6), c(2, 5), c(1, 0.5))
hist(x, breaks = 40)

</code></pre>

<hr>
<h2 id='select'>Finite Mixture Model Selection by Information Criterion</h2><span id='topic+select'></span>

<h3>Description</h3>

<p>This function selects the best model from a candidate of mixture models based on the
information criterion BIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select(
  x,
  ncomp,
  family = c("normal", "weibull", "gamma", "lnorm"),
  mstep.method = c("bisection", "newton"),
  init.method = c("kmeans", "hclust"),
  tol = 1e-06,
  max_iter = 500
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_+3A_x">x</code></td>
<td>
<p>a numeric vector for raw data or a three-column matrix for the binned data</p>
</td></tr>
<tr><td><code id="select_+3A_ncomp">ncomp</code></td>
<td>
<p>a vector of positive integers specifying the number of components of the candidate mixture models</p>
</td></tr>
<tr><td><code id="select_+3A_family">family</code></td>
<td>
<p>a character string specifying the family of the mixture model. It can only be
one element from <code>normal</code>, <code>weibull</code>, <code>gamma</code> or <code>lnorm</code>.</p>
</td></tr>
<tr><td><code id="select_+3A_mstep.method">mstep.method</code></td>
<td>
<p>a character string specifying the method used in M-step of the EM algorithm
when fitting weibull or gamma mixture models. It can be either <code>bisection</code> or <code>newton</code>.
The default is <code>bisection</code>.</p>
</td></tr>
<tr><td><code id="select_+3A_init.method">init.method</code></td>
<td>
<p>a character string specifying the method used for providing initial values
for the parameters for EM algorithm. It can be one of <code>kmeans</code> or <code>hclust</code>. The default is
<code>kmeans</code></p>
</td></tr>
<tr><td><code id="select_+3A_tol">tol</code></td>
<td>
<p>the tolerance for the stopping rule of EM algorithm. It is the value to stop EM algorithm when the two
consecutive iterations produces loglikelihood with difference less than <code>tol</code>. The default value is 1e-6.</p>
</td></tr>
<tr><td><code id="select_+3A_max_iter">max_iter</code></td>
<td>
<p>the maximum number of iterations for the EM algorithm (default 500).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By specifying different number of components, the function <code>select</code> fits a series
of mixture models for a given family, and a mixture model with minimum value of BIC
is regarded as the best.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>selectEM</code> which contains the following items.
</p>
<table role = "presentation">
<tr><td><code>ncomp</code></td>
<td>
<p>the specified number of components of the candidate mixture models</p>
</td></tr>
<tr><td><code>equal.var</code></td>
<td>
<p>a logical vector indicating whether the variances of each component in each mixture model
are constrained to be the same (only for <code>normal</code> family)</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>the value of BIC for each mixture model</p>
</td></tr>
<tr><td><code>best</code></td>
<td>
<p>an indicator of the best model</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the family of the mixture model</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.selectEM">plot.selectEM</a></code>, <code><a href="#topic+bs.test">bs.test</a></code>, <code><a href="#topic+mixfit">mixfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## selecting the optimal normal mixture model by BIC
set.seed(105)
x &lt;- rmixnormal(1000, c(0.3, 0.4, 0.3), c(-4, 0, 4), c(1, 1, 1))
hist(x, breaks = 40)
ret &lt;- select(x, ncomp = 2:5)
## [1] "The final model: normal mixture (equal variance) with 3 components"

## (not run) selecting the optimal Weibull mixture model by BIC
## set.seed(106)
## x &lt;- rmixweibull(1000, c(0.3, 0.4, 0.3), c(2, 5, 8), c(0.7, 0.6, 1))
## ret &lt;- select(x, ncomp = 2:5, family = "weibull")
## [1] "The final model: weibull mixture with 3 components"

## (not run) selecting the optimal Gamma mixture model by BIC
## set.seed(107)
## x &lt;- rmixgamma(1000, c(0.3, 0.7), c(2, 5), c(0.7, 1))
## ret &lt;- select(x, ncomp = 2:5, family = "gamma")
## [1] "The final model: gamma mixture with 2 components"


## (not run) selecting the optimal lognormal mixture model by BIC
## set.seed(108)
## x &lt;- rmixlnorm(1000, c(0.2, 0.3, 0.2, 0.3), c(4, 7, 9, 12), c(1, 0.5, 0.7, 1))
## ret &lt;- select(x, ncomp = 2:6, family = "lnorm")
## [1] "The final model: lnorm mixture with 4 components"

</code></pre>

<hr>
<h2 id='Stamp'>1872 Hidalgo Stamp Data</h2><span id='topic+Stamp'></span>

<h3>Description</h3>

<p>A vector containing the 1872 Hidalgo stamp data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Stamp
</code></pre>


<h3>Format</h3>

<p>A vector with 485 measurements of the thickness (nm) of the stamps
</p>


<h3>References</h3>

<p>Izenman, A. J. and Sommer, C. J. Philatelic mixtures and multimodal densities.
<em>Journal of the American Statistical association</em>, 83(404):941-953, 1988.
</p>

<hr>
<h2 id='Stamp2'>1872 Hidalgo Stamp Data (Binned)</h2><span id='topic+Stamp2'></span>

<h3>Description</h3>

<p>A dataset containing the 1872 Hidalgo stamp data in the form of binned data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Stamp2
</code></pre>


<h3>Format</h3>

<p>A matrix with 62 rows and 3 columns:
</p>

<dl>
<dt>lower</dt><dd><p>the lower bin values</p>
</dd>
<dt>upper</dt><dd><p>the upper bin values</p>
</dd>
<dt>freq</dt><dd><p>the number of observations in each bin</p>
</dd>
</dl>


<hr>
<h2 id='to_k_lambda_weibull'>Parameter Conversion for Weibull Distribution</h2><span id='topic+to_k_lambda_weibull'></span>

<h3>Description</h3>

<p>The function <code>to_k_lambda_weibull</code> converts the mean and standard deviation to the shape and scale for
the Weibull distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_k_lambda_weibull(mu, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_k_lambda_weibull_+3A_mu">mu</code></td>
<td>
<p>a numeric vector representing the means of Weibull distributions</p>
</td></tr>
<tr><td><code id="to_k_lambda_weibull_+3A_sd">sd</code></td>
<td>
<p>a numeric vector representing the standard deviations of Weibull distributions.
<code>mu</code> and <code>sd</code> should have the same length.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpose of this function is to convert the parameterization of Weibull distribution in the form of
mean and standard deviation to the form of shape and scale. It can be used for specifying the initial
values for the EM algorithm when the first-hand initial values are in the form of mean and standard
deviation from K-means clustering algorithm.
</p>


<h3>Value</h3>

<p>a list of two items
</p>
<table role = "presentation">
<tr><td><code>k</code></td>
<td>
<p>a vector of the shapes of Weibull distributions</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>a vector of the scales of Weibull distributions</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+to_mu_sd_weibull">to_mu_sd_weibull</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>to_k_lambda_weibull(2, 1)
to_k_lambda_weibull(c(2, 5), c(1, 0.7))

</code></pre>

<hr>
<h2 id='to_mu_sd_gamma'>Parameter Conversion for Gamma Distribution</h2><span id='topic+to_mu_sd_gamma'></span>

<h3>Description</h3>

<p>The function <code>to_mu_sd_gamma</code> converts the shape and rate to the mean and standard deviation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_mu_sd_gamma(alpha, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_mu_sd_gamma_+3A_alpha">alpha</code></td>
<td>
<p>a numeric vector representing the shape of one or more than one gamma distributions</p>
</td></tr>
<tr><td><code id="to_mu_sd_gamma_+3A_lambda">lambda</code></td>
<td>
<p>a numeric vector representing the rate of one or more than one gamma distributions.
<code>alpha</code> and <code>lambda</code> should have the same length.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpose of this function is to convert the parameterization of gamma distribution in the form of
shape and rate to the form of mean and standard deviation.
</p>


<h3>Value</h3>

<p>a list of two items
</p>
<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>a vector of the means of gamma distributions</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>a vector of the standard deviations of gamma distributions</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+to_shape_rate_gamma">to_shape_rate_gamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>to_mu_sd_gamma(2, 1)
to_mu_sd_gamma(c(2, 4), c(1, 1))

</code></pre>

<hr>
<h2 id='to_mu_sd_lnorm'>Parameter Conversion for Lognormal Distribution</h2><span id='topic+to_mu_sd_lnorm'></span>

<h3>Description</h3>

<p>The function <code>to_mu_sd_lnorm</code> converts the logarithm mean and logarithm standard deviation to the
mean and standard deviation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_mu_sd_lnorm(mulog, sdlog)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_mu_sd_lnorm_+3A_mulog">mulog</code></td>
<td>
<p>a vector of logarithm means of lognormal distributions</p>
</td></tr>
<tr><td><code id="to_mu_sd_lnorm_+3A_sdlog">sdlog</code></td>
<td>
<p>a vector of logarithm standard deviations of lognormal distributions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpose of this function is to convert the parameterization of lognormal distribution in the
form of logarithm mean and logarithm standard deviation to the form of mean and standard deviation.
</p>


<h3>Value</h3>

<p>a list of two items
</p>
<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>a vector of the means of lognormal distributions</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>a vector of the standard deviations of lognormal distributions</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+to_mulog_sdlog_lnorm">to_mulog_sdlog_lnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>to_mu_sd_lnorm(2, 1)
to_mu_sd_lnorm(c(2, 4), c(1, 1))

</code></pre>

<hr>
<h2 id='to_mu_sd_weibull'>Parameter Conversion for Weibull Distribution</h2><span id='topic+to_mu_sd_weibull'></span>

<h3>Description</h3>

<p>The function <code>to_mu_sd_weibull</code> converts the parameters of shape and scale of weibull distributions to
the parameters of the mean and standard deviation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_mu_sd_weibull(k, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_mu_sd_weibull_+3A_k">k</code></td>
<td>
<p>a numeric vector representing the shape of a series of Weibull distributions</p>
</td></tr>
<tr><td><code id="to_mu_sd_weibull_+3A_lambda">lambda</code></td>
<td>
<p>a numeric vector representing the scale of a series of Weibull distributions.
<code>k</code> and <code>lambda</code> should have the same length.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpose of this function is to convert the parameterization of Weibull distribution in the form of
shape and scale to the form of mean and standard deviation.
</p>


<h3>Value</h3>

<p>a list of two items
</p>
<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>a vector of the means of Weibull distributions</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>a vector of the standard deviations of Weibull distributions</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+to_k_lambda_weibull">to_k_lambda_weibull</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>to_mu_sd_weibull(2, 1)
to_mu_sd_weibull(c(2, 4), c(1, 1))

</code></pre>

<hr>
<h2 id='to_mulog_sdlog_lnorm'>Parameter Conversion for Lognormal Distribution</h2><span id='topic+to_mulog_sdlog_lnorm'></span>

<h3>Description</h3>

<p>The function <code>to_mulog_sdlog_lnorm</code> converts the mean and standard deviation to
the logarithm mean and logarithm standard deviation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_mulog_sdlog_lnorm(mu, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_mulog_sdlog_lnorm_+3A_mu">mu</code></td>
<td>
<p>a vector of means of lognormal distributions</p>
</td></tr>
<tr><td><code id="to_mulog_sdlog_lnorm_+3A_sd">sd</code></td>
<td>
<p>a vector of standard deviations of lognormal distributions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpose of this function is to convert the parameterization of lognormal distribution in the
form of mean and standard deviation to the form of logarithm mean and logarithm standard deviation.
It can be used for specifying the initial values for the EM algorithm when the first-hand initial values
are in the form of mean and standard deviation from K-means clustering algorithm.
</p>


<h3>Value</h3>

<p>a list of two items
</p>
<table role = "presentation">
<tr><td><code>mulog</code></td>
<td>
<p>a vector of lognormal means of lognormal distributions</p>
</td></tr>
<tr><td><code>sdlog</code></td>
<td>
<p>a vector of lognormal standard deviations of lognormal distributions</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+to_mu_sd_lnorm">to_mu_sd_lnorm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>to_mulog_sdlog_lnorm(2, 1)
to_mulog_sdlog_lnorm(c(2, 4), c(1, 1))

</code></pre>

<hr>
<h2 id='to_shape_rate_gamma'>Parameter Conversion for Gamma Distribution</h2><span id='topic+to_shape_rate_gamma'></span>

<h3>Description</h3>

<p>The function <code>to_shape_rate_gamma</code> converts the mean and standard deviation to the shape and rate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_shape_rate_gamma(mu, sd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_shape_rate_gamma_+3A_mu">mu</code></td>
<td>
<p>a numeric vector representing the means of gamma distributions</p>
</td></tr>
<tr><td><code id="to_shape_rate_gamma_+3A_sd">sd</code></td>
<td>
<p>a numeric vector representing the standard deviations of gamma distributions.
<code>mu</code> and <code>sd</code> should have the same length.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpose of this function is to convert the parameterization of gamma distribution in the form of
mean and standard deviation to the form of shape and rate. It can be used for specifying the initial
values for the EM algorithm when the first-hand initial values are in the form of mean and standard
deviation from K-means clustering algorithm.
</p>


<h3>Value</h3>

<p>a list of two items
</p>
<table role = "presentation">
<tr><td><code>alpha</code></td>
<td>
<p>a vector of the shapes of gamma distributions</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>a vector of the rates of gamma distributions</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+to_mu_sd_gamma">to_mu_sd_gamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>to_shape_rate_gamma(2, 1)
to_shape_rate_gamma(c(2, 4), c(1, 1))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
