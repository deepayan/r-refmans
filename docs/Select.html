<!DOCTYPE html><html><head><title>Help for package Select</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Select}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pineforest'><p>Functional trait data for understory species in ponderosa pine forest</p></a></li>
<li><a href='#plotProbs'><p>Plots results from the selectSpecies function</p></a></li>
<li><a href='#Select'><p>Select: Determines Species Probabilities Based on Functional Traits</p></a></li>
<li><a href='#selectSpecies'><p>Select species based on traits</p></a></li>
<li><a href='#serpentine'><p>Functional trait data for species in serpentine grassland</p></a></li>
<li><a href='#tropicalforest'><p>Functional trait data for tree species in tropical forest</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Determines Species Probabilities Based on Functional Traits</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4</td>
</tr>
<tr>
<td>Description:</td>
<td>The objective of these functions is to derive a species assemblage
    that satisfies a functional trait profile. Restoring resilient ecosystems
    requires a flexible framework for selecting assemblages that are based on the
    functional traits of species. However, current trait-based models have been
    limited to algorithms that can only select species by optimising specific trait
    values, and could not elegantly accommodate the common desire among restoration
    ecologists to produce functionally diverse assemblages. We have solved this
    problem by applying a non-linear optimisation algorithm that optimises Rao Q,
    a closed-form functional trait diversity index that incorporates species
    abundances, subject to other linear constraints. This framework generalises
    previous models that only optimised the entropy of the community, and can
    optimise both functional diversity and entropy simultaneously. This package
    can also be used to generate experimental assemblages to test the effects
    of community-level traits on community dynamics and ecosystem function. The
    method is based on theory discussed in Laughlin (2014, Ecology Letters)
    &lt;doi.org/10.1111/ele.12288&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rsolnp, latticeExtra, grDevices, stats, lattice, graphics,
ade4, FD</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-11 15:48:58 UTC; danielclaughlin</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Laughlin [cre, aut],
  Loic Chalmandrier [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Laughlin &lt;danielclaughlin@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-11 16:23:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='pineforest'>Functional trait data for understory species in ponderosa pine forest</h2><span id='topic+pineforest'></span>

<h3>Description</h3>

<p>A dataset containing two traits for species in a pine forest.
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pineforest)
</code></pre>


<h3>Format</h3>

<p>dataframe of 46 species and 2 traits</p>


<h3>Details</h3>


<ul>
<li><p> species. species name
</p>
</li>
<li><p> flrdate. average flowering date in day of year
</p>
</li>
<li><p> leafcn. average leaf carbon-to-nitrogen ratio
</p>
</li></ul>



<h3>Source</h3>

<p>Laughlin, D.C., J.J. Leppert, M.M. Moore, and C.H. Sieg. 2010. A multi-trait test of the leaf-height-seed plant strategy scheme with 133 species from a pine forest flora. Functional Ecology 24:493-501.
</p>

<hr>
<h2 id='plotProbs'>Plots results from the selectSpecies function</h2><span id='topic+plotProbs'></span>

<h3>Description</h3>

<p>This function plots results (species probabilities/optimum solutions) from the selectSpecies() function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotProbs(result, traits, colors = c("lightblue", "blue"), xlim = NULL,
  ylim = NULL, xlab = NULL, ylab = NULL, zlab = "Probability",
  distance = 0.3, cex.lab = 1.5, box.col = "transparent", xbase = 0.5,
  ybase = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotProbs_+3A_result">result</code></td>
<td>
<p>A saved object from function selectSpecies()</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_traits">traits</code></td>
<td>
<p>A matrix of trait values where traits are columns and rows are species. If one trait is provided, then the function creates a 2D barplot of probabilities for each species. If two traits are provided, then the function creates a 3D barplot that illustrates probabilities of species located within a 2D trait space.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_colors">colors</code></td>
<td>
<p>An optional vector of colors for plotting that must include at least two valid color names. The default color scheme is a ramp palette of lightblue to blue.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_xlim">xlim</code></td>
<td>
<p>Vector of two numbers denoting limits on x-axis.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_ylim">ylim</code></td>
<td>
<p>Vector of two numbers denoting limits on y-axis.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_xlab">xlab</code></td>
<td>
<p>Character string to describe x-axis.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_ylab">ylab</code></td>
<td>
<p>Character string to describe y-axis.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_zlab">zlab</code></td>
<td>
<p>Character string to describe z-axis. The default axis names is &quot;Probabilities&quot;.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_distance">distance</code></td>
<td>
<p>An optional number denoting distance between bars in 3d plot.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_cex.lab">cex.lab</code></td>
<td>
<p>An optional number denoting the size of the labels. The default is set to 1.5.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_box.col">box.col</code></td>
<td>
<p>An optional setting for the color of the box. The default setting is transparent.</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_xbase">xbase</code></td>
<td>
<p>The length of the base of each 3d bar along the x-axis</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_ybase">ybase</code></td>
<td>
<p>The length of the base of each 3d bar along the y-axis</p>
</td></tr>
<tr><td><code id="plotProbs_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to barplot() or lattice::cloud()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>2D barplot of probabilities for each species or 3D barplot that illustrates probabilities of species located within a 2D trait space
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### 1 trait constraint with maximum functional diversity and entropy
Spp &lt;- 5 #S = number of species
trait &lt;- as.matrix(data.frame(trait=c(1:Spp)))
rownames(trait) &lt;- c(letters[1:nrow(trait)])
result1 &lt;- selectSpecies(t2c=trait, constraints=c(3.5), t2d=trait, obj="QH", capd=FALSE)
plotProbs(result1,trait, xlab="Trait")

##### 2 traits: Constrain trait X to value 2.5, diversify trait Y
traitX &lt;- matrix(c(rep(1,3),rep(2,3),rep(3,3)))
traitY &lt;- matrix(c(rep(c(1,2,3),3)))
rownames(traitX) &lt;- c(letters[1:9]); colnames(traitX) &lt;- c("traitX")
rownames(traitY) &lt;- c(letters[1:9]); colnames(traitY) &lt;- c("traitY")
result2 &lt;- selectSpecies(t2c=traitX,constraints=c(traitX=2.5),t2d=traitY,capd=TRUE,obj="QH")
plotProbs(result2,traits = cbind(traitX, traitY))
</code></pre>

<hr>
<h2 id='Select'>Select: Determines Species Probabilities Based on Functional Traits</h2><span id='topic+Select'></span><span id='topic+Select-package'></span>

<h3>Description</h3>

<p>This package determines species probabilities (i.e., relative abundances)
that satisfy a given functional trait profile. Restoring resilient ecosystems
requires a flexible framework for selecting assemblages that are based on the
functional traits of species. However, current trait-based models have been
limited to algorithms that can only select species by optimising specific trait
values, and could not elegantly accommodate the common desire among restoration
ecologists to produce functionally diverse assemblages. We have solved this
problem by applying a non-linear optimisation algorithm that optimises Rao Q,
a closed-form functional trait diversity index that incorporates species
abundances, subject to other linear constraints. This framework generalises
previous models that only optimised the entropy of the community, and can
optimise both functional diversity and entropy simultaneously.
</p>


<h3>Details</h3>

<p>The Select package has two functions:
</p>


<h3>Select functions</h3>

<p>The selectSpecies() function is used to generate species assemblages
(relative abundances/probabilities) based on a functional trait profile.
The function can constrain the abundances to conform to certain average trait values,
and it can simultanesouly optimize functional diveristy.
</p>
<p>The plotProbs() function plots the resulting species abundances (probabilities)
using the resulting object from the selectSpecies() function.
</p>

<hr>
<h2 id='selectSpecies'>Select species based on traits</h2><span id='topic+selectSpecies'></span>

<h3>Description</h3>

<p>This function returns a probability distribution for a species pool based on their traits and a desired trait profile (Laughlin 2014). It can simultaneously constrain specific trait value(s) and optimise functional diversity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectSpecies(t2c = NULL, constraints = NULL, t2d, obj = c("QH", "Q",
  "H"), phi = 0.5, capd = FALSE, euclid = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selectSpecies_+3A_t2c">t2c</code></td>
<td>
<p>&quot;Traits to constrain&quot;: A matrix of species trait values, where species are organized as rows and traits as columns. These should be numeric arrays, and no missing values are tolerated. Ordinal data will yield meaningful results, but nominal data entered as numeric vectors are invalid. Row and column names are optional. This matrix can be any dimension, but the number of traits should be less than the number of species.</p>
</td></tr>
<tr><td><code id="selectSpecies_+3A_constraints">constraints</code></td>
<td>
<p>Trait constraints: A vector of trait values that serve as constants in the constraint equations. If not specified, the function will not constrain solutions to trait means. These trait contraints must be listed in the same order as columns in t2c. These constraints are community-weighted mean trait values, i.e., average traits weighted by the relative abundance of each species.</p>
</td></tr>
<tr><td><code id="selectSpecies_+3A_t2d">t2d</code></td>
<td>
<p>&quot;Traits to diversify&quot;: Can be 1) a matrix of species trait values to diversify where species are organized as rows and traits as columns. NAs are tolerated as long as each pair of species can be compared by at least one trait. In this case, dissimilarities among species are computed using Euclidean distance. The number of species in t2d must match those in t2c. Or 2) a distance matrix of class 'dist' that contains dissimilarities among species, no NAs are tolerated in the distance matrix.</p>
</td></tr>
<tr><td><code id="selectSpecies_+3A_obj">obj</code></td>
<td>
<p>Objective function: The objective function to optimise, one of three possibilities = c(&quot;QH&quot;, &quot;Q&quot;, &quot;H&quot;). QH = Quadratic entropy (Q) plus entropy (H'); Q = Quadratic entropy; H = entropy.</p>
</td></tr>
<tr><td><code id="selectSpecies_+3A_phi">phi</code></td>
<td>
<p>A parameter bounded between 0 and 1 that weights the importance of either quadratic entropy or entropy (default = 0.5). Phi of 1 corresponds to 100 percent Q, phi of 0.5 corresponds to 50 percent Q and 50 perfect H', phi of 0 corresponds to 100 percent H'.</p>
</td></tr>
<tr><td><code id="selectSpecies_+3A_capd">capd</code></td>
<td>
<p>A logical stating whether the distance matrix should be capped at the mean distance among species (default = FALSE). Mean distance is calculated as the average of all upper triangular entries in the distance matrix calculated from t2d.</p>
</td></tr>
<tr><td><code id="selectSpecies_+3A_euclid">euclid</code></td>
<td>
<p>A logical stating whether the distance matrix should be transformed to an Euclidean matrix if necessary (default = TRUE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements: </p>
<table>
<tr><td><code>prob</code></td>
<td>
<p>Probabilities, i.e. optimal solutions of species relative abundance</p>
</td></tr> <tr><td><code>cwm_t2d</code></td>
<td>
<p>Community-weighted mean trait values of resulting community for traits that were diversified, computed as probabilities x t2d using matrix multiplication</p>
</td></tr> <tr><td><code>cwm_t2c</code></td>
<td>
<p>Community-weighted mean trait values of resulting community for traits that were constrained, computed as probabilities x t2d using matrix multiplication</p>
</td></tr> <tr><td><code>H</code></td>
<td>
<p>Final entropy of community</p>
</td></tr> <tr><td><code>Q</code></td>
<td>
<p>Final Rao Q of community</p>
</td></tr> <tr><td><code>objval</code></td>
<td>
<p>Values of the objective function being maximized. The last value is the maximum.</p>
</td></tr> <tr><td><code>lagrange</code></td>
<td>
<p>Lagrange multipliers.</p>
</td></tr> <tr><td><code>hessian</code></td>
<td>
<p>The Hessian at the optimal solution.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Laughlin, D.C. 2014. Applying trait-based models to achieve functional targets for theory-driven ecological restoration. Ecology Letters, 17, 771-784.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### 1 trait constraint with maximum entropy
Spp &lt;- 5 #S = number of species
trait &lt;- as.matrix(data.frame(trait=c(1:Spp)))
rownames(trait) &lt;- c(letters[1:nrow(trait)])
result1 &lt;- selectSpecies(t2c=trait, constraints=c(trait=3.5), t2d=trait, obj="H", capd=FALSE)
### compare result1 with virtually identical maxent output from FD package
#FD::maxent(constr=c(3.5),states=trait)$prob
### 1 trait constraint with maximum functional diversity
result2 &lt;- selectSpecies(t2c=trait, constraints=c(trait=3.5), t2d=trait, obj="Q", capd=FALSE)
### 1 trait constraint with maximum functional diversity and entropy
result3 &lt;- selectSpecies(t2c=trait, constraints=c(trait=3.5), t2d=trait, obj="QH", capd=FALSE)

### Plot results
plotProbs(result1,trait, xlab="Trait")
plotProbs(result2,trait, xlab="Trait")
plotProbs(result3,trait, xlab="Trait")

### 1 trait and no trait constraint
result4 &lt;- selectSpecies(t2d=trait, obj="QH", capd=FALSE)
plotProbs(result4,trait, xlab="Trait")

##### 2 traits: Constrain trait X at X=3, diversify trait Y
traitX &lt;- matrix(c(rep(1,4),rep(2,4),rep(3,4),rep(4,4)))
traitY &lt;- matrix(c(rep(c(1,2,3,4),4)))
rownames(traitX) &lt;- c(letters[1:16]); colnames(traitX) &lt;- c("traitX")
rownames(traitY) &lt;- c(letters[1:16]); colnames(traitY) &lt;- c("traitY")

result5 &lt;- selectSpecies(t2c=traitX,constraints=c(traitX=3),t2d=traitY,obj="Q",capd=FALSE)
result6 &lt;- selectSpecies(t2c=traitX,constraints=c(traitX=3),t2d=traitY,obj="QH",capd=TRUE)

trait.matrix &lt;- cbind(traitX, traitY)
plotProbs(result5,trait.matrix)
plotProbs(result6,trait.matrix)

##### 3 traits: Constrain trait Z to value 2.5, diversify trait X and Y
traitZ &lt;- as.matrix(data.frame(c(1,3,2,2,3,1,2,3,1,2,1,3,2,3,2,2)))
rownames(traitZ) &lt;- c(letters[1:16]); colnames(traitZ) &lt;- c("traitZ")
result7 &lt;- selectSpecies(t2c=traitZ,constraints=c(traitZ=2.5),t2d=trait.matrix, capd=TRUE, obj="QH")
plotProbs(result7,trait.matrix)

</code></pre>

<hr>
<h2 id='serpentine'>Functional trait data for species in serpentine grassland</h2><span id='topic+serpentine'></span>

<h3>Description</h3>

<p>A dataset containing two traits for species in a serpentine grassland.
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(serpentine)
</code></pre>


<h3>Format</h3>

<p>dataframe of 48 species and 2 traits</p>


<h3>Details</h3>


<ul>
<li><p> species. species name
</p>
</li>
<li><p> wue. average water use efficiency, rate of carbon assimilation per unit of water used
</p>
</li>
<li><p> rootdepth. average rooting depth in soil
</p>
</li></ul>



<h3>Source</h3>

<p>Funk, J.L. &amp; Wolf, A.A. 2016. Testing the trait based community framework: Do functional traits predict competitive outcomes? Ecology 97:2206-2211.
</p>

<hr>
<h2 id='tropicalforest'>Functional trait data for tree species in tropical forest</h2><span id='topic+tropicalforest'></span>

<h3>Description</h3>

<p>A dataset containing two traits for species in a tropical forest.
The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tropicalforest)
</code></pre>


<h3>Format</h3>

<p>dataframe of 41 species and 2 traits</p>


<h3>Details</h3>


<ul>
<li><p> species. species name
</p>
</li>
<li><p> sla. specific leaf area
</p>
</li>
<li><p> wd. wood density
</p>
</li></ul>



<h3>Source</h3>

<p>McCarthy, James K. 2018. Predicting the diversity and functional composition of woody plant communities under climate change PhD Thesis, School of Biological Sciences, The University of Queensland. Advisor: Dr. John Dwyer. doi:10.14264/uql.2018.134
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
