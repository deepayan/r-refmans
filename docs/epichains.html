<!DOCTYPE html><html lang="en-GB"><head><title>Help for package epichains</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {epichains}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#epichains-package'><p>epichains: Simulating and Analysing Transmission Chain Statistics Using Branching Process Models</p></a></li>
<li><a href='#.adjust_next_gen'><p>Adjust new offspring if it exceeds the susceptible population size</p></a></li>
<li><a href='#.check_generation_time_valid'><p>Check if the generation_time argument is specified as a function</p></a></li>
<li><a href='#.check_offspring_func_valid'><p>Check if constructed random number generator for offspring exists</p>
and has an <code>n</code> argument.</a></li>
<li><a href='#.check_sim_args'><p>Check inputs to <code>simulate_chains()</code> and <code>simulate_summary()</code></p></a></li>
<li><a href='#.check_statistic_args'><p>Check that the <code>statistic</code> and <code>stat_threshold</code> arguments are valid</p></a></li>
<li><a href='#.check_time_args'><p>Check inputs that control time events</p></a></li>
<li><a href='#.complementary_logprob'><p>Calculates the complementary log-probability</p></a></li>
<li><a href='#.epichains'><p>Create an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object</p></a></li>
<li><a href='#.epichains_summary'><p>Create an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object</p></a></li>
<li><a href='#.gborel_size_ll'><p>Log-likelihood of the size of chains with gamma-Borel offspring distribution</p></a></li>
<li><a href='#.geom_length_ll'><p>Log-likelihood of the length of chains with geometric offspring distribution</p></a></li>
<li><a href='#.get_statistic_func'><p>Return a function for calculating chain statistics</p></a></li>
<li><a href='#.get_susceptible_offspring'><p>Sample the number of susceptible offspring from all possible offspring</p></a></li>
<li><a href='#.init_susc_pop'><p>Adjust next generation vector to match susceptible population size</p></a></li>
<li><a href='#.is_epichains'><p>Test if x is an <code>epichains</code> object</p></a></li>
<li><a href='#.is_epichains_summary'><p>Test if x is an <code>epichains_summary</code> object</p></a></li>
<li><a href='#.nbinom_size_ll'><p>Log-likelihood of the size of chains with Negative-Binomial offspring</p>
distribution</a></li>
<li><a href='#.new_epichains'><p>Construct an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object</p></a></li>
<li><a href='#.new_epichains_summary'><p>Construct a <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object</p></a></li>
<li><a href='#.offspring_ll'><p>Log-likelihood of the summary (size/length) of chains with generic offspring</p>
distribution</a></li>
<li><a href='#.pois_length_ll'><p>Log-likelihood of the length of chains with Poisson offspring distribution</p></a></li>
<li><a href='#.pois_size_ll'><p>Log-likelihood of the size of chains with Poisson offspring distribution</p></a></li>
<li><a href='#.rbinom_size'><p>Samples size (the number of trials) of a binomial distribution</p></a></li>
<li><a href='#.rgen_length'><p>Samples chain lengths with given observation probabilities</p></a></li>
<li><a href='#.sample_possible_offspring'><p>Sample all possible offspring for the next generation</p></a></li>
<li><a href='#.update_chain_stat'><p>Determine and update the chain statistic being tracked</p></a></li>
<li><a href='#.validate_epichains'><p>Validate an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object</p></a></li>
<li><a href='#.validate_epichains_summary'><p>Validate an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object</p></a></li>
<li><a href='#aggregate.epichains'><p>Aggregate cases in <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> objects by &quot;generation&quot; or &quot;time&quot;, if</p>
present</a></li>
<li><a href='#covid19_sa'><p>COVID-19 Data Repository for South Africa</p></a></li>
<li><a href='#dborel'><p>Density of the Borel distribution</p></a></li>
<li><a href='#head.epichains'><p><code>head</code> and <code>tail</code> method for <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> class</p></a></li>
<li><a href='#likelihood'><p>Estimate the log-likelihood/likelihood for observed branching processes</p></a></li>
<li><a href='#print.epichains'><p>Print an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object</p></a></li>
<li><a href='#print.epichains_summary'><p>Print an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object</p></a></li>
<li><a href='#rborel'><p>Generate random numbers from the Borel distribution</p></a></li>
<li><a href='#rgborel'><p>Generate random numbers from a Gamma-Borel mixture distribution</p></a></li>
<li><a href='#simulate_chain_stats'><p>Simulate a vector of transmission chains statistics (sizes/lengths)</p></a></li>
<li><a href='#simulate_chains'><p>Simulate transmission chains</p></a></li>
<li><a href='#summary.epichains'><p>Summary method for <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> class</p></a></li>
<li><a href='#summary.epichains_summary'><p>Summary method for <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Simulating and Analysing Transmission Chain Statistics Using
Branching Process Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides methods to simulate and analyse the size and length
    of branching processes with an arbitrary offspring distribution. These
    can be used, for example, to analyse the distribution of chain sizes
    or length of infectious disease outbreaks, as discussed in Farrington
    et al. (2003) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2F4.2.279">doi:10.1093/biostatistics/4.2.279</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/epiverse-trace/epichains">https://github.com/epiverse-trace/epichains</a>,
<a href="https://epiverse-trace.github.io/epichains/">https://epiverse-trace.github.io/epichains/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/epiverse-trace/epichains/issues">https://github.com/epiverse-trace/epichains/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bookdown, dplyr, epicontacts, ggplot2, knitr, lubridate,
rmarkdown, spelling, testthat, truncdist</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>epiverse-trace/epiversetheme</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2.9000</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-09 11:53:58 UTC; lshja16</td>
</tr>
<tr>
<td>Author:</td>
<td>James M. Azam <a href="https://orcid.org/0000-0001-5782-7330"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Sebastian Funk <a href="https://orcid.org/0000-0002-2842-3406"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cph],
  Flavio Finger <a href="https://orcid.org/0000-0002-8613-5170"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Zhian N. Kamvar <a href="https://orcid.org/0000-0003-1458-7108"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Hugo Gruson <a href="https://orcid.org/0000-0002-4094-1476"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb,
    rev],
  Karim Mané <a href="https://orcid.org/0000-0002-9892-2999"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [rev],
  Pratik Gupte <a href="https://orcid.org/0000-0001-5294-7819"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev],
  Joshua W. Lambert <a href="https://orcid.org/0000-0001-5218-3046"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [rev]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James M. Azam &lt;james.azam@lshtm.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-14 09:20:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='epichains-package'>epichains: Simulating and Analysing Transmission Chain Statistics Using Branching Process Models</h2><span id='topic+epichains'></span><span id='topic+epichains-package'></span>

<h3>Description</h3>

<p>Provides methods to simulate and analyse the size and length of branching processes with an arbitrary offspring distribution. These can be used, for example, to analyse the distribution of chain sizes or length of infectious disease outbreaks, as discussed in Farrington et al. (2003) <a href="https://doi.org/10.1093/biostatistics/4.2.279">doi:10.1093/biostatistics/4.2.279</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: James M. Azam <a href="mailto:james.azam@lshtm.ac.uk">james.azam@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5782-7330">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Sebastian Funk <a href="mailto:sebastian.funk@lshtm.ac.uk">sebastian.funk@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0002-2842-3406">ORCID</a>) [copyright holder]
</p>
</li>
<li><p> Flavio Finger <a href="mailto:flavio.finger@epicentre.msf.org">flavio.finger@epicentre.msf.org</a> (<a href="https://orcid.org/0000-0002-8613-5170">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Zhian N. Kamvar <a href="mailto:zkamvar@gmail.com">zkamvar@gmail.com</a> (<a href="https://orcid.org/0000-0003-1458-7108">ORCID</a>) [contributor]
</p>
</li>
<li><p> Hugo Gruson <a href="mailto:hugo@data.org">hugo@data.org</a> (<a href="https://orcid.org/0000-0002-4094-1476">ORCID</a>) [contributor, reviewer]
</p>
</li>
<li><p> Karim Mané <a href="mailto:karim.mane@lshtm.ac.uk">karim.mane@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0002-9892-2999">ORCID</a>) [reviewer]
</p>
</li>
<li><p> Pratik Gupte <a href="mailto:pratik.gupte@lshtm.ac.uk">pratik.gupte@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5294-7819">ORCID</a>) [reviewer]
</p>
</li>
<li><p> Joshua W. Lambert <a href="mailto:joshua.lambert@lshtm.ac.uk">joshua.lambert@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5218-3046">ORCID</a>) [reviewer]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/epiverse-trace/epichains">https://github.com/epiverse-trace/epichains</a>
</p>
</li>
<li> <p><a href="https://epiverse-trace.github.io/epichains/">https://epiverse-trace.github.io/epichains/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/epiverse-trace/epichains/issues">https://github.com/epiverse-trace/epichains/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.adjust_next_gen'>Adjust new offspring if it exceeds the susceptible population size</h2><span id='topic+.adjust_next_gen'></span>

<h3>Description</h3>

<p>This function is used internally, and input checking is not
performed here, only in the context where it is used. Using it directly
is not recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.adjust_next_gen(next_gen, susc_pop)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".adjust_next_gen_+3A_next_gen">next_gen</code></td>
<td>
<p>A numeric vector of next generation offspring.</p>
</td></tr>
<tr><td><code id=".adjust_next_gen_+3A_susc_pop">susc_pop</code></td>
<td>
<p>The susceptible population size; A number coercible to
integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of the adjusted next generation offspring.
</p>

<hr>
<h2 id='.check_generation_time_valid'>Check if the generation_time argument is specified as a function</h2><span id='topic+.check_generation_time_valid'></span>

<h3>Description</h3>

<p>Check if the generation_time argument is specified as a function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.check_generation_time_valid(generation_time)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".check_generation_time_valid_+3A_generation_time">generation_time</code></td>
<td>
<p>The generation time function; the name
of a user-defined named or anonymous function with only one argument <code>n</code>,
representing the number of generation times to sample.</p>
</td></tr>
</table>

<hr>
<h2 id='.check_offspring_func_valid'>Check if constructed random number generator for offspring exists
and has an <code>n</code> argument.</h2><span id='topic+.check_offspring_func_valid'></span>

<h3>Description</h3>

<p>Check if constructed random number generator for offspring exists
and has an <code>n</code> argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.check_offspring_func_valid(offspring_dist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".check_offspring_func_valid_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
</table>

<hr>
<h2 id='.check_sim_args'>Check inputs to <code>simulate_chains()</code> and <code>simulate_summary()</code></h2><span id='topic+.check_sim_args'></span>

<h3>Description</h3>

<p>Check inputs to <code>simulate_chains()</code> and <code>simulate_summary()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.check_sim_args(
  n_chains,
  statistic,
  offspring_dist,
  stat_threshold,
  pop,
  percent_immune
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".check_sim_args_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of chains to simulate.</p>
</td></tr>
<tr><td><code id=".check_sim_args_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id=".check_sim_args_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
<tr><td><code id=".check_sim_args_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A stopping criterion for individual chain simulations;
a positive number coercible to integer. When any chain's cumulative statistic
reaches or surpasses <code>stat_threshold</code>, that chain ends. Defaults to <code>Inf</code>.
For example, if <code>statistic = "size"</code> and <code>stat_threshold = 10</code>, then any
chain that produces 10 or more cases will stop. Note that setting
<code>stat_threshold</code> does not guarantee that all chains will stop at the same
value.</p>
</td></tr>
<tr><td><code id=".check_sim_args_+3A_pop">pop</code></td>
<td>
<p>Population size; An <code style="white-space: pre;">&#8288;&lt;Integer&gt;&#8288;</code>. Used alongside <code>percent_immune</code>
to define the susceptible population. Defaults to <code>Inf</code>.</p>
</td></tr>
<tr><td><code id=".check_sim_args_+3A_percent_immune">percent_immune</code></td>
<td>
<p>Percent of the population immune to
infection at the start of the simulation; A <code style="white-space: pre;">&#8288;&lt;numeric&gt;&#8288;</code> between 0 and 1.
Used alongside <code>pop</code> to initialise the susceptible population. Defaults to
0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; called for side effects
</p>

<hr>
<h2 id='.check_statistic_args'>Check that the <code>statistic</code> and <code>stat_threshold</code> arguments are valid</h2><span id='topic+.check_statistic_args'></span>

<h3>Description</h3>

<p>The function treats these two arguments as related and checks
them in one place to remove repeated checks in several places in the
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.check_statistic_args(statistic, stat_threshold)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".check_statistic_args_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id=".check_statistic_args_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A stopping criterion for individual chain simulations;
a positive number coercible to integer. When any chain's cumulative statistic
reaches or surpasses <code>stat_threshold</code>, that chain ends. Defaults to <code>Inf</code>.
For example, if <code>statistic = "size"</code> and <code>stat_threshold = 10</code>, then any
chain that produces 10 or more cases will stop. Note that setting
<code>stat_threshold</code> does not guarantee that all chains will stop at the same
value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; called for side effects
</p>

<hr>
<h2 id='.check_time_args'>Check inputs that control time events</h2><span id='topic+.check_time_args'></span>

<h3>Description</h3>

<p>This function checks the time-related inputs, i.e., start time of each chain,
<code>t0</code>, the end time of the simulation, <code>tf</code>, and the generation time,
generation_time. It also checks that the generation_time argument is
specified if <code>tf</code> is specified as these go hand-in-hand.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.check_time_args(tf_specified, tf, generation_time, t0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".check_time_args_+3A_tf_specified">tf_specified</code></td>
<td>
<p><code style="white-space: pre;">&#8288;&lt;logical&gt;&#8288;</code>; Whether the <code>tf</code> argument is specified. Only
makes sense in the context where this function is called, i.e., in
<code><a href="#topic+simulate_chains">simulate_chains()</a></code>. If <code>tf</code> is specified, generation_time must be specified.</p>
</td></tr>
<tr><td><code id=".check_time_args_+3A_tf">tf</code></td>
<td>
<p>A number for the cut-off for the infection times (if generation
time is given); Defaults to <code>Inf</code>.</p>
</td></tr>
<tr><td><code id=".check_time_args_+3A_generation_time">generation_time</code></td>
<td>
<p>The generation time function; the name
of a user-defined named or anonymous function with only one argument <code>n</code>,
representing the number of generation times to sample.</p>
</td></tr>
<tr><td><code id=".check_time_args_+3A_t0">t0</code></td>
<td>
<p>Start time (if generation time is given); either a single value
or a vector of same length as <code>n_chains</code> (number of initial cases) with
corresponding initial times. Defaults to 0, meaning all cases started at
time 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>; called for side effects
</p>

<hr>
<h2 id='.complementary_logprob'>Calculates the complementary log-probability</h2><span id='topic+.complementary_logprob'></span>

<h3>Description</h3>

<p>Given x and norm, this calculates log(1-sum(exp(x)))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.complementary_logprob(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".complementary_logprob_+3A_x">x</code></td>
<td>
<p>A numeric vector of log-probabilities. Must be negative.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value of the complementary log-probability.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk
</p>

<hr>
<h2 id='.epichains'>Create an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object</h2><span id='topic+.epichains'></span>

<h3>Description</h3>

<p><code>epichains()</code> constructs an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object, which is
inherently an <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> object that stores some of the inputs
passed to the <code><a href="#topic+simulate_chains">simulate_chains()</a></code> and the
simulated output. The stored attributes are useful for downstream
analyses and reproducibility. This function checks the validity of the
object created to ensure it has the right columns and column types.
</p>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object contains a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> of the simulated
outbreak with ids for each infector and infectee, generation, and
optionally, time, the number of chains simulated,
the chain statistic that was tracked, and whether the susceptible
population was tracked.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.epichains(
  sim_df,
  n_chains,
  offspring_dist,
  track_pop,
  statistic = c("size", "length"),
  stat_threshold = Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".epichains_+3A_sim_df">sim_df</code></td>
<td>
<p>a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing at least columns for
&quot;infectee_id&quot;, &quot;infector_id&quot;, and &quot;generation&quot;. Also has optional columns
for &quot;time&quot;, and &quot;chain_id&quot;.</p>
</td></tr>
<tr><td><code id=".epichains_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of chains to simulate.</p>
</td></tr>
<tr><td><code id=".epichains_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
<tr><td><code id=".epichains_+3A_track_pop">track_pop</code></td>
<td>
<p>Was the susceptible population tracked? Logical.</p>
</td></tr>
<tr><td><code id=".epichains_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id=".epichains_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A stopping criterion for individual chain simulations;
a positive number coercible to integer. When any chain's cumulative statistic
reaches or surpasses <code>stat_threshold</code>, that chain ends. Defaults to <code>Inf</code>.
For example, if <code>statistic = "size"</code> and <code>stat_threshold = 10</code>, then any
chain that produces 10 or more cases will stop. Note that setting
<code>stat_threshold</code> does not guarantee that all chains will stop at the same
value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>

<hr>
<h2 id='.epichains_summary'>Create an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object</h2><span id='topic+.epichains_summary'></span>

<h3>Description</h3>

<p><code>epichains_summary()</code> constructs an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object.
</p>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object is a <code style="white-space: pre;">&#8288;&lt;vector&gt;&#8288;</code> of the simulated
chain sizes or lengths. It also stores information on the number of chains
simulated, and the statistic that was tracked.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.epichains_summary(
  chains_summary,
  n_chains,
  offspring_dist,
  statistic = c("size", "length"),
  stat_threshold = Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".epichains_summary_+3A_chains_summary">chains_summary</code></td>
<td>
<p>A numeric <code style="white-space: pre;">&#8288;&lt;vector&gt;&#8288;</code> of chain sizes and lengths.</p>
</td></tr>
<tr><td><code id=".epichains_summary_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of chains to simulate.</p>
</td></tr>
<tr><td><code id=".epichains_summary_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
<tr><td><code id=".epichains_summary_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id=".epichains_summary_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A stopping criterion for individual chain simulations;
a positive number coercible to integer. When any chain's cumulative statistic
reaches or surpasses <code>stat_threshold</code>, that chain ends. It also serves as a
censoring limit so that results above the specified value, are set to <code>Inf</code>.
Defaults to <code>Inf</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>

<hr>
<h2 id='.gborel_size_ll'>Log-likelihood of the size of chains with gamma-Borel offspring distribution</h2><span id='topic+.gborel_size_ll'></span>

<h3>Description</h3>

<p>Log-likelihood of the size of chains with gamma-Borel offspring distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.gborel_size_ll(x, size, prob, mu)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".gborel_size_ll_+3A_x">x</code></td>
<td>
<p>A numeric vector of chain sizes.</p>
</td></tr>
<tr><td><code id=".gborel_size_ll_+3A_size">size</code></td>
<td>
<p>The dispersion parameter (often called <code>k</code> in ecological
applications); A positive number.</p>
</td></tr>
<tr><td><code id=".gborel_size_ll_+3A_prob">prob</code></td>
<td>
<p>Probability of success (in the parameterisation with
<code>prob</code>, see also <code><a href="stats.html#topic+NegBinomial">NegBinomial</a></code>); A number between
0 and 1.</p>
</td></tr>
<tr><td><code id=".gborel_size_ll_+3A_mu">mu</code></td>
<td>
<p>Mean; A positive number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of log-likelihood values.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk James M. Azam
</p>

<hr>
<h2 id='.geom_length_ll'>Log-likelihood of the length of chains with geometric offspring distribution</h2><span id='topic+.geom_length_ll'></span>

<h3>Description</h3>

<p>Log-likelihood of the length of chains with geometric offspring distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.geom_length_ll(x, prob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".geom_length_ll_+3A_x">x</code></td>
<td>
<p>A numeric vector of chain lengths.</p>
</td></tr>
<tr><td><code id=".geom_length_ll_+3A_prob">prob</code></td>
<td>
<p>The probability of the geometric distribution with mean
<code>1/prob</code>. A single numeric value between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of log-likelihood values.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk James M. Azam
</p>

<hr>
<h2 id='.get_statistic_func'>Return a function for calculating chain statistics</h2><span id='topic+.get_statistic_func'></span>

<h3>Description</h3>

<p>Return a function for calculating chain statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_statistic_func(chain_statistic)
</code></pre>


<h3>Value</h3>

<p>A function for calculating chain statistics.
</p>

<hr>
<h2 id='.get_susceptible_offspring'>Sample the number of susceptible offspring from all possible offspring</h2><span id='topic+.get_susceptible_offspring'></span>

<h3>Description</h3>

<p>Sample susceptible offspring to be infected from all possible offspring.
This function is used internally, and input checking is not
performed here, only in the context where it is used. Using it directly
is not recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_susceptible_offspring(new_offspring, susc_pop, pop)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".get_susceptible_offspring_+3A_new_offspring">new_offspring</code></td>
<td>
<p>A numeric vector of the possible new offspring per
chain produced by <code><a href="#topic+.sample_possible_offspring">.sample_possible_offspring()</a></code>.</p>
</td></tr>
<tr><td><code id=".get_susceptible_offspring_+3A_pop">pop</code></td>
<td>
<p>Population size; An <code style="white-space: pre;">&#8288;&lt;Integer&gt;&#8288;</code>. Used alongside <code>percent_immune</code>
to define the susceptible population. Defaults to <code>Inf</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of the number of offspring that can be infected
given the current susceptible population size.
</p>

<hr>
<h2 id='.init_susc_pop'>Adjust next generation vector to match susceptible population size</h2><span id='topic+.init_susc_pop'></span>

<h3>Description</h3>

<p>Calculates the initial susceptible population size given
the total population size, the percent immune, and the number of index
cases. This function is used internally, and input checking is not
performed here, only in the context where it is used. Using it directly
is not recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.init_susc_pop(pop, percent_immune, index_cases)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".init_susc_pop_+3A_pop">pop</code></td>
<td>
<p>Population size; An <code style="white-space: pre;">&#8288;&lt;Integer&gt;&#8288;</code>. Used alongside <code>percent_immune</code>
to define the susceptible population. Defaults to <code>Inf</code>.</p>
</td></tr>
<tr><td><code id=".init_susc_pop_+3A_percent_immune">percent_immune</code></td>
<td>
<p>Percent of the population immune to
infection at the start of the simulation; A <code style="white-space: pre;">&#8288;&lt;numeric&gt;&#8288;</code> between 0 and 1.
Used alongside <code>pop</code> to initialise the susceptible population. Defaults to
0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Initial susceptible population size; A numeric coercible to integer.
</p>

<hr>
<h2 id='.is_epichains'>Test if x is an <code>epichains</code> object</h2><span id='topic+.is_epichains'></span>

<h3>Description</h3>

<p>Test if x is an <code>epichains</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.is_epichains(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".is_epichains_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical; <code>TRUE</code> if the object is an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> and <code>FALSE</code>
otherwise.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>

<hr>
<h2 id='.is_epichains_summary'>Test if x is an <code>epichains_summary</code> object</h2><span id='topic+.is_epichains_summary'></span>

<h3>Description</h3>

<p>Test if x is an <code>epichains_summary</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.is_epichains_summary(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".is_epichains_summary_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical; <code>TRUE</code> if the object is an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> and
<code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>

<hr>
<h2 id='.nbinom_size_ll'>Log-likelihood of the size of chains with Negative-Binomial offspring
distribution</h2><span id='topic+.nbinom_size_ll'></span>

<h3>Description</h3>

<p>Log-likelihood of the size of chains with Negative-Binomial offspring
distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.nbinom_size_ll(x, size, prob, mu)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".nbinom_size_ll_+3A_x">x</code></td>
<td>
<p>A numeric vector of chain sizes.</p>
</td></tr>
<tr><td><code id=".nbinom_size_ll_+3A_size">size</code></td>
<td>
<p>The dispersion parameter (often called <code>k</code> in ecological
applications); A positive number.</p>
</td></tr>
<tr><td><code id=".nbinom_size_ll_+3A_prob">prob</code></td>
<td>
<p>Probability of success (in the parameterisation with
<code>prob</code>, see also <code><a href="stats.html#topic+NegBinomial">NegBinomial</a></code>); A number between
0 and 1.</p>
</td></tr>
<tr><td><code id=".nbinom_size_ll_+3A_mu">mu</code></td>
<td>
<p>Mean; A positive number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of log-likelihood values.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk James M. Azam
</p>

<hr>
<h2 id='.new_epichains'>Construct an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object</h2><span id='topic+.new_epichains'></span>

<h3>Description</h3>

<p><code>new_epichains()</code> constructs an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object from a
supplied <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> and extra attributes passed as individual arguments.
It is meant to be lazy and performant, by creating the object without
checking the arguments for correctness. It is not safe to call
<code>new_epichains()</code> on its own as is called within <code>epichains()</code>
after the arguments have been checked. To create an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code>
object, use <code>epichains()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.new_epichains(
  sim_df,
  n_chains,
  statistic,
  offspring_dist,
  stat_threshold,
  track_pop
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".new_epichains_+3A_sim_df">sim_df</code></td>
<td>
<p>a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> containing at least columns for
&quot;infectee_id&quot;, &quot;infector_id&quot;, and &quot;generation&quot;. Also has optional columns
for &quot;time&quot;, and &quot;chain_id&quot;.</p>
</td></tr>
<tr><td><code id=".new_epichains_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of chains to simulate.</p>
</td></tr>
<tr><td><code id=".new_epichains_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id=".new_epichains_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
<tr><td><code id=".new_epichains_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A stopping criterion for individual chain simulations;
a positive number coercible to integer. When any chain's cumulative statistic
reaches or surpasses <code>stat_threshold</code>, that chain ends. Defaults to <code>Inf</code>.
For example, if <code>statistic = "size"</code> and <code>stat_threshold = 10</code>, then any
chain that produces 10 or more cases will stop. Note that setting
<code>stat_threshold</code> does not guarantee that all chains will stop at the same
value.</p>
</td></tr>
<tr><td><code id=".new_epichains_+3A_track_pop">track_pop</code></td>
<td>
<p>Was the susceptible population tracked? Logical.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James M. Azam
</p>

<hr>
<h2 id='.new_epichains_summary'>Construct a <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object</h2><span id='topic+.new_epichains_summary'></span>

<h3>Description</h3>

<p><code>new_epichains_summary()</code> constructs an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object from a
supplied <code style="white-space: pre;">&#8288;&lt;vector&gt;&#8288;</code> of chain sizes or lengths. It also stores extra
attributes passed as individual arguments.
</p>
<p><code>new_epichains_summary()</code> is meant to be lazy and performant, by creating
the object without checking the arguments for correctness. It is not safe
to call <code>new_epichains_summary()</code> on its own as is called within
<code>epichains_summary()</code> after the arguments have been checked. To create a
new <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object safely, use <code>epichains_summary()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.new_epichains_summary(
  chains_summary,
  n_chains,
  statistic,
  offspring_dist,
  stat_threshold
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".new_epichains_summary_+3A_chains_summary">chains_summary</code></td>
<td>
<p>A numeric <code style="white-space: pre;">&#8288;&lt;vector&gt;&#8288;</code> of chain sizes and lengths.</p>
</td></tr>
<tr><td><code id=".new_epichains_summary_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of chains to simulate.</p>
</td></tr>
<tr><td><code id=".new_epichains_summary_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id=".new_epichains_summary_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
<tr><td><code id=".new_epichains_summary_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A stopping criterion for individual chain simulations;
a positive number coercible to integer. When any chain's cumulative statistic
reaches or surpasses <code>stat_threshold</code>, that chain ends. It also serves as a
censoring limit so that results above the specified value, are set to <code>Inf</code>.
Defaults to <code>Inf</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James M. Azam
</p>

<hr>
<h2 id='.offspring_ll'>Log-likelihood of the summary (size/length) of chains with generic offspring
distribution</h2><span id='topic+.offspring_ll'></span>

<h3>Description</h3>

<p>The log-likelihoods are calculated with a crude approximation using simulated
chain summaries by linearly approximating any missing values in the empirical
cumulative distribution function (ecdf).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.offspring_ll(x, offspring_dist, statistic, nsim_offspring = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".offspring_ll_+3A_x">x</code></td>
<td>
<p>A numeric vector of chain summaries (sizes/lengths).</p>
</td></tr>
<tr><td><code id=".offspring_ll_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
<tr><td><code id=".offspring_ll_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id=".offspring_ll_+3A_nsim_offspring">nsim_offspring</code></td>
<td>
<p>Number of simulations of the offspring distribution
for approximating the distribution of the chain statistic summary
(size/length)</p>
</td></tr>
<tr><td><code id=".offspring_ll_+3A_...">...</code></td>
<td>
<p>any parameters to pass to <code><a href="#topic+simulate_chain_stats">simulate_chain_stats</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of log-likelihood values.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk James M. Azam
</p>

<hr>
<h2 id='.pois_length_ll'>Log-likelihood of the length of chains with Poisson offspring distribution</h2><span id='topic+.pois_length_ll'></span>

<h3>Description</h3>

<p>Log-likelihood of the length of chains with Poisson offspring distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.pois_length_ll(x, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".pois_length_ll_+3A_x">x</code></td>
<td>
<p>A numeric vector of chain lengths.</p>
</td></tr>
<tr><td><code id=".pois_length_ll_+3A_lambda">lambda</code></td>
<td>
<p>The rate of the Poisson distribution. A single numeric value.
Must be positive.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of log-likelihood values.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk James M. Azam
</p>

<hr>
<h2 id='.pois_size_ll'>Log-likelihood of the size of chains with Poisson offspring distribution</h2><span id='topic+.pois_size_ll'></span>

<h3>Description</h3>

<p>Log-likelihood of the size of chains with Poisson offspring distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.pois_size_ll(x, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".pois_size_ll_+3A_x">x</code></td>
<td>
<p>A numeric vector of sizes</p>
</td></tr>
<tr><td><code id=".pois_size_ll_+3A_lambda">lambda</code></td>
<td>
<p>The rate of the Poisson distribution; A single numeric value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of log-likelihood values.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk James M. Azam
</p>

<hr>
<h2 id='.rbinom_size'>Samples size (the number of trials) of a binomial distribution</h2><span id='topic+.rbinom_size'></span>

<h3>Description</h3>

<p>Samples the size parameter from the binomial distribution with fixed x
(number of successes) and p (success probability)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.rbinom_size(n, x, prob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".rbinom_size_+3A_n">n</code></td>
<td>
<p>The number of samples to generate. Must be a positive integer.</p>
</td></tr>
<tr><td><code id=".rbinom_size_+3A_x">x</code></td>
<td>
<p>The number of successes. Must be a positive integer.</p>
</td></tr>
<tr><td><code id=".rbinom_size_+3A_prob">prob</code></td>
<td>
<p>The probability of success. A numeric between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of the sampled sizes.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk
</p>

<hr>
<h2 id='.rgen_length'>Samples chain lengths with given observation probabilities</h2><span id='topic+.rgen_length'></span>

<h3>Description</h3>

<p>Samples the length of a transmission chain where each individual element is
observed with binomial probability with parameters n (number of successes)
and p (success probability)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.rgen_length(n, x, prob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".rgen_length_+3A_n">n</code></td>
<td>
<p>The number of samples to generate. Must be a positive integer.</p>
</td></tr>
<tr><td><code id=".rgen_length_+3A_x">x</code></td>
<td>
<p>A numeric vector of the observed chain lengths.</p>
</td></tr>
<tr><td><code id=".rgen_length_+3A_prob">prob</code></td>
<td>
<p>The probability of observation. A numeric between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of the sampled chain lengths.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk
</p>

<hr>
<h2 id='.sample_possible_offspring'>Sample all possible offspring for the next generation</h2><span id='topic+.sample_possible_offspring'></span>

<h3>Description</h3>

<p>Sample next generation of offspring using offspring distribution and
associated parameters. This function is used internally, and input
checking is not performed here, only in the context where it is used.
Using it directly is not recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.sample_possible_offspring(
  offspring_func,
  offspring_func_pars,
  n_offspring,
  chains
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".sample_possible_offspring_+3A_offspring_func">offspring_func</code></td>
<td>
<p>A function to sample offspring.</p>
</td></tr>
<tr><td><code id=".sample_possible_offspring_+3A_offspring_func_pars">offspring_func_pars</code></td>
<td>
<p>A list of parameters for the offspring function.</p>
</td></tr>
<tr><td><code id=".sample_possible_offspring_+3A_n_offspring">n_offspring</code></td>
<td>
<p>A numeric vector of the number of offspring per chain.</p>
</td></tr>
<tr><td><code id=".sample_possible_offspring_+3A_chains">chains</code></td>
<td>
<p>Numeric indices of chains/infectors being simulated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of the number of offspring per chain.
</p>

<hr>
<h2 id='.update_chain_stat'>Determine and update the chain statistic being tracked</h2><span id='topic+.update_chain_stat'></span>

<h3>Description</h3>

<p>Determine and update the chain statistic being tracked
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.update_chain_stat(stat_type, stat_latest, n_offspring)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".update_chain_stat_+3A_stat_type">stat_type</code></td>
<td>
<p>Chain statistic (size/length) to update; A character string.
Must be one of 'size' or 'length'.</p>
</td></tr>
<tr><td><code id=".update_chain_stat_+3A_stat_latest">stat_latest</code></td>
<td>
<p>The latest chain statistic numeric vector to be updated.</p>
</td></tr>
<tr><td><code id=".update_chain_stat_+3A_n_offspring">n_offspring</code></td>
<td>
<p>A vector of offspring per chain. A numeric vector
(coercible to integer).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of chain statistics (size/length). A numeric vector
coercible to integer.
</p>

<hr>
<h2 id='.validate_epichains'>Validate an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object</h2><span id='topic+.validate_epichains'></span>

<h3>Description</h3>

<p>Validate an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.validate_epichains(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".validate_epichains_+3A_x">x</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the object if it is valid.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>

<hr>
<h2 id='.validate_epichains_summary'>Validate an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object</h2><span id='topic+.validate_epichains_summary'></span>

<h3>Description</h3>

<p>Validate an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.validate_epichains_summary(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".validate_epichains_summary_+3A_x">x</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the object if it is valid.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>

<hr>
<h2 id='aggregate.epichains'>Aggregate cases in <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> objects by &quot;generation&quot; or &quot;time&quot;, if
present</h2><span id='topic+aggregate.epichains'></span>

<h3>Description</h3>

<p>This function provides a quick way to create a time series of cases over
generation or time (if <code>generation_time</code> was specified) from simulated
<code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epichains'
aggregate(x, by = c("time", "generation"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aggregate.epichains_+3A_x">x</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="aggregate.epichains_+3A_by">by</code></td>
<td>
<p>The variable to aggregate by; A character string with options
&quot;time&quot; and &quot;generation&quot;.</p>
</td></tr>
<tr><td><code id="aggregate.epichains_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code> object of cases by <code>by</code>.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(32)
chains &lt;- simulate_chains(
  n_chains = 10,
  statistic = "size",
  offspring_dist = rpois,
  stat_threshold = 10,
  generation_time = function(n) rep(3, n),
  lambda = 2
)
chains

# Aggregate cases per time
cases_per_time &lt;- aggregate(chains, by = "time")
head(cases_per_time)

# Aggregate cases per generation
cases_per_gen &lt;- aggregate(chains, by = "generation")
head(cases_per_gen)
</code></pre>

<hr>
<h2 id='covid19_sa'>COVID-19 Data Repository for South Africa</h2><span id='topic+covid19_sa'></span>

<h3>Description</h3>

<p>An aggregated subset of the COVID-19 Data Repository for South Africa
created, maintained and hosted by Data Science for Social Impact research
group, led by Dr. Vukosi Marivate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covid19_sa
</code></pre>


<h3>Format</h3>



<h4><code>covid19_sa</code></h4>

<p>A data frame with 19 rows and 2 columns:
</p>

<dl>
<dt>date</dt><dd><p>Date case was reported</p>
</dd>
<dt>cases</dt><dd><p>Number of cases</p>
</dd>
</dl>




<h3>Details</h3>

<p>The data is originally provided as a linelist but has been subsetted and
cleaned in <code>data-raw/covid19_sa.R</code>.
</p>


<h3>Source</h3>

<p><a href="https://github.com/dsfsi/covid19za">https://github.com/dsfsi/covid19za</a>
Further details in <code>data-raw/covid19_sa.R</code>.
</p>

<hr>
<h2 id='dborel'>Density of the Borel distribution</h2><span id='topic+dborel'></span>

<h3>Description</h3>

<p>Density of the Borel distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dborel(x, mu, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dborel_+3A_x">x</code></td>
<td>
<p>A numeric vector of quantiles.</p>
</td></tr>
<tr><td><code id="dborel_+3A_mu">mu</code></td>
<td>
<p>A non-negative number for the poisson mean.</p>
</td></tr>
<tr><td><code id="dborel_+3A_log">log</code></td>
<td>
<p>Logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of the borel probability density.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(32)
dborel(1:5, 1)
</code></pre>

<hr>
<h2 id='head.epichains'><code>head</code> and <code>tail</code> method for <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> class</h2><span id='topic+head.epichains'></span><span id='topic+tail.epichains'></span>

<h3>Description</h3>

<p><code>head</code> and <code>tail</code> method for <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epichains'
head(x, ...)

## S3 method for class 'epichains'
tail(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="head.epichains_+3A_x">x</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="head.epichains_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This returns the top rows of an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object, starting from the
first known infectors.
</p>
<p>To view the full output, use <code style="white-space: pre;">&#8288;as.data.frame(&lt;object_name&gt;)&#8288;</code>.
</p>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(32)
chains_pois_offspring &lt;- simulate_chains(
  n_chains = 10,
  statistic = "size",
  offspring_dist = rpois,
  stat_threshold = 10,
  generation_time = function(n) rep(3, n),
  lambda = 2
)
head(chains_pois_offspring)
set.seed(32)
chains_pois_offspring &lt;- simulate_chains(
  n_chains = 10,
  statistic = "size",
  offspring_dist = rpois,
  stat_threshold = 10,
  generation_time = function(n) rep(3, n),
  lambda = 2
)
tail(chains_pois_offspring)
</code></pre>

<hr>
<h2 id='likelihood'>Estimate the log-likelihood/likelihood for observed branching processes</h2><span id='topic+likelihood'></span>

<h3>Description</h3>

<p>Estimate the log-likelihood/likelihood for observed branching processes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likelihood(
  chains,
  statistic = c("size", "length"),
  offspring_dist,
  nsim_obs,
  obs_prob = 1,
  stat_threshold = Inf,
  log = TRUE,
  exclude = NULL,
  individual = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="likelihood_+3A_chains">chains</code></td>
<td>
<p>Vector of chain summaries (sizes/lengths). Can be a
<code style="white-space: pre;">&#8288;&lt;numeric&gt;&#8288;</code> vector or an object of class <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> or
<code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> (obtained from <code><a href="#topic+simulate_chains">simulate_chains()</a></code> or
<code><a href="#topic+simulate_chain_stats">simulate_chain_stats()</a></code>). See examples below.</p>
</td></tr>
<tr><td><code id="likelihood_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id="likelihood_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
<tr><td><code id="likelihood_+3A_nsim_obs">nsim_obs</code></td>
<td>
<p>Number of simulations to be used to approximate the
log-likelihood/likelihood if <code>obs_prob &lt; 1</code> (imperfect observation). If
<code>obs_prob == 1</code>, this argument is ignored.</p>
</td></tr>
<tr><td><code id="likelihood_+3A_obs_prob">obs_prob</code></td>
<td>
<p>Observation probability. A number (probability) between 0
and 1. A value greater than 0 but less 1 implies imperfect observation and
simulations will be used to approximate the (log)likelihood. This will
also require specifying <code>nsim_obs</code>. In the simulation, the observation
process is assumed to be constant.</p>
</td></tr>
<tr><td><code id="likelihood_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A stopping criterion for individual chain simulations;
a positive number coercible to integer. When any chain's cumulative statistic
reaches or surpasses <code>stat_threshold</code>, that chain ends. It also serves as a
censoring limit so that results above the specified value, are set to <code>Inf</code>.
Defaults to <code>Inf</code>. NOTE: For objects of class <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> or
<code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code>, the <code>stat_threshold</code> used in the simulation is
extracted and used here so if this argument is specified, it is ignored and
a warning is thrown.</p>
</td></tr>
<tr><td><code id="likelihood_+3A_log">log</code></td>
<td>
<p>Should the log-likelihoods be transformed to
likelihoods? Logical. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="likelihood_+3A_exclude">exclude</code></td>
<td>
<p>A vector of indices of the sizes/lengths to exclude from the
log-likelihood calculation.</p>
</td></tr>
<tr><td><code id="likelihood_+3A_individual">individual</code></td>
<td>
<p>Logical; If TRUE, a vector of individual
log-likelihood/likelihood contributions will be returned rather than the
sum/product.</p>
</td></tr>
<tr><td><code id="likelihood_+3A_...">...</code></td>
<td>
<p>any parameters to pass to <code><a href="#topic+simulate_chain_stats">simulate_chain_stats</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>log = TRUE</code>
</p>

<ul>
<li><p> A joint log-likelihood (sum of individual log-likelihoods), if
<code>individual == FALSE</code> (default) and <code>obs_prob == 1</code> (default), or
</p>
</li>
<li><p> A list of individual log-likelihoods, if <code>individual == TRUE</code> and
<code>obs_prob == 1</code> (default), or
</p>
</li>
<li><p> A list of individual log-likelihoods (same length as <code>nsim_obs</code>), if
<code>individual == TRUE</code> and <code>0 &lt;= obs_prob &lt; 1</code>, or
</p>
</li>
<li><p> A vector of joint log-likelihoods (same length as <code>nsim_obs</code>), if
individual == FALSE and <code>0 &lt;= obs_prob &lt; 1</code> (imperfect observation).
</p>
</li></ul>

<p>If <code>log = FALSE</code>, the same structure of outputs as above are returned,
except that likelihoods, instead of log-likelihoods, are calculated in all
cases. Moreover, the joint likelihoods are the product, instead of the sum,
of the individual likelihoods.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk, James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example of observed chain sizes
set.seed(121)
# randomly generate 20 chains of size 1 to 10
chain_sizes &lt;- sample(1:10, 20, replace = TRUE)
likelihood(
  chains = chain_sizes,
  statistic = "size",
  offspring_dist = rpois,
  nsim_obs = 100,
  lambda = 0.5
)
# Example using an &lt;epichains&gt; object
set.seed(32)
epichains_obj_eg &lt;- simulate_chains(
  n_chains = 10,
  pop = 100,
  percent_immune = 0,
  statistic = "size",
  offspring_dist = rnbinom,
  stat_threshold = 10,
  generation_time = function(n) rep(3, n),
  mu = 2,
  size = 0.2
)

epichains_obj_eg_lik &lt;- likelihood(
  chains = epichains_obj_eg,
  statistic = "size",
  offspring_dist = rnbinom,
  mu = 2,
  size = 0.2,
  stat_threshold = 10
)
epichains_obj_eg_lik

# Example using a &lt;epichains_summary&gt; object
set.seed(32)
epichains_summary_eg &lt;- simulate_chain_stats(
  n_chains = 10,
  pop = 100,
  percent_immune = 0,
  statistic = "size",
  offspring_dist = rnbinom,
  stat_threshold = 10,
  mu = 2,
  size = 0.2
)
epichains_summary_eg_lik &lt;- likelihood(
  chains = epichains_summary_eg,
  statistic = "size",
  offspring_dist = rnbinom,
  mu = 2,
  size = 0.2
)
epichains_summary_eg_lik
</code></pre>

<hr>
<h2 id='print.epichains'>Print an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object</h2><span id='topic+print.epichains'></span>

<h3>Description</h3>

<p>Print an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epichains'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.epichains_+3A_x">x</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="print.epichains_+3A_...">...</code></td>
<td>
<p>Other parameters passed to <code>print()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns an <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code>. Called for
side-effects.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using a Poisson offspring distribution and simulating from an infinite
# population up to chain size 10.
set.seed(32)
chains_pois_offspring &lt;- simulate_chains(
  n_chains = 10,
  statistic = "size",
  offspring_dist = rpois,
  stat_threshold = 10,
  generation_time = function(n) rep(3, n),
  lambda = 2
)
chains_pois_offspring # Print the object
</code></pre>

<hr>
<h2 id='print.epichains_summary'>Print an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object</h2><span id='topic+print.epichains_summary'></span>

<h3>Description</h3>

<p>Prints a summary of the <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object. In particular, it
prints the number of chains simulated, and the range of
the statistic, represented as the maximum (<code>max_stat</code>) and minimum
(<code>min_stat</code>). If the minimum or maximum is infinite, it is represented as
<code style="white-space: pre;">&#8288;&gt;= stat_threshold&#8288;</code> where <code>stat_threshold</code> is the value of the censoring
limit. See <code>?epichains_summary()</code> for the definition of <code>stat_threshold</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epichains_summary'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.epichains_summary_+3A_x">x</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="print.epichains_summary_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns an <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code>. Called for
side-effects.
</p>


<h3>Author(s)</h3>

<p>James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using a Poisson offspring distribution and simulating from an infinite
# population up to chain size 10.
set.seed(32)
chain_summary_print_eg &lt;- simulate_chain_stats(
  n_chains = 10,
  statistic = "size",
  offspring_dist = rpois,
  stat_threshold = 10,
  lambda = 2
)
chain_summary_print_eg # Print the object
</code></pre>

<hr>
<h2 id='rborel'>Generate random numbers from the Borel distribution</h2><span id='topic+rborel'></span>

<h3>Description</h3>

<p>Random numbers are generated by simulating from a Poisson branching process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rborel(n, mu, censor_at = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rborel_+3A_n">n</code></td>
<td>
<p>Number of random variates to generate.</p>
</td></tr>
<tr><td><code id="rborel_+3A_mu">mu</code></td>
<td>
<p>A non-negative number for the poisson mean.</p>
</td></tr>
<tr><td><code id="rborel_+3A_censor_at">censor_at</code></td>
<td>
<p>A stopping criterion; <code style="white-space: pre;">&#8288;&lt;numeric&gt;&#8288;</code>. Defaults to <code>Inf</code>. A
value above which the simulation ends and the random number is set to
<code>Inf</code> (as a form of censoring). <code>rborel()</code> simulates chain sizes using
<code><a href="#topic+simulate_chain_stats">simulate_chain_stats()</a></code> with a Poisson offspring distribution, so if
<code>mu &gt;= 1</code>, the simulation could proceed unendingly. This parameter is used
to prevent this.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of random numbers.
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(32)
rborel(5, 1)
</code></pre>

<hr>
<h2 id='rgborel'>Generate random numbers from a Gamma-Borel mixture distribution</h2><span id='topic+rgborel'></span>

<h3>Description</h3>

<p>Generate random numbers from a Gamma-Borel mixture distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgborel(n, size, prob, mu, censor_at = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rgborel_+3A_n">n</code></td>
<td>
<p>Number of random variates to generate.</p>
</td></tr>
<tr><td><code id="rgborel_+3A_size">size</code></td>
<td>
<p>The dispersion parameter (often called <code>k</code> in ecological
applications); A positive number.</p>
</td></tr>
<tr><td><code id="rgborel_+3A_prob">prob</code></td>
<td>
<p>Probability of success (in the parameterisation with
<code>prob</code>, see also <code><a href="stats.html#topic+NegBinomial">NegBinomial</a></code>); A number between
0 and 1.</p>
</td></tr>
<tr><td><code id="rgborel_+3A_mu">mu</code></td>
<td>
<p>Mean; A positive number.</p>
</td></tr>
<tr><td><code id="rgborel_+3A_censor_at">censor_at</code></td>
<td>
<p>A stopping criterion; <code style="white-space: pre;">&#8288;&lt;numeric&gt;&#8288;</code>. Defaults to <code>Inf</code>. A
value above which the simulation ends and the random number is set to
<code>Inf</code> (as a form of censoring). <code>rborel()</code> simulates chain sizes using
<code><a href="#topic+simulate_chain_stats">simulate_chain_stats()</a></code> with a Poisson offspring distribution, so if
<code>mu &gt;= 1</code>, the simulation could proceed unendingly. This parameter is used
to prevent this.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of random numbers
</p>


<h3>Author(s)</h3>

<p>Sebastian Funk James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(32)
rgborel(n = 5, size = 0.3, mu = 1, censor_at = 5)
</code></pre>

<hr>
<h2 id='simulate_chain_stats'>Simulate a vector of transmission chains statistics (sizes/lengths)</h2><span id='topic+simulate_chain_stats'></span>

<h3>Description</h3>

<p>It generates a vector of transmission chain sizes or lengths using the
same model as <code><a href="#topic+simulate_chains">simulate_chains()</a></code> but without tracking details of the
individual chains. This function is useful when only the chain sizes or
lengths are of interest.
</p>
<p>It uses a simple branching process model that simulates independent
chains, using an offspring distribution for each chain. Each chain
uses a threshold chain size or length as the
stopping criterion especially where R0 &gt; 1. The function also optionally
accepts population related inputs such as the population size (defaults
to Inf) and percentage of the population initially immune (defaults to 0).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_chain_stats(
  n_chains,
  statistic = c("size", "length"),
  offspring_dist,
  ...,
  stat_threshold = Inf,
  pop = Inf,
  percent_immune = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_chain_stats_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of chains to simulate.</p>
</td></tr>
<tr><td><code id="simulate_chain_stats_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id="simulate_chain_stats_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
<tr><td><code id="simulate_chain_stats_+3A_...">...</code></td>
<td>
<p>Parameters of the offspring distribution as required by R.</p>
</td></tr>
<tr><td><code id="simulate_chain_stats_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A stopping criterion for individual chain simulations;
a positive number coercible to integer. When any chain's cumulative statistic
reaches or surpasses <code>stat_threshold</code>, that chain ends. It also serves as a
censoring limit so that results above the specified value, are set to <code>Inf</code>.
Defaults to <code>Inf</code>.</p>
</td></tr>
<tr><td><code id="simulate_chain_stats_+3A_pop">pop</code></td>
<td>
<p>Population size; An <code style="white-space: pre;">&#8288;&lt;Integer&gt;&#8288;</code>. Used alongside <code>percent_immune</code>
to define the susceptible population. Defaults to <code>Inf</code>.</p>
</td></tr>
<tr><td><code id="simulate_chain_stats_+3A_percent_immune">percent_immune</code></td>
<td>
<p>Percent of the population immune to
infection at the start of the simulation; A <code style="white-space: pre;">&#8288;&lt;numeric&gt;&#8288;</code> between 0 and 1.
Used alongside <code>pop</code> to initialise the susceptible population. Defaults to
0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code>, which is a numeric
vector of chain sizes or lengths with extra attributes for storing the
simulation parameters.
</p>


<h3><code>simulate_chain_stats()</code> vs <code>simulate_chains()</code></h3>

<p><code>simulate_chain_stats()</code> is a time-invariant version of <code>simulate_chains()</code>.
In particular, it does not track the details of individual transmission
events but deals with eventual chain statistics, that is, the statistic
realised by a chain after dying out.
</p>
<p>It is useful for generating a vector of chain sizes or lengths for a given
number of chains, if details of who infected whom and the timing of
infection are not of interest.
</p>
<p>This function is used in <code>{epichains}</code> for calculating likelihoods in
the <code>likelihood()</code> function and for sampling from the borel
distribution (See ?epichains::rborel). It is used extensively in the
vignette on
<a href="https://epiverse-trace.github.io/epichains/articles/interventions.html">modelling disease control</a>,
where only data on observed chain sizes and lengths are available.
</p>


<h3>Definition of a transmission chain</h3>

<p>A transmission chain as used here is an independent case and all
the secondary cases linked to it through transmission. The chain starts with
a single case, and each case in the chain generates secondary cases
according to the offspring distribution. The chain ends when no more
secondary cases are generated.
</p>


<h3>Calculating chain sizes and lengths</h3>

<p>The function simulates the chain size for chain <code class="reqn">i</code> at time
<code class="reqn">t</code>, <code class="reqn">I_{t, i}</code>, as:
</p>
<p style="text-align: center;"><code class="reqn">I_{t, i} = \sum_{i}^{I_{t-1}}X_{t, i},</code>
</p>

<p>and the chain length/duration for chain <code class="reqn">i</code> at time <code class="reqn">t</code>,
<code class="reqn">L_{t, i}</code>, as:
</p>
<p style="text-align: center;"><code class="reqn">L_{t, i} = {\sf min}(1, X_{t, i}), </code>
</p>

<p>where <code class="reqn">X_{t, i}</code> is the secondary cases generated by chain <code class="reqn">i</code>
at time <code class="reqn">t</code>, and <code class="reqn">I_{0, i} = L_{0, i} = 1</code>.
</p>
<p>The distribution of secondary cases, <code class="reqn">X_{t, i}</code> is modelled by the
offspring distribution (<code>offspring_dist</code>).
</p>


<h3>Author(s)</h3>

<p>James M. Azam, Sebastian Funk
</p>


<h3>References</h3>

<p>Jacob C. (2010). Branching processes: their role in epidemiology.
International journal of environmental research and public health, 7(3),
1186–1204. <a href="https://doi.org/10.3390/ijerph7031204">doi:10.3390/ijerph7031204</a>
</p>
<p>Blumberg, S., and J. O. Lloyd-Smith. 2013. &quot;Comparing Methods for
Estimating R0 from the Size Distribution of Subcritical Transmission
Chains.&quot; Epidemics 5 (3): 131–45.
<a href="https://doi.org/10.1016/j.epidem.2013.05.002">doi:10.1016/j.epidem.2013.05.002</a>.
</p>
<p>Farrington, C. P., M. N. Kanaan, and N. J. Gay. 2003.
&quot;Branching Process Models for Surveillance of Infectious Diseases
Controlled by Mass Vaccination.” Biostatistics (Oxford, England)
4 (2): 279–95. <a href="https://doi.org/10.1093/biostatistics/4.2.279">doi:10.1093/biostatistics/4.2.279</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate chain sizes with a poisson offspring distribution, assuming an
# infinite population and no immunity.
set.seed(32)
simulate_chain_stats(
  n_chains = 20,
  statistic = "size",
  offspring_dist = rpois,
  stat_threshold = 10,
  lambda = 0.9
)
# Simulate chain sizes with a negative binomial distribution and assuming
# a finite population and 10% immunity.
set.seed(32)
simulate_chain_stats(
  pop = 1000,
  percent_immune = 0.1,
  n_chains = 20,
  statistic = "size",
  offspring_dist = rnbinom,
  stat_threshold = 10,
  mu = 0.9,
  size = 0.36
)
</code></pre>

<hr>
<h2 id='simulate_chains'>Simulate transmission chains</h2><span id='topic+simulate_chains'></span>

<h3>Description</h3>

<p>It generates independent transmission chains starting with a single case
per chain, using a simple branching process model (See details for
definition of &quot;chains&quot; and assumptions). Offspring for each
chain are generated with an offspring distribution, and an optional
generation time distribution function.
</p>
<p>The individual chain simulations are controlled by customisable stopping
criteria, including a threshold chain size or length, and a generation time
cut off. The function also optionally accepts population related inputs
such as the population size (defaults to Inf) and percentage of the
population initially immune (defaults to 0).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_chains(
  n_chains,
  statistic = c("size", "length"),
  offspring_dist,
  ...,
  stat_threshold = Inf,
  pop = Inf,
  percent_immune = 0,
  generation_time = NULL,
  t0 = 0,
  tf = Inf
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_chains_+3A_n_chains">n_chains</code></td>
<td>
<p>Number of chains to simulate.</p>
</td></tr>
<tr><td><code id="simulate_chains_+3A_statistic">statistic</code></td>
<td>
<p>The chain statistic to track as the
stopping criteria for each chain being simulated when <code>stat_threshold</code> is not
<code>Inf</code>; A <code style="white-space: pre;">&#8288;&lt;string&gt;&#8288;</code>. It can be one of:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of cases produced by a chain before it goes
extinct.
</p>
</li>
<li><p> &quot;length&quot;: the total number of generations reached by a chain before
it goes extinct.
</p>
</li></ul>
</td></tr>
<tr><td><code id="simulate_chains_+3A_offspring_dist">offspring_dist</code></td>
<td>
<p>Offspring distribution: a <code style="white-space: pre;">&#8288;&lt;function&gt;&#8288;</code> like the ones
provided by R to generate random numbers from given distributions (e.g.,
<code><a href="stats.html#topic+rpois">rpois</a></code> for Poisson). More specifically, the function needs to
accept at least one argument, <code>n</code>, which is the number of random
numbers to generate. It can accept further arguments, which will be passed
on to the random number generating functions. Examples that can be provided
here are <code>rpois</code> for Poisson distributed offspring, <code>rnbinom</code> for negative
binomial offspring, or custom functions.</p>
</td></tr>
<tr><td><code id="simulate_chains_+3A_...">...</code></td>
<td>
<p>Parameters of the offspring distribution as required by R.</p>
</td></tr>
<tr><td><code id="simulate_chains_+3A_stat_threshold">stat_threshold</code></td>
<td>
<p>A stopping criterion for individual chain simulations;
a positive number coercible to integer. When any chain's cumulative statistic
reaches or surpasses <code>stat_threshold</code>, that chain ends. Defaults to <code>Inf</code>.
For example, if <code>statistic = "size"</code> and <code>stat_threshold = 10</code>, then any
chain that produces 10 or more cases will stop. Note that setting
<code>stat_threshold</code> does not guarantee that all chains will stop at the same
value.</p>
</td></tr>
<tr><td><code id="simulate_chains_+3A_pop">pop</code></td>
<td>
<p>Population size; An <code style="white-space: pre;">&#8288;&lt;Integer&gt;&#8288;</code>. Used alongside <code>percent_immune</code>
to define the susceptible population. Defaults to <code>Inf</code>.</p>
</td></tr>
<tr><td><code id="simulate_chains_+3A_percent_immune">percent_immune</code></td>
<td>
<p>Percent of the population immune to
infection at the start of the simulation; A <code style="white-space: pre;">&#8288;&lt;numeric&gt;&#8288;</code> between 0 and 1.
Used alongside <code>pop</code> to initialise the susceptible population. Defaults to
0.</p>
</td></tr>
<tr><td><code id="simulate_chains_+3A_generation_time">generation_time</code></td>
<td>
<p>The generation time function; the name
of a user-defined named or anonymous function with only one argument <code>n</code>,
representing the number of generation times to sample.</p>
</td></tr>
<tr><td><code id="simulate_chains_+3A_t0">t0</code></td>
<td>
<p>Start time (if generation time is given); either a single value
or a vector of same length as <code>n_chains</code> (number of initial cases) with
corresponding initial times. Defaults to 0, meaning all cases started at
time 0.</p>
</td></tr>
<tr><td><code id="simulate_chains_+3A_tf">tf</code></td>
<td>
<p>A number for the cut-off for the infection times (if generation
time is given); Defaults to <code>Inf</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object, which is basically a <code style="white-space: pre;">&#8288;&lt;data.frame&gt;&#8288;</code>
with columns:
</p>

<ul>
<li> <p><code>chain</code> - an ID for active/ongoing chains,
</p>
</li>
<li> <p><code>infectee</code> - a unique ID for each infectee.
</p>
</li>
<li> <p><code>infector</code> - an ID for the infector of each infectee.
</p>
</li>
<li> <p><code>generation</code> - a discrete time point during which infection occurs, and
optionally,
</p>
</li>
<li> <p><code>time</code> - the time of infection.
</p>
</li></ul>



<h3>Definition of a transmission chain</h3>

<p>A transmission chain as used here is an independent case and all
the secondary cases linked to it through transmission. The chain starts with
a single case, and each case in the chain generates secondary cases
according to the offspring distribution. The chain ends when no more
secondary cases are generated.
</p>


<h3>Calculating chain sizes and lengths</h3>

<p>The function simulates the chain size for chain <code class="reqn">i</code> at time
<code class="reqn">t</code>, <code class="reqn">I_{t, i}</code>, as:
</p>
<p style="text-align: center;"><code class="reqn">I_{t, i} = \sum_{i}^{I_{t-1}}X_{t, i},</code>
</p>

<p>and the chain length/duration for chain <code class="reqn">i</code> at time <code class="reqn">t</code>,
<code class="reqn">L_{t, i}</code>, as:
</p>
<p style="text-align: center;"><code class="reqn">L_{t, i} = {\sf min}(1, X_{t, i}), </code>
</p>

<p>where <code class="reqn">X_{t, i}</code> is the secondary cases generated by chain <code class="reqn">i</code>
at time <code class="reqn">t</code>, and <code class="reqn">I_{0, i} = L_{0, i} = 1</code>.
</p>
<p>The distribution of secondary cases, <code class="reqn">X_{t, i}</code> is modelled by the
offspring distribution (<code>offspring_dist</code>).
</p>


<h3>Specifying <code>generation_time</code></h3>

<p>The argument <code>generation_time</code> must be specified as a function with
one argument, <code>n</code>.
</p>
<p>For example, assuming we want to specify the generation time as a random
log-normally distributed variable with <code>meanlog = 0.58</code> and <code>sdlog = 1.58</code>,
we could define a named function, let's call it &quot;generation_time_fn&quot;,
with only one argument representing the number of generation times to
sample: <code>generation_time_fn &lt;- function(n){rlnorm(n, 0.58, 1.38)}</code>,
and assign the name of the function to <code>generation_time</code> in
the simulation function, i.e.
<code>`simulate_*`(..., generation_time = generation_time_fn)</code>,
where <code>...</code> are the other arguments to <code style="white-space: pre;">&#8288;simulate_*()&#8288;</code> and * is a placeholder
for the rest of simulation function's name.
</p>
<p>Alternatively, we could assign an anonymous function to <code>generation_time</code>
in the <code style="white-space: pre;">&#8288;simulate_*()&#8288;</code> call, i.e.
<code>simulate_*(..., generation_time = function(n){rlnorm(n, 0.58, 1.38)})</code>
OR <code>simulate_*(..., generation_time = \(n){rlnorm(n, 0.58, 1.38)})</code>,
where <code>...</code> are the other arguments to <code style="white-space: pre;">&#8288;simulate_*()&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>James M. Azam, Sebastian Funk
</p>


<h3>References</h3>

<p>Jacob C. (2010). Branching processes: their role in epidemiology.
International journal of environmental research and public health, 7(3),
1186–1204. <a href="https://doi.org/10.3390/ijerph7031204">doi:10.3390/ijerph7031204</a>
</p>
<p>Blumberg, S., and J. O. Lloyd-Smith. 2013. &quot;Comparing Methods for
Estimating R0 from the Size Distribution of Subcritical Transmission
Chains.&quot; Epidemics 5 (3): 131–45.
<a href="https://doi.org/10.1016/j.epidem.2013.05.002">doi:10.1016/j.epidem.2013.05.002</a>.
</p>
<p>Farrington, C. P., M. N. Kanaan, and N. J. Gay. 2003.
&quot;Branching Process Models for Surveillance of Infectious Diseases
Controlled by Mass Vaccination.” Biostatistics (Oxford, England)
4 (2): 279–95. <a href="https://doi.org/10.1093/biostatistics/4.2.279">doi:10.1093/biostatistics/4.2.279</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using a Poisson offspring distribution and simulating from an infinite
# population up to chain size 10.
set.seed(32)
chains_pois_offspring &lt;- simulate_chains(
  n_chains = 10,
  statistic = "size",
  offspring_dist = rpois,
  stat_threshold = 10,
  generation_time = function(n) rep(3, n),
  lambda = 2
)
chains_pois_offspring

# Using a Negative binomial offspring distribution and simulating from a
# finite population up to chain size 10.
set.seed(32)
chains_nbinom_offspring &lt;- simulate_chains(
  n_chains = 10,
  pop = 100,
  percent_immune = 0,
  statistic = "size",
  offspring_dist = rnbinom,
  stat_threshold = 10,
  generation_time = function(n) rep(3, n),
  mu = 2,
  size = 0.2
)
chains_nbinom_offspring
</code></pre>

<hr>
<h2 id='summary.epichains'>Summary method for <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> class</h2><span id='topic+summary.epichains'></span>

<h3>Description</h3>

<p>This calculates the chain statistic (size/length) for the simulated
chains and returns an object with the same information as that returned
by an equivalent <code>simulate_chain_stats()</code> call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epichains'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.epichains_+3A_object">object</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="summary.epichains_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object containing the chain summary
statistics as follows:
</p>

<ul>
<li><p> &quot;size&quot;: the total number of offspring produced by a chain before it
goes extinct.
</p>
</li>
<li><p> &quot;length&quot;: the number of generations achieved by a chain before
it goes extinct.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using a negative binomial offspring distribution and simulating from a
# finite population up to chain size 10.
set.seed(32)
sim_chains_nbinom &lt;- simulate_chains(
  n_chains = 10,
  pop = 100,
  percent_immune = 0,
  statistic = "size",
  offspring_dist = rnbinom,
  stat_threshold = 10,
  mu = 2,
  size = 0.2
)
# Summarise the simulated chains
sim_chains_nbinom_summary &lt;- summary(sim_chains_nbinom)
sim_chains_nbinom_summary

# Same results can be obtained using `simulate_chain_stats()`
set.seed(32)
sim_summary_nbinom &lt;- simulate_chain_stats(
  n_chains = 10,
  pop = 100,
  percent_immune = 0,
  statistic = "size",
  offspring_dist = rnbinom,
  stat_threshold = 10,
  mu = 2,
  size = 0.2
)
sim_summary_nbinom

# Check that the results are the same
setequal(sim_chains_nbinom_summary, sim_summary_nbinom)
</code></pre>

<hr>
<h2 id='summary.epichains_summary'>Summary method for <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> class</h2><span id='topic+summary.epichains_summary'></span>

<h3>Description</h3>

<p>Summary method for <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epichains_summary'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.epichains_summary_+3A_object">object</code></td>
<td>
<p>An <code style="white-space: pre;">&#8288;&lt;epichains_summary&gt;&#8288;</code> object.</p>
</td></tr>
<tr><td><code id="summary.epichains_summary_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of chain summaries. The list contains the following
elements:
</p>

<ul>
<li> <p><code>n_chains</code>: the number of chains simulated.
</p>
</li>
<li> <p><code>max_stat</code>: the maximum chain statistic (size/length) achieved by the
chains.
</p>
</li>
<li> <p><code>min_stat</code>: the minimum chain statistic (size/length) achieved by the
chains.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>James M. Azam
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using a Poisson offspring distribution and simulating from an infinite
# population up to chain size 10.
set.seed(32)
chain_stats &lt;- simulate_chain_stats(
  n_chains = 10,
  statistic = "size",
  offspring_dist = rpois,
  stat_threshold = 10,
  lambda = 2
)
summary(chain_stats)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
