<!DOCTYPE html><html lang="en"><head><title>Help for package subscreen</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {subscreen}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#createFilteredTable'><p>Function to create the subgroup filter table</p></a></li>
<li><a href='#createParentTable'><p>Function to create the subgroup parent table</p></a></li>
<li><a href='#createPlot_points_data_complement'><p>Function to create a data set with complement information based on selected subgroup</p></a></li>
<li><a href='#displayOptionsPanel'><p>shiny widgets of display option panel</p></a></li>
<li><a href='#importance'><p>Example importance data set</p></a></li>
<li><a href='#interaction_plot2'><p>Creates an interaction plot used in Explorer and ASMUS-tab in Subgroup Explorer</p></a></li>
<li><a href='#parents'><p>Returns all 'parent'-subgroups of a specific subgroup</p></a></li>
<li><a href='#pseudo_contexts'><p>Function for adding the status of a factorial context (&quot;complete&quot;/&quot;incomplete&quot; or &quot;pseudo complete&quot;) to the</p>
SubScreenResult object (used in subscreencalc if parameter 'factorial = TRUE').</a></li>
<li><a href='#pseudo_func'><p>Generate variables for complete/incomplete/pseudo complete factorial context(s)</p></a></li>
<li><a href='#results'><p>Example results data set without factorial context and complement calculations</p></a></li>
<li><a href='#results_complement_true'><p>Example results data set without factorial context and with complement calculations</p></a></li>
<li><a href='#results_factorial_complement_true'><p>Example results data set with factorial context and complement calculations</p></a></li>
<li><a href='#results_factorial_true'><p>Example results data set with factorial context and without complement calculations</p></a></li>
<li><a href='#subscreen_mosaicPlot'><p>Creates an mosaic plot used in Mosaic-tab in Subgroup Explorer</p></a></li>
<li><a href='#subscreencalc'><p>(i) Calculation of the results for the subgroups</p></a></li>
<li><a href='#subscreenshow'><p>(ii) Visualization</p></a></li>
<li><a href='#subscreenvi'><p>(iii) Determine variable importance</p></a></li>
<li><a href='#variableOptionsPanel'><p>shiny widgets of variable option panel</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Systematic Screening of Study Data for Subgroup Effects</td>
</tr>
<tr>
<td>Version:</td>
<td>4.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Identifying outcome relevant subgroups has now become as simple as possible!
 The formerly lengthy and tedious search for the needle in a haystack will be replaced by a single, comprehensive and coherent presentation.
 The central result of a subgroup screening is a diagram in which each single dot stands for a subgroup. The diagram may show thousands of them. The position of the dot in the diagram is determined by the
 sample size of the subgroup and the statistical measure of the treatment effect in that subgroup. The sample size is shown on the horizontal axis while the treatment effect is displayed on the vertical axis. Furthermore, the diagram shows the line of no effect and the overall study results. For small subgroups, which are found on the left side of the plot, larger random deviations from the mean study effect are expected, while for larger subgroups only small deviations from the study mean can be expected to be chance findings.
 So for a study with no conspicuous subgroup effects, the dots in the figure are expected to form a kind of funnel. Any deviations from this funnel shape hint to conspicuous subgroups.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, plyr, data.table, ggplot2, ggrepel, rlang, stringr,
grDevices, graphics, shiny, DT, stats, shinyjs, methods,
bsplus, colourpicker, dplyr, ranger, shinyWidgets</td>
</tr>
<tr>
<td>Suggests:</td>
<td>parallel, survival, knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-18 15:35:29 UTC; sgfpj</td>
</tr>
<tr>
<td>Author:</td>
<td>Bodo Kirsch [aut, cre],
  Steffen Jeske [aut],
  Julia Eichhorn [aut],
  Susanne Lippert [aut],
  Thomas Schmelter [aut],
  Christoph Muysers [aut],
  Hermann Kulmann [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bodo Kirsch &lt;kirschbodo@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-18 21:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='createFilteredTable'>Function to create the subgroup filter table</h2><span id='topic+createFilteredTable'></span>

<h3>Description</h3>

<p>Function to create the subgroup filter table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createFilteredTable(
  filter1,
  filter2,
  variableChosen1,
  variableChosen2,
  results,
  y,
  x,
  bg.color,
  key
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createFilteredTable_+3A_filter1">filter1</code></td>
<td>
<p>variable name of first filter.</p>
</td></tr>
<tr><td><code id="createFilteredTable_+3A_filter2">filter2</code></td>
<td>
<p>variable name of second filter.</p>
</td></tr>
<tr><td><code id="createFilteredTable_+3A_variablechosen1">variableChosen1</code></td>
<td>
<p>level of first filter variable.</p>
</td></tr>
<tr><td><code id="createFilteredTable_+3A_variablechosen2">variableChosen2</code></td>
<td>
<p>level of second filter variable.</p>
</td></tr>
<tr><td><code id="createFilteredTable_+3A_results">results</code></td>
<td>
<p>results data set object of class &quot;SubScreenResult&quot;.</p>
</td></tr>
<tr><td><code id="createFilteredTable_+3A_y">y</code></td>
<td>
<p>target variable name.</p>
</td></tr>
<tr><td><code id="createFilteredTable_+3A_x">x</code></td>
<td>
<p>variable name.</p>
</td></tr>
<tr><td><code id="createFilteredTable_+3A_bg.color">bg.color</code></td>
<td>
<p>background color.</p>
</td></tr>
<tr><td><code id="createFilteredTable_+3A_key">key</code></td>
<td>
<p>number factors.</p>
</td></tr>
</table>

<hr>
<h2 id='createParentTable'>Function to create the subgroup parent table</h2><span id='topic+createParentTable'></span>

<h3>Description</h3>

<p>Function to create the subgroup parent table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createParentTable(results, parents, y, x, x2, bg.color, navpanel)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createParentTable_+3A_results">results</code></td>
<td>
<p>results data set object of class &quot;SubScreenResult&quot;.</p>
</td></tr>
<tr><td><code id="createParentTable_+3A_parents">parents</code></td>
<td>
<p>subgroup ids parents.</p>
</td></tr>
<tr><td><code id="createParentTable_+3A_y">y</code></td>
<td>
<p>target variable name.</p>
</td></tr>
<tr><td><code id="createParentTable_+3A_x">x</code></td>
<td>
<p>variable name.</p>
</td></tr>
<tr><td><code id="createParentTable_+3A_x2">x2</code></td>
<td>
<p>second variable name.</p>
</td></tr>
<tr><td><code id="createParentTable_+3A_bg.color">bg.color</code></td>
<td>
<p>background color.</p>
</td></tr>
<tr><td><code id="createParentTable_+3A_navpanel">navpanel</code></td>
<td>
<p>navpanel id (&quot;SubscreenExplorer&quot;/&quot;SubscreenComparer&quot;).</p>
</td></tr>
</table>

<hr>
<h2 id='createPlot_points_data_complement'>Function to create a data set with complement information based on selected subgroup</h2><span id='topic+createPlot_points_data_complement'></span>

<h3>Description</h3>

<p>Function to create a data set with complement information based on selected subgroup
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createPlot_points_data_complement(results_tmp, y, sel_ids)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createPlot_points_data_complement_+3A_results_tmp">results_tmp</code></td>
<td>
<p>subscreen data set</p>
</td></tr>
<tr><td><code id="createPlot_points_data_complement_+3A_y">y</code></td>
<td>
<p>target variable</p>
</td></tr>
<tr><td><code id="createPlot_points_data_complement_+3A_sel_ids">sel_ids</code></td>
<td>
<p>selected subgroup id</p>
</td></tr>
</table>

<hr>
<h2 id='displayOptionsPanel'>shiny widgets of display option panel</h2><span id='topic+displayOptionsPanel'></span>

<h3>Description</h3>

<p>shiny widgets of display option panel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>displayOptionsPanel()
</code></pre>

<hr>
<h2 id='importance'>Example importance data set</h2><span id='topic+importance'></span>

<h3>Description</h3>

<p>Example importance data set
</p>

<hr>
<h2 id='interaction_plot2'>Creates an interaction plot used in Explorer and ASMUS-tab in Subgroup Explorer</h2><span id='topic+interaction_plot2'></span>

<h3>Description</h3>

<p>Creates an interaction plot used in Explorer and ASMUS-tab in Subgroup Explorer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interaction_plot2(
  df_data,
  fac1,
  fac2 = NULL,
  fac3 = NULL,
  response,
  bg.col = "#6B6B6B",
  bg.col2 = NULL,
  font.col = "white",
  y.min = "NA",
  y.max = "NA",
  box.col = "white",
  sg_green = "#5cb85c",
  sg_blue = "#3a6791",
  plot_type = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interaction_plot2_+3A_df_data">df_data</code></td>
<td>
<p>data frame with factorial context</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_fac1">fac1</code></td>
<td>
<p>name of factor level 1</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_fac2">fac2</code></td>
<td>
<p>name of factor level 2 (default: NULL)</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_fac3">fac3</code></td>
<td>
<p>name of factor level 3 (default: NULL)</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_response">response</code></td>
<td>
<p>target variable</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_bg.col">bg.col</code></td>
<td>
<p>background color</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_bg.col2">bg.col2</code></td>
<td>
<p>second background color</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_font.col">font.col</code></td>
<td>
<p>font color</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_y.min">y.min</code></td>
<td>
<p>y-axis mininum.</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_y.max">y.max</code></td>
<td>
<p>y-axis maximum.</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_box.col">box.col</code></td>
<td>
<p>box color.</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_sg_green">sg_green</code></td>
<td>
<p>hex code for color palette creation.</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_sg_blue">sg_blue</code></td>
<td>
<p>hex code for color palette creation.</p>
</td></tr>
<tr><td><code id="interaction_plot2_+3A_plot_type">plot_type</code></td>
<td>
<p>linear (&quot;&quot;) or logarithmic (&quot;log&quot;) y-axis (default: &quot;&quot;).</p>
</td></tr>
</table>

<hr>
<h2 id='parents'>Returns all 'parent'-subgroups of a specific subgroup</h2><span id='topic+parents'></span>

<h3>Description</h3>

<p>Returns all 'parent'-subgroups of a specific subgroup
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parents(data, SGID)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parents_+3A_data">data</code></td>
<td>
<p>The &quot;SubScreenResult&quot; object generated via function 'subscreencalc'.</p>
</td></tr>
<tr><td><code id="parents_+3A_sgid">SGID</code></td>
<td>
<p>Subgroup id(s) of the subgroup for which the 'parent'-subgroups are requested.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of 'parent'-subgroups.
</p>

<hr>
<h2 id='pseudo_contexts'>Function for adding the status of a factorial context (&quot;complete&quot;/&quot;incomplete&quot; or &quot;pseudo complete&quot;) to the
SubScreenResult object (used in subscreencalc if parameter 'factorial = TRUE').</h2><span id='topic+pseudo_contexts'></span>

<h3>Description</h3>

<p>Function for adding the status of a factorial context (&quot;complete&quot;/&quot;incomplete&quot; or &quot;pseudo complete&quot;) to the
SubScreenResult object (used in subscreencalc if parameter 'factorial = TRUE').
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo_contexts(data, endpoint, factors)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudo_contexts_+3A_data">data</code></td>
<td>
<p>The list entry 'sge' from the &quot;SubScreenResult&quot; object generated via function 'subscreencalc'.</p>
</td></tr>
<tr><td><code id="pseudo_contexts_+3A_endpoint">endpoint</code></td>
<td>
<p>The vector of target variable(s).</p>
</td></tr>
<tr><td><code id="pseudo_contexts_+3A_factors">factors</code></td>
<td>
<p>The list entry 'factors' from the &quot;SubScreenResult&quot; object generated via function 'subscreencalc'.</p>
</td></tr>
</table>

<hr>
<h2 id='pseudo_func'>Generate variables for complete/incomplete/pseudo complete factorial context(s)</h2><span id='topic+pseudo_func'></span>

<h3>Description</h3>

<p>Generate variables for complete/incomplete/pseudo complete factorial context(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo_func(results, endpoint, factors)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudo_func_+3A_results">results</code></td>
<td>
<p>The list entry 'sge' from the &quot;SubScreenResult&quot; object generated via function 'subscreencalc'.</p>
</td></tr>
<tr><td><code id="pseudo_func_+3A_endpoint">endpoint</code></td>
<td>
<p>The vector of target variable(s).</p>
</td></tr>
<tr><td><code id="pseudo_func_+3A_factors">factors</code></td>
<td>
<p>The list entry 'factors' from the &quot;SubScreenResult&quot; object generated via function 'subscreencalc'.</p>
</td></tr>
</table>

<hr>
<h2 id='results'>Example results data set without factorial context and complement calculations</h2><span id='topic+results'></span>

<h3>Description</h3>

<p>Example results data set without factorial context and complement calculations
</p>

<hr>
<h2 id='results_complement_true'>Example results data set without factorial context and with complement calculations</h2><span id='topic+results_complement_true'></span>

<h3>Description</h3>

<p>Example results data set without factorial context and with complement calculations
</p>

<hr>
<h2 id='results_factorial_complement_true'>Example results data set with factorial context and complement calculations</h2><span id='topic+results_factorial_complement_true'></span>

<h3>Description</h3>

<p>Example results data set with factorial context and complement calculations
</p>

<hr>
<h2 id='results_factorial_true'>Example results data set with factorial context and without complement calculations</h2><span id='topic+results_factorial_true'></span>

<h3>Description</h3>

<p>Example results data set with factorial context and without complement calculations
</p>

<hr>
<h2 id='subscreen_mosaicPlot'>Creates an mosaic plot used in Mosaic-tab in Subgroup Explorer</h2><span id='topic+subscreen_mosaicPlot'></span>

<h3>Description</h3>

<p>Creates an mosaic plot used in Mosaic-tab in Subgroup Explorer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subscreen_mosaicPlot(
  res,
  mos.x,
  mos.y = NULL,
  mos.y2 = NULL,
  mos.z,
  col.bg = c("#424242"),
  col.txt = c("#ffffff"),
  colrange.z = c("#00BCFF", "gray89", "#89D329"),
  scale = "lin"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subscreen_mosaicPlot_+3A_res">res</code></td>
<td>
<p>results data set from subscreencalc</p>
</td></tr>
<tr><td><code id="subscreen_mosaicPlot_+3A_mos.x">mos.x</code></td>
<td>
<p>first endpoint variable</p>
</td></tr>
<tr><td><code id="subscreen_mosaicPlot_+3A_mos.y">mos.y</code></td>
<td>
<p>second endpoint variable (default:NULL)</p>
</td></tr>
<tr><td><code id="subscreen_mosaicPlot_+3A_mos.y2">mos.y2</code></td>
<td>
<p>third endpoint variable (default: NULL)</p>
</td></tr>
<tr><td><code id="subscreen_mosaicPlot_+3A_mos.z">mos.z</code></td>
<td>
<p>reference variable (mosaic size)</p>
</td></tr>
<tr><td><code id="subscreen_mosaicPlot_+3A_col.bg">col.bg</code></td>
<td>
<p>background color (default: '#424242')</p>
</td></tr>
<tr><td><code id="subscreen_mosaicPlot_+3A_col.txt">col.txt</code></td>
<td>
<p>text color font (default: '#ffffff')</p>
</td></tr>
<tr><td><code id="subscreen_mosaicPlot_+3A_colrange.z">colrange.z</code></td>
<td>
<p>three color scale for mosaic colors (default: c('#00BCFF','gray89','#89D329'))</p>
</td></tr>
<tr><td><code id="subscreen_mosaicPlot_+3A_scale">scale</code></td>
<td>
<p>scale of endpoint values linear or logarithmic (default: 'lin')</p>
</td></tr>
</table>

<hr>
<h2 id='subscreencalc'>(i) Calculation of the results for the subgroups</h2><span id='topic+subscreencalc'></span>

<h3>Description</h3>

<p>This function systematically calculates the defined outcome for every combination of subgroups
up to the given level (max_comb), i.e. the number of maximum combinations of subgroup defining factors.
If, e.g., in a study sex, age group (&lt;=60, &gt;60), BMI group (&lt;=25, &gt;25) are of interest, subgroups of level 2
would be, e.g, male subjects with BMI&gt;25 or young females, while subgroups of level 3 would be any combination
of all three variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subscreencalc(
  data,
  eval_function,
  subjectid = "subjid",
  factors = NULL,
  max_comb = 3,
  nkernel = 1,
  par_functions = "",
  verbose = TRUE,
  factorial = FALSE,
  use_complement = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subscreencalc_+3A_data">data</code></td>
<td>
<p>dataframe with study data</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_eval_function">eval_function</code></td>
<td>
<p>name of the function for data analysis</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_subjectid">subjectid</code></td>
<td>
<p>name of variable in data that contains the subject identifier, defaults to subjid</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_factors">factors</code></td>
<td>
<p>character vector containing the names of variables that define the subgroups (required)</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_max_comb">max_comb</code></td>
<td>
<p>maximum number of factor combination levels to define subgruops, defaults to 3</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_nkernel">nkernel</code></td>
<td>
<p>number of kernels for parallelization (defaults to 1)</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_par_functions">par_functions</code></td>
<td>
<p>vector of names of functions used in eval_function to be exported to cluster (needed only if nkernel &gt; 1)</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_verbose">verbose</code></td>
<td>
<p>logical value to switch on/off output of computational information (defaults to TRUE)</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_factorial">factorial</code></td>
<td>
<p>logical value to switch on/off calculation of factorial contexts (defaults to FALSE)</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_use_complement">use_complement</code></td>
<td>
<p>logical value to switch on/off calculation of complement subgroups (defaults to FALSE)</p>
</td></tr>
<tr><td><code id="subscreencalc_+3A_...">...</code></td>
<td>
<p>further parameters which where outdated used for notes and errors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The evaluation function (eval_function) has to defined by the user. The result needs to be a vector of numerical values,
e.g., outcome variable(s) and number of observations/subjects. The input of eval_function is a data frame with the same
structure as the input data frame (data) used in the subsreencalc call. See example below.
Potential errors occurring due to small subgroups should be caught and handled within eval_function.
As the eval_function will be called with every subgroup it may happen that there is only one observation or
only one treatment arm or only observations with missing data going into the eval_function. There should always be valid
result vector be returned (NAs allowed) and no error causing program abort.
For a better display the results may be cut-off to a reasonable range. For example: If my endpoint is a hazard ratio
that is expected to be between 0.5 and 2 I would set all values smaller than 0.01 to 0.01 and values above 100 to 100.
</p>


<h3>Value</h3>

<p>an object of type SubScreenResult of the form
list(sge=H,
max_comb=max_comb,
min_comb=min_comb,
subjectid=subjectid,
treat=treat,
factors=factors,
results_total=eval_function(cbind(F,T)))
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get the pbc data from the survival package
require(survival)
data(pbc, package="survival")
# generate categorical versions of some of the baseline covariates
pbc$ageg[!is.na(pbc$age)]        &lt;-
   ifelse(pbc$age[!is.na(pbc$age)]          &lt;= median(pbc$age,     na.rm=TRUE), "Low", "High")
pbc$albuming[!is.na(pbc$albumin)]&lt;-
   ifelse(pbc$albumin[!is.na(pbc$albumin)]  &lt;= median(pbc$albumin, na.rm=TRUE), "Low", "High")
pbc$phosg[!is.na(pbc$alk.phos)]  &lt;-
   ifelse(pbc$alk.phos[!is.na(pbc$alk.phos)]&lt;= median(pbc$alk.phos,na.rm=TRUE), "Low", "High")
pbc$astg[!is.na(pbc$ast)]        &lt;-
   ifelse(pbc$ast[!is.na(pbc$ast)]          &lt;= median(pbc$ast,     na.rm=TRUE), "Low", "High")
pbc$bilig[!is.na(pbc$bili)]      &lt;-
   ifelse(pbc$bili[!is.na(pbc$bili)]        &lt;= median(pbc$bili,    na.rm=TRUE), "Low", "High")
pbc$cholg[!is.na(pbc$chol)]      &lt;-
   ifelse(pbc$chol[!is.na(pbc$chol)]        &lt;= median(pbc$chol,    na.rm=TRUE), "Low", "High")
pbc$copperg[!is.na(pbc$copper)]  &lt;-
   ifelse(pbc$copper[!is.na(pbc$copper)]    &lt;= median(pbc$copper,  na.rm=TRUE), "Low", "High")
#eliminate treatment NAs
pbcdat &lt;- pbc[!is.na(pbc$trt), ]
# PFS and OS endpoints
set.seed(2006)
pbcdat$'event.pfs' &lt;- sample(c(0,1),dim(pbcdat)[1],replace=TRUE)
pbcdat$'timepfs' &lt;- sample(1:5000,dim(pbcdat)[1],replace=TRUE)
pbcdat$'event.os' &lt;- pbcdat$event
pbcdat$'timeos' &lt;- pbcdat$time
#variable importance for OS for the created categorical variables
#(higher is more important, also works for numeric variables)
varnames &lt;- c('ageg', 'sex', 'bilig', 'cholg', 'astg', 'albuming', 'phosg')
# define function the eval_function()
# Attention: The eval_function ALWAYS needs to return a dataframe with one row.
#            Include exception handling, like if(N1&gt;0 &amp;&amp; N2&gt;0) hr &lt;- exp(coxph(...) )
#            to avoid program abort due to errors
hazardratio &lt;- function(D) {

 HRpfs &lt;- tryCatch(exp(coxph(Surv(D$timepfs, D$event.pfs) ~ D$trt )$coefficients[[1]]),
  warning=function(w) {NA})
 HRpfs &lt;- 1/HRpfs
 HR.pfs &lt;- round(HRpfs, 2)
 HR.pfs[HR.pfs &gt; 10]      &lt;- 10
 HR.pfs[HR.pfs &lt; 0.00001] &lt;- 0.00001
 HRos &lt;- tryCatch(exp(coxph(Surv(D$timeos, D$event.os) ~ D$trt )$coefficients[[1]]),
  warning=function(w) {NA})
 HRos &lt;- 1/HRos
 HR.os &lt;- round(HRos, 2)
 HR.os[HR.os &gt; 10]      &lt;- 10
 HR.os[HR.os &lt; 0.00001] &lt;- 0.00001
 data.frame( HR.pfs, HR.os#, N.of.subjects,N1 ,N2
 )
}

 # run subscreen

## Not run: 
results &lt;- subscreencalc(
  data=pbcdat,
  eval_function=hazardratio,
  subjectid = "id",
  factors=c("ageg", "sex", "bilig", "cholg", "copperg"),
  use_complement = FALSE,
  factorial = FALSE
)

# visualize the results of the subgroup screening with a Shiny app
subscreenshow(results)

## End(Not run)
</code></pre>

<hr>
<h2 id='subscreenshow'>(ii) Visualization</h2><span id='topic+subscreenshow'></span>

<h3>Description</h3>

<p>Start the Shiny based interactive visualization tool to show the subgroup results
generated by subscreencalc.
See and explore all subgroup results at one glance. Pick and chose a specific
subgroup, the level of combinations or a certain factor with its combinations.
Switch easily between different endpoint/target variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subscreenshow(
  scresults = NULL,
  variable_importance = NULL,
  host = NULL,
  port = NULL,
  NiceNumbers = c(1, 1.5, 2, 4, 5, 6, 8, 10),
  windowTitle = "Subgroup Explorer",
  graphSubtitle = NULL,
  favour_label_verum_name = NULL,
  favour_label_comparator_name = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subscreenshow_+3A_scresults">scresults</code></td>
<td>
<p>SubScreenResult object with results from a subscreencalc call</p>
</td></tr>
<tr><td><code id="subscreenshow_+3A_variable_importance">variable_importance</code></td>
<td>
<p>variable importance object calculated via subscreenvi to unlock
'variable importance'-tab in the app</p>
</td></tr>
<tr><td><code id="subscreenshow_+3A_host">host</code></td>
<td>
<p>host name or IP address for Shiny display</p>
</td></tr>
<tr><td><code id="subscreenshow_+3A_port">port</code></td>
<td>
<p>port number for Shiny display</p>
</td></tr>
<tr><td><code id="subscreenshow_+3A_nicenumbers">NiceNumbers</code></td>
<td>
<p>list of numbers used for a 'nice' scale</p>
</td></tr>
<tr><td><code id="subscreenshow_+3A_windowtitle">windowTitle</code></td>
<td>
<p>title which is shown for the browser tab</p>
</td></tr>
<tr><td><code id="subscreenshow_+3A_graphsubtitle">graphSubtitle</code></td>
<td>
<p>subtitle for explorer plot</p>
</td></tr>
<tr><td><code id="subscreenshow_+3A_favour_label_verum_name">favour_label_verum_name</code></td>
<td>
<p>verum name for label use in explorer graph</p>
</td></tr>
<tr><td><code id="subscreenshow_+3A_favour_label_comparator_name">favour_label_comparator_name</code></td>
<td>
<p>comparator name for label use in explorer graph</p>
</td></tr>
</table>

<hr>
<h2 id='subscreenvi'>(iii) Determine variable importance</h2><span id='topic+subscreenvi'></span>

<h3>Description</h3>

<p>Determine variable importance for continuous, categorical or right-censored
survival endpoints (overall and per treatment group) using random forests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subscreenvi(data, y, cens = NULL, x = NULL, trt = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subscreenvi_+3A_data">data</code></td>
<td>
<p>The data frame containing the dependent and independent variables.</p>
</td></tr>
<tr><td><code id="subscreenvi_+3A_y">y</code></td>
<td>
<p>The name of the column in <code>data</code> that contains the dependent variable.</p>
</td></tr>
<tr><td><code id="subscreenvi_+3A_cens">cens</code></td>
<td>
<p>The name of the column in <code>data</code> that contains the censoring variable, if <code>y</code> is an event time (default=NULL).</p>
</td></tr>
<tr><td><code id="subscreenvi_+3A_x">x</code></td>
<td>
<p>Vector that contains the names of the columns in <code>data</code> with the independent variables (default=NULL, i.e. all remaining variables)</p>
</td></tr>
<tr><td><code id="subscreenvi_+3A_trt">trt</code></td>
<td>
<p>The name of the column in <code>data</code> that contains the treatment variable (default=NULL).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing ordered data frames with the variable importances
(one for each treatment level, one with the ranking variability between the
treatment levels and one with the total results)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
require(survival)
data(pbc, package="survival")
# generate categorical versions of some of the baseline covariates
pbc$ageg[!is.na(pbc$age)]        &lt;-
  ifelse(pbc$age[!is.na(pbc$age)]          &lt;= median(pbc$age,     na.rm=TRUE), "Low", "High")
pbc$albuming[!is.na(pbc$albumin)]&lt;-
  ifelse(pbc$albumin[!is.na(pbc$albumin)]  &lt;= median(pbc$albumin, na.rm=TRUE), "Low", "High")
pbc$phosg[!is.na(pbc$alk.phos)]  &lt;-
  ifelse(pbc$alk.phos[!is.na(pbc$alk.phos)]&lt;= median(pbc$alk.phos,na.rm=TRUE), "Low", "High")
pbc$astg[!is.na(pbc$ast)]        &lt;-
  ifelse(pbc$ast[!is.na(pbc$ast)]          &lt;= median(pbc$ast,     na.rm=TRUE), "Low", "High")
pbc$bilig[!is.na(pbc$bili)]      &lt;-
  ifelse(pbc$bili[!is.na(pbc$bili)]        &lt;= median(pbc$bili,    na.rm=TRUE), "Low", "High")
pbc$cholg[!is.na(pbc$chol)]      &lt;-
  ifelse(pbc$chol[!is.na(pbc$chol)]        &lt;= median(pbc$chol,    na.rm=TRUE), "Low", "High")
pbc$copperg[!is.na(pbc$copper)]  &lt;-
  ifelse(pbc$copper[!is.na(pbc$copper)]    &lt;= median(pbc$copper,  na.rm=TRUE), "Low", "High")
pbc$ageg[is.na(pbc$age)]         &lt;- "No Data"
pbc$albuming[is.na(pbc$albumin)] &lt;- "No Data"
pbc$phosg[is.na(pbc$alk.phos)]   &lt;- "No Data"
pbc$astg[is.na(pbc$ast)]         &lt;- "No Data"
pbc$bilig[is.na(pbc$bili)]       &lt;- "No Data"
pbc$cholg[is.na(pbc$chol)]       &lt;- "No Data"
pbc$copperg[is.na(pbc$copper)]   &lt;- "No Data"
#eliminate treatment NAs
pbcdat &lt;- pbc[!is.na(pbc$trt), ]
pbcdat$status &lt;- ifelse(pbcdat$status==0,0,1)
importance &lt;- subscreenvi(data=pbcdat, y='time', cens='status',
 trt='trt', x=c("ageg", "sex", "bilig", "cholg", "copperg"))

## End(Not run)
</code></pre>

<hr>
<h2 id='variableOptionsPanel'>shiny widgets of variable option panel</h2><span id='topic+variableOptionsPanel'></span>

<h3>Description</h3>

<p>shiny widgets of variable option panel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variableOptionsPanel()
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
