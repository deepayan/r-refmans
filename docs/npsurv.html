<!DOCTYPE html><html lang="en"><head><title>Help for package npsurv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {npsurv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acfail'><p>Air Conditioner Failure Data</p></a></li>
<li><a href='#ap'><p>Angina Pectoris Survival Data</p></a></li>
<li><a href='#cancer'><p>Breast Retraction Times after Beast Cancer Treatments.</p></a></li>
<li><a href='#Deltamatrix'><p>Delta matrix</p></a></li>
<li><a href='#gastric'><p>Gastric Cancer Survival Data</p></a></li>
<li><a href='#hazuh'><p>Distributional Functions given a U-shaped Hazard Function</p></a></li>
<li><a href='#icendata'><p>Class of Interval-censored Data</p></a></li>
<li><a href='#idf'><p>Interval Distribution Function</p></a></li>
<li><a href='#km'><p>Kaplan-Meier Estimation</p></a></li>
<li><a href='#leukemia'><p>Remission Times for Acute Leukemia Patients</p></a></li>
<li><a href='#logLikuh'><p>Computes the Log-likelihood Value of a U-shaped Hazard Function</p></a></li>
<li><a href='#marijuana'><p>Angina Pectoris Survival Data</p></a></li>
<li><a href='#npsurv'><p>Nonparametric Survival Function Estimation</p></a></li>
<li><a href='#nzmort'><p>New Zealand Mortality in 2000</p></a></li>
<li><a href='#plot.npsurv'><p>Plot Functions for Nonparametric Survival Estimation</p></a></li>
<li><a href='#plot.Uhaz'><p>Plot Functions for U-shaped Hazard Estimation</p></a></li>
<li><a href='#uh'><p>U-shaped Hazard Function</p></a></li>
<li><a href='#Uhaz'><p>U-shaped Hazard Function Estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Nonparametric Survival Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-09-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Yong Wang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yong Wang &lt;yongwang@auckland.ac.nz&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>lsei</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Description:</td>
<td>Non-parametric survival analysis of exact and
	     interval-censored observations. The methods implemented
	     are developed by Wang (2007)
	     &lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2007.00583.x">doi:10.1111/j.1467-9868.2007.00583.x</a>&gt;, Wang (2008)
	     &lt;<a href="https://doi.org/10.1016%2Fj.csda.2007.10.018">doi:10.1016/j.csda.2007.10.018</a>&gt;, Wang and Taylor (2013)
	     &lt;<a href="https://doi.org/10.1007%2Fs11222-012-9341-9">doi:10.1007/s11222-012-9341-9</a>&gt; and Wang and Fani (2018)
	     &lt;<a href="https://doi.org/10.1007%2Fs11222-017-9724-z">doi:10.1007/s11222-017-9724-z</a>&gt;.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.stat.auckland.ac.nz/~yongwang/">https://www.stat.auckland.ac.nz/~yongwang/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-19 02:02:58 UTC; yong</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-20 14:40:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='acfail'>Air Conditioner Failure Data</h2><span id='topic+acfail'></span>

<h3>Description</h3>

<p>Contains the number of operating hours between successive failure times of
the air conditioning systems in Boeing airplanes
</p>


<h3>Format</h3>

<p>A numeric vector storing the failure times.
</p>


<h3>Source</h3>

<p>Proschan (1963)
</p>


<h3>References</h3>

<p>Proschan, F. (1963). Theoretical explanation of observed
decreasing failure rate. <em>Technometrics</em>, <b>5</b>, 375-383.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Uhaz">Uhaz</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(acfail)
r = Uhaz(acfail, deg=2)
plot(r$h, fn="h")
plot(r$h, fn="d")

</code></pre>

<hr>
<h2 id='ap'>Angina Pectoris Survival Data</h2><span id='topic+ap'></span>

<h3>Description</h3>

<p>Contains the survival times in years from the time of diagnosis for 2418
male patients with angina pectoris. Some patients are lost to follow-up,
hence giving right-censored observations. Each integer-valued survival time
is treated as being censored within a one-year interval.
</p>


<h3>Format</h3>

<p>A data frame with 30 observations and 3 variables:
</p>
<p><code>L</code>: left-end point of an interval-censored retraction time;
</p>
<p><code>R</code>: right-end point of an interval-censored retraction time;
</p>
<p><code>count</code>: number of patients in the interval.
</p>


<h3>Source</h3>

<p>Lee and Wang (2003), page 92.
</p>


<h3>References</h3>

<p>Lee, E. T. and Wang, J. W. (2003). <em>Statistical Methods for
Survival Data Analysis</em>. Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npsurv">npsurv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ap)
r = Uhaz(ap, deg=2)           # smooth U-shaped hazard
plot(r$h, fn="h")             # hazard
plot(r$h, fn="d")             # density

# NPMLE and shape-restricted estimation
plot(npsurv(ap), fn="s")      # survival under no shape restriction
plot(r$h, fn="s", add=TRUE)   # survival with smooth U-shaped hazard

</code></pre>

<hr>
<h2 id='cancer'>Breast Retraction Times after Beast Cancer Treatments.</h2><span id='topic+cancer'></span>

<h3>Description</h3>

<p>Contains the breast retraction times in months for 94 breast cancer patients
who received either radiation therapy or radiation therapy plus adjuvant
chemotherapy.
</p>


<h3>Format</h3>

<p>A data frame with 94 observations and 3 variables:
</p>
<p>L: left-end points of the interval-censored retraction times;
</p>
<p>R: right-end points of the interval-censored retraction times;
</p>
<p>group: either <code>RT</code> (radiation therapy) or <code>RCT</code> (radiation therapy
plus adjuvant chemotherapy).
</p>


<h3>Source</h3>

<p>Finkelstein and Wolfe (1985).
</p>


<h3>References</h3>

<p>Finkelstein, D. M. and R. A. Wolfe (1985). A semiparametric
model for regression analysis of interval-censored failure time data.
<em>Biometrics</em>, <b>41</b>, pp.933-945.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npsurv">npsurv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(cancer)
i = cancer$group == "RT"
plot(npsurv(cancer[i,1:2]), xlim=c(0,60))
plot(npsurv(cancer[!i,1:2]), add=TRUE, col="green3")

</code></pre>

<hr>
<h2 id='Deltamatrix'>Delta matrix</h2><span id='topic+Deltamatrix'></span>

<h3>Description</h3>

<p><code>Deltamatrix</code> computes the Delta matrix, along with maximal
intersection intervals, for a set of intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Deltamatrix(LR)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Deltamatrix_+3A_lr">LR</code></td>
<td>
<p>two-column matrix, each row of which stores an censoring interval
of the form <code class="reqn">(L_i, R_i]</code>.  If <code class="reqn">L_i = </code><code class="reqn">
R_i</code>, it is an exact observation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An intersection interval is a nonempty intersection of any combination of
the given intervals, and a maximal intersection interval is an intersection
interval that contains no other intersection interval.
</p>
<p>The Delta matrix is a matrix of indicators (<code>TRUE</code> or <code>FALSE</code>).
The rows correspond to the given interval-censored observations, and the
columns the maximal intersection intervals. A <code>TRUE</code> value of the
(i,j)-th element means that the i-th observation covers the j-th maximal
intersection interval, and a <code>FALSE</code> value means the opposite.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>left</code></td>
<td>
<p>left endpoints of the maximal intersection intervals.</p>
</td></tr>
<tr><td><code>right</code></td>
<td>
<p>right endpoints of the maximal intersection intervals.</p>
</td></tr>
<tr><td><code>Delta</code></td>
<td>
<p>logical matrix, for the Delta matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2008). Dimension-reduced nonparametric maximum likelihood
computation for interval-censored data.  <em>Computational Statistics &amp;
Data Analysis</em>, <b>52</b>, 2388-2402.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+idf">idf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(x = cbind(1:5,1:5*3-2))
Deltamatrix(x)

</code></pre>

<hr>
<h2 id='gastric'>Gastric Cancer Survival Data</h2><span id='topic+gastric'></span>

<h3>Description</h3>

<p>Contains the survival times of 45 gastrointestinal tumor patients who were
treated with both chemotherapy and radiotherapy. It has both exact and
right-censored observations.
</p>


<h3>Format</h3>

<p>A data frame with 30 observations and 3 variables:
</p>
<p>L: left-end points of the interval-censored survival times;
</p>
<p>R: right-end points of the interval-censored survival times.
</p>


<h3>Source</h3>

<p>Klein and Moeschberger (2003), page 224.
</p>


<h3>References</h3>

<p>Klein, J. P. and Moeschberger, M. L. (2003).  <em>Survival
Analysis: Techniques for Censored and Truncated Data (2nd ed.)</em>.  Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npsurv">npsurv</a></code>, <code><a href="#topic+Uhaz">Uhaz</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(gastric)
plot(npsurv(gastric), col="grey")      # survival function
plot(h0&lt;-Uhaz(gastric, deg=0)$h, fn="s", add=TRUE, col="green3")
plot(h1&lt;-Uhaz(gastric, deg=1)$h, fn="s", add=TRUE)
plot(h2&lt;-Uhaz(gastric, deg=2)$h, fn="s", add=TRUE, col="red3")

plot(h0, fn="h", col="green3")         # hazard function
plot(h1, fn="h", add=TRUE)
plot(h2, fn="h", add=TRUE, col="red3")

plot(h0, fn="d", col="green3")         # density function
plot(h1, fn="d", add=TRUE)
plot(h2, fn="d", add=TRUE, col="red3") 


</code></pre>

<hr>
<h2 id='hazuh'>Distributional Functions given a U-shaped Hazard Function</h2><span id='topic+hazuh'></span><span id='topic+chazuh'></span><span id='topic+survuh'></span><span id='topic+denuh'></span>

<h3>Description</h3>

<p>Given an object of class <code>uh</code>:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hazuh(t, h)
chazuh(t, h)
survuh(t, h)
denuh(t, h)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hazuh_+3A_t">t</code></td>
<td>
<p>time points at which the function is to be evaluated.</p>
</td></tr>
<tr><td><code id="hazuh_+3A_h">h</code></td>
<td>
<p>an object of class <code>uh</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>hazuh</code> computes the hazard values;
</p>
<p><code>chazuh</code> computes the cumulative hazard values;
</p>
<p><code>survuh</code> computes the survival function values;
</p>
<p><code>denuh</code> computes the density function values.
</p>


<h3>Value</h3>

<p>A numeric vector of the function values.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. and Fani, S. (2018). Nonparametric maximum likelihood
computation of a U-shaped hazard function. <em>Statistics and
Computing</em>, <b>28</b>, 187-200.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Uhaz">Uhaz</a></code>, <code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+plot.uh">plot.uh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ap)
h = Uhaz(icendata(ap), deg=2)$h
hazuh(0:15, h)     # hazard
chazuh(0:15, h)    # cumulative hazard
survuh(0:15, h)    # survival probability
denuh(0:15, h)     # density

</code></pre>

<hr>
<h2 id='icendata'>Class of Interval-censored Data</h2><span id='topic+icendata'></span><span id='topic+is.icendata'></span><span id='topic+icendata.object'></span>

<h3>Description</h3>

<p>Class <code>icendata</code> can be used to store general
interval-censored data, which may possibly contain exact
observations.There are several functions associated with the
class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>icendata(x, w=1)
is.icendata(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="icendata_+3A_x">x</code></td>
<td>
<p>vector or matrix.</p>
</td></tr>
<tr><td><code id="icendata_+3A_w">w</code></td>
<td>
<p>weights or multiplicities of the observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>icendata</code> creates an object of class 'icendata', which can be
used to save both interval-censored and exact observations.
</p>
<p>Function <code>is.icendata</code> simply checks if an object is of class
'icendata'.
</p>
<p>If <code>x</code> is a vector, it contains only exact observations, with weights
given in <code>w</code>.
</p>
<p>If <code>x</code> is a two-column matrix, it contains interval-censored
observations and stores their left and right endpoints in the first and
second column, respectively. If the left and right endpoints are equal, then
the observation is exact. Weights are provided by <code>w</code>.
</p>
<p>If <code>x</code> is a three-column matrix, it contains interval-censored
observations and stores their left and right endpoints in the first and
second column, respectively. The weight of each observation is the
third-column value multiplied by the corresponding weight value in <code>w</code>.
</p>
<p>It is useful to turn interval-censored (and exact) observations into the
format imposed by <code>icendata</code> so that they can be processed in a
standardized format by other functions. Also, exact and interval-censored
observations are stored separately in this format and can hence be dealt
with more easily. Most functions in the package <code>npsurv</code> first ensure
that the data has this format before processing.
</p>
<p>Observations of zero weights are removed. Identical observations are
aggregated.
</p>
<p>An interval-valued observation is either <code class="reqn">(L_i, R_i]</code> if
<code class="reqn">L_i &lt; R_i</code>, or <code class="reqn">[L_i, R_i]</code> if <code class="reqn">L_i =
R_i</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>t</code></td>
<td>
<p>numeric vector, storing exact observations.</p>
</td></tr>
<tr><td><code>wt</code></td>
<td>
<p>numeric vector, storing the weights of exact observations.</p>
</td></tr>
<tr><td><code>o</code></td>
<td>
<p>two-column numeric matrix, storing interval-censored observations.</p>
</td></tr>
<tr><td><code>wo</code></td>
<td>
<p>numeric vector, storing the weights of interval-censored
observations.</p>
</td></tr>
<tr><td><code>i1</code></td>
<td>
<p>logical vector, indicating whether exact observations are less
than <code>upper</code>.</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>the largest finite value of <code>t</code> and <code>o</code>.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>numeric vector, containing 0 and all unique finite values in
<code>t</code> and <code>o</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2008). Dimension-reduced nonparametric maximum likelihood
computation for interval-censored data. Computational Statistics &amp; Data
Analysis, 52, 2388-2402.
</p>
<p>Wang, Y. and Fani, S. (2017). Nonparametric maximum likelihood computation
of a U-shaped hazard function. <em>Statistics and Computing</em>, (in print).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npsurv">npsurv</a></code>, <code><a href="#topic+Uhaz">Uhaz</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ap)
(x = icendata(ap))
is.icendata(x)

data(gastric)
icendata(gastric)

data(leukemia)
i = leukemia[,"group"] == "6-MP"
icendata(leukemia[i,1:2])

</code></pre>

<hr>
<h2 id='idf'>Interval Distribution Function</h2><span id='topic+idf'></span><span id='topic+idf.object'></span><span id='topic+print.idf'></span>

<h3>Description</h3>

<p>Class <code>idf</code> can be used to store a distribution function
defined on a set of intervals. There are several functions
associated with the class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idf(left, right, p)
## S3 method for class 'idf'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idf_+3A_left">left</code>, <code id="idf_+3A_right">right</code></td>
<td>
<p>left and right endpoints of intervals on which the
distribution function is defined.</p>
</td></tr>
<tr><td><code id="idf_+3A_p">p</code></td>
<td>
<p>probabilities allocated to the intervals. Probability values will
be normalized inside the function.</p>
</td></tr>
<tr><td><code id="idf_+3A_x">x</code></td>
<td>
<p>an object of class <code>idf</code>.</p>
</td></tr>
<tr><td><code id="idf_+3A_...">...</code></td>
<td>
<p>other arguments for printing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>idf</code> creates an object of class <code>idf</code>. An <code>idf</code> object
stores a distribution function defined on a set of intervals.
</p>
<p>When left and right endpoints are identical, the intervals just
represent exact points.
</p>
<p><code>print.idf</code> prints an object of class <code>idf</code> as a three-coumn
matrix.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>left</code>, <code>right</code></td>
<td>
<p>left and right endpoints of intervals on which the
distribution function is defined.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>probabilities allocated to the intervals.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+Deltamatrix">Deltamatrix</a></code>,
<code><a href="#topic+npsurv">npsurv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
idf(1:5, 1:5*3-2, c(1,1,2,2,4))
npsurv(cbind(1:5, 1:5*3-2))$f    # NPMLE 

</code></pre>

<hr>
<h2 id='km'>Kaplan-Meier Estimation</h2><span id='topic+km'></span>

<h3>Description</h3>

<p><code>km</code> computes the nonparametric maximum likelihood esimate (NPMLE) of a
survival function for right-censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>km(data, w = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="km_+3A_data">data</code></td>
<td>
<p>vector or matrix, or an object of class <code>icendata</code>.</p>
</td></tr>
<tr><td><code id="km_+3A_w">w</code></td>
<td>
<p>weights/multiplicities of observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For details about the arguments, see <code>icendata</code>.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>f</code></td>
<td>
<p>NPMLE, an object of class <code>idf</code>.</p>
</td></tr>
<tr><td><code>ll</code></td>
<td>
<p>log-likelihood value of the NPMLE <code>f</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Kaplan, E. L. and Meier, P. (1958). Nonparametric estimation from incomplete
observations. <em>Journal of the American Statistical Association</em>,
<b>53</b>, 457-481.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+npsurv">npsurv</a></code>, <code><a href="#topic+idf">idf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x = cbind(1:5, c(1,Inf,3,4,Inf))
(f = km(x)$f)
plot(f)

data(leukemia)
i = leukemia[,"group"] == "Placebo"
plot(km(leukemia[i,1:2])$f, xlim=c(0,40), col="green3") # placebo
plot(km(leukemia[!i,1:2])$f, add=TRUE)                  # 6-MP

</code></pre>

<hr>
<h2 id='leukemia'>Remission Times for Acute Leukemia Patients</h2><span id='topic+leukemia'></span>

<h3>Description</h3>

<p>Contains remission times in weeks of 42 acute leukemia patients, who
received either the treatment of drug 6-mercaptopurine or the placebo
treatment. Each remission time is either exactly observed or right-censored.
</p>


<h3>Format</h3>

<p>A data frame with 42 observations and 3 variables:
</p>
<p>L: left-end points of the interval-censored remission times in weeks;
</p>
<p>R: right-end points of the interval-censored remission times;
</p>
<p>group: either 6-MP (6-mercaptopurine) or Placebo.
</p>


<h3>Source</h3>

<p>Freireich et al. (1963).
</p>


<h3>References</h3>

<p>Freireich, E. O. et al. (1963). The effect of 6-mercaptopmine on
the duration of steroid induced remission in acute leukemia. <em>Blood</em>,
<b>21</b>, 699-716.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npsurv">npsurv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(leukemia)
i = leukemia[,"group"] == "Placebo"
plot(npsurv(leukemia[i,1:2]), xlim=c(0,40), col="green3") # placebo
plot(npsurv(leukemia[!i,1:2]), add=TRUE)                  # 6-MP

## Treat each remission time as interval-censored:
x = leukemia
ii = x[,1] == x[,2]
x[ii,2] = x[ii,1] + 1
plot(npsurv(x[i,1:2]), xlim=c(0,40), col="green3")        # placebo
plot(npsurv(x[!i,1:2]), add=TRUE)                         # 6-MP

</code></pre>

<hr>
<h2 id='logLikuh'>Computes the Log-likelihood Value of a U-shaped Hazard Function</h2><span id='topic+logLikuh'></span>

<h3>Description</h3>

<p><code>logLikuh</code> returns the log-likelihood value of a U-shaped hazard
function, given a data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLikuh(h, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLikuh_+3A_h">h</code></td>
<td>
<p>an object of class <code>uh</code>.</p>
</td></tr>
<tr><td><code id="logLikuh_+3A_data">data</code></td>
<td>
<p>numeric vector or matrix for exact or interval-censored
observations, or an object of class <code>icendata</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Log-likelihood value evaluated at <code>h</code>, given <code>data</code>.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. and Fani, S. (2018). Nonparametric maximum likelihood
computation of a U-shaped hazard function. <em>Statistics and
Computing</em>, <b>28</b>, 187-200.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Uhaz">Uhaz</a></code>, <code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+plot.uh">plot.uh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ap)
(h0 = uh(.2, NULL, NULL, NULL, NULL, 15, 1))   # Uniform hazard
plot(h0, ylim=c(0,.3))
logLikuh(h0, ap)

r = Uhaz(ap, deg=2)
r$ll
logLikuh(r$h, ap)
plot(r$h, add=TRUE, col="red3")

</code></pre>

<hr>
<h2 id='marijuana'>Angina Pectoris Survival Data</h2><span id='topic+marijuana'></span>

<h3>Description</h3>

<p>Contains the answers of 191 California high school students to the question:
&quot;When did you first use marijuana?&quot;. An answer can be an exact age, or &quot;I
have never used it&quot;, which gives rise to a right-censored observation, or &quot;I
have used it but cannot recall just when the first time was&quot;, which gives
rise to a left-censored observation.
</p>


<h3>Format</h3>

<p>A data frame with 21 observations and 3 variables:
</p>
<p>L: left-end point of an interval-censored time;
</p>
<p>R: right-end point of an interval-censored time;
</p>
<p>count: number of students in the interval.
</p>


<h3>Source</h3>

<p>Turnbull and Weiss (1978). See also Klein and Moeschberger (1997),
page 17.
</p>


<h3>References</h3>

<p>Turnbull and Weiss (1978). A likelihood ratio statistic
fortesting goodness of fit with randomly censored data. <em>Biometrics</em>,
<b>34</b>, 367-375.
</p>
<p>Klein and Moeschberger (2003). <em>Survival Analysis: Techniques for
Censored and Truncated Data</em> (2nd ed.). Springer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+npsurv">npsurv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(marijuana)
r = Uhaz(marijuana, deg=2)
plot(r$h, fn="h")
plot(r$h, fn="s")

</code></pre>

<hr>
<h2 id='npsurv'>Nonparametric Survival Function Estimation</h2><span id='topic+npsurv'></span><span id='topic+npsurv.object'></span>

<h3>Description</h3>

<p><code>npsurv</code> computes the nonparametric maximum likelihood esimate (NPMLE)
of a survival function for general interval-censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npsurv(data, w = 1, maxit = 100, tol = 1e-06, verb = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="npsurv_+3A_data">data</code></td>
<td>
<p>vector or matrix, or an object of class <code>icendata</code>.</p>
</td></tr>
<tr><td><code id="npsurv_+3A_w">w</code></td>
<td>
<p>weights or multiplicities of the observations.</p>
</td></tr>
<tr><td><code id="npsurv_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr><td><code id="npsurv_+3A_tol">tol</code></td>
<td>
<p>tolerance level for stopping the algorithm. It is used as the
threshold on the increase of the log-likelihood after each iteration.</p>
</td></tr>
<tr><td><code id="npsurv_+3A_verb">verb</code></td>
<td>
<p>verbosity level for printing intermediate results at each
iteration.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>data</code> is a vector, it contains only exact observations, with
weights given in <code>w</code>.
</p>
<p>If <code>data</code> is a matrix with two columns, it contains interval-censored
observations, with the two columns storing their left and right end-points,
respectively. If the left and right end-points are equal, then the
observation is exact. Weights are provided by <code>w</code>.
</p>
<p>If <code>data</code> is a matrix with three columns, it contains interval-censored
observations, with the first two columns storing their left and right
end-points, respectively. The weight of each observation is the third-column
value multiplied by the corresponding weight value in <code>w</code>.
</p>
<p>The algorithm used for computing the NPMLE is either the constrained Newton
method (CNM) (Wang, 2008), or the hierachical constrained Newton method
(HCNM) (Wang and Taylor, 2013) when there are a large number of maximal
intersection intervals.
</p>
<p>Inside the function, it examines if data has only right censoring, and if
so, the Kaplan-Meier estimate is computed directly by function <code>km</code>.
</p>
<p>An interval-valued observation is either <code class="reqn">(L_i, R_i]</code> if
<code class="reqn">L_i &lt; R_i</code>, or <code class="reqn">[L_i, R_i]</code> if <code class="reqn">L_i =
R_i</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>npsurv</code>, which is a list with components:
</p>
<table role = "presentation">
<tr><td><code>f</code></td>
<td>
<p>NPMLE, an object of class <code>idf</code>.</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>largest finite value in the data.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>= <code>TRUE</code>, converged successfully;
</p>
<p>= <code>FALSE</code>, maximum number of iterations reached.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method used internally, either <code>cnm</code> or <code>hcnm</code>.</p>
</td></tr>
<tr><td><code>ll</code></td>
<td>
<p>log-likelihood value of the NPMLE <code>f</code>.</p>
</td></tr>
<tr><td><code>maxgrad</code></td>
<td>
<p>maximum gradient value of the NPMLE <code>f</code>.</p>
</td></tr>
<tr><td><code>numiter</code></td>
<td>
<p>number of iterations used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2008). Dimension-reduced nonparametric maximum likelihood
computation for interval-censored data. <em>Computational Statistics &amp;
Data Analysis</em>, <b>52</b>, 2388-2402.
</p>
<p>Wang, Y. and Taylor, S. M. (2013). Efficient computation of nonparametric
survival functions via a hierarchical mixture formulation. <em>Statistics
and Computing</em>, <b>23</b>, 713-725.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+Deltamatrix">Deltamatrix</a></code>,
<code><a href="#topic+idf">idf</a></code>, <code><a href="#topic+km">km</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## all exact observations
data(acfail)
plot(npsurv(acfail))

## right-censored (and exact) observations
data(gastric)
plot(npsurv(gastric))

data(leukemia)
i = leukemia[,"group"] == "Placebo"
plot(npsurv(leukemia[i,1:2]), xlim=c(0,40), col="blue") # placebo
plot(npsurv(leukemia[!i,1:2]), add=TRUE, col="red")     # 6-MP

## purely interval-censored data
data(ap)
plot(npsurv(ap))

data(cancer)
cancerRT = with(cancer, cancer[group=="RT",1:2])
plot(npsurv(cancerRT), xlim=c(0,60))                  # survival of RT 
cancerRCT = with(cancer, cancer[group=="RCT",1:2])
plot(npsurv(cancerRCT), add=TRUE, col="green")        # survival of RCT 

</code></pre>

<hr>
<h2 id='nzmort'>New Zealand Mortality in 2000</h2><span id='topic+nzmort'></span>

<h3>Description</h3>

<p>Contains the number of deaths of Maori and Non-Maori people at each age in
New Zealand in 2000.
</p>


<h3>Format</h3>

<p>A data frame with 210 observations and 3 variables:
</p>
<p>age: at which age the deaths occurred;
</p>
<p>deaths: number of people died at the age;
</p>
<p>ethnic: either Maori or Non-Maori.
</p>


<h3>Details</h3>

<p>Data contains no age with zero death.
</p>


<h3>Source</h3>

<p><a href="https://www.mortality.org/">https://www.mortality.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Uhaz">Uhaz</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(nzmort)
x = with(nzmort, nzmort[ethnic=="maori",])[,1:2]      # Maori mortality
# x = with(nzmort, nzmort[ethnic!="maori",])[,1:2]    # Non-Maori mortality

## As exact observations
# Plot hazard functions
h0 = Uhaz(x[,1]+0.5, x[,2], deg=0)$h    # U-shaped hazard
plot(h0, fn="h", col="green3", pch=2)
h1 = Uhaz(x[,1]+0.5, x[,2], deg=1)$h    # convex hazard
plot(h1, fn="h", add=TRUE, pch=1)
h2 = Uhaz(x[,1]+0.5, x[,2], deg=2)$h    # smooth U-shaped hazard
plot(h2, fn="h", add=TRUE, col="red3")

# Plot densities
age = 0:max(x[,1])
count = integer(length(age))
count[x[,"age"]+1] = x[,"deaths"]
barplot(count/sum(count), space=0, col="lightgrey", ylab="Density")
axis(1, pos=NA, at=0:10*10)
plot(h0, fn="d", add=TRUE, col="green3", pch=2)
plot(h1, fn="d", add=TRUE, col="blue3", pch=1)
plot(h2, fn="d", add=TRUE, col="red3", pch=19)

## As interval-censored observations
# Plot hazard functions
x2 = cbind(x[,1], x[,1]+1, x[,2])
h0 = Uhaz(x2, deg=0)$h      # U-shaped hazard
plot(h0, fn="h", col="green3", pch=2)
h1 = Uhaz(x2, deg=1)$h      # convex hazard
plot(h1, fn="h", add=TRUE, pch=1)
h2 = Uhaz(x2, deg=2)$h      # smooth U-shaped hazard
plot(h2, fn="h", add=TRUE, col="red3", pch=1)

# Plot densities
barplot(count/sum(count), space=0, col="lightgrey")
axis(1, pos=NA, at=0:10*10)
plot(h0, fn="d", add=TRUE, col="green3", pch=2)
plot(h1, fn="d", add=TRUE, col="blue3", pch=1)
plot(h2, fn="d", add=TRUE, col="red3", pch=19)

</code></pre>

<hr>
<h2 id='plot.npsurv'>Plot Functions for Nonparametric Survival Estimation</h2><span id='topic+plot.npsurv'></span><span id='topic+plot.idf'></span><span id='topic+plotsurvidf'></span><span id='topic+plotgradidf'></span>

<h3>Description</h3>

<p>Functions for plotting nonparametric survival functions and related ones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'npsurv'
plot(x, ...)
## S3 method for class 'idf'
plot(x, data, fn=c("surv","grad"), ...)
plotsurvidf(f, style=c("box","uniform","left","right","midpoint"),
           xlab="Time", ylab="Survival Probability", col="blue3", fill=0,  
           add=FALSE, lty=1, lty.inf=2, xlim, ...)
plotgradidf(f, data, w=1, col1="red3", col2="blue3", 
           xlab="Survival Time", ylab="Gradient", xlim, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.npsurv_+3A_x">x</code></td>
<td>
<p>an object of class <code>npsurv</code> (i.e., an output of function
<code>npsurv</code>) or an object of class <code>idf</code>.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_...">...</code></td>
<td>
<p>arguments for other graphical parameters (see <code>par</code>).</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_fn">fn</code></td>
<td>
<p>either &quot;surv&quot; or &quot;grad&quot;, to indicate plotting either the survival
or the gradient function.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_f">f</code></td>
<td>
<p>an object of class <code>idf</code>.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_style">style</code></td>
<td>
<p>for how to plot the survival function on a &quot;maximal
intersection interval&quot;:
</p>
<p>= <code>box</code>, plot a rectangle, which shows the uncertainty of probability
allocation within the interval;
</p>
<p>= <code>uniform</code>, treat it as a uniform distribution and hence the diagonal
line of the rectangle is plotted;
</p>
<p>= <code>left</code>, plot only the left side of the rectangle;
</p>
<p>= <code>right</code>, plot only the right side of the rectangle;
</p>
<p>= <code>midpoint</code>, plot a vertical line at the midpoint of the interval.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_xlab">xlab</code>, <code id="plot.npsurv_+3A_ylab">ylab</code></td>
<td>
<p>x- or y-axis label.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_add">add</code></td>
<td>
<p>= <code>TRUE</code>, adds the curve to the existing plot;
</p>
<p>= <code>FALSE</code>, plots the curve in a new one.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_col">col</code></td>
<td>
<p>color for all line segments, including box/rectangle borders.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_fill">fill</code></td>
<td>
<p>color for filling a box/rectangle. By default, a lighter
semi-transparent color is used.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_lty">lty</code></td>
<td>
<p>line type</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_lty.inf">lty.inf</code></td>
<td>
<p>line type for the rectangle that may extend to infinity.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_data">data</code></td>
<td>
<p>vector or matrix that stores observations, or an object of class
<code>icendata</code>.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_w">w</code></td>
<td>
<p>additional weights/multiplicities of the observations stored in
<code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_col1">col1</code></td>
<td>
<p>color for drawing maximal intersection intervals allocated with
positive probabilities.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_col2">col2</code></td>
<td>
<p>color for drawing all gradients and the maximal intersection
intervals allocated with zero probabilities.</p>
</td></tr>
<tr><td><code id="plot.npsurv_+3A_xlim">xlim</code></td>
<td>
<p>x-coordinate limit points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot.npsurv</code> and <code>plot.idf</code> are wrapper functions that call
either <code>plotsurvidf</code> or <code>plotgradidf</code>.
</p>
<p><code>plotsurvidf</code> plots the survival function of the nonparametric maximum
likelihood estimate (NPMLE).
</p>
<p><code>plotgradidf</code> plots the gradient function of the NPMLE.
</p>
<p><code>plotsurvidf</code> by default chooses a less saturated color for <code>fill</code>
than <code>col</code>.
</p>
<p><code>plotgradidf</code> plots gradient values as vertical lines located as the
left endpoints of the maximal intersection intervals. Each maximal
intersection interval is plotted as a wider line on the horizontal
zero-gradient line, with a circle to represent the open left endpoint of the
interval and a solid point the closed right endpoint of the interval. The
maximal intersection intervals allocated with positive probabilities have
zero gradients, and hence no vertical lines are drawn for them.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. (2008). Dimension-reduced nonparametric maximum likelihood
computation for interval-censored data. <em>Computational Statistics &amp;
Data Analysis</em>, <b>52</b>, 2388-2402.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+idf">idf</a></code>, <code><a href="#topic+npsurv">npsurv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ap)
plot(r&lt;-npsurv(ap))              # survival function
plot(r$f, ap, fn="g")            # all gradients virtually zeros.

data(cancer)
cancerRT = with(cancer, cancer[group=="RT",1:2])
plot(rt&lt;-npsurv(cancerRT), xlim=c(0,60))                  # survival of RT 
cancerRCT = with(cancer, cancer[group=="RCT",1:2])
plot(rct&lt;-npsurv(cancerRCT), add=TRUE, col="green3") # survival of RCT 
## as uniform dististrbutions.
plot(rt, add=TRUE, style="uniform", col="blue3")
plot(rct, add=TRUE, style="uniform", col="green3")

## plot gradients; must supply data
plot(rt, cancerRT, fn="g")        # for group RT
plotgradidf(rct$f, cancerRCT)   # or, for group RCT

</code></pre>

<hr>
<h2 id='plot.Uhaz'>Plot Functions for U-shaped Hazard Estimation</h2><span id='topic+plot.Uhaz'></span><span id='topic+plot.uh'></span><span id='topic+plothazuh'></span><span id='topic+plotchazuh'></span><span id='topic+plotsurvuh'></span><span id='topic+plotdenuh'></span><span id='topic+plotgraduh'></span>

<h3>Description</h3>

<p>Functions for plotting various functions in U-shaped hazard estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Uhaz'
plot(x, ...)
## S3 method for class 'uh'
plot(x, data, fn=c("haz","grad","surv","den","chaz"), ...)
plothazuh(h, add=FALSE, col="darkblue", lty=1, xlim, ylim,
         lwd=2, pch=19, len=500, vert=FALSE, add.knots=TRUE,
         xlab="Time", ylab="Hazard", ...)
plotchazuh(h, add=FALSE, lwd=2, len=500, col="darkblue",
          pch=19, add.knots=TRUE, vert=FALSE, xlim, ylim, ...)
plotdenuh(h, add=FALSE, lty=1, lwd=2, col="darkblue",
         add.knots=TRUE, pch=19, ylim, len=500, vert=FALSE, ...)
plotsurvuh(h, add=FALSE, lty=1, lwd=2, len=500, vert=FALSE,
          col="darkblue", pch=19, add.knots=TRUE, xlim, ylim, ...)
plotgraduh(h, data, w=1, len=500, xlim, ylim, vert=TRUE,
          add=FALSE, xlab="Time", ylab="Gradient",
          col0="red3", col1="blue3", col2="green3", order=0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.Uhaz_+3A_x">x</code></td>
<td>
<p>an object of class <code>Uhaz</code>, i.e., an output of function
<code>Uhaz</code>, or an object of class <code>uh</code>..</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_...">...</code></td>
<td>
<p>arguments for other graphical parameters (see <code>par</code>).</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_h">h</code></td>
<td>
<p>an object of class <code>uh</code>.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_data">data</code></td>
<td>
<p>vector or matrix that stores observations, or an object of class
<code>icendata</code>.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_w">w</code></td>
<td>
<p>additional weights/multiplicities for the observations stored in
<code>data</code>.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_fn">fn</code></td>
<td>
<p>function to be plotted. It can be
</p>
<p>= <code>haz</code>, for hazard function;
</p>
<p>= <code>chaz</code>, for cumulative hazard function;
</p>
<p>= <code>den</code>, for density function;
</p>
<p>= <code>surv</code>, for survival function;
</p>
<p>= <code>gradient</code>, for gradient functions.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_xlim">xlim</code>, <code id="plot.Uhaz_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y coordinates
ranges.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_xlab">xlab</code>, <code id="plot.Uhaz_+3A_ylab">ylab</code></td>
<td>
<p>x- or y-axis labels.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_add">add</code></td>
<td>
<p>= <code>TRUE</code>, adds the curve to the existing plot;
</p>
<p>= <code>FALSE</code>, plots the curve in a new one.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_col">col</code></td>
<td>
<p>color used for plotting the curve.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_lty">lty</code></td>
<td>
<p>line type for plotting the curve.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_lwd">lwd</code></td>
<td>
<p>line width for plotting the curve.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_len">len</code></td>
<td>
<p>number of points used to plot a curve.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_add.knots">add.knots</code></td>
<td>
<p>logical, indicating if knots are also plotted.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_pch">pch</code></td>
<td>
<p>point character/type for plotting knots.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_vert">vert</code></td>
<td>
<p>logical, indicating if grey vertical lines are plotted to show
the interval that separates the two discrete measures.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_col0">col0</code></td>
<td>
<p>color for gradient function 0, i.e., for the hazard-constant
part, or alpha.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_col1">col1</code></td>
<td>
<p>color for gradient function 1, i.e., for the hazard-decreasing
part.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_col2">col2</code></td>
<td>
<p>color for gradient function 1, i.e., for the hazard-increasing
part.</p>
</td></tr>
<tr><td><code id="plot.Uhaz_+3A_order">order</code></td>
<td>
<p>= 0, the gradient functions are plotted;
</p>
<p>= 1, their first derivatives are plotted;
</p>
<p>= 2, their second derivatives are plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot.Uhaz</code> and <code>plot.uh</code> are wrapper functions that can be used
to invoke <code>plot.hazuh</code>, <code>plot.chazuh</code>, <code>plot.survuh</code>,
<code>plot.denuh</code> or <code>plot.graduh</code>.
</p>
<p><code>plothazuh</code> plots a U-shaped hazard function.
</p>
<p><code>plotchazuh</code> plots a cumulative hazard function that has a U-shaped
hazard function.
</p>
<p><code>plotsurvuh</code> plots the survival function that has a U-shaped hazard
function.
</p>
<p><code>plotdenuh</code> plots the density function that has a U-shaped hazard
function.
</p>
<p><code>plotgraduh</code> plots the gradient function that has a U-shaped hazard
function.
</p>
<p>A U-shaped hazard function is given by
</p>
<p style="text-align: center;"><code class="reqn">h(t) = \alpha + \sum_{j = 1}^k \nu_j(\tau_j - t)_+^p + \sum_{j = 1}^{m} \mu_j (t-\eta_j)_+^p,</code>
</p>

<p>where <code class="reqn">\alpha,\nu_j,\mu_j \ge 0</code>,
<code class="reqn">\tau_1 &lt; \cdots &lt; \tau_k \le \eta_1 &lt; \cdots &lt; \eta_m,</code> and <code class="reqn">p \ge 0</code>.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Wang, Y. and Fani, S. (2018). Nonparametric maximum likelihood
computation of a U-shaped hazard function. <em>Statistics and
Computing</em>, <b>28</b>, 187-200.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+uh">uh</a></code>, <code><a href="#topic+npsurv">npsurv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Angina Pectoris Survival Data
data(ap)
plot(r&lt;-Uhaz(ap))              # hazard function for a convex hazard
plot(r, fn="c")                # cumulative hazard function
plot(r, fn="s")                # survival function
plot(r, fn="d")                # density function
plot(r, ap, fn="g")            # gradient functions
plot(r, ap, fn="g", order=1)   # first derivatives of gradient functions
plot(r, ap, fn="g", order=2)   # second derivatives of gradient functions

## New Zealand Mortality in 2000
data(nzmort)
i = nzmort$ethnic == "maori"
x = nzmort[i,1:2]                            # Maori mortality
h = Uhaz(x[,1]+0.5, x[,2], deg=2)$h          # smooth U-shaped hazard
plot(h)                        # hazard function
plot(h, fn="d")                # density function
plot(h, fn="s")                # survival function

x2 = nzmort[!i,1:2]                          # Non-Maori mortality
h2 = Uhaz(x2[,1]+0.5, x2[,2], deg=2)$h
plot(h2, fn="s", add=TRUE, col="green3")

</code></pre>

<hr>
<h2 id='uh'>U-shaped Hazard Function</h2><span id='topic+uh'></span><span id='topic+uh.object'></span><span id='topic+print.uh'></span>

<h3>Description</h3>

<p>Class <code>uh</code> can be used to store U-shaped hazard functions.
There are a couple of functions associated with the class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uh(alpha, tau, nu, eta, mu, upper=Inf, deg=1, collapse=TRUE)
## S3 method for class 'uh'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uh_+3A_alpha">alpha</code></td>
<td>
<p>a nonnegative value, for the constant coefficient.</p>
</td></tr>
<tr><td><code id="uh_+3A_tau">tau</code></td>
<td>
<p>vector of nonnegative real values, for left knots.</p>
</td></tr>
<tr><td><code id="uh_+3A_nu">nu</code></td>
<td>
<p>vector of nonnegative values, for masses associated with the left
knots.</p>
</td></tr>
<tr><td><code id="uh_+3A_eta">eta</code></td>
<td>
<p>vector of nonnegative real values, for right knots.</p>
</td></tr>
<tr><td><code id="uh_+3A_mu">mu</code></td>
<td>
<p>vector of nonnegative real values, for masses associated with the
right knots.</p>
</td></tr>
<tr><td><code id="uh_+3A_upper">upper</code></td>
<td>
<p>a positive value, at which point the hazard starts to become
infinite.</p>
</td></tr>
<tr><td><code id="uh_+3A_deg">deg</code></td>
<td>
<p>nonnegative real number for spline degree (i.e., p in the formula
below).</p>
</td></tr>
<tr><td><code id="uh_+3A_collapse">collapse</code></td>
<td>
<p>logical, indicating if identical knots should be collapsed.</p>
</td></tr>
<tr><td><code id="uh_+3A_x">x</code></td>
<td>
<p>an object of class <code>uh</code>.</p>
</td></tr>
<tr><td><code id="uh_+3A_...">...</code></td>
<td>
<p>other auguments for printing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>uh</code> creates an object of class <code>uh</code>, which stores a U-shaped
hazard function.
</p>
<p><code>print.uh</code> prints an object of class <code>uh</code>.
</p>
<p>A U-shape hazard function, as generalized by Wang and Fani (2018), is given
by
</p>
<p style="text-align: center;"><code class="reqn">h(t) = \alpha + \sum_{j = 1}^k \nu_j(\tau_j - t)_+^p + \sum_{j = 1}^{m} \mu_j (t-\eta_j)_+^p,</code>
</p>

<p>where <code class="reqn">\alpha,\nu_j,\mu_j \ge 0</code>,
<code class="reqn">\tau_1 &lt; \cdots &lt; \tau_k \le \eta_1 &lt; \cdots &lt; \eta_m,</code> and <code class="reqn">p \ge 0</code> is the the spline degree which
determines the smoothness of the U-shaped hazard. As p increases, the family
of hazard functions becomes increasingly smoother, but at the same time,
smaller. When <code class="reqn">p = 0</code>, the hazard function is U-shaped, as
studied by Bray et al. (1967). When <code class="reqn">p = 1</code>, the hazard function
is convex, as studied by Jankowski and Wellner (2009a,b).
</p>
<p><code>print.uh</code> prints an object of class <code>uh</code>. While <code>alpha</code>,
<code>upper</code> and <code>deg</code> are printed as they are, <code>tau</code> and
<code>nu</code> are printed as a two-column matrix, and so are <code>eta</code> and
<code>mu</code>.
</p>


<h3>Value</h3>

<p><code>uh</code> returns an object of class <code>uh</code>. It is a list with components
<code>alpha</code>, <code>tau</code>, <code>nu</code>, <code>eta</code>, <code>mu</code>, <code>upper</code> and
<code>deg</code>, which store their corresponding values as described above.
</p>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Bray, T. A., Crawford, G. B., and Proschan, F. (1967).  <em>Maximum
Likelihood Estimation of a U-shaped Failure Rate Function</em>. Defense
Technical Information Center.
</p>
<p>Jankowski, H. K. and Wellner, J. A. (2009a). Computation of nonparametric
convex hazard estimators via profile methods. <em>Journal of Nonparametric
Statistics</em>, <b>21</b>, 505-518.
</p>
<p>Jankowski, H. K. and Wellner, J. A. (2009b). Nonparametric estimation of a
convex bathtub-shaped hazard function. <em>Bernoulli</em>, <b>15</b>,
1010-1035.
</p>
<p>Wang, Y. and Fani, S. (2018). Nonparametric maximum likelihood
computation of a U-shaped hazard function. <em>Statistics and
Computing</em>, <b>28</b>, 187-200.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Uhaz">Uhaz</a></code>, <code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+plot.uh">plot.uh</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(h0 = uh(3, 2, 3, 4, 5, 7, deg=0))              # deg = 0
plot(h0, ylim=c(0,20))
(h1 = uh(4, 2, 3, 5, 6, 7, deg=1))              # deg = 1
plot(h1, add=TRUE, col="green3")
(h2 = uh(1, 1:2, 3:4, 5:6, 7:8, 9, deg=2))      # deg = 2
plot(h2, add=TRUE, col="red3")

</code></pre>

<hr>
<h2 id='Uhaz'>U-shaped Hazard Function Estimation</h2><span id='topic+Uhaz'></span><span id='topic+Uhaz.object'></span>

<h3>Description</h3>

<p><code>Uhaz</code> computes the nonparametric maximum likelihood esimate (NPMLE) of
a U-shaped hazard function from exact or interval-censored data, or a mix of
the two types of data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Uhaz(data, w = 1, deg = 1, maxit = 100, tol = 1e-06, verb = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Uhaz_+3A_data">data</code></td>
<td>
<p>vector or matrix, or an object of class <code>icendata</code>.</p>
</td></tr>
<tr><td><code id="Uhaz_+3A_w">w</code></td>
<td>
<p>weights or multiplicities of the observations.</p>
</td></tr>
<tr><td><code id="Uhaz_+3A_deg">deg</code></td>
<td>
<p>nonnegative real number for spline degree (i.e., p in the formula
below).</p>
</td></tr>
<tr><td><code id="Uhaz_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr><td><code id="Uhaz_+3A_tol">tol</code></td>
<td>
<p>tolerance level for stopping the algorithm. It is used as the
threshold on the increase of the log-likelihood after each iteration.</p>
</td></tr>
<tr><td><code id="Uhaz_+3A_verb">verb</code></td>
<td>
<p>verbosity level for printing intermediate results in each
iteration.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>data</code> is a vector, it contains only exact observations, with
weights given in <code>w</code>.
</p>
<p>If <code>data</code> is a matrix with two columns, it contains interval-censored
observations, with the two columns storing their left and right end-points,
respectively. If the left and right end-points are equal, then the
observation is exact. Weights are provided by <code>w</code>.
</p>
<p>If <code>data</code> is a matrix with three columns, it contains interval-censored
observations, with the first two columns storing their left and right
end-points, respectively. The weight of each observation is the third-column
value multiplied by the corresponding weight value in <code>w</code>.
</p>
<p>The algorithm used for the computing the NPMLE of a hazard function under
the U-shape restriction is is proposed by Wang and Fani (2015). Such a
hazard function is given by
</p>
<p>A U-shaped hazard function is given by
</p>
<p style="text-align: center;"><code class="reqn">h(t) = \alpha + \sum_{j = 1}^k \nu_j(\tau_j - t)_+^p + \sum_{j = 1}^{m} \mu_j (t-\eta_j)_+^p,</code>
</p>

<p>where <code class="reqn">\alpha,\nu_j,\mu_j \ge 0</code>,
<code class="reqn">\tau_1 &lt; \cdots &lt; \tau_k \le \eta_1 &lt; \cdots &lt; \eta_m,</code> and <code class="reqn">p \ge 0</code> is the the spline degree which
determines the smoothness of the U-shaped hazard. As p increases, the family
of hazard functions becomes increasingly smoother, but at the time, smaller.
When p = 0, the hazard function is U-shaped, as studied by Bray et al.
(1967). When p = 1, the hazard function is convex, as studied by Jankowski
and Wellner (2009a,b).
</p>
<p>Note that <code>deg</code> (i.e., p in the above mathematical display) can take on
any nonnegative real value.
</p>


<h3>Value</h3>

<p>An object of class <code>Uhaz</code>, which is a list with components:
</p>
<table role = "presentation">
<tr><td><code>convergence</code></td>
<td>
<p>= <code>TRUE</code>, converged successfully;
</p>
<p>= <code>FALSE</code>, maximum number of iterations reached.</p>
</td></tr>
<tr><td><code>grad</code></td>
<td>
<p>gradient values at the knots.</p>
</td></tr>
<tr><td><code>numiter</code></td>
<td>
<p>number of iterations used.</p>
</td></tr>
<tr><td><code>ll</code></td>
<td>
<p>log-likelihood value of the NPMLE <code>h</code>.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>NPMLE of the U-shaped hazard function, an object of class
<code>uh</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yong Wang &lt;yongwang@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>Bray, T. A., Crawford, G. B., and Proschan, F. (1967).  <em>Maximum
Likelihood Estimation of a U-shaped Failure Rate Function</em>. Defense
Technical Information Center.
</p>
<p>Jankowski, H. K. and Wellner, J. A. (2009a). Computation of nonparametric
convex hazard estimators via profile methods. <em>Journal of Nonparametric
Statistics</em>, <b>21</b>, 505-518.
</p>
<p>Jankowski, H. K. and Wellner, J. A. (2009b). Nonparametric estimation of a
convex bathtub-shaped hazard function. <em>Bernoulli</em>, <b>15</b>,
1010-1035.
</p>
<p>Wang, Y. and Fani, S. (2018). Nonparametric maximum likelihood
computation of a U-shaped hazard function. <em>Statistics and
Computing</em>, <b>28</b>, 187-200.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+icendata">icendata</a></code>, <code><a href="#topic+nzmort">nzmort</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Interval-censored observations
data(ap)
(r = Uhaz(ap, deg=0))
plot(r, ylim=c(0,.3), col=1)
for(i in 1:6) plot(Uhaz(ap, deg=i/2), add=TRUE, col=i+1)
legend(15, 0.01, paste0("deg = ", 0:6/2), lwd=2, col=1:7, xjust=1, yjust=0)

## Exact observations
data(nzmort)
x = with(nzmort, nzmort[ethnic=="maori",])[,1:2]   # Maori mortality
(h0 = Uhaz(x[,1]+0.5, x[,2], deg=0)$h)     # U-shaped hazard
(h1 = Uhaz(x[,1]+0.5, x[,2], deg=1)$h)     # convex hazard
(h2 &lt;- Uhaz(x[,1]+0.5, x[,2], deg=2)$h)    # smooth U-shaped hazard

plot(h0, pch=2)                            # plot hazard functions
plot(h1, add=TRUE, col="green3", pch=1)
plot(h2, add=TRUE, col="red3", pch=19)

age = 0:max(x[,1])                         # plot densities
count = integer(length(age))
count[x[,"age"]+1] = x[,"deaths"]
barplot(count/sum(count), space=0, col="lightgrey")
axis(1, pos=NA, at=0:10*10)
plot(h0, fn="d", add=TRUE, pch=2)
plot(h1, fn="d", add=TRUE, col="green3", pch=1)
plot(h2, fn="d", add=TRUE, col="red3", pch=19)

plot(h0, fn="s", pch=2)                    # plot survival functions
plot(h1, fn="s", add=TRUE, col="green3", pch=1)
plot(h2, fn="s", add=TRUE, col="red3", pch=19)

## Exact and right-censored observations
data(gastric)
plot(h0&lt;-Uhaz(gastric, deg=0)$h)           # plot hazard functions
plot(h1&lt;-Uhaz(gastric, deg=1)$h, add=TRUE, col="green3")
plot(h2&lt;-Uhaz(gastric, deg=2)$h, add=TRUE, col="red3")

plot(npsurv(gastric), fn="s", col="grey")  # plot survival functions
plot(h0, fn="s", add=TRUE)
plot(h1, fn="s", add=TRUE, col="green3")
plot(h2, fn="s", add=TRUE, col="red3")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
