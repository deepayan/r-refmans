<!DOCTYPE html><html><head><title>Help for package GDINA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GDINA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#att.structure'><p>Generate hierarchical attribute structures</p></a></li>
<li><a href='#attributepattern'><p>Generate all possible attribute patterns</p></a></li>
<li><a href='#autoGDINA'><p>Q-matrix validation, model selection and calibration in one run</p></a></li>
<li><a href='#bdiagMatrix'><p>Create a block diagonal matrix</p></a></li>
<li><a href='#bootSE'><p>Calculating standard errors and variance-covariance matrix using bootstrap methods</p></a></li>
<li><a href='#CA'><p>Calculate classification accuracy</p></a></li>
<li><a href='#cjoint'><p>Combine R Objects by Columns</p></a></li>
<li><a href='#ClassRate'><p>Classification Rate Evaluation</p></a></li>
<li><a href='#designmatrix'><p>Generate design matrix</p></a></li>
<li><a href='#dif'><p>Differential item functioning for cognitive diagnosis models</p></a></li>
<li><a href='#DTM'><p>Experimental function for diagnostic multiple-strategy CDMs</p></a></li>
<li><a href='#ecpe'><p>Examination for the Certificate of Proficiency in English (ECPE) data</p></a></li>
<li><a href='#extract'><p>extract elements from objects of various classes</p></a></li>
<li><a href='#frac20'><p>Tatsuoka's fraction subtraction data</p></a></li>
<li><a href='#GDINA'><p>CDM calibration under the G-DINA model framework</p></a></li>
<li><a href='#GDINA-package'><p>The Generalized DINA Model Framework</p></a></li>
<li><a href='#GMSCDM'><p>Estimating multiple-strategy cognitive diagnosis models</p></a></li>
<li><a href='#ILCA'><p>Iterative latent-class analysis</p></a></li>
<li><a href='#indlogLik'><p>Extract log-likelihood for each individual</p></a></li>
<li><a href='#indlogPost'><p>Extract log posterior for each individual</p></a></li>
<li><a href='#itemfit'><p>Item fit statistics</p></a></li>
<li><a href='#itemparm'><p>extract item parameters (deprecated)</p></a></li>
<li><a href='#LC2LG'><p>Transformation between latent classes and latent groups</p></a></li>
<li><a href='#MCmodel'><p>Multiple-choice models</p></a></li>
<li><a href='#modelcomp'><p>Item-level model comparison using Wald, LR or LM tests</p></a></li>
<li><a href='#modelfit'><p>Model fit statistics</p></a></li>
<li><a href='#monocheck'><p>This function checks if monotonicity is violated</p></a></li>
<li><a href='#npar'><p>Calculate the number of parameters</p></a></li>
<li><a href='#personparm'><p>calculate person (incidental) parameters</p></a></li>
<li><a href='#plot.GDINA'><p>Create plots for GDINA estimates</p></a></li>
<li><a href='#plot.itemfit'><p>Item fit plots</p></a></li>
<li><a href='#plot.Qval'><p>Mesa plot for Q-matrix validation</p></a></li>
<li><a href='#Qval'><p>Q-matrix validation</p></a></li>
<li><a href='#rowMatch'><p>Count the frequency of a row vector in a data frame</p></a></li>
<li><a href='#score'><p>Score function</p></a></li>
<li><a href='#sim10GDINA'><p>Simulated data (10 items, G-DINA model)</p></a></li>
<li><a href='#sim10MCDINA'><p>Simulated data (10 items, MC-DINA model)</p></a></li>
<li><a href='#sim10MCDINA2'><p>Simulated data (10 items, MC-DINA model)</p></a></li>
<li><a href='#sim20seqGDINA'><p>Simulated data (20 items, sequential G-DINA model)</p></a></li>
<li><a href='#sim21seqDINA'><p>Simulated data (21 items, sequential DINA model)</p></a></li>
<li><a href='#sim30DINA'><p>Simulated data (30 items, DINA model)</p></a></li>
<li><a href='#sim30GDINA'><p>Simulated data (30 items, G-DINA model)</p></a></li>
<li><a href='#sim30pGDINA'><p>Simulated data (30 items, polytomous G-DINA model)</p></a></li>
<li><a href='#simDTM'><p>Simulating data for diagnostic tree model</p></a></li>
<li><a href='#simGDINA'><p>Data simulation based on the G-DINA models</p></a></li>
<li><a href='#startGDINA'><p>Graphical user interface of the GDINA function</p></a></li>
<li><a href='#unique_only'><p>Unique values in a vector</p></a></li>
<li><a href='#unrestrQ'><p>Generate unrestricted Qc matrix from an restricted Qc matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Generalized DINA Model Framework</td>
</tr>
<tr>
<td>Version:</td>
<td>2.9.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-07-01</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of psychometric tools for cognitive diagnosis modeling based on the generalized deterministic inputs, noisy and gate (G-DINA) model by de la Torre (2011) &lt;<a href="https://doi.org/10.1007%2Fs11336-011-9207-7">doi:10.1007/s11336-011-9207-7</a>&gt; and its extensions, including the sequential G-DINA model by Ma and de la Torre (2016) &lt;<a href="https://doi.org/10.1111%2Fbmsp.12070">doi:10.1111/bmsp.12070</a>&gt; for polytomous responses, and the polytomous G-DINA model by Chen and de la Torre &lt;<a href="https://doi.org/10.1177%2F0146621613479818">doi:10.1177/0146621613479818</a>&gt; for polytomous attributes. Joint attribute distribution can be independent, saturated, higher-order, loglinear smoothed or structured. Q-matrix validation, item and model fit statistics, model comparison at test and item level and differential item functioning can also be conducted. A graphical user interface is also provided. For tutorials, please check Ma and de la Torre (2020) &lt;<a href="https://doi.org/10.18637%2Fjss.v093.i14">doi:10.18637/jss.v093.i14</a>&gt;, Ma and de la Torre (2019) &lt;<a href="https://doi.org/10.1111%2Femip.12262">doi:10.1111/emip.12262</a>&gt;, Ma (2019) &lt;<a href="https://doi.org/10.1007%2F978-3-030-05584-4_29">doi:10.1007/978-3-030-05584-4_29</a>&gt; and de la Torre and Akbay (2019). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>alabama, graphics, ggplot2, MASS, numDeriv, nloptr, Rcpp (&ge;
0.12.1), Rsolnp, stats, shiny, shinydashboard, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>CDM, cdmTools, Matrix, testthat, poLCA, stringr, knitr,
rmarkdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Wenchao-Ma/GDINA">https://github.com/Wenchao-Ma/GDINA</a>,
<a href="https://wenchao-ma.github.io/GDINA/">https://wenchao-ma.github.io/GDINA/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Wenchao-Ma/GDINA/issues">https://github.com/Wenchao-Ma/GDINA/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Wenchao Ma [aut, cre, cph],
  Jimmy de la Torre [aut, cph],
  Miguel Sorrel [ctb],
  Zhehan Jiang [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wenchao Ma &lt;wenchao.ma@ua.edu&gt;</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Collate:</td>
<td>'CA.R' 'CR.R' 'DTM.R' 'ExportedFuncs.R' 'GDINA.R' 'GDI.R'
'GDINA-package.R' 'GMSCDM.R' 'HO.R' 'ILCA.R' 'M2.R' 'MCmodel.R'
'Mstep.R' 'Mstep_DTM.R' 'MultipleGroup_Estimation.R'
'RcppExports.R' 'SingleGroup_Estimation.R' 'anova.GDINA.R'
'autoGDINA.R' 'bootSE.R' 'coef.R' 'dif.R' 'ecpe.R' 'simGDINA.R'
'itemfit.R' 'modelcomp.R' 'extract.R' 'frac20.R'
'itemparm.GDINA.R' 'monocheck.R' 'personparm.GDINA.R'
'plotIRF.GDINA.R' 's3GDINA.R' 'print.GDINA.R' 'score.R'
'sim10GDINA.R' 'sim10MCDINA.R' 'sim10MCDINA2.R'
'sim20seqGDINA.R' 'sim21seqDINA.R' 'sim30DINA.R' 'sim30GDINA.R'
'sim30pGDINA.R' 'startGDINA.R' 'structuralparm.R'
'summary.GDINA.R' 'utils.R' 'zzz.R'</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-01 21:23:04 UTC; wench</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-01 22:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='att.structure'>Generate hierarchical attribute structures</h2><span id='topic+att.structure'></span>

<h3>Description</h3>

<p>This function can be used to generate hierarchical attributes structures, and
to provide prior joint attribute distribution with hierarchical structures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>att.structure(hierarchy.list = NULL, K, Q, att.prob = "uniform")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="att.structure_+3A_hierarchy.list">hierarchy.list</code></td>
<td>
<p>a list specifying the hierarchical structure between attributes. Each
element in this list specifies a DIRECT prerequisite relation between two or more attributes.
See <code>example</code> for more information.</p>
</td></tr>
<tr><td><code id="att.structure_+3A_k">K</code></td>
<td>
<p>the number of attributes involved in the assessment</p>
</td></tr>
<tr><td><code id="att.structure_+3A_q">Q</code></td>
<td>
<p>Q-matrix</p>
</td></tr>
<tr><td><code id="att.structure_+3A_att.prob">att.prob</code></td>
<td>
<p>How are the probabilities for latent classes simulated? It can be <code>"random"</code> or <code>"uniform"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>att.str reduced latent classes under the specified hierarchical structure
</p>
<p>impossible.latentclass impossible latent classes under the specified hierarchical structure
</p>
<p>att.prob probabilities for all latent classes; 0 for impossible latent classes
</p>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code>, <code><a href="#topic+autoGDINA">autoGDINA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#################
#
# Leighton et al. (2004, p.210)
#
##################
# linear structure A1-&gt;A2-&gt;A3-&gt;A4-&gt;A5-&gt;A6
K &lt;- 6
linear=list(c(1,2),c(2,3),c(3,4),c(4,5),c(5,6))
att.structure(linear,K)

# convergent structure A1-&gt;A2-&gt;A3-&gt;A5-&gt;A6;A1-&gt;A2-&gt;A4-&gt;A5-&gt;A6
K &lt;- 6
converg &lt;- list(c(1,2),c(2,3),c(2,4),
               c(3,4,5), #this is how to show that either A3 or A4 is a prerequisite to A5
               c(5,6))
att.structure(converg,K)

# convergent structure [the difference between this one and the previous one is that
#                       A3 and A4 are both needed in order to master A5]
K &lt;- 6
converg2 &lt;- list(c(1,2),c(2,3),c(2,4),
               c(3,5), #this is how to specify that both A3 and A4 are needed for A5
               c(4,5), #this is how to specify that both A3 and A4 are needed for A5
               c(5,6))
att.structure(converg2,K)

# divergent structure A1-&gt;A2-&gt;A3;A1-&gt;A4-&gt;A5;A1-&gt;A4-&gt;A6
diverg &lt;- list(c(1,2),
               c(2,3),
               c(1,4),
               c(4,5),
               c(4,6))
att.structure(diverg,K)

# unstructured A1-&gt;A2;A1-&gt;A3;A1-&gt;A4;A1-&gt;A5;A1-&gt;A6
unstru &lt;- list(c(1,2),c(1,3),c(1,4),c(1,5),c(1,6))
att.structure(unstru,K)

## See Example 4 and 5 in GDINA function

## End(Not run)
</code></pre>

<hr>
<h2 id='attributepattern'>Generate all possible attribute patterns</h2><span id='topic+attributepattern'></span>

<h3>Description</h3>

<p>This function generates all possible attribute patterns. The Q-matrix needs to be specified for polytomous attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attributepattern(K, Q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attributepattern_+3A_k">K</code></td>
<td>
<p>number of attributes</p>
</td></tr>
<tr><td><code id="attributepattern_+3A_q">Q</code></td>
<td>
<p>Q-matrix; required when Q-matrix is polytomous</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code class="reqn">2^K\times K</code> matrix consisting of attribute profiles for <code class="reqn">2^K</code> latent classes
</p>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attributepattern(3)

q &lt;- matrix(scan(text = "0 1 2 1 0 1 1 2 0"),ncol = 3)
q
attributepattern(Q=q)

q &lt;- matrix(scan(text = "0 1 1 1 0 1 1 1 0"),ncol = 3)
q
attributepattern(K=ncol(q),Q=q)
</code></pre>

<hr>
<h2 id='autoGDINA'>Q-matrix validation, model selection and calibration in one run</h2><span id='topic+autoGDINA'></span><span id='topic+summary.autoGDINA'></span>

<h3>Description</h3>

<p><code>autoGDINA</code> conducts a series of CDM analyses within the G-DINA framework. Particularly,
the GDINA model is fitted to the data first using the <code><a href="#topic+GDINA">GDINA</a></code> function;
then, the Q-matrix is validated using the function <code><a href="#topic+Qval">Qval</a></code>.
Based on the suggested Q-matrix, the data is fitted by the G-DINA model again, followed
by an item level model selection via the Wald test using <code><a href="#topic+modelcomp">modelcomp</a></code>. Lastly,
the selected models are calibrated based on the suggested Q-matrix using the <code><a href="#topic+GDINA">GDINA</a></code> function.
The Q-matrix validation and item-level model selection can be disabled by the users.
Possible reduced CDMs for Wald test include the DINA model, the DINO model, A-CDM, LLM and RRUM.
See <code>Details</code> for the rules of item-level model selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoGDINA(
  dat,
  Q,
  modelselection = TRUE,
  modelselectionrule = "simpler",
  alpha.level = 0.05,
  modelselection.args = list(),
  Qvalid = TRUE,
  Qvalid.args = list(),
  GDINA1.args = list(),
  GDINA2.args = list(),
  CDM.args = list()
)

## S3 method for class 'autoGDINA'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoGDINA_+3A_dat">dat</code></td>
<td>
<p>A required <code class="reqn">N \times J</code> <code>matrix</code> or <code>data.frame</code> consisting of the
responses of <code class="reqn">N</code> individuals to <code class="reqn">J</code> items. Missing values need to be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_q">Q</code></td>
<td>
<p>A required matrix; The number of rows occupied by a single-strategy dichotomous item is 1, by a polytomous item is
the number of nonzero categories, and by a mutiple-strategy dichotomous item is the number of strategies.
The number of column is equal to the number of attributes if all items are single-strategy dichotomous items, but
the number of attributes + 2 if any items are polytomous or have multiple strategies.
For a polytomous item, the first column represents the item number and the second column indicates the nonzero category number.
For a multiple-strategy dichotomous item, the first column represents the item number and the second column indicates the strategy number.
For binary attributes, 1 denotes the attributes are measured by the items and 0 means the attributes are not
measured. For polytomous attributes, non-zero elements indicate which level
of attributes are needed (see Chen, &amp; de la Torre, 2013).  See <code>Examples</code>.</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_modelselection">modelselection</code></td>
<td>
<p>logical; conducting model selection or not?</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_modelselectionrule">modelselectionrule</code></td>
<td>
<p>how to conducted model selection? Possible options include
<code>simpler</code>, <code>largestp</code> and <code>DS</code>. See <code>Details</code>.</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_alpha.level">alpha.level</code></td>
<td>
<p>nominal level for the Wald test. The default is 0.05.</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_modelselection.args">modelselection.args</code></td>
<td>
<p>arguments passed to <code>modelcomp</code></p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_qvalid">Qvalid</code></td>
<td>
<p>logical; validate Q-matrix or not? <code>TRUE</code> is the default.</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_qvalid.args">Qvalid.args</code></td>
<td>
<p>arguments passed to <code>Qval</code></p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_gdina1.args">GDINA1.args</code></td>
<td>
<p>arguments passed to GDINA function for initial G-DINA calibration</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_gdina2.args">GDINA2.args</code></td>
<td>
<p>arguments passed to GDINA function for the second G-DINA calibration</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_cdm.args">CDM.args</code></td>
<td>
<p>arguments passed to GDINA function for final calibration</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_object">object</code></td>
<td>
<p>GDINA object for various S3 methods</p>
</td></tr>
<tr><td><code id="autoGDINA_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After the Wald statistics for each reduced CDM were calculated for each item, the
reduced models with p values less than the pre-specified alpha level were rejected.
If all reduced models were rejected for an item, the G-DINA model was used as the best model;
if at least one reduced model was retained, three diferent rules can be implemented for selecting
the best model:
</p>
<p>When <code>modelselectionrule</code> is <code>simpler</code>:
</p>
<p>If (a) the DINA or DINO model
was one of the retained models, then the DINA or DINO model with the larger p
value was selected as the best model; but if (b) both DINA and DINO were rejected, the reduced
model with the largest p value was selected as the best model for this item. Note that
when the p-values of several reduced models were greater than 0.05, the DINA and DINO models were
preferred over the A-CDM, LLM, and R-RUM because of their simplicity. This procedure is originally
proposed by Ma, Iaconangelo, and de la Torre (2016).
</p>
<p>When <code>modelselectionrule</code> is <code>largestp</code>:
</p>
<p>The reduced model with the largest p-values is selected as the most appropriate model.
</p>
<p>When <code>modelselectionrule</code> is <code>DS</code>:
</p>
<p>The reduced model with non-significant p-values but the smallest dissimilarity index is selected as the most appropriate model.
Dissimilarity index can be viewed as an effect size measure, which quatifies how dis-similar the reduced model is from the
G-DINA model (See Ma, Iaconangelo, and de la Torre, 2016 for details).
</p>


<h3>Value</h3>

<p>a list consisting of the following elements:
</p>

<dl>
<dt>GDINA1.obj</dt><dd><p>initial GDINA calibration of class <code>GDINA</code></p>
</dd>
<dt>GDINA2.obj</dt><dd><p>second GDINA calibration of class <code>GDINA</code></p>
</dd>
<dt>Qval.obj</dt><dd><p>Q validation object of class <code>Qval</code></p>
</dd>
<dt>Wald.obj</dt><dd><p>model comparison object of class <code>modelcomp</code></p>
</dd>
<dt>CDM.obj</dt><dd><p>Final CDM calibration of class <code>GDINA</code></p>
</dd>
</dl>



<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>summary(autoGDINA)</code>: print summary information
</p>
</li></ul>


<h3>Note</h3>

<p>Returned <code>GDINA1.obj</code>, <code>GDINA2.obj</code> and <code>CDM.obj</code> are objects of class <code>GDINA</code>,
and all S3 methods suitable for <code>GDINA</code> objects can be applied. See <code><a href="#topic+GDINA">GDINA</a></code> and <code><a href="#topic+extract">extract</a></code>.
Similarly, returned <code>Qval.obj</code> and <code>Wald.obj</code> are objects of class <code><a href="#topic+Qval">Qval</a></code> and <code><a href="#topic+modelcomp">modelcomp</a></code>.
</p>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Ma, W., Iaconangelo, C., &amp; de la Torre, J. (2016). Model similarity, model selection and attribute classification.
<em>Applied Psychological Measurement, 40</em>, 200-217.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code>, <code><a href="#topic+modelcomp">modelcomp</a></code>, <code><a href="#topic+Qval">Qval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# simulated responses
Q &lt;- sim10GDINA$simQ
dat &lt;- sim10GDINA$simdat

#misspecified Q
misQ &lt;- Q
misQ[10,] &lt;- c(0,1,0)
out1 &lt;- autoGDINA(dat,misQ,modelselectionrule="largestp")
out1
summary(out1)
AIC(out1$CDM.obj)

# simulated responses
Q &lt;- sim30GDINA$simQ
dat &lt;- sim30GDINA$simdat

#misspecified Q
misQ &lt;- Q
misQ[1,] &lt;- c(1,1,0,1,0)
auto &lt;- autoGDINA(dat,misQ,Qvalid = TRUE, Qvalid.args = list(method = "wald"),
                  modelselectionrule="simpler")
auto
summary(auto)
AIC(auto$CDM.obj)

#using the other selection rule
out11 &lt;- autoGDINA(dat,misQ,modelselectionrule="simpler",
                   modelselection.args = list(models = c("DINO","DINA")))
out11
summary(out11)

# disable model selection function
out12 &lt;- autoGDINA(dat,misQ,modelselection=FALSE)
out12
summary(out12)


# Disable Q-matrix validation
out3 &lt;- autoGDINA(dat = dat, Q = misQ, Qvalid = FALSE)
out3
summary(out3)

## End(Not run)
</code></pre>

<hr>
<h2 id='bdiagMatrix'>Create a block diagonal matrix</h2><span id='topic+bdiagMatrix'></span>

<h3>Description</h3>

<p>Create a block diagonal matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdiagMatrix(mlist, fill = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bdiagMatrix_+3A_mlist">mlist</code></td>
<td>
<p>a list of matrices</p>
</td></tr>
<tr><td><code id="bdiagMatrix_+3A_fill">fill</code></td>
<td>
<p>value to fill the non-diagnoal elements</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a block diagonal matrix
</p>


<h3>See Also</h3>

<p><code>bdiag</code> in <span class="pkg">Matrix</span>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
m1 &lt;- bdiagMatrix(list(matrix(1:4, 2), diag(3)))
m2 &lt;- bdiagMatrix(list(matrix(1:4, 2), diag(3)),fill = NA)

</code></pre>

<hr>
<h2 id='bootSE'>Calculating standard errors and variance-covariance matrix using bootstrap methods</h2><span id='topic+bootSE'></span>

<h3>Description</h3>

<p>This function conducts nonparametric and parametric bootstrap to calculate standard errors of model parameters.
Parametric bootstrap is only applicable to single group models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootSE(GDINA.obj, bootsample = 50, type = "nonparametric", randomseed = 12345)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootSE_+3A_gdina.obj">GDINA.obj</code></td>
<td>
<p>an object of class GDINA</p>
</td></tr>
<tr><td><code id="bootSE_+3A_bootsample">bootsample</code></td>
<td>
<p>the number of bootstrap samples</p>
</td></tr>
<tr><td><code id="bootSE_+3A_type">type</code></td>
<td>
<p>type of bootstrap method. Can be <code>parametric</code> or <code>nonparametric</code></p>
</td></tr>
<tr><td><code id="bootSE_+3A_randomseed">randomseed</code></td>
<td>
<p>random seed for resampling</p>
</td></tr>
</table>


<h3>Value</h3>

<p>itemparm.se standard errors for item probability of success in list format
</p>
<p>delta.se standard errors for delta parameters in list format
</p>
<p>lambda.se standard errors for structural parameters of joint attribute distribution
</p>
<p>boot.est resample estimates
</p>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# For illustration, only 5 resamples are run
# results are definitely not reliable

dat &lt;- sim30GDINA$simdat
Q &lt;- sim30GDINA$simQ
fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA",att.dist = "higher.order")
boot.fit &lt;- bootSE(fit,bootsample = 5,randomseed=123)
boot.fit$delta.se
boot.fit$lambda.se

## End(Not run)
</code></pre>

<hr>
<h2 id='CA'>Calculate classification accuracy</h2><span id='topic+CA'></span>

<h3>Description</h3>

<p>This function calculate test-, pattern- and attribute-level classification accuracy indices based on GDINA estimates from
the <code>GDINA</code> function using approaches in Iaconangelo (2017) and Wang, Song, Chen, Meng, and Ding (2015).
It is only applicable for dichotomous attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CA(GDINA.obj, what = "MAP")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CA_+3A_gdina.obj">GDINA.obj</code></td>
<td>
<p>estimated GDINA object returned from <code><a href="#topic+GDINA">GDINA</a></code></p>
</td></tr>
<tr><td><code id="CA_+3A_what">what</code></td>
<td>
<p>what attribute estimates are used? Default is <code>"MAP"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with elements
</p>

<dl>
<dt>tau</dt><dd><p>estimated test-level classification accuracy, see Iaconangelo (2017, Eq 2.2)</p>
</dd>
<dt>tau_l</dt><dd><p>estimated pattern-level classification accuracy, see Iaconangelo (2017, p. 13)</p>
</dd>
<dt>tau_k</dt><dd><p>estimated attribute-level classification accuracy, see Wang, et al (2015, p. 461 Eq 6)</p>
</dd>
<dt>CCM</dt><dd><p>Conditional classification matrix, see Iaconangelo (2017, p. 13)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Iaconangelo, C.(2017). <em>Uses of Classification Error Probabilities in the Three-Step Approach to Estimating Cognitive Diagnosis Models.</em> (Unpublished doctoral dissertation). New Brunswick, NJ: Rutgers University.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Wang, W., Song, L., Chen, P., Meng, Y., &amp; Ding, S. (2015). Attribute-Level and Pattern-Level Classification Consistency and Accuracy Indices for Cognitive Diagnostic Assessment.
<em>Journal of Educational Measurement, 52</em> , 457-476.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
fit
CA(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='cjoint'>Combine R Objects by Columns</h2><span id='topic+cjoint'></span>

<h3>Description</h3>

<p>Combine a sequence of vector, matrix or data-frame arguments by columns. Vector is treated as a column matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cjoint(..., fill = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cjoint_+3A_...">...</code></td>
<td>
<p>vectors or matrices</p>
</td></tr>
<tr><td><code id="cjoint_+3A_fill">fill</code></td>
<td>
<p>a scalar used when these objects have different number of rows.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+cbind">cbind</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cjoint(2,c(1,2,3,4),matrix(1:6,2,3))
cjoint(v1 = 2, v2 = c(3,2), v3 = matrix(1:6,3,2),
       v4 = data.frame(c(3,4,5,6,7),rep("x",5)),fill = 99)

</code></pre>

<hr>
<h2 id='ClassRate'>Classification Rate Evaluation</h2><span id='topic+ClassRate'></span>

<h3>Description</h3>

<p>This function evaluates the classification rates for two sets of attribute profiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ClassRate(att1, att2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ClassRate_+3A_att1">att1</code></td>
<td>
<p>a matrix or data frame of attribute profiles</p>
</td></tr>
<tr><td><code id="ClassRate_+3A_att2">att2</code></td>
<td>
<p>a matrix or data frame of attribute profiles</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following components:
</p>

<dl>
<dt>PCA</dt><dd><p>the proportion of correctly classified attributes (i.e., attribute level classification rate)</p>
</dd>
<dt>PCV</dt><dd><p>a vector giving the proportions of correctly classified attribute vectors (i.e., vector level classification rate).
The fist element is the proportion of at least one attribute in the vector are correctly identified; the second
element is the proportion of at least two attributes in the vector are correctly identified; and so forth. The last
element is the proportion of all elements in the vector are correctly identified.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
N &lt;- 2000
# model does not matter if item parameter is probability of success
Q &lt;- sim30GDINA$simQ
J &lt;- nrow(Q)
gs &lt;- matrix(0.1,J,2)

set.seed(12345)
sim &lt;- simGDINA(N,Q,gs.parm = gs)
GDINA.est &lt;- GDINA(sim$dat,Q)

CR &lt;- ClassRate(sim$attribute,personparm(GDINA.est))
CR

## End(Not run)
</code></pre>

<hr>
<h2 id='designmatrix'>Generate design matrix</h2><span id='topic+designmatrix'></span>

<h3>Description</h3>

<p>This function generates the design matrix for an item
</p>


<h3>Usage</h3>

<pre><code class='language-R'>designmatrix(Kj = NULL, model = "GDINA", Qj = NULL, no.bugs = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="designmatrix_+3A_kj">Kj</code></td>
<td>
<p>Required except for the MS-DINA model; The number of attributes required for item j</p>
</td></tr>
<tr><td><code id="designmatrix_+3A_model">model</code></td>
<td>
<p>the model associated with the design matrix; It can be &quot;GDINA&quot;,&quot;DINA&quot;,&quot;DINO&quot;, &quot;ACDM&quot;,&quot;LLM&quot;, &quot;RRUM&quot;, &quot;MSDINA&quot;, &quot;BUGDINO&quot;, and &quot;SISM&quot;.
The default is &quot;GDINA&quot;. Note that models &quot;LLM&quot; and &quot;RRUM&quot; have the same design matrix as the &quot;ACDM&quot;.</p>
</td></tr>
<tr><td><code id="designmatrix_+3A_qj">Qj</code></td>
<td>
<p>the Q-matrix for item j; This is required for &quot;MSDINA&quot;, and &quot;SISM&quot; models; The number of rows is equal to the number
of strategies for &quot;MSDINA&quot;, and the number of columns is equal to the number of attributes.</p>
</td></tr>
<tr><td><code id="designmatrix_+3A_no.bugs">no.bugs</code></td>
<td>
<p>the number of bugs (or misconceptions). Note that bugs must be given in the last no.bugs columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a design matrix (Mj). See de la Torre (2011) for details.
</p>


<h3>References</h3>

<p>de la Torre, J. (2011). The generalized DINA model framework. <em>Psychometrika, 76</em>, 179-199.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
designmatrix(Kj = 2, model = "GDINA")
designmatrix(Kj = 3, model = "DINA")
msQj &lt;- matrix(c(1,0,0,1,
                 1,1,0,0),nrow=2,byrow=TRUE)
designmatrix(model = "MSDINA",Qj = msQj)

## End(Not run)

</code></pre>

<hr>
<h2 id='dif'>Differential item functioning for cognitive diagnosis models</h2><span id='topic+dif'></span><span id='topic+summary.dif'></span>

<h3>Description</h3>

<p>This function is used to detect differential item functioning using the Wald test (Hou, de la Torre, &amp; Nandakumar, 2014; Ma, Terzi, &amp; de la Torre, 2021) and the likelihood ratio
test (Ma, Terzi, &amp; de la Torre, 2021). The forward anchor item search procedure developed in Ma, Terzi, and de la Torre (2021) was implemented. Note that it can only detect DIF for two groups currently.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dif(
  dat,
  Q,
  group,
  model = "GDINA",
  method = "wald",
  anchor.items = NULL,
  dif.items = "all",
  p.adjust.methods = "holm",
  approx = FALSE,
  SE.type = 2,
  FS.args = list(on = FALSE, alpha.level = 0.05, maxit = 10, verbose = FALSE),
  ...
)

## S3 method for class 'dif'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dif_+3A_dat">dat</code></td>
<td>
<p>item responses from two groups; missing data need to be coded as <code>NA</code></p>
</td></tr>
<tr><td><code id="dif_+3A_q">Q</code></td>
<td>
<p>Q-matrix specifying the association between items and attributes</p>
</td></tr>
<tr><td><code id="dif_+3A_group">group</code></td>
<td>
<p>a factor or a vector indicating the group each individual belongs to. Its length must be equal to the number of individuals.</p>
</td></tr>
<tr><td><code id="dif_+3A_model">model</code></td>
<td>
<p>model for each item.</p>
</td></tr>
<tr><td><code id="dif_+3A_method">method</code></td>
<td>
<p>DIF detection method; It can be <code>"wald"</code> for Hou, de la Torre, and Nandakumar's (2014)
Wald test method, and <code>"LR"</code> for likelihood ratio test (Ma, Terzi, Lee,&amp; de la Torre, 2017).</p>
</td></tr>
<tr><td><code id="dif_+3A_anchor.items">anchor.items</code></td>
<td>
<p>which items will be used as anchors? Default is <code>NULL</code>, which means none of the items are used as anchors.
For LR method, it can also be an integer vector giving the item numbers for anchors or <code>"all"</code>, which means all items are treated as anchor items.</p>
</td></tr>
<tr><td><code id="dif_+3A_dif.items">dif.items</code></td>
<td>
<p>which items are subject to DIF detection? Default is <code>"all"</code>. It can also be an integer vector giving the item numbers.</p>
</td></tr>
<tr><td><code id="dif_+3A_p.adjust.methods">p.adjust.methods</code></td>
<td>
<p>adjusted p-values for multiple hypothesis tests. This is conducted using <code>p.adjust</code> function in <span class="pkg">stats</span>,
and therefore all adjustment methods supported by <code>p.adjust</code> can be used, including <code>"holm"</code>,
<code>"hochberg"</code>, <code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code> and <code>"BY"</code>. See <code>p.adjust</code>
for more details. <code>"holm"</code> is the default.</p>
</td></tr>
<tr><td><code id="dif_+3A_approx">approx</code></td>
<td>
<p>Whether an approximated LR test is implemented? If TRUE, parameters of items except the studied one will not be re-estimated.</p>
</td></tr>
<tr><td><code id="dif_+3A_se.type">SE.type</code></td>
<td>
<p>Type of standard error estimation methods for the Wald test.</p>
</td></tr>
<tr><td><code id="dif_+3A_fs.args">FS.args</code></td>
<td>
<p>arguments for the forward anchor item search procedure developed in Ma, Terzi, and de la Torre (2021). A list with the following elements:
</p>

<ul>
<li> <p><code>on</code> - logical; <code>TRUE</code> if activate the forward anchor item search procedure. Default = <code>FALSE</code>.
</p>
</li>
<li> <p><code>alpha.level</code> - nominal level for Wald or LR test. Default = .05.
</p>
</li>
<li> <p><code>maxit</code> - maximum number of iterations allowed. Default = 10.
</p>
</li>
<li> <p><code>verbose</code> - logical; print information for each iteration or not? Default = <code>FALSE</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="dif_+3A_...">...</code></td>
<td>
<p>arguments passed to GDINA function for model calibration</p>
</td></tr>
<tr><td><code id="dif_+3A_object">object</code></td>
<td>
<p>dif object for S3 method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame giving the Wald statistics and associated p-values.
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>summary(dif)</code>: print summary information
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>References</h3>

<p>Hou, L., de la Torre, J., &amp; Nandakumar, R. (2014). Differential item functioning assessment in cognitive diagnostic modeling: Application of the Wald test to
investigate DIF in the DINA model. <em>Journal of Educational Measurement, 51</em>, 98-125.
</p>
<p>Ma, W., Terzi, R., &amp; de la Torre, J. (2021). Detecting differential item functioning using multiple-group cognitive diagnosis models. <em>Applied Psychological Measurement</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(123456)
N &lt;- 3000
Q &lt;- sim30GDINA$simQ
gs &lt;- matrix(.2,ncol = 2, nrow = nrow(Q))
# By default, individuals are simulated from uniform distribution
# and deltas are simulated randomly
sim1 &lt;- simGDINA(N,Q,gs.parm = gs,model="DINA")
sim2 &lt;- simGDINA(N,Q,gs.parm = gs,model=c(rep("DINA",nrow(Q)-1),"DINO"))
dat &lt;- rbind(extract(sim1,"dat"),extract(sim2,"dat"))
gr &lt;- rep(c("G1","G2"),each=N)

# DIF using Wald test
dif.wald &lt;- dif(dat, Q, group=gr, method = "Wald")
dif.wald
# DIF using LR test
dif.LR &lt;- dif(dat, Q, group=gr, method="LR")
dif.LR
# DIF using Wald test + forward search algorithm
dif.wald.FS &lt;- dif(dat, Q, group=gr, method = "Wald", FS.args = list(on = TRUE, verbose = TRUE))
dif.wald.FS
# DIF using LR test + forward search algorithm
dif.LR.FS &lt;- dif(dat, Q, group=gr, method = "LR", FS.args = list(on = TRUE, verbose = TRUE))
dif.LR.FS

## End(Not run)
</code></pre>

<hr>
<h2 id='DTM'>Experimental function for diagnostic multiple-strategy CDMs</h2><span id='topic+DTM'></span>

<h3>Description</h3>

<p>This function estimates the diagnostic tree model (Ma, 2018) for polytomous responses with multiple strategies. It is an experimental function, and will be further optimized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DTM(
  dat,
  Qc,
  delta = NULL,
  Tmatrix = NULL,
  conv.crit = 0.001,
  conv.type = "pr",
  maxitr = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DTM_+3A_dat">dat</code></td>
<td>
<p>A required <code class="reqn">N \times J</code> data matrix of N examinees to J items. Missing
values are currently not allowed.</p>
</td></tr>
<tr><td><code id="DTM_+3A_qc">Qc</code></td>
<td>
<p>A required <code class="reqn">J \times K+2</code> category and attribute association matrix,
where J represents the number of items or nonzero categories and K represents the
number of attributes. Entry 1 indicates that the attribute is
measured by the item, and 0 otherwise. The first column gives the item number, which must
be numeric and match the number of column in the data. The second column indicates the category number.</p>
</td></tr>
<tr><td><code id="DTM_+3A_delta">delta</code></td>
<td>
<p>initial item parameters</p>
</td></tr>
<tr><td><code id="DTM_+3A_tmatrix">Tmatrix</code></td>
<td>
<p>The mapping matrix showing the relation between the OBSERVED responses (rows) and the PSEDUO items (columns);
The first column gives the observed responses.</p>
</td></tr>
<tr><td><code id="DTM_+3A_conv.crit">conv.crit</code></td>
<td>
<p>The convergence criterion for max absolute change in item parameters.</p>
</td></tr>
<tr><td><code id="DTM_+3A_conv.type">conv.type</code></td>
<td>
<p>convergence criteria; Can be <code>pr</code>,<code>LL</code> and <code>delta</code>,
indicating category response function, log-likelihood and delta parameters,respectively.</p>
</td></tr>
<tr><td><code id="DTM_+3A_maxitr">maxitr</code></td>
<td>
<p>The maximum iterations allowed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W. (2018). A Diagnostic Tree Model for Polytomous Responses with Multiple Strategies. <em>British Journal of Mathematical and Statistical Psychology.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code> for MS-DINA model and single strategy CDMs,
and <code><a href="#topic+GMSCDM">GMSCDM</a></code> for generalized multiple strategies CDMs for dichotomous response data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
K=5
g=0.2
item.no &lt;- rep(1:6,each=4)
# the first node has three response categories: 0, 1 and 2
node.no &lt;- rep(c(1,1,2,3),6)
Q1 &lt;- matrix(0,length(item.no),K)
Q2 &lt;- cbind(7:(7+K-1),rep(1,K),diag(K))
for(j in 1:length(item.no)) {
  Q1[j,sample(1:K,sample(3,1))] &lt;- 1
}
Qc &lt;- rbind(cbind(item.no,node.no,Q1),Q2)
Tmatrix.set &lt;- list(cbind(c(0,1,2,3,3),c(0,1,2,1,2),c(NA,0,NA,1,NA),c(NA,NA,0,NA,1)),
cbind(c(0,1,2,3,4),c(0,1,2,1,2),c(NA,0,NA,1,NA),c(NA,NA,0,NA,1)),
cbind(c(0,1),c(0,1)))
Tmatrix &lt;- Tmatrix.set[c(1,1,1,1,1,1,rep(3,K))]
sim &lt;- simDTM(N=2000,Qc=Qc,gs.parm=matrix(0.2,nrow(Qc),2),Tmatrix=Tmatrix)
est &lt;- DTM(dat=sim$dat,Qc=Qc,Tmatrix = Tmatrix)

## End(Not run)
</code></pre>

<hr>
<h2 id='ecpe'>Examination for the Certificate of Proficiency in English (ECPE) data</h2><span id='topic+ecpe'></span>

<h3>Description</h3>

<p>Examination for the Certificate of Proficiency in English (ECPE) data (the grammar section) has been used
in Henson and Templin (2007), Templin and Hoffman (2013), Feng, Habing, and Huebner (2014), and
Templin and Bradshaw (2014), among others.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecpe
</code></pre>


<h3>Format</h3>

<p>A list of responses and Q-matrix with components:
</p>

<dl>
<dt><code>dat</code></dt><dd><p>Responses of 2922 examinees to 28 items.</p>
</dd>
<dt><code>Q</code></dt><dd><p>The <code class="reqn">28 \times 3</code> Q-matrix.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data consists of responses of 2922 examinees to 28 items involving 3 attributes.
Attribute 1 is morphosyntactic rules, Attribute 2 is cohesive rules and
Attribute 3 is lexical rules.
</p>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Feng, Y., Habing, B. T., &amp; Huebner, A. (2014). Parameter estimation of the reduced RUM using the EM algorithm. <em>Applied Psychological Measurement, 38</em>, 137-150.
</p>
<p>Henson, R. A., &amp; Templin, J. (2007, April). Large-scale language assessment using cognitive diagnosis models. Paper presented at the annual meeting of the National Council for Measurement in Education in Chicago, Illinois.
</p>
<p>Templin, J., &amp; Bradshaw, L. (2014). Hierarchical diagnostic classification models: A family of models for estimating and testing attribute hierarchies. <em>Psychometrika, 79</em>, 317-339.
</p>
<p>Templin, J., &amp; Hoffman, L. (2013). Obtaining diagnostic classification model estimates using Mplus. <em>Educational Measurement: Issues and Practice, 32</em>, 37-50.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
mod1 &lt;- GDINA(ecpe$dat,ecpe$Q)
mod1
summary(mod1)

mod2 &lt;- GDINA(ecpe$dat,ecpe$Q,model="RRUM")
mod2
anova(mod1,mod2)
# You may compare the following results with Feng, Habing, and Huebner (2014)
coef(mod2,"rrum")

# G-DINA with hierarchical structure
# see Templin &amp; Bradshaw, 2014
ast &lt;- att.structure(list(c(3,2),c(2,1)),K=3)

est.gdina2 &lt;- GDINA(ecpe$dat,ecpe$Q,model = "GDINA",
                   control = list(conv.crit = 1e-6),
                   att.str = list(c(3,2),c(2,1)))
# see Table 7 in Templin &amp; Bradshaw, 2014
summary(est.gdina2)

## End(Not run)

</code></pre>

<hr>
<h2 id='extract'>extract elements from objects of various classes</h2><span id='topic+extract'></span>

<h3>Description</h3>

<p>A generic function to extract elements from objects of class <code>GDINA</code>,
<code>itemfit</code>, <code>modelcomp</code>, <code>Qval</code> or <code>simGDINA</code>. This
page gives the elements that can be extracted from the class <code>GDINA</code>.
To see what can be extracted from <code><a href="#topic+itemfit">itemfit</a></code>, <code><a href="#topic+modelcomp">modelcomp</a></code>, and
<code><a href="#topic+Qval">Qval</a></code>, go to the corresponding function help page.
</p>
<p>Objects which can be extracted from <code>GDINA</code> objects include:
</p>

<dl>
<dt>AIC</dt><dd><p>AIC</p>
</dd>
<dt>att.prior</dt><dd><p>attribute prior weights for calculating marginalized likelihood in the last EM iteration</p>
</dd>
<dt>attributepattern</dt><dd><p>all attribute patterns involved in the current calibration</p>
</dd>
<dt>BIC</dt><dd><p>BIC</p>
</dd>
<dt>CAIC</dt><dd><p>Consistent AIC</p>
</dd>
<dt>catprob.cov</dt><dd><p>covariance matrix of item probability parameter estimates; Need to specify <code>SE.type</code></p>
</dd>
<dt>catprob.parm</dt><dd><p>item parameter estimates</p>
</dd>
<dt>catprob.se</dt><dd><p>standard error of item probability parameter estimates; Need to specify <code>SE.type</code></p>
</dd>
<dt>convergence</dt><dd><p><code>TRUE</code> if the calibration is converged.</p>
</dd>
<dt>dat</dt><dd><p>raw data</p>
</dd>
<dt>del.ind</dt><dd><p>deleted observation number</p>
</dd>
<dt>delta.cov</dt><dd><p>covariance matrix of delta parameter estimates; Need to specify <code>SE.type</code></p>
</dd>
<dt>delta.parm</dt><dd><p>delta parameter estimates</p>
</dd>
<dt>delta.se</dt><dd><p>standard error of delta parameter estimates; Need to specify <code>SE.type</code></p>
</dd>
<dt>designmatrix</dt><dd><p>A list of design matrices for each item/category</p>
</dd>
<dt>deviance</dt><dd><p>deviance, or negative two times observed marginal log likelihood</p>
</dd>
<dt>discrim</dt><dd><p>GDINA discrimination index</p>
</dd>
<dt>expectedCorrect</dt><dd><p>expected # of examinees in each latent group answering item correctly</p>
</dd>
<dt>expectedTotal</dt><dd><p>expected # of examinees in each latent group</p>
</dd>
<dt>higher.order</dt><dd><p>higher-order model specifications</p>
</dd>
<dt>LCprob.parm</dt><dd><p>success probabilities for all latent classes</p>
</dd>
<dt>logLik</dt><dd><p>observed marginal log likelihood</p>
</dd>
<dt>linkfunc</dt><dd><p>link functions for each item</p>
</dd>
<dt>initial.catprob</dt><dd><p>initial item category probability parameters</p>
</dd>
<dt>natt</dt><dd><p>number of attributes</p>
</dd>
<dt>ncat</dt><dd><p>number of categories</p>
</dd>
<dt>ngroup</dt><dd><p>number of groups</p>
</dd>
<dt>nitem</dt><dd><p>number of items</p>
</dd>
<dt>nitr</dt><dd><p>number of EM iterations</p>
</dd>
<dt>nobs</dt><dd><p>number of observations, or sample size</p>
</dd>
<dt>nLC</dt><dd><p>number of latent classes</p>
</dd>
<dt>prevalence</dt><dd><p>prevalence of each attribute</p>
</dd>
<dt>posterior.prob</dt><dd><p>posterior weights for each latent class</p>
</dd>
<dt>reduced.LG</dt><dd><p>Reduced latent group for each item</p>
</dd>
<dt>SABIC</dt><dd><p>Sample size Adusted BIC</p>
</dd>
<dt>sequential</dt><dd><p>is a sequential model fitted?</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>extract(object, what, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_+3A_object">object</code></td>
<td>
<p>objects from class <code>GDINA</code>,<code>itemfit</code>, <code>modelcomp</code>, <code>Qval</code> or <code>simGDINA</code></p>
</td></tr>
<tr><td><code id="extract_+3A_what">what</code></td>
<td>
<p>what to extract</p>
</td></tr>
<tr><td><code id="extract_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
extract(fit,"discrim")
extract(fit,"designmatrix")

## End(Not run)

</code></pre>

<hr>
<h2 id='frac20'>Tatsuoka's fraction subtraction data</h2><span id='topic+frac20'></span>

<h3>Description</h3>

<p>Fraction Subtraction data (Tatsuoka, 2002) consists of responses of 536 examinees to 20 items measuring 8 attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frac20
</code></pre>


<h3>Format</h3>

<p>A list of responses and Q-matrix with components:
</p>

<dl>
<dt><code>dat</code></dt><dd><p>responses of 536 examinees to 20 items</p>
</dd>
<dt><code>Q</code></dt><dd><p>The <code class="reqn">20 \times 8</code> Q-matrix</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Tatsuoka, C. (2002). Data analytic methods for latent partially ordered classification models. <em>Journal of the Royal Statistical Society, Series C, Applied Statistics, 51</em>, 337-350.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
mod1 &lt;- GDINA(frac20$dat,frac20$Q,model="DINA")
mod1
summary(mod1)
# Higher order model
mod2 &lt;- GDINA(frac20$dat,frac20$Q,model="DINA",att.dist="higher.order")
mod2
anova(mod1,mod2)

## End(Not run)
</code></pre>

<hr>
<h2 id='GDINA'>CDM calibration under the G-DINA model framework</h2><span id='topic+GDINA'></span><span id='topic+anova.GDINA'></span><span id='topic+coef.GDINA'></span><span id='topic+extract.GDINA'></span><span id='topic+personparm.GDINA'></span><span id='topic+logLik.GDINA'></span><span id='topic+deviance.GDINA'></span><span id='topic+nobs.GDINA'></span><span id='topic+vcov.GDINA'></span><span id='topic+npar.GDINA'></span><span id='topic+indlogLik.GDINA'></span><span id='topic+indlogPost.GDINA'></span><span id='topic+summary.GDINA'></span>

<h3>Description</h3>

<p><code>GDINA</code> calibrates the generalized deterministic inputs, noisy and
gate (G-DINA; de la Torre, 2011) model for dichotomous responses, and its extension, the sequential
G-DINA model (Ma, &amp; de la Torre, 2016a; Ma, 2017) for ordinal and nominal responses.
By setting appropriate constraints, the deterministic inputs,
noisy and gate (DINA; de la Torre, 2009; Junker &amp; Sijtsma, 2001) model,
the deterministic inputs, noisy or gate (DINO; Templin &amp; Henson, 2006)
model, the reduced reparametrized unified model (R-RUM; Hartz, 2002),
the additive CDM (A-CDM; de la Torre, 2011), the linear logistic
model (LLM; Maris, 1999), and the multiple-strategy DINA model (MSDINA; de la Torre &amp; Douglas, 2008; Huo &amp; de la Torre, 2014)
can also be calibrated. Note that the LLM is equivalent to
the C-RUM (Hartz, 2002), a special case of the GDM (von Davier, 2008), and that the R-RUM
is also known as a special case of the generalized NIDA model (de la Torre, 2011).
</p>
<p>In addition, users are allowed to specify design matrix and link function for each item, and
distinct models may be used in a single test for different items.
The attributes can be either dichotomous or polytomous
(Chen &amp; de la Torre, 2013). Joint attribute distribution may be modelled using independent or saturated model,
structured model, higher-order model (de la Torre &amp; Douglas, 2004), or loglinear model (Xu &amp; von Davier, 2008).
Marginal maximum likelihood method with Expectation-Maximization (MMLE/EM) alogrithm is used for item parameter estimation.
</p>
<p>To compare two or more <code>GDINA</code> objects, use method <code><a href="stats.html#topic+anova">anova</a></code>.
</p>
<p>To calculate structural parameters for item and joint attribute distributions, use method <code><a href="stats.html#topic+coef">coef</a></code>.
</p>
<p>To calculate lower-order incidental (person) parameters
use method <code><a href="#topic+personparm">personparm</a></code>. To extract other components returned, use <code><a href="#topic+extract">extract</a></code>.
To plot item/category response function, use <code><a href="graphics.html#topic+plot">plot</a></code>. To
check whether monotonicity is violated, use <code><a href="#topic+monocheck">monocheck</a></code>. To conduct anaysis in graphical user interface,
use <code><a href="#topic+startGDINA">startGDINA</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GDINA(
  dat,
  Q,
  model = "GDINA",
  sequential = FALSE,
  att.dist = "saturated",
  mono.constraint = FALSE,
  group = NULL,
  linkfunc = NULL,
  design.matrix = NULL,
  no.bugs = 0,
  att.prior = NULL,
  att.str = NULL,
  verbose = 1,
  higher.order = list(),
  loglinear = 2,
  catprob.parm = NULL,
  control = list(),
  item.names = NULL,
  solver = NULL,
  nloptr.args = list(),
  auglag.args = list(),
  solnp.args = list(),
  ...
)

## S3 method for class 'GDINA'
anova(object, ...)

## S3 method for class 'GDINA'
coef(
  object,
  what = c("catprob", "delta", "gs", "itemprob", "LCprob", "rrum", "lambda"),
  withSE = FALSE,
  SE.type = 2,
  digits = 4,
  ...
)

## S3 method for class 'GDINA'
extract(object, what, SE.type = 2, ...)

## S3 method for class 'GDINA'
personparm(object, what = c("EAP", "MAP", "MLE", "mp", "HO"), digits = 4, ...)

## S3 method for class 'GDINA'
logLik(object, ...)

## S3 method for class 'GDINA'
deviance(object, ...)

## S3 method for class 'GDINA'
nobs(object, ...)

## S3 method for class 'GDINA'
vcov(object, ...)

## S3 method for class 'GDINA'
npar(object, ...)

## S3 method for class 'GDINA'
indlogLik(object, ...)

## S3 method for class 'GDINA'
indlogPost(object, ...)

## S3 method for class 'GDINA'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GDINA_+3A_dat">dat</code></td>
<td>
<p>A required <code class="reqn">N \times J</code> <code>matrix</code> or <code>data.frame</code> consisting of the
responses of <code class="reqn">N</code> individuals to <code class="reqn">J</code> items. Missing values need to be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_q">Q</code></td>
<td>
<p>A required matrix; The number of rows occupied by a single-strategy dichotomous item is 1, by a polytomous item is
the number of nonzero categories, and by a mutiple-strategy dichotomous item is the number of strategies.
The number of column is equal to the number of attributes if all items are single-strategy dichotomous items, but
the number of attributes + 2 if any items are polytomous or have multiple strategies.
For a polytomous item, the first column represents the item number and the second column indicates the nonzero category number.
For a multiple-strategy dichotomous item, the first column represents the item number and the second column indicates the strategy number.
For binary attributes, 1 denotes the attributes are measured by the items and 0 means the attributes are not
measured. For polytomous attributes, non-zero elements indicate which level
of attributes are needed (see Chen, &amp; de la Torre, 2013).  See <code>Examples</code>.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_model">model</code></td>
<td>
<p>A vector for each item or nonzero category, or a scalar which will be used for all
items or nonzero categories to specify the CDMs fitted. The possible options
include <code>"GDINA"</code>,<code>"DINA"</code>,<code>"DINO"</code>,<code>"ACDM"</code>,<code>"LLM"</code>, <code>"RRUM"</code>, <code>"MSDINA"</code>, <code>"BUGDINO"</code>, <code>"SISM"</code>, and <code>"UDF"</code>. Note that
model can also be <code>"logitGDINA"</code> and <code>"logGDINA"</code>, indicating the saturated G-DINA model in logit and log link functions. They are
equivalent to the identity link saturated G-DINA model. The logit G-DINA model is identical to the log-linear CDM.
When <code>"UDF"</code>, indicating user defined function, is specified for any item, arguments <code>design.matrix</code> and <code>linkfunc</code> need to be specified.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_sequential">sequential</code></td>
<td>
<p>logical; <code>TRUE</code> if the sequential model is fitted for polytomous responses.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_att.dist">att.dist</code></td>
<td>
<p>How is the joint attribute distribution estimated? It can be (1) <code>saturated</code>, which is the default, indicating that
the proportion parameter for each permissible latent class is estimated separately; (2) <code>higher.order</code>, indicating
that a higher-order joint attribute distribution is assumed (higher-order model can be specified in <code>higher.order</code> argument);
(3) <code>fixed</code>, indicating that the weights specified in <code>att.prior</code> argument are fixed in the estimation process.
If <code>att.prior</code> is not specified, a uniform joint attribute distribution is employed initially;  (4) <code>independent</code>, indicating
that all attributes are assumed to be independent; and (5) <code>loglinear</code>, indicating a loglinear model is employed.
If different groups have different joint attribute distributions,
specify <code>att.dist</code> as a character vector with the same number of elements as the number of groups. However, if a higher-order model is used for any group,
it must be used for all groups.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_mono.constraint">mono.constraint</code></td>
<td>
<p>logical; <code>TRUE</code> indicates that <code class="reqn">P(\boldsymbol{\alpha}_1) &lt;=P(\boldsymbol{\alpha}_2)</code> if
for all <code class="reqn">k</code>, <code class="reqn">\alpha_{1k} &lt; \alpha_{2k}</code>. Can be a vector for each item or nonzero category or a scalar which will be used for all
items to specify whether monotonicity constraint should be added.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_group">group</code></td>
<td>
<p>a factor or a vector indicating the group each individual belongs to. Its length must be equal to the number of individuals.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_linkfunc">linkfunc</code></td>
<td>
<p>a vector of link functions for each item/category; It can be <code>"identity"</code>,<code>"log"</code> or <code>"logit"</code>. Only applicable
when, for some items, <code>model="UDF"</code>.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_design.matrix">design.matrix</code></td>
<td>
<p>a list of design matrices; Its length must be equal to the number of items (or nonzero categories for sequential models).
If CDM for item j is specified as &quot;UDF&quot; in argument <code>model</code>, the corresponding design matrix must be provided; otherwise, the design matrix can be <code>NULL</code>,
which will be generated automatically.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_no.bugs">no.bugs</code></td>
<td>
<p>A numeric scalar (whole numbers only) indicating the number of bugs or misconceptions in the Q-matrix. The bugs must be included in the last <code>no.bugs</code> columns.
It can be used along with the <code>BUGDINO</code> and <code>SISM</code> models (see, Kuo, Chen, Yang &amp; Mok, 2016; Kuo, Chen, &amp; de la Torre, 2018). This argument will be ignored if the
model is not specified in <code>model</code> argument. Note that the <code>BUGDINO</code> and <code>SISM</code> models are reparametrized - see <code>Details</code> below. By default,
<code>no.bugs</code>=0, implying that there is no bugs/misconceptions.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_att.prior">att.prior</code></td>
<td>
<p>A vector of length <code class="reqn">2^K</code> for single group model, or a matrix of dimension <code class="reqn">2^K\times</code> no. of groups to specify
attribute prior distribution for <code class="reqn">2^K</code> latent classes for all groups under a multiple group model. Only applicable for dichotomous attributes.
The sum of all elements does not have to be equal to 1; however, it will be normalized so that the sum is equal to 1
before calibration.
The label for each latent class can be obtained by calling <code>attributepattern(K)</code>. See <code>examples</code> for more info.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_att.str">att.str</code></td>
<td>
<p>Specify attribute structures. <code>NULL</code>, by default, means there is no structure. Attribute structure needs be specified as a list -
which will be internally handled by <code>att.structure</code> function. See examples. It can also be a matrix giving all permissible attribute profiles.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_verbose">verbose</code></td>
<td>
<p>How to print calibration information
after each EM iteration? Can be 0, 1 or 2, indicating to print no information,
information for current iteration, or information for all iterations.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_higher.order">higher.order</code></td>
<td>
<p>A list specifying the higher-order joint attribute distribution with the following components:
</p>

<ul>
<li> <p><code>model</code> - a number indicating the model for higher-order joint attribute distribution. Can be
1, 2 or 3, representing the intercept only approach, common slope approach and varied slope approach (see <code>Details</code>).
</p>
</li>
<li> <p><code>nquad</code> - a scalar specifying the number of integral nodes. Default = 25.
</p>
</li>
<li> <p><code>SlopeRange</code> - a vector of length two specifying the range of slope parameters. Default = [0.1, 5].
</p>
</li>
<li> <p><code>InterceptRange</code> - a vector of length two specifying the range of intercept parameters. Default = [-4, 4].
</p>
</li>
<li> <p><code>SlopePrior</code> - a vector of length two specifying the mean and variance of log(slope) parameters, which are assumed normally distributed. Default: mean = 0 and sd = 0.25.
</p>
</li>
<li> <p><code>InterceptPrior</code> - a vector of length two specifying the mean and variance of intercept parameters, which are assumed normally distributed. Default: mean = 0 and sd = 1.
</p>
</li>
<li> <p><code>Prior</code> - logical; indicating whether prior distributions should be imposed to slope and intercept parameters. Default is <code>FALSE</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="GDINA_+3A_loglinear">loglinear</code></td>
<td>
<p>the order of loglinear smooth for attribute space. It can be either 1 or 2 indicating the loglinear model with main effect only
and with main effect and first-order interaction; It can also be a matrix, representing the design matrix for the loglinear model.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_catprob.parm">catprob.parm</code></td>
<td>
<p>A list of initial success probability parameters for each nonzero category.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_control">control</code></td>
<td>
<p>A list of control parameters with elements:
</p>

<ul>
<li> <p><code>maxitr</code> A vector for each item or nonzero category, or a scalar which will be used for all
items or nonzero categories to specify the maximum number of EM cycles allowed. Default = 2000.
</p>
</li>
<li> <p><code>conv.crit</code> The convergence criterion. Default = 0.0001.
</p>
</li>
<li> <p><code>conv.type</code> How is the convergence criterion evaluated? A vector with possible elements: <code>"ip"</code>, indicating
the maximum absolute change in item success probabilities, <code>"mp"</code>, representing
the maximum absolute change in mixing proportion parameters, <code>"delta"</code>, indicating the maximum absolute change in delta
parameters, <code>neg2LL</code> indicating the absolute change in negative two times loglikeihood,  or <code>neg2LL</code> indicating the
relative absolute change in negative two times loglikeihood (i.e., the absolute change divided by -2LL of the previous iteration).
Multiple criteria can be specified. If so, all criteria need to be met. Default = c(&quot;ip&quot;, &quot;mp&quot;).
</p>
</li>
<li> <p><code>nstarts</code> how many sets of starting values? Default = 3.
</p>
</li>
<li> <p><code>lower.p</code> A vector for each item or nonzero category,
or a scalar which will be used for all items or nonzero categories to specify the lower bound for success probabilities.
Default = .0001.
</p>
</li>
<li> <p><code>upper.p</code> A vector for each item or nonzero category, or a scalar which will be used for all
items or nonzero categories to specify the upper bound for success probabilities. Default = .9999.
</p>
</li>
<li> <p><code>lower.prior</code> The lower bound for mixing proportion parameters (latent class sizes). Default = .Machine$double.eps.
</p>
</li>
<li> <p><code>randomseed</code> Random seed for generating initial item parameters. Default = 123456.
</p>
</li>
<li> <p><code>smallNcorrection</code> A numeric vector with two elements specifying the corrections applied when the expected number of
individuals in some latent groups are too small. If the expected no. of examinees is less than the second element,
the first element and two times the first element will be added to the numerator and denominator of the closed-form solution of
probabilities of success. Only applicable for the G-DINA, DINA and DINO model estimation without monotonic constraints.
</p>
</li>
<li> <p><code>MstepMessage</code> Integer; Larger number prints more information from Mstep optimizer. Default = 1.
</p>
</li></ul>
</td></tr>
<tr><td><code id="GDINA_+3A_item.names">item.names</code></td>
<td>
<p>A vector giving the item names. By default, items are named as &quot;Item 1&quot;, &quot;Item 2&quot;, etc.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_solver">solver</code></td>
<td>
<p>A string indicating which solver should be used in M-step. By default, the solver is automatically chosen according to the models specified.
Possible options include <a href="nloptr.html#topic+slsqp">slsqp</a>, <a href="nloptr.html#topic+nloptr">nloptr</a>, <a href="Rsolnp.html#topic+solnp">solnp</a> and <a href="alabama.html#topic+auglag">auglag</a>.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_nloptr.args">nloptr.args</code></td>
<td>
<p>a list of control parameters to be passed to <code>opts</code> argument of <a href="nloptr.html#topic+nloptr">nloptr</a> function.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_auglag.args">auglag.args</code></td>
<td>
<p>a list of control parameters to be passed to the alabama::auglag() function. It can contain two elements:
<code>control.outer</code> and <code>control.optim</code>. See <a href="alabama.html#topic+auglag">auglag</a>.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_solnp.args">solnp.args</code></td>
<td>
<p>a list of control parameters to be passed to <code>control</code> argument of <a href="Rsolnp.html#topic+solnp">solnp</a> function.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
<tr><td><code id="GDINA_+3A_object">object</code></td>
<td>
<p>GDINA object for various S3 methods</p>
</td></tr>
<tr><td><code id="GDINA_+3A_what">what</code></td>
<td>
<p>argument for various S3 methods; For calculating structural parameters using <code><a href="stats.html#topic+coef">coef</a></code>,
<code>what</code> can be
</p>

<ul>
<li> <p><code>itemprob</code> - item success probabilities of each reduced attribute pattern.
</p>
</li>
<li> <p><code>catprob</code> - category success probabilities of each reduced attribute pattern; the same as <code>itemprob</code> for dichtomous response data.
</p>
</li>
<li> <p><code>LCprob</code> - item success probabilities of each attribute pattern.
</p>
</li>
<li> <p><code>gs</code> - guessing and slip parameters of each item/category.
</p>
</li>
<li> <p><code>delta</code> - delta parameters of each item/category, see G-DINA formula in details.
</p>
</li>
<li> <p><code>rrum</code> - RRUM parameters when items are estimated using <code>RRUM</code>.
</p>
</li>
<li> <p><code>lambda</code> - structural parameters for joint attribute distribution.
</p>
</li></ul>

<p>For calculating incidental parameters using <code><a href="#topic+personparm">personparm</a></code>,
<code>what</code> can be
</p>

<ul>
<li> <p><code>EAP</code> - EAP estimates of attribute pattern.
</p>
</li>
<li> <p><code>MAP</code> - MAP estimates of attribute pattern.
</p>
</li>
<li> <p><code>MLE</code> - MLE estimates of attribute pattern.
</p>
</li>
<li> <p><code>mp</code> -  marginal mastery probabilities.
</p>
</li>
<li> <p><code>HO</code> -  EAP estimates of higher-order ability if a higher-order is fitted.
</p>
</li></ul>
</td></tr>
<tr><td><code id="GDINA_+3A_withse">withSE</code></td>
<td>
<p>argument for method <code><a href="stats.html#topic+coef">coef</a></code>; estimate standard errors or not?</p>
</td></tr>
<tr><td><code id="GDINA_+3A_se.type">SE.type</code></td>
<td>
<p>type of standard errors. For now, SEs are calculated based on outper-product of gradient.
It can be <code>1</code> based on item-wise information, <code>2</code> based on incomplete information and <code>3</code>
based on complete information.</p>
</td></tr>
<tr><td><code id="GDINA_+3A_digits">digits</code></td>
<td>
<p>How many decimal places in each number? The default is 4.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>GDINA</code> returns an object of class <code>GDINA</code>. Methods for <code>GDINA</code> objects
include <code><a href="#topic+extract">extract</a></code> for extracting various components, <code><a href="stats.html#topic+coef">coef</a></code>
for extracting structural parameters, <code><a href="#topic+personparm">personparm</a></code>
for calculating incidental (person) parameters, <code>summary</code> for summary information.
<code>AIC</code>, <code>BIC</code>,<code>logLik</code>, <code>deviance</code> and <code>npar</code> can also be used to
calculate AIC, BIC, observed log-likelihood, deviance and number of parameters.
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>anova(GDINA)</code>: Model comparison using likelihood ratio test
</p>
</li>
<li> <p><code>coef(GDINA)</code>: extract structural parameter estimates
</p>
</li>
<li> <p><code>extract(GDINA)</code>: extract various elements of GDINA estimates
</p>
</li>
<li> <p><code>personparm(GDINA)</code>: calculate person attribute patterns and higher-order ability
</p>
</li>
<li> <p><code>logLik(GDINA)</code>: calculate log-likelihood
</p>
</li>
<li> <p><code>deviance(GDINA)</code>: calculate deviance
</p>
</li>
<li> <p><code>nobs(GDINA)</code>: calculate number of observations
</p>
</li>
<li> <p><code>vcov(GDINA)</code>: calculate covariance-matrix for delta parameters
</p>
</li>
<li> <p><code>npar(GDINA)</code>: calculate the number of parameters
</p>
</li>
<li> <p><code>indlogLik(GDINA)</code>: extract log-likelihood for each individual
</p>
</li>
<li> <p><code>indlogPost(GDINA)</code>: extract log posterior for each individual
</p>
</li>
<li> <p><code>summary(GDINA)</code>: print summary information
</p>
</li></ul>


<h3>The G-DINA model</h3>

<p>The generalized DINA model (G-DINA; de la Torre, 2011) is an extension of the DINA model.
Unlike the DINA model, which collaspes all latent classes into two latent groups for
each item, if item <code class="reqn">j</code> requires <code class="reqn">K_j^*</code>
attributes, the G-DINA model collapses <code class="reqn">2^K</code> latent classes into <code class="reqn">2^{K_j^*}</code>
latent groups with unique success probabilities on item <code class="reqn">j</code>, where
<code class="reqn">K_j^*=\sum_{k=1}^{K}q_{jk}</code>.
</p>
<p>Let <code class="reqn">\boldsymbol{\alpha}_{lj}^*</code> be the reduced attribute
pattern consisting of the columns of the attributes required by item <code class="reqn">j</code>, where
<code class="reqn">l=1,\ldots,2^{K_j^*}</code>. For example, if only the first and the last attributes are
required, <code class="reqn">\boldsymbol{\alpha}_{lj}^*=(\alpha_{l1},\alpha_{lK})</code>. For notational
convenience, the first <code class="reqn">K_j^*</code> attributes can be assumed to be the required attributes
for item <code class="reqn">j</code> as in de la Torre (2011). The probability of success <code class="reqn">P(X_{j}=1|\boldsymbol{\alpha}_{lj}^*)</code> is denoted
by <code class="reqn">P(\boldsymbol{\alpha}_{lj}^*)</code>. To model this probability of success, different link functions
as in the generalized linear models are used in the G-DINA model. The item response
function of the G-DINA model using the identity link can be written as
</p>
<p style="text-align: center;"><code class="reqn">
f[P(\boldsymbol{\alpha}_{lj}^*)]=\delta_{j0}+\sum_{k=1}^{K_j^*}\delta_{jk}\alpha_{lk}+
\sum_{k'=k+1}^{K_j^*}\sum_{k=1}^{K_j^*-1}\delta_{jkk'}\alpha_{lk}\alpha_{lk'}+\cdots+
\delta_{j12{\cdots}K_j^*}\prod_{k=1}^{K_j^*}\alpha_{lk},
</code>
</p>

<p>or in matrix form,
</p>
<p style="text-align: center;"><code class="reqn">
f[\boldsymbol{P}_j]=\boldsymbol{M}_j\boldsymbol{\delta}_j,
</code>
</p>

<p>where <code class="reqn">\delta_{j0}</code> is the intercept for item <code class="reqn">j</code>, <code class="reqn">\delta_{jk}</code> is the main effect
due to <code class="reqn">\alpha_{lk}</code>, <code class="reqn">\delta_{jkk'}</code> is the interaction effect due to
<code class="reqn">\alpha_{lk}</code> and <code class="reqn">\alpha_{lk'}</code>, <code class="reqn">\delta_{j12{\ldots}K_j^*}</code> is the interaction
effect due to <code class="reqn">\alpha_{l1}, \cdots,\alpha_{lK_j^*}</code>. The log and logit links can also
be employed.
</p>


<h3>Other CDMs as special cases</h3>

<p>Several widely used CDMs can be obtained by setting appropriate constraints to the G-DINA model.
This section introduces the parameterization
of different CDMs within the G-DINA model framework very breifly. Readers interested in this please refer to
de la Torre(2011) for details.
</p>

<dl>
<dt><code>DINA model</code></dt><dd>
<p>In DINA model, each item has two item parameters - guessing (<code class="reqn">g</code>) and slip (<code class="reqn">s</code>). In traditional
parameterization of the DINA model, a latent variable <code class="reqn">\eta</code> for person <code class="reqn">i</code> and
item <code class="reqn">j</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">\eta_{ij}=\prod_{k=1}^K\alpha_{ik}^{q_{jk}}</code>
</p>

<p>Briefly speaking, if individual <code class="reqn">i</code> master all attributes required by item <code class="reqn">j</code>,
<code class="reqn">\eta_{ij}=1</code>; otherwise, <code class="reqn">\eta_{ij}=0</code>.
Item response function of the DINA model can be written by
</p>
<p style="text-align: center;"><code class="reqn">P(X_{ij}=1|\eta_{ij})=(1-s_j)^{\eta_{ij}}g_j^{1-\eta_{ij}}</code>
</p>

<p>To obtain the DINA model from the G-DINA model,
all terms in identity link G-DINA model except <code class="reqn">\delta_0</code> and <code class="reqn">\delta_{12{\ldots}K_j^*}</code>
need to be fixed to zero, that is,
</p>
<p style="text-align: center;"><code class="reqn">P(\boldsymbol{\alpha}_{lj}^*)=
       \delta_{j0}+\delta_{j12{\cdots}K_j^*}\prod_{k=1}^{K_j^*}\alpha_{lk}</code>
</p>

<p>In this parameterization, <code class="reqn">\delta_{j0}=g_j</code> and <code class="reqn">\delta_{j0}+\delta_{j12{\cdots}K_j^*}=1-s_j</code>.
</p>
</dd>
<dt><code>DINO model</code></dt><dd>
<p>The DINO model can be given by
</p>
<p style="text-align: center;"><code class="reqn">P(\boldsymbol{\alpha}_{lj}^{*})=
       \delta_{j0}+\delta_{j1}I(\boldsymbol{\alpha}_{lj}^*\neq \boldsymbol{0})</code>
</p>

<p>where <code class="reqn">I(\cdot)</code> is an indicator variable. The DINO model is also a constrained identity
link G-DINA model. As shown by de la Torre (2011), the appropriate constraint is
</p>
<p style="text-align: center;"><code class="reqn">\delta_{jk}=-\delta_{jk^{'}k^{''}}=\cdots=(-1)^{K_j^*+1}\delta_{j12{\cdots}K_j^*},</code>
</p>
<p> for
<code class="reqn">k=1,\cdots,K_j^*, k^{'}=1,\cdots,K_j^*-1</code>, and <code class="reqn">k^{''}&gt;k^{'},\cdots,K_j^*</code>.
</p>
</dd>
<dt><code>Additive models with different link functions</code></dt><dd>
<p>The A-CDM, LLM and R-RUM can be obtained by setting all interactions to be zero in
identity, logit and log link G-DINA model, respectively. Specifically, the A-CDM can be formulated as
</p>
<p style="text-align: center;"><code class="reqn">P(\boldsymbol{\alpha}_{lj}^*)=
       \delta_{j0}+\sum_{k=1}^{K_j^*}\delta_{jk}\alpha_{lk}</code>
</p>

<p>The item response function for
LLM can be given by
</p>
<p style="text-align: center;"><code class="reqn"> logit[P(\boldsymbol{\alpha}_{lj}^*)]=\delta_{j0}+\sum_{k=1}^{K_j^*}\delta_{jk}\alpha_{lk},</code>
</p>

<p>and lastly, the RRUM, can be written as
</p>
<p style="text-align: center;"><code class="reqn">log[P(\boldsymbol{\alpha}_{lj}^*)]=\delta_{j0}+\sum_{k=1}^{K_j^*}\delta_{jk}\alpha_{lk}.</code>
</p>
<p> It should be
noted that the LLM is equivalent to the compensatory RUM, which is subsumed by the GDM, and that
the RRUM is a special case of the generalized noisy inputs, deterministic &ldquo;And&quot; gate model (G-NIDA).
</p>
</dd>
<dt><code>Simultaneously identifying skills and misconceptions (SISM)</code></dt><dd>
<p>The SISM can be can be reformulated as
</p>
<p style="text-align: center;"><code class="reqn">P(\boldsymbol{\alpha}_{lj}^*)=
       \delta_{j0}+\delta_{j1}I[{mastering all skills}]+
       \delta_{j2}I[{having no bugs}]+\delta_{j12}I[{mastering all skills and having no bugs}].</code>
</p>

<p>As a result,the success probability of students who have mastered all the measured skills and possess
none of the measured misconceptions (<code class="reqn">h_j</code> in Equation 4 of Kuo, et al, 2018) is
<code class="reqn">\delta_{j0}+\delta_{j1}+\delta_{j2}+\delta_{j12}</code>, the success probability of students who have
mastered all the measured skills but possess some of the measured misconceptions (<code class="reqn">\omega_j</code>)
is <code class="reqn">\delta_{j0}+\delta_{j1}</code>, the success probability of students who have not mastered all the
measured skills and possess none of the measured misconceptions (<code class="reqn">g_j</code>) is
<code class="reqn">\delta_{j0}+\delta_{j2}</code> and success probability of students who have not mastered all the
measured skills and possess at least one of the measured misconceptions(<code class="reqn">\epsilon_j</code>) is
<code class="reqn">\delta_{j0}</code>.
</p>
<p>By specifying <code>no.bugs</code> being equal to the number of attributes, the Bug-DINO is obtained, as in
</p>
<p style="text-align: center;"><code class="reqn">P(\boldsymbol{\alpha}_{lj}^*)=\delta_{j0}+\delta_{j1}I[{having no bugs}].</code>
</p>

</dd>
</dl>



<h3>Joint Attribute Distribution</h3>

<p>The joint attribute distribution can be modeled using various methods. This section mainly focuses on the so-called
higher-order approach, which was originally proposed by de la Torre
and Douglas (2004) for the DINA model. It has been extended in this package for all condensation rules.
Particularly, three approaches are available for the higher-order attribute structure:
intercept only approach, common slope approach and varied slope approach.
For the intercept only approach, the probability of mastering attribute <code class="reqn">k</code> for individual <code class="reqn">i</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">P(\alpha_k=1|\theta_i,\lambda_{0k})=\frac{exp(\theta_i+\lambda_{0k})}{1+exp(\theta_i+\lambda_{0k})}</code>
</p>

<p>For the common slope approach, the probability of mastering attribute <code class="reqn">k</code> for individual <code class="reqn">i</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">P(\alpha_k=1|\theta_i,\lambda_{0k},\lambda_{1})=\frac{exp(\lambda_{1}\theta_i+\lambda_{0k})}{1+exp(\lambda_{1}\theta_i+\lambda_{0k})}</code>
</p>

<p>For the varied slope approach, the probability of mastering attribute <code class="reqn">k</code> for individual <code class="reqn">i</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">P(\alpha_k=1|\theta_i,\lambda_{0k},\lambda_{1k})=\frac{exp(\lambda_{1k}\theta_i+\lambda_{0k})}{1+exp(\lambda_{1k}\theta_i+\lambda_{0k})}</code>
</p>

<p>where <code class="reqn">\theta_i</code> is the ability of examinee <code class="reqn">i</code>. <code class="reqn">\lambda_{0k}</code> and <code class="reqn">\lambda_{1k}</code> are the intercept
and slope parameters for attribute <code class="reqn">k</code>, respectively.
The probability of joint attributes can be written as
</p>
<p style="text-align: center;"><code class="reqn">P(\boldsymbol{\alpha}|\theta_i,\boldsymbol{\lambda})=\prod_k P(\alpha_k|\theta_i,\boldsymbol{\lambda})</code>
</p>
<p>.
</p>


<h3>Model Estimation</h3>

<p>The MMLE/EM algorithm is implemented in this package. For G-DINA, DINA and DINO models, closed-form solutions exist.
See de la Torre (2009) and de la Torre (2011) for details.
For ACDM, LLM and RRUM, closed-form solutions do not exist, and therefore some general optimization techniques are
adopted in M-step (Ma, Iaconangelo &amp; de la Torre, 2016). The selection of optimization techniques mainly depends on whether
some specific constraints need to be added.
</p>
<p>The sequential G-DINA model is a special case of the diagnostic tree model (DTM; Ma, 2019) and estimated using
the mapping matrix accordingly (See Tutz, 1997; Ma, 2019).
</p>


<h3>The Number of Parameters</h3>

<p>For dichotomous response models:
Assume a test measures <code class="reqn">K</code> attributes and item <code class="reqn">j</code> requires <code class="reqn">K_j^*</code> attributes:
The DINA and DINO model has 2 item parameters for each item;
if item <code class="reqn">j</code> is ACDM, LLM or RRUM, it has <code class="reqn">K_j^*+1</code> item parameters; if it is G-DINA model, it has <code class="reqn">2^{K_j^*}</code> item parameters.
Apart from item parameters, the parameters involved in the estimation of joint attribute distribution need to be estimated as well.
When using the saturated attribute structure, there are <code class="reqn">2^K-1</code> parameters for joint attribute distribution estimation; when
using a higher-order attribute structure, there are <code class="reqn">K</code>, <code class="reqn">K+1</code>, and <code class="reqn">2\times K</code> parameters for the intercept only approach, common slope approach and varied slope approach, respectively.
For polytomous response data using the sequential G-DINA model, the number of item parameters
are counted at category level.
</p>


<h3>Note</h3>

<p>anova function does NOT check whether models compared are nested or not.
</p>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>References</h3>

<p>Bock, R. D., &amp; Aitkin, M. (1981). Marginal maximum likelihood estimation of item parameters: Application of an EM algorithm. <em>Psychometrika, 46</em>, 443-459.
</p>
<p>Bock, R. D., &amp; Lieberman, M. (1970). Fitting a response model forn dichotomously scored items. <em>Psychometrika, 35</em>, 179-197.
</p>
<p>Bor-Chen Kuo, Chun-Hua Chen, Chih-Wei Yang, &amp; Magdalena Mo Ching Mok. (2016). Cognitive diagnostic models for tests with multiple-choice and constructed-response items. <em>Educational Psychology, 36</em>, 1115-1133.
</p>
<p>Carlin, B. P., &amp; Louis, T. A. (2000). Bayes and empirical bayes methods for data analysis. New York, NY: Chapman &amp; Hall
</p>
<p>de la Torre, J., &amp; Douglas, J. A. (2008). Model evaluation and multiple strategies in cognitive diagnosis: An analysis of fraction subtraction data. <em>Psychometrika, 73</em>, 595-624.
</p>
<p>de la Torre, J. (2009). DINA Model and Parameter Estimation: A Didactic. <em>Journal of Educational and Behavioral Statistics, 34</em>, 115-130.
</p>
<p>de la Torre, J. (2011). The generalized DINA model framework. <em>Psychometrika, 76</em>, 179-199.
</p>
<p>de la Torre, J., &amp; Douglas, J. A. (2004). Higher-order latent trait models for cognitive diagnosis. <em>Psychometrika, 69</em>, 333-353.
</p>
<p>de la Torre, J., &amp; Lee, Y. S. (2013). Evaluating the wald test for item-level comparison of
saturated and reduced models in cognitive diagnosis. <em>Journal of Educational Measurement, 50</em>, 355-373.
</p>
<p>Haertel, E. H. (1989). Using restricted latent class models to map the skill structure of achievement items.
<em>Journal of Educational Measurement, 26</em>, 301-321.
</p>
<p>Hartz, S. M. (2002). A bayesian framework for the unified model for assessing cognitive abilities:
Blending theory with practicality (Unpublished doctoral dissertation). University of Illinois at Urbana-Champaign.
</p>
<p>Huo, Y., &amp; de la Torre, J. (2014). Estimating a Cognitive Diagnostic Model for Multiple Strategies via the EM Algorithm. <em>Applied Psychological Measurement, 38</em>, 464-485.
</p>
<p>Junker, B. W., &amp; Sijtsma, K. (2001). Cognitive assessment models with few assumptions, and connections with nonparametric
item response theory. <em>Applied Psychological Measurement, 25</em>, 258-272.
</p>
<p>Kuo, B.-C., Chen.-H., &amp; de la Torre,J. (2018). A cognitive diagnosis model for identifying coexisting skills and misconceptions.<em>Applied Psychological Measuremet</em>, 179191.
</p>
<p>Ma, W., &amp; de la Torre, J. (2016). A sequential cognitive diagnosis model for polytomous responses. <em>British Journal of Mathematical and Statistical Psychology. 69,</em> 253-275.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Ma, W. (2019). A diagnostic tree model for polytomous responses with multiple strategies. <em>British Journal of Mathematical and Statistical Psychology, 72</em>, 61-82.
</p>
<p>Ma, W., Iaconangelo, C., &amp; de la Torre, J. (2016). Model similarity, model selection and attribute classification. <em>Applied Psychological Measurement, 40</em>, 200-217.
</p>
<p>Ma, W. (2017). <em>A Sequential Cognitive Diagnosis Model for Graded Response: Model Development, Q-Matrix Validation,and Model Comparison. Unpublished doctoral dissertation.</em> New Brunswick, NJ: Rutgers University.
</p>
<p>Maris, E. (1999). Estimating multiple classification latent class models. <em>Psychometrika, 64</em>, 187-212.
</p>
<p>Tatsuoka, K. K. (1983). Rule space: An approach for dealing with misconceptions based on item response theory. <em>Journal of Educational Measurement, 20</em>, 345-354.
</p>
<p>Templin, J. L., &amp; Henson, R. A. (2006). Measurement of psychological disorders using cognitive diagnosis models. <em>Psychological Methods, 11</em>, 287-305.
</p>
<p>Tutz, G. (1997). Sequential models for ordered responses. In W.J. van der Linden &amp; R. K. Hambleton (Eds.), Handbook of modern item response theory p. 139-152). New York, NY: Springer.
</p>
<p>Xu, X., &amp; von Davier, M. (2008). Fitting the structured general diagnostic model to NAEP data. ETS research report, RR-08-27.
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+autoGDINA">autoGDINA</a></code> for Q-matrix validation, item-level model comparison and model calibration
in one run; See <code><a href="#topic+modelfit">modelfit</a></code> and <code><a href="#topic+itemfit">itemfit</a></code> for model and item fit analysis, <code><a href="#topic+Qval">Qval</a></code> for Q-matrix validation,
<code><a href="#topic+modelcomp">modelcomp</a></code> for item level model comparison and <code><a href="#topic+simGDINA">simGDINA</a></code> for data simulation.
<code><a href="#topic+GMSCDM">GMSCDM</a></code> for a series of multiple strategy CDMs for dichotomous data,
and <code><a href="#topic+DTM">DTM</a></code> for diagnostic tree model for multiple strategies in polytomous response data
Also see <code>gdina</code> in <span class="pkg">CDM</span> package for the G-DINA model estimation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
####################################
#        Example 1.                #
#     GDINA, DINA, DINO            #
#    ACDM, LLM and RRUM            #
# estimation and comparison        #
#                                  #
####################################

dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ

#--------GDINA model --------#

mod1 &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
mod1
# summary information
summary(mod1)

AIC(mod1) #AIC
BIC(mod1) #BIC
logLik(mod1) #log-likelihood value
deviance(mod1) # deviance: -2 log-likelihood
npar(mod1) # number of parameters


head(indlogLik(mod1)) # individual log-likelihood
head(indlogPost(mod1)) # individual log-posterior

# structural parameters
# see ?coef
coef(mod1) # item probabilities of success for each latent group
coef(mod1, withSE = TRUE) # item probabilities of success &amp; standard errors
coef(mod1, what = "delta") # delta parameters
coef(mod1, what = "delta",withSE=TRUE) # delta parameters
coef(mod1, what = "gs") # guessing and slip parameters
coef(mod1, what = "gs",withSE = TRUE) # guessing and slip parameters &amp; standard errors

# person parameters
# see ?personparm
personparm(mod1) # EAP estimates of attribute profiles
personparm(mod1, what = "MAP") # MAP estimates of attribute profiles
personparm(mod1, what = "MLE") # MLE estimates of attribute profiles

#plot item response functions for item 10
plot(mod1,item = 10)
plot(mod1,item = 10,withSE = TRUE) # with error bars
#plot mastery probability for individuals 1, 20 and 50
plot(mod1,what = "mp", person =c(1,20,50))

# Use extract function to extract more components
# See ?extract

# ------- DINA model --------#
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
mod2 &lt;- GDINA(dat = dat, Q = Q, model = "DINA")
mod2
coef(mod2, what = "gs") # guess and slip parameters
coef(mod2, what = "gs",withSE = TRUE) # guess and slip parameters and standard errors

# Model comparison at the test level via likelihood ratio test
anova(mod1,mod2)

# -------- DINO model -------#
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
mod3 &lt;- GDINA(dat = dat, Q = Q, model = "DINO")
#slip and guessing
coef(mod3, what = "gs") # guess and slip parameters
coef(mod3, what = "gs",withSE = TRUE) # guess and slip parameters + standard errors

# Model comparison at test level via likelihood ratio test
anova(mod1,mod2,mod3)

# --------- ACDM model -------#
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
mod4 &lt;- GDINA(dat = dat, Q = Q, model = "ACDM")
mod4
# --------- LLM model -------#
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
mod4b &lt;- GDINA(dat = dat, Q = Q, model = "LLM")
mod4b
# --------- RRUM model -------#
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
mod4c &lt;- GDINA(dat = dat, Q = Q, model = "RRUM")
mod4c

# --- Different CDMs for different items --- #

dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
models &lt;- c(rep("GDINA",3),"LLM","DINA","DINO","ACDM","RRUM","LLM","RRUM")
mod5 &lt;- GDINA(dat = dat, Q = Q, model = models)
anova(mod1,mod2,mod3,mod4,mod4b,mod4c,mod5)


####################################
#        Example 2.                #
#        Model estimations         #
# With monotonocity constraints    #
####################################

dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
# for item 10 only
mod11 &lt;- GDINA(dat = dat, Q = Q, model = "GDINA",mono.constraint = c(rep(FALSE,9),TRUE))
mod11
mod11a &lt;- GDINA(dat = dat, Q = Q, model = "DINA",mono.constraint = TRUE)
mod11a
mod11b &lt;- GDINA(dat = dat, Q = Q, model = "ACDM",mono.constraint = TRUE)
mod11b
mod11c &lt;- GDINA(dat = dat, Q = Q, model = "LLM",mono.constraint = TRUE)
mod11c
mod11d &lt;- GDINA(dat = dat, Q = Q, model = "RRUM",mono.constraint = TRUE)
mod11d
coef(mod11d,"delta")
coef(mod11d,"rrum")

####################################
#           Example 3a.            #
#        Model estimations         #
# With Higher-order att structure  #
####################################

dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
# --- Higher order G-DINA model ---#
mod12 &lt;- GDINA(dat = dat, Q = Q, model = "DINA",
               att.dist="higher.order",higher.order=list(nquad=31,model = "2PL"))
personparm(mod12,"HO") # higher-order ability
# structural parameters
# first column is slope and the second column is intercept
coef(mod12,"lambda")
# --- Higher order DINA model ---#
mod22 &lt;- GDINA(dat = dat, Q = Q, model = "DINA", att.dist="higher.order",
               higher.order=list(model = "2PL",Prior=TRUE))

####################################
#           Example 3b.            #
#        Model estimations         #
#   With log-linear att structure  #
####################################

# --- DINA model with loglinear smoothed attribute space ---#
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
mod23 &lt;- GDINA(dat = dat, Q = Q, model = "DINA",att.dist="loglinear",loglinear=1)
coef(mod23,"lambda") # intercept and three main effects

####################################
#           Example 3c.            #
#        Model estimations         #
#  With independent att structure  #
####################################

# --- GDINA model with independent attribute space ---#
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
mod33 &lt;- GDINA(dat = dat, Q = Q, att.dist="independent")
coef(mod33,"lambda") # mastery probability for each attribute

####################################
#          Example 4.              #
#        Model estimations         #
#    With fixed att structure      #
####################################

# --- User-specified attribute priors ----#
# prior distribution is fixed during calibration
# Assume each of 000,100,010 and 001 has probability of 0.1
# and each of 110, 101,011 and 111 has probability of 0.15
# Note that the sum is equal to 1
#
prior &lt;- c(0.1,0.1,0.1,0.1,0.15,0.15,0.15,0.15)
# fit GDINA model  with fixed prior dist.
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
modp1 &lt;- GDINA(dat = dat, Q = Q, att.prior = prior, att.dist = "fixed")
extract(modp1, what = "att.prior")

####################################
#          Example 5a.             #
#             G-DINA               #
# with hierarchical att structure  #
####################################

# --- User-specified attribute structure ----#
Q &lt;- sim30GDINA$simQ
K &lt;- ncol(Q)
# divergent structure A1-&gt;A2-&gt;A3;A1-&gt;A4-&gt;A5
diverg &lt;- list(c(1,2),
               c(2,3),
               c(1,4),
               c(4,5))
struc &lt;- att.structure(diverg,K)
set.seed(123)
# data simulation
N &lt;- 1000
true.lc &lt;- sample(c(1:2^K),N,replace=TRUE,prob=struc$att.prob)
table(true.lc) #check the sample
true.att &lt;- attributepattern(K)[true.lc,]
 gs &lt;- matrix(rep(0.1,2*nrow(Q)),ncol=2)
 # data simulation
 simD &lt;- simGDINA(N,Q,gs.parm = gs, model = "GDINA",attribute = true.att)
 dat &lt;- extract(simD,"dat")

modp1 &lt;- GDINA(dat = dat, Q = Q, att.str = diverg, att.dist = "saturated")
modp1
coef(modp1,"lambda")

####################################
#          Example 5b.             #
#   Reduced model (e.g.,ACDM)      #
# with hierarchical att structure  #
####################################

# --- User-specified attribute structure ----#
Q &lt;- sim30GDINA$simQ
K &lt;- ncol(Q)
# linear structure A1-&gt;A2-&gt;A3-&gt;A4-&gt;A5
linear &lt;- list(c(1,2),
               c(2,3),
               c(3,4),
               c(4,5))
struc &lt;- att.structure(linear,K)
set.seed(123)
# data simulation
N &lt;- 1000
true.lc &lt;- sample(c(1:2^K),N,replace=TRUE,prob=struc$att.prob)
table(true.lc) #check the sample
true.att &lt;- attributepattern(K)[true.lc,]
 gs &lt;- matrix(rep(0.1,2*nrow(Q)),ncol=2)
 # data simulation
 simD &lt;- simGDINA(N,Q,gs.parm = gs, model = "ACDM",attribute = true.att)
 dat &lt;- extract(simD,"dat")

modp1 &lt;- GDINA(dat = dat, Q = Q, model = "ACDM",
               att.str = linear, att.dist = "saturated")
coef(modp1)
coef(modp1,"lambda")

####################################
#           Example 6.             #
# Specify initial values for item  #
# parameters                       #
####################################

 # check initials to see the format for initial item parameters
 initials &lt;- sim10GDINA$simItempar

 dat &lt;- sim10GDINA$simdat
 Q &lt;- sim10GDINA$simQ
 mod.initial &lt;- GDINA(dat,Q,catprob.parm = initials)

 # compare initial item parameters
 Map(rbind, initials,extract(mod.initial,"initial.catprob"))

####################################
#           Example 7a.            #
# Fix item and structure parameters#
# Estimate person attribute profile#
####################################

 # check initials to see the format for initial item parameters
 initials &lt;- sim10GDINA$simItempar
 prior &lt;- c(0.1,0.1,0.1,0.1,0.15,0.15,0.15,0.15)
 dat &lt;- sim10GDINA$simdat
 Q &lt;- sim10GDINA$simQ
 mod.ini &lt;- GDINA(dat,Q,catprob.parm = initials,att.prior = prior,
                  att.dist = "fixed",control=list(maxitr = 0))
 personparm(mod.ini)
 # compare item parameters
 Map(rbind, initials,coef(mod.ini))

####################################
#           Example 7b.            #
#   Fix parameters for some items  #
# Estimate person attribute profile#
####################################

 # check initials to see the format for initial item parameters
 initials &lt;- sim10GDINA$simItempar
 prior &lt;- c(0.1,0.1,0.1,0.1,0.15,0.15,0.15,0.15)
 dat &lt;- sim10GDINA$simdat
 Q &lt;- sim10GDINA$simQ
 # fix parameters of the first 5 items; do not fix mixing proportion parameters
 mod.ini &lt;- GDINA(dat,Q,catprob.parm = initials,
                  att.dist = "saturated",control=list(maxitr = c(rep(0,5),rep(2000,5))))
 personparm(mod.ini)
 # compare item parameters
 Map(rbind, initials,coef(mod.ini))

####################################
#           Example 8.             #
#        polytomous attribute      #
#          model estimation        #
#    see Chen, de la Torre 2013    #
####################################


# --- polytomous attribute G-DINA model --- #
dat &lt;- sim30pGDINA$simdat
Q &lt;- sim30pGDINA$simQ
#polytomous G-DINA model
pout &lt;- GDINA(dat,Q)

# ----- polymous DINA model --------#
pout2 &lt;- GDINA(dat,Q,model="DINA")
anova(pout,pout2)

####################################
#           Example 9.             #
#        Sequential G-DINA model   #
#    see Ma, &amp; de la Torre 2016    #
####################################

# --- polytomous attribute G-DINA model --- #
dat &lt;- sim20seqGDINA$simdat
Q &lt;- sim20seqGDINA$simQ
Q
#    Item Cat A1 A2 A3 A4 A5
#       1   1  1  0  0  0  0
#       1   2  0  1  0  0  0
#       2   1  0  0  1  0  0
#       2   2  0  0  0  1  0
#       3   1  0  0  0  0  1
#       3   2  1  0  0  0  0
#       4   1  0  0  0  0  1
#       ...

#sequential G-DINA model
sGDINA &lt;- GDINA(dat,Q,sequential = TRUE)
sDINA &lt;- GDINA(dat,Q,sequential = TRUE,model = "DINA")
anova(sGDINA,sDINA)
coef(sDINA) # processing function
coef(sDINA,"itemprob") # success probabilities for each item
coef(sDINA,"LCprob") # success probabilities for each category for all latent classes

####################################
#           Example 10a.           #
#    Multiple-Group G-DINA model   #
####################################

Q &lt;- sim10GDINA$simQ
K &lt;- ncol(Q)
# parameter simulation
# Group 1 - female
N1 &lt;- 3000
gs1 &lt;- matrix(rep(0.1,2*nrow(Q)),ncol=2)
# Group 2 - male
N2 &lt;- 3000
gs2 &lt;- matrix(rep(0.2,2*nrow(Q)),ncol=2)

# data simulation for each group
sim1 &lt;- simGDINA(N1,Q,gs.parm = gs1,model = "DINA",att.dist = "higher.order",
                 higher.order.parm = list(theta = rnorm(N1),
                 lambda = data.frame(a=rep(1.5,K),b=seq(-1,1,length.out=K))))
sim2 &lt;- simGDINA(N2,Q,gs.parm = gs2,model = "DINO",att.dist = "higher.order",
                 higher.order.parm = list(theta = rnorm(N2),
                 lambda = data.frame(a=rep(1,K),b=seq(-2,2,length.out=K))))

# combine data - all items have the same item parameters
dat &lt;- rbind(extract(sim1,"dat"),extract(sim2,"dat"))
gr &lt;- rep(c(1,2),c(3000,3000))
# Fit G-DINA model
mg.est &lt;- GDINA(dat = dat,Q = Q,group = gr)
summary(mg.est)
extract(mg.est,"posterior.prob")
coef(mg.est,"lambda")


####################################
#           Example 10b.           #
#    Multiple-Group G-DINA model   #
####################################

Q &lt;- sim30GDINA$simQ
K &lt;- ncol(Q)
# parameter simulation
N1 &lt;- 3000
gs1 &lt;- matrix(rep(0.1,2*nrow(Q)),ncol=2)
N2 &lt;- 3000
gs2 &lt;- matrix(rep(0.2,2*nrow(Q)),ncol=2)

# data simulation for each group
# two groups have different theta distributions
sim1 &lt;- simGDINA(N1,Q,gs.parm = gs1,model = "DINA",att.dist = "higher.order",
                 higher.order.parm = list(theta = rnorm(N1),
                 lambda = data.frame(a=rep(1,K),b=seq(-2,2,length.out=K))))
sim2 &lt;- simGDINA(N2,Q,gs.parm = gs2,model = "DINO",att.dist = "higher.order",
                 higher.order.parm = list(theta = rnorm(N2,1,1),
                 lambda = data.frame(a=rep(1,K),b=seq(-2,2,length.out=K))))

# combine data - different groups have distinct item parameters
# see ?bdiagMatrix
dat &lt;- bdiagMatrix(list(extract(sim1,"dat"),extract(sim2,"dat")),fill=NA)
Q &lt;- rbind(Q,Q)
gr &lt;- rep(c(1,2),c(3000,3000))
mg.est &lt;- GDINA(dat = dat,Q = Q,group = gr)
# Fit G-DINA model
mg.est &lt;- GDINA(dat = dat,Q = Q,group = gr,att.dist="higher.order",
higher.order=list(model = "Rasch"))
summary(mg.est)
coef(mg.est,"lambda")
personparm(mg.est)
personparm(mg.est,"HO")
extract(mg.est,"posterior.prob")


####################################
#           Example 11.            #
#           Bug DINO model         #
####################################

set.seed(123)
Q &lt;- sim10GDINA$simQ # 1 represents misconceptions/bugs
N &lt;- 1000
J &lt;- nrow(Q)

gs &lt;- data.frame(guess=rep(0.1,J),slip=rep(0.1,J))

sim &lt;- simGDINA(N,Q,gs.parm = gs,model = "BUGDINO")
dat &lt;- extract(sim,"dat")
est &lt;- GDINA(dat=dat,Q=Q,model = "BUGDINO")
coef(est)

####################################
#           Example 12.            #
#           SISM model             #
####################################

# The Q-matrix used in Kuo, et al (2018)
# The first four columns are for Attributes 1-4
# The last three columns are for Bugs 1-3
Q &lt;- matrix(c(1,0,0,0,0,0,0,
0,1,0,0,0,0,0,
0,0,1,0,0,0,0,
0,0,0,1,0,0,0,
0,0,0,0,1,0,0,
0,0,0,0,0,1,0,
0,0,0,0,0,0,1,
1,0,0,0,1,0,0,
0,1,0,0,1,0,0,
0,0,1,0,0,0,1,
0,0,0,1,0,1,0,
1,1,0,0,1,0,0,
1,0,1,0,0,0,1,
1,0,0,1,0,0,1,
0,1,1,0,0,0,1,
0,1,0,1,0,1,1,
0,0,1,1,0,1,1,
1,0,1,0,1,1,0,
1,1,0,1,1,1,0,
0,1,1,1,1,1,0),ncol = 7,byrow = TRUE)

J &lt;- nrow(Q)
N &lt;- 1000
gs &lt;- data.frame(guess=rep(0.1,J),slip=rep(0.1,J))

sim &lt;- simGDINA(N,Q,gs.parm = gs,model = "SISM",no.bugs=3)
dat &lt;- extract(sim,"dat")
est &lt;- GDINA(dat=dat,Q=Q,model="SISM",no.bugs=3)
coef(est,"delta")

####################################
#           Example 13a.           #
#     user specified design matrix #
#        LCDM (logit G-DINA)       #
####################################

dat &lt;- sim30GDINA$simdat
Q &lt;- sim30GDINA$simQ

# LCDM
lcdm &lt;- GDINA(dat = dat, Q = Q, model = "logitGDINA", control=list(conv.type="neg2LL"))

#Another way is to find design matrix for each item first =&gt; must be a list
D &lt;- lapply(rowSums(Q),designmatrix,model="GDINA")
# for comparison, use change in -2LL as convergence criterion
# LCDM
lcdm2 &lt;- GDINA(dat = dat, Q = Q, model = "UDF", design.matrix = D,
linkfunc = "logit", control=list(conv.type="neg2LL"),solver="slsqp")

# identity link GDINA
iGDINA &lt;- GDINA(dat = dat, Q = Q, model = "GDINA",
control=list(conv.type="neg2LL"),solver="slsqp")

# compare all three models =&gt; identical
anova(lcdm,lcdm2,iGDINA)

####################################
#           Example 13b.           #
#     user specified design matrix #
#            RRUM                  #
####################################

dat &lt;- sim30GDINA$simdat
Q &lt;- sim30GDINA$simQ

# specify design matrix for each item =&gt; must be a list
# D can be defined by the user
D &lt;- lapply(rowSums(Q),designmatrix,model="ACDM")
# for comparison, use change in -2LL as convergence criterion
# RRUM
logACDM &lt;- GDINA(dat = dat, Q = Q, model = "UDF", design.matrix = D,
linkfunc = "log", control=list(conv.type="neg2LL"),solver="slsqp")

# identity link GDINA
RRUM &lt;- GDINA(dat = dat, Q = Q, model = "RRUM",
              control=list(conv.type="neg2LL"),solver="slsqp")

# compare two models =&gt; identical
anova(logACDM,RRUM)

####################################
#           Example 14.            #
#     Multiple-strategy DINA model #
####################################

Q &lt;- matrix(c(1,1,1,1,0,
1,2,0,1,1,
2,1,1,0,0,
3,1,0,1,0,
4,1,0,0,1,
5,1,1,0,0,
5,2,0,0,1),ncol = 5,byrow = TRUE)
d &lt;- list(
  item1=c(0.2,0.7),
  item2=c(0.1,0.6),
  item3=c(0.2,0.6),
  item4=c(0.2,0.7),
  item5=c(0.1,0.8))

  set.seed(12345)
sim &lt;- simGDINA(N=1000,Q = Q, delta.parm = d,
               model = c("MSDINA","MSDINA","DINA",
                         "DINA","DINA","MSDINA","MSDINA"))

# simulated data
dat &lt;- extract(sim,what = "dat")
# estimation
# MSDINA need to be specified for each strategy
est &lt;- GDINA(dat,Q,model = c("MSDINA","MSDINA","DINA",
                             "DINA","DINA","MSDINA","MSDINA"))
coef(est,"delta")

## End(Not run)

</code></pre>

<hr>
<h2 id='GDINA-package'>The Generalized DINA Model Framework</h2><span id='topic+GDINA-package'></span>

<h3>Description</h3>

<p>For conducting CDM analysis within the G-DINA model framework
</p>


<h3>Details</h3>

<p>This package (Ma &amp; de la Torre, 2020a) provides a framework for a series of cognitively diagnostic analyses
for dichotomous and polytomous responses.
</p>
<p>Various cognitive
diagnosis models (CDMs) can be calibrated using the <code><a href="#topic+GDINA">GDINA</a></code>
function, including the G-DINA model (de la Torre, 2011), the deterministic inputs,
noisy and gate (DINA; de la Torre, 2009; Junker &amp; Sijtsma, 2001) model,
the deterministic inputs, noisy or gate (DINO; Templin &amp; Henson, 2006)
model, the reduced reparametrized unified model (R-RUM; Hartz, 2002),
the additive CDM (A-CDM; de la Torre, 2011), and the linear logistic
model (LLM; Maris, 1999), the multiple-strategy DINA model (de la Torre, &amp; Douglas, 2008) and models defined
by users under the G-DINA framework using different link functions and design
matrices (de la Torre, 2011). Note that the LLM is also called
compensatory RUM and the RRUM is equivalent to the generalized NIDA model.
</p>
<p>For ordinal and nominal responses,
the sequential G-DINA model (Ma, &amp; de la Torre, 2016) can be fitted and most of the
aforementioned CDMs can be used as the processing functions (Ma, &amp; de la Torre, 2016) at the category level.
Different CDMs can be assigned to different items within a single assessment.
Item parameters are estimated using the MMLE/EM algorithm. Details about the estimation algorithm
can be found in Ma and de la Torre (2020).
The joint attribute distribution can be modeled using an independent model,
a higher-order IRT model (de la Torre, &amp; Douglas, 2004), a loglinear model (Xu &amp; von Davier, 2008),
a saturated model or a hierarchical structures (e.g., linear, divergent). Monotonicity constraints for item/category success
probabilities can also be specified.
</p>
<p>In addition, to handle multiple strategies, generalized multiple-strategy CDMs for dichotomous response (Ma &amp; Guo, 2019) can be fitted using <code><a href="#topic+GMSCDM">GMSCDM</a></code> function and
diagnostic tree model (Ma, 2019) can also be estimated using <code><a href="#topic+DTM">DTM</a></code> function for polytomous responses. Note that these functions are experimental, and are expected to be further extended
in the future. Other diagnostic approaches include the multiple-choice model (de la Torre, 2009) and an iterative latent class analysis (ILCA; Jiang, 2019).
</p>
<p>Various Q-matrix validation methods (de la Torre, &amp; Chiu, 2016; de la Torre &amp; Ma, 2016; Ma &amp; de la Torre, 2020b; Najera, Sorrel, &amp; Abad, 2019; see <code><a href="#topic+Qval">Qval</a></code>),
model-data fit statistics (Chen, de la Torre, &amp; Zhang, 2013; Hansen, Cai, Monroe, &amp; Li, 2016; Liu, Tian, &amp; Xin, 2016; Ma, 2020; see <code><a href="#topic+modelfit">modelfit</a></code> and <code><a href="#topic+itemfit">itemfit</a></code>),
model comparison at test and item level (de la Torre, 2011; de la Torre, &amp; Lee, 2013;
Ma, Iaconangelo, &amp; de la Torre, 2016; Ma &amp; de la Torre, 2019; Sorrel, Abad, Olea, de la Torre, &amp; Barrada, 2017; Sorrel, de la Torre, Abad, &amp; Olea, 2017; see <code><a href="#topic+modelcomp">modelcomp</a></code>),
and differential item functioning (Hou, de la Torre, &amp; Nandakumar, 2014; Ma, Terzi, Lee, &amp; de la Torre, 2017;
see <code><a href="#topic+dif">dif</a></code>) can also be conducted.
</p>
<p>To use the graphical user interface, check <code><a href="#topic+startGDINA">startGDINA</a></code>.
</p>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>References</h3>

<p>Chen, J., &amp; de la Torre, J. (2013). A General Cognitive Diagnosis Model for Expert-Defined Polytomous Attributes.
<em>Applied Psychological Measurement, 37</em>, 419-437.
</p>
<p>Chen, J., de la Torre, J., &amp; Zhang, Z. (2013). Relative and Absolute Fit Evaluation in Cognitive Diagnosis Modeling.
<em>Journal of Educational Measurement, 50</em>, 123-140.
</p>
<p>de la Torre, J. (2009). DINA Model and Parameter Estimation: A Didactic. <em>Journal of Educational and Behavioral Statistics, 34</em>, 115-130.
</p>
<p>de la Torre, J. (2011). The generalized DINA model framework. <em>Psychometrika, 76</em>, 179-199.
</p>
<p>de la Torre, J. &amp; Chiu, C-Y. (2016). A General Method of Empirical Q-matrix Validation. <em>Psychometrika, 81</em>, 253-273.
</p>
<p>de la Torre, J., &amp; Douglas, J. A. (2004). Higher-order latent trait models for cognitive diagnosis.
<em>Psychometrika, 69</em>, 333-353.
</p>
<p>de La Torre, J., &amp; Douglas, J. A. (2008). Model evaluation and multiple strategies in cognitive diagnosis: An analysis of fraction subtraction data. <em>Psychometrika, 73</em>, 595.
</p>
<p>de la Torre, J., &amp; Lee, Y. S. (2013). Evaluating the wald test for item-level comparison of
saturated and reduced models in cognitive diagnosis. <em>Journal of Educational Measurement, 50</em>, 355-373.
</p>
<p>de la Torre, J., &amp; Ma, W. (2016, August). Cognitive diagnosis modeling: A general framework approach and its implementation in R. A Short Course at the Fourth Conference on Statistical Methods in Psychometrics, Columbia University, New York.
</p>
<p>Haertel, E. H. (1989). Using restricted latent class models to map the skill structure of achievement items.
<em>Journal of Educational Measurement, 26</em>, 301-321.
</p>
<p>Hartz, S. M. (2002). A bayesian framework for the unified model for assessing cognitive abilities:
Blending theory with practicality (Unpublished doctoral dissertation). University of Illinois at Urbana-Champaign.
</p>
<p>Hou, L., de la Torre, J., &amp; Nandakumar, R. (2014). Differential item functioning assessment in cognitive diagnostic modeling: Application of the Wald test to
investigate DIF in the DINA model. <em>Journal of Educational Measurement, 51</em>, 98-125.
</p>
<p>Junker, B. W., &amp; Sijtsma, K. (2001). Cognitive assessment models with few assumptions, and connections with nonparametric
item response theory. <em>Applied Psychological Measurement, 25</em>, 258-272.
</p>
<p>Ma, W. (2019). A diagnostic tree model for polytomous responses with multiple strategies. <em>British Journal of Mathematical and Statistical Psychology, 72</em>, 61-82.
</p>
<p>Ma, W. (2020). Evaluating the fit of sequential G-DINA model using limited-information measures. <em>Applied Psychological Measurement, 44</em>, 167-181.
</p>
<p>Ma, W., &amp; de la Torre, J. (2016). A sequential cognitive diagnosis model for polytomous responses. <em>British Journal of Mathematical and Statistical Psychology. 69,</em> 253-275.
</p>
<p>Ma, W., &amp; de la Torre, J. (2019). Category-Level Model Selection for the Sequential G-DINA Model. <em>Journal of Educational and Behavioral Statistics</em>. 44, 61-82.
</p>
<p>Ma, W., &amp; de la Torre, J. (2019). Digital Module 05: Diagnostic measurement-The G-DINA framework.<em> Educational Measurement: Issues and Practice, 39</em>, 114-115.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020a). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020b). An empirical Q-matrix validation method for the sequential G-DINA model. <em>British Journal of Mathematical and Statistical Psychology, 73</em>, 142-163.
</p>
<p>Ma, W., &amp; Guo, W. (2019). Cognitive diagnosis models for multiple strategies. <em>British Journal of Mathematical and Statistical Psychology, 72</em>, 370-392.
</p>
<p>Ma, W., Iaconangelo, C., &amp; de la Torre, J. (2016). Model similarity, model selection and attribute classification.
<em>Applied Psychological Measurement, 40</em>, 200-217.
</p>
<p>Ma, W., Terzi, R., Lee, S., &amp; de la Torre, J. (2017, April). Multiple group cognitive diagnosis models and their applications in detecting differential item functioning. Paper presented at the Annual Meeting ofthe American Educational Research Association, San Antonio, TX.
</p>
<p>Maris, E. (1999). Estimating multiple classification latent class models. <em>Psychometrika, 64</em>, 187-212.
</p>
<p>Najera, P., Sorrel, M., &amp; Abad, P. (2019). Reconsidering Cutoff Points in the General Method of Empirical Q-Matrix Validation. <em>Educational and Psychological Measurement</em>.
</p>
<p>Sorrel, M. A., Abad, F. J., Olea, J., de la Torre, J., &amp; Barrada, J. R. (2017). Inferential Item-Fit Evaluation in Cognitive Diagnosis Modeling. <em>Applied Psychological Measurement, 41,</em> 614-631.
</p>
<p>Sorrel, M. A., de la Torre, J., Abad, F. J., &amp; Olea, J. (2017). Two-Step Likelihood Ratio Test for Item-Level Model Comparison in Cognitive Diagnosis Models. <em>Methodology, 13</em>, 39-47.
Xu, X., &amp; von Davier, M. (2008). Fitting the structured general diagnostic model to NAEP data. ETS research report, RR-08-27.
</p>


<h3>See Also</h3>

<p><span class="pkg">CDM</span> for estimating G-DINA model and a set of other CDMs;
<span class="pkg">ACTCD</span> and <span class="pkg">NPCD</span>
for nonparametric CDMs; <span class="pkg">dina</span> for DINA model in Bayesian framework
</p>

<hr>
<h2 id='GMSCDM'>Estimating multiple-strategy cognitive diagnosis models</h2><span id='topic+GMSCDM'></span>

<h3>Description</h3>

<p>An (experimental) function for calibrating the multiple-strategy CDMs for dichotomous response data (Ma &amp; Guo, 2019)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GMSCDM(
  dat,
  msQ,
  model = "ACDM",
  s = 1,
  att.prior = NULL,
  delta = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GMSCDM_+3A_dat">dat</code></td>
<td>
<p>A required binary item response matrix</p>
</td></tr>
<tr><td><code id="GMSCDM_+3A_msq">msQ</code></td>
<td>
<p>A multiple-strategy Q-matrix; the first column gives item numbers and the second column gives
the strategy number. See examples.</p>
</td></tr>
<tr><td><code id="GMSCDM_+3A_model">model</code></td>
<td>
<p>CDM used; can be <code>"DINA"</code>,<code>"DINO"</code>,<code>"ACDM"</code>,<code>"LLM"</code>, and <code>"RRUM"</code>, representing
the GMS-DINA, GMS-DINO, GMS-ACDM, GMS-LLM and GMS-RRUM in Ma &amp; Guo (2019), respectively. It can also be <code>"rDINA"</code> and <code>"rDINO"</code>,
representing restricted GMS-DINA and GMS-DINO models where delta_jm1 are equal for all strategies. Note that only a single model can be used
for the whole test.</p>
</td></tr>
<tr><td><code id="GMSCDM_+3A_s">s</code></td>
<td>
<p>strategy selection parameter. It is equal to 1 by default.</p>
</td></tr>
<tr><td><code id="GMSCDM_+3A_att.prior">att.prior</code></td>
<td>
<p>mixing proportion parameters.</p>
</td></tr>
<tr><td><code id="GMSCDM_+3A_delta">delta</code></td>
<td>
<p>delta parameters in list format.</p>
</td></tr>
<tr><td><code id="GMSCDM_+3A_control">control</code></td>
<td>
<p>a list of control arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>GMSCDM</code> with the following components:
</p>

<dl>
<dt>IRF</dt><dd><p>A matrix of success probabilities for each latent class on each item (IRF)</p>
</dd>
<dt>delta</dt><dd><p>A list of delta parameters</p>
</dd>
<dt>attribute</dt><dd><p>A list of estimated attribute profiles including EAP, MLE and MAP estimates.</p>
</dd>
<dt>testfit</dt><dd><p>A list of test fit statistics including deviance, number of parameters, AIC and BIC</p>
</dd>
<dt>sIRF</dt><dd><p>strategy-specific item response function</p>
</dd>
<dt>pjmc</dt><dd><p>Probability of adopting each strategy on each item for each latent class</p>
</dd>
<dt>sprv</dt><dd><p>Strategy pravelence</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Ma, W., &amp; Guo, W. (2019). Cognitive Diagnosis Models for Multiple Strategies. <em>British Journal of Mathematical and Statistical Psychology.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code> for MS-DINA model and single strategy CDMs,
and <code><a href="#topic+DTM">DTM</a></code> for diagnostic tree model for multiple strategies in polytomous response data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
##################
#
# data simulation
#
##################
set.seed(123)
msQ &lt;- matrix(
c(1,1,0,1,
1,2,1,0,
2,1,1,0,
3,1,0,1,
4,1,1,1,
5,1,1,1),6,4,byrow = T)
# J x L - 00,10,01,11
LC.prob &lt;- matrix(c(
0.2,0.7727,0.5889,0.8125,
0.1,0.9,0.1,0.9,
0.1,0.1,0.8,0.8,
0.2,0.5,0.4,0.7,
0.2,0.4,0.7,0.9),5,4,byrow=TRUE)
N &lt;- 10000
att &lt;- sample(1:4,N,replace=TRUE)
dat &lt;- 1*(t(LC.prob[,att])&gt;matrix(runif(N*5),N,5))


est &lt;- GMSCDM(dat,msQ)
# item response function
est$IRF
# strategy specific IRF
est$sIRF


################################
#
# Example 14 from GDINA function
#
################################
Q &lt;- matrix(c(1,1,1,1,0,
1,2,0,1,1,
2,1,1,0,0,
3,1,0,1,0,
4,1,0,0,1,
5,1,1,0,0,
5,2,0,0,1),ncol = 5,byrow = TRUE)
d &lt;- list(
  item1=c(0.2,0.7),
  item2=c(0.1,0.6),
  item3=c(0.2,0.6),
  item4=c(0.2,0.7),
  item5=c(0.1,0.8))

  set.seed(123)
sim &lt;- simGDINA(N=1000,Q = Q, delta.parm = d,
               model = c("MSDINA","MSDINA","DINA",
                         "DINA","DINA","MSDINA","MSDINA"))

# simulated data
dat &lt;- extract(sim,what = "dat")
# estimation
# MSDINA need to be specified for each strategy
est &lt;- GDINA(dat,Q,model = c("MSDINA","MSDINA","DINA",
                             "DINA","DINA","MSDINA","MSDINA"),
             control = list(conv.type = "neg2LL",conv.crit = .01))

# Approximate the MS-DINA model using GMS DINA model
est2 &lt;- GMSCDM(dat, Q, model = "rDINA", s = 10,
               control = list(conv.type = "neg2LL",conv.crit = .01))

## End(Not run)


</code></pre>

<hr>
<h2 id='ILCA'>Iterative latent-class analysis</h2><span id='topic+ILCA'></span>

<h3>Description</h3>

<p>This function implements an iterative latent class analysis (ILCA; Jiang, 2019) approach to estimating attributes for cognitive diagnosis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ILCA(dat, Q, seed.num = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ILCA_+3A_dat">dat</code></td>
<td>
<p>A required binary item response matrix.</p>
</td></tr>
<tr><td><code id="ILCA_+3A_q">Q</code></td>
<td>
<p>A required binary item and attribute association matrix.</p>
</td></tr>
<tr><td><code id="ILCA_+3A_seed.num">seed.num</code></td>
<td>
<p>seed number; Default = 5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated attribute profiles.
</p>


<h3>Author(s)</h3>

<p>Zhehan Jiang, The University of Alabama
</p>


<h3>References</h3>

<p>Jiang, Z. (2019). Using the iterative latent-class analysis approach to improve attribute accuracy in diagnostic classification models. <em>Behavior research methods</em>, 1-10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ILCA(sim10GDINA$simdat, sim10GDINA$simQ)

## End(Not run)
</code></pre>

<hr>
<h2 id='indlogLik'>Extract log-likelihood for each individual</h2><span id='topic+indlogLik'></span>

<h3>Description</h3>

<p>Extract individual log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indlogLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indlogLik_+3A_object">object</code></td>
<td>
<p>GDINA object</p>
</td></tr>
<tr><td><code id="indlogLik_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ

fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
iL &lt;- indlogLik(fit)
iL[1:6,]

## End(Not run)
</code></pre>

<hr>
<h2 id='indlogPost'>Extract log posterior for each individual</h2><span id='topic+indlogPost'></span>

<h3>Description</h3>

<p>Extract individual log posterior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indlogPost(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="indlogPost_+3A_object">object</code></td>
<td>
<p>GDINA object</p>
</td></tr>
<tr><td><code id="indlogPost_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
iP &lt;- indlogPost(fit)
iP[1:6,]

## End(Not run)
</code></pre>

<hr>
<h2 id='itemfit'>Item fit statistics</h2><span id='topic+itemfit'></span><span id='topic+extract.itemfit'></span><span id='topic+summary.itemfit'></span>

<h3>Description</h3>

<p>Calculate item fit statistics (Chen, de la Torre, &amp; Zhang, 2013) and draw heatmap plot for item pairs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itemfit(
  GDINA.obj,
  person.sim = "post",
  p.adjust.methods = "holm",
  cor.use = "pairwise.complete.obs",
  digits = 4,
  N.resampling = NULL,
  randomseed = 123456
)

## S3 method for class 'itemfit'
extract(object, what, ...)

## S3 method for class 'itemfit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="itemfit_+3A_gdina.obj">GDINA.obj</code></td>
<td>
<p>An estimated model object of class <code>GDINA</code></p>
</td></tr>
<tr><td><code id="itemfit_+3A_person.sim">person.sim</code></td>
<td>
<p>Simulate expected responses from the posterior or based on EAP, MAP and MLE estimates.</p>
</td></tr>
<tr><td><code id="itemfit_+3A_p.adjust.methods">p.adjust.methods</code></td>
<td>
<p>p-values for the proportion correct, transformed correlation, and log-odds ratio
can be adjusted for multiple comparisons at test and item level. This is conducted using <code>p.adjust</code> function in <span class="pkg">stats</span>,
and therefore all adjustment methods supported by <code>p.adjust</code> can be used, including <code>"holm"</code>,
<code>"hochberg"</code>, <code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code> and <code>"BY"</code>. See <code>p.adjust</code>
for more details. <code>"holm"</code> is the default.</p>
</td></tr>
<tr><td><code id="itemfit_+3A_cor.use">cor.use</code></td>
<td>
<p>how to deal with missing values when calculating correlations? This argument will be passed to <code>use</code> when calling <code>stats::cor</code>.</p>
</td></tr>
<tr><td><code id="itemfit_+3A_digits">digits</code></td>
<td>
<p>How many decimal places in each number? The default is 4.</p>
</td></tr>
<tr><td><code id="itemfit_+3A_n.resampling">N.resampling</code></td>
<td>
<p>the sample size of resampling. By default, it is the maximum of 1e+5 and ten times of current sample size.</p>
</td></tr>
<tr><td><code id="itemfit_+3A_randomseed">randomseed</code></td>
<td>
<p>random seed; This is used to make sure the results are replicable. The default random seed is 123456.</p>
</td></tr>
<tr><td><code id="itemfit_+3A_object">object</code></td>
<td>
<p>objects of class <code>itemfit</code> for various S3 methods</p>
</td></tr>
<tr><td><code id="itemfit_+3A_what">what</code></td>
<td>
<p>argument for S3 method <code>extract</code> indicating what to extract;
It can be <code>"p"</code> for proportion correct statistics,
<code>"r"</code> for transformed correlations, <code>logOR</code> for log odds ratios and
<code>"maxitemfit"</code> for maximum statistics for each item.</p>
</td></tr>
<tr><td><code id="itemfit_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>itemfit</code> consisting of several elements that can be extracted using
method <code>extract</code>. Components that can be extracted include:
</p>

<dl>
<dt>p</dt><dd><p>the proportion correct statistics, adjusted and unadjusted p values for each item</p>
</dd>
<dt>r</dt><dd><p>the transformed correlations, adjusted and unadjusted p values for each item pair</p>
</dd>
<dt>logOR</dt><dd><p>the log odds ratios, adjusted and unadjusted p values for each item pair</p>
</dd>
<dt>maxitemfit</dt><dd><p>the maximum proportion correct, transformed correlation, and log-odds ratio for each item with associated item-level adjusted p-values</p>
</dd>
</dl>



<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>extract(itemfit)</code>: extract various elements from <code>itemfit</code> objects
</p>
</li>
<li> <p><code>summary(itemfit)</code>: print summary information
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>References</h3>

<p>Chen, J., de la Torre, J., &amp; Zhang, Z. (2013). Relative and Absolute Fit Evaluation in Cognitive Diagnosis Modeling.
<em>Journal of Educational Measurement, 50</em>, 123-140.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ

mod1 &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
mod1
itmfit &lt;- itemfit(mod1)

# Print "test-level" item fit statistics
# p-values are adjusted for multiple comparisons
# for proportion correct, there are J comparisons
# for log odds ratio and transformed correlation,
# there are J*(J-1)/2 comparisons

itmfit

# The following gives maximum item fit statistics for
# each item with item level p-value adjustment
# For each item, there are J-1 comparisons for each of
# log odds ratio and transformed correlation
summary(itmfit)

# use extract to extract various components
extract(itmfit,"r")

mod2 &lt;- GDINA(dat,Q,model="DINA")
itmfit2 &lt;- itemfit(mod2)
#misfit heatmap
plot(itmfit2)
itmfit2

## End(Not run)
</code></pre>

<hr>
<h2 id='itemparm'>extract item parameters (deprecated)</h2><span id='topic+itemparm'></span><span id='topic+itemparm.GDINA'></span>

<h3>Description</h3>

<p>This function has been deprecated; use <code>coef</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itemparm(
  object,
  what = c("catprob", "gs", "delta", "rrum", "itemprob", "LCprob"),
  withSE = FALSE,
  SE.type = 2,
  digits = 4,
  ...
)

## S3 method for class 'GDINA'
itemparm(
  object,
  what = c("catprob", "gs", "delta", "rrum", "itemprob", "LCprob"),
  withSE = FALSE,
  SE.type = 2,
  digits = 4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="itemparm_+3A_object">object</code></td>
<td>
<p>estimated GDINA object returned from <code><a href="#topic+GDINA">GDINA</a></code></p>
</td></tr>
<tr><td><code id="itemparm_+3A_what">what</code></td>
<td>
<p>what to show.</p>
</td></tr>
<tr><td><code id="itemparm_+3A_withse">withSE</code></td>
<td>
<p>show standard errors or not?</p>
</td></tr>
<tr><td><code id="itemparm_+3A_se.type">SE.type</code></td>
<td>
<p>Type of standard errors.</p>
</td></tr>
<tr><td><code id="itemparm_+3A_digits">digits</code></td>
<td>
<p>how many decimal places for the ouput?</p>
</td></tr>
<tr><td><code id="itemparm_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>References</h3>

<p>Philipp, M., Strobl, C., de la Torre, J., &amp; Zeileis, A.(2017). On the estimation of standard errors in cognitive diagnosis models. <em>Journal of Educational and Behavioral Statistics, 43</em>, 88-115.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
# deprecated
itemparm(fit)
coef(fit)

## End(Not run)

</code></pre>

<hr>
<h2 id='LC2LG'>Transformation between latent classes and latent groups</h2><span id='topic+LC2LG'></span>

<h3>Description</h3>

<p>This function gives the equivalent latent classes which have the same category success
probabilities for each category or item.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LC2LG(Q, sequential = FALSE, att.str = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LC2LG_+3A_q">Q</code></td>
<td>
<p>A required <code class="reqn">J \times K</code> binary Q-matrix. J represents test
length and K represents the number of attributes of this test.
Entry 1 at row j and column k represents the <code class="reqn">k^{th}</code> attribute
is measured by item <code class="reqn">j</code>, and 0 means item <code class="reqn">j</code> does not
measure attribute <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code id="LC2LG_+3A_sequential">sequential</code></td>
<td>
<p>logical; whether the Q-matrix is a Qc-matrix for sequential models?</p>
</td></tr>
<tr><td><code id="LC2LG_+3A_att.str">att.str</code></td>
<td>
<p>attribute structure. See <code>GDINA</code> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An item or category by latent class matrix. In the G-DINA model,
if item j measures <code class="reqn">Kj</code> attributes, <code class="reqn">2^K</code> latent classes can
be combined into <code class="reqn">2^{Kj}</code> latent groups. This matrix gives
which latent group each of <code class="reqn">2^K</code> latent classes belongs to for each item.
</p>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attributepattern(3)

q &lt;- matrix(scan(text = "0 1 0 1 0 1 1 1 0"),ncol = 3)
q
LC2LG(Q = q)

</code></pre>

<hr>
<h2 id='MCmodel'>Multiple-choice models</h2><span id='topic+MCmodel'></span>

<h3>Description</h3>

<p>This function estimates the multiple-choice DINA model (de la Torre, 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCmodel(
  dat,
  Qc,
  model = "MCDINA",
  key = NULL,
  conv.crit = 0.001,
  maxitr = 2000,
  conv.type = "pr",
  SE = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCmodel_+3A_dat">dat</code></td>
<td>
<p>A required <code class="reqn">N \times J</code> data matrix of N examinees to J items. Values must be 1, 2,... representing nominal categories.
Missing values are currently not allowed.</p>
</td></tr>
<tr><td><code id="MCmodel_+3A_qc">Qc</code></td>
<td>
<p>A required category and attribute association matrix.
The first column gives the item number, which must
be numeric (i.e., 1,2,...) and match the number of column in the data.
The second column indicates the coded category of each item. The number in the second column must match
with the number in the data, but if a category is not coded, it should not be included in the Q-matrix.
Entry 1 indicates that the attribute is measured by the category, and 0 otherwise.
Note that the MC-DINA model assumes that the category with the largest number of 1s is the key and that the coded distractors should
allow to assign examinees uniquely.</p>
</td></tr>
<tr><td><code id="MCmodel_+3A_model">model</code></td>
<td>
<p><code>MCDINA</code> only currently. Other MC models may be incorporated.</p>
</td></tr>
<tr><td><code id="MCmodel_+3A_key">key</code></td>
<td>
<p>a numeric vector giving the key of each item. See <code>Examples</code>.
<code>NULL</code> by default indicating the coded category requiring the largest number of 1s is the key.</p>
</td></tr>
<tr><td><code id="MCmodel_+3A_conv.crit">conv.crit</code></td>
<td>
<p>The convergence criterion for max absolute change in <code>conv.type</code> for two consecutive iterations.</p>
</td></tr>
<tr><td><code id="MCmodel_+3A_maxitr">maxitr</code></td>
<td>
<p>The maximum iterations allowed.</p>
</td></tr>
<tr><td><code id="MCmodel_+3A_conv.type">conv.type</code></td>
<td>
<p>convergence criteria; Can be <code>pr</code> or <code>LL</code>,
indicating category response function, or -2 times log-likelihood,respectively.</p>
</td></tr>
<tr><td><code id="MCmodel_+3A_se">SE</code></td>
<td>
<p>logical; estimating standard error of item parameters? Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>MCmodel</code> with the following components:
</p>

<dl>
<dt>prob.parm</dt><dd><p>A list of success probabilities for each reduced latent class on each item (IRF)</p>
</dd>
<dt>prob.se</dt><dd><p>A list of standard errors of item parameters</p>
</dd>
<dt>attribute</dt><dd><p>A list of estimated attribute profiles including EAP, MLE and MAP estimates.</p>
</dd>
<dt>testfit</dt><dd><p>A list of test fit statistics including deviance, number of parameters, AIC and BIC</p>
</dd>
<dt>R</dt><dd><p>expected # of individuals in each latent group choosing each option</p>
</dd>
<dt>lik</dt><dd><p>posterior probability</p>
</dd>
<dt>itr</dt><dd><p>Total # of iterations</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>De La Torre, J. (2009). A cognitive diagnosis model for cognitively based multiple-choice options. <em>Applied Psychological Measurement, 33</em>, 163&ndash;183.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code> for G-DINA model
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 # check the format of the data
 # Entry 0 is not allowed
 head(sim10MCDINA$simdat)

 #---------------------------------
 # check the format of the Q-matrix
 #---------------------------------
 # Take item 1 as an example:
 # category 2 has a q-vector (1,0,0)
 # category 1 has a q-vector (0,1,0)
 # category 4 has a q-vector (1,1,0)
 # category 3 is not included in the Q-matrix because it is not coded
 # the order of the coded categories in the Q-matrix doesn't matter

 sim10MCDINA$simQ
  #     Item coded cat A1 A2 A3
  #        1         2  1  0  0
  #        1         1  0  1  0
  #        1         4  1  1  0
  #...
 est &lt;- MCmodel(sim10MCDINA$simdat,sim10MCDINA$simQ)
 est
 est$testfit

 #--------------------------------------
 # Distractors involving more attributes
 #--------------------------------------
 # some distractors may involve attributes that are not invovled by the key option
 # this is not allowed by the "original" MC-DINA (de la Torre, 2009) but is allowed
 # in the current implementation

 # Users need to specify the key for each item to appropriate handle such an issue
 # Note item 1 below: category 1 is the key (as indicated in the key argument below)
 # The distractor (category 4) involves an attribute not included by the key option

 Qc &lt;- matrix(c(1,	1,	1,	1,	0,
                1,	2,	0,	1,	0,
                1,	3,	1,	0,	0,
                1,	4,	1,	0,	1,
                2,	1,	1,	0,	0,
                2,	3,	1,	1,	0,
                2,	2,	1,	1,	1,
                3,	4,	1,	1,	1,
                3,	2,	1,	1,	0,
                3,	3,	0,	1,	1,
                4,	1,	0,	1,	1,
                4,	2,	0,	0,	1,
                5,	1,	1,	0,	0,
                6,	3,	0,	1,	0,
                7,	2,	0,	0,	1,
                8,	4,	1,	0,	0,
                9,	1,	0,	1,	0,
                10, 4,	0,	0,	1),ncol = 5,byrow = TRUE)

 est2 &lt;- MCmodel(sim10MCDINA2$simdat,Qc, key = c(1,2,4,1,1,3,2,4,1,4))
 est2
 est2$prob.parm
 est2$testfit
 est2$attribute

## End(Not run)
</code></pre>

<hr>
<h2 id='modelcomp'>Item-level model comparison using Wald, LR or LM tests</h2><span id='topic+modelcomp'></span><span id='topic+extract.modelcomp'></span><span id='topic+summary.modelcomp'></span>

<h3>Description</h3>

<p>This function evaluates whether the saturated G-DINA model can be replaced by reduced
CDMs without significant loss in model data fit for each item using the Wald test, likelihood ratio (LR) test or Lagrange multiplier (LM) test.
For Wald test, see de la Torre (2011), de la Torre and Lee (2013), Ma, Iaconangelo and de la Torre (2016) and Ma &amp; de la Torre (2018) for details.
For LR test and a two-step LR approximation procedure, see Sorrel, de la Torre, Abad, and Olea (2017), Ma (2017) and Ma &amp; de la Torre (2019).
For LM test, which is only applicable for DINA, DINO and ACDM, see Sorrel, Abad, Olea, de la Torre, and Barrada (2017).
This function also calculates the dissimilarity
between the reduced models and the G-DINA model, which can be viewed as a measure of effect size (Ma, Iaconangelo &amp; de la Torre, 2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelcomp(
  GDINA.obj = NULL,
  method = "Wald",
  items = "all",
  p.adjust.methods = "holm",
  models = c("DINA", "DINO", "ACDM", "LLM", "RRUM"),
  decision.args = list(rule = "largestp", alpha.level = 0.05, adjusted = FALSE),
  DS = FALSE,
  Wald.args = list(SE.type = 2, varcov = NULL),
  LR.args = list(LR.approx = FALSE),
  LM.args = list(reducedMDINA = NULL, reducedMDINO = NULL, reducedMACDM = NULL, SE.type =
    2)
)

## S3 method for class 'modelcomp'
extract(
  object,
  what = c("stats", "pvalues", "adj.pvalues", "df", "DS", "selected.model"),
  digits = 4,
  ...
)

## S3 method for class 'modelcomp'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelcomp_+3A_gdina.obj">GDINA.obj</code></td>
<td>
<p>An estimated model object of class <code>GDINA</code></p>
</td></tr>
<tr><td><code id="modelcomp_+3A_method">method</code></td>
<td>
<p>method for item level model comparison; can be <code>wald</code>, <code>LR</code> or <code>LM</code>.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_items">items</code></td>
<td>
<p>a vector of items to specify the items for model comparsion</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_p.adjust.methods">p.adjust.methods</code></td>
<td>
<p>adjusted p-values for multiple hypothesis tests. This is conducted using <code>p.adjust</code> function in <span class="pkg">stats</span>,
and therefore all adjustment methods supported by <code>p.adjust</code> can be used, including <code>"holm"</code>,
<code>"hochberg"</code>, <code>"hommel"</code>, <code>"bonferroni"</code>, <code>"BH"</code> and <code>"BY"</code>. See <code>p.adjust</code>
for more details. <code>"holm"</code> is the default, indicating the Holm method.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_models">models</code></td>
<td>
<p>a vector specifying which reduced CDMs are possible reduced CDMs for each
item. The default is &quot;DINA&quot;,&quot;DINO&quot;,&quot;ACDM&quot;,&quot;LLM&quot;,and &quot;RRUM&quot;.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_decision.args">decision.args</code></td>
<td>
<p>a list of options for determining the most appropriate models including (1) <code>rule</code> can be
either <code>"simpler"</code> or <code>"largestp"</code>. See details;
(2) <code>alpha.level</code> for the nominal level of decision; and (3) <code>adjusted</code> can be either <code>TRUE</code> or <code>FALSE</code>
indicating whether the decision is based on p value (<code>adjusted = FALSE</code>) or adjusted p values.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_ds">DS</code></td>
<td>
<p>whether dissimilarity index should be calculated? <code>FALSE</code> is the default.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_wald.args">Wald.args</code></td>
<td>
<p>a list of options for Wald test including (1) <code>SE.type</code> giving the type of
covariance matrix for the Wald test; by default, it uses outer product of gradient based on incomplete information matrix;
(2) <code>varcov</code> for user specified variance-covariance matrix. If supplied, it must
be a list, giving the variance covariance matrix of success probability for each item or category.
The default is <code>NULL</code>, in which case, the estimated variance-covariance matrix from the GDINA function
is used.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_lr.args">LR.args</code></td>
<td>
<p>a list of options for LR test including for now only <code>LR.approx</code>, which is either <code>TRUE</code> or <code>FALSE</code>,
indicating whether a two-step LR approximation is implemented or not.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_lm.args">LM.args</code></td>
<td>
<p>a list of options for LM test including <code>reducedMDINA</code>, <code>reducedMDINO</code>, and <code>reducedMACDM</code> for
DINA, DINO and ACDM estimates from the <code>GDINA</code> function; <code>SE.type</code> specifies the type of covariance matrix.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_object">object</code></td>
<td>
<p>object of class <code>modelcomp</code> for various S3 methods</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_what">what</code></td>
<td>
<p>argument for S3 method <code>extract</code> indicating what to extract;
It can be <code>"wald"</code> for wald statistics, <code>"wald.p"</code> for associated p-values,
<code>"df"</code> for degrees of freedom,
and <code>"DS"</code> for dissimilarity between G-DINA and other CDMs.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_digits">digits</code></td>
<td>
<p>How many decimal places in each number? The default is 4.</p>
</td></tr>
<tr><td><code id="modelcomp_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After the test statistics for each reduced CDM were calculated for each item, the
reduced models with p values less than the pre-specified alpha level were rejected.
If all reduced models were rejected for an item, the G-DINA model was used as the best model;
if at least one reduced model was retained, two diferent rules can be implemented for selecting
the best model specified in argument <code>decision.args</code>:
</p>
<p>(1) when <code>rule="simpler"</code>,
</p>
<p>If (a) the DINA or DINO model
was one of the retained models, then the DINA or DINO model with the larger p
value was selected as the best model; but if (b) both DINA and DINO were rejected, the reduced
model with the largest p value was selected as the best model for this item. Note that
when the p-values of several reduced models were greater than 0.05, the DINA and DINO models were
preferred over the A-CDM, LLM, and R-RUM because of their simplicity.
</p>
<p>(2) When <code>rule="largestp"</code> (default),
</p>
<p>The reduced model with the largest p-values is selected as the most appropriate model.
</p>


<h3>Value</h3>

<p>an object of class <code>modelcomp</code>. Elements that can be
extracted using <code>extract</code> method include
</p>

<dl>
<dt>stats</dt><dd><p>Wald or LR statistics</p>
</dd>
<dt>pvalues</dt><dd><p>p-values associated with the test statistics</p>
</dd>
<dt>adj.pvalues</dt><dd><p>adjusted p-values</p>
</dd>
<dt>df</dt><dd><p>degrees of freedom</p>
</dd>
<dt>DS</dt><dd><p>dissimilarity between G-DINA and other CDMs</p>
</dd>
</dl>



<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>extract(modelcomp)</code>: extract various elements from <code>modelcomp</code> objects
</p>
</li>
<li> <p><code>summary(modelcomp)</code>: print summary information
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Miguel A. Sorrel, Universidad Autonoma de Madrid <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>References</h3>

<p>de la Torre, J., &amp; Lee, Y. S. (2013). Evaluating the wald test for item-level comparison of
saturated and reduced models in cognitive diagnosis. <em>Journal of Educational Measurement, 50</em>, 355-373.
</p>
<p>Ma, W., Iaconangelo, C., &amp; de la Torre, J. (2016). Model similarity, model selection and attribute classification.
<em>Applied Psychological Measurement, 40</em>, 200-217.
</p>
<p>Ma, W. (2017). <em>A Sequential Cognitive Diagnosis Model for Graded Response: Model Development, Q-Matrix Validation,and Model Comparison. Unpublished doctoral dissertation.</em> New Brunswick, NJ: Rutgers University.
</p>
<p>Ma, W., &amp; de la Torre, J. (2019). Category-Level Model Selection for the Sequential G-DINA Model. <em>Journal of Educational and Behavioral Statistics</em>. 44, 61-82.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Sorrel, M. A., Abad, F. J., Olea, J., de la Torre, J., &amp; Barrada, J. R. (2017). Inferential Item-Fit Evaluation in Cognitive Diagnosis Modeling. <em>Applied Psychological Measurement, 41,</em> 614-631.
</p>
<p>Sorrel, M. A., de la Torre, J., Abad, F. J., &amp; Olea, J. (2017). Two-Step Likelihood Ratio Test for Item-Level Model Comparison in Cognitive Diagnosis Models. <em>Methodology, 13</em>, 39-47.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code>, <code><a href="#topic+autoGDINA">autoGDINA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
# --- GDINA model ---#
fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
fit

###################
#
# Wald test
#
###################

w &lt;- modelcomp(fit)
w
# wald statistics
extract(w,"stats")
#p values
extract(w,"pvalues")
# selected models
extract(w,"selected.model")
##########################
#
# LR and Two-step LR test
#
##########################

lr &lt;- modelcomp(fit,method = "LR")
lr
TwostepLR &lt;- modelcomp(fit,items =c(6:10),method = "LR",LR.args = list(LR.approx = TRUE))
TwostepLR

##########################
#
# LM test
#
##########################

dina &lt;- GDINA(dat = dat, Q = Q, model = "DINA")
dino &lt;- GDINA(dat = dat, Q = Q, model = "DINO")
acdm &lt;- GDINA(dat = dat, Q = Q, model = "ACDM")
lm &lt;- modelcomp(method = "LM",LM.args=list(reducedMDINA = dina,
reducedMDINO = dino, reducedMACDM  = acdm))
lm



## End(Not run)
</code></pre>

<hr>
<h2 id='modelfit'>Model fit statistics</h2><span id='topic+modelfit'></span>

<h3>Description</h3>

<p>Calculate various absolute model-data fit statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelfit(GDINA.obj, CI = 0.9, ItemOnly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelfit_+3A_gdina.obj">GDINA.obj</code></td>
<td>
<p>An estimated model object of class <code>GDINA</code></p>
</td></tr>
<tr><td><code id="modelfit_+3A_ci">CI</code></td>
<td>
<p>numeric value from 0 to 1 indicating the range of the confidence interval for RMSEA. Default returns the 90% interval.</p>
</td></tr>
<tr><td><code id="modelfit_+3A_itemonly">ItemOnly</code></td>
<td>
<p>should joint attribute distribution parameters be considered? Default = FALSE. See Ma (2019).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Various model-data fit statistics including M2 statistic for G-DINA model with dichotmous responses (Liu, Tian, &amp; Xin, 2016; Hansen, Cai, Monroe, &amp; Li, 2016) and for sequential G-DINA model with graded responses (Ma, 2020).
It also calculates SRMSR and RMSEA2.
</p>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Hansen, M., Cai, L.,  Monroe, S., &amp; Li, Z. (2016). Limited-information goodness-of-fit testing of diagnostic classification item response models. <em>British Journal of Mathematical and Statistical Psychology. 69,</em> 225&ndash;252.
</p>
<p>Liu, Y., Tian, W., &amp; Xin, T. (2016). An Application of M2 Statistic to Evaluate the Fit of Cognitive Diagnostic Models. <em>Journal of Educational and Behavioral Statistics, 41</em>, 3-26.
</p>
<p>Ma, W. (2020). Evaluating the fit of sequential G-DINA model using limited-information measures. <em>Applied Psychological Measurement, 44</em>, 167-181.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Maydeu-Olivares, A. (2013). Goodness-of-Fit Assessment of Item Response Theory Models. <em>Measurement, 11</em>, 71-101.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
mod1 &lt;- GDINA(dat = dat, Q = Q, model = "DINA")
modelfit(mod1)

## End(Not run)
</code></pre>

<hr>
<h2 id='monocheck'>This function checks if monotonicity is violated</h2><span id='topic+monocheck'></span>

<h3>Description</h3>

<p>If mastering an additional attribute lead to a lower probabilities of success,
the monotonicity is violated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monocheck(object, strict = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monocheck_+3A_object">object</code></td>
<td>
<p>object of class <code><a href="#topic+GDINA">GDINA</a></code></p>
</td></tr>
<tr><td><code id="monocheck_+3A_strict">strict</code></td>
<td>
<p>whether a strict monotonicity is checked?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical vector for each item or category indicating whether
the monotonicity is violated (<code>TRUE</code>) or not (<code>FALSE</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ


mod1 &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
check &lt;- monocheck(mod1)
check
mod2 &lt;- GDINA(dat = dat, Q = Q, model = "GDINA",mono.constraint = check)
check2 &lt;- monocheck(mod2)
check2

## End(Not run)
</code></pre>

<hr>
<h2 id='npar'>Calculate the number of parameters</h2><span id='topic+npar'></span>

<h3>Description</h3>

<p>Calculate the number of parameters for GDINA estimates.
Returned the total number of parameters, the number of item parameters and
the number parameters of joint attribute distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npar(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npar_+3A_object">object</code></td>
<td>
<p>GDINA object</p>
</td></tr>
<tr><td><code id="npar_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ

fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
npar(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='personparm'>calculate person (incidental) parameters</h2><span id='topic+personparm'></span>

<h3>Description</h3>

<p>Function to calculate various person attribute parameters, including <code>"EAP"</code>,
<code>"MAP"</code>, and <code>"MLE"</code>, for EAP, MAP and MLE estimates of
attribute patterns (see Huebner &amp; Wang, 2011), <code>"mp"</code> for marginal mastery probabilities, and <code>"HO"</code>
for higher-order ability estimates if a higher-order model is fitted.
See <code><a href="#topic+GDINA">GDINA</a></code> for examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>personparm(object, what = c("EAP", "MAP", "MLE", "mp", "HO"), digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="personparm_+3A_object">object</code></td>
<td>
<p>estimated GDINA object returned from <code><a href="#topic+GDINA">GDINA</a></code></p>
</td></tr>
<tr><td><code id="personparm_+3A_what">what</code></td>
<td>
<p>what to extract; It can be <code>"EAP"</code>,
<code>"MAP"</code>, and <code>"MLE"</code>, for EAP, MAP and MLE estimates of
attribute patterns, and <code>"mp"</code> for marginal mastery probabilities, and <code>"HO"</code>
for higher-order ability estimates if a higher-order model is fitted.</p>
</td></tr>
<tr><td><code id="personparm_+3A_digits">digits</code></td>
<td>
<p>number of decimal places.</p>
</td></tr>
<tr><td><code id="personparm_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>References</h3>

<p>Huebner, A., &amp; Wang, C. (2011). A note on comparing examinee classification methods for cognitive diagnosis models. <em>Educational and Psychological Measurement, 71</em>, 407-419.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
# EAP
head(personparm(fit))
# MAP
head(personparm(fit, what = "MAP"))

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.GDINA'>Create plots for GDINA estimates</h2><span id='topic+plot.GDINA'></span>

<h3>Description</h3>

<p>Create various plots for GDINA estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'GDINA'
plot(
  x,
  what = "IRF",
  item = "all",
  withSE = FALSE,
  SE.type = 2,
  person = 1,
  att.names = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.GDINA_+3A_x">x</code></td>
<td>
<p>model object of class <code><a href="#topic+GDINA">GDINA</a></code></p>
</td></tr>
<tr><td><code id="plot.GDINA_+3A_what">what</code></td>
<td>
<p>type of plot. Can be <code>"IRF"</code> for item/category response function plot,
or <code>"mp"</code> for mastery probabilities for individuals.</p>
</td></tr>
<tr><td><code id="plot.GDINA_+3A_item">item</code></td>
<td>
<p>A scalar or vector specifying the item(s) for IRF plots.</p>
</td></tr>
<tr><td><code id="plot.GDINA_+3A_withse">withSE</code></td>
<td>
<p>logical; Add error bar (estimate - SE, estimate + SE) to the IRF plots?</p>
</td></tr>
<tr><td><code id="plot.GDINA_+3A_se.type">SE.type</code></td>
<td>
<p>How is SE estimated. By default, it's based on OPG using incomplete information.</p>
</td></tr>
<tr><td><code id="plot.GDINA_+3A_person">person</code></td>
<td>
<p>A scalar or vector specifying the number of individuals for mastery plots.</p>
</td></tr>
<tr><td><code id="plot.GDINA_+3A_att.names">att.names</code></td>
<td>
<p>Optional; a vector for attribute names.</p>
</td></tr>
<tr><td><code id="plot.GDINA_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code>, <code><a href="#topic+autoGDINA">autoGDINA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
mod1 &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
#plot item response functions for item 10
plot(mod1, item = 10)
plot(mod1, what = "IRF", item = 10,withSE = TRUE)

# plot mastery probabilities for individuals 4 and 10
plot(mod1, what = "mp", person = c(4,10))
plot(mod1, what = "mp", person = c(4,10,15),
att.names = c("addition","subtraction","multiplication"))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.itemfit'>Item fit plots</h2><span id='topic+plot.itemfit'></span>

<h3>Description</h3>

<p>Create plots of bivariate heatmap for item fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'itemfit'
plot(x, type = "all", adjusted = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.itemfit_+3A_x">x</code></td>
<td>
<p>model object of class <code>itemfit</code></p>
</td></tr>
<tr><td><code id="plot.itemfit_+3A_type">type</code></td>
<td>
<p>type of heatmap plot</p>
</td></tr>
<tr><td><code id="plot.itemfit_+3A_adjusted">adjusted</code></td>
<td>
<p>logical; plot adjusted or unadjusted p-values?</p>
</td></tr>
<tr><td><code id="plot.itemfit_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code>, <code><a href="#topic+itemfit">itemfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ

fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
ift &lt;- itemfit(fit)
# plot the adjusted p values for log odds or transformed correlation
plot(ift)
# plot unadjusted p values for log odds
plot(ift,adjusted = FALSE, type = "logOR")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.Qval'>Mesa plot for Q-matrix validation</h2><span id='topic+plot.Qval'></span>

<h3>Description</h3>

<p>The mesa plot was first proposed by de la Torre and Ma (2016) for graphically illustrating the best q-vector(s) for each item.
The q-vector on the edge of the mesa is likely to be the best q-vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Qval'
plot(
  x,
  item,
  type = "best",
  no.qvector = 10,
  data.label = TRUE,
  eps = "auto",
  original.q.label = FALSE,
  auto.ylim = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.Qval_+3A_x">x</code></td>
<td>
<p>model object of class <code>Qvalidation</code></p>
</td></tr>
<tr><td><code id="plot.Qval_+3A_item">item</code></td>
<td>
<p>a vector specifying which item(s) the plots are drawn for</p>
</td></tr>
<tr><td><code id="plot.Qval_+3A_type">type</code></td>
<td>
<p>types of the plot. It can be <code>"best"</code> or <code>"all"</code>. If <code>"best"</code>,
for all q-vectors requiring the same number of attributes, only the one with the largest PVAF
is plotted, which means <code class="reqn">K_j</code> q-vectors are plotted; If <code>"all"</code>, all q-vectors
will be plotted.</p>
</td></tr>
<tr><td><code id="plot.Qval_+3A_no.qvector">no.qvector</code></td>
<td>
<p>the number of q vectors that need to be plotted when <code>type="all"</code>. The default is 10,
which means the 10 q vectors with the largest PVAFs are plotted.</p>
</td></tr>
<tr><td><code id="plot.Qval_+3A_data.label">data.label</code></td>
<td>
<p>logical; To show data label or not?</p>
</td></tr>
<tr><td><code id="plot.Qval_+3A_eps">eps</code></td>
<td>
<p>the cutoff for PVAF. If not <code>NULL</code>, it must be a value between 0 and 1. A horizontal line will be drawn accordingly.</p>
</td></tr>
<tr><td><code id="plot.Qval_+3A_original.q.label">original.q.label</code></td>
<td>
<p>logical; print the label showing the original q-vector or not?</p>
</td></tr>
<tr><td><code id="plot.Qval_+3A_auto.ylim">auto.ylim</code></td>
<td>
<p>logical; create y range automatically or not?</p>
</td></tr>
<tr><td><code id="plot.Qval_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>plot</code> function</p>
</td></tr>
</table>


<h3>References</h3>

<p>de la Torre, J., &amp; Ma, W. (2016, August). Cognitive diagnosis modeling: A general framework approach and its implementation in R. A Short Course at the Fourth Conference on Statistical Methods in Psychometrics, Columbia University, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Qval">Qval</a></code>, <code><a href="#topic+autoGDINA">autoGDINA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
Q[1,] &lt;- c(0,1,0)
mod1 &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
out &lt;- Qval(mod1,eps = 0.9)
item &lt;- c(1,2,10)
plot(out,item=item,data.label=FALSE,type="all")
plot(out,item=10,type="best",eps=0.95)
plot(out,item=10,type="all",no.qvector=6)

## End(Not run)

</code></pre>

<hr>
<h2 id='Qval'>Q-matrix validation</h2><span id='topic+Qval'></span><span id='topic+extract.Qval'></span><span id='topic+summary.Qval'></span>

<h3>Description</h3>

<p>Q-matrix validation for the (sequential) G-DINA model based on PVAF (de la Torre &amp; Chiu, 2016; Najera, Sorrel, &amp; Abad, 2019; Najera et al., 2020), stepwise Wald test (Ma &amp; de la Torre, 2020) or mesa plot (de la Torre &amp; Ma, 2016).
All these methods are suitable for dichotomous and ordinal response data. If too many modifications are suggested based on the default PVAF method, you are suggested to try the stepwise Wald test method, iterative procedures or predicted cutoffs.
You should always check the mesa plots for further examination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Qval(
  GDINA.obj,
  method = "PVAF",
  iter = "none",
  eps = 0.95,
  digits = 4,
  wald.args = list(),
  iter.args = list(empty.att = FALSE, max.iter = 150, verbose = FALSE)
)

## S3 method for class 'Qval'
extract(object, what = c("sug.Q", "varsigma", "PVAF", "eps", "Q"), ...)

## S3 method for class 'Qval'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Qval_+3A_gdina.obj">GDINA.obj</code></td>
<td>
<p>an estimated model object of class <code>GDINA</code></p>
</td></tr>
<tr><td><code id="Qval_+3A_method">method</code></td>
<td>
<p>which Q-matrix validation method is used? Can be either <code>"PVAF"</code> or <code>"wald"</code>.</p>
</td></tr>
<tr><td><code id="Qval_+3A_iter">iter</code></td>
<td>
<p>implement the method iteratively? Can be <code>"none"</code> for non-iterative validation (by default), <code>"test"</code>, <code>"test.att"</code>, or <code>"item"</code> (Najera et al., 2020).</p>
</td></tr>
<tr><td><code id="Qval_+3A_eps">eps</code></td>
<td>
<p>cutoff value for PVAF from 0 to 1. Default = 0.95. Note that it can also be -1, indicating the predicted cutoff based on Najera, Sorrel, and Abad (2019).</p>
</td></tr>
<tr><td><code id="Qval_+3A_digits">digits</code></td>
<td>
<p>how many decimal places in each number? The default is 4.</p>
</td></tr>
<tr><td><code id="Qval_+3A_wald.args">wald.args</code></td>
<td>
<p>a list of arguments for the stepwise Wald test method.
</p>

<dl>
<dt>SE.type</dt><dd><p>type of covariance matrix for the Wald test</p>
</dd>
<dt>alpha.level</dt><dd><p>alpha level for the wald test</p>
</dd>
<dt>GDI</dt><dd><p>it can be 0, 1 or 2; 0 means GDI is not used to choose the attribute -
when more than one attributes are significant, the one with the largest p-value will be selected;
GDI=1 means the attribute with the largest GDI will be selected; GDI=2 means the q-vector with
the largest GDI will be selected.</p>
</dd>
<dt>verbose</dt><dd><p>print detailed information or not?</p>
</dd>
<dt>stepwise</dt><dd><p><code>TRUE</code> for stepwise approach and <code>FALSE</code> for forward approach</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="Qval_+3A_iter.args">iter.args</code></td>
<td>
<p>a list of arguments for the iterative implementation.
</p>

<dl>
<dt>empty.att</dt><dd><p>can a Q-matrix with an empty attribute (i.e., measured by no items) be provided? Default is FALSE</p>
</dd>
<dt>max.iter</dt><dd><p>maximum number of iterations. Default is 150</p>
</dd>
<dt>verbose</dt><dd><p>print information after each iteration? Default is FALSE</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="Qval_+3A_object">object</code></td>
<td>
<p><code>Qval</code> objects for S3 methods</p>
</td></tr>
<tr><td><code id="Qval_+3A_what">what</code></td>
<td>
<p>argument for S3 method <code>extract</code> indicating what to extract;
It can be <code>"sug.Q"</code> for suggested Q-matrix,
<code>"Q"</code> for original Q-matrix, <code>"varsigma"</code> for varsigma index,
and <code>"PVAF"</code> for PVAF.</p>
</td></tr>
<tr><td><code id="Qval_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>Qval</code>. Elements that can be
extracted using <code>extract</code> method include:
</p>

<dl>
<dt>sug.Q</dt><dd><p>suggested Q-matrix</p>
</dd>
<dt>Q</dt><dd><p>original Q-matrix</p>
</dd>
<dt>varsigma</dt><dd><p>varsigma index</p>
</dd>
<dt>PVAF</dt><dd><p>PVAF</p>
</dd>
</dl>



<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>extract(Qval)</code>: extract various elements from <code>Qval</code> objects
</p>
</li>
<li> <p><code>summary(Qval)</code>: print summary information
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>, <br /> Miguel A. Sorrel, Universidad Autnoma de Madrid, <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>References</h3>

<p>de la Torre, J. &amp; Chiu, C-Y. (2016). A General Method of Empirical Q-matrix Validation. <em>Psychometrika, 81</em>, 253-273.
</p>
<p>de la Torre, J., &amp; Ma, W. (2016, August). Cognitive diagnosis modeling: A general framework approach and its implementation in R. A Short Course at the Fourth Conference on Statistical Methods in Psychometrics, Columbia University, New York.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020). An empirical Q-matrix validation method for the sequential G-DINA model. <em>British Journal of Mathematical and Statistical Psychology, 73</em>, 142-163.
</p>
<p>Najera, P., Sorrel, M. A., &amp; Abad, F.J. (2019). Reconsidering cutoff points in the general method of empirical Q-matrix validation. <em>Educational and Psychological Measurement, 79</em>, 727-753.
</p>
<p>Najera, P., Sorrel, M. A., de la Torre, J., &amp; Abad, F. J. (2020). Improving robustness in Q-matrix validation using an iterative and dynamic procedure. <em>Applied Psychological Measurement</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GDINA">GDINA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
################################
#
# Binary response
#
################################
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
Q[10,] &lt;- c(0,1,0)

# Fit the G-DINA model
mod1 &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")

# Q-validation using de la Torre and Chiu's method
pvaf &lt;- Qval(mod1,method = "PVAF",eps = 0.95)
pvaf
extract(pvaf,what = "PVAF")
#See also:
extract(pvaf,what = "varsigma")
extract(pvaf,what = "sug.Q")

# Draw mesa plots using the function plot

plot(pvaf,item=10)

#The stepwise Wald test
stepwise &lt;- Qval(mod1,method = "wald")
stepwise
extract(stepwise,what = "PVAF")
#See also:
extract(stepwise,what = "varsigma")
extract(stepwise,what = "sug.Q")

#Set eps = -1 to determine the cutoff empirically
pvaf2 &lt;- Qval(mod1,method = "PVAF",eps = -1)
pvaf2

#Iterative procedure (test-attribute level)
pvaf3 &lt;- Qval(mod1, method = "PVAF", eps = -1,
              iter = "test.att", iter.args = list(verbose = 1))
pvaf3

################################
#
# Ordinal response
#
################################
seq.est &lt;- GDINA(sim20seqGDINA$simdat,sim20seqGDINA$simQ, sequential = TRUE)
stepwise &lt;- Qval(seq.est, method = "wald")

## End(Not run)
</code></pre>

<hr>
<h2 id='rowMatch'>Count the frequency of a row vector in a data frame</h2><span id='topic+rowMatch'></span>

<h3>Description</h3>

<p>Count the frequency of a row vector in a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rowMatch(df, vec = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rowMatch_+3A_df">df</code></td>
<td>
<p>a data frame or matrix</p>
</td></tr>
<tr><td><code id="rowMatch_+3A_vec">vec</code></td>
<td>
<p>the vector for matching</p>
</td></tr>
</table>


<h3>Value</h3>

<p>count the number of vector vec in the data frame
</p>
<p>row.no row numbers of the vector vec in the data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- data.frame(V1=c(1L,2L),V2=LETTERS[1:3],V3=rep(1,12))
rowMatch(df,c(2,"B",1))



</code></pre>

<hr>
<h2 id='score'>Score function</h2><span id='topic+score'></span>

<h3>Description</h3>

<p>Calculate score function for each dichotomous item or each nonzero category for polytomous items
Only applicable to saturated model ofr joint attribute distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score(object, parm = "delta")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="score_+3A_object">object</code></td>
<td>
<p>an object of class GDINA</p>
</td></tr>
<tr><td><code id="score_+3A_parm">parm</code></td>
<td>
<p>Either <code>delta</code> or <code>prob</code> indicating score function for delta parameters and
success probabily parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list where elements give the score functions for each item or category
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- sim10GDINA$simdat
Q &lt;- sim10GDINA$simQ
fit &lt;- GDINA(dat = dat, Q = Q, model = "GDINA")
score(fit)

## End(Not run)


</code></pre>

<hr>
<h2 id='sim10GDINA'>Simulated data (10 items, G-DINA model)</h2><span id='topic+sim10GDINA'></span>

<h3>Description</h3>

<p>Simulated data, Q-matrix and item parameters for a 10-item test with 3 attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim10GDINA
</code></pre>


<h3>Format</h3>

<p>A list with components:
</p>

<dl>
<dt><code>simdat</code></dt><dd><p>simulated responses of 1000 examinees</p>
</dd>
<dt><code>simQ</code></dt><dd><p>artificial Q-matrix</p>
</dd>
<dt><code>simItempar</code></dt><dd><p>artificial item parameters (probability of success for each latent group)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>

<hr>
<h2 id='sim10MCDINA'>Simulated data (10 items, MC-DINA model)</h2><span id='topic+sim10MCDINA'></span>

<h3>Description</h3>

<p>Simulated data, Q-matrix and item parameters for a 10-item test measuring 3 attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim10MCDINA
</code></pre>


<h3>Format</h3>

<p>A list with components:
</p>

<dl>
<dt><code>simdat</code></dt><dd><p>simulated responses of 3000 examinees</p>
</dd>
<dt><code>simQ</code></dt><dd><p>artificial Q-matrix</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>

<hr>
<h2 id='sim10MCDINA2'>Simulated data (10 items, MC-DINA model)</h2><span id='topic+sim10MCDINA2'></span>

<h3>Description</h3>

<p>Simulated data, Q-matrix and item parameters for a 10-item test measuring 5 attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim10MCDINA2
</code></pre>


<h3>Format</h3>

<p>A list with components:
</p>

<dl>
<dt><code>simdat</code></dt><dd><p>simulated responses of 3000 examinees</p>
</dd>
<dt><code>simQ</code></dt><dd><p>artificial Q-matrix</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>

<hr>
<h2 id='sim20seqGDINA'>Simulated data (20 items, sequential G-DINA model)</h2><span id='topic+sim20seqGDINA'></span>

<h3>Description</h3>

<p>Simulated data, Qc-matrix and item parameters for a 20-item test measuring 5 attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim20seqGDINA
</code></pre>


<h3>Format</h3>

<p>A list with components:
</p>

<dl>
<dt><code>simdat</code></dt><dd><p>simulated polytomous responses of 2000 examinees</p>
</dd>
<dt><code>simQ</code></dt><dd><p>artificial Qc-matrix</p>
</dd>
<dt><code>simItempar</code></dt><dd><p>artificial item parameters (category level probability of success for each latent group)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>

<hr>
<h2 id='sim21seqDINA'>Simulated data (21 items, sequential DINA model)</h2><span id='topic+sim21seqDINA'></span>

<h3>Description</h3>

<p>Simulated data, and Qc-matrix for a 21-item test measuring 5 attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim21seqDINA
</code></pre>


<h3>Format</h3>

<p>A list with components:
</p>

<dl>
<dt><code>simdat</code></dt><dd><p>simulated responses of 2000 examinees</p>
</dd>
<dt><code>simQ</code></dt><dd><p>artificial Qc-matrix</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>

<hr>
<h2 id='sim30DINA'>Simulated data (30 items, DINA model)</h2><span id='topic+sim30DINA'></span>

<h3>Description</h3>

<p>Simulated data, Q-matrix and item parameters for a 30-item test measuring 5 attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim30DINA
</code></pre>


<h3>Format</h3>

<p>A list with components:
</p>

<dl>
<dt><code>simdat</code></dt><dd><p>simulated responses of 1000 examinees</p>
</dd>
<dt><code>simQ</code></dt><dd><p>artificial Q-matrix</p>
</dd>
<dt><code>simItempar</code></dt><dd><p>artificial item parameters (probability of success for each latent group)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>

<hr>
<h2 id='sim30GDINA'>Simulated data (30 items, G-DINA model)</h2><span id='topic+sim30GDINA'></span>

<h3>Description</h3>

<p>Simulated data, Q-matrix and item parameters for a 30-item test measuring 5 attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim30GDINA
</code></pre>


<h3>Format</h3>

<p>A list with components:
</p>

<dl>
<dt><code>simdat</code></dt><dd><p>simulated responses of 1000 examinees</p>
</dd>
<dt><code>simQ</code></dt><dd><p>artificial <code class="reqn">30 \times 5</code> Q-matrix</p>
</dd>
<dt><code>simItempar</code></dt><dd><p>artificial item parameters(probability of success for each latent group)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>

<hr>
<h2 id='sim30pGDINA'>Simulated data (30 items, polytomous G-DINA model)</h2><span id='topic+sim30pGDINA'></span>

<h3>Description</h3>

<p>Simulated data, Q-matrix and item parameters for a 30-item test measuring 5 attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim30pGDINA
</code></pre>


<h3>Format</h3>

<p>A list with components:
</p>

<dl>
<dt><code>simdat</code></dt><dd><p>simulated responses of 3000 examinees</p>
</dd>
<dt><code>simQ</code></dt><dd><p>artificial Q-matrix</p>
</dd>
<dt><code>simItempar</code></dt><dd><p>artificial item parameters(probability of success for each latent group)</p>
</dd>
</dl>


<hr>
<h2 id='simDTM'>Simulating data for diagnostic tree model</h2><span id='topic+simDTM'></span>

<h3>Description</h3>

<p>Data generation for diagnostic tree model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDTM(N, Qc, gs.parm, Tmatrix, red.delta = NULL, att.gr = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simDTM_+3A_n">N</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="simDTM_+3A_qc">Qc</code></td>
<td>
<p>Association matrix between attributes (column) and PSEUDO items (row); The first column is item number and
the second column is the pseudo item number for each item. If a pseudo item has more than one nonzero categories,
more than one rows are needed.</p>
</td></tr>
<tr><td><code id="simDTM_+3A_gs.parm">gs.parm</code></td>
<td>
<p>the same as the gs.parm in simGDINA function in the GDINA package. It is a list with the same number of
elements as the number of rows in the Qc matrix</p>
</td></tr>
<tr><td><code id="simDTM_+3A_tmatrix">Tmatrix</code></td>
<td>
<p>mapping matrix showing the relation between the OBSERVED responses (rows) and the PSEDUO items (columns);
The first column gives the observed responses.</p>
</td></tr>
<tr><td><code id="simDTM_+3A_red.delta">red.delta</code></td>
<td>
<p>reduced delta parameters using logit link function</p>
</td></tr>
<tr><td><code id="simDTM_+3A_att.gr">att.gr</code></td>
<td>
<p>attribute group indicator</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
K=5
g=0.2
item.no &lt;- rep(1:6,each=4)
# the first node has three response categories: 0, 1 and 2
node.no &lt;- rep(c(1,1,2,3),6)
Q1 &lt;- matrix(0,length(item.no),K)
Q2 &lt;- cbind(7:(7+K-1),rep(1,K),diag(K))
for(j in 1:length(item.no)) {
  Q1[j,sample(1:K,sample(3,1))] &lt;- 1
}
Qc &lt;- rbind(cbind(item.no,node.no,Q1),Q2)
Tmatrix.set &lt;- list(cbind(c(0,1,2,3,3),c(0,1,2,1,2),c(NA,0,NA,1,NA),c(NA,NA,0,NA,1)),
cbind(c(0,1,2,3,4),c(0,1,2,1,2),c(NA,0,NA,1,NA),c(NA,NA,0,NA,1)),
cbind(c(0,1),c(0,1)))
Tmatrix &lt;- Tmatrix.set[c(1,1,1,1,1,1,rep(3,K))]
sim &lt;- simDTM(N=2000,Qc=Qc,gs.parm=matrix(0.2,nrow(Qc),2),Tmatrix=Tmatrix)
est &lt;- DTM(dat=sim$dat,Qc=Qc,Tmatrix = Tmatrix)

## End(Not run)
</code></pre>

<hr>
<h2 id='simGDINA'>Data simulation based on the G-DINA models</h2><span id='topic+simGDINA'></span><span id='topic+extract.simGDINA'></span>

<h3>Description</h3>

<p>Simulate responses based on the G-DINA model (de la Torre, 2011) and sequential G-DINA model
(Ma &amp; de la Torre, 2016), or CDMs subsumed by them, including the DINA model, DINO model, ACDM,
LLM and R-RUM. Attributes can be simulated from uniform, higher-order or multivariate normal
distributions, or be supplied by users. See <code>Examples</code> and <code>Details</code> for
how item parameter specifications. See the help page of <code><a href="#topic+GDINA">GDINA</a></code>
for model parameterizations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simGDINA(
  N,
  Q,
  gs.parm = NULL,
  delta.parm = NULL,
  catprob.parm = NULL,
  model = "GDINA",
  sequential = FALSE,
  no.bugs = 0,
  gs.args = list(type = "random", mono.constraint = TRUE),
  design.matrix = NULL,
  linkfunc = NULL,
  att.str = NULL,
  attribute = NULL,
  att.dist = "uniform",
  item.names = NULL,
  higher.order.parm = list(theta = NULL, lambda = NULL),
  mvnorm.parm = list(mean = NULL, sigma = NULL, cutoffs = NULL),
  att.prior = NULL,
  digits = 4
)

## S3 method for class 'simGDINA'
extract(
  object,
  what = c("dat", "Q", "attribute", "catprob.parm", "delta.parm", "higher.order.parm",
    "mvnorm.parm", "LCprob.parm"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simGDINA_+3A_n">N</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_q">Q</code></td>
<td>
<p>A required matrix; The number of rows occupied by a single-strategy dichotomous item is 1, by a polytomous item is
the number of nonzero categories, and by a mutiple-strategy dichotomous item is the number of strategies.
The number of column is equal to the number of attributes if all items are single-strategy dichotomous items, but
the number of attributes + 2 if any items are polytomous or have multiple strategies.
For a polytomous item, the first column represents the item number and the second column indicates the nonzero category number.
For a multiple-strategy dichotomous item, the first column represents the item number and the second column indicates the strategy number.
For binary attributes, 1 denotes the attributes are measured by the items and 0 means the attributes are not
measured. For polytomous attributes, non-zero elements indicate which level
of attributes are needed.  See <code>Examples</code>.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_gs.parm">gs.parm</code></td>
<td>
<p>A matrix or data frame for guessing and slip parameters. The number of rows occupied by a dichotomous item is 1, and by a polytomous item is
the number of nonzero categories. The number of columns must be 2, where the first column represents the guessing parameters (or <code class="reqn">P(0)</code>),
and the second column represents slip parameters (or <code class="reqn">1-P(1)</code>). This may need to be used in conjunction with
the argument <code>gs.args</code>.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_delta.parm">delta.parm</code></td>
<td>
<p>A list of delta parameters of each latent group for each item or category. This may need to be used in conjunction with
the argument <code>delta.args</code>.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_catprob.parm">catprob.parm</code></td>
<td>
<p>A list of success probabilities of each latent group for each non-zero category of each item. See <code>Examples</code> and
<code>Details</code> for more information.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_model">model</code></td>
<td>
<p>A character vector for each item or nonzero category, or a scalar which will be used for all
items or nonzero categories to specify the CDMs. The possible options
include <code>"GDINA"</code>,<code>"DINA"</code>,<code>"DINO"</code>,<code>"ACDM"</code>,<code>"LLM"</code>, <code>"RRUM"</code>, <code>"MSDINA"</code> and <code>"UDF"</code>.
When <code>"UDF"</code>, indicating user defined function, is specified for any item, <code>delta.parm</code> must be specified, as well as
options <code>design.matrix</code> and <code>linkfunc</code> in argument <code>delta.args</code>.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_sequential">sequential</code></td>
<td>
<p>logical; <code>TRUE</code> if the sequential model is used for polytomous responses simulation, and <code>FALSE</code>
if there is no polytomously scored items.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_no.bugs">no.bugs</code></td>
<td>
<p>the number of bugs (or misconceptions) for the <code>SISM</code> model. Note that bugs must be given in the last no.bugs columns.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_gs.args">gs.args</code></td>
<td>
<p>a list of options when <code>gs.parm</code> is specified. It consists of two components:
</p>

<ul>
<li> <p><code>type</code> How are the delta parameters for ACDM, LLM, RRUM generated?
It can be either <code>"random"</code> or <code>"equal"</code>. <code>"random"</code> means the delta parameters are simulated randomly,
while <code>"equal"</code> means that each required attribute contributes equally to the probability of success (P), logit(P) or
log(P) for ACDM, LLM and RRUM, respectively. See <code>Details</code> for more information.
</p>
</li>
<li> <p><code>mono.constraint</code> A vector for each item/category or a scalar which will be used for all
items/categories to specify whether monotonicity constraints should be satisfied if the generating model is the G-DINA model. Note that
this is applicable only for the G-DINA model when <code>gs.parm</code> is used. For ACDM, LLM and RRUM, monotonicity constraints
are always satisfied and therefore this argument is ignored.
</p>
</li></ul>
</td></tr>
<tr><td><code id="simGDINA_+3A_design.matrix">design.matrix</code></td>
<td>
<p>a list of design matrices; Its length must be equal to the number of items (or nonzero categories for sequential models).</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_linkfunc">linkfunc</code></td>
<td>
<p>a vector of link functions for each item/category; It can be <code>"identity"</code>,<code>"log"</code> or <code>"logit"</code>. Only applicable when
when <code>delta.parm</code> or <code>catprob.parm</code> are provided.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_att.str">att.str</code></td>
<td>
<p>attribute structure. <code>NULL</code>, by default, means there is no structure. Attribute structure needs be specified as a list -
which will be internally handled by <code>att.structure</code> function. It can also be a matrix giving all permissible attribute profiles.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_attribute">attribute</code></td>
<td>
<p>optional user-specified person attributes. It is a <code class="reqn">N\times K</code> matrix or data frame. If this is not supplied, attributes are simulated
from a distribution specified in <code>att.dist</code>.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_att.dist">att.dist</code></td>
<td>
<p>A string indicating the distribution for attribute simulation. It can be <code>"uniform"</code>, <code>"higher.order"</code>,
<code>"mvnorm"</code> or <code>"categorical"</code> for uniform, higher-order, multivariate normal and categorical distributions, respectively.
The default is the uniform distribution. To specify structural parameters for the higher-order
and multivariate normal distributions, see <code>higher.order.parm</code> and <code>mvnorm.parm</code>, respectively. To specify the probabilities
for the categorical distribution, use <code>att.prior</code> argument.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_item.names">item.names</code></td>
<td>
<p>A vector giving the name of items or categories. If it is <code>NULL</code> (default), items are named as &quot;Item 1&quot;, &quot;Item 2&quot;, etc.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_higher.order.parm">higher.order.parm</code></td>
<td>
<p>A list specifying parameters for higher-order distribution for attributes
if <code>att.dist=higher.order</code>. Particularly, <code>theta</code> is a
vector of length <code class="reqn">N</code> representing the higher-order ability
for each examinee. and <code>lambda</code> is a <code class="reqn">K \times 2</code> matrix. Column 1 gives the slopes for the higher-order
model and column 2 gives the intercepts. See <code><a href="#topic+GDINA">GDINA</a></code> for the formulations of the higher-order
models.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_mvnorm.parm">mvnorm.parm</code></td>
<td>
<p>a list of parameters for multivariate normal attribute distribution. <code>mean</code> is a vector of length <code class="reqn">K</code>
specifying the mean of multivariate normal distribution; and <code>sigma</code> is a positive-definite
symmetric matrix specifying the variance-covariance matrix. <code>cutoffs</code> is a vector giving the
cutoff for each attribute. See <code>Examples</code>.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_att.prior">att.prior</code></td>
<td>
<p>probability for each attribute pattern. Order is the same as that returned from <code>attributepattern(Q = Q)</code>. This is only
applicable when <code>att.dist="categorical"</code>.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_digits">digits</code></td>
<td>
<p>How many decimal places in each number? The default is 4.</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_object">object</code></td>
<td>
<p>object of class <code>simGDINA</code> for method <code>extract</code></p>
</td></tr>
<tr><td><code id="simGDINA_+3A_what">what</code></td>
<td>
<p>argument for S3 method <code>extract</code> indicating what to extract</p>
</td></tr>
<tr><td><code id="simGDINA_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Item parameter specifications in <code>simGDINA</code>:
</p>
<p>Item parameters can be specified in one of three different ways.
</p>
<p>The first and probably the easiest way is to specify the guessing and slip parameters for each item or nonzero category using
<code>gs.parm</code>, which is a matrix or data frame for <code class="reqn">P(\bm{\alpha}_{lj}^*=0)</code> and <code class="reqn">1-P(\bm{\alpha}_{lj}^*=1)</code>
for all items for dichotomous items and <code class="reqn">S(\bm{\alpha}_{ljh}^*=0)</code> and <code class="reqn">1-S(\bm{\alpha}_{ljh}^*=1)</code>
for all nonzero categories for polytomous items. Note that <code class="reqn">1-P(\bm{\alpha}_{lj}^*=0)-P(\bm{\alpha}_{lj}^*=1)</code> or
<code class="reqn">1-S(\bm{\alpha}_{lj}^*=0)-S(\bm{\alpha}_{lj}^*=1)</code> must be greater than 0.
For generating ACDM, LLM, and RRUM, delta parameters are generated randomly if <code>type="random"</code>,
or in a way that each required attribute contributes equally, as in
Ma, Iaconangelo, &amp; de la Torre (2016) if <code>type="equal"</code>. For ACDM, LLM and RRUM, generated
delta parameters are always positive, which implies that monotonicity constraints are always satisfied.
If the generating model is the G-DINA model, <code>mono.constraint</code> can be used to specify whether monotonicity
constraints should be satisfied.
</p>
<p>The second way of simulating responses is to specify success probabilities (i.e., <code class="reqn">P(\bm{\alpha}_{lj}^*)</code>
or <code class="reqn">S(\bm{\alpha}_{ljh}^*)</code>) for each nonzero category of each item directly
using the argument <code>catprob.parm</code>. If an item or category requires <code class="reqn">K_j^*</code> attributes, <code class="reqn">2^{K_j^*}</code> success probabilities
need to be provided. <code>catprob.parm</code> must be a list, where each element gives the success probabilities for nonzero category of each item.
Note that success probabilities cannot be negative or greater than one.
</p>
<p>The third way is to specify delta parameters for data simulation. For DINA and DINO model, each nonzero category requires two
delta parameters. For ACDM, LLM and RRUM, if a nonzero category requires <code class="reqn">K_j^*</code> attributes, <code class="reqn">K_j^*+1</code> delta parameters
need to be specified. For the G-DINA model, a nonzero category requiring <code class="reqn">K_j^*</code> attributes has <code class="reqn">2^{K_j^*}</code> delta parameters.
It should be noted that specifying delta parameters needs to ascertain the derived success probabilities are within the <code class="reqn">[0,1]</code> interval.
</p>
<p>Please note that you need to specify item parameters in ONLY one of these three ways. If <code>gs.parm</code> is specified, it will be used regardless of
the inputs in <code>catprob.parm</code> and <code>delta.parm</code>. If <code>gs.parm</code> is not specified, <code>simGDINA</code> will check
if <code>delta.parm</code> is specified; if yes, it will be used for data generation. if both <code>gs.parm</code> and <code>delta.parm</code> are not specified,
<code>catprob.parm</code> is used for data generation.
</p>


<h3>Value</h3>

<p>an object of class <code>simGDINA</code>. Elements that can be extracted using method <code>extract</code>
include:
</p>

<dl>
<dt>dat</dt><dd><p>simulated item response matrix</p>
</dd>
<dt>Q</dt><dd><p>Q-matrix</p>
</dd>
<dt>attribute</dt><dd><p>A <code class="reqn">N \times K</code> matrix for inviduals' attribute patterns</p>
</dd>
<dt>catprob.parm</dt><dd><p>a list of non-zero category success probabilities for each latent group</p>
</dd>
<dt>delta.parm</dt><dd><p>a list of delta parameters</p>
</dd>
<dt>higher.order.parm</dt><dd><p>Higher-order parameters</p>
</dd>
<dt>mvnorm.parm</dt><dd><p>multivariate normal distribution parameters</p>
</dd>
<dt>LCprob.parm</dt><dd><p>A matrix of item/category success probabilities for each latent class</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a> <br /> Jimmy de la Torre, The University of Hong Kong
</p>


<h3>References</h3>

<p>Chiu, C.-Y., Douglas, J. A., &amp; Li, X. (2009). Cluster analysis for cognitive diagnosis: Theory and applications. <em>Psychometrika, 74</em>, 633-665.
</p>
<p>de la Torre, J. (2011). The generalized DINA model framework. <em>Psychometrika, 76</em>, 179-199.
</p>
<p>de la Torre, J., &amp; Douglas, J. A. (2004). Higher-order latent trait models for cognitive diagnosis. <em>Psychometrika, 69</em>, 333-353.
</p>
<p>Haertel, E. H. (1989). Using restricted latent class models to map the skill structure of achievement items.
<em>Journal of Educational Measurement, 26</em>, 301-321.
</p>
<p>Hartz, S. M. (2002). A bayesian framework for the unified model for assessing cognitive abilities:
Blending theory with practicality (Unpublished doctoral dissertation). University of Illinois at Urbana-Champaign.
</p>
<p>Junker, B. W., &amp; Sijtsma, K. (2001). Cognitive assessment models with few assumptions, and connections with nonparametric
item response theory. <em>Applied Psychological Measurement, 25</em>, 258-272.
</p>
<p>Ma, W., &amp; de la Torre, J. (2016). A sequential cognitive diagnosis model for polytomous responses. <em>British Journal of Mathematical and Statistical Psychology. 69,</em> 253-275.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>
<p>Ma, W., Iaconangelo, C., &amp; de la Torre, J. (2016). Model similarity, model selection and attribute classification. <em>Applied Psychological Measurement, 40</em>, 200-217.
</p>
<p>Maris, E. (1999). Estimating multiple classification latent class models. <em>Psychometrika, 64</em>, 187-212.
</p>
<p>Templin, J. L., &amp; Henson, R. A. (2006). Measurement of psychological disorders using cognitive diagnosis models.
<em>Psychological Methods, 11</em>, 287-305.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
####################################################
#                     Example 1                    #
#             Data simulation (DINA)               #
####################################################
N &lt;- 500
Q &lt;- sim30GDINA$simQ
J &lt;- nrow(Q)
gs &lt;- data.frame(guess=rep(0.1,J),slip=rep(0.1,J))

# Simulated DINA model; to simulate G-DINA model
# and other CDMs, change model argument accordingly

sim &lt;- simGDINA(N,Q,gs.parm = gs,model = "DINA")

# True item success probabilities
extract(sim,what = "catprob.parm")

# True delta parameters
extract(sim,what = "delta.parm")

# simulated data
extract(sim,what = "dat")

# simulated attributes
extract(sim,what = "attribute")

####################################################
#                     Example 2                    #
#             Data simulation (RRUM)               #
####################################################
N &lt;- 500
Q &lt;- sim30GDINA$simQ
J &lt;- nrow(Q)
gs &lt;- data.frame(guess=rep(0.2,J),slip=rep(0.2,J))
# Simulated RRUM
# deltas except delta0 for each item will be simulated
# randomly subject to the constraints of RRUM
sim &lt;- simGDINA(N,Q,gs.parm = gs,model = "RRUM")

# simulated data
extract(sim,what = "dat")

# simulated attributes
extract(sim,what = "attribute")

####################################################
#                     Example 3                    #
#             Data simulation (LLM)                #
####################################################
N &lt;- 500
Q &lt;- sim30GDINA$simQ
J &lt;- nrow(Q)
gs &lt;- data.frame(guess=rep(0.1,J),slip=rep(0.1,J))
# Simulated LLM
# By specifying type="equal", each required attribute is
# assumed to contribute to logit(P) equally
sim &lt;- simGDINA(N,Q,gs.parm = gs,model = "LLM",gs.args = list (type="equal"))
#check below for what the equal contribution means
extract(sim,what = "delta.parm")

# simulated data
extract(sim,what = "dat")

# simulated attributes
extract(sim,what = "attribute")

####################################################
#                   Example 4                      #
#          Data simulation (all CDMs)              #
####################################################

set.seed(12345)

N &lt;- 500
Q &lt;- sim10GDINA$simQ
J &lt;- nrow(Q)
gs &lt;- data.frame(guess=rep(0.1,J),slip=rep(0.1,J))
# Simulated different CDMs for different items
models &lt;- c("GDINA","DINO","DINA","ACDM","LLM","RRUM","GDINA","LLM","RRUM","DINA")
sim &lt;- simGDINA(N,Q,gs.parm = gs,model = models,gs.args = list(type="random"))

# simulated data
extract(sim,what = "dat")

# simulated attributes
extract(sim,what = "attribute")

####################################################
#                   Example 5a                     #
#          Data simulation (all CDMs)              #
#  using probability of success in list format     #
####################################################

# success probabilities for each item need to be provided in list format as follows:
# if item j requires Kj attributes, 2^Kj success probabilities
# need to be specified
# e.g., item 1 only requires 1 attribute
# therefore P(0) and P(1) should be specified;
# similarly, item 10 requires 3 attributes,
# P(000),P(100),P(010)...,P(111) should be specified;
# the latent class represented by each element can be obtained
# by calling attributepattern(Kj)
itemparm.list &lt;- list(item1=c(0.2,0.9),
                    item2=c(0.1,0.8),
                    item3=c(0.1,0.9),
                    item4=c(0.1,0.3,0.5,0.9),
                    item5=c(0.1,0.1,0.1,0.8),
                    item6=c(0.2,0.9,0.9,0.9),
                    item7=c(0.1,0.45,0.45,0.8),
                    item8=c(0.1,0.28,0.28,0.8),
                    item9=c(0.1,0.4,0.4,0.8),
                    item10=c(0.1,0.2,0.3,0.4,0.4,0.5,0.7,0.9))
set.seed(12345)
N &lt;- 500
Q &lt;- sim10GDINA$simQ
# When simulating data using catprob.parm argument,
# it is not necessary to specify model and type
sim &lt;- simGDINA(N,Q,catprob.parm = itemparm.list)

####################################################
#                   Example 5b                     #
#          Data simulation (all CDMs)              #
#  using probability of success in list format     #
#  attribute has a linear structure                #
####################################################

est &lt;- GDINA(sim10GDINA$simdat,sim10GDINA$simQ,att.str = list(c(1,2),c(2,3)))
# design matrix
# link function
# item probabilities
ip &lt;- extract(est,"itemprob.parm")
sim &lt;- simGDINA(N=500,sim10GDINA$simQ,catprob.parm = ip,
design.matrix = dm,linkfunc = lf,att.str = list(c(1,2),c(2,3)))


####################################################
#                   Example 6a                     #
#            Data simulation (all CDMs)            #
#      using delta parameters in list format       #
####################################################

delta.list &lt;- list(c(0.2,0.7),
                    c(0.1,0.7),
                    c(0.1,0.8),
                    c(0.1,0.7),
                    c(0.1,0.8),
                    c(0.2,0.3,0.2,0.1),
                    c(0.1,0.35,0.35),
                    c(-1.386294,0.9808293,1.791759),
                    c(-1.609438,0.6931472,0.6),
                    c(0.1,0.1,0.2,0.3,0.0,0.0,0.1,0.1))

model &lt;- c("GDINA","GDINA","GDINA","DINA","DINO","GDINA","ACDM","LLM","RRUM","GDINA")
N &lt;- 500
Q &lt;- sim10GDINA$simQ
sim &lt;- simGDINA(N,Q,delta.parm = delta.list, model = model)
####################################################
#                   Example 6b                     #
#          Data simulation (all CDMs)              #
#  using delta parameters in list format           #
#  attribute has a linear structure                #
####################################################

est &lt;- GDINA(sim10GDINA$simdat,sim10GDINA$simQ,att.str = list(c(1,2),c(2,3)))
# design matrix
# link function
# item probabilities
ip &lt;- extract(est,"delta.parm")
sim &lt;- simGDINA(N=500,sim10GDINA$simQ,delta.parm =  d,
design.matrix = dm,linkfunc = lf,att.str = list(c(1,2),c(2,3)))

####################################################
#                   Example 7                      #
#      Data simulation (higher order DINA model)   #
####################################################

Q &lt;- sim30GDINA$simQ
gs &lt;- matrix(0.1,nrow(Q),2)
N &lt;- 500
set.seed(12345)
theta &lt;- rnorm(N)
K &lt;- ncol(Q)
lambda &lt;- data.frame(a=rep(1,K),b=seq(-2,2,length.out=K))
sim &lt;- simGDINA(N,Q,gs.parm = gs, model="DINA", att.dist = "higher.order",
                 higher.order.parm = list(theta = theta,lambda = lambda))

####################################################
#                   Example 8                      #
#      Data simulation (higher-order CDMs)         #
####################################################

Q &lt;- sim30GDINA$simQ
gs &lt;- matrix(0.1,nrow(Q),2)
models &lt;- c(rep("GDINA",5),
            rep("DINO",5),
            rep("DINA",5),
            rep("ACDM",5),
            rep("LLM",5),
            rep("RRUM",5))
N &lt;- 500
set.seed(12345)
theta &lt;- rnorm(N)
K &lt;- ncol(Q)
lambda &lt;- data.frame(a=runif(K,0.7,1.3),b=seq(-2,2,length.out=K))
sim &lt;- simGDINA(N,Q,gs.parm = gs, model=models, att.dist = "higher.order",
                 higher.order.parm = list(theta = theta,lambda = lambda))


####################################################
#                   Example 9                      #
#      Data simulation (higher-order model)        #
#  using the multivariate normal threshold model   #
####################################################


# See Chiu et al., (2009)

N &lt;- 500
Q &lt;- sim10GDINA$simQ
K &lt;- ncol(Q)
gs &lt;- matrix(0.1,nrow(Q),2)
cutoffs &lt;- qnorm(c(1:K)/(K+1))
m &lt;- rep(0,K)
vcov &lt;- matrix(0.5,K,K)
diag(vcov) &lt;- 1
simMV &lt;- simGDINA(N,Q,gs.parm = gs, att.dist = "mvnorm",
                 mvnorm.parm=list(mean = m, sigma = vcov,cutoffs = cutoffs))

####################################
#          Example 10              #
#        Simulation using          #
#      user-specified att structure#
####################################

# --- User-specified attribute structure ----#
Q &lt;- sim30GDINA$simQ
K &lt;- ncol(Q)
# divergent structure A1-&gt;A2-&gt;A3;A1-&gt;A4-&gt;A5;A1-&gt;A4-&gt;A6
diverg &lt;- list(c(1,2),
               c(2,3),
               c(1,4),
               c(4,5))
struc &lt;- att.structure(diverg,K)

# data simulation
N &lt;- 1000
# data simulation
gs &lt;- matrix(0.1,nrow(Q),2)
simD &lt;- simGDINA(N,Q,gs.parm = gs,
                   model = "DINA",att.dist = "categorical",att.prior = struc$att.prob)


####################################################
#                   Example 11                     #
#                Data simulation                   #
#  (GDINA with monotonicity constraints)           #
####################################################

set.seed(12345)

N &lt;- 500
Q &lt;- sim30GDINA$simQ
J &lt;- nrow(Q)
gs &lt;- data.frame(guess=rep(0.1,J),slip=rep(0.1,J))
# Simulated different CDMs for different items
sim &lt;- simGDINA(N,Q,gs.parm = gs,model = "GDINA",gs.args=list(mono.constraint=TRUE))

# True item success probabilities
extract(sim,what = "catprob.parm")

# True delta parameters
extract(sim,what = "delta.parm")

# simulated data
extract(sim,what = "dat")

# simulated attributes
extract(sim,what = "attribute")

####################################################
#                   Example 12                     #
#                Data simulation                   #
# (Sequential G-DINA model - polytomous responses) #
####################################################

set.seed(12345)

N &lt;- 2000
# restricted Qc matrix
Qc &lt;- sim20seqGDINA$simQ
#total number of categories
J &lt;- nrow(Qc)
gs &lt;- data.frame(guess=rep(0.1,J),slip=rep(0.1,J))
# simulate sequential DINA model
simseq &lt;- simGDINA(N, Qc, sequential = TRUE, gs.parm = gs, model = "GDINA")

# True item success probabilities
extract(simseq,what = "catprob.parm")

# True delta parameters
extract(simseq,what = "delta.parm")

# simulated data
extract(simseq,what = "dat")

# simulated attributes
extract(simseq,what = "attribute")


####################################################
#                   Example 13
#         DINA model Attribute generated using
#             categorical distribution
####################################################

Q &lt;- sim10GDINA$simQ
gs &lt;- matrix(0.1,nrow(Q),2)
N &lt;- 5000
set.seed(12345)
prior &lt;- c(0.1,0.2,0,0,0.2,0,0,0.5)
sim &lt;- simGDINA(N,Q,gs.parm = gs, model="DINA", att.dist = "categorical",att.prior = prior)
# check latent class sizes
table(sim$att.group)/N

####################################################
#                   Example 14
#                  MS-DINA model
####################################################


Q &lt;- matrix(c(1,1,1,1,0,
1,2,0,1,1,
2,1,1,0,0,
3,1,0,1,0,
4,1,0,0,1,
5,1,1,0,0,
5,2,0,0,1),ncol = 5,byrow = TRUE)
d &lt;- list(
  item1=c(0.2,0.7),
  item2=c(0.1,0.6),
  item3=c(0.2,0.6),
  item4=c(0.2,0.7),
  item5=c(0.1,0.8))

  set.seed(12345)
sim &lt;- simGDINA(N=1000,Q = Q, delta.parm = d,
               model = c("MSDINA","MSDINA","DINA","DINA","DINA","MSDINA","MSDINA"))

# simulated data
extract(sim,what = "dat")

# simulated attributes
extract(sim,what = "attribute")


##############################################################
#                   Example 15
#  reparameterized SISM model (Kuo, Chen, &amp; de la Torre, 2018)
#  see GDINA function for more details
###############################################################

# The Q-matrix used in Kuo, et al (2018)
# The first four columns are for Attributes 1-4
# The last three columns are for Bugs 1-3
Q &lt;- matrix(c(1,0,0,0,0,0,0,
0,1,0,0,0,0,0,
0,0,1,0,0,0,0,
0,0,0,1,0,0,0,
0,0,0,0,1,0,0,
0,0,0,0,0,1,0,
0,0,0,0,0,0,1,
1,0,0,0,1,0,0,
0,1,0,0,1,0,0,
0,0,1,0,0,0,1,
0,0,0,1,0,1,0,
1,1,0,0,1,0,0,
1,0,1,0,0,0,1,
1,0,0,1,0,0,1,
0,1,1,0,0,0,1,
0,1,0,1,0,1,1,
0,0,1,1,0,1,1,
1,0,1,0,1,1,0,
1,1,0,1,1,1,0,
0,1,1,1,1,1,0),ncol = 7,byrow = TRUE)

J &lt;- nrow(Q)
N &lt;- 500
gs &lt;- data.frame(guess=rep(0.1,J),slip=rep(0.1,J))

sim &lt;- simGDINA(N,Q,gs.parm = gs,model = "SISM",no.bugs=3)

# True item success probabilities
extract(sim,what = "catprob.parm")

# True delta parameters
extract(sim,what = "delta.parm")

# simulated data
extract(sim,what = "dat")

# simulated attributes
extract(sim,what = "attribute")

## End(Not run)


</code></pre>

<hr>
<h2 id='startGDINA'>Graphical user interface of the GDINA function</h2><span id='topic+startGDINA'></span>

<h3>Description</h3>

<p>An interactive Shiny application for running GDINA function. See Ma and de la Torre (2019) and de la Torre and Akbay (2019) for tutorials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startGDINA()
</code></pre>


<h3>Author(s)</h3>

<p>Wenchao Ma, The University of Alabama, <a href="mailto:wenchao.ma@ua.edu">wenchao.ma@ua.edu</a>
</p>


<h3>References</h3>

<p>de la Torre, J &amp; Akbay, L. (2019). Implementation of Cognitive Diagnosis Modeling using the GDINA R Package. <em>Eurasian Journal of Educational Research, 80</em>, 171-192.
</p>
<p>Ma, W., &amp; de la Torre, J. (2019). Digital Module 05: Diagnostic measurement-The G-DINA framework.<em> Educational Measurement: Issues and Practice, 39</em>, 114-115.
</p>
<p>Ma, W., &amp; de la Torre, J. (2020). GDINA: An R Package for Cognitive Diagnosis Modeling. <em>Journal of Statistical Software, 93(14)</em>, 1-26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(shiny)
library(shinydashboard)
startGDINA()

## End(Not run)

</code></pre>

<hr>
<h2 id='unique_only'>Unique values in a vector</h2><span id='topic+unique_only'></span>

<h3>Description</h3>

<p>Unique values in a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unique_only(vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unique_only_+3A_vec">vec</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sorted unique values
</p>


<h3>See Also</h3>

<p><a href="base.html#topic+unique">unique</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
vec &lt;- c(4,2,3,5,4,4,4)
unique_only(vec)
# see the difference from unique
unique(vec)

vec &lt;- letters[1:5]
unique_only(vec)



</code></pre>

<hr>
<h2 id='unrestrQ'>Generate unrestricted Qc matrix from an restricted Qc matrix</h2><span id='topic+unrestrQ'></span>

<h3>Description</h3>

<p>Generate unrestricted Qc matrix from an restricted Qc matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unrestrQ(Qc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unrestrQ_+3A_qc">Qc</code></td>
<td>
<p>an restricted Qc matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an unrestricted Qc matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Qc &lt;- sim21seqDINA$simQc
Qc
unrestrQ(Qc)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
