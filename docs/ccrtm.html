<!DOCTYPE html><html><head><title>Help for package ccrtm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ccrtm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bRTM'><p>Generates an invertable model for backward implementation</p>
of Radiative Transfer Models</a></li>
<li><a href='#cambell'><p>Leaf inclination distribution function</p>
Ellipsoidal distribution function</a></li>
<li><a href='#ccrtm'><p>ccrtm: Coupled Chain Radiative Transfer Models.</p></a></li>
<li><a href='#cdcum'><p>Leaf inclination distribution function</p>
cummulative lagden function from Wout Verhoef's dissertation
Extended here for any angle</a></li>
<li><a href='#data_prospect5'><p>refractive index and specific absorption coefficient for</p>
PROSPECT 5</a></li>
<li><a href='#data_prospectd'><p>refractive index and specific absorption coefficient for PROSPECT D</p></a></li>
<li><a href='#flim'><p>Forest Light Interaction Model (FLIM)</p></a></li>
<li><a href='#foursail'><p>Optimized R implementation of foursail (4SAIL)</p></a></li>
<li><a href='#foursail2'><p>R implementation of the foursail2 model with 2 canopy layers.</p></a></li>
<li><a href='#foursail2b'><p>R implementation of the foursail2 model with 2 canopy layers.</p></a></li>
<li><a href='#fRTM'><p>Forward implementation of coupled Radiative Transfer Models.</p></a></li>
<li><a href='#getDefaults'><p>S3- methods for Generate defaults settings and parameters</p>
for all supported models.</a></li>
<li><a href='#KLd'><p>Kullback-Lieber divergence function</p>
D(spec1 || spec2) = sum(spec1 * log(spec1 / spec2))</a></li>
<li><a href='#lidf'><p>Leaf inclination distribution models</p>
s3 method for calling leaf models</a></li>
<li><a href='#plot.rtm.spectra'><p>Plot RTM return spectra vs. wavelength</p></a></li>
<li><a href='#print.rtm.spectra'><p>Plot RTM return spectra vs. wavelength</p></a></li>
<li><a href='#prospect5'><p>PROSPECT model version 5 and 5B</p></a></li>
<li><a href='#prospectd'><p>PROSPECT model version D</p></a></li>
<li><a href='#r_foursail'><p>R implementation of foursail (pure R)</p></a></li>
<li><a href='#sail_BDRF'><p>The SAIL BDRF function</p></a></li>
<li><a href='#skyl'><p>Sky light model</p></a></li>
<li><a href='#soil'><p>soil reflectance</p></a></li>
<li><a href='#solar'><p>direct and diffuse light</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Coupled Chain Radiative Transfer Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-02-22</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of radiative transfer models to quantitatively describe the absorption, reflectance and transmission of solar energy in vegetation, and model remotely sensed spectral signatures of vegetation at distinct spatial scales (leaf,canopy and stand). The main principle behind ccrtm is that many radiative transfer models can form a coupled chain, basically models that feed into each other in a linked chain (from leaf, to canopy, to stand, to atmosphere). It allows the simulation of spectral datasets in the solar spectrum (400-2500nm) using leaf models as PROSPECT5, 5b, and D which can be coupled with canopy models as 'FLIM', 'SAIL' and 'SAIL2'. Currently, only a simple atmospheric model ('skyl') is implemented. Jacquemoud et al 2008 provide the most comprehensive overview of these models &lt;<a href="https://doi.org/10.1016%2Fj.rse.2008.01.026">doi:10.1016/j.rse.2008.01.026</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MarcoDVisser/ccrtm">https://github.com/MarcoDVisser/ccrtm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MarcoDVisser/ccrtm/issues">https://github.com/MarcoDVisser/ccrtm/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, stats, testthat, Rcpp (&ge; 1.0.3), expint,
pracma</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-24 13:01:58 UTC; mvisser</td>
</tr>
<tr>
<td>Author:</td>
<td>Marco D. Visser [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marco D. Visser &lt;marco.d.visser@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-26 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bRTM'>Generates an invertable model for backward implementation
of Radiative Transfer Models</h2><span id='topic+bRTM'></span>

<h3>Description</h3>

<p>Generates an invertable model for backward implementation
of Radiative Transfer Models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bRTM(fm = rho ~ prospect5, data = NULL, pars = NULL, fixed = NULL,
  wl = 400:2500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bRTM_+3A_fm">fm</code></td>
<td>
<p>A formula specifying which rtm to run</p>
</td></tr>
<tr><td><code id="bRTM_+3A_data">data</code></td>
<td>
<p>ignored as of yet</p>
</td></tr>
<tr><td><code id="bRTM_+3A_pars">pars</code></td>
<td>
<p>a list of _named_ parameter vectors for all models.
The parameter list for a model call as rho ~ prospect + foursail
therefore contains two named vectors the first with parameters for
prospect and the second with parameters for foursail 
if left empty default parameters are generated</p>
</td></tr>
<tr><td><code id="bRTM_+3A_fixed">fixed</code></td>
<td>
<p>a list of parameters to fix</p>
</td></tr>
<tr><td><code id="bRTM_+3A_wl">wl</code></td>
<td>
<p>wavelengths (in nm) add only if
certain wavelengths are required as output.
Input is expected to integers between 400 and 2500, or will 
be forced to be an integer. Integers outside the 400:2500 range
will not be returned.</p>
</td></tr>
</table>

<hr>
<h2 id='cambell'>Leaf inclination distribution function
Ellipsoidal distribution function</h2><span id='topic+cambell'></span>

<h3>Description</h3>

<p>Leaf inclination distribution function
Ellipsoidal distribution function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cambell(ala, tx1, tx2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cambell_+3A_ala">ala</code></td>
<td>
<p>average leaf angle parameter</p>
</td></tr>
<tr><td><code id="cambell_+3A_tx1">tx1</code></td>
<td>
<p>angle in degree</p>
</td></tr>
<tr><td><code id="cambell_+3A_tx2">tx2</code></td>
<td>
<p>angle in degree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>angle fraction value
</p>

<hr>
<h2 id='ccrtm'>ccrtm: Coupled Chain Radiative Transfer Models.</h2><span id='topic+ccrtm'></span><span id='topic+ccrtm-package'></span>

<h3>Description</h3>

<p>A collection of radiative transfer models that can form
a coupled chain to model radiative transfer across multiple
spatial scales from leaf to canopy to stand.
</p>


<h3>Details</h3>

<p>Currently implemented models:
</p>

<ul>
<li><p> [1] = PROSPECT 5, 5B and D
</p>
</li>
<li><p> [2] = FOURSAIL, and FOURSAIL2 
</p>
</li>
<li><p> [3] = FLIM
</p>
</li></ul>

<p>Currently being tested or to be implemented models
</p>

<ul>
<li><p> [1] = LIBERTY, PROCOSINE
</p>
</li>
<li><p> [2] = INFORM
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Marco D. Visser
</p>

<hr>
<h2 id='cdcum'>Leaf inclination distribution function
cummulative lagden function from Wout Verhoef's dissertation
Extended here for any angle</h2><span id='topic+cdcum'></span>

<h3>Description</h3>

<p>Leaf inclination distribution function
cummulative lagden function from Wout Verhoef's dissertation
Extended here for any angle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdcum(a, b, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdcum_+3A_a">a</code></td>
<td>
<p>parameter</p>
</td></tr>
<tr><td><code id="cdcum_+3A_b">b</code></td>
<td>
<p>parameter</p>
</td></tr>
<tr><td><code id="cdcum_+3A_theta">theta</code></td>
<td>
<p>angle in degrees</p>
</td></tr>
</table>


<h3>Value</h3>

<p>angle fraction value
</p>

<hr>
<h2 id='data_prospect5'>refractive index and specific absorption coefficient for
PROSPECT 5</h2><span id='topic+data_prospect5'></span>

<h3>Description</h3>

<p>see http://teledetection.ipgp.jussieu.fr/prosail/ for more details
on the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(prospect5)
</code></pre>


<h3>details</h3>

<p>***********************************************************************
data_prospect5 (february, 25th 2008)
The dataset contains the following labels (columns):
***********************************************************************
</p>

<ul>
<li><p> [1] = wavelength (nm)
</p>
</li>
<li><p> [2] = refractive index of leaf material (
or the ratio of the velocity of light in a vacuum to its velocity in &quot;leaf
medium&quot;).
</p>
</li>
<li><p> [3] = specific absorption coefficient of chlorophyll (a+b) (cm2.microg-1)
</p>
</li>
<li><p> [4] = specific absorption coefficient of carotenoids (cm2.microg-1)
</p>
</li>
<li><p> [5] = specific absorption coefficient of brown pigments (arbitrary units)
</p>
</li>
<li><p> [6] = specific absorption coefficient of water (cm-1)
</p>
</li>
<li><p> [7] = specific absorption coefficient of dry matter (g.cm-1)
</p>
</li>
<li><p> [8] = direct light
</p>
</li>
<li><p> [9] = diffuse light
</p>
</li>
<li><p> [10] = dry soil
</p>
</li>
<li><p> [11] = wet soil
</p>
</li></ul>



<h3>references</h3>

<p>Feret et al. (2008), PROSPECT-4 and 5: Advances in the Leaf Optical
Properties Model Separating Photosynthetic Pigments, Remote Sensing of
Environment
</p>

<hr>
<h2 id='data_prospectd'>refractive index and specific absorption coefficient for PROSPECT D</h2><span id='topic+data_prospectd'></span>

<h3>Description</h3>

<p>see http://teledetection.ipgp.jussieu.fr/prosail/ for more details
on the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(prospectd)
</code></pre>


<h3>details</h3>

<p>***********************************************************************
data_prospect5 (february, 25th 2008)
The dataset contains the following labels (columns):
***********************************************************************
</p>

<ul>
<li><p> [1] = wavelength (nm)
</p>
</li>
<li><p> [2] = refractive index of leaf material (
or the ratio of the velocity of light in a vacuum to its velocity in &quot;leaf
medium&quot;).
</p>
</li>
<li><p> [3] = specific absorption coefficient of chlorophyll (a+b) (cm2.microg-1)
</p>
</li>
<li><p> [4] = specific absorption coefficient of carotenoids (cm2.microg-1)
</p>
</li>
<li><p> [5] = specific absorption coefficient of brown pigments (arbitrary units)
</p>
</li>
<li><p> [6] = specific absorption coefficient of water (cm-1)
</p>
</li>
<li><p> [7] = specific absorption coefficient of dry matter (g.cm-1)
</p>
</li>
<li><p> [8] = direct light
</p>
</li>
<li><p> [9] = diffuse light
</p>
</li>
<li><p> [10] = dry soil
</p>
</li>
<li><p> [11] = wet soil
</p>
</li></ul>



<h3>references</h3>

<p>Feret et al. (2008), PROSPECT-4 and 5: Advances in the Leaf Optical
Properties Model Separating Photosynthetic Pigments, Remote Sensing of
Environment
</p>

<hr>
<h2 id='flim'>Forest Light Interaction Model (FLIM)</h2><span id='topic+flim'></span>

<h3>Description</h3>

<p>The FLIM model was first described by Rosema et al (1992).
In FLIM forests are assumed a discontinous mix of tree crowns
and gaps. Reflectance is modelled in terms of the
probabilty to observe either a gap (background)
or a tree crown. Both gaps and crowns may be shaded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flim(Rc, Rg, To = NULL, Ts = NULL, params, area = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flim_+3A_rc">Rc</code></td>
<td>
<p>Canopy reflectance at infinite depth</p>
</td></tr>
<tr><td><code id="flim_+3A_rg">Rg</code></td>
<td>
<p>soil/background reflectance</p>
</td></tr>
<tr><td><code id="flim_+3A_to">To</code></td>
<td>
<p>transmission in viewing direction</p>
</td></tr>
<tr><td><code id="flim_+3A_ts">Ts</code></td>
<td>
<p>transmission in sun direction</p>
</td></tr>
<tr><td><code id="flim_+3A_params">params</code></td>
<td>
<p>a named vector of parameters: 
</p>

<ul>
<li><p> [1] = D, stand density (confounded with cd)
</p>
</li>
<li><p> [2] = cd, crown diameter (confounded with D)
</p>
</li>
<li><p> [3] = h, mean crown height
</p>
</li>
<li><p> [6] = Solar zenith angle (tts)
</p>
</li>
<li><p> [7] = Observer zenith angle (tto)
</p>
</li>
<li><p> [8] = Sun-sensor azimuth angle (psi)
</p>
</li></ul>
</td></tr>
<tr><td><code id="flim_+3A_area">area</code></td>
<td>
<p>area of stand</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confounded parameters pairs cannot be inversely
estimated, one of the pairs should be set to 1.
</p>


<h3>Value</h3>

<p>a list with reflectance, and the fractions of shaded 
and sunexplosed crowns, shaded and sun exposed open space.
</p>


<h3>References</h3>

<p>Rosema, A., Verhoef, W., Noorbergen, H., Borgesius, J.J. (1992). 
A new forest light interaction model in support of forest monitoring. 
Remote Sens. Environ. 42, 23-41.
</p>

<hr>
<h2 id='foursail'>Optimized R implementation of foursail (4SAIL)</h2><span id='topic+foursail'></span>

<h3>Description</h3>

<p>The foursail (or 4SAIL) radiative transfer model is commonly used to simulate bidirectional 
reflectance distribution functions within vegetation canopies. Foursail (4SAIL) refers 
to &quot;Scattering by Arbitrary Inclined Leaves&quot; in a 4-stream model. The four-streams represents 
the scattering and absorption of upward, downward and two directional radiative fluxes with 
four linear differential equations in a 1-D canopy. The model was initially developed by
Verhoef (1984), who extended work by Suits (1971) 4-steam model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>foursail(rho, tau, bgr, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="foursail_+3A_rho">rho</code></td>
<td>
<p>input leaf reflectance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail_+3A_tau">tau</code></td>
<td>
<p>input leaf transmittance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail_+3A_bgr">bgr</code></td>
<td>
<p>background reflectance. Usual input is
soil reflectance spectra from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail_+3A_param">param</code></td>
<td>
<p>A named vector of SAIL parameter values (note: program ignores case):
</p>

<ul>
<li><p> [1] = Leaf angle distribution function parameter a (LIDFa)
</p>
</li>
<li><p> [2] = Leaf angle distribution function parameter b (LIDFb)
</p>
</li>
<li><p> [3] = Leaf angle distribution function type (see ?lidfFun)
</p>
</li>
<li><p> [4] = Leaf area index (LAI)
</p>
</li>
<li><p> [5] = Hot spot effect parameter (hspot)
</p>
</li>
<li><p> [6] = Solar zenith angle (tts)
</p>
</li>
<li><p> [7] = Observer zenith angle (tto)
</p>
</li>
<li><p> [8] = Sun-sensor azimuth angle (psi)
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra matrixwith 4 reflectance factors and canopy transmission 
for wavelengths 400 to 2500nm:
</p>

<ul>
<li><p> [1] = bi-hemispherical reflectance (rddt). White-sky albedo: the reflectance of the canopy
under diffuse illumination. The BRDF integrated over all viewing and illumination directions.  
</p>
</li>
<li><p> [2] = hemispherical directional reflectance (rsdt). Black-sky albedo: reflectance of a surface
under direct light without a diffuse component. It is the integral of the BRDF over all viewing
directions.
</p>
</li>
<li><p> [3] = directional hemispherical reflectance (rdot). Diffuse reflectance in the vieweing
direction. 
</p>
</li>
<li><p> [4] = bi-directional reflectance (rsot). The ratio of reflected radiance in the viewing direction
to the incoming radiant flux in the solar direction. 
</p>
</li>
<li><p> [5] = Canopy transmission of diffuse light through the canopy (taud).
</p>
</li>
<li><p> [6] = transmission of direct light through the canopy (taus).
</p>
</li></ul>



<h3>References</h3>

<p>Suits, G.H., 1971. The calculation of the directional reflectance of a 
vegetative canopy. Remote Sens. Environ. 2, 117-125.
</p>
<p>Verhoef, W. (1984). Light scattering by leaf layers with application to 
canopy reflectance modeling: The SAIL model. Remote Sens. Environ. 16, 125-141.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## lower-level implementation example
## see ?fRTM for the typical mode of simulation
## e.g. fRTM(rho~prospectd+foursail) 

## 1) get parameters
params&lt;-getDefaults(rho~prospectd+foursail) 
## getDefaults("foursail") will also work
bestpars&lt;-params$foursail$best
## ensure the vector is named
names(bestpars) &lt;- rownames(params$foursail)

## 2) get leaf reflectance and transmission 
rt&lt;-fRTM(rho+tau~prospectd)

## 3) get soil reflectance to model background reflectance
data(soil)

## a linear mixture soil model 
bgRef&lt;- bestpars["psoil"]*soil[,"drySoil"] + (1-bestpars["psoil"])*soil[,"wetSoil"]

## 4) run 4SAIL
foursail(rt[,"rho"],rt[,"tau"],bgRef,bestpars)

</code></pre>

<hr>
<h2 id='foursail2'>R implementation of the foursail2 model with 2 canopy layers.</h2><span id='topic+foursail2'></span>

<h3>Description</h3>

<p>The foursail2 model is a two layer implementation of the 
foursail model described in Verhoef and Bach (2007).
Layers are assumed identical in particle inclination and
hotspot, but may differ in the relative density and types of
particles (see foursail2b for a layer specific inclination angle).
In comparison to foursail, the background (soil),
can now be non-Lambertain, having it own 4-stream
BDRF (not implemented here but may be input by the user).
There are two types of particles, generalized
to primary and secondary (originally termed &quot;green&quot;
and &quot;brown&quot; particles). The  realtive abundance of
the secondary particle in the top canopy is regulated by
the dissociation paramerter.The model 4SAIL2 combines with
prospect, libery or procosine for the reflectance
and transmittance of the particles, and with the the foursail
or Hapke elements for the background reflectance.
If run alone, these require direct inputs which could be 
measured leaf reflectance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>foursail2(rhoA, tauA, rhoB = NULL, tauB = NULL, bgr, rsobgr = NULL,
  rdobgr = NULL, rsdbgr = NULL, rddbgr = NULL, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="foursail2_+3A_rhoa">rhoA</code></td>
<td>
<p>primary particle reflectance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2_+3A_taua">tauA</code></td>
<td>
<p>primary particle transmittance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2_+3A_rhob">rhoB</code></td>
<td>
<p>secondary particle reflectance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2_+3A_taub">tauB</code></td>
<td>
<p>secondary particle reflectance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2_+3A_bgr">bgr</code></td>
<td>
<p>background reflectance. Usual input is
soil reflectance spectra from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2_+3A_rsobgr">rsobgr</code></td>
<td>
<p>: background bidirectional reflectance (rso)</p>
</td></tr>
<tr><td><code id="foursail2_+3A_rdobgr">rdobgr</code></td>
<td>
<p>: background directional hemispherical reflectance (rdo)</p>
</td></tr>
<tr><td><code id="foursail2_+3A_rsdbgr">rsdbgr</code></td>
<td>
<p>: background hemispherical directional reflectance (rsd)</p>
</td></tr>
<tr><td><code id="foursail2_+3A_rddbgr">rddbgr</code></td>
<td>
<p>: background bi-hemispherical diffuse reflectance (rdd)</p>
</td></tr>
<tr><td><code id="foursail2_+3A_param">param</code></td>
<td>
<p>A named vector of 4SAIL2 parameter values (note:
program ignores case):
</p>

<ul>
<li><p> [1] = Leaf angle distribution function parameter a (LIDFa)
</p>
</li>
<li><p> [2] = Leaf angle distribution function parameter b (LIDFb)
</p>
</li>
<li><p> [3] = Leaf angle distribution function type (TypeLidf, see ?lidfFun)
</p>
</li>
<li><p> [4] = Total Leaf Area Index (LAI), including primary and secondary 
particles (brown and green leafs).
</p>
</li>
<li><p> [5] = fraction secondary particles (&quot;brown leaf fraction&quot;, fb)
</p>
</li>
<li><p> [6] = Canopy dissociation factor for secondary particles (&quot;diss&quot;)
</p>
</li>
<li><p> [7] = Hot spot effect parameter (hspot). Often defined as the
ratio of mean leaf width and canopy height.
</p>
</li>
<li><p> [7] = vertical crown coverage fraction (Cv), models clumping in combination
with parameter zeta. 
</p>
</li>
<li><p> [7] = tree shape factor (zeta), defined as the ratio of crown diameter and height.
</p>
</li>
<li><p> [6] = Solar zenith angle (tts)
</p>
</li>
<li><p> [7] = Observer zenith angle (tto)
</p>
</li>
<li><p> [8] = Sun-sensor azimuth angle (psi)
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra matrixwith 4 reflectance factors and canopy transmission 
for wavelengths 400 to 2500nm:
</p>

<ul>
<li><p> [1] = bi-hemispherical reflectance (rddt). White-sky albedo: the reflectance of the canopy
under diffuse illumination. The BRDF integrated over all viewing and illumination directions.
Diffuse reflectance for diffuse incidence.
</p>
</li>
<li><p> [2] = hemispherical directional reflectance (rsdt). Black-sky albedpo: reflectance of a surface
under direct light without a diffuse component. It is the integral of the BRDF over all viewing
directions. Diffuse reflectance for direct solar incidence.
</p>
</li>
<li><p> [3] = directional hemispherical reflectance (rdot). Diffuse reflectance in the vieweing
direction. 
</p>
</li>
<li><p> [4] = bi-directional reflectance (rsot). The ratio of reflected radiance in the viewing direction
to the incoming radiant flux in the solar direction. 
</p>
</li></ul>



<h3>References</h3>

<p>Verhoef, W., Bach, H. (2007). Coupled soil-leaf-canopy and atmosphere radiative transfer 
modeling to simulate hyperspectral multi-angular surface reflectance and TOA radiance data. 
Remote Sens. Environ. 109, 166-182.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?foursail for lower-level implementations
fRTM(rho~prospect5+foursail2)

</code></pre>

<hr>
<h2 id='foursail2b'>R implementation of the foursail2 model with 2 canopy layers.</h2><span id='topic+foursail2b'></span>

<h3>Description</h3>

<p>The foursail2b model is a two layer implementation of the 
foursail model described in Zhang et al (2005).
Layers are assumed identical in hotspot,
but may differ in the relative density, inclination and types of
particles. In comparison to foursail, the background (soil),
can now be non-Lambertain, having it own 4-stream
BDRF. There are two types of particles, generalized
to primary and secondary (originally termed &quot;green&quot;
and &quot;brown&quot; particles). The  realtive abundance of
the secondary particle in the top canopy is regulated by
the dissociation paramerter.The model 4SAIL2 combines with
prospect, libery or procosine for the reflectance
and transmittance of the particles, and with the the foursail
or Hapke elements for the background reflectance.
If run alone, these require direct inputs which could be 
measured leaf reflectance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>foursail2b(rhoA, tauA, rhoB = NULL, tauB = NULL, bgr, rsobgr = NULL,
  rdobgr = NULL, rsdbgr = NULL, rddbgr = NULL, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="foursail2b_+3A_rhoa">rhoA</code></td>
<td>
<p>primary particle reflectance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2b_+3A_taua">tauA</code></td>
<td>
<p>primary particle transmittance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2b_+3A_rhob">rhoB</code></td>
<td>
<p>secondary particle reflectance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2b_+3A_taub">tauB</code></td>
<td>
<p>secondary particle reflectance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2b_+3A_bgr">bgr</code></td>
<td>
<p>background reflectance. Usual input is
soil reflectance spectra from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="foursail2b_+3A_rsobgr">rsobgr</code></td>
<td>
<p>: background bidirectional reflectance (rso)</p>
</td></tr>
<tr><td><code id="foursail2b_+3A_rdobgr">rdobgr</code></td>
<td>
<p>: background directional hemispherical reflectance (rdo)</p>
</td></tr>
<tr><td><code id="foursail2b_+3A_rsdbgr">rsdbgr</code></td>
<td>
<p>: background hemispherical directional reflectance (rsd)</p>
</td></tr>
<tr><td><code id="foursail2b_+3A_rddbgr">rddbgr</code></td>
<td>
<p>: background bi-hemispherical diffuse reflectance (rdd)</p>
</td></tr>
<tr><td><code id="foursail2b_+3A_param">param</code></td>
<td>
<p>A named vector of 4SAIL2 parameter values (note:
program ignores case):
</p>

<ul>
<li><p> [1] = Leaf angle distribution function parameter a (LIDFa)
</p>
</li>
<li><p> [2] = Leaf angle distribution function parameter b (LIDFb)
</p>
</li>
<li><p> [3] = Leaf angle distribution function type (TypeLidf, see ?lidfFun)
</p>
</li>
<li><p> [4] = Total Leaf Area Index (LAI), including primary and secondary 
particles (brown and green leafs).
</p>
</li>
<li><p> [5] = fraction secondary particles (&quot;brown leaf fraction&quot;, fb)
</p>
</li>
<li><p> [6] = Canopy dissociation factor for secondary particles (&quot;diss&quot;)
</p>
</li>
<li><p> [7] = Hot spot effect parameter (hspot). Often defined as the
ratio of mean leaf width and canopy height.
</p>
</li>
<li><p> [7] = vertical crown coverage fraction (Cv), models clumping in combination
with parameter zeta. 
</p>
</li>
<li><p> [7] = tree shape factor (zeta), defined as the ratio of crown diameter and height.
</p>
</li>
<li><p> [6] = Solar zenith angle (tts)
</p>
</li>
<li><p> [7] = Observer zenith angle (tto)
</p>
</li>
<li><p> [8] = Sun-sensor azimuth angle (psi)
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra matrixwith 4 reflectance factors and canopy transmission 
for wavelengths 400 to 2500nm:
</p>

<ul>
<li><p> [1] = bi-hemispherical reflectance (rddt). White-sky albedo: the reflectance of the canopy
under diffuse illumination. The BRDF integrated over all viewing and illumination directions.
Diffuse reflectance for diffuse incidence.
</p>
</li>
<li><p> [2] = hemispherical directional reflectance (rsdt). Black-sky albedpo: reflectance of a surface
under direct light without a diffuse component. It is the integral of the BRDF over all viewing
directions. Diffuse reflectance for direct solar incidence.
</p>
</li>
<li><p> [3] = directional hemispherical reflectance (rdot). Diffuse reflectance in the vieweing
direction. 
</p>
</li>
<li><p> [4] = bi-directional reflectance (rsot). The ratio of reflected radiance in the viewing direction
to the incoming radiant flux in the solar direction. 
</p>
</li></ul>



<h3>References</h3>

<p>Zhang, Q., Xiao, X., Braswell, B., Linder, E., Baret, F., Moore, B. (2005).
Estimating light absorption by chlorophyll, leaf and canopy in a deciduous broadleaf forest
using MODIS data and a radiative transfer model. Remote Sens. Environ. 99, 357-371.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see ?foursail for lower-level implementations
fRTM(rho~prospectd+foursail2b)

</code></pre>

<hr>
<h2 id='fRTM'>Forward implementation of coupled Radiative Transfer Models.</h2><span id='topic+fRTM'></span>

<h3>Description</h3>

<p>Forward implementation of coupled Radiative Transfer Models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fRTM(fm = rho + tau ~ prospect5 + foursail, pars = NULL,
  wl = 400:2500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fRTM_+3A_fm">fm</code></td>
<td>
<p>A formula specifying which rtm to run</p>
</td></tr>
<tr><td><code id="fRTM_+3A_pars">pars</code></td>
<td>
<p>a list of _named_ parameter vectors for all models.
The parameter list for a model call as rho ~ prospect + foursail
therefore contains two named vectors the first with parameters for
prospect and the second with parameters for foursail 
if left empty default parameters are generated</p>
</td></tr>
<tr><td><code id="fRTM_+3A_wl">wl</code></td>
<td>
<p>wavelengths (in nm) add only if
certain wavelengths are required as output.
Input is expected to integers between 400 and 2500, or will 
be forced to be an integer. Integers outside the 400:2500 range
will not be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra matrix with reflectance (and transmission,
depending on the formula inputs). 
See seperate model helpfiles for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## setup graphics for plots 
oldpar&lt;-par()
par(mfrow=c(3,2))

## get reflectance for a leaf 
ref &lt;- fRTM(rho~prospect5)
plot(ref,main="Prospect 5")
     
## get reflectance and transmission for a leaf 
reftrans &lt;- fRTM(rho+tau~prospect5)
plot(reftrans,main="Prospect 5")
     
## get reflectance for a single layered canopy 
ref &lt;- fRTM(rho~prospect5+foursail)
plot(ref,main="Prospect 5 + 4SAIL")

## get reflectance for a 2 layered canopy with two leaf types 
ref &lt;- fRTM(rho~prospectd+prospect5+foursail2)
plot(ref,main="Prospect D + Prospect 5  + 4SAIL2")

## edit the parameters: sparse vegatation LAI 
parlist&lt;- list(prospect5=NULL,prospectd=NULL,foursail2=c(LAI=0.05))

## update reflectance
ref &lt;- fRTM(rho~prospect5+prospectd+foursail2,parlist)
plot(ref,main="LAI=0.05")

## change leaf area index to dense vegetation
parlist$foursail2["LAI"]&lt;-8.5

## update reflectance
ref &lt;- fRTM(rho~prospect5+prospectd+foursail2,parlist)
plot(ref,main="LAI=8.5")

par(oldpar)   
</code></pre>

<hr>
<h2 id='getDefaults'>S3- methods for Generate defaults settings and parameters
for all supported models.</h2><span id='topic+getDefaults'></span>

<h3>Description</h3>

<p>S3- methods for Generate defaults settings and parameters
for all supported models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDefaults(model = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDefaults_+3A_model">model</code></td>
<td>
<p>a ccrtm formula or character vector of modelnames</p>
</td></tr>
<tr><td><code id="getDefaults_+3A_...">...</code></td>
<td>
<p>not used.
(e.g. &quot;prospect5&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with default model parameters
</p>

<hr>
<h2 id='KLd'>Kullback-Lieber divergence function
D(spec1 || spec2) = sum(spec1 * log(spec1 / spec2))</h2><span id='topic+KLd'></span>

<h3>Description</h3>

<p>Kullback-Lieber divergence function
D(spec1 || spec2) = sum(spec1 * log(spec1 / spec2))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KLd(spec1, spec2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KLd_+3A_spec1">spec1</code></td>
<td>
<p>spectral signal 1</p>
</td></tr>
<tr><td><code id="KLd_+3A_spec2">spec2</code></td>
<td>
<p>spectral signal 2 at identical wavelengths</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the KL divergence between the vector inputs
</p>

<hr>
<h2 id='lidf'>Leaf inclination distribution models
s3 method for calling leaf models</h2><span id='topic+lidf'></span>

<h3>Description</h3>

<p>Leaf inclination distribution models
s3 method for calling leaf models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lidf(pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lidf_+3A_pars">pars</code></td>
<td>
<p>a parameter vector with a class 
lidf.[modelnumber]. Models include:
</p>

<ul>
<li><p> [1] = Dlagden distribution (1, lidf.1)
</p>
</li>
<li><p> [2] = Ellipsoid (Campebll) distribution (2, lidf.2)
</p>
</li>
<li><p> [3] = Beta distribution (3, lidf.3)
</p>
</li>
<li><p> [4] = One parameter beta distribution (4, lidf.4)
</p>
</li></ul>

<p>Models 1 and 2 are the standard models from the SAIL model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of proportions for each leaf angle calculated 
from each leaf inclination model
</p>

<hr>
<h2 id='plot.rtm.spectra'>Plot RTM return spectra vs. wavelength</h2><span id='topic+plot.rtm.spectra'></span>

<h3>Description</h3>

<p>Plot RTM return spectra vs. wavelength
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rtm.spectra'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.rtm.spectra_+3A_x">x</code></td>
<td>
<p>predictions from an RTM</p>
</td></tr>
<tr><td><code id="plot.rtm.spectra_+3A_...">...</code></td>
<td>
<p>additional plot arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plots to the device a ccrtm standard spectra plot based on 
the function call returned from fRTM.
</p>

<hr>
<h2 id='print.rtm.spectra'>Plot RTM return spectra vs. wavelength</h2><span id='topic+print.rtm.spectra'></span>

<h3>Description</h3>

<p>Plot RTM return spectra vs. wavelength
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rtm.spectra'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rtm.spectra_+3A_x">x</code></td>
<td>
<p>predictions from an RTM</p>
</td></tr>
<tr><td><code id="print.rtm.spectra_+3A_...">...</code></td>
<td>
<p>additional plot arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>prints the standard information from a simulated 
ccrtm spectra plot
</p>

<hr>
<h2 id='prospect5'>PROSPECT model version 5 and 5B</h2><span id='topic+prospect5'></span>

<h3>Description</h3>

<p>The PROSPECT5(b) leaf reflectance model. The model was implemented based on
Jacquemoud and Ustin (2019), and is further described in detail in Feret et al (2008).
PROSPECT models use the plate models developed in 
Allen (1969) and Stokes (1862). Set Cbrown to 0 for prospect version 5.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prospect5(param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prospect5_+3A_param">param</code></td>
<td>
<p>A named vector of PROSPECT parameters (note: program ignores case):
</p>

<ul>
<li><p> [1] = leaf structure parameter (N)
</p>
</li>
<li><p> [2] = chlorophyll a+b content in ug/cm2 (Cab)
</p>
</li>
<li><p> [3] = carotenoids content in ug/cm2 (Car)
</p>
</li>
<li><p> [4] = brown pigments content in arbitrary units (Cbrown)
</p>
</li>
<li><p> [5] = equivalent water thickness in g/cm2  (Cw)
</p>
</li>
<li><p> [6] = leaf dry matter content in g/cm2 - lma - (Cm)
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra matrix with leaf reflectance and transmission 
for wavelengths 400 to 2500nm:
</p>

<ul>
<li><p> [1] = leaf reflectance (rho)
</p>
</li>
<li><p> [2] = leaf transmission (tau)
</p>
</li></ul>



<h3>References</h3>

<p>Jacquemoud, S., and Ustin, S. (2019). Leaf optical properties. 
Cambridge University Press.
</p>
<p>Feret, J.B., Francois, C., Asner, G.P., Gitelson, A.A., 
Martin, R.E., Bidel, L.P.R., Ustin, S.L., le Maire, G., Jacquemoud, S. (2008),
PROSPECT-4 and 5: Advances in the leaf optical properties model separating photosynthetic 
pigments. Remote Sens. Environ. 112, 3030-3043.
</p>
<p>Allen W.A., Gausman H.W., Richardson A.J., Thomas J.R.
(1969), Interaction of isotropic ligth with a compact plant leaf,
Journal of the Optical Society of American, 59:1376-1379.
</p>
<p>Stokes G.G. (1862), On the intensity of the light
reflected from or transmitted through a pile of plates,
Proceedings of the Royal Society of London, 11:545-556.
</p>

<hr>
<h2 id='prospectd'>PROSPECT model version D</h2><span id='topic+prospectd'></span>

<h3>Description</h3>

<p>The PROSPECTD leaf reflectance model. The model was implemented based on
Jacquemoud and Ustin (2019), and is further described in detail in Feret et al (2017).
PROSPECT models use the plate models developed in 
Allen (1969) and Stokes (1862).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prospectd(param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prospectd_+3A_param">param</code></td>
<td>
<p>A named vector of PROSPECT parameters (note: program ignores case):
</p>

<ul>
<li><p> [1] = leaf structure parameter (N)
</p>
</li>
<li><p> [2] = chlorophyll a+b content in ug/cm2 (Cab)
</p>
</li>
<li><p> [3] = carotenoids content in ug/cm2 (Car)
</p>
</li>
<li><p> [4] = Leaf anthocyanin content (ug/cm2) (Canth)
</p>
</li>
<li><p> [5] = brown pigments content in arbitrary units (Cbrown)
</p>
</li>
<li><p> [6] = equivalent water thickness in g/cm2  (Cw)
</p>
</li>
<li><p> [7] = leaf dry matter content in g/cm2 - lma - (Cm)
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra matrix with leaf reflectance and transmission 
for wavelengths 400 to 2500nm:
</p>

<ul>
<li><p> [1] = leaf reflectance (rho)
</p>
</li>
<li><p> [2] = leaf transmission (tau)
</p>
</li></ul>



<h3>References</h3>

<p>Jacquemoud, S., and Ustin, S. (2019). Leaf optical properties. 
Cambridge University Press.
</p>
<p>Feret, J.B., Gitelson, A.A., Noble, S.D., Jacquemoud, S. (2017).
PROSPECT-D: Towards modeling leaf optical properties through a complete lifecycle. 
Remote Sens. Environ. 193, 204-215.
</p>
<p>Allen W.A., Gausman H.W., Richardson A.J., Thomas J.R.
(1969), Interaction of isotropic ligth with a compact plant leaf,
Journal of the Optical Society of American, 59:1376-1379.
</p>
<p>Stokes G.G. (1862), On the intensity of the light
reflected from or transmitted through a pile of plates,
Proceedings of the Royal Society of London, 11:545-556.
</p>

<hr>
<h2 id='r_foursail'>R implementation of foursail (pure R)</h2><span id='topic+r_foursail'></span>

<h3>Description</h3>

<p>The pure R version of foursail is included in the package as an easy
way to review the code, and to check more optimized versions against.
Model originally developed by Wout Verhoef.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r_foursail(rho, tau, bgr, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r_foursail_+3A_rho">rho</code></td>
<td>
<p>input leaf reflectance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="r_foursail_+3A_tau">tau</code></td>
<td>
<p>input leaf transmittance from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="r_foursail_+3A_bgr">bgr</code></td>
<td>
<p>background reflectance. Usual input is
soil reflectance spectra from 400-2500nm (can be measured or modeled)</p>
</td></tr>
<tr><td><code id="r_foursail_+3A_param">param</code></td>
<td>
<p>A named vector of SAIL parameter values (note: program ignores case):
</p>

<ul>
<li><p> [1] = Leaf angle distribution function parameter a (LIDFa)
</p>
</li>
<li><p> [2] = Leaf angle distribution function parameter b (LIDFb)
</p>
</li>
<li><p> [3] = Leaf angle distribution function type (see ?lidfFun)
</p>
</li>
<li><p> [4] = Leaf area index (LAI)
</p>
</li>
<li><p> [5] = Hot spot effect parameter (hspot) - The foliage hot spot size
parameter is equal to the ratio of the correlation length of leaf
projections in the horizontal plane and the canopy height (Verhoef &amp; Bach 2007).
</p>
</li>
<li><p> [6] = Solar zenith angle (tts)
</p>
</li>
<li><p> [7] = Observer zenith angle (tto)
</p>
</li>
<li><p> [8] = Sun-sensor azimuth angle (psi)
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra matrixwith 4 reflectance factors and canopy transmission 
for wavelengths 400 to 2500nm:
</p>

<ul>
<li><p> [1] = bi-hemispherical reflectance (rddt). White-sky albedo: the reflectance of the canopy
under diffuse illumination. The BRDF integrated over all viewing and illumination directions.  
</p>
</li>
<li><p> [2] = hemispherical directional reflectance (rsdt). Black-sky albedo: reflectance of a surface
under direct light without a diffuse component. It is the integral of the BRDF over all viewing
directions.
</p>
</li>
<li><p> [3] = directional hemispherical reflectance (rdot). Diffuse reflectance in the vieweing
direction. 
</p>
</li>
<li><p> [4] = bi-directional reflectance (rsot). The ratio of reflected radiance in the viewing direction
to the incoming radiant flux in the solar direction. 
</p>
</li>
<li><p> [5] = Canopy transmission of diffuse light through the canopy (taud).
</p>
</li>
<li><p> [6] = transmission of direct light through the canopy (taus).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Marco D. Visser (R implementation)
</p>

<hr>
<h2 id='sail_BDRF'>The SAIL BDRF function</h2><span id='topic+sail_BDRF'></span>

<h3>Description</h3>

<p>The SAIL BDRF function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sail_BDRF(w, lai, sumint, tsstoo, rsoil, rdd, tdd, tsd, rsd, tdo, rdo, tss,
  too, rsod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sail_BDRF_+3A_w">w</code></td>
<td>
<p>goemeric reflectance parameter</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_lai">lai</code></td>
<td>
<p>leaf area index</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_sumint">sumint</code></td>
<td>
<p>exp int</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_tsstoo">tsstoo</code></td>
<td>
<p>Bi-directional gap fraction</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_rsoil">rsoil</code></td>
<td>
<p>background reflectance</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_rdd">rdd</code></td>
<td>
<p>Bi-hemispherical reflectance over all in &amp; outgoing directions
(white-sky albedo).</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_tdd">tdd</code></td>
<td>
<p>Bi-hemispherical transmittance (diffuse transmittance in all directions)</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_tsd">tsd</code></td>
<td>
<p>Directional hemispherical transmittance for solar flux</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_rsd">rsd</code></td>
<td>
<p>Directional hemispherical reflectance for solar flux (diffuse solar angle)</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_tdo">tdo</code></td>
<td>
<p>Directional hemispherical transmittance (diffuse in viewing direction)</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_rdo">rdo</code></td>
<td>
<p>Directional hemispherical reflectance in viewing direction</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_tss">tss</code></td>
<td>
<p>Direct transmittance of solar flux</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_too">too</code></td>
<td>
<p>Direct transmittance in viewing direction</p>
</td></tr>
<tr><td><code id="sail_BDRF_+3A_rsod">rsod</code></td>
<td>
<p>Multi scattering contribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>spectra matrixwith 4 reflectance factors and canopy transmission 
for wavelengths 400 to 2500nm:
</p>

<ul>
<li><p> [1] = bi-hemispherical reflectance (rddt). White-sky albedo: the reflectance of the canopy
under diffuse illumination. The BRDF integrated over all viewing and illumination directions.  
</p>
</li>
<li><p> [2] = hemispherical directional reflectance (rsdt). Black-sky albedo: reflectance of a surface
under direct light without a diffuse component. It is the integral of the BRDF over all viewing
directions.
</p>
</li>
<li><p> [3] = directional hemispherical reflectance (rdot). Diffuse reflectance in the vieweing
direction. 
</p>
</li>
<li><p> [4] = bi-directional reflectance (rsot). The ratio of reflected radiance in the viewing direction
to the incoming radiant flux in the solar direction. 
</p>
</li>
<li><p> [5] = Canopy transmission of diffuse light through the canopy (taud).
</p>
</li>
<li><p> [6] = transmission of direct light through the canopy (taus).
</p>
</li></ul>


<hr>
<h2 id='skyl'>Sky light model</h2><span id='topic+skyl'></span>

<h3>Description</h3>

<p>Simple atmospherical model that builds on recommendations
from Francois et al. (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skyl(rddt, rsdt, rdot, rsot, Es, Ed, tts, skyl = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skyl_+3A_rddt">rddt</code></td>
<td>
<p>Bi-hemispherical reflectance</p>
</td></tr>
<tr><td><code id="skyl_+3A_rsdt">rsdt</code></td>
<td>
<p>Directional-hemispherical reflectance for
solar incident flux</p>
</td></tr>
<tr><td><code id="skyl_+3A_rdot">rdot</code></td>
<td>
<p>Hemispherical-directional reflectance in viewing direction</p>
</td></tr>
<tr><td><code id="skyl_+3A_rsot">rsot</code></td>
<td>
<p>Bi-directional reflectance factor</p>
</td></tr>
<tr><td><code id="skyl_+3A_es">Es</code></td>
<td>
<p>Solar flux</p>
</td></tr>
<tr><td><code id="skyl_+3A_ed">Ed</code></td>
<td>
<p>Diffuse flux</p>
</td></tr>
<tr><td><code id="skyl_+3A_tts">tts</code></td>
<td>
<p>solar angle</p>
</td></tr>
<tr><td><code id="skyl_+3A_skyl">skyl</code></td>
<td>
<p>fraction diffuse</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with hemispherical and directional reflectance.
rt&lt;-fRTM(rho~prospect5+foursail)
skyl(rt[,&quot;rddt&quot;],rt[,&quot;rsdt&quot;],rt[,&quot;rdot&quot;],rt[,&quot;rsot&quot;],
Es=solar[,1],Ed=solar[,2],tts=45,skyl=NULL)
</p>


<h3>References</h3>

<p>Francois, C., Ottle, C., Olioso, A., Prevot, L., Bruguier, N., 
Ducros, Y.(2002). Conversion of 400-1100 nm vegetation albedo measurements 
into total shortwave broadband albedo using a canopy radiative transfer model. 
Agronomie 22, 611-618.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(solar)
</code></pre>

<hr>
<h2 id='soil'>soil reflectance</h2><span id='topic+soil'></span>

<h3>Description</h3>

<p>soil reflectance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(soil)
</code></pre>


<h3>details</h3>

<p>***********************************************************************
</p>

<ul>
<li><p> [1] = wet soil
</p>
</li>
<li><p> [2] = dry soil 
</p>
</li></ul>



<h3>references</h3>

<p>Feret et al. (2008), PROSPECT-4 and 5: Advances in the Leaf Optical
Properties Model Separating Photosynthetic Pigments, Remote Sensing of
Environment
</p>

<hr>
<h2 id='solar'>direct and diffuse light</h2><span id='topic+solar'></span>

<h3>Description</h3>

<p>direct and diffuse light
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(solar)
</code></pre>


<h3>details</h3>

<p>***********************************************************************
</p>

<ul>
<li><p> [1] = direct light
</p>
</li>
<li><p> [2] = diffuse light
</p>
</li></ul>



<h3>references</h3>

<p>Feret et al. (2008), PROSPECT-4 and 5: Advances in the Leaf Optical
Properties Model Separating Photosynthetic Pigments, Remote Sensing of
Environment
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
