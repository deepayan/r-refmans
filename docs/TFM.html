<!DOCTYPE html><html lang="en-US"><head><title>Help for package TFM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TFM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FanPC_TFM'><p>Apply the FanPC method to the Truncated factor model</p></a></li>
<li><a href='#GulPC_TFM'><p>Apply the GulPC method to the Truncated factor model</p></a></li>
<li><a href='#IPC_TFM'><p>Incremental Principal Component Analysis</p></a></li>
<li><a href='#OPC_TFM'><p>Apply the OPC method to the Truncated factor model</p></a></li>
<li><a href='#PC1_TFM'><p>Apply the PC method to the Truncated factor model</p></a></li>
<li><a href='#PC2_TFM'><p>Apply the PC method to the Truncated factor model</p></a></li>
<li><a href='#PPC1_TFM'><p>Projected Principal Component Analysis</p></a></li>
<li><a href='#PPC2_TFM'><p>Apply the PPC method to the Truncated factor model</p></a></li>
<li><a href='#SAPC_TFM'><p>Stochastic Approximation Principal Component Analysis</p></a></li>
<li><a href='#SOPC_TFM'><p>Sparse Online Principal Component Analysis</p></a></li>
<li><a href='#SPC_TFM'><p>Sparse Principal Component Analysis</p></a></li>
<li><a href='#TFM'><p>The TFM function is to generate Truncated factor model data.</p></a></li>
<li><a href='#ttest.TFM'><p>T-test for Truncated Factor Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sparse Online Principal Component for Truncated Factor Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>The Truncated Factor Model is a statistical model designed to handle specific data structures in data analysis. This R package focuses on the Sparse Online Principal Component Estimation method, which is used to calculate data such as the loading matrix and specific variance matrix for truncated data, thereby better explaining the relationship between common factors and original variables. Additionally, the R package also provides other equations for comparison with the Sparse Online Principal Component Estimation method.The philosophy of the package is described in thesis. (2023) &lt;<a href="https://doi.org/10.1007%2Fs00180-022-01270-z">doi:10.1007/s00180-022-01270-z</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, psych</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Author:</td>
<td>Beibei Wu [aut],
  Guangbao Guo [aut, cre]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guangbao Guo &lt;ggb11111111@163.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>relliptical, SOPC, MASS, mvtnorm, matrixcalc</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-25 11:04:51 UTC; 14218</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-26 00:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='FanPC_TFM'>Apply the FanPC method to the Truncated factor model</h2><span id='topic+FanPC_TFM'></span>

<h3>Description</h3>

<p>This function performs Factor Analysis via Principal Component (FanPC) on a given data set. It calculates the estimated factor loading matrix (AF), specific variance matrix (DF), and the mean squared errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FanPC_TFM(data, m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FanPC_TFM_+3A_data">data</code></td>
<td>
<p>A matrix of input data.</p>
</td></tr>
<tr><td><code id="FanPC_TFM_+3A_m">m</code></td>
<td>
<p>The number of principal components.</p>
</td></tr>
<tr><td><code id="FanPC_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="FanPC_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="FanPC_TFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>AF</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>DF</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SOPC)
library(relliptical)
library(MASS)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
trnor &lt;- relliptical(n*p,0,1)
epsilon=matrix(trnor,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- FanPC_TFM(data, m, A, D, p)
print(results)

## End(Not run)
</code></pre>

<hr>
<h2 id='GulPC_TFM'>Apply the GulPC method to the Truncated factor model</h2><span id='topic+GulPC_TFM'></span>

<h3>Description</h3>

<p>This function performs General Unilateral Loading Principal Component (GulPC) analysis on a given data set. It calculates the estimated values for the first layer and second layer loadings, specific variances, and the mean squared errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GulPC_TFM(data, m, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GulPC_TFM_+3A_data">data</code></td>
<td>
<p>A matrix of input data.</p>
</td></tr>
<tr><td><code id="GulPC_TFM_+3A_m">m</code></td>
<td>
<p>The number of principal components.</p>
</td></tr>
<tr><td><code id="GulPC_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="GulPC_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>AU1</code></td>
<td>
<p>The first layer loading matrix.</p>
</td></tr>
<tr><td><code>AU2</code></td>
<td>
<p>The second layer loading matrix.</p>
</td></tr>
<tr><td><code>DU3</code></td>
<td>
<p>The estimated specific variance matrix.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SOPC)
library(relliptical)
library(MASS)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
trnor &lt;- relliptical(n*p,0,1)
epsilon=matrix(trnor,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- GulPC_TFM(data, m, A, D)
print(results)
## End(Not run)
</code></pre>

<hr>
<h2 id='IPC_TFM'>Incremental Principal Component Analysis</h2><span id='topic+IPC_TFM'></span>

<h3>Description</h3>

<p>This function performs Incremental Principal Component Analysis (IPC) on the provided data. It updates the estimated factor loadings and uniquenesses as new data points are processed, calculating mean squared errors and loss metrics for comparison with true values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPC_TFM(x, m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPC_TFM_+3A_x">x</code></td>
<td>
<p>The data used in the IPC analysis.</p>
</td></tr>
<tr><td><code id="IPC_TFM_+3A_m">m</code></td>
<td>
<p>The number of common factors.</p>
</td></tr>
<tr><td><code id="IPC_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="IPC_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="IPC_TFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of metrics including:
</p>
<table role = "presentation">
<tr><td><code>Ai</code></td>
<td>
<p>Estimated factor loadings updated during the IPC analysis, a matrix of estimated factor loadings.</p>
</td></tr>
<tr><td><code>Di</code></td>
<td>
<p>Estimated uniquenesses updated during the IPC analysis, a vector of estimated uniquenesses corresponding to each variable.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error of the estimated factor loadings (Ai) compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error of the estimated uniquenesses (Di) compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for the estimated factor loadings (Ai), indicating the relative error compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for the estimated uniquenesses (Di), indicating the relative error compared to the true uniquenesses (D).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
library(relliptical)
library(SOPC)

IPC_MSESigmaA = c()
IPC_MSESigmaD = c()
IPC_LSigmaA = c()
IPC_LSigmaD = c()

p = 10
m = 5

n = 2000
mu = t(matrix(rep(runif(p, 0, 1000), n), p, n))
mu0 = as.matrix(runif(m, 0))
sigma0 = diag(runif(m, 1))
F = matrix(mvrnorm(n, mu0, sigma0), nrow = n)
A = matrix(runif(p * m, -1, 1), nrow = p)

lower = c(rep(-0.5, p - 3), -5, -5, -Inf)
upper = c(rep(0.5, p - 3), 5, 5, Inf)
Sigma = as.matrix(diag(rep(runif(p, 0, 1))))
mut = runif(p, 0, 10)
trnor = rtelliptical(n, mut, Sigma, lower, upper, dist = "Normal")
epsilon = matrix(trnor, nrow = n)

D = Sigma
data = mu + F %*% t(A) + epsilon

Z = data.frame(IPC_TFM(data, m = m, A = A, D = D, p = p))[c(3, 4, 5, 6),]
IPC_MSESigmaA = Z[1]
IPC_MSESigmaD = Z[2]
IPC_LSigmaA = Z[3]
IPC_LSigmaD = Z[4]

data_M = data.frame(n = n, MSEA = IPC_MSESigmaA, MSED = IPC_MSESigmaD,
 LSA = IPC_LSigmaA, LSD = IPC_LSigmaD)
print(data_M)


</code></pre>

<hr>
<h2 id='OPC_TFM'>Apply the OPC method to the Truncated factor model</h2><span id='topic+OPC_TFM'></span>

<h3>Description</h3>

<p>This function computes Online Principal Component Analysis (OPC) for the provided input data, estimating factor loadings and uniquenesses. It calculates mean squared errors and sparsity for the estimated values compared to true values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OPC_TFM(data, m = m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OPC_TFM_+3A_data">data</code></td>
<td>
<p>A matrix of input data.</p>
</td></tr>
<tr><td><code id="OPC_TFM_+3A_m">m</code></td>
<td>
<p>The number of principal components.</p>
</td></tr>
<tr><td><code id="OPC_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="OPC_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="OPC_TFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>Ao</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>Do</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSEA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSED</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>The sparsity.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SOPC)
library(relliptical)
library(MASS)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
trnor &lt;- relliptical(n*p,0,1)
epsilon=matrix(trnor,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- OPC_TFM(data, m, A, D, p)
print(results)
## End(Not run)
</code></pre>

<hr>
<h2 id='PC1_TFM'>Apply the PC method to the Truncated factor model</h2><span id='topic+PC1_TFM'></span>

<h3>Description</h3>

<p>This function performs Principal Component Analysis (PCA) on a given data set to reduce dimensionality. It calculates the estimated values for the loadings, specific variances, and the covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PC1_TFM(data, m, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PC1_TFM_+3A_data">data</code></td>
<td>
<p>The total data set to be analyzed.</p>
</td></tr>
<tr><td><code id="PC1_TFM_+3A_m">m</code></td>
<td>
<p>The number of principal components to retain in the analysis.</p>
</td></tr>
<tr><td><code id="PC1_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="PC1_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>A1</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>D1</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SOPC)
library(relliptical)
library(MASS)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
trnor &lt;- relliptical(n*p,0,1)
epsilon=matrix(trnor,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- PC1_TFM(data, m, A, D)
print(results)
## End(Not run)
</code></pre>

<hr>
<h2 id='PC2_TFM'>Apply the PC method to the Truncated factor model</h2><span id='topic+PC2_TFM'></span>

<h3>Description</h3>

<p>This function performs Principal Component Analysis (PCA) on a given data set to reduce dimensionality. It calculates the estimated values for the loadings, specific variances, and the covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PC2_TFM(data, m, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PC2_TFM_+3A_data">data</code></td>
<td>
<p>The total data set to be analyzed.</p>
</td></tr>
<tr><td><code id="PC2_TFM_+3A_m">m</code></td>
<td>
<p>The number of principal components to retain in the analysis.</p>
</td></tr>
<tr><td><code id="PC2_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="PC2_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>A2</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>D2</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SOPC)
library(relliptical)
library(MASS)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
lanor &lt;- rlaplace(n*p,0,1)
epsilon=matrix(lanor,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- PC2_TFM(data, m, A, D)
print(results)
## End(Not run)
</code></pre>

<hr>
<h2 id='PPC1_TFM'>Projected Principal Component Analysis</h2><span id='topic+PPC1_TFM'></span>

<h3>Description</h3>

<p>This function computes Projected Principal Component Analysis (PPC) for the provided input data, estimating factor loadings and uniquenesses. It calculates mean squared errors and loss metrics for the estimated values compared to true values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PPC1_TFM(x, m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PPC1_TFM_+3A_x">x</code></td>
<td>
<p>A matrix of input data.</p>
</td></tr>
<tr><td><code id="PPC1_TFM_+3A_m">m</code></td>
<td>
<p>The number of principal components to extract (integer).</p>
</td></tr>
<tr><td><code id="PPC1_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix (matrix).</p>
</td></tr>
<tr><td><code id="PPC1_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix (matrix).</p>
</td></tr>
<tr><td><code id="PPC1_TFM_+3A_p">p</code></td>
<td>
<p>The number of variables (integer).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>Ap</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>Dp</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
library(relliptical)
library(SOPC)

PPC_MSESigmaA &lt;- c()
PPC_MSESigmaD &lt;- c()
PPC_LSigmaA &lt;- c()
PPC_LSigmaD &lt;- c()

p &lt;- 10
m &lt;- 5
n &lt;- 2000

mu &lt;- t(matrix(rep(runif(p, 0, 1000), n), p, n))
mu0 &lt;- as.matrix(runif(m, 0))
sigma0 &lt;- diag(runif(m, 1))
F &lt;- matrix(mvrnorm(n, mu0, sigma0), nrow = n)
A &lt;- matrix(runif(p * m, -1, 1), nrow = p)

lower &lt;- c(rep(-0.5, p - 3), -5, -5, -Inf)
upper &lt;- c(rep(0.5, p - 3), 5, 5, Inf)
Sigma &lt;- diag(runif(p, 0, 1))
mut &lt;- runif(p, 0, 10)

trnor &lt;- rtelliptical(n, mut, Sigma, lower, upper, dist = "Normal")
epsilon &lt;- matrix(trnor, nrow = n)
D &lt;- Sigma

data &lt;- mu + F %*% t(A) + epsilon

result &lt;- PPC1_TFM(data, m, A, D, p)

data_G &lt;- data.frame(n = n,
                     MSEA = result$MSESigmaA,
                     MSED = result$MSESigmaD,
                     LSA = result$LSigmaA,
                     LSD = result$LSigmaD)

print(data_G)
</code></pre>

<hr>
<h2 id='PPC2_TFM'>Apply the PPC method to the Truncated factor model</h2><span id='topic+PPC2_TFM'></span>

<h3>Description</h3>

<p>This function performs Projected Principal Component Analysis (PPC) on a given data set to reduce dimensionality. It calculates the estimated values for the loadings, specific variances, and the covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PPC2_TFM(data, m, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PPC2_TFM_+3A_data">data</code></td>
<td>
<p>The total data set to be analyzed.</p>
</td></tr>
<tr><td><code id="PPC2_TFM_+3A_m">m</code></td>
<td>
<p>The number of principal components.</p>
</td></tr>
<tr><td><code id="PPC2_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="PPC2_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>Ap2</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>Dp2</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(SOPC)
library(relliptical)
library(MASS)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
trnor &lt;- relliptical(n*p,0,1)
epsilon=matrix(trnor,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- PPC2_TFM(data, m, A, D)
print(results)

## End(Not run)
</code></pre>

<hr>
<h2 id='SAPC_TFM'>Stochastic Approximation Principal Component Analysis</h2><span id='topic+SAPC_TFM'></span>

<h3>Description</h3>

<p>This function calculates several metrics for the SAPC method,
including the estimated factor loadings and uniquenesses, and various
error metrics comparing the estimated matrices with the true matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAPC_TFM(x, m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SAPC_TFM_+3A_x">x</code></td>
<td>
<p>The data used in the SAPC analysis.</p>
</td></tr>
<tr><td><code id="SAPC_TFM_+3A_m">m</code></td>
<td>
<p>The number of common factors.</p>
</td></tr>
<tr><td><code id="SAPC_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="SAPC_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="SAPC_TFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of metrics including:
</p>
<table role = "presentation">
<tr><td><code>Asa</code></td>
<td>
<p>Estimated factor loadings matrix obtained from the SAPC analysis.</p>
</td></tr>
<tr><td><code>Dsa</code></td>
<td>
<p>Estimated uniquenesses vector obtained from the SAPC analysis.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error of the estimated factor loadings (Asa) compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error of the estimated uniquenesses (Dsa) compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for the estimated factor loadings (Asa), indicating the relative error compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for the estimated uniquenesses (Dsa), indicating the relative error compared to the true uniquenesses (D).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
library(relliptical)
library(SOPC)

SAPC_MSESigmaA &lt;- c()
SAPC_MSESigmaD &lt;- c()
SAPC_LSigmaA &lt;- c()
SAPC_LSigmaD &lt;- c()

p &lt;- 10
m &lt;- 5
n &lt;- 2000

mu &lt;- t(matrix(rep(runif(p, 0, 1000), n), p, n))
mu0 &lt;- as.matrix(runif(m, 0))
sigma0 &lt;- diag(runif(m, 1))
F &lt;- matrix(mvrnorm(n, mu0, sigma0), nrow = n)
A &lt;- matrix(runif(p * m, -1, 1), nrow = p)

lower &lt;- c(rep(-0.5, p - 3), -5, -5, -Inf)
upper &lt;- c(rep(0.5, p - 3), 5, 5, Inf)
Sigma &lt;- diag(runif(p, 0, 1))
mut &lt;- runif(p, 0, 10)
trnor &lt;- rtelliptical(n, mut, Sigma, lower, upper, dist = "Normal")
epsilon &lt;- matrix(trnor, nrow = n)
D &lt;- Sigma

data &lt;- mu + F %*% t(A) + epsilon

result &lt;- SAPC_TFM(data, m = m, A = A, D = D, p = p)

SAPC_MSESigmaA &lt;- result$MSESigmaA
SAPC_MSESigmaD &lt;- result$MSESigmaD
SAPC_LSigmaA &lt;- result$LSigmaA
SAPC_LSigmaD &lt;- result$LSigmaD

data_K &lt;- data.frame(
  n = n,
  MSEA = SAPC_MSESigmaA,
  MSED = SAPC_MSESigmaD,
  LSA = SAPC_LSigmaA,
  LSD = SAPC_LSigmaD
)

print(data_K)
</code></pre>

<hr>
<h2 id='SOPC_TFM'>Sparse Online Principal Component Analysis</h2><span id='topic+SOPC_TFM'></span>

<h3>Description</h3>

<p>This function calculates various metrics for the Sparse Online Principal Component Analysis (SOPC) method. It estimates the factor loadings and uniquenesses while calculating mean squared errors and loss metrics for comparison with true values. Additionally, it computes the proportion of zero factor loadings in the estimated loadings matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SOPC_TFM(data, m, p, gamma, eta, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SOPC_TFM_+3A_data">data</code></td>
<td>
<p>The data used in the SOPC analysis.</p>
</td></tr>
<tr><td><code id="SOPC_TFM_+3A_m">m</code></td>
<td>
<p>the number of common factors</p>
</td></tr>
<tr><td><code id="SOPC_TFM_+3A_p">p</code></td>
<td>
<p>the number of variables</p>
</td></tr>
<tr><td><code id="SOPC_TFM_+3A_gamma">gamma</code></td>
<td>
<p>Tuning parameter for the sparseness of the loadings matrix.</p>
</td></tr>
<tr><td><code id="SOPC_TFM_+3A_eta">eta</code></td>
<td>
<p>Tuning parameter for the sparseness of the uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="SOPC_TFM_+3A_a">A</code></td>
<td>
<p>The true A matrix.</p>
</td></tr>
<tr><td><code id="SOPC_TFM_+3A_d">D</code></td>
<td>
<p>The true D matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of metrics including:
</p>
<table role = "presentation">
<tr><td><code>Aso</code></td>
<td>
<p>Estimated factor loadings matrix obtained from the SOPC analysis.</p>
</td></tr>
<tr><td><code>Dso</code></td>
<td>
<p>Estimated uniquenesses vector obtained from the SOPC analysis.</p>
</td></tr>
<tr><td><code>MSEA</code></td>
<td>
<p>Mean squared error of the estimated factor loadings (Aso) compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>MSED</code></td>
<td>
<p>Mean squared error of the estimated uniquenesses (Dso) compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>LSA</code></td>
<td>
<p>Loss metric for the estimated factor loadings (Aso), indicating the relative error compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>LSD</code></td>
<td>
<p>Loss metric for the estimated uniquenesses (Dso), indicating the relative error compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>tauA</code></td>
<td>
<p>Proportion of zero factor loadings in the estimated loadings matrix (Aso), indicating the sparsity of the loadings.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
library(relliptical)
library(SOPC)

SOPC_MSEA &lt;- c()
SOPC_MSED &lt;- c()
SOPC_LSA &lt;- c()
SOPC_LSD &lt;- c()
SOPC_TAUA &lt;- c()

p = 10; m = 5
n = 2000  # Set n to 2000
mu = t(matrix(rep(runif(p, 0, 1000), n), p, n))
mu0 = as.matrix(runif(m, 0))
sigma0 = diag(runif(m, 1))
F = matrix(mvrnorm(n, mu0, sigma0), nrow = n)
A = matrix(runif(p * m, -1, 1), nrow = p)

# Sampling from the Truncated Normal distribution
lower = c(rep(-0.5, p - 3), -5, -5, -Inf)
upper = c(rep(0.5, p - 3), 5, 5, Inf)
Sigma = as.matrix(diag(rep(runif(p, 0, 1))))
mut = runif(p, 0, 10)
trnor = rtelliptical(n, mut, Sigma, lower, upper, dist = "Normal")
epsilon = matrix(trnor, nrow = n)
D = Sigma

data = mu + F %*% t(A) + epsilon

Z = data.frame(SOPC_TFM(data, m = m, p = p, gamma = 0.1, eta = 0.8, A = A, D = D))
SOPC_MSEA = c(SOPC_MSEA, Z$MSEA)
SOPC_MSED = c(SOPC_MSED, Z$MSED)
SOPC_LSA = c(SOPC_LSA, Z$LSA)
SOPC_LSD = c(SOPC_LSD, Z$LSD)
SOPC_TAUA = c(SOPC_TAUA, Z$tauA)

# Ensure the data frame has the correct column structure, even with one value
data_F = data.frame(n = rep(n, length(SOPC_MSEA)), MSEA = SOPC_MSEA, MSED = SOPC_MSED,
 LSA = SOPC_LSA, LSD = SOPC_LSD, tauA = SOPC_TAUA)
data_F

</code></pre>

<hr>
<h2 id='SPC_TFM'>Sparse Principal Component Analysis</h2><span id='topic+SPC_TFM'></span>

<h3>Description</h3>

<p>This function performs Sparse Principal Component Analysis (SPC) on the input data. It estimates factor loadings and uniquenesses while calculating mean squared errors and loss metrics for comparison with true values. Additionally, it computes the proportion of zero factor loadings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPC_TFM(data, A, D, m, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SPC_TFM_+3A_data">data</code></td>
<td>
<p>The data used in the SPC analysis.</p>
</td></tr>
<tr><td><code id="SPC_TFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="SPC_TFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="SPC_TFM_+3A_m">m</code></td>
<td>
<p>The number of common factors.</p>
</td></tr>
<tr><td><code id="SPC_TFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>As</code></td>
<td>
<p>Estimated factor loadings, a matrix of estimated factor loadings from the SPC analysis.</p>
</td></tr>
<tr><td><code>Ds</code></td>
<td>
<p>Estimated uniquenesses, a vector of estimated uniquenesses corresponding to each variable.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error of the estimated factor loadings (As) compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error of the estimated uniquenesses (Ds) compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for the estimated factor loadings (As), indicating the relative error compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for the estimated uniquenesses (Ds), indicating the relative error compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Proportion of zero factor loadings in the estimated loadings matrix (As).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
library(relliptical)
library(SOPC)

SPC_MSESigmaA &lt;- c()
SPC_MSESigmaD &lt;- c()
SPC_LSigmaA &lt;- c()
SPC_LSigmaD &lt;- c()
SPC_tau &lt;- c()

p &lt;- 10
m &lt;- 5
n &lt;- 2000

mu &lt;- t(matrix(rep(runif(p, 0, 1000), n), p, n))
mu0 &lt;- as.matrix(runif(m, 0))
sigma0 &lt;- diag(runif(m, 1))
F &lt;- matrix(mvrnorm(n, mu0, sigma0), nrow = n)
A &lt;- matrix(runif(p * m, -1, 1), nrow = p)

lower &lt;- c(rep(-0.5, p - 3), -5, -5, -Inf)
upper &lt;- c(rep(0.5, p - 3), 5, 5, Inf)
Sigma &lt;- diag(runif(p, 0, 1))
mut &lt;- runif(p, 0, 10)

trnor &lt;- rtelliptical(n, mut, Sigma, lower, upper, dist = "Normal")
epsilon &lt;- matrix(trnor, nrow = n)
D &lt;- Sigma

data &lt;- mu + F %*% t(A) + epsilon

result &lt;- SPC_TFM(data, A, D, m, p)

SPC_MSESigmaA &lt;- c(SPC_MSESigmaA, result$MSESigmaA)
SPC_MSESigmaD &lt;- c(SPC_MSESigmaD, result$MSESigmaD)
SPC_LSigmaA &lt;- c(SPC_LSigmaA, result$LSigmaA)
SPC_LSigmaD &lt;- c(SPC_LSigmaD, result$LSigmaD)
SPC_tau &lt;- c(SPC_tau, result$tau)

data_G &lt;- data.frame(n = n,
                     MSEA = SPC_MSESigmaA,
                     MSED = SPC_MSESigmaD,
                     LSA = SPC_LSigmaA,
                     LSD = SPC_LSigmaD,
                     tau = SPC_tau)

print(data_G)
</code></pre>

<hr>
<h2 id='TFM'>The TFM function is to generate Truncated factor model data.</h2><span id='topic+TFM'></span>

<h3>Description</h3>

<p>The TFM function generates truncated factor model data supporting various distribution types for related analyses using multiple methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TFM(n, mu, sigma, lower, upper, distribution_type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TFM_+3A_n">n</code></td>
<td>
<p>Total number of observations.</p>
</td></tr>
<tr><td><code id="TFM_+3A_mu">mu</code></td>
<td>
<p>The mean of the distribution.</p>
</td></tr>
<tr><td><code id="TFM_+3A_sigma">sigma</code></td>
<td>
<p>The parameter of the distribution.</p>
</td></tr>
<tr><td><code id="TFM_+3A_lower">lower</code></td>
<td>
<p>The lower bound of the interval.</p>
</td></tr>
<tr><td><code id="TFM_+3A_upper">upper</code></td>
<td>
<p>The upper bound of the interval.</p>
</td></tr>
<tr><td><code id="TFM_+3A_distribution_type">distribution_type</code></td>
<td>
<p>String specifying the distribution type to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>A matrix of generated truncated factor model data based on the specified distribution type. Each row corresponds to an observation, and each column corresponds to a variable.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(relliptical)
set.seed(123)
mu &lt;- c(0, 1)
n &lt;- 100
sigma &lt;- matrix(c(1, 0.70, 0.70, 3), 2, 2)
lower &lt;- c(-2, -3)
upper &lt;- c(3, 3)
distribution_type &lt;- "truncated_normal"
X &lt;- TFM(n, mu, sigma, lower, upper, distribution_type)
</code></pre>

<hr>
<h2 id='ttest.TFM'>T-test for Truncated Factor Model</h2><span id='topic+ttest.TFM'></span>

<h3>Description</h3>

<p>This function performs a simple t-test for each variable in the dataset of a truncated factor model and calculates the False Discovery Rate (FDR) and power.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ttest.TFM(X, p, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttest.TFM_+3A_x">X</code></td>
<td>
<p>A matrix or data frame of simulated or observed data from a truncated factor model.</p>
</td></tr>
<tr><td><code id="ttest.TFM_+3A_p">p</code></td>
<td>
<p>The number of variables (columns) in the dataset.</p>
</td></tr>
<tr><td><code id="ttest.TFM_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for the t-test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>FDR</code></td>
<td>
<p>The False Discovery Rate calculated from the rejected hypotheses.</p>
</td></tr>
<tr><td><code>Power</code></td>
<td>
<p>The power of the test, representing the proportion of true positives among the non-zero hypotheses.</p>
</td></tr>
<tr><td><code>pValues</code></td>
<td>
<p>A numeric vector of p-values obtained from the t-tests for each variable.</p>
</td></tr>
<tr><td><code>RejectedHypotheses</code></td>
<td>
<p>A logical vector indicating which hypotheses were rejected based on the specified significance level.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Load necessary libraries
library(MASS)
library(mvtnorm)

set.seed(100)
# Set parameters for the simulation
p &lt;- 400  # Number of features
n &lt;- 120  # Number of samples
K &lt;- 5    # Number of latent factors
true_non_zero &lt;- 100  # Assume 100 features have non-zero means

# Simulate factor loadings matrix B (p x K)
B &lt;- matrix(rnorm(p * K), nrow = p, ncol = K)

# Simulate factor scores (n x K)
FX &lt;- MASS::mvrnorm(n, rep(0, K), diag(K))

# Simulate noise U (n x p), assuming Student's t-distribution with 3 degrees of freedom
U &lt;- mvtnorm::rmvt(n, df = 3, sigma = diag(p))

# Create the data matrix X based on the truncated factor model
# Non-zero means for the first 100 features
mu &lt;- c(rep(1, true_non_zero), rep(0, p - true_non_zero))
X &lt;- rep(1, n) %*% t(mu) + FX %*% t(B) + U  # The observed data

# Apply the t-test function on the data
results &lt;- ttest.TFM(X, p, alpha = 0.05)

# Print the results
print(results)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
