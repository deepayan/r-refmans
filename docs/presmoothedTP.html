<!DOCTYPE html><html lang="en"><head><title>Help for package presmoothedTP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {presmoothedTP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#colonMSM'><p>Chemotherapy for Stage B/C colon cancer.</p></a></li>
<li><a href='#data'><p>data</p></a></li>
<li><a href='#ebmt4'><p>Data from the European Society for Blood and Marrow Transplantation (EBMT).</p></a></li>
<li><a href='#prepTP'><p>Function to prepare data set for multi-state modeling in long format from</p>
data set in wide format.</a></li>
<li><a href='#presmoothTP'><p>This function implements presmoothed estimates based on the landmark</p>
Aalen-Johansen method for non-parametric estimation of transition
probabilities in non-Markov
multi-state models.</a></li>
<li><a href='#prothr'><p>Liver cirrhosis data - Abnormal prothrombin levels in liver cirrhosis.</p></a></li>
<li><a href='#transTP'><p>Define transition matrix for multi-state model.</p></a></li>
<li><a href='#unsmoothTP'><p>This function implements unsmoothed estimates of from the Aalen-Johansen</p>
estimator (AJ) and landmark Aalen-Johansen method of Putter &amp; Spitoni (2016)
for non-parametric estimation of transition probabilities in non-Markov
multi-state models.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Presmoothed Landmark Aalen-Johansen Estimator of Transition
Probabilities for Complex Multi-State Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Multi-state models are essential tools in longitudinal data analysis. 
             One primary goal of these models is the estimation of transition 
             probabilities, a critical metric for predicting clinical prognosis 
             across various stages of diseases or medical conditions. Traditionally, 
             inference in multi-state models relies on the Aalen-Johansen (AJ) 
             estimator which is consistent under the Markov assumption. However, 
             in many practical applications, the Markovian nature of the process
             is often not guaranteed, limiting the applicability of the AJ
             estimator in more complex scenarios. This package extends the landmark Aalen-Johansen
             estimator (Putter, H, Spitoni, C (2018) &lt;<a href="https://doi.org/10.1177%2F0962280216674497">doi:10.1177/0962280216674497</a>&gt;)
             incorporating presmoothing techniques described by Soutinho, 
             Meira-Machado and Oliveira (2020) &lt;<a href="https://doi.org/10.1080%2F03610918.2020.1762895">doi:10.1080/03610918.2020.1762895</a>&gt;, 
             offering a robust alternative for estimating transition probabilities
             in non-Markovian multi-state models with multiple states and potential
             reversible transitions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, mstate, plyr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-20 21:07:03 UTC; AEFH</td>
</tr>
<tr>
<td>Author:</td>
<td>Gustavo Soutinho <a href="https://orcid.org/0000-0002-0559-1327"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Luis Meira-Machado
    <a href="https://orcid.org/0000-0002-8577-7665"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gustavo Soutinho &lt;gustavosoutinho@sapo.pt&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-22 17:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='colonMSM'>Chemotherapy for Stage B/C colon cancer.</h2><span id='topic+colonMSM'></span>

<h3>Description</h3>

<p>These are data from one of the first successful trials of adjuvant chemotherapy for colon cancer. Levamisole is a low-toxicity compound previously used to treat worm infestations in animals; 5-FU is a moderately toxic (as these things go) chemotherapy agent. </p>


<h3>Usage</h3>

<pre><code class='language-R'>data("colonMSM")</code></pre>


<h3>Format</h3>

<p>A data frame with 929 observations on the following 15 variables.
Below a brief description is given for some of these variables.
</p>

<dl>
<dt>time1</dt><dd><p>Time to recurrence/censoring/death, whichever occurs first.</p>
</dd>
<dt>event1</dt><dd><p>Recurrence/censoring indicator (recurrence=1, alive=0).</p>
</dd>
<dt>Stime</dt><dd><p>Time to censoring/death, whichever occurs first.</p>
</dd>
<dt>event</dt><dd><p>Death/censoring indicator (death=1, alive=0).</p>
</dd>
<dt>rx</dt><dd><p>Treatment - Obs(ervation), Lev(amisole), Lev(amisole)+5-FU.</p>
</dd>
<dt>sex</dt><dd><p>Sex indicator (male=1, female=0).</p>
</dd>
<dt>age</dt><dd><p>Age in years.</p>
</dd>
<dt>obstruct</dt><dd><p>Obstruction of colon by tumour.</p>
</dd>
<dt>perfor</dt><dd><p>Perforation of colon.</p>
</dd>
<dt>adhere</dt><dd><p>Adherence to nearby organs.</p>
</dd>
<dt>nodes</dt><dd><p>Number of lymph nodes with detectable cancer.</p>
</dd>
<dt>differ</dt><dd><p>Differentiation of tumour (1=well, 2=moderate, 3=poor).</p>
</dd>
<dt>extent</dt><dd><p>Extent of local spread (1=submucosa, 2=muscle, 3=serosa,
4=contiguous structures).</p>
</dd>
<dt>surg</dt><dd><p>Time from surgery to registration (0=short, 1=long).</p>
</dd>
<dt>node4</dt><dd><p>More than 4 positive lymph nodes.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The study is originally described in Laurie (1989).The main report is found in Moertel (1990). This data set is closest to that of the final report in Moertel (1991). A version of the data with less follow-up time was used in the paper by Lin (1994).
</p>


<h3>References</h3>

<p>JA Laurie, CG Moertel, TR Fleming, HS Wieand, JE Leigh, J Rubin, GW McCormack, JB Gerstner, JE Krook and J Malliard. Surgical adjuvant therapy of large-bowel carcinoma: An evaluation of levamisole and the combination of levamisole and fluorouracil: The North Central Cancer Treatment Group and the Mayo Clinic. Journal of Clinical Oncology, 7:1447-1456, 1989.
</p>
<p>DY Lin. Cox regression analysis of multivariate failure time data: the marginal approach. Statistics in Medicine, 13:2233-2247, 1994.
</p>
<p>CG Moertel, TR Fleming, JS MacDonald, DG Haller, JA Laurie, PJ Goodman, JS Ungerleider, WA Emerson, DC Tormey, JH Glick, MH Veeder and JA Maillard. Levamisole and fluorouracil for adjuvant therapy of resected colon carcinoma. New England Journal of Medicine, 332:352-358, 1990.
</p>
<p>CG Moertel, TR Fleming, JS MacDonald, DG Haller, JA Laurie, CM Tangen, JS Ungerleider, WA Emerson, DC Tormey, JH Glick, MH Veeder and JA Maillard. Fluorouracil plus Levamisole as and effective adjuvant therapy after resection of stage II colon carcinoma: a final report. Annals of Internal Medicine, 122:321-326, 1991.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonMSM)
head(colonMSM)
</code></pre>

<hr>
<h2 id='data'>data</h2><span id='topic+data'></span>

<h3>Description</h3>

<p>Simulated data in which the individuals can move from the initial 
state (State 1) to an intermediate state (State 2). From there, they may 
either proceed to the absorbing state (State 4), passing through another 
intermediate state (State 3), or move directly from the initial state to the 
absorbing state.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("data")</code></pre>


<h3>Format</h3>

<p>A data frame with 500 observations on the following 6 variables.
</p>

<dl>
<dt><code>y1</code></dt><dd><p>First gap time.</p>
</dd>
<dt><code>state1</code></dt><dd><p>Indicator of the first gap time; 0 if the first time is 
censored and 1 otherwise.</p>
</dd>
<dt><code>y2</code></dt><dd><p>Second gap time.</p>
</dd>
<dt><code>state2</code></dt><dd><p>Censoring indicator of the second gap time; 0 if the total 
time is censored and 1 otherwise.</p>
</dd>
<dt><code>y3</code></dt><dd><p>Third gap time.</p>
</dd>
<dt><code>state3</code></dt><dd><p>Censoring indicator of the third gap time; 0 if the total 
time is censored and 1 otherwise.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>  data(data)
</code></pre>

<hr>
<h2 id='ebmt4'>Data from the European Society for Blood and Marrow Transplantation (EBMT).</h2><span id='topic+ebmt4'></span>

<h3>Description</h3>

<p>A data frame of 2279 patients transplanted at the EBMT between 1985 and 1998. These data were
used in Fiocco, Putter &amp; van Houwelingen (2008), van Houwelingen &amp; Putter (2008, 2012) and de
Wreede, Fiocco &amp; Putter (2011). The included variables are
</p>

<dl>
<dt>id</dt><dd><p>Patient identification number</p>
</dd>
<dt>rec</dt><dd><p>Time in days from transplantation to recovery or last follow-up</p>
</dd>
<dt>rec.s</dt><dd><p>Recovery status; 1 = recovery, 0 = censored</p>
</dd>
<dt>ae</dt><dd><p>Time in days from transplantation to adverse event (AE) or last follow-up</p>
</dd>
<dt>ae.s</dt><dd><p>Adverse event status; 1 = adverse event, 0 = censored</p>
</dd>
<dt>recae</dt><dd><p>Time in days from transplantation to both recovery and AE or last follow-up</p>
</dd>
<dt>recae.s</dt><dd><p>Recovery and AE status; 1 = both recovery and AE, 0 = no recovery or no AE or censored</p>
</dd>
<dt>rel</dt><dd><p>Time in days from transplantation to relapse or last follow-up</p>
</dd>
<dt>rel.s</dt><dd><p>Relapse status; 1 = relapse, 0 = censored</p>
</dd>
<dt>srv</dt><dd><p>Time in days from transplantation to death or last follow-up</p>
</dd>
<dt>srv.s</dt><dd><p>Relapse status; 1 = dead, 0 = censored</p>
</dd>
<dt>year</dt><dd><p>Year of transplantation; factor with levels &quot;1985-1989&quot;, &quot;1990-1994&quot;, &quot;1995-1998&quot;</p>
</dd>
<dt>agecl</dt><dd><p>Patient age at transplant; factor with levels &quot;&lt;=20&quot;, &quot;20-40&quot;, &quot;&gt;40&quot;</p>
</dd>
<dt>proph</dt><dd><p>Prophylaxis; factor with levels &quot;no&quot;, &quot;yes&quot;</p>
</dd>
<dt>match</dt><dd><p>Donor-recipient gender match; factor with levels &quot;no gender mismatch&quot;, &quot;gender mismatch&quot;</p>
</dd>
</dl>


<h3>Usage</h3>

<pre><code class='language-R'>data("ebmt4")</code></pre>


<h3>Format</h3>

<p>A data frame, see data.frame.
</p>


<h3>Author(s)</h3>

<p>Gustavo Soutinho and Luis Meira-Machado.
</p>


<h3>Source</h3>

<p>We acknowledge the European Society for Blood and Marrow Transplantation (EBMT) for making
available these data. Disclaimer: these data were simplified for the purpose of illustration of the
analysis of competing risks and multi-state models and do not reflect any real life situation. No
clinical conclusions should be drawn from these data.
</p>


<h3>References</h3>

<p>Fiocco M, Putter H, van Houwelingen HC (2008). Reduced-rank proportional hazards regression
and simulation-based prediction for multi-state models. Statistics in Medicine 27, 4340-4358.
</p>
<p>van Houwelingen HC, Putter H (2008). Dynamic predicting by landmarking as an alternative for
multi-state modeling: an application to acute lymphoid leukemia data. Lifetime Data Anal 14,
447-463.
</p>
<p>van Houwelingen HC, Putter H (2012). Dynamic Prediction in Clinical Survival Analaysis. Chapman
&amp; Hall/CRC Press, Boca Raton.
</p>
<p>de Wreede LC, Fiocco M, and Putter H (2011). mstate: An R Package for the Analysis of Competing
Risks and Multi-State Models. Journal of Statistical Software, Volume 38, Issue 7.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ebmt4)
head(ebmt4)
</code></pre>

<hr>
<h2 id='prepTP'>Function to prepare data set for multi-state modeling in long format from
data set in wide format.</h2><span id='topic+prepTP'></span>

<h3>Description</h3>

<p>This function converts a data set which is in wide format (one
subject per line, multiple columns indicating time and status for different
states) into a data set in long format (one line for each transition for 
which a subject is at risk). Selected covariates are replicated per subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepTP(data, trans, times.names, status.names)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepTP_+3A_data">data</code></td>
<td>
<p>Data frame in wide format in which to interpret time, status, id
or keep, if appropriate.</p>
</td></tr>
<tr><td><code id="prepTP_+3A_trans">trans</code></td>
<td>
<p>Transition matrix describing the states and transitions in the
multi-state model. If S is the number of states in the multi-state model,
trans should be an S x S matrix, with (i,j)-element a positive integer if a
transition from i to j is possible in the multi-state model, NA otherwise. 
In particular, all diagonal elements should be NA. The integers indicating 
the possible transitions in the multi-state model should be sequentially 
numbered, 1,...,K, with K the number of transitions.</p>
</td></tr>
<tr><td><code id="prepTP_+3A_times.names">times.names</code></td>
<td>
<p>Either 1) a matrix or data frame of dimension n x S (n
being the number of individuals and S the number of states in the multi-state
model), containing the times at which the states are visited or last 
follow-up time, or 2) a character vector of length S containing the column 
names indicating these times. In the latter cases, some elements of time may 
be NA, see Details.</p>
</td></tr>
<tr><td><code id="prepTP_+3A_status.names">status.names</code></td>
<td>
<p>Either 1) a matrix or data frame of dimension n x S, 
containing, for each of the states, event indicators taking the value 1 if 
the state is visited or 0 if it is not (censored), or 2) a character vector 
of length S containing the column names indicating these status variables. 
In the latter cases, some elements of status may be NA, see Details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;msdata&quot;, which is a data frame in long (counting process)
format containing the subject
id, the covariates (replicated per subject), and
from	
the starting state
to	
the receiving state
trans	
the transition number
Tstart	
the starting time of the transition
Tstop	
the stopping time of the transition
status	
status variable, with 1 indicating an event (transition), 0 a censoring
</p>


<h3>Author(s)</h3>

<p>Gustavo Soutinho and Luis Meira-Machado.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("ebmt4")
db_wide &lt;- ebmt4
positions&lt;-list(c(2, 3, 5, 6), c(4, 5, 6), c(4, 5, 6), c(5, 6), c(6), c())
states.names = c("Tx", "Rec", "AE", "Rec+AE", "Rel", "Death")
trans&lt;-transTP(positions, states.names)
times.names = c(NA, "rec", "ae","recae", "rel", "srv")
status.names=c(NA, "rec.s", "ae.s", "recae.s", "rel.s", "srv.s")
prepTP(data=db_wide, trans, times.names, status.names)
</code></pre>

<hr>
<h2 id='presmoothTP'>This function implements presmoothed estimates based on the landmark 
Aalen-Johansen method for non-parametric estimation of transition 
probabilities in non-Markov
multi-state models.</h2><span id='topic+presmoothTP'></span>

<h3>Description</h3>

<p>This function is used to obtain nonparametric presmoothed 
estimates of the transition probabilities for any type of multistate model, 
including models that allow for reversible transitions, and potencially
non-Markovian seetings. The methods used to compute the transition
probabilities are ”PLM” (given by a ”logistic” model), ”cauchit”, ”probit”.
The proposed presmoothed estimator is designed to handle complex multi-state 
models with more than three states, as well as reversible transitions, 
accommodating potentially non-Markovian behaviors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>presmoothTP(data, s, from, to, method = "LM", trans)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="presmoothTP_+3A_data">data</code></td>
<td>
<p>A data frame in the long format containing the subject id; 
from corresponding to the starting state; the receiving state, to; the 
transition number, trans; the starting time of the transition given by 
Tstart; the stopping time of the transition, Tstop, and status for the status
variable, with 1 indicating an event (transition), 0 a censoring.</p>
</td></tr>
<tr><td><code id="presmoothTP_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition.</p>
</td></tr>
<tr><td><code id="presmoothTP_+3A_from">from</code></td>
<td>
<p>The starting state of the transition probabilities.</p>
</td></tr>
<tr><td><code id="presmoothTP_+3A_to">to</code></td>
<td>
<p>The last receiving state considered for the estimation of the 
transition probabilities.</p>
</td></tr>
<tr><td><code id="presmoothTP_+3A_method">method</code></td>
<td>
<p>The method used to compute the transition probabilities.
Possible options are <code>"PLM"</code>, <code>"cauchit"</code> and <code>"probit"</code>.</p>
</td></tr>
<tr><td><code id="presmoothTP_+3A_trans">trans</code></td>
<td>
<p>The transition matrix for multi-state model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nonparametric presmoothed estimates of transition probabilities 
based on logistic’, ’probit’, and ’cauchit’ distributions (PLM,cauchit and 
probit).
</p>


<h3>Author(s)</h3>

<p>Gustavo Soutinho and Luis Meira-Machado.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ebmt4")
db_wide &lt;- ebmt4
positions&lt;-list(c(2, 3, 5, 6), c(4, 5, 6), c(4, 5, 6), c(5, 6), c(6), c())
states.names = c("Tx", "Rec", "AE", "Rec+AE", "Rel", "Death")
trans&lt;-transTP(positions, states.names)
times.names = c(NA, "rec", "ae","recae", "rel", "srv")
status.names=c(NA, "rec.s", "ae.s", "recae.s", "rel.s", "srv.s")
data.long&lt;-prepTP(data=db_wide, trans, times.names, status.names)

res1&lt;-presmoothTP(data.long, s = 100, from = 1, to = 1, 
method = 'PLM', trans=trans)
res2&lt;-presmoothTP(data.long, s = 100, from = 1, to = 1, method = 'cauchit', 
trans=trans)
res3&lt;-presmoothTP(data.long, s = 100, from = 1, to = 1, method = 'probit', 
trans=trans)

plot(res1, type='s', xlim=c(100,3000), ylim=c(0.6,1), ylab=c('p11(100,t)'))
lines(res2, type='s', col=2)
lines(res3, type='s', col=4)
legend("topright", legend = c("PLM","Cauchit", "Probit"), lwd = 0.3, 
col = c(1,2,4), cex=0.7, lty=c(1, 1))
res4&lt;-presmoothTP(data.long, s = 1000, from = 2, to = 6, method = 'PLM', 
trans=trans)
res5&lt;-presmoothTP(data.long, s = 1000, from = 2, to = 6, method = 'cauchit', 
trans=trans)
res6&lt;-presmoothTP(data.long, s = 1000, from = 2, to = 6, method = 'probit', 
trans=trans)
plot(res4, type='s', xlim=c(1000,3000), ylim=c(0,0.12),ylab=c('p26(1000,t)'))
lines(res5, type='s', col=2)
lines(res6, type='s', col=4)
legend("topright", legend = c("PLM","Cauchit", "Probit"), lwd = 0.3, 
col = c(1,2,4), cex=0.7, lty=c(1, 1))

</code></pre>

<hr>
<h2 id='prothr'>Liver cirrhosis data - Abnormal prothrombin levels in liver cirrhosis.</h2><span id='topic+prothr'></span>

<h3>Description</h3>

<p>A data frame of 488 liver cirrhosis patients from a randomized clinical trial concerning prednisone
treatment in these patients. The dataset is in long format. The included variables are
</p>

<dl>
<dt>id</dt><dd><p>Patient identification number</p>
</dd>
<dt>from</dt><dd><p>Starting state</p>
</dd>
<dt>to</dt><dd><p>Receiving state</p>
</dd>
<dt>trans</dt><dd><p>Transition number</p>
</dd>
<dt>Tstart</dt><dd><p>Starting time</p>
</dd>
<dt>Tstop</dt><dd><p>Transition time</p>
</dd>
<dt>status</dt><dd><p>Status variable; 1=transition, 0=censored</p>
</dd>
<dt>treat</dt><dd><p>Treatment; factor with levels &quot;Placebo&quot;, &quot;Prednisone&quot;</p>
</dd>
</dl>


<h3>Usage</h3>

<pre><code class='language-R'>data("prothr")</code></pre>


<h3>Format</h3>

<p>A data frame, see data.frame.
</p>


<h3>Author(s)</h3>

<p>Gustavo Soutinho and Luis Meira-Machado.
</p>


<h3>Source</h3>

<p>This data was kindly provided by Per Kragh Andersen. It was introduced in Andersen, Borgan, Gill
&amp; Keiding (1993), Example 1.3.12, and used as illustration for computation of transition probabilities
in multi-state models, see Sections IV.4 (Example IV.4.4) and VII.2 (Example VII.2.10).
</p>


<h3>References</h3>

<p>Andersen PK, Borgan O, Gill RD, Keiding N (1993). Statistical Models Based on Counting Processes.
Springer, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(prothr)
head(prothr)
</code></pre>

<hr>
<h2 id='transTP'>Define transition matrix for multi-state model.</h2><span id='topic+transTP'></span>

<h3>Description</h3>

<p>Define transition matrices for multi-state model. Specific
functions for defining  such transition matrices are pre-defined for common
multi-state models like the competing risks model and the illness-death 
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transTP(positions, states.names)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transTP_+3A_positions">positions</code></td>
<td>
<p>List of possible transitions; x[[i]] consists of a vector of
state numbers reachable from state i.</p>
</td></tr>
<tr><td><code id="transTP_+3A_states.names">states.names</code></td>
<td>
<p>A character vector containing the names of either the
competing risks or the states in the multi-state model specified by the
competing risks or illness-death model. names should have the same 
length as the list x (for transMat), or either K or K+1 (for trans.comprisk),
or 3 (for trans.illdeath).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A transition matrix describing the states and transitions in the
multi-state model.
</p>


<h3>Author(s)</h3>

<p>Gustavo Soutinho and Luis Meira-Machado.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ebmt4")
db_wide &lt;- ebmt4
positions&lt;-list(c(2, 3, 5, 6), c(4, 5, 6), c(4, 5, 6), c(5, 6), c(6), c())
states.names = c("Tx", "Rec", "AE", "Rec+AE", "Rel", "Death")
transTP(positions, states.names)
</code></pre>

<hr>
<h2 id='unsmoothTP'>This function implements unsmoothed estimates of from the Aalen-Johansen 
estimator (AJ) and landmark Aalen-Johansen method of Putter &amp; Spitoni (2016) 
for non-parametric estimation of transition probabilities in non-Markov
multi-state models.</h2><span id='topic+unsmoothTP'></span>

<h3>Description</h3>

<p>This function is used to obtain nonparametric unsmoothed 
estimates of the transition probabilities. The methods used to compute the 
transition probabilities are ”AJ” and ”LM” which can be also applied for any
type of multistate model, including models that allow for reversible 
transitions, and potencially non-Markovian seetings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unsmoothTP(data, s, from, to, method = "LM", trans = trans)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unsmoothTP_+3A_data">data</code></td>
<td>
<p>A data frame in the long format containing the subject id; 
from corresponding to the starting state; the receiving state, to; the 
transition number, trans; the starting time of the transition given by 
Tstart; the stopping time of the transition, Tstop, and status for the status
variable, with 1 indicating an event (transition), 0 a censoring.</p>
</td></tr>
<tr><td><code id="unsmoothTP_+3A_s">s</code></td>
<td>
<p>The first time for obtaining estimates for the transition.</p>
</td></tr>
<tr><td><code id="unsmoothTP_+3A_from">from</code></td>
<td>
<p>The starting state of the transition probabilities.</p>
</td></tr>
<tr><td><code id="unsmoothTP_+3A_to">to</code></td>
<td>
<p>The last receiving state considered for the estimation of the 
transition probabilities.</p>
</td></tr>
<tr><td><code id="unsmoothTP_+3A_method">method</code></td>
<td>
<p>The method used to compute the transition probabilities.
Possible options are <code>"AJ"</code> and <code>"LM"</code>.</p>
</td></tr>
<tr><td><code id="unsmoothTP_+3A_trans">trans</code></td>
<td>
<p>The transition matrix for multi-state model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nonparametric estimates of transition probabilities in general 
multi-state models using the AJ and the LMAJ estimators.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ebmt4")
db_wide &lt;- ebmt4
positions&lt;-list(c(2, 3, 5, 6), c(4, 5, 6), c(4, 5, 6), c(5, 6), c(6), c())
states.names = c("Tx", "Rec", "AE", "Rec+AE", "Rel", "Death")
trans&lt;-transTP(positions, states.names)
times.names = c(NA, "rec", "ae","recae", "rel", "srv")
status.names=c(NA, "rec.s", "ae.s", "recae.s", "rel.s", "srv.s")
data.long&lt;-prepTP(data=db_wide, trans, times.names, status.names)

res1&lt;-unsmoothTP(data.long, s = 100, from = 1, to = 1, method = 'AJ', 
trans=trans)
head(res1)
res2&lt;-unsmoothTP(data.long, s = 100, from = 1, to = 1, method = 'LM', 
trans=trans)
head(res2)
plot(res1, type='s', xlim=c(0,3000), ylim=c(0.6,1), ylab=c('p11(100,t)'))
lines(res2, type='s', col=2)
legend("topright", legend = c("AJ","LM"), lwd = 0.3, col = c(1,2), cex=0.7,
lty=c(1, 1))

res3&lt;-unsmoothTP(data.long, s = 1000, from = 2, to = 6, method = 'AJ', 
trans=trans)
res4&lt;-unsmoothTP(data.long, s = 1000, from = 2, to = 6, method = 'LM', 
trans=trans)

plot(res3, type='s', xlim=c(1000,3000), ylim=c(0,0.12), ylab=c('p26(100,t)'))
lines(res4, type='s', col=2)
legend("topright", legend = c("AJ","LM"), lwd = 0.3, col = c(1,2), cex=0.7,
lty=c(1, 1))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
