<!DOCTYPE html><html><head><title>Help for package tbd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tbd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boot.ci'><p>Estimate the confidence interval of SACE using bootstrap.</p></a></li>
<li><a href='#print.sace'><p>Print results of <code>sace</code></p></a></li>
<li><a href='#sace'><p>Estimation of causal effects with outcomes truncated by death</p></a></li>
<li><a href='#simulated_data'><p>Simulated data with known SACE</p></a></li>
<li><a href='#summary.sace'><p>Summarize results of <code>sace</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimation of Causal Effects with Outcomes Truncated by Death</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhixuan Shao [cre],
  Bo Liu [ctb],
  Linbo Wang [aut],
  Xiao-Hua Zhou [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhixuan Shao &lt;shaozhixuansh@pku.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of the survivor average causal effect under outcomes truncated by death, which requires the existence of a substitution variable. It can be applied to both experimental and observational data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), numDeriv</td>
</tr>
<tr>
<td>Suggests:</td>
<td>stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/KillingVectorField/causal-inference-truncated-by-death">https://github.com/KillingVectorField/causal-inference-truncated-by-death</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-01-05 15:10:04 UTC; billy</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-01-09 17:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='boot.ci'>Estimate the confidence interval of SACE using bootstrap.</h2><span id='topic+boot.ci'></span>

<h3>Description</h3>

<p>Give quantiles of bootstrap samples SACE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot.ci(object, nboot = 1000, seed = 100:(100 + nboot - 1), alpha = 0.05,
  max.step = 1000, singular.ok = FALSE, print.progress = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot.ci_+3A_object">object</code></td>
<td>
<p>an object of class <code>sace</code>.</p>
</td></tr>
<tr><td><code id="boot.ci_+3A_nboot">nboot</code></td>
<td>
<p>a positive integer. The number of bootstrap samples desired.</p>
</td></tr>
<tr><td><code id="boot.ci_+3A_seed">seed</code></td>
<td>
<p>an integer vector with length <code>nboot</code>. Seed to generate samples.</p>
</td></tr>
<tr><td><code id="boot.ci_+3A_alpha">alpha</code></td>
<td>
<p>confidence level.</p>
</td></tr>
<tr><td><code id="boot.ci_+3A_max.step">max.step</code></td>
<td>
<p>see documentation of <a href="#topic+sace">sace</a>.</p>
</td></tr>
<tr><td><code id="boot.ci_+3A_singular.ok">singular.ok</code></td>
<td>
<p>see documentation of <a href="#topic+sace">sace</a>.</p>
</td></tr>
<tr><td><code id="boot.ci_+3A_print.progress">print.progress</code></td>
<td>
<p>logical. Need progress be printed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with 4 elements:
</p>
<table>
<tr><td><code>nskip</code></td>
<td>
<p>number of failures during bootstrap.</p>
</td></tr>
<tr><td><code>sace.boot.record</code></td>
<td>
<p>a vector with length <code>nboot</code>-<code>skip</code>. SACE estimates of all bootstrap samples.</p>
</td></tr>
<tr><td><code>boot.sd</code></td>
<td>
<p>scaler. Standard deviation of SACE estimates of all bootstrap samples.</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>a vector with length 2. Estimated confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zhixuan Shao &lt;shaozhixuansh@pku.edu.cn&gt;
</p>

<hr>
<h2 id='print.sace'>Print results of <code>sace</code></h2><span id='topic+print.sace'></span>

<h3>Description</h3>

<p><code>print.sace</code> prints estimation of the SACE (survivor average causal effect).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sace'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.sace_+3A_x">x</code></td>
<td>
<p>an object of class <code>sace</code>.</p>
</td></tr>
<tr><td><code id="print.sace_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the input object is returned silently.
</p>

<hr>
<h2 id='sace'>Estimation of causal effects with outcomes truncated by death</h2><span id='topic+sace'></span>

<h3>Description</h3>

<p><code>sace</code> estimates survivor average causal effects (SACE) with outcomes truncated by death.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sace(Z, S, Y, X, A, subset, optim.method = "BFGS", max.step = 1000,
  singular.ok = TRUE, need.variance = TRUE, hessian = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sace_+3A_z">Z</code></td>
<td>
<p>a logical vector. Exposure indicator. Convetionally, <code>1</code> means treatment and <code>0</code> means control. Must not have missing values.</p>
</td></tr>
<tr><td><code id="sace_+3A_s">S</code></td>
<td>
<p>a logical vector. Survival indicator. <code>1</code> means survival and <code>0</code> means death. Must not have missing values.</p>
</td></tr>
<tr><td><code id="sace_+3A_y">Y</code></td>
<td>
<p>a numeric vector. (Univariate) outcomes. May have <code>NA</code> where <code class="reqn">S=0</code> (since <code class="reqn">Y</code> is not well-defined where <code class="reqn">S=0</code>).</p>
</td></tr>
<tr><td><code id="sace_+3A_x">X</code></td>
<td>
<p>an optional numeric matrix or vector. Baseline covariates.</p>
</td></tr>
<tr><td><code id="sace_+3A_a">A</code></td>
<td>
<p>an optional numeric matrix or vector. Substitution variable(s) which satisfies the assumptions of &quot;exclusion restriction&quot; and &quot;substitution relevance&quot;. See references. If <code>A == NULL</code>, then the naive method, namely OLS, will be used.</p>
</td></tr>
<tr><td><code id="sace_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of obervations to be used.</p>
</td></tr>
<tr><td><code id="sace_+3A_optim.method">optim.method</code></td>
<td>
<p>The method to be used for maximum likelihood optimization. See <a href="stats.html#topic+optim">optim</a>.</p>
</td></tr>
<tr><td><code id="sace_+3A_max.step">max.step</code></td>
<td>
<p>integer. Maximum iterating steps of maximum likelihood optimization.</p>
</td></tr>
<tr><td><code id="sace_+3A_singular.ok">singular.ok</code></td>
<td>
<p>logical. Refers to the OLS estimation of the coefficients <code>alpha_1</code> and <code>alpha_2</code> using <a href="stats.html#topic+lm">lm</a>. If <code>FALSE</code> (default), a singular fit raises an error.</p>
</td></tr>
<tr><td><code id="sace_+3A_need.variance">need.variance</code></td>
<td>
<p>logical. Is variance of parameters and estimators needed? See details.</p>
</td></tr>
<tr><td><code id="sace_+3A_hessian">hessian</code></td>
<td>
<p>logical. If <code>TRUE</code>, the hessian returned by <a href="stats.html#topic+optim">optim</a> will be used to compute the information matrix. If <code>FALSE</code>, the matrix will be calculated by an explicit formula.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function <code>sace</code>, gives estimation of average causal effects (ACE) with outcomes truncated by death. The identification of SACE relies on the existence of a substitution variable and requires the assumptions of monotonicity, ignorability, exclusion restriction, and relevance. While the naive estimates given by the coefficient of <code>Z</code> from <code>lm(Y ~ Z + X + A, subset = S == 1)</code> are restricted among survivors and therefore may be subject to selection bias, this method gives consistent estimates of the SACE (survivor average causal effect), defined as the average causal effect among the subgroup consisting of subjects who would survive under either exposure, i.e. among the always-survivor group (<code class="reqn">G=LL</code>). See references for details of the assumptions and the model parameterizations.
</p>
<p>Parameters <code>beta</code> and <code>gamma</code> are estimated by MLE, using <a href="stats.html#topic+optim">optim</a>.
</p>
<p>If <code>need.variance == TRUE</code>, the asymptotic variance estimators of both parameters and estimators will be given. This requires the <span class="pkg">numDeriv</span> package.
</p>


<h3>Value</h3>

<p>a list with following elements:
</p>
<table>
<tr><td><code>CALL</code></td>
<td>
<p>function call.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data used (within the specified subset).</p>
</td></tr>
<tr><td><code>optim.method</code></td>
<td>
<p>method used for optimization.</p>
</td></tr>
<tr><td><code>need.variance</code></td>
<td>
<p>is variance of parameters and estimators needed?</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>mu_0_LL</code></td>
<td>
<p>average potential outcomes among control group, <code class="reqn">E[ Y(0) | G=LL ]</code>.</p>
</td></tr>
<tr><td><code>mu_1_LL</code></td>
<td>
<p>average potential outcomes among treatment group, <code class="reqn">E[ Y(1) | G=LL ]</code>.</p>
</td></tr>
<tr><td><code>sace</code></td>
<td>
<p>survivor average causal effect, equals <code>mu_1_LL</code>-<code>mu_0_LL</code>.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p><code class="reqn">Pr{S(1)=1| X,A}=expit(\beta_0+X' \beta_1+ A \beta_2)</code>, estimated by MLE.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p><code class="reqn">Pr{S(0)=1| X,A}/Pr{S(1)=1| X,A}=expit(\gamma_0+X' \gamma_1+ A \gamma_2)</code>, estimated by MLE.</p>
</td></tr>
<tr><td><code>beta_gamma.convergence</code></td>
<td>
<p>indicator of convergence of MLE optimization of beta and gamma. 0 means convergence. See <a href="stats.html#topic+optim">optim</a>.</p>
</td></tr>
<tr><td><code>alpha_1</code></td>
<td>
<p><code class="reqn">E[Y(0)| Z=0, G=LL, X, A ]=\alpha_{10}+X' \alpha_{11}+ A \alpha_{12}</code>, coefficients of <code>lm(Y ~ 1 + X + A, subset = Z == 0)</code>.</p>
</td></tr>
<tr><td><code>alpha_2</code></td>
<td>
<p><code class="reqn">E[Y(1)| Z=1, G=LL, X, A ]=\alpha_{20}+X' \alpha_{21}+ G \alpha_{22}</code>, coefficients of <code>lm(Y ~ 1 + X + W.expit, subset = (Z == 1 &amp; S == 1))</code>.</p>
</td></tr>
</table>
<p>The following items will be given only if <code>need.variance == TRUE</code>:
</p>
<table>
<tr><td><code>beta.var</code></td>
<td>
<p>estimated asymptotic covariance matrix of beta.</p>
</td></tr>
<tr><td><code>gamma.var</code></td>
<td>
<p>estimated asymptotic covariance matrix of gamma.</p>
</td></tr>
<tr><td><code>relevance.Pvalue</code></td>
<td>
<p>P value of the asymptotic chi-squared test on the relevance assumption for the substitution variable. A large P value suggests that the relevance assumption may not hold, namely, the substitution variable(s) may have little impact on the latent survival type.</p>
</td></tr>
<tr><td><code>alpha_1.var</code></td>
<td>
<p>estimated asymptotic covariance matrix of alpha_1.</p>
</td></tr>
<tr><td><code>alpha_2.var</code></td>
<td>
<p>estimated asymptotic covariance matrix of alpha_2.</p>
</td></tr>
<tr><td><code>mu_0_LL.var</code></td>
<td>
<p>estimated asymptotic variance of mu_0_LL.</p>
</td></tr>
<tr><td><code>mu_1_LL.var</code></td>
<td>
<p>estimated asymptotic variance of mu_1_LL.</p>
</td></tr>
<tr><td><code>sace.var</code></td>
<td>
<p>estimated asymptotic variance of the SACE.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The length of vectors <code>Z</code>, <code>Y</code>, <code>S</code>, as well as the row number of matrix <code>X</code> and <code>A</code> must equal the sample size <code>n</code>.
</p>


<h3>Author(s)</h3>

<p>Linbo Wang &lt;linbo.wang@utoronto.ca&gt;
</p>
<p>Zhixuan Shao &lt;shaozhixuansh@pku.edu.cn&gt;
</p>


<h3>References</h3>

<p>Linbo Wang, Xiao-Hua Zhou, Thomas S. Richardson; Identification and estimation of causal effects with outcomes truncated by death, Biometrika, Volume 104, Issue 3, 1 September 2017, Pages 597-612, <a href="https://doi.org/10.1093/biomet/asx034">https://doi.org/10.1093/biomet/asx034</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>attach(simulated_data)
X &lt;- cbind(X.X1, X.V2, X.V3)
sace.result &lt;- sace(Z, S, Y, X, A)
sace
</code></pre>

<hr>
<h2 id='simulated_data'>Simulated data with known SACE</h2><span id='topic+simulated_data'></span>

<h3>Description</h3>

<p>This simulated dataset is to illustrate how to use <a href="#topic+sace">sace</a> to estimate the SACE, and compare it with other naive methods. In this simulated data, by design, there is confounding between <code>Z</code> and <code>Y</code> caused by <code>X</code>, and confounding between <code>S</code> and <code>Y</code> caused by <code>X</code>.
</p>


<h3>Format</h3>

<p>A data frame with 5000 observations and 7 variables. <code>Z</code>, <code>A</code>, <code>Y</code>, <code>S</code> are 1-dimensional, and <code>X</code> is 3-dimensional. The variables are as follows:
</p>

<dl>
<dt>Z</dt><dd><p>Binary treatment</p>
</dd>
<dt>X.X1</dt><dd><p>A factor covariate with 2 levels (1 and -1)</p>
</dd>
<dt>X.V2</dt><dd><p>A continuous covariate</p>
</dd>
<dt>X.V3</dt><dd><p>A contunuous covariate</p>
</dd>
<dt>A</dt><dd><p>The substitution variable which is continuous</p>
</dd>
<dt>Y</dt><dd><p>The continuous outcome. <code>NA</code> where <code class="reqn">S = 0</code></p>
</dd>
<dt>S</dt><dd><p>The survival indicator. <code>1</code> means survival and <code>0</code> means death.</p>
</dd>
</dl>


<h3>Source</h3>

<p>The dataset is generated by the simulation design of <cite>Wang et al. 2017</cite> with <code class="reqn">\delta_1 = 1</code> and <code class="reqn">\delta_0 = 1</code>, which allows confounding between <code>Z</code> and <code>Y</code> caused by <code>X</code>, and confounding between <code>S</code> and <code>Y</code> caused by <code>X</code>.
</p>


<h3>References</h3>

<p>Linbo Wang, Xiao-Hua Zhou, Thomas S. Richardson; Identification and estimation of causal effects with outcomes truncated by death, Biometrika, Volume 104, Issue 3, 1 September 2017, Pages 597-612, <a href="https://doi.org/10.1093/biomet/asx034">https://doi.org/10.1093/biomet/asx034</a>
</p>

<hr>
<h2 id='summary.sace'>Summarize results of <code>sace</code></h2><span id='topic+summary.sace'></span>

<h3>Description</h3>

<p><code>summary.sace</code> summary estimation of the SACE (survivor average causal effect) and all other model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sace'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.sace_+3A_object">object</code></td>
<td>
<p>an object of class <code>sace</code>.</p>
</td></tr>
<tr><td><code id="summary.sace_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the input object is returned silently.
</p>


<h3>Note</h3>

<p>If <code>need.variance</code> is <code>TRUE</code>, <code>sace</code> must have been called with <code>need.variance == TRUE</code>, so that the information needed was recorded.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
