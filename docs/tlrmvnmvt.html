<!DOCTYPE html><html lang="en"><head><title>Help for package tlrmvnmvt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tlrmvnmvt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#algorithm'><p>Parameters for the Quasi-Monte Carlo sampling</p></a></li>
<li><a href='#pmvn'><p>Quasi-Monte Carlo method for multivariate normal probabilities</p></a></li>
<li><a href='#pmvt'><p>Quasi-Monte Carlo method for Student-$t$ probabilities</p></a></li>
<li><a href='#tlrmvnmvt-package'>
<p>Low-Rank Methods for MVN and MVT Probabilities</p></a></li>
<li><a href='#zorder'><p>Index locations on the 2D plane</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Low-Rank Methods for MVN and MVT Probabilities</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-07</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the classic Genz algorithm and a novel tile-low-rank algorithm for computing	relatively high-dimensional multivariate normal (MVN) and Student-t (MVT) probabilities. 
	References used for this package:
	Foley, James, Andries van Dam, Steven Feiner, and John Hughes. 
	"Computer Graphics: Principle and Practice". Addison-Wesley 
	Publishing Company. Reading, Massachusetts (1987, ISBN:0-201-84840-6 1);
	Genz, A., "Numerical computation of multivariate
	normal probabilities," Journal of Computational and
	Graphical Statistics, 1, 141-149 (1992) &lt;<a href="https://doi.org/10.1080%2F10618600.1992.10477010">doi:10.1080/10618600.1992.10477010</a>&gt;;
    Cao, J., Genton, M. G., Keyes, D. E., &amp; Turkiyyah, G. M. "Exploiting Low
    Rank Covariance Structures for Computing High-Dimensional Normal and Student-
    t Probabilities," Statistics and Computing, 31.1, 1-16 (2021) 
    &lt;<a href="https://doi.org/10.1007%2Fs11222-020-09978-y">doi:10.1007/s11222-020-09978-y</a>&gt;;
    Cao, J., Genton, M. G., Keyes, D. E., &amp; Turkiyyah, G. M. "tlrmvnmvt: 
    Computing High-Dimensional Multivariate Normal and Student-t Probabilities 
    with Low-Rank Methods in R," Journal of Statistical Software, 101.4, 
    1-25 (2022) &lt;<a href="https://doi.org/10.18637%2Fjss.v101.i04">doi:10.18637/jss.v101.i04</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mvtnorm (&ge; 1.0.11)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.8), methods (&ge; 4.2.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp (&ge; 1.0.8), RcppEigen (&ge; 0.3.3.5.0), BH (&ge; 1.69.0.1)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-08 02:11:41 UTC; caoj</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Genton [aut],
  David Keyes [aut],
  George Turkiyyah [aut],
  Jian Cao [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jian Cao &lt;jian.cao@kaust.edu.sa&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-09 09:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='algorithm'>Parameters for the Quasi-Monte Carlo sampling</h2><span id='topic+GenzBretz'></span><span id='topic+TLRQMC'></span>

<h3>Description</h3>

<p>The two functions return objects containing the parameters for the dense-matrix based Quasi-Monte Carlo method and the tile-low-rank-matrix based Quasi-Monte Carlo method, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  GenzBretz(N = 499) 
  TLRQMC(N = 499, m = 64, epsl = 1e-4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="algorithm_+3A_n">N</code></td>
<td>
<p>an integer, specifying the number of per-batch Monte Carlo samples. The 
total number of Monte Carlo samples is 20 X N</p>
</td></tr>
<tr><td><code id="algorithm_+3A_m">m</code></td>
<td>
<p>an integer, specifying the block size for the tile-low-rank methods</p>
</td></tr>
<tr><td><code id="algorithm_+3A_epsl">epsl</code></td>
<td>
<p>numeric value, specifying the truncation level for the tile-low-rank methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return an object of the class &quot;GenzBretz&quot; or &quot;TLRQMC&quot;, which is used as the parameter of the <code><a href="#topic+pmvn">pmvn</a></code> and the <code><a href="#topic+pmvt">pmvt</a></code> functions.
</p>


<h3>Author(s)</h3>

<p>Jian Cao, Marc Genton, David Keyes, George Turkiyyah</p>

<hr>
<h2 id='pmvn'>Quasi-Monte Carlo method for multivariate normal probabilities</h2><span id='topic+pmvn'></span>

<h3>Description</h3>

<p>Compute multivariate normal probabilities with the dense-matrix based Quasi-Monte Carlo method and the tile-low-rank-matrix based Quasi-Monte Carlo method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmvn(lower = -Inf, upper = Inf, mean = 0, sigma = NULL, 
uselog2 = FALSE, algorithm = GenzBretz(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pmvn_+3A_lower">lower</code></td>
<td>
<p>lower integration limits, a numeric vector of length n</p>
</td></tr>
<tr><td><code id="pmvn_+3A_upper">upper</code></td>
<td>
<p>upper integration limits, a numeric vector of length n</p>
</td></tr>
<tr><td><code id="pmvn_+3A_mean">mean</code></td>
<td>
<p>the mean parameter, a numeric vector of length n</p>
</td></tr>
<tr><td><code id="pmvn_+3A_sigma">sigma</code></td>
<td>
<p>the covariance matrix of dimension n</p>
</td></tr>
<tr><td><code id="pmvn_+3A_uselog2">uselog2</code></td>
<td>
<p>whether return the result as the logarithm to the base 2</p>
</td></tr>
<tr><td><code id="pmvn_+3A_algorithm">algorithm</code></td>
<td>
<p>an object of class <code><a href="#topic+GenzBretz">GenzBretz</a></code> or
<code><a href="#topic+TLRQMC">TLRQMC</a></code> defining the hyper parameters of this algorithm</p>
</td></tr>
<tr><td><code id="pmvn_+3A_...">...</code></td>
<td>
<p>additional parameters used to construct 'sigma' when it is not given:
</p>

<ul>
<li><p>geom a matrix of dimension n-by-2, specifying n spatial locations in the 2D unit square
</p>
</li>
<li><p>kernelType the name of the covariance kernel, a string. Currently, only the Matern covariance function, e.g., &quot;matern&quot;, is supported. Not case-sensitive. It should be given when 'sigma' is not given
</p>
</li>
<li><p>para the parameter for the covariance kernel, a numeric vector. When 'type' is &quot;matern&quot;, the length of 'para' should be 4, representing the scale, range, smoothness, and nugget parameters of the covariance function. It should be given when 'sigma' is not given
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>When 'algorithm' is of the class 'GenzBretz', the Quasi-Monte Carlo sampling described in Genz, A. (1992) is used.
When 'algorithm' is of the class 'TLRQMC', the Quasi-Monte Carlo sampling with the tile-low-rank representation of the covariance matrix, described in Cao et al. (2020), is used.
When 'sigma', is given, 'geom', 'kernelType', and 'para' are not used. Otherwise, a covariance matrix is created with the information from 'geom', 'kernelType', and 'para'.
</p>


<h3>Value</h3>

<p>When 'uselog2' is set FALSE, the function returns the estimated probability with one attribute of the estimation error. 
When 'uselog2' is set TRUE, the function only returns the estimated log-probability to the base 2. This is useful when the estimated probability is smaller than the machine precision.
</p>


<h3>Author(s)</h3>

<p>Jian Cao, Marc Genton, David Keyes, George Turkiyyah</p>


<h3>References</h3>

<p>Genz, A. (1992), &quot;Numerical computation of multivariate
normal probabilities,&quot; Journal of Computational and
Graphical Statistics, 1, 141-149.
Cao, J., Genton, M. G., Keyes, D. E., &amp; Turkiyyah, G. M. (2022), &quot;tlrmvnmvt: Computing High-Dimensional Multivariate Normal and Student-t Probabilities with Low-Rank Methods in R,&quot; Journal of Statistical Software, 101.4, 1-25.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  n = 225
  set.seed(0)
  a = rep(-10, n)
  b = rnorm(n, 3, 2)
  m = 15
  epsl = 1e-4
  vec1 = 1 : m
  vec2 = rep(1, m)
  geom = cbind(kronecker(vec1, vec2), kronecker(vec2, vec1))
  geom = geom / m
  beta = 0.3
  idx = zorder(geom)
  geom = geom[idx, ]
  a = a[idx]
  b = b[idx]
  distM = as.matrix(dist(geom))
  covM = exp(-distM / beta)
  pmvn(lower = a, upper = b, mean = 2, sigma = covM, uselog2 = FALSE, 
       algorithm = GenzBretz(N = 521))
  pmvn(lower = a, upper = b, mean = 2, uselog2 = TRUE, geom = geom, 
       kernelType = "matern", para = c(1.0, 0.3, 0.5, 0.0))
  pmvn(lower = a, upper = b, mean = 2, sigma = covM, uselog2 = FALSE, 
       algorithm = TLRQMC(N = 521, m = m, epsl = epsl))
  pmvn(lower = a, upper = b, mean = 2, uselog2 = TRUE, geom = geom, 
       algorithm = TLRQMC(N = 521, m = m, epsl = epsl),
       kernelType = "matern", para = c(1.0, 0.3, 0.5, 0.0))
</code></pre>

<hr>
<h2 id='pmvt'>Quasi-Monte Carlo method for Student-$t$ probabilities</h2><span id='topic+pmvt'></span>

<h3>Description</h3>

<p>Compute multivariate Student-$t$ probabilities with the dense-matrix based Quasi-Monte Carlo method and the tile-low-rank-matrix based Quasi-Monte Carlo method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmvt(lower = -Inf, upper = Inf, delta = 0, df = 1, sigma = NULL, 
     uselog2 = FALSE, algorithm = GenzBretz(), 
     type = "Kshirsagar", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pmvt_+3A_lower">lower</code></td>
<td>
<p>lower integration limits, a numeric vector of length n</p>
</td></tr>
<tr><td><code id="pmvt_+3A_upper">upper</code></td>
<td>
<p>upper integration limits, a numeric vector of length n</p>
</td></tr>
<tr><td><code id="pmvt_+3A_delta">delta</code></td>
<td>
<p>the vector of noncentrality parameters of length n, for type = &quot;shifted&quot; delta specifies the mode</p>
</td></tr>
<tr><td><code id="pmvt_+3A_df">df</code></td>
<td>
<p>a positive numeric value denoting the degrees of freedom</p>
</td></tr>
<tr><td><code id="pmvt_+3A_sigma">sigma</code></td>
<td>
<p>the covariance matrix of dimension n</p>
</td></tr>
<tr><td><code id="pmvt_+3A_uselog2">uselog2</code></td>
<td>
<p>whether return the result as the logarithm to the base 2</p>
</td></tr>
<tr><td><code id="pmvt_+3A_algorithm">algorithm</code></td>
<td>
<p>an object of class <code><a href="#topic+GenzBretz">GenzBretz</a></code> or <code><a href="#topic+TLRQMC">TLRQMC</a></code> defining the hyper parameters of this algorithm</p>
</td></tr>
<tr><td><code id="pmvt_+3A_type">type</code></td>
<td>
<p>type of the noncentral multivariate $t$ distribution to be computed. 'type' = &quot;Kshirsagar&quot; corresponds to formula (1.4) in Genz and Bretz (2009). 'type' = &quot;shifted&quot; corresponds to the formula right before formula (1.4) in Genz and Bretz (2009)</p>
</td></tr>
<tr><td><code id="pmvt_+3A_...">...</code></td>
<td>
<p>additional parameters used to construct 'sigma' when it is not given:
</p>

<ul>
<li><p>geom a matrix of dimension n-by-2, specifying n spatial locations in the 2D unit square
</p>
</li>
<li><p>kernelType the name of the covariance kernel, a string. Currently, only the Matern covariance function, e.g., &quot;matern&quot;, is supported. Not case-sensitive. It should be given when 'sigma' is not given
</p>
</li>
<li><p>para the parameter for the covariance kernel, a numeric vector. When 'type' is &quot;matern&quot;, the length of 'para' should be 4, representing the scale, range, smoothness, and nugget parameters of the covariance function. It should be given when 'sigma' is not given
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>When 'algorithm' is of the class 'GenzBretz', the Quasi-Monte Carlo sampling described in Genz, A. (1992) is used.
When 'algorithm' is of the class 'TLRQMC', the Quasi-Monte Carlo sampling with the tile-low-rank representation of the covariance matrix, described in Cao et al. (2020), is used.
When 'sigma', is given, 'geom', 'kernelType', and 'para' are not used. Otherwise, a covariance matrix is created with the information from 'geom', 'kernelType', and 'para'.
</p>


<h3>Value</h3>

<p>When 'uselog2' is set FALSE, the function returns the estimated probability with one attribute of the estimation error. 
When 'uselog2' is set TRUE, the function only returns the estimated log-probability to the base 2. This is useful when the estimated probability is smaller than the machine precision.
</p>


<h3>Author(s)</h3>

<p>Jian Cao, Marc Genton, David Keyes, George Turkiyyah</p>


<h3>References</h3>

<p>Genz, A. (1992), &quot;Numerical computation of multivariate
normal probabilities,&quot; Journal of Computational and
Graphical Statistics, 1, 141-149.
Genz, A. and Bretz, F. (2009), Computation of Multivariate Normal and t Probabilities. Lecture Notes in Statistics, Vol. 195. Springer-Verlag, Heidelberg.
Cao, J., Genton, M. G., Keyes, D. E., &amp; Turkiyyah, G. M. (2022), &quot;tlrmvnmvt: Computing High-Dimensional Multivariate Normal and Student-t Probabilities with Low-Rank Methods in R,&quot; Journal of Statistical Software, 101.4, 1-25.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  n = 225
  set.seed(0)
  a = rep(-10, n)
  b = rnorm(n, 3, 2)
  m = 15
  epsl = 1e-4
  vec1 = 1 : m
  vec2 = rep(1, m)
  geom = cbind(kronecker(vec1, vec2), kronecker(vec2, vec1))
  geom = geom / m
  beta = 0.3
  idx = zorder(geom)
  geom = geom[idx, ]
  a = a[idx]
  b = b[idx]
  distM = as.matrix(dist(geom))
  covM = exp(-distM / beta)
  df = 10
  pmvt(lower = a, upper = b, delta = 2, df = df,
       sigma = covM, uselog2 = FALSE, algorithm = GenzBretz(N = 521),
       type = "Kshirsagar")
  pmvt(lower = a, upper = b, delta = 2, df = df,
       uselog2 = TRUE, type = "shifted", geom = geom, 
       kernelType = "matern", para = c(1.0, 0.3, 0.5, 0.0))
  pmvt(lower = a, upper = b, delta = 2, df = df,
       sigma = covM, uselog2 = FALSE, 
       algorithm = TLRQMC(N = 521, m = m, epsl = epsl), type = "Kshirsagar")
  pmvt(lower = a, upper = b, delta = 2, df = df,
       uselog2 = TRUE, type = "shifted", geom = geom,
       algorithm = TLRQMC(N = 521, m = m, epsl = epsl),
       kernelType = "matern", para = c(1.0, 0.3, 0.5, 0.0))
</code></pre>

<hr>
<h2 id='tlrmvnmvt-package'>
Low-Rank Methods for MVN and MVT Probabilities
</h2><span id='topic+tlrmvnmvt'></span>

<h3>Description</h3>

<p>Implementation of the classic Genz algorithm and a novel tile-low-rank algorithm for computing	relatively high-dimensional multivariate normal (MVN) and Student-t (MVT) probabilities. 
	References used for this package:
	Foley, James, Andries van Dam, Steven Feiner, and John Hughes. 
	&quot;Computer Graphics: Principle and Practice&quot;. Addison-Wesley 
	Publishing Company. Reading, Massachusetts (1987, ISBN:0-201-84840-6 1);
	Genz, A., &quot;Numerical computation of multivariate
	normal probabilities,&quot; Journal of Computational and
	Graphical Statistics, 1, 141-149 (1992) &lt;doi:10.1080/10618600.1992.10477010&gt;;
    Cao, J., Genton, M. G., Keyes, D. E., &amp; Turkiyyah, G. M. &quot;Exploiting Low
    Rank Covariance Structures for Computing High-Dimensional Normal and Student-
    t Probabilities,&quot; Statistics and Computing, 31.1, 1-16 (2021) 
    &lt;doi:10.1007/s11222-020-09978-y&gt;;
    Cao, J., Genton, M. G., Keyes, D. E., &amp; Turkiyyah, G. M. &quot;tlrmvnmvt: 
    Computing High-Dimensional Multivariate Normal and Student-t Probabilities 
    with Low-Rank Methods in R,&quot; Journal of Statistical Software, 101.4, 
    1-25 (2022) &lt;doi:10.18637/jss.v101.i04&gt;.
</p>


<h3>Details</h3>

<p>Implementation of the classic Genz algorithm and a novel tile-low-rank algorithm for computing relatively high-dimensional multivariate normal and Student-t probabilities. For the Genz's algorithm (<code>GenzBretz</code>), we apply a univariate reordering preconditioner and for the tile-low-rank algorithms (<code>TLRQMC</code>), we apply a recursive block reordering preconditioner. The <code>GenzBretz</code> methods are different from their counterparts in the 'mvtnorm' package in that the 'tlrmvnmvt' package can accept any problem dimension and return the result in the log2 fashion, which is useful when the true probability is smaller than the machine precision. The <code>TLRQMC</code> algorithms can compute the probabilities up to tens of thousands of dimensions with the low-rank representation. However, this category of algorithms requires the existence of the low-rank property in the off-diagonal blocks of size <code>m</code>. The <code>zorder</code> function implements Morton's order in the 2D plane, which enhances the low-rank property of the produced covariance matrices.
</p>
<p>Package functions: pmvn, pmvt, zorder
</p>


<h3>Author(s)</h3>

<p>NA
</p>
<p>Maintainer: NA
</p>


<h3>References</h3>

<p>Cao, J., Genton, M. G., Keyes, D. E., &amp; Turkiyyah, G. M. (2022), &quot;tlrmvnmvt: Computing High-Dimensional Multivariate Normal and Student-t Probabilities with Low-Rank Methods in R,&quot; Journal of Statistical Software, 101.4, 1-25.
</p>

<hr>
<h2 id='zorder'>Index locations on the 2D plane</h2><span id='topic+zorder'></span>

<h3>Description</h3>

<p>Index a set of locations of the 2D plane with a Z-curve, when 
they are scaled into the unit square. The goal of this function 
is to make locations close in geometry also close in the index. When
partitioned into clusters, the inter-cluster correlation is more 
likely to be low-rank.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zorder(geom)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="zorder_+3A_geom">geom</code></td>
<td>
<p>2D geometry, each row represents the location of a variable. 
The geometry should be scaled into the unit square, (0,1) X (0,1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of indices based on the Z-curve.
</p>


<h3>Author(s)</h3>

<p>Jian Cao, Marc Genton, David Keyes, George Turkiyyah</p>


<h3>References</h3>

<p>Foley, James, Andries van Dam, Steven Feiner, and John Hughes. 
&quot;Computer Graphics: Principle and Practice&quot;. Addison-Wesley 
Publishing Company. Reading, Massachusetts: 1987. pages 870-871
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  n = 333
  set.seed(0)
  geom = matrix(runif(n*2), n, 2)
  idx = zorder(geom)
  idx
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
