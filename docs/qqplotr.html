<!DOCTYPE html><html><head><title>Help for package qqplotr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qqplotr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#geom_qq_band'><p>Quantile-quantile confidence bands</p></a></li>
<li><a href='#GeomQqBand'><p>GeomQqBand</p></a></li>
<li><a href='#iowa'><p>2012 BRFSS sample for the state of Iowa</p></a></li>
<li><a href='#longjump'><p>Men's Olympic Long Jump Qualifiers 2012</p></a></li>
<li><a href='#qqplotr'><p>Q-Q and P-P plot extensions for 'ggplot2'</p></a></li>
<li><a href='#runShinyExample'><p>'qqplotr' Example Shiny App</p></a></li>
<li><a href='#stat_pp_band'><p>Probability-probability confidence bands</p></a></li>
<li><a href='#stat_pp_line'><p>Probability-probability lines</p></a></li>
<li><a href='#stat_pp_point'><p>Probability-probability points</p></a></li>
<li><a href='#stat_qq_line'><p>Quantile-quantile lines</p></a></li>
<li><a href='#stat_qq_point'><p>Quantile-quantile points</p></a></li>
<li><a href='#StatPpBand'><p>StatPpBand</p></a></li>
<li><a href='#StatPpLine'><p>StatPpLine</p></a></li>
<li><a href='#StatPpPoint'><p>StatPpPoint</p></a></li>
<li><a href='#StatQqBand'><p>StatQqBand</p></a></li>
<li><a href='#StatQqLine'><p>StatQqLine</p></a></li>
<li><a href='#StatQqPoint'><p>StatQqPoint</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.6</td>
</tr>
<tr>
<td>Title:</td>
<td>Quantile-Quantile Plot Extensions for 'ggplot2'</td>
</tr>
<tr>
<td>Description:</td>
<td>Extensions of 'ggplot2' Q-Q plot functionalities.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/aloy/qqplotr">https://github.com/aloy/qqplotr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/aloy/qqplotr/issues">https://github.com/aloy/qqplotr/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>Collate:</td>
<td>'data.R' 'geom_qq_band.R' 'qqplotr.R' 'runShinyExample.R'
'stat_pp_band.R' 'stat_pp_line.R' 'stat_pp_point.R'
'stat_qq_line.R' 'stat_qq_band.R' 'stat_qq_point.R'</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1), ggplot2 (&ge; 2.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, robustbase, MASS, opdisDownsampling, qqconf (&ge; 1.3.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>shiny, devtools, lattice, shinyBS, knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-25 19:43:38 UTC; aloy</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexandre Almeida [aut],
  Adam Loy [aut, cre],
  Heike Hofmann [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adam Loy &lt;loyad01@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-25 21:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='geom_qq_band'>Quantile-quantile confidence bands</h2><span id='topic+geom_qq_band'></span><span id='topic+stat_qq_band'></span>

<h3>Description</h3>

<p>Draws quantile-quantile confidence bands, with an additional detrend option.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_qq_band(
  mapping = NULL,
  data = NULL,
  stat = "qq_band",
  position = "identity",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE,
  distribution = "norm",
  dparams = list(),
  detrend = FALSE,
  identity = FALSE,
  qtype = 7,
  qprobs = c(0.25, 0.75),
  bandType = "pointwise",
  B = 1000,
  conf = 0.95,
  mu = NULL,
  sigma = NULL,
  ...
)

stat_qq_band(
  mapping = NULL,
  data = NULL,
  geom = "qq_band",
  position = "identity",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE,
  distribution = "norm",
  dparams = list(),
  detrend = FALSE,
  identity = FALSE,
  qtype = 7,
  qprobs = c(0.25, 0.75),
  bandType = "pointwise",
  B = 1000,
  conf = 0.95,
  mu = NULL,
  sigma = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_qq_band_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_stat">stat</code></td>
<td>
<p>statistic to use to calculate confidence bands. Should be
'qq_band'.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_distribution">distribution</code></td>
<td>
<p>Character. Theoretical probability distribution function
to use. Do not provide the full distribution function name (e.g.,
<code>"dnorm"</code>). Instead, just provide its shortened name (e.g.,
<code>"norm"</code>). If you wish to provide a custom distribution, you may do so
by first creating the density, quantile, and random functions following the
standard nomenclature from the <code>stats</code> package (i.e., for
<code>"custom"</code>, create the <code>dcustom</code>, <code>pcustom</code>,
<code>qcustom</code>, and <code>rcustom</code> functions).</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_dparams">dparams</code></td>
<td>
<p>List of additional parameters passed on to the previously
chosen <code>distribution</code> function. If an empty list is provided (default)
then the distributional parameters are estimated via MLE. MLE for custom
distributions is currently not supported, so you must provide the
appropriate <code>dparams</code> in that case.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_detrend">detrend</code></td>
<td>
<p>Logical. Should the plot objects be detrended? If <code>TRUE</code>,
the objects will be detrended according to the reference Q-Q line. This
procedure was described by Thode (2002), and may help reducing visual bias
caused by the orthogonal distances from Q-Q points to the reference line.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_identity">identity</code></td>
<td>
<p>Logical. Should an identity line be used as the reference
line used to construct the confidence bands? If <code>TRUE</code>, the identity
line is used. If <code>FALSE</code> (default), the commonly-used Q-Q line that
intercepts two data quantiles specified in <code>qprobs</code> is used. Please
notice that the chosen reference line will also be used for the detrending
procedure, if <code>detrend = TRUE</code>.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_qtype">qtype</code></td>
<td>
<p>Integer between 1 and 9. Type of the quantile algorithm to be
used by the <code><a href="stats.html#topic+quantile">quantile</a></code> function to construct the Q-Q
line.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_qprobs">qprobs</code></td>
<td>
<p>Numeric vector of length two. Represents the quantiles used by
the <code><a href="stats.html#topic+quantile">quantile</a></code> function to construct the Q-Q line.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_bandtype">bandType</code></td>
<td>
<p>Character. Either <code>"pointwise"</code>, <code>"boot"</code>, <code>"ks"</code> or
<code>"ts"</code>, or <code>"ell"</code>. <code>"pointwise"</code> constructs pointwise confidence bands based
on Normal confidence intervals. <code>"boot"</code> creates pointwise confidence
bands based on a parametric bootstrap; parameters are estimated with MLEs.
<code>"ks"</code> constructs simultaneous confidence bands based on the Kolmogorov-Smirnov
test. <code>"ts"</code> constructs tail-sensitive confidence bands, as
described by Aldor-Noiman et al. (2013) (also, see 'Note' for
limitations). Finally, <code>"ell"</code> constructs simultaenous bands using the
equal local levels test describe by Weine et al. (2021).</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_b">B</code></td>
<td>
<p>Integer. If <code>bandType = "boot"</code>, then <code>B</code> is the number of
bootstrap replicates. If <code>bandType = "ts"</code>, then <code>B</code> is the
number of simulated samples.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_conf">conf</code></td>
<td>
<p>Numerical. Confidence level of the bands.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_mu">mu</code></td>
<td>
<p>Numerical. Only used if <code>bandType = "ts"</code>. Center
distributional parameter used to construct the simulated tail-sensitive
confidence bands. If either <code>mu</code> or <code>sigma</code> are <code>NULL</code>, then
those parameters are estimated using <code><a href="robustbase.html#topic+Qn">Qn</a></code> and
<code><a href="robustbase.html#topic+s_Qn">s_Qn</a></code>, respectively.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_sigma">sigma</code></td>
<td>
<p>Numerical. Only used if <code>bandType = "ts"</code>. Scale
distributional parameter used to construct the simulated tail-sensitive
confidence bands. If either <code>mu</code> or <code>sigma</code> are <code>NULL</code>, then
those parameters are estimated using robust estimates from the <span class="pkg">stats</span>
package.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
<tr><td><code id="geom_qq_band_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use to display the data, either as a
<code>ggproto</code> <code>Geom</code> subclass or as a string naming the geom stripped of the
<code>geom_</code> prefix (e.g. <code>"point"</code> rather than <code>"geom_point"</code>)</p>
</td></tr>
</table>


<h3>Note</h3>


<ul>
<li><p>Tail-sensitive confidence bands are only implemented for Normal Q-Q
plots. As a future update, we intend to generalize to other distributions.
</p>
</li>
<li><p>Bootstrap bands are constructed based on a MLE parametric bootstrap.
Hence, it is not possible to construct such bands if the sample and
theoretical distributions present mismatching supports.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p>Thode, H. (2002), Testing for Normality. CRC Press, 1st Ed.
</p>
</li>
<li><p><a href="https://www.tandfonline.com/doi/abs/10.1080/00031305.2013.847865">Aldor-Noiman,
S. et al. (2013). The Power to See: A New Graphical Test of Normality. The
American Statistician. 67:4.</a>
</p>
</li>
<li><p><a href="https://arxiv.org/abs/2111.15082">Weine, E. et al. (2021).
Application of Equal Local Levels to Improve Q-Q Plot Testing Bands with R
Package qqconf.</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># generate random Normal data
set.seed(0)
smp &lt;- data.frame(norm = rnorm(100))

# Normal Q-Q plot of Normal data
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_qq_band() +
 stat_qq_line() +
 stat_qq_point()
gg + labs(x = "Theoretical Quantiles", y = "Sample Quantiles")

# Normal Q-Q plot of Normal data with equal local levels (ell) bands
bt &lt;- "ell"
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_qq_band(bandType = bt) +
 stat_qq_line() +
 stat_qq_point() +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

# Exponential Q-Q plot of mean ozone levels (airquality dataset)
di &lt;- "exp"
dp &lt;- list(rate = 1)
gg &lt;- ggplot(data = airquality, mapping = aes(sample = Ozone)) +
 stat_qq_band(distribution = di, dparams = dp) +
 stat_qq_line(distribution = di, dparams = dp) +
 stat_qq_point(distribution = di, dparams = dp) +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

# Detrended Exponential Q-Q plot of mean ozone levels
di &lt;- "exp"
dp &lt;- list(rate = 1)
de &lt;- TRUE
gg &lt;- ggplot(data = airquality, mapping = aes(sample = Ozone)) +
 stat_qq_band(distribution = di, detrend = de) +
 stat_qq_line(distribution = di, detrend = de) +
 stat_qq_point(distribution = di, detrend = de) +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

## Not run: 
# Normal Q-Q plot of Normal data with bootstrap confidence bands
bt &lt;- "boot"
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_qq_band(bandType = bt) +
 stat_qq_line() +
 stat_qq_point() +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

# Normal Q-Q plot of Normal data with tail-sensitive confidence bands
bt &lt;- "ts"
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_qq_band(bandType = bt) +
 stat_qq_line() +
 stat_qq_point() +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

## End(Not run)


</code></pre>

<hr>
<h2 id='GeomQqBand'>GeomQqBand</h2><span id='topic+GeomQqBand'></span>

<h3>Description</h3>

<p>GeomQqBand
</p>


<h3>Format</h3>

<p>An object of class <code>GeomQqBand</code> (inherits from <code>Geom</code>, <code>ggproto</code>, <code>gg</code>) of length 6.
</p>

<hr>
<h2 id='iowa'>2012 BRFSS sample for the state of Iowa</h2><span id='topic+iowa'></span>

<h3>Description</h3>

<p>2012 BRFSS sample for the state of Iowa
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(iowa)
</code></pre>


<h3>Format</h3>

<p>A data frame with 7166 observations on 3 variables:
</p>

<dl>
<dt>SEX</dt><dd><p>Gender</p>
</dd>
<dt>WTKG3</dt><dd><p>Weight in kg</p>
</dd>
<dt>HTIN4</dt><dd><p>Height in inch</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.cdc.gov/brfss/annual_data/annual_2012.html">https://www.cdc.gov/brfss/annual_data/annual_2012.html</a>
</p>

<hr>
<h2 id='longjump'>Men's Olympic Long Jump Qualifiers 2012</h2><span id='topic+longjump'></span>

<h3>Description</h3>

<p>Men's Olympic Long Jump Qualifiers 2012
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(longjump)
</code></pre>


<h3>Format</h3>

<p>A data frame with 42 observations on the following 4 variables:
</p>

<dl>
<dt>rank</dt><dd><p>Athlete's rank at the qualifying event</p>
</dd>
<dt>name</dt><dd><p>Athlete's name</p>
</dd>
<dt>country</dt><dd><p>Athlete's country of origin</p>
</dd>
<dt>distance</dt><dd><p>Result in meters</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://olympics.com/en/olympic-games/london-2012/results/athletics/long-jump-men">https://olympics.com/en/olympic-games/london-2012/results/athletics/long-jump-men</a>
</p>

<hr>
<h2 id='qqplotr'>Q-Q and P-P plot extensions for 'ggplot2'</h2><span id='topic+qqplotr'></span>

<h3>Description</h3>

<p>This package extends some <code>ggplot2</code> functionalities by permitting the
drawing of both quantile-quantile (Q-Q) and probability-probability (P-P)
points, lines, and confidence bands. The functions of this package also allow
the detrend adjustment, proposed by Thode (2002), which helps reduce visual
bias when assessing those plots.
</p>


<h3>Details</h3>

<p>The functions of this package, presented as <code>ggplot2</code> Stats, are divided
into two groups: Q-Q and P-P related.
</p>
<p>Each of the groups is composed of three Stats: <code>point</code>, <code>line</code>, and
<code>band</code>. Those Stats, while independent, complement each other when
plotted together.
</p>

<hr>
<h2 id='runShinyExample'>'qqplotr' Example Shiny App</h2><span id='topic+runShinyExample'></span>

<h3>Description</h3>

<p>'qqplotr' Example Shiny App
</p>

<hr>
<h2 id='stat_pp_band'>Probability-probability confidence bands</h2><span id='topic+stat_pp_band'></span>

<h3>Description</h3>

<p>Draws probability-probability confidence bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_pp_band(
  mapping = NULL,
  data = NULL,
  geom = "ribbon",
  position = "identity",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE,
  distribution = "norm",
  dparams = list(),
  bandType = "boot",
  B = 1000,
  conf = 0.95,
  detrend = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_pp_band_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use to display the data, either as a
<code>ggproto</code> <code>Geom</code> subclass or as a string naming the geom stripped of the
<code>geom_</code> prefix (e.g. <code>"point"</code> rather than <code>"geom_point"</code>)</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_distribution">distribution</code></td>
<td>
<p>Character. Theoretical probability distribution function
to use. Do not provide the full distribution function name (e.g.,
<code>"dnorm"</code>). Instead, just provide its shortened name (e.g.,
<code>"norm"</code>). If you wish to provide a custom distribution, you may do so
by first creating the density, quantile, and random functions following the
standard nomenclature from the <code>stats</code> package (i.e., for
<code>"custom"</code>, create the <code>dcustom</code>, <code>pcustom</code>,
<code>qcustom</code>, and <code>rcustom</code> functions).</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_dparams">dparams</code></td>
<td>
<p>List of additional parameters passed on to the previously
chosen <code>distribution</code> function. If an empty list is provided (default)
then the distributional parameters are estimated via MLE. MLE for custom
distributions is currently not supported, so you must provide the
appropriate <code>dparams</code> in that case.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_bandtype">bandType</code></td>
<td>
<p>Character. Only <code>"boot"</code> and <code>"ell"</code> are available for now. <code>"boot"</code>
creates pointwise confidence bands based on a bootstrap. <code>"ell"</code>
constructs simultaenous bands using the equal local levels test.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_b">B</code></td>
<td>
<p>Integer. If <code>bandType = "boot"</code>, then <code>B</code> is the number of
bootstrap replicates.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_conf">conf</code></td>
<td>
<p>Numerical. Confidence level of the bands.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_detrend">detrend</code></td>
<td>
<p>Logical. Should the plot objects be detrended? If <code>TRUE</code>,
the objects will be detrended according to the default identity P-P line.
This procedure was described by Thode (2002), and may help reducing visual
bias caused by the orthogonal distances from P-P points to the reference
line.</p>
</td></tr>
<tr><td><code id="stat_pp_band_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li><p>Thode, H. (2002), Testing for Normality. CRC Press, 1st Ed.
</p>
</li>
<li><p><a href="https://www.tandfonline.com/doi/abs/10.1080/00031305.2013.847865">Aldor-Noiman,
S. et al. (2013). The Power to See: A New Graphical Test of Normality. The
American Statistician. 67:4.</a>
</p>
</li>
<li><p><a href="https://arxiv.org/abs/2111.15082">Weine, E. et al. (2021).
Application of Equal Local Levels to Improve Q-Q Plot Testing Bands with R
Package qqconf.</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># generate random Normal data
set.seed(0)
smp &lt;- data.frame(norm = rnorm(100), exp = rexp(100))

# Normal P-P plot of Normal data
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_pp_band() +
 stat_pp_line() +
 stat_pp_point() +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

# Shifted Normal P-P plot of Normal data
dp &lt;- list(mean = 1.5)
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_pp_band(dparams = dp, bandType = "ell") +
 stat_pp_line() +
 stat_pp_point(dparams = dp) +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

# Exponential P-P plot of Exponential data
di &lt;- "exp"
gg &lt;- ggplot(data = smp, mapping = aes(sample = exp)) +
 stat_pp_band(distribution = di, bandType = "ell") +
 stat_pp_line() +
 stat_pp_point(distribution = di) +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

## Not run: 
# Normal P-P plot of mean ozone levels (airquality dataset)
dp &lt;- list(mean = 38, sd = 27)
gg &lt;- ggplot(data = airquality, mapping = aes(sample = Ozone)) +
 stat_pp_band(dparams = dp) +
 stat_pp_line() +
	stat_pp_point(dparams = dp) +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

## End(Not run)

</code></pre>

<hr>
<h2 id='stat_pp_line'>Probability-probability lines</h2><span id='topic+stat_pp_line'></span>

<h3>Description</h3>

<p>Draws a probability-probability line.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_pp_line(
  mapping = NULL,
  data = NULL,
  geom = "path",
  position = "identity",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE,
  ab = c(0, 1),
  detrend = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_pp_line_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="stat_pp_line_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="stat_pp_line_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use to display the data, either as a
<code>ggproto</code> <code>Geom</code> subclass or as a string naming the geom stripped of the
<code>geom_</code> prefix (e.g. <code>"point"</code> rather than <code>"geom_point"</code>)</p>
</td></tr>
<tr><td><code id="stat_pp_line_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="stat_pp_line_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_pp_line_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="stat_pp_line_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="stat_pp_line_+3A_ab">ab</code></td>
<td>
<p>Numeric vector of length two. The intercept (<code>a</code>) and slope
(<code>b</code>) of the P-P line. Defaults to the identity line (<code>a = 0, b =
1</code>).</p>
</td></tr>
<tr><td><code id="stat_pp_line_+3A_detrend">detrend</code></td>
<td>
<p>Logical. Should the plot objects be detrended? If <code>TRUE</code>,
the objects will be detrended according to the default identity P-P line.
This procedure was described by Thode (2002), and may help reducing visual
bias caused by the orthogonal distances from P-P points to the reference
line.</p>
</td></tr>
<tr><td><code id="stat_pp_line_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># generate random Normal data
set.seed(0)
smp &lt;- data.frame(norm = rnorm(100))

# Normal P-P plot of Normal data
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_pp_line() +
 stat_pp_point() +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

# Shifted Normal P-P plot of Normal data
dp &lt;- list(mean = 1.5)
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_pp_line() +
 stat_pp_point(dparams = dp) +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

# Normal P-P plot of mean ozone levels (airquality dataset)
dp &lt;- list(mean = 38, sd = 27)
gg &lt;- ggplot(data = airquality, mapping = aes(sample = Ozone)) +
 stat_pp_line() +
	stat_pp_point(dparams = dp) +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

</code></pre>

<hr>
<h2 id='stat_pp_point'>Probability-probability points</h2><span id='topic+stat_pp_point'></span>

<h3>Description</h3>

<p>Draws probability-probability points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_pp_point(
  mapping = NULL,
  data = NULL,
  geom = "point",
  position = "identity",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE,
  distribution = "norm",
  dparams = list(),
  detrend = FALSE,
  down.sample = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_pp_point_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use to display the data, either as a
<code>ggproto</code> <code>Geom</code> subclass or as a string naming the geom stripped of the
<code>geom_</code> prefix (e.g. <code>"point"</code> rather than <code>"geom_point"</code>)</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_distribution">distribution</code></td>
<td>
<p>Character. Theoretical probability distribution function
to use. Do not provide the full distribution function name (e.g.,
<code>"dnorm"</code>). Instead, just provide its shortened name (e.g.,
<code>"norm"</code>). If you wish to provide a custom distribution, you may do so
by first creating the density, quantile, and random functions following the
standard nomenclature from the <code>stats</code> package (i.e., for
<code>"custom"</code>, create the <code>dcustom</code>, <code>pcustom</code>,
<code>qcustom</code>, and <code>rcustom</code> functions).</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_dparams">dparams</code></td>
<td>
<p>List of additional parameters passed on to the previously
chosen <code>distribution</code> function. If an empty list is provided (default)
then the distributional parameters are estimated via MLE. MLE for custom
distributions is currently not supported, so you must provide the
appropriate <code>dparams</code> in that case.</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_detrend">detrend</code></td>
<td>
<p>Logical. Should the plot objects be detrended? If <code>TRUE</code>,
the objects will be detrended according to the default identity P-P line.
This procedure was described by Thode (2002), and may help reducing visual
bias caused by the orthogonal distances from P-P points to the reference
line.</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_down.sample">down.sample</code></td>
<td>
<p>Integer specifying how many points you want to sample
in a reduced sample (i.e., a down sample). The default value is <code>NULL</code>
indicating no downsampling.</p>
</td></tr>
<tr><td><code id="stat_pp_point_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li><p>Thode, H. (2002), Testing for Normality. CRC Press, 1st Ed.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># generate random Normal data
set.seed(0)
smp &lt;- data.frame(norm = rnorm(100))

# Normal P-P plot of Normal data
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_pp_point() +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

# Shifted Normal P-P plot of Normal data
dp &lt;- list(mean = 1.5)
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_pp_point(dparams = dp) +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

# Normal P-P plot of mean ozone levels (airquality dataset)
dp &lt;- list(mean = 38, sd = 27)
gg &lt;- ggplot(data = airquality, mapping = aes(sample = Ozone)) +
	stat_pp_point(dparams = dp) +
 labs(x = "Probability Points", y = "Cumulative Probability")
gg

</code></pre>

<hr>
<h2 id='stat_qq_line'>Quantile-quantile lines</h2><span id='topic+stat_qq_line'></span>

<h3>Description</h3>

<p>Draws a quantile-quantile line, with an additional detrend option.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_qq_line(
  mapping = NULL,
  data = NULL,
  geom = "path",
  position = "identity",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE,
  distribution = "norm",
  dparams = list(),
  detrend = FALSE,
  identity = FALSE,
  qtype = 7,
  qprobs = c(0.25, 0.75),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_qq_line_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use to display the data, either as a
<code>ggproto</code> <code>Geom</code> subclass or as a string naming the geom stripped of the
<code>geom_</code> prefix (e.g. <code>"point"</code> rather than <code>"geom_point"</code>)</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_distribution">distribution</code></td>
<td>
<p>Character. Theoretical probability distribution function
to use. Do not provide the full distribution function name (e.g.,
<code>"dnorm"</code>). Instead, just provide its shortened name (e.g.,
<code>"norm"</code>). If you wish to provide a custom distribution, you may do so
by first creating the density, quantile, and random functions following the
standard nomenclature from the <code>stats</code> package (i.e., for
<code>"custom"</code>, create the <code>dcustom</code>, <code>pcustom</code>,
<code>qcustom</code>, and <code>rcustom</code> functions).</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_dparams">dparams</code></td>
<td>
<p>List of additional parameters passed on to the previously
chosen <code>distribution</code> function. If an empty list is provided (default)
then the distributional parameters are estimated via MLE. MLE for custom
distributions is currently not supported, so you must provide the
appropriate <code>dparams</code> in that case.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_detrend">detrend</code></td>
<td>
<p>Logical. Should the plot objects be detrended? If <code>TRUE</code>,
the objects will be detrended according to the reference Q-Q line. This
procedure was described by Thode (2002), and may help reducing visual bias
caused by the orthogonal distances from Q-Q points to the reference line.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_identity">identity</code></td>
<td>
<p>Logical. Should an identity line be used as the reference
line? If <code>TRUE</code>, the identity line is used. If <code>FALSE</code> (default),
the commonly-used Q-Q line that intercepts two data quantiles specified in
<code>qprobs</code> is used. Please notice that the chosen reference line will
also be used for the detrending procedure, if <code>detrend = TRUE</code>.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_qtype">qtype</code></td>
<td>
<p>Integer between 1 and 9. Only used if <code>detrend = TRUE</code> and
<code>identity =  FALSE</code>. Type of the quantile algorithm to be used by the
<code><a href="stats.html#topic+quantile">quantile</a></code> function to construct the Q-Q line.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_qprobs">qprobs</code></td>
<td>
<p>Numeric vector of length two. Only used if <code>detrend =
TRUE</code> and <code>identity =  FALSE</code>. Represents the quantiles used by the
<code><a href="stats.html#topic+quantile">quantile</a></code> function to construct the Q-Q line.</p>
</td></tr>
<tr><td><code id="stat_qq_line_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li><p>Thode, H. (2002), Testing for Normality. CRC Press, 1st Ed.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># generate random Normal data
set.seed(0)
smp &lt;- data.frame(norm = rnorm(100))

# Normal Q-Q plot of Normal data
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_qq_line() +
 stat_qq_point() +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

# Exponential Q-Q plot of mean ozone levels (airquality dataset)
di &lt;- "exp"
dp &lt;- list(rate = 1)
gg &lt;- ggplot(data = airquality, mapping = aes(sample = Ozone)) +
 stat_qq_line(distribution = di, dparams = dp) +
 stat_qq_point(distribution = di, dparams = dp) +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

# Detrended Exponential Q-Q plot of mean ozone levels
di &lt;- "exp"
dp &lt;- list(rate = 1)
de &lt;- TRUE
gg &lt;- ggplot(data = airquality, mapping = aes(sample = Ozone)) +
 stat_qq_line(distribution = di, detrend = de) +
 stat_qq_point(distribution = di, detrend = de) +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

</code></pre>

<hr>
<h2 id='stat_qq_point'>Quantile-quantile points</h2><span id='topic+stat_qq_point'></span>

<h3>Description</h3>

<p>Draws quantile-quantile points, with an additional detrend option.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_qq_point(
  mapping = NULL,
  data = NULL,
  geom = "point",
  position = "identity",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE,
  distribution = "norm",
  dparams = list(),
  detrend = FALSE,
  identity = FALSE,
  qtype = 7,
  qprobs = c(0.25, 0.75),
  down.sample = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_qq_point_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use to display the data, either as a
<code>ggproto</code> <code>Geom</code> subclass or as a string naming the geom stripped of the
<code>geom_</code> prefix (e.g. <code>"point"</code> rather than <code>"geom_point"</code>)</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string naming the adjustment
(e.g. <code>"jitter"</code> to use <code>position_jitter</code>), or the result of a call to a
position adjustment function. Use the latter if you need to change the
settings of the adjustment.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with
a warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.
It can also be a named logical vector to finely select the aesthetics to
display.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_distribution">distribution</code></td>
<td>
<p>Character. Theoretical probability distribution function
to use. Do not provide the full distribution function name (e.g.,
<code>"dnorm"</code>). Instead, just provide its shortened name (e.g.,
<code>"norm"</code>). If you wish to provide a custom distribution, you may do so
by first creating the density, quantile, and random functions following the
standard nomenclature from the <code>stats</code> package (i.e., for
<code>"custom"</code>, create the <code>dcustom</code>, <code>pcustom</code>,
<code>qcustom</code>, and <code>rcustom</code> functions).</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_dparams">dparams</code></td>
<td>
<p>List of additional parameters passed on to the previously
chosen <code>distribution</code> function. If an empty list is provided (default)
then the distributional parameters are estimated via MLE. MLE for custom
distributions is currently not supported, so you must provide the
appropriate <code>dparams</code> in that case.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_detrend">detrend</code></td>
<td>
<p>Logical. Should the plot objects be detrended? If <code>TRUE</code>,
the objects will be detrended according to the reference Q-Q line. This
procedure was described by Thode (2002), and may help reducing visual bias
caused by the orthogonal distances from Q-Q points to the reference line.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_identity">identity</code></td>
<td>
<p>Logical. Only used if <code>detrend = TRUE</code>. Should an
identity line be used as the reference line for the plot detrending? If
<code>TRUE</code>, the points will be detrended according to the reference
identity line. If <code>FALSE</code> (default), the commonly-used Q-Q line that
intercepts two data quantiles specified in <code>qprobs</code> is used.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_qtype">qtype</code></td>
<td>
<p>Integer between 1 and 9. Only used if <code>detrend = TRUE</code> and
<code>identity =  FALSE</code>. Type of the quantile algorithm to be used by the
<code><a href="stats.html#topic+quantile">quantile</a></code> function to construct the Q-Q line.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_qprobs">qprobs</code></td>
<td>
<p>Numeric vector of length two. Only used if <code>detrend =
TRUE</code> and <code>identity =  FALSE</code>. Represents the quantiles used by the
<code><a href="stats.html#topic+quantile">quantile</a></code> function to construct the Q-Q line.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_down.sample">down.sample</code></td>
<td>
<p>Integer specifying how many points you want to sample
in a reduced sample (i.e., a down sample). The default value is <code>NULL</code>
indicating no downsampling.</p>
</td></tr>
<tr><td><code id="stat_qq_point_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer()</a></code>. These are
often aesthetics, used to set an aesthetic to a fixed value, like
<code>colour = "red"</code> or <code>size = 3</code>. They may also be parameters
to the paired geom/stat.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li><p>Thode, H. (2002), Testing for Normality. CRC Press, 1st Ed.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># generate random Normal data
set.seed(0)
smp &lt;- data.frame(norm = rnorm(100))

# Normal Q-Q plot of simulated Normal data
gg &lt;- ggplot(data = smp, mapping = aes(sample = norm)) +
 stat_qq_point() +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

# Exponential Q-Q plot of mean ozone levels (airquality dataset)
di &lt;- "exp"
dp &lt;- list(rate = 1)
gg &lt;- ggplot(data = airquality, mapping = aes(sample = Ozone)) +
 stat_qq_point(distribution = di, dparams = dp) +
 labs(x = "Theoretical Quantiles", y = "Sample Quantiles")
gg

</code></pre>

<hr>
<h2 id='StatPpBand'>StatPpBand</h2><span id='topic+StatPpBand'></span>

<h3>Description</h3>

<p>StatPpBand
</p>


<h3>Format</h3>

<p>An object of class <code>StatPpBand</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 5.
</p>

<hr>
<h2 id='StatPpLine'>StatPpLine</h2><span id='topic+StatPpLine'></span>

<h3>Description</h3>

<p>StatPpLine
</p>


<h3>Format</h3>

<p>An object of class <code>StatPpLine</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 5.
</p>

<hr>
<h2 id='StatPpPoint'>StatPpPoint</h2><span id='topic+StatPpPoint'></span>

<h3>Description</h3>

<p>StatPpPoint
</p>


<h3>Format</h3>

<p>An object of class <code>StatPpPoint</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 5.
</p>

<hr>
<h2 id='StatQqBand'>StatQqBand</h2><span id='topic+StatQqBand'></span>

<h3>Description</h3>

<p>StatQqBand
</p>


<h3>Format</h3>

<p>An object of class <code>StatQqBand</code> (inherits from <code>StatQqLine</code>, <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 5.
</p>

<hr>
<h2 id='StatQqLine'>StatQqLine</h2><span id='topic+StatQqLine'></span>

<h3>Description</h3>

<p>StatQqLine
</p>


<h3>Format</h3>

<p>An object of class <code>StatQqLine</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 5.
</p>

<hr>
<h2 id='StatQqPoint'>StatQqPoint</h2><span id='topic+StatQqPoint'></span>

<h3>Description</h3>

<p>StatQqPoint
</p>


<h3>Format</h3>

<p>An object of class <code>StatQqPoint</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 5.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
