<!DOCTYPE html><html lang="en"><head><title>Help for package basket</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {basket}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#basket-package'><p>Basket Trial Analysis</p></a></li>
<li><a href='#basket'><p>Create a Basket Trial Analysis</p></a></li>
<li><a href='#basket_map'><p>Get the Basketwise Maximum A Posteriori Probability Matrix</p></a></li>
<li><a href='#basket_name'><p>The Names of the Baskets</p></a></li>
<li><a href='#basket_pep'><p>The Basketwise Posterior Exchangeability Probability Matrix</p></a></li>
<li><a href='#cluster_baskets'><p>Get the Cluster Members of MEM Models</p></a></li>
<li><a href='#cluster_map'><p>Get the Clusterwise Maximum A Posteriori Probability Matrix</p></a></li>
<li><a href='#cluster_membership'><p>Cluster Baskets Based on the Posterior Exchangeabilities</p></a></li>
<li><a href='#cluster_pep'><p>Get the Clusterwise Posterior Exchangeability Matrix</p></a></li>
<li><a href='#get_seed'><p>Get the Current Random Seed</p></a></li>
<li><a href='#mem_exact'><p>Fit the Exact MEM Model</p></a></li>
<li><a href='#mem_mcmc'><p>Fit the MEM Model using MCMC</p></a></li>
<li><a href='#plot_density'><p>Plot the Response Densities in Basket Trials</p></a></li>
<li><a href='#plot_map'><p>Plot the Map Exchangeability of a Basket Trial</p></a></li>
<li><a href='#plot_mem'><p>Plot the Prior, MAP, and PEP of a Basket Trial</p></a></li>
<li><a href='#plot_pep'><p>Plot the Posterior Exchangeability of a Basket Trial</p></a></li>
<li><a href='#plot_pep_graph'><p>Plot a Network Graph of the PEP Matrix</p></a></li>
<li><a href='#sample_posterior'><p>Sample Posterior Samples from a Basket Trial</p></a></li>
<li><a href='#update_p0'><p>Update Full Bayes results with different p0 values</p></a></li>
<li><a href='#vemu'><p>Summary Data from the Vemurafenib Study</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Basket Trial Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.10.11</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of multisource exchangeability models for Bayesian analyses of prespecified subgroups arising in the context of basket trial design and monitoring.  The R 'basket' package facilitates implementation of the binary, symmetric multi-source exchangeability model (MEM) with posterior inference arising from both exact computation and Markov chain Monte Carlo sampling. Analysis output includes full posterior samples as well as posterior probabilities, highest posterior density (HPD) interval boundaries, effective sample sizes (ESS), mean and median estimations, posterior exchangeability probability matrices, and maximum a posteriori MEMs. In addition to providing "basketwise" analyses, the package includes similar calculations for "clusterwise" analyses for which subgroups are combined into meta-baskets, or clusters, using graphical clustering algorithms that treat the posterior exchangeability probabilities as edge weights. In addition plotting tools are provided to visualize basket and cluster densities as well as their exchangeability.  References include Hyman, D.M., Puzanov, I., Subbiah, V., Faris, J.E., Chau, I., Blay, J.Y., Wolf, J., Raje, N.S., Diamond, E.L., Hollebecque, A. and Gervais, R (2015) &lt;<a href="https://doi.org/10.1056%2FNEJMoa1502309">doi:10.1056/NEJMoa1502309</a>&gt;; Hobbs, B.P. and Landin, R. (2018) &lt;<a href="https://doi.org/10.1002%2Fsim.7893">doi:10.1002/sim.7893</a>&gt;; Hobbs, B.P., Kane, M.J., Hong, D.S. and Landin, R. (2018) &lt;<a href="https://doi.org/10.1093%2Fannonc%2Fmdy457">doi:10.1093/annonc/mdy457</a>&gt;; and Kaizer, A.M., Koopmeiners, J.S. and Hobbs, B.P. (2017) &lt;<a href="https://doi.org/10.1093%2Fbiostatistics%2Fkxx031">doi:10.1093/biostatistics/kxx031</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2">LGPL-2</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael J. Kane &lt;michael.kane@yale.edu&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>GenSA, foreach, ggplot2, stats, tibble, tidyr, dplyr, igraph,
gridExtra, itertools, crayon, cli, RColorBrewer, tidygraph,
ggraph,</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kaneplusplus/basket">https://github.com/kaneplusplus/basket</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kaneplusplus/basket/issues">https://github.com/kaneplusplus/basket/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), doParallel</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-14 19:42:41 UTC; mike</td>
</tr>
<tr>
<td>Author:</td>
<td>Nan Chen [aut],
  Ryan Hafen [ctb],
  Brian Hobbs [aut],
  Alex Kaizer [aut],
  Michael J. Kane <a href="https://orcid.org/0000-0003-1899-6662"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-16 23:30:22 UTC</td>
</tr>
</table>
<hr>
<h2 id='basket-package'>Basket Trial Analysis</h2><span id='topic+basket-package'></span>

<h3>Description</h3>

<p>The R basket package provides for the designs and analysis of
basket trials for multi-source exchangeability models (MEM)
&lt;https://doi.org/10.1093/biostatistics/kxx031&gt;
allowing arms to &quot;share&quot; power with similar arms in a trial. The package
is intended to perform the exact or MCMC computation of the operating
characteristics of different scenarios. Calculations derived from these
analyses include the posterior probabilities, HPD boundaries, effective
sample sizes (ESS), mean and median estimations can be calculated with
this package using the MEM method. Along with providing &quot;basketwise&quot;
analyses, the package includes similar calculations for &quot;clusterwise&quot;
analyses where a cluster a set of similar baskets. In addition plotting
tools are provided to visualize basket and cluster density as well as their
exchangeability. The package includes the following main functions:
</p>

<ul>
<li><p>[basket_name()] Get the basket names in an analysis
</p>
</li>
<li><p>[basket_pep()] Get the Posterior Exchangeability Probability
(PEP) matrix for the arms in the trial.
</p>
</li>
<li><p>[basket_map()] Get the Maximum A Posteriori (MAP) matrix for the
arms in a trial.
</p>
</li>
<li><p>[cluster_pep()] Get the Posterior Exchangeability Probability
(PEP) matrix for the arms in the trial.
</p>
</li>
<li><p>[cluster_map()] Get the Maximum A Posteriori (MAP) matrix for
the arms in a trial.
</p>
</li>
<li><p>[sample_posterior()] Sample from the posterior distribution of
the arms in the trial.
</p>
</li>
<li><p>[mem_exact()] Create a basket analysis using the exact method.
</p>
</li>
<li><p>[mem_mcmc()] Create a basket analysis using the exact method.
</p>
</li>
<li><p>[summary()] Summarize the results of an analysis.
</p>
</li>
<li><p>[update_p0()] Update the null that a basket response rate is
above a specified value.
</p>
</li>
<li><p>[plot_density()] Plot the estimated densities of arms or clusters.
</p>
</li>
<li><p>[plot_pep()] Show the exchangeogram of the PEP matrix.
</p>
</li>
<li><p>[plot_mem()] Plot the arm prior, MAP, and PEP of a basket trial.
</p>
</li></ul>



<h3>References</h3>

<p>Vemurafenib in multiple nonmelanoma cancers with braf v600
mutations Hyman DM, Puzanov I, Subbiah V, Faris JE, Chau I, Blay JY,
Wolf J, Raje NS, Diamond EL, Hollebecque A, et al.
New England Journal of Medicine 2015; 373(8):726â€“736.
&lt;https://doi:10.1056/NEJMoa1502309&gt;
</p>
<p>Bayesian basket trial design with exchangeability monitoring
BP Hobbs, R Landin Statistics in medicine 37 (25), 3557-357.
&lt;https://doi.org/10.1002/sim.7893&gt;
</p>
<p>Statistical challenges posed by uncontrolled master protocols:
sensitivity analysis of the vemurafenib study BP Hobbs, MJ Kane, DS Hong,
R Landin Annals of Oncology 29 (12), 2296-2301. &lt;doi:10.1093/annonc/mdy457&gt;
</p>
<p>Bayesian hierarchical modeling based on multisource
exchangeability AM Kaizer, JS Koopmeiners, BP Hobbs Biostatistics 19 (2),
169-184. &lt;https://doi.org/10.1093/biostatistics/kxx031&gt;
</p>

<hr>
<h2 id='basket'>Create a Basket Trial Analysis</h2><span id='topic+basket'></span>

<h3>Description</h3>

<p>This function creates an analysis modeling the exchangeability
and distribution characteristics of cohorts in a basket trial, where
a single therapy is given to multiple cohorts. The model is based on the
multi-source exchangeability model. This is a generalization of the
Bayesian hierarchical model and it accomodates multiple sets of latent
factors shared combinations of cohorts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basket(
  responses,
  size,
  name,
  p0 = 0.15,
  shape1 = 0.5,
  shape2 = 0.5,
  prior = diag(length(responses))/2 + matrix(0.5, nrow = length(responses), ncol =
    length(responses)),
  hpd_alpha = 0.05,
  alternative = "greater",
  call = NULL,
  cluster_function = cluster_membership,
  method = c("mcmc", "lmem", "exact"),
  mcmc_iter = 2e+05,
  mcmc_burnin = 50000,
  initial_mem = round(prior - 0.001),
  cluster_analysis = FALSE,
  seed = get_seed()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="basket_+3A_responses">responses</code></td>
<td>
<p>the number of responses in each basket.</p>
</td></tr>
<tr><td><code id="basket_+3A_size">size</code></td>
<td>
<p>the size of each basket.</p>
</td></tr>
<tr><td><code id="basket_+3A_name">name</code></td>
<td>
<p>the name of each basket.</p>
</td></tr>
<tr><td><code id="basket_+3A_p0">p0</code></td>
<td>
<p>the null response rate for the poster probability calculation.
(default 0.15)</p>
</td></tr>
<tr><td><code id="basket_+3A_shape1">shape1</code></td>
<td>
<p>the first shape parameter(s) for the prior of each basket.
(default 0.5)</p>
</td></tr>
<tr><td><code id="basket_+3A_shape2">shape2</code></td>
<td>
<p>the second shape parameter(s) for the prior of each basket.
(default 0.5)</p>
</td></tr>
<tr><td><code id="basket_+3A_prior">prior</code></td>
<td>
<p>the matrix giving the prior inclusion probability
for each pair of baskets. The default is on on the main diagonal and 0.5
elsewhere.</p>
</td></tr>
<tr><td><code id="basket_+3A_hpd_alpha">hpd_alpha</code></td>
<td>
<p>the highest posterior density trial significance.
(default 0.05)</p>
</td></tr>
<tr><td><code id="basket_+3A_alternative">alternative</code></td>
<td>
<p>the alternative case definition (default &quot;greater&quot;).</p>
</td></tr>
<tr><td><code id="basket_+3A_call">call</code></td>
<td>
<p>the call of the function. (default NULL)</p>
</td></tr>
<tr><td><code id="basket_+3A_cluster_function">cluster_function</code></td>
<td>
<p>a function to cluster baskets.</p>
</td></tr>
<tr><td><code id="basket_+3A_method">method</code></td>
<td>
<p>&quot;mcmc&quot;, &quot;lmem&quot; (local MEM),  or &quot;exact&quot;. See details for an 
explanation.
(default &quot;mcmc&quot;)</p>
</td></tr>
<tr><td><code id="basket_+3A_mcmc_iter">mcmc_iter</code></td>
<td>
<p>if the method is &quot;mcmc&quot; then this spcifies the number of
mcmc iterations. Otherwise, it is ignored. (default 200000)</p>
</td></tr>
<tr><td><code id="basket_+3A_mcmc_burnin">mcmc_burnin</code></td>
<td>
<p>if the method is &quot;mcmc&quot; then this specifies the number of
burn-in iterations. (default 50000)</p>
</td></tr>
<tr><td><code id="basket_+3A_initial_mem">initial_mem</code></td>
<td>
<p>if the method is &quot;mcmc&quot; then this spcifies the initial
MEM matrix. Otherwise, it is ignored.</p>
</td></tr>
<tr><td><code id="basket_+3A_cluster_analysis">cluster_analysis</code></td>
<td>
<p>if the cluster analysis is conducted.</p>
</td></tr>
<tr><td><code id="basket_+3A_seed">seed</code></td>
<td>
<p>the random seed for the mcmc calculations. By default this is
.Random.seed. If this value is not initialized, then it is first initialized
with Sys.time() and then returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model may be fit using an exact calculation via
mcmc, or a local version of MEM. The first conducts posterior inference 
through the entire set of
exchangeability relationships in the sample domain. This approach is
computationally feasible only when the number of cohorts is relatively
small. As a rule of thumb this option should be used with a maximum of
20 cohorts.  By default, the second(mcmc) is used and it is based on
the Metropolis algorithm and it extends the model's implementation to
larger collections of subpopulations. The algorithm initiates with a
burn-in period (see mcmc_burnin), which are discarded from the analysis.
The third is based on a recent paper by Wei et al. The calculation
is computationally efficient and tends to borrow to a lesser extent
than other implemented methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 3 baskets, each with enrollement size 5
trial_sizes &lt;- rep(5, 3)

# The response rates for the baskets.
resp_rate &lt;- 0.15

# The trials: a column of the number of responses and a column of the
# the size of each trial.
trials &lt;- data.frame(
  responses = rbinom(trial_sizes, trial_sizes, resp_rate),
  size = trial_sizes,
  name = letters[1:3]
)

summary(basket(trials$responses, trials$size, trials$name))

</code></pre>

<hr>
<h2 id='basket_map'>Get the Basketwise Maximum A Posteriori Probability Matrix</h2><span id='topic+basket_map'></span>

<h3>Description</h3>

<p>MEM analyses include the maximum a posterior exchangeability
probability (MAP) of included arms indicating whether
two arms in the trial are exchangeable. This function returns the matrix
of those relationships.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basket_map(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="basket_map_+3A_x">x</code></td>
<td>
<p>either an exchangeability model or basket object.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets
)

# Get basket MAPs.
basket_map(mem_analysis)

</code></pre>

<hr>
<h2 id='basket_name'>The Names of the Baskets</h2><span id='topic+basket_name'></span>

<h3>Description</h3>

<p>Retrieve the basket names in an exchangeability model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basket_name(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="basket_name_+3A_model">model</code></td>
<td>
<p>the model to retrieve the basket names of</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# 3 baskets, each with enrollement size 5
trial_sizes &lt;- rep(5, 3)

# The response rates for the baskets.
resp_rate &lt;- 0.15

# The trials: a column of the number of responses and a column of the
# the size of each trial.
trials &lt;- data.frame(
  responses = rbinom(trial_sizes, trial_sizes, resp_rate),
  size = trial_sizes,
  name = paste("Basket", seq_len(3))
)

basket_name(mem_mcmc(trials$responses, trials$size, trials$basket))

</code></pre>

<hr>
<h2 id='basket_pep'>The Basketwise Posterior Exchangeability Probability Matrix</h2><span id='topic+basket_pep'></span>

<h3>Description</h3>

<p>MEM analyses include the posterior exchangeability
probability (PEP) of included arms giving the probability
that any two arms are exchangeable. This function returns the matrix
of those probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basket_pep(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="basket_pep_+3A_x">x</code></td>
<td>
<p>either an exchangeability model or basket object.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets
)

# Get the PEP for baskets.
basket_pep(mem_analysis)

</code></pre>

<hr>
<h2 id='cluster_baskets'>Get the Cluster Members of MEM Models</h2><span id='topic+cluster_baskets'></span>

<h3>Description</h3>

<p>Object returned by the 'mem_mcmc()' and 'mem_exact()' include
information about the arms in the trials and the cluster
composed of sets of similar arms. This function returns the name
of each arm in a cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster_baskets(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster_baskets_+3A_x">x</code></td>
<td>
<p>either an exchangeability model or basket object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list is returned where the name is the cluster name and
each element of the list is comprise do a character vector of the
baskets in each cluster.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets,
  cluster_analysis = TRUE
)

# Get the baskets in the clusters.
cluster_baskets(mem_analysis)

</code></pre>

<hr>
<h2 id='cluster_map'>Get the Clusterwise Maximum A Posteriori Probability Matrix</h2><span id='topic+cluster_map'></span>

<h3>Description</h3>

<p>MEM analyses include the maximum a posterior exchangeability
probability (MAP) of included arms indicating whether
two arms in the trial are exchangeable. This function returns the matrix
of those relationships.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster_map(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster_map_+3A_x">x</code></td>
<td>
<p>either an exchangeability model or basket object.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets
)

# Get the cluster MAPs.
cluster_map(mem_analysis)

</code></pre>

<hr>
<h2 id='cluster_membership'>Cluster Baskets Based on the Posterior Exchangeabilities</h2><span id='topic+cluster_membership'></span>

<h3>Description</h3>

<p>This is the default function used to cluster cohorts in the
<code>basket</code>, <code>mem_mcmc</code>, and <code>mem_exact</code> functions.
The approach creates a graph where each vertex is a cohort and the
weight between two cohorts is determined by their posterior exchangeability
probability. The graph is then clustered using <span class="pkg">igraph</span>'s
<code>louvain</code> function, which determines the number of clusters and
the cluster memberships, and has been shown to perform well with
real clinical data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster_membership(m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster_membership_+3A_m">m</code></td>
<td>
<p>the adjacency matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A factor variable with cluster memberships for each cohort in
the study.
</p>


<h3>See Also</h3>

<p>basket mem_mcmc mem_exact
</p>

<hr>
<h2 id='cluster_pep'>Get the Clusterwise Posterior Exchangeability Matrix</h2><span id='topic+cluster_pep'></span>

<h3>Description</h3>

<p>MEM analyses include the posterior exchangeability
probability (PEP) of clusters of arms giving the probability
that any two arms are exchangeable. This function returns the matrix
of those probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster_pep(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster_pep_+3A_x">x</code></td>
<td>
<p>either an exchangeability model or basket object.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets
)

# Get cluster PEPs.
basket_pep(mem_analysis)

</code></pre>

<hr>
<h2 id='get_seed'>Get the Current Random Seed</h2><span id='topic+get_seed'></span>

<h3>Description</h3>

<p>Get the value of the current random seed. If one has not been
initialized, then initialize it and return the new seed value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_seed()
</code></pre>

<hr>
<h2 id='mem_exact'>Fit the Exact MEM Model</h2><span id='topic+mem_exact'></span>

<h3>Description</h3>

<p>Fit the MEM model using full Bayesian inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mem_exact(
  responses,
  size,
  name,
  p0 = 0.15,
  shape1 = 0.5,
  shape2 = 0.5,
  prior = diag(length(responses))/2 + matrix(0.5, nrow = length(responses), ncol =
    length(responses)),
  hpd_alpha = 0.05,
  alternative = "greater",
  seed = 1000,
  cluster_analysis = FALSE,
  call = NULL,
  cluster_function = cluster_membership
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mem_exact_+3A_responses">responses</code></td>
<td>
<p>the number of responses in each basket.</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_size">size</code></td>
<td>
<p>the size of each basket.</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_name">name</code></td>
<td>
<p>the name of each basket.</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_p0">p0</code></td>
<td>
<p>the null response rate for the poster probability calculation
(default 0.15).</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_shape1">shape1</code></td>
<td>
<p>the first shape parameter(s) for the prior of each basket
(default 0.5).</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_shape2">shape2</code></td>
<td>
<p>the second shape parameter(s) for the prior of each basket
(default 0.5).</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_prior">prior</code></td>
<td>
<p>the matrix giving the prior inclusion probability
for each pair of baskets. The default is on on the main diagonal and 0.5
elsewhere.</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_hpd_alpha">hpd_alpha</code></td>
<td>
<p>the highest posterior density trial significance.</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_alternative">alternative</code></td>
<td>
<p>the alternative case definition (default greater)</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_seed">seed</code></td>
<td>
<p>the random number seed.</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_cluster_analysis">cluster_analysis</code></td>
<td>
<p>if the cluster analysis is conducted.</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_call">call</code></td>
<td>
<p>the call of the function (default NULL).</p>
</td></tr>
<tr><td><code id="mem_exact_+3A_cluster_function">cluster_function</code></td>
<td>
<p>a function to cluster baskets</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>cluster_membership
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 3 baskets, each with enrollement size 5
trial_sizes &lt;- rep(5, 3)

# The response rates for the baskets.
resp_rate &lt;- 0.15

# The trials: a column of the number of responses and a column of the
# the size of each trial.
trials &lt;- data.frame(
  responses = rbinom(trial_sizes, trial_sizes, resp_rate),
  size = trial_sizes,
  name = letters[1:3]
)

summary(mem_exact(trials$responses, trials$size, trials$name))

</code></pre>

<hr>
<h2 id='mem_mcmc'>Fit the MEM Model using MCMC</h2><span id='topic+mem_mcmc'></span>

<h3>Description</h3>

<p>Fit the MEM model using Bayesian Metropolis-Hasting MCMC
inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mem_mcmc(
  responses,
  size,
  name,
  p0 = 0.15,
  shape1 = 0.5,
  shape2 = 0.5,
  prior = diag(length(responses))/2 + matrix(0.5, nrow = length(responses), ncol =
    length(responses)),
  hpd_alpha = 0.05,
  alternative = "greater",
  mcmc_iter = 2e+05,
  mcmc_burnin = 50000,
  initial_mem = round(prior - 0.001),
  seed = 1000,
  cluster_analysis = FALSE,
  call = NULL,
  cluster_function = cluster_membership
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mem_mcmc_+3A_responses">responses</code></td>
<td>
<p>the number of responses in each basket.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_size">size</code></td>
<td>
<p>the size of each basket.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_name">name</code></td>
<td>
<p>the name of each basket.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_p0">p0</code></td>
<td>
<p>the null response rate for the poster probability calculation
(default 0.15).</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_shape1">shape1</code></td>
<td>
<p>the first shape parameter(s) for the prior of each basket
(default 0.5).</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_shape2">shape2</code></td>
<td>
<p>the second shape parameter(s) for the prior of each basket
(default 0.5).</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_prior">prior</code></td>
<td>
<p>the matrix giving the prior inclusion probability
for each pair of baskets. The default is on on the main diagonal and 0.5
elsewhere.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_hpd_alpha">hpd_alpha</code></td>
<td>
<p>the highest posterior density trial significance.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_alternative">alternative</code></td>
<td>
<p>the alternative case definition (default greater)</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_mcmc_iter">mcmc_iter</code></td>
<td>
<p>the number of MCMC iterations.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_mcmc_burnin">mcmc_burnin</code></td>
<td>
<p>the number of MCMC Burn_in iterations.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_initial_mem">initial_mem</code></td>
<td>
<p>the initial MEM matrix.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_seed">seed</code></td>
<td>
<p>the random number seed.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_cluster_analysis">cluster_analysis</code></td>
<td>
<p>if the cluster analysis is conducted.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_call">call</code></td>
<td>
<p>the call of the function.</p>
</td></tr>
<tr><td><code id="mem_mcmc_+3A_cluster_function">cluster_function</code></td>
<td>
<p>a function to cluster baskets</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# 3 baskets, each with enrollement size 5
trial_sizes &lt;- rep(5, 3)

# The response rates for the baskets.
resp_rate &lt;- 0.15

# The trials: a column of the number of responses and a column of the
# the size of each trial.
trials &lt;- data.frame(
  responses = rbinom(trial_sizes, trial_sizes, resp_rate),
  size = trial_sizes,
  name = letters[1:3]
)
res &lt;- mem_mcmc(trials$responses, trials$size)

</code></pre>

<hr>
<h2 id='plot_density'>Plot the Response Densities in Basket Trials</h2><span id='topic+plot_density'></span>

<h3>Description</h3>

<p>The MEM analysis calculates the probability of exchangeability
of baskets and clusters in a basket trial. This function creates density
plots of the response rates of each basket or each cluster under the MEM
design taking into account the extent to which power can be borrowed from
similar trials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_density(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_density_+3A_x">x</code></td>
<td>
<p>the exchangeability model.</p>
</td></tr>
<tr><td><code id="plot_density_+3A_...">...</code></td>
<td>
<p>other options. See Details for more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ... options can be used to specify the colors of the response
density plot or, when plotting an object of class 'exchangeability_model'
the type can be specified. In this case, the default is
'type = c(&quot;both&quot;, &quot;basket&quot;, &quot;cluster&quot;)'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets
)

plot_density(mem_analysis)

</code></pre>

<hr>
<h2 id='plot_map'>Plot the Map Exchangeability of a Basket Trial</h2><span id='topic+plot_map'></span>

<h3>Description</h3>

<p>The Maximum A Posteriori Probability (MAP) of an MEM is the
estimate of the exchangeability structure of a basket trial. This function
visualizes this matrix as an exchangeogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_map(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_map_+3A_x">x</code></td>
<td>
<p><code>basket</code> element of the exchangeability model.</p>
</td></tr>
<tr><td><code id="plot_map_+3A_...">...</code></td>
<td>
<p>other options passed to ggplot2 to alter the visual</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot_map</code> function attempts to place the
basket names to the left of the main diagonal in a way that makes it
easy to read. However, for especially long basket names options are
provided. Here is a list of all options available to &ldquo;fine tune&rdquo;
the visualizations. These auxiliary options include:
</p>

<ul>
<li><p>[palette]A color palette consisting of 3 colors: the first
corresponds to a low degree of exchangeability, the second to 50
exchangeability, and the third to a high degree of exchangeability.
Interpolation between these colors is performed for intermediary
degrees of exchangeability. 
</p>
</li>
<li><p>[text_color]A text string setting the color of the exchangeability
values printed on the plot. (Default &quot;white&quot;)
</p>
</li>
<li><p>[tile_color]A text string setting the color of the edges of the
tiles. (Default &quot;white&quot;)
</p>
</li>
<li><p>[expand] The proportion to expand the viewport
(Default expand = c(0.3, 0.3))
</p>
</li>
<li><p>[text_size] The text size. (Default 4)
</p>
</li>
<li><p>[legend_position] The legend position.
(Default legend_position = c(0.25, 0.8)
</p>
</li>
<li><p>[draw_legend] Should the legend be drawn? (Default TRUE)
</p>
</li>
<li><p>[basket_name_hoffset] The horizontal offset of the basket names..
(Default 0)
</p>
</li>
<li><p>[basket_name_hjust] The basket name justification..
(Default 1 - right justified)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets
)

plot_map(mem_analysis$basket)

</code></pre>

<hr>
<h2 id='plot_mem'>Plot the Prior, MAP, and PEP of a Basket Trial</h2><span id='topic+plot_mem'></span>

<h3>Description</h3>

<p>: Plot the Prior, MAP, and PEP Matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_mem(x, type = c("prior", "map", "pep"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_mem_+3A_x">x</code></td>
<td>
<p>the exchangeability model.</p>
</td></tr>
<tr><td><code id="plot_mem_+3A_type">type</code></td>
<td>
<p>the plot type that will be plotted.</p>
</td></tr>
<tr><td><code id="plot_mem_+3A_...">...</code></td>
<td>
<p>other options. See Details for more information.</p>
</td></tr>
</table>

<hr>
<h2 id='plot_pep'>Plot the Posterior Exchangeability of a Basket Trial</h2><span id='topic+plot_pep'></span>

<h3>Description</h3>

<p>The posterior exchangeability of the baskets in a
MEM analysis can be visualized via an exchangeogram using this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pep(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_pep_+3A_x">x</code></td>
<td>
<p><code>basket</code> element of the exchangeability model.</p>
</td></tr>
<tr><td><code id="plot_pep_+3A_...">...</code></td>
<td>
<p>other options passed to ggplot2 to alter the visual
characteristics of the plot. See Details for more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot_pep</code> function attempts to place the basket names
to the left of the main diagonal in a way that makes it easy to read.
However, for especially long basket names options are provided. Here
is a list of all options available to &ldquo;fine tune&rdquo;
the visualizations. These auxiliary options include:
</p>

<ul>
<li><p>[palette] A color palette consisting of 3 colors: the first
corresponds to a low degree of exchangeability, the second to 50
exchangeability, and the third to a high degree of exchangeability.
Interpolation between these colors is performed for intermediary
degrees of exchangeability.
</p>
<p>[text_color]A text string setting the color of the exchangeability
values printed on the plot. (Default &quot;white&quot;)
</p>
<p>[tile_color]A text string setting the color of the edges of the
tiles. (Default &quot;white&quot;)
(Default <code>RColorBrewer::brewer.pal(3, "BuGn")</code>)
</p>
</li>
<li><p>[expand] The proportion to expand the viewport
(Default expand = c(0.3, 0.3))
</p>
</li>
<li><p>[text_size] The text size. (Default 4)
</p>
</li>
<li><p>[legend_position] The legend position.
(Default legend_position = c(0.25, 0.8)
</p>
</li>
<li><p>[draw_legend] Should the legend be drawn? (Default TRUE)
</p>
</li>
<li><p>[basket_name_hoffset] The horizontal offset of the basket names..
(Default 0)
</p>
</li>
<li><p>[basket_name_hjust] The basket name justification..
(Default 1 - right justified)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets
)

plot_pep(mem_analysis$basket)

</code></pre>

<hr>
<h2 id='plot_pep_graph'>Plot a Network Graph of the PEP Matrix</h2><span id='topic+plot_pep_graph'></span>

<h3>Description</h3>

<p>Plot a Network Graph of the PEP Matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pep_graph(
  x,
  color_by = c("post_prob", "mean_est", "median_est"),
  layout = c("fr", "nicely", "kk", "drl"),
  pep_cutoff = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_pep_graph_+3A_x">x</code></td>
<td>
<p>the exchangeability model.</p>
</td></tr>
<tr><td><code id="plot_pep_graph_+3A_color_by">color_by</code></td>
<td>
<p>which variable to color by. One of &quot;post_prob&quot;,
&quot;mean_est&quot;, &quot;median_est&quot;.</p>
</td></tr>
<tr><td><code id="plot_pep_graph_+3A_layout">layout</code></td>
<td>
<p>the layout algorithm to use for the graph. One of</p>
</td></tr>
<tr><td><code id="plot_pep_graph_+3A_pep_cutoff">pep_cutoff</code></td>
<td>
<p>a value between 0 and 1 indicating the cutoff for
PEP above which edges of the graph will be drawn.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets
)

plot_pep_graph(mem_analysis)

</code></pre>

<hr>
<h2 id='sample_posterior'>Sample Posterior Samples from a Basket Trial</h2><span id='topic+sample_posterior'></span>

<h3>Description</h3>

<p>Sample Posterior Samples from a Basket Trial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_posterior(model, num_samples = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample_posterior_+3A_model">model</code></td>
<td>
<p>the exchangeability model</p>
</td></tr>
<tr><td><code id="sample_posterior_+3A_num_samples">num_samples</code></td>
<td>
<p>the number of samples to draw. Default 10000</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# 3 baskets, each with enrollement size 5
trial_sizes &lt;- rep(5, 3)

# The response rates for the baskets.
resp_rate &lt;- 0.15

# The trials: a column of the number of responses and a column of the
# the size of each trial.
trials &lt;- data.frame(
  responses = rbinom(trial_sizes, trial_sizes, resp_rate),
  size = trial_sizes,
  name = paste("Basket", seq_len(3))
)

</code></pre>

<hr>
<h2 id='update_p0'>Update Full Bayes results with different p0 values</h2><span id='topic+update_p0'></span>

<h3>Description</h3>

<p>After running either 'mem_mcmc' or 'mem_exact', the
test can be updated without rerunning the entire analysis. This function
provides updating of both the null response rate along with the
alternative rerunning relevant test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_p0(res, p0 = 0.15, alternative = "greater")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_p0_+3A_res">res</code></td>
<td>
<p>the result of an mem analysis.</p>
</td></tr>
<tr><td><code id="update_p0_+3A_p0">p0</code></td>
<td>
<p>the null response rate for the poster probability calculation
(default 0.15).</p>
</td></tr>
<tr><td><code id="update_p0_+3A_alternative">alternative</code></td>
<td>
<p>the alternative case definition (default greater)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create an MEM analysis of the Vemurafenib trial data.
data(vemu_wide)

mem_analysis &lt;- mem_exact(
  vemu_wide$responders,
  vemu_wide$evaluable,
  vemu_wide$baskets
)

# Update the null from p0 = 0.15 the default, to p = 0.25.
update_p0(mem_analysis, 0.20)

## End(Not run)
</code></pre>

<hr>
<h2 id='vemu'>Summary Data from the Vemurafenib Study</h2><span id='topic+vemu'></span><span id='topic+vemu_wide'></span>

<h3>Description</h3>

<p>The 'vemu' and 'vemu_wide' data sets provides response information taken
from the &ldquo;Vemurafenib in multiple nonmelanoma cancers with BRAF v600
mutations&rdquo; study where, in total, 18 responders were observed among the
84 patients contributing evaluable outcomes for statistical estimation.
Observed response rates varied from $42%$ and $43%$ for baskets of NSCLC
and ECD or LCH to 0 and $4%,$ for CRC with vemurafenib mono and
combination therapies, respectively. Two responders of seven patients, ATC
was associated with a $29%$ response rate, while one responder of eight
patients was observed in the cholangiocarcinoma basket. Contrasting
favorable results for preliminary vemurafenib activity among NSCLC and ECD
or LCH patients with less favorable results for CRC patients, the authors
concluded that nonmelanoma tumor types harboring $BRAF^V600$ mutations
failed to respond uniformly to BRAF-targeted therapy giving credence to
more conventional organ-specific nosology when compared to molecular tumor
nosology.
</p>
<p>Later, in the &ldquo;Statistical challenges posed by basket trials: sensitivity
analysis of the Vemurafenib study&rdquo; it was shown that patient-enrollment
types we likely drove the negative results for several targets, rather
than Vemurafenib itself.
</p>


<h3>References</h3>

<p>Hyman DM, Puzanov I, Subbiah V, Faris JE, Chau I, Blay JY,
Wolf J, Raje NS, Diamond EL, Hollebecque A, et al. Vemurafenib in multiple
nonmelanoma cancers with braf v600 mutations. New England Journal of
Medicine 2015; <strong>373</strong>(8):726
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
