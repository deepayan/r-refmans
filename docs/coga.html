<!DOCTYPE html><html lang="en"><head><title>Help for package coga</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {coga}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coga'><p>coga: Convolution of independent Gamma Distributions</p></a></li>
<li><a href='#dcoga'><p>Convolution of Gamma Distributions (Exact Method).</p></a></li>
<li><a href='#dcoga_approx'><p>Convolution of Gamma distribuitons (Approximation Method)</p></a></li>
<li><a href='#dcoga2dim'><p>Convolution of Two Gamma Distributions (Exact Method).</p></a></li>
<li><a href='#pcoga2dim_diff_shape'><p>Recurrence Identity of Shape Parameter for <code>pcoga2dim</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Convolution of Gamma Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-10</td>
</tr>
<tr>
<td>Description:</td>
<td>Evaluation for density and distribution function of convolution of gamma
    distributions in R. Two related exact methods and one approximate method are
    implemented with efficient algorithm and C++ code. A quick guide for choosing
    correct method and usage of this package is given in package vignette. For the
    detail of methods used in this package, we refer the user to
    Mathai(1982)&lt;<a href="https://doi.org/10.1007%2FBF02481056">doi:10.1007/BF02481056</a>&gt;,
    Moschopoulos(1984)&lt;<a href="https://doi.org/10.1007%2FBF02481123">doi:10.1007/BF02481123</a>&gt;,
    Barnabani(2017)&lt;<a href="https://doi.org/10.1080%2F03610918.2014.963612">doi:10.1080/03610918.2014.963612</a>&gt;,
    Hu et al.(2020)&lt;<a href="https://doi.org/10.1007%2Fs00180-019-00924-9">doi:10.1007/s00180-019-00924-9</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3.0)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, R.rsp</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, Rcpp, cubature</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppGSL</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ChaoranHu/coga/issues">https://github.com/ChaoranHu/coga/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ChaoranHu/coga">https://github.com/ChaoranHu/coga</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU GSL</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-10 20:51:44 UTC; chaoranhu</td>
</tr>
<tr>
<td>Author:</td>
<td>Chaoran Hu [aut, cre],
  Vladimir Pozdnyakov [ths],
  Jun Yan [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chaoran Hu &lt;huchaoran.stat@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-10 21:33:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='coga'>coga: Convolution of independent Gamma Distributions</h2><span id='topic+coga'></span><span id='topic+coga-package'></span>

<h3>Description</h3>

<p>Evaluation for density and distribution function of convolution of gamma
distributions in R. Two related exact methods and one approximate method are
implemented with efficient algorithm and C++ code. A quick guide for choosing
correct method and usage of this package is given in package vignette.
</p>


<h3>coga functions</h3>

<p>dcoga, pcoga, rcoga, dcoga2dim, pcoga2dim, pcoga2dim_diff_shape, dcoga_approx, and
pcoga_approx.
</p>


<h3>Author(s)</h3>


<ul>
<li><p> *maintainer, author* Chaoran Hu <a href="mailto:chaoran.hu@uconn.edu">chaoran.hu@uconn.edu</a>
</p>
</li>
<li><p> *advisor* Jun Yan <a href="mailto:jun.yan@uconn.edu">jun.yan@uconn.edu</a>
</p>
</li>
<li><p> *advisor* Vladimir Pozdnyakov <a href="mailto:vladimir.pozdnyakov@uconn.edu">vladimir.pozdnyakov@uconn.edu</a>
</p>
</li></ul>


<hr>
<h2 id='dcoga'>Convolution of Gamma Distributions (Exact Method).</h2><span id='topic+dcoga'></span><span id='topic+pcoga'></span><span id='topic+rcoga'></span>

<h3>Description</h3>

<p>Density, distribution function, and random generation for convolution
of gamma distributions. Convolution of independent Gamma random
variables is <code class="reqn">Y = X_{1} + ... + X_{n}</code>, where <code class="reqn">X_{i}, i = 1, ..., n</code>,
are independent Gamma distributions with parameters shapes and rates.
The exact density function and distribution function can be calculated,
according to the formulas from Moschopoulos, Peter G. (1985).
**We mention that <code>dcoga</code> and <code>pcoga</code> are recommended
for <code class="reqn">n &gt;= 3</code>.**
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcoga(x, shape, rate)

pcoga(x, shape, rate)

rcoga(n, shape, rate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dcoga_+3A_x">x</code></td>
<td>
<p>Quantiles.</p>
</td></tr>
<tr><td><code id="dcoga_+3A_shape">shape</code></td>
<td>
<p>Numerical vector of shape parameters for each gamma distributions,
all shape parameters should be larger than or equal to 0, with at least one
non-zero.</p>
</td></tr>
<tr><td><code id="dcoga_+3A_rate">rate</code></td>
<td>
<p>Numerical vector of rate parameters for each gamma distributions,
all rate parameters should be larger than 0.</p>
</td></tr>
<tr><td><code id="dcoga_+3A_n">n</code></td>
<td>
<p>Number of sample points.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chaoran Hu
</p>


<h3>References</h3>

<p>Moschopoulos, Peter G. &quot;The distribution of the sum of independent
gamma random variables.&quot; Annals of the Institute of
Statistical Mathematics 37.1 (1985): 541-544.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Correctness check
set.seed(123)
## do grid
y &lt;- rcoga(100000, c(3,4,5), c(2,3,4))
grid &lt;- seq(0, 15, length.out=100)
## calculate pdf and cdf
pdf &lt;- dcoga(grid, shape=c(3,4,5), rate=c(2,3,4))
cdf &lt;- pcoga(grid, shape=c(3,4,5), rate=c(2,3,4))

## plot pdf
plot(density(y), col="blue")
lines(grid, pdf, col="red")

## plot cdf
plot(ecdf(y), col="blue")
lines(grid, cdf, col="red")

## Example 2: Show parameter recycling
## these pairs give us the same results
dcoga(1:5, c(1, 2), c(1, 3, 4, 2, 5))
dcoga(1:5, c(1, 2, 1, 2, 1), c(1, 3, 4, 2, 5))

pcoga(1:5, c(1, 3, 5, 2, 2), c(3, 5))
pcoga(1:5, c(1, 3, 5, 2, 2), c(3, 5, 3, 5, 3))

</code></pre>

<hr>
<h2 id='dcoga_approx'>Convolution of Gamma distribuitons (Approximation Method)</h2><span id='topic+dcoga_approx'></span><span id='topic+pcoga_approx'></span>

<h3>Description</h3>

<p>Density and distribution function of convolution of gamma distributions
are calculated based on approximation method from Barnabani(2017), which
gives us the approximate result and faster evaluation than <code>dcoga</code>
and <code>pcoga</code> during three or more variables case. **So, we recommend
these functions for three or more varibales case with approximate result.**
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcoga_approx(x, shape, rate)

pcoga_approx(x, shape, rate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dcoga_approx_+3A_x">x</code></td>
<td>
<p>Quantiles.</p>
</td></tr>
<tr><td><code id="dcoga_approx_+3A_shape">shape</code></td>
<td>
<p>Numerical vector of shape parameters for each gamma distributions,
all shape parameters should be larger than or equal to 0, with at least three
non-zero.</p>
</td></tr>
<tr><td><code id="dcoga_approx_+3A_rate">rate</code></td>
<td>
<p>Numerical vector of rate parameters for each gamma distributions,
all rate parameters should be larger than 0.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chaoran Hu
</p>


<h3>References</h3>

<p>Barnabani, M. (2017). An approximation to the convolution of gamma
distributions. Communications in Statistics - Simulation and Computation
46(1), 331-343.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Correctness check
set.seed(123)
## do grid
y &lt;- rcoga(100000, c(3,4,5), c(2,3,4))
grid &lt;- seq(0, 15, length.out=100)
## calculate pdf and cdf
pdf &lt;- dcoga_approx(grid, shape=c(3,4,5), rate=c(2,3,4))
cdf &lt;- pcoga_approx(grid, shape=c(3,4,5), rate=c(2,3,4))

## plot pdf
plot(density(y), col="blue")
lines(grid, pdf, col="red")

## plot cdf
plot(ecdf(y), col="blue")
lines(grid, cdf, col="red")

## Example 2: Show parameter recycling
## these pairs give us the same results
dcoga_approx(1:5, c(1, 2), c(1, 3, 4, 2, 5))
dcoga_approx(1:5, c(1, 2, 1, 2, 1), c(1, 3, 4, 2, 5))

pcoga_approx(1:5, c(1, 3, 5, 2, 2), c(3, 5))
pcoga_approx(1:5, c(1, 3, 5, 2, 2), c(3, 5, 3, 5, 3))

</code></pre>

<hr>
<h2 id='dcoga2dim'>Convolution of Two Gamma Distributions (Exact Method).</h2><span id='topic+dcoga2dim'></span><span id='topic+pcoga2dim'></span>

<h3>Description</h3>

<p>Density, and distribution function of convolution of *two* gamma
distributions. These two functions still give us the exact density and
distribution function value, but which are much faster than <code>dcoga</code>
and <code>pcoga</code>. **So, we recommend these two functions for two variables
case.** The algorithm of these two functions comes from Mathai, A.M. (1982).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcoga2dim(x, shape1, shape2, rate1, rate2)

pcoga2dim(x, shape1, shape2, rate1, rate2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dcoga2dim_+3A_x">x</code></td>
<td>
<p>Quantiles.</p>
</td></tr>
<tr><td><code id="dcoga2dim_+3A_shape1">shape1</code>, <code id="dcoga2dim_+3A_shape2">shape2</code></td>
<td>
<p>Shape parameters for the first and second gamma
distributions, both shape parameters should be larger than or equal to 0,
with at least one non-zero.</p>
</td></tr>
<tr><td><code id="dcoga2dim_+3A_rate1">rate1</code>, <code id="dcoga2dim_+3A_rate2">rate2</code></td>
<td>
<p>Rate parameters for the first and second gamma
distributions, both rate parameters should be larger than 0.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chaoran Hu
</p>


<h3>References</h3>

<p>Mathai, A.M.: Storage capacity of a dam with gamma type inputs.
Ann. Inst. Statist.Math. 34, 591-597 (1982)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Correctness check
set.seed(123)
## do grid
y &lt;- rcoga(100000, c(3,4), c(2,3))
grid &lt;- seq(0, 15, length.out=100)
## calculate pdf and cdf
pdf &lt;- dcoga2dim(grid, 3, 4, 2, 3)
cdf &lt;- pcoga2dim(grid, 3, 4, 2, 3)

## plot pdf
plot(density(y), col="blue")
lines(grid, pdf, col="red")

## plot cdf
plot(ecdf(y), col="blue")
lines(grid, cdf, col="red")

## Example 2: Comparison with `dcoga` and `pcoga`
## these pairs give us the same results
dcoga(1:5, c(1, 2), c(3, 4))
dcoga2dim(1:5, 1, 2, 3, 4)

pcoga(1:5, c(1, 3), c(3, 5))
pcoga2dim(1:5, 1, 3, 3, 5)

</code></pre>

<hr>
<h2 id='pcoga2dim_diff_shape'>Recurrence Identity of Shape Parameter for <code>pcoga2dim</code></h2><span id='topic+pcoga2dim_diff_shape'></span>

<h3>Description</h3>

<p>The difference of distribution functions of convolution of two gamma
distributions between consecutive neighbors of shape parameter. This
function evaluate the value of 'pcoga2dim(x, shape1, shape2, rate1, rate2)
- pcoga2dim(x, shape1 + 1, shape2, rate1, rate2)' with higher efficiency
(this function is much more faster than call <code>pcoga2dim</code> two-times).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcoga2dim_diff_shape(x, shape1, shape2, rate1, rate2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcoga2dim_diff_shape_+3A_x">x</code></td>
<td>
<p>Quantiles.</p>
</td></tr>
<tr><td><code id="pcoga2dim_diff_shape_+3A_shape1">shape1</code>, <code id="pcoga2dim_diff_shape_+3A_shape2">shape2</code></td>
<td>
<p>Shape parameters of the first and second gamma
distributions, both shape parameters should be larger than or equal to 0.</p>
</td></tr>
<tr><td><code id="pcoga2dim_diff_shape_+3A_rate1">rate1</code>, <code id="pcoga2dim_diff_shape_+3A_rate2">rate2</code></td>
<td>
<p>Rate parameters of the first and second gamma
distributions, both rate parameters should be larger than 0.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chaoran Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## these pairs give us the same results
pcoga2dim_diff_shape(3,2,4,5,4)
pcoga2dim(3,2,4,5,4) - pcoga2dim(3,3,4,5,4)

pcoga2dim_diff_shape(3,0,4,3,5)
pgamma(3,4,5) - pcoga2dim(3,1,4,3,5)

pcoga2dim_diff_shape(3,6,0,5,4)
pgamma(3,6,5) - pgamma(3,7,5)

pcoga2dim_diff_shape(3,0,0,4,5)
1 - pgamma(3,1,4)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
