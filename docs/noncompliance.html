<!DOCTYPE html><html lang="en"><head><title>Help for package noncompliance</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {noncompliance}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ACE_bounds'><p>Bounds for the Average Causal Effect (ACE).</p></a></li>
<li><a href='#ACE_bounds_posterior'><p>Posterior bounds for the Average Causal Effect (ACE).</p></a></li>
<li><a href='#ACE_bounds_triangle.plot'><p>&quot;Triangle&quot; plot of the posterior bounds for the Average Causal Effect (ACE).</p></a></li>
<li><a href='#AllColTotalsH0_CONT'><p>Finds all column totals for Compliers and Never Takers</p>
under the sharp null for Compliers.</a></li>
<li><a href='#AllPossiblyObsH0_CONT'><p>Finite population sample space given an observed dataset.</p></a></li>
<li><a href='#Check_ACDE_bounds'><p>Bounds for the Average Controlled Direct Effect (ACDE).</p></a></li>
<li><a href='#Check_IV_ineqs'><p>Check of the Instrumental Variable (IV) inequalities.</p></a></li>
<li><a href='#expand.grid.DT'><p>Expand.grid using the data.table package.</p></a></li>
<li><a href='#FindMLE_CONT_H0_hypergeoR'><p>Maximum Likelihood Estimate under the sharp null for Compliers.</p></a></li>
<li><a href='#FindMLE_CONT_H1_hypergeoR'><p>Maximum Likelihood Estimate without assuming the sharp null for Compliers.</p></a></li>
<li><a href='#Get_pvalues_CONT'><p>Exact finite population p-values under the sharp null for Compliers.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Causal Inference in the Presence of Treatment Noncompliance
Under the Binary Instrumental Variable Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-02-11</td>
</tr>
<tr>
<td>Description:</td>
<td>A finite-population significance test of the 'sharp' causal null hypothesis that
    treatment exposure X has no effect on final outcome Y, within the principal stratum of Compliers.
    A generalized likelihood ratio test statistic is used, and the resulting p-value is exact.
    Currently, it is assumed that there are only Compliers and Never Takers in the population.</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table (&ge; 1.9.4), Rcpp (&ge; 0.12.1)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.stat.washington.edu/~wloh/">https://www.stat.washington.edu/~wloh/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-02-15 09:09:39 UTC; wloh</td>
</tr>
<tr>
<td>Author:</td>
<td>Wen Wei Loh [aut, cre],
  Thomas S. Richardson [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wen Wei Loh &lt;wloh@uw.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-02-15 13:47:11</td>
</tr>
</table>
<hr>
<h2 id='ACE_bounds'>Bounds for the Average Causal Effect (ACE).</h2><span id='topic+ACE_bounds'></span>

<h3>Description</h3>

<p>The empirical bounds for the Average Causal Effect (ACE),
under the assumptions of the Instrumental Variable (IV) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ACE_bounds(n_y0x0z0, n_y1x0z0 = NA, n_y0x1z0 = NA, n_y1x1z0 = NA,
  n_y0x0z1 = NA, n_y1x0z1 = NA, n_y0x1z1 = NA, n_y1x1z1 = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ACE_bounds_+3A_n_y0x0z0">n_y0x0z0</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=0.
Alternatively, a vector with elements
(either counts, p(y, x , z) or p(y, x | z)) in the order of the arguments.</p>
</td></tr>
<tr><td><code id="ACE_bounds_+3A_n_y1x0z0">n_y1x0z0</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="ACE_bounds_+3A_n_y0x1z0">n_y0x1z0</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=0.</p>
</td></tr>
<tr><td><code id="ACE_bounds_+3A_n_y1x1z0">n_y1x1z0</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=0.</p>
</td></tr>
<tr><td><code id="ACE_bounds_+3A_n_y0x0z1">n_y0x0z1</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="ACE_bounds_+3A_n_y1x0z1">n_y1x0z1</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="ACE_bounds_+3A_n_y0x1z1">n_y0x1z1</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="ACE_bounds_+3A_n_y1x1z1">n_y1x1z1</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The empirical bounds for the ACE.
</p>


<h3>References</h3>

<p>Richardson, T. S.; Robins, J. M. (2014).
ACE Bounds; SEMs with Equilibrium Conditions.
<em>Statist. Sci. 29, no. 3, 363-366.</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ACE_bounds(158, 14, 0, 0, 52, 12, 23, 78)
ACE_bounds(c(158, 14, 0, 0, 52, 12, 23, 78))
ACE_bounds(99, 1027, 30, 233, 84, 935, 31, 422)
ACE_bounds(c(99, 1027, 30, 233, 84, 935, 31, 422))
</code></pre>

<hr>
<h2 id='ACE_bounds_posterior'>Posterior bounds for the Average Causal Effect (ACE).</h2><span id='topic+ACE_bounds_posterior'></span>

<h3>Description</h3>

<p>The posterior bounds for the Average Causal Effect (ACE) is found
based on a transparent reparametrization (see reference below),
using a Dirichlet prior.
A binary Instrumental Variable (IV) model is assumed here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ACE_bounds_posterior(n_y0x0z0, n_y1x0z0 = NA, n_y0x1z0 = NA,
  n_y1x1z0 = NA, n_y0x0z1 = NA, n_y1x0z1 = NA, n_y0x1z1 = NA,
  n_y1x1z1 = NA, prior, num.sims = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ACE_bounds_posterior_+3A_n_y0x0z0">n_y0x0z0</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=0.
Alternatively, a vector with elements in the order of the arguments.</p>
</td></tr>
<tr><td><code id="ACE_bounds_posterior_+3A_n_y1x0z0">n_y1x0z0</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="ACE_bounds_posterior_+3A_n_y0x1z0">n_y0x1z0</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=0.</p>
</td></tr>
<tr><td><code id="ACE_bounds_posterior_+3A_n_y1x1z0">n_y1x1z0</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=0.</p>
</td></tr>
<tr><td><code id="ACE_bounds_posterior_+3A_n_y0x0z1">n_y0x0z1</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="ACE_bounds_posterior_+3A_n_y1x0z1">n_y1x0z1</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="ACE_bounds_posterior_+3A_n_y0x1z1">n_y0x1z1</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="ACE_bounds_posterior_+3A_n_y1x1z1">n_y1x1z1</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="ACE_bounds_posterior_+3A_prior">prior</code></td>
<td>
<p>Hyperparameters for the Dirichlet prior for p(y, x | z),
in the order of the arguments.</p>
</td></tr>
<tr><td><code id="ACE_bounds_posterior_+3A_num.sims">num.sims</code></td>
<td>
<p>Number of Monte Carlo draws from the posterior.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the posterior bounds for the ACE,
based only on sampled distributions (from the posterior)
that satisfied the IV inequalites.
</p>


<h3>References</h3>

<p>Richardson, T. S., Evans, R. J., &amp; Robins, J. M. (2011).
Transparent parameterizations of models for potential outcomes.
<em>Bayesian Statistics, 9, 569-610</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ACE_bounds_posterior(158, 14, 0, 0, 52, 12, 23, 78,
     prior = c( rep(1, 2), rep(0, 2), rep(1, 4)))
ACE_bounds_posterior(158, 14, 0, 0, 52, 12, 23, 78,
     prior = c( rep(1/2, 2), rep(0, 2), rep(1/4, 4)))
## Not run: 
ace.bnds.lipid &lt;- ACE_bounds_posterior(158, 14, 0, 0, 52, 12, 23, 78,
     prior = c( rep(1, 2), rep(0, 2), rep(1, 4)), num.sims = 2e4)
summary(ace.bnds.lipid) 
## End(Not run)
</code></pre>

<hr>
<h2 id='ACE_bounds_triangle.plot'>&quot;Triangle&quot; plot of the posterior bounds for the Average Causal Effect (ACE).</h2><span id='topic+ACE_bounds_triangle.plot'></span>

<h3>Description</h3>

<p>Plot of the posterior upper bound for the Average Causal Effect (ACE)
against the corresponding lower bound.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ACE_bounds_triangle.plot(bounds, title.txt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ACE_bounds_triangle.plot_+3A_bounds">bounds</code></td>
<td>
<p>Posterior bounds from the ACE_bounds_posterior function.</p>
</td></tr>
<tr><td><code id="ACE_bounds_triangle.plot_+3A_title.txt">title.txt</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A &quot;triangle&quot; plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ace.bnds.lipid &lt;- ACE_bounds_posterior(158, 14, 0, 0, 52, 12, 23, 78,
     prior = c( rep(1, 2), rep(0, 2), rep(1, 4)))
ACE_bounds_triangle.plot(ace.bnds.lipid, "Bounds on ACE for Lipid Data")
## Not run: 
ace.bnds.lipid &lt;- ACE_bounds_posterior(158, 14, 0, 0, 52, 12, 23, 78,
     prior = c( rep(1, 2), rep(0, 2), rep(1, 4)), num.sims = 2e4)
ACE_bounds_triangle.plot(ace.bnds.lipid, "Bounds on ACE for Lipid Data") 
## End(Not run)
</code></pre>

<hr>
<h2 id='AllColTotalsH0_CONT'>Finds all column totals for Compliers and Never Takers
under the sharp null for Compliers.</h2><span id='topic+AllColTotalsH0_CONT'></span>

<h3>Description</h3>

<p>Finds all compatible column totals for Compliers and Never Takers
under the sharp null for Compliers,
based on an observed dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AllColTotalsH0_CONT(n_y0x0z0.H0, n_y1x0z0.H0, n_y0x0z1.H0, n_y1x0z1.H0,
  n_y0x1z1.H0, n_y1x1z1.H0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AllColTotalsH0_CONT_+3A_n_y0x0z0.h0">n_y0x0z0.H0</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="AllColTotalsH0_CONT_+3A_n_y1x0z0.h0">n_y1x0z0.H0</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="AllColTotalsH0_CONT_+3A_n_y0x0z1.h0">n_y0x0z1.H0</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="AllColTotalsH0_CONT_+3A_n_y1x0z1.h0">n_y1x0z1.H0</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="AllColTotalsH0_CONT_+3A_n_y0x1z1.h0">n_y0x1z1.H0</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="AllColTotalsH0_CONT_+3A_n_y1x1z1.h0">n_y1x1z1.H0</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table with all possible combinations of the
column totals for Compliers and Never Takers
under the sharp null for Compliers.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AllColTotalsH0_CONT(158, 14, 52, 12, 23, 78)
</code></pre>

<hr>
<h2 id='AllPossiblyObsH0_CONT'>Finite population sample space given an observed dataset.</h2><span id='topic+AllPossiblyObsH0_CONT'></span>

<h3>Description</h3>

<p>Sample space of all possibly observable datasets given an observed dataset,
assuming only Compliers and Never Takers in the population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AllPossiblyObsH0_CONT(n_y0x0z0, n_y1x0z0, n_y0x0z1, n_y1x0z1, n_y0x1z1,
  n_y1x1z1, findGLR = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AllPossiblyObsH0_CONT_+3A_n_y0x0z0">n_y0x0z0</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="AllPossiblyObsH0_CONT_+3A_n_y1x0z0">n_y1x0z0</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="AllPossiblyObsH0_CONT_+3A_n_y0x0z1">n_y0x0z1</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="AllPossiblyObsH0_CONT_+3A_n_y1x0z1">n_y1x0z1</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="AllPossiblyObsH0_CONT_+3A_n_y0x1z1">n_y0x1z1</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="AllPossiblyObsH0_CONT_+3A_n_y1x1z1">n_y1x1z1</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="AllPossiblyObsH0_CONT_+3A_findglr">findGLR</code></td>
<td>
<p>Whether or not to find the generalized likelihood ratio
(GLR) test statistic for each possible observable dataset.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>All possibly observable datasets in a data.table format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>AllPossiblyObsH0_CONT(16, 1, 5, 1, 2, 8)
AllPossiblyObsH0_CONT(16, 1, 5, 1, 2, 8, findGLR=TRUE)
</code></pre>

<hr>
<h2 id='Check_ACDE_bounds'>Bounds for the Average Controlled Direct Effect (ACDE).</h2><span id='topic+Check_ACDE_bounds'></span>

<h3>Description</h3>

<p>The empirical bounds for the Average Controlled Direct Effect (ACDE) within
the principal strata of Always Takers and Never Takers,
under the assumption of monotonicity (no Defiers).
These are equivalent to an empirical check of the Instrumental Variable
(IV) inequalities (see references below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Check_ACDE_bounds(n_y0x0z0, n_y1x0z0 = NA, n_y0x1z0 = NA, n_y1x1z0 = NA,
  n_y0x0z1 = NA, n_y1x0z1 = NA, n_y0x1z1 = NA, n_y1x1z1 = NA,
  iv.ineqs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Check_ACDE_bounds_+3A_n_y0x0z0">n_y0x0z0</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=0.
Alternatively, a vector with elements
(either counts, p(y, x , z) or p(y, x | z)) in the order of the arguments.</p>
</td></tr>
<tr><td><code id="Check_ACDE_bounds_+3A_n_y1x0z0">n_y1x0z0</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="Check_ACDE_bounds_+3A_n_y0x1z0">n_y0x1z0</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=0.</p>
</td></tr>
<tr><td><code id="Check_ACDE_bounds_+3A_n_y1x1z0">n_y1x1z0</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=0.</p>
</td></tr>
<tr><td><code id="Check_ACDE_bounds_+3A_n_y0x0z1">n_y0x0z1</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="Check_ACDE_bounds_+3A_n_y1x0z1">n_y1x0z1</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="Check_ACDE_bounds_+3A_n_y0x1z1">n_y0x1z1</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="Check_ACDE_bounds_+3A_n_y1x1z1">n_y1x1z1</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="Check_ACDE_bounds_+3A_iv.ineqs">iv.ineqs</code></td>
<td>
<p>Whether to return the empirical bounds or
the IV inequalities (TRUE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The empirical bounds for the ACDE
among Always Takers and Never Takers, or the
empirical IV inequalities.
</p>


<h3>References</h3>

<p>Richardson, T. S., Evans, R. J., &amp; Robins, J. M. (2011).
Transparent parameterizations of models for potential outcomes.
<em>Bayesian Statistics, 9, 569-610</em>.
</p>
<p>A. Balke and J. Pearl. (1997).
Bounds on treatment effects from studies with imperfect compliance.
<em>Journal of the American Statistical Association, 1171-1176</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Check_ACDE_bounds(99, 1027, 30, 233, 84, 935, 31, 422)
Check_ACDE_bounds(c(99, 1027, 30, 233, 84, 935, 31, 422))
Check_ACDE_bounds(99, 1027, 30, 233, 84, 935, 31, 422, iv.ineqs=TRUE)
Check_ACDE_bounds(c(99, 1027, 30, 233, 84, 935, 31, 422), iv.ineqs=TRUE)
</code></pre>

<hr>
<h2 id='Check_IV_ineqs'>Check of the Instrumental Variable (IV) inequalities.</h2><span id='topic+Check_IV_ineqs'></span>

<h3>Description</h3>

<p>This checks whether the Instrumental Variable (IV) inequalities
for a binary dataset have been <em>satisfied</em> empirically,
assuming only Randomization and Exclusion Restriction for the
principal strata of Always Takers and Never Takers.
Monotonicity (no Defiers) is <em>not</em> assumed here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Check_IV_ineqs(n_y0x0z0, n_y1x0z0 = NA, n_y0x1z0 = NA, n_y1x1z0 = NA,
  n_y0x0z1 = NA, n_y1x0z1 = NA, n_y0x1z1 = NA, n_y1x1z1 = NA,
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Check_IV_ineqs_+3A_n_y0x0z0">n_y0x0z0</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=0.
Alternatively, a vector with elements
(either counts, p(y, x , z) or p(y, x | z)) in the order of the arguments.</p>
</td></tr>
<tr><td><code id="Check_IV_ineqs_+3A_n_y1x0z0">n_y1x0z0</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="Check_IV_ineqs_+3A_n_y0x1z0">n_y0x1z0</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=0.</p>
</td></tr>
<tr><td><code id="Check_IV_ineqs_+3A_n_y1x1z0">n_y1x1z0</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=0.</p>
</td></tr>
<tr><td><code id="Check_IV_ineqs_+3A_n_y0x0z1">n_y0x0z1</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="Check_IV_ineqs_+3A_n_y1x0z1">n_y1x0z1</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="Check_IV_ineqs_+3A_n_y0x1z1">n_y0x1z1</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="Check_IV_ineqs_+3A_n_y1x1z1">n_y1x1z1</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="Check_IV_ineqs_+3A_verbose">verbose</code></td>
<td>
<p>Whether to return all the IV inequalities (TRUE)
or just a check that the inequalities have been satisfied empirically.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of all the IV inequalities or a check of whether all
the inequalities have been satisfied empirically.
</p>


<h3>References</h3>

<p>A. Balke and J. Pearl. (1997).
Bounds on treatment effects from studies with imperfect compliance.
<em>Journal of the American Statistical Association, 1171-1176</em>.,
</p>
<p>B. Bonet. (2001).
Instrumentality tests revisited.
<em>In Proceedings of the Seventeenth Conference on Uncertainty in
Artificial Intelligence, 48-55</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Check_IV_ineqs(158, 14, 0, 0, 52, 12, 23, 78)
Check_IV_ineqs(c(158, 14, 0, 0, 52, 12, 23, 78))
Check_IV_ineqs(158, 14, 0, 0, 52, 12, 23, 78, TRUE)
Check_IV_ineqs(99, 1027, 30, 233, 84, 935, 31, 422)
Check_IV_ineqs(c(99, 1027, 30, 233, 84, 935, 31, 422))
Check_IV_ineqs(99, 1027, 30, 233, 84, 935, 31, 422, TRUE)
</code></pre>

<hr>
<h2 id='expand.grid.DT'>Expand.grid using the data.table package.</h2><span id='topic+expand.grid.DT'></span>

<h3>Description</h3>

<p>Expand.grid (<code><a href="base.html#topic+expand.grid">expand.grid</a></code>) using the
<code><a href="data.table.html#topic+data.table">data.table</a></code> package,
with up to 4 supplied vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand.grid.DT(seq1, seq2, seq3 = NA, seq4 = NA, col.names = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expand.grid.DT_+3A_seq1">seq1</code></td>
<td>
<p>Vector of values.</p>
</td></tr>
<tr><td><code id="expand.grid.DT_+3A_seq2">seq2</code></td>
<td>
<p>Vector of values.</p>
</td></tr>
<tr><td><code id="expand.grid.DT_+3A_seq3">seq3</code></td>
<td>
<p>Vector of values.</p>
</td></tr>
<tr><td><code id="expand.grid.DT_+3A_seq4">seq4</code></td>
<td>
<p>Vector of values.</p>
</td></tr>
<tr><td><code id="expand.grid.DT_+3A_col.names">col.names</code></td>
<td>
<p>Names of columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.table with all possible combinations (Cartesian product)
of the elements in the input vector sequences.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expand.grid.DT(1:10, 100:110)
expand.grid.DT(1:10, 100:110, col.names=c("A", "B"))
expand.grid.DT(1:10, 100:110, 11:13, 1:2)
</code></pre>

<hr>
<h2 id='FindMLE_CONT_H0_hypergeoR'>Maximum Likelihood Estimate under the sharp null for Compliers.</h2><span id='topic+FindMLE_CONT_H0_hypergeoR'></span>

<h3>Description</h3>

<p>Find the maximum likelihood estimate of the 2 by 4 contingency table
assuming only Compliers and Never Takers in the population,
under the sharp null for Compliers
and with the multivariate hypergeometric sampling distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FindMLE_CONT_H0_hypergeoR(n_y0x0z0, n_y1x0z0, n_y0x0z1, n_y1x0z1, n_y0x1z1,
  n_y1x1z1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FindMLE_CONT_H0_hypergeoR_+3A_n_y0x0z0">n_y0x0z0</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H0_hypergeoR_+3A_n_y1x0z0">n_y1x0z0</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H0_hypergeoR_+3A_n_y0x0z1">n_y0x0z1</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H0_hypergeoR_+3A_n_y1x0z1">n_y1x0z1</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H0_hypergeoR_+3A_n_y0x1z1">n_y0x1z1</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H0_hypergeoR_+3A_n_y1x1z1">n_y1x1z1</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The maximum likelihood under the sharp null for Compliers,
and the corresponding (possibly non-unique) 2 by 4 contingency table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>FindMLE_CONT_H0_hypergeoR(158, 14, 52, 12, 23, 78)
</code></pre>

<hr>
<h2 id='FindMLE_CONT_H1_hypergeoR'>Maximum Likelihood Estimate without assuming the sharp null for Compliers.</h2><span id='topic+FindMLE_CONT_H1_hypergeoR'></span>

<h3>Description</h3>

<p>Find the maximum likelihood estimate of the 2 by 4 contingency table
assuming only Compliers and Never Takers in the population,
with the multivariate hypergeometric sampling distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FindMLE_CONT_H1_hypergeoR(n_y0x0z0, n_y1x0z0, n_y0x0z1, n_y1x0z1, n_y0x1z1,
  n_y1x1z1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FindMLE_CONT_H1_hypergeoR_+3A_n_y0x0z0">n_y0x0z0</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H1_hypergeoR_+3A_n_y1x0z0">n_y1x0z0</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H1_hypergeoR_+3A_n_y0x0z1">n_y0x0z1</code></td>
<td>
<p>Number of individuals with Y=0, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H1_hypergeoR_+3A_n_y1x0z1">n_y1x0z1</code></td>
<td>
<p>Number of individuals with Y=1, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H1_hypergeoR_+3A_n_y0x1z1">n_y0x1z1</code></td>
<td>
<p>Number of individuals with Y=0, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="FindMLE_CONT_H1_hypergeoR_+3A_n_y1x1z1">n_y1x1z1</code></td>
<td>
<p>Number of individuals with Y=1, X=1, Z=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The maximum likelihood, and the corresponding (possibly non-unique)
2 by 4 contingency table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>FindMLE_CONT_H1_hypergeoR(158, 14, 52, 12, 23, 78)
</code></pre>

<hr>
<h2 id='Get_pvalues_CONT'>Exact finite population p-values under the sharp null for Compliers.</h2><span id='topic+Get_pvalues_CONT'></span>

<h3>Description</h3>

<p>Find the exact population-specific p-values
under the sharp null for Compliers,
for each compatible population with only Compliers and Never Takers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Get_pvalues_CONT(obs_y0x0z0, obs_y1x0z0, obs_y0x0z1, obs_y1x0z1, obs_y0x1z1,
  obs_y1x1z1, useGLR = FALSE, justexactp = TRUE, maxonly = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Get_pvalues_CONT_+3A_obs_y0x0z0">obs_y0x0z0</code></td>
<td>
<p>Number of observed individuals with Y=0, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="Get_pvalues_CONT_+3A_obs_y1x0z0">obs_y1x0z0</code></td>
<td>
<p>Number of observed individuals with Y=1, X=0, Z=0.</p>
</td></tr>
<tr><td><code id="Get_pvalues_CONT_+3A_obs_y0x0z1">obs_y0x0z1</code></td>
<td>
<p>Number of observed individuals with Y=0, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="Get_pvalues_CONT_+3A_obs_y1x0z1">obs_y1x0z1</code></td>
<td>
<p>Number of observed individuals with Y=1, X=0, Z=1.</p>
</td></tr>
<tr><td><code id="Get_pvalues_CONT_+3A_obs_y0x1z1">obs_y0x1z1</code></td>
<td>
<p>Number of observed individuals with Y=0, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="Get_pvalues_CONT_+3A_obs_y1x1z1">obs_y1x1z1</code></td>
<td>
<p>Number of observed individuals with Y=1, X=1, Z=1.</p>
</td></tr>
<tr><td><code id="Get_pvalues_CONT_+3A_useglr">useGLR</code></td>
<td>
<p>Whether or not to use the generalized likelihood ratio
(GLR) test statistic.</p>
</td></tr>
<tr><td><code id="Get_pvalues_CONT_+3A_justexactp">justexactp</code></td>
<td>
<p>Just find the total probability of the critical
region for each population, or the total probabilty of the
sampling distribution (which should be 1).</p>
</td></tr>
<tr><td><code id="Get_pvalues_CONT_+3A_maxonly">maxonly</code></td>
<td>
<p>Whether to return only the maximum
population-specific p-value, or all the population-specific
p-values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Exact population-specific p-value(s)
for a given observed dataset.
</p>


<h3>References</h3>

<p>Loh, W. W., &amp; Richardson, T. S. (2015).
A Finite Population Likelihood Ratio Test of the
Sharp Null Hypothesis for Compliers.
<em>In Thirty-First Conference on
Uncertainty in Artificial Intelligence</em>.
<a href="http://auai.org/uai2015/proceedings/papers/97.pdf">[paper]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Get_pvalues_CONT(16, 1, 5, 1, 2, 8)
Get_pvalues_CONT(16, 1, 5, 1, 2, 8, TRUE, FALSE)
Get_pvalues_CONT(16, 1, 5, 1, 2, 8, TRUE, FALSE, FALSE)
Get_pvalues_CONT(158, 14, 52, 12, 23, 78)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
