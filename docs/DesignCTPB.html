<!DOCTYPE html><html><head><title>Help for package DesignCTPB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DesignCTPB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alpha.split'><p>The optimal design given one set of proportion for each sub-population</p></a></li>
<li><a href='#ctpbs'>
<p>The clinical trial design for strong biomarker effect</p></a></li>
<li><a href='#ctpbw'>
<p>The clinical trial design for weak biomarker effect</p></a></li>
<li><a href='#designCTPB'><p>Optimal design for 3-dimensional with visulization</p></a></li>
<li><a href='#phat'><p>Point estimator for the power value</p></a></li>
<li><a href='#proportion'><p>Grid setting of proportions for each sub-population</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Design Clinical Trials with Potential Biomarker Effect</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Applying 'CUDA' 'GPUs' via 'Numba' for optimal clinical design. It allows the user to utilize a 'reticulate' 'Python' environment and run intensive Monte Carlo simulation to get the optimal cutoff for the clinical design with potential biomarker effect, which can guide the realistic clinical trials.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ubcxzhang/DesignCTPB">https://github.com/ubcxzhang/DesignCTPB</a>, Y Lu (2020)
&lt;doi:10.1002/sim.8868&gt;</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ubcxzhang/DesignCTPB/issues">https://github.com/ubcxzhang/DesignCTPB/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Config/reticulate:</td>
<td>list( packages = list( list(package = "scipy", pip =
TRUE), list(package = "numba", pip = TRUE), list(package =
"pandas", pip = TRUE) ) )</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-21 04:28:59 UTC; michael</td>
</tr>
<tr>
<td>Imports:</td>
<td>reticulate, mnormt, fields, plotly, dplyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>OpenSSL(&gt;= 1.0.1), NVIDIA CUDA GPU with compute
capability 3.0 or above and NVIDIA CUDA Toolkit 9.0 or above</td>
</tr>
<tr>
<td>Author:</td>
<td>Yitao Lu <a href="https://orcid.org/0000-0002-0523-7416"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Belaid Moa [aut],
  Julie Zhou [aut],
  Li Xing <a href="https://orcid.org/0000-0002-4186-7909"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Xuekui Zhang <a href="https://orcid.org/0000-0003-4728-2343"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yitao Lu &lt;yitaolu@uvic.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-21 05:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='alpha.split'>The optimal design given one set of proportion for each sub-population</h2><span id='topic+alpha.split'></span>

<h3>Description</h3>

<p>First, the function fits a smooth surface given grid values of alpha(that's sig.lv for each sub-population) and the corresponding power values, and we suggest thin plate splines here. Second, we apply a L-BFGS-B optimization method to estimate the optimal power values and the corresponding alpha value on the estimated thin plate spline surface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha.split(
  r = c(1, 0.5, 0.3),
  N1 = 20480,
  N2 = 10240,
  N3 = 2000,
  E = NULL,
  sig = NULL,
  sd_full = 1/base::sqrt(20),
  delta = NULL,
  delta_linear_bd = c(0.2, 0.8),
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha.split_+3A_r">r</code></td>
<td>
<p>vector for the proportion for each sub-population, r_1 is 1, r_i&gt;r_i+1</p>
</td></tr>
<tr><td><code id="alpha.split_+3A_n1">N1</code></td>
<td>
<p>integer, which is fixed as 10240 in our package</p>
</td></tr>
<tr><td><code id="alpha.split_+3A_n2">N2</code></td>
<td>
<p>integer, which is fixed as 20480 in our package</p>
</td></tr>
<tr><td><code id="alpha.split_+3A_n3">N3</code></td>
<td>
<p>integer, the number of grid point for the sig.lv, which should be the multiples of 5, because we apply 5 stream parallel</p>
</td></tr>
<tr><td><code id="alpha.split_+3A_e">E</code></td>
<td>
<p>integer, the total number of events for the Phase 3 clinical trail, if not specified by user, then an estimation will apply</p>
</td></tr>
<tr><td><code id="alpha.split_+3A_sig">sig</code></td>
<td>
<p>the vector of standard deviation of each sub-population</p>
</td></tr>
<tr><td><code id="alpha.split_+3A_sd_full">sd_full</code></td>
<td>
<p>a numeric number, which denotes the prior information of standard deviation for the harzard reduction if sig is not specified, then sd_full must has an input value to define the standard deviation of the full population</p>
</td></tr>
<tr><td><code id="alpha.split_+3A_delta">delta</code></td>
<td>
<p>vector,the point estimation of harzard reduction in prior information, if not specified we apply a linear scheme by giving bound to the linear harzard reduction</p>
</td></tr>
<tr><td><code id="alpha.split_+3A_delta_linear_bd">delta_linear_bd</code></td>
<td>
<p>vector of length 2, specifying the upper bound and lower bound for the harzard reduction; if the delta is not specified for each sub-population, then the linear scheme will apply and the input is a must.</p>
</td></tr>
<tr><td><code id="alpha.split_+3A_seed">seed</code></td>
<td>
<p>integer, seed for random number generation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of the optimal results given specific r: optimal alpha split and the corresponding optimal power value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#In the example, we apply a linear scheme for the harzard reduction 
alpha.split(r=c(1,0.4,0.1), N3=2000, sd_full=1/sqrt(20),delta_linear_bd = c(0.2,0.8))

## End(Not run)
</code></pre>

<hr>
<h2 id='ctpbs'>
The clinical trial design for strong biomarker effect
</h2><span id='topic+ctpbs'></span>

<h3>Description</h3>

<p>The dataset contains the 3-D rotable figure for the simulated nested two-subset design(strong biomarker effect), from which the optimal choice of each population's proportion and the optimal alpha split can be abtianed. 
</p>


<h3>Format</h3>

<p>The format is:
List of 5
$ plot_power     : plotly object
$ plot_alpha     : plotly object
$ opt_r_split    : numeric vector
$ opt_power      : numeric 
$ opt_alpha_split: numeric vector 
</p>

<dl>
<dt>plot_power</dt><dd><p>the 3-d rotatable plot of optimal power versus r2 and r3.</p>
</dd>
<dt>plot_alpha</dt><dd><p>the 3-d rotatable plot of optimal alpha versus r2 and r3</p>
</dd>
<dt>opt_r_split</dt><dd><p>The optimal cutoffs for the 3 dimensional clinical design</p>
</dd>
<dt>opt_power</dt><dd><p>The optimal power values corresponding to the optimal r split</p>
</dd>
<dt>opt_alpha_split</dt><dd><p>The optimal alpha split corresponding to the optimal r split</p>
</dd>
</dl>


<hr>
<h2 id='ctpbw'>
The clinical trial design for weak biomarker effect
</h2><span id='topic+ctpbw'></span>

<h3>Description</h3>

<p>The dataset contains the 3-D rotable figure for the simulated nested two-subset design(weak biomarker effect), from which the optimal choice of each population's proportion and the optimal alpha split can be abtianed. 
</p>


<h3>Format</h3>

<p>The format is:
List of 5
$ plot_power     :plotly object
$ plot_alpha     :plotly object
$ opt_r_split    : numeric vector
$ opt_power      : numeric 
$ opt_alpha_split: numeric vector 
</p>

<dl>
<dt>plot_power</dt><dd><p>the 3-d rotatable plot of optimal power versus r2 and r3.</p>
</dd>
<dt>plot_alpha</dt><dd><p>the 3-d rotatable plot of optimal alpha versus r2 and r3</p>
</dd>
<dt>opt_r_split</dt><dd><p>The optimal cutoffs for the 3 dimensional clinical design</p>
</dd>
<dt>opt_power</dt><dd><p>The optimal power values corresponding to the optimal r split</p>
</dd>
<dt>opt_alpha_split</dt><dd><p>The optimal alpha split corresponding to the optimal r split</p>
</dd>
</dl>


<hr>
<h2 id='designCTPB'>Optimal design for 3-dimensional with visulization</h2><span id='topic+designCTPB'></span>

<h3>Description</h3>

<p>This function uses GPU parallel computing to calculate the high dimensional integral and apply the smoothing method(thin plate splines) to get the optimum of power values given the prior information: the harzard reduction distribution. This function guides to choose the size of nested populations, i.e. find optimal r-values. The function visualizes and optimizes r-values, but only supports 3-dimension. The optimization of r-values in more than 3-dimension is trivial, but visualization can be too hard.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>designCTPB(
  m = 24,
  r_set = NULL,
  n_dim = 3,
  N1 = 20480,
  N2 = 10240,
  N3 = 2000,
  E = NULL,
  SIGMA = NULL,
  sd_full = 1/base::sqrt(20),
  DELTA = NULL,
  delta_linear_bd = c(0.2, 0.8),
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="designCTPB_+3A_m">m</code></td>
<td>
<p>integer, the number of grid points in each dimension for r, and we suggest m around 20 is enough for 3 dimension</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_r_set">r_set</code></td>
<td>
<p>the matrix of proportion for each sub-population, r_1 is 1, r_i&gt;r_i+1</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_n_dim">n_dim</code></td>
<td>
<p>integer, the number of dimension</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_n1">N1</code></td>
<td>
<p>integer, which is fixed as 10240 in our package</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_n2">N2</code></td>
<td>
<p>integer, which is fixed as 20480 in our package</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_n3">N3</code></td>
<td>
<p>integer, the number of grid point for the sig.lv, which should be the multiples of 5, because we apply 5 stream parallel</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_e">E</code></td>
<td>
<p>integer, the total number of events for the Phase 3 clinical trail, if not specified by user, then an estimation will apply</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_sigma">SIGMA</code></td>
<td>
<p>the matrix of standard deviation of each sub-population, which should coincide with r_set or the default setting of each sub-population(i.e each entry of each row coincides to the corresponding entry in r_set)</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_sd_full">sd_full</code></td>
<td>
<p>a numeric number, which denotes the prior information of standard deviation for the harzard reduction if sig is not specified by user, then sd_full must has an input value to define the standard deviation of the full population</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_delta">DELTA</code></td>
<td>
<p>matrix, each row is an vector stands for the point estimation of harzard reduction in prior information corresponds to the r setting, if not specified we apply a linear scheme by giving bound to the linear harzard reduction</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_delta_linear_bd">delta_linear_bd</code></td>
<td>
<p>vector of length 2, specifying the upper bound and lower bound for the harzard reduction; if user don't specify the delta for each sub-population, then the linear scheme will apply and the input is a must.</p>
</td></tr>
<tr><td><code id="designCTPB_+3A_seed">seed</code></td>
<td>
<p>integer,  seed for random number generation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the standard deviation of each population can be specified by giving SIGMA as input, and specify the harzard reduction rate DELTA for each population. Just enter values to SIGMA and DELTA, but note that the entered matrix should coincides with the matrix of r-split setting.
</p>


<h3>Value</h3>

<p>list of 5 parts: plot_power: 3-d plot of the optimal power values versus r2 and r3; plot_alpha: 3-d plot of the optimal alpha-split values versus r2 and r3; opt_r_split: the optimal choice of proportion for each sub-population; opt_power: the optimal power values with the optimal r choice; opt_alpha_split: the optimal alpha split with the optimal r choice
</p>


<h3>See Also</h3>

<p>Grid setting of proportions for each sub-population proportion() and alpha.split()
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# the default setting of our paper's strong biomarker effect 
res &lt;- designCTPB()
res$plot_power # to see 3-d plot for the optimal power versus r2 and r3
res$plot_alpha # to see 3-d plot for the optimal alpha versus r2 and r3
res$opt_r_split #  to see the optimal cutoff of the sub-population, 
#and here suggesting not cutoff at the 2-nd sub-population
res$opt_power 
res$opt_alpha_split

## End(Not run)
</code></pre>

<hr>
<h2 id='phat'>Point estimator for the power value</h2><span id='topic+phat'></span>

<h3>Description</h3>

<p>This function is to estimate the power values given fixed proportion r for each sub-population, which we utilize Monte Carlo method and GPU accelerator to estimate the power value. The user can specify the standard deviation and harzard reduction for each sub-population as the prior information of harzard reduction distribution, when not specified, we apply a default setting of linear harzard reduction scheme and the sd for each sub-population is inversely proportional to sqrt(r_i)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phat(
  r,
  N1,
  N2,
  N3,
  E = NULL,
  sig = NULL,
  sd_full,
  delta = NULL,
  delta_linear_bd,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phat_+3A_r">r</code></td>
<td>
<p>vector for the proportion for each sub-population, r_1is 1, r_i&gt;r_i+1</p>
</td></tr>
<tr><td><code id="phat_+3A_n1">N1</code></td>
<td>
<p>integer, which is fixed as 10240 in our package</p>
</td></tr>
<tr><td><code id="phat_+3A_n2">N2</code></td>
<td>
<p>integer, which is fixed as 20480 in our package</p>
</td></tr>
<tr><td><code id="phat_+3A_n3">N3</code></td>
<td>
<p>integer, the number of grid point for the sig.lv, which should be the multiples of 5, because we apply 5 stream parallel</p>
</td></tr>
<tr><td><code id="phat_+3A_e">E</code></td>
<td>
<p>integer, the total number of events for the Phase 3 clinical trail, if not specified, then an estimation will be applied</p>
</td></tr>
<tr><td><code id="phat_+3A_sig">sig</code></td>
<td>
<p>the vector of standard deviation of each sub-population</p>
</td></tr>
<tr><td><code id="phat_+3A_sd_full">sd_full</code></td>
<td>
<p>a numeric number, which denotes the prior information of standard deviation for the harzard reduction. If sig is not specified, then sd_full must has an input value to define the standard deviation of the full population</p>
</td></tr>
<tr><td><code id="phat_+3A_delta">delta</code></td>
<td>
<p>vector, the point estimation of harzard reduction in prior information, if not specified we apply a linear scheme by giving bound to the linear harzard reduction</p>
</td></tr>
<tr><td><code id="phat_+3A_delta_linear_bd">delta_linear_bd</code></td>
<td>
<p>vector of length 2, specifying the upper bound and lower bound for the harzard reduction; if user don't specify the delta for each sub-population, then the linear scheme will apply and the input is a must.</p>
</td></tr>
<tr><td><code id="phat_+3A_seed">seed</code></td>
<td>
<p>integer,  seed for random number generation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We interface python by reticulate package to utilize numba(cuda version) module to accelerate calculation.
</p>


<h3>Value</h3>

<p>list of 2 parts of the sampling points given specific r; alpha is the matrix as each row is the given sig.lv for each population; power is the corresponding power values given each row of the alpha
</p>

<hr>
<h2 id='proportion'>Grid setting of proportions for each sub-population</h2><span id='topic+proportion'></span>

<h3>Description</h3>

<p>This function is to decide the r setting given specific density in each dimension
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proportion(m, n_dim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="proportion_+3A_m">m</code></td>
<td>
<p>integer, the number of grid points in each dimension, and we suggest m around 20 for 3 dimension</p>
</td></tr>
<tr><td><code id="proportion_+3A_n_dim">n_dim</code></td>
<td>
<p>integer for the dimension, which is equal to the number of sub-population plus 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of setting the proportion of the population by given specific dimension and density in each dimension
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
