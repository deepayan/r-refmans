<!DOCTYPE html><html><head><title>Help for package smoothtail</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {smoothtail}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#falk'><p>Compute original and smoothed version of Falk's estimator</p></a></li>
<li><a href='#falkMVUE'><p>Compute original and smoothed version of Falk's estimator for a known endpoint</p></a></li>
<li><a href='#generalizedPick'><p>Compute generalized Pickand's estimator</p></a></li>
<li><a href='#gpd'><p>The Generalized Pareto Distribution</p></a></li>
<li><a href='#lambdaGenPick'><p>Auxiliary function to compute Segers' estimator</p></a></li>
<li><a href='#pickands'><p>Compute original and smoothed version of Pickands' estimator</p></a></li>
<li><a href='#smoothtail-package'><p>Smooth Estimation of GPD Shape Parameter</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Smooth Estimation of GPD Shape Parameter</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-07-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaspar Ru{f}{i}bach &lt;kaspar.rufibach@gmail.com&gt; and Samuel Mueller &lt;samuel.mueller@sydney.edu.au&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaspar Rufibach &lt;kaspar.rufibach@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>logcondens (&ge; 2.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Given independent and identically distributed observations X(1), ..., X(n) from a Generalized Pareto distribution with shape parameter gamma in [-1,0], offers several estimates to compute estimates of gamma. The estimates are based on the principle of replacing the order statistics by quantiles of a distribution function based on a log&ndash;concave density function. This procedure is justified by the fact that the GPD density is log&ndash;concave for gamma in [-1,0].</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>,
www.maths.usyd.edu.au/ut/people?who=S_Mueller</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-07-12 13:22:28 UTC; rufiback</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-07-13 10:19:42</td>
</tr>
</table>
<hr>
<h2 id='falk'>Compute original and smoothed version of Falk's estimator</h2><span id='topic+falk'></span>

<h3>Description</h3>

<p>Given an ordered sample of either exceedances or upper order statistics which is to be modeled using a GPD, this 
function provides Falk's estimator of the shape parameter <code class="reqn">\gamma \in [-1,0]</code>. Precisely,
</p>
<p style="text-align: center;"><code class="reqn">\hat \gamma_{\rm{Falk}} = \hat \gamma_{\rm{Falk}}(k, n) = \frac{1}{k-1} \sum_{j=2}^k \log \Bigl(\frac{X_{(n)}-H^{-1}((n-j+1)/n)}{X_{(n)}-H^{-1}((n-k)/n)} \Bigr), \; \; k=3, \ldots ,n-1</code>
</p>

<p>for $H$ either the empirical or the distribution function based on the log&ndash;concave density estimator.
Note that for any <code class="reqn">k</code>, <code class="reqn">\hat \gamma_{\rm{Falk}} : R^n \to (-\infty, 0)</code>. If 
<code class="reqn">\hat \gamma_{\rm{Falk}} \not \in [-1,0)</code>, then it is likely that the log-concavity assumption is violated.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>falk(est, ks = NA)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="falk_+3A_est">est</code></td>
<td>
<p>Log-concave density estimate based on the sample as output by <code>logConDens</code> (a <code>dlc</code> object).</p>
</td></tr>
<tr><td><code id="falk_+3A_ks">ks</code></td>
<td>
<p>Indices <code class="reqn">k</code> at which Falk's estimate should be computed. If set to <code>NA</code> defaults to <code class="reqn">3, \ldots, n-1</code>.</p>
</td></tr></table>


<h3>Value</h3>

<p>n x 3 matrix with columns: indices <code class="reqn">k</code>, Falk's estimator based on the log-concave density estimate, and
the ordinary Falk's estimator based on the order statistics.
</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Samuel Mueller, <a href="mailto:samuel.mueller@sydney.edu.au">samuel.mueller@sydney.edu.au</a>, <br /> <a href="www.maths.usyd.edu.au/ut/people?who=S_Mueller">www.maths.usyd.edu.au/ut/people?who=S_Mueller</a>
</p>
<p>Kaspar Rufibach acknowledges support by the Swiss National Science Foundation SNF, <a href="http://www.snf.ch">http://www.snf.ch</a>
</p>


<h3>References</h3>

<p>Mueller, S. and Rufibach K. (2009).
Smooth tail index estimation.
<em>J. Stat. Comput. Simul.</em>, <b>79</b>, 1155&ndash;1167.
</p>
<p>Falk, M. (1995).
Some best parameter estimates for distributions with finite endpoint.
<em>Statistics</em>, <b>27</b>, 115&ndash;125.
</p>


<h3>See Also</h3>

<p>Other approaches to estimate <code class="reqn">\gamma</code> based on the fact that the density is log&ndash;concave, thus
<code class="reqn">\gamma \in [-1,0]</code>, are available as the functions <code><a href="#topic+pickands">pickands</a></code>, <code><a href="#topic+falkMVUE">falkMVUE</a></code>, <code><a href="#topic+generalizedPick">generalizedPick</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate ordered random sample from GPD
set.seed(1977)
n &lt;- 20
gam &lt;- -0.75
x &lt;- rgpd(n, gam)

## generate dlc object
est &lt;- logConDens(x, smoothed = FALSE, print = FALSE, gam = NULL, xs = NULL)

# compute tail index estimator
falk(est)
</code></pre>

<hr>
<h2 id='falkMVUE'>Compute original and smoothed version of Falk's estimator for a known endpoint</h2><span id='topic+falkMVUE'></span>

<h3>Description</h3>

<p>Given an ordered sample of either exceedances or upper order statistics which is to be modeled using a GPD with 
distribution function <code class="reqn">F</code>, this function provides Falk's estimator of the shape parameter <code class="reqn">\gamma \in [-1,0]</code> 
if the endpoint 
</p>
<p style="text-align: center;"><code class="reqn">\omega(F) = \sup\{x \, : \, F(x) &lt; 1\}</code>
</p>
 
<p>of <code class="reqn">F</code> is known. Precisely,
</p>
<p style="text-align: center;"><code class="reqn">\hat \gamma_{\rm{MVUE}} = \hat \gamma_{\rm{MVUE}}(k,n) = \frac{1}{k} \sum_{j=1}^k \log \Bigl(\frac{\omega(F)-H^{-1}((n-j+1)/n)}{\omega(F)-H^{-1}((n-k)/n)}\Bigr), \; \; k=2,\ldots,n-1</code>
</p>
 
<p>for <code class="reqn">H</code> either the empirical or the distribution function based on the log&ndash;concave density estimator.
Note that for any <code class="reqn">k</code>, <code class="reqn">\hat \gamma_{\rm{MVUE}} : R^n \to (-\infty, 0)</code>. If <code class="reqn">\hat \gamma_{\rm{MVUE}} 
\not \in [-1,0)</code>, then it is likely that the log-concavity assumption is violated.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>falkMVUE(est, omega, ks = NA)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="falkMVUE_+3A_est">est</code></td>
<td>
<p>Log-concave density estimate based on the sample as output by <code>logConDens</code> (a <code>dlc</code> object).</p>
</td></tr>
<tr><td><code id="falkMVUE_+3A_omega">omega</code></td>
<td>
<p>Known endpoint. Make sure that <code class="reqn">\omega \ge X_{(n)}</code>.</p>
</td></tr>
<tr><td><code id="falkMVUE_+3A_ks">ks</code></td>
<td>
<p>Indices <code class="reqn">k</code> at which Falk's estimate should be computed. If set to <code>NA</code> defaults to <code class="reqn">2, \ldots, n-1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>n x 3 matrix with columns: indices <code class="reqn">k</code>, Falk's MVUE estimator using the log-concave density estimate, and
the ordinary Falk MVUE estimator based on the order statistics.
</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Samuel Mueller, <a href="mailto:samuel.mueller@sydney.edu.au">samuel.mueller@sydney.edu.au</a>, <br /> <a href="www.maths.usyd.edu.au/ut/people?who=S_Mueller">www.maths.usyd.edu.au/ut/people?who=S_Mueller</a>
</p>
<p>Kaspar Rufibach acknowledges support by the Swiss National Science Foundation SNF, <a href="http://www.snf.ch">http://www.snf.ch</a>
</p>


<h3>References</h3>

<p>Mueller, S. and Rufibach K. (2009).
Smooth tail index estimation.
<em>J. Stat. Comput. Simul.</em>, <b>79</b>, 1155&ndash;1167.
</p>
<p>Falk, M. (1994).
Extreme quantile estimation in <code class="reqn">\delta</code>-neighborhoods of generalized Pareto distributions.
<em>Statistics and Probability Letters</em>, <b>20</b>, 9&ndash;21.
</p>
<p>Falk, M. (1995).
Some best parameter estimates for distributions with finite endpoint.
<em>Statistics</em>, <b>27</b>, 115&ndash;125.
</p>


<h3>See Also</h3>

<p>Other approaches to estimate <code class="reqn">\gamma</code> based on the fact that the density is log&ndash;concave, thus 
<code class="reqn">\gamma \in [-1,0]</code>, are available as the functions <code><a href="#topic+pickands">pickands</a></code>, <code><a href="#topic+falk">falk</a></code>, <code><a href="#topic+generalizedPick">generalizedPick</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate ordered random sample from GPD
set.seed(1977)
n &lt;- 20
gam &lt;- -0.75
x &lt;- rgpd(n, gam)

## generate dlc object
est &lt;- logConDens(x, smoothed = FALSE, print = FALSE, gam = NULL, xs = NULL)

# compute tail index estimators
omega &lt;- -1 / gam
falkMVUE(est, omega)
</code></pre>

<hr>
<h2 id='generalizedPick'>Compute generalized Pickand's estimator</h2><span id='topic+generalizedPick'></span>

<h3>Description</h3>

<p>Given an ordered sample of either exceedances or upper order statistics which is to be modeled using a GPD with 
distribution function <code class="reqn">F</code>, this function provides Segers' estimator of the shape parameter <code class="reqn">\gamma</code>, 
see Segers (2005). Precisely, for <code class="reqn">k = \{1, \ldots, n-1\}</code>, the estimator can be written as
</p>
<p style="text-align: center;"><code class="reqn">\hat \gamma^k_{\rm{Segers}}(H) = \sum_{j=1}^k \Bigl(\lambda(j/k) - \lambda((j-1)/k)\Bigr) \log \Bigl(H^{-1}((n-\lfloor cj \rfloor)/n)-H^{-1}((n-j)/n) \Bigr)</code>
</p>

<p>for <code class="reqn">H</code> either the empirical or the distribution function based on the log&ndash;concave density estimator
and <code class="reqn">\lambda</code> the mixing measure given in Segers (2005), Theorem 4.1, (i).
Note that for any <code class="reqn">k</code>, <code class="reqn">\hat \gamma^k_{\rm{Segers}} : R^n \to (-\infty, \infty)</code>. 
If <code class="reqn">\hat \gamma_{\rm{Segers}} \not \in [-1,0)</code>, then it is likely that the log-concavity assumption is violated.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generalizedPick(est, c, gam0, ks = NA)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generalizedPick_+3A_est">est</code></td>
<td>
<p>Log-concave density estimate based on the sample as output by <code>logConDens</code> (a <code>dlc</code> object).</p>
</td></tr>
<tr><td><code id="generalizedPick_+3A_c">c</code></td>
<td>
<p>Number in <code class="reqn">(0,1)</code>, determining the spacings that are used.</p>
</td></tr>
<tr><td><code id="generalizedPick_+3A_gam0">gam0</code></td>
<td>
<p>Number in <code class="reqn">R \setminus 0.5</code>, specifying the mixing measure.</p>
</td></tr>
<tr><td><code id="generalizedPick_+3A_ks">ks</code></td>
<td>
<p>Indices <code class="reqn">k</code> at which Falk's estimate should be computed. If set to <code>NA</code> defaults to <code class="reqn">4, \ldots, n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>n x 3 matrix with columns: indices <code class="reqn">k</code>, Segers' estimator using the smoothing method, and
the ordinary Segers' estimator based on the order statistics.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Samuel Mueller, <a href="mailto:samuel.mueller@sydney.edu.au">samuel.mueller@sydney.edu.au</a>, <br /> <a href="www.maths.usyd.edu.au/ut/people?who=S_Mueller">www.maths.usyd.edu.au/ut/people?who=S_Mueller</a>
</p>
<p>Kaspar Rufibach acknowledges support by the Swiss National Science Foundation SNF, <a href="http://www.snf.ch">http://www.snf.ch</a>
</p>


<h3>References</h3>

<p>Mueller, S. and Rufibach K. (2009).
Smooth tail index estimation.
<em>J. Stat. Comput. Simul.</em>, <b>79</b>, 1155&ndash;1167.
</p>
<p>Segers, J. (2005).
Generalized Pickands estimators for the extreme value index.
<em>J. Statist. Plann. Inference</em>, <b>128</b>, 381&ndash;396.
</p>


<h3>See Also</h3>

<p>Other approaches to estimate <code class="reqn">\gamma</code> based on the fact that the density is log&ndash;concave, thus 
<code class="reqn">\gamma \in [-1,0]</code>, are available as the functions <code><a href="#topic+pickands">pickands</a></code>, <code><a href="#topic+falk">falk</a></code>, <code><a href="#topic+falkMVUE">falkMVUE</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate ordered random sample from GPD
set.seed(1977)
n &lt;- 20
gam &lt;- -0.75
x &lt;- rgpd(n, gam)

## generate dlc object
est &lt;- logConDens(x, smoothed = FALSE, print = FALSE, gam = NULL, xs = NULL)

# compute tail index estimators
generalizedPick(est, c = 0.75, gam0 = -1/3)
</code></pre>

<hr>
<h2 id='gpd'>The Generalized Pareto Distribution</h2><span id='topic+gpd'></span><span id='topic+dgpd'></span><span id='topic+pgpd'></span><span id='topic+qgpd'></span><span id='topic+rgpd'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantile function and
random generation for the generalized Pareto distribution (GPD) with shape parameter <code class="reqn">\gamma</code> and 
scale parameter <code class="reqn">\sigma</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgpd(x, gam, sigma = 1) 
pgpd(q, gam, sigma = 1) 
qgpd(p, gam, sigma = 1)
rgpd(n, gam, sigma = 1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gpd_+3A_x">x</code>, <code id="gpd_+3A_q">q</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="gpd_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="gpd_+3A_n">n</code></td>
<td>
<p>Number of observations.</p>
</td></tr>
<tr><td><code id="gpd_+3A_gam">gam</code></td>
<td>
<p>Shape parameter, real number.</p>
</td></tr>
<tr><td><code id="gpd_+3A_sigma">sigma</code></td>
<td>
<p>Scale parameter, positive real number.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized Pareto distribution function (Pickands, 1975) with
shape parameter <code class="reqn">\gamma</code> and scale parameter <code class="reqn">\sigma</code> is
</p>
<p style="text-align: center;"><code class="reqn">W_{\gamma,\sigma}(x) = 1 - {(1+\gamma x / \sigma)}_+^{-1/\gamma}.</code>
</p>

<p>If <code class="reqn">\gamma = 0</code>, the distribution function is defined by continuity. The density is denoted by 
<code class="reqn">w_{\gamma, \sigma}</code>.
</p>


<h3>Value</h3>

<p><code><a href="#topic+dgpd">dgpd</a></code> gives the values of the density function, <code><a href="#topic+pgpd">pgpd</a></code> those of the distribution
function, and <code><a href="#topic+qgpd">qgpd</a></code> those of the quantile function of the GPD at <code class="reqn">{\bold x}, {\bold q},</code> and <code class="reqn">{\bold p}</code>, 
respectively. <code><a href="#topic+rgpd">rgpd</a></code> generates <code class="reqn">n</code> random numbers, returned as an ordered vector.
</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach, <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Samuel Mueller, <a href="mailto:samuel.mueller@sydney.edu.au">samuel.mueller@sydney.edu.au</a>, <br /> <a href="www.maths.usyd.edu.au/ut/people?who=S_Mueller">www.maths.usyd.edu.au/ut/people?who=S_Mueller</a></p>


<h3>References</h3>

<p>Pickands, J. (1975). Statistical inference using extreme order statistics. 
<em>Annals of Statistics</em>, <b>3</b>, 119-131.
</p>


<h3>See Also</h3>

<p>Similar functions are provided in the R-packages <span class="pkg">evir</span> and <span class="pkg">evd</span>.</p>

<hr>
<h2 id='lambdaGenPick'>Auxiliary function to compute Segers' estimator</h2><span id='topic+lambdaGenPick'></span>

<h3>Description</h3>

<p>This function computes
</p>
<p style="text-align: center;"><code class="reqn">\lambda_{\delta, \rho}^c</code>
</p>

<p>given in Theorem 4.1 of Segers (2005) and is called by <code><a href="#topic+generalizedPick">generalizedPick</a></code>.
It is not intended to be called by the user.
</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Samuel Mueller, <a href="mailto:samuel.mueller@sydney.edu.au">samuel.mueller@sydney.edu.au</a>, <br /> <a href="www.maths.usyd.edu.au/ut/people?who=S_Mueller">www.maths.usyd.edu.au/ut/people?who=S_Mueller</a>
</p>
<p>Kaspar Rufibach acknowledges support by the Swiss National Science Foundation SNF, <a href="http://www.snf.ch">http://www.snf.ch</a>
</p>


<h3>References</h3>

<p>Mueller, S. and Rufibach K. (2009).
Smooth tail index estimation.
<em>J. Stat. Comput. Simul.</em>, <b>79</b>, 1155&ndash;1167.
</p>
<p>Segers, J. (2005).
Generalized Pickands estimators for the extreme value index.
<em>J. Statist. Plann. Inference</em>, <b>128</b>, 381&ndash;396.
</p>


<h3>See Also</h3>

<p>Called by <code><a href="#topic+generalizedPick">generalizedPick</a></code>.</p>

<hr>
<h2 id='pickands'>Compute original and smoothed version of Pickands' estimator</h2><span id='topic+pickands'></span>

<h3>Description</h3>

<p>Given an ordered sample of either exceedances or upper order statistics which is to be modeled using a GPD, this 
function provides Pickands' estimator of the shape parameter <code class="reqn">\gamma \in [-1,0]</code>. 
Precisely, for <code class="reqn">k=4, \ldots, n</code>
</p>
<p style="text-align: center;"><code class="reqn">\hat \gamma^k_{\rm{Pick}} = \frac{1}{\log 2} \log \Bigl(\frac{H^{-1}((n-r_k(H)+1)/n)-H^{-1}((n-2r_k(H) +1)/n)}{H^{-1}((n-2r_k(H) +1)/n)-H^{-1}((n-4r_k(H)+1)/n)} \Bigr)</code>
</p>
 
<p>for $H$ either the empirical or the distribution function <code class="reqn">\hat F_n</code> based on the log&ndash;concave density 
estimator and
</p>
<p style="text-align: center;"><code class="reqn">r_k(H) = \lfloor k/4 \rfloor</code>
</p>

<p>if <code class="reqn">H</code> is the empirical distribution function and
</p>
<p style="text-align: center;"><code class="reqn">r_k(H) = k / 4</code>
</p>

<p>if <code class="reqn">H = \hat F_n</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pickands(est, ks = NA)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pickands_+3A_est">est</code></td>
<td>
<p>Log-concave density estimate based on the sample as output by <code>logConDens</code> (a <code>dlc</code> object).</p>
</td></tr>
<tr><td><code id="pickands_+3A_ks">ks</code></td>
<td>
<p>Indices <code class="reqn">k</code> at which Falk's estimate should be computed. If set to <code>NA</code> defaults to <code class="reqn">4, \ldots, n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>n x 3 matrix with columns: indices <code class="reqn">k</code>, Pickands' estimator using the log-concave density estimate, and
the ordinary Pickands' estimator based on the order statistics.
</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>, <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a> 
</p>
<p>Samuel Mueller, <a href="mailto:samuel.mueller@sydney.edu.au">samuel.mueller@sydney.edu.au</a>, <br /> <a href="www.maths.usyd.edu.au/ut/people?who=S_Mueller">www.maths.usyd.edu.au/ut/people?who=S_Mueller</a>
</p>
<p>Kaspar Rufibach acknowledges support by the Swiss National Science Foundation SNF, <a href="http://www.snf.ch">http://www.snf.ch</a>
</p>


<h3>References</h3>

<p>Mueller, S. and Rufibach K. (2009).
Smooth tail index estimation.
<em>J. Stat. Comput. Simul.</em>, <b>79</b>, 1155&ndash;1167.
</p>
<p>Pickands, J. (1975).
Statistical inference using extreme order statistics.
<em>Annals of Statistics</em> <b>3</b>, 119&ndash;131.
</p>


<h3>See Also</h3>

<p>Other approaches to estimate <code class="reqn">\gamma</code> based on the fact that the density is log&ndash;concave, thus 
<code class="reqn">\gamma \in [-1,0]</code>, are available as the functions <code><a href="#topic+falk">falk</a></code>, <code><a href="#topic+falkMVUE">falkMVUE</a></code>, <code><a href="#topic+generalizedPick">generalizedPick</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate ordered random sample from GPD
set.seed(1977)
n &lt;- 20
gam &lt;- -0.75
x &lt;- rgpd(n, gam)

## generate dlc object
est &lt;- logConDens(x, smoothed = FALSE, print = FALSE, gam = NULL, xs = NULL)

# compute tail index estimators
pickands(est)
</code></pre>

<hr>
<h2 id='smoothtail-package'>Smooth Estimation of GPD Shape Parameter</h2><span id='topic+smoothtail-package'></span><span id='topic+smoothtail'></span><span id='topic+tail+20index'></span><span id='topic+logcon'></span><span id='topic+logcondens'></span>

<h3>Description</h3>

<p>Given independent and identically distributed observations <code class="reqn">X_1 &lt; \ldots &lt; X_n</code> from a 
Generalized Pareto distribution with shape parameter <code class="reqn">\gamma \in [-1,0]</code>, offers three 
methods to compute estimates of <code class="reqn">\gamma</code>. The estimates are based on the principle of replacing the order 
statistics <code class="reqn">X_{(1)}, \ldots, X_{(n)}</code> of the sample by quantiles <code class="reqn">\hat X_{(1)}, \ldots, \hat X_{(n)}</code> of the distribution function <code class="reqn">\hat F_n</code> based on the 
log&ndash;concave density estimator <code class="reqn">\hat f_n</code>. This procedure is justified by the fact that the GPD density is 
log&ndash;concave for <code class="reqn">\gamma \in [-1,0]</code>.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> smoothtail </td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0.5 </td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-07-12 </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Use this package to estimate the shape parameter <code class="reqn">\gamma</code> of a Generalized Pareto Distribution (GPD). In 
extreme value theory, <code class="reqn">\gamma</code> is denoted tail index. We offer three new estimators, all based on the fact 
that the density function of the GPD is log&ndash;concave if <code class="reqn">\gamma \in [-1,0]</code>, see Mueller and Rufibach (2009). 
The functions for estimation of the tail index are:
</p>
<p><code><a href="#topic+pickands">pickands</a></code> <br />
<code><a href="#topic+falk">falk</a></code><br />
<code><a href="#topic+falkMVUE">falkMVUE</a></code><br />
<code><a href="#topic+generalizedPick">generalizedPick</a></code>
</p>
<p>This package depends on the package <span class="pkg">logcondens</span> for estimation of a log&ndash;concave density: all the above functions take as first argument a <code>dlc</code> object as generated by <code>logConDens</code> in <span class="pkg">logcondens</span>.
</p>
<p>Additionally, functions for density, distribution function, quantile function and random number generation for
a GPD with location parameter 0, shape parameter <code class="reqn">\gamma</code> and scale parameter <code class="reqn">\sigma</code> are provided:
</p>
<p><code><a href="#topic+dgpd">dgpd</a></code><br />
<code><a href="#topic+pgpd">pgpd</a></code><br />
<code><a href="#topic+qgpd">qgpd</a></code><br />
<code><a href="#topic+rgpd">rgpd</a></code>.
</p>
<p>Let us shortly clarify what we mean with log&ndash;concave density estimation. Suppose we are given an ordered sample
<code class="reqn">Y_1 &lt; \ldots &lt; Y_n</code> of i.i.d. random variables having density function <code class="reqn">f</code>, where <code class="reqn">f = \exp \varphi</code>
for a concave function <code class="reqn">\varphi : [-\infty, \infty) \to R</code>. Following the development in 
Duembgen and Rufibach (2009), it is then possible to get an estimator <code class="reqn">\hat f_n = \exp \hat \varphi_n</code> 
of <code class="reqn">f</code> via the maximizer <code class="reqn">\hat \varphi_n</code> of
</p>
<p style="text-align: center;"><code class="reqn">L(\varphi) =  \sum_{i=1}^n \varphi(Y_i) -  \int \exp \varphi (t) d t</code>
</p>

<p>over all concave functions <code class="reqn">\varphi</code>. It turns out that <code class="reqn">\hat \varphi_n</code> is piecewise linear, with 
knots only at (some of the) observation points. Therefore, the infinite-dimensional optimization problem of finding 
the function <code class="reqn">\hat \varphi_n</code> boils down to a finite dimensional problem of finding the vector <code class="reqn">(\hat \varphi_n(Y_1),\ldots,\hat \varphi(Y_n))</code>. 
How to solve this problem is
described in Rufibach (2006, 2007) and in a more general setting in Duembgen, Huesler, and Rufibach (2010). The distribution function based on <code class="reqn">\hat f_n</code> is defined as
</p>
<p style="text-align: center;"><code class="reqn">\hat F_n(x) = \int_{Y_1}^x \hat f_n(t) d t</code>
</p>

<p>for <code class="reqn">x</code> a real number. The definition of <code class="reqn">\hat F_n</code> is justified by the fact that <code class="reqn">\hat F_n(Y_1) = 0</code>.
</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer), <a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a> , <br /> <a href="http://www.kasparrufibach.ch">http://www.kasparrufibach.ch</a>
</p>
<p>Samuel Mueller, <a href="mailto:samuel.mueller@sydney.edu.au">samuel.mueller@sydney.edu.au</a>, <br /> <a href="www.maths.usyd.edu.au/ut/people?who=S_Mueller">www.maths.usyd.edu.au/ut/people?who=S_Mueller</a>
</p>
<p>Kaspar Rufibach acknowledges support by the Swiss National Science Foundation SNF, <a href="http://www.snf.ch">http://www.snf.ch</a>
</p>


<h3>References</h3>

<p>Duembgen, L. and Rufibach, K. (2009)
Maximum likelihood estimation of a log&ndash;concave density and its distribution function: basic properties and uniform consistency. 
<em>Bernoulli</em>, <b>15(1)</b>, 40&ndash;68.  
</p>
<p>Duembgen, L., Huesler, A. and Rufibach, K. (2010)
Active set and EM algorithms for log-concave densities based on complete and censored data.
Technical report 61, IMSV, Univ. of Bern, available at <a href="http://arxiv.org/abs/0707.4643">http://arxiv.org/abs/0707.4643</a>.
</p>
<p>Mueller, S. and Rufibach K. (2009).
Smooth tail index estimation.
<em>J. Stat. Comput. Simul.</em>, <b>79</b>, 1155&ndash;1167.
</p>
<p>Mueller, S. and Rufibach K. (2008).
On the max&ndash;domain of attraction of distributions with log&ndash;concave densities.
<em>Statist. Probab. Lett.</em>, <b>78</b>, 1440&ndash;1444.
</p>
<p>Rufibach K. (2006) <em>Log-concave Density Estimation and Bump Hunting for i.i.d. Observations.</em>
PhD Thesis, University of Bern, Switzerland and Georg-August University of Goettingen, Germany, 2006.
<br /> Available at <a href="http://www.zb.unibe.ch/download/eldiss/06rufibach_k.pdf">http://www.zb.unibe.ch/download/eldiss/06rufibach_k.pdf</a>.
</p>
<p>Rufibach, K. (2007)
Computing maximum likelihood estimators of a log-concave density function.
<em>J. Stat. Comput. Simul.</em>, <b>77</b>, 561&ndash;574.
</p>


<h3>See Also</h3>

<p>Package <span class="pkg">logcondens</span>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate ordered random sample from GPD
set.seed(1977)
n &lt;- 20
gam &lt;- -0.75
x &lt;- rgpd(n, gam)

# compute known endpoint
omega &lt;- -1 / gam

# estimate log-concave density, i.e. generate dlc object
est &lt;- logConDens(x, smoothed = FALSE, print = FALSE, gam = NULL, xs = NULL)

# plot distribution functions
s &lt;- seq(0.01, max(x), by = 0.01)
plot(0, 0, type = 'n', ylim = c(0, 1), xlim = range(c(x, s))); rug(x)
lines(s, pgpd(s, gam), type = 'l', col = 2)
lines(x, 1:n / n, type = 's', col = 3)
lines(x, est$Fhat, type = 'l', col = 4)
legend(1, 0.4, c('true', 'empirical', 'estimated'), col = c(2 : 4), lty = 1)

# compute tail index estimators for all sensible indices k
falk.logcon &lt;- falk(est)
falkMVUE.logcon &lt;- falkMVUE(est, omega)
pick.logcon &lt;- pickands(est)
genPick.logcon &lt;- generalizedPick(est, c = 0.75, gam0 = -1/3)

# plot smoothed and unsmoothed estimators versus number of order statistics
plot(0, 0, type = 'n', xlim = c(0,n), ylim = c(-1, 0.2))
lines(1:n, pick.logcon[, 2], col = 1); lines(1:n, pick.logcon[, 3], col = 1, lty = 2)
lines(1:n, falk.logcon[, 2], col = 2); lines(1:n, falk.logcon[, 3], col = 2, lty = 2)
lines(1:n, falkMVUE.logcon[,2], col = 3); lines(1:n, falkMVUE.logcon[,3], col = 3, 
    lty = 2)
lines(1:n, genPick.logcon[, 2], col = 4); lines(1:n, genPick.logcon[, 3], col = 4, 
    lty = 2)
abline(h = gam, lty = 3)
legend(11, 0.2, c("Pickands", "Falk", "Falk MVUE", "Generalized Pickands'"), 
    lty = 1, col = 1:8)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
