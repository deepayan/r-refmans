<!DOCTYPE html><html><head><title>Help for package graphics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {graphics}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#graphics-package'>
<p>The R Graphics Package</p></a></li>
<li><a href='#abline'><p>Add Straight Lines to a Plot</p></a></li>
<li><a href='#arrows'><p>Add Arrows to a Plot</p></a></li>
<li><a href='#assocplot'><p>Association Plots</p></a></li>
<li><a href='#axis'><p>Add an Axis to a Plot</p></a></li>
<li><a href='#Axis'><p>Generic Function to Add an Axis to a Plot</p></a></li>
<li><a href='#axis.POSIXct'><p>Date and Date-time Plotting Functions</p></a></li>
<li><a href='#axTicks'><p>Compute Axis Tickmark Locations</p></a></li>
<li><a href='#barplot'><p>Bar Plots</p></a></li>
<li><a href='#box'><p>Draw a Box around a Plot</p></a></li>
<li><a href='#boxplot'><p>Box Plots</p></a></li>
<li><a href='#boxplot.matrix'><p>Draw a Boxplot for each Column (Row) of a Matrix</p></a></li>
<li><a href='#bxp'><p>Draw Box Plots from Summaries</p></a></li>
<li><a href='#cdplot'><p>Conditional Density Plots</p></a></li>
<li><a href='#clip'><p>Set Clipping Region</p></a></li>
<li><a href='#contour'><p>Display Contours</p></a></li>
<li><a href='#convertXY'><p>Convert between Graphics Coordinate Systems</p></a></li>
<li><a href='#coplot'><p>Conditioning Plots</p></a></li>
<li><a href='#curve'><p>Draw Function Plots</p></a></li>
<li><a href='#dotchart'><p>Cleveland's Dot Plots</p></a></li>
<li><a href='#filled.contour'><p>Level (Contour) Plots</p></a></li>
<li><a href='#fourfoldplot'><p>Fourfold Plots</p></a></li>
<li><a href='#frame'><p>Create / Start a New Plot Frame</p></a></li>
<li><a href='#graphics-defunct'><p>Defunct Functions in Package <span class="pkg">graphics</span></p></a></li>
<li><a href='#grid'><p>Add Grid to a Plot</p></a></li>
<li><a href='#hist'><p>Histograms</p></a></li>
<li><a href='#hist.POSIXt'><p>Histogram of a Date or Date-Time Object</p></a></li>
<li><a href='#identify'><p>Identify Points in a Scatter Plot</p></a></li>
<li><a href='#image'><p>Display a Color Image</p></a></li>
<li><a href='#layout'><p>Specifying Complex Plot Arrangements</p></a></li>
<li><a href='#legend'><p>Add Legends to Plots</p></a></li>
<li><a href='#lines'><p>Add Connected Line Segments to a Plot</p></a></li>
<li><a href='#locator'><p>Graphical Input</p></a></li>
<li><a href='#matplot'><p>Plot Columns of Matrices</p></a></li>
<li><a href='#mosaicplot'><p>Mosaic Plots</p></a></li>
<li><a href='#mtext'><p>Write Text into the Margins of a Plot</p></a></li>
<li><a href='#pairs'><p>Scatterplot Matrices</p></a></li>
<li><a href='#panel.smooth'><p>Simple Panel Plot</p></a></li>
<li><a href='#par'><p>Set or Query Graphical Parameters</p></a></li>
<li><a href='#persp'><p>Perspective Plots</p></a></li>
<li><a href='#pie'><p>Pie Charts</p></a></li>
<li><a href='#plot.data.frame'><p>Plot Method for Data Frames</p></a></li>
<li><a href='#plot.default'><p>The Default Scatterplot Function</p></a></li>
<li><a href='#plot.design'><p>Plot Univariate Effects of a Design or Model</p></a></li>
<li><a href='#plot.factor'><p>Plotting Factor Variables</p></a></li>
<li><a href='#plot.formula'><p>Formula Notation for Scatterplots</p></a></li>
<li><a href='#plot.histogram'><p>Plot Histograms</p></a></li>
<li><a href='#plot.raster'><p>Plotting Raster Images</p></a></li>
<li><a href='#plot.table'><p>Plot Methods for <code>table</code> Objects</p></a></li>
<li><a href='#plot.window'><p>Set up World Coordinates for Graphics Window</p></a></li>
<li><a href='#plot.xy'><p>Basic Internal Plot Function</p></a></li>
<li><a href='#points'><p>Add Points to a Plot</p></a></li>
<li><a href='#polygon'><p>Polygon Drawing</p></a></li>
<li><a href='#polypath'><p>Path Drawing</p></a></li>
<li><a href='#rasterImage'><p>Draw One or More Raster Images</p></a></li>
<li><a href='#rect'><p>Draw One or More Rectangles</p></a></li>
<li><a href='#rug'><p>Add a Rug to a Plot</p></a></li>
<li><a href='#screen'><p>Creating and Controlling Multiple Screens on a Single Device</p></a></li>
<li><a href='#segments'><p>Add Line Segments to a Plot</p></a></li>
<li><a href='#smoothScatter'><p>Scatterplots with Smoothed Densities Color Representation</p></a></li>
<li><a href='#spineplot'><p>Spine Plots and Spinograms</p></a></li>
<li><a href='#stars'><p>Star (Spider/Radar) Plots and Segment Diagrams</p></a></li>
<li><a href='#stem'><p>Stem-and-Leaf Plots</p></a></li>
<li><a href='#stripchart'><p>1-D Scatter Plots</p></a></li>
<li><a href='#strwidth'><p>Plotting Dimensions of Character Strings and Math Expressions</p></a></li>
<li><a href='#sunflowerplot'><p>Produce a Sunflower Scatter Plot</p></a></li>
<li><a href='#symbols'><p>Draw Symbols (Circles, Squares, Stars, Thermometers, Boxplots)</p></a></li>
<li><a href='#text'><p>Add Text to a Plot</p></a></li>
<li><a href='#title'><p>Plot Annotation</p></a></li>
<li><a href='#units'><p>Graphical Units</p></a></li>
<li><a href='#xspline'><p>Draw an X-spline</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>4.5.0</td>
</tr>
<tr>
<td>Priority:</td>
<td>base</td>
</tr>
<tr>
<td>Title:</td>
<td>The R Graphics Package</td>
</tr>
<tr>
<td>Author:</td>
<td>R Core Team and contributors worldwide</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>R Core Team &lt;do-use-Contact-address@r-project.org&gt;</td>
</tr>
<tr>
<td>Contact:</td>
<td>R-help mailing list &lt;r-help@r-project.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>R functions for base graphics.</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices</td>
</tr>
<tr>
<td>License:</td>
<td>Part of R 4.5.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Enhances:</td>
<td>vcd</td>
</tr>
<tr>
<td>Built:</td>
<td>R 4.5.0; x86_64-pc-linux-gnu; 2024-04-16 07:37:02 UTC; unix</td>
</tr>
</table>
<hr>
<h2 id='graphics-package'>
The R Graphics Package
</h2><span id='topic+graphics-package'></span><span id='topic+graphics'></span>

<h3>Description</h3>

<p>R functions for base graphics
</p>


<h3>Details</h3>

<p>This package contains functions for &lsquo;base&rsquo; graphics.  Base graphics
are traditional S-like graphics, as opposed to the more recent
<a href="grid.html#topic+grid-package">grid</a> graphics.
</p>
<p>For a complete list of functions with individual help pages,
use <code>library(help = "graphics")</code>.
</p>


<h3>Author(s)</h3>

<p>R Core Team and contributors worldwide
</p>
<p>Maintainer: R Core Team <a href="mailto:R-core@r-project.org">R-core@r-project.org</a>
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>

<hr>
<h2 id='abline'>Add Straight Lines to a Plot</h2><span id='topic+abline'></span>

<h3>Description</h3>

<p>This function adds one or more straight lines through the current plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abline(a = NULL, b = NULL, h = NULL, v = NULL, reg = NULL,
       coef = NULL, untf = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="abline_+3A_a">a</code>, <code id="abline_+3A_b">b</code></td>
<td>
<p>the intercept and slope, single values.</p>
</td></tr>
<tr><td><code id="abline_+3A_untf">untf</code></td>
<td>
<p>logical asking whether to <em>untransform</em>.  See
&lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="abline_+3A_h">h</code></td>
<td>
<p>the y-value(s) for horizontal line(s).</p>
</td></tr>
<tr><td><code id="abline_+3A_v">v</code></td>
<td>
<p>the x-value(s) for vertical line(s).</p>
</td></tr>
<tr><td><code id="abline_+3A_coef">coef</code></td>
<td>
<p>a vector of length two giving the intercept and slope.</p>
</td></tr>
<tr><td><code id="abline_+3A_reg">reg</code></td>
<td>
<p>an object with a <code><a href="stats.html#topic+coef">coef</a></code> method.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="abline_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> such as
<code>col</code>, <code>lty</code> and  <code>lwd</code> (possibly as vectors: see
&lsquo;Details&rsquo;) and <code>xpd</code> and the line characteristics
<code>lend</code>, <code>ljoin</code> and <code>lmitre</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Typical usages are
</p>
<pre>abline(a, b, ...)
abline(h =, ...)
abline(v =, ...)
abline(coef =, ...)
abline(reg =, ...)
</pre>
<p>The first form specifies the line in intercept/slope form
(alternatively <code>a</code> can be specified on its own and is taken to
contain the slope and intercept in vector form).
</p>
<p>The <code>h=</code> and <code>v=</code> forms draw horizontal and vertical lines
at the specified coordinates.
</p>
<p>The <code>coef</code> form specifies the line by a vector containing the
slope and intercept.
</p>
<p><code>reg</code> is a regression object with a <code><a href="stats.html#topic+coef">coef</a></code> method.
If this returns a vector of length 1 then the value is taken to be the
slope of a line through the origin, otherwise, the first 2 values are
taken to be the intercept and slope.
</p>
<p>If <code>untf</code> is true, and one or both axes are log-transformed, then
a curve is drawn corresponding to a line in original coordinates,
otherwise a line is drawn in the transformed coordinate system. The
<code>h</code> and <code>v</code> parameters always refer to original coordinates.
</p>
<p>The <a href="#topic+graphical+20parameters">graphical parameters</a> <code>col</code>, <code>lty</code> and <code>lwd</code>
can be specified; see <code><a href="#topic+par">par</a></code> for details.  For the
<code>h=</code> and <code>v=</code> usages they can be vectors of length greater
than one, recycled as necessary.
</p>
<p>Specifying an <code>xpd</code> argument for clipping overrides
the global <code><a href="#topic+par">par</a>("xpd")</code> setting used otherwise.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lines">lines</a></code> and <code><a href="#topic+segments">segments</a></code> for connected and
arbitrary lines given by their <em>endpoints</em>.
<code><a href="#topic+par">par</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Setup up coordinate system (with x == y aspect ratio):
plot(c(-2,3), c(-1,5), type = "n", xlab = "x", ylab = "y", asp = 1)
## the x- and y-axis, and an integer grid
abline(h = 0, v = 0, col = "gray60")
text(1,0, "abline( h = 0 )", col = "gray60", adj = c(0, -.1))
abline(h = -1:5, v = -2:3, col = "lightgray", lty = 3)
abline(a = 1, b = 2, col = 2)
text(1,3, "abline( 1, 2 )", col = 2, adj = c(-.1, -.1))

## Simple Regression Lines:
require(stats)
sale5 &lt;- c(6, 4, 9, 7, 6, 12, 8, 10, 9, 13)
plot(sale5)
abline(lsfit(1:10, sale5))
abline(lsfit(1:10, sale5, intercept = FALSE), col = 4) # less fitting

z &lt;- lm(dist ~ speed, data = cars)
plot(cars)
abline(z) # equivalent to abline(reg = z) or
abline(coef = coef(z))

## trivial intercept model
abline(mC &lt;- lm(dist ~ 1, data = cars)) ## the same as
abline(a = coef(mC), b = 0, col = "blue")
</code></pre>

<hr>
<h2 id='arrows'>Add Arrows to a Plot</h2><span id='topic+arrows'></span>

<h3>Description</h3>

<p>Draw arrows between pairs of points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arrows(x0, y0, x1 = x0, y1 = y0, length = 0.25, angle = 30,
       code = 2, col = par("fg"), lty = par("lty"),
       lwd = par("lwd"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arrows_+3A_x0">x0</code>, <code id="arrows_+3A_y0">y0</code></td>
<td>
<p>coordinates of points <b>from</b> which to draw.</p>
</td></tr>
<tr><td><code id="arrows_+3A_x1">x1</code>, <code id="arrows_+3A_y1">y1</code></td>
<td>
<p>coordinates of points <b>to</b> which to draw.  At least
one must the supplied</p>
</td></tr>
<tr><td><code id="arrows_+3A_length">length</code></td>
<td>
<p>length of the edges of the arrow head (in inches).</p>
</td></tr>
<tr><td><code id="arrows_+3A_angle">angle</code></td>
<td>
<p>angle from the shaft of the arrow to the edge of the
arrow head.</p>
</td></tr>
<tr><td><code id="arrows_+3A_code">code</code></td>
<td>
<p>integer code, determining <em>kind</em> of arrows to be
drawn.</p>
</td></tr>
<tr><td><code id="arrows_+3A_col">col</code>, <code id="arrows_+3A_lty">lty</code>, <code id="arrows_+3A_lwd">lwd</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a>, possible vectors.
<code>NA</code> values in <code>col</code> cause the arrow to be omitted.</p>
</td></tr>
<tr><td><code id="arrows_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> such as <code>xpd</code> and the line
characteristics <code>lend</code>, <code>ljoin</code> and <code>lmitre</code>:
see <code><a href="#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each <code>i</code>, an arrow is drawn between the point <code>(x0[i],
    y0[i])</code> and the point <code>(x1[i], y1[i])</code>.  The coordinate vectors
will be recycled to the length of the longest.
</p>
<p>If <code>code = 1</code> an arrowhead is drawn at <code>(x0[i], y0[i])</code> and if
<code>code = 2</code> an arrowhead is drawn at <code>(x1[i], y1[i])</code>.  If
<code>code = 3</code> a head is drawn at both ends of the arrow.  Unless
<code>length = 0</code>, when no head is drawn.
</p>
<p>The <a href="#topic+graphical+20parameters">graphical parameters</a> <code>col</code>, <code>lty</code> and <code>lwd</code>
can be vectors of length greater than one and will be recycled if
necessary.
</p>
<p>The direction of a zero-length arrow is indeterminate, and hence so is
the direction of the arrowheads.  To allow for rounding error,
arrowheads are omitted (with a warning) on any arrow of length less
than 1/1000 inch.
</p>


<h3>Note</h3>

<p>The first four arguments in the comparable S function are named
<code>x1, y1, x2, y2</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+segments">segments</a></code> to draw segments.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- stats::runif(12); y &lt;- stats::rnorm(12)
i &lt;- order(x, y); x &lt;- x[i]; y &lt;- y[i]
plot(x,y, main = "arrows(.) and segments(.)")
## draw arrows from point to point :
s &lt;- seq(length(x)-1)  # one shorter than data
arrows(x[s], y[s], x[s+1], y[s+1], col = 1:3)
s &lt;- s[-length(s)]
segments(x[s], y[s], x[s+2], y[s+2], col = "pink")
</code></pre>

<hr>
<h2 id='assocplot'>Association Plots</h2><span id='topic+assocplot'></span>

<h3>Description</h3>

<p>Produce a Cohen-Friendly association plot indicating deviations from
independence of rows and columns in a 2-dimensional contingency
table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assocplot(x, col = c("black", "red"), space = 0.3,
          main = NULL, xlab = NULL, ylab = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assocplot_+3A_x">x</code></td>
<td>
<p>a two-dimensional contingency table in matrix form.</p>
</td></tr>
<tr><td><code id="assocplot_+3A_col">col</code></td>
<td>
<p>a character vector of length two giving the colors used for
drawing positive and negative Pearson residuals, respectively.</p>
</td></tr>
<tr><td><code id="assocplot_+3A_space">space</code></td>
<td>
<p>the amount of space (as a fraction of the average
rectangle width and height) left between each rectangle.</p>
</td></tr>
<tr><td><code id="assocplot_+3A_main">main</code></td>
<td>
<p>overall title for the plot.</p>
</td></tr>
<tr><td><code id="assocplot_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis.  Defaults to the name (if any) of
the row dimension in <code>x</code>.</p>
</td></tr>
<tr><td><code id="assocplot_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis.  Defaults to the name (if any) of
the column dimension in <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a two-way contingency table, the signed contribution to Pearson's
<code class="reqn">\chi^2</code> for cell <code class="reqn">i, j</code> is <code class="reqn">d_{ij} = (f_{ij} -
    e_{ij}) / \sqrt{e_{ij}}</code>,
where <code class="reqn">f_{ij}</code> and <code class="reqn">e_{ij}</code> are the observed and expected
counts corresponding to the cell.  In the Cohen-Friendly association
plot, each cell is represented by a rectangle that has (signed) height
proportional to <code class="reqn">d_{ij}</code> and width proportional to
<code class="reqn">\sqrt{e_{ij}}</code>, so that the area of the box is
proportional to the difference in observed and expected frequencies.
The rectangles in each row are positioned relative to a baseline
indicating independence (<code class="reqn">d_{ij} = 0</code>).  If the observed frequency
of a cell is greater than the expected one, the box rises above the
baseline and is shaded in the color specified by the first element of
<code>col</code>, which defaults to black; otherwise, the box falls below
the baseline and is shaded in the color specified by the second
element of <code>col</code>, which defaults to red.
</p>
<p>A more flexible and extensible implementation of association plots
written in the grid graphics system is provided in the function
<code><a href="vcd.html#topic+assoc">assoc</a></code> in the contributed package <a href="https://CRAN.R-project.org/package=vcd"><span class="pkg">vcd</span></a>
(Meyer, Zeileis and Hornik, 2006).
</p>


<h3>References</h3>

<p>Cohen, A. (1980),
On the graphical display of the significant components in a two-way
contingency table.
<em>Communications in Statistics&mdash;Theory and Methods</em>, <b>9</b>,
1025&ndash;1041.
<a href="https://doi.org/10.1080/03610928008827940">doi:10.1080/03610928008827940</a>.
</p>
<p>Friendly, M. (1992),
Graphical methods for categorical data.
<em>SAS User Group International Conference Proceedings</em>, <b>17</b>,
190&ndash;200.
<a href="http://datavis.ca/papers/sugi/sugi17.pdf">http://datavis.ca/papers/sugi/sugi17.pdf</a>
</p>
<p>Meyer, D., Zeileis, A., and Hornik, K. (2006)  
The strucplot Framework: Visualizing Multi-Way Contingency Tables with
<span class="pkg">vcd</span>.
<em>Journal of Statistical Software</em>, <b>17(3)</b>, 1&ndash;48.
<a href="https://doi.org/10.18637/jss.v017.i03">doi:10.18637/jss.v017.i03</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mosaicplot">mosaicplot</a></code>, <code><a href="stats.html#topic+chisq.test">chisq.test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Aggregate over sex:
x &lt;- marginSums(HairEyeColor, c(1, 2))
x
assocplot(x, main = "Relation between hair and eye color")
</code></pre>

<hr>
<h2 id='axis'>Add an Axis to a Plot</h2><span id='topic+axis'></span>

<h3>Description</h3>

<p>Adds an axis to the current plot, allowing the
specification of the side, position, labels, and other options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>axis(side, at = NULL, labels = TRUE, tick = TRUE, line = NA,
     pos = NA, outer = FALSE, font = NA, lty = "solid",
     lwd = 1, lwd.ticks = lwd, col = NULL, col.ticks = NULL,
     hadj = NA, padj = NA, gap.axis = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="axis_+3A_side">side</code></td>
<td>
<p>an integer specifying which side of the plot the axis is
to be drawn on.  The axis is placed as follows: 1=below,
2=left, 3=above and 4=right.</p>
</td></tr>
<tr><td><code id="axis_+3A_at">at</code></td>
<td>
<p>the points at which tick-marks are to be drawn.  Non-finite
(infinite, <code>NaN</code> or <code>NA</code>) values are omitted.  By default
(when <code>NULL</code>) tickmark locations are computed, see
&lsquo;Details&rsquo; below.</p>
</td></tr>
<tr><td><code id="axis_+3A_labels">labels</code></td>
<td>
<p>this can either be a logical value specifying whether
(numerical) annotations are to be made at the tickmarks, or a
character or expression vector of labels to be placed at the
tick points.  (Other objects are coerced by <code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>.)
If this is not logical, <code>at</code> should also be supplied and of the
same length.  If <code>labels</code> is of length zero after coercion,
it has the same effect as supplying <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="axis_+3A_tick">tick</code></td>
<td>
<p>a logical value specifying whether tickmarks and an axis line
should be drawn.</p>
</td></tr>
<tr><td><code id="axis_+3A_line">line</code></td>
<td>
<p>the number of lines into the margin at which the axis line
will be drawn, if not <code>NA</code>.</p>
</td></tr>
<tr><td><code id="axis_+3A_pos">pos</code></td>
<td>
<p>the coordinate at which the axis line is to be drawn:
if not <code>NA</code> this overrides the value of <code>line</code>.</p>
</td></tr>
<tr><td><code id="axis_+3A_outer">outer</code></td>
<td>
<p>a logical value indicating whether the axis should be
drawn in the outer plot margin, rather than the standard plot
margin.</p>
</td></tr>
<tr><td><code id="axis_+3A_font">font</code></td>
<td>
<p>font for text.  Defaults to <code>par("font")</code>.</p>
</td></tr>
<tr><td><code id="axis_+3A_lty">lty</code></td>
<td>
<p>line type for both the axis line and the tick marks.</p>
</td></tr>
<tr><td><code id="axis_+3A_lwd">lwd</code>, <code id="axis_+3A_lwd.ticks">lwd.ticks</code></td>
<td>
<p>line widths for the axis line and the tick
marks.  Zero or negative values will suppress the line or ticks.</p>
</td></tr>
<tr><td><code id="axis_+3A_col">col</code>, <code id="axis_+3A_col.ticks">col.ticks</code></td>
<td>
<p>colors for the axis line and the tick marks
respectively.  <code>col = NULL</code> means to use <code>par("fg")</code>,
possibly specified inline, and <code>col.ticks = NULL</code> means to use
whatever color <code>col</code> resolved to.</p>
</td></tr>
<tr><td><code id="axis_+3A_hadj">hadj</code></td>
<td>
<p>adjustment (see <code><a href="#topic+par">par</a>("adj")</code>) for all labels
<em>parallel</em> (&lsquo;horizontal&rsquo;) to the reading direction.  If
this is not a finite value, the default is used (centring for
strings parallel to the axis, justification of the end nearest the
axis otherwise).</p>
</td></tr>
<tr><td><code id="axis_+3A_padj">padj</code></td>
<td>
<p>adjustment for each tick label <em>perpendicular</em> to the
reading direction.  For labels parallel to the axes, <code>padj = 0</code>
means left or bottom alignment, and <code>padj = 1</code> means right or top
alignment (relative to the line).  This can be a vector given a value for each string, and
will be recycled as necessary.
</p>
<p>If <code>padj</code> is not a finite value (the default), the value of
<code>par("las")</code> determines the adjustment.  For strings plotted
perpendicular to the axis the default is to centre the string.</p>
</td></tr>
<tr><td><code id="axis_+3A_gap.axis">gap.axis</code></td>
<td>
<p>an optional (typically non-negative) numeric factor to
be multiplied with the size of an &lsquo;m&rsquo; to determine the
minimal gap between labels that are drawn, see &lsquo;Details&rsquo;.
The default, <code>NA</code>, corresponds to <code>1</code> for tick labels drawn
<em>parallel</em> to the axis and <code>0.25</code> otherwise, i.e., the
default is equivalent to </p>
<pre>  perpendicular &lt;- function(side, las) {
    is.x &lt;- (side %% 2 == 1) # is horizontal x-axis
    ( is.x &amp;&amp; (las %in% 2:3)) ||
    (!is.x &amp;&amp; (las %in% 1:2))
  }
  gap.axis &lt;- if(perpendicular(side, las)) 0.25 else 1</pre>
<p><code>gap.axis</code> may typically be relevant when <code>at = ..</code>
tick-mark positions are specified explicitly.
</p>
</td></tr>
<tr><td><code id="axis_+3A_...">...</code></td>
<td>
<p>other <a href="#topic+graphical+20parameters">graphical parameters</a> may also be passed as
arguments to this function, particularly, <code>cex.axis</code>, <code>col.axis</code>
and <code>font.axis</code> for axis annotation, i.e. tick labels, <code>mgp</code>
and <code>xaxp</code> or <code>yaxp</code> for positioning, <code>tck</code> or
<code>tcl</code> for tick mark length and direction, <code>las</code> for
vertical/horizontal label orientation, or <code>fg</code> instead of
<code>col</code>, and <code>xpd</code> for clipping.  See <code><a href="#topic+par">par</a></code> on these.
</p>
<p>Parameters <code>xaxt</code> (sides 1 and 3) and <code>yaxt</code> (sides 2 and
4) control if the axis is plotted at all.
</p>
<p>Note that <code>lab</code> will partial match to argument
<code>labels</code> unless the latter is also supplied.  (Since the
default axes have already been set up by <code><a href="#topic+plot.window">plot.window</a></code>,
<code>lab</code> will not be acted on by <code>axis</code>.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The axis line is drawn from the lowest to the highest value of
<code>at</code>, but will be clipped at the plot region.  By default, only
ticks which are drawn from points within the plot region (up to a
tolerance for rounding error) are plotted, but the ticks and their
labels may well extend outside the plot region.  Use <code>xpd = TRUE</code>
or <code>xpd = NA</code> to allow axes to extend further.
</p>
<p>When <code>at = NULL</code>, pretty tick mark locations are computed internally
(the same way <code><a href="#topic+axTicks">axTicks</a>(side)</code> would) from
<code><a href="#topic+par">par</a>("xaxp")</code> or <code>"yaxp"</code> and
<code><a href="#topic+par">par</a>("xlog")</code> (or <code>"ylog"</code>).  Note that these
locations may change if an on-screen plot is resized (for example, if
the <code>plot</code> argument <code>asp</code> (see <code><a href="#topic+plot.window">plot.window</a></code>) is set.)
</p>
<p>If <code>labels</code> is not specified, the numeric values supplied or
calculated for <code>at</code> are converted to character strings as if they
were a numeric vector printed by <code><a href="base.html#topic+print.default">print.default</a>(digits = 7)</code>.
</p>
<p>The code tries hard not to draw overlapping tick labels, and so will
omit labels where they would abut or overlap previously drawn labels.
This can result in, for example, every other tick being labelled.
The ticks are drawn left to right or bottom to top, and space at
least the size of an &lsquo;m&rsquo;, multiplied by <code>gap.axis</code>,
is left between labels.  In previous <span class="rlang"><b>R</b></span> versions, this applied only
for labels written <em>parallel</em> to the axis direction, hence not
for e.g., <code>las = 2</code>.  Using <code>gap.axis = -1</code> restores that
(buggy) previous behaviour (in the perpendicular case).
</p>
<p>If either <code>line</code> or <code>pos</code> is set, they (rather than
<code>par("mgp")[3]</code>) determine the position of the axis line and tick
marks, and the tick labels are placed <code>par("mgp")[2]</code> further
lines into (or towards for <code>pos</code>) the margin.
</p>
<p>Several of the graphics parameters affect the way axes are drawn. The
vertical (for sides 1 and 3) positions of the axis and the tick labels
are controlled by <code>mgp[2:3]</code> and <code>mex</code>, the size and
direction of the ticks is controlled by <code>tck</code> and <code>tcl</code> and
the appearance of the tick labels by <code>cex.axis</code>, <code>col.axis</code>
and <code>font.axis</code> with orientation controlled by <code>las</code> (but
not <code>srt</code>, unlike S which uses <code>srt</code> if <code>at</code> is
supplied and <code>las</code> if it is not).  Note that <code>adj</code> is not
supported and labels are always centered.  See <code><a href="#topic+par">par</a></code> for details.
</p>


<h3>Value</h3>

<p>The numeric locations on the axis scale at which tick marks were drawn
when the plot was first drawn (see &lsquo;Details&rsquo;).
</p>
<p>This function is usually invoked for its side effect, which is to add
an axis to an already existing plot.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Axis">Axis</a></code> for a generic interface.
</p>
<p><code><a href="#topic+axTicks">axTicks</a></code> returns the axis tick locations
corresponding to <code>at = NULL</code>; <code><a href="base.html#topic+pretty">pretty</a></code> is more flexible
for computing pretty tick coordinates and does <em>not</em> depend on
(nor adapt to) the coordinate system in use.
</p>
<p>Several graphics parameters affecting the appearance are documented
in <code><a href="#topic+par">par</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats) # for rnorm
plot(1:4, rnorm(4), axes = FALSE)
axis(1, 1:4, LETTERS[1:4])
axis(2)
box() #- to make it look "as usual"

plot(1:7, rnorm(7), main = "axis() examples",
     type = "s", xaxt = "n", frame.plot = FALSE, col = "red")
axis(1, 1:7, LETTERS[1:7], col.axis = "blue")
# unusual options:
axis(4, col = "violet", col.axis = "dark violet", lwd = 2)
axis(3, col = "gold", lty = 2, lwd = 0.5)

# one way to have a custom x axis
plot(1:10, xaxt = "n")
axis(1, xaxp = c(2, 9, 7))

## Changing default gap between labels:
plot(0:100, type="n", axes=FALSE, ann=FALSE)
title(quote("axis(1, .., gap.axis = f)," ~~ f &gt;= 0))
axis(2, at = 5*(0:20), las = 1, gap.axis = 1/4)
gaps &lt;- c(4, 2, 1, 1/2, 1/4, 0.1, 0)
chG &lt;- paste0(ifelse(gaps == 1, "default:  ", ""),
              "gap.axis=", formatC(gaps))
jj &lt;- seq_along(gaps)
linG &lt;- -2.5*(jj-1)
for(j in jj) {
    isD &lt;- gaps[j] == 1 # is default
    axis (1, at=5*(0:20), gap.axis = gaps[j], padj=-1, line = linG[j],
          col.axis = if(isD) "forest green" else 1, font.axis= 1+isD)
}
mtext(chG, side=1, padj=-1, line = linG -1/2, cex=3/4,
      col = ifelse(gaps == 1, "forest green", "blue3"))
## now shrink the window (in x- and y-direction) and observe the axis labels drawn
</code></pre>

<hr>
<h2 id='Axis'>Generic Function to Add an Axis to a Plot</h2><span id='topic+Axis'></span>

<h3>Description</h3>

<p>Generic function to add a suitable axis to the current plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Axis(x = NULL, at = NULL, ..., side, labels = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Axis_+3A_x">x</code></td>
<td>
<p>an object which indicates the range over which an axis should
be drawn</p>
</td></tr>
<tr><td><code id="Axis_+3A_at">at</code></td>
<td>
<p>the points at which tick-marks are to be drawn.</p>
</td></tr>
<tr><td><code id="Axis_+3A_side">side</code></td>
<td>
<p>an integer specifying which side of the plot the axis is
to be drawn on.  The axis is placed as follows: 1=below,
2=left, 3=above and 4=right.</p>
</td></tr>
<tr><td><code id="Axis_+3A_labels">labels</code></td>
<td>
<p>this can either be a logical value specifying whether
(numerical) annotations are to be made at the tickmarks, or a
character or expression vector of labels to be placed at the
tick points. If this is specified as a character or expression
vector, <code>at</code> should be supplied and they should be the same
length.</p>
</td></tr>
<tr><td><code id="Axis_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods and perhaps then to
<code><a href="#topic+axis">axis</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function.  It works in a slightly non-standard way:
if <code>x</code> is supplied and non-NULL it dispatches on <code>x</code>,
otherwise if <code>at</code> is supplied and non-NULL it dispatches on <code>at</code>,
and the default action is to call <code><a href="#topic+axis">axis</a></code>, omitting argument
<code>x</code>.
</p>
<p>The idea is that for plots for which either or both of the axes are
numerical but with a special interpretation, the standard plotting
functions (including <code><a href="#topic+boxplot">boxplot</a></code>, <code><a href="#topic+contour">contour</a></code>,
<code><a href="#topic+coplot">coplot</a></code>, <code><a href="#topic+filled.contour">filled.contour</a></code>,
<code><a href="#topic+pairs">pairs</a></code>, <code><a href="#topic+plot.default">plot.default</a></code>, <code><a href="#topic+rug">rug</a></code> and
<code><a href="#topic+stripchart">stripchart</a></code>) will set up user coordinates and <code>Axis</code>
will be called to label them appropriately.
</p>
<p>There are <code>"Date"</code> and <code>"POSIXt"</code> methods which can pass an
argument <code>format</code> on to the appropriate <code>axis</code> method (see
<code><a href="#topic+axis.POSIXct">axis.POSIXct</a></code>).
</p>


<h3>Value</h3>

<p>The numeric locations on the axis scale at which tick marks were drawn
when the plot was first drawn (see &lsquo;Details&rsquo;).
</p>
<p>This function is usually invoked for its side effect, which is to add
an axis to an already existing plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+axis">axis</a></code> (which is eventually called from all <code>Axis()</code>
methods) in package <span class="pkg">graphics</span>.
</p>

<hr>
<h2 id='axis.POSIXct'>Date and Date-time Plotting Functions</h2><span id='topic+axis.POSIXct'></span><span id='topic+axis.Date'></span>

<h3>Description</h3>

<p>Add a date/time axis to the current plot of an object of class
<code>"POSIXt"</code> or <code>"Date"</code>, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>axis.POSIXct(side, x, at, format, labels = TRUE, ...)
axis.Date(side, x, at, format, labels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="axis.POSIXct_+3A_side">side</code></td>
<td>
<p>see <code><a href="#topic+axis">axis</a></code>.</p>
</td></tr>
<tr><td><code id="axis.POSIXct_+3A_x">x</code>, <code id="axis.POSIXct_+3A_at">at</code></td>
<td>
<p>optional <a href="base.html#topic+date-time">date-time</a> or <a href="base.html#topic+Date">Date</a> objects,
or other types of objects that can be converted appropriately.</p>
</td></tr>
<tr><td><code id="axis.POSIXct_+3A_format">format</code></td>
<td>
<p>an optional character string specifying the label format,
see <code><a href="base.html#topic+strftime">strftime</a></code>.</p>
</td></tr>
<tr><td><code id="axis.POSIXct_+3A_labels">labels</code></td>
<td>
<p>either a logical value specifying whether
annotations are to be made at the tickmarks, or a character vector of
labels to be placed at the tick points specified by <code>at</code>.</p>
</td></tr>
<tr><td><code id="axis.POSIXct_+3A_...">...</code></td>
<td>
<p>further arguments to be passed from or to other methods,
typically <a href="#topic+graphical+20parameters">graphical parameters</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>at</code> is unspecified,
<code>axis.POSIXct</code> and <code>axis.Date</code> work quite hard 
(from <span class="rlang"><b>R</b></span> 4.3.0 via <code><a href="grDevices.html#topic+pretty.Date">pretty</a></code> for
<a href="base.html#topic+date-time">date-time</a> classes) to choose
suitable time units (years, months, days, hours, minutes, or seconds)
and a sensible label <code>format</code> based on the axis range.
<code><a href="#topic+par">par</a>("lab")</code> controls the approximate number of intervals.
</p>
<p>If <code>at</code> is supplied it specifies the locations of the ticks
and labels. If the label <code>format</code> is unspecified, a good guess
is made by looking at the granularity of <code>at</code>.
Printing of tick labels can be suppressed with
<code>labels = FALSE</code>.
</p>
<p>The date-times for a <code>"POSIXct"</code> input are interpreted in the
time zone give by the <code>"tzone"</code> attribute if there is one,
otherwise the current time zone.
</p>
<p>The way the date-times are rendered (especially month names) is
controlled by the locale setting of category <code>"LC_TIME"</code> (see
<code><a href="base.html#topic+Sys.setlocale">Sys.setlocale</a></code>).
</p>


<h3>Value</h3>

<p>The locations on the axis scale at which tick marks were drawn.
</p>


<h3>See Also</h3>

<p><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a>, <a href="base.html#topic+Dates">Dates</a> for details of the classes.
</p>
<p><code><a href="#topic+Axis">Axis</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>with(beaver1, {
    opar &lt;- par(mfrow = c(3,1))
    time &lt;- strptime(paste(1990, day, time %/% 100, time %% 100),
                     "%Y %j %H %M")
    plot(time, temp, type = "l") # axis at 6-hour intervals
    # request more ticks
    olab &lt;- par(lab = c(10, 10, 7))
    plot(time, temp, type = "l")
    par(olab)
    # now label every hour on the time axis
    plot(time, temp, type = "l", xaxt = "n")
    r &lt;- as.POSIXct(round(range(time), "hours"))
    axis.POSIXct(1, at = seq(r[1], r[2], by = "hour"), format = "%H")
    par(opar) # reset changed par settings
})

plot(.leap.seconds, seq_along(.leap.seconds), type = "n", yaxt = "n",
     xlab = "leap seconds", ylab = "", bty = "n")
rug(.leap.seconds)
## or as dates
lps &lt;- as.Date(.leap.seconds)
plot(lps, seq_along(.leap.seconds),
     type = "n", yaxt = "n", xlab = "leap seconds",
     ylab = "", bty = "n")
rug(lps)

## 100 random dates in a 10-week period
random.dates &lt;- as.Date("2001/1/1") + 70*sort(stats::runif(100))
plot(random.dates, 1:100)
# or for a better axis labelling
plot(random.dates, 1:100, xaxt = "n")
axis.Date(1, at = seq(as.Date("2001/1/1"), max(random.dates)+6, "weeks"))
axis.Date(1, at = seq(as.Date("2001/1/1"), max(random.dates)+6, "days"),
     labels = FALSE, tcl = -0.2)

## axis.Date() with various data types:
x &lt;- seq(as.Date("2022-01-20"), as.Date("2023-03-21"), by = "days")
plot(data.frame(x, y = 1), xaxt = "n")
legend("topleft", title = "input",
       legend = c("character", "Date", "POSIXct", "POSIXlt", "numeric"),
       fill = c("violet", "red", "orange", "coral1", "darkgreen"))
axis.Date(1)
axis.Date(3, at = "2022-04-01", col.axis = "violet")
axis.Date(3, at = as.Date("2022-07-01"), col.axis = "red")
axis.Date(3, at = as.POSIXct(as.Date("2022-10-01")), col.axis = "orange")
axis.Date(3, at = as.POSIXlt(as.Date("2023-01-01")), col.axis = "coral1")
axis.Date(3, at = as.integer(as.Date("2023-04-01")), col.axis = "darkgreen")
## automatically extends the format:
axis.Date(1, at = "2022-02-15", col.axis = "violet",
         col = "violet", tck = -0.05, mgp = c(3,2,0))

## axis.POSIXct() with various data types (2 minutes):
x &lt;- as.POSIXct("2022-10-01") + c(0, 60, 120)
attributes(x)   # no timezone
plot(data.frame(x, y = 1), xaxt = "n")
legend("topleft", title = "input",
       legend = c("character", "Date", "POSIXct", "POSIXlt", "numeric"),
       fill = c("violet", "red", "orange", "coral1", "darkgreen"))
axis.POSIXct(1)
axis.POSIXct(3, at = "2022-10-01 00:01", col.axis = "violet")
axis.POSIXct(3, at = as.Date("2022-10-01"), col.axis = "red")
axis.POSIXct(3, at = as.POSIXct("2022-10-01 00:01:30"), col.axis = "orange")
axis.POSIXct(3, at = as.POSIXlt("2022-10-01 00:02"), col.axis = "coral1")
axis.POSIXct(3, at = as.numeric(as.POSIXct("2022-10-01 00:00:30")),
                col.axis = "darkgreen")
## automatically extends format (here: subseconds):
axis.POSIXct(3, at = as.numeric(as.POSIXct("2022-10-01 00:00:30")) + 0.25,
                col.axis = "forestgreen", col = "darkgreen", mgp = c(3,2,0))

## axis.POSIXct: 2 time zones
HST &lt;- as.POSIXct("2022-10-01", tz = "HST") + c(0, 60, 60*60)
CET &lt;- HST
attr(CET, "tzone") &lt;- "CET"
plot(data.frame(HST, y = 1), xaxt = "n", xlab = "Hawaii Standard Time (HST)")
axis.POSIXct(1, HST)
axis.POSIXct(1, HST, at = "2022-10-01 00:10", col.axis = "violet")
axis.POSIXct(3, CET)
mtext(3, text = "Central European Time (CET)", line = 3)
axis.POSIXct(3, CET, at="2022-10-01 12:10", col.axis = "violet")
</code></pre>

<hr>
<h2 id='axTicks'>Compute Axis Tickmark Locations</h2><span id='topic+axTicks'></span>

<h3>Description</h3>

<p>Compute pretty tickmark locations, the same way as <span class="rlang"><b>R</b></span> does internally.
This is only non-trivial when <b>log</b> coordinates are active.
By default, gives the <code>at</code> values which
<code><a href="#topic+axis">axis</a>(side)</code> would use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>axTicks(side, axp = NULL, usr = NULL, log = NULL, nintLog = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="axTicks_+3A_side">side</code></td>
<td>
<p>integer in 1:4, as for <code><a href="#topic+axis">axis</a></code>.</p>
</td></tr>
<tr><td><code id="axTicks_+3A_axp">axp</code></td>
<td>
<p>numeric vector of length three, defaulting to
<code><a href="#topic+par">par</a>("xaxp")</code> or <code><a href="#topic+par">par</a>("yaxp")</code>
depending on the <code>side</code> argument (<code>par("xaxp")</code>
if <code>side</code> is 1 or 3, <code>par("yaxp")</code> if side is 2 or 4).</p>
</td></tr>
<tr><td><code id="axTicks_+3A_usr">usr</code></td>
<td>
<p>numeric vector of length two giving user coordinate
limits, defaulting to the relevant portion of
<code><a href="#topic+par">par</a>("usr")</code> (<code>par("usr")[1:2]</code> or
<code>par("usr")[3:4]</code> for <code>side</code> in (1,3) or (2,4)
respectively).</p>
</td></tr>
<tr><td><code id="axTicks_+3A_log">log</code></td>
<td>
<p>logical indicating if log coordinates are active; defaults
to <code><a href="#topic+par">par</a>("xlog")</code> or <code><a href="#topic+par">par</a>("ylog")</code>
depending on <code>side</code>.</p>
</td></tr>
<tr><td><code id="axTicks_+3A_nintlog">nintLog</code></td>
<td>
<p>(only used when <code>log</code> is true): approximate (lower
bound for the) number of tick intervals; defaults to
<code><a href="#topic+par">par</a>("lab")[j]</code> where <code>j</code> is 1 or 2 depending on
<code>side</code>.  Set this to <code>Inf</code> if you want the same behavior
as in earlier <span class="rlang"><b>R</b></span> versions (than 2.14.x).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>axp</code>, <code>usr</code>, and <code>log</code> arguments must be consistent
as their default values (the <code>par(..)</code> results) are.  If you
specify all three (as non-NULL), the graphics environment is not used
at all.  Note that the meaning of <code>axp</code> differs significantly
when <code>log</code> is <code>TRUE</code>; see the documentation on
<code><a href="#topic+par">par</a>(xaxp = .)</code>.
</p>
<p><code>axTicks()</code> may be seen as an <span class="rlang"><b>R</b></span> implementation of the C function
<code>CreateAtVector()</code> in &lsquo;<span class="file">..../src/main/plot.c</span>&rsquo;
which is called by <code><a href="#topic+axis">axis</a>(side, *)</code> when no argument
<code>at</code> is specified or directly by <code><a href="grDevices.html#topic+axisTicks">axisTicks</a>()</code> (in package
<span class="pkg">grDevices</span>).
<br />
The delicate case, <code>log = TRUE</code>, now makes use of
<code><a href="grDevices.html#topic+axisTicks">axisTicks</a></code> unless <code>nintLog = Inf</code> which exists for back
compatibility.
</p>


<h3>Value</h3>

<p>numeric vector of coordinate values at which axis tickmarks can be
drawn.  By default, when only the first argument is specified,
these values should be identical to those that
<code><a href="#topic+axis">axis</a>(side)</code> would use or has used.  Note that the values
are decreasing when <code>usr</code> is (&ldquo;reverse axis&rdquo; case).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+axis">axis</a></code>, <code><a href="#topic+par">par</a></code>.  <code><a href="base.html#topic+pretty">pretty</a></code>
uses the same algorithm (but independently of the graphics
environment) and has more options.  However it is not available for
<code>log = TRUE.</code>
</p>
<p><code><a href="grDevices.html#topic+axisTicks">axisTicks</a>()</code> (package <span class="pkg">grDevices</span>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'> plot(1:7, 10*21:27)
 axTicks(1)
 axTicks(2)
 stopifnot(identical(axTicks(1), axTicks(3)),
           identical(axTicks(2), axTicks(4)))

## Show how axTicks() and axis() correspond :
op &lt;- par(mfrow = c(3, 1))
for(x in 9999 * c(1, 2, 8)) {
    plot(x, 9, log = "x")
    cat(formatC(par("xaxp"), width = 5),";", T &lt;- axTicks(1),"\n")
    rug(T, col =  adjustcolor("red", 0.5), lwd = 4)
}
par(op)

x &lt;- 9.9*10^(-3:10)
plot(x, 1:14, log = "x")
axTicks(1) # now length 7
axTicks(1, nintLog = Inf) # rather too many

## An example using axTicks() without reference to an existing plot
## (copying R's internal procedures for setting axis ranges etc.),
## You do need to supply _all_ of axp, usr, log, nintLog
## standard logarithmic y axis labels
ylims &lt;- c(0.2, 88)
get_axp &lt;- function(x) 10^c(ceiling(x[1]), floor(x[2]))
## mimic par("yaxs") == "i"
usr.i &lt;- log10(ylims)
(aT.i &lt;- axTicks(side = 2, usr = usr.i,
                 axp = c(get_axp(usr.i), n = 3), log = TRUE, nintLog = 5))
## mimic (default) par("yaxs") == "r"
usr.r &lt;- extendrange(r = log10(ylims), f = 0.04)
(aT.r &lt;- axTicks(side = 2, usr = usr.r,
                 axp = c(get_axp(usr.r), 3), log = TRUE, nintLog = 5))

## Prove that we got it right :
plot(0:1, ylims, log = "y", yaxs = "i")
stopifnot(all.equal(aT.i, axTicks(side = 2)))

plot(0:1, ylims, log = "y", yaxs = "r")
stopifnot(all.equal(aT.r, axTicks(side = 2)))
</code></pre>

<hr>
<h2 id='barplot'>Bar Plots</h2><span id='topic+barplot'></span><span id='topic+barplot.default'></span><span id='topic+barplot.formula'></span>

<h3>Description</h3>

<p>Creates a bar plot with vertical or horizontal bars.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>barplot(height, ...)

## Default S3 method:
barplot(height, width = 1, space = NULL,
        names.arg = NULL, legend.text = NULL, beside = FALSE,
        horiz = FALSE, density = NULL, angle = 45,
        col = NULL, border = par("fg"),
        main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
        xlim = NULL, ylim = NULL, xpd = TRUE, log = "",
        axes = TRUE, axisnames = TRUE,
        cex.axis = par("cex.axis"), cex.names = par("cex.axis"),
        inside = TRUE, plot = TRUE, axis.lty = 0, offset = 0,
        add = FALSE, ann = !add &amp;&amp; par("ann"), args.legend = NULL, ...)

## S3 method for class 'formula'
barplot(formula, data, subset, na.action,
        horiz = FALSE, xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="barplot_+3A_height">height</code></td>
<td>
<p>either a vector or matrix of values describing the
bars which make up the plot.  If <code>height</code> is a vector, the
plot consists of a sequence of rectangular bars with heights
given by the values in the vector.  If <code>height</code> is a matrix
and <code>beside</code> is <code>FALSE</code> then each bar of the plot
corresponds to a column of <code>height</code>, with the values in the
column giving the heights of stacked sub-bars making up the
bar.  If <code>height</code> is a matrix and <code>beside</code> is
<code>TRUE</code>, then the values in each column are juxtaposed
rather than stacked.</p>
</td></tr>
<tr><td><code id="barplot_+3A_width">width</code></td>
<td>
<p>optional vector of bar widths. Re-cycled to length the
number of bars drawn.  Specifying a single value will have no
visible effect unless <code>xlim</code> is specified.</p>
</td></tr>
<tr><td><code id="barplot_+3A_space">space</code></td>
<td>
<p>the amount of space (as a fraction of the average bar
width) left before each bar.  May be given as a single number or
one number per bar.  If <code>height</code> is a matrix and
<code>beside</code> is <code>TRUE</code>, <code>space</code> may be specified by
two numbers, where the first is the space between bars in the
same group, and the second the space between the groups.  If not
given explicitly, it defaults to <code>c(0,1)</code> if <code>height</code>
is a matrix and <code>beside</code> is <code>TRUE</code>, and to 0.2
otherwise.</p>
</td></tr>
<tr><td><code id="barplot_+3A_names.arg">names.arg</code></td>
<td>
<p>a vector of names to be plotted below each bar or
group of bars.  If this argument is omitted, then the names are
taken from the <code>names</code> attribute of <code>height</code> if this
is a vector, or the column names if it is a matrix.</p>
</td></tr>
<tr><td><code id="barplot_+3A_legend.text">legend.text</code></td>
<td>
<p>a vector of text used to construct a legend for
the plot, or a logical indicating whether a legend should be
included.  This is only useful when <code>height</code> is a matrix.
In that case given legend labels should correspond to the rows of
<code>height</code>; if <code>legend.text</code> is true, the row names of
<code>height</code> will be used as labels if they are non-null.</p>
</td></tr>
<tr><td><code id="barplot_+3A_beside">beside</code></td>
<td>
<p>a logical value.  If <code>FALSE</code>, the columns of
<code>height</code> are portrayed as stacked bars, and if <code>TRUE</code>
the columns are portrayed as juxtaposed bars.</p>
</td></tr>
<tr><td><code id="barplot_+3A_horiz">horiz</code></td>
<td>
<p>a logical value.  If <code>FALSE</code>, the bars are drawn
vertically with the first bar to the left.  If <code>TRUE</code>, the
bars are drawn horizontally with the first at the bottom.</p>
</td></tr>
<tr><td><code id="barplot_+3A_density">density</code></td>
<td>
<p>a vector giving the density of shading lines, in
lines per inch, for the bars or bar components.
The default value of <code>NULL</code> means that no shading lines
are drawn. Non-positive values of <code>density</code> also inhibit the
drawing of shading lines.</p>
</td></tr>
<tr><td><code id="barplot_+3A_angle">angle</code></td>
<td>
<p>the slope of shading lines, given as an angle in
degrees (counter-clockwise), for the bars or bar components.</p>
</td></tr>
<tr><td><code id="barplot_+3A_col">col</code></td>
<td>
<p>a vector of colors for the bars or bar components.
By default, <code>"grey"</code> is used if <code>height</code> is a vector, and a
gamma-corrected grey palette if <code>height</code> is a matrix;
see <code><a href="grDevices.html#topic+grey.colors">grey.colors</a></code>.</p>
</td></tr>
<tr><td><code id="barplot_+3A_border">border</code></td>
<td>
<p>the color to be used for the border of the bars.
Use <code>border = NA</code> to omit borders.  If there are shading
lines, <code>border = TRUE</code> means use the same colour for
the border as for the shading lines.</p>
</td></tr>
<tr><td><code id="barplot_+3A_main">main</code>, <code id="barplot_+3A_sub">sub</code></td>
<td>
<p>main title and subtitle for the plot.</p>
</td></tr>
<tr><td><code id="barplot_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis.</p>
</td></tr>
<tr><td><code id="barplot_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis.</p>
</td></tr>
<tr><td><code id="barplot_+3A_xlim">xlim</code></td>
<td>
<p>limits for the x axis.</p>
</td></tr>
<tr><td><code id="barplot_+3A_ylim">ylim</code></td>
<td>
<p>limits for the y axis.</p>
</td></tr>
<tr><td><code id="barplot_+3A_xpd">xpd</code></td>
<td>
<p>logical. Should bars be allowed to go outside region?</p>
</td></tr>
<tr><td><code id="barplot_+3A_log">log</code></td>
<td>
<p>string specifying if axis scales should be logarithmic; see
<code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="barplot_+3A_axes">axes</code></td>
<td>
<p>logical.  If <code>TRUE</code>, a vertical (or horizontal, if
<code>horiz</code> is true) axis is drawn.</p>
</td></tr>
<tr><td><code id="barplot_+3A_axisnames">axisnames</code></td>
<td>
<p>logical.  If <code>TRUE</code>, and if there are
<code>names.arg</code> (see above), the
other axis is drawn (with <code>lty = 0</code>) and labeled.</p>
</td></tr>
<tr><td><code id="barplot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>expansion factor for numeric axis labels (see
<code><a href="#topic+par">par</a>('cex')</code>).</p>
</td></tr>
<tr><td><code id="barplot_+3A_cex.names">cex.names</code></td>
<td>
<p>expansion factor for axis names (bar labels).</p>
</td></tr>
<tr><td><code id="barplot_+3A_inside">inside</code></td>
<td>
<p>logical.  If <code>TRUE</code>, the lines which divide
adjacent (non-stacked!) bars will be drawn.  Only applies when
<code>space = 0</code> (which it partly is when <code>beside = TRUE</code>).</p>
</td></tr>
<tr><td><code id="barplot_+3A_plot">plot</code></td>
<td>
<p>logical.  If <code>FALSE</code>, nothing is plotted.</p>
</td></tr>
<tr><td><code id="barplot_+3A_axis.lty">axis.lty</code></td>
<td>
<p>the graphics parameter <code>lty</code> (see
<code><a href="#topic+par">par</a>('lty')</code>) applied to the axis
and tick marks of the categorical (default horizontal) axis.  Note
that by default the axis is suppressed.</p>
</td></tr>
<tr><td><code id="barplot_+3A_offset">offset</code></td>
<td>
<p>a vector indicating how much the bars should be shifted
relative to the x axis.</p>
</td></tr>
<tr><td><code id="barplot_+3A_add">add</code></td>
<td>
<p>logical specifying if bars should be added to an already
existing plot; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="barplot_+3A_ann">ann</code></td>
<td>
<p>logical specifying if the default annotation (<code>main</code>,
<code>sub</code>, <code>xlab</code>, <code>ylab</code>) should appear on the plot, see
<code><a href="#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="barplot_+3A_args.legend">args.legend</code></td>
<td>
<p>list of additional arguments to pass to
<code><a href="#topic+legend">legend</a>()</code>; names of the list are used as argument
names.  Only used if <code>legend.text</code> is supplied.</p>
</td></tr>
<tr><td><code id="barplot_+3A_formula">formula</code></td>
<td>
<p>a formula where the <code>y</code> variables are numeric data
to plot against the categorical <code>x</code> variables.  The formula
can have one of three forms:
</p>
<pre>
      y ~ x
      y ~ x1 + x2
      cbind(y1, y2) ~ x
    </pre>
<p>(see the examples).</p>
</td></tr>
<tr><td><code id="barplot_+3A_data">data</code></td>
<td>
<p>a data frame (or list) from which the variables in formula
should be taken.</p>
</td></tr>
<tr><td><code id="barplot_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used.</p>
</td></tr>
<tr><td><code id="barplot_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when
the data contain <code><a href="base.html#topic+NA">NA</a></code> values.  The default is to ignore missing
values in the given variables.</p>
</td></tr>
<tr><td><code id="barplot_+3A_...">...</code></td>
<td>
<p>arguments to be passed to/from other methods.  For the
default method these can include further arguments (such as
<code>axes</code>, <code>asp</code> and <code>main</code>) and
<a href="#topic+graphical+20parameters">graphical parameters</a> (see <code><a href="#topic+par">par</a></code>) which are passed to
<code><a href="#topic+plot.window">plot.window</a>()</code>, <code><a href="#topic+title">title</a>()</code> and
<code><a href="#topic+axis">axis</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector (or matrix, when <code>beside = TRUE</code>), say
<code>mp</code>, giving the coordinates of <em>all</em> the bar midpoints
drawn, useful for adding to the graph.
</p>
<p>If <code>beside</code> is true, use <code>colMeans(mp)</code> for the
midpoints of each <em>group</em> of bars, see example.
</p>


<h3>Author(s)</h3>

<p>R Core, with a contribution by Arni Magnusson.</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a>(..., type = "h")</code>, <code><a href="#topic+dotchart">dotchart</a></code>;
<code><a href="#topic+hist">hist</a></code> for bars of a <em>continuous</em> variable.
<code><a href="#topic+mosaicplot">mosaicplot</a>()</code>, more sophisticated to visualize
<em>several</em> categorical variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Formula method
barplot(GNP ~ Year, data = longley)
barplot(cbind(Employed, Unemployed) ~ Year, data = longley)

## 3rd form of formula - 2 categories :
op &lt;- par(mfrow = 2:1, mgp = c(3,1,0)/2, mar = .1+c(3,3:1))
summary(d.Titanic &lt;- as.data.frame(Titanic))
barplot(Freq ~ Class + Survived, data = d.Titanic,
        subset = Age == "Adult" &amp; Sex == "Male",
        main = "barplot(Freq ~ Class + Survived, *)", ylab = "# {passengers}", legend.text = TRUE)
# Corresponding table :
(xt &lt;- xtabs(Freq ~ Survived + Class + Sex, d.Titanic, subset = Age=="Adult"))
# Alternatively, a mosaic plot :
mosaicplot(xt[,,"Male"], main = "mosaicplot(Freq ~ Class + Survived, *)", color=TRUE)
par(op)


# Default method
require(grDevices) # for colours
tN &lt;- table(Ni &lt;- stats::rpois(100, lambda = 5))
r &lt;- barplot(tN, col = rainbow(20))
#- type = "h" plotting *is* 'bar'plot
lines(r, tN, type = "h", col = "red", lwd = 2)

barplot(tN, space = 1.5, axisnames = FALSE,
        sub = "barplot(..., space= 1.5, axisnames = FALSE)")

barplot(VADeaths, plot = FALSE)
barplot(VADeaths, plot = FALSE, beside = TRUE)

mp &lt;- barplot(VADeaths) # default
tot &lt;- colMeans(VADeaths)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
barplot(VADeaths, beside = TRUE,
        col = c("lightblue", "mistyrose", "lightcyan",
                "lavender", "cornsilk"),
        legend.text = rownames(VADeaths), ylim = c(0, 100))
title(main = "Death Rates in Virginia", font.main = 4)

hh &lt;- t(VADeaths)[, 5:1]
mybarcol &lt;- "gray20"
mp &lt;- barplot(hh, beside = TRUE,
        col = c("lightblue", "mistyrose",
                "lightcyan", "lavender"),
        legend.text = colnames(VADeaths), ylim = c(0,100),
        main = "Death Rates in Virginia", font.main = 4,
        sub = "Faked upper 2*sigma error bars", col.sub = mybarcol,
        cex.names = 1.5)
segments(mp, hh, mp, hh + 2*sqrt(1000*hh/100), col = mybarcol, lwd = 1.5)
stopifnot(dim(mp) == dim(hh))  # corresponding matrices
mtext(side = 1, at = colMeans(mp), line = -2,
      text = paste("Mean", formatC(colMeans(hh))), col = "red")

# Bar shading example
barplot(VADeaths, angle = 15+10*1:5, density = 20, col = "black",
        legend.text = rownames(VADeaths))
title(main = list("Death Rates in Virginia", font = 4))

# Border color
barplot(VADeaths, border = "dark blue") 

# Log scales (not much sense here)
barplot(tN, col = heat.colors(12), log = "y")
barplot(tN, col = gray.colors(20), log = "xy")

# Legend location
barplot(height = cbind(x = c(465, 91) / 465 * 100,
                       y = c(840, 200) / 840 * 100,
                       z = c(37, 17) / 37 * 100),
        beside = FALSE,
        width = c(465, 840, 37),
        col = c(1, 2),
        legend.text = c("A", "B"),
        args.legend = list(x = "topleft"))
</code></pre>

<hr>
<h2 id='box'>Draw a Box around a Plot</h2><span id='topic+box'></span>

<h3>Description</h3>

<p>This function draws a box around the current plot in the given color
and line type.  The <code>bty</code> parameter determines
the type of box drawn.  See <code><a href="#topic+par">par</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>box(which = "plot", lty = "solid", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="box_+3A_which">which</code></td>
<td>
<p>character, one of <code>"plot"</code>, <code>"figure"</code>,
<code>"inner"</code> and <code>"outer"</code>.</p>
</td></tr>
<tr><td><code id="box_+3A_lty">lty</code></td>
<td>
<p>line type of the box.</p>
</td></tr>
<tr><td><code id="box_+3A_...">...</code></td>
<td>
<p>further <a href="#topic+graphical+20parameters">graphical parameters</a>, such as <code>bty</code>,
<code>col</code>, or <code>lwd</code>, see <code><a href="#topic+par">par</a></code>.  Note that
<code>xpd</code> is not accepted as clipping is always to the device
region.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The choice of colour is complicated.  If <code>col</code> was supplied
and is not <code>NA</code>, it is used.  Otherwise, if <code>fg</code> was supplied
and is not <code>NA</code>, it is used.  The final default is <code>par("col")</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rect">rect</a></code> for drawing of arbitrary rectangles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1:7, abs(stats::rnorm(7)), type = "h", axes = FALSE)
axis(1, at = 1:7, labels = letters[1:7])
box(lty = '1373', col = 'red')
</code></pre>

<hr>
<h2 id='boxplot'>Box Plots</h2><span id='topic+boxplot'></span><span id='topic+boxplot.default'></span><span id='topic+boxplot.formula'></span>

<h3>Description</h3>

<p>Produce box-and-whisker plot(s) of the given (grouped) values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxplot(x, ...)

## S3 method for class 'formula'
boxplot(formula, data = NULL, ..., subset, na.action = NULL,
        xlab = mklab(y_var = horizontal),
        ylab = mklab(y_var =!horizontal),
        add = FALSE, ann = !add, horizontal = FALSE,
        drop = FALSE, sep = ".", lex.order = FALSE)

## Default S3 method:
boxplot(x, ..., range = 1.5, width = NULL, varwidth = FALSE,
        notch = FALSE, outline = TRUE, names, plot = TRUE,
        border = par("fg"), col = "lightgray", log = "",
        pars = list(boxwex = 0.8, staplewex = 0.5, outwex = 0.5),
         ann = !add, horizontal = FALSE, add = FALSE, at = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxplot_+3A_formula">formula</code></td>
<td>
<p>a formula, such as <code>y ~ grp</code>, where <code>y</code> is a
numeric vector of data values to be split into groups according to
the grouping variable <code>grp</code> (usually a factor).  Note that
<code>~ g1 + g2</code> is equivalent to <code>g1:g2</code>.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_data">data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>formula</code> should be taken.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is to ignore missing
values in either the response or the group.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_xlab">xlab</code>, <code id="boxplot_+3A_ylab">ylab</code></td>
<td>
<p>x- and y-axis annotation, since <span class="rlang"><b>R</b></span> 3.6.0 with a
non-empty default.  Can be suppressed by <code>ann=FALSE</code>.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_ann">ann</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code> indicating if axes should be annotated (by
<code>xlab</code> and <code>ylab</code>).</p>
</td></tr>
<tr><td><code id="boxplot_+3A_drop">drop</code>, <code id="boxplot_+3A_sep">sep</code>, <code id="boxplot_+3A_lex.order">lex.order</code></td>
<td>
<p>passed to <code><a href="base.html#topic+split.default">split.default</a></code>, see there.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_x">x</code></td>
<td>
<p>for specifying data from which the boxplots are to be
produced. Either a numeric vector, or a single list containing such
vectors. Additional unnamed arguments specify further data
as separate vectors (each corresponding to a component boxplot).
<code><a href="base.html#topic+NA">NA</a></code>s are allowed in the data.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_...">...</code></td>
<td>
<p>For the <code>formula</code> method, named arguments to be passed to
the default method.
</p>
<p>For the default method, unnamed arguments are additional data
vectors (unless <code>x</code> is a list when they are ignored), and named
arguments are arguments and <a href="#topic+graphical+20parameters">graphical parameters</a> to be passed
to <code><a href="#topic+bxp">bxp</a></code> in addition to the ones given by argument
<code>pars</code> (and override those in <code>pars</code>). Note that
<code>bxp</code> may or may not make use of graphical parameters it is
passed: see its documentation.
</p>
</td></tr>
<tr><td><code id="boxplot_+3A_range">range</code></td>
<td>
<p>this determines how far the plot whiskers extend out
from the box.  If <code>range</code> is positive, the whiskers extend
to the most extreme data point which is no more than
<code>range</code> times the interquartile range from the box. A value
of zero causes the whiskers to extend to the data extremes.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_width">width</code></td>
<td>
<p>a vector giving the relative widths of the boxes making
up the plot.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_varwidth">varwidth</code></td>
<td>
<p>if <code>varwidth</code> is <code>TRUE</code>, the boxes are
drawn with widths proportional to the square-roots of the number
of observations in the groups.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_notch">notch</code></td>
<td>
<p>if <code>notch</code> is <code>TRUE</code>, a notch is drawn in
each side of the boxes.  If the notches of two plots do not
overlap this is &lsquo;strong evidence&rsquo; that the two medians differ
(Chambers <abbr>et al.</abbr>, 1983, p. 62).  See <code><a href="grDevices.html#topic+boxplot.stats">boxplot.stats</a></code>
for the calculations used.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_outline">outline</code></td>
<td>
<p>if <code>outline</code> is not true, the outliers are
not drawn (as points whereas S+ uses lines).</p>
</td></tr>
<tr><td><code id="boxplot_+3A_names">names</code></td>
<td>
<p>group labels which will be printed under each boxplot.
Can be a character vector or an <a href="base.html#topic+expression">expression</a> (see
<a href="grDevices.html#topic+plotmath">plotmath</a>).</p>
</td></tr>
<tr><td><code id="boxplot_+3A_boxwex">boxwex</code></td>
<td>
<p>a scale factor to be applied to all boxes.  When there
are only a few groups, the appearance of the plot can be improved
by making the boxes narrower.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_staplewex">staplewex</code></td>
<td>
<p>staple line width expansion, proportional to box
width.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_outwex">outwex</code></td>
<td>
<p>outlier line width expansion, proportional to box
width.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_plot">plot</code></td>
<td>
<p>if <code>TRUE</code> (the default) then a boxplot is
produced.  If not, the summaries which the boxplots are based on
are returned.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_border">border</code></td>
<td>
<p>an optional vector of colors for the outlines of the
boxplots.  The values in <code>border</code> are recycled if the
length of <code>border</code> is less than the number of plots.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_col">col</code></td>
<td>
<p>if <code>col</code> is non-null it is assumed to contain colors
to be used to colour the bodies of the box plots. By default they
are in the background colour.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_log">log</code></td>
<td>
<p>character indicating if x or y or both coordinates should
be plotted in log scale.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_pars">pars</code></td>
<td>
<p>a list of (potentially many) more graphical parameters,
e.g., <code>boxwex</code> or <code>outpch</code>; these are passed to
<code><a href="#topic+bxp">bxp</a></code> (if <code>plot</code> is true); for details, see there.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_horizontal">horizontal</code></td>
<td>
<p>logical indicating if the boxplots should be
horizontal; default <code>FALSE</code> means vertical boxes.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_add">add</code></td>
<td>
<p>logical, if true <em>add</em> boxplot to current plot.</p>
</td></tr>
<tr><td><code id="boxplot_+3A_at">at</code></td>
<td>
<p>numeric vector giving the locations where the boxplots should
be drawn, particularly when <code>add = TRUE</code>;
defaults to <code>1:n</code> where <code>n</code> is the number of boxes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic function <code>boxplot</code> currently has a default method
(<code>boxplot.default</code>) and a formula interface (<code>boxplot.formula</code>).
</p>
<p>If multiple groups are supplied either as multiple arguments or via a
formula, parallel boxplots will be plotted, in the order of the
arguments or the order of the levels of the factor (see
<code><a href="base.html#topic+factor">factor</a></code>).
</p>
<p>Missing values are ignored when forming boxplots.
</p>


<h3>Value</h3>

<p>List with the following components:
</p>
<table>
<tr><td><code>stats</code></td>
<td>
<p>a matrix, each column contains the extreme of the lower
whisker, the lower hinge, the median, the upper hinge and the
extreme of the upper whisker for one group/plot.  If all the inputs
have the same class attribute, so will this component.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>a vector with the number of (non-<code><a href="base.html#topic+NA">NA</a></code>) observations in each group.</p>
</td></tr>
<tr><td><code>conf</code></td>
<td>
<p>a matrix where each column contains the lower and upper
extremes of the notch.</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>the values of any data points which lie beyond the
extremes of the whiskers.</p>
</td></tr>
<tr><td><code>group</code></td>
<td>
<p>a vector of the same length as <code>out</code> whose elements
indicate to which group the outlier belongs.</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>a vector of names for the groups.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988).
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983).
<em>Graphical Methods for Data Analysis</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005).
<em>R Graphics</em>.
Chapman &amp; Hall/CRC Press.
</p>
<p>See also <code><a href="grDevices.html#topic+boxplot.stats">boxplot.stats</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+boxplot.stats">boxplot.stats</a></code> which does the computation,
<code><a href="#topic+bxp">bxp</a></code> for the plotting and more examples;
and <code><a href="#topic+stripchart">stripchart</a></code> for an alternative (with small data
sets).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## boxplot on a formula:
boxplot(count ~ spray, data = InsectSprays, col = "lightgray")
# *add* notches (somewhat funny here &lt;--&gt; warning "notches .. outside hinges"):
boxplot(count ~ spray, data = InsectSprays,
        notch = TRUE, add = TRUE, col = "blue")

boxplot(decrease ~ treatment, data = OrchardSprays, col = "bisque",
        log = "y")
## horizontal=TRUE, switching  y &lt;--&gt; x :
boxplot(decrease ~ treatment, data = OrchardSprays, col = "bisque",
        log = "x", horizontal=TRUE)

rb &lt;- boxplot(decrease ~ treatment, data = OrchardSprays, col = "bisque")
title("Comparing boxplot()s and non-robust mean +/- SD")
mn.t &lt;- tapply(OrchardSprays$decrease, OrchardSprays$treatment, mean)
sd.t &lt;- tapply(OrchardSprays$decrease, OrchardSprays$treatment, sd)
xi &lt;- 0.3 + seq(rb$n)
points(xi, mn.t, col = "orange", pch = 18)
arrows(xi, mn.t - sd.t, xi, mn.t + sd.t,
       code = 3, col = "pink", angle = 75, length = .1)

## boxplot on a matrix:
mat &lt;- cbind(Uni05 = (1:100)/21, Norm = rnorm(100),
             `5T` = rt(100, df = 5), Gam2 = rgamma(100, shape = 2))
boxplot(mat) # directly, calling boxplot.matrix()

## boxplot on a data frame:
df. &lt;- as.data.frame(mat)
par(las = 1) # all axis labels horizontal
boxplot(df., main = "boxplot(*, horizontal = TRUE)", horizontal = TRUE)

## Using 'at = ' and adding boxplots -- example idea by Roger Bivand :
boxplot(len ~ dose, data = ToothGrowth,
        boxwex = 0.25, at = 1:3 - 0.2,
        subset = supp == "VC", col = "yellow",
        main = "Guinea Pigs' Tooth Growth",
        xlab = "Vitamin C dose mg",
        ylab = "tooth length",
        xlim = c(0.5, 3.5), ylim = c(0, 35), yaxs = "i")
boxplot(len ~ dose, data = ToothGrowth, add = TRUE,
        boxwex = 0.25, at = 1:3 + 0.2,
        subset = supp == "OJ", col = "orange")
legend(2, 9, c("Ascorbic acid", "Orange juice"),
       fill = c("yellow", "orange"))

## With less effort (slightly different) using factor *interaction*:
boxplot(len ~ dose:supp, data = ToothGrowth,
        boxwex = 0.5, col = c("orange", "yellow"),
        main = "Guinea Pigs' Tooth Growth",
        xlab = "Vitamin C dose mg", ylab = "tooth length",
        sep = ":", lex.order = TRUE, ylim = c(0, 35), yaxs = "i")

## more examples in  help(bxp)
</code></pre>

<hr>
<h2 id='boxplot.matrix'>Draw a Boxplot for each Column (Row) of a Matrix</h2><span id='topic+boxplot.matrix'></span>

<h3>Description</h3>

<p>Interpreting the columns (or rows) of a matrix as different groups, draw a
boxplot for each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'matrix'
boxplot(x, use.cols = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxplot.matrix_+3A_x">x</code></td>
<td>
<p>a numeric matrix.</p>
</td></tr>
<tr><td><code id="boxplot.matrix_+3A_use.cols">use.cols</code></td>
<td>
<p>logical indicating if columns (by default) or rows
(<code>use.cols = FALSE</code>) should be plotted.</p>
</td></tr>
<tr><td><code id="boxplot.matrix_+3A_...">...</code></td>
<td>
<p>Further arguments to <code><a href="#topic+boxplot">boxplot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list as for <code><a href="#topic+boxplot">boxplot</a></code>.
</p>


<h3>Author(s)</h3>

<p>Martin Maechler, 1995, for S+, then <span class="rlang"><b>R</b></span> package <a href="https://CRAN.R-project.org/package=sfsmisc"><span class="pkg">sfsmisc</span></a>.</p>


<h3>See Also</h3>

<p><code><a href="#topic+boxplot.default">boxplot.default</a></code> which already works nowadays with
data.frames; <code><a href="#topic+boxplot.formula">boxplot.formula</a></code>, <code><a href="#topic+plot.factor">plot.factor</a></code> which
work with (the more general concept) of a grouping factor.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Very similar to the example in ?boxplot
mat &lt;- cbind(Uni05 = (1:100)/21, Norm = rnorm(100),
             T5 = rt(100, df = 5), Gam2 = rgamma(100, shape = 2))
boxplot(mat, main = "boxplot.matrix(...., main = ...)",
        notch = TRUE, col = 1:4)
</code></pre>

<hr>
<h2 id='bxp'>Draw Box Plots from Summaries</h2><span id='topic+bxp'></span>

<h3>Description</h3>

<p><code>bxp</code> draws box plots based on the given summaries in <code>z</code>.
It is usually called from within <code><a href="#topic+boxplot">boxplot</a></code>, but can be
invoked directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bxp(z, notch = FALSE, width = NULL, varwidth = FALSE,
    outline = TRUE, notch.frac = 0.5, log = "",
    border = par("fg"), pars = NULL, frame.plot = axes,
    horizontal = FALSE, ann = TRUE,
    add = FALSE, at = NULL, show.names = NULL,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bxp_+3A_z">z</code></td>
<td>
<p>a list containing data summaries to be used in constructing
the plots.  These are usually the result of a call to
<code><a href="#topic+boxplot">boxplot</a></code>, but can be generated in any fashion.</p>
</td></tr>
<tr><td><code id="bxp_+3A_notch">notch</code></td>
<td>
<p>if <code>notch</code> is <code>TRUE</code>, a notch is drawn in each
side of the boxes.  If the notches of two plots do not overlap then
the medians are significantly different at the 5 percent level.</p>
</td></tr>
<tr><td><code id="bxp_+3A_width">width</code></td>
<td>
<p>a vector giving the relative widths of the boxes making
up the plot.</p>
</td></tr>
<tr><td><code id="bxp_+3A_varwidth">varwidth</code></td>
<td>
<p>if <code>varwidth</code> is <code>TRUE</code>, the boxes are drawn
with widths proportional to the square-roots of the number of
observations in the groups.</p>
</td></tr>
<tr><td><code id="bxp_+3A_outline">outline</code></td>
<td>
<p>if <code>outline</code> is not true, the outliers are not
drawn.</p>
</td></tr>
<tr><td><code id="bxp_+3A_notch.frac">notch.frac</code></td>
<td>
<p>numeric in (0,1). When <code>notch = TRUE</code>, the
fraction of the box width that the notches should use.</p>
</td></tr>
<tr><td><code id="bxp_+3A_border">border</code></td>
<td>
<p>character or numeric (vector), the color of the box
borders.  Is recycled for multiple boxes.  Is used as default for
the <code>boxcol</code>, <code>medcol</code>, <code>whiskcol</code>, <code>staplecol</code>,
and <code>outcol</code> options (see below).
</p>
</td></tr>
<tr><td><code id="bxp_+3A_log">log</code></td>
<td>
<p>character, indicating if any axis should be drawn in
logarithmic scale, as in <code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="bxp_+3A_frame.plot">frame.plot</code></td>
<td>
<p>logical, indicating if a &lsquo;frame&rsquo;
(<code><a href="#topic+box">box</a></code>) should be drawn; defaults to <code>TRUE</code>, unless
<code>axes = FALSE</code> is specified.</p>
</td></tr>
<tr><td><code id="bxp_+3A_horizontal">horizontal</code></td>
<td>
<p>logical indicating if the  boxplots should be
horizontal; default <code>FALSE</code> means vertical boxes.</p>
</td></tr>
<tr><td><code id="bxp_+3A_ann">ann</code></td>
<td>
<p>a logical value indicating whether the default annotation
(title and x and y axis labels) should appear on the plot.</p>
</td></tr>
<tr><td><code id="bxp_+3A_add">add</code></td>
<td>
<p>logical, if true <em>add</em> boxplot to current plot.</p>
</td></tr>
<tr><td><code id="bxp_+3A_at">at</code></td>
<td>
<p>numeric vector giving the locations where the boxplots
should be drawn, particularly when <code>add = TRUE</code>; defaults to
<code>1:n</code> where <code>n</code> is the number of boxes.</p>
</td></tr>
<tr><td><code id="bxp_+3A_show.names">show.names</code></td>
<td>
<p>Set to <code>TRUE</code> or <code>FALSE</code> to override the
defaults on whether an x-axis label is printed for each group.</p>
</td></tr>
<tr><td><code id="bxp_+3A_pars">pars</code>, <code id="bxp_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> (etc) can be passed as
arguments to this function, either as a list (<code>pars</code>) or
normally(<code>...</code>), see the following.  (Those in <code>...</code>
take precedence over those in <code>pars</code>.)
</p>
<p>Currently, <code>yaxs</code> and <code>ylim</code> are used &lsquo;along the
boxplot&rsquo;, i.e., vertically, when <code>horizontal</code> is
false, and <code>xlim</code> horizontally.
<code>xaxt</code>, <code>yaxt</code>, <code>las</code>, <code>cex.axis</code>,
<code>gap.axis</code>, and
<code>col.axis</code> are passed to <code><a href="#topic+axis">axis</a></code>, and <code>main</code>,
<code>cex.main</code>, <code>col.main</code>, <code>sub</code>, <code>cex.sub</code>,
<code>col.sub</code>, <code>xlab</code>, <code>ylab</code>, <code>cex.lab</code>, and
<code>col.lab</code> are passed to <code><a href="#topic+title">title</a></code>.
</p>
<p>In addition, <code>axes</code> is accepted (see
<code><a href="#topic+plot.window">plot.window</a></code>), with default <code>TRUE</code>.
</p>
<p>The following arguments (or <code>pars</code> components) allow further
customization of the boxplot graphics.  Their defaults are typically
determined from the non-prefixed version (e.g., <code>boxlty</code> from
<code>lty</code>), either from the specified argument or <code>pars</code>
component or the corresponding <code><a href="#topic+par">par</a></code> one.
</p>

<dl>
<dt>boxwex:</dt><dd><p>a scale factor to be applied to all boxes.  When there
are only a few groups, the appearance of the plot can be improved by
making the boxes narrower.  The default depends on <code>at</code> and
typically is <code class="reqn">0.8</code>.</p>
</dd>
<dt>staplewex, outwex:</dt><dd><p>staple and outlier line width expansion,
proportional to box width; both default to 0.5.</p>
</dd>
<dt>boxlty, boxlwd, boxcol, boxfill:</dt><dd><p>box outline type, width,
color, and fill color (which currently defaults to <code>col</code> and will
in future default to <code>par("bg")</code>).</p>
</dd>
<dt>medlty, medlwd, medpch, medcex, medcol, medbg:</dt><dd><p>median line type,
line width, point character, point size expansion, color, and
background color.  The default <code>medpch = NA</code> suppresses the
point, and <code>medlty = "blank"</code> does so for the line.
Note that <code>medlwd</code> defaults to
<code class="reqn">3\times</code> the default <code>lwd</code>.</p>
</dd>
<dt>whisklty, whisklwd, whiskcol:</dt><dd><p>whisker line type (default:
<code>"dashed"</code>), width, and color.</p>
</dd>
<dt>staplelty, staplelwd, staplecol:</dt><dd><p>staple (= end of whisker) line
type, width, and color.</p>
</dd>
<dt>outlty, outlwd, outpch, outcex, outcol, outbg:</dt><dd><p>outlier line
type, line width, point character, point size expansion, color, and
background color.  The default <code>outlty =  "blank"</code> suppresses the
lines and <code>outpch = NA</code> suppresses points.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>An invisible vector, actually identical to the <code>at</code> argument,
with the coordinates (&quot;x&quot; if horizontal is false, &quot;y&quot; otherwise) of
box centers, useful for adding to the plot.
</p>


<h3>Note</h3>

<p>When <code>add = FALSE</code>, <code>xlim</code> now defaults to <code>xlim =
    range(at, *) + c(-0.5, 0.5)</code>.  It will usually be a good idea to
specify <code>xlim</code> if the &quot;x&quot; axis has a log scale or <code>width</code> is
far from uniform.
</p>


<h3>Author(s)</h3>

<p>The R Core development team and Arni Magnusson
(then at U Washington) who has provided most changes for the
box*, med*, whisk*, staple*, and out* arguments.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
set.seed(753)
(bx.p &lt;- boxplot(split(rt(100, 4), gl(5, 20))))
op &lt;- par(mfrow =  c(2, 2))
bxp(bx.p, xaxt = "n")
bxp(bx.p, notch = TRUE, axes = FALSE, pch = 4, boxfill = 1:5)
bxp(bx.p, notch = TRUE, boxfill = "lightblue", frame.plot = FALSE,
    outline = FALSE, main = "bxp(*, frame.plot= FALSE, outline= FALSE)")
bxp(bx.p, notch = TRUE, boxfill = "lightblue", border = 2:6,
    ylim = c(-4,4), pch = 22, bg = "green", log = "x",
    main = "... log = 'x', ylim = *")
par(op)
op &lt;- par(mfrow = c(1, 2))

## single group -- no label
boxplot (weight ~ group, data = PlantGrowth, subset = group == "ctrl")
## with label
bx &lt;- boxplot(weight ~ group, data = PlantGrowth,
              subset = group == "ctrl", plot = FALSE)
bxp(bx, show.names=TRUE)
par(op)

## passing gap.axis=* to axis(), PR#18109:
boxplot(matrix(100*rnorm(1e3), 50, 20),
        cex.axis = 1.5, gap.axis = -1)# showing *all* labels

z &lt;- split(rnorm(1000), rpois(1000, 2.2))
boxplot(z, whisklty = 3, main = "boxplot(z, whisklty = 3)")

## Colour support similar to plot.default:
op &lt;- par(mfrow = 1:2, bg = "light gray", fg = "midnight blue")
boxplot(z,   col.axis = "skyblue3", main = "boxplot(*, col.axis=..,main=..)")
plot(z[[1]], col.axis = "skyblue3", main =    "plot(*, col.axis=..,main=..)")
mtext("par(bg=\"light gray\", fg=\"midnight blue\")",
      outer = TRUE, line = -1.2)
par(op)

## Mimic S-Plus:
splus &lt;- list(boxwex = 0.4, staplewex = 1, outwex = 1, boxfill = "grey40",
              medlwd = 3, medcol = "white", whisklty = 3, outlty = 1, outpch = NA)
boxplot(z, pars = splus)
## Recycled and "sweeping" parameters
op &lt;- par(mfrow = c(1,2))
 boxplot(z, border = 1:5, lty = 3, medlty = 1, medlwd = 2.5)
 boxplot(z, boxfill = 1:3, pch = 1:5, lwd = 1.5, medcol = "white")
par(op)
## too many possibilities
boxplot(z, boxfill = "light gray", outpch = 21:25, outlty = 2,
        bg = "pink", lwd = 2,
        medcol = "dark blue", medcex = 2, medpch = 20)
</code></pre>

<hr>
<h2 id='cdplot'>Conditional Density Plots</h2><span id='topic+cdplot'></span><span id='topic+cdplot.default'></span><span id='topic+cdplot.formula'></span>

<h3>Description</h3>

<p>Computes and plots conditional densities describing how the
conditional distribution of a categorical variable <code>y</code> changes over a
numerical variable <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdplot(x, ...)

## Default S3 method:
cdplot(x, y,
  plot = TRUE, tol.ylab = 0.05, ylevels = NULL,
  bw = "nrd0", n = 512, from = NULL, to = NULL,
  col = NULL, border = 1, main = "", xlab = NULL, ylab = NULL,
  yaxlabels = NULL, xlim = NULL, ylim = c(0, 1), weights = NULL, ...)

## S3 method for class 'formula'
cdplot(formula, data = list(),
  plot = TRUE, tol.ylab = 0.05, ylevels = NULL,
  bw = "nrd0", n = 512, from = NULL, to = NULL,
  col = NULL, border = 1, main = "", xlab = NULL, ylab = NULL,
  yaxlabels = NULL, xlim = NULL, ylim = c(0, 1), ...,
  subset = NULL, weights = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdplot_+3A_x">x</code></td>
<td>
<p>an object, the default method expects a single numerical
variable (or an object coercible to this).</p>
</td></tr>
<tr><td><code id="cdplot_+3A_y">y</code></td>
<td>
<p>a <code>"factor"</code> interpreted to be the dependent variable</p>
</td></tr>
<tr><td><code id="cdplot_+3A_formula">formula</code></td>
<td>
<p>a <code>"formula"</code> of type <code>y ~ x</code> with a single dependent
<code>"factor"</code> and a single numerical explanatory variable.</p>
</td></tr>
<tr><td><code id="cdplot_+3A_data">data</code></td>
<td>
<p>an optional data frame.</p>
</td></tr>
<tr><td><code id="cdplot_+3A_plot">plot</code></td>
<td>
<p>logical. Should the computed conditional densities be plotted?</p>
</td></tr>
<tr><td><code id="cdplot_+3A_tol.ylab">tol.ylab</code></td>
<td>
<p>convenience tolerance parameter for y-axis annotation.
If the distance between two labels drops under this threshold, they are
plotted equidistantly.</p>
</td></tr>
<tr><td><code id="cdplot_+3A_ylevels">ylevels</code></td>
<td>
<p>a character or numeric vector specifying in which order
the levels of the dependent variable should be plotted.</p>
</td></tr>
<tr><td><code id="cdplot_+3A_bw">bw</code>, <code id="cdplot_+3A_n">n</code>, <code id="cdplot_+3A_from">from</code>, <code id="cdplot_+3A_to">to</code>, <code id="cdplot_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="stats.html#topic+density">density</a></code></p>
</td></tr>
<tr><td><code id="cdplot_+3A_col">col</code></td>
<td>
<p>a vector of fill colors of the same length as <code>levels(y)</code>.
The default is to call <code><a href="grDevices.html#topic+gray.colors">gray.colors</a></code>.</p>
</td></tr>
<tr><td><code id="cdplot_+3A_border">border</code></td>
<td>
<p>border color of shaded polygons.</p>
</td></tr>
<tr><td><code id="cdplot_+3A_main">main</code>, <code id="cdplot_+3A_xlab">xlab</code>, <code id="cdplot_+3A_ylab">ylab</code></td>
<td>
<p>character strings for annotation</p>
</td></tr>
<tr><td><code id="cdplot_+3A_yaxlabels">yaxlabels</code></td>
<td>
<p>character vector for annotation of y axis, defaults to
<code>levels(y)</code>.</p>
</td></tr>
<tr><td><code id="cdplot_+3A_xlim">xlim</code>, <code id="cdplot_+3A_ylim">ylim</code></td>
<td>
<p>the range of x and y values with sensible defaults.</p>
</td></tr>
<tr><td><code id="cdplot_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td></tr>
<tr><td><code id="cdplot_+3A_weights">weights</code></td>
<td>
<p>numeric. A vector of frequency weights for each
observation in the data. If <code>NULL</code> all weights are implicitly
assumed to be 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cdplot</code> computes the conditional densities of <code>x</code> given
the levels of <code>y</code> weighted by the marginal distribution of <code>y</code>.
The densities are derived cumulatively over the levels of <code>y</code>.
</p>
<p>This visualization technique is similar to spinograms (see <code><a href="#topic+spineplot">spineplot</a></code>)
and plots <code class="reqn">P(y | x)</code> against <code class="reqn">x</code>. The conditional probabilities
are not derived by discretization (as in the spinogram), but using a smoothing
approach via <code><a href="stats.html#topic+density">density</a></code>.
</p>
<p>Note, that the estimates of the conditional densities are more reliable for
high-density regions of <code class="reqn">x</code>. Conversely, the are less reliable in regions
with only few <code class="reqn">x</code> observations.
</p>


<h3>Value</h3>

<p>The conditional density functions (cumulative over the levels of <code>y</code>)
are returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Achim Zeileis <a href="mailto:Achim.Zeileis@R-project.org">Achim.Zeileis@R-project.org</a>
</p>


<h3>References</h3>

<p>Hofmann, H., Theus, M. (2005), <em>Interactive graphics for visualizing
conditional distributions</em>, Unpublished Manuscript.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spineplot">spineplot</a></code>, <code><a href="stats.html#topic+density">density</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NASA space shuttle o-ring failures
fail &lt;- factor(c(2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1, 1, 1,
                 1, 2, 1, 1, 1, 1, 1),
               levels = 1:2, labels = c("no", "yes"))
temperature &lt;- c(53, 57, 58, 63, 66, 67, 67, 67, 68, 69, 70, 70,
                 70, 70, 72, 73, 75, 75, 76, 76, 78, 79, 81)

## CD plot
cdplot(fail ~ temperature)
cdplot(fail ~ temperature, bw = 2)
cdplot(fail ~ temperature, bw = "SJ")

## compare with spinogram
(spineplot(fail ~ temperature, breaks = 3))

## highlighting for failures
cdplot(fail ~ temperature, ylevels = 2:1)

## scatter plot with conditional density
cdens &lt;- cdplot(fail ~ temperature, plot = FALSE)
plot(I(as.numeric(fail) - 1) ~ jitter(temperature, factor = 2),
     xlab = "Temperature", ylab = "Conditional failure probability")
lines(53:81, 1 - cdens[[1]](53:81), col = 2)
</code></pre>

<hr>
<h2 id='clip'>Set Clipping Region</h2><span id='topic+clip'></span>

<h3>Description</h3>

<p>Set clipping region in user coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clip(x1, x2, y1, y2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clip_+3A_x1">x1</code>, <code id="clip_+3A_x2">x2</code>, <code id="clip_+3A_y1">y1</code>, <code id="clip_+3A_y2">y2</code></td>
<td>
<p>user coordinates of clipping rectangle</p>
</td></tr>
</table>


<h3>Details</h3>

<p>How the clipping rectangle is set depends on the setting of
<code><a href="#topic+par">par</a>("xpd")</code>: this function changes the current setting
until the next high-level plotting command resets it.
</p>
<p>Clipping of lines, rectangles and polygons is done in the graphics
engine, but clipping of text is if possible done in the device, so the
effect of clipping text is device-dependent (and may result in text
not wholly within the clipping region being omitted entirely).
</p>
<p>Exactly when the clipping region will be reset can be hard to
predict.  <code><a href="#topic+plot.new">plot.new</a></code> always resets it.
Functions such as <code><a href="#topic+lines">lines</a></code> and <code><a href="#topic+text">text</a></code> only
reset it if <code><a href="#topic+par">par</a>("xpd")</code> has been changed.  However,
functions such as <code><a href="#topic+box">box</a></code>, <code><a href="#topic+mtext">mtext</a></code>,
<code><a href="#topic+title">title</a></code> and <code><a href="stats.html#topic+plot.dendrogram">plot.dendrogram</a></code> can manipulate
the <code>xpd</code> setting.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+par">par</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(1000)
hist(x, xlim = c(-4,4))
usr &lt;- par("usr")
clip(usr[1], -2, usr[3], usr[4])
hist(x, col = 'red', add = TRUE)
clip(2, usr[2], usr[3], usr[4])
hist(x, col = 'blue', add = TRUE)
do.call("clip", as.list(usr))  # reset to plot region
</code></pre>

<hr>
<h2 id='contour'>Display Contours</h2><span id='topic+contour'></span><span id='topic+contour.default'></span>

<h3>Description</h3>

<p>Create a contour plot, or add contour lines to an existing plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contour(x, ...)

## Default S3 method:
contour(x = seq(0, 1, length.out = nrow(z)),
        y = seq(0, 1, length.out = ncol(z)),
        z,
        nlevels = 10, levels = pretty(zlim, nlevels),
        labels = NULL,
        xlim = range(x, finite = TRUE),
        ylim = range(y, finite = TRUE),
        zlim = range(z, finite = TRUE),
        labcex = 0.6, drawlabels = TRUE, method = "flattest",
        vfont, axes = TRUE, frame.plot = axes,
        col = par("fg"), lty = par("lty"), lwd = par("lwd"),
        add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contour_+3A_x">x</code>, <code id="contour_+3A_y">y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are
measured.  These must be in ascending order.  By default, equally
spaced values from 0 to 1 are used.  If <code>x</code> is a <code>list</code>,
its components <code>x$x</code> and <code>x$y</code> are used for <code>x</code>
and <code>y</code>, respectively. If the list has component <code>z</code> this
is used for <code>z</code>.</p>
</td></tr>
<tr><td><code id="contour_+3A_z">z</code></td>
<td>
<p>a matrix containing the values to be plotted (<code>NA</code>s are
allowed).  Note that <code>x</code> can be used instead of <code>z</code> for
convenience.</p>
</td></tr>
<tr><td><code id="contour_+3A_nlevels">nlevels</code></td>
<td>
<p>number of contour levels desired <b>iff</b>
<code>levels</code> is not supplied.</p>
</td></tr>
<tr><td><code id="contour_+3A_levels">levels</code></td>
<td>
<p>numeric vector of levels at which to draw contour
lines.</p>
</td></tr>
<tr><td><code id="contour_+3A_labels">labels</code></td>
<td>
<p>a vector giving the labels for the contour lines.  If
<code>NULL</code> then the levels are used as labels, otherwise this is
coerced by <code><a href="base.html#topic+as.character">as.character</a></code>.</p>
</td></tr>
<tr><td><code id="contour_+3A_labcex">labcex</code></td>
<td>
<p><code>cex</code> for contour labelling.  This is an absolute
size, not a multiple of <code>par("cex")</code>.</p>
</td></tr>
<tr><td><code id="contour_+3A_drawlabels">drawlabels</code></td>
<td>
<p>logical.  Contours are labelled if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="contour_+3A_method">method</code></td>
<td>
<p>character string specifying where the labels will be
located. Possible values are <code>"simple"</code>, <code>"edge"</code> and
<code>"flattest"</code> (the default).  See the &lsquo;Details&rsquo; section.</p>
</td></tr>
<tr><td><code id="contour_+3A_vfont">vfont</code></td>
<td>
<p>if <code>NULL</code>, the current font family and face are used
for the contour labels.  If a character vector of length 2 then
Hershey vector fonts are used for the contour labels. The first
element of the vector selects a typeface and the second element
selects a font index (see <code><a href="#topic+text">text</a></code> for more information).
The default is <code>NULL</code> on graphics devices with high-quality
rotation of text and <code>c("sans serif", "plain")</code> otherwise.</p>
</td></tr>
<tr><td><code id="contour_+3A_xlim">xlim</code>, <code id="contour_+3A_ylim">ylim</code>, <code id="contour_+3A_zlim">zlim</code></td>
<td>
<p>x-, y- and z-limits for the plot.</p>
</td></tr>
<tr><td><code id="contour_+3A_axes">axes</code>, <code id="contour_+3A_frame.plot">frame.plot</code></td>
<td>
<p>logical indicating whether axes or a box
should be drawn, see <code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="contour_+3A_col">col</code></td>
<td>
<p>colour(s) for the lines drawn.</p>
</td></tr>
<tr><td><code id="contour_+3A_lty">lty</code></td>
<td>
<p>line type(s) for the lines drawn.</p>
</td></tr>
<tr><td><code id="contour_+3A_lwd">lwd</code></td>
<td>
<p>line width(s) for the lines drawn.</p>
</td></tr>
<tr><td><code id="contour_+3A_add">add</code></td>
<td>
<p>logical. If <code>TRUE</code>, add to a current plot.</p>
</td></tr>
<tr><td><code id="contour_+3A_...">...</code></td>
<td>
<p>additional arguments to <code><a href="#topic+plot.window">plot.window</a></code>,
<code><a href="#topic+title">title</a></code>, <code><a href="#topic+Axis">Axis</a></code> and <code><a href="#topic+box">box</a></code>,
typically <a href="#topic+graphical+20parameters">graphical parameters</a> such as <code>cex.axis</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>contour</code> is a generic function with only a default method in
base <span class="rlang"><b>R</b></span>.
</p>
<p>The methods for positioning the labels on contours are <code>"simple"</code>
(draw at the edge of the plot, overlaying the contour line),
<code>"edge"</code> (draw at the edge of the plot, embedded in the contour
line, with no labels overlapping) and <code>"flattest"</code>
(draw on the flattest section of the contour, embedded in the
contour line, with no labels overlapping).  The second and third may
not draw a label on every contour line.
</p>
<p>For information about vector fonts, see the
help for <code><a href="#topic+text">text</a></code> and <code><a href="grDevices.html#topic+Hershey">Hershey</a></code>.
</p>
<p>Notice that <code>contour</code> interprets the <code>z</code> matrix as a table of
<code>f(x[i], y[j])</code> values, so that the x axis corresponds to row
number and the y axis to column number, with column 1 at the bottom,
i.e. a 90 degree counter-clockwise rotation of the conventional textual
layout.
</p>
<p>Vector (of length <code class="reqn">&gt; 1</code>) <code>col</code>, <code>lty</code>, and <code>lwd</code> are
applied along <code>levels</code> and recycled, see the Examples.
</p>
<p>Alternatively, use <code><a href="lattice.html#topic+levelplot">contourplot</a></code> from the
<a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a> package where the <code><a href="stats.html#topic+formula">formula</a></code> notation allows
to use vectors <code>x</code>, <code>y</code>, and <code>z</code> of the same length.
</p>
<p>There is limited control over the axes and frame as arguments
<code>col</code>, <code>lwd</code> and <code>lty</code> refer to the contour lines
(rather than being general <a href="#topic+graphical+20parameters">graphical parameters</a>).  For more control,
add contours to a plot, or add axes and frame to a contour plot.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+options">options</a>("max.contour.segments")</code> for the maximal
complexity of a single contour line.
</p>
<p><code><a href="grDevices.html#topic+contourLines">contourLines</a></code>, <code><a href="#topic+filled.contour">filled.contour</a></code>
for color-filled contours,
<code><a href="lattice.html#topic+levelplot">contourplot</a></code> (and
<code><a href="lattice.html#topic+levelplot">levelplot</a></code>) from package <a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a>.
Further, <code><a href="#topic+image">image</a></code> and the graphics demo which can be
invoked as <code>demo(graphics)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(grDevices) # for colours
x &lt;- -6:16
op &lt;- par(mfrow = c(2, 2))
contour(outer(x, x), method = "edge", vfont = c("sans serif", "plain"))
z &lt;- outer(x, sqrt(abs(x)), FUN = `/`)
image(x, x, z)
contour(x, x, z, col = "pink", add = TRUE, method = "edge",
        vfont = c("sans serif", "plain"))
contour(x, x, z, ylim = c(1, 6), method = "simple", labcex = 1,
        xlab = quote(x[1]), ylab = quote(x[2]))
contour(x, x, z, ylim = c(-6, 6), nlevels = 20, lty = 2, method = "simple",
        main = "20 levels; \"simple\" labelling method")
par(op)

## Passing multiple colours / lty / lwd :
op &lt;- par(mfrow = c(1, 2))
z &lt;- outer(-9:25, -9:25)
## Using default levels &lt;- pretty(range(z, finite = TRUE), 10),
##  the first and last of which typically are *not* drawn:
(levs &lt;- pretty(z, n=10)) # -300 -200 ... 600 700
contour(z, col = 1:4)
## Set levels explicitly; show that 'lwd' and 'lty' are recycled as well:
contour(z, levels=levs[-c(1,length(levs))], col = 1:5, lwd = 1:3 *1.5, lty = 1:3)
par(op)

## Persian Rug Art:
x &lt;- y &lt;- seq(-4*pi, 4*pi, length.out = 27)
r &lt;- sqrt(outer(x^2, y^2, `+`))
opar &lt;- par(mfrow = c(2, 2), mar = rep(0, 4))
for(f in pi^(0:3))
  contour(cos(r^2)*exp(-r/f),
          drawlabels = FALSE, axes = FALSE, frame.plot = TRUE)

rx &lt;- range(x &lt;- 10*1:nrow(volcano))
ry &lt;- range(y &lt;- 10*1:ncol(volcano))
ry &lt;- ry + c(-1, 1) * (diff(rx) - diff(ry))/2
tcol &lt;- terrain.colors(12)
par(opar); opar &lt;- par(pty = "s", bg = "lightcyan")
plot(x = 0, y = 0, type = "n", xlim = rx, ylim = ry, xlab = "", ylab = "")
u &lt;- par("usr")
rect(u[1], u[3], u[2], u[4], col = tcol[8], border = "red")
contour(x, y, volcano, col = tcol[2], lty = "solid", add = TRUE,
        vfont = c("sans serif", "plain"))
title("A Topographic Map of Maunga Whau", font = 4)
abline(h = 200*0:4, v = 200*0:4, col = "lightgray", lty = 2, lwd = 0.1)

## contourLines produces the same contour lines as contour
plot(x = 0, y = 0, type = "n", xlim = rx, ylim = ry, xlab = "", ylab = "")
u &lt;- par("usr")
rect(u[1], u[3], u[2], u[4], col = tcol[8], border = "red")
contour(x, y, volcano, col = tcol[1], lty = "solid", add = TRUE,
        vfont = c("sans serif", "plain"))
line.list &lt;- contourLines(x, y, volcano)
invisible(lapply(line.list, lines, lwd=3, col=adjustcolor(2, .3)))
par(opar)
</code></pre>

<hr>
<h2 id='convertXY'>Convert between Graphics Coordinate Systems</h2><span id='topic+grconvertX'></span><span id='topic+grconvertY'></span>

<h3>Description</h3>

<p>Convert between graphics coordinate systems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grconvertX(x, from = "user", to = "user")
grconvertY(y, from = "user", to = "user")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convertXY_+3A_x">x</code>, <code id="convertXY_+3A_y">y</code></td>
<td>
<p>numeric vector of coordinates.</p>
</td></tr>
<tr><td><code id="convertXY_+3A_from">from</code>, <code id="convertXY_+3A_to">to</code></td>
<td>
<p>character strings giving the coordinate systems to
convert between.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coordinate systems are
</p>

<dl>
<dt><code>"user"</code></dt><dd><p>user coordinates.</p>
</dd>
<dt><code>"inches"</code></dt><dd><p>inches.</p>
</dd>
<dt><code>"device"</code></dt><dd><p>the device coordinate system.</p>
</dd>
<dt><code>"ndc"</code></dt><dd><p>normalized device coordinates.</p>
</dd>
<dt><code>"nfc"</code></dt><dd><p>normalized figure coordinates.</p>
</dd>
<dt><code>"npc"</code></dt><dd><p>normalized plot coordinates.</p>
</dd>
<dt><code>"nic"</code></dt><dd><p>normalized inner region coordinates.  (The
&lsquo;inner region&rsquo; is that inside the outer margins.)</p>
</dd>
<dt><code>"lines"</code></dt><dd><p>lines of margin (based on <code>mex</code>).</p>
</dd>
<dt><code>"chars"</code></dt><dd><p>lines of text (based on <code>cex</code>).</p>
</dd>
</dl>

<p>(These names can be partially matched.)  For the &lsquo;normalized&rsquo;
coordinate systems the lower left has value 0 and the top right
value 1.
</p>
<p>Device coordinates are those in which the device works: they are
usually in pixels where that makes sense and in big points (1/72 inch)
otherwise (e.g., <code><a href="grDevices.html#topic+pdf">pdf</a></code> and <code><a href="grDevices.html#topic+postscript">postscript</a></code>).
</p>


<h3>Value</h3>

<p>A numeric vector of the same length as the input.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>op &lt;- par(omd=c(0.1, 0.9, 0.1, 0.9), mfrow = c(1, 2))
plot(1:4)
for(tp in c("in", "dev", "ndc", "nfc", "npc", "nic", "lines", "chars"))
    print(grconvertX(c(1.0, 4.0), "user", tp))
par(op)
</code></pre>

<hr>
<h2 id='coplot'>Conditioning Plots</h2><span id='topic+coplot'></span><span id='topic+co.intervals'></span>

<h3>Description</h3>

<p>This function produces two variants of the <b>co</b>nditioning plots
discussed in the reference below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coplot(formula, data, given.values, panel = points, rows, columns,
       show.given = TRUE, col = par("fg"), pch = par("pch"),
       bar.bg = c(num = gray(0.8), fac = gray(0.95)),
       xlab = c(x.name, paste("Given :", a.name)),
       ylab = c(y.name, paste("Given :", b.name)),
       subscripts = FALSE,
       axlabels = function(f) abbreviate(levels(f)),
       number = 6, overlap = 0.5, xlim, ylim, ...)
co.intervals(x, number = 6, overlap = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coplot_+3A_formula">formula</code></td>
<td>
<p>a formula describing the form of conditioning plot.  A
formula of the form <code>y ~ x | a</code> indicates that plots of
<code>y</code> versus <code>x</code> should be produced conditional on the
variable <code>a</code>.  A formula of the form <code>y ~ x| a * b</code>
indicates that plots of <code>y</code> versus <code>x</code> should be produced
conditional on the two variables <code>a</code> and <code>b</code>.
</p>
<p>All three or four variables may be either numeric or factors.
When <code>x</code> or <code>y</code> are factors, the result is almost as if
<code>as.numeric()</code> was applied, whereas for factor
<code>a</code> or <code>b</code>, the conditioning (and its graphics if
<code>show.given</code> is true) are adapted.
</p>
</td></tr>
<tr><td><code id="coplot_+3A_data">data</code></td>
<td>
<p>a data frame containing values for any variables in the
formula.  By default the environment where <code>coplot</code> was called
from is used.</p>
</td></tr>
<tr><td><code id="coplot_+3A_given.values">given.values</code></td>
<td>
<p>a value or list of two values which determine how
the conditioning on <code>a</code> and <code>b</code> is to take place.
</p>
<p>When there is no <code>b</code> (i.e., conditioning only on <code>a</code>),
usually this is a matrix with two columns each row of which gives an
interval, to be conditioned on, but is can also be a single vector
of numbers or a set of factor levels (if the variable being
conditioned on is a factor). In this case (no <code>b</code>),
the result of <code>co.intervals</code> can be used directly as
<code>given.values</code> argument.
</p>
</td></tr>
<tr><td><code id="coplot_+3A_panel">panel</code></td>
<td>
<p>a <code><a href="base.html#topic+function">function</a>(x, y, col, pch, ...)</code>
which gives the action to be carried out in
each panel of the display.  The default is <code>points</code>.</p>
</td></tr>
<tr><td><code id="coplot_+3A_rows">rows</code></td>
<td>
<p>the panels of the plot are laid out in a <code>rows</code> by
<code>columns</code> array.  <code>rows</code> gives the number of rows in the
array.</p>
</td></tr>
<tr><td><code id="coplot_+3A_columns">columns</code></td>
<td>
<p>the number of columns in the panel layout array.</p>
</td></tr>
<tr><td><code id="coplot_+3A_show.given">show.given</code></td>
<td>
<p>logical (possibly of length 2 for 2 conditioning
variables): should conditioning plots be shown for the
corresponding conditioning variables (default <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="coplot_+3A_col">col</code></td>
<td>
<p>a vector of colors to be used to plot the points.  If too
short, the values are recycled.</p>
</td></tr>
<tr><td><code id="coplot_+3A_pch">pch</code></td>
<td>
<p>a vector of plotting symbols or characters.  If too short,
the values are recycled.</p>
</td></tr>
<tr><td><code id="coplot_+3A_bar.bg">bar.bg</code></td>
<td>
<p>a named vector with components <code>"num"</code> and
<code>"fac"</code> giving the background colors for the (shingle) bars,
for <b>num</b>eric and <b>fac</b>tor conditioning variables respectively.</p>
</td></tr>
<tr><td><code id="coplot_+3A_xlab">xlab</code></td>
<td>
<p>character; labels to use for the x axis and the
first conditioning variable.  If only one label is given, it is used
for the x axis and the default label is used for the conditioning
variable.</p>
</td></tr>
<tr><td><code id="coplot_+3A_ylab">ylab</code></td>
<td>
<p>character; labels to use for the y axis and any
second conditioning variable.</p>
</td></tr>
<tr><td><code id="coplot_+3A_subscripts">subscripts</code></td>
<td>
<p>logical: if true the panel function is given an
additional (third) argument <code>subscripts</code> giving the subscripts
of the data passed to that panel.</p>
</td></tr>
<tr><td><code id="coplot_+3A_axlabels">axlabels</code></td>
<td>
<p>function for creating axis (tick) labels when x or y
are factors.</p>
</td></tr>
<tr><td><code id="coplot_+3A_number">number</code></td>
<td>
<p>integer; the number of conditioning intervals,
for a and b, possibly of length 2.  It is only used if the
corresponding conditioning variable is not a <code><a href="base.html#topic+factor">factor</a></code>.</p>
</td></tr>
<tr><td><code id="coplot_+3A_overlap">overlap</code></td>
<td>
<p>numeric &lt; 1; the fraction of overlap of the
conditioning variables, possibly of length 2 for x and y
direction.  When overlap &lt; 0, there will be <em>gaps</em> between
the data slices.</p>
</td></tr>
<tr><td><code id="coplot_+3A_xlim">xlim</code></td>
<td>
<p>the range for the x axis.</p>
</td></tr>
<tr><td><code id="coplot_+3A_ylim">ylim</code></td>
<td>
<p>the range for the y axis.</p>
</td></tr>
<tr><td><code id="coplot_+3A_...">...</code></td>
<td>
<p>additional arguments to the panel function.</p>
</td></tr>
<tr><td><code id="coplot_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the case of a single conditioning variable <code>a</code>, when both
<code>rows</code> and <code>columns</code> are unspecified, a &lsquo;close to
square&rsquo; layout is chosen with <code>columns &gt;= rows</code>.
</p>
<p>In the case of multiple <code>rows</code>, the <em>order</em> of the panel
plots is from the bottom and from the left (corresponding to
increasing <code>a</code>, typically).
</p>
<p>A panel function should not attempt to start a new plot, but just plot
within a given coordinate system: thus <code>plot</code> and <code>boxplot</code>
are not panel functions.
</p>
<p>The rendering of arguments <code>xlab</code> and
<code>ylab</code> is not controlled by <code><a href="#topic+par">par</a></code> arguments
<code>cex.lab</code> and <code>font.lab</code> even though they are plotted by
<code><a href="#topic+mtext">mtext</a></code> rather than <code><a href="#topic+title">title</a></code>.
</p>


<h3>Value</h3>

<p><code>co.intervals(., number, .)</code> returns a (<code>number</code> <code class="reqn">\times</code>
2) <code><a href="base.html#topic+matrix">matrix</a></code>, say <code>ci</code>,  where <code>ci[k,]</code> is
the <code><a href="base.html#topic+range">range</a></code> of <code>x</code> values for the <code>k</code>-th interval.
</p>


<h3>References</h3>

<p>Chambers, J. M. (1992)
<em>Data for models.</em>
Chapter 3 of <em>Statistical Models in S</em>
eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>
<p>Cleveland, W. S. (1993) <em>Visualizing Data.</em> New Jersey: Summit Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pairs">pairs</a></code>,
<code><a href="#topic+panel.smooth">panel.smooth</a></code>,
<code><a href="#topic+points">points</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Tonga Trench Earthquakes
coplot(lat ~ long | depth, data = quakes)
given.depth &lt;- co.intervals(quakes$depth, number = 4, overlap = .1)
coplot(lat ~ long | depth, data = quakes, given.values = given.depth, rows = 1)

## Conditioning on 2 variables:
ll.dm &lt;- lat ~ long | depth * mag
coplot(ll.dm, data = quakes)
coplot(ll.dm, data = quakes, number = c(4, 7), show.given = c(TRUE, FALSE))
coplot(ll.dm, data = quakes, number = c(3, 7),
       overlap = c(-.5, .1)) # negative overlap DROPS values

## given two factors
Index &lt;- seq_len(nrow(warpbreaks)) # to get nicer default labels
coplot(breaks ~ Index | wool * tension, data = warpbreaks,
       show.given = 0:1)
coplot(breaks ~ Index | wool * tension, data = warpbreaks,
       col = "red", bg = "pink", pch = 21,
       bar.bg = c(fac = "light blue"))

## Example with empty panels:
with(data.frame(state.x77), {
coplot(Life.Exp ~ Income | Illiteracy * state.region, number = 3,
       panel = function(x, y, ...) panel.smooth(x, y, span = .8, ...))
## y ~ factor -- not really sensible, but 'show off':
coplot(Life.Exp ~ state.region | Income * state.division,
       panel = panel.smooth)
})
</code></pre>

<hr>
<h2 id='curve'>Draw Function Plots</h2><span id='topic+curve'></span><span id='topic+plot.function'></span>

<h3>Description</h3>

<p>Draws a curve corresponding to a function over the interval
<code>[from, to]</code>. <code>curve</code> can plot also an expression in the variable
<code>xname</code>, default &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curve(expr, from = NULL, to = NULL, n = 101, add = FALSE,
      type = "l", xname = "x", xlab = xname, ylab = NULL,
      log = NULL, xlim = NULL, ...)

## S3 method for class 'function'
plot(x, y = 0, to = 1, from = y, xlim = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="curve_+3A_expr">expr</code></td>
<td>
<p>The name of a function, or a <a href="base.html#topic+call">call</a> or an
<a href="base.html#topic+expression">expression</a> written as a function of <code>x</code> which will
evaluate to an object of the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="curve_+3A_x">x</code></td>
<td>
<p>a &lsquo;vectorizing&rsquo; numeric <span class="rlang"><b>R</b></span> function.</p>
</td></tr>
<tr><td><code id="curve_+3A_y">y</code></td>
<td>
<p>alias for <code>from</code> for compatibility with <code>plot</code></p>
</td></tr>
<tr><td><code id="curve_+3A_from">from</code>, <code id="curve_+3A_to">to</code></td>
<td>
<p>the range over which the function will be plotted.</p>
</td></tr>
<tr><td><code id="curve_+3A_n">n</code></td>
<td>
<p>integer; the number of x values at which to evaluate.</p>
</td></tr>
<tr><td><code id="curve_+3A_add">add</code></td>
<td>
<p>logical; if <code>TRUE</code> add to an already existing plot; if
<code>NA</code> start a new plot taking the defaults for the limits and
log-scaling of the x-axis from the previous plot.  Taken as
<code>FALSE</code> (with a warning if a different value is supplied) if no
graphics device is open.</p>
</td></tr>
<tr><td><code id="curve_+3A_xlim">xlim</code></td>
<td>
<p><code>NULL</code> or a numeric vector of length 2;
if non-<code>NULL</code> it provides the defaults for <code>c(from, to)</code>
and, unless <code>add = TRUE</code>, selects the x-limits of the plot &ndash; see
<code><a href="#topic+plot.window">plot.window</a></code>.</p>
</td></tr>
<tr><td><code id="curve_+3A_type">type</code></td>
<td>
<p>plot type: see <code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="curve_+3A_xname">xname</code></td>
<td>
<p>character string giving the name to be used for the x axis.</p>
</td></tr>
<tr><td><code id="curve_+3A_xlab">xlab</code>, <code id="curve_+3A_ylab">ylab</code>, <code id="curve_+3A_log">log</code>, <code id="curve_+3A_...">...</code></td>
<td>
<p>labels and <a href="#topic+graphical+20parameters">graphical parameters</a>
can also be specified as arguments.  See &lsquo;Details&rsquo; for the
interpretation of the default for <code>log</code>.
</p>
<p>For the <code>"function"</code> method of <code>plot</code>, <code>...</code> can
include any of the other arguments of <code>curve</code>, except
<code>expr</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function or expression <code>expr</code> (for <code>curve</code>) or function
<code>x</code> (for <code>plot</code>) is evaluated at <code>n</code> points equally
spaced over the range <code>[from, to]</code>.  The points determined in
this way are then plotted.
</p>
<p>If either <code>from</code> or <code>to</code> is <code>NULL</code>, it defaults to the
corresponding element of <code>xlim</code> if that is not <code>NULL</code>.
</p>
<p>What happens when neither <code>from</code>/<code>to</code> nor <code>xlim</code>
specifies both x-limits is a complex story.  For
<code>plot(&lt;function&gt;)</code> and for <code>curve(add = FALSE)</code> the defaults
are <code class="reqn">(0, 1)</code>.  For <code>curve(add = NA)</code> and <code>curve(add =
  TRUE)</code> the defaults are taken from the x-limits used for the previous
plot.  (This differs from versions of <span class="rlang"><b>R</b></span> prior to 2.14.0.)
</p>
<p>The value of <code>log</code> is used both to specify the plot axes (unless
<code>add = TRUE</code>) and how &lsquo;equally spaced&rsquo; is interpreted: if
the x component indicates log-scaling, the points at which the
expression or function is plotted are equally spaced on log scale.
</p>
<p>The default value of <code>log</code> is taken from the current plot when
<code>add = TRUE</code>, whereas if <code>add = NA</code> the x component is taken
from the existing plot (if any) and the y component defaults to
linear.  For <code>add = FALSE</code> the default is <code>""</code>
</p>
<p>This used to be a quick hack which now seems to serve a useful purpose,
but can give bad results for functions which are not smooth.
</p>
<p>For expensive-to-compute <code>expr</code>essions, you should use smarter tools.
</p>
<p>The way <code>curve</code> handles <code>expr</code> has caused confusion.  It
first looks to see if <code>expr</code> is a <a href="base.html#topic+name">name</a> (also known as a
symbol), in which case it is taken to be the name of a function, and
<code>expr</code> is replaced by a call to <code>expr</code> with a single
argument with name given by <code>xname</code>.  Otherwise it checks that
<code>expr</code> is either a <a href="base.html#topic+call">call</a> or an <a href="base.html#topic+expression">expression</a>, and that
it contains a reference to the variable given by <code>xname</code> (using
<code><a href="base.html#topic+all.vars">all.vars</a></code>): anything else is an error.  Then <code>expr</code>
is evaluated in an environment which supplies a vector of name given
by <code>xname</code> of length <code>n</code>, and should evaluate to an object
of length <code>n</code>.  Note that this means that <code>curve(x, ...)</code> is
taken as a request to plot a function named <code>x</code> (and it is used
as such in the <code>function</code> method for <code>plot</code>).
</p>
<p>The <code>plot</code> method can be called directly as <code>plot.function</code>.
</p>


<h3>Value</h3>

<p>A list with components <code>x</code> and <code>y</code> of the points that were
drawn is returned invisibly.
</p>


<h3>Warning</h3>

<p>For historical reasons, <code>add</code> is allowed as an argument to the
<code>"function"</code> method of <code>plot</code>, but its behaviour may surprise
you.  It is recommended to use <code>add</code> only with <code>curve</code>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+splinefun">splinefun</a></code> for spline interpolation, <code><a href="#topic+lines">lines</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(qnorm) # default range c(0, 1) is appropriate here,
            # but end values are -/+Inf and so are omitted.
plot(qlogis, main = "The Inverse Logit : qlogis()")
abline(h = 0, v = 0:2/2, lty = 3, col = "gray")

curve(sin, -2*pi, 2*pi, xname = "t")
curve(tan, xname = "t", add = NA,
      main = "curve(tan)  --&gt; same x-scale as previous plot")

op &lt;- par(mfrow = c(2, 2))
curve(x^3 - 3*x, -2, 2)
curve(x^2 - 2, add = TRUE, col = "violet")

## simple and advanced versions, quite similar:
plot(cos, -pi,  3*pi)
curve(cos, xlim = c(-pi, 3*pi), n = 1001, col = "blue", add = TRUE)

chippy &lt;- function(x) sin(cos(x)*exp(-x/2))
curve(chippy, -8, 7, n = 2001)
plot (chippy, -8, -5)

for(ll in c("", "x", "y", "xy"))
   curve(log(1+x), 1, 100, log = ll, sub = paste0("log = '", ll, "'"))
par(op)
</code></pre>

<hr>
<h2 id='dotchart'>Cleveland's Dot Plots</h2><span id='topic+dotchart'></span>

<h3>Description</h3>

<p>Draw a Cleveland dot plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dotchart(x, labels = NULL, groups = NULL, gdata = NULL, offset = 1/8,
         ann = par("ann"), xaxt = par("xaxt"), frame.plot = TRUE, log = "",
         cex = par("cex"), pt.cex = cex,
         pch = 21, gpch = 21, bg = par("bg"),
         color = par("fg"), gcolor = par("fg"), lcolor = "gray",
         xlim = range(x[is.finite(x)]),
         main = NULL, xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dotchart_+3A_x">x</code></td>
<td>
<p>either a vector or matrix of numeric values (<code>NA</code>s are
allowed).  If <code>x</code> is a matrix the overall plot consists of
juxtaposed dotplots for each row.  Inputs which satisfy
<code><a href="base.html#topic+is.numeric">is.numeric</a>(x)</code> but not
<code>is.vector(x) || is.matrix(x)</code> are coerced by
<code><a href="base.html#topic+as.numeric">as.numeric</a></code>, with a warning.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_labels">labels</code></td>
<td>
<p>a vector of labels for each point.
For vectors the default is to use <code>names(x)</code> and for matrices
the row labels <code>dimnames(x)[[1]]</code>.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_groups">groups</code></td>
<td>
<p>an optional factor indicating how the elements of
<code>x</code> are grouped.
If <code>x</code> is a matrix, <code>groups</code> will default to the columns
of <code>x</code>.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_gdata">gdata</code></td>
<td>
<p>data values for the groups.
This is typically a summary such as the median or mean
of each group.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_offset">offset</code></td>
<td>
<p>offset in inches of <code>ylab</code> and <code>labels</code>.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_ann">ann</code></td>
<td>
<p>a <code><a href="base.html#topic+logical">logical</a></code> value indicating whether the default annotation
(title and x and y axis labels) should appear on the plot.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_xaxt">xaxt</code></td>
<td>
<p>a string indicating the x-axis style; use <code>"n"</code> to
suppress and see also <code><a href="#topic+par">par</a>("xaxt")</code>.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_frame.plot">frame.plot</code></td>
<td>
<p>a logical indicating whether a box should be drawn
around the plot.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_log">log</code></td>
<td>
<p>a character string indicating if one or the other axis should
be logarithmic, see <code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_cex">cex</code></td>
<td>
<p>the character size to be used.  Setting <code>cex</code>
to a value smaller than one can be a useful way of avoiding label
overlap.  Unlike many other graphics functions, this sets the actual
size, not a multiple of <code>par("cex")</code>.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_pt.cex">pt.cex</code></td>
<td>
<p>the <code>cex</code> to be applied to plotting symbols.
This behaves like <code>cex</code> in <code>plot()</code>.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_pch">pch</code></td>
<td>
<p>the plotting character or symbol to be used.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_gpch">gpch</code></td>
<td>
<p>the plotting character or symbol to be used for group
values.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_bg">bg</code></td>
<td>
<p>the background color of plotting characters or symbols to be
used; use <code><a href="#topic+par">par</a>(bg= *)</code> to set the background color of
the whole plot.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_color">color</code></td>
<td>
<p>the color(s) to be used for points and labels.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_gcolor">gcolor</code></td>
<td>
<p>the single color to be used for group labels and
values.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_lcolor">lcolor</code></td>
<td>
<p>the color(s) to be used for the horizontal lines.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_xlim">xlim</code></td>
<td>
<p>horizontal range for the plot, see
<code><a href="#topic+plot.window">plot.window</a></code>, for example.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_main">main</code></td>
<td>
<p>overall title for the plot, see <code><a href="#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_xlab">xlab</code>, <code id="dotchart_+3A_ylab">ylab</code></td>
<td>
<p>axis annotations as in <code>title</code>.</p>
</td></tr>
<tr><td><code id="dotchart_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> can also be specified as arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function is invoked for its side effect, which is to produce two
variants of dotplots as described in Cleveland (1985).
</p>
<p>Dot plots are a reasonable substitute for bar plots.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Cleveland, W. S. (1985)
<em>The Elements of Graphing Data.</em>
Monterey, CA: Wadsworth.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dotchart(VADeaths, main = "Death Rates in Virginia - 1940")

op &lt;- par(xaxs = "i")  # 0 -- 100%
dotchart(t(VADeaths), xlim = c(0,100), bg = "skyblue",
         main = "Death Rates in Virginia - 1940", xlab = "rate [ % ]",
         ylab = "Grouping:  Age  x   Urbanity . Gender")
par(op)
</code></pre>

<hr>
<h2 id='filled.contour'>Level (Contour) Plots</h2><span id='topic+filled.contour'></span><span id='topic+.filled.contour'></span>

<h3>Description</h3>

<p>This function produces a contour plot with the areas between the
contours filled in solid color (Cleveland calls this a level plot).  A
key showing how the colors map to z values is shown to the right of
the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filled.contour(x = seq(0, 1, length.out = nrow(z)),
               y = seq(0, 1, length.out = ncol(z)),
               z,
               xlim = range(x, finite = TRUE),
               ylim = range(y, finite = TRUE),
               zlim = range(z, finite = TRUE),
               levels = pretty(zlim, nlevels), nlevels = 20,
               color.palette = function(n) hcl.colors(n, "YlOrRd", rev = TRUE),
               col = color.palette(length(levels) - 1),
               plot.title, plot.axes, key.title, key.axes, key.border = NULL,
               asp = NA, xaxs = "i", yaxs = "i", las = 1,
               axes = TRUE, frame.plot = axes, ...)

.filled.contour(x, y, z, levels, col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filled.contour_+3A_x">x</code>, <code id="filled.contour_+3A_y">y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are
measured.  These must be in ascending order.  (The rest of this
description does not apply to <code>.filled.contour</code>.)
By default, equally spaced values from 0 to 1 are used.  If <code>x</code>
is a <code>list</code>, its components <code>x$x</code> and <code>x$y</code> are used
for <code>x</code> and <code>y</code>, respectively.  If the list has component
<code>z</code> this is used for <code>z</code>.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_z">z</code></td>
<td>
<p>a numeric matrix containing the values to be plotted..  Note that
<code>x</code> can be used instead of <code>z</code> for convenience.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_xlim">xlim</code></td>
<td>
<p>x limits for the plot.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_ylim">ylim</code></td>
<td>
<p>y limits for the plot.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_zlim">zlim</code></td>
<td>
<p>z limits for the plot.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_levels">levels</code></td>
<td>
<p>a set of levels which are used to partition the range
of <code>z</code>.  Must be <b>strictly</b> increasing (and finite).  Areas
with <code>z</code> values between consecutive levels are painted with the
same color.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_nlevels">nlevels</code></td>
<td>
<p>if <code>levels</code> is not specified, the range of <code>z</code>,
values is divided into approximately this many levels.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_color.palette">color.palette</code></td>
<td>
<p>a color palette function to be used to assign
colors in the plot.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_col">col</code></td>
<td>
<p>an explicit set of colors to be used in the plot.
This argument overrides any palette function specification.  There
should be one less color than levels</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_plot.title">plot.title</code></td>
<td>
<p>statements which add titles to the main plot.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_plot.axes">plot.axes</code></td>
<td>
<p>statements which draw axes (and a <code><a href="#topic+box">box</a></code>)
on the main plot.  This overrides the default axes.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_key.title">key.title</code></td>
<td>
<p>statements which add titles for the plot key.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_key.axes">key.axes</code></td>
<td>
<p>statements which draw axes on the plot key.
This overrides the default axis.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_key.border">key.border</code></td>
<td>
<p>color for the border of the key <code><a href="#topic+rect">rect</a>()</code>angles.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_asp">asp</code></td>
<td>
<p>the <code class="reqn">y/x</code> aspect ratio, see <code><a href="#topic+plot.window">plot.window</a></code>.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_xaxs">xaxs</code></td>
<td>
<p>the x axis style.  The default is to use internal
labeling.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_yaxs">yaxs</code></td>
<td>
<p>the y axis style.  The default is to use internal
labeling.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_las">las</code></td>
<td>
<p>the style of labeling to be used.  The default is to
use horizontal labeling.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_axes">axes</code>, <code id="filled.contour_+3A_frame.plot">frame.plot</code></td>
<td>
<p>logicals indicating if axes and a box should be
drawn, as in <code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="filled.contour_+3A_...">...</code></td>
<td>
<p>additional <a href="#topic+graphical+20parameters">graphical parameters</a>, currently only passed to
<code><a href="#topic+title">title</a>()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values to be plotted can contain <code>NA</code>s.  Rectangles with two
or more corner values are <code>NA</code> are omitted entirely: where there
is a single <code>NA</code> value the triangle opposite the <code>NA</code> is
omitted.
</p>
<p>Values to be plotted can be infinite: the effect is similar to that
described for <code>NA</code> values.
</p>
<p><code>.filled.contour</code> is a &lsquo;bare bones&rsquo; interface to add
just the contour plot to an already-set-up plot region.  It is is
intended for programmatic use, and the programmer is
responsible for checking the conditions on the arguments.
</p>


<h3>Note</h3>

<p><code>filled.contour</code> uses the <code><a href="#topic+layout">layout</a></code> function and so is
restricted to a full page display.
</p>
<p>The output produced by <code>filled.contour</code> is actually a combination
of two plots; one is the filled contour and one is the legend.  Two
separate coordinate systems are set up for these two plots, but they
are only used internally &ndash; once the function has returned these
coordinate systems are lost.  If you want to annotate the main contour
plot, for example to add points, you can specify graphics commands in
the <code>plot.axes</code> argument.  See the examples.
</p>


<h3>Author(s)</h3>

<p>Ross Ihaka and R Core Team</p>


<h3>References</h3>

<p>Cleveland, W. S. (1993)
<em>Visualizing Data</em>.
Summit, New Jersey: Hobart.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+contour">contour</a></code>, <code><a href="#topic+image">image</a></code>,
<code><a href="grDevices.html#topic+hcl.colors">hcl.colors</a></code>, <code><a href="grDevices.html#topic+gray.colors">gray.colors</a></code>,
<code><a href="grDevices.html#topic+palette">palette</a></code>; <code><a href="lattice.html#topic+levelplot">contourplot</a></code>
and <code><a href="lattice.html#topic+levelplot">levelplot</a></code> from package <a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("grDevices") # for colours
filled.contour(volcano, asp = 1) # simple

x &lt;- 10*1:nrow(volcano)
y &lt;- 10*1:ncol(volcano)
filled.contour(x, y, volcano,
    color.palette = function(n) hcl.colors(n, "terrain"),
    plot.title = title(main = "The Topography of Maunga Whau",
    xlab = "Meters North", ylab = "Meters West"),
    plot.axes = { axis(1, seq(100, 800, by = 100))
                  axis(2, seq(100, 600, by = 100)) },
    key.title = title(main = "Height\n(meters)"),
    key.axes = axis(4, seq(90, 190, by = 10)))  # maybe also asp = 1
mtext(paste("filled.contour(.) from", R.version.string),
      side = 1, line = 4, adj = 1, cex = .66)

# Annotating a filled contour plot
a &lt;- expand.grid(1:20, 1:20)
b &lt;- matrix(a[,1] + a[,2], 20)
filled.contour(x = 1:20, y = 1:20, z = b,
               plot.axes = { axis(1); axis(2); points(10, 10) })

## Persian Rug Art:
x &lt;- y &lt;- seq(-4*pi, 4*pi, length.out = 27)
r &lt;- sqrt(outer(x^2, y^2, `+`))
## "minimal"
filled.contour(cos(r^2)*exp(-r/(2*pi)), axes = FALSE, key.border=NA)
## rather, the key *should* be labeled (but axes still not):
filled.contour(cos(r^2)*exp(-r/(2*pi)), frame.plot = FALSE,
               plot.axes = {})
</code></pre>

<hr>
<h2 id='fourfoldplot'>Fourfold Plots</h2><span id='topic+fourfoldplot'></span>

<h3>Description</h3>

<p>Creates a fourfold display of a 2 by 2 by <code class="reqn">k</code> contingency table on
the current graphics device, allowing for the visual inspection of the
association between two dichotomous variables in one or several
populations (strata).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fourfoldplot(x, color = c("#99CCFF", "#6699CC"),
             conf.level = 0.95,
             std = c("margins", "ind.max", "all.max"),
             margin = c(1, 2), space = 0.2, main = NULL,
             mfrow = NULL, mfcol = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fourfoldplot_+3A_x">x</code></td>
<td>
<p>a 2 by 2 by <code class="reqn">k</code> contingency table in array form, or as a
2 by 2 matrix if <code class="reqn">k</code> is 1.</p>
</td></tr>
<tr><td><code id="fourfoldplot_+3A_color">color</code></td>
<td>
<p>a vector of length 2 specifying the colors to use for the
smaller and larger diagonals of each 2 by 2 table.</p>
</td></tr>
<tr><td><code id="fourfoldplot_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level used for the confidence rings on
the odds ratios.  Must be a single nonnegative number less than 1;
if set to 0, confidence rings are suppressed.</p>
</td></tr>
<tr><td><code id="fourfoldplot_+3A_std">std</code></td>
<td>
<p>a character string specifying how to standardize the table.
Must match one of <code>"margins"</code>, <code>"ind.max"</code>, or
<code>"all.max"</code>, and can be abbreviated to the initial letter.
If set to <code>"margins"</code>, each 2 by 2 table is standardized to
equate the margins specified by <code>margin</code> while preserving the
odds ratio.  If <code>"ind.max"</code> or <code>"all.max"</code>, the tables are
either individually or simultaneously standardized to a maximal cell
frequency of 1.</p>
</td></tr>
<tr><td><code id="fourfoldplot_+3A_margin">margin</code></td>
<td>
<p>a numeric vector with the margins to equate.  Must be
one of <code>1</code>, <code>2</code>, or <code>c(1, 2)</code> (the default), which
corresponds to standardizing the row, column, or both margins in
each 2 by 2 table.
Only used if <code>std</code> equals <code>"margins"</code>.</p>
</td></tr>
<tr><td><code id="fourfoldplot_+3A_space">space</code></td>
<td>
<p>the amount of space (as a fraction of the maximal radius
of the quarter circles) used for the row and column labels.</p>
</td></tr>
<tr><td><code id="fourfoldplot_+3A_main">main</code></td>
<td>
<p>character string for the fourfold title.</p>
</td></tr>
<tr><td><code id="fourfoldplot_+3A_mfrow">mfrow</code></td>
<td>
<p>a numeric vector of the form <code>c(nr, nc)</code>, indicating
that the displays for the 2 by 2 tables should be arranged in an
<code>nr</code> by <code>nc</code> layout, filled by rows.</p>
</td></tr>
<tr><td><code id="fourfoldplot_+3A_mfcol">mfcol</code></td>
<td>
<p>a numeric vector of the form <code>c(nr, nc)</code>, indicating
that the displays for the 2 by 2 tables should be arranged in an
<code>nr</code> by <code>nc</code> layout, filled by columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fourfold display is designed for the display of 2 by 2 by <code class="reqn">k</code>
tables.
</p>
<p>Following suitable standardization, the cell frequencies
<code class="reqn">f_{ij}</code> of each 2 by 2 table are shown as a quarter
circle whose radius is proportional to
<code class="reqn">\sqrt{f_{ij}}</code> so that its area is proportional to
the cell frequency.  An association (odds ratio different from 1)
between the binary row and column variables is indicated by the
tendency of diagonally opposite cells in one direction to differ in
size from those in the other direction; color is used to show this
direction.  Confidence rings for the odds ratio allow a visual test of
the null of no association; the rings for adjacent quadrants overlap
if and only if the observed counts are consistent with the null hypothesis.
</p>
<p>Typically, the number <code class="reqn">k</code> corresponds to the number of levels of a
stratifying variable, and it is of interest to see whether the
association is homogeneous across strata.  The fourfold display
visualizes the pattern of association.  Note that the confidence rings
for the individual odds ratios are not adjusted for multiple testing.
</p>


<h3>References</h3>

<p>Friendly, M. (1994).
A fourfold display for 2 by 2 by <code class="reqn">k</code> tables.
Technical Report 217, York University, Psychology Department.
<a href="http://datavis.ca/papers/4fold/4fold.pdf">http://datavis.ca/papers/4fold/4fold.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mosaicplot">mosaicplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Use the Berkeley admission data as in Friendly (1995).
x &lt;- aperm(UCBAdmissions, c(2, 1, 3))
dimnames(x)[[2]] &lt;- c("Yes", "No")
names(dimnames(x)) &lt;- c("Sex", "Admit?", "Department")
stats::ftable(x)

## Fourfold display of data aggregated over departments, with
## frequencies standardized to equate the margins for admission
## and sex.
## Figure 1 in Friendly (1994).
fourfoldplot(marginSums(x, c(1, 2)))

## Fourfold display of x, with frequencies in each table
## standardized to equate the margins for admission and sex.
## Figure 2 in Friendly (1994).
fourfoldplot(x)

## Fourfold display of x, with frequencies in each table
## standardized to equate the margins for admission. but not
## for sex.
## Figure 3 in Friendly (1994).
fourfoldplot(x, margin = 2)
</code></pre>

<hr>
<h2 id='frame'>Create / Start a New Plot Frame</h2><span id='topic+plot.new'></span><span id='topic+frame'></span>

<h3>Description</h3>

<p>This function (<code>frame</code> is an alias for
<code>plot.new</code>) causes the completion of plotting in the current plot
(if there is one) and an advance to a new graphics frame.  This is
used in all high-level plotting functions and also useful for skipping
plots when a multi-figure region is in use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot.new()
frame()
</code></pre>


<h3>Details</h3>

<p>The new page is painted with the background colour
(<code><a href="#topic+par">par</a>("bg")</code>), which is often transparent.  For devices
with a <em>canvas</em> colour (the on-screen devices <code>X11</code>,
<code>windows</code> and <code>quartz</code>), the window is first painted with the
canvas colour and then the background colour.
</p>
<p>There are two hooks called <code>"before.plot.new"</code> and
<code>"plot.new"</code> (see <code><a href="base.html#topic+setHook">setHook</a></code>) called immediately
before and after advancing the frame. The latter is used
in the testing code to annotate the new page. The hook function(s) are
called with no argument.  (If the value is a character string,
<code>get</code> is called on it from within the <span class="pkg">graphics</span> namespace.)
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole. (<code>frame</code>.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.window">plot.window</a></code>, <code><a href="#topic+plot.default">plot.default</a></code>.
</p>

<hr>
<h2 id='graphics-defunct'>Defunct Functions in Package <span class="pkg">graphics</span></h2><span id='topic+graphics-defunct'></span><span id='topic+dotplot'></span><span id='topic+stripplot'></span><span id='topic+piechart'></span>

<h3>Description</h3>

<p>The functions or variables listed here are no longer part of <span class="rlang"><b>R</b></span> as
they are not needed (any more).
</p>


<h3>Usage</h3>

<pre><code class='language-R'># Defunct in 1.3.0
dotplot(...)
stripplot(...)

# Defunct in 1.6.0
piechart(x, labels = names(x), edges = 200, radius = 0.8,
         density = NULL, angle = 45, col = NULL, main = NULL, ...)
</code></pre>


<h3>Details</h3>

<p><code>dotplot</code> and <code>stripplot</code> have been renamed to
<code><a href="#topic+dotchart">dotchart</a></code> and <code><a href="#topic+stripchart">stripchart</a></code>,
respectively.  The names are now used in <a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a>.
</p>
<p><code>piechart</code> was the old name for <code>pie</code>, but clashed with usage
in Trellis (not implemented in <a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a>).
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+Defunct">Defunct</a></code>
</p>

<hr>
<h2 id='grid'>Add Grid to a Plot</h2><span id='topic+grid'></span>

<h3>Description</h3>

<p><code>grid</code> adds an <code>nx</code> by <code>ny</code> rectangular grid to an
existing plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid(nx = NULL, ny = nx, col = "lightgray", lty = "dotted",
     lwd = par("lwd"), equilogs = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid_+3A_nx">nx</code>, <code id="grid_+3A_ny">ny</code></td>
<td>
<p>number of cells of the grid in x and y direction.  When
<code>NULL</code>, as per default, the grid aligns with the tick marks on
the corresponding <em>default</em> axis (i.e., tickmarks as computed by
<code><a href="#topic+axTicks">axTicks</a></code>).  When <code><a href="base.html#topic+NA">NA</a></code>, no grid lines are
drawn in the corresponding direction.</p>
</td></tr>
<tr><td><code id="grid_+3A_col">col</code></td>
<td>
<p>character or (integer) numeric; color of the grid lines.</p>
</td></tr>
<tr><td><code id="grid_+3A_lty">lty</code></td>
<td>
<p>character or (integer) numeric; line type of the grid lines.</p>
</td></tr>
<tr><td><code id="grid_+3A_lwd">lwd</code></td>
<td>
<p>non-negative numeric giving line width of the grid lines.</p>
</td></tr>
<tr><td><code id="grid_+3A_equilogs">equilogs</code></td>
<td>
<p>logical, only used when <em>log</em> coordinates and
alignment with the axis tick marks are active.  Setting <code>equilogs =
      FALSE</code> in that case gives <em>non equidistant</em> tick aligned
grid lines.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If more fine tuning is required, use <code><a href="#topic+abline">abline</a>(h = ., v = .)</code>
directly.
</p>


<h3>References</h3>

<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+abline">abline</a></code>, <code><a href="#topic+lines">lines</a></code>,
<code><a href="#topic+points">points</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1:3)
grid(NA, 5, lwd = 2) # grid only in y-direction

## maybe change the desired number of tick marks:  par(lab = c(mx, my, 7))
op &lt;- par(mfcol = 1:2)
with(iris,
     {
     plot(Sepal.Length, Sepal.Width, col = as.integer(Species),
          xlim = c(4, 8), ylim = c(2, 4.5), panel.first = grid(),
          main = "with(iris,  plot(...., panel.first = grid(), ..) )")
     plot(Sepal.Length, Sepal.Width, col = as.integer(Species),
          panel.first = grid(3, lty = 1, lwd = 2),
          main = "... panel.first = grid(3, lty = 1, lwd = 2), ..")
     }
    )
par(op)

plot(1:64)
gr &lt;- grid() # now *invisibly* returns the grid "at" locations
str(gr)
stopifnot(length(gr) == 2, identical(gr[[1]], gr[[2]]),
          gr[["atx"]] == 10*(0:6))

## In log-scale plots :
plot(8:270, log="xy") ; grid() # at (1, 10, 100); if preferring "all" grid lines:
plot(8:270, log="xy") ; grid(equilogs = FALSE) -&gt; grll
stopifnot(identical(grll, list(atx = c(1, 2, 5, 10, 20, 50, 100, 200),
                               aty = c(         10, 20, 50, 100, 200))))
</code></pre>

<hr>
<h2 id='hist'>Histograms</h2><span id='topic+hist'></span><span id='topic+hist.default'></span>

<h3>Description</h3>

<p>The generic function <code>hist</code> computes a histogram of the given
data values.  If <code>plot = TRUE</code>, the resulting object of
<a href="base.html#topic+class">class</a> <code>"histogram"</code> is plotted by
<code><a href="#topic+plot.histogram">plot.histogram</a></code>, before it is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hist(x, ...)

## Default S3 method:
hist(x, breaks = "Sturges",
     freq = NULL, probability = !freq,
     include.lowest = TRUE, right = TRUE, fuzz = 1e-7,
     density = NULL, angle = 45, col = "lightgray", border = NULL,
     main = paste("Histogram of" , xname),
     xlim = range(breaks), ylim = NULL,
     xlab = xname, ylab,
     axes = TRUE, plot = TRUE, labels = FALSE,
     nclass = NULL, warn.unused = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist_+3A_x">x</code></td>
<td>
<p>a vector of values for which the histogram is desired.</p>
</td></tr>
<tr><td><code id="hist_+3A_breaks">breaks</code></td>
<td>
<p>one of:
</p>

<ul>
<li><p> a vector giving the breakpoints between histogram cells,
</p>
</li>
<li><p> a function to compute the vector of breakpoints,
</p>
</li>
<li><p> a single number giving the number of cells for the histogram,
</p>
</li>
<li><p> a character string naming an algorithm to compute the
number of cells (see &lsquo;Details&rsquo;),
</p>
</li>
<li><p> a function to compute the number of cells.
</p>
</li></ul>

<p>In the last three cases the number is a suggestion only; as the
breakpoints will be set to <code><a href="base.html#topic+pretty">pretty</a></code> values, the number
is limited to <code>1e6</code> (with a warning if it was larger).  If
<code>breaks</code> is a function, the <code>x</code> vector is supplied to it
as the only argument (and the number of breaks is only limited by
the amount of available memory).
</p>
</td></tr>
<tr><td><code id="hist_+3A_freq">freq</code></td>
<td>
<p>logical; if <code>TRUE</code>, the histogram graphic is a
representation of frequencies, the <code>counts</code> component of
the result; if <code>FALSE</code>, probability densities, component
<code>density</code>, are plotted (so that the histogram has a total area
of one).  Defaults to <code>TRUE</code> <em>if and only if</em> <code>breaks</code> are
equidistant (and <code>probability</code> is not specified).</p>
</td></tr>
<tr><td><code id="hist_+3A_probability">probability</code></td>
<td>
<p>an <em>alias</em> for <code>!freq</code>, for S compatibility.</p>
</td></tr>
<tr><td><code id="hist_+3A_include.lowest">include.lowest</code></td>
<td>
<p>logical; if <code>TRUE</code>, an <code>x[i]</code> equal to
the <code>breaks</code> value will be included in the first (or last, for
<code>right = FALSE</code>) bar.  This will be ignored (with a warning)
unless <code>breaks</code> is a vector.</p>
</td></tr>
<tr><td><code id="hist_+3A_right">right</code></td>
<td>
<p>logical; if <code>TRUE</code>, the histogram cells are
right-closed (left open) intervals.</p>
</td></tr>
<tr><td><code id="hist_+3A_fuzz">fuzz</code></td>
<td>
<p>non-negative number, for the case when the data is
&ldquo;pretty&rdquo; and some observations <code>x[.]</code> are close but not
exactly on a <code>break</code>.  For counting fuzzy breaks proportional
to <code>fuzz</code> are used.  The default is occasionally suboptimal.</p>
</td></tr>
<tr><td><code id="hist_+3A_density">density</code></td>
<td>
<p>the density of shading lines, in lines per inch.
The default value of <code>NULL</code> means that no shading lines
are drawn. Non-positive values of <code>density</code> also inhibit the
drawing of shading lines.</p>
</td></tr>
<tr><td><code id="hist_+3A_angle">angle</code></td>
<td>
<p>the slope of shading lines, given as an angle in
degrees (counter-clockwise).</p>
</td></tr>
<tr><td><code id="hist_+3A_col">col</code></td>
<td>
<p>a colour to be used to fill the bars.</p>
</td></tr>
<tr><td><code id="hist_+3A_border">border</code></td>
<td>
<p>the color of the border around the bars.  The default
is to use the standard foreground color.</p>
</td></tr>
<tr><td><code id="hist_+3A_main">main</code>, <code id="hist_+3A_xlab">xlab</code>, <code id="hist_+3A_ylab">ylab</code></td>
<td>
<p>main title and axis labels: these arguments to
<code><a href="#topic+title">title</a>()</code> get &ldquo;smart&rdquo; defaults here, e.g., the default
<code>ylab</code> is <code>"Frequency"</code> iff <code>freq</code> is true.</p>
</td></tr>
<tr><td><code id="hist_+3A_xlim">xlim</code>, <code id="hist_+3A_ylim">ylim</code></td>
<td>
<p>the range of x and y values with sensible defaults.
Note that <code>xlim</code> is <em>not</em> used to define the histogram (breaks),
but only for plotting (when <code>plot = TRUE</code>).</p>
</td></tr>
<tr><td><code id="hist_+3A_axes">axes</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), axes are draw if the
plot is drawn.</p>
</td></tr>
<tr><td><code id="hist_+3A_plot">plot</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), a histogram is
plotted, otherwise a list of breaks and counts is returned.  In the
latter case, a warning is used if (typically graphical) arguments
are specified that only apply to the <code>plot = TRUE</code> case.</p>
</td></tr>
<tr><td><code id="hist_+3A_labels">labels</code></td>
<td>
<p>logical or character string.  Additionally draw labels on top
of bars, if not <code>FALSE</code>; see <code><a href="#topic+plot.histogram">plot.histogram</a></code>.</p>
</td></tr>
<tr><td><code id="hist_+3A_nclass">nclass</code></td>
<td>
<p>numeric (integer).  For S(-PLUS) compatibility only,
<code>nclass</code> is equivalent to <code>breaks</code> for a scalar or
character argument.</p>
</td></tr>
<tr><td><code id="hist_+3A_warn.unused">warn.unused</code></td>
<td>
<p>logical.  If <code>plot = FALSE</code> and
<code>warn.unused = TRUE</code>, a warning will be issued when graphical
parameters are passed to <code>hist.default()</code>.</p>
</td></tr>
<tr><td><code id="hist_+3A_...">...</code></td>
<td>
<p>further arguments and <a href="#topic+graphical+20parameters">graphical parameters</a> passed to
<code><a href="#topic+plot.histogram">plot.histogram</a></code> and thence to <code><a href="#topic+title">title</a></code> and
<code><a href="#topic+axis">axis</a></code> (if <code>plot = TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The definition of <em>histogram</em> differs by source (with
country-specific biases).  <span class="rlang"><b>R</b></span>'s default with equispaced breaks (also
the default) is to plot the counts in the cells defined by
<code>breaks</code>.  Thus the height of a rectangle is proportional to
the number of points falling into the cell, as is the area
<em>provided</em> the breaks are equally-spaced.
</p>
<p>The default with non-equispaced breaks is to give
a plot of area one, in which the <em>area</em> of the rectangles is the
fraction of the data points falling in the cells.
</p>
<p>If <code>right = TRUE</code> (default), the histogram cells are intervals
of the form <code class="reqn">(a, b]</code>, i.e., they include their right-hand endpoint,
but not their left one, with the exception of the first cell when
<code>include.lowest</code> is <code>TRUE</code>.
</p>
<p>For <code>right = FALSE</code>, the intervals are of the form <code class="reqn">[a, b)</code>,
and <code>include.lowest</code> means &lsquo;<em>include highest</em>&rsquo;.
</p>
<p>A numerical tolerance of <code class="reqn">10^{-7}</code> times the median bin size
(for more than four bins, otherwise the median is substituted) is
applied when counting entries on the edges of bins.  This is not
included in the reported <code>breaks</code> nor in the calculation of
<code>density</code>.
</p>
<p>The default for <code>breaks</code> is <code>"Sturges"</code>: see
<code><a href="grDevices.html#topic+nclass.Sturges">nclass.Sturges</a></code>.  Other names for which algorithms
are supplied are <code>"Scott"</code> and <code>"FD"</code> /
<code>"Freedman-Diaconis"</code> (with corresponding functions
<code><a href="grDevices.html#topic+nclass.scott">nclass.scott</a></code> and <code><a href="grDevices.html#topic+nclass.FD">nclass.FD</a></code>).
Case is ignored and partial matching is used.
Alternatively, a function can be supplied which
will compute the intended number of breaks or the actual breakpoints
as a function of <code>x</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>"histogram"</code> which is a list with components:
</p>
<table>
<tr><td><code>breaks</code></td>
<td>
<p>the <code class="reqn">n+1</code> cell boundaries (= <code>breaks</code> if that
was a vector). These are the nominal breaks, not with the boundary fuzz.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p><code class="reqn">n</code> integers; for each cell, the number of
<code>x[]</code> inside.</p>
</td></tr>
<tr><td><code>density</code></td>
<td>
<p>values <code class="reqn">\hat f(x_i)</code>, as estimated
density values. If <code>all(diff(breaks) == 1)</code>, they are the
relative frequencies <code>counts/n</code> and in general satisfy
<code class="reqn">\sum_i \hat f(x_i) (b_{i+1}-b_i) = 1</code>, where <code class="reqn">b_i</code> = <code>breaks[i]</code>.</p>
</td></tr>
<tr><td><code>mids</code></td>
<td>
<p>the <code class="reqn">n</code> cell midpoints.</p>
</td></tr>
<tr><td><code>xname</code></td>
<td>
<p>a character string with the actual <code>x</code> argument name.</p>
</td></tr>
<tr><td><code>equidist</code></td>
<td>
<p>logical, indicating if the distances between
<code>breaks</code> are all the same.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Venables, W. N. and Ripley. B. D. (2002)
<em>Modern Applied Statistics with S</em>.  Springer.
</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+nclass.Sturges">nclass.Sturges</a></code>, <code><a href="#topic+stem">stem</a></code>,
<code><a href="stats.html#topic+density">density</a></code>,  <code><a href="MASS.html#topic+truehist">truehist</a></code> in package
<a href="https://CRAN.R-project.org/package=MASS"><span class="pkg">MASS</span></a>.
</p>
<p>Typical plots with vertical bars are <em>not</em> histograms.  Consider
<code><a href="#topic+barplot">barplot</a></code> or <code><a href="#topic+plot">plot</a>(*, type = "h")</code>
for such bar plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>op &lt;- par(mfrow = c(2, 2))
hist(islands)
utils::str(hist(islands, col = "gray", labels = TRUE))

hist(sqrt(islands), breaks = 12, col = "lightblue", border = "pink")
##-- For non-equidistant breaks, counts should NOT be graphed unscaled:
r &lt;- hist(sqrt(islands), breaks = c(4*0:5, 10*3:5, 70, 100, 140),
          col = "blue1")
text(r$mids, r$density, r$counts, adj = c(.5, -.5), col = "blue3")
sapply(r[2:3], sum)
sum(r$density * diff(r$breaks)) # == 1
lines(r, lty = 3, border = "purple") # -&gt; lines.histogram(*)
par(op)

require(utils) # for str
str(hist(islands, breaks = 12, plot =  FALSE)) #-&gt; 10 (~= 12) breaks
str(hist(islands, breaks = c(12,20,36,80,200,1000,17000), plot = FALSE))

hist(islands, breaks = c(12,20,36,80,200,1000,17000), freq = TRUE,
     main = "WRONG histogram") # and warning

## Extreme outliers; the "FD" rule would take very large number of 'breaks':
XXL &lt;- c(1:9, c(-1,1)*1e300)
hh &lt;- hist(XXL, "FD") # did not work in R &lt;= 3.4.1; now gives warning
## pretty() determines how many counts are used (platform dependently!):
length(hh$breaks) ## typically 1 million -- though 1e6 was "a suggestion only"

## R &gt;= 4.2.0: no "*.5" labels on y-axis:
hist(c(2,3,3,5,5,6,6,6,7))

require(stats)
set.seed(14)
x &lt;- rchisq(100, df = 4)

## Histogram with custom x-axis:
hist(x, xaxt = "n")
axis(1, at = 0:17)


## Comparing data with a model distribution should be done with qqplot()!
qqplot(x, qchisq(ppoints(x), df = 4)); abline(0, 1, col = 2, lty = 2)

## if you really insist on using hist() ... :
hist(x, freq = FALSE, ylim = c(0, 0.2))
curve(dchisq(x, df = 4), col = 2, lty = 2, lwd = 2, add = TRUE)

</code></pre>

<hr>
<h2 id='hist.POSIXt'>Histogram of a Date or Date-Time Object</h2><span id='topic+hist.POSIXt'></span><span id='topic+hist.Date'></span>

<h3>Description</h3>

<p>Methods for <code><a href="#topic+hist">hist</a></code> applied to date (class <code>"<a href="base.html#topic+Date">Date</a>"</code>)
or date-time (class  <code>"<a href="base.html#topic+POSIXt">POSIXt</a>"</code>) objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POSIXt'
hist(x, breaks, ...,
     xlab = deparse1(substitute(x)),
     plot = TRUE, freq = FALSE,
     start.on.monday = TRUE, format, right = TRUE)

## S3 method for class 'Date'
hist(x, breaks, ...,
     xlab = deparse1(substitute(x)),
     plot = TRUE, freq = FALSE,
     start.on.monday = TRUE, format, right = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist.POSIXt_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>"<a href="base.html#topic+POSIXt">POSIXt</a>"</code>
or <code>"<a href="base.html#topic+Date">Date</a>"</code>.</p>
</td></tr>
<tr><td><code id="hist.POSIXt_+3A_breaks">breaks</code></td>
<td>

<p>a vector of cut points <em>or</em> number giving the number of
intervals which <code>x</code> is to be cut into <em>or</em> an
interval specification, one of <code>"days"</code>, <code>"weeks"</code>,
<code>"months"</code>, <code>"quarters"</code> or <code>"years"</code>,
plus <code>"secs"</code>, <code>"mins"</code>, <code>"hours"</code> for
date-time objects.
</p>
</td></tr>
<tr><td><code id="hist.POSIXt_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a>, or arguments to
<code><a href="#topic+hist.default">hist.default</a></code> such as <code>include.lowest</code>,
<code>density</code> and <code>labels</code>.</p>
</td></tr>
<tr><td><code id="hist.POSIXt_+3A_xlab">xlab</code></td>
<td>
<p>a character string giving the label for the x axis, if plotted.</p>
</td></tr>
<tr><td><code id="hist.POSIXt_+3A_plot">plot</code></td>
<td>
<p>logical.  If <code>TRUE</code> (default), a histogram is
plotted, otherwise a list of breaks and counts is returned.</p>
</td></tr>
<tr><td><code id="hist.POSIXt_+3A_freq">freq</code></td>
<td>
<p>logical; if <code>TRUE</code>, the
histogram graphic is a representation of frequencies, i.e,
the <code>counts</code> component of the result; if <code>FALSE</code>,
<em>relative</em> frequencies (probabilities) are plotted.</p>
</td></tr>
<tr><td><code id="hist.POSIXt_+3A_start.on.monday">start.on.monday</code></td>
<td>
<p>logical. If <code>breaks = "weeks"</code>, should the
week start on Mondays or Sundays?</p>
</td></tr>
<tr><td><code id="hist.POSIXt_+3A_format">format</code></td>
<td>
<p>for the x-axis labels. See <code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="hist.POSIXt_+3A_right">right</code></td>
<td>
<p>logical; if <code>TRUE</code>, the histogram cells are
right-closed (left open) intervals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that unlike the default method, <code>breaks</code> is a required argument.
</p>
<p>Using <code>breaks = "quarters"</code> will create intervals of 3 calendar
months, with the intervals beginning on January 1, April 1,
July 1 or October 1, based upon <code>min(x)</code> as appropriate.
</p>
<p>With the default <code>right = TRUE</code>, breaks will be set
on the last day of the previous period when <code>breaks</code> is
<code>"months"</code>, <code>"quarters"</code> or <code>"years"</code>.  Use
<code>right = FALSE</code> to set them to the first day of the
interval shown in each bar.
</p>


<h3>Value</h3>

<p>An object of class <code>"histogram"</code>: see <code><a href="#topic+hist">hist</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+seq.POSIXt">seq.POSIXt</a></code>, <code><a href="#topic+axis.POSIXct">axis.POSIXct</a></code>, <code><a href="#topic+hist">hist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hist(.leap.seconds, "years", freq = TRUE)
brks &lt;- seq(ISOdate(1970, 1, 1), ISOdate(2030, 1, 1), "5 years")
hist(.leap.seconds, brks)
rug(.leap.seconds, lwd=2)
## show that  'include.lowest' "works"
stopifnot(identical(c(2L, rep(1L,11)),
   hist(brks, brks, plot=FALSE, include.lowest=TRUE )$counts))
tools::assertError(verbose=TRUE, ##--&gt; 'breaks' do not span range of 'x'
   hist(brks, brks, plot=FALSE, include.lowest=FALSE))
## The default fuzz in hist.default()  "kills" this, with a "wrong" message:
try ( hist(brks[-13] + 1, brks, include.lowest = FALSE) )
## and decreasing 'fuzz' solves the issue:
hb &lt;- hist(brks[-13] + 1, brks, include.lowest = FALSE, fuzz = 1e-10)
stopifnot(hb$counts == 1)

## 100 random dates in a 10-week period
random.dates &lt;- as.Date("2001/1/1") + 70*stats::runif(100)
hist(random.dates, "weeks", format = "%d %b")
</code></pre>

<hr>
<h2 id='identify'>Identify Points in a Scatter Plot</h2><span id='topic+identify'></span><span id='topic+identify.default'></span>

<h3>Description</h3>

<p><code>identify</code> reads the position of the graphics pointer when the
(first) mouse button is pressed.  It then searches the coordinates
given in <code>x</code> and <code>y</code> for the point closest to the pointer.
If this point is close enough to the pointer, its index will be returned as
part of the value of the call.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identify(x, ...)

## Default S3 method:
identify(x, y = NULL, labels = seq_along(x), pos = FALSE,
         n = length(x), plot = TRUE, atpen = FALSE, offset = 0.5,
         tolerance = 0.25, order = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="identify_+3A_x">x</code>, <code id="identify_+3A_y">y</code></td>
<td>
<p>coordinates of points in a scatter plot.  Alternatively, any
object which defines coordinates (a plotting structure, time
series etc: see <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>) can be given as <code>x</code>,
and <code>y</code> left missing.</p>
</td></tr>
<tr><td><code id="identify_+3A_labels">labels</code></td>
<td>
<p>an optional character vector giving labels for the
points.  Will be coerced using <code><a href="base.html#topic+as.character">as.character</a></code>, and
recycled if necessary to the length of <code>x</code>.  Excess labels will
be discarded, with a warning.</p>
</td></tr>
<tr><td><code id="identify_+3A_pos">pos</code></td>
<td>
<p>if <code>pos</code> is <code>TRUE</code>, a component is added to the
return value which indicates where text was plotted relative to each
identified point: see Value.</p>
</td></tr>
<tr><td><code id="identify_+3A_n">n</code></td>
<td>
<p>the maximum number of points to be identified.</p>
</td></tr>
<tr><td><code id="identify_+3A_plot">plot</code></td>
<td>
<p>logical: if <code>plot</code> is <code>TRUE</code>, the labels are
printed near the points and if <code>FALSE</code> they are omitted.</p>
</td></tr>
<tr><td><code id="identify_+3A_atpen">atpen</code></td>
<td>
<p>logical: if <code>TRUE</code> and <code>plot = TRUE</code>, the
lower-left corners of the labels are plotted at the points clicked
rather than relative to the points.</p>
</td></tr>
<tr><td><code id="identify_+3A_offset">offset</code></td>
<td>
<p>the distance (in character widths) which separates the
label from identified points.  Negative values are allowed.  Not
used if <code>atpen = TRUE</code>.</p>
</td></tr>
<tr><td><code id="identify_+3A_tolerance">tolerance</code></td>
<td>
<p>the maximal distance (in inches) for the pointer to be
&lsquo;close enough&rsquo; to a point.</p>
</td></tr>
<tr><td><code id="identify_+3A_order">order</code></td>
<td>
<p>if <code>order</code> is <code>TRUE</code>, a component is added to the
return value which indicates the order in which points were
identified: see Value.</p>
</td></tr>
<tr><td><code id="identify_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="#topic+par">par</a></code> such as
<code>cex</code>, <code>col</code> and <code>font</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>identify</code> is a generic function, and only the default method is
described here.
</p>
<p><code>identify</code> is only supported on screen devices such as
<code>X11</code>, <code>windows</code> and <code>quartz</code>.  On other devices the
call will do nothing.
</p>
<p>Clicking near (as defined by <code>tolerance</code>) a point adds it to the
list of identified points.  Points can be identified only once, and if
the point has already been identified or the click is not
near any of the points a message is printed immediately on
the <span class="rlang"><b>R</b></span> console.
</p>
<p>If <code>plot</code> is <code>TRUE</code>, the point is labelled with the
corresponding element of <code>labels</code>.  If <code>atpen</code> is false (the
default) the labels are placed below, to the left, above or to the
right of the identified point, depending on where the pointer was
relative to the point.  If <code>atpen</code> is true, the
labels are placed with the bottom left of the string's box at the
pointer.
</p>
<p>For the usual <code><a href="grDevices.html#topic+X11">X11</a></code> device the identification process is
terminated by pressing any mouse button other than the first.
For the <code><a href="grDevices.html#topic+quartz">quartz</a></code> device the process is terminated by
pressing either the pop-up menu equivalent (usually second mouse
button or <code>Ctrl</code>-click) or the <code>ESC</code> key.
</p>
<p>On most devices which support <code>identify</code>, successful selection of
a point is indicated by a bell sound unless
<code><a href="base.html#topic+options">options</a>(locatorBell = FALSE)</code> has been set.
</p>
<p>If the window is resized or hidden and then exposed before the identification
process has terminated, any labels drawn by <code>identify</code>
will disappear.  These will reappear once the identification process has
terminated and the window is resized or hidden and exposed again.
This is because the labels drawn by <code>identify</code> are not
recorded in the device's display list until the identification process has
terminated.
</p>
<p>If you interrupt the <code>identify</code> call this leaves the graphics
device in an undefined state, with points labelled but labels not
recorded in the display list.  Copying a device in that state
will give unpredictable results.
</p>


<h3>Value</h3>

<p>If both <code>pos</code> and <code>order</code> are <code>FALSE</code>,
an integer vector containing the
indices of the identified points.
</p>
<p>If either of <code>pos</code> or <code>order</code> is <code>TRUE</code>,
a list containing a component
<code>ind</code>, indicating which points were identified and (if
<code>pos</code> is <code>TRUE</code>) a component
<code>pos</code>, indicating where the labels were placed relative to the
identified points (1=below, 2=left, 3=above, 4=right and 0=no offset,
used if <code>atpen = TRUE</code>) and (if <code>order</code> is <code>TRUE</code>)
a component <code>order</code>, indicating the order in which points
were identified.
</p>


<h3>Technicalities</h3>

<p>The algorithm used for placing labels is the same as used by
<code>text</code> if <code>pos</code> is specified there, the difference being
that the position of the pointer relative the identified point
determines <code>pos</code> in <code>identify</code>.
</p>
<p>For labels placed to the left of a point, the right-hand edge of the
string's box is placed <code>offset</code> units to the left of the point,
and analogously for points to the right.  The baseline of the text is
placed below the point so as to approximately centre string vertically.
For labels placed above or below a point, the string is centered
horizontally on the point.  For labels placed above, the baseline of
the text is placed <code>offset</code> units above the point, and
for those placed below, the baseline is placed so that the top
of the string's box is approximately <code>offset</code> units below the
point.  If you want more precise placement (e.g., centering) use
<code>plot = FALSE</code> and plot via <code><a href="#topic+text">text</a></code> or
<code><a href="#topic+points">points</a></code>: see the examples.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+locator">locator</a></code>, <code><a href="#topic+text">text</a></code>.
</p>
<p><code><a href="grDevices.html#topic+dev.capabilities">dev.capabilities</a></code> to see if it is supported.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A function to use identify to select points, and overplot the
## points with another symbol as they are selected
identifyPch &lt;- function(x, y = NULL, n = length(x), plot = FALSE, pch = 19, ...)
{
    xy &lt;- xy.coords(x, y); x &lt;- xy$x; y &lt;- xy$y
    sel &lt;- rep(FALSE, length(x))
    while(sum(sel) &lt; n) {
        ans &lt;- identify(x[!sel], y[!sel], labels = which(!sel), n = 1, plot = plot, ...)
        if(!length(ans)) break
        ans &lt;- which(!sel)[ans]
        points(x[ans], y[ans], pch = pch)
        sel[ans] &lt;- TRUE
    }
    ## return indices of selected points
    which(sel)
}

if(dev.interactive()) { ## use it
  x &lt;- rnorm(50); y &lt;- rnorm(50)
  plot(x,y); identifyPch(x,y) # how fast to get all?
}

</code></pre>

<hr>
<h2 id='image'>Display a Color Image</h2><span id='topic+image'></span><span id='topic+image.default'></span>

<h3>Description</h3>

<p>Creates a grid of colored or gray-scale rectangles with colors
corresponding to the values in <code>z</code>.  This can be used to display
three-dimensional or spatial data aka <em>images</em>.
This is a generic function.
</p>
<p><em>NOTE:</em> the grid is drawn as a set of rectangles by default;
see the <code>useRaster</code> argument to draw the grid as a raster image.
</p>
<p>The function <code><a href="grDevices.html#topic+hcl.colors">hcl.colors</a></code> provides a broad range of sequential
color palettes that are suitable for displaying ordered data, with
<code>n</code> giving the number of colors desired.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>image(x, ...)

## Default S3 method:
image(x, y, z, zlim, xlim, ylim,
      col = hcl.colors(12, "YlOrRd", rev = TRUE),
      add = FALSE, xaxs = "i", yaxs = "i", xlab, ylab,
      breaks, oldstyle = FALSE, useRaster, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="image_+3A_x">x</code>, <code id="image_+3A_y">y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are
measured.  These must be finite, non-missing and in (strictly)
ascending order.  By default, equally
spaced values from 0 to 1 are used.  If <code>x</code> is a <code>list</code>,
its components <code>x$x</code> and <code>x$y</code> are used for <code>x</code>
and <code>y</code>, respectively. If the list has component <code>z</code> this
is used for <code>z</code>.</p>
</td></tr>
<tr><td><code id="image_+3A_z">z</code></td>
<td>
<p>a numeric or logical matrix containing the values to be plotted
(<code>NA</code>s are allowed).  Note that <code>x</code> can be used instead
of <code>z</code> for convenience.</p>
</td></tr>
<tr><td><code id="image_+3A_zlim">zlim</code></td>
<td>
<p>the minimum and maximum <code>z</code> values for which colors
should be plotted, defaulting to the range of the finite values of
<code>z</code>. Each of the given colors will be used to color an
equispaced interval of this range. The <em>midpoints</em> of the
intervals cover the range, so that values just outside the range
will be plotted.</p>
</td></tr>
<tr><td><code id="image_+3A_xlim">xlim</code>, <code id="image_+3A_ylim">ylim</code></td>
<td>
<p>ranges for the plotted <code>x</code> and <code>y</code> values,
defaulting to the ranges of <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="image_+3A_col">col</code></td>
<td>
<p>a list of colors such as that generated by
<code><a href="grDevices.html#topic+hcl.colors">hcl.colors</a></code>, <code><a href="grDevices.html#topic+gray.colors">gray.colors</a></code> or similar
functions.</p>
</td></tr>
<tr><td><code id="image_+3A_add">add</code></td>
<td>
<p>logical; if <code>TRUE</code>, add to current plot (and disregard
the following four arguments).  This is rarely useful because
<code>image</code> &lsquo;paints&rsquo; over existing graphics.</p>
</td></tr>
<tr><td><code id="image_+3A_xaxs">xaxs</code>, <code id="image_+3A_yaxs">yaxs</code></td>
<td>
<p>style of x and y axis.  The default <code>"i"</code> is
appropriate for images.  See <code><a href="#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="image_+3A_xlab">xlab</code>, <code id="image_+3A_ylab">ylab</code></td>
<td>
<p>each a character string giving the labels for the x and
y axis.  Default to the &lsquo;call names&rsquo; of <code>x</code> or <code>y</code>, or to
<code>""</code> if these were unspecified.</p>
</td></tr>
<tr><td><code id="image_+3A_breaks">breaks</code></td>
<td>
<p>a set of finite numeric breakpoints for the colours:
must have one more breakpoint than colour and be in increasing
order.  Unsorted vectors will be sorted, with a warning.</p>
</td></tr>
<tr><td><code id="image_+3A_oldstyle">oldstyle</code></td>
<td>
<p>logical. If true the midpoints of the colour intervals
are equally spaced, and <code>zlim[1]</code> and <code>zlim[2]</code> were taken
to be midpoints.  The default is to have colour intervals of equal
lengths between the limits.</p>
</td></tr>
<tr><td><code id="image_+3A_useraster">useRaster</code></td>
<td>
<p>logical; if <code>TRUE</code> a bitmap raster is used to
plot the image instead of polygons. The grid must be regular in that
case, otherwise an error is raised.   For the behaviour when this is
not specified, see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="image_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> for <code><a href="#topic+plot">plot</a></code> may also be
passed as arguments to this function, as can the plot aspect ratio
<code>asp</code> and <code>axes</code> (see <code><a href="#topic+plot.window">plot.window</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The length of <code>x</code> should be equal to the <code>nrow(z)+1</code> or
<code>nrow(z)</code>.  In the first case <code>x</code> specifies the boundaries
between the cells: in the second case <code>x</code> specifies the midpoints
of the cells.  Similar reasoning applies to <code>y</code>.  It probably
only makes sense to specify the midpoints of an equally-spaced
grid.  If you specify just one row or column and a length-one <code>x</code>
or <code>y</code>, the whole user area in the corresponding direction is
filled. For logarithmic <code>x</code> or <code>y</code> axes the boundaries between
cells must be specified.
</p>
<p>Rectangles corresponding to missing values are not plotted (and so are
transparent and (unless <code>add = TRUE</code>) the default background
painted in <code>par("bg")</code> will show through and if that is
transparent, the canvas colour will be seen).
</p>
<p>If <code>breaks</code> is specified then <code>zlim</code> is unused and the
algorithm used follows <code><a href="base.html#topic+cut">cut</a></code>, so intervals are closed on
the right and open on the left except for the lowest interval which is
closed at both ends.
</p>
<p>The axes (where plotted) make use of the classes of <code>xlim</code> and
<code>ylim</code> (and hence by default the classes of <code>x</code> and
<code>y</code>): this will mean that for example dates are labelled as
such.
</p>
<p>Notice that <code>image</code> interprets the <code>z</code> matrix as a table of
<code>f(x[i], y[j])</code> values, so that the x axis corresponds to row
number and the y axis to column number, with column 1 at the bottom,
i.e. a 90 degree counter-clockwise rotation of the conventional
printed layout of a matrix.
</p>
<p>Images for large <code>z</code> on a regular grid are rendered more
efficiently with <code>useRaster = TRUE</code> and can prevent rare
anti-aliasing artifacts, but may not be supported by all graphics
devices.  Some devices (such as <code>postscript</code> and <code>X11(type =
  "Xlib")</code>) which do not support semi-transparent colours may emit
missing values as white rather than transparent, and there may be
limitations on the size of a raster image.  (Problems with the
rendering of raster images have been reported by users of
<code>windows()</code> devices under Remote Desktop, at least under its
default settings.)
</p>
<p>The graphics files in PDF and PostScript can be much smaller under
this option.
</p>
<p>If <code>useRaster</code> is not specified, raster images are used when the
<code><a href="base.html#topic+getOption">getOption</a>("preferRaster")</code> is true, the grid is regular
and either <code><a href="grDevices.html#topic+dev.capabilities">dev.capabilities</a>("rasterImage")$rasterImage</code>
is <code>"yes"</code> or it is <code>"non-missing"</code> and there are no missing
values.
</p>


<h3>Note</h3>

<p>Originally based on a function by Thomas Lumley.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+filled.contour">filled.contour</a></code> or <code><a href="stats.html#topic+heatmap">heatmap</a></code> which can
look nicer (but are less modular),
<code><a href="#topic+contour">contour</a></code>;
The <a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a> equivalent of <code>image</code> is
<code><a href="lattice.html#topic+levelplot">levelplot</a></code>.
</p>
<p><code><a href="grDevices.html#topic+hcl.colors">hcl.colors</a></code>, <code><a href="grDevices.html#topic+gray.colors">gray.colors</a></code>,
<code><a href="grDevices.html#topic+hcl">hcl</a></code>, <code><a href="grDevices.html#topic+hsv">hsv</a></code>, <code><a href="#topic+par">par</a></code>.
</p>
<p><code><a href="grDevices.html#topic+dev.capabilities">dev.capabilities</a></code> to see if <code>useRaster = TRUE</code> is
supported on the current device.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("grDevices") # for colours
x &lt;- y &lt;- seq(-4*pi, 4*pi, length.out = 27)
r &lt;- sqrt(outer(x^2, y^2, `+`))
image(z = z &lt;- cos(r^2)*exp(-r/6), col = gray.colors(33))
image(z, axes = FALSE, main = "Math can be beautiful ...",
      xlab = expression(cos(r^2) * e^{-r/6}))
contour(z, add = TRUE, drawlabels = FALSE)

# Visualize as matrix.  Need to transpose matrix and then flip it horizontally:
tf &lt;- function(m) t(m)[, nrow(m):1]
imageM &lt;- function(m, grid = max(dim(m)) &lt;= 25, asp = (nrow(m)-1)/(ncol(m)-1), ...) {
    image(tf(m), asp=asp, axes = FALSE, ...)
    mAxis &lt;- function(side, at, ...) # using 'j'
        axis(side, at=at, labels=as.character(j+1L), col="gray", col.axis=1, ...)
    n &lt;- ncol(m); n1 &lt;- n-1L; j &lt;- 0L:n1; mAxis(1, at= j/n1)
    if(grid) abline(v = (0:n - .5)/n1, col="gray77", lty="dotted")
    n &lt;- nrow(m); n1 &lt;- n-1L; j &lt;- 0L:n1; mAxis(2, at=1-j/n1, las=1)
    if(grid) abline(h = (0:n - .5)/n1, col="gray77", lty="dotted")
}
(m &lt;- outer(1:5, 1:14))
imageM(m, main = "image(&lt;5 x 14 matrix&gt;)   with rows and columns")
imageM(volcano)

# A prettier display of the volcano
x &lt;- 10*(1:nrow(volcano))
y &lt;- 10*(1:ncol(volcano))
image(x, y, volcano, col = hcl.colors(100, "terrain"), axes = FALSE)
contour(x, y, volcano, levels = seq(90, 200, by = 5),
        add = TRUE, col = "brown")
axis(1, at = seq(100, 800, by = 100))
axis(2, at = seq(100, 600, by = 100))
box()
title(main = "Maunga Whau Volcano", font.main = 4)
</code></pre>

<hr>
<h2 id='layout'>Specifying Complex Plot Arrangements</h2><span id='topic+layout'></span><span id='topic+layout.show'></span><span id='topic+lcm'></span>

<h3>Description</h3>

<p><code>layout</code> divides the device up into as many rows and columns as
there are in matrix <code>mat</code>, with the column-widths and the
row-heights specified in the respective arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>layout(mat, widths = rep.int(1, ncol(mat)),
       heights = rep.int(1, nrow(mat)), respect = FALSE)

layout.show(n = 1)
lcm(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="layout_+3A_mat">mat</code></td>
<td>
<p>a matrix object specifying the location of the next
<code class="reqn">N</code> figures on the output device.  Each value in the matrix must
be <code>0</code> or a positive integer.  If <code class="reqn">N</code> is the largest
positive integer in the matrix, then the integers
<code class="reqn">\{1, \dots, N-1\}</code> must also appear at least once in the matrix.</p>
</td></tr>
<tr><td><code id="layout_+3A_widths">widths</code></td>
<td>
<p>a vector of values for the widths of columns on the
device.  Relative widths are specified with numeric values.    Absolute
widths (in centimetres) are specified with the <code>lcm()</code> function (see
examples).</p>
</td></tr>
<tr><td><code id="layout_+3A_heights">heights</code></td>
<td>
<p>a vector of values for the heights of rows on the device.
Relative and absolute heights can be specified, see <code>widths</code> above.</p>
</td></tr>
<tr><td><code id="layout_+3A_respect">respect</code></td>
<td>
<p>either a logical value or a matrix object.  If the
latter, then it must have the same dimensions as <code>mat</code> and
each value in the matrix must be either <code>0</code> or <code>1</code>.</p>
</td></tr>
<tr><td><code id="layout_+3A_n">n</code></td>
<td>
<p>number of figures to plot.</p>
</td></tr>
<tr><td><code id="layout_+3A_x">x</code></td>
<td>
<p>a dimension to be interpreted as a number of centimetres.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Figure <code class="reqn">i</code> is allocated a region composed from a subset
of these rows and columns, based on the rows and columns
in which <code class="reqn">i</code> occurs in <code>mat</code>.
</p>
<p>The <code>respect</code> argument controls whether a unit column-width is
the same physical measurement on the device as a unit row-height.
</p>
<p>There is a limit (currently 200) for the numbers of rows and columns
in the layout, and also for the total number of cells (10007).
</p>
<p><code>layout.show(n)</code> plots (part of) the current layout, namely the
outlines of the next <code>n</code> figures.
</p>
<p><code>lcm</code> is a trivial function, to be used as <em>the</em> interface
for specifying absolute dimensions for the <code>widths</code> and
<code>heights</code> arguments of <code>layout()</code>.
</p>


<h3>Value</h3>

<p><code>layout</code> returns the number of figures, <code class="reqn">N</code>, see above.
</p>


<h3>Warnings</h3>

<p>These functions are totally incompatible with the other mechanisms for
arranging plots on a device: <code><a href="#topic+par">par</a>(mfrow)</code>,
<code>par(mfcol)</code> and <code><a href="#topic+split.screen">split.screen</a></code>.
</p>


<h3>Author(s)</h3>

<p>Paul R. Murrell</p>


<h3>References</h3>

<p>Murrell, P. R. (1999).
Layouts: A mechanism for arranging plots on a page.
<em>Journal of Computational and Graphical Statistics</em>,
<b>8</b>, 121&ndash;134.
<a href="https://doi.org/10.2307/1390924">doi:10.2307/1390924</a>.
</p>
<p>Chapter 5 of Paul Murrell's Ph.D. thesis.
</p>
<p>Murrell, P. (2005).
<em>R Graphics</em>.
Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+par">par</a></code> with arguments <code>mfrow</code>, <code>mfcol</code>, or
<code>mfg</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>def.par &lt;- par(no.readonly = TRUE) # save default, for resetting...

## divide the device into two rows and two columns
## allocate figure 1 all of row 1
## allocate figure 2 the intersection of column 2 and row 2
layout(matrix(c(1,1,0,2), 2, 2, byrow = TRUE))
## show the regions that have been allocated to each plot
layout.show(2)

## divide device into two rows and two columns
## allocate figure 1 and figure 2 as above
## respect relations between widths and heights
nf &lt;- layout(matrix(c(1,1,0,2), 2, 2, byrow = TRUE), respect = TRUE)
layout.show(nf)

## create single figure which is 5cm square
nf &lt;- layout(matrix(1), widths = lcm(5), heights = lcm(5))
layout.show(nf)


##-- Create a scatterplot with marginal histograms -----

x &lt;- pmin(3, pmax(-3, stats::rnorm(50)))
y &lt;- pmin(3, pmax(-3, stats::rnorm(50)))
xhist &lt;- hist(x, breaks = seq(-3,3,0.5), plot = FALSE)
yhist &lt;- hist(y, breaks = seq(-3,3,0.5), plot = FALSE)
top &lt;- max(c(xhist$counts, yhist$counts))
xrange &lt;- c(-3, 3)
yrange &lt;- c(-3, 3)
nf &lt;- layout(matrix(c(2,0,1,3),2,2,byrow = TRUE), c(3,1), c(1,3), TRUE)
layout.show(nf)

par(mar = c(3,3,1,1))
plot(x, y, xlim = xrange, ylim = yrange, xlab = "", ylab = "")
par(mar = c(0,3,1,1))
barplot(xhist$counts, axes = FALSE, ylim = c(0, top), space = 0)
par(mar = c(3,0,1,1))
barplot(yhist$counts, axes = FALSE, xlim = c(0, top), space = 0, horiz = TRUE)

par(def.par)  #- reset to default
</code></pre>

<hr>
<h2 id='legend'>Add Legends to Plots</h2><span id='topic+legend'></span>

<h3>Description</h3>

<p>This function can be used to add legends to plots.  Note that a call
to the function <code><a href="#topic+locator">locator</a>(1)</code> can be used in place of the <code>x</code>
and <code>y</code> arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>legend(x, y = NULL, legend, fill = NULL, col = par("col"),
       border = "black", lty, lwd, pch,
       angle = 45, density = NULL, bty = "o", bg = par("bg"),
       box.lwd = par("lwd"), box.lty = par("lty"), box.col = par("fg"),
       pt.bg = NA, cex = 1, pt.cex = cex, pt.lwd = lwd,
       xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,
       adj = c(0, 0.5), text.width = NULL, text.col = par("col"),
       text.font = NULL, merge = do.lines &amp;&amp; has.pch, trace = FALSE,
       plot = TRUE, ncol = 1, horiz = FALSE, title = NULL,
       inset = 0, xpd, title.col = text.col[1], title.adj = 0.5,
       title.cex = cex[1], title.font = text.font[1],
       seg.len = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="legend_+3A_x">x</code>, <code id="legend_+3A_y">y</code></td>
<td>
<p>the x and y co-ordinates to be used to position the legend.
They can be specified by keyword or in any way which is accepted by
<code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>: See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="legend_+3A_legend">legend</code></td>
<td>
<p>a character or <a href="base.html#topic+expression">expression</a> vector
of length <code class="reqn">\ge 1</code> to appear in the legend.  Other
objects will be coerced by <code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_fill">fill</code></td>
<td>
<p>if specified, this argument will cause boxes filled
with the specified colors (or shaded in the specified colors)
to appear beside the legend text.</p>
</td></tr>
<tr><td><code id="legend_+3A_col">col</code></td>
<td>
<p>the color of points or lines appearing in the legend.</p>
</td></tr>
<tr><td><code id="legend_+3A_border">border</code></td>
<td>
<p>the border color for the boxes (used only if
<code>fill</code> is specified).</p>
</td></tr>
<tr><td><code id="legend_+3A_lty">lty</code>, <code id="legend_+3A_lwd">lwd</code></td>
<td>
<p>the line types and widths for lines appearing in the
legend.  One of these two <em>must</em> be specified for line drawing.</p>
</td></tr>
<tr><td><code id="legend_+3A_pch">pch</code></td>
<td>
<p>the plotting symbols appearing in the legend, as
numeric vector or a vector of 1-character strings (see
<code><a href="#topic+points">points</a></code>). Unlike <code>points</code>, this can all be
specified as a single multi-character string.  <em>Must</em> be
specified for symbol drawing.</p>
</td></tr>
<tr><td><code id="legend_+3A_angle">angle</code></td>
<td>
<p>angle of shading lines.</p>
</td></tr>
<tr><td><code id="legend_+3A_density">density</code></td>
<td>
<p>the density of shading lines, if numeric and
positive. If <code>NULL</code> or negative or <code>NA</code> color filling
is assumed.</p>
</td></tr>
<tr><td><code id="legend_+3A_bty">bty</code></td>
<td>
<p>the type of box to be drawn around the legend.  The allowed
values are <code>"o"</code> (the default) and <code>"n"</code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_bg">bg</code></td>
<td>
<p>the background color for the legend box.  (Note that this is
only used if <code>bty != "n"</code>.)</p>
</td></tr>
<tr><td><code id="legend_+3A_box.lty">box.lty</code>, <code id="legend_+3A_box.lwd">box.lwd</code>, <code id="legend_+3A_box.col">box.col</code></td>
<td>
<p>the line type, width and color for
the legend box (if <code>bty = "o"</code>).</p>
</td></tr>
<tr><td><code id="legend_+3A_pt.bg">pt.bg</code></td>
<td>
<p>the background color for the <code><a href="#topic+points">points</a></code>,
corresponding to its argument <code>bg</code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_cex">cex</code></td>
<td>
<p>character expansion factor <b>relative</b> to current
<code>par("cex")</code>.  Used for text, and provides the default for
<code>pt.cex</code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_pt.cex">pt.cex</code></td>
<td>
<p>expansion factor(s) for the points.</p>
</td></tr>
<tr><td><code id="legend_+3A_pt.lwd">pt.lwd</code></td>
<td>
<p>line width for the points, defaults to the one for
lines, or if that is not set, to <code>par("lwd")</code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_xjust">xjust</code></td>
<td>
<p>how the legend is to be justified relative to the legend
x location.  A value of 0 means left justified, 0.5 means centered
and 1 means right justified.</p>
</td></tr>
<tr><td><code id="legend_+3A_yjust">yjust</code></td>
<td>
<p>the same as <code>xjust</code> for the legend y location.</p>
</td></tr>
<tr><td><code id="legend_+3A_x.intersp">x.intersp</code></td>
<td>
<p>character interspacing factor for horizontal (x) spacing
between symbol and legend text.</p>
</td></tr>
<tr><td><code id="legend_+3A_y.intersp">y.intersp</code></td>
<td>
<p>vertical (y) distances (in lines of text shared above/below each legend entry).
A vector with one element for each row of the legend can be used.</p>
</td></tr>
<tr><td><code id="legend_+3A_adj">adj</code></td>
<td>
<p>numeric of length 1 or 2; the string adjustment for legend
text.  Useful for y-adjustment when <code>labels</code> are
<a href="grDevices.html#topic+plotmath">plotmath</a> expressions.</p>
</td></tr>
<tr><td><code id="legend_+3A_text.width">text.width</code></td>
<td>
<p>the width of the legend text in x (<code>"user"</code>)
coordinates.  (Should be positive even for a reversed x axis.)
Can be a single positive numeric value (same width for each column of the legend),
a vector (one element for each column of the legend),
<code>NULL</code> (default) for computing a proper maximum value of <code><a href="#topic+strwidth">strwidth</a>(legend)</code>),
or <code>NA</code> for computing a proper column wise maximum value of <code><a href="#topic+strwidth">strwidth</a>(legend)</code>).</p>
</td></tr>
<tr><td><code id="legend_+3A_text.col">text.col</code></td>
<td>
<p>the color used for the legend text.</p>
</td></tr>
<tr><td><code id="legend_+3A_text.font">text.font</code></td>
<td>
<p>the font used for the legend text, see <code><a href="#topic+text">text</a></code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_merge">merge</code></td>
<td>
<p>logical; if <code>TRUE</code>, merge points and lines but
not filled boxes.  Defaults to <code>TRUE</code> if there are points and lines.</p>
</td></tr>
<tr><td><code id="legend_+3A_trace">trace</code></td>
<td>
<p>logical; if <code>TRUE</code>, shows how <code>legend</code> does all
its magical computations.</p>
</td></tr>
<tr><td><code id="legend_+3A_plot">plot</code></td>
<td>
<p>logical.  If <code>FALSE</code>, nothing is plotted but the
sizes are returned.</p>
</td></tr>
<tr><td><code id="legend_+3A_ncol">ncol</code></td>
<td>
<p>the number of columns in which to set the legend items
(default is 1, a vertical legend).</p>
</td></tr>
<tr><td><code id="legend_+3A_horiz">horiz</code></td>
<td>
<p>logical; if <code>TRUE</code>, set the legend horizontally
rather than vertically (specifying <code>horiz</code> overrides the <code>ncol</code>
specification).</p>
</td></tr>
<tr><td><code id="legend_+3A_title">title</code></td>
<td>
<p>a character string or length-one expression giving a
title to be placed at the top of the legend.  Other objects will be
coerced by <code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_inset">inset</code></td>
<td>
<p>inset distance(s) from the margins as a fraction of the
plot region when legend is placed by keyword.</p>
</td></tr>
<tr><td><code id="legend_+3A_xpd">xpd</code></td>
<td>
<p>if supplied, a value of the <a href="#topic+graphical+20parameter">graphical parameter</a> <code>xpd</code>
to be used while the legend is being drawn.</p>
</td></tr>
<tr><td><code id="legend_+3A_title.col">title.col</code></td>
<td>
<p>color for <code>title</code>, defaults to <code>text.col[1]</code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_title.adj">title.adj</code></td>
<td>
<p>horizontal adjustment for <code>title</code>: see the help
for <code><a href="#topic+par">par</a>("adj")</code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_title.cex">title.cex</code></td>
<td>
<p>expansion factor(s) for the title, defaults to <code>cex[1]</code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_title.font">title.font</code></td>
<td>
<p>the font used for the legend title, defaults to <code>text.font[1]</code>,
see <code><a href="#topic+text">text</a></code>.</p>
</td></tr>
<tr><td><code id="legend_+3A_seg.len">seg.len</code></td>
<td>
<p>the length of lines drawn to illustrate <code>lty</code>
and/or <code>lwd</code> (in units of character widths).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arguments <code>x</code>, <code>y</code>, <code>legend</code> are interpreted in a
non-standard way to allow the coordinates to be specified <em>via</em>
one or two arguments.  If <code>legend</code> is missing and <code>y</code> is not
numeric, it is assumed that the second argument is intended to be
<code>legend</code> and that the first argument specifies the coordinates.
</p>
<p>The coordinates can be specified in any way which is accepted by
<code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.  If this gives the coordinates of one point,
it is used as the top-left coordinate of the rectangle containing the
legend.  If it gives the coordinates of two points, these specify
opposite corners of the rectangle (either pair of corners, in any
order).
</p>
<p>The location may also be specified by setting <code>x</code> to a single
keyword from the list <code>"bottomright"</code>, <code>"bottom"</code>,
<code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>,
<code>"top"</code>, <code>"topright"</code>, <code>"right"</code> and
<code>"center"</code>. This places the legend on the inside of the plot
frame at the given location. Partial argument matching is used.  The
optional <code>inset</code> argument specifies how far the legend is inset
from the plot margins.  If a single value is given, it is used for
both margins; if two values are given, the first is used for <code>x</code>-
distance, the second for <code>y</code>-distance.
</p>
<p>Attribute arguments such as <code>col</code>, <code>pch</code>, <code>lty</code>, etc,
are recycled if necessary: <code>merge</code> is not.  Set entries of
<code>lty</code> to <code>0</code> or set entries of <code>lwd</code> to <code>NA</code> to
suppress lines in corresponding legend entries; set <code>pch</code>
values to <code>NA</code> to suppress points.
</p>
<p>Points are drawn <em>after</em> lines in order that they can cover the
line with their background color <code>pt.bg</code>, if applicable.
</p>
<p>See the examples for how to right-justify labels.
</p>
<p>Since they are not used for Unicode code points, values <code>-31:-1</code>
are silently omitted, as are <code>NA</code> and <code>""</code> values.
</p>


<h3>Value</h3>

<p>A list with list components
</p>
<table>
<tr><td><code>rect</code></td>
<td>
<p>a list with components
</p>

<dl>
<dt><code>w</code>, <code>h</code></dt><dd><p>positive numbers giving <b>w</b>idth and
<b>h</b>eight of the legend's box.</p>
</dd>
<dt><code>left</code>, <code>top</code></dt><dd><p>x and y coordinates of upper left
corner of the box.</p>
</dd>
</dl>

</td></tr>
<tr><td><code>text</code></td>
<td>
<p>a list with components
</p>

<dl>
<dt><code>x, y</code></dt><dd><p>numeric vectors of length <code>length(legend)</code>,
giving the x and y coordinates of the legend's text(s).</p>
</dd>
</dl>

</td></tr>
</table>
<p>returned invisibly.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+barplot">barplot</a></code> which uses <code>legend()</code>, and
<code><a href="#topic+text">text</a></code> for more examples of math expressions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Run the example in '?matplot' or the following:
leg.txt &lt;- c("Setosa     Petals", "Setosa     Sepals",
             "Versicolor Petals", "Versicolor Sepals")
y.leg &lt;- c(4.5, 3, 2.1, 1.4, .7)
cexv  &lt;- c(1.2, 1, 4/5, 2/3, 1/2)
matplot(c(1, 8), c(0, 4.5), type = "n", xlab = "Length", ylab = "Width",
        main = "Petal and Sepal Dimensions in Iris Blossoms")
for (i in seq(cexv)) {
  text  (1, y.leg[i] - 0.1, paste("cex=", formatC(cexv[i])), cex = 0.8, adj = 0)
  legend(3, y.leg[i], leg.txt, pch = "sSvV", col = c(1, 3), cex = cexv[i])
}
## cex *vector* [in R &lt;= 3.5.1 has 'if(xc &lt; 0)' w/ length(xc) == 2]
legend("right", leg.txt, pch = "sSvV", col = c(1, 3),
       cex = 1+(-1:2)/8, trace = TRUE)# trace: show computed lengths &amp; coords

## 'merge = TRUE' for merging lines &amp; points:
x &lt;- seq(-pi, pi, length.out = 65)
for(reverse in c(FALSE, TRUE)) {  ## normal *and* reverse axes:
  F &lt;- if(reverse) rev else identity
  plot(x, sin(x), type = "l", col = 3, lty = 2,
       xlim = F(range(x)), ylim = F(c(-1.2, 1.8)))
  points(x, cos(x), pch = 3, col = 4)
  lines(x, tan(x), type = "b", lty = 1, pch = 4, col = 6)
  title("legend('top', lty = c(2, -1, 1), pch = c(NA, 3, 4), merge = TRUE)",
        cex.main = 1.1)
  legend("top", c("sin", "cos", "tan"), col = c(3, 4, 6),
       text.col = "green4", lty = c(2, -1, 1), pch = c(NA, 3, 4),
       merge = TRUE, bg = "gray90", trace=TRUE)
  
} # for(..)

## right-justifying a set of labels: thanks to Uwe Ligges
x &lt;- 1:5; y1 &lt;- 1/x; y2 &lt;- 2/x
plot(rep(x, 2), c(y1, y2), type = "n", xlab = "x", ylab = "y")
lines(x, y1); lines(x, y2, lty = 2)
temp &lt;- legend("topright", legend = c(" ", " "),
               text.width = strwidth("1,000,000"),
               lty = 1:2, xjust = 1, yjust = 1, inset = 1/10,
               title = "Line Types", title.cex = 0.5, trace=TRUE)
text(temp$rect$left + temp$rect$w, temp$text$y,
     c("1,000", "1,000,000"), pos = 2)


##--- log scaled Examples ------------------------------
leg.txt &lt;- c("a one", "a two")

par(mfrow = c(2, 2))
for(ll in c("","x","y","xy")) {
  plot(2:10, log = ll, main = paste0("log = '", ll, "'"))
  abline(1, 1)
  lines(2:3, 3:4, col = 2)
  points(2, 2, col = 3)
  rect(2, 3, 3, 2, col = 4)
  text(c(3,3), 2:3, c("rect(2,3,3,2, col=4)",
                      "text(c(3,3),2:3,\"c(rect(...)\")"), adj = c(0, 0.3))
  legend(list(x = 2,y = 8), legend = leg.txt, col = 2:3, pch = 1:2,
         lty = 1)  #, trace = TRUE)
} #      ^^^^^^^ to force lines -&gt; automatic merge=TRUE
par(mfrow = c(1,1))

##-- Math expressions:  ------------------------------
x &lt;- seq(-pi, pi, length.out = 65)
plot(x, sin(x), type = "l", col = 2, xlab = expression(phi),
     ylab = expression(f(phi)))
abline(h = -1:1, v = pi/2*(-6:6), col = "gray90")
lines(x, cos(x), col = 3, lty = 2)
ex.cs1 &lt;- expression(plain(sin) * phi,  paste("cos", phi))  # 2 ways
utils::str(legend(-3, .9, ex.cs1, lty = 1:2, plot = FALSE,
           adj = c(0, 0.6)))  # adj y !
legend(-3, 0.9, ex.cs1, lty = 1:2, col = 2:3,  adj = c(0, 0.6))

require(stats)
x &lt;- rexp(100, rate = .5)
hist(x, main = "Mean and Median of a Skewed Distribution")
abline(v = mean(x),   col = 2, lty = 2, lwd = 2)
abline(v = median(x), col = 3, lty = 3, lwd = 2)
ex12 &lt;- expression(bar(x) == sum(over(x[i], n), i == 1, n),
                   hat(x) == median(x[i], i == 1, n))
utils::str(legend(4.1, 30, ex12, col = 2:3, lty = 2:3, lwd = 2))

## 'Filled' boxes -- see also example(barplot) which may call legend(*, fill=)
barplot(VADeaths)
legend("topright", rownames(VADeaths), fill = gray.colors(nrow(VADeaths)))

## Using 'ncol'
x &lt;- 0:64/64
for(R in c(identity, rev)) { # normal *and* reverse x-axis works fine:
  xl &lt;- R(range(x)); x1 &lt;- xl[1]
matplot(x, outer(x, 1:7, function(x, k) sin(k * pi * x)), xlim=xl,
        type = "o", col = 1:7, ylim = c(-1, 1.5), pch = "*")
op &lt;- par(bg = "antiquewhite1")
legend(x1, 1.5, paste("sin(", 1:7, "pi * x)"), col = 1:7, lty = 1:7,
       pch = "*", ncol = 4, cex = 0.8)
legend("bottomright", paste("sin(", 1:7, "pi * x)"), col = 1:7, lty = 1:7,
       pch = "*", cex = 0.8)
legend(x1, -.1, paste("sin(", 1:4, "pi * x)"), col = 1:4, lty = 1:4,
       ncol = 2, cex = 0.8)
legend(x1, -.4, paste("sin(", 5:7, "pi * x)"), col = 4:6,  pch = 24,
       ncol = 2, cex = 1.5, lwd = 2, pt.bg = "pink", pt.cex = 1:3)
par(op)
  
} # for(..)

## point covering line :
y &lt;- sin(3*pi*x)
plot(x, y, type = "l", col = "blue",
    main = "points with bg &amp; legend(*, pt.bg)")
points(x, y, pch = 21, bg = "white")
legend(.4,1, "sin(c x)", pch = 21, pt.bg = "white", lty = 1, col = "blue")

## legends with titles at different locations
plot(x, y, type = "n")
legend("bottomright", "(x,y)", pch=1, title= "bottomright")
legend("bottom",      "(x,y)", pch=1, title= "bottom")
legend("bottomleft",  "(x,y)", pch=1, title= "bottomleft")
legend("left",        "(x,y)", pch=1, title= "left")
legend("topleft",     "(x,y)", pch=1, title= "topleft, inset = .05", inset = .05)
legend("top",         "(x,y)", pch=1, title= "top")
legend("topright",    "(x,y)", pch=1, title= "topright, inset = .02",inset = .02)
legend("right",       "(x,y)", pch=1, title= "right")
legend("center",      "(x,y)", pch=1, title= "center")

# using text.font (and text.col):
op &lt;- par(mfrow = c(2, 2), mar = rep(2.1, 4))
c6 &lt;- terrain.colors(10)[1:6]
for(i in 1:4) {
   plot(1, type = "n", axes = FALSE, ann = FALSE); title(paste("text.font =",i))
   legend("top", legend = LETTERS[1:6], col = c6,
          ncol = 2, cex = 2, lwd = 3, text.font = i, text.col = c6)
}
par(op)

# using text.width for several columns
plot(1, type="n")
legend("topleft", c("This legend", "has", "equally sized", "columns."),
       pch = 1:4, ncol = 4)
legend("bottomleft", c("This legend", "has", "optimally sized", "columns."),
       pch = 1:4, ncol = 4, text.width = NA)
legend("right", letters[1:4], pch = 1:4, ncol = 4,
       text.width = 1:4 / 50)
</code></pre>

<hr>
<h2 id='lines'>Add Connected Line Segments to a Plot</h2><span id='topic+lines'></span><span id='topic+lines.default'></span>

<h3>Description</h3>

<p>A generic function taking coordinates given in various ways and
joining the corresponding points with line segments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lines(x, ...)

## Default S3 method:
lines(x, y = NULL, type = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lines_+3A_x">x</code>, <code id="lines_+3A_y">y</code></td>
<td>
<p>coordinate vectors of points to join.</p>
</td></tr>
<tr><td><code id="lines_+3A_type">type</code></td>
<td>
<p>character indicating the type of plotting; actually any of
the <code>type</code>s as in <code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="lines_+3A_...">...</code></td>
<td>
<p>Further graphical parameters (see <code><a href="#topic+par">par</a></code>) may
also be supplied as arguments, particularly, line type, <code>lty</code>,
line width, <code>lwd</code>, color, <code>col</code> and for <code>type = "b"</code>,
<code>pch</code>.  Also the line characteristics <code>lend</code>, <code>ljoin</code>
and <code>lmitre</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coordinates can be passed in a plotting structure
(a list with <code>x</code> and <code>y</code> components), a two-column matrix, a
time series, ....  See <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.  If supplied
separately, they must be of the same length.
</p>
<p>The coordinates can contain <code>NA</code> values. If a point contains
<code>NA</code> in either its <code>x</code> or <code>y</code> value, it is omitted from
the plot, and lines are not drawn to or from such points.  Thus
missing values can be used to achieve breaks in lines.
</p>
<p>For <code>type = "h"</code>, <code>col</code> can be a vector and will be recycled
as needed.
</p>
<p><code>lwd</code> can be a vector: its first element will apply to lines but
the whole vector to symbols (recycled as necessary).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lines.formula">lines.formula</a></code> for the formula method;
<code><a href="#topic+points">points</a></code>, particularly for <code>type %in% c("p","b","o")</code>,
<code><a href="#topic+plot">plot</a></code>,
and the workhorse function <code><a href="#topic+plot.xy">plot.xy</a></code>.
</p>
<p><code><a href="#topic+abline">abline</a></code> for drawing (single) straight lines.
</p>
<p><code><a href="#topic+par">par</a></code> for line type (<code>lty</code>) specification and how to
specify colors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># draw a smooth line through a scatter plot
plot(cars, main = "Stopping Distance versus Speed")
lines(stats::lowess(cars))
</code></pre>

<hr>
<h2 id='locator'>Graphical Input</h2><span id='topic+locator'></span>

<h3>Description</h3>

<p>Reads the position of the graphics cursor when the (first) mouse
button is pressed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>locator(n = 512, type = "n", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="locator_+3A_n">n</code></td>
<td>
<p>the maximum number of points to locate.  Valid values start
at 1.</p>
</td></tr>
<tr><td><code id="locator_+3A_type">type</code></td>
<td>
<p>One of <code>"n"</code>, <code>"p"</code>, <code>"l"</code> or
<code>"o"</code>. If <code>"p"</code> or <code>"o"</code> the points are
plotted; if <code>"l"</code>  or <code>"o"</code> they are joined by lines.</p>
</td></tr>
<tr><td><code id="locator_+3A_...">...</code></td>
<td>
<p>additional graphics parameters used if <code>type != "n"</code>
for plotting the locations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>locator</code> is only supported on screen devices such as
<code>X11</code>, <code>windows</code> and <code>quartz</code>.  On other devices the
call will do nothing.
</p>
<p>Unless the process is terminated prematurely by the user (see below)
at most <code>n</code> positions are determined.
</p>
<p>For the usual <code><a href="grDevices.html#topic+X11">X11</a></code> device the identification process is
terminated by pressing any mouse button other than the first.
For the <code><a href="grDevices.html#topic+quartz">quartz</a></code> device the process is terminated by
pressing the <code>ESC</code> key.
</p>
<p>The current graphics parameters apply just as if <code>plot.default</code>
has been called with the same value of <code>type</code>. The plotting of
the points and lines is subject to clipping, but locations outside the
current clipping rectangle will be returned.
</p>
<p>On most devices which support <code>locator</code>, successful selection of
a point is indicated by a bell sound unless
<code><a href="base.html#topic+options">options</a>(locatorBell = FALSE)</code> has been set.
</p>
<p>If the window is resized or hidden and then exposed before the input
process has terminated, any lines or points drawn by <code>locator</code>
will disappear.  These will reappear once the input process has
terminated and the window is resized or hidden and exposed again.
This is because the points and lines drawn by <code>locator</code> are not
recorded in the device's display list until the input process has
terminated.
</p>


<h3>Value</h3>

<p>A list containing <code>x</code> and <code>y</code> components which are the
coordinates of the identified points in the user coordinate system,
i.e., the one specified by <code><a href="#topic+par">par</a>("usr")</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+identify">identify</a></code>.
<code><a href="grid.html#topic+grid.locator">grid.locator</a></code> is the corresponding <span class="pkg">grid</span>
package function.
</p>
<p><code><a href="grDevices.html#topic+dev.capabilities">dev.capabilities</a></code> to see if it is supported.
</p>

<hr>
<h2 id='matplot'>Plot Columns of Matrices</h2><span id='topic+matplot'></span><span id='topic+matpoints'></span><span id='topic+matlines'></span>

<h3>Description</h3>

<p>Plot the columns of one matrix against the columns of another (which
often is just a vector treated as 1-column matrix).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matplot(x, y, type = "p", lty = 1:5, lwd = 1, lend = par("lend"),
        pch = NULL,
        col = 1:6, cex = NULL, bg = NA,
        xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL,
        log = "", ..., add = FALSE, verbose = getOption("verbose"))

matpoints(x, y, type = "p", lty = 1:5, lwd = 1, pch = NULL,
          col = 1:6, ...)

matlines (x, y, type = "l", lty = 1:5, lwd = 1, pch = NULL,
          col = 1:6, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matplot_+3A_x">x</code>, <code id="matplot_+3A_y">y</code></td>
<td>
<p>vectors or matrices of data for plotting.  The number of
rows should match.  If one of them are missing, the other is taken
as <code>y</code> and an <code>x</code> vector of <code>1:n</code> is used.
Missing values (<code>NA</code>s) are allowed. Typically,
<code><a href="base.html#topic+class">class</a>(.)</code>es of <code>x</code> and <code>y</code> such as
<code>"<a href="base.html#topic+Date">Date</a>"</code> are preserved.</p>
</td></tr>
<tr><td><code id="matplot_+3A_type">type</code></td>
<td>
<p>character string (length 1 vector) or vector of 1-character
strings indicating the type of plot for each
column of <code>y</code>, see <code><a href="#topic+plot">plot</a></code> for all possible
<code>type</code>s.  The first character of <code>type</code>
defines the first plot, the second character the second, etc.
Characters in <code>type</code> are cycled through; e.g., <code>"pl"</code>
alternately plots points and lines.</p>
</td></tr>
<tr><td><code id="matplot_+3A_lty">lty</code>, <code id="matplot_+3A_lwd">lwd</code>, <code id="matplot_+3A_lend">lend</code></td>
<td>
<p>vector of line types, widths, and end styles.
The first element is for the first column, the second element for
the second column, etc., even if lines are not plotted for all
columns. Line types will be used cyclically until all plots are
drawn.</p>
</td></tr>
<tr><td><code id="matplot_+3A_pch">pch</code></td>
<td>
<p>character string or vector of 1-characters or integers for
plotting characters, see <code><a href="#topic+points">points</a></code> for details.
The first character is the plotting-character for the first plot,
the second for the second, etc.  The default is the digits (1
through 9, 0) then the lowercase and uppercase letters.
</p>
</td></tr>
<tr><td><code id="matplot_+3A_col">col</code></td>
<td>
<p>vector of colors.  Colors are used cyclically.</p>
</td></tr>
<tr><td><code id="matplot_+3A_cex">cex</code></td>
<td>
<p>vector of character expansion sizes, used cyclically.
This works as a multiple of <code><a href="#topic+par">par</a>("cex")</code>.  <code>NULL</code> is
equivalent to <code>1.0</code>. </p>
</td></tr>
<tr><td><code id="matplot_+3A_bg">bg</code></td>
<td>
<p>vector of background (fill) colors for the open plot
symbols given by <code>pch = 21:25</code> as in <code><a href="#topic+points">points</a></code>.  The
default <code>NA</code> corresponds to the one of the underlying function
<code><a href="#topic+plot.xy">plot.xy</a></code>.</p>
</td></tr>
<tr><td><code id="matplot_+3A_xlab">xlab</code>, <code id="matplot_+3A_ylab">ylab</code></td>
<td>
<p>titles for x and y axes, as in <code><a href="#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="matplot_+3A_xlim">xlim</code>, <code id="matplot_+3A_ylim">ylim</code></td>
<td>
<p>ranges of x and y axes, as in <code><a href="#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="matplot_+3A_log">log</code>, <code id="matplot_+3A_...">...</code></td>
<td>
<p>Graphical parameters (see <code><a href="#topic+par">par</a></code>) and any further
arguments of <code>plot</code>, typically <code><a href="#topic+plot.default">plot.default</a></code>, may also be
supplied as arguments to this function; even <code>panel.first</code> etc
now work.  Hence, the high-level
graphics control arguments described under <code><a href="#topic+par">par</a></code> and the
arguments to <code><a href="#topic+title">title</a></code> may be supplied to this function.</p>
</td></tr>
<tr><td><code id="matplot_+3A_add">add</code></td>
<td>
<p>logical.  If <code>TRUE</code>, plots are added to current one,
using <code><a href="#topic+points">points</a></code> and <code><a href="#topic+lines">lines</a></code>.</p>
</td></tr>
<tr><td><code id="matplot_+3A_verbose">verbose</code></td>
<td>
<p>logical.  If <code>TRUE</code>, write one line of what is
done.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>matplot(x,y, ..)</code> is basically a wrapper for
</p>

<ol>
<li><p> calling (the generic function) <code><a href="#topic+plot">plot</a>(x[,1], y[,1], ..)</code>
for the first columns (only if <code>add = TRUE</code>).
</p>
</li>
<li><p> calling (the generic) <code><a href="#topic+lines">lines</a>(x[,j], y[,j], ..)</code> for
subsequent columns.
</p>
</li></ol>

<p>Care is taken to keep the <code><a href="base.html#topic+class">class</a>(.)</code> of
<code>x</code> and <code>y</code>, such that the corresponding <code>plot()</code> and
<code>lines()</code> <em>methods</em> will be called.
</p>
<p>Points involving missing values are not plotted.
</p>
<p>The first column of <code>x</code> is plotted against the first column of
<code>y</code>, the second column of <code>x</code> against the second column of
<code>y</code>, etc.  If one matrix has fewer columns, plotting will cycle
back through the columns again.  (In particular, either <code>x</code> or
<code>y</code> may be a vector, against which all columns of the other
argument will be plotted.)
</p>
<p>The first element of <code>col, cex, lty, lwd</code> is used to plot the axes
as well as the first line.
</p>
<p>Because plotting symbols are drawn with lines and because these
functions may be changing the line style, you should probably specify
<code>lty = 1</code> when using plotting symbols.
</p>


<h3>Side Effects</h3>

<p>Function <code>matplot</code> generates a new plot;
<code>matpoints</code> and <code>matlines</code> add to the current one.</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+points">points</a></code>, <code><a href="#topic+lines">lines</a></code>,
<code><a href="base.html#topic+matrix">matrix</a></code>, <code><a href="#topic+par">par</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(grDevices)
matplot((-4:5)^2, main = "Quadratic") # almost identical to plot(*)
sines &lt;- outer(1:20, 1:4, function(x, y) sin(x / 20 * pi * y))
matplot(sines, pch = 1:4, type = "o", col = rainbow(ncol(sines)))
matplot(sines, type = "b", pch = 21:23, col = 2:5, bg = 2:5,
        main = "matplot(...., pch = 21:23, bg = 2:5)")

x &lt;- 0:50/50
matplot(x, outer(x, 1:8, function(x, k) sin(k*pi * x)),
        ylim = c(-2,2), type = "plobcsSh",
        main= "matplot(,type = \"plobcsSh\" )")
## pch &amp; type =  vector of 1-chars :
matplot(x, outer(x, 1:4, function(x, k) sin(k*pi * x)),
        pch = letters[1:4], type = c("b","p","o"))

lends &lt;- c("round","butt","square")
matplot(matrix(1:12, 4), type="c", lty=1, lwd=10, lend=lends)
text(cbind(2.5, 2*c(1,3,5)-.4), lends, col= 1:3, cex = 1.5)

table(iris$Species) # is data.frame with 'Species' factor
iS &lt;- iris$Species == "setosa"
iV &lt;- iris$Species == "versicolor"
op &lt;- par(bg = "bisque")
matplot(c(1, 8), c(0, 4.5), type =  "n", xlab = "Length", ylab = "Width",
        main = "Petal and Sepal Dimensions in Iris Blossoms")
matpoints(iris[iS,c(1,3)], iris[iS,c(2,4)], pch = "sS", col = c(2,4))
matpoints(iris[iV,c(1,3)], iris[iV,c(2,4)], pch = "vV", col = c(2,4))
legend(1, 4, c("    Setosa Petals", "    Setosa Sepals",
               "Versicolor Petals", "Versicolor Sepals"),
       pch = "sSvV", col = rep(c(2,4), 2))

nam.var &lt;- colnames(iris)[-5]
nam.spec &lt;- as.character(iris[1+50*0:2, "Species"])
iris.S &lt;- array(NA, dim = c(50,4,3),
                dimnames = list(NULL, nam.var, nam.spec))
for(i in 1:3) iris.S[,,i] &lt;- data.matrix(iris[1:50+50*(i-1), -5])

matplot(iris.S[, "Petal.Length",], iris.S[, "Petal.Width",], pch = "SCV",
        col = rainbow(3, start = 0.8, end = 0.1),
        sub = paste(c("S", "C", "V"), dimnames(iris.S)[[3]],
                    sep = "=", collapse= ",  "),
        main = "Fisher's Iris Data")
par(op)

## 'x' a "Date" vector :
nd &lt;- length(dv &lt;- seq(as.Date("1959-02-21"), by = "weeks", length.out = 100))
mSC &lt;- cbind(I=1, sin=sin(pi*(1:nd)/8), cos=cos(pi*(1:nd)/8))
matplot(dv, mSC, type = "b", main = "matplot(&lt;Date&gt;, y)")

## 'x' a "POSIXct" date-time vector :
ct &lt;- seq(c(ISOdate(2000,3,20)), by = "15 mins", length.out = 100)
matplot(ct, mSC, type = "b", main = "matplot(&lt;POSIXct&gt;, y)")
## or the same with even more axis flexibility:
matplot(ct, mSC, type = "b", main = "matplot(&lt;POSIXct&gt;, y)", xaxt="n")
Axis(ct, side=1, at = ct[1+4*(0:24)])

## Also works for data frame columns:
matplot(iris[1:50,1:4])
</code></pre>

<hr>
<h2 id='mosaicplot'>Mosaic Plots</h2><span id='topic+mosaicplot'></span><span id='topic+mosaicplot.default'></span><span id='topic+mosaicplot.formula'></span>

<h3>Description</h3>

<p>Plots a mosaic on the current graphics device.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mosaicplot(x, ...)

## Default S3 method:
mosaicplot(x, main = deparse1(substitute(x)),
           sub = NULL, xlab = NULL, ylab = NULL,
           sort = NULL, off = NULL, dir = NULL,
           color = NULL, shade = FALSE, margin = NULL,
           cex.axis = 0.66, las = par("las"), border = NULL,
           type = c("pearson", "deviance", "FT"), ...)

## S3 method for class 'formula'
mosaicplot(formula, data = NULL, ...,
           main = deparse1(substitute(data)), subset,
           na.action = stats::na.omit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mosaicplot_+3A_x">x</code></td>
<td>
<p>a contingency table in array form, with optional category
labels specified in the <code>dimnames(x)</code> attribute.  The table is
best created by the <code>table()</code> command.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_main">main</code></td>
<td>
<p>character string for the mosaic title.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_sub">sub</code></td>
<td>
<p>character string for the mosaic sub-title (at bottom).</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_xlab">xlab</code>, <code id="mosaicplot_+3A_ylab">ylab</code></td>
<td>
<p>x- and y-axis labels used for the plot; by default,
the first and second element of <code>names(dimnames(X))</code> (i.e., the
name of the first and second variable in <code>X</code>).</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_sort">sort</code></td>
<td>
<p>vector ordering of the variables, containing a permutation
of the integers <code>1:length(dim(x))</code> (the default).</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_off">off</code></td>
<td>
<p>vector of offsets to determine percentage spacing at each
level of the mosaic (appropriate values are between 0 and 20,
and the default is 20 times the number of splits for 2-dimensional
tables, and 10 otherwise).  Rescaled to maximally 50, and recycled if
necessary.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_dir">dir</code></td>
<td>
<p>vector of split directions (<code>"v"</code> for vertical and
<code>"h"</code> for horizontal) for each level of the mosaic, one
direction for each dimension of the contingency table.  The
default consists of alternating directions, beginning with a
vertical split.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_color">color</code></td>
<td>
<p>logical or (recycling) vector of colors for color
shading, used only when <code>shade</code> is <code>FALSE</code>, or <code>NULL</code>
(default).  By default, grey boxes are drawn.  <code>color = TRUE</code>
uses <code><a href="grDevices.html#topic+grey.colors">grey.colors</a></code> for a gamma-corrected grey palette.
<code>color = FALSE</code> gives empty boxes with no shading.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_shade">shade</code></td>
<td>
<p>a logical indicating whether to produce extended mosaic
plots, or a numeric vector of at most 5 distinct positive numbers
giving the absolute values of the cut points for the residuals.  By
default, <code>shade</code> is <code>FALSE</code>, and simple mosaics are
created.  Using <code>shade = TRUE</code> cuts absolute values at 2 and
4.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_margin">margin</code></td>
<td>
<p>a list of vectors with the marginal totals to be fit in
the log-linear model.  By default, an independence model is fitted.
See <code><a href="stats.html#topic+loglin">loglin</a></code> for further information.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The magnification to be used for axis annotation,
as a multiple of <code>par("cex")</code>.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_las">las</code></td>
<td>
<p>numeric; the style of axis labels, see <code><a href="#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_border">border</code></td>
<td>
<p>colour of borders of cells: see <code><a href="#topic+polygon">polygon</a></code>.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_type">type</code></td>
<td>
<p>a character string indicating the type of residual to be
represented.  Must be one of <code>"pearson"</code> (giving components of
Pearson's <code class="reqn">\chi^2</code>), <code>"deviance"</code> (giving
components of the likelihood ratio <code class="reqn">\chi^2</code>), or
<code>"FT"</code> for the Freeman-Tukey residuals.  The value of this
argument can be abbreviated.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_formula">formula</code></td>
<td>
<p>a formula, such as <code>y ~ x</code>.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_data">data</code></td>
<td>
<p>a data frame (or list), or a contingency table from which
the variables in <code>formula</code> should be taken.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from methods.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
in the data frame to be used for plotting.</p>
</td></tr>
<tr><td><code id="mosaicplot_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contains variables to be cross-tabulated, and these
variables contain <code>NA</code>s.  The default is to omit cases which
have an <code>NA</code> in any variable.  Since the tabulation will omit
all cases containing missing values, this will only be useful if the
<code>na.action</code> function replaces missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function.  It currently has a default method
(<code>mosaicplot.default</code>) and a formula interface
(<code>mosaicplot.formula</code>).
</p>
<p>Extended mosaic displays visualize standardized residuals of a
loglinear model for the table by color and outline of the mosaic's
tiles.  (Standardized residuals are often referred to a standard
normal distribution.)  Cells representing negative residuals are drawn
in shaded of red and with broken borders; positive ones are drawn in
blue with solid borders.
</p>
<p>For the formula method, if <code>data</code> is an object inheriting from
class <code>"table"</code> or class <code>"ftable"</code> or an array with more
than 2 dimensions, it is taken as a contingency table, and hence all
entries should be non-negative.  In this case the left-hand side of
<code>formula</code> should be empty and the variables on the right-hand
side should be taken from the names of the dimnames attribute of the
contingency table.  A marginal table of these variables is computed,
and a mosaic plot of that table is produced.
</p>
<p>Otherwise, <code>data</code> should be a data frame or matrix, list or
environment containing the variables to be cross-tabulated.  In this
case, after possibly selecting a subset of the data as specified by
the <code>subset</code> argument, a contingency table is computed from the
variables given in <code>formula</code>, and a mosaic is produced from
this.
</p>
<p>See Emerson (1998) for more information and a case study with
television viewer data from Nielsen Media Research.
</p>
<p>Missing values are not supported except via an <code>na.action</code>
function when <code>data</code> contains variables to be cross-tabulated.
</p>
<p>A more flexible and extensible implementation of mosaic plots written
in the grid graphics system is provided in the function
<code><a href="vcd.html#topic+mosaic">mosaic</a></code> in the contributed package <a href="https://CRAN.R-project.org/package=vcd"><span class="pkg">vcd</span></a>
(Meyer, Zeileis and Hornik, 2006).
</p>


<h3>Author(s)</h3>

<p>S-PLUS original by John Emerson <a href="mailto:john.emerson@yale.edu">john.emerson@yale.edu</a>.
Originally modified and enhanced for <span class="rlang"><b>R</b></span> by Kurt Hornik.
</p>


<h3>References</h3>

<p>Hartigan, J.A., and Kleiner, B. (1984).
A mosaic of television ratings.
<em>The American Statistician</em>, <b>38</b>, 32&ndash;35.
<a href="https://doi.org/10.2307/2683556">doi:10.2307/2683556</a>.
</p>
<p>Emerson, J. W. (1998).
Mosaic displays in S-PLUS: A general implementation and a case study.
<em>Statistical Computing and Graphics Newsletter (ASA)</em>,
<b>9</b>, 1, 17&ndash;23.
</p>
<p>Friendly, M. (1994).
Mosaic displays for multi-way contingency tables.
<em>Journal of the American Statistical Association</em>, <b>89</b>,
190&ndash;200.
<a href="https://doi.org/10.2307/2291215">doi:10.2307/2291215</a>.
</p>
<p>Meyer, D., Zeileis, A., and Hornik, K. (2006)  
The strucplot Framework: Visualizing Multi-Way Contingency Tables with
<span class="pkg">vcd</span>.
<em>Journal of Statistical Software</em>, <b>17(3)</b>, 1&ndash;48.
<a href="https://doi.org/10.18637/jss.v017.i03">doi:10.18637/jss.v017.i03</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+assocplot">assocplot</a></code>,
<code><a href="stats.html#topic+loglin">loglin</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
mosaicplot(Titanic, main = "Survival on the Titanic", color = TRUE)
## Formula interface for tabulated data:
mosaicplot(~ Sex + Age + Survived, data = Titanic, color = TRUE)

mosaicplot(HairEyeColor, shade = TRUE)
## Independence model of hair and eye color and sex.  Indicates that
## there are more blue eyed blonde females than expected in the case
## of independence and too few brown eyed blonde females.
## The corresponding model is:
fm &lt;- loglin(HairEyeColor, list(1, 2, 3))
pchisq(fm$pearson, fm$df, lower.tail = FALSE)

mosaicplot(HairEyeColor, shade = TRUE, margin = list(1:2, 3))
## Model of joint independence of sex from hair and eye color.  Males
## are underrepresented among people with brown hair and eyes, and are
## overrepresented among people with brown hair and blue eyes.
## The corresponding model is:
fm &lt;- loglin(HairEyeColor, list(1:2, 3))
pchisq(fm$pearson, fm$df, lower.tail = FALSE)

## Formula interface for raw data: visualize cross-tabulation of numbers
## of gears and carburettors in Motor Trend car data.
mosaicplot(~ gear + carb, data = mtcars, color = TRUE, las = 1)
# color recycling
mosaicplot(~ gear + carb, data = mtcars, color = 2:3, las = 1)
</code></pre>

<hr>
<h2 id='mtext'>Write Text into the Margins of a Plot</h2><span id='topic+mtext'></span>

<h3>Description</h3>

<p>Text is written in one of the four margins of the current figure region
or one of the outer margins of the device region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtext(text, side = 3, line = 0, outer = FALSE, at = NA,
      adj = NA, padj = NA, cex = NA, col = NA, font = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mtext_+3A_text">text</code></td>
<td>
<p>a character or <a href="base.html#topic+expression">expression</a> vector specifying
the <em>text</em> to be written.  Other objects are coerced by
<code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td></tr>
<tr><td><code id="mtext_+3A_side">side</code></td>
<td>
<p>on which side of the plot (1=bottom, 2=left, 3=top, 4=right).</p>
</td></tr>
<tr><td><code id="mtext_+3A_line">line</code></td>
<td>
<p>on which MARgin line, starting at 0 counting outwards.</p>
</td></tr>
<tr><td><code id="mtext_+3A_outer">outer</code></td>
<td>
<p>use outer margins if available.</p>
</td></tr>
<tr><td><code id="mtext_+3A_at">at</code></td>
<td>
<p>give location of each string in user coordinates.  If the
component of <code>at</code> corresponding to a particular text item is
not a finite value (the default), the location will be determined
by <code>adj</code>.</p>
</td></tr>
<tr><td><code id="mtext_+3A_adj">adj</code></td>
<td>
<p>adjustment for each string in reading direction.  For
strings parallel to the axes, <code>adj = 0</code> means left or bottom
alignment, and <code>adj = 1</code> means right or top alignment.
</p>
<p>If <code>adj</code> is not a finite value (the default), the value of
<code>par("las")</code> determines the adjustment.  For strings plotted
parallel to the axis the default is to centre the string.</p>
</td></tr>
<tr><td><code id="mtext_+3A_padj">padj</code></td>
<td>
<p>adjustment for each string perpendicular to the reading
direction (which is controlled by <code>adj</code>).  For strings parallel
to the axes, <code>padj = 0</code> means left or bottom alignment,
and <code>padj = 1</code> means right or top alignment (relative to the line).
</p>
<p>If <code>padj</code> is not a finite value (the default), the value of
<code>par("las")</code> determines the adjustment.  For strings plotted
perpendicular to the axis the default is to centre the string.</p>
</td></tr>
<tr><td><code id="mtext_+3A_cex">cex</code></td>
<td>
<p>character expansion factor.  <code>NULL</code> and <code>NA</code>
are equivalent to <code>1.0</code>.  This is an absolute measure, not
scaled by <code>par("cex")</code> or by setting <code>par("mfrow")</code>
or <code>par("mfcol")</code>.  Can be a vector.</p>
</td></tr>
<tr><td><code id="mtext_+3A_col">col</code></td>
<td>
<p>color to use.  Can be a vector.  <code>NA</code> values (the
default) mean use <code>par("col")</code>.</p>
</td></tr>
<tr><td><code id="mtext_+3A_font">font</code></td>
<td>
<p>font for text.  Can be a vector.  <code>NA</code> values (the
default) mean use <code>par("font")</code>.</p>
</td></tr>
<tr><td><code id="mtext_+3A_...">...</code></td>
<td>
<p>Further graphical parameters (see <code><a href="#topic+par">par</a></code>),
including <code>family</code>, <code>las</code> and <code>xpd</code>. (The latter
defaults to the figure region unless <code>outer = TRUE</code>, otherwise
the device region.  It can only be increased.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The user coordinates in the outer margins always range from zero to
one, and are not affected by the user coordinates in the figure
region(s) &mdash; <span class="rlang"><b>R</b></span> differs here from other implementations of S.
</p>
<p>All of the named arguments can be vectors, and recycling will take
place to plot as many strings as the longest of the vector arguments.
</p>
<p>Note that a vector <code>adj</code> has a different meaning from
<code><a href="#topic+text">text</a></code>.  <code>adj = 0.5</code> will centre the string, but for
<code>outer = TRUE</code> on the device region rather than the plot region.
</p>
<p>Parameter <code>las</code> will determine the orientation of the string(s).
For strings plotted perpendicular to the axis the default justification
is to place the end of the string nearest the axis on the specified
line.  (Note that this differs from S, which uses <code>srt</code> if
<code>at</code> is supplied and <code>las</code> if it is not.  Parameter
<code>srt</code> is ignored in <span class="rlang"><b>R</b></span>.)
</p>
<p>Note that if the text is to be plotted perpendicular to the axis,
<code>adj</code> determines the justification of the string <em>and</em> the
position along the axis unless <code>at</code> is specified.
</p>
<p>Graphics parameter <code>"ylbias"</code> (see <code><a href="#topic+par">par</a></code>) determines
how the text baseline is placed relative to the nominal line.
</p>


<h3>Side Effects</h3>

<p>The given text is written onto the current plot.</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+title">title</a></code>, <code><a href="#topic+text">text</a></code>, <code><a href="#topic+plot">plot</a></code>,
<code><a href="#topic+par">par</a></code>;
<code><a href="grDevices.html#topic+plotmath">plotmath</a></code> for details on mathematical annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1:10, (-4:5)^2, main = "Parabola Points", xlab = "xlab")
mtext("10 of them")
for(s in 1:4)
    mtext(paste("mtext(..., line= -1, {side, col, font} = ", s,
          ", cex = ", (1+s)/2, ")"), line = -1,
          side = s, col = s, font = s, cex = (1+s)/2)
mtext("mtext(..., line= -2)", line = -2)
mtext("mtext(..., line= -2, adj = 0)", line = -2, adj = 0)
##--- log axis :
plot(1:10, exp(1:10), log = "y", main = "log =\"y\"", xlab = "xlab")
for(s in 1:4) mtext(paste("mtext(...,side=", s ,")"), side = s)
</code></pre>

<hr>
<h2 id='pairs'>Scatterplot Matrices</h2><span id='topic+pairs'></span><span id='topic+pairs.default'></span><span id='topic+pairs.formula'></span>

<h3>Description</h3>

<p>A matrix of scatterplots is produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairs(x, ...)

## S3 method for class 'formula'
pairs(formula, data = NULL, ..., subset,
      na.action = stats::na.pass)

## Default S3 method:
pairs(x, labels, panel = points, ...,
      horInd = 1:nc, verInd = 1:nc,
      lower.panel = panel, upper.panel = panel,
      diag.panel = NULL, text.panel = textPanel,
      label.pos = 0.5 + has.diag/3, line.main = 3,
      cex.labels = NULL, font.labels = 1,
      row1attop = TRUE, gap = 1, log = "",
      horOdd = !row1attop, verOdd = !row1attop)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairs_+3A_x">x</code></td>
<td>
<p>the coordinates of points given as numeric columns of a
matrix or data frame.  Logical and factor columns are converted to
numeric in the same way that <code><a href="base.html#topic+data.matrix">data.matrix</a></code> does.
</p>
</td></tr>
<tr><td><code id="pairs_+3A_formula">formula</code></td>
<td>
<p>a formula, such as <code>~ x + y + z</code>.  Each term will
give a separate variable in the pairs plot, so terms should be
numeric vectors.  (A response will be interpreted as another
variable, but not treated specially, so it is confusing to use one.)</p>
</td></tr>
<tr><td><code id="pairs_+3A_data">data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>formula</code> should be taken.</p>
</td></tr>
<tr><td><code id="pairs_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td></tr>
<tr><td><code id="pairs_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is to pass missing
values on to the panel functions, but <code>na.action = na.omit</code>
will cause cases with missing values in any of the variables to be
omitted entirely.</p>
</td></tr>
<tr><td><code id="pairs_+3A_labels">labels</code></td>
<td>
<p>the names of the variables.</p>
</td></tr>
<tr><td><code id="pairs_+3A_panel">panel</code></td>
<td>
<p><code>function(x, y, ...)</code> which is used to plot
the contents of each panel of the display.</p>
</td></tr>
<tr><td><code id="pairs_+3A_...">...</code></td>
<td>

<p>arguments to be passed to or from methods.
</p>
<p>Also, <a href="#topic+graphical+20parameters">graphical parameters</a> can be given as can arguments to
<code>plot</code> such as <code>main</code>.  <code>par("oma")</code> will be set
appropriately unless specified.
</p>
</td></tr>
<tr><td><code id="pairs_+3A_horind">horInd</code>, <code id="pairs_+3A_verind">verInd</code></td>
<td>
<p>The (numerical) indices of the variables to be
plotted on the horizontal and vertical axes respectively.</p>
</td></tr>
<tr><td><code id="pairs_+3A_lower.panel">lower.panel</code>, <code id="pairs_+3A_upper.panel">upper.panel</code></td>
<td>
<p>separate panel functions (or
<code>NULL</code>) to be used below and above the diagonal respectively.</p>
</td></tr>
<tr><td><code id="pairs_+3A_diag.panel">diag.panel</code></td>
<td>
<p>optional <code>function(x, ...)</code> to be
applied on the diagonals.</p>
</td></tr>
<tr><td><code id="pairs_+3A_text.panel">text.panel</code></td>
<td>
<p>optional <code>function(x, y, labels, cex,
      font, ...)</code> to be applied on the diagonals.</p>
</td></tr>
<tr><td><code id="pairs_+3A_label.pos">label.pos</code></td>
<td>
<p><code>y</code> position of labels in the text panel.</p>
</td></tr>
<tr><td><code id="pairs_+3A_line.main">line.main</code></td>
<td>
<p>if <code>main</code> is specified, <code>line.main</code> gives
the <code>line</code> argument to <code><a href="#topic+mtext">mtext</a>()</code> which draws the
title.  You may want to specify <code>oma</code> when changing <code>line.main</code>.</p>
</td></tr>
<tr><td><code id="pairs_+3A_cex.labels">cex.labels</code>, <code id="pairs_+3A_font.labels">font.labels</code></td>
<td>
<p>graphics parameters for the text panel.</p>
</td></tr>
<tr><td><code id="pairs_+3A_row1attop">row1attop</code></td>
<td>
<p>logical.  Should the layout be matrix-like with row 1
at the top, or graph-like with row 1 at the bottom?  The latter (non
default) leads to a basically symmetric scatterplot matrix.</p>
</td></tr>
<tr><td><code id="pairs_+3A_gap">gap</code></td>
<td>
<p>distance between subplots, in margin lines.</p>
</td></tr>
<tr><td><code id="pairs_+3A_log">log</code></td>
<td>
<p>a character string indicating if logarithmic axes are to be
used, see <code><a href="#topic+plot.default">plot.default</a></code> <em>or</em> a numeric vector of
indices specifying the indices of those variables where logarithmic
axes should be used for both x and y.  <code>log = "xy"</code> specifies
logarithmic axes for all variables.</p>
</td></tr>
<tr><td><code id="pairs_+3A_horodd">horOdd</code>, <code id="pairs_+3A_verodd">verOdd</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code> (or integer) determining
how the horizontal and vertical axis labeling happens.  If true, the
axis labelling starts at the first (from top left) row or column,
respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">ij</code>-th scatterplot contains <code>x[,i]</code> plotted against
<code>x[,j]</code>.  The scatterplot can be customised by setting panel
functions to appear as something completely different. The
off-diagonal panel functions are passed the appropriate columns of
<code>x</code> as <code>x</code> and <code>y</code>: the diagonal panel function (if
any) is passed a single column, and the <code>text.panel</code> function is
passed a single <code>(x, y)</code> location and the column name.
Setting some of these panel functions to <code><a href="base.html#topic+NULL">NULL</a></code> is
equivalent to <em>not</em> drawing anything there.
</p>
<p>The <a href="#topic+graphical+20parameters">graphical parameters</a> <code>pch</code> and <code>col</code> can be used
to specify a vector of plotting symbols and colors to be used in the
plots.
</p>
<p>The <a href="#topic+graphical+20parameter">graphical parameter</a> <code>oma</code> will be set by
<code>pairs.default</code> unless supplied as an argument.
</p>
<p>A panel function should not attempt to start a new plot, but just plot
within a given coordinate system: thus <code>plot</code> and <code>boxplot</code>
are not panel functions.
</p>
<p>By default, missing values are passed to the panel functions and will
often be ignored within a panel.  However, for the formula method and
<code>na.action = na.omit</code>, all cases which contain a missing values for
any of the variables are omitted completely (including when the scales
are selected).
</p>
<p>Arguments <code>horInd</code> and <code>verInd</code> were introduced in <span class="rlang"><b>R</b></span>
3.2.0. If given the same value they can be used to select or re-order
variables: with different ranges of consecutive values they can be
used to plot rectangular windows of a full pairs plot; in the latter
case &lsquo;diagonal&rsquo; refers to the diagonal of the full plot.
</p>


<h3>Author(s)</h3>

<p>Enhancements for <span class="rlang"><b>R</b></span> 1.0.0 contributed by Dr. Jens
Oehlschlgel-Akiyoshi and R-core members.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pairs(iris[1:4], main = "Anderson's Iris Data -- 3 species",
      pch = 21, bg = c("red", "green3", "blue")[unclass(iris$Species)])

## formula method, "graph" layout (row 1 at bottom):
pairs(~ Fertility + Education + Catholic, data = swiss, row1attop=FALSE,
      subset = Education &lt; 20, main = "Swiss data, Education &lt; 20")

pairs(USJudgeRatings, gap=1/10) # (gap: not wasting plotting area)
## show only lower triangle (and suppress labeling for whatever reason):
pairs(USJudgeRatings, text.panel = NULL, upper.panel = NULL)

## put histograms on the diagonal
panel.hist &lt;- function(x, ...)
{
    usr &lt;- par("usr")
    par(usr = c(usr[1:2], 0, 1.5) )
    h &lt;- hist(x, plot = FALSE)
    breaks &lt;- h$breaks; nB &lt;- length(breaks)
    y &lt;- h$counts; y &lt;- y/max(y)
    rect(breaks[-nB], 0, breaks[-1], y, col = "cyan", ...)
}
pairs(USJudgeRatings[1:5], panel = panel.smooth,
      cex = 1.5, pch = 24, bg = "light blue", horOdd=TRUE,
      diag.panel = panel.hist, cex.labels = 2, font.labels = 2)

## put (absolute) correlations on the upper panels,
## with size proportional to the correlations.
panel.cor &lt;- function(x, y, digits = 2, prefix = "", cex.cor, ...)
{
    par(usr = c(0, 1, 0, 1))
    r &lt;- abs(cor(x, y))
    txt &lt;- format(c(r, 0.123456789), digits = digits)[1]
    txt &lt;- paste0(prefix, txt)
    if(missing(cex.cor)) cex.cor &lt;- 0.8/strwidth(txt)
    text(0.5, 0.5, txt, cex = cex.cor * r)
}
pairs(USJudgeRatings, lower.panel = panel.smooth, upper.panel = panel.cor,
      gap=0, row1attop=FALSE)

pairs(iris[-5], log = "xy") # plot all variables on log scale
pairs(iris, log = 1:4, # log the first four
      main = "Lengths and Widths in [log]", line.main=1.5, oma=c(2,2,3,2))
</code></pre>

<hr>
<h2 id='panel.smooth'>Simple Panel Plot</h2><span id='topic+panel.smooth'></span>

<h3>Description</h3>

<p>An example of a simple useful <code>panel</code> function to be used as
argument in e.g., <code><a href="#topic+coplot">coplot</a></code> or <code><a href="#topic+pairs">pairs</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>panel.smooth(x, y, col = par("col"), bg = NA, pch = par("pch"),
             cex = 1, col.smooth = 2, span = 2/3, iter = 3,
             ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="panel.smooth_+3A_x">x</code>, <code id="panel.smooth_+3A_y">y</code></td>
<td>
<p>numeric vectors of the same length</p>
</td></tr>
<tr><td><code id="panel.smooth_+3A_col">col</code>, <code id="panel.smooth_+3A_bg">bg</code>, <code id="panel.smooth_+3A_pch">pch</code>, <code id="panel.smooth_+3A_cex">cex</code></td>
<td>
<p>numeric or character codes for the color(s),
point type and size of <code><a href="#topic+points">points</a></code>; see also
<code><a href="#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="panel.smooth_+3A_col.smooth">col.smooth</code></td>
<td>
<p>color to be used by <code>lines</code> for drawing the
smooths.</p>
</td></tr>
<tr><td><code id="panel.smooth_+3A_span">span</code></td>
<td>
<p>smoothing parameter <code>f</code> for <code><a href="stats.html#topic+lowess">lowess</a></code>, see
there.</p>
</td></tr>
<tr><td><code id="panel.smooth_+3A_iter">iter</code></td>
<td>
<p>number of robustness iterations for <code><a href="stats.html#topic+lowess">lowess</a></code>.</p>
</td></tr>
<tr><td><code id="panel.smooth_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="#topic+lines">lines</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+coplot">coplot</a></code> and <code><a href="#topic+pairs">pairs</a></code> where <code>panel.smooth</code>
is typically used;
<code><a href="stats.html#topic+lowess">lowess</a></code> which does the smoothing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pairs(swiss, panel = panel.smooth, pch = ".")  # emphasize the smooths
pairs(swiss, panel = panel.smooth, lwd = 2, cex = 1.5, col = 4)  # hmm...
</code></pre>

<hr>
<h2 id='par'>Set or Query Graphical Parameters</h2><span id='topic+par'></span><span id='topic+.Pars'></span><span id='topic+graphical+20parameter'></span><span id='topic+graphical+20parameters'></span>

<h3>Description</h3>

<p><code>par</code> can be used to set or query graphical parameters.
Parameters can be set by specifying them as arguments to <code>par</code> in
<code>tag = value</code> form, or by passing them as a list of tagged
values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par(..., no.readonly = FALSE)

&lt;highlevel plot&gt; (...., &lt;tag&gt; = &lt;value&gt;)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="par_+3A_...">...</code></td>
<td>
<p>arguments in <code>tag = value</code> form, a single list of tagged
values, or character vectors of parameter names. Supported parameters are
described in the &lsquo;Graphical Parameters&rsquo; section.</p>
</td></tr>
<tr><td><code id="par_+3A_no.readonly">no.readonly</code></td>
<td>
<p>logical; if <code>TRUE</code> and there are no other
arguments, only parameters are returned which can be set by a
subsequent <code>par()</code> call <em>on the same device</em>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each device has its own set of graphical parameters.  If the current
device is the null device, <code>par</code> will open a new device before
querying/setting parameters.  (What device is controlled by
<code><a href="base.html#topic+options">options</a>("device")</code>.)
</p>
<p>Parameters are queried by giving one or more character vectors of
parameter names to <code>par</code>.
</p>
<p><code>par()</code> (no arguments) or <code>par(no.readonly = TRUE)</code> is used to
get <em>all</em> the graphical parameters (as a named list).  Their
names are currently taken from the unexported variable
<code>graphics:::.Pars</code>.
</p>
<p><em><b>R.O.</b></em> indicates <em><b>read-only arguments</b></em>: These
may only be used in queries and cannot be set.  (<code>"cin"</code>,
<code>"cra"</code>, <code>"csi"</code>, <code>"cxy"</code>, <code>"din"</code> and
<code>"page"</code> are always read-only.)
</p>
<p>Several parameters can only be set by a call to <code>par()</code>:
</p>

<ul>
<li> <p><code>"ask"</code>,
</p>
</li>
<li> <p><code>"fig"</code>, <code>"fin"</code>,
</p>
</li>
<li> <p><code>"lheight"</code>,
</p>
</li>
<li> <p><code>"mai"</code>, <code>"mar"</code>, <code>"mex"</code>,
<code>"mfcol"</code>, <code>"mfrow"</code>, <code>"mfg"</code>,
</p>
</li>
<li> <p><code>"new"</code>,
</p>
</li>
<li> <p><code>"oma"</code>, <code>"omd"</code>, <code>"omi"</code>,
</p>
</li>
<li> <p><code>"pin"</code>, <code>"plt"</code>, <code>"ps"</code>, <code>"pty"</code>,
</p>
</li>
<li> <p><code>"usr"</code>,
</p>
</li>
<li> <p><code>"xlog"</code>, <code>"ylog"</code>,
</p>
</li>
<li> <p><code>"ylbias"</code>
</p>
</li></ul>

<p>The remaining parameters can also be set as arguments (often via
<code>...</code>) to high-level plot functions such as
<code><a href="#topic+plot.default">plot.default</a></code>, <code><a href="#topic+plot.window">plot.window</a></code>,
<code><a href="#topic+points">points</a></code>, <code><a href="#topic+lines">lines</a></code>, <code><a href="#topic+abline">abline</a></code>,
<code><a href="#topic+axis">axis</a></code>, <code><a href="#topic+title">title</a></code>, <code><a href="#topic+text">text</a></code>,
<code><a href="#topic+mtext">mtext</a></code>, <code><a href="#topic+segments">segments</a></code>, <code><a href="#topic+symbols">symbols</a></code>,
<code><a href="#topic+arrows">arrows</a></code>, <code><a href="#topic+polygon">polygon</a></code>, <code><a href="#topic+rect">rect</a></code>,
<code><a href="#topic+box">box</a></code>, <code><a href="#topic+contour">contour</a></code>, <code><a href="#topic+filled.contour">filled.contour</a></code>
and <code><a href="#topic+image">image</a></code>.  Such settings will be active during the
execution of the function, only.  However, see the comments on
<code>bg</code>, <code>cex</code>, <code>col</code>, <code>lty</code>, <code>lwd</code> and
<code>pch</code> which may be taken as <em>arguments</em> to certain plot
functions rather than as graphical parameters.
</p>
<p>The meaning of &lsquo;character size&rsquo; is not well-defined: this is
set up for the device taking <code>pointsize</code> into account but often
not the actual font family in use.  Internally the corresponding pars
(<code>cra</code>, <code>cin</code>, <code>cxy</code> and <code>csi</code>) are used only to
set the inter-line spacing used to convert <code>mar</code> and <code>oma</code>
to physical margins.  (The same inter-line spacing multiplied by
<code>lheight</code> is used for multi-line strings in <code>text</code> and
<code>strheight</code>.)
</p>
<p>Note that graphical parameters are suggestions: plotting functions and
devices need not make use of them (and this is particularly true of
non-default methods for e.g. <code>plot</code>).
</p>


<h3>Value</h3>

<p>When parameters are set, their previous values are returned in an
invisible named list.  Such a list can be passed as an argument to
<code>par</code> to restore the parameter values.  Use <code>par(no.readonly
  = TRUE)</code> for the full list of parameters that can be restored.
However, restoring all of these is not wise: see the &lsquo;Note&rsquo;
section.
</p>
<p>When just one parameter is queried, the value of that parameter
is returned as (atomic) vector.  When two or more parameters are
queried, their values are returned in a list, with the list names
giving the parameters.
</p>
<p>Note the inconsistency: setting one parameter returns a list, but
querying one parameter returns a vector.
</p>


<h3>Graphical Parameters</h3>


<dl>
<dt><code>adj</code></dt><dd><p>The value of <code>adj</code> determines the way in
which text strings are justified in <code><a href="#topic+text">text</a></code>,
<code><a href="#topic+mtext">mtext</a></code> and <code><a href="#topic+title">title</a></code>.  A value of <code>0</code> produces
left-justified text, <code>0.5</code> (the default) centered text and <code>1</code>
right-justified text.  (Any value in <code class="reqn">[0, 1]</code> is allowed, and
on most devices values outside that interval will also work.)
</p>
<p>Note that the <code>adj</code> <em>argument</em> of <code><a href="#topic+text">text</a></code> also
allows <code>adj = c(x, y)</code> for different adjustment in x- and y-
directions.  Note that whereas for <code>text</code> it refers to
positioning of text about a point, for <code>mtext</code> and
<code>title</code> it controls placement within the plot or device region.</p>
</dd>
<dt><code>ann</code></dt><dd><p>If set to <code>FALSE</code>, high-level plotting
functions calling <code><a href="#topic+plot.default">plot.default</a></code> do not annotate the
plots they produce with axis titles and overall titles.  The
default is to do annotation.</p>
</dd>
<dt><code>ask</code></dt><dd><p>logical.  If <code>TRUE</code> (and the <span class="rlang"><b>R</b></span> session is
interactive) the user is asked for input, before a new figure is
drawn.  As this applies to the device, it also affects output by
packages <span class="pkg">grid</span> and <a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a>.  It can be set even on
non-screen devices but may have no effect there.
</p>
<p>This not really a graphics parameter, and its use is deprecated in
favour of <code><a href="grDevices.html#topic+devAskNewPage">devAskNewPage</a></code>.
</p>
</dd>
<dt><code>bg</code></dt><dd><p>The color to be used for the background of the
device region.  When called from <code>par()</code> it also sets
<code>new = FALSE</code>. See section &lsquo;Color Specification&rsquo; for
suitable values.  For many devices the initial value is set from
the <code>bg</code> argument of the device, and for the rest it is
normally <code>"white"</code>.
</p>
<p>Note that some graphics functions such as
<code><a href="#topic+plot.default">plot.default</a></code> and <code><a href="#topic+points">points</a></code> have an
<em>argument</em> of this name with a different meaning.</p>
</dd>
<dt><code>bty</code></dt><dd><p>A character string which determined the type of
<code><a href="#topic+box">box</a></code> which is drawn about plots.  If <code>bty</code> is
one of <code>"o"</code> (the default), <code>"l"</code>, <code>"7"</code>,
<code>"c"</code>, <code>"u"</code>, or <code>"]"</code> the resulting box resembles
the corresponding upper case letter.  A value of <code>"n"</code>
suppresses the box.</p>
</dd>
<dt><code>cex</code></dt><dd><p>A numerical value giving the amount by which
plotting text and symbols should be magnified relative to the
default.  This starts as <code>1</code> when a device is opened, and is
reset when the layout is changed, e.g. by setting <code>mfrow</code>.
</p>
<p>Note that some graphics functions such as
<code><a href="#topic+plot.default">plot.default</a></code> have an <em>argument</em> of this name
which <em>multiplies</em> this graphical parameter, and some
functions such as <code><a href="#topic+points">points</a></code> and <code><a href="#topic+text">text</a></code>
accept a vector of values which are recycled.
</p>
</dd>
<dt><code>cex.axis</code></dt><dd><p>The magnification to be used for axis
annotation relative to the current setting of <code>cex</code>.</p>
</dd>
<dt><code>cex.lab</code></dt><dd><p>The magnification to be used for x and y
labels relative to the current setting of <code>cex</code>.</p>
</dd>
<dt><code>cex.main</code></dt><dd><p>The magnification to be used for main titles
relative to the current setting of <code>cex</code>.</p>
</dd>
<dt><code>cex.sub</code></dt><dd><p>The magnification to be used for sub-titles
relative to the current setting of <code>cex</code>.</p>
</dd>
<dt><code>cin</code></dt><dd><p><em><b>R.O.</b></em>; character size
<code>(width, height)</code> in inches.  These are the same measurements
as <code>cra</code>, expressed in different units.</p>
</dd>
<dt><code>col</code></dt><dd><p>A specification for the default plotting color.  See
section &lsquo;Color Specification&rsquo;.
</p>
<p>Some functions such as <code><a href="#topic+lines">lines</a></code> and <code><a href="#topic+text">text</a></code>
accept a vector of values which are recycled and may be
interpreted slightly differently.
</p>
</dd>
<dt><code>col.axis</code></dt><dd><p>The color to be used for axis
annotation.  Defaults to <code>"black"</code>.</p>
</dd>
<dt><code>col.lab</code></dt><dd><p>The color to be used for x and y labels.
Defaults to <code>"black"</code>.</p>
</dd>
<dt><code>col.main</code></dt><dd><p>The color to be used for plot main titles.
Defaults to <code>"black"</code>.</p>
</dd>
<dt><code>col.sub</code></dt><dd><p>The color to be used for plot sub-titles.
Defaults to <code>"black"</code>.</p>
</dd>
<dt><code>cra</code></dt><dd><p><em><b>R.O.</b></em>; size of default character
<code>(width, height)</code> in &lsquo;rasters&rsquo; (pixels).  Some devices
have no concept of pixels and so assume an arbitrary pixel size,
usually 1/72 inch.  These are the same measurements
as <code>cin</code>, expressed in different units.</p>
</dd>
<dt><code>crt</code></dt><dd><p>A numerical value specifying (in degrees) how
single characters should be rotated.  It is unwise to expect
values other than multiples of 90 to work.  Compare with
<code>srt</code> which does string rotation.</p>
</dd>
<dt><code>csi</code></dt><dd><p><em><b>R.O.</b></em>; height of (default-sized)
characters in inches.  The same as <code>par("cin")[2]</code>.</p>
</dd>
<dt><code>cxy</code></dt><dd><p><em><b>R.O.</b></em>; size of default character
<code>(width, height)</code> in user coordinate units.
<code>par("cxy")</code> is <code>par("cin")/par("pin")</code> scaled to user
coordinates.
Note that <code>c(<a href="#topic+strwidth">strwidth</a>(ch), <a href="#topic+strheight">strheight</a>(ch))</code> for
a given string <code>ch</code> is usually much more precise.</p>
</dd>
<dt><code>din</code></dt><dd><p><em><b>R.O.</b></em>; the device dimensions,
<code>(width, height)</code>, in inches.  See also
<code><a href="grDevices.html#topic+dev.size">dev.size</a></code>, which is updated immediately when an
on-screen device windows is re-sized.</p>
</dd>
<dt><code>err</code></dt><dd><p>(<em>Unimplemented</em>; <span class="rlang"><b>R</b></span> is silent when points
outside the plot region are <em>not</em> plotted.)
The degree of error reporting desired.</p>
</dd>
<dt><code>family</code></dt><dd><p>The name of a font family for drawing text.
The maximum allowed length is 200 bytes.
This name gets mapped by each graphics device to a device-specific
font description.  The default value is <code>""</code> which means that
the default device fonts will be used (and what those are should
be listed on the help page for the device).  Standard values are
<code>"serif"</code>, <code>"sans"</code> and <code>"mono"</code>, and the
<a href="grDevices.html#topic+Hershey">Hershey</a> font families are also available.  (Devices may
define others, and some devices will ignore this setting
completely.  Names starting with <code>"Hershey"</code> are treated
specially and should only be used for the built-in Hershey font
families.)  This can be specified inline for <code><a href="#topic+text">text</a></code>.</p>
</dd>
<dt><code>fg</code></dt><dd><p>The color to be used for the foreground of plots.
This is the default color used for things like axes and boxes
around plots.  When called from <code>par()</code> this also sets
parameter <code>col</code> to the same value.  See section &lsquo;Color
Specification&rsquo;.  A few devices have an argument to set the
initial value, which is otherwise <code>"black"</code>.</p>
</dd>
<dt><code>fig</code></dt><dd><p>A numerical vector of the form <code>c(x1, x2, y1,
        y2)</code> which gives the (<abbr>NDC</abbr>) coordinates of the figure region in
the display region of the device. If you set this, unlike S, you
start a new plot, so to add to an existing plot use
<code>new = TRUE</code> as well.</p>
</dd>
<dt><code>fin</code></dt><dd><p>The figure region dimensions,
<code>(width, height)</code>, in inches. If you set this, unlike S, you
start a new plot.</p>
</dd>
<dt><code>font</code></dt><dd><p>An integer which specifies which font to use for
text.  If possible, device drivers arrange so that 1 corresponds
to plain text (the default), 2 to bold face, 3 to italic and 4 to
bold italic.  Also, font 5 is expected to be the symbol font, in
Adobe symbol encoding.  On some devices font families can be
selected by <code>family</code> to choose different sets of 5 fonts.</p>
</dd>
<dt><code>font.axis</code></dt><dd><p>The font to be used for axis annotation.</p>
</dd>
<dt><code>font.lab</code></dt><dd><p>The font to be used for x and y labels.</p>
</dd>
<dt><code>font.main</code></dt><dd><p>The font to be used for plot main titles.</p>
</dd>
<dt><code>font.sub</code></dt><dd><p>The font to be used for plot sub-titles.</p>
</dd>
<dt><code>lab</code></dt><dd><p>A numerical vector of the form <code>c(x, y, len)</code>
which modifies the default way that axes are annotated.  The values of
<code>x</code> and <code>y</code> give the (approximate) number of tickmarks
on the x and y axes and <code>len</code> specifies the label length.  The
default is <code>c(5, 5, 7)</code>. 
<code>len</code> <em>is unimplemented</em> in <span class="rlang"><b>R</b></span>.</p>
</dd>
<dt><code>las</code></dt><dd><p>numeric in {0,1,2,3}; the style of axis labels.
</p>

<dl>
<dt>0:</dt><dd><p>always parallel to the axis [<em>default</em>],</p>
</dd>
<dt>1:</dt><dd><p>always horizontal,</p>
</dd>
<dt>2:</dt><dd><p>always perpendicular to the axis,</p>
</dd>
<dt>3:</dt><dd><p>always vertical.</p>
</dd>
</dl>

<p>Also supported by <code><a href="#topic+mtext">mtext</a></code>.  Note that
string/character rotation <em>via</em> argument <code>srt</code> to <code>par</code>
does <em>not</em> affect the axis labels.
</p>
</dd>
<dt><code>lend</code></dt><dd><p>The line end style.  This can be specified as an
integer or string:
</p>

<dl>
<dt><code>0</code></dt><dd><p>and <code>"round"</code> mean rounded line caps
[<em>default</em>];</p>
</dd>
<dt><code>1</code></dt><dd><p>and <code>"butt"</code> mean butt line caps;</p>
</dd>
<dt><code>2</code></dt><dd><p>and <code>"square"</code> mean square line caps.</p>
</dd>
</dl>

</dd>
<dt><code>lheight</code></dt><dd><p>The line height multiplier.
The height of a line of text (used to vertically space
multi-line text) is found by multiplying the character height
both by the current character expansion and by the
line height multiplier.  Default value is 1.  Used in
<code><a href="#topic+text">text</a></code> and <code><a href="#topic+strheight">strheight</a></code>.</p>
</dd>
<dt><code>ljoin</code></dt><dd><p>The line join style.
This can be specified as an integer or string:
</p>

<dl>
<dt><code>0</code></dt><dd><p>and <code>"round"</code> mean rounded line joins
[<em>default</em>];</p>
</dd>
<dt><code>1</code></dt><dd><p>and <code>"mitre"</code> mean mitred line joins;</p>
</dd>
<dt><code>2</code></dt><dd><p>and <code>"bevel"</code> mean bevelled line joins.</p>
</dd>
</dl>

</dd>
<dt><code>lmitre</code></dt><dd><p>The line mitre limit.  This controls when
mitred line joins are automatically converted into bevelled line
joins.  The value must be larger than 1 and the default is 10.
Not all devices will honour this setting.</p>
</dd>
<dt><code>lty</code></dt><dd><p>The line type.
Line types can either be specified as an integer (0=blank, 1=solid
(default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash)
or as one of the character strings <code>"blank"</code>, <code>"solid"</code>,
<code>"dashed"</code>, <code>"dotted"</code>, <code>"dotdash"</code>,
<code>"longdash"</code>, or <code>"twodash"</code>, where <code>"blank"</code> uses
&lsquo;invisible lines&rsquo; (i.e., does not draw them).
</p>
<p>Alternatively, a string of up to 8 characters (from <code>c(1:9,
        "A":"F")</code>) may be given, giving the length of line segments
which are alternatively drawn and skipped.  See section
&lsquo;Line Type Specification&rsquo;.
</p>
<p>Functions such as <code><a href="#topic+lines">lines</a></code> and <code><a href="#topic+segments">segments</a></code>
accept a vector of values which are recycled.
</p>
</dd>
<dt><code>lwd</code></dt><dd><p>The line width, a <em>positive</em> number,
defaulting to <code>1</code>.  The interpretation is device-specific,
and some devices do not implement line widths less than one.
(See the help on the device for details of the interpretation.)
</p>
<p>Functions such as <code><a href="#topic+lines">lines</a></code> and <code><a href="#topic+segments">segments</a></code>
accept a vector of values which are recycled: in such uses lines
corresponding to values <code>NA</code> or <code>NaN</code> are omitted.  The
interpretation of <code>0</code> is device-specific.
</p>
</dd>
<dt><code>mai</code></dt><dd><p>A numerical vector of the form <code>c(bottom,
        left, top, right)</code> which gives the margin size specified in
inches.<br />
<img src="../help/figures/mai.png" width="35%" alt="Figure: mai.png" />

</p>
</dd>
<dt><code>mar</code></dt><dd><p>A numerical vector of the form <code>c(bottom,
        left, top, right)</code> which gives the number of lines of margin to be
specified on the four sides of the plot.
The default is <code>c(5, 4, 4, 2) + 0.1</code>.</p>
</dd>
<dt><code>mex</code></dt><dd>
<p><code>mex</code> is a character size expansion factor which is used to
describe coordinates in the margins of plots. Note that this does
not change the font size, rather specifies the size of font (as a
multiple of <code>csi</code>) used to convert between <code>mar</code> and
<code>mai</code>, and between <code>oma</code> and <code>omi</code>.
</p>
<p>This starts as <code>1</code> when the device is opened, and is reset
when the layout is changed (alongside resetting <code>cex</code>).
</p>
</dd>
<dt><code>mfcol, mfrow</code></dt><dd><p>A vector of the form <code>c(nr, nc)</code>.
Subsequent figures will be drawn in an <code>nr</code>-by-<code>nc</code>
array on the device by <em>columns</em> (<code>mfcol</code>), or
<em>rows</em> (<code>mfrow</code>), respectively.
</p>
<p>In a layout with exactly two rows and columns the base value of
<code>"cex"</code> is reduced by a factor of 0.83: if there are three or
more of either rows or columns, the reduction factor is 0.66.
</p>
<p>Setting a layout resets the base value of <code>cex</code> and that of
<code>mex</code> to <code>1</code>.
</p>
<p>If either of these is queried it will give the current layout, so
querying cannot tell you the order in which the array will be filled.
</p>
<p>Consider the alternatives, <code><a href="#topic+layout">layout</a></code> and
<code><a href="#topic+split.screen">split.screen</a></code>.
</p>
</dd>
<dt><code>mfg</code></dt><dd><p>A numerical vector of the form <code>c(i, j)</code>
where <code>i</code> and <code>j</code> indicate which figure in an array of
figures is to be drawn next (if setting) or is being drawn (if
enquiring).  The array must already have been set by <code>mfcol</code>
or <code>mfrow</code>.
</p>
<p>For compatibility with S, the form <code>c(i, j, nr, nc)</code> is also
accepted, when <code>nr</code> and <code>nc</code> should be the current
number of rows and number of columns.  Mismatches will be ignored,
with a warning.</p>
</dd>
<dt><code>mgp</code></dt><dd><p>The margin line (in <code>mex</code> units) for the axis
title, axis labels and axis line.  Note that <code>mgp[1]</code> affects
<code><a href="#topic+title">title</a></code> whereas <code>mgp[2:3]</code> affect <code><a href="#topic+axis">axis</a></code>.
The default is <code>c(3, 1, 0)</code>.</p>
</dd>
<dt><code>mkh</code></dt><dd><p>The height in inches of symbols to be drawn when
the value of <code>pch</code> is an integer. <em>Completely ignored in <span class="rlang"><b>R</b></span></em>.
</p>
</dd>
<dt><code>new</code></dt><dd><p>logical, defaulting to <code>FALSE</code>.  If set to
<code>TRUE</code>, the next high-level plotting command (actually
<code><a href="#topic+plot.new">plot.new</a></code>) should <em>not clean</em> the frame before
drawing <em>as if it were on a <b><em>new</em></b> device</em>.  It is
an error (ignored with a warning) to try to use <code>new = TRUE</code>
on a device that does not currently contain a high-level plot.</p>
</dd>
<dt><code>oma</code></dt><dd><p>A vector of the form <code>c(bottom, left, top,
        right)</code> giving the size of the outer margins in lines of text.<br />
<img src="../help/figures/oma.png" width="25%" alt="Figure: oma.png" />

</p>
</dd>
<dt><code>omd</code></dt><dd><p>A vector of the form <code>c(x1, x2, y1, y2)</code>
giving the region <em>inside</em> outer margins in <abbr>NDC</abbr> (=
normalized device coordinates), i.e., as a fraction (in <code class="reqn">[0, 1]</code>)
of the device region.</p>
</dd>
<dt><code>omi</code></dt><dd><p>A vector of the form <code>c(bottom, left, top,
        right)</code> giving the size of the outer margins in inches.</p>
</dd>
<dt><code>page</code></dt><dd><p><em><b>R.O.</b></em>; A boolean value indicating
whether the next call to <code><a href="#topic+plot.new">plot.new</a></code> is going
to start a new page.  This value may be <code>FALSE</code> if there
are multiple figures on the page.</p>
</dd>
<dt><code>pch</code></dt><dd><p>Either an integer specifying a symbol or a single
character to be used as the default in plotting points.  See
<code><a href="#topic+points">points</a></code> for possible values and their interpretation.
Note that only integers and single-character strings can
be set as a graphics parameter (and not <code>NA</code> nor <code>NULL</code>).
</p>
<p>Some functions such as <code><a href="#topic+points">points</a></code> accept a vector of values
which are recycled.
</p>
</dd>
<dt><code>pin</code></dt><dd><p>The current plot dimensions, <code>(width, height)</code>,
in inches.</p>
</dd>
<dt><code>plt</code></dt><dd><p>A vector of the form <code>c(x1, x2, y1, y2)</code>
giving the coordinates of the plot region as fractions of the
current figure region.</p>
</dd>
<dt><code>ps</code></dt><dd><p>integer; the point size of text (but not symbols).  Unlike
the <code>pointsize</code> argument of most devices, this does not change
the relationship between <code>mar</code> and <code>mai</code> (nor <code>oma</code>
and <code>omi</code>).
</p>
<p>What is meant by &lsquo;point size&rsquo; is device-specific, but most
devices mean a multiple of 1<abbr>bp</abbr>, that is 1/72 of an inch.
</p>
</dd>
<dt><code>pty</code></dt><dd><p>A character specifying the type of plot region to
be used; <code>"s"</code> generates a square plotting region and
<code>"m"</code> generates the maximal plotting region.</p>
</dd>
<dt><code>smo</code></dt><dd><p>(<em>Unimplemented</em>) a value which indicates how
smooth circles and circular arcs should be.</p>
</dd>
<dt><code>srt</code></dt><dd><p>The string rotation in degrees.  See the comment
about <code>crt</code>.  Only supported by <code><a href="#topic+text">text</a></code>.


</p>
</dd>
<dt><code>tck</code></dt><dd><p>The length of tick marks as a fraction of the
smaller of the width or height of the plotting region.
If <code>tck &gt;= 0.5</code> it is interpreted as a fraction of the
relevant side, so if <code>tck = 1</code> grid lines are drawn.  The
default setting (<code>tck = NA</code>) is to use <code>tcl = -0.5</code>.</p>
</dd>
<dt><code>tcl</code></dt><dd><p>The length of tick marks as a fraction of the
height of a line of text.  The default value is <code>-0.5</code>;
setting <code>tcl = NA</code> sets <code>tck = -0.01</code> which is S' default.</p>
</dd>
<dt><code>usr</code></dt><dd><p>A vector of the form <code>c(x1, x2, y1, y2)</code>
giving the extremes of the user coordinates of the plotting
region.  When a logarithmic scale is in use (i.e.,
<code>par("xlog")</code> is true, see below), then the x-limits will be
<code>10 ^ par("usr")[1:2]</code>.  Similarly for the y-axis.
</p>
</dd>
<dt><code>xaxp</code></dt><dd><p>A vector of the form <code>c(x1, x2, n)</code> giving
the coordinates of the extreme tick marks and the number of
intervals between tick-marks when <code>par("xlog")</code> is false.
Otherwise, when <em>log</em> coordinates are active, the three
values have a different meaning: For a small range, <code>n</code> is
<em>negative</em>, and the ticks are as in the linear case,
otherwise, <code>n</code> is in <code>1:3</code>, specifying a case number,
and <code>x1</code> and <code>x2</code> are the lowest and highest power of 10
inside the user coordinates, <code>10 ^ par("usr")[1:2]</code>. (The
<code>"usr"</code> coordinates are log10-transformed here!)
</p>

<dl>
<dt>n = 1</dt><dd><p>will produce tick marks at <code class="reqn">10^j</code> for integer <code class="reqn">j</code>,</p>
</dd>
<dt>n = 2</dt><dd><p>gives marks  <code class="reqn">k 10^j</code> with
<code class="reqn">k \in \{1, 5\}</code>,</p>
</dd>
<dt>n = 3</dt><dd><p>gives marks  <code class="reqn">k 10^j</code> with
<code class="reqn">k \in \{1, 2, 5\}</code>.</p>
</dd>
</dl>

<p>See <code><a href="#topic+axTicks">axTicks</a>()</code> for a pure <span class="rlang"><b>R</b></span> implementation of this.
</p>
<p>This parameter is reset when a user coordinate system is set up,
for example by starting a new page or by calling
<code><a href="#topic+plot.window">plot.window</a></code> or setting <code>par("usr")</code>: <code>n</code>
is taken from <code>par("lab")</code>.  It affects the default behaviour
of subsequent calls to <code><a href="#topic+axis">axis</a></code> for sides 1 or 3.
</p>
<p>It is only relevant to default numeric axis systems, and not for
example to dates.
</p>
</dd>
<dt><code>xaxs</code></dt><dd><p>The style of axis interval calculation to be used
for the x-axis.  Possible values are <code>"r"</code>, <code>"i"</code>,
<code>"e"</code>, <code>"s"</code>, <code>"d"</code>.  The styles are generally
controlled by the range of data or <code>xlim</code>, if given.<br />
Style <code>"r"</code> (regular) first extends the data range by 4
percent at each end and then finds an axis with pretty labels
that fits within the extended range.<br />
Style <code>"i"</code> (internal) just finds an axis with pretty labels
that fits within the original data range.<br />
Style <code>"s"</code> (standard) finds an axis with pretty labels
within which the original data range fits.<br />
Style <code>"e"</code> (extended) is like style <code>"s"</code>, except that
it is also ensures that there is room for plotting symbols within
the bounding box.<br />
Style <code>"d"</code> (direct) specifies that the current axis should
be used on subsequent plots.<br />
(<em>Only <code>"r"</code> and <code>"i"</code> styles have been
implemented in <span class="rlang"><b>R</b></span>.</em>)</p>
</dd>
<dt><code>xaxt</code></dt><dd><p>A character which specifies the x axis type.
Specifying <code>"n"</code> suppresses plotting of the axis.  The
standard value is <code>"s"</code>: for compatibility with S values
<code>"l"</code> and <code>"t"</code> are accepted but are equivalent to
<code>"s"</code>: any value other than <code>"n"</code> implies plotting.</p>
</dd>
<dt><code>xlog</code></dt><dd><p>A logical value (see <code>log</code> in
<code><a href="#topic+plot.default">plot.default</a></code>).  If <code>TRUE</code>, a logarithmic scale
is in use (e.g., after <code>plot(*, log = "x")</code>).
For a new device, it defaults to <code>FALSE</code>, i.e., linear scale.</p>
</dd>
<dt><code>xpd</code></dt><dd><p>A logical value or <code>NA</code>.
If <code>FALSE</code>, all plotting is clipped to the plot region, if
<code>TRUE</code>, all plotting is clipped to the figure region, and if
<code>NA</code>, all plotting is clipped to the device region.  See also
<code><a href="#topic+clip">clip</a></code>.</p>
</dd>
<dt><code>yaxp</code></dt><dd><p>A vector of the form <code>c(y1, y2, n)</code> giving
the coordinates of the extreme tick marks and the number of
intervals between tick-marks unless for log coordinates, see
<code>xaxp</code> above.</p>
</dd>
<dt><code>yaxs</code></dt><dd><p>The style of axis interval calculation to be used
for the y-axis.  See <code>xaxs</code> above.</p>
</dd>
<dt><code>yaxt</code></dt><dd><p>A character which specifies the y axis type.
Specifying <code>"n"</code> suppresses plotting.</p>
</dd>
<dt><code>ylbias</code></dt><dd><p>A positive real value used in the positioning
of text in the margins by <code><a href="#topic+axis">axis</a></code> and
<code><a href="#topic+mtext">mtext</a></code>.  The default is in principle device-specific,
but currently <code>0.2</code> for all of <span class="rlang"><b>R</b></span>'s own devices.  Set this to
<code>0.2</code> for compatibility with <span class="rlang"><b>R</b></span> &lt; 2.14.0 on <code>x11</code> and
<code>windows()</code> devices.</p>
</dd>
<dt><code>ylog</code></dt><dd><p>A logical value; see <code>xlog</code> above.</p>
</dd>
</dl>



<h3>Color Specification</h3>

<p>Colors can be specified in several different ways. The simplest way is
with a character string giving the color name (e.g., <code>"red"</code>).  A
list of the possible colors can be obtained with the function
<code><a href="grDevices.html#topic+colors">colors</a></code>.  Alternatively, colors can be specified directly
in terms of their RGB components with a string of the form
<code>"#RRGGBB"</code> where each of the pairs <code>RR</code>, <code>GG</code>,
<code>BB</code> consist of two hexadecimal digits giving a value in the
range <code>00</code> to <code>FF</code>.  Hexadecimal colors can be in the long
hexadecimal form (e.g., <code>"#rrggbb"</code> or <code>"#rrggbbaa"</code>) or the
short form (e.g, <code>"#rgb"</code> or <code>"#rgba"</code>). The short form is
expanded to the long form by replicating digits (not by adding zeroes),
e.g., <code>"#rgb"</code> becomes <code>"#rrggbb"</code>. Colors can
also be specified by giving an index into a small table of colors, the 
<code><a href="grDevices.html#topic+palette">palette</a></code>: indices wrap round so with the default palette 
of size 8, <code>10</code> is the same as <code>2</code>.  This provides 
compatibility with S.  Index <code>0</code> corresponds to the background 
color.  Note that the palette (apart from <code>0</code> which is per-device)
is a per-session setting.
</p>
<p>Negative integer colours are errors.
</p>
<p>Additionally, <code>"transparent"</code> is <em>transparent</em>, useful for
filled areas (such as the background!), and just invisible for things
like lines or text.  In most circumstances (integer) <code>NA</code>
is equivalent to <code>"transparent"</code> (but not for
<code><a href="#topic+text">text</a></code> and <code><a href="#topic+mtext">mtext</a></code>).
</p>
<p>Semi-transparent colors are available for use on devices that support
them.
</p>
<p>The functions <code><a href="grDevices.html#topic+rgb">rgb</a></code>, <code><a href="grDevices.html#topic+hsv">hsv</a></code>, <code><a href="grDevices.html#topic+hcl">hcl</a></code>,
<code><a href="grDevices.html#topic+gray">gray</a></code> and <code><a href="grDevices.html#topic+rainbow">rainbow</a></code> provide additional ways
of generating colors.
</p>


<h3>Line Type Specification</h3>

<p>Line types can either be specified by giving an index into a small
built-in table of line types (1 = solid, 2 = dashed, etc, see
<code>lty</code> above) or directly as the lengths of on/off stretches of
line.  This is done with a string of an even number (up to eight)
of characters, namely <em>non-zero</em>
(hexadecimal) digits which give the lengths in consecutive positions
in the string.  For example, the string <code>"33"</code> specifies three
units on followed by three off and <code>"3313"</code> specifies three units
on followed by three off followed by one on and finally three off.
The &lsquo;units&rsquo; here are (on most devices) proportional to
<code>lwd</code>, and with <code>lwd = 1</code> are in pixels or points or 1/96
inch.
</p>
<p>The five standard dash-dot line types (<code>lty = 2:6</code>) correspond to
<code>c("44", "13", "1343", "73", "2262")</code>.
</p>
<p>Note that <code>NA</code> is not a valid value for <code>lty</code>.
</p>


<h3>Note</h3>

<p>The effect of restoring all the (settable) graphics parameters as
in the examples is hard to predict if the device has been resized.
Several of them are attempting to set the same things in different
ways, and those last in the alphabet will win.  In particular, the
settings of <code>mai</code>, <code>mar</code>, <code>pin</code>, <code>plt</code> and
<code>pty</code> interact, as do the outer margin settings, the figure
layout and figure region size.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.default">plot.default</a></code> for some high-level plotting parameters;
<code><a href="grDevices.html#topic+colors">colors</a></code>; <code><a href="#topic+clip">clip</a></code>;
<code><a href="base.html#topic+options">options</a></code> for other setup parameters;
graphic devices <code><a href="grDevices.html#topic+x11">x11</a></code>, <code><a href="grDevices.html#topic+pdf">pdf</a></code>,
<code><a href="grDevices.html#topic+postscript">postscript</a></code> and setting up device regions by
<code><a href="#topic+layout">layout</a></code> and <code><a href="#topic+split.screen">split.screen</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>op &lt;- par(mfrow = c(2, 2), # 2 x 2 pictures on one plot
          pty = "s")       # square plotting region,
                           # independent of device size

## At end of plotting, reset to previous settings:
par(op)

## Alternatively,
op &lt;- par(no.readonly = TRUE) # the whole list of settable par's.
## do lots of plotting and par(.) calls, then reset:
par(op)
## Note this is not in general good practice

par("ylog") # FALSE
plot(1 : 12, log = "y")
par("ylog") # TRUE

plot(1:2, xaxs = "i") # 'inner axis' w/o extra space
par(c("usr", "xaxp"))

( nr.prof &lt;-
c(prof.pilots = 16, lawyers = 11, farmers = 10, salesmen = 9, physicians = 9,
  mechanics = 6, policemen = 6, managers = 6, engineers = 5, teachers = 4,
  housewives = 3, students = 3, armed.forces = 1))
par(las = 3)
barplot(rbind(nr.prof)) # R 0.63.2: shows alignment problem
par(las = 0)  # reset to default

require(grDevices) # for gray
## 'fg' use:
plot(1:12, type = "b", main = "'fg' : axes, ticks and box in gray",
     fg = gray(0.7), bty = "7" , sub = R.version.string)

ex &lt;- function() {
   old.par &lt;- par(no.readonly = TRUE) # all par settings which
                                      # could be changed.
   on.exit(par(old.par))
   ## ...
   ## ... do lots of par() settings and plots
   ## ...
   invisible() #-- now,  par(old.par)  will be executed
}
ex()

## Line types
showLty &lt;- function(ltys, xoff = 0, ...) {
   stopifnot((n &lt;- length(ltys)) &gt;= 1)
   op &lt;- par(mar = rep(.5,4)); on.exit(par(op))
   plot(0:1, 0:1, type = "n", axes = FALSE, ann = FALSE)
   y &lt;- (n:1)/(n+1)
   clty &lt;- as.character(ltys)
   mytext &lt;- function(x, y, txt)
      text(x, y, txt, adj = c(0, -.3), cex = 0.8, ...)
   abline(h = y, lty = ltys, ...); mytext(xoff, y, clty)
   y &lt;- y - 1/(3*(n+1))
   abline(h = y, lty = ltys, lwd = 2, ...)
   mytext(1/8+xoff, y, paste(clty," lwd = 2"))
}
showLty(c("solid", "dashed", "dotted", "dotdash", "longdash", "twodash"))
par(new = TRUE)  # the same:
showLty(c("solid", "44", "13", "1343", "73", "2262"), xoff = .2, col = 2)
showLty(c("11", "22", "33", "44",   "12", "13", "14",   "21", "31"))
</code></pre>

<hr>
<h2 id='persp'>Perspective Plots</h2><span id='topic+persp'></span><span id='topic+persp.default'></span>

<h3>Description</h3>

<p>This function draws perspective plots of a surface over the
x&ndash;y plane.  <code>persp</code> is a generic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>persp(x, ...)

## Default S3 method:
persp(x = seq(0, 1, length.out = nrow(z)),
      y = seq(0, 1, length.out = ncol(z)),
      z, xlim = range(x), ylim = range(y),
      zlim = range(z, na.rm = TRUE),
      xlab = NULL, ylab = NULL, zlab = NULL,
      main = NULL, sub = NULL,
      theta = 0, phi = 15, r = sqrt(3), d = 1,
      scale = TRUE, expand = 1,
      col = "white", border = NULL, ltheta = -135, lphi = 0,
      shade = NA, box = TRUE, axes = TRUE, nticks = 5,
      ticktype = "simple", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="persp_+3A_x">x</code>, <code id="persp_+3A_y">y</code></td>
<td>
<p>locations of grid lines at which the values in <code>z</code> are
measured.  These must be in ascending order.  By default, equally
spaced values from 0 to 1 are used.  If <code>x</code> is a <code>list</code>,
its components <code>x$x</code> and <code>x$y</code> are used for <code>x</code>
and <code>y</code>, respectively.</p>
</td></tr>
<tr><td><code id="persp_+3A_z">z</code></td>
<td>
<p>a matrix containing the values to be plotted (<code>NA</code>s are
allowed).  Note that <code>x</code> can be used instead of <code>z</code> for
convenience.</p>
</td></tr>
<tr><td><code id="persp_+3A_xlim">xlim</code>, <code id="persp_+3A_ylim">ylim</code>, <code id="persp_+3A_zlim">zlim</code></td>
<td>
<p>x-, y-  and z-limits.  These should be chosen
to cover the range of values of the surface: see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="persp_+3A_xlab">xlab</code>, <code id="persp_+3A_ylab">ylab</code>, <code id="persp_+3A_zlab">zlab</code></td>
<td>
<p>titles for the axes.  N.B. These must be
character strings; expressions are not accepted.  Numbers will be
coerced to character strings.</p>
</td></tr>
<tr><td><code id="persp_+3A_main">main</code>, <code id="persp_+3A_sub">sub</code></td>
<td>
<p>main title and subtitle, as for <code><a href="#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="persp_+3A_theta">theta</code>, <code id="persp_+3A_phi">phi</code></td>
<td>
<p>angles defining the viewing direction.
<code>theta</code> gives the azimuthal direction and <code>phi</code>
the colatitude.</p>
</td></tr>
<tr><td><code id="persp_+3A_r">r</code></td>
<td>
<p>the distance of the eyepoint from the centre of the plotting box.</p>
</td></tr>
<tr><td><code id="persp_+3A_d">d</code></td>
<td>
<p>a value which can be used to vary the strength of
the perspective transformation.  Values of <code>d</code> greater
than 1 will lessen the perspective effect and values less
and 1 will exaggerate it.</p>
</td></tr>
<tr><td><code id="persp_+3A_scale">scale</code></td>
<td>
<p>before viewing the x, y and z coordinates of the
points defining the surface are transformed to the interval
[0,1].  If <code>scale</code> is <code>TRUE</code> the x, y and z coordinates
are transformed separately.  If <code>scale</code> is <code>FALSE</code>
the coordinates are scaled so that aspect ratios are retained.
This is useful for rendering things like DEM information.</p>
</td></tr>
<tr><td><code id="persp_+3A_expand">expand</code></td>
<td>
<p>a expansion factor applied to the <code>z</code>
coordinates. Often used with <code>0 &lt; expand &lt; 1</code> to shrink the
plotting box in the <code>z</code> direction.</p>
</td></tr>
<tr><td><code id="persp_+3A_col">col</code></td>
<td>
<p>the color(s) of the surface facets.  Transparent colours are
ignored.  This is recycled to the <code class="reqn">(nx-1)(ny-1)</code> facets.</p>
</td></tr>
<tr><td><code id="persp_+3A_border">border</code></td>
<td>
<p>the color of the line drawn around the surface facets.
The default, <code>NULL</code>, corresponds to <code>par("fg")</code>.
A value of <code>NA</code> will disable the drawing of borders: this is
sometimes useful when the surface is shaded.</p>
</td></tr>
<tr><td><code id="persp_+3A_ltheta">ltheta</code>, <code id="persp_+3A_lphi">lphi</code></td>
<td>
<p>if finite values are specified for <code>ltheta</code>
and <code>lphi</code>, the surface is shaded as though it was being
illuminated from the direction specified by azimuth <code>ltheta</code>
and colatitude <code>lphi</code>.</p>
</td></tr>
<tr><td><code id="persp_+3A_shade">shade</code></td>
<td>
<p>the shade at a surface facet is computed as
<code>((1+d)/2)^shade</code>, where <code>d</code> is the dot product of
a unit vector normal to the facet and a unit vector in the
direction of a light source.  Values of <code>shade</code> close
to one yield shading similar to a point light source model
and values close to zero produce no shading.  Values in the
range 0.5 to 0.75 provide an approximation to daylight
illumination.</p>
</td></tr>
<tr><td><code id="persp_+3A_box">box</code></td>
<td>
<p>should the bounding box for the surface be displayed.
The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="persp_+3A_axes">axes</code></td>
<td>
<p>should ticks and labels be added to the box.  The
default is <code>TRUE</code>.  If <code>box</code> is <code>FALSE</code> then no
ticks or labels are drawn.</p>
</td></tr>
<tr><td><code id="persp_+3A_ticktype">ticktype</code></td>
<td>
<p>character: <code>"simple"</code> draws just an arrow
parallel to the axis to indicate direction of increase;
<code>"detailed"</code> draws normal ticks as per 2D plots.</p>
</td></tr>
<tr><td><code id="persp_+3A_nticks">nticks</code></td>
<td>
<p>the (approximate) number of tick marks to draw on the
axes.  Has no effect if <code>ticktype</code> is <code>"simple"</code>.</p>
</td></tr>
<tr><td><code id="persp_+3A_...">...</code></td>
<td>
<p>additional <a href="#topic+graphical+20parameters">graphical parameters</a> (see <code><a href="#topic+par">par</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plots are produced by first transforming the (x,y,z)
coordinates to the interval [0,1] using the limits supplied or
computed from the range of the data.  The surface is then viewed
by looking at the origin from a direction defined by <code>theta</code>
and <code>phi</code>.  If <code>theta</code> and <code>phi</code> are both zero
the viewing direction is directly down the negative y axis.
Changing <code>theta</code> will vary the azimuth and changing <code>phi</code>
the colatitude.
</p>
<p>There is a hook called <code>"persp"</code> (see <code><a href="base.html#topic+setHook">setHook</a></code>)
called after the plot is completed, which is used in the
testing code to annotate the plot page.  The hook function(s) are
called with no argument.
</p>
<p>Notice that <code>persp</code> interprets the <code>z</code> matrix as a table of
<code>f(x[i], y[j])</code> values, so that the x axis corresponds to row
number and the y axis to column number, with column 1 at the bottom,
so that with the standard rotation angles, the top left corner of the
matrix is displayed at the left hand side, closest to the user.
</p>
<p>The sizes and fonts of the axis labels and the annotations for
<code>ticktype = "detailed"</code> are controlled by graphics parameters
<code>"cex.lab"</code>/<code>"font.lab"</code> and
<code>"cex.axis"</code>/<code>"font.axis"</code> respectively.
</p>
<p>The bounding box is drawn with edges of faces facing away from the
viewer (and hence at the back of the box) with solid lines and other
edges dashed and on top of the surface.  This (and the plotting of the
axes) assumes that the axis limits are chosen so that the surface
is within the box, and the function will warn if this is not the case.
</p>


<h3>Value</h3>

<p><code>persp()</code> returns the <em>viewing transformation matrix</em>, say
<code>VT</code>, a <code class="reqn">4 \times 4</code> matrix suitable for projecting 3D
coordinates <code class="reqn">(x,y,z)</code> into the 2D plane using homogeneous 4D
coordinates <code class="reqn">(x,y,z,t)</code>.  It can be used to superimpose
additional graphical elements on the 3D plot, by
<code><a href="#topic+lines">lines</a>()</code> or <code><a href="#topic+points">points</a>()</code>, using the
function <code><a href="grDevices.html#topic+trans3d">trans3d</a>()</code>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+contour">contour</a></code> and <code><a href="#topic+image">image</a></code>; <code><a href="grDevices.html#topic+trans3d">trans3d</a></code>.
</p>
<p>Rotatable 3D plots can be produced by package <a href="https://CRAN.R-project.org/package=rgl"><span class="pkg">rgl</span></a>: other
ways to produce static perspective plots are available in packages
<a href="https://CRAN.R-project.org/package=lattice"><span class="pkg">lattice</span></a> and <a href="https://CRAN.R-project.org/package=scatterplot3d"><span class="pkg">scatterplot3d</span></a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(grDevices) # for trans3d
## More examples in  demo(persp) !!
##                   -----------

# (1) The Obligatory Mathematical surface.
#     Rotated sinc function.

x &lt;- seq(-10, 10, length.out = 30)
y &lt;- x
f &lt;- function(x, y) { r &lt;- sqrt(x^2+y^2); 10 * sin(r)/r }
z &lt;- outer(x, y, f)
op &lt;- par(bg = "white")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")
persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue",
      ltheta = 120, shade = 0.75, ticktype = "detailed",
      xlab = "X", ylab = "Y", zlab = "Sinc( r )", cex.axis = 0.8
) -&gt; res
round(res, 3)

# (2) Add to existing persp plot - using trans3d() :

xE &lt;- c(-10,10); xy &lt;- expand.grid(xE, xE)
points(trans3d(xy[,1], xy[,2], z = 6,          pmat = res), col = 2, pch = 16)
lines (trans3d(x,      y = 10, z = 6 + sin(x), pmat = res), col = 3)

phi &lt;- seq(0, 2*pi, length.out = 201)
r1 &lt;- 7.725 # radius of 2nd maximum
xr &lt;- r1 * cos(phi)
yr &lt;- r1 * sin(phi)
lines(trans3d(xr,yr, f(xr,yr), res), col = "pink", lwd = 2)
## (no hidden lines)

# (3) Visualizing a simple DEM model

z &lt;- 2 * volcano        # Exaggerate the relief
x &lt;- 10 * (1:nrow(z))   # 10 meter spacing (S to N)
y &lt;- 10 * (1:ncol(z))   # 10 meter spacing (E to W)
## Don't draw the grid lines :  border = NA
par(bg = "slategray")
persp(x, y, z, theta = 135, phi = 30, col = "green3", scale = FALSE,
      ltheta = -120, shade = 0.75, border = NA, box = FALSE)

# (4) Surface colours corresponding to z-values

par(bg = "white")
x &lt;- seq(-1.95, 1.95, length.out = 30)
y &lt;- seq(-1.95, 1.95, length.out = 35)
z &lt;- outer(x, y, function(a, b) a*b^2)
nrz &lt;- nrow(z)
ncz &lt;- ncol(z)
# Create a function interpolating colors in the range of specified colors
jet.colors &lt;- colorRampPalette( c("blue", "green") )
# Generate the desired number of colors from this palette
nbcol &lt;- 100
color &lt;- jet.colors(nbcol)
# Compute the z-value at the facet centres
zfacet &lt;- z[-1, -1] + z[-1, -ncz] + z[-nrz, -1] + z[-nrz, -ncz]
# Recode facet z-values into color indices
facetcol &lt;- cut(zfacet, nbcol)
persp(x, y, z, col = color[facetcol], phi = 30, theta = -30)

par(op)
</code></pre>

<hr>
<h2 id='pie'>Pie Charts</h2><span id='topic+pie'></span>

<h3>Description</h3>

<p>Draw a pie chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pie(x, labels = names(x), edges = 200, radius = 0.8,
    clockwise = FALSE, init.angle = if(clockwise) 90 else 0,
    density = NULL, angle = 45, col = NULL, border = NULL,
    lty = NULL, main = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pie_+3A_x">x</code></td>
<td>
<p>a vector of non-negative numerical quantities.
The values in <code>x</code> are displayed as the areas of pie slices.</p>
</td></tr>
<tr><td><code id="pie_+3A_labels">labels</code></td>
<td>
<p>one or more expressions or character strings giving
names for the slices.  Other objects are coerced by
<code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>.  For empty or <code>NA</code>
(after coercion to character) labels, no label nor pointing line
is drawn.</p>
</td></tr>
<tr><td><code id="pie_+3A_edges">edges</code></td>
<td>
<p>the circular outline of the pie is approximated by a
polygon with this many edges.</p>
</td></tr>
<tr><td><code id="pie_+3A_radius">radius</code></td>
<td>
<p>the pie is drawn centered in a square box whose sides
range from <code class="reqn">-1</code> to <code class="reqn">1</code>.  If the character strings labeling
the slices are long it may be necessary to use a smaller radius.</p>
</td></tr>
<tr><td><code id="pie_+3A_clockwise">clockwise</code></td>
<td>
<p>logical indicating if slices are drawn clockwise or
counter clockwise (i.e., mathematically positive direction), the
latter is default.</p>
</td></tr>
<tr><td><code id="pie_+3A_init.angle">init.angle</code></td>
<td>
<p>number specifying the <em>starting angle</em> (in
degrees) for the slices. Defaults to 0 (i.e., &lsquo;3 o'clock&rsquo;)
unless <code>clockwise</code> is true where <code>init.angle</code>
defaults to 90 (degrees), (i.e., &lsquo;12 o'clock&rsquo;).</p>
</td></tr>
<tr><td><code id="pie_+3A_density">density</code></td>
<td>
<p>the density of shading lines, in lines per inch.
The default value of <code>NULL</code> means that no shading lines
are drawn. Non-positive values of <code>density</code> also inhibit the
drawing of shading lines.</p>
</td></tr>
<tr><td><code id="pie_+3A_angle">angle</code></td>
<td>
<p>the slope of shading lines, given as an angle in
degrees (counter-clockwise).</p>
</td></tr>
<tr><td><code id="pie_+3A_col">col</code></td>
<td>
<p>a vector of colors to be used in filling or shading
the slices. If missing a set of 6 pastel colours is used,
unless <code>density</code> is specified when <code>par("fg")</code> is used.</p>
</td></tr>
<tr><td><code id="pie_+3A_border">border</code>, <code id="pie_+3A_lty">lty</code></td>
<td>
<p>(possibly vectors) arguments passed to
<code><a href="#topic+polygon">polygon</a></code> which draws each slice.</p>
</td></tr>
<tr><td><code id="pie_+3A_main">main</code></td>
<td>
<p>an overall title for the plot.</p>
</td></tr>
<tr><td><code id="pie_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> can be given as arguments to
<code>pie</code>.  They will affect the main title and labels only.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Pie charts are a very bad way of displaying information.
The eye is good at judging linear measures and bad at judging
relative areas.  A bar chart or dot chart is a preferable way of
displaying this type of data.
</p>
<p>Cleveland (1985), page 264: &ldquo;Data that can be shown by pie charts
always can be shown by a dot chart.  This means that judgements of
position along a common scale can be made instead of the less
accurate angle judgements.&rdquo;
This statement is based on the empirical investigations of Cleveland
and McGill as well as investigations by perceptual psychologists.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Cleveland, W. S. (1985)
<em>The Elements of Graphing Data</em>.
Wadsworth: Monterey, CA, USA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dotchart">dotchart</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(grDevices)
pie(rep(1, 24), col = rainbow(24), radius = 0.9)

pie.sales &lt;- c(0.12, 0.3, 0.26, 0.16, 0.04, 0.12)
names(pie.sales) &lt;- c("Blueberry", "Cherry",
    "Apple", "Boston Cream", "Other", "Vanilla Cream")
pie(pie.sales) # default colours
pie(pie.sales, col = c("purple", "violetred1", "green3",
                       "cornsilk", "cyan", "white"))
pie(pie.sales, col = gray(seq(0.4, 1.0, length.out = 6)))
pie(pie.sales, density = 10, angle = 15 + 10 * 1:6)
pie(pie.sales, clockwise = TRUE, main = "pie(*, clockwise = TRUE)")
segments(0, 0, 0, 1, col = "red", lwd = 2)
text(0, 1, "init.angle = 90", col = "red")

n &lt;- 200
pie(rep(1, n), labels = "", col = rainbow(n), border = NA,
    main = "pie(*, labels=\"\", col=rainbow(n), border=NA,..")

## Another case showing pie() is rather fun than science:
## (original by FinalBackwardsGlance on http://imgur.com/gallery/wWrpU4X)
pie(c(Sky = 78, "Sunny side of pyramid" = 17, "Shady side of pyramid" = 5),
    init.angle = 315, col = c("deepskyblue", "yellow", "yellow3"), border = FALSE)
</code></pre>

<hr>
<h2 id='plot.data.frame'>Plot Method for Data Frames</h2><span id='topic+plot.data.frame'></span>

<h3>Description</h3>

<p><code>plot.data.frame</code>, a method for the <code><a href="#topic+plot">plot</a></code> generic.
It is designed for a quick look at numeric data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.data.frame_+3A_x">x</code></td>
<td>
<p>object of class <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="plot.data.frame_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="#topic+stripchart">stripchart</a></code>,
<code><a href="#topic+plot.default">plot.default</a></code> or <code><a href="#topic+pairs">pairs</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is intended for data frames with <em>numeric</em> columns. For more
than two columns it first calls <code><a href="base.html#topic+data.matrix">data.matrix</a></code> to convert
the data frame to a numeric matrix and then calls <code><a href="#topic+pairs">pairs</a></code>
to produce a scatterplot matrix.  This can fail and may well be
inappropriate: for example numerical conversion of dates will lose
their special meaning and a warning will be given.
</p>
<p>For a two-column data frame it plots the second column against the
first by the most appropriate method for the first column.
</p>
<p>For a single numeric column it uses <code><a href="#topic+stripchart">stripchart</a></code>, and for
other single-column data frames tries to find a plot method for the
single column.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+data.frame">data.frame</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(OrchardSprays[1], method = "jitter")
plot(OrchardSprays[c(4,1)])
plot(OrchardSprays)

plot(iris)
plot(iris[5:4])
plot(women)
</code></pre>

<hr>
<h2 id='plot.default'>The Default Scatterplot Function</h2><span id='topic+plot.default'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>Draw a scatter plot with decorations such as axes and titles
in the active graphics window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
plot(x, y = NULL, type = "p",  xlim = NULL, ylim = NULL,
     log = "", main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
     ann = par("ann"), axes = TRUE, frame.plot = axes,
     panel.first = NULL, panel.last = NULL, asp = NA,
     xgap.axis = NA, ygap.axis = NA,
     ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.default_+3A_x">x</code>, <code id="plot.default_+3A_y">y</code></td>
<td>
<p>the <code>x</code> and <code>y</code> arguments provide the x and y
coordinates for the plot.  Any reasonable way of defining the
coordinates is acceptable.  See the function <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>
for details.  If supplied separately, they must be of the same length.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_type">type</code></td>
<td>
<p>1-character string giving the type of plot desired.  The
following values are possible, for details, see <code><a href="#topic+plot">plot</a></code>:
<code>"p"</code> for points, <code>"l"</code> for lines,
<code>"b"</code> for both points and lines,
<code>"c"</code> for empty points joined by lines,
<code>"o"</code> for overplotted points and lines,
<code>"s"</code> and <code>"S"</code> for stair steps and
<code>"h"</code> for histogram-like vertical lines.  Finally,
<code>"n"</code> does not produce any points or lines.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_xlim">xlim</code></td>
<td>
<p>the x limits (x1, x2) of the plot.  Note that <code>x1 &gt; x2</code>
is allowed and leads to a &lsquo;reversed axis&rsquo;.
</p>
<p>The default value, <code>NULL</code>, indicates that the range of the
<a href="base.html#topic+finite">finite</a> values to be plotted should be used.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_ylim">ylim</code></td>
<td>
<p>the y limits of the plot.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_log">log</code></td>
<td>
<p>a character string which contains <code>"x"</code> if the x axis
is to be logarithmic, <code>"y"</code> if the y axis is to be logarithmic
and <code>"xy"</code> or <code>"yx"</code> if both axes are to be logarithmic.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_main">main</code></td>
<td>
<p>a main title for the plot, see also <code><a href="#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_sub">sub</code></td>
<td>
<p>a subtitle for the plot.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis, defaults to a description of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis, defaults to a description of <code>y</code>.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_ann">ann</code></td>
<td>
<p>a logical value indicating whether the default annotation
(title and x and y axis labels) should appear on the plot.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_axes">axes</code></td>
<td>
<p>a logical value indicating whether both axes should be drawn on
the plot.  Use <a href="#topic+graphical+20parameter">graphical parameter</a> <code>"xaxt"</code> or <code>"yaxt"</code>
to suppress just one of the axes.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_frame.plot">frame.plot</code></td>
<td>
<p>a logical indicating whether a box should be drawn
around the plot.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_panel.first">panel.first</code></td>
<td>
<p>an &lsquo;expression&rsquo; to be evaluated after the
plot axes are set up but before any plotting takes place.  This can
be useful for drawing background grids or scatterplot smooths.  Note
that this works by lazy evaluation: passing this argument from other
<code>plot</code> methods may well not work since it may be evaluated too
early.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_panel.last">panel.last</code></td>
<td>
<p>an expression to be evaluated after plotting has
taken place but before the axes, title and box are added.  See the
comments about <code>panel.first</code>.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_asp">asp</code></td>
<td>
<p>the <code class="reqn">y/x</code> aspect ratio, see <code><a href="#topic+plot.window">plot.window</a></code>.</p>
</td></tr>
<tr><td><code id="plot.default_+3A_xgap.axis">xgap.axis</code>, <code id="plot.default_+3A_ygap.axis">ygap.axis</code></td>
<td>
<p>the <code class="reqn">x/y</code> axis gap factors, passed as
<code>gap.axis</code> to the two <code><a href="#topic+axis">axis</a>()</code> calls (when
<code>axes</code> is true, as per default).</p>
</td></tr>
<tr><td><code id="plot.default_+3A_...">...</code></td>
<td>
<p>other <a href="#topic+graphical+20parameters">graphical parameters</a> (see <code><a href="#topic+par">par</a></code> and
section &lsquo;Details&rsquo; below).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Commonly used <a href="#topic+graphical+20parameters">graphical parameters</a> are:
</p>

<dl>
<dt><code>col</code></dt><dd><p>The colors for lines and points.  Multiple colors can be
specified so that each point can be given its own color.  If there
are fewer colors than points they are recycled in the standard
fashion.  Lines will all be plotted in the first colour specified.</p>
</dd>
<dt><code>bg</code></dt><dd><p>a vector of background colors for open plot symbols, see
<code><a href="#topic+points">points</a></code>.  Note: this is <b>not</b> the same setting
as <code><a href="#topic+par">par</a>("bg")</code>.</p>
</dd>
<dt><code>pch</code></dt><dd><p>a vector of plotting characters or symbols:
see <code><a href="#topic+points">points</a></code>.</p>
</dd>
<dt><code>cex</code></dt><dd><p>a numerical vector giving the amount by which
plotting characters and symbols should be scaled relative to the
default.  This works as a multiple of <code><a href="#topic+par">par</a>("cex")</code>.
<code>NULL</code> and <code>NA</code> are equivalent to <code>1.0</code>.  Note that
this does not affect annotation: see below.</p>
</dd>
<dt><code>lty</code></dt><dd><p>a vector of line types, see <code><a href="#topic+par">par</a></code>.</p>
</dd>
<dt><code>cex.main</code>, <code>col.lab</code>, <code>font.sub</code>,
etc</dt><dd><p>settings for main- and sub-title and axis annotation, see
<code><a href="#topic+title">title</a></code> and <code><a href="#topic+par">par</a></code>.</p>
</dd>
<dt><code>lwd</code></dt><dd><p>a vector of line widths, see <code><a href="#topic+par">par</a></code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>The presence of <code>panel.first</code> and <code>panel.last</code> is a
historical anomaly: default plots do not have &lsquo;panels&rsquo;, unlike
e.g. <code><a href="#topic+pairs">pairs</a></code> plots.  For more control, use lower-level
plotting functions: <code>plot.default</code> calls in turn some of
<code><a href="#topic+plot.new">plot.new</a></code>, <code><a href="#topic+plot.window">plot.window</a></code>,
<code><a href="#topic+plot.xy">plot.xy</a></code>, <code><a href="#topic+axis">axis</a></code>, <code><a href="#topic+box">box</a></code> and
<code><a href="#topic+title">title</a></code>, and plots can be built up by calling these
individually, or by calling <code>plot(type = "n")</code> and adding further
elements.
</p>
<p>The <code>plot</code> generic was moved from the <span class="pkg">graphics</span> package to
the <span class="pkg">base</span> package in <span class="rlang"><b>R</b></span> 4.0.0. It is currently re-exported from
the <span class="pkg">graphics</span> namespace to allow packages importing it from there
to continue working, but this may change in future versions of <span class="rlang"><b>R</b></span>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Cleveland, W. S. (1985)
<em>The Elements of Graphing Data.</em>
Monterey, CA: Wadsworth.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+plot.window">plot.window</a></code>, <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.
For thousands of points, consider using <code><a href="#topic+smoothScatter">smoothScatter</a></code>
instead.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Speed &lt;- cars$speed
Distance &lt;- cars$dist
plot(Speed, Distance, panel.first = grid(8, 8),
     pch = 0, cex = 1.2, col = "blue")
plot(Speed, Distance,
     panel.first = lines(stats::lowess(Speed, Distance), lty = "dashed"),
     pch = 0, cex = 1.2, col = "blue")

## Show the different plot types
x &lt;- 0:12
y &lt;- sin(pi/5 * x)
op &lt;- par(mfrow = c(3,3), mar = .1+ c(2,2,3,1))
for (tp in c("p","l","b",  "c","o","h",  "s","S","n")) {
   plot(y ~ x, type = tp, main = paste0("plot(*, type = \"", tp, "\")"))
   if(tp == "S") {
      lines(x, y, type = "s", col = "red", lty = 2)
      mtext("lines(*, type = \"s\", ...)", col = "red", cex = 0.8)
   }
}
par(op)

##--- Log-Log Plot  with  custom axes
lx &lt;- seq(1, 5, length.out = 41)
yl &lt;- expression(e^{-frac(1,2) * {log[10](x)}^2})
y &lt;- exp(-.5*lx^2)
op &lt;- par(mfrow = c(2,1), mar = par("mar")-c(1,0,2,0), mgp = c(2, .7, 0))
plot(10^lx, y, log = "xy", type = "l", col = "purple",
     main = "Log-Log plot", ylab = yl, xlab = "x")
plot(10^lx, y, log = "xy", type = "o", pch = ".", col = "forestgreen",
     main = "Log-Log plot with custom axes", ylab = yl, xlab = "x",
     axes = FALSE, frame.plot = TRUE)
my.at &lt;- 10^(1:5)
axis(1, at = my.at, labels = formatC(my.at, format = "fg"))
e.y &lt;- -5:-1 ; at.y &lt;- 10^e.y
axis(2, at = at.y, col.axis = "red", las = 1,
     labels = as.expression(lapply(e.y, function(E) bquote(10^.(E)))))
par(op)
</code></pre>

<hr>
<h2 id='plot.design'>Plot Univariate Effects of a Design or Model</h2><span id='topic+plot.design'></span>

<h3>Description</h3>

<p>Plot univariate effects of one or more <code><a href="base.html#topic+factor">factor</a></code>s,
typically for a designed experiment as analyzed by <code><a href="stats.html#topic+aov">aov</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot.design(x, y = NULL, fun = mean, data = NULL, ...,
            ylim = NULL, xlab = "Factors", ylab = NULL,
            main = NULL, ask = NULL, xaxt = par("xaxt"),
            axes = TRUE, xtick = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.design_+3A_x">x</code></td>
<td>
<p>either a data frame containing the design factors and
optionally the response, or a <code><a href="stats.html#topic+formula">formula</a></code> or
<code><a href="stats.html#topic+terms">terms</a></code> object.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_y">y</code></td>
<td>
<p>the response, if not given in x.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_fun">fun</code></td>
<td>
<p>a function (or name of one) to be applied to each
subset.  It must return one number for a numeric (vector) input.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_data">data</code></td>
<td>
<p>data frame containing the variables referenced by <code>x</code>
when that is formula-like.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> such as <code>col</code>,
see <code><a href="#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_ylim">ylim</code></td>
<td>
<p>range of y values, as in <code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_xlab">xlab</code></td>
<td>
<p>x axis label, see <code><a href="#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_ylab">ylab</code></td>
<td>
<p>y axis label with a &lsquo;smart&rsquo; default.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_main">main</code></td>
<td>
<p>main title, see <code><a href="#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_ask">ask</code></td>
<td>
<p>logical indicating if the user should be asked before a new
page is started &ndash; in the case of multiple y values.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_xaxt">xaxt</code></td>
<td>
<p>character giving the type of x axis.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_axes">axes</code></td>
<td>
<p>logical indicating if axes should be drawn.</p>
</td></tr>
<tr><td><code id="plot.design_+3A_xtick">xtick</code></td>
<td>
<p>logical indicating if ticks (one per factor) should
be drawn on the x axis.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The supplied function will be called once for each level of each
factor in the design and the plot will show these summary values.  The
levels of a particular factor are shown along a vertical line, and the
overall value of <code>fun()</code> for the response is drawn as a
horizontal line.
</p>


<h3>Note</h3>

<p>A big effort was taken to make this closely compatible to the S
version.  However, <code>col</code> (and <code>fg</code>) specifications have
different effects.
</p>
<p>In S this was a method of the <code><a href="#topic+plot">plot</a></code> generic function for
<code>design</code> objects.
</p>


<h3>Author(s)</h3>

<p>Roberto Frisullo and Martin Maechler</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. eds (1992)
<em>Statistical Models in S</em>.
Chapman &amp; Hall, London, <b>the</b> <em>white book</em>, pp. 546&ndash;7 (and 163&ndash;4).
</p>
<p>Freeny, A. E. and Landwehr, J. M. (1990)
Displays for data from large designed experiments;
Computer Science and Statistics: Proc.\ 22nd Symp\. Interface, 117&ndash;126,
Springer Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+interaction.plot">interaction.plot</a></code> for a &lsquo;standard graphic&rsquo;
of designed experiments.</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)
plot.design(warpbreaks)  # automatic for data frame with one numeric var.

Form &lt;- breaks ~ wool + tension
summary(fm1 &lt;- aov(Form, data = warpbreaks))
plot.design(       Form, data = warpbreaks, col = 2)  # same as above

## More than one y :
utils::str(esoph)
plot.design(esoph) ## two plots; if interactive you are "ask"ed

## or rather, compare mean and median:
op &lt;- par(mfcol = 1:2)
plot.design(ncases/ncontrols ~ ., data = esoph, ylim = c(0, 0.8))
plot.design(ncases/ncontrols ~ ., data = esoph, ylim = c(0, 0.8),
            fun = median)
par(op)
</code></pre>

<hr>
<h2 id='plot.factor'>Plotting Factor Variables</h2><span id='topic+plot.factor'></span>

<h3>Description</h3>

<p>This functions implements a scatterplot method for
<code><a href="base.html#topic+factor">factor</a></code> arguments of the <em>generic</em>
<code><a href="#topic+plot">plot</a></code> function.
</p>
<p>If <code>y</code> is missing <code><a href="#topic+barplot">barplot</a></code> is produced.
For numeric <code>y</code> a <code><a href="#topic+boxplot">boxplot</a></code> is used, and for a factor
<code>y</code> a <code><a href="#topic+spineplot">spineplot</a></code> is shown.  For any other type of
<code>y</code> the next <code>plot</code> method is called, normally
<code><a href="#topic+plot.default">plot.default</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'factor'
plot(x, y, legend.text = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.factor_+3A_x">x</code>, <code id="plot.factor_+3A_y">y</code></td>
<td>
<p>numeric or factor. <code>y</code> may be missing.</p>
</td></tr>
<tr><td><code id="plot.factor_+3A_legend.text">legend.text</code></td>
<td>
<p>character vector for annotation of y axis in the
case of a factor <code>y</code>: defaults to <code>levels(y)</code>.  This
sets the <code>yaxlabels</code> argument of <code><a href="#topic+spineplot">spineplot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.factor_+3A_...">...</code></td>
<td>
<p>Further arguments to <code><a href="#topic+barplot">barplot</a></code>,
<code><a href="#topic+boxplot">boxplot</a></code>, <code><a href="#topic+spineplot">spineplot</a></code> or
<code><a href="#topic+plot">plot</a></code> as appropriate.  All of these accept
<a href="#topic+graphical+20parameters">graphical parameters</a> (see <code><a href="#topic+par">par</a></code>) and
annotation arguments passed
to <code><a href="#topic+title">title</a></code> and <code>axes = FALSE</code>.  None accept <code>type</code>.
</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.default">plot.default</a></code>, <code><a href="#topic+plot.formula">plot.formula</a></code>,
<code><a href="#topic+barplot">barplot</a></code>, <code><a href="#topic+boxplot">boxplot</a></code>, <code><a href="#topic+spineplot">spineplot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(grDevices)
plot(weight ~ group, data = PlantGrowth)           # numeric vector ~ factor
plot(cut(weight, 2) ~ group, data = PlantGrowth)   # factor ~ factor
## passing "..." to spineplot() eventually:
plot(cut(weight, 3) ~ group, data = PlantGrowth,
     col = hcl(c(0, 120, 240), 50, 70))

plot(PlantGrowth$group, axes = FALSE, main = "no axes")  # extremely silly
</code></pre>

<hr>
<h2 id='plot.formula'>Formula Notation for Scatterplots</h2><span id='topic+plot.formula'></span><span id='topic+lines.formula'></span><span id='topic+points.formula'></span><span id='topic+text.formula'></span>

<h3>Description</h3>

<p>Specify a scatterplot or add points, lines, or text via a formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'formula'
plot(formula, data = parent.frame(), ..., subset,
             ylab = varnames[response], ask = dev.interactive())

## S3 method for class 'formula'
points(formula, data = parent.frame(), ..., subset)

## S3 method for class 'formula'
lines(formula, data = parent.frame(), ..., subset)

## S3 method for class 'formula'
text(formula, data = parent.frame(), ..., subset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.formula_+3A_formula">formula</code></td>
<td>
<p>a <code><a href="stats.html#topic+formula">formula</a></code>, such as <code>y ~ x</code>.</p>
</td></tr>
<tr><td><code id="plot.formula_+3A_data">data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>formula</code> should be taken.  A matrix is converted to a data frame.</p>
</td></tr>
<tr><td><code id="plot.formula_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to or from other methods.
<code>horizontal = TRUE</code> is also accepted.</p>
</td></tr>
<tr><td><code id="plot.formula_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="plot.formula_+3A_ylab">ylab</code></td>
<td>
<p>the y label of the plot(s).</p>
</td></tr>
<tr><td><code id="plot.formula_+3A_ask">ask</code></td>
<td>
<p>logical, see <code><a href="#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the <code>lines</code>, <code>points</code> and <code>text</code> methods the formula
should be of the form <code>y ~ x</code> or <code>y ~ 1</code> with a left-hand
side and a single term on the right-hand side.  The <code>plot</code> method
accepts other forms discussed later in this section.
</p>
<p>Both the terms in the formula and the <code>...</code> arguments are
evaluated in <code>data</code> enclosed in <code>parent.frame()</code> if
<code>data</code> is a list or a data frame.  The terms of the formula and
those arguments in <code>...</code> that are of the same length as
<code>data</code> are subjected to the subsetting specified in
<code>subset</code>.  A plot against the running index can be specified as
<code>plot(y ~ 1)</code>.
</p>
<p>If the formula in the <code>plot</code> method contains more than one term
on the right-hand side, a series of plots is produced of the response
against each non-response term.
</p>
<p>For the <code>plot</code> method the formula can be of the form
<code>~ z + y + z</code>: the variables specified on the right-hand side are
collected into a data frame, subsetted if specified, and displayed by
<code><a href="#topic+plot.data.frame">plot.data.frame</a></code>.
</p>
<p>Missing values are not considered in these methods, and in particular
cases with missing values are not removed.
</p>
<p>If <code>y</code> is an object (i.e., has a <code><a href="base.html#topic+class">class</a></code> attribute)
then <code>plot.formula</code> looks for a plot method for that class first.
Otherwise, the class of <code>x</code> will determine the type of the plot.
For factors this will be a parallel boxplot, and argument
<code>horizontal = TRUE</code> can be specified (see <code><a href="#topic+boxplot">boxplot</a></code>).
</p>
<p>Note that some arguments will need to be protected from premature
evaluation by enclosing them in <code><a href="base.html#topic+quote">quote</a></code>: currently this is
done automatically for <code>main</code>, <code>sub</code> and <code>xlab</code>.  For
example, it is needed for the <code>panel.first</code> and <code>panel.last</code>
arguments passed to <code><a href="#topic+plot.default">plot.default</a></code>.
</p>


<h3>Value</h3>

<p>These functions are invoked for their side effect of drawing
on the active graphics device.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.default">plot.default</a></code>, <code><a href="#topic+points">points</a></code>, <code><a href="#topic+lines">lines</a></code>,
<code><a href="#topic+plot.factor">plot.factor</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>op &lt;- par(mfrow = c(2,1))
plot(Ozone ~ Wind, data = airquality, pch = as.character(Month))
plot(Ozone ~ Wind, data = airquality, pch = as.character(Month),
     subset = Month != 7)
par(op)

## text.formula() can be very natural:
wb &lt;- within(warpbreaks, {
    time &lt;- seq_along(breaks); W.T &lt;- wool:tension })
plot(breaks ~ time, data = wb, type = "b")
text(breaks ~ time, data = wb, labels = W.T, col = 1+as.integer(wool))
</code></pre>

<hr>
<h2 id='plot.histogram'>Plot Histograms</h2><span id='topic+plot.histogram'></span><span id='topic+lines.histogram'></span>

<h3>Description</h3>

<p>Plotting methods for objects of class <code>"histogram"</code>, typically
produced by <code><a href="#topic+hist">hist</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'histogram'
plot(x, freq = equidist, density = NULL, angle = 45,
               col = "lightgray", border = NULL, lty = NULL,
               main = paste("Histogram of", paste(x$xname, collapse = "\n")),
               sub = NULL, xlab = x$xname, ylab,
               xlim = range(x$breaks), ylim = NULL,
               axes = TRUE, labels = FALSE, add = FALSE,
               ann = TRUE, ...)

## S3 method for class 'histogram'
lines(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.histogram_+3A_x">x</code></td>
<td>
<p>a <code>histogram</code> object, or a <code><a href="base.html#topic+list">list</a></code> with components
<code>density</code>, <code>mid</code>, etc, see <code><a href="#topic+hist">hist</a></code> for
information about the components of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_freq">freq</code></td>
<td>
<p>logical; if <code>TRUE</code>, the
histogram graphic is to present a representation of frequencies, i.e,
<code>x$counts</code>; if <code>FALSE</code>, <em>relative</em> frequencies
(probabilities), i.e., <code>x$density</code>, are plotted.  The
default is true for equidistant <code>breaks</code> and false otherwise.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_col">col</code></td>
<td>
<p>a colour to be used to fill the bars.  The default has been
changed from <code>NULL</code> (unfilled bars) only as from <span class="rlang"><b>R</b></span> 4.2.0.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_border">border</code></td>
<td>
<p>the color of the border around the bars.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_angle">angle</code>, <code id="plot.histogram_+3A_density">density</code></td>
<td>
<p>select shading of bars by lines:
see <code><a href="#topic+rect">rect</a></code>.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_lty">lty</code></td>
<td>
<p>the line type used for the bars, see also <code><a href="#topic+lines">lines</a></code>.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_main">main</code>, <code id="plot.histogram_+3A_sub">sub</code>, <code id="plot.histogram_+3A_xlab">xlab</code>, <code id="plot.histogram_+3A_ylab">ylab</code></td>
<td>
<p>these arguments to <code>title</code> have useful
defaults here.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_xlim">xlim</code>, <code id="plot.histogram_+3A_ylim">ylim</code></td>
<td>
<p>the range of x and y values with sensible defaults.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_axes">axes</code></td>
<td>
<p>logical, indicating if axes should be drawn.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_labels">labels</code></td>
<td>
<p>logical or character.  Additionally draw labels on top of bars,
if not <code>FALSE</code>; if <code>TRUE</code>, draw the counts or rounded
densities; if <code>labels</code> is a <code>character</code>, draw itself.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_add">add</code></td>
<td>
<p>logical.  If <code>TRUE</code>, only the bars are added to the
current plot.  This is what <code>lines.histogram(*)</code> does.</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_ann">ann</code></td>
<td>
<p>logical.  Should annotations (titles and axis titles) be plotted?</p>
</td></tr>
<tr><td><code id="plot.histogram_+3A_...">...</code></td>
<td>
<p>further <a href="#topic+graphical+20parameters">graphical parameters</a> to
<code>title</code> and <code>axis</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lines.histogram(*)</code> is the same as
<code>plot.histogram(*, add = TRUE)</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hist">hist</a></code>,
<code><a href="#topic+stem">stem</a></code>,
<code><a href="stats.html#topic+density">density</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(wwt &lt;- hist(women$weight, nclass = 7, plot = FALSE))
plot(wwt, labels = TRUE) # default main &amp; xlab using wwt$xname
plot(wwt, border = "dark blue", col = "light blue",
     main = "Histogram of 15 women's weights", xlab = "weight [pounds]")

## Fake "lines" example, using non-default labels:
w2 &lt;- wwt; w2$counts &lt;- w2$counts - 1
lines(w2, col = "Midnight Blue", labels = ifelse(w2$counts, "&gt; 1", "1"))
</code></pre>

<hr>
<h2 id='plot.raster'>Plotting Raster Images</h2><span id='topic+plot.raster'></span>

<h3>Description</h3>

<p>This functions implements a <code><a href="#topic+plot">plot</a></code> method for raster images.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'raster'
plot(x, y,
     xlim = c(0, ncol(x)), ylim = c(0, nrow(x)),
     xaxs = "i", yaxs = "i",
     asp = 1, add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.raster_+3A_x">x</code>, <code id="plot.raster_+3A_y">y</code></td>
<td>
<p>raster. <code>y</code> will be ignored.</p>
</td></tr>
<tr><td><code id="plot.raster_+3A_xlim">xlim</code>, <code id="plot.raster_+3A_ylim">ylim</code></td>
<td>
<p>Limits on the plot region (default from dimensions
of the raster).</p>
</td></tr>
<tr><td><code id="plot.raster_+3A_xaxs">xaxs</code>, <code id="plot.raster_+3A_yaxs">yaxs</code></td>
<td>
<p>Axis interval calculation style (default means that
raster fills plot region).</p>
</td></tr>
<tr><td><code id="plot.raster_+3A_asp">asp</code></td>
<td>
<p>Aspect ratio (default retains aspect ratio of the raster).</p>
</td></tr>
<tr><td><code id="plot.raster_+3A_add">add</code></td>
<td>
<p>Logical indicating whether to simply add raster to an
existing plot.</p>
</td></tr>
<tr><td><code id="plot.raster_+3A_...">...</code></td>
<td>
<p>Further arguments to the <code><a href="#topic+rasterImage">rasterImage</a></code> function.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.default">plot.default</a></code>, <code><a href="#topic+rasterImage">rasterImage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(grDevices)
r &lt;- as.raster(c(0.5, 1, 0.5))
plot(r)
# additional arguments to rasterImage()
plot(r, interpolate=FALSE)
# distort
plot(r, asp=NA)
# fill page
op &lt;- par(mar=rep(0, 4))
plot(r, asp=NA)
par(op)
# normal annotations work
plot(r, asp=NA)
box()
title(main="This is my raster")
# add to existing plot
plot(1)
plot(r, add=TRUE)
</code></pre>

<hr>
<h2 id='plot.table'>Plot Methods for <code>table</code> Objects</h2><span id='topic+plot.table'></span><span id='topic+lines.table'></span><span id='topic+points.table'></span>

<h3>Description</h3>

<p>This is a method of the generic <code>plot</code> function for
(contingency) <code><a href="base.html#topic+table">table</a></code> objects.  Whereas for two- and more
dimensional tables, a <code><a href="#topic+mosaicplot">mosaicplot</a></code> is drawn,
one-dimensional ones are plotted as bars.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'table'
plot(x, type = "h", ylim = c(0, max(x)), lwd = 2,
     xlab = NULL, ylab = NULL, frame.plot = is.num, ...)
## S3 method for class 'table'
points(x, y = NULL, type = "h", lwd = 2, ...)
## S3 method for class 'table'
lines(x, y = NULL, type = "h", lwd = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.table_+3A_x">x</code></td>
<td>
<p>a <code><a href="base.html#topic+table">table</a></code> (like) object.</p>
</td></tr>
<tr><td><code id="plot.table_+3A_y">y</code></td>
<td>
<p>Must be <code>NULL</code>: there to protect against incorrect calls.</p>
</td></tr>
<tr><td><code id="plot.table_+3A_type">type</code></td>
<td>
<p>plotting type.</p>
</td></tr>
<tr><td><code id="plot.table_+3A_ylim">ylim</code></td>
<td>
<p>range of y-axis.</p>
</td></tr>
<tr><td><code id="plot.table_+3A_lwd">lwd</code></td>
<td>
<p>line width for bars when <code>type = "h"</code> is used in the 1D case.</p>
</td></tr>
<tr><td><code id="plot.table_+3A_xlab">xlab</code>, <code id="plot.table_+3A_ylab">ylab</code></td>
<td>
<p>x- and y-axis labels.</p>
</td></tr>
<tr><td><code id="plot.table_+3A_frame.plot">frame.plot</code></td>
<td>
<p>logical indicating if a frame (<code><a href="#topic+box">box</a></code>)
should be drawn in the 1D case.  Defaults to true when <code>x</code> has
<code><a href="base.html#topic+dimnames">dimnames</a></code> coerce-able to numbers.</p>
</td></tr>
<tr><td><code id="plot.table_+3A_...">...</code></td>
<td>
<p>further graphical arguments, see <code><a href="#topic+plot.default">plot.default</a></code>.
<code>axes = FALSE</code> is accepted.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plot.factor">plot.factor</a></code>, the <code><a href="#topic+plot">plot</a></code> method for factors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1-d tables
(Poiss.tab &lt;- table(N = stats::rpois(200, lambda = 5)))
plot(Poiss.tab, main = "plot(table(rpois(200, lambda = 5)))")

plot(table(state.division))

## 4-D :
plot(Titanic, main ="plot(Titanic, main= *)")

</code></pre>

<hr>
<h2 id='plot.window'>Set up World Coordinates for Graphics Window</h2><span id='topic+plot.window'></span><span id='topic+xlim'></span><span id='topic+ylim'></span><span id='topic+asp'></span>

<h3>Description</h3>

<p>This function sets up the world coordinate system for a graphics
window.  It is called by higher level functions such as
<code><a href="#topic+plot.default">plot.default</a></code> (<em>after</em> <code><a href="#topic+plot.new">plot.new</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot.window(xlim, ylim, log = "", asp = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.window_+3A_xlim">xlim</code>, <code id="plot.window_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2, giving the x and y
coordinates ranges.</p>
</td></tr>
<tr><td><code id="plot.window_+3A_log">log</code></td>
<td>
<p>character; indicating which axes should be in log scale.</p>
</td></tr>
<tr><td><code id="plot.window_+3A_asp">asp</code></td>
<td>
<p>numeric, giving the <b>asp</b>ect ratio y/x,
see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="plot.window_+3A_...">...</code></td>
<td>
<p>further <a href="#topic+graphical+20parameters">graphical parameters</a> as in <code><a href="#topic+par">par</a></code>.
The relevant ones are <code>xaxs</code>, <code>yaxs</code> and <code>lab</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>asp:</dt><dd>
<p>If <code>asp</code> is a finite positive value then the window is
set up so that one data unit in the <code class="reqn">y</code> direction is equal in length to
<code>asp</code> <code class="reqn">\times</code> one data unit in the <code class="reqn">x</code> direction.
</p>
<p>Note that in this case, <code><a href="#topic+par">par</a>("usr")</code> is no longer
determined by, e.g., <code>par("xaxs")</code>, but rather by <code>asp</code> and
the device's aspect ratio.  (See what happens if you interactively
resize the plot device after running the example below!)
</p>
<p>The special case <code>asp == 1</code> produces plots where distances
between points are represented accurately on screen.  Values with
<code>asp &gt; 1</code> can be used to produce more accurate maps when using
latitude and longitude.
</p>
</dd></dl>

<p>Note that the coordinate ranges will be extended by 4% if the
appropriate <a href="#topic+graphical+20parameter">graphical parameter</a> <code>xaxs</code> or <code>yaxs</code> has value
<code>"r"</code> (which is the default).
</p>
<p>To reverse an axis, use <code>xlim</code> or <code>ylim</code> of the form
<code>c(hi, lo)</code>.
</p>
<p>The function attempts to produce a plausible set of scales if one or
both of <code>xlim</code> and <code>ylim</code> is of length one or the two values
given are identical, but it is better to avoid that case.
</p>
<p>Usually, one should rather use the higher-level functions such as
<code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+hist">hist</a></code>, <code><a href="#topic+image">image</a></code>, ...,
instead and refer to their help pages for explanation of the
arguments.
</p>
<p>A side-effect of the call is to set up the <code>usr</code>, <code>xaxp</code> and
<code>yaxp</code> <a href="#topic+graphical+20parameters">graphical parameters</a>.  (It is for the latter two that
<code>lab</code> is used.)
</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>,
<code><a href="#topic+plot.xy">plot.xy</a></code>,
<code><a href="#topic+plot.default">plot.default</a></code>.
</p>
<p><code><a href="#topic+par">par</a></code> for the graphical parameters mentioned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##--- An example for the use of 'asp' :
require(stats)  # normally loaded
loc &lt;- cmdscale(eurodist)
rx &lt;- range(x &lt;- loc[,1])
ry &lt;- range(y &lt;- -loc[,2])
plot(x, y, type = "n", asp = 1, xlab = "", ylab = "")
abline(h = pretty(rx, 10), v = pretty(ry, 10), col = "lightgray")
text(x, y, labels(eurodist), cex = 0.8)
</code></pre>

<hr>
<h2 id='plot.xy'>Basic Internal Plot Function</h2><span id='topic+plot.xy'></span>

<h3>Description</h3>

<p>This is <em>the</em> internal function that does the basic plotting of
points and lines.  Usually, one should rather use the higher level
functions instead and refer to their help pages for explanation of the
arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot.xy(xy, type, pch = par("pch"), lty = par("lty"),
        col = par("col"), bg = NA,
        cex = 1, lwd = par("lwd"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.xy_+3A_xy">xy</code></td>
<td>
<p>A four-element list as results from
<code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.</p>
</td></tr>
<tr><td><code id="plot.xy_+3A_type">type</code></td>
<td>
<p>1 character code: see <code><a href="#topic+plot.default">plot.default</a></code>.
<code>NULL</code> is accepted as a synonym for <code>"p"</code>.</p>
</td></tr>
<tr><td><code id="plot.xy_+3A_pch">pch</code></td>
<td>
<p>character or integer code for kind of points, see
<code><a href="#topic+points.default">points.default</a></code>.</p>
</td></tr>
<tr><td><code id="plot.xy_+3A_lty">lty</code></td>
<td>
<p>line type code, see <code><a href="#topic+lines">lines</a></code>.</p>
</td></tr>
<tr><td><code id="plot.xy_+3A_col">col</code></td>
<td>
<p>color code or name, see <code><a href="grDevices.html#topic+colors">colors</a></code>,
<code><a href="grDevices.html#topic+palette">palette</a></code>.  Here <code>NULL</code> means colour 0.</p>
</td></tr>
<tr><td><code id="plot.xy_+3A_bg">bg</code></td>
<td>
<p>background (fill) color for the open plot symbols 21:25:
see <code><a href="#topic+points.default">points.default</a></code>.</p>
</td></tr>
<tr><td><code id="plot.xy_+3A_cex">cex</code></td>
<td>
<p>character expansion.</p>
</td></tr>
<tr><td><code id="plot.xy_+3A_lwd">lwd</code></td>
<td>
<p>line width, also used for (non-filled) plot symbols, see
<code><a href="#topic+lines">lines</a></code> and <code><a href="#topic+points">points</a></code>.</p>
</td></tr>
<tr><td><code id="plot.xy_+3A_...">...</code></td>
<td>
<p>further <a href="#topic+graphical+20parameters">graphical parameters</a> such as <code>xpd</code>,
<code>lend</code>, <code>ljoin</code> and <code>lmitre</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments <code>pch</code>, <code>col</code>, <code>bg</code>, <code>cex</code>,
<code>lwd</code> may be vectors and may be recycled, depending on
<code>type</code>: see <code><a href="#topic+points">points</a></code> and <code><a href="#topic+lines">lines</a></code> for
specifics.  In particular note that <code>lwd</code> is treated as a vector
for points and as a single (first) value for lines.
</p>
<p><code>cex</code> is a numeric factor in addition to <code>par("cex")</code> which
affects symbols and characters as drawn by <code>type</code> <code>"p"</code>,
<code>"o"</code>, <code>"b"</code> and <code>"c"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot">plot</a></code>,
<code><a href="#topic+plot.default">plot.default</a></code>,
<code><a href="#topic+points">points</a></code>,
<code><a href="#topic+lines">lines</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>points.default # to see how it calls "plot.xy(xy.coords(x, y), ...)"
</code></pre>

<hr>
<h2 id='points'>Add Points to a Plot</h2><span id='topic+points'></span><span id='topic+points.default'></span><span id='topic+pch'></span>

<h3>Description</h3>

<p><code>points</code> is a generic function to draw a sequence of points at
the specified coordinates.  The specified character(s) are plotted,
centered at the coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>points(x, ...)

## Default S3 method:
points(x, y = NULL, type = "p", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="points_+3A_x">x</code>, <code id="points_+3A_y">y</code></td>
<td>
<p>coordinate vectors of points to plot.</p>
</td></tr>
<tr><td><code id="points_+3A_type">type</code></td>
<td>
<p>character indicating the type of plotting; actually any of
the <code>type</code>s as in <code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="points_+3A_...">...</code></td>
<td>
<p>Further <a href="#topic+graphical+20parameters">graphical parameters</a> may also be supplied as
arguments.  See &lsquo;Details&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coordinates can be passed in a plotting structure
(a list with <code>x</code> and <code>y</code> components), a two-column matrix, a
time series, ....  See <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.  If supplied
separately, they must be of the same length.
</p>
<p>Graphical parameters commonly used are
</p>

<dl>
<dt><code>pch</code></dt><dd><p>plotting &lsquo;character&rsquo;, i.e., symbol to use.
This can either be a single character or an integer code for one
of a set of graphics symbols.  The full set of S symbols is
available with <code>pch = 0:18</code>, see the examples below.
(NB: <span class="rlang"><b>R</b></span> uses circles instead of the octagons used in S.)
</p>
<p>Value <code>pch = "."</code> (equivalently <code>pch = 46</code>) is handled
specially.  It is a rectangle of side 0.01 inch (scaled by
<code>cex</code>).  In addition, if <code>cex = 1</code> (the default), each
side is at least one pixel (1/72 inch on the <code><a href="grDevices.html#topic+pdf">pdf</a></code>,
<code><a href="grDevices.html#topic+postscript">postscript</a></code> and <code><a href="grDevices.html#topic+xfig">xfig</a></code> devices).
</p>
<p>For other text symbols, <code>cex = 1</code> corresponds to the default
font size of the device, often specified by an argument
<code>pointsize</code>.  For <code>pch</code> in <code>0:25</code> the default size
is about 75% of the character height (see <code>par("cin")</code>).
</p>
</dd>
<dt><code>col</code></dt><dd><p>color code or name, see <code><a href="#topic+par">par</a></code>.</p>
</dd>
<dt><code>bg</code></dt><dd><p>background (fill) color for the open plot
symbols given by <code>pch = 21:25</code>.</p>
</dd>
<dt><code>cex</code></dt><dd><p>character (or symbol) expansion: a numerical vector.
This works as a multiple of <code><a href="#topic+par">par</a>("cex")</code>.</p>
</dd>
<dt><code>lwd</code></dt><dd><p>line width for drawing symbols see <code><a href="#topic+par">par</a></code>.</p>
</dd>
</dl>

<p>Others less commonly used are <code>lty</code> and <code>lwd</code> for
types such as <code>"b"</code> and <code>"l"</code>.
</p>
<p>The <a href="#topic+graphical+20parameters">graphical parameters</a> <code>pch</code>, <code>col</code>, <code>bg</code>,
<code>cex</code> and <code>lwd</code> can be vectors (which will be recycled as
needed) giving a value for each point plotted.  If lines are to be
plotted (e.g., for <code>type = "b"</code>) the first element of <code>lwd</code>
is used.
</p>
<p>Points whose <code>x</code>, <code>y</code>, <code>pch</code>, <code>col</code> or <code>cex</code>
value is <code>NA</code> are omitted from the plot.
</p>


<h3><code>pch</code> values</h3>

<p>Values of <code>pch</code> are stored internally as integers.  The
interpretation is
</p>

<ul>
<li> <p><code>NA_integer_</code>: no symbol.
</p>
</li>
<li> <p><code>0:18</code>: S-compatible vector symbols.
</p>
</li>
<li> <p><code>19:25</code>: further <span class="rlang"><b>R</b></span> vector symbols.
</p>
</li>
<li> <p><code>26:31</code>: unused (and ignored).
</p>
</li>
<li> <p><code>32:127</code>: ASCII characters.
</p>
</li>
<li> <p><code>128:255</code> native characters <em>only in a
single-byte locale and for the symbol font</em>.  (<code>128:159</code> are
only used on Windows.)
</p>
</li>
<li> <p><code>-32 ...</code> Unicode code point (where supported).
</p>
</li></ul>

<p>Note that unlike S (which uses octagons), symbols <code>1</code>, <code>10</code>,
<code>13</code> and <code>16</code> use circles.  The filled shapes <code>15:18</code>
do not include a border.
</p>
<p><img src="../help/figures/pch.png" alt="Illustration of pch = 0:25" />

</p>
<p>The following  <span class="rlang"><b>R</b></span> plotting symbols are can be obtained with
<code>pch = 19:25</code>: those with <code>21:25</code> can be colored and
filled with different colors: <code>col</code> gives the border color
and <code>bg</code> the background color
(which is &lsquo;<span class="samp">&#8288;"grey"&#8288;</span>&rsquo; in the figure)

</p>

<ul>
<li> <p><code>pch = 19</code>: solid circle,
</p>
</li>
<li> <p><code>pch = 20</code>: bullet (smaller solid circle,
2/3 the size of <code>19</code>),
</p>
</li>
<li> <p><code>pch = 21</code>: filled circle,
</p>
</li>
<li> <p><code>pch = 22</code>: filled square,
</p>
</li>
<li> <p><code>pch = 23</code>: filled diamond,
</p>
</li>
<li> <p><code>pch = 24</code>: filled triangle point-up,
</p>
</li>
<li> <p><code>pch = 25</code>: filled triangle point down.
</p>
</li></ul>

<p>Note that all of these both fill the shape and draw a border.  Some
care in interpretation is needed when semi-transparent colours are
used for both fill and border (and the result might be device-specific
and even viewer-specific for <code><a href="grDevices.html#topic+pdf">pdf</a></code>).
</p>
<p>The difference between <code>pch = 16</code> and <code>pch = 19</code> is that the
latter uses a border and so is perceptibly larger when <code>lwd</code> is
large relative to <code>cex</code>.
</p>
<p>Values <code>pch = 26:31</code> are currently unused and <code>pch = 32:127</code>
give the ASCII characters.  In a single-byte locale
<code>pch = 128:255</code> give the corresponding character (if any) in
the locale's character set.  Where supported by the OS, negative
values specify a Unicode code point, so e.g. <code>-0x2642L</code>
is a &lsquo;male sign&rsquo; and <code>-0x20ACL</code> is the Euro.
</p>
<p>A character string consisting of a single character is converted to an
integer: <code>32:127</code> for ASCII characters, and usually to the
Unicode code point otherwise.  (In non-Latin-1 single-byte locales,
<code>128:255</code> will be used for 8-bit characters.)
</p>
<p>If <code>pch</code> supplied is a logical, integer or character
<code>NA</code> or an empty character string the point is omitted from
the plot.
</p>
<p>If <code>pch</code> is <code>NULL</code> or otherwise of length 0,
<code>par("pch")</code> is used.
</p>
<p>If the symbol font (<code><a href="#topic+par">par</a>(font = 5)</code>) is used, numerical
values should be used for <code>pch</code>: the range is
<code>c(32:126, 160:254)</code> in all locales (but <code>240</code> is not
defined (used for &lsquo;apple&rsquo; on macOS) and <code>160</code>, Euro, may
not be present).
</p>


<h3>Note</h3>

<p>A single-byte encoding may include the characters in
<code>pch = 128:255</code>, and if it does, a font may not include all (or
even any) of them.
</p>
<p>Not all negative numbers are valid as Unicode code points, and no
check is done.  A display device is likely to use a rectangle for (or
omit) Unicode code points which are invalid or for which it does not
have a glyph in the font used.
</p>
<p>What happens for very small or zero values of <code>cex</code> is
device-dependent: symbols or characters may become invisible or
they may be plotted at a fixed minimum size.  Circles of zero radius
will not be plotted.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+points.formula">points.formula</a></code> for the formula method;
<code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+lines">lines</a></code>, and the underlying
workhorse function <code><a href="#topic+plot.xy">plot.xy</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats) # for rnorm
plot(-4:4, -4:4, type = "n")  # setting up coord. system
points(rnorm(200), rnorm(200), col = "red")
points(rnorm(100)/2, rnorm(100)/2, col = "blue", cex = 1.5)

op &lt;- par(bg = "light blue")
x &lt;- seq(0, 2*pi, length.out = 51)
## something "between type='b' and type='o'":
plot(x, sin(x), type = "o", pch = 21, bg = par("bg"), col = "blue", cex = .6,
 main = 'plot(..., type="o", pch=21, bg=par("bg"))')
par(op)

## Illustration of pch = 0:25 (as in the figure shown above in PDF/HTML help)
## Not run: png("pch.png", height = 0.7, width = 7, res = 100, units = "in")
par(mar = rep(0,4))
plot(c(-1, 26), 0:1, type = "n", axes = FALSE)
text(0:25, 0.6, 0:25, cex = 0.5)
points(0:25, rep(0.3, 26), pch = 0:25, bg = "grey")


##-------- Showing all the extra &amp; some char graphics symbols ---------
pchShow &lt;-
  function(extras = c("*",".", "o","O","0","+","-","|","%","#"),
           cex = 3, ## good for both .Device=="postscript" and "x11"
           col = "red3", bg = "gold", coltext = "brown", cextext = 1.2,
           main = paste("plot symbols :  points (...  pch = *, cex =",
                        cex,")"))
  {
    nex &lt;- length(extras)
    np  &lt;- 26 + nex
    ipch &lt;- 0:(np-1)
    k &lt;- floor(sqrt(np))
    dd &lt;- c(-1,1)/2
    rx &lt;- dd + range(ix &lt;- ipch %/% k)
    ry &lt;- dd + range(iy &lt;- 3 + (k-1)- ipch %% k)
    pch &lt;- as.list(ipch) # list with integers &amp; strings
    if(nex &gt; 0) pch[26+ 1:nex] &lt;- as.list(extras)
    plot(rx, ry, type = "n", axes  =  FALSE, xlab = "", ylab = "", main = main)
    abline(v = ix, h = iy, col = "lightgray", lty = "dotted")
    for(i in 1:np) {
      pc &lt;- pch[[i]]
      ## 'col' symbols with a 'bg'-colored interior (where available) :
      points(ix[i], iy[i], pch = pc, col = col, bg = bg, cex = cex)
      if(cextext &gt; 0)
          text(ix[i] - 0.3, iy[i], pc, col = coltext, cex = cextext)
    }
  }

pchShow()
pchShow(c("o","O","0"), cex = 2.5)
pchShow(NULL, cex = 4, cextext = 0, main = NULL)


## ------------ test code for various pch specifications -------------
# Try this in various font families (including Hershey)
# and locales.  Use sign = -1 asserts we want Latin-1.
# Standard cases in a MBCS locale will not plot the top half.
TestChars &lt;- function(sign = 1, font = 1, ...)
{
   MB &lt;- l10n_info()$MBCS
   r &lt;- if(font == 5) { sign &lt;- 1; c(32:126, 160:254)
       } else if(MB) 32:126 else 32:255
   if (sign == -1) r &lt;- c(32:126, 160:255)
   par(pty = "s")
   plot(c(-1,16), c(-1,16), type = "n", xlab = "", ylab = "",
        xaxs = "i", yaxs = "i",
        main = sprintf("sign = %d, font = %d", sign, font))
   grid(17, 17, lty = 1) ; mtext(paste("MBCS:", MB))
   for(i in r) try(points(i%%16, i%/%16, pch = sign*i, font = font,...))
}
TestChars()
try(TestChars(sign = -1))
TestChars(font = 5)  # Euro might be at 160 (0+10*16).
                     # macOS has apple at 240 (0+15*16).
try(TestChars(-1, font = 2))  # bold
</code></pre>

<hr>
<h2 id='polygon'>Polygon Drawing</h2><span id='topic+polygon'></span>

<h3>Description</h3>

<p><code>polygon</code> draws the polygons whose vertices are
given in <code>x</code> and <code>y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polygon(x, y = NULL, density = NULL, angle = 45,
        border = NULL, col = NA, lty = par("lty"),
        ..., fillOddEven = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polygon_+3A_x">x</code>, <code id="polygon_+3A_y">y</code></td>
<td>
<p>vectors containing the coordinates of the vertices
of the polygon.</p>
</td></tr>
<tr><td><code id="polygon_+3A_density">density</code></td>
<td>
<p>the density of shading lines, in lines per inch.  The
default value of <code>NULL</code> means that no shading lines are drawn.
A zero value of <code>density</code> means no shading nor filling whereas
negative values and <code>NA</code> suppress shading (and so allow
color filling).</p>
</td></tr>
<tr><td><code id="polygon_+3A_angle">angle</code></td>
<td>
<p>the slope of shading lines, given as an angle
in degrees (counter-clockwise).</p>
</td></tr>
<tr><td><code id="polygon_+3A_col">col</code></td>
<td>
<p>the color for filling the polygon. The default,
<code>NA</code>, is to leave polygons unfilled, unless <code>density</code> is
specified.  (For back-compatibility, <code>NULL</code> is equivalent to
<code>NA</code>.)  If <code>density</code> is specified with a positive value
this gives the color of the shading lines.</p>
</td></tr>
<tr><td><code id="polygon_+3A_border">border</code></td>
<td>
<p>the color to draw the border.  The default, <code>NULL</code>,
means to use <code><a href="#topic+par">par</a>("fg")</code>.  Use <code>border = NA</code> to
omit borders.
</p>
<p>For compatibility with S, <code>border</code> can also be logical, in
which case <code>FALSE</code> is equivalent to <code>NA</code> (borders omitted)
and <code>TRUE</code> is equivalent to <code>NULL</code> (use the foreground colour),
</p>
</td></tr>
<tr><td><code id="polygon_+3A_lty">lty</code></td>
<td>
<p>the line type to be used, as in <code><a href="#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="polygon_+3A_...">...</code></td>
<td>
<p>graphical parameters such as <code>xpd</code>, <code>lend</code>,
<code>ljoin</code> and <code>lmitre</code> can be given as arguments.</p>
</td></tr>
<tr><td><code id="polygon_+3A_filloddeven">fillOddEven</code></td>
<td>
<p>logical controlling the polygon shading mode:  see
below for details.  Default <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coordinates can be passed in a plotting structure
(a list with <code>x</code> and <code>y</code> components), a two-column matrix,
....  See <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.
</p>
<p>It is assumed that the polygon is to be closed by joining the last
point to the first point.
</p>
<p>The coordinates can contain missing values.  The behaviour is similar
to that of <code><a href="#topic+lines">lines</a></code>, except that instead of breaking a line
into several lines, <code>NA</code> values break the polygon into several
complete polygons (including closing the last point to the first
point).  See the examples below.
</p>
<p>When multiple polygons are produced, the values of <code>density</code>,
<code>angle</code>, <code>col</code>, <code>border</code>, and <code>lty</code> are recycled
in the usual manner.
</p>
<p>Shading of polygons is only implemented for linear plots: if either
axis is on log scale then shading is omitted, with a warning.
</p>


<h3>Bugs</h3>

<p>Self-intersecting polygons may be filled using either the
&ldquo;odd-even&rdquo; or &ldquo;non-zero&rdquo; rule.  These fill a region if
the polygon border encircles it an odd or non-zero number of times,
respectively.  Shading lines are handled internally by <span class="rlang"><b>R</b></span> according
to the <code>fillOddEven</code> argument, but device-based solid fills
depend on the graphics device.  The <code>windows</code>, <code><a href="grDevices.html#topic+pdf">pdf</a></code>
and <code><a href="grDevices.html#topic+postscript">postscript</a></code> devices have their own <code>fillOddEven</code>
argument to control this.
</p>


<h3>Author(s)</h3>

<p>The code implementing polygon shading was donated by
Kevin Buhr <a href="mailto:buhr@stat.wisc.edu">buhr@stat.wisc.edu</a>.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+segments">segments</a></code> for even more flexibility, <code><a href="#topic+lines">lines</a></code>,
<code><a href="#topic+rect">rect</a></code>, <code><a href="#topic+box">box</a></code>, <code><a href="#topic+abline">abline</a></code>.
</p>
<p><code><a href="#topic+par">par</a></code> for how to specify colors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1:9, 8:1)
y &lt;- c(1, 2*(5:3), 2, -1, 17, 9, 8, 2:9)
op &lt;- par(mfcol = c(3, 1))
for(xpd in c(FALSE, TRUE, NA)) {
  plot(1:10, main = paste("xpd =", xpd))
  box("figure", col = "pink", lwd = 3)
  polygon(x, y, xpd = xpd, col = "orange", lty = 2, lwd = 2, border = "red")
}
par(op)

n &lt;- 100
xx &lt;- c(0:n, n:0)
yy &lt;- c(c(0, cumsum(stats::rnorm(n))), rev(c(0, cumsum(stats::rnorm(n)))))
plot   (xx, yy, type = "n", xlab = "Time", ylab = "Distance")
polygon(xx, yy, col = "gray", border = "red")
title("Distance Between Brownian Motions")

# Multiple polygons from NA values
# and recycling of col, border, and lty
op &lt;- par(mfrow = c(2, 1))
plot(c(1, 9), 1:2, type = "n")
polygon(1:9, c(2,1,2,1,1,2,1,2,1),
        col = c("red", "blue"),
        border = c("green", "yellow"),
        lwd = 3, lty = c("dashed", "solid"))
plot(c(1, 9), 1:2, type = "n")
polygon(1:9, c(2,1,2,1,NA,2,1,2,1),
        col = c("red", "blue"),
        border = c("green", "yellow"),
        lwd = 3, lty = c("dashed", "solid"))
par(op)

# Line-shaded polygons
plot(c(1, 9), 1:2, type = "n")
polygon(1:9, c(2,1,2,1,NA,2,1,2,1),
        density = c(10, 20), angle = c(-45, 45))
</code></pre>

<hr>
<h2 id='polypath'>Path Drawing</h2><span id='topic+polypath'></span>

<h3>Description</h3>

<p><code>path</code> draws a path whose vertices are
given in <code>x</code> and <code>y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polypath(x, y = NULL,
         border = NULL, col = NA, lty = par("lty"),
         rule = "winding", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polypath_+3A_x">x</code>, <code id="polypath_+3A_y">y</code></td>
<td>
<p>vectors containing the coordinates of the vertices
of the path.</p>
</td></tr>
<tr><td><code id="polypath_+3A_col">col</code></td>
<td>
<p>the color for filling the path. The default,
<code>NA</code>, is to leave paths unfilled.</p>
</td></tr>
<tr><td><code id="polypath_+3A_border">border</code></td>
<td>
<p>the color to draw the border.  The default, <code>NULL</code>,
means to use <code><a href="#topic+par">par</a>("fg")</code>.  Use <code>border = NA</code> to
omit borders.
</p>
<p>For compatibility with S, <code>border</code> can also be logical, in
which case <code>FALSE</code> is equivalent to <code>NA</code> (borders omitted)
and <code>TRUE</code> is equivalent to <code>NULL</code> (use the foreground colour),
</p>
</td></tr>
<tr><td><code id="polypath_+3A_lty">lty</code></td>
<td>
<p>the line type to be used, as in <code><a href="#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="polypath_+3A_rule">rule</code></td>
<td>
<p>character value specifying the path fill mode: either
<code>"winding"</code> or <code>"evenodd"</code>.</p>
</td></tr>
<tr><td><code id="polypath_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> such as <code>xpd</code>, <code>lend</code>,
<code>ljoin</code> and <code>lmitre</code> can be given as arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The coordinates can be passed in a plotting structure
(a list with <code>x</code> and <code>y</code> components), a two-column matrix,
....  See <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.
</p>
<p>It is assumed that the path is to be closed by joining the last point to
the first point.
</p>
<p>The coordinates can contain missing values.  The behaviour is similar
to that of <code><a href="#topic+polygon">polygon</a></code>, except that instead of breaking a
polygon into several polygons, <code>NA</code> values break the path into
several sub-paths (including closing the last point to the first point
in each sub-path).  See the examples below.
</p>
<p>The distinction between a path and a polygon is that the former
can contain holes, as interpreted by the fill rule; these fill a region if
the path border encircles it an odd or non-zero number of times,
respectively.
</p>
<p>Hatched shading (as implemented for <code>polygon()</code>) is not
(currently) supported.
</p>
<p>Not all graphics devices support this function: for example
<code>xfig</code> and <code>pictex</code> do not.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+segments">segments</a></code> for even more flexibility, <code><a href="#topic+lines">lines</a></code>,
<code><a href="#topic+rect">rect</a></code>, <code><a href="#topic+box">box</a></code>, <code><a href="#topic+polygon">polygon</a></code>.
</p>
<p><code><a href="#topic+par">par</a></code> for how to specify colors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotPath &lt;- function(x, y, col = "grey", rule = "winding") {
    plot.new()
    plot.window(range(x, na.rm = TRUE), range(y, na.rm = TRUE))
    polypath(x, y, col = col, rule = rule)
    if (!is.na(col))
        mtext(paste("Rule:", rule), side = 1, line = 0)
}

plotRules &lt;- function(x, y, title) {
    plotPath(x, y)
    plotPath(x, y, rule = "evenodd")
    mtext(title, side = 3, line = 0)
    plotPath(x, y, col = NA)
}

op &lt;- par(mfrow = c(5, 3), mar = c(2, 1, 1, 1))

plotRules(c(.1, .1, .9, .9, NA, .2, .2, .8, .8),
          c(.1, .9, .9, .1, NA, .2, .8, .8, .2),
          "Nested rectangles, both clockwise")
plotRules(c(.1, .1, .9, .9, NA, .2, .8, .8, .2),
          c(.1, .9, .9, .1, NA, .2, .2, .8, .8),
          "Nested rectangles, outer clockwise, inner anti-clockwise")
plotRules(c(.1, .1, .4, .4, NA, .6, .9, .9, .6),
          c(.1, .4, .4, .1, NA, .6, .6, .9, .9),
          "Disjoint rectangles")
plotRules(c(.1, .1, .6, .6, NA, .4, .4, .9, .9),
          c(.1, .6, .6, .1, NA, .4, .9, .9, .4),
          "Overlapping rectangles, both clockwise")
plotRules(c(.1, .1, .6, .6, NA, .4, .9, .9, .4),
          c(.1, .6, .6, .1, NA, .4, .4, .9, .9),
          "Overlapping rectangles, one clockwise, other anti-clockwise")

par(op)
</code></pre>

<hr>
<h2 id='rasterImage'>Draw One or More Raster Images</h2><span id='topic+rasterImage'></span>

<h3>Description</h3>

<p><code>rasterImage</code> draws a raster image at the given locations and sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterImage(image,
            xleft, ybottom, xright, ytop,
            angle = 0, interpolate = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rasterImage_+3A_image">image</code></td>
<td>
<p>a <code>raster</code> object, or an object that can be
coerced to one by <code><a href="grDevices.html#topic+as.raster">as.raster</a></code>.</p>
</td></tr>
<tr><td><code id="rasterImage_+3A_xleft">xleft</code></td>
<td>
<p>a vector (or scalar) of left x positions.</p>
</td></tr>
<tr><td><code id="rasterImage_+3A_ybottom">ybottom</code></td>
<td>
<p>a vector (or scalar) of bottom y positions.</p>
</td></tr>
<tr><td><code id="rasterImage_+3A_xright">xright</code></td>
<td>
<p>a vector (or scalar) of right x positions.</p>
</td></tr>
<tr><td><code id="rasterImage_+3A_ytop">ytop</code></td>
<td>
<p>a vector (or scalar) of top y positions.</p>
</td></tr>
<tr><td><code id="rasterImage_+3A_angle">angle</code></td>
<td>
<p>angle of rotation (in degrees, anti-clockwise
from positive x-axis, about the bottom-left corner).</p>
</td></tr>
<tr><td><code id="rasterImage_+3A_interpolate">interpolate</code></td>
<td>
<p>a logical vector (or scalar) indicating
whether to apply linear interpolation to the image when drawing. </p>
</td></tr>
<tr><td><code id="rasterImage_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The positions supplied, i.e., <code>xleft, ...</code>,
are relative to the current plotting region.  If the x-axis goes from
100 to 200 then <code>xleft</code> should be larger than 100 and <code>xright</code>
should be less than 200.  The position vectors will be recycled to the
length of the longest.
</p>
<p>Plotting raster images is not supported on all devices and may have
limitations where supported, for example (e.g., for <code>postscript</code>
and <code>X11(type = "Xlib")</code> is restricted to opaque colors).
Problems with the rendering of raster images have been reported by
users of <code>windows()</code> devices under Remote Desktop, at least under
its default settings.
</p>
<p>You should not expect a raster image to be re-sized when an on-screen
device is re-sized: whether it is is device-dependent.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rect">rect</a></code>,
<code><a href="#topic+polygon">polygon</a></code>, and <code><a href="#topic+segments">segments</a></code> and others
for flexible ways to draw shapes.
</p>
<p><code><a href="grDevices.html#topic+dev.capabilities">dev.capabilities</a></code> to see if it is supported.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(grDevices)
## set up the plot region:
op &lt;- par(bg = "thistle")
plot(c(100, 250), c(300, 450), type = "n", xlab = "", ylab = "")
image &lt;- as.raster(matrix(0:1, ncol = 5, nrow = 3))
rasterImage(image, 100, 300, 150, 350, interpolate = FALSE)
rasterImage(image, 100, 400, 150, 450)
rasterImage(image, 200, 300, 200 + xinch(.5), 300 + yinch(.3),
            interpolate = FALSE)
rasterImage(image, 200, 400, 250, 450, angle = 15, interpolate = FALSE)
par(op)
</code></pre>

<hr>
<h2 id='rect'>Draw One or More Rectangles</h2><span id='topic+rect'></span>

<h3>Description</h3>

<p><code>rect</code> draws a rectangle (or sequence of rectangles) with the
given coordinates, fill and border colors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rect(xleft, ybottom, xright, ytop, density = NULL, angle = 45,
     col = NA, border = NULL, lty = par("lty"), lwd = par("lwd"),
     ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rect_+3A_xleft">xleft</code></td>
<td>
<p>a vector (or scalar) of left x positions.</p>
</td></tr>
<tr><td><code id="rect_+3A_ybottom">ybottom</code></td>
<td>
<p>a vector (or scalar) of bottom y positions.</p>
</td></tr>
<tr><td><code id="rect_+3A_xright">xright</code></td>
<td>
<p>a vector (or scalar) of right x positions.</p>
</td></tr>
<tr><td><code id="rect_+3A_ytop">ytop</code></td>
<td>
<p>a vector (or scalar) of top y positions.</p>
</td></tr>
<tr><td><code id="rect_+3A_density">density</code></td>
<td>
<p>the density of shading lines, in lines per inch.
The default value of <code>NULL</code> means that no shading lines are drawn.
A zero value of <code>density</code> means no shading lines whereas
negative values (and <code>NA</code>) suppress shading (and so allow
color filling).</p>
</td></tr>
<tr><td><code id="rect_+3A_angle">angle</code></td>
<td>
<p>angle (in degrees) of the shading lines.</p>
</td></tr>
<tr><td><code id="rect_+3A_col">col</code></td>
<td>
<p>color(s) to fill or shade the rectangle(s) with.
The default <code>NA</code> (or also <code>NULL</code>) means do not fill,
i.e., draw transparent rectangles, unless <code>density</code> is specified.</p>
</td></tr>
<tr><td><code id="rect_+3A_border">border</code></td>
<td>
<p>color for rectangle border(s).  The default means
<code>par("fg")</code>.  Use <code>border = NA</code> to omit borders.
If there are shading
lines, <code>border = TRUE</code> means use the same colour for
the border as for the shading lines.</p>
</td></tr>
<tr><td><code id="rect_+3A_lty">lty</code></td>
<td>
<p>line type for borders and shading; defaults to <code>"solid"</code>.</p>
</td></tr>
<tr><td><code id="rect_+3A_lwd">lwd</code></td>
<td>
<p>line width for borders and shading.  Note that the use of
<code>lwd = 0</code> (as in the examples) is device-dependent.</p>
</td></tr>
<tr><td><code id="rect_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> such as <code>xpd</code>, <code>lend</code>,
<code>ljoin</code> and <code>lmitre</code> can be given as
arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The positions supplied, i.e., <code>xleft, ...</code>,
are relative to the current plotting region.  If the x-axis goes from
100 to 200 then <code>xleft</code> must be larger than 100 and <code>xright</code>
must be less than 200.  The position vectors will be recycled to the
length of the longest.
</p>
<p>It is a graphics primitive used in <code><a href="#topic+hist">hist</a></code>,
<code><a href="#topic+barplot">barplot</a></code>, <code><a href="#topic+legend">legend</a></code>, etc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+box">box</a></code> for the standard box around the plot;
<code><a href="#topic+polygon">polygon</a></code> and <code><a href="#topic+segments">segments</a></code> for flexible line
drawing.
</p>
<p><code><a href="#topic+par">par</a></code> for how to specify colors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(grDevices)
## set up the plot region:
op &lt;- par(bg = "thistle")
plot(c(100, 250), c(300, 450), type = "n", xlab = "", ylab = "",
     main = "2 x 11 rectangles; 'rect(100+i,300+i,  150+i,380+i)'")
i &lt;- 4*(0:10)
## draw rectangles with bottom left (100, 300)+i
## and top right (150, 380)+i
rect(100+i, 300+i, 150+i, 380+i, col = rainbow(11, start = 0.7, end = 0.1))
rect(240-i, 320+i, 250-i, 410+i, col = heat.colors(11), lwd = i/5)
## Background alternating  ( transparent / "bg" ) :
j &lt;- 10*(0:5)
rect(125+j, 360+j,   141+j, 405+j/2, col = c(NA,0),
     border = "gold", lwd = 2)
rect(125+j, 296+j/2, 141+j, 331+j/5, col = c(NA,"midnightblue"))
mtext("+  2 x 6 rect(*, col = c(NA,0)) and  col = c(NA,\"m..blue\")")

## an example showing colouring and shading
plot(c(100, 200), c(300, 450), type= "n", xlab = "", ylab = "")
rect(100, 300, 125, 350) # transparent
rect(100, 400, 125, 450, col = "green", border = "blue") # coloured
rect(115, 375, 150, 425, col = par("bg"), border = "transparent")
rect(150, 300, 175, 350, density = 10, border = "red")
rect(150, 400, 175, 450, density = 30, col = "blue",
     angle = -30, border = "transparent")

legend(180, 450, legend = 1:4, fill = c(NA, "green", par("fg"), "blue"),
       density = c(NA, NA, 10, 30), angle = c(NA, NA, 30, -30))

par(op)
</code></pre>

<hr>
<h2 id='rug'>Add a Rug to a Plot</h2><span id='topic+rug'></span>

<h3>Description</h3>

<p>Adds a <em>rug</em> representation (1-d plot) of the data to the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rug(x, ticksize = 0.03, side = 1, lwd = 0.5, col = par("fg"),
    quiet = getOption("warn") &lt; 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rug_+3A_x">x</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="rug_+3A_ticksize">ticksize</code></td>
<td>
<p>The length of the ticks making up the &lsquo;rug&rsquo;.
Positive lengths give inwards ticks.</p>
</td></tr>
<tr><td><code id="rug_+3A_side">side</code></td>
<td>
<p>On which side of the plot box the rug will be
plotted. Normally 1 (bottom) or 3 (top).</p>
</td></tr>
<tr><td><code id="rug_+3A_lwd">lwd</code></td>
<td>
<p>The line width of the ticks.  Some devices will round the
default width up to <code>1</code>.</p>
</td></tr>
<tr><td><code id="rug_+3A_col">col</code></td>
<td>
<p>The colour the ticks are plotted in.</p>
</td></tr>
<tr><td><code id="rug_+3A_quiet">quiet</code></td>
<td>
<p>logical indicating if there should be a warning about
clipped values.</p>
</td></tr>
<tr><td><code id="rug_+3A_...">...</code></td>
<td>
<p>further arguments, passed to <code><a href="#topic+axis">axis</a></code>, such
as <code>line</code> or <code>pos</code> for specifying the location of the rug.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because of the way <code>rug</code> is implemented, only values of <code>x</code>
that fall within the plot region are included.  There will be a
warning if any finite values are omitted, but non-finite values are
omitted silently.
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S.</em>
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+jitter">jitter</a></code> which you may want for ties in <code>x</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats)  # both 'density' and its default method
with(faithful, {
    plot(density(eruptions, bw = 0.15))
    rug(eruptions)
    rug(jitter(eruptions, amount = 0.01), side = 3, col = "light blue")
})
</code></pre>

<hr>
<h2 id='screen'>Creating and Controlling Multiple Screens on a Single Device</h2><span id='topic+screen'></span><span id='topic+split.screen'></span><span id='topic+erase.screen'></span><span id='topic+close.screen'></span>

<h3>Description</h3>

<p><code>split.screen</code> defines a number of regions within the current
device which can, to some extent, be treated as separate graphics
devices.  It is useful for generating multiple plots on a single
device.  Screens can themselves be split, allowing for quite complex
arrangements of plots.
</p>
<p><code>screen</code> is used to select which screen to draw in.
</p>
<p><code>erase.screen</code> is used to clear a single screen, which it
does by filling with the background colour.
</p>
<p><code>close.screen</code> removes the specified screen definition(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split.screen(figs, screen, erase = TRUE)
screen(n = , new = TRUE)
erase.screen(n = )
close.screen(n, all.screens = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screen_+3A_figs">figs</code></td>
<td>
<p>a two-element vector describing the number of rows and the
number of columns in a screen matrix <em>or</em> a matrix with 4 columns.
If a matrix, then each row describes a screen with values for the left,
right, bottom, and top of the screen (in that order) in <abbr>NDC</abbr> units,
that is 0 at the lower left corner of the device surface, and 1 at
the upper right corner.</p>
</td></tr>
<tr><td><code id="screen_+3A_screen">screen</code></td>
<td>
<p>a number giving the screen to be split.  It defaults to
the current screen if there is one, otherwise the whole device region.</p>
</td></tr>
<tr><td><code id="screen_+3A_erase">erase</code></td>
<td>
<p>logical: should the selected screen be cleared?</p>
</td></tr>
<tr><td><code id="screen_+3A_n">n</code></td>
<td>
<p>a number indicating which screen to prepare for drawing
(<code>screen</code>), erase (<code>erase.screen</code>), or close
(<code>close.screen</code>).  (<code>close.screen</code> will accept a vector of
screen numbers.)</p>
</td></tr>
<tr><td><code id="screen_+3A_new">new</code></td>
<td>
<p>logical value indicating whether the screen should be
erased as part of the preparation for drawing in the screen.</p>
</td></tr>
<tr><td><code id="screen_+3A_all.screens">all.screens</code></td>
<td>
<p>logical value indicating whether all of the
screens should be closed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first call to <code>split.screen</code> places <span class="rlang"><b>R</b></span> into split-screen
mode.  The other split-screen functions only work within this mode.
While in this mode, certain other commands should be avoided (see the
Warnings section below).  Split-screen mode is exited by the command
<code>close.screen(all = TRUE)</code>.
</p>
<p>If the current screen is closed, <code>close.screen</code> sets the current
screen to be the next larger screen number if there is one, otherwise
to the first available screen.
</p>


<h3>Value</h3>

<p><code>split.screen(*)</code> returns a vector of screen numbers for the
newly-created screens.  With no arguments, <code>split.screen()</code>
returns a vector of valid screen numbers.
</p>
<p><code>screen(n)</code> invisibly returns <code>n</code>, the number of the
selected screen. With no arguments, <code>screen()</code> returns the number
of the current screen.
</p>
<p><code>close.screen()</code> returns a vector of valid screen numbers.
</p>
<p><code>screen</code>, <code>erase.screen</code>, and <code>close.screen</code> all return
<code>FALSE</code> if <span class="rlang"><b>R</b></span> is not in split-screen mode.
</p>


<h3>Warnings</h3>

<p>The recommended way to use these functions is to completely draw a
plot and all additions (i.e., points and lines) to the base plot, prior to
selecting and plotting on another screen. The behavior associated with
returning to a screen to add to an existing plot is unpredictable and
may result in problems that are not readily visible.
</p>
<p>These functions are totally incompatible with the other mechanisms for
arranging plots on a device: <code><a href="#topic+par">par</a>(mfrow)</code>,
<code>par(mfcol)</code> and <code><a href="#topic+layout">layout</a>()</code>.
</p>
<p>The functions are also incompatible with some plotting functions,
such as <code><a href="#topic+coplot">coplot</a></code>, which make use of these other mechanisms.
</p>
<p><code>erase.screen</code> will appear not to work if the background colour
is transparent (as it is by default on most devices).
</p>


<h3>References</h3>

<p>Chambers, J. M. and Hastie, T. J. (1992)
<em>Statistical Models in S</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+par">par</a></code>, <code><a href="#topic+layout">layout</a></code>, <code><a href="grDevices.html#topic+Devices">Devices</a></code>,
<code>dev.*</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
par(bg = "white")           # default is likely to be transparent
split.screen(c(2, 1))       # split display into two screens
split.screen(c(1, 3), screen = 2) # now split the bottom half into 3
screen(1) # prepare screen 1 for output
plot(10:1)
screen(4) # prepare screen 4 for output
plot(10:1)
close.screen(all = TRUE)    # exit split-screen mode

split.screen(c(2, 1))       # split display into two screens
split.screen(c(1, 2), 2)    # split bottom half in two
plot(1:10)                  # screen 3 is active, draw plot
erase.screen()              # forgot label, erase and redraw
plot(1:10, ylab = "ylab 3")
screen(1)                   # prepare screen 1 for output
plot(1:10)
screen(4)                   # prepare screen 4 for output
plot(1:10, ylab = "ylab 4")
screen(1, FALSE)            # return to screen 1, but do not clear
plot(10:1, axes = FALSE, lty = 2, ylab = "")  # overlay second plot
axis(4)                     # add tic marks to right-hand axis
title("Plot 1")
close.screen(all = TRUE)    # exit split-screen mode
}
</code></pre>

<hr>
<h2 id='segments'>Add Line Segments to a Plot</h2><span id='topic+segments'></span>

<h3>Description</h3>

<p>Draw line segments between pairs of points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>segments(x0, y0, x1 = x0, y1 = y0,
         col = par("fg"), lty = par("lty"), lwd = par("lwd"),
         ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="segments_+3A_x0">x0</code>, <code id="segments_+3A_y0">y0</code></td>
<td>
<p>coordinates of points <b>from</b> which to draw.</p>
</td></tr>
<tr><td><code id="segments_+3A_x1">x1</code>, <code id="segments_+3A_y1">y1</code></td>
<td>
<p>coordinates of points <b>to</b> which to draw.  At least
one must be supplied.</p>
</td></tr>
<tr><td><code id="segments_+3A_col">col</code>, <code id="segments_+3A_lty">lty</code>, <code id="segments_+3A_lwd">lwd</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> as in
<code><a href="#topic+par">par</a></code>, possibly vectors.  <code>NA</code> values in <code>col</code>
cause the segment to be omitted.</p>
</td></tr>
<tr><td><code id="segments_+3A_...">...</code></td>
<td>
<p>further <a href="#topic+graphical+20parameters">graphical parameters</a> (from <code><a href="#topic+par">par</a></code>),
such as <code>xpd</code> and the line characteristics <code>lend</code>, <code>ljoin</code>
and <code>lmitre</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each <code>i</code>, a line segment is drawn between the point
<code>(x0[i], y0[i])</code> and the point <code>(x1[i], y1[i])</code>.  The
coordinate vectors will be recycled to the length of the longest.
</p>
<p>The <a href="#topic+graphical+20parameters">graphical parameters</a> <code>col</code>, <code>lty</code> and <code>lwd</code> can be
vectors of length greater than one and will be recycled if necessary.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+arrows">arrows</a></code>,
<code><a href="#topic+polygon">polygon</a></code> for slightly easier and less flexible line
drawing, and
<code><a href="#topic+lines">lines</a></code> for the usual polygons.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- stats::runif(12); y &lt;- stats::rnorm(12)
i &lt;- order(x, y); x &lt;- x[i]; y &lt;- y[i]
plot(x, y, main = "arrows(.) and segments(.)")
## draw arrows from point to point :
s &lt;- seq(length(x)-1)  # one shorter than data
arrows(x[s], y[s], x[s+1], y[s+1], col= 1:3)
s &lt;- s[-length(s)]
segments(x[s], y[s], x[s+2], y[s+2], col= 'pink')
</code></pre>

<hr>
<h2 id='smoothScatter'>Scatterplots with Smoothed Densities Color Representation</h2><span id='topic+smoothScatter'></span>

<h3>Description</h3>

<p><code>smoothScatter</code> produces a smoothed color density
representation of a scatterplot, obtained through a (2D) kernel
density estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothScatter(x, y = NULL, nbin = 128, bandwidth,
              colramp = colorRampPalette(c("white", blues9)),
              nrpoints = 100, ret.selection = FALSE,
              pch = ".", cex = 1, col = "black",
              transformation = function(x) x^.25,
              postPlotHook = box,
              xlab = NULL, ylab = NULL, xlim, ylim,
              xaxs = par("xaxs"), yaxs = par("yaxs"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoothScatter_+3A_x">x</code>, <code id="smoothScatter_+3A_y">y</code></td>
<td>
<p>the <code>x</code> and <code>y</code> arguments provide the x and y
coordinates for the plot.  Any reasonable way of defining the
coordinates is acceptable.  See the function <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>
for details.  If supplied separately, they must be of the same length.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_nbin">nbin</code></td>
<td>
<p>numeric vector of length one (for both directions) or two
(for x and y separately) specifying the number of equally spaced
grid points for the density estimation; directly used as
<code>gridsize</code> in <code><a href="KernSmooth.html#topic+bkde2D">bkde2D</a>()</code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_bandwidth">bandwidth</code></td>
<td>
<p>numeric vector (length 1 or 2) of smoothing bandwidth(s).
If missing, a more or less useful default is used. <code>bandwidth</code>
is subsequently passed to function
<code><a href="KernSmooth.html#topic+bkde2D">bkde2D</a></code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_colramp">colramp</code></td>
<td>
<p>function accepting an integer <code>n</code> as an argument and
returning <code>n</code> colors.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_nrpoints">nrpoints</code></td>
<td>
<p>number of points to be superimposed on the density
image.  The first <code>nrpoints</code> points from those areas of lowest
regional densities will be plotted.  Adding points to the plot
allows for the identification of outliers.  If all points are to be
plotted, choose <code>nrpoints = Inf</code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_ret.selection">ret.selection</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code> indicating to return the
ordered indices of &ldquo;low density&rdquo; points if <code>nrpoints &gt; 0</code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_pch">pch</code>, <code id="smoothScatter_+3A_cex">cex</code>, <code id="smoothScatter_+3A_col">col</code></td>
<td>
<p>arguments passed to <code><a href="#topic+points">points</a></code>,
when <code>nrpoints &gt; 0</code>: point symbol, character expansion factor
and color, see also <code><a href="#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_transformation">transformation</code></td>
<td>
<p>function mapping the density scale to the color scale.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_postplothook">postPlotHook</code></td>
<td>
<p>either <code>NULL</code> or a function which will be
called (with no arguments) after <code><a href="#topic+image">image</a></code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_xlab">xlab</code>, <code id="smoothScatter_+3A_ylab">ylab</code></td>
<td>
<p>character strings to be used as axis labels, passed
to <code><a href="#topic+image">image</a></code>.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_xlim">xlim</code>, <code id="smoothScatter_+3A_ylim">ylim</code></td>
<td>
<p>numeric vectors of length 2 specifying axis limits.</p>
</td></tr>
<tr><td><code id="smoothScatter_+3A_xaxs">xaxs</code>, <code id="smoothScatter_+3A_yaxs">yaxs</code>, <code id="smoothScatter_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="#topic+image">image</a></code>,
e.g., <code>add=TRUE</code> or <code>useRaster=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>smoothScatter</code> produces a smoothed version of a scatter plot.
Two dimensional (kernel density) smoothing is performed by
<code><a href="KernSmooth.html#topic+bkde2D">bkde2D</a></code> from package <a href="https://CRAN.R-project.org/package=KernSmooth"><span class="pkg">KernSmooth</span></a>.
See the examples for how to use this function together with
<code><a href="#topic+pairs">pairs</a></code>.
</p>


<h3>Value</h3>

<p>If <code>ret.selection</code> is true, a vector of integers of length
<code>nrpoints</code> (or smaller, if there are less finite points inside
<code>xlim</code> and <code>ylim</code>) with the indices of the low-density
points drawn, ordered with lowest density first.
</p>


<h3>Author(s)</h3>

<p>Florian Hahne at FHCRC, originally</p>


<h3>See Also</h3>

<p><code><a href="KernSmooth.html#topic+bkde2D">bkde2D</a></code> from package <a href="https://CRAN.R-project.org/package=KernSmooth"><span class="pkg">KernSmooth</span></a>;
<code><a href="grDevices.html#topic+densCols">densCols</a></code> which uses the same smoothing computations and
<code><a href="grDevices.html#topic+blues9">blues9</a></code> in package <span class="pkg">grDevices</span>.
</p>
<p><code><a href="stats.html#topic+scatter.smooth">scatter.smooth</a></code> adds a <code><a href="stats.html#topic+loess">loess</a></code>
regression smoother to a scatter plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## A largish data set
n &lt;- 10000
x1  &lt;- matrix(rnorm(n), ncol = 2)
x2  &lt;- matrix(rnorm(n, mean = 3, sd = 1.5), ncol = 2)
x   &lt;- rbind(x1, x2)

oldpar &lt;- par(mfrow = c(2, 2), mar=.1+c(3,3,1,1), mgp = c(1.5, 0.5, 0))
smoothScatter(x, nrpoints = 0)
smoothScatter(x)

## a different color scheme:
Lab.palette &lt;- colorRampPalette(c("blue", "orange", "red"), space = "Lab")
i.s &lt;- smoothScatter(x, colramp = Lab.palette,
                     ## pch=NA: do not draw them
                     nrpoints = 250, ret.selection=TRUE)
## label the 20 very lowest-density points,the "outliers" (with obs.number):
i.20 &lt;- i.s[1:20]
text(x[i.20,], labels = i.20, cex= 0.75)

## somewhat similar, using identical smoothing computations,
## but considerably *less* efficient for really large data:
plot(x, col = densCols(x), pch = 20)

## use with pairs:
par(mfrow = c(1, 1))
y &lt;- matrix(rnorm(40000), ncol = 4) + 3*rnorm(10000)
y[, c(2,4)] &lt;-  -y[, c(2,4)]
pairs(y, panel = function(...) smoothScatter(..., nrpoints = 0, add = TRUE),
      gap = 0.2)

par(oldpar)
</code></pre>

<hr>
<h2 id='spineplot'>Spine Plots and Spinograms</h2><span id='topic+spineplot'></span><span id='topic+spineplot.default'></span><span id='topic+spineplot.formula'></span>

<h3>Description</h3>

<p>Spine plots are a special cases of mosaic plots, and can be seen as
a generalization of stacked (or highlighted) bar plots. Analogously,
spinograms are an extension of histograms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spineplot(x, ...)

## Default S3 method:
spineplot(x, y = NULL,
          breaks = NULL, tol.ylab = 0.05, off = NULL,
          ylevels = NULL, col = NULL,
          main = "", xlab = NULL, ylab = NULL,
          xaxlabels = NULL, yaxlabels = NULL,
          xlim = NULL, ylim = c(0, 1), axes = TRUE, weights = NULL, ...)

## S3 method for class 'formula'
spineplot(formula, data = NULL,
          breaks = NULL, tol.ylab = 0.05, off = NULL,
          ylevels = NULL, col = NULL,
          main = "", xlab = NULL, ylab = NULL,
          xaxlabels = NULL, yaxlabels = NULL,
          xlim = NULL, ylim = c(0, 1), axes = TRUE, ...,
          subset = NULL, weights = NULL, drop.unused.levels = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spineplot_+3A_x">x</code></td>
<td>
<p>an object, the default method expects either a single variable
(interpreted to be the explanatory variable) or a 2-way table.  See
details.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_y">y</code></td>
<td>
<p>a <code>"factor"</code> interpreted to be the dependent variable</p>
</td></tr>
<tr><td><code id="spineplot_+3A_formula">formula</code></td>
<td>
<p>a <code>"formula"</code> of type <code>y ~ x</code> with a single
dependent <code>"factor"</code> and a single explanatory variable.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_data">data</code></td>
<td>
<p>an optional data frame.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_breaks">breaks</code></td>
<td>
<p>if the explanatory variable is numeric, this controls how
it is discretized. <code>breaks</code> is passed to <code><a href="#topic+hist">hist</a></code> and can
be a list of arguments.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_tol.ylab">tol.ylab</code></td>
<td>
<p>convenience tolerance parameter for y-axis annotation.
If the distance between two labels drops under this threshold, they are
plotted equidistantly.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_off">off</code></td>
<td>
<p>vertical offset between the bars (in per cent). It is fixed to
<code>0</code> for spinograms and defaults to <code>2</code> for spine plots.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_ylevels">ylevels</code></td>
<td>
<p>a character or numeric vector specifying in which order
the levels of the dependent variable should be plotted.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_col">col</code></td>
<td>
<p>a vector of fill colors of the same length as <code>levels(y)</code>.
The default is to call <code><a href="grDevices.html#topic+gray.colors">gray.colors</a></code>.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_main">main</code>, <code id="spineplot_+3A_xlab">xlab</code>, <code id="spineplot_+3A_ylab">ylab</code></td>
<td>
<p>character strings for annotation</p>
</td></tr>
<tr><td><code id="spineplot_+3A_xaxlabels">xaxlabels</code>, <code id="spineplot_+3A_yaxlabels">yaxlabels</code></td>
<td>
<p>character vectors for annotation of x and y axis.
Default to <code>levels(y)</code> and <code>levels(x)</code>, respectively for the
spine plot. For <code>xaxlabels</code> in the spinogram, the breaks are
used.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_xlim">xlim</code>, <code id="spineplot_+3A_ylim">ylim</code></td>
<td>
<p>the range of x and y values with sensible defaults.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_axes">axes</code></td>
<td>
<p>logical.  If <code>FALSE</code> all axes (including those giving
level names) are suppressed.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_weights">weights</code></td>
<td>
<p>numeric. A vector of frequency weights for each
observation in the data. If <code>NULL</code> all weights are implicitly
assumed to be 1. If <code>x</code> is already a 2-way table, the weights
are ignored.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="#topic+rect">rect</a></code>.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td></tr>
<tr><td><code id="spineplot_+3A_drop.unused.levels">drop.unused.levels</code></td>
<td>
<p>should factors have unused levels dropped?
Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>spineplot</code> creates either a spinogram or a spine plot.  It can
be called via <code>spineplot(x, y)</code> or <code>spineplot(y ~ x)</code> where
<code>y</code> is interpreted to be the dependent variable (and has to be
categorical) and <code>x</code> the explanatory variable.  <code>x</code> can be
either categorical (then a spine plot is created) or numerical (then a
spinogram is plotted).  Additionally, <code>spineplot</code> can also be
called with only a single argument which then has to be a 2-way table,
interpreted to correspond to <code>table(x, y)</code>.
</p>
<p>Both, spine plots and spinograms, are essentially mosaic plots with
special formatting of spacing and shading.  Conceptually, they plot
<code class="reqn">P(y | x)</code> against <code class="reqn">P(x)</code>.  For the spine plot (where both
<code class="reqn">x</code> and <code class="reqn">y</code> are categorical), both quantities are approximated
by the corresponding empirical relative frequencies.  For the
spinogram (where <code class="reqn">x</code> is numerical), <code class="reqn">x</code> is first discretized
(by calling <code><a href="#topic+hist">hist</a></code> with <code>breaks</code> argument) and then
empirical relative frequencies are taken.
</p>
<p>Thus, spine plots can also be seen as a generalization of stacked bar
plots where not the heights but the widths of the bars corresponds to
the relative frequencies of <code>x</code>. The heights of the bars then
correspond to the conditional relative frequencies of <code>y</code> in
every <code>x</code> group. Analogously, spinograms extend stacked
histograms.
</p>


<h3>Value</h3>

<p>The table visualized is returned invisibly.
</p>


<h3>Author(s)</h3>

<p>Achim Zeileis <a href="mailto:Achim.Zeileis@R-project.org">Achim.Zeileis@R-project.org</a>
</p>


<h3>References</h3>

<p>Friendly, M. (1994).
Mosaic displays for multi-way contingency tables.
<em>Journal of the American Statistical Association</em>, <b>89</b>,
190&ndash;200.
<a href="https://doi.org/10.2307/2291215">doi:10.2307/2291215</a>.
</p>
<p>Hartigan, J.A., and Kleiner, B. (1984).
A mosaic of television ratings.
<em>The American Statistician</em>, <b>38</b>, 32&ndash;35.
<a href="https://doi.org/10.2307/2683556">doi:10.2307/2683556</a>.
</p>
<p>Hofmann, H., Theus, M. (2005),
<em>Interactive graphics for visualizing conditional distributions</em>.
Unpublished Manuscript.
</p>
<p>Hummel, J. (1996).
Linked bar charts: Analysing categorical data graphically.
<em>Computational Statistics</em>, <b>11</b>, 23&ndash;33.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mosaicplot">mosaicplot</a></code>, <code><a href="#topic+hist">hist</a></code>, <code><a href="#topic+cdplot">cdplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## treatment and improvement of patients with rheumatoid arthritis
treatment &lt;- factor(rep(c(1, 2), c(43, 41)), levels = c(1, 2),
                    labels = c("placebo", "treated"))
improved &lt;- factor(rep(c(1, 2, 3, 1, 2, 3), c(29, 7, 7, 13, 7, 21)),
                   levels = c(1, 2, 3),
                   labels = c("none", "some", "marked"))

## (dependence on a categorical variable)
(spineplot(improved ~ treatment))

## applications and admissions by department at UC Berkeley
## (two-way tables)
(spineplot(marginSums(UCBAdmissions, c(3, 2)),
           main = "Applications at UCB"))
(spineplot(marginSums(UCBAdmissions, c(3, 1)),
           main = "Admissions at UCB"))

## NASA space shuttle o-ring failures
fail &lt;- factor(c(2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 2, 1,
                 1, 1, 1, 2, 1, 1, 1, 1, 1),
               levels = c(1, 2), labels = c("no", "yes"))
temperature &lt;- c(53, 57, 58, 63, 66, 67, 67, 67, 68, 69, 70, 70,
                 70, 70, 72, 73, 75, 75, 76, 76, 78, 79, 81)

## (dependence on a numerical variable)
(spineplot(fail ~ temperature))
(spineplot(fail ~ temperature, breaks = 3))
(spineplot(fail ~ temperature, breaks = quantile(temperature)))

## highlighting for failures
spineplot(fail ~ temperature, ylevels = 2:1)
</code></pre>

<hr>
<h2 id='stars'>Star (Spider/Radar) Plots and Segment Diagrams</h2><span id='topic+stars'></span>

<h3>Description</h3>

<p>Draw star plots or segment diagrams of a multivariate data set.
With one single location, also draws &lsquo;spider&rsquo;
(or &lsquo;radar&rsquo;) plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stars(x, full = TRUE, scale = TRUE, radius = TRUE,
      labels = dimnames(x)[[1]], locations = NULL,
      nrow = NULL, ncol = NULL, len = 1,
      key.loc = NULL, key.labels = dimnames(x)[[2]],
      key.xpd = TRUE,
      xlim = NULL, ylim = NULL, flip.labels = NULL,
      draw.segments = FALSE,
      col.segments = 1:n.seg, col.stars = NA, col.lines = NA,
      axes = FALSE, frame.plot = axes,
      main = NULL, sub = NULL, xlab = "", ylab = "",
      cex = 0.8, lwd = 0.25, lty = par("lty"), xpd = FALSE,
      mar = pmin(par("mar"),
                 1.1+ c(2*axes+ (xlab != ""),
                 2*axes+ (ylab != ""), 1, 0)),
      add = FALSE, plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stars_+3A_x">x</code></td>
<td>
<p>matrix or data frame of data.
One star or segment plot will be produced for each row of <code>x</code>.
Missing values (<code>NA</code>) are allowed, but they are treated as if
they were 0 (after scaling, if relevant).</p>
</td></tr>
<tr><td><code id="stars_+3A_full">full</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the segment plots will
occupy a full circle.  Otherwise, they occupy the (upper) semicircle
only.</p>
</td></tr>
<tr><td><code id="stars_+3A_scale">scale</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the columns of the data
matrix are scaled independently so that the maximum value in each
column is 1 and the minimum is 0.  If <code>FALSE</code>, the presumption
is that the data have been scaled by some other algorithm to the
range <code class="reqn">[0, 1]</code>.</p>
</td></tr>
<tr><td><code id="stars_+3A_radius">radius</code></td>
<td>
<p>logical flag: in <code>TRUE</code>, the radii corresponding to
each variable in the data will be drawn.</p>
</td></tr>
<tr><td><code id="stars_+3A_labels">labels</code></td>
<td>
<p>vector of character strings for labeling the plots.
Unlike the S function <code>stars</code>, no attempt is made to construct
labels if <code>labels = NULL</code>.</p>
</td></tr>
<tr><td><code id="stars_+3A_locations">locations</code></td>
<td>
<p>Either two column matrix with the x and y coordinates used
to place each of the segment plots; or numeric of length 2 when all
plots should be superimposed (for a &lsquo;spider plot&rsquo;).
By default, <code>locations = NULL</code>, the segment plots will be
placed in a rectangular grid.</p>
</td></tr>
<tr><td><code id="stars_+3A_nrow">nrow</code>, <code id="stars_+3A_ncol">ncol</code></td>
<td>
<p>integers giving the number of rows and columns to use when
<code>locations</code> is <code>NULL</code>.  By default, <code>nrow == ncol</code>, a square
layout will be used.</p>
</td></tr>
<tr><td><code id="stars_+3A_len">len</code></td>
<td>
<p>scale factor for the length of radii or segments.</p>
</td></tr>
<tr><td><code id="stars_+3A_key.loc">key.loc</code></td>
<td>
<p>vector with x and y coordinates of the unit key.</p>
</td></tr>
<tr><td><code id="stars_+3A_key.labels">key.labels</code></td>
<td>
<p>vector of character strings for labeling the
segments of the unit key.  If omitted, the second component of
<code>dimnames(x)</code> is used, if available.</p>
</td></tr>
<tr><td><code id="stars_+3A_key.xpd">key.xpd</code></td>
<td>
<p>clipping switch for the unit key (drawing and
labeling), see <code><a href="#topic+par">par</a>("xpd")</code>.</p>
</td></tr>
<tr><td><code id="stars_+3A_xlim">xlim</code></td>
<td>
<p>vector with the range of x coordinates to plot. </p>
</td></tr>
<tr><td><code id="stars_+3A_ylim">ylim</code></td>
<td>
<p>vector with the range of y coordinates to plot.</p>
</td></tr>
<tr><td><code id="stars_+3A_flip.labels">flip.labels</code></td>
<td>
<p>logical indicating if the label locations should
flip up and down from diagram to diagram. Defaults to a somewhat
smart heuristic.</p>
</td></tr>
<tr><td><code id="stars_+3A_draw.segments">draw.segments</code></td>
<td>
<p>logical. If <code>TRUE</code> draw a segment diagram.</p>
</td></tr>
<tr><td><code id="stars_+3A_col.segments">col.segments</code></td>
<td>
<p>color vector (integer or character, see
<code><a href="#topic+par">par</a></code>), each specifying a color for one of the segments
(variables).  Ignored if <code>draw.segments = FALSE</code>.</p>
</td></tr>
<tr><td><code id="stars_+3A_col.stars">col.stars</code></td>
<td>
<p>color vector (integer or character, see
<code><a href="#topic+par">par</a></code>), each specifying a color for one of the stars
(cases).  Ignored if <code>draw.segments = TRUE</code>.</p>
</td></tr>
<tr><td><code id="stars_+3A_col.lines">col.lines</code></td>
<td>
<p>color vector (integer or character, see
<code><a href="#topic+par">par</a></code>), each specifying a color for one of the lines
(cases).  Ignored if <code>draw.segments = TRUE</code>.</p>
</td></tr>
<tr><td><code id="stars_+3A_axes">axes</code></td>
<td>
<p>logical flag: if <code>TRUE</code> axes are added to the plot.</p>
</td></tr>
<tr><td><code id="stars_+3A_frame.plot">frame.plot</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the plot region is framed.</p>
</td></tr>
<tr><td><code id="stars_+3A_main">main</code></td>
<td>
<p>a main title for the plot.</p>
</td></tr>
<tr><td><code id="stars_+3A_sub">sub</code></td>
<td>
<p>a subtitle for the plot.</p>
</td></tr>
<tr><td><code id="stars_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis.</p>
</td></tr>
<tr><td><code id="stars_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis.</p>
</td></tr>
<tr><td><code id="stars_+3A_cex">cex</code></td>
<td>
<p>character expansion factor for the labels.</p>
</td></tr>
<tr><td><code id="stars_+3A_lwd">lwd</code></td>
<td>
<p>line width used for drawing.</p>
</td></tr>
<tr><td><code id="stars_+3A_lty">lty</code></td>
<td>
<p>line type used for drawing.</p>
</td></tr>
<tr><td><code id="stars_+3A_xpd">xpd</code></td>
<td>
<p>logical or NA indicating if clipping should be done, see
<code><a href="#topic+par">par</a>(xpd = .)</code>.</p>
</td></tr>
<tr><td><code id="stars_+3A_mar">mar</code></td>
<td>
<p>argument to <code><a href="#topic+par">par</a>(mar = *)</code>, typically choosing
smaller margins than by default.</p>
</td></tr>
<tr><td><code id="stars_+3A_...">...</code></td>
<td>
<p>further arguments, passed to the first call of
<code>plot()</code>, see <code><a href="#topic+plot.default">plot.default</a></code> and to
<code><a href="#topic+box">box</a>()</code> if <code>frame.plot</code> is true.</p>
</td></tr>
<tr><td><code id="stars_+3A_add">add</code></td>
<td>
<p>logical, if <code>TRUE</code> <em>add</em> stars to current plot.</p>
</td></tr>
<tr><td><code id="stars_+3A_plot">plot</code></td>
<td>
<p>logical, if <code>FALSE</code>, nothing is plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing values are treated as 0.
</p>
<p>Each star plot or segment diagram represents one row of the input
<code>x</code>.  Variables (columns) start on the right and wind
counterclockwise around the circle.  The size of the (scaled) column
is shown by the distance from the center to the point on the star or
the radius of the segment representing the variable.
</p>
<p>Only one page of output is produced.
</p>


<h3>Value</h3>

<p>Returns the locations of the plots in a two column matrix, invisibly
when <code>plot = TRUE</code>.
</p>


<h3>Note</h3>

<p>This code started life as spatial star plots by David A. Andrews.
</p>
<p>Prior to <span class="rlang"><b>R</b></span> 1.4.1, scaling only shifted the maximum to 1, although
documented as here.
</p>


<h3>Author(s)</h3>

<p>Thomas S. Dye</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+symbols">symbols</a></code> for another way to draw stars and other symbols.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(grDevices)
stars(mtcars[, 1:7], key.loc = c(14, 2),
      main = "Motor Trend Cars : stars(*, full = F)", full = FALSE)
stars(mtcars[, 1:7], key.loc = c(14, 1.5),
      main = "Motor Trend Cars : full stars()", flip.labels = FALSE)

## 'Spider' or 'Radar' plot:
stars(mtcars[, 1:7], locations = c(0, 0), radius = FALSE,
      key.loc = c(0, 0), main = "Motor Trend Cars", lty = 2)

## Segment Diagrams:
palette(rainbow(12, s = 0.6, v = 0.75))
stars(mtcars[, 1:7], len = 0.8, key.loc = c(12, 1.5),
      main = "Motor Trend Cars", draw.segments = TRUE)
stars(mtcars[, 1:7], len = 0.6, key.loc = c(1.5, 0),
      main = "Motor Trend Cars", draw.segments = TRUE,
      frame.plot = TRUE, nrow = 4, cex = .7)

## scale linearly (not affinely) to [0, 1]
USJudge &lt;- apply(USJudgeRatings, 2, function(x) x/max(x))
Jnam &lt;- row.names(USJudgeRatings)
Snam &lt;- abbreviate(substring(Jnam, 1, regexpr("[,.]",Jnam) - 1), 7)
stars(USJudge, labels = Jnam, scale = FALSE,
      key.loc = c(13, 1.5), main = "Judge not ...", len = 0.8)
stars(USJudge, labels = Snam, scale = FALSE,
      key.loc = c(13, 1.5), radius = FALSE)

loc &lt;- stars(USJudge, labels = NULL, scale = FALSE,
             radius = FALSE, frame.plot = TRUE,
             key.loc = c(13, 1.5), main = "Judge not ...", len = 1.2)
text(loc, Snam, col = "blue", cex = 0.8, xpd = TRUE)

## 'Segments':
stars(USJudge, draw.segments = TRUE, scale = FALSE, key.loc = c(13,1.5))

## 'Spider':
stars(USJudgeRatings, locations = c(0, 0), scale = FALSE, radius  =  FALSE,
      col.stars = 1:10, key.loc = c(0, 0), main = "US Judges rated")
## Same as above, but with colored lines instead of filled polygons.
stars(USJudgeRatings, locations = c(0, 0), scale = FALSE, radius  =  FALSE,
      col.lines = 1:10, key.loc = c(0, 0), main = "US Judges rated")
## 'Radar-Segments'
stars(USJudgeRatings[1:10,], locations = 0:1, scale = FALSE,
      draw.segments = TRUE, col.segments = 0, col.stars = 1:10, key.loc =  0:1,
      main = "US Judges 1-10 ")
palette("default")
stars(cbind(1:16, 10*(16:1)), draw.segments = TRUE,
      main = "A Joke -- do *not* use symbols on 2D data!")
</code></pre>

<hr>
<h2 id='stem'>Stem-and-Leaf Plots</h2><span id='topic+stem'></span>

<h3>Description</h3>

<p><code>stem</code> produces a stem-and-leaf plot of the values in <code>x</code>.
The parameter <code>scale</code> can be used to expand the scale of the
plot.  A value of <code>scale = 2</code> will cause the plot to be roughly
twice as long as the default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stem(x, scale = 1, width = 80, atom = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stem_+3A_x">x</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
<tr><td><code id="stem_+3A_scale">scale</code></td>
<td>
<p>This controls the plot length.</p>
</td></tr>
<tr><td><code id="stem_+3A_width">width</code></td>
<td>
<p>The desired width of plot.</p>
</td></tr>
<tr><td><code id="stem_+3A_atom">atom</code></td>
<td>
<p>a tolerance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Infinite and missing values in <code>x</code> are discarded.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stem(islands)
stem(log10(islands))
</code></pre>

<hr>
<h2 id='stripchart'>1-D Scatter Plots</h2><span id='topic+stripchart'></span><span id='topic+stripchart.default'></span><span id='topic+stripchart.formula'></span>

<h3>Description</h3>

<p><code>stripchart</code> produces one dimensional scatter plots (or dot
plots) of the given data.  These plots are a good alternative to
<code><a href="#topic+boxplot">boxplot</a></code>s when sample sizes are small.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stripchart(x, ...)

## S3 method for class 'formula'
stripchart(x, data = NULL, dlab = NULL, ...,
           subset, na.action = NULL)


## Default S3 method:
stripchart(x, method = "overplot", jitter = 0.1, offset = 1/3,
           vertical = FALSE, group.names, add = FALSE,
           at = NULL, xlim = NULL, ylim = NULL,
           ylab = NULL, xlab = NULL, dlab = "", glab = "",
           log = "", pch = 0, col = par("fg"), cex = par("cex"),
           axes = TRUE, frame.plot = axes, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stripchart_+3A_x">x</code></td>
<td>
<p>the data from which the plots are to be produced.  In the
default method the data can be specified as a single numeric
vector, or as list of numeric vectors, each corresponding to
a component plot.  In the <code>formula</code> method, a symbolic
specification of the form <code>y ~ g</code> can be given,
indicating the observations in the vector <code>y</code> are to be
grouped according to the levels of the factor
<code>g</code>.  <code>NA</code>s are allowed in the data.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_data">data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>x</code> should be taken.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used for plotting.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is to ignore missing
values in either the response or the group.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_...">...</code></td>
<td>
<p>additional parameters passed to the default method, or by
it to <code><a href="#topic+plot.window">plot.window</a></code>, <code><a href="#topic+points">points</a></code>,
<code><a href="#topic+axis">axis</a></code> and <code><a href="#topic+title">title</a></code> to control the appearance
of the plot.</p>
</td></tr> 
<tr><td><code id="stripchart_+3A_method">method</code></td>
<td>
<p>the method to be used to separate coincident points.
The default method <code>"overplot"</code> causes such points to be
overplotted, but it is also possible to specify <code>"jitter"</code> to
jitter the points, or <code>"stack"</code> have coincident points
stacked.  The last method only makes sense for very granular data.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_jitter">jitter</code></td>
<td>
<p>when <code>method = "jitter"</code> is used, <code>jitter</code>
gives the amount of jittering applied.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_offset">offset</code></td>
<td>
<p>when stacking is used, points are stacked this many
line-heights (symbol widths) apart.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_vertical">vertical</code></td>
<td>
<p>when vertical is <code>TRUE</code> the plots are drawn
vertically rather than the default horizontal.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_group.names">group.names</code></td>
<td>
<p>group labels which will be printed alongside
(or underneath) each plot.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_add">add</code></td>
<td>
<p>logical, if true <em>add</em> the chart to the current plot.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_at">at</code></td>
<td>
<p>numeric vector giving the locations where the charts should
be drawn, particularly when <code>add = TRUE</code>;
defaults to <code>1:n</code> where <code>n</code> is the number of boxes.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_ylab">ylab</code>, <code id="stripchart_+3A_xlab">xlab</code></td>
<td>
<p>labels: see <code><a href="#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_dlab">dlab</code>, <code id="stripchart_+3A_glab">glab</code></td>
<td>
<p>alternate way to specify axis labels: see &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_xlim">xlim</code>, <code id="stripchart_+3A_ylim">ylim</code></td>
<td>
<p>plot limits: see <code><a href="#topic+plot.window">plot.window</a></code>.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_log">log</code></td>
<td>
<p>on which axes to use a log scale:  see
<code><a href="#topic+plot.default">plot.default</a></code></p>
</td></tr>
<tr><td><code id="stripchart_+3A_pch">pch</code>, <code id="stripchart_+3A_col">col</code>, <code id="stripchart_+3A_cex">cex</code></td>
<td>
<p>Graphical parameters: see <code><a href="#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="stripchart_+3A_axes">axes</code>, <code id="stripchart_+3A_frame.plot">frame.plot</code></td>
<td>
<p>Axis control:  see <code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extensive examples of the use of this kind of plot can be found in
Box, Hunter and Hunter (2005) or
Wild and Seber (2000).
</p>
<p>The <code>dlab</code> and <code>glab</code> labels may be used instead of <code>xlab</code>
and <code>ylab</code> if those are not specified.  <code>dlab</code> applies to the
continuous data axis (the X axis unless <code>vertical</code> is <code>TRUE</code>),
<code>glab</code> to the group axis.
</p>


<h3>References</h3>

<p>Box G., Hunter, J. S. and Hunter, W. C. (2005). 
<em>Statistics for Experimenters: Design, Innovation, and Discovery</em>,
second edition.
New York: Wiley.
ISBN: 978-0-471-71813-0.
</p>
<p>Wild, C. and Seber, G. (2000).
<em>Chance Encounters: A First Course in Data Analysis and
Inference</em>.
John Wiley and Sons.
ISBN 0-471-32936-3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- stats::rnorm(50)
xr &lt;- round(x, 1)
stripchart(x) ; m &lt;- mean(par("usr")[1:2])
text(m, 1.04, "stripchart(x, \"overplot\")")
stripchart(xr, method = "stack", add = TRUE, at = 1.2)
text(m, 1.35, "stripchart(round(x,1), \"stack\")")
stripchart(xr, method = "jitter", add = TRUE, at = 0.7)
text(m, 0.85, "stripchart(round(x,1), \"jitter\")")

stripchart(decrease ~ treatment,
    main = "stripchart(OrchardSprays)",
    vertical = TRUE, log = "y", data = OrchardSprays)

stripchart(decrease ~ treatment, at = c(1:8)^2,
    main = "stripchart(OrchardSprays)",
    vertical = TRUE, log = "y", data = OrchardSprays)
</code></pre>

<hr>
<h2 id='strwidth'>Plotting Dimensions of Character Strings and Math Expressions</h2><span id='topic+strwidth'></span><span id='topic+strheight'></span>

<h3>Description</h3>

<p>These functions compute the width or height, respectively, of the
given strings or mathematical expressions <code>s[i]</code> on
the current plotting device in <em>user</em> coordinates, <em>inches</em>
or as fraction of the figure width <code>par("fin")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strwidth(s, units = "user", cex = NULL, font = NULL, vfont = NULL, ...)
strheight(s, units = "user", cex = NULL, font = NULL, vfont = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strwidth_+3A_s">s</code></td>
<td>
<p>a character or <a href="base.html#topic+expression">expression</a> vector whose dimensions
are to be determined.  Other objects are coerced by
<code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>.</p>
</td></tr>
<tr><td><code id="strwidth_+3A_units">units</code></td>
<td>
<p>character indicating in which units <code>s</code> is measured;
should be one of <code>"user"</code>, <code>"inches"</code>, <code>"figure"</code>;
partial matching is performed.</p>
</td></tr>
<tr><td><code id="strwidth_+3A_cex">cex</code></td>
<td>
<p>numeric <b>c</b>haracter <b>ex</b>pansion factor; multiplied
by <code><a href="#topic+par">par</a>("cex")</code> yields the final character size; the
default <code>NULL</code> is equivalent to <code>1</code>.</p>
</td></tr>
<tr><td><code id="strwidth_+3A_font">font</code>, <code id="strwidth_+3A_vfont">vfont</code>, <code id="strwidth_+3A_...">...</code></td>
<td>
<p>additional information about the font,
possibly including the graphics parameter <code>"family"</code>:
see <code><a href="#topic+text">text</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the &lsquo;height&rsquo; of a string is determined only by the
number of linefeeds (<code>"\n"</code>, aka &ldquo;newline&rdquo;s) it contains: it is the (number of
linefeeds - 1) times the line spacing plus the height of <code>"M"</code> in
the selected font.  For an expression it is the height of the
bounding box as computed by <a href="grDevices.html#topic+plotmath">plotmath</a>.  Thus in both cases it is
an estimate of how far <b>above</b> the final baseline the typeset
object extends.  (It may also extend below the baseline.)  The
inter-line spacing is controlled by <code>cex</code>,
<code><a href="#topic+par">par</a>("lheight")</code> and the &lsquo;point size&rsquo; (but not the
actual font in use).
</p>
<p>Measurements in <code>"user"</code> units (the default) are only available
after <code><a href="#topic+plot.new">plot.new</a></code> has been called &ndash; otherwise an error is
thrown.
</p>


<h3>Value</h3>

<p>Numeric vector with the same length as <code>s</code>, giving the estimate of
width or height for each <code>s[i]</code>.  <code>NA</code> strings are given
width and height 0 (as they are not plotted).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+text">text</a></code>, <code><a href="base.html#topic+nchar">nchar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str.ex &lt;- c("W","w","I",".","WwI.")
op &lt;- par(pty = "s"); plot(1:100, 1:100, type = "n")
sw &lt;- strwidth(str.ex); sw
all.equal(sum(sw[1:4]), sw[5])
#- since the last string contains the others

sw.i &lt;- strwidth(str.ex, "inches"); 25.4 * sw.i  # width in [mm]
unique(sw / sw.i)
# constant factor: 1 value
mean(sw.i / strwidth(str.ex, "fig")) / par('fin')[1]  # = 1: are the same

## See how letters fall in classes
##  -- depending on graphics device and font!
all.lett &lt;- c(letters, LETTERS)
shL &lt;- strheight(all.lett, units = "inches") * 72  # 'big points'
table(shL)  # all have same heights ...
mean(shL)/par("cin")[2] # around 0.6

(swL &lt;- strwidth(all.lett, units = "inches") * 72)  # 'big points'
split(all.lett, factor(round(swL, 2)))

sumex &lt;- expression(sum(x[i], i=1,n), e^{i * pi} == -1)
strwidth(sumex)
strheight(sumex)

par(op)  #- reset to previous setting
</code></pre>

<hr>
<h2 id='sunflowerplot'>Produce a Sunflower Scatter Plot</h2><span id='topic+sunflowerplot'></span><span id='topic+sunflowerplot.default'></span><span id='topic+sunflowerplot.formula'></span>

<h3>Description</h3>

<p>Multiple points are plotted as &lsquo;sunflowers&rsquo; with multiple leaves
(&lsquo;petals&rsquo;) such that overplotting is visualized instead of
accidental and invisible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sunflowerplot(x, ...)

## Default S3 method:
sunflowerplot(x, y = NULL, number, log = "", digits = 6,
              xlab = NULL, ylab = NULL, xlim = NULL, ylim = NULL,
              add = FALSE, rotate = FALSE,
              pch = 16, cex = 0.8, cex.fact = 1.5,
              col = par("col"), bg = NA, size = 1/8, seg.col = 2,
              seg.lwd = 1.5, ...)

## S3 method for class 'formula'
sunflowerplot(formula, data = NULL, xlab = NULL, ylab = NULL, ...,
             subset, na.action = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sunflowerplot_+3A_x">x</code></td>
<td>
<p>numeric vector of <code>x</code>-coordinates of length <code>n</code>,
say, or another valid plotting structure, as for
<code><a href="#topic+plot.default">plot.default</a></code>, see also <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_y">y</code></td>
<td>
<p>numeric vector of <code>y</code>-coordinates of length <code>n</code>.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_number">number</code></td>
<td>
<p>integer vector of length <code>n</code>. <code>number[i]</code> = number
of replicates for <code>(x[i], y[i])</code>, may be 0.<br />
Default (<code>missing(number)</code>): compute the exact multiplicity of
the points <code>x[], y[]</code>, via
<code><a href="grDevices.html#topic+xyTable">xyTable</a>()</code>.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_log">log</code></td>
<td>
<p>character indicating log coordinate scale, see
<code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_digits">digits</code></td>
<td>
<p>when <code>number</code> is computed (i.e., not specified),
<code>x</code> and <code>y</code> are rounded to <code>digits</code> significant
digits before multiplicities are computed.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_xlab">xlab</code>, <code id="sunflowerplot_+3A_ylab">ylab</code></td>
<td>
<p>character label for x-, or y-axis, respectively.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_xlim">xlim</code>, <code id="sunflowerplot_+3A_ylim">ylim</code></td>
<td>
<p><code>numeric(2)</code> limiting the extents of the x-,
or y-axis.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_add">add</code></td>
<td>
<p>logical; should the plot be added on a previous one ?
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_rotate">rotate</code></td>
<td>
<p>logical; if <code>TRUE</code>, randomly rotate the
sunflowers (preventing artefacts).</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_pch">pch</code></td>
<td>
<p>plotting character to be used for points
(<code>number[i]==1</code>) and center of sunflowers.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_cex">cex</code></td>
<td>
<p>numeric; character size expansion of center points
(s. <code>pch</code>).</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_cex.fact">cex.fact</code></td>
<td>
<p>numeric <em>shrinking</em> factor to be used for the
center points <em>when there are flower leaves</em>,
i.e., <code>cex / cex.fact</code> is used for these.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_col">col</code>, <code id="sunflowerplot_+3A_bg">bg</code></td>
<td>
<p>colors for the plot symbols, passed to
<code><a href="#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_size">size</code></td>
<td>
<p>of sunflower leaves in inches, 1[in] := 2.54[cm].
Default: 1/8\&quot;, approximately 3.2mm.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_seg.col">seg.col</code></td>
<td>
<p>color to be used for the <b>seg</b>ments which make the
sunflowers leaves, see <code><a href="#topic+par">par</a>(col=)</code>;
<code>col = "gold"</code> reminds of real sunflowers.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_seg.lwd">seg.lwd</code></td>
<td>
<p>numeric; the line width for the leaves' segments.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="#topic+plot">plot</a></code> [if
<code>add = FALSE</code>], or to be passed to or from another method.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_formula">formula</code></td>
<td>
<p>a <code><a href="stats.html#topic+formula">formula</a></code>, such as <code>y ~ x</code>.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_data">data</code></td>
<td>
<p>a data.frame (or list) from which the variables in
<code>formula</code> should be taken.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="sunflowerplot_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is to ignore case
with missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function with default and formula methods.
</p>
<p>For <code>number[i] == 1</code>, a (slightly enlarged) usual plotting symbol
(<code>pch</code>) is drawn.  For <code>number[i] &gt; 1</code>, a small plotting
symbol is drawn and <code>number[i]</code> equi-angular &lsquo;rays&rsquo;
emanate from it.
</p>
<p>If <code>rotate = TRUE</code> and <code>number[i] &gt;= 2</code>, a random direction
is chosen (instead of the y-axis) for the first ray.  The goal is to
<code><a href="base.html#topic+jitter">jitter</a></code> the orientations of the sunflowers in order to
prevent artefactual visual impressions.
</p>


<h3>Value</h3>

<p>A list with three components of same length,
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>x coordinates</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>y coordinates</p>
</td></tr>
<tr><td><code>number</code></td>
<td>
<p>number</p>
</td></tr>
</table>
<p>Use <code><a href="grDevices.html#topic+xyTable">xyTable</a>()</code> (from package
<span class="pkg">grDevices</span>) if you are only interested in this return value.
</p>


<h3>Side Effects</h3>

<p>A scatter plot is drawn with &lsquo;sunflowers&rsquo; as symbols.
</p>


<h3>Author(s)</h3>

<p>Andreas Ruckstuhl, Werner Stahel, Martin Maechler, Tim Hesterberg,
1989&ndash;1993.  Port to <span class="rlang"><b>R</b></span> by Martin Maechler
<a href="mailto:maechler@stat.math.ethz.ch">maechler@stat.math.ethz.ch</a>.
</p>


<h3>References</h3>

<p>Chambers, J. M., Cleveland, W. S., Kleiner, B. and Tukey, P. A. (1983).
<em>Graphical Methods for Data Analysis</em>.
Wadsworth.
</p>
<p>Schilling, M. F. and Watkins, A. E. (1994).
A suggestion for sunflower plots.
<em>The American Statistician</em>, <b>48</b>, 303&ndash;305.
<a href="https://doi.org/10.2307/2684839">doi:10.2307/2684839</a>.
</p>
<p>Murrell, P. (2005).
<em>R Graphics</em>.
Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+density">density</a></code>, <code><a href="grDevices.html#topic+xyTable">xyTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats) # for rnorm
require(grDevices)

## 'number' is computed automatically:
sunflowerplot(iris[, 3:4])
## Imitating Chambers et al, p.109, closely:
sunflowerplot(iris[, 3:4], cex = .2, cex.fact = 1, size = .035, seg.lwd = .8)
## or
sunflowerplot(Petal.Width ~ Petal.Length, data = iris,
              cex = .2, cex.fact = 1, size = .035, seg.lwd = .8)


sunflowerplot(x = sort(2*round(rnorm(100))), y = round(rnorm(100), 0),
              main = "Sunflower Plot of Rounded N(0,1)")
## Similarly using a "xyTable" argument:
xyT &lt;- xyTable(x = sort(2*round(rnorm(100))), y = round(rnorm(100), 0),
               digits = 3)
utils::str(xyT, vec.len = 20)
sunflowerplot(xyT, main = "2nd Sunflower Plot of Rounded N(0,1)")

## A 'marked point process' {explicit 'number' argument}:
sunflowerplot(rnorm(100), rnorm(100), number = rpois(n = 100, lambda = 2),
              main = "Sunflower plot (marked point process)",
              rotate = TRUE, col = "blue4")
</code></pre>

<hr>
<h2 id='symbols'>Draw Symbols (Circles, Squares, Stars, Thermometers, Boxplots)</h2><span id='topic+symbols'></span>

<h3>Description</h3>

<p>This function draws symbols on a plot.  One of six symbols;
<em>circles</em>, <em>squares</em>, <em>rectangles</em>, <em>stars</em>,
<em>thermometers</em>, and <em>boxplots</em>, can be plotted at a
specified set of x and y coordinates.  Specific aspects of the
symbols, such as relative size, can be customized by additional
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symbols(x, y = NULL, circles, squares, rectangles, stars,
        thermometers, boxplots, inches = TRUE, add = FALSE,
        fg = par("col"), bg = NA,
        xlab = NULL, ylab = NULL, main = NULL,
        xlim = NULL, ylim = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="symbols_+3A_x">x</code>, <code id="symbols_+3A_y">y</code></td>
<td>
<p>the x and y co-ordinates for the centres of the symbols.
They can be specified in any way which is accepted by
<code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>.</p>
</td></tr>
<tr><td><code id="symbols_+3A_circles">circles</code></td>
<td>
<p>a vector giving the radii of the circles.</p>
</td></tr>
<tr><td><code id="symbols_+3A_squares">squares</code></td>
<td>
<p>a vector giving the length of the sides of the squares.</p>
</td></tr>
<tr><td><code id="symbols_+3A_rectangles">rectangles</code></td>
<td>
<p>a matrix with two columns.  The first column gives
widths and the second the heights of rectangles.</p>
</td></tr>
<tr><td><code id="symbols_+3A_stars">stars</code></td>
<td>
<p>a matrix with three or more columns giving the lengths
of the rays from the center of the stars.  <code>NA</code> values
are replaced by zeroes.</p>
</td></tr>
<tr><td><code id="symbols_+3A_thermometers">thermometers</code></td>
<td>
<p>a matrix with three or four columns.  The first
two columns give the width and height of the thermometer symbols. If
there are three columns, the third is taken as a proportion: the
thermometers are filled (using colour <code>fg</code>) from their base to
this proportion of their height.  If there are four columns, the
third and fourth columns are taken as proportions and the
thermometers are filled between these two proportions of their
heights.  The part of the box not filled in <code>fg</code> will be filled
in the background colour (default transparent) given by <code>bg</code>.</p>
</td></tr>
<tr><td><code id="symbols_+3A_boxplots">boxplots</code></td>
<td>
<p>a matrix with five columns.  The first two columns
give the width and height of the boxes, the next two columns
give the lengths of the lower and upper whiskers and the fifth
the proportion (with a warning if not in [0,1]) of the way up
the box that the median line is drawn.</p>
</td></tr>
<tr><td><code id="symbols_+3A_inches">inches</code></td>
<td>
<p><code>TRUE</code>, <code>FALSE</code> or a positive number.
See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="symbols_+3A_add">add</code></td>
<td>
<p>if <code>add</code> is <code>TRUE</code>, the symbols are added to
an existing plot, otherwise a new plot is created.</p>
</td></tr>
<tr><td><code id="symbols_+3A_fg">fg</code></td>
<td>
<p>colour(s) the symbols are to be drawn in.</p>
</td></tr>
<tr><td><code id="symbols_+3A_bg">bg</code></td>
<td>
<p>if specified, the symbols are filled with colour(s), the
vector <code>bg</code> being recycled to the number of symbols.
The default is to leave the symbols unfilled.</p>
</td></tr>
<tr><td><code id="symbols_+3A_xlab">xlab</code></td>
<td>
<p>the x label of the plot if <code>add</code> is not true.
Defaults to the <code><a href="base.html#topic+deparse">deparse</a></code>d expression used for <code>x</code>.</p>
</td></tr>
<tr><td><code id="symbols_+3A_ylab">ylab</code></td>
<td>
<p>the y label of the plot.  Unused if <code>add = TRUE</code>.</p>
</td></tr>
<tr><td><code id="symbols_+3A_main">main</code></td>
<td>
<p>a main title for the plot.  Unused if <code>add = TRUE</code>.</p>
</td></tr>
<tr><td><code id="symbols_+3A_xlim">xlim</code></td>
<td>
<p>numeric vector of length 2 giving the x limits for the
plot.  Unused if <code>add = TRUE</code>.</p>
</td></tr>
<tr><td><code id="symbols_+3A_ylim">ylim</code></td>
<td>
<p>numeric vector of length 2 giving the y limits for the
plot.  Unused if <code>add = TRUE</code>.</p>
</td></tr>
<tr><td><code id="symbols_+3A_...">...</code></td>
<td>
<p>graphics parameters can also be passed to this function,
as can the plot aspect ratio <code>asp</code> (see <code><a href="#topic+plot.window">plot.window</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Observations which have missing coordinates or missing size
parameters are not plotted.  The exception to this is <em>stars</em>.
In that case, the length of any ray which is <code>NA</code> is reset
to zero.
</p>
<p>Argument <code>inches</code> controls the sizes of the symbols.  If
<code>TRUE</code> (the default), the symbols are scaled so that the
largest dimension of any symbol is one inch.  If a positive number is
given the symbols are scaled to make largest dimension this size in
inches (so <code>TRUE</code> and <code>1</code> are equivalent).  If <code>inches</code>
is <code>FALSE</code>, the units are taken to be those of the appropriate
axes.  (For circles, squares and stars the units of the x axis are
used.  For boxplots, the lengths of the whiskers are regarded as
dimensions alongside width and height when scaling by <code>inches</code>,
and are otherwise interpreted in the units of the y axis.)
</p>

<p>Circles of radius zero are plotted at radius one pixel (which is
device-dependent).  Circles of a very small non-zero radius may or may
not be visible, and may be smaller than circles of radius zero.  On
<code>windows</code> devices circles are plotted at radius at least one
pixel as some Windows versions omit smaller circles.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>W. S. Cleveland (1985)
<em>The Elements of Graphing Data.</em>
Monterey, California: Wadsworth.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stars">stars</a></code> for drawing <em>stars</em> with a bit more
flexibility.
</p>
<p>If you are thinking about doing &lsquo;bubble plots&rsquo; by
<code>symbols(*, circles=*)</code>, you should <em>really</em> consider using
<code><a href="#topic+sunflowerplot">sunflowerplot</a></code> instead.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(grDevices)
x &lt;- 1:10
y &lt;- sort(10*runif(10))
z &lt;- runif(10)
z3 &lt;- cbind(z, 2*runif(10), runif(10))
symbols(x, y, thermometers = cbind(.5, 1, z), inches = .5, fg = 1:10)
symbols(x, y, thermometers = z3, inches = FALSE)
text(x, y, apply(format(round(z3, digits = 2)), 1, paste, collapse = ","),
     adj = c(-.2,0), cex = .75, col = "purple", xpd = NA)

## Note that  example(trees)  shows more sensible plots!
N &lt;- nrow(trees)
with(trees, {
## Girth is diameter in inches
symbols(Height, Volume, circles = Girth/24, inches = FALSE,
        main = "Trees' Girth") # xlab and ylab automatically
## Colours too:
op &lt;- palette(rainbow(N, end = 0.9))
symbols(Height, Volume, circles = Girth/16, inches = FALSE, bg = 1:N,
        fg = "gray30", main = "symbols(*, circles = Girth/16, bg = 1:N)")
palette(op)
})
</code></pre>

<hr>
<h2 id='text'>Add Text to a Plot</h2><span id='topic+text'></span><span id='topic+text.default'></span>

<h3>Description</h3>

<p><code>text</code> draws the strings given in the vector <code>labels</code> at the
coordinates given by <code>x</code> and <code>y</code>.
<code>y</code> may be missing since <code><a href="grDevices.html#topic+xy.coords">xy.coords</a>(x, y)</code> is used for
construction of the coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>text(x, ...)

## Default S3 method:
 text(x, y = NULL, labels = seq_along(x$x), adj = NULL,
     pos = NULL, offset = 0.5, vfont = NULL,
     cex = 1, col = NULL, font = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="text_+3A_x">x</code>, <code id="text_+3A_y">y</code></td>
<td>
<p>numeric vectors of coordinates where the text
<code>labels</code> should be written.  If the length of <code>x</code> and
<code>y</code> differs, the shorter one is recycled.</p>
</td></tr>
<tr><td><code id="text_+3A_labels">labels</code></td>
<td>
<p>a character vector or <a href="base.html#topic+expression">expression</a> specifying
the <em>text</em> to be written.  An attempt is made to coerce other
language objects (names and calls) to expressions, and vectors and
other classed objects to character vectors by <code><a href="base.html#topic+as.character">as.character</a></code>.
If <code>labels</code> is longer than <code>x</code> and
<code>y</code>, the coordinates are recycled to the length of <code>labels</code>.</p>
</td></tr>
<tr><td><code id="text_+3A_adj">adj</code></td>
<td>
<p>one or two values in <code class="reqn">[0, 1]</code> which specify the x
(and optionally y) adjustment (&lsquo;justification&rsquo;) of the
labels, with 0 for left/bottom, 1 for right/top, and 0.5 for
centered.  On most devices values outside <code class="reqn">[0, 1]</code> will also
work.  See below.</p>
</td></tr>
<tr><td><code id="text_+3A_pos">pos</code></td>
<td>
<p>a position specifier for the text.  If specified this
overrides any <code>adj</code> value given.  Values of <code>1</code>,
<code>2</code>, <code>3</code> and <code>4</code>, respectively indicate
positions below, to the left of, above and to the right of
the specified <code>(x,y)</code> coordinates.</p>
</td></tr>
<tr><td><code id="text_+3A_offset">offset</code></td>
<td>
<p>when <code>pos</code> is specified, this value controls the
distance (&lsquo;offset&rsquo;) of the text label from the specified
coordinate in fractions of a character width.</p>
</td></tr>
<tr><td><code id="text_+3A_vfont">vfont</code></td>
<td>
<p><code>NULL</code> for the current font family, or a character
vector of length 2 for <code><a href="grDevices.html#topic+Hershey">Hershey</a></code> vector
fonts.  The first element of
the vector selects a typeface and the second element selects a
style.  Ignored if <code>labels</code> is an expression.</p>
</td></tr>
<tr><td><code id="text_+3A_cex">cex</code></td>
<td>
<p>numeric <b>c</b>haracter <b>ex</b>pansion factor; multiplied
by <code><a href="#topic+par">par</a>("cex")</code> yields the final character size.
<code>NULL</code> and <code>NA</code> are equivalent to <code>1.0</code>.</p>
</td></tr>
<tr><td><code id="text_+3A_col">col</code>, <code id="text_+3A_font">font</code></td>
<td>
<p>the color and (if <code>vfont = NULL</code>) font to be
used, possibly vectors.  These default to the values of the global
<a href="#topic+graphical+20parameters">graphical parameters</a> in <code><a href="#topic+par">par</a>()</code>.</p>
</td></tr>
<tr><td><code id="text_+3A_...">...</code></td>
<td>
<p>further <a href="#topic+graphical+20parameters">graphical parameters</a> (from <code><a href="#topic+par">par</a></code>),
such as <code>srt</code>, <code>family</code> and <code>xpd</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>labels</code> must be of type <code><a href="base.html#topic+character">character</a></code> or
<code><a href="base.html#topic+expression">expression</a></code> (or be coercible to such a type).
In the latter case, quite a bit of
mathematical notation is available such as sub- and superscripts,
Greek letters, fractions, etc.
</p>
<p><code>adj</code> allows <em>adj</em>ustment of the text position with respect to
<code>(x, y)</code>.
Values of 0, 0.5, and 1 specify that <code>(x, y)</code> should align with
the left/bottom, middle and
right/top of the text, respectively.
A value of <code>NA</code> means &ldquo;centre&rdquo;, which is the same as 0.5
for horizontal justification, but includes descenders for vertical
justification (where 0.5 does not).
The default is for centered text, although the default horizontal
justification is taken from <code>par(adj)</code>, i.e., the default is
<code>adj = c(par("adj"), NA)</code>.
If only one value is provided, it is applied
to adjust <code>x</code> <em>only</em>, i.e., when <code>length(adj) == 1L</code>,
<code>adj</code> is applied as <code>adj = c(adj, NA)</code>.
Accurate vertical centering needs
character metric information on individual characters which is
only available on some devices.  Vertical alignment is done slightly
differently for character strings and for expressions:
<code>adj = c(0,0)</code> means to left-justify and to align on the baseline
for strings but on the bottom of the bounding box for expressions.
This also affects vertical centering: for strings the centering
excludes any descenders whereas for expressions it includes them.
</p>
<p>The <code>pos</code> and <code>offset</code> arguments can be used in conjunction
with values returned by <code>identify</code> to recreate an interactively
labelled plot.
</p>
<p>Text can be rotated by using <a href="#topic+graphical+20parameters">graphical parameters</a> <code>srt</code>
(see <code><a href="#topic+par">par</a></code>).  When <code>adj</code> is specified, a non-zero
<code>srt</code> rotates the label about <code>(x, y)</code>.  If <code>pos</code> is
specified, <code>srt</code> rotates the text about the point on its bounding
box which is closest to <code>(x, y)</code>: top center for <code>pos = 1</code>,
right center for <code>pos = 2</code>, bottom center for <code>pos = 3</code>, and
left center for <code>pos = 4</code>.  The <code>pos</code> interface is not as
useful for rotated text because the result is no longer centered
vertically or horizontally with respect to <code>(x, y)</code>.  At present
there is no interface in the <span class="pkg">graphics</span> package for directly
rotating text about its center which is achievable however by fiddling
with <code>adj</code> and <code>srt</code> simultaneously.
</p>
<p>Graphical parameters <code>col</code>, <code>cex</code> and <code>font</code> can be
vectors and will then be applied cyclically to the <code>labels</code> (and
extra values will be ignored).  <code>NA</code> values of <code>font</code> are
replaced by <code>par("font")</code>, and similarly for <code>col</code>.
</p>
<p>Labels whose <code>x</code>, <code>y</code> or <code>labels</code> value is <code>NA</code>
are omitted from the plot.
</p>
<p>What happens when <code>font = 5</code> (the symbol font) is selected can be
both device- and locale-dependent.  Most often <code>labels</code> will be
interpreted in the Adobe symbol encoding, so e.g. <code>"d"</code>
is delta, and <code>"\300"</code> is aleph.
</p>


<h3>Euro symbol</h3>

<p>The Euro symbol may not be available in older fonts.  In current
versions of Adobe symbol fonts it is character 160, so <code>text(x,
  y, "\xA0", font = 5)</code> may work. People using Western European locales
on Unix-alikes can probably select ISO-8895-15 (Latin-9) which has the
Euro as character 165: this can also be used for
<code><a href="grDevices.html#topic+pdf">pdf</a></code> and <code><a href="grDevices.html#topic+postscript">postscript</a></code>. It is &lsquo;<span class="samp">&#8288;\u20ac&#8288;</span>&rsquo; in
Unicode, which can be used in UTF-8 locales.
</p>
<p>The Euro should be rendered correctly by <code><a href="grDevices.html#topic+X11">X11</a></code> in UTF-8
locales, but the corresponding single-byte encoding in
<code><a href="grDevices.html#topic+postscript">postscript</a></code> and <code><a href="grDevices.html#topic+pdf">pdf</a></code> will need to be selected
as <code>ISOLatin9.enc</code> (and the font will need to contain the Euro
glyph, which for example older printers may not).
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>
<p>Murrell, P. (2005) <em>R Graphics</em>. Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+text.formula">text.formula</a></code> for the formula method;
<code><a href="#topic+mtext">mtext</a></code>, <code><a href="#topic+title">title</a></code>,
<code><a href="grDevices.html#topic+Hershey">Hershey</a></code> for details on Hershey vector fonts,
<code><a href="grDevices.html#topic+plotmath">plotmath</a></code> for details and more examples on
mathematical annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(-1:1, -1:1, type = "n", xlab = "Re", ylab = "Im")
K &lt;- 16; text(exp(1i * 2 * pi * (1:K) / K), col = 2)

## The following two examples use latin1 characters: these may not
## appear correctly (or be omitted entirely).
plot(1:10, 1:10, main = "text(...) examples\n~~~~~~~~~~~~~~",
     sub = "R is GNU , but not  ...")
mtext("Latin-1 accented chars:   &lt; &lt;", side = 3)
points(c(6,2), c(2,1), pch = 3, cex = 4, col = "red")
text(6, 2, "the text is CENTERED around (x,y) = (6,2) by default",
     cex = .8)
text(2, 1, "or Left/Bottom - JUSTIFIED at (2,1) by 'adj = c(0,0)'",
     adj = c(0,0))
text(4, 9, expression(hat(beta) == (X^t * X)^{-1} * X^t * y))
text(4, 8.4, "expression(hat(beta) == (X^t * X)^{-1} * X^t * y)",
     cex = .75)
text(4, 7, expression(bar(x) == sum(frac(x[i], n), i==1, n)))

## Two more latin1 examples
text(5, 10.2,
     "Le franais, c'est facile: Rgles, Libert, Egalit, Fraternit...")
text(5, 9.8,
     "Jetz no chli zrittsch: (noch ein bichen Zrcher deutsch)")
</code></pre>

<hr>
<h2 id='title'>Plot Annotation</h2><span id='topic+title'></span>

<h3>Description</h3>

<p>This function can be used to add labels to a plot.  Its first four
principal arguments can also be used as arguments in most high-level
plotting functions.  They must be of type <code><a href="base.html#topic+character">character</a></code> or
<code><a href="base.html#topic+expression">expression</a></code>. In the latter case, quite a bit of
mathematical notation is available such as sub- and superscripts,
Greek letters, fractions, etc: see <a href="grDevices.html#topic+plotmath">plotmath</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>title(main = NULL, sub = NULL, xlab = NULL, ylab = NULL,
      line = NA, outer = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="title_+3A_main">main</code></td>
<td>
<p>The main title (on top) using font, size (character
expansion) and color <code>par(c("font.main", "cex.main", "col.main"))</code>.</p>
</td></tr>
<tr><td><code id="title_+3A_sub">sub</code></td>
<td>
<p>Sub-title (at bottom) using font, size and color 
<code>par(c("font.sub", "cex.sub", "col.sub"))</code>.</p>
</td></tr>
<tr><td><code id="title_+3A_xlab">xlab</code></td>
<td>
<p>X axis label using font, size and color 
<code>par(c("font.lab", "cex.lab", "col.lab"))</code>.</p>
</td></tr>
<tr><td><code id="title_+3A_ylab">ylab</code></td>
<td>
<p>Y axis label, same font attributes as <code>xlab</code>.</p>
</td></tr>
<tr><td><code id="title_+3A_line">line</code></td>
<td>
<p>specifying a value for <code>line</code> overrides the
default placement of labels, and places them this many lines
outwards from the plot edge.</p>
</td></tr>
<tr><td><code id="title_+3A_outer">outer</code></td>
<td>
<p>a logical value.  If <code>TRUE</code>, the titles are
placed in the outer margins of the plot.</p>
</td></tr>
<tr><td><code id="title_+3A_...">...</code></td>
<td>
<p>further <a href="#topic+graphical+20parameters">graphical parameters</a> from <code><a href="#topic+par">par</a></code>.  Use
e.g., <code>col.main</code> or <code>cex.sub</code> instead of just <code>col</code>
or <code>cex</code>.  <code>adj</code> controls the justification of the titles.
<code>xpd</code> can be used to set the clipping region:
this defaults to the figure region unless <code>outer = TRUE</code>,
otherwise the device region and can only be increased.  <code>mgp</code>
controls the default placing of the axis titles.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The labels passed to <code>title</code> can be character strings or
language objects (names, calls or expressions), or a list
containing the string to be plotted, and a selection of the optional
modifying <a href="#topic+graphical+20parameters">graphical parameters</a> <code>cex=</code>, <code>col=</code> and
<code>font=</code>.  Other objects will be coerced by
<code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>.
</p>
<p>The position of <code>main</code> defaults to being vertically centered in
(outer) margin 3 and justified horizontally according to
<code>par("adj")</code> on the plot region (device region for
<code>outer = TRUE</code>).
</p>
<p>The positions of <code>xlab</code>, <code>ylab</code> and <code>sub</code> are
<code>line</code> (default for <code>xlab</code> and <code>ylab</code> being
<code>par("mgp")[1]</code> and increased by <code>1</code> for <code>sub</code>) lines
(of height <code>par("mex")</code>) into the appropriate margin, justified
in the text direction according to <code>par("adj")</code> on the
plot/device region.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
<em>The New S Language</em>.
Wadsworth &amp; Brooks/Cole.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtext">mtext</a></code>, <code><a href="#topic+text">text</a></code>;
<code><a href="grDevices.html#topic+plotmath">plotmath</a></code> for details on mathematical annotation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(cars, main = "") # here, could use main directly
title(main = "Stopping Distance versus Speed")

plot(cars, main = "")
title(main = list("Stopping Distance versus Speed", cex = 1.5,
                  col = "red", font = 3))

## Specifying "..." :
plot(1, col.axis = "sky blue", col.lab = "thistle")
title("Main Title", sub = "subtitle",
      cex.main = 2,   font.main= 4, col.main= "blue",
      cex.sub = 0.75, font.sub = 3, col.sub = "red")


x &lt;- seq(-4, 4, length.out = 101)
y &lt;- cbind(sin(x), cos(x))
matplot(x, y, type = "l", xaxt = "n",
        main = expression(paste(plain(sin) * phi, "  and  ",
                                plain(cos) * phi)),
        ylab = expression("sin" * phi, "cos" * phi), # only 1st is taken
        xlab = expression(paste("Phase Angle ", phi)),
        col.main = "blue")
axis(1, at = c(-pi, -pi/2, 0, pi/2, pi),
     labels = expression(-pi, -pi/2, 0, pi/2, pi))
abline(h = 0, v = pi/2 * c(-1,1), lty = 2, lwd = .1, col = "gray70")
</code></pre>

<hr>
<h2 id='units'>Graphical Units</h2><span id='topic+xinch'></span><span id='topic+yinch'></span><span id='topic+xyinch'></span>

<h3>Description</h3>

<p><code>xinch</code> and <code>yinch</code> convert the specified number of inches
given as their arguments into the correct units for plotting with
graphics functions.  Usually, this only makes sense when normal
coordinates are used, i.e., <em>no</em> <code>log</code> scale (see the
<code>log</code> argument to <code><a href="#topic+par">par</a></code>).
</p>
<p><code>xyinch</code> does the same for a pair of numbers <code>xy</code>,
simultaneously.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xinch(x = 1, warn.log = TRUE)
yinch(y = 1, warn.log = TRUE)
xyinch(xy = 1, warn.log = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="units_+3A_x">x</code>, <code id="units_+3A_y">y</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="units_+3A_xy">xy</code></td>
<td>
<p>numeric of length 1 or 2.</p>
</td></tr>
<tr><td><code id="units_+3A_warn.log">warn.log</code></td>
<td>
<p>logical; if <code>TRUE</code>, a warning is printed in case
of active log scale.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>all(c(xinch(), yinch()) == xyinch()) # TRUE
xyinch()
xyinch #- to see that is really   delta{"usr"} / "pin"

## plot labels offset 0.12 inches to the right
## of plotted symbols in a plot
with(mtcars, {
    plot(mpg, disp, pch = 19, main = "Motor Trend Cars")
    text(mpg + xinch(0.12), disp, row.names(mtcars),
         adj = 0, cex = .7, col = "blue")
    })
</code></pre>

<hr>
<h2 id='xspline'>Draw an X-spline</h2><span id='topic+xspline'></span>

<h3>Description</h3>

<p>Draw an X-spline, a curve drawn relative to control points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xspline(x, y = NULL, shape = 0, open = TRUE, repEnds = TRUE,
        draw = TRUE, border = par("fg"), col = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xspline_+3A_x">x</code>, <code id="xspline_+3A_y">y</code></td>
<td>
<p>vectors containing the coordinates of the vertices
of the polygon. See <code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code> for alternatives.</p>
</td></tr>
<tr><td><code id="xspline_+3A_shape">shape</code></td>
<td>
<p>A numeric vector of values between -1 and 1, which
control the shape of the spline relative to the control points.</p>
</td></tr>
<tr><td><code id="xspline_+3A_open">open</code></td>
<td>
<p>A logical value indicating whether the spline is
an open or a closed shape.</p>
</td></tr>
<tr><td><code id="xspline_+3A_repends">repEnds</code></td>
<td>
<p>For open X-splines, a logical value indicating whether
the first and last control points should be replicated for drawing
the curve. Ignored for closed X-splines.</p>
</td></tr>
<tr><td><code id="xspline_+3A_draw">draw</code></td>
<td>
<p>logical: should the X-spline be drawn?  If false, a set of
line segments to draw the curve is returned, and nothing is drawn.</p>
</td></tr>
<tr><td><code id="xspline_+3A_border">border</code></td>
<td>
<p>the color to draw the curve.   Use <code>border = NA</code> to
omit borders.</p>
</td></tr>
<tr><td><code id="xspline_+3A_col">col</code></td>
<td>
<p>the color for filling the shape. The default,
<code>NA</code>, is to leave unfilled.</p>
</td></tr>
<tr><td><code id="xspline_+3A_...">...</code></td>
<td>
<p><a href="#topic+graphical+20parameters">graphical parameters</a> such as <code>lty</code>, <code>xpd</code>,
<code>lend</code>, <code>ljoin</code> and <code>lmitre</code> can be given as arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An X-spline is a line drawn relative to control points.  For each
control point, the line may pass through (interpolate) the control
point or it may only approach (approximate) the control point;  the
behaviour is determined by a shape parameter for each control point.
</p>
<p>If the shape parameter is greater than zero, the spline approximates
the control points (and is very similar to a cubic B-spline when the
shape is 1).  If the shape parameter is less than zero, the spline
interpolates the control points (and is very similar to a Catmull-Rom
spline when the shape is -1).  If the shape parameter is 0, the spline
forms a sharp corner at that control point.
</p>
<p>For open X-splines, the start and end control points must have a shape
of 0 (and non-zero values are silently converted to zero).
</p>
<p>For open X-splines, by default the start and end control points are
replicated before the curve is drawn.  A curve is drawn between
(interpolating or approximating) the second and third of each set of
four control points, so this default behaviour ensures that the
resulting curve starts at the first control point you have specified
and ends at the last control point.  The default behaviour can be
turned off via the <code>repEnds</code> argument.
</p>


<h3>Value</h3>

<p>If <code>draw = TRUE</code>, <code>NULL</code> otherwise a list with elements
<code>x</code> and <code>y</code> which could be passed to <code><a href="#topic+lines">lines</a></code>,
<code><a href="#topic+polygon">polygon</a></code> and so on.
</p>
<p>Invisible in both cases.
</p>


<h3>Note</h3>

<p>Two-dimensional splines need to be created in an isotropic coordinate
system.  Device coordinates are used (with an anisotropy correction if
needed.)
</p>


<h3>References</h3>

<p>Blanc, C. and Schlick, C. (1995),
<em>X-splines : A Spline Model Designed for the End User</em>,
in <em>Proceedings of SIGGRAPH 95</em>, pp. 377&ndash;386.
<a href="https://dept-info.labri.fr/~schlick/DOC/sig1.html">https://dept-info.labri.fr/~schlick/DOC/sig1.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+polygon">polygon</a></code>.
</p>
<p><code><a href="#topic+par">par</a></code> for how to specify colors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## based on examples in ?grid.xspline

xsplineTest &lt;- function(s, open = TRUE,
                        x = c(1,1,3,3)/4,
                        y = c(1,3,3,1)/4, ...) {
    plot(c(0,1), c(0,1), type = "n", axes = FALSE, xlab = "", ylab = "")
    points(x, y, pch = 19)
    xspline(x, y, s, open, ...)
    text(x+0.05*c(-1,-1,1,1), y+0.05*c(-1,1,1,-1), s)
}
op &lt;- par(mfrow = c(3,3), mar = rep(0,4), oma = c(0,0,2,0))
xsplineTest(c(0, -1, -1, 0))
xsplineTest(c(0, -1,  0, 0))
xsplineTest(c(0, -1,  1, 0))
xsplineTest(c(0,  0, -1, 0))
xsplineTest(c(0,  0,  0, 0))
xsplineTest(c(0,  0,  1, 0))
xsplineTest(c(0,  1, -1, 0))
xsplineTest(c(0,  1,  0, 0))
xsplineTest(c(0,  1,  1, 0))
title("Open X-splines", outer = TRUE)

par(mfrow = c(3,3), mar = rep(0,4), oma = c(0,0,2,0))
xsplineTest(c(0, -1, -1, 0), FALSE, col = "grey80")
xsplineTest(c(0, -1,  0, 0), FALSE, col = "grey80")
xsplineTest(c(0, -1,  1, 0), FALSE, col = "grey80")
xsplineTest(c(0,  0, -1, 0), FALSE, col = "grey80")
xsplineTest(c(0,  0,  0, 0), FALSE, col = "grey80")
xsplineTest(c(0,  0,  1, 0), FALSE, col = "grey80")
xsplineTest(c(0,  1, -1, 0), FALSE, col = "grey80")
xsplineTest(c(0,  1,  0, 0), FALSE, col = "grey80")
xsplineTest(c(0,  1,  1, 0), FALSE, col = "grey80")
title("Closed X-splines", outer = TRUE)

par(op)

x &lt;- sort(stats::rnorm(5))
y &lt;- sort(stats::rnorm(5))
plot(x, y, pch = 19)
res &lt;- xspline(x, y, 1, draw = FALSE)
lines(res)
## the end points may be very close together,
## so use last few for direction
nr &lt;- length(res$x)
arrows(res$x[1], res$y[1], res$x[4], res$y[4], code = 1, length = 0.1)
arrows(res$x[nr-3], res$y[nr-3], res$x[nr], res$y[nr], code = 2, length = 0.1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
