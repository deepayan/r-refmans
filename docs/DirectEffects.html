<!DOCTYPE html><html lang="en"><head><title>Help for package DirectEffects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DirectEffects}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#balance_table'><p>Balance diagnostics telescope matching</p></a></li>
<li><a href='#balance.tmatch'><p>Balance diagnostics for Telescope Match objects</p></a></li>
<li><a href='#boots_g'><p>Coefficient Estimates across Bootstrapped Samples</p></a></li>
<li><a href='#boots_tm'><p>Bootstrap Uncertainty Estimates for Telescope Matching</p></a></li>
<li><a href='#cde_aipw'><p>Initialize an AIPW CDE estimator</p></a></li>
<li><a href='#cde_did_aipw'><p>Initialize an AIPW DID-CDE estimator</p></a></li>
<li><a href='#cde_ipw'><p>Initialize an IPW CDE estimator</p></a></li>
<li><a href='#cde_reg_impute'><p>Initialize an regression imputation CDE estimator</p></a></li>
<li><a href='#cde_telescope_match'><p>Initialize an telescope matching CDE estimator</p></a></li>
<li><a href='#cdesens'><p>Estimate sensitivity of ACDE estimates under varying levels of unobserved confounding</p></a></li>
<li><a href='#civilwar'><p>Data on civil wars and internal conflict from 1945-1999.</p></a></li>
<li><a href='#estimate'><p>Fit a specified CDE estimator</p></a></li>
<li><a href='#jobcorps'><p>Data on health and employment outcomes measured as part of the</p>
U.S. Job Corps employment training experiment.</a></li>
<li><a href='#outreg_model'><p>Specify the outcome regression model for a CDE treatment</p></a></li>
<li><a href='#plot.cdesens'><p>Plot output from cdesens</p></a></li>
<li><a href='#plotDiag.tmatch'><p>Histograms of matching weights</p></a></li>
<li><a href='#ploughs'><p>Data on historical plough use and the socioeconomic status of</p>
women.</a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#seq_g_vcov'><p>Consistent Variance estimator</p></a></li>
<li><a href='#sequential_g'><p>Perform linear sequential g-estimation to estimate the controlled</p>
direct effect of a treatment net the effect of a mediator.</a></li>
<li><a href='#set_treatment'><p>Specifiy a treatment variable for a controlled direct effect</p></a></li>
<li><a href='#summary.seqg'><p>Computes standard errors and p-values of DirectEffects estimates</p></a></li>
<li><a href='#summary.seqgboots'><p>Summary of DirectEffect Bootstrap Estimates</p></a></li>
<li><a href='#summary.tmatch'><p>Summarize telescope match objects</p></a></li>
<li><a href='#telescope_match'><p>Perform telescope matching to estimate the controlled</p>
direct effect of a binary treatment net the effect of binary
mediators</a></li>
<li><a href='#transphobia'><p>Data from a randomized experiment on transgender rights.</p></a></li>
<li><a href='#treat_model'><p>Specify the propensity score model for a CDE treatment</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating Controlled Direct Effects for Explaining Causal
Findings</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, Formula, glue, Matching, generics, rlang, broom</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, dplyr, tidyverse, ggplot2, reshape2,
scales, testthat, nnet, glmnet, hdm, ranger</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of functions to estimate the controlled direct effect of treatment fixing a potential mediator to a specific value. Implements the sequential g-estimation estimator described in Vansteelandt (2009) &lt;<a href="https://doi.org/10.1097%2FEDE.0b013e3181b6f4c9">doi:10.1097/EDE.0b013e3181b6f4c9</a>&gt; and Acharya, Blackwell, and Sen (2016) &lt;<a href="https://doi.org/10.1017%2FS0003055416000216">doi:10.1017/S0003055416000216</a>&gt; and the telescope matching estimator described in Blackwell and Strezhnev (2020) &lt;<a href="https://doi.org/10.1111%2Frssa.12759">doi:10.1111/rssa.12759</a>&gt;.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mattblackwell.github.io/DirectEffects/">https://mattblackwell.github.io/DirectEffects/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mattblackwell/DirectEffects/issues">https://github.com/mattblackwell/DirectEffects/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-02 00:55:14 UTC; mblackwell</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew Blackwell <a href="https://orcid.org/0000-0002-3689-9527"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Avidit Acharya [aut],
  Maya Sen [aut],
  Shiro Kuriwaki [aut],
  Jacob Brown [aut],
  Anton Strezhnev [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew Blackwell &lt;mblackwell@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-04 15:50:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='balance_table'>Balance diagnostics telescope matching</h2><span id='topic+balance_table'></span>

<h3>Description</h3>

<p>Provides matching balance diagnostics for telescope matching CDE
estimators
</p>


<h3>Usage</h3>

<pre><code class='language-R'>balance_table(object, vars, data, comparison = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="balance_table_+3A_object">object</code></td>
<td>
<p>output from an estimated <code>cde_telescope_match</code>
estimator</p>
</td></tr>
<tr><td><code id="balance_table_+3A_vars">vars</code></td>
<td>
<p>a formula object containing either the treatment or the
mediator as the dependent variable (which denotes whether
first-stage or second-stage balance diagnostics are returned) and
the covariates for which balance diagnostics are requested as the
independent variables. Each covariate or function of covariates
(e.g. higher-order polynomials or interactions) should be
separated by a +.</p>
</td></tr>
<tr><td><code id="balance_table_+3A_data">data</code></td>
<td>
<p>the data frame used in the call to
<code>estimate</code> on the <code>cde_telescope_match</code> object.</p>
</td></tr>
<tr><td><code id="balance_table_+3A_comparison">comparison</code></td>
<td>
<p>a binary indicator for if the function should
return the balance for the treated group ('1'), for the control
group ('0'), or for overall combined balanced ('NULL', the
default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame with the following columns.
</p>

<ul>
<li><p> variable: Name of covariate
</p>
</li>
<li><p> before_0: Pre-matching average of the covariate in the
mediator == 0 (if first stage balance) or treatment == 0 (if second
stage balance) condition
</p>
</li>
<li><p> before_1: Pre-matching average of the covariate in the
mediator == 1 (if first stage balance) or treatment == 1 (if second
stage balance) condition
</p>
</li>
<li><p> after_0: Post-matching average of the covariate in the
mediator == 0 (if first stage balance) or treatment == 0 (if second
stage balance) condition
</p>
</li>
<li><p> after_1: Post-matching average of the covariate in the
mediator == 1 (if first stage balance) or treatment == 1 (if second
stage balance) condition
</p>
</li>
<li><p> before_sd: standard deviation of the outcome (pre-Matching)
</p>
</li>
<li><p> before_diff: Pre-matching covariate difference between
mediator arms (if first stage balance) or treatment arms (if second
stage balance).
</p>
</li>
<li><p> before_std_diff: Pre-matching standardized covariate
difference between mediator arms (if first stage balance) or
treatment arms (if second stage balance), Equal to Before_Diff/SD.
</p>
</li>
<li><p> after_diff: Post&ndash;matching covariate difference between
mediator arms (if first stage balance) or treatment arms (if second
stage balance).
</p>
</li>
<li><p> after_std_diff: Post-matching standardized covariate
difference between mediator arms (if first stage balance) or
treatment arms (if second stage balance), Equal to Before_Diff/SD.
</p>
</li></ul>


<hr>
<h2 id='balance.tmatch'>Balance diagnostics for Telescope Match objects</h2><span id='topic+balance.tmatch'></span>

<h3>Description</h3>

<p>Balance diagnostics for Telescope Match objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>balance.tmatch(object, vars, data, comparison = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="balance.tmatch_+3A_object">object</code></td>
<td>
<p>an object of class <code>tmatch</code> &ndash; results from a
call to <code>telescope_match</code></p>
</td></tr>
<tr><td><code id="balance.tmatch_+3A_vars">vars</code></td>
<td>
<p>a formula object containing either the treatment or the
mediator as the dependent variable (which denotes whether
first-stage or second-stage balance diagnostics are returned) and
the covariates for which balance diagnostics are requested as the
independent variables. Each covariate or function of covariates
(e.g. higher-order polynomials or interactions) should be
separated by a +.</p>
</td></tr>
<tr><td><code id="balance.tmatch_+3A_data">data</code></td>
<td>
<p>the data frame used in the call to
<code>telescope_match</code></p>
</td></tr>
<tr><td><code id="balance.tmatch_+3A_comparison">comparison</code></td>
<td>
<p>a binary indicator for if the function should
return the balance for the treated group ('1'), for the control
group ('0'), or for overall combined balanced ('NULL', the
default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provides matching balance diagnostics for <code>tmatch</code>
objects returned by <code>telescope_match</code>
</p>


<h3>Value</h3>

<p>Returns a data frame with the following columns.
</p>

<ul>
<li><p> variable: Name of covariate
</p>
</li>
<li><p> before_0: Pre-matching average of the covariate in the
mediator == 0 (if first stage balance) or treatment == 0 (if second
stage balance) condition
</p>
</li>
<li><p> before_1: Pre-matching average of the covariate in the
mediator == 1 (if first stage balance) or treatment == 1 (if second
stage balance) condition
</p>
</li>
<li><p> after_0: Post-matching average of the covariate in the
mediator == 0 (if first stage balance) or treatment == 0 (if second
stage balance) condition
</p>
</li>
<li><p> after_1: Post-matching average of the covariate in the
mediator == 1 (if first stage balance) or treatment == 1 (if second
stage balance) condition
</p>
</li>
<li><p> before_sd: standard deviation of the outcome (pre-Matching)
</p>
</li>
<li><p> before_diff: Pre-matching covariate difference between
mediator arms (if first stage balance) or treatment arms (if second
stage balance).
</p>
</li>
<li><p> before_std_diff: Pre-matching standardized covariate
difference between mediator arms (if first stage balance) or
treatment arms (if second stage balance), Equal to Before_Diff/SD.
</p>
</li>
<li><p> after_diff: Post&ndash;matching covariate difference between
mediator arms (if first stage balance) or treatment arms (if second
stage balance).
</p>
</li>
<li><p> after_std_diff: Post-matching standardized covariate
difference between mediator arms (if first stage balance) or
treatment arms (if second stage balance), Equal to Before_Diff/SD.
</p>
</li></ul>


<hr>
<h2 id='boots_g'>Coefficient Estimates across Bootstrapped Samples</h2><span id='topic+boots_g'></span>

<h3>Description</h3>

<p>Performs a simple bootstrap of a fitted DirectEffects model by re-estimating
the model with bootstrap samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boots_g(seqg, boots = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boots_g_+3A_seqg">seqg</code></td>
<td>
<p>A fitted sequential_g estimate, computed by <code><a href="#topic+sequential_g">sequential_g</a></code>.</p>
</td></tr>
<tr><td><code id="boots_g_+3A_boots">boots</code></td>
<td>
<p>The number of bootstrap replicates. Defaults to 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of type <code>seqgboots</code> which is a matrix with <code>boots</code>
rows and columns for each coefficient in the <code>seqg</code> model. Use <code>summary</code> 
to provide summary statistics, such as mean and quantiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ploughs)
s1 &lt;- sequential_g(women_politics ~ plow +
 agricultural_suitability + tropical_climate + large_animals + rugged |
 years_civil_conflict + years_interstate_conflict  + oil_pc +
 european_descent + communist_dummy + polity2_2000 |
 centered_ln_inc + centered_ln_incsq, ploughs)

out.boots &lt;- boots_g(s1, boots = 100)

summary(out.boots)

</code></pre>

<hr>
<h2 id='boots_tm'>Bootstrap Uncertainty Estimates for Telescope Matching</h2><span id='topic+boots_tm'></span>

<h3>Description</h3>

<p>Performs a weighted bootstrap procedure for the output of
<code><a href="#topic+telescope_match">telescope_match</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boots_tm(obj, boots = 1000, ci_alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boots_tm_+3A_obj">obj</code></td>
<td>
<p>A <code>tmatch</code> object, computed by <code><a href="#topic+telescope_match">telescope_match</a></code>.</p>
</td></tr>
<tr><td><code id="boots_tm_+3A_boots">boots</code></td>
<td>
<p>The number of bootstrap replicates. Defaults to 1000.</p>
</td></tr>
<tr><td><code id="boots_tm_+3A_ci_alpha">ci_alpha</code></td>
<td>
<p>alpha value for the bootstrapped confidence
intervals. Corresponds to a 100 * (1-alpha) confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An data.frame with columns 'ci_low' and 'ci_high' which
contain the bootstrapped confidence intervals for the estimated
ACDEs in <code>obj$tau</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(jobcorps)

## Split male/female
jobcorps_female &lt;- subset(jobcorps, female == 1)

## Telescope matching formula - First stage (X and Z)
tm_form &lt;- exhealth30 ~  schobef + trainyrbef + jobeverbef  |
treat | emplq4 + emplq4full | work2year2q


### Estimate ACDE for women holding employment at 0
tm_out &lt;-  telescope_match(
  tm_form,
  data = jobcorps_female,
  L = 3,
  boot = FALSE,
  verbose = TRUE
)

out.boots &lt;- boots_tm(tm_out)

out.boots

</code></pre>

<hr>
<h2 id='cde_aipw'>Initialize an AIPW CDE estimator</h2><span id='topic+cde_aipw'></span>

<h3>Description</h3>

<p>Initializes the specification of a CDE estimator based on an
augmented inverse probability weighting approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cde_aipw(trim = c(0.01, 0.99), aipw_blip = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cde_aipw_+3A_trim">trim</code></td>
<td>
<p>A vector of length 2 indicating what quantiles of the
propensity scores should be trimmed. By default this is <code>c(0.01, 0.99)</code> meaning that the top and bottom 1% of propensity scores are
trunctated to these quantiles. If NULL, no trimming occurs.</p>
</td></tr>
<tr><td><code id="cde_aipw_+3A_aipw_blip">aipw_blip</code></td>
<td>
<p>If <code>TRUE</code> (the default), augmented inverse probability weighting
estimators will be used to estimate intermediate outcome
regressions (blip functions).</p>
</td></tr>
</table>

<hr>
<h2 id='cde_did_aipw'>Initialize an AIPW DID-CDE estimator</h2><span id='topic+cde_did_aipw'></span>

<h3>Description</h3>

<p>Initializes the specification of a difference-in-differences
estimator for the CDE based on an augmented inverse probability
weighting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cde_did_aipw(
  base_mediator,
  trim = c(0.01, 0.99),
  aipw_blip = TRUE,
  on_treated = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cde_did_aipw_+3A_base_mediator">base_mediator</code></td>
<td>
<p>The (unquoted) name of the variable that
measures the mediator at baseline.</p>
</td></tr>
<tr><td><code id="cde_did_aipw_+3A_trim">trim</code></td>
<td>
<p>A vector of length 2 indicating what quantiles of the
propensity scores should be trimmed. By default this is <code>c(0.01, 0.99)</code> meaning that the top and bottom 1% of propensity scores are
trunctated to these quantiles. If NULL, no trimming occurs.</p>
</td></tr>
<tr><td><code id="cde_did_aipw_+3A_aipw_blip">aipw_blip</code></td>
<td>
<p>If <code>TRUE</code> (the default), augmented inverse probability weighting
estimators will be used to estimate intermediate outcome
regressions (blip functions).</p>
</td></tr>
<tr><td><code id="cde_did_aipw_+3A_on_treated">on_treated</code></td>
<td>
<p>If <code>FALSE</code> (the defafult), the effects are
average effects conditional on the levels of the baseline mediator.
If <code>TRUE</code>, the effects are conditional on the treated path. For
difference in identficiation, see Details below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function, unlike other CDE estimators in the package, only
returns the estimated effects of the first treatment variable.
These effects are conditional on the baseline value of the mediator
(<code>base_mediator</code>) when <code>on_treated</code> is <code>TRUE</code>. A marginalized CDE
estimand is also estimated. When <code>on_treated</code> is <code>FALSE</code>, these
estimates are conditional on the entire &quot;treated&quot; history.
Identification  requirements are slightly different between these
two cases. When <code>on_treated</code> is <code>FALSE</code>, the confounders for the
mediator cannot be affected by treatment. See Blackwell et al
(2022) for more information.
</p>

<hr>
<h2 id='cde_ipw'>Initialize an IPW CDE estimator</h2><span id='topic+cde_ipw'></span>

<h3>Description</h3>

<p>Initializes the specification of a CDE estimator based on an
inverse probability weighting approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cde_ipw(hajek = TRUE, trim = c(0.01, 0.99))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cde_ipw_+3A_hajek">hajek</code></td>
<td>
<p>If <code>TRUE</code>, normalized weights will be used as in the
Hajek estimator. If <code>FALSE</code>, traditional IPW weights will be used.</p>
</td></tr>
<tr><td><code id="cde_ipw_+3A_trim">trim</code></td>
<td>
<p>A vector of length 2 indicating what quantiles of the
propensity scores should be trimmed. By default this is <code>c(0.01, 0.99)</code> meaning that the top and bottom 1% of propensity scores are
trunctated to these quantiles. If NULL, no trimming occurs.</p>
</td></tr>
</table>

<hr>
<h2 id='cde_reg_impute'>Initialize an regression imputation CDE estimator</h2><span id='topic+cde_reg_impute'></span>

<h3>Description</h3>

<p>Initializes the specification of a CDE estimator based on an
regression imputation approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cde_reg_impute(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cde_reg_impute_+3A_...">...</code></td>
<td>
<p>Optional arguments to pass to the regression imputation
estimator.</p>
</td></tr>
</table>

<hr>
<h2 id='cde_telescope_match'>Initialize an telescope matching CDE estimator</h2><span id='topic+cde_telescope_match'></span>

<h3>Description</h3>

<p>Initializes the specification of a CDE estimator based on an
telescope matching approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cde_telescope_match(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cde_telescope_match_+3A_...">...</code></td>
<td>
<p>Optional arguments to pass to the telescope matching
estimator.</p>
</td></tr>
</table>

<hr>
<h2 id='cdesens'>Estimate sensitivity of ACDE estimates under varying levels of unobserved confounding</h2><span id='topic+cdesens'></span>

<h3>Description</h3>

<p>Estimate how the Average Controlled Direct Effect varies by various levels of
unobserved confounding. For each value of unmeasured confounding, summarized as
a correlation between residuals, <span class="env">cdesens</span> computes the ACDE. Standard
errors are computed by a simple bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdesens(
  seqg,
  var,
  rho = seq(-0.9, 0.9, by = 0.05),
  bootstrap = c("none", "standard"),
  boots_n = 1000,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cdesens_+3A_seqg">seqg</code></td>
<td>
<p>Output from sequential_g. The function only supports specifications with one
mediator variable.</p>
</td></tr>
<tr><td><code id="cdesens_+3A_var">var</code></td>
<td>
<p>A character indicating the name of the variable for
which the estimated ACDE is being evaluated.</p>
</td></tr>
<tr><td><code id="cdesens_+3A_rho">rho</code></td>
<td>
<p>A numerical vector of correlations between errors to test for. The
original model assumes <span class="env">rho = 0</span></p>
</td></tr>
<tr><td><code id="cdesens_+3A_bootstrap">bootstrap</code></td>
<td>
<p>character of c(&quot;none&quot;, &quot;standard&quot;), indicating whether to
include bootstrap standard errors. Default is &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="cdesens_+3A_boots_n">boots_n</code></td>
<td>
<p>Number of bootstrap replicates, defaults to 100.</p>
</td></tr>
<tr><td><code id="cdesens_+3A_verbose">verbose</code></td>
<td>
<p>Whether to show progress and messages, defaults to
<span class="env">FALSE</span></p>
</td></tr>
<tr><td><code id="cdesens_+3A_...">...</code></td>
<td>
<p>Other parameters to pass on to <span class="env">lm.fit()</span> when
refitting the model</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(civilwar)


# main formula: Y ~ A + X | Z | M
form_main &lt;- onset ~ ethfrac + lmtnest + ncontig + Oil | warl +
  gdpenl + lpop + polity2l + relfrac | instab

# estimate CDE
direct &lt;- sequential_g(form_main, data = civilwar)

# sensitivity
out_sens &lt;- cdesens(direct, var = "ethfrac")

# plot sensitivity
plot(out_sens)

</code></pre>

<hr>
<h2 id='civilwar'>Data on civil wars and internal conflict from 1945-1999.</h2><span id='topic+civilwar'></span>

<h3>Description</h3>

<p>A dataset to replicate the analysis in Fearon and Laitin
(2003).
</p>
<p>A dataset to replicate the analysis in Fearon and Laitin
(2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(civilwar)

data(civilwar)
</code></pre>


<h3>Format</h3>

<p>A data frame with 6610 observations and 69 variables.
</p>
<p>A data frame with 6610 observations and 69 variables.
</p>


<h3>Details</h3>


<ul>
<li><p> ccode. COW country id number
</p>
</li>
<li><p> country. country name
</p>
</li>
<li><p> cname. abbreviated country name
</p>
</li>
<li><p> cmark. 1 for first in each country series
</p>
</li>
<li><p> year. start year of war/conflict
</p>
</li>
<li><p> wars. number wars in progress in country year
</p>
</li>
<li><p> war. 1 if war ongoing in country year
</p>
</li>
<li><p> warl. lagged war, w/ 0 for start of country series
</p>
</li>
<li><p> onset. 1 for civil war onset
</p>
</li>
<li><p> ethonset. 1 if onset = 1 &amp; ethwar ~= 0
</p>
</li>
<li><p> durest. estimated war duration
</p>
</li>
<li><p> aim. 1 = rebels aim at center, 3 = aim at exit or autonomy, 2 = mixed or ambig.
</p>
</li>
<li><p> casename. Id for case, usually name of rebel group(s)
</p>
</li>
<li><p> ended. war ends = 1, 0 = ongoing
</p>
</li>
<li><p> ethwar. 0 = not ethnic, 1 = ambig/mixed, 2 = ethnic
</p>
</li>
<li><p> waryrs. war years for each onset
</p>
</li>
<li><p> pop. population, in 1000s
</p>
</li>
<li><p> lpop. log of pop
</p>
</li>
<li><p> polity2. revised polity score
</p>
</li>
<li><p> gdpen. gdp/pop based on pwt5.6, wdi2001,cow energy data
</p>
</li>
<li><p> gdptype. source/type of gdp/pop estimate
</p>
</li>
<li><p> gdpenl. lagged gdpenl, except for first in country series
</p>
</li>
<li><p> lgdpenl1. log of lagged gdpen
</p>
</li>
<li><p> lpopl1. log population, lagged except for first in country series
</p>
</li>
<li><p> region. country's region, based on MAR project
</p>
</li>
<li><p> western. Dummy for Western Democracies &amp; Japan
</p>
</li>
<li><p> eeurop. Dummy for Eastern Europe
</p>
</li>
<li><p> lamerica. Dummy for Latin America
</p>
</li>
<li><p> ssafrica. Dummy for Sub-Saharan Africa
</p>
</li>
<li><p> asia. Dummy for Asia (not including Japan)
</p>
</li>
<li><p> nafrme. Dummy for North Africa/Middle East
</p>
</li>
<li><p> colbrit. Former British colony
</p>
</li>
<li><p> colfra. former French colony
</p>
</li>
<li><p> mtnest. Estimated percent mountainous terrain
</p>
</li>
<li><p> lmtnest. log of mtnest
</p>
</li>
<li><p> elevdiff. high - low elevation, in meters
</p>
</li>
<li><p> Oil. more than 1/3 export revenues from fuels
</p>
</li>
<li><p> ncontig. noncontiguous state
</p>
</li>
<li><p> ethfrac. ethnic frac. based on Soviet Atlas, plus estimates for missing in 1964
</p>
</li>
<li><p> ef. ethnic fractionalization based on Fearon 2002 APSA paper
</p>
</li>
<li><p> plural. share of largest ethnic group (Fearon 2002 APSA)
</p>
</li>
<li><p> second. share of 2nd largest ethnic group (Fearon 2002 APSA)
</p>
</li>
<li><p> numlang. number languages in Ethnologue &gt; min(1
</p>
</li>
<li><p> relfrac. religious fractionalization
</p>
</li>
<li><p> plurrel. size of largest confession
</p>
</li>
<li><p> minrelpc. size of second largest confession
</p>
</li>
<li><p> muslim. percent muslim
</p>
</li>
<li><p> nwstate. 1 in 1st 2 years of state's existence
</p>
</li>
<li><p> polity2l. lagged polity2, except 1st in country series
</p>
</li>
<li><p> instab. &gt; 2 change in Polity measure in last 3 yrs
</p>
</li>
<li><p> anocl. lagged anocracy (-6 &lt; polity2l &lt; 6)
</p>
</li>
<li><p> deml. lagged democracy (polity2l &gt; 5)
</p>
</li>
<li><p> empethfrac. ethfrac coded for colonial empires
</p>
</li>
<li><p> empwarl. warl coded for data with empires
</p>
</li>
<li><p> emponset. onset coded for data with empires
</p>
</li>
<li><p> empgdpenl. gdpenl coded for empires data
</p>
</li>
<li><p> emplpopl. lpopl coded for empires data
</p>
</li>
<li><p> emplmtnest. lmtnest coded for empires data
</p>
</li>
<li><p> empncontig. ncontig coded for empires
</p>
</li>
<li><p> empolity2l. polity2l adjusted for empires (see fn38 in paper)
</p>
</li>
<li><p> sdwars. number Sambanis/Doyle civ wars in progress
</p>
</li>
<li><p> sdonset. onset of Sambanis/Doyle war
</p>
</li>
<li><p> colwars. number Collier/Hoeffler wars in progress
</p>
</li>
<li><p> colonset. onset of Collier/Hoeffler war
</p>
</li>
<li><p> cowwars. number COW civ wars in progress
</p>
</li>
<li><p> cowonset. onset of COW civ war
</p>
</li>
<li><p> cowwarl. 1 if COW war ongoing in last period
</p>
</li>
<li><p> sdwarl. 1 if S/D war ongoing in last period
</p>
</li>
<li><p> colwarl. 1 if C/H war ongoing in last period
</p>
</li></ul>


<ul>
<li><p> ccode. COW country id number
</p>
</li>
<li><p> country. country name
</p>
</li>
<li><p> cname. abbreviated country name
</p>
</li>
<li><p> cmark. 1 for first in each country series
</p>
</li>
<li><p> year. start year of war/conflict
</p>
</li>
<li><p> wars. number wars in progress in country year
</p>
</li>
<li><p> war. 1 if war ongoing in country year
</p>
</li>
<li><p> warl. lagged war, w/ 0 for start of country series
</p>
</li>
<li><p> onset. 1 for civil war onset
</p>
</li>
<li><p> ethonset. 1 if onset = 1 &amp; ethwar ~= 0
</p>
</li>
<li><p> durest. estimated war duration
</p>
</li>
<li><p> aim. 1 = rebels aim at center, 3 = aim at exit or autonomy, 2 = mixed or ambig.
</p>
</li>
<li><p> casename. Id for case, usually name of rebel group(s)
</p>
</li>
<li><p> ended. war ends = 1, 0 = ongoing
</p>
</li>
<li><p> ethwar. 0 = not ethnic, 1 = ambig/mixed, 2 = ethnic
</p>
</li>
<li><p> waryrs. war years for each onset
</p>
</li>
<li><p> pop. population, in 1000s
</p>
</li>
<li><p> lpop. log of pop
</p>
</li>
<li><p> polity2. revised polity score
</p>
</li>
<li><p> gdpen. gdp/pop based on pwt5.6, wdi2001,cow energy data
</p>
</li>
<li><p> gdptype. source/type of gdp/pop estimate
</p>
</li>
<li><p> gdpenl. lagged gdpenl, except for first in country series
</p>
</li>
<li><p> lgdpenl1. log of lagged gdpen
</p>
</li>
<li><p> lpopl1. log population, lagged except for first in country series
</p>
</li>
<li><p> region. country's region, based on MAR project
</p>
</li>
<li><p> western. Dummy for Western Democracies &amp; Japan
</p>
</li>
<li><p> eeurop. Dummy for Eastern Europe
</p>
</li>
<li><p> lamerica. Dummy for Latin America
</p>
</li>
<li><p> ssafrica. Dummy for Sub-Saharan Africa
</p>
</li>
<li><p> asia. Dummy for Asia (not including Japan)
</p>
</li>
<li><p> nafrme. Dummy for North Africa/Middle East
</p>
</li>
<li><p> colbrit. Former British colony
</p>
</li>
<li><p> colfra. former French colony
</p>
</li>
<li><p> mtnest. Estimated percent mountainous terrain
</p>
</li>
<li><p> lmtnest. log of mtnest
</p>
</li>
<li><p> elevdiff. high - low elevation, in meters
</p>
</li>
<li><p> Oil. more than 1/3 export revenues from fuels
</p>
</li>
<li><p> ncontig. noncontiguous state
</p>
</li>
<li><p> ethfrac. ethnic frac. based on Soviet Atlas, plus estimates for missing in 1964
</p>
</li>
<li><p> ef. ethnic fractionalization based on Fearon 2002 APSA paper
</p>
</li>
<li><p> plural. share of largest ethnic group (Fearon 2002 APSA)
</p>
</li>
<li><p> second. share of 2nd largest ethnic group (Fearon 2002 APSA)
</p>
</li>
<li><p> numlang. number languages in Ethnologue &gt; min(1
</p>
</li>
<li><p> relfrac. religious fractionalization
</p>
</li>
<li><p> plurrel. size of largest confession
</p>
</li>
<li><p> minrelpc. size of second largest confession
</p>
</li>
<li><p> muslim. percent muslim
</p>
</li>
<li><p> nwstate. 1 in 1st 2 years of state's existence
</p>
</li>
<li><p> polity2l. lagged polity2, except 1st in country series
</p>
</li>
<li><p> instab. &gt; 2 change in Polity measure in last 3 yrs
</p>
</li>
<li><p> anocl. lagged anocracy (-6 &lt; polity2l &lt; 6)
</p>
</li>
<li><p> deml. lagged democracy (polity2l &gt; 5)
</p>
</li>
<li><p> empethfrac. ethfrac coded for colonial empires
</p>
</li>
<li><p> empwarl. warl coded for data with empires
</p>
</li>
<li><p> emponset. onset coded for data with empires
</p>
</li>
<li><p> empgdpenl. gdpenl coded for empires data
</p>
</li>
<li><p> emplpopl. lpopl coded for empires data
</p>
</li>
<li><p> emplmtnest. lmtnest coded for empires data
</p>
</li>
<li><p> empncontig. ncontig coded for empires
</p>
</li>
<li><p> empolity2l. polity2l adjusted for empires (see fn38 in paper)
</p>
</li>
<li><p> sdwars. number Sambanis/Doyle civ wars in progress
</p>
</li>
<li><p> sdonset. onset of Sambanis/Doyle war
</p>
</li>
<li><p> colwars. number Collier/Hoeffler wars in progress
</p>
</li>
<li><p> colonset. onset of Collier/Hoeffler war
</p>
</li>
<li><p> cowwars. number COW civ wars in progress
</p>
</li>
<li><p> cowonset. onset of COW civ war
</p>
</li>
<li><p> cowwarl. 1 if COW war ongoing in last period
</p>
</li>
<li><p> sdwarl. 1 if S/D war ongoing in last period
</p>
</li>
<li><p> colwarl. 1 if C/H war ongoing in last period
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://doi.org/10.1017/S0003055403000534">doi:10.1017/S0003055403000534</a>
</p>
<p><a href="https://doi.org/10.1017/S0003055403000534">doi:10.1017/S0003055403000534</a>
</p>


<h3>References</h3>

<p>Fearon, James D., and David A. Laitin (2003). Ethnicity, Insurgency, and Civil War.
American Political Science Review, 97(1), 75-90. <a href="https://doi.org/10.1017/S0003055403000534">doi:10.1017/S0003055403000534</a>
</p>
<p>Fearon, James D., and David A. Laitin (2003). Ethnicity, Insurgency, and Civil War.
American Political Science Review, 97(1), 75-90. <a href="https://doi.org/10.1017/S0003055403000534">doi:10.1017/S0003055403000534</a>
</p>

<hr>
<h2 id='estimate'>Fit a specified CDE estimator</h2><span id='topic+estimate'></span>

<h3>Description</h3>

<p>Fit a CDE estimator with the engines specified in the <code>model_spec</code>
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate(
  object,
  formula,
  data,
  subset,
  crossfit = TRUE,
  n_folds,
  n_splits = 1L
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_+3A_object">object</code></td>
<td>
<p>A <code>cde_estimator</code> object that has already been passed
to at least one call to <code>set_treatment</code>.</p>
</td></tr>
<tr><td><code id="estimate_+3A_formula">formula</code></td>
<td>
<p>A formula object with describing the outcome of
interest on the left-hand side and the treatment variables the user
wants to estimate effects for (which might be a subset of the
treatment variables specified).</p>
</td></tr>
<tr><td><code id="estimate_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> containing all variables, including
treatment variables and covariates specified.</p>
</td></tr>
<tr><td><code id="estimate_+3A_subset">subset</code></td>
<td>
<p>Anan optional vector specifying a subset of
observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="estimate_+3A_crossfit">crossfit</code></td>
<td>
<p>A logical indicator for if cross-fitting should be
used in estimating the effects.</p>
</td></tr>
<tr><td><code id="estimate_+3A_n_folds">n_folds</code></td>
<td>
<p>The number of folds to use within a given instance
of the cross-fitting algorithm.</p>
</td></tr>
<tr><td><code id="estimate_+3A_n_splits">n_splits</code></td>
<td>
<p>The number of times the cross-fitting procedure
should be repeated. Overall estimates use the median value of these
repeated estimates.</p>
</td></tr>
</table>

<hr>
<h2 id='jobcorps'>Data on health and employment outcomes measured as part of the
U.S. Job Corps employment training experiment.</h2><span id='topic+jobcorps'></span>

<h3>Description</h3>

<p>A dataset to replicate the analysis in Huber (2014).
</p>
<p>A dataset to replicate the analysis in Huber (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(jobcorps)

data(jobcorps)
</code></pre>


<h3>Format</h3>

<p>A data frame with 10025 observations and 62 variables.
</p>
<p>A data frame with 10025 observations and 62 variables.
</p>


<h3>Details</h3>


<ul>
<li><p> treat. 1 = in program group. 0 = in control group.
</p>
</li>
<li><p> schobef. &quot;in school 1yr before eligibility&quot;
</p>
</li>
<li><p> trainyrbef. &quot;training in year before Job Corps&quot;
</p>
</li>
<li><p> jobeverbef. &quot;ever had a job before Job Corps&quot;
</p>
</li>
<li><p> jobyrbef. &quot;job in year before job corps&quot;
</p>
</li>
<li><p> health012.  &quot;good or very good health at assignment&quot;
</p>
</li>
<li><p> health0mis.  &quot;general health at assignment missing&quot;
</p>
</li>
<li><p> pe_prb0.  &quot;physical/emotional problems at assignment&quot;
</p>
</li>
<li><p> pe_prb0mis. &quot;missing - physical/emotional problems at assignment&quot; 
</p>
</li>
<li><p> everalc. &quot;ever abused alcohol before assignment&quot;
</p>
</li>
<li><p> alc12. &quot;alcohol abuse one yr after assignment&quot;
</p>
</li>
<li><p> everilldrugs. &quot;ever took illegal drugs before assignment&quot;
</p>
</li>
<li><p> age_cat. &quot;age at application in years 16-24&quot;
</p>
</li>
<li><p> edumis. &quot;education missing&quot;
</p>
</li>
<li><p> eduhigh. &quot;higher education&quot;
</p>
</li>
<li><p> rwhite. &quot;white&quot;
</p>
</li>
<li><p> everarr. &quot;ever arrested before Job Corps&quot;
</p>
</li>
<li><p> hhsize. &quot;household size at assignment&quot;
</p>
</li>
<li><p> hhsizemis. &quot;household size at assignment missing&quot;
</p>
</li>
<li><p> hhinc12. &quot;low household income at assignment&quot;
</p>
</li>
<li><p> hhinc8. &quot;high household income at assignment&quot;
</p>
</li>
<li><p> fdstamp. &quot;received foodstamps in yr before assignment&quot;
</p>
</li>
<li><p> welf1. &quot;once on welfare while growing up&quot;
</p>
</li>
<li><p> welf2.  &quot;twice on welfare while growing up&quot;
</p>
</li>
<li><p> publicass. &quot;public assistance in yr before assignment&quot;
</p>
</li>
<li><p> emplq. &quot;worked some time 9-12 months after assignment&quot;
</p>
</li>
<li><p> emplq4full. &quot;worked all the time in 9-12 months after assignment&quot;
</p>
</li>
<li><p> pemplq4. &quot;proportion of weeks worked 9-12 months after assignment&quot;
</p>
</li>
<li><p> pemplq4mis. &quot;missing - proportion of weeks worked 9-12 months after assignment&quot;
</p>
</li>
<li><p> vocq4.  &quot;in vocational training 9-12 months after assignment&quot;
</p>
</li>
<li><p> vocq4mis. &quot;missing - in vocational training 9-12 months after assignment&quot;
</p>
</li>
<li><p> health1212. &quot;very good or good health 1 yr after assignment&quot;
</p>
</li>
<li><p> health123. &quot;fair health 1 yr after assignment&quot;
</p>
</li>
<li><p> pe_prb12. &quot;1=phys/emot probs at 12 mths 0=no prob&quot;
</p>
</li>
<li><p> pe_prb12mis. &quot;missing - physical/emotional problems 1 yr after assignment&quot;
</p>
</li>
<li><p> narry1. &quot;number of arrests in year 1&quot;
</p>
</li>
<li><p> numkidhhf1zero.  &quot;no own kids living in household 1 yr after assignment&quot;
</p>
</li>
<li><p> numkidhhf1onetwo. &quot;one or two own kids living in household 1 yr after assignment&quot;
</p>
</li>
<li><p> pubhse12.  &quot;1=in public housing 1 yr after assignment, 0=not in&quot;
</p>
</li>
<li><p> h_ins12a. &quot;afdc and other transfers one yr after assignment&quot;
</p>
</li>
<li><p> h_ins12amis.  &quot;missing - afdc and other transfers one yr after assignment&quot;
</p>
</li>
<li><p> ... other variables as annotated in the source.
</p>
</li></ul>


<ul>
<li><p> treat. 1 = in program group. 0 = in control group.
</p>
</li>
<li><p> schobef. &quot;in school 1yr before eligibility&quot;
</p>
</li>
<li><p> trainyrbef. &quot;training in year before Job Corps&quot;
</p>
</li>
<li><p> jobeverbef. &quot;ever had a job before Job Corps&quot;
</p>
</li>
<li><p> jobyrbef. &quot;job in year before job corps&quot;
</p>
</li>
<li><p> health012.  &quot;good or very good health at assignment&quot;
</p>
</li>
<li><p> health0mis.  &quot;general health at assignment missing&quot;
</p>
</li>
<li><p> pe_prb0.  &quot;physical/emotional problems at assignment&quot;
</p>
</li>
<li><p> pe_prb0mis. &quot;missing - physical/emotional problems at assignment&quot; 
</p>
</li>
<li><p> everalc. &quot;ever abused alcohol before assignment&quot;
</p>
</li>
<li><p> alc12. &quot;alcohol abuse one yr after assignment&quot;
</p>
</li>
<li><p> everilldrugs. &quot;ever took illegal drugs before assignment&quot;
</p>
</li>
<li><p> age_cat. &quot;age at application in years 16-24&quot;
</p>
</li>
<li><p> edumis. &quot;education missing&quot;
</p>
</li>
<li><p> eduhigh. &quot;higher education&quot;
</p>
</li>
<li><p> rwhite. &quot;white&quot;
</p>
</li>
<li><p> everarr. &quot;ever arrested before Job Corps&quot;
</p>
</li>
<li><p> hhsize. &quot;household size at assignment&quot;
</p>
</li>
<li><p> hhsizemis. &quot;household size at assignment missing&quot;
</p>
</li>
<li><p> hhinc12. &quot;low household income at assignment&quot;
</p>
</li>
<li><p> hhinc8. &quot;high household income at assignment&quot;
</p>
</li>
<li><p> fdstamp. &quot;received foodstamps in yr before assignment&quot;
</p>
</li>
<li><p> welf1. &quot;once on welfare while growing up&quot;
</p>
</li>
<li><p> welf2.  &quot;twice on welfare while growing up&quot;
</p>
</li>
<li><p> publicass. &quot;public assistance in yr before assignment&quot;
</p>
</li>
<li><p> emplq. &quot;worked some time 9-12 months after assignment&quot;
</p>
</li>
<li><p> emplq4full. &quot;worked all the time in 9-12 months after assignment&quot;
</p>
</li>
<li><p> pemplq4. &quot;proportion of weeks worked 9-12 months after assignment&quot;
</p>
</li>
<li><p> pemplq4mis. &quot;missing - proportion of weeks worked 9-12 months after assignment&quot;
</p>
</li>
<li><p> vocq4.  &quot;in vocational training 9-12 months after assignment&quot;
</p>
</li>
<li><p> vocq4mis. &quot;missing - in vocational training 9-12 months after assignment&quot;
</p>
</li>
<li><p> health1212. &quot;very good or good health 1 yr after assignment&quot;
</p>
</li>
<li><p> health123. &quot;fair health 1 yr after assignment&quot;
</p>
</li>
<li><p> pe_prb12. &quot;1=phys/emot probs at 12 mths 0=no prob&quot;
</p>
</li>
<li><p> pe_prb12mis. &quot;missing - physical/emotional problems 1 yr after assignment&quot;
</p>
</li>
<li><p> narry1. &quot;number of arrests in year 1&quot;
</p>
</li>
<li><p> numkidhhf1zero.  &quot;no own kids living in household 1 yr after assignment&quot;
</p>
</li>
<li><p> numkidhhf1onetwo. &quot;one or two own kids living in household 1 yr after assignment&quot;
</p>
</li>
<li><p> pubhse12.  &quot;1=in public housing 1 yr after assignment, 0=not in&quot;
</p>
</li>
<li><p> h_ins12a. &quot;afdc and other transfers one yr after assignment&quot;
</p>
</li>
<li><p> h_ins12amis.  &quot;missing - afdc and other transfers one yr after assignment&quot;
</p>
</li>
<li><p> ... other variables as annotated in the source.
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://doi.org/10.1002/jae.2341">doi:10.1002/jae.2341</a>
</p>
<p><a href="https://doi.org/10.1002/jae.2341">doi:10.1002/jae.2341</a>
</p>


<h3>References</h3>

<p>Huber, M. (2014). Identifying causal mechanisms 
(primarily) based on inverse probability weighting. Journal of 
Applied Econometrics, 29(6), 920-943. <a href="https://doi.org/10.1002/jae.2341">doi:10.1002/jae.2341</a>
</p>
<p>Huber, M. (2014). Identifying causal mechanisms 
(primarily) based on inverse probability weighting. Journal of 
Applied Econometrics, 29(6), 920-943. <a href="https://doi.org/10.1002/jae.2341">doi:10.1002/jae.2341</a>
</p>

<hr>
<h2 id='outreg_model'>Specify the outcome regression model for a CDE treatment</h2><span id='topic+outreg_model'></span>

<h3>Description</h3>

<p>Specifies the functional form and estimation engine for an outcome
regression of a treatment previously specified by
<code><a href="#topic+set_treatment">set_treatment()</a></code> and the past history of
covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outreg_model(
  object,
  formula,
  engine,
  separate = TRUE,
  include_past = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="outreg_model_+3A_object">object</code></td>
<td>
<p>A <code>cde_estimator</code> object that contains output from a
previous call to <code><a href="#topic+set_treatment">set_treatment()</a></code>.</p>
</td></tr>
<tr><td><code id="outreg_model_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the design matrix of the
covariates. Passed to fitting engine or used with
<code><a href="stats.html#topic+model.frame">stats::model.frame()</a></code> and <code><a href="stats.html#topic+model.matrix">stats::model.matrix()</a></code> to create the
design matrix for fitting engines that do not take formulas.</p>
</td></tr>
<tr><td><code id="outreg_model_+3A_engine">engine</code></td>
<td>
<p>String indicating the name of the fitting engine.</p>
</td></tr>
<tr><td><code id="outreg_model_+3A_separate">separate</code></td>
<td>
<p>Logical indicating whether the fitting algorithm
should be applied separately to each history of the treatment
variables up to this point (default) or not.</p>
</td></tr>
<tr><td><code id="outreg_model_+3A_include_past">include_past</code></td>
<td>
<p>A logical value where <code>TRUE</code> indicates that
formulas passed to previous <code>treat_model</code> calls should be appended
to the formula given.</p>
</td></tr>
<tr><td><code id="outreg_model_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the engine algorithms.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.cdesens'>Plot output from cdesens</h2><span id='topic+plot.cdesens'></span>

<h3>Description</h3>

<p>Plot output from cdesens
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cdesens'
plot(
  x,
  level = 0.95,
  xlim = NULL,
  ylim = NULL,
  xlab = NULL,
  ylab = "Estimated ACDE",
  bty = "n",
  col = "black",
  lwd = 2,
  ci.col = "grey70",
  ref.lines = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cdesens_+3A_x">x</code></td>
<td>
<p>output from <span class="env">cdesens</span></p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_level">level</code></td>
<td>
<p>level of confidence interval to plot</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_xlim">xlim</code></td>
<td>
<p>the x limits (x1, x2) of the plot for the sensitivity
analysis parameter, rho. Default is to use the range of
<span class="env">rho</span>.</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_ylim">ylim</code></td>
<td>
<p>the y limits of the plot for the estimated CDEs.
Default is to show the all of the confidence intervals.</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_xlab">xlab</code></td>
<td>
<p>label for the x axis.</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_ylab">ylab</code></td>
<td>
<p>label for the y axis.</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_bty">bty</code></td>
<td>
<p>a character string which determined the type of box
which is drawn about plots. Defaults to not drawing a box. See
<a href="graphics.html#topic+par">par</a> for more information.</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_col">col</code></td>
<td>
<p>color for the line indicating the point estimates of the
bias-adjusted ACDE.</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_lwd">lwd</code></td>
<td>
<p>line width for the line indicating the point estimates of the
bias-adjusted ACDE.</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_ci.col">ci.col</code></td>
<td>
<p>color for the polygon that shows the confidence
intervals.</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_ref.lines">ref.lines</code></td>
<td>
<p>a logical indicating whether horizontal and
vertical lines at 0 should be plotted.</p>
</td></tr>
<tr><td><code id="plot.cdesens_+3A_...">...</code></td>
<td>
<p>Other parameters to pass on to <span class="env">plot()</span></p>
</td></tr>
</table>

<hr>
<h2 id='plotDiag.tmatch'>Histograms of matching weights</h2><span id='topic+plotDiag.tmatch'></span>

<h3>Description</h3>

<p>Histograms of matching weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDiag.tmatch(object, stage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotDiag.tmatch_+3A_object">object</code></td>
<td>
<p>an object of class <code>tmatch</code> &ndash; results from a
call  to <code>telescope_match</code></p>
</td></tr>
<tr><td><code id="plotDiag.tmatch_+3A_stage">stage</code></td>
<td>
<p>a character vector equal to the name of one treatment
from the 'object'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provides histograms of the number of times each unit is
used as a match given a <code>tmatch</code> object returned by
<code>telescope_match</code>
</p>


<h3>Value</h3>

<p>Outputs a 'plot()' object containing the histogram of match counts
</p>

<hr>
<h2 id='ploughs'>Data on historical plough use and the socioeconomic status of
women.</h2><span id='topic+ploughs'></span>

<h3>Description</h3>

<p>A dataset to replicate the analysis in Alesina, Giuliano, and Nunn
(2013).
</p>
<p>A dataset to replicate the analysis in Alesina, Giuliano, and Nunn
(2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ploughs)

data(ploughs)
</code></pre>


<h3>Format</h3>

<p>A data frame with 234 observations and 57 variables.
</p>
<p>A data frame with 234 observations and 57 variables.
</p>


<h3>Details</h3>


<ul>
<li><p> isocode. 3-letter code for the country.
</p>
</li>
<li><p> flfp2000. Female labor force participation in 2000
</p>
</li>
<li><p> female_ownership. Percent of firms with female ownership (in
latest survey year)
</p>
</li>
<li><p> women_politics. Women in Politics in 2000, WDI
</p>
</li>
<li><p> plow. Animal plow cultivation variable (v39): Using
Ethnologue - pop weighted
</p>
</li>
<li><p> agricultural_suitability. overall (millets, sorghum, wheat,
barley, rye): share defined as suitable
</p>
</li>
<li><p> tropical_climate. Frac land: tropics and subtropics: using
Ethnologue - pop weighted
</p>
</li>
<li><p> large_animals. presence of large animals
</p>
</li>
<li><p> political_hierarchies. Jurisdictional hierarchy beyond local
community (v33): Using Ethnologue - pop weighted
</p>
</li>
<li><p> economic_complexity. Settlement patterns (v30)
</p>
</li>
<li><p> ln_income. ln (income)
</p>
</li>
<li><p> ln_income_squared. ln (income) ^2
</p>
</li>
<li><p> centered_ln_inc. de-meaned ln_inc
</p>
</li>
<li><p> centered_ln_incsq. de-meaned ln_inc squared
</p>
</li>
<li><p> country. country name
</p>
</li>
<li><p> communist_dummy. Communism indicator variable
</p>
</li>
<li><p> rugged. Ruggedness (Terrain Ruggedness Index, 100 m.)
</p>
</li>
<li><p> years_interstate_conflict. Years of interstate conflict, 1800-2007 - from COW
</p>
</li>
<li><p> serv_va_gdp2000. Value Added in Service/GDP in 2000
</p>
</li>
<li><p> polity2_2000. Polity 2 measure taken from the Polity IV dataset
</p>
</li>
<li><p> oil_pc. oil production/GDP
</p>
</li>
<li><p> ... other variables as annotated in the source.
</p>
</li></ul>


<ul>
<li><p> isocode. 3-letter code for the country.
</p>
</li>
<li><p> flfp2000. Female labor force participation in 2000
</p>
</li>
<li><p> female_ownership. Percent of firms with female ownership (in
latest survey year)
</p>
</li>
<li><p> women_politics. Women in Politics in 2000, WDI
</p>
</li>
<li><p> plow. Animal plow cultivation variable (v39): Using
Ethnologue - pop weighted
</p>
</li>
<li><p> agricultural_suitability. overall (millets, sorghum, wheat,
barley, rye): share defined as suitable
</p>
</li>
<li><p> tropical_climate. Frac land: tropics and subtropics: using
Ethnologue - pop weighted
</p>
</li>
<li><p> large_animals. presence of large animals
</p>
</li>
<li><p> political_hierarchies. Jurisdictional hierarchy beyond local
community (v33): Using Ethnologue - pop weighted
</p>
</li>
<li><p> economic_complexity. Settlement patterns (v30)
</p>
</li>
<li><p> ln_income. ln (income)
</p>
</li>
<li><p> ln_income_squared. ln (income) ^2
</p>
</li>
<li><p> centered_ln_inc. de-meaned ln_inc
</p>
</li>
<li><p> centered_ln_incsq. de-meaned ln_inc squared
</p>
</li>
<li><p> country. country name
</p>
</li>
<li><p> communist_dummy. Communism indicator variable
</p>
</li>
<li><p> rugged. Ruggedness (Terrain Ruggedness Index, 100 m.)
</p>
</li>
<li><p> years_interstate_conflict. Years of interstate conflict, 1800-2007 - from COW
</p>
</li>
<li><p> serv_va_gdp2000. Value Added in Service/GDP in 2000
</p>
</li>
<li><p> polity2_2000. Polity 2 measure taken from the Polity IV dataset
</p>
</li>
<li><p> oil_pc. oil production/GDP
</p>
</li>
<li><p> ... other variables as annotated in the source.
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://doi.org/10.1093/qje/qjt005">doi:10.1093/qje/qjt005</a>
</p>
<p><a href="https://doi.org/10.1093/qje/qjt005">doi:10.1093/qje/qjt005</a>
</p>


<h3>References</h3>

<p>Alesina, A., Giuliano, P., &amp; Nunn, N. (2013). On the
Origins of Gender Roles: Women and the Plough. The Quarterly
Journal of Economics, 128(2), 469-530. <a href="https://doi.org/10.1093/qje/qjt005">doi:10.1093/qje/qjt005</a>
</p>
<p>Alesina, A., Giuliano, P., &amp; Nunn, N. (2013). On the
Origins of Gender Roles: Women and the Plough. The Quarterly
Journal of Economics, 128(2), 469-530. <a href="https://doi.org/10.1093/qje/qjt005">doi:10.1093/qje/qjt005</a>
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+tidy'></span><span id='topic+glance'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>generics</dt><dd><p><code><a href="generics.html#topic+glance">glance</a></code>, <code><a href="generics.html#topic+tidy">tidy</a></code></p>
</dd>
</dl>

<hr>
<h2 id='seq_g_vcov'>Consistent Variance estimator</h2><span id='topic+seq_g_vcov'></span>

<h3>Description</h3>

<p>Called internally in sequential_g
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seq_g_vcov(first_mod, direct_mod, X1, X2, med.vars)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="seq_g_vcov_+3A_first_mod">first_mod</code></td>
<td>
<p>first stage model</p>
</td></tr>
<tr><td><code id="seq_g_vcov_+3A_direct_mod">direct_mod</code></td>
<td>
<p>DirectEffects model with terms</p>
</td></tr>
<tr><td><code id="seq_g_vcov_+3A_x1">X1</code></td>
<td>
<p>model matrix of first stage model</p>
</td></tr>
<tr><td><code id="seq_g_vcov_+3A_x2">X2</code></td>
<td>
<p>model matrix of DirectEffects model</p>
</td></tr>
<tr><td><code id="seq_g_vcov_+3A_med.vars">med.vars</code></td>
<td>
<p>vector of term.label attributes for mediators</p>
</td></tr>
</table>

<hr>
<h2 id='sequential_g'>Perform linear sequential g-estimation to estimate the controlled
direct effect of a treatment net the effect of a mediator.</h2><span id='topic+sequential_g'></span>

<h3>Description</h3>

<p>Perform linear sequential g-estimation to estimate the controlled
direct effect of a treatment net the effect of a mediator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sequential_g(
  formula,
  data,
  subset,
  weights,
  na.action,
  offset,
  contrasts = NULL,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sequential_g_+3A_formula">formula</code></td>
<td>
<p>formula specification of the first-stage,
second-stage, and blip-down models. The right-hand side of the
formula should have three components separated by the <code>|</code>,
with the first component specifying the first-stage model with
treatment and any baseline covariates, the second component
specifying the intermediate covariates for the first-stage, and
the third component specifying the blip-down model. See Details
below for more information.</p>
</td></tr>
<tr><td><code id="sequential_g_+3A_data">data</code></td>
<td>
<p>A dataframe to apply <code>formula</code> on.</p>
</td></tr>
<tr><td><code id="sequential_g_+3A_subset">subset</code></td>
<td>
<p>A vector of logicals indicating which rows of <code>data</code> to keep.</p>
</td></tr>
<tr><td><code id="sequential_g_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.  Should be <code>NULL</code> or a numeric vector.
If non-NULL, weighted least squares is used with weights
<code>weights</code> (that is, minimizing <code>sum(w*e^2)</code>); otherwise
ordinary least squares is used.  See also &lsquo;Details&rsquo;,</p>
</td></tr>
<tr><td><code id="sequential_g_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is set by
the <code>na.action</code> setting of <code><a href="base.html#topic+options">options</a></code>, and is
<code><a href="stats.html#topic+na.fail">na.fail</a></code> if that is unset.  The &lsquo;factory-fresh&rsquo;
default is <code><a href="stats.html#topic+na.omit">na.omit</a></code>.  Another possible value is
<code>NULL</code>, no action.  Value <code><a href="stats.html#topic+na.exclude">na.exclude</a></code> can be useful.</p>
</td></tr>
<tr><td><code id="sequential_g_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em> known
component to be included in the linear predictor during fitting.
This should be <code>NULL</code> or a numeric vector or matrix of extents
matching those of the response.  One or more <code><a href="stats.html#topic+offset">offset</a></code> terms can be
included in the formula instead or as well, and if more than one are
specified their sum is used.  See <code><a href="stats.html#topic+model.offset">model.offset</a></code>.</p>
</td></tr>
<tr><td><code id="sequential_g_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code>
of <code><a href="stats.html#topic+model.matrix.default">model.matrix.default</a></code>.</p>
</td></tr>
<tr><td><code id="sequential_g_+3A_verbose">verbose</code></td>
<td>
<p>logical indicating whether to suppress progress bar. Default is FALSE.</p>
</td></tr>
<tr><td><code id="sequential_g_+3A_...">...</code></td>
<td>
<p>For <code>lm()</code>: additional arguments to be passed to the low level
regression fitting functions (see below).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>sequential_g</code> function implements the linear
sequential g-estimator developed by Vansteelandt (2009) with the
consistent variance estimator developed by Acharya, Blackwell, and
Sen (2016).
</p>
<p>The formula specifies specifies the full first-stage model
including treatment, baseline confounders, intermediate
confounders, and the mediators. The user places <code>|</code> bars to
separate out these different components of the model. For
example, the formula should have the form <code>y ~ tr + x1 + x2
  | z1 + z2 | m1 + m2</code>. where <code>tr</code> is the name of the
treatment variable, <code>x1</code> and <code>x2</code> are baseline
covariates, <code>z1</code> and <code>z2</code> are intermediate covariates,
and <code>m1</code> and <code>m2</code> are the names of the mediator
variables. This last set of variables specify the 'blip-down' or
'demediation' function that is used to remove the average effect
of the mediator (possibly interacted) from the outcome to create
the blipped-down outcome. This blipped-down outcome is the passed
to a standard linear model with the covariates as specified for
the direct effects model.
</p>
<p>See the references below for more details.
</p>


<h3>Value</h3>

<p>Returns an object of <code>class</code> A <code>"seqg"</code>. Similar
to the output of a call to <code>lm</code>. Contains the following
components:
</p>

<ul>
<li><p> coefficients: a vector of named coefficients for the direct
effects model.
</p>
</li>
<li><p> residuals: the residuals, that is the blipped-down outcome
minus the fitted values.
</p>
</li>
<li><p> rank: the numeric rank of the fitted linear direct effects
model.
</p>
</li>
<li><p> fitted.values: the fitted mean values of the direct effects
model.
</p>
</li>
<li><p> weights: (only for weighted fits) the specified weights.
</p>
</li>
<li><p> df.residual: the residual degrees of freedom for the direct
effects model.
</p>
</li>
<li><p> aliased: logical vector indicating if any of the terms were
dropped or aliased due to perfect collinearity.
</p>
</li>
<li><p> terms: the list of <code>terms</code> object used. One for the
baseline covariates and treatment (<code>X</code>) and one for the
variables in the blip-down model (<code>M</code>).
</p>
</li>
<li><p> formula: the <code>formula</code> object used, possibly modified
to drop a constant in the blip-down model.
</p>
</li>
<li><p> call: the matched call.
</p>
</li>
<li><p> na.action: (where relevant) information returned by
<code>model.frame</code> of the special handling of <code>NA</code>s.
</p>
</li>
<li><p> xlevels: the levels of the factor variables.
</p>
</li>
<li><p> contrasts:  the contrasts used for the factor variables.
</p>
</li>
<li><p> first_mod: the output from the first-stage regression model.
</p>
</li>
<li><p> model: full model frame, including all variables.
</p>
</li>
<li><p> Ytilde: the blipped-down response vector.
</p>
</li>
<li><p> X: the model matrix for the second stage.
</p>
</li>
<li><p> M: the model matrix for demediation/blip-down function.
</p>
</li></ul>

<p>In addition, non-null fits will have components <code>assign</code>,
<code>effects</code>, and <code>qr</code> from the output of <code>lm.fit</code> or
<code>lm.wfit</code>, whichever is used.
</p>


<h3>References</h3>

<p>Vansteelandt, S. (2009). Estimating Direct Effects in
Cohort and Case-Control Studies. Epidemiology, 20(6), 851-860.
</p>
<p>Acharya, Avidit, Blackwell, Matthew, and Sen, Maya. (2016)
&quot;Explaining Causal Effects Without Bias: Detecting and Assessing
Direct Effects.&quot; American Political Science Review 110:3 pp.
512-529
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ploughs)

form_main &lt;- women_politics ~ plow +
  agricultural_suitability + tropical_climate + large_animals +
  political_hierarchies + economic_complexity +
  rugged | years_civil_conflict +
  years_interstate_conflict  + oil_pc +
  european_descent + communist_dummy + polity2_2000 +
  serv_va_gdp2000 | centered_ln_inc + centered_ln_incsq

direct &lt;- sequential_g(form_main, ploughs)

summary(direct)
</code></pre>

<hr>
<h2 id='set_treatment'>Specifiy a treatment variable for a controlled direct effect</h2><span id='topic+set_treatment'></span>

<h3>Description</h3>

<p>This function specifies a treatment variable in the sequence of
treatment variables that define the controlled direct effect of
interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_treatment(
  object,
  treat,
  formula = NULL,
  treat_type = "categorical",
  eval_vals = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_treatment_+3A_object">object</code></td>
<td>
<p>A <code>cde_estimator</code> object that may or may have
previous treatment variables specified/</p>
</td></tr>
<tr><td><code id="set_treatment_+3A_treat">treat</code></td>
<td>
<p>Name of the treatment variable (not quoted).</p>
</td></tr>
<tr><td><code id="set_treatment_+3A_formula">formula</code></td>
<td>
<p>One-sided formula giving the covariates that are
pre-treatment to this treatment, but post-treatment to any previous
treatment. Unless overridden by the arguments to
<code><a href="#topic+treat_model">treat_model()</a></code> or <code><a href="#topic+outreg_model">outreg_model()</a></code>,
this formula will be the specification used in the modeling of the
propensity scores or outcome regressions.</p>
</td></tr>
<tr><td><code id="set_treatment_+3A_treat_type">treat_type</code></td>
<td>
<p>A string indicating the type of variable this is.
Takes either the values <code>"categorical"</code> or <code>"regression"</code> (the
latter is not yet implemented).
of</p>
</td></tr>
<tr><td><code id="set_treatment_+3A_eval_vals">eval_vals</code></td>
<td>
<p>A numeric vector of values of this variable to
evaluate the controlled direct effecct. If <code>NULL</code> (the default),
this will be set to all observed values of the variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An updated <code>cde_estimator</code> with this information about the
treatment specified.
</p>


<h3>Author(s)</h3>

<p>Matthew Blackwell
</p>

<hr>
<h2 id='summary.seqg'>Computes standard errors and p-values of DirectEffects estimates</h2><span id='topic+summary.seqg'></span>

<h3>Description</h3>

<p>Computes standard errors and p-values of DirectEffects estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'seqg'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.seqg_+3A_object">object</code></td>
<td>
<p>An object of class <span class="env">seqg</span>, computed by
<code><a href="#topic+sequential_g">sequential_g</a></code>.</p>
</td></tr>
<tr><td><code id="summary.seqg_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.seqgboots'>Summary of DirectEffect Bootstrap Estimates</h2><span id='topic+summary.seqgboots'></span>

<h3>Description</h3>

<p>Summary of DirectEffect Bootstrap Estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'seqgboots'
summary(object, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.seqgboots_+3A_object">object</code></td>
<td>
<p>An output of class <code>seqg</code> estimated by <code><a href="#topic+boots_g">boots_g</a></code>.</p>
</td></tr>
<tr><td><code id="summary.seqgboots_+3A_level">level</code></td>
<td>
<p>level of intervals to estimate. Defaults to 0.95</p>
</td></tr>
<tr><td><code id="summary.seqgboots_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.tmatch'>Summarize telescope match objects</h2><span id='topic+summary.tmatch'></span>

<h3>Description</h3>

<p>Summarize telescope match objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tmatch'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.tmatch_+3A_object">object</code></td>
<td>
<p>an object of class <code>tmatch</code> &ndash; results from a
call to <code>telescope_match</code></p>
</td></tr>
<tr><td><code id="summary.tmatch_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary</code> method for <code>tmatch</code> objects returned by
<code>telescope_match</code>
</p>
<p>Returns a summary data frame containing the estimate and
standard errors from the 'telescope_match' object.
</p>


<h3>Value</h3>

<p>Returns an object of <code>class</code> <code>summary.tmatch</code>.
Contains the following components
</p>

<ul>
<li> <p><code>call</code>: matched call.
</p>
</li>
<li> <p><code>m_summary</code>: data.frame summarizes the matching
ratios (<code>{ratio}</code>), number of units <code>n_1, n_0</code>,
and number of matched units (<code>matched_1, matched_0</code>) for
each treatment/mediator (<code>term</code>).
</p>
</li>
<li> <p><code>K</code>: <code>K</code> data frame from the <code>object</code>
telescope matching output.
</p>
</li>
<li> <p><code>L</code>: <code>L</code> vector from the <code>object</code>
telescope matching output.
</p>
</li>
<li> <p><code>a_names</code>: character vector of the names of the
treatment/mediator variables used in matching. 
</p>
</li>
<li> <p><code>estimates</code>: matrix of estimated ACDEs with and
without bias correction and the estimated standard errors.
</p>
</li></ul>


<hr>
<h2 id='telescope_match'>Perform telescope matching to estimate the controlled
direct effect of a binary treatment net the effect of binary
mediators</h2><span id='topic+telescope_match'></span>

<h3>Description</h3>

<p>Perform telescope matching to estimate the controlled
direct effect of a binary treatment net the effect of binary
mediators
</p>


<h3>Usage</h3>

<pre><code class='language-R'>telescope_match(
  formula,
  data,
  caliper = NULL,
  L = 5,
  verbose = TRUE,
  subset,
  contrasts = NULL,
  separate_bc = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="telescope_match_+3A_formula">formula</code></td>
<td>
<p>A formula object that specifies the covariates and
treatment variables (or mediators) in causal ordering from oldest
to newest with each group separated by <code>|</code>. See below for
more details.</p>
</td></tr>
<tr><td><code id="telescope_match_+3A_data">data</code></td>
<td>
<p>A dataframe containing variables referenced by
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="telescope_match_+3A_caliper">caliper</code></td>
<td>
<p>A scalar denoting the caliper to be used in matching
in the treatment stage (calipers cannot be used for matching on
the mediator). Observations outside of the caliper are dropped.
Calipers are specified in standard deviations of the covariates.
NULL by default (no caliper).</p>
</td></tr>
<tr><td><code id="telescope_match_+3A_l">L</code></td>
<td>
<p>Number of matches to use for each unit. Must be a numeric
vector of either length 1 or 2. If length 1, L sets the number of
matches used in both the first stage (matching on mediator) and
in the second stage (matching on treatment). If length 2, the
first element sets the number of matches used in the first stage
(matching on mediator) and the second element sets the number of
matches used in the second stage (matching on treatment) Default
is 5.</p>
</td></tr>
<tr><td><code id="telescope_match_+3A_verbose">verbose</code></td>
<td>
<p>logical indicating whether to display progress
information. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="telescope_match_+3A_subset">subset</code></td>
<td>
<p>A vector of logicals indicating which rows of
<code>data</code> to keep.</p>
</td></tr>
<tr><td><code id="telescope_match_+3A_contrasts">contrasts</code></td>
<td>
<p>a list to be passed to the <code>contrasts.arg</code>
argument of <code>model.matrix()</code> when generating the data matrix.</p>
</td></tr>
<tr><td><code id="telescope_match_+3A_separate_bc">separate_bc</code></td>
<td>
<p>logical indicating whether or not bias
correction regressions should be run separately within levels of
the treatment and mediator. Defaults to <code>TRUE</code>. If
<code>TRUE</code>, any interactions between treatment/mediator and
covariates in the specification should be omitted.</p>
</td></tr>
<tr><td><code id="telescope_match_+3A_...">...</code></td>
<td>
<p>For <code>lm()</code>: additional arguments to be passed to the low level
regression fitting functions (see below).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>telescope_match</code> function implements the
two-stage &quot;telescope matching&quot; procedure developed by Blackwell
and Strezhnev (2021).
</p>
<p>The procedure first estimates a demediated outcome using a
combination of matching and a regression bias-correction. The
<code>data.frame</code> passed to <code>data</code> should be in the wide
format so that each row corresponds to a single unit and
treatments and covariates from different time periods appear as
different columns. The <code>formula</code> argument specifies both the
causal ordering of the variables and the regression specifications
for the bias correction. It should be of the form <code>Y ~ X1 |
 A1 | X2 | A2</code>, where <code>Y</code> is the outcome, <code>X1</code> is a
formula of baseline covariates, <code>A1</code> is a single variable
name indicating the binary treatment in the first period,
<code>X2</code> is a formula of covariates in period 2, and <code>A2</code> is
a single variable name indicating treatment in period 2 (which is
also sometimes called the mediator). Note that it is possible to
add more covariate/treatment pairs for additional time periods.
</p>
<p>Under the default <code>separate_bc == TRUE</code>, the function will
match for each treatment/mediator based on the the covariates up to
that point within levels of past treatments (so for <code>A2</code> this
matching finds units with similar values of <code>X1</code> and <code>X2</code>
and the same value of <code>A1</code>). Once this matching is complete,
the function moves backward through treatments and imputes
potential outcomes using matches and bias-correction regressions,
which regress the current imputed potential outcome on the past
covariates, within levels of the treatment history up to the
current period. The functional form comes from the specification in
<code>formula</code>. Controlled direct effects of <code>A1</code> are
estimated for every possible combination of future treatments.
</p>
<p>When <code>separate_bc</code> is <code>FALSE</code>, the bias correction
regressions are not broken out by the treatments/mediators and
those variables are simply included as separate regressors as
specified in <code>formula</code>. In this setting, interactions between
the treatment/mediator and covariates can be added on a selective
basis to the covariate block (<code>X1</code> or <code>X2</code> and so on)
specifications.
</p>
<p>Matching is performed using the <code>Match()</code> routine from the
<code>Matching</code> package. By default, matching is L-to-1 nearest
neighbor with replacement using Mahalanobis distance.
</p>
<p>See the references below for more details.
</p>


<h3>Value</h3>

<p>Returns an object of <code>class</code> <code>tmatch</code>. Contains
the following components
</p>

<ul>
<li> <p><code>call</code>: the matched call.
</p>
</li>
<li> <p><code>formula</code>: formula used to fit the model.
</p>
</li>
<li> <p><code>m_out</code>: list of matching solutions at each time
point. Each member of the list has a 'matches' list giving the
units matched to that unit, a 'donors' list with the units to
which the unit is matched, and a 'tr' vector which is just the
treatment vector being matched.
</p>
</li>
<li> <p><code>K</code>: data.frame of indicating how many times a unit
has been used as a match, directly in each period and indirectly
across periods.
</p>
</li>
<li> <p><code>L</code>: vector of matching ratios used in each period.
</p>
</li>
<li> <p><code>r_out</code>: nested list of regression imputations used in the
bias correction. The first level of the list varies across
different controlled direct effects (different sequences of future
treatments/mediators). Each of these is a list of time periods and
each of these time periods is a list of 'yhat_r_0' and 'yhat_r_1'
that give the regression predictions for the potential outcomes at
that time point when the treatment at that time point is 0 or 1,
respectively, along with 'n_coefs' giving the number of
coefficients estimated in those models.
</p>
</li>
<li> <p><code>tau</code>: vector of bias-corrected estimates of average
controlled direct effects for different vectors of future
treatments/mediators.
</p>
</li>
<li> <p><code>tau_raw</code>: vector of standard matching estimates of average
controlled direct effects for different vectors of future
treatments/mediators without using bias correction.
</p>
</li>
<li> <p><code>tau_se</code>: vector of estimated standard errors for the average
controlled direct effects estimates for different vectors of future
treatments/mediators. 
</p>
</li>
<li> <p><code>tau_i</code>: matrix of individuals contributions to the ACDE
estimates (units on rows, different ACDEs on columns). Used for
weighted bootstrap.
</p>
</li>
<li> <p><code>included</code>: logical vector indicating if each row of
<code>data</code> was included in estimating <code>tau</code>.
</p>
</li>
<li> <p><code>effects</code>: data frame where each row describes the
different ACDEs in <code>tau</code>. The <code>active</code> column describes
the which variable's direct effect is being assessed and the rest
of the columns describe the fixed values of the future
treatments/mediators for that ACDE.
</p>
</li>
<li> <p><code>a_names</code>: character vector with the names of the
treatment/mediator variables used in estimation.
</p>
</li>
<li> <p><code>caliper</code>: caliper (if any) used in matching to drop
distant observations.
</p>
</li></ul>



<h3>References</h3>

<p>Blackwell, Matthew, and Strezhnev, Anton (2020)
&quot;Telescope Matching: Reducing Model Dependence
in the Estimation of Direct Effects.&quot; Journal of the Royal
Statistical Society (Series A). <a href="https://doi.org/10.1111/rssa.12759">doi:10.1111/rssa.12759</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(jobcorps)

## Split male/female
jobcorps_female &lt;- subset(jobcorps, female == 1)

## Telescope matching formula - First stage (X and Z)
tm_form &lt;- exhealth30 ~  schobef + trainyrbef + jobeverbef  |
treat | emplq4 + emplq4full | work2year2q


### Estimate ACDE for women holding employment at 0
tm_out &lt;-  telescope_match(
  tm_form,
  data = jobcorps_female,
  L = 2,
  boot = FALSE,
  verbose = TRUE
)

</code></pre>

<hr>
<h2 id='transphobia'>Data from a randomized experiment on transgender rights.</h2><span id='topic+transphobia'></span>

<h3>Description</h3>

<p>A dataset from Broockman and Kalla (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(transphobia)
</code></pre>


<h3>Format</h3>

<p>A data frame with 501 observations and 19 variables.
</p>


<h3>Details</h3>


<ul>
<li><p> treated. Indicator of transgender rights script (1) vs
recycling script (0).
</p>
</li>
<li><p> nondiscrim_law_t3. Support for transgender
nondiscrimination law six weeks after treatment. 
</p>
</li>
<li><p> therm_trans_t2. Subjective feelings about
transgender people three weeks after treatment (0 = cool,
1 = neutral, 2 = warm).
</p>
</li>
<li><p> therm_obama_t1. Feeling thermometer score (0-100) for
feeling warmth or coolness toward Barack Obama 3 days after
treatment. 
</p>
</li>
<li><p> gender_norm_moral_t1. Index of moral attitudes
about gender 3 days after treatment.
</p>
</li>
<li><p> nondiscrim_law_t0. Baseline support for transgender
nondiscrimination law.
</p>
</li>
<li><p> therm_trans_t0. Baseline subjective feelings about
transgender people (0 = cool, 1 = neutral, 2 = warm).
</p>
</li>
<li><p> therm_obama_t0. Baseline feeling thermometer score (0-100) for
feeling warmth or coolness toward Barack Obama. 
</p>
</li>
<li><p> gender_norm_moral_t0. Baseline index of moral attitudes
about gender. 
</p>
</li>
<li><p> ideology_t0. Baseline measure of ideology (conservative is higher).
</p>
</li>
<li><p> religious_t0. Baseline measure of religiousity.
</p>
</li>
<li><p> exposure_trans_t0. Baseline indicator for personal exposure to
transgender people (1) or not (0).
</p>
</li>
<li><p> pid_t0. Baseline party identification (-3 = Strong Democrat,
3 = Strong Republican). 
</p>
</li>
<li><p> vf_democrat. Indicator for if the unit identifies as a Democrat
in the voter file (1) or not (0).
</p>
</li>
<li><p> vf_female. Indicator for if the unit identifies as a woman
in the voter file (1) or not (0).
</p>
</li>
<li><p> vf_hispanic. Indicator for if the unit identifies as Hispanic
in the voter file (1) or not (0).
</p>
</li>
<li><p> vf_black. Indicator for if the unit identifies as Black
in the voter file (1) or not (0).
</p>
</li>
<li><p> vf_age. Age of the citizen in the voter file.
</p>
</li>
<li><p> nondiscrim_law_diff. Difference between nondiscrim_law_t3 and
nondiscrim_law_t0
</p>
</li></ul>



<h3>Source</h3>

<p><a href="https://doi.org/10.1126/science.aad9713">doi:10.1126/science.aad9713</a>
</p>


<h3>References</h3>

<p>Broockman, D. &amp; Kalla, J. (2016). Durably reducing transphobia:
A field experiment on door-to-door canvassing. Science, 352(6282),
220-224. <a href="https://doi.org/10.1126/science.aad9713">doi:10.1126/science.aad9713</a>
</p>

<hr>
<h2 id='treat_model'>Specify the propensity score model for a CDE treatment</h2><span id='topic+treat_model'></span>

<h3>Description</h3>

<p>Specifies the functional form and estimation engine for a treatment
previously specified by <code><a href="#topic+set_treatment">set_treatment()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>treat_model(object, formula, engine, separate = TRUE, include_past = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="treat_model_+3A_object">object</code></td>
<td>
<p>A <code>cde_estimator</code> object that contains output from a
previous call to <code><a href="#topic+set_treatment">set_treatment()</a></code>.</p>
</td></tr>
<tr><td><code id="treat_model_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the design matrix of the
covariates. Passed to fitting engine or used with
<code><a href="stats.html#topic+model.frame">stats::model.frame()</a></code> and <code><a href="stats.html#topic+model.matrix">stats::model.matrix()</a></code> to create the
design matrix for fitting engines that do not take formulas.</p>
</td></tr>
<tr><td><code id="treat_model_+3A_engine">engine</code></td>
<td>
<p>String indicating the name of the fitting engine.</p>
</td></tr>
<tr><td><code id="treat_model_+3A_separate">separate</code></td>
<td>
<p>Logical indicating whether the fitting algorithm
should be applied separately to each history of the treatment
variables up to this point (default) or not.</p>
</td></tr>
<tr><td><code id="treat_model_+3A_include_past">include_past</code></td>
<td>
<p>A logical value where <code>TRUE</code> indicates that
formulas passed to previous <code>treat_model</code> calls should be appended
to the formula given.</p>
</td></tr>
<tr><td><code id="treat_model_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the engine algorithms.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matthew Blackwell
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
