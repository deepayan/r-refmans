<!DOCTYPE html><html lang="en"><head><title>Help for package rollupTree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rollupTree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#create_rollup_tree'><p>Create a tree for use with <code>rollup()</code></p></a></li>
<li><a href='#default_validate_dag'><p>Validate a directed acyclic graph for use with rollup</p></a></li>
<li><a href='#default_validate_tree'><p>Validate a tree for use with <code>rollup()</code></p></a></li>
<li><a href='#df_get_by_id'><p>Get property by key &quot;id&quot; from data frame</p></a></li>
<li><a href='#df_get_by_key'><p>Get property by key from data frame</p></a></li>
<li><a href='#df_get_ids'><p>Get ids from a data frame</p></a></li>
<li><a href='#df_get_keys'><p>Get keys from a data frame</p></a></li>
<li><a href='#df_set_by_id'><p>Set property by key &quot;id&quot; in data frame</p></a></li>
<li><a href='#df_set_by_key'><p>Set property by key in data frame</p></a></li>
<li><a href='#fault_table'><p>Example Fault Tree Data</p></a></li>
<li><a href='#fault_tree'><p>Example Fault Tree</p></a></li>
<li><a href='#rollup'><p>Perform recursive computation</p></a></li>
<li><a href='#test_dag'><p>Example Directed Acyclic Graph</p></a></li>
<li><a href='#update_df_prop_by_id'><p>Update a property in a data frame with key &quot;id&quot;</p></a></li>
<li><a href='#update_df_prop_by_key'><p>Update a property in a data frame</p></a></li>
<li><a href='#update_prop'><p>Update a data set with recursively-defined properties</p></a></li>
<li><a href='#update_rollup'><p>Update a rollup from a single leaf vertex</p></a></li>
<li><a href='#validate_df_by_id'><p>Validate a data frame with key &quot;id&quot; for <code>rollup()</code></p></a></li>
<li><a href='#validate_df_by_key'><p>Validate a data frame For <code>rollup()</code></p></a></li>
<li><a href='#validate_ds'><p>Validates a data set for use with <code>rollup()</code></p></a></li>
<li><a href='#wbs_table'><p>Example Work Breakdown Structure Data</p></a></li>
<li><a href='#wbs_table_rollup'><p>Example Work Breakdown Structure Data After Rollup</p></a></li>
<li><a href='#wbs_tree'><p>Example Work Breakdown Structure Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Perform Recursive Computations</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Mass rollup for a Bill of Materials is an example of a class of computations in which elements are arranged in a tree structure and some property of each element is a computed function of the corresponding values of its child elements. Leaf elements, i.e., those with no children, have values assigned. In many cases, the combining function is simple arithmetic sum; in other cases (e.g., mass properties), the combiner may involve other information such as the geometric relationship between parent and child, or statistical relations such as root-sum-of-squares (RSS). This package implements a general function for such problems. It is adapted to specific recursive computations by functional programming techniques; the caller passes a function as the update parameter to rollup() (or, at a lower level, passes functions as the get, set, combine, and override parameters to update_prop()) at runtime to specify the desired operations. The implementation relies on graph-theoretic algorithms from the 'igraph' package of Cs√°rdi, et al. (2006 &lt;<a href="https://doi.org/10.5281%2Fzenodo.7682609">doi:10.5281/zenodo.7682609</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>igraph</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://jsjuni.github.io/rollupTree/">https://jsjuni.github.io/rollupTree/</a>,
<a href="https://github.com/jsjuni/rollupTree">https://github.com/jsjuni/rollupTree</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jsjuni/rollupTree/issues">https://github.com/jsjuni/rollupTree/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-06 14:50:00 UTC; sjenkins</td>
</tr>
<tr>
<td>Author:</td>
<td>James Steven Jenkins
    <a href="https://orcid.org/0000-0002-0725-0884"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James Steven Jenkins &lt;sjenkins@studioj.us&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-06 16:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='create_rollup_tree'>Create a tree for use with <code>rollup()</code></h2><span id='topic+create_rollup_tree'></span>

<h3>Description</h3>

<p><code>create_rollup_tree()</code> creates a tree suitable for use with <code>rollup()</code>
by applying helper functions to construct vertices and edges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_rollup_tree(get_keys, get_parent_key_by_child_key)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_rollup_tree_+3A_get_keys">get_keys</code></td>
<td>
<p>A function() that returns a collection of names for vertices.</p>
</td></tr>
<tr><td><code id="create_rollup_tree_+3A_get_parent_key_by_child_key">get_parent_key_by_child_key</code></td>
<td>
<p>A function(key) that returns for each child key the key of its parent.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>igraph</code> directed graph with vertices and edges as supplied
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_keys &lt;- function() wbs_table$id
get_parent_key_by_child_key &lt;- function(key) wbs_table[which(wbs_table$id == key), "pid"]
create_rollup_tree(get_keys, get_parent_key_by_child_key)

</code></pre>

<hr>
<h2 id='default_validate_dag'>Validate a directed acyclic graph for use with rollup</h2><span id='topic+default_validate_dag'></span>

<h3>Description</h3>

<p>Validate a directed acyclic graph for use with rollup
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_validate_dag(dag)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="default_validate_dag_+3A_dag">dag</code></td>
<td>
<p>An igraph directed acyclic graph</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if valid, stops otherwise
</p>


<h3>Examples</h3>

<pre><code class='language-R'>default_validate_dag(test_dag)
</code></pre>

<hr>
<h2 id='default_validate_tree'>Validate a tree for use with <code>rollup()</code></h2><span id='topic+default_validate_tree'></span>

<h3>Description</h3>

<p><code>default_validate_tree()</code> ensures that a tree is acyclic,
loop-free, single-edged, connected, directed, and single-rooted with edge
direction from child to parent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_validate_tree(tree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="default_validate_tree_+3A_tree">tree</code></td>
<td>
<p><code>igraph</code> directed graph that is a valid single-rooted in-tree
and whose vertex names are keys from the data set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>single root vertex identifier if tree is valid; stops otherwise
</p>


<h3>Examples</h3>

<pre><code class='language-R'>default_validate_tree(wbs_tree)
</code></pre>

<hr>
<h2 id='df_get_by_id'>Get property by key &quot;id&quot; from data frame</h2><span id='topic+df_get_by_id'></span>

<h3>Description</h3>

<p><code>df_get_by_id</code> returns the value of specified property (column) in a specified row
of a data frame. The row is specified by a value for the <code>id</code> column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_get_by_id(df, idval, prop)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_get_by_id_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="df_get_by_id_+3A_idval">idval</code></td>
<td>
<p>id of the row to get</p>
</td></tr>
<tr><td><code id="df_get_by_id_+3A_prop">prop</code></td>
<td>
<p>name of the column to get</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The requested value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df_get_by_id(wbs_table, "1.1", "work")
</code></pre>

<hr>
<h2 id='df_get_by_key'>Get property by key from data frame</h2><span id='topic+df_get_by_key'></span>

<h3>Description</h3>

<p><code>df_get_by_key</code> returns the value of specified property (column) in a specified row
of a data frame. The row is specified by a key column and a value from that column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_get_by_key(df, key, keyval, prop)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_get_by_key_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="df_get_by_key_+3A_key">key</code></td>
<td>
<p>name of the column used as key</p>
</td></tr>
<tr><td><code id="df_get_by_key_+3A_keyval">keyval</code></td>
<td>
<p>value of the key for the specified row</p>
</td></tr>
<tr><td><code id="df_get_by_key_+3A_prop">prop</code></td>
<td>
<p>column name of the property value to get</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The requested value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df_get_by_key(wbs_table, "id", "1.1", "work")
</code></pre>

<hr>
<h2 id='df_get_ids'>Get ids from a data frame</h2><span id='topic+df_get_ids'></span>

<h3>Description</h3>

<p>The default name for a key column in <code>rollup</code> is <code>id</code>. <code>df_get_ids</code> gets all values
from the <code>id</code> column in a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_get_ids(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_get_ids_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>all values of the <code>id</code> column
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df_get_ids(wbs_table)
</code></pre>

<hr>
<h2 id='df_get_keys'>Get keys from a data frame</h2><span id='topic+df_get_keys'></span>

<h3>Description</h3>

<p><code>df_get_keys</code> gets all values from a designated column in a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_get_keys(df, key)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_get_keys_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="df_get_keys_+3A_key">key</code></td>
<td>
<p>name of the column used as key</p>
</td></tr>
</table>


<h3>Value</h3>

<p>All values of the key column
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df_get_keys(wbs_table, "id")
</code></pre>

<hr>
<h2 id='df_set_by_id'>Set property by key &quot;id&quot; in data frame</h2><span id='topic+df_set_by_id'></span>

<h3>Description</h3>

<p>Set property by key &quot;id&quot; in data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_set_by_id(df, idval, prop, val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_set_by_id_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="df_set_by_id_+3A_idval">idval</code></td>
<td>
<p>id value for the specified row</p>
</td></tr>
<tr><td><code id="df_set_by_id_+3A_prop">prop</code></td>
<td>
<p>column name of the property value to get</p>
</td></tr>
<tr><td><code id="df_set_by_id_+3A_val">val</code></td>
<td>
<p>value to set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df_set_by_id(wbs_table, "1", "work", 45.6)
</code></pre>

<hr>
<h2 id='df_set_by_key'>Set property by key in data frame</h2><span id='topic+df_set_by_key'></span>

<h3>Description</h3>

<p>Set property by key in data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_set_by_key(df, key, keyval, prop, val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_set_by_key_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="df_set_by_key_+3A_key">key</code></td>
<td>
<p>name of the column used as key</p>
</td></tr>
<tr><td><code id="df_set_by_key_+3A_keyval">keyval</code></td>
<td>
<p>value of the key for the specified row</p>
</td></tr>
<tr><td><code id="df_set_by_key_+3A_prop">prop</code></td>
<td>
<p>column name of the property value to get</p>
</td></tr>
<tr><td><code id="df_set_by_key_+3A_val">val</code></td>
<td>
<p>value to set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df_set_by_key(wbs_table, "id", "1", "work", 45.6)
</code></pre>

<hr>
<h2 id='fault_table'>Example Fault Tree Data</h2><span id='topic+fault_table'></span>

<h3>Description</h3>

<p>Example Fault Tree Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fault_table
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>id</dt><dd><p>unique key for each row</p>
</dd>
<dt>type</dt><dd><p>event type (&quot;basic&quot;, &quot;and&quot;, or &quot;or&quot;)</p>
</dd>
<dt>prob</dt><dd><p>event probability</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://control.com/technical-articles/deep-dive-into-fault-tree-analysis/">https://control.com/technical-articles/deep-dive-into-fault-tree-analysis/</a>
</p>

<hr>
<h2 id='fault_tree'>Example Fault Tree</h2><span id='topic+fault_tree'></span>

<h3>Description</h3>

<p>Example Fault Tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fault_tree
</code></pre>


<h3>Format</h3>

<p>An igraph tree with edges from child id to parent id.
</p>


<h3>Source</h3>

<p><a href="https://control.com/technical-articles/deep-dive-into-fault-tree-analysis/">https://control.com/technical-articles/deep-dive-into-fault-tree-analysis/</a>
</p>

<hr>
<h2 id='rollup'>Perform recursive computation</h2><span id='topic+rollup'></span>

<h3>Description</h3>

<p><code>rollup()</code> traverses a tree depth-first (post order) and calls a
user-specified update function at each vertex, passing the method a data set,
the unique key of that target vertex in the data set, and a list of source
keys. The update method typically gets some properties of the source
elements of the data set, combines them, sets some properties of the
target element of the data set to the combined value, and returns the
updated data set as input to the update of the next vertex. The final
operation updates the root vertex.
</p>
<p>An <code>update_prop()</code> helper function is available to simplify building
compliant update methods.
</p>
<p>Before beginning the traversal, <code>rollup()</code> calls a user-specified method to
validate that the tree is well-formed (see <code><a href="#topic+default_validate_tree">default_validate_tree()</a></code>). It
also calls a user-specified method to ensure that the id sets of the tree
and data set are identical, and that data set elements corresponding to
leaf vertices in the tree satisfy some user-specified predicate, e.g.,
<code>is.numeric()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rollup(tree, ds, update, validate_ds, validate_tree = default_validate_tree)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rollup_+3A_tree">tree</code></td>
<td>
<p><code>igraph</code> directed graph that is a valid single-rooted in-tree
and whose vertex names are keys from the data set</p>
</td></tr>
<tr><td><code id="rollup_+3A_ds">ds</code></td>
<td>
<p>data set to be updated; can be any object</p>
</td></tr>
<tr><td><code id="rollup_+3A_update">update</code></td>
<td>
<p>function called at each vertex as update(ds,
parent_key, child_keys)</p>
</td></tr>
<tr><td><code id="rollup_+3A_validate_ds">validate_ds</code></td>
<td>
<p>data set validator function called as validate_ds(tree, ds)</p>
</td></tr>
<tr><td><code id="rollup_+3A_validate_tree">validate_tree</code></td>
<td>
<p>tree validator function called as validate_tree(tree)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data set passed to <code>rollup()</code> can be any object for which an
update function can be written. A common and simple example is a data
frame, but lists work as well.
</p>


<h3>Value</h3>

<p>updated input data set
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rollup(wbs_tree, wbs_table,
  update = function(d, p, c) {
    if (length(c) &gt; 0)
      d[d$id == p, c("work", "budget")] &lt;-
        apply(d[is.element(d$id, c), c("work", "budget")], 2, sum)
      d
  },
  validate_ds = function(tree, ds) TRUE
)

</code></pre>

<hr>
<h2 id='test_dag'>Example Directed Acyclic Graph</h2><span id='topic+test_dag'></span>

<h3>Description</h3>

<p>Example Directed Acyclic Graph
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_dag
</code></pre>


<h3>Format</h3>

<p>An igraph DAG with edges from child id to parent id.
</p>

<hr>
<h2 id='update_df_prop_by_id'>Update a property in a data frame with key &quot;id&quot;</h2><span id='topic+update_df_prop_by_id'></span>

<h3>Description</h3>

<p><code>update_df_prop_by_id()</code> is a convenience wrapper around <code>update_prop()</code>
for the common case in which the data set is a data frame whose key column
is named &quot;id&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_df_prop_by_id(df, target, sources, prop, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_df_prop_by_id_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="update_df_prop_by_id_+3A_target">target</code></td>
<td>
<p>key of data set element to be updated</p>
</td></tr>
<tr><td><code id="update_df_prop_by_id_+3A_sources">sources</code></td>
<td>
<p>keys of data set elements to be combined</p>
</td></tr>
<tr><td><code id="update_df_prop_by_id_+3A_prop">prop</code></td>
<td>
<p>column name of the property</p>
</td></tr>
<tr><td><code id="update_df_prop_by_id_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>update_prop()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>update_df_prop_by_id(wbs_table, "1", list("1.1", "1.2"), "work")
</code></pre>

<hr>
<h2 id='update_df_prop_by_key'>Update a property in a data frame</h2><span id='topic+update_df_prop_by_key'></span>

<h3>Description</h3>

<p><code>update_df_prop_by_key()</code> is a convenience wrapper around <code>update_prop()</code>
for the common case in which the data set is a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_df_prop_by_key(df, key, target, sources, prop, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_df_prop_by_key_+3A_df">df</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="update_df_prop_by_key_+3A_key">key</code></td>
<td>
<p>name of the column serving as key</p>
</td></tr>
<tr><td><code id="update_df_prop_by_key_+3A_target">target</code></td>
<td>
<p>key of data set element to be updated</p>
</td></tr>
<tr><td><code id="update_df_prop_by_key_+3A_sources">sources</code></td>
<td>
<p>keys of data set elements to be combined</p>
</td></tr>
<tr><td><code id="update_df_prop_by_key_+3A_prop">prop</code></td>
<td>
<p>column name of the property</p>
</td></tr>
<tr><td><code id="update_df_prop_by_key_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>update_prop()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>update_df_prop_by_key(wbs_table, "id", "1", list("1.1", "1.2"), "work")
</code></pre>

<hr>
<h2 id='update_prop'>Update a data set with recursively-defined properties</h2><span id='topic+update_prop'></span>

<h3>Description</h3>

<p><code>update_prop</code> calls user-specified methods to get properties
of a source set of elements in a data set, combine those properties,
and set the properties of a target element to the combined value.
If the source set is empty, the data set is returned unmodified. The
default combine operation is addition.
</p>
<p>The <code>override</code> argument can be used to selectively override the
computed value based on the target element. By default, it simply
returns the value computed by the combiner.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_prop(
  ds,
  target,
  sources,
  set,
  get,
  combine = function(l) Reduce("+", l),
  override = function(ds, target, v) v
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_prop_+3A_ds">ds</code></td>
<td>
<p>data set to be updated</p>
</td></tr>
<tr><td><code id="update_prop_+3A_target">target</code></td>
<td>
<p>key of data set element to be updated</p>
</td></tr>
<tr><td><code id="update_prop_+3A_sources">sources</code></td>
<td>
<p>keys of data set elements to be combined</p>
</td></tr>
<tr><td><code id="update_prop_+3A_set">set</code></td>
<td>
<p>function to set properties for a target element called as set(ds, key, value)</p>
</td></tr>
<tr><td><code id="update_prop_+3A_get">get</code></td>
<td>
<p>function to get properties for source elements called as get(ds, key)</p>
</td></tr>
<tr><td><code id="update_prop_+3A_combine">combine</code></td>
<td>
<p>function to combine properties called as combine(vl)</p>
</td></tr>
<tr><td><code id="update_prop_+3A_override">override</code></td>
<td>
<p>function to selectively override combined results called as override(ds, key,)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated data set
</p>


<h3>Examples</h3>

<pre><code class='language-R'>update_prop(wbs_table, "1", list("1.1", "1.2"),
  function(d, k, v) {d[d$id == k, "work"] &lt;- v; d},
  function(d, k) d[d$id == k, "work"]
 )
update_prop(wbs_table, "1", list("1.1", "1.2"),
  function(d, k, v) {d[d$id == k, c("work", "budget")] &lt;- v; d},
  function(d, k) d[d$id == k, c("work", "budget")],
  function(l) Reduce("+", l)
)
</code></pre>

<hr>
<h2 id='update_rollup'>Update a rollup from a single leaf vertex</h2><span id='topic+update_rollup'></span>

<h3>Description</h3>

<p><code>update_rollup()</code> performs a minimal update of a data set assuming a single leaf element property
has changed. It performs updates along the path from that vertex to the root. There should be no difference
in the output from calling <code>rollup()</code> again. <code>update_rollup()</code> is perhaps more efficient and useful in an interactive context.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_rollup(tree, ds, vertex, update)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_rollup_+3A_tree">tree</code></td>
<td>
<p><code>igraph</code> directed graph that is a valid single-rooted in-tree
and whose vertex names are keys from the data set</p>
</td></tr>
<tr><td><code id="update_rollup_+3A_ds">ds</code></td>
<td>
<p>data set to be updated; can be any object</p>
</td></tr>
<tr><td><code id="update_rollup_+3A_vertex">vertex</code></td>
<td>
<p>The start vertex</p>
</td></tr>
<tr><td><code id="update_rollup_+3A_update">update</code></td>
<td>
<p>function called at each vertex as update(ds,
parent_key, child_keys)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated input data set
</p>


<h3>Examples</h3>

<pre><code class='language-R'>update_rollup(wbs_tree, wbs_table, igraph::V(wbs_tree)["3.2"],
  update = function(d, p, c) {
    if (length(c) &gt; 0)
      d[d$id == p, c("work", "budget")] &lt;-
        apply(d[is.element(d$id, c), c("work", "budget")], 2, sum)
      d
  }
)

</code></pre>

<hr>
<h2 id='validate_df_by_id'>Validate a data frame with key &quot;id&quot; for <code>rollup()</code></h2><span id='topic+validate_df_by_id'></span>

<h3>Description</h3>

<p><code>validate_df_by_id()</code> is a convenience wrapper for <code>validate_ds()</code> for the common case in which the
data set is a data frame with key column named &quot;id&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_df_by_id(tree, df, prop, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="validate_df_by_id_+3A_tree">tree</code></td>
<td>
<p>tree to validate against</p>
</td></tr>
<tr><td><code id="validate_df_by_id_+3A_df">df</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="validate_df_by_id_+3A_prop">prop</code></td>
<td>
<p>property whose value is checked (leaf elements only)</p>
</td></tr>
<tr><td><code id="validate_df_by_id_+3A_...">...</code></td>
<td>
<p>other parameters passed to validate_ds()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if validation succeeds, halts otherwise
</p>


<h3>Examples</h3>

<pre><code class='language-R'>validate_df_by_id(wbs_tree, wbs_table, "work")
</code></pre>

<hr>
<h2 id='validate_df_by_key'>Validate a data frame For <code>rollup()</code></h2><span id='topic+validate_df_by_key'></span>

<h3>Description</h3>

<p><code>validate_df_by_key()</code> is a convenience wrapper for <code>validate_ds()</code> for the common case in which the
data set is a dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_df_by_key(tree, df, key, prop, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="validate_df_by_key_+3A_tree">tree</code></td>
<td>
<p>tree to validate against</p>
</td></tr>
<tr><td><code id="validate_df_by_key_+3A_df">df</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="validate_df_by_key_+3A_key">key</code></td>
<td>
<p>name of the column serving as key</p>
</td></tr>
<tr><td><code id="validate_df_by_key_+3A_prop">prop</code></td>
<td>
<p>property whose value is checked (leaf elements only)</p>
</td></tr>
<tr><td><code id="validate_df_by_key_+3A_...">...</code></td>
<td>
<p>other parameters passed to validate_ds()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if validation succeeds, halts otherwise
</p>


<h3>Examples</h3>

<pre><code class='language-R'>validate_df_by_key(wbs_tree, wbs_table, "id", "work")
</code></pre>

<hr>
<h2 id='validate_ds'>Validates a data set for use with <code>rollup()</code></h2><span id='topic+validate_ds'></span>

<h3>Description</h3>

<p><code>validate_ds()</code> ensures that a data set contains the same identifiers as a specified tree and that
elements of the data set corresponding to leaf vertices in the tree satisfy a user-specified predicate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_ds(
  tree,
  ds,
  get_keys,
  get_prop,
  op = function(x) is.numeric(x) &amp; !is.na(x)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="validate_ds_+3A_tree">tree</code></td>
<td>
<p><code>igraph</code> directed graph that is a valid single-rooted in-tree
and whose vertex names are keys from the data set</p>
</td></tr>
<tr><td><code id="validate_ds_+3A_ds">ds</code></td>
<td>
<p>data set to be updated; can be any object</p>
</td></tr>
<tr><td><code id="validate_ds_+3A_get_keys">get_keys</code></td>
<td>
<p>function to get keys of the data set called as <code>get_keys(ds)</code></p>
</td></tr>
<tr><td><code id="validate_ds_+3A_get_prop">get_prop</code></td>
<td>
<p>function to get the property value to validate for leaf element with id <code>l</code>, called as <code>get_prop(ds, l)</code></p>
</td></tr>
<tr><td><code id="validate_ds_+3A_op">op</code></td>
<td>
<p>logical function to test return value of <code>get_prop()</code> (default <code>is.numeric()</code>); returns <code>TRUE</code> if OK</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if validation succeeds, halts otherwise
</p>


<h3>Examples</h3>

<pre><code class='language-R'>validate_ds(wbs_tree, wbs_table, function(d) d$id, function(d, l) d[d$id == l, "work"])

</code></pre>

<hr>
<h2 id='wbs_table'>Example Work Breakdown Structure Data</h2><span id='topic+wbs_table'></span>

<h3>Description</h3>

<p>Example Work Breakdown Structure Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wbs_table
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>id</dt><dd><p>unique key for each row</p>
</dd>
<dt>pid</dt><dd><p>parent key for each row</p>
</dd>
<dt>name</dt><dd><p>character name of the element</p>
</dd>
<dt>work</dt><dd><p>percent of total work for this element</p>
</dd>
<dt>budget</dt><dd><p>budget for this element</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.workbreakdownstructure.com">https://www.workbreakdownstructure.com</a>
</p>

<hr>
<h2 id='wbs_table_rollup'>Example Work Breakdown Structure Data After Rollup</h2><span id='topic+wbs_table_rollup'></span>

<h3>Description</h3>

<p>Example Work Breakdown Structure Data After Rollup
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wbs_table_rollup
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>id</dt><dd><p>unique key for each row</p>
</dd>
<dt>pid</dt><dd><p>parent key for each row</p>
</dd>
<dt>name</dt><dd><p>character name of the element</p>
</dd>
<dt>work</dt><dd><p>percent of total work for this element</p>
</dd>
<dt>budget</dt><dd><p>budget for this element</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.workbreakdownstructure.com">https://www.workbreakdownstructure.com</a>
</p>

<hr>
<h2 id='wbs_tree'>Example Work Breakdown Structure Data</h2><span id='topic+wbs_tree'></span>

<h3>Description</h3>

<p>Example Work Breakdown Structure Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wbs_tree
</code></pre>


<h3>Format</h3>

<p>An igraph tree with edges from child id to parent id.
</p>


<h3>Source</h3>

<p><a href="https://www.workbreakdownstructure.com">https://www.workbreakdownstructure.com</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
