<!DOCTYPE html><html lang="en-GB"><head><title>Help for package expirest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {expirest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#exp1'><p>Stability potency data of five batches</p></a></li>
<li><a href='#exp2'><p>Stability related substance data of three batches</p></a></li>
<li><a href='#exp3'><p>Stability moisture data of three batches</p></a></li>
<li><a href='#exp4'><p>Stability data of 4 batches</p></a></li>
<li><a href='#expirest_osle'><p>Ordinary shelf life estimation (osle)</p></a></li>
<li><a href='#expirest_wisle'><p>What-if (approach for) shelf life estimation (wisle)</p></a></li>
<li><a href='#plot_expirest_osle'><p>Illustrating the ordinary shelf life estimate (osle)</p></a></li>
<li><a href='#plot_expirest_wisle'><p>Illustrating the what-if (approach for) shelf life estimate (wisle)</p></a></li>
<li><a href='#plot.plot_expirest_osle'><p>Plot illustrating the shelf life estimation (osle)</p></a></li>
<li><a href='#plot.plot_expirest_wisle'><p>Plot illustrating the what-if shelf life estimation (wisle)</p></a></li>
<li><a href='#print.expirest_osle'><p>Print a summary of the shelf life estimation (osle)</p></a></li>
<li><a href='#print.expirest_wisle'><p>Print a summary of the what-if shelf life estimation (wisle)</p></a></li>
<li><a href='#print.plot_expirest_osle'><p>Print a plot illustrating the shelf life estimation (osle)</p></a></li>
<li><a href='#print.plot_expirest_wisle'><p>Print a plot illustrating the what-if shelf life estimation (wisle)</p></a></li>
<li><a href='#summary.expirest_osle'><p>Summary of the shelf life estimation (osle)</p></a></li>
<li><a href='#summary.expirest_wisle'><p>Summary of the what-if shelf life estimation (wisle)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Expiry Estimation Procedures</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.7</td>
</tr>
<tr>
<td>Description:</td>
<td>The Australian Regulatory Guidelines for Prescription
    Medicines (ARGPM), guidance on "Stability testing for prescription
    medicines", recommends to predict the shelf life of chemically derived
    medicines from stability data by taking the worst case situation at batch
    release into account. Consequently, if a change over time is observed,
    a release limit needs to be specified. Finding a release limit and the
    associated shelf life is supported, as well as the standard approach
    that is recommended by guidance Q1E "Evaluation of stability data"
    from the International Council for Harmonisation (ICH).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/piusdahinden/expirest">https://github.com/piusdahinden/expirest</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/piusdahinden/expirest/issues">https://github.com/piusdahinden/expirest/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, rlang, lifecycle</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-25 08:13:15 UTC; piusd</td>
</tr>
<tr>
<td>Author:</td>
<td>Pius Dahinden [aut, cre],
  Tillotts Pharma AG [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pius Dahinden &lt;pius.dahinden@tillotts.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-25 08:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='exp1'>Stability potency data of five batches</h2><span id='topic+exp1'></span>

<h3>Description</h3>

<p>A data set containing the potency stability data (in % of label claim (LC))
of five batches of a drug product obtained over a 24 months period. A total
of <code class="reqn">n = 53</code> independent measurements are available (corresponding to
data shown in Tables IV, VI and VIII in LeBlond et al. (2011)). Data in
Table IV (batches <code>b2</code>, <code>b5</code> and <code>b7</code>) are compatible with a
common intercept / common slope (cics) model, data in Table VI (batches
<code>b3</code>, <code>b4</code> and <code>b5</code>) with a different intercept / common slope
(dics) model  and data in Table VIII (bathes <code>b4</code>, <code>b5</code> and
<code>b8</code>) with a different intercept / different slope (dids) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exp1)
</code></pre>


<h3>Format</h3>

<p>A data frame with 53 observations and 3 variables:
</p>

<dl>
<dt>Batch</dt><dd><p>Factor with levels <code>b2</code>, <code>b3</code>, <code>b4</code>, <code>b5</code>,
<code>b7</code> and <code>b8</code></p>
</dd>
<dt>Month</dt><dd><p>Numeric representing the time points of testing from the
start (0 months) to the end (24 months) of the study.</p>
</dd>
<dt>Potency</dt><dd><p>Numeric of the measured potency values in %LC</p>
</dd>
</dl>



<h3>Source</h3>

<p>See reference: Example data sets shown in Tables IV, VI and VIII.
</p>


<h3>References</h3>

<p>LeBlond, D., Griffith, D. and Aubuchon, K. Linear Regression 102: Stability
Shelf Life Estimation Using Analysis of Covariance. <em>J Valid Technol</em>
(2011) <strong>17</strong>(3): 47-68.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(exp1)
</code></pre>

<hr>
<h2 id='exp2'>Stability related substance data of three batches</h2><span id='topic+exp2'></span>

<h3>Description</h3>

<p>A data set containing the related substance stability data (in % of label
claim (LC)) of three batches of a drug product obtained over a 24 months
period. A total of <code class="reqn">n = 24</code> independent measurements are available
(corresponding to data shown in Table XI in LeBlond et al. (2011)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exp2)
</code></pre>


<h3>Format</h3>

<p>A data frame with 48 observations and 3 variables:
</p>

<dl>
<dt>Batch</dt><dd><p>Factor with levels <code>b4</code>, <code>b5</code> and <code>b8</code></p>
</dd>
<dt>Month</dt><dd><p>Numeric representing the time points of testing from the
start (0 months) to the end (24 months) of the study.</p>
</dd>
<dt>Related</dt><dd><p>Numeric of the measured related substance levels in %LC</p>
</dd>
</dl>



<h3>Source</h3>

<p>See reference: Example data sets shown in Table XI.
</p>


<h3>References</h3>

<p>LeBlond, D., Griffith, D. and Aubuchon, K. Linear Regression 102: Stability
Shelf Life Estimation Using Analysis of Covariance. <em>J Valid Technol</em>
(2011) <strong>17</strong>(3): 47-68.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(exp2)
</code></pre>

<hr>
<h2 id='exp3'>Stability moisture data of three batches</h2><span id='topic+exp3'></span>

<h3>Description</h3>

<p>A data set containing the moisture stability data (% (w/w)) of three
batches of a drug product obtained over a 24 months period. A total of
<code class="reqn">n = 33</code> independent measurements are available (corresponding to data
shown in Table XIII in LeBlond et al. (2011)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exp3)
</code></pre>


<h3>Format</h3>

<p>A data frame with 33 observations and 3 variables:
</p>

<dl>
<dt>Batch</dt><dd><p>Factor with levels <code>b1</code>, <code>b2</code> and <code>b3</code></p>
</dd>
<dt>Month</dt><dd><p>Numeric representing the time points of testing from the
start (0 months) to the end (24 months) of the study.</p>
</dd>
<dt>Moisture</dt><dd><p>Numeric of the measured moisture levels %(w/w)</p>
</dd>
</dl>



<h3>Source</h3>

<p>See reference: Example data sets shown in Table XIII.
</p>


<h3>References</h3>

<p>LeBlond, D., Griffith, D. and Aubuchon, K. Linear Regression 102: Stability
Shelf Life Estimation Using Analysis of Covariance. <em>J Valid Technol</em>
(2011) <strong>17</strong>(3): 47-68.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(exp3)
</code></pre>

<hr>
<h2 id='exp4'>Stability data of 4 batches</h2><span id='topic+exp4'></span>

<h3>Description</h3>

<p>A data set containing the concentration data (mg/kg) of four batches
obtained over a 24 months period of a drug product. A total of <code class="reqn">n = 36</code>
independent measurements are available (corresponding to the data set
<em>Reliability/Stability.jmp</em> in <em>JMP(R) 12 Reliability and Survival
Methods</em> manual).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(exp4)
</code></pre>


<h3>Format</h3>

<p>A data frame with 36 observations and 3 variables:
</p>

<dl>
<dt>Batch</dt><dd><p>Factor with levels <code>1_11</code>, <code>2_12</code>, <code>3_13</code> and
<code>4_14</code>.</p>
</dd>
<dt>Month</dt><dd><p>Numeric representing the time points of testing from the
start (0 months) to the end (24 months) of the study.</p>
</dd>
<dt>Conc</dt><dd><p>Numeric of the measured concentrations in <code class="reqn">mg / kg</code>.</p>
</dd>
</dl>



<h3>Source</h3>

<p>See reference: Example data set (Stability.jmp) used in chapter
<em>Stability Analysis</em>, p. 174-176.
</p>


<h3>References</h3>

<p>SAS Institute Inc. 2015. <em>JMP(R) 12 Reliability and Survival Methods</em>.
Cary, NC: SAS Institute Inc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(exp4)
</code></pre>

<hr>
<h2 id='expirest_osle'>Ordinary shelf life estimation (osle)</h2><span id='topic+expirest_osle'></span>

<h3>Description</h3>

<p>Based on a linear regression model fitted to a stability data set the
function <code>expirest_osle()</code> estimates the shelf life, or retest period,
following the ICH Q1E guideline. The abbreviation &ldquo;osle&rdquo; stands for
&ldquo;ordinary shelf life estimation&rdquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expirest_osle(
  data,
  response_vbl,
  time_vbl,
  batch_vbl,
  sl,
  sl_sf,
  srch_range,
  alpha = 0.05,
  alpha_pool = 0.25,
  xform = c("no", "no"),
  shift = c(0, 0),
  sf_option = "tight",
  ivl = "confidence",
  ivl_type = "one.sided",
  ivl_side = "lower",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expirest_osle_+3A_data">data</code></td>
<td>
<p>A data frame with the columns specified by <code>response_vbl</code>,
<code>time_vbl</code> and <code>batch_vbl</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_response_vbl">response_vbl</code></td>
<td>
<p>A character string that specifies the response variable
name that must be a column of <code>data</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_time_vbl">time_vbl</code></td>
<td>
<p>A character string that specifies the time variable name
that must be a column of <code>data</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_batch_vbl">batch_vbl</code></td>
<td>
<p>A character string that specifies the column in <code>data</code>
with the grouping information (i.e. a factorial variable) for the
differentiation of the observations of the various batches.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_sl">sl</code></td>
<td>
<p>A numeric value or a numeric vector of length <code>2</code> that
specifies the specification limit or limits. If a vector is provided it
must be of the form <code>c(lower limit, upper limit)</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_sl_sf">sl_sf</code></td>
<td>
<p>A positive integer or a vector of positive integers that
specifies the number of &ldquo;significant figures&rdquo; (sf) of <code>sl</code>.
It must have the same length as <code>sl</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_srch_range">srch_range</code></td>
<td>
<p>A vector of length <code>2</code> that specifies the end-points
of the (time) range that is supposed to contain the shelf life or retest
period.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value between 0 and 1 that specifies the significance
level for the calculation of confidence or prediction intervals. The
default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_alpha_pool">alpha_pool</code></td>
<td>
<p>A numeric value between 0 and 1 that specifies the type I
error rate for the test of the poolability of the batches. The default
is <code>0.25</code>, following ICH Q1E guideline. The value should not be
changed unless supported by well-founded reasons.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_xform">xform</code></td>
<td>
<p>A vector of two character strings that specifies the
transformation of the response and the time variable. The default is
&ldquo;no&rdquo; transformation, i.e. <code>c("no", "no")</code>, where the first
element specifies the transformation of the <code class="reqn">x</code> variable and the
second element the transformation of the <code class="reqn">y</code> variable. Valid
alternatives for <code class="reqn">x</code> and/or <code class="reqn">y</code> variable transformation are
<code>"log"</code> (natural logarithm), <code>"sqrt"</code> (square root) and
<code>"sq"</code> (square).</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_shift">shift</code></td>
<td>
<p>A vector of two values which will be added to the variables
<code class="reqn">x</code> and/or <code class="reqn">y</code> before they are transformed as specified by the
<code>xform</code> parameter, where the first element will be added to the
<code class="reqn">x</code> variable and the second element to the <code class="reqn">y</code> variable. The
purpose is to prevent an undefined state which could arise when variables
with values of <code class="reqn">\leq 0</code> are log or square root transformed. The
default is <code>c(0, 0)</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_sf_option">sf_option</code></td>
<td>
<p>A character string that specifies if the limits (<code>rl</code>
or <code>sl</code>) should be regarded as &ldquo;tight&rdquo; or &ldquo;loose&rdquo;, i.e.
either <code>"tight"</code> or <code>"loose"</code>, respectively. The default is
<code>"tight"</code>. The option <code>"tight"</code> means that the limits are
rounded to the number of significant digits specified by the parameters
<code>rl_sf</code> and <code>sl_sf</code>. If <code>sf_option = "loose"</code>, four on
the order of the last significant digit + 1 is added if
<code>ivl_side = "upper"</code> or five on the order of the last significant
digit + 1 is subtracted if <code>ivl_side = "upper"</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_ivl">ivl</code></td>
<td>
<p>A character string of either <code>"confidence"</code> or
<code>"prediction"</code> that specifies the type of interval of interest.
The default is <code>"confidence"</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_ivl_type">ivl_type</code></td>
<td>
<p>A character string that specifies if a &ldquo;one sided&rdquo;
or a &ldquo;two sided&rdquo; interval should be calculated, i.e. either
<code>"one.sided"</code> or <code>"two.sided"</code>, respectively. The default is
<code>"one.sided"</code>.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_ivl_side">ivl_side</code></td>
<td>
<p>A character string that specifies if the specification
limit, given that the limit has only one side, is an &ldquo;upper&rdquo; or a
&ldquo;lower&rdquo; bound, i.e. it is specified as either <code>"upper"</code> or
<code>"lower"</code>, respectively. The default is <code>"lower"</code>. If the
specification has two boundaries, then this parameter specifies the
preferred side. If no side is preferred over the other, <code>"both"</code> can
be used.</p>
</td></tr>
<tr><td><code id="expirest_osle_+3A_...">...</code></td>
<td>
<p>Additional named or unnamed arguments passed on to
<code>uniroot()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>According to ICH Q1E guideline, &ldquo;<em>an appropriate
approach to retest period or shelf life estimation is to analyse a
quantitative attribute by determining the earliest time at which the 95
percent confidence limit for the mean intersects the proposed acceptance
criterion</em>&rdquo; (in this package, this point is called the &ldquo;point of
intersection&rdquo; (POI)). Furthermore, it says that &ldquo;<em>for an
attribute known to increase with time, the upper one-sided 95 percent
confidence limit should be compared to the acceptance criterion. For an
attribute that can either increase or decrease, or whose direction of change
is not known, two-sided 95 percent confidence limits should be calculated
and compared to the upper and lower acceptance criteria.</em>&rdquo; The approach
can be used to estimate the retest period or shelf life for a single batch
or for multiple batches. According to the guideline, &ldquo;<em>for a
drug substance or for a drug product available in a single strength and a
single container size and/or fill, the retest period or shelf life is
generally estimated based on the stability data from a minimum of three
batches.</em>&rdquo;
</p>
<p>Before performing the retest period or shelf life estimation with results
from multiple batches, the most suitable model should be determined. It
should particularly be verified if data of all test batches are poolable or
not. Details on this are described in section &ldquo;Checking batch
poolability&rdquo; below.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>expirest_osle</code>&rsquo; is returned,
containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>Data</code></td>
<td>
<p>Data frame of the original data including new columns with
transformed variables, if applicable.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>A list of the parameters with the elements <code>alpha</code>,
<code>alpha.pool</code>, <code>ivl</code>, <code>ivl.type</code> and <code>ivl.side</code>.</p>
</td></tr>
<tr><td><code>Variables</code></td>
<td>
<p>A list of the variable names, i.e. the original names of
<code>batch_vbl</code>, <code>time_vbl</code> and <code>response_vbl</code> and, if
applicable, of the transformed variables.</p>
</td></tr>
<tr><td><code>Model.Type</code></td>
<td>
<p>A list of two elements that specifies which model, based
on the ANCOVA analysis, suits best. The first element (<code>type.spec</code>)
is a numeric vector of length 2 that specifies the best model accepted at
the significance level specified by <code>alpha.pool</code>. The first number
represents the decision on the intercept and the second on the slope,
where <code>1</code> stands for &ldquo;common&rdquo; and <code>2</code> stands for
&ldquo;different&rdquo;. The second element (<code>type.acronym</code>) is an acronym
representing the first item.</p>
</td></tr>
<tr><td><code>Models</code></td>
<td>
<p>A list of four elements named <code>cics</code>, <code>dics</code>,
<code>dids.pmse</code> and <code>dids</code>. The first three elements contain the
&lsquo;<code>lm</code>&rsquo; objects of the &ldquo;common intercept / common slope&rdquo;
(<code>cics</code>), &ldquo;different intercept / common slope&rdquo; (<code>dics</code>)
and &ldquo;different intercept / different slope&rdquo; (<code>dids</code>) models.
The fourth element is a list of the &lsquo;<code>lm</code>&rsquo; objects that is
obtained from fitting a regression model to the data of each level of the
categorical variable separately. The <code>cics</code>, <code>dics</code> and
<code>dids.pmse</code> elements are <code>NA</code> if data of only a single batch
is available.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>A numeric named vector of the Akaike Information Criterion (AIC)
values of the <code>cics</code>, <code>dics</code> and <code>dids.pmse</code> models.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>A numeric named vector of the Bayesian Information Criterion (BIC)
values of each of the <code>cics</code>, <code>dics</code> and <code>dids.pmse</code>
models.</p>
</td></tr>
<tr><td><code>wc.icpt</code></td>
<td>
<p>A numeric named vector of the worst case intercepts. The
information about which limit the corresponding confidence interval
crosses is stored in the attribute named <code>side</code>.</p>
</td></tr>
<tr><td><code>wc.batch</code></td>
<td>
<p>A numeric named vector of the batches with the worst case
intercepts. The information about which limit the corresponding confidence
interval crosses is stored in the attribute named <code>side</code>.</p>
</td></tr>
<tr><td><code>Limits</code></td>
<td>
<p>A list of all limits.</p>
</td></tr>
<tr><td><code>Intercepts</code></td>
<td>
<p>A list of the intercepts of all models.</p>
</td></tr>
<tr><td><code>All.POI</code></td>
<td>
<p>A list of two elements named <code>lower</code> and <code>upper</code>
that contain either NA or lists of the POI values of all models.</p>
</td></tr>
<tr><td><code>POI</code></td>
<td>
<p>A numeric named vector of the POI values of the worst case
batches of each model. The information about which limit the corresponding
confidence interval crosses is stored in the attribute named <code>side</code>.</p>
</td></tr>
</table>


<h3>Checking batch poolability</h3>

<p>According to ICH Q1E guideline, construction of the 95% confidence interval
on the basis of the combined data of all test batches is allowed only if it
has been confirmed by aid of a statistical test whether the regression lines
from the different batches have a common slope and a common intercept. A
significance level of <code>alpha_pool = 0.25</code> should to be used for both
batch-related terms, and the test of the slopes has to precede the test of
the intercepts. From these tests, three possible models may be appropriate,
i.e.
</p>

<ul>
<li><p> a <em>common intercept / common slope</em> model (cics),
</p>
</li>
<li><p> a <em>different intercept / common slope</em> model (dics) or
</p>
</li>
<li><p> a <em>different intercept / different slope</em> model (dids).
</p>
</li></ul>

<p>The <em>common intercept / different slope</em> model (cids) is of limited
practical relevance because the corresponding model is missing an effect.
When slopes exhibit significant differences, comparing intercepts becomes
inconsequential. Moreover, while initial levels of different batches in a
manufacturing process might be relatively well-controlled, it is improbable
that these levels are identical. Consequently, if the model probabilities
associated with the intercepts and slopes suggest the appropriateness of
the cids model, the decision is taken in favour of a dids model.
The dids model has individual intercepts and individual slopes, and the
calculation of confidence intervals is based on the corresponding individual
mean square errors. The <em>different intercept / different slope</em> model
where the mean square error is pooled across batches is reported as
dids.pmse.
</p>
<p>These requirements can be checked by aid of an &ldquo;ANalysis of
COVAriance&rdquo; (ANCOVA) including the batch variable as main effect and as
<code class="reqn">batch \times time</code> interaction term. The full ANCOVA model
simultaneously tests all the effects, and non-significant effects can be
identified and removed for fitting of the final regression model that is
used for the estimation of the shelf life or retest period.
</p>
<p>The significance level (<code>alpha_pool = 0.25</code>, Type I error) is used to
increase the power of the test to detect cases where the data should not be
pooled. Setting <code>alpha_pool = 0.25</code> decreases the probability of
incorrectly concluding that stability data from multiple batches can be
pooled. On the other hand, though, it increases the probability of using a
single batch to determine expiry when pooling batches would be more
appropriate.
</p>


<h3>References</h3>

<p>International Council for Harmonisation of Technical Requirements for
Registration of Pharmaceuticals for Human (ICH), Harmonised Tripartite
Guideline, Evaluation of Stability Data Q1E, step 4, February 2003
(CPMP/ICH/420/02).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_wisle">expirest_wisle</a></code>, <code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a></code>,
<code><a href="stats.html#topic+uniroot">uniroot</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>,
<code><a href="stats.html#topic+AIC">AIC</a></code>, <code><a href="stats.html#topic+BIC">BIC</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Successful estimations
# A model with common intercepts / common slopes (cics)
res1 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")
res1$Model.Type
res1$POI

# Expected results in res1$Model.Type
# $type.spec
# common.icpt  common.slp
#           1           1
#
# $type.acronym
# [1] "cics"

# Expected results in res1$POI
#     cics      dics dids.pmse      dids
# 26.22410  24.80030  23.66724  23.34184
# attr(,"side")
#     cics      dics dids.pmse      dids
#  "lower"   "lower"   "lower"   "lower"

# The parameter settings sf_option = "loose" and ivl_side = "lower" (the
# default setting of ivl_side) cause the specification limit of 95.0
# (sl_sf = 3, i.e. 3 significant digits) to be reduced by 0.05, i.e. the
# actual specification limit is 94.95.

# A model with different intercepts / different slopes (dids)
res2 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b4", "b5", "b8"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")
res2$Model.Type
res2$POI

# Expected results in res2$Model.Type
# $type.spec
# common.icpt  common.slp
#           0           0
#
# $type.acronym
# [1] "dids"

# Expected results in res2$POI
#     cics      dics dids.pmse      dids
# 28.12518  22.47939  15.72348  15.96453
# attr(,"side")
#     cics      dics dids.pmse      dids
#  "lower"   "lower"   "lower"   "lower"

# Estimation where it is not know a priori which limit is crossed first, i.e.
# letting the estimation be done for both specification limits.
res3 &lt;-
  expirest_osle(
    data = exp3, response_vbl = "Moisture", time_vbl = "Month",
    batch_vbl = "Batch", sl = c(1.5, 3.5), sl_sf = c(2, 2),
    srch_range = c(0, 500), sf_option = "loose", ivl = "confidence",
    ivl_type = "two.sided", ivl_side = "both")
res3$Model.Type
res3$POI

# Expected results in res3$Model.Type
# $type.spec
# common.icpt  common.slp
#           1           1
#
# $type.acronym
# [1] "cics"

# Expected results in res3$POI
#     cics      dics dids.pmse      dids
# 46.85172  41.84802  22.41808  22.50966
# attr(,"side")
#     cics      dics dids.pmse      dids
#  "upper"   "upper"   "upper"   "lower"

# The parameter settings sf_option = "loose" and ivl_side = "both" (the
# default setting of ivl_side) cause the specification limits of 1.5 and 3.5
# (sl_sf = 2, i.e. 2 significant digits) to be reduced by 0.05 and increased
# by 0.04, respectively, i.e. the actual specification limits are 1.45 and
# 3.54, respectively.

# Analysis with a single batch
res4 &lt;-
  expirest_osle(
    data = exp3[exp3$Batch == "b1", ], response_vbl = "Moisture",
    time_vbl = "Month", batch_vbl = "Batch", sl = c(1.5, 3.5),
    sl_sf = c(2, 2), srch_range = c(0, 500), sf_option = "tight",
    ivl = "confidence", ivl_type = "two.sided", ivl_side = "both")

# Since only one batch is involved there is no model type. Nevertheless, the
# result is reported under the dids model name.
res4$Model.Type
res4$POI

# Expected results in res4$Model.Type
# $type.spec
# common.icpt  common.slp
#         NA           NA
#
# $type.acronym
# [1] "n.a."

# Expected results in res4$POI
# cics      dics dids.pmse      dids
#   NA        NA        NA  21.42596
# attr(,"side")
# cics      dics dids.pmse      dids
# "NA"      "NA"      "NA"   "lower"

# Unsuccessful estimations
## Not run: 
  # Intervals are wider than the specification limits (no intersection).
  res5 &lt;-
    expirest_osle(
      data = exp3, response_vbl = "Moisture", time_vbl = "Month",
      batch_vbl = "Batch", sl = 1.5, sl_sf = 2, srch_range = c(0, 500),
      sf_option = "tight", ivl = "prediction", ivl_type = "two.sided",
      ivl_side = "lower")
  res5$POI

  # (Expected) results in res5$POI
  #    cics      dics dids.pmse      dids
  #     NA        NA        NA        NA
  # attr(,"side")
  #    cics      dics dids.pmse      dids
  # "lower"   "lower"   "lower"   "lower"

  # Estimation may also fail because of an inappropriate 'srch_range' setting.
  res6 &lt;-
    expirest_osle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                  response_vbl = "Potency", time_vbl = "Month",
                  batch_vbl = "Batch", sl = 95, sl_sf = 3,
                  srch_range = c(0, 5))
  res6$POI

  # (Expected) results in res6$POI
  #    cics      dics dids.pmse      dids
  #     NA        NA        NA        NA
  # attr(,"side")
  #    cics      dics dids.pmse      dids
  # "lower"   "lower"   "lower"   "lower"

## End(Not run)
</code></pre>

<hr>
<h2 id='expirest_wisle'>What-if (approach for) shelf life estimation (wisle)</h2><span id='topic+expirest_wisle'></span>

<h3>Description</h3>

<p>Based on a linear regression model fitted to a stability data set the
function <code>expirest_wisle()</code> estimates the shelf life, or retest period,
for the specified release and specification limit following the ARGPM
guidance &ldquo;Stability testing for prescription medicines&rdquo;. The
abbreviation &ldquo;wisle&rdquo; stands for &ldquo;what-if shelf life estimation&rdquo;
(because it estimates the shelf life (&ldquo;what&rdquo;) for a given release
limit (&ldquo;if&rdquo;)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expirest_wisle(
  data,
  response_vbl,
  time_vbl,
  batch_vbl,
  rl,
  rl_sf,
  sl,
  sl_sf,
  srch_range,
  alpha = 0.05,
  alpha_pool = 0.25,
  xform = c("no", "no"),
  shift = c(0, 0),
  sf_option = "tight",
  ivl = "confidence",
  ivl_type = "one.sided",
  ivl_side = "lower",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expirest_wisle_+3A_data">data</code></td>
<td>
<p>A data frame with the columns specified by <code>response_vbl</code>,
<code>time_vbl</code> and <code>batch_vbl</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_response_vbl">response_vbl</code></td>
<td>
<p>A character string that specifies the response variable
name that must be a column of <code>data</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_time_vbl">time_vbl</code></td>
<td>
<p>A character string that specifies the time variable name
that must be a column of <code>data</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_batch_vbl">batch_vbl</code></td>
<td>
<p>A character string that specifies the column in <code>data</code>
with the grouping information (i.e. a factorial variable) for the
differentiation of the observations of the various batches.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_rl">rl</code></td>
<td>
<p>A numeric value or a numeric vector that specifies the release
specification limit(s) for which the corresponding expiry should be
estimated.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_rl_sf">rl_sf</code></td>
<td>
<p>A positive integer or a vector of positive integers that
specifies the number of &ldquo;significant figures&rdquo; (sf) of <code>rl</code>.
It must have the same length as <code>rl</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_sl">sl</code></td>
<td>
<p>A numeric value or a numeric vector of length <code>2</code> that
specifies the specification limit or limits. If a vector is provided it
must be of the form <code>c(lower limit, upper limit)</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_sl_sf">sl_sf</code></td>
<td>
<p>A positive integer or a vector of positive integers that
specifies the number of &ldquo;significant figures&rdquo; (sf) of <code>sl</code>.
It must have the same length as <code>sl</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_srch_range">srch_range</code></td>
<td>
<p>A vector of length <code>2</code> that specifies the end-points
of the (time) range that is supposed to contain the shelf life or retest
period.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value between 0 and 1 that specifies the significance
level for the calculation of confidence or prediction intervals. The
default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_alpha_pool">alpha_pool</code></td>
<td>
<p>A numeric value between 0 and 1 that specifies the type I
error rate for the test of the poolability of the batches. The default
is <code>0.25</code>, following ICH Q1E guideline. The value should not be
changed unless supported by well-founded reasons.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_xform">xform</code></td>
<td>
<p>A vector of two character strings that specifies the
transformation of the response and the time variable. The default is
&ldquo;no&rdquo; transformation, i.e. <code>c("no", "no")</code>, where the first
element specifies the transformation of the <code class="reqn">x</code> variable and the
second element the transformation of the <code class="reqn">y</code> variable. Valid
alternatives for <code class="reqn">x</code> and/or <code class="reqn">y</code> variable transformation are
<code>"log"</code> (natural logarithm), <code>"sqrt"</code> (square root) and
<code>"sq"</code> (square).</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_shift">shift</code></td>
<td>
<p>A vector of two values which will be added to the variables
<code class="reqn">x</code> and/or <code class="reqn">y</code> before they are transformed as specified by the
<code>xform</code> parameter, where the first element will be added to the
<code class="reqn">x</code> variable and the second element to the <code class="reqn">y</code> variable. The
purpose is to prevent an undefined state which could arise when variables
with values of <code class="reqn">\leq 0</code> are log or square root transformed. The
default is <code>c(0, 0)</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_sf_option">sf_option</code></td>
<td>
<p>A character string that specifies if the limits (<code>rl</code>
or <code>sl</code>) should be regarded as &ldquo;tight&rdquo; or &ldquo;loose&rdquo;, i.e.
either <code>"tight"</code> or <code>"loose"</code>, respectively. The default is
<code>"tight"</code>. The option <code>"tight"</code> means that the limits are
rounded to the number of significant digits specified by the parameters
<code>rl_sf</code> and <code>sl_sf</code>. If <code>sf_option = "loose"</code>, four on
the order of the last significant digit + 1 is added if
<code>ivl_side = "upper"</code> or five on the order of the last significant
digit + 1 is subtracted if <code>ivl_side = "upper"</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_ivl">ivl</code></td>
<td>
<p>A character string of either <code>"confidence"</code> or
<code>"prediction"</code> that specifies the type of interval of interest.
The default is <code>"confidence"</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_ivl_type">ivl_type</code></td>
<td>
<p>A character string that specifies if a &ldquo;one sided&rdquo;
or a &ldquo;two sided&rdquo; interval should be calculated, i.e. either
<code>"one.sided"</code> or <code>"two.sided"</code>, respectively. The default is
<code>"one.sided"</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_ivl_side">ivl_side</code></td>
<td>
<p>A character string that specifies if the &ldquo;upper&rdquo; or
the &ldquo;lower&rdquo; limit is the relevant limit, i.e. either <code>"upper"</code>
or <code>"lower"</code>, respectively. The default is <code>"lower"</code>. Since this
parameter additionally specifies the relationship of <code>rl</code> with
<code>sl</code>, i.e. which of the two sides of <code>sl</code> the <code>rl</code> is
compared to, only either either <code>"upper"</code> or <code>"lower"</code> is
possible. In this respect, the usage of <code>ivl_side</code> differs from its
usage in the <code>expirest_osle()</code> function where <code>ivl_side</code> in
addition can be <code>"both"</code>.</p>
</td></tr>
<tr><td><code id="expirest_wisle_+3A_...">...</code></td>
<td>
<p>Additional named or unnamed arguments passed on to
<code>uniroot()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the shelf life estimation for submissions in Australia the
Australian Regulatory Guidelines for Prescription Medicines (ARGPM), i.e.
the guidance &ldquo;Stability testing for prescription medicines&rdquo;, is
binding. In chapter 14.3.1, &ldquo;Predicting shelf life from stability
data&rdquo;, it is described how the estimation should be done. It recommends
to take the worst case situation at batch release into account. The
following examples are listed:
</p>

<dl>
<dt>1a)</dt><dd><p>For medicine that has a lower Assay release limit of 95 per cent
and a lower assay expiry limit of 90 per cent, the maximum decrease in
assay allowed over the shelf-life is 5 per cent.</p>
</dd>
<dt>2a)</dt><dd><p>Similarly, for a medicine that has a release limit for an
individual impurity of 0.2 per cent and an expiry limit of 0.5 per cent,
the maximum increase in the impurity allowed over the shelf life is
0.3 per cent.</p>
</dd>
<dt>1b)</dt><dd><p>For the same medicine, if the actual release assay result is
101 per cent, then the shelf life should be determined at the time the
medicine (or confidence interval of the regression line) decreases by
5 per cent and reaches 96 per cent, rather than the expiry limit
(90 per cent). This takes into account the possibility of batches being
released at the lower release limit (i.e. 95 per cent) and ensures they
will comply with the expiry limit throughout the shelf life.</p>
</dd>
<dt>2b)</dt><dd><p>Similarly, if the actual impurity content is 0.1 per cent at
batch release, the shelf life should be determined as the time the
95 per cent confidence interval reaches 0.4 per cent (i.e. increases by
0.3 per cent).</p>
</dd>
</dl>

<p>Consequently, it is necessary to define
</p>

<ul>
<li><p> a release limit and
</p>
</li>
<li><p> an expiry limit or shelf life limit (usually the specification limit).
</p>
</li></ul>

<p>If both of these limits were the same the shelf life would be zero, i.e. no
change allowed. <br />
</p>
<p>For the estimation of the shelf life or expiry limit it is necessary to find
the point where the upper or lower 95% confidence interval limit of the
linear model fitted to the data (by aid of <code>lm</code>) intersects the
&ldquo;worst case scenario limit&rdquo; (WCSL), which is defined by the ARGPM
guidance &ldquo;Stability testing for prescription medicines&rdquo; as the
intercept <code class="reqn">\pm</code> difference between the specification limit and the
release limit, where this differences is added (<code class="reqn">+</code>) if the upper limit
is relevant or it is subtracted (<code class="reqn">-</code>) if the lower limit is relevant.
In this package, this point is called the &ldquo;point of intersection&rdquo; or
&ldquo;point of interest&rdquo;, abbreviated POI.
</p>
<p>Before performing the retest period or shelf life estimation the most
suitable model should be determined. It should particularly be verified
if data of all test batches are poolable or not. Details on this are
described in section &ldquo;Checking batch poolability&rdquo; below.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>expirest_wisle</code>&rsquo; is returned,
containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>Data</code></td>
<td>
<p>Data frame of the original data including new columns with
transformed variables, if applicable.</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>A list of the parameters with the elements <code>alpha</code>,
<code>alpha.pool</code>, <code>ivl</code>, <code>ivl.type</code> and <code>ivl.side</code>.</p>
</td></tr>
<tr><td><code>Variables</code></td>
<td>
<p>A list of the variable names, i.e. the original names of
<code>batch_vbl</code>, <code>time_vbl</code> and <code>response_vbl</code> and, if
applicable, of the transformed variables.</p>
</td></tr>
<tr><td><code>Model.Type</code></td>
<td>
<p>A list of two elements that specifies which model, based
on the ANCOVA analysis, suits best. The first element (<code>type.spec</code>)
is a numeric vector of length 2 that specifies the best model accepted at
the significance level specified by <code>alpha.pool</code>. The first number
represents the decision on the intercept and the second on the slope,
where <code>1</code> stands for &ldquo;common&rdquo; and <code>2</code> stands for
&ldquo;different&rdquo;. The second element (<code>type.acronym</code>) is an acronym
representing the first item.</p>
</td></tr>
<tr><td><code>Models</code></td>
<td>
<p>A list of four elements named <code>cics</code>, <code>dics</code>,
<code>dids.pmse</code> and <code>dids</code>. The first three elements contain the
&lsquo;<code>lm</code>&rsquo; objects of the &ldquo;common intercept / common slope&rdquo;
(<code>cics</code>), &ldquo;different intercept / common slope&rdquo; (<code>dics</code>)
and &ldquo;different intercept / different slope&rdquo; (<code>dids</code>) models.
The fourth element is a list of the &lsquo;<code>lm</code>&rsquo; objects that is
obtained from fitting a regression model to the data of each level of the
categorical variable separately. The <code>cics</code>, <code>dics</code> and
<code>dids.pmse</code> elements are <code>NA</code> if data of only a single batch
is available.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>A numeric named vector of the Akaike Information Criterion (AIC)
values of the <code>cics</code>, <code>dics</code> and <code>dids.pmse</code> models.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>A numeric named vector of the Bayesian Information Criterion (BIC)
values of each of the <code>cics</code>, <code>dics</code> and <code>dids.pmse</code>
models.</p>
</td></tr>
<tr><td><code>wc.icpt</code></td>
<td>
<p>A data frame of the worst case intercepts of each of the
four fitted models.</p>
</td></tr>
<tr><td><code>wc.batch</code></td>
<td>
<p>A list of numeric value(s) of the worst case batch(es) per
model type.</p>
</td></tr>
<tr><td><code>Limits</code></td>
<td>
<p>A list of all limits.</p>
</td></tr>
<tr><td><code>POI</code></td>
<td>
<p>A data frame of the intercepts, the differences between release
and shelf life limits, the WCSLs, the expiry and release specification
limits, the shelf lives and POI values.</p>
</td></tr>
</table>
<p>Structure of the <code>POI</code> data frame:
</p>
<table role = "presentation">
<tr><td><code>Intercept.cics</code></td>
<td>
<p>The intercept of the worst case batch of the cics
model.</p>
</td></tr>
<tr><td><code>Intercept.dics</code></td>
<td>
<p>The intercept of the worst case batch of the dics
model.</p>
</td></tr>
<tr><td><code>Intercept.dids.pmse</code></td>
<td>
<p>The intercept of the worst case batch of the dids
model with pooled mean square error (pmse).</p>
</td></tr>
<tr><td><code>Intercept.dids</code></td>
<td>
<p>The intercept of the worst case batch of the dids
model obtained by fitting individual models to the data of each batch.</p>
</td></tr>
<tr><td><code>Delta.cics</code></td>
<td>
<p>Absolute difference between the release and and the shelf
life specification of the cics model.</p>
</td></tr>
<tr><td><code>Delta.dics</code></td>
<td>
<p>Absolute difference between the release and and the shelf
life specification of the dics model.</p>
</td></tr>
<tr><td><code>Delta.dids.pmse</code></td>
<td>
<p>Absolute difference between the release and and the
shelf life specification of the dids model with pooled mean square error
(pmse).</p>
</td></tr>
<tr><td><code>Delta.dids</code></td>
<td>
<p>Absolute difference between the release and and the shelf
life specification of the dids model obtained by fitting individual
models to the data of each batch.</p>
</td></tr>
<tr><td><code>WCSL.cics</code></td>
<td>
<p>WCSL of the cics model.</p>
</td></tr>
<tr><td><code>WCSL.dics</code></td>
<td>
<p>WCSL of the dics model.</p>
</td></tr>
<tr><td><code>WCSL.dids.pmse</code></td>
<td>
<p>WCSL of the dids model with pooled mean square error
(pmse).</p>
</td></tr>
<tr><td><code>WCSL.dids</code></td>
<td>
<p>WCSL of the dids model obtained by fitting individual
models to the data of each batch.</p>
</td></tr>
<tr><td><code>Exp.Spec</code></td>
<td>
<p>The (expiry) specification, i.e. the specification which is
relevant for the determination of the expiry.</p>
</td></tr>
<tr><td><code>Rel.Spec</code></td>
<td>
<p>The calculated release specification.</p>
</td></tr>
<tr><td><code>Shelf.Life.cics</code></td>
<td>
<p>The estimated shelf life of the cics model.</p>
</td></tr>
<tr><td><code>Shelf.Life.dics</code></td>
<td>
<p>The estimated shelf life of the dics model.</p>
</td></tr>
<tr><td><code>Shelf.Life.dids.pmse</code></td>
<td>
<p>The estimated shelf life of the dids model with
pooled mean square error (pmse).</p>
</td></tr>
<tr><td><code>Shelf.Life.dids</code></td>
<td>
<p>The estimated shelf life of the dids model obtained
by fitting individual models to the data of each batch.</p>
</td></tr>
<tr><td><code>POI.Model.cics</code></td>
<td>
<p>The POI of the cics model.</p>
</td></tr>
<tr><td><code>POI.Model.dics</code></td>
<td>
<p>The POI of the dics model.</p>
</td></tr>
<tr><td><code>POI.Model.dids.pmse</code></td>
<td>
<p>The POI of the dids model with pooled mean
square error (pmse).</p>
</td></tr>
<tr><td><code>POI.Model.dids</code></td>
<td>
<p>The POI of the dids model obtained by fitting
individual models to the data of each batch.</p>
</td></tr>
</table>


<h3>Checking batch poolability</h3>

<p>According to ICH Q1E guideline, construction of the 95% confidence interval
on the basis of the combined data of all test batches is allowed only if it
has been confirmed by aid of a statistical test whether the regression lines
from the different batches have a common slope and a common intercept. A
significance level of <code>alpha_pool = 0.25</code> should to be used for both
batch-related terms, and the test of the slopes has to precede the test of
the intercepts. From these tests, three possible models may be appropriate,
i.e.
</p>

<ul>
<li><p> a <em>common intercept / common slope</em> model (cics),
</p>
</li>
<li><p> a <em>different intercept / common slope</em> model (dics) or
</p>
</li>
<li><p> a <em>different intercept / different slope</em> model (dids).
</p>
</li></ul>

<p>The <em>common intercept / different slope</em> model (cids) is of limited
practical relevance because the corresponding model is missing an effect.
When slopes exhibit significant differences, comparing intercepts becomes
inconsequential. Moreover, while initial levels of different batches in a
manufacturing process might be relatively well-controlled, it is improbable
that these levels are identical. Consequently, if the model probabilities
associated with the intercepts and slopes suggest the appropriateness of
the cids model, the decision is taken in favour of a dids model.
The dids model has individual intercepts and individual slopes, and the
calculation of confidence intervals is based on the corresponding individual
mean square errors. The <em>different intercept / different slope</em> model
where the mean square error is pooled across batches is reported as
dids.pmse.
</p>
<p>These requirements can be checked by aid of an &ldquo;ANalysis of
COVAriance&rdquo; (ANCOVA) including the batch variable as main effect and as
<code class="reqn">batch \times time</code> interaction term. The full ANCOVA model
simultaneously tests all the effects, and non-significant effects can be
identified and removed for fitting of the final regression model that is
used for the estimation of the shelf life or retest period.
</p>
<p>The significance level (<code>alpha_pool = 0.25</code>, Type I error) is used to
increase the power of the test to detect cases where the data should not be
pooled. Setting <code>alpha_pool = 0.25</code> decreases the probability of
incorrectly concluding that stability data from multiple batches can be
pooled. On the other hand, though, it increases the probability of using a
single batch to determine expiry when pooling batches would be more
appropriate.
</p>


<h3>References</h3>

<p>Therapeutic Goods Administration (TGA) of the Department of Health of the
Australian Government, Australian Regulatory Guidelines for Prescription
Medicines (ARGPM), Stability testing for prescription medicines,
Version 1.1, March 2017
</p>
<p>International Council for Harmonisation of Technical Requirements for
Registration of Pharmaceuticals for Human (ICH), Harmonised Tripartite
Guideline, Evaluation of Stability Data Q1E, step 4, February 2003
(CPMP/ICH/420/02).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_osle">expirest_osle</a></code>, <code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a></code>,
<code><a href="stats.html#topic+uniroot">uniroot</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>,
<code><a href="stats.html#topic+AIC">AIC</a></code>, <code><a href="stats.html#topic+BIC">BIC</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Successful estimations
# A model with common intercepts / common slopes (cics)
res1 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")
res1$Model.Type
res1$POI

# Expected results in res1$Model.Type
# $type.spec
# common.icpt  common.slp
#           1           1
#
# $type.acronym
# [1] "cics"

# (Expected) results in res1$POI
# Intercept.cics Intercept.dics Intercept.dids Intercept.dids.pmse Delta.cics
#       100.5669       100.3638       100.2491            100.2491          3
# Delta.dics Delta.dids Delta.dids.pmse WCSL.cics WCSL.dics WCSL.dids
#          3          3               3  97.56688  97.36375  97.24914
# WCSL.dids.pmse Exp.Spec.Report Exp.Spec Rel.Spec.Report Rel.Spec
#       97.24914              95    94.95              98    97.95
# Shelf.Life.cics Shelf.Life.dics Shelf.Life.dids Shelf.Life.dids.pmse
#        14.07398        13.23176        13.34561             13.80695
# POI.Model.cics POI.Model.dics POI.Model.dids POI.Model.dids.pmse
#        26.2241        24.8003       23.34184            23.66724

# The parameter settings sf_option = "loose" and ivl_side = "lower" (the
# default setting of ivl_side) cause the specification limit of 95.0
# (sl_sf = 3, i.e. 3 significant digits) to be reduced by 0.05, i.e. the
# actual specification limit is 94.95. Analogously, the release limit of 98.0
# is reduced to 97.95.

# A model with different intercepts / different slopes (dids)
res2 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b4", "b5", "b8"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")
res2$Model.Type
res2$POI

# Expected results in res2$Model.Type
# $type.spec
# common.icpt  common.slp
#           0           0
#
# $type.acronym
# [1] "dids"

# (Expected) results in res2$POI
# Intercept.cics Intercept.dics Intercept.dids Intercept.dids.pmse Delta.cics
#       101.5498       100.4882       101.2594            101.2594          3
# Delta.dics Delta.dids Delta.dids.pmse WCSL.cics WCSL.dics WCSL.dids
#          3          3               3  98.54976  97.48822  98.25938
# WCSL.dids.pmse Exp.Spec.Report Exp.Spec Rel.Spec.Report Rel.Spec
#       98.25938              95    94.95              98    97.95
# Shelf.Life.cics Shelf.Life.dics Shelf.Life.dids Shelf.Life.dids.pmse
#        13.03332        11.42141        7.619661             7.483223
# POI.Model.cics POI.Model.dics POI.Model.dids POI.Model.dids.pmse
#       28.12518       22.47939       15.96453            15.72348

# Analysis with a single batch (i.e. the worst case batch of res2 above)
res3 &lt;-
  expirest_wisle(data = exp1[exp1$Batch == "b8", ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")
res3$Model.Type
res3$POI

# Since only one batch is involved there is no model type. Nevertheless, the
# result is reported under the dids model name.

# Expected results in res3$Model.Type
# $type.spec
# common.icpt  common.slp
#         NA           NA
#
# $type.acronym
# [1] "n.a."

# (Expected) results in res3$POI
# Intercept.cics Intercept.dics Intercept.dids Intercept.dids.pmse Delta.cics
#             NA             NA       101.2594                  NA         NA
# Delta.dics Delta.dids Delta.dids.pmse WCSL.cics WCSL.dics WCSL.dids
#         NA          3              NA        NA        NA  98.25938
# WCSL.dids.pmse Exp.Spec.Report Exp.Spec Rel.Spec.Report Rel.Spec
#             NA              95    94.95              98    97.95
# Shelf.Life.cics Shelf.Life.dics Shelf.Life.dids Shelf.Life.dids.pmse
#              NA              NA        7.619661                   NA
# POI.Model.cics POI.Model.dics POI.Model.dids POI.Model.dids.pmse
#             NA             NA       15.96453                  NA

# Unsuccessful estimation
## Not run: 
  # The interval does not cross the limit (i.e. not within srch_range).
  res4 &lt;-
    expirest_wisle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                   response_vbl = "Potency", time_vbl = "Month",
                   batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 105,
                   sl_sf = 4, srch_range = c(0, 500), sf_option = "loose",
                   ivl_side = "upper")
  res4$POI

  # (Expected) results in res3$POI
  # Intercept.cics Intercept.dics Intercept.dids Intercept.dids.pmse Delta.cics
  #       100.5669             NA             NA                  NA          3
  # Delta.dics Delta.dids Delta.dids.pmse WCSL.cics WCSL.dics WCSL.dids
  #         NA         NA              NA  107.5669        NA        NA
  # WCSL.dids.pmse Exp.Spec.Report Exp.Spec Rel.Spec.Report Rel.Spec
  #             NA             105   105.04              98    98.04
  # Shelf.Life.cics Shelf.Life.dics Shelf.Life.dids Shelf.Life.dids.pmse
  #              NA              NA              NA                   NA
  # POI.Model.cics POI.Model.dics POI.Model.dids POI.Model.dids.pmse
  #             NA             NA             NA                  NA

  # Estimation may also fail because of an inappropriate 'srch_range' setting.
  res5 &lt;-
    expirest_wisle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                   response_vbl = "Potency", time_vbl = "Month",
                   batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                   sl_sf = 3, srch_range = c(0, 5), sf_option = "loose")
  res5$POI

  # (Expected) results in res4$POI
  # Intercept.cics Intercept.dics Intercept.dids Intercept.dids.pmse Delta.cics
  #       100.5669             NA             NA                  NA          3
  # Delta.dics Delta.dids Delta.dids.pmse WCSL.cics WCSL.dics WCSL.dids
  #         NA         NA              NA  97.56688        NA        NA
  # WCSL.dids.pmse Exp.Spec.Report Exp.Spec Rel.Spec.Report Rel.Spec
  #             NA              95    94.95              98    97.95
  # Shelf.Life.cics Shelf.Life.dics Shelf.Life.dids Shelf.Life.dids.pmse
  #              NA              NA              NA                   NA
  # POI.Model.cics POI.Model.dics POI.Model.dids POI.Model.dids.pmse
  #             NA             NA             NA                  NA

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_expirest_osle'>Illustrating the ordinary shelf life estimate (osle)</h2><span id='topic+plot_expirest_osle'></span>

<h3>Description</h3>

<p>The function <code>plot_expirest_osle()</code> makes a graphical display of the
shelf life estimate done by the <code><a href="#topic+expirest_osle">expirest_osle</a>()</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_expirest_osle(
  model,
  show_grouping = "yes",
  response_vbl_unit = NULL,
  x_range = NULL,
  y_range = NULL,
  mtbs = "verified",
  plot_option = "full",
  ci_app = "line"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_expirest_osle_+3A_model">model</code></td>
<td>
<p>An &lsquo;<code>expirest_osle</code>&rsquo; object, i.e. a list returned
by the <code><a href="#topic+expirest_osle">expirest_osle</a>()</code> function.</p>
</td></tr>
<tr><td><code id="plot_expirest_osle_+3A_show_grouping">show_grouping</code></td>
<td>
<p>'r lifecycle::badge(&quot;deprecated&quot;)'
'show_grouping = \&quot;yes\&quot; or \&quot;no\&quot;' is no longer supported. Use the
<code>mtbs</code> parameter instead which allows choosing a specific model,
i.e. also the <em>common intercept / common slope case</em> model which
was the default model when <code>show_grouping</code> was <code>"no"</code>.</p>
</td></tr>
<tr><td><code id="plot_expirest_osle_+3A_response_vbl_unit">response_vbl_unit</code></td>
<td>
<p>A character string that specifies the unit
associated with the response variable. The default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_expirest_osle_+3A_x_range">x_range</code></td>
<td>
<p>A numeric vector of the form <code>c(min, max)</code> that
specifies the range of the time variable to be plotted. The default is
<code>NULL</code> and the <code class="reqn">x</code> range is calculated automatically on the basis
of the estimated shelf life.</p>
</td></tr>
<tr><td><code id="plot_expirest_osle_+3A_y_range">y_range</code></td>
<td>
<p>A numeric vector of the form <code>c(min, max)</code> that
specifies the range of the response variable to be plotted. The default
is <code>NULL</code> and the <code class="reqn">y</code> range is calculated automatically on the
basis of the time course of the response.</p>
</td></tr>
<tr><td><code id="plot_expirest_osle_+3A_mtbs">mtbs</code></td>
<td>
<p>A character string that specifies the &ldquo;model to be shown&rdquo;,
i.e. either <code>verified</code>, which is the default, or one of <code>cics</code>,
<code>dics</code>, <code>dids</code> or <code>dids.pmse</code>. The <code>verified</code> model
is the model that was identified through the poolability check. It is
thus also one of the possible optional models. The <code>dids</code> model
represents the case where a separate model is fitted to the data of each
individual batch while the <code>dids.pmse</code> model is the interaction
model which includes the <code class="reqn">batch</code> variable as main effect and in the
interaction term with the <code class="reqn">time</code> variable (<code class="reqn">batch \times time</code>),
i.e. a model where the mean square error is pooled across batches.</p>
</td></tr>
<tr><td><code id="plot_expirest_osle_+3A_plot_option">plot_option</code></td>
<td>
<p>A character string of either <code>"full"</code> or
<code>"lean"</code> that specifies if additional information should be put out
on the plot (option <code>"full"</code>) or only basic information (option
<code>"lean"</code>), i.e. the data points, the fitted regression line with
the confidence interval, the specification limit(s) and the estimated
shelf life limit(s). The default is <code>"full"</code>.</p>
</td></tr>
<tr><td><code id="plot_expirest_osle_+3A_ci_app">ci_app</code></td>
<td>
<p>A character string of either <code>"line"</code> or <code>"ribbon"</code>,
that specifies the appearance of the confidence interval, i.e. if the
limits should be plotted as lines (option <code>"line"</code>) or as a shaded
ribbon (option <code>"ribbon"</code>). The default is <code>"line"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>plot_expirest_osle()</code> uses the data and the
information about the linear model that was used for the estimation of
the shelf life by aid of the <code><a href="#topic+expirest_osle">expirest_osle</a>()</code> function. It
plots a graph of the time course of a parameter, a linear regression line
fitted to the data and the associated confidence or prediction interval.
In addition, it shows features of the shelf life estimation.
</p>
<p>For plotting, the <code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function from the
&lsquo;<code>ggplot2</code>&rsquo; package is used. The various arguments can be
used to control the appearance of the plot. The &lsquo;<code>ggplot2</code>&rsquo;
object of the generated plot is contained in the <code>Graph</code> element of
the list that is returned by <code><a href="#topic+plot_expirest_osle">plot_expirest_osle</a>()</code> and can be
used to modify the appearance of the graph.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>plot_expirest_osle</code>&rsquo; is returned
invisibly consisting of the following elements:
</p>
<table role = "presentation">
<tr><td><code>Model</code></td>
<td>
<p>The &lsquo;<code>expirest_osle</code>&rsquo; object that was passed via
the <code>model</code> argument.</p>
</td></tr>
<tr><td><code>Expiry</code></td>
<td>
<p>A data frame of type <code>expiry</code>.</p>
</td></tr>
<tr><td><code>Graph</code></td>
<td>
<p>A &lsquo;<code>ggplot2</code>&rsquo; object for the graphical display.</p>
</td></tr>
<tr><td><code>Prediction</code></td>
<td>
<p>A data frame of the predicted values.</p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>A data frame of the text elements on the plot.</p>
</td></tr>
<tr><td><code>hlines</code></td>
<td>
<p>A data frame of the horizontal line elements on the plot.</p>
</td></tr>
<tr><td><code>vlines</code></td>
<td>
<p>A data frame of the vertical line elements on the plot.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_osle">expirest_osle</a></code>, <code><a href="#topic+expirest_wisle">expirest_wisle</a></code>,
<code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Start by making an "ordinary shelf life estimation" (osle).
res1 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")

# Pass the 'expirest_osle' object on to the plot_expirest_osle() function.
# This function does not produce any output. It returns a 'plot_expirest_osle'
# object that is essentially an 'expirest_osle' object augmented by a 'ggplot'
# object.
gg1 &lt;- plot_expirest_osle(
  model = res1, response_vbl_unit = "%", x_range = NULL, y_range = c(93, 105),
  mtbs = "verified", plot_option = "full", ci_app = "line")
## Not run: 
  gg1

  # Since the element gg1$Graph is a 'ggplot' object it can be used for further
  # manipulation by aid of 'ggplot2' functions.
  if (requireNamespace("ggplot2")) {
    library(ggplot2)

    gg1$Graph + labs(title = "Ordinary Shelf Life Estimation (OSLE)",
                     x = "Time [months]", y = "Potency [% LC]") +
      scale_x_continuous(limits = c(-1, 31), breaks = seq(0, 30, 6))
  }

## End(Not run)

# Repeat this for a different intercept / different slope (dids) model.
res2 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b4", "b5", "b8"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")

gg2 &lt;- plot_expirest_osle(
  model = res2, response_vbl_unit = "%", x_range = c(0, 43),
  y_range = c(83, 107), mtbs = "verified", plot_option = "full",
  ci_app = "ribbon")
## Not run: 
  gg2

## End(Not run)

# In case of different intercept / different slope models, individually fit
# linear models are shown by default, i.e. with the 'mtbs' parameter set
# as "verified". To get the different intercept / different slope model
# displayed where the mean square error is pooled across batches, i.e. the
# dids.pmse model, the 'mtbs' parameter has to be set accordingly.

gg3 &lt;- plot_expirest_osle(
  model = res2, response_vbl_unit = "%", x_range = c(0, 43),
  y_range = c(83, 107), mtbs = "dids.pmse", plot_option = "full",
  ci_app = "ribbon")
## Not run: 
  gg3

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_expirest_wisle'>Illustrating the what-if (approach for) shelf life estimate (wisle)</h2><span id='topic+plot_expirest_wisle'></span>

<h3>Description</h3>

<p>The function <code>plot_expirest_wisle()</code> makes a graphical display of the
shelf life estimate done by the <code><a href="#topic+expirest_wisle">expirest_wisle</a>()</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_expirest_wisle(
  model,
  rl_index = 1,
  show_grouping = "yes",
  response_vbl_unit = NULL,
  x_range = NULL,
  y_range = NULL,
  scenario = "standard",
  mtbs = "verified",
  plot_option = "full",
  ci_app = "line"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_expirest_wisle_+3A_model">model</code></td>
<td>
<p>An &lsquo;<code>expirest_wisle</code>&rsquo; object, i.e. a list returned
by the <code><a href="#topic+expirest_wisle">expirest_wisle</a>()</code> function.</p>
</td></tr>
<tr><td><code id="plot_expirest_wisle_+3A_rl_index">rl_index</code></td>
<td>
<p>A positive integer that specifies which of the release limit
values that have been handed over to <code><a href="#topic+expirest_wisle">expirest_wisle</a>()</code> should
be displayed. The default value is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot_expirest_wisle_+3A_show_grouping">show_grouping</code></td>
<td>
<p>'r lifecycle::badge(&quot;deprecated&quot;)'
'show_grouping = \&quot;yes\&quot; or \&quot;no\&quot;' is no longer supported. Use the
<code>mtbs</code> parameter instead which allows choosing a specific model,
i.e. also the <em>common intercept / common slope case</em> model which
was the default model when <code>show_grouping</code> was <code>"no"</code>.</p>
</td></tr>
<tr><td><code id="plot_expirest_wisle_+3A_response_vbl_unit">response_vbl_unit</code></td>
<td>
<p>A character string that specifies the unit
associated with the response variable. The default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_expirest_wisle_+3A_x_range">x_range</code></td>
<td>
<p>A numeric vector of the form <code>c(min, max)</code> that
specifies the range of the time variable to be plotted. The default is
<code>NULL</code> and the <code class="reqn">x</code> range is calculated automatically on the basis
of the estimated shelf life.</p>
</td></tr>
<tr><td><code id="plot_expirest_wisle_+3A_y_range">y_range</code></td>
<td>
<p>A numeric vector of the form <code>c(min, max)</code> that
specifies the range of the response variable to be plotted. The default
is <code>NULL</code> and the <code class="reqn">y</code> range is calculated automatically on the
basis of the time course of the response.</p>
</td></tr>
<tr><td><code id="plot_expirest_wisle_+3A_scenario">scenario</code></td>
<td>
<p>A character string that specifies if the plot should be
extended (with respect to the <code class="reqn">x</code> axis) up to the &ldquo;standard
scenario&rdquo; (<code>"standard"</code>) or up to the &ldquo;worst case scenario&rdquo;
(<code>"worst"</code>). The default is <code>"standard"</code>.</p>
</td></tr>
<tr><td><code id="plot_expirest_wisle_+3A_mtbs">mtbs</code></td>
<td>
<p>A character string that specifies the &ldquo;model to be shown&rdquo;,
i.e. either <code>verified</code>, which is the default, or one of <code>cics</code>,
<code>dics</code>, <code>dids</code> or <code>dids.pmse</code>. The <code>verified</code> model
is the model that was identified through the poolability check. It is
thus also one of the possible optional models. The <code>dids</code> model
represents the case where a separate model is fitted to the data of each
individual batch while the <code>dids.pmse</code> model is the interaction
model which includes the <code class="reqn">batch</code> variable as main effect and in the
interaction term with the <code class="reqn">time</code> variable (<code class="reqn">batch \times time</code>),
i.e. a model where the mean square error is pooled across batches.</p>
</td></tr>
<tr><td><code id="plot_expirest_wisle_+3A_plot_option">plot_option</code></td>
<td>
<p>A character string of either <code>"full"</code>,
<code>"lean1"</code>, <code>"lean2"</code>, <code>"basic1"</code> and <code>"basic2"</code>
that specifies if additional information should be shown in the plot
(option <code>"full"</code>) or only basic information (options <code>"lean"</code>
and <code>"basic"</code>). Full means the data points, the fitted regression
line with the confidence or prediction interval, the specification
limit(s) and the estimated shelf life. The default is <code>"full"</code>.</p>
</td></tr>
<tr><td><code id="plot_expirest_wisle_+3A_ci_app">ci_app</code></td>
<td>
<p>A character string of either <code>"line"</code> or <code>"ribbon"</code>,
that specifies the appearance of the confidence interval, i.e. if the
limits should be plotted as lines (option <code>"line"</code>) or as a shaded
ribbon (option <code>"ribbon"</code>). The default is <code>"line"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>plot_expirest_wisle()</code> uses the data and the
information about the linear model that was used for the estimation of
the shelf life by aid of the <code><a href="#topic+expirest_wisle">expirest_wisle</a>()</code> function. It
plots a graph of the time course of a parameter, a linear regression line
fitted to the data and the associated confidence or prediction interval.
In addition, it shows features of the worst case scenario shelf life
estimation.
</p>
<p>For plotting, the <code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function from the
&lsquo;<code>ggplot2</code>&rsquo; package is used. The various arguments can be
used to control the appearance of the plot. The &lsquo;<code>ggplot2</code>&rsquo;
object of the generated plot is contained in the <code>Graph</code> element of
the list that is returned by <code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a>()</code> and can be
used to modify the appearance of the graph.
</p>


<h3>Value</h3>

<p>An object of class &lsquo;<code>plot_expirest_wisle</code>&rsquo; is returned
invisibly consisting of the following elements:
</p>
<table role = "presentation">
<tr><td><code>Model</code></td>
<td>
<p>The &lsquo;<code>expirest_wisle</code>&rsquo; object that was passed via
the <code>model</code> argument.</p>
</td></tr>
<tr><td><code>Expiery</code></td>
<td>
<p>A data frame of type <code>expiry</code>.</p>
</td></tr>
<tr><td><code>Graph</code></td>
<td>
<p>A &lsquo;<code>ggplot2</code>&rsquo; object for the graphical display.</p>
</td></tr>
<tr><td><code>Prediction</code></td>
<td>
<p>A data frame of the predicted values.</p>
</td></tr>
<tr><td><code>text</code></td>
<td>
<p>A data frame of the text elements on the plot.</p>
</td></tr>
<tr><td><code>hlines</code></td>
<td>
<p>A data frame of the horizontal line elements on the plot.</p>
</td></tr>
<tr><td><code>vlines</code></td>
<td>
<p>A data frame of the vertical line elements on the plot.</p>
</td></tr>
<tr><td><code>segments</code></td>
<td>
<p>A data frame of segment line elements on the plot.</p>
</td></tr>
<tr><td><code>arrow</code></td>
<td>
<p>A data frame of arrow elements on the plot.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_wisle">expirest_wisle</a></code>, <code><a href="#topic+expirest_osle">expirest_osle</a></code>,
<code><a href="#topic+plot_expirest_osle">plot_expirest_osle</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Start by making a "what-if (approach for) shelf life estimation" (wisle)
res1 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

# Pass the 'expirest_wisle' object on to the plot_expirest_wisle() function.
# This function does not produce any output. It returns a 'plot_expirest_wisle'
# object that is essentially an 'expirest_wisle' object augmented by a 'ggplot'
# object.
gg1 &lt;- plot_expirest_wisle(
  model = res1, rl_index = 1, response_vbl_unit = "%", x_range = NULL,
  y_range = c(93, 105), scenario = "standard", mtbs = "verified",
  plot_option = "full", ci_app = "line")

## Not run: 
  gg1

  # Since the element gg1$Graph is a 'ggplot' object it can be used for further
  # manipulation by aid of 'ggplot2' functions.
  if (requireNamespace("ggplot2")) {
    library(ggplot2)

    gg1$Graph + labs(title = "What-if Shelf Life Estimation (WISLE)",
                     x = "Time [months]", y = "Potency [% LC]") +
      scale_x_continuous(limits = c(-5, 31), breaks = seq(0, 30, 6))
  }

## End(Not run)

# Repeat this for a different intercept / different slope (dids) model.
res2 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b4", "b5", "b8"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

gg2 &lt;- plot_expirest_wisle(
  model = res2, rl_index = 1, response_vbl_unit = "%", x_range = c(0, 26),
  y_range = c(89, 107),  scenario = "standard",  mtbs = "verified",
  plot_option = "full", ci_app = "ribbon")
## Not run: 
  gg2

## End(Not run)

# In case of different intercept / different slope models, individually fit
# linear models are shown by default, i.e. with the 'mtbs' parameter set
# as "verified". To get the different intercept / different slope model
# displayed where the mean square error is pooled across batches, i.e. the
# dids.pmse model, the 'mtbs' parameter has to be set accordingly.

gg3 &lt;- plot_expirest_wisle(
  model = res2, rl_index = 1, response_vbl_unit = "%", x_range = c(0, 26),
  y_range = c(89, 107),  scenario = "standard",  mtbs = "dids.pmse",
  plot_option = "full", ci_app = "ribbon")
## Not run: 
  gg3

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.plot_expirest_osle'>Plot illustrating the shelf life estimation (osle)</h2><span id='topic+plot.plot_expirest_osle'></span>

<h3>Description</h3>

<p>This is a method for the function <code>plot()</code> for objects of class
&lsquo;<code>plot_expirest_osle</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plot_expirest_osle'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.plot_expirest_osle_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>plot_expirest_osle</code>&rsquo; returned by
the <code><a href="#topic+plot_expirest_osle">plot_expirest_osle</a>()</code> function.</p>
</td></tr>
<tr><td><code id="plot.plot_expirest_osle_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The element <code>Graph</code> of the &lsquo;<code>plot_expirest_osle</code>&rsquo;
object that is returned by the function <code><a href="#topic+plot_expirest_osle">plot_expirest_osle</a>()</code>
is an object of class &lsquo;<code>ggplot</code>&rsquo;, generated by the function
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> from the &lsquo;<code>ggplot2</code>&rsquo; package.
Thus, the corresponding <code>plot</code> method is used for plotting. Arguments
to the <code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function can be passed via the
<code>...</code> parameter.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>plot_expirest_osle</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_osle">expirest_osle</a></code>, <code><a href="#topic+plot_expirest_osle">plot_expirest_osle</a></code>,
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Performing an "ordinary shelf life estimation" (osle)
res1 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")

# The 'expirest_osle' object can be passed on to the plot_expirest_osle()
# function. This function does not produce any output but returns a
# 'plot_expirest_osle' object.
## Not run: 
  gg1 &lt;- plot_expirest_osle(
    model = res1, response_vbl_unit = "%", x_range = NULL, y_range = c(93, 105),
    mtbs = "verified", plot_option = "full", ci_app = "line")
  gg2 &lt;- plot(gg1)

  # The plot() function returns the 'plot_expirest_osle' object invisibly.
  class(gg1)
  class(gg2)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.plot_expirest_wisle'>Plot illustrating the what-if shelf life estimation (wisle)</h2><span id='topic+plot.plot_expirest_wisle'></span>

<h3>Description</h3>

<p>This is a method for the function <code>plot()</code> for objects of class
&lsquo;<code>plot_expirest_wisle</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plot_expirest_wisle'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.plot_expirest_wisle_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>plot_expirest_wisle</code>&rsquo; returned by
the <code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a>()</code> function.</p>
</td></tr>
<tr><td><code id="plot.plot_expirest_wisle_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The element <code>Graph</code> of the &lsquo;<code>plot_expirest_wisle</code>&rsquo;
object that is returned by the function <code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a>()</code>
is an object of class &lsquo;<code>ggplot</code>&rsquo;, generated by the function
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> from the &lsquo;<code>ggplot2</code>&rsquo; package.
Thus, the corresponding <code>plot</code> method is used for plotting. Arguments
to the <code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function can be passed via the
<code>...</code> parameter.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>plot_expirest_wisle</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_wisle">expirest_wisle</a></code>, <code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a></code>,
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Performing a "what-if (approach for) shelf life estimation" (wisle)
res1 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

# The 'expirest_wisle' object can be passed on to the plot_expirest_wisle()
# function. This function does not produce any output but returns a
# 'plot_expirest_wisle' object.
## Not run: 
  gg1 &lt;- plot_expirest_wisle(
    model = res1, rl_index = 1, response_vbl_unit = "%", x_range = NULL,
    y_range = c(93, 105), scenario = "standard", mtbs = "verified",
    plot_option = "full", ci_app = "line")
  gg2 &lt;- plot(gg1)

  # The plot() function returns the 'plot_expirest_wisle' object invisibly.
  class(gg1)
  class(gg2)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.expirest_osle'>Print a summary of the shelf life estimation (osle)</h2><span id='topic+print.expirest_osle'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects of class
&lsquo;<code>expirest_osle</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'expirest_osle'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.expirest_osle_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>expirest_osle</code>&rsquo; returned by
the <code><a href="#topic+expirest_osle">expirest_osle</a>()</code> function.</p>
</td></tr>
<tr><td><code id="print.expirest_osle_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code><a href="#topic+expirest_osle">expirest_osle</a>()</code> estimates the shelf
life, or retest period, following the ICH Q1E guideline. By default, batch
poolability is checked as recommended by the guideline at a significance
level of 0.25. Other levels can be used, although not recommended, by
changing the default of the <code>alpha_pool</code> parameter. Three possible
models may be appropriate, i.e.
</p>

<ul>
<li><p> a <em>common intercept / common slope</em> model (cics),
</p>
</li>
<li><p> a <em>different intercept / common slope</em> model (dics) or
</p>
</li>
<li><p> a <em>different intercept / different slope</em> model (dids).
</p>
</li></ul>

<p>The worst case intercept is the intercept of the batch whose confidence
limit is the first crossing the acceptance limit. As in case of the
<code>cics</code> model type all batches have a common intercept and a common
confidence interval, all batches can be regarded as equally worst case. In
case of the <code>dids</code> model type, shelf life estimation is done using the
models obtained from fitting the data of each batch individually.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>expirest_osle</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_osle">expirest_osle</a></code>, <code><a href="#topic+expirest_wisle">expirest_wisle</a></code>,
<code><a href="base.html#topic+formatC">formatC</a></code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit models of different type
res1 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")
res2 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b3", "b4", "b5"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")
res3 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b4", "b5", "b8"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")

# The parameter settings sf_option = "loose" and ivl_side = "lower" (the
# default setting of ivl_side) cause the specification limit of 95.0
# (sl_sf = 3, i.e. 3 significant digits) to be reduced by 0.05, i.e. the
# actual specification limit is 94.95.

## Not run: 
  res1
  # Expected output of print(res1)
  # Summary of shelf life estimation following the ICH Q1E guideline
  #
  # The best model accepted at a significance level of 0.25 has
  # Common intercepts and Common slopes (acronym: cics).
  #
  # Worst case intercept: 100.5669 (Potency)
  # Worst case batch: NA
  # Estimated shelf life for cics model:  26.2241 (Month)
  #
  # Worst case intercepts, POIs and batches of all models
  # (Including information about the side where the confidence
  #   interval crosses the specification boundary):
  #           Intercept      POI  Side Batch
  # cics       100.5669  26.2241 lower    NA
  # dics       100.3638  24.8003 lower    b2
  # dids.pmse  100.7819 23.66724 lower    b5
  # dids       100.7819 23.34184 lower    b5

  res2
  # Expected output of print(res2)
  # Summary of shelf life estimation following the ICH Q1E guideline
  #
  # The best model accepted at a significance level of 0.25 has
  # Different intercepts and Common slopes (acronym: dics).
  #
  # Worst case intercept:   100.82 (Potency)
  # Worst case batch: b5
  # Estimated shelf life for dics model: 23.60194 (Month)
  #
  # Worst case intercepts, POIs and batches of all models
  # (Including information about the side where the confidence
  #   interval crosses the specification boundary):
  #           Intercept      POI  Side Batch
  # cics       102.0513 29.18093 lower    NA
  # dics         100.82 23.60194 lower    b5
  # dids.pmse  100.7819 22.49726 lower    b5
  # dids       102.3841 23.26251 lower    b3

  res3
  # Expected output of print(res3)
  # Summary of shelf life estimation following the ICH Q1E guideline
  #
  # The best model accepted at a significance level of 0.25 has
  # Different intercepts and Different slopes (acronym: dids).
  #
  # Worst case intercept: 101.2594 (Potency)
  # Worst case batch: b8
  # Estimated shelf life for dids model: 15.96453 (Month)
  #
  # Worst case intercepts, POIs and batches of all models
  # (Including information about the side where the confidence
  #   interval crosses the specification boundary):
  #           Intercept      POI  Side Batch
  # cics       101.5498 28.12518 lower    NA
  # dics       100.4882 22.47939 lower    b8
  # dids.pmse  101.2594 15.72348 lower    b8
  # dids       101.2594 15.96453 lower    b8

## End(Not run)
</code></pre>

<hr>
<h2 id='print.expirest_wisle'>Print a summary of the what-if shelf life estimation (wisle)</h2><span id='topic+print.expirest_wisle'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects of class
&lsquo;<code>expirest_wisle</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'expirest_wisle'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.expirest_wisle_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>expirest_wisle</code>&rsquo; returned by
the <code>expirest_wisle()</code> function.</p>
</td></tr>
<tr><td><code id="print.expirest_wisle_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code><a href="#topic+expirest_wisle">expirest_wisle</a>()</code> estimates the expiry
for the specified release and specification limit following the ARGPM
guidance &ldquo;Stability testing for prescription medicines&rdquo;. By default,
batch poolability is checked as recommended by the ICH Q1E guideline at a
significance level of 0.25. Other levels can be used, although not
recommended, by changing the default of the <code>alpha_pool</code> parameter.
Three possible models may be appropriate, i.e.
</p>

<ul>
<li><p> a <em>common intercept / common slope</em> model (cics),
</p>
</li>
<li><p> a <em>different intercept / common slope</em> model (dics) or
</p>
</li>
<li><p> a <em>different intercept / different slope</em> model (dids).
</p>
</li></ul>

<p>The worst case intercept is the intercept of the batch whose confidence
limit is the first crossing the acceptance limit. As in case of the
<code>cics</code> model type all batches have a common intercept and a common
confidence interval, all batches can be regarded as equally worst case. In
case of the <code>dids</code> model type, shelf life estimation is done using the
models obtained from fitting the data of each batch individually. In
addition to the shelf life estimated according to the ARGPM also the
estimate according to ICH Q1E is shown.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>expirest_wisle</code>&rsquo; object passed to the
<code>x</code> parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_wisle">expirest_wisle</a></code>, <code><a href="#topic+expirest_osle">expirest_osle</a></code>,
<code><a href="base.html#topic+formatC">formatC</a></code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit models of different type
res1 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

res2 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b3", "b4", "b5"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")
res3 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b4", "b5", "b8"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

# The parameter settings sf_option = "loose" and ivl_side = "lower" (the
# default setting of ivl_side) cause the specification limit of 95.0
# (sl_sf = 3, i.e. 3 significant digits) to be reduced by 0.05, i.e. the
# actual specification limit is 94.95.

## Not run: 
  res1
  # Expected output of print(res1)
  # Summary of shelf life estimation following the ARGPM
  # guidance "Stability testing for prescription medicines"
  #
  # The best model accepted at a significance level of 0.25 has
  # Common intercepts and Common slopes (acronym: cics).
  #
  # Worst case intercept and batch:
  #   RL Batch Intercept
  # 1 98    NA  100.5669
  #
  # Estimated shelf lives for the cics model:
  #   SL RL    wisle    osle
  # 1 95 98 14.07398 26.2241
  #
  # Abbreviations:
  #   ARGPM: Australian Regulatory Guidelines for Prescription Medicines;
  #   ICH: International Council for Harmonisation;
  #   osle: Ordinary shelf life estimation (i.e. following the ICH guidance);
  #   RL: Release Limit;
  #   SL: Specification Limit;
  #   wisle: What-if (approach for) shelf life estimation (see ARGPM guidance).

  res2
  # Expected output of print(res2)
  # Summary of shelf life estimation following the ARGPM
  # guidance "Stability testing for prescription medicines"
  #
  # The best model accepted at a significance level of 0.25 has
  # Different intercepts and Common slopes (acronym: dics).
  #
  # Worst case intercept and batch:
  #   RL Batch Intercept
  # 1 98    b5    100.82
  #
  # Estimated shelf lives for the dics model:
  #   SL RL    wisle     osle
  # 1 95 98 11.40993 23.60194
  #
  # Abbreviations:
  #   ARGPM: Australian Regulatory Guidelines for Prescription Medicines;
  #   ICH: International Council for Harmonisation;
  #   osle: Ordinary shelf life estimation (i.e. following the ICH guidance);
  #   RL: Release Limit;
  #   SL: Specification Limit;
  #   wisle: What-if (approach for) shelf life estimation (see ARGPM guidance).

  res3
  # Expected output of print(res3)
  # Summary of shelf life estimation following the ARGPM
  #   guidance "Stability testing for prescription medicines"
  #
  # The best model accepted at a significance level of 0.25 has
  #  Different intercepts and Different slopes (acronym: dids).
  #
  # Worst case intercept and batch:
  #   RL Batch Intercept
  # 1 98    b8  101.2594
  #
  # Estimated shelf lives for the dids model (for information, the results of
  #   the model fitted with pooled mean square error (pmse) are also shown:
  #   SL RL    wisle wisle (pmse)     osle osle (pmse)
  # 1 95 98 7.619661     7.483223 15.96453    15.72348
  #
  # Abbreviations:
  #   ARGPM: Australian Regulatory Guidelines for Prescription Medicines;
  #   ICH: International Council for Harmonisation;
  #   osle: Ordinary shelf life estimation (i.e. following the ICH guidance);
  #   pmse: Pooled mean square error;
  #   RL: Release Limit;
  #   SL: Specification Limit;
  #   wisle: What-if (approach for) shelf life estimation (see ARGPM guidance).

## End(Not run)
</code></pre>

<hr>
<h2 id='print.plot_expirest_osle'>Print a plot illustrating the shelf life estimation (osle)</h2><span id='topic+print.plot_expirest_osle'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects of class
&lsquo;<code>plot_expirest_osle</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plot_expirest_osle'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.plot_expirest_osle_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>plot_expirest_osle</code>&rsquo; returned by
the <code><a href="#topic+plot_expirest_osle">plot_expirest_osle</a>()</code> function.</p>
</td></tr>
<tr><td><code id="print.plot_expirest_osle_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The element <code>Graph</code> of the &lsquo;<code>plot_expirest_osle</code>&rsquo;
object that is returned by the function <code><a href="#topic+plot_expirest_osle">plot_expirest_osle</a>()</code>
is an object of class &lsquo;<code>ggplot</code>&rsquo;, generated by the function
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> from the &lsquo;<code>ggplot2</code>&rsquo; package.
Thus, the corresponding <code>plot</code> method is used for plotting. Arguments
to the <code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function can be passed via the
<code>...</code> parameter.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>plot_expirest_osle</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_osle">expirest_osle</a></code>, <code><a href="#topic+plot_expirest_osle">plot_expirest_osle</a></code>,
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Performing an "ordinary shelf life estimation" (osle)
res1 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")

# The 'expirest_osle' object can be passed on to the plot_expirest_osle()
# function. This function does not produce any output but returns a
# 'plot_expirest_osle' object.
## Not run: 
  gg1 &lt;- plot_expirest_osle(
    model = res1, response_vbl_unit = "%", x_range = NULL, y_range = c(93, 105),
    mtbs = "verified", plot_option = "full", ci_app = "line")
  gg2 &lt;- print(gg1)

  # The print() function returns the 'plot_expirest_osle' object invisibly.
  class(gg1)
  class(gg2)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.plot_expirest_wisle'>Print a plot illustrating the what-if shelf life estimation (wisle)</h2><span id='topic+print.plot_expirest_wisle'></span>

<h3>Description</h3>

<p>This is a method for the function <code>print()</code> for objects of class
&lsquo;<code>plot_expirest_wisle</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plot_expirest_wisle'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.plot_expirest_wisle_+3A_x">x</code></td>
<td>
<p>An object of class &lsquo;<code>plot_expirest_wisle</code>&rsquo; returned by
the <code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a>()</code> function.</p>
</td></tr>
<tr><td><code id="print.plot_expirest_wisle_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The element <code>Graph</code> of the &lsquo;<code>plot_expirest_wisle</code>&rsquo;
object that is returned by the function <code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a>()</code>
is an object of class &lsquo;<code>ggplot</code>&rsquo;, generated by the function
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> from the &lsquo;<code>ggplot2</code>&rsquo; package.
Thus, the corresponding <code>plot</code> method is used for plotting. Arguments
to the <code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code> function can be passed via the
<code>...</code> parameter.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>plot_expirest_wisle</code>&rsquo; object passed to the <code>x</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_wisle">expirest_wisle</a></code>, <code><a href="#topic+plot_expirest_wisle">plot_expirest_wisle</a></code>,
<code><a href="ggplot2.html#topic+ggplot">ggplot</a>()</code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Performing a "what-if (approach for) shelf life estimation" (wisle)
res1 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

# The 'expirest_wisle' object can be passed on to the plot_expirest_wisle()
# function. This function does not produce any output but returns a
# 'plot_expirest_wisle' object.
## Not run: 
  gg1 &lt;- plot_expirest_wisle(
    model = res1, rl_index = 1, response_vbl_unit = "%", x_range = NULL,
    y_range = c(93, 105), scenario = "standard", mtbs = "verified",
    plot_option = "full", ci_app = "line")
  gg2 &lt;- print(gg1)

  # The print() function returns the 'plot_expirest_wisle' object invisibly.
  class(gg1)
  class(gg2)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.expirest_osle'>Summary of the shelf life estimation (osle)</h2><span id='topic+summary.expirest_osle'></span>

<h3>Description</h3>

<p>This is a method for the function <code>summary()</code> for objects of class
&lsquo;<code>expirest_osle</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'expirest_osle'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.expirest_osle_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;<code>expirest_osle</code>&rsquo; returned
by the <code><a href="#topic+expirest_osle">expirest_osle</a>()</code> function.</p>
</td></tr>
<tr><td><code id="summary.expirest_osle_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code><a href="#topic+expirest_osle">expirest_osle</a>()</code> estimates the shelf
life, or retest period, following the ICH Q1E guideline. By default, batch
poolability is checked as recommended by the guideline at a significance
level of 0.25. Other levels can be used, although not recommended, by
changing the default of the <code>alpha_pool</code> parameter. Three possible
models may be appropriate, i.e.
</p>

<ul>
<li><p> a <em>common intercept / common slope</em> model (cics),
</p>
</li>
<li><p> a <em>different intercept / common slope</em> model (dics) or
</p>
</li>
<li><p> a <em>different intercept / different slope</em> model (dids).
</p>
</li></ul>

<p>The worst case intercept is the intercept of the batch whose confidence
limit is the first crossing the acceptance limit. As in case of the
<code>cics</code> model type all batches have a common intercept and a common
confidence interval, all batches can be regarded as equally worst case. In
case of the <code>dids</code> model type, shelf life estimation is done using the
models obtained from fitting the data of each batch individually.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>expirest_osle</code>&rsquo; object passed to the <code>object</code>
parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_osle">expirest_osle</a></code>, <code><a href="#topic+expirest_wisle">expirest_wisle</a></code>,
<code><a href="base.html#topic+formatC">formatC</a></code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit models of different type
res1 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")
res2 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b3", "b4", "b5"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")
res3 &lt;-
  expirest_osle(data = exp1[exp1$Batch %in% c("b4", "b5", "b8"), ],
                response_vbl = "Potency", time_vbl = "Month",
                batch_vbl = "Batch", sl = 95, sl_sf = 3,
                srch_range = c(0, 500), sf_option = "loose")

# The parameter settings sf_option = "loose" and ivl_side = "lower" (the
# default setting of ivl_side) cause the specification limit of 95.0
# (sl_sf = 3, i.e. 3 significant digits) to be reduced by 0.05, i.e. the
# actual specification limit is 94.95.

## Not run: 
  summary(res1)
  # Expected output of summary(res1)
  # Summary of shelf life estimation following the ICH Q1E guideline
  #
  # The best model accepted at a significance level of 0.25 has
  # Common intercepts and Common slopes (acronym: cics).
  #
  # Worst case intercept: 100.5669 (Potency)
  # Worst case batch: NA
  # Estimated shelf life for cics model:  26.2241 (Month)
  #
  # Worst case intercepts, POIs and batches of all models
  # (Including information about the side where the confidence
  #   interval crosses the specification boundary):
  #           Intercept      POI  Side Batch
  # cics       100.5669  26.2241 lower    NA
  # dics       100.3638  24.8003 lower    b2
  # dids.pmse  100.7819 23.66724 lower    b5
  # dids       100.7819 23.34184 lower    b5

  summary(res2)
  # Expected output of summary(res2)
  # Summary of shelf life estimation following the ICH Q1E guideline
  #
  # The best model accepted at a significance level of 0.25 has
  # Different intercepts and Common slopes (acronym: dics).
  #
  # Worst case intercept:   100.82 (Potency)
  # Worst case batch: b5
  # Estimated shelf life for dics model: 23.60194 (Month)
  #
  # Worst case intercepts, POIs and batches of all models
  # (Including information about the side where the confidence
  #   interval crosses the specification boundary):
  #           Intercept      POI  Side Batch
  # cics       102.0513 29.18093 lower    NA
  # dics         100.82 23.60194 lower    b5
  # dids.pmse  100.7819 22.49726 lower    b5
  # dids       102.3841 23.26251 lower    b3

  summary(res3)
  # Expected output of summary(res3)
  # Summary of shelf life estimation following the ICH Q1E guideline
  #
  # The best model accepted at a significance level of 0.25 has
  # Different intercepts and Different slopes (acronym: dids).
  #
  # Worst case intercept: 101.2594 (Potency)
  # Worst case batch: b8
  # Estimated shelf life for dids model: 15.96453 (Month)
  #
  # Worst case intercepts, POIs and batches of all models
  # (Including information about the side where the confidence
  #   interval crosses the specification boundary):
  #           Intercept      POI  Side Batch
  # cics       101.5498 28.12518 lower    NA
  # dics       100.4882 22.47939 lower    b8
  # dids.pmse  101.2594 15.72348 lower    b8
  # dids       101.2594 15.96453 lower    b8

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.expirest_wisle'>Summary of the what-if shelf life estimation (wisle)</h2><span id='topic+summary.expirest_wisle'></span>

<h3>Description</h3>

<p>This is a method for the function <code>summary()</code> for objects of class
&lsquo;<code>expirest_wisle</code>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'expirest_wisle'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.expirest_wisle_+3A_object">object</code></td>
<td>
<p>An object of class &lsquo;<code>expirest_wisle</code>&rsquo; returned
by the <code><a href="#topic+expirest_wisle">expirest_wisle</a>()</code> function.</p>
</td></tr>
<tr><td><code id="summary.expirest_wisle_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods or arguments
that can be passed down to the <code><a href="base.html#topic+formatC">formatC</a>()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code><a href="#topic+expirest_wisle">expirest_wisle</a>()</code> estimates the expiry
for the specified release and specification limit following the ARGPM
guidance &ldquo;Stability testing for prescription medicines&rdquo;. By default,
batch poolability is checked as recommended by the ICH Q1E guideline at a
significance level of 0.25. Other levels can be used, although not
recommended, by changing the default of the <code>alpha_pool</code> parameter.
Three possible models may be appropriate, i.e.
</p>

<ul>
<li><p> a <em>common intercept / common slope</em> model (cics),
</p>
</li>
<li><p> a <em>different intercept / common slope</em> model (dics) or
</p>
</li>
<li><p> a <em>different intercept / different slope</em> model (dids).
</p>
</li></ul>

<p>The worst case intercept is the intercept of the batch whose confidence
limit is the first crossing the acceptance limit. As in case of the
<code>cics</code> model type all batches have a common intercept and a common
confidence interval, all batches can be regarded as equally worst case. In
case of the <code>dids</code> model type, shelf life estimation is done using the
models obtained from fitting the data of each batch individually. In
addition to the shelf life estimated according to the ARGPM also the
estimate according to ICH Q1E is shown.
</p>


<h3>Value</h3>

<p>The &lsquo;<code>expirest_wisle</code>&rsquo; object passed to the
<code>object</code> parameter is returned invisibly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+expirest_wisle">expirest_wisle</a></code>, <code><a href="#topic+expirest_osle">expirest_osle</a></code>,
<code><a href="base.html#topic+formatC">formatC</a></code>, <code><a href="utils.html#topic+methods">methods</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit models of different type
res1 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b2", "b5", "b7"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

res2 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b3", "b4", "b5"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")
res3 &lt;-
  expirest_wisle(data = exp1[exp1$Batch %in% c("b4", "b5", "b8"), ],
                 response_vbl = "Potency", time_vbl = "Month",
                 batch_vbl = "Batch", rl = 98, rl_sf = 3, sl = 95,
                 sl_sf = 3, srch_range = c(0, 500), sf_option = "loose")

# The parameter settings sf_option = "loose" and ivl_side = "lower" (the
# default setting of ivl_side) cause the specification limit of 95.0
# (sl_sf = 3, i.e. 3 significant digits) to be reduced by 0.05, i.e. the
# actual specification limit is 94.95.

## Not run: 
  summary(res1)
  # Expected output of summary(res1)
  # Summary of shelf life estimation following the ARGPM
  # guidance "Stability testing for prescription medicines"
  #
  # The best model accepted at a significance level of 0.25 has
  # Common intercepts and Common slopes (acronym: cics).
  #
  # Worst case intercept and batch:
  #   RL Batch Intercept
  # 1 98    NA  100.5669
  #
  # Estimated shelf lives for the cics model:
  #   SL RL    wisle    osle
  # 1 95 98 14.07398 26.2241
  #
  # Abbreviations:
  #   ARGPM: Australian Regulatory Guidelines for Prescription Medicines;
  #   ICH: International Council for Harmonisation;
  #   osle: Ordinary shelf life estimation (i.e. following the ICH guidance);
  #   RL: Release Limit;
  #   SL: Specification Limit;
  #   wisle: What-if (approach for) shelf life estimation (see ARGPM guidance).

  summary(res2)
  # Expected output of summary(res2)
  # Summary of shelf life estimation following the ARGPM
  # guidance "Stability testing for prescription medicines"
  #
  # The best model accepted at a significance level of 0.25 has
  # Different intercepts and Common slopes (acronym: dics).
  #
  # Worst case intercept and batch:
  #   RL Batch Intercept
  # 1 98    b5    100.82
  #
  # Estimated shelf lives for the dics model:
  #   SL RL    wisle     osle
  # 1 95 98 11.40993 23.60194
  #
  # Abbreviations:
  #   ARGPM: Australian Regulatory Guidelines for Prescription Medicines;
  #   ICH: International Council for Harmonisation;
  #   osle: Ordinary shelf life estimation (i.e. following the ICH guidance);
  #   RL: Release Limit;
  #   SL: Specification Limit;
  #   wisle: What-if (approach for) shelf life estimation (see ARGPM guidance).

  summary(res3)
  # Expected output of summary(res3)
  # Summary of shelf life estimation following the ARGPM
  #   guidance "Stability testing for prescription medicines"
  #
  # The best model accepted at a significance level of 0.25 has
  #  Different intercepts and Different slopes (acronym: dids).
  #
  # Worst case intercept and batch:
  #   RL Batch Intercept
  # 1 98    b8  101.2594
  #
  # Estimated shelf lives for the dids model (for information, the results of
  #   the model fitted with pooled mean square error (pmse) are also shown:
  #   SL RL    wisle wisle (pmse)     osle osle (pmse)
  # 1 95 98 7.619661     7.483223 15.96453    15.72348
  #
  # Abbreviations:
  #   ARGPM: Australian Regulatory Guidelines for Prescription Medicines;
  #   ICH: International Council for Harmonisation;
  #   osle: Ordinary shelf life estimation (i.e. following the ICH guidance);
  #   pmse: Pooled mean square error;
  #   RL: Release Limit;
  #   SL: Specification Limit;
  #   wisle: What-if (approach for) shelf life estimation (see ARGPM guidance).

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
