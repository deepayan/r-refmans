<!DOCTYPE html><html lang="en"><head><title>Help for package ClusterGVis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ClusterGVis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#BEAM_res'><p>This is a test data for this package</p>
test data describtion</a></li>
<li><a href='#clusterData'><p>Cluster Data Based on Different Methods</p></a></li>
<li><a href='#enrichCluster'><p>Perform GO/KEGG Enrichment Analysis for Multiple Clusters</p></a></li>
<li><a href='#exprs'><p>Generic to access cds count matrix</p></a></li>
<li><a href='#exprs+2Ccell_data_set-method'><p>Method to access cds count matrix</p></a></li>
<li><a href='#exps'><p>This is a test data for this package</p>
test data describtion</a></li>
<li><a href='#filter.std+20modified+20by+20Mfuzz+20filter.std'><p>using filter.std to filter low expression genes</p></a></li>
<li><a href='#getClusters'><p>Determine Optimal Clusters for Gene Expression or Pseudotime Data</p></a></li>
<li><a href='#net'><p>This is a test data for this package</p>
test data describtion</a></li>
<li><a href='#normalized_counts'><p>Return a size-factor normalized and (optionally) log-transformed expression</p></a></li>
<li><a href='#plot_genes_branched_heatmap2'><p>Create a heatmap to demonstrate the bifurcation of gene expression along two</p>
branchs which is slightly modified in monocle2</a></li>
<li><a href='#plot_multiple_branches_heatmap2'><p>Create a heatmap to demonstrate the bifurcation of gene expression along</p>
multiple branches</a></li>
<li><a href='#plot_pseudotime_heatmap2'><p>Plots a pseudotime-ordered, row-centered heatmap which is slightly modified in monocle2</p></a></li>
<li><a href='#pre_pseudotime_matrix'><p>Calculate and return a smoothed pseudotime matrix for the given gene list</p></a></li>
<li><a href='#prepareDataFromscRNA'><p>Prepare scRNA Data for clusterGvis Analysis</p></a></li>
<li><a href='#pseudotime'><p>Generic to extract pseudotime from CDS object</p></a></li>
<li><a href='#pseudotime+2Ccell_data_set-method'><p>Method to extract pseudotime from CDS object</p></a></li>
<li><a href='#sig_gene_names'><p>This is a test data for this package</p>
test data describtion</a></li>
<li><a href='#size_factors'><p>Get the size factors from a cds object.</p></a></li>
<li><a href='#termanno'><p>This is a test data for this package</p>
test data describtion</a></li>
<li><a href='#termanno2'><p>This is a test data for this package</p>
test data describtion</a></li>
<li><a href='#traverseTree'><p>traverseTree function</p></a></li>
<li><a href='#visCluster'><p>using visCluster to visualize cluster results from clusterData and enrichCluster output</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>One-Step to Cluster and Visualize Gene Expression Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Streamlining the clustering and visualization of time-series gene expression data from RNA-Seq experiments, this tool supports fuzzy c-means and k-means clustering algorithms. It is compatible with outputs from widely-used packages such as 'Seurat', 'Monocle', and 'WGCNA', enabling seamless downstream visualization and analysis. See Lokesh Kumar and Matthias E Futschik (2007) &lt;<a href="https://doi.org/10.6026%2F97320630002005">doi:10.6026/97320630002005</a>&gt; for more details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Biobase,circlize,clusterProfiler,colorRamps,ComplexHeatmap,dplyr,e1071,
factoextra,ggplot2,grDevices,grid,magrittr,Matrix,methods,Mfuzz,purrr,
reshape2,scales,SingleCellExperiment,stats,SummarizedExperiment,TCseq,tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>igraph, monocle, pheatmap, Seurat, WGCNA</td>
</tr>
<tr>
<td>biocViews:</td>
<td>Sequencing,clusterProfiler,SummarizedExperiment,Mfuzz</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/junjunlab/ClusterGVis/issues">https://github.com/junjunlab/ClusterGVis/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-13 11:34:18 UTC; 11389</td>
</tr>
<tr>
<td>Author:</td>
<td>Jun Zhang <a href="https://orcid.org/0000-0001-7692-9105"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jun Zhang &lt;3219030654@stu.cpu.edu.cn&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-14 14:30:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='BEAM_res'>This is a test data for this package
test data describtion</h2><span id='topic+BEAM_res'></span>

<h3>Description</h3>

<p>This is a test data for this package
test data describtion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BEAM_res
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 47192 rows and 8 columns.
</p>


<h3>Author(s)</h3>

<p>JunZhang
</p>

<hr>
<h2 id='clusterData'>Cluster Data Based on Different Methods</h2><span id='topic+clusterData'></span>

<h3>Description</h3>

<p>Cluster Data Based on Different Methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterData(
  obj = NULL,
  scaleData = TRUE,
  cluster.method = c("mfuzz", "TCseq", "kmeans", "wgcna"),
  TCseq_params_list = list(),
  object = NULL,
  min.std = 0,
  cluster.num = NULL,
  subcluster = NULL,
  seed = 5201314,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clusterData_+3A_obj">obj</code></td>
<td>
<p>An input object that can take one of two types:
- A <strong>cell_data_set</strong> object for trajectory analysis.
- A <strong>matrix</strong> or <strong>data.frame</strong> containing expression data.</p>
</td></tr>
<tr><td><code id="clusterData_+3A_scaledata">scaleData</code></td>
<td>
<p>Logical. Whether to scale the data (e.g., z-score normalization).</p>
</td></tr>
<tr><td><code id="clusterData_+3A_cluster.method">cluster.method</code></td>
<td>
<p>Character. Clustering method to use.
Options are one of <code>"mfuzz"</code>, <code>"TCseq"</code>, <code>"kmeans"</code>, or <code>"wgcna"</code>.</p>
</td></tr>
<tr><td><code id="clusterData_+3A_tcseq_params_list">TCseq_params_list</code></td>
<td>
<p>A list of additional parameters passed to the <code>TCseq::timeclust</code> function.</p>
</td></tr>
<tr><td><code id="clusterData_+3A_object">object</code></td>
<td>
<p>A pre-calculated object required when using <code>"wgcna"</code> as the clustering method.</p>
</td></tr>
<tr><td><code id="clusterData_+3A_min.std">min.std</code></td>
<td>
<p>Numeric. Minimum standard deviation for filtering expression data.</p>
</td></tr>
<tr><td><code id="clusterData_+3A_cluster.num">cluster.num</code></td>
<td>
<p>Integer. The number of clusters to identify.</p>
</td></tr>
<tr><td><code id="clusterData_+3A_subcluster">subcluster</code></td>
<td>
<p>A numeric vector of specific cluster IDs to include in the results.
If <code>NULL</code>, all clusters are included.</p>
</td></tr>
<tr><td><code id="clusterData_+3A_seed">seed</code></td>
<td>
<p>An integer seed for reproducibility in clustering operations.</p>
</td></tr>
<tr><td><code id="clusterData_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to internal functions such as <code>pre_pseudotime_matrix</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on the selected <code>cluster.method</code>, different clustering algorithms are used:
</p>

<ul>
<li> <p><strong><code>"mfuzz"</code></strong>: Applies Mfuzz soft clustering method, suitable for identifying overlapping clusters.
</p>
</li>
<li> <p><strong><code>"TCseq"</code></strong>: Uses TCseq clustering for time-series expression data with support for additional parameters.
</p>
</li>
<li> <p><strong><code>"kmeans"</code></strong>: Employs standard k-means clustering via base R's <code>stats::kmeans</code>.
</p>
</li>
<li> <p><strong><code>"wgcna"</code></strong>: Leverages pre-calculated WGCNA (Weighted Gene Co-expression Network Analysis) networks.
</p>
</li></ul>

<p>The function is designed to be flexible, allowing preprocessing (e.g., filtering by <code>min.std</code>),
scaling the data (<code>scaleData = TRUE</code>), and generating results compatible with data visualization pipelines.
</p>


<h3>Value</h3>

<p>A list containing the following clustering results:
</p>

<ul>
<li> <p><strong>wide.res</strong>: A wide-format data frame with clusters and normalized expression levels.
</p>
</li>
<li> <p><strong>long.res</strong>: A long-format data frame for visualizations, containing cluster information,
normalized values, cluster names, and memberships.
</p>
</li>
<li> <p><strong>cluster.list</strong>: A list where each element contains genes belonging to a specific cluster.
</p>
</li>
<li> <p><strong>type</strong>: The clustering method used (<code>"mfuzz"</code>, <code>"TCseq"</code>, <code>"kmeans"</code>, or <code>"wgcna"</code>).
</p>
</li>
<li> <p><strong>geneMode</strong>: Currently set to <code>"none"</code> (reserved for future use).
</p>
</li>
<li> <p><strong>geneType</strong>: Currently set to <code>"none"</code> (reserved for future use).
</p>
</li></ul>



<h3>WGCNA Clustering</h3>

<p>If the <strong>WGCNA</strong> method is selected, the <code>object</code> parameter must contain a pre-calculated WGCNA network object.
This is typically obtained using the WGCNA package functions.
</p>


<h3>Subsetting Clusters</h3>

<p>Use the <code>subcluster</code> parameter to focus on specific clusters. Cluster IDs not included in the
<code>subcluster</code> vector will be excluded from the final results.
</p>


<h3>Author(s)</h3>

<p>JunZhang
</p>
<p>This function performs clustering on input data using one of four methods:
<strong>mfuzz</strong>, <strong>TCseq</strong>, <strong>kmeans</strong>, or <strong>wgcna</strong>. The clustering results include
metadata, normalized data, and cluster memberships.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("exps")

# kmeans
ck &lt;- clusterData(obj = exps,
                  cluster.method = "kmeans",
                  cluster.num = 8)

</code></pre>

<hr>
<h2 id='enrichCluster'>Perform GO/KEGG Enrichment Analysis for Multiple Clusters</h2><span id='topic+enrichCluster'></span>

<h3>Description</h3>

<p>Perform GO/KEGG Enrichment Analysis for Multiple Clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enrichCluster(
  object = NULL,
  type = c("BP", "MF", "CC", "KEGG", "ownSet"),
  TERM2GENE = NULL,
  TERM2NAME = NULL,
  OrgDb = NULL,
  id.trans = TRUE,
  fromType = "SYMBOL",
  toType = c("ENTREZID"),
  readable = TRUE,
  organism = "hsa",
  pvalueCutoff = 0.05,
  topn = 5,
  seed = 5201314,
  add.gene = FALSE,
  heatmap.type = c("plot_pseudotime_heatmap2", "plot_genes_branched_heatmap2",
    "plot_multiple_branches_heatmap2"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="enrichCluster_+3A_object">object</code></td>
<td>
<p>An object containing clustering results.
This is clusterData object. Alternatively, it can be a <code>CellDataSet</code> object, in which case the function can also visualize pseudotime data.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_type">type</code></td>
<td>
<p>Character. The type of enrichment analysis to perform. Options include:
</p>

<ul>
<li> <p><code>"BP"</code>: Biological Process (GO)
</p>
</li>
<li> <p><code>"MF"</code>: Molecular Function (GO)
</p>
</li>
<li> <p><code>"CC"</code>: Cellular Component (GO)
</p>
</li>
<li> <p><code>"KEGG"</code>: KEGG Pathway analysis
</p>
</li>
<li> <p><code>"ownSet"</code>: Custom gene set enrichment, requiring <code>TERM2GENE</code> and optionally <code>TERM2NAME</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="enrichCluster_+3A_term2gene">TERM2GENE</code></td>
<td>
<p>A data frame containing mappings of terms to genes. Required when <code>type = "ownSet"</code>.
This must be a two-column data frame, where the first column is the term and the second column is the gene.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_term2name">TERM2NAME</code></td>
<td>
<p>A data frame containing term-to-name mappings. Optional when <code>type = "ownSet"</code>.
This must also be a two-column data frame, where the first column is the term and the second column is the name.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_orgdb">OrgDb</code></td>
<td>
<p>An organism database object (e.g., <code>org.Hs.eg.db</code> for human or <code>org.Mm.eg.db</code> for mouse),
used for GO or KEGG enrichment analysis.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_id.trans">id.trans</code></td>
<td>
<p>Logical. Whether to perform gene ID transformation. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_fromtype">fromType</code></td>
<td>
<p>Character. The type of the input gene IDs (e.g., <code>"SYMBOL"</code>, <code>"ENSEMBL"</code>). Default is <code>"SYMBOL"</code>.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_totype">toType</code></td>
<td>
<p>Character. The target ID type for transformation using <code>clusterProfiler::bitr</code>
(e.g., <code>"ENTREZID"</code>). Default is <code>"ENTREZID"</code>.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_readable">readable</code></td>
<td>
<p>Logical. Whether to convert the enrichment result IDs back to a readable format (e.g., SYMBOL).
Only applicable for GO and KEGG analysis. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_organism">organism</code></td>
<td>
<p>Character. The KEGG organism code (e.g., <code>"hsa"</code> for human, <code>"mmu"</code> for mouse). Required when
performing KEGG enrichment. Default is <code>"hsa"</code>.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_pvaluecutoff">pvalueCutoff</code></td>
<td>
<p>Numeric. The p-value cutoff for enriched terms to be included in the results. Default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_topn">topn</code></td>
<td>
<p>Integer or vector. The number of top enrichment results to extract. If a single value, it is applied
to all clusters. Otherwise, it should match the number of clusters. Default is <code>5</code>.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_seed">seed</code></td>
<td>
<p>Numeric. Seed for random operations to ensure reproducibility. Default is <code>5201314</code>.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_add.gene">add.gene</code></td>
<td>
<p>Logical. Whether to include the list of genes associated with each enriched term in the results.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="enrichCluster_+3A_heatmap.type">heatmap.type</code></td>
<td>
<p>Character. The type of heatmap visualization to use when input data is a <code>CellDataSet</code> object.
Options include:
</p>

<ul>
<li> <p><code>"plot_pseudotime_heatmap2"</code>
</p>
</li>
<li> <p><code>"plot_genes_branched_heatmap2"</code>
</p>
</li>
<li> <p><code>"plot_multiple_branches_heatmap2"</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="enrichCluster_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to plot_pseudotime_heatmap2/plot_genes_branched_heatmap2/plot_multiple_branches_heatmap2 functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame.
</p>


<h3>Author(s)</h3>

<p>JunZhang
</p>
<p>This function performs Gene Ontology (GO) or KEGG enrichment analysis, or custom gene set enrichment,
on clustered genes. It supports multiple clusters, incorporating cluster-specific results into its analysis.
</p>

<hr>
<h2 id='exprs'>Generic to access cds count matrix</h2><span id='topic+exprs'></span>

<h3>Description</h3>

<p>Generic to access cds count matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exprs(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exprs_+3A_x">x</code></td>
<td>
<p>A cell_data_set object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Count matrix.
</p>


<h3>Author(s)</h3>

<p>https://github.com/cole-trapnell-lab/monocle3
</p>

<hr>
<h2 id='exprs+2Ccell_data_set-method'>Method to access cds count matrix</h2><span id='topic+exprs+2Ccell_data_set-method'></span>

<h3>Description</h3>

<p>Method to access cds count matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cell_data_set'
exprs(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exprs+2B2Ccell_data_set-method_+3A_x">x</code></td>
<td>
<p>A cell_data_set object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Count matrix.
</p>

<hr>
<h2 id='exps'>This is a test data for this package
test data describtion</h2><span id='topic+exps'></span>

<h3>Description</h3>

<p>This is a test data for this package
test data describtion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exps
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 3767 rows and 6 columns.
</p>


<h3>Author(s)</h3>

<p>Junjun Lao
</p>

<hr>
<h2 id='filter.std+20modified+20by+20Mfuzz+20filter.std'>using filter.std to filter low expression genes</h2><span id='topic+filter.std+20modified+20by+20Mfuzz+20filter.std'></span><span id='topic+filter.std'></span>

<h3>Description</h3>

<p>using filter.std to filter low expression genes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter.std(eset, min.std, visu = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter.std+2B20modified+2B20by+2B20Mfuzz+2B20filter.std_+3A_eset">eset</code></td>
<td>
<p>expression matrix, default NULL.</p>
</td></tr>
<tr><td><code id="filter.std+2B20modified+2B20by+2B20Mfuzz+2B20filter.std_+3A_min.std">min.std</code></td>
<td>
<p>min stand error, default 0.</p>
</td></tr>
<tr><td><code id="filter.std+2B20modified+2B20by+2B20Mfuzz+2B20filter.std_+3A_visu">visu</code></td>
<td>
<p>whether plot, default FALSE.</p>
</td></tr>
<tr><td><code id="filter.std+2B20modified+2B20by+2B20Mfuzz+2B20filter.std_+3A_verbose">verbose</code></td>
<td>
<p>show filter information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix.
</p>

<hr>
<h2 id='getClusters'>Determine Optimal Clusters for Gene Expression or Pseudotime Data</h2><span id='topic+getClusters'></span>

<h3>Description</h3>

<p>Determine Optimal Clusters for Gene Expression or Pseudotime Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getClusters(obj = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getClusters_+3A_obj">obj</code></td>
<td>
<p>A data object representing the gene expression data or pseudotime data:
</p>

<ul>
<li><p> If the input is a <code>cell_data_set</code> object (e.g., from <code>Monocle3</code>),
the function preprocesses the data using <code>pre_pseudotime_matrix</code>.
</p>
</li>
<li><p> If the input is a numeric matrix or a <code>data.frame</code>, it directly uses this data.
Default is <code>NULL</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="getClusters_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the preprocessing function
<code>pre_pseudotime_matrix</code> (e.g., <code>assays</code>, <code>normalize</code>, etc.).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object visualizing the Elbow plot, where:
</p>

<ul>
<li><p> The x-axis represents the number of clusters tested.
</p>
</li>
<li><p> The y-axis represents the WSS for each cluster number.
</p>
</li></ul>

<p>The optimal cluster number can be visually identified at the &quot;elbow point,&quot; where the
reduction in WSS diminishes sharply.
</p>
<p>a ggplot.
</p>


<h3>Author(s)</h3>

<p>JunZhang
</p>
<p>The <code>getClusters</code> function identifies the optimal number of clusters for a given data object.
It supports multiple input types, including gene expression matrices and objects such as
<code>cell_data_set</code>. The function implements the Elbow method to evaluate within-cluster
sum of squares (WSS) across a range of cluster numbers and visualizes the results.
</p>

<hr>
<h2 id='net'>This is a test data for this package
test data describtion</h2><span id='topic+net'></span>

<h3>Description</h3>

<p>This is a test data for this package
test data describtion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>net
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 10.
</p>


<h3>Author(s)</h3>

<p>Junjun Lao
</p>

<hr>
<h2 id='normalized_counts'>Return a size-factor normalized and (optionally) log-transformed expression</h2><span id='topic+normalized_counts'></span>

<h3>Description</h3>

<p>Return a size-factor normalized and (optionally) log-transformed expression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalized_counts(
  cds,
  norm_method = c("log", "binary", "size_only"),
  pseudocount = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normalized_counts_+3A_cds">cds</code></td>
<td>
<p>A CDS object to calculate normalized expression matrix from.</p>
</td></tr>
<tr><td><code id="normalized_counts_+3A_norm_method">norm_method</code></td>
<td>
<p>String indicating the normalization method. Options are
&quot;log&quot; (Default), &quot;binary&quot; and &quot;size_only&quot;.</p>
</td></tr>
<tr><td><code id="normalized_counts_+3A_pseudocount">pseudocount</code></td>
<td>
<p>A pseudocount to add before log transformation. Ignored
if norm_method is not &quot;log&quot;. Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Size-factor normalized, and optionally log-transformed, expression
matrix.
</p>


<h3>Author(s)</h3>

<p>https://github.com/cole-trapnell-lab/monocle3
</p>
<p>matrix
</p>

<hr>
<h2 id='plot_genes_branched_heatmap2'>Create a heatmap to demonstrate the bifurcation of gene expression along two
branchs which is slightly modified in monocle2</h2><span id='topic+plot_genes_branched_heatmap2'></span>

<h3>Description</h3>

<p>@description returns a heatmap that shows changes in both lineages at the same
time.
It also requires that you choose a branch point to inspect.
Columns are points in pseudotime, rows are genes, and the beginning of
pseudotime is in the middle of the heatmap.
As you read from the middle of the heatmap to the right, you are following
one lineage through pseudotime. As you read left, the other.
The genes are clustered hierarchically, so you can visualize modules of genes
that have similar lineage-dependent expression patterns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_genes_branched_heatmap2(
  cds_subset = NULL,
  branch_point = 1,
  branch_states = NULL,
  branch_labels = c("Cell fate 1", "Cell fate 2"),
  cluster_rows = TRUE,
  hclust_method = "ward.D2",
  num_clusters = 6,
  hmcols = NULL,
  branch_colors = c("#979797", "#F05662", "#7990C8"),
  add_annotation_row = NULL,
  add_annotation_col = NULL,
  show_rownames = FALSE,
  use_gene_short_name = TRUE,
  scale_max = 3,
  scale_min = -3,
  norm_method = c("log", "vstExprs"),
  trend_formula = "~sm.ns(Pseudotime, df=3) * Branch",
  return_heatmap = FALSE,
  cores = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_genes_branched_heatmap2_+3A_cds_subset">cds_subset</code></td>
<td>
<p>CellDataSet for the experiment (normally only the branching
genes detected with branchTest)</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_branch_point">branch_point</code></td>
<td>
<p>The ID of the branch point to visualize. Can only be used
when reduceDimension is called with method = &quot;DDRTree&quot;.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_branch_states">branch_states</code></td>
<td>
<p>The two states to compare in the heatmap. Mutually
exclusive with branch_point.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_branch_labels">branch_labels</code></td>
<td>
<p>The labels for the branchs.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_cluster_rows">cluster_rows</code></td>
<td>
<p>Whether to cluster the rows of the heatmap.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_hclust_method">hclust_method</code></td>
<td>
<p>The method used by pheatmap to perform hirearchical
clustering of the rows.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_num_clusters">num_clusters</code></td>
<td>
<p>Number of clusters for the heatmap of branch genes</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_hmcols">hmcols</code></td>
<td>
<p>The color scheme for drawing the heatmap.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_branch_colors">branch_colors</code></td>
<td>
<p>The colors used in the annotation strip indicating the
pre- and post-branch cells.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_add_annotation_row">add_annotation_row</code></td>
<td>
<p>Additional annotations to show for each row in the
heatmap. Must be a dataframe with one row for each row in the fData table of
cds_subset, with matching IDs.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_add_annotation_col">add_annotation_col</code></td>
<td>
<p>Additional annotations to show for each column in
the heatmap. Must be a dataframe with one row for each cell in the pData table
of cds_subset, with matching IDs.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_show_rownames">show_rownames</code></td>
<td>
<p>Whether to show the names for each row in the table.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_use_gene_short_name">use_gene_short_name</code></td>
<td>
<p>Whether to use the short names for each row. If
FALSE, uses row IDs from the fData table.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_scale_max">scale_max</code></td>
<td>
<p>The maximum value (in standard deviations) to show in the
heatmap. Values larger than this are set to the max.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_scale_min">scale_min</code></td>
<td>
<p>The minimum value (in standard deviations) to show in the
heatmap. Values smaller than this are set to the min.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_norm_method">norm_method</code></td>
<td>
<p>Determines how to transform expression values prior to
rendering</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_trend_formula">trend_formula</code></td>
<td>
<p>A formula string specifying the model used in fitting
the spline curve for each gene/feature.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_return_heatmap">return_heatmap</code></td>
<td>
<p>Whether to return the pheatmap object to the user.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_cores">cores</code></td>
<td>
<p>Number of cores to use when smoothing the expression curves shown
in the heatmap.</p>
</td></tr>
<tr><td><code id="plot_genes_branched_heatmap2_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to buildBranchCellDataSet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of heatmap_matrix (expression matrix for the branch committment),
ph (pheatmap heatmap object),
annotation_row (annotation data.frame for the row), annotation_col (annotation
data.frame for the column).
</p>

<hr>
<h2 id='plot_multiple_branches_heatmap2'>Create a heatmap to demonstrate the bifurcation of gene expression along
multiple branches</h2><span id='topic+plot_multiple_branches_heatmap2'></span>

<h3>Description</h3>

<p>Create a heatmap to demonstrate the bifurcation of gene expression along
multiple branches
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_multiple_branches_heatmap2(
  cds = NULL,
  branches,
  branches_name = NULL,
  cluster_rows = TRUE,
  hclust_method = "ward.D2",
  num_clusters = 6,
  hmcols = NULL,
  add_annotation_row = NULL,
  add_annotation_col = NULL,
  show_rownames = FALSE,
  use_gene_short_name = TRUE,
  norm_method = c("vstExprs", "log"),
  scale_max = 3,
  scale_min = -3,
  trend_formula = "~sm.ns(Pseudotime, df=3)",
  return_heatmap = FALSE,
  cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_cds">cds</code></td>
<td>
<p>CellDataSet for the experiment (normally only the branching genes
detected with BEAM)</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_branches">branches</code></td>
<td>
<p>The terminal branches (states) on the developmental tree you
want to investigate.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_branches_name">branches_name</code></td>
<td>
<p>Name (for example, cell type) of branches you believe the
cells on the branches are associated with.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_cluster_rows">cluster_rows</code></td>
<td>
<p>Whether to cluster the rows of the heatmap.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_hclust_method">hclust_method</code></td>
<td>
<p>The method used by pheatmap to perform hirearchical
clustering of the rows.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_num_clusters">num_clusters</code></td>
<td>
<p>Number of clusters for the heatmap of branch genes</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_hmcols">hmcols</code></td>
<td>
<p>The color scheme for drawing the heatmap.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_add_annotation_row">add_annotation_row</code></td>
<td>
<p>Additional annotations to show for each row in the
heatmap. Must be a dataframe with one row for each row in the fData table of
cds_subset, with matching IDs.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_add_annotation_col">add_annotation_col</code></td>
<td>
<p>Additional annotations to show for each column in
the heatmap. Must be a dataframe with one row for each cell in the pData
table of cds_subset, with matching IDs.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_show_rownames">show_rownames</code></td>
<td>
<p>Whether to show the names for each row in the table.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_use_gene_short_name">use_gene_short_name</code></td>
<td>
<p>Whether to use the short names for each row. If
FALSE, uses row IDs from the fData table.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_norm_method">norm_method</code></td>
<td>
<p>Determines how to transform expression values prior to
rendering</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_scale_max">scale_max</code></td>
<td>
<p>The maximum value (in standard deviations) to show in the
heatmap. Values larger than this are set to the max.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_scale_min">scale_min</code></td>
<td>
<p>The minimum value (in standard deviations) to show in the
heatmap. Values smaller than this are set to the min.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_trend_formula">trend_formula</code></td>
<td>
<p>A formula string specifying the model used in fitting
the spline curve for each gene/feature.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_return_heatmap">return_heatmap</code></td>
<td>
<p>Whether to return the pheatmap object to the user.</p>
</td></tr>
<tr><td><code id="plot_multiple_branches_heatmap2_+3A_cores">cores</code></td>
<td>
<p>Number of cores to use when smoothing the expression curves shown
in the heatmap.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of heatmap_matrix (expression matrix for the branch committment),
ph (pheatmap heatmap object),
annotation_row (annotation data.frame for the row), annotation_col (annotation
data.frame for the column).
</p>

<hr>
<h2 id='plot_pseudotime_heatmap2'>Plots a pseudotime-ordered, row-centered heatmap which is slightly modified in monocle2</h2><span id='topic+plot_pseudotime_heatmap2'></span>

<h3>Description</h3>

<p>The function plot_pseudotime_heatmap takes a CellDataSet object
(usually containing a only subset of significant genes) and generates smooth
expression curves much like plot_genes_in_pseudotime.
Then, it clusters these genes and plots them using the pheatmap package.
This allows you to visualize modules of genes that co-vary across pseudotime.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pseudotime_heatmap2(
  cds_subset,
  cluster_rows = TRUE,
  hclust_method = "ward.D2",
  num_clusters = 6,
  hmcols = NULL,
  add_annotation_row = NULL,
  add_annotation_col = NULL,
  show_rownames = FALSE,
  use_gene_short_name = TRUE,
  norm_method = c("log", "vstExprs"),
  scale_max = 3,
  scale_min = -3,
  trend_formula = "~sm.ns(Pseudotime, df=3)",
  return_heatmap = FALSE,
  cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_pseudotime_heatmap2_+3A_cds_subset">cds_subset</code></td>
<td>
<p>CellDataSet for the experiment (normally only the branching
genes detected with branchTest)</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_cluster_rows">cluster_rows</code></td>
<td>
<p>Whether to cluster the rows of the heatmap.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_hclust_method">hclust_method</code></td>
<td>
<p>The method used by pheatmap to perform hirearchical
clustering of the rows.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_num_clusters">num_clusters</code></td>
<td>
<p>Number of clusters for the heatmap of branch genes</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_hmcols">hmcols</code></td>
<td>
<p>The color scheme for drawing the heatmap.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_add_annotation_row">add_annotation_row</code></td>
<td>
<p>Additional annotations to show for each row in the
heatmap. Must be a dataframe with one row for each row in the fData table of
cds_subset, with matching IDs.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_add_annotation_col">add_annotation_col</code></td>
<td>
<p>Additional annotations to show for each column in
the heatmap. Must be a dataframe with one row for each cell in the pData table
of cds_subset, with matching IDs.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_show_rownames">show_rownames</code></td>
<td>
<p>Whether to show the names for each row in the table.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_use_gene_short_name">use_gene_short_name</code></td>
<td>
<p>Whether to use the short names for each row. If
FALSE, uses row IDs from the fData table.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_norm_method">norm_method</code></td>
<td>
<p>Determines how to transform expression values prior to
rendering</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_scale_max">scale_max</code></td>
<td>
<p>The maximum value (in standard deviations) to show in the
heatmap. Values larger than this are set to the max.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_scale_min">scale_min</code></td>
<td>
<p>The minimum value (in standard deviations) to show in the
heatmap. Values smaller than this are set to the min.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_trend_formula">trend_formula</code></td>
<td>
<p>A formula string specifying the model used in fitting
the spline curve for each gene/feature.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_return_heatmap">return_heatmap</code></td>
<td>
<p>Whether to return the pheatmap object to the user.</p>
</td></tr>
<tr><td><code id="plot_pseudotime_heatmap2_+3A_cores">cores</code></td>
<td>
<p>Number of cores to use when smoothing the expression curves shown
in the heatmap.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of heatmap_matrix (expression matrix for the branch committment),
ph (pheatmap heatmap object),
annotation_row (annotation data.frame for the row), annotation_col (annotation
data.frame for the column).
</p>

<hr>
<h2 id='pre_pseudotime_matrix'>Calculate and return a smoothed pseudotime matrix for the given gene list</h2><span id='topic+pre_pseudotime_matrix'></span>

<h3>Description</h3>

<p>This function takes in a monocle3 object and returns a smoothed pseudotime
matrix for the
given gene list, either in counts or normalized form. The function first matches
the gene list
with the rownames of the SummarizedExperiment object, and then orders the
pseudotime information.
The function then uses smooth.spline to apply smoothing to the data. Finally,
the function normalizes
the data by subtracting the mean and dividing by the standard deviation for each row.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pre_pseudotime_matrix(
  cds_obj = NULL,
  assays = c("counts", "normalized"),
  gene_list = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pre_pseudotime_matrix_+3A_cds_obj">cds_obj</code></td>
<td>
<p>A monocle3 object</p>
</td></tr>
<tr><td><code id="pre_pseudotime_matrix_+3A_assays">assays</code></td>
<td>
<p>Type of assay to be used for the analysis, either &quot;counts&quot; or &quot;normalized&quot;</p>
</td></tr>
<tr><td><code id="pre_pseudotime_matrix_+3A_gene_list">gene_list</code></td>
<td>
<p>A vector of gene names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A smoothed pseudotime matrix for the given gene list
</p>

<hr>
<h2 id='prepareDataFromscRNA'>Prepare scRNA Data for clusterGvis Analysis</h2><span id='topic+prepareDataFromscRNA'></span>

<h3>Description</h3>

<p>This function prepares single-cell RNA sequencing (scRNA-seq) data for differential
gene expression analysis. It extracts the expression data for the specified cells
and genes, and organizes them into a dataframe format suitable for downstream analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepareDataFromscRNA(
  object = NULL,
  diffData = NULL,
  showAverage = TRUE,
  cells = NULL,
  group.by = "ident",
  assays = "RNA",
  slot = "data",
  scale.data = TRUE,
  cluster.order = NULL,
  keep.uniqGene = TRUE,
  sep = "_"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepareDataFromscRNA_+3A_object">object</code></td>
<td>
<p>an object of class Seurat containing the scRNA-seq data.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_diffdata">diffData</code></td>
<td>
<p>a dataframe containing information about the differential expression analysis which can
be output from function FindAllMarkers.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_showaverage">showAverage</code></td>
<td>
<p>a logical indicating whether to show the average gene expression across all cells.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_cells">cells</code></td>
<td>
<p>a vector of cell names to extract from the Seurat object. If NULL, all cells will be used.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_group.by">group.by</code></td>
<td>
<p>a string specifying the grouping variable for differential expression analysis. Default is 'ident', which groups cells by their assigned clusters.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_assays">assays</code></td>
<td>
<p>a string or vector of strings specifying the assay(s) to extract from the Seurat object. Default is 'RNA'.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_slot">slot</code></td>
<td>
<p>a string specifying the slot name where the assay data is stored in the Seurat object. Default is 'data'.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_scale.data">scale.data</code></td>
<td>
<p>whether do Z-score for expression data, default TRUE.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_cluster.order">cluster.order</code></td>
<td>
<p>the celltype orders.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_keep.uniqgene">keep.uniqGene</code></td>
<td>
<p>a logical indicating whether to keep only unique gene names. Default is TRUE.</p>
</td></tr>
<tr><td><code id="prepareDataFromscRNA_+3A_sep">sep</code></td>
<td>
<p>a character string to separate gene and cell names in the output dataframe. Default is &quot;_&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe containing the expression data for the specified genes and cells,
organized in a format suitable for differential gene expression analysis.
</p>

<hr>
<h2 id='pseudotime'>Generic to extract pseudotime from CDS object</h2><span id='topic+pseudotime'></span>

<h3>Description</h3>

<p>Generic to extract pseudotime from CDS object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudotime(x, reduction_method = "UMAP")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudotime_+3A_x">x</code></td>
<td>
<p>A cell_data_set object.</p>
</td></tr>
<tr><td><code id="pseudotime_+3A_reduction_method">reduction_method</code></td>
<td>
<p>Reduced dimension to extract pseudotime for.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Pseudotime values.
</p>


<h3>Author(s)</h3>

<p>https://github.com/cole-trapnell-lab/monocle3
</p>

<hr>
<h2 id='pseudotime+2Ccell_data_set-method'>Method to extract pseudotime from CDS object</h2><span id='topic+pseudotime+2Ccell_data_set-method'></span>

<h3>Description</h3>

<p>Method to extract pseudotime from CDS object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'cell_data_set'
pseudotime(x, reduction_method = "UMAP")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudotime+2B2Ccell_data_set-method_+3A_x">x</code></td>
<td>
<p>A cell_data_set object.</p>
</td></tr>
<tr><td><code id="pseudotime+2B2Ccell_data_set-method_+3A_reduction_method">reduction_method</code></td>
<td>
<p>Reduced dimension to extract clusters for.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Pseudotime values.
</p>

<hr>
<h2 id='sig_gene_names'>This is a test data for this package
test data describtion</h2><span id='topic+sig_gene_names'></span>

<h3>Description</h3>

<p>This is a test data for this package
test data describtion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sig_gene_names
</code></pre>


<h3>Format</h3>

<p>An object of class <code>character</code> of length 1331.
</p>


<h3>Author(s)</h3>

<p>JunZhang
</p>

<hr>
<h2 id='size_factors'>Get the size factors from a cds object.</h2><span id='topic+size_factors'></span>

<h3>Description</h3>

<p>A wrapper around <code>colData(cds)$Size_Factor</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>size_factors(cds)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="size_factors_+3A_cds">cds</code></td>
<td>
<p>A cell_data_set object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An updated cell_data_set object
</p>

<hr>
<h2 id='termanno'>This is a test data for this package
test data describtion</h2><span id='topic+termanno'></span>

<h3>Description</h3>

<p>This is a test data for this package
test data describtion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>termanno
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 24 rows and 2 columns.
</p>


<h3>Author(s)</h3>

<p>Junjun Lao
</p>

<hr>
<h2 id='termanno2'>This is a test data for this package
test data describtion</h2><span id='topic+termanno2'></span>

<h3>Description</h3>

<p>This is a test data for this package
test data describtion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>termanno2
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 24 rows and 3 columns.
</p>


<h3>Author(s)</h3>

<p>Junjun Lao
</p>

<hr>
<h2 id='traverseTree'>traverseTree function</h2><span id='topic+traverseTree'></span>

<h3>Description</h3>

<p>traverseTree function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traverseTree(g, starting_cell, end_cells)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="traverseTree_+3A_g">g</code></td>
<td>
<p>NULL</p>
</td></tr>
<tr><td><code id="traverseTree_+3A_starting_cell">starting_cell</code></td>
<td>
<p>NULL</p>
</td></tr>
<tr><td><code id="traverseTree_+3A_end_cells">end_cells</code></td>
<td>
<p>NULL</p>
</td></tr>
</table>

<hr>
<h2 id='visCluster'>using visCluster to visualize cluster results from clusterData and enrichCluster output</h2><span id='topic+visCluster'></span>

<h3>Description</h3>

<p>Visualize Clustered Gene Data Using Line Plots and Heatmaps
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visCluster(
  object = NULL,
  ht.col.list = list(col_range = c(-2, 0, 2), col_color = c("#08519C", "white",
    "#A50F15")),
  border = TRUE,
  plot.type = c("line", "heatmap", "both"),
  ms.col = c("#0099CC", "grey90", "#CC3333"),
  line.size = 0.1,
  line.col = "grey90",
  add.mline = TRUE,
  mline.size = 2,
  mline.col = "#CC3333",
  ncol = 4,
  ctAnno.col = NULL,
  set.md = "median",
  textbox.pos = c(0.5, 0.8),
  textbox.size = 8,
  panel.arg = c(2, 0.25, 4, "grey90", NA),
  ggplot.panel.arg = c(2, 0.25, 4, "grey90", NA),
  annoTerm.data = NULL,
  annoTerm.mside = "right",
  termAnno.arg = c("grey95", "grey50"),
  add.bar = FALSE,
  bar.width = 8,
  textbar.pos = c(0.8, 0.8),
  go.col = NULL,
  go.size = NULL,
  by.go = "anno_link",
  annoKegg.data = NULL,
  annoKegg.mside = "right",
  keggAnno.arg = c("grey95", "grey50"),
  add.kegg.bar = FALSE,
  kegg.col = NULL,
  kegg.size = NULL,
  by.kegg = "anno_link",
  word_wrap = TRUE,
  add_new_line = TRUE,
  add.box = FALSE,
  boxcol = NULL,
  box.arg = c(0.1, "grey50"),
  add.point = FALSE,
  point.arg = c(19, "orange", "orange", 1),
  add.line = TRUE,
  line.side = "right",
  markGenes = NULL,
  markGenes.side = "right",
  genes.gp = c("italic", 10, NA),
  term.text.limit = c(10, 18),
  mulGroup = NULL,
  lgd.label = NULL,
  show_row_names = FALSE,
  subgroup.anno = NULL,
  annnoblock.text = TRUE,
  annnoblock.gp = c("white", 8),
  add.sampleanno = TRUE,
  sample.group = NULL,
  sample.col = NULL,
  sample.order = NULL,
  cluster.order = NULL,
  sample.cell.order = NULL,
  HeatmapAnnotation = NULL,
  column.split = NULL,
  cluster_columns = FALSE,
  pseudotime_col = NULL,
  gglist = NULL,
  row_annotation_obj = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="visCluster_+3A_object">object</code></td>
<td>
<p>clusterData object, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_ht.col.list">ht.col.list</code></td>
<td>
<p>list of heatmap col_range and col_color, default
list(col_range = c(-2, 0, 2),col_color = c(&quot;#08519C&quot;, &quot;white&quot;, &quot;#A50F15&quot;)).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_border">border</code></td>
<td>
<p>whether add border for heatmap, default TRUE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_plot.type">plot.type</code></td>
<td>
<p>the plot type to choose which incuding &quot;line&quot;,&quot;heatmap&quot; and &quot;both&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_ms.col">ms.col</code></td>
<td>
<p>membership line color form Mfuzz cluster method results,
default c('#0099CC','grey90','#CC3333').</p>
</td></tr>
<tr><td><code id="visCluster_+3A_line.size">line.size</code></td>
<td>
<p>line size for line plot, default 0.1.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_line.col">line.col</code></td>
<td>
<p>line color for line plot, default &quot;grey90&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_add.mline">add.mline</code></td>
<td>
<p>whether add median line on plot, default TRUE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_mline.size">mline.size</code></td>
<td>
<p>median line size, default 2.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_mline.col">mline.col</code></td>
<td>
<p>median line color, default &quot;#CC3333&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_ncol">ncol</code></td>
<td>
<p>the columns for facet plot with line plot, default 4.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_ctanno.col">ctAnno.col</code></td>
<td>
<p>the heatmap cluster annotation bar colors, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_set.md">set.md</code></td>
<td>
<p>the represent line method on heatmap-line plot(mean/median), default &quot;median&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_textbox.pos">textbox.pos</code></td>
<td>
<p>the relative position of text in left-line plot, default c(0.5,0.8).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_textbox.size">textbox.size</code></td>
<td>
<p>the text size of the text in left-line plot, default 8.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_panel.arg">panel.arg</code></td>
<td>
<p>the settings for the left-line panel which are
panel size,gap,width,fill and col, default c(2,0.25,4,&quot;grey90&quot;,NA).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_ggplot.panel.arg">ggplot.panel.arg</code></td>
<td>
<p>the settings for the ggplot2 object plot panel which are
panel size,gap,width,fill and col, default c(2,0.25,4,&quot;grey90&quot;,NA).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_annoterm.data">annoTerm.data</code></td>
<td>
<p>the GO term annotation for the clusters, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_annoterm.mside">annoTerm.mside</code></td>
<td>
<p>the wider GO term annotation box side, default &quot;right&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_termanno.arg">termAnno.arg</code></td>
<td>
<p>the settings for GO term panel annotations which are fill and col,
default c(&quot;grey95&quot;,&quot;grey50&quot;).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_add.bar">add.bar</code></td>
<td>
<p>whether add bar plot for GO enrichment, default FALSE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_bar.width">bar.width</code></td>
<td>
<p>the GO enrichment bar width, default 8.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_textbar.pos">textbar.pos</code></td>
<td>
<p>the barplot text relative position, default c(0.8,0.8).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_go.col">go.col</code></td>
<td>
<p>the GO term text colors, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_go.size">go.size</code></td>
<td>
<p>the GO term text size(numeric or &quot;pval&quot;), default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_by.go">by.go</code></td>
<td>
<p>the GO term text box style(&quot;anno_link&quot; or &quot;anno_block&quot;), default &quot;anno_link&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_annokegg.data">annoKegg.data</code></td>
<td>
<p>the KEGG term annotation for the clusters, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_annokegg.mside">annoKegg.mside</code></td>
<td>
<p>the wider KEGG term annotation box side, default &quot;right&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_kegganno.arg">keggAnno.arg</code></td>
<td>
<p>the settings for KEGG term panel annotations which are fill and col,
default c(&quot;grey95&quot;,&quot;grey50&quot;).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_add.kegg.bar">add.kegg.bar</code></td>
<td>
<p>whether add bar plot for KEGG enrichment, default FALSE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_kegg.col">kegg.col</code></td>
<td>
<p>the KEGG term text colors, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_kegg.size">kegg.size</code></td>
<td>
<p>the KEGG term text size(numeric or &quot;pval&quot;), default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_by.kegg">by.kegg</code></td>
<td>
<p>the KEGG term text box style(&quot;anno_link&quot; or &quot;anno_block&quot;), default &quot;anno_link&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_word_wrap">word_wrap</code></td>
<td>
<p>whether wrap the text, default TRUE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_add_new_line">add_new_line</code></td>
<td>
<p>whether add new line when text is long, default TRUE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_add.box">add.box</code></td>
<td>
<p>whether add boxplot, default FALSE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_boxcol">boxcol</code></td>
<td>
<p>the box fill colors, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_box.arg">box.arg</code></td>
<td>
<p>this is related to boxplot width and border color, default c(0.1,&quot;grey50&quot;).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_add.point">add.point</code></td>
<td>
<p>whether add point, default FALSE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_point.arg">point.arg</code></td>
<td>
<p>this is related to point shape,fill,color and size, default c(19,&quot;orange&quot;,&quot;orange&quot;,1).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_add.line">add.line</code></td>
<td>
<p>whether add line, default TRUE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_line.side">line.side</code></td>
<td>
<p>the line annotation side, default &quot;right&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_markgenes">markGenes</code></td>
<td>
<p>the gene names to be added on plot, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_markgenes.side">markGenes.side</code></td>
<td>
<p>the gene label side, default &quot;right&quot;.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_genes.gp">genes.gp</code></td>
<td>
<p>gene labels graphics settings, default c('italic',10,NA).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_term.text.limit">term.text.limit</code></td>
<td>
<p>the GO term text size limit, default c(10,18).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_mulgroup">mulGroup</code></td>
<td>
<p>to draw multiple lines annotation, supply the groups numbers with vector, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_lgd.label">lgd.label</code></td>
<td>
<p>the lines annotation legend labels, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_show_row_names">show_row_names</code></td>
<td>
<p>whether to show row names, default FALSE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_subgroup.anno">subgroup.anno</code></td>
<td>
<p>the sub-cluster for annotation, supply sub-cluster id, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_annnoblock.text">annnoblock.text</code></td>
<td>
<p>whether add cluster numbers on right block annotation, default TRUE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_annnoblock.gp">annnoblock.gp</code></td>
<td>
<p>right block annotation text color and size, default c(&quot;white&quot;,8).</p>
</td></tr>
<tr><td><code id="visCluster_+3A_add.sampleanno">add.sampleanno</code></td>
<td>
<p>whether add column annotation, default TRUE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_sample.group">sample.group</code></td>
<td>
<p>the column sample groups, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_sample.col">sample.col</code></td>
<td>
<p>column annotation colors, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_sample.order">sample.order</code></td>
<td>
<p>the orders for column samples, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_cluster.order">cluster.order</code></td>
<td>
<p>the row cluster orders for user's own defination, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_sample.cell.order">sample.cell.order</code></td>
<td>
<p>the celltype order when input is scRNA data and &quot;showAverage = FALSE&quot;
for prepareDataFromscRNA.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_heatmapannotation">HeatmapAnnotation</code></td>
<td>
<p>the 'HeatmapAnnotation' object from 'ComplexHeatmap'
when you have multiple annotations, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_column.split">column.split</code></td>
<td>
<p>how to split the columns when supply multiple column annotations, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_cluster_columns">cluster_columns</code></td>
<td>
<p>whether cluster the columns, default FALSE.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_pseudotime_col">pseudotime_col</code></td>
<td>
<p>the branch color control for monocle input data.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_gglist">gglist</code></td>
<td>
<p>a list of ggplot object to annotate each cluster, default NULL.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_row_annotation_obj">row_annotation_obj</code></td>
<td>
<p>Row annotation for heatmap, it is a <code>ComplexHeatmap::rowAnnotation()</code> object
when &quot;markGenes.side&quot; or line.side is &quot;right&quot;. Otherwise is a list of named vectors.</p>
</td></tr>
<tr><td><code id="visCluster_+3A_...">...</code></td>
<td>
<p>othe aruguments passed by Heatmap fuction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function visualizes clustered gene expression data as line plots, heatmaps, or
a combination of both, using the <code>ComplexHeatmap</code> and <code>ggplot2</code> frameworks. Gene
annotations, sample annotations, and additional features like custom color schemes
and annotations for GO/KEGG terms are supported for visualization.
</p>


<h3>Value</h3>

<p>a ggplot2 or Heatmap object.
</p>


<h3>Author(s)</h3>

<p>JunZhang
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("exps")

# mfuzz
cm &lt;- clusterData(obj = exps,
                  cluster.method = "kmeans",
                  cluster.num = 8)

# plot
visCluster(object = cm,
           plot.type = "line")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
