<!DOCTYPE html><html lang="en"><head><title>Help for package ecode</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ecode}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ecode-package'><p>ecode: Ordinary Differential Equation Systems in Ecology</p></a></li>
<li><a href='#-.pp'><p>Subtract Operator for Phase Points</p></a></li>
<li><a href='#+5B.pdata'><p>Extract Parts of an Population Dynamics Data</p></a></li>
<li><a href='#+2A.pp'><p>Multiply Operator for Phase Points</p></a></li>
<li><a href='#+2F.pp'><p>Divide Operator for Phase Points</p></a></li>
<li><a href='#+2B.pp'><p>Add Operator for Phase Points</p></a></li>
<li><a href='#eode'><p>Create an ODE System</p></a></li>
<li><a href='#eode_get_cripoi'><p>Find Equilibrium Point</p></a></li>
<li><a href='#eode_get_sysmat'><p>System Matrix</p></a></li>
<li><a href='#eode_get_velocity'><p>Velocity Vector</p></a></li>
<li><a href='#eode_gridSearch'><p>Grid Search For Optimal Parameters</p></a></li>
<li><a href='#eode_is_centre'><p>Centre</p></a></li>
<li><a href='#eode_is_saddle'><p>Saddle</p></a></li>
<li><a href='#eode_is_stafoc'><p>Stable Focus</p></a></li>
<li><a href='#eode_is_stanod'><p>Stable Node</p></a></li>
<li><a href='#eode_is_stapoi'><p>Stable Equilibrium Point</p></a></li>
<li><a href='#eode_is_unsfoc'><p>Unstable Focus</p></a></li>
<li><a href='#eode_is_unsnod'><p>Unstable Node</p></a></li>
<li><a href='#eode_is_validval'><p>Test the Validity of a Phase Point</p></a></li>
<li><a href='#eode_lossf'><p>Calculate Loss Function</p></a></li>
<li><a href='#eode_proj'><p>Solve ODEs</p></a></li>
<li><a href='#eode_sensitivity_proj'><p>Sensitivity Analysis</p></a></li>
<li><a href='#eode_set_constraint'><p>Set New Constraints</p></a></li>
<li><a href='#eode_set_parameter'><p>Set New Parameters</p></a></li>
<li><a href='#eode_simuAnnealing'><p>Simulated Annealing For Optimal Parameters</p></a></li>
<li><a href='#eode_stability_type'><p>Stability Analysis</p></a></li>
<li><a href='#length.eode'><p>Length of an ODE System</p></a></li>
<li><a href='#length.pdata'><p>Get Length Of Population Dynamics Data</p></a></li>
<li><a href='#pc_calculator'><p>Variable Calculator In ODE Systems</p></a></li>
<li><a href='#pc_plot'><p>Plot a Phase Curve in Phase Plane</p></a></li>
<li><a href='#pdata'><p>Create Population Dynamics Data</p></a></li>
<li><a href='#pdist'><p>Distance between Phase Points</p></a></li>
<li><a href='#plot.eode'><p>Plot Phase Velocity Vector Field</p></a></li>
<li><a href='#plot.pc'><p>Plot a Phase Curve With Time</p></a></li>
<li><a href='#plot.pcfamily'><p>Plot Phase Curve Family</p></a></li>
<li><a href='#plot.velocity'><p>Create a Plot of a Phase Velocity Vector</p></a></li>
<li><a href='#pp'><p>Create a Phase Point</p></a></li>
<li><a href='#print.eode'><p>Print Brief Details of an ODE System</p></a></li>
<li><a href='#print.pc'><p>Print Brief Details of a Phase Curve</p></a></li>
<li><a href='#print.pcfamily'><p>Print Brief Details of a Phase Curve Family</p></a></li>
<li><a href='#print.pdata'><p>Print Brief Details of Population Dynamics Data</p></a></li>
<li><a href='#print.pp'><p>Print Brief Details of a Phase Point</p></a></li>
<li><a href='#print.velocity'><p>Print Brief Details of a Phase Velocity Vector</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Ordinary Differential Equation Systems in Ecology</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A framework to simulate ecosystem dynamics through ordinary differential equations (ODEs). 
    You create an ODE model, tells 'ecode' to explore its behaviour, and perform numerical 
    simulations on the model. 'ecode' also allows you to fit model parameters by machine learning 
    algorithms. Potential users include researchers who are interested in the dynamics of ecological 
    community and biogeochemical cycles.</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, cowplot, rlang, stringr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/HaoranPopEvo/ecode/issues">https://github.com/HaoranPopEvo/ecode/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/HaoranPopEvo/ecode">https://github.com/HaoranPopEvo/ecode</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-30 14:55:42 UTC; asa</td>
</tr>
<tr>
<td>Author:</td>
<td>Haoran Wu <a href="https://orcid.org/0000-0001-9449-6112"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Chen Peng <a href="https://orcid.org/0000-0002-9449-7606"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Haoran Wu &lt;haoran.wu@wolfson.ox.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-02 06:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ecode-package'>ecode: Ordinary Differential Equation Systems in Ecology</h2><span id='topic+ecode'></span><span id='topic+ecode-package'></span>

<h3>Description</h3>

<p>A framework to simulate ecosystem dynamics through ordinary differential equations (ODEs). You create an ODE model, tells 'ecode' to explore its behaviour, and perform numerical simulations on the model. 'ecode' also allows you to fit model parameters by machine learning algorithms. Potential users include researchers who are interested in the dynamics of ecological community and biogeochemical cycles.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Haoran Wu <a href="mailto:haoran.wu@wolfson.ox.ac.uk">haoran.wu@wolfson.ox.ac.uk</a> (<a href="https://orcid.org/0000-0001-9449-6112">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Chen Peng <a href="mailto:pengchen2001@zju.edu.cn">pengchen2001@zju.edu.cn</a> (<a href="https://orcid.org/0000-0002-9449-7606">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/HaoranPopEvo/ecode">https://github.com/HaoranPopEvo/ecode</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/HaoranPopEvo/ecode/issues">https://github.com/HaoranPopEvo/ecode/issues</a>
</p>
</li></ul>


<hr>
<h2 id='-.pp'>Subtract Operator for Phase Points</h2><span id='topic+-.pp'></span>

<h3>Description</h3>

<p>The subtract operator used to perform arithmetic on phase points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pp'
x - y
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="-.pp_+3A_x">x</code></td>
<td>
<p>an object of <code>"pp"</code> class representing a phase point.</p>
</td></tr>
<tr><td><code id="-.pp_+3A_y">y</code></td>
<td>
<p>an object of <code>"pp"</code> class representing another phase point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of <code>"pp"</code> class representing the calculated result.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pp(list(x = 1, y = 1)) - pp(list(x = 3, y = 4))
</code></pre>

<hr>
<h2 id='+5B.pdata'>Extract Parts of an Population Dynamics Data</h2><span id='topic++5B.pdata'></span>

<h3>Description</h3>

<p>Operators acting on population dynamics data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pdata'
x[i]
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B5B.pdata_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>pdata</code>&quot;.</p>
</td></tr>
<tr><td><code id="+2B5B.pdata_+3A_i">i</code></td>
<td>
<p>indice specifying elements to extract.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>pdata object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
pdat &lt;- pdata(x,
  init = data.frame(x = c(10, 20), y = c(5, 15)),
  t = c(3, 3),
  lambda = data.frame(z = c(15, 30)),
  formula = "z = x + y"
)
pdat[1]
</code></pre>

<hr>
<h2 id='+2A.pp'>Multiply Operator for Phase Points</h2><span id='topic++2A.pp'></span>

<h3>Description</h3>

<p>The multiply operator used to perform arithmetic on phase points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pp'
x * y
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B2A.pp_+3A_x">x</code></td>
<td>
<p>an object of <code>"pp"</code> class representing a phase point.</p>
</td></tr>
<tr><td><code id="+2B2A.pp_+3A_y">y</code></td>
<td>
<p>an object of <code>"pp"</code> class representing another phase point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of <code>"pp"</code> class representing the calculated result.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pp(list(x = 1, y = 1)) * pp(list(x = 3, y = 4))
</code></pre>

<hr>
<h2 id='+2F.pp'>Divide Operator for Phase Points</h2><span id='topic++2F.pp'></span>

<h3>Description</h3>

<p>The devide operator used to perform arithmetic on phase points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pp'
x / y
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B2F.pp_+3A_x">x</code></td>
<td>
<p>an object of <code>"pp"</code> class representing a phase point.</p>
</td></tr>
<tr><td><code id="+2B2F.pp_+3A_y">y</code></td>
<td>
<p>an object of <code>"pp"</code> class representing another phase point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of <code>"pp"</code> class representing the calculated result.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pp(list(x = 1, y = 1)) / pp(list(x = 3, y = 4))
</code></pre>

<hr>
<h2 id='+2B.pp'>Add Operator for Phase Points</h2><span id='topic++2B.pp'></span>

<h3>Description</h3>

<p>The add operator used to perform arithmetic on phase points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pp'
x + y
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B2B.pp_+3A_x">x</code></td>
<td>
<p>an object of <code>"pp"</code> class representing a phase point.</p>
</td></tr>
<tr><td><code id="+2B2B.pp_+3A_y">y</code></td>
<td>
<p>an object of <code>"pp"</code> class representing another phase point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of <code>"pp"</code> class representing the calculated result.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pp(list(x = 1, y = 1)) + pp(list(x = 3, y = 4))
</code></pre>

<hr>
<h2 id='eode'>Create an ODE System</h2><span id='topic+eode'></span>

<h3>Description</h3>

<p>Creates an object of class &quot;<code>eode</code>&quot; representing an ODE system that
describes population or community dynamics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode(..., constraint = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_+3A_...">...</code></td>
<td>
<p>Objects of class &quot;<code>function</code>&quot;, each representing a single
differential equation.</p>
</td></tr>
<tr><td><code id="eode_+3A_constraint">constraint</code></td>
<td>
<p>Character strings that must have a format of
&quot;<code>variable&gt;value</code>&quot; or &quot;<code>variable&lt;value</code>&quot;, such as &quot;x&gt;1&quot;, &quot;y&gt;3&quot;, etc.
If not specified, then all model variables are considered as positive real
numbers by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>eode</code>&quot; describing population or community
dynamics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example1: Lotka-Volterra competition model
eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
x

## Example2: Susceptible-infected model
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
x
</code></pre>

<hr>
<h2 id='eode_get_cripoi'>Find Equilibrium Point</h2><span id='topic+eode_get_cripoi'></span>

<h3>Description</h3>

<p>Finds an equilibrium point (or critical point) of an ODE system based on
Newton iteration method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_get_cripoi(
  x,
  init_value,
  eps = 0.001,
  max_step = 0.01,
  method = c("Newton", "GradDesc"),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_get_cripoi_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_get_cripoi_+3A_init_value">init_value</code></td>
<td>
<p>An object of class &quot;<code>pp</code>&quot; representing a phase point
giving start estimates.</p>
</td></tr>
<tr><td><code id="eode_get_cripoi_+3A_eps">eps</code></td>
<td>
<p>Precision for the stopping criterion. Iteration will stop after
the movement of the phase point in a single step is smaller than <code>eps</code>.</p>
</td></tr>
<tr><td><code id="eode_get_cripoi_+3A_max_step">max_step</code></td>
<td>
<p>Maximum number</p>
</td></tr>
<tr><td><code id="eode_get_cripoi_+3A_method">method</code></td>
<td>
<p>one of &quot;Newton&quot;, &quot;GradDesc&quot;</p>
</td></tr>
<tr><td><code id="eode_get_cripoi_+3A_verbose">verbose</code></td>
<td>
<p>Logical, whether to print the iteration process.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>pp</code>&quot; representing an equilibrium point found.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Lotka-Volterra competition model
eq1 &lt;- function(x, y, r1 = 1, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_get_cripoi(x, init_value = pp(list(x = 0.5, y = 0.5)))

## Example 2: Susceptible-infected model
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
eode_get_cripoi(x, init_value = pp(list(X_C = 1, Y_C = 1, X_A = 1, Y_A = 1)))
</code></pre>

<hr>
<h2 id='eode_get_sysmat'>System Matrix</h2><span id='topic+eode_get_sysmat'></span>

<h3>Description</h3>

<p>Linearlise an ODE system and calculate its system matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_get_sysmat(x, value, delta = 0.00001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_get_sysmat_+3A_x">x</code></td>
<td>
<p>object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_get_sysmat_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_get_sysmat_+3A_delta">delta</code></td>
<td>
<p>Spacing or step size of a numerical grid used for calculating
numerical differentiation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>matrix</code>&quot;. Each matrix entry, (i,j), represents
the partial derivative of the i-th equation of the system with respect to the
j-th variable taking other variables as a constant.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example1: Lotka-Volterra competition model
eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_get_sysmat(x, value = pp(list(x = 1, y = 1)), delta = 10e-6)

## Example2: Susceptible-infected model
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
eode_get_sysmat(x, value = pp(list(X_A = 4, Y_A = 4, X_C = 4, Y_C = 4)), delta = 10e-6)

</code></pre>

<hr>
<h2 id='eode_get_velocity'>Velocity Vector</h2><span id='topic+eode_get_velocity'></span>

<h3>Description</h3>

<p>Calculates the velocity vector at a given phase point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_get_velocity(x, value, phase_curve = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_get_velocity_+3A_x">x</code></td>
<td>
<p>The ODE system under consideration. An object of class &quot;<code>eode</code>&quot;.</p>
</td></tr>
<tr><td><code id="eode_get_velocity_+3A_value">value</code></td>
<td>
<p>an object of &quot;<code>pp</code>&quot; classs representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_get_velocity_+3A_phase_curve">phase_curve</code></td>
<td>
<p>an object of &quot;<code>pc</code>&quot; class representing a phase curve.
Only used when there is delayed items in the ODE system.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;<code>velocity</code>&quot; representing a velocity vector at
a given phase point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example1: Lotka-Volterra competition model
eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_get_velocity(x, value = pp(list(x = 1, y = 1)))

## Example2: Susceptible-infected model
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
eode_get_velocity(x, value = pp(list(X_A = 5, Y_A = 5, X_C = 3, Y_C = 2)))

</code></pre>

<hr>
<h2 id='eode_gridSearch'>Grid Search For Optimal Parameters</h2><span id='topic+eode_gridSearch'></span>

<h3>Description</h3>

<p>Find optimal parameters in the ODE system using grid search method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_gridSearch(x, pdat, space, step = 0.01)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_gridSearch_+3A_x">x</code></td>
<td>
<p>the ODE system under consideration. An object of &quot;<code>eode</code>&quot; class.</p>
</td></tr>
<tr><td><code id="eode_gridSearch_+3A_pdat">pdat</code></td>
<td>
<p>observed population dynamics. An object of &quot;<code>pdata</code>&quot; class.</p>
</td></tr>
<tr><td><code id="eode_gridSearch_+3A_space">space</code></td>
<td>
<p>space</p>
</td></tr>
<tr><td><code id="eode_gridSearch_+3A_step">step</code></td>
<td>
<p>interval of time for running simulations. Parameter of the function &quot;<code>eode_proj()</code>&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame showing attempted parameters along with the corresponding values of loss function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
training_data &lt;- pdata(x,
  init = data.frame(
    X_A = c(9, 19, 29, 39),
    Y_A = c(1, 1, 1, 1),
    X_C = c(5, 5, 5, 5),
    Y_C = c(0, 0, 0, 0)
  ),
  t = c(3, 3, 3, 3),
  lambda = data.frame(incidence = c(0.4, 0.8, 0.9, 0.95)),
  formula = "incidence = (Y_A + Y_C)/(X_A + X_C + Y_A + Y_C)"
)
res &lt;- eode_gridSearch(x, pdat = training_data, space = list(beta = seq(0.05, 0.15, 0.01)))
res

</code></pre>

<hr>
<h2 id='eode_is_centre'>Centre</h2><span id='topic+eode_is_centre'></span>

<h3>Description</h3>

<p>Check whether an equilibrium point is a neutral centre or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_is_centre(x, value, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_is_centre_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_is_centre_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_is_centre_+3A_eps">eps</code></td>
<td>
<p>Precision used to check whether the input phase point is an equilibrium
point. If the absolute value of any component of the phase velocity vector at a
phase point is lower than <code>eps</code>, an error would be thrown out.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 1, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_is_centre(x, value = pp(list(x = 0.3333, y = 0.3333)))
</code></pre>

<hr>
<h2 id='eode_is_saddle'>Saddle</h2><span id='topic+eode_is_saddle'></span>

<h3>Description</h3>

<p>Check whether an equilibrium point is a saddle or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_is_saddle(x, value, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_is_saddle_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_is_saddle_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_is_saddle_+3A_eps">eps</code></td>
<td>
<p>Precision used to check whether the input phase point is an equilibrium
point. If the absolute value of any component of the phase velocity vector at a
phase point is lower than <code>eps</code>, an error would be thrown out.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 1, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_is_saddle(x, value = pp(list(x = 0.3333, y = 0.3333)))
</code></pre>

<hr>
<h2 id='eode_is_stafoc'>Stable Focus</h2><span id='topic+eode_is_stafoc'></span>

<h3>Description</h3>

<p>Check whether an equilibrium point is a stable focus or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_is_stafoc(x, value, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_is_stafoc_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_is_stafoc_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_is_stafoc_+3A_eps">eps</code></td>
<td>
<p>Precision used to check whether the input phase point is an equilibrium
point. If the absolute value of any component of the phase velocity vector at a
phase point is lower than <code>eps</code>, an error would be thrown out.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 1, a11 = 2, a12 = 1) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 1, a22 = 2) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_is_stafoc(x, value = pp(list(x = 0.3333, y = 0.3333)))
</code></pre>

<hr>
<h2 id='eode_is_stanod'>Stable Node</h2><span id='topic+eode_is_stanod'></span>

<h3>Description</h3>

<p>Check whether an equilibrium point is a stable node or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_is_stanod(x, value, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_is_stanod_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_is_stanod_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_is_stanod_+3A_eps">eps</code></td>
<td>
<p>Precision used to check whether the input phase point is an equilibrium
point. If the absolute value of any component of the phase velocity vector at a
phase point is lower than <code>eps</code>, an error would be thrown out.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 1, a11 = 2, a12 = 1) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 1, a22 = 2) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_is_stanod(x, value = pp(list(x = 0.3333, y = 0.3333)))
</code></pre>

<hr>
<h2 id='eode_is_stapoi'>Stable Equilibrium Point</h2><span id='topic+eode_is_stapoi'></span>

<h3>Description</h3>

<p>Check whether an equilibrium point is stable or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_is_stapoi(x, value, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_is_stapoi_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_is_stapoi_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_is_stapoi_+3A_eps">eps</code></td>
<td>
<p>Precision used to check whether the input phase point is an equilibrium
point. If the absolute value of any component of the phase velocity vector at a
phase point is lower than <code>eps</code>, an error would be thrown out.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 1, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_is_stapoi(x, value = pp(list(x = 0.3333, y = 0.3333)))

## Example2: Susceptible-infected model
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c(
    "X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0",
    "X_C&lt;5", "Y_C&lt;5", "X_A&lt;5", "Y_A&lt;5"
  )
)
eode_is_stapoi(x, value = pp(list(X_A = 1.3443, Y_A = 0.2304, X_C = 1.0655, Y_C = 0.0866)))
</code></pre>

<hr>
<h2 id='eode_is_unsfoc'>Unstable Focus</h2><span id='topic+eode_is_unsfoc'></span>

<h3>Description</h3>

<p>Check whether an equilibrium point is an unstable focus or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_is_unsfoc(x, value, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_is_unsfoc_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_is_unsfoc_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_is_unsfoc_+3A_eps">eps</code></td>
<td>
<p>Precision used to check whether the input phase point is an equilibrium
point. If the absolute value of any component of the phase velocity vector at a
phase point is lower than <code>eps</code>, an error would be thrown out.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 1, a11 = 2, a12 = 1) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 1, a22 = 2) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_is_unsfoc(x, value = pp(list(x = 0.3333, y = 0.3333)))
</code></pre>

<hr>
<h2 id='eode_is_unsnod'>Unstable Node</h2><span id='topic+eode_is_unsnod'></span>

<h3>Description</h3>

<p>Check whether an equilibrium point is an unstable node or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_is_unsnod(x, value, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_is_unsnod_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_is_unsnod_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_is_unsnod_+3A_eps">eps</code></td>
<td>
<p>Precision used to check whether the input phase point is an equilibrium
point. If the absolute value of any component of the phase velocity vector at a
phase point is lower than <code>eps</code>, an error would be thrown out.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 1, a11 = 2, a12 = 1) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 1, a22 = 2) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_is_unsnod(x, value = pp(list(x = 0.3333, y = 0.3333)))
</code></pre>

<hr>
<h2 id='eode_is_validval'>Test the Validity of a Phase Point</h2><span id='topic+eode_is_validval'></span>

<h3>Description</h3>

<p>Test whether a phase point sits out of the boundary of an ODE system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_is_validval(x, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_is_validval_+3A_x">x</code></td>
<td>
<p>object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_is_validval_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns <code>TRUE</code> or <code>FALSE</code> depending on whether the values of
the system variables are within the boundary or not.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_is_validval(x, value = pp(list(x = 1, y = 1)))
</code></pre>

<hr>
<h2 id='eode_lossf'>Calculate Loss Function</h2><span id='topic+eode_lossf'></span>

<h3>Description</h3>

<p>Calculate the quadratic loss function given an ODE system and observed population dynamics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_lossf(x, pdat, step = 0.01)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_lossf_+3A_x">x</code></td>
<td>
<p>the ODE system under consideration. An object of &quot;<code>eode</code>&quot; class.</p>
</td></tr>
<tr><td><code id="eode_lossf_+3A_pdat">pdat</code></td>
<td>
<p>observed population dynamics. An object of &quot;<code>pdata</code>&quot; class.</p>
</td></tr>
<tr><td><code id="eode_lossf_+3A_step">step</code></td>
<td>
<p>interval of time for each step. Parameter of the function &quot;<code>eode_proj()</code>&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a value of loss function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
training_data &lt;- pdata(x,
  init = data.frame(
    X_A = c(9, 19, 29, 39),
    Y_A = c(1, 1, 1, 1),
    X_C = c(5, 5, 5, 5),
    Y_C = c(0, 0, 0, 0)
  ),
  t = c(3, 3, 3, 3),
  lambda = data.frame(incidence = c(0.4, 0.8, 0.9, 0.95)),
  formula = "incidence = (Y_A + Y_C)/(X_A + X_C + Y_A + Y_C)"
)
eode_lossf(x, pdat = training_data)
</code></pre>

<hr>
<h2 id='eode_proj'>Solve ODEs</h2><span id='topic+eode_proj'></span>

<h3>Description</h3>

<p>Provides the numerical solution of an ODE under consideration given an initial
condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_proj(x, value0, N, step = 0.01)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_proj_+3A_x">x</code></td>
<td>
<p>the ODE system under consideration. An object of class &quot;<code>eode</code>&quot;.</p>
</td></tr>
<tr><td><code id="eode_proj_+3A_value0">value0</code></td>
<td>
<p>value an object of class &quot;<code>pp</code>&quot; representing the phase point
at the initial state.</p>
</td></tr>
<tr><td><code id="eode_proj_+3A_n">N</code></td>
<td>
<p>number of iterations</p>
</td></tr>
<tr><td><code id="eode_proj_+3A_step">step</code></td>
<td>
<p>interval of time for each step</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;<code>pc</code>&quot; that represents a phase curve
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example1: Lotka-Volterra competition model
eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2, constraint = c("x&lt;1", "y&lt;1"))
eode_proj(x, value0 = pp(list(x = 0.2, y = 0.1)), N = 100)

## Example2: Susceptible-infected model
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
eode_proj(x, value0 = pp(list(X_A = 5, Y_A = 5, X_C = 3, Y_C = 2)), N = 100)
</code></pre>

<hr>
<h2 id='eode_sensitivity_proj'>Sensitivity Analysis</h2><span id='topic+eode_sensitivity_proj'></span>

<h3>Description</h3>

<p>Run a sensitivity analysis on an ODE system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_sensitivity_proj(x, valueSpace, N, step = 0.01)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_sensitivity_proj_+3A_x">x</code></td>
<td>
<p>object of class &quot;<code>pc</code>&quot; that represents the ODE system under
consideration.</p>
</td></tr>
<tr><td><code id="eode_sensitivity_proj_+3A_valuespace">valueSpace</code></td>
<td>
<p>a list indicating initial conditions and parameters. Model
variables must be included to specify initial values of each variable. Values
can be a vector, indicating all the potential values to be considered in the
sensitivity analysis.</p>
</td></tr>
<tr><td><code id="eode_sensitivity_proj_+3A_n">N</code></td>
<td>
<p>number of iterations</p>
</td></tr>
<tr><td><code id="eode_sensitivity_proj_+3A_step">step</code></td>
<td>
<p>interval of time for running simulations. Parameter of the function &quot;<code>eode_proj()</code>&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of &quot;<code>pcfamily</code>&quot; class, each component having three
sub-components:
<code>$grid_var</code>: variables or parameters whose values are changed throughout
the sensitivity analysis.
<code>$fixed_var</code>: variables whose values are not changed.
<code>$pc</code>: phase curve. An object of &quot;<code>pc</code>&quot; class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2, constraint = c("x&lt;100", "y&lt;100"))
eode_sensitivity_proj(x, valueSpace = list(x = c(0.2, 0.3, 0.4), y = 0.1, a11 = 1:3), N = 100)
</code></pre>

<hr>
<h2 id='eode_set_constraint'>Set New Constraints</h2><span id='topic+eode_set_constraint'></span>

<h3>Description</h3>

<p>Set new constraints for an ODE system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_set_constraint(x, new_constraint)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_set_constraint_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>eode</code>&quot;.</p>
</td></tr>
<tr><td><code id="eode_set_constraint_+3A_new_constraint">new_constraint</code></td>
<td>
<p>a vector of characters indicating new constraints
to be assigned to the ODE system.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of &quot;<code>eode</code>&quot; class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
x
eode_set_constraint(x, c("x&lt;5", "y&lt;5"))
</code></pre>

<hr>
<h2 id='eode_set_parameter'>Set New Parameters</h2><span id='topic+eode_set_parameter'></span>

<h3>Description</h3>

<p>Set new parameters for an ODE system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_set_parameter(x, ParaList)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_set_parameter_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>eode</code>&quot;.</p>
</td></tr>
<tr><td><code id="eode_set_parameter_+3A_paralist">ParaList</code></td>
<td>
<p>a list of names of parameters with their corresponding values
to be assigned to the ODE system.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of &quot;<code>eode</code>&quot; class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
x
eode_set_parameter(x, ParaList = list(r1 = 3))
</code></pre>

<hr>
<h2 id='eode_simuAnnealing'>Simulated Annealing For Optimal Parameters</h2><span id='topic+eode_simuAnnealing'></span>

<h3>Description</h3>

<p>Find optimal parameters in the ODE system using simulated annealing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_simuAnnealing(
  x,
  pdat,
  paras = "ALL",
  max_disturb = 0.2,
  AnnN = 100,
  step = 0.01,
  prop.train = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_simuAnnealing_+3A_x">x</code></td>
<td>
<p>the ODE system under consideration. An object of &quot;<code>eode</code>&quot; class.</p>
</td></tr>
<tr><td><code id="eode_simuAnnealing_+3A_pdat">pdat</code></td>
<td>
<p>observed population dynamics. An object of &quot;<code>pdata</code>&quot; class.</p>
</td></tr>
<tr><td><code id="eode_simuAnnealing_+3A_paras">paras</code></td>
<td>
<p>parameters to be optimised. A character vector. If multiple parameters
are specified, the simulation annealing process will proceed by altering multiple
parameters at the same time, and accept an alteration if it achieves a lower value of
the loss function. Default is &quot;ALL&quot;, which means to choose all the parameters.</p>
</td></tr>
<tr><td><code id="eode_simuAnnealing_+3A_max_disturb">max_disturb</code></td>
<td>
<p>maximum disturbance in proportion. The biggest disturbance acts on
parameters at the beginning of the simulated annealing process.</p>
</td></tr>
<tr><td><code id="eode_simuAnnealing_+3A_annn">AnnN</code></td>
<td>
<p>steps of simulated annealing.</p>
</td></tr>
<tr><td><code id="eode_simuAnnealing_+3A_step">step</code></td>
<td>
<p>interval of time for running simulations. Parameter of the function &quot;<code>eode_proj()</code>&quot;.</p>
</td></tr>
<tr><td><code id="eode_simuAnnealing_+3A_prop.train">prop.train</code></td>
<td>
<p>proportion of training data set. In each step of annealing, a proportion
of dataset will be randomly decided for model training, and the rest for model validation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame showing attempted parameters along with the corresponding values of loss function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
training_data &lt;- pdata(x,
  init = data.frame(
    X_A = c(9, 19, 29, 39),
    Y_A = c(1, 1, 1, 1),
    X_C = c(5, 5, 5, 5),
    Y_C = c(0, 0, 0, 0)
  ),
  t = c(3, 3, 3, 3),
  lambda = data.frame(incidence = c(0.4, 0.8, 0.9, 0.95)),
  formula = "incidence = (Y_A + Y_C)/(X_A + X_C + Y_A + Y_C)"
)
res &lt;- eode_simuAnnealing(x, pdat = training_data, paras = "beta", max_disturb = 0.05, AnnN = 20)
res

</code></pre>

<hr>
<h2 id='eode_stability_type'>Stability Analysis</h2><span id='topic+eode_stability_type'></span>

<h3>Description</h3>

<p>Check whether an equilibrium point is stable or not, and give
the specific type (i.e. stable node, stable focus, unstable node,
unstable focus, saddle, or centre).
Check whether an equilibrium point is stable or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eode_stability_type(x, value, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eode_stability_type_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot; representing an ODE system.</p>
</td></tr>
<tr><td><code id="eode_stability_type_+3A_value">value</code></td>
<td>
<p>an object of class &quot;<code>pp</code>&quot; representing a phase point in the
ODE system under consideration.</p>
</td></tr>
<tr><td><code id="eode_stability_type_+3A_eps">eps</code></td>
<td>
<p>Precision used to check whether the input phase point is an equilibrium
point. If the absolute value of any component of the phase velocity vector at a
phase point is lower than <code>eps</code>, an error would be thrown out.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a string character indicate the type of the equilbrium point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 1, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_stability_type(x, value = pp(list(x = 0.3333, y = 0.3333)))
</code></pre>

<hr>
<h2 id='length.eode'>Length of an ODE System</h2><span id='topic+length.eode'></span>

<h3>Description</h3>

<p>Get the number of equations in an ODE system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eode'
length(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="length.eode_+3A_x">x</code></td>
<td>
<p>Object of &quot;<code>eode</code>&quot; class representing an ODE system under consideration.</p>
</td></tr>
<tr><td><code id="length.eode_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of equations in the ODE system.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Lotka-Volterra competition model
eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
length(x)

## Example 2: Susceptible-infected model
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
length(x)
</code></pre>

<hr>
<h2 id='length.pdata'>Get Length Of Population Dynamics Data</h2><span id='topic+length.pdata'></span>

<h3>Description</h3>

<p>Get the number of observations of population dynamics data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pdata'
length(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="length.pdata_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>pdata</code>&quot;.</p>
</td></tr>
<tr><td><code id="length.pdata_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
pdata(x,
  init = data.frame(x = c(10, 20), y = c(5, 15)),
  t = c(3, 3),
  lambda = data.frame(z = c(15, 30)),
  formula = "z = x + y"
)
</code></pre>

<hr>
<h2 id='pc_calculator'>Variable Calculator In ODE Systems</h2><span id='topic+pc_calculator'></span>

<h3>Description</h3>

<p>Calculate one or several variables during the simulation of an ODE system
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pc_calculator(x, formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pc_calculator_+3A_x">x</code></td>
<td>
<p>the ODE system under consideration. An object of &quot;<code>eode</code>&quot; class.</p>
</td></tr>
<tr><td><code id="pc_calculator_+3A_formula">formula</code></td>
<td>
<p>formula that specifies how to calculate the variable to be traced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of &quot;<code>pc</code>&quot; class with extra variables being attached.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2, constraint = c("x&lt;100", "y&lt;100"))
pc &lt;- eode_proj(x, value0 = pp(list(x = 0.2, y = 0.1)), N = 100)
pc_calculator(pc, formula = "z = x + y")
</code></pre>

<hr>
<h2 id='pc_plot'>Plot a Phase Curve in Phase Plane</h2><span id='topic+pc_plot'></span>

<h3>Description</h3>

<p>Creates a plot of a phase curve in its phase plane
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pc_plot(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pc_plot_+3A_x">x</code></td>
<td>
<p>object of class &quot;<code>pc</code>&quot; that represents a phase curve.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a graphic object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 1, a11 = 2, a12 = 1) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 1, a22 = 2) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2, constraint = c("x&lt;100", "y&lt;100"))
pc &lt;- eode_proj(x, value0 = pp(list(x = 0.2, y = 0.1)), N = 50, step = 0.1)
pc_plot(pc)
</code></pre>

<hr>
<h2 id='pdata'>Create Population Dynamics Data</h2><span id='topic+pdata'></span>

<h3>Description</h3>

<p>Create a new data set to describe population dynamics with initial conditions.
The data is mainly used to train the ODE model described by an object of &quot;<code>eode</code>&quot;
class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdata(x, init, t, lambda, formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pdata_+3A_x">x</code></td>
<td>
<p>an object of class &quot;<code>eode</code>&quot; describing the ODE system in focus.</p>
</td></tr>
<tr><td><code id="pdata_+3A_init">init</code></td>
<td>
<p>a data frame describing the initial conditions of the population.
Each column should correspond to a variable in the ODE system, hence the name of
column will be automatically checked to make sure it matches a variable in the ODE
system. Each row represents an independent observation</p>
</td></tr>
<tr><td><code id="pdata_+3A_t">t</code></td>
<td>
<p>a numerical vector that describes the time for each observation</p>
</td></tr>
<tr><td><code id="pdata_+3A_lambda">lambda</code></td>
<td>
<p>a data frame describing the observation values of population
dynamics. Each column is an variable and each row represents an independent
observation.</p>
</td></tr>
<tr><td><code id="pdata_+3A_formula">formula</code></td>
<td>
<p>a character that specifies how the observed variable can be
predicted by the ODE system.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of &quot;<code>pdata</code>&quot; class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
pdata(x,
  init = data.frame(x = c(10, 20), y = c(5, 15)),
  t = c(3, 3),
  lambda = data.frame(z = c(15, 30)),
  formula = "z = x + y"
)
</code></pre>

<hr>
<h2 id='pdist'>Distance between Phase Points</h2><span id='topic+pdist'></span>

<h3>Description</h3>

<p>Computes and returns the distance between two phase points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdist(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pdist_+3A_x">x</code></td>
<td>
<p>an object of <code>"pp"</code> class representing a phase point.</p>
</td></tr>
<tr><td><code id="pdist_+3A_y">y</code></td>
<td>
<p>an object of <code>"pp"</code> class representing another phase point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- pp(list(x = 1, y = 1))
b &lt;- pp(list(x = 3, y = 4))
pdist(a, b)
</code></pre>

<hr>
<h2 id='plot.eode'>Plot Phase Velocity Vector Field</h2><span id='topic+plot.eode'></span>

<h3>Description</h3>

<p>Creates a plot of phase velocity vector (or its field) of an ODE system. With
two free variables the function creates a plot of the phase velocity vector field
within the range defined by model constraints. With a single free variable the
function creates a plot of one-dimensional phase velocity vector field. With
more than two variables the function will automatically set a value (the middle
of the lower and upper boundaries) for any extra variable to reduce axes. The
values can also be set using parameter &quot;<code>set_covar</code>&quot;. If all model variables
have had their values, the function creates a plot to show the exact values of a
single phase velocity vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eode'
plot(
  x,
  n.grid = 20,
  scaleL = 1,
  scaleAH = 1,
  scaleS = 1,
  set_covar = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.eode_+3A_x">x</code></td>
<td>
<p>The ODE system under consideration. An object of class &quot;<code>eode</code>&quot;.</p>
</td></tr>
<tr><td><code id="plot.eode_+3A_n.grid">n.grid</code></td>
<td>
<p>number of grids per dimension. A larger number indicates a smaller
grid size. Default 20.</p>
</td></tr>
<tr><td><code id="plot.eode_+3A_scalel">scaleL</code></td>
<td>
<p>scale factor of the arrow length.</p>
</td></tr>
<tr><td><code id="plot.eode_+3A_scaleah">scaleAH</code></td>
<td>
<p>scale factor of the arrow head.</p>
</td></tr>
<tr><td><code id="plot.eode_+3A_scales">scaleS</code></td>
<td>
<p>scale factor of the arrow size.</p>
</td></tr>
<tr><td><code id="plot.eode_+3A_set_covar">set_covar</code></td>
<td>
<p>give certain values of model variables that are going to be fixed.</p>
</td></tr>
<tr><td><code id="plot.eode_+3A_...">...</code></td>
<td>
<p>ignored arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a graphic object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Lotka-Volterra competition model
eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
plot(x)

## Example 2: Susceptible-infected model
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
plot(x)
plot(x, set_covar = list(X_A = 60, Y_A = 80))
plot(x, set_covar = list(Y_C = 80, X_A = 60, Y_A = 80))
plot(x, set_covar = list(X_C = 60, Y_C = 80, X_A = 60, Y_A = 80))

</code></pre>

<hr>
<h2 id='plot.pc'>Plot a Phase Curve With Time</h2><span id='topic+plot.pc'></span>

<h3>Description</h3>

<p>Creates a plot of a phase curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pc'
plot(x, model_var_label = NULL, model_var_color = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.pc_+3A_x">x</code></td>
<td>
<p>object of class &quot;<code>pc</code>&quot; that represents a phase curve.</p>
</td></tr>
<tr><td><code id="plot.pc_+3A_model_var_label">model_var_label</code></td>
<td>
<p>a list indicating labels of model variables. Name should
be old variable names and values should be names of labels.</p>
</td></tr>
<tr><td><code id="plot.pc_+3A_model_var_color">model_var_color</code></td>
<td>
<p>a list indicating colors of model variable. Name should
be old variable names and values should be 16-bit color codes.</p>
</td></tr>
<tr><td><code id="plot.pc_+3A_...">...</code></td>
<td>
<p>additional parameters accepted by the function &quot;<code>geom_line</code>&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a graphic object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2, constraint = c("x&lt;1", "y&lt;1"))
pc &lt;- eode_proj(x, value0 = pp(list(x = 0.2, y = 0.1)), N = 100)
plot(pc)
</code></pre>

<hr>
<h2 id='plot.pcfamily'>Plot Phase Curve Family</h2><span id='topic+plot.pcfamily'></span>

<h3>Description</h3>

<p>Creates a plot of a phase curve family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pcfamily'
plot(
  x,
  model_var_label = NULL,
  model_var_color = NULL,
  facet_grid_label = NULL,
  facet_paras = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.pcfamily_+3A_x">x</code></td>
<td>
<p>object of class &quot;<code>pcfamily</code>&quot; that represents a phase curve family.</p>
</td></tr>
<tr><td><code id="plot.pcfamily_+3A_model_var_label">model_var_label</code></td>
<td>
<p>a list indicating labels of model variables. Name should
be old variable names and values should be names of labels.</p>
</td></tr>
<tr><td><code id="plot.pcfamily_+3A_model_var_color">model_var_color</code></td>
<td>
<p>a list indicating colors of model variable. Name should
be old variable names and values should be 16-bit color codes.</p>
</td></tr>
<tr><td><code id="plot.pcfamily_+3A_facet_grid_label">facet_grid_label</code></td>
<td>
<p>a list indicating facet labels. Name should be old
variable names and values should be facet labels.</p>
</td></tr>
<tr><td><code id="plot.pcfamily_+3A_facet_paras">facet_paras</code></td>
<td>
<p>a logical vector indicating whether facet?</p>
</td></tr>
<tr><td><code id="plot.pcfamily_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a graphic object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2, constraint = c("x&lt;1", "y&lt;1"))
value_space &lt;- list(x = c(0.2, 0.3, 0.4), y = 0.1, a11 = 1:3)
plot(eode_sensitivity_proj(x, valueSpace = value_space, N = 100))
</code></pre>

<hr>
<h2 id='plot.velocity'>Create a Plot of a Phase Velocity Vector</h2><span id='topic+plot.velocity'></span>

<h3>Description</h3>

<p>Plot a phase velocity vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'velocity'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.velocity_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>velocity</code>&quot;.</p>
</td></tr>
<tr><td><code id="plot.velocity_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
plot(eode_get_velocity(x, value = pp(list(x = 1, y = 1))))
</code></pre>

<hr>
<h2 id='pp'>Create a Phase Point</h2><span id='topic+pp'></span>

<h3>Description</h3>

<p>Creates an object of class &quot;<code>pp</code>&quot; representing a phase point in the phase
space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp(value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pp_+3A_value">value</code></td>
<td>
<p>A list of several elements, each giving a value on one dimension.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>pp</code>&quot; describing a phase point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pp(list(x = 1, y = 1))
</code></pre>

<hr>
<h2 id='print.eode'>Print Brief Details of an ODE System</h2><span id='topic+print.eode'></span>

<h3>Description</h3>

<p>Prints a very brief description of an ODE system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eode'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.eode_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>eode</code>&quot;.</p>
</td></tr>
<tr><td><code id="print.eode_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: Lotka-Volterra competition model
eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
x

## Example 2: Susceptible-infected model
dX_Cdt &lt;- function(X_C, Y_C, X_A, Y_A, nu = 0.15, beta = 0.1, mu = 0.15, g = 0.04) {
  nu * (X_A + Y_A) - beta * X_C * (Y_C + Y_A) - (mu + g) * X_C
}

dY_Cdt &lt;- function(X_C, Y_C, Y_A, beta = 0.1, mu = 0.15, g = 0.04, rho = 0.2) {
  beta * X_C * (Y_C + Y_A) - (mu + g + rho) * Y_C
}

dX_Adt &lt;- function(X_C, Y_C, X_A, Y_A, beta = 0.1, g = 0.04) {
  g * X_C - beta * X_A * (Y_C + Y_A)
}

dY_Adt &lt;- function(X_A, Y_C, Y_A, beta = 0.1, g = 0.04, rho = 0.2) {
  beta * X_A * (Y_C + Y_A) + g * Y_C - rho * Y_A
}

x &lt;- eode(
  dX_Cdt = dX_Cdt, dY_Cdt = dY_Cdt, dX_Adt = dX_Adt, dY_Adt = dY_Adt,
  constraint = c("X_C&gt;=0", "Y_C&gt;=0", "X_A&gt;=0", "Y_A&gt;=0")
)
x
</code></pre>

<hr>
<h2 id='print.pc'>Print Brief Details of a Phase Curve</h2><span id='topic+print.pc'></span>

<h3>Description</h3>

<p>Prints a very brief description of a phase curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pc'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.pc_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>pc</code>&quot;.</p>
</td></tr>
<tr><td><code id="print.pc_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2, constraint = c("x&lt;1", "y&lt;1"))
eode_proj(x, value0 = pp(list(x = 0.9, y = 0.9)), N = 8)
</code></pre>

<hr>
<h2 id='print.pcfamily'>Print Brief Details of a Phase Curve Family</h2><span id='topic+print.pcfamily'></span>

<h3>Description</h3>

<p>Prints a very brief description of a phase curve family.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pcfamily'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.pcfamily_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>pcfamily</code>&quot;.</p>
</td></tr>
<tr><td><code id="print.pcfamily_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2, constraint = c("x&lt;100", "y&lt;100"))
eode_sensitivity_proj(x, valueSpace = list(x = c(0.2, 0.3, 0.4), y = 0.1, a11 = 1:3), N = 100)
</code></pre>

<hr>
<h2 id='print.pdata'>Print Brief Details of Population Dynamics Data</h2><span id='topic+print.pdata'></span>

<h3>Description</h3>

<p>Prints a very brief description of population dynamics data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pdata'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.pdata_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>pdata</code>&quot;.</p>
</td></tr>
<tr><td><code id="print.pdata_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
pdata(x,
  init = data.frame(x = c(10, 20), y = c(5, 15)),
  t = c(3, 3),
  lambda = data.frame(z = c(15, 30)),
  formula = "z = x + y"
)
</code></pre>

<hr>
<h2 id='print.pp'>Print Brief Details of a Phase Point</h2><span id='topic+print.pp'></span>

<h3>Description</h3>

<p>Prints a very brief description of a phase point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pp'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.pp_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>pp</code>&quot;.</p>
</td></tr>
<tr><td><code id="print.pp_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pp(list(x = 1, y = 1))
</code></pre>

<hr>
<h2 id='print.velocity'>Print Brief Details of a Phase Velocity Vector</h2><span id='topic+print.velocity'></span>

<h3>Description</h3>

<p>Prints a very brief description of a phase velocity vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'velocity'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.velocity_+3A_x">x</code></td>
<td>
<p>Object of class &quot;<code>velocity</code>&quot;.</p>
</td></tr>
<tr><td><code id="print.velocity_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eq1 &lt;- function(x, y, r1 = 4, a11 = 1, a12 = 2) (r1 - a11 * x - a12 * y) * x
eq2 &lt;- function(x, y, r2 = 1, a21 = 2, a22 = 1) (r2 - a21 * x - a22 * y) * y
x &lt;- eode(dxdt = eq1, dydt = eq2)
eode_get_velocity(x, value = pp(list(x = 1, y = 1)))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
