<!DOCTYPE html><html lang="en"><head><title>Help for package PJFM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PJFM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#control_list'><p>control_list</p></a></li>
<li><a href='#PJFM_fit'><p>The function to fit PJFM.</p></a></li>
<li><a href='#PJFM_prediction'><p>The function to calculate predicted probabilities</p></a></li>
<li><a href='#PJFM_summary'><p>The function to get summary table of PJFM fit.</p></a></li>
<li><a href='#RecurData'><p>Simulated Recurrent Events Data</p></a></li>
<li><a href='#SurvData'><p>Simulated Survival Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Variational Inference for High-Dimensional Joint Frailty Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiehuan Sun &lt;jiehuan.sun@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Joint frailty models have been widely used to study the associations between recurrent events and a survival outcome. However, existing joint frailty models only consider one or a few recurrent events
    and cannot deal with high-dimensional recurrent events. This package can be used to fit our recently developed penalized joint frailty model that can handle high-dimensional recurrent events. 
    Specifically, an adaptive lasso penalty is imposed on the parameters for the effects of the recurrent events on the survival outcome, which allows for variable selection. 
    Also, our algorithm is computationally efficient, which is based on the Gaussian variational approximation method.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.0), survival(&ge; 3.2), statmod(&ge; 1.4), pracma(&ge;
2.2), Matrix(&ge; 1.3)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppEnsmallen</td>
</tr>
<tr>
<td>Suggests:</td>
<td>splines</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-05 05:24:37 UTC; JiehuanSun</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiehuan Sun [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-06 21:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='control_list'>control_list</h2><span id='topic+control_list'></span>

<h3>Description</h3>

<p>This list contains a list of parameters specifying the joint frailty model.
</p>


<h3>Details</h3>


<ul>
<li><p> ID_name: the variable name indicating the patient ID in both
recurrent events data and survival data.
</p>
</li>
<li><p> item_name: the variable name indicating the types of recurrent events
in the recurrent events data.
</p>
</li>
<li><p> time_name: the variable name indicating the occurrence time in the
recurrent events data.
</p>
</li>
<li><p> fix_cov: a set of variables names indicating the covariates of
fixed-effects in the recurrent events submodel.
If NULL, not baseline covariates are included.
</p>
</li>
<li><p> random_cov: a set of variables names indicating the covariates of
random-effects in the recurrent events submodel.
If NULL, not baseline covariates are included.
</p>
</li>
<li><p> recur_fix_time_fun: a function specifying the time-related basis functions (fixed-effects) in
the recurrent events submodel.
</p>
</li>
<li><p> recur_ran_time_fun: a function specifying the time-related basis functions (random-effects) in
the recurrent events submodel. If this is an intercept only function,
then only a random intercept is included (i.e. a joint frailty model).
</p>
</li>
<li><p> surv_fix_time_fun: a log-hazard function for the survival submodel.
</p>
</li>
<li><p> surv_time_name the variable name for the survival time
in the survival data.
</p>
</li>
<li><p> surv_status_name the variable name for the censoring indicator
in the survival data.
</p>
</li>
<li><p> surv_cov a set of variables names specifying the baseline covariates
in the survival submodel.
</p>
</li>
<li><p> n_points an integer indicating the numebr of nodes being used in
the Gaussian quadrature.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jiehuan Sun <a href="mailto:jiehuan.sun@gmail.com">jiehuan.sun@gmail.com</a>
</p>

<hr>
<h2 id='PJFM_fit'>The function to fit PJFM.</h2><span id='topic+PJFM_fit'></span>

<h3>Description</h3>

<p>The function is used to fit PJFM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PJFM_fit(
  RecurData = NULL,
  SurvData = NULL,
  control_list = NULL,
  EventName = NULL,
  nlam = 50,
  ridge = 0,
  pmax = 10,
  min_ratio = 0.01,
  maxiter = 100,
  eps = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PJFM_fit_+3A_recurdata">RecurData</code></td>
<td>
<p>a data frame containing the recurrent events data
(see <code><a href="#topic+RecurData">RecurData</a></code>).</p>
</td></tr>
<tr><td><code id="PJFM_fit_+3A_survdata">SurvData</code></td>
<td>
<p>a data frame containing the survival data
(see <code><a href="#topic+SurvData">SurvData</a></code>).</p>
</td></tr>
<tr><td><code id="PJFM_fit_+3A_control_list">control_list</code></td>
<td>
<p>a list of parameters specifying the joint frailty model
(see <code><a href="#topic+control_list">control_list</a></code>).</p>
</td></tr>
<tr><td><code id="PJFM_fit_+3A_eventname">EventName</code></td>
<td>
<p>a vector indicating which set of recurrent events
to be analyzed. If NULL, all recurrent events in RecurData will be used.</p>
</td></tr>
<tr><td><code id="PJFM_fit_+3A_nlam">nlam</code></td>
<td>
<p>number of tuning parameters.</p>
</td></tr>
<tr><td><code id="PJFM_fit_+3A_ridge">ridge</code></td>
<td>
<p>ridge penalty.</p>
</td></tr>
<tr><td><code id="PJFM_fit_+3A_pmax">pmax</code></td>
<td>
<p>the maximum of biomarkers being selected.
The algorithm will stop early if the maximum has been reached.</p>
</td></tr>
<tr><td><code id="PJFM_fit_+3A_min_ratio">min_ratio</code></td>
<td>
<p>the ratio between the largest possible penalty
and the smallest penalty to tune.</p>
</td></tr>
<tr><td><code id="PJFM_fit_+3A_maxiter">maxiter</code></td>
<td>
<p>the maximum number of iterations.</p>
</td></tr>
<tr><td><code id="PJFM_fit_+3A_eps">eps</code></td>
<td>
<p>threshold for convergence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a list with the following objects.
</p>
<table role = "presentation">
<tr><td><code>object_name</code></td>
<td>
<p>indicates whether this is a PJFM or JFM object. If JFM object, then some
recurrent events were selected and the returned model is the refitted model with
only selected recurrent events, but no penalty; otherwise, PJFM object is returned.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>fitted models with estimated parameters in both submodels.</p>
</td></tr>
<tr><td><code>hess</code></td>
<td>
<p>Hessian matrix; only available for JFM object.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Jiehuan Sun. &quot;Dynamic Prediction with Penalized Joint Frailty Model of High-Dimensional Recurrent Event Data and a Survival Outcome&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(splines)
data(PJFMdata)

up_limit = ceiling(max(SurvData$ftime))
bs_fun &lt;- function(t=NULL){
    bs(t, knots = NULL, degree = 2, intercept = TRUE, Boundary.knots= c(0,up_limit))
}

recur_fix_time_fun = bs_fun
recur_ran_time_fun &lt;- function(x=NULL){
    xx = cbind(1, matrix(x, ncol = 1))
    colnames(xx) = c("intercept","year_1")
    xx[,1,drop=FALSE]
    #xx
}

surv_fix_time_fun = bs_fun

control_list = list(
    ID_name = "ID", item_name = "feature_id",
    time_name = "time", fix_cov = "x", random_cov = NULL,
    recur_fix_time_fun = recur_fix_time_fun,
    recur_ran_time_fun = recur_ran_time_fun,
    surv_fix_time_fun = surv_fix_time_fun,
    surv_time_name = "ftime",  surv_status_name = "fstat",
    surv_cov = "x", n_points = 5
)


## this step takes about a few minute.
## analyze the first 10 recurrent events
res = PJFM_fit(RecurData=RecurData, SurvData=SurvData,
               control_list=control_list, EventName=1:10)

## get summary table
summary_table = PJFM_summary(res)



</code></pre>

<hr>
<h2 id='PJFM_prediction'>The function to calculate predicted probabilities</h2><span id='topic+PJFM_prediction'></span>

<h3>Description</h3>

<p>The function is used to calculate predicted probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PJFM_prediction(
  res = NULL,
  RecurData_test = NULL,
  SurvData_test = NULL,
  control_list = NULL,
  t_break = 1,
  tau = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PJFM_prediction_+3A_res">res</code></td>
<td>
<p>a model fit returned by PJFM_fit; the prediction
only works the returned model fit is JFM, but not PJFM.</p>
</td></tr>
<tr><td><code id="PJFM_prediction_+3A_recurdata_test">RecurData_test</code></td>
<td>
<p>a data frame containing the recurrent events data on the test dataset
(see <code><a href="#topic+RecurData">RecurData</a></code>).</p>
</td></tr>
<tr><td><code id="PJFM_prediction_+3A_survdata_test">SurvData_test</code></td>
<td>
<p>a data frame containing the survival data on the test dataset
(see <code><a href="#topic+SurvData">SurvData</a></code>).</p>
</td></tr>
<tr><td><code id="PJFM_prediction_+3A_control_list">control_list</code></td>
<td>
<p>a list of parameters specifying the joint frailty model
(see <code><a href="#topic+control_list">control_list</a></code>).</p>
</td></tr>
<tr><td><code id="PJFM_prediction_+3A_t_break">t_break</code></td>
<td>
<p>the landmark time point</p>
</td></tr>
<tr><td><code id="PJFM_prediction_+3A_tau">tau</code></td>
<td>
<p>the prediction window (i.e., (t_break, t_break+tau]).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a data frame, which contains all the variables in SurvData_test as well as t_break, tau, and risk.
The column risk indicates the predicted probability of event in the given prediction window.
</p>


<h3>References</h3>

<p>Jiehuan Sun. &quot;Dynamic Prediction with Penalized Joint Frailty Model of High-Dimensional Recurrent Event Data and a Survival Outcome&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(splines)
data(PJFMdata)

up_limit = ceiling(max(SurvData$ftime))
bs_fun &lt;- function(t=NULL){
    bs(t, knots = NULL, degree = 2, intercept = TRUE, Boundary.knots= c(0,up_limit))
}

recur_fix_time_fun = bs_fun
recur_ran_time_fun &lt;- function(x=NULL){
    xx = cbind(1, matrix(x, ncol = 1))
    colnames(xx) = c("intercept","year_1")
    xx[,1,drop=FALSE]
    #xx
}

surv_fix_time_fun = bs_fun

control_list = list(
    ID_name = "ID", item_name = "feature_id",
    time_name = "time", fix_cov = "x", random_cov = NULL,
    recur_fix_time_fun = recur_fix_time_fun,
    recur_ran_time_fun = recur_ran_time_fun,
    surv_fix_time_fun = surv_fix_time_fun,
    surv_time_name = "ftime",  surv_status_name = "fstat",
    surv_cov = "x", n_points = 5
)


train_id = 1:200
test_id = 200:300

SurvData_test = SurvData[is.element(SurvData$ID, test_id), ]
RecurData_test = RecurData[is.element(RecurData$ID, test_id), ]

SurvData = SurvData[is.element(SurvData$ID, train_id), ]
RecurData = RecurData[is.element(RecurData$ID, train_id), ]

## this step takes a few minutes.
## analyze the first 10 recurrent events
res = PJFM_fit(RecurData=RecurData, SurvData=SurvData,
               control_list=control_list, EventName=1:10)


## get prediction probabilities
pred_scores = PJFM_prediction(res=res,RecurData_test=RecurData_test,
                              SurvData_test=SurvData_test,control_list=control_list,
                              t_break = 1, tau = 0.5)



</code></pre>

<hr>
<h2 id='PJFM_summary'>The function to get summary table of PJFM fit.</h2><span id='topic+PJFM_summary'></span>

<h3>Description</h3>

<p>The function is used to get summary table of PJFM fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PJFM_summary(res = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PJFM_summary_+3A_res">res</code></td>
<td>
<p>a model fit returned by PJFM_fit; SE estimates are only
available for JFM, but not PJFM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a data frame, which contains parameter estimates in both submodels.
</p>


<h3>References</h3>

<p>Jiehuan Sun. &quot;Dynamic Prediction with Penalized Joint Frailty Model of High-Dimensional Recurrent Event Data and a Survival Outcome&quot;.
</p>

<hr>
<h2 id='RecurData'>Simulated Recurrent Events Data</h2><span id='topic+RecurData'></span>

<h3>Description</h3>

<p>This dataset contains recurrent events data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PJFMdata)
</code></pre>


<h3>Format</h3>

<p>A data frame with 57582 rows and 3 variables
</p>


<h3>Details</h3>


<ul>
<li><p> ID: patient ID
</p>
</li>
<li><p> feature_id: types of recurrent events
</p>
</li>
<li><p> time: occurrence time
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jiehuan Sun <a href="mailto:jiehuan.sun@gmail.com">jiehuan.sun@gmail.com</a>
</p>

<hr>
<h2 id='SurvData'>Simulated Survival Data</h2><span id='topic+SurvData'></span>

<h3>Description</h3>

<p>This dataset contains survival outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PJFMdata)
</code></pre>


<h3>Format</h3>

<p>A data frame with 300 rows and 4 variables
</p>


<h3>Details</h3>


<ul>
<li><p> ID: patient ID
</p>
</li>
<li><p> fstat: censoring indicator
</p>
</li>
<li><p> ftime: survival time
</p>
</li>
<li><p> x: baseline covariates
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jiehuan Sun <a href="mailto:jiehuan.sun@gmail.com">jiehuan.sun@gmail.com</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
