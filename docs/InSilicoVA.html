<!DOCTYPE html><html lang="en"><head><title>Help for package InSilicoVA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {InSilicoVA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#causetext'><p>Translation list of COD codes</p></a></li>
<li><a href='#condprob'><p>Conditional probability table used by InterVA-4</p></a></li>
<li><a href='#condprobnum'><p>Conditional probability values used by InterVA-4</p></a></li>
<li><a href='#csmf.diag'><p>Convergence test for fitted InSilico model</p></a></li>
<li><a href='#extract.prob'><p>Obtain conditional probabilities from training data</p></a></li>
<li><a href='#get.indiv'><p>Get individual COD probabilities from InSilicoVA Model Fits</p></a></li>
<li><a href='#indivplot'><p>plot aggregated COD distribution</p></a></li>
<li><a href='#insilico'><p>Implement InSilicoVA methods</p></a></li>
<li><a href='#insilico.fit'><p>Implement InSilicoVA methods with more flexible customization</p></a></li>
<li><a href='#insilico.train'><p>Modified InSilicoVA methods with training data</p></a></li>
<li><a href='#java_message'><p>Message to set heap size for Java</p></a></li>
<li><a href='#mapICD'><p>Map ICD-10 codes into the WHO 2016 cause list</p></a></li>
<li><a href='#physician_debias'><p>Implement physician debias algorithm</p></a></li>
<li><a href='#plot.insilico'><p>plot CSMF from a &quot;insilico&quot; object</p></a></li>
<li><a href='#print.insilico'><p>Print method for summarizing InSilicoVA Model Fits</p></a></li>
<li><a href='#print.insilico_summary'><p>Print method for summarizing InSilicoVA Model Fits</p></a></li>
<li><a href='#probbase'><p>Conditional probability of InterVA4</p></a></li>
<li><a href='#probbase3'><p>Conditional probability of InterVA4.03</p></a></li>
<li><a href='#RandomPhysician'><p>100 records of Sample Input together with two simulated physician codes</p></a></li>
<li><a href='#RandomVA1'><p>1000 records of Sample Input</p></a></li>
<li><a href='#RandomVA2'><p>100 records of Sample Input</p></a></li>
<li><a href='#SampleCategory'><p>Correspondence between InterVA causes and the physician coded cause categories</p></a></li>
<li><a href='#SamplePhysician'><p>100 records of Sample debiased physician codes</p></a></li>
<li><a href='#stackplot'><p>plot grouped CSMF from a &quot;insilico&quot; object</p></a></li>
<li><a href='#summary.insilico'><p>Summarizing InSilicoVA Model Fits</p></a></li>
<li><a href='#updateIndiv'><p>Update individual COD probabilities from InSilicoVA Model Fits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Probabilistic Verbal Autopsy Coding with 'InSilicoVA' Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Zehang Richard Li, Tyler McCormick, Sam Clark</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zehang Richard Li &lt;lizehang@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), rJava, coda, ggplot2, InterVA5</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, grDevices</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Java (&gt;= 7)</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes individual causes of death and population cause-specific mortality fractions using the 'InSilicoVA' algorithm from McCormick et al. (2016) &lt;<a href="https://doi.org/10.1080%2F01621459.2016.1152191">doi:10.1080/01621459.2016.1152191</a>&gt;. It uses data derived from verbal autopsy (VA) interviews, in a format similar to the input of the widely used 'InterVA' method. This package provides general model fitting and customization for 'InSilicoVA' algorithm and basic graphical visualization of the output.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/verbal-autopsy-software/InSilicoVA">https://github.com/verbal-autopsy-software/InSilicoVA</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/verbal-autopsy-software/InSilicoVA/issues">https://github.com/verbal-autopsy-software/InSilicoVA/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-27 22:24:08 UTC; zehangli</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-29 08:10:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='causetext'>Translation list of COD codes</h2><span id='topic+causetext'></span>

<h3>Description</h3>

<p>This is the translation of COD abbreviation codes into
their corresponding full names.
</p>


<h3>Format</h3>

<p>A data frame with the translation of COD codes to their names on 68
CODs (both the version of COD only and COD with group code).</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(causetext)
</code></pre>

<hr>
<h2 id='condprob'>Conditional probability table used by InterVA-4</h2><span id='topic+condprob'></span>

<h3>Description</h3>

<p>This is a conditional probability matrix used by InterVA-4.2.
There are 60 causes and 245 symptoms.  
The orders of the rows and columns must not be changed. 
</p>


<h3>Format</h3>

<p>A data frame with 245 observations on 60 variables. Each observation
is the conditional probability.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(condprob)
</code></pre>

<hr>
<h2 id='condprobnum'>Conditional probability values used by InterVA-4</h2><span id='topic+condprobnum'></span>

<h3>Description</h3>

<p>This is a conditional probability matrix used by InterVA-4.2.
There are 60 causes and 245 symptoms.  
</p>


<h3>Format</h3>

<p>A data frame with 245 observations on 60 variables. Each observation
is the conditional probability.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(condprobnum)
</code></pre>

<hr>
<h2 id='csmf.diag'>Convergence test for fitted InSilico model</h2><span id='topic+csmf.diag'></span>

<h3>Description</h3>

<p>Produce convergence test for CSMFs from fitted <code>"insilico"</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>csmf.diag(
  csmf,
  conv.csmf = 0.02,
  test = c("gelman", "heidel")[2],
  verbose = TRUE,
  autoburnin = FALSE,
  which.sub = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="csmf.diag_+3A_csmf">csmf</code></td>
<td>
<p>It could be either fitted <code>"insilico"</code> object, a list of
fitted <code>"insilico"</code> object from different chains of the same length but
different starting values, i.e., different seed. Or it could be the matrix
of CSMF obtained by <code>insilico</code>, or the list of matrices of CSMF. All
CSMF could contain more than one subpopulations, but should be in the same
format and order. And notice if the raw CSMF is used instead of the <code>"insilico"</code> object, external causes might need to be removed manually by user is <code>external.sep</code> is TRUE when fitting the model.</p>
</td></tr>
<tr><td><code id="csmf.diag_+3A_conv.csmf">conv.csmf</code></td>
<td>
<p>The minimum mean CSMF to be checked. Default to be 0.02,
which means any causes with mean CSMF lower than 0.02 will not be tested.</p>
</td></tr>
<tr><td><code id="csmf.diag_+3A_test">test</code></td>
<td>
<p>Type of test. Currently supporting Gelman and Rubin's test
(<code>test = "gelman"</code>) for multi-chain test, and Heidelberger and Welch's
test (<code>test = "heidel"</code>) for single-chain test.</p>
</td></tr>
<tr><td><code id="csmf.diag_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicator to return the test detail instead of one
logical outcome for Heidelberger and Welch's test. Default to be TRUE.</p>
</td></tr>
<tr><td><code id="csmf.diag_+3A_autoburnin">autoburnin</code></td>
<td>
<p>Logical indicator of whether to omit the first half of the
chain as burn in. Default to be FALSE since <code>insilico</code> return only the
iterations after burnin by default.</p>
</td></tr>
<tr><td><code id="csmf.diag_+3A_which.sub">which.sub</code></td>
<td>
<p>the name of the sub-population to test when there are multiple in the fitted object.</p>
</td></tr>
<tr><td><code id="csmf.diag_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <a href="coda.html#topic+heidel.diag">heidel.diag</a> or
<a href="coda.html#topic+gelman.diag">gelman.diag</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tests are performed using <a href="coda.html#topic+heidel.diag">heidel.diag</a> and <a href="coda.html#topic+gelman.diag">gelman.diag</a>
functions in <code>coda</code> package. The function takes either one or a list of
output from <code>insilico</code> function, or only the iteration by CSMF matrix.
Usually in practice, many causes with very tiny CSMF are hard to converge
based on standard tests, thus it is suggested to check convergence for only
causes with mean CSMF over certain threshold by setting proper
<code>conv.csmf</code>.
</p>
<p>Note for Gelman and Rubin's test, all chains should have the same length. If
the chains are sampled with automatically length determination, they might
not be comparable by this test.
</p>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C. Crampin,
Kathleen Kahn and Samuel J. Clark Probabilistic cause-of-death assignment
using verbal autopsies, <em>Journal of the American Statistical
Association</em> (2016), 111(515):1036-1049.
</p>
<p>Gelman, Andrew, and Donald B. Rubin. Inference from iterative simulation
using multiple sequences. <em>Statistical science</em> (1992): 457-472.
</p>
<p>Brooks, Stephen P., and Andrew Gelman. General methods for monitoring
convergence of iterative simulations. <em>Journal of computational and
graphical statistics</em> 7.4 (1998): 434-455.
</p>
<p>Heidelberger, Philip, and Peter D. Welch. A spectral method for confidence
interval generation and run length control in simulations.
<em>Communications of the ACM</em> 24.4 (1981): 233-245.
</p>
<p>Heidelberger, Philip, and Peter D. Welch. Simulation run length control in
the presence of an initial transient. <em>Operations Research</em> 31.6
(1983): 1109-1144.
</p>
<p>Schruben, Lee W. Detecting initialization bias in simulation output.
<em>Operations Research</em> 30.3 (1982): 569-590.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insilico">insilico</a></code>, <code><a href="#topic+summary.insilico">summary.insilico</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load sample data together with sub-population list
data(RandomVA2)
## Not run: 
# extract InterVA style input data
data &lt;- RandomVA2
# extract sub-population information. 
subpop &lt;- RandomVA2$sex

# run without sub-population
fit1a&lt;- insilico( data, subpop = NULL, 
              Nsim = 400, burnin = 200, thin = 10 , seed = 1, 
              auto.length = FALSE)
fit1b&lt;- insilico( data, subpop = NULL,  
              Nsim = 400, burnin = 200, thin = 10 , seed = 2, 
              auto.length = FALSE)
fit1c&lt;- insilico( data, subpop = NULL,  
              Nsim = 400, burnin = 200, thin = 10 , seed = 3, 
              auto.length = FALSE)
# single chain check
csmf.diag(fit1a)

# multiple chains check
csmf.diag(list(fit1a, fit1b, fit1c), test = "gelman")


# with sub-populations
fit2a&lt;- insilico( data, subpop = subpop,  
              Nsim = 400, burnin = 200, thin = 10 , seed = 1, 
              auto.length = FALSE)
fit2b&lt;- insilico( data, subpop = subpop,  
              Nsim = 400, burnin = 200, thin = 10 , seed = 2, 
              auto.length = FALSE)
fit2c&lt;- insilico( data, subpop = subpop,   
              Nsim = 400, burnin = 200, thin = 10 , seed = 3, 
              auto.length = FALSE)
# single chain check
csmf.diag(fit2a)

# multiple chains check
csmf.diag(list(fit2a, fit2b, fit2c), test = "gelman", which.sub = "Men")

## End(Not run)


</code></pre>

<hr>
<h2 id='extract.prob'>Obtain conditional probabilities from training data</h2><span id='topic+extract.prob'></span>

<h3>Description</h3>

<p>This is the function internally used in <code>insilico.train</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract.prob(
  train,
  gs,
  gstable,
  thre = 0.95,
  type = c("quantile", "fixed", "empirical")[1],
  isNumeric = FALSE,
  impute = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract.prob_+3A_train">train</code></td>
<td>
<p>Training data, it should be in the same format as the testing data
and contains one additional column (see <code>cause</code> below) specifying known
cause of death. The first column is also assumed to be death ID.</p>
</td></tr>
<tr><td><code id="extract.prob_+3A_gs">gs</code></td>
<td>
<p>the name of the column in <code>train</code> that contains cause of death.</p>
</td></tr>
<tr><td><code id="extract.prob_+3A_gstable">gstable</code></td>
<td>
<p>The list of causes of death used in training data.</p>
</td></tr>
<tr><td><code id="extract.prob_+3A_thre">thre</code></td>
<td>
<p>a numerical value between 0 to 1. It specifies the maximum rate of
missing for any symptoms to be considered in the model. Default value is set to
0.95, meaning if a symptom has more than 95% missing in the training data, it
will be removed.</p>
</td></tr>
<tr><td><code id="extract.prob_+3A_type">type</code></td>
<td>
<p>Three types of learning conditional probabilities are provided: &ldquo;quantile&rdquo;
or &ldquo;fixed&rdquo;. Since InSilicoVA works with ranked conditional probabilities P(S|C), &ldquo;quantile&rdquo;
means the rankings of the P(S|C) are obtained by matching the same quantile distributions
in the default InterVA P(S|C), and &ldquo;fixed&rdquo; means P(S|C) are matched to the closest values
in the default InterVA P(S|C) table. Empirically both types of rankings produce similar results. The third option &ldquo;empirical&rdquo; means no rankings are calculated, only the raw P(S|C) values are returned.</p>
</td></tr>
<tr><td><code id="extract.prob_+3A_isnumeric">isNumeric</code></td>
<td>
<p>Indicator if the input is already in numeric form. If the
input is coded numerically such that 1 for &ldquo;present&rdquo;, 0 for &ldquo;absent&rdquo;,
and -1 for &ldquo;missing&rdquo;, this indicator could be set to True to avoid
conversion to standard InterVA format.</p>
</td></tr>
<tr><td><code id="extract.prob_+3A_impute">impute</code></td>
<td>
<p>Indicator for whether to impute 1. P(S|C) with P(S) if symptom S does not exist more than the threshold of fractions within death due to C; and 2. values of exact 0 or 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>cond.prob</code></td>
<td>
<p>raw P(S|C) matrix</p>
</td></tr>
<tr><td><code>cond.prob.alpha</code></td>
<td>
<p>ranked P(S|C) matrix</p>
</td></tr>
<tr><td><code>table.alpha</code></td>
<td>
<p>list of ranks used</p>
</td></tr>
<tr><td><code>table.num</code></td>
<td>
<p>list of median numerical values for each rank</p>
</td></tr>
<tr><td><code>symps.train</code></td>
<td>
<p>training data after removing symptoms with too high missing rate.</p>
</td></tr>
</table>

<hr>
<h2 id='get.indiv'>Get individual COD probabilities from InSilicoVA Model Fits</h2><span id='topic+get.indiv'></span>

<h3>Description</h3>

<p>This function calculates individual probabilities for each death and provide posterior credible intervals for each estimates. The default set up is to calculate the 95
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.indiv(
  object,
  data = NULL,
  CI = 0.95,
  is.aggregate = FALSE,
  by = NULL,
  is.sample = FALSE,
  java_option = "-Xmx1g",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.indiv_+3A_object">object</code></td>
<td>
<p>Fitted <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code id="get.indiv_+3A_data">data</code></td>
<td>
<p>data for the fitted <code>"insilico"</code> object. The first column of the data should be the ID that matches the <code>"insilico"</code> fitted model.</p>
</td></tr>
<tr><td><code id="get.indiv_+3A_ci">CI</code></td>
<td>
<p>Credible interval for posterior estimates.</p>
</td></tr>
<tr><td><code id="get.indiv_+3A_is.aggregate">is.aggregate</code></td>
<td>
<p>logical indicator for constructing aggregated distribution rather than individual distributions.</p>
</td></tr>
<tr><td><code id="get.indiv_+3A_by">by</code></td>
<td>
<p>list of column names to group by.</p>
</td></tr>
<tr><td><code id="get.indiv_+3A_is.sample">is.sample</code></td>
<td>
<p>logical indicator for returning the posterior samples of individual probabilities instead of posterior summaries.</p>
</td></tr>
<tr><td><code id="get.indiv_+3A_java_option">java_option</code></td>
<td>
<p>Option to initialize java JVM. Default to &ldquo;-Xmx1g&rdquo;, which sets the maximum heap size to be 1GB.</p>
</td></tr>
<tr><td><code id="get.indiv_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mean</code></td>
<td>
<p> individual mean COD distribution matrix.</p>
</td></tr> 
<tr><td><code>median</code></td>
<td>
<p> individual median COD distribution matrix.</p>
</td></tr> 
<tr><td><code>lower</code></td>
<td>
<p> individual lower bound for each COD probability.</p>
</td></tr> 
<tr><td><code>upper</code></td>
<td>
<p> individual upper bound for each COD probability.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C. Crampin,
Kathleen Kahn and Samuel J. Clark Probabilistic cause-of-death assignment
using verbal autopsies, <em>Journal of the American Statistical
Association</em> (2016), 111(515):1036-1049.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insilico">insilico</a></code>, <code><a href="#topic+updateIndiv">updateIndiv</a></code>, <code><a href="#topic+plot.insilico">plot.insilico</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(RandomVA1)
fit1&lt;- insilico(RandomVA1, subpop = NULL,
                Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
                auto.length = FALSE)
summary(fit1, id = "d199")

# Calculate aggregated COD distributions
agg.csmf &lt;- get.indiv(data = RandomVA1, fit1, CI = 0.95, 
                     is.aggregate = TRUE, by = NULL)
head(agg.csmf) 

agg.by.sex.age &lt;- get.indiv(data = RandomVA1, fit1, CI = 0.95, 
                            is.aggregate = TRUE, by = list("sex", "age"))
head(agg.by.sex.age$mean) 

# Obtain individual level P(Y|X) posterior draws (N by C by Nitr array)
prob &lt;- get.indiv(data = RandomVA1, fit1, is.sample = TRUE)
dim(prob)

## End(Not run)
</code></pre>

<hr>
<h2 id='indivplot'>plot aggregated COD distribution</h2><span id='topic+indivplot'></span>

<h3>Description</h3>

<p>Produce a bar plot of the aggregated COD distribution as approximate CSMFs for a fitted <code>"insilico"</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>indivplot(
  x,
  type = c("errorbar", "bar")[1],
  top = 10,
  causelist = NULL,
  which.plot = NULL,
  xlab = "Causes",
  ylab = "COD distribution",
  title = "COD distributions for the top causes",
  horiz = TRUE,
  angle = 60,
  fill = "lightblue",
  err_width = 0.4,
  err_size = 0.6,
  point_size = 2,
  border = "black",
  bw = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="indivplot_+3A_x">x</code></td>
<td>
<p>object from <code>get.indiv</code> function.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_type">type</code></td>
<td>
<p>An indicator of the type of chart to plot. &quot;errorbar&quot; for line
plots of only the error bars on single population; &quot;bar&quot; for bar chart with
error bars on single population.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_top">top</code></td>
<td>
<p>The number of top causes to plot. If multiple sub-populations are
to be plotted, it will plot the union of the top causes in all
sub-populations.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_causelist">causelist</code></td>
<td>
<p>The list of causes to plot. It could be a numeric vector
indicating the position of the causes in the InterVA cause list (see
<code><a href="#topic+causetext">causetext</a></code>), or a vector of character string of the cause
names. The argument supports partial matching of the cause names. e.g.,
&quot;HIV/AIDS related death&quot; could be abbreviated into &quot;HIV&quot;; &quot;Other and
unspecified infect dis&quot; could be abbreviated into &quot;Other and unspecified
infect&quot;.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_which.plot">which.plot</code></td>
<td>
<p>Specification of which group to plot if there are
multiple.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_xlab">xlab</code></td>
<td>
<p>Labels for the causes.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_ylab">ylab</code></td>
<td>
<p>Labels for the CSMF values.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_title">title</code></td>
<td>
<p>Title of the plot.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_horiz">horiz</code></td>
<td>
<p>Logical indicator indicating if the bars are plotted
horizontally.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_angle">angle</code></td>
<td>
<p>Angle of rotation for the texts on x axis when <code>horiz</code> is
set to FALSE</p>
</td></tr>
<tr><td><code id="indivplot_+3A_fill">fill</code></td>
<td>
<p>The color to fill the bars when <code>type</code> is set to &quot;bar&quot;.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_err_width">err_width</code></td>
<td>
<p>Size of the error bars.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_err_size">err_size</code></td>
<td>
<p>Thickness of the error bar lines.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_point_size">point_size</code></td>
<td>
<p>Size of the points.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_border">border</code></td>
<td>
<p>The color to color the borders of bars when <code>type</code> is set
to &quot;bar&quot;.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_bw">bw</code></td>
<td>
<p>Logical indicator for setting the theme of the plots to be black
and white.</p>
</td></tr>
<tr><td><code id="indivplot_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C. Crampin,
Kathleen Kahn and Samuel J. Clark Probabilistic cause-of-death assignment
using verbal autopsies, <em>Journal of the American Statistical
Association</em> (2016), 111(515):1036-1049.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insilico">insilico</a></code>, <code><a href="#topic+summary.insilico">summary.insilico</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Toy example with 1000 VA deaths
data(RandomVA1)
fit1&lt;- insilico(RandomVA1, subpop = NULL,  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
              auto.length = FALSE)
summary(fit1, id = "d199")

# update credible interval for individual probabilities to 90%
indiv.new &lt;- get.indiv(fit1, CI = 0.9)
fit1$indiv.prob.lower &lt;- indiv.new$lower
fit1$indiv.prob.upper &lt;- indiv.new$upper
fit1$indiv.CI &lt;- 0.9
summary(fit1, id = "d199")


# get empirical aggregated COD distribution 
agg.csmf &lt;- get.indiv(data = RandomVA2, fit1, CI = 0.95, 
                      is.aggregate = TRUE, by = NULL)
head(agg.csmf)

# aggregate individual COD distribution by sex and age
# note the model was fitted assuming the same CSMF for all deaths
# this aggregation provides an approximate CSMF for each sub-groups
agg.by.sex.age &lt;- get.indiv(data = RandomVA2, fit1, CI = 0.95, 
                        is.aggregate = TRUE, by = list("sex", "age"))
head(agg.by.sex.age$mean)

# plot of aggregated individual COD distribution
# 0. plot for all data
indivplot(agg.csmf, top = 10)
# 1. plot for specific one group
indivplot(agg.by.sex.age, which.plot = "Men 60-", top = 10)
# 2. comparing multiple groups
indivplot(agg.by.sex.age, which.plot = list("Men 60+", "Men 60-"), 
                          top = 5)
# 3. comparing multiple groups on selected causes
indivplot(agg.by.sex.age, which.plot = list("Men 60-", "Women 60-"), 
                          top = 0, causelist = c(
                            "HIV/AIDS related death", 
                            "Pulmonary tuberculosis", 
                            "Other and unspecified infect dis", 
                            "Other and unspecified NCD"))

## End(Not run) 
</code></pre>

<hr>
<h2 id='insilico'>Implement InSilicoVA methods</h2><span id='topic+insilico'></span>

<h3>Description</h3>

<p>This function implements InSilicoVA model. The InSilicoVA model is fitted
with MCMC implemented in Java. For more detail, see the paper on
<a href="https://arxiv.org/abs/1411.3042">https://arxiv.org/abs/1411.3042</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insilico(
  data,
  data.type = c("WHO2012", "WHO2016")[1],
  sci = NULL,
  isNumeric = FALSE,
  updateCondProb = TRUE,
  keepProbbase.level = TRUE,
  CondProb = NULL,
  CondProbNum = NULL,
  datacheck = TRUE,
  datacheck.missing = TRUE,
  warning.write = FALSE,
  directory = NULL,
  external.sep = TRUE,
  Nsim = 4000,
  thin = 10,
  burnin = 2000,
  auto.length = TRUE,
  conv.csmf = 0.02,
  jump.scale = 0.1,
  levels.prior = NULL,
  levels.strength = 1,
  trunc.min = 1e-04,
  trunc.max = 0.9999,
  subpop = NULL,
  java_option = "-Xmx1g",
  seed = 1,
  phy.code = NULL,
  phy.cat = NULL,
  phy.unknown = NULL,
  phy.external = NULL,
  phy.debias = NULL,
  exclude.impossible.cause = c("subset2", "subset", "all", "InterVA", "none")[1],
  impossible.combination = NULL,
  no.is.missing = FALSE,
  indiv.CI = NULL,
  groupcode = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="insilico_+3A_data">data</code></td>
<td>
<p>The original data to be used. It is suggested to use similar
input as InterVA4, with the first column being death IDs and 245 symptoms. 
The only difference in input is InsilicoVA takes three levels: &ldquo;present&rdquo;,
&ldquo;absent&rdquo;, and &ldquo;missing (no data)&rdquo;. Similar to InterVA software,
&ldquo;present&rdquo; symptoms takes value &ldquo;Y&rdquo;; &ldquo;absent&rdquo; symptoms take take value
&ldquo;NA&rdquo; or &ldquo;&rdquo;. For missing symptoms, e.g., questions not asked or answered
in the original interview, corrupted data, etc., the input should be coded
by &ldquo;.&rdquo; to distinguish from &ldquo;absent&rdquo; category. The order of the columns does
not matter as long as the column names are correct. It can also include more 
unused columns than the standard InterVA4 input. But the first column should be 
the death ID. For example input data format, see <code>RandomVA1</code> and 
<code>RandomVA2</code>.</p>
</td></tr>
<tr><td><code id="insilico_+3A_data.type">data.type</code></td>
<td>
<p>Type of questionnaire. &ldquo;WHO2012&rdquo; corresponds to the standard input of InterVA4, and  &ldquo;WHO2016&rdquo; corresponds to the standard input of InterVA5.</p>
</td></tr>
<tr><td><code id="insilico_+3A_sci">sci</code></td>
<td>
<p>A data frame that contains the symptom-cause-information (aka
Probbase) that InterVA uses to assign a cause of death.</p>
</td></tr>
<tr><td><code id="insilico_+3A_isnumeric">isNumeric</code></td>
<td>
<p>Indicator if the input is already in numeric form. If the
input is coded numerically such that 1 for &ldquo;present&rdquo;, 0 for &ldquo;absent&rdquo;,
and -1 for &ldquo;missing&rdquo;, this indicator could be set to True to avoid
conversion to standard InterVA format.</p>
</td></tr>
<tr><td><code id="insilico_+3A_updatecondprob">updateCondProb</code></td>
<td>
<p>Logical indicator. If FALSE, then fit InSilicoVA model without re-estimating conditional probabilities.</p>
</td></tr>
<tr><td><code id="insilico_+3A_keepprobbase.level">keepProbbase.level</code></td>
<td>
<p>Logical indicator when <code>updateCondProb</code> is
FALSE. If TRUE, then only estimate the InterVA's conditional probability
interpretation table; if FALSE, estimate the whole conditional
probability matrix. Default to TRUE.</p>
</td></tr>
<tr><td><code id="insilico_+3A_condprob">CondProb</code></td>
<td>
<p>Customized conditional probability matrix to use.It should be strict the same configuration as InterVA-4 software. That is, it should be a matrix of 245 rows of symptoms and 60 columns of causes, arranged in the same order as in InterVA-4 specification. The elements in the matrix should be the conditional probability of corresponding symptom given the corresponding cause, represented in alphabetic form indicating levels. For example input, see <code><a href="#topic+condprob">condprob</a></code></p>
</td></tr>
<tr><td><code id="insilico_+3A_condprobnum">CondProbNum</code></td>
<td>
<p>Customized conditional probability matrix to use if specified fully by numerical values between 0 and 1. If it is specified, re-estimation of conditional probabilities will not be performed, i.e., <code>updateCondProb</code> will be set to FALSE.</p>
</td></tr>
<tr><td><code id="insilico_+3A_datacheck">datacheck</code></td>
<td>
<p>Logical indicator for whether to check the data satisfying
InterVA rules. Default set to be TRUE. If <code>warning.write</code> is set to
true, the inconsistent input will be logged in file warning_insilico.txt and errorlog_insilico.txt. It's
strongly suggested to be set to TRUE.</p>
</td></tr>
<tr><td><code id="insilico_+3A_datacheck.missing">datacheck.missing</code></td>
<td>
<p>Logical indicator for whether to perform data check before deleting complete missing symptoms. Default to TRUE.</p>
</td></tr>
<tr><td><code id="insilico_+3A_warning.write">warning.write</code></td>
<td>
<p>Logical indicator for whether to save the changes made
to data input by <code>datacheck</code>. If set to TRUE, the changes will be
logged in file warning_insilico.txt and errorlog_insilico.txt in current working directory.</p>
</td></tr>
<tr><td><code id="insilico_+3A_directory">directory</code></td>
<td>
<p>The directory to store the output from. It should be an valid existing directory or a folder to be created.</p>
</td></tr>
<tr><td><code id="insilico_+3A_external.sep">external.sep</code></td>
<td>
<p>Logical indicator for whether to separate out external
causes first. Default set to be TRUE. If set to TRUE, the algorithm will
estimate external causes, e.g., traffic accident, accidental fall, suicide,
etc., by checking the corresponding indicator only without considering other
medical symptoms. It is strongly suggested to set to be TRUE.</p>
</td></tr>
<tr><td><code id="insilico_+3A_nsim">Nsim</code></td>
<td>
<p>Number of iterations to run. Default to be 4000.</p>
</td></tr>
<tr><td><code id="insilico_+3A_thin">thin</code></td>
<td>
<p>Proportion of thinning for storing parameters. For example, if
thin = k, the output parameters will only be saved every k iterations.
Default to be 10</p>
</td></tr>
<tr><td><code id="insilico_+3A_burnin">burnin</code></td>
<td>
<p>Number of iterations as burn-in period. Parameters sampled in
burn-in period will not be saved.</p>
</td></tr>
<tr><td><code id="insilico_+3A_auto.length">auto.length</code></td>
<td>
<p>Logical indicator of whether to automatically increase
chain length if convergence not reached.</p>
</td></tr>
<tr><td><code id="insilico_+3A_conv.csmf">conv.csmf</code></td>
<td>
<p>Minimum CSMF value to check for convergence if auto.length
is set to TRUE. For example, under the default value 0.02, all causes with
mean CSMF at least 0.02 will be checked for convergence.</p>
</td></tr>
<tr><td><code id="insilico_+3A_jump.scale">jump.scale</code></td>
<td>
<p>The scale of Metropolis proposal in the Normal model.
Default to be 0.1.</p>
</td></tr>
<tr><td><code id="insilico_+3A_levels.prior">levels.prior</code></td>
<td>
<p>Vector of prior expectation of conditional probability
levels. They do not have to be scaled. The algorithm internally calibrate
the scale to the working scale through <code>levels.strength</code>. If NULL the
algorithm will use InterVA table as prior.</p>
</td></tr>
<tr><td><code id="insilico_+3A_levels.strength">levels.strength</code></td>
<td>
<p>Scaling factor for the strength of prior beliefs in
the conditional probability levels. Larger value constrain the posterior
estimates to be closer to prior expectation. Defult value 1 scales
<code>levels.prior</code> to a suggested scale that works empirically.</p>
</td></tr>
<tr><td><code id="insilico_+3A_trunc.min">trunc.min</code></td>
<td>
<p>Minimum possible value for estimated conditional
probability table. Default to be 0.0001</p>
</td></tr>
<tr><td><code id="insilico_+3A_trunc.max">trunc.max</code></td>
<td>
<p>Maximum possible value for estimated conditional
probability table. Default to be 0.9999</p>
</td></tr>
<tr><td><code id="insilico_+3A_subpop">subpop</code></td>
<td>
<p>This could be the column name of the variable in data that is to
be used as sub-population indicator, or a list of column names if more than one 
variable are to be used. Or it could be a vector of sub-population assignments 
of the same length of death records. It could be numerical indicators or character 
vectors of names.</p>
</td></tr>
<tr><td><code id="insilico_+3A_java_option">java_option</code></td>
<td>
<p>Option to initialize java JVM. Default to &ldquo;-Xmx1g&rdquo;,
which sets the maximum heap size to be 1GB. If R produces
&ldquo;java.lang.OutOfMemoryError: Java heap space&rdquo; error message, consider
increasing heap size using this option, or one of the following: (1)
decreasing <code>Nsim</code>, (2) increasing <code>thin</code>, or (3) disabling
<code>auto.length</code>.</p>
</td></tr>
<tr><td><code id="insilico_+3A_seed">seed</code></td>
<td>
<p>Seed used for initializing sampler. The algorithm will produce
the same outcome with the same seed in each machine.</p>
</td></tr>
<tr><td><code id="insilico_+3A_phy.code">phy.code</code></td>
<td>
<p>A matrix of physician assigned cause distribution. The
physician assigned causes need not be the same as the list of causes used in
InSilicoVA and InterVA-4. The cause list used could be a higher level
aggregation of the InSilicoVA causes. See <code>phy.cat</code> for more detail.
The first column of <code>phy.code</code> should be death ID that could be matched
to the symptom dataset, the following columns are the probabilities of each
cause category used by physicians.</p>
</td></tr>
<tr><td><code id="insilico_+3A_phy.cat">phy.cat</code></td>
<td>
<p>A two column matrix describing the correspondence between
InSilicoVA causes and the physician assigned causes. Note each InSilicoVA
cause (see <code>causetext</code>) could only correspond to one physician assigned
cause. See <code>SampleCategory</code> for an example. 'Unknown' category should
not be included in this matrix.</p>
</td></tr>
<tr><td><code id="insilico_+3A_phy.unknown">phy.unknown</code></td>
<td>
<p>The name of the physician assigned cause that correspond
to unknown COD.</p>
</td></tr>
<tr><td><code id="insilico_+3A_phy.external">phy.external</code></td>
<td>
<p>The name of the physician assigned cause that correspond
to external causes. This will only be used if <code>external.sep</code> is set to
TRUE. In that case, all external causes should be grouped together, as they
are assigned deterministically by the corresponding symptoms.</p>
</td></tr>
<tr><td><code id="insilico_+3A_phy.debias">phy.debias</code></td>
<td>
<p>Fitted object from physician coding debias function (see
<code><a href="#topic+physician_debias">physician_debias</a></code>) that overwrites <code>phy.code</code>.</p>
</td></tr>
<tr><td><code id="insilico_+3A_exclude.impossible.cause">exclude.impossible.cause</code></td>
<td>
<p>option to exclude impossible causes at the individual level. The following rules are implemented: <code>subset</code>: Causes with 0 probability given the age group and gender of the observation, according to the InterVA conditional probabilities, are removed; <code>subset2</code>: In addition to the same rules as <code>subset</code>, also remove Prematurity for baby born during at least 37 weeks of pregnancy, remove Birth asphyxia for baby  not born during at least 37 weeks of pregnancy, and remove pregnancy-related deaths for deaths without pregnancy; <code>all</code>: Causes with 0 probability given any symptom of the observation, according to the InterVA conditional probabilities, are removed; <code>interVA</code>:  Causes with 0 probability given any positive indicators according to the InterVA conditional probabilities, are removed; and <code>none</code>: no causes are removed. <code>subset2</code> is the default.</p>
</td></tr>
<tr><td><code id="insilico_+3A_impossible.combination">impossible.combination</code></td>
<td>
<p>matrix indicating additional impossible symptom-cause combinations in addition to the ones specified by <code>exlcude.impossible.cause</code>. It should be a matrix of three columns, where each row is one rule of impossible combination. In each row, the first column specify the name of the symptom (as in the input data column names, e.g., &quot;i079o&quot;), the second column specify the name of the cause (as in the probbase column name, i.e., &quot;b_0101&quot;), and the third column specifying either 0 or 1, indicating the cause is impossible when the symptom takes the specified value.</p>
</td></tr>
<tr><td><code id="insilico_+3A_no.is.missing">no.is.missing</code></td>
<td>
<p>logical indicator to treat all absence of symptoms as missing. Default to FALSE. If set to TRUE, InSilicoVA will perform calculations similar to InterVA-4 w.r.t treating absent symptoms. It is highly recommended to set this argument to FALSE.</p>
</td></tr>
<tr><td><code id="insilico_+3A_indiv.ci">indiv.CI</code></td>
<td>
<p>credible interval for individual probabilities. If set to NULL, individual COD distributions will not be calculated to accelerate model fitting time. See <code><a href="#topic+get.indiv">get.indiv</a></code> for details of updating the C.I. later after fitting the model.</p>
</td></tr>
<tr><td><code id="insilico_+3A_groupcode">groupcode</code></td>
<td>
<p>logical indicator of including the group code in the output causes</p>
</td></tr>
<tr><td><code id="insilico_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For Windows user, this function will produce a popup window showing the
progress. For Mac and Unix user, this function will print progress messages
on the console. Special notice for users using default R GUI for mac, the
output will not be printed on console while the function is running, and
will only be printed out after it is completed. Thus if you use a Mac, we
suggest using either RStudio for mac, or running R from terminal.
</p>
<p>The chains could be set to run automatically longer. If set
<code>auto.length</code> to be TRUE, the chain will assess convergence after
finishing the length K chain input by user using Heidelberger and Welch's
convergence diagnostic. If convergence is not reached, the chain will run
another K iterations and use the first K iterations as burn-in. If the chain
is still not converged after 2K iterations, it will proceed to another 2K
iterations and again use the first 2K iterations as burn-in. If convergence
is still not reached by the end, it will not double the length again to
avoid heavy memory use. A warning will be given in that case. The extended
chains will be thinned in the same way.
</p>
<p>For more detail of model specification, see the paper on
<a href="https://arxiv.org/abs/1411.3042">https://arxiv.org/abs/1411.3042</a>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>id</code></td>
<td>
<p>A vector of death ID. Note the order of the ID is in
general different from the input file. See <code>report</code> for organizing the
report.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Cleaned numerical data.</p>
</td></tr>
<tr><td><code>indiv.prob</code></td>
<td>
<p>Matrix of individual mean cause of death distribution.
Each row corresponds to one death with the corresponding ID.</p>
</td></tr>
<tr><td><code>csmf</code></td>
<td>
<p>Matrix of CSMF vector at each iterations after burn-in and
thinning. Each column corresponds to one cause.</p>
</td></tr>
<tr><td><code>conditional.probs</code></td>
<td>
<p>If the model is estimated with
<code>keepProbbase.level</code> = TRUE, this value gives a matrix of each
conditional probability at each level at each iterations. Each column
corresponds to one level of probability. If <code>keepProbbase.level</code> =
FALSE, this value gives a three-dimensional array. If <code>updateCondProb</code> =
FALSE, the value will be set to NULL. See <code>report</code> for more analysis.</p>
</td></tr>
<tr><td><code>missing.symptoms</code></td>
<td>
<p>Vector of symptoms missing from all input data.</p>
</td></tr>
<tr><td><code>external</code></td>
<td>
<p>Logical indicator of whether the model is fitted with
external causes separated calculated.</p>
</td></tr>
<tr><td><code>impossible.causes</code></td>
<td>
<p>Impossible cause-symptom pairs, if any.</p>
</td></tr>
<tr><td><code>indiv.CI</code></td>
<td>
<p>The posterior credible interval to compute for individual COD probability distributions. If set to NULL, only the posterior mean of the individual COD probabilities will be produced. Default to be 0.95.</p>
</td></tr>
<tr><td><code>indiv.prob.median</code></td>
<td>
<p>median probability of each cause of death for each individual death.</p>
</td></tr>
<tr><td><code>indiv.prob.lower</code></td>
<td>
<p>lower CI bound for the probability of each cause of death for each individual death.</p>
</td></tr>
<tr><td><code>indiv.prob.upper</code></td>
<td>
<p>upper CI bound for the probability of each cause of death for each individual death.</p>
</td></tr>
<tr><td><code>errors</code></td>
<td>
<p>Logs of deleted observations and reasons of deletion.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C.
Crampin, Kathleen Kahn and Samuel J. Clark(2014) <em>Probabilistic
cause-of-death assignment using verbal autopsies</em>,
<a href="https://arxiv.org/abs/1411.3042">https://arxiv.org/abs/1411.3042</a> <br /> <em>Working paper no. 147, Center
for Statistics and the Social Sciences, University of Washington</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.insilico">plot.insilico</a></code>, <code><a href="#topic+summary.insilico">summary.insilico</a></code>, <code><a href="#topic+physician_debias">physician_debias</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(RandomVA1) 
fit0&lt;- insilico(RandomVA1, subpop = NULL,  
                Nsim = 20, burnin = 10, thin = 1 , seed = 1,
			 auto.length = FALSE)
summary(fit0)
summary(fit0, id = "d199")

##
## Scenario 1: standard input without sub-population specification
##
fit1&lt;- insilico(RandomVA1, subpop = NULL,  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
		   auto.length = FALSE)
summary(fit1)
plot(fit1)

##
## Scenario 2: standard input with sub-population specification
##
data(RandomVA2)
fit2&lt;- insilico(RandomVA2, subpop = list("sex"),  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
		   auto.length = FALSE)
summary(fit2)
plot(fit2, type = "compare")
plot(fit2, which.sub = "Men")

##
## Scenario 3: standard input with multiple sub-population specification
##
fit3&lt;- insilico(RandomVA2, subpop = list("sex", "age"),  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
		   auto.length = FALSE)
summary(fit3)

##
## Scenario 3: standard input with multiple sub-population specification
##
fit3&lt;- insilico(RandomVA2, subpop = list("sex", "age"),  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
		   auto.length = FALSE)
summary(fit3)

##
## Scenario 5 - 7 are special situations rarely needed in practice,
##   but included here for completeness. 
##   The below examples use no sub-population or physician codes, 
##   but specifying sub-population is still possible as in Scenario 2 - 4.
## 

##
## Scenario 5: skipping re-estimation of conditional probabilities
##
# Though in practice the need for this situation is very unlikely, 
# use only the default conditional probabilities without re-estimation
fit5&lt;- insilico(RandomVA1, subpop = NULL,  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
              updateCondProb = FALSE, 
		   auto.length = FALSE) 
summary(fit5)

##
## Scenario 6: modify default conditional probability matrix
##
# Load the default conditional probability matrix 
data(condprob)
# The conditional probabilities are given in levels such as I, A+, A, A-, etc.
condprob[1:5, 1:5]
# To modify certain cells 
new_cond_prob &lt;- condprob
new_cond_prob["elder", "HIV/AIDS related death"] &lt;- "C"
# or equivalently
new_cond_prob[1, 3] &lt;- "C"

fit6&lt;- insilico(RandomVA1, subpop = NULL,  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
              CondProb = new_cond_prob, 
		   auto.length = FALSE) 
# note: compare this with fit1 above to see the change induced 
#  by changing Pr(elder | HIV) from "C+" to "C".
summary(fit6)

##
## Scenario 7: modify default numerical values in conditional probabilities directly
##
# Load the default conditional probability matrix 
data(condprobnum)
# The conditional probabilities are given in numerical values in this dataset
condprobnum[1:5, 1:5]
# To modify certain cells, into any numerical values you want 
new_cond_prob_num &lt;- condprobnum
new_cond_prob_num["elder", "HIV/AIDS related death"] &lt;- 0.004
# or equivalently
new_cond_prob_num[1, 3] &lt;- 0.005

fit7&lt;- insilico(RandomVA1, subpop = NULL,  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
              CondProbNum = new_cond_prob_num, 
		   auto.length = FALSE) 
# note: compare this with fit1, fit5, and fit6
summary(fit7)

##
## Scenario 8: physician coding
## see also the examples in physician_debias() function section
##
# Load sample input for physicians
data(RandomPhysician)
# The symptom section looks the same as standard input
head(RandomPhysician[, 1:5])
# At the end of file, including a few more columns of physician id and coded cause
head(RandomPhysician[, 245:250])

# load Cause Grouping (if physician-coded causes are in larger categories)
data(SampleCategory)
head(SampleCategory)

# existing doctor codes in the sample dataset
doctors &lt;- paste0("doc", c(1:15))
causelist &lt;- c("Communicable", "TB/AIDS", "Maternal",
               "NCD", "External", "Unknown")
phydebias &lt;- physician_debias(RandomPhysician, 
phy.id = c("rev1", "rev2"), phy.code = c("code1", "code2"), 
phylist = doctors, causelist = causelist, 
tol = 0.0001, max.itr = 100)

fit8 &lt;- insilico(RandomVA1, subpop = NULL,  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
              phy.debias = phydebias,
              phy.cat = SampleCategory, 
              phy.external = "External", phy.unknown = "Unknown",
		   auto.length = FALSE) 
summary(fit8)

# example to fit WHO2016 data
data(RandomVA5)
fit1a &lt;- insilico(RandomVA5, data.type="WHO2016", subpop = NULL,  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
		   auto.length = FALSE)
summary(fit1a)
plot(fit1)

# example to change directory for error files
fit1b &lt;- insilico(RandomVA5[1:50, ], data.type="WHO2016", 
					Nsim = 1000, burnin = 500, thin = 10 , 
					seed = 1, auto.length=F)
fit1c &lt;- insilico(RandomVA5[1:50, ], data.type="WHO2016", 
					Nsim = 1000, burnin = 500, thin = 10 , 
					seed = 1, auto.length=F)

 # similarly for WHO 2012 version
fit1&lt;- insilico(RandomVA1, subpop = NULL,  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
		         auto.length = FALSE)


## End(Not run)
</code></pre>

<hr>
<h2 id='insilico.fit'>Implement InSilicoVA methods with more flexible customization</h2><span id='topic+insilico.fit'></span>

<h3>Description</h3>

<p>This function implements InSilicoVA model. This is the lower level core function of InSilicoVA with more flexibility in customized input. For more detail of model specification, see the paper on <a href="https://arxiv.org/abs/1411.3042">https://arxiv.org/abs/1411.3042</a> and the default function <code><a href="#topic+insilico">insilico</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insilico.fit(
  data,
  data.type = c("WHO2012", "WHO2016")[1],
  sci = NULL,
  isNumeric = FALSE,
  updateCondProb = TRUE,
  keepProbbase.level = TRUE,
  CondProb = NULL,
  CondProbNum = NULL,
  datacheck = TRUE,
  datacheck.missing = TRUE,
  warning.write = FALSE,
  directory = NULL,
  external.sep = TRUE,
  Nsim = 4000,
  thin = 10,
  burnin = 2000,
  auto.length = TRUE,
  conv.csmf = 0.02,
  jump.scale = 0.1,
  levels.prior = NULL,
  levels.strength = 1,
  trunc.min = 1e-04,
  trunc.max = 0.9999,
  subpop = NULL,
  java_option = "-Xmx1g",
  seed = 1,
  phy.code = NULL,
  phy.cat = NULL,
  phy.unknown = NULL,
  phy.external = NULL,
  phy.debias = NULL,
  exclude.impossible.cause = c("subset2", "subset", "all", "InterVA", "none")[1],
  impossible.combination = NULL,
  no.is.missing = FALSE,
  customization.dev = FALSE,
  Probbase_by_symp.dev = FALSE,
  probbase.dev = NULL,
  table.dev = NULL,
  table.num.dev = NULL,
  gstable.dev = NULL,
  nlevel.dev = NULL,
  indiv.CI = NULL,
  groupcode = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="insilico.fit_+3A_data">data</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_data.type">data.type</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_sci">sci</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_isnumeric">isNumeric</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_updatecondprob">updateCondProb</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_keepprobbase.level">keepProbbase.level</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_condprob">CondProb</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_condprobnum">CondProbNum</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_datacheck">datacheck</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_datacheck.missing">datacheck.missing</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_warning.write">warning.write</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_directory">directory</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_external.sep">external.sep</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_nsim">Nsim</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_thin">thin</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_burnin">burnin</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_auto.length">auto.length</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_conv.csmf">conv.csmf</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_jump.scale">jump.scale</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_levels.prior">levels.prior</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_levels.strength">levels.strength</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_trunc.min">trunc.min</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_trunc.max">trunc.max</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_subpop">subpop</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_java_option">java_option</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_seed">seed</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_phy.code">phy.code</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_phy.cat">phy.cat</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_phy.unknown">phy.unknown</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_phy.external">phy.external</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_phy.debias">phy.debias</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_exclude.impossible.cause">exclude.impossible.cause</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_impossible.combination">impossible.combination</code></td>
<td>
<p>see <code><a href="#topic+insilico.train">insilico.train</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_no.is.missing">no.is.missing</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code></p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_customization.dev">customization.dev</code></td>
<td>
<p>Logical indicator for customized variables</p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_probbase_by_symp.dev">Probbase_by_symp.dev</code></td>
<td>
<p>Not tested yet.</p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_probbase.dev">probbase.dev</code></td>
<td>
<p>The customized conditional probabilities of symptoms given causes, which could be in a different format than InterVA default, but it should consist of <code>nlevel.dev</code> levels rather than numerical values.</p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_table.dev">table.dev</code></td>
<td>
<p>The table of level names in <code>probbase.dev</code>. Default to be NULL</p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_table.num.dev">table.num.dev</code></td>
<td>
<p>The corresponding prior numerical values for each level in <code>probbase.dev</code>, in the same order as <code>table.dev</code>. Default to be NULL</p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_gstable.dev">gstable.dev</code></td>
<td>
<p>Table of gold standard causes for each death. Default to be NULL</p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_nlevel.dev">nlevel.dev</code></td>
<td>
<p>number of levels in <code>probbase.dev</code>. Default to be NULL</p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_indiv.ci">indiv.CI</code></td>
<td>
<p>credible interval for individual probabilities</p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_groupcode">groupcode</code></td>
<td>
<p>logical indicator of including the group code in the output causes</p>
</td></tr>
<tr><td><code id="insilico.fit_+3A_...">...</code></td>
<td>
<p>unused arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a insilico fit object, see see <code><a href="#topic+insilico">insilico</a></code> for more detail.
</p>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C.
Crampin, Kathleen Kahn and Samuel J. Clark(2014) <em>Probabilistic
cause-of-death assignment using verbal autopsies</em>,
<a href="https://arxiv.org/abs/1411.3042">https://arxiv.org/abs/1411.3042</a> <br /> <em>Working paper no. 147, Center
for Statistics and the Social Sciences, University of Washington</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.insilico">plot.insilico</a></code>, <code><a href="#topic+summary.insilico">summary.insilico</a></code>
</p>

<hr>
<h2 id='insilico.train'>Modified InSilicoVA methods with training data</h2><span id='topic+insilico.train'></span>

<h3>Description</h3>

<p>This function implements InSilicoVA model with non-InterVA4 input data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insilico.train(
  data,
  train,
  cause,
  causes.table = NULL,
  thre = 0.95,
  type = c("quantile", "fixed", "empirical")[1],
  isNumeric = FALSE,
  updateCondProb = TRUE,
  keepProbbase.level = TRUE,
  CondProb = NULL,
  CondProbNum = NULL,
  datacheck = TRUE,
  datacheck.missing = TRUE,
  warning.write = FALSE,
  external.sep = TRUE,
  Nsim = 4000,
  thin = 10,
  burnin = 2000,
  auto.length = TRUE,
  conv.csmf = 0.02,
  jump.scale = 0.1,
  levels.prior = NULL,
  levels.strength = NULL,
  trunc.min = 1e-04,
  trunc.max = 0.9999,
  subpop = NULL,
  java_option = "-Xmx1g",
  seed = 1,
  phy.code = NULL,
  phy.cat = NULL,
  phy.unknown = NULL,
  phy.external = NULL,
  phy.debias = NULL,
  exclude.impossible.cause = TRUE,
  impossible.combination = NULL,
  indiv.CI = NULL,
  CondProbTable = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="insilico.train_+3A_data">data</code></td>
<td>
<p>The original data to be used. It is suggested to use similar
input as InterVA4, with the first column being death IDs and 245 symptoms. 
The only difference in input is InsilicoVA takes three levels: &ldquo;present&rdquo;,
&ldquo;absent&rdquo;, and &ldquo;missing (no data)&rdquo;. Similar to InterVA software,
&ldquo;present&rdquo; symptoms takes value &ldquo;Y&rdquo;; &ldquo;absent&rdquo; symptoms take take value
&ldquo;NA&rdquo; or &ldquo;&rdquo;. For missing symptoms, e.g., questions not asked or answered
in the original interview, corrupted data, etc., the input should be coded
by &ldquo;.&rdquo; to distinguish from &ldquo;absent&rdquo; category. The order of the columns does
not matter as long as the column names are correct. It can also include more 
unused columns than the standard InterVA4 input. But the first column should be 
the death ID. For example input data format, see <code>RandomVA1</code> and 
<code>RandomVA2</code>.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_train">train</code></td>
<td>
<p>Training data, it should be in the same format as the testing data
and contains one additional column (see <code>cause</code> below) specifying known
cause of death. The first column is also assumed to be death ID.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_cause">cause</code></td>
<td>
<p>the name of the column in <code>train</code> that contains cause of death.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_causes.table">causes.table</code></td>
<td>
<p>The list of causes of death used in training data.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_thre">thre</code></td>
<td>
<p>a numerical value between 0 to 1. It specifies the maximum rate of
missing for any symptoms to be considered in the model. Default value is set to
0.95, meaning if a symptom has more than 95% missing in the training data, it
will be removed.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_type">type</code></td>
<td>
<p>Three types of learning conditional probabilities are provided: &ldquo;empirical&rdquo;, &ldquo;quantile&rdquo;
or &ldquo;fixed&rdquo;. Since InSilicoVA works with ranked conditional probabilities P(S|C), &ldquo;quantile&rdquo;
means the rankings of the P(S|C) are obtained by matching the same quantile distributions
in the default InterVA P(S|C), and &ldquo;fixed&rdquo; means P(S|C) are matched to the closest values
in the default InterVA P(S|C) table. Empirically both types of rankings produce similar results. &ldquo;empirical&rdquo;, on the other hand, means no ranking is calculated, but use the empirical conditional probabilities directly. If &ldquo;empirical&rdquo;, <code>updateCondProb</code> will be forced to be FALSE.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_isnumeric">isNumeric</code></td>
<td>
<p>Indicator if the input is already in numeric form. If the
input is coded numerically such that 1 for &ldquo;present&rdquo;, 0 for &ldquo;absent&rdquo;,
and -1 for &ldquo;missing&rdquo;, this indicator could be set to True to avoid
conversion to standard InterVA format.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_updatecondprob">updateCondProb</code></td>
<td>
<p>Logical indicator. If FALSE, then fit InSilicoVA model without 
re-estimating conditional probabilities.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_keepprobbase.level">keepProbbase.level</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_condprob">CondProb</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_condprobnum">CondProbNum</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_datacheck">datacheck</code></td>
<td>
<p>Not Implemented.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_datacheck.missing">datacheck.missing</code></td>
<td>
<p>Not Implemented.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_warning.write">warning.write</code></td>
<td>
<p>Not Implemented.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_external.sep">external.sep</code></td>
<td>
<p>Not Implemented.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_nsim">Nsim</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_thin">thin</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_burnin">burnin</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_auto.length">auto.length</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_conv.csmf">conv.csmf</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_jump.scale">jump.scale</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_levels.prior">levels.prior</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_levels.strength">levels.strength</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_trunc.min">trunc.min</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_trunc.max">trunc.max</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_subpop">subpop</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_java_option">java_option</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_seed">seed</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_phy.code">phy.code</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_phy.cat">phy.cat</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_phy.unknown">phy.unknown</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_phy.external">phy.external</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_phy.debias">phy.debias</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_exclude.impossible.cause">exclude.impossible.cause</code></td>
<td>
<p>Whether to include impossible causes</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_impossible.combination">impossible.combination</code></td>
<td>
<p>a matrix of two columns, first is the name of symptoms, and the second is the name of causes. Each row corresponds to a combination of impossible symptom (that exists) and cause.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_indiv.ci">indiv.CI</code></td>
<td>
<p>see <code><a href="#topic+insilico">insilico</a></code> for more detail.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_condprobtable">CondProbTable</code></td>
<td>
<p>a data frame of two columns: one alphabetic level of the CondProb argument and one numerical value corresponding to the numerical value of each level. Only used when only conditional probabilities are provided instead of training data.</p>
</td></tr>
<tr><td><code id="insilico.train_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please see <code>insilico</code> for more details about choosing chain length and 
OS system differences. This function implements InSilico with customized
input format and training data. 
</p>
<p>For more detail of model specification, see the paper on
<a href="https://arxiv.org/abs/1411.3042">https://arxiv.org/abs/1411.3042</a>.
</p>


<h3>Value</h3>

<p><code>insilico</code> object
</p>

<hr>
<h2 id='java_message'>Message to set heap size for Java</h2><span id='topic+java_message'></span>

<h3>Description</h3>

<p>Message to set heap size for Java
</p>


<h3>Usage</h3>

<pre><code class='language-R'>java_message()
</code></pre>

<hr>
<h2 id='mapICD'>Map ICD-10 codes into the WHO 2016 cause list</h2><span id='topic+mapICD'></span>

<h3>Description</h3>

<p>Map ICD-10 codes into the WHO 2016 cause list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mapICD(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mapICD_+3A_x">x</code></td>
<td>
<p>a character object or a vector of ICD-10 codes</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>mapICD("A90")
mapICD(c("A90", "C30"))
</code></pre>

<hr>
<h2 id='physician_debias'>Implement physician debias algorithm</h2><span id='topic+physician_debias'></span>

<h3>Description</h3>

<p>This function implements physician debias algorithm proposed in Salter-Townshend 
and Murphy (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>physician_debias(
  data,
  phy.id,
  phy.code,
  phylist,
  causelist,
  tol = 1e-04,
  max.itr = 5000,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="physician_debias_+3A_data">data</code></td>
<td>
<p>The original data to be used. It is suggested to use similar
input as InterVA4, with the first column being death IDs. The only
difference in input is InsilicoVA takes three levels: &ldquo;present&rdquo;,
&ldquo;absent&rdquo;, and &ldquo;missing (no data)&rdquo;. Similar to InterVA software,
&ldquo;present&rdquo; symptoms takes value &ldquo;Y&rdquo;; &ldquo;absent&rdquo; symptoms take take value
&ldquo;NA&rdquo; or &ldquo;&rdquo;. For missing symptoms, e.g., questions not asked or answered
in the original interview, corrupted data, etc., the input should be coded
by &ldquo;.&rdquo; to distinguish from &ldquo;absent&rdquo; category. The order of the columns does
not matter as long as the column names are correct. Currently it cannot other
non-symptom columns such as subpopulation. And the first column should be 
the death ID. Everything other than the death ID, physician ID, and physician 
codes should be symptoms.</p>
</td></tr>
<tr><td><code id="physician_debias_+3A_phy.id">phy.id</code></td>
<td>
<p>vector of column names for physician ID</p>
</td></tr>
<tr><td><code id="physician_debias_+3A_phy.code">phy.code</code></td>
<td>
<p>vector of column names for physician code</p>
</td></tr>
<tr><td><code id="physician_debias_+3A_phylist">phylist</code></td>
<td>
<p>vector of physician ID used in physician ID columns</p>
</td></tr>
<tr><td><code id="physician_debias_+3A_causelist">causelist</code></td>
<td>
<p>vector of causes used in physician code columns</p>
</td></tr>
<tr><td><code id="physician_debias_+3A_tol">tol</code></td>
<td>
<p>tolerance of the EM algorithm</p>
</td></tr>
<tr><td><code id="physician_debias_+3A_max.itr">max.itr</code></td>
<td>
<p>maximum iteration to run</p>
</td></tr>
<tr><td><code id="physician_debias_+3A_verbose">verbose</code></td>
<td>
<p>logical indicator for printing out likelihood change</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>code.debias</code></td>
<td>
<p>Individual cause likelihood distribution</p>
</td></tr>
<tr><td><code>csmf</code></td>
<td>
<p>Cause specific distribution in the sample</p>
</td></tr>
<tr><td><code>phy.bias</code></td>
<td>
<p>Bias matrix for each physician</p>
</td></tr>
<tr><td><code>cond.prob</code></td>
<td>
<p>Conditional probability of symptoms given causes</p>
</td></tr>
</table>


<h3>References</h3>

<p>M. Salter-Townshend and T. B. Murphy (2013).<em>Sentiment 
analysis of online media</em>. <br /> <em>In Algorithms from and for Nature and 
Life, pages 137-145, Springer.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(RandomPhysician)
head(RandomPhysician[, 1:10])
## Not run: 
causelist &lt;- c("Communicable", "TB/AIDS", "Maternal", 
               "NCD", "External", "Unknown")
phydebias &lt;- physician_debias(RandomPhysician, phy.id = c("rev1", "rev2"), 
phy.code = c("code1", "code2"), phylist = paste0("doc", c(1:15)), 
causelist = causelist, tol = 0.0001, max.itr = 5000)

# see the first physician's bias matrix
round(phydebias$phy.bias[[1]], 2)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.insilico'>plot CSMF from a &quot;insilico&quot; object</h2><span id='topic+plot.insilico'></span>

<h3>Description</h3>

<p>Produce a bar plot of the CSMFs for a fitted <code>"insilico"</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'insilico'
plot(
  x,
  type = c("errorbar", "bar", "compare")[1],
  top = 10,
  causelist = NULL,
  which.sub = NULL,
  xlab = "Causes",
  ylab = "CSMF",
  title = "Top CSMF Distribution",
  horiz = TRUE,
  angle = 60,
  fill = "lightblue",
  err_width = 0.4,
  err_size = 0.6,
  point_size = 2,
  border = "black",
  bw = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.insilico_+3A_x">x</code></td>
<td>
<p>fitted <code>"insilico"</code> object</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_type">type</code></td>
<td>
<p>An indicator of the type of chart to plot. &quot;errorbar&quot; for line
plots of only the error bars on single population; &quot;bar&quot; for bar chart with
error bars on single population; &quot;compare&quot; for line charts on multiple
sub-populations.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_top">top</code></td>
<td>
<p>The number of top causes to plot. If multiple sub-populations are
to be plotted, it will plot the union of the top causes in all
sub-populations.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_causelist">causelist</code></td>
<td>
<p>The list of causes to plot. It could be a numeric vector
indicating the position of the causes in the InterVA cause list (see
<code><a href="#topic+causetext">causetext</a></code>), or a vector of character string of the cause
names. The argument supports partial matching of the cause names. e.g.,
&quot;HIV/AIDS related death&quot; could be abbreviated into &quot;HIV&quot;; &quot;Other and
unspecified infect dis&quot; could be abbreviated into &quot;Other and unspecified
infect&quot;.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_which.sub">which.sub</code></td>
<td>
<p>Specification of which sub-population to plot if there are
multiple and <code>type</code> is set to &quot;bar&quot;.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_xlab">xlab</code></td>
<td>
<p>Labels for the causes.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_ylab">ylab</code></td>
<td>
<p>Labels for the CSMF values.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_title">title</code></td>
<td>
<p>Title of the plot.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_horiz">horiz</code></td>
<td>
<p>Logical indicator indicating if the bars are plotted
horizontally.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_angle">angle</code></td>
<td>
<p>Angle of rotation for the texts on x axis when <code>horiz</code> is
set to FALSE</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_fill">fill</code></td>
<td>
<p>The color to fill the bars when <code>type</code> is set to &quot;bar&quot;.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_err_width">err_width</code></td>
<td>
<p>Size of the error bars.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_err_size">err_size</code></td>
<td>
<p>Thickness of the error bar lines.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_point_size">point_size</code></td>
<td>
<p>Size of the points.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_border">border</code></td>
<td>
<p>The color to color the borders of bars when <code>type</code> is set
to &quot;bar&quot;.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_bw">bw</code></td>
<td>
<p>Logical indicator for setting the theme of the plots to be black
and white.</p>
</td></tr>
<tr><td><code id="plot.insilico_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To-do
</p>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C. Crampin,
Kathleen Kahn and Samuel J. Clark Probabilistic cause-of-death assignment
using verbal autopsies, <em>Journal of the American Statistical
Association</em> (2016), 111(515):1036-1049.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insilico">insilico</a></code>, <code><a href="#topic+summary.insilico">summary.insilico</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(RandomVA1) 
##
## Scenario 1: without sub-population specification
##
fit1&lt;- insilico(RandomVA1, subpop = NULL,  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
              auto.length = FALSE)
# basic line plot
plot(fit1)
# basic bar plot
plot(fit1, type = "bar")
# line plot with customized look
plot(fit1, top = 15, horiz = FALSE, fill = "gold", 
           bw = TRUE, title = "Top 15 CSMFs", angle = 70, 
           err_width = .2, err_size = .6, point_size = 2)

##
## Scenario 2: with sub-population specification
##
data(RandomVA2)
fit2&lt;- insilico(RandomVA2, subpop = list("sex"),  
              Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
              auto.length = FALSE)
summary(fit2)
# basic side-by-side line plot for all sub-populations
plot(fit2, type = "compare", main = "Top 5 causes comparison")
# basic line plot for specific sub-population
plot(fit2, which.sub = "Women", main = "Top 5 causes for women")
# customized plot with only specified causes
# the cause names need not be exact as InterVA cause list
# substrings in InterVA cause list is enough for specification
# e.g. the following two specifications are the same
some_causes_1 &lt;- c("HIV/AIDS related death", "Pulmonary tuberculosis")
some_causes_2 &lt;- c("HIV", "Pulmonary")
plot(fit2, type = "compare", horiz = FALSE,  causelist = some_causes_1,
              title = "HIV and TB fractions in two sub-populations", 
              angle = 20)

## End(Not run)

</code></pre>

<hr>
<h2 id='print.insilico'>Print method for summarizing InSilicoVA Model Fits</h2><span id='topic+print.insilico'></span>

<h3>Description</h3>

<p>This function is the print method for class <code>insilico</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'insilico'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.insilico_+3A_x">x</code></td>
<td>
<p><code>insilico</code> object.</p>
</td></tr>
<tr><td><code id="print.insilico_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C. Crampin,
Kathleen Kahn and Samuel J. Clark Probabilistic cause-of-death assignment
using verbal autopsies, <em>Journal of the American Statistical
Association</em> (2016), 111(515):1036-1049.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.insilico">summary.insilico</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# load sample data together with sub-population list
data(RandomVA1)
# extract InterVA style input data
data &lt;- RandomVA1$data
# extract sub-population information. 
# The groups are "HIV Positive", "HIV Negative" and "HIV status unknown".
subpop &lt;- RandomVA1$subpop

# run without subpopulation
fit1&lt;- insilico( data, subpop = NULL, 
              Nsim = 400, burnin = 200, thin = 10 , seed = 1,
              external.sep = TRUE, keepProbbase.level = TRUE)
fit1

## End(Not run)
</code></pre>

<hr>
<h2 id='print.insilico_summary'>Print method for summarizing InSilicoVA Model Fits</h2><span id='topic+print.insilico_summary'></span>

<h3>Description</h3>

<p>This function is the print method for class <code>insilico_summary</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'insilico_summary'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.insilico_summary_+3A_x">x</code></td>
<td>
<p><code>insilico_summary</code> object.</p>
</td></tr>
<tr><td><code id="print.insilico_summary_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C. Crampin,
Kathleen Kahn and Samuel J. Clark Probabilistic cause-of-death assignment
using verbal autopsies, <em>Journal of the American Statistical
Association</em> (2016), 111(515):1036-1049.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.insilico">summary.insilico</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# load sample data together with sub-population list
data(RandomVA1)
# extract InterVA style input data
data &lt;- RandomVA1$data
# extract sub-population information. 
# The groups are "HIV Positive", "HIV Negative" and "HIV status unknown".
subpop &lt;- RandomVA1$subpop

# run without subpopulation
fit1&lt;- insilico( data, subpop = NULL, 
              Nsim = 400, burnin = 200, thin = 10 , seed = 1,
              external.sep = TRUE, keepProbbase.level = TRUE)
summary(fit1)
summary(fit1, top = 10)

# save individual COD distributions to files
summary(fit1, file = "results.csv")

## End(Not run)
</code></pre>

<hr>
<h2 id='probbase'>Conditional probability of InterVA4</h2><span id='topic+probbase'></span>

<h3>Description</h3>

<p>This is the table of conditional probabilities of symptoms
given CODs, together with the data check rules. The values are from InterVA-4.2.
</p>


<h3>Format</h3>

<p>A data frame with 246 observations on 81 variables.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(probbase)
</code></pre>

<hr>
<h2 id='probbase3'>Conditional probability of InterVA4.03</h2><span id='topic+probbase3'></span>

<h3>Description</h3>

<p>This is the table of conditional probabilities of symptoms given CODs. The
values are from InterVA-4.03.
</p>


<h3>Format</h3>

<p>A data frame with 246 observations on 81 variables. Each observation
is the conditional probability.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(probbase)
</code></pre>

<hr>
<h2 id='RandomPhysician'>100 records of Sample Input together with two simulated physician codes</h2><span id='topic+RandomPhysician'></span>

<h3>Description</h3>

<p>This is the same dataset as in <code>RandomVA2</code> with additional columns specifying physician ID and codes. 
</p>


<h3>Format</h3>

<p>100 arbitrary input records.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RandomPhysician)
head(RandomPhysician[, 1:10])
</code></pre>

<hr>
<h2 id='RandomVA1'>1000 records of Sample Input</h2><span id='topic+RandomVA1'></span>

<h3>Description</h3>

<p>This is a  dataset consisting of 1000 arbitrary sample input 
deaths in the default format of InSilicoVA, i.e., the same input format as in InterVA-4 software and R package. 
</p>


<h3>Format</h3>

<p>1000 arbitrary input records.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RandomVA1)
dim(RandomVA1)
head(RandomVA1)
</code></pre>

<hr>
<h2 id='RandomVA2'>100 records of Sample Input</h2><span id='topic+RandomVA2'></span>

<h3>Description</h3>

<p>This is a  dataset consisting of 1000 arbitrary sample input 
deaths in the default format of InSilicoVA with additional columns specifying age and sex, which could be served as characteristics in sub-population estimation. 
</p>


<h3>Format</h3>

<p>100 arbitrary input records.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(RandomVA2)
dim(RandomVA2)
head(RandomVA2)
</code></pre>

<hr>
<h2 id='SampleCategory'>Correspondence between InterVA causes and the physician coded cause categories</h2><span id='topic+SampleCategory'></span>

<h3>Description</h3>

<p>This is the matrix explaining the correspondence between InterVA causes and the physician coded cause categories.
</p>


<h3>Format</h3>

<p>matrix of 2 columns</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SampleCategory)
head(SampleCategory)
</code></pre>

<hr>
<h2 id='SamplePhysician'>100 records of Sample debiased physician codes</h2><span id='topic+SamplePhysician'></span>

<h3>Description</h3>

<p>This is in the same format of the output running <code><a href="#topic+physician_debias">physician_debias</a></code>. It is a data frame of 100 rows, and column represents ID and probability of the cause in each category.
</p>


<h3>Format</h3>

<p>100 arbitrary input records.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SamplePhysician)
head(SamplePhysician)
</code></pre>

<hr>
<h2 id='stackplot'>plot grouped CSMF from a &quot;insilico&quot; object</h2><span id='topic+stackplot'></span>

<h3>Description</h3>

<p>Produce bar plot of the CSMFs for a fitted <code>"insilico"</code> object in broader groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stackplot(
  x,
  grouping = NULL,
  type = c("stack", "dodge")[1],
  order.group = NULL,
  order.sub = NULL,
  err = TRUE,
  CI = 0.95,
  sample.size.print = FALSE,
  xlab = "Group",
  ylab = "CSMF",
  ylim = NULL,
  title = "CSMF by broader cause categories",
  horiz = FALSE,
  angle = 60,
  err_width = 0.4,
  err_size = 0.6,
  point_size = 2,
  border = "black",
  bw = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stackplot_+3A_x">x</code></td>
<td>
<p>fitted <code>"insilico"</code> object</p>
</td></tr>
<tr><td><code id="stackplot_+3A_grouping">grouping</code></td>
<td>
<p>C by 2 matrix of grouping rule. If set to NULL, make it default.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_type">type</code></td>
<td>
<p>type of the plot to make</p>
</td></tr>
<tr><td><code id="stackplot_+3A_order.group">order.group</code></td>
<td>
<p>list of grouped categories. If set to NULL, make it default.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_order.sub">order.sub</code></td>
<td>
<p>Specification of the order of sub-populations to plot</p>
</td></tr>
<tr><td><code id="stackplot_+3A_err">err</code></td>
<td>
<p>indicator of inclusion of error bars</p>
</td></tr>
<tr><td><code id="stackplot_+3A_ci">CI</code></td>
<td>
<p>confidence interval for error bars.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_sample.size.print">sample.size.print</code></td>
<td>
<p>Logical indicator for printing also the sample size for each sub-population labels.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_xlab">xlab</code></td>
<td>
<p>Labels for the causes.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_ylab">ylab</code></td>
<td>
<p>Labels for the CSMF values.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_ylim">ylim</code></td>
<td>
<p>Range of y-axis.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_title">title</code></td>
<td>
<p>Title of the plot.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_horiz">horiz</code></td>
<td>
<p>Logical indicator indicating if the bars are plotted
horizontally.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_angle">angle</code></td>
<td>
<p>Angle of rotation for the texts on x axis when <code>horiz</code> is
set to FALSE</p>
</td></tr>
<tr><td><code id="stackplot_+3A_err_width">err_width</code></td>
<td>
<p>Size of the error bars.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_err_size">err_size</code></td>
<td>
<p>Thickness of the error bar lines.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_point_size">point_size</code></td>
<td>
<p>Size of the points.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_border">border</code></td>
<td>
<p>The color for the border of the bars.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_bw">bw</code></td>
<td>
<p>Logical indicator for setting the theme of the plots to be black
and white.</p>
</td></tr>
<tr><td><code id="stackplot_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C. Crampin,
Kathleen Kahn and Samuel J. Clark Probabilistic cause-of-death assignment
using verbal autopsies, <em>Journal of the American Statistical
Association</em> (2016), 111(515):1036-1049.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insilico">insilico</a></code>, <code><a href="#topic+summary.insilico">summary.insilico</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  data(RandomVA1) 
  ##
  ## Scenario 1: without sub-population specification
  ##
  fit1&lt;- insilico(RandomVA1, subpop = NULL,  
                Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
                auto.length = FALSE)
  # stack bar plot for grouped causes
  # the default grouping could be seen from
  data(SampleCategory)
  stackplot(fit1, type = "dodge", xlab = "")
  
  ##
  ## Scenario 2: with sub-population specification
  ##
  data(RandomVA2)
  fit2&lt;- insilico(RandomVA2, subpop = list("sex"),  
                Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
                auto.length = FALSE)
  stackplot(fit2, type = "stack", angle = 0)
  stackplot(fit2, type = "dodge", angle = 0)
  # Change the default grouping by separating TB from HIV
  data(SampleCategory)
  SampleCategory[c(3, 9), ]
  SampleCategory[3, 2] &lt;- "HIV/AIDS"
  SampleCategory[9, 2] &lt;- "TB"
  stackplot(fit2, type = "stack", grouping = SampleCategory, 
            sample.size.print = TRUE, angle = 0)
  stackplot(fit2, type = "dodge", grouping = SampleCategory,
            sample.size.print = TRUE, angle = 0)
  
  # change the order of display for sub-population and cause groups
  groups &lt;- c("HIV/AIDS", "TB", "Communicable", "NCD", "External",
              "Maternal", "causes specific to infancy") 
  subpops &lt;- c("Women", "Men")
  stackplot(fit2, type = "stack", grouping = SampleCategory, 
            order.group = groups, order.sub = subpops, 
            sample.size.print = TRUE, angle = 0)	

## End(Not run) 
</code></pre>

<hr>
<h2 id='summary.insilico'>Summarizing InSilicoVA Model Fits</h2><span id='topic+summary.insilico'></span>

<h3>Description</h3>

<p>This function is the summary method for class <code>insilico</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'insilico'
summary(
  object,
  CI.csmf = 0.95,
  CI.cond = 0.95,
  file = NULL,
  top = 10,
  id = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.insilico_+3A_object">object</code></td>
<td>
<p>Fitted <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code id="summary.insilico_+3A_ci.csmf">CI.csmf</code></td>
<td>
<p>Confidence interval for CSMF estimates.</p>
</td></tr>
<tr><td><code id="summary.insilico_+3A_ci.cond">CI.cond</code></td>
<td>
<p>Confidence interval for conditional probability estimates</p>
</td></tr>
<tr><td><code id="summary.insilico_+3A_file">file</code></td>
<td>
<p>Optional .csv file to write to. If it is specified, individual
cause of death distribution will be saved to the file.</p>
</td></tr>
<tr><td><code id="summary.insilico_+3A_top">top</code></td>
<td>
<p>Number of top causes to display on screen.</p>
</td></tr>
<tr><td><code id="summary.insilico_+3A_id">id</code></td>
<td>
<p>ID of specific death to display on screen.</p>
</td></tr>
<tr><td><code id="summary.insilico_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.insilico</code> formats some basic information about the InSilicoVA
fitted object on screen and show the several top CSMFs of user's choice. See
below for more detail.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>id.all</code></td>
<td>
<p> all IDs of the deaths.</p>
</td></tr> 
<tr><td><code>indiv</code></td>
<td>
<p> individual Cause of Death distribution matrix.</p>
</td></tr> 
<tr><td><code>csmf</code></td>
<td>
<p> CSMF distribution and confidence interval for each cause.</p>
</td></tr> 
<tr><td><code>csmf.ordered</code></td>
<td>
<p> CSMF distribution and confidence interval for each cause, ordered by mean.</p>
</td></tr> 
<tr><td><code>condprob</code></td>
<td>
<p> Conditional probability matrix and confidence intervals.</p>
</td></tr>
<tr><td><code>updateCondProb</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>keepProbbase.level</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>datacheck</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>Nsim</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>thin</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr> <tr><td><code>burnin</code></td>
<td>
<p>Component
of <code>"insilico"</code> object.</p>
</td></tr> 
<tr><td><code>jump.scale</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>levels.prior</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>levels.strength</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>trunc.min</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>trunc.max</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>subpop_counts</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code>showTop</code></td>
<td>
<p>Component of <code>"insilico"</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C. Crampin,
Kathleen Kahn and Samuel J. Clark Probabilistic cause-of-death assignment
using verbal autopsies, <em>Journal of the American Statistical
Association</em> (2016), 111(515):1036-1049.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insilico">insilico</a></code>, <code><a href="#topic+plot.insilico">plot.insilico</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# load sample data together with sub-population list
data(RandomVA1)
# extract InterVA style input data
data &lt;- RandomVA1$data
# extract sub-population information. 
# The groups are "HIV Positive", "HIV Negative" and "HIV status unknown".
subpop &lt;- RandomVA1$subpop

# run without subpopulation
fit1&lt;- insilico( data, subpop = NULL, 
              Nsim = 400, burnin = 200, thin = 10 , seed = 1,
              external.sep = TRUE, keepProbbase.level = TRUE)
summary(fit1)
summary(fit1, top = 10)

# save individual COD distributions to files
summary(fit1, file = "results.csv")

## End(Not run)
</code></pre>

<hr>
<h2 id='updateIndiv'>Update individual COD probabilities from InSilicoVA Model Fits</h2><span id='topic+updateIndiv'></span>

<h3>Description</h3>

<p>This function updates individual probabilities for each death and provide posterior credible intervals for each estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateIndiv(object, CI = 0.95, java_option = "-Xmx1g", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateIndiv_+3A_object">object</code></td>
<td>
<p>Fitted <code>"insilico"</code> object.</p>
</td></tr>
<tr><td><code id="updateIndiv_+3A_ci">CI</code></td>
<td>
<p>Credible interval for posterior estimates.</p>
</td></tr>
<tr><td><code id="updateIndiv_+3A_java_option">java_option</code></td>
<td>
<p>Option to initialize java JVM. Default to &ldquo;-Xmx1g&rdquo;, which sets the maximum heap size to be 1GB.</p>
</td></tr>
<tr><td><code id="updateIndiv_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object Updated <code>"insilico"</code> object.
</p>


<h3>Author(s)</h3>

<p>Zehang Li, Tyler McCormick, Sam Clark
</p>
<p>Maintainer: Zehang Li &lt;lizehang@uw.edu&gt;
</p>


<h3>References</h3>

<p>#' Tyler H. McCormick, Zehang R. Li, Clara Calvert, Amelia C. Crampin,
Kathleen Kahn and Samuel J. Clark Probabilistic cause-of-death assignment
using verbal autopsies, <em>Journal of the American Statistical
Association</em> (2016), 111(515):1036-1049.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insilico">insilico</a></code>, <code><a href="#topic+get.indiv">get.indiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(RandomVA1)
fit1a&lt;- insilico(RandomVA1, subpop = NULL,  
                Nsim = 1000, burnin = 500, thin = 10 , seed = 1,
                auto.length = FALSE)
summary(fit1a, id = "d199")

# The following script updates credible interval for individual 
fit1b &lt;- updateIndiv(fit1a, CI = 0.95)
summary(fit1b, id = "d199")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
