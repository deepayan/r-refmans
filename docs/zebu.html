<!DOCTYPE html><html lang="en"><head><title>Help for package zebu</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {zebu}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#zebu'><p>zebu: Local Association Measures</p></a></li>
<li><a href='#chisqtest'><p>Chi-squared test</p></a></li>
<li><a href='#estimate_prob'><p>Estimate marginal and multivariate probabilities</p></a></li>
<li><a href='#format.lassie'><p>Format a lassie object</p></a></li>
<li><a href='#lassie'><p>Local Association Measures</p></a></li>
<li><a href='#lassie_get'><p>Return the value of 'lassie' object</p></a></li>
<li><a href='#local_association'><p>Local Association Measures</p></a></li>
<li><a href='#permtest'><p>Permutation test for local and global association measures</p></a></li>
<li><a href='#plot.lassie'><p>Plot a lassie object</p></a></li>
<li><a href='#preprocess'><p>Preprocess data</p></a></li>
<li><a href='#print.lassie'><p>Print a lassie object</p></a></li>
<li><a href='#write.lassie'><p>Write a lassie object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Local Association Measures</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-25</td>
</tr>
<tr>
<td>Author:</td>
<td>Olivier M. F. Martin [aut, cre],
  Michel Ducher [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Olivier M. F. Martin &lt;oliviermfmartin@tutanota.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the estimation of local (and global) association measures: Lewontin's D, Ducher's Z, pointwise mutual information, normalized pointwise mutual information and chi-squared residuals. The significance of local (and global) association is accessed using p-values estimated by permutations.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/oliviermfmartin/zebu">https://github.com/oliviermfmartin/zebu</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/oliviermfmartin/zebu/issues">https://github.com/oliviermfmartin/zebu/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, data.table, reshape2, utils, Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, markdown, devtools, usethis, svs, pbapply,
testthat</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-25 10:59:50 UTC; olivier</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-25 11:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='zebu'>zebu: Local Association Measures</h2><span id='topic+zebu'></span><span id='topic+zebu-package'></span>

<h3>Description</h3>

<p>The zebu package implements the estimation of local (and global) association measures:
Ducher's Z, Lewontin's D, pointwise mutual information, normalized pointwise mutual information and chi-squared residuals.
The significance of local (and global) association is accessed using p-values estimated by permutations.
</p>


<h3>Functions</h3>

<p><code><a href="#topic+lassie">lassie</a></code> estimates local (and global) association measures: Ducher's Z, Lewontin's D, pointwise mutual information, normalized pointwise mutual information and chi-squared residuals.
</p>
<p><code><a href="#topic+permtest">permtest</a></code> accesses the significance of local (and global) association values usingp-values estimated by permutations.
</p>
<p><code><a href="#topic+chisqtest">chisqtest</a></code> accesses the significance for two dimensional chi-squared analysis.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Olivier M. F. Martin <a href="mailto:oliviermfmartin@tutanota.com">oliviermfmartin@tutanota.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Michel Ducher <a href="mailto:michel.ducher@chu-lyon.fr">michel.ducher@chu-lyon.fr</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/oliviermfmartin/zebu">https://github.com/oliviermfmartin/zebu</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/oliviermfmartin/zebu/issues">https://github.com/oliviermfmartin/zebu/issues</a>
</p>
</li></ul>


<hr>
<h2 id='chisqtest'>Chi-squared test</h2><span id='topic+chisqtest'></span>

<h3>Description</h3>

<p>Chi-squared test: statistical significance of (global) chi-squared statistic
and (local) chi-squared residuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisqtest(x, p_adjust = "BH")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chisqtest_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+lassie">lassie</a></code> S3 object.</p>
</td></tr>
<tr><td><code id="chisqtest_+3A_p_adjust">p_adjust</code></td>
<td>
<p>multiple testing correction method.
(see <code><a href="stats.html#topic+p.adjust.methods">p.adjust.methods</a></code> for a list of methods).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>chisqtest</code> returns an S3 object of <a href="base.html#topic+class">class</a>
<code><a href="#topic+lassie">lassie</a></code> and <code><a href="#topic+chisqtest">chisqtest</a></code>.
Adds the following to the lassie object <code>x</code>:
</p>

<ul>
<li><p> global_p: global association p-value.
</p>
</li>
<li><p> local_p: array of local association p-values.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+lassie">lassie</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Calling lassie on cars dataset
las &lt;- lassie(cars, continuous = colnames(cars), measure = "chisq")

# Permutation test using default settings
chisqtest(las)

</code></pre>

<hr>
<h2 id='estimate_prob'>Estimate marginal and multivariate probabilities</h2><span id='topic+estimate_prob'></span>

<h3>Description</h3>

<p>Maximum-likelihood estimation of marginal and multivariate observed and expected independence probabilities. Marginal probability refers to probability of each factor per individual column. Multivariate probability refer to cross-classifying factors for all columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_prob(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_prob_+3A_x">x</code></td>
<td>
<p>data.frame or matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the following values:
</p>

<ul>
<li><p> margins: a list of marginal probabilities. Names correspond to colnames(x).
</p>
</li>
<li><p> observed: observed multivariate probability array.
</p>
</li>
<li><p> expected: expected multivariate probability array
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># This is what happens behind the curtains in the 'lassie' function
# Here we compute the association between the 'Girth' and 'Height' variables
# of the 'trees' dataset

# 'select' and 'continuous' take column numbers or names
select &lt;- c('Girth', 'Height') # select subset of trees
continuous &lt;-c(1, 2) # both 'Girth' and 'Height' are continuous

# equal-width discretization with 3 bins
breaks &lt;- 3

# Preprocess data: subset, discretize and remove missing data
pre &lt;- preprocess(trees, select, continuous, breaks)

# Estimates marginal and multivariate probabilities from preprocessed data.frame
prob &lt;- estimate_prob(pre$pp)

# Computes local and global association using Ducher's Z
lam &lt;- local_association(prob, measure = 'z')
</code></pre>

<hr>
<h2 id='format.lassie'>Format a lassie object</h2><span id='topic+format.lassie'></span>

<h3>Description</h3>

<p>Formats a <code><a href="#topic+lassie">lassie</a></code> object for printing to console
(see <code><a href="#topic+print.lassie">print.lassie</a></code>) and for writing to a file
(see <code><a href="#topic+write.lassie">write.lassie</a></code>). Melts probability or local association
measure arrays into a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lassie'
format(x, what_x, range, what_range, what_sort, decreasing, na.rm, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format.lassie_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+lassie">lassie</a></code> S3 object.</p>
</td></tr>
<tr><td><code id="format.lassie_+3A_what_x">what_x</code></td>
<td>
<p>vector specifying values to be returned:
</p>

<ul>
<li><p> 'local': local association measure values (default).
</p>
</li>
<li><p> 'obs': observed probabilities.
</p>
</li>
<li><p> 'exp': expected probabilities.
</p>
</li>
<li><p> 'local_p': p-value of local association (after running <code><a href="#topic+permtest">permtest</a></code> or <code><a href="#topic+chisqtest">chisqtest</a></code>).
</p>
</li></ul>
</td></tr>
<tr><td><code id="format.lassie_+3A_range">range</code></td>
<td>
<p>range of values to be retained (vector of two numeric values).</p>
</td></tr>
<tr><td><code id="format.lassie_+3A_what_range">what_range</code></td>
<td>
<p>character specifying what value <code>range</code> refers to
(same options as <code>what_x</code>).
By default, takes the first value in <code>what_x</code>.</p>
</td></tr>
<tr><td><code id="format.lassie_+3A_what_sort">what_sort</code></td>
<td>
<p>character specifying according to which values should <code>x</code> be sorted
(same options as <code>what_x</code>).
By default, takes the first value in <code>what_x</code>.</p>
</td></tr>
<tr><td><code id="format.lassie_+3A_decreasing">decreasing</code></td>
<td>
<p>logical value specifying sort order.</p>
</td></tr>
<tr><td><code id="format.lassie_+3A_na.rm">na.rm</code></td>
<td>
<p>logical value indicating whether NA values should be stripped.</p>
</td></tr>
<tr><td><code id="format.lassie_+3A_...">...</code></td>
<td>
<p>other arguments passed on to methods. Not currently used.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+lassie">lassie</a></code>
</p>

<hr>
<h2 id='lassie'>Local Association Measures</h2><span id='topic+lassie'></span>

<h3>Description</h3>

<p>Estimates local (and global) association measures: Ducher's Z, Lewontin's D, pointwise mutual
information, normalized pointwise mutual information and chi-squared residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lassie(x, select, continuous, breaks, measure = "chisq", default_breaks = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lassie_+3A_x">x</code></td>
<td>
<p>data.frame or matrix.</p>
</td></tr>
<tr><td><code id="lassie_+3A_select">select</code></td>
<td>
<p>optional vector of column numbers or column names
specifying a subset of data to be used. By default, uses all columns.</p>
</td></tr>
<tr><td><code id="lassie_+3A_continuous">continuous</code></td>
<td>
<p>optional vector of column numbers or column names specifying
continuous variables that should be discretized.
By default, assumes that every variable is categorical.</p>
</td></tr>
<tr><td><code id="lassie_+3A_breaks">breaks</code></td>
<td>
<p>numeric vector or list passed on to <code><a href="base.html#topic+cut">cut</a></code> to discretize
continuous variables. When a numeric vector is specified, break points are
applied to all continuous variables. In order to specify variable-specific
breaks, lists are used. List names identify variables and list values identify
breaks. List names are column names (not numbers). If a continuous
variable has no specified breaks, then <code>default_breaks</code> will be applied.</p>
</td></tr>
<tr><td><code id="lassie_+3A_measure">measure</code></td>
<td>
<p>name of measure to be used:
</p>

<ul>
<li><p>'chisq': Chi-squared residuals.
</p>
</li>
<li><p>'d': Lewontin's D.
</p>
</li>
<li><p>'z': Ducher's 'z'.
</p>
</li>
<li><p>'pmi': Pointwise mutual information (in bits).
</p>
</li>
<li><p>'npmi': Normalized pointwise mutual information (Bouma).
</p>
</li>
<li><p>'npmi2': Normalized pointwise mutual information (Multivariate).
</p>
</li></ul>
</td></tr>
<tr><td><code id="lassie_+3A_default_breaks">default_breaks</code></td>
<td>
<p>default break points for discretizations.
Same syntax as in <code><a href="base.html#topic+cut">cut</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An instance of S3 <a href="base.html#topic+class">class</a> <code><a href="#topic+lassie">lassie</a></code> with
the following objects:
</p>

<ul>
<li><p> data: raw and preprocessed data.frames (see <a href="#topic+preprocess">preprocess</a>).
</p>
</li>
<li><p> prob probability arrays (see <a href="#topic+estimate_prob">estimate_prob</a>).
</p>
</li>
<li><p> global global association (see <a href="#topic+local_association">local_association</a>).
</p>
</li>
<li><p> local local association arrays (see <a href="#topic+local_association">local_association</a>).
</p>
</li>
<li><p> lassie_params parameters used in lassie.
</p>
</li></ul>



<h3>See Also</h3>

<p>Results can be visualized using <code><a href="#topic+plot.lassie">plot.lassie</a></code> and
<code><a href="#topic+print.lassie">print.lassie</a></code>
methods. <code><a href="#topic+plot.lassie">plot.lassie</a></code> is only available
in the bivariate case and returns
a tile plot representing the probability or local association measure matrix.
<code><a href="#topic+print.lassie">print.lassie</a></code> shows an array or a data.frame.
</p>
<p>Results can be saved using <code><a href="#topic+write.lassie">write.lassie</a></code>.
</p>
<p>The <code><a href="#topic+permtest">permtest</a></code> function accesses the significance of local and global
association values using p-values estimated by permutations.
</p>
<p>The <code><a href="#topic+chisqtest">chisqtest</a></code> function accesses the significance in the case
of two dimensional chi-squared analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In this example, we will use the 'mtcars' dataset

# Selecting a subset of mtcars.
# Takes column names or numbers.
# If nothing was specified, all variables would have been used.
select &lt;- c('mpg', 'cyl') # or select &lt;- c(1, 2)

# Specifying 'mpg' as a continuous variables using column numbers
# Takes column names or numbers.
# If nothing was specified, all variables would have been used.
continuous &lt;- 'mpg' # or continuous &lt;- 1

# How should breaks be specified?
# Specifying equal-width discretization with 5 bins for all continuous variables ('mpg')
# breaks &lt;- 5

# Specifying user-defined breakpoints for all continuous variables.
# breaks &lt;- c(10, 15, 25, 30)

# Same thing but only for 'mpg'.
# Here both notations are equivalent because 'mpg' is the only continuous variable.
# This notation is useful if you wish to specify different break points for different variables
# breaks &lt;- list('mpg' = 5)
# breaks &lt;- list('mpg' = c(10, 15, 25, 30))

# Calling lassie
# Not specifying breaks means that the value in default_breaks (4) will be used.
las &lt;- lassie(mtcars, select = c(1, 2), continuous = 1)

# Print local association to console as an array
print(las)

# Print local association and probabilities
# Here only rows having a positive local association are printed
# The data.frame is also sorted by observed probability
print(las, type = 'df', range = c(0, 1), what_sort = 'obs')

# Plot results as heatmap
plot(las)

# Plot observed probabilities using different colors
plot(las, what_x = 'obs', low = 'white', mid = 'grey', high = 'black', text_colour = 'red')

</code></pre>

<hr>
<h2 id='lassie_get'>Return the value of 'lassie' object</h2><span id='topic+lassie_get'></span>

<h3>Description</h3>

<p>Subroutine for <code><a href="#topic+lassie">lassie</a></code> methods. Tries to retrieve a value from a <code><a href="#topic+lassie">lassie</a></code> object
and gives an error if value does not exist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lassie_get(x, what_x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lassie_get_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+lassie">lassie</a></code> S3 object.</p>
</td></tr>
<tr><td><code id="lassie_get_+3A_what_x">what_x</code></td>
<td>
<p>vector specifying values to be returned:
</p>

<ul>
<li><p> 'local': local association measure values (default).
</p>
</li>
<li><p> 'obs': observed probabilities.
</p>
</li>
<li><p> 'exp': expected probabilities.
</p>
</li>
<li><p> 'local_p': p-value of local association (after running <code><a href="#topic+permtest">permtest</a></code> or <code><a href="#topic+chisqtest">chisqtest</a></code>).
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Corresponding array contained in <code><a href="#topic+lassie">lassie</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>las &lt;- lassie(trees)
las_array &lt;- lassie_get(las, 'local')

</code></pre>

<hr>
<h2 id='local_association'>Local Association Measures</h2><span id='topic+local_association'></span><span id='topic+lewontin_d'></span><span id='topic+duchers_z'></span><span id='topic+pmi'></span><span id='topic+chisq'></span>

<h3>Description</h3>

<p>Subroutines called by <code><a href="#topic+lassie">lassie</a></code> to compute
local and global association measures from a list of probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>local_association(x, measure = "chisq", nr = 1)

lewontin_d(x)

duchers_z(x)

pmi(x, normalize)

chisq(x, nr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="local_association_+3A_x">x</code></td>
<td>
<p>list of probabilities as outputted by <code><a href="#topic+estimate_prob">estimate_prob</a></code>.</p>
</td></tr>
<tr><td><code id="local_association_+3A_measure">measure</code></td>
<td>
<p>name of measure to be used:
</p>

<ul>
<li><p>'chisq': Chi-squared residuals.
</p>
</li>
<li><p>'d': Lewontin's D.
</p>
</li>
<li><p>'z': Ducher's 'z'.
</p>
</li>
<li><p>'pmi': Pointwise mutual information (in bits).
</p>
</li>
<li><p>'npmi': Normalized pointwise mutual information (Bouma).
</p>
</li>
<li><p>'npmi2': Normalized pointwise mutual information (Multivariate).
</p>
</li></ul>
</td></tr>
<tr><td><code id="local_association_+3A_nr">nr</code></td>
<td>
<p>number of rows/samples. Only used to estimate chi-squared residuals.</p>
</td></tr>
<tr><td><code id="local_association_+3A_normalize">normalize</code></td>
<td>
<p>0 for pmi, 1 for npmi, 2 for npmi2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the following values:
</p>

<ul>
<li><p> local: local association array (may contain NA, NaN and Inf values).
</p>
</li>
<li><p> global: global association numeric value.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+lassie">lassie</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is what happens behind the curtains in the 'lassie' function
# Here we compute the association between the 'Girth' and 'Height' variables
# of the 'trees' dataset

# 'select' and 'continuous' take column numbers or names
select &lt;- c('Girth', 'Height') # select subset of trees
continuous &lt;-c(1, 2) # both 'Girth' and 'Height' are continuous

# equal-width discretization with 3 bins
breaks &lt;- 3

# Preprocess data: subset, discretize and remove missing data
pre &lt;- preprocess(trees, select, continuous, breaks)

# Estimates marginal and multivariate probabilities from preprocessed data.frame
prob &lt;- estimate_prob(pre$pp)

# Computes local and global association using Ducher's Z
lam &lt;- local_association(prob, measure = 'z')
</code></pre>

<hr>
<h2 id='permtest'>Permutation test for local and global association measures</h2><span id='topic+permtest'></span>

<h3>Description</h3>

<p>Permutation test: statistical significance of local and
global association measures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permtest(x, nb = 1000L, group = as.list(colnames(x$data$pp)), p_adjust = "BH")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permtest_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+lassie">lassie</a></code> S3 object.</p>
</td></tr>
<tr><td><code id="permtest_+3A_nb">nb</code></td>
<td>
<p>number of resampling iterations.</p>
</td></tr>
<tr><td><code id="permtest_+3A_group">group</code></td>
<td>
<p>list of column names specifying which columns
should be permuted together. This is useful for the multivariate case,
for example, when there is many dependent variables and one
independent variable. By default, permutes all columns separately.</p>
</td></tr>
<tr><td><code id="permtest_+3A_p_adjust">p_adjust</code></td>
<td>
<p>multiple testing correction method.
(see <code><a href="stats.html#topic+p.adjust.methods">p.adjust.methods</a></code> for a list of methods).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>permtest</code> returns an S3 object of <a href="base.html#topic+class">class</a>
<code><a href="#topic+lassie">lassie</a></code> and <code><a href="#topic+permtest">permtest</a></code>.
Adds the following to the lassie object <code>x</code>:
</p>

<ul>
<li><p> global_p: global association p-value.
</p>
</li>
<li><p> local_p: array of local association p-values.
</p>
</li>
<li><p> global_perm: numeric global association values obtained with permutations.
</p>
</li>
<li><p> local_perm: matrix local association values obtained with permutations. Column number correspond to positions in local association array after converting to numeric (e.g. local_perm[, 1] corresponds to local[1]).
</p>
</li>
<li><p> perm_params: parameters used when calling permtest (nb and p_adjust).
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+lassie">lassie</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Calling lassie on cars dataset
las &lt;- lassie(cars, continuous = colnames(cars))

# Permutation test using default settings
permtest(las, nb = 30) # keep resampling low for example

</code></pre>

<hr>
<h2 id='plot.lassie'>Plot a lassie object</h2><span id='topic+plot.lassie'></span>

<h3>Description</h3>

<p>Plots a <code><a href="#topic+lassie">lassie</a></code> object as a tile plot using
the ggplot2 package. Only available for bivariate association.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lassie'
plot(
  x,
  what_x = "local",
  digits = 3,
  low = "royalblue",
  mid = "gainsboro",
  high = "firebrick",
  na = "purple",
  text_colour = "black",
  text_size,
  limits,
  midpoint,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.lassie_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+lassie">lassie</a></code> S3 object.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_what_x">what_x</code></td>
<td>
<p>vector specifying values to be returned:
</p>

<ul>
<li><p> 'local': local association measure values (default).
</p>
</li>
<li><p> 'obs': observed probabilities.
</p>
</li>
<li><p> 'exp': expected probabilities.
</p>
</li>
<li><p> 'local_p': p-value of local association (after running <code><a href="#topic+permtest">permtest</a></code> or <code><a href="#topic+chisqtest">chisqtest</a></code>).
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.lassie_+3A_digits">digits</code></td>
<td>
<p>integer indicating the number of decimal places.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_low">low</code></td>
<td>
<p>colour for low end of the gradient.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_mid">mid</code></td>
<td>
<p>colour for midpoint of the gradient.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_high">high</code></td>
<td>
<p>colour for high end of the gradient.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_na">na</code></td>
<td>
<p>colour for NA values.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_text_colour">text_colour</code></td>
<td>
<p>colour of text inside cells.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_text_size">text_size</code></td>
<td>
<p>integer indicating text size inside cells.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_limits">limits</code></td>
<td>
<p>limits of gradient.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_midpoint">midpoint</code></td>
<td>
<p>midpoint of gradient.</p>
</td></tr>
<tr><td><code id="plot.lassie_+3A_...">...</code></td>
<td>
<p>other arguments passed on to methods. Not currently used.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+lassie">lassie</a></code>
</p>

<hr>
<h2 id='preprocess'>Preprocess data</h2><span id='topic+preprocess'></span>

<h3>Description</h3>

<p>Subroutine called by <code><a href="#topic+lassie">lassie</a></code>. Discretizes, subsets and remove missing data from a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocess(x, select, continuous, breaks, default_breaks = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="preprocess_+3A_x">x</code></td>
<td>
<p>data.frame or matrix.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_select">select</code></td>
<td>
<p>optional vector of column numbers or column names
specifying a subset of data to be used. By default, uses all columns.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_continuous">continuous</code></td>
<td>
<p>optional vector of column numbers or column names specifying
continuous variables that should be discretized.
By default, assumes that every variable is categorical.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_breaks">breaks</code></td>
<td>
<p>numeric vector or list passed on to <code><a href="base.html#topic+cut">cut</a></code> to discretize
continuous variables. When a numeric vector is specified, break points are
applied to all continuous variables. In order to specify variable-specific
breaks, lists are used. List names identify variables and list values identify
breaks. List names are column names (not numbers). If a continuous
variable has no specified breaks, then <code>default_breaks</code> will be applied.</p>
</td></tr>
<tr><td><code id="preprocess_+3A_default_breaks">default_breaks</code></td>
<td>
<p>default break points for discretizations.
Same syntax as in <code><a href="base.html#topic+cut">cut</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the following values:
</p>

<ul>
<li><p> raw: raw subsetted data.frame
</p>
</li>
<li><p> pp: discretized, subsetted and complete data.frame
</p>
</li>
<li><p> select
</p>
</li>
<li><p> continuous
</p>
</li>
<li><p> breaks
</p>
</li>
<li><p> default_breaks
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># This is what happens behind the curtains in the 'lassie' function
# Here we compute the association between the 'Girth' and 'Height' variables
# of the 'trees' dataset

# 'select' and 'continuous' take column numbers or names
select &lt;- c('Girth', 'Height') # select subset of trees
continuous &lt;-c(1, 2) # both 'Girth' and 'Height' are continuous

# equal-width discretization with 3 bins
breaks &lt;- 3

# Preprocess data: subset, discretize and remove missing data
pre &lt;- preprocess(trees, select, continuous, breaks)

# Estimates marginal and multivariate probabilities from preprocessed data.frame
prob &lt;- estimate_prob(pre$pp)

# Computes local and global association using Ducher's Z
lam &lt;- local_association(prob, measure = 'z')
</code></pre>

<hr>
<h2 id='print.lassie'>Print a lassie object</h2><span id='topic+print.lassie'></span>

<h3>Description</h3>

<p>Print a <code><a href="#topic+lassie">lassie</a></code> object as an array or a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lassie'
print(x, type, what_x, range, what_range, what_sort, decreasing, na.rm, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.lassie_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+lassie">lassie</a></code> S3 object.</p>
</td></tr>
<tr><td><code id="print.lassie_+3A_type">type</code></td>
<td>
<p>print style: 'array' for array or 'df' for data.frame.</p>
</td></tr>
<tr><td><code id="print.lassie_+3A_what_x">what_x</code></td>
<td>
<p>vector specifying values to be returned:
</p>

<ul>
<li><p> 'local': local association measure values (default).
</p>
</li>
<li><p> 'obs': observed probabilities.
</p>
</li>
<li><p> 'exp': expected probabilities.
</p>
</li>
<li><p> 'local_p': p-value of local association (after running <code><a href="#topic+permtest">permtest</a></code> or <code><a href="#topic+chisqtest">chisqtest</a></code>).
</p>
</li></ul>
</td></tr>
<tr><td><code id="print.lassie_+3A_range">range</code></td>
<td>
<p>range of values to be retained (vector of two numeric values).</p>
</td></tr>
<tr><td><code id="print.lassie_+3A_what_range">what_range</code></td>
<td>
<p>character specifying what value <code>range</code> refers to
(same options as <code>what_x</code>).
By default, takes the first value in <code>what_x</code>.</p>
</td></tr>
<tr><td><code id="print.lassie_+3A_what_sort">what_sort</code></td>
<td>
<p>character specifying according to which values should <code>x</code> be sorted
(same options as <code>what_x</code>).
By default, takes the first value in <code>what_x</code>.</p>
</td></tr>
<tr><td><code id="print.lassie_+3A_decreasing">decreasing</code></td>
<td>
<p>logical value specifying sort order.</p>
</td></tr>
<tr><td><code id="print.lassie_+3A_na.rm">na.rm</code></td>
<td>
<p>logical value indicating whether NA values should be stripped.</p>
</td></tr>
<tr><td><code id="print.lassie_+3A_...">...</code></td>
<td>
<p>other arguments passed on to methods. Not currently used.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+lassie">lassie</a></code>, <code><a href="#topic+permtest">permtest</a></code>, <code><a href="#topic+chisqtest">chisqtest</a></code>
</p>

<hr>
<h2 id='write.lassie'>Write a lassie object</h2><span id='topic+write.lassie'></span>

<h3>Description</h3>

<p>Writes <code><a href="#topic+lassie">lassie</a></code> object to a file in a table structured format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.lassie(
  x,
  file,
  sep = ",",
  dec = ".",
  col.names = TRUE,
  row.names = FALSE,
  quote = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write.lassie_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+lassie">lassie</a></code> S3 object.</p>
</td></tr>
<tr><td><code id="write.lassie_+3A_file">file</code></td>
<td>
<p>character string naming a file.</p>
</td></tr>
<tr><td><code id="write.lassie_+3A_sep">sep</code></td>
<td>
<p>the field separator string.  Values within each row of
<code>x</code> are separated by this string.</p>
</td></tr>
<tr><td><code id="write.lassie_+3A_dec">dec</code></td>
<td>
<p>the string to use for decimal points in numeric or complex
columns: must be a single character.</p>
</td></tr>
<tr><td><code id="write.lassie_+3A_col.names">col.names</code></td>
<td>
<p>either a logical value indicating whether the column
names of <code>x</code> are to be written along with <code>x</code>, or a
character vector of column names to be written.  See the section on
&lsquo;CSV files&rsquo; for the meaning of <code>col.names = NA</code>.</p>
</td></tr>
<tr><td><code id="write.lassie_+3A_row.names">row.names</code></td>
<td>
<p>either a logical value indicating whether the row
names of <code>x</code> are to be written along with <code>x</code>, or a
character vector of row names to be written.</p>
</td></tr>
<tr><td><code id="write.lassie_+3A_quote">quote</code></td>
<td>
<p>a logical value (<code>TRUE</code> or <code>FALSE</code>) or a
numeric vector.  If <code>TRUE</code>, any character or factor columns
will be surrounded by double quotes.  If a numeric vector, its
elements are taken as the indices of columns to quote.  In both
cases, row and column names are quoted if they are written.  If
<code>FALSE</code>, nothing is quoted.</p>
</td></tr>
<tr><td><code id="write.lassie_+3A_...">...</code></td>
<td>
<p>other arguments passed on to write.table.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+lassie">lassie</a></code>, <code><a href="#topic+permtest">permtest</a></code>, <code><a href="#topic+chisqtest">chisqtest</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
