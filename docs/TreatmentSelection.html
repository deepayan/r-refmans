<!DOCTYPE html><html lang="en"><head><title>Help for package TreatmentSelection</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TreatmentSelection}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#TreatmentSelection-package'><p>Evaluate markers used to guide patient treatment selection decisions</p></a></li>
<li><a href='#calibrate'><p>method for calibrating trtsel objects</p></a></li>
<li><a href='#calibrate.trtsel'><p>assess model calibration of a trtsel object</p></a></li>
<li><a href='#compare'><p>method to compare trtsel objects</p></a></li>
<li><a href='#compare.trtsel'><p>compare the performance of two treatment selection markers</p></a></li>
<li><a href='#evaluate'><p>a method for evaluating a trtsel object</p></a></li>
<li><a href='#evaluate.trtsel'><p>evaluate the performance of one or more biomarkers for their ability to guide patient treatment recommendations.</p></a></li>
<li><a href='#is.trtsel'><p>is x a trtsel object?</p></a></li>
<li><a href='#plot.trtsel'><p>plot risk curves, treatment effect curves or cdf of risk for a trtsel</p>
object.</a></li>
<li><a href='#print.calibrate.trtsel'><p>print a trtsel object</p></a></li>
<li><a href='#print.compare.trtsel'><p>print a trtsel object</p></a></li>
<li><a href='#print.eval.trtsel'><p>print a trtsel object</p></a></li>
<li><a href='#print.trtsel'><p>print a trtsel object</p></a></li>
<li><a href='#print.trtsel_summary_measures'><p>print output from 'trtsel_measures'</p></a></li>
<li><a href='#surv_tsdata'>
<p>sample data for R package TreatmentSelection</p></a></li>
<li><a href='#trtsel'><p>create a trtsel object</p></a></li>
<li><a href='#trtsel_measures'><p>a simple function to estimate performance measures for a  rule used to select treatment.</p></a></li>
<li><a href='#tsdata'>
<p>sample data for R package TreatmentSelection</p></a></li>
<li><a href='#tsdata_cc'>
<p>sample nested case-control data for R package TreatmentSelection</p></a></li>
<li><a href='#tsdata_scc'>
<p>sample stratified nested case-control data for R package TreatmentSelection</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Evaluate Treatment Selection Biomarkers</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-8-11</td>
</tr>
<tr>
<td>Author:</td>
<td>Marshall Brown and Holly Janes</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marshall Brown &lt;mdbrown@fhcrc.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A suite of descriptive and inferential methods designed to evaluate one or more biomarkers for their ability to guide patient treatment recommendations.  Package includes functions to assess the calibration of risk models; and plot, evaluate, and compare markers. Please see the reference Janes H, Brown MD, Huang Y, et al. (2014) &lt;<a href="https://doi.org/10.1515%2Fijb-2012-0052">doi:10.1515/ijb-2012-0052</a>&gt; for further details. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://rpubs.com/mdbrown/TreatmentSelection">http://rpubs.com/mdbrown/TreatmentSelection</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, survival, binom, grid</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-08-11 18:46:16 UTC; mdbrown</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-08-11 18:55:47 UTC</td>
</tr>
</table>
<hr>
<h2 id='TreatmentSelection-package'>Evaluate markers used to guide patient treatment selection decisions</h2><span id='topic+TreatmentSelection-package'></span><span id='topic+TreatmentSelection'></span>

<h3>Description</h3>

<p>A suite of descriptive and inferential methods designed to evaluate
one or more biomarkers for their ability to guide patient treatment 
recommendations.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> TreatmentSelection</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0.-</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2016-07-28</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Marshall Brown and Holly Janes
</p>
<p>Maintainer: Marshall Brown &lt;mdbrown@fhcrc.org&gt;
</p>


<h3>References</h3>

<p>Janes H, Brown MD, Huang Y, et al. An approach to evaluating and comparing
biomarkers for patient treatment selection. 
**Int J Biostat.** 2014;10(1):99-121.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trtsel_measures">trtsel_measures</a></code> for evaluating the performance of a user-specified marker-based treatment rule,
<code><a href="#topic+trtsel">trtsel</a></code> for creating trtsel objects,
<code><a href="#topic+plot.trtsel">plot.trtsel</a></code> for plotting risk curves and more,
<code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code> for evaluating marker performance,
<code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code> for assessing model calibration, and
<code><a href="#topic+compare.trtsel">compare.trtsel</a></code> to compare two trtsel object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See individual function man pages for examples. 

?trtsel_measures
?trtsel
?plot.trtsel
?evaluate.trtsel
?compare.trtsel
?calibrate.trtsel

</code></pre>

<hr>
<h2 id='calibrate'>method for calibrating trtsel objects</h2><span id='topic+calibrate'></span>

<h3>Description</h3>

<p>method for calibrating trtsel objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibrate_+3A_x">x</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="calibrate_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code>
</p>

<hr>
<h2 id='calibrate.trtsel'>assess model calibration of a trtsel object</h2><span id='topic+calibrate.trtsel'></span>

<h3>Description</h3>

<p>Assess calibration of fitted models for risk and treatment effect given
marker.  Plots are used to compare observed vs. fitted risks and treatment
effects and Hosmer-Lemeshow goodness-of-fit tests are reported.  An object
of class &quot;trtsel&quot; must first be created using the function &quot;trtsel&quot; by
supplying a data.frame containing marker, treatment, and event status
information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'trtsel'
calibrate(x, ..., groups = 10, plot.type = "calibration",
  trt.names = c("Treatment", "No Treatment"), line.color = "black",
  point.color = "grey10", ci = 0.95, main = NULL, ylim = NULL,
  xlim = NULL, ylab = NULL, xlab = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibrate.trtsel_+3A_x">x</code></td>
<td>
<p>An object of class &quot;trtsel&quot;, created by using the function
&quot;trtsel.&quot;</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_groups">groups</code></td>
<td>
<p>Number of groups; observations are split into groups based on
quantiles of predicted risk or treatment effect, depending on plot.type. For
plot.type = &quot;treatment effect&quot;, observations are split into groups based on
quantile of predicted treatment effect; for plot.type= &quot;calibration&quot;,
&quot;risk.t0&quot;, or &quot;risk.t1&quot;, and for the Hosmer-Lemshow test statistic,
observations on each treatment are split into groups based on quantile of
predicted risk.  The default value is 10.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_plot.type">plot.type</code></td>
<td>
<p>Which type of plot to produce. Options are &quot;calibration&quot;
(default), which plots average predicted vs. observed risks on a log scale;
&quot;risk.t1&quot; and &quot;risk.t0&quot; which overlays observed risks on fitted risk curves
for T = 1 and T = 0 subjects, respectively; and &quot;treatment effect&quot; which
overlays observed treatment effects on the fitted treatment effect curve.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_trt.names">trt.names</code></td>
<td>
<p>A vector of length 2 indicating the names for the two
treatment options, T= 1 and T = 0, respectively, for the plot legend. This
option is only used when plot.type=&quot;calibration&quot;. The default value is
c(&quot;Treatment&quot;, &quot;No Treatment&quot;).</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_line.color">line.color</code></td>
<td>
<p>color for lines in calibration plots.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_point.color">point.color</code></td>
<td>
<p>color for points in calibration plots.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_ci">ci</code></td>
<td>
<p>numeric value (default 0.95) specifying the level for confidence intervals.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_main">main</code></td>
<td>
<p>The main title for the plot.  Only applies if plot.type is
specified.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_ylim">ylim</code></td>
<td>
<p>The limits for the y-axis of the plot, in the form
c(lower,upper). Only applies if plot.type is specified.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_xlim">xlim</code></td>
<td>
<p>The limits for the x-axisof the plot, in the form
c(lower,upper). Only applies if plot.type is specified.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_ylab">ylab</code></td>
<td>
<p>A label for the y-axis. Default values depend on plot.type.
Only applies if plot.type is specified.</p>
</td></tr>
<tr><td><code id="calibrate.trtsel_+3A_xlab">xlab</code></td>
<td>
<p>A label for the x-axis. Default values depend on plot.type. Only
applies if plot.type is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table role = "presentation">
<tr><td><code>HL.TestStat</code></td>
<td>
<p>Hosmer-Lemeshow test statistic for assessing fit of the
risk models for the T = 0 and T = 1 groups.</p>
</td></tr> <tr><td><code>p.value</code></td>
<td>
<p>P-values for the
Hosmer-Lemeshow tests in each treatment group.</p>
</td></tr> <tr><td><code>Df</code></td>
<td>
<p>Degrees of freedom
for the chi-square distribution used to generate a p-value for the
Hosmer-Lemeshow chi-square test. This equals &quot;groups&quot; - 2. </p>
</td></tr> <tr><td><code>plot</code></td>
<td>
<p>If
plot output was created, the ggplot plotting object.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+trtsel">trtsel</a></code> for creating trtsel objects,
<code><a href="#topic+plot.trtsel">plot.trtsel</a></code> for plotting risk curves and more,
<code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code> for evaluating marker performance, and
<code><a href="#topic+compare.trtsel">compare.trtsel</a></code> to compare two trtsel object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(tsdata)

###########################
## Create trtsel objects 
###########################
trtsel.Y1 &lt;- trtsel(event ~ Y1*trt, 
                   treatment.name = "trt", 
                   data = tsdata, 
                   study.design = "RCT",
                   default.trt = "trt all")

trtsel.Y1

##############################
## Assess model calibration
##############################

 
cali.Y1 &lt;- calibrate(trtsel.Y1, plot.type = "calibration")
cali.Y1

# A "treatment effect" plot 
calibrate(trtsel.Y1, line.color = "coral", plot.type = "treatment effect")


</code></pre>

<hr>
<h2 id='compare'>method to compare trtsel objects</h2><span id='topic+compare'></span>

<h3>Description</h3>

<p>method to compare trtsel objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_+3A_x">x</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="compare_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>

<hr>
<h2 id='compare.trtsel'>compare the performance of two treatment selection markers</h2><span id='topic+compare.trtsel'></span>

<h3>Description</h3>

<p>Evaluates and compares the performance of two treatment selection markers
measured in the same data.  (Bias-corrected) summary measures for the performance of each
marker are estimated and confidence intervals are provided.  Differences in
measures of performance between markers are estimated along with confidence
intervals, and the results of tests comparing marker performance measures
are returned.  &quot;Treatment effect curves&quot; for each marker are overlaid on the
same plot.  An object of class 'trtsel' must first be created for each
marker using the function 'trtsel' by supplying a data.frame containing
marker, treatment, and event status information; treatment and event data
must be identical for the two markers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'trtsel'
compare(x, ..., x2, bootstraps = 500, bias.correct = TRUE,
  alpha = 0.05, plot = TRUE, ci = "horizontal", fixed.values = NULL,
  offset = 0.01, conf.bands = TRUE, conf.bandsN = 100,
  model.names = c("Model 1", "Model 2"), xlab = NULL, ylab = NULL,
  xlim = NULL, ylim = NULL, main = NULL, annotate.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare.trtsel_+3A_x">x</code></td>
<td>
<p>An object of class &quot;trtsel&quot; created by using function
&quot;trtsel&quot;. This is created using data for the first marker.  Note: event and
treatment vectors provided to create this trtsel object must be identical to
those used to create the x2 object.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_x2">x2</code></td>
<td>
<p>An object of class &quot;trtsel&quot; created by using function
&quot;trtsel&quot;. This is created using data for the second marker.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_bootstraps">bootstraps</code></td>
<td>
<p>Number of bootstrap replicates for creating confidence
intervals and bands. Default value is 500. Set bootstraps=0 if no confidence
intervals or bands are desired.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_bias.correct">bias.correct</code></td>
<td>
<p>logical indicator of whether to bias-correct measures for over-optimism using bootstrap-bias correction. When the same data is used to fit and evaluate the model, performance measures are over-optimistic. Setting this equal to TRUE uses a bootstrap method to bias-correct performance measures.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_alpha">alpha</code></td>
<td>
<p>(1-alpha)*100% confidence intervals are calculated. Default
value is alpha = 0.05 which yields 95% CI's.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_plot">plot</code></td>
<td>
<p>Indication of whether a plot showing treatment effect curves for
the two markers should be created.  TRUE (default) or FALSE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_ci">ci</code></td>
<td>
<p>If plot = TRUE, indication of whether horizontal or vertical
confidence intervals be plotted.  Character string of either &quot;horizontal&quot;
(default) or &quot;vertical.&quot; Only applies if plot = TRUE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_fixed.values">fixed.values</code></td>
<td>
<p>A numeric vector indicating fixed values on the x- or
y-axes at which bootstrap confidence intervals are provided. If
&quot;fixed.values&quot; are provided, point-wise confidence intervals will be printed
(i.e. conf.bands will be taken as FALSE).  This option applies to the plot
only.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_offset">offset</code></td>
<td>
<p>If confidence intervals are to be plotted for specified
fixed.values, offset is the amount of distance to offset confidence
intervals so that they do not overlap on the plot. The default value is
0.01. Only applies if plot = TRUE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_conf.bands">conf.bands</code></td>
<td>
<p>Indication of whether pointwise confidence intervals are
shown for the curve(s).  TRUE (default) or FALSE. If &quot;fixed.values&quot; are
input, this option is ignored and no confidence bands are produced. Only
applies if plot = TRUE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_conf.bandsn">conf.bandsN</code></td>
<td>
<p>If conf.bands = TRUE, the number of points along the x-
or y-axis at which to calculate the pointwise confidence intervals. The
default is 100. Only applies if plot = TRUE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_model.names">model.names</code></td>
<td>
<p>A vector of length 2 indicating the names for the two
markers in x, and x2, respectively, for the plot legend. The default value is c(&quot;Model 1&quot;,
&quot;Model 2&quot;).</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_xlab">xlab</code></td>
<td>
<p>A label for the x-axis. Default values depend on plot.type. Only
applies if plot = TRUE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_ylab">ylab</code></td>
<td>
<p>A label for the y-axis. Default values depend on plot.type. Only
applies if plot = TRUE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_xlim">xlim</code></td>
<td>
<p>The limits for the x-axisof the plot, in the form c(x1,x2). Only
applies if plot = TRUE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_ylim">ylim</code></td>
<td>
<p>The limits for the y-axis of the plot, in the form c(y1,y2).
Only applies if plot = TRUE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_main">main</code></td>
<td>
<p>The main title for the plot. Only applies if plot = TRUE.</p>
</td></tr>
<tr><td><code id="compare.trtsel_+3A_annotate.plot">annotate.plot</code></td>
<td>
<p>Only applies to comparison of two discrete markers.
Should the plot be annotated with the marker group percentages? default is
TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components (see Janes et al. (2013) for a description of
the summary measures and estimators):
</p>
<table role = "presentation">
<tr><td><code>estimates.marker1</code></td>
<td>
<p> Point estimates of the summary measures: p.neg,
p.pos, B.neg, B.pos, Theta, Var.Delta, TG and event rates for marker 1. </p>
</td></tr>
<tr><td><code>estimates.marker2</code></td>
<td>
<p> Point estimates for the same summary measures for
marker 2.</p>
</td></tr> <tr><td><code>estimates.diff</code></td>
<td>
<p> Estimated difference in summary measures
(marker 1 - marker 2).</p>
</td></tr> <tr><td><code>ci.marker1</code></td>
<td>
<p> 2x9 data.frame with confidence
intervals for marker 1 performance measures.</p>
</td></tr> <tr><td><code>ci.marker2</code></td>
<td>
<p> 2x9
data.frame with confidence intervals for marker 2 performance measures.</p>
</td></tr>
<tr><td><code>ci.diff</code></td>
<td>
<p> 2x9 data.frame with confidence intervals for differences in
performance measures.</p>
</td></tr> <tr><td><code>p.values</code></td>
<td>
<p>1x9 data.frame with p-values for each
difference corresponding to a test of H0: marker 1 performance = marker 2
performance.</p>
</td></tr> <tr><td><code>bootstraps</code></td>
<td>
<p> bootstraps value provided.</p>
</td></tr>
</table>
<p>In addition, if plot = TRUE: </p>
<table role = "presentation">
<tr><td><code>plot</code></td>
<td>
<p> ggplot object containing the
generated plot.</p>
</td></tr> <tr><td><code>plot.ci.marker1</code></td>
<td>
<p> A data.frame containing the bounds
of the bootstrap-based confidence intervals for marker1, along with the
fixed.values they are centered around, where applicable. </p>
</td></tr>
<tr><td><code>plot.ci.marker2</code></td>
<td>
<p> a data.frame containing the bounds of the
bootstrap-based confidence intervals for marker 2, along with the
fixed.values they are centered around, where applicable. </p>
</td></tr>
</table>


<h3>Note</h3>

<p>Plot output is only produced when comparing a continuous (discrete)
marker to a continuous (discrete) marker because confidence bands are
calculated differently for continuous vs. discrete markers. See the note
under ?plot.trtsel, for a description of the differences between how the
bootstrap confidence bands are calculated.
</p>


<h3>References</h3>

<p>Janes, Holly; Brown, Marshall D; Pepe, Margaret; Huang, Ying; &quot;An Approach
to Evaluating and Comparing Biomarkers for Patient Treatment Selection&quot; The
International Journal of Biostatistics. Volume 0, Issue 0, ISSN (Online)
1557-4679, ISSN (Print) 2194-573X, DOI: 10.1515/ijb-2012-0052, April 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trtsel">trtsel</a></code> for creating trtsel objects,
<code><a href="#topic+plot.trtsel">plot.trtsel</a></code> for plotting risk curves and more,
<code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code> for evaluating marker performance, and
<code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code> for assessing model calibration..
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(tsdata)

###########################
## Create trtsel objects 
###########################

trtsel.Y1 &lt;- trtsel(event ~ Y1*trt, 
                   treatment.name = "trt", 
                   data = tsdata, 
                   study.design = "RCT",
                   default.trt = "trt all")

trtsel.Y1

trtsel.Y2 &lt;- trtsel(event ~ Y2*trt, 
                   treatment.name = "trt", 
                   data = tsdata, 
                   default.trt = "trt all")
trtsel.Y2
                          

###############################
## Compare marker performance
###############################


# Plot treatment effect curves with pointwise confidence intervals
## use more bootstraps in practice
compare(x = trtsel.Y1, x2 = trtsel.Y2,
                                bootstraps = 10, plot = TRUE,      
                                ci = "horizontal",  conf.bands = TRUE) 
                                

</code></pre>

<hr>
<h2 id='evaluate'>a method for evaluating a trtsel object</h2><span id='topic+evaluate'></span>

<h3>Description</h3>

<p>a method for evaluating a trtsel object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluate_+3A_x">x</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="evaluate_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code>
</p>

<hr>
<h2 id='evaluate.trtsel'>evaluate the performance of one or more biomarkers for their ability to guide patient treatment recommendations.</h2><span id='topic+evaluate.trtsel'></span>

<h3>Description</h3>

<p>Evaluates the ability of one or more biomarkers for their ability to guide patient treatment recommendations.  
(Bias-corrected) summary measures of marker performance are estimated and confidence intervals are provided.  
This function accepts as input an object of class &quot;trtsel&quot;, created using the function &quot;trtsel&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'trtsel'
evaluate(x, ..., bias.correct = TRUE, bootstraps = 1000,
  alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluate.trtsel_+3A_x">x</code></td>
<td>
<p>An object of class &quot;trtsel&quot;, created by using the function &quot;trtsel.&quot;</p>
</td></tr>
<tr><td><code id="evaluate.trtsel_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
<tr><td><code id="evaluate.trtsel_+3A_bias.correct">bias.correct</code></td>
<td>
<p>logical indicator of whether to bias-correct measures for over-optimism using bootstrap-bias correction. When the same data is used to fit and evaluate the model, performance measures are over-optimistic. Setting this equal to TRUE uses a bootstrap method to bias-correct performance measures. See details for more information.</p>
</td></tr>
<tr><td><code id="evaluate.trtsel_+3A_bootstraps">bootstraps</code></td>
<td>
<p>Number of bootstrap replicates for creating confidence intervals for each performance measure. The default value is 1000. Set bootstraps = 0 if no confidence intervals are desired.</p>
</td></tr>
<tr><td><code id="evaluate.trtsel_+3A_alpha">alpha</code></td>
<td>
<p>(1-alpha)*100% confidence intervals are calculated. Default value is alpha = 0.05 which yields 95% CI's.  The same alpha is used for the two-sided type-I error for the test of H0: No decrease in event rate under marker-based treatment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components (see Janes et al. (2013) for a description of the summary measures and estimators): 
</p>
<table role = "presentation">
<tr><td><code>test.Null</code></td>
<td>
<p> List of results of a test of the null hypothesis H0: No decrease in event rate under marker-based treatment. Contains &quot;reject&quot; (logical; was H0 rejected), p.value, z.statistic, and alpha </p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>data.frame of dimension 1x9 of summary measure estimates. Includes:
p.rec.trt : proportion recommended treatment;
p.rec.notrt : proportion recommended no treatment;
B.neg.emp, B.neg.mod: Average benefit of no treatment among those recommended no trt, empirical and model-based estimates;
B.pos.emp, B.neg.mod: Average benefit of treatment among those recommended trt, empirical and model-based estimates;
Theta.emp, Theta.mod: Decrease in rate of outcomes under marker-based treatment, empirical and model-based estimates; 
Var.Delta: variance in estimated treatment effect; 
TG: Total gain.  
ER.trt0.emp/mod, ER.trt1.emp/mod, ER.mkrbased.emp/mod: Event rates under trt = 0, trt = 1 or for marker-based treatment. 
Marker.Thresh: Marker positivity threshold&ndash; defined as the maximum marker value such that estimated treatment effect &lt; &quot;thresh&quot; (=treatment effect used to define the treatment rule, this is set when creating the trtsel object). If all observations are marker negative (or all are positive), Marker.Thresh has value NA</p>
</td></tr>
<tr><td><code>conf.intervals</code></td>
<td>
<p> data.frame of dimension 2x9 with bootstrap-based confidence intervals for each summary measures. If bootstraps = 0 or boot = FALSE, this component is NULL. </p>
</td></tr>
</table>


<h3>Note</h3>

<p>The evaluate function used this way both fit and evaluates a risk model using the same data, which is known to bias performance measure estimates to be overly optimistic. To correct for this bias, the evaluate function by default sets bias.correct=TRUE. This implements bootstrap bias correction via the &ldquo;refined bootstrap&quot; method described in Efron and Tibshirani 1994. In short, we sample BB bootstrap datasets. For each, obtain a new treatment selection rule based on the re-fit model and calculate the difference in estimated performance of this rule using the bootstrap vs. original data. The average of these differences estimates the bias. We shift naive performance estimates and confidence intervals down by the estimated bias.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trtsel">trtsel</a></code> for creating trtsel objects, <code><a href="#topic+plot.trtsel">plot.trtsel</a></code> for plotting risk curves and more, <code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code> for assessing model calibration, and <code><a href="#topic+compare.trtsel">compare.trtsel</a></code> to compare two trtsel object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tsdata)

###########################
## Create trtsel objects 
###########################

trtsel.Y1 &lt;- trtsel(event ~ Y1*trt, 
                   treatment.name = "trt", 
                   data = tsdata, 
                   study.design = "RCT",
                   family = binomial(link = "logit"), 
                   default.trt = "trt all")
trtsel.Y1

#################################
## Evaluate marker performance
#################################

# Marker Y1
estimates.Y1 &lt;- evaluate(trtsel.Y1, bootstraps = 50)
estimates.Y1

</code></pre>

<hr>
<h2 id='is.trtsel'>is x a trtsel object?</h2><span id='topic+is.trtsel'></span>

<h3>Description</h3>

<p>Function to check if an object is of class &quot;trtsel&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.trtsel(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.trtsel_+3A_x">x</code></td>
<td>
<p>Any R object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns TRUE or FALSE depending on whether x is a &quot;trtsel&quot; object or
not.
</p>

<hr>
<h2 id='plot.trtsel'>plot risk curves, treatment effect curves or cdf of risk for a trtsel
object.</h2><span id='topic+plot.trtsel'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>Plots a treatment selection marker.  Estimated &quot;risk curves&quot; and &quot;treatment
effect curves&quot; are plotted.  An object of class &quot;trtsel&quot; must first be
created using the function &quot;trtsel&quot; by supplying a data.frame containing
marker, treatment, and event status information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'trtsel'
plot(x, bootstraps = 500, plot.type = c("treatment effect",
  "risk", "cdf", "selection impact"), ci = c("default", "horizontal",
  "vertical", "none"), alpha = 0.05, fixed.values = NULL, offset = 0.01,
  conf.bands = TRUE, conf.bandsN = 100, trt.names = c("Treatment",
  "    No \nTreatment"), xlab = NULL, ylab = NULL, xlim = NULL,
  ylim = NULL, main = NULL, show.marker.axis = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.trtsel_+3A_x">x</code></td>
<td>
<p>An object of class &quot;trtsel&quot;, created by using the function
&quot;trtsel.&quot;</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_bootstraps">bootstraps</code></td>
<td>
<p>Number of bootstrap replicates for creating confidence
intervals and bands. Default value is 500. Set bootstraps=0 if no confidence
intervals or bands are desired.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_plot.type">plot.type</code></td>
<td>
<p>Type of plot to produce. Options are &quot;risk&quot; (default) for
risk curves which show risk of adverse event as a function of marker and
treatment, &quot;treatment effect&quot; for the treatment effect curve which shows the
difference in marker-specific risk of adverse event with vs. without
treatment, &quot;cdf&quot; for the cumulative distribution function of the treatment
effect, or &quot;selection impact&quot; to show a plot of the estimated event rate if
different proportions of the population are treated.  Cdf plots cannot be
generated for a discrete marker.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_ci">ci</code></td>
<td>
<p>Indication of whether horizontal or vertical confidence intervals
are desired. Character string of either &quot;horizontal&quot; (default) or
&quot;vertical.&quot; For a discrete marker only vertical confidence bands can be
produced. See note below for more information.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_alpha">alpha</code></td>
<td>
<p>(1-alpha)*100% confidence intervals are calculated. Default
value is alpha = 0.05 which yields 95% CI's.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_fixed.values">fixed.values</code></td>
<td>
<p>A numeric vector indicating fixed values on the x- or
y-axes at which bootstrap confidence intervals are provided. If
&quot;fixed.values&quot; are provided, point-wise confidence intervals will be printed
(i.e. conf.bands will be taken as FALSE). Only applies to a continuous
marker.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_offset">offset</code></td>
<td>
<p>If confidence intervals are to be plotted for specified
fixed.values, offset is the amount of distance to offset confidence
intervals so that they do not overlap on the plot. The default value is
0.01.  Only applies to a continuous marker.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_conf.bands">conf.bands</code></td>
<td>
<p>Indication of whether pointwise confidence intervals are
shown for the curve(s).  TRUE (default) or FALSE. If &quot;fixed.values&quot; are
input, this option is ignored and no confidence bands are produced.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_conf.bandsn">conf.bandsN</code></td>
<td>
<p>If conf.bands = TRUE, the number of points along the x-
or y-axis at which to calculate the pointwise confidence intervals. The
default is 100.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_trt.names">trt.names</code></td>
<td>
<p>A vector of length 2 indicating the names for the two
treatment options, T= 1 and T = 0, respectively, for the plot legend. This
option is only used when plot.type=&quot;risk&quot;. The default value is
c(&quot;Treatment&quot;, &quot;No Treatment&quot;).</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_xlab">xlab</code></td>
<td>
<p>A label for the x-axis. Default values depend on plot.type.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_ylab">ylab</code></td>
<td>
<p>A label for the y-axis. Default values depend on plot.type.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_xlim">xlim</code></td>
<td>
<p>The limits for the x-axisof the plot, in the form c(x1,x2)</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_ylim">ylim</code></td>
<td>
<p>The limits for the y-axis of the plot, in the form c(y1,y2)</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_main">main</code></td>
<td>
<p>The main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_show.marker.axis">show.marker.axis</code></td>
<td>
<p>For risk curve plots with a continuous marker,
should an axis showing marker values be displayed? default is TRUE.</p>
</td></tr>
<tr><td><code id="plot.trtsel_+3A_...">...</code></td>
<td>
<p>N/A</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Generates a plot. In addition, if the function call is assigned to a
variable (as in &quot;myplot &lt;- plot(mytrtsel)&quot;), plot.trtsel returns a list
composed of: </p>
<table role = "presentation">
<tr><td><code>plot</code></td>
<td>
<p> ggplot object containing the printed plot. </p>
</td></tr>
<tr><td><code>ci.bounds</code></td>
<td>
<p> A data.frame containing the bounds of the bootstrap-based
confidence intervals, along with the fixed.values they are centered around,
if applicable. </p>
</td></tr>
</table>


<h3>Note</h3>

<p>For a discrete marker, vertical confidence intervals are generated by
fixing the marker value and generating a bootstrap distribution for risk
given marker. Bands are then generated based on the percentiles of the
empirical bootstrap distribution. For a continuous marker, vertical
confidence intervals are generated by fixing the empirical marker quantiles,
and generating the empirical distribution of risk given marker percentile.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trtsel">trtsel</a></code> for creating trtsel objects,
<code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code> for evaluating marker performance,
<code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code> for assessing model calibration, and
<code><a href="#topic+compare.trtsel">compare.trtsel</a></code> to compare two trtsel object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(tsdata)

###########################
## Create trtsel objects 
###########################

trtsel.Y1 &lt;- trtsel(event ~ Y1*trt, 
                   treatment.name = "trt", 
                   data = tsdata, 
                   study.design = "RCT",
                   default.trt = "trt all")




##########################
## Use the plot function 
##########################

# Plot risk curves
plot(trtsel.Y1, main = "Marker Y1", 
     plot.type = "risk", bootstraps = 10, #set higher in practice
     trt.names=c("trt","no trt"))
     
# Now with confidence intervals around fixed.values 
 plot(trtsel.Y1, main = "Marker Y1",
                        plot.type = "risk", ci = "horizontal", 
                        fixed.values = c(.2, .5), 
                        offset = .01, bootstraps = 10,
                        trt.names=c("trt","no trt"))
                        
# Plot treatment effect curves
#with confidence intervals around fixed.values
plot(trtsel.Y1, main = "Marker Y1", 
                       plot.type = "treatment effect",
                       ci = "vertical", conf.bands = FALSE,
                       fixed.values = c(10, 20), bootstraps = 10)

</code></pre>

<hr>
<h2 id='print.calibrate.trtsel'>print a trtsel object</h2><span id='topic+print.calibrate.trtsel'></span>

<h3>Description</h3>

<p>S3 method for class &rdquo;trtsel&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'calibrate.trtsel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.calibrate.trtsel_+3A_x">x</code></td>
<td>
<p>object of class &quot;calibrate.trtsel&quot;, output from the
calibrate.trtsel function</p>
</td></tr>
<tr><td><code id="print.calibrate.trtsel_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='print.compare.trtsel'>print a trtsel object</h2><span id='topic+print.compare.trtsel'></span>

<h3>Description</h3>

<p>S3 method for class &rdquo;trtsel&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'compare.trtsel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.compare.trtsel_+3A_x">x</code></td>
<td>
<p>object of class &quot;compare.trtsel&quot;, output from the compare.trtsel
function</p>
</td></tr>
<tr><td><code id="print.compare.trtsel_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='print.eval.trtsel'>print a trtsel object</h2><span id='topic+print.eval.trtsel'></span>

<h3>Description</h3>

<p>S3 method for class &rdquo;trtsel&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eval.trtsel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.eval.trtsel_+3A_x">x</code></td>
<td>
<p>object of class &quot;eval.trtsel&quot;, output from the eval.trtsel function</p>
</td></tr>
<tr><td><code id="print.eval.trtsel_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='print.trtsel'>print a trtsel object</h2><span id='topic+print.trtsel'></span>

<h3>Description</h3>

<p>S3 method for class &rdquo;trtsel&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'trtsel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.trtsel_+3A_x">x</code></td>
<td>
<p>object of class &quot;trtsel&quot;, which can be created using function
&quot;trtsel.&quot; See ?trtsel for more information.</p>
</td></tr>
<tr><td><code id="print.trtsel_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='print.trtsel_summary_measures'>print output from 'trtsel_measures'</h2><span id='topic+print.trtsel_summary_measures'></span>

<h3>Description</h3>

<p>S3 method for class &rdquo;trtsel_measures&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'trtsel_summary_measures'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.trtsel_summary_measures_+3A_x">x</code></td>
<td>
<p>object of class &quot;trtsel_summary_measures&quot;, output from the estimate_measures function</p>
</td></tr>
<tr><td><code id="print.trtsel_summary_measures_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>

<hr>
<h2 id='surv_tsdata'>
sample data for R package TreatmentSelection
</h2><span id='topic+surv_tsdata'></span>

<h3>Description</h3>

<p>Simulated data set consisting of two continuous markers, two discrete markers, treatment, and time-to-event status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(surv_tsdata)</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 simulated observations reflecting the following clinical context.  Marker Y  for identifying a subset of women with estrogen-receptor positive breast cancer who do not benefit from adjuvant chemotherapy over and above tamoxifen.  The clinical outcome of interest, termed &quot;event&quot;, is 5-year breast cancer recurrence or death.  Data come from a hypothetical randomized trial where subjects are randomly assigned to tamoxifen alone or tamoxifen plus chemotherapy and followed to ascertain this outcome; markers Y1 and Y2 are measured at baseline.
</p>

<dl>
<dt><code>xi</code></dt><dd><p>a numeric vector specifying follow up time for right censored data.</p>
</dd>
<dt><code>di</code></dt><dd><p>a numeric vector indicating event status  (1 for recurrence or death within 5 years, 0 for censoring)</p>
</dd>
<dt><code>Y</code></dt><dd><p>a numeric vector of marker values. </p>
</dd>
<dt><code>trt</code></dt><dd><p>a numeric vector indicating treatment status. </p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+trtsel">trtsel</a></code> for creating trtsel objects, <code><a href="#topic+plot.trtsel">plot.trtsel</a></code> for plotting risk curves and more, <code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code> for evaluating marker performance,  <code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code> for assessing model calibration, and <code><a href="#topic+compare.trtsel">compare.trtsel</a></code> to compare two trtsel object. 
</p>

<hr>
<h2 id='trtsel'>create a trtsel object</h2><span id='topic+trtsel'></span>

<h3>Description</h3>

<p>Creates an object of class &quot;trtsel&quot; given a data.frame containing marker,
treatment, and adverse event status information.  The functions &quot;plot.trtsel&quot;,
&quot;evaluate.trtsel&quot;, and &quot;calibrate.trtsel&quot; can then be used to plot risk and treatment
effect curves, estimate summary measures, and check model calibration. The
function &quot;compare.trtsel&quot; can also be used to compare two treatment selection
markers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trtsel(formula, treatment.name, data, fittedrisk.t0 = NULL,
  fittedrisk.t1 = NULL, thresh = 0, prediction.time = NULL,
  study.design = c("RCT", "nested case-control",
  "stratified nested case-control"), cohort.attributes = NULL, family,
  default.trt = c("trt all", "trt none"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trtsel_+3A_formula">formula</code></td>
<td>
<p>a 'formula' object consisting of outcome ~ markers and marker by treatment interactions for
the treatment selection model to be evaluated. The outcome can be continuous, binary or a
'Surv' object for time-to-event outcomes. Binary variable should equal 1 for cases and 0 for controls. For continuous outcomes, we assume that larger values are associated with worse outcomes.</p>
</td></tr>
<tr><td><code id="trtsel_+3A_treatment.name">treatment.name</code></td>
<td>
<p>Name of the treatment variable in data.frame &quot;data&quot;. The treatment variable must be coded 1 for
&quot;treated&quot; and 0 for &quot;un-treated.&quot;</p>
</td></tr>
<tr><td><code id="trtsel_+3A_data">data</code></td>
<td>
<p>data.frame object used to fit and evaluate the model.</p>
</td></tr>
<tr><td><code id="trtsel_+3A_fittedrisk.t0">fittedrisk.t0</code></td>
<td>
<p>Instead of providing a marker, fitted risks for T=0 and
T=1 may be provided. This should be the column name of the fitted risk for
T=0 that can be found in 'data'. If fitted risks are provided, a model will
not be fit, and all bootstrap confidence intervals will be conditional on
the model fit provided.</p>
</td></tr>
<tr><td><code id="trtsel_+3A_fittedrisk.t1">fittedrisk.t1</code></td>
<td>
<p>Name of for the fitted risks given treatment = 1.</p>
</td></tr>
<tr><td><code id="trtsel_+3A_thresh">thresh</code></td>
<td>
<p>The treatment effect threshold used to define the treatment
rule: Do not treat if the marker-specific treatment effect is less than
&quot;thresh&quot;. This is a numeric constant with a default value of 0.</p>
</td></tr>
<tr><td><code id="trtsel_+3A_prediction.time">prediction.time</code></td>
<td>
<p>a landmark prediction time used only when the outcome is a time-to-event Surv object</p>
</td></tr>
<tr><td><code id="trtsel_+3A_study.design">study.design</code></td>
<td>
<p>Character string indicating the study design used to
collect the data. The three options are &quot;RCT&quot; (default),
&quot;nested case-control&quot;, or &quot;stratified nested case-control&quot;.  A &quot;RCT&quot; design is simply a randomized trial comparing T = 0 to T = 1 with
the marker measured at baseline.  A nested case-control or stratified nested
case-control study samples cases and controls for marker measurement,
perhaps stratified on treatment assignment, from a randomized trial
comparing T = 0 to T = 1.  See Janes et al. (2013) for a full description of
these designs.
</p>
<p>If a &quot;nested case-control&quot; or &quot;stratified nested case-control&quot; design is
specified, &quot;cohort.attributes&quot;&quot; must be provided (see below).</p>
</td></tr>
<tr><td><code id="trtsel_+3A_cohort.attributes">cohort.attributes</code></td>
<td>
<p>If a &quot;nested case-control&quot; or &quot;stratified nested
case-control&quot; design is specified, &quot;cohort.attributes&quot; must be provided.
Order does matter.
</p>
<p>For the &quot;nested case-control&quot; design, specify the following attributes of
the randomized trial &quot;cohort&quot; from which the case-control sample was
selected: <br /> <br /> cohort.attributes = c(cohort sample size, <br /> proportion
treated in cohort (Pr(trt==1)), <br /> adverse event prevalance in cohort
(Pr(event==1)), <br /> fraction of cases sampled from cohort) <br /> <br />
</p>
<p>For the &quot;stratitified nested case-control&quot; design, specify the following
attributes of the randomized trial &quot;cohort&quot; from which the stratified
case-control sample was selected: <br /> <br /> cohort.attributes = c(cohort
sample size, <br /> Pr(trt==0 &amp; event==0) in cohort, <br /> Pr(trt==0 &amp; event==1)
in cohort, <br /> Pr(trt==1 &amp; event==0) in cohort, <br /> fraction of cases with
trt == 0 sampled from cohort, <br /> fraction of cases with trt == 1 sampled
from cohort )<br /> <br /></p>
</td></tr>
<tr><td><code id="trtsel_+3A_family">family</code></td>
<td>
<p>function passed to 'glm' describing the error distribution and link 
function to be used in the model. Defaults to binomial(link = &quot;logit&quot;) when the outcome is
numeric with two values 0,1 and gaussian(link = &quot;identity&quot;) otherwise.
Ignored for time-to-event outcomes.
For non RCT study designs, methods only exist for family = binomial(link = &quot;logit&quot;).</p>
</td></tr>
<tr><td><code id="trtsel_+3A_default.trt">default.trt</code></td>
<td>
<p>The default treatment assignment to compare with
marker-based treatment. Can either be set at &quot;trt all&quot; (default) or &quot;trt
none&quot;. Use &quot;trt all&quot; if everyone is treated and the aim is to discover those
who would benefit from no treatment, but use &quot;trt none&quot; if the common
practice is to treat no-one and the goal is to discover those who would
benefit from treatment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;trtsel,&quot; which is a list containing:
</p>
<table role = "presentation">
<tr><td><code>model.fit</code></td>
<td>
<p> A list containing &quot;coefficients&quot; &ndash; a 4 x 4 matrix with
columns for coefficient estimates, standard errors, t-statistics, and
two-sided p-values.  &quot;cohort.attributes&quot; &ndash; the vector of cohort.attributes
provided &quot;study.design&quot; &ndash; character string of study.design provided </p>
</td></tr>
<tr><td><code>derived.data</code></td>
<td>
<p> A data.frame with event, trt, and marker information along with
&quot;fittedrisk.t0&quot; (risk estimates given no treatment), &quot;fittedrisk.t1&quot; (risk
estimates given treatment), &quot;trt.effect&quot; (treatment effect estimates), and
&quot;trt.rec&quot; (indicator of trt recommendation) columns.  </p>
</td></tr>
<tr><td><code>functions</code></td>
<td>
<p> For internal package use only </p>
</td></tr>
</table>


<h3>References</h3>

<p>Janes, Holly; Brown, Marshall D; Pepe, Margaret; Huang, Ying;
&quot;An Approach to Evaluating and Comparing Biomarkers for Patient Treatment
Selection&quot; The International Journal of Biostatistics. Volume 0, Issue 0,
ISSN (Online) 1557-4679, ISSN (Print) 2194-573X, DOI: 10.1515/ijb-2012-0052,
April 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.trtsel">plot.trtsel</a></code> for plotting risk curves and more,
<code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code> for evaluating marker performance,
<code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code> for assessing model calibration, and
<code><a href="#topic+compare.trtsel">compare.trtsel</a></code> to compare two trtsel object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(tsdata)

###########################
## Create trtsel objects 
###########################

trtsel.Y1 &lt;- trtsel(event ~ Y1*trt, 
                   treatment.name = "trt", 
                   data = tsdata, 
                   study.design = "RCT",
                   family = binomial("logit"), 
                   default.trt = "trt all")

trtsel.Y1

trtsel.Y2 &lt;- trtsel(event ~ Y2*trt, 
                   treatment.name = "trt", 
                   data = tsdata, 
                   default.trt = "trt all")
trtsel.Y2


# calculate fitted risks using a logistic model 
#(one can use any model here, the point is that the fitted risks are provided )
mymod &lt;- glm(event~trt*Y2, data= tsdata, family = binomial("logit"))

tsdata$fitted.t0 &lt;- predict(mymod, newdata=data.frame(trt = 0, Y2 = tsdata$Y2), type = "response")
tsdata$fitted.t1 &lt;- predict(mymod, newdata=data.frame(trt = 1, Y2 = tsdata$Y2), type = "response")

#all bootstrapping done using this object will be conditional on the model fit. 

myfitted.trtsel &lt;- trtsel( event~trt, treatment.name = "trt", 
                           data = tsdata,
                           fittedrisk.t0 = "fitted.t0",
                           fittedrisk.t1 = "fitted.t1",
                           default.trt = "trt all")



</code></pre>

<hr>
<h2 id='trtsel_measures'>a simple function to estimate performance measures for a  rule used to select treatment.</h2><span id='topic+trtsel_measures'></span>

<h3>Description</h3>

<p>Provides point estimates for summary measures to evaluate a rule used to select treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trtsel_measures(event, trt, trt.rule, trt.effect, time,
  default.trt = c("trt all", "trt none"), prediction.time = NULL,
  silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trtsel_measures_+3A_event">event</code></td>
<td>
<p>vector for adverse event. Can be binary (1 is bad, 0 is good) or continuous (large numbers are worse). If failure time variable 'time' is set, event is used as the adverse event status indicator.</p>
</td></tr>
<tr><td><code id="trtsel_measures_+3A_trt">trt</code></td>
<td>
<p>binary trt status 1 for &quot;treated&quot; and 0 for &quot;un-treated.&quot;</p>
</td></tr>
<tr><td><code id="trtsel_measures_+3A_trt.rule">trt.rule</code></td>
<td>
<p>a binary treatment rule used to recommend treatment where 1 means recommend treatment and 0 means recommend no treatment.</p>
</td></tr>
<tr><td><code id="trtsel_measures_+3A_trt.effect">trt.effect</code></td>
<td>
<p>estimated treatment effects.</p>
</td></tr>
<tr><td><code id="trtsel_measures_+3A_time">time</code></td>
<td>
<p>the failure time for survival outcomes.</p>
</td></tr>
<tr><td><code id="trtsel_measures_+3A_default.trt">default.trt</code></td>
<td>
<p>The default treatment assignment to compare with
marker-based treatment. Can either be set at &quot;trt all&quot; (default) or &quot;trt
none&quot;. Use &quot;trt all&quot; if everyone is treated and the aim is to discover those
who would benefit from no treatment, but use &quot;trt none&quot; if the common
practice is to treat no-one and the goal is to discover those who would
benefit from treatment.</p>
</td></tr>
<tr><td><code id="trtsel_measures_+3A_prediction.time">prediction.time</code></td>
<td>
<p>a landmark prediction time used only when the 'time' variable is set.</p>
</td></tr>
<tr><td><code id="trtsel_measures_+3A_silent">silent</code></td>
<td>
<p>suppress messages</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(tsdata)
#The user must specify a vector of clinical outcomes, 
#a vector of treatment assigments, and a vector of 
#marker-based treatment recommendations based on the pre-specified rule.

#Here we let Y1_disc represent a user-specified treatment 
#rule and evaluate its performance.

trtsel_measures(event = tsdata$event, trt = tsdata$trt, trt.rule = 1- tsdata$Y1_disc )

#We can also fit our own risk model using GLM, use this model
#to develop a marker-based treatment recommendation, and evaluate its performance. 
#This allows us to obtain model-based estimates of performance:

mod &lt;- glm(event~trt*Y1_disc,  data = tsdata, family = binomial())

tsdata.0 &lt;- tsdata; 
tsdata.0$trt = 0 
tsdata.1 &lt;- tsdata;
tsdata.1$trt = 1
delta.hat &lt;- predict(mod, 
                    newdata= tsdata.0,
                    type = "response") - 
            predict(mod,
                    newdata= tsdata.1, 
                    type = "response")

trtsel_measures(event = tsdata$event, trt = tsdata$trt, 
               trt.rule = 1- tsdata$Y1_disc, trt.effect = delta.hat )

</code></pre>

<hr>
<h2 id='tsdata'>
sample data for R package TreatmentSelection
</h2><span id='topic+tsdata'></span>

<h3>Description</h3>

<p>Simulated data set consisting of two continuous markers, two discrete markers, treatment, and event status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tsdata)</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 simulated observations reflecting the following clinical context.  Markers Y1 and Y2 are candidates for identifying a subset of women with estrogen-receptor positive breast cancer who do not benefit from adjuvant chemotherapy over and above tamoxifen.  The clinical outcome of interest, termed &quot;event&quot;, is 5-year breast cancer recurrence or death.  Data come from a hypothetical randomized trial where subjects are randomly assigned to tamoxifen alone or tamoxifen plus chemotherapy and followed to ascertain this outcome; markers Y1 and Y2 are measured at baseline.
</p>

<dl>
<dt><code>trt</code></dt><dd><p>a numeric vector distinguishing chemotherapy-treated individuals (trt = 1) vs individuals treated with tamoxifen alone (trt = 0)</p>
</dd>
<dt><code>event</code></dt><dd><p>a numeric vector indicating event status  (1 for recurrence or death within 5 years, 0 otherwise)</p>
</dd>
<dt><code>Y1</code></dt><dd><p>a numeric vector of values for marker 1. This marker has relatively weak performance.</p>
</dd>
<dt><code>Y2</code></dt><dd><p>a numeric vector of values for marker 2. This marker has strong performance. </p>
</dd>
<dt><code>Y1_disc</code></dt><dd><p>a discrete version of marker 1, coded 1 if Y1 &gt; mean(Y1) and 0 otherwise. </p>
</dd>
<dt><code>Y2_disc</code></dt><dd><p>a discrete version of marker 2, coded 1 if Y2 &gt; 0, and 0 otherwise. </p>
</dd>
</dl>



<h3>References</h3>

<p>Janes, Holly; Brown, Marshall D; Pepe, Margaret; Huang, Ying; &quot;An Approach to Evaluating and Comparing Biomarkers for Patient Treatment Selection&quot; The International Journal of Biostatistics. Volume 0, Issue 0, ISSN (Online) 1557-4679, ISSN (Print) 2194-573X, DOI: 10.1515/ijb-2012-0052, April 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trtsel">trtsel</a></code> for creating trtsel objects, <code><a href="#topic+plot.trtsel">plot.trtsel</a></code> for plotting risk curves and more, <code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code> for evaluating marker performance,  <code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code> for assessing model calibration, and <code><a href="#topic+compare.trtsel">compare.trtsel</a></code> to compare two trtsel object. 
</p>

<hr>
<h2 id='tsdata_cc'>
sample nested case-control data for R package TreatmentSelection
</h2><span id='topic+tsdata_cc'></span>

<h3>Description</h3>

<p>Simulated case-cohort data set consisting of two continuous markers, two discrete markers, treatment, and event status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tsdata)</code></pre>


<h3>Format</h3>

<p>A data frame with 468 observations reflecting a 1:1 case control subcohort sample from the <code>tsdata</code> dataset. See ?tsdata for the clinical context these data were simulated under. 
</p>

<dl>
<dt><code>trt</code></dt><dd><p>a numeric vector distinguishing chemotherapy-treated individuals (trt = 1) vs individuals treated with tamoxifen alone (trt = 0)</p>
</dd>
<dt><code>event</code></dt><dd><p>a numeric vector indicating event status  (1 for recurrence or death within 5 years, 0 otherwise)</p>
</dd>
<dt><code>Y1</code></dt><dd><p>a numeric vector of values for marker 1. This marker has relatively weak performance.</p>
</dd>
<dt><code>Y2</code></dt><dd><p>a numeric vector of values for marker 2. This marker has strong performance. </p>
</dd>
<dt><code>Y1_disc</code></dt><dd><p>a discrete version of marker 1, coded 1 if Y1 &gt; mean(Y1) and 0 otherwise. </p>
</dd>
<dt><code>Y2_disc</code></dt><dd><p>a discrete version of marker 2, coded 1 if Y2 &gt; 0, and 0 otherwise. </p>
</dd>
</dl>



<h3>Note</h3>

<p>In order to evaluate the markers in this dataset, we need to provide the function <code>trtsel</code> with information from the full cohort <code>tsdata</code>. See the example below for help.  
</p>


<h3>References</h3>

<p>Janes, Holly; Brown, Marshall D; Pepe, Margaret; Huang, Ying; &quot;An Approach to Evaluating and Comparing Biomarkers for Patient Treatment Selection&quot; The International Journal of Biostatistics. Volume 0, Issue 0, ISSN (Online) 1557-4679, ISSN (Print) 2194-573X, DOI: 10.1515/ijb-2012-0052, April 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trtsel">trtsel</a></code> for creating trtsel objects, <code><a href="#topic+plot.trtsel">plot.trtsel</a></code> for plotting risk curves and more, <code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code> for evaluating marker performance,  <code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code> for assessing model calibration, and <code><a href="#topic+compare.trtsel">compare.trtsel</a></code> to compare two trtsel object. 
</p>

<hr>
<h2 id='tsdata_scc'>
sample stratified nested case-control data for R package TreatmentSelection
</h2><span id='topic+tsdata_scc'></span>

<h3>Description</h3>

<p>Simulated stratified case-control data set consisting of two continuous markers, two discrete markers, treatment, and event status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tsdata)</code></pre>


<h3>Format</h3>

<p>A data frame with 468 observations reflecting a 1:1 stratified case control subcohort sample from the <code>tsdata</code> dataset. Observations are stratified on treatment status. See ?tsdata for the clinical context these data were simulated under. 
</p>

<dl>
<dt><code>trt</code></dt><dd><p>a numeric vector distinguishing chemotherapy-treated individuals (trt = 1) vs individuals treated with tamoxifen alone (trt = 0)</p>
</dd>
<dt><code>event</code></dt><dd><p>a numeric vector indicating event status  (1 for recurrence or death within 5 years, 0 otherwise)</p>
</dd>
<dt><code>Y1</code></dt><dd><p>a numeric vector of values for marker 1. This marker has relatively weak performance.</p>
</dd>
<dt><code>Y2</code></dt><dd><p>a numeric vector of values for marker 2. This marker has strong performance. </p>
</dd>
<dt><code>Y1_disc</code></dt><dd><p>a discrete version of marker 1, coded 1 if Y1 &gt; mean(Y1) and 0 otherwise. </p>
</dd>
<dt><code>Y2_disc</code></dt><dd><p>a discrete version of marker 2, coded 1 if Y2 &gt; 0, and 0 otherwise. </p>
</dd>
</dl>



<h3>Note</h3>

<p>In order to evaluate the markers in this dataset, we need to provide the function <code>trtsel</code> with information from the full cohort <code>tsdata</code>. See the example below for help.  
</p>


<h3>References</h3>

<p>Janes, Holly; Brown, Marshall D; Pepe, Margaret; Huang, Ying; &quot;An Approach to Evaluating and Comparing Biomarkers for Patient Treatment Selection&quot; The International Journal of Biostatistics. Volume 0, Issue 0, ISSN (Online) 1557-4679, ISSN (Print) 2194-573X, DOI: 10.1515/ijb-2012-0052, April 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trtsel">trtsel</a></code> for creating trtsel objects, <code><a href="#topic+plot.trtsel">plot.trtsel</a></code> for plotting risk curves and more, <code><a href="#topic+evaluate.trtsel">evaluate.trtsel</a></code> for evaluating marker performance,  <code><a href="#topic+calibrate.trtsel">calibrate.trtsel</a></code> for assessing model calibration, and <code><a href="#topic+compare.trtsel">compare.trtsel</a></code> to compare two trtsel object. 
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
