<!DOCTYPE html><html lang="en"><head><title>Help for package DAISIEprep</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DAISIEprep}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DAISIEprep-package'><p>DAISIEprep: Extracts Phylogenetic Island Community Data from Phylogenetic Trees</p></a></li>
<li><a href='#add_asr_node_states'><p>Fits a model of ancestral state reconstruction of island presence</p></a></li>
<li><a href='#add_island_colonist'><p>Adds an island colonists (can be either a singleton lineage or an island</p>
clade) to the island community (island_tbl).</a></li>
<li><a href='#add_missing_species'><p>Adds a specified number of missing species to an existing island_tbl at the</p>
colonist specified by the species_to_add_to argument given. The species
given is located within the island_tbl data and missing species are
assigned. This is to be used after <code>extract_island_species()</code> to input
missing species.</a></li>
<li><a href='#add_multi_missing_species'><p>Calculates the number of missing species to be assigned to each island clade</p>
in the island_tbl object and assigns the missing species to them. In the case
that multiple genera are in an island clade and each have missing species
the number of missing species is summed. Currently the missing species
are assigned to the genus that first matches with the missing species table,
however a more biologically or stochastic assignment is in development.</a></li>
<li><a href='#add_outgroup'><p>Add an outgroup species to a given phylogeny.</p></a></li>
<li><a href='#all_descendants_conspecific'><p>Checks whether all species given in the descendants vector are the same</p>
species.</a></li>
<li><a href='#all_endemicity_status'><p>All possible endemicity statuses</p></a></li>
<li><a href='#any_back_colonisation'><p>Detects any cases where a non-endemic species or species not present on the</p>
island has likely been on the island given its ancestral state reconstruction
indicating ancestral presence on the island and so is likely a back
colonisation from the island to the mainland (or potentially different
island). This function is useful if using extraction_method = &quot;min&quot; in
<code>DAISIEprep::extract_island_species()</code> as it may brake up a single colonist
into multiple colonists because of back-colonisation.</a></li>
<li><a href='#any_outgroup'><p>Checks whether the phylogeny has an outgroup that is not present on the</p>
island. This is critical when extracting data from the phylogeny so the
stem age (colonisation time) is correct.</a></li>
<li><a href='#any_polyphyly'><p>Checks whether there are any species in the phylogeny that have multiple</p>
tips (i.e. multiple subspecies per species) and whether any of those tips are
paraphyletic (i.e. are their subspecies more distantly related to each other
than to other subspecies or species).</a></li>
<li><a href='#as_daisie_datatable'><p>Converts the <code>Island_tbl</code> class to a data frame in the format of a DAISIE</p>
data table (see DAISIE R package for details). This can then be input into
<code>DAISIEprep::create_daisie_data()</code> function which creates the list input into
the DAISIE ML models.</a></li>
<li><a href='#benchmark'><p>Performance analysis of the extract_island_species() function</p>
Uses system.time() for timing for reasons explained here:
https://radfordneal.wordpress.com/2014/02/02/inaccurate-results-from-microbenchmark/ # nolint</a></li>
<li><a href='#bind_colonist_to_tbl'><p>Takes an existing instance of an <code>Island_tbl</code> class and bind the information</p>
from the instance of an <code>Island_colonist</code> class to it</a></li>
<li><a href='#check_island_colonist'><p>Checks the validity of the Island_colonist class</p></a></li>
<li><a href='#check_island_tbl'><p>Checks the validity of the Island_tbl class</p></a></li>
<li><a href='#check_multi_island_tbl'><p>Checks the validity of the Multi_island_tbl class</p></a></li>
<li><a href='#check_phylo_data'><p>Checks whether <code style="white-space: pre;">&#8288;\linkS4class{phylo4d}&#8288;</code> object conforms</p>
to the requirements of the DAISIEprep package. If the function does not
return anything the data is ready to be used, if an error is returned the
data requires some pre-processing before DAISIEprep can be used</a></li>
<li><a href='#coccyzus_phylod'><p>A phylogenetic tree of coccyzus species with endemicity status as tip states.</p></a></li>
<li><a href='#columbiformes_phylod'><p>A phylogenetic tree of columbiformes species with endemicity status as</p>
tip states.</a></li>
<li><a href='#count_missing_species'><p>Reads in the checklist of all species on an island, including those that are</p>
not in the phylogeny (represented by NA) and counts the number of species
missing from the phylogeny each genus</a></li>
<li><a href='#create_daisie_data'><p>This is a wrapper function for DAISIE::DAISIE_dataprep(). It allows the</p>
final DAISIE data structure to be produced from within DAISIEprep. For
detailed documentation see the help documentation in the DAISIE package
(?DAISIE::DAISIE_dataprep).</a></li>
<li><a href='#create_endemicity_status'><p>Creates a data frame with the endemicity status (either 'endemic',</p>
'nonendemic', 'not_present') of every species in the phylogeny using a
phylogeny and a data frame of the island species and their endemicity (either
'endemic' or 'nonendemic') provided.</a></li>
<li><a href='#create_test_phylod'><p>Creates phylod objects.</p></a></li>
<li><a href='#default_params_doc'><p>Documentation for function in the DAISIEprep package</p></a></li>
<li><a href='#endemicity_to_sse_states'><p>Convert endemicity to SSE states</p></a></li>
<li><a href='#extract_asr_clade'><p>Extracts an island clade based on the ancestral state reconstruction of the</p>
species presence on the island, therefore this clade can contain
non-endemic species as well as endemic species.</a></li>
<li><a href='#extract_biogeobears_ancestral_states_probs'><p>Extract ancestral state probabilities from BioGeoBEARS output</p></a></li>
<li><a href='#extract_clade_name'><p>Creates a name for a clade depending on whether all the species of the clade</p>
have the same genus name or whether the clade is composed of multiple genera,
in which case it will create a unique clade name by concatinating the genus
names</a></li>
<li><a href='#extract_endemic_clade'><p>Extracts the information for an endemic clade (i.e. more than one species on</p>
the island more closely related to each other than other mainland species)
from a phylogeny (specifically <code>phylo4d</code>  object from <code>phylobase</code> package)
and stores it in an <code>Island_colonist</code> class</a></li>
<li><a href='#extract_endemic_singleton'><p>Extracts the information for an endemic species from a phylogeny</p>
(specifically <code>phylo4d</code>  object from <code>phylobase</code> package) and stores it in
in an <code>Island_colonist</code> class</a></li>
<li><a href='#extract_island_species'><p>Extracts the colonisation, diversification, and endemicty data from</p>
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object</a></li>
<li><a href='#extract_multi_tip_species'><p>Extracts the information for a species (endemic or non-endemic) which has</p>
multiple tips in the phylogeny (i.e. more than one sample per species) from
a phylogeny (specifically <code>phylo4d</code>  object from <code>phylobase</code> package)
and stores it in an <code>Island_colonist</code> class</a></li>
<li><a href='#extract_nonendemic'><p>Extracts the information for a non-endemic species from a phylogeny</p>
(specifically <code>phylo4d</code>  object from <code>phylobase</code> package) and stores it in
in an <code>island_colonist</code> class</a></li>
<li><a href='#extract_nonendemic_forced'><p>Extract non-endemic colonist that is forced to be a singleton by user</p></a></li>
<li><a href='#extract_species_asr'><p>Extracts the colonisation, diversification, and endemicty data from</p>
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object
using the &quot;asr&quot; algorithm that extract island species given their ancestral
states of either island presence or absence.</a></li>
<li><a href='#extract_species_min'><p>Extracts the colonisation, diversification, and endemicty data from</p>
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object
using the &quot;min&quot; algorithm that extract island species as the shortest time
to the present.</a></li>
<li><a href='#extract_stem_age'><p>Extracts the stem age from the phylogeny when the a species is known to</p>
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny. The stem age can either be for the
genus (or several genera) in the tree (<code>stem = "genus"</code>) or use an extraction
algorithm to find the stem of when the species colonised the island
(<code style="white-space: pre;">&#8288;stem = "island_presence&#8288;</code>), either 'min' or 'asr' as in
extract_island_species(). When <code>stem = "island_presence"</code>
the reconstructed node states are used
to determine the stem age.</a></li>
<li><a href='#extract_stem_age_asr'><p>Extracts the stem age from the phylogeny when the a species is known to</p>
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny using the 'asr' extraction method</a></li>
<li><a href='#extract_stem_age_genus'><p>Extracts the stem age from the phylogeny when the a species is known to</p>
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny</a></li>
<li><a href='#extract_stem_age_min'><p>Extracts the stem age from the phylogeny when the a species is known to</p>
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny using the 'min' extraction method</a></li>
<li><a href='#finches_phylod'><p>A phylogenetic tree of finches species with endemicity status as tip states.</p></a></li>
<li><a href='#GalapagosTrees'><p>Phylogenetic trees of the Galapagos bird lineages and sister species on the</p>
mainland.</a></li>
<li><a href='#get_clade_name'><p>Accessor functions for the data (slots) in objects of the</p>
<code>Island_colonist</code> class</a></li>
<li><a href='#get_endemic_species'><p>Checks whether the focal species (given by its tip lable in species_label</p>
argument) is part of an endemic clade on the island and a vector of the
endemic species, either a single species for a singleton or multiple species
in an endemic clade.</a></li>
<li><a href='#get_island_tbl'><p>Accessor functions for the data (slots) in objects of the</p>
<code>Island_tbl</code> class</a></li>
<li><a href='#get_sse_tip_states'><p>Extract tip states from a phylod object</p></a></li>
<li><a href='#is_back_colonisation'><p>Checks whether species has undergone back-colonisation from</p></a></li>
<li><a href='#is_duplicate_colonist'><p>Determines if colonist has already been stored in <code>Island_tbl</code> class. This is</p>
used to stop endemic clades from being stored multiple times in the island
table by checking if the endemicity status and branching times are identical.</a></li>
<li><a href='#is_identical_island_tbl'><p>Checks whether two <code>Island_tbl</code> objects are identical. If they are different</p>
comparisons are made to report which components of the <code>Island_tbls</code> are
different.</a></li>
<li><a href='#is_multi_tip_species'><p>Checks if a species is represented in the tree has multiple tips and those</p>
tips form a monophyletic group (i.e. one species with multiple samples) all
labeled as with the same endemicity status</a></li>
<li><a href='#island_colonist'><p>Constructor for Island_colonist</p></a></li>
<li><a href='#Island_colonist-class'><p>Defines the <code>island_tbl</code> class which is used when extracting information</p>
from the phylogenetic and island data to be used for constructing a
<code>daisie_data_tbl</code></a></li>
<li><a href='#island_tbl'><p>Constructor function for <code>Island_tbl</code> class</p></a></li>
<li><a href='#Island_tbl-class'><p>Defines the <code>island_tbl</code> class which is used when extracting information</p>
from the phylogenetic and island data to be used for constructing a
<code>daisie_data_tbl</code></a></li>
<li><a href='#mimus_phylod'><p>A phylogenetic tree of mimus species with endemicity status as tip states.</p></a></li>
<li><a href='#multi_extract_island_species'><p>Extracts the colonisation, diversification, and endemicty data from multiple</p>
<code>phylod</code> (<code>phylo4d</code> class from <code>phylobase</code>) objects (composed of phylogenetic
and endemicity data) and stores each in an <code>Island_tbl</code> object which are
stored in a <code>Multi_island_tbl</code> object.</a></li>
<li><a href='#multi_island_tbl'><p>Constructor function for <code>Multi_island_tbl</code> class</p></a></li>
<li><a href='#Multi_island_tbl-class'><p>Defines the <code>Multi_island_tbl</code> class which is multiple <code>Island_tbl</code>s.</p></a></li>
<li><a href='#myiarchus_phylod'><p>A phylogenetic tree of myiarchus species with endemicity status as tip states.</p></a></li>
<li><a href='#plant_phylo'><p>A phylogenetic tree of plant species.</p></a></li>
<li><a href='#plot_colonisation'><p>Plots a dot plot (cleveland dot plot when include_crown_age = TRUE) of the</p>
stem and potentially crown ages of a community of island colonists.</a></li>
<li><a href='#plot_performance'><p>Plots performance results for a grouping variable (prob_on_island or</p>
prob_endemic).</a></li>
<li><a href='#plot_phylod'><p>Plots the phylogenetic tree and its associated tip and/or node data</p></a></li>
<li><a href='#plot_sensitivity'><p>Plots</p></a></li>
<li><a href='#progne_phylod'><p>A phylogenetic tree of progne species with endemicity status as tip states.</p></a></li>
<li><a href='#pyrocephalus_phylod'><p>A phylogenetic tree of pyrocephalus species with endemicity status as</p>
tip states.</a></li>
<li><a href='#read_performance'><p>Reads in performance analysis results from inst/performance_data and formats</p>
the data ready for plotting</a></li>
<li><a href='#read_sensitivity'><p>Reads in the results from the sensitivity analysis saved in the</p>
inst/sensitivity_data folder</a></li>
<li><a href='#rm_duplicate_island_species'><p>Remove any duplicated species from the <code>island_tbl</code> after <code>"asr"</code> extraction</p></a></li>
<li><a href='#rm_island_colonist'><p>Removes an island colonist from an <code>Island_tbl</code> object</p></a></li>
<li><a href='#rm_multi_missing_species'><p>Loops through the genera that have missing species and removes the ones that</p>
are found in the missing genus list which have phylogenetic data. This is
useful when wanting to know which missing species have not been assigned to
the island_tbl using <code>add_multi_missing_species()</code>.</a></li>
<li><a href='#round_up'><p>Rounds numbers using the round up method, rather than the round to the</p>
nearest even number method used by the base function <code>round</code>.</a></li>
<li><a href='#select_endemicity_status'><p>Select endemicity status from ancestral states probabilities</p></a></li>
<li><a href='#sensitivity'><p>Runs a sensitivity analysis to test the influences of changing the data</p>
on the parameter estimates for the DAISIE maximum likelihood inference model</a></li>
<li><a href='#setophaga_phylod'><p>A phylogenetic tree of setophaga species with endemicity status as</p>
tip states.</a></li>
<li><a href='#sse_states_to_endemicity'><p>Convert SSE states back to endemicity status</p></a></li>
<li><a href='#translate_status'><p>Takes a string of the various ways the island species status can be and</p>
returns a uniform all lower-case string of the same status to make handling
statuses easier in other function</a></li>
<li><a href='#unique_island_genera'><p>Determines the unique endemic genera that are included in the island clades</p>
contained within the island_tbl object and stores them as a list with each
genus only occuring once in the first island clade it appears in</a></li>
<li><a href='#write_biogeobears_input'><p>Write input files for BioGeoBEARS</p></a></li>
<li><a href='#write_newick_file'><p>Write tree input file for BioGeoBEARS</p></a></li>
<li><a href='#write_phylip_biogeo_file'><p>Write biogeography input file for BioGeoBEARS</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extracts Phylogenetic Island Community Data from Phylogenetic
Trees</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joshua W. Lambert &lt;j.w.l.lambert@rug.nl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Extracts colonisation and branching times of island
    species to be used for analysis in the R package 'DAISIE'. It uses
    phylogenetic and endemicity data to extract the separate island colonists
    and store them.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/joshwlambert/DAISIEprep">https://github.com/joshwlambert/DAISIEprep</a>,
<a href="https://joshwlambert.github.io/DAISIEprep/">https://joshwlambert.github.io/DAISIEprep/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/joshwlambert/DAISIEprep/issues">https://github.com/joshwlambert/DAISIEprep/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, ape, phylobase, ggplot2, scales, ggtree, DAISIE,
castor, tibble, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, rmarkdown, covr, diversitree,
corHMM, tidyr, dplyr, ggimage</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'DAISIEprep-package.R' 'add_asr_node_states.R'
'add_island_colonist.R' 'add_missing_species.R'
'add_multi_missing_species.R' 'add_outgroup.R'
'all_descendants_conspecific.R' 'any_back_colonisation.R'
'any_outgroup.R' 'any_polyphyly.R' 'as_daisie_datatable.R'
'benchmark.R' 'bind_colonist_to_tbl.R' 'check_phylo_data.R'
'count_missing_species.R' 'create_daisie_data.R'
'create_endemicity_status.R' 'create_test_phylod.R' 'data.R'
'default_params_doc.R' 'endemicity_to_sse_states.R'
'extract_asr_clade.R' 'extract_clade_name.R'
'extract_endemic_clade.R' 'extract_endemic_singleton.R'
'extract_island_species.R' 'extract_multi_tip_species.R'
'extract_nonendemic.R' 'extract_species_asr.R'
'extract_species_min.R' 'extract_stem_age.R'
'extract_stem_age_asr.R' 'extract_stem_age_genus.R'
'extract_stem_age_min.R' 'get_endemic_species.R'
'is_back_colonisation.R' 'is_duplicate_colonist.R'
'is_identical_island_tbl.R' 'is_multi_tip_species.R'
'island_colonist-class.R' 'island_colonist-accessors.R'
'island_tbl-class.R' 'island_tbl-accessors.R'
'island_tbl-methods.R' 'multi_extract_island_species.R'
'multi_island_tbl-class.R' 'multi_island_tbl-methods.R'
'plot_colonisation.R' 'plot_performance.R' 'plot_phylod.R'
'plot_sensitivity.R' 'print-methods.R' 'read_performance.R'
'read_sensitivity.R' 'rm_duplicate_island_species.R'
'rm_island_colonist.R' 'rm_multi_missing_species.R'
'rm_nonendemic_in_clade.R' 'sensitivity.R' 'translate_status.R'
'unique_island_genera.R' 'utils.R' 'write_biogeobears_input.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-18 00:04:39 UTC; joshlambert</td>
</tr>
<tr>
<td>Author:</td>
<td>Joshua W. Lambert <a href="https://orcid.org/0000-0001-5218-3046"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Luis Valente <a href="https://orcid.org/0000-0003-4247-8785"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Pedro Santos Neves
    <a href="https://orcid.org/0000-0003-2561-4677"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Lizzie Roeble <a href="https://orcid.org/0000-0003-3664-4222"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Theo Pannetier <a href="https://orcid.org/0000-0002-8424-3573"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-18 00:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='DAISIEprep-package'>DAISIEprep: Extracts Phylogenetic Island Community Data from Phylogenetic Trees</h2><span id='topic+DAISIEprep'></span><span id='topic+DAISIEprep-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Extracts colonisation and branching times of island species to be used for analysis in the R package 'DAISIE'. It uses phylogenetic and endemicity data to extract the separate island colonists and store them.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Joshua W. Lambert <a href="mailto:j.w.l.lambert@rug.nl">j.w.l.lambert@rug.nl</a> (<a href="https://orcid.org/0000-0001-5218-3046">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Luis Valente <a href="mailto:luis.valente@naturalis.nl">luis.valente@naturalis.nl</a> (<a href="https://orcid.org/0000-0003-4247-8785">ORCID</a>)
</p>
</li>
<li><p> Pedro Santos Neves <a href="mailto:p.m.santos.neves@rug.nl">p.m.santos.neves@rug.nl</a> (<a href="https://orcid.org/0000-0003-2561-4677">ORCID</a>)
</p>
</li>
<li><p> Lizzie Roeble <a href="mailto:lizzie.roeble@naturalis.nl">lizzie.roeble@naturalis.nl</a> (<a href="https://orcid.org/0000-0003-3664-4222">ORCID</a>)
</p>
</li>
<li><p> Theo Pannetier <a href="mailto:t.s.c.pannetier@rug.nl">t.s.c.pannetier@rug.nl</a> (<a href="https://orcid.org/0000-0002-8424-3573">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/joshwlambert/DAISIEprep">https://github.com/joshwlambert/DAISIEprep</a>
</p>
</li>
<li> <p><a href="https://joshwlambert.github.io/DAISIEprep/">https://joshwlambert.github.io/DAISIEprep/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/joshwlambert/DAISIEprep/issues">https://github.com/joshwlambert/DAISIEprep/issues</a>
</p>
</li></ul>


<hr>
<h2 id='add_asr_node_states'>Fits a model of ancestral state reconstruction of island presence</h2><span id='topic+add_asr_node_states'></span>

<h3>Description</h3>

<p>Fits a model of ancestral state reconstruction of island presence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_asr_node_states(
  phylod,
  asr_method,
  tie_preference = "island",
  earliest_col = FALSE,
  rate_model = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_asr_node_states_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="add_asr_node_states_+3A_asr_method">asr_method</code></td>
<td>
<p>A character string, either &quot;parsimony&quot; or &quot;mk&quot; determines
whether a maximum parsimony or continuous-time markov model reconstructs the
ancestral states at each node. See documentation in
<code><a href="castor.html#topic+asr_max_parsimony">castor::asr_max_parsimony()</a></code> or <code><a href="castor.html#topic+asr_mk_model">castor::asr_mk_model()</a></code> in <code>castor</code> R
package for details on the methods used.</p>
</td></tr>
<tr><td><code id="add_asr_node_states_+3A_tie_preference">tie_preference</code></td>
<td>
<p>Character string, either &quot;island&quot; or &quot;mainland&quot; to
choose the most probable state at each node using the <code>max.col()</code> function.
When a node has island presence and absence equally probable we need to
decide whether that species should be considered on the island. To consider
it on the island use <code>ties.method = "last"</code> in the <code>max.col()</code> function, if
you consider it not on the island use <code>ties.method = "first"</code>. Default is
&quot;island&quot;.</p>
</td></tr>
<tr><td><code id="add_asr_node_states_+3A_earliest_col">earliest_col</code></td>
<td>
<p>A boolean to determine whether to take the colonisation
time as the most probable time (FALSE) or the earliest possible colonisation
time (TRUE), where the probability of a species being on the island is
non-zero. Default is FALSE.</p>
</td></tr>
<tr><td><code id="add_asr_node_states_+3A_rate_model">rate_model</code></td>
<td>

<p>Rate model to be used for fitting the transition rate matrix. Can be &quot;ER&quot; (all rates equal), &quot;SYM&quot; (transition rate i&ndash;&gt;j is equal to transition rate j&ndash;&gt;i), &quot;ARD&quot; (all rates can be different), &quot;SUEDE&quot; (only stepwise transitions i&ndash;&gt;i+1 and i&ndash;&gt;i-1 allowed, all 'up' transitions are equal, all 'down' transitions are equal) or &quot;SRD&quot; (only stepwise transitions i&ndash;&gt;i+1 and i&ndash;&gt;i-1 allowed, and each rate can be different). Can also be an index matrix that maps entries of the transition matrix to the corresponding independent rate parameter to be fitted. Diagonal entries should map to 0, since diagonal entries are not treated as independent rate parameters but are calculated from the remaining entries in the transition matrix. All other entries that map to 0 represent a transition rate of zero. The format of this index matrix is similar to the format used by the <code>ace</code> function in the <code>ape</code> package. <code>rate_model</code> is only relevant if <code>transition_matrix==NULL</code>.
</p>
</td></tr>
<tr><td><code id="add_asr_node_states_+3A_...">...</code></td>
<td>
<p><a href="base.html#topic+dots">dots</a> Allows arguments to be passed to <code><a href="castor.html#topic+asr_mk_model">castor::asr_mk_model()</a></code>
and <code><a href="castor.html#topic+asr_max_parsimony">castor::asr_max_parsimony()</a></code>. These arguments must match by name
exactly, see <code>?castor::asr_mk_model()</code> and <code>?castor::asr_max_parsimony()</code>
for information on arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>rate_model</code> argument documentation is inherited from
<code><a href="castor.html#topic+asr_mk_model">castor::asr_mk_model()</a></code>, therefore, the last sentence about the
<code>transition_matrix</code> argument does not apply to <code>add_asr_node_states()</code>.
</p>


<h3>Value</h3>

<p>An object of <code>phylo4d</code> class with tip and node data
</p>

<hr>
<h2 id='add_island_colonist'>Adds an island colonists (can be either a singleton lineage or an island
clade) to the island community (island_tbl).</h2><span id='topic+add_island_colonist'></span>

<h3>Description</h3>

<p>Adds an island colonists (can be either a singleton lineage or an island
clade) to the island community (island_tbl).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_island_colonist(
  island_tbl,
  clade_name,
  status,
  missing_species,
  col_time,
  col_max_age,
  branching_times,
  min_age,
  species,
  clade_type
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_island_colonist_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="add_island_colonist_+3A_clade_name">clade_name</code></td>
<td>
<p>Character name of the colonising clade.</p>
</td></tr>
<tr><td><code id="add_island_colonist_+3A_status">status</code></td>
<td>
<p>Character endemicity status of the colonising clade. Either
<code>"endemic"</code> or <code>"nonendemic"</code>.</p>
</td></tr>
<tr><td><code id="add_island_colonist_+3A_missing_species">missing_species</code></td>
<td>
<p>Numeric number of missing species from the phylogeny
that belong to the colonising clade. For a clade with missing species this
is <code class="reqn">n - 1</code>, where <code class="reqn">n</code> is the number of missing species in the clade.
If the clade is an island singleton, the number of missing species is <code>0</code>
because by adding the colonist it already counts as one automatically. If
the clade has more than one species, the <code>missing_species</code> is <code class="reqn">n - 1</code>
because adding the lineage already counts as one.</p>
</td></tr>
<tr><td><code id="add_island_colonist_+3A_col_time">col_time</code></td>
<td>
<p>Numeric with the colonisation time of the island colonist</p>
</td></tr>
<tr><td><code id="add_island_colonist_+3A_col_max_age">col_max_age</code></td>
<td>
<p>Boolean determining whether colonisation time should be
considered a precise time of colonisation or a maximum time of colonisation</p>
</td></tr>
<tr><td><code id="add_island_colonist_+3A_branching_times">branching_times</code></td>
<td>
<p>Numeric vector of one or more elements which are the
branching times on the island.</p>
</td></tr>
<tr><td><code id="add_island_colonist_+3A_min_age">min_age</code></td>
<td>
<p>Numeric minimum age (time before the present) that the species
must have colonised the island by. This is known when there is a branching
on the island, either in species or subspecies.</p>
</td></tr>
<tr><td><code id="add_island_colonist_+3A_species">species</code></td>
<td>
<p>Character vector of one or more elements containing the name
of the species included in the colonising clade.</p>
</td></tr>
<tr><td><code id="add_island_colonist_+3A_clade_type">clade_type</code></td>
<td>
<p>Numeric determining which type of clade the island colonist
is, this determines which macroevolutionary regime (parameter set) the island
colonist is in. After formatting the <code>island_tbl</code> to a DAISIE data list, the
clade type can be used to conduct a 2-type analysis (see
<a href="https://CRAN.R-project.org/package=DAISIE/vignettes/demo_optimize.html">https://CRAN.R-project.org/package=DAISIE/vignettes/demo_optimize.html</a>
for more information)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>Island_tbl</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create an empty island_tbl to add to
island_tbl &lt;- island_tbl()

# add a new island colonist
island_tbl &lt;- add_island_colonist(
  island_tbl,
  clade_name = "new_clade",
  status = "endemic",
  missing_species = 0,
  col_time = 1,
  col_max_age = FALSE,
  branching_times = NA,
  min_age = NA,
  species = "new_clade",
  clade_type = 1
)
</code></pre>

<hr>
<h2 id='add_missing_species'>Adds a specified number of missing species to an existing island_tbl at the
colonist specified by the species_to_add_to argument given. The species
given is located within the island_tbl data and missing species are
assigned. This is to be used after <code>extract_island_species()</code> to input
missing species.</h2><span id='topic+add_missing_species'></span>

<h3>Description</h3>

<p>Adds a specified number of missing species to an existing island_tbl at the
colonist specified by the species_to_add_to argument given. The species
given is located within the island_tbl data and missing species are
assigned. This is to be used after <code>extract_island_species()</code> to input
missing species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_missing_species(island_tbl, num_missing_species, species_to_add_to)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_missing_species_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="add_missing_species_+3A_num_missing_species">num_missing_species</code></td>
<td>
<p>Numeric for the number of missing species in the
clade.</p>
</td></tr>
<tr><td><code id="add_missing_species_+3A_species_to_add_to">species_to_add_to</code></td>
<td>
<p>Character string with the name of the species to
identify which clade to assign missing species to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of Island_tbl class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(5)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- c(
  "not_present", "not_present", "endemic", "not_present", "not_present"
)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
island_tbl &lt;- extract_island_species(phylod, extraction_method = "min")
island_tbl &lt;- add_missing_species(
  island_tbl = island_tbl,
  num_missing_species = 1,
  species_to_add_to = "bird_c"
)
</code></pre>

<hr>
<h2 id='add_multi_missing_species'>Calculates the number of missing species to be assigned to each island clade
in the island_tbl object and assigns the missing species to them. In the case
that multiple genera are in an island clade and each have missing species
the number of missing species is summed. Currently the missing species
are assigned to the genus that first matches with the missing species table,
however a more biologically or stochastic assignment is in development.</h2><span id='topic+add_multi_missing_species'></span>

<h3>Description</h3>

<p>Calculates the number of missing species to be assigned to each island clade
in the island_tbl object and assigns the missing species to them. In the case
that multiple genera are in an island clade and each have missing species
the number of missing species is summed. Currently the missing species
are assigned to the genus that first matches with the missing species table,
however a more biologically or stochastic assignment is in development.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_multi_missing_species(missing_species, missing_genus, island_tbl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_multi_missing_species_+3A_missing_species">missing_species</code></td>
<td>
<p>Numeric number of missing species from the phylogeny
that belong to the colonising clade. For a clade with missing species this
is <code class="reqn">n - 1</code>, where <code class="reqn">n</code> is the number of missing species in the clade.
If the clade is an island singleton, the number of missing species is <code>0</code>
because by adding the colonist it already counts as one automatically. If
the clade has more than one species, the <code>missing_species</code> is <code class="reqn">n - 1</code>
because adding the lineage already counts as one.</p>
</td></tr>
<tr><td><code id="add_multi_missing_species_+3A_missing_genus">missing_genus</code></td>
<td>
<p>A list of character vectors containing the genera in
each island clade</p>
</td></tr>
<tr><td><code id="add_multi_missing_species_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of Island_tbl class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phylod &lt;- create_test_phylod(test_scenario = 6)
island_tbl &lt;- suppressWarnings(extract_island_species(
  phylod = phylod,
  extraction_method = "asr",
))
phylod &lt;- create_test_phylod(test_scenario = 7)
island_tbl &lt;- suppressWarnings(extract_island_species(
  phylod = phylod,
  extraction_method = "asr",
  island_tbl = island_tbl
))

missing_species &lt;- data.frame(
  clade_name = "bird",
  missing_species = 1,
  endemicity_status = "endemic"
)

missing_genus &lt;- list("bird", character(0))

island_tbl &lt;- add_multi_missing_species(
  missing_species = missing_species,
  missing_genus = missing_genus,
  island_tbl = island_tbl
)
</code></pre>

<hr>
<h2 id='add_outgroup'>Add an outgroup species to a given phylogeny.</h2><span id='topic+add_outgroup'></span>

<h3>Description</h3>

<p>Add an outgroup species to a given phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_outgroup(phylo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_outgroup_+3A_phylo">phylo</code></td>
<td>
<p>A phylogeny either as a <code>phylo</code> (from the <code>ape</code> package) or
<code>phylo4</code> (from the <code>phylobase</code> package) object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>phylo</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phylo &lt;- ape::rcoal(10)
phylo_with_outgroup &lt;- add_outgroup(phylo)
</code></pre>

<hr>
<h2 id='all_descendants_conspecific'>Checks whether all species given in the descendants vector are the same
species.</h2><span id='topic+all_descendants_conspecific'></span>

<h3>Description</h3>

<p>Checks whether all species given in the descendants vector are the same
species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_descendants_conspecific(descendants)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="all_descendants_conspecific_+3A_descendants">descendants</code></td>
<td>
<p>A vector character strings with the names of species to
determine whether they are the same species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example where species are not conspecific
descendants &lt;- c("bird_a", "bird_b", "bird_c")
all_descendants_conspecific(descendants = descendants)

# Example where species are conspecific
descendants &lt;- c("bird_a_1", "bird_a_2", "bird_a_3")
all_descendants_conspecific(descendants = descendants)
</code></pre>

<hr>
<h2 id='all_endemicity_status'>All possible endemicity statuses</h2><span id='topic+all_endemicity_status'></span>

<h3>Description</h3>

<p>All possible endemicity statuses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_endemicity_status()
</code></pre>


<h3>Value</h3>

<p>A vector of character strings with all the endemicity status options
</p>

<hr>
<h2 id='any_back_colonisation'>Detects any cases where a non-endemic species or species not present on the
island has likely been on the island given its ancestral state reconstruction
indicating ancestral presence on the island and so is likely a back
colonisation from the island to the mainland (or potentially different
island). This function is useful if using extraction_method = &quot;min&quot; in
<code>DAISIEprep::extract_island_species()</code> as it may brake up a single colonist
into multiple colonists because of back-colonisation.</h2><span id='topic+any_back_colonisation'></span>

<h3>Description</h3>

<p>Detects any cases where a non-endemic species or species not present on the
island has likely been on the island given its ancestral state reconstruction
indicating ancestral presence on the island and so is likely a back
colonisation from the island to the mainland (or potentially different
island). This function is useful if using extraction_method = &quot;min&quot; in
<code>DAISIEprep::extract_island_species()</code> as it may brake up a single colonist
into multiple colonists because of back-colonisation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>any_back_colonisation(phylod, only_tips = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="any_back_colonisation_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="any_back_colonisation_+3A_only_tips">only_tips</code></td>
<td>
<p>A boolean determing whether only the tips (i.e. terminal
branches) are searched for back colonisation events.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single or vector of character strings. Character string is in the
format ancestral_node -&gt; focal_node, where the ancestral node is not on
mainland but the focal node is. In the case of no back colonisations a
different message string is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example with no back colonisation
phylod &lt;- create_test_phylod(test_scenario = 15)
any_back_colonisation(phylod)

# Example with back colonisation
set.seed(
  3,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(5)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- c("endemic", "endemic", "not_present",
                       "endemic", "not_present")
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
phylod &lt;- add_asr_node_states(phylod = phylod, asr_method = "parsimony")
# aritificially modify data to produce back-colonisation
phylobase::tdata(phylod)$island_status[8] &lt;- "endemic"
any_back_colonisation(phylod = phylod)
</code></pre>

<hr>
<h2 id='any_outgroup'>Checks whether the phylogeny has an outgroup that is not present on the
island. This is critical when extracting data from the phylogeny so the
stem age (colonisation time) is correct.</h2><span id='topic+any_outgroup'></span>

<h3>Description</h3>

<p>Checks whether the phylogeny has an outgroup that is not present on the
island. This is critical when extracting data from the phylogeny so the
stem age (colonisation time) is correct.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>any_outgroup(phylod)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="any_outgroup_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- sample(c("not_present", "endemic", "nonendemic"),
                            size = length(phylobase::tipLabels(phylo)),
                            replace = TRUE)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
any_outgroup(phylod)
</code></pre>

<hr>
<h2 id='any_polyphyly'>Checks whether there are any species in the phylogeny that have multiple
tips (i.e. multiple subspecies per species) and whether any of those tips are
paraphyletic (i.e. are their subspecies more distantly related to each other
than to other subspecies or species).</h2><span id='topic+any_polyphyly'></span>

<h3>Description</h3>

<p>Checks whether there are any species in the phylogeny that have multiple
tips (i.e. multiple subspecies per species) and whether any of those tips are
paraphyletic (i.e. are their subspecies more distantly related to each other
than to other subspecies or species).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>any_polyphyly(phylod)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="any_polyphyly_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phylod &lt;- create_test_phylod(test_scenario = 1)
any_polyphyly(phylod)
</code></pre>

<hr>
<h2 id='as_daisie_datatable'>Converts the <code>Island_tbl</code> class to a data frame in the format of a DAISIE
data table (see DAISIE R package for details). This can then be input into
<code>DAISIEprep::create_daisie_data()</code> function which creates the list input into
the DAISIE ML models.</h2><span id='topic+as_daisie_datatable'></span>

<h3>Description</h3>

<p>Converts the <code>Island_tbl</code> class to a data frame in the format of a DAISIE
data table (see DAISIE R package for details). This can then be input into
<code>DAISIEprep::create_daisie_data()</code> function which creates the list input into
the DAISIE ML models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_daisie_datatable(island_tbl, island_age, precise_col_time = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_daisie_datatable_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="as_daisie_datatable_+3A_island_age">island_age</code></td>
<td>
<p>Age of the island in appropriate units.</p>
</td></tr>
<tr><td><code id="as_daisie_datatable_+3A_precise_col_time">precise_col_time</code></td>
<td>
<p>Boolean, TRUE uses the precise times of colonisation,
FALSE makes every colonist a max age colonistion and uses minimum age of
colonisation if available.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame in the format of a DAISIE data table
</p>


<h3>Author(s)</h3>

<p>Joshua W. Lambert, Pedro Neves
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phylod &lt;- create_test_phylod(10)
island_tbl &lt;- extract_island_species(
  phylod = phylod,
  extraction_method = "asr"
)

# Example where precise colonisation times are known
daisie_datatable &lt;- as_daisie_datatable(
  island_tbl = island_tbl,
  island_age = 0.2,
  precise_col_time = TRUE
)

# Example where colonisation times are uncertain and set to max ages
daisie_datatable &lt;- as_daisie_datatable(
  island_tbl = island_tbl,
  island_age = 0.2,
  precise_col_time = FALSE
)
</code></pre>

<hr>
<h2 id='benchmark'>Performance analysis of the extract_island_species() function
Uses system.time() for timing for reasons explained here:
https://radfordneal.wordpress.com/2014/02/02/inaccurate-results-from-microbenchmark/ # nolint</h2><span id='topic+benchmark'></span>

<h3>Description</h3>

<p>Performance analysis of the extract_island_species() function
Uses system.time() for timing for reasons explained here:
https://radfordneal.wordpress.com/2014/02/02/inaccurate-results-from-microbenchmark/ # nolint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>benchmark(
  phylod,
  tree_size_range,
  num_points,
  prob_on_island,
  prob_endemic,
  replicates,
  extraction_method,
  asr_method,
  tie_preference,
  log_scale = TRUE,
  parameter_index = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="benchmark_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="benchmark_+3A_tree_size_range">tree_size_range</code></td>
<td>
<p>Numeric vector of two elements, the first is the
smallest tree size (number of tips) and the second is the largest tree size</p>
</td></tr>
<tr><td><code id="benchmark_+3A_num_points">num_points</code></td>
<td>
<p>Numeric determining how many points in the sequence of
smallest tree size to largest tree size</p>
</td></tr>
<tr><td><code id="benchmark_+3A_prob_on_island">prob_on_island</code></td>
<td>
<p>Numeric vector of each probability on island to use in
the parameter space</p>
</td></tr>
<tr><td><code id="benchmark_+3A_prob_endemic">prob_endemic</code></td>
<td>
<p>Numeric vector of each probability of an island species
being endemic to use in the parameter space</p>
</td></tr>
<tr><td><code id="benchmark_+3A_replicates">replicates</code></td>
<td>
<p>Numeric determining the number of replicates to use to
account for the stochasticity in sampling the species on the island and
endemic species</p>
</td></tr>
<tr><td><code id="benchmark_+3A_extraction_method">extraction_method</code></td>
<td>
<p>A character string specifying whether the
colonisation time extracted is the minimum time (<code>min</code>) (before the present),
or the most probable time under ancestral state reconstruction (<code>asr</code>).</p>
</td></tr>
<tr><td><code id="benchmark_+3A_asr_method">asr_method</code></td>
<td>
<p>A character string, either &quot;parsimony&quot; or &quot;mk&quot; determines
whether a maximum parsimony or continuous-time markov model reconstructs the
ancestral states at each node. See documentation in
<code><a href="castor.html#topic+asr_max_parsimony">castor::asr_max_parsimony()</a></code> or <code><a href="castor.html#topic+asr_mk_model">castor::asr_mk_model()</a></code> in <code>castor</code> R
package for details on the methods used.</p>
</td></tr>
<tr><td><code id="benchmark_+3A_tie_preference">tie_preference</code></td>
<td>
<p>Character string, either &quot;island&quot; or &quot;mainland&quot; to
choose the most probable state at each node using the <code>max.col()</code> function.
When a node has island presence and absence equally probable we need to
decide whether that species should be considered on the island. To consider
it on the island use <code>ties.method = "last"</code> in the <code>max.col()</code> function, if
you consider it not on the island use <code>ties.method = "first"</code>. Default is
&quot;island&quot;.</p>
</td></tr>
<tr><td><code id="benchmark_+3A_log_scale">log_scale</code></td>
<td>
<p>A boolean determining whether the sequence of tree sizes
are on a linear (FALSE) or log (TRUE) scale</p>
</td></tr>
<tr><td><code id="benchmark_+3A_parameter_index">parameter_index</code></td>
<td>
<p>Numeric determining which parameter set to use (i.e
which row in the parameter space data frame), if this is NULL all parameter
sets will be looped over</p>
</td></tr>
<tr><td><code id="benchmark_+3A_verbose">verbose</code></td>
<td>
<p>Boolean. States if intermediate results should be printed to
console. Defaults to FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame
</p>

<hr>
<h2 id='bind_colonist_to_tbl'>Takes an existing instance of an <code>Island_tbl</code> class and bind the information
from the instance of an <code>Island_colonist</code> class to it</h2><span id='topic+bind_colonist_to_tbl'></span>

<h3>Description</h3>

<p>Takes an existing instance of an <code>Island_tbl</code> class and bind the information
from the instance of an <code>Island_colonist</code> class to it
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bind_colonist_to_tbl(island_colonist, island_tbl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bind_colonist_to_tbl_+3A_island_colonist">island_colonist</code></td>
<td>
<p>An instance of the <code>Island_colonist</code> class.</p>
</td></tr>
<tr><td><code id="bind_colonist_to_tbl_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>Island_tbl</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>island_colonist &lt;- DAISIEprep::island_colonist(
  clade_name = "bird",
  status = "endemic",
  missing_species = 0,
  col_time = 1,
  col_max_age = FALSE,
  branching_times = 0.5,
  species = "bird_a",
  clade_type = 1
)
island_tbl &lt;- island_tbl()
bind_colonist_to_tbl(
  island_colonist = island_colonist,
  island_tbl = island_tbl
)
</code></pre>

<hr>
<h2 id='check_island_colonist'>Checks the validity of the Island_colonist class</h2><span id='topic+check_island_colonist'></span>

<h3>Description</h3>

<p>Checks the validity of the Island_colonist class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_island_colonist(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_island_colonist_+3A_object">object</code></td>
<td>
<p>Instance of the island_colonist class</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean or errors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>island_colonist &lt;- island_colonist()
check_island_colonist(island_colonist)
</code></pre>

<hr>
<h2 id='check_island_tbl'>Checks the validity of the Island_tbl class</h2><span id='topic+check_island_tbl'></span>

<h3>Description</h3>

<p>Checks the validity of the Island_tbl class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_island_tbl(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_island_tbl_+3A_object">object</code></td>
<td>
<p>Instance of the Island_tbl class</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean or errors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>island_tbl &lt;- island_tbl()
check_island_tbl(island_tbl)
</code></pre>

<hr>
<h2 id='check_multi_island_tbl'>Checks the validity of the Multi_island_tbl class</h2><span id='topic+check_multi_island_tbl'></span>

<h3>Description</h3>

<p>Checks the validity of the Multi_island_tbl class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_multi_island_tbl(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_multi_island_tbl_+3A_object">object</code></td>
<td>
<p>Instance of the Multi_island_tbl class</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean or errors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>multi_island_tbl &lt;- multi_island_tbl()
check_multi_island_tbl(multi_island_tbl)
</code></pre>

<hr>
<h2 id='check_phylo_data'>Checks whether <code style="white-space: pre;">&#8288;\linkS4class{phylo4d}&#8288;</code> object conforms
to the requirements of the DAISIEprep package. If the function does not
return anything the data is ready to be used, if an error is returned the
data requires some pre-processing before DAISIEprep can be used</h2><span id='topic+check_phylo_data'></span>

<h3>Description</h3>

<p>Checks whether <code style="white-space: pre;">&#8288;\linkS4class{phylo4d}&#8288;</code> object conforms
to the requirements of the DAISIEprep package. If the function does not
return anything the data is ready to be used, if an error is returned the
data requires some pre-processing before DAISIEprep can be used
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_phylo_data(phylod)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_phylo_data_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing or error message
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- sample(
  c("not_present", "endemic", "nonendemic"),
  size = length(phylobase::tipLabels(phylo)),
  replace = TRUE,
  prob = c(0.6, 0.2, 0.2)
)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
check_phylo_data(phylod)
</code></pre>

<hr>
<h2 id='coccyzus_phylod'>A phylogenetic tree of coccyzus species with endemicity status as tip states.</h2><span id='topic+coccyzus_phylod'></span>

<h3>Description</h3>

<p>A phylogenetic tree of coccyzus species with endemicity status as tip states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coccyzus_phylod
</code></pre>


<h3>Format</h3>



<h4><code>coccyzus_phylod</code></h4>

<p>A <code>phylo4d</code> object (from the <span class="pkg">phylobase</span> package) with
20 tips and
19 internal
nodes.
</p>



<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>

<hr>
<h2 id='columbiformes_phylod'>A phylogenetic tree of columbiformes species with endemicity status as
tip states.</h2><span id='topic+columbiformes_phylod'></span>

<h3>Description</h3>

<p>A phylogenetic tree of columbiformes species with endemicity status as
tip states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>columbiformes_phylod
</code></pre>


<h3>Format</h3>



<h4><code>columbiformes_phylod</code></h4>

<p>A <code>phylo4d</code> object (from the <span class="pkg">phylobase</span> package) with
242 tips and
241 internal
nodes.
</p>



<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>

<hr>
<h2 id='count_missing_species'>Reads in the checklist of all species on an island, including those that are
not in the phylogeny (represented by NA) and counts the number of species
missing from the phylogeny each genus</h2><span id='topic+count_missing_species'></span>

<h3>Description</h3>

<p>Reads in the checklist of all species on an island, including those that are
not in the phylogeny (represented by NA) and counts the number of species
missing from the phylogeny each genus
</p>


<h3>Usage</h3>

<pre><code class='language-R'>count_missing_species(
  checklist,
  phylo_name_col,
  genus_name_col,
  in_phylo_col,
  endemicity_status_col,
  rm_species_col = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="count_missing_species_+3A_checklist">checklist</code></td>
<td>
<p>data frame with information on species on the island</p>
</td></tr>
<tr><td><code id="count_missing_species_+3A_phylo_name_col">phylo_name_col</code></td>
<td>
<p>A character string specifying the column name where the
names in the phylogeny are in the checklist</p>
</td></tr>
<tr><td><code id="count_missing_species_+3A_genus_name_col">genus_name_col</code></td>
<td>
<p>A character string specifying the column name where the
genus names are in the checklist</p>
</td></tr>
<tr><td><code id="count_missing_species_+3A_in_phylo_col">in_phylo_col</code></td>
<td>
<p>A character string specifying the column name where the
status of whether a species is in the phylogeny is in the checklist</p>
</td></tr>
<tr><td><code id="count_missing_species_+3A_endemicity_status_col">endemicity_status_col</code></td>
<td>
<p>A character string specifying the column name
where the endemicity status of the species are in the checklist</p>
</td></tr>
<tr><td><code id="count_missing_species_+3A_rm_species_col">rm_species_col</code></td>
<td>
<p>A character string specifying the column name where
the information on whether to remove species from the checklist before
counting the number of missing species is in the checklist. This can be NULL
if no species are to be removed from the checklist. This is useful when
species are in the checklist because they are on the island but need to be
removed as they are not in the group of interest, e.g. a migratory bird
amongst terrestrial birds</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mock_checklist &lt;- data.frame(
  genus = c("bird", "bird", "bird", "bird", "bird", "bird", "bird",
            "bird", "bird", "bird"),
  species = c("a", "b", "c", "d", "e", "f", "g", "h", "i", "j"),
  species_names = c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                    "bird_f","bird_g", "bird_h", "bird_i", "bird_j"),
  sampled = c(TRUE, TRUE, TRUE, TRUE, TRUE, FALSE, TRUE, FALSE, TRUE, FALSE),
  endemicity_status = c("endemic", "endemic", "endemic", "nonendemic",
                        "endemic", "nonendemic", "endemic", "endemic",
                        "endemic", "endemic"),
  remove_species = (rep(FALSE, 10))
)

missing_species &lt;- count_missing_species(
  checklist = mock_checklist,
  phylo_name_col = "species_names",
  genus_name_col = "genus",
  in_phylo_col = "sampled",
  endemicity_status_col = "endemicity_status",
  rm_species_col = NULL
)
</code></pre>

<hr>
<h2 id='create_daisie_data'>This is a wrapper function for DAISIE::DAISIE_dataprep(). It allows the
final DAISIE data structure to be produced from within DAISIEprep. For
detailed documentation see the help documentation in the DAISIE package
(?DAISIE::DAISIE_dataprep).</h2><span id='topic+create_daisie_data'></span>

<h3>Description</h3>

<p>This is a wrapper function for DAISIE::DAISIE_dataprep(). It allows the
final DAISIE data structure to be produced from within DAISIEprep. For
detailed documentation see the help documentation in the DAISIE package
(?DAISIE::DAISIE_dataprep).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_daisie_data(
  data,
  island_age,
  num_mainland_species,
  num_clade_types = 1,
  list_type2_clades = NA,
  prop_type2_pool = "proportional",
  epss = 1e-05,
  verbose = FALSE,
  precise_col_time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_daisie_data_+3A_data">data</code></td>
<td>
<p>Either an object of class <code>Island_tbl</code> or a DAISIE data table
object (output from <code>as_daisie_datatable()</code>).</p>
</td></tr>
<tr><td><code id="create_daisie_data_+3A_island_age">island_age</code></td>
<td>
<p>Age of the island in appropriate units.</p>
</td></tr>
<tr><td><code id="create_daisie_data_+3A_num_mainland_species">num_mainland_species</code></td>
<td>
<p>The size of the mainland pool, i.e. the number
of species that can potentially colonise the island.</p>
</td></tr>
<tr><td><code id="create_daisie_data_+3A_num_clade_types">num_clade_types</code></td>
<td>
<p>Number of clade types. Default num_clade_types = 1 all
species are considered to belong to the same macroevolutionary process. If
num_clade_types = 2, there are two types of clades with distinct
macroevolutionary processes.</p>
</td></tr>
<tr><td><code id="create_daisie_data_+3A_list_type2_clades">list_type2_clades</code></td>
<td>
<p>If num_clade_types = 2, list_type2_clades specifies
the names of the clades that have a distinct macroevolutionary process. The
names must match those in the &quot;Clade_name&quot; column of the source data table.
If num_clade_types = 1, then list_type2_clades = NA should be specified
(default).</p>
</td></tr>
<tr><td><code id="create_daisie_data_+3A_prop_type2_pool">prop_type2_pool</code></td>
<td>
<p>Specifies the fraction of potential mainland colonists
that have a distinct macroevolutionary process. Applies only if
number_clade_types = 2. Default &quot;proportional&quot; sets the fraction to be
proportional to the number of clades of distinct macroevolutionary process
that have colonised the island. Alternatively, the user can specify a value
between 0 and 1 (e.g. if the mainland pool size is 1000 and prop_type2_pool
= 0.02 then the number of type 2 species is 20).</p>
</td></tr>
<tr><td><code id="create_daisie_data_+3A_epss">epss</code></td>
<td>
<p>Default = 1e-5 should be appropriate in most cases. This value
is used to set the maximum age of colonisation of &quot;Non_endemic_MaxAge&quot; and
&quot;Endemic_MaxAge&quot; species to an age that is slightly younger than the island
for cases when the age provided for that species is older than the island.
The new maximum age is then used as an upper bound to integrate over all
possible colonisation times.</p>
</td></tr>
<tr><td><code id="create_daisie_data_+3A_verbose">verbose</code></td>
<td>
<p>Boolean. States if intermediate results should be printed to
console. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="create_daisie_data_+3A_precise_col_time">precise_col_time</code></td>
<td>
<p>Boolean, TRUE uses the precise times of colonisation,
FALSE makes every colonist a max age colonistion and uses minimum age of
colonisation if available.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>DAISIE data list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phylod &lt;- create_test_phylod(3)
island_tbl &lt;- extract_island_species(
  phylod = phylod,
  extraction_method = "min"
)
daisie_datatable &lt;- as_daisie_datatable(island_tbl, island_age = 10)
daisie_data_list &lt;- create_daisie_data(
  data = daisie_datatable,
  island_age = 10,
  num_mainland_species = 1000,
  num_clade_types = 1,
  list_type2_clades = NA,
  prop_type2_pool = NA,
  epss = 1e-5,
  verbose = FALSE
)
</code></pre>

<hr>
<h2 id='create_endemicity_status'>Creates a data frame with the endemicity status (either 'endemic',
'nonendemic', 'not_present') of every species in the phylogeny using a
phylogeny and a data frame of the island species and their endemicity (either
'endemic' or 'nonendemic') provided.</h2><span id='topic+create_endemicity_status'></span>

<h3>Description</h3>

<p>Creates a data frame with the endemicity status (either 'endemic',
'nonendemic', 'not_present') of every species in the phylogeny using a
phylogeny and a data frame of the island species and their endemicity (either
'endemic' or 'nonendemic') provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_endemicity_status(phylo, island_species)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_endemicity_status_+3A_phylo">phylo</code></td>
<td>
<p>A phylogeny either as a <code>phylo</code> (from the <code>ape</code> package) or
<code>phylo4</code> (from the <code>phylobase</code> package) object.</p>
</td></tr>
<tr><td><code id="create_endemicity_status_+3A_island_species">island_species</code></td>
<td>
<p>Data frame with two columns. The first is a character
string of the tip_labels with the tip names of the species on the island.
The second column a character string of the endemicity status of the species,
either endemic or nonendemic.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Species included in the <code>island_species</code> data frame but not included in the
<code>phylo</code> will not be included in the output and warning will print all of the
species that are in the <code>island_species</code> that are not found in the <code>phylo</code>.
</p>


<h3>Value</h3>

<p>Data frame with single column of character strings and row names
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(4)
phylo$tip.label &lt;- c("species_a", "species_b", "species_c", "species_d")
phylo &lt;- methods::as(phylo, "phylo4")
island_species &lt;- data.frame(
  tip_labels = c("species_a", "species_b", "species_c", "species_d"),
  tip_endemicity_status = c("endemic", "endemic", "endemic", "nonendemic")
)
endemicity_status &lt;- create_endemicity_status(
  phylo = phylo,
  island_species = island_species
)
</code></pre>

<hr>
<h2 id='create_test_phylod'>Creates phylod objects.</h2><span id='topic+create_test_phylod'></span>

<h3>Description</h3>

<p>A helper function that is useful in tests and examples to
easily create <code>phylod</code> objects (i.e. phylogenetic trees with data).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_test_phylod(test_scenario)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_test_phylod_+3A_test_scenario">test_scenario</code></td>
<td>
<p>Integer specifying which test phylod object to create.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>phylo4d</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>create_test_phylod(test_scenario = 1)
</code></pre>

<hr>
<h2 id='default_params_doc'>Documentation for function in the DAISIEprep package</h2><span id='topic+default_params_doc'></span>

<h3>Description</h3>

<p>Documentation for function in the DAISIEprep package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_params_doc(
  island_colonist,
  island_tbl,
  phylod,
  extraction_method,
  species_label,
  species_endemicity,
  x,
  value,
  clade_name,
  status,
  missing_species,
  col_time,
  col_max_age,
  branching_times,
  min_age,
  species,
  clade_type,
  endemic_clade,
  phylo,
  island_species,
  descendants,
  clade,
  asr_method,
  tie_preference,
  earliest_col,
  include_not_present,
  nested_asr_species,
  num_missing_species,
  species_to_add_to,
  node_pies,
  test_scenario,
  data,
  island_age,
  num_mainland_species,
  num_clade_types,
  list_type2_clades,
  prop_type2_pool,
  epss,
  verbose,
  precise_col_time,
  n,
  digits,
  include_crown_age,
  only_tips,
  node_label,
  multi_phylod,
  island_tbl_1,
  island_tbl_2,
  unique_clade_name,
  genus_name,
  stem,
  genus_in_tree,
  missing_genus,
  checklist,
  phylo_name_col,
  genus_name_col,
  in_phylo_col,
  endemicity_status_col,
  rm_species_col,
  tree_size_range,
  num_points,
  prob_on_island,
  prob_endemic,
  replicates,
  log_scale,
  parameter_index,
  sse_model,
  force_nonendemic_singleton,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="default_params_doc_+3A_island_colonist">island_colonist</code></td>
<td>
<p>An instance of the <code>Island_colonist</code> class.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_extraction_method">extraction_method</code></td>
<td>
<p>A character string specifying whether the
colonisation time extracted is the minimum time (<code>min</code>) (before the present),
or the most probable time under ancestral state reconstruction (<code>asr</code>).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_species_endemicity">species_endemicity</code></td>
<td>
<p>A character string with the endemicity, either
&quot;endemic&quot; or &quot;nonendemic&quot; of an island species, or &quot;not_present&quot; if not on
the island.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_x">x</code></td>
<td>
<p>An object whose class is determined by the signature.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_value">value</code></td>
<td>
<p>A value which can take several forms to be assigned to an object
of a class.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_clade_name">clade_name</code></td>
<td>
<p>Character name of the colonising clade.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_status">status</code></td>
<td>
<p>Character endemicity status of the colonising clade. Either
<code>"endemic"</code> or <code>"nonendemic"</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_missing_species">missing_species</code></td>
<td>
<p>Numeric number of missing species from the phylogeny
that belong to the colonising clade. For a clade with missing species this
is <code class="reqn">n - 1</code>, where <code class="reqn">n</code> is the number of missing species in the clade.
If the clade is an island singleton, the number of missing species is <code>0</code>
because by adding the colonist it already counts as one automatically. If
the clade has more than one species, the <code>missing_species</code> is <code class="reqn">n - 1</code>
because adding the lineage already counts as one.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_col_time">col_time</code></td>
<td>
<p>Numeric with the colonisation time of the island colonist</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_col_max_age">col_max_age</code></td>
<td>
<p>Boolean determining whether colonisation time should be
considered a precise time of colonisation or a maximum time of colonisation</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_branching_times">branching_times</code></td>
<td>
<p>Numeric vector of one or more elements which are the
branching times on the island.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_min_age">min_age</code></td>
<td>
<p>Numeric minimum age (time before the present) that the species
must have colonised the island by. This is known when there is a branching
on the island, either in species or subspecies.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_species">species</code></td>
<td>
<p>Character vector of one or more elements containing the name
of the species included in the colonising clade.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_clade_type">clade_type</code></td>
<td>
<p>Numeric determining which type of clade the island colonist
is, this determines which macroevolutionary regime (parameter set) the island
colonist is in. After formatting the <code>island_tbl</code> to a DAISIE data list, the
clade type can be used to conduct a 2-type analysis (see
<a href="https://CRAN.R-project.org/package=DAISIE/vignettes/demo_optimize.html">https://CRAN.R-project.org/package=DAISIE/vignettes/demo_optimize.html</a>
for more information)</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_endemic_clade">endemic_clade</code></td>
<td>
<p>Named vector with all the species from a clade.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_phylo">phylo</code></td>
<td>
<p>A phylogeny either as a <code>phylo</code> (from the <code>ape</code> package) or
<code>phylo4</code> (from the <code>phylobase</code> package) object.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_species">island_species</code></td>
<td>
<p>Data frame with two columns. The first is a character
string of the tip_labels with the tip names of the species on the island.
The second column a character string of the endemicity status of the species,
either endemic or nonendemic.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_descendants">descendants</code></td>
<td>
<p>A vector character strings with the names of species to
determine whether they are the same species.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_clade">clade</code></td>
<td>
<p>A numeric vector which the indices of the species which are
in the island clade.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_asr_method">asr_method</code></td>
<td>
<p>A character string, either &quot;parsimony&quot; or &quot;mk&quot; determines
whether a maximum parsimony or continuous-time markov model reconstructs the
ancestral states at each node. See documentation in
<code><a href="castor.html#topic+asr_max_parsimony">castor::asr_max_parsimony()</a></code> or <code><a href="castor.html#topic+asr_mk_model">castor::asr_mk_model()</a></code> in <code>castor</code> R
package for details on the methods used.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_tie_preference">tie_preference</code></td>
<td>
<p>Character string, either &quot;island&quot; or &quot;mainland&quot; to
choose the most probable state at each node using the <code>max.col()</code> function.
When a node has island presence and absence equally probable we need to
decide whether that species should be considered on the island. To consider
it on the island use <code>ties.method = "last"</code> in the <code>max.col()</code> function, if
you consider it not on the island use <code>ties.method = "first"</code>. Default is
&quot;island&quot;.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_earliest_col">earliest_col</code></td>
<td>
<p>A boolean to determine whether to take the colonisation
time as the most probable time (FALSE) or the earliest possible colonisation
time (TRUE), where the probability of a species being on the island is
non-zero. Default is FALSE.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_include_not_present">include_not_present</code></td>
<td>
<p>A boolean determining whether species not present
on the island should be included in island colonist when embedded within an
island clade. Default is FALSE.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_nested_asr_species">nested_asr_species</code></td>
<td>
<p>A <code>character</code> string which determines whether
<em>nested island colonists</em> are split into separate colonists (<code>"split"</code>), or
grouped into a single clade (<code>"group"</code>). Nested species are those whose tip
state is on the island, and they have ancestral nodes on the island, but
there are nodes in between these island state nodes that have the state
<code>not_present</code> (i.e. not on the island). Therefore, the colonisation time
can be extracted as the most recent node state on the island (this can be
the branching time before the tip if the ancestor node of the tip is not
on the island), or the older node state of the larger clade, for <code>"split"</code>
or <code>"group"</code> respectively. <strong>Note</strong> This argument only applies when
<code>extraction_method = "asr"</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_missing_species">num_missing_species</code></td>
<td>
<p>Numeric for the number of missing species in the
clade.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_species_to_add_to">species_to_add_to</code></td>
<td>
<p>Character string with the name of the species to
identify which clade to assign missing species to.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_node_pies">node_pies</code></td>
<td>
<p>Boolean determining if pie charts of the probabilities of
a species being present on the island. If TRUE the correct data is required
in the phylod object.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_test_scenario">test_scenario</code></td>
<td>
<p>Integer specifying which test phylod object to create.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_data">data</code></td>
<td>
<p>Either an object of class <code>Island_tbl</code> or a DAISIE data table
object (output from <code>as_daisie_datatable()</code>).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_age">island_age</code></td>
<td>
<p>Age of the island in appropriate units.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_mainland_species">num_mainland_species</code></td>
<td>
<p>The size of the mainland pool, i.e. the number
of species that can potentially colonise the island.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_clade_types">num_clade_types</code></td>
<td>
<p>Number of clade types. Default num_clade_types = 1 all
species are considered to belong to the same macroevolutionary process. If
num_clade_types = 2, there are two types of clades with distinct
macroevolutionary processes.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_list_type2_clades">list_type2_clades</code></td>
<td>
<p>If num_clade_types = 2, list_type2_clades specifies
the names of the clades that have a distinct macroevolutionary process. The
names must match those in the &quot;Clade_name&quot; column of the source data table.
If num_clade_types = 1, then list_type2_clades = NA should be specified
(default).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_prop_type2_pool">prop_type2_pool</code></td>
<td>
<p>Specifies the fraction of potential mainland colonists
that have a distinct macroevolutionary process. Applies only if
number_clade_types = 2. Default &quot;proportional&quot; sets the fraction to be
proportional to the number of clades of distinct macroevolutionary process
that have colonised the island. Alternatively, the user can specify a value
between 0 and 1 (e.g. if the mainland pool size is 1000 and prop_type2_pool
= 0.02 then the number of type 2 species is 20).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_epss">epss</code></td>
<td>
<p>Default = 1e-5 should be appropriate in most cases. This value
is used to set the maximum age of colonisation of &quot;Non_endemic_MaxAge&quot; and
&quot;Endemic_MaxAge&quot; species to an age that is slightly younger than the island
for cases when the age provided for that species is older than the island.
The new maximum age is then used as an upper bound to integrate over all
possible colonisation times.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_verbose">verbose</code></td>
<td>
<p>Boolean. States if intermediate results should be printed to
console. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_precise_col_time">precise_col_time</code></td>
<td>
<p>Boolean, TRUE uses the precise times of colonisation,
FALSE makes every colonist a max age colonistion and uses minimum age of
colonisation if available.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_n">n</code></td>
<td>
<p>A numeric to be rounded.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_digits">digits</code></td>
<td>
<p>A numeric specifying which decimal places to round to</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_include_crown_age">include_crown_age</code></td>
<td>
<p>A boolean determining whether the crown age gets
plotted with the stem age.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_only_tips">only_tips</code></td>
<td>
<p>A boolean determing whether only the tips (i.e. terminal
branches) are searched for back colonisation events.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_node_label">node_label</code></td>
<td>
<p>A numeric label for a node within a phylogeny.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_multi_phylod">multi_phylod</code></td>
<td>
<p>A list of phylod objects.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_tbl_1">island_tbl_1</code></td>
<td>
<p>An object of <code>Island_tbl</code> class to be comparedl</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_tbl_2">island_tbl_2</code></td>
<td>
<p>An object of <code>Island_tbl</code> class to be compared</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_unique_clade_name">unique_clade_name</code></td>
<td>
<p>Boolean determining whether a unique species
identifier is used as the clade name in the Island_tbl object or a genus
name which may not be unique if that genus has several independent island
colonisations</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_genus_name">genus_name</code></td>
<td>
<p>Character string of genus name to be matched with a genus
name from the tip labels in the phylogeny</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_stem">stem</code></td>
<td>
<p>Character string, either &quot;genus&quot; or &quot;island_presence&quot;. The former
will extract the stem age of the genussbased on the genus name provided, the
latter will extract the stem age based on the ancestral presence on the
island either based on the &quot;min&quot; or &quot;asr&quot; extraction algorithms.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_genus_in_tree">genus_in_tree</code></td>
<td>
<p>A numeric vector that indicates which species in the
genus are in the tree</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_missing_genus">missing_genus</code></td>
<td>
<p>A list of character vectors containing the genera in
each island clade</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_checklist">checklist</code></td>
<td>
<p>data frame with information on species on the island</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_phylo_name_col">phylo_name_col</code></td>
<td>
<p>A character string specifying the column name where the
names in the phylogeny are in the checklist</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_genus_name_col">genus_name_col</code></td>
<td>
<p>A character string specifying the column name where the
genus names are in the checklist</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_in_phylo_col">in_phylo_col</code></td>
<td>
<p>A character string specifying the column name where the
status of whether a species is in the phylogeny is in the checklist</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_endemicity_status_col">endemicity_status_col</code></td>
<td>
<p>A character string specifying the column name
where the endemicity status of the species are in the checklist</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_rm_species_col">rm_species_col</code></td>
<td>
<p>A character string specifying the column name where
the information on whether to remove species from the checklist before
counting the number of missing species is in the checklist. This can be NULL
if no species are to be removed from the checklist. This is useful when
species are in the checklist because they are on the island but need to be
removed as they are not in the group of interest, e.g. a migratory bird
amongst terrestrial birds</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_tree_size_range">tree_size_range</code></td>
<td>
<p>Numeric vector of two elements, the first is the
smallest tree size (number of tips) and the second is the largest tree size</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_points">num_points</code></td>
<td>
<p>Numeric determining how many points in the sequence of
smallest tree size to largest tree size</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_prob_on_island">prob_on_island</code></td>
<td>
<p>Numeric vector of each probability on island to use in
the parameter space</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_prob_endemic">prob_endemic</code></td>
<td>
<p>Numeric vector of each probability of an island species
being endemic to use in the parameter space</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_replicates">replicates</code></td>
<td>
<p>Numeric determining the number of replicates to use to
account for the stochasticity in sampling the species on the island and
endemic species</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_log_scale">log_scale</code></td>
<td>
<p>A boolean determining whether the sequence of tree sizes
are on a linear (FALSE) or log (TRUE) scale</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_parameter_index">parameter_index</code></td>
<td>
<p>Numeric determining which parameter set to use (i.e
which row in the parameter space data frame), if this is NULL all parameter
sets will be looped over</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sse_model">sse_model</code></td>
<td>
<p>either &quot;musse&quot; (default) or &quot;geosse&quot;. MuSSE expects state
values 1, 2, 3, which here we encode as &quot;not_present&quot;, &quot;endemic&quot;,
&quot;nonendemic&quot;, respectively. GeoSSE expects trait values 0, 1, 2, with 0 the
widespread state (here, &quot;nonendemic&quot;), and 1 and 2 are &quot;not_present&quot; and
&quot;endemic&quot;, respectively.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_force_nonendemic_singleton">force_nonendemic_singleton</code></td>
<td>
<p>A boolean that determines whether all
species that are classified as <code>"nonendemic"</code> are forced to be extracted as
singletons (i.e single species lineages). By default it is <code>FALSE</code> so
non-endemics can be extracted either as singletons or part of an endemic
clade. When set to <code>TRUE</code> all non-endemic species in the tree will be
single species colonists, with the colonisation time extracted as the stem
age for the tip in the phylogeny. There are some exceptions to this, please
see <code>vignette("Forcing_nonendemic_singleton", package = "DAISIEprep")</code> for more details.
</p>
<p>This argument is only active when <code>extraction_method = "asr"</code>, when
<code>extraction_method = "min"</code> this argument will be ignored with a warning,
as the <code>min</code> method always extracts non-endemic species as singletons.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_...">...</code></td>
<td>
<p><a href="base.html#topic+dots">dots</a> Allows arguments to be passed to <code><a href="castor.html#topic+asr_mk_model">castor::asr_mk_model()</a></code>
and <code><a href="castor.html#topic+asr_max_parsimony">castor::asr_max_parsimony()</a></code>. These arguments must match by name
exactly, see <code>?castor::asr_mk_model()</code> and <code>?castor::asr_max_parsimony()</code>
for information on arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Joshua W. Lambert
</p>

<hr>
<h2 id='endemicity_to_sse_states'>Convert endemicity to SSE states</h2><span id='topic+endemicity_to_sse_states'></span>

<h3>Description</h3>

<p>Convert endemicity to SSE states
</p>


<h3>Usage</h3>

<pre><code class='language-R'>endemicity_to_sse_states(endemicity_status, sse_model = "musse")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="endemicity_to_sse_states_+3A_endemicity_status">endemicity_status</code></td>
<td>
<p>character vector with values &quot;endemic&quot;, &quot;nonendemic&quot;
and/or &quot;not_present&quot;</p>
</td></tr>
<tr><td><code id="endemicity_to_sse_states_+3A_sse_model">sse_model</code></td>
<td>
<p>either &quot;musse&quot; (default) or &quot;geosse&quot;. MuSSE expects state
values 1, 2, 3, which here we encode as &quot;not_present&quot;, &quot;endemic&quot;,
&quot;nonendemic&quot;, respectively. GeoSSE expects trait values 0, 1, 2, with 0 the
widespread state (here, &quot;nonendemic&quot;), and 1 and 2 are &quot;not_present&quot; and
&quot;endemic&quot;, respectively.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an integer vector of tip states, following the encoding expected by
the MuSSE/GeoSSE
</p>

<hr>
<h2 id='extract_asr_clade'>Extracts an island clade based on the ancestral state reconstruction of the
species presence on the island, therefore this clade can contain
non-endemic species as well as endemic species.</h2><span id='topic+extract_asr_clade'></span>

<h3>Description</h3>

<p>Extracts an island clade based on the ancestral state reconstruction of the
species presence on the island, therefore this clade can contain
non-endemic species as well as endemic species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_asr_clade(phylod, species_label, clade, include_not_present)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_asr_clade_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_asr_clade_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
<tr><td><code id="extract_asr_clade_+3A_clade">clade</code></td>
<td>
<p>A numeric vector which the indices of the species which are
in the island clade.</p>
</td></tr>
<tr><td><code id="extract_asr_clade_+3A_include_not_present">include_not_present</code></td>
<td>
<p>A boolean determining whether species not present
on the island should be included in island colonist when embedded within an
island clade. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>Island_colonist</code> class
</p>

<hr>
<h2 id='extract_biogeobears_ancestral_states_probs'>Extract ancestral state probabilities from BioGeoBEARS output</h2><span id='topic+extract_biogeobears_ancestral_states_probs'></span>

<h3>Description</h3>

<p>Extract the probabilities of each endemicity status for tip and internal node
states from the output of an optimisation performed with BioGeoBEARS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_biogeobears_ancestral_states_probs(biogeobears_res)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_biogeobears_ancestral_states_probs_+3A_biogeobears_res">biogeobears_res</code></td>
<td>
<p>a list, the output of <code>BioGeoBEARS::bears_optim_run()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with one row per node (tips and internals) and four
columns: label | not_present | endemic | nonendemic, the last three columns
containing the probability of each endemicity status (and summing to 1).
</p>

<hr>
<h2 id='extract_clade_name'>Creates a name for a clade depending on whether all the species of the clade
have the same genus name or whether the clade is composed of multiple genera,
in which case it will create a unique clade name by concatinating the genus
names</h2><span id='topic+extract_clade_name'></span>

<h3>Description</h3>

<p>Creates a name for a clade depending on whether all the species of the clade
have the same genus name or whether the clade is composed of multiple genera,
in which case it will create a unique clade name by concatinating the genus
names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_clade_name(clade)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_clade_name_+3A_clade">clade</code></td>
<td>
<p>A numeric vector which the indices of the species which are
in the island clade.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character
</p>

<hr>
<h2 id='extract_endemic_clade'>Extracts the information for an endemic clade (i.e. more than one species on
the island more closely related to each other than other mainland species)
from a phylogeny (specifically <code>phylo4d</code>  object from <code>phylobase</code> package)
and stores it in an <code>Island_colonist</code> class</h2><span id='topic+extract_endemic_clade'></span>

<h3>Description</h3>

<p>Extracts the information for an endemic clade (i.e. more than one species on
the island more closely related to each other than other mainland species)
from a phylogeny (specifically <code>phylo4d</code>  object from <code>phylobase</code> package)
and stores it in an <code>Island_colonist</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_endemic_clade(phylod, species_label, unique_clade_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_endemic_clade_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_endemic_clade_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
<tr><td><code id="extract_endemic_clade_+3A_unique_clade_name">unique_clade_name</code></td>
<td>
<p>Boolean determining whether a unique species
identifier is used as the clade name in the Island_tbl object or a genus
name which may not be unique if that genus has several independent island
colonisations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>Island_colonist</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  3,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- methods::as(phylo, "phylo4")
endemicity_status &lt;- sample(
  x = c("not_present", "endemic", "nonendemic"),
  size = length(phylobase::tipLabels(phylo)),
  replace = TRUE,
  prob = c(0.7, 0.3, 0)
)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
island_colonist &lt;- extract_endemic_clade(
  phylod = phylod,
  species_label = "bird_i",
  unique_clade_name = TRUE
)
</code></pre>

<hr>
<h2 id='extract_endemic_singleton'>Extracts the information for an endemic species from a phylogeny
(specifically <code>phylo4d</code>  object from <code>phylobase</code> package) and stores it in
in an <code>Island_colonist</code> class</h2><span id='topic+extract_endemic_singleton'></span>

<h3>Description</h3>

<p>Extracts the information for an endemic species from a phylogeny
(specifically <code>phylo4d</code>  object from <code>phylobase</code> package) and stores it in
in an <code>Island_colonist</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_endemic_singleton(phylod, species_label)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_endemic_singleton_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_endemic_singleton_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>Island_colonist</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- sample(
  x = c("not_present", "endemic", "nonendemic"),
  size = length(phylobase::tipLabels(phylo)),
  replace = TRUE,
  prob = c(0.6, 0.2, 0.2)
)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
extract_endemic_singleton(phylod = phylod, species_label = "bird_i")
</code></pre>

<hr>
<h2 id='extract_island_species'>Extracts the colonisation, diversification, and endemicty data from
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object</h2><span id='topic+extract_island_species'></span>

<h3>Description</h3>

<p>Extracts the colonisation, diversification, and endemicty data from
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_island_species(
  phylod,
  extraction_method,
  island_tbl = NULL,
  include_not_present = FALSE,
  nested_asr_species = c("split", "group"),
  force_nonendemic_singleton = FALSE,
  unique_clade_name = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_island_species_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_island_species_+3A_extraction_method">extraction_method</code></td>
<td>
<p>A character string specifying whether the
colonisation time extracted is the minimum time (<code>min</code>) (before the present),
or the most probable time under ancestral state reconstruction (<code>asr</code>).</p>
</td></tr>
<tr><td><code id="extract_island_species_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="extract_island_species_+3A_include_not_present">include_not_present</code></td>
<td>
<p>A boolean determining whether species not present
on the island should be included in island colonist when embedded within an
island clade. Default is FALSE.</p>
</td></tr>
<tr><td><code id="extract_island_species_+3A_nested_asr_species">nested_asr_species</code></td>
<td>
<p>A <code>character</code> string which determines whether
<em>nested island colonists</em> are split into separate colonists (<code>"split"</code>), or
grouped into a single clade (<code>"group"</code>). Nested species are those whose tip
state is on the island, and they have ancestral nodes on the island, but
there are nodes in between these island state nodes that have the state
<code>not_present</code> (i.e. not on the island). Therefore, the colonisation time
can be extracted as the most recent node state on the island (this can be
the branching time before the tip if the ancestor node of the tip is not
on the island), or the older node state of the larger clade, for <code>"split"</code>
or <code>"group"</code> respectively. <strong>Note</strong> This argument only applies when
<code>extraction_method = "asr"</code>.</p>
</td></tr>
<tr><td><code id="extract_island_species_+3A_force_nonendemic_singleton">force_nonendemic_singleton</code></td>
<td>
<p>A boolean that determines whether all
species that are classified as <code>"nonendemic"</code> are forced to be extracted as
singletons (i.e single species lineages). By default it is <code>FALSE</code> so
non-endemics can be extracted either as singletons or part of an endemic
clade. When set to <code>TRUE</code> all non-endemic species in the tree will be
single species colonists, with the colonisation time extracted as the stem
age for the tip in the phylogeny. There are some exceptions to this, please
see <code>vignette("Forcing_nonendemic_singleton", package = "DAISIEprep")</code> for more details.
</p>
<p>This argument is only active when <code>extraction_method = "asr"</code>, when
<code>extraction_method = "min"</code> this argument will be ignored with a warning,
as the <code>min</code> method always extracts non-endemic species as singletons.</p>
</td></tr>
<tr><td><code id="extract_island_species_+3A_unique_clade_name">unique_clade_name</code></td>
<td>
<p>Boolean determining whether a unique species
identifier is used as the clade name in the Island_tbl object or a genus
name which may not be unique if that genus has several independent island
colonisations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>Island_tbl</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- sample(
  c("not_present", "endemic", "nonendemic"),
  size = length(phylobase::tipLabels(phylo)),
  replace = TRUE,
  prob = c(0.6, 0.2, 0.2)
)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
extract_island_species(phylod, extraction_method = "min")
</code></pre>

<hr>
<h2 id='extract_multi_tip_species'>Extracts the information for a species (endemic or non-endemic) which has
multiple tips in the phylogeny (i.e. more than one sample per species) from
a phylogeny (specifically <code>phylo4d</code>  object from <code>phylobase</code> package)
and stores it in an <code>Island_colonist</code> class</h2><span id='topic+extract_multi_tip_species'></span>

<h3>Description</h3>

<p>Extracts the information for a species (endemic or non-endemic) which has
multiple tips in the phylogeny (i.e. more than one sample per species) from
a phylogeny (specifically <code>phylo4d</code>  object from <code>phylobase</code> package)
and stores it in an <code>Island_colonist</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_multi_tip_species(phylod, species_label, species_endemicity)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_multi_tip_species_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_multi_tip_species_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
<tr><td><code id="extract_multi_tip_species_+3A_species_endemicity">species_endemicity</code></td>
<td>
<p>A character string with the endemicity, either
&quot;endemic&quot; or &quot;nonendemic&quot; of an island species, or &quot;not_present&quot; if not on
the island.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>Island_colonist</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h_1", "bird_h_2", "bird_i")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- c("not_present", "not_present", "not_present",
                       "not_present", "not_present", "not_present",
                       "not_present",  "endemic", "endemic", "not_present")
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
extract_multi_tip_species(
  phylod = phylod,
  species_label = "bird_h_1",
  species_endemicity = "endemic"
)
</code></pre>

<hr>
<h2 id='extract_nonendemic'>Extracts the information for a non-endemic species from a phylogeny
(specifically <code>phylo4d</code>  object from <code>phylobase</code> package) and stores it in
in an <code>island_colonist</code> class</h2><span id='topic+extract_nonendemic'></span>

<h3>Description</h3>

<p>Extracts the information for a non-endemic species from a phylogeny
(specifically <code>phylo4d</code>  object from <code>phylobase</code> package) and stores it in
in an <code>island_colonist</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_nonendemic(phylod, species_label)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_nonendemic_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_nonendemic_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>island_colonist</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- sample(
  x = c("not_present", "endemic", "nonendemic"),
  size = length(phylobase::tipLabels(phylo)),
  replace = TRUE,
  prob = c(0.6, 0.2, 0.2)
)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
extract_nonendemic(phylod = phylod, species_label = "bird_g")
</code></pre>

<hr>
<h2 id='extract_nonendemic_forced'>Extract non-endemic colonist that is forced to be a singleton by user</h2><span id='topic+extract_nonendemic_forced'></span>

<h3>Description</h3>

<p>Extract non-endemic colonist that is forced to be a singleton by user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_nonendemic_forced(phylod, species_label, island_tbl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_nonendemic_forced_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_nonendemic_forced_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
<tr><td><code id="extract_nonendemic_forced_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>phylo4d</code> class with tip and node data
</p>

<hr>
<h2 id='extract_species_asr'>Extracts the colonisation, diversification, and endemicty data from
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object
using the &quot;asr&quot; algorithm that extract island species given their ancestral
states of either island presence or absence.</h2><span id='topic+extract_species_asr'></span>

<h3>Description</h3>

<p>Extracts the colonisation, diversification, and endemicty data from
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object
using the &quot;asr&quot; algorithm that extract island species given their ancestral
states of either island presence or absence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_species_asr(
  phylod,
  species_label,
  species_endemicity,
  island_tbl,
  include_not_present
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_species_asr_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_species_asr_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
<tr><td><code id="extract_species_asr_+3A_species_endemicity">species_endemicity</code></td>
<td>
<p>A character string with the endemicity, either
&quot;endemic&quot; or &quot;nonendemic&quot; of an island species, or &quot;not_present&quot; if not on
the island.</p>
</td></tr>
<tr><td><code id="extract_species_asr_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="extract_species_asr_+3A_include_not_present">include_not_present</code></td>
<td>
<p>A boolean determining whether species not present
on the island should be included in island colonist when embedded within an
island clade. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>island_tbl</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- sample(c("not_present", "endemic", "nonendemic"),
                            size = length(phylobase::tipLabels(phylo)),
                            replace = TRUE, prob = c(0.8, 0.1, 0.1))
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
phylod &lt;- add_asr_node_states(
  phylod = phylod,
  asr_method = "parsimony"
)
island_tbl &lt;- island_tbl()
extract_species_asr(
  phylod = phylod,
  species_label = "bird_i",
  species_endemicity = "endemic",
  island_tbl = island_tbl,
  include_not_present = FALSE
)
</code></pre>

<hr>
<h2 id='extract_species_min'>Extracts the colonisation, diversification, and endemicty data from
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object
using the &quot;min&quot; algorithm that extract island species as the shortest time
to the present.</h2><span id='topic+extract_species_min'></span>

<h3>Description</h3>

<p>Extracts the colonisation, diversification, and endemicty data from
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object
using the &quot;min&quot; algorithm that extract island species as the shortest time
to the present.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_species_min(
  phylod,
  species_label,
  species_endemicity,
  island_tbl,
  unique_clade_name
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_species_min_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_species_min_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
<tr><td><code id="extract_species_min_+3A_species_endemicity">species_endemicity</code></td>
<td>
<p>A character string with the endemicity, either
&quot;endemic&quot; or &quot;nonendemic&quot; of an island species, or &quot;not_present&quot; if not on
the island.</p>
</td></tr>
<tr><td><code id="extract_species_min_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="extract_species_min_+3A_unique_clade_name">unique_clade_name</code></td>
<td>
<p>Boolean determining whether a unique species
identifier is used as the clade name in the Island_tbl object or a genus
name which may not be unique if that genus has several independent island
colonisations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>island_tbl</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- sample(
  c("not_present", "endemic", "nonendemic"),
  size = length(phylobase::tipLabels(phylo)),
  replace = TRUE,
  prob = c(0.6, 0.2, 0.2)
)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
island_tbl &lt;- island_tbl()
extract_species_min(
  phylod = phylod,
  species_label = "bird_g",
  species_endemicity = "nonendemic",
  island_tbl = island_tbl,
  unique_clade_name = TRUE
)
</code></pre>

<hr>
<h2 id='extract_stem_age'>Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny. The stem age can either be for the
genus (or several genera) in the tree (<code>stem = "genus"</code>) or use an extraction
algorithm to find the stem of when the species colonised the island
(<code style="white-space: pre;">&#8288;stem = "island_presence&#8288;</code>), either 'min' or 'asr' as in
extract_island_species(). When <code>stem = "island_presence"</code>
the reconstructed node states are used
to determine the stem age.</h2><span id='topic+extract_stem_age'></span>

<h3>Description</h3>

<p>Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny. The stem age can either be for the
genus (or several genera) in the tree (<code>stem = "genus"</code>) or use an extraction
algorithm to find the stem of when the species colonised the island
(<code style="white-space: pre;">&#8288;stem = "island_presence&#8288;</code>), either 'min' or 'asr' as in
extract_island_species(). When <code>stem = "island_presence"</code>
the reconstructed node states are used
to determine the stem age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_stem_age(genus_name, phylod, stem, extraction_method = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_stem_age_+3A_genus_name">genus_name</code></td>
<td>
<p>Character string of genus name to be matched with a genus
name from the tip labels in the phylogeny</p>
</td></tr>
<tr><td><code id="extract_stem_age_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="extract_stem_age_+3A_stem">stem</code></td>
<td>
<p>Character string, either &quot;genus&quot; or &quot;island_presence&quot;. The former
will extract the stem age of the genussbased on the genus name provided, the
latter will extract the stem age based on the ancestral presence on the
island either based on the &quot;min&quot; or &quot;asr&quot; extraction algorithms.</p>
</td></tr>
<tr><td><code id="extract_stem_age_+3A_extraction_method">extraction_method</code></td>
<td>
<p>A character string specifying whether the
colonisation time extracted is the minimum time (<code>min</code>) (before the present),
or the most probable time under ancestral state reconstruction (<code>asr</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In this example the parrot clade is the genus of interest only the parrots
# are endemic to the island and all the passerines are not on the island
set.seed(1)
tree &lt;- ape::rcoal(10)
tree$tip.label &lt;- c(
  "passerine_a", "passerine_b", "passerine_c", "passerine_d", "passerine_e",
  "passerine_f", "parrot_a", "parrot_b", "parrot_c", "passerine_j")
tree &lt;- phylobase::phylo4(tree)
endemicity_status &lt;- c(
  "not_present", "not_present", "not_present", "not_present", "not_present",
  "not_present", "endemic", "endemic", "endemic", "not_present")
phylod &lt;- phylobase::phylo4d(tree, as.data.frame(endemicity_status))
DAISIEprep::plot_phylod(phylod)
# the species 'parrot_a' is removed and becomes the missing species we want
# to the know the stem age for
phylod &lt;- phylobase::subset(x = phylod, tips.exclude = "parrot_a")
DAISIEprep::plot_phylod(phylod)
extract_stem_age(
  genus_name = "parrot",
  phylod = phylod,
  stem = "island_presence",
  extraction_method = "min"
)
# here we use the extraction_method = "asr" which requires ancestral node
# states in the tree.
phylod &lt;- add_asr_node_states(
  phylod = phylod,
  asr_method = "parsimony",
  tie_preference = "mainland"
)
DAISIEprep::plot_phylod(phylod)
extract_stem_age(
  genus_name = "parrot",
  phylod = phylod,
  stem = "island_presence",
  extraction_method = "asr"
)
# lastly we extract the stem age based on the genus name
extract_stem_age(
  genus_name = "parrot",
  phylod = phylod,
  stem = "genus",
  extraction_method = NULL
)
</code></pre>

<hr>
<h2 id='extract_stem_age_asr'>Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny using the 'asr' extraction method</h2><span id='topic+extract_stem_age_asr'></span>

<h3>Description</h3>

<p>Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny using the 'asr' extraction method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_stem_age_asr(genus_in_tree, phylod)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_stem_age_asr_+3A_genus_in_tree">genus_in_tree</code></td>
<td>
<p>A numeric vector that indicates which species in the
genus are in the tree</p>
</td></tr>
<tr><td><code id="extract_stem_age_asr_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric
</p>

<hr>
<h2 id='extract_stem_age_genus'>Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny</h2><span id='topic+extract_stem_age_genus'></span>

<h3>Description</h3>

<p>Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_stem_age_genus(genus_in_tree, phylod)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_stem_age_genus_+3A_genus_in_tree">genus_in_tree</code></td>
<td>
<p>A numeric vector that indicates which species in the
genus are in the tree</p>
</td></tr>
<tr><td><code id="extract_stem_age_genus_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric
</p>

<hr>
<h2 id='extract_stem_age_min'>Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny using the 'min' extraction method</h2><span id='topic+extract_stem_age_min'></span>

<h3>Description</h3>

<p>Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny using the 'min' extraction method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_stem_age_min(genus_in_tree, phylod)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_stem_age_min_+3A_genus_in_tree">genus_in_tree</code></td>
<td>
<p>A numeric vector that indicates which species in the
genus are in the tree</p>
</td></tr>
<tr><td><code id="extract_stem_age_min_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric
</p>

<hr>
<h2 id='finches_phylod'>A phylogenetic tree of finches species with endemicity status as tip states.</h2><span id='topic+finches_phylod'></span>

<h3>Description</h3>

<p>A phylogenetic tree of finches species with endemicity status as tip states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>finches_phylod
</code></pre>


<h3>Format</h3>



<h4><code>finches_phylod</code></h4>

<p>A <code>phylo4d</code> object (from the <span class="pkg">phylobase</span> package) with
16 tips and
15 internal
nodes.
</p>



<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>

<hr>
<h2 id='GalapagosTrees'>Phylogenetic trees of the Galapagos bird lineages and sister species on the
mainland.</h2><span id='topic+GalapagosTrees'></span><span id='topic+coccyzus_tree'></span><span id='topic+columbiformes_tree'></span><span id='topic+finches_tree'></span><span id='topic+mimus_tree'></span><span id='topic+myiarchus_tree'></span><span id='topic+progne_tree'></span><span id='topic+pyrocephalus_tree'></span><span id='topic+setophaga_tree'></span>

<h3>Description</h3>

<p>Each dataset is a phylogenetic tree used to extract the Galapagos avifaunal
lineages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coccyzus_tree

columbiformes_tree

finches_tree

mimus_tree

myiarchus_tree

progne_tree

pyrocephalus_tree

setophaga_tree
</code></pre>


<h3>Format</h3>

<p>A <code>phylo</code> object (from the <span class="pkg">ape</span> package)
</p>
<p>An object of class <code>phylo</code> of length 5.
</p>
<p>An object of class <code>phylo</code> of length 4.
</p>
<p>An object of class <code>phylo</code> of length 5.
</p>
<p>An object of class <code>phylo</code> of length 4.
</p>
<p>An object of class <code>phylo</code> of length 5.
</p>
<p>An object of class <code>phylo</code> of length 5.
</p>
<p>An object of class <code>phylo</code> of length 5.
</p>


<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>

<hr>
<h2 id='get_clade_name'>Accessor functions for the data (slots) in objects of the
<code><a href="#topic+Island_colonist-class">Island_colonist</a></code> class</h2><span id='topic+get_clade_name'></span><span id='topic+get_clade_name+2CIsland_colonist-method'></span><span id='topic+set_clade_name+3C-'></span><span id='topic+set_clade_name+3C-+2CIsland_colonist-method'></span><span id='topic+get_status'></span><span id='topic+get_status+2CIsland_colonist-method'></span><span id='topic+set_status+3C-'></span><span id='topic+set_status+3C-+2CIsland_colonist-method'></span><span id='topic+get_missing_species'></span><span id='topic+get_missing_species+2CIsland_colonist-method'></span><span id='topic+set_missing_species+3C-'></span><span id='topic+set_missing_species+3C-+2CIsland_colonist-method'></span><span id='topic+get_col_time'></span><span id='topic+get_col_time+2CIsland_colonist-method'></span><span id='topic+set_col_time+3C-'></span><span id='topic+set_col_time+3C-+2CIsland_colonist-method'></span><span id='topic+get_col_max_age'></span><span id='topic+get_col_max_age+2CIsland_colonist-method'></span><span id='topic+set_col_max_age+3C-'></span><span id='topic+set_col_max_age+3C-+2CIsland_colonist-method'></span><span id='topic+get_branching_times'></span><span id='topic+get_branching_times+2CIsland_colonist-method'></span><span id='topic+set_branching_times+3C-'></span><span id='topic+set_branching_times+3C-+2CIsland_colonist-method'></span><span id='topic+get_min_age'></span><span id='topic+get_min_age+2CIsland_colonist-method'></span><span id='topic+set_min_age+3C-'></span><span id='topic+set_min_age+3C-+2CIsland_colonist-method'></span><span id='topic+get_species'></span><span id='topic+get_species+2CIsland_colonist-method'></span><span id='topic+set_species+3C-'></span><span id='topic+set_species+3C-+2CIsland_colonist-method'></span><span id='topic+get_clade_type'></span><span id='topic+get_clade_type+2CIsland_colonist-method'></span><span id='topic+set_clade_type+3C-'></span><span id='topic+set_clade_type+3C-+2CIsland_colonist-method'></span>

<h3>Description</h3>

<p>Accessor functions for the data (slots) in objects of the
<code><a href="#topic+Island_colonist-class">Island_colonist</a></code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_clade_name(x)

## S4 method for signature 'Island_colonist'
get_clade_name(x)

set_clade_name(x) &lt;- value

## S4 replacement method for signature 'Island_colonist'
set_clade_name(x) &lt;- value

get_status(x)

## S4 method for signature 'Island_colonist'
get_status(x)

set_status(x) &lt;- value

## S4 replacement method for signature 'Island_colonist'
set_status(x) &lt;- value

get_missing_species(x)

## S4 method for signature 'Island_colonist'
get_missing_species(x)

set_missing_species(x) &lt;- value

## S4 replacement method for signature 'Island_colonist'
set_missing_species(x) &lt;- value

get_col_time(x)

## S4 method for signature 'Island_colonist'
get_col_time(x)

set_col_time(x) &lt;- value

## S4 replacement method for signature 'Island_colonist'
set_col_time(x) &lt;- value

get_col_max_age(x)

## S4 method for signature 'Island_colonist'
get_col_max_age(x)

set_col_max_age(x) &lt;- value

## S4 replacement method for signature 'Island_colonist'
set_col_max_age(x) &lt;- value

get_branching_times(x)

## S4 method for signature 'Island_colonist'
get_branching_times(x)

set_branching_times(x) &lt;- value

## S4 replacement method for signature 'Island_colonist'
set_branching_times(x) &lt;- value

get_min_age(x)

## S4 method for signature 'Island_colonist'
get_min_age(x)

set_min_age(x) &lt;- value

## S4 replacement method for signature 'Island_colonist'
set_min_age(x) &lt;- value

get_species(x)

## S4 method for signature 'Island_colonist'
get_species(x)

set_species(x) &lt;- value

## S4 replacement method for signature 'Island_colonist'
set_species(x) &lt;- value

get_clade_type(x)

## S4 method for signature 'Island_colonist'
get_clade_type(x)

set_clade_type(x) &lt;- value

## S4 replacement method for signature 'Island_colonist'
set_clade_type(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_clade_name_+3A_x">x</code></td>
<td>
<p>An object whose class is determined by the signature.</p>
</td></tr>
<tr><td><code id="get_clade_name_+3A_value">value</code></td>
<td>
<p>A value which can take several forms to be assigned to an object
of a class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Getter functions (get_<em>) return a variable from the Island_colonist
class, the setter functions (set_</em>) return the modified Island_colonist
class.
</p>


<h3>Author(s)</h3>

<p>Joshua W. Lambert
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  colonist &lt;- island_colonist()
  get_clade_name(colonist)
  set_clade_name(colonist) &lt;- "abc"
  get_status(colonist)
  set_status(colonist) &lt;- "abc"
  get_missing_species(colonist)
  set_missing_species(colonist) &lt;- 0
  get_col_time(colonist)
  set_col_time(colonist) &lt;- 1
  get_col_max_age(colonist)
  set_col_max_age(colonist) &lt;- FALSE
  get_branching_times(colonist)
  set_branching_times(colonist) &lt;- 0
  get_min_age(colonist)
  set_min_age(colonist) &lt;- 0.1
  get_species(colonist)
  set_species(colonist) &lt;- "abc_a"
  get_clade_type(colonist)
  set_clade_type(colonist) &lt;- 1
</code></pre>

<hr>
<h2 id='get_endemic_species'>Checks whether the focal species (given by its tip lable in species_label
argument) is part of an endemic clade on the island and a vector of the
endemic species, either a single species for a singleton or multiple species
in an endemic clade.</h2><span id='topic+get_endemic_species'></span>

<h3>Description</h3>

<p>Checks whether the focal species (given by its tip lable in species_label
argument) is part of an endemic clade on the island and a vector of the
endemic species, either a single species for a singleton or multiple species
in an endemic clade.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_endemic_species(phylod, species_label)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_endemic_species_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="get_endemic_species_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named numeric vector
</p>

<hr>
<h2 id='get_island_tbl'>Accessor functions for the data (slots) in objects of the
<code><a href="#topic+Island_tbl-class">Island_tbl</a></code> class</h2><span id='topic+get_island_tbl'></span><span id='topic+get_island_tbl+2CIsland_tbl-method'></span><span id='topic+set_island_tbl+3C-'></span><span id='topic+set_island_tbl+3C-+2CIsland_tbl-method'></span><span id='topic+get_extracted_species'></span><span id='topic+get_extracted_species+2CIsland_tbl-method'></span><span id='topic+set_extracted_species+3C-'></span><span id='topic+set_extracted_species+3C-+2CIsland_tbl-method'></span><span id='topic+get_num_phylo_used'></span><span id='topic+get_num_phylo_used+2CIsland_tbl-method'></span><span id='topic+set_num_phylo_used+3C-'></span><span id='topic+set_num_phylo_used+3C-+2CIsland_tbl-method'></span>

<h3>Description</h3>

<p>Accessor functions for the data (slots) in objects of the
<code><a href="#topic+Island_tbl-class">Island_tbl</a></code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_island_tbl(x)

## S4 method for signature 'Island_tbl'
get_island_tbl(x)

set_island_tbl(x) &lt;- value

## S4 replacement method for signature 'Island_tbl'
set_island_tbl(x) &lt;- value

get_extracted_species(x)

## S4 method for signature 'Island_tbl'
get_extracted_species(x)

set_extracted_species(x) &lt;- value

## S4 replacement method for signature 'Island_tbl'
set_extracted_species(x) &lt;- value

get_num_phylo_used(x)

## S4 method for signature 'Island_tbl'
get_num_phylo_used(x)

set_num_phylo_used(x) &lt;- value

## S4 replacement method for signature 'Island_tbl'
set_num_phylo_used(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_island_tbl_+3A_x">x</code></td>
<td>
<p>An object whose class is determined by the signature.</p>
</td></tr>
<tr><td><code id="get_island_tbl_+3A_value">value</code></td>
<td>
<p>A value which can take several forms to be assigned to an object
of a class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Getter function (get_<em>) returns a data frame, the setter function
(set_</em>) returns the modified Island_tbl class.
</p>


<h3>Author(s)</h3>

<p>Joshua W. Lambert
</p>


<h3>Examples</h3>

<pre><code class='language-R'>island_tbl &lt;- island_tbl()
get_island_tbl(island_tbl)
set_island_tbl(island_tbl) &lt;- data.frame(
  clade_name = "birds",
  status = "endemic",
  missing_species = 0,
  branching_times = I(list(c(1.0, 0.5)))
)
</code></pre>

<hr>
<h2 id='get_sse_tip_states'>Extract tip states from a phylod object</h2><span id='topic+get_sse_tip_states'></span>

<h3>Description</h3>

<p>Extract tip states from a phylod object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sse_tip_states(phylod, sse_model = "musse")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_sse_tip_states_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="get_sse_tip_states_+3A_sse_model">sse_model</code></td>
<td>
<p>either &quot;musse&quot; (default) or &quot;geosse&quot;. MuSSE expects state
values 1, 2, 3, which here we encode as &quot;not_present&quot;, &quot;endemic&quot;,
&quot;nonendemic&quot;, respectively. GeoSSE expects trait values 0, 1, 2, with 0 the
widespread state (here, &quot;nonendemic&quot;), and 1 and 2 are &quot;not_present&quot; and
&quot;endemic&quot;, respectively.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an integer vector of tip states, as expected by SSE models
</p>

<hr>
<h2 id='is_back_colonisation'>Checks whether species has undergone back-colonisation from</h2><span id='topic+is_back_colonisation'></span>

<h3>Description</h3>

<p>Checks whether species has undergone back-colonisation from
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_back_colonisation(phylod, node_label)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_back_colonisation_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="is_back_colonisation_+3A_node_label">node_label</code></td>
<td>
<p>A numeric label for a node within a phylogeny.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string or FALSE. Character string is in the format
ancestral_node -&gt; focal_node, where the ancestral node is not on mainland
but the focal node is.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
3,
kind = "Mersenne-Twister",
normal.kind = "Inversion",
sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(5)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- c("endemic", "endemic", "not_present",
                       "endemic", "not_present")
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
phylod &lt;- add_asr_node_states(phylod = phylod, asr_method = "parsimony")
# aritificially modify data to produce back-colonisation
phylobase::tdata(phylod)$island_status[8] &lt;- "endemic"
# Example without back colonisation
is_back_colonisation(phylod = phylod, node_label = 2)
# Example with back colonisation
is_back_colonisation(phylod = phylod, node_label = 3)
</code></pre>

<hr>
<h2 id='is_duplicate_colonist'>Determines if colonist has already been stored in <code>Island_tbl</code> class. This is
used to stop endemic clades from being stored multiple times in the island
table by checking if the endemicity status and branching times are identical.</h2><span id='topic+is_duplicate_colonist'></span>

<h3>Description</h3>

<p>Determines if colonist has already been stored in <code>Island_tbl</code> class. This is
used to stop endemic clades from being stored multiple times in the island
table by checking if the endemicity status and branching times are identical.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_duplicate_colonist(island_colonist, island_tbl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_duplicate_colonist_+3A_island_colonist">island_colonist</code></td>
<td>
<p>An instance of the <code>Island_colonist</code> class.</p>
</td></tr>
<tr><td><code id="is_duplicate_colonist_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Boolean
</p>


<h3>Examples</h3>

<pre><code class='language-R'># with empty island_tbl
island_colonist &lt;- island_colonist(
  clade_name = "bird",
  status = "endemic",
  missing_species = 0,
  col_time = 1.0,
  col_max_age = FALSE,
  branching_times = 0.5,
  species = "bird_a",
  clade_type = 1
)
island_tbl &lt;- island_tbl()
is_duplicate_colonist(
  island_colonist = island_colonist,
  island_tbl = island_tbl
)

# with non-empty island_tbl
island_colonist &lt;- island_colonist(
  clade_name = "bird",
  status = "endemic",
  missing_species = 0,
  col_time = 1.0,
  col_max_age = FALSE,
  branching_times = 0.5,
  species = c("bird_a", "bird_b"),
  clade_type = 1
)
island_tbl &lt;- island_tbl()
island_tbl &lt;- bind_colonist_to_tbl(
  island_colonist = island_colonist,
  island_tbl = island_tbl
)
island_colonist &lt;- island_colonist(
  clade_name = "bird",
  status = "endemic",
  missing_species = 0,
  col_time = 1.0,
  col_max_age = FALSE,
  branching_times = 0.5,
  species = c("bird_a", "bird_b"),
  clade_type = 1
)
is_duplicate_colonist(
  island_colonist = island_colonist,
  island_tbl = island_tbl
)
</code></pre>

<hr>
<h2 id='is_identical_island_tbl'>Checks whether two <code>Island_tbl</code> objects are identical. If they are different
comparisons are made to report which components of the <code>Island_tbls</code> are
different.</h2><span id='topic+is_identical_island_tbl'></span>

<h3>Description</h3>

<p>Checks whether two <code>Island_tbl</code> objects are identical. If they are different
comparisons are made to report which components of the <code>Island_tbls</code> are
different.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_identical_island_tbl(island_tbl_1, island_tbl_2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_identical_island_tbl_+3A_island_tbl_1">island_tbl_1</code></td>
<td>
<p>An object of <code>Island_tbl</code> class to be comparedl</p>
</td></tr>
<tr><td><code id="is_identical_island_tbl_+3A_island_tbl_2">island_tbl_2</code></td>
<td>
<p>An object of <code>Island_tbl</code> class to be compared</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either TRUE or a character string with the differences
</p>


<h3>Examples</h3>

<pre><code class='language-R'>multi_island_tbl &lt;- multi_extract_island_species(
  multi_phylod = list(
    create_test_phylod(test_scenario = 1),
    create_test_phylod(test_scenario = 1)),
 extraction_method = "min")
is_identical_island_tbl(multi_island_tbl[[1]], multi_island_tbl[[2]])
</code></pre>

<hr>
<h2 id='is_multi_tip_species'>Checks if a species is represented in the tree has multiple tips and those
tips form a monophyletic group (i.e. one species with multiple samples) all
labeled as with the same endemicity status</h2><span id='topic+is_multi_tip_species'></span>

<h3>Description</h3>

<p>Checks if a species is represented in the tree has multiple tips and those
tips form a monophyletic group (i.e. one species with multiple samples) all
labeled as with the same endemicity status
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_multi_tip_species(phylod, species_label)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_multi_tip_species_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="is_multi_tip_species_+3A_species_label">species_label</code></td>
<td>
<p>The tip label of the species of interest.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+is_multi_tip_species">is_multi_tip_species()</a></code> only returns <code>TRUE</code> if all tips for each sample
of the species (i.e. conspecific tips) are labelled the same. It is
possible that a phylogeny has multiple tips for the same species but only
the island samples are labelled as <code>"endemic"</code> or <code>"nonendemic"</code> as the
other tips are from samples from the mainland, and are labelled
<code>"not_present"</code>, see
<code>vignette("Multi_tip_extraction", package = "DAISIEprep")</code>.
</p>


<h3>Value</h3>

<p>Boolean
</p>

<hr>
<h2 id='island_colonist'>Constructor for Island_colonist</h2><span id='topic+island_colonist'></span>

<h3>Description</h3>

<p>Constructor for Island_colonist
</p>


<h3>Usage</h3>

<pre><code class='language-R'>island_colonist(
  clade_name = NA_character_,
  status = NA_character_,
  missing_species = NA_real_,
  col_time = NA_real_,
  col_max_age = NA,
  branching_times = NA_real_,
  min_age = NA_real_,
  species = NA_character_,
  clade_type = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="island_colonist_+3A_clade_name">clade_name</code></td>
<td>
<p>Character name of the colonising clade.</p>
</td></tr>
<tr><td><code id="island_colonist_+3A_status">status</code></td>
<td>
<p>Character endemicity status of the colonising clade. Either
<code>"endemic"</code> or <code>"nonendemic"</code>.</p>
</td></tr>
<tr><td><code id="island_colonist_+3A_missing_species">missing_species</code></td>
<td>
<p>Numeric number of missing species from the phylogeny
that belong to the colonising clade. For a clade with missing species this
is <code class="reqn">n - 1</code>, where <code class="reqn">n</code> is the number of missing species in the clade.
If the clade is an island singleton, the number of missing species is <code>0</code>
because by adding the colonist it already counts as one automatically. If
the clade has more than one species, the <code>missing_species</code> is <code class="reqn">n - 1</code>
because adding the lineage already counts as one.</p>
</td></tr>
<tr><td><code id="island_colonist_+3A_col_time">col_time</code></td>
<td>
<p>Numeric with the colonisation time of the island colonist</p>
</td></tr>
<tr><td><code id="island_colonist_+3A_col_max_age">col_max_age</code></td>
<td>
<p>Boolean determining whether colonisation time should be
considered a precise time of colonisation or a maximum time of colonisation</p>
</td></tr>
<tr><td><code id="island_colonist_+3A_branching_times">branching_times</code></td>
<td>
<p>Numeric vector of one or more elements which are the
branching times on the island.</p>
</td></tr>
<tr><td><code id="island_colonist_+3A_min_age">min_age</code></td>
<td>
<p>Numeric minimum age (time before the present) that the species
must have colonised the island by. This is known when there is a branching
on the island, either in species or subspecies.</p>
</td></tr>
<tr><td><code id="island_colonist_+3A_species">species</code></td>
<td>
<p>Character vector of one or more elements containing the name
of the species included in the colonising clade.</p>
</td></tr>
<tr><td><code id="island_colonist_+3A_clade_type">clade_type</code></td>
<td>
<p>Numeric determining which type of clade the island colonist
is, this determines which macroevolutionary regime (parameter set) the island
colonist is in. After formatting the <code>island_tbl</code> to a DAISIE data list, the
clade type can be used to conduct a 2-type analysis (see
<a href="https://CRAN.R-project.org/package=DAISIE/vignettes/demo_optimize.html">https://CRAN.R-project.org/package=DAISIE/vignettes/demo_optimize.html</a>
for more information)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of <code>Island_colonist</code> class.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Without initial values
colonist &lt;- island_colonist()

# With initial values
colonist &lt;- island_colonist(
  clade_name = "bird",
  status = "endemic",
  missing_species = 0,
  col_time = 0.5,
  col_max_age = FALSE,
  branching_times = 0.5,
  min_age = NA_real_,
  species = "bird_a",
  clade_type = 1
)
</code></pre>

<hr>
<h2 id='Island_colonist-class'>Defines the <code>island_tbl</code> class which is used when extracting information
from the phylogenetic and island data to be used for constructing a
<code>daisie_data_tbl</code></h2><span id='topic+Island_colonist-class'></span>

<h3>Description</h3>

<p>Defines the <code>island_tbl</code> class which is used when extracting information
from the phylogenetic and island data to be used for constructing a
<code>daisie_data_tbl</code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>clade_name</code></dt><dd><p>character.</p>
</dd>
<dt><code>status</code></dt><dd><p>character.</p>
</dd>
<dt><code>missing_species</code></dt><dd><p>character.</p>
</dd>
<dt><code>col_time</code></dt><dd><p>numeric.</p>
</dd>
<dt><code>col_max_age</code></dt><dd><p>logical.</p>
</dd>
<dt><code>branching_times</code></dt><dd><p>numeric.</p>
</dd>
<dt><code>min_age</code></dt><dd><p>numeric.</p>
</dd>
<dt><code>species</code></dt><dd><p>character.</p>
</dd>
<dt><code>clade_type</code></dt><dd><p>numeric.</p>
</dd>
</dl>

<hr>
<h2 id='island_tbl'>Constructor function for <code>Island_tbl</code> class</h2><span id='topic+island_tbl'></span>

<h3>Description</h3>

<p>Constructor function for <code>Island_tbl</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>island_tbl()
</code></pre>


<h3>Value</h3>

<p>An Island_tbl object.
</p>

<hr>
<h2 id='Island_tbl-class'>Defines the <code>island_tbl</code> class which is used when extracting information
from the phylogenetic and island data to be used for constructing a
<code>daisie_data_tbl</code></h2><span id='topic+Island_tbl-class'></span>

<h3>Description</h3>

<p>Defines the <code>island_tbl</code> class which is used when extracting information
from the phylogenetic and island data to be used for constructing a
<code>daisie_data_tbl</code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>island_tbl</code></dt><dd><p>data frame.</p>
</dd>
<dt><code>metadata</code></dt><dd><p>list.</p>
</dd>
</dl>

<hr>
<h2 id='mimus_phylod'>A phylogenetic tree of mimus species with endemicity status as tip states.</h2><span id='topic+mimus_phylod'></span>

<h3>Description</h3>

<p>A phylogenetic tree of mimus species with endemicity status as tip states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mimus_phylod
</code></pre>


<h3>Format</h3>



<h4><code>mimus_phylod</code></h4>

<p>A <code>phylo4d</code> object (from the <span class="pkg">phylobase</span> package) with
29 tips and
28 internal
nodes.
</p>



<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>

<hr>
<h2 id='multi_extract_island_species'>Extracts the colonisation, diversification, and endemicty data from multiple
<code>phylod</code> (<code>phylo4d</code> class from <code>phylobase</code>) objects (composed of phylogenetic
and endemicity data) and stores each in an <code>Island_tbl</code> object which are
stored in a <code>Multi_island_tbl</code> object.</h2><span id='topic+multi_extract_island_species'></span>

<h3>Description</h3>

<p>Extracts the colonisation, diversification, and endemicty data from multiple
<code>phylod</code> (<code>phylo4d</code> class from <code>phylobase</code>) objects (composed of phylogenetic
and endemicity data) and stores each in an <code>Island_tbl</code> object which are
stored in a <code>Multi_island_tbl</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_extract_island_species(
  multi_phylod,
  extraction_method,
  island_tbl = NULL,
  include_not_present = FALSE,
  verbose = FALSE,
  unique_clade_name = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi_extract_island_species_+3A_multi_phylod">multi_phylod</code></td>
<td>
<p>A list of phylod objects.</p>
</td></tr>
<tr><td><code id="multi_extract_island_species_+3A_extraction_method">extraction_method</code></td>
<td>
<p>A character string specifying whether the
colonisation time extracted is the minimum time (<code>min</code>) (before the present),
or the most probable time under ancestral state reconstruction (<code>asr</code>).</p>
</td></tr>
<tr><td><code id="multi_extract_island_species_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="multi_extract_island_species_+3A_include_not_present">include_not_present</code></td>
<td>
<p>A boolean determining whether species not present
on the island should be included in island colonist when embedded within an
island clade. Default is FALSE.</p>
</td></tr>
<tr><td><code id="multi_extract_island_species_+3A_verbose">verbose</code></td>
<td>
<p>Boolean. States if intermediate results should be printed to
console. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="multi_extract_island_species_+3A_unique_clade_name">unique_clade_name</code></td>
<td>
<p>Boolean determining whether a unique species
identifier is used as the clade name in the Island_tbl object or a genus
name which may not be unique if that genus has several independent island
colonisations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>Multi_island_tbl</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>multi_phylod &lt;- list()
multi_phylod[[1]] &lt;- create_test_phylod(test_scenario = 1)
multi_phylod[[2]] &lt;- create_test_phylod(test_scenario = 2)
multi_island_tbl &lt;- multi_extract_island_species(
  multi_phylod = multi_phylod,
  extraction_method = "min",
  island_tbl = NULL,
  include_not_present = FALSE
)
</code></pre>

<hr>
<h2 id='multi_island_tbl'>Constructor function for <code>Multi_island_tbl</code> class</h2><span id='topic+multi_island_tbl'></span>

<h3>Description</h3>

<p>Constructor function for <code>Multi_island_tbl</code> class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_island_tbl()
</code></pre>


<h3>Value</h3>

<p>A Multi_island_tbl object.
</p>

<hr>
<h2 id='Multi_island_tbl-class'>Defines the <code>Multi_island_tbl</code> class which is multiple <code>Island_tbl</code>s.</h2><span id='topic+Multi_island_tbl-class'></span>

<h3>Description</h3>

<p>Defines the <code>Multi_island_tbl</code> class which is multiple <code>Island_tbl</code>s.
</p>


<h3>Slots</h3>


<dl>
<dt><code>.Data</code></dt><dd><p>a list of <code>Island_tbl</code>.</p>
</dd>
</dl>

<hr>
<h2 id='myiarchus_phylod'>A phylogenetic tree of myiarchus species with endemicity status as tip states.</h2><span id='topic+myiarchus_phylod'></span>

<h3>Description</h3>

<p>A phylogenetic tree of myiarchus species with endemicity status as tip states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myiarchus_phylod
</code></pre>


<h3>Format</h3>



<h4><code>myiarchus_phylod</code></h4>

<p>A <code>phylo4d</code> object (from the <span class="pkg">phylobase</span> package) with
13 tips and
12 internal
nodes.
</p>



<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>

<hr>
<h2 id='plant_phylo'>A phylogenetic tree of plant species.</h2><span id='topic+plant_phylo'></span>

<h3>Description</h3>

<p>This is a mock dataset for demonstrating the <span class="pkg">DAISIEprep</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plant_phylo
</code></pre>


<h3>Format</h3>



<h4><code>plant_phylo</code></h4>

<p>A <code>phylo</code> object (from the <span class="pkg">ape</span> package) with 10 tips and 9 internal
nodes. Each tip label is formatted <code>"Plant_*"</code> with the letters <code>a</code>, <code>b</code>,
etc. used as species names.
</p>


<hr>
<h2 id='plot_colonisation'>Plots a dot plot (cleveland dot plot when include_crown_age = TRUE) of the
stem and potentially crown ages of a community of island colonists.</h2><span id='topic+plot_colonisation'></span>

<h3>Description</h3>

<p>Plots a dot plot (cleveland dot plot when include_crown_age = TRUE) of the
stem and potentially crown ages of a community of island colonists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_colonisation(island_tbl, island_age, include_crown_age = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_colonisation_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="plot_colonisation_+3A_island_age">island_age</code></td>
<td>
<p>Age of the island in appropriate units.</p>
</td></tr>
<tr><td><code id="plot_colonisation_+3A_include_crown_age">include_crown_age</code></td>
<td>
<p>A boolean determining whether the crown age gets
plotted with the stem age.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggplot</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- sample(
  c("not_present", "endemic", "nonendemic"),
  size = length(phylobase::tipLabels(phylo)),
  replace = TRUE,
  prob = c(0.6, 0.2, 0.2)
)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
island_tbl &lt;- extract_island_species(phylod, extraction_method = "min")
plot_colonisation(island_tbl, island_age = 2)
</code></pre>

<hr>
<h2 id='plot_performance'>Plots performance results for a grouping variable (prob_on_island or
prob_endemic).</h2><span id='topic+plot_performance'></span>

<h3>Description</h3>

<p>Plots performance results for a grouping variable (prob_on_island or
prob_endemic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_performance(performance_data, group_by)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_performance_+3A_performance_data">performance_data</code></td>
<td>
<p>Tibble of collated performance results</p>
</td></tr>
<tr><td><code id="plot_performance_+3A_group_by">group_by</code></td>
<td>
<p>A variable to partition by for plotting. Uses data masking
so variable does not need to be quoted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object
</p>

<hr>
<h2 id='plot_phylod'>Plots the phylogenetic tree and its associated tip and/or node data</h2><span id='topic+plot_phylod'></span>

<h3>Description</h3>

<p>Plots the phylogenetic tree and its associated tip and/or node data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_phylod(phylod, node_pies = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_phylod_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="plot_phylod_+3A_node_pies">node_pies</code></td>
<td>
<p>Boolean determining if pie charts of the probabilities of
a species being present on the island. If TRUE the correct data is required
in the phylod object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggplot</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(
  1,
  kind = "Mersenne-Twister",
  normal.kind = "Inversion",
  sample.kind = "Rejection"
)
phylo &lt;- ape::rcoal(10)
phylo$tip.label &lt;- c("bird_a", "bird_b", "bird_c", "bird_d", "bird_e",
                     "bird_f", "bird_g", "bird_h", "bird_i", "bird_j")
phylo &lt;- phylobase::phylo4(phylo)
endemicity_status &lt;- sample(
  c("not_present", "endemic", "nonendemic"),
  size = length(phylobase::tipLabels(phylo)),
  replace = TRUE,
  prob = c(0.6, 0.2, 0.2)
)
phylod &lt;- phylobase::phylo4d(phylo, as.data.frame(endemicity_status))
plot_phylod(phylod)
</code></pre>

<hr>
<h2 id='plot_sensitivity'>Plots</h2><span id='topic+plot_sensitivity'></span>

<h3>Description</h3>

<p>Plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sensitivity(sensitivity_data, pairwise_diffs = FALSE)
</code></pre>


<h3>Value</h3>

<p>ggplot2 object
</p>

<hr>
<h2 id='progne_phylod'>A phylogenetic tree of progne species with endemicity status as tip states.</h2><span id='topic+progne_phylod'></span>

<h3>Description</h3>

<p>A phylogenetic tree of progne species with endemicity status as tip states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>progne_phylod
</code></pre>


<h3>Format</h3>



<h4><code>progne_phylod</code></h4>

<p>A <code>phylo4d</code> object (from the <span class="pkg">phylobase</span> package) with
19 tips and
18 internal
nodes.
</p>



<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>

<hr>
<h2 id='pyrocephalus_phylod'>A phylogenetic tree of pyrocephalus species with endemicity status as
tip states.</h2><span id='topic+pyrocephalus_phylod'></span>

<h3>Description</h3>

<p>A phylogenetic tree of pyrocephalus species with endemicity status as
tip states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pyrocephalus_phylod
</code></pre>


<h3>Format</h3>



<h4><code>pyrocephalus_phylod</code></h4>

<p>A <code>phylo4d</code> object (from the <span class="pkg">phylobase</span> package) with
66 tips and
65 internal
nodes.
</p>



<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>

<hr>
<h2 id='read_performance'>Reads in performance analysis results from inst/performance_data and formats
the data ready for plotting</h2><span id='topic+read_performance'></span>

<h3>Description</h3>

<p>Reads in performance analysis results from inst/performance_data and formats
the data ready for plotting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_performance()
</code></pre>


<h3>Value</h3>

<p>List of two data frames
</p>

<hr>
<h2 id='read_sensitivity'>Reads in the results from the sensitivity analysis saved in the
inst/sensitivity_data folder</h2><span id='topic+read_sensitivity'></span>

<h3>Description</h3>

<p>Reads in the results from the sensitivity analysis saved in the
inst/sensitivity_data folder
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_sensitivity()
</code></pre>


<h3>Value</h3>

<p>List of of lists with parameter estimates for the mammal DNA-only
phylogeny, mammal complete phylogeny and the parameter set used
</p>

<hr>
<h2 id='rm_duplicate_island_species'>Remove any duplicated species from the <code>island_tbl</code> after <code>"asr"</code> extraction</h2><span id='topic+rm_duplicate_island_species'></span>

<h3>Description</h3>

<p>Removes any duplicates species from the <code>island_tbl</code> by choosing to either
have duplicated species be in smaller, more recently colonised clade(s) and
removing them from the larger, older clade(s)
(<code>nested_asr_species = "split"</code>), or removing the smaller, more recently
colonised clade(s) in favour of leaving them in the larger, older clade(s)
(<code>nested_asr_species = "group"</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rm_duplicate_island_species(
  island_tbl,
  phylod,
  nested_asr_species,
  include_not_present
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rm_duplicate_island_species_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="rm_duplicate_island_species_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="rm_duplicate_island_species_+3A_nested_asr_species">nested_asr_species</code></td>
<td>
<p>A <code>character</code> string which determines whether
<em>nested island colonists</em> are split into separate colonists (<code>"split"</code>), or
grouped into a single clade (<code>"group"</code>). Nested species are those whose tip
state is on the island, and they have ancestral nodes on the island, but
there are nodes in between these island state nodes that have the state
<code>not_present</code> (i.e. not on the island). Therefore, the colonisation time
can be extracted as the most recent node state on the island (this can be
the branching time before the tip if the ancestor node of the tip is not
on the island), or the older node state of the larger clade, for <code>"split"</code>
or <code>"group"</code> respectively. <strong>Note</strong> This argument only applies when
<code>extraction_method = "asr"</code>.</p>
</td></tr>
<tr><td><code id="rm_duplicate_island_species_+3A_include_not_present">include_not_present</code></td>
<td>
<p>A boolean determining whether species not present
on the island should be included in island colonist when embedded within an
island clade. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>Island_tbl</code> class
</p>

<hr>
<h2 id='rm_island_colonist'>Removes an island colonist from an <code>Island_tbl</code> object</h2><span id='topic+rm_island_colonist'></span>

<h3>Description</h3>

<p>Removes an island colonist from an <code>Island_tbl</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rm_island_colonist(island_tbl, clade_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rm_island_colonist_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
<tr><td><code id="rm_island_colonist_+3A_clade_name">clade_name</code></td>
<td>
<p>Character name of the colonising clade.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of <code>Island_tbl</code> class
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phylod &lt;- create_test_phylod(test_scenario = 1)
island_tbl &lt;- extract_island_species(
  phylod = phylod,
  extraction_method = "min"
)
island_tbl &lt;- rm_island_colonist(
  island_tbl = island_tbl,
  clade_name = "bird_b"
)
</code></pre>

<hr>
<h2 id='rm_multi_missing_species'>Loops through the genera that have missing species and removes the ones that
are found in the missing genus list which have phylogenetic data. This is
useful when wanting to know which missing species have not been assigned to
the island_tbl using <code>add_multi_missing_species()</code>.</h2><span id='topic+rm_multi_missing_species'></span>

<h3>Description</h3>

<p>Loops through the genera that have missing species and removes the ones that
are found in the missing genus list which have phylogenetic data. This is
useful when wanting to know which missing species have not been assigned to
the island_tbl using <code>add_multi_missing_species()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rm_multi_missing_species(missing_species, missing_genus, island_tbl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rm_multi_missing_species_+3A_missing_species">missing_species</code></td>
<td>
<p>Numeric number of missing species from the phylogeny
that belong to the colonising clade. For a clade with missing species this
is <code class="reqn">n - 1</code>, where <code class="reqn">n</code> is the number of missing species in the clade.
If the clade is an island singleton, the number of missing species is <code>0</code>
because by adding the colonist it already counts as one automatically. If
the clade has more than one species, the <code>missing_species</code> is <code class="reqn">n - 1</code>
because adding the lineage already counts as one.</p>
</td></tr>
<tr><td><code id="rm_multi_missing_species_+3A_missing_genus">missing_genus</code></td>
<td>
<p>A list of character vectors containing the genera in
each island clade</p>
</td></tr>
<tr><td><code id="rm_multi_missing_species_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phylod &lt;- create_test_phylod(test_scenario = 6)
island_tbl &lt;- suppressWarnings(extract_island_species(
 phylod = phylod,
 extraction_method = "asr",
))
phylod &lt;- create_test_phylod(test_scenario = 7)
island_tbl &lt;- suppressWarnings(extract_island_species(
 phylod = phylod,
 extraction_method = "asr",
 island_tbl = island_tbl
))
missing_species &lt;- data.frame(
  clade_name = "bird",
  missing_species = 1,
  endemicity_status = "endemic"
)
missing_genus &lt;- list("bird", character(0))
rm_missing_species &lt;- rm_multi_missing_species(
  missing_species = missing_species,
  missing_genus = missing_genus,
  island_tbl = island_tbl
)
</code></pre>

<hr>
<h2 id='round_up'>Rounds numbers using the round up method, rather than the round to the
nearest even number method used by the base function <code>round</code>.</h2><span id='topic+round_up'></span>

<h3>Description</h3>

<p>Rounds numbers using the round up method, rather than the round to the
nearest even number method used by the base function <code>round</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>round_up(n, digits = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="round_up_+3A_n">n</code></td>
<td>
<p>A numeric to be rounded.</p>
</td></tr>
<tr><td><code id="round_up_+3A_digits">digits</code></td>
<td>
<p>A numeric specifying which decimal places to round to</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric
</p>

<hr>
<h2 id='select_endemicity_status'>Select endemicity status from ancestral states probabilities</h2><span id='topic+select_endemicity_status'></span>

<h3>Description</h3>

<p>Selects a state for each node (both internal nodes, i.e. ancestral states,
and tips, if included) from a table of probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_endemicity_status(asr_df, method = "max")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_endemicity_status_+3A_asr_df">asr_df</code></td>
<td>
<p>a data frame containing at least these three columns:
not_present_prob | endemic_prob | nonendemic_prob (in any order). Each column
should contain the estimated probability of the state for each node (rows)
and these columns should sum to 1.</p>
</td></tr>
<tr><td><code id="select_endemicity_status_+3A_method">method</code></td>
<td>
<p>&quot;max&quot; or &quot;random&quot;. &quot;max&quot; will select the state with highest
probability (selecting last state in event of a tie), while &quot;random&quot; will
sample the states randomly with the probabilities as weight for each state.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character vector, with the selected endemicity status for each
node.
</p>

<hr>
<h2 id='sensitivity'>Runs a sensitivity analysis to test the influences of changing the data
on the parameter estimates for the DAISIE maximum likelihood inference model</h2><span id='topic+sensitivity'></span>

<h3>Description</h3>

<p>Runs a sensitivity analysis to test the influences of changing the data
on the parameter estimates for the DAISIE maximum likelihood inference model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity(
  phylo,
  island_species,
  extraction_method,
  asr_method,
  tie_preference,
  island_age,
  num_mainland_species,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sensitivity_+3A_phylo">phylo</code></td>
<td>
<p>A phylogeny either as a <code>phylo</code> (from the <code>ape</code> package) or
<code>phylo4</code> (from the <code>phylobase</code> package) object.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_island_species">island_species</code></td>
<td>
<p>Data frame with two columns. The first is a character
string of the tip_labels with the tip names of the species on the island.
The second column a character string of the endemicity status of the species,
either endemic or nonendemic.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_extraction_method">extraction_method</code></td>
<td>
<p>A character string specifying whether the
colonisation time extracted is the minimum time (<code>min</code>) (before the present),
or the most probable time under ancestral state reconstruction (<code>asr</code>).</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_asr_method">asr_method</code></td>
<td>
<p>A character string, either &quot;parsimony&quot; or &quot;mk&quot; determines
whether a maximum parsimony or continuous-time markov model reconstructs the
ancestral states at each node. See documentation in
<code><a href="castor.html#topic+asr_max_parsimony">castor::asr_max_parsimony()</a></code> or <code><a href="castor.html#topic+asr_mk_model">castor::asr_mk_model()</a></code> in <code>castor</code> R
package for details on the methods used.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_tie_preference">tie_preference</code></td>
<td>
<p>Character string, either &quot;island&quot; or &quot;mainland&quot; to
choose the most probable state at each node using the <code>max.col()</code> function.
When a node has island presence and absence equally probable we need to
decide whether that species should be considered on the island. To consider
it on the island use <code>ties.method = "last"</code> in the <code>max.col()</code> function, if
you consider it not on the island use <code>ties.method = "first"</code>. Default is
&quot;island&quot;.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_island_age">island_age</code></td>
<td>
<p>Age of the island in appropriate units.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_num_mainland_species">num_mainland_species</code></td>
<td>
<p>The size of the mainland pool, i.e. the number
of species that can potentially colonise the island.</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_verbose">verbose</code></td>
<td>
<p>Boolean. States if intermediate results should be printed to
console. Defaults to FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame of parameter estimates and the parameter setting used
when inferring them
</p>

<hr>
<h2 id='setophaga_phylod'>A phylogenetic tree of setophaga species with endemicity status as
tip states.</h2><span id='topic+setophaga_phylod'></span>

<h3>Description</h3>

<p>A phylogenetic tree of setophaga species with endemicity status as
tip states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setophaga_phylod
</code></pre>


<h3>Format</h3>



<h4><code>setophaga_phylod</code></h4>

<p>A <code>phylo4d</code> object (from the <span class="pkg">phylobase</span> package) with
19 tips and
18 internal
nodes.
</p>



<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>

<hr>
<h2 id='sse_states_to_endemicity'>Convert SSE states back to endemicity status</h2><span id='topic+sse_states_to_endemicity'></span>

<h3>Description</h3>

<p>Convert SSE states back to endemicity status
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sse_states_to_endemicity(states, sse_model = "musse")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sse_states_to_endemicity_+3A_states">states</code></td>
<td>
<p>integer vector of tip states, as expected by SSE models</p>
</td></tr>
<tr><td><code id="sse_states_to_endemicity_+3A_sse_model">sse_model</code></td>
<td>
<p>either &quot;musse&quot; (default) or &quot;geosse&quot;. MuSSE expects state
values 1, 2, 3, which here we encode as &quot;not_present&quot;, &quot;endemic&quot;,
&quot;nonendemic&quot;, respectively. GeoSSE expects trait values 0, 1, 2, with 0 the
widespread state (here, &quot;nonendemic&quot;), and 1 and 2 are &quot;not_present&quot; and
&quot;endemic&quot;, respectively.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector with values &quot;endemic&quot;, &quot;nonendemic&quot; and/or
&quot;not_present&quot;
</p>

<hr>
<h2 id='translate_status'>Takes a string of the various ways the island species status can be and
returns a uniform all lower-case string of the same status to make handling
statuses easier in other function</h2><span id='topic+translate_status'></span>

<h3>Description</h3>

<p>Takes a string of the various ways the island species status can be and
returns a uniform all lower-case string of the same status to make handling
statuses easier in other function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>translate_status(status)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="translate_status_+3A_status">status</code></td>
<td>
<p>Character endemicity status of the colonising clade. Either
<code>"endemic"</code> or <code>"nonendemic"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>translate_status("Endemic")
</code></pre>

<hr>
<h2 id='unique_island_genera'>Determines the unique endemic genera that are included in the island clades
contained within the island_tbl object and stores them as a list with each
genus only occuring once in the first island clade it appears in</h2><span id='topic+unique_island_genera'></span>

<h3>Description</h3>

<p>Determines the unique endemic genera that are included in the island clades
contained within the island_tbl object and stores them as a list with each
genus only occuring once in the first island clade it appears in
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unique_island_genera(island_tbl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unique_island_genera_+3A_island_tbl">island_tbl</code></td>
<td>
<p>An instance of the <code>Island_tbl</code> class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of character vectors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phylod &lt;- create_test_phylod(test_scenario = 6)
island_tbl &lt;- suppressWarnings(extract_island_species(
  phylod = phylod,
  extraction_method = "asr",
))
phylod &lt;- create_test_phylod(test_scenario = 7)
island_tbl &lt;- suppressWarnings(extract_island_species(
  phylod = phylod,
  extraction_method = "asr",
  island_tbl = island_tbl
))
unique_genera &lt;- unique_island_genera(island_tbl = island_tbl)
</code></pre>

<hr>
<h2 id='write_biogeobears_input'>Write input files for BioGeoBEARS</h2><span id='topic+write_biogeobears_input'></span>

<h3>Description</h3>

<p>Write input files for a BioGeoBEARS analysis, i.e. a phlyogenetic tree in
Newick format and occurrence data in PHYLIP format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_biogeobears_input(phylod, path_to_phylo, path_to_biogeo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_biogeobears_input_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="write_biogeobears_input_+3A_path_to_phylo">path_to_phylo</code></td>
<td>
<p>string specifying the path and name to write the phylogeny file to.</p>
</td></tr>
<tr><td><code id="write_biogeobears_input_+3A_path_to_biogeo">path_to_biogeo</code></td>
<td>
<p>string specifying the path and name to write the biogeography file to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for side-effects
</p>

<hr>
<h2 id='write_newick_file'>Write tree input file for BioGeoBEARS</h2><span id='topic+write_newick_file'></span>

<h3>Description</h3>

<p>Write a text file containing a phylogenetic tree in the Newick format
expected by BioGeoBEARS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_newick_file(phylod, path_to_phylo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_newick_file_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="write_newick_file_+3A_path_to_phylo">path_to_phylo</code></td>
<td>
<p>string specifying the path and name to write the file to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for side-effects.
</p>

<hr>
<h2 id='write_phylip_biogeo_file'>Write biogeography input file for BioGeoBEARS</h2><span id='topic+write_phylip_biogeo_file'></span>

<h3>Description</h3>

<p>Write a text file containing occurrence data for all tips in the PHYLIP
format expected by BioGeoBEARS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_phylip_biogeo_file(phylod, path_to_biogeo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_phylip_biogeo_file_+3A_phylod">phylod</code></td>
<td>
<p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p>
</td></tr>
<tr><td><code id="write_phylip_biogeo_file_+3A_path_to_biogeo">path_to_biogeo</code></td>
<td>
<p>string specifying the path and name to write the file
to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, called for side-effects.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
