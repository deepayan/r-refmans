<!DOCTYPE html><html><head><title>Help for package nphPower</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nphPower}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cal_event'><p>Event Rate Calculation</p></a></li>
<li><a href='#cureHR'><p>Control hazard and hazard ratio generation function</p></a></li>
<li><a href='#evalfup'><p>Visualization of the Relationship between Follow-up and Sample Size</p></a></li>
<li><a href='#gen.wgt'><p>Weight Function Generation</p></a></li>
<li><a href='#lung'><p>Lung cancer data set</p></a></li>
<li><a href='#MaxLRtest'><p>Maximum Weighted Logrank Test</p></a></li>
<li><a href='#n2pwr.NPH'><p>Power Calculation with Combination Test</p></a></li>
<li><a href='#plot.MaxLR'><p>Graphical Display of Weight Functions</p></a></li>
<li><a href='#plot.NPHpwr'><p>Graphical Display of Design Parameters in Sample Size</p>
Calculation</a></li>
<li><a href='#plotHazSurv'><p>Graphic Display of Hazard and Survival Function</p></a></li>
<li><a href='#projection.test'><p>Projection test</p></a></li>
<li><a href='#pwr2n.LR'><p>Sample Size Calculation under Proportional Hazards</p></a></li>
<li><a href='#pwr2n.NPH'><p>Sample Size Calculation with Combination Test</p></a></li>
<li><a href='#simu.trial'><p>Simulate Survival Trial Data</p></a></li>
<li><a href='#summary.NPHpwr'><p>Summary of the <code>pwr2n.NPH</code> function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Sample Size Calculation under Non-Proportional Hazards</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs combination tests and sample size calculation for 
   fixed design with survival endpoints using combination tests under either
   proportional hazards or non-proportional hazards. The combination tests 
   include maximum weighted log-rank test and projection test. The sample 
   size calculation procedure is very flexible, allowing for user-defined
   hazard ratio function and considering various trial conditions like 
   staggered entry, drop-out etc. The sample size calculation also applies to 
   various cure models such as proportional hazards cure model, cure model with
   (random) delayed treatments effects. Trial simulation function is also provided 
   to facilitate the empirical power calculation. The references for 
   projection test and maximum weighted logrank test include Brendel et al. (2014)
   &lt;<a href="https://doi.org/10.1111%2Fsjos.12059">doi:10.1111/sjos.12059</a>&gt; and Cheng and He (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2110.03833">doi:10.48550/arXiv.2110.03833</a>&gt;. The 
   references for sample size calculation under proportional hazard include
   Schoenfeld (1981) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2F68.1.316">doi:10.1093/biomet/68.1.316</a>&gt; and Freedman (1982) &lt;<a href="https://doi.org/10.1002%2Fsim.4780010204">doi:10.1002/sim.4780010204</a>&gt;.
   The references for calculation under non-proportional hazards include 
   Lakatos (1988) &lt;<a href="https://doi.org/10.2307%2F2531910">doi:10.2307/2531910</a>&gt; and Cheng and He (2023) &lt;<a href="https://doi.org/10.1002%2Fbimj.202100403">doi:10.1002/bimj.202100403</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, stats, mvtnorm, MASS, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hcheng99/nphPower">https://github.com/hcheng99/nphPower</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-27 14:26:33 UTC; huan.cheng</td>
</tr>
<tr>
<td>Author:</td>
<td>Huan Cheng <a href="https://orcid.org/0000-0002-2552-7656"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Huan Cheng &lt;hcheng1118@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-28 08:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cal_event'>Event Rate Calculation</h2><span id='topic+cal_event'></span>

<h3>Description</h3>

<p>Calculate the event rate given the hazards and drop-out
distribution parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cal_event(ratio, lambda1, lambda0, entry, fup, l_shape, l_scale)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cal_event_+3A_ratio">ratio</code></td>
<td>
<p>allocation ratio</p>
</td></tr>
<tr><td><code id="cal_event_+3A_lambda1">lambda1</code></td>
<td>
<p>hazard rate for treatment group</p>
</td></tr>
<tr><td><code id="cal_event_+3A_lambda0">lambda0</code></td>
<td>
<p>hazard rate for control group</p>
</td></tr>
<tr><td><code id="cal_event_+3A_entry">entry</code></td>
<td>
<p>enrollment period time</p>
</td></tr>
<tr><td><code id="cal_event_+3A_fup">fup</code></td>
<td>
<p>follow-up period time</p>
</td></tr>
<tr><td><code id="cal_event_+3A_l_shape">l_shape</code></td>
<td>
<p>shape parameter of weibull distribution for drop-out</p>
</td></tr>
<tr><td><code id="cal_event_+3A_l_scale">l_scale</code></td>
<td>
<p>scale parameter of weibull distribution for drop-out</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The event rate is calculated based on the following assumptions: 1)
patients are uniformly enrolled within <code>entry</code> time; 2) survival
times for treatment and control are from exponential distribution; 3)
the drop-out times for treatment and control follow the weibull distribution.
The final rate is obtained via numeric integration:
</p>
<p style="text-align: center;"><code class="reqn">
P=\int_{t_{fup}}^{t_{enrl}+t_{fup}} \Big \{
\int_0^{t}r(u)exp\big [-\int_0^u[r(x)+l(x)]dx \big]d(u) \Big \}
\frac{1}{t_{enrl}} dt
</code>
</p>

<p>where <code class="reqn">r(x)</code> is the hazard of event and <code class="reqn">l(x)</code> is the hazard
of drop-out; <code class="reqn">t_{enrl}</code> is the entry time and <code class="reqn">t_{fup}</code> is the
follow-up duration.
</p>


<h3>Value</h3>

<p>a list of components:
</p>
<table>
<tr><td><code>ep1</code></td>
<td>
<p>event rate for treatment group</p>
</td></tr>
<tr><td><code>ep0</code></td>
<td>
<p>event rate for control group</p>
</td></tr>
<tr><td><code>ep</code></td>
<td>
<p>mean event rate weighted by the randomization ratio</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># median survival time for treatment and control: 16 months vs 12  months
# entry time: 12 months ; follow-up time: 18 months
# the shape parameter for weibull drop-out : 0.5
# median time for drop-out : 48 =&gt;
# scale parameter: 48/log(2)^(1/0.5)=100
  RR &lt;- 1; l1 &lt;- log(2)/16; l0 &lt;- log(2)/12
  t_enrl &lt;- 12; t_fup &lt;- 18

  cal_event(1,l1,l0,t_enrl,t_fup,0.5,100)
</code></pre>

<hr>
<h2 id='cureHR'>Control hazard and hazard ratio generation function</h2><span id='topic+cureHR'></span>

<h3>Description</h3>

<p>Generate control hazard and hazard ratio function used for sample size calculation for cure model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cureHR(pi0, pi1 = NULL, k0, lmd0, theta, HRType, tchg = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cureHR_+3A_pi0">pi0</code></td>
<td>
<p>cure rate for the control group</p>
</td></tr>
<tr><td><code id="cureHR_+3A_pi1">pi1</code></td>
<td>
<p>cure rate for the treatment group, Default: NULL</p>
</td></tr>
<tr><td><code id="cureHR_+3A_k0">k0</code></td>
<td>
<p>shape parameter of the Weibull distribution for the control group</p>
</td></tr>
<tr><td><code id="cureHR_+3A_lmd0">lmd0</code></td>
<td>
<p>rate parameter of the Weibull distribution for the control group</p>
</td></tr>
<tr><td><code id="cureHR_+3A_theta">theta</code></td>
<td>
<p>hazard ratio function</p>
</td></tr>
<tr><td><code id="cureHR_+3A_hrtype">HRType</code></td>
<td>
<p>hazard ratio function type. <code>susceptible</code> indicates the hazard
ratio function applies to the susceptible only; <code>overall</code> indicates the hazard
ratio function applies to the overall population; <code>delayed</code> indicates a cure model
with delayed treatment effects. See details.</p>
</td></tr>
<tr><td><code id="cureHR_+3A_tchg">tchg</code></td>
<td>
<p>delayed timepoint for <code>HRType</code> = <code>delayed</code>, Default: NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DETAILS
The control group has a survival function of <code class="reqn">S_o0=\pi_0+(1-\pi_0)S_0</code>,where
<code class="reqn">\pi_0</code> is the cure rate and <code class="reqn">S_0</code> is the survival function for the susceptible
population. For <code>HRType</code> = <code>susceptible</code>, the user also needs to provide
the cure rate for the experimental group. The provided hazard ratio applies to the susceptible
population only. The returned hazard ratio function is the overall one. For <code>HRType</code>=<code>delayed</code>,
the returned hazard ratio is derived based on the paper of Wei and Wu (2020) .
</p>


<h3>Value</h3>

<p>a list of components including
</p>
<table>
<tr><td><code>ctrl_hr</code></td>
<td>
<p>a hazard function for the control group</p>
</td></tr>
<tr><td><code>hr</code></td>
<td>
<p>a hazard ratio function</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wei, J. and Wu, J., 2020. Cancer immunotherapy trial design with
cure rate and delayed treatment effect. Statistics in medicine, 39(6), pp.698-708.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+integrate">integrate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p0 &lt;- 0.2; p1 &lt;- 0.3; param &lt;- c(1, log(2)/12);
theta_eg &lt;-function(t){t^0*0.7}
fit &lt;- cureHR(p0, p1, param[1], param[2],theta_eg, HRType="susceptible")
# with delayed effects
theta_eg2 &lt;- function(t){(t&lt;=9)+(t&gt;9)*0.7}
fit2 &lt;- cureHR(p0, p1, param[1], param[2],theta_eg2, HRType="delayed", tchg=9)
</code></pre>

<hr>
<h2 id='evalfup'>Visualization of the Relationship between Follow-up and Sample Size</h2><span id='topic+evalfup'></span>

<h3>Description</h3>

<p><code>evalfup</code> function displays the graph showing the relationship
between the follow-up time and the total sample size/event number required to
achieve the the same power
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalfup(
  object,
  lower.time,
  upper.time,
  size,
  increment = 0.5,
  xlabel = "Follow-up Time",
  ylabel = "Total Sample Size/Event Number",
  title = "Relationship between Follow-up and \n Total Sample Size"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evalfup_+3A_object">object</code></td>
<td>
<p>returned object by function <code>pwr2n.NPH</code></p>
</td></tr>
<tr><td><code id="evalfup_+3A_lower.time">lower.time</code></td>
<td>
<p>a numeric value specifying the shortest duration time</p>
</td></tr>
<tr><td><code id="evalfup_+3A_upper.time">upper.time</code></td>
<td>
<p>a numeric value specifying the longest duration time</p>
</td></tr>
<tr><td><code id="evalfup_+3A_size">size</code></td>
<td>
<p>an integer specifying the planned total sample size</p>
</td></tr>
<tr><td><code id="evalfup_+3A_increment">increment</code></td>
<td>
<p>a numeric value specifying an increment number used for creating
a sequence of duration times in plotting, Default: 0.5</p>
</td></tr>
<tr><td><code id="evalfup_+3A_xlabel">xlabel</code></td>
<td>
<p>a text for labeling the x axis in the plot, Default: 'Follow-up Time'</p>
</td></tr>
<tr><td><code id="evalfup_+3A_ylabel">ylabel</code></td>
<td>
<p>a text for labeling the y axis in the plot, Default: 'Total Sample Size'</p>
</td></tr>
<tr><td><code id="evalfup_+3A_title">title</code></td>
<td>
<p>a text for title in the plot: 'Relationship between Follow-up and
Total Sample Size'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>evalfun</code> function helps to evaluate the relationship between
sample size/event number and follow-up duration. It retrieves the trial
design information from the <code>object</code> returned by <code>pwr2n.NPH</code>
function. A sequence of follow-up times starting from <code>lower.time</code>
and ending with <code>upper.time</code> are generated. The number of subjects and
number of events required for achieving the specified power in <code>object</code>
are calculated at each time point. An interpolation function <code>approx</code>
from <span class="pkg">stats</span> is applied to smooth the curves. In case of
proportional hazards, the follow-up duration has little impact on the
event number except for variations from numeric approximations, while in
case of nonproportional hazards, the follow-up time imposes an important impact
on both the total sample size and event number.
</p>


<h3>Value</h3>

<p>a graph showing the relationship and a list of components:
</p>
<table>
<tr><td><code>approx.time</code></td>
<td>
<p>approximate follow-up time corresponding to specified sample size
to reach the same target power </p>
</td></tr>
<tr><td><code>original</code></td>
<td>
<p>a list with elements of <code>x</code> and <code>y</code>. Vector <code>x</code> contains
the follow-up duration and vector <code>y</code> contains the corresponding sample
size</p>
</td></tr>
<tr><td><code>interp</code></td>
<td>
<p>a list containing the interpolated <code>x</code> and <code>y</code> included
in <code>original</code></p>
</td></tr>
<tr><td><code>Esize</code></td>
<td>
<p>a vector of events number corresponding to <code>x</code> in <code>original</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># The following code takes more than 5 seconds to run.

# define design parameters
  t_enrl &lt;- 12; t_fup &lt;- 18; lmd0 &lt;- log(2)/12
# define hazard ratio function
  f_hr_delay &lt;- function(x){(x&lt;=6)+(x&gt;6)*0.75}
# define control hazard
  f_haz0 &lt;- function(x){lmd0*x^0}
# perform sample size calculation using logrank test
# generate weight for test
  wlr &lt;- gen.wgt(method="LR")
  snph1 &lt;- pwr2n.NPH(entry = t_enrl, fup = t_fup, Wlist = wlr,
                    k = 100, ratio = 2, CtrlHaz = f_haz0, hazR = f_hr_delay)

# suppose the follow-up duration that are taken into consideration ranges
# from 12 to 24. The planned number of patients to recruit 2200.
# draw the graph
  efun &lt;- evalfup(snph1,lower.time = 12, upper.time = 24, size = 2200,
               title = NULL)

</code></pre>

<hr>
<h2 id='gen.wgt'>Weight Function Generation</h2><span id='topic+gen.wgt'></span>

<h3>Description</h3>

<p>Generate commonly used weight functions for <code>MaxLRtest</code>
function or <code>pwr2n.NPH</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.wgt(method = c("LR"), param, theta = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen.wgt_+3A_method">method</code></td>
<td>
<p>a vector of text specifying the method(s). The method(s)
must be one or some of c(<code>"LR"</code>, <code>"FH"</code>, <code>"Wilcoxon"</code>,
<code>"Tarone"</code>,<code>"Maxcombo"</code>,<code>"Maxcross"</code>).  Default: c(&quot;LR&quot;)</p>
</td></tr>
<tr><td><code id="gen.wgt_+3A_param">param</code></td>
<td>
<p>a vector of length 2. If <code>FH</code> method is selected,
<code class="reqn">\rho</code> and <code class="reqn">\gamma</code> parameters must be provided, Default: 1</p>
</td></tr>
<tr><td><code id="gen.wgt_+3A_theta">theta</code></td>
<td>
<p>a value within (0,1). If method <code>Maxcross</code> is selected,
<code>theta</code> should be specified. See details. Default: 0.5</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The weight function for Fleming-Harrington (FH) test is <code class="reqn">S(t)^\rho(1-S(t)^\gamma)</code>.
If <code>FH</code> test is specified, both <code class="reqn">\rho</code> and <code class="reqn">\gamma</code> should be provided.
The weight for Tarone and Ware test is <code class="reqn">y(t)^{1/2}</code>, where <code class="reqn">y(t)</code> is number
of subjects at risk. The weight for Wilcoxon test is <code class="reqn">y(t)</code>. See Klein (2003) for
more details about all those tests. Both Maxcombo test and test proposed by
Cheng and He (2021)
need four weight functions. Cheng's method is more sensitive in detecting
crossing hazards. A nuisance parameter <code>theta</code> is required to be
specified. Parameter <code>theta</code> represents the Cumulative Density Function
(CDF) at the crossing time point.
If the hazards crossing
occurs when few events occur yet, a small value should be chosen. The
default value is 0.5.
</p>
<p>Function <code>MaxLRtest</code> supports different base functions including pooled
Kaplan-Meier (K-M) version of CDF functions rather than K-M survival functions.
Therefore, if a F(0,1) test is requested, the returned function is
<code>function(x) {x}</code>, where x denotes the estimated CDF for
<code>KM</code> base. All the supported
base functions are increasing over time.
</p>


<h3>Value</h3>

<p>a list of weight function(s).
</p>


<h3>References</h3>

<p>Klein, J. P., &amp; Moeschberger, M. L. (2003). Survival analysis: techniques for
censored and truncated data (Vol. 1230). New York: Springer.
</p>
<p>Cheng, H., &amp; He, J. (2021). A Maximum Weighted Logrank Test in Detecting
Crossing Hazards. arXiv preprint arXiv:2110.03833.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MaxLRtest">MaxLRtest</a></code>, <code><a href="#topic+pwr2n.NPH">pwr2n.NPH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#logrank test
gen.wgt(method="LR")
# FH and logrank test
  fn &lt;- gen.wgt(method=c("FH","LR"), param = c(1,1))
# maximum weighted logrank test proposed by Cheng, including weight
# for detecting crossing hazards
  wcross &lt;- gen.wgt(method="Maxcross", theta = c(0.2))
</code></pre>

<hr>
<h2 id='lung'>Lung cancer data set</h2><span id='topic+lung'></span>

<h3>Description</h3>

<p>Survival in patients with lung cancer presented in Appendix of
Kalbfleisch and Prentice (1980)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lung
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 137 rows and 10 columns.
</p>


<h3>Details</h3>


<dl>
<dt>Therapy</dt><dd><p>Type of treatment: standard or test</p>
</dd>
<dt>Cell</dt><dd><p>Cell type</p>
</dd>
<dt>SurvTime</dt><dd><p>Failure or censoring time</p>
</dd>
<dt>DiagTime</dt><dd><p>Months till randomization</p>
</dd>
<dt>Age</dt><dd><p>Age in years</p>
</dd>
<dt>Prior</dt><dd><p>Prior treatment?:0=no,10=yes</p>
</dd>
<dt>Treatment</dt><dd><p>Treatment indicator: 0=standard,1=test</p>
</dd>
<dt>censor</dt><dd><p>Censor indicator: 1=censor,0=event</p>
</dd>
</dl>



<h3>References</h3>

<p>Kalbfleisch, J. D., and Prentice, R. L. (1980). The Statistical
Analysis of Failure Time Data. New York: John Wiley &amp; Sons.
</p>

<hr>
<h2 id='MaxLRtest'>Maximum Weighted Logrank Test</h2><span id='topic+MaxLRtest'></span>

<h3>Description</h3>

<p><code>MaxLRtest</code> performs the maximum weighted logrank test if
multiple weight functions are provided. It is the regular weighted logrank test,
if a single weight function is specified,
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MaxLRtest(
  dat,
  Wlist,
  base = c("KM"),
  alpha = 0.05,
  alternative = c("two.sided")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MaxLRtest_+3A_dat">dat</code></td>
<td>
<p>a dataframe or matrix. The first three columns of the data
set are survival
time, event status indicator  and group label. The status indicator, normally
0=alive, 1=dead/event. Other choices are TRUE/FALSE (TRUE=death) or 1/2 (2=death).
The group label can be either numeric values like 0=control, 1=treatment or text
like C=control, T=treatment.</p>
</td></tr>
<tr><td><code id="MaxLRtest_+3A_wlist">Wlist</code></td>
<td>
<p>a list with components of weight functions</p>
</td></tr>
<tr><td><code id="MaxLRtest_+3A_base">base</code></td>
<td>
<p>a text must be one of c(&quot;<code>KM</code>&quot;, &quot;<code>Combined</code>&quot;, &quot;<code>N</code>&quot;),
Default: c(&quot;KM&quot;)</p>
</td></tr>
<tr><td><code id="MaxLRtest_+3A_alpha">alpha</code></td>
<td>
<p>a number indicating type I error rate, Default: 0.05</p>
</td></tr>
<tr><td><code id="MaxLRtest_+3A_alternative">alternative</code></td>
<td>
<p>a text must be one of c(&quot;<code>two.sided</code>&quot;, &quot;<code>less</code>&quot;,
<code>"greater"</code>), indicating the alternative hypothesis, Default: c(&quot;two.sided&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>MaxLRtest</code> function performs logrank, weighted logrank test such as
Fleming-Harrington test and maximum weighted logrank test depending on
the type and number of weight functions. Let <code class="reqn">w(x_t)</code> denote the weight applied
at event time point <code class="reqn">t</code>, where <code class="reqn">x_t</code> is the base function. There are three options
for <code>base</code>. If <code>KM</code> is used, <code class="reqn">x_t=1-S_t</code>, where <code class="reqn">S_t</code>
is pooled Kaplan-Meier estimate of survival rate at time point t. A FH(1,0) test
needs a weight function <code class="reqn">1-x_t</code>. If <code>Combined</code> base is selected,
<code class="reqn">x_t=1-S^*_t</code>, where <code class="reqn">S^*_t=w_1S^1_t+w_0S^0_t</code>, the weighted average
of KM estimate of survival rate for treatment (<code class="reqn">S^1_t</code>) and control group
(<code class="reqn">S^0_t</code>). It is considered more robust in case of unbalanced data.
For option <code>N</code>, <code class="reqn">x_t=1-\frac{Y_t}{N}</code>, where <code class="reqn">Y_t</code> is the subjects
at risk at time t and <code class="reqn">N</code> is the total number of subjects.The Wilcoxon and
tarone test should use this base. The base <code class="reqn">x_t</code> in all three cases is an
increasing function of time t. Function <code>gen.wgt</code> helps to generate the commonly
used weight functions.
</p>
<p>Let <code class="reqn">\Lambda_1</code> and <code class="reqn">\Lambda_0</code> denote the cumulative hazard for
treatment and control group. The alternative of a two-sided test is
<code class="reqn">H_a: \Lambda_1 \neq \Lambda_0</code>. The <code>"less"</code> alternative
corresponds to <code class="reqn">H_a: \Lambda_1 &lt; \Lambda_0</code> and the <code>"greater"</code>
alternative is <code class="reqn">H_a: \Lambda_1 &gt; \Lambda_0</code>.
</p>
<p>A p-value is obtained from a multivariate normal distribution if multiple weights
are provided. The function <code>pmvnorm</code> from R package <span class="pkg">mvtnorm</span> is used.
Because the algorithm is slightly seed-dependent,the p-value and critical value
is the average of 10 runs.
</p>


<h3>Value</h3>

<p>a list of components including
</p>
<table>
<tr><td><code>stat</code></td>
<td>
<p>a numeric value indicating the test statistic. It is logrank or weighted logrank test
statistic if one weight function is specified. Otherwise, it gives
the maximum weighted logrank test statistic, which takes the maximum
of absolute values of all the statistics. </p>
</td></tr>
<tr><td><code>stat.mat</code></td>
<td>
<p>a matrix with the first column showing weighted
logrank test statistics and other columns displaying the variance and
covariance between statistics</p>
</td></tr>
<tr><td><code>critV</code></td>
<td>
<p>a numeric value indicating the critical value corresponding to the nominal
level - <code>alpha</code></p>
</td></tr>
<tr><td><code>details</code></td>
<td>
<p>a dataframe showing the intermediate variables used in the
calculation. </p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>a numeric value indicating the p-value of the test</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+pwr2n.NPH">pwr2n.NPH</a></code>, <code><a href="#topic+gen.wgt">gen.wgt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lung)
#Only keep variables for analysis
tmpd &lt;- with(lung, data.frame(time=SurvTime,stat=1-censor,grp=Treatment))
#logrank test
wlr &lt;- gen.wgt(method = "LR")
t1 &lt;- MaxLRtest(tmpd, Wlist = wlr, base = c("KM") )
t1$stat ;t1$p.value


# maxcombo test
wmax &lt;- gen.wgt(method="Maxcombo")
t2 &lt;- MaxLRtest(tmpd, Wlist = wmax, base = c("KM") )
t2$stat ;t2$p.value
#visualize the weight functions
plot(t2)
</code></pre>

<hr>
<h2 id='n2pwr.NPH'>Power Calculation with Combination Test</h2><span id='topic+n2pwr.NPH'></span>

<h3>Description</h3>

<p><code>n2pwr.NPH</code> calculates the power given either the
number of events or number of subjects using combination test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n2pwr.NPH(
  method = "MaxLR",
  entry = 1,
  fup = 1,
  maxfup = entry + fup,
  CtrlHaz,
  hazR,
  transP1,
  transP0,
  Wlist,
  entry_pdf0 = function(x) {
     (1/entry) * (x &gt;= 0 &amp; x &lt;= entry)
 },
  entry_pdf1 = entry_pdf0,
  eventN = NULL,
  totalN = NULL,
  ratio = 1,
  alpha = 0.05,
  alternative = c("two.sided"),
  k = 100,
  nreps = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n2pwr.NPH_+3A_method">method</code></td>
<td>
<p>a text specifying the calculation method, either
<code>"MaxLR"</code> or <code>"Projection"</code>. Maximum weighted
logrank test is used if <code>"MaxLR"</code> is specified; otherwise,
projection test is used.</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_entry">entry</code></td>
<td>
<p>a numeric value indicating the enrollment time, Default: 1</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_fup">fup</code></td>
<td>
<p>a numeric value indicating the minimum follow-up time for subjects.
, Default: 1</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_maxfup">maxfup</code></td>
<td>
<p>maximum follow-up time</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_ctrlhaz">CtrlHaz</code></td>
<td>
<p>a function,  specifying the hazard function for control group.</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_hazr">hazR</code></td>
<td>
<p>a function, specifying the hazard ratio function between
treatment and control group</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_transp1">transP1</code></td>
<td>
<p>a numeric vector of length 2, consisting of the transition
probability from
receiving treatment to drop-out (drop-out rate) and
from receiving treatment to receiving control (drop-in rate) per time unit.</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_transp0">transP0</code></td>
<td>
<p>a numeric vector of length 2, consisting of the transition
probability from
receiving control to drop-out (drop-out rate) and
from receiving control to receiving treatment (drop-in rate) per time unit.</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_wlist">Wlist</code></td>
<td>
<p>a list, consisting of weight functions applied to the test.
The element of the list must be functions. Default is a list of one constant
function, corresponding to the logrank test.</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_entry_pdf0">entry_pdf0</code></td>
<td>
<p>a function, indicating the probability density function (pdf)
of enrollment/entry time for control group. The default assumes a uniform distribution
corresponding to the constant enrollment rate.</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_entry_pdf1">entry_pdf1</code></td>
<td>
<p>a pdf function of enrollment/entry time for treatment</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_eventn">eventN</code></td>
<td>
<p>the number of events</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_totaln">totalN</code></td>
<td>
<p>the number of subjects</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_ratio">ratio</code></td>
<td>
<p>allocation ratio, Default: 1</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_alpha">alpha</code></td>
<td>
<p>type i error, Default: 0.05</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_alternative">alternative</code></td>
<td>
<p>alternative hypothesis - one of c(<code>"two.sided", "less", "greater"</code>),
Default: <code>"two.sided"</code></p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_k">k</code></td>
<td>
<p>an integer, indicating number of sub-intervals per time unit, Default: 100</p>
</td></tr>
<tr><td><code id="n2pwr.NPH_+3A_nreps">nreps</code></td>
<td>
<p>number of replicates used for calculating quantitle
using multivariate normal</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>npwr.NPH</code> calculates the asymptotic power given number
of events or number of subjects using maximum weighted logrank test or
projection type test. If only <code>eventN</code> is provided, the
asymptotic power is based on provided number of events. If
only <code>totalN</code> is given, the pooled event probability (<code class="reqn">eprob</code>) is calculated
according input design parameters including entry time, follow-up time
and hazard functions, etc. The number of events is calculated as
<code>totalN</code>*<code class="reqn">eprob</code>, which is given in returned vector <code>outN</code>.
Similarly, if only <code>eventN</code> is given, the total sample
size is given as <code>eventN</code>/<code class="reqn">eprob</code>. However, if both
<code>eventN</code> and <code>totalN</code> are provided, we only use
<code>eventN</code> for calculation.
Check function <code>pwr2n.NPH</code> for more calculation details.
</p>


<h3>Value</h3>

<p>a list of components:
</p>
<table>
<tr><td><code>power</code></td>
<td>
<p>asymptotic power </p>
</td></tr>
<tr><td><code>inN</code></td>
<td>
<p>a vector consisting of the input of <code>eventN</code> and <code>totalN</code></p>
</td></tr>
<tr><td><code>outN</code></td>
<td>
<p>a vector including the output of number of events
and total sample. See details. </p>
</td></tr>
<tr><td><code>prob_event</code></td>
<td>
<p>event probability at the end of trial</p>
</td></tr>
<tr><td><code>L_trans</code></td>
<td>
<p>a list, consisting of transition matrix at each interval</p>
</td></tr>
<tr><td><code>pdat</code></td>
<td>
<p> a data frame including all the intermediate variables in the calculation.
</p>
</td></tr>
<tr><td><code>studytime</code></td>
<td>
<p>a vector of length 2, including the entry and follow-up time as input</p>
</td></tr>
<tr><td><code>RandomizationRatio</code></td>
<td>
<p>as input</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+pwr2n.NPH">pwr2n.NPH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># entry time
t_enrl &lt;- 12
# follow-up time
t_fup &lt;- 18
# baseline hazard
lmd0 &lt;- -log(0.2)/10
# delayed treatment effects
f_hr_delay &lt;- function(x){(x&lt;=6)+(x&gt;6)*0.75}
# maxcombo test
maxc &lt;- gen.wgt(method="Maxcombo")
pwr1 &lt;- n2pwr.NPH(entry   = t_enrl
                 ,fup      = t_fup
                 ,CtrlHaz = function(x){x^0*lmd0}
                 ,hazR = f_hr_delay
                 ,transP1 = c(0,0)
                 ,transP0 = c(0,0)
                 ,Wlist = maxc
                 ,eventN = 50 # targeted number of events
)
</code></pre>

<hr>
<h2 id='plot.MaxLR'>Graphical Display of Weight Functions</h2><span id='topic+plot.MaxLR'></span>

<h3>Description</h3>

<p>Display weight functions used in the function <code>MaxLRtest</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MaxLR'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.MaxLR_+3A_x">x</code></td>
<td>
<p>object of <code>MaxLRtest</code> function</p>
</td></tr>
<tr><td><code id="plot.MaxLR_+3A_...">...</code></td>
<td>
<p>additional graphical arguments passed to the plot function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots are produced on the current graphics device
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MaxLRtest">MaxLRtest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in the help file of function MaxLRtest
</code></pre>

<hr>
<h2 id='plot.NPHpwr'>Graphical Display of Design Parameters in Sample Size
Calculation</h2><span id='topic+plot.NPHpwr'></span>

<h3>Description</h3>

<p>Displays graphs of survival, hazards, drop-out and censor over time
as specified in the calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NPHpwr'
plot(x, type = c("hazard", "survival", "dropout", "event", "censor"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.NPHpwr_+3A_x">x</code></td>
<td>
<p>object of the <code>pwr2n.NPH</code> function</p>
</td></tr>
<tr><td><code id="plot.NPHpwr_+3A_type">type</code></td>
<td>
<p>a vector of string, specifying the graphs to display. The options
include &quot;<code>hazard</code>&quot;, &quot;<code>survival</code>&quot;, &quot;<code>dropout</code>&quot;,
&quot;<code>event</code>&quot;, and
&quot;<code>censor</code>&quot;. If <code>type</code> is not provided, all the available graphs are
generated.</p>
</td></tr>
<tr><td><code id="plot.NPHpwr_+3A_...">...</code></td>
<td>
<p>additional graphical arguments passed to the plot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>type</code> argument provides five options to visualize the trial in design.
Option <code>survival</code> shows the survival probabilities of treatment and control
group over time. Option <code>hazard</code> provides the hazard rates and hazard ratio
over time. Option <code>dropout</code> shows the proportion of drop-out subjects across
the trial duration.
Option <code>censor</code> shows the proportion of censored subjects over time.
</p>


<h3>Value</h3>

<p>plots are produced on the current graphics device
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pwr2n.NPH">pwr2n.NPH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # generate weight function
 wlr &lt;- gen.wgt(method = "LR" )
 t_enrl &lt;- 12; t_fup &lt;- 18; lmd0 &lt;- log(2)/12
 # delayed treatment effects, the crossign point is at 6.
 f_hr_delay &lt;- function(x){(x&lt;=6)+(x&gt;6)*0.75}
 f_haz0 &lt;- function(x){lmd0*x^0}
 snph1 &lt;- pwr2n.NPH(entry = t_enrl, fup = t_fup, Wlist = wlr,
                    k = 100, ratio = 2, CtrlHaz = f_haz0,
                    hazR = f_hr_delay)
 # display the hazards plot only
 plot(snph1, type="hazard")
 # display all plots
 plot(snph1)
</code></pre>

<hr>
<h2 id='plotHazSurv'>Graphic Display of Hazard and Survival Function</h2><span id='topic+plotHazSurv'></span>

<h3>Description</h3>

<p>Plot the hazard and survival function of the
of control group (from weibull or loglogistic distribution) and treatment group
(derived from an arbitrary hazard ratio function)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotHazSurv(
  bsl_dist = c("weibull", "loglogistic"),
  param = c(1.2, 0.03),
  fun_list,
  end,
  tit = c("Hazard Function", "Survival Function"),
  pos = c(1, 2),
  hlegend.loc = "bottomleft",
  slegend.loc = "topright"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotHazSurv_+3A_bsl_dist">bsl_dist</code></td>
<td>
<p>a text must be one of (<code>"weibull"</code>,
<code>"loglogistic"</code>) distribution, specified for the control group</p>
</td></tr>
<tr><td><code id="plotHazSurv_+3A_param">param</code></td>
<td>
<p>a vector of length 2, specifying the shape and rate (1/scale)
parameter of the <code>bsl_dist</code> distribution, Default: c(1.2, 0.03)</p>
</td></tr>
<tr><td><code id="plotHazSurv_+3A_fun_list">fun_list</code></td>
<td>
<p>a list of hazard ratio functions comparing treatment group
and control group</p>
</td></tr>
<tr><td><code id="plotHazSurv_+3A_end">end</code></td>
<td>
<p>a value specifying the duration of the curve</p>
</td></tr>
<tr><td><code id="plotHazSurv_+3A_tit">tit</code></td>
<td>
<p>a vector specifying the titles of each graph, Default: c(&quot;Hazard Function&quot;, &quot;Survival Function&quot;)</p>
</td></tr>
<tr><td><code id="plotHazSurv_+3A_pos">pos</code></td>
<td>
<p>a graphic parameter in the form of c(nr,nc). Subsequent
figures will be drawn in an nr-by-nc array, Default: c(1, 2)</p>
</td></tr>
<tr><td><code id="plotHazSurv_+3A_hlegend.loc">hlegend.loc</code></td>
<td>
<p>a text indicating the position of legend
for the hazard plot. Default: &quot;bottomleft&quot;</p>
</td></tr>
<tr><td><code id="plotHazSurv_+3A_slegend.loc">slegend.loc</code></td>
<td>
<p>a text indicating the position of legend
for the survival plot. Default: &quot;topright&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>graphics of hazard and survival functions
</p>


<h3>Examples</h3>

<pre><code class='language-R'># proportional hazards
plotHazSurv(
 bsl_dist=c("weibull")
 ,param=c(1.2,1/30)
 ,fun_list=list(function(x){x^0*0.7})
 ,40
 ,tit= c("Hazard Function","Survival Function")
 ,pos=c(1,2)
)
# crossing hazards
plotHazSurv(
 bsl_dist=c("weibull")
 ,param=c(1.2,1/30)
 ,fun_list=list(function(x){1.3*(x&lt;10)+(x&gt;=10)*0.7})
 ,40
 ,tit= c("Hazard Function","Survival Function")
 ,pos=c(1,2)
)
</code></pre>

<hr>
<h2 id='projection.test'>Projection test</h2><span id='topic+projection.test'></span>

<h3>Description</h3>

<p>Perform projection test as proposed by Brendel (2014)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>projection.test(dat, Wlist, base, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="projection.test_+3A_dat">dat</code></td>
<td>
<p>a dataframe or matrix, of which the first three columns are survival
time, event status indicator  and group label. The status indicator, normally
0=alive, 1=dead/event. Other choices are TRUE/FALSE (TRUE=death) or 1/2 (2=death).
The group label can be either numeric values like 0=control, 1=treatment or text
like C=control, T=treatment.</p>
</td></tr>
<tr><td><code id="projection.test_+3A_wlist">Wlist</code></td>
<td>
<p>a list object with components of weight functions</p>
</td></tr>
<tr><td><code id="projection.test_+3A_base">base</code></td>
<td>
<p>a text must be one of c(&quot;<code>KM</code>&quot;,&quot;<code>Combined</code>&quot;,&quot;<code>N</code>&quot;), Default: c(&quot;KM&quot;)</p>
</td></tr>
<tr><td><code id="projection.test_+3A_alpha">alpha</code></td>
<td>
<p>a number indicating type I error rate, Default: 0.05</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The base functions are the same as those described in function
<code>MaxLRtest</code>. The method detail can be found in Brendel (2014)
paper. The main idea is to map the multiple weighted logrank statistics
into a chi-square distribution. The degree freedom of the chi-square
is the rank of the generalized inverse of covariance matrix. Only two-sided
test is supported in the current function.
</p>


<h3>Value</h3>

<p>a list of components including
</p>
<table>
<tr><td><code>chisq</code></td>
<td>
<p>a numeric value indicating the chi-square statistic</p>
</td></tr>
<tr><td><code>df.chis</code></td>
<td>
<p>a numeric value indicating the degree freedom of the test</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>a numeric value giving the p-value of the test </p>
</td></tr>
<tr><td><code>details</code></td>
<td>
<p>a data frame consisting of statistics from multiple
weight functions and the variance-covariance matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brendel, M., Janssen, A., Mayer, C. D., &amp; Pauly, M. (2014). Weighted logrank
permutation tests for randomly right censored life science
data. Scandinavian Journal of Statistics, 41(3), 742-761.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MaxLRtest">MaxLRtest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and prepare data
data(lung)
tmpd &lt;- with(lung, data.frame(time=SurvTime,stat=1-censor,grp=Treatment))
# two weight functions are defined.
# one is constant weight; the other emphasize diverging hazards
timef1 &lt;- function(x){1}
timef2 &lt;- function(x){(x)}
test1 &lt;- projection.test(tmpd,list(timef1,timef2),base="KM")
test1$chisq; test1$pvalue; test1$df.chisq
</code></pre>

<hr>
<h2 id='pwr2n.LR'>Sample Size Calculation under Proportional Hazards</h2><span id='topic+pwr2n.LR'></span><span id='topic+phsize'></span>

<h3>Description</h3>

<p><code>pwr2n.LR</code> calculates the total number of events and total
number of subjects required given the provided design parameters based on either
schoenfeld or freedman formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwr2n.LR(
  method = c("schoenfeld", "freedman"),
  lambda0,
  lambda1,
  ratio = 1,
  entry = 0,
  fup,
  alpha = 0.05,
  beta = 0.1,
  alternative = c("two.sided"),
  Lparam = NULL,
  summary = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pwr2n.LR_+3A_method">method</code></td>
<td>
<p>calculation formula, Default: c(&quot;schoenfeld&quot;, &quot;freedman&quot;)</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_lambda0">lambda0</code></td>
<td>
<p>hazard rate for the control group</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_lambda1">lambda1</code></td>
<td>
<p>hazard rate for the treatment group</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_ratio">ratio</code></td>
<td>
<p>randomization ratio between treatment and control. For example,
ratio=2 if randomization ratio is 2:1 to treatment and control group.
Default:1</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_entry">entry</code></td>
<td>
<p>enrollment time. A constant enrollment rate is assumed,
Default: 0</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_fup">fup</code></td>
<td>
<p>follow-up time.</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_alpha">alpha</code></td>
<td>
<p>type I error rate, Default: 0.05</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_beta">beta</code></td>
<td>
<p>type II error rate. For example,if the target power is 80%, beta is 0.2.
Default: 0.1</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_alternative">alternative</code></td>
<td>
<p>a value must be one of (&quot;two.sided&quot;, &quot;one.sided&quot;), indicating
whether a two-sided or one-sided test to use.  Default: c(&quot;two.sided&quot;)</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_lparam">Lparam</code></td>
<td>
<p>a vector of shape and scale parameters for the drop-out Weibull distribution,
See Details below. Default: NULL</p>
</td></tr>
<tr><td><code id="pwr2n.LR_+3A_summary">summary</code></td>
<td>
<p>a logical controlling whether a brief summary is printed or not
, Default: TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both Schoenfeld's formula and Freedman's formula are included in the
function <code>pwr2n.LR</code>.
The total event number is determined by <code class="reqn">\alpha, \beta</code> and
hazard ratio, i.e., <code class="reqn">\lambda_1/\lambda_0</code>. Other design parameters such as
enrollment period affects the event probability and thus the total sample size.
A fixed duration design is assumed in the calculation. All patients are enrolled
at a constant rate within <code>entry</code> time and have at least <code>fup</code>
time of follow-up. So the total study duration is <code>entry</code>+<code>fup</code>.
If drop-out is expected, a Weibull distribution with shape parameter -<code class="reqn">\alpha</code>
and scale parameter - <code class="reqn">\beta</code> is considered. The CDF of Weibull is
<code class="reqn">F(x)=1-exp(-(x/\beta)^\alpha)</code>, where <code class="reqn">\alpha</code> is the shape
parameter and <code class="reqn">\beta</code> is the scale parameter. The event rate
is calculated through numeric integration. See more details in
<code><a href="#topic+cal_event">cal_event</a></code>.
</p>


<h3>Value</h3>

<p>a list of components including
</p>
<table>
<tr><td><code>eventN</code></td>
<td>
<p>a numeric value giving the total number of events</p>
</td></tr>
<tr><td><code>totalN</code></td>
<td>
<p>a numeric value giving the total number of subjects</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>a list containing the input parameters and output results</p>
</td></tr>
</table>


<h3>References</h3>

<p>Schoenfeld, D. (1981) The asymptotic properties of nonparametric
tests for comparing survival distributions. Biometrika, 68,
316–319.
</p>
<p>Freedman, L. S. (1982) Tables of the number of patients required
in clinical trials using the logrank test. Statistics in medicine, 1, 121–129.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pwr2n.NPH">pwr2n.NPH</a></code>,
<code><a href="#topic+evalfup">evalfup</a></code>, <code><a href="#topic+cal_event">cal_event</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># define design parameters
l0 &lt;- log(2)/14; HR &lt;- 0.8; RR &lt;- 2; entry &lt;- 12; fup &lt;- 12;
eg1 &lt;- pwr2n.LR( method    = c("schoenfeld")
                 ,l0
                 ,l0*HR
                 ,ratio=RR
                 ,entry
                 ,fup
                 ,alpha     = 0.05
                 ,beta      = 0.1
)
# event number, total subjects, event probability
c(eg1$eventN,eg1$totalN,eg1$eventN/eg1$totalN)

# example 2: drop-out from an exponential with median time is 30
eg2 &lt;- pwr2n.LR( method    = c("schoenfeld")
                 ,l0
                 ,l0*HR
                 ,ratio=RR
                 ,entry
                 ,fup
                 ,alpha     = 0.05
                 ,beta      = 0.1
                 ,Lparam = c(1,30/log(2))
)
# event number, total subjects, event probability
c(eg2$eventN,eg2$totalN,eg2$eventN/eg2$totalN)
</code></pre>

<hr>
<h2 id='pwr2n.NPH'>Sample Size Calculation with Combination Test</h2><span id='topic+pwr2n.NPH'></span>

<h3>Description</h3>

<p><code>pwr2n.NPH</code> calculates the number of events and
subjects required to achieve pre-specified power in the setup of two groups.
The method extends the calculation in the framework of the Markov model by Lakatos, allowing
for using the maximum weighted logrank tests or projection test with an arbitrary number of weight
functions. For maximum weighted logrank type test, if only one weight function
is provided, the test is essentially
the classic (weighted) logrank test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwr2n.NPH(
  method = "MaxLR",
  entry = 1,
  fup = 1,
  maxfup = entry + fup,
  CtrlHaz,
  hazR,
  transP1 = c(0, 0),
  transP0 = c(0, 0),
  Wlist = list(function(x) {
     x^0
 }),
  entry_pdf0 = function(x) {
     (1/entry) * (x &gt;= 0 &amp; x &lt;= entry)
 },
  entry_pdf1 = entry_pdf0,
  ratio = 1,
  alpha = 0.05,
  beta = 0.1,
  alternative = c("two.sided"),
  criteria = 500,
  k = 100,
  m = 0,
  nreps = 10,
  varianceType = c("equal"),
  weightBase = "C",
  summary = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pwr2n.NPH_+3A_method">method</code></td>
<td>
<p>a text specifying the calculation method, either
<code>"MaxLR"</code> or <code>"Projection"</code>. Maximum weighted
logrank test is used if <code>"MaxLR"</code> is specified; otherwise,
projection test is used.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_entry">entry</code></td>
<td>
<p>a numeric value indicating the enrollment time, Default: 1</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_fup">fup</code></td>
<td>
<p>a numeric value indicating the minimum follow-up time for subjects.
, Default: 1</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_maxfup">maxfup</code></td>
<td>
<p>maximum follow-up time</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_ctrlhaz">CtrlHaz</code></td>
<td>
<p>a function,  specifying the hazard function for control group.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_hazr">hazR</code></td>
<td>
<p>a function, specifying the hazard ratio function between
treatment and control group</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_transp1">transP1</code></td>
<td>
<p>a numeric vector of length 2, consisting of the transition
probability from
receiving treatment to drop-out (drop-out rate) and
from receiving treatment to receiving control (drop-in rate) per time unit.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_transp0">transP0</code></td>
<td>
<p>a numeric vector of length 2, consisting of the transition
probability from
receiving control to drop-out (drop-out rate) and
from receiving control to receiving treatment (drop-in rate) per time unit.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_wlist">Wlist</code></td>
<td>
<p>a list, consisting of weight functions applied to the test.
The element of the list must be functions. Default is a list of one constant
function, corresponding to the logrank test.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_entry_pdf0">entry_pdf0</code></td>
<td>
<p>a function, indicating the probability density function (pdf)
of enrollment time for control group. The default assumes a uniform distribution
corresponding to the constant enrollment rate.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_entry_pdf1">entry_pdf1</code></td>
<td>
<p>a pdf of enrollment time for treatment
group. See <code>entry_pdf0</code>, Default: assume same pdf as control group.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_ratio">ratio</code></td>
<td>
<p>an integer, indicating the randomization ratio between treatment
and control group, Default: 1</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_alpha">alpha</code></td>
<td>
<p>type I error rate, Default: 0.05</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_beta">beta</code></td>
<td>
<p>type II error rate, Default: 0.1</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of &quot;<code>two.sided</code>&quot;, &quot;<code>greater</code>&quot;,&quot;<code>less</code>&quot;. See details.
For <code>"Projection"</code> method, only <code>"two-sided"</code>
alternative is supported. Default: c(&quot;<code>two.sided</code>&quot;)</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_criteria">criteria</code></td>
<td>
<p>an integer indicating the maximum iteration allowed in
obtaining the number of events. See details , Default: 500</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_k">k</code></td>
<td>
<p>an integer, indicating number of sub-intervals per time unit,
Default: 100</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_m">m</code></td>
<td>
<p>a value within 0 and 1.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_nreps">nreps</code></td>
<td>
<p>an integer, indicating number of iterations in calculating
the quantile of multivariate normal. See Details.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_variancetype">varianceType</code></td>
<td>
<p>Default: <code>equal</code>. Indicates different variance assumptions
for the sample size calculation.
It is not applicable for the maximum weighted logrank test. See details.</p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_weightbase">weightBase</code></td>
<td>
<p>A character, either &quot;<code>F</code>&quot; or &quot;<code>T</code>&quot;. <code>F</code> indicates
a CDF is the base for the weight function used in the weighted logrank or maximum weighted
logrank test. <code>T</code> indicates time is the base for weight function. Default: <code>F</code></p>
</td></tr>
<tr><td><code id="pwr2n.NPH_+3A_summary">summary</code></td>
<td>
<p>a logical value, controlling whether to print the
summary of calculation, Default: TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The detailed methods can be found in the reference papers. The number
of subjects is determined by several factors, including the control hazard function,
hazard ratio function, entry time distribution, follow-up time, etc.  Under proportional
hazard assumption, the number of events is mainly determined by the hazard ratio besides
type i/ii error rates. However, under nonproportional hazards, all the above design parameters
may have an impact on the number of events.
The study design assumes <code>entry</code> time units of
enrollment and at least <code>fup</code> time units of follow-up. If enrollment
time <code>entry</code> is set to zero, all subjects are enrolled simultaneously,
so there is no staggered entry. Otherwise, if
<code>entry</code> is greater than 0, administrative censoring is considered. The user-defined
enrollment time function, hazard function for the control group and hazard ratio function can be either discrete or continuous.
Various non-proportional hazards types are accommodated. See examples below.
If multiple weight functions are provided in <code>Wlist</code>, a maximum weighted logrank
test or combination test is implemented. An iterative procedure
is used to obtain the event number based on the multivariate normal distribution.  Package
<span class="pkg">mvtnorm</span> is used to calculate the quantiles. Because the algorithm is slightly
seed dependent, the quantiles are mean values of ten replicates by default. The
number of replicates is controlled by argument <code>ninter</code>.
</p>
<p>The &quot;<code>alternative</code>&quot; option supports both two-sided and one-sided test.
Let <code class="reqn">\Lambda_1</code> and <code class="reqn">\Lambda_0</code> denote the cumulative hazard of
treatment and control group. The <code>less</code> option tests
<code class="reqn">H_0: \Lambda_1 &gt; \Lambda_0</code> against
<code class="reqn">H_a: \Lambda_1 &lt;= \Lambda_0</code>. The <code>greater</code> option tests
<code class="reqn">H_0: \Lambda_1 &lt; \Lambda_0</code> against <code class="reqn">H_a: \Lambda_1 &gt;= \Lambda_0</code>.
</p>
<p>When <code>varianceType</code> is <code>equal</code>, the sample size for a two sided test is
<code class="reqn">(z_{1-\alpha/2}+z_{1-\beta})^2\tilde{\sigma}^2/\mu_w^2</code>, where <code class="reqn">\tilde{\sigma}^2</code>
is the variance estimate under alternative. when <code>varianceType</code> is not
<code>equal</code>. The formula is <code class="reqn">(z_{1-\alpha/2}\sigma_w+z_{1-\beta}\tilde{\sigma})^2/\mu_w^2</code>.
Please use <code>equal</code> variance type for the maximum weighted logrank test.
</p>


<h3>Value</h3>

<p>An object of class &quot;<code>NPHpwr</code>&quot; with corresponding <code>plot</code> function.
The object is a list containing the following components:
</p>
<table>
<tr><td><code>eventN</code></td>
<td>
<p>total number of events</p>
</td></tr>
<tr><td><code>totalN</code></td>
<td>
<p>total number of subjects</p>
</td></tr>
<tr><td><code>pwr</code></td>
<td>
<p>actual power given the number of events</p>
</td></tr>
<tr><td><code>prob_event</code></td>
<td>
<p>event probability at the end of trial</p>
</td></tr>
<tr><td><code>prob1</code></td>
<td>
<p>event probability for the treatment group</p>
</td></tr>
<tr><td><code>prob0</code></td>
<td>
<p>event probability for the control group</p>
</td></tr>
<tr><td><code>L_trans</code></td>
<td>
<p>a list, consisting of transition matrix at each interval</p>
</td></tr>
<tr><td><code>pdat</code></td>
<td>
<p> a dataframe including all the intermediate variables in the calculation.
see Details.</p>
</td></tr>
<tr><td><code>studytime</code></td>
<td>
<p>a vector of length 2, including the entry and follow-up time as input</p>
</td></tr>
<tr><td><code>RandomizationRatio</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>eventlist</code></td>
<td>
<p>a vector containing the number of events using each
weight function alone</p>
</td></tr>
<tr><td><code>inputfun</code></td>
<td>
<p>a list containing all the input functions specified by
users</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brendel, M., Janssen, A., Mayer, C. D., &amp; Pauly, M. (2014). Weighted logrank
permutation tests for randomly right censored life science data. Scandinavian
Journal of Statistics, 41(3), 742-761.
</p>
<p>Cheng, H., &amp; He, J. (2021). A Maximum Weighted Logrank Test in Detecting
Crossing Hazards. arXiv preprint arXiv:2110.03833.
</p>
<p>Cheng H, He J. Sample size calculation for the combination test under
nonproportional hazards. Biom J. 2023 Apr;65(4):e2100403. doi: 10.1002/bimj.202100403.
Epub 2023 Feb 15. PMID: 36789566
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pwr2n.LR">pwr2n.LR</a></code>
<code><a href="#topic+gen.wgt">gen.wgt</a></code>, <code><a href="#topic+evalfup">evalfup</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> #------------------------------------------------------------
 ## Delayed treatment effects using maxcombo test
 ## generate a list of weight functions for maxcombot test
 wmax &lt;- gen.wgt(method = "Maxcombo" )
 t_enrl &lt;- 12; t_fup &lt;- 18; lmd0 &lt;- log(2)/12
 ## delayed treatment effects
 f_hr_delay &lt;- function(x){(x&lt;=6)+(x&gt;6)*0.75}
 f_haz0 &lt;- function(x){lmd0*x^0}
 ##  The following code takes more than 5 seconds to run
 
 snph1 &lt;- pwr2n.NPH(entry = t_enrl, fup = t_fup, Wlist = wmax,
                    k = 100, ratio = 2, CtrlHaz = f_haz0, hazR = f_hr_delay)
 
 #-------------------------------------------------------------
 # same setting using projection test
 snph2 &lt;- pwr2n.NPH(method = "Projection", entry = t_enrl,
  fup = t_fup, Wlist = wmax, k = 10, ratio = 2, CtrlHaz = f_haz0,
  hazR = f_hr_delay)

 #-------------------------------------------------------------
 #proportional hazards with weibull survival for control group
 #logrank test
 wlr &lt;- gen.wgt(method = "LR" )
 b0 &lt;- 3
 th0 &lt;- 10/(-log(0.2))^(1/b0)
 #Weibull hazard function
 f_hz_weibull &lt;- function(x){b0/th0^b0*x^(b0-1)}
 #hazard ratio function
 f_hr &lt;- function(x){0.5*x^0}
 # define entry and follow-up time
 t_enrl &lt;- 5; t_fup &lt;- 5
 exph1 &lt;- pwr2n.NPH(entry = t_enrl, fup = t_fup, k = 100,
 Wlist = wlr,  CtrlHaz = f_hz_weibull, hazR = f_hr, summary = FALSE)
 summary(exph1)
</code></pre>

<hr>
<h2 id='simu.trial'>Simulate Survival Trial Data</h2><span id='topic+simu.trial'></span>

<h3>Description</h3>

<p><code>simu.trial</code> simulates survival data allowing flexible input
of design parameters. It supports both event-driven design and fixed study duration
design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simu.trial(
  type = c("event", "time"),
  trial_param,
  bsl_dist = c("weibull", "loglogistic", "mix-weibull"),
  bsl_param,
  drop_param0,
  drop_param1 = drop_param0,
  entry_pdf0 = function(x) {
     (1/trial_param[2]) * (x &gt;= 0 &amp; x &lt;= trial_param[2])
 },
  entry_pdf1 = entry_pdf0,
  enrollmentType = NULL,
  entryP = list(10000, 1),
  HR_fun,
  ratio,
  cureModel = NULL,
  cureRate1 = NULL,
  HR_data = NULL,
  upInt = 100,
  summary = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simu.trial_+3A_type">type</code></td>
<td>
<p>indicates whether event-driven trial (&quot;<code>event</code>) or fixed study duration
trial (&quot;<code>time</code>&quot;), Option: c(&quot;<code>event</code>&quot;, &quot;<code>time</code>&quot;)</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_trial_param">trial_param</code></td>
<td>
<p>a vector of length 3 with components for required subject size, enrollment
time and required number of events (&quot;<code>event</code>&quot; type trial)/follow-up time
(&quot;<code>time</code>&quot; type trial)</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_bsl_dist">bsl_dist</code></td>
<td>
<p>indicates the survival distribution for control group, option:
c(&quot;<code>weibull</code>&quot;, &quot;<code>loglogistic</code>&quot;,<code>mix-weibull</code>)</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_bsl_param">bsl_param</code></td>
<td>
<p>a vector of length 2 with the shape and rate (scale) parameter for the
weibull or loglogistic survival distribution of control group. A vector of length 3 with
shape, rate and cure rate for the mix-weibull distribution. See details.</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_drop_param0">drop_param0</code></td>
<td>
<p>a vector of length 2 with shape and scale parameter for the
weibull distribution of drop-out time for control group</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_drop_param1">drop_param1</code></td>
<td>
<p>a vector of length 2 with shape and scale parameter for the
weibull distribution of drop-out time for treatment group</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_entry_pdf0">entry_pdf0</code></td>
<td>
<p>a function describing the pdf of the entry time for control. Default: uniform enrollment</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_entry_pdf1">entry_pdf1</code></td>
<td>
<p>a function describing the pdf of the entry time for treatment.</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_enrollmenttype">enrollmentType</code></td>
<td>
<p>default value is NULL, indicating a entry time follows specified
distribution. Specify &quot;<code>piecewise uniform</code>&quot;, indicating entry time follows piecewise uniform</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_entryp">entryP</code></td>
<td>
<p>if <code>enrollmentType</code> is piecewise uniform. <code>entryP</code> should be provided with
a list containing the enrollment rate at each interval</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_hr_fun">HR_fun</code></td>
<td>
<p>a function describing the hazard ratio function between treatment
and control group</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_ratio">ratio</code></td>
<td>
<p>allocation ratio between treatment and control group.
For example, <code>ratio</code>=2 if 2:1 allocation is used.</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_curemodel">cureModel</code></td>
<td>
<p>specifies the cure model. &quot;<code>PHCM</code>&quot; and &quot;<code>PHCRM</code>&quot;.</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_curerate1">cureRate1</code></td>
<td>
<p>specifies the cure rate for the susceptible population in the experimental group if the cure model is <code>PHCM</code>.</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_hr_data">HR_data</code></td>
<td>
<p>a matrix consisting of covariates values</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_upint">upInt</code></td>
<td>
<p>a value indicating the upper bound used in the <code>uniroot</code> function.
See details.  Default: 100</p>
</td></tr>
<tr><td><code id="simu.trial_+3A_summary">summary</code></td>
<td>
<p>a logical indicating whether basic information summary is printed
to the console or not, Default: TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The loglogistic distribution for the event time has the
survival function <code class="reqn">S(x)=b^a/(b^a+x^a)</code> and hazard function
<code class="reqn">\lambda(x)=a/b(x/b)^{a-1}/(1+(t/b)^a)</code>, where <code class="reqn">a</code> is the shape parameter
and <code class="reqn">b</code> is the scale parameter. The weibull distribution for event time and drop-out
time has the survival function <code class="reqn">S(x)=exp(-(xb)^a)</code>
and hazard function <code class="reqn">\lambda(x)=ab(xb)^{a-1}</code>, where <code class="reqn">a</code> is the shape parameter
and <code class="reqn">b</code> is the rate parameter. The median of weibull
distribution is <code class="reqn">(ln(2)^{1/a}/b)</code>. If drop out or loss to follow-up are
do not need to be considered, a very small rate parameter <code class="reqn">b</code> can be chosen
such that the median time is greatly larger than the study duration. The default
entry time is uniformly distributed within the enrollment period by default.
Other options are allowed through providing the density function.
</p>
<p>The <code>simu.trial</code> function simulates survival times for control and
treatment groups separately. The control survival times are drawn from standard parametric
distribution (Weibull, Loglogistic). Let <code class="reqn">\lambda_1(t)</code> and <code class="reqn">\lambda_0(t)</code>
denote the hazard function for treatment and control. It is assumed that
<code class="reqn">\lambda_1(t)/\lambda_0(t)=g(t)</code>, where <code class="reqn">g(t)</code> is the user-defined
function, describing the change of hazard ratio over time. In case of proportional
hazards, <code class="reqn">g(t)</code> is a constant. The survival function for treatment group
is <code class="reqn">S_1(t)=exp(-\int_0^t g(s)\lambda_0(s)ds)</code>. The Survival time T is
given by <code class="reqn">T=S_1^(-1)(U)</code>, where U is drawn from uniform (0,1). More details
can be found in Bender, et al. (2005). Function <code>uniroot</code> from
<code>stats</code> package is used to generate the random variable. The argument
<code>upInt</code> in <code>simu.trial</code> function corresponds to the upper end point
of the search interval and it can be adjusted by user if the default value 100
is not appropriate. More details can be found in help file of <code>uniroot</code>
function.
</p>


<h3>Value</h3>

<p>A list containing the following components
</p>
<p><code>data</code>: a dataframe (simulated dataset) with columns:
</p>

<dl>
<dt>id</dt><dd><p>identifier number from 1:n, n is the total sample size</p>
</dd>
<dt>group</dt><dd><p>group variable with 1 indicating treatment and 0 indicating control</p>
</dd>
<dt>aval</dt><dd><p>observed survival time, the earliest time among event time,
drop-out time and end of study time</p>
</dd>
<dt>cnsr</dt><dd><p>censoring indicator with 1 indicating censor and 0 indicating event</p>
</dd>
<dt>cnsr.desc</dt><dd><p>description of the <code>cnsr</code> status, including three options-
drop-out, event and end of study. Both drop-out and end of study are considered as
censor.</p>
</dd>
<dt>event</dt><dd><p>event indicator with 1 indicating event and 0 indicating censor</p>
</dd>
<dt>entry.time</dt><dd><p>time when the patient is enrolled in the study</p>
</dd>
</dl>

<p>a list of summary information of the trial including
</p>

<dl>
<dt><code>type</code></dt><dd><p>a character indicating input design type - <code>event</code> or <code>time</code></p>
</dd>
<dt><code>entrytime</code></dt><dd><p>a number indicating input enrollment period</p>
</dd>
<dt><code>maxob</code></dt><dd><p>a number indicating the maximum study duration. For <code>time</code>
type of design, the value is equal to the enrollment period plus the follow-up
period. For <code>event</code> type of design, the value is the calendar time of the
last event.</p>
</dd>
</dl>



<h3>References</h3>

<p>Bender, R., Augustin, T., &amp; Blettner, M. (2005). Generating survival times to simulate Cox proportional
hazards models. Statistics in medicine, 24(11), 1713-1723.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Weibull">Weibull</a></code>, <code><a href="stats.html#topic+integrate">integrate</a></code>, <code><a href="stats.html#topic+Logistic">Logistic</a></code>, <code><a href="stats.html#topic+Uniform">Uniform</a></code>, <code><a href="stats.html#topic+optimize">optimize</a></code>, <code><a href="stats.html#topic+uniroot">uniroot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># total sample size
N &lt;- 300
# target event
E &lt;- 100
# allocation ratio
RR &lt;- 2
# enrollment time
entry &lt;- 12
# follow-up time
fup &lt;- 18
# shape and scale parameter of weibull for entry time
b_weibull &lt;- c(1,log(2)/18)
# shape and scale parameter of weibull for drop-out time
drop_weibull &lt;- c(1,log(2)/30)
# hazard ratio function (constant)
HRf &lt;- function(x){0.8*x^0}

### event-driven trial
set.seed(123445)
data1 &lt;- simu.trial(type="event",trial_param=c(N,entry,E),bsl_dist="weibull",
                    bsl_param=b_weibull,drop_param0=drop_weibull,HR_fun=HRf,
                    ratio=RR)

### fixed study duration
set.seed(123445)
data2 &lt;- simu.trial(type="time",trial_param=c(N,entry,fup),bsl_dist="weibull",
                    bsl_param=b_weibull,drop_param0=drop_weibull,HR_fun=HRf,
                    ratio=RR)
</code></pre>

<hr>
<h2 id='summary.NPHpwr'>Summary of the <code>pwr2n.NPH</code> function</h2><span id='topic+summary.NPHpwr'></span>

<h3>Description</h3>

<p>Summarize and print the results of <code>pwr2n.NPH</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NPHpwr'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.NPHpwr_+3A_object">object</code></td>
<td>
<p>object of the <code>pwr2n.NPH</code> function</p>
</td></tr>
<tr><td><code id="summary.NPHpwr_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the summary function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Summary results are printed to Console.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pwr2n.NPH">pwr2n.NPH</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
