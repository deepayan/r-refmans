<!DOCTYPE html><html lang="en"><head><title>Help for package plug</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {plug}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plug_download_base'><p>Download all data from a specific base</p></a></li>
<li><a href='#plug_execute_query'><p>Execute a custom SQL query on the Plug database</p></a></li>
<li><a href='#plug_get_valid_token'><p>Get a valid token for Plug API</p></a></li>
<li><a href='#plug_list_credentials'><p>List registered credentials for Plug API</p></a></li>
<li><a href='#plug_list_tokens'><p>List registered tokens for Plug API</p></a></li>
<li><a href='#plug_store_credentials'><p>Store user credentials securely for Plug API</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Secure and Intuitive Access to 'Plug' Interface</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-09</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a secure and user-friendly interface to interact with the 'Plug' <a href="https://plugbytpf.com.br">https://plugbytpf.com.br</a> 'API'. It enables developers to store and manage tokens securely using the 'keyring' package, retrieve data from 'API' endpoints with the 'httr2' package, and handle large datasets with chunked data fetching. Designed for simplicity and security, the package facilitates seamless integration with 'Plug' ecosystem.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>tibble, httr2, glue, keyring</td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="https://github.com/StrategicProjects/plug&amp;gt;">https://github.com/StrategicProjects/plug&gt;</a></td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-10 16:12:42 UTC; leite</td>
</tr>
<tr>
<td>Author:</td>
<td>Andre Leite [aut, cre],
  Felipe Ferreira [aut],
  Hugo Vaconcelos [aut],
  Diogo Bezerra [aut],
  Roger Azevedo [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andre Leite &lt;leite@castlab.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-13 17:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='plug_download_base'>Download all data from a specific base</h2><span id='topic+plug_download_base'></span>

<h3>Description</h3>

<p>This function downloads all data from a specified base using the query <code style="white-space: pre;">&#8288;SELECT * FROM base_name&#8288;</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plug_download_base(
  base_name,
  endpoint = "https://plug.der.pe.gov.br/MadrixApi/executeQuery",
  verbosity = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plug_download_base_+3A_base_name">base_name</code></td>
<td>
<p>The name of the base from which to download all data.</p>
</td></tr>
<tr><td><code id="plug_download_base_+3A_endpoint">endpoint</code></td>
<td>
<p>The endpoint URL for executing queries.</p>
</td></tr>
<tr><td><code id="plug_download_base_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level of the API request (0 = none, 1 = minimal, 2 = detailed).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing all data from the specified base.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data &lt;- plug_download_base(
  base_name = "Contratos_VIEW"
)

## End(Not run)

</code></pre>

<hr>
<h2 id='plug_execute_query'>Execute a custom SQL query on the Plug database</h2><span id='topic+plug_execute_query'></span>

<h3>Description</h3>

<p>This function executes a user-defined SQL query on the Plug database, with safe query construction
using <code>glue_sql</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plug_execute_query(
  sql_template,
  endpoint = "https://plug.der.pe.gov.br/MadrixApi/executeQuery",
  verbosity = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plug_execute_query_+3A_sql_template">sql_template</code></td>
<td>
<p>A SQL query template with placeholders for variables.</p>
</td></tr>
<tr><td><code id="plug_execute_query_+3A_endpoint">endpoint</code></td>
<td>
<p>The endpoint URL for executing queries.</p>
</td></tr>
<tr><td><code id="plug_execute_query_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level of the API request (0 = none, 1 = minimal, 2 = detailed).</p>
</td></tr>
<tr><td><code id="plug_execute_query_+3A_...">...</code></td>
<td>
<p>Named arguments to replace placeholders in the SQL template.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing the query results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data &lt;- plug_execute_query(sql_template = "SELECT TOP 1 * FROM Contratos_VIEW")

## End(Not run)

</code></pre>

<hr>
<h2 id='plug_get_valid_token'>Get a valid token for Plug API</h2><span id='topic+plug_get_valid_token'></span>

<h3>Description</h3>

<p>This function checks if a valid global token exists for the Plug API. If no valid token is found,
it generates a new token using the stored global credentials by sending a properly formatted request.
If it fails to retrieve the token (for example, due to missing credentials or network issues),
it will not throw an error but will display a message in English (&quot;No valid credentials found.&quot;) and return <code>NULL</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plug_get_valid_token(
  validity_time = 3600,
  endpoint = "https://plug.der.pe.gov.br/MadrixApi/authenticate/"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plug_get_valid_token_+3A_validity_time">validity_time</code></td>
<td>
<p>The validity period of the token in seconds. Default is 3600 (1 hour).</p>
</td></tr>
<tr><td><code id="plug_get_valid_token_+3A_endpoint">endpoint</code></td>
<td>
<p>The endpoint URL for generating the token.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The valid token as a string, or <code>NULL</code> if no valid credentials were found or an error occurred.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
token &lt;- plug_get_valid_token(validity_time = 3600)

## End(Not run)

</code></pre>

<hr>
<h2 id='plug_list_credentials'>List registered credentials for Plug API</h2><span id='topic+plug_list_credentials'></span>

<h3>Description</h3>

<p>This function lists all globally stored credentials (username and password) for the Plug API.
If none are found or an error occurs, it displays a message in English (&quot;No credentials found for Plug API.&quot;)
and returns an empty list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plug_list_credentials()
</code></pre>


<h3>Value</h3>

<p>A named list with <code>username</code> and <code>password</code> fields if credentials are found,
or an empty list if no credentials are stored.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
plug_list_credentials()

## End(Not run)

</code></pre>

<hr>
<h2 id='plug_list_tokens'>List registered tokens for Plug API</h2><span id='topic+plug_list_tokens'></span>

<h3>Description</h3>

<p>This function lists the stored API token and its expiration time for the Plug API.
If none are found or an error occurs, it displays a message in English (&quot;No token found for Plug API.&quot;)
and returns an empty list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plug_list_tokens()
</code></pre>


<h3>Value</h3>

<p>A named list with <code>token</code> and <code>expiration</code> fields if a token is found,
or an empty list if no token is stored.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
plug_list_tokens()

## End(Not run)

</code></pre>

<hr>
<h2 id='plug_store_credentials'>Store user credentials securely for Plug API</h2><span id='topic+plug_store_credentials'></span>

<h3>Description</h3>

<p>This function securely stores the global username and password required to authenticate with the Plug application.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plug_store_credentials(username, password)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plug_store_credentials_+3A_username">username</code></td>
<td>
<p>The username for the Plug.</p>
</td></tr>
<tr><td><code id="plug_store_credentials_+3A_password">password</code></td>
<td>
<p>The password for the Plug.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. The credentials are securely stored.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plug_store_credentials("myusername", "mypassword")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
