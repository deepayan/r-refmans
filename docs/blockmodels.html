<!DOCTYPE html><html lang="en"><head><title>Help for package blockmodels</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {blockmodels}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BM_bernoulli'><p>Perform estimation on blockmodels for bernoulli probability distribution</p></a></li>
<li><a href='#BM_bernoulli_covariates'><p>Perform estimation on blockmodels for bernoulli probability distribution</p>
aith covariates</a></li>
<li><a href='#BM_bernoulli_covariates_fast'><p>Perform estimation on blockmodels for bernoulli probability distribution</p>
aith covariates</a></li>
<li><a href='#BM_bernoulli_multiplex'><p>Perform estimation on blockmodels for multiplex binary networks</p></a></li>
<li><a href='#BM_gaussian'><p>Perform estimation on blockmodels for gaussian probability distribution</p></a></li>
<li><a href='#BM_gaussian_covariates'><p>Perform estimation on blockmodels for gaussian probability distribution</p>
with covariates</a></li>
<li><a href='#BM_gaussian_multivariate'><p>Perform estimation on blockmodels for multivariate gaussian probability distribution</p></a></li>
<li><a href='#BM_gaussian_multivariate_independent'><p>Perform estimation on blockmodels for multivariate independent</p>
homoscedastic gaussian probability distribution</a></li>
<li><a href='#BM_gaussian_multivariate_independent_homoscedastic'><p>Perform estimation on blockmodels for multivariate independent</p>
homoscedastic gaussian probability distribution</a></li>
<li><a href='#BM_poisson'><p>Perform estimation on blockmodels for poisson probability distribution</p></a></li>
<li><a href='#BM_poisson_covariates'><p>Perform estimation on blockmodels for poisson probability distribution</p>
aith covariates</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Latent and Stochastic Block Model Estimation by a 'V-EM'
Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-12-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Jean-Benoist Leger &lt;jbleger@hds.utc.fr&gt;, Pierre Barbillon &lt;pierre.barbillon@agroparistech.fr&gt;, Julien Chiquet &lt;julien.chiquet@inrae.fr&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jean-Benoist Leger &lt;jbleger@hds.utc.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Latent and Stochastic Block Model estimation by a Variational EM algorithm.
             Various probability distribution are provided (Bernoulli,
             Poisson...), with or without covariates.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, parallel, methods, digest</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-01 10:42:01 UTC; jbleger</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-01 11:20:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='BM_bernoulli'>Perform estimation on blockmodels for bernoulli probability distribution</h2><span id='topic+BM_bernoulli'></span><span id='topic++5CS4method+7BBM_bernoulli+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_bernoulli(
    membership_type, 
    adj, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_bernoulli_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_bernoulli_+3A_adj">adj</code></td>
<td>
<p>The adjacency matrix</p>
</td></tr>
<tr><td><code id="BM_bernoulli_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_bernoulli_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
P&lt;-matrix(runif(Q*Q),Q,Q)
M&lt;-1*(matrix(runif(n*n),n,n)&lt;Z%*%P%*%t(Z)) ## adjacency matrix

## estimation
my_model &lt;- BM_bernoulli("SBM",M )
my_model$estimate()
which.max(my_model$ICL)

##
## SBM symmetric
##

## generation of one SBM_sym network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
P&lt;-matrix(runif(Q*Q),Q,Q)
P[lower.tri(P)]&lt;-t(P)[lower.tri(P)]
M&lt;-1*(matrix(runif(n*n),n,n)&lt;Z%*%P%*%t(Z)) ## adjacency matrix
M[lower.tri(M)]&lt;-t(M)[lower.tri(M)]

## estimation
my_model &lt;- BM_bernoulli("SBM_sym",M )
my_model$estimate()
which.max(my_model$ICL)

##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
P&lt;-matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
M&lt;-1*(matrix(runif(n[1]*n[2]),n[1],n[2])&lt;Z1%*%P%*%t(Z2)) ## adjacency matrix

## estimation
my_model &lt;- BM_bernoulli("LBM",M )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_bernoulli_covariates'>Perform estimation on blockmodels for bernoulli probability distribution
aith covariates</h2><span id='topic+BM_bernoulli_covariates'></span><span id='topic++5CS4method+7BBM_bernoulli_covariates+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership, and impact vector of covariates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_bernoulli_covariates(
    membership_type, 
    adj, 
    covariates, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_bernoulli_covariates_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_+3A_adj">adj</code></td>
<td>
<p>The adjacency matrix</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_+3A_covariates">covariates</code></td>
<td>
<p>Covariates matrix, or list of covariates matrices. Covariates matrix must have the same size than the adjacency matrix.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_bernoulli_covariates_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
sigmo &lt;- function(x){1/(1+exp(-x))}
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mg&lt;-8*matrix(runif(Q*Q),Q,Q)-4
Y1 &lt;- matrix(runif(n*n),n,n)-.5
Y2 &lt;- matrix(runif(n*n),n,n)-.5
M_in_expectation&lt;-sigmo(Z%*%Mg%*%t(Z) + 5*Y1-3*Y2)
M&lt;-1*(matrix(runif(n*n),n,n)&lt;M_in_expectation)

## estimation
my_model &lt;- BM_bernoulli_covariates("SBM",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)


##
## SBM symmetric
##

## generation of one SBM_sym network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
sigmo &lt;- function(x){1/(1+exp(-x))}
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mg&lt;-8*matrix(runif(Q*Q),Q,Q)-4
Mg[lower.tri(Mg)]&lt;-t(Mg)[lower.tri(Mg)]
Y1 &lt;- matrix(runif(n*n),n,n)-.5
Y2 &lt;- matrix(runif(n*n),n,n)-.5
Y1[lower.tri(Y1)]&lt;-t(Y1)[lower.tri(Y1)]
Y2[lower.tri(Y2)]&lt;-t(Y2)[lower.tri(Y2)]
M_in_expectation&lt;-sigmo(Z%*%Mg%*%t(Z) + 5*Y1-3*Y2)
M&lt;-1*(matrix(runif(n*n),n,n)&lt;M_in_expectation)
M[lower.tri(M)]&lt;-t(M)[lower.tri(M)]

## estimation
my_model &lt;- BM_bernoulli_covariates("SBM_sym",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)



##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
sigmo &lt;- function(x){1/(1+exp(-x))}
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
Mg&lt;-8*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])-4
Y1 &lt;- matrix(runif(n[1]*n[2]),n[1],n[2])-.5
Y2 &lt;- matrix(runif(n[1]*n[2]),n[1],n[2])-.5
M_in_expectation&lt;-sigmo(Z1%*%Mg%*%t(Z2) + 5*Y1-3*Y2)
M&lt;-1*(matrix(runif(n[1]*n[2]),n[1],n[2])&lt;M_in_expectation)

## estimation
my_model &lt;- BM_bernoulli_covariates("LBM",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_bernoulli_covariates_fast'>Perform estimation on blockmodels for bernoulli probability distribution
aith covariates</h2><span id='topic+BM_bernoulli_covariates_fast'></span><span id='topic++5CS4method+7BBM_bernoulli_covariates_fast+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership, and impact vector of covariates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_bernoulli_covariates_fast(
    membership_type,
    adj,
    covariates,
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_adj">adj</code></td>
<td>
<p>The adjacency matrix</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_covariates">covariates</code></td>
<td>
<p>Covariates matrix, or list of covariates matrices. Covariates matrix must have the same size than the adjacency matrix.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_bernoulli_covariates_fast_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_covariates_fast_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
sigmo &lt;- function(x){1/(1+exp(-x))}
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mg&lt;-8*matrix(runif(Q*Q),Q,Q)-4
Y1 &lt;- matrix(runif(n*n),n,n)-.5
Y2 &lt;- matrix(runif(n*n),n,n)-.5
M_in_expectation&lt;-sigmo(Z%*%Mg%*%t(Z) + 5*Y1-3*Y2)
M&lt;-1*(matrix(runif(n*n),n,n)&lt;M_in_expectation)

## estimation
my_model &lt;- BM_bernoulli_covariates_fast("SBM",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)


##
## SBM symmetric
##

## generation of one SBM_sym network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
sigmo &lt;- function(x){1/(1+exp(-x))}
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mg&lt;-8*matrix(runif(Q*Q),Q,Q)-4
Mg[lower.tri(Mg)]&lt;-t(Mg)[lower.tri(Mg)]
Y1 &lt;- matrix(runif(n*n),n,n)-.5
Y2 &lt;- matrix(runif(n*n),n,n)-.5
Y1[lower.tri(Y1)]&lt;-t(Y1)[lower.tri(Y1)]
Y2[lower.tri(Y2)]&lt;-t(Y2)[lower.tri(Y2)]
M_in_expectation&lt;-sigmo(Z%*%Mg%*%t(Z) + 5*Y1-3*Y2)
M&lt;-1*(matrix(runif(n*n),n,n)&lt;M_in_expectation)
M[lower.tri(M)]&lt;-t(M)[lower.tri(M)]

## estimation
my_model &lt;- BM_bernoulli_covariates_fast("SBM_sym",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)



##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
sigmo &lt;- function(x){1/(1+exp(-x))}
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
Mg&lt;-8*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])-4
Y1 &lt;- matrix(runif(n[1]*n[2]),n[1],n[2])-.5
Y2 &lt;- matrix(runif(n[1]*n[2]),n[1],n[2])-.5
M_in_expectation&lt;-sigmo(Z1%*%Mg%*%t(Z2) + 5*Y1-3*Y2)
M&lt;-1*(matrix(runif(n[1]*n[2]),n[1],n[2])&lt;M_in_expectation)

## estimation
my_model &lt;- BM_bernoulli_covariates_fast("LBM",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_bernoulli_multiplex'>Perform estimation on blockmodels for multiplex binary networks</h2><span id='topic+BM_bernoulli_multiplex'></span><span id='topic++5CS4method+7BBM_bernoulli_multiplex+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_bernoulli_multiplex(
    membership_type, 
    adj, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_bernoulli_multiplex_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_bernoulli_multiplex_+3A_adj">adj</code></td>
<td>
<p>The list of adjacency matrices. All matrices must have the same size</p>
</td></tr>
<tr><td><code id="BM_bernoulli_multiplex_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_multiplex_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_multiplex_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_bernoulli_multiplex_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_multiplex_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_multiplex_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_multiplex_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_bernoulli_multiplex_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
P00&lt;-matrix(runif(Q*Q),Q,Q)
P10&lt;-matrix(runif(Q*Q),Q,Q)
P01&lt;-matrix(runif(Q*Q),Q,Q)
P11&lt;-matrix(runif(Q*Q),Q,Q)
SumP&lt;-P00+P10+P01+P11
P00&lt;-P00/SumP
P01&lt;-P01/SumP
P10&lt;-P10/SumP
P11&lt;-P11/SumP
MU&lt;-matrix(runif(n*n),n,n)
M1&lt;-1*(MU&gt;Z%*%(P00+P01)%*%t(Z))
M2&lt;-1*((MU&gt;Z%*%P00%*%t(Z)) &amp; (MU&lt;Z%*%(P00+P01+P11)%*%t(Z))) ## adjacency matrices


## estimation
my_model &lt;- BM_bernoulli_multiplex("SBM",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

##
## SBM symmetric
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
P00&lt;-matrix(runif(Q*Q),Q,Q)
P10&lt;-matrix(runif(Q*Q),Q,Q)
P01&lt;-matrix(runif(Q*Q),Q,Q)
P11&lt;-matrix(runif(Q*Q),Q,Q)
SumP&lt;-P00+P10+P01+P11
P00&lt;-P00/SumP
P01&lt;-P01/SumP
P10&lt;-P10/SumP
P11&lt;-P11/SumP
P00[lower.tri(P00)]&lt;-t(P00)[lower.tri(P00)]
P01[lower.tri(P01)]&lt;-t(P01)[lower.tri(P01)]
P10[lower.tri(P10)]&lt;-t(P10)[lower.tri(P10)]
P11[lower.tri(P11)]&lt;-t(P11)[lower.tri(P11)]
MU&lt;-matrix(runif(n*n),n,n)
MU[lower.tri(MU)]&lt;-t(MU)[lower.tri(MU)]
M1&lt;-1*(MU&gt;Z%*%(P00+P01)%*%t(Z))
M2&lt;-1*((MU&gt;Z%*%P00%*%t(Z)) &amp; (MU&lt;Z%*%(P00+P01+P11)%*%t(Z))) ## adjacency matrices


## estimation
my_model &lt;- BM_bernoulli_multiplex("SBM_sym",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)


##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
P00&lt;-matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
P10&lt;-matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
P01&lt;-matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
P11&lt;-matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
SumP&lt;-P00+P10+P01+P11
P00&lt;-P00/SumP
P01&lt;-P01/SumP
P10&lt;-P10/SumP
P11&lt;-P11/SumP
MU&lt;-matrix(runif(n[1]*n[2]),n[1],n[2])
M1&lt;-1*(MU&gt;Z1%*%(P00+P01)%*%t(Z2))
M2&lt;-1*((MU&gt;Z1%*%P00%*%t(Z2)) &amp; (MU&lt;Z1%*%(P00+P01+P11)%*%t(Z2))) ## adjacency matrices


## estimation
my_model &lt;- BM_bernoulli_multiplex("LBM",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_gaussian'>Perform estimation on blockmodels for gaussian probability distribution</h2><span id='topic+BM_gaussian'></span><span id='topic++5CS4method+7BBM_gaussian+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_gaussian(
    membership_type, 
    adj, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_gaussian_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_gaussian_+3A_adj">adj</code></td>
<td>
<p>The adjacency matrix</p>
</td></tr>
<tr><td><code id="BM_gaussian_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_gaussian_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_gaussian_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu&lt;-20*matrix(runif(Q*Q),Q,Q)
M&lt;-matrix(rnorm(n*n,sd=10),n,n)+Z%*%Mu%*%t(Z) ## adjacency matrix

## estimation
my_model &lt;- BM_gaussian("SBM",M )
my_model$estimate()
which.max(my_model$ICL)

##
## SBM symmetric
##

## generation of one SBM_sym network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu&lt;-20*matrix(runif(Q*Q),Q,Q)
Mu[lower.tri(Mu)]&lt;-t(Mu)[lower.tri(Mu)]
M&lt;-matrix(rnorm(n*n,sd=10),n,n)+Z%*%Mu%*%t(Z) ## adjacency matrix
M[lower.tri(M)]&lt;-t(M)[lower.tri(M)]

## estimation
my_model &lt;- BM_gaussian("SBM_sym",M )
my_model$estimate()
which.max(my_model$ICL)

##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
Mu&lt;-20*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
M&lt;-matrix(rnorm(n[1]*n[2],sd=10),n[1],n[2])+Z1%*%Mu%*%t(Z2) ## adjacency matrix

## estimation
my_model &lt;- BM_gaussian("LBM",M )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_gaussian_covariates'>Perform estimation on blockmodels for gaussian probability distribution
with covariates</h2><span id='topic+BM_gaussian_covariates'></span><span id='topic++5CS4method+7BBM_gaussian_covariates+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership and impact vector of covariates</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_gaussian_covariates(
    membership_type, 
    adj, 
    covariates, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_gaussian_covariates_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_gaussian_covariates_+3A_adj">adj</code></td>
<td>
<p>The adjacency matrix</p>
</td></tr>
<tr><td><code id="BM_gaussian_covariates_+3A_covariates">covariates</code></td>
<td>
<p>Covariates matrix, or list of covariates matrices. Covariates matrix must have the same size than the adjacency matrix.</p>
</td></tr>
<tr><td><code id="BM_gaussian_covariates_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_covariates_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_covariates_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_gaussian_covariates_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_covariates_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_covariates_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_covariates_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_gaussian_covariates_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu&lt;-20*matrix(runif(Q*Q),Q,Q)
Y1 &lt;- matrix(runif(n*n),n,n)
Y2 &lt;- matrix(runif(n*n),n,n)
M&lt;-matrix(rnorm(n*n,sd=5),n,n)+Z%*%Mu%*%t(Z)+4.2*Y1-1.6*Y2 ## adjacency matrix

## estimation
my_model &lt;- BM_gaussian_covariates("SBM",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)

##
## SBM symmetric
##

## generation of one SBM_sym network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu&lt;-20*matrix(runif(Q*Q),Q,Q)
Mu[lower.tri(Mu)]&lt;-t(Mu)[lower.tri(Mu)]
Y1 &lt;- matrix(runif(n*n),n,n)
Y2 &lt;- matrix(runif(n*n),n,n)
Y1[lower.tri(Y1)]&lt;-t(Y1)[lower.tri(Y1)]
Y2[lower.tri(Y2)]&lt;-t(Y2)[lower.tri(Y2)]
M&lt;-matrix(rnorm(n*n,sd=5),n,n)+Z%*%Mu%*%t(Z)+4.2*Y1-1.6*Y2 ## adjacency matrix
M[lower.tri(M)]&lt;-t(M)[lower.tri(M)]

## estimation
my_model &lt;- BM_gaussian_covariates("SBM_sym",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)

##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
Mu&lt;-20*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
Y1 &lt;- matrix(runif(n[1]*n[2]),n[1],n[2])
Y2 &lt;- matrix(runif(n[1]*n[2]),n[1],n[2])
M&lt;-matrix(rnorm(n[1]*n[2],sd=5),n[1],n[2])+Z1%*%Mu%*%t(Z2)+4.2*Y1-1.6*Y2 ## adjacency matrix

## estimation
my_model &lt;- BM_gaussian_covariates("LBM",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_gaussian_multivariate'>Perform estimation on blockmodels for multivariate gaussian probability distribution</h2><span id='topic+BM_gaussian_multivariate'></span><span id='topic++5CS4method+7BBM_gaussian_multivariate+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_gaussian_multivariate(
    membership_type, 
    adj, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_gaussian_multivariate_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_+3A_adj">adj</code></td>
<td>
<p>The list of adjacency matrices. All matrices must have the same size</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_gaussian_multivariate_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu1&lt;-4*matrix(runif(Q*Q),Q,Q)
Mu2&lt;-4*matrix(runif(Q*Q),Q,Q)
Noise1&lt;-matrix(rnorm(n*n,sd=1),n,n)
Noise2&lt;-matrix(rnorm(n*n,sd=1),n,n)
M1&lt;- Z%*%Mu1%*%t(Z) + Noise1
M2&lt;- Z%*%Mu2%*%t(Z) + 10*Noise1 + Noise2

## estimation
my_model &lt;- BM_gaussian_multivariate("SBM",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

##
## SBM symmetric
##

## generation of one SBM_sym network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu1&lt;-4*matrix(runif(Q*Q),Q,Q)
Mu2&lt;-4*matrix(runif(Q*Q),Q,Q)
Noise1&lt;-matrix(rnorm(n*n,sd=1),n,n)
Noise2&lt;-matrix(rnorm(n*n,sd=1),n,n)
M1&lt;- Z%*%Mu1%*%t(Z) + Noise1
M2&lt;- Z%*%Mu2%*%t(Z) + 10*Noise1 + Noise2
M1[lower.tri(M1)]&lt;-t(M1)[lower.tri(M1)]
M2[lower.tri(M2)]&lt;-t(M2)[lower.tri(M2)]

## estimation
my_model &lt;- BM_gaussian_multivariate("SBM_sym",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
Mu1&lt;-4*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
Mu2&lt;-4*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
Noise1&lt;-matrix(rnorm(n[1]*n[2],sd=1),n[1],n[2])
Noise2&lt;-matrix(rnorm(n[1]*n[2],sd=1),n[1],n[2])
M1&lt;-Z1%*%Mu1%*%t(Z2) + Noise1 ## adjacency
M2&lt;-Z1%*%Mu2%*%t(Z2) + 10*Noise1 + Noise2 ## adjacency

## estimation
my_model &lt;- BM_gaussian_multivariate("LBM",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_gaussian_multivariate_independent'>Perform estimation on blockmodels for multivariate independent
homoscedastic gaussian probability distribution</h2><span id='topic+BM_gaussian_multivariate_independent'></span><span id='topic++5CS4method+7BBM_gaussian_multivariate_independent+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_gaussian_multivariate_independent(
    membership_type, 
    adj, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_gaussian_multivariate_independent_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_+3A_adj">adj</code></td>
<td>
<p>The list of adjacency matrices. All matrices must have the same size</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_gaussian_multivariate_independent_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu1&lt;-8*matrix(runif(Q*Q),Q,Q)
Mu2&lt;-8*matrix(runif(Q*Q),Q,Q)
M1&lt;-matrix(rnorm(n*n,sd=5),n,n)+Z%*%Mu1%*%t(Z) ## adjacency
M2&lt;-matrix(rnorm(n*n,sd=10),n,n)+Z%*%Mu2%*%t(Z) ## adjacency

## estimation
my_model &lt;- BM_gaussian_multivariate_independent("SBM",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

##
## SBM symmetric
##

## generation of one SBM_sym network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu1&lt;-8*matrix(runif(Q*Q),Q,Q)
Mu2&lt;-8*matrix(runif(Q*Q),Q,Q)
Mu1[lower.tri(Mu1)]&lt;-t(Mu1)[lower.tri(Mu1)]
Mu2[lower.tri(Mu2)]&lt;-t(Mu2)[lower.tri(Mu2)]
M1&lt;-matrix(rnorm(n*n,sd=5),n,n)+Z%*%Mu1%*%t(Z) ## adjacency
M2&lt;-matrix(rnorm(n*n,sd=10),n,n)+Z%*%Mu2%*%t(Z) ## adjacency
M1[lower.tri(M1)]&lt;-t(M1)[lower.tri(M1)]
M2[lower.tri(M2)]&lt;-t(M2)[lower.tri(M2)]

## estimation
my_model &lt;- BM_gaussian_multivariate_independent("SBM_sym",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
Mu1&lt;-8*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
Mu2&lt;-8*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
M1&lt;-matrix(rnorm(n[1]*n[2],sd=5),n[1],n[2])+Z1%*%Mu1%*%t(Z2) ## adjacency
M2&lt;-matrix(rnorm(n[1]*n[2],sd=10),n[1],n[2])+Z1%*%Mu2%*%t(Z2) ## adjacency

## estimation
my_model &lt;- BM_gaussian_multivariate_independent("LBM",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_gaussian_multivariate_independent_homoscedastic'>Perform estimation on blockmodels for multivariate independent
homoscedastic gaussian probability distribution</h2><span id='topic+BM_gaussian_multivariate_independent_homoscedastic'></span><span id='topic++5CS4method+7BBM_gaussian_multivariate_independent_homoscedastic+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_gaussian_multivariate_independent_homoscedastic(
    membership_type, 
    adj, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_adj">adj</code></td>
<td>
<p>The list of adjacency matrices. All matrices must have the same size</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_gaussian_multivariate_independent_homoscedastic_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu1&lt;-4*matrix(runif(Q*Q),Q,Q)
Mu2&lt;-4*matrix(runif(Q*Q),Q,Q)
M1&lt;-matrix(rnorm(n*n,sd=5),n,n)+Z%*%Mu1%*%t(Z) ## adjacency
M2&lt;-matrix(rnorm(n*n,sd=5),n,n)+Z%*%Mu2%*%t(Z) ## adjacency

## estimation
my_model &lt;- BM_gaussian_multivariate_independent_homoscedastic("SBM",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

##
## SBM symmetric
##

## generation of one SBM_sym network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
Mu1&lt;-4*matrix(runif(Q*Q),Q,Q)
Mu2&lt;-4*matrix(runif(Q*Q),Q,Q)
Mu1[lower.tri(Mu1)]&lt;-t(Mu1)[lower.tri(Mu1)]
Mu2[lower.tri(Mu2)]&lt;-t(Mu2)[lower.tri(Mu2)]
M1&lt;-matrix(rnorm(n*n,sd=5),n,n)+Z%*%Mu1%*%t(Z) ## adjacency
M2&lt;-matrix(rnorm(n*n,sd=5),n,n)+Z%*%Mu2%*%t(Z) ## adjacency
M1[lower.tri(M1)]&lt;-t(M1)[lower.tri(M1)]
M2[lower.tri(M2)]&lt;-t(M2)[lower.tri(M2)]

## estimation
my_model &lt;- BM_gaussian_multivariate_independent_homoscedastic("SBM_sym",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
Mu1&lt;-4*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
Mu2&lt;-4*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
M1&lt;-matrix(rnorm(n[1]*n[2],sd=5),n[1],n[2])+Z1%*%Mu1%*%t(Z2) ## adjacency
M2&lt;-matrix(rnorm(n[1]*n[2],sd=5),n[1],n[2])+Z1%*%Mu2%*%t(Z2) ## adjacency

## estimation
my_model &lt;- BM_gaussian_multivariate_independent_homoscedastic("LBM",list(M1,M2) )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_poisson'>Perform estimation on blockmodels for poisson probability distribution</h2><span id='topic+BM_poisson'></span><span id='topic++5CS4method+7BBM_poisson+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_poisson(
    membership_type, 
    adj, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_poisson_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_poisson_+3A_adj">adj</code></td>
<td>
<p>The adjacency matrix</p>
</td></tr>
<tr><td><code id="BM_poisson_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_poisson_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_poisson_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

#
# SBM
#

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
L&lt;-70*matrix(runif(Q*Q),Q,Q)
M_in_expectation&lt;-Z%*%L%*%t(Z)
M&lt;-matrix(
    rpois(
        length(as.vector(M_in_expectation)),
        as.vector(M_in_expectation))
    ,n,n)

## estimation
my_model &lt;- BM_poisson("SBM",M )
my_model$estimate()
which.max(my_model$ICL)

##
## SBM symmetric
##

## generation of one SBM_sym network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
L&lt;-70*matrix(runif(Q*Q),Q,Q)
L[lower.tri(L)]&lt;-t(L)[lower.tri(L)]
M_in_expectation&lt;-Z%*%L%*%t(Z)
M&lt;-matrix(
    rpois(
        length(as.vector(M_in_expectation)),
        as.vector(M_in_expectation))
    ,n,n)
M[lower.tri(M)]&lt;-t(M)[lower.tri(M)]

## estimation
my_model &lt;- BM_poisson("SBM_sym",M )
my_model$estimate()
which.max(my_model$ICL)

##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
L&lt;-70*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
M_in_expectation&lt;-Z1%*%L%*%t(Z2)
M&lt;-matrix(
    rpois(
        length(as.vector(M_in_expectation)),
        as.vector(M_in_expectation))
    ,n[1],n[2])

## estimation
my_model &lt;- BM_poisson("LBM",M )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

<hr>
<h2 id='BM_poisson_covariates'>Perform estimation on blockmodels for poisson probability distribution
aith covariates</h2><span id='topic+BM_poisson_covariates'></span><span id='topic++5CS4method+7BBM_poisson_covariates+7D+7Bnew+7D'></span>

<h3>Description</h3>

<p>With the provided network and blockmodel type, estimate number of groups,
parameters and node membership, and impact vector of covariates</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'new'
BM_poisson_covariates(
    membership_type, 
    adj, 
    covariates, 
    verbosity=6,
    autosave='',
    plotting=character(0),
    exploration_factor=1.5,
    exploration_direction=numeric(0),
    explore_min=4,
    explore_max=Inf,
    ncores=detectCores())</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BM_poisson_covariates_+3A_membership_type">membership_type</code></td>
<td>
<p>The type of node membership, i.e. 'SBM', 'SBM_sym' or 'LBM'</p>
</td></tr>
<tr><td><code id="BM_poisson_covariates_+3A_adj">adj</code></td>
<td>
<p>The adjacency matrix</p>
</td></tr>
<tr><td><code id="BM_poisson_covariates_+3A_covariates">covariates</code></td>
<td>
<p>Covariates matrix, or list of covariates matrices. Covariates matrix must have the same size than the adjacency matrix.</p>
</td></tr>
<tr><td><code id="BM_poisson_covariates_+3A_verbosity">verbosity</code></td>
<td>
<p>The verbosity level, 0 means quiet. Level 1 display the phase of reinitialization. Level 2 display the level 1 and the ascending and descending phase for the number of groups. Level 3 display the level 2 and the number current number of groups which is estimated. Level 4 display the level 3 and the steps inside the estimation. Level 5 display the level 4, the current status of parallel running jobs and the current sub-step. Level 6 display level 5 and informations about ICL criteria found. Default is level 6. This parameter can be changed by accessing to the field $verbosity of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_covariates_+3A_autosave">autosave</code></td>
<td>
<p>If <var>autosave</var> != &rdquo;, after each estimation, the model object is writed into file <var>autosave</var>. The model object is readable by the function <var>readRDS</var>. Use-it for long computation to allow restarting the estimation on system crash. You can use it to alanyze the partial results when the estimation is running. This parameter can be changed by accessing to the field $autosave of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_covariates_+3A_plotting">plotting</code></td>
<td>
<p>Control plot of ICL values while the estimation is running. If plotting==character(0) (the default), plots are done on screen, if plotting==&rdquo;, no plot are done, if plotting is a filename, plots are done in this filename. This parameter can be changed by accessing the field $plotting of the object.</p>
</td></tr><tr><td><code id="BM_poisson_covariates_+3A_exploration_factor">exploration_factor</code></td>
<td>
<p>Control the exploration of the number of groups. The exploration is stop when the number of groups reach exploration factor times the current maximum. By default 1.5. This parameter can be changed by accessing the field $exploration_factor of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_covariates_+3A_explore_min">explore_min</code></td>
<td>
<p>Explore to the explore_min number of groups even if the exploration_factor rule is satisfied. By default 4. This parameter can be changed by accessing the field $explore_min of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_covariates_+3A_explore_max">explore_max</code></td>
<td>
<p>Stop exploration after explore_max number of group in any case. By default Inf. This parameter can be changed by accessing the field $explore_max of the object.</p>
</td></tr>
<tr><td><code id="BM_poisson_covariates_+3A_exploration_direction">exploration_direction</code></td>
<td>
<p>Only for LBM membership. Control the exploration direction for groups number. When provided, the exploring strategy is made to explore the provided group number. Must be a vector of two integer value representing the row group number and the column group number.</p>
</td></tr>
<tr><td><code id="BM_poisson_covariates_+3A_ncores">ncores</code></td>
<td>
<p>Number of parallel jobs to launch different EM intializations. By default detectCores(). This parameter can be changed by accessing the field $ncores of the object. This parameters is used only on Linux. Parallism is disabled on other plateform. (Not working on Windows, not tested on Mac OS, not tested on *BSD.)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

##
## SBM
##

## generation of one SBM network
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
L&lt;-70*matrix(runif(Q*Q),Q,Q)
M_in_expectation_without_covariates&lt;-Z%*%L%*%t(Z)
Y1 &lt;- matrix(runif(n*n),n,n)
Y2 &lt;- matrix(runif(n*n),n,n)
M_in_expectation&lt;-M_in_expectation_without_covariates*exp(4.2*Y1-1.2*Y2)
M&lt;-matrix(
    rpois(
        length(as.vector(M_in_expectation)),
        as.vector(M_in_expectation))
    ,n,n)

## estimation
my_model &lt;- BM_poisson_covariates("SBM",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)

##
## SBM symmetric
##

## generation of one SBM_sym network, we re-use one produced for SBM
npc &lt;- 30 # nodes per class
Q &lt;- 3 # classes
n &lt;- npc * Q # nodes
Z&lt;-diag(Q)%x%matrix(1,npc,1)
L&lt;-70*matrix(runif(Q*Q),Q,Q)
L[lower.tri(L)]&lt;-t(L)[lower.tri(L)]
M_in_expectation_without_covariates&lt;-Z%*%L%*%t(Z)
Y1 &lt;- matrix(runif(n*n),n,n)
Y2 &lt;- matrix(runif(n*n),n,n)
Y1[lower.tri(Y1)]&lt;-t(Y1)[lower.tri(Y1)]
Y2[lower.tri(Y2)]&lt;-t(Y2)[lower.tri(Y2)]
M_in_expectation&lt;-M_in_expectation_without_covariates*exp(4.2*Y1-1.2*Y2)
M&lt;-matrix(
    rpois(
        length(as.vector(M_in_expectation)),
        as.vector(M_in_expectation))
    ,n,n)
M[lower.tri(M)]&lt;-t(M)[lower.tri(M)]

## estimation
my_model &lt;- BM_poisson_covariates("SBM_sym",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)

##
## LBM
##

## generation of one LBM network
npc &lt;- c(50,40) # nodes per class
Q &lt;- c(2,3) # classes
n &lt;- npc * Q # nodes
Z1&lt;-diag(Q[1])%x%matrix(1,npc[1],1)
Z2&lt;-diag(Q[2])%x%matrix(1,npc[2],1)
L&lt;-70*matrix(runif(Q[1]*Q[2]),Q[1],Q[2])
M_in_expectation_without_covariates&lt;-Z1%*%L%*%t(Z2)
Y1 &lt;- matrix(runif(n[1]*n[2]),n[1],n[2])
Y2 &lt;- matrix(runif(n[1]*n[2]),n[1],n[2])
M_in_expectation&lt;-M_in_expectation_without_covariates*exp(4.2*Y1-1.2*Y2)
M&lt;-matrix(
    rpois(
        length(as.vector(M_in_expectation)),
        as.vector(M_in_expectation))
    ,n[1],n[2])

## estimation
my_model &lt;- BM_poisson_covariates("LBM",M,list(Y1,Y2) )
my_model$estimate()
which.max(my_model$ICL)

## End(Not run)</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
