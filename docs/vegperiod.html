<!DOCTYPE html><html><head><title>Help for package vegperiod</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vegperiod}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#goe'><p>Ten years of daily average air temperature</p></a></li>
<li><a href='#method_ETCCDI'><p>Vegetation Start and End Method &quot;ETCCDI&quot;</p></a></li>
<li><a href='#method_LWF-BROOK90'><p>Vegetation End Method &quot;LWF-BROOK90&quot;</p></a></li>
<li><a href='#method_Menzel'><p>Vegetation Start Method &quot;Menzel&quot;</p></a></li>
<li><a href='#method_NuskeAlbert'><p>Vegetation End Method &quot;NuskeAlbert&quot;</p></a></li>
<li><a href='#method_Ribes'><p>Vegetation Start Method &quot;Ribes uva-crispa&quot;</p></a></li>
<li><a href='#method_vonWilpert'><p>Vegetation End Method &quot;vonWilpert&quot;</p></a></li>
<li><a href='#read.DWDdata'><p>Fetch meteo data of DWD weather stations</p></a></li>
<li><a href='#read.DWDstations'><p>Fetch list of DWD weather stations</p></a></li>
<li><a href='#vegperiod'><p>Determine vegetation period</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Determine Thermal Vegetation Periods</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of common methods to determine growing season length in
  a simple manner. Start and end dates of the vegetation periods are calculated
  solely based on daily mean temperatures and the day of the year.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://rnuske.github.io/vegperiod/">https://rnuske.github.io/vegperiod/</a>,
<a href="https://github.com/rnuske/vegperiod">https://github.com/rnuske/vegperiod</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rnuske/vegperiod/issues">https://github.com/rnuske/vegperiod/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>curl, tinytest</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-01 09:25:38 UTC; rnuske</td>
</tr>
<tr>
<td>Author:</td>
<td>Robert Nuske <a href="https://orcid.org/0000-0001-9773-2061"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Nordwestdeutsche Forstliche Versuchsanstalt (NW-FVA) [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Robert Nuske &lt;robert.nuske@mailbox.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-01 16:30:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='goe'>Ten years of daily average air temperature</h2><span id='topic+goe'></span>

<h3>Description</h3>

<p>A dataset containing ten years (2001-01-01 - 2010-12-31) of average air
temperature measured at the weather station Goettingen. The data is the result
of a reanalysis of observed data using the STARS model (cf. Orlowsky et al.
2008). They were provided by Prof. Dr. Peter Werner (PIK).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(goe)
</code></pre>


<h3>Format</h3>

<p>A data frame with 3652 rows and 6 variables:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>Variable</strong> </td><td style="text-align: left;"> <strong>Description</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
   date              </td><td style="text-align: left;"> calendar date as object of class Date</td>
</tr>
<tr>
 <td style="text-align: left;">
   year              </td><td style="text-align: left;"> years as integer</td>
</tr>
<tr>
 <td style="text-align: left;">
   month             </td><td style="text-align: left;"> month as integer </td>
</tr>
<tr>
 <td style="text-align: left;">
   day               </td><td style="text-align: left;"> day of month as integer</td>
</tr>
<tr>
 <td style="text-align: left;">
   doy               </td><td style="text-align: left;"> day of year as integer </td>
</tr>
<tr>
 <td style="text-align: left;">
   t                 </td><td style="text-align: left;"> average air temperature
</td>
</tr>

</table>



<h3>Source</h3>

<p>Prof. Dr. Peter Werner (PIK)
</p>


<h3>References</h3>

<p>Orlowsky, B., Gerstengarbe, F. W., Werner, P. C. (2008)
A resampling scheme for regional climate simulations and its performance
compared to a dynamical RCM.
<em>Theoretical and Applied Climatology</em>, <b>92</b>(3–4), 209&ndash;223.
<a href="https://doi.org/10.1007/s00704-007-0352-y">doi:10.1007/s00704-007-0352-y</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goe)
str(goe)
</code></pre>

<hr>
<h2 id='method_ETCCDI'>Vegetation Start and End Method &quot;ETCCDI&quot;</h2><span id='topic+method_ETCCDI'></span>

<h3>Description</h3>

<p>The <code>ETCCDI</code> or <code>StdMeteo</code> method was defined by  Expert Team on Climate Change Detection and Indices and is often known as Growing season Length (GSL) and widely used in climate change studies.
</p>


<h3>Calculation</h3>



<h4>Implementation of start</h4>

<p>first span of at least 6 consecutive days with daily mean temperature TG &gt; 5°C
</p>
<div class="sourceCode"><pre># mark days warmer than 5°C
df$period &lt;- ifelse(df$Tavg &gt; Tmin, 1, 0)

# find first six day span per year
start &lt;- tapply(df$period, df$year, FUN=function(x){
  sixer &lt;- as.numeric(stats::filter(x, rep(1, 6), sides=1))
  doy &lt;- which(!is.na(sixer) &amp; sixer == 6)
  ifelse(length(doy) == 0, NA, min(doy))
})
</pre></div>



<h4>Implementation of end</h4>

<p>first span after July 1st of 6 consecutive days with TG &lt; 5°C.
</p>
<div class="sourceCode"><pre># 1. July is DOY 182 and DOY 183 in leap years
years &lt;- unique(df$year)
leap_year &lt;- ifelse((years%%4==0 &amp; years%%100!=0) | years%%400==0, TRUE, FALSE)
jul1 &lt;- ifelse(leap_year, 183L, 182L)

# mark days colder than 5°C
df$period &lt;- ifelse(df$Tavg &lt; Tmin, 1, 0)

# find first six day span per year
end &lt;- ifelse(leap_year, 366L, 365L)
for(i in seq_along(years)){
  temp &lt;- df[df$year == years[i] &amp; df$DOY &gt; jul1[i], ]
  temp$six &lt;-  as.numeric(stats::filter(temp$period, rep(1, 6), sides=1))
  possible.end &lt;- temp[!is.na(temp$six) &amp; temp$six == 6, "DOY"]
  if(length(possible.end) &gt; 0)
    end[i] &lt;- min(possible.end)
}
</pre></div>



<h3>References</h3>

<p>Definition recommended by the CCl/CLIVAR/JCOMM Expert Team on Climate Change Detection and Indices (ETCCDI) http://etccdi.pacificclimate.org/list_27_indices.shtml http://www.climdex.org/indices.html
</p>
<p>European Climate Assessment (ECA) http://eca.knmi.nl/indicesextremes/indicesdictionary.php
</p>
<p>ETCCDI (2009) Climate Change Indices: Definitions of the 27 core indices. http://etccdi.pacificclimate.org/list_27_indices.shtml
Frich, P., Alexander, L., Della-Marta, P., Gleason, B., Haylock, M., Klein Tank, A. and Peterson, T. (2002) Observed coherent changes in climatic extremes during the second half of the twentieth century. Climate Research, 19, 193–212. https://doi.org/10.3354/cr019193.
http://www.climateknowledge.org/heat_waves/Doc2004_Frich_Extremes_Index_ClimResearch_2002.pdf
</p>
<p>Zhang, X., Alexander, L., Hegerl, G. C., Jones, P., Tank, A. K., Peterson, T. C., Trewin, B. and Zwiers, F. W. (2011) Indices for monitoring changes in extremes based on daily temperature and precipitation data. Wiley Interdisciplinary Reviews: Climate Change, 2(6), 851–870. https://doi.org/10.1002/wcc.147.
</p>

<hr>
<h2 id='method_LWF-BROOK90'>Vegetation End Method &quot;LWF-BROOK90&quot;</h2><span id='topic+method_LWF-BROOK90'></span>

<h3>Description</h3>

<p>The method <code>LWF-BROOK90</code> is -for the sake of convenience- a reimplementation
of the LWF-BROOK90 VBA (version 3.4) variant of &quot;vonWilpert&quot; (Hammel and
Kennel 2001). Their interpretation of von Wilpert (1990) and the somewhat
lower precision of VBA was mimicked.
</p>


<h3>Calculations</h3>

<div class="sourceCode"><pre>- starting search at June 1st
- propose end if 7-day moving average temperature is below 10°C
  on 5 consecutive days
- restart search for end if there is a warm periode (7-day moving average
  temperature above 10°C for 5 consecutive days
- nevertheless the vegetation periode stops latest at DOY 279
</pre></div>


<h3>References</h3>

<p>Hammel, K. and Kennel, M. (2001)
Charakterisierung und Analyse der Wasserverfügbarkeit und des
Wasserhaushalts von Waldstandorten in Bayern mit dem Simulationsmodell
BROOK90.
<em>Forstliche Forschungsberichte München</em>.
</p>
<p>von Wilpert, K. (1990)
Die Jahrringstruktur von Fichten in Abhängigkeit vom Bodenwasserhaushalt
auf Pseudogley und Parabraunerde: Ein Methodenkonzept zur Erfassung
standortsspezifischer Wasserstreßdispostion.
<em>Freiburger Bodenkundliche Abhandlungen</em>.
</p>

<hr>
<h2 id='method_Menzel'>Vegetation Start Method &quot;Menzel&quot;</h2><span id='topic+method_Menzel'></span>

<h3>Description</h3>

<p>The method &quot;Menzel&quot; implements the algorithm described in Menzel (1997).
The method is parameterized for 10 common tree species ( <em>Larix decidua</em>,
<em>Picea abies (frueh)</em>, <em>Picea abies (spaet)</em>, <em>Picea abies (noerdl.)</em>,
<em>Picea omorika</em>, <em>Pinus sylvestris</em>, <em>Betula pubescens</em>, <em>Quercus robur</em>,
<em>Quercus petraea</em>, <em>Fagus sylvatica</em>). It needs previous year's chill days.
</p>


<h3>Calculations</h3>

<div class="sourceCode"><pre> - counting chill days in Nov &amp; Dec of previous year if previous year available else estimate previous year's chill days
 - count chill days in current year
 - determine critical temperature per days using regression equation fitted by Menzel 1997
 - calculate HeatSum starting from Feb
 - vegetation start if HeatSum &gt;= criticalTemp
</pre></div>


<h3>References</h3>

<p>Menzel, A. (1997) Phänologie von Waldbäumen unter sich ändernden Klimabedingungen - Auswertung der Beobachtungen in den Internationalen Phänologischen Gärten und Möglichkeiten der Modellierung von Phänodaten. Forstliche Forschungsberichte München.
</p>

<hr>
<h2 id='method_NuskeAlbert'>Vegetation End Method &quot;NuskeAlbert&quot;</h2><span id='topic+method_NuskeAlbert'></span>

<h3>Description</h3>

<p>The method <code>NuskeAlbert</code> provides a very simple method which is inspired by
standard climatological procedures but employs a 7 day moving average and
a 5 °C threshold (cf. Walther and Linderholm 2006).
</p>


<h3>Calculations</h3>

<p>2 criteria: temperature &amp; short day criterion
</p>


<h4>Temperature criterion</h4>

<p>7 day moving average of daily mean temperatures
end if 5 consecutive days under under 5° C
start the search at 1st of July / vegetation start
</p>



<h4>Short day criterion</h4>

<p>last day of the vegetation period is 5th of October
</p>



<h3>References</h3>

<p>Walther, A. and Linderholm, H. W. (2006)
A comparison of growing season indices for the Greater Baltic Area.
<em>International Journal of Biometeorology</em>, <b>51</b>(2), 107&ndash;118.
<a href="https://doi.org/10.1007/s00484-006-0048-5">doi:10.1007/s00484-006-0048-5</a>.
</p>

<hr>
<h2 id='method_Ribes'>Vegetation Start Method &quot;Ribes uva-crispa&quot;</h2><span id='topic+method_Ribes'></span>

<h3>Description</h3>

<p>The method <code style="white-space: pre;">&#8288;Ribes uva-crispa&#8288;</code> is based on leaf-out of gooseberry (Janssen 2009).
It was developed by the Germany's National Meteorological Service
(Deutscher Wetterdienst, DWD) and is more robust against early starts than
common simple meteorological procedures.
</p>


<h3>Calculation</h3>

<p>starting from 18th February sum all day degrees above 0 °C (daily average air
temperature). Vegetetaion period starts at the day when 164 is crossed.
</p>
<div class="sourceCode"><pre># start day: February 18th == 49 doy
# only Tavg over 0°C are summed
df[df$DOY &lt; 49 | df$Tavg &lt; 0, 'Tavg'] &lt;- 0

# find day where cum day degrees cross 164
start &lt;- tapply(df$Tavg, df$year, FUN=function(x){
  x &lt;- cumsum(x)
  min(which(x &gt; 164))
})
</pre></div>


<h3>References</h3>

<p>Janssen, W. (2009)
Definition des Vegetationsanfanges.
<em>Internal Report, Deutscher Wetterdienst, Abteilung Agrarmeteorologie</em>.
</p>

<hr>
<h2 id='method_vonWilpert'>Vegetation End Method &quot;vonWilpert&quot;</h2><span id='topic+method_vonWilpert'></span>

<h3>Description</h3>

<p>The method <code>vonWilpert</code> is based on von Wilpert (1990). It was originally
developed for &quot;Picea abies&quot; in the Black Forest but is commonly used for all
tree species throughout Germany. As usual, the rules regarding the soilmatrix
are neglected in this implementation.
</p>


<h3>Calculations</h3>

<p>Orthodox are 3 criteria: <strong>short day</strong>, <strong>temperature</strong> and <strong>drought criterion</strong>
we consider -as usual- only short day and temperature citerion
</p>


<h4>Temperature criterion:</h4>


<ul>
<li><p> 7 day moving average of daily mean temperatures
at least 5 consecutive days under 10°C
</p>
</li>
<li><p> if afterwards more than 5 consecutive days 7 day moving average over 10°C
vegetation period gets restarted
</p>
</li></ul>




<h4>Short day criterion</h4>


<ul>
<li><p> last day of the vegetation period is DOY 279 (5th of October in leap years)
</p>
</li></ul>




<h3>References</h3>

<p>von Wilpert, K. (1990)
Die Jahrringstruktur von Fichten in Abhängigkeit vom Bodenwasserhaushalt
auf Pseudogley und Parabraunerde: Ein Methodenkonzept zur Erfassung
standortsspezifischer Wasserstreßdispostion.
<em>Freiburger Bodenkundliche Abhandlungen</em>. Pages 106&ndash;108.
</p>

<hr>
<h2 id='read.DWDdata'>Fetch meteo data of DWD weather stations</h2><span id='topic+read.DWDdata'></span>

<h3>Description</h3>

<p>Fetch observed meteorological data of German weather stations from freely
accessible part of the Climate Data Center of Germany's National
Meteorological Service (Deutscher Wetterdienst, DWD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.DWDdata(
  id,
  type = "climate",
  period = "recent",
  resolution = "daily",
  file = NULL,
  destdir = NULL,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.DWDdata_+3A_id">id</code></td>
<td>
<p>integer. A valid station id (cf. <a href="#topic+read.DWDstations">read.DWDstations</a>).</p>
</td></tr>
<tr><td><code id="read.DWDdata_+3A_type">type</code></td>
<td>
<p>string. Stations can be of type &lsquo;<span class="samp">&#8288;"climate"&#8288;</span>&rsquo; offering a range
of meteorological parameters or of type &lsquo;<span class="samp">&#8288;"precipitation"&#8288;</span>&rsquo; solely
recording rainfall. There are about 400 &lsquo;<span class="samp">&#8288;climate&#8288;</span>&rsquo; and 2000
&lsquo;<span class="samp">&#8288;precipitation&#8288;</span>&rsquo; stations.</p>
</td></tr>
<tr><td><code id="read.DWDdata_+3A_period">period</code></td>
<td>
<p>string specifying a time span. The last 1.5 years are
called &lsquo;<span class="samp">&#8288;"recent"&#8288;</span>&rsquo;. Data from the individual beginning of measurements
up to a year ago are labelled &lsquo;<span class="samp">&#8288;"historical"&#8288;</span>&rsquo;.
&lsquo;<span class="samp">&#8288;"recent"&#8288;</span>&rsquo; data have not yet gone through the full quality control
procedure. &lsquo;<span class="samp">&#8288;"historical"&#8288;</span>&rsquo; data have completed the operational quality
control. But be aware there still might be gaps and inhomogeneities.</p>
</td></tr>
<tr><td><code id="read.DWDdata_+3A_resolution">resolution</code></td>
<td>
<p>string. Temporal resolution of the data can be
&lsquo;<span class="samp">&#8288;"daily"&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;"monthly"&#8288;</span>&rsquo;. &lsquo;<span class="samp">&#8288;"daily"&#8288;</span>&rsquo; being the common
resolution.</p>
</td></tr>
<tr><td><code id="read.DWDdata_+3A_file">file</code></td>
<td>
<p>a string specifying the location of a dataset. &lsquo;<span class="samp">&#8288;"file"&#8288;</span>&rsquo;
may point to a file on a FTP server or on the local file system.
If the file lives on a FTP server the string must start with
<code>'ftp://'</code>. If it is NULL (the default), data will be downloaded
from DWD's FTP server.</p>
</td></tr>
<tr><td><code id="read.DWDdata_+3A_destdir">destdir</code></td>
<td>
<p>directory (string) where intermediate data (downloaded *.zip
file) are stored. If it is NULL (the default) a subdirectory
&lsquo;<span class="samp">&#8288;downloaded_packages&#8288;</span>&rsquo; of the session temporary directory will be used
(and the files will be deleted at the end of the session).
It might be advisable to keep the .zip file since it contains the
stations documentation and metadata (e.g. station shift, used devices,
downtimes etc.).</p>
</td></tr>
<tr><td><code id="read.DWDdata_+3A_quiet">quiet</code></td>
<td>
<p>If TRUE, suppress status messages (if any), and the progress bar.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An introduction to the data available at the Climate Data Center can be
found in the German
<a href="https://opendata.dwd.de/climate_environment/CDC/Liesmich_intro_CDC-FTP.pdf">Liesmich_intro_CDC_ftp</a>
or the translated
<a href="https://opendata.dwd.de/climate_environment/CDC/Readme_intro_CDC_ftp.pdf">Readme_intro_CDC_ftp</a>.
</p>
<p>The freely accessible part of the Climate Data Center of Germany's National
Meteorological Service (Deutscher Wetterdienst, DWD) is part of the DWD's
mandate for basic supply of information (termed &quot;Grundversorgung&quot;).
These services may be used without any restrictions (no fees will be charged
and in general there are no restrictions for the use the data), provided
that the source is indicated as laid down in the
<a href="http://www.gesetze-im-internet.de/geonutzv/BJNR054700013.html">&quot;GeoNutzV&quot;</a>
ordinance. The source reference shall roughly meet the following rules:
</p>

<ul>
<li><p> Where data are used without modification, the source reference shall
read &quot;Source: Deutscher Wetterdienst&quot; or just consist of the DWD logo.
</p>
</li>
<li><p> If the data are modified, the source reference shall specify as
precisely as possible the extent of such, e.g. &quot;Based on data from
Deutscher Wetterdienst, figures rounded&quot;.
</p>
</li></ul>

<p>A more detailed description of the rules can be found in the official and
legally binding German
<a href="https://opendata.dwd.de/climate_environment/CDC/Nutzungsbedingungen_German.pdf">Nutzungsbedingungen</a>
or the translated <a href="https://opendata.dwd.de/climate_environment/CDC/Terms_of_use.pdf">Terms
of use</a>.
</p>


<h3>Value</h3>

<p>A data.frame with the observed weather data. Beware of gaps and
inhomogeneities! &lsquo;<span class="samp">&#8288;colnames&#8288;</span>&rsquo; contains the original header and
hence German terms.
</p>
<p>Content of 'climate'-data.frame:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>Name</strong> </td><td style="text-align: left;"> <strong>Description</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
   STATIONS_ID </td><td style="text-align: left;"> station id</td>
</tr>
<tr>
 <td style="text-align: left;">
   MESS_DATUM  </td><td style="text-align: left;"> date</td>
</tr>
<tr>
 <td style="text-align: left;">
   QN_3        </td><td style="text-align: left;"> quality level of next columns (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
   FX          </td><td style="text-align: left;"> daily maximum of wind gust (m/s)</td>
</tr>
<tr>
 <td style="text-align: left;">
   FM          </td><td style="text-align: left;"> daily mean of wind velocity (m/s)</td>
</tr>
<tr>
 <td style="text-align: left;">
   QN_4        </td><td style="text-align: left;"> quality level of next columns (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
   RSK         </td><td style="text-align: left;"> daily precipitation height (mm)</td>
</tr>
<tr>
 <td style="text-align: left;">
   RSKF        </td><td style="text-align: left;"> precipitation form (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
   SDK         </td><td style="text-align: left;"> daily sunshine duration (h)</td>
</tr>
<tr>
 <td style="text-align: left;">
   SHK_TAG     </td><td style="text-align: left;"> daily snow depth (cm)</td>
</tr>
<tr>
 <td style="text-align: left;">
   NM          </td><td style="text-align: left;"> daily mean of cloud cover (1/8)</td>
</tr>
<tr>
 <td style="text-align: left;">
   VPM         </td><td style="text-align: left;"> daily mean of vapor pressure (hPa)</td>
</tr>
<tr>
 <td style="text-align: left;">
   PM          </td><td style="text-align: left;"> daily mean of pressure (hPa)</td>
</tr>
<tr>
 <td style="text-align: left;">
   TMK         </td><td style="text-align: left;"> daily mean of temperature (°C)</td>
</tr>
<tr>
 <td style="text-align: left;">
   UPM         </td><td style="text-align: left;"> daily mean of relative humidity (%)</td>
</tr>
<tr>
 <td style="text-align: left;">
   TXK         </td><td style="text-align: left;"> daily maximum of temperature at 2m height (°C)</td>
</tr>
<tr>
 <td style="text-align: left;">
   TNK         </td><td style="text-align: left;"> daily minimum of temperature at 2m height (°C)</td>
</tr>
<tr>
 <td style="text-align: left;">
   TGK         </td><td style="text-align: left;"> daily minimum of air temperature at 5cm above ground (°C)
  </td>
</tr>

</table>

<p>Content of 'precipitation'-data.frame:
</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>Name</strong> </td><td style="text-align: left;"> <strong>Description</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
   STATIONS_ID </td><td style="text-align: left;"> station id</td>
</tr>
<tr>
 <td style="text-align: left;">
   MESS_DATUM  </td><td style="text-align: left;"> date</td>
</tr>
<tr>
 <td style="text-align: left;">
   QN_6        </td><td style="text-align: left;"> quality level of next columns (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
   RS          </td><td style="text-align: left;"> daily precipitation height (mm)</td>
</tr>
<tr>
 <td style="text-align: left;">
   RSF         </td><td style="text-align: left;"> precipitation form (-)</td>
</tr>
<tr>
 <td style="text-align: left;">
   SH_TAG      </td><td style="text-align: left;"> daily height of snow pack (cm)</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>References</h3>

<p>Freely accessible DWD data available via the
<a href="https://www.dwd.de/EN/climate_environment/cdc/cdc_node_en.html">Climate Data Center</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# fetch last 500 days worth of data from station Göttingen
clim &lt;- read.DWDdata(id=1691)

# save data &amp; metadata (documentation about devices, downtimes etc.)
clim &lt;- read.DWDdata(id=1691, destdir='.')

# find and download historical data from the Brocken
stat.hist &lt;- read.DWDstations(period='historical')
brocken.id &lt;- stat.hist[grep("^Brock", stat.hist$name), ]$id
clim.brocken &lt;- read.DWDdata(id=brocken.id, period='historical')

## End(Not run)

</code></pre>

<hr>
<h2 id='read.DWDstations'>Fetch list of DWD weather stations</h2><span id='topic+read.DWDstations'></span>

<h3>Description</h3>

<p>Get a listing of advertised stations of Germany's National Meteorological
Service (Deutscher Wetterdienst, DWD). The list differs for station type,
time period and resolution. The list of advertised stations is usually not
identical with currently available stations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.DWDstations(type = "climate", period = "recent", resolution = "daily")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.DWDstations_+3A_type">type</code></td>
<td>
<p>string. Stations can be of type &lsquo;<span class="samp">&#8288;"climate"&#8288;</span>&rsquo; offering a range
of meteorological parameters or of type &lsquo;<span class="samp">&#8288;"precipitation"&#8288;</span>&rsquo; solely
recording rainfall.</p>
</td></tr>
<tr><td><code id="read.DWDstations_+3A_period">period</code></td>
<td>
<p>string specifying a time span. The last 1.5 years are
called &lsquo;<span class="samp">&#8288;"recent"&#8288;</span>&rsquo;. Data from the individual beginning of measurements
up to a year ago are labelled &lsquo;<span class="samp">&#8288;"historical"&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="read.DWDstations_+3A_resolution">resolution</code></td>
<td>
<p>string. Temporal resolution of the data can be
&lsquo;<span class="samp">&#8288;"daily"&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;"monthly"&#8288;</span>&rsquo;. &lsquo;<span class="samp">&#8288;"daily"&#8288;</span>&rsquo; being the common
resolution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The freely accessible part of the Climate Data Center of Germany's National
Meteorological Service (Deutscher Wetterdienst, DWD) is part of DWD's
mandate for basic supply of information (termed &quot;Grundversorgung&quot;).
This service may be used without any restrictions (no fees will be
charged and in general there are no restrictions for the use the data),
provided that the source is indicated as laid down in the
<a href="http://www.gesetze-im-internet.de/geonutzv/BJNR054700013.html">&quot;GeoNutzV&quot;</a>
ordinance. The source reference shall roughly meet the following rules:
</p>

<ul>
<li><p> Where data are used without modification, the source reference shall
read &quot;Source: Deutscher Wetterdienst&quot; or just consist of the DWD logo.
</p>
</li>
<li><p> If the data are modified, the source reference shall specify as
precisely as possible the extent of such, e.g. &quot;Based on data from
Deutscher Wetterdienst, figures rounded&quot;.
</p>
</li></ul>

<p>A more detailed description of the rules can be found in the official and
legally binding German
<a href="https://opendata.dwd.de/climate_environment/CDC/Nutzungsbedingungen_German.pdf">Nutzungsbedingungen</a>
or the translated <a href="https://opendata.dwd.de/climate_environment/CDC/Terms_of_use.pdf">Terms
of use</a>.
</p>


<h3>Value</h3>

<p>A data.frame with all weather stations. It's not guaranteed that all
advertised staions are available for download. Watch out for the end data
of observation. Stations with recent data have a current end date.
The data.frame contains the variables id, from, to, elev, lat, long, name,
state.
</p>


<h3>References</h3>

<p>Freely accessible DWD data available via the
<a href="https://www.dwd.de/EN/climate_environment/cdc/cdc_node_en.html">Climate Data Center</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# stations with daily climate data
stations &lt;- read.DWDstations()

# precipitation stations with monthly historical data
precip &lt;- read.DWDstations(type='precip', period='historical',
                           resolution='monthly')

# list stations with daily data updated within last week
stat.daily &lt;- read.DWDstations(period='recent')
stat.daily.recent &lt;- stat.daily[stat.daily$to &gt; (Sys.Date() - 7), ]

## End(Not run)

</code></pre>

<hr>
<h2 id='vegperiod'>Determine vegetation period</h2><span id='topic+vegperiod'></span>

<h3>Description</h3>

<p>Calculate start and end date of vegetation periods based on daily average
air temperature and the day of the year (DOY).
The sum of day degrees within the vegetation period is included for convenience.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vegperiod(
  dates,
  Tavg,
  start.method,
  end.method,
  Tsum.out = FALSE,
  Tsum.crit = 0,
  species = NULL,
  est.prev = 0,
  check.data = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vegperiod_+3A_dates">dates</code></td>
<td>
<p>vector of calendar dates (objects of class <code>Date</code> or something
understood by <code><a href="base.html#topic+as.Date">as.Date()</a></code>). Must contain entire years if <code>est.prev &gt; 0</code>
else the first year may comprise only November and December.</p>
</td></tr>
<tr><td><code id="vegperiod_+3A_tavg">Tavg</code></td>
<td>
<p>vector of daily average air temperatures in degree Celsius.
Same length as <code>dates</code>.</p>
</td></tr>
<tr><td><code id="vegperiod_+3A_start.method">start.method</code></td>
<td>
<p>name of method to use for vegetation start. One of
<code>"Menzel"</code> (needs additional argument <code>species</code>, see below), <code>"StdMeteo"</code>
resp. <code>"ETCCDI"</code>, <code>"Ribes uva-crispa"</code>. Can be abbreviated (partial
matching). For further discussion see Details.</p>
</td></tr>
<tr><td><code id="vegperiod_+3A_end.method">end.method</code></td>
<td>
<p>name of method to use for vegetation end. One of
<code>"vonWilpert"</code>, <code>"LWF-BROOK90"</code>, <code>"NuskeAlbert"</code> and <code>"StdMeteo"</code> resp.
<code>"ETCCDI"</code>. Can be abbreviated (partial matching). For further discussion
see Details.</p>
</td></tr>
<tr><td><code id="vegperiod_+3A_tsum.out">Tsum.out</code></td>
<td>
<p>boolean. Return the sum of daily mean temperatures above
<code>Tsum.crit</code> within vegetation period, also known as growing day degrees.</p>
</td></tr>
<tr><td><code id="vegperiod_+3A_tsum.crit">Tsum.crit</code></td>
<td>
<p>threshold for sum of day degrees. Only daily mean temperatures
<code style="white-space: pre;">&#8288;&gt; Tsum.crit&#8288;</code> will be tallied. The default of <code>0</code> prevents negative
daily temperatures from reducing the sum. Climate change studies often use
a threshold of <code>5</code>.</p>
</td></tr>
<tr><td><code id="vegperiod_+3A_species">species</code></td>
<td>
<p>name of tree species (required if <code>start.method="Menzel"</code>
ignored otherwise).
</p>
<p>Must be one of <code>"Larix decidua"</code>, <code>"Picea abies (frueh)"</code>,
<code>"Picea abies (spaet)"</code>, <code>"Picea abies (noerdl.)"</code>, <code>"Picea omorika"</code>,
<code>"Pinus sylvestris"</code>, <code>"Betula pubescens"</code>, <code>"Quercus robur"</code>,
<code>"Quercus petraea"</code>, <code>"Fagus sylvatica"</code>.</p>
</td></tr>
<tr><td><code id="vegperiod_+3A_est.prev">est.prev</code></td>
<td>
<p>number of years to <strong>est</strong>imate <strong>prev</strong>ious year's chill
days for the first year (required if <code>start.method="Menzel"</code> ignored
otherwise).
</p>
<p><code>Menzel</code> requires the number of chill days of previous November and
December. If <code>est.prev = 0</code> the first year is used to get the previous
year's chill days and dropped afterwards. Thus, a year from the time
series is lost. To avoid losing a year, <code>est.prev = n</code> estimates the
previous year's chill days for the first year from the average of <code>n</code>
first years of the time series.</p>
</td></tr>
<tr><td><code id="vegperiod_+3A_check.data">check.data</code></td>
<td>
<p>Performs plausibility checks on the temperature data to
ensure that the temperatures have not been multiplied by ten.
Plausible range is -35 to +40°C.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Common methods for determining the onset and end of thermal vegetation
periods are provided, for details see next sections. Popular choices with
regard to forest trees in Germany are <code>Menzel</code> and <code>vonWilpert</code>. Climate
change impact studies at NW-FVA are frequently conducted using <code>Menzel</code> with
&quot;Picea abies (frueh)&quot; and <code>NuskeAlbert</code> for all tree species; with tree
species specifics accounted for in subsequent statistical models.
</p>


<h4>Start methods:</h4>

<p>The method <strong><code><a href="#topic+method_Menzel">Menzel</a></code></strong> implements the algorithm described in
Menzel (1997). The method is parameterized for 10 common tree species. It
needs previous year's chill days. <strong><code><a href="#topic+method_ETCCDI">ETCCDI</a></code></strong> resp.
<code>StdMeteo</code> is a simple threshold based procedure as defined by the
Expert Team on Climate Change Detection and Indices (cf. ETCCDI 2009, Frich
et al. 2002, Zhang et al. 2011) leading to quite early vegetation starts.
This method is widely used in climate change studies. The method
<strong><code><a href="#topic+method_Ribes">Ribes uva-crispa</a></code></strong> is based on leaf-out of gooseberry (Janssen
2009). It was developed by the Germany's National Meteorological Service
(Deutscher Wetterdienst, DWD) and is more robust against early starts than
common simple meteorological procedures.
</p>



<h4>End methods:</h4>

<p>The end method <strong><code><a href="#topic+method_vonWilpert">vonWilpert</a></code></strong> is based on von Wilpert (1990). It
was originally developed for <em>Picea abies</em> in the Black Forest but is
commonly used for all tree species throughout Germany. As usual, the rules
regarding the soilmatrix are neglected in this implementation.
<strong><code><a href="#topic+method_LWF-BROOK90">LWF-BROOK90</a></code></strong> is -for the sake of convenience- a
reimplementation of the LWF-BROOK90 VBA (version 3.4) variant of &quot;vonWilpert&quot;
(Hammel and Kennel 2001). Their interpretation of von Wilpert (1990) and the
somewhat lower precision of VBA was mimicked. <strong><code><a href="#topic+method_NuskeAlbert">NuskeAlbert</a></code></strong>
provide a very simple method which is inspired by standard climatological
procedures but employs a 7 day moving average and a 5 °C threshold (cf.
Walther and Linderholm 2006). <strong><code><a href="#topic+method_ETCCDI">ETCCDI</a></code></strong> resp. <code>StdMeteo</code>
is a simple threshold based procedure as defined by the Expert Team on
Climate Change Detection and Indices (cf. ETCCDI 2009, Frich et al. 2002,
Zhang et al. 2011) leading to quite late vegetation ends.
</p>



<h3>Value</h3>

<p>A data.frame with year and DOY of start and end day of
vegetation period. If <code>Tsum.out=TRUE</code>, the data.frame contains an
additional column with the sum of day degrees within vegetation periods.
</p>


<h3>References</h3>

<p>ETCCDI (2009)
Climate Change Indices: Definitions of the 27 core indices.
<a href="http://etccdi.pacificclimate.org/list_27_indices.shtml">http://etccdi.pacificclimate.org/list_27_indices.shtml</a>
</p>
<p>Frich, P., Alexander, L., Della-Marta, P., Gleason, B., Haylock, M.,
Klein Tank, A. and Peterson, T. (2002)
Observed coherent changes in climatic extremes during the second half of
the twentieth century.
<em>Climate Research</em>, <b>19</b>, 193&ndash;212.
<a href="https://doi.org/10.3354/cr019193">doi:10.3354/cr019193</a>.
</p>
<p>Hammel, K. and Kennel, M. (2001)
Charakterisierung und Analyse der Wasserverfügbarkeit und des
Wasserhaushalts von Waldstandorten in Bayern mit dem Simulationsmodell
BROOK90.
<em>Forstliche Forschungsberichte München</em>.
</p>
<p>Janssen, W. (2009)
Definition des Vegetationsanfanges.
<em>Internal Report, Deutscher Wetterdienst, Abteilung Agrarmeteorologie</em>.
</p>
<p>Menzel, A. (1997)
Phänologie von Waldbäumen unter sich ändernden Klimabedingungen -
Auswertung der Beobachtungen in den Internationalen Phänologischen Gärten
und Möglichkeiten der Modellierung von Phänodaten.
<em>Forstliche Forschungsberichte München</em>.
</p>
<p>von Wilpert, K. (1990)
Die Jahrringstruktur von Fichten in Abhängigkeit vom Bodenwasserhaushalt
auf Pseudogley und Parabraunerde: Ein Methodenkonzept zur Erfassung
standortsspezifischer Wasserstreßdispostion.
<em>Freiburger Bodenkundliche Abhandlungen</em>.
</p>
<p>Walther, A. and Linderholm, H. W. (2006)
A comparison of growing season indices for the Greater Baltic Area.
<em>International Journal of Biometeorology</em>, <b>51</b>(2), 107&ndash;118.
<a href="https://doi.org/10.1007/s00484-006-0048-5">doi:10.1007/s00484-006-0048-5</a>.
</p>
<p>Zhang, X., Alexander, L., Hegerl, G. C., Jones, P., Tank, A. K.,
Peterson, T. C., Trewin, B. and Zwiers, F. W. (2011)
Indices for monitoring changes in extremes based on daily temperature and
precipitation data.
<em>Wiley Interdisciplinary Reviews: Climate Change</em>, <b>2</b>(6), 851&ndash;870.
<a href="https://doi.org/10.1002/wcc.147">doi:10.1002/wcc.147</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goe)
vegperiod(dates=goe$date, Tavg=goe$t,
          start.method="Menzel", end.method="vonWilpert",
          species="Picea abies (frueh)", est.prev=5)

# take chill days from first year, which is then dropped
vegperiod(dates=goe$date, Tavg=goe$t, start="Menzel", end="vonWilpert",
          species="Picea abies (frueh)", est.prev=0)

# add column with sum of day degrees in vegetation periods
vegperiod(dates=goe$date, Tavg=goe$t, Tsum.out=TRUE,
          start="StdMeteo", end="StdMeteo")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
