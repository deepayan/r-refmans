<!DOCTYPE html><html><head><title>Help for package CEOdata</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CEOdata}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CEOdata'><p>Import datasets / microdata from the &quot;Centre d'Estudis d'Opinio&quot;</p></a></li>
<li><a href='#CEOmeta'><p>Import metadata from the &quot;Centre d'Estudis d'Opinio&quot;</p></a></li>
<li><a href='#CEOsearch'><p>Search for keywords in the labels of variables and responses of the survey data</p></a></li>
<li><a href='#read.ceo.json'><p>Internal function to be able to properly read the JSON from CEO</p></a></li>
<li><a href='#the'><p>Internal function to get the metadata of CEO surveys into cache</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Datasets of the CEO (Centre d'Estudis d'Opinio) for Opinion
Polls in Catalonia</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Easy and convenient access to the datasets of the
  "Centre d'Estudis d'Opinio", the Catalan institution for polling and public
  opinion. The package uses the data stored in the servers of the CEO and returns
  it in a tidy format.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0), haven, dplyr (&ge; 1.0.0), urltools, stringr,
jsonlite</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, R.rsp, ggplot2, tidyr (&gt; 1.1.1), curl, rmarkdown,
vtable, compareGroups</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ceo.gencat.cat/ca/inici/">https://ceo.gencat.cat/ca/inici/</a>,
<a href="https://github.com/ceopinio/CEOdata/">https://github.com/ceopinio/CEOdata/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ceopinio/CEOdata/issues/">https://github.com/ceopinio/CEOdata/issues/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-06 08:18:26 UTC; xavier</td>
</tr>
<tr>
<td>Author:</td>
<td>Xavier Fernández-i-Marín
    <a href="https://orcid.org/0000-0002-9522-8870"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xavier Fernández-i-Marín &lt;xavier.fim@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-06 14:00:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='CEOdata'>Import datasets / microdata from the &quot;Centre d'Estudis d'Opinio&quot;</h2><span id='topic+CEOdata'></span>

<h3>Description</h3>

<p>Easy and convenient access to the datasets / microdata of the &quot;Centre
d'Estudis d'Opinio&quot;, the Catalan institution for polling and public opinion.
The package uses the data stored in the servers of the CEO and returns it in
a tidy format (tibble).
</p>
<p>Easy and convenient access to the datasets / microdata of the &quot;Centre
d'Estudis d'Opinio&quot;, the catalan institution for polling and public opinion.
The package uses the data stored in the servers of the CEO and returns it in
a tidy format (tibble).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CEOdata(
  kind = "barometer",
  reo = NA,
  raw = FALSE,
  extra_variables = TRUE,
  date_start = NA,
  date_end = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CEOdata_+3A_kind">kind</code></td>
<td>
<p>Character vector with the sort of microdata required. Defaults to &quot;barometer&quot;, that contains the whole set of Barometers from 2014 (presential interviews). &quot;barometer_until_2013&quot; contains the interviews performed by phone until 2013, with a somewhat different questionnaire and structure. For such dataset you need a third-party software installed in your computer to be able to uncompress the RAR original file. It is the option by default. But if a specific reo study is requested in the <code>reo</code> argument, then the <code>kind</code> argument does not apply anymore and only a specific study is retrieved.</p>
</td></tr>
<tr><td><code id="CEOdata_+3A_reo">reo</code></td>
<td>
<p>Character vector of length one that allows to get the dataset of a specific REO study (Registre d'Estudis d'Opinio, the internal register ID used by the CEO) to download. By default (when <code>reo = NA</code>) it uses the <code>kind</code> argument. Not all the studies carried on by the CEO (and therefore listed in the <code>CEOmeta()</code> function call) have microdata available. Only the ones that return TRUE to the column <code>microdata_available</code> in <code>CEOmeta()</code>.</p>
</td></tr>
<tr><td><code id="CEOdata_+3A_raw">raw</code></td>
<td>
<p>Logical value to indicate if SPSS labels are transformed into factors. Defaults to FALSE. Otherwise, when TRUE, it returns the matrices as imported by haven::read_spss() without modification. Does not apply to data from singular REOs, only to barometers retrieved using <code>kind</code>.</p>
</td></tr>
<tr><td><code id="CEOdata_+3A_extra_variables">extra_variables</code></td>
<td>
<p>Logical value as to whether include (default) complementary variables such as date (Data). Defaults to TRUE. Names of such new variables only use upper case in the first letter. Extra variables are added at the end. Does not apply to data from singular REOs, only to barometers retrieved using <code>kind</code>.</p>
</td></tr>
<tr><td><code id="CEOdata_+3A_date_start">date_start</code></td>
<td>
<p>Character vector with a starting date (&quot;YYYY-MM-DD&quot;) for the data. It only applies to the barometers retrieved using <code>kind</code>, not to other studies.</p>
</td></tr>
<tr><td><code id="CEOdata_+3A_date_end">date_end</code></td>
<td>
<p>Character vector with an end date (&quot;YYYY-MM-DD&quot;) for the data. It only applies to the barometers retrieved using <code>kind</code>, not to other studies.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It works either by specifying the kind of merged barometer (using the
<code>kind</code> argument), or either providing a singular study (using the
<code>reo</code> argument).
</p>


<h3>Value</h3>

<p>A tibble with the individuals' responses to the questionnaire retrieved.
</p>


<h3>References</h3>

<p><a href="http://xavier-fim.net/packages/CEOdata/">http://xavier-fim.net/packages/CEOdata/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Get the merged barometer from 2014, by default (assume kind = "barometer").
d &lt;- CEOdata()

# Get the number of individuals surveyed and the number of variables recorded.
dim(d)

# Get the identifiers of the different Barometers retrieved
unique(d$BOP_NUM)

# Get a specific study
d746 &lt;- CEOdata(reo = "746")

## End(Not run)
</code></pre>

<hr>
<h2 id='CEOmeta'>Import metadata from the &quot;Centre d'Estudis d'Opinio&quot;</h2><span id='topic+CEOmeta'></span>

<h3>Description</h3>

<p>Easy and convenient access to the metadata of the &quot;Centre
d'Estudis d'Opinio&quot;, the Catalan institution for polling and public opinion.
It allows to search for specific terms to obtain the details of the datasets available
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CEOmeta(
  reo = NULL,
  search = NULL,
  date_start = NA,
  date_end = NA,
  browse = FALSE,
  browse_translate = NULL,
  browse_force = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CEOmeta_+3A_reo">reo</code></td>
<td>
<p>Character vector of length one that allows to get the metadata only of a specific REO (Registre d'Estudis d'Opinio, the internal register ID used by the CEO) to download. When not NULL it has precedence with the search, date_start and date_end arguments.</p>
</td></tr>
<tr><td><code id="CEOmeta_+3A_search">search</code></td>
<td>
<p>Character vector with keywords to look for within several columns of the CEO metadata (title, summary, objectives and tags -descriptors-). Each element of the vector is strictly evaluated (all words are considered to be found in the format they appear, like in &quot;AND&quot;), while by using several elements in the vector the search works like an &quot;OR&quot; clause. Lower or upper cases are not considered.</p>
</td></tr>
<tr><td><code id="CEOmeta_+3A_date_start">date_start</code></td>
<td>
<p>Character vector with a starting date (&quot;YYYY-MM-DD&quot;) for the data.</p>
</td></tr>
<tr><td><code id="CEOmeta_+3A_date_end">date_end</code></td>
<td>
<p>Character vector with an end date (&quot;YYYY-MM-DD&quot;) for the data.</p>
</td></tr>
<tr><td><code id="CEOmeta_+3A_browse">browse</code></td>
<td>
<p>Logical value. When turned to TRUE, the browser opens the URLs of the required surveys. Only a maximum of 10 entries are opened.</p>
</td></tr>
<tr><td><code id="CEOmeta_+3A_browse_translate">browse_translate</code></td>
<td>
<p>When opening the relevant entries in the browser (browse must be TRUE), use automatic translation to the language specified using Google Translate ('oc' for Occitan/Aranese, 'de' to German, 'en' to English, 'eu' to Basque, 'gl' for Galician or 'sp' to Spanish).</p>
</td></tr>
<tr><td><code id="CEOmeta_+3A_browse_force">browse_force</code></td>
<td>
<p>Logical value. When TRUE it overcomes the limitation of only opening a maximum of 10 URLs. Use it with caution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the metadata of the surveys produced by the CEO.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Retrieve the metadata of the surveys ever produced by the CEO:
meta &lt;- CEOmeta()
dim(meta)

# Search for specific terms in any of the metadata fields
# in this case, "internet".
CEOmeta(search = "internet")

# now for the combination of "Medi" AND "Ambient"
CEOmeta(search = "Medi ambient")

# now for the combination of ("Medi" AND "Ambient") OR "Municipi"
CEOmeta(search = c("Medi ambient", "Municipi"))

# Search for all registers starting in 2020
CEOmeta(date_start = "2020-01-01")

# Get the entry for a specific study (REO) and open its description in a browser
CEOmeta(reo = "746", browse = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='CEOsearch'>Search for keywords in the labels of variables and responses of the survey data</h2><span id='topic+CEOsearch'></span>

<h3>Description</h3>

<p>Easy and convenient access to the metadata of the &quot;Centre
d'Estudis d'Opinio&quot;, the Catalan institution for polling and public opinion.
It allows to search for specific terms to obtain the details of the datasets available
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CEOsearch(d, keyword = NULL, where = "variables", translate = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CEOsearch_+3A_d">d</code></td>
<td>
<p>Microdata retrieved from the CEO using the CEOdata() function. It is a data frame with variable labels.</p>
</td></tr>
<tr><td><code id="CEOsearch_+3A_keyword">keyword</code></td>
<td>
<p>The character string defining the word / concept to look for within the microdata.</p>
</td></tr>
<tr><td><code id="CEOsearch_+3A_where">where</code></td>
<td>
<p>A character vector specifying if the function should look amongst variable labels (&quot;variables&quot;, default), or amongst value labels (&quot;values&quot;).</p>
</td></tr>
<tr><td><code id="CEOsearch_+3A_translate">translate</code></td>
<td>
<p>Logical. When TRUE, it opens a browser with an automatic translation to English of the variable names and labels using Google Translate. Given the specificity of the terms, only the English translation is provided. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the set of variables that match the keyword (&quot;Variable&quot;). If the variables are requested, the second variable is their labels (&quot;Label&quot;), and if the values are required the second on is the value labels (&quot;Value&quot;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Retrieve a dataset to use the function
d &lt;- CEOdata()

# Get the whole set of variable labels
CEOsearch(d)

# Get the whole set of value labels
CEOsearch(d, where = "values")

# Search for specific variable names and variable labels with the string "edat" (age).
CEOsearch(d, keyword = "edat")

# Search for specific variable names and variable labels with the string "edat" (age),
# and translate the results to English.
CEOsearch(d, keyword = "edat", translate = TRUE)

# now for the combination of "valoracio" OR "covid" OR "govern".
CEOsearch(d, keyword = c("valoració", "covid",  "govern"))

## End(Not run)
</code></pre>

<hr>
<h2 id='read.ceo.json'>Internal function to be able to properly read the JSON from CEO</h2><span id='topic+read.ceo.json'></span>

<h3>Description</h3>

<p>Used to address the limitations of the JSON format provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.ceo.json(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.ceo.json_+3A_x">x</code></td>
<td>
<p>JSON data structure</p>
</td></tr>
</table>

<hr>
<h2 id='the'>Internal function to get the metadata of CEO surveys into cache</h2><span id='topic+the'></span>

<h3>Description</h3>

<p>Used when loading the package, it gets the last update of the available
meta data of CEO surveys, cleans it and makes it ready for the rest
of the functions in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>the
</code></pre>


<h3>Format</h3>

<p>An object of class <code>environment</code> of length 0.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
