<!DOCTYPE html><html lang="en"><head><title>Help for package MLZ</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MLZ}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bin_length'><p>Bin length data</p></a></li>
<li><a href='#calc_ML'><p>Calculate mean lengths &gt;= Lc</p></a></li>
<li><a href='#compare_models'><p>Model selection</p></a></li>
<li><a href='#Goosefish'><p>Goosefish: Northern Management Region (for ML)</p></a></li>
<li><a href='#ML'><p>Mean length-based mortality estimator</p></a></li>
<li><a href='#MLCR'><p>Mean length with catch rate mortality estimator</p></a></li>
<li><a href='#MLeffort'><p>Mean length with effort mortality estimator</p></a></li>
<li><a href='#MLmulti'><p>Multispecies mean length mortality estimator</p></a></li>
<li><a href='#MLZ_data-class'><p>MLZ_data</p></a></li>
<li><a href='#MLZ_model-class'><p>MLZ_model</p></a></li>
<li><a href='#modal_length'><p>Modal length from length data</p></a></li>
<li><a href='#MuttonSnapper'><p>Puerto Rico Mutton Snapper (for ML, MLCR)</p></a></li>
<li><a href='#Nephrops'><p>Male Nephrops FU 28-29 (for MLeffort)</p></a></li>
<li><a href='#plot+2CMLZ_data-method'><p><code>plot</code> method for S4 class <code>MLZ_data</code></p></a></li>
<li><a href='#plot+2CMLZ_model-method'><p><code>plot</code> method for S4 class <code>MLZ_model</code></p></a></li>
<li><a href='#profile_ML'><p>Grid search for the mean length estimator</p></a></li>
<li><a href='#profile_MLCR'><p>Grid search for the mean length with catch rate estimator</p></a></li>
<li><a href='#profile_MLmulti'><p>Grid search for the multispecies mean length estimator</p></a></li>
<li><a href='#PRSnapper'><p>Puerto Rico Snapper (for MLmulti)</p></a></li>
<li><a href='#sensitivity_Lc'><p>Sensitivity to Lc</p></a></li>
<li><a href='#SilkSnapper'><p>Silk Snapper</p></a></li>
<li><a href='#summary+2CMLZ_data-method'><p><code>summary</code> method for S4 class <code>MLZ_data</code></p></a></li>
<li><a href='#summary+2CMLZ_model-method'><p><code>summary</code> method for S4 class <code>MLZ_model</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Mean Length-Based Estimators of Mortality using TMB</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-25</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Quang Huynh &lt;quang@bluematterscience.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation functions and diagnostic tools for mean length-based total mortality estimators based on Gedamke and Hoenig (2006) &lt;<a href="https://doi.org/10.1577%2FT05-153.1">doi:10.1577/T05-153.1</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, graphics, grDevices, dplyr (&ge; 0.5.0), gplots,
ggplot2 (&ge; 2.0.0), reshape2 (&ge; 1.4.1), parallel, TMB</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>TMB, RcppEigen</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-25 21:56:57 UTC; quang</td>
</tr>
<tr>
<td>Author:</td>
<td>Quang Huynh [aut, cre],
  Todd Gedamke [ctb],
  Amy Then [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-25 22:30:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='bin_length'>Bin length data</h2><span id='topic+bin_length'></span>

<h3>Description</h3>

<p>A tool to bin raw length observations into a length frequency matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin_length(df, breaks = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bin_length_+3A_df">df</code></td>
<td>
<p>A data frame or matrix of length observations. The first column should be named 
'Year' and the second column should be named 'Length'.</p>
</td></tr>
<tr><td><code id="bin_length_+3A_breaks">breaks</code></td>
<td>
<p>An optional vector for breaks for <code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Length frequencies from <code>Len_df</code> are created by using <code><a href="graphics.html#topic+hist">hist</a></code> function.
</p>


<h3>Value</h3>

<p>A list with length bins, years, and frequency matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(SilkSnapper)
Silk.matrix &lt;- bin_length(SilkSnapper, breaks = seq(80, 830, 10))
Silk.matrix &lt;- bin_length(SilkSnapper)
new.dataset &lt;- new("MLZ_data", Year = Silk.matrix$Year, Len_bins = Silk.matrix$Len_bins,
Len_matrix = Silk.matrix$Len_matrix)

## End(Not run) 
</code></pre>

<hr>
<h2 id='calc_ML'>Calculate mean lengths &gt;= Lc</h2><span id='topic+calc_ML'></span>

<h3>Description</h3>

<p>Calculates mean lengths from length data and Lc for class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_ML(MLZ_data, length.slot = c("Len_df", "Len_matrix"),
  sample.size = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_ML_+3A_mlz_data">MLZ_data</code></td>
<td>
<p>An object of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code>.</p>
</td></tr>
<tr><td><code id="calc_ML_+3A_length.slot">length.slot</code></td>
<td>
<p>Name of slot in <code><a href="#topic+MLZ_data-class">MLZ_data</a></code> from which to calculate
mean lengths, either: <code>Len_df</code> or <code>Len_matrix</code>. Only used if there are data in both slots.</p>
</td></tr>
<tr><td><code id="calc_ML_+3A_sample.size">sample.size</code></td>
<td>
<p>If <code>TRUE</code>, then the annual sample sizes will be calculated by
summing the cells in slot <code>Len_matrix</code>. Otherwise, sample sizes are set to 0 or 1
(whether mean lengths are calculated).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code> to fill slots <code>MeanLength</code>, <code>ss</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Nephrops)
Nephrops &lt;- calc_ML(Nephrops, sample.size = FALSE)
Nephrops@MeanLength
plot(Nephrops)

## End(Not run)
</code></pre>

<hr>
<h2 id='compare_models'>Model selection</h2><span id='topic+compare_models'></span>

<h3>Description</h3>

<p>Produces a matrix of AIC for model selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_models(..., figure = TRUE, color = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_models_+3A_...">...</code></td>
<td>
<p>Multiple objects of class <code>MLZ_model</code>, all from the same mortality
estimator and same data set.</p>
</td></tr>
<tr><td><code id="compare_models_+3A_figure">figure</code></td>
<td>
<p>If <code>TRUE</code>, produces a figure of model fits to the observed data.</p>
</td></tr>
<tr><td><code id="compare_models_+3A_color">color</code></td>
<td>
<p>Optional vector of colors for the figure each representing a separate model
in <code>MLZ_model.list</code>. If <code>NULL</code>, colors from <code><a href="gplots.html#topic+rich.colors">rich.colors</a></code>
will be used.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Goosefish)
goose &lt;- ML(Goosefish, ncp = 0)
goose1 &lt;- ML(Goosefish, ncp = 1)
goose2 &lt;- ML(Goosefish, ncp = 2, grid.search = TRUE, figure = FALSE)

compare_models(goose, goose1, goose2)

data(PRSnapper)
ssm &lt;- MLmulti(PRSnapper, ncp = 1, model = "SSM")
msm1 &lt;- MLmulti(PRSnapper, ncp = 1, model = "MSM1")
msm2 &lt;- MLmulti(PRSnapper, ncp = 1, model = "MSM2")
msm3 &lt;- MLmulti(PRSnapper, ncp = 1, model = "MSM3")

compare_models(ssm, msm1, msm2, msm3)

## End(Not run)
</code></pre>

<hr>
<h2 id='Goosefish'>Goosefish: Northern Management Region (for ML)</h2><span id='topic+Goosefish'></span>

<h3>Description</h3>

<p>Mean lengths and life history for goosefish.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Goosefish
</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code>.</p>


<h3>References</h3>

<p>Gedamke, T. and Hoenig, J.M. 2006. Estimating mortality from mean length data in
nonequilibrium situations, with application to the assessment of goosefish.
Transactions of the American Fisheries Society 135:476-487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Goosefish); Goosefish

</code></pre>

<hr>
<h2 id='ML'>Mean length-based mortality estimator</h2><span id='topic+ML'></span>

<h3>Description</h3>

<p>Estimator of instantaneous total mortality (Z) from a time series of mean length data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ML(MLZ_data, ncp, start = NULL, grid.search = TRUE,
  parallel = ifelse(ncp &gt; 2, TRUE, FALSE), min.time = 3, Z.max = 5,
  figure = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ML_+3A_mlz_data">MLZ_data</code></td>
<td>
<p>An object of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code> containing mean lengths and
life history data of stock.</p>
</td></tr>
<tr><td><code id="ML_+3A_ncp">ncp</code></td>
<td>
<p>The number of change points in total mortality in the time series. <code>ncp + 1</code> total
mortality rates will be estimated.</p>
</td></tr>
<tr><td><code id="ML_+3A_start">start</code></td>
<td>
<p>An optional list of starting values. See details.</p>
</td></tr>
<tr><td><code id="ML_+3A_grid.search">grid.search</code></td>
<td>
<p>If <code>TRUE</code>, a grid search will be performed using the <code><a href="#topic+profile_ML">profile_ML</a></code>
function to find the best starting values for the change points (the years when mortality changes).
Ignored if <code>ncp = 0</code> or if <code>start</code> is provided.</p>
</td></tr>
<tr><td><code id="ML_+3A_parallel">parallel</code></td>
<td>
<p>Whether grid search is performed with parallel processing. Ignored if <code>grid.search = FALSE</code>.</p>
</td></tr>
<tr><td><code id="ML_+3A_min.time">min.time</code></td>
<td>
<p>The minimum number of years between each change point for the grid search, passed
to <code><a href="#topic+profile_ML">profile_ML</a></code>. Not used if <code>grid.search = FALSE</code>.</p>
</td></tr>
<tr><td><code id="ML_+3A_z.max">Z.max</code></td>
<td>
<p>The upper boundary for Z estimates.</p>
</td></tr>
<tr><td><code id="ML_+3A_figure">figure</code></td>
<td>
<p>If <code>TRUE</code>, a call to <code>plot</code> of observed and predicted mean lengths will be produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a model with <code>I</code> change points, the starting values in
<code>start</code> is a list with the following entries:
Z a vector of <code>length = I+1</code>.
yearZ a vector of <code>length = I</code>.
</p>
<p><code>start</code> can be <code>NULL</code>, in which case, the supplied starting values depend on
the value of <code>grid.search</code>. If <code>grid.search = TRUE</code>, starting values will use the
values for <code>yearZ</code> which minimize the negative log-likelihood from the grid search.
Otherwise, the starting values for <code>yearZ</code> evenly divide the time series.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+MLZ_model-class">MLZ_model</a></code>.
</p>


<h3>References</h3>

<p>Gedamke, T. and Hoenig, J.M. 2006. Estimating mortality from mean length data in
nonequilibrium situations, with application to the assessment of goosefish.
Transactions of the American Fisheries Society 135:476-487.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+profile_ML">profile_ML</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Goosefish)
res &lt;- ML(Goosefish, ncp = 2)
res &lt;- ML(Goosefish, ncp = 2, start = list(Z = c(0.1, 0.3, 0.5), yearZ = c(1978, 1988)))
res &lt;- ML(Goosefish, ncp = 2, grid.search = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='MLCR'>Mean length with catch rate mortality estimator</h2><span id='topic+MLCR'></span>

<h3>Description</h3>

<p>Estimator of instantaneous total mortality (Z) from a time series of mean length data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLCR(MLZ_data, ncp, CPUE.type = c(NA, "WPUE", "NPUE"),
  loglikeCPUE = c("lognormal", "normal"), start = NULL,
  grid.search = TRUE, parallel = ifelse(ncp &gt; 2, TRUE, FALSE),
  min.time = 3, Z.max = 5, figure = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLCR_+3A_mlz_data">MLZ_data</code></td>
<td>
<p>An object of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code> containing mean lengths and
life history data of stock.</p>
</td></tr>
<tr><td><code id="MLCR_+3A_ncp">ncp</code></td>
<td>
<p>The number of change points in total mortality in the time series. <code>ncp + 1</code> total
mortality rates will be estimated.</p>
</td></tr>
<tr><td><code id="MLCR_+3A_cpue.type">CPUE.type</code></td>
<td>
<p>Indicates whether CPUE time series is abundance or biomass based.</p>
</td></tr>
<tr><td><code id="MLCR_+3A_loglikecpue">loglikeCPUE</code></td>
<td>
<p>Indicates whether the log-likelihood for the CPUE will be lognormally or
normally distributed.</p>
</td></tr>
<tr><td><code id="MLCR_+3A_start">start</code></td>
<td>
<p>An optional list of starting values. See details.</p>
</td></tr>
<tr><td><code id="MLCR_+3A_grid.search">grid.search</code></td>
<td>
<p>If <code>TRUE</code>, a grid search will be performed using the <code><a href="#topic+profile_MLCR">profile_MLCR</a></code>
function to find the best starting values for the change points (the years when mortality changes).
Ignored if <code>ncp = 0</code> or if <code>start</code> is provided.</p>
</td></tr>
<tr><td><code id="MLCR_+3A_parallel">parallel</code></td>
<td>
<p>Whether grid search is performed with parallel processing. Ignored if <code>grid.search = FALSE</code>.</p>
</td></tr>
<tr><td><code id="MLCR_+3A_min.time">min.time</code></td>
<td>
<p>The minimum number of years between each change point for the grid search, passed
to <code><a href="#topic+profile_MLCR">profile_MLCR</a></code>. Not used if <code>grid.search = FALSE</code>.</p>
</td></tr>
<tr><td><code id="MLCR_+3A_z.max">Z.max</code></td>
<td>
<p>The upper boundary for Z estimates.</p>
</td></tr>
<tr><td><code id="MLCR_+3A_figure">figure</code></td>
<td>
<p>If <code>TRUE</code>, a call to <code>plot</code> of observed and predicted mean lengths will be produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a model with <code>I</code> change points, the starting values in
<code>start</code> is a list with the following entries:
Z a vector of <code>length = I+1</code>.
yearZ a vector of <code>length = I</code>.
</p>
<p><code>start</code> can be <code>NULL</code>, in which case, the supplied starting values depend on
the value of <code>grid.search</code>. If <code>grid.search = TRUE</code>, starting values will use the
values for <code>yearZ</code> which minimize the negative log-likelihood from the grid search.
Otherwise, the starting values for <code>yearZ</code> evenly divide the time series.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+MLZ_model-class">MLZ_model</a></code>.
</p>


<h3>References</h3>

<p>Huynh, Q.C., Gedamke, T., Porch, C.E., Hoenig, J.M., Walter, J.F, Bryan, M., and
Brodziak, J. In revision. Estimating Total Mortality Rates from Mean Lengths and
Catch Rates in Non-equilibrium Situations. Transactions of the American Fisheries Society.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+profile_MLCR">profile_MLCR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(MuttonSnapper)
MLCR(MuttonSnapper, ncp = 2, CPUE.type = "WPUE", grid.search = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='MLeffort'>Mean length with effort mortality estimator</h2><span id='topic+MLeffort'></span>

<h3>Description</h3>

<p>Estimator of fishing and natural mortality from a time series of mean length and effort data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLeffort(MLZ_data, start, n_age, estimate.M = TRUE, log.par = FALSE,
  eff_init = 0, n_season = 1L, obs_season = 1L, timing = 0,
  figure = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLeffort_+3A_mlz_data">MLZ_data</code></td>
<td>
<p>An object of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code> containing mean lengths and
life history data of stock.</p>
</td></tr>
<tr><td><code id="MLeffort_+3A_start">start</code></td>
<td>
<p>A list of starting values. Names of start list must contain <code>q</code> and <code>M</code>.</p>
</td></tr>
<tr><td><code id="MLeffort_+3A_n_age">n_age</code></td>
<td>
<p>The number of ages above age tc in the model.</p>
</td></tr>
<tr><td><code id="MLeffort_+3A_estimate.m">estimate.M</code></td>
<td>
<p>If <code>TRUE</code>, natural mortality (M) will be estimated. Otherwise, the value of M
is obtained from slot <code>MLZ_data@M</code>.</p>
</td></tr>
<tr><td><code id="MLeffort_+3A_log.par">log.par</code></td>
<td>
<p>Whether parameters are estimated in logspace (<code>TRUE</code>) or untransformed space (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="MLeffort_+3A_eff_init">eff_init</code></td>
<td>
<p>The assumed equilibrium effort prior to the first year of the model (0 = virgin conditions).</p>
</td></tr>
<tr><td><code id="MLeffort_+3A_n_season">n_season</code></td>
<td>
<p>The number of seasons modeled in a year.</p>
</td></tr>
<tr><td><code id="MLeffort_+3A_obs_season">obs_season</code></td>
<td>
<p>The season corresponding to the observed mean lengths.</p>
</td></tr>
<tr><td><code id="MLeffort_+3A_timing">timing</code></td>
<td>
<p>The fraction of time (i.e., between 0 - 1) within <code>obs_season</code> that mean lengths are observed.</p>
</td></tr>
<tr><td><code id="MLeffort_+3A_figure">figure</code></td>
<td>
<p>If <code>TRUE</code>, a call to <code>plot</code> of observed and predicted mean lengths will be produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+MLZ_model-class">MLZ_model</a></code>.
</p>


<h3>References</h3>

<p>Then, A.Y, Hoenig, J.M, and Huynh, Q.C. In revision. Estimating fishing and natural
mortality rates, and catchability coefficient, from a series of observations on mean length and
fishing effort. ICES Journal of Marine Science.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Nephrops)
Nephrops &lt;- calc_ML(Nephrops, sample.size = FALSE)
res &lt;- MLeffort(Nephrops, start = list(q = 0.1, M = 0.2),
                n_age = 24, eff_init = Nephrops@Effort[1])

## End(Not run)                
</code></pre>

<hr>
<h2 id='MLmulti'>Multispecies mean length mortality estimator</h2><span id='topic+MLmulti'></span>

<h3>Description</h3>

<p>Estimator of instantaneous total mortality (Z) from a time series of mean length data for a suite of
stocks that are fished together.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLmulti(MLZ.list, ncp, model = c("SSM", "MSM1", "MSM2", "MSM3"),
  start = NULL, grid.search = TRUE, parallel = ifelse(ncp &gt; 2, TRUE,
  FALSE), min.time = 3, Z.max = 5, figure = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLmulti_+3A_mlz.list">MLZ.list</code></td>
<td>
<p>A list containing objects of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code>.</p>
</td></tr>
<tr><td><code id="MLmulti_+3A_ncp">ncp</code></td>
<td>
<p>The number of change points in total mortality in the time series. <code>ncp + 1</code> total
mortality rates will be estimated.</p>
</td></tr>
<tr><td><code id="MLmulti_+3A_model">model</code></td>
<td>
<p>The multispecies model to be used.</p>
</td></tr>
<tr><td><code id="MLmulti_+3A_start">start</code></td>
<td>
<p>An optional list of starting values. See details.</p>
</td></tr>
<tr><td><code id="MLmulti_+3A_grid.search">grid.search</code></td>
<td>
<p>If <code>TRUE</code>, a grid search will be performed using the <code><a href="#topic+profile_MLmulti">profile_MLmulti</a></code>
function to find the best starting values for the change points (the years when mortality changes).
Ignored if <code>start</code> is provided.</p>
</td></tr>
<tr><td><code id="MLmulti_+3A_parallel">parallel</code></td>
<td>
<p>Whether grid search is performed in parallel. Ignored if <code>grid.search = FALSE</code>.</p>
</td></tr>
<tr><td><code id="MLmulti_+3A_min.time">min.time</code></td>
<td>
<p>The minimum number of years between each change point for the grid search, passed
to <code><a href="#topic+profile_MLmulti">profile_MLmulti</a></code>. Not used if <code>grid.search = FALSE</code>.</p>
</td></tr>
<tr><td><code id="MLmulti_+3A_z.max">Z.max</code></td>
<td>
<p>The upper boundary for Z estimates.</p>
</td></tr>
<tr><td><code id="MLmulti_+3A_figure">figure</code></td>
<td>
<p>If <code>TRUE</code>, a call to <code>plot</code> of observed and predicted mean lengths will be produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a model with <code>I</code> change points and <code>N</code> species, the starting values in
<code>start</code> is a list with the following entries:
</p>
<p>Single Species Model (SSM, independent trends in mortality among species):
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Z</code> </td><td style="text-align: left;"> a matrix with <code>nrow = I+1</code> and <code>ncol = N</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>yearZ</code> </td><td style="text-align: left;"> a matrix with <code>nrow = I</code> and <code>ncol = N</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Multispecies Model 1 (MSM1, common mortality change points but changes in Z are independent):
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Z</code> </td><td style="text-align: left;"> a matrix with <code>nrow = I+1</code> and <code>ncol = N</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>yearZ</code> </td><td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Multispecies Model 2 (MSM2, common mortality change points. Changes in F vary by estimated relative catchabilities among species):
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Z1</code> </td><td style="text-align: left;"> a vector with <code>length = N</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>yearZ</code> </td><td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta</code> </td><td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>epsilon</code> </td><td style="text-align: left;"> a vector with <code>length = N-1</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Multispecies Model 3 (MSM3, common mortality change points and common proportional changes in F):
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Z1</code> </td><td style="text-align: left;"> a vector with <code>length = N</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>yearZ</code> </td><td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta</code> </td><td style="text-align: left;"> a vector with <code>length = I</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>If <code>ncp = 0</code> change points is specified, then the method simplifies to the Single Species Model.
The <code>start</code> list should contain a single entry:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Z</code> </td><td style="text-align: left;"> a vector with <code>length = N</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><code>start</code> can be <code>NULL</code>, in which case, the supplied starting values depend on
the value of <code>grid.search</code>. If <code>grid.search = TRUE</code>, starting values will use the
values for <code>yearZ</code> which minimize the negative log-likelihood from the grid search.
Otherwise, the starting values for <code>yearZ</code> evenly divide the time series.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+MLZ_model-class">MLZ_model</a></code>.
</p>


<h3>References</h3>

<p>Huynh, Q.C, Gedamke, T., Hoenig, J.M, and Porch C. 2017. Multispecies Extensions
to a Nonequilibrium Length-Based Mortality Estimator. Marine and Coastal Fisheries 9:68-78.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+profile_MLmulti">profile_MLmulti</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(PRSnapper)
res_eq &lt;- MLmulti(PRSnapper, ncp = 0, start = list(Z = matrix(0.5, nrow = 1, ncol = 3)))
res_SSM &lt;- MLmulti(PRSnapper, ncp = 1, model = "SSM")

MSM1.start.Z &lt;- matrix(0.5, nrow = 2, ncol = 3)
MSM1.start.yearZ &lt;- 1990
start.list &lt;- list(Z = MSM1.start.Z, yearZ = MSM1.start.yearZ)
res_MSM1 &lt;- MLmulti(PRSnapper, ncp = 1, model = "MSM1", start = start.list, grid.search = FALSE)

res_MSM2 &lt;- MLmulti(PRSnapper, ncp = 1, model = "MSM2")

st.Z1 &lt;- rep(0.5, 3)
st.yearZ &lt;- 1990
st.delta &lt;- 1
start.list &lt;- list(Z1 = st.Z1, yearZ = st.yearZ, delta = st.delta)
resMSM3 &lt;- MLmulti(PRSnapper, ncp = 1, model = "MSM3", start = start.list)

## End(Not run)
</code></pre>

<hr>
<h2 id='MLZ_data-class'>MLZ_data</h2><span id='topic+MLZ_data-class'></span><span id='topic+MLZ_data'></span>

<h3>Description</h3>

<p>An S4 class for storing data and life history parameters for a single stock.
Method functions <code>summary</code> and <code>plot</code> are available for this class (see examples).
</p>


<h3>Slots</h3>


<dl>
<dt><code>Stock</code></dt><dd><p>Name of stock.</p>
</dd>
<dt><code>Year</code></dt><dd><p>A vector of years to be considered in the model. Missing years are permitted.</p>
</dd>
<dt><code>Len_bins</code></dt><dd><p>A vector of midpoints of length bins for <code>Len_matrix</code>.</p>
</dd>
<dt><code>Len_matrix</code></dt><dd><p>A matrix of size data. The i-th row corresponds to the i-th year in <code>MLZ_data@Year</code>. The j-th column indexes the j-th length in <code>MLZ_data@Len_bins</code>.</p>
</dd>
<dt><code>Len_df</code></dt><dd><p>A data frame containing individual length observations. The first column should be the Year and the second column should be the length.</p>
</dd>
<dt><code>vbLinf</code></dt><dd><p>L-infinity from the von Bertalanffy growth function.</p>
</dd>
<dt><code>vbK</code></dt><dd><p>Parameter K from the von Bertalanffy growth function.</p>
</dd>
<dt><code>vbt0</code></dt><dd><p>Parameter t0 from the von Bertalanffy growth function.</p>
</dd>
<dt><code>Lc</code></dt><dd><p>Length of full selectivity.</p>
</dd>
<dt><code>M</code></dt><dd><p>Natural mortality rate. If specified, this is also the lower limit for Z.</p>
</dd>
<dt><code>lwb</code></dt><dd><p>Exponent <code>b</code> from the allometric length-weight function <code class="reqn">W = aL^b</code>.</p>
</dd>
<dt><code>MeanLength</code></dt><dd><p>Vector of mean lengths of animals larger than Lc. The i-th entry corresponds to the i-th year in <code>MLZ_data@Year</code>.</p>
</dd>
<dt><code>ss</code></dt><dd><p>Vector of annual sample sizes for MeanLength. The i-th entry corresponds to the i-th year in <code>MLZ_data@Year</code>.</p>
</dd>
<dt><code>CPUE</code></dt><dd><p>Vector of catch-per-unit-effort data. The i-th entry corresponds to the i-th year in <code>MLZ_data@Year</code>.</p>
</dd>
<dt><code>Effort</code></dt><dd><p>Vector of effort data. The i-th entry corresponds to the i-th year in <code>MLZ_data@Year</code>.</p>
</dd>
<dt><code>length.units</code></dt><dd><p>Unit of measurement for lengths, i.e. &quot;cm&quot; or &quot;mm&quot;.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>data(Goosefish); Goosefish
summary(Goosefish)
plot(Goosefish)

new("MLZ_data")
</code></pre>

<hr>
<h2 id='MLZ_model-class'>MLZ_model</h2><span id='topic+MLZ_model-class'></span>

<h3>Description</h3>

<p>An S4 class for storing model results.
Method functions <code>summary</code> and <code>plot</code> are available for this class (see examples).
</p>


<h3>Slots</h3>


<dl>
<dt><code>Stock</code></dt><dd><p>Name of stock (obtained from an object of class <code>MLZ_data</code>).</p>
</dd>
<dt><code>Model</code></dt><dd><p>Name of model used for mortality estimation.</p>
</dd>
<dt><code>time.series</code></dt><dd><p>A data frame summarizing observed time series data and predicted values from model.</p>
</dd>
<dt><code>estimates</code></dt><dd><p>A matrix of parameter estimates and derived values and their standard errors, from
<code><a href="TMB.html#topic+sdreport">sdreport</a></code>.</p>
</dd>
<dt><code>negLL</code></dt><dd><p>The negative log-likelihood from the model.</p>
</dd>
<dt><code>n.changepoint</code></dt><dd><p>The number of change points in the model.</p>
</dd>
<dt><code>n.species</code></dt><dd><p>The number of species/stocks in the model.</p>
</dd>
<dt><code>grid.search</code></dt><dd><p>A data frame reporting the log-likelihood values from a grid search over change points.
See <code><a href="#topic+profile_ML">profile_ML</a></code>, <code><a href="#topic+profile_MLCR">profile_MLCR</a></code>, and <code><a href="#topic+profile_MLmulti">profile_MLmulti</a></code>.</p>
</dd>
<dt><code>obj</code></dt><dd><p>A list with components from <code><a href="TMB.html#topic+MakeADFun">MakeADFun</a></code>.</p>
</dd>
<dt><code>opt</code></dt><dd><p>A list with components from calling <code><a href="stats.html#topic+optim">optim</a></code> to <code>obj</code>.</p>
</dd>
<dt><code>sdrep</code></dt><dd><p>A class <code>sdreport</code> list with components from calling <code><a href="TMB.html#topic+sdreport">sdreport</a></code> to <code>obj</code>.</p>
</dd>
<dt><code>length.units</code></dt><dd><p>Unit of measurement for lengths, i.e. &quot;cm&quot; or &quot;mm&quot;.</p>
</dd>
</dl>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Goosefish)
goose.model &lt;- ML(Goosefish, ncp = 2, grid.search = FALSE, figure = FALSE)
class(goose.model)

summary(goose.model)
plot(goose.model, residuals = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='modal_length'>Modal length from length data</h2><span id='topic+modal_length'></span>

<h3>Description</h3>

<p>Calculates the annual modal length from the length data, which can be used to select Lc. 
Note: Modal length can change over time for many reasons, including a change in mortality 
(Hordyk et al. 2015), recruitment, or selectivity (Huynh et al. 2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modal_length(MLZ_data, length.slot = c("Len_df", "Len_matrix"),
  breaks = NULL, figure = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modal_length_+3A_mlz_data">MLZ_data</code></td>
<td>
<p>An object of class <code>MLZ_data</code>.</p>
</td></tr>
<tr><td><code id="modal_length_+3A_length.slot">length.slot</code></td>
<td>
<p>Name of slot in <code><a href="#topic+MLZ_data-class">MLZ_data</a></code> from which to calculate
modal lengths, either: <code>Len_df</code> or <code>Len_matrix</code>. Only used if there are data in both slots.</p>
</td></tr>
<tr><td><code id="modal_length_+3A_breaks">breaks</code></td>
<td>
<p>Only used for <code>Len_df</code>. An optional vector for breaks for <code><a href="#topic+bin_length">bin_length</a></code>.</p>
</td></tr>
<tr><td><code id="modal_length_+3A_figure">figure</code></td>
<td>
<p>If TRUE, a plot is also drawn.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Length frequency matrix from <code>Len_df</code> are created by using <code><a href="graphics.html#topic+hist">hist</a></code> function.
</p>


<h3>Value</h3>

<p>A data frame of plotted values.
</p>


<h3>References</h3>

<p>Hordyk, A. Ono, K., Sainsbury, K., Loneragan, N., and Prince, J. 2015. Some explorations of the 
life history ratios to describe length composition, spawning-per-recruit, and the 
spawning potential ratio. ICES Journal of Marine Science 72:204-216.
</p>
<p>Huynh, Q.C, Gedamke, T., Hoenig, J.M, and Porch C. 2017. Multispecies Extensions
to a Nonequilibrium Length-Based Mortality Estimator. Marine and Coastal Fisheries 9:68-78.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Nephrops)
modal_length(Nephrops)

data(SilkSnapper)
new.dataset &lt;- new("MLZ_data", Year = 1983:2013, Len_df = SilkSnapper)
modal_length(new.dataset)
modal_length(new.dataset, breaks = seq(80, 830, 10))

## End(Not run)
</code></pre>

<hr>
<h2 id='MuttonSnapper'>Puerto Rico Mutton Snapper (for ML, MLCR)</h2><span id='topic+MuttonSnapper'></span>

<h3>Description</h3>

<p>Mean lengths, CPUE, and life history for Puerto Rico mutton snapper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MuttonSnapper
</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code>.</p>


<h3>References</h3>

<p>Huynh, Q.C., Gedamke, T., Porch, C.E., Hoenig, J.M., Walter, J.F, Bryan, M, and Brodziak, J.
In revision. Estimating Total Mortality Rates from Mean Lengths and Catch Rates in Non-equilibrium
Situations. Transactions of the American Fisheries Society.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MuttonSnapper)

</code></pre>

<hr>
<h2 id='Nephrops'>Male Nephrops FU 28-29 (for MLeffort)</h2><span id='topic+Nephrops'></span>

<h3>Description</h3>

<p>An S4 object containing length and effort time series and life history parameters of male Nephrops in FU 28-29.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Nephrops
</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code>.</p>


<h3>References</h3>

<p>Then, A.Y, Hoenig, J.M, and Huynh, Q.C. In revision. Estimating fishing and natural mortality rates,
and catchability coefficient, from a series of observations on mean length and fishing effort.
ICES Journal of Marine Science.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Nephrops)

</code></pre>

<hr>
<h2 id='plot+2CMLZ_data-method'><code>plot</code> method for S4 class <code>MLZ_data</code></h2><span id='topic+plot+2CMLZ_data-method'></span><span id='topic+plot.MLZ_data'></span>

<h3>Description</h3>

<p>Plots annual length frequencies from slot <code>Len_matrix</code> or <code>Len_df</code>. If there are data in 
both slots, <code>Len_matrix</code> is preferentially plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MLZ_data'
plot(x, type = c("ML", "comp"),
  ggplot_layer = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot+2B2CMLZ_data-method_+3A_x">x</code></td>
<td>
<p>An object of class <code>MLZ_data</code>.</p>
</td></tr>
<tr><td><code id="plot+2B2CMLZ_data-method_+3A_type">type</code></td>
<td>
<p>Character. <code>"comp"</code> produces a annual length frequencies from ggplot2, while <code>"ML"</code>
plots mean lengths from slot <code>MLZ_data@ML</code>, as well as data from 
<code>MLZ_data@CPUE</code> and <code>MLZ_data@Effort</code> if available..</p>
</td></tr>
<tr><td><code id="plot+2B2CMLZ_data-method_+3A_ggplot_layer">ggplot_layer</code></td>
<td>
<p>Optional layers to add to ggplot2 plot for <code>type = "comp"</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Nephrops)
plot(Nephrops)
plot(Nephrops, type = "ML")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+2CMLZ_model-method'><code>plot</code> method for S4 class <code>MLZ_model</code></h2><span id='topic+plot+2CMLZ_model-method'></span><span id='topic+plot.MLZ_model'></span>

<h3>Description</h3>

<p>Plots time series of observed and predicted data from an object of class <code>MLZ_model</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MLZ_model'
plot(x, residuals = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot+2B2CMLZ_model-method_+3A_x">x</code></td>
<td>
<p>An object of class <code>MLZ_model</code>.</p>
</td></tr>
<tr><td><code id="plot+2B2CMLZ_model-method_+3A_residuals">residuals</code></td>
<td>
<p>logical; whether a plot of residuals will also be produced.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Goosefish)
goose.model &lt;- ML(Goosefish, ncp = 2, grid.search = FALSE, figure = FALSE)
plot(goose.model)

## End(Not run)
</code></pre>

<hr>
<h2 id='profile_ML'>Grid search for the mean length estimator</h2><span id='topic+profile_ML'></span>

<h3>Description</h3>

<p>A grid search is performed over the time series, which can be used to identify local and global minima. A
plot of the likelihood surface is also created similar to Figure 6 of Gedamke and Hoenig (2006) or
Figure 3 of Huynh et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profile_ML(MLZ_data, ncp, startZ = rep(0.5, ncp + 1), min.time = 3,
  parallel = ifelse(ncp &gt; 2, TRUE, FALSE), figure = TRUE,
  color = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile_ML_+3A_mlz_data">MLZ_data</code></td>
<td>
<p>An object of class <code>MLZ_data</code>.</p>
</td></tr>
<tr><td><code id="profile_ML_+3A_ncp">ncp</code></td>
<td>
<p>The number of change points.</p>
</td></tr>
<tr><td><code id="profile_ML_+3A_startz">startZ</code></td>
<td>
<p>A vector of length <code>ncp+1</code> as the starting value of total mortality rate used in the grid search.</p>
</td></tr>
<tr><td><code id="profile_ML_+3A_min.time">min.time</code></td>
<td>
<p>The minimum number of years between change points. Only used if <code>ncp &gt; 1</code>.</p>
</td></tr>
<tr><td><code id="profile_ML_+3A_parallel">parallel</code></td>
<td>
<p>Whether grid search is performed using parallel processing.</p>
</td></tr>
<tr><td><code id="profile_ML_+3A_figure">figure</code></td>
<td>
<p>If <code>TRUE</code>, creates a plot of the likelihood over the grid search. Only used
if <code>ncp = 1</code> or <code>2</code>.</p>
</td></tr>
<tr><td><code id="profile_ML_+3A_color">color</code></td>
<td>
<p>If <code>TRUE</code>, creates a color plot for the likelihood surface. Only used if
<code>ncp = 2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of change points with the negative log-likelihood values.
</p>


<h3>References</h3>

<p>Gedamke, T. and Hoenig, J.M. 2006. Estimating mortality from mean length data in
nonequilibrium situations, with application to the assessment of goosefish.
Transactions of the American Fisheries Society 135:476-487.
</p>
<p>Huynh, Q.C, Gedamke, T., Hoenig, J.M, and Porch C. 2017. Multispecies Extensions
to a Nonequilibrium Length-Based Mortality Estimator. Marine and Coastal Fisheries 9:68-78.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Goosefish)
profile_ML(Goosefish, ncp = 1)
profile_ML(Goosefish, ncp = 2)

## End(Not run)
</code></pre>

<hr>
<h2 id='profile_MLCR'>Grid search for the mean length with catch rate estimator</h2><span id='topic+profile_MLCR'></span>

<h3>Description</h3>

<p>A grid search is performed over the time series, which can be used to identify local and global minima. A
plot of the likelihood surface is also created similar to Figure 6 of Gedamke and Hoenig (2006) or
Figure 3 of Huynh et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profile_MLCR(MLZ_data, ncp, CPUE.type = c(NA, "NPUE", "WPUE"),
  loglikeCPUE = c("normal", "lognormal"), startZ = rep(0.5, ncp + 1),
  min.time = 3, parallel = ifelse(ncp &gt; 2, TRUE, FALSE),
  figure = TRUE, color = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile_MLCR_+3A_mlz_data">MLZ_data</code></td>
<td>
<p>An object of class <code>MLZ_data</code>.</p>
</td></tr>
<tr><td><code id="profile_MLCR_+3A_ncp">ncp</code></td>
<td>
<p>The number of change points.</p>
</td></tr>
<tr><td><code id="profile_MLCR_+3A_cpue.type">CPUE.type</code></td>
<td>
<p>Indicates whether CPUE time series is abundance or biomass based.</p>
</td></tr>
<tr><td><code id="profile_MLCR_+3A_loglikecpue">loglikeCPUE</code></td>
<td>
<p>Indicates whether the log-likelihood for the CPUE will be lognormally or
normally distributed.</p>
</td></tr>
<tr><td><code id="profile_MLCR_+3A_startz">startZ</code></td>
<td>
<p>A vector of length <code>ncp+1</code> as the starting value of total mortality rate used in the grid search.</p>
</td></tr>
<tr><td><code id="profile_MLCR_+3A_min.time">min.time</code></td>
<td>
<p>The minimum number of years between change points. Only used if <code>ncp &gt; 1</code>.</p>
</td></tr>
<tr><td><code id="profile_MLCR_+3A_parallel">parallel</code></td>
<td>
<p>Whether the grid search is performed with parallel processing.</p>
</td></tr>
<tr><td><code id="profile_MLCR_+3A_figure">figure</code></td>
<td>
<p>If <code>TRUE</code>, creates a plot of the likelihood over the grid search. Only used
if <code>ncp = 1</code> or <code>2</code>.</p>
</td></tr>
<tr><td><code id="profile_MLCR_+3A_color">color</code></td>
<td>
<p>If <code>TRUE</code>, creates a color plot for the likelihood surface. Only used if
<code>ncp = 2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of change points with the total negative log-likelihood values and values 
from the mean lengths and catch rates.
</p>


<h3>References</h3>

<p>Gedamke, T. and Hoenig, J.M. 2006. Estimating mortality from mean length data in
nonequilibrium situations, with application to the assessment of goosefish.
Transactions of the American Fisheries Society 135:476-487.
</p>
<p>Huynh, Q.C, Gedamke, T., Hoenig, J.M, and Porch C. 2017. Multispecies Extensions
to a Nonequilibrium Length-Based Mortality Estimator. Marine and Coastal Fisheries 9:68-78.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(MuttonSnapper)
profile_MLCR(MuttonSnapper, ncp = 1, CPUE.type = 'WPUE')

## End(Not run)
</code></pre>

<hr>
<h2 id='profile_MLmulti'>Grid search for the multispecies mean length estimator</h2><span id='topic+profile_MLmulti'></span>

<h3>Description</h3>

<p>A grid search is performed over the time series, which can be used to identify local and global minima. A
plot of the likelihood surface is also created similar to Figure 6 of Gedamke and Hoenig (2006) or
Figure 3 of Huynh et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profile_MLmulti(MLZ.list, ncp, model = c("SSM", "MSM1", "MSM2", "MSM3"),
  startZ1 = rep(0.5, length(MLZ.list)), parallel = ifelse(ncp &gt; 2,
  TRUE, FALSE), min.time = 3, figure = TRUE, color = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile_MLmulti_+3A_mlz.list">MLZ.list</code></td>
<td>
<p>A list containing an object of class <code>MLZ_data</code> for each species or stock.</p>
</td></tr>
<tr><td><code id="profile_MLmulti_+3A_ncp">ncp</code></td>
<td>
<p>The number of change points.</p>
</td></tr>
<tr><td><code id="profile_MLmulti_+3A_model">model</code></td>
<td>
<p>The name of the multispecies model for the grid search.</p>
</td></tr>
<tr><td><code id="profile_MLmulti_+3A_startz1">startZ1</code></td>
<td>
<p>A vector of length <code>ncp+1</code> as the starting value of total mortality rate used in the grid search.</p>
</td></tr>
<tr><td><code id="profile_MLmulti_+3A_parallel">parallel</code></td>
<td>
<p>Whether the grid search is performed with parallel processing.</p>
</td></tr>
<tr><td><code id="profile_MLmulti_+3A_min.time">min.time</code></td>
<td>
<p>The minimum number of years between change points. Only used if <code>ncp &gt; 1</code>.</p>
</td></tr>
<tr><td><code id="profile_MLmulti_+3A_figure">figure</code></td>
<td>
<p>If <code>TRUE</code>, creates a plot of the likelihood over the grid search. Only used
if <code>ncp = 1</code> or <code>2</code>.</p>
</td></tr>
<tr><td><code id="profile_MLmulti_+3A_color">color</code></td>
<td>
<p>If <code>TRUE</code>, creates a color plot for the likelihood surface. Only used if
<code>ncp = 2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of change points with the total negative log-likelihood values and values 
from the each species.
</p>


<h3>References</h3>

<p>Gedamke, T. and Hoenig, J.M. 2006. Estimating mortality from mean length data in
nonequilibrium situations, with application to the assessment of goosefish.
Transactions of the American Fisheries Society 135:476-487.
</p>
<p>Huynh, Q.C, Gedamke, T., Hoenig, J.M, and Porch C. 2017. Multispecies Extensions
to a Nonequilibrium Length-Based Mortality Estimator. Marine and Coastal Fisheries 9:68-78.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(PRSnapper)
profile_MLmulti(PRSnapper, ncp = 1, model = "MSM1")

## End(Not run)
</code></pre>

<hr>
<h2 id='PRSnapper'>Puerto Rico Snapper (for MLmulti)</h2><span id='topic+PRSnapper'></span>

<h3>Description</h3>

<p>Mean lengths and life history for 3 species in the Puerto Rico Deepwater Snapper Complex (Unit 1):
silk snapper, blackfin snapper, and vermilion snapper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PRSnapper
</code></pre>


<h3>Format</h3>

<p>A list containing objects of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code>.</p>


<h3>References</h3>

<p>Huynh, Q.C, Gedamke, T., Hoenig, J.M, and Porch C. In press. Multispecies Extensions to a Nonequilibrium
Length-Based Mortality Estimator. Marine and Coastal Fisheries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PRSnapper)

</code></pre>

<hr>
<h2 id='sensitivity_Lc'>Sensitivity to Lc</h2><span id='topic+sensitivity_Lc'></span>

<h3>Description</h3>

<p>The function re-calculates mean lengths for each alternative value of Lc and 
re-estimates mortality. Currently supports only the ML estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity_Lc(MLZ_data, MLZ_model, Lc.vec, grid.search = FALSE,
  figure = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sensitivity_Lc_+3A_mlz_data">MLZ_data</code></td>
<td>
<p>An object of class <code><a href="#topic+MLZ_data-class">MLZ_data</a></code> containing mean lengths and
life history data of stock. Must contain length composition data.</p>
</td></tr>
<tr><td><code id="sensitivity_Lc_+3A_mlz_model">MLZ_model</code></td>
<td>
<p>An object of class <code><a href="#topic+MLZ_model-class">MLZ_model</a></code> with base value of Lc.</p>
</td></tr>
<tr><td><code id="sensitivity_Lc_+3A_lc.vec">Lc.vec</code></td>
<td>
<p>A vector of alternative Lc values.</p>
</td></tr>
<tr><td><code id="sensitivity_Lc_+3A_grid.search">grid.search</code></td>
<td>
<p>Whether a grid search is performed or not. By default, the starting values 
in the sensitivity analysis are the estimates from object <code>MLZ_model</code>.</p>
</td></tr>
<tr><td><code id="sensitivity_Lc_+3A_figure">figure</code></td>
<td>
<p>Whether a figure will be produced, similar to Figure 6 of Huynh et al. (2017).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of mortality and change point estimates with each value Lc.
</p>


<h3>References</h3>

<p>Huynh, Q.C, Gedamke, T., Hoenig, J.M, and Porch C. 2017. Multispecies Extensions
to a Nonequilibrium Length-Based Mortality Estimator. Marine and Coastal Fisheries 9:68-78.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ML">ML</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(SilkSnapper)
new.dataset &lt;- new("MLZ_data", Year = 1983:2013, Len_df = SilkSnapper, length.units = "mm",
vbLinf = 794, vbK = 0.1)

new.dataset@Lc &lt;- 310
new.dataset &lt;- calc_ML(new.dataset)

first.MLZmodel &lt;- ML(new.dataset, 1)
Lc.vec &lt;- seq(240, 340, 5)

sensitivity_Lc(new.dataset, first.MLZmodel, Lc.vec)

## End(Not run)
</code></pre>

<hr>
<h2 id='SilkSnapper'>Silk Snapper</h2><span id='topic+SilkSnapper'></span>

<h3>Description</h3>

<p>Length observed from the Puerto Rico Silk Snapper handline fishery.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SilkSnapper
</code></pre>


<h3>Format</h3>

<p>A data frame.</p>


<h3>References</h3>

<p>Huynh, Q.C, Gedamke, T., Hoenig, J.M, and Porch C. In press. Multispecies Extensions to a Nonequilibrium
Length-Based Mortality Estimator. Marine and Coastal Fisheries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(SilkSnapper)
new("MLZ_data", Len_df = SilkSnapper)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary+2CMLZ_data-method'><code>summary</code> method for S4 class <code>MLZ_data</code></h2><span id='topic+summary+2CMLZ_data-method'></span>

<h3>Description</h3>

<p><code>summary</code> method for S4 class <code>MLZ_data</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MLZ_data'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary+2B2CMLZ_data-method_+3A_object">object</code></td>
<td>
<p>An object of class <code>MLZ_data</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(MuttonSnapper)
summary(MuttonSnapper)

</code></pre>

<hr>
<h2 id='summary+2CMLZ_model-method'><code>summary</code> method for S4 class <code>MLZ_model</code></h2><span id='topic+summary+2CMLZ_model-method'></span>

<h3>Description</h3>

<p><code>summary</code> method for S4 class <code>MLZ_model</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MLZ_model'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary+2B2CMLZ_model-method_+3A_object">object</code></td>
<td>
<p>An object of class <code>MLZ_model</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Goosefish)
goose.model &lt;- ML(Goosefish, ncp = 2, grid.search = FALSE)
summary(goose.model)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
