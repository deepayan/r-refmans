<!DOCTYPE html><html><head><title>Help for package PKPDsim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PKPDsim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PKPDsim-package'><p>PKPDsim package</p></a></li>
<li><a href='#add_quotes'><p>Put vector values in quotes</p></a></li>
<li><a href='#add_ruv'><p>Add residual variability to the dependent variable</p></a></li>
<li><a href='#add_ruv_to_quantile'><p>Calculate the increase in a specific quantile for a distribution on y when residual variability is added</p></a></li>
<li><a href='#adherence_binomial'><p>Binomial adherence</p></a></li>
<li><a href='#adherence_markov'><p>Markov adherence model</p></a></li>
<li><a href='#advan'><p>ADVAN-style functions to calculate linear PK systems</p></a></li>
<li><a href='#advan_create_data'><p>Create ADVAN-style dataset</p></a></li>
<li><a href='#advan_parse_output'><p>Internal function to parse the raw output from ADVAN-style functions</p></a></li>
<li><a href='#advan_process_infusion_doses'><p>Add column RATEALL to ADVAN-style dataset to handle infusions</p></a></li>
<li><a href='#analytical_eqn_wrapper'><p>Wrapper for using analytical equations with PKPD regimens</p></a></li>
<li><a href='#apply_lagtime'><p>Apply lagtime to a regimen</p></a></li>
<li><a href='#bioavailability_to_R_code'><p>Transforms bioavailability specs into appropriate R code</p></a></li>
<li><a href='#calc_dydP'><p>Calculate derivative</p></a></li>
<li><a href='#calc_ss_analytic'><p>Returns the state of a linear PK system at steady state (trough)</p>
using analytics equations (so for linear PK systems only).</a></li>
<li><a href='#calculate_parameters'><p>Calculate model-specific variables using a dummy call to sim_ode()</p></a></li>
<li><a href='#check_iov_specification'><p>Checks that IOV was specified appropriately</p></a></li>
<li><a href='#check_mixture_model'><p>Check that mixture model is specified in right format and within constraints (1 parameter, 2 groups)</p></a></li>
<li><a href='#check_obs_input'><p>Checks obs input for valid combinations of cmt, var, scale</p></a></li>
<li><a href='#compile_sim_cpp'><p>Compile ODE model to c++ function</p></a></li>
<li><a href='#covariate_last_obs_only'><p>Use only last observed covariate values</p></a></li>
<li><a href='#covariates_table_to_list'><p>Convert covariate table specified as data.frame</p></a></li>
<li><a href='#create_event_table'><p>Create an event table</p></a></li>
<li><a href='#create_obs_data'><p>Create obs data</p></a></li>
<li><a href='#cv_to_omega'><p>Create lower-diagonal omega matrix from CV for parameter estimates</p></a></li>
<li><a href='#define_tdm_init_model'><p>defines C code for TDM before dose conditions</p></a></li>
<li><a href='#detect_ode_syntax'><p>Auto-detect the syntax for the ODE code</p></a></li>
<li><a href='#f_cov'><p>covariate function builder</p></a></li>
<li><a href='#get_fixed_parameters'><p>Get fixed parameters</p></a></li>
<li><a href='#get_ode_model_size'><p>Get the number of states in the ODE from the code</p>
code C++ code for model</a></li>
<li><a href='#get_parameters_from_code'><p>Get model parameters from code</p></a></li>
<li><a href='#get_t_obs_from_regimen'><p>Extract sensible default observation times from a specified regimen</p></a></li>
<li><a href='#get_var_y'><p>Get expected variance/sd/ci of dependent variable</p>
based on PKPDsim model, parameters, and regimen</a></li>
<li><a href='#ifelse0'><p>ifelse function but then based on whether value is NULL or not</p></a></li>
<li><a href='#is_newer_package'><p>Check if package number is different from currently installed,</p>
and provide some messaging.</a></li>
<li><a href='#is_positive_definite'><p>Is matrix positive definite</p></a></li>
<li><a href='#join_cov_and_par'><p>Combines covariates and parameters into a single list, useful for reparametrization of the model.</p></a></li>
<li><a href='#join_regimen'><p>Join two dosing regimens</p></a></li>
<li><a href='#lower_triangle_mat_size'><p>Size of the lower triangle of the matrix</p></a></li>
<li><a href='#merge_regimen'><p>Merge two regimens together.</p></a></li>
<li><a href='#model_from_api'><p>Load model definition from API, and compile to R library</p></a></li>
<li><a href='#model_library'><p>Model library</p></a></li>
<li><a href='#mvrnorm2'><p>More powerful multivariate normal sampling function</p></a></li>
<li><a href='#na_locf'><p>Fill in NAs with the previous non-missing value</p></a></li>
<li><a href='#new_adherence'><p>Probabilistically model adherence</p></a></li>
<li><a href='#new_covariate'><p>New covariate</p></a></li>
<li><a href='#new_covariate_model'><p>covariate model function</p></a></li>
<li><a href='#new_ode_model'><p>Create new ODE model</p></a></li>
<li><a href='#new_regimen'><p>Dose regimen for sim_ode</p></a></li>
<li><a href='#nlmixr_parse_parameters'><p>Function to parse parameters for a model into a structure used by nlmixr</p></a></li>
<li><a href='#nm_to_regimen'><p>Create a regimen from NONMEM data</p></a></li>
<li><a href='#now_utc'><p>Current time in UTC</p></a></li>
<li><a href='#OneCompIVbolus'><p>ADVAN-style equations</p></a></li>
<li><a href='#OneCompIVinfusion'><p>IV infusion- 1 compartment</p></a></li>
<li><a href='#OneCompOral'><p>first-order absorption 1 compartment</p></a></li>
<li><a href='#parse_obs_types'><p>Parse observation types to simulation code</p></a></li>
<li><a href='#pkdata'><p>PK dataset</p></a></li>
<li><a href='#pkpdsim_to_nlmixr'><p>Convert a model generated with PKPDsim to an object for nlmixr</p></a></li>
<li><a href='#pop_regimen'><p>Remove n doses (from tail) of PKPDsim regimen</p></a></li>
<li><a href='#print_list'><p>Return a list in R syntax</p></a></li>
<li><a href='#print.covariate'><p>Print function for PKPDsim covariate object</p></a></li>
<li><a href='#print.PKPDsim'><p>Print function for PKPDsim simulation function</p></a></li>
<li><a href='#print.regimen'><p>Print function for PKPDsim regimen</p></a></li>
<li><a href='#read_model_json'><p>Read model definition from JSON</p></a></li>
<li><a href='#regimen_to_nm'><p>Convert PKPDsim regimen to NONMEM table (doses only)</p></a></li>
<li><a href='#reparametrize'><p>Reparametrize model parameters using a reparametrization defined within the model.</p></a></li>
<li><a href='#search_replace_in_file'><p>Find string and replace in file</p></a></li>
<li><a href='#shift_regimen'><p>Remove n doses (from start) of PKPDsim regimen</p></a></li>
<li><a href='#shift_state_indices'><p>R starts counting vector indices at 1, c++ starts at 0,</p>
so reduce all state numbers in the Cpp function definition by 1</a></li>
<li><a href='#sim'><p>Simulate ODE or analytical equation</p></a></li>
<li><a href='#sim_core'><p>Only core function of the simulation function, always just returns observations.</p>
Mostly useful for estimations / optimal design. Has no checks (for speed)!</a></li>
<li><a href='#sim_ode'><p>Deprecated function, renamed to <code>sim()</code></p></a></li>
<li><a href='#sim_ode_shiny'><p>Simulate ODE and create a Shiny app</p></a></li>
<li><a href='#table_to_list'><p>Convert a table to a list</p></a></li>
<li><a href='#test_model'><p>Test a model</p></a></li>
<li><a href='#test_pointer'><p>Test if model still in memory</p></a></li>
<li><a href='#ThreeCompIVbolus'><p>IV bolus- 3 compartment</p></a></li>
<li><a href='#ThreeCompIVinfusion'><p>IV infusion- 3 compartment</p></a></li>
<li><a href='#ThreeCompIVinfusionMetab'><p>3-compartment IV infusion with first-order metabolite formation</p></a></li>
<li><a href='#ThreeCompOral'><p>first-order absorption- 3 compartment</p></a></li>
<li><a href='#ThreeCompOralMetab'><p>first-order absorption- 3 compartment-Metabolite</p></a></li>
<li><a href='#translate_ode'><p>Translate a model from/to various PKPD simulators</p></a></li>
<li><a href='#triangle_to_full'><p>Convert triangle omega matrix to full omega matrix</p></a></li>
<li><a href='#TwoCompIVbolus'><p>IV bolus- 2 compartment</p></a></li>
<li><a href='#TwoCompIVinfusion'><p>IV infusion- 2 compartment</p></a></li>
<li><a href='#TwoCompOral'><p>First-order absorption- 2 compartment</p></a></li>
<li><a href='#vector_to_R_code'><p>Transform a vector into a string that evaluates to the same vector</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Performing Pharmacokinetic-Pharmacodynamic Simulations</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-02-24</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.9), BH, data.table, stringr, MASS, randtoolbox,
jsonlite, stats, parallel, magrittr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>httr, testthat (&ge; 3.0.0), mockery, knitr, rmarkdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, Rcpp (&ge; 0.12.9)</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulate dose regimens for pharmacokinetic-pharmacodynamic (PK-PD)
        models described by differential equation (DE) systems. Simulation using 
        ADVAN-style analytical equations is also supported (Abuhelwa et al. (2015) 
        &lt;<a href="https://doi.org/10.1016%2Fj.vascn.2015.03.004">doi:10.1016/j.vascn.2015.03.004</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/InsightRX/PKPDsim">https://github.com/InsightRX/PKPDsim</a>,
<a href="https://insightrx.github.io/PKPDsim/">https://insightrx.github.io/PKPDsim/</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse, nlmixr2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-02 00:16:35 UTC; ronkeizer</td>
</tr>
<tr>
<td>Author:</td>
<td>Ron Keizer [aut, cre],
  Jasmine Hughes [aut],
  Dominic Tong [aut],
  Kara Woo [aut],
  InsightRX [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ron Keizer &lt;ron@insight-rx.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-02 12:20:28 UTC</td>
</tr>
</table>
<hr>
<h2 id='PKPDsim-package'>PKPDsim package</h2><span id='topic+PKPDsim-package'></span>

<h3>Description</h3>

<p>Simulate regimens for PKPD models defined by ODE systems
</p>


<h3>Author(s)</h3>

<p>Ron Keizer <a href="mailto:ronkeizer@gmail.com">ronkeizer@gmail.com</a>
</p>

<hr>
<h2 id='add_quotes'>Put vector values in quotes</h2><span id='topic+add_quotes'></span>

<h3>Description</h3>

<p>Put vector values in quotes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_quotes(x, quote = "double")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_quotes_+3A_x">x</code></td>
<td>
<p>vector of string / numeric</p>
</td></tr>
<tr><td><code id="add_quotes_+3A_quote">quote</code></td>
<td>
<p>what type of quotes ('double' or 'single')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of input with quotation marks around each value
</p>

<hr>
<h2 id='add_ruv'>Add residual variability to the dependent variable</h2><span id='topic+add_ruv'></span>

<h3>Description</h3>

<p>Add residual variability to the dependent variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_ruv(x, ruv = list(), obs_type = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_ruv_+3A_x">x</code></td>
<td>
<p>dependent value without residual variability</p>
</td></tr>
<tr><td><code id="add_ruv_+3A_ruv">ruv</code></td>
<td>
<p>list specifying proportional, additive and/or exponential errors ('prop', 'add', 'exp')</p>
</td></tr>
<tr><td><code id="add_ruv_+3A_obs_type">obs_type</code></td>
<td>
<p>vector of observation types</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Input vector with residual variability added
</p>

<hr>
<h2 id='add_ruv_to_quantile'>Calculate the increase in a specific quantile for a distribution on y when residual variability is added</h2><span id='topic+add_ruv_to_quantile'></span>

<h3>Description</h3>

<p>Calculate the increase in a specific quantile for a distribution on y when residual variability is added
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_ruv_to_quantile(y, sd_y, log_scale = FALSE, q = NULL, ruv = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_ruv_to_quantile_+3A_y">y</code></td>
<td>
<p>y with</p>
</td></tr>
<tr><td><code id="add_ruv_to_quantile_+3A_sd_y">sd_y</code></td>
<td>
<p>standard deviation of y without residual variability added. Will add normally distributed variability (potentially on log-scale).</p>
</td></tr>
<tr><td><code id="add_ruv_to_quantile_+3A_log_scale">log_scale</code></td>
<td>
<p>add variability on log scale (FALSE by default, DEPRECATED!).</p>
</td></tr>
<tr><td><code id="add_ruv_to_quantile_+3A_q">q</code></td>
<td>
<p>quantile</p>
</td></tr>
<tr><td><code id="add_ruv_to_quantile_+3A_ruv">ruv</code></td>
<td>
<p>list of residual variability ('prop' and 'add')</p>
</td></tr>
<tr><td><code id="add_ruv_to_quantile_+3A_...">...</code></td>
<td>
<p>passed arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of y values with residual variability
</p>

<hr>
<h2 id='adherence_binomial'>Binomial adherence</h2><span id='topic+adherence_binomial'></span>

<h3>Description</h3>

<p>Model adherence as a binomial probability at the time of each occasion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adherence_binomial(n = 100, prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adherence_binomial_+3A_n">n</code></td>
<td>
<p>number of occasions</p>
</td></tr>
<tr><td><code id="adherence_binomial_+3A_prob">prob</code></td>
<td>
<p>binomial probability</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of length 'n'
containing values 0 (non-adherent) or 1 (adherent).
</p>
<p>Numeric vector of length n
</p>

<hr>
<h2 id='adherence_markov'>Markov adherence model</h2><span id='topic+adherence_markov'></span>

<h3>Description</h3>

<p>Model adherence as a markov chain model, based on the probability of staying
adherent and of becoming adherent once non-adherent. Assumes all patients
start adherent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adherence_markov(n = 100, p11 = 0.9, p01 = 0.7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adherence_markov_+3A_n">n</code></td>
<td>
<p>number of occasions</p>
</td></tr>
<tr><td><code id="adherence_markov_+3A_p11">p11</code></td>
<td>
<p>probability of staying adherent</p>
</td></tr>
<tr><td><code id="adherence_markov_+3A_p01">p01</code></td>
<td>
<p>probability of going from non-adherent to adherent state</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of length 'n'
containing values 0 (non-adherent) or 1 (adherent).
</p>
<p>Numeric vector of length n
</p>

<hr>
<h2 id='advan'>ADVAN-style functions to calculate linear PK systems</h2><span id='topic+advan'></span>

<h3>Description</h3>

<p>ADVAN-style functions to calculate linear PK systems
</p>


<h3>Usage</h3>

<pre><code class='language-R'>advan(model, cpp = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="advan_+3A_model">model</code></td>
<td>
<p>Standard linear PK model, e.g. 'pk_1cmt_iv_bolus'.</p>
</td></tr>
<tr><td><code id="advan_+3A_cpp">cpp</code></td>
<td>
<p>use C++-versions of model (~50x faster than R implementations)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Model function
</p>

<hr>
<h2 id='advan_create_data'>Create ADVAN-style dataset</h2><span id='topic+advan_create_data'></span>

<h3>Description</h3>

<p>Create ADVAN-style dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>advan_create_data(
  regimen,
  parameters,
  cmts = 5,
  t_obs = NULL,
  covariates = NULL,
  covariate_model = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="advan_create_data_+3A_regimen">regimen</code></td>
<td>
<p>PKPDsim regimen</p>
</td></tr>
<tr><td><code id="advan_create_data_+3A_parameters">parameters</code></td>
<td>
<p>list of parameters</p>
</td></tr>
<tr><td><code id="advan_create_data_+3A_cmts">cmts</code></td>
<td>
<p>number of compartments, minimum is 1. Default is 5, which is enough for most linear PK models. It is OK to have more compartments available than are actually being used.</p>
</td></tr>
<tr><td><code id="advan_create_data_+3A_t_obs">t_obs</code></td>
<td>
<p>add observation timepoints to dataset</p>
</td></tr>
<tr><td><code id="advan_create_data_+3A_covariates">covariates</code></td>
<td>
<p>covariate list</p>
</td></tr>
<tr><td><code id="advan_create_data_+3A_covariate_model">covariate_model</code></td>
<td>
<p>covariate model equations, written in C</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame of ADVAN-style data
</p>

<hr>
<h2 id='advan_parse_output'>Internal function to parse the raw output from ADVAN-style functions</h2><span id='topic+advan_parse_output'></span>

<h3>Description</h3>

<p>Internal function to parse the raw output from ADVAN-style functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>advan_parse_output(data, cmts = 1, t_obs, extra_t_obs = TRUE, regimen)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="advan_parse_output_+3A_data">data</code></td>
<td>
<p>simulation output data</p>
</td></tr>
<tr><td><code id="advan_parse_output_+3A_cmts">cmts</code></td>
<td>
<p>number of compartments</p>
</td></tr>
<tr><td><code id="advan_parse_output_+3A_t_obs">t_obs</code></td>
<td>
<p>observation times</p>
</td></tr>
<tr><td><code id="advan_parse_output_+3A_extra_t_obs">extra_t_obs</code></td>
<td>
<p>leave extra added dose times in dataset?</p>
</td></tr>
<tr><td><code id="advan_parse_output_+3A_regimen">regimen</code></td>
<td>
<p>PKPDsim regimen</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing parsed simulation data
</p>

<hr>
<h2 id='advan_process_infusion_doses'>Add column RATEALL to ADVAN-style dataset to handle infusions</h2><span id='topic+advan_process_infusion_doses'></span>

<h3>Description</h3>

<p>Function adapted from code from Abuhelwa, Foster, Upton JPET 2015.
cleaned up and somewhat optimized. Can potentially be optimized more.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>advan_process_infusion_doses(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="advan_process_infusion_doses_+3A_data">data</code></td>
<td>
<p>ADVAN-style dataset, e.g. created using 'advan_create_data'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing additional RATEALL column.
</p>


<h3>References</h3>

<p>Abuhelwa, A. Y., Foster, D. J. R., Upton, R. N. (2015)
ADVAN-style analytical solutions for common pharmacokinetic models. J
Pharmacol Toxicol Methods 73:42-8. DOI: 10.1016/j.vascn.2015.03.004
</p>

<hr>
<h2 id='analytical_eqn_wrapper'>Wrapper for using analytical equations with PKPD regimens</h2><span id='topic+analytical_eqn_wrapper'></span>

<h3>Description</h3>

<p>In development. Needs to be optimized significantly to be useful in production.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analytical_eqn_wrapper(analytical, design = NULL, parameters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analytical_eqn_wrapper_+3A_analytical">analytical</code></td>
<td>
<p>analytical equation, taking parameters 'amt', 'parameters', and 't', and returning a vector of values for 'y'</p>
</td></tr>
<tr><td><code id="analytical_eqn_wrapper_+3A_design">design</code></td>
<td>
<p>design dataset created by 'sim_ode'</p>
</td></tr>
<tr><td><code id="analytical_eqn_wrapper_+3A_parameters">parameters</code></td>
<td>
<p>list of parameters</p>
</td></tr>
</table>

<hr>
<h2 id='apply_lagtime'>Apply lagtime to a regimen</h2><span id='topic+apply_lagtime'></span>

<h3>Description</h3>

<p>Apply lagtime to a regimen
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_lagtime(regimen, lagtime, parameters, cmt_mapping = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_lagtime_+3A_regimen">regimen</code></td>
<td>
<p>PKPDsim regimen</p>
</td></tr>
<tr><td><code id="apply_lagtime_+3A_lagtime">lagtime</code></td>
<td>
<p>lagtime object, either single value / parameter name or vector of values/parameter names for all compartments.</p>
</td></tr>
<tr><td><code id="apply_lagtime_+3A_parameters">parameters</code></td>
<td>
<p>parameter list, required if parameters are specified.</p>
</td></tr>
<tr><td><code id="apply_lagtime_+3A_cmt_mapping">cmt_mapping</code></td>
<td>
<p>map of administration types to compartments, e.g. 'list(&quot;oral&quot; = 1, &quot;infusion&quot; = 2, &quot;bolus&quot; = 2)'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Original regimen with lagtime added to dose times
</p>

<hr>
<h2 id='bioavailability_to_R_code'>Transforms bioavailability specs into appropriate R code</h2><span id='topic+bioavailability_to_R_code'></span>

<h3>Description</h3>

<p>Specialized wrapper around 'vector_to_R_code' that makes reasonable PK
assumptions for when the bioavailability specification is NULL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bioavailability_to_R_code(bioav)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bioavailability_to_R_code_+3A_bioav">bioav</code></td>
<td>
<p>bioavailability specification, either NULL (assume a value of 1
in all compartments), a single value (assume it applies to all
compartments), or a vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character string of length 1
</p>

<hr>
<h2 id='calc_dydP'>Calculate derivative</h2><span id='topic+calc_dydP'></span>

<h3>Description</h3>

<p>Calculate derivative
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_dydP(dy, y, rel_delta, log_y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_dydP_+3A_dy">dy</code></td>
<td>
<p>dy</p>
</td></tr>
<tr><td><code id="calc_dydP_+3A_y">y</code></td>
<td>
<p>dependent value</p>
</td></tr>
<tr><td><code id="calc_dydP_+3A_rel_delta">rel_delta</code></td>
<td>
<p>relative delta</p>
</td></tr>
<tr><td><code id="calc_dydP_+3A_log_y">log_y</code></td>
<td>
<p>logical indicating if the dependent variable is log transformed</p>
</td></tr>
</table>

<hr>
<h2 id='calc_ss_analytic'>Returns the state of a linear PK system at steady state (trough)
using analytics equations (so for linear PK systems only).</h2><span id='topic+calc_ss_analytic'></span>

<h3>Description</h3>

<p>Basically it performs a PK simulation using analytic equations instead
of ODEs to steady state (n=45 days, increased if needed).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_ss_analytic(
  f = "1cmt_oral",
  dose,
  interval,
  t_inf = NULL,
  model,
  parameters,
  covariates = NULL,
  map = NULL,
  n_days = 45,
  n_transit_compartments = 0,
  auc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_ss_analytic_+3A_f">f</code></td>
<td>
<p>analytic equation to use, must be one of 'names(advan_funcs)'</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_dose">dose</code></td>
<td>
<p>dose</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_interval">interval</code></td>
<td>
<p>interval</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_t_inf">t_inf</code></td>
<td>
<p>infusion time</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_model">model</code></td>
<td>
<p>PKPDsim model</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_parameters">parameters</code></td>
<td>
<p>parameters list</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_covariates">covariates</code></td>
<td>
<p>covariates list</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_map">map</code></td>
<td>
<p>list for remapping parameters, ex: 'list(CL = &quot;CL&quot;, V = &quot;V&quot;)'</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_n_days">n_days</code></td>
<td>
<p>number of days at which to assume steady state. Default is 45.</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_n_transit_compartments">n_transit_compartments</code></td>
<td>
<p>number of transit compartments, will insert n compartments between the first (dose) compartment and the second (central) compartment.</p>
</td></tr>
<tr><td><code id="calc_ss_analytic_+3A_auc">auc</code></td>
<td>
<p>add (empty) AUC compartment at end of state vector?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It can also be used for models with transit compartments, however,
the assumption is made that at the end of the dosing interval the
amount in the transit compartments is negligible (0).
</p>


<h3>Value</h3>

<p>State vector of a linear pharmacokinetic system at steady state
</p>

<hr>
<h2 id='calculate_parameters'>Calculate model-specific variables using a dummy call to sim_ode()</h2><span id='topic+calculate_parameters'></span>

<h3>Description</h3>

<p>This is a convenience function for PKPDsim users, it is not used inside the 'sim_ode()&ldquo;
function in any way.
This function is useful for converting from an estimated parameter to actual parameter,
e.g. when clearance is specified as 'CLi = CL * (WT/70) * (1/CR)' it can be used to
calculate 'CLi' without having to write that function a second time in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_parameters(
  ode = NULL,
  parameters = NULL,
  covariates = NULL,
  include_parameters = TRUE,
  include_variables = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_parameters_+3A_ode">ode</code></td>
<td>
<p>PKPDsim model object</p>
</td></tr>
<tr><td><code id="calculate_parameters_+3A_parameters">parameters</code></td>
<td>
<p>parameter list</p>
</td></tr>
<tr><td><code id="calculate_parameters_+3A_covariates">covariates</code></td>
<td>
<p>covariate list. Make sure to include covariates at the right time point, since only last observed covariate values are used.</p>
</td></tr>
<tr><td><code id="calculate_parameters_+3A_include_parameters">include_parameters</code></td>
<td>
<p>boolean, include parameters?</p>
</td></tr>
<tr><td><code id="calculate_parameters_+3A_include_variables">include_variables</code></td>
<td>
<p>boolean, include variables?</p>
</td></tr>
<tr><td><code id="calculate_parameters_+3A_...">...</code></td>
<td>
<p>arguments to pass on to simulation function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of model-specific variables
</p>

<hr>
<h2 id='check_iov_specification'>Checks that IOV was specified appropriately</h2><span id='topic+check_iov_specification'></span>

<h3>Description</h3>

<p>Inter-occasion variability (IOV) is expected to be supplied as a list with
'cv' and 'n_bins' specified. 'cv' is expected to be a named list with IOV
for each PK parameter. This function then checks to ensure that the PK code
or ODE code contains an IOV term for each PK parameter specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_iov_specification(iov, code, pk_code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_iov_specification_+3A_iov">iov</code></td>
<td>
<p>IOV specifications, provided as a nested named list.</p>
</td></tr>
<tr><td><code id="check_iov_specification_+3A_code">code</code></td>
<td>
<p>C++ ODE code, supplied as a string</p>
</td></tr>
<tr><td><code id="check_iov_specification_+3A_pk_code">pk_code</code></td>
<td>
<p>C++ PK code, supplied as a string</p>
</td></tr>
</table>

<hr>
<h2 id='check_mixture_model'>Check that mixture model is specified in right format and within constraints (1 parameter, 2 groups)</h2><span id='topic+check_mixture_model'></span>

<h3>Description</h3>

<p>Check that mixture model is specified in right format and within constraints (1 parameter, 2 groups)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_mixture_model(mixture, parameters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_mixture_model_+3A_mixture">mixture</code></td>
<td>
<p>mixture model specification (as list, e.g. 'list(&quot;CL&quot; = list(values=c(5, 10), probability=0.3))')</p>
</td></tr>
<tr><td><code id="check_mixture_model_+3A_parameters">parameters</code></td>
<td>
<p>vector of parameter names</p>
</td></tr>
</table>

<hr>
<h2 id='check_obs_input'>Checks obs input for valid combinations of cmt, var, scale</h2><span id='topic+check_obs_input'></span>

<h3>Description</h3>

<p>Checks obs input for valid combinations of cmt, var, scale
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_obs_input(obs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_obs_input_+3A_obs">obs</code></td>
<td>
<p>specified observation object including at least a description of
which variable(s) are associated with a particular compartment, e.g.
'list(variable=&quot;CONC&quot;, scale=&quot;1&quot;)'.</p>
</td></tr>
</table>

<hr>
<h2 id='compile_sim_cpp'>Compile ODE model to c++ function</h2><span id='topic+compile_sim_cpp'></span>

<h3>Description</h3>

<p>Compile ODE model to c++ function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compile_sim_cpp(
  code,
  dose_code,
  pk_code,
  size,
  p,
  cpp_show_code,
  code_init = NULL,
  state_init = NULL,
  declare_variables = NULL,
  variables = NULL,
  covariates = NULL,
  obs = NULL,
  dose = NULL,
  iov = NULL,
  compile = TRUE,
  verbose = FALSE,
  as_is = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compile_sim_cpp_+3A_code">code</code></td>
<td>
<p>C++ code ODE system</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_dose_code">dose_code</code></td>
<td>
<p>C++ code per dose event</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_pk_code">pk_code</code></td>
<td>
<p>C++ code per any event (similar to $PK)</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_size">size</code></td>
<td>
<p>size of ODE system</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_p">p</code></td>
<td>
<p>parameters (list)</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_cpp_show_code">cpp_show_code</code></td>
<td>
<p>show output c++ function?</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_code_init">code_init</code></td>
<td>
<p>code for initialization of state</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_state_init">state_init</code></td>
<td>
<p>state init vector</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_declare_variables">declare_variables</code></td>
<td>
<p>variable declaration for all required variables (including user-specified)</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_variables">variables</code></td>
<td>
<p>only the user-specified variables</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_covariates">covariates</code></td>
<td>
<p>covariates specification</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_obs">obs</code></td>
<td>
<p>observation specification</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_dose">dose</code></td>
<td>
<p>dose specification</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_iov">iov</code></td>
<td>
<p>iov specification</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_compile">compile</code></td>
<td>
<p>compile or not?</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_verbose">verbose</code></td>
<td>
<p>show more output</p>
</td></tr>
<tr><td><code id="compile_sim_cpp_+3A_as_is">as_is</code></td>
<td>
<p>use C-code as-is, don't substitute line-endings or shift indices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing ODE definition in C++ code and simulation function
</p>

<hr>
<h2 id='covariate_last_obs_only'>Use only last observed covariate values</h2><span id='topic+covariate_last_obs_only'></span>

<h3>Description</h3>

<p>Use only last observed covariate values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covariate_last_obs_only(covariates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covariate_last_obs_only_+3A_covariates">covariates</code></td>
<td>
<p>covariates object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing same elements as input covariate object but including only the last value for each covariate
</p>

<hr>
<h2 id='covariates_table_to_list'>Convert covariate table specified as data.frame</h2><span id='topic+covariates_table_to_list'></span>

<h3>Description</h3>

<p>Can handle time-varying data too, if 't' or 'time' is specified as column
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covariates_table_to_list(covariates_table, covariates_implementation = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covariates_table_to_list_+3A_covariates_table">covariates_table</code></td>
<td>
<p>'data.frame&ldquo; with covariates in columns. Potentially with 'id' and 't' columns</p>
</td></tr>
<tr><td><code id="covariates_table_to_list_+3A_covariates_implementation">covariates_implementation</code></td>
<td>
<p>'list' with implementation method per covariate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of covariates
</p>

<hr>
<h2 id='create_event_table'>Create an event table</h2><span id='topic+create_event_table'></span>

<h3>Description</h3>

<p>Create an event table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_event_table(
  regimen,
  t_max = NULL,
  t_obs = NULL,
  t_tte = NULL,
  t_init = 0,
  p,
  covariates,
  model = NULL,
  obs_type = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_event_table_+3A_regimen">regimen</code></td>
<td>
<p>regimen</p>
</td></tr>
<tr><td><code id="create_event_table_+3A_t_max">t_max</code></td>
<td>
<p>t_max</p>
</td></tr>
<tr><td><code id="create_event_table_+3A_t_obs">t_obs</code></td>
<td>
<p>t_obs</p>
</td></tr>
<tr><td><code id="create_event_table_+3A_t_tte">t_tte</code></td>
<td>
<p>t_tte</p>
</td></tr>
<tr><td><code id="create_event_table_+3A_t_init">t_init</code></td>
<td>
<p>t_init</p>
</td></tr>
<tr><td><code id="create_event_table_+3A_p">p</code></td>
<td>
<p>parameters</p>
</td></tr>
<tr><td><code id="create_event_table_+3A_covariates">covariates</code></td>
<td>
<p>covariates</p>
</td></tr>
<tr><td><code id="create_event_table_+3A_model">model</code></td>
<td>
<p>model</p>
</td></tr>
<tr><td><code id="create_event_table_+3A_obs_type">obs_type</code></td>
<td>
<p>observation type</p>
</td></tr>
</table>

<hr>
<h2 id='create_obs_data'>Create obs data</h2><span id='topic+create_obs_data'></span>

<h3>Description</h3>

<p>Used by <code><a href="#topic+sim">sim()</a></code> to arrange data from ode() function into the correct format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_obs_data(ode_data, obs_attr, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_obs_data_+3A_ode_data">ode_data</code></td>
<td>
<p>data frame of output from ode() function</p>
</td></tr>
<tr><td><code id="create_obs_data_+3A_obs_attr">obs_attr</code></td>
<td>
<p>&quot;obs&quot; attribute from ode() function</p>
</td></tr>
<tr><td><code id="create_obs_data_+3A_id">id</code></td>
<td>
<p>ID of the individual</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+sim">sim()</a></code>
</p>

<hr>
<h2 id='cv_to_omega'>Create lower-diagonal omega matrix from CV for parameter estimates</h2><span id='topic+cv_to_omega'></span>

<h3>Description</h3>

<p>Create lower-diagonal omega matrix from CV for parameter estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_to_omega(par_cv = NULL, parameters = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv_to_omega_+3A_par_cv">par_cv</code></td>
<td>
<p>list of parameter CVs</p>
</td></tr>
<tr><td><code id="cv_to_omega_+3A_parameters">parameters</code></td>
<td>
<p>list of parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector describing the lower triangle of the omega (between-subject variability) matrix
</p>


<h3>See Also</h3>

<p><a href="#topic+sim_ode">sim_ode</a>
</p>

<hr>
<h2 id='define_tdm_init_model'>defines C code for TDM before dose conditions</h2><span id='topic+define_tdm_init_model'></span>

<h3>Description</h3>

<p>Currently only available for 1-cmt and 2-cmt IV models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>define_tdm_init_model(def)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="define_tdm_init_model_+3A_def">def</code></td>
<td>
<p>model definition, named recursive list with at least the
objects 'misc$model_type', 'parameters' and 'variables'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>model defintion with 'state_init' object added describing how to initializing the compartments.
</p>

<hr>
<h2 id='detect_ode_syntax'>Auto-detect the syntax for the ODE code</h2><span id='topic+detect_ode_syntax'></span>

<h3>Description</h3>

<p>Either PKPDsim or RxODE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_ode_syntax(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_ode_syntax_+3A_code">code</code></td>
<td>
<p>character string with ODE code</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with elements <code>from</code> and <code>to</code> indicating the syntax for the ODE
code
</p>

<hr>
<h2 id='f_cov'>covariate function builder</h2><span id='topic+f_cov'></span>

<h3>Description</h3>

<p>covariate function builder
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f_cov(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f_cov_+3A_...">...</code></td>
<td>
<p>parameters to pass to cov</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Covariate function
</p>

<hr>
<h2 id='get_fixed_parameters'>Get fixed parameters</h2><span id='topic+get_fixed_parameters'></span>

<h3>Description</h3>

<p>Get fixed parameters listed in model definition if present. If not present, use size of omega matrix to determine fixed parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fixed_parameters(def)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_fixed_parameters_+3A_def">def</code></td>
<td>
<p>Model definition as output by <code><a href="#topic+read_model_json">read_model_json()</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='get_ode_model_size'>Get the number of states in the ODE from the code
code C++ code for model</h2><span id='topic+get_ode_model_size'></span>

<h3>Description</h3>

<p>Get the number of states in the ODE from the code
code C++ code for model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ode_model_size(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ode_model_size_+3A_code">code</code></td>
<td>
<p>C++ code</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Number of states in the ODE model
</p>

<hr>
<h2 id='get_parameters_from_code'>Get model parameters from code</h2><span id='topic+get_parameters_from_code'></span>

<h3>Description</h3>

<p>Get model parameters from code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_parameters_from_code(code, state_init, declare_variables = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_parameters_from_code_+3A_code">code</code></td>
<td>
<p>code</p>
</td></tr>
<tr><td><code id="get_parameters_from_code_+3A_state_init">state_init</code></td>
<td>
<p>state init vector</p>
</td></tr>
<tr><td><code id="get_parameters_from_code_+3A_declare_variables">declare_variables</code></td>
<td>
<p>declared variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of parameter names
</p>

<hr>
<h2 id='get_t_obs_from_regimen'>Extract sensible default observation times from a specified regimen</h2><span id='topic+get_t_obs_from_regimen'></span>

<h3>Description</h3>

<p>Extract sensible default observation times from a specified regimen
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_t_obs_from_regimen(
  regimen = NULL,
  obs_step_size = NULL,
  t_max = NULL,
  covariates = NULL,
  extra_t_obs = NULL,
  t_init = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_t_obs_from_regimen_+3A_regimen">regimen</code></td>
<td>
<p>regimen created using 'new_regimen()'</p>
</td></tr>
<tr><td><code id="get_t_obs_from_regimen_+3A_obs_step_size">obs_step_size</code></td>
<td>
<p>step size between observations. Will be auto-calculated if NULL</p>
</td></tr>
<tr><td><code id="get_t_obs_from_regimen_+3A_t_max">t_max</code></td>
<td>
<p>max time value</p>
</td></tr>
<tr><td><code id="get_t_obs_from_regimen_+3A_covariates">covariates</code></td>
<td>
<p>covariates object, created using 'list(new_covariate(), ...)'</p>
</td></tr>
<tr><td><code id="get_t_obs_from_regimen_+3A_extra_t_obs">extra_t_obs</code></td>
<td>
<p>add timepoints to t_obs at which covariate is changing ('T'/'F')</p>
</td></tr>
<tr><td><code id="get_t_obs_from_regimen_+3A_t_init">t_init</code></td>
<td>
<p>time of initiation of the ODE system. Usually 0.</p>
</td></tr>
</table>

<hr>
<h2 id='get_var_y'>Get expected variance/sd/ci of dependent variable
based on PKPDsim model, parameters, and regimen</h2><span id='topic+get_var_y'></span>

<h3>Description</h3>

<p>Get expected variance/sd/ci of dependent variable
based on PKPDsim model, parameters, and regimen
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_var_y(
  model = NULL,
  parameters = list(),
  regimen = list(),
  t_obs = c(1:48),
  obs_comp = NULL,
  obs_variable = NULL,
  omega = c(0.1, 0.05, 0.1),
  omega_full = NULL,
  n_ind = NULL,
  ruv = NULL,
  y = NULL,
  rel_delta = 1e-04,
  method = "delta",
  sequence = NULL,
  auc = FALSE,
  sd = TRUE,
  q = NULL,
  in_parallel = FALSE,
  n_cores = 3,
  return_all = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_var_y_+3A_model">model</code></td>
<td>
<p>model, created using 'PKPDsim::new_ode_model()'</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_parameters">parameters</code></td>
<td>
<p>parameters list</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_regimen">regimen</code></td>
<td>
<p>regimen, as created using 'PKPDsim::new_regimen()'</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_t_obs">t_obs</code></td>
<td>
<p>vector of observation times</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_obs_comp">obs_comp</code></td>
<td>
<p>observation compartment. If NULL will be &quot;obs&quot; (default)</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_obs_variable">obs_variable</code></td>
<td>
<p>observation variable. If NULL, will be ignored, otherwise will override 'obs_comp'.</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_omega">omega</code></td>
<td>
<p>triangle omega block</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_omega_full">omega_full</code></td>
<td>
<p>full omega block</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_n_ind">n_ind</code></td>
<td>
<p>number of individuals to simulate with sim method</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_ruv">ruv</code></td>
<td>
<p>residual variability, supplied as a named list, ex: 'list(prop = 0, add = 0, exp = 0)'</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_y">y</code></td>
<td>
<p>vector of observations. If NULL, then a new simulation will be performed.</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_rel_delta">rel_delta</code></td>
<td>
<p>rel_delta</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_method">method</code></td>
<td>
<p>method, 'delta' or 'sim'</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_sequence">sequence</code></td>
<td>
<p>for simulations, if not NULL the pseudo-random sequence to use, e.g. &quot;halton&quot; or &quot;sobol&quot;. See 'mvrnorm2' for more details.</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_auc">auc</code></td>
<td>
<p>is AUC?</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_sd">sd</code></td>
<td>
<p>return as standard deviation ('TRUE') or variance ('FALSE')</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_q">q</code></td>
<td>
<p>return vector of quantiles instead of sd/var. Will return parametric quantiles when delta-method is used, non-parametric for simulation-based methods.</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_in_parallel">in_parallel</code></td>
<td>
<p>run simulations in parallel?</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_n_cores">n_cores</code></td>
<td>
<p>if run in parallel, on how many cores?</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_return_all">return_all</code></td>
<td>
<p>return object with all relevant information?</p>
</td></tr>
<tr><td><code id="get_var_y_+3A_...">...</code></td>
<td>
<p>passed on to 'sim_ode()'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of standard deviations or variances (or quantiles thereof) for dependent value
variable
</p>

<hr>
<h2 id='ifelse0'>ifelse function but then based on whether value is NULL or not</h2><span id='topic+ifelse0'></span>

<h3>Description</h3>

<p>ifelse function but then based on whether value is NULL or not
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ifelse0(value = NULL, alternative = NULL, allow_null = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ifelse0_+3A_value">value</code></td>
<td>
<p>metadata list object</p>
</td></tr>
<tr><td><code id="ifelse0_+3A_alternative">alternative</code></td>
<td>
<p>alternative value</p>
</td></tr>
<tr><td><code id="ifelse0_+3A_allow_null">allow_null</code></td>
<td>
<p>can the alternative be NULL?</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>value</code> if non-NULL; <code>alternative</code> otherwise
</p>

<hr>
<h2 id='is_newer_package'>Check if package number is different from currently installed,
and provide some messaging.</h2><span id='topic+is_newer_package'></span>

<h3>Description</h3>

<p>Technically it only checks if a package version is different, not necessarily
a higher version number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_newer_package(package, new_version)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_newer_package_+3A_package">package</code></td>
<td>
<p>R package</p>
</td></tr>
<tr><td><code id="is_newer_package_+3A_new_version">new_version</code></td>
<td>
<p>new version number</p>
</td></tr>
</table>

<hr>
<h2 id='is_positive_definite'>Is matrix positive definite</h2><span id='topic+is_positive_definite'></span>

<h3>Description</h3>

<p>Is matrix positive definite
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_positive_definite(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_positive_definite_+3A_x">x</code></td>
<td>
<p>matrix, specified either as <code>vector</code> of lower triangle, or full matrix (as <code>matrix</code> class)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if <code>x</code> is positive definite; FALSE otherwise.
</p>

<hr>
<h2 id='join_cov_and_par'>Combines covariates and parameters into a single list, useful for reparametrization of the model.</h2><span id='topic+join_cov_and_par'></span>

<h3>Description</h3>

<p>Combines covariates and parameters into a single list, useful for reparametrization of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>join_cov_and_par(covs, pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="join_cov_and_par_+3A_covs">covs</code></td>
<td>
<p>covariates object</p>
</td></tr>
<tr><td><code id="join_cov_and_par_+3A_pars">pars</code></td>
<td>
<p>model parameters, such as the output of the 'parameters()' call frmo a model library.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing covariates and parameters
</p>

<hr>
<h2 id='join_regimen'>Join two dosing regimens</h2><span id='topic+join_regimen'></span>

<h3>Description</h3>

<p>Join two dosing regimens
</p>


<h3>Usage</h3>

<pre><code class='language-R'>join_regimen(
  regimen1 = NULL,
  regimen2 = NULL,
  interval = NULL,
  dose_update = NULL,
  t_dose_update = NULL,
  continuous = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="join_regimen_+3A_regimen1">regimen1</code></td>
<td>
<p>first regimen</p>
</td></tr>
<tr><td><code id="join_regimen_+3A_regimen2">regimen2</code></td>
<td>
<p>second regimen</p>
</td></tr>
<tr><td><code id="join_regimen_+3A_interval">interval</code></td>
<td>
<p>interval between regimen1 and regimen2 (if dose_update not specified)</p>
</td></tr>
<tr><td><code id="join_regimen_+3A_dose_update">dose_update</code></td>
<td>
<p>dose number at which to override regimen1 with regimen 2 (if interval not specified)</p>
</td></tr>
<tr><td><code id="join_regimen_+3A_t_dose_update">t_dose_update</code></td>
<td>
<p>dose time from which to update regimen</p>
</td></tr>
<tr><td><code id="join_regimen_+3A_continuous">continuous</code></td>
<td>
<p>for joining continuous infusions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Joined regimen
</p>

<hr>
<h2 id='lower_triangle_mat_size'>Size of the lower triangle of the matrix</h2><span id='topic+lower_triangle_mat_size'></span>

<h3>Description</h3>

<p>Size of the lower triangle of the matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lower_triangle_mat_size(mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lower_triangle_mat_size_+3A_mat">mat</code></td>
<td>
<p>omega matrix as a vector</p>
</td></tr>
</table>

<hr>
<h2 id='merge_regimen'>Merge two regimens together.</h2><span id='topic+merge_regimen'></span>

<h3>Description</h3>

<p>In contrast to 'join_regimen', which joins two consecutive regimens together, 'merge_regimen' merges two or
more regimens given at the same time. This can e.g. be used to define regimens for multi-drug models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_regimen(regimens)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_regimen_+3A_regimens">regimens</code></td>
<td>
<p>List of PKPDsim regimens created with 'new_regimen'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Merged regimens
</p>

<hr>
<h2 id='model_from_api'>Load model definition from API, and compile to R library</h2><span id='topic+model_from_api'></span>

<h3>Description</h3>

<p>Load model definition from API, and compile to R library
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_from_api(
  url,
  model = NULL,
  nonmem = NULL,
  verbose = TRUE,
  get_definition = FALSE,
  to_package = FALSE,
  force = FALSE,
  install_all = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_from_api_+3A_url">url</code></td>
<td>
<p>URL or file path to JSON representation of model</p>
</td></tr>
<tr><td><code id="model_from_api_+3A_model">model</code></td>
<td>
<p>model id (used in messages)</p>
</td></tr>
<tr><td><code id="model_from_api_+3A_nonmem">nonmem</code></td>
<td>
<p>URL or file path to NONMEM file</p>
</td></tr>
<tr><td><code id="model_from_api_+3A_verbose">verbose</code></td>
<td>
<p>verbosity (T/F)</p>
</td></tr>
<tr><td><code id="model_from_api_+3A_get_definition">get_definition</code></td>
<td>
<p>return only the model definition, do not compile</p>
</td></tr>
<tr><td><code id="model_from_api_+3A_to_package">to_package</code></td>
<td>
<p>compile to package?</p>
</td></tr>
<tr><td><code id="model_from_api_+3A_force">force</code></td>
<td>
<p>force install even if same version number of model already installed.</p>
</td></tr>
<tr><td><code id="model_from_api_+3A_install_all">install_all</code></td>
<td>
<p>force install all, even if model inactive</p>
</td></tr>
<tr><td><code id="model_from_api_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>new_ode_model()</code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Model object created with <code><a href="#topic+new_ode_model">new_ode_model()</a></code>
</p>

<hr>
<h2 id='model_library'>Model library</h2><span id='topic+model_library'></span>

<h3>Description</h3>

<p>Model library
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_library(name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_library_+3A_name">name</code></td>
<td>
<p>name of model in library. If none specified, will show list of available models.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing information about the named model
</p>

<hr>
<h2 id='mvrnorm2'>More powerful multivariate normal sampling function</h2><span id='topic+mvrnorm2'></span>

<h3>Description</h3>

<p>Besides standard multivariate normal sampling (mvrnorm), allows exponential
multivariate normal and quasi-random multivariate normal (using the randtoolbox)
all using the same interface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvrnorm2(n, mu, Sigma, exponential = FALSE, sequence = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvrnorm2_+3A_n">n</code></td>
<td>
<p>number of samples</p>
</td></tr>
<tr><td><code id="mvrnorm2_+3A_mu">mu</code></td>
<td>
<p>mean</p>
</td></tr>
<tr><td><code id="mvrnorm2_+3A_sigma">Sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
<tr><td><code id="mvrnorm2_+3A_exponential">exponential</code></td>
<td>
<p>exponential distribution (i.e. multiply mu by exponential of sampled numbers)</p>
</td></tr>
<tr><td><code id="mvrnorm2_+3A_sequence">sequence</code></td>
<td>
<p>any sequence available in the randtoolbox, e.g. 'halton', or 'sobol'</p>
</td></tr>
<tr><td><code id="mvrnorm2_+3A_...">...</code></td>
<td>
<p>parameters passed to mvrnorm or randtoolbox sequence generator</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Multivariate normal samples
</p>

<hr>
<h2 id='na_locf'>Fill in NAs with the previous non-missing value</h2><span id='topic+na_locf'></span>

<h3>Description</h3>

<p>Inspired by zoo::na.locf0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>na_locf(object, fromLast = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="na_locf_+3A_object">object</code></td>
<td>
<p>an object</p>
</td></tr>
<tr><td><code id="na_locf_+3A_fromlast">fromLast</code></td>
<td>
<p>logical. Causes observations to be carried backward rather
than forward. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Original object with NAs filled in
</p>

<hr>
<h2 id='new_adherence'>Probabilistically model adherence</h2><span id='topic+new_adherence'></span>

<h3>Description</h3>

<p>Model the drug adherence using either a binomial probability distribution or
a markov chain model based on the probability of staying adherent and of
becoming adherent once non-adherent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_adherence(
  n = 100,
  type = c("markov", "binomial"),
  p_markov_remain_ad = 0.75,
  p_markov_become_ad = 0.75,
  p_binom = 0.7
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_adherence_+3A_n">n</code></td>
<td>
<p>number of occasions to simulate</p>
</td></tr>
<tr><td><code id="new_adherence_+3A_type">type</code></td>
<td>
<p>type of adherence simulation, either &quot;markov&quot; or &quot;binomial&quot;</p>
</td></tr>
<tr><td><code id="new_adherence_+3A_p_markov_remain_ad">p_markov_remain_ad</code></td>
<td>
<p>markov probability of staying adherent</p>
</td></tr>
<tr><td><code id="new_adherence_+3A_p_markov_become_ad">p_markov_become_ad</code></td>
<td>
<p>markov probability of going from non-adherent
to adherent state</p>
</td></tr>
<tr><td><code id="new_adherence_+3A_p_binom">p_binom</code></td>
<td>
<p>binomial probability of being adherent</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of length 'n'
containing values 0 (non-adherent) or 1 (adherent).
</p>
<p>Numeric vector of length n
</p>

<hr>
<h2 id='new_covariate'>New covariate</h2><span id='topic+new_covariate'></span>

<h3>Description</h3>

<p>Describe data for a covariate, either fixed or time-variant
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_covariate(
  value = NULL,
  times = NULL,
  implementation = "interpolate",
  unit = NULL,
  interpolation_join_limit = 1,
  remove_negative_times = TRUE,
  round_times = NULL,
  comments = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_covariate_+3A_value">value</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
<tr><td><code id="new_covariate_+3A_times">times</code></td>
<td>
<p>NULL for time-invariant covariate or a numeric vector specifying the update times for the covariate</p>
</td></tr>
<tr><td><code id="new_covariate_+3A_implementation">implementation</code></td>
<td>
<p>for time-varying covariates either 'LOCF' (last observation carried forward) or 'interpolate' (default)</p>
</td></tr>
<tr><td><code id="new_covariate_+3A_unit">unit</code></td>
<td>
<p>specify covariate unit (optional, for documentation purposes only)</p>
</td></tr>
<tr><td><code id="new_covariate_+3A_interpolation_join_limit">interpolation_join_limit</code></td>
<td>
<p>for <code>interpolate</code> option, if covariate timepoints are spaced too close together, the ODE solver sometimes chokes. This argument sets a lower limit on the space between timepoints. It will create average values on joint timepoints instead. If undesired set to NULL or 0.</p>
</td></tr>
<tr><td><code id="new_covariate_+3A_remove_negative_times">remove_negative_times</code></td>
<td>
<p><code style="white-space: pre;">&#8288;TRUE`` or &#8288;</code>FALSE'</p>
</td></tr>
<tr><td><code id="new_covariate_+3A_round_times">round_times</code></td>
<td>
<p>round times to specified number of digits. If <code>NULL</code>, will not round.</p>
</td></tr>
<tr><td><code id="new_covariate_+3A_comments">comments</code></td>
<td>
<p><code>NULL</code>, or vector of length equal to <code>value</code> specifying comments to each observation</p>
</td></tr>
<tr><td><code id="new_covariate_+3A_verbose">verbose</code></td>
<td>
<p>verbosity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>"covariate"</code>
</p>

<hr>
<h2 id='new_covariate_model'>covariate model function</h2><span id='topic+new_covariate_model'></span>

<h3>Description</h3>

<p>covariate model function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_covariate_model(model = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_covariate_model_+3A_model">model</code></td>
<td>
<p>covariate model specified as list</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing model function(s)
</p>

<hr>
<h2 id='new_ode_model'>Create new ODE model</h2><span id='topic+new_ode_model'></span>

<h3>Description</h3>

<p>Create new ODE model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_ode_model(
  model = NULL,
  code = NULL,
  pk_code = NULL,
  dose_code = NULL,
  file = NULL,
  func = NULL,
  state_init = NULL,
  parameters = NULL,
  reparametrization = NULL,
  mixture = NULL,
  units = NULL,
  size = NULL,
  lagtime = NULL,
  obs = list(cmt = 1, scale = 1),
  dose = list(cmt = 1),
  covariates = NULL,
  declare_variables = NULL,
  iiv = NULL,
  iov = NULL,
  development = NULL,
  omega_matrix = NULL,
  ruv = NULL,
  ltbs = NULL,
  misc = NULL,
  cmt_mapping = NULL,
  int_step_size = NULL,
  default_parameters = NULL,
  fixed = NULL,
  cpp_show_code = FALSE,
  package = NULL,
  test_file = NULL,
  install = TRUE,
  folder = NULL,
  lib_location = NULL,
  verbose = FALSE,
  as_is = FALSE,
  nonmem = NULL,
  comments = NULL,
  version = "0.1.0",
  quiet = "",
  definition = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_ode_model_+3A_model">model</code></td>
<td>
<p>model name from model library</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_code">code</code></td>
<td>
<p>C++ code specifying ODE system</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_pk_code">pk_code</code></td>
<td>
<p>C++ code called at any event</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_dose_code">dose_code</code></td>
<td>
<p>C++ code called at dose event only</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_file">file</code></td>
<td>
<p>file containing C++ code</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_func">func</code></td>
<td>
<p>R function to be used with deSolve library</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_state_init">state_init</code></td>
<td>
<p>vector of state init</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_parameters">parameters</code></td>
<td>
<p>list or vector of parameter values</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_reparametrization">reparametrization</code></td>
<td>
<p>list of parameters with definitions that reparametrize the linear PK model to a 1-, 2- o4 3-compartment PK with standardized parametrization.</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_mixture">mixture</code></td>
<td>
<p>for mixture models, provide a list of the parameter associated with the mixture and it's possible values and probabilities (of the first value), e.g. 'list(CL = list(value = c(10, 20), probability = 0.3)'.</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_units">units</code></td>
<td>
<p>list or vector of parameter units</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_size">size</code></td>
<td>
<p>size of state vector for model. Size will be extracted automatically from supplied code, use this argument to override.</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_lagtime">lagtime</code></td>
<td>
<p>lag time</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_obs">obs</code></td>
<td>
<p>list with &quot;scale&quot;: character string with definition for scale, e.g. &quot;V&quot; or &quot;V*(WT/70)&quot;. If NULL, scale defaults to 1., and &quot;cmt&quot; the observation compartment</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_dose">dose</code></td>
<td>
<p>specify default dose compartment, e.g. list(cmt = 1)</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_covariates">covariates</code></td>
<td>
<p>specify covariates, either as a character vector or a list. if specified as list, it allows use of timevarying covariates (see 'new_covariate()' function for more info)</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_declare_variables">declare_variables</code></td>
<td>
<p>declare variables</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_iiv">iiv</code></td>
<td>
<p>inter-individual variability, can optionally be added to library</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_iov">iov</code></td>
<td>
<p>inter-occasion variability, can optionally be added to library</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_development">development</code></td>
<td>
<p>Information about the model development population, can optionally be added to library</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_omega_matrix">omega_matrix</code></td>
<td>
<p>variance-covariance matrix for inter-individual variability, can optionally be added to library</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_ruv">ruv</code></td>
<td>
<p>residual variability, can optionally be added to library</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_ltbs">ltbs</code></td>
<td>
<p>log-transform both sides. Not used in simulations, only for fitting (sets attribute 'ltbs').</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_misc">misc</code></td>
<td>
<p>a list of miscellaneous model metadata</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_cmt_mapping">cmt_mapping</code></td>
<td>
<p>list indicating which administration routes apply to which compartments. Example: 'list(&quot;oral&quot; = 1, &quot;infusion&quot; = 2)'</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_int_step_size">int_step_size</code></td>
<td>
<p>step size for integrator. Can be pre-specified for model, to override default for 'sim_ode()'</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_default_parameters">default_parameters</code></td>
<td>
<p>population or specific patient values, can optionally be added to library</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_fixed">fixed</code></td>
<td>
<p>parameters that should not have iiv added.</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_cpp_show_code">cpp_show_code</code></td>
<td>
<p>show generated C++ code</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_package">package</code></td>
<td>
<p>package name when saving as package</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_test_file">test_file</code></td>
<td>
<p>optional test file to be included with package</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_install">install</code></td>
<td>
<p>install package after compilation?</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_folder">folder</code></td>
<td>
<p>base folder name to create package in</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_lib_location">lib_location</code></td>
<td>
<p>install into folder ('&ndash;library' argument)</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_verbose">verbose</code></td>
<td>
<p>show more output</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_as_is">as_is</code></td>
<td>
<p>use C-code as-is, don't substitute line-endings or shift indices</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_nonmem">nonmem</code></td>
<td>
<p>add nonmem code as attribute to model object</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_comments">comments</code></td>
<td>
<p>comments for model</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_version">version</code></td>
<td>
<p>number of library</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_quiet">quiet</code></td>
<td>
<p>passed on to 'system2' as setting for stderr and stdout; how to
output cmd line output. Default ('&quot;&quot;') is R console, NULL or FALSE discards.
TRUE captures the output and saves as a file.</p>
</td></tr>
<tr><td><code id="new_ode_model_+3A_definition">definition</code></td>
<td>
<p>optional, filename for the JSON file the full definition
for the model. The definition file will be stored as 'definition.json' in the
resulting package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If package name is NULL, returns the model object. Otherwise has no
return value.
</p>

<hr>
<h2 id='new_regimen'>Dose regimen for sim_ode</h2><span id='topic+new_regimen'></span>

<h3>Description</h3>

<p>Create a dosing regimen for use with sim_ode
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_regimen(
  amt = 100,
  interval = NULL,
  n = 3,
  times = NULL,
  type = NULL,
  t_inf = NULL,
  rate = NULL,
  t_lag = NULL,
  cmt = NULL,
  checks = TRUE,
  ss = FALSE,
  n_ss = NULL,
  first_dose_time = now_utc()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_regimen_+3A_amt">amt</code></td>
<td>
<p>dosing amount, either a single value (which will repeated for multiple doses), or a vector with doses for each administration</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_interval">interval</code></td>
<td>
<p>dosing interval (requires n as argument)</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_n">n</code></td>
<td>
<p>number of doses (requires interval as argument)</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_times">times</code></td>
<td>
<p>vector describing dosing times. Overrides specified times using interval and n arguments</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_type">type</code></td>
<td>
<p>either &quot;infusion&quot;, &quot;bolus&quot;, &quot;oral&quot;, &quot;sc&quot; (subcutaneous), or &quot;im&quot; (intramuscular).</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_t_inf">t_inf</code></td>
<td>
<p>infusion time (if 'type'=='infusion')</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_rate">rate</code></td>
<td>
<p>infusion rate (if 'type'=='infusion'). 'NULL' by default. If specified, overrides 't_inf'</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_t_lag">t_lag</code></td>
<td>
<p>lag time (can be applied to any dose type, not only oral). Will just be added to 'times'</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_cmt">cmt</code></td>
<td>
<p>vector of dosing compartments (optional, if NULL will dosing compartment defined in model will be used)</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_checks">checks</code></td>
<td>
<p>input checks. Remove to increase speed (e.g. for population-level estimation or optimal design)</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_ss">ss</code></td>
<td>
<p>steady state? boolean value whether to simulate out to steady state first (steady state will be based on specified 'amt' and 'interval', 'times' will be ignored).</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_n_ss">n_ss</code></td>
<td>
<p>how many doses to simulate before assumed steady state. Default is 4 * 24 / 'interval'.</p>
</td></tr>
<tr><td><code id="new_regimen_+3A_first_dose_time">first_dose_time</code></td>
<td>
<p>datetime stamp of first dose (of class 'POSIXct'). Default is current date time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing calculated VPC information, and a ggplot2 object
</p>


<h3>See Also</h3>

<p><a href="#topic+sim_ode">sim_ode</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
r1 &lt;- new_regimen(amt=50, interval=12, n=20) # dose 50mg, q12hrs for 10 days
r2 &lt;- new_regimen(amt=50, times=c(0:19)*12)  # same, but using explicit times
r3 &lt;- new_regimen(amt=c(rep(100,4), rep(50,16)), times=c(0:19)*12)  # first 4 doses higher dose
</code></pre>

<hr>
<h2 id='nlmixr_parse_parameters'>Function to parse parameters for a model into a structure used by nlmixr</h2><span id='topic+nlmixr_parse_parameters'></span>

<h3>Description</h3>

<p>Function to parse parameters for a model into a structure used by nlmixr
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlmixr_parse_parameters(
  parameters = list(CL = 5, V = 50),
  omega = c(0.1, 0.05, 0.1),
  res_var = list(prop = 0.1, add = 1),
  fixed = c(),
  log_transform = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nlmixr_parse_parameters_+3A_parameters">parameters</code></td>
<td>
<p>list of parameters</p>
</td></tr>
<tr><td><code id="nlmixr_parse_parameters_+3A_omega">omega</code></td>
<td>
<p>vector describing the lower-diagonal of the between-subject variability matrix</p>
</td></tr>
<tr><td><code id="nlmixr_parse_parameters_+3A_res_var">res_var</code></td>
<td>
<p>residual variability. Expected a list with arguments 'prop', 'add', and/or 'exp'. NULL by default.</p>
</td></tr>
<tr><td><code id="nlmixr_parse_parameters_+3A_fixed">fixed</code></td>
<td>
<p>vector of fixed parameters</p>
</td></tr>
<tr><td><code id="nlmixr_parse_parameters_+3A_log_transform">log_transform</code></td>
<td>
<p>log-transform estimated parameters in nlmixr?</p>
</td></tr>
<tr><td><code id="nlmixr_parse_parameters_+3A_...">...</code></td>
<td>
<p>passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of parameters that can be used by nlmixr
</p>

<hr>
<h2 id='nm_to_regimen'>Create a regimen from NONMEM data</h2><span id='topic+nm_to_regimen'></span>

<h3>Description</h3>

<p>Create a regimen based on a NONMEM, or NONMEM-like dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nm_to_regimen(data, reset_time = TRUE, first_only = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nm_to_regimen_+3A_data">data</code></td>
<td>
<p>NONMEM-type dataset</p>
</td></tr>
<tr><td><code id="nm_to_regimen_+3A_reset_time">reset_time</code></td>
<td>
<p>start time for each simulated patient at 0, irrespective of design in dataset</p>
</td></tr>
<tr><td><code id="nm_to_regimen_+3A_first_only">first_only</code></td>
<td>
<p>use only design from first individual in dataset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Regimen object
</p>

<hr>
<h2 id='now_utc'>Current time in UTC</h2><span id='topic+now_utc'></span>

<h3>Description</h3>

<p>Current time in UTC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>now_utc()
</code></pre>


<h3>Value</h3>

<p>POSIXct object containing current time in UTC
</p>

<hr>
<h2 id='OneCompIVbolus'>ADVAN-style equations</h2><span id='topic+OneCompIVbolus'></span>

<h3>Description</h3>

<p>Adapted from Abuhelwa et al. JPET 2015
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OneCompIVbolus(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OneCompIVbolus_+3A_d">d</code></td>
<td>
<p>data, a NONMEM style data frame for 1 subject with columns for TIME,
AMT, MDV, DV, CL, V</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions for calculating drug amount in each compartments of the
common pharmacokinetic models (1,2,3 compartment IV bolus, IV infusion,
and first-order absorption models)
</p>
<p>Definitions:
- A*last: is the initial amount at the beginning of each time interval (t, t=t2-t1)
of a corresponding compartment (i.e. drug amount at the end of the last time interval)
- E* : the sum of Exit (elimination) rate constant of the corresponding compartment.
IV bolus- 1 compartment
</p>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, and DV
</p>


<h3>References</h3>

<p>Abuhelwa, A. Y., Foster, D. J. R., Upton, R. N. (2015)
ADVAN-style analytical solutions for common pharmacokinetic models. J
Pharmacol Toxicol Methods 73:42-8. DOI: 10.1016/j.vascn.2015.03.004
</p>

<hr>
<h2 id='OneCompIVinfusion'>IV infusion- 1 compartment</h2><span id='topic+OneCompIVinfusion'></span>

<h3>Description</h3>

<p>IV infusion- 1 compartment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OneCompIVinfusion(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OneCompIVinfusion_+3A_d">d</code></td>
<td>
<p>data, accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV, RATE, RATEALL, DV, CL, V</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, and DV
</p>

<hr>
<h2 id='OneCompOral'>first-order absorption 1 compartment</h2><span id='topic+OneCompOral'></span>

<h3>Description</h3>

<p>first-order absorption 1 compartment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OneCompOral(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OneCompOral_+3A_d">d</code></td>
<td>
<p>data, accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV,DV, CL, V, KA &amp; F1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, A2 and DV
</p>

<hr>
<h2 id='parse_obs_types'>Parse observation types to simulation code</h2><span id='topic+parse_obs_types'></span>

<h3>Description</h3>

<p>Parse observation types to simulation code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_obs_types(obs, initial = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_obs_types_+3A_obs">obs</code></td>
<td>
<p>specified observation object including at least a description of
which variable(s) are associated with a particular compartment, e.g.
'list(variable=&quot;CONC&quot;, scale=&quot;1&quot;)'.</p>
</td></tr>
<tr><td><code id="parse_obs_types_+3A_initial">initial</code></td>
<td>
<p>is this for the initial code block in the C++ template that
initializes the variables and compartments ('TRUE'), or for the
second code block used for the rest of the dataset?</p>
</td></tr>
</table>

<hr>
<h2 id='pkdata'>PK dataset</h2><span id='topic+pkdata'></span>

<h3>Description</h3>

<p>Example PK dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkdata
</code></pre>


<h3>Format</h3>

<p>A data frame with 624 rows and 12 variables in NONMEM format
</p>

<hr>
<h2 id='pkpdsim_to_nlmixr'>Convert a model generated with PKPDsim to an object for nlmixr</h2><span id='topic+pkpdsim_to_nlmixr'></span>

<h3>Description</h3>

<p>Convert a model generated with PKPDsim to an object for nlmixr
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkpdsim_to_nlmixr(
  model = NULL,
  parameters = NULL,
  omega = NULL,
  res_var = NULL,
  fixed = c(),
  ini_code = NULL,
  model_code = NULL,
  model_par_code = NULL,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_model">model</code></td>
<td>
<p>PKPDsim model</p>
</td></tr>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_parameters">parameters</code></td>
<td>
<p>list of parameters</p>
</td></tr>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_omega">omega</code></td>
<td>
<p>vector describing the lower-diagonal of the between-subject variability matrix</p>
</td></tr>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_res_var">res_var</code></td>
<td>
<p>residual variability. Expected a list with arguments 'prop', 'add', and/or 'exp'. NULL by default.</p>
</td></tr>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_fixed">fixed</code></td>
<td>
<p>vector of fixed (not estimated) parameter names</p>
</td></tr>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_ini_code">ini_code</code></td>
<td>
<p>manually specify the 'ini' block for nlmixr</p>
</td></tr>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_model_code">model_code</code></td>
<td>
<p>manually specify the 'model' block for nlmixr</p>
</td></tr>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_model_par_code">model_par_code</code></td>
<td>
<p>manually specify the parameters section inside the 'model' block for nlmixr</p>
</td></tr>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_verbose">verbose</code></td>
<td>
<p>verbose, 'TRUE' or 'FALSE'</p>
</td></tr>
<tr><td><code id="pkpdsim_to_nlmixr_+3A_...">...</code></td>
<td>
<p>passed on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nlmixr function
</p>

<hr>
<h2 id='pop_regimen'>Remove n doses (from tail) of PKPDsim regimen</h2><span id='topic+pop_regimen'></span>

<h3>Description</h3>

<p>Opposite of shift_regimen()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pop_regimen(regimen, n = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pop_regimen_+3A_regimen">regimen</code></td>
<td>
<p>PKPDsim regimen created using 'new_regimen()'</p>
</td></tr>
<tr><td><code id="pop_regimen_+3A_n">n</code></td>
<td>
<p>number of doses to pop from regimen</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Input regiment minus selected number of doses
</p>


<h3>See Also</h3>

<p>shift_regimen
</p>

<hr>
<h2 id='print_list'>Return a list in R syntax</h2><span id='topic+print_list'></span>

<h3>Description</h3>

<p>Return a list in R syntax
</p>


<h3>Usage</h3>

<pre><code class='language-R'>print_list(x, wrapper = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_list_+3A_x">x</code></td>
<td>
<p>list to be printed</p>
</td></tr>
<tr><td><code id="print_list_+3A_wrapper">wrapper</code></td>
<td>
<p>wrap in list object?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Original list in R syntax
</p>

<hr>
<h2 id='print.covariate'>Print function for PKPDsim covariate object</h2><span id='topic+print.covariate'></span>

<h3>Description</h3>

<p>Print function for PKPDsim covariate object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'covariate'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.covariate_+3A_x">x</code></td>
<td>
<p>covariate object</p>
</td></tr>
<tr><td><code id="print.covariate_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, print function.
</p>

<hr>
<h2 id='print.PKPDsim'>Print function for PKPDsim simulation function</h2><span id='topic+print.PKPDsim'></span>

<h3>Description</h3>

<p>Print function for PKPDsim simulation function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PKPDsim'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.PKPDsim_+3A_x">x</code></td>
<td>
<p>function</p>
</td></tr>
<tr><td><code id="print.PKPDsim_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, print function.
</p>

<hr>
<h2 id='print.regimen'>Print function for PKPDsim regimen</h2><span id='topic+print.regimen'></span>

<h3>Description</h3>

<p>Print function for PKPDsim regimen
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regimen'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.regimen_+3A_x">x</code></td>
<td>
<p>regimen</p>
</td></tr>
<tr><td><code id="print.regimen_+3A_...">...</code></td>
<td>
<p>arguments to pass</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, print function.
</p>

<hr>
<h2 id='read_model_json'>Read model definition from JSON</h2><span id='topic+read_model_json'></span>

<h3>Description</h3>

<p>Does some substitution of escaped characters in strings in the JSON file,
then converts to a list with <code><a href="jsonlite.html#topic+fromJSON">jsonlite::fromJSON()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_model_json(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_model_json_+3A_path">path</code></td>
<td>
<p>Path to JSON file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing contents of original JSON file
</p>

<hr>
<h2 id='regimen_to_nm'>Convert PKPDsim regimen to NONMEM table (doses only)</h2><span id='topic+regimen_to_nm'></span>

<h3>Description</h3>

<p>Convert PKPDsim regimen to NONMEM table (doses only)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regimen_to_nm(reg = NULL, dose_cmt = 1, n_ind = 1, t_obs = NULL, obs_cmt = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="regimen_to_nm_+3A_reg">reg</code></td>
<td>
<p>'PKPDsim' regimen, created using 'new_regimen()' function</p>
</td></tr>
<tr><td><code id="regimen_to_nm_+3A_dose_cmt">dose_cmt</code></td>
<td>
<p>dosing compartment, if not specified in 'reg' object</p>
</td></tr>
<tr><td><code id="regimen_to_nm_+3A_n_ind">n_ind</code></td>
<td>
<p>repeat for 'n_ind' subjects</p>
</td></tr>
<tr><td><code id="regimen_to_nm_+3A_t_obs">t_obs</code></td>
<td>
<p>add observation time(s)</p>
</td></tr>
<tr><td><code id="regimen_to_nm_+3A_obs_cmt">obs_cmt</code></td>
<td>
<p>observation compartment for added observation time(s)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing doses
</p>

<hr>
<h2 id='reparametrize'>Reparametrize model parameters using a reparametrization defined within the model.</h2><span id='topic+reparametrize'></span>

<h3>Description</h3>

<p>Mostly useful for reparametrizing models into standard parametrizations, e.g. to
NONMEM TRANS or clinPK parametrizations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reparametrize(model, parameters, covariates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reparametrize_+3A_model">model</code></td>
<td>
<p>PKPDsim model, compiled using 'reparametrization' argument or in metadata object.</p>
</td></tr>
<tr><td><code id="reparametrize_+3A_parameters">parameters</code></td>
<td>
<p>list of model parameters</p>
</td></tr>
<tr><td><code id="reparametrize_+3A_covariates">covariates</code></td>
<td>
<p>covariates list, specified as PKPDsim covariates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Reparameterized model parameters
</p>

<hr>
<h2 id='search_replace_in_file'>Find string and replace in file</h2><span id='topic+search_replace_in_file'></span>

<h3>Description</h3>

<p>Find string and replace in file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>search_replace_in_file(files = c(), find = NULL, replacement = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="search_replace_in_file_+3A_files">files</code></td>
<td>
<p>vector of files</p>
</td></tr>
<tr><td><code id="search_replace_in_file_+3A_find">find</code></td>
<td>
<p>find what string, vector of character</p>
</td></tr>
<tr><td><code id="search_replace_in_file_+3A_replacement">replacement</code></td>
<td>
<p>replace with what, vector of character, should be equal in length to 'find'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function does not return a value but edits files on disk
</p>

<hr>
<h2 id='shift_regimen'>Remove n doses (from start) of PKPDsim regimen</h2><span id='topic+shift_regimen'></span>

<h3>Description</h3>

<p>Opposite of pop_regimen()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shift_regimen(regimen, n = 1, reset_time = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shift_regimen_+3A_regimen">regimen</code></td>
<td>
<p>PKPDsim regimen created using 'new_regimen()'</p>
</td></tr>
<tr><td><code id="shift_regimen_+3A_n">n</code></td>
<td>
<p>number of doses to shift regimen</p>
</td></tr>
<tr><td><code id="shift_regimen_+3A_reset_time">reset_time</code></td>
<td>
<p>reset the remaining doses to start at t=0?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Regimen with selected number of doses removed from start
</p>


<h3>See Also</h3>

<p>pop_regimen
</p>

<hr>
<h2 id='shift_state_indices'>R starts counting vector indices at 1, c++ starts at 0,
so reduce all state numbers in the Cpp function definition by 1</h2><span id='topic+shift_state_indices'></span>

<h3>Description</h3>

<p>R starts counting vector indices at 1, c++ starts at 0,
so reduce all state numbers in the Cpp function definition by 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shift_state_indices(ode_def, n = -1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shift_state_indices_+3A_ode_def">ode_def</code></td>
<td>
<p>ODE definition</p>
</td></tr>
<tr><td><code id="shift_state_indices_+3A_n">n</code></td>
<td>
<p>add/subtract what number, default = -1</p>
</td></tr>
</table>

<hr>
<h2 id='sim'>Simulate ODE or analytical equation</h2><span id='topic+sim'></span>

<h3>Description</h3>

<p>Simulates a specified regimen using ODE system or analytical equation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim(
  ode = NULL,
  analytical = NULL,
  parameters = NULL,
  parameters_table = NULL,
  mixture_group = NULL,
  omega = NULL,
  omega_type = "exponential",
  res_var = NULL,
  iov_bins = NULL,
  seed = NULL,
  sequence = NULL,
  n_ind = 1,
  event_table = NULL,
  regimen = NULL,
  lagtime = NULL,
  covariates = NULL,
  covariates_table = NULL,
  covariates_implementation = list(),
  covariate_model = NULL,
  A_init = NULL,
  only_obs = FALSE,
  obs_step_size = NULL,
  int_step_size = 0.01,
  t_max = NULL,
  t_obs = NULL,
  t_tte = NULL,
  t_init = 0,
  obs_type = NULL,
  duplicate_t_obs = FALSE,
  extra_t_obs = TRUE,
  rtte = FALSE,
  checks = TRUE,
  verbose = FALSE,
  return_event_table = FALSE,
  return_design = FALSE,
  output_include = list(parameters = FALSE, covariates = FALSE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_+3A_ode">ode</code></td>
<td>
<p>function describing the ODE system</p>
</td></tr>
<tr><td><code id="sim_+3A_analytical">analytical</code></td>
<td>
<p>string specifying analytical equation model to use (similar to ADVAN1-5 in NONMEM). If specified, will not use ODEs.</p>
</td></tr>
<tr><td><code id="sim_+3A_parameters">parameters</code></td>
<td>
<p>model parameters</p>
</td></tr>
<tr><td><code id="sim_+3A_parameters_table">parameters_table</code></td>
<td>
<p>dataframe of parameters (with parameters as columns) containing parameter estimates for individuals to simulate. Formats accepted: data.frame, data.table, or list of lists.</p>
</td></tr>
<tr><td><code id="sim_+3A_mixture_group">mixture_group</code></td>
<td>
<p>mixture group for models containing mixtures. Should be either '1' or '2', since only two groups are currently allowed.</p>
</td></tr>
<tr><td><code id="sim_+3A_omega">omega</code></td>
<td>
<p>vector describing the lower-diagonal of the between-subject variability matrix</p>
</td></tr>
<tr><td><code id="sim_+3A_omega_type">omega_type</code></td>
<td>
<p>exponential or normal, specified as vector</p>
</td></tr>
<tr><td><code id="sim_+3A_res_var">res_var</code></td>
<td>
<p>residual variability. Expected a list with arguments 'prop', 'add', and/or 'exp'. NULL by default.</p>
</td></tr>
<tr><td><code id="sim_+3A_iov_bins">iov_bins</code></td>
<td>
<p>allow override of the default IOV bins for a model. Specified as a vector of timepoints specifying the bin separators, e.g. 'iov_bins = c(0, 24, 48, 72, 9999)'.</p>
</td></tr>
<tr><td><code id="sim_+3A_seed">seed</code></td>
<td>
<p>set seed for reproducible results</p>
</td></tr>
<tr><td><code id="sim_+3A_sequence">sequence</code></td>
<td>
<p>if not NULL specifies the pseudo-random sequence to use, e.g. &quot;halton&quot; or &quot;sobol&quot;. See 'mvrnorm2' for more details.</p>
</td></tr>
<tr><td><code id="sim_+3A_n_ind">n_ind</code></td>
<td>
<p>number of individuals to simulate</p>
</td></tr>
<tr><td><code id="sim_+3A_event_table">event_table</code></td>
<td>
<p>use a previously created 'design' object used for ODE simulation instead of calling create_event_table() to create a new one. Especially useful for repeated calling of sim(), such as in optimizations or optimal design analysis. Also see 'sim_core()' for even faster simulations using precalculated 'design' objects.</p>
</td></tr>
<tr><td><code id="sim_+3A_regimen">regimen</code></td>
<td>
<p>a regimen object created using the regimen() function</p>
</td></tr>
<tr><td><code id="sim_+3A_lagtime">lagtime</code></td>
<td>
<p>either a value (numeric) or a parameter (character) or NULL.</p>
</td></tr>
<tr><td><code id="sim_+3A_covariates">covariates</code></td>
<td>
<p>list of covariates (for single individual) created using 'new_covariate()' function</p>
</td></tr>
<tr><td><code id="sim_+3A_covariates_table">covariates_table</code></td>
<td>
<p>data.frame (or unnamed list of named lists per individual) with covariate values</p>
</td></tr>
<tr><td><code id="sim_+3A_covariates_implementation">covariates_implementation</code></td>
<td>
<p>used only for 'covariates_table', a named list of covariate implementation methods per covariate, e.g. 'list(WT = &quot;interpolate&quot;, BIN = &quot;locf&quot;)'</p>
</td></tr>
<tr><td><code id="sim_+3A_covariate_model">covariate_model</code></td>
<td>
<p>R code used to pre-calculate effective parameters for use in ADVAN-style analytical equations. Not used in ODE simulations.</p>
</td></tr>
<tr><td><code id="sim_+3A_a_init">A_init</code></td>
<td>
<p>vector with the initial state of the ODE system</p>
</td></tr>
<tr><td><code id="sim_+3A_only_obs">only_obs</code></td>
<td>
<p>only return the observations</p>
</td></tr>
<tr><td><code id="sim_+3A_obs_step_size">obs_step_size</code></td>
<td>
<p>the step size between the observations</p>
</td></tr>
<tr><td><code id="sim_+3A_int_step_size">int_step_size</code></td>
<td>
<p>the step size for the numerical integrator</p>
</td></tr>
<tr><td><code id="sim_+3A_t_max">t_max</code></td>
<td>
<p>maximum simulation time, if not specified will pick the end of the regimen as maximum</p>
</td></tr>
<tr><td><code id="sim_+3A_t_obs">t_obs</code></td>
<td>
<p>vector of observation times, only output these values (only used when t_obs==NULL)</p>
</td></tr>
<tr><td><code id="sim_+3A_t_tte">t_tte</code></td>
<td>
<p>vector of observation times for time-to-event simulation</p>
</td></tr>
<tr><td><code id="sim_+3A_t_init">t_init</code></td>
<td>
<p>initialization time before first dose, default 0.</p>
</td></tr>
<tr><td><code id="sim_+3A_obs_type">obs_type</code></td>
<td>
<p>vector of observation types. Only valid in combination with equal length vector 't_obs'.</p>
</td></tr>
<tr><td><code id="sim_+3A_duplicate_t_obs">duplicate_t_obs</code></td>
<td>
<p>allow duplicate t_obs in output? E.g. for optimal design calculations when t_obs = c(0,1,2,2,3). Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim_+3A_extra_t_obs">extra_t_obs</code></td>
<td>
<p>include extra t_obs in output for bolus doses? This is only activated when 't_obs' is not specified manually. E.g. for a bolus dose at t=24, if FALSE, PKPDsim will output only the trough, so for bolus doses you might want to switch this setting to TRUE. When set to &quot;auto&quot; (default), it will be TRUE by default, but will switch to FALSE whenever 't_obs' is specified manually.</p>
</td></tr>
<tr><td><code id="sim_+3A_rtte">rtte</code></td>
<td>
<p>should repeated events be allowed (FALSE by default)</p>
</td></tr>
<tr><td><code id="sim_+3A_checks">checks</code></td>
<td>
<p>perform input checks? Default is TRUE. For calculations where sim_ode is invoked many times (e.g. population estimation, optimal design) it makes sense to switch this to FALSE (after confirming the input is correct) to improve speed.</p>
</td></tr>
<tr><td><code id="sim_+3A_verbose">verbose</code></td>
<td>
<p>show more output</p>
</td></tr>
<tr><td><code id="sim_+3A_return_event_table">return_event_table</code></td>
<td>
<p>return the event table for the simulation only, does not run the actual simulation. Useful for iterative use of sim().</p>
</td></tr>
<tr><td><code id="sim_+3A_return_design">return_design</code></td>
<td>
<p>returns the design (event table and several other details) for the simulation, does not run the actual simulation. Useful for iterative functions like estimation in combination with 'sim_core()', e.g. for estimation and optimal design.</p>
</td></tr>
<tr><td><code id="sim_+3A_output_include">output_include</code></td>
<td>
<p>list specifying what to include in output table, with keys 'parameters' and 'covariates'. Both are FALSE by default.</p>
</td></tr>
<tr><td><code id="sim_+3A_...">...</code></td>
<td>
<p>extra parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame of compartments with associated concentrations at requested times
</p>
<p>Simulated regimen
</p>


<h3>See Also</h3>

<p><a href="#topic+sim_ode_shiny">sim_ode_shiny</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p &lt;- list(
  CL = 38.48,
  V  = 7.4,
  Q  = 7.844,
  V2 = 5.19,
  Q2  = 9.324,
  V3 = 111
)

omega &lt;- c(0.3,       # IIV CL
           0.1, 0.3)  # IIV V

r1 &lt;- new_regimen(
  amt = 100,
  times = c(0, 24, 36),
  type = "infusion"
)

mod &lt;- new_ode_model("pk_3cmt_iv")
dat &lt;- sim(
  ode = mod,
  parameters = p,
  omega = omega,
  n_ind = 20,
  regimen = r1
)

</code></pre>

<hr>
<h2 id='sim_core'>Only core function of the simulation function, always just returns observations.
Mostly useful for estimations / optimal design. Has no checks (for speed)!</h2><span id='topic+sim_core'></span>

<h3>Description</h3>

<p>Only core function of the simulation function, always just returns observations.
Mostly useful for estimations / optimal design. Has no checks (for speed)!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_core(sim_object = NULL, ode, duplicate_t_obs = FALSE, t_init = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_core_+3A_sim_object">sim_object</code></td>
<td>
<p>list with design and simulation parameters</p>
</td></tr>
<tr><td><code id="sim_core_+3A_ode">ode</code></td>
<td>
<p>ode</p>
</td></tr>
<tr><td><code id="sim_core_+3A_duplicate_t_obs">duplicate_t_obs</code></td>
<td>
<p>allow duplicate t_obs in output? E.g. for optimal design calculations when t_obs = c(0,1,2,2,3). Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim_core_+3A_t_init">t_init</code></td>
<td>
<p>time of initization of the ODE system. Usually 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with simulation results
</p>

<hr>
<h2 id='sim_ode'>Deprecated function, renamed to <code>sim()</code></h2><span id='topic+sim_ode'></span>

<h3>Description</h3>

<p>Deprecated function, renamed to <code>sim()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_ode(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_ode_+3A_...">...</code></td>
<td>
<p>parameters passed to <code>sim()</code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output from <code><a href="#topic+sim">sim()</a></code>
</p>


<h3>See Also</h3>

<p>sim
</p>

<hr>
<h2 id='sim_ode_shiny'>Simulate ODE and create a Shiny app</h2><span id='topic+sim_ode_shiny'></span>

<h3>Description</h3>

<p>This function has been deprecated and moved to a separate package at
https://github.com/ronkeizer/PKPDsimshiny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_ode_shiny(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_ode_shiny_+3A_...">...</code></td>
<td>
<p>arguments passed to PKPDsimShiny::sim_ode_shiny()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>


<h3>See Also</h3>

<p><a href="#topic+sim_ode">sim_ode</a>
</p>

<hr>
<h2 id='table_to_list'>Convert a table to a list</h2><span id='topic+table_to_list'></span>

<h3>Description</h3>

<p>Convert a table to a list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>table_to_list(table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="table_to_list_+3A_table">table</code></td>
<td>
<p>data.frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing original table contents
</p>

<hr>
<h2 id='test_model'>Test a model</h2><span id='topic+test_model'></span>

<h3>Description</h3>

<p>Test a model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_model(url, test_file, package, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_model_+3A_url">url</code></td>
<td>
<p>URL or file path to JSON representation of model</p>
</td></tr>
<tr><td><code id="test_model_+3A_test_file">test_file</code></td>
<td>
<p>Path to a .R file containing tests to run</p>
</td></tr>
<tr><td><code id="test_model_+3A_package">package</code></td>
<td>
<p>Package name</p>
</td></tr>
<tr><td><code id="test_model_+3A_force">force</code></td>
<td>
<p>Run tests even if model is not flagged for building? Defaults to
FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Runs test file for a model but does not return a value
</p>

<hr>
<h2 id='test_pointer'>Test if model still in memory</h2><span id='topic+test_pointer'></span>

<h3>Description</h3>

<p>Test if model still in memory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_pointer(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_pointer_+3A_model">model</code></td>
<td>
<p>pointer to model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value
</p>

<hr>
<h2 id='ThreeCompIVbolus'>IV bolus- 3 compartment</h2><span id='topic+ThreeCompIVbolus'></span>

<h3>Description</h3>

<p>IV bolus- 3 compartment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ThreeCompIVbolus(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ThreeCompIVbolus_+3A_d">d</code></td>
<td>
<p>data, Accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV,DV, CL, V1, Q12, V2, Q13, V3</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, A2, A3,and DV
</p>

<hr>
<h2 id='ThreeCompIVinfusion'>IV infusion- 3 compartment</h2><span id='topic+ThreeCompIVinfusion'></span>

<h3>Description</h3>

<p>IV infusion- 3 compartment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ThreeCompIVinfusion(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ThreeCompIVinfusion_+3A_d">d</code></td>
<td>
<p>data, Accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV,RATE, RATEALL, DV, CL, V1, Q12, V2, Q13, V3</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, A2, A3,and DV
</p>

<hr>
<h2 id='ThreeCompIVinfusionMetab'>3-compartment IV infusion with first-order metabolite formation</h2><span id='topic+ThreeCompIVinfusionMetab'></span>

<h3>Description</h3>

<p>3-compartment IV infusion with first-order metabolite formation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ThreeCompIVinfusionMetab(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ThreeCompIVinfusionMetab_+3A_d">d</code></td>
<td>
<p>data, accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV,RATE, RATEALL, DV, CL, V1, Q12, V2, Q13, V3, CLM,VM,km</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, A2, A3,and DV
</p>

<hr>
<h2 id='ThreeCompOral'>first-order absorption- 3 compartment</h2><span id='topic+ThreeCompOral'></span>

<h3>Description</h3>

<p>first-order absorption- 3 compartment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ThreeCompOral(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ThreeCompOral_+3A_d">d</code></td>
<td>
<p>data, accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV,DV, CL, V2, Q3, V3, Q4, V4, KA &amp; F1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, A2, A3, A4 and DV
</p>

<hr>
<h2 id='ThreeCompOralMetab'>first-order absorption- 3 compartment-Metabolite</h2><span id='topic+ThreeCompOralMetab'></span>

<h3>Description</h3>

<p>first-order absorption- 3 compartment-Metabolite
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ThreeCompOralMetab(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ThreeCompOralMetab_+3A_d">d</code></td>
<td>
<p>data, accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV,DV, CL, V2, Q3, V3, Q4, V4, KA &amp; F1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, A2, A3, A4 and DV
</p>

<hr>
<h2 id='translate_ode'>Translate a model from/to various PKPD simulators</h2><span id='topic+translate_ode'></span>

<h3>Description</h3>

<p>Currently only supports PKDPsim &lt;&ndash;&gt; RxODE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>translate_ode(code, auto = TRUE, from = NULL, to = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="translate_ode_+3A_code">code</code></td>
<td>
<p>character string with ODE code</p>
</td></tr>
<tr><td><code id="translate_ode_+3A_auto">auto</code></td>
<td>
<p>is auto-detect syntax ('from')</p>
</td></tr>
<tr><td><code id="translate_ode_+3A_from">from</code></td>
<td>
<p>from syntax</p>
</td></tr>
<tr><td><code id="translate_ode_+3A_to">to</code></td>
<td>
<p>to syntax</p>
</td></tr>
<tr><td><code id="translate_ode_+3A_verbose">verbose</code></td>
<td>
<p>verbose, 'TRUE' or 'FALSE'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Translated PKPDsim or RxODE model
</p>

<hr>
<h2 id='triangle_to_full'>Convert triangle omega matrix to full omega matrix</h2><span id='topic+triangle_to_full'></span>

<h3>Description</h3>

<p>Convert triangle omega matrix to full omega matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>triangle_to_full(vect)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triangle_to_full_+3A_vect">vect</code></td>
<td>
<p>vector specifying triangle omega matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Omega matrix
</p>

<hr>
<h2 id='TwoCompIVbolus'>IV bolus- 2 compartment</h2><span id='topic+TwoCompIVbolus'></span>

<h3>Description</h3>

<p>IV bolus- 2 compartment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TwoCompIVbolus(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TwoCompIVbolus_+3A_d">d</code></td>
<td>
<p>data, accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV, DV, CL, V1, Q, V2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, A2, and DV
</p>

<hr>
<h2 id='TwoCompIVinfusion'>IV infusion- 2 compartment</h2><span id='topic+TwoCompIVinfusion'></span>

<h3>Description</h3>

<p>IV infusion- 2 compartment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TwoCompIVinfusion(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TwoCompIVinfusion_+3A_d">d</code></td>
<td>
<p>data, accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV, RATE, RATEALL, DV, CL, V1, Q, V2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, A2, and DV
</p>

<hr>
<h2 id='TwoCompOral'>First-order absorption- 2 compartment</h2><span id='topic+TwoCompOral'></span>

<h3>Description</h3>

<p>First-order absorption- 2 compartment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TwoCompOral(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TwoCompOral_+3A_d">d</code></td>
<td>
<p>data, accepts a NONMEM style data frame for 1 subject with columns for TIME, AMT,MDV,DV, CL, V2, Q, V3, KA &amp; F1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe with populated columns for A1, A2, A3 and DV
</p>

<hr>
<h2 id='vector_to_R_code'>Transform a vector into a string that evaluates to the same vector</h2><span id='topic+vector_to_R_code'></span>

<h3>Description</h3>

<p>Collapses a vector into a comma-separated list with strings quoted
(and special characters escaped). A general purpose helper function
for writing new model code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vector_to_R_code(vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vector_to_R_code_+3A_vec">vec</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character string of length 1
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
