<!DOCTYPE html><html><head><title>Help for package decon</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {decon}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bw.dboot1'><p>A bootstrap bandwidth selection without resampling</p></a></li>
<li><a href='#bw.dboot2'><p>A bootstrap bandwidth selection with resampling</p></a></li>
<li><a href='#bw.dmise'><p>The MISE based plug-in bandwidth selection</p></a></li>
<li><a href='#bw.dnrd'><p>A rule of thumb bandwidth selection in denconvolution problems</p></a></li>
<li><a href='#DeconCdf'><p>Estimating cumulative distribution function from data with measurement error</p></a></li>
<li><a href='#DeconCPdf'><p>Estimating conditional probability density function from data with measurement error</p></a></li>
<li><a href='#DeconNpr'><p>Perform nonparametric regression with errors-in-variables</p></a></li>
<li><a href='#DeconPdf'><p>Estimating probability density function from data with measurement error</p></a></li>
<li><a href='#framingham'><p>Framingham Data</p></a></li>
<li><a href='#galaxy'><p>The observed position-velocity data of low surface brightness galaxies</p></a></li>
<li><a href='#npdenest'><p>Estimating probability density function from data with unknown</p>
measurement error</a></li>
<li><a href='#npreg'><p>Nonparametric regression based on data with unknown</p>
measurement error</a></li>
<li><a href='#plot.Decon'><p>Plot a Decon Object</p></a></li>
<li><a href='#print.Decon'><p>Print a Decon Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Deconvolution Estimation in Measurement Error Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiao-Feng Wang, Bin Wang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiao-Feng Wang &lt;wangx6@ccf.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of functions to deal
        with nonparametric measurement error problems using
        deconvolution kernel methods. We focus two measurement error
        models in the package: (1) an additive measurement error model,
        where the goal is to estimate the density or distribution
        function from contaminated data; (2) nonparametric regression
        model with errors-in-variables. The R functions allow the
        measurement errors to be either homoscedastic or
        heteroscedastic. To make the deconvolution estimators
        computationally more efficient in R, we adapt the "Fast Fourier
        Transform" (FFT) algorithm for density estimation with
        error-free data to the deconvolution kernel estimation. Several
        methods for the selection of the data-driven smoothing
        parameter are also provided in the package. See details in:
        Wang, X.F. and Wang, B. (2011). Deconvolution estimation in
        measurement error models: The R package decon. Journal of
        Statistical Software, 39(10), 1-24.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-20 20:50:05 UTC</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-20 18:38:09 UTC; liangenwang</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
</table>
<hr>
<h2 id='bw.dboot1'>A bootstrap bandwidth selection without resampling</h2><span id='topic+bw.dboot1'></span>

<h3>Description</h3>

<p>To compute the optimal bandwidth using the bootstrap-type method without generation of any bootstrap sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> bw.dboot1(y,sig, h0="dnrd", error="normal", grid=100, ub=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.dboot1_+3A_y">y</code></td>
<td>
<p>The observed data.  It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="bw.dboot1_+3A_sig">sig</code></td>
<td>
<p>The standard deviation(s) <code class="reqn">\sigma</code>. For homoscedastic errors,  
<code class="reqn">sig</code> is a single value.  Otherwise, <code class="reqn">sig</code> is a vector of variances 
having the same length as <code class="reqn">y</code>.</p>
</td></tr>
<tr><td><code id="bw.dboot1_+3A_h0">h0</code></td>
<td>
<p>An initial bandwidth parameter. The default vaule is the estimate from <a href="#topic+bw.dnrd">bw.dnrd</a>. </p>
</td></tr>
<tr><td><code id="bw.dboot1_+3A_error">error</code></td>
<td>
<p>Error distribution types: 'normal', 'laplacian'  for 
normal and Laplacian errors, respectively.</p>
</td></tr>
<tr><td><code id="bw.dboot1_+3A_grid">grid</code></td>
<td>
<p>the grid number to search the optimal bandwidth when a bandwidth 
selector was specified in bw. Default value &quot;grid=100&quot;.</p>
</td></tr>
<tr><td><code id="bw.dboot1_+3A_ub">ub</code></td>
<td>
<p>the upper boundary to search the optimal bandwidth, default value 
is &quot;ub=2&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three cases are supported: (1) homo normal; (2) homo laplacian; (3) hetero normal.
</p>
<p>Case (3) could be very slow, we reduce the number of grid points in computing the L-2 distance to 100 and reduce the optimal bandwidth searching grid points to 50 to speed up the algorithm.
</p>
<p>The integration was approximated by computing the average over a fine grid of points (1000 points).
</p>
<p>The case of heteroscedastic laplacian errors is not supported and is to be developed. 
</p>


<h3>Value</h3>

<p>the selected bandwidth.
</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>References</h3>

<p>Delaigle, A. and Gijbels, I. (2004). Practical bandwidth selection in
deconvolution kernel density estimation. <em>Computational Statistics and Data
Analysis</em>, 45, 249-267.
</p>
<p>Wang, X.F. and Wang, B. (2011). Deconvolution estimation in measurement error models: The R package decon. <em>Journal of Statistical Software</em>, 39(10), 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bw.dnrd">bw.dnrd</a></code>, <code><a href="#topic+bw.dmise">bw.dmise</a></code>, <code><a href="#topic+bw.dboot2">bw.dboot2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 1000
x &lt;- c(rnorm(n/2,-2,1),rnorm(n/2,2,1))
## the case of homoscedastic normal error
sig &lt;- .8
u &lt;- rnorm(n, sd=sig)
w &lt;- x+u
bw.dboot1(w,sig=sig)
## the case of homoscedastic laplacian error
sig &lt;- .8
## generate laplacian errors
u &lt;- ifelse(runif(n) &gt; 0.5, 1, -1) * rexp(n,rate=1/sig)
w &lt;- x+u
bw.dboot1(w,sig=sig,error='laplacian')
## the case of heteroscedastic normal error
sig &lt;- runif(n, .7, .9)
u &lt;- sapply(sig, function(x) rnorm(1, sd=x))
w &lt;- x+u
bw.dboot1(w,sig=sig,error='normal')


</code></pre>

<hr>
<h2 id='bw.dboot2'>A bootstrap bandwidth selection with resampling</h2><span id='topic+bw.dboot2'></span>

<h3>Description</h3>

<p>To compute the optimal bandwidth using the bootstrap method with resampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> bw.dboot2(y,sig,h0='dboot1',error='normal',B=1000,grid=100,ub=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.dboot2_+3A_y">y</code></td>
<td>
<p>The observed data.  It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="bw.dboot2_+3A_sig">sig</code></td>
<td>
<p>The standard deviation(s) <code class="reqn">\sigma</code>. For homoscedastic errors,  
<code class="reqn">sig</code> is a single value.  Otherwise, <code class="reqn">sig</code> is a vector of variances 
having the same length as <code class="reqn">y</code>.</p>
</td></tr>
<tr><td><code id="bw.dboot2_+3A_h0">h0</code></td>
<td>
<p>An initial bandwidth parameter. The default vaule is the estimate from <a href="#topic+bw.dboot1">bw.dboot1</a>. </p>
</td></tr>
<tr><td><code id="bw.dboot2_+3A_error">error</code></td>
<td>
<p>Error distribution types: 'normal', 'laplacian'  for 
normal and Laplacian errors, respectively.</p>
</td></tr>
<tr><td><code id="bw.dboot2_+3A_b">B</code></td>
<td>
<p>Bootstrap number, default value 1000.</p>
</td></tr>
<tr><td><code id="bw.dboot2_+3A_grid">grid</code></td>
<td>
<p>the grid number to search the optimal bandwidth when a bandwidth 
selector was specified in bw. Default value &quot;grid=100&quot;.</p>
</td></tr>
<tr><td><code id="bw.dboot2_+3A_ub">ub</code></td>
<td>
<p>the upper boundary to search the optimal bandwidth, default value 
is &quot;ub=2&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three cases are supported: (1) homo normal; (2) homo laplacian.
</p>
<p>The integration was approximated by computing the average over a fine grid of points (1000 points).
</p>


<h3>Value</h3>

<p>the selected bandwidth.
</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>References</h3>

<p>Wang, X.F. and Wang, B. (2011). Deconvolution estimation in measurement error models: The R package decon. <em>Journal of Statistical Software</em>, 39(10), 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bw.dnrd">bw.dnrd</a></code>,  <code><a href="#topic+bw.dmise">bw.dmise</a></code>,  <code><a href="#topic+bw.dboot1">bw.dboot1</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 1000
x &lt;- c(rnorm(n/2,-2,1),rnorm(n/2,2,1))
## the case of homoscedastic normal error
sig &lt;- .8
u &lt;- rnorm(n, sd=sig)
w &lt;- x+u
bw.dboot2(w,sig=sig)
## the case of homoscedastic laplacian error
sig &lt;- .8
## generate laplacian error
u &lt;- ifelse(runif(n) &gt; 0.5, 1, -1) * rexp(n,rate=1/sig)
w &lt;- x+u
bw.dboot2(w,sig=sig,error='laplacian')

</code></pre>

<hr>
<h2 id='bw.dmise'>The MISE based plug-in bandwidth selection</h2><span id='topic+bw.dmise'></span>

<h3>Description</h3>

<p>To compute the optimal bandwidth using the plug-in methods by minimizing MISE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> bw.dmise(y,sig,error="normal",kernel="support",grid=100,ub=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.dmise_+3A_y">y</code></td>
<td>
<p>The observed data.  It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="bw.dmise_+3A_sig">sig</code></td>
<td>
<p>The standard deviation(s) <code class="reqn">\sigma</code>. For homoscedastic errors,  
<code class="reqn">sig</code> is a single value.  Otherwise, <code class="reqn">sig</code> is a vector of variances 
having the same length as <code class="reqn">y</code>.</p>
</td></tr>
<tr><td><code id="bw.dmise_+3A_error">error</code></td>
<td>
<p>Error distribution types: 'normal', 'laplacian'  for 
normal and Laplacian errors, respectively.</p>
</td></tr>
<tr><td><code id="bw.dmise_+3A_kernel">kernel</code></td>
<td>
<p>Kernel type: 'support' for support kernel; 
and 'normal' for Gaussian kernel.</p>
</td></tr>
<tr><td><code id="bw.dmise_+3A_grid">grid</code></td>
<td>
<p>the grid number to search the optimal bandwidth when a bandwidth 
selector was specified in bw. Default value &quot;grid=100&quot;.</p>
</td></tr>
<tr><td><code id="bw.dmise_+3A_ub">ub</code></td>
<td>
<p>the upper boundary to search the optimal bandwidth, default value 
is &quot;ub=2&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current version approximate the 
second term in the MISE by assuming that <code class="reqn">X</code> is 
normally distributed.</p>


<h3>Value</h3>

<p>the selected bandwidth.
</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>References</h3>

<p>Fan, J. (1992). Deconvolution with supersmooth distributions. 
<em>The Canadian Journal of Statistics</em>, 20, 155-169.   
</p>
<p>Stefanski, L. and Carroll, R. J. (1990). Deconvoluting kernel density estimators. 
<em>Statistics</em>, 21, 169-184.
</p>
<p>Wang, X.F. and Wang, B. (2011). Deconvolution estimation in measurement error models: The R package decon. <em>Journal of Statistical Software</em>, 39(10), 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bw.dnrd">bw.dnrd</a></code>, <code><a href="#topic+bw.dboot1">bw.dboot1</a></code>, <code><a href="#topic+bw.dboot2">bw.dboot2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 1000
x &lt;- c(rnorm(n/2,-2,1),rnorm(n/2,2,1))
## the case of homoscedastic normal error
sig &lt;- .8
u &lt;- rnorm(n, sd=sig)
w &lt;- x+u
bw.dmise(w,sig=sig,error='normal');
## The small error case
sig &lt;- .25
u &lt;- rnorm(n, sd=sig)
w &lt;- x+u
bw.dmise(w,sig=sig,kernel='normal',error='normal');

## the case of homoscedastic laplacian error
sig &lt;- .8
## generate laplacian error
u &lt;- ifelse(runif(n) &gt; 0.5, 1, -1) * rexp(n,rate=1/sig)
w &lt;- x+u
bw.dmise(w,sig=sig,error='laplace')

## the case of heteroscedastic normal error
sig &lt;- runif(n, .7, .9)
u &lt;- sapply(sig, function(x) rnorm(1, sd=x))
w &lt;- x+u
bw.dmise(w,sig=sig,kernel='support',error='normal')

</code></pre>

<hr>
<h2 id='bw.dnrd'>A rule of thumb bandwidth selection in denconvolution problems</h2><span id='topic+bw.dnrd'></span>

<h3>Description</h3>

<p>To compute the optimal bandwidth using the rule-of-thumb methods 
based on theorem 1 and theorem 2 of Fan (1991).
</p>


<h3>Usage</h3>

<pre><code class='language-R'> bw.dnrd(y,sig,error='normal')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bw.dnrd_+3A_y">y</code></td>
<td>
<p>The observed data.  It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="bw.dnrd_+3A_sig">sig</code></td>
<td>
<p>The standard deviation(s) <code class="reqn">\sigma</code>. For homoscedastic errors,  <code class="reqn">sig</code> is a single value.
otherwise, <code class="reqn">sig</code> is a vector of variances having the same length 
as <code class="reqn">y</code>.</p>
</td></tr>
<tr><td><code id="bw.dnrd_+3A_error">error</code></td>
<td>
<p>Error distribution types: 'normal', 'laplacian'  for 
normal and Laplacian errors, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current version approximate the 
second term in the MISE by assuming that <code class="reqn">X</code> is 
normally distributed. In the case of heteroscedastic error, the variance was approximated by the arithematic mean of the variances of <code class="reqn">U</code>.
</p>


<h3>Value</h3>

<p>the selected bandwidth.
</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>References</h3>

<p>Fan, J. (1991). On the optimal rates of convergence for nonparametric deconvolution problems. <em>The Annals of Statistics</em>, 19, 1257-1272.
</p>
<p>Fan, J. (1992). Deconvolution with supersmooth distributions. <em>The Canadian Journal of Statistics</em>, 20, 155-169.   
</p>
<p>Stefanski, L. and Carroll, R. J. (1990). Deconvoluting kernel density estimators. <em>Statistics</em>, 21, 169-184.
</p>
<p>Wang, X.F. and Wang, B. (2011). Deconvolution estimation in measurement error models: The R package decon. <em>Journal of Statistical Software</em>, 39(10), 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bw.dmise">bw.dmise</a></code>, <code><a href="#topic+bw.dboot1">bw.dboot1</a></code>, <code><a href="#topic+bw.dboot2">bw.dboot2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 1000
x &lt;- c(rnorm(n/2,-2,1),rnorm(n/2,2,1))
## the case of homoscedastic normal error
sig &lt;- .8
u &lt;- rnorm(n, sd=sig)
w &lt;- x+u
bw.dnrd(w,sig=sig)
## the case of homoscedastic laplacian error
sig &lt;- .8
## generate laplacian errors
u &lt;- ifelse(runif(n) &gt; 0.5, 1, -1) * rexp(n,rate=1/sig)
w &lt;- x+u
bw.dnrd(w,sig=sig,error='laplacian')
## the case of heteroscedastic normal error
sig &lt;- runif(n, .7, .9)
u &lt;- sapply(sig, function(x) rnorm(1, sd=x))
w &lt;- x+u
bw.dnrd(w,sig=sig,error='normal')
</code></pre>

<hr>
<h2 id='DeconCdf'>Estimating cumulative distribution function from data with measurement error</h2><span id='topic+DeconCdf'></span>

<h3>Description</h3>

<p>To compute the cumulative distribution function from data coupled with measurement error. The measurement errors can be either homoscedastic or heteroscedastic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DeconCdf(y,sig,x,error="normal",bw="dboot1",adjust=1,
	n=512,from,to,cut=3,na.rm=FALSE,grid=100,ub=2,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DeconCdf_+3A_y">y</code></td>
<td>
<p>The observed data.  It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_sig">sig</code></td>
<td>
<p>The standard deviations <code class="reqn">\sigma</code>.  If homoscedastic errors, <code class="reqn">sig</code> is a single value.
If heteroscedastic errors,  <code class="reqn">sig</code> is a vector of standard deviations having the same length 
as <code class="reqn">y</code>.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_x">x</code></td>
<td>
<p>x is user-defined grids where the CDF will be evaluated. FFT method is not applicable if x is given. </p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_error">error</code></td>
<td>
<p>Error distribution types: (1) 'normal' for normal errors; (2) 'laplacian' for Laplacian errors; (3) 'snormal' for a special case of small normal errors.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_bw">bw</code></td>
<td>
<p>Specifies the bandwidth. It can be a single numeric value which has been pre-determined; or computed with the specific bandwidth selector: 'dnrd' to compute the rule-of-thumb plugin bandwidth as suggested by Fan (1991); 'dmise' to compute the plugin bandwidth by minimizing MISE; 'dboot1' to compute the bootstrap bandwidth selector without resampling (Delaigle and Gijbels, 2004a), which minimizing the MISE bootstrap bandwidth selectors; 'boot2' to compute the smoothed bootstrap bandwidth selector with resampling.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_adjust">adjust</code></td>
<td>
<p>adjust the range there the CDF is to be evaluated.  By default, <code class="reqn">adjust=1</code>.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_n">n</code></td>
<td>
<p>number of points where the CDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_from">from</code></td>
<td>
<p>the starting point where the CDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_to">to</code></td>
<td>
<p>the starting point where the CDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_cut">cut</code></td>
<td>
<p>used to adjust the starting end ending points where the CDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_na.rm">na.rm</code></td>
<td>
<p> is set to FALSE by default: no NA value is allowed.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_grid">grid</code></td>
<td>
<p>the grid number to search the optimal bandwidth when a bandwidth selector was specified in bw. Default value &quot;grid=100&quot;.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_ub">ub</code></td>
<td>
<p>the upper boundary to search the optimal bandwidth, default value is
&quot;ub=2&quot;.</p>
</td></tr>
<tr><td><code id="DeconCdf_+3A_...">...</code></td>
<td>
<p>control </p>
</td></tr>
</table>


<h3>Details</h3>

<p>FFT is currently not supported for CDF computing. 
</p>


<h3>Value</h3>

<p>An object of class &ldquo;Decon&rdquo;.
</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>References</h3>

<p>Delaigle, A. and Gijbels, I. (2004). Bootstrap bandwidth selection in kernel density estimation from a contaminated sample. <em>Annals of the Institute of Statistical Mathematics</em>, 56(1), 19-47.
</p>
<p>Fan, J. (1991). On the optimal rates of convergence for nonparametric deconvolution problems. <em>The Annals of Statistics</em>, 19, 1257-1272. 
</p>
<p>Fan, J. (1992). Deconvolution with supersmooth distributions. <em>The Canadian Journal of Statistics</em>, 20, 155-169.
</p>
<p>Hall, P. and Lahiri, S.N. (2008). Estimation of distributions, moments and quantiles in deconvolution problems. <em>Annals of Statistics</em>, 36(5), 2110-2134.
</p>
<p>Stefanski L.A. and Carroll R.J. (1990). Deconvoluting kernel density estimators. <em>Statistics</em>, 21, 169-184.
</p>
<p>Wang, X.F., Fan, Z. and Wang, B. (2010). Estimating smooth distribution function in the presence of heterogeneous measurement errors. <em>Computational Statistics and Data Analysis</em>, 54, 25-36.
</p>
<p>Wang, X.F. and Wang, B. (2011). Deconvolution estimation in measurement error models: The R package decon. <em>Journal of Statistical Software</em>, 39(10), 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconPdf">DeconPdf</a></code>, <code><a href="#topic+DeconNpr">DeconNpr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#####################
## the R function to estimate the smooth distribution function
#SDF &lt;- function (x, bw = bw.nrd0(x), n = 512, lim=1){
#        dx &lt;- lim*sd(x)/20 
#        xgrid &lt;- seq(min(x)-dx, max(x)+dx, length = n)
#        Fhat &lt;- sapply(x, function(x) pnorm((xgrid-x)/bw)) 
#        return(list(x = xgrid, y = rowMeans(Fhat)))
#    }

## Case study: homoscedastic normal errors
n2 &lt;- 100
x2 &lt;- c(rnorm(n2/2,-3,1),rnorm(n2/2,3,1))
sig2 &lt;- .8
u2 &lt;- rnorm(n2, sd=sig2)
w2 &lt;- x2+u2
# estimate the bandwidth with the bootstrap method with resampling
bw2 &lt;- bw.dboot2(w2,sig=sig2, error="normal")
# estimate the distribution function with measurement error
F2 &lt;-  DeconCdf(w2,sig2,error='normal',bw=bw2)
plot(F2,  col="red", lwd=3, lty=2, xlab="x", ylab="F(x)", main="")

#lines(SDF(x2), lwd=3, lty=1)
#lines(SDF(w2), col="blue", lwd=3, lty=3)

</code></pre>

<hr>
<h2 id='DeconCPdf'>Estimating conditional probability density function from data with measurement error</h2><span id='topic+DeconCPdf'></span>

<h3>Description</h3>

<p>To compute the conditional probability density function from data with measurement error. The measurement errors have to  be homoscedastic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DeconCPdf(y,sig,y0,error='normal',bw1='dboot1',bw2='nrd0',adjust=1,
	fft=FALSE,n=512,from,to,cut=3,na.rm=FALSE,grid=100,ub=2,tol=0,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DeconCPdf_+3A_y">y</code></td>
<td>
<p>The observed data.  It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_sig">sig</code></td>
<td>
<p>The standard deviations <code class="reqn">\sigma</code>.  If homoscedastic errors, <code class="reqn">sig</code> is a single value.
If heteroscedastic errors,  <code class="reqn">sig</code> is a vector of standard deviations having the same length 
as <code class="reqn">y</code>.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_y0">y0</code></td>
<td>
<p>The given conditional data point in the conditional density f(x|y=y0).</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_error">error</code></td>
<td>
<p>Error distribution types: (1) 'normal' for normal errors; (2) 'laplacian' for Laplacian errors; (3) 'snormal' for a special case of small normal errors.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_bw1">bw1</code></td>
<td>
<p>The bandwidth for the deconvolution density <code class="reqn">f_X</code>. It can be a single numeric value which has been pre-determined; or computed with the specific bandwidth selector: 'dnrd' to compute the rule-of-thumb plugin bandwidth as suggested by Fan (1991); 'dmise' to compute the plugin bandwidth by minimizing MISE; 'dboot1' to compute the bootstrap bandwidth selector without resampling (Delaigle and Gijbels, 2004a), which minimizing the MISE bootstrap bandwidth selectors; 'boot2' to compute the smoothed bootstrap bandwidth selector with resampling.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_bw2">bw2</code></td>
<td>
<p>The bandwidth for the kernel density <code class="reqn">f_Y</code>. It can be a single numeric value which has been pre-determined; or computed with the specific bandwidth selector: 'nrd0','nrd','ucv', 'bcv', and 'SJ' (see the &quot;density&quot; function in R).</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_adjust">adjust</code></td>
<td>
<p>adjust the range there the PDF is to be evaluated.  By default, <code class="reqn">adjust=1</code>.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_fft">fft</code></td>
<td>
<p>To specify the method to compute the PDF.  'fft=FALSE' to compute directly; 'fft=TRUE' to compute the PDF by using the Fast Fourier Transformation.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_n">n</code></td>
<td>
<p>number of points where the conditional PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_from">from</code></td>
<td>
<p>the starting point where the conditional PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_to">to</code></td>
<td>
<p>the starting point where the conditional PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_cut">cut</code></td>
<td>
<p>used to adjust the starting end ending points where the conditional  PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_na.rm">na.rm</code></td>
<td>
<p> is set to FALSE by default: no NA value is allowed.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_grid">grid</code></td>
<td>
<p>the grid number to search the optimal bandwidth when a bandwidth selector was specified in bw. Default value &quot;grid=100&quot;.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_ub">ub</code></td>
<td>
<p>the upper boundary to search the optimal bandwidth, default value is
&quot;ub=2&quot;.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_tol">tol</code></td>
<td>
<p>the parameter to avoid the estimate of f(y|x) too small. The default vaule is 0. It can not exceed 0.05.</p>
</td></tr>
<tr><td><code id="DeconCPdf_+3A_...">...</code></td>
<td>
<p>control </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of points to be evaluated is too small (less than 32), a direct computing method is preferred.  The current version can support up to <code class="reqn">2^21</code> points where the conditional PDF to be computed. 
</p>


<h3>Value</h3>

<p>An object of class &ldquo;Decon&rdquo;.
</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>References</h3>

<p>Fan, J. (1991). On the optimal rates of convergence for nonparametric deconvolution problems. <em>The Annals of Statistics</em>, 19, 1257-1272. 
</p>
<p>Wang XF, Ye D (2010). Conditional density estimation with measurement error. Technical Report.
</p>
<p>Wang, X.F. and Wang, B. (2011). Deconvolution estimation in measurement error models: The R package decon. <em>Journal of Statistical Software</em>, 39(10), 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconPdf">DeconPdf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 100
x &lt;- c(rnorm(n/2,-2,1),rnorm(n/2,2,1))
sig &lt;- .8
u &lt;- rnorm(n,sd=sig)
w &lt;- x+u

f1 &lt;-  DeconCPdf(w,sig, y0=-2.5, error='normal')
#f2 &lt;-  DeconCPdf(w,sig, y0=0, error='normal')
#f3 &lt;-  DeconCPdf(w,sig, y0=2.5, error='normal')

#par(mfrow=c(2,2))
plot(density(w), main="f_w", xlab="w")
plot(f1, main="f1", xlab="x")
#plot(f2, main="f2", xlab="x")
#plot(f3, main="f3", xlab="x")

</code></pre>

<hr>
<h2 id='DeconNpr'>Perform nonparametric regression with errors-in-variables</h2><span id='topic+DeconNpr'></span>

<h3>Description</h3>

<p>To perform nonparametric regression with errors-in-variables. The measurement errors can be either homoscedastic or heteroscedastic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DeconNpr(y,sig,z,x,error='normal',bw='dboot1',adjust=1,
	n=512,from,to,cut=3,na.rm=FALSE,grid=100,ub=2,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DeconNpr_+3A_y">y</code></td>
<td>
<p>The observed data.  It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_sig">sig</code></td>
<td>
<p>The standard deviations <code class="reqn">\sigma</code>.  If homoscedastic errors, <code class="reqn">sig</code> is a single value.
If heteroscedastic errors,  <code class="reqn">sig</code> is a vector of standard deviations having the same length 
as <code class="reqn">y</code>.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_z">z</code></td>
<td>
<p>z is the dependent variable. </p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_x">x</code></td>
<td>
<p>x is user-defined grids where the regression function will be evaluated. FFT method is not applicable if x is given. </p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_error">error</code></td>
<td>
<p>Error distribution types: (1) 'normal' for normal errors; (2) 'laplacian' for Laplacian errors; (3) 'snormal' for a special case of small normal errors.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_bw">bw</code></td>
<td>
<p>Specifies the bandwidth. It can be a single numeric value which has been pre-determined; or computed with the specific bandwidth selector: 'dnrd' to compute the rule-of-thumb plugin bandwidth as suggested by Fan (1991); 'dmise' to compute the plugin bandwidth by minimizing MISE; 'dboot1' to compute the bootstrap bandwidth selector without resampling (Delaigle and Gijbels, 2004a), which minimizing the MISE bootstrap bandwidth selectors; 'boot2' to compute the smoothed bootstrap bandwidth selector with resampling.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_adjust">adjust</code></td>
<td>
<p>adjust the range there the regression function is to be evaluated.  By default, <code class="reqn">adjust=1</code>.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_n">n</code></td>
<td>
<p>number of points where the regression function is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_from">from</code></td>
<td>
<p>the starting point where the regression functionF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_to">to</code></td>
<td>
<p>the starting point where the regression function is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_cut">cut</code></td>
<td>
<p>used to adjust the starting end ending points where the regression function is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_na.rm">na.rm</code></td>
<td>
<p> is set to FALSE by default: no NA value is allowed.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_grid">grid</code></td>
<td>
<p>the grid number to search the optimal bandwidth when a bandwidth selector was specified in bw. Default value &quot;grid=100&quot;.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_ub">ub</code></td>
<td>
<p>the upper boundary to search the optimal bandwidth, default value is
&quot;ub=2&quot;.</p>
</td></tr>
<tr><td><code id="DeconNpr_+3A_...">...</code></td>
<td>
<p>control </p>
</td></tr>
</table>


<h3>Details</h3>

<p>FFT is currently not supported for nonparametric regression. 
</p>


<h3>Value</h3>

<p>An object of class &ldquo;Decon&rdquo;.
</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>References</h3>

<p>Fan, J. and Truong, Y.K. (1993). Nonparametric regression with errors in variables. <em>Annals of
Statistics</em>, 21(4), 1900-1925.
</p>
<p>Delaigle, A. and Meister, A. (2007). Nonparametric regression estimation in the heteroscedastic errors-in-variables problem. <em>Journal of the American Statistical Association</em>, 102, 1416-1426.
</p>
<p>Wang, X.F. and Wang, B. (2011). Deconvolution estimation in measurement error models: The R package decon. <em>Journal of Statistical Software</em>, 39(10), 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconPdf">DeconPdf</a>,<a href="#topic+DeconCdf">DeconCdf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 2000
x &lt;- c(rnorm(n/2,2,1), rnorm(n/2, -2,1))
sig &lt;- .8
u &lt;- sig*rnorm(n)
w &lt;- x+u
e &lt;- rnorm(n, sd=0.2)
y &lt;- x^2-2*x+e
bw1 &lt;- bw.dboot1(w, sig)
# estimate the unknown density with measurement error
(m1 &lt;-  DeconNpr(w, sig, y ,error="normal", from=0.9*min(x), to=0.9*max(x)))
# plot the results
plot(m1, col="red", lwd=3, lty=2, xlab="x", ylab="m(x)", main="", 
			zero.line=FALSE)
lines(ksmooth(x,y, kernel = "normal", 2, range.x=c(0.9*min(x),0.9*max(x))), 
			lwd=3, lty=1)
lines(ksmooth(w,y, kernel = "normal", 2, range.x=c(0.9*min(x),0.9*max(x))), 
			col="blue", lwd=3, lty=3)

</code></pre>

<hr>
<h2 id='DeconPdf'>Estimating probability density function from data with measurement error</h2><span id='topic+DeconPdf'></span>

<h3>Description</h3>

<p>To compute the probability density function from data contaminated with measurement error. The measurement errors can be either homoscedastic or heteroscedastic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DeconPdf(y,sig,x,error='normal',bw='dboot1',adjust=1,fft=FALSE,
	n=512,from,to,cut=3,na.rm=FALSE,grid=100,ub=2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DeconPdf_+3A_y">y</code></td>
<td>
<p>The observed data.  It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_sig">sig</code></td>
<td>
<p>The standard deviations <code class="reqn">\sigma</code>.  If homoscedastic errors, <code class="reqn">sig</code> is a single value.
If heteroscedastic errors,  <code class="reqn">sig</code> is a vector of standard deviations having the same length 
as <code class="reqn">y</code>.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_x">x</code></td>
<td>
<p>x is user-defined grids where the PDF will be evaluated. FFT method is not applicable if x is given. </p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_error">error</code></td>
<td>
<p>Error distribution types: (1) 'normal' for normal errors; (2) 'laplacian' for Laplacian errors; (3) 'snormal' for a special case of small normal errors.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_bw">bw</code></td>
<td>
<p>Specifies the bandwidth. It can be a single numeric value which has been pre-determined; or computed with the specific bandwidth selector: 'dnrd' to compute the rule-of-thumb plugin bandwidth as suggested by Fan (1991); 'dmise' to compute the plugin bandwidth by minimizing MISE; 'dboot1' to compute the bootstrap bandwidth selector without resampling (Delaigle and Gijbels, 2004a), which minimizing the MISE bootstrap bandwidth selectors; 'boot2' to compute the smoothed bootstrap bandwidth selector with resampling.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_adjust">adjust</code></td>
<td>
<p>adjust the range there the PDF is to be evaluated.  By default, <code class="reqn">adjust=1</code>.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_fft">fft</code></td>
<td>
<p>To specify the method to compute the PDF.  'fft=FALSE' to compute directly; 'fft=TRUE' to compute the PDF by using the Fast Fourier Transformation.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_n">n</code></td>
<td>
<p>number of points where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_from">from</code></td>
<td>
<p>the starting point where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_to">to</code></td>
<td>
<p>the starting point where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_cut">cut</code></td>
<td>
<p>used to adjust the starting end ending points where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_na.rm">na.rm</code></td>
<td>
<p> is set to FALSE by default: no NA value is allowed.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_grid">grid</code></td>
<td>
<p>the grid number to search the optimal bandwidth when a bandwidth selector was specified in bw. Default value &quot;grid=100&quot;.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_ub">ub</code></td>
<td>
<p>the upper boundary to search the optimal bandwidth, default value is
&quot;ub=2&quot;.</p>
</td></tr>
<tr><td><code id="DeconPdf_+3A_...">...</code></td>
<td>
<p>control </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of points to be evaluated is too small (less than 32), a direct computing method is preferred.  The current version can support up to <code class="reqn">2^21</code> points where the PDF to be computed. 
</p>


<h3>Value</h3>

<p>An object of class &ldquo;Decon&rdquo;.
</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>References</h3>

<p>Delaigle, A. and Meister, A. (2008). Density estimation with heteroscedastic error. <em>Bernoulli</em>, 14, 562-579.
</p>
<p>Fan, J. (1991). On the optimal rates of convergence for nonparametric deconvolution problems. <em>The Annals of Statistics</em>, 19, 1257-1272. 
</p>
<p>Fan, J. (1992). Deconvolution with supersmooth distributions. <em>The Canadian Journal of Statistics</em>, 20, 155-169.
</p>
<p>Wang, X.F. and Wang, B. (2011). Deconvolution estimation in measurement error models: The R package decon. <em>Journal of Statistical Software</em>, 39(10), 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconCdf">DeconCdf</a></code>, <code><a href="#topic+DeconNpr">DeconNpr</a></code>, <code><a href="#topic+DeconCPdf">DeconCPdf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Deconvolution: the case of homoscedastic errors
## Case 1.1: homoscedastic Laplacian errors
n1 &lt;- 500
x1 &lt;- rnorm(n1, sd=1)
sig1 &lt;- .5
u1 &lt;- ifelse(runif(n1) &gt; 0.5, 1, -1) * rexp(n1,rate=1/sig1)
w1 &lt;- x1+u1
## The rule-of-thumb method may not be accurate, 
## you may try the bootstrap method
bw1 &lt;- bw.dnrd(w1,sig=sig1, error="laplacian")
f1 &lt;-  DeconPdf(w1,sig1,error='laplacian',bw=bw1, fft=TRUE)

## Case 1.2: homoscedastic normal errors
#n2 &lt;- 1000
#x2 &lt;- c(rnorm(n2/2,-3,1),rnorm(n2/2,3,1))
#sig2 &lt;- .8
#u2 &lt;- rnorm(n2, sd=sig2)
#w2 &lt;- x2+u2
# estimate the bandwidth with the bootstrap method with resampling
#bw2 &lt;- bw.dboot2(w2,sig=sig2, error="normal")
# estimate the unknown density with measurement error
#(f2 &lt;-  DeconPdf(w2,sig2,error='normal',bw=bw2, fft=TRUE))

# plot the results
#par(mfrow=c(1,2))
#plot(f1,  col="red", lwd=3, lty=2, xlab="x", ylab="f(x)", main="")
#lines(density(x1, from=min(w1), to=max(w1)), lwd=3, lty=1)
#lines(density(w1), col="blue", lwd=3, lty=3)
#plot(f2,  col="red", lwd=3, lty=2, xlab="x", ylab="f(x)", main="")
#lines(density(x2, from=min(w2), to=max(w2)), lwd=3, lty=1)
#lines(density(w2), col="blue", lwd=3, lty=3)


## Deconvolution: the case of heteroscedastic errors
## Case 2: heteroscedastic normal errors
#n3 &lt;- 2000
#x3 &lt;- rchisq(n3, df=1.5, ncp=0)
#sig3 &lt;- 0.7+ x3/max(x3)
#u3 &lt;- sapply(sig3, function(x) rnorm(1, sd=x))
#w3 &lt;- x3+u3
# estimate the bandwidth using the bootstrap method withou resampling
#bw3 &lt;- bw.dboot1(w3,sig=sig3, error="normal")
# estimate the unknown density with measurement error
#(f3 &lt;-  DeconPdf(w3,sig3,error="normal", bw=bw3, fft=TRUE))

# plot the results
#par(mfrow=c(1,1))
#plot(f3,  col="red", lwd=3, lty=2, ylim=c(0,0.4), xlab="x", ylab="f(x)", main="")
#lines(density(x3, adjust=2), lwd=3, lty=1)
#lines(density(w3, adjust=2), col="blue", lwd=3, lty=3)


</code></pre>

<hr>
<h2 id='framingham'>Framingham Data</h2><span id='topic+framingham'></span>

<h3>Description</h3>

<p>The data is from the Framingham Study on coronary heart disease described by Carroll et al. (2006). The data consist of measurements of systolic blood pressure (SBP) obtained at two different examinations in 1,615 males on an 8-year follow-up from the first examination. At each examination, the SBP was measured twice and for each individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(framingham)</code></pre>


<h3>Format</h3>

<p>A data frame with 1615 observations on 4 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>SBP11</code>  </td><td style="text-align: left;"> numeric  </td><td style="text-align: left;"> First systolic blood pressure at exam 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>SBP12</code>   </td><td style="text-align: left;"> numeric  </td><td style="text-align: left;"> Second systolic blood pressure at exam 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>SBP21</code>  </td><td style="text-align: left;"> numeric  </td><td style="text-align: left;"> First systolic blood pressure at exam 2 </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>SBP22</code>   </td><td style="text-align: left;"> numeric  </td><td style="text-align: left;"> Second systolic blood pressure at exam 2 </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>References</h3>

<p>Carroll, R.~J., Ruppert, D., Stefanski, L.~A., and Crainiceanu, C. (2006).
<em>Measurement Error in Nonlinear Models: A Modern Perspective,
Second Edition</em>. Chapman Hall, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconPdf">DeconPdf</a></code></p>

<hr>
<h2 id='galaxy'>The observed position-velocity data of low surface brightness galaxies</h2><span id='topic+galaxy'></span>

<h3>Description</h3>

<p>The astronomical position-velocity data is from a sample of 26 low surfaces brightness (LSB) galaxies. The data contain 318 stars with their radiuses in kiloparsec (kpc), observed velocities of stars in km/s (relative to center, corrected for inclination) from 26 LSB galaxies. It was known that the velocities were measured with errors. In the data set, each  velocity includes its estimated standard deviation of measurement errors. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(galaxy)</code></pre>


<h3>Format</h3>

<p>A data frame with 318 observations on 3 variables.
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>Rkpc</code>  </td><td style="text-align: left;"> numeric  </td><td style="text-align: left;"> radiuses in kiloparsec (kpc) </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>V</code>   </td><td style="text-align: left;"> numeric  </td><td style="text-align: left;"> velocities of stars in km/s </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Err</code>  </td><td style="text-align: left;"> numeric  </td><td style="text-align: left;"> standard deviations of measurement errors in measuring velocities </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>References</h3>

<p>De Blok, W.J.G., McGaugh, S.S., and Rubin, V.C. (2001).
High-resolution rotation curves of low surface brightness galaxies: Mass Models.  <em>The Astronomical Journal</em>, 122, 2396-2427.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconNpr">DeconNpr</a></code></p>

<hr>
<h2 id='npdenest'>Estimating probability density function from data with unknown
measurement error</h2><span id='topic+npdenest'></span>

<h3>Description</h3>

<p> To compute the probability density function from data
contaminated with measurement error. The measurement error type is
unknown.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>
 npdenest(w, e, bw, adjust = 1, n = 512, from, to, cut = 3, na.rm = FALSE,...) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npdenest_+3A_w">w</code></td>
<td>
<p>The observed data.  It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="npdenest_+3A_e">e</code></td>
<td>
<p>Observed vector of measurement errors. </p>
</td></tr>
<tr><td><code id="npdenest_+3A_bw">bw</code></td>
<td>
<p>Smoothing parameter.</p>
</td></tr>
<tr><td><code id="npdenest_+3A_adjust">adjust</code></td>
<td>
<p>adjust the range there the PDF is to be evaluated.  
By default, <code class="reqn">adjust=1</code>.</p>
</td></tr>
<tr><td><code id="npdenest_+3A_n">n</code></td>
<td>
<p>number of points where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="npdenest_+3A_from">from</code></td>
<td>
<p>the starting point where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="npdenest_+3A_to">to</code></td>
<td>
<p>the starting point where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="npdenest_+3A_cut">cut</code></td>
<td>
<p>used to adjust the starting end ending points where the 
PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="npdenest_+3A_na.rm">na.rm</code></td>
<td>
<p> is set to FALSE by default: no NA value is allowed.</p>
</td></tr>
<tr><td><code id="npdenest_+3A_...">...</code></td>
<td>
<p>controls</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The optimal bandwidth is selected by minimizing
<code>abs(Var(f.hat)+Var(E)-Var(Y))</code>.  </p>


<h3>Value</h3>

<p> An object of class
&ldquo;Decon&rdquo;.  </p>


<h3>References</h3>

<p>Wang, X.F. and Wang, B. (2011). Deconvolution estimation in measurement error models: The R package decon. <em>Journal of Statistical Software</em>, 39(10), 1-24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconCdf">DeconCdf</a></code>, <code><a href="#topic+DeconNpr">DeconNpr</a></code>, <code><a href="#topic+DeconCPdf">DeconCPdf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 n1 &lt;- 1500
 x1 &lt;- rnorm(n1, sd=1)
 sig1 &lt;- .5
 u1 &lt;- ifelse(runif(n1) &gt; 0.5, 1, -1) * rexp(n1,rate=1/sig1)
 w1 &lt;- x1+u1
 ## The rule-of-thumb method may not be accurate, 
 ## you may try the bootstrap method
 bw1 &lt;- bw.dnrd(w1,sig=sig1, error="laplacian")
 (f1 &lt;-  DeconPdf(w1,sig1,error='laplacian',bw=bw1, fft=TRUE))
 (f2 &lt;-  npdenest(w1, u1))

 # plot the results
 par(mfrow=c(1,1))
 plot(f1,  col="red", lwd=3, lty=2, xlab="x", ylab="f(x)", main="")
 lines(density(x1, from=min(w1), to=max(w1)), lwd=3, lty=1)
 lines(density(w1), col="blue", lwd=3, lty=3)
 lines(f2, col='red', lty=1,lwd=3)

</code></pre>

<hr>
<h2 id='npreg'>Nonparametric regression based on data with unknown
measurement error</h2><span id='topic+npreg'></span>

<h3>Description</h3>

<p> To compute nonparametric regression line from data
contaminated with measurement error. The measurement error type is
unknown.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>
 npreg(w, y, e, bw, adjust = 1, n = 512, from, to, cut = 0, na.rm = FALSE,...) 

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="npreg_+3A_w">w</code>, <code id="npreg_+3A_y">y</code></td>
<td>
<p>The observed data <code>W</code> and <code>Y</code>.  
It is a vector of length at least 3.</p>
</td></tr>
<tr><td><code id="npreg_+3A_e">e</code></td>
<td>
<p>Observed vector of measurement errors. </p>
</td></tr>
<tr><td><code id="npreg_+3A_bw">bw</code></td>
<td>
<p>Smoothing parameter.</p>
</td></tr>
<tr><td><code id="npreg_+3A_adjust">adjust</code></td>
<td>
<p>adjust the range there the PDF is to be evaluated.  
By default, <code class="reqn">adjust=1</code>.</p>
</td></tr>
<tr><td><code id="npreg_+3A_n">n</code></td>
<td>
<p>number of points where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="npreg_+3A_from">from</code></td>
<td>
<p>the starting point where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="npreg_+3A_to">to</code></td>
<td>
<p>the starting point where the PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="npreg_+3A_cut">cut</code></td>
<td>
<p>used to adjust the starting end ending points where the 
PDF is to be evaluated.</p>
</td></tr>
<tr><td><code id="npreg_+3A_na.rm">na.rm</code></td>
<td>
<p> is set to FALSE by default: no NA value is allowed.</p>
</td></tr>
<tr><td><code id="npreg_+3A_...">...</code></td>
<td>
<p>controls</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The optimal bandwidth is selected by minimizing
<code>abs(Var(f.hat)+Var(E)-Var(Y))</code>.  </p>


<h3>Value</h3>

<p> An object of class
&ldquo;Decon&rdquo;.  </p>


<h3>References</h3>

<p> Wang, X.F. and Wang, B. (2011). Deconvolution estimation
in measurement error models: The R package decon. <em>Journal of
Statistical Software</em>, 39(10), 1-24.  </p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconCdf">DeconCdf</a></code>, <code><a href="#topic+DeconNpr">DeconNpr</a></code>, <code><a href="#topic+DeconCPdf">DeconCPdf</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 2000
x &lt;- c(rnorm(n/2,2,1), rnorm(n/2, -2,1))
sig &lt;- .8
u &lt;- sig*rnorm(n)
w &lt;- x+u
e &lt;- rnorm(n, sd=0.2)
y &lt;- x^2-2*x+e
bw1 &lt;- bw.dboot1(w, sig)
u0 &lt;- sig*rnorm(n/2) # typically the size of u0 is smaller than x.
m2 &lt;- npreg(w, y, u0, from=0.9*min(x), to=0.9*max(x))

# plot the results
plot(m2, col="red", lwd=3, lty=2, xlab="x", ylab="m(x)", main="", 
			zero.line=FALSE)
lines(ksmooth(x,y, kernel = "normal", 2, range.x=c(0.9*min(x),0.9*max(x))), 
			lwd=3, lty=1)
lines(ksmooth(w,y, kernel = "normal", 2, range.x=c(0.9*min(x),0.9*max(x))), 
			col="blue", lwd=3, lty=3)

</code></pre>

<hr>
<h2 id='plot.Decon'>Plot a Decon Object</h2><span id='topic+plot.Decon'></span>

<h3>Description</h3>

<p>To plot a &ldquo;Decon&rdquo; object generated by DeconPdf(...), DeconCdf(...), DeconCPdf(...), or DeconNpr(...).
</p>


<h3>Details</h3>

<p>This function is to plot the estimated function generated by DeconPdf(...), DeconCdf(...), DeconCPdf(...), or DeconNpr(...)</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconPdf">DeconPdf</a>, <a href="#topic+DeconCdf">DeconCdf</a>, <a href="#topic+DeconCPdf">DeconCPdf</a>, <a href="#topic+DeconNpr">DeconNpr</a></code>.
</p>

<hr>
<h2 id='print.Decon'>Print a Decon Object</h2><span id='topic+print.Decon'></span>

<h3>Description</h3>

<p>To print a &ldquo;Decon&rdquo; object generated by DeconPdf(...), DeconCdf(...), DeconCPdf(...), or DeconNpr(...).
</p>


<h3>Details</h3>

<p>This function is to print the summary description from the object generated by DeconPdf(...), DeconCdf(...), DeconCPdf(...), or DeconNpr(...)</p>


<h3>Author(s)</h3>

<p>X.F. Wang <a href="mailto:wangx6@ccf.org">wangx6@ccf.org</a>
</p>
<p>B. Wang  <a href="mailto:bwang@jaguar1.usouthal.edu">bwang@jaguar1.usouthal.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DeconPdf">DeconPdf</a>, <a href="#topic+DeconCdf">DeconCdf</a>, <a href="#topic+DeconCPdf">DeconCPdf</a>, <a href="#topic+DeconNpr">DeconNpr</a></code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
