<!DOCTYPE html><html lang="en"><head><title>Help for package parafac4microbiome</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {parafac4microbiome}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#parafac4microbiome-package'><p>parafac4microbiome: Parallel Factor Analysis Modelling of Longitudinal Microbiome Data</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#assessModelQuality'><p>Create randomly initialized models to determine the correct number of components by assessing model quality metrics.</p></a></li>
<li><a href='#assessModelStability'><p>Bootstrapping procedure to determine PARAFAC model stability for a given number of components.</p></a></li>
<li><a href='#calculateFMS'><p>Calculate Factor Match Score for all initialized models.</p></a></li>
<li><a href='#calculateSparsity'><p>Calculate sparsity across the feature mode of a multi-way array.</p></a></li>
<li><a href='#calculateVarExp'><p>Calculate the variation explained by a PARAFAC model.</p></a></li>
<li><a href='#calcVarExpPerComponent'><p>Calculate the variance explained of a PARAFAC model, per component</p></a></li>
<li><a href='#corcondia'><p>Core Consistency Diagnostic (CORCONDIA) calculation</p></a></li>
<li><a href='#fac_to_vect'><p>Vectorize Fac object</p></a></li>
<li><a href='#flipLoadings'><p>Sign flip the loadings of many randomly initialized models to make consistent overview plots.</p></a></li>
<li><a href='#Fujita2023'><p>Fujita2023 longitudinal microbiome data</p></a></li>
<li><a href='#importMicrobiotaProcess'><p>Import MicrobiotaProcess object for PARAFAC modelling</p></a></li>
<li><a href='#importPhyloseq'><p>Import Phyloseq object for PARAFAC modelling</p></a></li>
<li><a href='#importTreeSummarizedExperiment'><p>Import TreeSummarizedExperiment object for PARAFAC modelling</p></a></li>
<li><a href='#initializePARAFAC'><p>Initialize PARAFAC algorithm input vectors</p></a></li>
<li><a href='#multiwayCenter'><p>Center a multi-way array</p></a></li>
<li><a href='#multiwayCLR'><p>Perform a centered log-ratio transform over a multi-way array</p></a></li>
<li><a href='#multiwayScale'><p>Scale a multi-way array</p></a></li>
<li><a href='#parafac'><p>Parallel Factor Analysis</p></a></li>
<li><a href='#parafac_core_als'><p>Internal PARAFAC alternating least-squares (ALS) core algorithm</p></a></li>
<li><a href='#parafac_fun'><p>PARAFAC loss function calculation</p></a></li>
<li><a href='#parafac_gradient'><p>Calculate gradient of PARAFAC model.</p></a></li>
<li><a href='#plotModelMetric'><p>Plot diagnostics of many initialized PARAFAC models.</p></a></li>
<li><a href='#plotModelStability'><p>Plot a summary of the loadings of many initialized parafac models.</p></a></li>
<li><a href='#plotModelTCCs'><p>Plots Tucker Congruence Coefficients of randomly initialized models.</p></a></li>
<li><a href='#plotPARAFACmodel'><p>Plot a PARAFAC model</p></a></li>
<li><a href='#processDataCube'><p>Process a multi-way array of count data.</p></a></li>
<li><a href='#reinflateFac'><p>Calculate Xhat from a model Fac object</p></a></li>
<li><a href='#reinflateTensor'><p>Create a tensor out of a set of matrices similar to a component model.</p></a></li>
<li><a href='#Shao2019'><p>Shao2019 longitudinal microbiome data</p></a></li>
<li><a href='#sortComponents'><p>Sort PARAFAC components based on variance explained per component.</p></a></li>
<li><a href='#transformPARAFACloadings'><p>Transform PARAFAC loadings to an orthonormal basis.</p>
Note: this function only works for 3-way PARAFAC models.</a></li>
<li><a href='#vanderPloeg2024'><p>vanderPloeg2024 longitudinal microbiome data</p></a></li>
<li><a href='#vect_to_fac'><p>Convert vectorized output of PARAFAC to a Fac list object with all loadings per mode.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Parallel Factor Analysis Modelling of Longitudinal Microbiome
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Creation and selection of PARAllel FACtor Analysis (PARAFAC)
    models of longitudinal microbiome data. You can import your own data with
    our import functions or use one of the example datasets to create your own
    PARAFAC models. Selection of the optimal number of components can be done
    using assessModelQuality() and assessModelStability(). The selected model can
    then be plotted using plotPARAFACmodel(). The Parallel Factor
    Analysis method was originally described by Caroll and Chang (1970)
    &lt;<a href="https://doi.org/10.1007%2FBF02310791">doi:10.1007/BF02310791</a>&gt; and Harshman (1970)
    <a href="https://www.psychology.uwo.ca/faculty/harshman/wpppfac0.pdf">https://www.psychology.uwo.ca/faculty/harshman/wpppfac0.pdf</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>compositions, cowplot, doParallel, dplyr, foreach, ggplot2,
ggpubr, lifecycle, magrittr, methods, mize, multiway, parallel,
pracma, rlang, rTensor, stats, tidyr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, MicrobiotaProcess, phyloseq, rmarkdown,
SummarizedExperiment, testthat (&ge; 3.0.0),
TreeSummarizedExperiment, withr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://grvanderploeg.github.io/parafac4microbiome/">https://grvanderploeg.github.io/parafac4microbiome/</a>,
<a href="https://github.com/GRvanderPloeg/parafac4microbiome">https://github.com/GRvanderPloeg/parafac4microbiome</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/GRvanderPloeg/parafac4microbiome/issues">https://github.com/GRvanderPloeg/parafac4microbiome/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-24 10:23:45 UTC; roelv</td>
</tr>
<tr>
<td>Author:</td>
<td>Geert Roelof van der Ploeg
    <a href="https://orcid.org/0009-0007-5204-3386"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Johan Westerhuis <a href="https://orcid.org/0000-0002-6747-9779"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Anna Heintz-Buschart
    <a href="https://orcid.org/0000-0002-9780-1933"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Age Smilde <a href="https://orcid.org/0000-0002-3052-4644"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  University of Amsterdam [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Geert Roelof van der Ploeg &lt;g.r.ploeg@uva.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-24 15:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='parafac4microbiome-package'>parafac4microbiome: Parallel Factor Analysis Modelling of Longitudinal Microbiome Data</h2><span id='topic+parafac4microbiome'></span><span id='topic+parafac4microbiome-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Creation and selection of PARAllel FACtor Analysis (PARAFAC) models of longitudinal microbiome data. You can import your own data with our import functions or use one of the example datasets to create your own PARAFAC models. Selection of the optimal number of components can be done using assessModelQuality() and assessModelStability(). The selected model can then be plotted using plotPARAFACmodel(). The Parallel Factor Analysis method was originally described by Caroll and Chang (1970) <a href="https://doi.org/10.1007/BF02310791">doi:10.1007/BF02310791</a> and Harshman (1970) <a href="https://www.psychology.uwo.ca/faculty/harshman/wpppfac0.pdf">https://www.psychology.uwo.ca/faculty/harshman/wpppfac0.pdf</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Geert Roelof van der Ploeg <a href="mailto:g.r.ploeg@uva.nl">g.r.ploeg@uva.nl</a> (<a href="https://orcid.org/0009-0007-5204-3386">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Johan Westerhuis <a href="mailto:j.a.westerhuis@uva.nl">j.a.westerhuis@uva.nl</a> (<a href="https://orcid.org/0000-0002-6747-9779">ORCID</a>) [contributor]
</p>
</li>
<li><p> Anna Heintz-Buschart <a href="mailto:a.u.s.heintzbuschart@uva.nl">a.u.s.heintzbuschart@uva.nl</a> (<a href="https://orcid.org/0000-0002-9780-1933">ORCID</a>) [contributor]
</p>
</li>
<li><p> Age Smilde <a href="mailto:a.k.smilde@uva.nl">a.k.smilde@uva.nl</a> (<a href="https://orcid.org/0000-0002-3052-4644">ORCID</a>) [contributor]
</p>
</li>
<li><p> University of Amsterdam [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://grvanderploeg.github.io/parafac4microbiome/">https://grvanderploeg.github.io/parafac4microbiome/</a>
</p>
</li>
<li> <p><a href="https://github.com/GRvanderPloeg/parafac4microbiome">https://github.com/GRvanderPloeg/parafac4microbiome</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/GRvanderPloeg/parafac4microbiome/issues">https://github.com/GRvanderPloeg/parafac4microbiome/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='assessModelQuality'>Create randomly initialized models to determine the correct number of components by assessing model quality metrics.</h2><span id='topic+assessModelQuality'></span>

<h3>Description</h3>

<p>Create randomly initialized models to determine the correct number of components by assessing model quality metrics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assessModelQuality(
  X,
  minNumComponents = 1,
  maxNumComponents = 5,
  numRepetitions = 100,
  method = "als",
  ctol = 1e-06,
  maxit = 2500,
  max_fn = 10000,
  rel_tol = 1e-08,
  abs_tol = 1e-08,
  grad_tol = 1e-08,
  numCores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assessModelQuality_+3A_x">X</code></td>
<td>
<p>Input data</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_minnumcomponents">minNumComponents</code></td>
<td>
<p>Minimum number of components (default 1).</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_maxnumcomponents">maxNumComponents</code></td>
<td>
<p>Maximum number of components (default 5).</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_numrepetitions">numRepetitions</code></td>
<td>
<p>Number of randomly initialized models to create (default 100).</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_method">method</code></td>
<td>
<p>Use ALS algorithm (&quot;als&quot;, default) or use all-at-once optimization (&quot;opt&quot;). The all-at-once optimization is based on a nonlinear conjugate gradient method with Hestenes-Stiefel updates and the More-Thuente line search algorithm.</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_ctol">ctol</code></td>
<td>
<p>Change in SSQ needed for model to be converged (default 1e-6).</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations (default 2500).</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_max_fn">max_fn</code></td>
<td>
<p>Maximum number of function evaluations allowed without convergence in the OPT case (default 10000).</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_rel_tol">rel_tol</code></td>
<td>
<p>Relative change in loss tolerated to call the algorithm converged in the OPT case (default 1e-8).</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_abs_tol">abs_tol</code></td>
<td>
<p>Absolute loss tolerated to call the algorithm converged in the OPT case (default 1e-8).</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_grad_tol">grad_tol</code></td>
<td>
<p>Tolerance on the two-norm of the gradient divided over the number of elements in the gradient in the OPT case (default 1e-8).</p>
</td></tr>
<tr><td><code id="assessModelQuality_+3A_numcores">numCores</code></td>
<td>
<p>Number of cores to use. If set larger than 1, it will run the job in parallel (default 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object of the following:
</p>

<ul>
<li><p> plots: Plots of all assessed metrics and an overview plot showing a summary of all of them.
</p>
</li>
<li><p> metrics: metrics of every created model (number of iterations, sum of squared errors, CORCONDIA score and variance explained).
</p>
</li>
<li><p> models: all created models.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>X = Fujita2023$data

# Run assessModelQuality with less strict convergence parameters as example
assessment = assessModelQuality(X,
                                minNumComponents=1,
                                maxNumComponents=3,
                                numRepetitions=5,
                                ctol=1e-4,
                                maxit=250)
assessment$plots$overview
</code></pre>

<hr>
<h2 id='assessModelStability'>Bootstrapping procedure to determine PARAFAC model stability for a given number of components.</h2><span id='topic+assessModelStability'></span>

<h3>Description</h3>

<p>Bootstrapping procedure to determine PARAFAC model stability for a given number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assessModelStability(
  dataset,
  minNumComponents = 1,
  maxNumComponents = 5,
  numFolds = dim(dataset$data)[1],
  considerGroups = FALSE,
  groupVariable = "",
  colourCols = NULL,
  legendTitles = NULL,
  xLabels = NULL,
  legendColNums = NULL,
  arrangeModes = NULL,
  method = "als",
  ctol = 1e-06,
  maxit = 2500,
  max_fn = 10000,
  rel_tol = 1e-08,
  abs_tol = 1e-08,
  grad_tol = 1e-08,
  numCores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assessModelStability_+3A_dataset">dataset</code></td>
<td>
<p>See <a href="#topic+Fujita2023">Fujita2023</a>, <a href="#topic+Shao2019">Shao2019</a> or <a href="#topic+vanderPloeg2024">vanderPloeg2024</a>.</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_minnumcomponents">minNumComponents</code></td>
<td>
<p>Minimum number of components (default 1).</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_maxnumcomponents">maxNumComponents</code></td>
<td>
<p>Maximum number of components (default 5).</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_numfolds">numFolds</code></td>
<td>
<p>Number of bootstrapped models to create.</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_considergroups">considerGroups</code></td>
<td>
<p>Consider subject groups in calculating sparsity (default FALSE)</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_groupvariable">groupVariable</code></td>
<td>
<p>Column name in dataset$mode1 that should be used to consider groups (default &quot;&quot;)</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_colourcols">colourCols</code></td>
<td>
<p>Vector of strings stating which column names should be factorized for colours per mode.</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_legendtitles">legendTitles</code></td>
<td>
<p>Vector of strings stating the legend title per mode.</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_xlabels">xLabels</code></td>
<td>
<p>Vector of strings stating the x-axis labels per mode.</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_legendcolnums">legendColNums</code></td>
<td>
<p>Vector of integers stating the desired number of columns for the legends per mode.</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_arrangemodes">arrangeModes</code></td>
<td>
<p>Vector of boolean values per mode, stating if the loadings should be arranged according to colourCols (TRUE) or not (FALSE).</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_method">method</code></td>
<td>
<p>Use ALS algorithm (&quot;als&quot;, default) or use all-at-once optimization (&quot;opt&quot;). The all-at-once optimization is based on a nonlinear conjugate gradient method with Hestenes-Stiefel updates and the More-Thuente line search algorithm.</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_ctol">ctol</code></td>
<td>
<p>Relative change in loss tolerated to call the algorithm converged in the ALS case (default 1e-4).</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations allowed without convergence in the ALS case (default 500).</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_max_fn">max_fn</code></td>
<td>
<p>Maximum number of function evaluations allowed without convergence in the OPT case (default 10000).</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_rel_tol">rel_tol</code></td>
<td>
<p>Relative change in loss tolerated to call the algorithm converged in the OPT case (default 1e-8).</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_abs_tol">abs_tol</code></td>
<td>
<p>Absolute loss tolerated to call the algorithm converged in the OPT case (default 1e-8).</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_grad_tol">grad_tol</code></td>
<td>
<p>Tolerance on the two-norm of the gradient divided over the number of elements in the gradient in the OPT case (default 1e-8).</p>
</td></tr>
<tr><td><code id="assessModelStability_+3A_numcores">numCores</code></td>
<td>
<p>Number of cores to use. If set larger than 1, it will run the job in parallel (default 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following:
</p>

<ul>
<li><p> models: All stabilized sign-flipped bootstrapped PARAFAC models.
</p>
</li>
<li><p> modelPlots: A list of plots of the median model with error bars for each number of components.
</p>
</li>
<li><p> FMSplot: A bar plot showing the Factor Match Scores per number of components (see Li et al., 2024).
</p>
</li>
<li><p> FMS: FMS values that the FMS plot is based on.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2)
modelStability = assessModelStability(processedFujita,
                                      minNumComponents=1,
                                      maxNumComponents=2,
                                      ctol=1e-4,
                                      maxit=250)
</code></pre>

<hr>
<h2 id='calculateFMS'>Calculate Factor Match Score for all initialized models.</h2><span id='topic+calculateFMS'></span>

<h3>Description</h3>

<p>Calculate Factor Match Score for all initialized models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateFMS(models)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateFMS_+3A_models">models</code></td>
<td>
<p>Output of <code><a href="#topic+parafac">parafac()</a></code> using output=&quot;all&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector containing FMS scores of all comparisons
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = array(rnorm(108*2), c(108, 2))
B = array(rnorm(100*2), c(100, 2))
C = array(rnorm(10*2), c(10, 2))
X = reinflateTensor(A, B, C)
models = parafac(X, 2, initialization="random", nstart=10, maxit=2, output="all")
calculateFMS(models)
</code></pre>

<hr>
<h2 id='calculateSparsity'>Calculate sparsity across the feature mode of a multi-way array.</h2><span id='topic+calculateSparsity'></span>

<h3>Description</h3>

<p>Calculate sparsity across the feature mode of a multi-way array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateSparsity(dataset, considerGroups = FALSE, groupVariable = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateSparsity_+3A_dataset">dataset</code></td>
<td>
<p>See <a href="#topic+Fujita2023">Fujita2023</a>, <a href="#topic+Shao2019">Shao2019</a> or <a href="#topic+vanderPloeg2024">vanderPloeg2024</a>.</p>
</td></tr>
<tr><td><code id="calculateSparsity_+3A_considergroups">considerGroups</code></td>
<td>
<p>Consider subject groups in calculating sparsity (default FALSE)</p>
</td></tr>
<tr><td><code id="calculateSparsity_+3A_groupvariable">groupVariable</code></td>
<td>
<p>Column name in dataset$mode1 that should be used to consider groups (default &quot;&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of sparsity fractions (N x J) where N is the number of groups and J is the number of features.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># No groups
sparsity = calculateSparsity(Fujita2023)
length(sparsity)
hist(sparsity)

# Consider groups
colnames(Shao2019$mode1)
sparsity = calculateSparsity(Shao2019, considerGroups=TRUE, groupVariable="Delivery_mode")
dim(sparsity)
hist(sparsity[1,])
hist(sparsity[2,])

</code></pre>

<hr>
<h2 id='calculateVarExp'>Calculate the variation explained by a PARAFAC model.</h2><span id='topic+calculateVarExp'></span>

<h3>Description</h3>

<p>Calculate the variation explained by a PARAFAC model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateVarExp(Fac, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculateVarExp_+3A_fac">Fac</code></td>
<td>
<p>Fac object output from the <code><a href="#topic+parafac">parafac()</a></code> function.</p>
</td></tr>
<tr><td><code id="calculateVarExp_+3A_x">X</code></td>
<td>
<p>Input data of the PARAFAC model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The variation explained by the model, expressed as a fraction (between 0-1).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = Fujita2023$data
model = parafac(X, nfac=1, nstart=1, verbose=FALSE)
calculateVarExp(model$Fac, X)
</code></pre>

<hr>
<h2 id='calcVarExpPerComponent'>Calculate the variance explained of a PARAFAC model, per component</h2><span id='topic+calcVarExpPerComponent'></span>

<h3>Description</h3>

<p>Calculate the variance explained of a PARAFAC model, per component
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcVarExpPerComponent(Fac, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcVarExpPerComponent_+3A_fac">Fac</code></td>
<td>
<p>Fac object output of a model</p>
</td></tr>
<tr><td><code id="calcVarExpPerComponent_+3A_x">X</code></td>
<td>
<p>Input dataset</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of scalars of the percentage of variation explained per component
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = array(rnorm(108*100*10), c(108,100,10))
model = parafac(X, 2)
calcVarExpPerComponent(model$Fac, X)
</code></pre>

<hr>
<h2 id='corcondia'>Core Consistency Diagnostic (CORCONDIA) calculation</h2><span id='topic+corcondia'></span>

<h3>Description</h3>

<p>Core Consistency Diagnostic (CORCONDIA) calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corcondia(X, Fac)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corcondia_+3A_x">X</code></td>
<td>
<p>Input data matrix</p>
</td></tr>
<tr><td><code id="corcondia_+3A_fac">Fac</code></td>
<td>
<p>PARAFAC model Fac object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar of the CORCONDIA value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = Fujita2023$data
model = parafac(X, 2)
corcondia(X, model$Fac)
</code></pre>

<hr>
<h2 id='fac_to_vect'>Vectorize Fac object</h2><span id='topic+fac_to_vect'></span>

<h3>Description</h3>

<p>Vectorize Fac object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fac_to_vect(Fac)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fac_to_vect_+3A_fac">Fac</code></td>
<td>
<p>Fac object output of <a href="#topic+parafac">parafac</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vectorized Fac object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
A = array(rnorm(108*2), c(108, 2))
B = array(rnorm(100*2), c(100, 2))
C = array(rnorm(10*2), c(10, 2))
Fac = list(A, B, C)
v = fac_to_vect(Fac)
</code></pre>

<hr>
<h2 id='flipLoadings'>Sign flip the loadings of many randomly initialized models to make consistent overview plots.</h2><span id='topic+flipLoadings'></span>

<h3>Description</h3>

<p>Sign flip the loadings of many randomly initialized models to make consistent overview plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flipLoadings(models, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flipLoadings_+3A_models">models</code></td>
<td>
<p>Output of <a href="#topic+parafac">parafac</a>.</p>
</td></tr>
<tr><td><code id="flipLoadings_+3A_x">X</code></td>
<td>
<p>Input dataset of parafac modelling procedure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>models with sign flipped components where applicable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = array(rnorm(108*2), c(108,2))
B = array(rnorm(100*2), c(100,2))
C = array(rnorm(10*2), c(10,2))
X = reinflateTensor(A, B, C)
models = parafac(X, 2, nstart=10, output="all", sortComponents=TRUE)
flippedModels = flipLoadings(models, X)
</code></pre>

<hr>
<h2 id='Fujita2023'>Fujita2023 longitudinal microbiome data</h2><span id='topic+Fujita2023'></span>

<h3>Description</h3>

<p>The Fujita2023 longitudinal microbiome dataset as a three-dimensional array,
with replicates in mode 1, microbial abundances in mode 2 and time in mode 3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fujita2023
</code></pre>


<h3>Format</h3>



<h4><code>Fujita2023</code></h4>

<p>A list object with three elements:
</p>

<dl>
<dt>data</dt><dd><p>Array object of the data cube</p>
</dd>
<dt>mode1</dt><dd><p>Dataframe with all the subject metadata, ordered the same as the rows in the data cube.</p>
</dd>
<dt>mode2</dt><dd><p>Taxonomic classification of the microbiota, ordered the same as the columns in the data cube.</p>
</dd>
<dt>mode3</dt><dd><p>Dataframe with the time metadata, ordered the same as the third dimension in the array.</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://doi.org/10.1186/s40168-023-01474-5">doi:10.1186/s40168-023-01474-5</a>
</p>

<hr>
<h2 id='importMicrobiotaProcess'>Import MicrobiotaProcess object for PARAFAC modelling</h2><span id='topic+importMicrobiotaProcess'></span>

<h3>Description</h3>

<p>Import MicrobiotaProcess object for PARAFAC modelling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importMicrobiotaProcess(MPobject, subjectIDs, thirdMode, taxa_are_rows = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="importMicrobiotaProcess_+3A_mpobject">MPobject</code></td>
<td>
<p>MicrobiotaProcess object containing at least an OTU table and sample information, preferably also taxonomic information.</p>
</td></tr>
<tr><td><code id="importMicrobiotaProcess_+3A_subjectids">subjectIDs</code></td>
<td>
<p>Column name in the sample information corresponding to the subject IDs.</p>
</td></tr>
<tr><td><code id="importMicrobiotaProcess_+3A_thirdmode">thirdMode</code></td>
<td>
<p>Column name in the sample information corresponding to the study design aspect to put in the third mode of the data cube.</p>
</td></tr>
<tr><td><code id="importMicrobiotaProcess_+3A_taxa_are_rows">taxa_are_rows</code></td>
<td>
<p>Boolean specifying if the taxa are in the rows of the OTU table (TRUE) or not (FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object containing:
</p>

<ul>
<li><p> 'data': data cube
</p>
</li>
<li><p> 'mode1': metadata of the subject mode
</p>
</li>
<li><p> 'mode2': taxonomy information
</p>
</li>
<li><p> 'mode3': metadata of the third mode
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

library(MicrobiotaProcess)

# Generate synthetic data
sample_info = data.frame(Sample = factor(c("S1", "S2", "S3", "S4", "S5")),
                         time = factor(c("T1", "T2", "T1", "T2", "T1")))
otu_table = matrix(runif(25, min = 0, max = 100), nrow = 5, ncol = 5,
                   dimnames = list(paste0("OTU", 1:5), sample_info$Sample))

taxonomy_table = data.frame(OTU = paste0("OTU", 1:5),
                            Kingdom = rep("King", 5),
                            Phylum = rep("Phy", 5),
                            Class = rep("Cla", 5),
                            Order = rep("Ord", 5),
                            Family = rep("Fam", 5),
                            Genus = rep("Gen", 5))

# Create Summarized Experiment
synthetic_SE = SummarizedExperiment::SummarizedExperiment(
               assays = list(otu = otu_table),
               colData = sample_info,
               rowData = taxonomy_table)

# Convert to MicrobiotaProcess object
synthetic_MPSE = as.MPSE(synthetic_SE)

dataset = importMicrobiotaProcess(synthetic_MPSE,
                                  subjectIDs = "Sample",
                                  thirdMode = "time",
                                  taxa_are_rows = TRUE)


</code></pre>

<hr>
<h2 id='importPhyloseq'>Import Phyloseq object for PARAFAC modelling</h2><span id='topic+importPhyloseq'></span>

<h3>Description</h3>

<p>Import Phyloseq object for PARAFAC modelling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importPhyloseq(phyloseqObject, subjectIDs, thirdMode)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="importPhyloseq_+3A_phyloseqobject">phyloseqObject</code></td>
<td>
<p>Phyloseq object containing at least an otu table and sample data, preferably also taxonomic information.</p>
</td></tr>
<tr><td><code id="importPhyloseq_+3A_subjectids">subjectIDs</code></td>
<td>
<p>Column name in sam_data corresponding to the subject IDs.</p>
</td></tr>
<tr><td><code id="importPhyloseq_+3A_thirdmode">thirdMode</code></td>
<td>
<p>Column name in sam_data corresponding to the study design aspect to put in the third mode of the data cube.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object containing:
</p>

<ul>
<li><p> 'data': data cube
</p>
</li>
<li><p> 'mode1': metadata of the subject mode
</p>
</li>
<li><p> 'mode2': taxonomy information
</p>
</li>
<li><p> 'mode3': metadata of the third mode
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
library(phyloseq)
data(GlobalPatterns)
GP = GlobalPatterns

# Add custom subject IDs to the sample data to make this example work
alteredSampleData = sample_data(GP)
alteredSampleData$subjectID = c(1,2,3,1,2,1,2,3,1,2,1,2,1,2,3,1,2,3,1,2,3,4,5,1,2,3)
df = phyloseq(otu_table(GP), tax_table(GP), alteredSampleData)

# Make a data cube with SampleType (soil, feces, etc.) as the third mode.
result = importPhyloseq(df, subjectIDs = "subjectID", thirdMode="SampleType")

</code></pre>

<hr>
<h2 id='importTreeSummarizedExperiment'>Import TreeSummarizedExperiment object for PARAFAC modelling</h2><span id='topic+importTreeSummarizedExperiment'></span>

<h3>Description</h3>

<p>Import TreeSummarizedExperiment object for PARAFAC modelling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importTreeSummarizedExperiment(
  treeObject,
  subjectIDs,
  thirdMode,
  taxa_are_rows
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="importTreeSummarizedExperiment_+3A_treeobject">treeObject</code></td>
<td>
<p>TreeSummarizedExperiment object containing at least an OTU table and sample information, preferably also taxonomic information.</p>
</td></tr>
<tr><td><code id="importTreeSummarizedExperiment_+3A_subjectids">subjectIDs</code></td>
<td>
<p>Column name in the sample information corresponding to the subject IDs.</p>
</td></tr>
<tr><td><code id="importTreeSummarizedExperiment_+3A_thirdmode">thirdMode</code></td>
<td>
<p>Column name in the sample information corresponding to the study design aspect to put in the third mode of the data cube.</p>
</td></tr>
<tr><td><code id="importTreeSummarizedExperiment_+3A_taxa_are_rows">taxa_are_rows</code></td>
<td>
<p>Boolean specifying if the taxa are in the rows of the OTU table (TRUE) or not (FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object containing:
</p>

<ul>
<li><p> 'data': data cube
</p>
</li>
<li><p> 'mode1': metadata of the subject mode
</p>
</li>
<li><p> 'mode2': taxonomy information
</p>
</li>
<li><p> 'mode3': metadata of the third mode
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
library(TreeSummarizedExperiment)

fakeOTU = t(rTensor::k_unfold(rTensor::as.tensor(Fujita2023$data), 2)@data)
fakeTaxa = as.matrix(Fujita2023$mode2)
fakeSam = as.data.frame(cbind(rep(1:8, 110), rep(1:110, each=8)))
colnames(fakeSam) = c("replicate.id", "timepoint")

fakeTreeObj = TreeSummarizedExperiment(assays = list(Count = fakeOTU),
                                      rowData = fakeSam,
                                      colData = fakeTaxa)
dataset = importTreeSummarizedExperiment(fakeTreeObj,
                                         subjectIDs="replicate.id",
                                         thirdMode="timepoint",
                                         taxa_are_rows=FALSE)

</code></pre>

<hr>
<h2 id='initializePARAFAC'>Initialize PARAFAC algorithm input vectors</h2><span id='topic+initializePARAFAC'></span>

<h3>Description</h3>

<p>Initialize PARAFAC algorithm input vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializePARAFAC(Tensor, nfac, initialization = "random", output = "Fac")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initializePARAFAC_+3A_tensor">Tensor</code></td>
<td>
<p>Input dataset matrix or tensor</p>
</td></tr>
<tr><td><code id="initializePARAFAC_+3A_nfac">nfac</code></td>
<td>
<p>Number of components to initialize.</p>
</td></tr>
<tr><td><code id="initializePARAFAC_+3A_initialization">initialization</code></td>
<td>
<p>Either &quot;random&quot; for random initialization or &quot;svd&quot; for svd based.</p>
</td></tr>
<tr><td><code id="initializePARAFAC_+3A_output">output</code></td>
<td>
<p>Output the initialized components as a Fac object (&quot;Fac&quot;, default) or as a vector (&quot;vect&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fac or vector with initialized components.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = array(rnorm(108,2), c(108,2))
B = array(rnorm(100,2), c(100,2))
C = array(rnorm(10,2), c(10,2))
Tensor = reinflateTensor(A, B, C, returnAsTensor=TRUE)
init = initializePARAFAC(Tensor, 2)
</code></pre>

<hr>
<h2 id='multiwayCenter'>Center a multi-way array</h2><span id='topic+multiwayCenter'></span>

<h3>Description</h3>

<p>Center a multi-way array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiwayCenter(X, mode = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiwayCenter_+3A_x">X</code></td>
<td>
<p>Multi-way array</p>
</td></tr>
<tr><td><code id="multiwayCenter_+3A_mode">mode</code></td>
<td>
<p>Mode to center across (default 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Centered multi-way array
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cube_cnt = multiwayCenter(Fujita2023$data)
</code></pre>

<hr>
<h2 id='multiwayCLR'>Perform a centered log-ratio transform over a multi-way array</h2><span id='topic+multiwayCLR'></span>

<h3>Description</h3>

<p>Note: Propagates NAs corresponding to missing samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiwayCLR(X, pseudocount = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiwayCLR_+3A_x">X</code></td>
<td>
<p>Multi-way array of counts</p>
</td></tr>
<tr><td><code id="multiwayCLR_+3A_pseudocount">pseudocount</code></td>
<td>
<p>Pseudocount value to use (default 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>CLRed cube
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cubeCLR = multiwayCLR(Fujita2023$data)
</code></pre>

<hr>
<h2 id='multiwayScale'>Scale a multi-way array</h2><span id='topic+multiwayScale'></span>

<h3>Description</h3>

<p>Scale a multi-way array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiwayScale(X, mode = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiwayScale_+3A_x">X</code></td>
<td>
<p>Multi-way array</p>
</td></tr>
<tr><td><code id="multiwayScale_+3A_mode">mode</code></td>
<td>
<p>Mode to scale within: 1=subjects,2=features,3=time (default 2).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scaled multi-way array
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cube_scl = multiwayCenter(Fujita2023$data)
</code></pre>

<hr>
<h2 id='parafac'>Parallel Factor Analysis</h2><span id='topic+parafac'></span>

<h3>Description</h3>

<p>Parallel Factor Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parafac(
  Tensor,
  nfac,
  nstart = 1,
  maxit = 500,
  max_fn = 10000,
  ctol = 1e-04,
  rel_tol = 1e-08,
  abs_tol = 1e-08,
  grad_tol = 1e-08,
  initialization = "random",
  method = "als",
  verbose = FALSE,
  output = "best",
  sortComponents = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parafac_+3A_tensor">Tensor</code></td>
<td>
<p>3-way matrix of numeric data</p>
</td></tr>
<tr><td><code id="parafac_+3A_nfac">nfac</code></td>
<td>
<p>Number of factors (components) to fit.</p>
</td></tr>
<tr><td><code id="parafac_+3A_nstart">nstart</code></td>
<td>
<p>Number of models to randomly initialize (default 1).</p>
</td></tr>
<tr><td><code id="parafac_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations allowed without convergence in the ALS case (default 500).</p>
</td></tr>
<tr><td><code id="parafac_+3A_max_fn">max_fn</code></td>
<td>
<p>Maximum number of function evaluations allowed without convergence in the OPT case (default 10000).</p>
</td></tr>
<tr><td><code id="parafac_+3A_ctol">ctol</code></td>
<td>
<p>Relative change in loss tolerated to call the algorithm converged in the ALS case (default 1e-4).</p>
</td></tr>
<tr><td><code id="parafac_+3A_rel_tol">rel_tol</code></td>
<td>
<p>Relative change in loss tolerated to call the algorithm converged in the OPT case (default 1e-8).</p>
</td></tr>
<tr><td><code id="parafac_+3A_abs_tol">abs_tol</code></td>
<td>
<p>Absolute loss tolerated to call the algorithm converged in the OPT case (default 1e-8).</p>
</td></tr>
<tr><td><code id="parafac_+3A_grad_tol">grad_tol</code></td>
<td>
<p>Tolerance on the two-norm of the gradient divided over the number of elements in the gradient in the OPT case (default 1e-8).</p>
</td></tr>
<tr><td><code id="parafac_+3A_initialization">initialization</code></td>
<td>
<p>&quot;Random&quot; for randomly initialized input vectors or &quot;nvec&quot; for svd-based best guess.</p>
</td></tr>
<tr><td><code id="parafac_+3A_method">method</code></td>
<td>
<p>Use ALS algorithm (&quot;als&quot;, default) or use all-at-once optimization (&quot;opt&quot;). The all-at-once optimization is based on a nonlinear conjugate gradient method with Hestenes-Stiefel updates and the More-Thuente line search algorithm.</p>
</td></tr>
<tr><td><code id="parafac_+3A_verbose">verbose</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> verbose output</p>
</td></tr>
<tr><td><code id="parafac_+3A_output">output</code></td>
<td>
<p>String (&quot;best&quot;/&quot;all&quot;) Return only the best model of the nstart models (&quot;best&quot;) or return all of them in a list object (&quot;all&quot;).</p>
</td></tr>
<tr><td><code id="parafac_+3A_sortcomponents">sortComponents</code></td>
<td>
<p>Boolean to sort the components based on their variance explained (default FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object of the PARAFAC model or models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = array(rnorm(108*100*10), c(108,100,10))
model = parafac(X, 2)
</code></pre>

<hr>
<h2 id='parafac_core_als'>Internal PARAFAC alternating least-squares (ALS) core algorithm</h2><span id='topic+parafac_core_als'></span>

<h3>Description</h3>

<p>Internal PARAFAC alternating least-squares (ALS) core algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parafac_core_als(Tensor, nfac, init, maxit = 500, ctol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parafac_core_als_+3A_tensor">Tensor</code></td>
<td>
<p>Tensor data object</p>
</td></tr>
<tr><td><code id="parafac_core_als_+3A_nfac">nfac</code></td>
<td>
<p>Number of components to compute</p>
</td></tr>
<tr><td><code id="parafac_core_als_+3A_init">init</code></td>
<td>
<p>Initialization from <a href="#topic+initializePARAFAC">initializePARAFAC</a>.</p>
</td></tr>
<tr><td><code id="parafac_core_als_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations to run (default 500).</p>
</td></tr>
<tr><td><code id="parafac_core_als_+3A_ctol">ctol</code></td>
<td>
<p>Loss function tolerance for convergence (default 1e-4)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing a Fac object and the loss per iteration
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = array(rnorm(108*2), c(108,2))
B = array(rnorm(100*2), c(100,2))
C = array(rnorm(10*2), c(10,2))
Tensor = reinflateTensor(A, B, C)
init = initializePARAFAC(Tensor, 2)
model = parafac_core_als(Tensor, 2, init)
</code></pre>

<hr>
<h2 id='parafac_fun'>PARAFAC loss function calculation</h2><span id='topic+parafac_fun'></span>

<h3>Description</h3>

<p>PARAFAC loss function calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parafac_fun(x, Tensor, lambdas = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parafac_fun_+3A_x">x</code></td>
<td>
<p>Vector of fitted loadings generated by the PARAFAC algorithm, can also be a Fac object</p>
</td></tr>
<tr><td><code id="parafac_fun_+3A_tensor">Tensor</code></td>
<td>
<p>input data</p>
</td></tr>
<tr><td><code id="parafac_fun_+3A_lambdas">lambdas</code></td>
<td>
<p>If lambdas (from the kruskal tensor case) are generated to make the Fac norm 1, they can be supplied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar value of the loss function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = array(rnorm(108*2), c(108,2))
B = array(rnorm(100*2), c(100,2))
C = array(rnorm(10*2), c(10,2))
X = reinflateTensor(A, B, C)
model = parafac(X, 2)
f = parafac_fun(model$Fac, X)
</code></pre>

<hr>
<h2 id='parafac_gradient'>Calculate gradient of PARAFAC model.</h2><span id='topic+parafac_gradient'></span>

<h3>Description</h3>

<p>Calculate gradient of PARAFAC model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parafac_gradient(x, Tensor)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parafac_gradient_+3A_x">x</code></td>
<td>
<p>Vector of fitted loadings generated by the PARAFAC algorithm, can also be a Fac object</p>
</td></tr>
<tr><td><code id="parafac_gradient_+3A_tensor">Tensor</code></td>
<td>
<p>input data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Gradient of the PARAFAC model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = array(rnorm(108*2), c(108,2))
B = array(rnorm(100*2), c(100,2))
C = array(rnorm(10*2), c(10,2))
X = reinflateTensor(A, B, C)
init = initializePARAFAC(X, 2)
g = parafac_gradient(init, X)
</code></pre>

<hr>
<h2 id='plotModelMetric'>Plot diagnostics of many initialized PARAFAC models.</h2><span id='topic+plotModelMetric'></span>

<h3>Description</h3>

<p>Plot diagnostics of many initialized PARAFAC models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotModelMetric(
  metric,
  plottingMode = "box",
  ylabel = "metric",
  titleString = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotModelMetric_+3A_metric">metric</code></td>
<td>
<p>Matrix of metrics per initialized model (number of models x number of components).</p>
</td></tr>
<tr><td><code id="plotModelMetric_+3A_plottingmode">plottingMode</code></td>
<td>
<p>Plot the metrics as a box plot (&quot;box&quot;, default) or as a bar plot (&quot;bar&quot;).</p>
</td></tr>
<tr><td><code id="plotModelMetric_+3A_ylabel">ylabel</code></td>
<td>
<p>String of the y axis label (default &quot;metric&quot;).</p>
</td></tr>
<tr><td><code id="plotModelMetric_+3A_titlestring">titleString</code></td>
<td>
<p>String of the plot title (default &quot;&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the metrics
</p>


<h3>Examples</h3>

<pre><code class='language-R'>varExp = array(runif(100*2, min=50, max=100), c(100,2))
plotModelMetric(varExp, plottingMode="box", ylabel="Variation explained (%)")
</code></pre>

<hr>
<h2 id='plotModelStability'>Plot a summary of the loadings of many initialized parafac models.</h2><span id='topic+plotModelStability'></span>

<h3>Description</h3>

<p>Plot a summary of the loadings of many initialized parafac models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotModelStability(
  models,
  dataset,
  colourCols = NULL,
  legendTitles = NULL,
  xLabels = NULL,
  legendColNums = NULL,
  arrangeModes = NULL,
  continuousModes = NULL,
  overallTitle = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotModelStability_+3A_models">models</code></td>
<td>
<p>Models list output from <code><a href="#topic+parafac">parafac()</a></code> using output=&quot;all&quot;.</p>
</td></tr>
<tr><td><code id="plotModelStability_+3A_dataset">dataset</code></td>
<td>
<p>A longitudinal microbiome dataset, ideally processed with <code><a href="#topic+processDataCube">processDataCube()</a></code>, formatted as follows:
</p>

<dl>
<dt>data</dt><dd><p>Array object of the data cube</p>
</dd>
<dt>mode1</dt><dd><p>Dataframe with all the subject metadata, ordered the same as the rows in the data cube.</p>
</dd>
<dt>mode2</dt><dd><p>Taxonomic classification of the microbiota, ordered the same as the columns in the data cube.</p>
</dd>
<dt>mode3</dt><dd><p>Dataframe with the time metadata, ordered the same as the third dimension in the array.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="plotModelStability_+3A_colourcols">colourCols</code></td>
<td>
<p>Vector of strings stating which column names should be factorized for colours per mode.</p>
</td></tr>
<tr><td><code id="plotModelStability_+3A_legendtitles">legendTitles</code></td>
<td>
<p>Vector of strings stating the legend title per mode.</p>
</td></tr>
<tr><td><code id="plotModelStability_+3A_xlabels">xLabels</code></td>
<td>
<p>Vector of strings stating the x-axis labels per mode.</p>
</td></tr>
<tr><td><code id="plotModelStability_+3A_legendcolnums">legendColNums</code></td>
<td>
<p>Vector of integers stating the desired number of columns for the legends per mode.</p>
</td></tr>
<tr><td><code id="plotModelStability_+3A_arrangemodes">arrangeModes</code></td>
<td>
<p>Vector of boolean values per mode, stating if the loadings should be arranged according to colourCols (TRUE) or not (FALSE).</p>
</td></tr>
<tr><td><code id="plotModelStability_+3A_continuousmodes">continuousModes</code></td>
<td>
<p>Vector of boolean values per mode, stating if the loadings should be plotted as a line plot (TRUE) or a bar plot (FALSE).</p>
</td></tr>
<tr><td><code id="plotModelStability_+3A_overalltitle">overallTitle</code></td>
<td>
<p>Overall title of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of loadings with error bars
</p>


<h3>Examples</h3>

<pre><code class='language-R'>processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2)
models = parafac(processedFujita$data, 2, nstart=10, output="all")
plotModelStability(models, processedFujita)
</code></pre>

<hr>
<h2 id='plotModelTCCs'>Plots Tucker Congruence Coefficients of randomly initialized models.</h2><span id='topic+plotModelTCCs'></span>

<h3>Description</h3>

<p>Plots Tucker Congruence Coefficients of randomly initialized models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotModelTCCs(models)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotModelTCCs_+3A_models">models</code></td>
<td>
<p>Models list output of <code><a href="#topic+parafac">parafac()</a></code> using output=&quot;all&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of TCCs
</p>


<h3>Examples</h3>

<pre><code class='language-R'>processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2)
models = parafac(processedFujita$data, 3, nstart=10, output="all")
plotModelTCCs(models)
</code></pre>

<hr>
<h2 id='plotPARAFACmodel'>Plot a PARAFAC model</h2><span id='topic+plotPARAFACmodel'></span>

<h3>Description</h3>

<p>Plot a PARAFAC model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPARAFACmodel(
  model,
  dataset,
  numComponents,
  colourCols = NULL,
  legendTitles = NULL,
  xLabels = NULL,
  legendColNums = NULL,
  arrangeModes = NULL,
  continuousModes = NULL,
  overallTitle = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPARAFACmodel_+3A_model">model</code></td>
<td>
<p>Model output from <code><a href="#topic+parafac">parafac()</a></code>.</p>
</td></tr>
<tr><td><code id="plotPARAFACmodel_+3A_dataset">dataset</code></td>
<td>
<p>A longitudinal microbiome dataset, ideally processed with <code><a href="#topic+processDataCube">processDataCube()</a></code>, formatted as follows:
</p>

<dl>
<dt>data</dt><dd><p>Array object of the data cube</p>
</dd>
<dt>mode1</dt><dd><p>Dataframe with all the subject metadata, ordered the same as the rows in the data cube.</p>
</dd>
<dt>mode2</dt><dd><p>Taxonomic classification of the microbiota, ordered the same as the columns in the data cube.</p>
</dd>
<dt>mode3</dt><dd><p>Dataframe with the time metadata, ordered the same as the third dimension in the array.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="plotPARAFACmodel_+3A_numcomponents">numComponents</code></td>
<td>
<p>Number of PARAFAC components in the model.</p>
</td></tr>
<tr><td><code id="plotPARAFACmodel_+3A_colourcols">colourCols</code></td>
<td>
<p>Vector of strings stating which column names should be factorized for colours per mode.</p>
</td></tr>
<tr><td><code id="plotPARAFACmodel_+3A_legendtitles">legendTitles</code></td>
<td>
<p>Vector of strings stating the legend title per mode.</p>
</td></tr>
<tr><td><code id="plotPARAFACmodel_+3A_xlabels">xLabels</code></td>
<td>
<p>Vector of strings stating the x-axis labels per mode.</p>
</td></tr>
<tr><td><code id="plotPARAFACmodel_+3A_legendcolnums">legendColNums</code></td>
<td>
<p>Vector of integers stating the desired number of columns for the legends per mode.</p>
</td></tr>
<tr><td><code id="plotPARAFACmodel_+3A_arrangemodes">arrangeModes</code></td>
<td>
<p>Vector of boolean values per mode, stating if the loadings should be arranged according to colourCols (TRUE) or not (FALSE).</p>
</td></tr>
<tr><td><code id="plotPARAFACmodel_+3A_continuousmodes">continuousModes</code></td>
<td>
<p>Vector of boolean values per mode, stating if the loadings should be plotted as a line plot (TRUE) or a bar plot (FALSE).</p>
</td></tr>
<tr><td><code id="plotPARAFACmodel_+3A_overalltitle">overallTitle</code></td>
<td>
<p>Overall title of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(multiway)
library(dplyr)
library(ggplot2)
set.seed(0)

# Process the data
processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.9, centerMode=1, scaleMode=2)

# Make PARAFAC model
model = parafac(processedFujita$data, nfac=2, nstart=10, verbose=FALSE)

# Make plot
plotPARAFACmodel(model, processedFujita,
  numComponents = 2,
  colourCols = c("", "Genus", ""),
  legendTitles = c("", "Genus", ""),
  xLabels = c("Replicate", "Feature index", "Time point"),
  legendColNums = c(0,5,0),
  arrangeModes = c(FALSE, TRUE, FALSE),
  continuousModes = c(FALSE,FALSE,TRUE),
  overallTitle = "Fujita PARAFAC model")

</code></pre>

<hr>
<h2 id='processDataCube'>Process a multi-way array of count data.</h2><span id='topic+processDataCube'></span>

<h3>Description</h3>

<p>Process a multi-way array of count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>processDataCube(
  dataset,
  sparsityThreshold = 1,
  considerGroups = FALSE,
  groupVariable = "",
  CLR = TRUE,
  centerMode = 0,
  scaleMode = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="processDataCube_+3A_dataset">dataset</code></td>
<td>
<p>A longitudinal microbiome dataset, formatted as follows:
</p>

<dl>
<dt>data</dt><dd><p>Array object of the data cube filled with counts</p>
</dd>
<dt>mode1</dt><dd><p>Dataframe with all the subject metadata, ordered the same as the rows in the data cube.</p>
</dd>
<dt>mode2</dt><dd><p>Taxonomic classification of the microbiota, ordered the same as the columns in the data cube.</p>
</dd>
<dt>mode3</dt><dd><p>Dataframe with the time metadata, ordered the same as the third dimension in the array.</p>
</dd>
</dl>

<p>See <a href="#topic+Fujita2023">Fujita2023</a>, <a href="#topic+Shao2019">Shao2019</a> or <a href="#topic+vanderPloeg2024">vanderPloeg2024</a> for more information.</p>
</td></tr>
<tr><td><code id="processDataCube_+3A_sparsitythreshold">sparsityThreshold</code></td>
<td>
<p>Maximum sparsity for a feature to be selected (default=1, i.e. do not select features).</p>
</td></tr>
<tr><td><code id="processDataCube_+3A_considergroups">considerGroups</code></td>
<td>
<p>Consider groups when calculating sparsity (default=FALSE).</p>
</td></tr>
<tr><td><code id="processDataCube_+3A_groupvariable">groupVariable</code></td>
<td>
<p>Column name in dataset$mode1 that should be used to consider groups (default=&quot;&quot;).</p>
</td></tr>
<tr><td><code id="processDataCube_+3A_clr">CLR</code></td>
<td>
<p>Perform a centered log-ratio transformation of the count data (default=TRUE).</p>
</td></tr>
<tr><td><code id="processDataCube_+3A_centermode">centerMode</code></td>
<td>
<p>Mode to center across: 1=subjects,2=features,3=time (default 0, i.e. do not center). See <code><a href="#topic+multiwayCenter">multiwayCenter()</a></code> for more information.</p>
</td></tr>
<tr><td><code id="processDataCube_+3A_scalemode">scaleMode</code></td>
<td>
<p>Mode to scale within: 1=subjects,2=features,3=time (default 0, i.e. do not scale). See <code><a href="#topic+multiwayScale">multiwayScale()</a></code> for more information.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>CLRed, centered and scaled cube
</p>


<h3>Examples</h3>

<pre><code class='language-R'>processedCube = processDataCube(Fujita2023)
</code></pre>

<hr>
<h2 id='reinflateFac'>Calculate Xhat from a model Fac object</h2><span id='topic+reinflateFac'></span>

<h3>Description</h3>

<p>Calculate Xhat from a model Fac object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reinflateFac(Fac, X, returnAsTensor = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reinflateFac_+3A_fac">Fac</code></td>
<td>
<p>Fac object from parafac</p>
</td></tr>
<tr><td><code id="reinflateFac_+3A_x">X</code></td>
<td>
<p>Input data X</p>
</td></tr>
<tr><td><code id="reinflateFac_+3A_returnastensor">returnAsTensor</code></td>
<td>
<p>Boolean to return Xhat as rTensor tensor (TRUE) or matrix (default, FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Xhat
</p>


<h3>Examples</h3>

<pre><code class='language-R'>processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2)
model = parafac(processedFujita$data, nfac=1, nstart=1, verbose=FALSE)
Xhat = reinflateFac(model$Fac, processedFujita$data)
</code></pre>

<hr>
<h2 id='reinflateTensor'>Create a tensor out of a set of matrices similar to a component model.</h2><span id='topic+reinflateTensor'></span>

<h3>Description</h3>

<p>Create a tensor out of a set of matrices similar to a component model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reinflateTensor(A, B, C, returnAsTensor = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reinflateTensor_+3A_a">A</code></td>
<td>
<p>I x N matrix corresponding to loadings in the first mode for N components.</p>
</td></tr>
<tr><td><code id="reinflateTensor_+3A_b">B</code></td>
<td>
<p>J x N matrix corresponding to loadings in the second mode for N components.</p>
</td></tr>
<tr><td><code id="reinflateTensor_+3A_c">C</code></td>
<td>
<p>K x N matrix corresponding to loadings in the third mode for N components.</p>
</td></tr>
<tr><td><code id="reinflateTensor_+3A_returnastensor">returnAsTensor</code></td>
<td>
<p>Boolean return as rTensor S4 tensor object (default FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>M, an I x J x K tensor.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A = rnorm(108)
B = rnorm(100)
C = rnorm(10)
M = reinflateTensor(A,B,C)
</code></pre>

<hr>
<h2 id='Shao2019'>Shao2019 longitudinal microbiome data</h2><span id='topic+Shao2019'></span>

<h3>Description</h3>

<p>The Shao2019 longitudinal microbiome dataset as a three-dimensional array,
with subjects in mode 1, microbial abundances in mode 2 and time in mode 3.
Note: only time points 4, 7, 21 and Infancy are used.
Note: all-zero microbial abundances have been removed to save disk space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Shao2019
</code></pre>


<h3>Format</h3>



<h4><code>Shao2019</code></h4>

<p>A list object with three elements:
</p>

<dl>
<dt>data</dt><dd><p>Array object of the data cube</p>
</dd>
<dt>mode1</dt><dd><p>Dataframe with all the subject metadata, ordered the same as the rows in the data cube.</p>
</dd>
<dt>mode2</dt><dd><p>Taxonomic classification of the microbiota, ordered the same as the columns in the data cube.</p>
</dd>
<dt>mode3</dt><dd><p>Dataframe with the time metadata, ordered the same as the third dimension in the array.</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://doi.org/10.1038/s41586-019-1560-1">doi:10.1038/s41586-019-1560-1</a>
</p>

<hr>
<h2 id='sortComponents'>Sort PARAFAC components based on variance explained per component.</h2><span id='topic+sortComponents'></span>

<h3>Description</h3>

<p>Sort PARAFAC components based on variance explained per component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sortComponents(Fac, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sortComponents_+3A_fac">Fac</code></td>
<td>
<p>Fac object output of a <a href="#topic+parafac">parafac</a> model</p>
</td></tr>
<tr><td><code id="sortComponents_+3A_x">X</code></td>
<td>
<p>Input data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fac object of sorted components
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = array(rnorm(108*100*10), c(108,100,10))
model = parafac(X, 2)
sortedFac = sortComponents(model$Fac, X)
</code></pre>

<hr>
<h2 id='transformPARAFACloadings'>Transform PARAFAC loadings to an orthonormal basis.
Note: this function only works for 3-way PARAFAC models.</h2><span id='topic+transformPARAFACloadings'></span>

<h3>Description</h3>

<p>Transform PARAFAC loadings to an orthonormal basis.
Note: this function only works for 3-way PARAFAC models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformPARAFACloadings(Fac, modeToCorrect, moreOutput = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformPARAFACloadings_+3A_fac">Fac</code></td>
<td>
<p>Fac object from a PARAFAC object, see <code><a href="#topic+parafac">parafac()</a></code>.</p>
</td></tr>
<tr><td><code id="transformPARAFACloadings_+3A_modetocorrect">modeToCorrect</code></td>
<td>
<p>Correct the subject (1), feature (2) or time mode (3).</p>
</td></tr>
<tr><td><code id="transformPARAFACloadings_+3A_moreoutput">moreOutput</code></td>
<td>
<p>Give orthonormal basis and transformation matrices as part of output (default FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Corrected loadings of the specified mode.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>processedFujita = processDataCube(Fujita2023, sparsityThreshold=0.99, centerMode=1, scaleMode=2)
model = parafac(processedFujita$data, nfac=2, nstart=1, verbose=FALSE)
transformedA = transformPARAFACloadings(model$Fac, 1)
</code></pre>

<hr>
<h2 id='vanderPloeg2024'>vanderPloeg2024 longitudinal microbiome data</h2><span id='topic+vanderPloeg2024'></span>

<h3>Description</h3>

<p>The vanderPloeg2024 longitudinal microbiome dataset as a three-dimensional array,
with subjects in mode 1, microbial abundances in mode 2, and time in mode 3.
Note: all-zero microbial abundances have been removed to save disk space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vanderPloeg2024
</code></pre>


<h3>Format</h3>



<h4><code>vanderPloeg2024</code></h4>

<p>A list object with three elements:
</p>

<dl>
<dt>data</dt><dd><p>Array object of the data cube</p>
</dd>
<dt>mode1</dt><dd><p>Dataframe with all the subject metadata, ordered the same as the rows in the data cube.</p>
</dd>
<dt>mode2</dt><dd><p>Taxonomic classification of the microbiota, ordered the same as the columns in the data cube.</p>
</dd>
<dt>mode3</dt><dd><p>Dataframe with the time metadata, ordered the same as the third dimension in the array.</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://doi.org/10.1101/2024.03.18.585469">doi:10.1101/2024.03.18.585469</a>
</p>

<hr>
<h2 id='vect_to_fac'>Convert vectorized output of PARAFAC to a Fac list object with all loadings per mode.</h2><span id='topic+vect_to_fac'></span>

<h3>Description</h3>

<p>Convert vectorized output of PARAFAC to a Fac list object with all loadings per mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vect_to_fac(vect, X, sortComponents = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vect_to_fac_+3A_vect">vect</code></td>
<td>
<p>Vectorized output of PARAFAC modelling</p>
</td></tr>
<tr><td><code id="vect_to_fac_+3A_x">X</code></td>
<td>
<p>Input data</p>
</td></tr>
<tr><td><code id="vect_to_fac_+3A_sortcomponents">sortComponents</code></td>
<td>
<p>Sort the order of the components by variation explained (default FALSE).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fac: list object with all loadings in all components per mode, ordered the same way as Z$modes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
A = array(rnorm(108*2), c(108, 2))
B = array(rnorm(100*2), c(100, 2))
C = array(rnorm(10*2), c(10, 2))

X = reinflateTensor(A, B, C)
result = initializePARAFAC(X, 2, initialization="random", output="vect")
Fac = vect_to_fac(result, X)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
