<!DOCTYPE html><html><head><title>Help for package MSSQL</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MSSQL}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MSSQL-package'><p>Tools to Work with Microsoft SQL Server Databases via RODBC</p></a></li>
<li><a href='#dbOverview'><p>Overview of Tables and Views</p></a></li>
<li><a href='#dbStorage'><p>Storage Size</p></a></li>
<li><a href='#dbTime'><p>Time Created and Modified</p></a></li>
<li><a href='#tableDim'><p>Table Dimensions</p></a></li>
<li><a href='#tableHead'><p>First Rows</p></a></li>
<li><a href='#tableNcol'><p>Number of Columns</p></a></li>
<li><a href='#tableNrow'><p>Number of Rows</p></a></li>
<li><a href='#tableOverview'><p>Data Types and Dimensions</p></a></li>
<li><a href='#tableQuote'><p>Quote Table Name</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-03-08</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools to Work with Microsoft SQL Server Databases via 'RODBC'</td>
</tr>
<tr>
<td>Imports:</td>
<td>RODBC</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools that extend the functionality of the 'RODBC' package to work
  with Microsoft SQL Server databases. Makes it easier to browse the database
  and examine individual tables and views.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-08 11:23:37 UTC; arnima</td>
</tr>
<tr>
<td>Author:</td>
<td>Arni Magnusson [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Arni Magnusson &lt;thisisarni@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-10 19:30:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='MSSQL-package'>Tools to Work with Microsoft SQL Server Databases via RODBC</h2><span id='topic+MSSQL-package'></span><span id='topic+MSSQL'></span>

<h3>Description</h3>

<p>Tools that extend the functionality of the <span class="pkg">RODBC</span> package to work with
Microsoft SQL Server databases. Makes it easier to browse the database and
examine individual tables and views.
</p>


<h3>Details</h3>

<p><em>Browse database:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+dbOverview">dbOverview</a></code> </td><td style="text-align: left;"> Dimensions and column names</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+dbStorage">dbStorage</a></code>  </td><td style="text-align: left;"> Storage size</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+dbTime">dbTime</a></code>     </td><td style="text-align: left;"> Time created and modified
</td>
</tr>

</table>

<p><em>Browse table:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+tableDim">tableDim</a></code>      </td><td style="text-align: left;"> Dimensions</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+tableHead">tableHead</a></code>     </td><td style="text-align: left;"> First rows</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+tableNcol">tableNcol</a></code>     </td><td style="text-align: left;"> Number of columns</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+tableNrow">tableNrow</a></code>     </td><td style="text-align: left;"> Number of rows</td>
</tr>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+tableOverview">tableOverview</a></code> </td><td style="text-align: left;"> Data types and dimensions
</td>
</tr>

</table>

<p><em>Helper functions:</em>
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code><a href="#topic+tableQuote">tableQuote</a></code> </td><td style="text-align: left;"> Quote table name
</td>
</tr>

</table>



<h3>Note</h3>

<p><code>browseVignettes()</code> shows a vignette with implementation notes.
</p>


<h3>Author(s)</h3>

<p>Arni Magnusson.
</p>


<h3>See Also</h3>

<p>This package complements the <span class="pkg">RODBC</span> package and does not replace the
standard query methods.
</p>
<p>For example, the user may find <code><a href="#topic+dbOverview">dbOverview</a></code> and
<code><a href="#topic+tableOverview">tableOverview</a></code> more convenient than the underlying
<code><a href="RODBC.html#topic+sqlTables">sqlTables</a></code> and <code><a href="RODBC.html#topic+sqlColumns">sqlColumns</a></code>, but to query the
database <code>sqlQuery</code> or <code>sqlFetch</code> are still used in the normal way.
</p>

<hr>
<h2 id='dbOverview'>Overview of Tables and Views</h2><span id='topic+dbOverview'></span>

<h3>Description</h3>

<p>Get dimensions and first few column names of tables and views in a database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbOverview(channel, schema = "dbo", dim = TRUE, peek = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbOverview_+3A_channel">channel</code></td>
<td>
<p>an RODBC connection.</p>
</td></tr>
<tr><td><code id="dbOverview_+3A_schema">schema</code></td>
<td>
<p>database schema.</p>
</td></tr>
<tr><td><code id="dbOverview_+3A_dim">dim</code></td>
<td>
<p>whether to calculate the number of rows and columns for each
table/view.</p>
</td></tr>
<tr><td><code id="dbOverview_+3A_peek">peek</code></td>
<td>
<p>how many column names to show. The value <code>FALSE</code> has the
same effect as zero.</p>
</td></tr>
<tr><td><code id="dbOverview_+3A_...">...</code></td>
<td>
<p>passed to <code>sqlTables</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>dim = FALSE</code> option results in faster computation, but the
<code style="white-space: pre;">&#8288;Rows&#8288;</code> and <code style="white-space: pre;">&#8288;Cols&#8288;</code> columns will only contain <code>NA</code> values.
Similarly, the <code>peek = FALSE</code> results in faster computation, but the
<code style="white-space: pre;">&#8288;First&#8288;</code> column will only contain <code>NA</code> values. These options can be
useful to get a quick overview of a large database.
</p>


<h3>Value</h3>

<p>Data frame containing six columns:
</p>
<table>
<tr><td><code>Name</code></td>
<td>
<p>name of table/view.</p>
</td></tr>
<tr><td><code>Schema</code></td>
<td>
<p>database schema.</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>type of table/view.</p>
</td></tr>
<tr><td><code>Rows</code></td>
<td>
<p>number of rows.</p>
</td></tr>
<tr><td><code>Cols</code></td>
<td>
<p>number of columns.</p>
</td></tr>
<tr><td><code>First</code></td>
<td>
<p>first column names.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="RODBC.html#topic+sqlTables">sqlTables</a></code> is the underlying function used to get the list of
tables/views, <code><a href="#topic+tableDim">tableDim</a></code> is used to count rows and columns, and
<code><a href="RODBC.html#topic+sqlColumns">sqlColumns</a></code> is used to peek at the first column names.
</p>
<p><code><a href="#topic+dbStorage">dbStorage</a></code> shows the storage size of tables and
<code><a href="#topic+dbTime">dbTime</a></code> shows the time when tables/views were created and last
modified.
</p>
<p><code><a href="#topic+MSSQL-package">MSSQL-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
con &lt;- odbcConnect("myDatabase")

dbOverview(con)

dbOverview(con, dim=FALSE, peek=FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='dbStorage'>Storage Size</h2><span id='topic+dbStorage'></span>

<h3>Description</h3>

<p>Get storage size of tables in a database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbStorage(channel, total = TRUE, used = FALSE, unused = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbStorage_+3A_channel">channel</code></td>
<td>
<p>an RODBC connection.</p>
</td></tr>
<tr><td><code id="dbStorage_+3A_total">total</code></td>
<td>
<p>whether to calculate total storage size.</p>
</td></tr>
<tr><td><code id="dbStorage_+3A_used">used</code></td>
<td>
<p>whether to calculate used storage size.</p>
</td></tr>
<tr><td><code id="dbStorage_+3A_unused">unused</code></td>
<td>
<p>whether to calculate unused storage size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing the following columns:
</p>
<table>
<tr><td><code>Name</code></td>
<td>
<p>name of table/view.</p>
</td></tr>
<tr><td><code>Schema</code></td>
<td>
<p>database schema.</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>type of table/view.</p>
</td></tr>
<tr><td><code>Rows</code></td>
<td>
<p>number of rows.</p>
</td></tr>
<tr><td><code>Cols</code></td>
<td>
<p>number of columns.</p>
</td></tr>
</table>
<p>In addition, any of the following columns, depending on which of
<code>total</code>, <code>used</code>, and <code>unused</code> are <code>TRUE</code>:
</p>
<table>
<tr><td><code>TotalKB</code></td>
<td>
<p>total storage size.</p>
</td></tr>
<tr><td><code>UsedKB</code></td>
<td>
<p>used storage size.</p>
</td></tr>
<tr><td><code>UnusedKB</code></td>
<td>
<p>unused storage size.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Based on <a href="https://stackoverflow.com/questions/7892334">https://stackoverflow.com/questions/7892334</a>.
</p>


<h3>See Also</h3>

<p><code><a href="RODBC.html#topic+sqlQuery">sqlQuery</a></code> is the underlying function used to query
<code style="white-space: pre;">&#8288;sys.tables&#8288;</code>, <code style="white-space: pre;">&#8288;sys.indexes&#8288;</code>, <code style="white-space: pre;">&#8288;sys.partitions&#8288;</code>,
<code style="white-space: pre;">&#8288;sys.allocation_units&#8288;</code>, and <code style="white-space: pre;">&#8288;sys.schemas&#8288;</code>.
</p>
<p><code><a href="#topic+dbOverview">dbOverview</a></code> shows the dimensions of tables/views and the first
column names, and <code><a href="#topic+dbTime">dbTime</a></code> shows the time when tables/views were
created and last modified.
</p>
<p><code><a href="utils.html#topic+object.size">object.size</a></code> is the base function to return the storage size of
objects inside the R workspace.
</p>
<p><code><a href="#topic+MSSQL-package">MSSQL-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
con &lt;- odbcConnect("myDatabase")

dbOverview(con)

dbOverview(con, dim=FALSE, peek=FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='dbTime'>Time Created and Modified</h2><span id='topic+dbTime'></span>

<h3>Description</h3>

<p>Get time information about tables and views: when they were created and when
they were last modified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbTime(channel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbTime_+3A_channel">channel</code></td>
<td>
<p>an RODBC connection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing five columns:
</p>
<table>
<tr><td><code>Name</code></td>
<td>
<p>name of table/view.</p>
</td></tr>
<tr><td><code>Schema</code></td>
<td>
<p>database schema.</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>type of table/view.</p>
</td></tr>
<tr><td><code>Created</code></td>
<td>
<p>time created.</p>
</td></tr>
<tr><td><code>Modified</code></td>
<td>
<p>time last modified.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="RODBC.html#topic+sqlQuery">sqlQuery</a></code> is the underlying function used to query
<code style="white-space: pre;">&#8288;sys.tables&#8288;</code> and <code style="white-space: pre;">&#8288;sys.views&#8288;</code>.
</p>
<p><code><a href="#topic+dbOverview">dbOverview</a></code> shows the dimensions of tables/views and the first
column names, and <code><a href="#topic+dbStorage">dbStorage</a></code> shows the storage size of tables.
</p>
<p><code><a href="base.html#topic+Sys.time">Sys.time</a></code> is the base function to show the current time.
</p>
<p><code><a href="#topic+MSSQL-package">MSSQL-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
con &lt;- odbcConnect("myDatabase")

dbTime(con)

## End(Not run)

</code></pre>

<hr>
<h2 id='tableDim'>Table Dimensions</h2><span id='topic+tableDim'></span>

<h3>Description</h3>

<p>Return the number of rows and columns in a database table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableDim(channel, sqtable)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableDim_+3A_channel">channel</code></td>
<td>
<p>an RODBC connection.</p>
</td></tr>
<tr><td><code id="tableDim_+3A_sqtable">sqtable</code></td>
<td>
<p>a database table or view.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of length two, containing the number of rows and columns.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tableNrow">tableNrow</a></code> and <code><a href="#topic+tableNcol">tableNcol</a></code> are the underlying
functions to get the number of rows and columns in a database table.
</p>
<p><code><a href="base.html#topic+dim">dim</a></code> is the base function to return the dimensions for data
frames inside the R workspace.
</p>
<p><code><a href="#topic+MSSQL-package">MSSQL-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
con &lt;- odbcConnect("myDatabase")

tableDim(con, "sysusers")

## End(Not run)

</code></pre>

<hr>
<h2 id='tableHead'>First Rows</h2><span id='topic+tableHead'></span>

<h3>Description</h3>

<p>Return the first rows of a database table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableHead(channel, sqtable, n = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableHead_+3A_channel">channel</code></td>
<td>
<p>an RODBC connection.</p>
</td></tr>
<tr><td><code id="tableHead_+3A_sqtable">sqtable</code></td>
<td>
<p>a database table or view.</p>
</td></tr>
<tr><td><code id="tableHead_+3A_n">n</code></td>
<td>
<p>number of rows to get.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with the first <code>n</code> rows of the database table or view.
</p>


<h3>Note</h3>

<p>This function can be used to examine the structure of a table or view, along
with some example data values.
</p>


<h3>See Also</h3>

<p><code><a href="RODBC.html#topic+sqlQuery">sqlQuery</a></code> with <code><a href="#topic+tableQuote">tableQuote</a></code> are the underlying
functions used to query the table/view.
</p>
<p><code><a href="utils.html#topic+head">head</a></code> is the base function to return the first parts of an
object inside the R workspace.
</p>
<p><code><a href="#topic+tableOverview">tableOverview</a></code> shows the data types and dimensions of a database
table.
</p>
<p><code><a href="#topic+MSSQL-package">MSSQL-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
con &lt;- odbcConnect("myDatabase")

tableHead(con, "sysusers")

t(tableHead(con, "sysusers", 1))

## End(Not run)

</code></pre>

<hr>
<h2 id='tableNcol'>Number of Columns</h2><span id='topic+tableNcol'></span>

<h3>Description</h3>

<p>Return the number of columns in a database table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableNcol(channel, sqtable)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableNcol_+3A_channel">channel</code></td>
<td>
<p>an RODBC connection.</p>
</td></tr>
<tr><td><code id="tableNcol_+3A_sqtable">sqtable</code></td>
<td>
<p>a database table or view.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Number of columns as integer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tableDim">tableDim</a></code> and <code><a href="#topic+tableNrow">tableNrow</a></code> also return the dimensions
of a database table.
</p>
<p><code><a href="RODBC.html#topic+sqlColumns">sqlColumns</a></code> is the underlying function used to examine the table
columns.
</p>
<p><code><a href="base.html#topic+ncol">ncol</a></code> is the base function to return the number of columns for
data frames inside the R workspace.
</p>
<p><code><a href="#topic+MSSQL-package">MSSQL-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
con &lt;- odbcConnect("myDatabase")

tableNcol(con, "sysusers")

## End(Not run)

</code></pre>

<hr>
<h2 id='tableNrow'>Number of Rows</h2><span id='topic+tableNrow'></span>

<h3>Description</h3>

<p>Return the number of rows in a database table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableNrow(channel, sqtable)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableNrow_+3A_channel">channel</code></td>
<td>
<p>an RODBC connection.</p>
</td></tr>
<tr><td><code id="tableNrow_+3A_sqtable">sqtable</code></td>
<td>
<p>a database table or view.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Number of rows as integer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tableDim">tableDim</a></code> and <code><a href="#topic+tableNcol">tableNcol</a></code> also return the dimensions
of a database table.
</p>
<p><code><a href="RODBC.html#topic+sqlQuery">sqlQuery</a></code> is the underlying function used to examine the table
rows.
</p>
<p><code><a href="base.html#topic+nrow">nrow</a></code> is the base function to return the number of rows for data
frames inside the R workspace.
</p>
<p><code><a href="#topic+MSSQL-package">MSSQL-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
con &lt;- odbcConnect("myDatabase")

tableNrow(con, "sysusers")

## End(Not run)

</code></pre>

<hr>
<h2 id='tableOverview'>Data Types and Dimensions</h2><span id='topic+tableOverview'></span>

<h3>Description</h3>

<p>Show data types and dimensions of a database table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableOverview(channel, sqtable, max = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableOverview_+3A_channel">channel</code></td>
<td>
<p>an RODBC connection.</p>
</td></tr>
<tr><td><code id="tableOverview_+3A_sqtable">sqtable</code></td>
<td>
<p>a database table or view.</p>
</td></tr>
<tr><td><code id="tableOverview_+3A_max">max</code></td>
<td>
<p>number of rows to analyze the resulting data frame columns in R.
Pass <code>max = 0</code> to analyze the entire database table.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing <code>Cols</code> and <code>Rows</code>, describing column data types and
the number of rows.
</p>


<h3>See Also</h3>

<p><code><a href="RODBC.html#topic+sqlColumns">sqlColumns</a></code>, <code><a href="RODBC.html#topic+sqlQuery">sqlQuery</a></code>, and <code><a href="#topic+tableNrow">tableNrow</a></code>
are the underlying functions used to examine the table/view.
</p>
<p><code><a href="base.html#topic+class">class</a></code> is the base function to show the class of an object
inside the R workspace.
</p>
<p><code><a href="#topic+tableHead">tableHead</a></code> returns the first rows of a database table.
</p>
<p><code><a href="#topic+MSSQL-package">MSSQL-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
con &lt;- odbcConnect("myDatabase")

tableOverview(con, "sysusers")

tableOverview(con, "sysusers")$Cols

## End(Not run)

</code></pre>

<hr>
<h2 id='tableQuote'>Quote Table Name</h2><span id='topic+tableQuote'></span>

<h3>Description</h3>

<p>Add special quotes around table name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableQuote(sqtable)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableQuote_+3A_sqtable">sqtable</code></td>
<td>
<p>table name, with or without schema name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String with special quotes.
</p>


<h3>Note</h3>

<p>The <code>sqlQuery</code> function requires special quotes if the table name has
spaces. Furthermore, the schema name must not be inside the special quotes.
</p>


<h3>See Also</h3>

<p><code><a href="RODBC.html#topic+sqlQuery">sqlQuery</a></code> requires special quotes if the table name has spaces.
</p>
<p><code><a href="base.html#topic+Quotes">Quotes</a></code> in base R.
</p>
<p><code><a href="#topic+MSSQL-package">MSSQL-package</a></code> gives an overview of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tableQuote("table")
tableQuote("table name")
tableQuote("schema.table")
tableQuote("schema.table name")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
