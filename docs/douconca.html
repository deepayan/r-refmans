<!DOCTYPE html><html lang="en"><head><title>Help for package douconca</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {douconca}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#douconca-package'><p>The package douconca performs double constrained correspondence</p>
analysis for trait-environment analysis in ecology</a></li>
<li><a href='#anova_sites'><p>Utility function: community-level permutation test in Double</p>
Constrained Correspondence Analysis (dc-CA)</a></li>
<li><a href='#anova_species'><p>Utility function: Species-level Permutation Test in Double</p>
Constrained Correspondence Analysis (dc-CA)</a></li>
<li><a href='#anova.dcca'><p>Community- and Species-Level Permutation Test in Double Constrained</p>
Correspondence Analysis (dc-CA)</a></li>
<li><a href='#anova.wrda'><p>Permutation Test for weighted redundancy analysis</p></a></li>
<li><a href='#coef.dcca'><p>Coefficients of double-constrained correspondence analysis (dc-CA)</p></a></li>
<li><a href='#dc_CA'><p>Performs (weighted) double constrained correspondence analysis (dc-CA)</p></a></li>
<li><a href='#dune_trait_env'><p>Dune meadow data with plant species traits and environmental variables</p></a></li>
<li><a href='#fCWM_SNC'><p>Calculate community weighted means and species niche centroids for</p>
double constrained correspondence analysis</a></li>
<li><a href='#fitted.dcca'><p>Fitted values of double-constrained correspondence analysis (dc-CA)</p></a></li>
<li><a href='#getPlotdata'><p>Utility function: extracting data from a <code>dc_CA</code> object for</p>
plotting a single axis by your own code or <code>plot.dcca</code>.</a></li>
<li><a href='#plot_dcCA_CWM_SNC'><p>Plot the CWMs and SNCs of a single dc-CA axis.</p></a></li>
<li><a href='#plot_species_scores_bk'><p>Vertical ggplot2 line plot of ordination scores</p></a></li>
<li><a href='#plot.dcca'><p>Plot a single dc-CA axis with CWMs, SNCs, trait and environment scores.</p></a></li>
<li><a href='#predict.dcca'><p>Prediction for double-constrained correspondence analysis (dc-CA)</p></a></li>
<li><a href='#print.dcca'><p>Print a summary of a dc-CA object.</p></a></li>
<li><a href='#print.wrda'><p>Print a summary of a wrda object</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#scores.dcca'><p>Extract results of a double constrained correspondence analysis</p>
(dc-CA)</a></li>
<li><a href='#scores.wrda'><p>Extract results of a weighted redundancy analysis (wrda)</p></a></li>
<li><a href='#wrda'><p>Performs a weighted redundancy analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Double Constrained Correspondence Analysis for Trait-Environment
Analysis in Ecology</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-02</td>
</tr>
<tr>
<td>Description:</td>
<td>Double constrained correspondence analysis (dc-CA) analyzes 
   (multi-)trait (multi-)environment ecological data by using the 'vegan' 
   package and native R code. Throughout the two step algorithm of ter Braak 
   et al. (2018) is used. This algorithm combines and extends community- 
   (sample-) and species-level analyses, i.e. the usual community weighted 
   means (CWM)-based regression analysis and the species-level analysis of 
   species-niche centroids (SNC)-based regression analysis. The two steps use 
   canonical correspondence analysis to regress the abundance data on to the 
   traits and (weighted) redundancy analysis to regress the CWM of the 
   orthonormalized traits on to the environmental predictors. The function 
   dc_CA() has an option to divide the abundance data of a site by the site 
   total, giving equal site weights. This division has the advantage that the 
   multivariate analysis corresponds with an unweighted (multi-trait) 
   community-level analysis, instead of being weighted. The first step of 
   the algorithm uses vegan::cca(). The second step uses wrda() but 
   vegan::rda() if the site weights are equal. This version has a predict() 
   function. For details see ter Braak et al. 2018 
   &lt;<a href="https://doi.org/10.1007%2Fs10651-017-0395-x">doi:10.1007/s10651-017-0395-x</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.5.1), ggrepel, gridExtra, permute, rlang, stats,
vegan (&ge; 2.6-8)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, tinytest</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://zenodo.org/records/13970152">https://zenodo.org/records/13970152</a>,
<a href="https://github.com/Biometris/douconca">https://github.com/Biometris/douconca</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Biometris/douconca/issues">https://github.com/Biometris/douconca/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-02 12:40:10 UTC; rossu027</td>
</tr>
<tr>
<td>Author:</td>
<td>Cajo J.F ter Braak
    <a href="https://orcid.org/0000-0002-0414-8745"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Bart-Jan van Rossum
    <a href="https://orcid.org/0000-0002-8673-2514"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bart-Jan van Rossum &lt;bart-jan.vanrossum@wur.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-02 13:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='douconca-package'>The package douconca performs double constrained correspondence 
analysis for trait-environment analysis in ecology</h2><span id='topic+douconca'></span><span id='topic+douconca-package'></span>

<h3>Description</h3>

<p>Double constrained correspondence analysis (dc-CA) for analyzing 
(multi-)trait (multi-)environment ecological data using library <code>vegan</code>
and native R code. It has a <code>formula</code> interface which allows to assess, 
for example, the importance of trait interactions in shaping ecological 
communities. The function <code>dc_CA</code> has an option to divide the abundance
data of a site by the site total, giving equal site weights. This division 
has the advantage that the multivariate analysis corresponds with an 
unweighted (multi-trait) community-level analysis, instead of being weighted.
</p>
<p>Throughout the two step algorithm of ter Braak et al. (2018) is used. This 
algorithm combines and extends community- (sample-) and species-level 
analyses, <em>i.e.</em> (1) the usual community weighted means (CWM) 
regression analysis and (2) the species-level analysis of species-niche 
centroids (SNC) regression analysis. The SNC is the center of the realized 
niche of the species along an environmental variable or, in the case of 
dc-CA, an environmental gradient, <em>i.e.</em> the dc-CA ordination axis.
Computationally, dc-CA can be carried out by a single singular value 
decomposition (ter Braak et al. 2018), but it is here computed in two steps.
</p>
<p>The first step uses canonical correspondence analysis 
(<code><a href="vegan.html#topic+cca">cca</a></code>) to regress the (transposed) abundance data on to 
the traits and the second step uses weighed redundancy analysis 
(<code><a href="#topic+wrda">wrda</a></code> or, with equal site weights, <code><a href="vegan.html#topic+rda">rda</a></code>)
to regress the CWMs of the orthonormalized traits, 
obtained from the first step, on to the environmental predictors. 
The second step is thus a community-level analysis.
</p>
<p>If <code>divideBySiteTotals = FALSE</code>, the second step uses 
<code><a href="#topic+wrda">wrda</a></code> and performs a weighted redundancy analysis of the CWMs 
on to the environmental variables.
</p>
<p>Division of the abundance data by the site totals has the advantage that 
the resulting analysis (without dimension reduction, <em>i.e.</em> retaining 
all dc-CA axes) corresponds with a series of unweighted community-level 
analyses, instead of the analyses being weighted.
</p>
<p>Warning: The <code>dcCA</code> package was built from <code>vegan</code> version 2.6-4 
and uses some of the internal structure of the <code>vegan</code> 
<code><a href="vegan.html#topic+cca.object">cca.object</a></code> in the not-exported functions 
<code>f_inertia</code> and <code>get_QR</code> in the source code file 
<code>functions_using_cca_object_internals.r</code>.
</p>
<p>The main user-functions are <code><a href="#topic+dc_CA">dc_CA</a></code>, <code><a href="#topic+plot.dcca">plot.dcca</a></code>, 
<code><a href="#topic+scores.dcca">scores.dcca</a></code>, <code><a href="#topic+print.dcca">print.dcca</a></code> and 
<code><a href="#topic+anova.dcca">anova.dcca</a></code>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Bart-Jan van Rossum <a href="mailto:bart-jan.vanrossum@wur.nl">bart-jan.vanrossum@wur.nl</a> (<a href="https://orcid.org/0000-0002-8673-2514">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Cajo J.F ter Braak <a href="mailto:cajo.terbraak@wur.nl">cajo.terbraak@wur.nl</a> (<a href="https://orcid.org/0000-0002-0414-8745">ORCID</a>)
</p>
</li></ul>



<h3>References</h3>

<p>ter Braak, CJF, Šmilauer P, and Dray S. 2018. Algorithms and biplots for
double constrained correspondence analysis.
Environmental and Ecological Statistics, 25(2), 171-197.
<a href="https://doi.org/10.1007/s10651-017-0395-x">doi:10.1007/s10651-017-0395-x</a> 
</p>
<p>Oksanen, J., et al. (2022)
vegan: Community Ecology Package. R package version 2.6-4.
<a href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</a>.
</p>


<h3>See Also</h3>

<p><code><a href="vegan.html#topic+cca">cca</a></code> and <code><a href="vegan.html#topic+rda">rda</a></code>
</p>

<hr>
<h2 id='anova_sites'>Utility function: community-level permutation test in Double 
Constrained Correspondence Analysis (dc-CA)</h2><span id='topic+anova_sites'></span>

<h3>Description</h3>

<p><code>anova_sites</code> performs the community-level permutation test of dc-CA 
when site weights vary.
The test uses residual predictor permutation (ter Braak 2022), which is 
robust against differences in site total abundance in the <code>response</code> 
in <code><a href="#topic+dc_CA">dc_CA</a></code> (ter Braak &amp; te Beest, 2022).
The arguments of the function are similar to those of 
<code><a href="vegan.html#topic+anova.cca">anova.cca</a></code>, but more restricted. With equal site-totals 
as in <code><a href="#topic+dc_CA">dc_CA</a></code>, <code>anova(object$RDAonEnv)</code> is much faster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova_sites(object, permutations = 999, by = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova_sites_+3A_object">object</code></td>
<td>
<p>an object from <code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="anova_sites_+3A_permutations">permutations</code></td>
<td>
<p>a list of control values for the permutations as 
returned by the function <code><a href="permute.html#topic+how">how</a></code>, or the number of 
permutations required (default 999), or a permutation matrix where each 
row gives the permuted indices.</p>
</td></tr>
<tr><td><code id="anova_sites_+3A_by">by</code></td>
<td>
<p>character <code>"axis"</code> which sets the test statistic to the 
first eigenvalue of the dc-CA model. Default: <code>NULL</code> which sets the 
test statistic to the inertia (sum of all double constrained eigenvalues; 
named  <code>constraintsTE</code> in the inertia element of <code><a href="#topic+dc_CA">dc_CA</a></code>). 
This is the trait constrained inertia explained by the environmental 
predictors (without covariates), which is equal to the 
environmentally-constrained inertia explained by the traits (without trait 
covariates). The default is quicker computationally as it avoids
computation of an svd of permuted data sets.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm is analogous to that of <code><a href="#topic+anova.wrda">anova.wrda</a></code>. The function
is used in <code><a href="#topic+anova.dcca">anova.dcca</a></code>.
</p>


<h3>Value</h3>

<p>A list with two elements with names <code>table</code> and <code>eigenvalues</code>.
The <code>table</code> is as from <code><a href="vegan.html#topic+anova.cca">anova.cca</a></code> and 
<code>eigenvalues</code> gives the dc-CA eigenvalues.
</p>


<h3>References</h3>

<p>ter Braak, C.J.F. &amp; te Beest, D.E. 2022. Testing environmental effects
on taxonomic composition with canonical correspondence analysis:
alternative permutation tests are not equal.
Environmental and Ecological Statistics. 29 (4), 849-868.
<a href="https://doi.org/10.1007/s10651-022-00545-4">doi:10.1007/s10651-022-00545-4</a>
</p>
<p>ter Braak, C.J.F. (2022) Predictor versus response permutation
for significance testing in weighted regression and redundancy analysis.
Journal of statistical computation and simulation, 92, 2041-2059.
<a href="https://doi.org/10.1080/00949655.2021.2019256">doi:10.1080/00949655.2021.2019256</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,
             formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
             verbose = FALSE)
anova(mod)

a_species &lt;- anova_species(mod)
a_species
# anova_species can be used for manual forward selection of
# trait variables, as done for environmental variables in the demo 
# dune_FS_dcCA.r, based on the first eigenvalue and its significance
# and adding the first axis of the constrained species scores from mod to 
# the Condition of a new mod.
(eig1_and_pval &lt;- c(eig = a_species$eig[1], pval = a_species$table$`Pr(&gt;F)`[1]))
a_species$eig
anova_sites(mod)
</code></pre>

<hr>
<h2 id='anova_species'>Utility function: Species-level Permutation Test in Double 
Constrained Correspondence Analysis (dc-CA)</h2><span id='topic+anova_species'></span>

<h3>Description</h3>

<p><code>anova_species</code> performs the species-level permutation test of dc-CA 
which is part of <code><a href="#topic+anova.dcca">anova.dcca</a></code>.
The test uses residual predictor permutation (ter Braak 2022), which is 
robust against differences in species total abundance in the <code>response</code> 
in <code><a href="#topic+dc_CA">dc_CA</a></code> (ter Braak &amp; te Beest, 2022). The arguments of the
function are similar to those of <code><a href="vegan.html#topic+anova.cca">anova.cca</a></code>, but more 
restrictive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova_species(object, permutations = 999, by = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova_species_+3A_object">object</code></td>
<td>
<p>an object from <code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="anova_species_+3A_permutations">permutations</code></td>
<td>
<p>a list of control values for the permutations as
returned by the function <code><a href="permute.html#topic+how">how</a></code>, or the number of 
permutations required (default 999) or a permutation matrix where each row 
gives the permuted indices.</p>
</td></tr>
<tr><td><code id="anova_species_+3A_by">by</code></td>
<td>
<p>character <code>"axis"</code> which sets the test statistic to the first
eigenvalue of the dc-CA model. Default: <code>NULL</code> which set the test 
statistic to the inertia (sum of all double constrained eigenvalues; named 
<code>constraintsTE</code> in the inertia element of <code><a href="#topic+dc_CA">dc_CA</a></code>). 
This is the environmentally constrained inertia explained by the traits 
(without trait covariates), which is equal to the trait-constrained inertia 
explained by the environmental predictors (without covariates). The default 
is quicker computationally as it avoids computation of an svd of permuted 
data sets.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code><a href="#topic+anova_species">anova_species</a></code>, the first step extracts the species-niche 
centroids (SNC) with respect to all dc-CA ordination axes from an existing 
dc-CA analysis. The second step, applies a weighted redundancy analysis of 
these SNCs with the traits as predictors. The second step is thus a 
species-level analysis, but the final results (eigenvalues/ordination axes) 
are identical to those of the analyses steps in <code><a href="#topic+dc_CA">dc_CA</a></code>.The 
second step uses R-code that is analogous to that of 
<code><a href="#topic+anova.wrda">anova.wrda</a></code>.
</p>


<h3>Value</h3>

<p>A list with two elements with names <code>table</code> and <code>eigenvalues</code>.
The <code>table</code> is as from <code><a href="vegan.html#topic+anova.cca">anova.cca</a></code> and 
<code>eigenvalues</code> gives the dc-CA eigenvalues. This output can be used 
for scripting forward selection of traits, similar to the forward selection
of environmental variables in the demo <code>dune_select.r</code>.
</p>


<h3>References</h3>

<p>ter Braak, C.J.F. &amp; te Beest, D.E. 2022. Testing environmental effects
on taxonomic composition with canonical correspondence analysis:
alternative permutation tests are not equal.
Environmental and Ecological Statistics. 29 (4), 849-868.
<a href="https://doi.org/10.1007/s10651-022-00545-4">doi:10.1007/s10651-022-00545-4</a>
</p>
<p>ter Braak, C.J.F. (2022) Predictor versus response permutation
for significance testing in weighted regression and redundancy analysis.
Journal of statistical computation and simulation, 92, 2041-2059.
<a href="https://doi.org/10.1080/00949655.2021.2019256">doi:10.1080/00949655.2021.2019256</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,
             formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
             verbose = FALSE)
anova(mod)

a_species &lt;- anova_species(mod)
a_species
# anova_species can be used for manual forward selection of
# trait variables, as done for environmental variables in the demo 
# dune_FS_dcCA.r, based on the first eigenvalue and its significance
# and adding the first axis of the constrained species scores from mod to 
# the Condition of a new mod.
(eig1_and_pval &lt;- c(eig = a_species$eig[1], pval = a_species$table$`Pr(&gt;F)`[1]))
a_species$eig
anova_sites(mod)
</code></pre>

<hr>
<h2 id='anova.dcca'>Community- and Species-Level Permutation Test in Double Constrained 
Correspondence Analysis (dc-CA)</h2><span id='topic+anova.dcca'></span>

<h3>Description</h3>

<p><code>anova.dcca</code> performs the community- and species-level permutation tests
of dc-CA and combines these with the 'max test', which takes the maximum of
the <em>P</em>-values. The function arguments are similar to (but more 
restrictive than) those of <code><a href="vegan.html#topic+anova.cca">anova.cca</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dcca'
anova(object, ..., permutations = 999, by = c("omnibus", "axis"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova.dcca_+3A_object">object</code></td>
<td>
<p>an object from <code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="anova.dcca_+3A_...">...</code></td>
<td>
<p>unused.</p>
</td></tr>
<tr><td><code id="anova.dcca_+3A_permutations">permutations</code></td>
<td>
<p>a list of control values for the permutations for 
species and sites (species first, sites second, for traits and environment) 
as returned by the function <code><a href="permute.html#topic+how">how</a></code>, or the number of 
permutations required (default 999, or a two-vector with the number for the
species-level test first and that for the sites-level second), or
a list of two permutation matrices (again, species first, sites second)
where each row gives the permuted indices.</p>
</td></tr>
<tr><td><code id="anova.dcca_+3A_by">by</code></td>
<td>
<p>character <code>"axis"</code> which performs a series of tests, one for
each axis, with the eigenvalue of the axis as test statistic. 
Default: <code>NULL</code> which sets the test statistic to the inertia
(sum of all double constrained eigenvalues; named <code>constraintsTE</code> in 
the inertia element of <code><a href="#topic+dc_CA">dc_CA</a></code>. 
</p>
<p>The interpretation of this inertia is, at the species-level, the 
environmentally constrained inertia explained by the traits (without trait
covariates) and, at the community-level, the trait-constrained inertia
explained by the environmental predictors (without covariates). The 
default (<code>NULL</code>) is computationally quicker as it avoids computation 
of an svd of permuted data sets.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the general case of varying site abundance totals 
(<code>divideBySiteTotals = FALSE</code>) both the community-level test and the
species-level test use residualized predictor permutation (ter Braak 2022), 
so as to ensure that <code><a href="#topic+anova.dcca">anova.dcca</a></code> is robust against differences
in species and site total abundance in the <code>response</code> (ter Braak &amp; te 
Beest, 2022). The community-level test uses <code><a href="#topic+anova_sites">anova_sites</a></code>. For 
the species-level test, <code><a href="#topic+anova_species">anova_species</a></code> is used.
</p>
<p>With equal site weights, obtained with <code>divide.by.site.total = TRUE</code>,
the community-level test is obtained by applying <code>anova</code> to 
<code>object$RDAonEnv</code> using <code><a href="vegan.html#topic+anova.cca">anova.cca</a></code>.
This performs residualized response permutation which performs about equal
to residualized predictor permutation in the equi-weight case.
The function <code><a href="vegan.html#topic+anova.cca">anova.cca</a></code> is implemented in C and therefore
a factor of 20 or so quicker than the native R-code used in 
<code><a href="#topic+anova_sites">anova_sites</a></code>.
</p>


<h3>Value</h3>

<p>A list of 3 of structures as from <code><a href="vegan.html#topic+anova.cca">anova.cca</a></code>. The 
elements are <code>c("species", "sites", "maxP")</code>
</p>


<h3>References</h3>

<p>ter Braak, C.J.F. &amp; te Beest, D.E. 2022. Testing environmental effects
on taxonomic composition with canonical correspondence analysis:
alternative permutation tests are not equal.
Environmental and Ecological Statistics. 29 (4), 849-868.
<a href="https://doi.org/10.1007/s10651-022-00545-4">doi:10.1007/s10651-022-00545-4</a>
</p>
<p>ter Braak, C.J.F. (2022) Predictor versus response permutation
for significance testing in weighted regression and redundancy analysis.
Journal of statistical computation and simulation, 92, 2041-2059.
<a href="https://doi.org/10.1080/00949655.2021.2019256">doi:10.1080/00949655.2021.2019256</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,
             formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
             verbose = FALSE)
anova(mod)

a_species &lt;- anova_species(mod)
a_species
# anova_species can be used for manual forward selection of
# trait variables, as done for environmental variables in the demo 
# dune_FS_dcCA.r, based on the first eigenvalue and its significance
# and adding the first axis of the constrained species scores from mod to 
# the Condition of a new mod.
(eig1_and_pval &lt;- c(eig = a_species$eig[1], pval = a_species$table$`Pr(&gt;F)`[1]))
a_species$eig
anova_sites(mod)
</code></pre>

<hr>
<h2 id='anova.wrda'>Permutation Test for weighted redundancy analysis</h2><span id='topic+anova.wrda'></span>

<h3>Description</h3>

<p><code>anova.wrda</code> performs residual predictor permutation for weighted 
redundancy analysis (wRDA), which is robust against differences in the 
weights (ter Braak, 2022). The arguments of the function are similar to 
those of <code><a href="vegan.html#topic+anova.cca">anova.cca</a></code>, but more restricted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wrda'
anova(object, ..., permutations = 999, by = c("omnibus", "axis"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova.wrda_+3A_object">object</code></td>
<td>
<p>an object from <code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="anova.wrda_+3A_...">...</code></td>
<td>
<p>unused.</p>
</td></tr>
<tr><td><code id="anova.wrda_+3A_permutations">permutations</code></td>
<td>
<p>a list of control values for the permutations as
returned by the function <code><a href="permute.html#topic+how">how</a></code>, or the number of 
permutations required (default 999), or a permutation matrix where each row
gives the permuted indices.</p>
</td></tr>
<tr><td><code id="anova.wrda_+3A_by">by</code></td>
<td>
<p>character <code>"axis"</code> which sets the test statistic to the
first eigenvalue of the RDA model. Default: <code>NULL</code> which sets the test
statistic to the weighted variance fitted by the predictors
(=sum of all constrained eigenvalues). The default is quicker 
computationally as it avoids computation of an svd of permuted data sets.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm is based on published R-code for residual predictor 
permutation in weighted redundancy analysis (ter Braak, 2022), but
using QR-decomposition instead of ad-hoc least-squares functions.
</p>


<h3>Value</h3>

<p>A list with two elements with names <code>table</code> and <code>eigenvalues</code>.
The <code>table</code> is as from <code><a href="vegan.html#topic+anova.cca">anova.cca</a></code> and 
<code>eigenvalues</code> gives the wrda eigenvalues.
</p>


<h3>References</h3>

<p>ter Braak, C.J.F. (2022) Predictor versus response permutation
for significance testing in weighted regression and redundancy analysis.
Journal of statistical computation and simulation, 92, 2041-2059.
<a href="https://doi.org/10.1080/00949655.2021.2019256">doi:10.1080/00949655.2021.2019256</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites
response &lt;- dune_trait_env$comm[, -1]  # must delete "Sites"

w &lt;- rep(1, 20) 
w[1:10] &lt;- 8 
w[17:20] &lt;- 0.5

object &lt;- wrda(formula = ~ A1 + Moist + Mag + Use + Condition(Manure),
               response = response, 
               data = dune_trait_env$envir, 
               weights = w)
object # Proportions equal to those Canoco 5.15

mod_scores &lt;- scores(object, display = "all")
scores(object, which_cor = c("A1", "X_lot"), display = "cor")
anova(object)
</code></pre>

<hr>
<h2 id='coef.dcca'>Coefficients of double-constrained correspondence analysis (dc-CA)</h2><span id='topic+coef.dcca'></span>

<h3>Description</h3>

<p>Fourth-corner coefficients and regression coefficients 
(of full or reduced rank) to predict traits from environment, 
environment from traits and response from trait and environment data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dcca'
coef(
  object,
  ...,
  type = c("fourth_corner", "all_reg", "env2traits_reg", "traits2env_reg"),
  rank = "full",
  normed = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.dcca_+3A_object">object</code></td>
<td>
<p>return value of <code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="coef.dcca_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the function (currently ignored).</p>
</td></tr>
<tr><td><code id="coef.dcca_+3A_type">type</code></td>
<td>
<p>type of coefficients, 
<code>c("fourth_corner", "all_reg", "env2traits_reg", "traits2env_reg")</code> for
fourth-corner coefficients and regression coefficients for
all trait x environmental predictors, environmental predictors only 
and trait predictors only for prediction of the (transformed)
response, traits and environmental values, respectively.</p>
</td></tr>
<tr><td><code id="coef.dcca_+3A_rank">rank</code></td>
<td>
<p>rank (number of axes to use). Default &quot;full&quot; for all axes 
(no rank-reduction).</p>
</td></tr>
<tr><td><code id="coef.dcca_+3A_normed">normed</code></td>
<td>
<p>logical (default <code>TRUE</code>) giving standardized regression
coefficients and biplot scores. When <code>FALSE</code>, (regular)
regression coefficients and (unstandardized) biplot scores.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Regression coefficients are for standardized traits and environmental variables.
</p>
<p>With covariates, <code>coef()</code> gives partialfourth-corner correlations. 
With <code>rank = 2</code>, <code>coef()</code> gives the two-dimensional approximation
of the full-rank fourth-corner correlations in the biplot that displays the
traits and environmental variables at arrow heads or points 
at <code>scores(mod, display = c("bp", "bp_traits"))</code>.
</p>


<h3>Value</h3>

<p>a matrix with coefficients. The exact content of the matrix 
depends on the <code>type</code> of coefficient that is asked for.
</p>
<p>Regression coefficients for a response variable 
are usually column-vectors. 
With <strong>X</strong> the matrix of units-by-predictors
and <strong>B</strong> the matrix of predictors-by-response-variables, 
predictions or fits are of the form <strong>Y = XB</strong>.
Analogously, <code>type = "trait2env"</code> gives a trait-by-environment matrix and
<code>type = "env2traits"</code> gives an environment-by-trait matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Condition(Manure),
             formulaTraits = ~ SLA + Height + LDMC + Condition(Seedmass) + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
             verbose = FALSE)

# regression coefficients
coef(mod, type = "env2traits")
coef(mod, type = "traits2env")
coef(mod, type = "fourth")
coef(mod, type = "all_reg")
</code></pre>

<hr>
<h2 id='dc_CA'>Performs (weighted) double constrained correspondence analysis (dc-CA)</h2><span id='topic+dc_CA'></span>

<h3>Description</h3>

<p>Double constrained correspondence analysis (dc-CA) for analyzing
(multi-)trait (multi-)environment ecological data using library <code>vegan</code> 
and native R code. It has a <code>formula</code> interface which allows to assess,
for example, the importance of trait interactions in shaping ecological 
communities. The function <code>dc_CA</code> has an option to divide the abundance
data of a site by the site total, giving equal site weights. This division 
has the advantage that the multivariate analysis corresponds with an 
unweighted (multi-trait) community-level analysis, instead of being weighted
(Kleyer et al. 2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dc_CA(
  formulaEnv = NULL,
  formulaTraits = NULL,
  response = NULL,
  dataEnv = NULL,
  dataTraits = NULL,
  divideBySiteTotals = TRUE,
  dc_CA_object = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dc_CA_+3A_formulaenv">formulaEnv</code></td>
<td>
<p>formula or one-sided formula for the rows (samples) with 
row predictors in <code>dataEnv</code>. When two-sided, the left hand side of 
the formula is not used. Specify row covariates (if any ) by 
adding <code>+ Condition(covariate-formula)</code> to <code>formulaEnv</code> as 
in <code><a href="vegan.html#topic+rda">rda</a></code>. The <code>covariate-formula</code> should not contain 
a <code>~</code> (tilde). Default: <code>NULL</code> for <code>~.</code>, i.e. all variables 
in <code>dataEnv</code> are predictor variables.</p>
</td></tr>
<tr><td><code id="dc_CA_+3A_formulatraits">formulaTraits</code></td>
<td>
<p>formula or one-sided formula for the columns (species) 
with column predictors in <code>dataTraits</code>. When two-sided, the left hand 
side of the formula is not used. Specify column covariates (if any ) by 
adding <code>+ Condition(covariate-formula)</code> to <code>formulaTraits</code> as 
in <code><a href="vegan.html#topic+cca">cca</a></code>. The <code>covariate-formula</code> should not contain 
a <code>~</code> (tilde). Default: <code>NULL</code> for <code>~.</code>, i.e. all variables 
in <code>dataTraits</code> are predictor traits.</p>
</td></tr>
<tr><td><code id="dc_CA_+3A_response">response</code></td>
<td>
<p>matrix, data frame of the abundance data 
(dimension <em>n</em> x <em>m</em>) or list with community weighted means (CWMs)
from <code><a href="#topic+fCWM_SNC">fCWM_SNC</a></code>. See Details for analyses starting from community
weighted means. Rownames of <code>response</code>, if any, are carried through.</p>
</td></tr>
<tr><td><code id="dc_CA_+3A_dataenv">dataEnv</code></td>
<td>
<p>matrix or data frame of the row predictors, with rows 
corresponding to those in <code>response</code>. (dimension <em>n</em> x <em>p</em>).</p>
</td></tr>
<tr><td><code id="dc_CA_+3A_datatraits">dataTraits</code></td>
<td>
<p>matrix or data frame of the column predictors, with rows 
corresponding to the columns in <code>response</code>.
(dimension <em>m</em> x <em>q</em>).</p>
</td></tr>
<tr><td><code id="dc_CA_+3A_dividebysitetotals">divideBySiteTotals</code></td>
<td>
<p>logical; default <code>TRUE</code> for closing the 
data by dividing the rows in the <code>response</code> by their total.</p>
</td></tr>
<tr><td><code id="dc_CA_+3A_dc_ca_object">dc_CA_object</code></td>
<td>
<p>optional object from an earlier run of this function. 
Useful if the same formula for the columns (<code>formulaTraits</code>), 
<code>dataTraits</code> and <code>response</code> are used with a new formula for the 
rows. If set, the data of the previous run is used and the result of its 
first step is taken for the new analysis.</p>
</td></tr>
<tr><td><code id="dc_CA_+3A_verbose">verbose</code></td>
<td>
<p>logical for printing a simple summary (default: TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Empty (all zero) rows and columns in <code>response</code> are removed from the 
<code>response</code> and the corresponding rows from <code>dataEnv</code> and 
<code>dataTraits</code>. Subsequently, any columns with missing values are 
removed from  <code>dataEnv</code> and <code>dataTraits</code>. It gives an error 
('name_of_variable' not found), if variables with missing entries are
specified in <code>formulaEnv</code> and <code>formulaTraits</code>.
</p>
<p>Computationally, dc-CA can be carried out by a single singular value 
decomposition (ter Braak et al. 2018), but it is here computed in two steps.
In the first step, the transpose of the <code>response</code> is regressed on to 
the traits (the column predictors) using <code><a href="vegan.html#topic+cca">cca</a></code> with 
<code>formulaTraits</code>. The column scores of this analysis (in scaling 1) are 
community weighted means (CWM) of the orthonormalized traits. These are then 
regressed on the environmental (row) predictors using <code><a href="#topic+wrda">wrda</a></code> 
with <code>formulaEnv</code> or using <code><a href="vegan.html#topic+rda">rda</a></code>, if site weights 
are equal.
</p>
<p>A dc-CA can be carried out on, what statisticians call, the sufficient
statistics of the method. This is useful, when the abundance data are not 
available or could not be made public in a paper attempting reproducible 
research. In this case, <code>response</code> should be a list
with as first element community weighted means 
(e.g. <code>list(CWM = CWMs)</code>) with respect to the 
traits, and the trait data, and, optionally, further list elements, for functions
related to <code>dc_CA</code>. The minimum is a 
<code>list(CWM = CWMs, weight = list(columns = species_weights))</code> with CWM a matrix
or data.frame, but then <code>formulaEnv</code>, <code>formulaTraits</code>, 
<code>dataEnv</code>, <code>dataTraits</code> must be specified in the call to 
<code>dc_CA</code>. The function <code><a href="#topic+fCWM_SNC">fCWM_SNC</a></code> and its example
show how to set the
<code>response</code> for this and helps to create the <code>response</code> from 
abundance data in these non-standard applications of dc-CA. Species and site 
weights, if not set in <code>response$weights</code> can be set by a variable
<code>weight</code> in the data frames <code>dataTraits</code> and <code>dataEnv</code>, 
respectively, but formulas should then not be <code>~.</code>.
</p>
<p>The statistics and scores in the example <code>dune_dcCA.r</code>, have been 
checked against the results in Canoco 5.15 (ter Braak &amp; Šmilauer, 2018).
</p>


<h3>Value</h3>

<p>A list of <code>class</code> <code>dcca</code>; that is a list with elements
</p>

<dl>
<dt>CCAonTraits</dt><dd><p>a <code><a href="vegan.html#topic+cca.object">cca.object</a></code> from the 
<code><a href="vegan.html#topic+cca">cca</a></code> analysis of the transpose of the closed 
<code>response</code> using formula <code>formulaTraits</code>.</p>
</dd>
<dt>formulaTraits</dt><dd><p>the argument <code>formulaTraits</code>. If the formula was
<code>~.</code>, it was changed to explicit trait names.</p>
</dd>
<dt>data</dt><dd><p>a list of <code>Y</code>, <code>dataEnv</code> and <code>dataTraits</code>, 
after removing empty rows and columns in <code>response</code> and after closure if 
<code>divideBySiteTotals = TRUE</code> and with the corresponding rows in 
<code>dataEnv</code> and <code>dataTraits</code> removed.</p>
</dd>
<dt>weights</dt><dd><p>a list of unit-sum weights of columns and rows. The names of 
the list are <code>c("columns", "rows")</code>, in that order.</p>
</dd>
<dt>Nobs</dt><dd><p>number of sites (rows).</p>
</dd>
<dt>CWMs_orthonormal_traits</dt><dd><p>Community weighted means w.r.t. 
orthonormalized traits.</p>
</dd>
<dt>RDAonEnv</dt><dd><p>a <code><a href="#topic+wrda">wrda</a></code> object or 
<code><a href="vegan.html#topic+cca.object">cca.object</a></code> from the 
<code><a href="#topic+wrda">wrda</a></code> or, if with equal row weights, 
<code><a href="vegan.html#topic+rda">rda</a></code> analysis, respectively of the column scores of the
<code>cca</code>, which are the CWMs of orthonormalized traits, using formula 
<code>formulaEnv</code>.</p>
</dd>
<dt>formulaEnv</dt><dd><p>the argument <code>formulaEnv</code>. If the formula was 
<code>~.</code>, it was changed to explicit environmental variable names.</p>
</dd>
<dt>eigenvalues</dt><dd><p>the dc-CA eigenvalues (same as those of the 
<code><a href="vegan.html#topic+rda">rda</a></code> analysis).</p>
</dd>
<dt>c_traits_normed0</dt><dd><p>mean, sd, VIF and (regression) coefficients of 
the traits that define the dc-CA axes in terms of the 
traits with t-ratios missing indicated by <code>NA</code>s for 'tval1'.</p>
</dd>
<dt>inertia</dt><dd><p>a one-column matrix with, at most,
six inertias (weighted variances):
</p>

<ul>
<li><p> total: the total inertia.
</p>
</li>
<li><p> conditionT: the inertia explained by the condition in 
<code>formulaTraits</code> if present (neglecting row constraints).
</p>
</li>
<li><p> traits_explain: the trait-structured variation, <em>i.e.</em>
the inertia explained by the traits (without constaints on the rows and 
conditional on the Condition in <code>formulaTraits</code>).
This is the  maximum that the row predictors could explain in dc-CA
(the sum of the last two items is thus less than this value).
</p>
</li>
<li><p> env_explain: the environmentally structured variation, <em>i.e.</em>
the inertia explained by the environment (without constraints on the 
columns but conditional on the Condition <code>formulaEnv</code>).
This is the maximum that the column predictors could explain in 
dc-CA (the item <code>constraintsTE</code> is thus less than this value).
The value is <code>NA</code>, if there is collinearity in the environmental data.
</p>
</li>
<li><p> conditionTE: the trait-constrained variation explained by the 
condition in <code>formulaEnv</code>.
</p>
</li>
<li><p> constraintsTE: the trait-constrained variation explained by the 
predictors (without the row covariates).
</p>
</li></ul>

</dd>
</dl>

<p>If <code>verbose</code> is <code>TRUE</code> (or after <code>out &lt;- print(out)</code> is 
invoked) there are three more items.
</p>

<ul>
<li> <p><code>c_traits_normed</code>: mean, sd, VIF and (regression) coefficients of
the traits that define the dc-CA trait axes (composite traits), and their 
optimistic t-ratio.
</p>
</li>
<li> <p><code>c_env_normed</code>: mean, sd, VIF and (regression) coefficients of 
the environmental variables that define the dc-CA axes in terms of the 
environmental variables (composite gradients), and their optimistic t-ratio.
</p>
</li>
<li> <p><code>species_axes</code>: a list with four items
</p>

<ul>
<li> <p><code>species_scores</code>: a list with names 
<code>c("species_scores_unconstrained", "lc_traits_scores")</code> with the
matrix with species niche centroids along the dc-CA axes (composite 
gradients) and the matrix with linear combinations of traits.
</p>
</li>
<li> <p><code>correlation</code>: a matrix with inter-set correlations of the 
traits with their SNCs.
</p>
</li>
<li> <p><code>b_se</code>: a matrix with (unstandardized) regression coefficients 
for traits and their optimistic standard errors.
</p>
</li>
<li> <p><code>R2_traits</code>: a vector with coefficient of determination (R2) 
of the SNCs on to the traits. The square-root thereof could be called 
the species-trait correlation in analogy with the species-environment 
correlation in CCA.
</p>
</li></ul>

</li>
<li> <p><code>sites_axes</code>: a list with four items
</p>

<ul>
<li> <p><code>site_scores</code>: a list with names 
<code>c("site_scores_unconstrained", "lc_env_scores")</code> with the matrix 
with community weighted means (CWMs) along the dc-CA axes (composite 
gradients) and the matrix with linear combinations of environmental 
variables.
</p>
</li>
<li> <p><code>correlation</code>: a matrix with inter-set correlations of the 
environmental variables with their CWMs.
</p>
</li>
<li> <p><code>b_se</code>: a matrix with (unstandardized) regression coefficients 
for environmental variables and their optimistic standard errors.
</p>
</li>
<li> <p><code>R2_env</code>: a vector with coefficient of determination (R2) of 
the CWMs on to the environmental variables. The square-root thereof 
has been called the species-environmental correlation in CCA.
</p>
</li></ul>

</li></ul>

<p>All scores in the <code>dcca</code> object are in scaling <code>"sites"</code> (1): 
the scaling with <em>Focus on Case distances</em> .
</p>


<h3>References</h3>

<p>Kleyer, M., Dray, S., Bello, F., Lepš, J., Pakeman, R.J., Strauss, B., Thuiller,
W. &amp; Lavorel, S. (2012) Assessing species and community functional responses to
environmental gradients: which multivariate methods?
Journal of Vegetation Science, 23, 805-821.
<a href="https://doi.org/10.1111/j.1654-1103.2012.01402.x">doi:10.1111/j.1654-1103.2012.01402.x</a>
</p>
<p>ter Braak, CJF, Šmilauer P, and Dray S. 2018. Algorithms and biplots for
double constrained correspondence analysis.
Environmental and Ecological Statistics, 25(2), 171-197.
<a href="https://doi.org/10.1007/s10651-017-0395-x">doi:10.1007/s10651-017-0395-x</a>
</p>
<p>ter Braak C.J.F. and  P. Šmilauer  (2018). Canoco reference manual
and user's guide: software for ordination (version 5.1x).
Microcomputer Power, Ithaca, USA, 536 pp.
</p>
<p>Oksanen, J., et al. (2024)
vegan: Community Ecology Package. R package version 2.6-6.1.
<a href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.dcca">plot.dcca</a></code>, <code><a href="#topic+scores.dcca">scores.dcca</a></code>, 
<code><a href="#topic+print.dcca">print.dcca</a></code> and <code><a href="#topic+anova.dcca">anova.dcca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure,
             formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
			 verbose = FALSE)

print(mod) # same output as with verbose = TRUE (the default of verbose).																		 
anova(mod, by = "axis")
# For more demo on testing, see demo dune_test.r

mod_scores &lt;- scores(mod)
# correlation of axes with a variable that is not in the model
scores(mod, display = "cor", scaling = "sym", which_cor = list(NULL, "X_lot"))

cat("head of unconstrained site scores, with meaning\n")
print(head(mod_scores$sites))

mod_scores_tidy &lt;- scores(mod, tidy = TRUE)
print("names of the tidy scores")
print(names(mod_scores_tidy))
cat("\nThe levels of the tidy scores\n")
print(levels(mod_scores_tidy$score))

cat("\nFor illustration: a dc-CA model with a trait covariate\n")
mod2 &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,
              formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),
              response = dune_trait_env$comm[, -1],  # must delete "Sites"
              dataEnv = dune_trait_env$envir,
              dataTraits = dune_trait_env$traits)

cat("\nFor illustration: a dc-CA model with both environmental and trait covariates\n")
mod3 &lt;- dc_CA(formulaEnv = ~A1 + Moist + Use + Manure + Condition(Mag),
              formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),
              response = dune_trait_env$comm[, -1],  # must delete "Sites"
              dataEnv = dune_trait_env$envir,
              dataTraits = dune_trait_env$traits, 
			  verbose = FALSE)

cat("\nFor illustration: same model but using dc_CA_object = mod2 for speed, ", 
    "as the trait model and data did not change\n")
mod3B &lt;- dc_CA(formulaEnv = ~A1 + Moist + Use + Manure + Condition(Mag),
               dataEnv = dune_trait_env$envir,
               dc_CA_object = mod2, 
			   verbose= FALSE)
cat("\ncheck on equality of mod3 (from data) and mod3B (from a dc_CA_object)\n",
    "the expected difference is in the component 'call'\n ")
print(all.equal(mod3, mod3B)) #  only the component call differs


</code></pre>

<hr>
<h2 id='dune_trait_env'>Dune meadow data with plant species traits and environmental variables</h2><span id='topic+dune_trait_env'></span>

<h3>Description</h3>

<p>The data <code>dune_trait_env</code> contains three data frames with abundance 
data of 28 plant species in 20 samples (relevés), trait data (9 traits:
of which 5 morphological and 4 ecological (Ellenberg indicator values) and
environmental data (9 environmental variables, four of which are geographic 
coordinates). Compared to the data in Jongman et al. (1987, 1995), the two 
moss species are lacking, and the traits of plant species and the geographic 
coordinates of the samples are added. The data and the following description 
are an edited version of the DataKey in the Jamil2013_AJ data set in the 
CESTES database (Jeliazkov et al. 2020).
</p>
<p>The Dune Meadow Data originate from a MSc thesis report of Batterink &amp; 
Wijffels (1983). It consisted of 80 relevés in about 68 dune meadows (lots) 
on the island Terschelling in the Netherlands. A subset of their data was 
selected by Caspar Looman as an example data set for the edited book 
Jongman, ter Braak and van Tongeren (1987, 1995). The subset consists of 20 
relevés, 28 species (and 2 mosses, excluded here) and 5 environmental 
variables.
</p>
<p>The trait data were taken from the LEDA database by  Jamil et al 2013. The 
spatial coordinates were retrieved by geo-referencing in GIS of the maps in
Batterink &amp; Wijffels (1993) by Ruut Wegman and Cajo ter Braak. The X, Y 
coordinates are by geo-referencing the relevé locations on Kaart 3a, 3b and 
3c; the X_lot, Y_lot coordinates are from Kaart 2a, 2b and 2c.
</p>
<p>For the Ellenberg indicator values see Ellenberg (1992).
</p>
<p>The data <code>dune_trait_env</code> is a list with elements that are data frames 
each
</p>

<ul>
<li> <p><code>comm</code>:   community data; vegetation data.
</p>
</li>
<li> <p><code>traits</code>: trait data, taken from the LEDA database.
</p>
</li>
<li> <p><code>envir</code>:  environmental data, taken from Jongman et al. (1987,1995).
</p>
</li></ul>

<p>The community data collection was done by the Braun-Blanquet method;
the data are recorded according to the ordinal scale of van der Maarel (1979, 
Vegetatio, 39, 97-114); see pages XVII-XVIII and 18 in Jongman, ter Braak &amp; 
van Tongeren 1995. Nomenclature follows Heukels-Van der Meijden (1983) 
Flora van Nederland, 20th ed.
</p>
<p>The morphological <code>traits</code> are
</p>

<ul>
<li> <p><code>SLA</code>:	    Specific Leaf Area
</p>
</li>
<li> <p><code>Height</code>:	  Canopy height of a shoot
</p>
</li>
<li> <p><code>LDMC</code>:  	  Lead dry matter content
</p>
</li>
<li> <p><code>Seedmass</code>:	Seed mass
</p>
</li>
<li> <p><code>Lifespan</code>:	Life span. Nominal; annual vs. perennial
</p>
</li></ul>

<p>The ecological <code>traits</code> (habitat requirements) are the Ellenberg values
</p>

<ul>
<li> <p><code>F</code>:	    Moisture (ranging [1 to 12] (low to high))
</p>
</li>
<li> <p><code>R</code>:	    Soil acidity, ranging [1 to 9] (acidic to alkaline)
</p>
</li>
<li> <p><code>N</code>:  	  Nitrogen requirement, ranging [1 to 9] (low to high)
</p>
</li>
<li> <p><code>L</code>:	    Light requirement, ranging [1 to 9] (low to high)
</p>
</li></ul>
 
<p>The data frame <code>envir</code> contains the environmental variables
</p>

<ul>
<li> <p><code>A1</code>:    horizon thickness
</p>
</li>
<li> <p><code>Moist</code>:	Moisture content of the soil (a five point scale)
</p>
</li>
<li> <p><code>Mag</code>:    Grassland management type
</p>
</li>
<li> <p><code>Use</code>:	type of use (Agricultural grassland use (1) hay production 
(2) intermediate (3) grazing)
</p>
</li>
<li> <p><code>Manure</code>:	Quantity of manure applied based on N and P manuring 
(N/P class in B&amp;W 1983)
</p>
</li>
<li> <p><code>X</code>:	longitude	geographical coordinates (m) of the 2x2 m2 
sample (relevé)
</p>
</li>
<li> <p><code>Y</code>:	latitude	geographical coordinates (m) of the 2x2 m2 
sample (relevé)
</p>
</li>
<li> <p><code>X_lot</code>:	longitude	geographical coordinates (m) of the lot center
</p>
</li>
<li> <p><code>Y_lot</code>:  latitude	geographical coordinates (m) of the lot center
</p>
</li></ul>

<p>The management types are standard farming (SF), biological farming (BF),
hobby farming (HF), nature conservation management (NM). The coordinates are
Rijksdriehoekscoordinaten in meters.
<a href="https://nl.wikipedia.org/wiki/Rijksdriehoekscoordinaten">https://nl.wikipedia.org/wiki/Rijksdriehoekscoordinaten</a>
</p>


<h3>References</h3>

<p>Batterink, M. &amp; Wijffels, G. (1983) Een vergelijkend vegetatiekundig 
onderzoek naar de typologie en invloeden van het beheer van 1973 tot 1982 in 
de duinweilanden op Terschelling. Landbouwhogeschool. 
ISN 215909.01. WUR library stacks 704B58.
</p>
<p>Ellenberg, H. (1992) Indicator values of plants in Central Europe.
Scripta Geobotanica, 18, 258 pp.
</p>
<p>Jamil, T., Ozinga, W.A., Kleyer, M. &amp; ter Braak, C.J.F. (2013) Selecting 
traits that explain species–environment relationships: a generalized linear 
mixed model approach. Journal of Vegetation Science, 24, 988-1000.
<a href="https://doi.org/10.1111/j.1654-1103.2012.12036.x">doi:10.1111/j.1654-1103.2012.12036.x</a>.
</p>
<p>Jeliazkov, A., Mijatovic, D., and 78 others. (2020) A global database for 
metacommunity ecology, integrating species, traits, environment and space. 
Scientific Data, 7. <a href="https://doi.org/10.1038/s41597-019-0344-7">doi:10.1038/s41597-019-0344-7</a>.
</p>
<p>Jongman, R.H.G., ter Braak, C.J.F. &amp; van Tongeren, O.F.R. (1987) Data 
analysis in community and landscape ecology. Pudoc, Wageningen. 
ISBN 90-220-0908-4.
</p>
<p>Jongman, R.H.G., ter Braak, C.J.F. &amp; van Tongeren, O.F.R. (1995) Data 
analysis in community and landscape ecology. Cambridge University Press, 
Cambridge. ISBN 0-521-47574-0. <a href="https://edepot.wur.nl/248017">https://edepot.wur.nl/248017</a>.
</p>
<p>Kleyer, M., and 33 others (2008) The LEDA Traitbase: a database of 
life-history traits of the Northwest European flora. Journal of Ecology, 
96, 1266-1274. <a href="https://doi.org/10.1111/j.1365-2745.2008.01430.x">doi:10.1111/j.1365-2745.2008.01430.x</a>.
</p>

<hr>
<h2 id='fCWM_SNC'>Calculate community weighted means and species niche centroids for 
double constrained correspondence analysis</h2><span id='topic+fCWM_SNC'></span>

<h3>Description</h3>

<p>Double constrained correspondence analysis (dc-CA) can be calculated directly 
from community weighted means (CWMs), with the trait data from which the 
CWMs are calculated, and the environmental data and weights for species 
and sites (the abundance totals for species and sites). Statistical testing
at the species level requires also the species niche centroids (SNCs).
The function <code>fCWM_SNC</code> calculates the CWMs and SNCs from the trait 
and environmental data, respectively, using a formula interface, so as to
allow categorical traits and environmental variables. The resulting object
can be set as the <code>response</code> argument in <code><a href="#topic+dc_CA">dc_CA</a></code> so as to
give the same output as a call to <code><a href="#topic+dc_CA">dc_CA</a></code> with the abundance
data as <code>response</code>, at least up to sign changes of the axes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCWM_SNC(
  response = NULL,
  dataEnv = NULL,
  dataTraits = NULL,
  formulaEnv = NULL,
  formulaTraits = NULL,
  divideBySiteTotals = TRUE,
  dc_CA_object = NULL,
  minimal_output = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fCWM_SNC_+3A_response">response</code></td>
<td>
<p>matrix, data frame of the abundance data 
(dimension <em>n</em> x <em>m</em>) or list with community weighted means (CWMs)
from <code><a href="#topic+fCWM_SNC">fCWM_SNC</a></code>. See Details for analyses starting from community
weighted means. Rownames of <code>response</code>, if any, are carried through.</p>
</td></tr>
<tr><td><code id="fCWM_SNC_+3A_dataenv">dataEnv</code></td>
<td>
<p>matrix or data frame of the row predictors, with rows 
corresponding to those in <code>response</code>. (dimension <em>n</em> x <em>p</em>).</p>
</td></tr>
<tr><td><code id="fCWM_SNC_+3A_datatraits">dataTraits</code></td>
<td>
<p>matrix or data frame of the column predictors, with rows 
corresponding to the columns in <code>response</code>.
(dimension <em>m</em> x <em>q</em>).</p>
</td></tr>
<tr><td><code id="fCWM_SNC_+3A_formulaenv">formulaEnv</code></td>
<td>
<p>formula or one-sided formula for the rows (samples) with 
row predictors in <code>dataEnv</code>. When two-sided, the left hand side of 
the formula is not used. Specify row covariates (if any ) by 
adding <code>+ Condition(covariate-formula)</code> to <code>formulaEnv</code> as 
in <code><a href="vegan.html#topic+rda">rda</a></code>. The <code>covariate-formula</code> should not contain 
a <code>~</code> (tilde). Default: <code>NULL</code> for <code>~.</code>, i.e. all variables 
in <code>dataEnv</code> are predictor variables.</p>
</td></tr>
<tr><td><code id="fCWM_SNC_+3A_formulatraits">formulaTraits</code></td>
<td>
<p>formula or one-sided formula for the columns (species) 
with column predictors in <code>dataTraits</code>. When two-sided, the left hand 
side of the formula is not used. Specify column covariates (if any ) by 
adding <code>+ Condition(covariate-formula)</code> to <code>formulaTraits</code> as 
in <code><a href="vegan.html#topic+cca">cca</a></code>. The <code>covariate-formula</code> should not contain 
a <code>~</code> (tilde). Default: <code>NULL</code> for <code>~.</code>, i.e. all variables 
in <code>dataTraits</code> are predictor traits.</p>
</td></tr>
<tr><td><code id="fCWM_SNC_+3A_dividebysitetotals">divideBySiteTotals</code></td>
<td>
<p>logical; default <code>TRUE</code> for closing the 
data by dividing the rows in the <code>response</code> by their total.</p>
</td></tr>
<tr><td><code id="fCWM_SNC_+3A_dc_ca_object">dc_CA_object</code></td>
<td>
<p>optional object from an earlier run of this function. 
Useful if the same formula for the columns (<code>formulaTraits</code>), 
<code>dataTraits</code> and <code>response</code> are used with a new formula for the 
rows. If set, the data of the previous run is used and the result of its 
first step is taken for the new analysis.</p>
</td></tr>
<tr><td><code id="fCWM_SNC_+3A_minimal_output">minimal_output</code></td>
<td>
<p>logical. Default <code>TRUE</code> for use of the return 
value as <code>response</code> in a call to <code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="fCWM_SNC_+3A_verbose">verbose</code></td>
<td>
<p>logical for printing a simple summary (default: TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>formulaTraits</code> determines which CWMs are calculated.
The CWMs are calculated from the trait data (non-centered, non-standardized).
With trait covariates, the other predictor traits are adjusted for the trait 
covariates by weighted regression, after which the overall weighted mean 
trait is added. This has the advantage that each CWM has the scale of the 
original trait.
</p>
<p>The SNCs are calculated analogously from environmental data.
</p>
<p>Empty (all zero) rows and columns in <code>response</code> are removed from 
the <code>response</code> and the corresponding rows from <code>dataEnv</code> and 
<code>dataTraits</code>. Subsequently, any columns with missing values are 
removed from  <code>dataEnv</code> and <code>dataTraits</code>. It gives an error 
(object 'name_of_variable' not found), if variables with missing entries
are specified in <code>formulaEnv</code> and <code>formulaTraits</code>.
</p>
<p>In the current implementation, <code>formulaEnv</code> and <code>formulaTraits</code> 
should contain variable names as is, <em>i.e.</em> transformations of 
variables in the formulas gives an error ('undefined columns selected') 
when the <code><a href="#topic+scores">scores</a></code> function is applied.
</p>


<h3>Value</h3>

<p>The default returns a list of CWM, SNC, weights, <code>formulaTraits</code> and
inertia (weighted variance explained by the traits and by the environmental
variables) a list of data with elements <code>dataEnv</code> and <code>dataTraits</code>. 
When  <code>minimal_output = FALSE</code>, some more statistics are given that are 
mainly technical or recomputed when the return value is used as 
<code>response</code> in a call to <code><a href="#topic+dc_CA">dc_CA</a></code>.
</p>


<h3>References</h3>

<p>Kleyer, M., Dray, S., Bello, F., Lepš, J., Pakeman, R.J., Strauss, 
B., Thuiller, W. &amp; Lavorel, S. (2012) Assessing species and community 
functional responses to environmental gradients: which multivariate methods?
Journal of Vegetation Science, 23, 805-821.
<a href="https://doi.org/10.1111/j.1654-1103.2012.01402.x">doi:10.1111/j.1654-1103.2012.01402.x</a>
</p>
<p>ter Braak, CJF, Šmilauer P, and Dray S. 2018. Algorithms and biplots for
double constrained correspondence analysis.
Environmental and Ecological Statistics, 25(2), 171-197.
<a href="https://doi.org/10.1007/s10651-017-0395-x">doi:10.1007/s10651-017-0395-x</a> 
</p>
<p>ter Braak C.J.F. and  P. Šmilauer  (2018). Canoco reference manual
and user's guide: software for ordination (version 5.1x).
Microcomputer Power, Ithaca, USA, 536 pp.
</p>
<p>Oksanen, J., et al. (2022)
vegan: Community Ecology Package. R package version 2.6-4.
<a href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dc_CA">dc_CA</a></code>, <code><a href="#topic+plot.dcca">plot.dcca</a></code>, 
<code><a href="#topic+scores.dcca">scores.dcca</a></code>, <code><a href="#topic+print.dcca">print.dcca</a></code> and 
<code><a href="#topic+anova.dcca">anova.dcca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

CWMSNC &lt;- fCWM_SNC(formulaEnv = ~ A1 + Moist + Manure + Use + Condition(Mag),
                   formulaTraits = ~ SLA + Height + LDMC + Condition(Seedmass) + Lifespan,
                   response = dune_trait_env$comm[, -1],  # must delete "Sites"
                   dataEnv = dune_trait_env$envir,
                   dataTraits = dune_trait_env$traits)
names(CWMSNC)
#CWMSNC$SNC &lt;- NULL # would give correct dc-CA but no species-level t-values or test
mod &lt;- dc_CA(response = CWMSNC) # formulas and data are in CWMSNC!
# note that output also gives the environment-constrained inertia,
# which is a bonus compare to the usual way to carry out a dcCA.
anova(mod)

</code></pre>

<hr>
<h2 id='fitted.dcca'>Fitted values of double-constrained correspondence analysis (dc-CA)</h2><span id='topic+fitted.dcca'></span>

<h3>Description</h3>

<p>Community weighted means (CWM) and species-niche centroids (SNC),
as fitted (in full or reduced rank) from the environmental data and
trait data, respectively, and  
the fitted response from trait and environment data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dcca'
fitted(object, ..., type = c("CWM", "SNC", "response"), rank = "full")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.dcca_+3A_object">object</code></td>
<td>
<p>return value of <code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="fitted.dcca_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the function (currently ignored).</p>
</td></tr>
<tr><td><code id="fitted.dcca_+3A_type">type</code></td>
<td>
<p>type of prediction, <code>c( "CWM","SNC", "response")</code> 
for environmental values, values of traits, 
response (expected abundance).</p>
</td></tr>
<tr><td><code id="fitted.dcca_+3A_rank">rank</code></td>
<td>
<p>rank (number of axes to use). Default &quot;full&quot; for all axes 
(no rank-reduction).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>type="response"</code> the rowsums of <code>object$data$Y</code> are used
to scale the fit to these sums. Many of the predicted response values may 
be negative,  indicating expected absences (0) or small expected response 
values.
</p>


<h3>Value</h3>

<p>a matrix with fitted value. The exact content of the matrix 
depends on the <code>type</code> of fits that are asked for.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Condition(Manure),
             formulaTraits = ~ SLA + Height + LDMC + Condition(Seedmass) + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits, 
             verbose = FALSE)
# fit the mean traits at each site (20x6),
# that is CWM at each site
CWM.traits &lt;- fitted(mod, type = "CWM")
head(CWM.traits)

# fit the mean environment for each species (28x8)
# that is SNC of each species
SNC.env &lt;- fitted(mod, type = "SNC")
head(SNC.env)

fit.resp &lt;- fitted(mod, type = "response")
# fitted often gives negative values and dc_CA cannot have negatives in the 
# response so, modify fit.resp,
# which gives about similar eigenvalues as the original data
fit.resp[fit.resp &lt; 0] &lt;- 0
mod3 &lt;- dc_CA(formulaEnv = mod$formulaEnv,
              formulaTraits = mod$formulaTraits,
              response = fit.resp, 
              dataEnv = dune_trait_env$envir,
              dataTraits = dune_trait_env$traits, 
              verbose = FALSE)
mod3$eigenvalues / mod$eigenvalues

</code></pre>

<hr>
<h2 id='getPlotdata'>Utility function: extracting data from a <code><a href="#topic+dc_CA">dc_CA</a></code> object for 
plotting a single axis by your own code or <code><a href="#topic+plot.dcca">plot.dcca</a></code>.</h2><span id='topic+getPlotdata'></span>

<h3>Description</h3>

<p><code>getPlotdata</code> extracts data from a <code><a href="#topic+dc_CA">dc_CA</a></code> object for 
plotting the CWMs and SNCs of a single axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPlotdata(
  x,
  axis = 1,
  envfactor = NULL,
  traitfactor = NULL,
  newnames = NULL,
  facet = TRUE,
  remove_centroids = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPlotdata_+3A_x">x</code></td>
<td>
<p>results from <code><a href="#topic+dc_CA">dc_CA</a></code> of class <code>dcca</code>.</p>
</td></tr>
<tr><td><code id="getPlotdata_+3A_axis">axis</code></td>
<td>
<p>the axis number to get (default 1).</p>
</td></tr>
<tr><td><code id="getPlotdata_+3A_envfactor">envfactor</code></td>
<td>
<p>name of row factor to display as color and lines in the CWM
plot (default <code>NULL</code>). The default extracts the factor from the 
environmental model. If set to <code>NA</code>, no additional coloring and lines
are displayed in <code><a href="#topic+plot.dcca">plot.dcca</a></code>. The parameter sets the 
<code>groups</code> variable in the <code>CWM_SNC</code> data frame of the return 
value/in the plot.</p>
</td></tr>
<tr><td><code id="getPlotdata_+3A_traitfactor">traitfactor</code></td>
<td>
<p>name of column factor to display as color and lines in
the SNC plot (default <code>NULL</code>). The default extracts the factor from
the trait model. If set to <code>NA</code>, no additional coloring and lines are
displayed in <code><a href="#topic+plot.dcca">plot.dcca</a></code>. The parameter sets the <code>groups</code> 
variable in the <code>CWM_SNC</code> data frame of the return value/in the plot.</p>
</td></tr>
<tr><td><code id="getPlotdata_+3A_newnames">newnames</code></td>
<td>
<p>a list  with two elements: names for traits and for 
environmental variables, default <code>NULL</code> for names derived from the 
result of <code><a href="#topic+scores.dcca">scores.dcca</a></code> with <code>tidy = TRUE</code>.</p>
</td></tr>
<tr><td><code id="getPlotdata_+3A_facet">facet</code></td>
<td>
<p>logical. Default <code>TRUE</code> for CWMs and SNCs plots in 
separate panels. If <code>FALSE</code>, this parameter changes the position of 
the environmental centroid names (from left to right).</p>
</td></tr>
<tr><td><code id="getPlotdata_+3A_remove_centroids">remove_centroids</code></td>
<td>
<p>logical to remove any centroids from the plot data 
(default <code>FALSE</code>). Can be a two-vector, <em>e.g.</em> 
<code>c(TRUE, FALSE)</code> to remove only the trait centroids.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current implementation sets the <code>traitfactor</code> to
<code>NA</code> if the trait model contains more than a single trait factor 
and the <code>envfactor</code> to <code>NA</code> if the environmental model
contains more than a single environmental factor.
</p>


<h3>Value</h3>

<p>A list with three components
</p>

<dl>
<dt>CWM_SNC</dt><dd><p>a data.frame containing plot data</p>
</dd>
<dt>trait_env_scores</dt><dd><p>a vector of scores per trait/environment</p>
</dd>
<dt>newNameList</dt><dd><p>a vector of new names to be used in the plot</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

# must delete "Sites" from response matrix or data frame
Y &lt;- dune_trait_env$comm[, -1] # must delete "Sites"

out &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Use + Manure + Mag,
                   formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
                   response = Y,
                   dataEnv = dune_trait_env$envir,
                   dataTraits = dune_trait_env$traits,
                   verbose = FALSE)
dat &lt;- getPlotdata(out)
names(dat)
names(dat$CWM_SNC)
levels(dat$CWM_SNC$groups)

plot(out)
</code></pre>

<hr>
<h2 id='plot_dcCA_CWM_SNC'>Plot the CWMs and SNCs of a single dc-CA axis.</h2><span id='topic+plot_dcCA_CWM_SNC'></span>

<h3>Description</h3>

<p><code>plot_dcCA_CWM_SNC</code> plots the CWMs and SNCs of a dc-CA axis against 
this axis, with optional centroids and colors for groups of sites and/or 
species if available in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_dcCA_CWM_SNC(
  x,
  axis = 1,
  envfactor = NULL,
  traitfactor = NULL,
  facet = TRUE,
  newnames = NULL,
  remove_centroids = FALSE,
  with_lines = 2,
  formula = y ~ x,
  getPlotdata2plotdCCA = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_x">x</code></td>
<td>
<p>results from <code><a href="#topic+dc_CA">dc_CA</a></code> of class <code>dcca</code>.</p>
</td></tr>
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_axis">axis</code></td>
<td>
<p>the axis number to get (default 1).</p>
</td></tr>
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_envfactor">envfactor</code></td>
<td>
<p>name of row factor to display as color and lines in the CWM
plot (default <code>NULL</code>). The default extracts the factor from the 
environmental model. If set to <code>NA</code>, no additional coloring and lines
are displayed in <code><a href="#topic+plot.dcca">plot.dcca</a></code>. The parameter sets the 
<code>groups</code> variable in the <code>CWM_SNC</code> data frame of the return 
value/in the plot.</p>
</td></tr>
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_traitfactor">traitfactor</code></td>
<td>
<p>name of column factor to display as color and lines in
the SNC plot (default <code>NULL</code>). The default extracts the factor from
the trait model. If set to <code>NA</code>, no additional coloring and lines are
displayed in <code><a href="#topic+plot.dcca">plot.dcca</a></code>. The parameter sets the <code>groups</code> 
variable in the <code>CWM_SNC</code> data frame of the return value/in the plot.</p>
</td></tr>
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_facet">facet</code></td>
<td>
<p>logical. Default <code>TRUE</code> for CWMs and SNCs plots in 
separate panels. This parameter changes the position of the centroid names
(from left to right for the environmental centroids). If <code>facet = TRUE</code>
and <code>with_lines = TRUE</code>, the line fits ignore groups of species and 
of sites.</p>
</td></tr>
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_newnames">newnames</code></td>
<td>
<p>a list  with two elements: names for traits and for 
environmental variables, default <code>NULL</code> for names derived from the 
result of <code><a href="#topic+scores.dcca">scores.dcca</a></code> with <code>tidy = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_remove_centroids">remove_centroids</code></td>
<td>
<p>logical to remove any centroids from the plot data 
(default <code>FALSE</code>). Can be a two-vector, <em>e.g.</em> 
<code>c(TRUE, FALSE)</code> to remove only the trait centroids.</p>
</td></tr>
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_with_lines">with_lines</code></td>
<td>
<p>integer values (0,1,2). Default <code>2</code> for straight lines 
through groups of points, with confidence intervals around the lines. 
<code>with_lines=1</code> drops the confidence intervals and
<code>with_lines=0</code> suppresses the lines.</p>
</td></tr>
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_formula">formula</code></td>
<td>
<p>formula to use by ggplot geom_smooth (default y~x).</p>
</td></tr>
<tr><td><code id="plot_dcCA_CWM_SNC_+3A_getplotdata2plotdcca">getPlotdata2plotdCCA</code></td>
<td>
<p>the results of an <code><a href="#topic+getPlotdata">getPlotdata</a></code>. 
Default <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>getPlotdata2plotdCCA</code> is to allow some modifications of
the data frame resulting from <code><a href="#topic+getPlotdata">getPlotdata</a></code>. The variable names
and score levels should remain untouched. <code>plot_dcCA_CWM_SNC</code> uses the
variables: <code>dcCA</code><em>k</em> with axis number <em>k</em> and
<code>"CWM-SNC", "groups", "points", "sizeweight"</code> for the y-axis, coloring, 
shape and size of items, respectively.
</p>
<p>The current implementation does not distinguish groups of points, if there
are two or more factors specified in the model. 
No lines are plotted if  a single factor defines a model. 
</p>
<p>The function is used in <code><a href="#topic+plot.dcca">plot.dcca</a></code>.
</p>


<h3>Value</h3>

<p>a ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

# must delete "Sites" from response matrix or data frame
Y &lt;- dune_trait_env$comm[, -1] # must delete "Sites"

out &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Use + Manure + Condition(Mag),
             formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
             response = Y,
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
             verbose = FALSE)

plot_dcCA_CWM_SNC(out, facet = FALSE)

</code></pre>

<hr>
<h2 id='plot_species_scores_bk'>Vertical ggplot2 line plot of ordination scores</h2><span id='topic+plot_species_scores_bk'></span>

<h3>Description</h3>

<p><code>plot_species_scores_bk</code> creates a vertical line plot of ordination 
scores with selection criterion for which scores to plot with names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_species_scores_bk(
  species_scores,
  ylab = "scores",
  threshold = 7,
  y_lab_interval = 0.5,
  speciesname = NULL,
  scoresname = "RDA1",
  selectname = "Fratio1",
  speciesgroup = NULL,
  expand = 0.2,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_species_scores_bk_+3A_species_scores">species_scores</code></td>
<td>
<p>a species-by-scores matrix, a data frame with 
row names (species names) or a tibble with variable with name
<code>speciesname</code> containing species names and a column or variable with 
name <code>scoresname</code> containing the scores (default: <code>"RDA1"</code>), e.g.
species scores from library <code>vegan</code>.</p>
</td></tr>
<tr><td><code id="plot_species_scores_bk_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label. Default: $b_k$.</p>
</td></tr>
<tr><td><code id="plot_species_scores_bk_+3A_threshold">threshold</code></td>
<td>
<p>species with criterion (specified by <code>selectname</code>) 
higher than the <code>threshold</code> are displayed. Default: 7 (which is the 
threshold F-ratio for testing a single regression coefficient at
<code>p = 0.01</code> with <code>60</code> df for the error in a multiple regression
of each single species onto the condition and the ordination axis). If 
<code>selectname</code> is not in <code>species_scores</code>, the <code>threshold</code> is 
divided by <code>14</code>, so that the default is 0.5.</p>
</td></tr>
<tr><td><code id="plot_species_scores_bk_+3A_y_lab_interval">y_lab_interval</code></td>
<td>
<p>interval of the y-axis ticks. A tick at no effect (0) 
is always included; default: 0.5.</p>
</td></tr>
<tr><td><code id="plot_species_scores_bk_+3A_speciesname">speciesname</code></td>
<td>
<p>name of the variable containing the species names 
(default <code>NULL</code> uses row names).</p>
</td></tr>
<tr><td><code id="plot_species_scores_bk_+3A_scoresname">scoresname</code></td>
<td>
<p>name of the column or variable containing the species 
scores to be plotted (default <code>"RDA1"</code>).</p>
</td></tr>
<tr><td><code id="plot_species_scores_bk_+3A_selectname">selectname</code></td>
<td>
<p>name of the column or variable containing the criterion 
for the selection of species to be displayed. Default: <code>"Fratio1"</code>; 
if <code>selectname</code> is not found in <code>species_scores</code>, set 
to <code>scoresname</code>.</p>
</td></tr>
<tr><td><code id="plot_species_scores_bk_+3A_speciesgroup">speciesgroup</code></td>
<td>
<p>name of the factor, the levels of which
receive different colors in the vertical plot.</p>
</td></tr>
<tr><td><code id="plot_species_scores_bk_+3A_expand">expand</code></td>
<td>
<p>amount of extension of the line plot (default 0.2).</p>
</td></tr>
<tr><td><code id="plot_species_scores_bk_+3A_verbose">verbose</code></td>
<td>
<p>logical for printing the number of species with names out of
the total number (default: <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The absolute value of the criterion values is taken before selection, so 
that also the species scores of the ordination can serve as a criterion
(e.g. <code>selectname = "RDA1"</code>). The function has been copied from 
the <code>PRC</code> package at <a href="https://github.com/CajoterBraak/PRC">https://github.com/CajoterBraak/PRC</a>.
</p>
<p>The function is used in <code><a href="#topic+plot.dcca">plot.dcca</a></code>.
</p>


<h3>Value</h3>

<p>a ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure,
             formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
             verbose = FALSE)

env_scores &lt;- scores(mod, display = "tval")

env_scores &lt;- data.frame(env_scores)
env_scores$group &lt;- c("quantitative", "category")[c(1, 1, 2, 2, 2, 1, 1)]									
plot_species_scores_bk(
  species_scores = env_scores,
  ylab = "optimistic t-values",  threshold = 0,  y_lab_interval = 1,
  scoresname = "dcCA1", speciesgroup = "group", verbose = FALSE
)
</code></pre>

<hr>
<h2 id='plot.dcca'>Plot a single dc-CA axis with CWMs, SNCs, trait and environment scores.</h2><span id='topic+plot.dcca'></span>

<h3>Description</h3>

<p><code>plot.dcca</code> plots the CWMs and SNCs of a dc-CA axis against this axis,
with optional centroids and colors for groups of sites and/or species if 
available in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dcca'
plot(
  x,
  ...,
  axis = 1,
  gradient_description = "correlation",
  envfactor = NULL,
  traitfactor = NULL,
  nspecies = 20,
  species_groups = NULL,
  widths = c(5, 1, 1),
  newnames = NULL,
  facet = TRUE,
  remove_centroids = FALSE,
  with_lines = 2,
  flip_axis = FALSE,
  expand = 0.2,
  formula = y ~ x,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.dcca_+3A_x">x</code></td>
<td>
<p>results from <code><a href="#topic+dc_CA">dc_CA</a></code> of class <code>dcca</code>.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_...">...</code></td>
<td>
<p>unused.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_axis">axis</code></td>
<td>
<p>the axis number to get (default 1).</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_gradient_description">gradient_description</code></td>
<td>
<p>character or 2-character vector for the trait
and environmental gradient, respectively specifying what to plot in the 
vertical line plots to describe the dc-CA axis (trait and environmental 
gradients). Default: <code>correlation</code> for intra-set correlations of both 
sets of variables with their dc-CA axis. Other values are: 
<code>c("weights", "tvalues", "inter_set_correlation")</code> for 
regression weights, t-values and inter-set correlation, 
being the correlation of the SNCs and CWMs with the traits and environmental
variables, respectively. <code>"regression"</code> is an alias for <code>"weights"</code>.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_envfactor">envfactor</code></td>
<td>
<p>name of row factor to display as color and lines in the CWM
plot (default <code>NULL</code>). The default extracts the factor from the 
environmental model. If set to <code>NA</code>, no additional coloring and lines
are displayed in <code><a href="#topic+plot.dcca">plot.dcca</a></code>. The parameter sets the 
<code>groups</code> variable in the <code>CWM_SNC</code> data frame of the return 
value/in the plot.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_traitfactor">traitfactor</code></td>
<td>
<p>name of column factor to display as color and lines in
the SNC plot (default <code>NULL</code>). The default extracts the factor from
the trait model. If set to <code>NA</code>, no additional coloring and lines are
displayed in <code><a href="#topic+plot.dcca">plot.dcca</a></code>. The parameter sets the <code>groups</code> 
variable in the <code>CWM_SNC</code> data frame of the return value/in the plot.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_nspecies">nspecies</code></td>
<td>
<p>integer. Default <code>20</code> for including a vertical species 
plot with at most <code>nspecies</code> that have the highest contribution.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_species_groups">species_groups</code></td>
<td>
<p>name of a variable in <code>dataTraits</code> of 
<code><a href="#topic+dc_CA">dc_CA</a></code>. Default <code>NULL</code> for no grouping. 
Species groups are colored differentially.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_widths">widths</code></td>
<td>
<p>relative widths of the CWM-SNC plot, the correlation/weight
plot and the species plot. (see <code><a href="gridExtra.html#topic+grid.arrange">grid.arrange</a></code>). 
Default <code>c(5, 1, 1)</code>.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_newnames">newnames</code></td>
<td>
<p>a list  with two elements: names for traits and for 
environmental variables, default <code>NULL</code> for names derived from the 
result of <code><a href="#topic+scores.dcca">scores.dcca</a></code> with <code>tidy = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_facet">facet</code></td>
<td>
<p>logical. Default <code>TRUE</code> for CWMs and SNCs plots in 
separate panels. This parameter changes the position of the centroid 
names (from left to right for the environmental centroids). If 
<code>facet = FALSE</code> and <code>with_lines = TRUE</code>, the line fits ignore 
groups of species and of sites.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_remove_centroids">remove_centroids</code></td>
<td>
<p>logical to remove any centroids from the plot data 
(default <code>FALSE</code>). Can be a two-vector, <em>e.g.</em> 
<code>c(TRUE, FALSE)</code> to remove only the trait centroids.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_with_lines">with_lines</code></td>
<td>
<p>integer values (0,1,2). Default <code>2</code> for straight lines 
through groups of points, with confidence intervals around the lines. 
<code>with_lines=1</code> drops the confidence intervals and
<code>with_lines=0</code> suppresses the lines.</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_flip_axis">flip_axis</code></td>
<td>
<p>flip the direction of the axis? (default FALSE).</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_expand">expand</code></td>
<td>
<p>amount of extension of the line plot (default 0.2).</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_formula">formula</code></td>
<td>
<p>formula to use by ggplot geom_smooth (default y~x).</p>
</td></tr>
<tr><td><code id="plot.dcca_+3A_verbose">verbose</code></td>
<td>
<p>logical. Default <code>TRUE</code> for plotting the result.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current implementation does not distinguish groups of points, if there
are two or more factors specified in the model.
If you want to label one trait factor, specify 
<code>traitfactor="yourfactor"</code> and similarly
specify <code>envfactor="yourfactor"</code> for your environmental factor.
</p>
<p>No lines are plotted if a single factor defines a model. 
</p>
<p>If you want to set new names, look at the names with all arguments default, 
i.e. <code>myplot &lt;- plot(x)</code>, and then consult 
<code>myplot$nameList$newnames</code> for the order of the names of traits and
environmental variables. Note that covariates should not be in the list of
names. Contribution (in the definition of species selection in 
<code>nspecies</code>) is defined (as in CA) as the total species abundance in 
the (possibly, closed) data multiplied by the square of the score on 
the axis.
</p>
<p>If the <code>plot.dcca</code> returns the error <code>"Error in grid.Call"</code>, 
enlarge the plotting area or use <code>verbose = FALSE</code> and assign the 
result.
</p>


<h3>Value</h3>

<p>a ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

# must delete "Sites" from response matrix or data frame
Y &lt;- dune_trait_env$comm[, -1] # must delete "Sites"

out &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Use + Manure + Mag,
                   formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
                   response = Y,
                   dataEnv = dune_trait_env$envir,
                   dataTraits = dune_trait_env$traits,
                   verbose = FALSE)
dat &lt;- getPlotdata(out)
names(dat)
names(dat$CWM_SNC)
levels(dat$CWM_SNC$groups)

plot(out)
</code></pre>

<hr>
<h2 id='predict.dcca'>Prediction for double-constrained correspondence analysis (dc-CA)</h2><span id='topic+predict.dcca'></span>

<h3>Description</h3>

<p>Prediction of traits from environment, environment from traits and response 
from trait and environment data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dcca'
predict(
  object,
  ...,
  type = c("envFromTraits", "traitsFromEnv", "response", "SNC", "CWM", "lc", "lc_traits"),
  rank = "full",
  newdata = NULL,
  weights = NULL,
  scaling = "symmetric"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.dcca_+3A_object">object</code></td>
<td>
<p>return value of <code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="predict.dcca_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the function (currently ignored).</p>
</td></tr>
<tr><td><code id="predict.dcca_+3A_type">type</code></td>
<td>
<p>type of prediction, <code>c("envFromTraits", "traitsFromEnv",
"response", "lc", "lc_traits")</code> for environmental values, values of traits, 
response (expected abundance) and constrained scores for sites and species. 
<code>"SNC"</code> is equivalent with <code>"envFromTraits"</code>.
<code>"CWM"</code> is equivalent with <code>"traitsFromEnv"</code>.</p>
</td></tr>
<tr><td><code id="predict.dcca_+3A_rank">rank</code></td>
<td>
<p>rank (number of axes to use). Default &quot;full&quot; for all axes 
(no rank-reduction).</p>
</td></tr>
<tr><td><code id="predict.dcca_+3A_newdata">newdata</code></td>
<td>
<p>Data in which to look for variables with which to predict.
For <code>type = "envFromTraits" or "traitsFromEnv"</code> or 
<code>type = "lc_traits" or "lc"</code>,
<code>newdata</code> is a data frame of trait and environmental values, respectively, 
which are used for the prediction or the calculation of scores.
If omitted, fitted values are generated (use <code><a href="#topic+fitted.dcca">fitted.dcca</a></code> instead).
For <code>type = "response"</code>, newdata is a list of two data frames with 
trait and environmental values in this order, <em>e.g.</em> 
<code>list(traits = dataTraits, env = dataEnv)</code>.</p>
</td></tr>
<tr><td><code id="predict.dcca_+3A_weights">weights</code></td>
<td>
<p>list of weights of species and of sites in <code>newdata</code> when
<code>type = "response"</code>, else ignored (default NULL
yielding equal species and site weights, both summing to 1). 
Example: weights = list(species = c(100, 1, 1), sites = c(1, 1, 1, 1)), in that
order, with traits of three new species in newdata[[1]] and 
environmental values (and levels of factors) of four new sites in newdata[[2]]. 
Species weights are scaled to a sum of one.</p>
</td></tr>
<tr><td><code id="predict.dcca_+3A_scaling">scaling</code></td>
<td>
<p>numeric (1,2 or 3) or character <code>"sites", "species" or
"symmetric"</code>. Default: &quot;symmetric&quot;. Either site- (1) or species- (2) related
scores are scaled by eigenvalues, and the other set of scores have
unit weighted mean square or with 3 both are scaled symmetrically 
to weighted mean squares equal to the square root of eigenvalues. Negative 
values are treated as the corresponding positive ones by <code>abs(scaling)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Variables that are in the model but not in <code>newdata</code> are set to their 
weighted means in the training data. Predictions are thus at the (weighted)
mean of the quantitative variables not included. Predictions with 
not-included factors are at the reference level (the first level of the 
factor).
</p>
<p>For <code>type = "response"</code>, many of the predicted values may be negative, 
indicating expected absences (0) or small expected response values.
</p>
<p>With <code>type = "traitsFromEnv"</code> and <code>newdata = NULL</code>, predict gives 
the  fitted mean traits, <em>i.e.</em> the fitted community weighted means.
With <code>type = "envFromTraits"</code> and <code>newdata = NULL</code>, predict gives
the  fitted mean environment, <em>i.e.</em> the fitted species niche centroids
(see <code><a href="#topic+fitted.dcca">fitted.dcca</a></code>). See <code>fitted.dcca</code>.
</p>


<h3>Value</h3>

<p>a matrix with the predictions. The exact content of the matrix 
depends on the <code>type</code> of predictions that are being made.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Condition(Manure),
             formulaTraits = ~ SLA + Height + LDMC + Condition(Seedmass) + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
             verbose = FALSE)

# Ten 'new' sites with a subset of the variables in mod 
# X_lot will be ignored as it is not part of the model
newEnv &lt;- dune_trait_env$envir[1:10, c("A1", "Mag", "Manure", "X_lot")]
newEnv[2,"A1"] &lt;- 3.0
rownames(newEnv) &lt;- paste0("NewSite", 1:10)

pred.traits &lt;- predict(mod, type = "traitsFromEnv", newdata = newEnv)
head(pred.traits)


# Eight 'new' species with a subset of traits that are included in the model 
# Variable "L" will be ignored as it is not in the model 
newTraits &lt;- dune_trait_env$traits[1:8, c("Species", "SLA", "LDMC", "L")]
newTraits[3,"SLA"]&lt;- 18 
rownames(newTraits) &lt;- paste("Species",LETTERS[1:8] )# or another meaningful name.

pred.env &lt;- predict(mod, type = "envFromTraits", newdata = newTraits)
head(pred.env)


pred.resp &lt;- predict(mod, type = "response", newdata = list(newTraits, newEnv),
                     weights = list(species = rep(1:2, 4), sites = rep(1, 10)))
colSums(pred.resp) # about alternating 0.8 and 1.6 (reflecting the new species weights)
rowSums(pred.resp) # about equal rowsums
</code></pre>

<hr>
<h2 id='print.dcca'>Print a summary of a dc-CA object.</h2><span id='topic+print.dcca'></span>

<h3>Description</h3>

<p>Print a summary of a dc-CA object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dcca'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.dcca_+3A_x">x</code></td>
<td>
<p>a dc-CA object from <code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="print.dcca_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the function (currently ignored).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>x &lt;- print(x)</code> is more efficient for <code><a href="#topic+scores.dcca">scores.dcca</a></code> than 
just <code>print(x)</code> if <code><a href="#topic+dc_CA">dc_CA</a></code> is called with 
<code>verbose = FALSE</code>).
</p>


<h3>Value</h3>

<p>No return value, results are printed to console.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure,
             formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
			 verbose = FALSE)

print(mod) # same output as with verbose = TRUE (the default of verbose).																		 
anova(mod, by = "axis")
# For more demo on testing, see demo dune_test.r

mod_scores &lt;- scores(mod)
# correlation of axes with a variable that is not in the model
scores(mod, display = "cor", scaling = "sym", which_cor = list(NULL, "X_lot"))

cat("head of unconstrained site scores, with meaning\n")
print(head(mod_scores$sites))

mod_scores_tidy &lt;- scores(mod, tidy = TRUE)
print("names of the tidy scores")
print(names(mod_scores_tidy))
cat("\nThe levels of the tidy scores\n")
print(levels(mod_scores_tidy$score))

cat("\nFor illustration: a dc-CA model with a trait covariate\n")
mod2 &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,
              formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),
              response = dune_trait_env$comm[, -1],  # must delete "Sites"
              dataEnv = dune_trait_env$envir,
              dataTraits = dune_trait_env$traits)

cat("\nFor illustration: a dc-CA model with both environmental and trait covariates\n")
mod3 &lt;- dc_CA(formulaEnv = ~A1 + Moist + Use + Manure + Condition(Mag),
              formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),
              response = dune_trait_env$comm[, -1],  # must delete "Sites"
              dataEnv = dune_trait_env$envir,
              dataTraits = dune_trait_env$traits, 
			  verbose = FALSE)

cat("\nFor illustration: same model but using dc_CA_object = mod2 for speed, ", 
    "as the trait model and data did not change\n")
mod3B &lt;- dc_CA(formulaEnv = ~A1 + Moist + Use + Manure + Condition(Mag),
               dataEnv = dune_trait_env$envir,
               dc_CA_object = mod2, 
			   verbose= FALSE)
cat("\ncheck on equality of mod3 (from data) and mod3B (from a dc_CA_object)\n",
    "the expected difference is in the component 'call'\n ")
print(all.equal(mod3, mod3B)) #  only the component call differs


</code></pre>

<hr>
<h2 id='print.wrda'>Print a summary of a wrda object</h2><span id='topic+print.wrda'></span>

<h3>Description</h3>

<p>Print a summary of a wrda object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wrda'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.wrda_+3A_x">x</code></td>
<td>
<p>a wrda object from <code><a href="#topic+wrda">wrda</a></code></p>
</td></tr>
<tr><td><code id="print.wrda_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the function (currently ignored).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, results are printed to console.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites
response &lt;- dune_trait_env$comm[, -1]  # must delete "Sites"

w &lt;- rep(1, 20) 
w[1:10] &lt;- 8 
w[17:20] &lt;- 0.5

object &lt;- wrda(formula = ~ A1 + Moist + Mag + Use + Condition(Manure),
               response = response, 
               data = dune_trait_env$envir, 
               weights = w)
object # Proportions equal to those Canoco 5.15

mod_scores &lt;- scores(object, display = "all")
scores(object, which_cor = c("A1", "X_lot"), display = "cor")
anova(object)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+scores'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>vegan</dt><dd><p><code><a href="vegan.html#topic+scores">scores</a></code></p>
</dd>
</dl>

<hr>
<h2 id='scores.dcca'>Extract results of a double constrained correspondence analysis 
(dc-CA)</h2><span id='topic+scores.dcca'></span>

<h3>Description</h3>

<p>This function works very much like the <code>vegan</code> 
<code><a href="vegan.html#topic+scores">scores</a></code> function, in particular 
<code><a href="vegan.html#topic+scores.cca">scores.cca</a></code>, with the additional results such as 
regression coefficients and linear combinations of traits 
<code>('reg_traits', 'lc_traits')</code>. All scores from CA obey the so called
transition formulas and so do the scores of CCA and dc-CA. The differences
are, for CCA, that the linear combinations of environmental variables (the 
<em>constrained</em> site scores) replace the usual (<em>unconstrained</em>) 
site scores, and for dc-CA, that the linear combinations of traits (the 
<em>constrained</em> species scores) also replace the usual 
(<em>unconstrained</em>) species scores in the transition formulas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dcca'
scores(
  x,
  ...,
  choices = 1:2,
  display = "all",
  scaling = "sym",
  which_cor = "in model",
  normed = TRUE,
  tidy = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scores.dcca_+3A_x">x</code></td>
<td>
<p>object of class <code>"dcca"</code>, <em>i.e.</em> result of
<code><a href="#topic+dc_CA">dc_CA</a></code>.</p>
</td></tr>
<tr><td><code id="scores.dcca_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the function (currently ignored).</p>
</td></tr>
<tr><td><code id="scores.dcca_+3A_choices">choices</code></td>
<td>
<p>integer vector of which axes to obtain. Default: all dc-CA 
axes.</p>
</td></tr>
<tr><td><code id="scores.dcca_+3A_display">display</code></td>
<td>
<p>a character vector, one or more of <code>c("all", "species",
"sites", "sp", "wa", "lc", "bp", "cor", "ic", "reg", "tval", "cn", 
"lc_traits", "reg_traits", "tval_traits", "cor_traits", "ic_traits", 
"bp_traits", "cn_traits")</code>. The most items are as in 
<code><a href="vegan.html#topic+scores.cca">scores.cca</a></code>, except <code>"cor"</code> and <code>"ic"</code>, for
inter-set and intra-set correlations, respectively, and <code>"tval"</code> for
the (over-optimistic) t-values of the regression coefficients. The remaining
scores are analogous scores for species and traits.</p>
</td></tr>
<tr><td><code id="scores.dcca_+3A_scaling">scaling</code></td>
<td>
<p>numeric (1,2 or 3) or character <code>"sites", "species" or
"symmetric"</code>. Default: &quot;symmetric&quot;. Either site- (1) or species- (2) related
scores are scaled by eigenvalues, and the other set of scores have
unit weighted mean square or with 3 both are scaled symmetrically 
to weighted mean squares equal to the square root of eigenvalues. Negative 
values are treated as the corresponding positive ones by <code>abs(scaling)</code>.</p>
</td></tr>
<tr><td><code id="scores.dcca_+3A_which_cor">which_cor</code></td>
<td>
<p>character or list of trait and environmental variables 
names (in this order) in the data frames for which inter-set correlations 
must calculated. Default: a character (&quot;in_model&quot;) for all traits and 
variables in the model, including collinear variables and levels.</p>
</td></tr>
<tr><td><code id="scores.dcca_+3A_normed">normed</code></td>
<td>
<p>logical (default <code>TRUE</code>) giving standardized regression
coefficients and biplot scores. When <code>FALSE</code>, (regular)
regression coefficients and (unstandardized) biplot scores.</p>
</td></tr>
<tr><td><code id="scores.dcca_+3A_tidy">tidy</code></td>
<td>
<p>Return scores that are compatible with <code>ggplot2</code>: all 
scores are in a single data.frame, score type is identified by factor 
variable <code>score</code>, the names by variable <code>label</code>, and species 
weights (in <code><a href="#topic+dc_CA">dc_CA</a></code> are in variable <code>weight</code>. See 
<code><a href="vegan.html#topic+scores.cca">scores.cca</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is modeled after <code><a href="vegan.html#topic+scores.cca">scores.cca</a></code>.
</p>
<p>The t-ratios are taken from a multiple regression of the unconstrained
species (or site) scores on to the traits (or environmental variables).
</p>
<p>An example of <code>which_cor</code> is: <code>which_cor = list(traits = "SLA", 
env = c("acidity", "humidity"))</code>.
</p>


<h3>Value</h3>

<p>A data frame if <code>tidy = TRUE</code>. Otherwise, a matrix if a single
item is asked for and a named list of matrices if more than one item is 
asked for. The following names can be included: 
<code>c("sites", "constraints_sites", "centroids", "regression", "t_values",
"correlation", "intra_set_correlation", "biplot", "species", 
"constraints_species", "regression_traits", "t_values_traits", 
"correlation_traits", "intra_set_correlation_traits", "biplot_traits", 
"centroids_traits")</code>. Each matrix has an attribute <code>"meaning"</code> 
explaining its meaning. With  <code>tidy = TRUE</code>, the resulting data frame 
has attributes <code>"scaling"</code> and <code>"meaning"</code>; the latter has two 
columns: (1) name of score type and (2) its meaning, usage and 
interpretation.
</p>
<p>An example of the meaning of scores in scaling <code>"symmetric"</code> with 
<code>display ="all"</code>:
</p>

<dl>
<dt>sites</dt><dd><p> CMWs of the trait axes (constraints species) in scaling 
'symmetric' optimal for biplots and, almost so, for inter-site distances.</p>
</dd>
<dt>constraints_sites</dt><dd><p>linear combination of the environmental predictors 
and the covariates (making the ordination axes orthogonal to the 
covariates) in scaling 'symmetric' optimal for biplots and, almost so, 
for inter-site distances.</p>
</dd>
<dt>regression</dt><dd><p>mean, sd, VIF, standardized regression coefficients and 
their optimistic t-ratio in scaling 'symmetric'.</p>
</dd>
<dt>t_values</dt><dd><p>t-values of the coefficients of the regression of the CWMs 
of the trait composite on to the environmental variables</p>
</dd>
<dt>correlation</dt><dd><p>inter set correlation, correlation between environmental 
variables and the sites scores (CWMs)</p>
</dd>
<dt>intra_set_correlation</dt><dd><p>intra set correlation, correlation between
environmental variables and the dc-ca axis (constrained sites scores)</p>
</dd>
<dt>biplot</dt><dd><p>biplot scores of environmental variables for display with 
biplot-traits for fourth-corner correlations in scaling 'symmetric'.</p>
</dd>
<dt>centroids</dt><dd><p>environmental category means of the site scores in scaling 
'symmetric'  optimal for biplots and, almost so, for inter-environmental
category distances.</p>
</dd>
<dt>species</dt><dd><p>SNC on the environmental axes (constraints sites) in scaling 
'symmetric' optimal for biplots and, almost so, for inter-species 
distances.</p>
</dd>
<dt>constraints_species</dt><dd><p>linear combination of the traits and the trait 
covariates (making the ordination axes orthogonal to the covariates) in 
scaling 'symmetric' optimal for biplots and, almost so, for inter-species 
distances.</p>
</dd>
<dt>regression_traits</dt><dd><p>mean, sd, VIF, standardized regression 
coefficients and their optimistic t-ratio in scaling 'symmetric'.</p>
</dd>
<dt>t_values_traits</dt><dd><p>t-values of the coefficients of the regression of the
SNCs along a dc-CA axis on to the traits</p>
</dd>
<dt>correlation_traits</dt><dd><p>inter set correlation, correlation between 
traits and the species scores (SNCs)</p>
</dd>
<dt>intra_set_correlation_traits</dt><dd><p>intra set correlation, correlation 
between traits and the dc-ca axis (constrained species scores)</p>
</dd>
<dt>biplot_traits</dt><dd><p>biplot scores of traits for display with biplot scores
for fourth-corner correlation in scaling 'symmetric'.</p>
</dd>
<dt>centroids_traits</dt><dd><p>trait category means of the species scores in 
scaling 'symmetric' optimal for biplots and, almost so, for inter-trait 
category distances.</p>
</dd>
</dl>

<p>The statements on optimality for distance interpretations are based on the 
<code>scaling</code> and the relative magnitude of the dc-CA eigenvalues of the 
chosen axes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites

mod &lt;- dc_CA(formulaEnv = ~A1 + Moist + Mag + Use + Manure,
             formulaTraits = ~ SLA + Height + LDMC + Seedmass + Lifespan,
             response = dune_trait_env$comm[, -1],  # must delete "Sites"
             dataEnv = dune_trait_env$envir,
             dataTraits = dune_trait_env$traits,
			 verbose = FALSE)

print(mod) # same output as with verbose = TRUE (the default of verbose).																		 
anova(mod, by = "axis")
# For more demo on testing, see demo dune_test.r

mod_scores &lt;- scores(mod)
# correlation of axes with a variable that is not in the model
scores(mod, display = "cor", scaling = "sym", which_cor = list(NULL, "X_lot"))

cat("head of unconstrained site scores, with meaning\n")
print(head(mod_scores$sites))

mod_scores_tidy &lt;- scores(mod, tidy = TRUE)
print("names of the tidy scores")
print(names(mod_scores_tidy))
cat("\nThe levels of the tidy scores\n")
print(levels(mod_scores_tidy$score))

cat("\nFor illustration: a dc-CA model with a trait covariate\n")
mod2 &lt;- dc_CA(formulaEnv = ~ A1 + Moist + Mag + Use + Manure,
              formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),
              response = dune_trait_env$comm[, -1],  # must delete "Sites"
              dataEnv = dune_trait_env$envir,
              dataTraits = dune_trait_env$traits)

cat("\nFor illustration: a dc-CA model with both environmental and trait covariates\n")
mod3 &lt;- dc_CA(formulaEnv = ~A1 + Moist + Use + Manure + Condition(Mag),
              formulaTraits = ~ SLA + Height + LDMC + Lifespan + Condition(Seedmass),
              response = dune_trait_env$comm[, -1],  # must delete "Sites"
              dataEnv = dune_trait_env$envir,
              dataTraits = dune_trait_env$traits, 
			  verbose = FALSE)

cat("\nFor illustration: same model but using dc_CA_object = mod2 for speed, ", 
    "as the trait model and data did not change\n")
mod3B &lt;- dc_CA(formulaEnv = ~A1 + Moist + Use + Manure + Condition(Mag),
               dataEnv = dune_trait_env$envir,
               dc_CA_object = mod2, 
			   verbose= FALSE)
cat("\ncheck on equality of mod3 (from data) and mod3B (from a dc_CA_object)\n",
    "the expected difference is in the component 'call'\n ")
print(all.equal(mod3, mod3B)) #  only the component call differs


</code></pre>

<hr>
<h2 id='scores.wrda'>Extract results of a weighted redundancy analysis (wrda)</h2><span id='topic+scores.wrda'></span>

<h3>Description</h3>

<p>This function works very much like the <code>vegan</code> 
<code><a href="vegan.html#topic+scores">scores</a></code> function, in particular 
<code><a href="vegan.html#topic+scores.cca">scores.cca</a></code>, but with regression coefficients for 
predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wrda'
scores(
  x,
  ...,
  choices = 1:2,
  display = "all",
  scaling = "sym",
  which_cor = "in model",
  normed = TRUE,
  tidy = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scores.wrda_+3A_x">x</code></td>
<td>
<p>object of class <code>"wrda"</code>, <em>i.e.</em> result of 
<code><a href="#topic+wrda">wrda</a></code>.</p>
</td></tr>
<tr><td><code id="scores.wrda_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the function (currently ignored).</p>
</td></tr>
<tr><td><code id="scores.wrda_+3A_choices">choices</code></td>
<td>
<p>integer vector of which axes to obtain. Default: all wrda
axes.</p>
</td></tr>
<tr><td><code id="scores.wrda_+3A_display">display</code></td>
<td>
<p>a character vector, one or more of <code>c("all", "species",
"sites", "sp", "wa", "lc", "bp", "cor", "ic", "reg", "tval", "cn")</code>. The 
most items are as in <code><a href="vegan.html#topic+scores.cca">scores.cca</a></code>, except <code>"cor"</code> 
and <code>"ic"</code>, for inter-set and intra-set correlations, respectively, 
and <code>"tval"</code> for the (over-optimistic) t-values of the regression 
coefficients.</p>
</td></tr>
<tr><td><code id="scores.wrda_+3A_scaling">scaling</code></td>
<td>
<p>numeric (1,2 or 3) or character <code>"sites", "species" or 
"symmetric"</code>. Default: &quot;symmetric&quot;. Either site- (1) or species- (2) related
scores are scaled by eigenvalues, and the other set of scores have
unit weighted mean square or with 3 both are scaled symmetrically 
to weighted mean squares equal to the square root of eigenvalues. Negative 
values are treated as the corresponding positive ones by <code>abs(scaling)</code>.</p>
</td></tr>
<tr><td><code id="scores.wrda_+3A_which_cor">which_cor</code></td>
<td>
<p>character vector environmental variables names in the data
frames for which inter-set correlations must calculated. Default: a 
character (&quot;in_model&quot;) for all predictors in the model, including collinear 
variables and levels.</p>
</td></tr>
<tr><td><code id="scores.wrda_+3A_normed">normed</code></td>
<td>
<p>logical (default <code>TRUE</code>) giving standardized regression
coefficients and biplot scores. When <code>FALSE</code>, (regular)
regression coefficients and (unstandardized) biplot scores.</p>
</td></tr>
<tr><td><code id="scores.wrda_+3A_tidy">tidy</code></td>
<td>
<p>Return scores that are compatible with <code>ggplot2</code>: all 
variable <code>score</code>, the names by variable <code>label</code>. See
weights (in <code><a href="#topic+dc_CA">dc_CA</a></code> are in variable <code>weight</code>. See 
<code><a href="vegan.html#topic+scores.cca">scores.cca</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is modeled after <code><a href="vegan.html#topic+scores.cca">scores.cca</a></code>.
</p>
<p>An example of which_cor is: <code>which_cor = c("acidity", "humidity")</code>
</p>


<h3>Value</h3>

<p>A data frame if <code>tidy = TRUE</code>. Otherwise, a matrix if a single 
item is asked for and a named list of matrices if more than one item is 
asked for. The following names can be included: <code>c("sites", 
"constraints_sites", "centroids", "regression", "t_values", "correlation", 
"intra_set_correlation", "biplot", "species")</code>. Each matrix has an 
attribute <code>"meaning"</code> explaining its meaning. With <code>tidy = TRUE</code>, 
the resulting data frame  has attributes <code>"scaling"</code> and 
<code>"meaning"</code>; the latter has two columns: (1) name of score type and (2) 
its meaning, usage and interpretation.
</p>
<p>An example of the meaning of scores in scaling <code>"symmetric"</code> with 
<code>display = "all"</code>:
</p>

<dl>
<dt>sites</dt><dd><p>CMWs of the trait axes (constraints species) in scaling 
'symmetric' optimal for biplots and, almost so, for inter-site distances.</p>
</dd>
<dt>constraints_sites</dt><dd><p>linear combination of the environmental predictors 
and the covariates (making the ordination axes orthogonal to the covariates)
in scaling 'symmetric' optimal for biplots and, almost so, for inter-site
distances.</p>
</dd>
<dt>regression</dt><dd><p>mean, sd, VIF, standardized regression coefficients and 
their optimistic t-ratio in scaling 'symmetric'.</p>
</dd>
<dt>t_values</dt><dd><p>t-values of the coefficients of the regression of the 
CWMs of the trait composite on to the environmental variables</p>
</dd>
<dt>correlation</dt><dd><p>inter set correlation, correlation between environmental
variables and the sites scores (CWMs)</p>
</dd>
<dt>intra_set_correlation</dt><dd><p>intra set correlation, correlation between
environmental variables and the dc-ca axis (constrained sites scores)</p>
</dd>
<dt>biplot</dt><dd><p>biplot scores of environmental variables for display with 
biplot-traits for fourth-corner correlations in scaling 'symmetric'.</p>
</dd>
<dt>centroids</dt><dd><p>environmental category means of the site scores in 
scaling 'symmetric' optimal for biplots and, almost so, for 
inter-environmental category distances.</p>
</dd>
<dt>species</dt><dd><p>SNC on the environmental axes (constraints sites) in scaling
'symmetric' optimal for biplots and, almost so, for inter-species 
distances.</p>
</dd>
</dl>

<p>The statements on optimality for distance interpretations are based on the
<code>scaling</code> and the relative magnitude of the dc-CA eigenvalues of the 
chosen axes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites
response &lt;- dune_trait_env$comm[, -1]  # must delete "Sites"

w &lt;- rep(1, 20) 
w[1:10] &lt;- 8 
w[17:20] &lt;- 0.5

object &lt;- wrda(formula = ~ A1 + Moist + Mag + Use + Condition(Manure),
               response = response, 
               data = dune_trait_env$envir, 
               weights = w)
object # Proportions equal to those Canoco 5.15

mod_scores &lt;- scores(object, display = "all")
scores(object, which_cor = c("A1", "X_lot"), display = "cor")
anova(object)
</code></pre>

<hr>
<h2 id='wrda'>Performs a weighted redundancy analysis</h2><span id='topic+wrda'></span>

<h3>Description</h3>

<p><code>wrda</code> is formula-based implementation of weighted redundancy analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrda(formula, response, data, weights = rep(1, nrow(data)), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wrda_+3A_formula">formula</code></td>
<td>
<p>one or two-sided formula for the rows (samples) with row 
predictors in <code>data</code>. The left hand side of the formula is ignored as
it is specified in the next argument (<code>response</code>). Specify row 
covariates (if any ) by adding <code>+ Condition(covariate-formula)</code> to 
<code>formula</code> as in <code><a href="vegan.html#topic+rda">rda</a></code>. The <code>covariate-formula</code>
should not contain a <code>~</code> (tilde).</p>
</td></tr>
<tr><td><code id="wrda_+3A_response">response</code></td>
<td>
<p>matrix or data frame of the abundance data (dimension 
<em>n</em> x <em>m</em>). Rownames of <code>response</code>, if any, are carried 
through.</p>
</td></tr>
<tr><td><code id="wrda_+3A_data">data</code></td>
<td>
<p>matrix or data frame of the row predictors, with rows 
corresponding to those in <code>response</code> (dimension <em>n</em> x <em>p</em>).</p>
</td></tr>
<tr><td><code id="wrda_+3A_weights">weights</code></td>
<td>
<p>row weights (a vector). If not specified unit weights are 
used.</p>
</td></tr>
<tr><td><code id="wrda_+3A_verbose">verbose</code></td>
<td>
<p>logical for printing a simple summary (default: TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm is a modified version of published R-code for weighted 
redundancy analysis (ter Braak, 2022).
</p>
<p>In the current implementation, <code>formula</code> should contain variable names
as is, <em>i.e.</em> transformations of variables in the formulas gives
an error ('undefined columns selected') when the <code><a href="#topic+scores">scores</a></code> 
function is applied.
</p>
<p>Compared to  <code><a href="vegan.html#topic+rda">rda</a></code>, <code>wrda</code> does not have residual 
axes, <em>i.e.</em> no SVD or PCA of the residuals is performed.
</p>


<h3>Value</h3>

<p>All scores in the <code>dcca</code> object are in scaling <code>"sites"</code> (1): 
the scaling with <em>Focus on Case distances</em>.
</p>


<h3>References</h3>

<p>ter Braak C.J.F. and  P. Šmilauer  (2018). Canoco reference manual
and user's guide: software for ordination (version 5.1x).
Microcomputer Power, Ithaca, USA, 536 pp.
</p>
<p>Oksanen, J., et al. (2022)
vegan: Community Ecology Package. R package version 2.6-4.
<a href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scores.wrda">scores.wrda</a></code>, <code><a href="#topic+anova.wrda">anova.wrda</a></code>,
<code><a href="#topic+print.wrda">print.wrda</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("dune_trait_env")

# rownames are carried forward in results
rownames(dune_trait_env$comm) &lt;- dune_trait_env$comm$Sites
response &lt;- dune_trait_env$comm[, -1]  # must delete "Sites"

w &lt;- rep(1, 20) 
w[1:10] &lt;- 8 
w[17:20] &lt;- 0.5

object &lt;- wrda(formula = ~ A1 + Moist + Mag + Use + Condition(Manure),
               response = response, 
               data = dune_trait_env$envir, 
               weights = w)
object # Proportions equal to those Canoco 5.15

mod_scores &lt;- scores(object, display = "all")
scores(object, which_cor = c("A1", "X_lot"), display = "cor")
anova(object)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
