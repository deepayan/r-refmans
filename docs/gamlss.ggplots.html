<!DOCTYPE html><html><head><title>Help for package gamlss.ggplots</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gamlss.ggplots}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ACE'>
<p>Alternating Conditional Expectations</p></a></li>
<li><a href='#boot_coef'>
<p>Plotting Bootstrap Coefficients</p></a></li>
<li><a href='#centile_bucket'>
<p>Centile bucket plot</p></a></li>
<li><a href='#family_pdf'>
<p>Plotting Probabilities Density Functions (pdf's) for GAMLSS</p></a></li>
<li><a href='#fit_PB'>
<p>P-spline smoother</p></a></li>
<li><a href='#fitted_cdf'>
<p>Plotting Cumulative Distribution Functions (cdf's) for GAMLSS,</p></a></li>
<li><a href='#fitted_centiles'>
<p>Plotting centile (growth) curves</p></a></li>
<li><a href='#fitted_devianceIncr'><p>Plotting the deviance increment of GAMLSS</p></a></li>
<li><a href='#fitted_leverage'>
<p>Plot of the linear leverage of a GAMLSS model</p></a></li>
<li><a href='#fitted_terms'><p>Plotting fitted additive terms</p></a></li>
<li><a href='#gamlss.ggplots-package'>
<p>Plotting Functions for Generalized Additive Model for Location Scale and Shape</p></a></li>
<li><a href='#histSmo_plot'><p>Supporting histSmo()</p></a></li>
<li><a href='#model_GAIC'><p>Plotting GAIC for GAMLSS models</p></a></li>
<li><a href='#model_pca'><p>Plotting residuals using PCA</p></a></li>
<li><a href='#moment_bucket'><p>Moment bucket plot</p></a></li>
<li><a href='#moment_gray_half'><p>Functions to create the background for the bucket plots</p></a></li>
<li><a href='#pcr_coef_path'>
<p>Plotting the fitted path of a PCR  model.</p></a></li>
<li><a href='#pe_param'>
<p>Partial Effect of a term on the parameters and predictors</p></a></li>
<li><a href='#pe_pdf'><p>Partial Effect of a term on the response distribution</p></a></li>
<li><a href='#prof_term'><p>Plotting the profile deviance of one fitted term</p></a></li>
<li><a href='#resid_density'><p>Density of the residuals in a GAMLLSS model</p></a></li>
<li><a href='#resid_dtop'><p>Detrended Transformed Owen's Plot and ECDF for the residuals</p></a></li>
<li><a href='#resid_index'><p>A residual plots</p></a></li>
<li><a href='#resid_qqplot'><p>QQ-plot of the residuals of a GAMLSS model</p></a></li>
<li><a href='#resid_symmetry'><p>Symmetry plots</p></a></li>
<li><a href='#resid_wp'><p>Worm plot using ggplot2</p></a></li>
<li><a href='#resp_mu'><p>Plotting the response against  quantities of the fitted model</p></a></li>
<li><a href='#y_hist'><p>Histogram and density plot.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Plotting Functions for Generalized Additive Model for Location
Scale and Shape</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1-12</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-21</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for plotting Generalized Additive Models for Location Scale and Shape from the 'gamlss' package, Stasinopoulos and Rigby (2007) &lt;<a href="https://doi.org/10.18637%2Fjss.v023.i07">doi:10.18637/jss.v023.i07</a>&gt;, using the graphical methods from 'ggplot2'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.gamlss.com/">https://www.gamlss.com/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gamlss-dev/gamlss.ggplots/issues">https://github.com/gamlss-dev/gamlss.ggplots/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), gamlss.dist, gamlss (&ge; 4.3.3), gamlss.foreach</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, ggridges, ellipse, gamlss.inf, foreach, mgcv,
ggplot2, yaImpute</td>
</tr>
<tr>
<td>Suggests:</td>
<td>glmnet, reshape2, igraph, networkD3, grid, gridExtra</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-21 20:35:39 UTC; dimitriosstasinopoulos</td>
</tr>
<tr>
<td>Author:</td>
<td>Mikis Stasinopoulos
    <a href="https://orcid.org/0000-0003-2407-5704"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Robert Rigby <a href="https://orcid.org/0000-0003-3853-1707"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Fernanda De Bastiani
    <a href="https://orcid.org/0000-0001-8532-639X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Julian Merder [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-25 20:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ACE'>
Alternating Conditional Expectations
</h2><span id='topic+ACE'></span><span id='topic+mcor'></span>

<h3>Description</h3>

<p>The function <code>ACE()</code> uses the alternating conditional expectations algorithm to find a transformations of <code>y</code> and <code>x</code> that maximise the proportion of variation in y explained by x. It is a less general function  than the <code>ace()</code> function  of the package 'acepack' in that it takes only one explanatory variable. The function <code>ACE()</code> is used  by the function <code>mcor()</code>  to calculate the maximal correlation between <code>x</code> and <code>y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ACE(x, y, weights, data = NULL, con_crit = 0.001, 
    fit.method = c("loess", "P-splines"), nseg = 10, 
    max.df = 6, ...)
    
mcor(x, y, data = NULL,  fit.method = c("loess", "P-splines"),  
        nseg = 10, max.df = 6,  ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ACE_+3A_x">x</code></td>
<td>
<p>the unique x-variables</p>
</td></tr>
<tr><td><code id="ACE_+3A_y">y</code></td>
<td>
<p>the y-variable</p>
</td></tr>
<tr><td><code id="ACE_+3A_weights">weights</code></td>
<td>
<p>prior weights</p>
</td></tr>
<tr><td><code id="ACE_+3A_data">data</code></td>
<td>
<p>a data frame for y, x and weights</p>
</td></tr>
<tr><td><code id="ACE_+3A_con_crit">con_crit</code></td>
<td>
<p>the convergence criterio of the algorithm</p>
</td></tr>
<tr><td><code id="ACE_+3A_fit.method">fit.method</code></td>
<td>
<p>the method use to fit the smooth functions $t_1()$ and $t_2()$</p>
</td></tr>
<tr><td><code id="ACE_+3A_nseg">nseg</code></td>
<td>
<p>the number of knots</p>
</td></tr>
<tr><td><code id="ACE_+3A_max.df">max.df</code></td>
<td>
<p>the maximum od df allowed</p>
</td></tr>
<tr><td><code id="ACE_+3A_...">...</code></td>
<td>
<p>arguments to pass to the fitted functions <code>fir_PB</code> or <code>loess()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>ACE</code> is a simplified version of the function <code>ace()</code> of the package <span class="pkg">agepack</span>.
</p>


<h3>Value</h3>

<p>A fitted <code>ACE</code> model with methods <code>print.ACE()</code> and <code>plot.ACE() </code>
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos
</p>


<h3>References</h3>

<p>Eilers, P. H. C. and Marx, B. D. (1996). Flexible smoothing with B-splines and penalties (with comments and rejoinder). <em>Statist. Sci</em>, <b>11</b>, 89-121.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M.(2005). Generalized additive models for location, scale and shape, (with discussion),<em>Appl. Statist.</em>, 
<b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p>fit_PB
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rent)
ACE(Fl, R, data=rent)
pp &lt;- ACE(Fl, R, data=rent)
pp
plot(pp)
mcor(Fl, R, data=rent)
</code></pre>

<hr>
<h2 id='boot_coef'>
Plotting Bootstrap Coefficients 
</h2><span id='topic+boot_coef'></span><span id='topic+boot_coef_one'></span>

<h3>Description</h3>

<p>The function <code>boot_coef()</code> plots in  one or multiple pages the results from a boostrap generated by the function  <code>BayesianBoot()</code>, <code>NonParamatricBoot</code> or <code>nonpar_boot().</code>
</p>
<p>The function <code>boot_coef_one()</code> plots a single parameter. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot_coef(x, terms = NULL, hist.col = "black", 
                hist.fill = "white", dens.fill = "#FF6666", 
                alpha = 0.2, nrow = NULL, ncol = NULL, 
                plots.per.page = 9, one.by.one = FALSE, title, ...)
                
boot_coef_one(x, par = 1, rug = TRUE, alpha = 0.2, hist.col = "black", 
                hist.fill = "white", line.col = "gray", 
                dens.fill = "#FF6666", title, ...)              
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot_coef_+3A_x">x</code></td>
<td>
<p>a <code>Bayesian.boot</code> or <code>NonParametric.boot</code> object</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_terms">terms</code></td>
<td>
<p>which terms to plot (default NULL means all terms</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_par">par</code></td>
<td>
<p>which parameter to plot</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_hist.col">hist.col</code></td>
<td>
<p>colour of the  border histogram</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_hist.fill">hist.fill</code></td>
<td>
<p>the colour of the histogram</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_dens.fill">dens.fill</code></td>
<td>
<p>the colour of the density estimate</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_alpha">alpha</code></td>
<td>
<p>transparity constant</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_nrow">nrow</code></td>
<td>
<p>how namy rows</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_ncol">ncol</code></td>
<td>
<p>how many columns</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_plots.per.page">plots.per.page</code></td>
<td>
<p>the maxiimum plots per page</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_one.by.one">one.by.one</code></td>
<td>
<p>whether single plots</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_rug">rug</code></td>
<td>
<p>whether rug is required for <code>boot_coef_one()</code></p>
</td></tr>
<tr><td><code id="boot_coef_+3A_line.col">line.col</code></td>
<td>
<p>the vertical line colour  for <code>boot_coef_one()</code></p>
</td></tr>
<tr><td><code id="boot_coef_+3A_title">title</code></td>
<td>
<p>the title</p>
</td></tr>
<tr><td><code id="boot_coef_+3A_...">...</code></td>
<td>
<p>for more argument</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots in one ore multiple pages the results from a boostrap simulation</p>


<h3>Value</h3>

<p>Greates a ggplot object
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+term.plot">term.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(aids)
a &lt;- gamlss(y ~ pb(x) + qrt, data = aids, family = NBI)
registerDoParallel(cores = 2)
B1 &lt;- BayesianBoot(a, B=100)
stopImplicitCluster()
boot_coef(B1)

</code></pre>

<hr>
<h2 id='centile_bucket'>
Centile bucket plot
</h2><span id='topic+centile_bucket'></span><span id='topic+centile_bucket_wrap'></span><span id='topic+model_cent_bucket'></span>

<h3>Description</h3>

<p>A bucket plot is a graphical way to check the skewness and kurtosis of a continuous variable or the residuals of a fitted GAMLSS model. It plots the centile skewness (tail or central) and  transformed centile kurtosis of the variable (or residuals) together with a cloud of points obtained using a non-parametric bootstrap from the original variable (or residuals). It also provides a graphical way of performing a Monte Carlo simulation test on whether the centile skewness and transformed centile kurtosis of the variable of interest are simultaneously equal to zero. 
</p>
<p>There are two function here:
</p>
<p>i) <code>cenlile_bucket()</code> for a single bucket plot. Note that  <code>model_cent_bucket()</code>  and <code>centile_bucket()</code> are synonymous.
</p>
<p>ii) <code>centile_bucket_wrap()</code> for multiple bucket plots cut according to  terms in the model. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centile_bucket(x, ..., type = c("tail", "central"), weights = NULL, 
       no_bootstrap = 99, col_bootstrap = hcl.colors(length.obj, 
       palette = "Set 2"), alpha_bootstrap = 1, text_to_show = NULL, 
       cex_text = 5, col_text = "black", colour_bucket = FALSE, 
       line_width = 0.5, sim_test = FALSE, no_sim_test = 1000, 
       col_sim_test = gray(0.7), alpha_sim_test = 0.1, seed_test = 1234)

model_cent_bucket(x, ..., type = c("tail", "central"), weights = NULL, 
       no_bootstrap = 99, col_bootstrap = hcl.colors(length.obj, 
       palette = "Set 2"), alpha_bootstrap = 1, text_to_show = NULL, 
       cex_text = 5, col_text = "black", colour_bucket = FALSE, 
       line_width = 0.5, sim_test = FALSE, no_sim_test = 1000, 
       col_sim_test = gray(0.7), alpha_sim_test = 0.1, seed_test = 1234)


centile_bucket_wrap(x, ..., type = c("tail", "central"), weights = NULL, 
      xvar = NULL, n_inter = 4, no_bootstrap = 99, 
      col_bootstrap = hcl.colors(length.obj, palette = "Set 2"), 
      alpha_bootstrap = 1, text_to_show = NULL, check_overlap_text = FALSE, 
      cex_text = 5, col_text = "black", colour_bucket = FALSE, 
      line_width = 0.5, sim_test = FALSE, no_sim_test = 1000, 
      col_sim_test = gray(0.7), alpha_sim_test = 0.1, seed_test = 1234)       
       
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="centile_bucket_+3A_x">x</code></td>
<td>
<p>x should be a continuous vector of a GAMLSS fitted model. </p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_...">...</code></td>
<td>
<p>for more that one continuous vectors or fitted models</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_type">type</code></td>
<td>
<p>whether &quot;tail&quot; of &quot;central&quot; skewness and kurtosis</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_weights">weights</code></td>
<td>
<p>if priors weights are needed</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_no_bootstrap">no_bootstrap</code></td>
<td>
<p>the number of bootstrap samples for the cloud around the point of skewness and kurtosis.</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_col_bootstrap">col_bootstrap</code></td>
<td>
<p>The colour of the bootstrap samples</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_alpha_bootstrap">alpha_bootstrap</code></td>
<td>
<p>The transparency parameter of the bootstrap samples.</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_text_to_show">text_to_show</code></td>
<td>
<p>what text to show in the plots, default the names of vectors or models</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_cex_text">cex_text</code></td>
<td>
<p>the character size of the text</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_col_text">col_text</code></td>
<td>
<p>the colour of the text</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_colour_bucket">colour_bucket</code></td>
<td>
<p>whether colour or gray lines in the bucket</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_line_width">line_width</code></td>
<td>
<p>the line width</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_sim_test">sim_test</code></td>
<td>
<p>whether to Monde Carlo simulation is needed to check the null hypothesis that there is no centile skewness and transformed centile kurtosis in the sample.</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_no_sim_test">no_sim_test</code></td>
<td>
<p>The number of simulation for the test</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_col_sim_test">col_sim_test</code></td>
<td>
<p>the colour used for displaying the Monde Carlo test values</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_alpha_sim_test">alpha_sim_test</code></td>
<td>
<p>The transparency parameter of the Monde Carlo samples.</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_seed_test">seed_test</code></td>
<td>
<p>A seed value for the Monde Carlo simulation.</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_xvar">xvar</code></td>
<td>
<p>the x term</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_n_inter">n_inter</code></td>
<td>
<p>how many intervals needed</p>
</td></tr>
<tr><td><code id="centile_bucket_+3A_check_overlap_text">check_overlap_text</code></td>
<td>
<p>whether to check overlapping text</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details about centile bucket plots is given in De Bastiani <em>et al.</em> (2022)
</p>


<h3>Value</h3>

<p>A plot displaying the centile skewness and  transformed centile kurtosis of the sample or residual of a model.
</p>


<h3>Note</h3>

<p>The  bucket plot provides an additional residual diagnostic tool that can be used for fitted model checking, alongside other diagnostic tools, for example   worm plots, and Q (and Z) statistics.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>De Bastiani, F.,   Stasinopoulos, D. M., Rigby, R. A., Heller, G. Z., and Lucas A. (2022) Bucket Plot: A Visual Tool for Skewness and Kurtosis Comparisons. To be  published.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. <a href="https://doi.org/10.1201/9780429298547">doi:10.1201/9780429298547</a>
An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://doi.org/10.18637/jss.v023.i07">doi:10.18637/jss.v023.i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b21973">doi:10.1201/b21973</a>
</p>
<p>Stasinopoulos, M. D., Rigby, R. A., and De Bastiani F., (2018) GAMLSS: a distributional regression approach, <em>Statistical Modelling</em>, Vol. <b>18</b>, pp, 248-273, SAGE Publications Sage India: New Delhi, India.
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also  <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+wp">wp</a>, <a href="gamlss.html#topic+Q.stats">Q.stats</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>m1 &lt;- gamlss(R~pb(Fl)+pb(A), data=rent, family=GA)
centile_bucket(m1)

centile_bucket_wrap(m1, xvar=rent$A)

</code></pre>

<hr>
<h2 id='family_pdf'>
Plotting Probabilities Density Functions (pdf's) for GAMLSS
</h2><span id='topic+family_pdf'></span><span id='topic+fitted_pdf'></span><span id='topic+fitted_pdf_data'></span><span id='topic+predict_pdf'></span>

<h3>Description</h3>

<p>The function <code>family_pdf()</code> takes a GAMLSS family distribution and plots different pdf's according to the specified parameters.
</p>
<p>The function <code>fitted_pdf()</code> takes a gamlss fitted object and plots the fitted distributions for specified observations.
</p>
<p>The function <code>fitted_pdf_data()</code> it does the same as <code>fitted_pdf()</code>  but it adds  also the observation values  as grey vertical lines.
</p>
<p>The function <code>predict_pdf()</code> takes a fitted object and test  data and plots the predictive pdf's.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>family_pdf(family = NO(), mu = NULL, sigma = NULL, nu = NULL, tau = NULL, 
         title, from = 0, to = 10, no.points = 201,
         alpha = 0.4, col.fill = hcl.colors(lobs, palette = "viridis"), 
         size.seqment = 1.5, plot.point = TRUE, size.point = 1, 
         plot.line = TRUE, size.line = 0.2, ...)
         
fitted_pdf(model, obs, title, from = 0, to = 10, no.points = 201, alpha = 0.4, 
         col.fill = hcl.colors(lobs, palette = "viridis"), 
         size.seqment = 1.5, plot.point = TRUE, size.point = 1, plot.line = TRUE,
         size.line = 0.2, ...)
         
fitted_pdf_data(model, obs, from, to, ...)         
         
predict_pdf(model, newdata, title, from = 0, to = 10, no.points = 201, 
         alpha = 0.4, col.fill = hcl.colors(lobs, palette = "viridis"), 
         size.seqment = 1.5, plot.point = TRUE, size.point = 1, 
         plot.line = TRUE, size.line = 0.2, ...)
         
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="family_pdf_+3A_family">family</code></td>
<td>
<p>A GAMLSS family</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_model">model</code></td>
<td>
<p>A GAMLSS fitted model</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_obs">obs</code></td>
<td>
<p>observations to plot fitted distributions</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_newdata">newdata</code></td>
<td>
<p>for test data</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_mu">mu</code></td>
<td>
<p>the <code>mu</code> parameter value(s)</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_sigma">sigma</code></td>
<td>
<p>the <code>sigma</code> parameter value(s)</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_nu">nu</code></td>
<td>
<p>the <code>nu</code> parameter value(s)</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_tau">tau</code></td>
<td>
<p>the <code>tau</code> parameter value(s)</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_title">title</code></td>
<td>
<p>a diferent title for the default</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_from">from</code></td>
<td>
<p>minimum value for the response</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_to">to</code></td>
<td>
<p>maximum value for the response</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_no.points">no.points</code></td>
<td>
<p>number of points (relevant for continuous responses)</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_alpha">alpha</code></td>
<td>
<p>trasparency factor</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_col.fill">col.fill</code></td>
<td>
<p>the colour pallet default is <code>hcl.colors(lobs, palette="viridis")</code></p>
</td></tr>
<tr><td><code id="family_pdf_+3A_size.seqment">size.seqment</code></td>
<td>
<p>for discrete responses the size of the bars</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_plot.point">plot.point</code></td>
<td>
<p>for discrete responses whether to put poits on the top of the bars</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_size.point">size.point</code></td>
<td>
<p>for discrete responses </p>
</td></tr>
<tr><td><code id="family_pdf_+3A_plot.line">plot.line</code></td>
<td>
<p>for discrete responses whether to joint the bars with lines</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_size.line">size.line</code></td>
<td>
<p>for discrete responses the size of the joining lines</p>
</td></tr>
<tr><td><code id="family_pdf_+3A_...">...</code></td>
<td>
<p>for extra argumnets</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The  functions <code>family_pdf()</code> and <code>fitted_pdf()</code> are ggplot version of the   function <code>pdf.plot()</code>  used to plot fitted distributions of  GAMLSS family at specified observation values. Note that the range of the response  has to be specified using the argument <code>from</code> <code>to</code>. 
</p>
<p>For discrete fitted distributions maybe increase the value of <code>alpha</code> for clearer  plot.
</p>
<p>For binomial type of data (discrete response with upper limit) the function <code>family_pdf()</code> takes the argument <code>to</code> as the binomial denominator,
For fitted model with  binomial type responses the function <code>fitted_pdf()</code>  takes the binomial denominator form the fitted model and set the argument <code>to</code> to the maximum of those binomial denominators.
</p>


<h3>Value</h3>

<p>Creates a plot
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

  <p><code><a href="gamlss.html#topic+gamlss">gamlss</a></code>, <code><a href="#topic+resid_density">resid_density</a> </code></p>


<h3>Examples</h3>

<pre><code class='language-R'>###################################
# function fitted_pdf
# continuous variabe
a1 &lt;- gamlss(y~pb(x),sigma.fo=~pb(x), data=abdom, family=LO)
fitted_pdf(a1, obs=c(10,15,20), from=30, to=100)
# count data
p1 &lt;- gamlss(y~pb(x)+qrt, data=aids, family=NBI)
fitted_pdf(p1, obs=c(10:15), from=25, to=130, alpha=.9)
# binomial type
h&lt;-gamlss(y~ward+loglos+year, sigma.formula=~year+ward, family=BB, data=aep) 
fitted_pdf(h, obs=c(10:15),  alpha=.9)
###################################
# function predict_pdf
predict_pdf(a1, newdata=abdom[10:20, ], from=30, to=100)
# count data
predict_pdf(p1, newdata=aids[10:15, ], from=30, to=150)
# binomial
predict_pdf(h, newdata=aep[10:15, ], from=0, to=20)
###################################
# function family_pdf
# continuous
family_pdf(from=-5,to=5, mu=0, sigma=c(.5,1,2))
# count data 
family_pdf(NBI, to=15, mu=1, sigma=c(.5,1,2), alpha=.9, size.seqment = 3)
# binomial type
family_pdf(BB, to=15, mu=.5, sigma=c(.5,1,2),  alpha=.9, , size.seqment = 3)
</code></pre>

<hr>
<h2 id='fit_PB'>
P-spline smoother
</h2><span id='topic+fit_PB'></span>

<h3>Description</h3>

<p>The function <code>fit_PB()</code> fits a P-spline   univariate smoother [Eilers and Marx (1996)] to <code>y</code> against the <code>x</code> with prior weights <code>weights</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_PB(x, y, weights, data, xmin, xmax, nseg = 20, 
      lambda = 10, order = 2, degree = 3, max.df = 20, 
      ylim, plot = TRUE, col.ribbon = "pink")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_PB_+3A_x">x</code></td>
<td>
<p>the explanatory variable</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_y">y</code></td>
<td>
<p>the response</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_weights">weights</code></td>
<td>
<p>possible prior weights (set to one by default) </p>
</td></tr>
<tr><td><code id="fit_PB_+3A_data">data</code></td>
<td>
<p>the data frame  where <code>x</code>, <code>y</code> and <code>weights</code> are coming from
</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_xmin">xmin</code></td>
<td>
<p>the <code>x</code> minimum if different from <code>min(x)</code></p>
</td></tr>
<tr><td><code id="fit_PB_+3A_xmax">xmax</code></td>
<td>
<p>the <code>x</code> maximum if different from <code>max(x)</code>
</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_nseg">nseg</code></td>
<td>
<p>the number of knots</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_lambda">lambda</code></td>
<td>
<p>the smotthing parameter</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_order">order</code></td>
<td>
<p>the ordr of the difference</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_degree">degree</code></td>
<td>
<p>the degree of the piewise polynonmial</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_max.df">max.df</code></td>
<td>
<p>the maximum allowed degress of freedom</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_ylim">ylim</code></td>
<td>
<p>the <code>ylim</code> in the plot</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_plot">plot</code></td>
<td>
<p>whether to plot the results</p>
</td></tr>
<tr><td><code id="fit_PB_+3A_col.ribbon">col.ribbon</code></td>
<td>
<p>the color in the se of the fitted values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A object <code>Psplines</code> is produced with methods <code>print()</code>, <code>coef()</code>   <code>deviance()</code>,  <code>fitted()</code>,  <code>predict()</code> and  <code>resid().</code>
</p>


<h3>Note</h3>

<p>The function<code>fit_PB()</code> is an engine for getting the maximal correlation between two continuous variables. It can be also
used on its own as a smoother.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos
</p>


<h3>References</h3>

<p>Eilers, P. H. C. and Marx, B. D. (1996). Flexible smoothing with B-splines and penalties (with comments and rejoinder). <em>Statist. Sci</em>, <b>11</b>, 89-121.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019) 
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. <a href="https://doi.org/10.1201/9780429298547">doi:10.1201/9780429298547</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b21973">doi:10.1201/b21973</a>
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also  <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p>ACE</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(abdom)
m1 &lt;- fit_PB(x,y, data=abdom)
</code></pre>

<hr>
<h2 id='fitted_cdf'>
Plotting Cumulative Distribution Functions (cdf's) for GAMLSS,
</h2><span id='topic+fitted_cdf'></span><span id='topic+family_cdf'></span><span id='topic+predict_cdf'></span><span id='topic+fitted_cdf_data'></span>

<h3>Description</h3>

<p>The function <code>family_cdf()</code> takes a GAMLSS family distribution and plots different pdf's according to the specified parameters.
</p>
<p>The function <code>fitted_cdf()</code> takes a gamlss fitted object and plots the fitted distributions for specified observations.
</p>
<p>The function <code>fitted_cdf_data()</code> is similat to  <code>fitted_cdf()</code> but also adds the data points as gray vertical lines. 
</p>
<p>The function <code>predict_pdf()</code> (NOT IMPLEMENTED YET) takes a fitted object and test  data and plots the predictive cdf's.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitted_cdf(model, obs, title, from = 0, to = 10, no.points = 201, 
          alpha = 1, size.line = 1.2, 
          col.fill = hcl.colors(lobs, palette = "viridis"), 
          size.seqment = 1.5, size.point = 1, 
          plot.line = TRUE, size.line.disc = 0.2, lower.tail = TRUE, ...)

fitted_cdf_data(model, obs, from, to, ...)

predict_cdf(model, newdata, title, from = 0, to = 10, no.points = 201, 
          alpha = 0.4, size.line = 1.2, 
          col.fill = hcl.colors(lobs, palette = "viridis"), 
          size.seqment = 1.5, plot.point = TRUE, size.point = 1, 
          plot.line = TRUE, size.line.disc = 0.2, lower.tail = TRUE, ...)

family_cdf(family = NO(), mu = NULL, sigma = NULL, nu = NULL, 
         tau = NULL, title, from = 0, to = 10, no.points = 201, 
         alpha = 0.4, size.line = 1.2, col.fill = hcl.colors(lobs, 
         palette = "viridis"), size.seqment = 1.5, plot.point = TRUE,  
         size.point = 1, plot.line = TRUE, lower.tail = TRUE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted_cdf_+3A_family">family</code></td>
<td>
<p>A GAMLSS family</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_model">model</code></td>
<td>
<p>A GAMLSS fitted model</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_obs">obs</code></td>
<td>
<p>observations to plot fitted distributions</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_newdata">newdata</code></td>
<td>
<p>for test data</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_mu">mu</code></td>
<td>
<p>the <code>mu</code> parameter value(s)</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_sigma">sigma</code></td>
<td>
<p>the <code>sigma</code> parameter value(s)</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_nu">nu</code></td>
<td>
<p>the <code>nu</code> parameter value(s)</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_tau">tau</code></td>
<td>
<p>the <code>tau</code> parameter value(s)</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_title">title</code></td>
<td>
<p>a diferent title for the default</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_from">from</code></td>
<td>
<p>minimum value for the response</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_to">to</code></td>
<td>
<p>maximum value for the response</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_no.points">no.points</code></td>
<td>
<p>number of points (relevant for continuous responses)</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_alpha">alpha</code></td>
<td>
<p>trasparency factor</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_col.fill">col.fill</code></td>
<td>
<p>the colour pallet default is <code>hcl.colors(lobs, palette="viridis")</code></p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_size.seqment">size.seqment</code></td>
<td>
<p>for discrete responses the size of the bars</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_plot.point">plot.point</code></td>
<td>
<p>for discrete responses whether to put poits on the top of the bars</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_size.point">size.point</code></td>
<td>
<p>for discrete responses </p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_plot.line">plot.line</code></td>
<td>
<p>for discrete responses whether to joint the bars with lines</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_size.line.disc">size.line.disc</code></td>
<td>
<p>for discrete responses the size of the joining lines</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_size.line">size.line</code></td>
<td>
<p>The size of the lines</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_lower.tail">lower.tail</code></td>
<td>
<p>if <code>TRUE</code> cdf is plotted if <code>FALSE</code> the survival function</p>
</td></tr>
<tr><td><code id="fitted_cdf_+3A_...">...</code></td>
<td>
<p>for extra argumnets</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The  functions <code>family_cdf()</code>,  <code>fitted_cdf()</code>, and <code>predict_cdf()</code>
are function to plot cdf's for a <code>gamlss.family</code>, fitted <code>gamlss</code> model or predictive <code>gamlss</code> model, respectively. 
</p>
<p>For discrete fitted distributions maybe increase the value of <code>alpha</code> for clearer  plot.
</p>
<p>For binomial type of data (discrete response with upper limit) the function <code>family_cdf()</code> takes the argument <code>to</code> as the binomial denominator,
For fitted model with  binomial type responses the function <code>fitted_cdf()</code>  takes the binomial denominator form the fitted model and set the argument <code>to</code> to the maximum of those binomial denominators.
</p>


<h3>Value</h3>

<p>Creates a plot
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

  <p><code><a href="gamlss.html#topic+gamlss">gamlss</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># function fitted_cdf
# continuous variabe
a1 &lt;- gamlss(y~pb(x),sigma.fo=~pb(x), data=abdom, family=LO)
fitted_cdf(a1, obs=c(10,15,20), from=30, to=100)
fitted_cdf(a1, obs=c(10,15,20), from=30, to=100, lower.tail=FALSE)
# count data
p1 &lt;- gamlss(y~pb(x)+qrt, data=aids, family=NBI)
fitted_cdf(p1, obs=c(10:15), from=10, to=130, alpha=.9)
fitted_cdf(p1, obs=c(10:15), from=10, to=130, alpha=.9, lower.tail=FALSE)
# binomial type
h&lt;-gamlss(y~ward+loglos+year, sigma.formula=~year+ward, family=BB, data=aep) 
fitted_cdf(h, obs=c(10:15),  alpha=.9)
fitted_cdf(h, obs=c(10:15),  alpha=.9, lower.tail=FALSE)
###################################
# function predict_pdf
predict_cdf(a1, newdata=abdom[c(10,15,20), ], from=30, to=100)
predict_cdf(a1, newdata=abdom[10:20, ], from=30, to=100, lower.tail=FALSE)
# count data
predict_cdf(p1, newdata=aids[10:15, ], from=10, to=150)
predict_cdf(p1, newdata=aids[10:15, ], from=10, to=150, lower.tail=FALSE)
# binomial
predict_cdf(h, newdata=aep[10:15, ], from=0, to=20)
predict_cdf(h, newdata=aep[10:15, ], from=0, to=20, lower.tail=FALSE)
###################################
# function family_cdf
# continuous
family_cdf(from=-5,to=5, mu=0, sigma=c(.5,1,2))
family_cdf(from=-5,to=5, mu=0, sigma=c(.5,1,2), lower.tail=FALSE)
# count data 
family_cdf(NBI, to=15, mu=1, sigma=c(.5,1,2), alpha=.9, size.seqment = 3)
family_cdf(NBI, to=15, mu=1, sigma=c(.5,1,2), alpha=.9, size.seqment = 3, lower.tail=FALSE)
# binomial type
family_cdf(BB, to=15, mu=.5, sigma=c(.5,1,2),  alpha=.9, , size.seqment = 3)
family_cdf(BB, to=15, mu=.5, sigma=c(.5,1,2),  alpha=.9, , size.seqment = 3, lower.tail=FALSE)
</code></pre>

<hr>
<h2 id='fitted_centiles'>
Plotting centile (growth) curves
</h2><span id='topic+fitted_centiles'></span><span id='topic+fitted_centiles_legend'></span><span id='topic+model_centiles'></span>

<h3>Description</h3>

<p>The function <code>fitted_centiles()</code> plots centiles curves for distributions belonging to the GAMLSS family of distributions. The plot is equivalent to the standard plot of <code>gamlss:::centiles()</code> without a legend.
</p>
<p>The function <code>fitted_centiles_legend()</code> plots centiles curves for distributions belonging to the GAMLSS family of distributions and it is  equivalent to the standard plot of <code>gamlss:::centiles()</code> with a legend. The function  is slower than <code>fitted_centiles()</code> since in order to plot the legend the data have to expanded.  
</p>
<p>The function <code>model_centiles()</code> plots centile curves for more than one model.  There is no equivalent  plot in the original GAMLSS centile plots  but it perform the same function as <code>gamlss:::centiles.com()</code>  which compares centiles from different models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitted_centiles(obj, xvar, 
               cent = c(99.4, 98, 90, 75, 50, 25, 10, 2, 0.4), 
               points = TRUE, point.col = "gray", 
               point.size = 1, line.size = 0.8, 
               line.col = hcl.colors(lc, palette = "Dark 2"), 
               line.type = rep(1, length(cent)),
               xlab = NULL, ylab = NULL, title, ...)
               
fitted_centiles_legend(obj, xvar, 
               cent = c(99.4, 98, 90, 75, 50, 25, 10, 2, 0.4),   
               points = TRUE, point.col = "gray", point.size = 1, 
               line.size = 0.8, line.col = hcl.colors(ncent, 
               palette = "Dark 2"), line.type = rep(1, length(cent)),               
               show.legend = TRUE, save.data = FALSE, title, 
               xlab = NULL, ylab = NULL, ...)               

model_centiles(obj, ..., cent = c(97, 90, 75, 50, 25, 10, 3), 
               xvar, xlab = "age", points = TRUE, 
               point.col = gray(0.8), 
               point.size = 0.05, line.size = 0.7, 
               line.col = hcl.colors(ncent,palette = "Dark 2"), 
               ncol = 2, nrow = ceiling(nnames/ncol),  in.one = FALSE,
               title)               
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted_centiles_+3A_obj">obj</code></td>
<td>
<p>a fitted gamlss object</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_xvar">xvar</code></td>
<td>
<p>the (unique) explanatory variable</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_cent">cent</code></td>
<td>
<p>a vector with elements the % centile values for which the centile curves have to be evaluated (note that the order is from the highest to the lowest so legend and  the plots are maching)</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_points">points</code></td>
<td>
<p>whether to plot the points (<code>TRUE</code>) of the data or not (<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_point.col">point.col</code></td>
<td>
<p>the colour of the points</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_point.size">point.size</code></td>
<td>
<p>the zize of the points</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_line.size">line.size</code></td>
<td>
<p>the sized of the centile lines</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_line.col">line.col</code></td>
<td>
<p>the colour of the  centile lines</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_line.type">line.type</code></td>
<td>
<p>the type of line (different types of lines for each centile are working with <code>fitted_centiles_legend</code>)</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_xlab">xlab</code></td>
<td>
<p>the label of the x-axis variable</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_ylab">ylab</code></td>
<td>
<p>the label of the resposnse variable</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_in.one">in.one</code></td>
<td>
<p>whether the <code>model_centile</code> plot should be one or multiple</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_title">title</code></td>
<td>
<p>the title if need it otherwise a dfault title is pronted</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_show.legend">show.legend</code></td>
<td>
<p>whether to show the legend</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_save.data">save.data</code></td>
<td>
<p>whether to save the <code>data.frame</code> of the plot</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_nrow">nrow</code></td>
<td>
<p>the number of rows in the <code>model_centiles()</code> plot</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_ncol">ncol</code></td>
<td>
<p>the number of columns in the <code>model_centiles()</code> plot</p>
</td></tr>
<tr><td><code id="fitted_centiles_+3A_...">...</code></td>
<td>
<p>for extra  arguments for <code>fitted_centiles()</code>, and <code>fitted_centiles.legend()</code> and extra models for <code>model_centiles()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Centiles are calculated using the fitted values in <code>obj</code> and <code>xvar</code> must
correspond exactly to the predictor in <code>obj</code> to plot correctly.
</p>


<h3>Value</h3>

<p>A plot is created 
</p>


<h3>Warning </h3>

<p>This function is appropriate only when one continuous explanatory variable is fitted in the model</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda de Bastiani
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

   <p><code><a href="gamlss.html#topic+centiles">centiles</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(abdom)
h&lt;-gamlss(y~pb(x), sigma.formula=~pb(x), family=BCTo, data=abdom) 
h1 &lt;- gamlss(y~pb(x), sigma.formula=~pb(x), family=LO, data=abdom) 
fitted_centiles(h)
fitted_centiles_legend(h)
model_centiles(h, h1)

</code></pre>

<hr>
<h2 id='fitted_devianceIncr'>Plotting the deviance increment of GAMLSS</h2><span id='topic+fitted_devianceIncr'></span><span id='topic+model_devianceIncr_diff'></span>

<h3>Description</h3>

<p>There are two plotting function here:
</p>
<p>i) <code>fitted_devianceIncr()</code> plots the fitted model deviance components. This is  useful for identifying observations with unusual y-values (given the current fitted  distribution).  
</p>
<p>iii) <code>model_devianceIncr_diff</code> plots the difference of deviance  increments  from two fitted GAMLSS model. This function is useful if the GAIC and the residuals contradict each other. For example the GAIC is better for model 1 but the residuals look lot better for model 2. This can happens if the two distributions are better suited to fit different parts of the response distribution i.e. one model fits the center better but the other fits the tail better.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
fitted_devianceIncr(obj, plot = TRUE, title, quan.val = 0.99,
         annotate = TRUE, line.col = "steelblue4", 
         point.col = "darkblue", annot.col = "white",
         newdata = NULL)
         

model_devianceIncr_diff(model1, model2, against = "index", 
         tol = 20, data, newdata)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted_devianceIncr_+3A_obj">obj</code></td>
<td>
<p>a GAMLSS fitted object</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_plot">plot</code></td>
<td>
<p>whether to create just the plot or save also the values with high deviance increment</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_title">title</code></td>
<td>
<p>a tittle if needed it.</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_quan.val">quan.val</code></td>
<td>
<p>The quantile values of the deviance increment from which the obsrevrvarion should be identify</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_annotate">annotate</code></td>
<td>
<p>whether to plot the quantile values above in the plot.</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_line.col">line.col</code></td>
<td>
<p>the colour of the line</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_point.col">point.col</code></td>
<td>
<p>the colour of the points</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_annot.col">annot.col</code></td>
<td>
<p>the colour of the annotation for the deviance increment plot</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_model1">model1</code></td>
<td>
<p>The first fitted GAMLSS model</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_model2">model2</code></td>
<td>
<p>The second fitted GAMLSS model</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_against">against</code></td>
<td>
<p>you can plot the deviance increment an index, the response or an x-variable</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_tol">tol</code></td>
<td>
<p>if the absolute value of deviance increment  exceeds the <code>tol</code> the number of the observation  is plotted</p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_data">data</code></td>
<td>
<p>The data if can not be found from <code>model1</code></p>
</td></tr>
<tr><td><code id="fitted_devianceIncr_+3A_newdata">newdata</code></td>
<td>
<p>evaluates the function in new data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions are diagnostic tools to check unusual observations in the response.
</p>


<h3>Value</h3>

<p>return a plot
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopulos, Rober Rigby and Fernanda de Bastiani 
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+gamlss">gamlss</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>m1 &lt;- gamlss(R~pb(Fl)+pb(A)+H+loc, data=rent, family=GA )
m2 &lt;- gamlss(R~pb(Fl)+pb(A)+H+loc, data=rent, family=NO )
fitted_devianceIncr(m1)
model_devianceIncr_diff(m1,m2, against="Fl")
</code></pre>

<hr>
<h2 id='fitted_leverage'>
Plot of the linear leverage of a GAMLSS model
</h2><span id='topic+fitted_leverage'></span>

<h3>Description</h3>

<p>This is plot of the &quot;linear&quot; leverage of a GAMLSS fitted model.
By linear we mean the leverage (hat-values) we would have obtain in all the explanatory variables for all distribution parameters where put together and used to fit a linear model to the response. The &quot;linear&quot; leverage is them the  hat-values obtained by fitting this simple linear model. Hopefully the &quot;linear&quot; leverage can indicate observations with extreme values in the x's. Note that observations with hight linear leverage  may not be influential in the GAMLSS fitting especially if the x-variables are fitted using smoothers.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitted_leverage(obj, plot = TRUE, title, quan.val = 0.99, 
          annotate = TRUE, line.col = "steelblue4", 
          point.col = "steelblue4", annot.col = "darkred")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted_leverage_+3A_obj">obj</code></td>
<td>
<p>A GAMLSS fitted model</p>
</td></tr>
<tr><td><code id="fitted_leverage_+3A_plot">plot</code></td>
<td>
<p>whether to plot ot not</p>
</td></tr>
<tr><td><code id="fitted_leverage_+3A_title">title</code></td>
<td>
<p>for different title than the default</p>
</td></tr>
<tr><td><code id="fitted_leverage_+3A_quan.val">quan.val</code></td>
<td>
<p>which quantile value of the leverage should be taked to indicate the observation values</p>
</td></tr>
<tr><td><code id="fitted_leverage_+3A_annotate">annotate</code></td>
<td>
<p>whether to annotate the extreme levarages</p>
</td></tr>
<tr><td><code id="fitted_leverage_+3A_line.col">line.col</code></td>
<td>
<p>the colour of the lines</p>
</td></tr> 
<tr><td><code id="fitted_leverage_+3A_point.col">point.col</code></td>
<td>
<p>the colout of the points</p>
</td></tr>
<tr><td><code id="fitted_leverage_+3A_annot.col">annot.col</code></td>
<td>
<p>the colour used for annotation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a plot of the linear leverage against index.  
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code><a href="gamlss.html#topic+gamlss">gamlss</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>m1 &lt;- gamlss(R~pb(Fl)+pb(A)+loc+H, data=rent, family=GA)
fitted_leverage(m1)
</code></pre>

<hr>
<h2 id='fitted_terms'>Plotting fitted additive terms</h2><span id='topic+fitted_terms'></span><span id='topic+pe_terms'></span>

<h3>Description</h3>

<p>The function <code>fitted_terms()</code> is doing what the function <code>term.plot()</code> is doing for GAMLSS models but it uses <code>ggplot2</code> package. 
The function <code>pe_terms()</code> is synonymous to  <code>fitted_terms()</code> in the package <span class="pkg">gamlss</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitted_terms(object, 
          what = c("mu", "sigma", "nu", "tau"), 
          parameter = NULL, data = NULL, terms = NULL,
          envir = environment(formula(object)), 
          partial = FALSE, rug = FALSE, rug.sides = "b", 
          rug.col = "gray",  alpha = 0.2, 
          ylim = c("common", "free"), xlabs = NULL, 
          ylabs = NULL, main = NULL, term.col = "darkred", 
          resid.col = "lightblue", resid.alpha = 0.8, 
          resid.size = 1, nrow = NULL, ncol = NULL, 
          plots.per.page = 9, one.by.one = FALSE, 
          surface.gam = FALSE, polys = NULL, 
          polys.scheme = "topo", col.ribbon = "darksalmon",
          col.shaded = "gray", ...)

pe_terms(object, 
          what = c("mu", "sigma", "nu", "tau"), 
          parameter = NULL, data = NULL, terms = NULL,
          envir = environment(formula(object)), 
          partial = FALSE, rug = FALSE, rug.sides = "b", 
          rug.col = "gray",  alpha = 0.2, 
          ylim = c("common", "free"), xlabs = NULL, 
          ylabs = NULL, main = NULL, term.col = "darkred", 
          resid.col = "lightblue", resid.alpha = 0.8, 
          resid.size = 1, nrow = NULL, ncol = NULL, 
          plots.per.page = 9, one.by.one = FALSE, 
          surface.gam = FALSE, polys = NULL, 
          polys.scheme = "topo", col.ribbon = "darksalmon",
          col.shaded = "gray", ...)          
          
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted_terms_+3A_object">object</code></td>
<td>
<p>a gamlss fitted model</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_what">what</code></td>
<td>
<p>which distribution parameters, i.e. &quot;mu&quot;</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_parameter">parameter</code></td>
<td>
<p>which distribution parameters (equivalent to <code>what</code>)</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_data">data</code></td>
<td>
<p>data frame in which variables in <code>object</code> can be found</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_terms">terms</code></td>
<td>
<p>which terms to plot (default NULL means all terms); a vector passed to lpred(..., type = &quot;terms&quot;, terms =*)</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_envir">envir</code></td>
<td>
<p>environment in which variables in <code>object</code> can be found</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_partial">partial</code></td>
<td>
<p>logical; should partial residuals be plotted?</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_rug">rug</code></td>
<td>
<p>add rug plots to the axes</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_rug.sides">rug.sides</code></td>
<td>
<p>which side the rug &quot;b&quot;=bottom</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_rug.col">rug.col</code></td>
<td>
<p>the colour for the rug</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_alpha">alpha</code></td>
<td>
<p>the alpha for the shade</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_ylim">ylim</code></td>
<td>
<p>there are two options here a) &quot;common&quot; and b) &quot;free&quot;. The &quot;common&quot;&quot; option plots all figures with the same ylim range and therefore allows the viewer to check the relative contribution of each terms compate to the rest. In the &lsquo;free&rsquo; option the limits are computed for each plot seperatly.</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_xlabs">xlabs</code></td>
<td>
<p>the x label</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_ylabs">ylabs</code></td>
<td>
<p>the y label</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_main">main</code></td>
<td>
<p>title NOT WORKING</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_term.col">term.col</code></td>
<td>
<p>the colour of the line for term</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_resid.col">resid.col</code></td>
<td>
<p>the colour of the partial residuals</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_resid.alpha">resid.alpha</code></td>
<td>
<p>The alpha for the partial residuals</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_resid.size">resid.size</code></td>
<td>
<p>the size of the partial residuals</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_nrow">nrow</code></td>
<td>
<p>the number or rows in a mupliple plot</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_ncol">ncol</code></td>
<td>
<p>the number of rows in a mupliple plot</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_plots.per.page">plots.per.page</code></td>
<td>
<p>the number of plots per page in multiple plots</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_one.by.one">one.by.one</code></td>
<td>
<p>whether to plot the terms one by one</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_surface.gam">surface.gam</code></td>
<td>
<p>whether to use surface plot if a ga() term is fitted</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_polys">polys</code></td>
<td>
<p>for GRMF models</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_polys.scheme">polys.scheme</code></td>
<td>
<p>The polygone information file for MRF models</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_col.ribbon">col.ribbon</code></td>
<td>
<p>he colour of the ribbon</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_col.shaded">col.shaded</code></td>
<td>
<p>he colour of the shaded area</p>
</td></tr>
<tr><td><code id="fitted_terms_+3A_...">...</code></td>
<td>
<p>for extra argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A multiple plot</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+term.plot">term.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aids)
a &lt;- gamlss(y ~ pb(x) + qrt, data = aids, family = NBI)
fitted_terms(a, pages = 1)
</code></pre>

<hr>
<h2 id='gamlss.ggplots-package'>
Plotting Functions for Generalized Additive Model for Location Scale and Shape
</h2><span id='topic+gamlss.ggplots-package'></span><span id='topic+gamlss.ggplots'></span>

<h3>Description</h3>

<p>Functions for plotting Generalized Additive Models for Location Scale and Shape from the 'gamlss' package, Stasinopoulos and Rigby (2007) &lt;doi:10.18637/jss.v023.i07&gt;, using the graphical methods from 'ggplot2'.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> gamlss.ggplots</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Plotting Functions for Generalized Additive Model for Location Scale and Shape</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1-12</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-04-21</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person("Mikis", "Stasinopoulos", role = c("aut", "cre", "cph"), 
             email = "d.stasinopoulos@gre.ac.uk", comment = c(ORCID = "0000-0003-2407-5704")),
           person("Robert", "Rigby", role = "aut", email = "r.rigby@gre.ac.uk", comment = c(ORCID = "0000-0003-3853-1707")),
           person("Fernanda", "De Bastiani", role = "aut", email = "fernandadebastiani@gmail.com", comment = c(ORCID = "0000-0001-8532-639X")),
           person("Julian", "Merder", role = "ctb")
           )</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Functions for plotting Generalized Additive Models for Location Scale and Shape from the 'gamlss' package, Stasinopoulos and Rigby (2007) &lt;doi:10.18637/jss.v023.i07&gt;, using the graphical methods from 'ggplot2'.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://www.gamlss.com/</td>
</tr>
<tr>
 <td style="text-align: left;">
BugReports: </td><td style="text-align: left;"> https://github.com/gamlss-dev/gamlss.ggplots/issues</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.5.0), gamlss.dist, gamlss (&gt;= 4.3.3),  gamlss.foreach</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> methods,  ggridges, ellipse, gamlss.inf, foreach, mgcv, ggplot2, yaImpute</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> glmnet, reshape2, igraph, networkD3, grid, gridExtra</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Mikis Stasinopoulos [aut, cre, cph]
    (&lt;https://orcid.org/0000-0003-2407-5704&gt;),
  Robert Rigby [aut] (&lt;https://orcid.org/0000-0003-3853-1707&gt;),
  Fernanda De Bastiani [aut] (&lt;https://orcid.org/0000-0001-8532-639X&gt;),
  Julian Merder [ctb]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
ACE                     Alternating Conditional Expectations
boot_coef               Plotting Bootstrap Coefficients
centile_bucket          Centile bucket plot
family_pdf              Plotting Probabilities Density Functions
                        (pdf's) for GAMLSS
fit_PB                  P-spline smoother
fitted_cdf              Plotting Cumulative Distribution Functions
                        (cdf's) for GAMLSS,
fitted_centiles         Plotting centile (growth) curves
fitted_devianceIncr     Plotting the deviance increment of GAMLSS
fitted_leverage         Plot of the linear leverage of a GAMLSS model
fitted_terms            Plotting fitted additive terms
gamlss.ggplots-package
                        Plotting Functions for Generalized Additive
                        Model for Location Scale and Shape
histSmo_plot            Supporting histSmo()
model_GAIC              Plotting GAIC for GAMLSS models
model_pca               Plotting residuals using PCA
moment_bucket           Moment bucket plot
moment_gray_half        Functions to create the background for the
                        bucket plots
pcr_coef_path           Plotting the fitted path of a PCR model.
pe_param                Partial Effect of a term on the parameters and
                        predictors
pe_pdf                  Partial Effect of a term on the response
                        distribution
prof_term               Plotting the profile deviance of one fitted
                        term
resid_density           Density of the residuals in a GAMLLSS model
resid_dtop              Detrended Transformed Owen's Plot and ECDF for
                        the residuals
resid_index             A residual plots
resid_qqplot            QQ-plot of the residuals of a GAMLSS model
resid_symmetry          Symmetry plots
resid_wp                Worm plot using ggplot2
resp_mu                 Plotting the response against quantities of the
                        fitted model
y_hist                  Histogram and density plot.
</pre>
<p>The following convention has been used to name the functions: 
</p>
<p><code>fitted_NAME</code>: plots concerning  fitted values from a single fitted model
</p>
<p><code>resid_NAME</code>: plots concerning  residuals  from a single fitted model
</p>
<p><code>predict_NAME</code>: plots concerning prediction values from a single fitted  model usually having <code>newdata</code> option.
</p>
<p><code>model_NAME</code>: plots concerning  different  fitted models
</p>
<p>where <code>NAME</code> refer to different characteristics.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos [aut, cre, cph]
    (&lt;https://orcid.org/0000-0003-2407-5704&gt;),
  Robert Rigby [aut] (&lt;https://orcid.org/0000-0003-3853-1707&gt;),
  Fernanda De Bastiani [aut] (&lt;https://orcid.org/0000-0001-8532-639X&gt;),
  Julian Merder [ctb]
</p>
<p>Maintainer: Mikis Stasinopoulos &lt;d.stasinopoulos@gre.ac.uk&gt;
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC, <a href="https://doi.org/10.1201/9780429298547">doi:10.1201/9780429298547</a>.
An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://doi.org/10.18637/jss.v023.i07">doi:10.18637/jss.v023.i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b21973">doi:10.1201/b21973</a>
</p>
<p>Stasinopoulos, M. D., Rigby, R. A., and De Bastiani F., (2018) GAMLSS: a distributional regression approach, <em>Statistical Modelling</em>, Vol. <b>18</b>, 
pp, 248-273, SAGE Publications Sage India: New Delhi, India. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also  <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+gamlss">gamlss</a></code>, <code><a href="gamlss.dist.html#topic+gamlss.family">gamlss.family</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(gamlss)
m1 &lt;- gamlss(y~pb(x), data=abdom)
resid_index(m1)
</code></pre>

<hr>
<h2 id='histSmo_plot'>Supporting histSmo()</h2><span id='topic+histSmo_plot'></span>

<h3>Description</h3>

<p>This function helps to plot density estimates created by the <code>histSmo()</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>histSmo_plot(x, col_fill_bar = gray(0.5), col_bar = "pink", 
        col_line = "darkblue", width_line = 1, title, xlabel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="histSmo_plot_+3A_x">x</code></td>
<td>
<p>a <code>histSmo</code> object</p>
</td></tr>
<tr><td><code id="histSmo_plot_+3A_col_fill_bar">col_fill_bar</code></td>
<td>
<p>The fill colour of the bars</p>
</td></tr>
<tr><td><code id="histSmo_plot_+3A_col_bar">col_bar</code></td>
<td>
<p>the colour of the border of thebars</p>
</td></tr>
<tr><td><code id="histSmo_plot_+3A_col_line">col_line</code></td>
<td>
<p>the colour of the lines</p>
</td></tr>
<tr><td><code id="histSmo_plot_+3A_width_line">width_line</code></td>
<td>
<p>the width of the lines</p>
</td></tr>
<tr><td><code id="histSmo_plot_+3A_title">title</code></td>
<td>
<p>title if needed</p>
</td></tr>
<tr><td><code id="histSmo_plot_+3A_xlabel">xlabel</code></td>
<td>
<p>x axis lable if needed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function supports  <code>histSmo()</code>.
</p>


<h3>Value</h3>

<p>A plot
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopulos, Rober Rigby and Fernanda de Bastiani 
</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+histSmo">histSmo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a1 &lt;-histSmo(abdom$y)
gg1 &lt;-histSmo_plot(a1)
gg1
</code></pre>

<hr>
<h2 id='model_GAIC'>Plotting GAIC for GAMLSS models</h2><span id='topic+model_GAIC'></span><span id='topic+model_GAIC_lollipop'></span>

<h3>Description</h3>

<p>The function <code>model_GAIC()</code> is similar to the function <code>GAIC.scaled()</code> of the package <span class="pkg">gamlss</span>. It  produces, [for a given set of different fitted models or for a table produced by <code>chooseDist()</code>], the scaled Akaike values (see Burnham and Anderson (2002) section 2.9 for a similar concept of the GAIC weights. The plot of the  GAIC's  should not be interpreted as posterior probabilities of models given the data but can be used for model selection purpose since they produce a scaled ranking of the model using their relative importance i.e. from the worst to the best model. 
</p>
<p>The function <code>model_GAIC_lollipop()</code> is almost identical to <code>model_GAIC()</code>
but the result is a lollipop plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_GAIC(object, ..., k = 2, c = FALSE, plot = TRUE, 
       which = 1, diff.dev = 1000, text.to.show = NULL, 
       col = "rosybrown", width = 0.9, horiz = TRUE,
       scale = c("[0,1]","[max,min]"), title)

model_GAIC_lollipop(object, ..., k = 2, c = FALSE, plot = TRUE, 
         which = 1, diff.dev = 1000, text.to.show = NULL, 
         col = "skyblue", col.point = "blue", pch.point = 19, 
         width = 0.9, horiz = TRUE, 
         scale = c("[0,1]", "[max,min]"), order.val = TRUE, title)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_GAIC_+3A_object">object</code></td>
<td>

<p>a set of <code>gamlss</code> fitted model(s) or a matrix table produced by <code>chooseDist()</code>.
</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_...">...</code></td>
<td>

<p>it allows several GAMLSS object to be compared using a GAIC
</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_k">k</code></td>
<td>
<p>the penalty with default k=2</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_c">c</code></td>
<td>
<p>whether the corrected AIC, i.e. AICc, should be used, note that it applies only when  <code>k=2</code></p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_plot">plot</code></td>
<td>
<p>whether to plot with default equal <code>TRUE</code></p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_which">which</code></td>
<td>
<p>which column of GAIC table to plot</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_diff.dev">diff.dev</code></td>
<td>
<p>this argument applies only a matrix table produced by <code>chooseDist()</code> and  prevents models with a difference in deviance greater than <code>diff.dev</code> from the &lsquo;best&rsquo; model to be considered (or plotted).</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_text.to.show">text.to.show</code></td>
<td>
<p>if NULL, <code>model_GAIC()</code> shows the model names otherwise the character in this list (the length of which should be equal to the length of models)</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_col">col</code></td>
<td>
<p>The colour of the bars (or lines. in the lollipop)</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_col.point">col.point</code></td>
<td>
<p>The colour of the points in the lollipop</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_pch.point">pch.point</code></td>
<td>
<p>The points character in the lollipop</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_width">width</code></td>
<td>
<p>the width of the bars</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_horiz">horiz</code></td>
<td>
<p>whether to plot the bars horizontally (default) or  vertically</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_scale">scale</code></td>
<td>
<p>the scale of the plot, <code>"[0,1]"</code> plots the AIC's from the worst to the best models in a scale from  [0,1].  <code>"[max,min]"</code> plots the AIC's  from the worst model to the best model but in the original scale of the AIC's</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_title">title</code></td>
<td>
<p>if different title is needed</p>
</td></tr>
<tr><td><code id="model_GAIC_+3A_order.val">order.val</code></td>
<td>
<p>whether to order the models from the best to the worst</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The option  allow the AIC to be plotted from worst to best on a 
<code class="reqn">[0,1]</code> scale using the formula i.e. <code class="reqn">(AIC_w-AIC_m)/(AIC_w-AIC_b))</code> where the <code class="reqn">AIC_w</code> and <code class="reqn">AIC_b</code>  are the worst and best AIC, respectively, and <code class="reqn">AIC_m</code> is the AIC of the current model.  If the option <code>scale</code> is set to<code>[max,min]</code> the  difference <code class="reqn">(AIC_w-AIC_m)</code> is plotted. 
</p>


<h3>Value</h3>

<p>It returns a bar plot using package <span class="pkg">ggplot2</span>.</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Burnham K. P.  and  Anderson D. R (2002). <em>Model Selection and Multimodel Inference
A Practical Information-Theoretic Approach</em>, Second Edition, Springer-Verlag New York, Inc.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

 <p><code><a href="gamlss.html#topic+GAIC.scaled">GAIC.scaled</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(abdom)
m1 &lt;- gamlss(y~x, family=NO, data=abdom)
m2 &lt;- gamlss(y~x, sigma.fo=~x, family=NO, data=abdom)
m3 &lt;- gamlss(y~pb(x), sigma.fo=~x, family=NO, data=abdom)
m4 &lt;- gamlss(y~pb(x), sigma.fo=~pb(x), family=NO, data=abdom)

model_GAIC(m1,m2, m3, m4)

MT &lt;- chooseDist(m3)
model_GAIC(MT)
model_GAIC(MT, which=2)
model_GAIC_lollipop(m1,m2, m3, m4)
</code></pre>

<hr>
<h2 id='model_pca'>Plotting residuals using PCA</h2><span id='topic+model_pca'></span>

<h3>Description</h3>

<p>The function <code>model_pca()</code> plots several GAMLSS residuals using Principal Component Analysis. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_pca(obj, ..., scale = TRUE, arrow_size = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_pca_+3A_obj">obj</code></td>
<td>
<p>A gamlss object</p>
</td></tr>
<tr><td><code id="model_pca_+3A_...">...</code></td>
<td>
<p>for extra GAMLSS models</p>
</td></tr>
<tr><td><code id="model_pca_+3A_scale">scale</code></td>
<td>
<p>whether to scale the residuals</p>
</td></tr>
<tr><td><code id="model_pca_+3A_arrow_size">arrow_size</code></td>
<td>
<p>the arrow sizw in the biplot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>model_pca()</code>  plot a  <code>biplot()</code> plot of the residuals from different models.   It uses Principal Component Analysis in the residuals of different models and plots the resuls. 
</p>


<h3>Value</h3>

<p>A biplot of the first two components is plotted.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

  <p><code><a href="gamlss.html#topic+gamlss">gamlss</a></code>, <code><a href="#topic+resid_index">resid_index</a> </code></p>


<h3>Examples</h3>

<pre><code class='language-R'>m1 &lt;- gamlss(y~x, data=abdom)
m2 &lt;- gamlss(y~pb(x), data=abdom)
m3 &lt;- gamlss(y~pb(x), sigma.fo=~pb(x), data=abdom)
model_pca(m1,m2,m3)
</code></pre>

<hr>
<h2 id='moment_bucket'>Moment bucket plot</h2><span id='topic+moment_bucket'></span><span id='topic+moment_bucket_wrap'></span><span id='topic+model_mom_bucket'></span>

<h3>Description</h3>

<p>A bucket plot is a graphical way to check the skewness and kurtosis of a continuous variable or the residuals of a fitted GAMLSS model. It plots the transformed moment skewness and  transformed moment kurtosis of the variable (or residuals) together with a cloud of points obtained using a non-parametric bootstrap from the original variable (or residuals). It also provides a graphical way of performing the  Jarque-Bera test (JarqueandBera,1980). 
</p>
<p>There are two function here:
</p>
<p>i) <code>moment_bucket()</code> for a single bucket plot. Note that  <code>model_mom_bucket()</code>  and <code>moment_bucket()</code> are synonymous.
</p>
<p>ii) <code>moment_bucket_wrap()</code> for multiple bucket plots cut according to  terms in the model. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moment_bucket(x, ..., weights = NULL, no_bootstrap = 99, 
           col_bootstrap = hcl.colors(length.obj, palette = "Set 2"), 
           alpha_bootstrap = 1, text_to_show = NULL, 
           cex_text = 5, col_text = "black", colour_bucket = FALSE, 
           line_width = 0.5, col_JB_test = gray(.7), alpha_JB_test = .1)
           
model_mom_bucket(x, ..., weights = NULL, no_bootstrap = 99, 
          col_bootstrap = hcl.colors(length.obj, palette = "Set 2"), 
          alpha_bootstrap = 1, text_to_show = NULL, 
          cex_text = 5, col_text = "black", colour_bucket = FALSE, 
          line_width = 0.5, col_JB_test = gray(.7), alpha_JB_test = .1)           
           
moment_bucket_wrap(x, ..., weights = NULL, xvar = NULL, n_inter = 4,
          no_bootstrap = 99, 
          col_bootstrap = hcl.colors(length.obj, palette = "Set 2"), 
          alpha_bootstrap = 1, text_to_show = NULL, 
          check_overlap_text = FALSE, cex_text = 5, 
          col_text = "black", colour_bucket = FALSE,
          col_JB_test = gray(.7), alpha_JB_test = .1)           
           
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moment_bucket_+3A_x">x</code></td>
<td>
<p>x should be a continuous vector of a GAMLSS fitted model. </p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_...">...</code></td>
<td>
<p>this for more that one continuous vectors or fitted models</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_weights">weights</code></td>
<td>
<p>if priors weights are needed</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_no_bootstrap">no_bootstrap</code></td>
<td>
<p>the number of bootstrap samples for the cloud around the point of skewness and kurtosis.</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_col_bootstrap">col_bootstrap</code></td>
<td>
<p>The colour of the bootstrap samples</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_alpha_bootstrap">alpha_bootstrap</code></td>
<td>
<p>The transparency parameter of the bootstrap samples.</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_text_to_show">text_to_show</code></td>
<td>
<p>what text to show in the plots, default the names of vectors ot models</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_cex_text">cex_text</code></td>
<td>
<p>the character size of the text</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_col_text">col_text</code></td>
<td>
<p>the colour of the text</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_colour_bucket">colour_bucket</code></td>
<td>
<p>whether colour or gray lines in the bucket</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_line_width">line_width</code></td>
<td>
<p>the line width</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_xvar">xvar</code></td>
<td>
<p>the x term</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_n_inter">n_inter</code></td>
<td>
<p>how many intervals needed</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_check_overlap_text">check_overlap_text</code></td>
<td>
<p>whether to check overlapping text</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_col_jb_test">col_JB_test</code></td>
<td>
<p>the colour for the Jarque-Bera test</p>
</td></tr>
<tr><td><code id="moment_bucket_+3A_alpha_jb_test">alpha_JB_test</code></td>
<td>
<p>the transparency constant for the Jarque-Bera test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot displaying the transformed moment skewness and  transformed moment kurtosis of the sample or residual of a model.
</p>


<h3>Note</h3>

<p>The  bucket plot provides an additional residual diagnostic tool that can be used for fitted model checking, alongside other diagnostic tools, for example   worm plots, and Q (and Z) statistics.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos,  Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>De Bastiani, F.,   Stasinopoulos, D. M., Rigby, R. A., Heller, G. Z., and Lucas A. (2022) Bucket Plot: A Visual Tool for Skewness and Kurtosis Comparisons. To be published.
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. <a href="https://doi.org/10.1201/9780429298547">doi:10.1201/9780429298547</a>
An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://doi.org/10.18637/jss.v023.i07">doi:10.18637/jss.v023.i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b21973">doi:10.1201/b21973</a>
</p>
<p>Stasinopoulos, M. D., Rigby, R. A., and De Bastiani F., (2018) GAMLSS: a distributional regression approach, <em>Statistical Modelling</em>, Vol. <b>18</b>, 
pp, 248-273, SAGE Publications Sage India: New Delhi, India. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also  <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+wp">wp</a>, <a href="gamlss.html#topic+Q.stats">Q.stats</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>m1 &lt;- gamlss(R~pb(Fl)+pb(A), data=rent, family=GA)
moment_bucket(m1)
moment_bucket_wrap(m1, xvar=rent$A)
</code></pre>

<hr>
<h2 id='moment_gray_half'>Functions to create the background for the bucket plots</h2><span id='topic+moment_gray_half'></span><span id='topic+moment_gray_both'></span><span id='topic+moment_colour_half'></span><span id='topic+moment_colour_both'></span><span id='topic+centile_gray_both'></span><span id='topic+centile_colour_half'></span><span id='topic+centile_colour_both'></span>

<h3>Description</h3>

<p>The functions plot the moment transformed skewness and moment transformed kurtosis  of five important 4-parameter distributions in GAMLSS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
moment_gray_half(legend = FALSE)

moment_gray_both(line_width = 1)

moment_colour_half(legend = TRUE)

moment_colour_both(legend = TRUE, line_width = 1)

centile_colour_half(type = c("tail", "central"), legend = TRUE, 
                   line_width = 1)

centile_colour_both(type = c("tail", "central"), legend = TRUE, 
                   line_width = 1)

centile_gray_both(type = c("tail", "central"), legend = TRUE, 
                  line_width = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moment_gray_half_+3A_legend">legend</code></td>
<td>
<p>whether legend is required</p>
</td></tr>
<tr><td><code id="moment_gray_half_+3A_line_width">line_width</code></td>
<td>
<p>line width</p>
</td></tr>
<tr><td><code id="moment_gray_half_+3A_type">type</code></td>
<td>
<p>whether to plot &lsquo;tail&rsquo; or &lsquo;central&rsquo; skewness and kurtosis. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions are described in Rigby <em>et al</em> (2019) 
</p>


<h3>Value</h3>

<p>A plot is created.
</p>


<h3>Note</h3>

<p>The functions are use by the bucket plot function <code>model_mom_bucket()</code> to create the background of the bucket plots.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda de Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. <a href="https://doi.org/10.1201/9780429298547">doi:10.1201/9780429298547</a>
An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://doi.org/10.18637/jss.v023.i07">doi:10.18637/jss.v023.i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b21973">doi:10.1201/b21973</a>
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also  <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.dist.html#topic+momentSK">momentSK</a></code>, <code><a href="gamlss.dist.html#topic+centileSK">centileSK</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>moment_gray_half()
moment_gray_both()
moment_colour_half()
moment_colour_both()

centile_colour_both()
centile_gray_both()
centile_colour_half()
</code></pre>

<hr>
<h2 id='pcr_coef_path'>
Plotting the fitted path of a PCR  model.
</h2><span id='topic+pcr_coef_path'></span><span id='topic+pcr_path'></span>

<h3>Description</h3>

<p>This function is similar to the function <code>plot.PCR()</code> which is used to plot the path of a fitted principal componet regression model, fitted using the function <code>fitPCR()</code> of the package <span class="pkg">gamlss.foreach</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcr_coef_path(x, legend=FALSE, plot=TRUE)

pcr_path(x, parameter = c("mu", "sigma", "nu", "tau"),
          legend = FALSE, plot = TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcr_coef_path_+3A_x">x</code></td>
<td>
<p>a fitted PCR object (or a fitted GAMLSS object for function <code>pcr_path(</code></p>
</td></tr>
<tr><td><code id="pcr_coef_path_+3A_legend">legend</code></td>
<td>
<p>whether legent is needed</p>
</td></tr>
<tr><td><code id="pcr_coef_path_+3A_plot">plot</code></td>
<td>
<p>whether to plot the path</p>
</td></tr>
<tr><td><code id="pcr_coef_path_+3A_parameter">parameter</code></td>
<td>
<p>which GAMLSS parameter, between &quot;mu&quot;, &quot;sigma&quot;, &quot;nu&quot;, &quot;tau&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A gg-plot.</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.foreach.html#topic+plot.PCR">plot.PCR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(gamlss.foreach)
library(glmnet)
library(ggplot2)
data(QuickStartExample)
attach(QuickStartExample)
hist(y, main="(a)")
if (is.null(rownames(x))) 
  colnames(x) &lt;- paste0("X", seq(1:dim(x)[2]))
# fitting
MM&lt;- fitPCR(x,y, k=log(100))
pp&lt;-pcr_coef_path(MM)
pp+ ggplot2::geom_vline(xintercept = MM$pc, colour = "gray") 
# using gamlss
m1 &lt;- gamlss(y~pcr(x=x))
pcr_path(m1)

</code></pre>

<hr>
<h2 id='pe_param'>
Partial Effect of a term on the parameters and predictors</h2><span id='topic+pe_param'></span><span id='topic+pe_1_param'></span><span id='topic+pe_2_param'></span><span id='topic+pe_param_grid'></span>

<h3>Description</h3>

<p>The function <code>pe_param()</code> is similar to the function <code>getPEF()</code> of the <span class="pkg">gamlss</span> package. It plot the partial effect that a particular term has one of the parameters of the distribution or its predictor <code>eta</code>. 
The function <code>pe2_param()</code> is build for partial effects from two terms and it is suitable to display first order interactions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pe_param(obj = NULL, term = NULL, data = NULL, n.points = 100, 
               parameter = c("mu", "sigma", "nu", "tau"), 
               type = c("parameter", "eta"), scenario = list(),  
               how = c("median", "last", "fixed"),
               col = "darkblue", size = 1.3, name.obj = NULL,
               rug.plot = TRUE, rug.col = "gray", rug.size = 0.5,  
               data.plot = FALSE, data.col = "lightblue", 
               data.size = 0.1, factor.size = 15,
               data.alpha = 0.9, bins = 30, 
               filled = FALSE, ylim = NULL,
                    title) 

pe_1_param(obj = NULL, term = NULL, data = NULL, n.points = 100,  
                parameter = c("mu", "sigma", "nu", "tau"), 
                type = c("parameter", "eta"),
                how = c("median", "last", "fixed"),
                scale.from = c("mean", "median", "none"),
                scenario = list(), col = "darkblue", size = 1.3,
                name.obj = NULL, data.plot = FALSE, 
                data.col = "lightblue",data.size = 0.1,
                data.alpha = 0.9, rug.plot = TRUE, rug.col = "gray",
                rug.size = 0.5, factor.size = 15,
                ylim = NULL, title) 

pe_2_param(obj = NULL, terms = NULL, data = NULL, n.points = 100, 
                parameter = c("mu", "sigma", "nu", "tau"), 
                type = c("parameter", "eta"),
                how = c("median", "last", "fixed"),
                scenario = list(), col = "darkblue",
                size = 1.3, data.plot = TRUE,
                data.col = "lightblue", data.size = 0.1,
                data.alpha = 0.9,bins = 30, 
                filled = FALSE, name.obj = NULL, title) 

pe_param_grid(model, terms, maxcol = 2, maxrow = 3, ylim=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pe_param_+3A_obj">obj</code></td>
<td>
<p>a GAMLSS fitted object</p>
</td></tr>
<tr><td><code id="pe_param_+3A_model">model</code></td>
<td>
<p>a GAMLSS fitted model</p>
</td></tr>
<tr><td><code id="pe_param_+3A_term">term</code></td>
<td>
<p>the model term we want to investigate can be one i.e. &quot;Fl&quot; or two 
c(&quot;Fl&quot;, &quot;A&quot;)</p>
</td></tr>
<tr><td><code id="pe_param_+3A_terms">terms</code></td>
<td>
<p>a list of  model terms for example 
<code>list(c("Fl","A"), "H", "loc" ))</code> </p>
</td></tr>
<tr><td><code id="pe_param_+3A_data">data</code></td>
<td>
<p>the data frame used otherwise it takes it from the fitted model</p>
</td></tr>
<tr><td><code id="pe_param_+3A_n.points">n.points</code></td>
<td>
<p>the number of points for the evaluation of the term</p>
</td></tr>
<tr><td><code id="pe_param_+3A_parameter">parameter</code></td>
<td>
<p>the distribution parameter in which  the term is fitted</p>
</td></tr>
<tr><td><code id="pe_param_+3A_type">type</code></td>
<td>
<p>here you specify or the distribution  parameter i.e        <code>"parameter"</code> or its  prediction, <code>"eta"</code></p>
</td></tr>
<tr><td><code id="pe_param_+3A_how">how</code></td>
<td>
<p>how to set all the other terms in the model</p>
</td></tr>
<tr><td><code id="pe_param_+3A_scenario">scenario</code></td>
<td>
<p>this can be a list of values for the rest of the terms in the model for the distribution parameter</p>
</td></tr>
<tr><td><code id="pe_param_+3A_plot">plot</code></td>
<td>
<p>whether to plot the result</p>
</td></tr>
<tr><td><code id="pe_param_+3A_col">col</code></td>
<td>
<p>the colour of the partial effect of the term</p>
</td></tr>
<tr><td><code id="pe_param_+3A_size">size</code></td>
<td>
<p>the size of the line of partial effect of the term</p>
</td></tr>
<tr><td><code id="pe_param_+3A_bins">bins</code></td>
<td>
<p>the number of binds for the contour plot</p>
</td></tr>
<tr><td><code id="pe_param_+3A_filled">filled</code></td>
<td>
<p>whether to display the values  in the contour</p>
</td></tr>
<tr><td><code id="pe_param_+3A_title">title</code></td>
<td>
<p>the title if different from the default</p>
</td></tr>
<tr><td><code id="pe_param_+3A_name.obj">name.obj</code></td>
<td>
<p>this is a way to pass the name of the object</p>
</td></tr>
<tr><td><code id="pe_param_+3A_maxcol">maxcol</code></td>
<td>
<p>the maximum columns in the grid plot</p>
</td></tr>
<tr><td><code id="pe_param_+3A_maxrow">maxrow</code></td>
<td>
<p>the maximum rowss in the grid plot</p>
</td></tr>
<tr><td><code id="pe_param_+3A_data.plot">data.plot</code></td>
<td>
<p>whether to plot the data</p>
</td></tr>
<tr><td><code id="pe_param_+3A_rug.plot">rug.plot</code></td>
<td>
<p>whether to print the rug bellow the figure</p>
</td></tr>
<tr><td><code id="pe_param_+3A_rug.size">rug.size</code></td>
<td>
<p>the size of the rug</p>
</td></tr>
<tr><td><code id="pe_param_+3A_rug.col">rug.col</code></td>
<td>
<p>the colour of the rug</p>
</td></tr>
<tr><td><code id="pe_param_+3A_data.col">data.col</code></td>
<td>
<p>the color of the data points</p>
</td></tr>
<tr><td><code id="pe_param_+3A_data.size">data.size</code></td>
<td>
<p>the size of the data points</p>
</td></tr>
<tr><td><code id="pe_param_+3A_data.alpha">data.alpha</code></td>
<td>
<p>the trnsparance constant of the data points</p>
</td></tr>
<tr><td><code id="pe_param_+3A_factor.size">factor.size</code></td>
<td>
<p>the size of the symbol if a factor is plotted</p>
</td></tr>
<tr><td><code id="pe_param_+3A_ylim">ylim</code></td>
<td>
<p>if a common y limit is required</p>
</td></tr>
<tr><td><code id="pe_param_+3A_scale.from">scale.from</code></td>
<td>
<p>whethet to substact from the mean the median or from zero</p>
</td></tr>
<tr><td><code id="pe_param_+3A_...">...</code></td>
<td>
<p>for passing argument from the function <code>pe_param_grid</code> to the function <code>pe_param</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>pe_param()</code> and <code>pe_param_grid()</code> can be used to help the use the  interpretation of a GAMLSS model. 
The functions <code>pe_param()</code> provides the partial effect of one or two   terms  of a specified  parameter of the distribution while the rest of the terms in the model are set on specific values or scenarios. The function <code>pe_param()</code> calls <code>pe_1param()</code> if the argument terms is one i.e. &quot;Fl&quot; or the function 
<code>pe_2param()</code> if the terms are two i.e. c(&quot;Fl&quot;&quot;,&quot;A&quot;). 
The <code>pe_param_grid()</code> plots multiple plots specified by the list used in the <code>term</code> argument. 
</p>
<p>Similar functions are 
<code>pe_quantile()</code> and <code>pe_moment()</code>. 
</p>


<h3>Value</h3>

<p>It is plotting the partial effect or is producing the resulting function
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopulos, Rober Rigby and Fernanda de Bastiani 
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+getPEF">getPEF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m1 &lt;- gamlss(R~pb(Fl)+pb(A)+loc+H, data=rent, gamily=GA)
pe_param(m1, "A")
pe_param(m1, c("Fl","A"), filled=TRUE)
pe_param_grid(m1, list(c("Fl","A"), c("H","loc")), filled=TRUE)
# the terms are additive no interaction
</code></pre>

<hr>
<h2 id='pe_pdf'>Partial Effect of a term on the response distribution</h2><span id='topic+pe_pdf'></span><span id='topic+pe_pdf_grid'></span>

<h3>Description</h3>

<p>The function <code>pe_pdf()</code>  plots the partial effect that a specified term has on the distribution of the response. 
</p>
<p>The function <code>pe_pdf_grid()</code> plot multiple plots on the same page. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pe_pdf(obj = NULL, term = NULL,  from = NULL, to = NULL,
          y.grid.points = 100, x.grid.points = 10, x.values,
          data = NULL, scale = NULL, how = c("median", "last"), 
          scenario = list(), size = 0.1, horizontal = TRUE, 
          col.fill = hcl.colors(lqq, palette = "viridis"), 
          alpha = 0.6, xlim = NULL, title)
      
pe_pdf_grid(model, terms, maxcol = 2, maxrow = 3, ...)      
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pe_pdf_+3A_obj">obj</code>, <code id="pe_pdf_+3A_model">model</code></td>
<td>
<p>A GAMLSS object</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_term">term</code></td>
<td>
<p>The model term</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_terms">terms</code></td>
<td>
<p>The model terms, more than one for <code>pe_pdf_grid()</code>.</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_from">from</code></td>
<td>
<p>start from</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_to">to</code></td>
<td>
<p>end to </p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_y.grid.points">y.grid.points</code></td>
<td>
<p>in how many points the pdf should be evaluates</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_x.grid.points">x.grid.points</code></td>
<td>
<p>in how namy points the terms should be plotted</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_x.values">x.values</code></td>
<td>
<p>possible x values</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_data">data</code></td>
<td>
<p>The data used for modelling</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_scale">scale</code></td>
<td>
<p>This is a very importnat value for plotting correctly the fitted distrutions. If the defaul values it is  not working please try different values</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_how">how</code></td>
<td>
<p>How to fixed the rest of the variables. For continuous oit takes the median fot factor the level with the highest frequency.</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_scenario">scenario</code></td>
<td>
<p>Alternatively scenatio for fixing the values.</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_size">size</code></td>
<td>
<p>the size of the pdf line</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_horizontal">horizontal</code></td>
<td>
<p>whether to plot the partial pdf on the x-axis and the x on the y-axix or opposite</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_col.fill">col.fill</code></td>
<td>
<p>how to fill the pdf body</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_alpha">alpha</code></td>
<td>
<p>the transparency factor</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_xlim">xlim</code></td>
<td>
<p>the limits for plotting x-axis</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_title">title</code></td>
<td>
<p>whether to use a different tittle from the default one</p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_maxcol">maxcol</code></td>
<td>
<p>maximum of colomns in the grid for <code>pe_pdf_grid()</code></p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_maxrow">maxrow</code></td>
<td>
<p>maximum of rows on the grid for <code>pe_pdf_grid()</code></p>
</td></tr>
<tr><td><code id="pe_pdf_+3A_...">...</code></td>
<td>
<p>extra argument to be passed form <code>pe_pdf()</code> to <code>pe_pdf_grid()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>pe_pdf()</code> is one of the function design to help the use to interpret the GAMLSS model. Provides the partial effect that one of the continuous terms has on distribution of the response while the rest of the variables in the model are set on specific values or scenarios. Others similar functions are 
<code>pe_param()</code>, <code>pe_moment()</code> and <code>pe_quantile()</code>. 
</p>


<h3>Value</h3>

<p>A plot of the conditional distribution given the term 
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopulos, Rober Rigby and Fernanda de Bastiani 
</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pe_param">pe_param</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m1 &lt;- gamlss(R~pb(Fl)+pb(A)+loc+H, data=rent, gamily=GA)
pe_pdf(m1, "A")
pe_pdf(m1, "A")
pe_pdf(m1, "A", horizontal=FALSE)
pe_pdf_grid(m1, c("Fl", "A", "H", "loc"))
</code></pre>

<hr>
<h2 id='prof_term'>Plotting the profile deviance of one fitted term</h2><span id='topic+prof_term'></span>

<h3>Description</h3>

<p>Plotting the profile deviance of a fitted term in GAMLSS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prof_term(model = NULL, criterion = c("GD", "GAIC"), 
      penalty = 2.5,  from = NULL, to = NULL, 
      step = NULL, length = 7, xlabel = NULL, plot = TRUE, 
      perc = 95, start.prev = TRUE, line.col = "darkgreen", 
      dash.line.type = 3, dash.line.size = 0.8, text.size = 5, title)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prof_term_+3A_model">model</code></td>
<td>
<p>a GAMLSS fitted model</p>
</td></tr>
<tr><td><code id="prof_term_+3A_criterion">criterion</code></td>
<td>
<p>whether Global deviance or GAIC</p>
</td></tr>
<tr><td><code id="prof_term_+3A_penalty">penalty</code></td>
<td>
<p>the penalty k for GAIC</p>
</td></tr>
<tr><td><code id="prof_term_+3A_from">from</code></td>
<td>
<p>start from</p>
</td></tr>
<tr><td><code id="prof_term_+3A_to">to</code></td>
<td>
<p>finish at</p>
</td></tr>
<tr><td><code id="prof_term_+3A_step">step</code></td>
<td>
<p>using step</p>
</td></tr>
<tr><td><code id="prof_term_+3A_length">length</code></td>
<td>
<p>if the <code>step</code> is left NULL then <code>length</code> is considered for evaluating the grid for the parameter. It has a default value of 11.</p>
</td></tr>
<tr><td><code id="prof_term_+3A_xlabel">xlabel</code></td>
<td>
<p>if a x label is required</p>
</td></tr>
<tr><td><code id="prof_term_+3A_plot">plot</code></td>
<td>
<p>whether tto plot the function</p>
</td></tr>
<tr><td><code id="prof_term_+3A_perc">perc</code></td>
<td>
<p>what percentage confidence interval is required</p>
</td></tr>
<tr><td><code id="prof_term_+3A_start.prev">start.prev</code></td>
<td>
<p>whether to start from the previous fitted model parameters
values or not (default is TRUE)</p>
</td></tr>
<tr><td><code id="prof_term_+3A_line.col">line.col</code></td>
<td>
<p>the colour of the plotting line</p>
</td></tr>
<tr><td><code id="prof_term_+3A_dash.line.type">dash.line.type</code></td>
<td>
<p>the type of verical dash line for CI's</p>
</td></tr>
<tr><td><code id="prof_term_+3A_dash.line.size">dash.line.size</code></td>
<td>
<p>The size of the dash lines</p>
</td></tr>
<tr><td><code id="prof_term_+3A_text.size">text.size</code></td>
<td>
<p>the size of text</p>
</td></tr>
<tr><td><code id="prof_term_+3A_title">title</code></td>
<td>
<p>the title</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is the <code>ggplot2</code> version of the original <code>prof.term()</code> function.
</p>


<h3>Value</h3>

<p>creates a  plot
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+prof.term">prof.term</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aids)
# fitting a linear model
gamlss(y~x+qrt,family=NBI,data=aids)
# testing the linear beta parameter
mod&lt;-quote(gamlss(y ~ offset(this * x) + qrt, data = aids, family = NBI))
prof_term(mod, from = .06, to=0.13)
</code></pre>

<hr>
<h2 id='resid_density'>Density of the residuals in a GAMLLSS model</h2><span id='topic+resid_density'></span><span id='topic+model_density'></span>

<h3>Description</h3>

<p>The function  <code>resid_density()</code> plots an histogram and a density estimator of the normalised quantile residuals from a fitted GAMLSS model. The function  <code>model_density()</code> plots  density estimators of the normalised quantile residuals from more than one  fitted GAMLSS models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resid_density(obj, resid, hist.col = "black", hist.fill = "white", 
              dens.fill = "#FF6666", title)
model_density(obj, ..., title)              
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_density_+3A_obj">obj</code></td>
<td>

<p>The function needs a  GAMLSS fitted model or 
</p>
</td></tr>
<tr><td><code id="resid_density_+3A_resid">resid</code></td>
<td>
<p>any standarised residual </p>
</td></tr>
<tr><td><code id="resid_density_+3A_hist.col">hist.col</code></td>
<td>
<p>The colour of the border of the histogram</p>
</td></tr>
<tr><td><code id="resid_density_+3A_hist.fill">hist.fill</code></td>
<td>
<p>The colout of the hisogram</p>
</td></tr>
<tr><td><code id="resid_density_+3A_dens.fill">dens.fill</code></td>
<td>
<p>the colour of the desnsity</p>
</td></tr>
<tr><td><code id="resid_density_+3A_title">title</code></td>
<td>
<p>A title if needed</p>
</td></tr>
<tr><td><code id="resid_density_+3A_...">...</code></td>
<td>
<p>extra GAMLSS models</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function <code>resid_density()</code> is a  denity plot (similar to of the four  plots produded when the  plotting function <code>plot.gamlss()</code> is used within the  <span class="pkg">gamlss</span> package.
I uses plotting function from   the <span class="pkg">ggplot2</span> package.
</p>


<h3>Value</h3>

<p>A density plot of the residuals is produced.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+plot.gamlss">plot.gamlss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(abdom)
a&lt;-gamlss(y~pb(x),family=LO,data=abdom)
b&lt;-gamlss(y~pb(x),family=NO,data=abdom)
resid_density(a)
model_density(a,b)
</code></pre>

<hr>
<h2 id='resid_dtop'>Detrended Transformed Owen's Plot and ECDF for the residuals</h2><span id='topic+resid_dtop'></span><span id='topic+resid_ecdf'></span><span id='topic+y_ecdf'></span>

<h3>Description</h3>

<p>The function <code>resid_dtop()</code> provides single de-trended transformed  Owen's plot, Owen (1995), for a GAMLSS fitted objects or any other residual vector (suitable standardised). This is a diagnostic tool for checking whether the normalised quantile residuals are coming from a normal distribution or not. 
This could be true if the horizontal line is within the confidence intervals.
</p>
<p>The function <code>resid_ecdf()</code> provides the empirical cumulative distribution function of the residuals.
</p>
<p>The function <code>y_ecdf()</code> provides the empirical cumulative distribution function of any numerical vector <code>y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resid_dtop(obj, resid, type = c("Owen", "JW"), conf.level = c("95", "99"),
           value = 2, points.col = "steelblue4",
           check_overlap = TRUE,  title, ylim, ...)
           
resid_ecdf(obj, resid, type = c("Owen", "JW"), conf.level = c("95", "99"), 
           value = 2, points.col = "steelblue4", 
           check_overlap = TRUE,  show.outliers = TRUE, title, ...)
           
y_ecdf(y, type = c("Owen", "JW"), conf.level = c("95", "99"), value = 2, 
           points.col = "steelblue4", check_overlap = TRUE, 
           show.outliers = FALSE, from, to, title, ...)           
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_dtop_+3A_obj">obj</code></td>
<td>
<p>A GAMLSS fitted model</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_resid">resid</code></td>
<td>
<p>if the object is not specified the residual vector can be given here</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_y">y</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_type">type</code></td>
<td>
<p>whether to use Owen (1995) or Jager and Wellner (2004) approximate formula</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_conf.level">conf.level</code></td>
<td>
<p> 95% (default) or 99% percent confidence interval for the plots</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_value">value</code></td>
<td>
<p>cut of point for large residuals</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_points.col">points.col</code></td>
<td>
<p>the colour of the points in the plot</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_check_overlap">check_overlap</code></td>
<td>
<p>to check for overlap when plotting the observation numbers</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_title">title</code></td>
<td>
<p>required title</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_show.outliers">show.outliers</code></td>
<td>
<p>whether to shoe the number of an outlier obsrvation</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_ylim">ylim</code></td>
<td>
<p>if the y limit should be different from the default max(y)+.1</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_from">from</code></td>
<td>
<p>where to start the ecdf</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_to">to</code></td>
<td>
<p>where to finish the ecdf</p>
</td></tr>
<tr><td><code id="resid_dtop_+3A_...">...</code></td>
<td>
<p> further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot is generated</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda de Bastiani</p>


<h3>References</h3>

<p>Jager, L. and Wellner, J. A (2004) A new goodness of fit test: the reversed Berk-Jones statistic, University of Washington, Department of Statistics, Technical report 443. 
</p>
<p>Owen A. B. (1995) Nonparametric Confidence Bands for a Distribution Function. Journal of the American Statistical Association Vol. 90, No 430, pp. 516-521.
</p>
<p>Rigby, R. A. and Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), Appl. Statist., 54, part 3, 1-38.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+resid_wp">resid_wp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
data(abdom)
a&lt;-gamlss(y~pb(x),sigma.fo=~pb(x,1),family=LO,data=abdom)
resid_dtop(a)
resid_ecdf(a)+ stat_function(fun = pNO, args=list(mu=0, sigma=1)) 
# create a gamma distributed random variable
y &lt;- rGA(1000, mu=3, sigma=1)
gp&lt;- y_ecdf(y)
gp + stat_function(fun = pGA, args=list(mu=3, sigma=1)) 
</code></pre>

<hr>
<h2 id='resid_index'>A residual plots</h2><span id='topic+resid_index'></span><span id='topic+resid_mu'></span><span id='topic+resid_median'></span><span id='topic+resid_param'></span><span id='topic+resid_plots'></span><span id='topic+resid_xvar'></span><span id='topic+resid_quantile'></span>

<h3>Description</h3>

<p>The function <code>resid_index()</code> is plotting the residuals of a GAMLSS fitted model (or any other suitable standardised residual) against the observation number index. 
</p>
<p>The function <code>resid_mu()</code> plots the residuals against fitted values for <code>mu</code>.  
</p>
<p>The function <code>resid_median()</code> plots the residuals against fitted median values.
</p>
<p>The function <code>resid_param()</code> plots the residuals against any of the GAMLSS fitted parameters, <code>mu</code>, <code>sigma</code>, <code>nu</code>, or <code>tau</code>.
</p>
<p>The function <code>resid_quantile()</code> plots the residuals against any fitted quantile. 
</p>
<p>The function <code>resid_xvar()</code> plots the residuals against an explanatory term.
</p>
<p>The function <code>resid_plots()</code> produces a plot similar to the one that the function  <code>plot()</code> produce for a GAMLSS model in package <span class="pkg">gamlss</span>. This is, four plots:   a) <code>resid_index()</code>(b) <code>resid_mu()</code>, (c) <code>resid_density()</code> and (d) <code>resid_qqplot()</code>. 
</p>
<p>Residuals above (or below) certain specified value are identified. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resid_index(obj, resid, plot = TRUE, value = 2, title, annotate = TRUE, 
           no.lines = FALSE)
           
resid_mu(obj, resid, plot = TRUE, value = 2, title, annotate = TRUE)

resid_median(obj, resid, plot = TRUE, value = 3, title, 
            annotate = TRUE)

resid_param(obj, param = c("mu", "sigma", "nu", "tau"), title, 
            line.col = "darkred", point.col = "steelblue4", 
            point.shape = 20)            

resid_quantile(obj, quantile = 0.5, title, newdata, 
            line.col = "darkred", point.col = "steelblue4", 
            point.shape = 20)
            
resid_plots(obj, theme = c("original", "ts", "new", "ecdf"), value = 3)

resid_xvar(obj, xvar, plot = TRUE, value = 2, title, annotate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_index_+3A_obj">obj</code></td>
<td>
<p>a GAMLSS object</p>
</td></tr>
<tr><td><code id="resid_index_+3A_resid">resid</code></td>
<td>
<p>or any other suitable standardised residual vector.</p>
</td></tr>
<tr><td><code id="resid_index_+3A_xvar">xvar</code></td>
<td>
<p>a continuous explanatory variable</p>
</td></tr>
<tr><td><code id="resid_index_+3A_plot">plot</code></td>
<td>
<p>whether to plot the result</p>
</td></tr>
<tr><td><code id="resid_index_+3A_param">param</code></td>
<td>
<p>which GAMLSS parameter <code>mu</code>, <code>sigma</code>, <code>nu</code>, or <code>tau</code></p>
</td></tr>
<tr><td><code id="resid_index_+3A_value">value</code></td>
<td>
<p>the cut off value for the identification of very large or very small residuals</p>
</td></tr>
<tr><td><code id="resid_index_+3A_annotate">annotate</code></td>
<td>
<p>whether the threshold annotation should appear or not</p>
</td></tr>
<tr><td><code id="resid_index_+3A_line.col">line.col</code></td>
<td>
<p>the colour of the line</p>
</td></tr>
<tr><td><code id="resid_index_+3A_point.col">point.col</code></td>
<td>
<p>the colour of the points</p>
</td></tr>
<tr><td><code id="resid_index_+3A_point.shape">point.shape</code></td>
<td>
<p>the shape of the points</p>
</td></tr>
<tr><td><code id="resid_index_+3A_title">title</code></td>
<td>
<p>a title of the plot if needed</p>
</td></tr>
<tr><td><code id="resid_index_+3A_theme">theme</code></td>
<td>
<p>what type of plots should <code>resid_plots()</code> used : &quot;original&quot; is like using <code>plot.gamlss()</code>,
&quot;ts&quot; is like using <code>plot.gamlss(,ts="TRUE")</code> (not implemented yet),
&quot;new&quot; it uses (a) <code>resid_index()</code>,  (b) <code>resid_density()</code>, (c) <code>resid_wp()</code> and (d) 
<code>resid_dtop().</code>
</p>
</td></tr>
<tr><td><code id="resid_index_+3A_no.lines">no.lines</code></td>
<td>
<p>this option allows to hide the horizontal lines so the resulting gg-plot can be used later with say <code>facet_wrap()</code> see example</p>
</td></tr>  
<tr><td><code id="resid_index_+3A_newdata">newdata</code></td>
<td>
<p>whether the evaluation should be in newdata or the old data points</p>
</td></tr>
<tr><td><code id="resid_index_+3A_quantile">quantile</code></td>
<td>
<p>which quantile? default the median (0.50).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the residuals is returned.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

 
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC, <a href="https://doi.org/10.1201/9780429298547">doi:10.1201/9780429298547</a>.
An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://doi.org/10.18637/jss.v023.i07">doi:10.18637/jss.v023.i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. <a href="https://doi.org/10.1201/b21973">doi:10.1201/b21973</a>
</p>
<p>Stasinopoulos, M. D., Rigby, R. A., and De Bastiani F., (2018) GAMLSS: a distributional regression approach, <em>Statistical Modelling</em>, Vol. <b>18</b>, 
pp, 248-273, SAGE Publications Sage India: New Delhi, India. 
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also  <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

  <p><code><a href="gamlss.html#topic+gamlss">gamlss</a></code>, <code><a href="gamlss.html#topic+plot.gamlss">plot.gamlss</a> </code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
data(rent)
r1&lt;-gamlss(R~pb(Fl)+pb(A)+H+loc,family=GA,data=rent)
resid_index(r1)
resid_mu(r1)
resid_median(r1)
resid_param(r1)
resid_quantile(r1)
resid_xvar(r1, A)
resid_plots(r1)
resid_index(r1, no.lines=TRUE)+facet_wrap(~ cut_number(rent$A, 6))
</code></pre>

<hr>
<h2 id='resid_qqplot'>QQ-plot of the residuals of a GAMLSS model</h2><span id='topic+resid_qqplot'></span><span id='topic+add_resid_qqplot'></span><span id='topic+model_qqplot'></span>

<h3>Description</h3>

<p>The function <code>resid_qqplot()</code> produces a single QQ-plot of the residuals from a fitted GAMLSS model or any other model with suitable standardised residuals.
</p>
<p>The function <code>add_resid_qqplot()</code> takes a QQ-plot created by <code>resid_qqplot()</code>  and adds another QQ-plot  from a different fitted model.
</p>
<p>The function <code>model_resid_qqplots()</code> takes different fitted models and creates QQ-plots  for all fitted models. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resid_qqplot(obj, resid, value = 3, points.col = "steelblue4", 
              line.col = "darkgray", check_overlap = TRUE, title)
              
add_resid_qqplot(gg, obj, value = 3, points.col = "sienna",
             line.col = "darkgray", check_overlap = TRUE, title)  
             
model_qqplot(obj, ..., line.col = "steelblue4", title)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_qqplot_+3A_obj">obj</code></td>
<td>
<p>A GAMLLS fitted model or</p>
</td></tr>
<tr><td><code id="resid_qqplot_+3A_resid">resid</code></td>
<td>
<p>any other residual suitable standardised.</p>
</td></tr>
<tr><td><code id="resid_qqplot_+3A_gg">gg</code></td>
<td>
<p>a ggplot</p>
</td></tr>
<tr><td><code id="resid_qqplot_+3A_value">value</code></td>
<td>
<p>A cut off value to identify large or small residuals</p>
</td></tr>
<tr><td><code id="resid_qqplot_+3A_points.col">points.col</code></td>
<td>
<p>the colout of the points in the plot</p>
</td></tr>
<tr><td><code id="resid_qqplot_+3A_line.col">line.col</code></td>
<td>
<p>the colout of the line in the plot</p>
</td></tr>
<tr><td><code id="resid_qqplot_+3A_check_overlap">check_overlap</code></td>
<td>
<p>if observations are identify this reduvce the cluterring</p>
</td></tr>
<tr><td><code id="resid_qqplot_+3A_title">title</code></td>
<td>
<p>a title if needed it</p>
</td></tr>
<tr><td><code id="resid_qqplot_+3A_...">...</code></td>
<td>
<p>extra GAMLSS models</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a stanard QQ-plot but with the advadance of able to identify large or samll residuals</p>


<h3>Value</h3>

<p>A QQ-plotbis created
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+plot.gamlss">plot.gamlss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(abdom)
a&lt;-gamlss(y~pb(x),family=LO,data=abdom)
b&lt;-gamlss(y~pb(x),family=NO,data=abdom)
gg &lt;- resid_qqplot(a)
add_resid_qqplot(gg, b)
model_qqplot(a,b)
</code></pre>

<hr>
<h2 id='resid_symmetry'>Symmetry plots</h2><span id='topic+resid_symmetry'></span><span id='topic+y_symmetry'></span>

<h3>Description</h3>

<p>The functions <code>resid_symmetry()</code> and <code>y_symmetry()</code> plot symmtry plots for residuals and single variable, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resid_symmetry(model, title)

y_symmetry(y, title)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_symmetry_+3A_model">model</code></td>
<td>
<p>A model which allows the function <code>resid()</code></p>
</td></tr>
<tr><td><code id="resid_symmetry_+3A_y">y</code></td>
<td>
<p>a single variable</p>
</td></tr>
<tr><td><code id="resid_symmetry_+3A_title">title</code></td>
<td>
<p>A title for the plot if needed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function orders the data (or residuals) and takes the median minus the lower half and plot it against  the upper half minus the median. 
</p>


<h3>Value</h3>

<p>The symmetry plot is produced.
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+resid_index">resid_index</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- rBCT(1000, mu=3, sigma=.1, nu=-1, tau=5)
y_hist(y)
gg &lt;- y_symmetry(y)
</code></pre>

<hr>
<h2 id='resid_wp'>Worm plot using ggplot2</h2><span id='topic+model_wp'></span><span id='topic+resid_wp'></span><span id='topic+resid_wp_wrap'></span><span id='topic+model_wp_wrap'></span>

<h3>Description</h3>

<p>The function produces worm plot of the residuals of a fitted  model.  A worm plot is a de-trended normal QQ-plot so departure from normality is highlighted.
</p>
<p>The function <code>plot_wp()</code> it is similar to the <span class="pkg">gamlss</span> package function <code>wp()</code> when the argument <code>xvar</code> is not used.</p>


<h3>Usage</h3>

<pre><code class='language-R'>resid_wp(obj, resid, value = 3, points_col = "steelblue4", 
         poly_col = "darkred", 
         check_overlap = TRUE, title, ylim)

model_wp(obj, ..., title)  

resid_wp_wrap(obj, resid, value = 3, xvar = NULL, n_inter = 4, 
         points_col = "steelblue4", poly_col = "darkred", 
         alpha_bound = 0.1, check_overlap = TRUE, title, ylim)
         
model_wp_wrap(obj, ..., xvar = NULL, value = 3, n_inter = 4, 
         points_col = "steelblue4", alpha_bound = 0.1, 
         check_overlap = TRUE, ylim, title)         
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_wp_+3A_obj">obj</code></td>
<td>

<p>a GAMLSS fitted object or any other fitted model where the <code>resid()</code> method works (preferably the residuals should be standardised or better normalised quantile residuals. Note for <code>model_wp</code> only gamlss object are accepted.)
</p>
</td></tr>
<tr><td><code id="resid_wp_+3A_resid">resid</code></td>
<td>

<p>if object is missing this argument can be used to specify the residual vector (again it should a normalised quantile residual vector)
</p>
</td></tr>
<tr><td><code id="resid_wp_+3A_value">value</code></td>
<td>
<p>A cut off point to indicate large residuals, default is <code>value=3</code></p>
</td></tr>
<tr><td><code id="resid_wp_+3A_xvar">xvar</code></td>
<td>
<p>the x term  for which the worm plot will be plotted against</p>
</td></tr>
<tr><td><code id="resid_wp_+3A_n_inter">n_inter</code></td>
<td>
<p>the number of intervals for continuous x-term</p>
</td></tr>
<tr><td><code id="resid_wp_+3A_points_col">points_col</code></td>
<td>
<p>the color of the points in the plot</p>
</td></tr>
<tr><td><code id="resid_wp_+3A_poly_col">poly_col</code></td>
<td>
<p>the colour of the fitted polynomial in the plot</p>
</td></tr>
<tr><td><code id="resid_wp_+3A_check_overlap">check_overlap</code></td>
<td>
<p>to check for overlap  when plotting the observation numbers 
</p>
</td></tr>
<tr><td><code id="resid_wp_+3A_alpha_bound">alpha_bound</code></td>
<td>
<p>the transparency parameter for the coinfidence bound</p>
</td></tr>  
<tr><td><code id="resid_wp_+3A_title">title</code></td>
<td>
<p>required title</p>
</td></tr>
<tr><td><code id="resid_wp_+3A_ylim">ylim</code></td>
<td>
<p>if the y limit should be different from the default max(y)+.1</p>
</td></tr>
<tr><td><code id="resid_wp_+3A_...">...</code></td>
<td>
<p>extra GAMLSS models</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A worm plot is produced
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>van Buuren and Fredriks M. (2001) Worm plot: simple diagnostic device for modelling growth reference curves. 
<em>Statistics in Medicine</em>, <b>20</b>, 1259&ndash;1277
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+wp">wp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(abdom)
# with data
a&lt;-gamlss(y~pb(x),sigma.fo=~pb(x,1),family=LO,data=abdom)
resid_wp(a)
resid_wp(resid=resid(a))
</code></pre>

<hr>
<h2 id='resp_mu'>Plotting the response against  quantities of the fitted model</h2><span id='topic+resp_mu'></span><span id='topic+resp_param'></span><span id='topic+resp_quantile'></span><span id='topic+quantile_gamlss'></span>

<h3>Description</h3>

<p>All plots are of  the response variable against  fitted values of interest.
</p>
<p>The function <code>resp_mu()</code> is the &lsquo;original&rsquo; one plotting the response against the parameter <code>mu</code>. The function reports the Pearson's correlation coefficient and plot a lines (45% degrees) throught the graph.   
</p>
<p>The function <code>resp_param()</code> plots the response against any fitted parameter <code>mu</code>, <code>sigma</code>, <code>nu</code> or  <code>tau</code>.  The function also plots a smooth curve going throught the data and gives the  Pearson's correlation coefficient.
</p>
<p>The function <code>resp_quantile()</code> plots the response against any fitted quantile, with default the median (0.50). The function also plots a smooth curve going throught the data and gives the  Pearson's correlation coefficient.
</p>
<p>The function <code>quantile_gamlss()</code> is used by the function  <code>resp_quantile()</code> to calculate the quantiles of the fitted distribution . 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resp_mu(obj, title, line.col = "darkred", 
           point.col = "steelblue4", 
           point.shape = 20)
           
resp_param(obj, param = c("mu", "sigma", "nu", "tau"), 
           title, line.col = "darkred", point.col = "steelblue4", 
           point.shape = 20)

resp_quantile(obj, quantile = 0.5, title, newdata, 
           line.col = "darkred", point.col = "steelblue4", 
           point.shape = 20)

quantile_gamlss(obj, quantile = 0.5, newdata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resp_mu_+3A_obj">obj</code></td>
<td>
<p>a GAMLSS fitted object</p>
</td></tr>
<tr><td><code id="resp_mu_+3A_param">param</code></td>
<td>
<p>which parameters? <code>mu</code>, <code>sigma</code>, <code>nu</code> or  <code>tau</code>, [only for <code>resp_param()</code>].</p>
</td></tr>
<tr><td><code id="resp_mu_+3A_quantile">quantile</code></td>
<td>
<p>which quantile? default the median (0.50), [only for <code>resp_quantile()</code> and <code>quantile_gamlss()</code>].</p>
</td></tr>
<tr><td><code id="resp_mu_+3A_title">title</code></td>
<td>
<p>a tittle if needed it, by default for the function  <code>fitted_resp</code> it print the correlation coefficients  between the two variable.</p>
</td></tr>
<tr><td><code id="resp_mu_+3A_line.col">line.col</code></td>
<td>
<p>the colour of the line</p>
</td></tr>
<tr><td><code id="resp_mu_+3A_point.col">point.col</code></td>
<td>
<p>the colour of the points</p>
</td></tr>
<tr><td><code id="resp_mu_+3A_point.shape">point.shape</code></td>
<td>
<p>the shape of the points</p>
</td></tr>
<tr><td><code id="resp_mu_+3A_newdata">newdata</code></td>
<td>
<p>whether the evaluation should be in newdata or the old data points [only for functions <code>resp_quantile()</code> and <code>quantile_gamlss()</code> ] </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is standard plot in regression where the fitted values are plotted against the response. In GAMLSS model is done by plotting the response against the fitted values of the <code>mu</code> model which is most case is a location parameter. 
</p>


<h3>Value</h3>

<p>A plot is returned
</p>


<h3>Note</h3>

<p>Do not use this plot if <code>mu</code> is not a location parameter. 
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopulos, Rober Rigby and Fernanda de Bastiani 
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+resid_plots">resid_plots</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m1 &lt;- gamlss(R~pb(Fl)+pb(A)+H+loc, data=rent, family=GA )
resp_mu(m1)
resp_param(m1)
resp_quantile(m1)
</code></pre>

<hr>
<h2 id='y_hist'>Histogram and density plot.</h2><span id='topic+y_hist'></span><span id='topic+y_pacf'></span><span id='topic+y_acf'></span><span id='topic+y_dots'></span>

<h3>Description</h3>

<p>The function <code>y_hist()</code> creates a histogram and a density plot for a continuous variable.
</p>
<p>The functions <code>y_acf()</code> and <code>y_pacf()</code> plot the autocorrolation and partial autocorrolation functions  for y.
</p>
<p>The function <code>y_dots()</code> is design for long tail right skewed variables. It is  a plot emphasising  the right tail of the distribution for such variables. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>y_hist(y, data, with.density = TRUE, hist.col = "black",
         hist.fill = "white", dens.fill = "#FF6666", 
         binwidth = (max(y)-min(y))/20,  from, to, title)
         
y_acf(x, data, title)

y_pacf(x, data, title)

y_dots(y, data, value=3, point.size = 2, point.col = "gray", 
          quantile = c(.10, .50, .90),
          line.col = c("black","red", "black"),
          line.type = c("dotted", "solid",  "dotted"),
          line.size = c(1,1,1), x.axis.col = "black", 
          x.axis.line.type = "solid", seed = 123, from, to, title)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="y_hist_+3A_y">y</code>, <code id="y_hist_+3A_x">x</code></td>
<td>
<p>a continuous variable</p>
</td></tr>
<tr><td><code id="y_hist_+3A_data">data</code></td>
<td>
<p>where to find argument y</p>
</td></tr>
<tr><td><code id="y_hist_+3A_value">value</code></td>
<td>
<p>value to identify outliers i.e. for upper tail an outliers is if it is greater than Q_3+value*IQ</p>
</td></tr> 
<tr><td><code id="y_hist_+3A_with.density">with.density</code></td>
<td>
<p>whether a density is required, default is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="y_hist_+3A_hist.col">hist.col</code></td>
<td>
<p>the colour of lines of the histogram</p>
</td></tr>
<tr><td><code id="y_hist_+3A_hist.fill">hist.fill</code></td>
<td>
<p>the colour of the histogram</p>
</td></tr>
<tr><td><code id="y_hist_+3A_dens.fill">dens.fill</code></td>
<td>
<p>the color of the density plot</p>
</td></tr>
<tr><td><code id="y_hist_+3A_binwidth">binwidth</code></td>
<td>
<p>the binwidth for the histogram</p>
</td></tr>
<tr><td><code id="y_hist_+3A_from">from</code></td>
<td>
<p>where to start the histogram (you may have to change 
<code>binwidth</code>)  </p>
</td></tr>
<tr><td><code id="y_hist_+3A_to">to</code></td>
<td>
<p>where to finish the histogram  (you may have to change 
<code>binwidth</code>) </p>
</td></tr>
<tr><td><code id="y_hist_+3A_point.size">point.size</code></td>
<td>
<p>the size of the points in <code>y_dots</code></p>
</td></tr>
<tr><td><code id="y_hist_+3A_point.col">point.col</code></td>
<td>
<p>the colour of the points in <code>y_dots</code></p>
</td></tr>
<tr><td><code id="y_hist_+3A_quantile">quantile</code></td>
<td>
<p>the quantile values to plot in <code>y_dots</code>, the default is  0.10, .50 and .90 </p>
</td></tr>
<tr><td><code id="y_hist_+3A_line.col">line.col</code></td>
<td>
<p>the color of the vertical lines  indicating the 0.10, .50 and .90 quantiles in <code>y_dots</code></p>
</td></tr>
<tr><td><code id="y_hist_+3A_line.type">line.type</code></td>
<td>
<p>the type of the verical lines  indicationg the 0.10, .50 and .90 quantiles in <code>y_dots</code></p>
</td></tr> 
<tr><td><code id="y_hist_+3A_line.size">line.size</code></td>
<td>
<p>the size of the verical lines  indication the 0.10, .50 and .90 quantiles in <code>y_dots</code></p>
</td></tr> 
<tr><td><code id="y_hist_+3A_x.axis.col">x.axis.col</code></td>
<td>
<p>the colour of the x-axis</p>
</td></tr>
<tr><td><code id="y_hist_+3A_x.axis.line.type">x.axis.line.type</code></td>
<td>
<p>the type of the x-axix</p>
</td></tr>
<tr><td><code id="y_hist_+3A_seed">seed</code></td>
<td>
<p>the seed to  jitter  the y</p>
</td></tr>
<tr><td><code id="y_hist_+3A_title">title</code></td>
<td>
<p>use this for a different title</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot is returned
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Bob Rigby and Fernanda De Bastiani</p>


<h3>References</h3>

<p>Rigby, R. A., Stasinopoulos, D. M.,  Heller, G. Z.,  and De Bastiani, F. (2019)
<em>Distributions for modeling location, scale, and shape: Using GAMLSS in R</em>, Chapman and Hall/CRC. An older version can be found in <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>.
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="https://www.jstatsoft.org/v23/i07/">https://www.jstatsoft.org/v23/i07/</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC.  
</p>
<p>Stasinopoulos, M.D., Kneib, T., Klein, N., Mayr, A. and Heller, G.Z., (2024). <em>Generalized Additive Models for Location, Scale and Shape: A Distributional Regression Approach, with Applications</em> (Vol. <b>56</b>). Cambridge University Press.
</p>
<p>(see also <a href="https://www.gamlss.com/">https://www.gamlss.com/</a>).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+plot.ecdf">plot.ecdf</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
y &lt;- rBCT(1000, mu=3, sigma=.1, nu=-1, tau=5)
y_hist(y)
gg &lt;- y_hist(y, with.dens=FALSE)
gg + stat_function(fun = dBCT, args=list(mu=3, sigma=.1,  nu=-1, tau=5), 
                 colour = "black")
gg + stat_function(fun = dBCT, args=list(mu=3, sigma=.1,  nu=-1, tau=5), 
                  geom = "area", alpha=0.5, fill="pink", color="black", n=301)
                  
y_acf(diff(EuStockMarkets[,1]))    

y_dots(rent$R)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
