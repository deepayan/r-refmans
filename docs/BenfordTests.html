<!DOCTYPE html><html><head><title>Help for package BenfordTests</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BenfordTests}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BenfordTests-package'><p>Statistical Tests for Benford's Law</p></a></li>
<li><a href='#chisq.benftest'><p>Pearson's Chi-squared Goodness-of-Fit Test for Benford's Law</p></a></li>
<li><a href='#edist.benftest'><p>Euclidean Distance Test for Benford's Law</p></a></li>
<li><a href='#jointdigit.benftest'>
<p>A Hotelling <em>T-square</em> Type Test for Benford's Law</p></a></li>
<li><a href='#jpsq.benftest'>
<p>Joenssen's <em>JP-square</em> Test for Benford's Law</p></a></li>
<li><a href='#ks.benftest'>
<p>Kolmogorov-Smirnov Test for Benford's Law</p></a></li>
<li><a href='#mdist.benftest'>
<p>Chebyshev Distance Test (maximum norm) for Benford's Law</p></a></li>
<li><a href='#meandigit.benftest'>
<p>Judge-Schechter Mean Deviation Test for Benford's Law</p></a></li>
<li><a href='#pbenf'>
<p>Probability Mass Function for Benford's Distribution</p></a></li>
<li><a href='#qbenf'>
<p>Quantile Function for Benford's Distribution</p></a></li>
<li><a href='#rbenf'>
<p>Random Sample Satisfying Benford's Law</p></a></li>
<li><a href='#signifd'>
<p>First Digits Function</p></a></li>
<li><a href='#signifd.analysis'>
<p>Graphical Analysis of First Significant Digits</p></a></li>
<li><a href='#signifd.seq'>
<p>Sequence of Possible Leading Digits</p></a></li>
<li><a href='#simulateH0'>
<p>Function for Simulating the H0-Distributions needed for BenfordTests</p></a></li>
<li><a href='#usq.benftest'>
<p>Freedman-Watson U-square Test for Benford's Law</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Tests for Evaluating Conformity to Benford's Law</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-08-04</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), grDevices, graphics, stats</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dieter William Joenssen &lt;Dieter.Joenssen@googlemail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Several specialized statistical tests and support functions 
			for determining if numerical data could conform to Benford's law.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cran.r-project.org/package=BenfordTests">https://cran.r-project.org/package=BenfordTests</a>,
<a href="https://www.researchgate.net/profile/Dieter_Joenssen">https://www.researchgate.net/profile/Dieter_Joenssen</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-08-04 15:24:52 UTC; Dieter</td>
</tr>
<tr>
<td>Author:</td>
<td>Dieter William Joenssen [aut, cre, cph],
  Thomas Muellerleile [ctb]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-08-04 18:25:11</td>
</tr>
</table>
<hr>
<h2 id='BenfordTests-package'>Statistical Tests for Benford's Law</h2><span id='topic+BenfordTests-package'></span><span id='topic+BenfordTests'></span>

<h3>Description</h3>

<p>This package contains several specialized statistical tests and support functions
for determining if numerical data could conform to Benford's law.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> BenfordTests</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-07-18</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><code>BenfordTests</code> is the implementation of eight goodness-of-fit (GOF) tests to assess if data conforms to Benford's law.
<br />
Tests include:<br />
Pearson <code class="reqn">\chi^2</code> statistic (Pearson, 1900)<br />
Kolmogorov-Smirnov <em>D</em> statistic (Kolmogorov, 1933)<br />
Freedman's modification of Watson's <code class="reqn">U^2</code> statistic (Freedman, 1981; Watson, 1961)<br />
Chebyshev distance <em>m</em> statistic (Leemis, 2000)<br />
Euclidean distance <em>d</em> statistic (Cho and Gaines, 2007)<br />
Judge-Schechter mean deviation <code class="reqn">a^*</code> statistic (Judge and Schechter, 2009)<br />
Joenssen's <code class="reqn">J_P^2</code> statistic, a Shapiro-Francia type correlation test (Shapiro and Francia, 1972)<br />
Joint Digit Test <code class="reqn">T^2</code> statistic, a Hotelling type test (Hotelling, 1931)<br />
<br />
All tests may be performed using more than one leading digit.
All tests simulate the specific p-values required for statistical inference, while p-values for the <code class="reqn">\chi^2</code>, <em>D</em>, <code class="reqn">a^*</code>, and <code class="reqn">T^2</code> statistics may also be determined using their asymptotic distributions.
</p>


<h3>Author(s)</h3>

<p>Dieter William Joenssen
</p>
<p>Maintainer: Dieter William Joenssen &lt;Dieter.Joenssen@googlemail.com&gt;
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Cho, W.K.T. and Gaines, B.J. (2007) Breaking the (Benford) Law: Statistical Fraud Detection in Campaign Finance. <em>The American Statistician</em>. <b>61</b>, 218&ndash;223.
</p>
<p>Freedman, L.S. (1981) Watson's Un2 Statistic for a Discrete Distribution. <em>Biometrika</em>. <b>68</b>, 708&ndash;711.
</p>
<p>Joenssen, D.W. (2013) Two Digit Testing for Benford's Law. <em>Proceedings of the ISI World Statistics Congress, 59th Session in Hong Kong</em>. [available under <a href="http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf">http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf</a>]
</p>
<p>Judge, G. and Schechter, L. (2009) Detecting Problems in Survey Data using Benford's Law. <em>Journal of Human Resources</em>. <b>44</b>, 1&ndash;24.
</p>
<p>Kolmogorov, A.N. (1933) Sulla determinazione empirica di una legge di distibuzione. <em>Giornale dell'Istituto Italiano degli Attuari</em>. <b>4</b>, 83&ndash;91.
</p>
<p>Leemis, L.M., Schmeiser, B.W. and Evans, D.L. (2000) Survival Distributions Satisfying Benford's law. <em>The American Statistician</em>. <b>54</b>, 236&ndash;241.
</p>
<p>Newcomb, S. (1881) Note on the Frequency of Use of the Different Digits in Natural Numbers. <em>American Journal of Mathematics</em>. <b>4</b>, 39&ndash;40.
</p>
<p>Pearson, K. (1900) On the Criterion that a Given System of Deviations from the Probable in the Case of a Correlated System of Variables is Such that it can be Reasonably Supposed to have Arisen from Random Sampling. <em>Philosophical Magazine Series 5</em>. <b>50</b>, 157&ndash;175.
</p>
<p>Shapiro, S.S. and Francia, R.S. (1972) An Approximate Analysis of Variance Test for Normality. <em>Journal of the American Statistical Association</em>. <b>67</b>, 215&ndash;216.
</p>
<p>Watson, G.S. (1961) Goodness-of-Fit Tests on a Circle. <em>Biometrika</em>. <b>48</b>, 109&ndash;114.
</p>
<p>Hotelling, H. (1931). The generalization of Student's ratio. <em>Annals of Mathematical Statistics</em>. <b>2</b>, 360&ndash;378.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Look at sample
X
#Look at the first digits of the sample
signifd(X)

#Perform a Chi-squared Test on the sample's first digits using defaults
chisq.benftest(X)
#p-value = 0.648
</code></pre>

<hr>
<h2 id='chisq.benftest'>Pearson's Chi-squared Goodness-of-Fit Test for Benford's Law</h2><span id='topic+chisq.benftest'></span>

<h3>Description</h3>

<p><code>chisq.benftest</code> takes any numerical vector reduces the sample to the specified number of significant digits and performs Pearson's chi-square goodness-of-fit test to assert if the data conforms to Benford's law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq.benftest(x = NULL, digits = 1, pvalmethod = "asymptotic", pvalsims = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chisq.benftest_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="chisq.benftest_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="chisq.benftest_+3A_pvalmethod">pvalmethod</code></td>
<td>
<p>Method used for calculating the p-value. Either <code>"asymptotic"</code> or <code>"simulate"</code>.</p>
</td></tr>
<tr><td><code id="chisq.benftest_+3A_pvalsims">pvalsims</code></td>
<td>
<p>An integer specifying the number of replicates to use if <code>pvalmethod</code> = &quot;simulate&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code class="reqn">\chi^2</code> goodness-of-fit test is performed on <code>signifd(x,digits)</code> versus <code>pbenf(digits)</code>.
Specifically: </p>
<p style="text-align: center;"><code class="reqn">\chi^2 = n\cdot\displaystyle\sum_{i=10^{k-1}}^{10^k-1}\frac{\left(f_i^o - f_i^e\right)^2}{f_i^e}</code>
</p>

<p>where <code class="reqn">f_i^o</code> denotes the observed frequency of digits <code class="reqn">i</code>, and <code class="reqn">f_i^e</code> denotes the expected frequency of digits <code class="reqn">i</code>.
<code>x</code> is a numeric vector of arbitrary length.
Values of <code>x</code> should be continuous, as dictated by theory, but may also be integers.
<code>digits</code> should be chosen so that <code>signifd(x,digits)</code> is not influenced by previous rounding.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the <code class="reqn">\chi^2</code> test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the type of test performed</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the name of the data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Joenssen, D.W. (2013) Two Digit Testing for Benford's Law. <em>Proceedings of the ISI World Statistics Congress, 59th Session in Hong Kong</em>. [available under <a href="http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf">http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf</a>]
</p>
<p>Pearson, K. (1900) On the Criterion that a Given System of Deviations from the Probable in the Case of a Correlated System of Variables is Such that it can be Reasonably Supposed to have Arisen from Random Sampling. <em>Philosophical Magazine Series 5</em>. <b>50</b>, 157&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>, <code><a href="#topic+simulateH0">simulateH0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Perform a Chi-squared Test on the sample's 
#first digits using defaults but determine
#the p-value by simulation
chisq.benftest(X,pvalmethod ="simulate")
#p-value = 0.6401
</code></pre>

<hr>
<h2 id='edist.benftest'>Euclidean Distance Test for Benford's Law</h2><span id='topic+edist.benftest'></span>

<h3>Description</h3>

<p><code>edist.benftest</code> takes any numerical vector reduces the sample to the specified number of significant digits and performs a goodness-of-fit test based on the Euclidean distance between the first digits' distribution and Benford's distribution to assert if the data conforms to Benford's law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>edist.benftest(x = NULL, digits = 1, pvalmethod = "simulate", pvalsims = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="edist.benftest_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="edist.benftest_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="edist.benftest_+3A_pvalmethod">pvalmethod</code></td>
<td>
<p>Method used for calculating the p-value. Currently only <code>"simulate"</code> is available.</p>
</td></tr>
<tr><td><code id="edist.benftest_+3A_pvalsims">pvalsims</code></td>
<td>
<p>An integer specifying the number of replicates used if <code>pvalmethod = "simulate"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A statistical test is performed utilizing the Euclidean distance between <code>signifd(x,digits)</code> and <code>pbenf(digits)</code>.
Specifically: </p>
<p style="text-align: center;"><code class="reqn">d = \sqrt{n}\cdot \sqrt{\displaystyle\sum_{i=10^{k-1}}^{10^k-1}\left(f_i^o - f_i^e\right)^2}</code>
</p>

<p>where <code class="reqn">f_i^o</code> denotes the observed frequency of digits <code class="reqn">i</code>, and <code class="reqn">f_i^e</code> denotes the expected frequency of digits <code class="reqn">i</code>.
<code>x</code> is a numeric vector of arbitrary length.
Values of <code>x</code> should be continuous, as dictated by theory, but may also be integers.
<code>digits</code> should be chosen so that <code>signifd(x,digits)</code> is not influenced by previous rounding.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the Euclidean distance test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the type of test performed</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> a character string giving the name of the data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Cho, W.K.T. and Gaines, B.J. (2007) Breaking the (Benford) Law: Statistical Fraud Detection in Campaign Finance. <em>The American Statistician</em>. <b>61</b>, 218&ndash;223.
</p>
<p>Morrow, J. (2010) <em>Benford's Law, Families of Distributions and a Test Basis</em>. [available under <a href="http://www.johnmorrow.info/projects/benford/benfordMain.pdf">http://www.johnmorrow.info/projects/benford/benfordMain.pdf</a>]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>, <code><a href="#topic+simulateH0">simulateH0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Perform a Euclidean Distance Test on the
#sample's first digits using defaults
edist.benftest(X,pvalmethod ="simulate")
#p-value = 0.6085
</code></pre>

<hr>
<h2 id='jointdigit.benftest'>
A Hotelling <em>T-square</em> Type Test for Benford's Law
</h2><span id='topic+jointdigit.benftest'></span>

<h3>Description</h3>

<p><code>jointdigit.benftest</code> takes any numerical vector reduces the sample to the specified number of significant digits and performs a Hotelling T-square type goodness-of-fit test to assert if the data conforms to Benford's law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jointdigit.benftest(x = NULL, digits = 1, eigenvalues="all", tol = 1e-15, 
					pvalmethod = "asymptotic", pvalsims = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jointdigit.benftest_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="jointdigit.benftest_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="jointdigit.benftest_+3A_eigenvalues">eigenvalues</code></td>
<td>
<p>How are the eigenvalues, which are used in testing, selected.</p>
</td></tr>
<tr><td><code id="jointdigit.benftest_+3A_tol">tol</code></td>
<td>
<p>Tolerance in detecting values that are essentially zero.</p>
</td></tr>
<tr><td><code id="jointdigit.benftest_+3A_pvalmethod">pvalmethod</code></td>
<td>
<p>Method used for calculating the p-value. Currently only <code>"asymptotic"</code> is available.</p>
</td></tr>
<tr><td><code id="jointdigit.benftest_+3A_pvalsims">pvalsims</code></td>
<td>
<p>An integer specifying the number of replicates used if <code>pvalmethod = "simulate"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A Hotelling <code class="reqn">T^2</code> type goodness-of-fit test is performed on <code>signifd(x,digits)</code> versus <code>pbenf(digits)</code>.
<code>x</code> is a numeric vector of arbitrary length.
<strong>argument:</strong> <code>eigenvalues</code> can be defined as:
</p>

<ul>
<li> <p><em>numeric</em>, a vector containing which eigenvalues should be used
</p>
</li>
<li> <p><em>string length = 1</em>, eigenvalue selection scheme:
</p>

<ul>
<li> <p><em>&quot;all&quot;</em>, use all non-zero eigenvalues
</p>
</li>
<li> <p><em>&quot;kaiser&quot;</em>, use all eigenvalues larger than the mean of all non-zero eigenvalues
</p>
</li></ul>

</li></ul>

<p>Values of <code>x</code> should be continuous, as dictated by theory, but may also be integers.
<code>digits</code> should be chosen so that <code>signifd(x,digits)</code> is not influenced by previous rounding.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the <code class="reqn">T^2</code> test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the type of test performed</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> a character string giving the name of the data</p>
</td></tr>
<tr><td><code>eigenvalues_tested</code></td>
<td>
<p> a vector containing the index numbers of the eigenvalues used in testing.</p>
</td></tr>
<tr><td><code>eigen_val_vect</code></td>
<td>
<p> the eigen values and vectors of the null distribution. computed using <code>eigen</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Hotelling, H. (1931). The generalization of Student's ratio. <em>Annals of Mathematical Statistics</em>. <b>2</b>, 360&ndash;378.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Perform  Test
#on the sample's first digits using defaults
jointdigit.benftest(X)
#p-value = 0.648
#Perform  Test
#using only the two largest eigenvalues
jointdigit.benftest(x=X,eigenvalues=1:2)
#p-value = 0.5176
#Perform  Test
#using the kaiser selection criterion
jointdigit.benftest(x=X,eigenvalues="kaiser")
#p-value = 0.682
</code></pre>

<hr>
<h2 id='jpsq.benftest'>
Joenssen's <em>JP-square</em> Test for Benford's Law
</h2><span id='topic+jpsq.benftest'></span>

<h3>Description</h3>

<p><code>jpsq.benftest</code> takes any numerical vector reduces the sample to the specified number of significant digits and performs a goodness-of-fit test based on the correlation between the first digits' distribution and Benford's distribution to assert if the data conforms to Benford's law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jpsq.benftest(x = NULL, digits = 1, pvalmethod = "simulate", pvalsims = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jpsq.benftest_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="jpsq.benftest_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="jpsq.benftest_+3A_pvalmethod">pvalmethod</code></td>
<td>
<p>Method used for calculating the p-value. Currently only <code>"simulate"</code> is available.</p>
</td></tr>
<tr><td><code id="jpsq.benftest_+3A_pvalsims">pvalsims</code></td>
<td>
<p>An integer specifying the number of replicates used if <code>pvalmethod = "simulate"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A statistical test is performed utilizing the sign-preserved squared correlation between <br /><code>signifd(x,digits)</code> and <code>pbenf(digits)</code>.
Specifically: </p>
<p style="text-align: center;"><code class="reqn">J_P^2=sgn\left(cor\left(f^o, f^e\right)\right)\cdot cor\left(f^o, f^e\right) ^2</code>
</p>

<p>where <code class="reqn">f^o</code> denotes the observed frequencies and <code class="reqn">f^e</code> denotes the expected frequency of digits <br /> <code class="reqn">10^{k-1},10^{k-1}+1,\ldots,10^k-1</code>.
<code>x</code> is a numeric vector of arbitrary length.
Values of <code>x</code> should be continuous, as dictated by theory, but may also be integers.
<code>digits</code> should be chosen so that <code>signifd(x,digits)</code> is not influenced by previous rounding.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the <code class="reqn">J_P^2</code> test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the type of test performed</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> a character string giving the name of the data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Joenssen, D.W. (2013) A New Test for Benford's Distribution. In: <em>Abstract-Proceedings of the 3rd Joint Statistical Meeting DAGStat, March 18-22, 2013</em>; Freiburg, Germany.
</p>
<p>Joenssen, D.W. (2013) Two Digit Testing for Benford's Law. <em>Proceedings of the ISI World Statistics Congress, 59th Session in Hong Kong</em>. [available under <a href="http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf">http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf</a>]
</p>
<p>Shapiro, S.S. and Francia, R.S. (1972) An Approximate Analysis of Variance Test for Normality. <em>Journal of the American Statistical Association</em>. <b>67</b>, 215&ndash;216.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>, <code><a href="#topic+simulateH0">simulateH0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Perform Joenssen's \emph{JP-square} Test
#on the sample's first digits using defaults
jpsq.benftest(X)
#p-value = 0.3241
</code></pre>

<hr>
<h2 id='ks.benftest'>
Kolmogorov-Smirnov Test for Benford's Law
</h2><span id='topic+ks.benftest'></span>

<h3>Description</h3>

<p><code>ks.benftest</code> takes any numerical vector reduces the sample to the specified number of significant digits and performs the Kolmogorov-Smirnov goodness-of-fit test to assert if the data conforms to Benford's law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ks.benftest(x = NULL, digits = 1, pvalmethod = "simulate", pvalsims = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ks.benftest_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="ks.benftest_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="ks.benftest_+3A_pvalmethod">pvalmethod</code></td>
<td>
<p>Method used for calculating the p-value. Currently only <code>"simulate"</code> is available.</p>
</td></tr>
<tr><td><code id="ks.benftest_+3A_pvalsims">pvalsims</code></td>
<td>
<p>An integer specifying the number of replicates used if <code>pvalmethod = "simulate"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A Kolmogorov-Smirnov test is performed between <code>signifd(x,digits)</code> and <code>pbenf(digits)</code>.
Specifically: </p>
<p style="text-align: center;"><code class="reqn">D = \sup\limits_{i=10^{k-1},\ldots,10^k-1} \left| \displaystyle\sum_{j=1}^{i} ( f_j^o - f_j^e ) \right|\cdot \sqrt{n}</code>
</p>

<p>where <code class="reqn">f_i^o</code> denotes the observed frequency of digits <code class="reqn">i</code>, and <code class="reqn">f_i^e</code> denotes the expected frequency of digits <code class="reqn">i</code>.
<code>x</code> is a numeric vector of arbitrary length. Values of <code>x</code> should be continuous, as dictated by theory, but may also be integers.
<code>digits</code> should be chosen so that <code>signifd(x,digits)</code> is not influenced by previous rounding.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the Kolmogorov-Smirnov <em>D</em> test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the type of test performed</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> a character string giving the name of the data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Joenssen, D.W. (2013) Two Digit Testing for Benford's Law. <em>Proceedings of the ISI World Statistics Congress, 59th Session in Hong Kong</em>. [available under <a href="http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf">http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf</a>]
</p>
<p>Kolmogorov, A.N. (1933) Sulla determinazione empirica di una legge di distibuzione. <em>Giornale dell'Istituto Italiano degli Attuari</em>. <b>4</b>, 83&ndash;91.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>, <code><a href="#topic+simulateH0">simulateH0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Perform a Kolmogorov-Smirnov Test on the
#sample's first digits using defaults
ks.benftest(X)
#0.7483
</code></pre>

<hr>
<h2 id='mdist.benftest'>
Chebyshev Distance Test (maximum norm) for Benford's Law
</h2><span id='topic+mdist.benftest'></span>

<h3>Description</h3>

<p><code>mdist.benftest</code> takes any numerical vector reduces the sample to the specified number of significant digits and performs a goodness-of-fit test based on the Chebyshev distance between the first digits' distribution and Benford's distribution to assert if the data conforms to Benford's law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mdist.benftest(x = NULL, digits = 1, pvalmethod = "simulate", pvalsims = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mdist.benftest_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="mdist.benftest_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="mdist.benftest_+3A_pvalmethod">pvalmethod</code></td>
<td>
<p>Method used for calculating the p-value. Currently only <code>"simulate"</code> is available.</p>
</td></tr>
<tr><td><code id="mdist.benftest_+3A_pvalsims">pvalsims</code></td>
<td>
<p>An integer specifying the number of replicates used if <code>pvalmethod = "simulate"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A statistical test is performed utilizing the Chebyshev distance between <code>signifd(x,digits)</code> and <code>pbenf(digits)</code>.
Specifically: </p>
<p style="text-align: center;"><code class="reqn">m = \max\limits_{i=10^{k-1},\ldots,10^k-1}\left|f_i^o - f_i^e\right|\cdot\sqrt{n}</code>
</p>

<p>where <code class="reqn">f_i^o</code> denotes the observed frequency of digits <code class="reqn">i</code>, and <code class="reqn">f_i^e</code> denotes the expected frequency of digits <code class="reqn">i</code>.
<code>x</code> is a numeric vector of arbitrary length.
Values of <code>x</code> should be continuous, as dictated by theory, but may also be integers.
<code>digits</code> should be chosen so that <code>signifd(x,digits)</code> is not influenced by previous rounding.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the Chebyshev distance (maximum norm) test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the type of test performed</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> a character string giving the name of the data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Leemis, L.M., Schmeiser, B.W. and Evans, D.L. (2000) Survival Distributions Satisfying Benford's law. <em>The American Statistician</em>. <b>54</b>, 236&ndash;241.
</p>
<p>Morrow, J. (2010) <em>Benford's Law, Families of Distributions and a Test Basis</em>. [available under <a href="http://www.johnmorrow.info/projects/benford/benfordMain.pdf">http://www.johnmorrow.info/projects/benford/benfordMain.pdf</a>]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>, <code><a href="#topic+simulateH0">simulateH0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Perform a Chebyshev Distance Test on the
#sample's first digits using defaults
mdist.benftest(X)
#p-value = 0.6421
</code></pre>

<hr>
<h2 id='meandigit.benftest'>
Judge-Schechter Mean Deviation Test for Benford's Law
</h2><span id='topic+meandigit.benftest'></span>

<h3>Description</h3>

<p><code>meandigit.benftest</code> takes any numerical vector reduces the sample to the specified number of significant digits and performs a goodness-of-fit test based on the deviation in means of the first digits' distribution and Benford's distribution to assert if the data conforms to Benford's law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meandigit.benftest(x = NULL, digits = 1, pvalmethod = "asymptotic", pvalsims = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meandigit.benftest_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="meandigit.benftest_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="meandigit.benftest_+3A_pvalmethod">pvalmethod</code></td>
<td>
<p>Method used for calculating the p-value. Either <code>"asymptotic"</code> or <code>"simulate"</code>.</p>
</td></tr>
<tr><td><code id="meandigit.benftest_+3A_pvalsims">pvalsims</code></td>
<td>
<p>An integer specifying the number of replicates used if <code>pvalmethod = "simulate"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A statistical test is performed utilizing the deviation between the mean digit of <code>signifd(x,digits)</code> and <code>pbenf(digits)</code>.
Specifically:</p>
<p style="text-align: center;"><code class="reqn">a^*=\frac{|\mu_k^o-\mu_k^e|}{\left(9\cdot10^{k-1}\right)-\mu_k^e}</code>
</p>

<p>where <code class="reqn">\mu_k^o</code> is the observed mean of the chosen <code class="reqn">k</code> number of digits, and <code class="reqn">\mu_k^e</code> is the expected/true mean value for Benford's predictions.
<code class="reqn">a^*</code> conforms asymptotically to a truncated normal distribution under the null-hypothesis, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">a^*\sim  truncnorm\left(\mu=0,\sigma=\sigma_B,a=0,b=\infty\right)</code>
</p>

<p><code>x</code> is a numeric vector of arbitrary length.
Values of <code>x</code> should be continuous, as dictated by theory, but may also be integers.
<code>digits</code> should be chosen so that <code>signifd(x,digits)</code> is not influenced by previous rounding.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the <code class="reqn">a^*</code> test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the type of test performed</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> a character string giving the name of the data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Judge, G. and Schechter, L. (2009) Detecting Problems in Survey Data using Benford's Law. <em>Journal of Human Resources</em>. <b>44</b>, 1&ndash;24.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>, <code><a href="#topic+simulateH0">simulateH0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Perform a Judge-Schechter Mean Deviation Test
#on the sample's first digits using defaults
meandigit.benftest(X)
#p-value = 0.1458
</code></pre>

<hr>
<h2 id='pbenf'>
Probability Mass Function for Benford's Distribution
</h2><span id='topic+pbenf'></span>

<h3>Description</h3>

<p>Returns the complete probability mass function for Benford's distribution for a given number of first digits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pbenf(digits = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pbenf_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits for which the pdf is returned, i.e. 1 for 1:9, 2 for 10:99 etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Benford's distribution has the following probability mass function:
</p>
<p style="text-align: center;"><code class="reqn">P(d_k)=log_{10}\left(1+ d_k^{-1} \right)</code>
</p>

<p>where <code class="reqn">d_k \in \left( 10^{k-1},10^{k-1}+1, \ldots, 10^k-1 \right) </code> for any chosen <code class="reqn">k</code> number of digits.
</p>


<h3>Value</h3>

<p>Returns an object of class &quot;<code>table</code>&quot; containing the expected density of Benford's distribution for the given number of digits.
</p>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Joenssen, D.W. (2013) Two Digit Testing for Benford's Law. <em>Proceedings of the ISI World Statistics Congress, 59th Session in Hong Kong</em>. [available under <a href="http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf">http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf</a>]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qbenf">qbenf</a></code>; <code><a href="#topic+rbenf">rbenf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#show Benford's predictions for the frequencies of the first digit values
pbenf(1)
</code></pre>

<hr>
<h2 id='qbenf'>
Quantile Function for Benford's Distribution
</h2><span id='topic+qbenf'></span>

<h3>Description</h3>

<p>Returns the complete quantile function for Benford's distribution with a given number of first digits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qbenf(digits = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qbenf_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits for which the qdf is returned, i.e. 1 for 1:9, 2 for 10:99 etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class &quot;<code>table</code>&quot; containing the expected quantile function of Benford's distribution with a given number of digits.
</p>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>; <code><a href="#topic+rbenf">rbenf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>qbenf(1)

qbenf(1)==cumsum(pbenf(1))
</code></pre>

<hr>
<h2 id='rbenf'>
Random Sample Satisfying Benford's Law
</h2><span id='topic+rbenf'></span>

<h3>Description</h3>

<p>Returns a random sample with length <code>n</code> satisfying Benford's law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbenf(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rbenf_+3A_n">n</code></td>
<td>
<p>Number of observations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This distribution has the density:
</p>
<p style="text-align: center;"><code class="reqn">f\left(x\right)=\frac{1}{x\cdot ln\left(10\right)} \forall x\in[1,10]</code>
</p>


<h3>Value</h3>

<p>Returns a random sample with length <code>n</code> satisfying Benford's law.
</p>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qbenf">qbenf</a></code>; <code><a href="#topic+pbenf">pbenf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Look at sample
X
#should be
# [1] 6.159420 1.396476 5.193371 2.064033 7.001284 5.006184
#7.950332 4.822725 3.386809 1.619609 2.080063 2.242473 1.944697 5.460581
#[15] 6.443031 2.662821 2.079283 3.703353 1.364175 3.354136
</code></pre>

<hr>
<h2 id='signifd'>
First Digits Function
</h2><span id='topic+signifd'></span>

<h3>Description</h3>

<p>Applies the first digits function to each element of a given vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signifd(x = NULL, digits = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="signifd_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="signifd_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first digits function can be written as:
</p>
<p style="text-align: center;"><code class="reqn">D_k(x) = \lfloor |x| \cdot 10^{\left( -1 \cdot \lfloor log_{10}|x| \rfloor + k -1 \right)}\rfloor</code>
</p>

<p>with <code class="reqn">k</code> being the number of first digits that should be extracted.
<code>x</code> is a numeric vector of arbitrary length.
Unlike other solutions, this function will work reliably with all real numbers.
</p>


<h3>Value</h3>

<p>Returns a vector of integers the same length as the input vector <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Joenssen, D.W. (2013) Two Digit Testing for Benford's Law. <em>Proceedings of the ISI World Statistics Congress, 59th Session in Hong Kong</em>. [available under <a href="http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf">http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf</a>]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chisq.benftest">chisq.benftest</a></code>; <code><a href="#topic+ks.benftest">ks.benftest</a></code>; <code><a href="#topic+usq.benftest">usq.benftest</a></code>; <code><a href="#topic+mdist.benftest">mdist.benftest</a></code>; <code><a href="#topic+edist.benftest">edist.benftest</a></code>; <code><a href="#topic+meandigit.benftest">meandigit.benftest</a></code>; <code><a href="#topic+jpsq.benftest">jpsq.benftest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Look at the first digits of the sample
signifd(X)
#should be:
#[1] 6 1 5 2 7 5 7 4 3 1 2 2 1 5 6 2 2 3 1 3
</code></pre>

<hr>
<h2 id='signifd.analysis'>
Graphical Analysis of First Significant Digits
</h2><span id='topic+signifd.analysis'></span>

<h3>Description</h3>

<p><code>signifd.analysis</code> takes any numerical vector reduces the sample to the specified number of significant digits. The (relative) frequencies are then plotted so that a subjective analysis may be performed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signifd.analysis(x = NULL, digits = 1, graphical_analysis = TRUE, freq = FALSE, 
alphas = 20, tick_col = "red", ci_col = "darkgreen", ci_lines = c(.05))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="signifd.analysis_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="signifd.analysis_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="signifd.analysis_+3A_graphical_analysis">graphical_analysis</code></td>
<td>
<p>Boolean value indicating if results should be plotted.</p>
</td></tr>
<tr><td><code id="signifd.analysis_+3A_freq">freq</code></td>
<td>
<p>Boolean value indicating if absolute frequencies should be used.</p>
</td></tr>
<tr><td><code id="signifd.analysis_+3A_alphas">alphas</code></td>
<td>
<p>Either a vector containing the significance levels([0,1]) that will be shaded, or an integer defining the number of evenly spaced confidence intervals.</p>
</td></tr>
<tr><td><code id="signifd.analysis_+3A_tick_col">tick_col</code></td>
<td>
<p>Color code or name that will be passed to &quot;<code>points</code>&quot; for plotting.</p>
</td></tr>
<tr><td><code id="signifd.analysis_+3A_ci_col">ci_col</code></td>
<td>
<p>Color code or name that will be passed to &quot;<code>polygon</code>&quot; for shading the different confidence intervals. May be more than one color.</p>
</td></tr>
<tr><td><code id="signifd.analysis_+3A_ci_lines">ci_lines</code></td>
<td>
<p>Boolean or fractional value(s) indicating significance levels where lines are drawn</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals are calculated from the normal distribution with <code class="reqn">\mu_i = np_i</code> and <code class="reqn">\sigma^2 = np_i(1-p_i)</code>, where i represents the considered digit. Be aware that the normal approximation only holds for &quot;large&quot; n.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>summary</code></td>
<td>
<p>the summary printed below the graph, a matrix of digits, their (relative) frequencies and individual p-values</p>
</td></tr>
<tr><td><code>CIs</code></td>
<td>
<p>confidence intervals used for plotting as defined by parameter &quot;<code>ci_lines</code>&quot; or &quot;<code>alphas</code>&quot; if <code>ci_lines==FALSE</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Freedman, L.S. (1981) Watson's Un2 Statistic for a Discrete Distribution. <em>Biometrika</em>. <b>68</b>, 708&ndash;711.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Analyze the first digits using the the defaults
signifd.analysis(X)
#Turn off plot
signifd.analysis(X,graphical_analysis=FALSE)
#Use absolute frequencies
signifd.analysis(X,graphical_analysis=FALSE,freq=TRUE)
#Use five evenly spaced confidence intervals, no lines
#alphas is used for shadeing
signifd.analysis(X,graphical_analysis=TRUE,alphas=5,freq=TRUE,ci_lines=FALSE)
#Use fifty evenly spaced, gray confidence intervals, blue ticks, and lines at 
#the 1 and 5 percent confidence intervals
signifd.analysis(X,graphical_analysis=TRUE,alphas=50,freq=TRUE,tick_col="blue",
ci_col="gray",ci_lines=c(.01,.05))
</code></pre>

<hr>
<h2 id='signifd.seq'>
Sequence of Possible Leading Digits
</h2><span id='topic+signifd.seq'></span>

<h3>Description</h3>

<p>Returns a vector containing all possible significant digits for a given number of places.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signifd.seq(digits = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="signifd.seq_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to be returned, i.e. 1 for 1:9, 2 for 10:99 etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an integer vector.
</p>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>signifd.seq(1)
seq(from=1,to=9)==signifd.seq(1)

signifd.seq(2)
seq(from=10,to=99)==signifd.seq(2)

</code></pre>

<hr>
<h2 id='simulateH0'>
Function for Simulating the H0-Distributions needed for BenfordTests
</h2><span id='topic+simulateH0'></span>

<h3>Description</h3>

<p><code>simulateH0</code> is a wrapper function that calculates the specified test statistic under the null hypothesis a certain number of times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulateH0(teststatistic="chisq", n=10, digits=1, pvalsims=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulateH0_+3A_teststatistic">teststatistic</code></td>
<td>
<p>Which test statistic should be used: &quot;chisq&quot;, &quot;edist&quot;, &quot;jpsq&quot;, &quot;ks&quot;, &quot;mdist&quot;, &quot;meandigit&quot;, or &quot;usq&quot;.</p>
</td></tr>
<tr><td><code id="simulateH0_+3A_n">n</code></td>
<td>
<p>Sample size of interest.</p>
</td></tr>
<tr><td><code id="simulateH0_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="simulateH0_+3A_pvalsims">pvalsims</code></td>
<td>
<p>An integer specifying the number of replicates to be used in simulation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wrapper function that directly outputs the distributions of the specified test statistic under the null hypothesis. 
</p>


<h3>Value</h3>

<p>A vector of length equal to &quot;<code>pvalsims</code>&quot;.
</p>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Joenssen, D.W. (2013) Two Digit Testing for Benford's Law. <em>Proceedings of the ISI World Statistics Congress, 59th Session in Hong Kong</em>. [available under <a href="http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf">http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf</a>]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>, <code><a href="#topic+chisq.benftest">chisq.benftest</a></code>, <code><a href="#topic+edist.benftest">edist.benftest</a></code>, <code><a href="#topic+jpsq.benftest">jpsq.benftest</a></code>, <code><a href="#topic+ks.benftest">ks.benftest</a></code>, <code><a href="#topic+mdist.benftest">mdist.benftest</a></code>, \ <code><a href="#topic+meandigit.benftest">meandigit.benftest</a></code>, <code><a href="#topic+usq.benftest">usq.benftest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)

#calculate critical value for chisquare test via simulation
quantile(simulateH0(teststatistic="chisq", n=100,digits=1,pvalsims=100000),probs=.95)

#calculate the "real" critical value
qchisq(.95,df=8)

#alternatively look at critical values for the jpsq statistic
#for different sample sizes (notice the low value for pvalsims)
set.seed(421)
apply(sapply((1:9)*10,FUN=simulateH0,teststatistic="jpsq", digits=1, pvalsims=100),
MARGIN=2,FUN=quantile,probs=.05)
</code></pre>

<hr>
<h2 id='usq.benftest'>
Freedman-Watson U-square Test for Benford's Law
</h2><span id='topic+usq.benftest'></span>

<h3>Description</h3>

<p><code>usq.benftest</code> takes any numerical vector reduces the sample to the specified number of significant digits and performs the Freedman-Watson test for discreet distributions between the first digits' distribution and Benford's distribution to assert if the data conforms to Benford's law.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>usq.benftest(x = NULL, digits = 1, pvalmethod = "simulate", pvalsims = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="usq.benftest_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="usq.benftest_+3A_digits">digits</code></td>
<td>
<p>An integer determining the number of first digits to use for testing, i.e. 1 for only the first, 2 for the first two etc.</p>
</td></tr>
<tr><td><code id="usq.benftest_+3A_pvalmethod">pvalmethod</code></td>
<td>
<p>Method used for calculating the p-value. Currently only <code>"simulate"</code> is available.</p>
</td></tr>
<tr><td><code id="usq.benftest_+3A_pvalsims">pvalsims</code></td>
<td>
<p>An integer specifying the number of replicates used if <code>pvalmethod = "simulate"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A Freedman-Watson test for discreet distributions is performed between <code>signifd(x,digits)</code> and <code>pbenf(digits)</code>.
Specifically:</p>
<p style="text-align: center;"><code class="reqn">U^2 = \frac{n}{9\cdot 10^{k-1}}\cdot\left[ \displaystyle\sum_{i={10^{k-1}}}^{10^{k}-2}\left( \displaystyle\sum_{j=1}^{i}(f_j^o - f_j^e) \right)^2 - \frac{1}{9\cdot 10^{k-1}}\cdot\left(\displaystyle\sum_{i={10^{k-1}}}^{10^{k}-2}\displaystyle\sum_{j=1}^{i}(f_i^o - f_i^e)\right)^2\right]
</code>
</p>

<p>where <code class="reqn">f_i^o</code> denotes the observed frequency of digits <code class="reqn">i</code>, and <code class="reqn">f_i^e</code> denotes the expected frequency of digits <code class="reqn">i</code>.
<code>x</code> is a numeric vector of arbitrary length. Values of <code>x</code> should be continuous, as dictated by theory, but may also be integers.
<code>digits</code> should be chosen so that <code>signifd(x,digits)</code> is not influenced by previous rounding.
</p>


<h3>Value</h3>

<p>A list with class &quot;<code>htest</code>&quot; containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the <code class="reqn">U^2</code> test statistic</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string indicating the type of test performed</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p> a character string giving the name of the data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dieter William Joenssen <a href="mailto:Dieter.Joenssen@googlemail.com">Dieter.Joenssen@googlemail.com</a>
</p>


<h3>References</h3>

<p>Benford, F. (1938) The Law of Anomalous Numbers. <em>Proceedings of the American Philosophical Society</em>. <b>78</b>, 551&ndash;572.
</p>
<p>Freedman, L.S. (1981) Watson's Un2 Statistic for a Discrete Distribution. <em>Biometrika</em>. <b>68</b>, 708&ndash;711.
</p>
<p>Joenssen, D.W. (2013) Two Digit Testing for Benford's Law. <em>Proceedings of the ISI World Statistics Congress, 59th Session in Hong Kong</em>. [available under <a href="http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf">http://www.statistics.gov.hk/wsc/CPS021-P2-S.pdf</a>]
</p>
<p>Watson, G.S. (1961) Goodness-of-Fit Tests on a Circle. <em>Biometrika</em>. <b>48</b>, 109&ndash;114.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pbenf">pbenf</a></code>, <code><a href="#topic+simulateH0">simulateH0</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set the random seed to an arbitrary number
set.seed(421)
#Create a sample satisfying Benford's law
X&lt;-rbenf(n=20)
#Perform Freedman-Watson U-squared Test on
#the sample's first digits using defaults
usq.benftest(X)
#p-value = 0.4847
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
