<!DOCTYPE html><html><head><title>Help for package cpm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cpm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#changeDetected'><p>Tests Whether a CPM S4 Object Has Encountered a Change Point</p></a></li>
<li><a href='#cpm-package'><p>The Change Point Model Package</p></a></li>
<li><a href='#cpmReset'><p>Resets a CPM S4 Object</p></a></li>
<li><a href='#detectChangePoint'><p>Detect a Single Change Point in a Sequence</p></a></li>
<li><a href='#detectChangePointBatch'><p>Detect a Single Change Point in a Sequence</p></a></li>
<li><a href='#ForexData'><p>Foreign Exchange Data</p></a></li>
<li><a href='#getBatchThreshold'><p>Returns the Threshold Associated with a Type I Error Probability .</p></a></li>
<li><a href='#getStatistics'><p>Returns the Test Statistics Associated With A CPM S4 Object</p></a></li>
<li><a href='#makeChangePointModel'><p>Creates a CPM S4 Object</p></a></li>
<li><a href='#processObservation'><p>Process an Observation Using a CPM S4 Object.</p></a></li>
<li><a href='#processStream'><p>Detects Multiple Change Points in a Sequence</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Sequential and Batch Change Detection Using Parametric and
Nonparametric Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-10-08</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.0), methods</td>
</tr>
<tr>
<td>Author:</td>
<td>Gordon J. Ross</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gordon J. Ross &lt;gordon@gordonjross.co.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Sequential and batch change detection for univariate data streams, using the change point model framework. Functions are provided to allow nonparametric distribution-free change detection in the mean, variance, or general distribution of a given sequence of observations. Parametric change detection methods are also provided for Gaussian, Bernoulli and Exponential sequences. Both the batch (Phase I) and sequential (Phase II) settings are supported, and the sequences may contain either a single or multiple change points. A full description of this package is available in Ross, G.J (2015) - "Parametric and nonparametric sequential change detection in R" available at <a href="https://www.jstatsoft.org/article/view/v066i03">https://www.jstatsoft.org/article/view/v066i03</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-08 09:27:04 UTC; gotdonross</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-08 10:10:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='changeDetected'>Tests Whether a CPM S4 Object Has Encountered a Change Point</h2><span id='topic+changeDetected'></span>

<h3>Description</h3>

<p>Tests whether an existing Change Point Model (CPM) S4 object has encountered a change point. It returns <code>TRUE</code> if a change has been encountered, otherwise <code>FALSE</code>.
</p>
<p>Note that this function is part of the S4 object section of the <code>cpm</code> package, which allows for more precise control over the change detection process. For many simple change detection applications this extra complexity will not be required, and the <code>detectChangePoint</code> and <code>processStream</code> functions should be used instead.
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     changeDetected(cpm)
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="changeDetected_+3A_cpm">cpm</code></td>
<td>
<p>The CPM S4 object which is to be tested for whether a change has occurred.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if a change has been detected, otherwise <code>FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+makeChangePointModel">makeChangePointModel</a>, <a href="#topic+processObservation">processObservation</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generate a sequence containing a single change point
x &lt;- c(rnorm(100,0,1),rnorm(100,1,1))

#use a Student CPM
cpm &lt;- makeChangePointModel(cpmType="Student", ARL0=500)

for (i in 1:length(x)) {

  #process each observation in turn
  cpm &lt;- processObservation(cpm,x[i])
  
  if (changeDetected(cpm)) {
    print(sprintf("change detected at observation %s",i))
    break
  }
}
</code></pre>

<hr>
<h2 id='cpm-package'>The Change Point Model Package</h2><span id='topic+cpm-package'></span>

<h3>Description</h3>

<p>An implementation of several different change point models (CPMs) for performing both parametric and nonparametric change detection on univariate data streams.</p>


<h3>Details</h3>

<p>The CPM framework is an approach to sequential change detection (also known as Phase II process monitoring) which allows standard statistical hypothesis tests to be deployed sequentially. The main two general purpose functions in the package are <code>detectChangePoint</code> and <code>processStream</code> for detecting single and multiple change points respectively. The remainder of the functions allow for more precise control over the change detection procedure. To cite this R package in a research paper, please use <code>citation('cpm')</code> to obtain the reference, and BibTeX entry.
</p>
<p>Note: this package has a manual titled &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk, which contains a full description of all the functions and algorithms in the package, as well as detailed instructions on how to use it. 
</p>
<p>If you would like to cite this package, the citation information is &quot;G. J. Ross - Parametric and Nonparametric Sequential Change Detection in R: The cpm Package, Journal of Statistical Software, 2015, 66(3), 1-20&quot;
</p>
<p>A Brief CPM Overview
</p>
<p>Given a sequence <code class="reqn">X_1,...,X_n</code> of random variables, the CPM works by evaluating a two-sample test statistic at every possible split point. Let <code class="reqn">D_{k,n}</code> be the value of the test statistic when the sequence is split into the two samples <code class="reqn">\{X_1, X_2,..., X_k\}</code> and <code class="reqn">\{X_{k+1}, X_{k+2} ,..., X_{n}\}</code>,  and define <code class="reqn">D_n</code> to be the maximum of these values. <code class="reqn">D_n</code> is then compared to some threshold, with a change being detected if the threshold is exceeded. 
</p>
<p>In the sequential context, the observations are processed one-by-one, with <code class="reqn">D_t</code> being computed based on the first <em>t</em> observations, <code class="reqn">D_{t+1}</code> being computed based on the first <em>t+1</em> observations, and so on. The change detection time is defined as the first value of <code class="reqn">t</code> where the threshold is exceeded. Supposing this occurs at time <code class="reqn">t=T</code>, then the best estimate of the location of the change point is the value of <code class="reqn">k</code> which maximised <code class="reqn">D_{k,T}</code>. Writing <code class="reqn">\hat{\tau}</code> for this, we have that <code class="reqn">\hat{\tau} \leq T</code>.
</p>
<p>The thresholds are chosen so that there is a constant probability of a false positive occurring after each observation. This leads to control of the Average Run Length (<code class="reqn">ARL_0</code>), defined as the expected number of observations received before a change is falsely detecting, assuming that no change has occurred.
</p>
<p>The choice of test statistic in the CPM defines the class of changes which it is optimised towards detecting. This package implements CPMs using the following statistics. More details can be found in the references section:
</p>

<ul>
<li> <p><em>Student</em>: Student-t test statistic, as in [Hawkins et al, 2003]. Use to detect mean changes in a Gaussian sequence.
</p>
</li>
<li> <p><em>Bartlett</em>: Bartlett test statistic, as in [Hawkins and Zamba, 2005]. Use to detect variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>GLR</code>: Generalized Likelihood Ratio test statistic, as in [Hawkins and Zamba, 2005b]. Use to detect both mean and variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Exponential</code>: Generalized Likelihood Ratio test statistic for the Exponential distribution, as in [Ross, 2013]. Used to detect changes in the parameter of an Exponentially distributed sequence.
</p>
</li>
<li> <p><code>GLRAdjusted</code> and <code>ExponentialAdjusted</code>: Identical to the GLR and Exponential statistics, except with the finite-sample correction discussed in [Ross, 2013] which can lead to more powerful change detection.
</p>
</li>
<li> <p><em>FET</em>: Fishers Exact Test statistic, as in [Ross and Adams, 2012b]. Use to detect parameter changes in a Bernoulli sequence.
</p>
</li>
<li> <p><em>Mann-Whitney</em>: Mann-Whitney test statistic, as in [Ross et al, 2011]. Use to detect location shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><em>Mood</em>: Mood test statistic, as in [Ross et al, 2011]. Use to detect scale shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><em>Lepage</em>: Lepage test statistics in [Ross et al, 2011]. Use to detect location and/ort shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><em>Kolmogorov-Smirnov</em>: Kolmogorov-Smirnov test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><em>Cramer-von-Mises</em>: Cramer-von-Mises test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li></ul>

<p>For a fuller overview of the package which includes a description of the CPM framework and examples of how to use the various functions, please consult the full package manual titled  &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; 
</p>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>References</h3>

<p>Hawkins, D. , Zamba, K. (2005) &ndash; A Change-Point Model for a Shift in Variance, <em>Journal of Quality Technology</em>, 37, 21-31
</p>
<p>Hawkins, D. , Zamba, K. (2005b) &ndash; Statistical Process Control for Shifts in Mean or Variance Using a Changepoint Formulation, <em>Technometrics</em>, 47(2), 164-173
</p>
<p>Hawkins, D., Qiu, P., Kang, C. (2003) &ndash; The Changepoint Model for Statistical Process Control, <em>Journal of Quality Technology</em>, 35, 355-366. 
</p>
<p>Ross, G. J., Tasoulis, D. K., Adams, N. M. (2011) &ndash; A Nonparametric Change-Point Model for Streaming Data, <em>Technometrics</em>, 53(4)
</p>
<p>Ross, G. J., Adams, N. M. (2012) &ndash; Two Nonparametric Control Charts for Detecting Arbitary Distribution Changes, <em>Journal of Quality Technology</em>, 44:102-116
</p>
<p>Ross, G. J., Adams, N. M. (2013) &ndash; Sequential Monitoring of a Proportion, <em>Computational Statistics</em>, 28(2)
</p>
<p>Ross, G. J., (2014) &ndash; Sequential Change Detection in the Presence of Unknown Parameters, <em>Statistics and Computing</em> 24:1017-1030
</p>
<p>Ross, G. J., (2015) &ndash; Parametric and Nonparametric Sequential Change Detection in R: The cpm Package, <em>Journal of Statistical Software</em>, forthcoming
</p>

<hr>
<h2 id='cpmReset'>Resets a CPM S4 Object</h2><span id='topic+cpmReset'></span>

<h3>Description</h3>

<p>Resets an existing Change Point Model (CPM) S4 object. Typically it will be used in situations where the CPM is processing a stream, and has encountered a change point. If the stream may contain multiple change points, the typical reaction procedure after detecting a change is to reset the CPM. This involves clearing its memory of all the observations prior to the change point, so that monitoring can be resumed starting with the next observation after the change point.
</p>
<p>Note that this function is part of the S4 object section of the <code>cpm</code> package, which allows for more precise control over the change detection process. For many simple change detection applications this extra complexity will not be required, and the <code>detectChangePoint</code> and <code>processStream</code> functions should be used instead.
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     cpmReset(cpm)
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cpmReset_+3A_cpm">cpm</code></td>
<td>
<p>The CPM S4 object which is to be reset.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The reinitialised CPM.
</p>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+makeChangePointModel">makeChangePointModel</a>, <a href="#topic+processObservation">processObservation</a>, <a href="#topic+changeDetected">changeDetected</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generate a sequence containing two change points
x &lt;- c(rnorm(200,0,1),rnorm(200,1,1),rnorm(200,0,1))

#vectors to hold the result
detectiontimes &lt;- numeric()
changepoints &lt;- numeric()

#use a Lepage CPM
cpm &lt;- makeChangePointModel(cpmType="Lepage", ARL0=500)

i &lt;- 0
while (i &lt; length(x)) {
  i &lt;- i + 1
  #process each observation in turn
  cpm &lt;- processObservation(cpm,x[i])
  
  #if a change has been found, log it, and reset the CPM
  if (changeDetected(cpm) == TRUE) {
    print(sprintf("Change detected at observation %d", i))
    detectiontimes &lt;- c(detectiontimes,i)
    
    #the change point estimate is the maximum D_kt statistic 
    Ds &lt;- getStatistics(cpm)
    tau &lt;- which.max(Ds)
    
    if (length(changepoints) &gt; 0) {
      tau &lt;- tau + changepoints[length(changepoints)]
    }
    changepoints &lt;- c(changepoints,tau)
    
    #reset the CPM
    cpm &lt;- cpmReset(cpm)
    
    #resume monitoring from the observation following the 
    #change point
    i &lt;- tau
  }
}

     </code></pre>

<hr>
<h2 id='detectChangePoint'>Detect a Single Change Point in a Sequence</h2><span id='topic+detectChangePoint'></span>

<h3>Description</h3>

<p>This function is used to detect a single change point in a sequence of observations using the Change Point Model (CPM) framework for sequential (Phase II) change detection. The observations are processed in order, starting with the first, and a decision is made after each observation whether a change point has occurred. If a change point is detected, the function returns with no further observations being processed. A full description of the CPM framework can be found in the papers cited in the reference section.
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     detectChangePoint(x, cpmType, ARL0=500, startup=20, lambda=NA) 
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detectChangePoint_+3A_x">x</code></td>
<td>
<p>A vector containing the univariate data stream to be processed.</p>
</td></tr>
<tr><td><code id="detectChangePoint_+3A_cpmtype">cpmType</code></td>
<td>
<p>The type of CPM which is used. With the exception of the FET, these CPMs are all implemented in their two sided forms,
and are able to detect both increases and decreases in the parameters monitored. Possible arguments are: 
</p>

<ul>
<li> <p><code>Student</code>: Student-t test statistic, as in [Hawkins et al, 2003]. Use to detect mean changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Bartlett</code>: Bartlett test statistic, as in [Hawkins and Zamba, 2005]. Use to detect variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>GLR</code>: Generalized Likelihood Ratio test statistic, as in [Hawkins and Zamba, 2005b]. Use to detect both mean and variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Exponential</code>: Generalized Likelihood Ratio test statistic for the Exponential distribution, as in [Ross, 2013]. Used to detect changes in the parameter of an Exponentially distributed sequence.
</p>
</li>
<li> <p><code>GLRAdjusted</code> and <code>ExponentialAdjusted</code>: Identical to the GLR and Exponential statistics, except with the finite-sample correction discussed in [Ross, 2013] which can lead to more powerful change detection.
</p>
</li>
<li> <p><code>FET</code>: Fishers Exact Test statistic, as in [Ross and Adams, 2012b]. Use to detect parameter changes in a Bernoulli sequence.
</p>
</li>
<li> <p><code>Mann-Whitney</code>: Mann-Whitney test statistic, as in [Ross et al, 2011]. Use to detect location shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Mood</code>: Mood test statistic, as in [Ross et al, 2011]. Use to detect scale shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Lepage</code>: Lepage test statistics in [Ross et al, 2011]. Use to detect location and/or shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Kolmogorov-Smirnov</code>: Kolmogorov-Smirnov test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Cramer-von-Mises</code>: Cramer-von-Mises test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li></ul>

</td></tr>     
<tr><td><code id="detectChangePoint_+3A_arl0">ARL0</code></td>
<td>
<p>Determines the <code class="reqn">ARL_0</code> which the CPM should have, which corresponds to the average number of observations before a false positive occurs, assuming that the sequence does not undergo a change. Because the thresholds of the CPM are computationally expensive to estimate, the package contains pre-computed values of the thresholds corresponding to several common values of the <code class="reqn">ARL_0</code>. This means that only certain  values for the <code class="reqn">ARL_0</code> are allowed. Specifically, the <code class="reqn">ARL_0</code> must have one of the following values: 370, 500, 600, 700, ..., 1000, 2000, 3000, ..., 10000, 20000, ..., 50000.</p>
</td></tr>
<tr><td><code id="detectChangePoint_+3A_startup">startup</code></td>
<td>
<p>The number of observations after which monitoring begins. No change points will be flagged during this startup period. This must be set to at least 20.</p>
</td></tr>
<tr><td><code id="detectChangePoint_+3A_lambda">lambda</code></td>
<td>
<p>A smoothing parameter which is used to reduce the discreteness of the test statistic when using the FET CPM. See [Ross and Adams, 2012b] in the References section for more details on how this parameter is used.  Currently the package only contains sequences of ARL0 thresholds corresponding to lambda=0.1 and lambda=0.3, so using other values will result in an error. If no value is specified, the default value will be 0.1.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>The sequence of observations which was processed.</p>
</td></tr>
<tr><td><code>changeDetected</code></td>
<td>
<p>TRUE if any <code class="reqn">D_t</code> exceeds the value of <code class="reqn">h_t</code> associated with the chosen <code class="reqn">ARL_0</code>, otherwise FALSE.</p>
</td></tr>
<tr><td><code>detectionTime</code></td>
<td>
<p>The observation after which the change point was detected, defined as the first observation after which <code class="reqn">D_t</code> exceeded the test threshold. If no change is detected, this will be equal to 0.</p>
</td></tr>
<tr><td><code>changePoint</code></td>
<td>
<p>The best estimate of the change point location. If the change is detected after the <code class="reqn">t^{th}</code> observation, then the change estimate is the value of <code class="reqn">k</code> which maximises <code class="reqn">D_{k,t}</code>. If no change is detected, this will be equal to 0.</p>
</td></tr>
<tr><td><code>Ds</code></td>
<td>
<p>The sequence of maximised <code class="reqn">D_t</code> statistics, starting from the first observation until the  observation after which the change point was detected</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>References</h3>

<p>Hawkins, D. , Zamba, K. (2005) &ndash; A Change-Point Model for a Shift in Variance, <em>Journal of Quality Technology</em>, 37, 21-31
</p>
<p>Hawkins, D. , Zamba, K. (2005b) &ndash; Statistical Process Control for Shifts in Mean or Variance Using a Changepoint Formulation, <em>Technometrics</em>, 47(2), 164-173
</p>
<p>Hawkins, D., Qiu, P., Kang, C. (2003) &ndash; The Changepoint Model for Statistical Process Control, <em>Journal of Quality Technology</em>, 35, 355-366. 
</p>
<p>Ross, G. J., Tasoulis, D. K., Adams, N. M. (2011) &ndash; A Nonparametric Change-Point Model for Streaming Data, <em>Technometrics</em>, 53(4)
</p>
<p>Ross, G. J., Adams, N. M. (2012) &ndash; Two Nonparametric Control Charts for Detecting Arbitary Distribution Changes, <em>Journal of Quality Technology</em>, 44:102-116
</p>
<p>Ross, G. J., Adams, N. M. (2013) &ndash; Sequential Monitoring of a Proportion, <em>Computational Statistics</em>, 28(2)
</p>
<p>Ross, G. J., (2014) &ndash; Sequential Change Detection in the Presence of Unknown Parameters, <em>Statistics and Computing</em> 24:1017-1030
</p>
<p>Ross, G. J., (2015) &ndash; Parametric and Nonparametric Sequential Change Detection in R: The cpm Package, <em>Journal of Statistical Software</em>, forthcoming
</p>


<h3>See Also</h3>

<p><code><a href="#topic+processStream">processStream</a>, <a href="#topic+detectChangePointBatch">detectChangePointBatch</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     ## Use a Student-t CPM to detect a mean shift in a stream of Gaussian 
     ## random variables which occurs after the 100th observation
     x &lt;- c(rnorm(100,0,1),rnorm(1000,1,1))
     detectChangePoint(x,"Student",ARL0=500,startup=20)


     ## Use a Mood CPM to detect a scale shift in a stream of Student-t 
     ## random variables which occurs after the 100th observation
     x &lt;- c(rt(100,5),rt(100,5)*2)
     detectChangePoint(x,"Mood",ARL0=500,startup=20)

     ## Use a FET CPM to detect a parameter shift in a stream of Bernoulli 
     ##observations. In this case, the lambda parameter acts to reduce the 
     ##discreteness of the test statistic.
     x &lt;- c(rbinom(100,1,0.2), rbinom(1000,1,0.5))
     detectChangePoint(x,"FET",ARL0=500,startup=20,lambda=0.3)
     </code></pre>

<hr>
<h2 id='detectChangePointBatch'>Detect a Single Change Point in a Sequence</h2><span id='topic+detectChangePointBatch'></span>

<h3>Description</h3>

<p>This function is used to detect a single change point in a sequence of observations using the Change Point Model (CPM) framework for batch (Phase I) change detection. The observations are processed in one batch
and information is returned regarding whether the sequence contains a change point. A full description of the CPM framework can be found in the papers cited in the reference section.
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     detectChangePointBatch(x, cpmType, alpha=0.05, lambda=NA) 
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detectChangePointBatch_+3A_x">x</code></td>
<td>
<p>A vector containing the univariate data stream to be processed.</p>
</td></tr>
<tr><td><code id="detectChangePointBatch_+3A_cpmtype">cpmType</code></td>
<td>
<p>The type of CPM which is used. With the exception of the FET, these CPMs are all implemented in their two sided forms,
and are able to detect both increases and decreases in the parameters monitored. Possible arguments are: 
</p>

<ul>
<li> <p><code>Student</code>: Student-t test statistic, as in [Hawkins et al, 2003]. Use to detect mean changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Bartlett</code>: Bartlett test statistic, as in [Hawkins and Zamba, 2005]. Use to detect variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>GLR</code>: Generalized Likelihood Ratio test statistic, as in [Hawkins and Zamba, 2005b]. Use to detect both mean and variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Exponential</code>: Generalized Likelihood Ratio test statistic for the Exponential distribution, as in [Ross, 2013]. Used to detect changes in the parameter of an Exponentially distributed sequence.
</p>
</li>
<li> <p><code>GLRAdjusted</code> and <code>ExponentialAdjusted</code>: Identical to the GLR and Exponential statistics, except with the finite-sample correction discussed in [Ross, 2013] which can lead to more powerful change detection.        
</p>
</li>
<li> <p><code>FET</code>: Fishers Exact Test statistic, as in [Ross and Adams, 2012b]. Use to detect parameter changes in a Bernoulli sequence.
</p>
</li>
<li> <p><code>Mann-Whitney</code>: Mann-Whitney test statistic, as in [Ross et al, 2011]. Use to detect location shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Mood</code>: Mood test statistic, as in [Ross et al, 2011]. Use to detect scale shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Lepage</code>: Lepage test statistics in [Ross et al, 2011]. Use to detect location and/or shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Kolmogorov-Smirnov</code>: Kolmogorov-Smirnov test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Cramer-von-Mises</code>: Cramer-von-Mises test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li></ul>

</td></tr>     
<tr><td><code id="detectChangePointBatch_+3A_alpha">alpha</code></td>
<td>
<p>the null hypothesis of no change is rejected if <code class="reqn">D_n &gt; h_n</code> where n is the length of the sequence and <code class="reqn">h_n</code> is the upper alpha percentile of the test statistic distribution. Because computing the values of <code class="reqn">h_n</code> associated with each value of alpha is a laborious task, the package includes a function <code>getBatchThreshold</code> which returns the threshold associated with a particular choice of alpha and n. This function is called automatically whenever <code>detectChangePointBatch</code> is called, so the user need only provide the desired value of alpha. The allowable values for this argument are 0.05, 0.01, 0.005, 0.001. If a different value is required then the user will need to compute it manually.</p>
</td></tr>
<tr><td><code id="detectChangePointBatch_+3A_lambda">lambda</code></td>
<td>
<p>A smoothing parameter which is used to reduce the discreteness of the test statistic when using the FET CPM. See [Ross and Adams, 2012b] in the References section for more details on how this parameter is used.  Currently the package only contains sequences of ARL0 thresholds corresponding to lambda=0.1 and lambda=0.3, so using other values will result in an error. If no value is specified, the default value will be 0.1.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>The sequence of observations which was processed.</p>
</td></tr>
<tr><td><code>changeDetected</code></td>
<td>
<p>TRUE if <code class="reqn">D_n</code> exceeds the value of <code class="reqn">h_n</code> associated with alpha, otherwise FALSE.</p>
</td></tr>
<tr><td><code>changePoint</code></td>
<td>
<p>assuming a change was detected, this stores the most likely location of the change point, defined as the value of k which maximized <code class="reqn">D_kt</code>. If no change is detected, this will be equal to 0.</p>
</td></tr>
<tr><td><code>threshold</code></td>
<td>
<p>The value of <code class="reqn">h_n</code> which corresponds to the specified alpha.</p>
</td></tr>
<tr><td><code>Ds</code></td>
<td>
<p>The sequence of <code class="reqn">D_kt</code> test statistics.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>References</h3>

<p>Hawkins, D. , Zamba, K. (2005) &ndash; A Change-Point Model for a Shift in Variance, <em>Journal of Quality Technology</em>, 37, 21-31
</p>
<p>Hawkins, D. , Zamba, K. (2005b) &ndash; Statistical Process Control for Shifts in Mean or Variance Using a Changepoint Formulation, <em>Technometrics</em>, 47(2), 164-173
</p>
<p>Hawkins, D., Qiu, P., Kang, C. (2003) &ndash; The Changepoint Model for Statistical Process Control, <em>Journal of Quality Technology</em>, 35, 355-366. 
</p>
<p>Ross, G. J., Tasoulis, D. K., Adams, N. M. (2011) &ndash; A Nonparametric Change-Point Model for Streaming Data, <em>Technometrics</em>, 53(4)
</p>
<p>Ross, G. J., Adams, N. M. (2012) &ndash; Two Nonparametric Control Charts for Detecting Arbitary Distribution Changes, <em>Journal of Quality Technology</em>, 44:102-116
</p>
<p>Ross, G. J., Adams, N. M. (2013) &ndash; Sequential Monitoring of a Proportion, <em>Computational Statistics</em>, 28(2)
</p>
<p>Ross, G. J., (2014) &ndash; Sequential Change Detection in the Presence of Unknown Parameters, <em>Statistics and Computing</em> 24:1017-1030
</p>
<p>Ross, G. J., (2015) &ndash; Parametric and Nonparametric Sequential Change Detection in R: The cpm Package, <em>Journal of Statistical Software</em>, forthcoming
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detectChangePoint">detectChangePoint</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     ## Use a Student-t CPM to detect a mean shift in a stream of Gaussian 
     ## random variables which occurs after the 100th observation
     x &lt;- c(rnorm(100,0,1),rnorm(1000,1,1))
     detectChangePointBatch(x,"Student",alpha=0.05)


     ## Use a Mood CPM to detect a scale shift in a stream of Student-t 
     ## random variables which occurs after the 100th observation
     x &lt;- c(rt(100,5),rt(1000,5*2))
     detectChangePointBatch(x,"Mood",alpha=0.05)

     ## Use a FET CPM to detect a parameter shift in a stream of Bernoulli 
     ##observations. In this case, the lambda parameter acts to reduce the 
     ##discreteness of the test statistic.
     x &lt;- c(rbinom(100,1,0.2), rbinom(1000,1,0.5))
     detectChangePointBatch(x,"FET",alpha=0.05,lambda=0.3)
     </code></pre>

<hr>
<h2 id='ForexData'>Foreign Exchange Data</h2><span id='topic+ForexData'></span>

<h3>Description</h3>

<p>This dataset consists of a historical sequence of the exchange rates between the Swiss Franc (CHF) and the British Pound (GBP). The value of the exchange rate was recorded at three hour intervals running from October 21st 2002, to May 15th 2007. In total, 9273 observations were made.
</p>
<p>For an example of how to use the <code>cpm</code> package to detect changes in this data set, please see the &quot;Streams with multiple change points' section of the package vignette, available by typing: <code>vignette("cpm")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ForexData)</code></pre>


<h3>Format</h3>

<p>A three column matrix. Each observation is one row. The first column is the data, the second is the time of day at which the observation was recorded (1400 = 14:00pm, and so on), and the third is observed exchange rate.</p>

<hr>
<h2 id='getBatchThreshold'>Returns the Threshold Associated with a Type I Error Probability .</h2><span id='topic+getBatchThreshold'></span>

<h3>Description</h3>

<p>When performing Phase I analysis within the CPM framework for a sequence of length n, the null hypothesis of no change is rejected if <code class="reqn">D_n &gt; h_n</code> for some threshold <code class="reqn">h_n</code>. Typically this threshold is chosen to be the upper alpha quantile of the distribution of <code class="reqn">D_n</code> under the null hypothesis of no change. Given a particular choice of alpha and n, this function returns the associated <code class="reqn">h_n</code> threshold. Because these thresholds are laborious to compute, the package contains pre-computed values of <code class="reqn">h_n</code> for alpha = 0.05, 0.01, 0.005 and 0.001, and for <code class="reqn">n &lt; 10000</code>.
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	getBatchThreshold(cpmType, alpha, n, lambda=0.3)
    </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBatchThreshold_+3A_cpmtype">cpmType</code></td>
<td>
<p>The type of CPM which is used. Possible arguments are: 
</p>

<ul>
<li> <p><code>Student</code>: Student-t test statistic, as in [Hawkins et al, 2003]. Use to detect mean changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Bartlett</code>: Bartlett test statistic, as in [Hawkins and Zamba, 2005]. Use to detect variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>GLR</code>: Generalized Likelihood Ratio test statistic, as in [Hawkins and Zamba, 2005b]. Use to detect both mean and variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Exponential</code>: Generalized Likelihood Ratio test statistic for the Exponential distribution, as in [Ross, 2013]. Used to detect changes in the parameter of an Exponentially distributed sequence.
</p>
</li>
<li> <p><code>GLRAdjusted</code> and <code>ExponentialAdjusted</code>: Identical to the GLR and Exponential statistics, except with the finite-sample correction discussed in [Ross, 2013] which can lead to more powerful change detection.
</p>
</li>
<li> <p><code>FET</code>: Fishers Exact Test statistic, as in [Ross and Adams, 2012b]. Use to detect parameter changes in a Bernoulli sequence.
</p>
</li>
<li> <p><code>Mann-Whitney</code>: Mann-Whitney test statistic, as in [Ross et al, 2011]. Use to detect location shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Mood</code>: Mood test statistic, as in [Ross et al, 2011]. Use to detect scale shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Lepage</code>: Lepage test statistics in [Ross et al, 2011]. Use to detect location and/or shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Kolmogorov-Smirnov</code>: Kolmogorov-Smirnov test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Cramer-von-Mises</code>: Cramer-von-Mises test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li></ul>

</td></tr>
<tr><td><code id="getBatchThreshold_+3A_alpha">alpha</code></td>
<td>
<p>the null hypothesis of no change is rejected if <code class="reqn">D_n &gt; h_n</code> where n is the length of the sequence and <code class="reqn">h_n</code> is the upper alpha percentile of the test statistic distribution.</p>
</td></tr> 
<tr><td><code id="getBatchThreshold_+3A_n">n</code></td>
<td>
<p>the sequence length the value should be calculated for, i.e. the value of n in <code class="reqn">D_n</code>.</p>
</td></tr> 
<tr><td><code id="getBatchThreshold_+3A_lambda">lambda</code></td>
<td>
<p>A smoothing parameter which is used to reduce the discreteness of the test statistic when using the FET CPM. See [Ross and Adams, 2012b] in the References section for more details on how this parameter is used.  Currently the package only contains sequences of ARL0 thresholds corresponding to lambda=0.1 and lambda=0.3, so using other values will result in an error. If no value is specified, the default value will be 0.1.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>References</h3>

<p>Hawkins, D. , Zamba, K. (2005) &ndash; A Change-Point Model for a Shift in Variance, <em>Journal of Quality Technology</em>, 37, 21-31
</p>
<p>Hawkins, D. , Zamba, K. (2005b) &ndash; Statistical Process Control for Shifts in Mean or Variance Using a Changepoint Formulation, <em>Technometrics</em>, 47(2), 164-173
</p>
<p>Hawkins, D., Qiu, P., Kang, C. (2003) &ndash; The Changepoint Model for Statistical Process Control, <em>Journal of Quality Technology</em>, 35, 355-366. 
</p>
<p>Ross, G. J., Tasoulis, D. K., Adams, N. M. (2011) &ndash; A Nonparametric Change-Point Model for Streaming Data, <em>Technometrics</em>, 53(4)
</p>
<p>Ross, G. J., Adams, N. M. (2012) &ndash; Two Nonparametric Control Charts for Detecting Arbitary Distribution Changes, <em>Journal of Quality Technology</em>, 44:102-116
</p>
<p>Ross, G. J., Adams, N. M. (2013) &ndash; Sequential Monitoring of a Proportion, <em>Computational Statistics</em>, 28(2)
</p>
<p>Ross, G. J., (2014) &ndash; Sequential Change Detection in the Presence of Unknown Parameters, <em>Statistics and Computing</em> 24:1017-1030
</p>
<p>Ross, G. J., (2015) &ndash; Parametric and Nonparametric Sequential Change Detection in R: The cpm Package, <em>Journal of Statistical Software</em>, forthcoming
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detectChangePointBatch">detectChangePointBatch</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     ## Returns the threshold for n=1000, alpha=0.05 and the Mann-Whitney CPM
     h &lt;- getBatchThreshold("Mann-Whitney", 0.05, 1000)
</code></pre>

<hr>
<h2 id='getStatistics'>Returns the Test Statistics Associated With A CPM S4 Object</h2><span id='topic+getStatistics'></span>

<h3>Description</h3>

<p>Returns the <code class="reqn">D_{k,t}</code> statistics associated with an existing Change Point Model (CPM) S4 object. These statistics depend on the state of the object, which depends on the observations which have been processed to date. Calling this function returns the most recent set of statistics, which were generated after the previous observation was processed. 
</p>
<p>Note that this function is part of the S4 object section of the <code>cpm</code> package, which allows for more precise control over the change detection process. For many simple change detection applications this extra complexity will not be required, and the <code>detectChangePoint</code> and <code>processStream</code> functions should be used instead.
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     getStatistics(cpm)
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getStatistics_+3A_cpm">cpm</code></td>
<td>
<p>The CPM S4 object for which the test statistics are to be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the <code class="reqn">D_{k,t}</code> statistics generated after the previous observation was processed.
</p>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+makeChangePointModel">makeChangePointModel</a>, <a href="#topic+processObservation">processObservation</a>, <a href="#topic+changeDetected">changeDetected</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generate a sequence containing two change points
x &lt;- c(rnorm(200,0,1),rnorm(200,1,1),rnorm(200,0,1))

#vectors to hold the result
detectiontimes &lt;- numeric()
changepoints &lt;- numeric()

#use a Lepage CPM
cpm &lt;- makeChangePointModel(cpmType="Lepage", ARL0=500)


i &lt;- 0
while (i &lt; length(x)) {
  i &lt;- i + 1
  #process each observation in turn
  cpm &lt;- processObservation(cpm,x[i])
  
  #if a change has been found, log it, and reset the CPM
  if (changeDetected(cpm) == TRUE) {
    print(sprintf("Change detected at observation %d", i))
    detectiontimes &lt;- c(detectiontimes,i)
    
    #the change point estimate is the maximum D_kt statistic 
    Ds &lt;- getStatistics(cpm)
    tau &lt;- which.max(Ds)
    
    if (length(changepoints) &gt; 0) {
      tau &lt;- tau + changepoints[length(changepoints)]
    }
    changepoints &lt;- c(changepoints,tau)
    
    #reset the CPM
    cpm &lt;- cpmReset(cpm)
    
    #resume monitoring from the observation following the 
    #change point
    i &lt;- tau
  }
}
</code></pre>

<hr>
<h2 id='makeChangePointModel'>Creates a CPM S4 Object</h2><span id='topic+makeChangePointModel'></span>

<h3>Description</h3>

<p>This function is used to create a change point model (CPM) S4 object. The CPM object can be used to process a sequence of data, one observation at a time. The CPM object maintains its state between each observation, and can be queried to obtain the <code>D_{k,t}</code> statistics, and to test whether a change has been detected. 
</p>
<p>Note that this function is part of the S4 object section of the <code>cpm</code> package, which allows for more precise control over the change detection process. For many simple change detection applications this extra complexity will not be required, and the <code>detectChangePoint</code> and <code>processStream</code> functions should be used instead.
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     makeChangePointModel(cpmType, ARL0=500, startup=20, lambda=NA) 
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeChangePointModel_+3A_cpmtype">cpmType</code></td>
<td>
<p>The type of CPM which is to be created. Possible arguments are: 
</p>

<ul>
<li> <p><code>Student</code>: Student-t test statistic, as in [Hawkins et al, 2003]. Use to detect mean changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Bartlett</code>: Bartlett test statistic, as in [Hawkins and Zamba, 2005]. Use to detect variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>GLR</code>: Generalized Likelihood Ratio test statistic, as in [Hawkins and Zamba, 2005b]. Use to detect both mean and variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Exponential</code>: Generalized Likelihood Ratio test statistic for the Exponential distribution, as in [Ross, 2013]. Used to detect changes in the parameter of an Exponentially distributed sequence.
</p>
</li>
<li> <p><code>GLRAdjusted</code> and <code>ExponentialAdjusted</code>: Identical to the GLR and Exponential statistics, except with the finite-sample correction discussed in [Ross, 2013] which can lead to more powerful change detection.
</p>
</li>
<li> <p><code>FET</code>: Fishers Exact Test statistic, as in [Ross and Adams, 2012b]. Use to detect parameter changes in a Bernoulli sequence.
</p>
</li>
<li> <p><code>Mann-Whitney</code>: Mann-Whitney test statistic, as in [Ross et al, 2011]. Use to detect location shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Mood</code>: Mood test statistic, as in [Ross et al, 2011]. Use to detect scale shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Lepage</code>: Lepage test statistics in [Ross et al, 2011]. Use to detect location and/or shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Kolmogorov-Smirnov</code>: Kolmogorov-Smirnov test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Cramer-von-Mises</code>: Cramer-von-Mises test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li></ul>

</td></tr>     
<tr><td><code id="makeChangePointModel_+3A_arl0">ARL0</code></td>
<td>
<p>Determines the <code class="reqn">ARL_0</code> which the CPM should have, which corresponds to the average number of observations before a false positive occurs, assuming that the sequence does not undergo a chang. Because the thresholds of the CPM are computationally expensive to estimate, the package contains pre-computed values of the thresholds corresponding to several common values of the <code class="reqn">ARL_0</code>. This means that only certain  values for the <code class="reqn">ARL_0</code> are allowed. Specifically, the <code class="reqn">ARL_0</code> must have one of the following values: 370, 500, 600, 700, ..., 1000, 2000, 3000, ..., 10000, 20000, ..., 50000.</p>
</td></tr>
<tr><td><code id="makeChangePointModel_+3A_startup">startup</code></td>
<td>
<p>The number of observations after which monitoring begins. No change points will be flagged during this startup period. This must be set to at least 20.</p>
</td></tr>
<tr><td><code id="makeChangePointModel_+3A_lambda">lambda</code></td>
<td>
<p>A smoothing parameter which is used to reduce the discreteness of the test statistic when using the FET CPM. See [Ross and Adams, 2012b] in the References section for more details on how this parameter is used.  Currently the package only contains sequences of ARL0 thresholds corresponding to lambda=0.1 and lambda=0.3, so using other values will result in an error. If no value is specified, the default value will be 0.1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A CPM S4 object. The class of this object will depend on the value which has been passed as the <code>cpmType</code> argument.
</p>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>References</h3>

<p>Hawkins, D. , Zamba, K. (2005) &ndash; A Change-Point Model for a Shift in Variance, <em>Journal of Quality Technology</em>, 37, 21-31
</p>
<p>Hawkins, D. , Zamba, K. (2005b) &ndash; Statistical Process Control for Shifts in Mean or Variance Using a Changepoint Formulation, <em>Technometrics</em>, 47(2), 164-173
</p>
<p>Hawkins, D., Qiu, P., Kang, C. (2003) &ndash; The Changepoint Model for Statistical Process Control, <em>Journal of Quality Technology</em>, 35, 355-366. 
</p>
<p>Ross, G. J., Tasoulis, D. K., Adams, N. M. (2011) &ndash; A Nonparametric Change-Point Model for Streaming Data, <em>Technometrics</em>, 53(4)
</p>
<p>Ross, G. J., Adams, N. M. (2012) &ndash; Two Nonparametric Control Charts for Detecting Arbitary Distribution Changes, <em>Journal of Quality Technology</em>, 44:102-116
</p>
<p>Ross, G. J., Adams, N. M. (2013) &ndash; Sequential Monitoring of a Proportion, <em>Computational Statistics</em>, 28(2)
</p>
<p>Ross, G. J., (2014) &ndash; Sequential Change Detection in the Presence of Unknown Parameters, <em>Statistics and Computing</em> 24:1017-1030
</p>
<p>Ross, G. J., (2015) &ndash; Parametric and Nonparametric Sequential Change Detection in R: The cpm Package, <em>Journal of Statistical Software</em>, forthcoming
</p>


<h3>See Also</h3>

<p><code><a href="#topic+processObservation">processObservation</a>, <a href="#topic+changeDetected">changeDetected</a>, <a href="#topic+cpmReset">cpmReset</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generate a sequence containing a single change point
x &lt;- c(rnorm(100,0,1),rnorm(100,1,1))

#use a Student CPM
cpm &lt;- makeChangePointModel(cpmType="Student", ARL0=500)

for (i in 1:length(x)) {

  #process each observation in turn
  cpm &lt;- processObservation(cpm,x[i])
  
  if (changeDetected(cpm)) {
    print(sprintf("change detected at observation %s",i))
    break
  }
}
     </code></pre>

<hr>
<h2 id='processObservation'>Process an Observation Using a CPM S4 Object.</h2><span id='topic+processObservation'></span>

<h3>Description</h3>

<p>Updates the state of an existing Change Point Model (CPM) S4 object, by processing a single observation. This effectively computes the <code class="reqn">D_{k,t+1}</code> statistics, for a CPM that had previously seen <code class="reqn">t</code> observations. When the function is called, several events happen. First, the function returns a CPM object which is identical the CPM object passed to the function, except that the observation passed as an argument has been processed and added to the state. Second, the CPM computes the <code class="reqn">D_{t+1}</code> statistic and compares it to its stored sequence of thresholds. If a change is detected, then this is stored in the state of the CPM, and a call to <code>changeDetected</code> will now return <code>TRUE</code>.
</p>
<p>Note that this function is part of the S4 object section of the <code>cpm</code> package, which allows for more precise control over the change detection process. For many simple change detection applications this extra complexity will not be required, and the <code>detectChangePoint</code> and <code>processStream</code> functions should be used instead.
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     processObservation(cpm,x)
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="processObservation_+3A_cpm">cpm</code></td>
<td>
<p>The CPM S4 object which is to be updated.</p>
</td></tr>
<tr><td><code id="processObservation_+3A_x">x</code></td>
<td>
<p>The observation which is to be processed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated CPM. If a stream is being processed, then this should be stored, and used to process the next observation in the sequence.
</p>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+makeChangePointModel">makeChangePointModel</a>, <a href="#topic+changeDetected">changeDetected</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#generate a sequence containing a single change point
x &lt;- c(rnorm(100,0,1),rnorm(100,1,1))

#use a Student CPM
cpm &lt;- makeChangePointModel(cpmType="Student", ARL0=500)

for (i in 1:length(x)) {

  #process each observation in turn
  cpm &lt;- processObservation(cpm,x[i])
  
  if (changeDetected(cpm)) {
    print(sprintf("change detected at observation %s",i))
    break
  }
}
</code></pre>

<hr>
<h2 id='processStream'>Detects Multiple Change Points in a Sequence</h2><span id='topic+processStream'></span>

<h3>Description</h3>

<p>This function is used to detect a multiple change points in a sequence of observations using the Change Point Model (CPM) framework for sequential (Phase II) change detection. The observations are processed in order, starting with the first, and a decision is made after each observation whether a change point has occurred. A full description of the CPM framework can be found in the papers cited in the reference section.
</p>
<p>Unlike the <code>detectChange</code> function, <code>processStream</code> does not terminate and return when a change point is encountered. Instead, a new CPM is initialised immediately following the change point, with all previous observations being discarded. The monitoring then continues, starting from the first observation after the change point. If more change points are discovered later in the sequence, the CPM is again reinitialised after each one. In this way, the whole sequence of observations will be processed and multiple change points may be detected.        
</p>
<p>For a fuller overview of this function including a description of the CPM framework and examples of how to use the various functions, please consult the package manual &quot;Parametric and Nonparametric Sequential Change Detection in R: The cpm Package&quot; available from www.gordonjross.co.uk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>     processStream(x, cpmType, ARL0=500, startup=20, lambda=NA)
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="processStream_+3A_x">x</code></td>
<td>
<p>A vector containing the univariate data stream to be processed.</p>
</td></tr>
<tr><td><code id="processStream_+3A_cpmtype">cpmType</code></td>
<td>
<p>The type of CPM which is used. Possible arguments are: 
</p>

<ul>
<li> <p><code>Student</code>: Student-t test statistic, as in [Hawkins et al, 2003]. Use to detect mean changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Bartlett</code>: Bartlett test statistic, as in [Hawkins and Zamba, 2005]. Use to detect variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>GLR</code>: Generalized Likelihood Ratio test statistic, as in [Hawkins and Zamba, 2005b]. Use to detect both mean and variance changes in a Gaussian sequence.
</p>
</li>
<li> <p><code>Exponential</code>: Generalized Likelihood Ratio test statistic for the Exponential distribution, as in [Ross, 2013]. Used to detect changes in the parameter of an Exponentially distributed sequence.
</p>
</li>
<li> <p><code>GLRAdjusted</code> and <code>ExponentialAdjusted</code>: Identical to the GLR and Exponential statistics, except with the finite-sample correction discussed in [Ross, 2013] which can lead to more powerful change detection.
</p>
</li>
<li> <p><code>FET</code>: Fishers Exact Test statistic, as in [Ross and Adams, 2012b]. Use to detect parameter changes in a Bernoulli sequence.
</p>
</li>
<li> <p><code>Mann-Whitney</code>: Mann-Whitney test statistic, as in [Ross et al, 2011]. Use to detect location shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Mood</code>: Mood test statistic, as in [Ross et al, 2011]. Use to detect scale shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Lepage</code>: Lepage test statistics in [Ross et al, 2011]. Use to detect location and/or shifts in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Kolmogorov-Smirnov</code>: Kolmogorov-Smirnov test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li>
<li> <p><code>Cramer-von-Mises</code>: Cramer-von-Mises test statistic, as in [Ross et al 2012]. Use to detect arbitrary changes in a stream with a (possibly unknown) non-Gaussian distribution.
</p>
</li></ul>

</td></tr>     
<tr><td><code id="processStream_+3A_arl0">ARL0</code></td>
<td>
<p>Determines the <code class="reqn">ARL_0</code> which the CPM should have, which corresponds to the average number of observations before a false positive occurs, assuming that the sequence does not undergo a chang. Because the thresholds of the CPM are computationally expensive to estimate, the package contains pre-computed values of the thresholds corresponding to several common values of the <code class="reqn">ARL_0</code>. This means that only certain  values for the <code class="reqn">ARL_0</code> are allowed. Specifically, the <code class="reqn">ARL_0</code> must have one of the following values: 370, 500, 600, 700, ..., 1000, 2000, 3000, ..., 10000, 20000, ..., 50000.</p>
</td></tr>
<tr><td><code id="processStream_+3A_startup">startup</code></td>
<td>
<p>The number of observations after which monitoring begins. No change points will be flagged during this startup period. This should be set to at least 20.</p>
</td></tr>
<tr><td><code id="processStream_+3A_lambda">lambda</code></td>
<td>
<p>A smoothing parameter which is used to reduce the discreteness of the test statistic when using the FET CPM. See [Ross and Adams, 2012b] in the References section for more details on how this parameter is used.  Currently the package only contains sequences of ARL0 thresholds corresponding to lambda=0.1 and lambda=0.3, so using other values will result in an error. If no value is specified, the default value will be 0.1.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>The sequence of observations which was processed.</p>
</td></tr>       <tr><td><code>detectionTimes</code></td>
<td>
<p>A vector containing the points in the sequence at which changes were detected, defined as the first observation after which <code class="reqn">D_t</code> exceeded the test threshold.</p>
</td></tr>
<tr><td><code>changePoints</code></td>
<td>
<p>A vector containing the best estimates of the change point locations, for each detecting change point. If a change is detected after the <code class="reqn">t^{th}</code> observation, then the change estimate is the value of <code class="reqn">k</code> which maximises <code class="reqn">D_{k,t}</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gordon J. Ross <a href="mailto:gordon@gordonjross.co.uk">gordon@gordonjross.co.uk</a></p>


<h3>References</h3>

<p>Hawkins, D. , Zamba, K. (2005) &ndash; A Change-Point Model for a Shift in Variance, <em>Journal of Quality Technology</em>, 37, 21-31
</p>
<p>Hawkins, D. , Zamba, K. (2005b) &ndash; Statistical Process Control for Shifts in Mean or Variance Using a Changepoint Formulation, <em>Technometrics</em>, 47(2), 164-173
</p>
<p>Hawkins, D., Qiu, P., Kang, C. (2003) &ndash; The Changepoint Model for Statistical Process Control, <em>Journal of Quality Technology</em>, 35, 355-366. 
</p>
<p>Ross, G. J., Tasoulis, D. K., Adams, N. M. (2011) &ndash; A Nonparametric Change-Point Model for Streaming Data, <em>Technometrics</em>, 53(4)
</p>
<p>Ross, G. J., Adams, N. M. (2012) &ndash; Two Nonparametric Control Charts for Detecting Arbitary Distribution Changes, <em>Journal of Quality Technology</em>, 44:102-116
</p>
<p>Ross, G. J., Adams, N. M. (2013) &ndash; Sequential Monitoring of a Proportion, <em>Computational Statistics</em>, 28(2)
</p>
<p>Ross, G. J., (2014) &ndash; Sequential Change Detection in the Presence of Unknown Parameters, <em>Statistics and Computing</em> 24:1017-1030
</p>
<p>Ross, G. J., (2015) &ndash; Parametric and Nonparametric Sequential Change Detection in R: The cpm Package, <em>Journal of Statistical Software</em>, forthcoming
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detectChangePoint">detectChangePoint</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     ## Use a Student-t CPM to detect several mean shift in a stream of 
     ## Gaussian random variables
     x &lt;- c(rnorm(100,0,1),rnorm(100,1,1), rnorm(100,0,1), rnorm(100,-1,1))
     result &lt;- processStream(x,"Student",ARL0=500,startup=20)
     plot(x)
     for (i in 1:length(result$changePoints)) {
         abline(v=result$changePoints[i], lty=2)
     }

     ## Use a Mood CPM to detect several scale shifts in a stream of 
     ##Student-t random variables
     x &lt;- c(rt(100,3),rt(100,3)*2, rt(100,3), rt(100,3)*2)
     result &lt;- processStream(x,"Mood",ARL0=500,startup=20)
     plot(x)
     for (i in 1:length(result$changePoints)) {
         abline(v=result$changePoints[i], lty=2)
     }
     
     ## Use a FET CPM to detect several parameter shifts in a stream of 
     ## Bernoulli observations. In this case, the lambda parameter acts to 
     ## reduce the discreteness of the test statistic.
     x &lt;- c(rbinom(300,1,0.1),rbinom(300,1,0.4), rbinom(300,1,0.7))
     result &lt;- processStream(x,"FET",ARL0=500,startup=20,lambda=0.3)
     plot(x)
     for (i in 1:length(result$changePoints)) {
         abline(v=result$changePoints[i], lty=2)
     }
     </code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
