<!DOCTYPE html><html lang="en"><head><title>Help for package MAP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MAP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe</p></a></li>
<li><a href='#+25+26lt+3B+26gt+3B+25'><p>Assignment pipe</p></a></li>
<li><a href='#+25+24+25'><p>Exposition pipe</p></a></li>
<li><a href='#MAP'><p>MAP algorithm</p></a></li>
<li><a href='#phecode.cuis.list'><p>MAP dictionary</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multimodal Automated Phenotyping</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Electronic health records (EHR) linked with biorepositories are 
    a powerful platform for translational studies. A major bottleneck exists 
    in the ability to phenotype patients accurately and efficiently. 
    Towards that end, we developed an automated high-throughput 
    phenotyping method integrating International 
    Classification of Diseases (ICD) codes and narrative data extracted 
    using natural language processing (NLP). Specifically, our proposed method, 
    called MAP (Map Automated Phenotyping algorithm), fits an ensemble of latent 
    mixture models on aggregated ICD and NLP counts along with healthcare 
    utilization. The MAP algorithm yields a predicted probability of phenotype 
    for each patient and a threshold for classifying subjects with phenotype 
    yes/no (See Katherine P. Liao, et al. (2019) &lt;<a href="https://doi.org/10.1093%2Fjamia%2Focz066">doi:10.1093/jamia/ocz066</a>&gt;.).</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://celehs.github.io/MAP/">https://celehs.github.io/MAP/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/celehs/MAP/issues">https://github.com/celehs/MAP/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), flexmix (&ge; 2.3-14), Matrix(&ge; 1.2-10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>magrittr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, pROC, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-02 14:38:25 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Charlon <a href="https://orcid.org/0000-0001-7497-0470"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Chuan Hong [aut],
  Jiehuan Sun [aut],
  Katherine Liao [aut],
  Sheng Yu [aut],
  Tianxi Cai [aut],
  PARSE Health [aut] (&lt;https://parse-health.org&gt;),
  CELEHS [aut] (&lt;https://celehs.hms.harvard.edu&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Charlon &lt;charlon@protonmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-02 17:10:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>Pipe an object forward into a function or call expression.
Magrittr imported function, see details and examples in the magrittr package.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Result of rhs applied to lhs, see details in magrittr package.
</p>

<hr>
<h2 id='+25+26lt+3B+26gt+3B+25'>Assignment pipe</h2><span id='topic++25+3C+3E+25'></span>

<h3>Description</h3>

<p>Pipe an object forward into a function or call expression and update the
'lhs' object with the resulting value.
Magrittr imported function, see details and examples in the magrittr package.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26lt+2B3B+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>An object which serves both as the initial value and as target.</p>
</td></tr>
<tr><td><code id="+2B25+2B26lt+2B3B+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>a function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None, used to update the value of lhs.
</p>

<hr>
<h2 id='+25+24+25'>Exposition pipe</h2><span id='topic++25+24+25'></span>

<h3>Description</h3>

<p>Expose the names in 'lhs' to the 'rhs' expression.
Magrittr imported function, see details and examples in the magrittr package.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B24+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A list, environment, or a data.frame.</p>
</td></tr>
<tr><td><code id="+2B25+2B24+2B25_+3A_rhs">rhs</code></td>
<td>
<p>An expression where the names in lhs is available.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Result of rhs applied to one or several names of lhs.
</p>

<hr>
<h2 id='MAP'>MAP algorithm</h2><span id='topic+MAP'></span>

<h3>Description</h3>

<p>Main function to perform MAP algorithm to calculate predicted
probabilities of positive phenotype for each patient
based on NLP and ICD counts adjusted for healthcare utilization.
For large number of patients (&gt;50k) it may take very long to compute,
so a subset_sample parameter is provided to perform the fit on a subset of
patients and project the remaining. The subset_sample_size controls the
maximum number of patients on which to perform the fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAP(
  mat = NULL,
  note = NULL,
  yes.con = FALSE,
  full.output = FALSE,
  subset_sample = FALSE,
  subset_sample_size = 5000,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MAP_+3A_mat">mat</code></td>
<td>
<p>Count data (sparse matrix). One of the columns has to be ICD
data with name being ICD.</p>
</td></tr>
<tr><td><code id="MAP_+3A_note">note</code></td>
<td>
<p>Note count (sparse matrix) indicating healthcare utilization.</p>
</td></tr>
<tr><td><code id="MAP_+3A_yes.con">yes.con</code></td>
<td>
<p>A logical variable indicating if concomitant is desired. Not
used for now.</p>
</td></tr>
<tr><td><code id="MAP_+3A_full.output">full.output</code></td>
<td>
<p>A logical variable indicating if full outputs are
desired.</p>
</td></tr>
<tr><td><code id="MAP_+3A_subset_sample">subset_sample</code></td>
<td>
<p>Logical, perform fit on a subset of patients and
project remaining.</p>
</td></tr>
<tr><td><code id="MAP_+3A_subset_sample_size">subset_sample_size</code></td>
<td>
<p>If subset_sample TRUE, number of patients on which
to perform the fit (default 50k).</p>
</td></tr>
<tr><td><code id="MAP_+3A_verbose">verbose</code></td>
<td>
<p>Print model information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with following objects:
</p>
<table role = "presentation">
<tr><td><code>scores</code></td>
<td>
<p>Indicates predicted probabilities.</p>
</td></tr>
<tr><td><code>cut.MAP</code></td>
<td>
<p>The cutoff value that can be used to derive binary
phenotypes.</p>
</td></tr>
</table>


<h3>References</h3>

<p>High-throughput Multimodal Automated Phenotyping (MAP) with
Application to PheWAS. Katherine P. Liao, Jiehuan Sun,
Tianrun A. Cai, Nicholas Link, Chuan Hong, Jie Huang, Jennifer Huffman,
Jessica Gronsbell, Yichi Zhang, Yuk-Lam Ho, Victor Castro, Vivian Gainer,
Shawn Murphy, Christopher J. Oâ€™Donnell, J. Michael Gaziano, Kelly Cho,
Peter Szolovits, Isaac Kohane, Sheng Yu, and Tianxi Cai
with the VA Million Veteran Program (2019) &lt;doi:10.1101/587436&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## simulate data to test the algorithm
n = 400
ICD = c(rpois(n/4,10), rpois(n/4,1), rep(0,n/2) )
NLP = c(rpois(n/4,10), rpois(n/4,1), rep(0,n/2) )
mat = Matrix(data=cbind(ICD,NLP),sparse = TRUE)
note = Matrix(rpois(n,10)+5,ncol=1,sparse = TRUE)
res = MAP(mat = mat,  note=note)
head(res$scores)
res$cut.MAP

</code></pre>

<hr>
<h2 id='phecode.cuis.list'>MAP dictionary</h2><span id='topic+phecode.cuis.list'></span>

<h3>Description</h3>

<p>MAP dictionary that maps phecode to CUIs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phecode.cuis.list
</code></pre>


<h3>Format</h3>

<p>A list of 1866
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(phecode.cuis.list)
tail(phecode.cuis.list)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
