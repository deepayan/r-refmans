<!DOCTYPE html><html><head><title>Help for package tracheideR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tracheideR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#getTrac'><p>Compute tracheidograms</p></a></li>
<li><a href='#ringPlot'><p>Plot intra-ring variation of tracheid features</p>
(with the possibility of plotting a climatic variable)</a></li>
<li><a href='#sw'>
<p>Monthly soil moisture data for the period 1901-2013.</p></a></li>
<li><a href='#tch'>
<p>Raw light intensity for two years (2010 and 2013) of Pinus pinaster</p></a></li>
<li><a href='#tracheider'><p>Compute standardized tracheidograms</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Standardize Tracheidograms</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-11-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Filipe Campelo</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Filipe Campelo &lt;fcampelo@uc.pt&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions to standardize tracheid profiles
    using the traditional method (Vaganov) and a new method to standardize
    tracheidograms based on the relative position of tracheids within tree rings.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>tgram (&ge; 0.2-2)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-11-21 17:29:35 UTC; Dendrologia</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-11-22 11:48:37</td>
</tr>
</table>
<hr>
<h2 id='getTrac'>Compute tracheidograms</h2><span id='topic+getTrac'></span>

<h3>Description</h3>

<p>This function computes a tracheidogram from microscope light measurements in gray (0-255).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTrac(x, val50 = 120, mw = 5, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTrac_+3A_x">x</code></td>
<td>
<p>a vector with the light measurements (pixel gray-level values)</p>
</td></tr>
<tr><td><code id="getTrac_+3A_val50">val50</code></td>
<td>
<p>the value giving the &quot;intensity&quot; of the light measurements at which the measurments should be made (for more details please see the help of <code>tgram</code> function).</p>
</td></tr>
<tr><td><code id="getTrac_+3A_mw">mw</code></td>
<td>
<p>width of the rolling window to smooth the original data (for more details please see the help of <code>tgram</code> function)</p>
</td></tr>
<tr><td><code id="getTrac_+3A_scale">scale</code></td>
<td>
<p>distance per pixel, default = 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the <code>tgram</code> function (tgram package) to convert gray pixel values (0-255) into a raw tracheidogram (keeping the original number of cells).
</p>


<h3>Value</h3>

<p><code>getTrac</code> returns a list with following elements:
</p>
<p><code>n</code> number of cells
</p>
<p><code>pos</code> <code>pos$RingWidth</code> gives the tree-ring width and <code>pos$x</code> gives the &quot;position&quot; of each tracheid.
</p>
<p><code>LD</code> a <code>vector</code> with the lumen diameter (LD).
</p>
<p><code>CWT</code> a <code>vector</code> with the radial cell wall thikness (CWT).
</p>
<p><code>LWratio</code> a <code>vector</code> with the LD/CWT ratio.
</p>


<h3>References</h3>

<p>DeSoto, L., De la Cruz, M., Fonti, P. (2011). Intra-annual patterns of tracheid size in the Mediterranean tree Juniperus thurifera as an indicator of seasonal water stress. Canadian Journal of Forest Research 41: 1280-1294.
Vaganov, E., 1989. The tracheidogram method in tree-ring analysis and its application, in: Cook, E., Kairiukstis, L. (Eds.), Methods of Dendrochronology: Applications in the Environmental Sciences. Kluwer Academic Publishers, Dordrecht, The Netherlands.
</p>


<h3>See Also</h3>

<p><code>tgram</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:
y2010ray1 &lt;- getTrac(tch$y2010$ray1, scale = 0.169)
y2010 &lt;- getTrac(tch$y2010, scale = 0.169)
TCH &lt;- lapply(tch,getTrac, scale = 0.169)
TCH$y2010$ray1$n #number of tracheids in ray1 in the year 2010
TCH$y2010$ray1$pos$RingWidth #number of tracheids in ray1 in the year 2010
#getTrac(tch$y2010$ray2, scale = 0.169)
#getTrac(data.frame(tch$y2010$ray2), scale=0.169)
## End(Not run)
</code></pre>

<hr>
<h2 id='ringPlot'>Plot intra-ring variation of tracheid features
(with the possibility of plotting a climatic variable)</h2><span id='topic+ringPlot'></span>

<h3>Description</h3>

<p>This function plots the intra-ring variation of a tracheid feature (e.g. LD, CWT or LD/CWT)
along the growing season and, optionally, the intra-annual variation of a climatic variable can be added to the same plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ringPlot(traq, varMean = NULL, varYear = NULL, m0 = 3, mt = 6.75,
  m1 = 11, type = c("LD", "CWT", "LWratio"), ylab = match.arg(type),
  main = "", addGS = TRUE, addMonths = addGS, ...,
  varMeanCol = "grey80", varYearCol = "red", varName = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ringPlot_+3A_traq">traq</code></td>
<td>
<p>ordered sequence of a tracheid feature (e.g. LD)</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_varmean">varMean</code></td>
<td>
<p>vector with monthly values of a given environmental variable</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_varyear">varYear</code></td>
<td>
<p>vector with monlthy values of an environmental variable for a specific year</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_m0">m0</code></td>
<td>
<p>the start of the growing season (in months); the default value is 3 that corresponds to day of the year (doy) 60.</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_mt">mt</code></td>
<td>
<p>the moment of transition from earlywood to latewood; the default value is 6.75.</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_m1">m1</code></td>
<td>
<p>the end of the growing season; default value is 11.</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_type">type</code></td>
<td>
<p>a string that defines the tracheid features to be plotted, defaults &quot;LD&quot;</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_ylab">ylab</code></td>
<td>
<p>the y axis title (for the tracheid feature variable), default value is <code>type</code></p>
</td></tr>
<tr><td><code id="ringPlot_+3A_main">main</code></td>
<td>
<p>an overall title for the plot, if no <code>string</code> is supplied no title is added to the plot</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_addgs">addGS</code></td>
<td>
<p>logical; if <code>TRUE</code> add the growing season length to the axis 1, defaults <code>TRUE</code></p>
</td></tr>
<tr><td><code id="ringPlot_+3A_addmonths">addMonths</code></td>
<td>
<p>logical; if <code>TRUE</code> add months to the axis 1, defaults <code>TRUE</code></p>
</td></tr>
<tr><td><code id="ringPlot_+3A_...">...</code></td>
<td>
<p>graphical parameters for <code>plot</code> may also be passed as arguments to this function</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_varmeancol">varMeanCol</code></td>
<td>
<p>the default value, <code>"grey80"</code>, gives the color to plot the mean environmental variable</p>
</td></tr>
<tr><td><code id="ringPlot_+3A_varyearcol">varYearCol</code></td>
<td>
<p>the color to plot monthly environmental values; the default value is <code>"red"</code></p>
</td></tr>
<tr><td><code id="ringPlot_+3A_varname">varName</code></td>
<td>
<p>the y axis title (for the environmental variable),default value is <code>""</code>; if no <code>string</code> is supplied no title is added to environmental axis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns an invisible <code>data.frame</code> (used to produced the graph)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:

# year 2010
y2010raw &lt;- getTrac(tch$y2010, scale = .169)
y2010std &lt;- tracheider(y2010raw)
par(oma = c(2,1,1,0.5))
par(mar = c(2,4,1,4))
y2010LD &lt;- ringPlot(traq = y2010std, varMean = colMeans(sw),
varYear = sw["2010",], main=2010,type = "LD",  ylim = c(0,45),
ylab = expression(paste("LD (", mu,"m)")),varName = "Soil moisture")

# year 2013
y2013raw &lt;- getTrac(tch$y2013, scale = .169)
y2013std &lt;- tracheider(y2013raw)
y2013LD &lt;- ringPlot(traq = y2013std, varMean = colMeans(sw),
varYear = sw["2013",], main=2013,type = "LD",  ylim = c(0,45),
ylab = expression(paste("LD (", mu,"m)")),varName = "Soil moisture")

# 2010 &amp; 2013 in the same plot
par(mfcol = c(2,1))
par(oma = c(2,1,1,0.5))
par(mar = c(2,4,1,4))

ringPlot(y2010std,  varMean = colMeans(sw), varYear = sw["2010",],
type = "LD", ylab = "", main=2010, addGS = FALSE, addMonths = FALSE)

ringPlot(y2013std,  varMean = colMeans(sw), varYear = sw["2013",],
type = "LD", ylab=expression(paste("LD (", mu,"m)")),
main = 2013, addGS = TRUE, varName= "Soil moisture")

## End(not run)
</code></pre>

<hr>
<h2 id='sw'>
Monthly soil moisture data for the period 1901-2013.
</h2><span id='topic+sw'></span>

<h3>Description</h3>

<p>A data frame with monthly soil moisture values for the period 1901-2013.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sw")</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with months in columns and the years as rows (1901-2013). The months are the column names and the years are the row names.
</p>


<h3>Details</h3>

<p>...
</p>


<h3>Source</h3>

<p>...
</p>


<h3>References</h3>

<p>...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>colMeans(sw)
plot(colMeans(sw), type="l", xlab="months", ylab="soil water")
</code></pre>

<hr>
<h2 id='tch'>
Raw light intensity for two years (2010 and 2013) of Pinus pinaster
</h2><span id='topic+tch'></span>

<h3>Description</h3>

<p>This dataset has 2 years (2010 and 2013) each one with 3 raw profiles (in grayscale).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("tch")</code></pre>


<h3>Format</h3>

<p>A <code>list</code> with 2 elements:
</p>

<dl>
<dt>a <code>y2010</code></dt><dd><p>a list with 3 radii</p>
</dd>
<dt>a <code>y2013</code></dt><dd><p>a list with 3 radii</p>
</dd>
</dl>



<h3>Details</h3>

<p>...
</p>


<h3>Source</h3>

<p>...
</p>


<h3>References</h3>

<p>...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>names(tch)
names(tch$y2010)
</code></pre>

<hr>
<h2 id='tracheider'>Compute standardized tracheidograms</h2><span id='topic+tracheider'></span>

<h3>Description</h3>

<p>This function computes standardized tracheidograms from raw tracheidograms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tracheider(traq, method = c("nCells", "kCells", "relPos"), k = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tracheider_+3A_traq">traq</code></td>
<td>
<p>a raw tracheidogram (or a list of raw tracheidograms)</p>
</td></tr>
<tr><td><code id="tracheider_+3A_method">method</code></td>
<td>
<p>a <code>string</code> defining the <code>method</code> to be used. Possible values are c(&quot;nCells&quot;,&quot;kCells&quot;,&quot;relPos&quot;). The default method is &quot;nCells&quot;.</p>
</td></tr>
<tr><td><code id="tracheider_+3A_k">k</code></td>
<td>
<p>a integer to determine the number of cells of the standardized tracheidogram when <code>method</code> is &quot;kCells&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes as input raw tracheidograms (obtained using the <code>getTrac</code> function) and standardizes them using 3 different methods. The first method (&quot;nCells&quot;) standardizes rays of a given ring using the mean number of cells, allowing that different rings have different number of cells. The method &quot;kCells&quot; normalizes tracheidograms to a constant number of tracheids (<code>k</code>). The &quot;relPos&quot; method standardizes the tracheidogram based on the relative position of each tracheid inside the tree ring.
</p>


<h3>Value</h3>

<p>the function <code>tracheider</code> returns a list with the following elements:
</p>
<p><code>LD</code> ordered sequence of lumen diameters.
</p>
<p><code>CWT</code> ordered sequence of radial cell wall thikness.
</p>
<p><code>LWratio</code> ordered sequence of LD/CWT ratio.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:
y2010 &lt;- getTrac(tch$'y2010', scale=0.169)
y2013 &lt;- getTrac(tch$'y2013', scale=0.169)

## nCells
y2010n &lt;- tracheider(y2010, method = "nCells")
y2013n &lt;- tracheider(y2013, method = "nCells")
plot(rowMeans(as.data.frame(y2010n$LD)), type="l", xlim=c(0,86),
     ylim=c(0,60), yaxs="i", xaxs="i", xlab="Number of tracheid",
     ylab=expression(paste("LD (", mu,"m)")), col=2, lwd=2)
lines(rowMeans(as.data.frame(y2013n$LD)), col="blue", lwd=2)
legend("topright",lty=1,lwd=2,col = c(2,4), legend=c("2010 ","2013 "),
        text.col = c(2,4), box.col = "#00000000", bg="#00000000")

## k = 53
TCH &lt;- lapply(tch, getTrac, scale=0.169)
TCHn53 &lt;- lapply(TCH, tracheider,method = "kCells", k=53)

plot(rowMeans(as.data.frame(TCHn53$'y2010'$LD)), type="l",
     xlab="Number of tracheid", ylab=expression(paste("LD (", mu,"m)")),
     xlim=c(0,54), ylim=c(0,60), col=2, lwd=2, yaxs="i", xaxs="i")
lines(rowMeans(as.data.frame(TCHn53$'y2013'$LD)), col="blue", lwd=2)
legend("topright",lty=1,lwd=2,col = c(2,4),legend=c("2010 ","2013 "),
     text.col = c(2,4), box.col = "#00000000", bg="#00000000")

## Relative position
TCH &lt;- lapply(tch, getTrac, scale=0.169)
TCHrelPos &lt;- lapply(TCH, tracheider, method ="relPos")
plot(rowMeans(as.data.frame(TCHrelPos$'y2010'$LD)),
     type="l", xlim=c(0,101), ylim=c(0,60), col=2, lwd=2,
     xlab="Number of tracheid", ylab=expression(paste("LD (", mu,"m)")),
     yaxs="i", xaxs="i")
lines(rowMeans(as.data.frame(TCHrelPos$'y2013'$LD)),
      col="blue", lwd=2)
legend("topright",lty=1,lwd=2,col = c(2,4), legend=c("2010 ","2013 "),
       text.col = c(2,4), box.col = "#00000000", bg="#00000000")
## End(not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
