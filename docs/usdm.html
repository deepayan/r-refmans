<!DOCTYPE html><html><head><title>Help for package usdm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {usdm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#usdm-package'>
<p>Uncertainty analysis for SDMs</p></a></li>
<li><a href='#exclude'><p>Excluding variables specified in a VIF object</p></a></li>
<li><a href='#lisa'><p>Local indicators of spatial association</p></a></li>
<li><a href='#plot.RasterVariogram'><p>Plot variogram or variogram cloud or boxplot based on variogram cloud</p></a></li>
<li><a href='#plot.speciesLISA'><p>Plot positional uncertainty based on LISA</p></a></li>
<li><a href='#RasterVariogram-class'><p> RasterVariogram class</p></a></li>
<li><a href='#speciesLisa'><p>LISA in predictors at species occurrence locations</p></a></li>
<li><a href='#speciesLISA-class'><p> speciesLISA class</p></a></li>
<li><a href='#Variogram'><p>Empirical variogram for raster data</p></a></li>
<li><a href='#vif'><p>Variance Inflation Factor and test for multicollinearity</p></a></li>
<li><a href='#VIF-class'><p> VIF class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Uncertainty Analysis for Species Distribution Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1-7</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-29</td>
</tr>
<tr>
<td>Author:</td>
<td>Babak Naimi</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, terra</td>
</tr>
<tr>
<td>Imports:</td>
<td>raster</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Babak Naimi &lt;naimi.b@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This is a framework that aims to provide methods and tools for assessing the impact of different sources of uncertainties (e.g.positional uncertainty) on performance of species distribution models (SDMs).)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-gis.net/">https://r-gis.net/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-29 01:45:47 UTC; babak</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-29 04:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='usdm-package'>
Uncertainty analysis for SDMs
</h2><span id='topic+usdm-package'></span><span id='topic+usdm'></span>

<h3>Description</h3>

<p>This package provides a number of functions for exploring the impact of different sources of uncertainties (e.g.positional uncertainty) on performance of species distribution models (SDMs).
</p>
<p>In addition, there is a function to quantify different local indicators of spatial association (LISA) for raster data.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>

<hr>
<h2 id='exclude'>Excluding variables specified in a VIF object</h2><span id='topic+exclude'></span><span id='topic+exclude+2CRasterStack+2CVIF-method'></span><span id='topic+exclude+2CRasterBrick+2CVIF-method'></span><span id='topic+exclude+2CSpatRaster+2CVIF-method'></span><span id='topic+exclude+2Cdata.frame+2CVIF-method'></span><span id='topic+exclude+2Cmatrix+2CVIF-method'></span><span id='topic+exclude+2CRasterStack+2Cmissing-method'></span><span id='topic+exclude+2CRasterBrick+2Cmissing-method'></span><span id='topic+exclude+2Cdata.frame+2Cmissing-method'></span><span id='topic+exclude+2Cmatrix+2Cmissing-method'></span><span id='topic+exclude+2CSpatRaster+2Cmissing-method'></span>

<h3>Description</h3>

<p>Phisically exclude the collinear variables which are identified using <code>vifcor</code> or <code>vifstep</code> from a set of variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>exclude(x, vif, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exclude_+3A_x">x</code></td>
<td>
<p> explanatory variables (predictors), defined as a raster object (<code>RasterStack</code> or <code>RasterBrick</code>), or as a <code>matrix</code>, or as a <code>data.frame</code>. </p>
</td></tr>
<tr><td><code id="exclude_+3A_vif">vif</code></td>
<td>
<p> an object of class <code>VIF</code>, resulted from  <code>vifcor</code> or <code>vifstep</code> functions.</p>
</td></tr>
<tr><td><code id="exclude_+3A_...">...</code></td>
<td>
<p> additional argument as in <code>vifstep</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Before using this function, you should execute one of <code>vifstep</code> or <code>vifcor</code> which detect collinearity based on calculating variance inflation factor (VIF) statistics. If <code>vif</code> is missing, then <code>vifstep</code> is called.</p>


<h3>Value</h3>

<p>an object of class same as <code>x</code> (i.e. <code>RasterStack</code> or <code>RasterBrick</code> or <code>data.frame</code> or <code>matrix</code>)
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>IF you used this method, please cite the following article for which this package is developed:
</p>
<p>Naimi, B., Hamm, N.A.S., Groen, T.A., Skidmore, A.K., and Toxopeus, A.G. 
2014. Where is positional uncertainty a problem for species distribution modelling?, Ecography 37 (2): 191-203.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+vif">vif</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/spain.tif", package="usdm")

r &lt;- rast(file) # reading a RasterBrick object including 10 raster layers in Spain

r 

vif(r) # calculates vif for the variables in r

v1 &lt;- vifcor(r, th=0.9) # identify collinear variables that should be excluded

v1

re1 &lt;- exclude(r,v1) # exclude the collinear variables that were identified in 
# the previous step

re1

v2 &lt;- vifstep(r, th=10) # identify collinear variables that should be excluded

v2

re2 &lt;- exclude(r, v2) # exclude the collinear variables that were identified in 
# the previous step

re2

re3 &lt;- exclude(r) # first, vifstep is called 


re3

## End(Not run)
</code></pre>

<hr>
<h2 id='lisa'>Local indicators of spatial association</h2><span id='topic+lisa'></span><span id='topic+lisa+2CRaster+2Cmissing-method'></span><span id='topic+lisa+2CSpatRaster+2Cmissing-method'></span><span id='topic+lisa+2CSpatRaster+2CSpatVector-method'></span><span id='topic+lisa+2CRaster+2CSpatialPoints-method'></span><span id='topic+lisa+2CRaster+2CSpatialPointsDataFrame-method'></span>

<h3>Description</h3>

<p>Calculate different statistics of local indicator of spatial association (LISA) for each cell in a raster data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lisa(x, y, d1=0, d2, cell, statistic="I") 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lisa_+3A_x">x</code></td>
<td>
<p> a raster object (<code>RasterLayer</code> or <code>RasterStack</code> or <code>RasterBrick</code>) </p>
</td></tr>
<tr><td><code id="lisa_+3A_y">y</code></td>
<td>
<p> a <code>SpatialPoints</code> object (optional)   </p>
</td></tr>
<tr><td><code id="lisa_+3A_d1">d1</code></td>
<td>
<p> numeric. A number (distance), specifies local neighborhood size. Default is 0, means that the local neighborhood starts from the cell (distance = 0) and ends to a distance = d2 </p>
</td></tr>
<tr><td><code id="lisa_+3A_d2">d2</code></td>
<td>
<p> numeric. A number (distance), specifies local neighborhood size. It specifies the distance to which should be considered as a local neighborhood around a cell</p>
</td></tr>
<tr><td><code id="lisa_+3A_cell">cell</code></td>
<td>
<p> numeric (optional). A cell number or a vector of cell numbers in the Raster object, at which LISA should be calculated</p>
</td></tr>
<tr><td><code id="lisa_+3A_statistic">statistic</code></td>
<td>
<p> a character string specifying the LISA statistic that should be calculated. This can be one of &quot;I&quot;, &quot;c&quot;, &quot;G&quot;, &quot;G*&quot;, and &quot;K1&quot; </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can calculate different LISA statistics at each grid cell in Raster object. The statistics, implemented in this function, include local Moran's I (&quot;I&quot;), local Geary's c (&quot;c&quot;), local G and G* (&quot;G&quot; and &quot;G*&quot;), and local K1 statistics. This function returns standardized value (Z) for Moran, G and G*, and K1 statistics. If a <code>SpatialPoints</code> or a vector of numbers is defined for <code>y</code> or <code>cell</code>, the LISA is calculated only for the specified locations by points or cells.
</p>
<p>Note: A set of similar functions have been implemented in the <code>elsa</code> package by the author of this package, and since the computation part of elsa is written in C programming language, the function in elsa is much faster.
</p>


<h3>Value</h3>

<table>
<tr><td><code>RasterLayer</code></td>
<td>
<p>if <code>x</code> is a <code>RasterLayer</code> and both <code>y</code> and <code>cell</code> are missed</p>
</td></tr>
<tr><td><code>RasterBrick</code></td>
<td>
<p>if <code>x</code> is a <code>RasterStack</code> or a <code>RasterBrick</code> and both <code>y</code> and <code>cell</code> are missed</p>
</td></tr>
<tr><td><code>numeric vector</code></td>
<td>
<p>if <code>y</code> or <code>cell</code> is specified</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Anselin, L. 1995. Local indicators of spatial association, Geographical Analysis, 27, 93&ndash;115;
</p>
<p>Getis, A. and Ord, J. K. 1996 Local spatial statistics: an overview. In P. Longley and M. Batty (eds) <em>Spatial analysis: modelling in a GIS environment</em> (Cambridge: Geoinformation International), 261&ndash;277.
</p>
<p>Naimi, B., Hamm, N.A.S., Groen, T.A., Skidmore, A.K., and Toxopeus, A.G. 
2014. Where is positional uncertainty a problem for species distribution modelling?, Ecography 37 (2): 191-203.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 


file &lt;- system.file("external/spain.tif", package="usdm")

r &lt;- rast(file) # reading a RasterBrick object including 10 rasters in Spain

r

plot(r) # visualize the raster layers

plot(r[[1]]) # visualize the first raster layer

r.I &lt;- lisa(x=r[[1]],d1=0,d2=25000,statistic="I") # local Moran's I

plot(r.I)

# entering r instead of r[[1]], givees the indicator for each layer:
r.I &lt;- lisa(x=r,d1=0,d2=25000,statistic="I")
plot(r.I)

r.c &lt;- lisa(x=r[[1]],d1=0,d2=25000,statistic="c") # local Geary's c

plot(r.c)

r.g &lt;- lisa(x=r[[1]],d1=0,d2=25000,statistic="G") # G statistic

plot(r.g)

r.g2 &lt;- lisa(x=r[[1]],d1=0,d2=25000,statistic="G*") # G* statistic

plot(r.g2)

r.K1 &lt;- lisa(x=r[[1]],d1=0,d2=30000,statistic="K1") # gives K1 statistic for each layer

plot(r.K1)

lisa(x=r,d1=0,d2=30000,cell=2000,statistic="I") # gives local Moran's I at cell number 2000
#for each raster layer in r

lisa(x=r,d1=0,d2=30000,cell=c(2000,2002,2003),statistic="c") # calculates local Moran's I
# at cell numbers of 2000,2002, and 2003 for each raster layer in r

sp &lt;- sampleRandom(r[[1]],20,sp=TRUE) # draw 20 random points from r, 
# and returns a SpatialPointsDataFrame

plot(r[[1]])

points(sp)

lisa(x=r,y=sp,d1=0,d2=30000,statistic="I") # calculates the local Moran's I at 
# point locations in sp for each raster layer in r

## End(Not run)


</code></pre>

<hr>
<h2 id='plot.RasterVariogram'>Plot variogram or variogram cloud or boxplot based on variogram cloud</h2><span id='topic+plot.RasterVariogram'></span><span id='topic+plot+2CRasterVariogram-method'></span>

<h3>Description</h3>

<p>Plot the variogram computed for raster data by <code>Variogram</code> function </p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S4 method for signature 'RasterVariogram'
plot(x, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.RasterVariogram_+3A_x">x</code></td>
<td>
<p> an object of class <code>RasterVariogram</code>, which is the output of <code><a href="#topic+Variogram">Variogram</a></code> function. </p>
</td></tr>
<tr><td><code id="plot.RasterVariogram_+3A_...">...</code></td>
<td>
<p> additional argument (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plot the empirical variogram, or variogram cloud if <code>cloud</code> set to <code>TRUE</code> or a boxplot of variogram cloud data if <code>box</code> set to <code>TRUE</code>,
</p>
<p>Below are additional arguments:
</p>
<p><code>cloud</code> logical. If <code>TRUE</code>, the function plots variogram cloud. 
<code>box</code> logical. If <code>TRUE</code>, the function plots boxplot of variogram cloud.
<code>...</code> <code>xlab</code>, <code>ylab</code> and <code>main</code> and other arguments are same as the base <code>plot</code> function.
</p>


<h3>Value</h3>

<p>plots the variogram.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
<a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+Variogram">Variogram</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("external/spain.tif", package="usdm")

r &lt;- rast(file) # reading a RasterBrick including 5 rasters (predictor variables)

r 

plot(r[[1]]) # visualize the raster layers

v1 &lt;- Variogram(r[[1]]) # compute variogram for the first raster


plot(v1)

plot(v1,cloud=TRUE)

plot(v1,box=TRUE)

</code></pre>

<hr>
<h2 id='plot.speciesLISA'>Plot positional uncertainty based on LISA</h2><span id='topic+plot.speciesLISA'></span><span id='topic+plot+2CspeciesLISA+2Cmissing-method'></span><span id='topic+plot+2CspeciesLISA+2CSpatialPolygons-method'></span><span id='topic+plot+2CspeciesLISA+2CSpatialPolygonsDataFrame-method'></span><span id='topic+plot+2CspeciesLISA+2CSpatVector-method'></span>

<h3>Description</h3>

<p>Plot the values of LISAs at species occurrence locations, which can be used to identify the locations that need positional uncertainty treatment. </p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S4 method for signature 'speciesLISA,missing'
plot(x, y, ...)
## S4 method for signature 'speciesLISA,SpatialPolygons'
plot(x, y, ...)
## S4 method for signature 'speciesLISA,SpatialPolygonsDataFrame'
plot(x, y, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.speciesLISA_+3A_x">x</code></td>
<td>
<p> an object of class <code>speciesLISA</code>, which is the output of <code><a href="#topic+speciesLisa">speciesLisa</a></code> function. </p>
</td></tr>
<tr><td><code id="plot.speciesLISA_+3A_y">y</code></td>
<td>
<p> optional. Boundary map of the study area, an object of class <code>SpatialPolygons</code>.</p>
</td></tr>
<tr><td><code id="plot.speciesLISA_+3A_...">...</code></td>
<td>
<p> additional argument (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a map (i.e. a bubble plot) in which the species points present the magnitude of LISA in predictors at the location as open or filled circles with different sizes.
</p>
<p>Below are additional arguments:
</p>
<p><code>cex</code> the maximum symbol size (circle) in the plot. 
<code>levels</code> specifies the number of LISA levels at which the points are presented .
<code>xyLegend</code> a vector with two numbers, specifying the coordinates of the legend. If missing, the function tries to find the appropriate location for it.
<code>...</code> <code>xlab</code>, <code>ylab</code> and <code>main</code> same as the base <code>plot</code> function.
</p>


<h3>Value</h3>

<p>plots the bubble plot.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+speciesLisa">speciesLisa</a></code>, <code><a href="#topic+lisa">lisa</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("external/predictors.tif", package="usdm")

r &lt;- rast(file) # reading a RasterBrick object including 4 rasters in the Netherlands

r 

plot(r) # visualize the raster layers

sp.file &lt;- system.file("external/species_nl.shp", package="usdm")
sp &lt;- vect(sp.file)


splisa &lt;- speciesLisa(x=r,y=sp,uncertainty=15000,weights=c(0.22,0.2,0.38,0.2))

splisa

plot(splisa)

bnd.file &lt;- system.file("external/boundary.shp", package="usdm")
bnd &lt;- vect(bnd.file) # reading the boundary map

plot(splisa,bnd)

#plot(splisa,bnd,levels=c(2,4,6,8))

#plot(splisa,bnd,levels=c(-5,-3,0,3,5))

</code></pre>

<hr>
<h2 id='RasterVariogram-class'> RasterVariogram class</h2><span id='topic+RasterVariogram-class'></span><span id='topic+show+2CRasterVariogram-method'></span>

<h3>Description</h3>

<p>An object of the <code>RasterVariogram</code> class contains information about the empirical variogram of a raster data. The object can be created with the function:  <code><a href="#topic+Variogram">Variogram</a></code>.
</p>


<h3>Slots</h3>

<p>Slots for speciesLISA object:
</p>

<dl>
<dt><code>lag</code>:</dt><dd><p>a number specifying lag distance</p>
</dd> 
<dt><code>nlags</code>:</dt><dd><p>a number specifying number of lags based on cutoff parameter</p>
</dd>
<dt><code>variogramCloud</code>:</dt><dd><p><code>matrix</code>, including semivariance for all pairs</p>
</dd>
<dt><code>variogram</code>:</dt><dd><p><code>data.frame</code>, including binned semivariance within each lag </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi@r-gis.net">naimi@r-gis.net</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("speciesLISA")
</code></pre>

<hr>
<h2 id='speciesLisa'>LISA in predictors at species occurrence locations</h2><span id='topic+speciesLisa'></span><span id='topic+speciesLisa+2CRaster+2CSpatialPoints-method'></span><span id='topic+speciesLisa+2CRaster+2CSpatialPointsDataFrame-method'></span><span id='topic+speciesLisa+2CSpatRaster+2CSpatVector-method'></span>

<h3>Description</h3>

<p>Given a level of positional uncertainty (defined as a distance), this function calculates different statistics of local indicator of spatial association (LISA) in predictors (explanatory variables, defined as a raster object) at each species occurrence location (defined as a SpatialPoints object). According to Naimi et al. 2012, this can be used to understand whether positional uncertainty at which species locations are likely to affect predictive performance of species distribution models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>speciesLisa(x, y, uncertainty, statistic="K1",weights) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="speciesLisa_+3A_x">x</code></td>
<td>
<p> explanatory variables (predictors), defined as a raster object (<code>RasterLayer</code> or <code>RasterStack</code> or <code>RasterBrick</code>) </p>
</td></tr>
<tr><td><code id="speciesLisa_+3A_y">y</code></td>
<td>
<p> species occurrence points, defined as a <code>SpatialPoints</code> or <code>SpatialPointsDataFrame</code> object   </p>
</td></tr>
<tr><td><code id="speciesLisa_+3A_uncertainty">uncertainty</code></td>
<td>
<p> level of positional uncertainty, defined as a number (distance)</p>
</td></tr>
<tr><td><code id="speciesLisa_+3A_statistic">statistic</code></td>
<td>
<p> a character string specifying the LISA statistic that should be calculated. This can be one of &quot;I&quot;, &quot;c&quot;, &quot;G&quot;, &quot;G*&quot;, and &quot;K1&quot;. Default is &quot;K1&quot; </p>
</td></tr>
<tr><td><code id="speciesLisa_+3A_weights">weights</code></td>
<td>
<p> a numeric vector specifying the relative importance of explanatory variables in species distribution models (the first value in the <code>weights</code>, is the importance of the first variable in <code>x</code>, and ...). These values will be used as weights to aggregate the LISAs in predictors at each location and calculate a single measure. The length of weights should be equal to the number of raster layers in <code>x</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates a LISA statistic for each explanatory variable at each species point. Although several statistics including local Moran's I (&quot;I&quot;), local Geary's c (&quot;c&quot;), local G and G* (&quot;G&quot; and &quot;G*&quot;), and local K1 statistics, can be calculated, according to Naimi et al. (2012), &quot;K1&quot; statistic (default) is recommended.  This function returns a <code>speciesLISA</code> object, which includes species occurrence data, LISA statistic for each predictor at species locations, and an aggregated LISA statistic (a single LISA) at each species location, given the variable impotances. If weights in not specified, the equal weights (i.e. equal importance for explanatory variables) will be considered.
</p>


<h3>Value</h3>

<p><code>speciesLISA</code>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>IF you used this method, please cite the following article for which this package is developed:
</p>
<p>Naimi, B., Hamm, N.A.S., Groen, T.A., Skidmore, A.K., and Toxopeus, A.G. 
2014. Where is positional uncertainty a problem for species distribution modelling?, Ecography 37 (2): 191-203.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+lisa">lisa</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/predictors.tif", package="usdm")

r &lt;- rast(file) # reading a RasterBrick object including 4 rasters in the Netherlands

r 

plot(r) # visualize the raster layers

sp.file &lt;- system.file("external/species_nl.shp", package="usdm")
sp &lt;- vect(sp.file)


splisa &lt;- speciesLisa(x=r,y=sp,uncertainty=15000,weights=c(0.22,0.2,0.38,0.2))

splisa

plot(splisa)

bnd.file &lt;- system.file("external/boundary.shp", package="usdm")
bnd &lt;- vect(bnd.file) # reading the boundary map

plot(splisa,bnd)

## End(Not run)


</code></pre>

<hr>
<h2 id='speciesLISA-class'> speciesLISA class</h2><span id='topic+speciesLISA-class'></span><span id='topic+spoint-class'></span><span id='topic+print+2CspeciesLISA-method'></span>

<h3>Description</h3>

<p>An object of the <code>speciesLISA</code> class contains information about a local indicator of spatial association (LISA) statistic in predictor variables at the location of species occurrences. The object can be created with the function:  <code><a href="#topic+speciesLisa">speciesLisa</a></code>.
</p>


<h3>Slots</h3>

<p>Slots for speciesLISA object:
</p>

<dl>
<dt><code>species</code>:</dt><dd><p>object of class <code>SpatialPoints</code></p>
</dd> 
<dt><code>data</code>:</dt><dd><p><code>data.frame</code>, attribute table of species points</p>
</dd>
<dt><code>LISAs</code>:</dt><dd><p><code>matrix</code>, LISA statistics for different predictors</p>
</dd>
<dt><code>weights</code>:</dt><dd><p><code>numeric</code>, the variable importance </p>
</dd>
<dt><code>statistic</code>:</dt><dd><p><code>character</code>, the name of LISA statistic </p>
</dd>
<dt><code>LISA</code>:</dt><dd><p><code>numeric</code>, aggregated LISAs at each species location </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("speciesLISA")
</code></pre>

<hr>
<h2 id='Variogram'>Empirical variogram for raster data</h2><span id='topic+Variogram'></span><span id='topic+Variogram+2CRasterLayer-method'></span><span id='topic+Variogram+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>Compute sample (empirical) variogram from raster data. The function returns a binned variogram and a variogram cloud.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Variogram(x, lag, cutoff, cells, size=100) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Variogram_+3A_x">x</code></td>
<td>
<p> a raster object (<code>RasterLayer</code>) </p>
</td></tr>
<tr><td><code id="Variogram_+3A_lag">lag</code></td>
<td>
<p> the lag size (width of subsequent distance intervals) into which cell pairs are grouped for semivariance estimates. If missing, the cell size (raster resolution) is assigned. </p>
</td></tr>
<tr><td><code id="Variogram_+3A_cutoff">cutoff</code></td>
<td>
<p> spatial separation distance up to which cell pairs are included in semivariance estimates; as a default, the length of the diagonal of the box spanning the data is divided by three. </p>
</td></tr>
<tr><td><code id="Variogram_+3A_cells">cells</code></td>
<td>
<p> numeric (optional). A vector of cell numbers in the Raster object. This forces the function to only consider these cells (and their neighbours) to compute the variogram.</p>
</td></tr>
<tr><td><code id="Variogram_+3A_size">size</code></td>
<td>
<p> positive integer specifying the number of cells to be drawn from raster object. If the number of cells in the raster object is large, a sample with the specified size is drawn to make the computation more efficient. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Variograms are widely used for exploring spatial structure in a single variable. Formally, it is defined as half the expected squared difference (half the variance of the difference) in the variable value at a specific geographical separation. A variogram summarizes the spatial relations in the data, and can be used to understand within what range (distance) the data is spatially autocorrelated. Naimi et al. (2011) linked this range to the impact of positional uncertainty on the performance of species distribution models (SDMs). Based on that study, examining variogram to find the effective autocorrelation range in predictors gives insight into whether predictions by SDMs are likely to be affected by the uncertainty in the sample locations (see Naimi et al. 2011, for more information).
</p>
<p>Note: A similar function has been implemented in the <code>elsa</code> package by the author of this package, and since the computation part of elsa is written in C programming language, the function in elsa is much faster.
</p>


<h3>Value</h3>

<table>
<tr><td><code>RasterVariogram</code></td>
<td>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Skidmore, A.K, Groen, T.A., Hamm, N.A.S. 2011. Spatial autocorrelation in predictors reduces the impact of positional uncertainty in occurrence data on species
distribution modelling, Journal of biogeography. 38: 1497-1509.
</p>
<p>Naimi, B., Hamm, N.A.S., Groen, T.A., Skidmore, A.K., and Toxopeus, A.G. 
2014. Where is positional uncertainty a problem for species distribution modelling?, Ecography 37 (2): 191-203.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/spain.tif", package="usdm")

r &lt;- rast(file) # reading a RasterBrick object including 10 raster layers in Spain

r 

plot(r[[1]]) # plot the first RasterLayer in r

v1 &lt;- Variogram(r[[1]]) # compute the sample variogram for the first layer in r

v2 &lt;- Variogram(r[[1]],lag=25000,cutoff=100000) # specify the lag and cutoff parameters

## End(Not run)

</code></pre>

<hr>
<h2 id='vif'>Variance Inflation Factor and test for multicollinearity</h2><span id='topic+vif'></span><span id='topic+vifcor'></span><span id='topic+vifstep'></span><span id='topic+vif+2CRasterStackBrick-method'></span><span id='topic+vif+2CSpatRaster-method'></span><span id='topic+vif+2Cdata.frame-method'></span><span id='topic+vif+2Cmatrix-method'></span><span id='topic+vifcor+2CRasterStackBrick-method'></span><span id='topic+vifcor+2CSpatRaster-method'></span><span id='topic+vifcor+2Cdata.frame-method'></span><span id='topic+vifcor+2Cmatrix-method'></span><span id='topic+vifstep+2CRasterStackBrick-method'></span><span id='topic+vifstep+2CSpatRaster-method'></span><span id='topic+vifstep+2Cdata.frame-method'></span><span id='topic+vifstep+2Cmatrix-method'></span>

<h3>Description</h3>

<p>Calculates variance inflation factor (VIF) for a set of variables and exclude the highly correlated variables from the set through a stepwise procedure. This method can be used to deal with multicollinearity problems when you fit statistical models</p>


<h3>Usage</h3>

<pre><code class='language-R'>vif(x, size, ...)
vifcor(x, th = 0.9, keep = NULL, size, method = 'pearson', ...)
vifstep(x, th = 10, keep = NULL, size, method = 'pearson', ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vif_+3A_x">x</code></td>
<td>
<p> Numeric explanatory variables (predictors), defined as a raster object (<code>RasterStack</code> or <code>RasterBrick</code> or <code>SpatRaster</code>), or as a <code>matrix</code>, or as a <code>data.frame</code>. </p>
</td></tr>
<tr><td><code id="vif_+3A_th">th</code></td>
<td>
<p> a numeric value specifying the correlation threshold for vifcor, and VIF threshold for vifstep (see details).</p>
</td></tr>
<tr><td><code id="vif_+3A_keep">keep</code></td>
<td>
<p>A character vector with the name of variables that should not be excluded even if they are collinear, e.g., because of ecological reasons</p>
</td></tr>
<tr><td><code id="vif_+3A_size">size</code></td>
<td>
<p>When the data is big, a random sample of the records (cells from raster or rows from data.frame) with the specified size is selected; default is 5000.</p>
</td></tr>
<tr><td><code id="vif_+3A_method">method</code></td>
<td>
<p>a chatacter (one of c(&quot;pearson&quot;,&quot;spearman&quot;,&quot;kendall&quot;)) specifies the method to calculate a pairwise correlation; deafult=&quot;pearson&quot;.</p>
</td></tr>
<tr><td><code id="vif_+3A_...">...</code></td>
<td>
<p>not implemented.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>VIF can be used to detect collinearity (Strong correlation between two or more predictor variables). Collinearity causes instability in parameter estimation in regression-type models. The VIF is based on the square of the multiple correlation coefficient resulting from regressing a predictor variable against all other predictor variables. If a variable has a strong linear relationship with at least one other variables, the correlation coefficient would be close to 1, and VIF for that variable would be large.  A VIF greater than 10 is a signal that the model has a collinearity problem. <code>vif</code> function calculates this statistic for all variables in <code>x</code>. <code>vifcor</code> and <code>vifstep</code> uses two different strategy to exclude highly collinear variable through a stepwise procedure. 
</p>
<p>- <code>vifcor</code>, first finds a pair of variables which has the maximum linear correlation (greater than the threshold; th), and exclude the one with a greater VIF. The procedure is repeated untill no pair of variables with a high corrrelation coefficient (grater than the threshold) remains. 
</p>
<p>- <code>vifstep</code> calculates VIF for all variables, excludes the one with the highest VIF (if it is greater than the threshold), repeat the procedure untill no variables with a VIF greater than <code>th</code> remains.
</p>
<p>addtional arguments:
</p>
<p><code>method</code> default is &quot;pearson&quot;, specifies the correlation method (one'pearson','kendall','spearman')
</p>
<p><code>size</code> a number (default=5000) specifying the maximum number of observations should be contributed in calculation of VIF. When the number of observations (cells in raster or rows in data.frame/matrix) is greater than <code>size</code>, then a random sample with a size of <code>size</code> is drawn to keep the calculation effecient.
</p>
<p><code>keep</code>: sometimes we may have strong biological/ecological justification to keep some variables in the model even if the statistical calculations suggest otherwise. In that case, the <code>keep</code> argument can help to introduce the name of such variables (or the number specifying which columns in data.frame or which layers in raster object should be kept) to the functions, then the stepwise procedure take them into account to find which variables should be excluded.
</p>


<h3>Value</h3>

<p>an object of class <code>VIF</code>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Chatterjee, S. and Hadi, A. S. 2006. Regression analysis by example. John Wiley and Sons.;
</p>
<p>Dormann, C. F. et al. 2012. Collinearity: A review of methods to Deal with it and a simulation study evaluating their performance. Ecography 35: 001-020.;
</p>
<p>&mdash;&mdash;&mdash;&mdash;&ndash;
</p>
<p>IF you used this method, please cite the following article for which this package is developed:
</p>
<p>Naimi, B., Hamm, N.A.S., Groen, T.A., Skidmore, A.K., and Toxopeus, A.G. 
2014. Where is positional uncertainty a problem for species distribution modelling?, Ecography 37 (2): 191-203.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+exclude">exclude</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/spain.tif", package="usdm")

r &lt;- rast(file) # reading a SpatRaster object including 10 raster layers in Spain

r 

vif(r) # calculates vif for the variables in r

v1 &lt;- vifcor(r, th=0.9) # identify collinear variables that should be excluded

v1

v2 &lt;- vifstep(r, th=10) # identify collinear variables that should be excluded

v2

v3 &lt;- vifstep(r, th=10, keep = c('Bio4','Bio10')) 

v3


## End(Not run)
</code></pre>

<hr>
<h2 id='VIF-class'> VIF class</h2><span id='topic+VIF-class'></span><span id='topic+show+2CVIF-method'></span>

<h3>Description</h3>

<p>An object of the <code>VIF</code> class contains information about collinearity in relavant variables. The object can be created with the following functions:  <code><a href="#topic+vifcor">vifcor</a></code> and <code><a href="#topic+vifstep">vifstep</a></code>.
</p>


<h3>Slots</h3>

<p>Slots for VIF object
</p>

<dl>
<dt><code>variables</code>:</dt><dd><p>Character</p>
</dd> 
<dt><code>excluded</code>:</dt><dd><p>character</p>
</dd>
<dt><code>corMatrix</code>:</dt><dd><p>a correlation <code>matrix</code></p>
</dd>
<dt><code>results</code>:</dt><dd><p><code>data.frame</code> including VIF values for the remained (not excluded) variables </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("VIF")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
