<!DOCTYPE html><html><head><title>Help for package CDVineCopulaConditional</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CDVineCopulaConditional}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CDVineCondFit'><p>Selection of a C- or D- vine copula model for conditional sampling</p></a></li>
<li><a href='#CDVineCondListMatrices'><p>List of the possible C- and D- vines allowing for conditional simulation</p></a></li>
<li><a href='#CDVineCondRank'><p>Ranking of C- and D- vines allowing for conditional simulation</p></a></li>
<li><a href='#CDVineCondSim'><p>Simulation from a conditional C- or D-vine</p></a></li>
<li><a href='#dataset'><p>Random dataset from a given vine copula model</p></a></li>
<li><a href='#overplot'><p>overplot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-03-01 today</td>
</tr>
<tr>
<td>Title:</td>
<td>Sampling from Conditional C- and D-Vine Copulas</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for sampling from a conditional copula density decomposed via 
     Pair-Copula Constructions as C- or D- vine. Here, the vines which can be used for such a 
     sampling are those which sample as first the conditioning variables (when following the 
     sampling algorithms shown in Aas et al. (2009) &lt;<a href="https://doi.org/10.1016%2Fj.insmatheco.2007.02.001">doi:10.1016/j.insmatheco.2007.02.001</a>&gt;). 
     The used sampling algorithm is presented and discussed in Bevacqua et al. (2017) 
     &lt;<a href="https://doi.org/10.5194%2Fhess-2016-652">doi:10.5194/hess-2016-652</a>&gt;, and it is a modified version of that from Aas et al. (2009) 
     &lt;<a href="https://doi.org/10.1016%2Fj.insmatheco.2007.02.001">doi:10.1016/j.insmatheco.2007.02.001</a>&gt;. A function is available to select the best vine 
     (based on information criteria) among those which allow for such a conditional sampling. 
     The package includes a function to compare scatterplot matrices and pair-dependencies of 
     two multivariate datasets.</td>
</tr>
<tr>
<td>Author:</td>
<td>Emanuele Bevacqua [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emanuele Bevacqua &lt;emanuele.bevacqua@uni-graz.at&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>combinat, graphics, stats, VineCopula</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-07-28 14:25:59 UTC; emanuele</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-07-28 17:20:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='CDVineCondFit'>Selection of a C- or D- vine copula model for conditional sampling</h2><span id='topic+CDVineCondFit'></span>

<h3>Description</h3>

<p>This function fits either a C- or a D- vine model to a d-dimensional dataset of uniform variables. 
The fit of the pair-copula families is performed sequentially through the function <code><a href="VineCopula.html#topic+RVineCopSelect">RVineCopSelect</a></code> of 
the package <code>VineCopula</code>. The vine structure is selected among a group of C- and a D- vines which satisfy the requirement 
discussed in <em>Bevacqua et al. (2017)</em>. This group is composed by all C- and D- vines from which the conditioning variables 
would be sampled as first when following the algorithms from <em>Aas et al. (2009)</em>. Alternatively, if the 
vine matrix describing the vine structure is given to the function, the fit of the pair-copulas is directly performed skipping the vine structure 
selection procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDVineCondFit(data, Nx, treecrit = "AIC", type = "CVine-DVine",
  selectioncrit = "AIC", familyset = NA, indeptest = FALSE,
  level = 0.05, se = FALSE, rotations = TRUE, method = "mle",
  Matrix = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CDVineCondFit_+3A_data">data</code></td>
<td>
<p>An <code>N x d</code> data matrix (with uniform margins).
The data of the conditioning variable(s) have to occupy the last column(s) of this matrix.</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_nx">Nx</code></td>
<td>
<p>Number of conditioning variables.</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_treecrit">treecrit</code></td>
<td>
<p>Character indicating the criteria used to select the vine. All possible vines are fitted trough 
the function <code><a href="VineCopula.html#topic+RVineCopSelect">RVineCopSelect</a></code> of the package <code>VineCopula</code>. Then the vines are ranked with respect 
the Akaike information criterion (<code>treecrit = "AIC"</code>, default) or Bayesian information criterion (<code>treecrit = "BIC"</code>). 
This need the estimation and model selection for all the pairs of all the possible vines, therefore could 
require long time in case of large datasets, i.e. large <code>N x d</code>.</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_type">type</code></td>
<td>
<p>Type of vine to be fitted: <br />
C-Vine: &quot;CVine&quot; or 1; <br />
D-Vine: &quot;DVine&quot; or 2; <br />
Both C and D-Vine: &quot;CVine-DVine&quot; or &quot;1-2&quot; (default).</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_selectioncrit">selectioncrit</code></td>
<td>
<p>Character indicating the criterion for pair-copula selection.
Possible choices are <code>"AIC"</code> (default) and <code>"BIC"</code>.</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_familyset">familyset</code></td>
<td>
<p>&quot;Integer vector of pair-copula families to select from. The vector has to include at least one
pair-copula family that allows for positive and one that allows for negative
dependence. Not listed copula families might be included to better handle
limit cases.  If <code>familyset = NA</code> (default), selection among all
possible families is performed. If a vector of negative numbers is provided,
selection among all but <code>abs(familyset)</code> is performed. Coding of bivariate copula families: <br />
<code>0</code> = independence copula <br />
<code>1</code> = Gaussian copula <br />
<code>2</code> = Student t copula (t-copula) <br />
<code>3</code> = Clayton copula <br />
<code>4</code> = Gumbel copula <br />
<code>5</code> = Frank copula <br />
<code>6</code> = Joe copula <br />
<code>7</code> = BB1 copula <br />
<code>8</code> = BB6 copula <br />
<code>9</code> = BB7 copula <br />
<code>10</code> = BB8 copula <br />
<code>13</code> = rotated Clayton copula (180 degrees; &ldquo;survival Clayton&rdquo;) <br />
<code>14</code> = rotated Gumbel copula (180 degrees; &ldquo;survival Gumbel&rdquo;) <br />
<code>16</code> = rotated Joe copula (180 degrees; &ldquo;survival Joe&rdquo;) <br />
<code>17</code> = rotated BB1 copula (180 degrees; &ldquo;survival BB1&rdquo;)<br />
<code>18</code> = rotated BB6 copula (180 degrees; &ldquo;survival BB6&rdquo;)<br />
<code>19</code> = rotated BB7 copula (180 degrees; &ldquo;survival BB7&rdquo;)<br />
<code>20</code> = rotated BB8 copula (180 degrees; &ldquo;survival BB8&rdquo;)<br />
<code>23</code> = rotated Clayton copula (90 degrees) <br />
<code>24</code> = rotated Gumbel copula (90 degrees) <br />
<code>26</code> = rotated Joe copula (90 degrees) <br />
<code>27</code> = rotated BB1 copula (90 degrees) <br />
<code>28</code> = rotated BB6 copula (90 degrees) <br />
<code>29</code> = rotated BB7 copula (90 degrees) <br />
<code>30</code> = rotated BB8 copula (90 degrees) <br />
<code>33</code> = rotated Clayton copula (270 degrees) <br />
<code>34</code> = rotated Gumbel copula (270 degrees) <br />
<code>36</code> = rotated Joe copula (270 degrees) <br />
<code>37</code> = rotated BB1 copula (270 degrees) <br />
<code>38</code> = rotated BB6 copula (270 degrees) <br />
<code>39</code> = rotated BB7 copula (270 degrees) <br />
<code>40</code> = rotated BB8 copula (270 degrees) <br />
<code>104</code> = Tawn type 1 copula <br />
<code>114</code> = rotated Tawn type 1 copula (180 degrees) <br />
<code>124</code> = rotated Tawn type 1 copula (90 degrees) <br />
<code>134</code> = rotated Tawn type 1 copula (270 degrees) <br />
<code>204</code> = Tawn type 2 copula <br />
<code>214</code> = rotated Tawn type 2 copula (180 degrees) <br />
<code>224</code> = rotated Tawn type 2 copula (90 degrees) <br />
<code>234</code> = rotated Tawn type 2 copula (270 degrees)</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_indeptest">indeptest</code></td>
<td>
<p>Logical; whether a hypothesis test for the independence of
<code>u1</code> and <code>u2</code> is performed before bivariate copula selection
(default: <code>indeptest = FALSE</code>; see <code>BiCopIndTest</code>).  The
independence copula is chosen for a (conditional) pair if the null
hypothesis of independence cannot be rejected.</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_level">level</code></td>
<td>
<p>numeric; significance level of the independence test (default:
<code>level = 0.05</code>).</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_se">se</code></td>
<td>
<p>Logical; whether standard errors are estimated (default: <code>se
= FALSE</code>).</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_rotations">rotations</code></td>
<td>
<p>logical; if <code>TRUE</code>, all rotations of the families in
<code>familyset</code> are included.</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_method">method</code></td>
<td>
<p>indicates the estimation method: either maximum
likelihood estimation (<code>method = "mle"</code>; default) or inversion of
Kendall's tau (<code>method = "itau"</code>). For <code>method = "itau"</code> only
one parameter families and the Student t copula can be used (<code>family =
1,2,3,4,5,6,13,14,16,23,24,26,33,34</code> or <code>36</code>). For the t-copula,
<code>par2</code> is found by a crude profile likelihood optimization over the
interval (2, 10].&quot; (VineCopula Documentation, version 2.1.1, pp. 73-75)</p>
</td></tr>
<tr><td><code id="CDVineCondFit_+3A_matrix">Matrix</code></td>
<td>
<p><code>d x d</code> matrix that defines the vine structure. 
If <code>Matrix</code> is not given, the routine finds the best vine structure according to <code>selectioncrit</code>. 
If <code>Matrix</code> is given, the fit is performed only if the structure respects the necessary conditions 
for the conditional sampling (if the conditions are not respected, an error message is returned).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> object describing the selected copula model 
(for further details about <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> objects see the documentation file of the <code>VineCopula</code> package). 
The selected families are stored 
in <code>$family</code>, and the sequentially estimated parameters in <code>$par</code> and <code>$par2</code>. 
The fit of the model is performed via the function <code><a href="VineCopula.html#topic+RVineCopSelect">RVineCopSelect</a></code> of the package <code>VineCopula</code>.
</p>
<p>&quot;The object <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> includes the following information about the fit:
</p>

<dl>
<dt><code>se, se2</code></dt><dd><p>standard errors for the parameter estimates  (if <code>se = TRUE</code>; note that these are only 
approximate since they do not account for the sequential nature of the estimation,</p>
</dd>  
<dt><code>nobs</code></dt><dd><p>number of observations,</p>
</dd> 
<dt><code>logLik, pair.logLik</code></dt><dd><p>log likelihood (overall and pairwise)</p>
</dd> 
<dt><code>AIC, pair.AIC</code></dt><dd><p>Aikaike's Informaton Criterion (overall and pairwise),</p>
</dd> 
<dt><code>BIC, pair.BIC</code></dt><dd><p>Bayesian's Informaton Criterion (overall and pairwise),</p>
</dd> 
<dt><code>emptau</code></dt><dd><p>matrix of empirical values of Kendall's tau,</p>
</dd> 
<dt><code>p.value.indeptest</code></dt><dd><p>matrix of p-values of the independence test.</p>
</dd>
</dl>



<h3>Note</h3>

<p>For a comprehensive summary of the vine copula model, use
<code>summary(object)</code>; to see all its contents, use <code>str(object)</code>&quot;. (VineCopula Documentation, version 2.1.1, pp. 103)
</p>


<h3>Author(s)</h3>

<p>Emanuele Bevacqua
</p>


<h3>References</h3>

<p>Bevacqua, E., Maraun, D., Hobaek Haff, I., Widmann, M., and Vrac, M.: Multivariate statistical modelling of compound events via pair-copula constructions: analysis of floods in Ravenna (Italy), 
Hydrol. Earth Syst. Sci., 21, 2701-2723, https://doi.org/10.5194/hess-21-2701-2017, 2017.
<a href="https://www.researchgate.net/publication/317414374_Multivariate_statistical_modelling_of_compound_events_via_pair-copula_constructions_Analysis_of_floods_in_Ravenna_Italy">[link]</a> 
<a href="https://www.hydrol-earth-syst-sci.net/21/2701/2017/hess-21-2701-2017.html">[link]</a> 
</p>
<p>Aas, K., Czado, C., Frigessi, A. and Bakken, H.: Pair-copula constructions of multiple dependence, Insurance: 
Mathematics and Economics, 44(2), 182-198, &lt;doi:10.1016/j.insmatheco.2007.02.001&gt;, 2009.
<a href="http://www.sciencedirect.com/science/article/pii/S0167668707000194">[link]</a> 
</p>
<p>Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler, Thomas 
Nagler and Tobias Erhardt (2017). VineCopula: Statistical Inference of Vine Copulas. R 
package version 2.1.1. <a href="https://CRAN.R-project.org/package=VineCopula">[link]</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CDVineCondSim">CDVineCondSim</a></code>, <code><a href="#topic+CDVineCondRank">CDVineCondRank</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1

# Read data 
data(dataset) 
data &lt;- dataset$data[1:100,1:5]

# Define the variables Y and X. X are the conditioning variables, 
# which have to be positioned in the last columns of the data.frame
colnames(data) &lt;- c("Y1","Y2","X3","X4","X5")

## Not run: 
# Select and fit a C- vine copula model, requiring that the 
RVM &lt;- CDVineCondFit(data,Nx=3,treecrit="BIC",type="CVine",selectioncrit="AIC")
summary(RVM)
RVM$Matrix

## End(Not run)



# Example 2

# Read data 
data(dataset) 
data &lt;- dataset$data[1:80,1:5]

# Define the variables Y and X. X are the conditioning variables, 
# which have to be positioned in the last columns of the data.frame
colnames(data) &lt;- c("Y1","Y2","X3","X4","X5")

# Define a VineMatrix which can be used for conditional sampling
ListVines &lt;- CDVineCondListMatrices(data,Nx=3)
Matrix=ListVines$DVine[[1]]
Matrix

## Not run: 
# Fit copula families for the defined vine:
RVM &lt;- CDVineCondFit(data,Nx=3,Matrix=Matrix)
summary(RVM)
RVM$Matrix
RVM$family

# check
identical(RVM$Matrix,Matrix)

# Fit copula families for the defined vine, given a group of families to select from:
RVM &lt;- CDVineCondFit(data,Nx=3,Matrix=Matrix,familyset=c(1,2,3,14))
summary(RVM)
RVM$Matrix
RVM$family

# Try to fit copula families for a vine which is not among those 
# that allow for conditional sampling:
Matrix
Matrix[which(Matrix==4)]=40
Matrix[which(Matrix==2)]=20
Matrix[which(Matrix==40)]=2
Matrix[which(Matrix==20)]=4
Matrix
RVM &lt;- CDVineCondFit(data,Nx=3,Matrix=Matrix)
RVM

## End(Not run)

</code></pre>

<hr>
<h2 id='CDVineCondListMatrices'>List of the possible C- and D- vines allowing for conditional simulation</h2><span id='topic+CDVineCondListMatrices'></span>

<h3>Description</h3>

<p>Provides a list of the C- and D- vines which allow for conditional 
sampling, under the condition discussed in the descriprion of <code><a href="#topic+CDVineCondFit">CDVineCondFit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDVineCondListMatrices(data, Nx, type = "CVine-DVine")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CDVineCondListMatrices_+3A_data">data</code></td>
<td>
<p>An <code>N x d</code> data matrix.
Data of the conditioning variable(s) have to occupy the last column(s) of this matrix.</p>
</td></tr>
<tr><td><code id="CDVineCondListMatrices_+3A_nx">Nx</code></td>
<td>
<p>Number of conditioning variables.</p>
</td></tr>
<tr><td><code id="CDVineCondListMatrices_+3A_type">type</code></td>
<td>
<p>Type of vine to be considered: <br />
C-Vine: &quot;CVine&quot; or 1; <br />
D-Vine: &quot;DVine&quot; or 2; <br />
Both C and D-Vine: &quot;CVine-DVine&quot; or &quot;1-2&quot; (default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Listes of matrices describing C- (<code>$CVine</code>) and D- (<code>$DVine</code>) Vines. 
Each matrix corresponds to a vine, according to the same notation used for <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> 
objects (for further details about <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> objects see the documentation file of the <code>VineCopula</code> package). 
The index <code>i</code> in the matrix corresponds to the variable in the i-th column of <code>data</code>.
</p>


<h3>Author(s)</h3>

<p>Emanuele Bevacqua
</p>


<h3>References</h3>

<p>Bevacqua, E., Maraun, D., Hobaek Haff, I., Widmann, M., and Vrac, M.: Multivariate statistical modelling of compound events via pair-copula constructions: analysis of floods in Ravenna (Italy), 
Hydrol. Earth Syst. Sci., 21, 2701-2723, https://doi.org/10.5194/hess-21-2701-2017, 2017.
<a href="https://www.researchgate.net/publication/317414374_Multivariate_statistical_modelling_of_compound_events_via_pair-copula_constructions_Analysis_of_floods_in_Ravenna_Italy">[link]</a> 
<a href="https://www.hydrol-earth-syst-sci.net/21/2701/2017/hess-21-2701-2017.html">[link]</a> 
</p>
<p>Aas, K., Czado, C., Frigessi, A. and Bakken, H.: Pair-copula constructions of multiple dependence, Insurance:
Mathematics and Economics, 44(2), 182-198, &lt;doi:10.1016/j.insmatheco.2007.02.001&gt;, 2009. 
<a href="http://www.sciencedirect.com/science/article/pii/S0167668707000194">[link]</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CDVineCondFit">CDVineCondFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read data
data(dataset)
data &lt;- dataset$data[1:100,1:5]

# Define the variables Y and X. X are the conditioning variables, 
# which have to be positioned in the last columns of the data.frame
colnames(data) &lt;- c("Y1","Y2","X3","X4","X5")

# List possible D-Vines:
ListVines &lt;- CDVineCondListMatrices(data,Nx=3,"DVine")
ListVines$DVine

# List possible C-Vines:
ListVines &lt;- CDVineCondListMatrices(data,Nx=3,"CVine")
ListVines$CVine

# List possible C- and D-Vines:
ListVines &lt;- CDVineCondListMatrices(data,Nx=3,"CVine-DVine")
ListVines

</code></pre>

<hr>
<h2 id='CDVineCondRank'>Ranking of C- and D- vines allowing for conditional simulation</h2><span id='topic+CDVineCondRank'></span>

<h3>Description</h3>

<p>Provides a ranking of the C- and D- vines which allow for conditional 
sampling, under the condition discussed in the descriprion of <code><a href="#topic+CDVineCondFit">CDVineCondFit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDVineCondRank(data, Nx, treecrit = "AIC", selectioncrit = "AIC",
  familyset = NA, type = "CVine-DVine", indeptest = FALSE, level = 0.05,
  se = FALSE, rotations = TRUE, method = "mle")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CDVineCondRank_+3A_data">data</code></td>
<td>
<p>An <code>N x d</code> data matrix (with uniform margins).
Data of the conditioning variable(s) have to occupy the last column(s) of this matrix.</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_nx">Nx</code></td>
<td>
<p>Number of conditioning variables.</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_treecrit">treecrit</code></td>
<td>
<p>Character indicating the criteria used to select the vine. All possible vines are fitted trough 
the function <code><a href="VineCopula.html#topic+RVineCopSelect">RVineCopSelect</a></code> of the package <code>VineCopula</code>. Then the vines are ranked with respect 
the Akaike information criterion (<code>treecrit = "AIC"</code>, default) or Bayesian information criterion (<code>treecrit = "BIC"</code>). 
This need the estimation and model selection for all the pairs of all the possible vines, therefore could 
require long time in case of large datasets, i.e. large <code>N x d</code>.</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_selectioncrit">selectioncrit</code></td>
<td>
<p>Character indicating the criterion for pair-copula selection.
Possible choices are <code>selectioncrit = "AIC"</code> (default) and <code>"BIC"</code>.</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_familyset">familyset</code></td>
<td>
<p>&quot;Integer vector of pair-copula families to select from. The vector has to include at least one
pair-copula family that allows for positive and one that allows for negative
dependence. Not listed copula families might be included to better handle
limit cases.  If <code>familyset = NA</code> (default), selection among all
possible families is performed. If a vector of negative numbers is provided,
selection among all but <code>abs(familyset)</code> is performed. Coding of bivariate copula families: <br />
<code>0</code> = independence copula <br />
<code>1</code> = Gaussian copula <br />
<code>2</code> = Student t copula (t-copula) <br />
<code>3</code> = Clayton copula <br />
<code>4</code> = Gumbel copula <br />
<code>5</code> = Frank copula <br />
<code>6</code> = Joe copula <br />
<code>7</code> = BB1 copula <br />
<code>8</code> = BB6 copula <br />
<code>9</code> = BB7 copula <br />
<code>10</code> = BB8 copula <br />
<code>13</code> = rotated Clayton copula (180 degrees; &ldquo;survival Clayton&rdquo;) <br />
<code>14</code> = rotated Gumbel copula (180 degrees; &ldquo;survival Gumbel&rdquo;) <br />
<code>16</code> = rotated Joe copula (180 degrees; &ldquo;survival Joe&rdquo;) <br />
<code>17</code> = rotated BB1 copula (180 degrees; &ldquo;survival BB1&rdquo;)<br />
<code>18</code> = rotated BB6 copula (180 degrees; &ldquo;survival BB6&rdquo;)<br />
<code>19</code> = rotated BB7 copula (180 degrees; &ldquo;survival BB7&rdquo;)<br />
<code>20</code> = rotated BB8 copula (180 degrees; &ldquo;survival BB8&rdquo;)<br />
<code>23</code> = rotated Clayton copula (90 degrees) <br />
<code>24</code> = rotated Gumbel copula (90 degrees) <br />
<code>26</code> = rotated Joe copula (90 degrees) <br />
<code>27</code> = rotated BB1 copula (90 degrees) <br />
<code>28</code> = rotated BB6 copula (90 degrees) <br />
<code>29</code> = rotated BB7 copula (90 degrees) <br />
<code>30</code> = rotated BB8 copula (90 degrees) <br />
<code>33</code> = rotated Clayton copula (270 degrees) <br />
<code>34</code> = rotated Gumbel copula (270 degrees) <br />
<code>36</code> = rotated Joe copula (270 degrees) <br />
<code>37</code> = rotated BB1 copula (270 degrees) <br />
<code>38</code> = rotated BB6 copula (270 degrees) <br />
<code>39</code> = rotated BB7 copula (270 degrees) <br />
<code>40</code> = rotated BB8 copula (270 degrees) <br />
<code>104</code> = Tawn type 1 copula <br />
<code>114</code> = rotated Tawn type 1 copula (180 degrees) <br />
<code>124</code> = rotated Tawn type 1 copula (90 degrees) <br />
<code>134</code> = rotated Tawn type 1 copula (270 degrees) <br />
<code>204</code> = Tawn type 2 copula <br />
<code>214</code> = rotated Tawn type 2 copula (180 degrees) <br />
<code>224</code> = rotated Tawn type 2 copula (90 degrees) <br />
<code>234</code> = rotated Tawn type 2 copula (270 degrees)&quot; (VineCopula Documentation, version 2.1.1, pp. 73-74)</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_type">type</code></td>
<td>
<p>Type of vine to be fitted: <br />
C-Vine: &quot;CVine&quot; or 1; <br />
D-Vine: &quot;DVine&quot; or 2; <br />
Both C and D-Vine: &quot;CVine-DVine&quot; or &quot;1-2&quot; (default).</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_indeptest">indeptest</code></td>
<td>
<p>&quot;Logical; whether a hypothesis test for the independence of
<code>u1</code> and <code>u2</code> is performed before bivariate copula selection
(default: <code>indeptest = FALSE</code>; see <code>BiCopIndTest</code>).  The
independence copula is chosen for a (conditional) pair if the null
hypothesis of independence cannot be rejected.</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_level">level</code></td>
<td>
<p>numeric; significance level of the independence test (default:
<code>level = 0.05</code>).</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_se">se</code></td>
<td>
<p>Logical; whether standard errors are estimated (default: <code>se
= FALSE</code>).</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_rotations">rotations</code></td>
<td>
<p>logical; if <code>TRUE</code>, all rotations of the families in
<code>familyset</code> are included.</p>
</td></tr>
<tr><td><code id="CDVineCondRank_+3A_method">method</code></td>
<td>
<p>indicates the estimation method: either maximum
likelihood estimation (<code>method = "mle"</code>; default) or inversion of
Kendall's tau (<code>method = "itau"</code>). For <code>method = "itau"</code> only
one parameter families and the Student t copula can be used (<code>family =
1,2,3,4,5,6,13,14,16,23,24,26,33,34</code> or <code>36</code>). For the t-copula,
<code>par2</code> is found by a crude profile likelihood optimization over the
interval (2, 10].&quot; (VineCopula Documentation, version 2.1.1, pp. 74-75)</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt><code>table</code></dt><dd><p>A table with the ranking of the vines, with vine index <code>i</code>,
values of the selected <code>treecrit</code> and vine <code>type</code> (1 for &quot;CVine&quot; and 2 for D-Vine).</p>
</dd>
<dt><code>vines</code></dt><dd><p>A list where the element <code>[[i]]</code> is an <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> object corresponding to
the <code>i</code>-th vine in the ranking shown in <code>table</code>. 
Each <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> object containes the selected families (<code>$family</code>) as well as sequentially
estimated parameters stored in <code>$par</code> and <code>$par2</code>. Details about <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> objects are given in 
the documentation file of the <code>VineCopula</code> package). 
The fit of each model is performed via the function <code><a href="VineCopula.html#topic+RVineCopSelect">RVineCopSelect</a></code> of the package <code>VineCopula</code>. 
&quot;The object is augmented by the following information about the fit: 
</p>

<dl>
<dt><code>se, se2</code></dt><dd><p>standard errors for the parameter estimates  (if <code>se = TRUE</code>; note that these are only 
approximate since they do not account for the sequential nature of the estimation</p>
</dd>
<dt><code>nobs</code></dt><dd><p>number of observations</p>
</dd>
<dt><code>logLik, pair.logLik</code></dt><dd><p>log likelihood (overall and pairwise)</p>
</dd>
<dt><code>AIC, pair.AIC</code></dt><dd><p>Aikaike's Informaton Criterion (overall and pairwise)</p>
</dd>
<dt><code>BIC, pair.BIC</code></dt><dd><p>Bayesian's Informaton Criterion (overall and pairwise)</p>
</dd>
<dt><code>emptau</code></dt><dd><p>matrix of empirical values of Kendall's tau</p>
</dd>
<dt><code>p.value.indeptest</code></dt><dd><p>matrix of p-values of the independence test.</p>
</dd></dl>

</dd></dl>



<h3>Note</h3>

<p>For a comprehensive summary of the vine copula model, use
<code>summary(object)</code>; to see all its contents, use <code>str(object)</code>.&quot; (VineCopula Documentation, version 2.1.1, pp. 103)
</p>


<h3>Author(s)</h3>

<p>Emanuele Bevacqua
</p>


<h3>References</h3>

<p>Bevacqua, E., Maraun, D., Hobaek Haff, I., Widmann, M., and Vrac, M.: Multivariate statistical modelling of compound events via pair-copula constructions: analysis of floods in Ravenna (Italy), 
Hydrol. Earth Syst. Sci., 21, 2701-2723, https://doi.org/10.5194/hess-21-2701-2017, 2017.
<a href="https://www.researchgate.net/publication/317414374_Multivariate_statistical_modelling_of_compound_events_via_pair-copula_constructions_Analysis_of_floods_in_Ravenna_Italy">[link]</a> 
<a href="https://www.hydrol-earth-syst-sci.net/21/2701/2017/hess-21-2701-2017.html">[link]</a> 
</p>
<p>Aas, K., Czado, C., Frigessi, A. and Bakken, H.: Pair-copula constructions of multiple dependence, Insurance:
Mathematics and Economics, 44(2), 182-198, &lt;doi:10.1016/j.insmatheco.2007.02.001&gt;, 2009. 
<a href="http://www.sciencedirect.com/science/article/pii/S0167668707000194">[link]</a> 
</p>
<p>Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler, Thomas 
Nagler and Tobias Erhardt (2017). VineCopula: Statistical Inference of Vine Copulas. R 
package version 2.1.1. <a href="https://CRAN.R-project.org/package=VineCopula">[link]</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CDVineCondFit">CDVineCondFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Read data
data(dataset)
data &lt;- dataset$data[1:100,1:5]

# Define the variables Y and X. X are the conditioning variables, 
# which have to be positioned in the last columns of the data.frame
colnames(data) &lt;- c("Y1","Y2","X3","X4","X5")

# Rank the possible D-Vines according to the AIC
## Not run: 
Ranking &lt;- CDVineCondRank(data,Nx=3,"AIC",type="DVine")
Ranking$table
#    tree       AIC type
# 1     1 -292.8720    2
# 2     2 -290.2941    2
# 3     3 -288.5719    2
# 4     4 -288.2496    2
# 5     5 -287.8006    2
# 6     6 -285.8503    2
# 7     7 -282.2867    2
# 8     8 -278.9371    2
# 9     9 -275.8339    2
# 10   10 -272.9459    2
# 11   11 -271.1526    2
# 12   12 -270.5269    2

Ranking$vines[[1]]$AIC
# [1] -292.8720
summary(Ranking$vines[[1]])

## End(Not run)

</code></pre>

<hr>
<h2 id='CDVineCondSim'>Simulation from a conditional C- or D-vine</h2><span id='topic+CDVineCondSim'></span>

<h3>Description</h3>

<p>Simulates from a d-dimensional conditional C- or D-vine of the variables (<strong>Y</strong>,<strong>X</strong>),  
given the fixed conditioning variables <strong>X</strong>. The algorithm works 
for vines satysfying the requirements discussed in <em>Bevacqua et al. (2017)</em>. The algorthm implemented here 
is a modified version of those form <em>Aas et al. (2009)</em> and is shown in <em>Bevacqua et al. (2017)</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDVineCondSim(RVM, Condition, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CDVineCondSim_+3A_rvm">RVM</code></td>
<td>
<p>An <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> object containing the information of the d-dimensional C- or D-Vine 
model (for further details about <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> objects see the documentation file of the <code>VineCopula</code> package). 
If the full copula is 2-dimensional, RVM can be an <code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> object or a data.frame (or list) object 
where <code>$family</code>, <code>$par</code> and <code>$par2</code> are specified.</p>
</td></tr>
<tr><td><code id="CDVineCondSim_+3A_condition">Condition</code></td>
<td>
<p>A <code>N x Nx</code> matrix of the Nx conditioning variables.
For D-vine: data corresponding to the conditioning variable whose index is in <code>RVM$Matrix[i,i]</code>, are in i-th column of <code>Condition</code>. 
For C-vine: data corresponding to the conditioning variable whose index is in <code>RVM$Matrix[i,i]</code>, are in [(d+1)-i]-th column 
of <code>Condition</code>. See examples.</p>
</td></tr>
<tr><td><code id="CDVineCondSim_+3A_n">N</code></td>
<td>
<p>Number of data to be simulated. By default N is taken from <code>Condition</code>, which is a <code>N x Nx</code> matrix.
It is necessary to specify <code>N</code> only when <code>Condition</code> is not given.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>N x d</code> matrix of the simulated variables from the given C- or D-vine copula model. In the first columns there are
the simulated conditioned variables, and in the last columns the conditioning variables <code>Condition</code>.
For more details about the exact order of the variables in the columns see the examples. The 
function is built to work easily in combination with <code><a href="#topic+CDVineCondFit">CDVineCondFit</a></code>.
</p>


<h3>Author(s)</h3>

<p>Emanuele Bevacqua
</p>


<h3>References</h3>

<p>Bevacqua, E., Maraun, D., Hobaek Haff, I., Widmann, M., and Vrac, M.: Multivariate statistical modelling of compound events via pair-copula constructions: analysis of floods in Ravenna (Italy), 
Hydrol. Earth Syst. Sci., 21, 2701-2723, https://doi.org/10.5194/hess-21-2701-2017, 2017.
<a href="https://www.researchgate.net/publication/317414374_Multivariate_statistical_modelling_of_compound_events_via_pair-copula_constructions_Analysis_of_floods_in_Ravenna_Italy">[link]</a> 
<a href="https://www.hydrol-earth-syst-sci.net/21/2701/2017/hess-21-2701-2017.html">[link]</a> 
</p>
<p>Aas, K., Czado, C., Frigessi, A. and Bakken, H.: Pair-copula constructions of multiple dependence, Insurance:
Mathematics and Economics, 44(2), 182-198, &lt;doi:10.1016/j.insmatheco.2007.02.001&gt;, 2009. 
<a href="http://www.sciencedirect.com/science/article/pii/S0167668707000194">[link]</a> 
</p>
<p>Ulf Schepsmeier, Jakob Stoeber, Eike Christian Brechmann, Benedikt Graeler, Thomas 
Nagler and Tobias Erhardt (2017). VineCopula: Statistical Inference of Vine Copulas. R 
package version 2.1.1. <a href="https://CRAN.R-project.org/package=VineCopula">[link]</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CDVineCondFit">CDVineCondFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1: conditional sampling from a C-Vine

# Read data
data(dataset) 
data &lt;- dataset$data[1:400,1:4]

# Define the variables Y and X. X are the conditioning variables, 
# which have to be positioned in the last columns of the data.frame
colnames(data) &lt;- c("Y1","Y2","X3","X4")

## Not run: 
# Select a vine and fit the copula families, specifying that there are 2 conditioning variables
RVM &lt;- CDVineCondFit(data,Nx=2,type="CVine")

# Set the values of the conditioning variables as those used for the calibration. 
# Order them with respect to RVM$Matrix, considering that is a C-Vine
d=dim(RVM$Matrix)[1]
cond1 &lt;- data[,RVM$Matrix[(d+1)-1,(d+1)-1]]
cond2 &lt;- data[,RVM$Matrix[(d+1)-2,(d+1)-2]]
condition &lt;- cbind(cond1,cond2)

# Simulate the variables
Sim &lt;- CDVineCondSim(RVM,condition)

# Plot the simulated variables over the observed
Sim &lt;- data.frame(Sim)
overplot(Sim,data)



# Example 2: conditional sampling from a D-Vine

# Read data
data(dataset) 
data &lt;- dataset$data[1:100,1:4]

# Define the variables Y and X. X are the conditioning variables, 
# which have to be positioned in the last columns of the data.frame
colnames(data) &lt;- c("Y1","Y2","X3","X4")

# Select a vine and fit the copula families, specifying that there are 2 conditioning variables
RVM &lt;- CDVineCondFit(data,Nx=2,type="DVine")
summary(RVM) #It is a D-Vine.

# Set the values of the conditioning variables as those used for the calibration. 
# Order them with respect to RVM$Matrix, considering that is a D-Vine.
cond1 &lt;- data[,RVM$Matrix[1,1]]
cond2 &lt;- data[,RVM$Matrix[2,2]]
condition &lt;- cbind(cond1,cond2)

# Simulate the variables
Sim &lt;- CDVineCondSim(RVM,condition)

# Plot the simulated variables over the observed
Sim &lt;- data.frame(Sim)
overplot(Sim,data)



# Example 3

# Read data
data(dataset) 
data &lt;- dataset$data[1:100,1:2]
colnames(data) &lt;- c("Y1","X2")

# Fit copula
require(VineCopula)
BiCop &lt;- BiCopSelect(data$Y1,data$X2)
BiCop

# Fix conditioning variable to low values and simulate
condition &lt;- data$X2/10
Sim &lt;- CDVineCondSim(BiCop,condition)

# Plot the simulated variables over the observed
Sim &lt;- data.frame(Sim)
overplot(Sim,data)

## End(Not run)

</code></pre>

<hr>
<h2 id='dataset'>Random dataset from a given vine copula model</h2><span id='topic+dataset'></span>

<h3>Description</h3>

<p>A random dataset simulated from a given 5-dimensional vine copula model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset
</code></pre>


<h3>Format</h3>


<dl>
<dt><code>$data</code></dt><dd><p>An <code>1000 x 5</code> data set (format <code>data.frame</code>) with the uniform 
variables <code>(U1,U2,U3,U4,U5)</code>.</p>
</dd>
<dt><code>$vine</code></dt><dd><p><code><a href="VineCopula.html#topic+RVineMatrix">RVineMatrix</a></code> object defyining the vine copula model from where <code>$data</code> was sampled.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Emanuele Bevacqua
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load data
data(dataset)

# Extract data
data &lt;- dataset$data 
plot(data)

# Extract the RVineMatrix object from where the dataset was randomly sampled
vine &lt;- dataset$vine
vine$Matrix 
vine$family
vine$par
vine$par2 
summary(vine)



</code></pre>

<hr>
<h2 id='overplot'>overplot</h2><span id='topic+overplot'></span>

<h3>Description</h3>

<p>This function overlays the scatterplot matrices of two multivariate datsets. 
Moreover, it shows the dependencies among all the pairs for both datsets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>overplot(data1, data2, col1 = "black", col2 = "grey", xlim = NA,
  ylim = NA, labels = NA, method = "pearson", cex.cor = 1,
  cex.labels = 1, cor.signif = 2, cex.axis = 1, pch1 = 1, pch2 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="overplot_+3A_data1">data1</code>, <code id="overplot_+3A_data2">data2</code></td>
<td>
<p>Two <code>N x d</code> matrices of data to be plotted.</p>
</td></tr>
<tr><td><code id="overplot_+3A_col1">col1</code>, <code id="overplot_+3A_col2">col2</code></td>
<td>
<p>Colors used for <code>data1</code> and <code>data2</code> during the plot. Default is <code>col1="black"</code> and <code>col2="grey"</code>.</p>
</td></tr>
<tr><td><code id="overplot_+3A_xlim">xlim</code>, <code id="overplot_+3A_ylim">ylim</code></td>
<td>
<p>Two bidimensional vectors indicating the limits of x and y axes for all the scatterplots. 
If not given, they are authomatically 
computed for each of the scatterplots.</p>
</td></tr>
<tr><td><code id="overplot_+3A_labels">labels</code></td>
<td>
<p>A character vector with the variable names to be printed (if not given, the names of <code>data1</code> 
variables are printed).</p>
</td></tr>
<tr><td><code id="overplot_+3A_method">method</code></td>
<td>
<p>Character indicating the dependence types to be computed between the pairs. Possibilites: &quot;kendall&quot;,
&quot;spearman&quot; and &quot;pearson&quot; (default)</p>
</td></tr>
<tr><td><code id="overplot_+3A_cex.cor">cex.cor</code></td>
<td>
<p>Number: character dimension of the printed dependencies. Default <code>cex.cor=1</code>.</p>
</td></tr>
<tr><td><code id="overplot_+3A_cex.labels">cex.labels</code></td>
<td>
<p>Number: character dimension of the printed variable names. Default <code>cex.labels=1</code>.</p>
</td></tr>
<tr><td><code id="overplot_+3A_cor.signif">cor.signif</code></td>
<td>
<p>Number: number of significant numbers of the printed dependencies. Default <code>cor.signif=2</code>.</p>
</td></tr>
<tr><td><code id="overplot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Number: dimension of the axis numeric values. Default cex.axis=1.</p>
</td></tr>
<tr><td><code id="overplot_+3A_pch1">pch1</code>, <code id="overplot_+3A_pch2">pch2</code></td>
<td>
<p>Paramter to specify the symbols to use when plotting points of <code>data1</code> and <code>data2</code>.Default is <code>pch1=1</code> and <code>pch2=1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of overlaying scatterplots of the multivariate datsets <code>data1</code> and <code>data2</code>, with 
the dependencies of the pairs.
</p>


<h3>Author(s)</h3>

<p>Emanuele Bevacqua
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example 1

# Read and prepare the data for the plot
data(dataset) 
data1 &lt;- dataset$data[1:300,]
data2 &lt;- dataset$data[301:600,]
overplot(data1,data2,xlim=c(0,1),ylim=c(0,1),method="kendall")



## Not run: 
# Example 2

# Read and prepare the data for the plot
data(dataset) 
data &lt;- dataset$data[1:200,1:5]
colnames(data) &lt;- c("Y1","Y2","X3","X4","X5")

# Fit copula families for the defined vine:
ListVines &lt;- CDVineCondListMatrices(data,Nx=3)
Matrix=ListVines$CVine[[1]]
RVM &lt;- CDVineCondFit(data,Nx=3,Matrix=Matrix)

# Simulate data:
d=dim(RVM$Matrix)[1]
cond1 &lt;- data[,RVM$Matrix[(d+1)-1,(d+1)-1]]
cond2 &lt;- data[,RVM$Matrix[(d+1)-2,(d+1)-2]]
cond3 &lt;- data[,RVM$Matrix[(d+1)-3,(d+1)-3]]
condition &lt;- cbind(cond1,cond2,cond3)
Sim &lt;- CDVineCondSim(RVM,condition)

# Plot the simulated variables Sim over the observed
Sim &lt;- data.frame(Sim)
overplot(data[,1:2],Sim[,1:2],xlim=c(0,1),ylim=c(0,1),method="spearman")
overplot(data,Sim,xlim=c(0,1),ylim=c(0,1),method="spearman")

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
