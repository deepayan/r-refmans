<!DOCTYPE html><html><head><title>Help for package MSigSeg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MSigSeg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#brkps'><p>Generic Function-brkps.</p></a></li>
<li><a href='#change'><p>Breakpoints matrix generation.</p></a></li>
<li><a href='#data_test'><p>A simulated data set used for testing.</p></a></li>
<li><a href='#data.input'><p>Generic Function-data.input.</p></a></li>
<li><a href='#data.output'><p>Generic Function-data.output.</p></a></li>
<li><a href='#lambda'><p>Generic Function-lambda.</p></a></li>
<li><a href='#lambda_estimator'><p>Detecting common breakpoints with designated number.</p></a></li>
<li><a href='#MSigSeg-class'><p>An S4 class to encapsulation the result of breakpoints analysis.</p></a></li>
<li><a href='#multi_plot'><p>Plot function of MSigSeg package.</p></a></li>
<li><a href='#NCHSData'><p>influenza  data set from CDC used as an example.</p></a></li>
<li><a href='#noisegen'><p>Noisegen.</p></a></li>
<li><a href='#print'><p>Generic Function-print.</p></a></li>
<li><a href='#seg.len'><p>Generic Function-seg.len.</p></a></li>
<li><a href='#segmentation'><p>Detecting common change points for multiple signals.</p></a></li>
<li><a href='#stock'><p>A stock data set used as an example.</p></a></li>
<li><a href='#summary'><p>Generic Function-summary.</p></a></li>
<li><a href='#T16M'><p>A chromosome sequencing data set used as an example.</p></a></li>
<li><a href='#T16P'><p>A chromosome sequencing data set used as an example.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiple SIGnal SEGmentation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Traditional methods typically detect breakpoints from individual signals, which means that when applied separately to multiple signals, the breakpoints are not aligned. 
    However, this package implements a common breakpoint detection approach for multiple piecewise constant signals, resulting in increased detection sensitivity and specificity. 
    By employing various techniques, optimal performance is ensured, and computation is accelerated. We hope that this package will be beneficial for researchers in signal processing, bioinformatics, economy, and other related fields.
    The segmentation(), lambda_estimator() functions are the main functions of this package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'MSigSeg_Class.R' 'allGenerics.R' 'brkps_method.R' 'change.R'
'data.R' 'data.input_method.R' 'data.output_method.R'
'funtion_colsum_colmean.R' 'lambda_estimator.R'
'lambda_method.R' 'multi_plot.R' 'noisegen.R' 'print_method.R'
'seg.len_method.R' 'segmentation.R' 'summary_method.R'</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, ggpubr, ggplot2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-13 13:02:43 UTC; lxy123</td>
</tr>
<tr>
<td>Author:</td>
<td>Xuanyu Liu [aut, cre],
  Junbo Duan [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xuanyu Liu &lt;lxy382198251@stu.xjtu.edu.cn&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-13 15:03:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='brkps'>Generic Function-brkps.</h2><span id='topic+brkps'></span><span id='topic+brkps+2CMSigSeg-method'></span>

<h3>Description</h3>

<p>This function returns the brkps slot of MSigSeg object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MSigSeg'
brkps(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brkps_+3A_object">object</code></td>
<td>
<p>A 'MSigSeg' object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a S4 method for MSigSeg object. It retrieves brkps slot, which contains the locations of break points.
</p>


<h3>Value</h3>

<p>The brkps slot of MSigSeg object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=new("MSigSeg") # Creating a new MSigSeg object.
brkps(x)

</code></pre>

<hr>
<h2 id='change'>Breakpoints matrix generation.</h2><span id='topic+change'></span>

<h3>Description</h3>

<p>Generate matrix based on specified breakpoints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>change(M, p = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="change_+3A_m">M</code></td>
<td>
<p>A matrix users aimed to add breakpoints.</p>
</td></tr>
<tr><td><code id="change_+3A_p">p</code></td>
<td>
<p>Probability of occurrence of breakpoints.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generate matrix with common breakpoints, based on specific probability of occurrence.
</p>


<h3>Value</h3>

<p>A list containing the matrix with specified change point and the location of breakpoints.
</p>

<hr>
<h2 id='data_test'>A simulated data set used for testing.</h2><span id='topic+data_test'></span>

<h3>Description</h3>

<p>A simulated data set used for testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_test
</code></pre>


<h3>Format</h3>

<p>A matrix with 1000 rows and 20 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("data_test",package = "MSigSeg")
</code></pre>

<hr>
<h2 id='data.input'>Generic Function-data.input.</h2><span id='topic+data.input'></span><span id='topic+data.input+2CMSigSeg-method'></span>

<h3>Description</h3>

<p>This function returns the data.input slot of MSigSeg object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MSigSeg'
data.input(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.input_+3A_object">object</code></td>
<td>
<p>A MSigSeg object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a S4 method for MSigSeg object. It retrieves data.input slot, which contains the data users input.
</p>


<h3>Value</h3>

<p>The data.input slot of MSigSeg object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=new("MSigSeg") # Creating a new MSigSeg object.
data.input(x)

</code></pre>

<hr>
<h2 id='data.output'>Generic Function-data.output.</h2><span id='topic+data.output'></span><span id='topic+data.output+2CMSigSeg-method'></span>

<h3>Description</h3>

<p>This function returns the data.output slot of MSigSeg object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MSigSeg'
data.output(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.output_+3A_object">object</code></td>
<td>
<p>A MSigSeg object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a S4 method for MSigSeg object. It retrieves data.output slot, which contains the input data which has been smoothed..
</p>


<h3>Value</h3>

<p>The data.output slot of MSigSeg object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=new("MSigSeg") # Creating a new MSigSeg object.
data.output(x)

</code></pre>

<hr>
<h2 id='lambda'>Generic Function-lambda.</h2><span id='topic+lambda'></span><span id='topic+lambda+2CMSigSeg-method'></span>

<h3>Description</h3>

<p>This function returns the lambda slot of MSigSeg object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MSigSeg'
lambda(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda_+3A_object">object</code></td>
<td>
<p>A MSigSeg object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a S4 method for MSigSeg object. It retrieves lambda slot, which contains penalty coefficient to prevent over fitting.
</p>


<h3>Value</h3>

<p>The lambda slot of MSigSeg object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=new("MSigSeg") # Creating a new MSigSeg object.
lambda(x)

</code></pre>

<hr>
<h2 id='lambda_estimator'>Detecting common breakpoints with designated number.</h2><span id='topic+lambda_estimator'></span>

<h3>Description</h3>

<p>Automatic estimation of penalty parameter lambda for user defined breakpoints number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda_estimator(Y, K)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda_estimator_+3A_y">Y</code></td>
<td>
<p>An data.frame/matrix containing the data to be segmented. Each column stores a signal.</p>
</td></tr>
<tr><td><code id="lambda_estimator_+3A_k">K</code></td>
<td>
<p>Number of change points users want to detect.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is based on the segmentation() function. Number of breakpoints are defined by users and lambda is calculated by algorithm automatically.
</p>


<h3>Value</h3>

<p>An object of S4 class &quot;MSigSeg&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_test)
lambda_estimator(data_test,5)

</code></pre>

<hr>
<h2 id='MSigSeg-class'>An S4 class to encapsulation the result of breakpoints analysis.</h2><span id='topic+MSigSeg-class'></span>

<h3>Description</h3>

<p>An S4 class to encapsulation the result of breakpoints analysis.
</p>


<h3>Slots</h3>


<dl>
<dt><code>data.input</code></dt><dd><p>An data.frame/matrix containing the data to be segmented. Each column stores a signal.</p>
</dd>
<dt><code>data.output</code></dt><dd><p>A matrix containing the input data which has been smoothed.</p>
</dd>
<dt><code>lambda</code></dt><dd><p>A penalty term, small value leads to large number of breakpoints, and vice versa.</p>
</dd>
<dt><code>brkps</code></dt><dd><p>A vector containing the locations of common breakpoints.</p>
</dd>
<dt><code>fmin</code></dt><dd><p>A numeric containing the optimal numerical value calculated.</p>
</dd>
<dt><code>date</code></dt><dd><p>Character string containing date information.</p>
</dd>
</dl>

<hr>
<h2 id='multi_plot'>Plot function of MSigSeg package.</h2><span id='topic+multi_plot'></span>

<h3>Description</h3>

<p>Graph signals and breakpoints based on ggplot2 and ggarange packages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_plot(m, ncol, nrow)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi_plot_+3A_m">m</code></td>
<td>
<p>An object of S4 class &quot;MSigSeg&quot;.</p>
</td></tr>
<tr><td><code id="multi_plot_+3A_ncol">ncol</code></td>
<td>
<p>Column numbers of signals arrangement in the graph.</p>
</td></tr>
<tr><td><code id="multi_plot_+3A_nrow">nrow</code></td>
<td>
<p>Row numbers of signals arrangement in the graph</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, first item in the list is a graphic objects with all signals drawn and second is a list with individual signals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_test)
m &lt;- segmentation(data_test,100)
p &lt;- multi_plot(m,4,5)

</code></pre>

<hr>
<h2 id='NCHSData'>influenza  data set from CDC used as an example.</h2><span id='topic+NCHSData'></span>

<h3>Description</h3>

<p>influenza  data set from CDC used as an example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCHSData
</code></pre>


<h3>Format</h3>

<p>A matrix with 52 rows and 10 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("NCHSData",package = "MSigSeg")
</code></pre>

<hr>
<h2 id='noisegen'>Noisegen.</h2><span id='topic+noisegen'></span>

<h3>Description</h3>

<p>Generate matrix based on signal-to-noise ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>noisegen(X, SNR)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="noisegen_+3A_x">X</code></td>
<td>
<p>A matrix users aimed to add signal-to-noise ratio.</p>
</td></tr>
<tr><td><code id="noisegen_+3A_snr">SNR</code></td>
<td>
<p>Signal-to-noise ratio.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with specified signal-to-noise ratio.
</p>

<hr>
<h2 id='print'>Generic Function-print.</h2><span id='topic+print'></span><span id='topic+print+2CMSigSeg-method'></span>

<h3>Description</h3>

<p>This function print the basic information of MSigSeg object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MSigSeg'
print(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_+3A_object">object</code></td>
<td>
<p>A MSigSeg object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a S4 method for MSigSeg object. It prints class, slots, created  date and summary of MSigSeg object.
</p>


<h3>Value</h3>

<p>The the basic information of MSigSeg object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=new("MSigSeg") # Creating a new MSigSeg object.
print(x)

</code></pre>

<hr>
<h2 id='seg.len'>Generic Function-seg.len.</h2><span id='topic+seg.len'></span><span id='topic+seg.len+2CMSigSeg-method'></span>

<h3>Description</h3>

<p>This function returns the length of segmentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MSigSeg'
seg.len(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seg.len_+3A_object">object</code></td>
<td>
<p>A MSigSeg object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a S4 method for MSigSeg object. It calculates the distance between each change points.
</p>


<h3>Value</h3>

<p>A vector contains length of segmentation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=new("MSigSeg") # Creating a new MSigSeg object.
seg.len(x)

</code></pre>

<hr>
<h2 id='segmentation'>Detecting common change points for multiple signals.</h2><span id='topic+segmentation'></span>

<h3>Description</h3>

<p>Calculates the optimal positioning and number of common breakpoints for multiple signals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>segmentation(Y, lambda, flag = TRUE, return_smooth_signals = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="segmentation_+3A_y">Y</code></td>
<td>
<p>An data.frame/matrix containing the data to be segmented. Each column stores a signal.</p>
</td></tr>
<tr><td><code id="segmentation_+3A_lambda">lambda</code></td>
<td>
<p>A penalty term, small value leads to large number of breakpoints, and vice versa.</p>
</td></tr>
<tr><td><code id="segmentation_+3A_flag">flag</code></td>
<td>
<p>Logical. If True then use th PELT method. If False then use the OP method.</p>
</td></tr>
<tr><td><code id="segmentation_+3A_return_smooth_signals">return_smooth_signals</code></td>
<td>
<p>Logical. If True then smoothed signals are returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses modified PELT method to find optimal common change points for multiple signals.
</p>


<h3>Value</h3>

<p>An object of S4 class &quot;MSigSeg&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_test)
segmentation(data_test,100)

</code></pre>

<hr>
<h2 id='stock'>A stock data set used as an example.</h2><span id='topic+stock'></span>

<h3>Description</h3>

<p>A stock data set used as an example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stock
</code></pre>


<h3>Format</h3>

<p>A data.frame with 757 rows and 488 columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("stock",package = "MSigSeg")
</code></pre>

<hr>
<h2 id='summary'>Generic Function-summary.</h2><span id='topic+summary'></span><span id='topic+summary+2CMSigSeg-method'></span>

<h3>Description</h3>

<p>This function summarize the information of MSigSeg object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MSigSeg'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>A MSigSeg object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a S4 method for MSigSeg object. It summarizes the number of signals, length of signals, number of change points and fmin.
</p>


<h3>Value</h3>

<p>A summary of MSigSeg object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x=new("MSigSeg") # Creating a new MSigSeg object.
summary(x)

</code></pre>

<hr>
<h2 id='T16M'>A chromosome sequencing data set used as an example.</h2><span id='topic+T16M'></span>

<h3>Description</h3>

<p>A chromosome sequencing data set used as an example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>T16M
</code></pre>


<h3>Format</h3>

<p>A data.frame with 2928 rows and 22 columns.
</p>


<h3>References</h3>

<p>Navin N, Kendall J, Troge J, et al. Tumour evolution inferred by single-cell sequencing. Nature. 2011;472(7341):90-94. doi:10.1038/nature09807
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("T16M",package = "MSigSeg")
</code></pre>

<hr>
<h2 id='T16P'>A chromosome sequencing data set used as an example.</h2><span id='topic+T16P'></span>

<h3>Description</h3>

<p>A chromosome sequencing data set used as an example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>T16P
</code></pre>


<h3>Format</h3>

<p>A data.frame with 2928 rows and 16 columns.
</p>


<h3>References</h3>

<p>Navin N, Kendall J, Troge J, et al. Tumour evolution inferred by single-cell sequencing. Nature. 2011;472(7341):90-94. doi:10.1038/nature09807
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("T16P",package = "MSigSeg")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
