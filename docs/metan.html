<!DOCTYPE html><html lang="en-US"><head><title>Help for package metan</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<script type="text/javascript" src="mathjax-config.js"></script>
<script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {metan}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#acv'><p>Adjusted Coefficient of Variation</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></a></li>
<li><a href='#ammi_indexes'><p>AMMI-based stability indexes</p></a></li>
<li><a href='#Annicchiarico'><p>Annicchiarico's genotypic confidence index</p></a></li>
<li><a href='#anova_ind'><p>Within-environment analysis of variance</p></a></li>
<li><a href='#anova_joint'><p>Joint analysis of variance</p></a></li>
<li><a href='#arrange_ggplot'><p>Arrange separate ggplots into the same graphic</p></a></li>
<li><a href='#as.lpcor'><p>Coerce to an object of class lpcor</p></a></li>
<li><a href='#barplots'><p>Fast way to create bar plots</p></a></li>
<li><a href='#bind_cv'><p>Bind cross-validation objects</p></a></li>
<li><a href='#blup_indexes'><p>Stability indexes based on a mixed-effect model</p></a></li>
<li><a href='#can_corr'><p>Canonical correlation analysis</p></a></li>
<li><a href='#clustering'><p>Clustering analysis</p></a></li>
<li><a href='#coincidence_index'><p>Computes the coincidence index of genotype selection</p></a></li>
<li><a href='#colindiag'><p>Collinearity Diagnostics</p></a></li>
<li><a href='#comb_vars'><p>Pairwise combinations of variables</p></a></li>
<li><a href='#corr_ci'><p>Confidence interval for correlation coefficient</p></a></li>
<li><a href='#corr_coef'><p>Linear and partial correlation coefficients</p></a></li>
<li><a href='#corr_focus'><p>Focus on section of a correlation matrix</p></a></li>
<li><a href='#corr_plot'><p>Visualization of a correlation matrix</p></a></li>
<li><a href='#corr_ss'><p>Sample size planning for a desired Pearson's correlation confidence interval</p></a></li>
<li><a href='#corr_stab_ind'><p>Correlation between stability indexes</p></a></li>
<li><a href='#correlated_vars'><p>Generate correlated variables</p></a></li>
<li><a href='#covcor_design'><p>Variance-covariance matrices for designed experiments</p></a></li>
<li><a href='#cv_ammi'><p>Cross-validation procedure</p></a></li>
<li><a href='#cv_ammif'><p>Cross-validation procedure</p></a></li>
<li><a href='#cv_blup'><p>Cross-validation procedure</p></a></li>
<li><a href='#data_alpha'><p>Data from an alpha lattice design</p></a></li>
<li><a href='#data_g'><p>Single maize trial</p></a></li>
<li><a href='#data_ge'><p>Multi-environment trial of oat</p></a></li>
<li><a href='#data_ge2'><p>Multi-environment trial of maize</p></a></li>
<li><a href='#data_simula'><p>Simulate genotype and genotype-environment data</p></a></li>
<li><a href='#desc_stat'><p>Descriptive statistics</p></a></li>
<li><a href='#doo'><p>Alternative to dplyr::do for doing anything</p></a></li>
<li><a href='#ecovalence'><p>Stability analysis based on Wricke's model</p></a></li>
<li><a href='#env_dissimilarity'><p>Dissimilarity between environments</p></a></li>
<li><a href='#env_stratification'><p>Environment stratification</p></a></li>
<li><a href='#fai_blup'><p>Multi-trait selection index</p></a></li>
<li><a href='#find_outliers'><p>Find possible outliers in a dataset</p></a></li>
<li><a href='#Fox'><p>Fox's stability function</p></a></li>
<li><a href='#gafem'><p>Genotype analysis by fixed-effect models</p></a></li>
<li><a href='#gai'><p>Geometric adaptability index</p></a></li>
<li><a href='#gamem'><p>Genotype analysis by mixed-effect models</p></a></li>
<li><a href='#gamem_met'><p>Genotype-environment analysis by mixed-effect models</p></a></li>
<li><a href='#ge_acv'><p>Adjusted Coefficient of Variation as yield stability index</p></a></li>
<li><a href='#ge_cluster'><p>Cluster genotypes or environments</p></a></li>
<li><a href='#ge_details'><p>Details for genotype-environment trials</p></a></li>
<li><a href='#ge_effects'><p>Genotype-environment effects</p></a></li>
<li><a href='#ge_factanal'><p>Stability analysis and environment stratification</p></a></li>
<li><a href='#ge_means'><p>Genotype-environment means</p></a></li>
<li><a href='#ge_plot'><p>Graphical analysis of genotype-vs-environment interaction</p></a></li>
<li><a href='#ge_polar'><p>Power Law Residuals as yield stability index</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></a></li>
<li><a href='#ge_reg'><p>Eberhart and Russell's regression model</p></a></li>
<li><a href='#ge_stats'><p>Parametric and non-parametric stability statistics</p></a></li>
<li><a href='#ge_winners'><p>Genotype-environment winners</p></a></li>
<li><a href='#get_corvars'><p>Generate normal, correlated variables</p></a></li>
<li><a href='#get_covmat'><p>Generate a covariance matrix</p></a></li>
<li><a href='#get_dist'><p>Get a distance matrix</p></a></li>
<li><a href='#get_model_data'><p>Get data from a model easily</p></a></li>
<li><a href='#gge'><p>Genotype plus genotype-by-environment model</p></a></li>
<li><a href='#gtb'><p>Genotype by trait biplot</p></a></li>
<li><a href='#gytb'><p>Genotype by yield*trait biplot</p></a></li>
<li><a href='#Huehn'><p>Huehn's stability statistics</p></a></li>
<li><a href='#impute_missing_val'><p>Missing value imputation</p></a></li>
<li><a href='#inspect'><p>Check for common errors in multi-environment trial data</p></a></li>
<li><a href='#int.effects'><p>Data for examples</p></a></li>
<li><a href='#is_balanced_trial'><p>Check if a data set is balanced</p></a></li>
<li><a href='#is.lpcor'><p>Coerce to an object of class lpcor</p></a></li>
<li><a href='#lineplots'><p>Fast way to create line plots</p></a></li>
<li><a href='#lpcor'><p>Linear and Partial Correlation Coefficients</p></a></li>
<li><a href='#mahala'><p>Mahalanobis Distance</p></a></li>
<li><a href='#mahala_design'><p>Mahalanobis distance from designed experiments</p></a></li>
<li><a href='#make_long'><p>Two-way table to a 'long' format</p></a></li>
<li><a href='#make_mat'><p>Make a two-way table</p></a></li>
<li><a href='#mantel_test'><p>Mantel test</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></a></li>
<li><a href='#meansGxE'><p>Data for examples</p></a></li>
<li><a href='#metan'><p>Multi-Environment Trial Analysis</p></a></li>
<li><a href='#mgidi'><p>Multitrait Genotype-Ideotype Distance Index</p></a></li>
<li><a href='#mps'><p>Mean performance and stability in multi-environment trials</p></a></li>
<li><a href='#mtmps'><p>Multi-trait mean performance and stability index</p></a></li>
<li><a href='#mtsi'><p>Multi-trait stability index</p></a></li>
<li><a href='#network_plot'><p>Network plot of a correlation matrix</p></a></li>
<li><a href='#non_collinear_vars'><p>Select a set of predictors with minimal multicollinearity</p></a></li>
<li><a href='#pairs_mantel'><p>Mantel test for a set of correlation matrices</p></a></li>
<li><a href='#path_coeff'><p>Path coefficients with minimal multicollinearity</p></a></li>
<li><a href='#performs_ammi'><p>Additive Main effects and Multiplicative Interaction</p></a></li>
<li><a href='#plaisted_peterson'><p>Stability analysis based on Plaisted and Peterson (1959)</p></a></li>
<li><a href='#plot_blup'><p>Plot the BLUPs for genotypes</p></a></li>
<li><a href='#plot_ci'><p>Plot the confidence interval for correlation</p></a></li>
<li><a href='#plot_eigen'><p>Plot the eigenvalues</p></a></li>
<li><a href='#plot_scores'><p>Plot scores in different graphical interpretations</p></a></li>
<li><a href='#plot_waasby'><p>Plot WAASBY values for genotype ranking</p></a></li>
<li><a href='#plot.anova_joint'><p>Several types of residual plots</p></a></li>
<li><a href='#plot.can_cor'><p>Plots an object of class can_cor</p></a></li>
<li><a href='#plot.clustering'><p>Plot an object of class clustering</p></a></li>
<li><a href='#plot.corr_coef'><p>Create a correlation heat map</p></a></li>
<li><a href='#plot.correlated_vars'><p>Plot an object of class correlated_vars</p></a></li>
<li><a href='#plot.cvalidation'><p>Plot the RMSPD of a cross-validation procedure</p></a></li>
<li><a href='#plot.env_dissimilarity'><p>Plot an object of class env_dissimilarity</p></a></li>
<li><a href='#plot.env_stratification'><p>Plot the env_stratification model</p></a></li>
<li><a href='#plot.fai_blup'><p>Multi-trait selection index</p></a></li>
<li><a href='#plot.gafem'><p>Several types of residual plots</p></a></li>
<li><a href='#plot.gamem'><p>Several types of residual plots</p></a></li>
<li><a href='#plot.ge_cluster'><p>Plot an object of class ge_cluster</p></a></li>
<li><a href='#plot.ge_effects'><p>Plot an object of class ge_effects</p></a></li>
<li><a href='#plot.ge_factanal'><p>Plot the ge_factanal model</p></a></li>
<li><a href='#plot.ge_reg'><p>Plot an object of class ge_reg</p></a></li>
<li><a href='#plot.gge'><p>Create GGE, GT or GYT biplots</p></a></li>
<li><a href='#plot.mgidi'><p>Plot the multi-trait genotype-ideotype distance index</p></a></li>
<li><a href='#plot.mtmps'><p>Plot the multi-trait stability index</p></a></li>
<li><a href='#plot.mtsi'><p>Plot the multi-trait stability index</p></a></li>
<li><a href='#plot.path_coeff'><p>Plots an object of class <code>path_coeff</code></p></a></li>
<li><a href='#plot.performs_ammi'><p>Several types of residual plots</p></a></li>
<li><a href='#plot.resp_surf'><p>Plot the response surface model</p></a></li>
<li><a href='#plot.sh'><p>Plot the Smith-Hazel index</p></a></li>
<li><a href='#plot.waas'><p>Several types of residual plots</p></a></li>
<li><a href='#plot.waasb'><p>Several types of residual plots</p></a></li>
<li><a href='#plot.wsmp'><p>Plot heat maps with genotype ranking</p></a></li>
<li><a href='#predict.gamem'><p>Predict method for gamem fits</p></a></li>
<li><a href='#predict.gge'><p>Predict a two-way table based on GGE model</p></a></li>
<li><a href='#predict.performs_ammi'><p>Predict the means of a performs_ammi object</p></a></li>
<li><a href='#predict.waas'><p>Predict the means of a waas object</p></a></li>
<li><a href='#predict.waasb'><p>Predict method for waasb fits</p></a></li>
<li><a href='#print.ammi_indexes'><p>Print an object of class ammi_indexes</p></a></li>
<li><a href='#print.Annicchiarico'><p>Print an object of class Annicchiarico</p></a></li>
<li><a href='#print.anova_ind'><p>Print an object of class anova_ind</p></a></li>
<li><a href='#print.anova_joint'><p>Print an object of class anova_joint</p></a></li>
<li><a href='#print.can_cor'><p>Print an object of class can_cor</p></a></li>
<li><a href='#print.coincidence'><p>Print an object of class coincidence</p></a></li>
<li><a href='#print.colindiag'><p>Print an object of class colindiag</p></a></li>
<li><a href='#print.corr_coef'><p>Print an object of class corr_coef</p></a></li>
<li><a href='#print.ecovalence'><p>Print an object of class ecovalence</p></a></li>
<li><a href='#print.env_dissimilarity'><p>Print an object of class env_dissimilarity</p></a></li>
<li><a href='#print.env_stratification'><p>Print the env_stratification model</p></a></li>
<li><a href='#print.Fox'><p>Print an object of class Fox</p></a></li>
<li><a href='#print.gamem'><p>Print an object of class gamem</p></a></li>
<li><a href='#print.ge_factanal'><p>Print an object of class ge_factanal</p></a></li>
<li><a href='#print.ge_reg'><p>Print an object of class ge_reg</p></a></li>
<li><a href='#print.ge_stats'><p>Print an object of class ge_stats</p></a></li>
<li><a href='#print.Huehn'><p>Print an object ofclass <code>Huehn</code></p></a></li>
<li><a href='#print.lpcor'><p>Print the partial correlation coefficients</p></a></li>
<li><a href='#print.mgidi'><p>Print an object of class mgidi</p>
Print a <code>mgidi</code> object in two ways. By default, the results are shown in
the R console. The results can also be exported to the directory.</a></li>
<li><a href='#print.mtmps'><p>Print an object of class mtmps</p></a></li>
<li><a href='#print.mtsi'><p>Print an object of class mtsi</p></a></li>
<li><a href='#print.path_coeff'><p>Print an object of class path_coeff</p></a></li>
<li><a href='#print.performs_ammi'><p>Print an object of class performs_ammi</p></a></li>
<li><a href='#print.plaisted_peterson'><p>Print an object of class plaisted_peterson</p></a></li>
<li><a href='#print.Schmildt'><p>Print an object of class Schmildt</p></a></li>
<li><a href='#print.sh'><p>Print an object of class sh</p></a></li>
<li><a href='#print.Shukla'><p>Print an object of class Shukla</p></a></li>
<li><a href='#print.superiority'><p>Print an object ofclass <code>superiority</code></p></a></li>
<li><a href='#print.Thennarasu'><p>Print an object ofclass <code>Thennarasu</code></p></a></li>
<li><a href='#print.waas'><p>Print an object of class waas</p></a></li>
<li><a href='#print.waas_means'><p>Print an object of class waas_means</p></a></li>
<li><a href='#print.waasb'><p>Print an object of class waasb</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#reorder_cormat'><p>Reorder a correlation matrix</p></a></li>
<li><a href='#resca'><p>Rescale a variable to have specified minimum and maximum values</p></a></li>
<li><a href='#residual_plots'><p>Several types of residual plots</p></a></li>
<li><a href='#resp_surf'><p>Response surface model</p></a></li>
<li><a href='#Schmildt'><p>Schmildt's genotypic confidence index</p></a></li>
<li><a href='#Select_helper'><p>Select helper</p></a></li>
<li><a href='#select_pred'><p>Selects a best subset of predictor variables.</p></a></li>
<li><a href='#Shukla'><p>Shukla's stability variance parameter</p></a></li>
<li><a href='#Smith_Hazel'><p>Smith-Hazel index</p></a></li>
<li><a href='#solve_svd'><p>Pseudoinverse of a square matrix</p></a></li>
<li><a href='#split_factors'><p>Split a data frame by factors</p></a></li>
<li><a href='#stars_pval'><p>Generate significance stars from p-values</p></a></li>
<li><a href='#superiority'><p>Lin e Binns' superiority index</p></a></li>
<li><a href='#themes'><p>Personalized theme for ggplot2-based graphics</p></a></li>
<li><a href='#Thennarasu'><p>Thennarasu's stability statistics</p></a></li>
<li><a href='#tidyeval'><p>Tidy eval helpers</p></a></li>
<li><a href='#transpose_df'><p>Transpose a data frame</p></a></li>
<li><a href='#tukey_hsd'><p>Tukey Honest Significant Differences</p></a></li>
<li><a href='#utils_as'><p>Encode variables to a specific format</p></a></li>
<li><a href='#utils_bind'><p>Helper function for binding rows</p></a></li>
<li><a href='#utils_class'><p>Utilities for handling with classes</p></a></li>
<li><a href='#utils_data'><p>Utilities for data Copy-Pasta</p></a></li>
<li><a href='#utils_data_org'><p>Utilities for data organization</p></a></li>
<li><a href='#utils_mat'><p>Utilities for handling with matrices</p></a></li>
<li><a href='#utils_na_zero'><p>Utilities for handling with NA and zero values</p></a></li>
<li><a href='#utils_num_str'><p>Utilities for handling with numbers and strings</p></a></li>
<li><a href='#utils_progress'><p>Utilities for text progress bar in the terminal</p></a></li>
<li><a href='#utils_rows_cols'><p>Utilities for handling with rows and columns</p></a></li>
<li><a href='#utils_samples'><p>Random Sampling</p></a></li>
<li><a href='#utils_sets'><p>Utilities for set operations for many sets</p></a></li>
<li><a href='#utils_stats'><p>Useful functions for computing descriptive statistics</p></a></li>
<li><a href='#utils_wd'><p>Set and get the Working Directory quicky</p></a></li>
<li><a href='#venn_plot'><p>Draw Venn diagrams</p></a></li>
<li><a href='#waas'><p>Weighted Average of Absolute Scores</p></a></li>
<li><a href='#waas_means'><p>Weighted Average of Absolute Scores</p></a></li>
<li><a href='#waasb'><p>Weighted Average of Absolute Scores</p></a></li>
<li><a href='#wsmp'><p>Weighting between stability and mean performance</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multi Environment Trials Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.19.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tiago Olivoto &lt;tiagoolivoto@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs stability analysis of multi-environment trial data
    using parametric and non-parametric methods. Parametric methods
    includes Additive Main Effects and Multiplicative Interaction (AMMI)
    analysis by Gauch (2013) &lt;<a href="https://doi.org/10.2135%2Fcropsci2013.04.0241">doi:10.2135/cropsci2013.04.0241</a>&gt;, Ecovalence
    by Wricke (1965), Genotype plus Genotype-Environment (GGE) biplot
    analysis by Yan &amp; Kang (2003) &lt;<a href="https://doi.org/10.1201%2F9781420040371">doi:10.1201/9781420040371</a>&gt;, geometric
    adaptability index by Mohammadi &amp; Amri (2008)
    &lt;<a href="https://doi.org/10.1007%2Fs10681-007-9600-6">doi:10.1007/s10681-007-9600-6</a>&gt;, joint regression analysis by Eberhart
    &amp; Russel (1966) &lt;<a href="https://doi.org/10.2135%2Fcropsci1966.0011183X000600010011x">doi:10.2135/cropsci1966.0011183X000600010011x</a>&gt;,
    genotypic confidence index by Annicchiarico (1992), Murakami &amp; Cruz's
    (2004) method, power law residuals (POLAR) statistics by Doring et al.
    (2015) &lt;<a href="https://doi.org/10.1016%2Fj.fcr.2015.08.005">doi:10.1016/j.fcr.2015.08.005</a>&gt;, scale-adjusted coefficient of
    variation by Doring &amp; Reckling (2018) &lt;<a href="https://doi.org/10.1016%2Fj.eja.2018.06.007">doi:10.1016/j.eja.2018.06.007</a>&gt;,
    stability variance by Shukla (1972) &lt;<a href="https://doi.org/10.1038%2Fhdy.1972.87">doi:10.1038/hdy.1972.87</a>&gt;,
    weighted average of absolute scores by Olivoto et al. (2019a)
    &lt;<a href="https://doi.org/10.2134%2Fagronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>&gt;, and multi-trait stability index by
    Olivoto et al. (2019b) &lt;<a href="https://doi.org/10.2134%2Fagronj2019.03.0221">doi:10.2134/agronj2019.03.0221</a>&gt;.
    Non-parametric methods includes superiority index by Lin &amp; Binns
    (1988) &lt;<a href="https://doi.org/10.4141%2Fcjps88-018">doi:10.4141/cjps88-018</a>&gt;, nonparametric measures of phenotypic
    stability by Huehn (1990) &lt;<a href="https://doi.org/10.1007%2FBF00024241">doi:10.1007/BF00024241</a>&gt;, TOP third
    statistic by Fox et al. (1990) &lt;<a href="https://doi.org/10.1007%2FBF00040364">doi:10.1007/BF00040364</a>&gt;. Functions for
    computing biometrical analysis such as path analysis, canonical
    correlation, partial correlation, clustering analysis, and tools for
    inspecting, manipulating, summarizing and plotting typical
    multi-environment trial data are also provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nepem-ufsc/metan">https://github.com/nepem-ufsc/metan</a>,
<a href="https://nepem-ufsc.github.io/metan/">https://nepem-ufsc.github.io/metan/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nepem-ufsc/metan/issues">https://github.com/nepem-ufsc/metan/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 1.0.0), GGally, ggforce, ggplot2 (&ge; 3.3.0),
ggrepel, lme4, lmerTest, magrittr, mathjaxr, methods,
patchwork, purrr, rlang (&ge; 0.4.11), tibble, tidyr, tidyselect
(&ge; 1.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>DT, knitr, rmarkdown, roxygen2, rstudioapi</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>mathjaxr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-13 23:52:54 UTC; tiago</td>
</tr>
<tr>
<td>Author:</td>
<td>Tiago Olivoto <a href="https://orcid.org/0000-0002-0241-9636"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-15 01:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code style="white-space: pre;">&#8288;magrittr::[\%&gt;\%][magrittr::pipe]&#8288;</code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='acv'>Adjusted Coefficient of Variation
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></h2><span id='topic+acv'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes the scale-adjusted coefficient of variation,
<em>acv</em>, (Doring and Reckling, 2018) to account for the systematic
dependence of \(\sigma^2\) from \(\mu\). The <em>acv</em> is
computed as follows:
\[acv = \frac{\sqrt{10^{\tilde v_i}}}{\mu_i}\times 100\]
where \(\tilde v_i\) is the adjusted logarithm of the variance
computed as:
\[\tilde v_i = a + (b - 2)\frac{1}{n}\sum m_i + 2m_i + e_i\]
being \(a\) and \(b\) the coefficients of the linear regression for
\(log_{10}\) of the variance over the \(log_{10}\) of the mean;
\( m_i\) is the \(log_{10}\) of the mean, and \( e_i\) is the
Power Law Residuals (POLAR), i.e., the residuals for the previously described
regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acv(mean, var, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="acv_+3A_mean">mean</code></td>
<td>
<p>A numeric vector with mean values.</p>
</td></tr>
<tr><td><code id="acv_+3A_var">var</code></td>
<td>
<p>A numeric vector with variance values.</p>
</td></tr>
<tr><td><code id="acv_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with a
warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the following columns
</p>

<ul>
<li> <p><strong>mean</strong> The mean values.
</p>
</li>
<li> <p><strong>var</strong> The variance values;
</p>
</li>
<li> <p><strong>log10_mean</strong> The base 10 logarithm of mean;
</p>
</li>
<li> <p><strong>log10_var</strong> The base 10 logarithm of variance;
</p>
</li>
<li> <p><strong>POLAR</strong> The Power Law Residuals;
</p>
</li>
<li> <p><strong>cv</strong> The standard coefficient of variation;
</p>
</li>
<li> <p><strong>acv</strong> Adjusted coefficient of variation.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Doring, T.F., and M. Reckling. 2018. Detecting global trends of
cereal yield stability by adjusting the coefficient of variation. Eur. J.
Agron. 99: 30-36. <a href="https://doi.org/10.1016/j.eja.2018.06.007">doi:10.1016/j.eja.2018.06.007</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
################# Table 1 from Doring and Reckling (2018)  ###########

# Mean values
u &lt;- c(0.5891, 0.6169, 0.7944, 1.0310, 1.5032, 3.8610, 4.6969, 6.1148,
       7.1526, 7.5348, 1.2229, 1.6321, 2.4293, 2.5011, 3.0161)

# Variances
v &lt;- c(0.0064, 0.0141, 0.0218, 0.0318, 0.0314, 0.0766, 0.0620, 0.0822,
       0.1605, 0.1986, 0.0157, 0.0593, 0.0565, 0.1997, 0.2715)

library(metan)
acv(u, v)

</code></pre>

<hr>
<h2 id='ammi_indexes'>AMMI-based stability indexes</h2><span id='topic+ammi_indexes'></span>

<h3>Description</h3>


<ul>
<li> <p><code>ammi_indexes()</code> <a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a> computes several AMMI-based stability statistics. See
<strong>Details</strong> for a detailed overview.
</p>
</li>
<li> <p><code>AMMI_indexes()</code> <a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> use <code>ammi_indexes()</code> instead.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>ammi_indexes(.data, order.y = NULL, level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ammi_indexes_+3A_.data">.data</code></td>
<td>
<p>An object of class <code>waas</code> or <code>performs_ammi</code></p>
</td></tr>
<tr><td><code id="ammi_indexes_+3A_order.y">order.y</code></td>
<td>
<p>A vector of the same length of <code>x</code> used to order the
response variable. Each element of the vector must be one of the <code>'h'</code>
or <code>'l'</code>. If <code>'h'</code> is used, the response variable will be ordered
from maximum to minimum. If <code>'l'</code> is used then the response variable
will be ordered from minimum to maximum. Use a comma-separated vector of
names. For example, <code>order.y = c("h, h, l, h, l")</code>.</p>
</td></tr>
<tr><td><code id="ammi_indexes_+3A_level">level</code></td>
<td>
<p>The confidence level. Defaults to 0.95.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>First, let's define some symbols: \(N'\) is the number of significant
interation principal component axis (IPCs) that were retained in the AMMI
model via F tests); \(\lambda_{n}\) is the singular value for th IPC and
correspondingly \(\lambda_{n}^{2}\) its eigen value; \(\gamma_{in}\)
is the eigenvector value for ith genotype; \(\delta_{jn}\) is the
eigenvector value for the th environment. \(PC_{1}\), \(PC_{2}\),
and \(PC_{n}\) are the scores of 1st, 2nd, and nth IPC; respectively;
\(\theta_{1}\), \(\theta_{2}\), and \(\theta_{n}\)  are
percentage sum of squares explained by the 1st, 2nd, and nth IPC,
respectively.
</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>

<ul>
<li><p> AMMI Based Stability Parameter (ASTAB) (Rao and Prabhakaran 2005).
\[ASTAB = \sum_{n=1}^{N'}\lambda_{n}\gamma_{in}^{2}\]
</p>
</li>
<li><p> AMMI Stability Index (ASI) (Jambhulkar et al. 2017)
\[ASI = \sqrt{\left [ PC_{1}^{2} \times \theta_{1}^{2} \right ]+\left[ PC_{2}^{2} \times \theta_{2}^{2} \right ]}\]
</p>
</li>
<li><p> AMMI-stability value (ASV) (Purchase et al., 2000).
\[ASV_{i}=\sqrt{\frac{SS_{IPCA1}}{SS_{IPCA2}}(\mathrm{IPC} \mathrm{A} 1)^{2}+(\mathrm{IPCA} 2)^{2}}\]
</p>
</li>
<li><p> Sum Across Environments of Absolute Value of GEI Modelled by AMMI (AVAMGE) (Zali et al. 2012)
\[AV_{(AMGE)} = \sum_{j=1}^{E} \sum_{n=1}^{N'} \left |\lambda_{n}\gamma_{in} \delta_{jn} \right |\]
</p>
</li>
<li><p> Annicchiarico's D Parameter values (Da) (Annicchiarico 1997)
\[D_{a} = \sqrt{\sum_{n=1}^{N'}(\lambda_{n}\gamma_{in})^2}\]
</p>
</li>
<li><p> Zhang's D Parameter (Dz) (Zhang et al. 1998)
\[D_{z} = \sqrt{\sum_{n=1}^{N'}\gamma_{in}^{2}}\]
</p>
</li>
<li><p> Sums of the Averages of the Squared Eigenvector Values (EV) (Zobel 1994)
\[EV = \sum_{n=1}^{N'}\frac{\gamma_{in}^2}{N'}\]
</p>
</li>
<li><p> Stability Measure Based on Fitted AMMI Model (FA) (Raju 2002)
\[FA = \sum_{n=1}^{N'}\lambda_{n}^{2}\gamma_{in}^{2}\]
</p>
</li>
<li><p> Modified AMMI Stability Index (MASI) (Ajay et al. 2018)
\[MASI = \sqrt{ \sum_{n=1}^{N'} PC_{n}^{2} \times \theta_{n}^{2}}\]
</p>
</li>
<li><p> Modified AMMI Stability Value (MASV) (Ajay et al. 2019)
\[MASV = \sqrt{\sum_{n=1}^{N'-1}\left (\frac{SSIPC_{n}}{SSIPC_{n+1}} \right ) \times (PC_{n})^2   + \left (PC_{N'}\right )^2}\]
</p>
</li>
<li><p> Sums of the Absolute Value of the IPC Scores (SIPC) (Sneller et al. 1997)
\[SIPC = \sum_{n=1}^{N'} | \lambda_{n}^{0.5}\gamma_{in}|\]
</p>
</li>
<li><p> Absolute Value of the Relative Contribution of IPCs to the Interaction (Za) (Zali et al. 2012)
\[Za = \sum_{i=1}^{N'} | \theta_{n}\gamma_{in} |\]
</p>
</li>
<li><p> Weighted average of absolute scores (WAAS) (Olivoto et al. 2019)
\[WAAS_i = \sum_{k = 1}^{p} |IPCA_{ik} \times \theta_{k}/ \sum_{k = 1}^{p}\theta_{k}\]
</p>
</li></ul>

<p>For all the statistics, simultaneous selection indexes (SSI) are also
computed by summation of the ranks of the stability and mean performance,
Y_R, (Farshadfar, 2008).
</p>


<h3>Value</h3>

<p>A list where each element contains the result AMMI-based stability indexes
for one variable.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Ajay BC, Aravind J, Abdul Fiyaz R, Bera SK, Kumar N, Gangadhar K, Kona P
(2018). “Modified AMMI Stability Index (MASI) for stability analysis.”
ICAR-DGR Newsletter, 18, 4–5.
</p>
<p>Ajay BC, Aravind J, Fiyaz RA, Kumar N, Lal C, Gangadhar K, Kona P, Dagla MC,
Bera SK (2019). “Rectification of modified AMMI stability value (MASV).”
Indian Journal of Genetics and Plant Breeding (The), 79, 726–731.
https://www.isgpb.org/article/rectification-of-modified-ammi-stability-value-masv.
</p>
<p>Annicchiarico P (1997). “Joint regression vs AMMI analysis of
genotype-environment interactions for cereals in Italy.” Euphytica, 94(1),
53–62. <a href="https://doi.org/10.1023/A%3A1002954824178">doi:10.1023/A:1002954824178</a>
</p>
<p>Farshadfar E (2008) Incorporation of AMMI stability value and grain yield in
a single non-parametric index (GSI) in bread wheat. Pakistan J Biol Sci
11:1791–1796. <a href="https://doi.org/10.3923/pjbs.2008.1791.1796">doi:10.3923/pjbs.2008.1791.1796</a>
</p>
<p>Jambhulkar NN, Rath NC, Bose LK, Subudhi HN, Biswajit M, Lipi D, Meher J
(2017). “Stability analysis for grain yield in rice in demonstrations
conducted during rabi season in India.” Oryza, 54(2), 236–240.
<a href="https://doi.org/10.5958/2249-5266.2017.00030.3">doi:10.5958/2249-5266.2017.00030.3</a>
</p>
<p>Olivoto T, LUcio ADC, Silva JAG, et al (2019) Mean Performance and Stability
in Multi-Environment Trials I: Combining Features of AMMI and BLUP
Techniques. Agron J 111:2949–2960. <a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Raju BMK (2002). “A study on AMMI model and its biplots.” Journal of the
Indian Society of Agricultural Statistics, 55(3), 297–322.
</p>
<p>Rao AR, Prabhakaran VT (2005). “Use of AMMI in simultaneous selection of
genotypes for yield and stability.” Journal of the Indian Society of
Agricultural Statistics, 59, 76–82.
</p>
<p>Sneller CH, Kilgore-Norquest L, Dombek D (1997). “Repeatability of yield
stability statistics in soybean.” Crop Science, 37(2), 383–390.
<a href="https://doi.org/10.2135/cropsci1997.0011183X003700020013x">doi:10.2135/cropsci1997.0011183X003700020013x</a>
</p>
<p>Zali H, Farshadfar E, Sabaghpour SH, Karimizadeh R (2012). “Evaluation of
genotype × environment interaction in chickpea using measures of stability
from AMMI model.” Annals of Biological Research, 3(7), 3126–3136.
</p>
<p>Zhang Z, Lu C, Xiang Z (1998). “Analysis of variety stability based on AMMI
model.” Acta Agronomica Sinica, 24(3), 304–309.
http://zwxb.chinacrops.org/EN/Y1998/V24/I03/304.
</p>
<p>Zobel RW (1994). “Stress resistance and root systems.” In Proceedings of the
Workshop on Adaptation of Plants to Soil Stress. 1-4 August, 1993. INTSORMIL
Publication 94-2, 80–99. Institute of Agriculture and Natural Resources,
University of Nebraska-Lincoln.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;-
  performs_ammi(data_ge,
                env = ENV,
                gen = GEN,
                rep = REP,
                resp = c(GY, HM))
model_indexes &lt;- ammi_indexes(model)


# Alternatively (and more intuitively) using %&gt;%
# If resp is not declared, all traits are analyzed
res_ind &lt;- data_ge %&gt;%
           performs_ammi(ENV, GEN, REP, verbose = FALSE) %&gt;%
           ammi_indexes()

rbind_fill_id(res_ind, .id = "TRAIT")


</code></pre>

<hr>
<h2 id='Annicchiarico'>Annicchiarico's genotypic confidence index</h2><span id='topic+Annicchiarico'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Stability analysis using the known genotypic confidence index (Annicchiarico,
1992).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Annicchiarico(.data, env, gen, rep, resp, prob = 0.25, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Annicchiarico_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s)</p>
</td></tr>
<tr><td><code id="Annicchiarico_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="Annicchiarico_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="Annicchiarico_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks</p>
</td></tr>
<tr><td><code id="Annicchiarico_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="Annicchiarico_+3A_prob">prob</code></td>
<td>
<p>The probability of error assumed.</p>
</td></tr>
<tr><td><code id="Annicchiarico_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where each element is the result for one variable and contains the
following data frames:
</p>

<ul>
<li> <p><strong>environments</strong> Contains the mean, environmental index and
classification as favorable and unfavorable environments.
</p>
</li>
<li> <p><strong>general</strong> Contains the genotypic confidence index considering all
environments.
</p>
</li>
<li> <p><strong>favorable</strong> Contains the genotypic confidence index considering
favorable environments.
</p>
</li>
<li> <p><strong>unfavorable</strong> Contains the genotypic confidence index considering
unfavorable environments.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto, <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Annicchiarico, P. 1992. Cultivar adaptation and recommendation
from alfalfa trials in Northern Italy. J. Genet. Breed. 46:269-278.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+superiority">superiority()</a></code>, <code><a href="#topic+ecovalence">ecovalence()</a></code>, <code><a href="#topic+ge_stats">ge_stats()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
Ann &lt;- Annicchiarico(data_ge2,
                    env = ENV,
                    gen = GEN,
                    rep = REP,
                    resp = PH)
print(Ann)


</code></pre>

<hr>
<h2 id='anova_ind'>Within-environment analysis of variance</h2><span id='topic+anova_ind'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs a within-environment analysis of variance in randomized complete
block or alpha-lattice designs and returns values such as Mean Squares,
p-values, coefficient of variation, heritability, and accuracy of selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova_ind(.data, env, gen, rep, resp, block = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova_ind_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="anova_ind_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments. The analysis of variance is computed for each level of this
factor.</p>
</td></tr>
<tr><td><code id="anova_ind_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="anova_ind_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="anova_ind_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="anova_ind_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p>
</td></tr>
<tr><td><code id="anova_ind_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where each element is the result for one variable containing
(1) <strong>individual</strong>: A tidy tbl_df with the results of the individual
analysis of variance with the following column names, and (2) <strong>MSRatio</strong>:
The ratio between the higher and lower residual mean square. The following
columns are returned, depending on the experimental design
</p>

<ul>
<li> <p><strong>For analysis in alpha-lattice designs</strong>:
</p>

<ul>
<li> <p><code>MEAN</code>: The grand mean.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;DFG, DFCR, and DFIB_R, and DFE&#8288;</code>: The degree of freedom for genotype,
complete replicates, incomplete blocks within replicates, and error,
respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;MSG, MSCR, MSIB_R&#8288;</code>: The mean squares for genotype, replicates, incomplete
blocks within replicates, and error, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;FCG, FCR, FCIB_R&#8288;</code>: The F-calculated for genotype, replicates and
incomplete blocks within replicates, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;PFG, PFCR, PFIB_R&#8288;</code>: The P-values for genotype, replicates and incomplete
blocks within replicates, respectively.
</p>
</li>
<li> <p><code>CV</code>: coefficient of variation.
</p>
</li>
<li> <p><code>h2</code>: broad-sense heritability.
</p>
</li>
<li> <p><code>AS</code>: accuracy of selection (square root of <code>h2</code>)
</p>
</li></ul>

</li>
<li> <p><strong>For analysis in randomized complete block design</strong>:
</p>

<ul>
<li> <p><code>MEAN</code>: The grand mean.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;DFG, DFB, and DFE&#8288;</code>: The degree of freedom for genotype blocks, and error, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;MSG, MSB, and MSE&#8288;</code>: The mean squares for genotype blocks, and error, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;FCG and FCB&#8288;</code>: The F-calculated for genotype and blocks, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;PFG and PFB&#8288;</code>: The P-values for genotype and blocks, respectively.
</p>
</li>
<li> <p><code>CV</code>: coefficient of variation.
</p>
</li>
<li> <p><code>h2</code>: broad-sense heritability.
</p>
</li>
<li> <p><code>h2MG</code>: broad-sense heritability at a plot level.
</p>
</li>
<li> <p><code>AS</code>: accuracy of selection (square root of <code>h2</code>)
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# ANOVA for all variables in data
ind_an &lt;- anova_ind(data_ge,
                    env = ENV,
                    gen = GEN,
                    rep = REP,
                    resp = everything())
# mean for each environment
get_model_data(ind_an)

# P-value for genotype effect
get_model_data(ind_an, "PFG")


</code></pre>

<hr>
<h2 id='anova_joint'>Joint analysis of variance</h2><span id='topic+anova_joint'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs a joint analysis of variance to check for the presence of
genotype-vs-environment interactions using both randomized complete block and
alpha-lattice designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anova_joint(.data, env, gen, rep, resp, block = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova_joint_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="anova_joint_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments. The analysis of variance is computed for each level of this
factor.</p>
</td></tr>
<tr><td><code id="anova_joint_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="anova_joint_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="anova_joint_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="anova_joint_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p>
</td></tr>
<tr><td><code id="anova_joint_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where each element is the result for one variable containing
the following objects:
</p>

<ul>
<li> <p><strong>anova:</strong> The two-way ANOVA table
</p>
</li>
<li> <p><strong>model:</strong> The model of class <code>lm</code>.
</p>
</li>
<li> <p><strong>augment:</strong> Information about each observation in the dataset. This
includes predicted values in the <code>fitted</code> column, residuals in the
<code>resid</code> column, standardized residuals in the <code>stdres</code> column,
the diagonal of the 'hat' matrix in the <code>hat</code>, and standard errors for
the fitted values in the <code>se.fit</code> column.
</p>
</li>
<li> <p><strong>details:</strong> A tibble with the following data: <code>Ngen</code>, the
number of genotypes; <code>OVmean</code>, the grand mean; <code>Min</code>, the minimum
observed (returning the genotype and replication/block); <code>Max</code> the
maximum observed, <code>MinGEN</code> the loser winner genotype, <code>MaxGEN</code>,
the winner genotype.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_model_data">get_model_data()</a></code> <code><a href="#topic+anova_ind">anova_ind()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# traditional usage approach
j_an &lt;- anova_joint(data_ge,
                    env = ENV,
                    gen = GEN,
                    rep = REP,
                    resp = everything())
# Predicted values
get_model_data(j_an)

# Details
get_model_data(j_an, "details")


</code></pre>

<hr>
<h2 id='arrange_ggplot'>Arrange separate ggplots into the same graphic</h2><span id='topic+arrange_ggplot'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This is a wraper function around <code><a href="patchwork.html#topic+wrap_plots">patchwork::wrap_plots()</a></code> and
<code><a href="patchwork.html#topic+plot_annotation">patchwork::plot_annotation()</a></code> to arrange ggplot2 objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arrange_ggplot(
  ...,
  nrow = NULL,
  ncol = NULL,
  widths = NULL,
  heights = NULL,
  guides = NULL,
  design = NULL,
  legend.position = "bottom",
  title = NULL,
  subtitle = NULL,
  caption = NULL,
  tag_levels = NULL,
  tag_prefix = NULL,
  tag_suffix = NULL,
  tag_sep = NULL,
  theme = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arrange_ggplot_+3A_...">...</code></td>
<td>
<p>multiple <code>ggplot</code>s or a list containing <code>ggplot</code>
objects.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_nrow">nrow</code>, <code id="arrange_ggplot_+3A_ncol">ncol</code></td>
<td>
<p>The number of rows and columns, respectively.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_widths">widths</code>, <code id="arrange_ggplot_+3A_heights">heights</code></td>
<td>
<p>The relative widths and heights of each column and row
in the grid. Will get repeated to match the dimensions of the grid.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_guides">guides</code></td>
<td>
<p>A string specifying how guides should be treated in the layout.
Defaults to <code>'auto'</code>. Other possible values are <code>'keep'</code> and <code>'collect'</code>.
In this case, will collect guides below to the given nesting level,
removing duplicates.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_design">design</code></td>
<td>
<p>Specification of the location of areas in the layout.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_legend.position">legend.position</code></td>
<td>
<p>The position of the legends in the plot if
<code>guides = "collect"</code> Default to <code>'bottom'</code>.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_title">title</code>, <code id="arrange_ggplot_+3A_subtitle">subtitle</code>, <code id="arrange_ggplot_+3A_caption">caption</code></td>
<td>
<p>Text strings to use for the various plot
annotations.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_tag_levels">tag_levels</code></td>
<td>
<p>A character vector defining the enumeration format to use
at each level. Possible values are <code>'a'</code> for lowercase letters, <code>'A'</code> for
uppercase letters, <code>'1'</code> for numbers, <code>'i'</code> for lowercase Roman numerals, and
<code>'I'</code> for uppercase Roman numerals. It can also be a list containing
character vectors defining arbitrary tag sequences. If any element in the
list is a scalar and one of <code>'a'</code>, <code>'A'</code>, <code>'1'</code>, <code>'i'</code>, or <code>'I'</code>, this level
will be expanded to the expected sequence.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_tag_prefix">tag_prefix</code>, <code id="arrange_ggplot_+3A_tag_suffix">tag_suffix</code></td>
<td>
<p>Strings that should appear before or after the
tag.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_tag_sep">tag_sep</code></td>
<td>
<p>A separator between different tag levels.</p>
</td></tr>
<tr><td><code id="arrange_ggplot_+3A_theme">theme</code></td>
<td>
<p>A ggplot theme specification to use for the plot. Only elements
related to the titles as well as plot margin and background is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>patchwork</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)
library(metan)
p1 &lt;- ggplot(mtcars, aes(wt, mpg)) +
      geom_point()

p2 &lt;- ggplot(mpg, aes(class, hwy)) +
             geom_boxplot()

# Default plot
arrange_ggplot(p1, p2)

# Insert plot annotation, titles and subtitles
arrange_ggplot(p1, p2,
               ncol = 1,
               tag_levels = "1",
               tag_prefix = "P.",
               title = "My grouped ggplot",
               subtitle = "Made with arrange_ggplot()",
               caption = "P1 = scatter plot - P2 = boxplot")


</code></pre>

<hr>
<h2 id='as.lpcor'>Coerce to an object of class lpcor</h2><span id='topic+as.lpcor'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Functions to check if an object is of class <code>lpcor</code>, or coerce it if
possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.lpcor(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.lpcor_+3A_...">...</code></td>
<td>
<p>A comma-separated list of matrices to be coerced to a list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>lpcor</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
library(dplyr)
mt_num = mtcars %&gt;% select_if(., is.numeric)
lpdata = as.lpcor(cor(mt_num[1:5]),
                  cor(mt_num[1:5]),
                  cor(mt_num[2:6]),
                  cor(mt_num[4:8]))
is.lpcor(lpdata)


</code></pre>

<hr>
<h2 id='barplots'>Fast way to create bar plots</h2><span id='topic+barplots'></span><span id='topic+plot_bars'></span><span id='topic+plot_factbars'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code>plot_bars()</code> Creates a bar plot based on one categorical variable and
one numeric variable.  It can be used to show the results of a one-way trial
with <strong>qualitative treatments</strong>.
</p>
</li>
<li> <p><code>plot_factbars()</code> Creates a bar plot based on two categorical
variables and one numeric variable.  It can be used to show the results of a
two-way trial with <strong>qualitative-qualitative treatment structure</strong>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>plot_bars(
  .data,
  x,
  y,
  order = NULL,
  y.lim = NULL,
  y.breaks = waiver(),
  y.expand = 0.05,
  y.contract = 0,
  xlab = NULL,
  ylab = NULL,
  n.dodge = 1,
  check.overlap = FALSE,
  color.bar = "black",
  fill.bar = "gray",
  lab.bar = NULL,
  lab.bar.hjust = 0.5,
  lab.bar.vjust = -0.5,
  lab.bar.angle = 0,
  size.text.bar = 5,
  values = FALSE,
  values.hjust = 0.5,
  values.vjust = 1.5,
  values.angle = 0,
  values.digits = 2,
  values.size = 4,
  lab.x.hjust = 0.5,
  lab.x.vjust = 1,
  lab.x.angle = 0,
  errorbar = TRUE,
  stat.erbar = "se",
  width.erbar = NULL,
  level = 0.95,
  invert = FALSE,
  width.bar = 0.9,
  size.line = 0.5,
  size.text = 12,
  fontfam = "sans",
  na.rm = TRUE,
  verbose = FALSE,
  plot_theme = theme_metan()
)

plot_factbars(
  .data,
  ...,
  resp,
  y.lim = NULL,
  y.breaks = waiver(),
  y.expand = 0.05,
  y.contract = 0,
  xlab = NULL,
  ylab = NULL,
  n.dodge = 1,
  check.overlap = FALSE,
  lab.bar = NULL,
  lab.bar.hjust = 0.5,
  lab.bar.vjust = -0.5,
  lab.bar.angle = 0,
  size.text.bar = 5,
  values = FALSE,
  values.hjust = 0.5,
  values.vjust = 1.5,
  values.angle = 0,
  values.digits = 2,
  values.size = 4,
  lab.x.hjust = 0.5,
  lab.x.vjust = 1,
  lab.x.angle = 0,
  errorbar = TRUE,
  stat.erbar = "se",
  width.erbar = NULL,
  level = 0.95,
  invert = FALSE,
  col = TRUE,
  palette = "Spectral",
  width.bar = 0.9,
  legend.position = "bottom",
  size.line = 0.5,
  size.text = 12,
  fontfam = "sans",
  na.rm = TRUE,
  verbose = FALSE,
  plot_theme = theme_metan()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="barplots_+3A_.data">.data</code></td>
<td>
<p>The data set.</p>
</td></tr>
<tr><td><code id="barplots_+3A_x">x</code>, <code id="barplots_+3A_y">y</code></td>
<td>
<p>Argument valid for <code>plot_bars()</code> The variables to be mapped
to the <code>x</code> and <code>y</code> axes, respectively.</p>
</td></tr>
<tr><td><code id="barplots_+3A_order">order</code></td>
<td>
<p>Argument valid for <code>plot_bars()</code>. Controls the order of the
factor in the <code>x</code> axis. Defaults to the order of the factors in
<code>.data</code>. Use <code>order = "asce"</code> or <code>order = "desc"</code> to reorder
the labels to ascending or descending order, respectively, based on the
values of the variable <code>y</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_y.lim">y.lim</code></td>
<td>
<p>The range of y axis. Defaults to <code>NULL</code> (maximum and
minimum values of the data set). New values can be inserted as <code>y.lim = c(y.min, y.max)</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_y.breaks">y.breaks</code></td>
<td>
<p>The breaks to be plotted in the y-axis. Defaults to waiver().
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. The same arguments than <code>x.breaks</code> can be
used.</p>
</td></tr>
<tr><td><code id="barplots_+3A_y.expand">y.expand</code>, <code id="barplots_+3A_y.contract">y.contract</code></td>
<td>
<p>A multiplication range expansion/contraction
factor. <code>y.expand</code> expands the upper limit of the y escale, while
<code>y.contract</code> contracts the lower limit of the y scale. By default
<code>y.expand = 0.05</code> and <code>y.contract = 0</code> produces a plot without
spacing in the lower y limit and an expansion in the upper y limit.</p>
</td></tr>
<tr><td><code id="barplots_+3A_xlab">xlab</code>, <code id="barplots_+3A_ylab">ylab</code></td>
<td>
<p>The labels of the axes x and y, respectively. Defaults to
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_n.dodge">n.dodge</code></td>
<td>
<p>The number of rows that should be used to render the x labels.
This is useful for displaying labels that would otherwise overlap.</p>
</td></tr>
<tr><td><code id="barplots_+3A_check.overlap">check.overlap</code></td>
<td>
<p>Silently remove overlapping labels, (recursively)
prioritizing the first, last, and middle labels.</p>
</td></tr>
<tr><td><code id="barplots_+3A_color.bar">color.bar</code>, <code id="barplots_+3A_fill.bar">fill.bar</code></td>
<td>
<p>Argument valid for <code>plot_bars()</code>. The color and
fill values of the bars.</p>
</td></tr>
<tr><td><code id="barplots_+3A_lab.bar">lab.bar</code></td>
<td>
<p>A vector of characters to show in each bar. Defaults to NULL.</p>
</td></tr>
<tr><td><code id="barplots_+3A_lab.bar.hjust">lab.bar.hjust</code>, <code id="barplots_+3A_lab.bar.vjust">lab.bar.vjust</code></td>
<td>
<p>The horizontal and vertical adjust for the
labels in the bar. Defaults to 0.5 and -0.5, respectively.</p>
</td></tr>
<tr><td><code id="barplots_+3A_lab.bar.angle">lab.bar.angle</code></td>
<td>
<p>The angle for the labels in the plot. Defaults to 0. Use
in combination with <code>lab.bar.hjust</code> and <code>lab.bar.vjust</code> to best
fit the labels in the plot.</p>
</td></tr>
<tr><td><code id="barplots_+3A_size.text.bar">size.text.bar</code></td>
<td>
<p>The size of the text in the bar labels.</p>
</td></tr>
<tr><td><code id="barplots_+3A_values">values</code></td>
<td>
<p>Logical argument. Shows the values in the plot bar?
Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="barplots_+3A_values.hjust">values.hjust</code>, <code id="barplots_+3A_values.vjust">values.vjust</code></td>
<td>
<p>The horizontal and vertical adjust
for the values in the bar. Defaults to 0.5 and 1.5, respectively. If
<code>values = TRUE</code> the values are shown bellow the error bar.</p>
</td></tr>
<tr><td><code id="barplots_+3A_values.angle">values.angle</code></td>
<td>
<p>The angle for the labels in the plot. Defaults to 0.
Use in combination with <code>values.hjust</code> and <code>values.vjust</code>
to best fit the values in the plot bar.</p>
</td></tr>
<tr><td><code id="barplots_+3A_values.digits">values.digits</code></td>
<td>
<p>The significant digits to show if <code>values = TRUE</code>. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_values.size">values.size</code></td>
<td>
<p>The size of the text for values shown in the bars.
Defaults to <code>3</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_lab.x.hjust">lab.x.hjust</code>, <code id="barplots_+3A_lab.x.vjust">lab.x.vjust</code></td>
<td>
<p>The horizontal and vertical adjust for the
labels in the bar. Defaults to 0.5 and 1, respectively.</p>
</td></tr>
<tr><td><code id="barplots_+3A_lab.x.angle">lab.x.angle</code></td>
<td>
<p>The angle for the labels in x axis. Defaults to 0. Use
in combination with <code>lab.x.hjust</code> and <code>lab.x.vjust</code> to best
fit the labels in the axis.</p>
</td></tr>
<tr><td><code id="barplots_+3A_errorbar">errorbar</code></td>
<td>
<p>Logical argument, set to TRUE. In this case, an error bar is
shown.</p>
</td></tr>
<tr><td><code id="barplots_+3A_stat.erbar">stat.erbar</code></td>
<td>
<p>The statistic to be shown in the errorbar. Must be one of
the <code>stat.erbar = "se"</code> (standard error, default), <code>stat.erbar = "sd"</code> (standard deviation), or <code>stat.erbar = "ci"</code> (confidence
interval), based on the confidence level in the argument <code>level</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_width.erbar">width.erbar</code></td>
<td>
<p>The width of the error bar. Defaults to 25% of
<code>width.bar</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_level">level</code></td>
<td>
<p>The confidence level</p>
</td></tr>
<tr><td><code id="barplots_+3A_invert">invert</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, rotate the plot in
<code>plot_bars()</code> and invert the order of the factors in
<code>plot_factbars()</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_width.bar">width.bar</code></td>
<td>
<p>The width of the bars in the graph. Defaults to 0.9.
Possible values are in the range 0-1.</p>
</td></tr>
<tr><td><code id="barplots_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line in the bars. Default to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_size.text">size.text</code></td>
<td>
<p>The size of the text. Default to <code>12</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_fontfam">fontfam</code></td>
<td>
<p>The family of the font text. Defaults to <code>"sans"</code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_na.rm">na.rm</code></td>
<td>
<p>Should 'NA' values be removed to compute the statistics?
Defaults to true</p>
</td></tr>
<tr><td><code id="barplots_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If TRUE a tibble containing the mean, N,
standard deviation, standard error of mean and confidence interval is
returned.</p>
</td></tr>
<tr><td><code id="barplots_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="barplots_+3A_...">...</code></td>
<td>
<p>Argument valid for <code>plot_factbars()</code>. A comma-separated list
of unquoted variable names. Sets the two variables to be mapped to the
<code>x</code> axis.</p>
</td></tr>
<tr><td><code id="barplots_+3A_resp">resp</code></td>
<td>
<p>Argument valid for <code>plot_factbars()</code>. The response variable
to be mapped to the y axis.</p>
</td></tr>
<tr><td><code id="barplots_+3A_col">col</code></td>
<td>
<p>Logical argument valid for <code>plot_factbars()</code>. If
<code>FALSE</code>, a gray scale is used.</p>
</td></tr>
<tr><td><code id="barplots_+3A_palette">palette</code></td>
<td>
<p>Argument valid for <code>plot_factbars()</code> The color palette to
be used. For more details, see <code>?scale_colour_brewer</code></p>
</td></tr>
<tr><td><code id="barplots_+3A_legend.position">legend.position</code></td>
<td>
<p>The position of the legend in the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_lines">plot_lines()</a></code>, <code><a href="#topic+plot_factlines">plot_factlines()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# two categorical variables
plot_factbars(data_ge2,
              GEN,
              ENV,
              resp = PH)

# one categorical variable
p1 &lt;- plot_bars(data_g, GEN, PH)
p2 &lt;- plot_bars(data_g, GEN, PH,
                n.dodge = 2, # two rows for x labels
                y.expand = 0.1, # expand y scale
                y.contract = -0.75, # contract the lower limit
                errorbar = FALSE, # remove errorbar
                color.bar = "red", # color of bars
                fill.bar = alpha_color("cyan", 75), # create a transparent color
                lab.bar = letters[1:13]) # add labels
arrange_ggplot(p1, p2)

</code></pre>

<hr>
<h2 id='bind_cv'>Bind cross-validation objects</h2><span id='topic+bind_cv'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Helper function that combines objects of class <code>cv_ammi</code>,
<code>cv_ammif</code> or <code>cv_blup</code>. It is useful when looking for a boxplot
containing the RMSPD values of those cross-validation procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bind_cv(..., bind = "boot", sort = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bind_cv_+3A_...">...</code></td>
<td>
<p>Input objects of class <code>cv_ammi</code>, <code>cv_ammif</code> or
<code>cv_blup</code>.</p>
</td></tr>
<tr><td><code id="bind_cv_+3A_bind">bind</code></td>
<td>
<p>What data should be used? To plot the RMSPD, use 'boot'
(default). Use <code>bind = 'means'</code> to return the RMSPD mean for each
model.</p>
</td></tr>
<tr><td><code id="bind_cv_+3A_sort">sort</code></td>
<td>
<p>Used to sort the RMSPD mean in ascending order.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>cv_ammif</code>. The results will depend on the
argument <code>bind</code>. If <code>bind = 'boot'</code> then the RMSPD of all models
in <code>...</code> will be bind to a unique data frame. If <code>bind = 'means'</code>
then the RMSPD mean of all models in <code>...</code> will be bind to an unique
data frame.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# Two examples with only 5 resampling procedures
AMMI &lt;- cv_ammi(data_ge,
                resp = GY,
                gen = GEN,
                env = ENV,
                rep = REP,
                nboot = 5)
BLUP &lt;- cv_blup(data_ge,
                resp = GY,
                gen = GEN,
                env = ENV,
                rep = REP,
                nboot = 5)
bind_data &lt;- bind_cv(AMMI, BLUP)
plot(bind_data)

print(bind_cv(AMMI, BLUP, bind = 'means'))


</code></pre>

<hr>
<h2 id='blup_indexes'>Stability indexes based on a mixed-effect model</h2><span id='topic+blup_indexes'></span><span id='topic+hmgv'></span><span id='topic+rpgv'></span><span id='topic+hmrpgv'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code><a href="#topic+hmgv">hmgv()</a></code> Computes the harmonic mean of genotypic values (HMGV).
</p>
</li>
<li> <p><code><a href="#topic+rpgv">rpgv()</a></code> Computes the relative performance of the genotypic values (RPGV).
</p>
</li>
<li> <p><code><a href="#topic+hmrpgv">hmrpgv()</a></code> Computes the harmonic mean of the relative performance of
genotypic values (HMRPGV).
</p>
</li>
<li> <p><code><a href="#topic+blup_indexes">blup_indexes()</a></code> Is a wrapper around the above functions that also computes
the WAASB index (Olivoto et al. 2019) if an object computed with <code><a href="#topic+waasb">waasb()</a></code> is
used as input data.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>hmgv(model)

rpgv(model)

hmrpgv(model)

blup_indexes(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="blup_indexes_+3A_model">model</code></td>
<td>
<p>An object of class <code>waasb</code> computed with <code><a href="#topic+waasb">waasb()</a></code> or
<code><a href="#topic+gamem_met">gamem_met()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The indexes computed with this function have been used to select genotypes
with stability performance in a mixed-effect model framework. Some examples
are in Alves et al (2018), Azevedo Peixoto et al. (2018), Dias et al. (2018)
and Colombari Filho et al. (2013).
</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>The HMGV index is computed as
\[HMG{V_i} = \frac{E}{{\sum\limits_{j = 1}^E {\frac{1}{{G{v_{ij}}}}}}}\]
</p>
<p>where \(E\) is the number of environments included in the analysis,
\(Gv_{ij}\) is the genotypic value (BLUP) for the ith genotype in the
jth environment.
</p>
<p>The RPGV index is computed as
\[RPGV_i = \frac{1}{E}{\sum\limits_{j = 1}^E {Gv_{ij}} /\mathop \mu
\nolimits_j }\]
</p>
<p>The HMRPGV index is computed as
\[HMRPG{V_i} = \frac{E}{{\sum\limits_{j = 1}^E
{\frac{1}{{G{v_{ij}}/{\mu _j}}}} }}\]
</p>


<h3>Value</h3>

<p>A tibble containing the indexes.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Alves, R.S., L. de Azevedo Peixoto, P.E. Teodoro, L.A. Silva, E.V.
Rodrigues, M.D.V. de Resende, B.G. Laviola, and L.L. Bhering. 2018.
Selection of Jatropha curcas families based on temporal stability and
adaptability of genetic values. Ind. Crops Prod. 119:290-293.
<a href="https://doi.org/10.1016/J.INDCROP.2018.04.029">doi:10.1016/J.INDCROP.2018.04.029</a>
</p>
<p>Azevedo Peixoto, L. de, P.E. Teodoro, L.A. Silva, E.V. Rodrigues, B.G.
Laviola, and L.L. Bhering. 2018. Jatropha half-sib family selection with
high adaptability and genotypic stability. PLoS One 13:e0199880.
<a href="https://doi.org/10.1371/journal.pone.0199880">doi:10.1371/journal.pone.0199880</a>
</p>
<p>Colombari Filho, J.M., M.D.V. de Resende, O.P. de Morais, A.P. de Castro,
E.P. Guimaraes, J.A. Pereira, M.M. Utumi, and F. Breseghello. 2013. Upland
rice breeding in Brazil: a simultaneous genotypic evaluation of stability,
adaptability and grain yield. Euphytica 192:117-129.
<a href="https://doi.org/10.1007/s10681-013-0922-2">doi:10.1007/s10681-013-0922-2</a>
</p>
<p>Dias, P.C., A. Xavier, M.D.V. de Resende, M.H.P. Barbosa, F.A. Biernaski,
R.A. Estopa. 2018. Genetic evaluation of Pinus taeda clones from somatic
embryogenesis and their genotype x environment interaction. Crop Breed.
Appl. Biotechnol. 18:55-64.
<a href="https://doi.org/10.1590/1984-70332018v18n1a8">doi:10.1590/1984-70332018v18n1a8</a>
</p>
<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960. <a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Resende MDV (2007) Matematica e estatistica na analise de experimentos e no
melhoramento genetico. Embrapa Florestas, Colombo
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
res_ind &lt;- waasb(data_ge,
                 env = ENV,
                 gen = GEN,
                 rep = REP,
                 resp = c(GY, HM),
                 verbose = FALSE)
model_indexes &lt;- blup_indexes(res_ind)
gmd(model_indexes)



</code></pre>

<hr>
<h2 id='can_corr'>Canonical correlation analysis</h2><span id='topic+can_corr'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs canonical correlation analysis with collinearity diagnostic,
estimation of canonical loads, canonical scores, and hypothesis testing for
correlation pairs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>can_corr(
  .data,
  FG,
  SG,
  by = NULL,
  use = "cor",
  test = "Bartlett",
  prob = 0.05,
  center = TRUE,
  stdscores = FALSE,
  verbose = TRUE,
  collinearity = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="can_corr_+3A_.data">.data</code></td>
<td>
<p>The data to be analyzed. It can be a data frame (possible with
grouped data passed from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.</p>
</td></tr>
<tr><td><code id="can_corr_+3A_fg">FG</code>, <code id="can_corr_+3A_sg">SG</code></td>
<td>
<p>A comma-separated list of unquoted variable names that will
compose the first (smallest) and second (highest) group of the correlation
analysis, respectively. Select helpers are also allowed.</p>
</td></tr>
<tr><td><code id="can_corr_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="can_corr_+3A_use">use</code></td>
<td>
<p>The matrix to be used. Must be one of 'cor' for analysis using the
correlation matrix (default) or 'cov' for analysis using the covariance
matrix.</p>
</td></tr>
<tr><td><code id="can_corr_+3A_test">test</code></td>
<td>
<p>The test of significance of the relationship between the FG and
SG. Must be one of the 'Bartlett' (default) or 'Rao'.</p>
</td></tr>
<tr><td><code id="can_corr_+3A_prob">prob</code></td>
<td>
<p>The probability of error assumed. Set to 0.05.</p>
</td></tr>
<tr><td><code id="can_corr_+3A_center">center</code></td>
<td>
<p>Should the data be centered to compute the scores?</p>
</td></tr>
<tr><td><code id="can_corr_+3A_stdscores">stdscores</code></td>
<td>
<p>Rescale scores to produce scores of unit variance?</p>
</td></tr>
<tr><td><code id="can_corr_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> (default) then the results
are shown in the console.</p>
</td></tr>
<tr><td><code id="can_corr_+3A_collinearity">collinearity</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> (default) then a
collinearity diagnostic is performed for each group of variables according
to Olivoto et al.(2017).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>.data</code> is a grouped data passed from
<code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code> then the results will be returned into a
list-column of data frames.
</p>

<ul>
<li> <p><strong>Matrix</strong> The correlation (or covariance) matrix of the variables
</p>
</li>
<li> <p><strong>MFG, MSG</strong> The correlation (or covariance) matrix for the variables of
the first group or second group, respectively.
</p>
</li>
<li> <p><strong>MFG_SG</strong> The correlation (or covariance) matrix for the variables of the
first group with the second group.
</p>
</li>
<li> <p><strong>Coef_FG, Coef_SG</strong> Matrix of the canonical coefficients of the first
group or second group, respectively.
</p>
</li>
<li><p> Loads_FG, Loads_SG Matrix of the canonical loadings of the first group
or second group, respectively.
</p>
</li>
<li> <p><strong>Score_FG, Score_SG</strong> Canonical scores for the variables in FG and SG,
respectively.
</p>
</li>
<li> <p><strong>Crossload_FG, Crossload_FG</strong> Canonical cross-loadings for FG variables
on the SG scores, and cross-loadings for SG variables on the FG scores,
respectively.
</p>
</li>
<li> <p><strong>SigTest</strong> A dataframe with the correlation of the canonical pairs and
hypothesis testing results.
</p>
</li>
<li> <p><strong>collinearity</strong> A list with the collinearity diagnostic for each group of
variables.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., V.Q. Souza, M. Nardino, I.R. Carvalho, M. Ferrari, A.J.
Pelegrin, V.J. Szareski, and D. Schmidt. 2017. Multicollinearity in path
analysis: a simple method to reduce its effects. Agron. J. 109:131-142.
<a href="https://doi.org/10.2134/agronj2016.04.0196">doi:10.2134/agronj2016.04.0196</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

cc1 &lt;- can_corr(data_ge2,
               FG = c(PH, EH, EP),
               SG = c(EL, ED, CL, CD, CW, KW, NR))


# Canonical correlations for each environment
cc3 &lt;- data_ge2 %&gt;%
       can_corr(FG = c(PH, EH, EP),
                SG = c(EL, ED, CL, CD, CW, KW, NR),
                by = ENV,
                verbose = FALSE)


</code></pre>

<hr>
<h2 id='clustering'>Clustering analysis</h2><span id='topic+clustering'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
Performs clustering analysis with selection of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clustering(
  .data,
  ...,
  by = NULL,
  scale = FALSE,
  selvar = FALSE,
  verbose = TRUE,
  distmethod = "euclidean",
  clustmethod = "average",
  nclust = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clustering_+3A_.data">.data</code></td>
<td>
<p>The data to be analyzed. It can be a data frame, possible with
grouped data passed from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.</p>
</td></tr>
<tr><td><code id="clustering_+3A_...">...</code></td>
<td>
<p>The variables in <code>.data</code> to compute the distances. Set to
<code>NULL</code>, i.e., all the numeric variables in <code>.data</code> are used.</p>
</td></tr>
<tr><td><code id="clustering_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="clustering_+3A_scale">scale</code></td>
<td>
<p>Should the data be scaled before computing the distances? Set to
FALSE. If TRUE, then, each observation will be divided by the standard
deviation of the variable \(Z_{ij} = X_{ij} / sd_j\)</p>
</td></tr>
<tr><td><code id="clustering_+3A_selvar">selvar</code></td>
<td>
<p>Logical argument, set to <code>FALSE</code>. If <code>TRUE</code>, then an
algorithm for selecting variables is implemented. See the section
<strong>Details</strong> for additional information.</p>
</td></tr>
<tr><td><code id="clustering_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> (default) then the results
for variable selection are shown in the console.</p>
</td></tr>
<tr><td><code id="clustering_+3A_distmethod">distmethod</code></td>
<td>
<p>The distance measure to be used. This must be one of
<code>'euclidean'</code>, <code>'maximum'</code>, <code>'manhattan'</code>,
<code>'canberra'</code>, <code>'binary'</code>, <code>'minkowski'</code>, <code>'pearson'</code>,
<code>'spearman'</code>, or <code>'kendall'</code>. The last three are
correlation-based distance.</p>
</td></tr>
<tr><td><code id="clustering_+3A_clustmethod">clustmethod</code></td>
<td>
<p>The agglomeration method to be used. This should be one of
<code>'ward.D'</code>, <code>'ward.D2'</code>, <code>'single'</code>, <code>'complete'</code>,
<code>'average'</code> (= UPGMA), <code>'mcquitty'</code> (= WPGMA), <code>'median'</code> (=
WPGMC) or <code>'centroid'</code> (= UPGMC).</p>
</td></tr>
<tr><td><code id="clustering_+3A_nclust">nclust</code></td>
<td>
<p>The number of clusters to be formed. Set to <code>NA</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>selvar = TRUE</code> a variable selection algorithm is executed. The
objective is to select a group of variables that most contribute to explain
the variability of the original data. The selection of the variables is based
on eigenvalue/eigenvectors solution based on the following steps.
</p>

<ol>
<li><p> compute the distance matrix and the cophenetic correlation with the original
variables (all numeric variables in dataset);
</p>
</li>
<li><p> compute the eigenvalues and eigenvectors of the correlation matrix between
the variables;
</p>
</li>
<li><p> Delete the variable with the largest weight (highest eigenvector in
the lowest eigenvalue);
</p>
</li>
<li><p> Compute the distance matrix and cophenetic correlation with the remaining
variables;
</p>
</li>
<li><p> Compute the Mantel's correlation between the obtained distances matrix and
the original distance matrix;
</p>
</li>
<li><p> Iterate steps 2 to 5 <em>p</em> - 2 times, where <em>p</em> is the number of original
variables.
</p>
</li></ol>

<p>At the end of the <em>p</em> - 2 iterations, a summary of the models is returned.
The distance is calculated with the variables that generated the model with
the largest cophenetic correlation. I suggest a careful evaluation aiming at
choosing a parsimonious model, i.e., the one with the fewer number of
variables, that presents acceptable cophenetic correlation and high
similarity with the original distances.
</p>


<h3>Value</h3>


<ul>
<li> <p><strong>data</strong> The data that was used to compute the distances.
</p>
</li>
<li> <p><strong>cutpoint</strong> The cutpoint of the dendrogram according to Mojena (1977).
</p>
</li>
<li> <p><strong>distance</strong> The matrix with the distances.
</p>
</li>
<li> <p><strong>de</strong> The distances in an object of class <code>dist</code>.
</p>
</li>
<li> <p><strong>hc</strong> The hierarchical clustering.
</p>
</li>
<li> <p><strong>Sqt</strong> The total sum of squares.
</p>
</li>
<li> <p><strong>tab</strong> A table with the clusters and similarity.
</p>
</li>
<li> <p><strong>clusters</strong> The sum of square and the mean of the clusters for each
variable.
</p>
</li>
<li> <p><strong>cofgrap</strong> If <code>selectvar = TRUE</code>, then, <code>cofpgrap</code> is a
ggplot2-based graphic showing the cophenetic correlation for each model
(with different number of variables). Else, will be a <code>NULL</code> object.
</p>
</li>
<li> <p><strong>statistics</strong> If <code>selectvar = TRUE</code>, then, <code>statistics</code> shows
the summary of the models fitted with different number of variables,
including cophenetic correlation, Mantel's correlation with the original
distances (all variables) and the p-value associated with the Mantel's
test. Else, will be a <code>NULL</code> object.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Mojena, R. 2015. Hierarchical grouping methods and stopping
rules: an evaluation. Comput. J. 20:359-363. <a href="https://doi.org/10.1093/comjnl/20.4.359">doi:10.1093/comjnl/20.4.359</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

# All rows and all numeric variables from data
d1 &lt;- clustering(data_ge2)

# Based on the mean for each genotype
mean_gen &lt;-
 data_ge2 %&gt;%
 mean_by(GEN) %&gt;%
 column_to_rownames("GEN")

d2 &lt;- clustering(mean_gen)


# Select variables for compute the distances
d3 &lt;- clustering(mean_gen, selvar = TRUE)

# Compute the distances with standardized data
# Define 4 clusters
d4 &lt;- clustering(data_ge,
                 by = ENV,
                 scale = TRUE,
                 nclust = 4)


</code></pre>

<hr>
<h2 id='coincidence_index'>Computes the coincidence index of genotype selection</h2><span id='topic+coincidence_index'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes the coincidence index (Hamblin and Zimmermann, 1986) as follows:
</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[CI = \frac{A-C}{M-C}\times 100\]
<p>where <em>A</em> is the number of selected genotypes common to different
methods; <em>C</em> is the number of expected genotypes selected by chance; and
<em>M</em> is the number of genotypes selected according to the selection
intensity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coincidence_index(..., total, sel1 = NULL, sel2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coincidence_index_+3A_...">...</code></td>
<td>
<p>A comma-separated list of objects of class <code>mgidi</code>,
<code>mtsi</code> <code>fai_blup</code>, or <code>sh</code>. When a model is informed, then
the selected genotypes are extracted automatically.</p>
</td></tr>
<tr><td><code id="coincidence_index_+3A_total">total</code></td>
<td>
<p>The total number of genotypes in the study.</p>
</td></tr>
<tr><td><code id="coincidence_index_+3A_sel1">sel1</code>, <code id="coincidence_index_+3A_sel2">sel2</code></td>
<td>
<p>The selected genotypes by the method 1 and 2, respectively. Defaults to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><strong>coincidence</strong>: A data frame with the coincidence index, number of
common genotypes and the list of common genotypes for each model combination.
</p>
</li>
<li> <p><strong>coincidence_mat</strong>: A matrix-like containing the coincidence index.
</p>
</li>
<li> <p><strong>genotypes</strong>: The number of common genotypes for all models, i.e.,
the insersection of the selected genotypes of all models
</p>
</li></ul>



<h3>References</h3>

<p>Hamblin, J., and M.J. de O. Zimmermann. 1986. Breeding Common Bean for Yield
in Mixtures. p. 245-272. In Plant Breeding Reviews. John Wiley &amp; Sons, Inc.,
Hoboken, NJ, USA.<a href="https://doi.org/10.1002/9781118061015.ch8">doi:10.1002/9781118061015.ch8</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sel1 &lt;- paste("G", 1:30, sep = "")
sel2 &lt;- paste("G", 16:45, sep = "")
coincidence_index(sel1 = sel1, sel2 = sel2, total = 150)

</code></pre>

<hr>
<h2 id='colindiag'>Collinearity Diagnostics</h2><span id='topic+colindiag'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Perform a (multi)collinearity diagnostic of a correlation matrix of predictor
variables using several indicators, as shown by Olivoto et al. (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colindiag(.data, ..., by = NULL, n = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="colindiag_+3A_.data">.data</code></td>
<td>
<p>The data to be analyzed. It must be a symmetric correlation
matrix, or a data frame, possible with grouped data passed from
<code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.</p>
</td></tr>
<tr><td><code id="colindiag_+3A_...">...</code></td>
<td>
<p>Variables to use in the correlation. If <code>...</code> is null then
all the numeric variables from <code>.data</code> are used. It must be a single
variable name or a comma-separated list of unquoted variables names.</p>
</td></tr>
<tr><td><code id="colindiag_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="colindiag_+3A_n">n</code></td>
<td>
<p>If a correlation matrix is provided, then <code>n</code> is the number of
objects used to compute the correlation coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>.data</code> is a grouped data passed from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>
then the results will be returned into a list-column of data frames.
</p>

<ul>
<li> <p><strong>cormat</strong> A symmetric Pearson's coefficient correlation matrix
between the variables
</p>
</li>
<li> <p><strong>corlist</strong> A hypothesis testing for each of the correlation
coefficients
</p>
</li>
<li> <p><strong>evalevet</strong> The eigenvalues with associated eigenvectors of the
correlation matrix
</p>
</li>
<li> <p><strong>indicators</strong> A <code>data.frame</code> with the following indicators
</p>
</li></ul>


<ul>
<li> <p><code>VIF</code> The Variance Inflation Factors, being the diagonal elements of
the inverse of the correlation matrix.
</p>
</li>
<li> <p><code>cn</code> The Condition Number of the correlation matrix, given by the
ratio between the largest and smallest eigenvalue.
</p>
</li>
<li> <p><code>det</code> The determinant of the correlation matrix.
</p>
</li>
<li> <p><code>ncorhigh</code> Number of correlation greather than |0.8|.
</p>
</li>
<li> <p><code>largest_corr</code> The largest correlation (in absolute value) observed.
</p>
</li>
<li> <p><code>smallest_corr</code> The smallest correlation (in absolute value)
observed.
</p>
</li>
<li> <p><code>weight_var</code> The variables with largest eigenvector (largest weight)
in the eigenvalue of smallest value, sorted in decreasing order.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., V.Q. Souza, M. Nardino, I.R. Carvalho, M. Ferrari, A.J.
Pelegrin, V.J. Szareski, and D. Schmidt. 2017. Multicollinearity in path
analysis: a simple method to reduce its effects. Agron. J. 109:131-142.
<a href="https://doi.org/10.2134/agronj2016.04.0196">doi:10.2134/agronj2016.04.0196</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Using the correlation matrix
library(metan)

cor_iris &lt;- cor(iris[,1:4])
n &lt;- nrow(iris)

col_diag &lt;- colindiag(cor_iris, n = n)


# Using a data frame
col_diag_gen &lt;- data_ge2 %&gt;%
                group_by(GEN) %&gt;%
                colindiag()

# Diagnostic by levels of a factor
# For variables with "N" in variable name
col_diag_gen &lt;- data_ge2 %&gt;%
                group_by(GEN) %&gt;%
                colindiag(contains("N"))

</code></pre>

<hr>
<h2 id='comb_vars'>Pairwise combinations of variables</h2><span id='topic+comb_vars'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Pairwise combinations of variables that will be the result of a function
applied to each combination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comb_vars(.data, order = "first", FUN = "+", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comb_vars_+3A_.data">.data</code></td>
<td>
<p>A matrix of data with, say, p columns.</p>
</td></tr>
<tr><td><code id="comb_vars_+3A_order">order</code></td>
<td>
<p>The order on how the results will appear in the output. Default
is <code>order = 'first'</code>. In this case, assuming that .data has four
columns, namely, <code style="white-space: pre;">&#8288;V1, V2, V3, V4&#8288;</code>, the order of columns in the output
will be <code style="white-space: pre;">&#8288;V1.V2, V1.V3, V1.V4, V2.V3, V2.V4, V3.V4&#8288;</code>. If <code>order = 'second'</code>, the result will be then <code style="white-space: pre;">&#8288;V1.V2, V1.V3, V2.V3, V1.V4, V2.V4, V3.V4&#8288;</code>.</p>
</td></tr>
<tr><td><code id="comb_vars_+3A_fun">FUN</code></td>
<td>
<p>The function that will be applied to each combination. The default
is <code>+</code>, i.e., V1 + V2.</p>
</td></tr>
<tr><td><code id="comb_vars_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing all possible combination of variables. Each
combination is the result of the function in <code>FUN</code> applied to the two
variables.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
data &lt;- data.frame(A = rnorm(n = 5, mean = 10, sd = 3),
                  B = rnorm(n = 5, mean = 120, sd = 30),
                  C = rnorm(n = 5, mean = 40, sd = 10),
                  D = rnorm(n = 5, mean = 1100, sd = 200),
                  E = rnorm(n = 5, mean = 2, sd = 1))
comb1 &lt;- comb_vars(data)
comb2 &lt;- comb_vars(data, FUN = '*', order = 'second')

</code></pre>

<hr>
<h2 id='corr_ci'>Confidence interval for correlation coefficient</h2><span id='topic+corr_ci'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes the half-width confidence interval for correlation coefficient using
the nonparametric method proposed by Olivoto et al. (2018).
</p>
<p>The half-width confidence interval is computed according to the following
equation:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
</p>
\[CI_w = 0.45304^r \times 2.25152 \times n^{-0.50089}\]
<p>where \(n\) is the sample size and \(r\) is the correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr_ci(
  .data = NA,
  ...,
  r = NULL,
  n = NULL,
  by = NULL,
  sel.var = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr_ci_+3A_.data">.data</code></td>
<td>
<p>The data to be analyzed. It can be a data frame (possible with
grouped data passed from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>) or a symmetric correlation
matrix.</p>
</td></tr>
<tr><td><code id="corr_ci_+3A_...">...</code></td>
<td>
<p>Variables to compute the confidence interval. If not informed, all
the numeric variables from <code>.data</code> are used.</p>
</td></tr>
<tr><td><code id="corr_ci_+3A_r">r</code></td>
<td>
<p>If <code>data</code> is not available, provide the value for correlation
coefficient.</p>
</td></tr>
<tr><td><code id="corr_ci_+3A_n">n</code></td>
<td>
<p>The sample size if <code>data</code> is a correlation matrix or if r is
informed.</p>
</td></tr>
<tr><td><code id="corr_ci_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="corr_ci_+3A_sel.var">sel.var</code></td>
<td>
<p>A variable to shows the correlation with. This will omit all
the pairwise correlations that doesn't contain <code>sel.var</code>.</p>
</td></tr>
<tr><td><code id="corr_ci_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> then some results are shown in the
console.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing the values of the correlation, confidence
interval, upper and lower limits for all combination of variables.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lucio, V.Q. Souza, M. Nardino, M.I. Diel,
B.G. Sari, D.. K. Krysczun, D. Meira, and C. Meier. 2018. Confidence
interval width for Pearson's correlation coefficient: a
Gaussian-independent estimator based on sample size and strength of
association. Agron. J. 110:1-8.
<a href="https://doi.org/10.2134/agronj2016.04.0196">doi:10.2134/agronj2016.04.0196</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

CI1 &lt;- corr_ci(data_ge2)

# By each level of the factor 'ENV'
CI2 &lt;- corr_ci(data_ge2, CD, TKW, NKE,
               by = ENV,
               verbose = FALSE)
CI2


</code></pre>

<hr>
<h2 id='corr_coef'>Linear and partial correlation coefficients</h2><span id='topic+corr_coef'></span>

<h3>Description</h3>

<p>Computes Pearson's linear correlation or partial correlation with p-values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr_coef(
  data,
  ...,
  type = c("linear", "partial"),
  method = c("pearson", "kendall", "spearman"),
  use = c("pairwise.complete.obs", "everything", "complete.obs"),
  by = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr_coef_+3A_data">data</code></td>
<td>
<p>The data set. It understand grouped data passed from
<code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.</p>
</td></tr>
<tr><td><code id="corr_coef_+3A_...">...</code></td>
<td>
<p>Variables to use in the correlation. If no variable is informed
all the numeric variables from <code>data</code> are used.</p>
</td></tr>
<tr><td><code id="corr_coef_+3A_type">type</code></td>
<td>
<p>The type of correlation to be computed. Defaults to <code>"linear"</code>.
Use <code>type = "partial"</code> to compute partial correlation.</p>
</td></tr>
<tr><td><code id="corr_coef_+3A_method">method</code></td>
<td>
<p>a character string indicating which partial correlation
coefficient is to be computed. One of &quot;pearson&quot; (default), &quot;kendall&quot;, or
&quot;spearman&quot;</p>
</td></tr>
<tr><td><code id="corr_coef_+3A_use">use</code></td>
<td>
<p>an optional character string giving a method for computing
covariances in the presence of missing values. See <a href="stats.html#topic+cor">stats::cor</a> for more
details</p>
</td></tr>
<tr><td><code id="corr_coef_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.This is especially useful, for example,
to compute correlation matrices by levels of a factor.</p>
</td></tr>
<tr><td><code id="corr_coef_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code is run
silently.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The partial correlation coefficient is a technique based on matrix operations
that allow us to identify the association between two variables by removing
the effects of the other set of variables present (Anderson 2003) A
generalized way to estimate the partial correlation coefficient between two
variables (i and j ) is through the simple correlation matrix that involves
these two variables and m other variables from which we want to remove the
effects. The estimate of the partial correlation coefficient between i and j
excluding the effect of m other variables is given by:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[r_{ij.m} = \frac{{- {a_{ij}}}}{{\sqrt {{a_{ii}}{a_{jj}}}}}\]
</p>
<p>Where \(r_{ij.m}\) is the partial correlation coefficient between
variables i and j, without the effect of the other m variables;
\(a_{ij}\) is the ij-order element of the inverse of the linear
correlation matrix; \(a_{ii}\), and \(a_{jj}\) are the elements of
orders ii and jj, respectively, of the inverse of the simple correlation
matrix.
</p>


<h3>Value</h3>

<p>A list with the correlation coefficients and p-values
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Anderson, T. W. 2003. An introduction to multivariate statistical analysis.
3rd ed. Wiley-Interscience.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

# All numeric variables
all &lt;- corr_coef(data_ge2)


# Select variable
sel &lt;-
  corr_coef(data_ge2,
            EP, EL, CD, CL)
sel$cor

# Select variables, partial correlation
sel &lt;-
  corr_coef(data_ge2,
            EP, EL, CD, CL,
            type = "partial")
sel$cor



</code></pre>

<hr>
<h2 id='corr_focus'>Focus on section of a correlation matrix</h2><span id='topic+corr_focus'></span>

<h3>Description</h3>

<p>Select a set of variables from a correlation matrix to keep as the columns,
and exclude these or all other variables from the rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr_focus(model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr_focus_+3A_model">model</code></td>
<td>
<p>A model computed with <code><a href="#topic+corr_coef">corr_coef()</a></code> or a symmetric matrix, often
produced with <code><a href="stats.html#topic+cor">stats::cor()</a></code>.</p>
</td></tr>
<tr><td><code id="corr_focus_+3A_...">...</code></td>
<td>
<p>One or more unquoted variable name separated by commas. Variable
names can be used as if they were positions in the data frame, so
expressions like <code>x:y</code> can be used to select a range of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>corr_coef(data_ge2) |&gt; corr_focus(PH)
</code></pre>

<hr>
<h2 id='corr_plot'>Visualization of a correlation matrix</h2><span id='topic+corr_plot'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Graphical and numerical visualization of a correlation matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr_plot(
  .data,
  ...,
  col.by = NULL,
  upper = "corr",
  lower = "scatter",
  decimal.mark = ".",
  axis.labels = FALSE,
  show.labels.in = "show",
  size.axis.label = 12,
  size.varnames = 12,
  col.varnames = "black",
  diag = TRUE,
  diag.type = "histogram",
  bins = 20,
  col.diag = "gray",
  alpha.diag = 1,
  col.up.panel = "gray",
  col.lw.panel = "gray",
  col.dia.panel = "gray",
  prob = 0.05,
  col.sign = "green",
  alpha.sign = 0.15,
  lab.position = "tr",
  progress = NULL,
  smooth = FALSE,
  col.smooth = "red",
  confint = TRUE,
  size.point = 1,
  shape.point = 19,
  alpha.point = 0.7,
  fill.point = NULL,
  col.point = "black",
  size.line = 0.5,
  minsize = 2,
  maxsize = 3,
  pan.spacing = 0.15,
  digits = 2,
  export = FALSE,
  file.type = "pdf",
  file.name = NULL,
  width = 8,
  height = 7,
  resolution = 300
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr_plot_+3A_.data">.data</code></td>
<td>
<p>The data. Should, preferentially, contain numeric variables
only. If <code>.data</code> has factor-columns, these columns will be deleted
with a warning message.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_...">...</code></td>
<td>
<p>Variables to use in the correlation. If no variable is informed
all the numeric variables from <code>.data</code> are used.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_col.by">col.by</code></td>
<td>
<p>A categorical variable to map the color of the points by.
Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_upper">upper</code></td>
<td>
<p>The visualization method for the upper triangular correlation
matrix. Must be one of <code>'corr'</code> (numeric values), <code>'scatter'</code>
(the scatterplot for each pairwise combination), or <code>NULL</code> to set a
blank diagonal.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_lower">lower</code></td>
<td>
<p>The visualization method for the lower triangular correlation
matrix. Must be one of <code>'corr'</code> (numeric values), <code>'scatter'</code>
(the scatterplot for each pairwise combination), or <code>NULL</code> to set a
blank diagonal.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_decimal.mark">decimal.mark</code></td>
<td>
<p>The decimal mark. Defaults to <code>"."</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_axis.labels">axis.labels</code></td>
<td>
<p>Should the axis labels be shown in the plot? Set to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_show.labels.in">show.labels.in</code></td>
<td>
<p>Where to show the axis labels. Defaults to &quot;show&quot;
bottom and left. Use &quot;diag&quot; to show the labels on the diagonal. In this
case, the diagonal layer (boxplot, density or histogram) will be
overwritten.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_size.axis.label">size.axis.label</code></td>
<td>
<p>The size of the text for axis labels if
<code>axis.labels = TRUE</code>. Defaults to 12.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_size.varnames">size.varnames</code></td>
<td>
<p>The size of the text for variable names. Defaults to 12.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_col.varnames">col.varnames</code></td>
<td>
<p>The color of the text for variable names. Defaults to
&quot;black&quot;.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_diag">diag</code></td>
<td>
<p>Should the diagonal be shown?</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_diag.type">diag.type</code></td>
<td>
<p>The type of plot to show in the diagonal if <code style="white-space: pre;">&#8288;diag TRUE&#8288;</code>. It must be one of the 'histogram' (to show an histogram), 'density'
to show the Kernel density, or 'boxplot' (to show a boxplot).</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_bins">bins</code></td>
<td>
<p>The number of bins, Defaults to 20.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_col.diag">col.diag</code></td>
<td>
<p>If <code>diag = TRUE</code> then <code>diagcol</code> is the color for
the distribution. Set to gray.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_alpha.diag">alpha.diag</code></td>
<td>
<p>Alpha-transparency scale (0-1) to make the diagonal plot
transparent. 0 = fully transparent; 1 = full color. Set to 0.15</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_col.up.panel">col.up.panel</code>, <code id="corr_plot_+3A_col.lw.panel">col.lw.panel</code>, <code id="corr_plot_+3A_col.dia.panel">col.dia.panel</code></td>
<td>
<p>The color for the upper,
lower, and diagonal panels, respectively. Set to 'gray'.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_prob">prob</code></td>
<td>
<p>The probability of error. Significant correlations will be
highlighted with '<em>', '<strong>', and '</strong></em>' (0.05, 0.01, and 0.001,
respectively). Scatterplots with significant correlations may be
color-highlighted.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_col.sign">col.sign</code></td>
<td>
<p>The color that will highlight the significant correlations.
Set to 'green'.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_alpha.sign">alpha.sign</code></td>
<td>
<p>Alpha-transparency scale (0-1) to make the plot area
transparent. 0 = fully transparent; 1 = full color. Set to 0.15</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_lab.position">lab.position</code></td>
<td>
<p>The position that the labels will appear. Set to
<code>'tr'</code>, i.e., the legends will appear in the top and right of the
plot. Other allowed options are <code>'tl'</code> (top and left), <code>'br'</code>
(bottom and right), <code>'bl'</code> (bottom and left).</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_progress">progress</code></td>
<td>
<p><code>NULL</code> (default) for a progress bar in interactive
sessions with more than 15 plots, <code>TRUE</code> for a progress bar,
<code>FALSE</code> for no progress bar.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_smooth">smooth</code></td>
<td>
<p>Should a linear smooth line be shown in the scatterplots? Set
to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_col.smooth">col.smooth</code></td>
<td>
<p>The color for the smooth line.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_confint">confint</code></td>
<td>
<p>Should a confidence band be shown with the smooth line? Set to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_size.point">size.point</code></td>
<td>
<p>The size of the points in the plot. Set to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_shape.point">shape.point</code></td>
<td>
<p>The shape of the point, set to <code>1</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_alpha.point">alpha.point</code></td>
<td>
<p>Alpha-transparency scale (0-1) to make the points
transparent. 0 = fully transparent; 1 = full color. Set to 0.7</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_fill.point">fill.point</code></td>
<td>
<p>The color to fill the points. Valid argument if points are
between 21 and 25.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_col.point">col.point</code></td>
<td>
<p>The color for the edge of the point, set to <code>black</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line (smooth and diagonal).</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_minsize">minsize</code></td>
<td>
<p>The size of the letter that will represent the smallest
correlation coefficient.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_maxsize">maxsize</code></td>
<td>
<p>The size of the letter that will represent the largest
correlation coefficient.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_pan.spacing">pan.spacing</code></td>
<td>
<p>The space between the panels. Set to 0.15.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_digits">digits</code></td>
<td>
<p>The number of digits to show in the plot.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_export">export</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, then the plot is exported to
the current directory.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_file.type">file.type</code></td>
<td>
<p>The format of the file if <code>export = TRUE</code>.  Set to
<code>'pdf'</code>. Other possible values are <code style="white-space: pre;">&#8288;*.tiff&#8288;</code> using <code>file.type = 'tiff'</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_file.name">file.name</code></td>
<td>
<p>The name of the plot when exported. Set to <code>NULL</code>,
i.e., automatically.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_width">width</code></td>
<td>
<p>The width of the plot, set to <code>8</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_height">height</code></td>
<td>
<p>The height of the plot, set to <code>7</code>.</p>
</td></tr>
<tr><td><code id="corr_plot_+3A_resolution">resolution</code></td>
<td>
<p>The resolution of the plot if <code>file.type = 'tiff'</code> is
used. Set to <code>300</code> (300 dpi).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggmatrix&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
dataset &lt;- data_ge2 %&gt;% select_cols(1:7)

# Default plot setting
corr_plot(dataset)

# Chosing variables to be correlated
corr_plot(dataset, PH, EH, EL)


# Axis labels, similar to the function pairs()
# Gray scale
corr_plot(dataset, PH, EH, EL,
          shape.point = 19,
          size.point = 2,
          alpha.point = 0.5,
          alpha.diag = 0,
          pan.spacing = 0,
          col.sign = 'gray',
          alpha.sign = 0.3,
          axis.labels = TRUE)

corr_plot(dataset, PH, EH, EL,
          prob = 0.01,
          shape.point = 21,
          col.point = 'black',
          fill.point = 'orange',
          size.point = 2,
          alpha.point = 0.6,
          maxsize = 4,
          minsize = 2,
          smooth = TRUE,
          size.line = 1,
          col.smooth = 'black',
          col.sign = 'cyan',
          col.up.panel = 'black',
          col.lw.panel = 'black',
          col.dia.panel = 'black',
          pan.spacing = 0,
          lab.position = 'tl')

</code></pre>

<hr>
<h2 id='corr_ss'>Sample size planning for a desired Pearson's correlation confidence interval</h2><span id='topic+corr_ss'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Find the required (sufficient) sample size for computing a Pearson
correlation coefficient with a desired confidence interval (Olivoto et al.,
2018) as follows
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[n = {\left[ {\frac{{C{I_w}}}{{{{0.45304}^r} \times 2.25152}}} \right]^{{\rm{ - 0}}{\rm{.50089}}}}\]
</p>
<p>where \(CI_w\) is desired confidence interval and \(r\) is the
correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr_ss(r, CI, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr_ss_+3A_r">r</code></td>
<td>
<p>The magnitude of the correlation coefficient.</p>
</td></tr>
<tr><td><code id="corr_ss_+3A_ci">CI</code></td>
<td>
<p>The half-width for confidence interval at p &lt; 0.05.</p>
</td></tr>
<tr><td><code id="corr_ss_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code is run
silently.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lucio, V.Q. Souza, M. Nardino, M.I. Diel,
B.G. Sari, D.. K. Krysczun, D. Meira, and C. Meier. 2018. Confidence
interval width for Pearson's correlation coefficient: a
Gaussian-independent estimator based on sample size and strength of
association. Agron. J. 110:1-8.
<a href="https://doi.org/10.2134/agronj2016.04.0196">doi:10.2134/agronj2016.04.0196</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

corr_ss(r = 0.60, CI = 0.1)



</code></pre>

<hr>
<h2 id='corr_stab_ind'>Correlation between stability indexes</h2><span id='topic+corr_stab_ind'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes the Spearman's rank correlation between the parametric and
nonparametric stability indexes computed with the function
<code><a href="#topic+ge_stats">ge_stats()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr_stab_ind(x, stats = "all", plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr_stab_ind_+3A_x">x</code></td>
<td>
<p>An object of class <code>ge_stats</code>.</p>
</td></tr>
<tr><td><code id="corr_stab_ind_+3A_stats">stats</code></td>
<td>
<p>The statistics to compute the correlation. See the section
<strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="corr_stab_ind_+3A_plot">plot</code></td>
<td>
<p>Plot the heat map with the correlations? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="corr_stab_ind_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the function
<code><a href="#topic+plot.corr_coef">plot.corr_coef()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>stats</code> is used to chose the statistics to show the
ranks. Allowed values are <code>"all"</code> (All statistics, default), <code>"par"</code>
(Parametric statistics), <code>"nonpar"</code> (Non-parametric statistics), <code>"ammi"</code>
(AMMI-based stability statistics), or the following values that can be
combined into comma-separated character vector. <code>"Y"</code> (Response variable),
<code>"Var"</code> (Genotype's variance), <code>"Shukla"</code> (Shukla's variance), <code style="white-space: pre;">&#8288;"Wi_g", "Wi_f", "Wi_u"&#8288;</code> (Annichiarrico's genotypic confidence index for all,
favorable and unfavorable environments, respectively), <code>"Ecoval"</code> (Wricke's
ecovalence), <code>"Sij"</code> (Deviations from the joint-regression analysis),
<code>"R2"</code> (R-squared from the joint-regression analysis), <code>"ASTAB"</code> (AMMI
Based Stability Parameter), <code>"ASI"</code> (AMMI Stability Index), <code>"ASV"</code>
(AMMI-stability value), <code>"AVAMGE"</code> (Sum Across Environments of Absolute
Value of GEI Modelled by AMMI ), <code>"Da"</code> (Annicchiarico's D Parameter
values), <code>"Dz"</code> (Zhang's D Parameter), <code>"EV"</code> (Sums of the Averages of the
Squared Eigenvector Values), <code>"FA"</code> (Stability Measure Based on Fitted AMMI
Model), <code>"MASV"</code> (Modified AMMI Stability Value), <code>"SIPC"</code> (Sums of the
Absolute Value of the IPC Scores), <code>"Za"</code> (Absolute Value of the Relative
Contribution of IPCs to the Interaction), <code>"WAAS"</code> (Weighted average of
absolute scores), <code>"HMGV"</code> (Harmonic mean of the genotypic value), <code>"RPGV"</code>
(Relative performance of the genotypic values), <code>"HMRPGV"</code> (Harmonic mean
of the relative performance of the genotypic values), <code style="white-space: pre;">&#8288;"Pi_a", "Pi_f", "Pi_u"&#8288;</code> (Superiority indexes for all, favorable and unfavorable
environments, respectively), <code>"Gai"</code> (Geometric adaptability index), <code>"S1"</code>
(mean of the absolute rank differences of a genotype over the n
environments), <code>"S2"</code> (variance among the ranks over the k environments),
<code>"S3"</code> (sum of the absolute deviations), <code>"S6"</code> (relative sum of squares of
rank for each genotype), <code style="white-space: pre;">&#8288;"N1", "N2", "N3", "N4"&#8288;</code> (Thennarasu&quot;s
statistics)).
</p>


<h3>Value</h3>

<p>A list with the data (ranks) correlation, p-values and a heat map showing the
correlation coefficients.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- ge_stats(data_ge, ENV, GEN, REP, GY)
a &lt;- corr_stab_ind(model)


</code></pre>

<hr>
<h2 id='correlated_vars'>Generate correlated variables</h2><span id='topic+correlated_vars'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Generate correlated variables using a vector of know values and desired
maximum and minimum correlations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correlated_vars(
  y,
  min_cor = -1,
  max_cor = 1,
  nvars,
  constant = NULL,
  operation = "*",
  x = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="correlated_vars_+3A_y">y</code></td>
<td>
<p>A vector to generate variables correlated with.</p>
</td></tr>
<tr><td><code id="correlated_vars_+3A_min_cor">min_cor</code></td>
<td>
<p>The minimum desired correlation.</p>
</td></tr>
<tr><td><code id="correlated_vars_+3A_max_cor">max_cor</code></td>
<td>
<p>The maximum desired correlation.</p>
</td></tr>
<tr><td><code id="correlated_vars_+3A_nvars">nvars</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
<tr><td><code id="correlated_vars_+3A_constant">constant</code></td>
<td>
<p>A constant. Use <code>operation</code> to define which operation is
used.</p>
</td></tr>
<tr><td><code id="correlated_vars_+3A_operation">operation</code></td>
<td>
<p>The operation to be applied to the <code>constant</code> value.</p>
</td></tr>
<tr><td><code id="correlated_vars_+3A_x">x</code></td>
<td>
<p>An optional vector of the same length of <code>y</code>. If not informed
(default) then a normally distributed variable (mean = 0, sd = 1) will be
used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the <code>y</code> variable and the correlated variables.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
y &lt;- rnorm(n = 10)
cor_vars &lt;- correlated_vars(y, nvar = 6)
plot(cor_vars)



</code></pre>

<hr>
<h2 id='covcor_design'>Variance-covariance matrices for designed experiments</h2><span id='topic+covcor_design'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Compute variance-covariance and correlation matrices using data from a
designed (RCBD or CRD) experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covcor_design(.data, gen, rep, resp, design = "RCBD", by = NULL, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="covcor_design_+3A_.data">.data</code></td>
<td>
<p>The data to be analyzed. It can be a data frame, possible with
grouped data passed from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.</p>
</td></tr>
<tr><td><code id="covcor_design_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="covcor_design_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="covcor_design_+3A_resp">resp</code></td>
<td>
<p>The response variables. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="covcor_design_+3A_design">design</code></td>
<td>
<p>The experimental design. Must be RCBD or CRD.</p>
</td></tr>
<tr><td><code id="covcor_design_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="covcor_design_+3A_type">type</code></td>
<td>
<p>What the matrices should return? Set to <code>NULL</code>, i.e., a list
of matrices is returned. The argument type allow the following values
<code style="white-space: pre;">&#8288;'pcor', 'gcor', 'rcor'&#8288;</code>, (which will return the phenotypic, genotypic
and residual correlation matrices, respectively) or <code style="white-space: pre;">&#8288;'pcov', 'gcov', 'rcov'&#8288;</code> (which will return the phenotypic, genotypic and residual
variance-covariance matrices, respectively). Alternatively, it is possible
to get a matrix with the means of each genotype in each trait, by using
<code>type = 'means'</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>covcor_design</code> containing the following
items:
</p>

<ul>
<li> <p><strong>geno_cov</strong> The genotypic covariance.
</p>
</li>
<li> <p><strong>phen_cov</strong> The phenotypic covariance.
</p>
</li>
<li> <p><strong>resi_cov</strong> The residual covariance.
</p>
</li>
<li> <p><strong>geno_cor</strong> The phenotypic correlation.
</p>
</li>
<li> <p><strong>phen_cor</strong> The phenotypic correlation.
</p>
</li>
<li> <p><strong>resi_cor</strong> The residual correlation.
</p>
</li></ul>

<p>If <code>.data</code> is a grouped data passed from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>
then the results will be returned into a list-column of data frames.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# List of matrices
data &lt;- subset(data_ge2, ENV == 'A1')
matrices &lt;- covcor_design(data,
                          gen = GEN,
                          rep = REP,
                          resp = c(PH, EH, NKE, TKW))

# Genetic correlations
gcor &lt;- covcor_design(data,
                      gen = GEN,
                      rep = REP,
                      resp = c(PH, EH, NKE, TKW),
                      type = 'gcor')

# Residual (co)variance matrix for each environment
rcov &lt;- covcor_design(data_ge2,
                      gen = GEN,
                      rep = REP,
                      resp = c(PH, EH, CD, CL),
                      by = ENV,
                      type = "rcov")


</code></pre>

<hr>
<h2 id='cv_ammi'>Cross-validation procedure</h2><span id='topic+cv_ammi'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Cross-validation for estimation of AMMI models
</p>
<p>THe original dataset is split into two datasets: training set and validation
set. The 'training' set has all combinations (genotype x environment) with
N-1 replications. The 'validation' set has the remaining replication. The
splitting of the dataset into modeling and validation sets depends on the
design informed. For Completely Randomized Block Design (default), and
alpha-lattice design (declaring <code>block</code> arguments), complete replicates
are selected within environments. The remained replicate serves as validation
data. If <code>design = 'RCD'</code> is informed, completely randomly samples are
made for each genotype-by-environment combination (Olivoto et al. 2019). The
estimated values considering <code>naxis</code>-Interaction Principal Component
Axis are compared with the 'validation' data. The Root Mean Square Prediction
Difference (RMSPD) is computed. At the end of boots, a list is returned.
</p>
<p><strong>IMPORTANT:</strong> If the data set is unbalanced (i.e., any genotype missing
in any environment) the function will return an error. An error is also
observed if any combination of genotype-environment has a different number of
replications than observed in the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_ammi(
  .data,
  env,
  gen,
  rep,
  resp,
  block = NULL,
  naxis = 2,
  nboot = 200,
  design = "RCBD",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv_ammi_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="cv_ammi_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="cv_ammi_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="cv_ammi_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks. <strong>AT LEAST THREE REPLICATES ARE REQUIRED TO
PERFORM THE CROSS-VALIDATION</strong>.</p>
</td></tr>
<tr><td><code id="cv_ammi_+3A_resp">resp</code></td>
<td>
<p>The response variable.</p>
</td></tr>
<tr><td><code id="cv_ammi_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p>
</td></tr>
<tr><td><code id="cv_ammi_+3A_naxis">naxis</code></td>
<td>
<p>The number of axis to be considered for estimation of GE
effects.</p>
</td></tr>
<tr><td><code id="cv_ammi_+3A_nboot">nboot</code></td>
<td>
<p>The number of resamples to be used in the cross-validation.
Defaults to 200.</p>
</td></tr>
<tr><td><code id="cv_ammi_+3A_design">design</code></td>
<td>
<p>The experimental design. Defaults to <code>RCBD</code> (Randomized
complete Block Design). For Completely Randomized Designs inform
<code>design = 'CRD'</code>.</p>
</td></tr>
<tr><td><code id="cv_ammi_+3A_verbose">verbose</code></td>
<td>
<p>A logical argument to define if a progress bar is shown.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>cv_ammi</code> with the following items: *
<strong>RMSPD</strong>: A vector with nboot-estimates of the Root Mean Squared
Prediction Difference between predicted and validating data.
</p>

<ul>
<li> <p><strong>RMSPDmean</strong>: The mean of RMSPDmean estimates.
</p>
</li>
<li> <p><strong>Estimated</strong>: A data frame that contain the values (predicted,
observed, validation) of the last loop.
</p>
</li>
<li> <p><strong>Modeling</strong>: The dataset used as modeling data in the last loop
</p>
</li>
<li> <p><strong>Testing</strong>: The dataset used as testing data in the last loop.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro,
V.Q. de Souza, and E. Jost. 2019. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv_ammif">cv_ammif()</a></code>, <code><a href="#topic+cv_blup">cv_blup()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(metan)
model &lt;- cv_ammi(data_ge,
                env = ENV,
                gen = GEN,
                rep = REP,
                resp = GY,
                nboot = 5,
                naxis = 2)



</code></pre>

<hr>
<h2 id='cv_ammif'>Cross-validation procedure</h2><span id='topic+cv_ammif'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Cross-validation for estimation of all AMMI-family models
</p>
<p><code>cv_ammif</code> provides a complete cross-validation of replicate-based data
using AMMI-family models. By default, the first validation is carried out
considering the AMMIF (all possible axis used). Considering this model, the
original dataset is split up into two datasets: training set and validation
set. The 'training' set has all combinations (genotype x environment) with
N-1 replications. The 'validation' set has the remaining replication. The
splitting of the dataset into modeling and validation sets depends on the
design informed. For Completely Randomized Block Design (default), and
alpha-lattice design (declaring <code>block</code> arguments), complete replicates
are selected within environments. The remained replicate serves as validation
data. If <code>design = 'RCD'</code> is informed, completely randomly samples are
made for each genotype-by-environment combination (Olivoto et al. 2019). The
estimated values for each member of the AMMI-family model are compared with
the 'validation' data. The Root Mean Square Prediction Difference (RMSPD) is
computed. At the end of boots, a list is returned.
</p>
<p><strong>IMPORTANT:</strong> If the data set is unbalanced (i.e., any genotype missing
in any environment) the function will return an error. An error is also
observed if any combination of genotype-environment has a different number of
replications than observed in the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_ammif(
  .data,
  env,
  gen,
  rep,
  resp,
  nboot = 200,
  block,
  design = "RCBD",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv_ammif_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="cv_ammif_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="cv_ammif_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="cv_ammif_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks. <strong>AT LEAST THREE REPLICATES ARE REQUIRED TO
PERFORM THE CROSS-VALIDATION</strong>.</p>
</td></tr>
<tr><td><code id="cv_ammif_+3A_resp">resp</code></td>
<td>
<p>The response variable.</p>
</td></tr>
<tr><td><code id="cv_ammif_+3A_nboot">nboot</code></td>
<td>
<p>The number of resamples to be used in the cross-validation.
Defaults to 200.</p>
</td></tr>
<tr><td><code id="cv_ammif_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p>
</td></tr>
<tr><td><code id="cv_ammif_+3A_design">design</code></td>
<td>
<p>The experimental design used in each environment. Defaults to
<code>RCBD</code> (Randomized complete Block Design). For Completely Randomized
Designs inform <code>design = 'CRD'</code>.</p>
</td></tr>
<tr><td><code id="cv_ammif_+3A_verbose">verbose</code></td>
<td>
<p>A logical argument to define if a progress bar is shown.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>cv_ammif</code> with the following items:
</p>

<ul>
<li> <p><strong>RMSPD</strong>: A vector with nboot-estimates of the Root Mean Squared
Prediction Difference between predicted and validating data.
</p>
</li>
<li> <p><strong>RMSPDmean</strong>: The mean of RMSPDmean estimates.
</p>
</li>
<li> <p><strong>Estimated</strong>: A data frame that contain the values (predicted, observed,
validation) of the last loop.
</p>
</li>
<li> <p><strong>Modeling</strong>: The dataset used as modeling data in the last loop
</p>
</li>
<li> <p><strong>Testing</strong>: The dataset used as testing data in the last loop.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv_ammi">cv_ammi()</a></code>, <code><a href="#topic+cv_blup">cv_blup()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(metan)
model &lt;- cv_ammif(data_ge2,
                  env = ENV,
                  gen = GEN,
                  rep = REP,
                  resp = EH,
                  nboot = 5)
plot(model)


</code></pre>

<hr>
<h2 id='cv_blup'>Cross-validation procedure</h2><span id='topic+cv_blup'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Cross-validation for blup prediction.
</p>
<p>This function provides a cross-validation procedure for mixed models using
replicate-based data. By default, complete blocks are randomly selected
within each environment. In each iteration, the original dataset is split up
into two datasets: training and validation data. The 'training' set has all
combinations (genotype x environment) with R - 1 replications. The
'validation' set has the remaining replication. The estimated values are
compared with the 'validation' data and the Root Means Square Prediction
Difference (Olivoto et al. 2019) is computed. At the end of boots, a list is
returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv_blup(
  .data,
  env,
  gen,
  rep,
  resp,
  block = NULL,
  nboot = 200,
  random = "gen",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv_blup_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="cv_blup_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="cv_blup_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="cv_blup_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks. <strong>AT LEAST THREE REPLICATES ARE REQUIRED TO
PERFORM THE CROSS-VALIDATION</strong>.</p>
</td></tr>
<tr><td><code id="cv_blup_+3A_resp">resp</code></td>
<td>
<p>The response variable.</p>
</td></tr>
<tr><td><code id="cv_blup_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed. See how
fixed and random effects are considered, see the section <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="cv_blup_+3A_nboot">nboot</code></td>
<td>
<p>The number of resamples to be used in the cross-validation.
Defaults to 200</p>
</td></tr>
<tr><td><code id="cv_blup_+3A_random">random</code></td>
<td>
<p>The effects of the model assumed to be random. See
<strong>Details</strong> for more information.</p>
</td></tr>
<tr><td><code id="cv_blup_+3A_verbose">verbose</code></td>
<td>
<p>A logical argument to define if a progress bar is shown.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Six models may be fitted depending upon the values in <code>block</code>
and <code>random</code> arguments.
</p>

<ul>
<li> <p><strong>Model 1:</strong> <code>block = NULL</code> and <code>random = "gen"</code> (The
default option). This model considers a Randomized Complete Block Design in
each environment assuming genotype and genotype-environment interaction as
random effects. Environments and blocks nested within environments are
assumed to fixed factors.
</p>
</li>
<li> <p><strong>Model 2:</strong> <code>block = NULL</code> and <code>random = "env"</code>. This
model considers a Randomized Complete Block Design in each environment
treating environment, genotype-environment interaction, and blocks nested
within environments as random factors. Genotypes are assumed to be fixed
factors.
</p>
</li>
<li> <p><strong>Model 3:</strong> <code>block = NULL</code> and <code>random = "all"</code>. This
model considers a Randomized Complete Block Design in each environment
assuming a random-effect model, i.e., all effects (genotypes, environments,
genotype-vs-environment interaction and blocks nested within environments)
are assumed to be random factors.
</p>
</li>
<li> <p><strong>Model 4:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "gen"</code>. This model considers an alpha-lattice design in each environment
assuming genotype, genotype-environment interaction, and incomplete blocks
nested within complete replicates as random to make use of inter-block
information (Mohring et al., 2015). Complete replicates nested within
environments and environments are assumed to be fixed factors.
</p>
</li>
<li> <p><strong>Model 5:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "env"</code>. This model considers an alpha-lattice design in each environment
assuming genotype as fixed. All other sources of variation (environment,
genotype-environment interaction, complete replicates nested within
environments, and incomplete blocks nested within replicates) are assumed
to be random factors.
</p>
</li>
<li> <p><strong>Model 6:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "all"</code>. This model considers an alpha-lattice design in each environment
assuming all effects, except the intercept, as random factors.
</p>
</li></ul>

<p><strong>IMPORTANT:</strong>  An error is returned if any combination of
genotype-environment has a different number of replications than observed in
the trial.
</p>


<h3>Value</h3>

<p>An object of class <code>cv_blup</code> with the following items: *
<strong>RMSPD</strong>: A vector with nboot-estimates of the root mean squared
prediction difference between predicted and validating data. *
<strong>RMSPDmean</strong> The mean of RMSPDmean estimates.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro,
V.Q. de Souza, and E. Jost. 2019. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>
<p>Mohring, J., E. Williams, and H.-P. Piepho. 2015. Inter-block
information: to recover or not to recover it? TAG. Theor. Appl. Genet.
128:1541-54.
<a href="https://doi.org/10.1007/s00122-015-2530-0">doi:10.1007/s00122-015-2530-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv_ammi">cv_ammi()</a></code>, <code><a href="#topic+cv_ammif">cv_ammif()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(metan)
model &lt;- cv_blup(data_ge,
                 env = ENV,
                 gen = GEN,
                 rep = REP,
                 resp = GY,
                 nboot = 5)



</code></pre>

<hr>
<h2 id='data_alpha'>Data from an alpha lattice design</h2><span id='topic+data_alpha'></span>

<h3>Description</h3>

<p>Alpha lattice design of spring oats
</p>


<h3>Format</h3>

<p>A tibble with 72 observations on the following 5 variables.
</p>

<ul>
<li> <p><strong>PLOT</strong> Plot number
</p>
</li>
<li> <p><strong>REP</strong> Replicate code
</p>
</li>
<li> <p><strong>BLOCK</strong> Incomplete block code
</p>
</li>
<li> <p><strong>GEN</strong> Genotype code
</p>
</li>
<li> <p><strong>YIELD</strong> Observed dry matter yield (tonnes/ha)
</p>
</li></ul>



<h3>Details</h3>

<p>A spring oats trial grown in Craibstone. There were 24 varieties
in 3 replicates, each consisting of 6 incomplete blocks of 4 plots.
Planted in a resolvable alpha design. The plots were laid out in a single line.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Source</h3>

<p>J. A. John &amp; E. R. Williams (1995). Cyclic and computer generated designs,
Chapman and Hall, London. Page 146.
</p>

<hr>
<h2 id='data_g'>Single maize trial</h2><span id='topic+data_g'></span>

<h3>Description</h3>

<p>This dataset contain data on 15 traits assessed in 13 maize hybrids.
The experimental design was a RCBD with 3 blocks and 1
replications per block. It is used as an example in the function <code><a href="#topic+gamem">gamem()</a></code>
of the <span class="pkg">metan</span> package.
</p>


<h3>Format</h3>

<p>A tibble with 39 observations on the following 17 variables.
</p>

<ul>
<li> <p><strong>GEN</strong> A factor with 13 levels; each level represents one maize hybrid.
</p>
</li>
<li> <p><strong>REP</strong> A factor with 3 levels; each level represents one replication/block.
</p>
</li>
<li> <p><strong>PH</strong> Plant height, in cm.
</p>
</li>
<li> <p><strong>EH</strong> Ear height, in cm.
</p>
</li>
<li> <p><strong>EP</strong> Ear position, i.e., the ratio EH/PH.
</p>
</li>
<li> <p><strong>EL</strong> Ear length, in cm.
</p>
</li>
<li> <p><strong>ED</strong> Ear diameter, in mm.
</p>
</li>
<li> <p><strong>CL</strong> Cob length, in cm.
</p>
</li>
<li> <p><strong>CD</strong> Cob diameter, in mm.
</p>
</li>
<li> <p><strong>CW</strong> Cob weight, in g.
</p>
</li>
<li> <p><strong>KW</strong> Kernel weight, in cm.
</p>
</li>
<li> <p><strong>NR</strong> Number of rows.
</p>
</li>
<li> <p><strong>NKR</strong> Number of kernels per row.
</p>
</li>
<li> <p><strong>CDED</strong> Cob diameter / Ear diameter ratio.
</p>
</li>
<li> <p><strong>PERK</strong> Percentage of kernels.
</p>
</li>
<li> <p><strong>TKW</strong> Thousand-kernel weight
</p>
</li>
<li> <p><strong>NKE</strong> Number of kernels per row.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Source</h3>

<p>Personal data
</p>

<hr>
<h2 id='data_ge'>Multi-environment trial of oat</h2><span id='topic+data_ge'></span>

<h3>Description</h3>

<p>This dataset contain data on two variables assessed in 10 genotypes growing
in 14 environments. The experimental design was a RCBD with 3
replicates (blocks). This data provide examples for several functions of
<span class="pkg">metan</span> package.
</p>


<h3>Format</h3>

<p>A tibble with 420 observations on the following 5 variables.
</p>

<ul>
<li> <p><strong>ENV</strong> A factor with 14 levels; each level represents one cultivation
environment.
</p>
</li>
<li> <p><strong>GEN</strong> A factor with 10 levels; each level represents one genotype.
</p>
</li>
<li> <p><strong>REP</strong> A factor with 3 levels; each level represents one
replication/block.
</p>
</li>
<li> <p><strong>GY</strong> A continuous variable (grain yield) observed in each plot.
</p>
</li>
<li> <p><strong>HM</strong> A continuous variable (hectoliter mass) observed in each plot.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Source</h3>

<p>Personal data
</p>

<hr>
<h2 id='data_ge2'>Multi-environment trial of maize</h2><span id='topic+data_ge2'></span>

<h3>Description</h3>

<p>This dataset contain data on 15 traits assessed in 13 maize hybrids growing
in 4 environments. The experimental design was a RCBD with 3 blocks and 1
replications per block. It may be used as example in several functions of
<span class="pkg">metan</span> package.
</p>


<h3>Format</h3>

<p>A tibble with 156 observations on the following 18 variables.
</p>

<ul>
<li> <p><strong>ENV</strong> A factor with 4 levels; each level represents one cultivation
environment.
</p>
</li>
<li> <p><strong>GEN</strong> A factor with 13 levels; each level represents one maize hybrid.
</p>
</li>
<li> <p><strong>REP</strong> A factor with 3 levels; each level represents one
replication/block.
</p>
</li>
<li> <p><strong>PH</strong> Plant height, in cm.
</p>
</li>
<li> <p><strong>EH</strong> Ear height, in cm.
</p>
</li>
<li> <p><strong>EP</strong> Ear position, i.e., the ratio EH/PH.
</p>
</li>
<li> <p><strong>EL</strong> Ear length, in cm.
</p>
</li>
<li> <p><strong>ED</strong> Ear diameter, in mm.
</p>
</li>
<li> <p><strong>CL</strong> Cob length, in cm.
</p>
</li>
<li> <p><strong>CD</strong> Cob diameter, in mm.
</p>
</li>
<li> <p><strong>CW</strong> Cob weight, in g.
</p>
</li>
<li> <p><strong>KW</strong> Kernel weight, in cm.
</p>
</li>
<li> <p><strong>NR</strong> Number of rows.
</p>
</li>
<li> <p><strong>NKR</strong> Number of kernels per row.
</p>
</li>
<li> <p><strong>CDED</strong> Cob diameter / Ear diameter ratio.
</p>
</li>
<li> <p><strong>PERK</strong> Percentage of kernels.
</p>
</li>
<li> <p><strong>TKW</strong> Thousand-kernel weight
</p>
</li>
<li> <p><strong>NKE</strong> Number of kernels per row.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Source</h3>

<p>Personal data
</p>

<hr>
<h2 id='data_simula'>Simulate genotype and genotype-environment data</h2><span id='topic+data_simula'></span><span id='topic+ge_simula'></span><span id='topic+g_simula'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>

<ul>
<li> <p><code>g_simula()</code> simulate replicated genotype data.
</p>
</li>
<li> <p><code>ge_simula()</code> simulate replicated genotype-environment data.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>ge_simula(
  ngen,
  nenv,
  nrep,
  nvars = 1,
  gen_eff = 20,
  env_eff = 15,
  rep_eff = 5,
  ge_eff = 10,
  res_eff = 5,
  intercept = 100,
  seed = NULL
)

g_simula(
  ngen,
  nrep,
  nvars = 1,
  gen_eff = 20,
  rep_eff = 5,
  res_eff = 5,
  intercept = 100,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_simula_+3A_ngen">ngen</code></td>
<td>
<p>The number of genotypes.</p>
</td></tr>
<tr><td><code id="data_simula_+3A_nenv">nenv</code></td>
<td>
<p>The number of environments.</p>
</td></tr>
<tr><td><code id="data_simula_+3A_nrep">nrep</code></td>
<td>
<p>The number of replications.</p>
</td></tr>
<tr><td><code id="data_simula_+3A_nvars">nvars</code></td>
<td>
<p>The number of traits.</p>
</td></tr>
<tr><td><code id="data_simula_+3A_gen_eff">gen_eff</code></td>
<td>
<p>The genotype effect.</p>
</td></tr>
<tr><td><code id="data_simula_+3A_env_eff">env_eff</code></td>
<td>
<p>The environment effect</p>
</td></tr>
<tr><td><code id="data_simula_+3A_rep_eff">rep_eff</code></td>
<td>
<p>The replication effect</p>
</td></tr>
<tr><td><code id="data_simula_+3A_ge_eff">ge_eff</code></td>
<td>
<p>The genotype-environment interaction effect.</p>
</td></tr>
<tr><td><code id="data_simula_+3A_res_eff">res_eff</code></td>
<td>
<p>The residual effect. The effect is sampled from a normal
distribution with zero mean and standard deviation equal to <code>res_eff</code>.
Be sure to change <code>res_eff</code> when changin the <code>intercept</code> scale.</p>
</td></tr>
<tr><td><code id="data_simula_+3A_intercept">intercept</code></td>
<td>
<p>The intercept.</p>
</td></tr>
<tr><td><code id="data_simula_+3A_seed">seed</code></td>
<td>
<p>The seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions simulate genotype or genotype-environment data given a
desired number of genotypes, environments and effects. All effects are
sampled from an uniform distribution. For example, given 10 genotypes, and
<code>gen_eff = 30</code>, the genotype effects will be sampled as <code>runif(10, min = -30, max = 30)</code>. Use the argument <code>seed</code> to ensure reproducibility. If more
than one trait is used (<code>nvars &gt; 1</code>), the effects and seed can be passed as
a numeric vector. Single numeric values will be recycled with a warning
when more than one trait is used.
</p>


<h3>Value</h3>

<p>A data frame with the simulated traits
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# Genotype data (5 genotypes and 3 replicates)
gen_data &lt;-
   g_simula(ngen = 5,
            nrep = 3,
            seed = 1)
gen_data
inspect(gen_data, plot = TRUE)

aov(V1 ~ GEN + REP, data = gen_data) %&gt;% anova()

# Genotype-environment data
# 5 genotypes, 3 environments, 4 replicates and 2 traits
df &lt;-
ge_simula(ngen = 5,
          nenv = 3,
          nrep = 4,
          nvars = 2,
          seed = 1)
ge_plot(df, ENV, GEN, V1)
aov(V1 ~ ENV*GEN + ENV/REP, data = df) %&gt;% anova()

# Change genotype effect (trait 1 with fewer differences among genotypes)
# Define different intercepts for the two traits
df2 &lt;-
ge_simula(ngen = 10,
          nenv = 3,
          nrep = 4,
          nvars = 2,
          gen_eff = c(1, 50),
          intercept = c(80, 1500),
          seed = 1)
ge_plot(df2, ENV, GEN, V2)

</code></pre>

<hr>
<h2 id='desc_stat'>Descriptive statistics</h2><span id='topic+desc_stat'></span><span id='topic+desc_wider'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code>desc_stat()</code> Computes the most used measures of central tendency,
position, and dispersion.
</p>
</li>
<li> <p><code>desc_wider()</code> is useful to put the variables in columns and grouping
variables in rows. The table is filled with a statistic chosen with the
argument <code>stat</code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>desc_stat(
  .data = NULL,
  ...,
  by = NULL,
  stats = "main",
  hist = FALSE,
  level = 0.95,
  digits = 4,
  na.rm = FALSE,
  verbose = TRUE,
  plot_theme = theme_metan()
)

desc_wider(.data, which)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="desc_stat_+3A_.data">.data</code></td>
<td>
<p>The data to be analyzed. It can be a data frame (possible with
grouped data passed from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code> or a numeric
vector. For <code>desc_wider()</code> <code>.data</code> is an object of class
<code>desc_stat</code>.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_...">...</code></td>
<td>
<p>A single variable name or a comma-separated list of unquoted
variables names. If no variable is informed, all the numeric variables from
<code>.data</code> will be used. Select helpers are allowed.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_stats">stats</code></td>
<td>
<p>The descriptive statistics to show. This is used to filter the
output after computation. Defaults to <code>"main"</code> (cv, max, mean median,
min, sd.amo, se, ci ). Other allowed values are <code>"all"</code> to
show all the statistics, <code>"robust"</code> to show robust statistics,
<code>"quantile"</code> to show quantile statistics, or chose one (or more) of the
following:
</p>

<ul>
<li> <p><code>"av.dev"</code>: average deviation.
</p>
</li>
<li> <p><code>"ci.t"</code>: t-interval (95% confidence interval) of the mean.
</p>
</li>
<li> <p><code>"ci.z"</code>: z-interval (95% confidence interval) of the mean.
</p>
</li>
<li> <p><code>"cv"</code>: coefficient of variation.
</p>
</li>
<li> <p><code>"iqr"</code>: interquartile range.
</p>
</li>
<li> <p><code>"gmean"</code>: geometric mean.
</p>
</li>
<li> <p><code>"hmean"</code>: harmonic mean.
</p>
</li>
<li> <p><code>"Kurt"</code>: kurtosis.
</p>
</li>
<li> <p><code>"mad"</code>: median absolute deviation.
</p>
</li>
<li> <p><code>"max"</code>: maximum value.
</p>
</li>
<li> <p><code>"mean"</code>: arithmetic mean.
</p>
</li>
<li> <p><code>"median"</code>: median.
</p>
</li>
<li> <p><code>"min"</code>: minimum value.
</p>
</li>
<li> <p><code>"n"</code>: the length of the data.
</p>
</li>
<li> <p><code>"n.valid"</code>: The valid (Not <code>NA</code>) number of elements
</p>
</li>
<li> <p><code>"n.missing"</code>: The number of missing values
</p>
</li>
<li> <p><code>"n.unique"</code>: The length of unique elements.
</p>
</li>
<li> <p><code>"ps"</code>: the pseudo-sigma (iqr / 1.35).
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"q2.5", "q25", "q75", "q97.5"&#8288;</code>: the percentile 2.5\
quartile, third quartile, and percentile 97.5\
</p>
</li>
<li> <p><code>range</code>: The range of data).
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"sd.amo", "sd.pop"&#8288;</code>: the sample and population standard deviation.
</p>
</li>
<li> <p><code>"se"</code>: the standard error of the mean.
</p>
</li>
<li> <p><code>"skew"</code>: skewness.
</p>
</li>
<li> <p><code>"sum"</code>. the sum of the values.
</p>
</li>
<li> <p><code>"sum.dev"</code>: the sum of the absolute deviations.
</p>
</li>
<li> <p><code>"ave.sq.dev"</code>: the average of the squared deviations.
</p>
</li>
<li> <p><code>"sum.sq.dev"</code>: the sum of the squared deviations.
</p>
</li>
<li> <p><code>"n.valid"</code>: The size of sample with valid number (not NA).
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"var.amo", "var.pop"&#8288;</code>: the sample and population variance.
</p>
</li></ul>

<p>Use a names to select the statistics. For example, <code>stats = c("median, mean, cv, n")</code>. Note that the statistic names <strong>are not</strong>
case-sensitive. Both comma or space can be used as separator.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_hist">hist</code></td>
<td>
<p>Logical argument defaults to <code>FALSE</code>. If <code>hist = TRUE</code>
then a histogram is created for each selected variable.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_level">level</code></td>
<td>
<p>The confidence level to compute the confidence interval of mean.
Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical. Should missing values be removed? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code is run
silently.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="desc_stat_+3A_which">which</code></td>
<td>
<p>A statistic to fill the table.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>desc_stats()</code> returns a tibble with the statistics in the columns and
variables (with possible grouping factors) in rows.
</p>
</li>
<li> <p><code>desc_wider()</code> returns a tibble with variables in columns and grouping
factors in rows.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
#===============================================================#
# Example 1: main statistics (coefficient of variation, maximum,#
# mean, median, minimum, sample standard deviation, standard    #
# error and confidence interval of the mean) for all numeric    #
# variables in data                                             #
#===============================================================#

desc_stat(data_ge2)

#===============================================================#
#Example 2: robust statistics using a numeric vector as input   #
# data
#===============================================================#
vect &lt;- data_ge2$TKW
desc_stat(vect, stats = "robust")

#===============================================================#
# Example 3: Select specific statistics. In this example, NAs   #
# are removed before analysis with a warning message            #
#===============================================================#
desc_stat(c(12, 13, 19, 21, 8, NA, 23, NA),
          stats = c('mean, se, cv, n, n.valid'),
          na.rm = TRUE)

#===============================================================#
# Example 4: Select specific variables and compute statistics by#
# levels of a factor variable (GEN)                             #
#===============================================================#
stats &lt;-
  desc_stat(data_ge2,
            EP, EL, EH, ED, PH, CD,
            by = GEN)
stats

# To get a 'wide' format with the maximum values for all variables
desc_wider(stats, max)

#===============================================================#
# Example 5: Compute all statistics for all numeric variables   #
# by two or more factors. Note that group_by() was used to pass #
# grouped data to the function desc_stat()                      #
#===============================================================#

data_ge2 %&gt;%
  group_by(ENV, GEN) %&gt;%
  desc_stat()


</code></pre>

<hr>
<h2 id='doo'>Alternative to dplyr::do for doing anything</h2><span id='topic+doo'></span>

<h3>Description</h3>

<p>Provides an alternative to the <code>dplyr:do()</code> using <code>nest()</code>,
<code>mutate()</code> and <code>map()</code> to apply a function to a grouped data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doo(.data, .fun, ..., unnest = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doo_+3A_.data">.data</code></td>
<td>
<p>a (grouped) data frame</p>
</td></tr>
<tr><td><code id="doo_+3A_.fun">.fun</code></td>
<td>
<p>A function, formula, or atomic vector.</p>
</td></tr>
<tr><td><code id="doo_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to <code>.fun</code></p>
</td></tr>
<tr><td><code id="doo_+3A_unnest">unnest</code></td>
<td>
<p>Logical argument defaults to <code>TRUE</code> to control if results
of <code>.fun</code> should be unnested. Valid only if the result is of class
<code>data.frame</code> or <code>tbl_df</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the applied function returns a data frame, then the output will be
automatically unnested. Otherwise, the output includes the grouping
variables and a column named &quot;data&quot; , which is a &quot;list-columns&quot; containing
the results for group combinations.
</p>


<h3>Value</h3>

<p>a data frame
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# Head the first two lines of each environment
data_ge2 %&gt;%
 group_by(ENV) %&gt;%
 doo(~head(., 2))

# Genotype analysis for each environment using 'gafem()'
# variable PH
data_ge2 %&gt;%
  group_by(ENV) %&gt;%
  doo(~gafem(., GEN, REP, PH, verbose = FALSE))

</code></pre>

<hr>
<h2 id='ecovalence'>Stability analysis based on Wricke's model</h2><span id='topic+ecovalence'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>The function computes the ecovalence (Wricke, 1965) for stability analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecovalence(.data, env, gen, rep, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecovalence_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="ecovalence_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="ecovalence_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ecovalence_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="ecovalence_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="ecovalence_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ecovalence</code> containing the results for each
variable used in the argument <code>resp</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Wricke, G. 1965. Zur berechnung der okovalenz bei sommerweizen
und hafer. Z. Pflanzenzuchtg 52:127-138.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
out &lt;- ecovalence(data_ge2,
                 env = ENV,
                 gen = GEN,
                 rep = REP,
                 resp = PH)


</code></pre>

<hr>
<h2 id='env_dissimilarity'>Dissimilarity between environments</h2><span id='topic+env_dissimilarity'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes the dissimilarity between environments based on several approaches.
See the section <strong>details</strong> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>env_dissimilarity(.data, env, gen, rep, resp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="env_dissimilarity_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="env_dissimilarity_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="env_dissimilarity_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="env_dissimilarity_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="env_dissimilarity_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also allowed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Roberteson (1959) proposed the partition of the mean square of the
genotype-environment interaction  (MS_GE) into single (S) and complex (C)
parts, where <code class="reqn">S = \frac{1}{2}(\sqrt{Q1}-\sqrt{Q2})^2)</code> and <code class="reqn">C =
  (1-r)\sqrt{Q1-Q2}</code>, being <em>r</em> the correlation between the genotype's
average in the two environments; and <em>Q1</em> and <em>Q2</em> the genotype
mean square in the environments 1 and 2, respectively. Cruz and Castoldi
(1991) proposed a new decomposition of the MS_GE, in which the complex part
is given by <code class="reqn">C = \sqrt{(1-r)^3\times Q1\times Q2}</code>.
</p>


<h3>Value</h3>

<p>A list with the following matrices:
</p>

<ul>
<li> <p><code>SPART_CC</code>: The percentage of the single (non cross-over) part of the
interaction between genotypes and pairs of environments according to the
method proposed by Cruz and Castoldi (1991).
</p>
</li>
<li> <p><code>CPART_CC</code>: The percentage of the complex (cross-over) part of the
interaction between genotypes and pairs of environments according to the
method proposed by Cruz and Castoldi (1991).
</p>
</li>
<li> <p><code>SPART_RO</code>: The percentage of the single (non cross-over) part of the
interaction between genotypes and pairs of environments according to the
method proposed by Robertson (1959).
</p>
</li>
<li> <p><code>CPART_RO</code>: The percentage of the complex (cross-over) part of the
interaction between genotypes and pairs of environments according to the
method proposed by Robertson (1959).
</p>
</li>
<li> <p><code>MSGE</code>: Interaction mean square between genotypes and pairs of
environments.
</p>
</li>
<li> <p><code>SSGE</code>: Interaction sum of square between genotypes and pairs of
environments.
</p>
</li>
<li> <p><code>correlation</code>: Correlation coefficients between genotypes's average in
each pair of environment.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Cruz, C.D., Castoldi, F. (1991). Decomposicao da interacao genotipos x
ambientes em partes simples e complexa. Ceres, 38:422-430.
</p>
<p>Robertson, A. (1959). Experimental design on the measurement of
heritabilities and genetic correlations. biometrical genetics. New York:
Pergamon Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mod &lt;- env_dissimilarity(data_ge, ENV, GEN, REP, GY)
print(mod)

</code></pre>

<hr>
<h2 id='env_stratification'>Environment stratification</h2><span id='topic+env_stratification'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes environment stratification based on factor analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>env_stratification(
  .data,
  env,
  gen,
  resp,
  use = "complete.obs",
  mineval = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="env_stratification_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s)</p>
</td></tr>
<tr><td><code id="env_stratification_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="env_stratification_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="env_stratification_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="env_stratification_+3A_use">use</code></td>
<td>
<p>The method for computing covariances in the presence of missing
values. Defaults to <code>complete.obs</code>, i.e., missing values are handled
by casewise deletion.</p>
</td></tr>
<tr><td><code id="env_stratification_+3A_mineval">mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td></tr>
<tr><td><code id="env_stratification_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>env_stratification</code> which is a list with one
element per analyzed trait. For each trait, the following values are given.
</p>

<ul>
<li> <p><code>data</code> The genotype-environment means.
</p>
</li>
<li> <p><code>cormat</code>: The correlation matrix among the environments.
</p>
</li>
<li> <p><code>PCA</code>: The eigenvalues and explained variance.
</p>
</li>
<li> <p><code>FA</code>: The factor analysis.
</p>
</li>
<li> <p><code>env_strat</code>: The environmental stratification.
</p>
</li>
<li> <p><code>mega_env_code</code>: The environments within each mega-environment.
</p>
</li>
<li> <p><code>mega_env_stat</code>: The statistics for each mega-environment.
</p>
</li>
<li> <p><code>KMO</code>: The result for the Kaiser-Meyer-Olkin test.
</p>
</li>
<li> <p><code>MSA</code>: The measure of sampling adequacy for individual variable.
</p>
</li>
<li> <p><code>communalities_mean</code>: The communalities' mean.
</p>
</li>
<li> <p><code>initial_loadings</code>: The initial loadings.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto, <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Murakami, D.M.D., and C.D.C. Cruz. 2004. Proposal of
methodologies for environment stratification and analysis of genotype
adaptability. Crop Breed. Appl. Biotechnol. 4:7-11.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+env_dissimilarity">env_dissimilarity()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;-
env_stratification(data_ge,
                   env = ENV,
                   gen = GEN,
                   resp = everything())
gmd(model)


</code></pre>

<hr>
<h2 id='fai_blup'>Multi-trait selection index</h2><span id='topic+fai_blup'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Multitrait index based on factor analysis and ideotype-design proposed by
Rocha et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fai_blup(
  .data,
  use_data = "blup",
  DI = NULL,
  UI = NULL,
  SI = 15,
  mineval = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fai_blup_+3A_.data">.data</code></td>
<td>
<p>An object of class <code>waasb</code> or a two-way table with
genotypes in the rows and traits in columns. In the last case the row names
must contain the genotypes names.</p>
</td></tr>
<tr><td><code id="fai_blup_+3A_use_data">use_data</code></td>
<td>
<p>Define which data to use If <code>.data</code> is an object of
class <code>gamem</code>. Defaults to <code>"blup"</code> (the BLUPs for genotypes).
Use <code>"pheno"</code> to use phenotypic means instead BLUPs for computing the
index.</p>
</td></tr>
<tr><td><code id="fai_blup_+3A_di">DI</code>, <code id="fai_blup_+3A_ui">UI</code></td>
<td>
<p>A vector of the same length of <code>.data</code> to construct the
desirable (DI) and undesirable (UI) ideotypes. For each element of the
vector, allowed values are <code>'max'</code>, <code>'min'</code>, <code>'mean'</code>, or a
numeric value. Use a comma-separated vector of text. For example, <code>DI = c("max, max, min, min")</code>. By default, DI is set to <code>"max"</code> for all
traits and UI is set to <code>"min"</code> for all traits.</p>
</td></tr>
<tr><td><code id="fai_blup_+3A_si">SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes. Defaults to 15.</p>
</td></tr>
<tr><td><code id="fai_blup_+3A_mineval">mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td></tr>
<tr><td><code id="fai_blup_+3A_verbose">verbose</code></td>
<td>
<p>Logical value. If <code>TRUE</code> some results are shown in
console.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>fai_blup</code> with the following items:
</p>

<ul>
<li> <p><strong>data</strong> The data (BLUPS) used to compute the index.
</p>
</li>
<li> <p><strong>eigen</strong> The eigenvalues and explained variance for each axis.
</p>
</li>
<li> <p><strong>FA</strong> The results of the factor analysis.
</p>
</li>
<li> <p><strong>canonical_loadings</strong> The canonical loadings for each factor retained.
</p>
</li>
<li> <p><strong>FAI</strong> A list with the FAI-BLUP index for each ideotype design.
</p>
</li>
<li> <p><strong>sel_dif_trait</strong> A list with the selection differential for each ideotype design.
</p>
</li>
<li> <p><strong>sel_gen</strong> The selected genotypes.
</p>
</li>
<li> <p><strong>ideotype_construction</strong> A list with the construction of the ideotypes.
</p>
</li>
<li> <p><strong>total_gain</strong> A list with the total gain for variables to be increased or decreased.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Rocha, J.R.A.S.C.R, J.C. Machado, and P.C.S. Carneiro. 2018. Multitrait index
based on factor analysis and ideotype-design: proposal and application on
elephant grass breeding for bioenergy. GCB Bioenergy 10:52-60.
<a href="https://doi.org/10.1111/gcbb.12443">doi:10.1111/gcbb.12443</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

mod &lt;- waasb(data_ge,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = c(GY, HM))

FAI &lt;- fai_blup(mod,
                SI = 15,
                DI = c('max, max'),
                UI = c('min, min'))

</code></pre>

<hr>
<h2 id='find_outliers'>Find possible outliers in a dataset</h2><span id='topic+find_outliers'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Find possible outliers in the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_outliers(
  .data = NULL,
  var = NULL,
  by = NULL,
  plots = FALSE,
  coef = 1.5,
  verbose = TRUE,
  plot_theme = theme_metan()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_outliers_+3A_.data">.data</code></td>
<td>
<p>The data to be analyzed. Must be a dataframe or an object of
class <code>split_factors</code>.</p>
</td></tr>
<tr><td><code id="find_outliers_+3A_var">var</code></td>
<td>
<p>The variable to be analyzed.</p>
</td></tr>
<tr><td><code id="find_outliers_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="find_outliers_+3A_plots">plots</code></td>
<td>
<p>If <code>TRUE</code>, then histograms and boxplots are shown.</p>
</td></tr>
<tr><td><code id="find_outliers_+3A_coef">coef</code></td>
<td>
<p>The multiplication coefficient, defaults to 1.5. For more details
see <code>?boxplot.stat</code>.</p>
</td></tr>
<tr><td><code id="find_outliers_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> then some results are shown in the
console.</p>
</td></tr>
<tr><td><code id="find_outliers_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

find_outliers(data_ge2, var = PH, plots = TRUE)

# Find outliers within each environment
find_outliers(data_ge2, var = PH, by = ENV)


</code></pre>

<hr>
<h2 id='Fox'>Fox's stability function</h2><span id='topic+Fox'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs a stability analysis based on the criteria of Fox et al. (1990),
using the statistical &quot;TOP third&quot; only. A stratified ranking of the genotypes
at each environment is done. The proportion of locations at which the
genotype occurred in the top third are expressed in the output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fox(.data, env, gen, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Fox_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="Fox_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="Fox_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="Fox_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="Fox_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>Fox</code>, which is a list containing the results
for each variable used in the argument <code>resp</code>. For each variable, a
tibble with the following columns is returned.
</p>

<ul>
<li> <p><strong>GEN</strong> the genotype's code.
</p>
</li>
<li> <p><strong>mean</strong> the mean for the response variable.
</p>
</li>
<li> <p><strong>TOP</strong> The proportion of locations at which the
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Fox, P.N., B. Skovmand, B.K. Thompson, H.J. Braun, and R.
Cormier. 1990. Yield and adaptation of hexaploid spring triticale.
Euphytica 47:57-64.
<a href="https://doi.org/10.1007/BF00040364">doi:10.1007/BF00040364</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
out &lt;- Fox(data_ge2, ENV, GEN, PH)
print(out)


</code></pre>

<hr>
<h2 id='gafem'>Genotype analysis by fixed-effect models</h2><span id='topic+gafem'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>One-way analysis of variance of genotypes conducted in both randomized
complete block and alpha-lattice designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gafem(
  .data,
  gen,
  rep,
  resp,
  block = NULL,
  by = NULL,
  prob = 0.05,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gafem_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to, Genotypes,
replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="gafem_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes, that will
be treated as random effect.</p>
</td></tr>
<tr><td><code id="gafem_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the replications
(assumed to be fixed).</p>
</td></tr>
<tr><td><code id="gafem_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also allowed.</p>
</td></tr>
<tr><td><code id="gafem_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong> Use the
function <code><a href="#topic+gamem">gamem()</a></code> to analyze a one-way trial with mixed-effect
models.</p>
</td></tr>
<tr><td><code id="gafem_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.This is especially useful, for example,
when the researcher want to fit a fixed-effect model for each environment.
In this case, an object of class gafem_grouped is returned.
<code><a href="#topic+mgidi">mgidi()</a></code> can then be used to compute the mgidi index within each
environment.</p>
</td></tr>
<tr><td><code id="gafem_+3A_prob">prob</code></td>
<td>
<p>The error probability. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="gafem_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code are run
silently.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>gafem</code> analyses data from a one-way genotype testing
experiment. By default, a randomized complete block design is used
according to the following model:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[Y_{ij} = m + g_i + r_j + e_{ij}\]
where \(Y_{ij}\) is the response variable of the ith genotype in the
<em>j</em>th block; <em>m</em> is the grand mean (fixed); \(g_i\) is the effect
of the <em>i</em>th genotype; \(r_j\) is the effect of the <em>j</em>th
replicate; and \(e_{ij}\) is the random error.
</p>
<p>When <code>block</code> is informed, then a resolvable alpha design is implemented,
according to the following model:
</p>
\[Y_{ijk} = m + g_i + r_j + b_{jk} + e_{ijk}\]
<p>where where \(y_{ijk}\)
is the response variable of the <em>i</em>th genotype in the <em>k</em>th block
of the <em>j</em>th replicate; <em>m</em> is the intercept, \(t_i\) is the
effect for the <em>i</em>th genotype \(r_j\) is the effect of the <em>j</em>th
replicate, \(b_{jk}\) is the effect of the <em>k</em>th incomplete block of
the <em>j</em>th replicate, and \(e_{ijk}\) is the plot error effect
corresponding to \(y_{ijk}\). All effects, except the random error are
assumed to be fixed.
</p>


<h3>Value</h3>

<p>A list where each element is the result for one variable containing
the following objects:
</p>

<ul>
<li> <p><strong>anova:</strong> The one-way ANOVA table.
</p>
</li>
<li> <p><strong>model:</strong> The model with of <code>lm</code>.
</p>
</li>
<li> <p><strong>augment:</strong> Information about each observation in the dataset. This
includes predicted values in the <code>fitted</code> column, residuals in the
<code>resid</code> column, standardized residuals in the <code>stdres</code> column,
the diagonal of the 'hat' matrix in the <code>hat</code>, and standard errors for
the fitted values in the <code>se.fit</code> column.
</p>
</li>
<li> <p><strong>hsd:</strong> The Tukey's 'Honest Significant Difference' for genotype
effect.
</p>
</li>
<li> <p><strong>details:</strong> A tibble with the following data: <code>Ngen</code>, the
number of genotypes; <code>OVmean</code>, the grand mean; <code>Min</code>, the minimum
observed (returning the genotype and replication/block); <code>Max</code> the
maximum observed, <code>MinGEN</code> the loser winner genotype, <code>MaxGEN</code>,
the winner genotype.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_model_data">get_model_data()</a></code> <code><a href="#topic+gamem">gamem()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# RCBD
rcbd &lt;- gafem(data_g,
             gen = GEN,
             rep = REP,
             resp = c(PH, ED, EL, CL, CW))

# Fitted values
get_model_data(rcbd)

# ALPHA-LATTICE DESIGN
alpha &lt;- gafem(data_alpha,
              gen = GEN,
              rep = REP,
              block = BLOCK,
              resp = YIELD)

# Fitted values
get_model_data(alpha)



</code></pre>

<hr>
<h2 id='gai'>Geometric adaptability index</h2><span id='topic+gai'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs a stability analysis based on the geometric mean (GAI), according to
the following model (Mohammadi and Amri, 2008):
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[GAI = \sqrt[E]{{\mathop {\bar Y}\nolimits_1  + \mathop {\bar Y}\nolimits_2  + ... + \mathop {\bar Y}\nolimits_i }}\]
where \(\bar Y_1\), \(\bar Y_2\), and \(\bar Y_i\) are
the mean yields of the first, second and <em>i</em>-th genotypes across
environments, and E is the number of environments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gai(.data, env, gen, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gai_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="gai_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="gai_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="gai_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="gai_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>gai</code>, which is a list containing the results
for each variable used in the argument <code>resp</code>. For each variable, a
tibble with the following columns is returned.
</p>

<ul>
<li> <p><strong>GEN</strong> the genotype's code.
</p>
</li>
<li> <p><strong>GAI</strong> Geometric adaptability index
</p>
</li>
<li> <p><strong>GAI_R</strong> The rank for the GAI value.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Mohammadi, R., &amp; Amri, A. (2008). Comparison of parametric and non-parametric
methods for selecting stable and adapted durum wheat genotypes in variable
environments. Euphytica, 159(3), 419-432.
<a href="https://doi.org/10.1007/s10681-007-9600-6">doi:10.1007/s10681-007-9600-6</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
out &lt;- gai(data_ge2,
           env = ENV,
           gen = GEN,
           resp = c(EH, PH, EL, CD, ED, NKE))


</code></pre>

<hr>
<h2 id='gamem'>Genotype analysis by mixed-effect models</h2><span id='topic+gamem'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Analysis of genotypes in single experiments using mixed-effect models with
estimation of genetic parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamem(
  .data,
  gen,
  rep,
  resp,
  block = NULL,
  by = NULL,
  prob = 0.05,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gamem_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to, Genotypes,
replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="gamem_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes,
that will be treated as random effect.</p>
</td></tr>
<tr><td><code id="gamem_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications (assumed to be fixed).</p>
</td></tr>
<tr><td><code id="gamem_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also allowed.</p>
</td></tr>
<tr><td><code id="gamem_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then an alpha-lattice
design is employed considering block as random to make use of inter-block
information, whereas the complete replicate effect is always taken as
fixed, as no inter-replicate information was to be recovered (Mohring et
al., 2015).</p>
</td></tr>
<tr><td><code id="gamem_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.This is especially useful, for example,
when the researcher want to fit a mixed-effect model for each environment.
In this case, an object of class gamem_grouped is returned.
<code><a href="#topic+mgidi">mgidi()</a></code> can then be used to compute the mgidi index within each
environment.</p>
</td></tr>
<tr><td><code id="gamem_+3A_prob">prob</code></td>
<td>
<p>The probability for estimating confidence interval for BLUP's
prediction.</p>
</td></tr>
<tr><td><code id="gamem_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code are run
silently.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>gamem</code> analyses data from a one-way genotype testing experiment.
By default, a randomized complete block design is used according to the following model:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[Y_{ij} = m + g_i + r_j + e_{ij}\]
where \(Y_{ij}\) is the response variable of the ith genotype in the <em>j</em>th block;
<em>m</em> is the grand mean (fixed); \(g_i\) is the effect of the <em>i</em>th genotype
(assumed to be random); \(r_j\) is the effect of the <em>j</em>th replicate (assumed to be fixed);
and \(e_{ij}\) is the random error.
</p>
<p>When <code>block</code> is informed, then a resolvable alpha design is implemented, according to the following model:
</p>
\[Y_{ijk} = m + g_i + r_j + b_{jk} + e_{ijk}\]
<p>where where \(y_{ijk}\) is the response variable of the <em>i</em>th genotype in the
<em>k</em>th block of the <em>j</em>th replicate; <em>m</em> is the intercept, \(t_i\) is
the effect for the <em>i</em>th genotype \(r_j\) is the effect of the <em>j</em>th
replicate, \(b_{jk}\) is the effect of the <em>k</em>th incomplete block of
the <em>j</em>th replicate, and \(e_{ijk}\) is the plot error effect
corresponding to \(y_{ijk}\).
</p>


<h3>Value</h3>

<p>An object of class <code>gamem</code> or <code>gamem_grouped</code>, which is a
list with the following items for each element (variable):
</p>

<ul>
<li> <p><strong>fixed:</strong> Test for fixed effects.
</p>
</li>
<li> <p><strong>random:</strong> Variance components for random effects.
</p>
</li>
<li> <p><strong>LRT:</strong> The Likelihood Ratio Test for the random effects.
</p>
</li>
<li> <p><strong>BLUPgen:</strong> The estimated BLUPS for genotypes
</p>
</li>
<li> <p><strong>ranef:</strong> The random effects of the model
</p>
</li>
<li> <p><strong>modellme</strong> The mixed-effect model of class <code>lmerMod</code>.
</p>
</li>
<li> <p><strong>residuals</strong> The residuals of the mixed-effect model.
</p>
</li>
<li> <p><strong>model_lm</strong> The fixed-effect model of class <code>lm</code>.
</p>
</li>
<li> <p><strong>residuals_lm</strong> The residuals of the fixed-effect model.
</p>
</li>
<li> <p><strong>Details:</strong> A tibble with the following data: <code>Ngen</code>, the
number of genotypes; <code>OVmean</code>, the grand mean; <code>Min</code>, the minimum
observed (returning the genotype and replication/block); <code>Max</code> the
maximum observed, <code>MinGEN</code> the winner genotype, <code>MaxGEN</code>, the
loser genotype.
</p>
</li>
<li> <p><strong>ESTIMATES:</strong> A tibble with the values:
</p>

<ul>
<li> <p><code>Gen_var</code>, the genotypic variance and ;
</p>
</li>
<li> <p><code>rep:block_var</code> block-within-replicate variance (if
an alpha-lattice design is used by informing the block in <code>block</code>);
</p>
</li>
<li> <p><code>Res_var</code>, the residual variance;
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;Gen (%), rep:block (%), and Res (%)&#8288;</code> the respective contribution
of variance components to the phenotypic variance;
</p>
</li>
<li> <p><code>H2</code>, broad-sense heritability;
</p>
</li>
<li> <p><code>h2mg</code>, heritability on the entry-mean basis;
</p>
</li>
<li> <p><code>Accuracy</code>, the accuracy of selection (square root of
<code>h2mg</code>);
</p>
</li>
<li> <p><code>CVg</code>, genotypic coefficient of variation;
</p>
</li>
<li> <p><code>CVr</code>, residual coefficient of variation;
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;CV ratio&#8288;</code>, the ratio between genotypic and residual coefficient of
variation.
</p>
</li></ul>

</li>
<li> <p><strong>formula</strong> The formula used to fit the mixed-model.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Mohring, J., E. Williams, and H.-P. Piepho. 2015. Inter-block information:
to recover or not to recover it? TAG. Theor. Appl. Genet. 128:1541-54.
<a href="https://doi.org/10.1007/s00122-015-2530-0">doi:10.1007/s00122-015-2530-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_model_data">get_model_data()</a></code> <code><a href="#topic+waasb">waasb()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

# fitting the model considering an RCBD
# Genotype as random effects

rcbd &lt;- gamem(data_g,
             gen = GEN,
             rep = REP,
             resp = c(PH, ED, EL, CL, CW, KW, NR, TKW, NKE))

# Likelihood ratio test for random effects
get_model_data(rcbd, "lrt")


# Variance components
get_model_data(rcbd, "vcomp")

# Genetic parameters
get_model_data(rcbd, "genpar")

# random effects
get_model_data(rcbd, "ranef")

# Predicted values
predict(rcbd)

# fitting the model considering an alpha-lattice design
# Genotype and block-within-replicate as random effects
# Note that block effect was now informed.

alpha &lt;- gamem(data_alpha,
               gen = GEN,
               rep = REP,
               block = BLOCK,
               resp = YIELD)
# Genetic parameters
get_model_data(alpha, "genpar")

# Random effects
get_model_data(alpha, "ranef")


</code></pre>

<hr>
<h2 id='gamem_met'>Genotype-environment analysis by mixed-effect models</h2><span id='topic+gamem_met'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Genotype analysis in multi-environment trials using mixed-effect or
random-effect models.
</p>
<p>The nature of the effects in the model is chosen with the argument
<code>random</code>. By default, the experimental design considered in each
environment is a randomized complete block design. If <code>block</code> is
informed, a resolvable alpha-lattice design (Patterson and Williams, 1976) is
implemented. The following six models can be fitted depending on the values
of <code>random</code> and <code>block</code> arguments.
</p>

<ul>
<li> <p><strong>Model 1:</strong> <code>block = NULL</code> and <code>random = "gen"</code> (The
default option). This model considers a Randomized Complete Block Design in
each environment assuming genotype and genotype-environment interaction as
random effects. Environments and blocks nested within environments are
assumed to fixed factors.
</p>
</li>
<li> <p><strong>Model 2:</strong> <code>block = NULL</code> and <code>random = "env"</code>. This
model considers a Randomized Complete Block Design in each environment
treating environment, genotype-environment interaction, and blocks nested
within environments as random factors. Genotypes are assumed to be fixed
factors.
</p>
</li>
<li> <p><strong>Model 3:</strong> <code>block = NULL</code> and <code>random = "all"</code>. This
model considers a Randomized Complete Block Design in each environment
assuming a random-effect model, i.e., all effects (genotypes, environments,
genotype-vs-environment interaction and blocks nested within environments)
are assumed to be random factors.
</p>
</li>
<li> <p><strong>Model 4:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "gen"</code>. This model considers an alpha-lattice design in each environment
assuming genotype, genotype-environment interaction, and incomplete blocks
nested within complete replicates as random to make use of inter-block
information (Mohring et al., 2015). Complete replicates nested within
environments and environments are assumed to be fixed factors.
</p>
</li>
<li> <p><strong>Model 5:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "env"</code>. This model considers an alpha-lattice design in each environment
assuming genotype as fixed. All other sources of variation (environment,
genotype-environment interaction, complete replicates nested within
environments, and incomplete blocks nested within replicates) are assumed
to be random factors.
</p>
</li>
<li> <p><strong>Model 6:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "all"</code>. This model considers an alpha-lattice design in each environment
assuming all effects, except the intercept, as random factors.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>gamem_met(
  .data,
  env,
  gen,
  rep,
  resp,
  block = NULL,
  by = NULL,
  random = "gen",
  prob = 0.05,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gamem_met_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="gamem_met_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="gamem_met_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="gamem_met_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="gamem_met_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="gamem_met_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then an alpha-lattice
design is employed considering block as random to make use of inter-block
information, whereas the complete replicate effect is always taken as
fixed, as no inter-replicate information was to be recovered (Mohring et
al., 2015).</p>
</td></tr>
<tr><td><code id="gamem_met_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.This is especially useful, for example,
when the researcher want to analyze environments within mega-environments.
In this case, an object of class waasb_grouped is returned.</p>
</td></tr>
<tr><td><code id="gamem_met_+3A_random">random</code></td>
<td>
<p>The effects of the model assumed to be random. Defaults to
<code>random = "gen"</code>. See <strong>Details</strong> to see the random effects
assumed depending on the experimental design of the trials.</p>
</td></tr>
<tr><td><code id="gamem_met_+3A_prob">prob</code></td>
<td>
<p>The probability for estimating confidence interval for BLUP's
prediction.</p>
</td></tr>
<tr><td><code id="gamem_met_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>waasb</code> with the following items for each
variable:
</p>

<ul>
<li> <p><strong>fixed</strong> Test for fixed effects.
</p>
</li>
<li> <p><strong>random</strong> Variance components for random effects.
</p>
</li>
<li> <p><strong>LRT</strong> The Likelihood Ratio Test for the random effects.
</p>
</li>
<li> <p><strong>BLUPgen</strong> The random effects and estimated BLUPS for genotypes (If
<code>random = "gen"</code> or <code>random = "all"</code>)
</p>
</li>
<li> <p><strong>BLUPenv</strong> The random effects and estimated BLUPS for environments,
(If <code>random = "env"</code> or <code>random = "all"</code>).
</p>
</li>
<li> <p><strong>BLUPint</strong> The random effects and estimated BLUPS of all genotypes in
all environments.
</p>
</li>
<li> <p><strong>MeansGxE</strong> The phenotypic means of genotypes in the environments.
</p>
</li>
<li> <p><strong>modellme</strong> The mixed-effect model of class <code>lmerMod</code>.
</p>
</li>
<li> <p><strong>residuals</strong> The residuals of the mixed-effect model.
</p>
</li>
<li> <p><strong>model_lm</strong> The fixed-effect model of class <code>lm</code>.
</p>
</li>
<li> <p><strong>residuals_lm</strong> The residuals of the fixed-effect model.
</p>
</li>
<li> <p><strong>Details</strong> A list summarizing the results. The following information
are shown: <code>Nenv</code>, the number of environments in the analysis;
<code>Ngen</code> the number of genotypes in the analysis; <code>Mean</code> the grand
mean; <code>SE</code> the standard error of the mean; <code>SD</code> the standard
deviation. <code>CV</code> the coefficient of variation of the phenotypic means,
estimating WAASB, <code>Min</code> the minimum value observed (returning the
genotype and environment), <code>Max</code> the maximum value observed (returning
the genotype and environment); <code>MinENV</code> the environment with the lower
mean, <code>MaxENV</code> the environment with the larger mean observed,
<code>MinGEN</code> the genotype with the lower mean, <code>MaxGEN</code> the genotype
with the larger.
</p>
</li>
<li> <p><strong>ESTIMATES</strong> A tibble with the genetic parameters (if <code>random = "gen"</code> or <code>random = "all"</code>) with the following columns: <code style="white-space: pre;">&#8288;Phenotypic variance&#8288;</code> the phenotypic variance; <code>Heritability</code> the broad-sense
heritability; <code>GEr2</code> the coefficient of determination of the interaction
effects; <code>h2mg</code> the heritability on the mean basis;
<code>Accuracy</code> the selective accuracy; <code>rge</code> the genotype-environment
correlation; <code>CVg</code> the genotypic coefficient of variation; <code>CVr</code>
the residual coefficient of variation; <code style="white-space: pre;">&#8288;CV ratio&#8288;</code> the ratio between
genotypic and residual coefficient of variation.
</p>
</li>
<li> <p><strong>formula</strong> The formula used to fit the mixed-model.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in multi-environment
trials I: Combining features of AMMI and BLUP techniques. Agron. J.
111:2949-2960.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Mohring, J., E. Williams, and H.-P. Piepho. 2015. Inter-block information: to
recover or not to recover it? TAG. Theor. Appl. Genet. 128:1541-54.
<a href="https://doi.org/10.1007/s00122-015-2530-0">doi:10.1007/s00122-015-2530-0</a>
</p>
<p>Patterson, H.D., and E.R. Williams. 1976. A new class of resolvable
incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtsi">mtsi()</a></code> <code><a href="#topic+waas">waas()</a></code>
<code><a href="#topic+get_model_data">get_model_data()</a></code> <code><a href="#topic+plot_scores">plot_scores()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
#===============================================================#
# Example 1: Analyzing all numeric variables assuming genotypes #
# as random effects                                             #
#===============================================================#
model &lt;- gamem_met(data_ge,
                  env = ENV,
                  gen = GEN,
                  rep = REP,
                  resp = everything())
# Distribution of random effects (first variable)
plot(model, type = "re")

# Genetic parameters
get_model_data(model, "genpar")



#===============================================================#
# Example 2: Unbalanced trials                                  #
# assuming all factors as random effects                        #
#===============================================================#
un_data &lt;- data_ge %&gt;%
             remove_rows(1:3) %&gt;%
             droplevels()

model2 &lt;- gamem_met(un_data,
                   env = ENV,
                   gen = GEN,
                   rep = REP,
                   random = "all",
                   resp = GY)
get_model_data(model2)


</code></pre>

<hr>
<h2 id='ge_acv'>Adjusted Coefficient of Variation as yield stability index</h2><span id='topic+ge_acv'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs a stability analysis based on the scale-adjusted coefficient of
variation (Doring and Reckling, 2018). For more details see
<code><a href="#topic+acv">acv()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_acv(.data, env, gen, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_acv_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes and response variable(s).</p>
</td></tr>
<tr><td><code id="ge_acv_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="ge_acv_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_acv_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="ge_acv_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ge_acv</code>, which is a list containing the
results for each variable used in the argument <code>resp</code>. For each
variable, a tibble with the following columns is returned.
</p>

<ul>
<li> <p><strong>GEN</strong> the genotype's code.
</p>
</li>
<li> <p><strong>ACV</strong> The adjusted coefficient of variation
</p>
</li>
<li> <p><strong>ACV_R</strong> The rank for the ACV value.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Doring, T.F., and M. Reckling. 2018. Detecting global trends of
cereal yield stability by adjusting the coefficient of variation. Eur. J.
Agron. 99: 30-36. <a href="https://doi.org/10.1016/j.eja.2018.06.007">doi:10.1016/j.eja.2018.06.007</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
out &lt;- ge_acv(data_ge2, ENV, GEN, c(EH, PH, EL, CD, ED, NKE))
gmd(out)


</code></pre>

<hr>
<h2 id='ge_cluster'>Cluster genotypes or environments</h2><span id='topic+ge_cluster'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs clustering for genotypes or tester environments based on a dissimilarity matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_cluster(
  .data,
  env = NULL,
  gen = NULL,
  resp = NULL,
  table = FALSE,
  distmethod = "euclidean",
  clustmethod = "ward.D",
  scale = TRUE,
  cluster = "env",
  nclust = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_cluster_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments, Genotypes
and the response variable. It is also possible to use a two-way table with genotypes
in lines and environments in columns as input. In this case you must use <code>table = TRUE</code>.</p>
</td></tr>
<tr><td><code id="ge_cluster_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the environments. Defaults to <code>NULL</code>,
in case of the input data is a two-way table.</p>
</td></tr>
<tr><td><code id="ge_cluster_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes. Defaults to <code>NULL</code>,
in case of the input data is a two-way table.</p>
</td></tr>
<tr><td><code id="ge_cluster_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). Defaults to <code>NULL</code>, in case of the input data is a two-way table.</p>
</td></tr>
<tr><td><code id="ge_cluster_+3A_table">table</code></td>
<td>
<p>Logical values indicating if the input data is a two-way table with genotypes
in the rows and environments in the columns. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ge_cluster_+3A_distmethod">distmethod</code></td>
<td>
<p>The distance measure to be used. This must be one of
<code>'euclidean'</code>, <code>'maximum'</code>, <code>'manhattan'</code>, <code>'canberra'</code>,
<code>'binary'</code>, or <code>'minkowski'</code>.</p>
</td></tr>
<tr><td><code id="ge_cluster_+3A_clustmethod">clustmethod</code></td>
<td>
<p>The agglomeration method to be used. This should be one
of <code>'ward.D'</code> (Default), <code>'ward.D2'</code>, <code>'single'</code>, <code>'complete'</code>,
<code>'average'</code> (= UPGMA), <code>'mcquitty'</code> (= WPGMA), <code>'median'</code> (=
WPGMC) or <code>'centroid'</code> (= UPGMC).</p>
</td></tr>
<tr><td><code id="ge_cluster_+3A_scale">scale</code></td>
<td>
<p>Should the data be scaled befor computing the distances? Set to
TRUE. Let <code class="reqn">Y_{ij}</code> be the yield of Hybrid <em>i</em> in Location <em>j</em>,
<code class="reqn">\bar Y_{.j}</code> be the mean yield, and <code class="reqn">S_j</code> be the standard deviation of
Location <em>j</em>. The standardized yield (Zij) is computed as (Ouyang et al. 1995):
<code class="reqn">Z_{ij} = (Y_{ij} - Y_{.j}) / S_j</code>.</p>
</td></tr>
<tr><td><code id="ge_cluster_+3A_cluster">cluster</code></td>
<td>
<p>What should be clustered? Defaults to <code>cluster = "env"</code> (cluster environments).
To cluster the genotypes use <code>cluster = "gen"</code>.</p>
</td></tr>
<tr><td><code id="ge_cluster_+3A_nclust">nclust</code></td>
<td>
<p>The number of clust to be formed. Set to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><strong>data</strong> The data that was used to compute the distances.
</p>
</li>
<li> <p><strong>cutpoint</strong> The cutpoint of the dendrogram according to Mojena (1977).
</p>
</li>
<li> <p><strong>distance</strong> The matrix with the distances.
</p>
</li>
<li> <p><strong>de</strong> The distances in an object of class <code>dist</code>.
</p>
</li>
<li> <p><strong>hc</strong> The hierarchical clustering.
</p>
</li>
<li> <p><strong>cophenetic</strong> The cophenetic correlation coefficient between distance matrix
and cophenetic matrix
</p>
</li>
<li> <p><strong>Sqt</strong> The total sum of squares.
</p>
</li>
<li> <p><strong>tab</strong> A table with the clusters and similarity.
</p>
</li>
<li> <p><strong>clusters</strong> The sum of square and the mean of the clusters for each
genotype (if <code>cluster = "env"</code> or environment (if <code>cluster = "gen"</code>).
</p>
</li>
<li> <p><strong>labclust The labels</strong> of genotypes/environments within each cluster.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Mojena, R. 2015. Hierarchical grouping methods and stopping
rules: an evaluation. Comput. J. 20:359-363. <a href="https://doi.org/10.1093/comjnl/20.4.359">doi:10.1093/comjnl/20.4.359</a>
</p>
<p>Ouyang, Z., R.P. Mowers, A. Jensen, S. Wang, and S. Zheng. 1995.
Cluster analysis for genotype x environment interaction with unbalanced data. Crop Sci. 35:1300-1305.
<a href="https://doi.org/10.2135/cropsci1995.0011183X003500050008x">doi:10.2135/cropsci1995.0011183X003500050008x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

d1 &lt;- ge_cluster(data_ge, ENV, GEN, GY, nclust = 3)
plot(d1, nclust = 3)


</code></pre>

<hr>
<h2 id='ge_details'>Details for genotype-environment trials</h2><span id='topic+ge_details'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Provide details for genotype-environment trials
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_details(.data, env, gen, resp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_details_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="ge_details_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="ge_details_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_details_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also allowed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the following results for each variable:
</p>

<ul>
<li> <p><code>Mean</code>: The grand mean.
</p>
</li>
<li> <p><code>SE</code>: The standard error of the mean.
</p>
</li>
<li> <p><code>SD</code>: The standard deviation.
</p>
</li>
<li> <p><code>CV</code>: The coefficient of variation.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;Min,Max&#8288;</code>: The minimum and maximum value, indicating the genotype and environment of occurence.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;MinENV, MinGEN&#8288;</code>: The environment and genotype with the lower mean.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;MaxENV, MaxGEN&#8288;</code>: The environment and genotype with the higher mean.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
details &lt;- ge_details(data_ge2, ENV, GEN, everything())
print(details)

</code></pre>

<hr>
<h2 id='ge_effects'>Genotype-environment effects</h2><span id='topic+ge_effects'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This is a helper function that computes the genotype-environment effects,
i.e., the residual effect of the additive model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_effects(.data, env, gen, resp, type = "ge", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_effects_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="ge_effects_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments. The analysis of variance is computed for each level of this
factor.</p>
</td></tr>
<tr><td><code id="ge_effects_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_effects_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="ge_effects_+3A_type">type</code></td>
<td>
<p>The type of effect to compute. Defaults to <code>"ge"</code>, i.e.,
genotype-environment. To compute genotype plus genotype-environment effects
use <code>type = "gge"</code>.</p>
</td></tr>
<tr><td><code id="ge_effects_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where each element is the result for one variable that
contains a two-way table with genotypes in rows and environments in
columns.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
ge_eff &lt;- ge_effects(data_ge, ENV, GEN, GY)
gge_eff &lt;- ge_effects(data_ge, ENV, GEN, GY, type = "gge")
plot(ge_eff)


</code></pre>

<hr>
<h2 id='ge_factanal'>Stability analysis and environment stratification</h2><span id='topic+ge_factanal'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function computes the stability analysis and environmental stratification
using factor analysis as proposed by Murakami and Cruz (2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_factanal(.data, env, gen, rep, resp, mineval = 1, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_factanal_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments, Genotypes,
replication/block and response variable(s)</p>
</td></tr>
<tr><td><code id="ge_factanal_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="ge_factanal_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_factanal_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks</p>
</td></tr>
<tr><td><code id="ge_factanal_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="ge_factanal_+3A_mineval">mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td></tr>
<tr><td><code id="ge_factanal_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ge_factanal</code> with the following items:
</p>

<ul>
<li> <p><code>data</code>: The data used to compute the factor analysis.
</p>
</li>
<li> <p><code>cormat</code>: The correlation matrix among the environments.
</p>
</li>
<li> <p><code>PCA</code>: The eigenvalues and explained variance.
</p>
</li>
<li> <p><code>FA</code>: The factor analysis.
</p>
</li>
<li> <p><code>env_strat</code>: The environmental stratification.
</p>
</li>
<li> <p><code>KMO</code>: The result for the Kaiser-Meyer-Olkin test.
</p>
</li>
<li> <p><code>MSA</code>: The measure of sampling adequacy for individual variable.
</p>
</li>
<li> <p><code>communalities</code>: The communalities.
</p>
</li>
<li> <p><code>communalities.mean</code>: The communalities' mean.
</p>
</li>
<li> <p><code>initial.loadings</code>: The initial loadings.
</p>
</li>
<li> <p><code>finish.loadings</code>: The final loadings after varimax rotation.
</p>
</li>
<li> <p><code>canonical.loadings</code>: The canonical loadings.
</p>
</li>
<li> <p><code>scores.gen</code>: The scores for genotypes for the first and second factors.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto, <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Murakami, D.M.D., and C.D.C. Cruz. 2004. Proposal of
methodologies for environment stratification and analysis of genotype
adaptability. Crop Breed. Appl. Biotechnol. 4:7-11.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+superiority">superiority()</a></code>, <code><a href="#topic+ecovalence">ecovalence()</a></code>, <code><a href="#topic+ge_stats">ge_stats()</a></code>, <code><a href="#topic+ge_reg">ge_reg()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- ge_factanal(data_ge2,
                     env = ENV,
                     gen = GEN,
                     rep = REP,
                     resp = PH)



</code></pre>

<hr>
<h2 id='ge_means'>Genotype-environment means</h2><span id='topic+ge_means'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes genotype-environment interaction means
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_means(.data, env, gen, resp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_means_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, and the response variable(s).</p>
</td></tr>
<tr><td><code id="ge_means_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="ge_means_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_means_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables at once,
a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also allowed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where each element is the result for one variable containing:
</p>

<ul>
<li> <p><strong>ge_means</strong>: A two-way table with the means for genotypes (rows) and
environments (columns).
</p>
</li>
<li> <p><strong>gen_means</strong>: A tibble with the means for genotypes.
</p>
</li>
<li> <p><strong>env_means</strong>: A tibble with the means for environments.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
means_ge &lt;- ge_means(data_ge, ENV, GEN, resp = everything())

# Genotype-environment interaction means
get_model_data(means_ge)

# Environment means
get_model_data(means_ge, what = "env_means")

# Genotype means
get_model_data(means_ge, what = "gen_means")



</code></pre>

<hr>
<h2 id='ge_plot'>Graphical analysis of genotype-vs-environment interaction</h2><span id='topic+ge_plot'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function produces a line plot for a graphical interpretation of the
genotype-vs-environment interaction. By default, environments are in the x
axis whereas the genotypes are depicted by different lines. The y axis
contains the value of the selected variable. A heatmap can also be created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_plot(
  .data,
  env,
  gen,
  resp,
  type = 1,
  values = TRUE,
  text_col_pos = c("top", "bottom"),
  text_row_pos = c("left", "right"),
  average = TRUE,
  row_col = TRUE,
  row_col_type = c("average", "sum"),
  order_g = NULL,
  order_e = NULL,
  xlab = NULL,
  ylab = NULL,
  width_bar = 1.5,
  heigth_bar = 15,
  plot_theme = theme_metan(),
  colour = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_plot_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_resp">resp</code></td>
<td>
<p>The response variable.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_type">type</code></td>
<td>
<p>The type of plot <code>type = 1</code> for a heatmap or <code>type = 2</code>
for a line plot.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_values">values</code></td>
<td>
<p>Show the values in the plot? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_text_row_pos">text_row_pos</code>, <code id="ge_plot_+3A_text_col_pos">text_col_pos</code></td>
<td>
<p>The position of the text in the
rows and columns. The defaults show the text at left and top.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_average">average</code></td>
<td>
<p>Show the average values for environments and genotypes?
Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_row_col">row_col</code>, <code id="ge_plot_+3A_row_col_type">row_col_type</code></td>
<td>
<p>Shows row/column and defines what to show.
Defaults to 'average'.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_order_g">order_g</code>, <code id="ge_plot_+3A_order_e">order_e</code></td>
<td>
<p>A charactere vector indicating the order of the levels
for genotypes and environments, respectively. This can be used to change
the default ordering of rows and columns.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_xlab">xlab</code>, <code id="ge_plot_+3A_ylab">ylab</code></td>
<td>
<p>The labels for x and y axis, respectively.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_width_bar">width_bar</code>, <code id="ge_plot_+3A_heigth_bar">heigth_bar</code></td>
<td>
<p>The width and heigth of the legend bar,
respectively.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details,see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="ge_plot_+3A_colour">colour</code></td>
<td>
<p>Logical argument. If <code>FALSE</code> then the plot will not be
colored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
ge_plot(data_ge2, ENV, GEN, PH)
ge_plot(data_ge, ENV, GEN, GY, type = 2)

</code></pre>

<hr>
<h2 id='ge_polar'>Power Law Residuals as yield stability index
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></h2><span id='topic+ge_polar'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs a stability analysis based on the Power Law Residuals (POLAR)
statistics (Doring et al., 2015). POLAR is the residuals from the linear
regression of \(log(\sigma^2\)) against \(log(\mu\)) and can be
used as a measure of crop stability with lower stability (relative to all
samples with that mean yield) indicated by more positive POLAR values, and
higher stability (relative to all samples with that mean yield) indicated by
more negative POLAR values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_polar(.data, env, gen, resp, base = 10, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_polar_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes and response variable(s).</p>
</td></tr>
<tr><td><code id="ge_polar_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="ge_polar_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_polar_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="ge_polar_+3A_base">base</code></td>
<td>
<p>The base with respect to which logarithms are computed. Defaults
to <code>10</code>.</p>
</td></tr>
<tr><td><code id="ge_polar_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ge_acv</code>, which is a list containing the
results for each variable used in the argument <code>resp</code>. For each
variable, a tibble with the following columns is returned.
</p>

<ul>
<li> <p><strong>GEN</strong> the genotype's code.
</p>
</li>
<li> <p><strong>POLAR</strong> The Power Law Residuals
</p>
</li>
<li> <p><strong>POLAR_R</strong> The rank for the ACV value.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Doring, T.F., S. Knapp, and J.E. Cohen. 2015. Taylor's power law
and the stability of crop yields. F. Crop. Res. 183: 294-302.
<a href="https://doi.org/10.1016/j.fcr.2015.08.005">doi:10.1016/j.fcr.2015.08.005</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
out &lt;- ge_polar(data_ge2, ENV, GEN, c(EH, PH, EL, CD, ED, NKE))
gmd(out)


</code></pre>

<hr>
<h2 id='ge_reg'>Eberhart and Russell's regression model</h2><span id='topic+ge_reg'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Regression-based stability analysis using the Eberhart and Russell (1966) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_reg(.data, env, gen, rep, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_reg_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments, Genotypes,
replication/block and response variable(s)</p>
</td></tr>
<tr><td><code id="ge_reg_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="ge_reg_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_reg_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks</p>
</td></tr>
<tr><td><code id="ge_reg_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="ge_reg_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ge_reg</code> with the folloing items for each
variable:
</p>

<ul>
<li><p> data: The data with means for genotype and environment combinations and the
environment index
</p>
</li>
<li><p> anova: The analysis of variance for the regression model.
</p>
</li>
<li><p> regression: A data frame with the following columns: <code>GEN</code>, the genotypes;
<code>b0</code> and <code>b1</code> the intercept and slope of the regression, respectively;
<code>t(b1=1)</code> the calculated t-value; <code>pval_t</code> the p-value for the t test; <code>s2di</code>
the deviations from the regression (stability parameter); <code>F(s2di=0)</code> the
F-test for the deviations; <code>pval_f</code> the p-value for the F test; <code>RMSE</code> the
root-mean-square error; <code>R2</code> the determination coefficient of the regression.
</p>
</li>
<li><p> b0_variance: The variance of b0.
</p>
</li>
<li><p> b1_variance: The variance of b1.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto, <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Eberhart, S.A., and W.A. Russell. 1966. Stability parameters for comparing Varieties.
Crop Sci. 6:36-40. <a href="https://doi.org/10.2135/cropsci1966.0011183X000600010011x">doi:10.2135/cropsci1966.0011183X000600010011x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+superiority">superiority()</a></code>, <code><a href="#topic+ecovalence">ecovalence()</a></code>, <code><a href="#topic+ge_stats">ge_stats()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
reg &lt;- ge_reg(data_ge2,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = PH)
plot(reg)


</code></pre>

<hr>
<h2 id='ge_stats'>Parametric and non-parametric stability statistics</h2><span id='topic+ge_stats'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p><code>ge_stats()</code> computes parametric and non-parametric stability statistics
given a data set with environment, genotype, and block factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_stats(.data, env, gen, rep, resp, verbose = TRUE, prob = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_stats_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="ge_stats_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="ge_stats_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_stats_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="ge_stats_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="ge_stats_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
<tr><td><code id="ge_stats_+3A_prob">prob</code></td>
<td>
<p>The probability error assumed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the statistics and ranks for the following
stability indexes.
</p>

<ul>
<li> <p><code>"Y"</code> (Response variable),
</p>
</li>
<li> <p><code>"CV"</code> (coefficient of variation)
</p>
</li>
<li> <p><code>"ACV"</code> (adjusted coefficient of variation calling <code><a href="#topic+ge_acv">ge_acv()</a></code> internally)
</p>
</li>
<li> <p><code>POLAR</code> (Power Law Residuals, calling <code><a href="#topic+ge_polar">ge_polar()</a></code> internally)
</p>
</li>
<li> <p><code>"Var"</code> (Genotype's variance)
</p>
</li>
<li> <p><code>"Shukla"</code> (Shukla's variance, calling <code><a href="#topic+Shukla">Shukla()</a></code> internally)
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"Wi_g", "Wi_f", "Wi_u"&#8288;</code> (Annichiarrico's genotypic
confidence index for all, favorable and unfavorable environments,
respectively, calling <code><a href="#topic+Annicchiarico">Annicchiarico()</a></code> internally )
</p>
</li>
<li> <p><code>"Ecoval"</code> (Wricke's ecovalence, <code><a href="#topic+ecovalence">ecovalence()</a></code> internally)
</p>
</li>
<li> <p><code>"Sij"</code> (Deviations from the joint-regression analysis) and <code>"R2"</code>
(R-squared from the joint-regression analysis, calling <code><a href="#topic+ge_reg">ge_reg()</a></code>
internally)
</p>
</li>
<li> <p><code>"ASTAB"</code> (AMMI Based Stability Parameter), <code>"ASI"</code> (AMMI Stability
Index), <code>"ASV"</code> (AMMI-stability value), <code>"AVAMGE"</code> (Sum Across Environments
of Absolute Value of GEI Modelled by AMMI ), <code>"Da"</code> (Annicchiarico's D
Parameter values), <code>"Dz"</code> (Zhang's D Parameter), <code>"EV"</code> (Sums of the
Averages of the Squared Eigenvector Values), <code>"FA"</code> (Stability Measure
Based on Fitted AMMI Model), <code>"MASV"</code> (Modified AMMI Stability Value),
<code>"SIPC"</code> (Sums of the Absolute Value of the IPC Scores), <code>"Za"</code> (Absolute
Value of the Relative Contribution of IPCs to the Interaction), <code>"WAAS"</code>
(Weighted average of absolute scores), calling <code><a href="#topic+ammi_indexes">ammi_indexes()</a></code> internally
</p>
</li>
<li> <p><code>"HMGV"</code> (Harmonic mean of the genotypic value), <code>"RPGV"</code> (Relative
performance of the genotypic values), <code>"HMRPGV"</code> (Harmonic mean of the
relative performance of the genotypic values), by calling <code><a href="#topic+blup_indexes">blup_indexes()</a></code>
internally
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"Pi_a", "Pi_f", "Pi_u"&#8288;</code> (Superiority indexes for all, favorable and
unfavorable environments, respectively, calling <code><a href="#topic+superiority">superiority()</a></code> internally)
</p>
</li>
<li> <p><code>"Gai"</code> (Geometric adaptability index, calling <code><a href="#topic+gai">gai()</a></code> internally)
</p>
</li>
<li> <p><code>"S1"</code> (mean of the absolute rank differences of a genotype over the n
environments), <code>"S2"</code> (variance among the ranks over the k environments),
<code>"S3"</code> (sum of the absolute deviations), <code>"S6"</code> (relative sum of squares of
rank for each genotype), by calling <code><a href="#topic+Huehn">Huehn()</a></code> internally
</p>
</li>
<li> <p><code>"N1"</code>, <code>"N2"</code>, <code>"N3"</code>, <code>"N4"</code> (Thennarasu&quot;s statistics, calling
<code><a href="#topic+Thennarasu">Thennarasu()</a></code> internally ).
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>ge_stats</code> which is a list with one data
frame for each variable containing the computed indexes.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Annicchiarico, P. 1992. Cultivar adaptation and recommendation from alfalfa
trials in Northern Italy. Journal of Genetic &amp; Breeding, 46:269-278
</p>
<p>Ajay BC, Aravind J, Abdul Fiyaz R, Bera SK, Kumar N, Gangadhar K, Kona P
(2018). “Modified AMMI Stability Index (MASI) for stability analysis.”
ICAR-DGR Newsletter, 18, 4–5.
</p>
<p>Ajay BC, Aravind J, Fiyaz RA, Kumar N, Lal C, Gangadhar K, Kona P, Dagla MC,
Bera SK (2019). “Rectification of modified AMMI stability value (MASV).”
Indian Journal of Genetics and Plant Breeding (The), 79, 726–731.
https://www.isgpb.org/article/rectification-of-modified-ammi-stability-value-masv.
</p>
<p>Annicchiarico P (1997). “Joint regression vs AMMI analysis of
genotype-environment interactions for cereals in Italy.” Euphytica, 94(1),
53–62. <a href="https://doi.org/10.1023/A%3A1002954824178">doi:10.1023/A:1002954824178</a>
</p>
<p>Doring, T.F., and M. Reckling. 2018. Detecting global trends of
cereal yield stability by adjusting the coefficient of variation. Eur. J.
Agron. 99: 30-36. <a href="https://doi.org/10.1016/j.eja.2018.06.007">doi:10.1016/j.eja.2018.06.007</a>
</p>
<p>Doring, T.F., S. Knapp, and J.E. Cohen. 2015. Taylor's power law and the
stability of crop yields. F. Crop. Res. 183: 294-302.
<a href="https://doi.org/10.1016/j.fcr.2015.08.005">doi:10.1016/j.fcr.2015.08.005</a>
</p>
<p>Eberhart, S.A., and W.A. Russell. 1966. Stability parameters for
comparing Varieties. Crop Sci. 6:36-40.
<a href="https://doi.org/10.2135/cropsci1966.0011183X000600010011x">doi:10.2135/cropsci1966.0011183X000600010011x</a>
</p>
<p>Farshadfar E (2008) Incorporation of AMMI stability value and grain yield in
a single non-parametric index (GSI) in bread wheat. Pakistan J Biol Sci
11:1791–1796. <a href="https://doi.org/10.3923/pjbs.2008.1791.1796">doi:10.3923/pjbs.2008.1791.1796</a>
</p>
<p>Fox, P.N., B. Skovmand, B.K. Thompson, H.J. Braun, and R.
Cormier. 1990. Yield and adaptation of hexaploid spring triticale.
Euphytica 47:57-64.
<a href="https://doi.org/10.1007/BF00040364">doi:10.1007/BF00040364</a>.
</p>
<p>Huehn, V.M. 1979. Beitrage zur erfassung der phanotypischen
stabilitat. EDV Med. Biol. 10:112.
</p>
<p>Jambhulkar NN, Rath NC, Bose LK, Subudhi HN, Biswajit M, Lipi D, Meher J
(2017). “Stability analysis for grain yield in rice in demonstrations
conducted during rabi season in India.” Oryza, 54(2), 236–240.
<a href="https://doi.org/10.5958/2249-5266.2017.00030.3">doi:10.5958/2249-5266.2017.00030.3</a>
</p>
<p>Kang, M.S., and H.N. Pham. 1991. Simultaneous Selection for High
Yielding and Stable Crop Genotypes. Agron. J. 83:161.
<a href="https://doi.org/10.2134/agronj1991.00021962008300010037x">doi:10.2134/agronj1991.00021962008300010037x</a>
</p>
<p>Lin, C.S., and M.R. Binns. 1988. A superiority measure of cultivar
performance for cultivar x location data. Can. J. Plant Sci. 68:193-198.
<a href="https://doi.org/10.4141/cjps88-018">doi:10.4141/cjps88-018</a>
</p>
<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019a. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960. <a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Mohammadi, R., &amp; Amri, A. (2008). Comparison of parametric and non-parametric
methods for selecting stable and adapted durum wheat genotypes in variable
environments. Euphytica, 159(3), 419-432. <a href="https://doi.org/10.1007/s10681-007-9600-6">doi:10.1007/s10681-007-9600-6</a>
</p>
<p>Shukla, G.K. 1972. Some statistical aspects of partitioning
genotype-environmental components of variability. Heredity. 29:238-245.
<a href="https://doi.org/10.1038/hdy.1972.87">doi:10.1038/hdy.1972.87</a>
</p>
<p>Raju BMK (2002). “A study on AMMI model and its biplots.” Journal of the
Indian Society of Agricultural Statistics, 55(3), 297–322.
</p>
<p>Rao AR, Prabhakaran VT (2005). “Use of AMMI in simultaneous selection of
genotypes for yield and stability.” Journal of the Indian Society of
Agricultural Statistics, 59, 76–82.
</p>
<p>Sneller CH, Kilgore-Norquest L, Dombek D (1997). “Repeatability of yield
stability statistics in soybean.” Crop Science, 37(2), 383–390.
<a href="https://doi.org/10.2135/cropsci1997.0011183X003700020013x">doi:10.2135/cropsci1997.0011183X003700020013x</a>
</p>
<p>Thennarasu, K. 1995. On certain nonparametric procedures for
studying genotype x environment interactions and yield stability. Ph.D.
thesis. P.J. School, IARI, New Delhi, India.
</p>
<p>Wricke, G. 1965. Zur berechnung der okovalenz bei sommerweizen und hafer.
Z. Pflanzenzuchtg 52:127-138.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+acv">acv()</a></code>, <code><a href="#topic+ammi_indexes">ammi_indexes()</a></code>, <code><a href="#topic+ecovalence">ecovalence()</a></code>, <code><a href="#topic+Fox">Fox()</a></code>, <code><a href="#topic+gai">gai()</a></code>,
<code><a href="#topic+ge_reg">ge_reg()</a></code>, <code><a href="#topic+hmgv">hmgv()</a></code>, <code><a href="#topic+hmrpgv">hmrpgv()</a></code>, <code><a href="#topic+rpgv">rpgv()</a></code>, <code><a href="#topic+Huehn">Huehn()</a></code>, <code><a href="#topic+ge_polar">ge_polar()</a></code>,
<code><a href="#topic+Shukla">Shukla()</a></code>, <code><a href="#topic+superiority">superiority()</a></code>, <code><a href="#topic+Thennarasu">Thennarasu()</a></code>, <code><a href="#topic+waas">waas()</a></code>, <code><a href="#topic+waasb">waasb()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- ge_stats(data_ge, ENV, GEN, REP, GY)
get_model_data(model, "stats")



</code></pre>

<hr>
<h2 id='ge_winners'>Genotype-environment winners</h2><span id='topic+ge_winners'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes the ranking for genotypes within environments and return the winners.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ge_winners(.data, env, gen, resp, type = "winners", better = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ge_winners_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, and the response variable(s).</p>
</td></tr>
<tr><td><code id="ge_winners_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="ge_winners_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="ge_winners_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also allowed.</p>
</td></tr>
<tr><td><code id="ge_winners_+3A_type">type</code></td>
<td>
<p>The type of results. Defaults to <code>"winners"</code> (default),
i.e., a two-way table with the winner genotype in each environment. If
<code>type = "ranks"</code> return the genotype ranking within each environment.</p>
</td></tr>
<tr><td><code id="ge_winners_+3A_better">better</code></td>
<td>
<p>A vector of the same length of the number of variables to rank
the genotypes according to the response variable. Each element of the
vector must be one of the <code>'h'</code> or <code>'l'</code>. If <code>'h'</code> is used
(default), the genotypes are ranked from maximum to minimum. If <code>'l'</code>
is used then the are ranked from minimum to maximum. Use a comma-separated
vector of names. For example, <code>better = c("h, h, h, h, l")</code>, for
ranking the fifth variable from minimum to maximum.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with two-way table with the winner genotype in each
environment (default) or the genotype ranking for each environment (if
<code>type = "ranks"</code>).
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
ge_winners(data_ge, ENV, GEN, resp = everything())

# Assuming that for 'GY' lower values are better.
ge_winners(data_ge, ENV, GEN,
           resp = everything(),
           better = c("l, h"))

# Show the genotype ranking for each environment
ge_winners(data_ge, ENV, GEN,
           resp = everything(),
           type = "ranks")


</code></pre>

<hr>
<h2 id='get_corvars'>Generate normal, correlated variables</h2><span id='topic+get_corvars'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Given the mean and desired correlations, generate normal, correlated
variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_corvars(n = 10, mu, sigma, tol = 1e-06, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_corvars_+3A_n">n</code></td>
<td>
<p>The number of samples required.</p>
</td></tr>
<tr><td><code id="get_corvars_+3A_mu">mu</code></td>
<td>
<p>A vector with the means for the variables.</p>
</td></tr>
<tr><td><code id="get_corvars_+3A_sigma">sigma</code></td>
<td>
<p>A symmetric, positive-definite matrix with the (co)variance or
correlation matrix of the variables.</p>
</td></tr>
<tr><td><code id="get_corvars_+3A_tol">tol</code></td>
<td>
<p>Tolerance (relative to largest variance) for numerical lack of
positive-definiteness in sigma.</p>
</td></tr>
<tr><td><code id="get_corvars_+3A_seed">seed</code></td>
<td>
<p>An integer value interpreted as seed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing the simulated data.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sigma &lt;- matrix(c(1,  .3,  0,
                  .3,   1, .9,
                  0,   .9,  1),3,3)
mu &lt;- c(6,50,5)

df &lt;- get_corvars(n = 10000, mu = mu, sigma = sigma, seed = 101010)
mean_by(df)
cor(df)

</code></pre>

<hr>
<h2 id='get_covmat'>Generate a covariance matrix</h2><span id='topic+get_covmat'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Given the variances and desired correlations, generate a covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_covmat(cormat, var)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_covmat_+3A_cormat">cormat</code></td>
<td>
<p>A symmetric matrix with desired correlations.</p>
</td></tr>
<tr><td><code id="get_covmat_+3A_var">var</code></td>
<td>
<p>A numeric vector with variances. It must have length equal to the
number of elements in the diagonal of <code>cormat</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A (co)variance matrix
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cormat &lt;-
matrix(c(1,  0.9, -0.4,
         0.9,  1,  0.6,
        -0.4, 0.6, 1),
      nrow = 3,
      ncol = 3)
get_covmat(cormat, var =  c(16, 25, 9))


</code></pre>

<hr>
<h2 id='get_dist'>Get a distance matrix</h2><span id='topic+get_dist'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Get the distance matrices from objects fitted with the function
<code><a href="#topic+clustering">clustering()</a></code>. This is especially useful to get distance matrices
from several objects to be further analyzed using <code><a href="#topic+pairs_mantel">pairs_mantel()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dist(..., digits = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_dist_+3A_...">...</code></td>
<td>
<p>Object(s) of class <code>clustering</code>.]</p>
</td></tr>
<tr><td><code id="get_dist_+3A_digits">digits</code></td>
<td>
<p>The number of significant figures. Defaults to <code>2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>clustering</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
d &lt;- data_ge2 %&gt;%
      mean_by(GEN) %&gt;%
      column_to_rownames("GEN") %&gt;%
      clustering()
get_dist(d)


</code></pre>

<hr>
<h2 id='get_model_data'>Get data from a model easily</h2><span id='topic+get_model_data'></span><span id='topic+gmd'></span><span id='topic+sel_gen'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_model_data(x, what = NULL, type = "GEN", verbose = TRUE)

gmd(x, what = NULL, type = "GEN", verbose = TRUE)

sel_gen(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_model_data_+3A_x">x</code></td>
<td>
<p>An object created with the functions <code><a href="#topic+ammi_indexes">ammi_indexes()</a></code>,
<code><a href="#topic+anova_ind">anova_ind()</a></code>, <code><a href="#topic+anova_joint">anova_joint()</a></code>, <code><a href="#topic+can_corr">can_corr()</a></code> <code><a href="#topic+ecovalence">ecovalence()</a></code>,  <code><a href="#topic+Fox">Fox()</a></code>,
<code><a href="#topic+gai">gai()</a></code>, <code><a href="#topic+gamem">gamem()</a></code>,<code><a href="#topic+gafem">gafem()</a></code>, <code><a href="#topic+ge_acv">ge_acv()</a></code>, <code><a href="#topic+ge_means">ge_means()</a></code>, <code><a href="#topic+ge_reg">ge_reg()</a></code>,
<code><a href="#topic+gytb">gytb()</a></code>, <code><a href="#topic+mgidi">mgidi()</a></code>, <code><a href="#topic+performs_ammi">performs_ammi()</a></code>, <code><a href="#topic+blup_indexes">blup_indexes()</a></code>, <code><a href="#topic+Shukla">Shukla()</a></code>,
<code><a href="#topic+superiority">superiority()</a></code>, <code><a href="#topic+waas">waas()</a></code> or <code><a href="#topic+waasb">waasb()</a></code>.</p>
</td></tr>
<tr><td><code id="get_model_data_+3A_what">what</code></td>
<td>
<p>What should be captured from the model. See more in section
<strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="get_model_data_+3A_type">type</code></td>
<td>
<p>Chose if the statistics must be show by genotype (<code>type = "GEN"</code>, default) or environment (<code>TYPE = "ENV"</code>), when possible.</p>
</td></tr>
<tr><td><code id="get_model_data_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>get_model_data()</code> Easily get data from some objects generated in the
<strong>metan</strong> package such as the WAASB and WAASBY indexes  (Olivoto et al.,
2019a, 2019b) BLUPs, variance components, details of AMMI models and
AMMI-based stability statistics.
</p>
</li>
<li> <p><code>gmd()</code> Is a shortcut to <code>get_model_data</code>.
</p>
</li>
<li> <p><code>sel_gen()</code> Extracts the selected genotypes by a given index.
</p>
</li></ul>

<p>Bellow are listed the options allowed in the argument <code>what</code> depending
on the class of the object
</p>
<p><strong>Objects of class <code>ammi_indexes</code>:</strong>
</p>

<ul>
<li> <p><code>"ASV"</code> AMMI stability value.
</p>
</li>
<li> <p><code>"EV"</code> Averages of the squared eigenvector values.
</p>
</li>
<li> <p><code>"SIPC"</code> Sums of the absolute value of the IPCA scores.
</p>
</li>
<li> <p><code>"WAAS"</code> Weighted average of absolute scores (default).
</p>
</li>
<li> <p><code>"ZA"</code> Absolute value of the relative contribution of IPCAs to the
interaction.
</p>
</li></ul>

<p><strong>Objects of class <code>anova_ind</code>:</strong>
</p>

<ul>
<li> <p><code>"MEAN"</code>The mean value of the variable
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"DFG", "DFB", "DFCR", "DFIB_R", "DFE"&#8288;</code>. The degree of freedom for
genotypes, blocks (randomized complete block design), complete replicates,
incomplete blocks within replicates (alpha-lattice design), and error,
respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"MSG", "FCG", "PFG"&#8288;</code> The mean square, F-calculated and P-values for
genotype effect, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"MSB", "FCB", "PFB"&#8288;</code> The mean square, F-calculated and P-values for
block effect in randomized complete block design.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"MSCR", "FCR", "PFCR"&#8288;</code> The mean square, F-calculated and P-values for
complete replicates in alpha lattice design.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"MSIB_R", "FCIB_R", "PFIB_R"&#8288;</code> The mean square, F-calculated and
P-values for incomplete blocks within complete replicates, respectively (for
alpha lattice design only).
</p>
</li>
<li> <p><code>"MSE"</code> The mean square of error.
</p>
</li>
<li> <p><code>"CV"</code> The coefficient of variation.
</p>
</li>
<li> <p><code>"h2"</code> The broad-sence heritability
</p>
</li>
<li> <p><code>"AS"</code> The accucary of selection (square root of h2).
</p>
</li>
<li> <p><code>"FMAX"</code> The Hartley's test (the ratio of the largest MSE to the smallest
MSE).
</p>
</li></ul>

<p><strong>Objects of class <code>anova_joint</code> or <code>gafem</code>:</strong>
</p>

<ul>
<li> <p><code>"Y"</code> The observed values.
</p>
</li>
<li> <p><code>"h2"</code> The broad-sense heritability.
</p>
</li>
<li> <p><code>"Sum Sq"</code> Sum of squares.
</p>
</li>
<li> <p><code>"Mean Sq"</code> Mean Squares.
</p>
</li>
<li> <p><code>"F value"</code> F-values.
</p>
</li>
<li> <p><code>"Pr(&gt;F)"</code> P-values.
</p>
</li>
<li> <p><code>".fitted"</code> Fitted values (default).
</p>
</li>
<li> <p><code>".resid"</code> Residuals.
</p>
</li>
<li> <p><code>".stdresid"</code> Standardized residuals.
</p>
</li>
<li> <p><code>".se.fit"</code> Standard errors of the fitted values.
</p>
</li>
<li> <p><code>"details"</code> Details.
</p>
</li></ul>

<p><strong>Objects of class <code>Annicchiarico</code> and <code>Schmildt</code>:</strong>
</p>

<ul>
<li> <p><code>"Sem_rp"</code> The standard error of the relative mean performance (Schmildt).
</p>
</li>
<li> <p><code>"Mean_rp"</code> The relative performance of the mean.
</p>
</li>
<li> <p><code>"rank"</code> The rank for genotypic confidence index.
</p>
</li>
<li> <p><code>"Wi"</code> The genotypic confidence index.
</p>
</li></ul>

<p><strong>Objects of class <code>can_corr</code>:</strong>
</p>

<ul>
<li> <p><code>"coefs"</code> The canonical coefficients (default).
</p>
</li>
<li> <p><code>"loads"</code> The canonical loadings.
</p>
</li>
<li> <p><code>"crossloads"</code> The canonical cross-loadings.
</p>
</li>
<li> <p><code>"canonical"</code> The canonical correlations and hypothesis testing.
</p>
</li></ul>

<p><strong>Objects of class <code>colindiag</code>:</strong>
</p>

<ul>
<li> <p><code>"cormat"</code> The correlation matrix betwen predictors.
</p>
</li>
<li> <p><code>"corlist"</code> The correlations in a 'long' format
</p>
</li>
<li> <p><code>"evalevet"</code> The eigenvalue with associated eigenvectors
</p>
</li>
<li> <p><code>"VIF"</code> The Variance Inflation Factor
</p>
</li>
<li> <p><code>"indicators"</code> The colinearity indicators
</p>
</li></ul>

<p><strong>Objects of class <code>ecovalence</code>:</strong>
</p>

<ul>
<li> <p><code>"Ecoval"</code> Ecovalence value (default).
</p>
</li>
<li> <p><code>"Ecov_perc"</code> Ecovalence in percentage value.
</p>
</li>
<li> <p><code>"rank"</code> Rank for ecovalence.
</p>
</li></ul>

<p><strong>Objects of class <code>fai_blup</code>:</strong> See the <strong>Value</strong> section of
<code><a href="#topic+fai_blup">fai_blup()</a></code> to see valid options for <code>what</code> argument.
</p>
<p><strong>Objects of class <code>ge_acv</code>:</strong>
</p>

<ul>
<li> <p><code>"ACV"</code> The adjusted coefficient of variation (default).
</p>
</li>
<li> <p><code>"ACV_R"</code> The rank for adjusted coefficient of variation.
</p>
</li></ul>

<p><strong>Objects of class <code>ge_polar</code>:</strong>
</p>

<ul>
<li> <p><code>"POLAR"</code> The Power Law Residuals (default).
</p>
</li>
<li> <p><code>"POLAR_R"</code> The rank for Power Law Residuals.
</p>
</li></ul>

<p><strong>Objects of class <code>ge_reg</code>:</strong>
</p>

<ul>
<li> <p><code>GEN</code>: the genotypes.
</p>
</li>
<li> <p><code>b0</code> and <code>b1</code> (default): the intercept and slope of the regression,
respectively.
</p>
</li>
<li> <p><code>t(b1=1)</code>: the calculated t-value
</p>
</li>
<li> <p><code>pval_t</code>: the p-value for the t test.
</p>
</li>
<li> <p><code>s2di</code> the deviations from the regression (stability parameter).
</p>
</li>
<li> <p><code>F(s2di=0)</code>: the F-test for the deviations.
</p>
</li>
<li> <p><code>pval_f</code>: the p-value for the F test;
</p>
</li>
<li> <p><code>RMSE</code> the root-mean-square error.
</p>
</li>
<li> <p><code>R2</code> the determination coefficient of the regression.
</p>
</li></ul>

<p><strong>Objects of class <code>ge_effects</code>:</strong>
</p>

<ul>
<li><p> For objects of class <code>ge_effects</code> no argument <code>what</code> is required.
</p>
</li></ul>

<p><strong>Objects of class <code>ge_means</code>:</strong>
</p>

<ul>
<li> <p><code>"ge_means"</code> Genotype-environment interaction means (default).
</p>
</li>
<li> <p><code>"env_means"</code> Environment means.
</p>
</li>
<li> <p><code>"gen_means"</code> Genotype means.
</p>
</li></ul>

<p><strong>Objects of class <code>gge</code>:</strong>
</p>

<ul>
<li> <p><code>"scores"</code> The scores for genotypes and environments for all the
analyzed traits (default).
</p>
</li>
<li> <p><code>"exp_var"</code> The eigenvalues and explained variance.
</p>
</li>
<li> <p><code>"projection"</code> The projection of each genotype in the AEC coordinates in
the stability GGE plot
</p>
</li></ul>

<p><strong>Objects of class <code>gytb</code>:</strong>
</p>

<ul>
<li> <p><code>"gyt"</code> Genotype by yield*trait table (Default).
</p>
</li>
<li> <p><code>"stand_gyt"</code> The standardized (zero mean and unit variance) Genotype by yield*trait table.
</p>
</li>
<li> <p><code>"si"</code> The superiority index (sum standardized value across all yield*trait combinations).
</p>
</li></ul>

<p><strong>Objects of class <code>mgidi</code>:</strong> See the <strong>Value</strong> section of
<code><a href="#topic+mgidi">mgidi()</a></code> to see valid options for <code>what</code> argument.
</p>
<p><strong>Objects of class <code>mtsi</code>:</strong> See the <strong>Value</strong> section of
<code><a href="#topic+mtsi">mtsi()</a></code> to see valid options for <code>what</code> argument.
</p>
<p>**Objects of class <code>path_coeff</code>
</p>

<ul>
<li> <p><code>"coef"</code> Path coefficients
</p>
</li>
<li> <p><code>"eigenval"</code> Eigenvalues and eigenvectors.
</p>
</li>
<li> <p><code>"vif "</code> Variance Inflation Factor
</p>
</li></ul>

<p>**Objects of class <code>path_coeff_seq</code>
</p>

<ul>
<li> <p><code>"resp_fc"</code> Coefficients of primary predictors and response
</p>
</li>
<li> <p><code>"resp_sc"</code> Coefficients of secondary predictors and response
</p>
</li>
<li> <p><code>"resp_sc2"</code> contribution to the total effects through primary traits
</p>
</li>
<li> <p><code>"fc_sc_coef"</code> Coefficients of secondary predictors and primary predictors.
</p>
</li></ul>

<p><strong>Objects of class <code>Shukla</code>:</strong>
</p>

<ul>
<li> <p><code>"rMean"</code> Rank for the mean.
</p>
</li>
<li> <p><code>"ShuklaVar"</code> Shukla's stablity variance (default).
</p>
</li>
<li> <p><code>"rShukaVar"</code> Rank for Shukla's stablity variance.
</p>
</li>
<li> <p><code>"ssiShukaVar"</code> Simultaneous selection index.
</p>
</li></ul>

<p><strong>Objects of class <code>sh</code>:</strong> See the <strong>Value</strong> section of
<code><a href="#topic+Smith_Hazel">Smith_Hazel()</a></code> to see valid options for <code>what</code> argument.
</p>
<p><strong>Objects of class <code>Fox</code>:</strong>
</p>

<ul>
<li> <p><code>"TOP"</code> The proportion of locations at which the genotype occurred in
the top third (default).
</p>
</li></ul>

<p><strong>Objects of class <code>gai</code>:</strong>
</p>

<ul>
<li> <p><code>"GAI"</code> The geometric adaptability index (default).
</p>
</li>
<li> <p><code>"GAI_R"</code> The rank for the GAI values.
</p>
</li></ul>

<p><strong>Objects of class <code>superiority</code>:</strong>
</p>

<ul>
<li> <p><code>"Pi_a"</code> The superiority measure for all environments (default).
</p>
</li>
<li> <p><code>"R_a"</code> The rank for Pi_a.
</p>
</li>
<li> <p><code>"Pi_f"</code> The superiority measure for favorable environments.
</p>
</li>
<li> <p><code>"R_f"</code> The rank for Pi_f.
</p>
</li>
<li> <p><code>"Pi_u"</code> The superiority measure for unfavorable environments.
</p>
</li>
<li> <p><code>"R_u"</code> The rank for Pi_u.
</p>
</li></ul>

<p><strong>Objects of class <code>Huehn</code>:</strong>
</p>

<ul>
<li> <p><code>"S1"</code> Mean of the absolute rank differences of a genotype over the n
environments (default).
</p>
</li>
<li> <p><code>"S2"</code> variance among the ranks over the k environments.
</p>
</li>
<li> <p><code>"S3"</code> Sum of the absolute deviations.
</p>
</li>
<li> <p><code>"S6"</code> Relative sum of squares of rank for each genotype.
</p>
</li>
<li> <p><code>"S1_R"</code>, <code>"S2_R"</code>, <code>"S3_R"</code>, and  <code>"S6_R"</code>, the ranks
for S1, S2, S3, and S6, respectively.
</p>
</li></ul>

<p><strong>Objects of class <code>Thennarasu</code>:</strong>
</p>

<ul>
<li> <p><code>"N1"</code> First statistic (default).
</p>
</li>
<li> <p><code>"N2"</code> Second statistic.
</p>
</li>
<li> <p><code>"N3"</code> Third statistic.
</p>
</li>
<li> <p><code>"N4"</code> Fourth statistic.
</p>
</li>
<li> <p><code>"N1_R"</code>, <code>"N2_R"</code>, <code>"N3_R"</code>, and <code>"N4_R"</code>, The ranks
for the statistics.
</p>
</li></ul>

<p><strong>Objects of class <code>performs_ammi</code>:</strong>
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;"PC1", "PC2", ..., "PCn"&#8288;</code> The values for the nth interaction
principal component axis.
</p>
</li>
<li> <p><code>"ipca_ss"</code> Sum of square for each IPCA.
</p>
</li>
<li> <p><code>"ipca_ms"</code> Mean square for each IPCA.
</p>
</li>
<li> <p><code>"ipca_fval"</code> F value for each IPCA.
</p>
</li>
<li> <p><code>"ipca_pval"</code> P-value for for each IPCA.
</p>
</li>
<li> <p><code>"ipca_expl"</code>  Explained sum of square for each IPCA (default).
</p>
</li>
<li> <p><code>"ipca_accum"</code> Accumulated explained sum of square.
</p>
</li></ul>

<p><strong>Objects of class <code>waas</code>, <code>waas_means</code>, and <code>waasb</code>:</strong>
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;"PC1", "PC2", ..., "PCn"&#8288;</code> The values for the nth interaction
principal component axis.
</p>
</li>
<li> <p><code>"WAASB"</code>  The weighted average of the absolute scores (default for
objects of class <code>waas</code>).
</p>
</li>
<li> <p><code>"PctResp"</code> The rescaled values of the response variable.
</p>
</li>
<li> <p><code>"PctWAASB"</code> The rescaled values of the WAASB.
</p>
</li>
<li> <p><code>"wResp"</code> The weight for the response variable.
</p>
</li>
<li> <p><code>"wWAASB"</code> The weight for the stability.
</p>
</li>
<li> <p><code>"OrResp"</code> The ranking regarding the response variable.
</p>
</li>
<li> <p><code>"OrWAASB"</code> The ranking regarding the WAASB.
</p>
</li>
<li> <p><code>"OrPC1"</code> The ranking regarding the first principal component axix.
</p>
</li>
<li> <p><code>"WAASBY"</code> The superiority index WAASBY.
</p>
</li>
<li> <p><code>"OrWAASBY"</code> The ranking regarding the superiority index.
</p>
</li></ul>

<p><strong>Objects of class <code>gamem</code> and <code>waasb</code>:</strong>
</p>

<ul>
<li> <p><code>"blupge"</code> Best Linear Unbiased Prediction for genotype-environment
interaction (mixed-effect model, class <code>waasb</code>).
</p>
</li>
<li> <p><code>"blupg"</code> Best Linear Unbiased Prediction for genotype effect.
</p>
</li>
<li> <p><code>"bluege"</code> Best Linear Unbiased Estimation for genotype-environment
interaction (fixed-effect model, class <code>waasb</code>).
</p>
</li>
<li> <p><code>"blueg"</code> Best Linear Unbiased Estimation for genotype effect (fixed
model).
</p>
</li>
<li> <p><code>"data"</code> The data used.
</p>
</li>
<li> <p><code>"details"</code> The details of the trial.
</p>
</li>
<li> <p><code>"genpar"</code> Genetic parameters (default).
</p>
</li>
<li> <p><code>"gcov"</code> The genotypic variance-covariance matrix.
</p>
</li>
<li> <p><code>"pcov"</code> The phenotypic variance-covariance matrix.
</p>
</li>
<li> <p><code>"gcor"</code> The genotypic correlation matrix.
</p>
</li>
<li> <p><code>"pcor"</code> The phenotypic correlation matrix.
</p>
</li>
<li> <p><code>"h2"</code> The broad-sense heritability.
</p>
</li>
<li> <p><code>"lrt"</code> The likelihood-ratio test for random effects.
</p>
</li>
<li> <p><code>"vcomp"</code> The variance components for random effects.
</p>
</li>
<li> <p><code>"ranef"</code> Random effects.
</p>
</li></ul>

<p><strong>Objects of class <code>blup_ind</code></strong>
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;"HMGV","HMGV_R"&#8288;</code> For harmonic mean of genotypic values or its ranks.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"RPGV", RPGV_Y"&#8288;</code> For relative performance of genotypic values or its
ranks.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"HMRPGV", "HMRPGV_R"&#8288;</code> For harmonic mean of relative performance of
genotypic values or its ranks.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"WAASB", "WAASB_R"&#8288;</code> For the weighted average of absolute scores from the
singular or its ranks. value decomposition of the BLUPs for GxE interaction
or its ranks.
</p>
</li></ul>



<h3>Value</h3>

<p>A tibble showing the values of the variable chosen in argument
<code>what</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Annicchiarico, P. 1992. Cultivar adaptation and recommendation from alfalfa
trials in Northern Italy. J. Genet. Breed. 46:269-278.
</p>
<p>Dias, P.C., A. Xavier, M.D.V. de Resende, M.H.P. Barbosa, F.A. Biernaski,
R.A. Estopa. 2018. Genetic evaluation of Pinus taeda clones from somatic
embryogenesis and their genotype x environment interaction. Crop Breed. Appl.
Biotechnol. 18:55-64.
<a href="https://doi.org/10.1590/1984-70332018v18n1a8">doi:10.1590/1984-70332018v18n1a8</a>
</p>
<p>Azevedo Peixoto, L. de, P.E. Teodoro, L.A. Silva, E.V. Rodrigues, B.G.
Laviola, and L.L. Bhering. 2018. Jatropha half-sib family selection with high
adaptability and genotypic stability. PLoS One 13:e0199880.
<a href="https://doi.org/10.1371/journal.pone.0199880">doi:10.1371/journal.pone.0199880</a>
</p>
<p>Eberhart, S.A., and W.A. Russell. 1966. Stability parameters for comparing
Varieties. Crop Sci. 6:36-40.
<a href="https://doi.org/10.2135/cropsci1966.0011183X000600010011x">doi:10.2135/cropsci1966.0011183X000600010011x</a>
</p>
<p>Fox, P.N., B. Skovmand, B.K. Thompson, H.J. Braun, and R. Cormier. 1990.
Yield and adaptation of hexaploid spring triticale. Euphytica 47:57-64.
<a href="https://doi.org/10.1007/BF00040364">doi:10.1007/BF00040364</a>
</p>
<p>Huehn, V.M. 1979. Beitrage zur erfassung der phanotypischen stabilitat. EDV
Med. Biol. 10:112.
</p>
<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019a. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, B.G. Sari, and M.I. Diel.
2019b. Mean performance and stability in multi-environment trials II:
Selection based on multiple traits. Agron. J. 111:2961-2969.
<a href="https://doi.org/10.2134/agronj2019.03.0221">doi:10.2134/agronj2019.03.0221</a>
</p>
<p>Purchase, J.L., H. Hatting, and C.S. van Deventer. 2000.
Genotype vs environment interaction of winter wheat (Triticum aestivum L.)
in South Africa: II. Stability analysis of yield performance. South African
J. Plant Soil 17:101-107.
<a href="https://doi.org/10.1080/02571862.2000.10634878">doi:10.1080/02571862.2000.10634878</a>
</p>
<p>Resende MDV (2007) Matematica e estatistica na analise de experimentos e no
melhoramento genetico. Embrapa Florestas, Colombo
</p>
<p>Sneller, C.H., L. Kilgore-Norquest, and D. Dombek. 1997. Repeatability of
Yield Stability Statistics in Soybean. Crop Sci. 37:383-390.
<a href="https://doi.org/10.2135/cropsci1997.0011183X003700020013x">doi:10.2135/cropsci1997.0011183X003700020013x</a>
</p>
<p>Mohammadi, R., &amp; Amri, A. (2008). Comparison of parametric and non-parametric
methods for selecting stable and adapted durum wheat genotypes in variable
environments. Euphytica, 159(3), 419-432.
<a href="https://doi.org/10.1007/s10681-007-9600-6">doi:10.1007/s10681-007-9600-6</a>
</p>
<p>Wricke, G. 1965. Zur berechnung der okovalenz bei sommerweizen und hafer. Z.
Pflanzenzuchtg 52:127-138.
</p>
<p>Zali, H., E. Farshadfar, S.H. Sabaghpour, and R. Karimizadeh. 2012.
Evaluation of genotype vs environment interaction in chickpea using measures
of stability from AMMI model. Ann. Biol. Res. 3:3126-3136.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ammi_indexes">ammi_indexes()</a></code>, <code><a href="#topic+anova_ind">anova_ind()</a></code>, <code><a href="#topic+anova_joint">anova_joint()</a></code>, <code><a href="#topic+ecovalence">ecovalence()</a></code>,
<code><a href="#topic+Fox">Fox()</a></code>, <code><a href="#topic+gai">gai()</a></code>, <code><a href="#topic+gamem">gamem()</a></code>, <code><a href="#topic+gafem">gafem()</a></code>, <code><a href="#topic+ge_acv">ge_acv()</a></code>, <code><a href="#topic+ge_polar">ge_polar()</a></code>
<code><a href="#topic+ge_means">ge_means()</a></code>, <code><a href="#topic+ge_reg">ge_reg()</a></code>, <code><a href="#topic+mgidi">mgidi()</a></code>, <code><a href="#topic+mtsi">mtsi()</a></code>, <code><a href="#topic+mps">mps()</a></code>, <code><a href="#topic+mtmps">mtmps()</a></code>,
<code><a href="#topic+performs_ammi">performs_ammi()</a></code>, <code><a href="#topic+blup_indexes">blup_indexes()</a></code>, <code><a href="#topic+Shukla">Shukla()</a></code>, <code><a href="#topic+superiority">superiority()</a></code>, <code><a href="#topic+waas">waas()</a></code>,
<code><a href="#topic+waasb">waasb()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)


#################### WAASB index #####################
# Fitting the WAAS index
AMMI &lt;- waasb(data_ge2,
              env = ENV,
              gen = GEN,
              rep = REP,
              resp = c(PH, ED, TKW, NKR))

# Getting the weighted average of absolute scores
gmd(AMMI, what = "WAASB")


#################### BLUP model #####################
# Fitting a mixed-effect model
# Genotype and interaction as random
blup &lt;- gamem_met(data_ge2,
                  env = ENV,
                  gen = GEN,
                  rep = REP,
                  resp = c(PH, ED))

# Getting p-values for likelihood-ratio test
gmd(blup, what = "lrt")

# Getting the variance components
gmd(blup, what = "vcomp")



</code></pre>

<hr>
<h2 id='gge'>Genotype plus genotype-by-environment model</h2><span id='topic+gge'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Produces genotype plus genotype-by-environment model based on a multi-environment
trial dataset containing at least the columns for genotypes, environments and one
response variable or a two-way table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gge(
  .data,
  env,
  gen,
  resp,
  centering = "environment",
  scaling = "none",
  svp = "environment",
  by = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gge_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments, Genotypes
and the response variable(s).</p>
</td></tr>
<tr><td><code id="gge_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the environments.</p>
</td></tr>
<tr><td><code id="gge_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="gge_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also supported.</p>
</td></tr>
<tr><td><code id="gge_+3A_centering">centering</code></td>
<td>
<p>The centering method. Must be one of the <code>'none | 0'</code>, for no
centering; <code>'global | 1'</code>, for global centered (E+G+GE); <code>'environment | 2'</code> (default),
for environment-centered (G+GE); or <code>'double | 3'</code>, for double centered (GE).
A biplot cannot be produced with models produced without centering.</p>
</td></tr>
<tr><td><code id="gge_+3A_scaling">scaling</code></td>
<td>
<p>The scaling method. Must be one of the <code>'none | 0'</code> (default), for no scaling;
or <code>'sd | 1'</code>, where each value is divided by the standard deviation of its corresponding
environment (column). This will put all environments roughly he same rang of values.</p>
</td></tr>
<tr><td><code id="gge_+3A_svp">svp</code></td>
<td>
<p>The method for singular value partitioning. Must be one of the <code>'genotype | 1'</code>,
(The singular value is entirely partitioned into the genotype eigenvectors, also called row
metric preserving); <code>'environment | 2'</code>, default, (The singular value is entirely partitioned into the
environment eigenvectors, also called column metric preserving); or <code>'symmetrical | 3'</code>
(The singular value is symmetrically partitioned into the genotype and the environment eigenvectors
This SVP is most often used in AMMI analysis and other biplot analysis, but it is not ideal for
visualizing either the relationship among genotypes or that among the environments).</p>
</td></tr>
<tr><td><code id="gge_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.This is especially useful, for example,
when the researcher want to produce GGE biplots for each level of a
categorical variable. In this case, an object of class gge_grouped is
returned.</p>
</td></tr>
<tr><td><code id="gge_+3A_...">...</code></td>
<td>
<p>Arguments passed to the function
<code><a href="#topic+impute_missing_val">impute_missing_val()</a></code> for imputation of missing values in case
of unbalanced data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list of class <code>gge</code> containing the following objects
</p>

<ul>
<li> <p><strong>coordgen</strong> The coordinates for genotypes for all components.
</p>
</li>
<li> <p><strong>coordenv</strong> The coordinates for environments for all components.
</p>
</li>
<li> <p><strong>eigenvalues</strong> The vector of eigenvalues.
</p>
</li>
<li> <p><strong>totalvar</strong> The overall variance.
</p>
</li>
<li> <p><strong>labelgen</strong> The name of the genotypes.
</p>
</li>
<li> <p><strong>labelenv</strong> The names of the environments.
</p>
</li>
<li> <p><strong>labelaxes</strong> The axes labels.
</p>
</li>
<li> <p><strong>ge_mat</strong> The data used to produce the model (scaled and centered).
</p>
</li>
<li> <p><strong>centering</strong> The centering method.
</p>
</li>
<li> <p><strong>scaling</strong> The scaling method.
</p>
</li>
<li> <p><strong>svp</strong> The singular value partitioning method.
</p>
</li>
<li> <p><strong>d</strong> The factor used to generate in which the ranges of genotypes and environments
are comparable when singular value partitioning is set to 'genotype' or 'environment'.
</p>
</li>
<li> <p><strong>grand_mean</strong> The grand mean of the trial.
</p>
</li>
<li> <p><strong>mean_gen</strong> A vector with the means of the genotypes.
</p>
</li>
<li> <p><strong>mean_env</strong> A vector with the means of the environments.
</p>
</li>
<li> <p><strong>scale_var</strong> The scaling vector when the scaling method is <code>'sd'</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Yan, W., and M.S. Kang. 2003. GGE biplot analysis: a graphical tool for breeders,
geneticists, and agronomists. CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mod &lt;- gge(data_ge, ENV, GEN, GY)
plot(mod)

# GGE model for all numeric variables
mod2 &lt;- gge(data_ge2, ENV, GEN, resp = everything())
plot(mod2, var = "ED")

# If we have a two-way table with the mean values for
# genotypes and environments

table &lt;- make_mat(data_ge, GEN, ENV, GY) %&gt;% round(2)
table
make_long(table) %&gt;%
gge(ENV, GEN, Y) %&gt;%
plot()

</code></pre>

<hr>
<h2 id='gtb'>Genotype by trait biplot</h2><span id='topic+gtb'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Produces a genotype-by-trait biplot model. From a genotype by environment by
trait three-way table, genotype-by-trait tables in any single environment,
across all environments, or across a subset of the environments can be
generated and visually studied using biplots. The model for biplot analysis
of genotype by trait data is the singular value decomposition of
trait-standardized two-way table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtb(.data, gen, resp, centering = "trait", scaling = "sd", svp = "trait")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gtb_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Genotypes and the
response variable(s).</p>
</td></tr>
<tr><td><code id="gtb_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="gtb_+3A_resp">resp</code></td>
<td>
<p>The response variables, i.e., <code>resp = c(var1, var2, var3)</code>.
Select helpers can also be used.</p>
</td></tr>
<tr><td><code id="gtb_+3A_centering">centering</code></td>
<td>
<p>The centering method. Must be one of the <code>'none | 0'</code>,
for no centering; <code>'global | 1'</code>, for global centered (T+G+GT);
<code>'trait | 2'</code> (default), for trait-centered (G+GT); or <code>'double | 3'</code>, for double centred (GT). A biplot cannot be produced with models
produced without centering.</p>
</td></tr>
<tr><td><code id="gtb_+3A_scaling">scaling</code></td>
<td>
<p>The scaling method. Must be one of the <code>'none | 0'</code>, for
no scaling; or <code>'sd | 1'</code> (default), where each value is divided by
the standard deviation of its corresponding trait (column). This will put
all traits roughly he same rang of values.</p>
</td></tr>
<tr><td><code id="gtb_+3A_svp">svp</code></td>
<td>
<p>The method for singular value partitioning. Must be one of the
<code>'genotype | 1'</code>, (The singular value is entirely partitioned into the
genotype eigenvectors, also called row metric preserving); <code>'trait | 2'</code>, default, (The singular value is entirely partitioned into the trait
eigenvectors, also called column metric preserving); or <code>'symmetrical | 3'</code> (The singular value is symmetrically partitioned into the genotype
and the trait eigenvectors This SVP is most often used in AMMI analysis and
other biplot analysis, but it is not ideal for visualizing either the
relationship among genotypes or that among the traits).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list of class <code>gge</code> that is compatible with the function <code>plot()</code> used in <code><a href="#topic+gge">gge()</a></code>.
</p>

<ul>
<li> <p><strong>coordgen</strong> The coordinates for genotypes for all components.
</p>
</li>
<li> <p><strong>coordenv</strong> The coordinates for traits for all components.
</p>
</li>
<li> <p><strong>eigenvalues</strong> The vector of eigenvalues.
</p>
</li>
<li> <p><strong>totalvar</strong> The overall variance.
</p>
</li>
<li> <p><strong>labelgen</strong> The name of the genotypes.
</p>
</li>
<li> <p><strong>labelenv</strong> The names of the traits.
</p>
</li>
<li> <p><strong>labelaxes</strong> The axes labels.
</p>
</li>
<li> <p><strong>gt_mat</strong> The data used to produce the model (scaled and centered).
</p>
</li>
<li> <p><strong>centering</strong> The centering method.
</p>
</li>
<li> <p><strong>scaling</strong> The scaling method.
</p>
</li>
<li> <p><strong>svp</strong> The singular value partitioning method.
</p>
</li>
<li> <p><strong>d</strong> The factor used to generate in which the ranges of genotypes
and traits are comparable when singular value partitioning is set to
'genotype' or 'trait'.
</p>
</li>
<li> <p><strong>grand_mean</strong> The grand mean of the trial.
</p>
</li>
<li> <p><strong>mean_gen</strong> A vector with the means of the genotypes.
</p>
</li>
<li> <p><strong>mean_env</strong> A vector with the means of the traits.
</p>
</li>
<li> <p><strong>scale_var</strong> The scaling vector when the scaling method is <code>'sd'</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Yan, W., and M.S. Kang. 2003. GGE biplot analysis: a graphical tool for breeders,
geneticists, and agronomists. CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# GT biplot for all numeric variables
mod &lt;- gtb(data_ge2, GEN, resp = contains("E"))
plot(mod)


</code></pre>

<hr>
<h2 id='gytb'>Genotype by yield*trait biplot</h2><span id='topic+gytb'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Produces a Genotype by Yield*Trait biplot (GTY) proposed by Yan and
Fregeau-Reid (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gytb(
  .data,
  gen,
  yield,
  traits = everything(),
  ideotype = NULL,
  weight = NULL,
  prefix = "Y",
  centering = "trait",
  scaling = "sd",
  svp = "trait"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gytb_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Genotypes, Yield,
and Traits.</p>
</td></tr>
<tr><td><code id="gytb_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="gytb_+3A_yield">yield</code></td>
<td>
<p>The column containing the yield values.</p>
</td></tr>
<tr><td><code id="gytb_+3A_traits">traits</code></td>
<td>
<p>The column(s) with the <em>traits</em> values. Defaults to
<em>NULL</em>. In this case, all numeric traits in <code>.data</code>, except that
in <code>yield</code> are selected. To select specific traits from <code>.data</code>,
use a list of unquoted comma-separated variable names (e.g. <em>traits =
c(var1, var2, var3)</em>), an specific range of variables, (e.g. <em>traits =
c(var1:var3)</em>), or even a select helper like <code>starts_with("N")</code>.</p>
</td></tr>
<tr><td><code id="gytb_+3A_ideotype">ideotype</code></td>
<td>
<p>A vector of <code>"h"</code> or <code>"l"</code> with the same length of
<code>traits</code> to define which trait is desired to increase or decrease. By
default (<code>ideotype = NULL</code>) for all numeric traits in <code>traits</code>
are assumed that high values is desirable. Following the order of the
traits selected in <code>traits</code>, use <code>"h"</code> to indicate the traits in
which higher values are desired or <code>"l"</code> to indicate the variables in
which lower values are desired. Then, <code>yield </code> will be multiplied by
traits with <code>"h"</code> and divided by traits with <code>"l"</code> to generate
the Genotype by yield*trait table. For example, <code>ideotype = c("h, h, l")</code> will assume that the ideotype has higher values for the first two
traits and lower values for the last trait.</p>
</td></tr>
<tr><td><code id="gytb_+3A_weight">weight</code></td>
<td>
<p>The weight assumed for each trait. Similar to <code>ideotype</code>
argument, provide a numeric vector of the same length of <code>traits</code>.
Suggested values are between 0 and 2.</p>
</td></tr>
<tr><td><code id="gytb_+3A_prefix">prefix</code></td>
<td>
<p>The prefix used in the biplot for the yield*trait combinations.
Defaults to <code>"Y"</code>.</p>
</td></tr>
<tr><td><code id="gytb_+3A_centering">centering</code></td>
<td>
<p>The centering method. Must be one of the <code>'none | 0'</code>,
for no centering; <code>'global | 1'</code>, for global centered (T+G+GYT);
<code>'trait | 2'</code> (default), for trait-centered (G+GYT); or <code>'double | 3'</code>, for double centered (GYT). A biplot cannot be produced with models
produced without centering.</p>
</td></tr>
<tr><td><code id="gytb_+3A_scaling">scaling</code></td>
<td>
<p>The scaling method. Must be one of the <code>'none | 0'</code>, for
no scaling; or <code>'sd | 1'</code> (default), so that the mean for each trait
or yield-trait combination becomes 0 and the variance becomes unit.</p>
</td></tr>
<tr><td><code id="gytb_+3A_svp">svp</code></td>
<td>
<p>The method for singular value partitioning. Must be one of the
<code>'genotype | 1'</code>, (The singular value is entirely partitioned into the
genotype eigenvectors, also called row metric preserving); <code>'trait | 2'</code>, default, (The singular value is entirely partitioned into the trait
eigenvectors, also called column metric preserving); or <code>'symmetrical | 3'</code> (The singular value is symmetrically partitioned into the genotype
and the trait eigenvectors This SVP is most often used in AMMI analysis and
other biplot analysis, but it is not ideal for visualizing either the
relationship among genotypes or that among the traits).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list of class <code>gge</code> that is compatible with the function <code>plot()</code> used in <code><a href="#topic+gge">gge()</a></code>.
</p>

<ul>
<li> <p><strong>data</strong> The Genotype by yield\*trait (GYT) data.
</p>
</li>
<li> <p><strong>ge_mat</strong> The Genotype by yield\*trait (GYT) data  (scaled and centered).
</p>
</li>
<li> <p><strong>coordgen</strong> The coordinates for genotypes for all components.
</p>
</li>
<li> <p><strong>coordenv</strong> The coordinates for traits for all components.
</p>
</li>
<li> <p><strong>eigenvalues</strong> The vector of eigenvalues.
</p>
</li>
<li> <p><strong>totalvar</strong> The overall variance.
</p>
</li>
<li> <p><strong>labelgen</strong> The name of the genotypes.
</p>
</li>
<li> <p><strong>labelenv</strong> The names of the traits.
</p>
</li>
<li> <p><strong>labelaxes</strong> The axes labels.
</p>
</li>
<li> <p><strong>centering</strong> The centering method.
</p>
</li>
<li> <p><strong>scaling</strong> The scaling method.
</p>
</li>
<li> <p><strong>svp</strong> The singular value partitioning method.
</p>
</li>
<li> <p><strong>d</strong> The factor used to generate in which the ranges of genotypes
and traits are comparable when singular value partitioning is set to
'genotype' or 'trait'.
</p>
</li>
<li> <p><strong>grand_mean</strong> The grand mean of the trial.
</p>
</li>
<li> <p><strong>mean_gen</strong> A vector with the means of the genotypes.
</p>
</li>
<li> <p><strong>mean_env</strong> A vector with the means of the traits.
</p>
</li>
<li> <p><strong>scale_var</strong> The scaling vector when the scaling method is <code>'sd'</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Yan, W., &amp; Fregeau-Reid, J. (2018). Genotype by Yield\*Trait (GYT) Biplot: a
Novel Approach for Genotype Selection based on Multiple Traits. Scientific
Reports, 8(1), 1-10. <a href="https://doi.org/10.1038/s41598-018-26688-8">doi:10.1038/s41598-018-26688-8</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# GYT biplot for all numeric traits of 'data_g'
# KW (kernel weight) considered as 'yield',
mod &lt;- gytb(data_g, GEN, KW)
plot(mod)


</code></pre>

<hr>
<h2 id='Huehn'>Huehn's stability statistics</h2><span id='topic+Huehn'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs a stability analysis based on Huehn (1979) statistics. The four
nonparametric measures of phenotypic stability are: S1 (mean of the absolute
rank differences of a genotype over the n environments), S2 (variance among
the ranks over the k environments), S3 (sum of the absolute deviations), and
S6 (relative sum of squares of rank for each genotype).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Huehn(.data, env, gen, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Huehn_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="Huehn_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="Huehn_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="Huehn_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="Huehn_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>Huehn</code>, which is a list containing the results
for each variable used in the argument <code>resp</code>. For each variable, a
tibble with the following columns is returned.
</p>

<ul>
<li> <p><strong>GEN</strong> The genotype's code.
</p>
</li>
<li> <p><strong>Y</strong> The mean for the response variable.
</p>
</li>
<li> <p><strong>S1</strong> Mean of the absolute rank differences of a genotype over the n environments.
</p>
</li>
<li> <p><strong>S2</strong> variance among the ranks over the k environments.
</p>
</li>
<li> <p><strong>S3</strong> Sum of the absolute deviations.
</p>
</li>
<li> <p><strong>S6</strong> Relative sum of squares of rank for each genotype.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Huehn, V.M. 1979. Beitrage zur erfassung der phanotypischen
stabilitat. EDV Med. Biol. 10:112.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
out &lt;- Huehn(data_ge2, ENV, GEN, PH)
print(out)


</code></pre>

<hr>
<h2 id='impute_missing_val'>Missing value imputation</h2><span id='topic+impute_missing_val'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Impute the missing entries of a matrix with missing values using different
algorithms. See <strong>Details</strong> section for more details
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute_missing_val(
  .data,
  naxis = 1,
  algorithm = "EM-SVD",
  tol = 1e-10,
  max_iter = 1000,
  simplified = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="impute_missing_val_+3A_.data">.data</code></td>
<td>
<p>A matrix to impute the missing entries. Frequently a two-way
table of genotype means in each environment.</p>
</td></tr>
<tr><td><code id="impute_missing_val_+3A_naxis">naxis</code></td>
<td>
<p>The rank of the Singular Value Approximation. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="impute_missing_val_+3A_algorithm">algorithm</code></td>
<td>
<p>The algorithm to impute missing values. Defaults to
<code>"EM-SVD"</code>. Other possible values are <code>"EM-AMMI"</code> and
<code>"colmeans"</code>. See <strong>Details</strong> section.</p>
</td></tr>
<tr><td><code id="impute_missing_val_+3A_tol">tol</code></td>
<td>
<p>The convergence tolerance for the algorithm.</p>
</td></tr>
<tr><td><code id="impute_missing_val_+3A_max_iter">max_iter</code></td>
<td>
<p>The maximum number of steps to take. If <code>max_iter</code> is
achieved without convergence, the algorithm will stop with a warning.</p>
</td></tr>
<tr><td><code id="impute_missing_val_+3A_simplified">simplified</code></td>
<td>
<p>Valid argument when <code>algorithm = "EM-AMMI"</code>. IF
<code>FALSE</code> (default), the current effects of rows and columns change from
iteration to iteration. If <code>TRUE</code>, the general mean and effects of
rows and columns are computed in the first iteration only, and in next
iterations uses these values.</p>
</td></tr>
<tr><td><code id="impute_missing_val_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong><code>EM-AMMI</code> algorithm</strong>
</p>
<p>The <code>EM-AMMI</code> algorithm completes a data set with missing values according to both
main and interaction effects. The algorithm works as follows (Gauch and
Zobel, 1990):
</p>

<ol>
<li><p> The initial values are calculated as the grand mean increased by main
effects of rows and main effects of columns. That way, the matrix of
observations is pre-filled in.
</p>
</li>
<li><p> The parameters of the AMMI model are estimated.
</p>
</li>
<li><p> The adjusted means are calculated based on the AMMI model with
<code>naxis</code> principal components.
</p>
</li>
<li><p> The missing cells are filled with the adjusted means.
</p>
</li>
<li><p> The root mean square error of the predicted values (<code>RMSE_p</code>) is
calculated with the two lasts iteration steps. If <code>RMSE_p &gt; tol</code>, the
steps 2 through 5 are repeated. Declare convergence if <code>RMSE_p &lt; tol</code>.
If <code>max_iter</code> is achieved without convergence, the algorithm will stop
with a warning.
</p>
</li></ol>

<p><strong><code>EM-SVD</code> algorithm</strong>
</p>
<p>The <code>EM-SVD</code> algorithm impute the missing entries using a low-rank Singular
Value Decomposition approximation estimated by the Expectation-Maximization
algorithm. The algorithm works as follows (Troyanskaya et al., 2001).
</p>

<ol>
<li><p> Initialize all <code>NA</code> values to the column means.
</p>
</li>
<li><p> Compute the first <code>naxis</code> terms of the SVD of the completed matrix
</p>
</li>
<li><p> Replace the previously missing values with their approximations from the SVD
</p>
</li>
<li><p> The root mean square error of the predicted values (<code>RMSE_p</code>) is
calculated with the two lasts iteration steps. If <code>RMSE_p &gt; tol</code>, the
steps 2 through 3 are repeated. Declare convergence if <code>RMSE_p &lt; tol</code>.
If <code>max_iter</code> is achieved without convergence, the algorithm will stop
with a warning.
</p>
</li></ol>

<p><strong><code>colmeans</code> algorithm</strong>
</p>
<p>The <code>colmeans</code> algorithm simply impute the missing entires using the
column mean of the respective entire. Thus, there is no iteractive process.
</p>


<h3>Value</h3>

<p>An object of class <code>imv</code> with the following values:
</p>

<ul>
<li> <p><strong>.data</strong> The imputed matrix
</p>
</li>
<li> <p><strong>pc_ss</strong> The sum of squares representing variation explained by the
principal components
</p>
</li>
<li> <p><strong>iter</strong> The final number of iterations.
</p>
</li>
<li> <p><strong>Final_RMSE</strong> The maximum change of the estimated values for missing cells in the last step of iteration.
</p>
</li>
<li> <p><strong>final_axis</strong> The final number of principal component axis.
</p>
</li>
<li> <p><strong>convergence</strong> Logical value indicating whether the modern converged.
</p>
</li></ul>



<h3>References</h3>

<p>Gauch, H. G., &amp; Zobel, R. W. (1990). Imputing missing yield trial data.
Theoretical and Applied Genetics, 79(6), 753-761.
<a href="https://doi.org/10.1007/BF00224240">doi:10.1007/BF00224240</a>
</p>
<p>Troyanskaya, O., Cantor, M., Sherlock, G., Brown, P., Hastie, T., Tibshirani,
R., . Altman, R. B. (2001). Missing value estimation methods for DNA
microarrays. Bioinformatics, 17(6), 520-525.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mat &lt;- (1:20) %*% t(1:10)
mat
# 10% of missing values at random
miss_mat &lt;- random_na(mat, prop = 10)
miss_mat
mod &lt;- impute_missing_val(miss_mat)
mod$.data

</code></pre>

<hr>
<h2 id='inspect'>Check for common errors in multi-environment trial data</h2><span id='topic+inspect'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p><code>inspect()</code> scans a <code>data.frame</code> object for errors that may affect the use
of functions in <code>metan</code>. By default, all variables are checked regarding
the class (numeric or factor), missing values, and presence of possible
outliers. The function will return a warning if the data looks like
unbalanced, has missing values or possible outliers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inspect(.data, ..., plot = FALSE, threshold = 15, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inspect_+3A_.data">.data</code></td>
<td>
<p>The data to be analyzed</p>
</td></tr>
<tr><td><code id="inspect_+3A_...">...</code></td>
<td>
<p>The variables in <code>.data</code> to check. If no variable is
informed, all the variables in <code>.data</code> are used.</p>
</td></tr>
<tr><td><code id="inspect_+3A_plot">plot</code></td>
<td>
<p>Create a plot to show the check? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="inspect_+3A_threshold">threshold</code></td>
<td>
<p>Maximum number of levels allowed in a character / factor
column to produce a plot. Defaults to 15.</p>
</td></tr>
<tr><td><code id="inspect_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> (default) then the results
for checks are shown in the console.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the following variables:
</p>

<ul>
<li> <p><strong>Variable</strong> The name of variable
</p>
</li>
<li> <p><strong>Class</strong> The class of the variable
</p>
</li>
<li> <p><strong>Missing</strong> Contains missing values?
</p>
</li>
<li> <p><strong>Levels</strong> The number of levels of a factor variable
</p>
</li>
<li> <p><strong>Valid_n</strong> Number of valid n (omit NAs)
</p>
</li>
<li> <p><strong>Outlier</strong> Contains possible outliers?
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
inspect(data_ge)

# Create a toy example with messy data
df &lt;- data_ge2[-c(2, 30, 45, 134), c(1:5)] %&gt;% as.data.frame()
df[c(1, 20, 50), 5] &lt;- NA
df[40, 4] &lt;- "2..814"

inspect(df)

</code></pre>

<hr>
<h2 id='int.effects'>Data for examples</h2><span id='topic+int.effects'></span>

<h3>Description</h3>

<p>Data for examples
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>

<hr>
<h2 id='is_balanced_trial'>Check if a data set is balanced</h2><span id='topic+is_balanced_trial'></span>

<h3>Description</h3>

<p>Check if a data set coming from multi-environment trials is balanced, i.e.,
all genotypes are in all environments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_balanced_trial(.data, env, gen, resp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_balanced_trial_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="is_balanced_trial_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="is_balanced_trial_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="is_balanced_trial_+3A_resp">resp</code></td>
<td>
<p>The response variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
unb &lt;- data_ge %&gt;%
        remove_rows(1:3) %&gt;%
        droplevels()
is_balanced_trial(data_ge, ENV, GEN, GY)
is_balanced_trial(unb, ENV, GEN, GY)


</code></pre>

<hr>
<h2 id='is.lpcor'>Coerce to an object of class lpcor</h2><span id='topic+is.lpcor'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Functions to check if an object is of class <code>lpcor</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.lpcor(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.lpcor_+3A_x">x</code></td>
<td>
<p>An object to check.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
library(dplyr)
mt_num &lt;- mtcars %&gt;% select_if(., is.numeric)
lpdata &lt;- as.lpcor(cor(mt_num[1:5]),
                   cor(mt_num[1:5]),
                   cor(mt_num[2:6]),
                   cor(mt_num[4:8]))
is.lpcor(lpdata)


</code></pre>

<hr>
<h2 id='lineplots'>Fast way to create line plots</h2><span id='topic+lineplots'></span><span id='topic+plot_lines'></span><span id='topic+plot_factlines'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code>plot_lines()</code> Creates a line plot based on one quantitative factor
and one numeric variable.  It can be used to show the results of a one-way
trial with <strong>quantitative treatments</strong>.
</p>
</li>
<li> <p><code>plot_factlines()</code> Creates a line plot based on: one categorical and one quantitative factor and
one numeric variable.  It can be used to show the results of a
two-way trial with <strong>qualitative-quantitative treatment structure</strong>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>plot_lines(
  .data,
  x,
  y,
  fit,
  level = 0.95,
  confidence = TRUE,
  xlab = NULL,
  ylab = NULL,
  n.dodge = 1,
  check.overlap = FALSE,
  col = "red",
  alpha = 0.2,
  size.shape = 1.5,
  size.line = 1,
  size.text = 12,
  fontfam = "sans",
  plot_theme = theme_metan()
)

plot_factlines(
  .data,
  x,
  y,
  group,
  fit,
  level = 0.95,
  confidence = TRUE,
  xlab = NULL,
  ylab = NULL,
  n.dodge = 1,
  check.overlap = FALSE,
  legend.position = "bottom",
  grid = FALSE,
  scales = "free",
  col = TRUE,
  alpha = 0.2,
  size.shape = 1.5,
  size.line = 1,
  size.text = 12,
  fontfam = "sans",
  plot_theme = theme_metan()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lineplots_+3A_.data">.data</code></td>
<td>
<p>The data set</p>
</td></tr>
<tr><td><code id="lineplots_+3A_x">x</code>, <code id="lineplots_+3A_y">y</code></td>
<td>
<p>The variables to be mapped to the <code>x</code> and <code>y</code> axes,
respectively.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_fit">fit</code></td>
<td>
<p>The polynomial degree to use. It must be between 1 (linear fit) to
4 (fourth-order polynomial regression.). In <code>plot_factlines()</code>, if
<code>fit</code> is a lenth 1 vector, i.e., 1, the fitted curves of all levels in
<code>group</code> will be fitted with polynomial degree <code>fit</code>. To use a
different polynomial degree for each level in <code>group</code>, use a numeric
vector with the same length of the variable in <code>group</code>.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_level">level</code></td>
<td>
<p>The fonfidence level. Defaults to <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_confidence">confidence</code></td>
<td>
<p>Display confidence interval around smooth? (TRUE by
default)</p>
</td></tr>
<tr><td><code id="lineplots_+3A_xlab">xlab</code>, <code id="lineplots_+3A_ylab">ylab</code></td>
<td>
<p>The labels of the axes x and y, respectively. Defaults to
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_n.dodge">n.dodge</code></td>
<td>
<p>The number of rows that should be used to render the x labels.
This is useful for displaying labels that would otherwise overlap.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_check.overlap">check.overlap</code></td>
<td>
<p>Silently remove overlapping labels, (recursively)
prioritizing the first, last, and middle labels.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_col">col</code></td>
<td>
<p>The colour to be used in the line plot and points.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_alpha">alpha</code></td>
<td>
<p>The alpha for the color in confidence band</p>
</td></tr>
<tr><td><code id="lineplots_+3A_size.shape">size.shape</code></td>
<td>
<p>The size for the shape in plot</p>
</td></tr>
<tr><td><code id="lineplots_+3A_size.line">size.line</code></td>
<td>
<p>The size for the line in the plot</p>
</td></tr>
<tr><td><code id="lineplots_+3A_size.text">size.text</code></td>
<td>
<p>The size of the text</p>
</td></tr>
<tr><td><code id="lineplots_+3A_fontfam">fontfam</code></td>
<td>
<p>The family of the font text.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_group">group</code></td>
<td>
<p>The grouping variable. Valid for <code>plot_factlines()</code> only.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_legend.position">legend.position</code></td>
<td>
<p>Valid argument for <code>plot_factlines</code>. The position
of the legend. Defaults to 'bottom'.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_grid">grid</code></td>
<td>
<p>Valid argument for <code>plot_factlines</code>. Logical argument. If
<code>TRUE</code> then a grid will be created.</p>
</td></tr>
<tr><td><code id="lineplots_+3A_scales">scales</code></td>
<td>
<p>Valid argument for <code>plot_factlines</code>. If <code>grid = TRUE</code>
scales controls how the scales are in the plot. Possible values are
<code>'free'</code> (default), <code>'fixed'</code>, <code>'free_x'</code> or
<code>'free_y'</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_bars">plot_bars()</a></code> and <code><a href="#topic+plot_factbars">plot_factbars()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# One-way line plot
df1 &lt;- data.frame(group = "A",
                  x = c(0, 100, 200, 300, 400),
                  y = c(3.2, 3.3, 4.0, 3.8, 3.4))
plot_lines(df1, x, y, fit = 2)

# Two-way line plot
df2 &lt;- data.frame(group = "B",
                  x = c(0, 100, 200, 300, 400),
                  y = c(3.2, 3.3, 3.7, 3.9, 4.1))
facts &lt;- rbind(df1, df2)

p1 &lt;- plot_factlines(facts, x, y, group = group, fit = 1)
p2 &lt;- plot_factlines(facts,
                     x = x,
                     y = y,
                     group = group,
                     fit = c(2, 1),
                     confidence = FALSE)
arrange_ggplot(p1, p2)

</code></pre>

<hr>
<h2 id='lpcor'>Linear and Partial Correlation Coefficients</h2><span id='topic+lpcor'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Estimates the linear and partial correlation coefficients using as input a
data frame or a correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lpcor(.data, ..., by = NULL, n = NULL, method = "pearson")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lpcor_+3A_.data">.data</code></td>
<td>
<p>The data to be analyzed. It must be a symmetric correlation
matrix or a data frame, possible with grouped data passed from
<code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.</p>
</td></tr>
<tr><td><code id="lpcor_+3A_...">...</code></td>
<td>
<p>Variables to use in the correlation. If <code>...</code> is null
(Default) then all the numeric variables from <code>.data</code> are used. It
must be a single variable name or a comma-separated list of unquoted
variables names.</p>
</td></tr>
<tr><td><code id="lpcor_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="lpcor_+3A_n">n</code></td>
<td>
<p>If a correlation matrix is provided, then <code>n</code> is the number of
objects used to compute the correlation coefficients.</p>
</td></tr>
<tr><td><code id="lpcor_+3A_method">method</code></td>
<td>
<p>a character string indicating which correlation coefficient is
to be computed. One of 'pearson' (default), 'kendall', or 'spearman'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>.data</code> is a grouped data passed from
<code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code> then the results will be returned into a
list-column of data frames, containing:
</p>

<ul>
<li> <p><strong>linear.mat</strong> The matrix of linear correlation.
</p>
</li>
<li> <p><strong>partial.mat</strong> The matrix of partial correlations.
</p>
</li>
<li> <p><strong>results</strong> Hypothesis testing for each pairwise comparison.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
partial1 &lt;- lpcor(iris)

# Alternatively using the pipe operator %&gt;%
partial2 &lt;- iris %&gt;% lpcor()

# Using a correlation matrix
partial3 &lt;- cor(iris[1:4]) %&gt;%
            lpcor(n = nrow(iris))

# Select all numeric variables and compute the partial correlation
# For each level of Species

partial4 &lt;- lpcor(iris, by = Species)

</code></pre>

<hr>
<h2 id='mahala'>Mahalanobis Distance</h2><span id='topic+mahala'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Compute the Mahalanobis distance of all pairwise rows in <code>.means</code>. The
result is a symmetric matrix containing the distances that may be used for
hierarchical clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mahala(.means, covar, inverted = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mahala_+3A_.means">.means</code></td>
<td>
<p>A matrix of data with, say, p columns.</p>
</td></tr>
<tr><td><code id="mahala_+3A_covar">covar</code></td>
<td>
<p>The covariance matrix.</p>
</td></tr>
<tr><td><code id="mahala_+3A_inverted">inverted</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, <code>covar</code> is supposed to
contain the inverse of the covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A symmetric matrix with the Mahalanobis' distance.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
library(dplyr)
# Compute the mean for genotypes
means &lt;- mean_by(data_ge, GEN) %&gt;%
         column_to_rownames("GEN")

# Compute the covariance matrix
covmat &lt;- cov(means)

# Compute the distance
dist &lt;- mahala(means, covmat)

# Dendrogram
dend &lt;- dist %&gt;%
        as.dist() %&gt;%
        hclust() %&gt;%
        as.dendrogram()
plot(dend)

</code></pre>

<hr>
<h2 id='mahala_design'>Mahalanobis distance from designed experiments</h2><span id='topic+mahala_design'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Compute the Mahalanobis distance using data from an experiment conducted in a
randomized complete block design or completely randomized design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mahala_design(
  .data,
  gen,
  rep,
  resp,
  design = "RCBD",
  by = NULL,
  return = "distance"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mahala_design_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Genotypes,
replication/block and response variables, possible with grouped data passed
from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.</p>
</td></tr>
<tr><td><code id="mahala_design_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="mahala_design_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="mahala_design_+3A_resp">resp</code></td>
<td>
<p>The response variables. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="mahala_design_+3A_design">design</code></td>
<td>
<p>The experimental design. Must be RCBD or CRD.</p>
</td></tr>
<tr><td><code id="mahala_design_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="mahala_design_+3A_return">return</code></td>
<td>
<p>What the function return? Default is 'distance', i.e., the
Mahalanobis distance. Alternatively, it is possible to return the matrix of
means <code>return = 'means'</code>, or the variance-covariance matrix of
residuals <code>return = 'covmat'</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A symmetric matrix with the Mahalanobis' distance. If <code>.data</code> is
a grouped data passed from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code> then the results
will be returned into a list-column of data frames.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
maha &lt;- mahala_design(data_g,
                      gen = GEN,
                      rep = REP,
                      resp = everything(),
                      return = "covmat")

# Compute one distance for each environment (all numeric variables)
maha_group &lt;- mahala_design(data_ge,
                           gen = GEN,
                           rep = REP,
                           resp = everything(),
                           by = ENV)

# Return the variance-covariance matrix of residuals
cov_mat &lt;- mahala_design(data_ge,
                        gen = GEN,
                        rep = REP,
                        resp = c(GY, HM),
                        return = 'covmat')

</code></pre>

<hr>
<h2 id='make_long'>Two-way table to a 'long' format</h2><span id='topic+make_long'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Helps users to easily convert a two-way table (genotype vs environment) to a
'long' format data. The data in <code>mat</code> will be gathered into three
columns. The row names will compose the first column. The column names will
compose the second column and the third column will contain the data that
fills the two-way table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_long(mat, gen_in = "rows")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_long_+3A_mat">mat</code></td>
<td>
<p>A two-way table. It must be a matrix or a data.frame with
rownames.</p>
</td></tr>
<tr><td><code id="make_long_+3A_gen_in">gen_in</code></td>
<td>
<p>Where are the genotypes? Defaults to <code>'rows'</code>. If
genotypes are in columns and environments in rows, set to <code>gen_in = 'cols'</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with three columns: GEN (genotype), ENV (environment), and Y
(response) variable.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

set.seed(1)
mat &lt;- matrix(rnorm(9, 2530, 350), ncol = 3)
colnames(mat) &lt;- paste("E", 1:3, sep = "")
rownames(mat) &lt;- paste("G", 1:3, sep = "")

make_long(mat)

gen_cols &lt;- t(mat)
make_long(gen_cols, gen_in = "cols")


</code></pre>

<hr>
<h2 id='make_mat'>Make a two-way table</h2><span id='topic+make_mat'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function help users to easily make a two-way table from a &quot;long format&quot;
data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_mat(.data, row, col, value, fun = mean)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_mat_+3A_.data">.data</code></td>
<td>
<p>The dataset. Must contains at least two categorical columns.</p>
</td></tr>
<tr><td><code id="make_mat_+3A_row">row</code></td>
<td>
<p>The column of data in which the mean of each level will
correspond to <strong>one line</strong> in the output.</p>
</td></tr>
<tr><td><code id="make_mat_+3A_col">col</code></td>
<td>
<p>The column of data in which the mean of each level will
correspond to <strong>one column</strong> in the output.</p>
</td></tr>
<tr><td><code id="make_mat_+3A_value">value</code></td>
<td>
<p>The column of data that contains the values to fill the two-way
table.</p>
</td></tr>
<tr><td><code id="make_mat_+3A_fun">fun</code></td>
<td>
<p>The function to apply. Defaults to <code>mean</code>, i.e., the two-way table
will show the mean values for each genotype-environment combination. Other R base functions
such as <code>max</code>, <code>min</code>, <code>sd</code>, <code>var</code>, or an own function that return
a single numeric value can be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A two-way table with the argument <code>row</code> in the rows, <code>col</code>
in the columns, filled by the argument <code>value</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
matrix &lt;- data_ge %&gt;% make_mat(row = GEN, col = ENV, val = GY)
matrix

# standart error of mean

data_ge %&gt;% make_mat(GEN, ENV, GY, sem)

</code></pre>

<hr>
<h2 id='mantel_test'>Mantel test
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></h2><span id='topic+mantel_test'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs a Mantel test between two correlation/distance matrices. The
function calculates the correlation between two matrices, the Z-score that is
is the sum of the products of the corresponding elements of the matrices and
a two-tailed p-value (null hypothesis: \[r = 0\]).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mantel_test(mat1, mat2, nboot = 1000, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mantel_test_+3A_mat1">mat1</code>, <code id="mantel_test_+3A_mat2">mat2</code></td>
<td>
<p>A correlation matrix or an object of class <code>dist</code>.</p>
</td></tr>
<tr><td><code id="mantel_test_+3A_nboot">nboot</code></td>
<td>
<p>The number of permutations to be used. Defaults to <code>1000</code>.</p>
</td></tr>
<tr><td><code id="mantel_test_+3A_plot">plot</code></td>
<td>
<p>if <code>plot = TRUE</code>, plots the density estimate of the
permutation distribution along with the observed Z-score as a vertical
line.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>mantel_r</code> The correlation between the two matrices.
</p>
</li>
<li> <p><code>z_score</code> The Z-score.
</p>
</li>
<li> <p><code>p-value</code> The quantile of the observed Z-score. in the permutation
distribution.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pairs_mantel">pairs_mantel()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# Test if the correlation of traits (data_ge2 dataset)
# changes between A1 and A2 levels of factor ENV
A1 &lt;- corr_coef(data_ge2 %&gt;% subset(ENV == "A1"))[["cor"]]
A2 &lt;- corr_coef(data_ge2 %&gt;% subset(ENV == "A2"))[["cor"]]
mantel_test(A1, A2, plot = TRUE)


</code></pre>

<hr>
<h2 id='meansGxE'>Data for examples</h2><span id='topic+meansGxE'></span>

<h3>Description</h3>

<p>This dataset contains the means for grain yield of 10 genotypes cultivated
in 5 environments. The interaction effects for this data is found in
<code><a href="#topic+int.effects">int.effects()</a></code>
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>

<hr>
<h2 id='metan'>Multi-Environment Trial Analysis</h2><span id='topic+metan'></span>

<h3>Description</h3>

<p><span class="pkg">metan</span> provides functions for performing the most used analyses in the
evaluation of multi-environment trials, including, but not limited to:
</p>

<ul>
<li><p> ANOVA-based stability statistics;
</p>
</li>
<li><p> AMMI-based stability indexes;
</p>
</li>
<li><p> BLUP-based stability indexes;
</p>
</li>
<li><p> Cross-validation procedures for AMMI-family and BLUP models;
</p>
</li>
<li><p> GGE biplot analysis;
</p>
</li>
<li><p> Estimation using AMMI considering different numbers of interaction
principal component axes;
</p>
</li>
<li><p> Graphics tools for generating biplots;
</p>
</li>
<li><p> Nonparametric stability statistics;
</p>
</li>
<li><p> Variance components and genetic parameters in mixed-effect models;
</p>
</li>
<li><p> Within-environment analysis of variance;
</p>
</li></ul>

<p><span class="pkg">metan</span> also provides functions for biometrical analysis such as path
analysis, canonical correlation, partial correlation, clustering analysis, as
well as tools for summarizing and plotting data.
</p>
<p>A complete guide may be found at <a href="https://tiagoolivoto.github.io/metan/">https://tiagoolivoto.github.io/metan/</a>
</p>

<hr>
<h2 id='mgidi'>Multitrait Genotype-Ideotype Distance Index</h2><span id='topic+mgidi'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes the multi-trait genotype-ideotype distance index, MGIDI, (Olivoto
and Nardino, 2020), used to select genotypes in plant breeding programs based
on multiple traits.The MGIDI index is computed as follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[MGIDI_i = \sqrt{\sum\limits_{j = 1}^f(F_{ij} - {F_j})^2}\]
</p>
<p>where \(MGIDI_i\) is the multi-trait genotype-ideotype distance index
for the <em>i</em>th genotype; \(F_{ij}\) is the score of the <em>i</em>th genotype in
the <em>j</em>th factor (<em>i = 1, 2, ..., g; j = 1, 2, ..., f</em>), being <em>g</em> and <em>f</em>
the number of genotypes and factors, respectively, and \(F_j\) is the
<em>j</em>th score of the ideotype. The genotype with the lowest MGIDI is then
closer to the ideotype and therefore should presents desired values for all
the analyzed traits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mgidi(
  .data,
  use_data = "blup",
  SI = 15,
  mineval = 1,
  ideotype = NULL,
  weights = NULL,
  use = "complete.obs",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mgidi_+3A_.data">.data</code></td>
<td>
<p>An object fitted with the function <code><a href="#topic+gafem">gafem()</a></code>, <code><a href="#topic+gamem">gamem()</a></code> or a
two-way table with BLUPs for genotypes in each trait (genotypes in rows and
traits in columns). In the last case, the first column is assumed to have
the genotype's name.</p>
</td></tr>
<tr><td><code id="mgidi_+3A_use_data">use_data</code></td>
<td>
<p>Define which data to use if <code>.data</code> is an object of
class <code>gamem</code>. Defaults to <code>"blup"</code> (the BLUPs for genotypes).
Use <code>"pheno"</code> to use phenotypic means instead BLUPs for computing the
index.</p>
</td></tr>
<tr><td><code id="mgidi_+3A_si">SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td></tr>
<tr><td><code id="mgidi_+3A_mineval">mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td></tr>
<tr><td><code id="mgidi_+3A_ideotype">ideotype</code></td>
<td>
<p>A vector of length <code>nvar</code> where <code>nvar</code> is the number of
traits used to plan the ideotype. Use <code>'h'</code> to indicate the traits in which
higher values are desired or <code>'l'</code> to indicate the traits in which lower
values are desired. For example, <code>ideotype = c("h, h, h, h, l")</code> will
consider that the ideotype has higher values for the first four traits and
lower values for the last trait. ALternatively, one can use a mixed vector,
indicating both h/l values and a numeric value for the target trait(s),
eg., <code>ideotype = c("120, h, 30, h, l")</code>. In this scenario, a numeric value
to define the ideotype is declared for the first and third traits. For this
traits, the absolute difference between the observed value and the numeric
ideotype will be computed, and after the rescaling procedure, the genotype
with the smallest difference will have 100. If <code>.data</code>is a model fitted
with the functions <code><a href="#topic+gafem">gafem()</a></code> or <code><a href="#topic+gamem">gamem()</a></code>, the order of the traits will be
the declared in the argument <code>resp</code> in those functions.</p>
</td></tr>
<tr><td><code id="mgidi_+3A_weights">weights</code></td>
<td>
<p>Optional weights to assign for each trait in the selection
process. It must be a numeric vector of length equal to the number of
traits in <code>.data</code>. By default (<code>NULL</code>) a numeric vector of weights equal to
1 is used, i.e., all traits have the same weight in the selection process.
It is suggested weights ranging from 0 to 1. The weights will then shrink
the ideotype vector toward 0. This is useful, for example, to prioritize
grain yield rather than a plant-related trait in the selection process.</p>
</td></tr>
<tr><td><code id="mgidi_+3A_use">use</code></td>
<td>
<p>The method for computing covariances in the presence of missing
values. Defaults to <code>complete.obs</code>, i.e., missing values are handled
by casewise deletion.</p>
</td></tr>
<tr><td><code id="mgidi_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> (Default) then some results are
shown in the console.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mgidi</code> with the following items:
</p>

<ul>
<li> <p><strong>data</strong> The data used to compute the factor analysis.
</p>
</li>
<li> <p><strong>cormat</strong> The correlation matrix among the environments.
</p>
</li>
<li> <p><strong>PCA</strong> The eigenvalues and explained variance.
</p>
</li>
<li> <p><strong>FA</strong> The factor analysis.
</p>
</li>
<li> <p><strong>KMO</strong> The result for the Kaiser-Meyer-Olkin test.
</p>
</li>
<li> <p><strong>MSA</strong> The measure of sampling adequacy for individual variable.
</p>
</li>
<li> <p><strong>communalities</strong> The communalities.
</p>
</li>
<li> <p><strong>communalities_mean</strong> The communalities' mean.
</p>
</li>
<li> <p><strong>initial_loadings</strong> The initial loadings.
</p>
</li>
<li> <p><strong>finish_loadings</strong> The final loadings after varimax rotation.
</p>
</li>
<li> <p><strong>canonical_loadings</strong> The canonical loadings.
</p>
</li>
<li> <p><strong>scores_gen</strong> The scores for genotypes in all retained factors.
</p>
</li>
<li> <p><strong>scores_ide</strong> The scores for the ideotype in all retained factors.
</p>
</li>
<li> <p><strong>gen_ide</strong> The distance between the scores of each genotype with the
ideotype.
</p>
</li>
<li> <p><strong>MGIDI</strong> The multi-trait genotype-ideotype distance index.
</p>
</li>
<li> <p><strong>contri_fac</strong> The relative contribution of each factor on the MGIDI
value. The lower the contribution of a factor, the close of the ideotype the
variables in such factor are.
</p>
</li>
<li> <p><strong>contri_fac_rank, contri_fac_rank_sel</strong> The rank for the contribution
of each factor for all genotypes and selected genotypes, respectively.
</p>
</li>
<li> <p><strong>complementarity</strong> The complementarity matrix, which is the Euclidean
distance between selected genotypes based on the contribution of each factor
on the MGIDI index (waiting reference).
</p>
</li>
<li> <p><strong>sel_dif</strong> The selection differential for the variables.
</p>
</li>
<li> <p><strong>stat_gain</strong> A descriptive statistic for the selection gains. The
minimum, mean, confidence interval, standard deviation, maximum, and sum of
selection gain values are computed. If traits have negative and positive
desired gains, the statistics are computed for by strata.
</p>
</li>
<li> <p><strong>sel_gen</strong> The selected genotypes.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., and Nardino, M. (2020). MGIDI: toward an effective
multivariate selection in biological experiments. Bioinformatics.
<a href="https://doi.org/10.1093/bioinformatics/btaa981">doi:10.1093/bioinformatics/btaa981</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

# simulate a data set
# 10 genotypes
# 5 replications
# 4 traits
df &lt;-
 g_simula(ngen = 10,
          nrep = 5,
          nvars = 4,
          gen_eff = 35,
          seed = c(1, 2, 3, 4))

# run a mixed-effect model (genotype as random effect)
mod &lt;-
  gamem(df,
        gen = GEN,
        rep = REP,
        resp = everything())
# BLUPs for genotypes
gmd(mod, "blupg")

# Compute the MGIDI index
# Default options (all traits with positive desired gains)
# Equal weights for all traits
mgidi_ind &lt;- mgidi(mod)
gmd(mgidi_ind, "MGIDI")

# Higher weight for traits V1 and V4
# This will increase the probability of selecting H7 and H9
# 30% selection pressure
mgidi_ind2 &lt;-
   mgidi(mod,
         weights = c(1, .2, .2, 1),
         SI = 30)
gmd(mgidi_ind2, "MGIDI")

# plot the contribution of each factor on the MGIDI index
p1 &lt;- plot(mgidi_ind, type = "contribution")
p2 &lt;- plot(mgidi_ind2, type = "contribution")
p1 + p2

# Negative desired gains for V1
# Positive desired gains for V2, V3 and V4
mgidi_ind3 &lt;-
  mgidi(mod,
       ideotype = c("h, h, h, l"))


# Extract the BLUPs for each genotype
(blupsg &lt;- gmd(mod, "blupg"))

# Consider the following ideotype that will be close to H4
# Define a numeric ideotype for the first three traits, and the lower values
# for the last trait
ideotype &lt;- c("129.46, 76.8, 89.7, l")

mgidi_ind4 &lt;-
  mgidi(mod,
       ideotype = ideotype)

# Note how the strenghts of H4 are related to FA1 (V1 and V2)
plot(mgidi_ind4, type = "contribution", genotypes = "all")


</code></pre>

<hr>
<h2 id='mps'>Mean performance and stability in multi-environment trials</h2><span id='topic+mps'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function implements the weighting method between mean performance and
stability (Olivoto et al., 2019) considering different parametric and
non-parametric stability indexes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mps(
  .data,
  env,
  gen,
  rep,
  resp,
  block = NULL,
  by = NULL,
  random = "gen",
  performance = c("blupg", "blueg"),
  stability = "waasb",
  ideotype_mper = NULL,
  ideotype_stab = NULL,
  wmper = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mps_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="mps_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="mps_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="mps_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="mps_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="mps_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then an alpha-lattice
design is employed considering block as random to make use of inter-block
information, whereas the complete replicate effect is always taken as
fixed, as no inter-replicate information was to be recovered (Mohring et
al., 2015).</p>
</td></tr>
<tr><td><code id="mps_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.This is especially useful, for example, when the
researcher want to analyze environments within mega-environments. In this
case, an object of class mps_grouped is returned.</p>
</td></tr>
<tr><td><code id="mps_+3A_random">random</code></td>
<td>
<p>The effects of the model assumed to be random. Defaults to
<code>random = "gen"</code>. See <code><a href="#topic+gamem_met">gamem_met()</a></code> to see the random effects assumed
depending on the experimental design of the trials.</p>
</td></tr>
<tr><td><code id="mps_+3A_performance">performance</code></td>
<td>
<p>Wich considers as mean performance. Either <code>blupg</code> (for
Best Linear Unbiased Prediction) or <code>blueg</code> (for Best Linear Unbiased
Estimation)</p>
</td></tr>
<tr><td><code id="mps_+3A_stability">stability</code></td>
<td>
<p>The stability method. One of the following:
</p>

<ul>
<li> <p><code>"waasb"</code> The weighted average of absolute scores (Olivoto et al. 2019).
</p>
</li>
<li> <p><code>"ecovalence"</code> The Wricke's ecovalence (Wricke, 1965).
</p>
</li>
<li> <p><code>"Shukla"</code> The Shukla's stability variance parameter (Shukla, 1972).
</p>
</li>
<li> <p><code>"hmgv"</code> The harmonic mean of genotypic values (Resende, 2007).
</p>
</li>
<li> <p><code>"s2di"</code> The deviations from the Eberhart and Russell regression (Eberhart
and Russell, 1966).
</p>
</li>
<li> <p><code>"r2"</code> The determination coefficient of the Eberhart and Russell regression
(Eberhart and Russell, 1966)..
</p>
</li>
<li> <p><code>"rmse"</code> The root mean squared error of the Eberhart and Russell regression
(Eberhart and Russell, 1966).
</p>
</li>
<li> <p><code>"wi"</code> Annicchiarico's genotypic confidence index (Annicchiarico, 1992).
</p>
</li>
<li> <p><code>"polar"</code> Power Law Residuals as yield stability index (Doring et al.,
2015).
</p>
</li>
<li> <p><code>"acv"</code> Adjusted Coefficient of Variation (Doring and Reckling, 2018)
</p>
</li>
<li> <p><code>"pi"</code> Lin e Binns' superiority index (Lin and Binns, 1988).
</p>
</li>
<li> <p><code>"gai"</code> Geometric adaptability index (Mohammadi and Amri, 2008).
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"s1", "s2", "s3", and "s6"&#8288;</code> Huehn's stability statistics (Huehn, 1979).
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"n1", "n2", "n3", and "n4"&#8288;</code> Thennarasu's stability statistics (Thennarasu,
1995).
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"asv", "ev", "za", and "waas"&#8288;</code> AMMI-based stability indexes (see
<code><a href="#topic+ammi_indexes">ammi_indexes()</a></code>).
</p>
</li></ul>
</td></tr>
<tr><td><code id="mps_+3A_ideotype_mper">ideotype_mper</code>, <code id="mps_+3A_ideotype_stab">ideotype_stab</code></td>
<td>
<p>The new maximum value after rescaling the
response variable/stability index. By default, all variables in <code>resp</code> are
rescaled so that de maximum value is 100 and the minimum value is 0 (i.e.,
<code>ideotype_mper = NULL</code> and <code>ideotype_stab = NULL</code>). It must be a character
vector of the same length of <code>resp</code> if rescaling is assumed to be different
across variables, e.g., if for the first variable smaller values are better
and for the second one, higher values are better, then <code>ideotype_mper = c("l, h")</code> must be used. For stability index in which lower values are
better, use <code>ideotype_stab = "l"</code>. Character value of length 1 will be
recycled with a warning message.</p>
</td></tr>
<tr><td><code id="mps_+3A_wmper">wmper</code></td>
<td>
<p>The weight for the mean performance. By default, all variables
in <code>resp</code> have equal weights for mean performance and stability (i.e.,
<code>wmper = 50</code>). It must be a numeric vector of the same length of <code>resp</code> to
assign different weights across variables, e.g., if for the first variable
equal weights for mean performance and stability are assumed and for the
second one, a higher weight for mean performance (e.g. 65) is assumed, then
<code>wmper = c(50, 65)</code> must be used. Numeric value of length 1 will be
recycled with a warning message.</p>
</td></tr>
<tr><td><code id="mps_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mps</code> with the following items.
</p>

<ul>
<li> <p><code>observed</code>: The observed value on a genotype-mean basis.
</p>
</li>
<li> <p><code>performance</code>: The performance for genotypes (BLUPs or BLUEs)
</p>
</li>
<li> <p><code>performance_res</code>: The rescaled values of genotype's performance,
considering <code>ideotype_mper</code>.
</p>
</li>
<li> <p><code>stability</code>: The stability for genotypes, chosen with argument <code>stability</code>.
</p>
</li>
<li> <p><code>stability_res</code>: The rescaled values of genotype's stability, considering
<code>ideotype_stab</code>.
</p>
</li>
<li> <p><code>mps_ind</code>: The mean performance and stability for the traits.
</p>
</li>
<li> <p><code>h2</code>: The broad-sense heritability for the traits.
</p>
</li>
<li> <p><code>perf_method</code>: The method for measuring genotype's performance.
</p>
</li>
<li> <p><code>wmper</code>: The weight for the mean performance.
</p>
</li>
<li> <p><code>sense_mper</code>: The goal for genotype's performance (<code>l</code> = lower, <code>h</code> = higher).
</p>
</li>
<li> <p><code>stab_method</code>: The method for measuring genotype's stability.
</p>
</li>
<li> <p><code>wstab</code>: The weight for the mean stability.
</p>
</li>
<li> <p><code>sense_stab</code>: The goal for genotype's stability (<code>l</code> = lower, <code>h</code> = higher).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Annicchiarico, P. 1992. Cultivar adaptation and recommendation from alfalfa
trials in Northern Italy. J. Genet. Breed. 46:269-278.
</p>
<p>Doring, T.F., S. Knapp, and J.E. Cohen. 2015. Taylor's power law and the
stability of crop yields. F. Crop. Res. 183: 294-302.
<a href="https://doi.org/10.1016/j.fcr.2015.08.005">doi:10.1016/j.fcr.2015.08.005</a>
</p>
<p>Doring, T.F., and M. Reckling. 2018. Detecting global trends of cereal yield
stability by adjusting the coefficient of variation. Eur. J. Agron. 99:
30-36. <a href="https://doi.org/10.1016/j.eja.2018.06.007">doi:10.1016/j.eja.2018.06.007</a>
</p>
<p>Eberhart, S.A., and W.A. Russell. 1966. Stability parameters for comparing Varieties.
Crop Sci. 6:36-40. <a href="https://doi.org/10.2135/cropsci1966.0011183X000600010011x">doi:10.2135/cropsci1966.0011183X000600010011x</a>
</p>
<p>Huehn, V.M. 1979. Beitrage zur erfassung der phanotypischen stabilitat. EDV
Med. Biol. 10:112.
</p>
<p>Lin, C.S., and M.R. Binns. 1988. A superiority measure of cultivar
performance for cultivar x location data. Can. J. Plant Sci. 68:193-198.
<a href="https://doi.org/10.4141/cjps88-018">doi:10.4141/cjps88-018</a>
</p>
<p>Mohammadi, R., &amp; Amri, A. (2008). Comparison of parametric and non-parametric
methods for selecting stable and adapted durum wheat genotypes in variable
environments. Euphytica, 159(3), 419-432. <a href="https://doi.org/10.1007/s10681-007-9600-6">doi:10.1007/s10681-007-9600-6</a>
</p>
<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in multi-environment
trials I: Combining features of AMMI and BLUP techniques. Agron. J.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Resende MDV (2007) Matematica e estatistica na analise de experimentos e no
melhoramento genetico. Embrapa Florestas, Colombo
</p>
<p>Shukla, G.K. 1972. Some statistical aspects of partitioning
genotype-environmental components of variability. Heredity. 29:238-245.
<a href="https://doi.org/10.1038/hdy.1972.87">doi:10.1038/hdy.1972.87</a>
</p>
<p>Thennarasu, K. 1995. On certain nonparametric procedures for studying
genotype x environment interactions and yield stability. Ph.D. thesis. P.J.
School, IARI, New Delhi, India.
</p>
<p>Wricke, G. 1965. Zur berechnung der okovalenz bei sommerweizen und hafer. Z.
Pflanzenzuchtg 52:127-138.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtsi">mtsi()</a></code>, <code><a href="#topic+mtmps">mtmps()</a></code>, <code><a href="#topic+mgidi">mgidi()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# The same approach as mtsi()
# mean performance and stability for GY and HM
# mean performance: The genotype's BLUP
# stability: the WAASB index (lower is better)
# weights: equal for mean performance and stability

model &lt;-
mps(data_ge,
    env = ENV,
    gen = GEN,
    rep = REP,
    resp = everything())

# The mean performance and stability after rescaling
model$mps_ind

</code></pre>

<hr>
<h2 id='mtmps'>Multi-trait mean performance and stability index</h2><span id='topic+mtmps'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Computes the multi-trait stability index proposed by Olivoto et al. (2019)
considering different parametric and non-parametric stability indexes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtmps(model, SI = 15, mineval = 1, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mtmps_+3A_model">model</code></td>
<td>
<p>An object of class <code>mtmps</code></p>
</td></tr>
<tr><td><code id="mtmps_+3A_si">SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td></tr>
<tr><td><code id="mtmps_+3A_mineval">mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td></tr>
<tr><td><code id="mtmps_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> (Default), some results are shown in the
console.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mtmps</code> with the following items:
</p>

<ul>
<li> <p><strong>data</strong> The data used to compute the factor analysis.
</p>
</li>
<li> <p><strong>cormat</strong> The correlation matrix among the environments.
</p>
</li>
<li> <p><strong>PCA</strong> The eigenvalues and explained variance.
</p>
</li>
<li> <p><strong>FA</strong> The factor analysis.
</p>
</li>
<li> <p><strong>KMO</strong> The result for the Kaiser-Meyer-Olkin test.
</p>
</li>
<li> <p><strong>MSA</strong> The measure of sampling adequacy for individual variable.
</p>
</li>
<li> <p><strong>communalities</strong> The communalities.
</p>
</li>
<li> <p><strong>communalities_mean</strong> The communalities' mean.
</p>
</li>
<li> <p><strong>initial_loadings</strong> The initial loadings.
</p>
</li>
<li> <p><strong>finish_loadings</strong> The final loadings after varimax rotation.
</p>
</li>
<li> <p><strong>canonical_loadings</strong> The canonical loadings.
</p>
</li>
<li> <p><strong>scores_gen</strong> The scores for genotypes in all retained factors.
</p>
</li>
<li> <p><strong>scores_ide</strong> The scores for the ideotype in all retained factors.
</p>
</li>
<li> <p><strong>MTSI</strong> The multi-trait mean performance and stability index.
</p>
</li>
<li> <p><strong>contri_fac</strong> The relative contribution of each factor on the MTSI
value. The lower the contribution of a factor, the close of the ideotype the
variables in such factor are.
</p>
</li>
<li> <p><strong>contri_fac_rank, contri_fac_rank_sel</strong> The rank for the contribution
of each factor for all genotypes and selected genotypes, respectively.
</p>
</li>
<li> <p><strong>sel_dif_trait, sel_dif_stab, sel_dif_mps</strong> A data frame containing the
selection differential (gains) for the mean performance, stability index, and
mean performance and stability index, respectively. The following variables
are shown.
</p>

<ul>
<li> <p><code>VAR</code>: the trait's name.
</p>
</li>
<li> <p><code>Factor</code>: The factor that traits where grouped into.
</p>
</li>
<li> <p><code>Xo</code>: The original population mean.
</p>
</li>
<li> <p><code>Xs</code>: The mean of selected genotypes.
</p>
</li>
<li> <p><code>SD</code> and <code>SDperc</code>: The selection differential and selection differential in
percentage, respectively.
</p>
</li>
<li> <p><code>h2</code>: The broad-sense heritability.
</p>
</li>
<li> <p><code>SG</code> and <code>SGperc</code>: The selection gains and selection gains in percentage,
respectively.
</p>
</li>
<li> <p><code>sense</code>: The desired selection sense.
</p>
</li>
<li> <p><code>goal</code>: selection gains match desired sense? 100 for yes and 0 for no.
</p>
</li></ul>

</li>
<li> <p><strong>stat_dif_trait, stat_dif_stab, stat_dif_mps</strong> A data frame with the
descriptive statistic for the selection gains for the mean performance,
stability index, and mean performance and stability index, respectively. The
following columns are shown by sense.
</p>

<ul>
<li> <p><code>sense</code>: The desired selection sense.
</p>
</li>
<li> <p><code>variable</code>: the trait's name.
</p>
</li>
<li> <p><code>min</code>: the minimum value for the selection gain.
</p>
</li>
<li> <p><code>mean</code>: the mean value for the selection gain.
</p>
</li>
<li> <p><code>ci</code>: the confidence interval for the selection gain.
</p>
</li>
<li> <p><code>sd.amo</code>: the standard deviation for the selection gain.
</p>
</li>
<li> <p><code>max</code>: the maximum value for the selection gain.
</p>
</li>
<li> <p><code>sum</code>: the sum of the selection gain.
</p>
</li></ul>

</li>
<li> <p><strong>sel_gen</strong> The selected genotypes.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, B.G. Sari, and
M.I. Diel. 2019. Mean performance and stability in multi-environment trials
II: Selection based on multiple traits. Agron. J. 111:2961-2969.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mgidi">mgidi()</a></code>, <code><a href="#topic+mps">mps()</a></code>, <code><a href="#topic+get_model_data">get_model_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# The same approach as mtsi()
# mean performance and stability for GY and HM
# mean performance: The genotype's BLUP
# stability: the WAASB index (lower is better)
# weights: equal for mean performance and stability

model &lt;-
mps(data_ge,
    env = ENV,
    gen = GEN,
    rep = REP,
    resp = everything())
selection &lt;- mtmps(model)

# gains for stability
selection$sel_dif_stab

# gains for mean performance
selection$sel_dif_trait

</code></pre>

<hr>
<h2 id='mtsi'>Multi-trait stability index</h2><span id='topic+mtsi'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes the multi-trait stability index proposed by Olivoto et al. (2019)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtsi(
  .data,
  index = "waasby",
  ideotype = NULL,
  SI = 15,
  mineval = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mtsi_+3A_.data">.data</code></td>
<td>
<p>An object of class <code>waasb</code> or <code>waas</code>.</p>
</td></tr>
<tr><td><code id="mtsi_+3A_index">index</code></td>
<td>
<p>If <code>index = 'waasby'</code> (default) both stability and mean
performance are considered. If <code>index = 'waasb'</code> the multi-trait index
will be computed considering the stability of genotypes only.  More details
can be seen in <code><a href="#topic+waasb">waasb()</a></code> and <code><a href="#topic+waas">waas()</a></code> functions.</p>
</td></tr>
<tr><td><code id="mtsi_+3A_ideotype">ideotype</code></td>
<td>
<p>A vector of length <code>nvar</code> where <code>nvar</code> is the
number of variables used to plan the ideotype. Use <code>'h'</code> to indicate
the traits in which higher values are desired or <code>'l'</code> to indicate the
variables in which lower values are desired. For example, <code>ideotype = c("h, h, h, h, l")</code> will consider that the ideotype has higher values for
the first four traits and lower values for the last trait.</p>
</td></tr>
<tr><td><code id="mtsi_+3A_si">SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td></tr>
<tr><td><code id="mtsi_+3A_mineval">mineval</code></td>
<td>
<p>The minimum value so that an eigenvector is retained in the
factor analysis.</p>
</td></tr>
<tr><td><code id="mtsi_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> (Default) then some results are
shown in the console.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mtsi</code> with the following items:
</p>

<ul>
<li> <p><strong>data</strong> The data used to compute the factor analysis.
</p>
</li>
<li> <p><strong>cormat</strong> The correlation matrix among the environments.
</p>
</li>
<li> <p><strong>PCA</strong> The eigenvalues and explained variance.
</p>
</li>
<li> <p><strong>FA</strong> The factor analysis.
</p>
</li>
<li> <p><strong>KMO</strong> The result for the Kaiser-Meyer-Olkin test.
</p>
</li>
<li> <p><strong>MSA</strong> The measure of sampling adequacy for individual variable.
</p>
</li>
<li> <p><strong>communalities</strong> The communalities.
</p>
</li>
<li> <p><strong>communalities_mean</strong> The communalities' mean.
</p>
</li>
<li> <p><strong>initial_loadings</strong> The initial loadings.
</p>
</li>
<li> <p><strong>finish_loadings</strong> The final loadings after varimax rotation.
</p>
</li>
<li> <p><strong>canonical_loadings</strong> The canonical loadings.
</p>
</li>
<li> <p><strong>scores_gen</strong> The scores for genotypes in all retained factors.
</p>
</li>
<li> <p><strong>scores_ide</strong> The scores for the ideotype in all retained factors.
</p>
</li>
<li> <p><strong>MTSI</strong> The multi-trait stability index.
</p>
</li>
<li> <p><strong>contri_fac</strong> The relative contribution of each factor on the MTSI
value. The lower the contribution of a factor, the close of the ideotype the
variables in such factor are.
</p>
</li>
<li> <p><strong>contri_fac_rank, contri_fac_rank_sel</strong> The rank for the contribution
of each factor for all genotypes and selected genotypes, respectively.
</p>
</li>
<li> <p><strong>sel_dif_trait, sel_dif_stab, sel_dif_mps</strong> A data frame containing the
selection differential (gains) for the traits, for the stability (WAASB
index) WAASB, and for the mean performance and stability (WAASBY indexes).
The following variables are shown.
</p>

<ul>
<li> <p><code>VAR</code>: the trait's name.
</p>
</li>
<li> <p><code>Factor</code>: The factor that traits where grouped into.
</p>
</li>
<li> <p><code>Xo</code>: The original population mean.
</p>
</li>
<li> <p><code>Xs</code>: The mean of selected genotypes.
</p>
</li>
<li> <p><code>SD</code> and <code>SDperc</code>: The selection differential and selection differential in
percentage, respectively.
</p>
</li>
<li> <p><code>h2</code>: The broad-sense heritability.
</p>
</li>
<li> <p><code>SG</code> and <code>SGperc</code>: The selection gains and selection gains in percentage,
respectively.
</p>
</li>
<li> <p><code>sense</code>: The desired selection sense.
</p>
</li>
<li> <p><code>goal</code>: selection gains match desired sense? 100 for yes and 0 for no.
</p>
</li></ul>

</li>
<li> <p><strong>stat_dif_var, stat_dif_stab, stat_dif_mps</strong> A data frame with the
descriptive statistic for the selection gains for the traits, for the
stability (WAASB index) WAASB, and for the mean performance and stability
(WAASBY index).
The following variables are shown.
</p>

<ul>
<li> <p><code>sense</code>: The desired selection sense.
</p>
</li>
<li> <p><code>variable</code>: the trait's name.
</p>
</li>
<li> <p><code>min</code>: the minimum value for the selection gain.
</p>
</li>
<li> <p><code>mean</code>: the mean value for the selection gain.
</p>
</li>
<li> <p><code>ci</code>: the confidence interval for the selection gain.
</p>
</li>
<li> <p><code>sd.amo</code>: the standard deviation for the selection gain.
</p>
</li>
<li> <p><code>max</code>: the maximum value for the selection gain.
</p>
</li>
<li> <p><code>sum</code>: the sum of the selection gain.
</p>
</li></ul>

</li>
<li> <p><strong>sel_gen</strong> The selected genotypes.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, B.G. Sari, and
M.I. Diel. 2019. Mean performance and stability in multi-environment trials
II: Selection based on multiple traits. Agron. J. 111:2961-2969.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mgidi">mgidi()</a></code>, <code><a href="#topic+waasb">waasb()</a></code>, <code><a href="#topic+get_model_data">get_model_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# Based on stability only, for both GY and HM, higher is better
mtsi_model &lt;-
    waasb(data_ge,
    env = ENV,
    gen = GEN,
    rep = REP,
    resp = c(GY, HM))
mtsi_index &lt;-
    mtsi(mtsi_model, index = 'waasb')


# Based on mean performance and stability (using pipe operator %&gt;%)
# GY: higher is better
# HM: lower is better

mtsi_index2 &lt;-
 data_ge %&gt;%
 waasb(ENV, GEN, REP,
       resp = c(GY, HM),
       mresp = c("h, l")) %&gt;%
 mtsi()

</code></pre>

<hr>
<h2 id='network_plot'>Network plot of a correlation matrix</h2><span id='topic+network_plot'></span>

<h3>Description</h3>

<p>Produces a network plot of a correlation matrix or an object computed with
<code><a href="#topic+corr_coef">corr_coef()</a></code>. Variables that are more highly correlated appear closer
together and are joined by stronger (more opaque) and wider paths.  The proximity of the
points is determined using multidimensional clustering, also known as
principal coordinates analysis (Gower, 1966). The color of the paths also
indicates the sign of the correlation (blue for positive and red for
negative).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>network_plot(
  model,
  min_cor = NULL,
  show = c("signif", "all"),
  p_val = 0.05,
  legend = c("full", "range"),
  colours = c("red", "white", "blue"),
  legend_width = 1,
  legend_height = 15,
  legend_position = c("right", "left", "top", "bottom"),
  curved = TRUE,
  angle = 90,
  curvature = 0.5,
  expand_x = 0.25,
  expand_y = 0.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="network_plot_+3A_model">model</code></td>
<td>
<p>A model computed with <code><a href="#topic+corr_coef">corr_coef()</a></code> or a symmetric matrix, often
produced with <code><a href="stats.html#topic+cor">stats::cor()</a></code>.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_min_cor">min_cor</code></td>
<td>
<p>Number to indicate the minimum value of correlations to plot
(0-1 in absolute terms). By default, all the correlations are plotted when
<code>model</code> is a matrix, and significant correlations (p-value &lt; 0.05) when
<code>model</code> is an object computed with <code><a href="#topic+corr_coef">corr_coef()</a></code>.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_show">show</code></td>
<td>
<p>The correlations to be shown when <code>model</code> is an object computed
with <code><a href="#topic+corr_coef">corr_coef()</a></code>. Either <code>"signif"</code> (default) to show only significant
correlations or <code>"all"</code> to show all the correlations.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_p_val">p_val</code></td>
<td>
<p>The p-value to indicate significant correlations. Defaults to
<code>0.05</code>.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_legend">legend</code></td>
<td>
<p>The type of legend. Either <code>"full"</code> (ranges from -1 to +1) or
<code>"range"</code> (ranges according to the data range). Defaults to <code>"full"</code>.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_colours">colours</code></td>
<td>
<p>A vector of colors to use for n-color gradient.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_legend_width">legend_width</code></td>
<td>
<p>The width of the legend (considering <code>position = "right"</code>)</p>
</td></tr>
<tr><td><code id="network_plot_+3A_legend_height">legend_height</code></td>
<td>
<p>The height of the legend (considering <code>position = "right"</code>)</p>
</td></tr>
<tr><td><code id="network_plot_+3A_legend_position">legend_position</code></td>
<td>
<p>The legend position. Defaults to <code>"right"</code>.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_curved">curved</code></td>
<td>
<p>Shows curved paths? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_angle">angle</code></td>
<td>
<p>A numeric value between 0 and 180, giving an amount to skew the
control points of the curve. Values less than 90 skew the curve towards the
start point and values greater than 90 skew the curve towards the end
point.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_curvature">curvature</code></td>
<td>
<p>A numeric value giving the amount of curvature. Negative
values produce left-hand curves, positive values produce right-hand curves,
and zero produces a straight line.</p>
</td></tr>
<tr><td><code id="network_plot_+3A_expand_x">expand_x</code>, <code id="network_plot_+3A_expand_y">expand_y</code></td>
<td>
<p>Vector of multiplicative range expansion factors. If
length 1, both the lower and upper limits of the scale are expanded
outwards by mult. If length 2, the lower limit is expanded by <code>mult[1]</code> and
the upper limit by <code>mult[2]</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object
</p>


<h3>References</h3>

<p>Gower, J.C. 1966. Some Distance Properties of Latent Root and Vector Methods
Used in Multivariate Analysis. Biometrika 53(3/4): 325–338.
<a href="https://doi.org/10.2307/2333639">doi:10.2307/2333639</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cor &lt;- corr_coef(iris)
network_plot(cor)
network_plot(cor,
             show = "all",
             curved = FALSE,
             legend_position = "bottom",
             legend = "range")

</code></pre>

<hr>
<h2 id='non_collinear_vars'>Select a set of predictors with minimal multicollinearity</h2><span id='topic+non_collinear_vars'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Select a set of predictors with minimal multicollinearity using the variance
inflation factor (VIF) as criteria to remove collinear variables. The
algorithm will: <strong>(i)</strong> compute the VIF value of the correlation matrix
containing the variables selected in <code>...</code>; <strong>(ii)</strong> arrange the
VIF values and delete the variable with the highest VIF; and <strong>(iii)</strong>
iterate step <strong>ii</strong> until VIF value is less than or equal to
<code>max_vif</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>non_collinear_vars(
  .data,
  ...,
  max_vif = 10,
  missingval = "pairwise.complete.obs"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="non_collinear_vars_+3A_.data">.data</code></td>
<td>
<p>The data set containing the variables.</p>
</td></tr>
<tr><td><code id="non_collinear_vars_+3A_...">...</code></td>
<td>
<p>Variables to be submitted to selection. If <code>...</code> is null then
all the numeric variables from <code>.data</code> are used. It must be a single
variable name or a comma-separated list of unquoted variables names.</p>
</td></tr>
<tr><td><code id="non_collinear_vars_+3A_max_vif">max_vif</code></td>
<td>
<p>The maximum value for the Variance Inflation Factor
(threshold) that will be accepted in the set of selected predictors.</p>
</td></tr>
<tr><td><code id="non_collinear_vars_+3A_missingval">missingval</code></td>
<td>
<p>How to deal with missing values. For more information,
please see <code><a href="stats.html#topic+cor">stats::cor()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame showing the number of selected predictors, maximum VIF
value, condition number, determinant value, selected predictors and removed
predictors from the original set of variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# All numeric variables
non_collinear_vars(data_ge2)

# Select variables and choose a VIF threshold to 5
non_collinear_vars(data_ge2, EH, CL, CW, KW, NKE, max_vif = 5)

</code></pre>

<hr>
<h2 id='pairs_mantel'>Mantel test for a set of correlation matrices</h2><span id='topic+pairs_mantel'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function generate a pairwise matrix of plots to compare the similarity
of two or more correlation matrices. In the upper diagonal are presented the
plots and in the lower diagonal the result of Mantel test based on
permutations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairs_mantel(
  ...,
  type = 1,
  nrepet = 1000,
  names = NULL,
  prob = 0.05,
  diag = FALSE,
  export = FALSE,
  main = "auto",
  file.type = "pdf",
  file.name = NULL,
  width = 8,
  height = 7,
  resolution = 300,
  size.point = 0.5,
  shape.point = 19,
  alpha.point = 1,
  fill.point = NULL,
  col.point = "black",
  minsize = 2,
  maxsize = 3,
  signcol = "green",
  alpha = 0.15,
  diagcol = "gray",
  col.up.panel = "gray",
  col.lw.panel = "gray",
  col.dia.panel = "gray",
  pan.spacing = 0.15,
  digits = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pairs_mantel_+3A_...">...</code></td>
<td>
<p>The input matrices. May be an output generated by the function
<code>lpcor</code> or a coerced list generated by the function <code>as.lpcor</code></p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_type">type</code></td>
<td>
<p>The type of correlation if an obect generated by the function
<code>lpcor</code> is used. 1 = Linear correlation matrices, or 2 = partial
correlation matrices.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_nrepet">nrepet</code></td>
<td>
<p>The number of permutations. Default is 1000</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_names">names</code></td>
<td>
<p>An optional vector of names of the same length of <code>...</code> .</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_prob">prob</code></td>
<td>
<p>The error probability for Mantel test.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_diag">diag</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, the Kernel density is shown in
the diagonal of plot.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_export">export</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, then the plot is exported to
the current directory.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_main">main</code></td>
<td>
<p>The title of the plot, set to 'auto'.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_file.type">file.type</code></td>
<td>
<p>The format of the file if <code>export = TRUE</code>.  Set to
<code>'pdf'</code>. Other possible values are <code style="white-space: pre;">&#8288;*.tiff&#8288;</code> using <code>file.type = 'tiff'</code>.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_file.name">file.name</code></td>
<td>
<p>The name of the plot when exported. Set to <code>NULL</code>,
i.e., automatically.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_width">width</code></td>
<td>
<p>The width of the plot, set to <code>8</code>.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_height">height</code></td>
<td>
<p>The height of the plot, set to <code>7</code>.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_resolution">resolution</code></td>
<td>
<p>The resolution of the plot if <code>file.type = 'tiff'</code> is
used. Set to <code>300</code> (300 dpi).</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_size.point">size.point</code></td>
<td>
<p>The size of the points in the plot. Set to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_shape.point">shape.point</code></td>
<td>
<p>The shape of the point, set to <code> 19</code>.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_alpha.point">alpha.point</code></td>
<td>
<p>The value for transparency of the points: 1 = full color.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_fill.point">fill.point</code></td>
<td>
<p>The color to fill the points. Valid argument if points are
between 21 and 25.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_col.point">col.point</code></td>
<td>
<p>The color for the edge of the point, set to <code>black</code>.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_minsize">minsize</code></td>
<td>
<p>The size of the letter that will represent the smallest
correlation coefficient.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_maxsize">maxsize</code></td>
<td>
<p>The size of the letter that will represent the largest
correlation coefficient.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_signcol">signcol</code></td>
<td>
<p>The colour that indicate significant correlations (based on
the <code>prob</code> value.), set to 'green'.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_alpha">alpha</code></td>
<td>
<p>The value for transparency of the color informed in
<code>signcol</code>, when 1 = full color. Set to 0.15.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_diagcol">diagcol</code></td>
<td>
<p>The color in the kernel distribution. Set to 'gray'.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_col.up.panel">col.up.panel</code>, <code id="pairs_mantel_+3A_col.lw.panel">col.lw.panel</code>, <code id="pairs_mantel_+3A_col.dia.panel">col.dia.panel</code></td>
<td>
<p>The color for the opper, lower
and diagonal pannels. Set to 'gray', 'gray', and 'gray', respectively.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_pan.spacing">pan.spacing</code></td>
<td>
<p>The space between the pannels. Set to 0.15.</p>
</td></tr>
<tr><td><code id="pairs_mantel_+3A_digits">digits</code></td>
<td>
<p>The number of digits to show in the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggmatrix&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mantel_test">mantel_test()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# iris dataset
lpc &lt;- iris %&gt;%
       group_by(Species) %&gt;%
       lpcor() %&gt;%
       pairs_mantel(names = c('setosa', 'versicolor', 'virginica'))


# mtcars dataset
mt_num &lt;- select_numeric_cols(mtcars)
lpdata &lt;- as.lpcor(cor(mt_num[1:5]),
                   cor(mt_num[1:5]),
                   cor(mt_num[2:6]),
                   cor(mt_num[4:8])) %&gt;%
          pairs_mantel()

</code></pre>

<hr>
<h2 id='path_coeff'>Path coefficients with minimal multicollinearity</h2><span id='topic+path_coeff'></span><span id='topic+path_coeff_mat'></span><span id='topic+path_coeff_seq'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code>path_coeff()</code> computes a path analysis using a data frame as input data.
</p>
</li>
<li> <p><code>path_coeff_seq()</code> computes a sequential path analysis using primary and secondary traits.
</p>
</li>
<li> <p><code>path_coeff_mat()</code> computes a path analysis using correlation matrices as
input data.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>path_coeff(
  .data,
  resp,
  pred = everything(),
  by = NULL,
  exclude = FALSE,
  correction = NULL,
  knumber = 50,
  brutstep = FALSE,
  maxvif = 10,
  missingval = "pairwise.complete.obs",
  plot_res = FALSE,
  verbose = TRUE,
  ...
)

path_coeff_mat(cor_mat, resp, correction = NULL, knumber = 50, verbose = TRUE)

path_coeff_seq(.data, resp, chain_1, chain_2, by = NULL, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="path_coeff_+3A_.data">.data</code></td>
<td>
<p>The data. Must be a data frame or a grouped data passed from
<code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code></p>
</td></tr>
<tr><td><code id="path_coeff_+3A_resp">resp</code></td>
<td>
<p>The dependent trait.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_pred">pred</code></td>
<td>
<p>The predictor traits. set to
<code>everything()</code>, i.e., the predictor traits are all the numeric traits in
the data except that in <code>resp</code>. To select multiple traits, use a
comma-separated vector of names, (e.g., <code>pred = c(V1, V2, V2)</code>), an
interval of trait names, (e.g., <code>pred = c(V1:V3)</code>), or even a select helper
(e.g., <code>pred = starts_with("V")</code>).</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>. To compute the statistics by more than
one grouping variable use that function.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_exclude">exclude</code></td>
<td>
<p>Logical argument, set to false. If <code>exclude = TRUE</code>, then
the traits in <code>pred</code> are deleted from the data, and the analysis
will use as predictor those that remained, except that in <code>resp</code>.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_correction">correction</code></td>
<td>
<p>Set to <code>NULL</code>. A correction value (k) that will be
added into the diagonal elements of the <strong>X'X</strong> matrix aiming at
reducing the harmful problems of the multicollinearity in path analysis
(Olivoto et al., 2017)</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_knumber">knumber</code></td>
<td>
<p>When <code>correction = NULL</code>, a plot showing the values of
direct effects in a set of different k values (0-1) is produced.
<code>knumber</code> is the number of k values used in the range of 0 to 1.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_brutstep">brutstep</code></td>
<td>
<p>Logical argument, set to <code>FALSE</code>. If true, then an
algorithm will select a subset of variables with minimal multicollinearity
and fit a set of possible models. See the <strong>Details</strong> section for more
information.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_maxvif">maxvif</code></td>
<td>
<p>The maximum value for the Variance Inflation Factor (cut point)
that will be accepted. See the <strong>Details</strong> section for more information.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_missingval">missingval</code></td>
<td>
<p>How to deal with missing values. For more information,
please see <code><a href="stats.html#topic+cor">stats::cor()</a></code>.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_plot_res">plot_res</code></td>
<td>
<p>If <code>TRUE</code>, create a scatter plot of residual against
predicted value and a normal Q-Q plot.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> then some results are shown in the
console.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_...">...</code></td>
<td>
<p>Depends on the function used:
</p>

<ul>
<li><p> For <code>path_coeff()</code> additional arguments passed on to <code><a href="stats.html#topic+plot.lm">stats::plot.lm()</a></code>.
</p>
</li>
<li><p> For <code>path_coeff_seq()</code> additional arguments passed on to <a href="#topic+path_coeff">path_coeff</a>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="path_coeff_+3A_cor_mat">cor_mat</code></td>
<td>
<p>Matrix of correlations containing both dependent and
independent traits.</p>
</td></tr>
<tr><td><code id="path_coeff_+3A_chain_1">chain_1</code>, <code id="path_coeff_+3A_chain_2">chain_2</code></td>
<td>
<p>The traits used
in the first (primary) and second (secondary) chain.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code>path_coeff()</code>, when <code>brutstep = TRUE</code>, an algorithm to
select a set of predictors with minimal multicollinearity and high
explanatory power is implemented. first, the algorithm will select a set of
predictors with minimal multicollinearity. The selection is based on the
variance inflation factor (VIF). An iterative process is performed until
the maximum VIF observed is less than <code>maxvif</code>. The variables selected
in this iterative process are then used in a series of stepwise-based
regressions. The first model is fitted and p-1 predictor variables are
retained (p is the number of variables selected in the iterative process.
The second model adjusts a regression considering p-2 selected variables,
and so on until the last model, which considers only two variables. Three
objects are created. <code>Summary</code>, with the process summary,
<code>Models</code>, containing the aforementioned values for all the adjusted
models; and <code>Selectedpred</code>, a vector with the name of the selected
variables in the iterative process.
</p>


<h3>Value</h3>

<p>Depends on the function used:
</p>

<ul>
<li> <p><code>path_coeff()</code>, returns a list with the following items:
</p>

<ul>
<li> <p><strong>Corr.x</strong> A correlation matrix between the predictor variables.
</p>
</li>
<li> <p><strong>Corr.y</strong> A vector of correlations between each predictor variable
with the dependent variable.
</p>
</li>
<li> <p><strong>Coefficients</strong> The path coefficients. Direct effects are the
diagonal elements, and the indirect effects those in the off-diagonal
elements (lines).
</p>
</li>
<li> <p><strong>Eigen</strong> Eigenvectors and eigenvalues of the <code>Corr.x.</code>
</p>
</li>
<li> <p><strong>VIF</strong> The Variance Inflation Factors.
</p>
</li>
<li> <p><strong>plot</strong> A ggplot2-based graphic showing the direct effects in 21
different k values.
</p>
</li>
<li> <p><strong>Predictors</strong> The predictor variables used in the model.
</p>
</li>
<li> <p><strong>CN</strong> The Condition Number, i.e., the ratio between the highest and
lowest eigenvalue.
</p>
</li>
<li> <p><strong>Det</strong> The matrix determinant of the <code>Corr.x.</code>.
</p>
</li>
<li> <p><strong>R2</strong> The coefficient of determination of the model.
</p>
</li>
<li> <p><strong>Residual</strong> The residual effect of the model.
</p>
</li>
<li> <p><strong>Response</strong> The response variable.
</p>
</li>
<li> <p><strong>weightvar</strong> The order of the predictor variables with the highest
weight (highest eigenvector) in the lowest eigenvalue.
</p>
</li></ul>

</li>
<li> <p><code>path_coeff_seq()</code> returns a list with the following objects
</p>

<ul>
<li> <p><strong>resp_fc</strong> an object of class <code>path_coeff</code> with the results for the
analysis with dependent trait and first chain predictors.
</p>
</li>
<li> <p><strong>resp_sc</strong> an object of class <code>path_coeff</code> with the results for the
analysis with dependent trait and second chain predictors.
</p>
</li>
<li> <p><strong>resp_sc2</strong> The path coefficients of second chain predictors and the
dependent trait through the first chain predictors
</p>
</li>
<li> <p><strong>fc_sc_list</strong> A list of objects with the path analysis using each trait
in the first chain as dependent and second chain as predictors.
</p>
</li>
<li> <p><strong>fc_sc_coef</strong> The coefficients between first- and second-chain traits.
</p>
</li>
<li> <p><strong>cor_mat</strong> A correlation matrix between the analyzed traits.
If <code>.data</code> is a grouped data passed from <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>
then the results will be returned into a list-column of data frames.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., V.Q. Souza, M. Nardino, I.R. Carvalho, M. Ferrari, A.J.
Pelegrin, V.J. Szareski, and D. Schmidt. 2017. Multicollinearity in path
analysis: a simple method to reduce its effects. Agron. J. 109:131-142.
<a href="https://doi.org/10.2134/agronj2016.04.0196">doi:10.2134/agronj2016.04.0196</a>
</p>
<p>Olivoto, T., M. Nardino, I.R. Carvalho, D.N. Follmann, M. Ferrari, et al.
2017. REML/BLUP and sequential path analysis in estimating genotypic values
and interrelationships among simple maize grain yield-related traits. Genet.
Mol. Res. 16(1): gmr16019525. <a href="https://doi.org/10.4238/gmr16019525">doi:10.4238/gmr16019525</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(metan)

# Using KW as the response variable and all other ones as predictors
pcoeff &lt;- path_coeff(data_ge2, resp = KW)

# The same as above, but using the correlation matrix
cor_mat &lt;- cor(data_ge2 %&gt;% select_numeric_cols())
pcoeff2 &lt;- path_coeff_mat(cor_mat, resp = KW)

# Declaring the predictors
# Create a residual plot with 'plot_res = TRUE'
pcoeff3&lt;- path_coeff(data_ge2,
                      resp = KW,
                      pred = c(PH, EH, NKE, TKW),
                      plot_res = TRUE)
# sequential path analysis
# KW as dependent trait
# NKE and TKW as primary predictors
# PH, EH, EP, and EL as secondary traits
pcoeff4 &lt;-
 path_coeff_seq(data_ge2,
                resp = KW,
                chain_1 = c(NKE, TKW),
                chain_2 = c(PH, EH, EP, EL))
pcoeff4$resp_sc$Coefficients
pcoeff4$resp_sc2


</code></pre>

<hr>
<h2 id='performs_ammi'>Additive Main effects and Multiplicative Interaction</h2><span id='topic+performs_ammi'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Compute the Additive Main effects and Multiplicative interaction (AMMI)
model. The estimate of the response variable for the <em>i</em>th genotype in the
<em>j</em>th environment (\(y_{ij}\)) using the AMMI model, is given as follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[{y_{ij}} = \mu  + {\alpha_i} + {\tau_j} + \sum\limits_{k = 1}^p
{{\lambda_k}{a_{ik}}} {t_{jk}} + {\rho_{ij}} + {\varepsilon _{ij}}\]
</p>
<p>where \(\lambda_k\) is the singular value for the <em>k</em>-th interaction
principal component axis (IPCA); \(a_{ik}\) is the <em>i</em>-th element of the
<em>k</em>-th eigenvector; \(t_{jk}\) is the <em>j</em>th element of the <em>k</em>th
eigenvector. A residual \(\rho _{ij}\) remains, if not all <em>p</em> IPCA are
used, where \(p \le min(g - 1; e - 1)\).
</p>
<p>This function also serves as a helper function for other procedures performed
in the <span class="pkg">metan</span> package such as <code><a href="#topic+waas">waas()</a></code> and <code><a href="#topic+wsmp">wsmp()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>performs_ammi(.data, env, gen, rep, resp, block = NULL, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="performs_ammi_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="performs_ammi_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments</p>
</td></tr>
<tr><td><code id="performs_ammi_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes</p>
</td></tr>
<tr><td><code id="performs_ammi_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks</p>
</td></tr>
<tr><td><code id="performs_ammi_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure, use comma-separated list of unquoted variable names,
i.e., <code>resp = c(var1, var2, var3)</code>, or any select helper like
<code>resp = contains("_PLA")</code>.</p>
</td></tr>
<tr><td><code id="performs_ammi_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p>
</td></tr>
<tr><td><code id="performs_ammi_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
<tr><td><code id="performs_ammi_+3A_...">...</code></td>
<td>
<p>Arguments passed to the function
<code><a href="#topic+impute_missing_val">impute_missing_val()</a></code> for imputation of missing values in case
of unbalanced data.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><strong>ANOVA</strong>: The analysis of variance for the AMMI model.
</p>
</li>
<li> <p><strong>PCA</strong>: The principal component analysis
</p>
</li>
<li> <p><strong>MeansGxE</strong>: The means of genotypes in the environments
</p>
</li>
<li> <p><strong>model</strong>: scores for genotypes and environments in all the possible
axes.
</p>
</li>
<li> <p><strong>augment:</strong> Information about each observation in the dataset. This
includes predicted values in the <code>fitted</code> column, residuals in the
<code>resid</code> column, standardized residuals in the <code>stdres</code> column,
the diagonal of the 'hat' matrix in the <code>hat</code>, and standard errors for
the fitted values in the <code>se.fit</code> column.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Patterson, H.D., and E.R. Williams. 1976. A new class of
resolvable incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+impute_missing_val">impute_missing_val()</a></code>, <code><a href="#topic+waas">waas()</a></code>, <code><a href="#topic+waas_means">waas_means()</a></code>, <code><a href="#topic+waasb">waasb()</a></code>, <code><a href="#topic+get_model_data">get_model_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- performs_ammi(data_ge, ENV, GEN, REP, resp = c(GY, HM))

# PC1 x PC2 (variable GY)
p1 &lt;- plot_scores(model)
p1

# PC1 x PC2 (variable HM)
plot_scores(model,
            var = 2, # or "HM"
            type = 2)

# Nominal yield plot (variable GY)
# Draw a convex hull polygon
plot_scores(model, type = 4)

# Unbalanced data (GEN 2 in E1 missing)
mod &lt;-
  data_ge %&gt;%
   remove_rows(4:6) %&gt;%
   droplevels() %&gt;%
   performs_ammi(ENV, GEN, REP, GY)
p2 &lt;- plot_scores(mod)
arrange_ggplot(p1, p2, tag_levels = list(c("Balanced data", "Unbalanced data")))


</code></pre>

<hr>
<h2 id='plaisted_peterson'>Stability analysis based on Plaisted and Peterson (1959)</h2><span id='topic+plaisted_peterson'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>The function computes the stability as the arithmetic mean of the variance
component of the genotype-environment interaction between environment pairs
that includes a given genotype
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plaisted_peterson(.data, env, gen, rep, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plaisted_peterson_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="plaisted_peterson_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="plaisted_peterson_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="plaisted_peterson_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="plaisted_peterson_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="plaisted_peterson_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>plaisted_peterson</code> containing the results for each
variable used in the argument <code>resp</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Plaisted, R.L., and L.C. Peterson. 1959. A technique for
evaluating the ability of selections to yield consistently in different
locations or seasons. American Potato Journal 36(11): 381–385.
<a href="https://doi.org/10.1007/BF02852735">doi:10.1007/BF02852735</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
 plaisted_peterson(data_ge, ENV, GEN, REP, GY)


</code></pre>

<hr>
<h2 id='plot_blup'>Plot the BLUPs for genotypes</h2><span id='topic+plot_blup'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Plot the predicted BLUP of the genotypes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_blup(
  x,
  var = 1,
  which = "gen",
  ncol = NULL,
  nrow = NULL,
  prob = 0.05,
  export = FALSE,
  file.type = "pdf",
  file.name = NULL,
  plot_theme = theme_metan(),
  width = 6,
  height = 6,
  err.bar = TRUE,
  size.err.bar = 0.5,
  size.shape = 3.5,
  size.tex.lab = 12,
  height.err.bar = 0.3,
  x.lim = NULL,
  x.breaks = waiver(),
  col.shape = c("blue", "red"),
  y.lab = "Genotypes",
  x.lab = NULL,
  n.dodge = 1,
  check.overlap = FALSE,
  panel.spacing = 0.15,
  resolution = 300,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_blup_+3A_x">x</code></td>
<td>
<p>The <code style="white-space: pre;">&#8288;waasb object&#8288;</code></p>
</td></tr>
<tr><td><code id="plot_blup_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_which">which</code></td>
<td>
<p>Which plot to shown. If <code>which = "gen"</code> (default) plots the
BLUPs for genotypes. To create a plot showing the BLUPs for
genotype-environment combinations, use <code>which = "ge"</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_ncol">ncol</code>, <code id="plot_blup_+3A_nrow">nrow</code></td>
<td>
<p>The number of columns and rows, respectively, to be shown in
the plot when <code>which = "ge"</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_prob">prob</code></td>
<td>
<p>The probability error for constructing confidence interval.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_export">export</code></td>
<td>
<p>Export (or not) the plot. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_file.type">file.type</code></td>
<td>
<p>If <code>export = TRUE</code>, define the type of file to be
exported. Default is <code>pdf</code>, Graphic can also be exported in
<code style="white-space: pre;">&#8288;*.tiff&#8288;</code> format by declaring <code>file.type = "tiff"</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file for exportation, default is
<code>NULL</code>, i.e. the files are automatically named.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_width">width</code></td>
<td>
<p>The width &quot;inch&quot; of the plot. Default is <code>6</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_height">height</code></td>
<td>
<p>The height &quot;inch&quot; of the plot. Default is <code>6</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_err.bar">err.bar</code></td>
<td>
<p>Logical value to indicate if an error bar is shown. Defaults
to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_size.err.bar">size.err.bar</code></td>
<td>
<p>The size of the error bar for the plot. Default is
<code>0.5</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_size.shape">size.shape</code></td>
<td>
<p>The size of the shape (both for genotypes and
environments). Default is <code>3.5</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in axis text and labels.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_height.err.bar">height.err.bar</code></td>
<td>
<p>The height for error bar. Default is <code>0.3</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_x.lim">x.lim</code></td>
<td>
<p>The range of x-axis. Default is <code>NULL</code> (maximum and minimum
values of the data set). New arguments can be inserted as <code>x.lim = c(x.min, x.max)</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_x.breaks">x.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. New arguments can be inserted as <code>x.breaks = c(breaks)</code></p>
</td></tr>
<tr><td><code id="plot_blup_+3A_col.shape">col.shape</code></td>
<td>
<p>A vector of length 2 that contains the color of shapes for
genotypes above and below of the mean, respectively. Default is
<code>c("blue", "red")</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of the y-axis in the plot. Default is
<code>"Genotypes"</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of the x-axis in the plot. Default is <code>NULL</code>,
i.e., the name of the selected variable.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_n.dodge">n.dodge</code></td>
<td>
<p>The number of rows that should be used to render the Y labels.
This is useful for displaying labels that would otherwise overlap.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_check.overlap">check.overlap</code></td>
<td>
<p>Silently remove overlapping labels, (recursively)
prioritizing the first, last, and middle labels.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_panel.spacing">panel.spacing</code></td>
<td>
<p>Defines the spacing between panels when <code>which = "ge"</code>.</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_resolution">resolution</code></td>
<td>
<p>The resolution of the plot. Parameter valid if
<code>file.type = "tiff"</code> is used. Default is <code>300</code> (300 dpi)</p>
</td></tr>
<tr><td><code id="plot_blup_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_scores">plot_scores()</a></code>, <code><a href="#topic+plot_waasby">plot_waasby()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
BLUP &lt;- waasb(data_ge2,
              resp = PH,
              gen = GEN,
              env = ENV,
              rep = REP)
plot_blup(BLUP)
plot_blup(BLUP, which = "ge")




</code></pre>

<hr>
<h2 id='plot_ci'>Plot the confidence interval for correlation</h2><span id='topic+plot_ci'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function plots the 95% confidence interval for Pearson's correlation
coefficient generated by the function <code>corr_ci</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ci(
  object,
  fill = NULL,
  position.fill = 0.3,
  x.lab = NULL,
  y.lab = NULL,
  y.lim = NULL,
  y.breaks = waiver(),
  shape = 21,
  col.shape = "black",
  fill.shape = "orange",
  size.shape = 2.5,
  width.errbar = 0.2,
  main = TRUE,
  invert.axis = TRUE,
  reorder = TRUE,
  legend.position = "bottom",
  plot_theme = theme_metan()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ci_+3A_object">object</code></td>
<td>
<p>An object generate by the function <code>corr_ci()</code></p>
</td></tr>
<tr><td><code id="plot_ci_+3A_fill">fill</code></td>
<td>
<p>If <code>corr_ci()</code> is computed with the argument <code>by</code> use
<code>fill</code> to fill the shape by each level of the grouping variable
<code>by</code>.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_position.fill">position.fill</code></td>
<td>
<p>The position of shapes and errorbar when <code>fill</code> is used.
Defaults to <code>0.3</code>.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of x-axis, set to 'Pairwise combinations'. New
arguments can be inserted as <code>x.lab = 'my label'</code>.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of y-axis, set to 'Pearson's correlation coefficient'
New arguments can be inserted as <code>y.lab = 'my label'</code>.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_y.lim">y.lim</code></td>
<td>
<p>The range of x-axis. Default is <code>NULL</code>. The same arguments
than <code>x.lim</code> can be used.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_y.breaks">y.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. The same arguments than <code>x.breaks</code> can be
used.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_shape">shape</code></td>
<td>
<p>The shape point to represent the correlation coefficient.
Default is <code>21</code> (circle). Values must be between <code>21-25</code>:
<code>21</code> (circle), <code>22</code> (square), <code>23</code> (diamond), <code>24</code> (up
triangle), and <code>25</code> (low triangle).</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_col.shape">col.shape</code></td>
<td>
<p>The color for the shape edge. Set to <code>black</code>.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_fill.shape">fill.shape</code></td>
<td>
<p>The color to fill the shape. Set to <code>orange</code>.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_size.shape">size.shape</code></td>
<td>
<p>The size for the shape point. Set to <code>2.5</code>.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_width.errbar">width.errbar</code></td>
<td>
<p>The width for the errorbar showing the CI.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_main">main</code></td>
<td>
<p>The title of the plot. Set to <code>main = FALSE</code> to ommite the
plot title.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_invert.axis">invert.axis</code></td>
<td>
<p>Should the names of the pairwise correlation appear in the
y-axis?</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_reorder">reorder</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> (default) the pairwise
combinations are reordered according to the correlation coefficient.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_legend.position">legend.position</code></td>
<td>
<p>The position of the legend when using <code>fill</code> argument.
Defaults to <code>"bottom"</code>.</p>
</td></tr>
<tr><td><code id="plot_ci_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
library(dplyr)
# Traits that contains "E"
data_ge2 %&gt;%
  select(contains('E')) %&gt;%
  corr_ci() %&gt;%
  plot_ci()

# Group by environment
# Traits PH, EH, EP, EL, and ED
# Select only correlations with PH

data_ge2 %&gt;%
 corr_ci(PH, EP, EL, ED, CW,
         sel.var = "PH",
         by = ENV) %&gt;%
 plot_ci(fill = ENV)

</code></pre>

<hr>
<h2 id='plot_eigen'>Plot the eigenvalues</h2><span id='topic+plot_eigen'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Plot the eigenvalues for from singular value decomposition of BLUP
interaction effects matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_eigen(
  x,
  var = 1,
  export = FALSE,
  plot_theme = theme_metan(),
  file.type = "pdf",
  file.name = NULL,
  width = 6,
  height = 6,
  size.shape = 3.5,
  size.line = 1,
  size.tex.lab = 12,
  y.lab = "Eigenvalue",
  y2.lab = "Accumulated variance",
  x.lab = "Number of multiplicative terms",
  resolution = 300,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_eigen_+3A_x">x</code></td>
<td>
<p>The <code style="white-space: pre;">&#8288;waasb object&#8288;</code></p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_export">export</code></td>
<td>
<p>Export (or not) the plot. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_file.type">file.type</code></td>
<td>
<p>If <code>export = TRUE</code>, define the type of file to be
exported. Default is <code>pdf</code>, Graphic can also be exported in
<code style="white-space: pre;">&#8288;*.tiff&#8288;</code> format by declaring <code>file.type = "tiff"</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file for exportation, default is
<code>NULL</code>, i.e. the files are automatically named.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_width">width</code></td>
<td>
<p>The width &quot;inch&quot; of the plot. Default is <code>6</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_height">height</code></td>
<td>
<p>The height &quot;inch&quot; of the plot. Default is <code>6</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_size.shape">size.shape</code></td>
<td>
<p>The size of the shape. Default is <code>3.5</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in axis text and labels.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of the y-axis in the plot. Default is
<code>"Eigenvalue"</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_y2.lab">y2.lab</code></td>
<td>
<p>The label of the second y-axis in the plot. Default is
<code>"Accumulated variance"</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of the x-axis in the plot. Default is <code>"Number of multiplicative terms"</code>.</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_resolution">resolution</code></td>
<td>
<p>The resolution of the plot. Parameter valid if
<code>file.type = "tiff"</code> is used. Default is <code>300</code> (300 dpi)</p>
</td></tr>
<tr><td><code id="plot_eigen_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_scores">plot_scores()</a></code>, <code><a href="#topic+plot_waasby">plot_waasby()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
BLUP &lt;- waasb(data_ge,
             resp = c(GY, HM),
             gen = GEN,
             env = ENV,
             rep = REP)
plot_eigen(BLUP)



</code></pre>

<hr>
<h2 id='plot_scores'>Plot scores in different graphical interpretations</h2><span id='topic+plot_scores'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Plot scores of genotypes and environments in different graphical
interpretations.
</p>
<p>Biplots type 1 and 2 are well known in AMMI analysis. In the plot type 3, the
scores of both genotypes and environments are plotted considering the
response variable and the WAASB, an stability index that considers all
significant principal component axis of traditional AMMI models or all
principal component axis estimated with BLUP-interaction effects (Olivoto et
al. 2019). Plot type 4 may be used to better understand the well known
'which-won-where' pattern, facilitating the recommendation of appropriate
genotypes targeted for specific environments, thus allowing the exploitation
of narrow adaptations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_scores(
  x,
  var = 1,
  type = 1,
  first = "PC1",
  second = "PC2",
  repel = TRUE,
  repulsion = 1,
  max_overlaps = 20,
  polygon = FALSE,
  title = TRUE,
  plot_theme = theme_metan(),
  axis.expand = 1.1,
  x.lim = NULL,
  y.lim = NULL,
  x.breaks = waiver(),
  y.breaks = waiver(),
  x.lab = NULL,
  y.lab = NULL,
  shape.gen = 21,
  shape.env = 23,
  size.shape.gen = 2.2,
  size.shape.env = 2.2,
  size.bor.tick = 0.1,
  size.tex.lab = 12,
  size.tex.gen = 3.5,
  size.tex.env = 3.5,
  size.line = 0.5,
  size.segm.line = 0.5,
  col.bor.gen = "black",
  col.bor.env = "black",
  col.line = "black",
  col.gen = "blue",
  col.env = "forestgreen",
  col.alpha.gen = 1,
  col.alpha.env = 1,
  col.segm.gen = transparent_color(),
  col.segm.env = "forestgreen",
  highlight = NULL,
  col.highlight = "red",
  col.alpha.highlight = 1,
  size.tex.highlight = 5.5,
  size.shape.highlight = 3.2,
  leg.lab = c("Env", "Gen"),
  line.type = "solid",
  line.alpha = 0.9,
  resolution = deprecated(),
  file.type = "png",
  export = FALSE,
  file.name = NULL,
  width = 8,
  height = 7,
  color = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_scores_+3A_x">x</code></td>
<td>
<p>An object fitted with the functions <code><a href="#topic+performs_ammi">performs_ammi()</a></code>,
<code><a href="#topic+waas">waas()</a></code>, <code><a href="#topic+waas_means">waas_means()</a></code>, or <code><a href="#topic+waasb">waasb()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_type">type</code></td>
<td>
<p>type of biplot to produce
</p>

<ul>
<li> <p><code>type = 1</code> The default. Produces an AMMI1 biplot (Y x PC1) to make
inferences related to stability and productivity.
</p>
</li>
<li> <p><code>type = 2</code> Produces an AMMI2 biplot (PC1 x PC2) to make inferences
related to the interaction effects. Use the arguments <code>first</code> or
<code>second</code> to change the default IPCA shown in the plot.
</p>
</li>
<li> <p><code>type = 3</code> Valid for objects of class <code>waas</code> or <code>waasb</code>,
produces a biplot showing the GY x WAASB.
</p>
</li>
<li> <p><code>type = 4</code> Produces a plot with the Nominal yield x Environment PC.
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot_scores_+3A_first">first</code>, <code id="plot_scores_+3A_second">second</code></td>
<td>
<p>The IPCA to be shown in the first (x) and second (y)
axis. By default, IPCA1 is shown in the <code>x</code> axis and IPCA2 in the
<code>y</code> axis. For example, use <code>second = "PC3"</code> to shown the IPCA3 in
the <code>y</code> axis.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_repel">repel</code></td>
<td>
<p>If <code>TRUE</code> (default), the text labels repel away from each
other and away from the data points.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_repulsion">repulsion</code></td>
<td>
<p>Force of repulsion between overlapping text labels. Defaults
to <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_max_overlaps">max_overlaps</code></td>
<td>
<p>Exclude text labels that overlap too many things. Defaults to 20.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_polygon">polygon</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, a polygon is drawn when
<code>type = 2</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_title">title</code></td>
<td>
<p>Logical values (Defaults to <code>TRUE</code>) to include
automatically generated titles</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_axis.expand">axis.expand</code></td>
<td>
<p>Multiplication factor to expand the axis limits by to
enable fitting of labels. Default is <code>1.1</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_x.lim">x.lim</code>, <code id="plot_scores_+3A_y.lim">y.lim</code></td>
<td>
<p>The range of x and y axes, respectively. Default is
<code>NULL</code> (maximum and minimum values of the data set). New values can be
inserted as <code>x.lim = c(x.min, x.max)</code> or <code>y.lim = c(y.min, y.max)</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_x.breaks">x.breaks</code>, <code id="plot_scores_+3A_y.breaks">y.breaks</code></td>
<td>
<p>The breaks to be plotted in the x and y axes,
respectively. Defaults to <code>waiver()</code> (automatic breaks). New values
can be inserted, for example, as <code>x.breaks = c(0.1, 0.2, 0.3)</code> or
<code>x.breaks = seq(0, 1, by = 0.2)</code></p>
</td></tr>
<tr><td><code id="plot_scores_+3A_x.lab">x.lab</code>, <code id="plot_scores_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of x and y axes, respectively. Defaults to
<code>NULL</code>, i.e., each plot has a default axis label. New values can be
inserted as <code>x.lab = 'my label'</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_shape.gen">shape.gen</code>, <code id="plot_scores_+3A_shape.env">shape.env</code></td>
<td>
<p>The shape for genotypes and environments
indication in the biplot. Default is <code>21</code> (circle) for genotypes and
<code>23</code> (diamond) for environments. Values must be between <code>21-25</code>:
<code>21</code> (circle), <code>22</code> (square), <code>23</code> (diamond), <code>24</code> (up
triangle), and <code>25</code> (low triangle).</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_size.shape.gen">size.shape.gen</code>, <code id="plot_scores_+3A_size.shape.env">size.shape.env</code></td>
<td>
<p>The size of the shapes for genotypes and
environments respectively. Defaults to <code>2.2</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_size.bor.tick">size.bor.tick</code></td>
<td>
<p>The size of tick of shape. Default is <code>0.1</code>. The
size of the shape will be <code>max(size.shape.gen, size.shape.env) + size.bor.tick</code></p>
</td></tr>
<tr><td><code id="plot_scores_+3A_size.tex.lab">size.tex.lab</code>, <code id="plot_scores_+3A_size.tex.gen">size.tex.gen</code>, <code id="plot_scores_+3A_size.tex.env">size.tex.env</code></td>
<td>
<p>The size of the text for axis
labels (Defaults to 12), genotypes labels, and environments labels
(Defaults to 3.5).</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line that indicate the means in the biplot.
Default is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_size.segm.line">size.segm.line</code></td>
<td>
<p>The size of the segment that start in the origin of the
biplot and end in the scores values. Default is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_col.bor.gen">col.bor.gen</code>, <code id="plot_scores_+3A_col.bor.env">col.bor.env</code></td>
<td>
<p>The color of the shape's border for genotypes
and environments, respectively.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_col.line">col.line</code></td>
<td>
<p>The color of the line that indicate the means in the biplot.
Default is <code>'gray'</code></p>
</td></tr>
<tr><td><code id="plot_scores_+3A_col.gen">col.gen</code>, <code id="plot_scores_+3A_col.env">col.env</code></td>
<td>
<p>The shape color for genotypes (Defaults to
<code>'blue'</code>) and environments (<code>'forestgreen'</code>). Must be length
one or a vector of colors with the same length of the number of
genotypes/environments.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_col.alpha.gen">col.alpha.gen</code>, <code id="plot_scores_+3A_col.alpha.env">col.alpha.env</code></td>
<td>
<p>The alpha value for the color for
genotypes and environments, respectively. Defaults to <code>NA</code>. Values must be
between <code>0</code> (full transparency) to <code>1</code> (full color).</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_col.segm.gen">col.segm.gen</code>, <code id="plot_scores_+3A_col.segm.env">col.segm.env</code></td>
<td>
<p>The color of segment for genotypes (Defaults
to <code>transparent_color()</code>) and environments (Defaults to 'forestgreen'),
respectively. Valid arguments for plots with <code>type = 1</code> or <code>type = 2</code> graphics.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_highlight">highlight</code></td>
<td>
<p>Genotypes/environments to be highlight in the plot. Defaults
to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_col.highlight">col.highlight</code></td>
<td>
<p>The color for shape/labels when a value is provided in
<code>highlight.</code> Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_col.alpha.highlight">col.alpha.highlight</code></td>
<td>
<p>The alpha value for the color of the highlighted
genotypes. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_size.tex.highlight">size.tex.highlight</code></td>
<td>
<p>The size of the text for the highlighted genotypes.
Defaults to <code>5.5</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_size.shape.highlight">size.shape.highlight</code></td>
<td>
<p>The size of the shape for the highlighted
genotypes. Defaults to <code>3.2</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_leg.lab">leg.lab</code></td>
<td>
<p>The labs of legend. Default is <code>Gen</code> and <code>Env</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_line.type">line.type</code></td>
<td>
<p>The type of the line that indicate the means in the biplot.
Default is <code>'solid'</code>. Other values that can be attributed are:
<code>'blank'</code>, no lines in the biplot, <code style="white-space: pre;">&#8288;'dashed', 'dotted', 'dotdash', 'longdash', and 'twodash'&#8288;</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_line.alpha">line.alpha</code></td>
<td>
<p>The alpha value that combine the line with the background
to create the appearance of partial or full transparency. Default is
<code>0.4</code>. Values must be between '0' (full transparency) to '1' (full
color).</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_resolution">resolution</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_file.type">file.type</code></td>
<td>
<p>The type of file to be exported. Currently recognises the extensions
eps/ps, tex, pdf, jpeg, tiff, png (default), bmp, svg and wmf (windows only).</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_export">export</code></td>
<td>
<p>Export (or not) the plot. Default is <code>FALSE</code>. If <code>TRUE</code>, calls the
<code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code> function.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file for exportation, default is
<code>NULL</code>, i.e. the files are automatically named.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_width">width</code></td>
<td>
<p>The width 'inch' of the plot. Default is <code>8</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_height">height</code></td>
<td>
<p>The height 'inch' of the plot. Default is <code>7</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_color">color</code></td>
<td>
<p>Should type 4 plot have colors? Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_scores_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in multi-environment
trials I: Combining features of AMMI and BLUP techniques. Agron. J.
111:2949-2960. <a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_eigen">plot_eigen()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# AMMI model
model &lt;- waas(data_ge,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = everything())

# GY x PC1 for variable GY (default plot)
plot_scores(model)

# PC1 x PC2 (variable HM)
#
plot_scores(model,
            polygon = TRUE,            # Draw a convex hull polygon
            var = "HM",                # or var = 2 to select variable
            highlight = c("G1", "G2"), # Highlight genotypes 2 and 3
            type = 2)                  # type of biplot

# PC3 x PC4 (variable HM)
# Change size of plot fonts and colors
# Minimal theme
plot_scores(model,
           var = "HM",
           type = 2,
           first = "PC3",
           second = "PC4",
           col.gen = "black",
           col.env = "gray",
           col.segm.env = "gray",
           size.tex.gen = 5,
           size.tex.env = 2,
           size.tex.lab = 16,
           plot_theme = theme_metan_minimal())

# WAASB index
waasb_model &lt;- waasb(data_ge, ENV, GEN, REP, GY)

# GY x WAASB
# Highlight genotypes 2 and 8
plot_scores(waasb_model,
            type = 3,
            highlight = c("G2", "G8"))

</code></pre>

<hr>
<h2 id='plot_waasby'>Plot WAASBY values for genotype ranking</h2><span id='topic+plot_waasby'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Plot heat maps with genotype ranking in two ways.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_waasby(
  x,
  var = 1,
  export = F,
  file.type = "pdf",
  file.name = NULL,
  plot_theme = theme_metan(),
  width = 6,
  height = 6,
  size.shape = 3.5,
  size.tex.lab = 12,
  col.shape = c("blue", "red"),
  x.lab = "WAASBY",
  y.lab = "Genotypes",
  x.breaks = waiver(),
  resolution = 300,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_waasby_+3A_x">x</code></td>
<td>
<p>The <code style="white-space: pre;">&#8288;WAASBY object&#8288;</code></p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_export">export</code></td>
<td>
<p>Export (or not) the plot. Default is <code>T</code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_file.type">file.type</code></td>
<td>
<p>The type of file to be exported. Default is <code>pdf</code>,
Graphic can also be exported in <code style="white-space: pre;">&#8288;*.tiff&#8288;</code> format by declaring
<code>file.type = "tiff"</code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file for exportation, default is
<code>NULL</code>, i.e. the files are automatically named.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_width">width</code></td>
<td>
<p>The width &quot;inch&quot; of the plot. Default is <code>8</code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_height">height</code></td>
<td>
<p>The height &quot;inch&quot; of the plot. Default is <code>7</code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_size.shape">size.shape</code></td>
<td>
<p>The size of the shape in the plot. Default is <code>3.5</code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in axis text and labels.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_col.shape">col.shape</code></td>
<td>
<p>A vector of length 2 that contains the color of shapes for
genotypes above and below of the mean, respectively. Default is
<code>c("blue", "red")</code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of the x axis in the plot. Default is <code>"WAASBY"</code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of the y axis in the plot. Default is
<code>"Genotypes"</code>.</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_x.breaks">x.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. New arguments can be inserted as <code>x.breaks = c(breaks)</code></p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_resolution">resolution</code></td>
<td>
<p>The resolution of the plot. Parameter valid if
<code>file.type = "tiff"</code> is used. Default is <code>300</code> (300 dpi)</p>
</td></tr>
<tr><td><code id="plot_waasby_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_scores">plot_scores()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
library(ggplot2)
waasby &lt;- waasb(data_ge,
                resp = GY,
                gen = GEN,
                env = ENV,
                rep = REP)
waasby2 &lt;- waas(data_ge,
                resp = GY,
                gen = GEN,
                env = ENV,
                rep = REP)
plot_waasby(waasby)
plot_waasby(waasby2) +
            theme_gray() +
            theme(legend.position = "bottom",
                  legend.background = element_blank(),
                  legend.title = element_blank(),
                  legend.direction = "horizontal")


</code></pre>

<hr>
<h2 id='plot.anova_joint'>Several types of residual plots</h2><span id='topic+plot.anova_joint'></span>

<h3>Description</h3>

<p>Residual plots for a output model of class <code>anova_joint</code>. Seven types
of plots are produced: (1) Residuals vs fitted, (2) normal Q-Q plot for the
residuals, (3) scale-location plot (standardized residuals vs Fitted Values),
(4) standardized residuals vs Factor-levels, (5) Histogram of raw residuals
and (6) standardized residuals vs observation order, and (7) 1:1 line plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'anova_joint'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.anova_joint_+3A_x">x</code></td>
<td>
<p>An object of class <code>anova_joint</code>.</p>
</td></tr>
<tr><td><code id="plot.anova_joint_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to the function
<code><a href="#topic+residual_plots">residual_plots()</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- anova_joint(data_ge, ENV, GEN, REP, GY)
plot(model)
plot(model,
     which = c(3, 5),
     nrow = 2,
     labels = TRUE,
     size.lab.out = 4)


</code></pre>

<hr>
<h2 id='plot.can_cor'>Plots an object of class can_cor</h2><span id='topic+plot.can_cor'></span>

<h3>Description</h3>

<p>Graphs of the Canonical Correlation Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'can_cor'
plot(
  x,
  type = 1,
  plot_theme = theme_metan(),
  size.tex.lab = 12,
  size.tex.pa = 3.5,
  x.lab = NULL,
  x.lim = NULL,
  x.breaks = waiver(),
  y.lab = NULL,
  y.lim = NULL,
  y.breaks = waiver(),
  axis.expand = 1.1,
  shape = 21,
  col.shape = "orange",
  col.alpha = 0.9,
  size.shape = 3.5,
  size.bor.tick = 0.3,
  labels = FALSE,
  main = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.can_cor_+3A_x">x</code></td>
<td>
<p>The <code style="white-space: pre;">&#8288;waasb object&#8288;</code></p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_type">type</code></td>
<td>
<p>The type of the plot. Defaults to <code>type = 1</code> (Scree-plot of
the correlations of the canonical loadings). Use <code>type = 2</code>, to
produce a plot with the scores of the variables in the first group,
<code>type = 3</code> to produce a plot with the scores of the variables in the
second group, or <code>type = 4</code> to produce a circle of correlations.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details,see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in axis text and labels.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_size.tex.pa">size.tex.pa</code></td>
<td>
<p>The size of the text of the plot area. Default is
<code>3.5</code>.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of x-axis. Each plot has a default value. New
arguments can be inserted as <code>x.lab = 'my label'</code>.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_x.lim">x.lim</code></td>
<td>
<p>The range of x-axis. Default is <code>NULL</code> (maximum and minimum
values of the data set). New arguments can be inserted as <code>x.lim = c(x.min, x.max)</code>.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_x.breaks">x.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. New arguments can be inserted as <code>x.breaks = c(breaks)</code></p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of y-axis. Each plot has a default value. New
arguments can be inserted as <code>y.lab = 'my label'</code>.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_y.lim">y.lim</code></td>
<td>
<p>The range of y-axis. Default is <code>NULL</code>. The same arguments
than <code>x.lim</code> can be used.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_y.breaks">y.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. The same arguments than <code>x.breaks</code> can be
used.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_axis.expand">axis.expand</code></td>
<td>
<p>Multiplication factor to expand the axis limits by to
enable fitting of labels. Default is <code>1.1</code>.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_shape">shape</code></td>
<td>
<p>The shape of points in the plot. Default is <code>21</code> (circle).
Values must be between <code>21-25</code>: <code>21</code> (circle), <code>22</code>
(square), <code>23</code> (diamond), <code>24</code> (up triangle), and <code>25</code> (low
triangle).</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_col.shape">col.shape</code></td>
<td>
<p>A vector of length 2 that contains the color of shapes for
genotypes above and below of the mean, respectively. Defaults to
<code>"orange"</code>. <code>c("blue", "red")</code>.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_col.alpha">col.alpha</code></td>
<td>
<p>The alpha value for the color. Default is <code>0.9</code>. Values
must be between <code>0</code> (full transparency) to <code>1</code> (full color).</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_size.shape">size.shape</code></td>
<td>
<p>The size of the shape in the plot. Default is <code>3.5</code>.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_size.bor.tick">size.bor.tick</code></td>
<td>
<p>The size of tick of shape. Default is <code>0.3</code>. The
size of the shape will be <code>size.shape + size.bor.tick</code></p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_labels">labels</code></td>
<td>
<p>Logical arguments. If <code>TRUE</code> then the points in the plot
will have labels.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_main">main</code></td>
<td>
<p>The title of the plot. Defaults to <code>NULL</code>, in which each
plot will have a default title. Use a string text to create an own title or
set to <code>main = FALSE</code> to omit the plot title.</p>
</td></tr>
<tr><td><code id="plot.can_cor_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
cc1 = can_corr(data_ge2,
               FG = c(PH, EH, EP),
               SG = c(EL, ED, CL, CD, CW, KW, NR))
plot(cc1, 2)

cc2 &lt;-
data_ge2 %&gt;%
mean_by(GEN) %&gt;%
column_to_rownames("GEN") %&gt;%
can_corr(FG = c(PH, EH, EP),
               SG = c(EL, ED, CL, CD, CW, KW, NR))
plot(cc2, 2, labels = TRUE)



</code></pre>

<hr>
<h2 id='plot.clustering'>Plot an object of class clustering</h2><span id='topic+plot.clustering'></span>

<h3>Description</h3>

<p>Plot an object of class clustering
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clustering'
plot(x, horiz = TRUE, type = "dendrogram", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.clustering_+3A_x">x</code></td>
<td>
<p>An object of class <code>clustering</code></p>
</td></tr>
<tr><td><code id="plot.clustering_+3A_horiz">horiz</code></td>
<td>
<p>Logical indicating if the dendrogram should be drawn
horizontally or not.</p>
</td></tr>
<tr><td><code id="plot.clustering_+3A_type">type</code></td>
<td>
<p>The type of plot. Must be one of the 'dendrogram' or
'cophenetic'.</p>
</td></tr>
<tr><td><code id="plot.clustering_+3A_...">...</code></td>
<td>
<p>Other arguments passed from the function <code>plot.dendrogram</code> or
<code>abline</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code> if <code>type == "cophenetic"</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mean_gen &lt;-
 data_ge2 %&gt;%
 mean_by(GEN) %&gt;%
 column_to_rownames("GEN")

d &lt;- clustering(mean_gen)
plot(d, xlab = "Euclidean Distance")

</code></pre>

<hr>
<h2 id='plot.corr_coef'>Create a correlation heat map</h2><span id='topic+plot.corr_coef'></span>

<h3>Description</h3>

<p>Create a correlation heat map for object of class <code>corr_coef</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'corr_coef'
plot(
  x,
  type = "lower",
  diag = FALSE,
  reorder = TRUE,
  signif = c("stars", "pval"),
  show = c("all", "signif"),
  p_val = 0.05,
  caption = TRUE,
  digits.cor = 2,
  digits.pval = 3,
  col.low = "red",
  col.mid = "white",
  col.high = "blue",
  lab.x.position = NULL,
  lab.y.position = NULL,
  legend.position = NULL,
  legend.title = "Pearson's\nCorrelation",
  size.text.cor = 3,
  size.text.signif = 3,
  size.text.lab = 10,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.corr_coef_+3A_x">x</code></td>
<td>
<p>The data set.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_type">type</code></td>
<td>
<p>The type of heat map to produce. Either <code>lower</code> (default) to
produce a lower triangle heat map or <code>upper</code> to produce an upper
triangular heat map.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_diag">diag</code></td>
<td>
<p>Plot diagonal elements? Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_reorder">reorder</code></td>
<td>
<p>Reorder the correlation matrix to identify the hidden pattern?
Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_signif">signif</code></td>
<td>
<p>How to show significant correlations. If <code>"stars"</code> is used
(default), stars are used showing the significance at 0.05 (&quot;<em>&quot;), 0.01
(&quot;<strong>&quot;) and 0.001 (&quot;</strong></em>&quot;) probability error. If <code>signif = "pval"</code>, then
the p-values are shown.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_show">show</code></td>
<td>
<p>The correlations to show. Either <code>all</code> (default) or <code>signif</code>
(only significant correlations).</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_p_val">p_val</code></td>
<td>
<p>The p-value to the correlation significance.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_caption">caption</code></td>
<td>
<p>Logical. If <code>TRUE</code> (Default) includes a caption with the
significance meaning for stars.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_digits.cor">digits.cor</code>, <code id="plot.corr_coef_+3A_digits.pval">digits.pval</code></td>
<td>
<p>The significant digits to show for correlations
and p-values, respectively.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_col.low">col.low</code>, <code id="plot.corr_coef_+3A_col.mid">col.mid</code>, <code id="plot.corr_coef_+3A_col.high">col.high</code></td>
<td>
<p>The color for the low (-1), mid(0) and high
(1) points in the color key. Defaults to <code>blue</code>, <code>white</code>, and
<code>red</code>, respectively.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_lab.x.position">lab.x.position</code>, <code id="plot.corr_coef_+3A_lab.y.position">lab.y.position</code></td>
<td>
<p>The position of the x and y axis label.
Defaults to <code>"bottom"</code> and <code>"right"</code> if <code>type = "lower"</code> or
<code>"top"</code> and <code>"left"</code> if <code>type = "upper"</code>.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_legend.position">legend.position</code></td>
<td>
<p>The legend position in the plot.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_legend.title">legend.title</code></td>
<td>
<p>The title of the color key. Defaults to <code>"Pearson's Correlation"</code>.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_size.text.cor">size.text.cor</code></td>
<td>
<p>The size of the text for correlation values. Defaults to 3.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_size.text.signif">size.text.signif</code></td>
<td>
<p>The size of the text for significance values (stars or p-values). Defaults to 3.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_size.text.lab">size.text.lab</code></td>
<td>
<p>The size of the text for labels. Defaults to 10.</p>
</td></tr>
<tr><td><code id="plot.corr_coef_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# All numeric variables
x &lt;- corr_coef(data_ge2)
plot(x)
plot(x, reorder = FALSE)

# Select variables
sel &lt;- corr_coef(data_ge2, EP, EL, CD, CL)
plot(sel,
     type = "upper",
     reorder = FALSE,
     size.text.lab = 14,
     size.text.plot = 5)

</code></pre>

<hr>
<h2 id='plot.correlated_vars'>Plot an object of class correlated_vars</h2><span id='topic+plot.correlated_vars'></span>

<h3>Description</h3>

<p>Plot an object of class correlated_vars
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'correlated_vars'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.correlated_vars_+3A_x">x</code></td>
<td>
<p>An object of class correlated_vars.</p>
</td></tr>
<tr><td><code id="plot.correlated_vars_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class gg.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
y &lt;- rnorm(n = 10)
cor_vars &lt;- correlated_vars(y, nvar = 6)
plot(cor_vars)

</code></pre>

<hr>
<h2 id='plot.cvalidation'>Plot the RMSPD of a cross-validation procedure</h2><span id='topic+plot.cvalidation'></span>

<h3>Description</h3>

<p>Boxplot showing the Root Means Square Prediction Difference of of a cross
validation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cvalidation'
plot(
  x,
  violin = FALSE,
  export = FALSE,
  order_box = FALSE,
  x.lab = NULL,
  y.lab = NULL,
  size.tex.lab = 12,
  file.type = "pdf",
  file.name = NULL,
  plot_theme = theme_metan(),
  width = 6,
  height = 6,
  resolution = 300,
  col.violin = "gray90",
  col.boxplot = "gray70",
  col.boxplot.win = "cyan",
  width.boxplot = 0.6,
  x.lim = NULL,
  x.breaks = waiver(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cvalidation_+3A_x">x</code></td>
<td>
<p>An object of class <code>cvalidation</code> fitted with the functions
<code><a href="#topic+cv_ammi">cv_ammi()</a></code>, <code><a href="#topic+cv_ammif">cv_ammif()</a></code>, <code><a href="#topic+cv_blup">cv_blup()</a></code>, or a
bound object fitted with <code><a href="#topic+bind_cv">bind_cv()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_violin">violin</code></td>
<td>
<p>Define if a violin plot is used with boxplot. Default is 'TRUE'</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_export">export</code></td>
<td>
<p>Export (or not) the plot. Default is <code>T</code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_order_box">order_box</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> then the boxplots will be
ordered according to the values of the RMSPD.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of x-axis. New arguments can be inserted as
<code>x.lab = 'my x label'</code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of y-axis. New arguments can be inserted as
<code>y.lab = 'my y label'</code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in axis text and labels.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_file.type">file.type</code></td>
<td>
<p>The type of file to be exported. Default is <code>pdf</code>,
Graphic can also be exported in <code style="white-space: pre;">&#8288;*.tiff&#8288;</code> format by declaring
<code>file.type = 'tiff'</code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file for exportation, default is
<code>NULL</code>, i.e. the files are automatically named.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details,see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_width">width</code></td>
<td>
<p>The width 'inch' of the plot. Default is <code>6</code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_height">height</code></td>
<td>
<p>The height 'inch' of the plot. Default is <code>6</code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_resolution">resolution</code></td>
<td>
<p>The resolution of the plot. Parameter valid if
<code>file.type = 'tiff'</code> is used. Default is <code>300</code> (300 dpi)</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_col.violin">col.violin</code></td>
<td>
<p>Parameter valid if <code>violin = T</code>. Define the color of
the violin plot. Default is 'gray90.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_col.boxplot">col.boxplot</code></td>
<td>
<p>Define the color for boxplot. Default is 'gray70'.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_col.boxplot.win">col.boxplot.win</code></td>
<td>
<p>Define the color for boxplot of the best model.
Default is 'cyan'.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_width.boxplot">width.boxplot</code></td>
<td>
<p>The width of boxplots. Default is <code>0.2</code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_x.lim">x.lim</code></td>
<td>
<p>The range of x-axis. Default is <code>NULL</code> (maximum and minimum
values of the data set). New arguments can be inserted as <code>x.lim = c(x.min, x.max)</code>.</p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_x.breaks">x.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. New arguments can be inserted as <code>x.breaks = c(breaks)</code></p>
</td></tr>
<tr><td><code id="plot.cvalidation_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Five statistics are shown in this type of plot. The lower and upper hinges
correspond to the first and third quartiles (the 25th and 75th percentiles).
The upper whisker extends from the hinge to the largest value no further than
1.5 * IQR from the hinge (where IQR is the inter-quartile range). The lower
whisker extends from the hinge to the smallest value at most 1.5 * IQR of the
hinge. Data beyond the end of the whiskers are considered outlying points.
</p>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

validation &lt;- cv_ammif(data_ge2,
                       resp = EH,
                       gen = GEN,
                       env = ENV,
                       rep = REP,
                       nboot = 5)
plot(validation)



</code></pre>

<hr>
<h2 id='plot.env_dissimilarity'>Plot an object of class env_dissimilarity</h2><span id='topic+plot.env_dissimilarity'></span>

<h3>Description</h3>

<p>Create dendrograms to show the dissimilarity between environments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'env_dissimilarity'
plot(x, var = 1, nclust = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.env_dissimilarity_+3A_x">x</code></td>
<td>
<p>An object of class <code>env_dissimilarity</code></p>
</td></tr>
<tr><td><code id="plot.env_dissimilarity_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.env_dissimilarity_+3A_nclust">nclust</code></td>
<td>
<p>The number of clusters to show.</p>
</td></tr>
<tr><td><code id="plot.env_dissimilarity_+3A_...">...</code></td>
<td>
<p>Other arguments bo be passed to the function <code><a href="stats.html#topic+hclust">stats::hclust()</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mod &lt;- env_dissimilarity(data_ge, ENV, GEN, REP, GY)
plot(mod)

</code></pre>

<hr>
<h2 id='plot.env_stratification'>Plot the env_stratification model</h2><span id='topic+plot.env_stratification'></span>

<h3>Description</h3>

<p>This function plots the correlation between environments generated with
<code><a href="#topic+env_stratification">env_stratification()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'env_stratification'
plot(x, var = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.env_stratification_+3A_x">x</code></td>
<td>
<p>An object of class <code>env_stratification</code></p>
</td></tr>
<tr><td><code id="plot.env_stratification_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.env_stratification_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="#topic+plot.corr_coef">plot.corr_coef()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+env_dissimilarity">env_dissimilarity()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;-
env_stratification(data_ge,
                   env = ENV,
                   gen = GEN,
                   resp = GY)
plot(model)

</code></pre>

<hr>
<h2 id='plot.fai_blup'>Multi-trait selection index</h2><span id='topic+plot.fai_blup'></span>

<h3>Description</h3>

<p>Plot the multitrait index based on factor analysis and ideotype-design
proposed by Rocha et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fai_blup'
plot(
  x,
  ideotype = 1,
  SI = 15,
  radar = TRUE,
  arrange.label = FALSE,
  size.point = 2.5,
  size.line = 0.7,
  size.text = 10,
  col.sel = "red",
  col.nonsel = "black",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.fai_blup_+3A_x">x</code></td>
<td>
<p>An object of class <code>waasb</code></p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_ideotype">ideotype</code></td>
<td>
<p>The ideotype to be plotted. Default is 1.</p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_si">SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_radar">radar</code></td>
<td>
<p>Logical argument. If true (default) a radar plot is generated
after using <code>coord_polar()</code>.</p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_arrange.label">arrange.label</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, the labels are
arranged to avoid text overlapping. This becomes useful when the number of
genotypes is large, say, more than 30.</p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_size.point">size.point</code></td>
<td>
<p>The size of the point in graphic. Defaults to 2.5.</p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line in graphic. Defaults to 0.7.</p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_size.text">size.text</code></td>
<td>
<p>The size for the text in the plot. Defaults to 10.</p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_col.sel">col.sel</code></td>
<td>
<p>The colour for selected genotypes. Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_col.nonsel">col.nonsel</code></td>
<td>
<p>The colour for nonselected genotypes. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="plot.fai_blup_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed from ggplot2::theme().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Rocha, J.R.A.S.C.R, J.C. Machado, and P.C.S. Carneiro. 2018. Multitrait index
based on factor analysis and ideotype-design: proposal and application on
elephant grass breeding for bioenergy. GCB Bioenergy 10:52-60.
<a href="https://doi.org/10.1111/gcbb.12443">doi:10.1111/gcbb.12443</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

mod &lt;- waasb(data_ge,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = c(GY, HM))

FAI &lt;- fai_blup(mod,
                DI = c('max, max'),
                UI = c('min, min'))
plot(FAI)


</code></pre>

<hr>
<h2 id='plot.gafem'>Several types of residual plots</h2><span id='topic+plot.gafem'></span>

<h3>Description</h3>

<p>Residual plots for a output model of class <code>gafem</code>. Seven types
of plots are produced: (1) Residuals vs fitted, (2) normal Q-Q plot for the
residuals, (3) scale-location plot (standardized residuals vs Fitted Values),
(4) standardized residuals vs Factor-levels, (5) Histogram of raw residuals
and (6) standardized residuals vs observation order, and (7) 1:1 line plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gafem'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gafem_+3A_x">x</code></td>
<td>
<p>An object of class <code>gafem</code>.</p>
</td></tr>
<tr><td><code id="plot.gafem_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to the function
<code><a href="#topic+residual_plots">residual_plots()</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- gafem(data_g, GEN, REP, PH)

plot(model)
plot(model,
     which = c(3, 5),
     nrow = 2,
     labels = TRUE,
     size.lab.out = 4)


</code></pre>

<hr>
<h2 id='plot.gamem'>Several types of residual plots</h2><span id='topic+plot.gamem'></span>

<h3>Description</h3>

<p>Residual plots for a output model of class <code>gamem</code>. Six types of plots
are produced: (1) Residuals vs fitted, (2) normal Q-Q plot for the residuals,
(3) scale-location plot (standardized residuals vs Fitted Values), (4)
standardized residuals vs Factor-levels, (5) Histogram of raw residuals and
(6) standardized residuals vs observation order. For a <code>waasb</code> object,
normal Q-Q plot for random effects may also be obtained declaring <code>type = 're'</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamem'
plot(
  x,
  var = 1,
  type = "res",
  position = "fill",
  rotate = FALSE,
  conf = 0.95,
  out = "print",
  n.dodge = 1,
  check.overlap = FALSE,
  labels = FALSE,
  plot_theme = theme_metan(),
  alpha = 0.2,
  fill.hist = "gray",
  col.hist = "black",
  col.point = "black",
  col.line = "red",
  col.lab.out = "red",
  size.line = 0.7,
  size.text = 10,
  width.bar = 0.75,
  size.lab.out = 2.5,
  size.tex.lab = 10,
  size.shape = 1.5,
  bins = 30,
  which = c(1:4),
  ncol = NULL,
  nrow = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gamem_+3A_x">x</code></td>
<td>
<p>An object of class <code>gamem</code>.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_type">type</code></td>
<td>
<p>One of the <code>"res"</code> to plot the model residuals (default),
<code>type = 're'</code> to plot normal Q-Q plots for the random effects, or
<code>"vcomp"</code> to create a bar plot with the variance components.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_position">position</code></td>
<td>
<p>The position adjustment when <code>type = "vcomp"</code>. Defaults
to <code>"fill"</code>, which shows relative proportions at each trait by
stacking the bars and then standardizing each bar to have the same height.
Use <code>position = "stack"</code> to plot the phenotypic variance for each
trait.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_rotate">rotate</code></td>
<td>
<p>Logical argument. If <code>rotate = TRUE</code> the plot is rotated,
i.e., traits in y axis and value in the x axis.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_conf">conf</code></td>
<td>
<p>Level of confidence interval to use in the Q-Q plot (0.95 by
default).</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_out">out</code></td>
<td>
<p>How the output is returned. Must be one of the 'print' (default)
or 'return'.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_n.dodge">n.dodge</code></td>
<td>
<p>The number of rows that should be used to render the x labels.
This is useful for displaying labels that would otherwise overlap.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_check.overlap">check.overlap</code></td>
<td>
<p>Silently remove overlapping labels, (recursively)
prioritizing the first, last, and middle labels.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_labels">labels</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> labels the points outside
confidence interval limits.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_alpha">alpha</code></td>
<td>
<p>The transparency of confidence band in the Q-Q plot. Must be a
number between 0 (opaque) and 1 (full transparency).</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_fill.hist">fill.hist</code></td>
<td>
<p>The color to fill the histogram. Default is 'gray'.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_col.hist">col.hist</code></td>
<td>
<p>The color of the border of the the histogram. Default is
'black'.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_col.point">col.point</code></td>
<td>
<p>The color of the points in the graphic. Default is 'black'.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_col.line">col.line</code></td>
<td>
<p>The color of the lines in the graphic. Default is 'red'.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_col.lab.out">col.lab.out</code></td>
<td>
<p>The color of the labels for the 'outlying' points.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line in graphic. Defaults to 0.7.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_size.text">size.text</code></td>
<td>
<p>The size for the text in the plot. Defaults to 10.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_width.bar">width.bar</code></td>
<td>
<p>The width of the bars if <code>type = "contribution"</code>.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_size.lab.out">size.lab.out</code></td>
<td>
<p>The size of the labels for the 'outlying' points.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in axis text and labels.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_size.shape">size.shape</code></td>
<td>
<p>The size of the shape in the plots.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_bins">bins</code></td>
<td>
<p>The number of bins to use in the histogram. Default is 30.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_which">which</code></td>
<td>
<p>Which graphics should be plotted. Default is <code>which = c(1:4)</code> that means that the first four graphics will be plotted.</p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_ncol">ncol</code>, <code id="plot.gamem_+3A_nrow">nrow</code></td>
<td>
<p>The number of columns and rows of the plot pannel. Defaults
to <code>NULL</code></p>
</td></tr>
<tr><td><code id="plot.gamem_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to the function
<code><a href="patchwork.html#topic+wrap_plots">patchwork::wrap_plots()</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- gamem(data_g,
               gen = GEN,
               rep = REP,
               resp = PH)
plot(model)


</code></pre>

<hr>
<h2 id='plot.ge_cluster'>Plot an object of class ge_cluster</h2><span id='topic+plot.ge_cluster'></span>

<h3>Description</h3>

<p>Plot an object of class ge_cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ge_cluster'
plot(x, nclust = NULL, xlab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ge_cluster_+3A_x">x</code></td>
<td>
<p>An object of class <code>ge_cluster</code></p>
</td></tr>
<tr><td><code id="plot.ge_cluster_+3A_nclust">nclust</code></td>
<td>
<p>The number of clusters to show.</p>
</td></tr>
<tr><td><code id="plot.ge_cluster_+3A_xlab">xlab</code></td>
<td>
<p>The label of the x axis.</p>
</td></tr>
<tr><td><code id="plot.ge_cluster_+3A_...">...</code></td>
<td>
<p>Other arguments passed from the function <code>plot.hclust</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>

<hr>
<h2 id='plot.ge_effects'>Plot an object of class ge_effects</h2><span id='topic+plot.ge_effects'></span>

<h3>Description</h3>

<p>Plot the regression model generated by the function <code>ge_effects</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ge_effects'
plot(
  x,
  var = 1,
  plot_theme = theme_metan(),
  x.lab = NULL,
  y.lab = NULL,
  leg.position = "right",
  size.text = 12,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ge_effects_+3A_x">x</code></td>
<td>
<p>An object of class <code>ge_effects</code></p>
</td></tr>
<tr><td><code id="plot.ge_effects_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_effects_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.ge_effects_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of x-axis. Each plot has a default value. New
arguments can be inserted as <code>x.lab = "my label"</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_effects_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of y-axis. Each plot has a default value. New
arguments can be inserted as <code>y.lab = "my label"</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_effects_+3A_leg.position">leg.position</code></td>
<td>
<p>The position of the legend.</p>
</td></tr>
<tr><td><code id="plot.ge_effects_+3A_size.text">size.text</code></td>
<td>
<p>The size of the text in the axes text and labels. Default
is <code>12</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_effects_+3A_...">...</code></td>
<td>
<p>Current not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ge_plot">ge_plot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
ge_eff &lt;- ge_effects(data_ge2, ENV, GEN, PH)
plot(ge_eff)


</code></pre>

<hr>
<h2 id='plot.ge_factanal'>Plot the ge_factanal model</h2><span id='topic+plot.ge_factanal'></span>

<h3>Description</h3>

<p>This function plot the scores for genotypes obtained in the factor analysis
to interpret the stability
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ge_factanal'
plot(
  x,
  var = 1,
  plot_theme = theme_metan(),
  x.lim = NULL,
  x.breaks = waiver(),
  x.lab = NULL,
  y.lim = NULL,
  y.breaks = waiver(),
  y.lab = NULL,
  shape = 21,
  col.shape = "gray30",
  col.alpha = 1,
  size.shape = 2.2,
  size.bor.tick = 0.3,
  size.tex.lab = 12,
  size.tex.pa = 3.5,
  force.repel = 1,
  line.type = "dashed",
  line.alpha = 1,
  col.line = "black",
  size.line = 0.5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ge_factanal_+3A_x">x</code></td>
<td>
<p>An object of class <code>ge_factanal</code></p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_x.lim">x.lim</code></td>
<td>
<p>The range of x-axis. Default is <code>NULL</code> (maximum and minimum
values of the data set). New arguments can be inserted as <code>x.lim = c(x.min, x.max)</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_x.breaks">x.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. New arguments can be inserted as <code>x.breaks = c(breaks)</code></p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of x-axis. Each plot has a default value. New
arguments can be inserted as <code>x.lab = "my label"</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_y.lim">y.lim</code></td>
<td>
<p>The range of x-axis. Default is <code>NULL</code>. The same arguments
than <code>x.lim</code> can be used.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_y.breaks">y.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. The same arguments than <code>x.breaks</code> can be
used.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of y-axis. Each plot has a default value. New
arguments can be inserted as <code>y.lab = "my label"</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_shape">shape</code></td>
<td>
<p>The shape for genotype indication in the plot. Default is
<code>1</code> (circle). Values between  <code>21-25</code>: <code>21</code> (circle),
<code>22</code> (square), <code>23</code> (diamond), <code>24</code> (up triangle), and
<code>25</code> (low triangle) allows a color for fill the shape.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_col.shape">col.shape</code></td>
<td>
<p>The shape color for genotypes. Must be one value or a vector
of colors with the same length of the number of genotypes. Default is
<code>"gray30"</code>. Other values can be attributed. For example,
<code>transparent_color()</code>, will make a plot with only an outline around the
shape area.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_col.alpha">col.alpha</code></td>
<td>
<p>The alpha value for the color. Default is <code>1</code>. Values
must be between <code>0</code> (full transparency) to <code>1</code> (full color).</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_size.shape">size.shape</code></td>
<td>
<p>The size of the shape (both for genotypes and
environments). Default is <code>2.2</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_size.bor.tick">size.bor.tick</code></td>
<td>
<p>The size of tick of shape. Default is <code>0.3</code>. The
size of the shape will be <code>size.shape + size.bor.tick</code></p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in the axes text and labels. Default
is <code>12</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_size.tex.pa">size.tex.pa</code></td>
<td>
<p>The size of the text of the plot area. Default is
<code>3.5</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_force.repel">force.repel</code></td>
<td>
<p>Force of repulsion between overlapping text labels.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_line.type">line.type</code></td>
<td>
<p>The type of the line that indicate the means in the biplot.
Default is <code>"solid"</code>. Other values that can be attributed are:
<code>"blank"</code>, no lines in the biplot, <code style="white-space: pre;">&#8288;"dashed", "dotted", "dotdash", "longdash", and "twodash"&#8288;</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_line.alpha">line.alpha</code></td>
<td>
<p>The alpha value that combine the line with the background
to create the appearance of partial or full transparency. Default is
<code>0.4</code>. Values must be between &quot;0&quot; (full transparency) to &quot;1&quot; (full
color).</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_col.line">col.line</code></td>
<td>
<p>The color of the line that indicate the means in the biplot.
Default is <code>"gray"</code></p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line that indicate the means in the biplot.
Default is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_factanal_+3A_...">...</code></td>
<td>
<p>Currently not used..</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ge_factanal">ge_factanal()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
library(ggplot2)
model = ge_factanal(data_ge2,
                    env = ENV,
                    gen = GEN,
                    rep = REP,
                    resp = PH)
plot(model)

plot(model,
     size.shape = 3,
     force.repel = 10,
     col.shape = "orange",
     col.line = "red")

</code></pre>

<hr>
<h2 id='plot.ge_reg'>Plot an object of class ge_reg</h2><span id='topic+plot.ge_reg'></span>

<h3>Description</h3>

<p>Plot the regression model generated by the function <code>ge_reg</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ge_reg'
plot(
  x,
  var = 1,
  type = 1,
  plot_theme = theme_metan(),
  x.lim = NULL,
  x.breaks = waiver(),
  x.lab = NULL,
  y.lim = NULL,
  y.breaks = waiver(),
  y.lab = NULL,
  leg.position = "right",
  size.tex.lab = 12,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ge_reg_+3A_x">x</code></td>
<td>
<p>An object of class <code>ge_factanal</code></p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_type">type</code></td>
<td>
<p>The type of plot to show. <code>type = 1</code> produces a plot with
the environmental index in the x axis and the genotype mean yield in the y
axis. <code>type = 2</code> produces a plot with the response variable in the x
axis and the slope/deviations of the regression in the y axis.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_x.lim">x.lim</code></td>
<td>
<p>The range of x-axis. Default is <code>NULL</code> (maximum and minimum
values of the data set). New arguments can be inserted as <code>x.lim = c(x.min, x.max)</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_x.breaks">x.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. New arguments can be inserted as <code>x.breaks = c(breaks)</code></p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of x-axis. Each plot has a default value. New
arguments can be inserted as <code>x.lab = "my label"</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_y.lim">y.lim</code></td>
<td>
<p>The range of x-axis. Default is <code>NULL</code>. The same arguments
than <code>x.lim</code> can be used.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_y.breaks">y.breaks</code></td>
<td>
<p>The breaks to be plotted in the x-axis. Default is
<code style="white-space: pre;">&#8288;authomatic breaks&#8288;</code>. The same arguments than <code>x.breaks</code> can be
used.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of y-axis. Each plot has a default value. New
arguments can be inserted as <code>y.lab = "my label"</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_leg.position">leg.position</code></td>
<td>
<p>The position of the legend.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in the axes text and labels. Default
is <code>12</code>.</p>
</td></tr>
<tr><td><code id="plot.ge_reg_+3A_...">...</code></td>
<td>
<p>Currently not used..</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ge_factanal">ge_factanal()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- ge_reg(data_ge2, ENV, GEN, REP, PH)
plot(model)


</code></pre>

<hr>
<h2 id='plot.gge'>Create GGE, GT or GYT biplots</h2><span id='topic+plot.gge'></span>

<h3>Description</h3>

<p>Produces a ggplot2-based GGE-GT-GYT biplot based on a model fitted with the
functions <code><a href="#topic+gge">gge()</a></code>, <code><a href="#topic+gtb">gtb()</a></code>, and <code><a href="#topic+gytb">gytb()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gge'
plot(
  x,
  var = 1,
  type = 1,
  repel = TRUE,
  repulsion = 1,
  max_overlaps = 20,
  sel_env = NA,
  sel_gen = NA,
  sel_gen1 = NA,
  sel_gen2 = NA,
  shape.gen = 21,
  shape.env = 23,
  line.type.gen = "dotted",
  size.shape = 2.2,
  size.shape.win = 3.2,
  size.stroke = 0.3,
  col.stroke = "black",
  col.gen = "blue",
  col.env = "forestgreen",
  col.line = "forestgreen",
  col.alpha = 1,
  col.circle = "gray",
  col.alpha.circle = 0.5,
  leg.lab = NULL,
  size.text.gen = 3.5,
  size.text.env = 3.5,
  size.text.lab = 12,
  size.text.win = 4.5,
  size.line = 0.5,
  axis_expand = 1.2,
  title = TRUE,
  plot_theme = theme_metan(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gge_+3A_x">x</code></td>
<td>
<p>An object with classes <code>gge</code> <code>gtb</code>, or <code>gytb</code>.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_var">var</code></td>
<td>
<p>The variable to plot (useful for <code>gge</code> objects. Defaults to
<code>var = 1</code> the first variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_type">type</code></td>
<td>
<p>The type of biplot to produce.
</p>

<ol>
<li><p> Basic biplot.
</p>
</li>
<li><p> Mean performance vs. stability (gge biplots) or the The Average Tester
Coordination view for genotype-trait and genotype-yield*trait biplots.
</p>
</li>
<li><p> Which-won-where.
</p>
</li>
<li><p> Discriminativeness vs. representativeness.
</p>
</li>
<li><p> Examine an environment (or trait/yield*trait combination).
</p>
</li>
<li><p> Ranking environments (or trait/yield*trait combination).
</p>
</li>
<li><p> Examine a genotype.
</p>
</li>
<li><p> Ranking genotypes.
</p>
</li>
<li><p> Compare two genotypes.
</p>
</li>
<li><p> Relationship among environments (or trait/yield*trait combination).
</p>
</li></ol>
</td></tr>
<tr><td><code id="plot.gge_+3A_repel">repel</code></td>
<td>
<p>If <code>TRUE</code> (default), the text labels repel away from each
other and away from the data points.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_repulsion">repulsion</code></td>
<td>
<p>Force of repulsion between overlapping text labels. Defaults
to <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_max_overlaps">max_overlaps</code></td>
<td>
<p>Exclude text labels that overlap too many things.
Defaults to 20.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_sel_env">sel_env</code>, <code id="plot.gge_+3A_sel_gen">sel_gen</code></td>
<td>
<p>The name of the environment (or trait/yield*trait
combination) and genotype to examine when <code>type = 5</code> and   <code>type = 7</code>,
respectively. Must be a string which matches a environment or genotype
label.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_sel_gen1">sel_gen1</code>, <code id="plot.gge_+3A_sel_gen2">sel_gen2</code></td>
<td>
<p>The name of genotypes to compare between when
<code>type = 9</code>. Must be a string present in the genotype's name.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_shape.gen">shape.gen</code>, <code id="plot.gge_+3A_shape.env">shape.env</code></td>
<td>
<p>The shape for genotype and environment indication
in the biplot. Defaults to <code>shape.gen = 21</code> (circle) for genotypes and
<code>shape.env = 23</code> (rhombus) for environments. Values must be between
<code>21-25</code>: <code>21</code> (circle), <code>22</code> (square), <code>23</code> (rhombus),
<code>24</code> (up triangle), and <code>25</code> (low triangle).</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_line.type.gen">line.type.gen</code></td>
<td>
<p>The line type to highlith the genotype's vectors.
Defaults to <code style="white-space: pre;">&#8288;line.type.gen == "dotted&#8288;</code>.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_size.shape">size.shape</code></td>
<td>
<p>The size of the shape (both for genotypes and
environments). Defaults to <code>2.2</code>.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_size.shape.win">size.shape.win</code></td>
<td>
<p>The size of the shape for winners genotypes when
<code>type = 3</code>. Defaults to <code>3.2</code>.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_size.stroke">size.stroke</code>, <code id="plot.gge_+3A_col.stroke">col.stroke</code></td>
<td>
<p>The width and color of the border,
respectively. Default to <code>size.stroke = 0.3</code> and <code>col.stroke = "black"</code>. The size of the shape will be <code>size.shape + size.stroke</code></p>
</td></tr>
<tr><td><code id="plot.gge_+3A_col.gen">col.gen</code>, <code id="plot.gge_+3A_col.env">col.env</code>, <code id="plot.gge_+3A_col.line">col.line</code></td>
<td>
<p>Color for genotype/environment labels and for
the line that passes through the biplot origin. Defaults to <code>col.gen = 'blue'</code>, <code>col.env = 'forestgreen'</code>, and <code>col.line = 'forestgreen'</code>.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_col.alpha">col.alpha</code></td>
<td>
<p>The alpha value for the color. Defaults to <code>1</code>. Values
must be between <code>0</code> (full transparency) to <code>1</code> (full color).</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_col.circle">col.circle</code>, <code id="plot.gge_+3A_col.alpha.circle">col.alpha.circle</code></td>
<td>
<p>The color and alpha values for the circle
lines. Defaults to <code>'gray'</code> and <code>0.4</code>, respectively.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_leg.lab">leg.lab</code></td>
<td>
<p>The labs of legend. Defaults to <code>NULL</code> is <code>c('Env', 'Gen')</code>.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_size.text.gen">size.text.gen</code>, <code id="plot.gge_+3A_size.text.env">size.text.env</code>, <code id="plot.gge_+3A_size.text.lab">size.text.lab</code></td>
<td>
<p>The size of the text for
genotypes, environments and labels, respectively.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_size.text.win">size.text.win</code></td>
<td>
<p>The text size to use for winner genotypes where
<code>type = 3</code> and for the two selected genotypes where <code>type = 9</code>.
Defaults to 4.5.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line in biplots (Both for segments and circles).</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_axis_expand">axis_expand</code></td>
<td>
<p>multiplication factor to expand the axis limits by to
enable fitting of labels. Defaults to 1.2</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_title">title</code></td>
<td>
<p>Logical values (Defaults to <code>TRUE</code>) to include
automatically generated information in the plot such as singular value
partitioning, scaling and centering.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.gge_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2-based biplot.
</p>
<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Yan, W., and M.S. Kang. 2003. GGE biplot analysis: a graphical
tool for breeders, geneticists, and agronomists. CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mod &lt;- gge(data_ge, ENV, GEN, GY)
plot(mod)
plot(mod,
     type = 2,
     col.gen = 'blue',
     col.env = 'red',
     size.text.gen = 2)

</code></pre>

<hr>
<h2 id='plot.mgidi'>Plot the multi-trait genotype-ideotype distance index</h2><span id='topic+plot.mgidi'></span>

<h3>Description</h3>

<p>Makes a radar plot showing the multi-trait genotype-ideotype distance index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mgidi'
plot(
  x,
  SI = 15,
  radar = TRUE,
  type = "index",
  position = "fill",
  rotate = FALSE,
  genotypes = "selected",
  n.dodge = 1,
  check.overlap = FALSE,
  x.lab = NULL,
  y.lab = NULL,
  title = NULL,
  size.point = 2.5,
  size.line = 0.7,
  size.text = 3.5,
  width.bar = 0.75,
  col.sel = "red",
  col.nonsel = "gray",
  legend.position = "bottom",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mgidi_+3A_x">x</code></td>
<td>
<p>An object of class <code>mgidi</code></p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_si">SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_radar">radar</code></td>
<td>
<p>Logical argument. If true (default) a radar plot is generated
after using <code>coord_polar()</code>.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_type">type</code></td>
<td>
<p>The type of the plot. Defaults to <code>"index"</code>. Use <code>type = "contribution"</code> to show the contribution of each factor to the MGIDI
index of the selected genotypes/treatments.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_position">position</code></td>
<td>
<p>The position adjustment when <code>type = "contribution"</code>.
Defaults to <code>"fill"</code>, which shows relative proportions at each trait
by stacking the bars and then standardizing each bar to have the same
height. Use <code>position = "stack"</code> to plot the MGIDI index for each
genotype/treatment.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_rotate">rotate</code></td>
<td>
<p>Logical argument. If <code>rotate = TRUE</code> the plot is rotated,
i.e., traits in y axis and value in the x axis.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_genotypes">genotypes</code></td>
<td>
<p>When <code>type = "contribution"</code> defines the genotypes to
be shown in the plot. By default (<code>genotypes = "selected"</code> only
selected genotypes are shown. Use <code>genotypes = "all"</code> to plot the
contribution for all genotypes.)</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_n.dodge">n.dodge</code></td>
<td>
<p>The number of rows that should be used to render the x labels.
This is useful for displaying labels that would otherwise overlap.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_check.overlap">check.overlap</code></td>
<td>
<p>Silently remove overlapping labels, (recursively)
prioritizing the first, last, and middle labels.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_x.lab">x.lab</code>, <code id="plot.mgidi_+3A_y.lab">y.lab</code></td>
<td>
<p>The labels for the axes x and y, respectively. x label is
set to null when a radar plot is produced.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_title">title</code></td>
<td>
<p>The plot title when <code>type = "contribution"</code>.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_size.point">size.point</code></td>
<td>
<p>The size of the point in graphic. Defaults to 2.5.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line in graphic. Defaults to 0.7.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_size.text">size.text</code></td>
<td>
<p>The size for the text in the plot. Defaults to 10.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_width.bar">width.bar</code></td>
<td>
<p>The width of the bars if <code>type = "contribution"</code>.
Defaults to 0.75.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_col.sel">col.sel</code></td>
<td>
<p>The colour for selected genotypes. Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_col.nonsel">col.nonsel</code></td>
<td>
<p>The colour for nonselected genotypes. Defaults to <code>"gray"</code>.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_legend.position">legend.position</code></td>
<td>
<p>The position of the legend.</p>
</td></tr>
<tr><td><code id="plot.mgidi_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed from  <code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- gamem(data_g,
               gen = GEN,
               rep = REP,
               resp = c(KW, NR, NKE, NKR))
mgidi_index &lt;- mgidi(model)
plot(mgidi_index)



</code></pre>

<hr>
<h2 id='plot.mtmps'>Plot the multi-trait stability index</h2><span id='topic+plot.mtmps'></span>

<h3>Description</h3>

<p>Makes a radar plot showing the multitrait stability index proposed by Olivoto
et al. (2019)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mtmps'
plot(
  x,
  SI = 15,
  type = "index",
  position = "fill",
  genotypes = "selected",
  title = TRUE,
  radar = TRUE,
  arrange.label = FALSE,
  x.lab = NULL,
  y.lab = NULL,
  size.point = 2.5,
  size.line = 0.7,
  size.text = 10,
  width.bar = 0.75,
  n.dodge = 1,
  check.overlap = FALSE,
  invert = FALSE,
  col.sel = "red",
  col.nonsel = "black",
  legend.position = "bottom",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mtmps_+3A_x">x</code></td>
<td>
<p>An object computed with <code><a href="#topic+mps">mps()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_si">SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_type">type</code></td>
<td>
<p>The type of the plot. Defaults to <code>"index"</code>. Use <code>type = "contribution"</code> to show the contribution of each factor to the MTMPS
index of the selected genotypes.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_position">position</code></td>
<td>
<p>The position adjustment when <code>type = "contribution"</code>.
Defaults to <code>"fill"</code>, which shows relative proportions at each trait
by stacking the bars and then standardizing each bar to have the same
height. Use <code>position = "stack"</code> to plot the MGIDI index for each
genotype.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_genotypes">genotypes</code></td>
<td>
<p>When <code>type = "contribution"</code> defines the genotypes to
be shown in the plot. By default (<code>genotypes = "selected"</code> only
selected genotypes are shown. Use <code>genotypes = "all"</code> to plot the
contribution for all genotypes.)</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_title">title</code></td>
<td>
<p>Logical values (Defaults to <code>TRUE</code>) to include
automatically generated titles.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_radar">radar</code></td>
<td>
<p>Logical argument. If true (default) a radar plot is generated
after using <code>coord_polar()</code>.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_arrange.label">arrange.label</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, the labels are
arranged to avoid text overlapping. This becomes useful when the number of
genotypes is large, say, more than 30.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_x.lab">x.lab</code>, <code id="plot.mtmps_+3A_y.lab">y.lab</code></td>
<td>
<p>The labels for the axes x and y, respectively. x label is
set to null when a radar plot is produced.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_size.point">size.point</code></td>
<td>
<p>The size of the point in graphic. Defaults to 2.5.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line in graphic. Defaults to 0.7.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_size.text">size.text</code></td>
<td>
<p>The size for the text in the plot. Defaults to 10.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_width.bar">width.bar</code></td>
<td>
<p>The width of the bars if <code>type = "contribution"</code>.
Defaults to 0.75.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_n.dodge">n.dodge</code></td>
<td>
<p>The number of rows that should be used to render the x labels.
This is useful for displaying labels that would otherwise overlap.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_check.overlap">check.overlap</code></td>
<td>
<p>Silently remove overlapping labels, (recursively)
prioritizing the first, last, and middle labels.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_invert">invert</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, rotate the plot.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_col.sel">col.sel</code></td>
<td>
<p>The colour for selected genotypes. Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_col.nonsel">col.nonsel</code></td>
<td>
<p>The colour for nonselected genotypes. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_legend.position">legend.position</code></td>
<td>
<p>The position of the legend.</p>
</td></tr>
<tr><td><code id="plot.mtmps_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed from  <code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, B.G. Sari, and M.I. Diel. 2019. Mean performance and stability in multi-environment trials II: Selection based on multiple traits. Agron. J. (in press).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;-
mps(data_ge,
    env = ENV,
    gen = GEN,
    rep = REP,
    resp = everything())
selection &lt;- mtmps(model)
plot(selection)



</code></pre>

<hr>
<h2 id='plot.mtsi'>Plot the multi-trait stability index</h2><span id='topic+plot.mtsi'></span>

<h3>Description</h3>

<p>Makes a radar plot showing the multitrait stability index proposed by Olivoto
et al. (2019)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mtsi'
plot(
  x,
  SI = 15,
  type = "index",
  position = "fill",
  genotypes = "selected",
  title = TRUE,
  radar = TRUE,
  x.lab = NULL,
  y.lab = NULL,
  size.point = 2.5,
  size.line = 0.7,
  size.text = 3.5,
  width.bar = 0.75,
  n.dodge = 1,
  check.overlap = FALSE,
  invert = FALSE,
  col.sel = "red",
  col.nonsel = "black",
  legend.position = "bottom",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mtsi_+3A_x">x</code></td>
<td>
<p>An object of class <code>mtsi</code></p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_si">SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_type">type</code></td>
<td>
<p>The type of the plot. Defaults to <code>"index"</code>. Use <code>type = "contribution"</code> to show the contribution of each factor to the MGIDI
index of the selected genotypes.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_position">position</code></td>
<td>
<p>The position adjustment when <code>type = "contribution"</code>.
Defaults to <code>"fill"</code>, which shows relative proportions at each trait
by stacking the bars and then standardizing each bar to have the same
height. Use <code>position = "stack"</code> to plot the MGIDI index for each
genotype.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_genotypes">genotypes</code></td>
<td>
<p>When <code>type = "contribution"</code> defines the genotypes to
be shown in the plot. By default (<code>genotypes = "selected"</code> only
selected genotypes are shown. Use <code>genotypes = "all"</code> to plot the
contribution for all genotypes.)</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_title">title</code></td>
<td>
<p>Logical values (Defaults to <code>TRUE</code>) to include
automatically generated titles.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_radar">radar</code></td>
<td>
<p>Logical argument. If true (default) a radar plot is generated
after using <code>coord_polar()</code>.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_x.lab">x.lab</code>, <code id="plot.mtsi_+3A_y.lab">y.lab</code></td>
<td>
<p>The labels for the axes x and y, respectively. x label is
set to null when a radar plot is produced.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_size.point">size.point</code></td>
<td>
<p>The size of the point in graphic. Defaults to 2.5.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line in graphic. Defaults to 0.7.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_size.text">size.text</code></td>
<td>
<p>The size for the text in the plot. Defaults to 10.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_width.bar">width.bar</code></td>
<td>
<p>The width of the bars if <code>type = "contribution"</code>.
Defaults to 0.75.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_n.dodge">n.dodge</code></td>
<td>
<p>The number of rows that should be used to render the x labels.
This is useful for displaying labels that would otherwise overlap.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_check.overlap">check.overlap</code></td>
<td>
<p>Silently remove overlapping labels, (recursively)
prioritizing the first, last, and middle labels.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_invert">invert</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, rotate the plot.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_col.sel">col.sel</code></td>
<td>
<p>The colour for selected genotypes. Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_col.nonsel">col.nonsel</code></td>
<td>
<p>The colour for nonselected genotypes. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_legend.position">legend.position</code></td>
<td>
<p>The position of the legend.</p>
</td></tr>
<tr><td><code id="plot.mtsi_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed from  <code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, B.G. Sari, and M.I. Diel. 2019. Mean performance and stability in multi-environment trials II: Selection based on multiple traits. Agron. J. (in press).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mtsi_model &lt;- waasb(data_ge, ENV, GEN, REP, resp = c(GY, HM))
mtsi_index &lt;- mtsi(mtsi_model)
plot(mtsi_index)



</code></pre>

<hr>
<h2 id='plot.path_coeff'>Plots an object of class <code>path_coeff</code></h2><span id='topic+plot.path_coeff'></span>

<h3>Description</h3>

<p>Plots an object generated by <code>path_coeff()</code>. Options includes the path
coefficients, variance inflaction factor and the beta values with different
values of 'k' values added to the diagonal of the correlation matrix of
explanatory traits. See more on <code>Details</code> section.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'path_coeff'
plot(
  x,
  which = "coef",
  size.text.plot = 4,
  size.text.labels = 10,
  digits = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.path_coeff_+3A_x">x</code></td>
<td>
<p>An object of class <code>path_coeff</code> or <code>group_path</code>.</p>
</td></tr>
<tr><td><code id="plot.path_coeff_+3A_which">which</code></td>
<td>
<p>Which to plot: one of <code>'coef'</code>, <code>'vif'</code>, or <code>'betas'</code>.</p>
</td></tr>
<tr><td><code id="plot.path_coeff_+3A_size.text.plot">size.text.plot</code>, <code id="plot.path_coeff_+3A_size.text.labels">size.text.labels</code></td>
<td>
<p>The size of the text for plot area and
labels, respectively.</p>
</td></tr>
<tr><td><code id="plot.path_coeff_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="plot.path_coeff_+3A_...">...</code></td>
<td>
<p>Further arguments passed on to <code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot <code>which = "coef"</code> (default) is interpreted as follows:
</p>

<ul>
<li><p> The direct effects are shown in the diagonal (highlighted with a thicker
line). In the example, the direct effect of NKE on KW is 0.718.
</p>
</li>
<li><p> The indirect effects are shown in the line. In the example, the indirect effect of EH on KW through TKW is 0.396.
</p>
</li>
<li><p> The linear correlation (direct + indirect) is shown in the last column.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

# KW as dependent trait and all others as predictors
# PH, EH, NKE, and TKW as predictors

pcoeff &lt;-
  path_coeff(data_ge2,
             resp = KW,
             pred = c(PH, EH, NKE, TKW))
plot(pcoeff)
plot(pcoeff, which = "vif")
plot(pcoeff, which = "betas")

</code></pre>

<hr>
<h2 id='plot.performs_ammi'>Several types of residual plots</h2><span id='topic+plot.performs_ammi'></span>

<h3>Description</h3>

<p>Residual plots for a output model of class <code>performs_ammi</code>. Seven types
of plots are produced: (1) Residuals vs fitted, (2) normal Q-Q plot for the
residuals, (3) scale-location plot (standardized residuals vs Fitted Values),
(4) standardized residuals vs Factor-levels, (5) Histogram of raw residuals
and (6) standardized residuals vs observation order, and (7) 1:1 line plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'performs_ammi'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.performs_ammi_+3A_x">x</code></td>
<td>
<p>An object of class <code>performs_ammi</code>.</p>
</td></tr>
<tr><td><code id="plot.performs_ammi_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to the function
<code><a href="#topic+residual_plots">residual_plots()</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- performs_ammi(data_ge, ENV, GEN, REP, GY)
plot(model)
plot(model,
     which = c(3, 5),
     nrow = 2,
     labels = TRUE,
     size.lab.out = 4)


</code></pre>

<hr>
<h2 id='plot.resp_surf'>Plot the response surface model</h2><span id='topic+plot.resp_surf'></span>

<h3>Description</h3>

<p>Plot the response surface model using a contour plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'resp_surf'
plot(
  x,
  xlab = NULL,
  ylab = NULL,
  resolution = 100,
  bins = 10,
  plot_theme = theme_metan(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.resp_surf_+3A_x">x</code></td>
<td>
<p>An object of class <code>resp_surf</code></p>
</td></tr>
<tr><td><code id="plot.resp_surf_+3A_xlab">xlab</code>, <code id="plot.resp_surf_+3A_ylab">ylab</code></td>
<td>
<p>The label for the x and y axis, respectively. Defaults to
original variable names.</p>
</td></tr>
<tr><td><code id="plot.resp_surf_+3A_resolution">resolution</code></td>
<td>
<p>The resolution of the contour plot. Defaults to 100. higher
values produce high-resolution plots but may increase the computation time.</p>
</td></tr>
<tr><td><code id="plot.resp_surf_+3A_bins">bins</code></td>
<td>
<p>The number of bins shown in the plot. Defaults to <code>10</code>.</p>
</td></tr>
<tr><td><code id="plot.resp_surf_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.resp_surf_+3A_...">...</code></td>
<td>
<p>Currently not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# A small toy example

df &lt;- data.frame(
 expand.grid(x = seq(0, 4, by = 1),
             y = seq(0, 4, by = 1)),
 z = c(10, 11, 12, 11, 10,
       14, 15, 16, 15, 14,
       16, 17, 18, 17, 16,
       14, 15, 16, 15, 14,
       10, 11, 12, 11, 10)
)
mod &lt;- resp_surf(df, x, y, resp = z)
plot(mod)


</code></pre>

<hr>
<h2 id='plot.sh'>Plot the Smith-Hazel index</h2><span id='topic+plot.sh'></span>

<h3>Description</h3>

<p>Makes a radar plot showing the individual genetic worth for the Smith-Hazel index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sh'
plot(
  x,
  SI = 15,
  radar = TRUE,
  arrange.label = FALSE,
  size.point = 2.5,
  size.line = 0.7,
  size.text = 10,
  col.sel = "red",
  col.nonsel = "black",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.sh_+3A_x">x</code></td>
<td>
<p>An object of class <code>sh</code></p>
</td></tr>
<tr><td><code id="plot.sh_+3A_si">SI</code></td>
<td>
<p>An integer (0-100). The selection intensity in percentage of the
total number of genotypes.</p>
</td></tr>
<tr><td><code id="plot.sh_+3A_radar">radar</code></td>
<td>
<p>Logical argument. If true (default) a radar plot is generated
after using <code>coord_polar()</code>.</p>
</td></tr>
<tr><td><code id="plot.sh_+3A_arrange.label">arrange.label</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, the labels are
arranged to avoid text overlapping. This becomes useful when the number of
genotypes is large, say, more than 30.</p>
</td></tr>
<tr><td><code id="plot.sh_+3A_size.point">size.point</code></td>
<td>
<p>The size of the point in graphic. Defaults to 2.5.</p>
</td></tr>
<tr><td><code id="plot.sh_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line in graphic. Defaults to 0.7.</p>
</td></tr>
<tr><td><code id="plot.sh_+3A_size.text">size.text</code></td>
<td>
<p>The size for the text in the plot. Defaults to 10.</p>
</td></tr>
<tr><td><code id="plot.sh_+3A_col.sel">col.sel</code></td>
<td>
<p>The colour for selected genotypes. Defaults to <code>"red"</code>.</p>
</td></tr>
<tr><td><code id="plot.sh_+3A_col.nonsel">col.nonsel</code></td>
<td>
<p>The colour for nonselected genotypes. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="plot.sh_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed from ggplot2::theme().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;gg, ggplot&#8288;</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
vcov &lt;- covcor_design(data_g, GEN, REP, everything())
means &lt;- as.matrix(vcov$means)
pcov &lt;- vcov$phen_cov
gcov &lt;- vcov$geno_cov

index &lt;- Smith_Hazel(means, pcov = pcov, gcov = gcov, weights = rep(1, 15))
plot(index)


</code></pre>

<hr>
<h2 id='plot.waas'>Several types of residual plots</h2><span id='topic+plot.waas'></span>

<h3>Description</h3>

<p>Residual plots for a output model of class <code>waas</code>. Seven types
of plots are produced: (1) Residuals vs fitted, (2) normal Q-Q plot for the
residuals, (3) scale-location plot (standardized residuals vs Fitted Values),
(4) standardized residuals vs Factor-levels, (5) Histogram of raw residuals
and (6) standardized residuals vs observation order, and (7) 1:1 line plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'waas'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.waas_+3A_x">x</code></td>
<td>
<p>An object of class <code>waas</code>.</p>
</td></tr>
<tr><td><code id="plot.waas_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to the function
<code><a href="#topic+residual_plots">residual_plots()</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- waas(data_ge, ENV, GEN, REP, GY)
plot(model)
plot(model,
     which = c(3, 5),
     nrow = 2,
     labels = TRUE,
     size.lab.out = 4)


</code></pre>

<hr>
<h2 id='plot.waasb'>Several types of residual plots</h2><span id='topic+plot.waasb'></span>

<h3>Description</h3>

<p>Residual plots for a output model of class <code>waas</code> and <code>waasb</code>. Six types
of plots are produced: (1) Residuals vs fitted, (2) normal Q-Q plot for the
residuals, (3) scale-location plot (standardized residuals vs Fitted
Values), (4) standardized residuals vs Factor-levels, (5) Histogram of raw
residuals and (6) standardized residuals vs observation order. For a <code>waasb</code>
object, normal Q-Q plot for random effects may also be obtained declaring
<code>type = 're'</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'waasb'
plot(
  x,
  var = 1,
  type = "res",
  position = "fill",
  trait.levels = NULL,
  percent = TRUE,
  percent.digits = 2,
  size.text.percent = 3.5,
  rotate = FALSE,
  conf = 0.95,
  out = "print",
  n.dodge = 1,
  check.overlap = FALSE,
  labels = FALSE,
  plot_theme = theme_metan(),
  alpha = 0.2,
  fill.hist = "gray",
  col.hist = "black",
  col.point = "black",
  col.line = "red",
  col.lab.out = "red",
  size.line = 0.7,
  size.text = 10,
  width.bar = 0.75,
  size.lab.out = 2.5,
  size.tex.lab = 10,
  size.shape = 1.5,
  bins = 30,
  which = c(1:4),
  ncol = NULL,
  nrow = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.waasb_+3A_x">x</code></td>
<td>
<p>An object of class <code>waasb</code>.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_type">type</code></td>
<td>
<p>One of the <code>"res"</code> to plot the model residuals (default),
<code>type = 're'</code> to plot normal Q-Q plots for the random effects, or
<code>"vcomp"</code> to create a bar plot with the variance components.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_position">position</code></td>
<td>
<p>The position adjustment when <code>type = "vcomp"</code>. Defaults
to <code>"fill"</code>, which shows relative proportions at each trait by
stacking the bars and then standardizing each bar to have the same height.
Use <code>position = "stack"</code> to plot the phenotypic variance for each
trait.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_trait.levels">trait.levels</code></td>
<td>
<p>By default, variables are ordered in the x-axis by
alphabetic order. If a plot with two variables (eg., &quot;GY&quot; and &quot;PH&quot;) &quot;PH&quot;
should appers before &quot;GY&quot;, one can use a comma-separated vector of variable
names to relevel the variable's position in the plot (eg., <code>trait.levels = "PH, GY"</code>).</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_percent">percent</code></td>
<td>
<p>If <code>TRUE</code> (default) shows the y-axis as percent and the
percentage values within each bar.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_percent.digits">percent.digits</code></td>
<td>
<p>The significant figures for the percentage values.
Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_size.text.percent">size.text.percent</code></td>
<td>
<p>The size of the text for the percentage values.
Defaults to <code>3.5</code>.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_rotate">rotate</code></td>
<td>
<p>Logical argument. If <code>rotate = TRUE</code> the plot is rotated,
i.e., traits in y axis and value in the x axis.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_conf">conf</code></td>
<td>
<p>Level of confidence interval to use in the Q-Q plot (0.95 by
default).</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_out">out</code></td>
<td>
<p>How the output is returned. Must be one of the 'print' (default)
or 'return'.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_n.dodge">n.dodge</code></td>
<td>
<p>The number of rows that should be used to render the x labels.
This is useful for displaying labels that would otherwise overlap.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_check.overlap">check.overlap</code></td>
<td>
<p>Silently remove overlapping labels, (recursively)
prioritizing the first, last, and middle labels.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_labels">labels</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> labels the points outside
confidence interval limits.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_alpha">alpha</code></td>
<td>
<p>The transparency of confidence band in the Q-Q plot. Must be a
number between 0 (opaque) and 1 (full transparency).</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_fill.hist">fill.hist</code></td>
<td>
<p>The color to fill the histogram. Default is 'gray'.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_col.hist">col.hist</code></td>
<td>
<p>The color of the border of the the histogram. Default is
'black'.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_col.point">col.point</code></td>
<td>
<p>The color of the points in the graphic. Default is 'black'.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_col.line">col.line</code></td>
<td>
<p>The color of the lines in the graphic. Default is 'red'.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_col.lab.out">col.lab.out</code></td>
<td>
<p>The color of the labels for the 'outlying' points.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_size.line">size.line</code></td>
<td>
<p>The size of the line in graphic. Defaults to 0.7.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_size.text">size.text</code></td>
<td>
<p>The size for the text in the plot. Defaults to 10.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_width.bar">width.bar</code></td>
<td>
<p>The width of the bars if <code>type = "contribution"</code>.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_size.lab.out">size.lab.out</code></td>
<td>
<p>The size of the labels for the 'outlying' points.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in axis text and labels.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_size.shape">size.shape</code></td>
<td>
<p>The size of the shape in the plots.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_bins">bins</code></td>
<td>
<p>The number of bins to use in the histogram. Default is 30.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_which">which</code></td>
<td>
<p>Which graphics should be plotted. Default is <code>which = c(1:4)</code> that means that the first four graphics will be plotted.</p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_ncol">ncol</code>, <code id="plot.waasb_+3A_nrow">nrow</code></td>
<td>
<p>The number of columns and rows of the plot pannel. Defaults
to <code>NULL</code></p>
</td></tr>
<tr><td><code id="plot.waasb_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to the function
<code><a href="patchwork.html#topic+wrap_plots">patchwork::wrap_plots()</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
x &lt;- gamem_met(data_ge,
               gen = GEN,
               env = ENV,
               rep = REP,
               resp = everything())
plot(x)

</code></pre>

<hr>
<h2 id='plot.wsmp'>Plot heat maps with genotype ranking</h2><span id='topic+plot.wsmp'></span>

<h3>Description</h3>

<p>Plot heat maps with genotype ranking in two ways.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wsmp'
plot(x, var = 1, type = 1, y.lab = NULL, x.lab = NULL, size.lab = 12, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.wsmp_+3A_x">x</code></td>
<td>
<p>An object returned by the function <code>wsmp</code>.</p>
</td></tr>
<tr><td><code id="plot.wsmp_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="plot.wsmp_+3A_type">type</code></td>
<td>
<p><code style="white-space: pre;">&#8288;1 = Heat map Ranks&#8288;</code>: this graphic shows the genotype
ranking considering the WAASB index estimated with different numbers of
Principal Components; <code style="white-space: pre;">&#8288;2 = Heat map WAASY-GY ratio&#8288;</code>: this graphic
shows the genotype ranking considering the different combinations in the
WAASB/GY ratio.</p>
</td></tr>
<tr><td><code id="plot.wsmp_+3A_y.lab">y.lab</code></td>
<td>
<p>The label of y axis. Default is 'Genotypes'.</p>
</td></tr>
<tr><td><code id="plot.wsmp_+3A_x.lab">x.lab</code></td>
<td>
<p>The label of x axis. Default is 'Number of axes'.</p>
</td></tr>
<tr><td><code id="plot.wsmp_+3A_size.lab">size.lab</code></td>
<td>
<p>The size of the labels.</p>
</td></tr>
<tr><td><code id="plot.wsmp_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first type of heatmap shows the genotype ranking depending on the number
of principal component axis used for estimating the WAASB index. The second type of heatmap shows the
genotype ranking depending on the WAASB/GY ratio. The ranks obtained with a
ratio of 100/0 considers exclusively the stability for the genotype ranking.
On the other hand, a ratio of 0/100 considers exclusively the productivity
for the genotype ranking.  Four clusters of genotypes are shown by label colors (red) unproductive and
unstable genotypes; (blue) productive, but unstable genotypes; (black) stable, but
unproductive genotypes; and (green), productive and stable genotypes.
</p>


<h3>Value</h3>

<p>An object of class <code>gg</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- waasb(data_ge2,
               env = ENV,
               gen = GEN,
               rep = REP,
               resp = PH) %&gt;%
         wsmp()

p1 &lt;- plot(model)
p2 &lt;- plot(model, type = 2)
arrange_ggplot(p1, p2, ncol = 1)


</code></pre>

<hr>
<h2 id='predict.gamem'>Predict method for gamem fits</h2><span id='topic+predict.gamem'></span>

<h3>Description</h3>

<p>Obtains predictions from an object fitted with <code><a href="#topic+gamem">gamem()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamem'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.gamem_+3A_object">object</code></td>
<td>
<p>An object of class <code>gamem</code></p>
</td></tr>
<tr><td><code id="predict.gamem_+3A_...">...</code></td>
<td>
<p>Currently not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the predicted values for each variable in the model
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- gamem(data_g,
              gen = GEN,
              rep = REP,
              resp = everything())
predict(model)


</code></pre>

<hr>
<h2 id='predict.gge'>Predict a two-way table based on GGE model</h2><span id='topic+predict.gge'></span>

<h3>Description</h3>

<p>Predict the means for a genotype-vs-environment trial based on a Genotype
plus Genotype-vs-Environment interaction (GGE) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gge'
predict(object, naxis = 2, output = "wide", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.gge_+3A_object">object</code></td>
<td>
<p>An object of class <code>gge</code>.</p>
</td></tr>
<tr><td><code id="predict.gge_+3A_naxis">naxis</code></td>
<td>
<p>The the number of principal components to be used in the
prediction. Generally, two axis may be used. In this case, the estimated
values will be those shown in the biplot.</p>
</td></tr>
<tr><td><code id="predict.gge_+3A_output">output</code></td>
<td>
<p>The type of output. It must be one of the <code>'long'</code>
(default) returning a long-format table with the columns for environment
(ENV), genotypes (GEN) and response variable (Y); or <code>'wide'</code> to
return a two-way table with genotypes in the row, environments in the
columns, filled by the estimated values.</p>
</td></tr>
<tr><td><code id="predict.gge_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to predict the response variable of a two-way table
(for examples the yielding of g genotypes in e environments) based on GGE
model. This prediction is based on the number of principal components used.
For more details see Yan and Kang (2007).
</p>


<h3>Value</h3>

<p>A two-way table with genotypes in rows and environments in columns if
<code>output = "wide"</code> or a long format (columns ENV, GEN and Y) if
<code>output = "long"</code> with the predicted values by the GGE model.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Yan, W., and M.S. Kang. 2003. GGE biplot analysis: a graphical
tool for breeders, geneticists, and agronomists. CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mod &lt;- gge(data_ge, GEN, ENV, c(GY, HM))
predict(mod)


</code></pre>

<hr>
<h2 id='predict.performs_ammi'>Predict the means of a performs_ammi object</h2><span id='topic+predict.performs_ammi'></span>

<h3>Description</h3>

<p>Predict the means of a performs_ammi object considering a specific number of axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'performs_ammi'
predict(object, naxis = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.performs_ammi_+3A_object">object</code></td>
<td>
<p>An object of class performs_ammi</p>
</td></tr>
<tr><td><code id="predict.performs_ammi_+3A_naxis">naxis</code></td>
<td>
<p>The the number of axis to be use in the prediction. If
<code>object</code> has more than one variable, then <code>naxis</code> must be a
vector.</p>
</td></tr>
<tr><td><code id="predict.performs_ammi_+3A_...">...</code></td>
<td>
<p>Additional parameter for the function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to predict the response variable of a two-way table
(for examples the yielding of the i-th genotype in the j-th environment)
based on AMMI model. This prediction is based on the number of multiplicative
terms used. If <code>naxis = 0</code>, only the main effects (AMMI0) are used. In
this case, the predicted mean will be the predicted value from OLS
estimation. If <code>naxis = 1</code> the AMMI1 (with one multiplicative term) is
used for predicting the response variable. If <code style="white-space: pre;">&#8288;naxis = min(gen-1;env-1)&#8288;</code>, the AMMIF is fitted and the predicted value will be the
cell mean, i.e. the mean of R-replicates of the i-th genotype in the j-th
environment. The number of axis to be used must be carefully chosen.
Procedures based on Postdictive success (such as Gollobs's d.f.) or
Predictive success (such as cross-validation) should be used to do this. This
package provide both. <code><a href="#topic+performs_ammi">performs_ammi()</a></code> function compute
traditional AMMI analysis showing the number of significant axis. On the
other hand, <code><a href="#topic+cv_ammif">cv_ammif()</a></code> function provide a cross-validation,
estimating the RMSPD of all AMMI-family models, based on resampling
procedures.
</p>


<h3>Value</h3>

<p>A list where each element is the predicted values by the AMMI model
for each variable.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- performs_ammi(data_ge, ENV, GEN, REP,
                       resp = c(GY, HM))
# Predict GY with 3 IPCA and HM with 1 IPCA
predict &lt;- predict(model, naxis = c(3, 1))


</code></pre>

<hr>
<h2 id='predict.waas'>Predict the means of a waas object</h2><span id='topic+predict.waas'></span>

<h3>Description</h3>

<p>Predict the means of a waas object considering a specific number of axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'waas'
predict(object, naxis = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.waas_+3A_object">object</code></td>
<td>
<p>An object of class waas</p>
</td></tr>
<tr><td><code id="predict.waas_+3A_naxis">naxis</code></td>
<td>
<p>The the number of axis to be use in the prediction. If
<code>object</code> has more than one variable, then <code>naxis</code> must be a
vector.</p>
</td></tr>
<tr><td><code id="predict.waas_+3A_...">...</code></td>
<td>
<p>Additional parameter for the function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to predict the response variable of a two-way table
(for examples the yielding of the i-th genotype in the j-th environment)
based on AMMI model. This prediction is based on the number of multiplicative
terms used. If <code>naxis = 0</code>, only the main effects (AMMI0) are used. In
this case, the predicted mean will be the predicted value from OLS
estimation. If <code>naxis = 1</code> the AMMI1 (with one multiplicative term) is
used for predicting the response variable. If <code style="white-space: pre;">&#8288;naxis = min(gen-1;env-1)&#8288;</code>, the AMMIF is fitted and the predicted value will be the
cell mean, i.e. the mean of R-replicates of the i-th genotype in the j-th
environment. The number of axis to be used must be carefully chosen.
Procedures based on Postdictive success (such as Gollobs's d.f.) or
Predictive sucess (such as cross-validation) should be used to do this. This
package provide both. <code><a href="#topic+waas">waas()</a></code> function compute traditional AMMI
analysis showing the number of significant axis. On the other hand,
<code><a href="#topic+cv_ammif">cv_ammif()</a></code> function provide a cross-validation, estimating the
RMSPD of all AMMI-family models, based on resampling procedures.
</p>


<h3>Value</h3>

<p>A list where each element is the predicted values by the AMMI model
for each variable.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- waas(data_ge,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = c(GY, HM))
# Predict GY with 3 IPCA and HM with 1 IPCA
predict &lt;- predict(model, naxis = c(3, 1))
predict


</code></pre>

<hr>
<h2 id='predict.waasb'>Predict method for waasb fits</h2><span id='topic+predict.waasb'></span>

<h3>Description</h3>

<p>Obtains predictions from an object fitted with <code><a href="#topic+waasb">waasb()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'waasb'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.waasb_+3A_object">object</code></td>
<td>
<p>An object of class <code>waasb</code></p>
</td></tr>
<tr><td><code id="predict.waasb_+3A_...">...</code></td>
<td>
<p>Currently not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the predicted values for each variable in the model
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- waasb(data_ge,
               env = ENV,
               gen = GEN,
               rep = REP,
               resp = c(GY, HM))
predict(model)


</code></pre>

<hr>
<h2 id='print.ammi_indexes'>Print an object of class ammi_indexes</h2><span id='topic+print.ammi_indexes'></span>

<h3>Description</h3>

<p>Print the <code>ammi_indexes</code> object in two ways. By default, the results are shown
in the R console. The results can also be exported to the directory into a
*.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ammi_indexes'
print(x, which = "stats", export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ammi_indexes_+3A_x">x</code></td>
<td>
<p>An object of class <code>ammi_indexes</code>.</p>
</td></tr>
<tr><td><code id="print.ammi_indexes_+3A_which">which</code></td>
<td>
<p>Which should be printed. Defaults to <code>"stats"</code>. Other
possible values are <code>"ranks"</code> for genotype ranking and <code>"ssi"</code>
for the simultaneous selection index.</p>
</td></tr>
<tr><td><code id="print.ammi_indexes_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.ammi_indexes_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.ammi_indexes_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.ammi_indexes_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- performs_ammi(data_ge, ENV, GEN, REP, GY) %&gt;%
         ammi_indexes()
print(model)

</code></pre>

<hr>
<h2 id='print.Annicchiarico'>Print an object of class Annicchiarico</h2><span id='topic+print.Annicchiarico'></span>

<h3>Description</h3>

<p>Print the <code>Annicchiarico</code> object in two ways. By default, the results
are shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Annicchiarico'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.Annicchiarico_+3A_x">x</code></td>
<td>
<p>The <code>Annicchiarico</code> x</p>
</td></tr>
<tr><td><code id="print.Annicchiarico_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.Annicchiarico_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.Annicchiarico_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.Annicchiarico_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
Ann &lt;- Annicchiarico(data_ge2,
  env = ENV,
  gen = GEN,
  rep = REP,
  resp = PH
)
print(Ann)

</code></pre>

<hr>
<h2 id='print.anova_ind'>Print an object of class anova_ind</h2><span id='topic+print.anova_ind'></span>

<h3>Description</h3>

<p>Print the <code>anova_ind</code> object in two ways. By default, the results are shown
in the R console. The results can also be exported to the directory into a
*.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'anova_ind'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.anova_ind_+3A_x">x</code></td>
<td>
<p>An object of class <code>anova_ind</code>.</p>
</td></tr>
<tr><td><code id="print.anova_ind_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.anova_ind_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.anova_ind_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.anova_ind_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- data_ge %&gt;% anova_ind(ENV, GEN, REP, c(GY, HM))
print(model)

</code></pre>

<hr>
<h2 id='print.anova_joint'>Print an object of class anova_joint</h2><span id='topic+print.anova_joint'></span>

<h3>Description</h3>

<p>Print the <code>anova_joint</code> object in two ways. By default, the results are shown
in the R console. The results can also be exported to the directory into a
*.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'anova_joint'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.anova_joint_+3A_x">x</code></td>
<td>
<p>An object of class <code>anova_joint</code>.</p>
</td></tr>
<tr><td><code id="print.anova_joint_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.anova_joint_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.anova_joint_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.anova_joint_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- data_ge %&gt;% anova_joint(ENV, GEN, REP, c(GY, HM))
print(model)

</code></pre>

<hr>
<h2 id='print.can_cor'>Print an object of class can_cor</h2><span id='topic+print.can_cor'></span>

<h3>Description</h3>

<p>Print an object of class <code>can_cor</code> object in two ways. By default, the
results are shown in the R console. The results can also be exported to the
directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'can_cor'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.can_cor_+3A_x">x</code></td>
<td>
<p>An object of class <code>can_cor</code>.</p>
</td></tr>
<tr><td><code id="print.can_cor_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE|T</code>, a *.txt file is exported
to the working directory</p>
</td></tr>
<tr><td><code id="print.can_cor_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.can_cor_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.can_cor_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
cc &lt;- can_corr(data_ge2,
               FG = c(PH, EH, EP),
               SG = c(EL, CL, CD, CW, KW, NR, TKW),
               verbose = FALSE)
print(cc)

</code></pre>

<hr>
<h2 id='print.coincidence'>Print an object of class coincidence</h2><span id='topic+print.coincidence'></span>

<h3>Description</h3>

<p>Print a <code>coincidence</code> object in two ways. By default, the results are shown in
the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coincidence'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.coincidence_+3A_x">x</code></td>
<td>
<p>An object of class <code>coincidence</code>.</p>
</td></tr>
<tr><td><code id="print.coincidence_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported
to the working directory</p>
</td></tr>
<tr><td><code id="print.coincidence_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.coincidence_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.coincidence_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
sel1 &lt;- paste("G", 1:30, sep = "")
sel2 &lt;- paste("G", 16:45, sep = "")
coinc &lt;- coincidence_index(sel1 = sel1, sel2 = sel2, total = 150)
print(coinc)

</code></pre>

<hr>
<h2 id='print.colindiag'>Print an object of class colindiag</h2><span id='topic+print.colindiag'></span>

<h3>Description</h3>

<p>Print the <code>colindiag</code> object in two ways. By default, the results
are shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'colindiag'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.colindiag_+3A_x">x</code></td>
<td>
<p>The object of class <code>colindiag</code></p>
</td></tr>
<tr><td><code id="print.colindiag_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.colindiag_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.colindiag_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.colindiag_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
col &lt;- colindiag(data_ge2)
print(col)

</code></pre>

<hr>
<h2 id='print.corr_coef'>Print an object of class corr_coef</h2><span id='topic+print.corr_coef'></span>

<h3>Description</h3>

<p>Print the <code>corr_coef</code> object in two ways. By default, the results
are shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'corr_coef'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.corr_coef_+3A_x">x</code></td>
<td>
<p>An object of class <code>corr_coef</code></p>
</td></tr>
<tr><td><code id="print.corr_coef_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.corr_coef_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.corr_coef_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.corr_coef_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::formatting()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
sel &lt;- corr_coef(data_ge2, EP, EL, CD, CL)
print(sel)

</code></pre>

<hr>
<h2 id='print.ecovalence'>Print an object of class ecovalence</h2><span id='topic+print.ecovalence'></span>

<h3>Description</h3>

<p>Print the <code>ecovalence</code> object in two ways. By default, the results
are shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ecovalence'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ecovalence_+3A_x">x</code></td>
<td>
<p>The <code>ecovalence</code> x</p>
</td></tr>
<tr><td><code id="print.ecovalence_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.ecovalence_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.ecovalence_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.ecovalence_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
eco &lt;- ecovalence(data_ge2,
                  env = ENV,
                  gen = GEN,
                  rep = REP,
                  resp = PH)
print(eco)

</code></pre>

<hr>
<h2 id='print.env_dissimilarity'>Print an object of class env_dissimilarity</h2><span id='topic+print.env_dissimilarity'></span>

<h3>Description</h3>

<p>Print the <code>env_dissimilarity</code> object in two ways. By default, the results
are shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'env_dissimilarity'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.env_dissimilarity_+3A_x">x</code></td>
<td>
<p>An object of class <code>env_dissimilarity</code>.</p>
</td></tr>
<tr><td><code id="print.env_dissimilarity_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.env_dissimilarity_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.env_dissimilarity_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.env_dissimilarity_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mod &lt;- env_dissimilarity(data_ge, ENV, GEN, REP, GY)
print(mod)

</code></pre>

<hr>
<h2 id='print.env_stratification'>Print the env_stratification model</h2><span id='topic+print.env_stratification'></span>

<h3>Description</h3>

<p>Print an object of class <code>ge_factanal</code> in two ways. By default, the results are
shown in the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'env_stratification'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.env_stratification_+3A_x">x</code></td>
<td>
<p>An object of class <code>env_stratification</code>.</p>
</td></tr>
<tr><td><code id="print.env_stratification_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory</p>
</td></tr>
<tr><td><code id="print.env_stratification_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.env_stratification_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.env_stratification_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;-
env_stratification(data_ge,
                   env = ENV,
                   gen = GEN,
                   resp = GY)
print(model)

</code></pre>

<hr>
<h2 id='print.Fox'>Print an object of class Fox</h2><span id='topic+print.Fox'></span>

<h3>Description</h3>

<p>Print the <code>Fox</code> object in two ways. By default, the results
are shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Fox'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.Fox_+3A_x">x</code></td>
<td>
<p>The <code>Fox</code> x</p>
</td></tr>
<tr><td><code id="print.Fox_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.Fox_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.Fox_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.Fox_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
library(metan)
out &lt;- Fox(data_ge2, ENV, GEN, PH)
print(out)

</code></pre>

<hr>
<h2 id='print.gamem'>Print an object of class gamem</h2><span id='topic+print.gamem'></span>

<h3>Description</h3>

<p>Print the <code>gamem</code> object in two ways. By default, the results are shown
in the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamem'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.gamem_+3A_x">x</code></td>
<td>
<p>An object fitted with the function <code><a href="#topic+gamem">gamem()</a></code> .</p>
</td></tr>
<tr><td><code id="print.gamem_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory</p>
</td></tr>
<tr><td><code id="print.gamem_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.gamem_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.gamem_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
alpha &lt;- gamem(data_alpha,
  gen = GEN,
  rep = REP,
  block = BLOCK,
  resp = YIELD
)

print(alpha)

</code></pre>

<hr>
<h2 id='print.ge_factanal'>Print an object of class ge_factanal</h2><span id='topic+print.ge_factanal'></span>

<h3>Description</h3>

<p>Print the <code>ge_factanal</code> object in two ways. By default, the results are
shown in the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ge_factanal'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ge_factanal_+3A_x">x</code></td>
<td>
<p>An object of class <code>ge_factanal</code>.</p>
</td></tr>
<tr><td><code id="print.ge_factanal_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory</p>
</td></tr>
<tr><td><code id="print.ge_factanal_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.ge_factanal_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.ge_factanal_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;- ge_factanal(data_ge2,
  env = ENV,
  gen = GEN,
  rep = REP,
  resp = PH
)
print(model)

</code></pre>

<hr>
<h2 id='print.ge_reg'>Print an object of class ge_reg</h2><span id='topic+print.ge_reg'></span>

<h3>Description</h3>

<p>Print the <code>ge_reg</code> object in two ways. By default, the results are shown
in the R console. The results can also be exported to the directory into a
*.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ge_reg'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ge_reg_+3A_x">x</code></td>
<td>
<p>An object of class <code>ge_reg</code>.</p>
</td></tr>
<tr><td><code id="print.ge_reg_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.ge_reg_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.ge_reg_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.ge_reg_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(metan)
model &lt;- ge_reg(data_ge2, ENV, GEN, REP, PH)
print(model)

</code></pre>

<hr>
<h2 id='print.ge_stats'>Print an object of class ge_stats</h2><span id='topic+print.ge_stats'></span>

<h3>Description</h3>

<p>Print the <code>ge_stats</code> object in two ways. By default, the results are
shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ge_stats'
print(x, what = "all", export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ge_stats_+3A_x">x</code></td>
<td>
<p>An object of class <code>ge_stats</code>.</p>
</td></tr>
<tr><td><code id="print.ge_stats_+3A_what">what</code></td>
<td>
<p>What should be printed. <code>what = "all"</code> for both statistics
and ranks, <code>what = "stats"</code> for statistics, and <code>what = "ranks"</code>
for ranks.</p>
</td></tr>
<tr><td><code id="print.ge_stats_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.ge_stats_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.ge_stats_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.ge_stats_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- ge_stats(data_ge, ENV, GEN, REP, GY)
print(model)


</code></pre>

<hr>
<h2 id='print.Huehn'>Print an object ofclass <code>Huehn</code></h2><span id='topic+print.Huehn'></span>

<h3>Description</h3>

<p>Print the <code>Huehn</code> object in two ways. By default, the results are
shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Huehn'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.Huehn_+3A_x">x</code></td>
<td>
<p>An object of class <code>Huehn</code>.</p>
</td></tr>
<tr><td><code id="print.Huehn_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.Huehn_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.Huehn_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.Huehn_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- Huehn(data_ge2, ENV, GEN, PH)
print(model)

</code></pre>

<hr>
<h2 id='print.lpcor'>Print the partial correlation coefficients</h2><span id='topic+print.lpcor'></span>

<h3>Description</h3>

<p>Print an object of class <code>lpcor</code> or or <code>lpcor_group</code> in two ways.
By default, the results are shown in the R console. The results can also be
exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lpcor'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.lpcor_+3A_x">x</code></td>
<td>
<p>An object of class <code>lpcor</code> or <code>lpcor_group</code>.</p>
</td></tr>
<tr><td><code id="print.lpcor_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported
to the working directory</p>
</td></tr>
<tr><td><code id="print.lpcor_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.lpcor_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.lpcor_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
pcor &lt;- lpcor(data_ge2, NR, NKR, NKE)
print(pcor)

# Compute the correlations for each level of the factor ENV
lpc2 &lt;- lpcor(data_ge2,
              NR, NKR, NKE,
              by = ENV)
print(lpc2)

</code></pre>

<hr>
<h2 id='print.mgidi'>Print an object of class mgidi
Print a <code>mgidi</code> object in two ways. By default, the results are shown in
the R console. The results can also be exported to the directory.</h2><span id='topic+print.mgidi'></span>

<h3>Description</h3>

<p>Print an object of class mgidi
Print a <code>mgidi</code> object in two ways. By default, the results are shown in
the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mgidi'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.mgidi_+3A_x">x</code></td>
<td>
<p>An object of class <code>mgidi</code>.</p>
</td></tr>
<tr><td><code id="print.mgidi_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE|T</code>, a *.txt file is exported
to the working directory</p>
</td></tr>
<tr><td><code id="print.mgidi_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.mgidi_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.mgidi_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- gamem(data_g,
               gen = GEN,
               rep = REP,
               resp = c(KW, NR, NKE, NKR))
mgidi_index &lt;- mgidi(model)
print(mgidi_index)

</code></pre>

<hr>
<h2 id='print.mtmps'>Print an object of class mtmps</h2><span id='topic+print.mtmps'></span>

<h3>Description</h3>

<p>Print a <code>mtmps</code> object in two ways. By default, the results are shown in
the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mtmps'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.mtmps_+3A_x">x</code></td>
<td>
<p>An object of class <code>mtmps</code>.</p>
</td></tr>
<tr><td><code id="print.mtmps_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE|T</code>, a *.txt file is exported
to the working directory</p>
</td></tr>
<tr><td><code id="print.mtmps_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.mtmps_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.mtmps_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;-
mps(data_ge,
    env = ENV,
    gen = GEN,
    rep = REP,
    resp = everything())
selection &lt;- mtmps(model)
print(selection)

</code></pre>

<hr>
<h2 id='print.mtsi'>Print an object of class mtsi</h2><span id='topic+print.mtsi'></span>

<h3>Description</h3>

<p>Print a <code>mtsi</code> object in two ways. By default, the results are shown in
the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mtsi'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.mtsi_+3A_x">x</code></td>
<td>
<p>An object of class <code>mtsi</code>.</p>
</td></tr>
<tr><td><code id="print.mtsi_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE|T</code>, a *.txt file is exported
to the working directory</p>
</td></tr>
<tr><td><code id="print.mtsi_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.mtsi_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.mtsi_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# Based on stability only
MTSI_MODEL &lt;- waasb(data_ge,
  resp = c(GY, HM),
  gen = GEN,
  env = ENV,
  rep = REP
)

MTSI_index &lt;- mtsi(MTSI_MODEL)
print(MTSI_index)

</code></pre>

<hr>
<h2 id='print.path_coeff'>Print an object of class path_coeff</h2><span id='topic+print.path_coeff'></span>

<h3>Description</h3>

<p>Print an object generated by the function 'path_coeff()'. By default, the
results are shown in the R console. The results can also be exported to the
directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'path_coeff'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.path_coeff_+3A_x">x</code></td>
<td>
<p>An object of class <code>path_coeff</code> or <code>group_path</code>.</p>
</td></tr>
<tr><td><code id="print.path_coeff_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory</p>
</td></tr>
<tr><td><code id="print.path_coeff_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.path_coeff_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.path_coeff_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

# KW as dependent trait and all others as predictors
pcoeff &lt;- path_coeff(data_ge2, resp = KW)
print(pcoeff)

# Call the algorithm for selecting a set of predictors
# With minimal multicollinearity (no VIF larger than 5)
pcoeff2 &lt;- path_coeff(data_ge2,
                      resp = KW,
                      brutstep = TRUE,
                      maxvif = 5)
print(pcoeff2)

</code></pre>

<hr>
<h2 id='print.performs_ammi'>Print an object of class performs_ammi</h2><span id='topic+print.performs_ammi'></span>

<h3>Description</h3>

<p>Print the <code>performs_ammi</code> object in two ways. By default, the results are shown
in the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'performs_ammi'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.performs_ammi_+3A_x">x</code></td>
<td>
<p>An object of class <code>performs_ammi</code>.</p>
</td></tr>
<tr><td><code id="print.performs_ammi_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory</p>
</td></tr>
<tr><td><code id="print.performs_ammi_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.performs_ammi_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.performs_ammi_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- performs_ammi(data_ge, ENV, GEN, REP,
                       resp = c(GY, HM))
print(model)

</code></pre>

<hr>
<h2 id='print.plaisted_peterson'>Print an object of class plaisted_peterson</h2><span id='topic+print.plaisted_peterson'></span>

<h3>Description</h3>

<p>Print the <code>plaisted_peterson</code> object in two ways. By default, the results
are shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plaisted_peterson'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.plaisted_peterson_+3A_x">x</code></td>
<td>
<p>The <code>plaisted_peterson</code> x</p>
</td></tr>
<tr><td><code id="print.plaisted_peterson_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.plaisted_peterson_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.plaisted_peterson_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.plaisted_peterson_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
eco &lt;- ecovalence(data_ge2,
                  env = ENV,
                  gen = GEN,
                  rep = REP,
                  resp = PH)
print(eco)

</code></pre>

<hr>
<h2 id='print.Schmildt'>Print an object of class Schmildt</h2><span id='topic+print.Schmildt'></span>

<h3>Description</h3>

<p>Print the <code>Schmildt</code> object in two ways. By default, the results
are shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Schmildt'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.Schmildt_+3A_x">x</code></td>
<td>
<p>The <code>Schmildt</code> x</p>
</td></tr>
<tr><td><code id="print.Schmildt_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.Schmildt_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.Schmildt_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.Schmildt_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::formatting()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
Sch &lt;- Schmildt(data_ge2,
                env = ENV,
                gen = GEN,
                rep = REP,
                resp = PH)
print(Sch)

</code></pre>

<hr>
<h2 id='print.sh'>Print an object of class sh</h2><span id='topic+print.sh'></span>

<h3>Description</h3>

<p>Print a <code>sh</code> object in two ways. By default, the results are shown in
the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sh'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.sh_+3A_x">x</code></td>
<td>
<p>An object of class <code>sh</code>.</p>
</td></tr>
<tr><td><code id="print.sh_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported
to the working directory</p>
</td></tr>
<tr><td><code id="print.sh_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.sh_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.sh_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
vcov &lt;- covcor_design(data_g, GEN, REP, everything())
means &lt;- as.matrix(vcov$means)
pcov &lt;- vcov$phen_cov
gcov &lt;- vcov$geno_cov

index &lt;- Smith_Hazel(means, pcov = pcov, gcov = gcov, weights = rep(1, 15))
print(index)

</code></pre>

<hr>
<h2 id='print.Shukla'>Print an object of class Shukla</h2><span id='topic+print.Shukla'></span>

<h3>Description</h3>

<p>Print the <code>Shukla</code> object in two ways. By default, the results
are shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Shukla'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.Shukla_+3A_x">x</code></td>
<td>
<p>The <code>Shukla</code> x</p>
</td></tr>
<tr><td><code id="print.Shukla_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.Shukla_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.Shukla_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.Shukla_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
eco &lt;- Shukla(data_ge2,
  env = ENV,
  gen = GEN,
  rep = REP,
  resp = PH
)
print(eco)

</code></pre>

<hr>
<h2 id='print.superiority'>Print an object ofclass <code>superiority</code></h2><span id='topic+print.superiority'></span>

<h3>Description</h3>

<p>Print the <code>superiority</code> object in two ways. By default, the results are
shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'superiority'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.superiority_+3A_x">x</code></td>
<td>
<p>An object of class <code>superiority</code>.</p>
</td></tr>
<tr><td><code id="print.superiority_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.superiority_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.superiority_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.superiority_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- superiority(data_ge2, ENV, GEN, PH)
print(model)

</code></pre>

<hr>
<h2 id='print.Thennarasu'>Print an object ofclass <code>Thennarasu</code></h2><span id='topic+print.Thennarasu'></span>

<h3>Description</h3>

<p>Print the <code>Thennarasu</code> object in two ways. By default, the results are
shown in the R console. The results can also be exported to the directory
into a *.txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Thennarasu'
print(x, export = FALSE, file.name = NULL, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.Thennarasu_+3A_x">x</code></td>
<td>
<p>An object of class <code>Thennarasu</code>.</p>
</td></tr>
<tr><td><code id="print.Thennarasu_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory.</p>
</td></tr>
<tr><td><code id="print.Thennarasu_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.Thennarasu_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.Thennarasu_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- Thennarasu(data_ge2, ENV, GEN, PH)
print(model)

</code></pre>

<hr>
<h2 id='print.waas'>Print an object of class waas</h2><span id='topic+print.waas'></span>

<h3>Description</h3>

<p>Print the <code>waas</code> object in two ways. By default, the results are shown
in the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'waas'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.waas_+3A_x">x</code></td>
<td>
<p>An object of class <code>waas</code>.</p>
</td></tr>
<tr><td><code id="print.waas_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory</p>
</td></tr>
<tr><td><code id="print.waas_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.waas_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.waas_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- waas(data_ge,
  resp = c(GY, HM),
  gen = GEN,
  env = ENV,
  rep = REP
)
print(model)

</code></pre>

<hr>
<h2 id='print.waas_means'>Print an object of class waas_means</h2><span id='topic+print.waas_means'></span>

<h3>Description</h3>

<p>Print the <code>waas_means</code> object in two ways. By default, the results are shown
in the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'waas_means'
print(x, export = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.waas_means_+3A_x">x</code></td>
<td>
<p>An object of class <code>waas_means</code>.</p>
</td></tr>
<tr><td><code id="print.waas_means_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE</code>, a *.txt file is exported to
the working directory</p>
</td></tr>
<tr><td><code id="print.waas_means_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.waas_means_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
<tr><td><code id="print.waas_means_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
data_means &lt;- mean_by(data_ge, ENV, GEN)
model &lt;- waas_means(data_ge,
                    env = ENV,
                    gen = GEN,
                    resp = everything())
print(model)

</code></pre>

<hr>
<h2 id='print.waasb'>Print an object of class waasb</h2><span id='topic+print.waasb'></span>

<h3>Description</h3>

<p>Print a <code>waasb</code> object in two ways. By default, the results are shown in
the R console. The results can also be exported to the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'waasb'
print(x, export = FALSE, blup = FALSE, file.name = NULL, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.waasb_+3A_x">x</code></td>
<td>
<p>An object of class <code>waasb</code>.</p>
</td></tr>
<tr><td><code id="print.waasb_+3A_export">export</code></td>
<td>
<p>A logical argument. If <code>TRUE|T</code>, a *.txt file is exported
to the working directory</p>
</td></tr>
<tr><td><code id="print.waasb_+3A_blup">blup</code></td>
<td>
<p>A logical argument. If <code>TRUE|T</code>, the blups are shown.</p>
</td></tr>
<tr><td><code id="print.waasb_+3A_file.name">file.name</code></td>
<td>
<p>The name of the file if <code>export = TRUE</code></p>
</td></tr>
<tr><td><code id="print.waasb_+3A_digits">digits</code></td>
<td>
<p>The significant digits to be shown.</p>
</td></tr>
<tr><td><code id="print.waasb_+3A_...">...</code></td>
<td>
<p>Options used by the tibble package to format the output. See
<code><a href="tibble.html#topic+formatting">tibble::print()</a></code> for more details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- waasb(data_ge,
  resp = c(GY, HM),
  gen = GEN,
  env = ENV,
  rep = REP
)
print(model)

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+contains'></span><span id='topic+select_helpers'></span><span id='topic+ends_with'></span><span id='topic+everything'></span><span id='topic+matches'></span><span id='topic+num_range'></span><span id='topic+one_of'></span><span id='topic+starts_with'></span><span id='topic+last_col'></span><span id='topic+select'></span><span id='topic+mutate'></span><span id='topic+group_by'></span><span id='topic+rename'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>dplyr</dt><dd><p><code><a href="dplyr.html#topic+group_by">group_by</a></code>, <code><a href="dplyr.html#topic+mutate">mutate</a></code>, <code><a href="dplyr.html#topic+rename">rename</a></code>, <code><a href="dplyr.html#topic+select">select</a></code></p>
</dd>
<dt>tidyselect</dt><dd><p><code><a href="tidyselect.html#topic+starts_with">contains</a></code>, <code><a href="tidyselect.html#topic+starts_with">ends_with</a></code>, <code><a href="tidyselect.html#topic+everything">everything</a></code>, <code><a href="tidyselect.html#topic+everything">last_col</a></code>, <code><a href="tidyselect.html#topic+starts_with">matches</a></code>, <code><a href="tidyselect.html#topic+starts_with">num_range</a></code>, <code><a href="tidyselect.html#topic+one_of">one_of</a></code>, <code><a href="tidyselect.html#topic+starts_with">starts_with</a></code></p>
</dd>
</dl>

<hr>
<h2 id='reorder_cormat'>Reorder a correlation matrix</h2><span id='topic+reorder_cormat'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Reorder the correlation matrix according to the correlation coefficient by
using  hclust for hierarchical clustering order. This is useful to identify
the hidden pattern in the matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reorder_cormat(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reorder_cormat_+3A_x">x</code></td>
<td>
<p>The correlation matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The ordered correlation matrix
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
cor_mat &lt;- corr_coef(data_ge2, PH, EH, CD, CL, ED, NKR)
cor_mat$cor
reorder_cormat(cor_mat$cor)


</code></pre>

<hr>
<h2 id='resca'>Rescale a variable to have specified minimum and maximum values</h2><span id='topic+resca'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Helper function that rescales a continuous variable to have specified minimum
and maximum values.
</p>
<p>The function rescale a continuous variable as follows: </p>
<p style="text-align: center;"><code class="reqn">Rv_i = (Nmax -
Nmin)/(Omax - Omin) * (O_i - Omax) + Nmax</code>
</p>
<p> Where <code class="reqn">Rv_i</code> is the rescaled
value of the ith position of the variable/ vector; <code class="reqn">Nmax</code> and <code class="reqn">Nmin</code>
are the new maximum and minimum values; <code class="reqn">Omax and Omin</code> are the maximum
and minimum values of the original data, and <code class="reqn">O_i</code> is the ith value of
the original data.
</p>
<p>There are basically two options to use <code>resca</code> to rescale a variable.
The first is passing a data frame to <code>.data</code> argument and selecting one
or more variables to be scaled using <code>...</code>. The function will return the
original variables in <code>.data</code> plus the rescaled variable(s) with the
prefix <code style="white-space: pre;">&#8288;_res&#8288;</code>. By using the function <code>group_by</code> from <strong>dplyr</strong>
package it is possible to rescale the variable(s) within each level of the
grouping factor. The second option is pass a numeric vector in the argument
<code>values</code>. The output, of course, will be a numeric vector of rescaled
values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resca(
  .data = NULL,
  ...,
  values = NULL,
  new_min = 0,
  new_max = 100,
  na.rm = TRUE,
  keep = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="resca_+3A_.data">.data</code></td>
<td>
<p>The dataset. Grouped data is allowed.</p>
</td></tr>
<tr><td><code id="resca_+3A_...">...</code></td>
<td>
<p>Comma-separated list of unquoted variable names that will be
rescaled.</p>
</td></tr>
<tr><td><code id="resca_+3A_values">values</code></td>
<td>
<p>Optional vector of values to rescale</p>
</td></tr>
<tr><td><code id="resca_+3A_new_min">new_min</code></td>
<td>
<p>The minimum value of the new scale. Default is 0.</p>
</td></tr>
<tr><td><code id="resca_+3A_new_max">new_max</code></td>
<td>
<p>The maximum value of the new scale. Default is 100</p>
</td></tr>
<tr><td><code id="resca_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove <code>NA</code> values? Default to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="resca_+3A_keep">keep</code></td>
<td>
<p>Should all variables be kept after rescaling? If false, only
rescaled variables will be kept.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector if <code>values</code> is used as input data or a tibble
if a data frame is used as input in <code>.data</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
library(dplyr)
# Rescale a numeric vector
resca(values = c(1:5))

 # Using a data frame
head(
 resca(data_ge, GY, HM, new_min = 0, new_max = 1)
)

# Rescale within factors;
# Select variables that stats with 'N' and ends with 'L';
# Compute the mean of these variables by ENV and GEN;
# Rescale the variables that ends with 'L' whithin ENV;
data_ge2 %&gt;%
  select(ENV, GEN, starts_with("N"), ends_with("L")) %&gt;%
  mean_by(ENV, GEN) %&gt;%
  group_by(ENV) %&gt;%
  resca(ends_with("L")) %&gt;%
  head(n = 13)


</code></pre>

<hr>
<h2 id='residual_plots'>Several types of residual plots</h2><span id='topic+residual_plots'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Residual plots for a output model of class <code>performs_ammi</code>,
<code>waas</code>,  <code>anova_ind</code>, and  <code>anova_joint</code>. Seven types of plots
are produced: (1) Residuals vs fitted, (2) normal Q-Q plot for the residuals,
(3) scale-location plot (standardized residuals vs Fitted Values), (4)
standardized residuals vs Factor-levels, (5) Histogram of raw residuals and
(6) standardized residuals vs observation order, and (7) 1:1 line plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>residual_plots(
  x,
  var = 1,
  conf = 0.95,
  labels = FALSE,
  plot_theme = theme_metan(),
  band.alpha = 0.2,
  point.alpha = 0.8,
  fill.hist = "gray",
  col.hist = "black",
  col.point = "black",
  col.line = "red",
  col.lab.out = "red",
  size.lab.out = 2.5,
  size.tex.lab = 10,
  size.shape = 1.5,
  bins = 30,
  which = c(1:4),
  ncol = NULL,
  nrow = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residual_plots_+3A_x">x</code></td>
<td>
<p>An object of class <code>performs_ammi</code>, <code>waas</code>,
<code>anova_joint</code>, or  <code>gafem</code></p>
</td></tr>
<tr><td><code id="residual_plots_+3A_var">var</code></td>
<td>
<p>The variable to plot. Defaults to <code>var = 1</code> the first
variable of <code>x</code>.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_conf">conf</code></td>
<td>
<p>Level of confidence interval to use in the Q-Q plot (0.95 by
default).</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_labels">labels</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> labels the points outside
confidence interval limits.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_plot_theme">plot_theme</code></td>
<td>
<p>The graphical theme of the plot. Default is
<code>plot_theme = theme_metan()</code>. For more details, see
<code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_band.alpha">band.alpha</code>, <code id="residual_plots_+3A_point.alpha">point.alpha</code></td>
<td>
<p>The transparency of confidence band in the Q-Q
plot and the points, respectively. Must be a number between 0 (opaque) and
1 (full transparency).</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_fill.hist">fill.hist</code></td>
<td>
<p>The color to fill the histogram. Default is 'gray'.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_col.hist">col.hist</code></td>
<td>
<p>The color of the border of the the histogram. Default is
'black'.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_col.point">col.point</code></td>
<td>
<p>The color of the points in the graphic. Default is 'black'.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_col.line">col.line</code></td>
<td>
<p>The color of the lines in the graphic. Default is 'red'.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_col.lab.out">col.lab.out</code></td>
<td>
<p>The color of the labels for the 'outlying' points.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_size.lab.out">size.lab.out</code></td>
<td>
<p>The size of the labels for the 'outlying' points.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_size.tex.lab">size.tex.lab</code></td>
<td>
<p>The size of the text in axis text and labels.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_size.shape">size.shape</code></td>
<td>
<p>The size of the shape in the plots.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_bins">bins</code></td>
<td>
<p>The number of bins to use in the histogram. Default is 30.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_which">which</code></td>
<td>
<p>Which graphics should be plotted. Default is <code>which = c(1:4)</code> that means that the first four graphics will be plotted.</p>
</td></tr>
<tr><td><code id="residual_plots_+3A_ncol">ncol</code>, <code id="residual_plots_+3A_nrow">nrow</code></td>
<td>
<p>The number of columns and rows of the plot pannel. Defaults
to <code>NULL</code></p>
</td></tr>
<tr><td><code id="residual_plots_+3A_...">...</code></td>
<td>
<p>Additional arguments passed on to the function
<code><a href="patchwork.html#topic+wrap_plots">patchwork::wrap_plots()</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
model &lt;- performs_ammi(data_ge, ENV, GEN, REP, GY)

# Default plot
plot(model)

# Normal Q-Q plot
# Label possible outliers
plot(model,
     which = 2,
     labels = TRUE)

# Residual vs fitted,
# Normal Q-Q plot
# Histogram of raw residuals
# All in one row
plot(model,
     which = c(1, 2, 5),
     nrow = 1)

</code></pre>

<hr>
<h2 id='resp_surf'>Response surface model</h2><span id='topic+resp_surf'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Compute a surface model and find the best combination of factor1 and factor2
to obtain the stationary point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resp_surf(
  .data,
  factor1,
  factor2,
  rep = NULL,
  resp,
  prob = 0.05,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="resp_surf_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
factor1, factor2, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="resp_surf_+3A_factor1">factor1</code></td>
<td>
<p>The first factor, for example, dose of Nitrogen.</p>
</td></tr>
<tr><td><code id="resp_surf_+3A_factor2">factor2</code></td>
<td>
<p>The second factor, for example, dose of potassium.</p>
</td></tr>
<tr><td><code id="resp_surf_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks, if a designed experiment was conducted. Defaults to
<code>NULL</code>.</p>
</td></tr>
<tr><td><code id="resp_surf_+3A_resp">resp</code></td>
<td>
<p>The response variable(s).</p>
</td></tr>
<tr><td><code id="resp_surf_+3A_prob">prob</code></td>
<td>
<p>The probability error.</p>
</td></tr>
<tr><td><code id="resp_surf_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose = TRUE</code> then some results are shown in the
console.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# A small toy example

df &lt;- data.frame(
 expand.grid(x = seq(0, 4, by = 1),
             y = seq(0, 4, by = 1)),
 z = c(10, 11, 12, 11, 10,
       14, 15, 16, 15, 14,
       16, 17, 18, 17, 16,
       14, 15, 16, 15, 14,
       10, 11, 12, 11, 10)
)
mod &lt;- resp_surf(df, x, y, resp = z)
plot(mod)


</code></pre>

<hr>
<h2 id='Schmildt'>Schmildt's genotypic confidence index</h2><span id='topic+Schmildt'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Stability analysis using the known genotypic confidence index (Annicchiarico,
1992) modified by Schmildt et al. 2011.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Schmildt(.data, env, gen, rep, resp, prob = 0.05, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Schmildt_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s)</p>
</td></tr>
<tr><td><code id="Schmildt_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="Schmildt_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="Schmildt_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks</p>
</td></tr>
<tr><td><code id="Schmildt_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="Schmildt_+3A_prob">prob</code></td>
<td>
<p>The probability of error assumed.</p>
</td></tr>
<tr><td><code id="Schmildt_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where each element is the result for one variable and contains the
following data frames:
</p>

<ul>
<li> <p><strong>environments</strong> Contains the mean, environmental index and
classification as favorables and unfavorables environments.
</p>
</li>
<li> <p><strong>general</strong> Contains the genotypic confidence index considering all
environments.
</p>
</li>
<li> <p><strong>favorable</strong> Contains the genotypic confidence index considering
favorable environments.
</p>
</li>
<li> <p><strong>unfavorable</strong> Contains the genotypic confidence index considering
unfavorable environments.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto, <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Annicchiarico, P. 1992. Cultivar adaptation and recommendation from alfalfa
trials in Northern Italy. J. Genet. Breed. 46:269-278.
</p>
<p>Schmildt, E.R., A.L. Nascimento, C.D. Cruz, and J.A.R. Oliveira. 2011.
Avaliacao de metodologias de adaptabilidade e estabilidade de cultivares
milho. Acta Sci. - Agron. 33:51-58. <a href="https://doi.org/10.4025/actasciagron.v33i1.5817">doi:10.4025/actasciagron.v33i1.5817</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+superiority">superiority()</a></code>, <code><a href="#topic+ecovalence">ecovalence()</a></code>, <code><a href="#topic+ge_stats">ge_stats()</a></code>,
<code><a href="#topic+Annicchiarico">Annicchiarico()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
Sch &lt;- Schmildt(data_ge2,
                env = ENV,
                gen = GEN,
                rep = REP,
                resp = PH)
print(Sch)


</code></pre>

<hr>
<h2 id='Select_helper'>Select helper</h2><span id='topic+Select_helper'></span><span id='topic+difference_var'></span><span id='topic+intersect_var'></span><span id='topic+union_var'></span><span id='topic+width_of'></span><span id='topic+width_greater_than'></span><span id='topic+width_less_than'></span><span id='topic+lower_case_only'></span><span id='topic+upper_case_only'></span><span id='topic+title_case_only'></span>

<h3>Description</h3>

<p>These functions allow you to select variables based operations
with prefixes and suffixes and length of names.
</p>

<ul>
<li> <p><code>difference_var()</code>: Select variables that start with a prefix <strong>AND
NOT</strong> end wiht a suffix.
</p>
</li>
<li> <p><code>intersect_var()</code>: Select variables that start with a prefix
<strong>AND</strong> end wiht a suffix.
</p>
</li>
<li> <p><code>union_var()</code>: Select variables that start with a prefix <strong>OR</strong>
end wiht a suffix.
</p>
</li>
<li> <p><code>width_of()</code>: Select variables with width of <code>n</code>.
</p>
</li>
<li> <p><code>width_greater_than()</code>: Select variables with width greater than <code>n</code>.
</p>
</li>
<li> <p><code>width_less_than()</code>: Select variables with width less than <code>n</code>.
</p>
</li>
<li> <p><code>lower_case_only()</code>: Select variables that contains lower case only
(e.g., &quot;env&quot;).
</p>
</li>
<li> <p><code>upper_case_only()</code>: Select variables that contains upper case only
(e.g., &quot;ENV&quot;).
</p>
</li>
<li> <p><code>title_case_only()</code>: Select variables that contains upper case in the first
character only (e.g., &quot;Env&quot;).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>difference_var(prefix, suffix)

intersect_var(prefix, suffix)

union_var(prefix, suffix)

width_of(n, vars = peek_vars(fn = "width_of"))

width_greater_than(n, vars = peek_vars(fn = "width_greater_than"))

width_less_than(n, vars = peek_vars(fn = "width_less_than"))

lower_case_only(vars = peek_vars(fn = "lower_case_only"))

upper_case_only(vars = peek_vars(fn = "upper_case_only"))

title_case_only(vars = peek_vars(fn = "title_case_only"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Select_helper_+3A_prefix">prefix</code></td>
<td>
<p>A prefix that start the variable name.</p>
</td></tr>
<tr><td><code id="Select_helper_+3A_suffix">suffix</code></td>
<td>
<p>A suffix that end the variable name.</p>
</td></tr>
<tr><td><code id="Select_helper_+3A_n">n</code></td>
<td>
<p>The length of variable names to select. For <code>width_of()</code> the
selected variables contains <code>n</code> characters. For
<code>width_greater_than()</code> and <code>width_less_than()</code> the selected
variables contains greater and less characteres than <code>n</code>,
respectively.</p>
</td></tr>
<tr><td><code id="Select_helper_+3A_vars">vars</code></td>
<td>
<p>A character vector of variable names. When called from inside
selecting functions like <code><a href="#topic+select_cols">select_cols()</a></code> these are automatically
set to the names of the table.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)


# Select variables that start with "C" and not end with "D".
data_ge2 %&gt;%
select_cols(difference_var("C", "D"))

# Select variables that start with "C" and end with "D".
data_ge2 %&gt;%
select_cols(intersect_var("C", "D"))

# Select variables that start with "C" or end with "D".
data_ge2 %&gt;%
select_cols(union_var("C", "D"))

# Select variables with width name of 4
data_ge2 %&gt;%
select_cols(width_of(4))

# Select variables with width name greater than 2
data_ge2 %&gt;%
select_cols(width_greater_than(2))

# Select variables with width name less than 3
data_ge2 %&gt;%
select_cols(width_less_than(3))

# Creating data with messy column names
df &lt;- head(data_ge, 3)
colnames(df) &lt;- c("Env", "gen", "Rep", "GY", "hm")
select_cols(df, lower_case_only())
select_cols(df, upper_case_only())
select_cols(df, title_case_only())


</code></pre>

<hr>
<h2 id='select_pred'>Selects a best subset of predictor variables.</h2><span id='topic+select_pred'></span>

<h3>Description</h3>

<p>Selects among a set of <code>covariates</code> the best set of <code>npred</code>
predictors for a given response trait <code>resp</code> based on AIC values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_pred(.data, resp, covariates = NULL, npred)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_pred_+3A_.data">.data</code></td>
<td>
<p>A data frame with the response variable and covariates.</p>
</td></tr>
<tr><td><code id="select_pred_+3A_resp">resp</code></td>
<td>
<p>The response variable.</p>
</td></tr>
<tr><td><code id="select_pred_+3A_covariates">covariates</code></td>
<td>
<p>The covariates. Defaults to <em>NULL</em>. In this case, all
numeric traits in <code>.data</code>, except that in <code>resp</code> are selected. To
select specific covariates from <code>.data</code>, use a list of unquoted
comma-separated variable names (e.g. <em>traits = c(var1, var2, var3)</em>),
an specific range of variables, (e.g. <em>traits = c(var1:var3)</em>), or
even a select helper like <code>starts_with("N")</code>.</p>
</td></tr>
<tr><td><code id="select_pred_+3A_npred">npred</code></td>
<td>
<p>An integer specifying the size of the subset of predictors to be
selected</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>

<ul>
<li> <p><strong>sel_mod</strong> An object of class <code>lm</code> that is the selected model.
</p>
</li>
<li> <p><strong>predictors</strong> The name of the selected predictors.
</p>
</li>
<li> <p><strong>AIC</strong> The Akaike's Information Criterion for the selected model.
</p>
</li>
<li> <p><strong>pred_models</strong> The Akaike's Information Criterion and the predictors
selected in each step.
</p>
</li>
<li> <p><strong>predicted</strong> The predicted values considering the model in
<code>sel_mod</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mod &lt;- select_pred(data_ge2, resp = PH, npred = 10)
mod$predictors
mod$AIC

</code></pre>

<hr>
<h2 id='Shukla'>Shukla's stability variance parameter</h2><span id='topic+Shukla'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>The function computes the Shukla's stability variance parameter (1972) and
uses the Kang's nonparametric stability (rank sum) to imcorporate the mean
performance and stability into a single selection criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Shukla(.data, env, gen, rep, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Shukla_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="Shukla_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="Shukla_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="Shukla_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="Shukla_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="Shukla_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>Shukla</code>, which is a list containing the results for each
variable used in the argument <code>resp</code>. For each variable, a tibble with the following
columns is returned.
</p>

<ul>
<li> <p><strong>GEN</strong> the genotype's code.
</p>
</li>
<li> <p><strong>Y</strong> the mean for the response variable.
</p>
</li>
<li> <p><strong>ShuklaVar</strong> The Shukla's stability variance parameter.
</p>
</li>
<li> <p><strong>rMean</strong> The rank for <strong>Y</strong> (decreasing).
</p>
</li>
<li> <p><strong>rShukaVar</strong> The rank for <strong>ShukaVar</strong>.
</p>
</li>
<li> <p><strong>ssiShukaVar</strong> The simultaneous selection index (<code class="reqn">ssiShukaVar = rMean + rShukaVar</code>).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Shukla, G.K. 1972. Some statistical aspects of partitioning
genotype-environmental components of variability. Heredity. 29:238-245.
<a href="https://doi.org/10.1038/hdy.1972.87">doi:10.1038/hdy.1972.87</a>
</p>
<p>Kang, M.S., and H.N. Pham. 1991. Simultaneous Selection for High Yielding and
Stable Crop Genotypes. Agron. J. 83:161.
<a href="https://doi.org/10.2134/agronj1991.00021962008300010037x">doi:10.2134/agronj1991.00021962008300010037x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
out &lt;- Shukla(data_ge2,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = PH)

</code></pre>

<hr>
<h2 id='Smith_Hazel'>Smith-Hazel index</h2><span id='topic+Smith_Hazel'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Computes the Smith (1936) and Hazel (1943) index given economic weights and
phenotypic and genotypic variance-covariance matrices. The Smith-Hazel index
is computed as follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[\bf{b = P^{-1}Aw}\]
</p>
<p>where \(\bf{P}\) and \(\bf{G}\) are phenotypic and genetic
covariance matrices, respectively, and \(\bf{b}\) and \(\bf{w}\)
are vectors of index coefficients and economic weightings, respectively.
</p>
<p>The genetic worth \(I\) of an individual
genotype based on traits <em>x</em>, <em>y</em>, ..., <em>n</em>, is calculated as:
</p>
\[I = b_xG_x + b_yG_y + ... + b_nG_n\]
<p>where <em>b</em> the index coefficient for the traits <em>x</em>, <em>y</em>, ...,
<em>n</em>, respectively, and <em>G</em> is the individual genotype BLUPs for the
traits <em>x</em>, <em>y</em>, ..., <em>n</em>, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Smith_Hazel(
  .data,
  use_data = "blup",
  pcov = NULL,
  gcov = NULL,
  SI = 15,
  weights = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Smith_Hazel_+3A_.data">.data</code></td>
<td>
<p>The input data. It can be either a two-way table with genotypes
in rows and traits in columns, or an object fitted with the function
<code><a href="#topic+gamem">gamem()</a></code>. Please, see <strong>Details</strong> for more details.</p>
</td></tr>
<tr><td><code id="Smith_Hazel_+3A_use_data">use_data</code></td>
<td>
<p>Define which data to use If <code>.data</code> is an object of
class <code>gamem</code>. Defaults to <code>"blup"</code> (the BLUPs for genotypes).
Use <code>"pheno"</code> to use phenotypic means instead BLUPs for computing the
index.</p>
</td></tr>
<tr><td><code id="Smith_Hazel_+3A_pcov">pcov</code>, <code id="Smith_Hazel_+3A_gcov">gcov</code></td>
<td>
<p>The phenotypic and genotypic variance-covariance matrix,
respectively. Defaults to <code>NULL</code>. If a two-way table is informed in
<code>.data</code> these matrices are mandatory.</p>
</td></tr>
<tr><td><code id="Smith_Hazel_+3A_si">SI</code></td>
<td>
<p>The selection intensity (percentage). Defaults to <code>20</code></p>
</td></tr>
<tr><td><code id="Smith_Hazel_+3A_weights">weights</code></td>
<td>
<p>The vector of economic weights. Defaults to a vector of 1s
with the same length of the number of traits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When using the phenotypic means in <code>.data</code>, be sure the genotype's code
are in rownames. If <code>.data</code> is an object of class <code>gamem</code> them the
BLUPs for each genotype are used to compute the index. In this case, the
genetic covariance components are estimated by mean cross products.
</p>


<h3>Value</h3>

<p>An object of class <code>hz</code> containing:
</p>

<ul>
<li> <p><strong>b</strong>: the vector of index coefficient.
</p>
</li>
<li> <p><strong>index</strong>: The genetic worth.
</p>
</li>
<li> <p><strong>sel_dif_trait</strong>: The selection differencial.
</p>
</li>
<li> <p><strong>sel_gen</strong>: The selected genotypes.
</p>
</li>
<li> <p><strong>gcov</strong>: The genotypic variance-covariance matrix
</p>
</li>
<li> <p><strong>pcov</strong>: The phenotypic variance-covariance matrix
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Smith, H.F. 1936. A discriminant function for plant selection. Ann. Eugen.
7:240-250.
<a href="https://doi.org/10.1111/j.1469-1809.1936.tb02143.x">doi:10.1111/j.1469-1809.1936.tb02143.x</a>
</p>
<p>Hazel, L.N. 1943. The genetic basis for constructing selection indexes.
Genetics 28:476-90. https://www.genetics.org/content/28/6/476.short
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtsi">mtsi()</a></code>, <code><a href="#topic+mgidi">mgidi()</a></code>, <code><a href="#topic+fai_blup">fai_blup()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
vcov &lt;- covcor_design(data_g, GEN, REP, everything())
means &lt;- as.matrix(vcov$means)
pcov &lt;- vcov$phen_cov
gcov &lt;- vcov$geno_cov

index &lt;- Smith_Hazel(means, pcov = pcov, gcov = gcov, weights = rep(1, 15))

</code></pre>

<hr>
<h2 id='solve_svd'>Pseudoinverse of a square matrix</h2><span id='topic+solve_svd'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function computes the Moore-Penrose pseudoinverse of a square matrix
using singular value decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solve_svd(x, tolerance = 2.220446e-16)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="solve_svd_+3A_x">x</code></td>
<td>
<p>A square matrix</p>
</td></tr>
<tr><td><code id="solve_svd_+3A_tolerance">tolerance</code></td>
<td>
<p>The tolerance to consider an eigenvalue equals to zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the same dimension of <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto, <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mat &lt;- matrix(c(1, 4, 2, 8), ncol = 2)
det(mat)
solve_svd(mat)

</code></pre>

<hr>
<h2 id='split_factors'>Split a data frame by factors</h2><span id='topic+split_factors'></span><span id='topic+as.split_factors'></span><span id='topic+is.split_factors'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Split a data frame into subsets grouping by one or more factors.
</p>
<p>This function is used to split a data frame into a named list where each
element is a level of the grouping variable (or combination of grouping
variables).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_factors(.data, ..., keep_factors = FALSE)

as.split_factors(.data, keep_factors = FALSE)

is.split_factors(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="split_factors_+3A_.data">.data</code></td>
<td>
<p>The data that will be split. Must contain at least one grouping
variable.</p>
</td></tr>
<tr><td><code id="split_factors_+3A_...">...</code></td>
<td>
<p>Comma-separated list of unquoted variable names that will be used
to split the data.</p>
</td></tr>
<tr><td><code id="split_factors_+3A_keep_factors">keep_factors</code></td>
<td>
<p>Should the grouping columns be kept?</p>
</td></tr>
<tr><td><code id="split_factors_+3A_x">x</code></td>
<td>
<p>An object to check for class <code>split_factors</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>split_factors()</code> Split a data frame by factors.
</p>
</li>
<li> <p><code>as.splict_factors()</code> coerce to an object of class <code>split_factors</code>
</p>
</li>
<li> <p><code>is.splict_factors()</code> check if an object is of class <code>split_factors</code>
</p>
</li></ul>



<h3>Value</h3>

<p>A list where each element is a named level of the grouping factors.
If more than one grouping variable is used, then each element is the
combination of the grouping variables.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

g1 &lt;- split_factors(iris, Species)
g2 &lt;- split_factors(data_ge, ENV, keep_factors = TRUE)

spdata &lt;- as.split_factors(iris)

is.split_factors(spdata)


</code></pre>

<hr>
<h2 id='stars_pval'>Generate significance stars from p-values</h2><span id='topic+stars_pval'></span>

<h3>Description</h3>

<p>Generate significance stars from p-values using R's standard definitions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stars_pval(p_value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stars_pval_+3A_p_value">p_value</code></td>
<td>
<p>A numeric vector of p-values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Mapping from p_value ranges to symbols:
</p>

<ul>
<li> <p><strong>0 - 0.0001</strong>: '****'
</p>
</li>
<li> <p><strong>0.0001 - 0.001</strong>: '***'
</p>
</li>
<li> <p><strong>0.001 - 0.01</strong>: '**'
</p>
</li>
<li> <p><strong>0.01 - 0.05</strong>: '*'
</p>
</li>
<li> <p><strong>0.05 - 1.0</strong>: 'ns'
</p>
</li></ul>



<h3>Value</h3>

<p>A character vector containing the same number of elements as p-value,
with an attribute &quot;legend&quot; providing the conversion pattern.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p_vals &lt;- c(0.01, 0.043, 0.1, 0.0023, 0.000012)
stars_pval(p_vals)


</code></pre>

<hr>
<h2 id='superiority'>Lin e Binns' superiority index</h2><span id='topic+superiority'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Nonparametric stability analysis using the superiority index proposed by Lin
&amp; Binns (1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>superiority(.data, env, gen, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="superiority_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s)</p>
</td></tr>
<tr><td><code id="superiority_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="superiority_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="superiority_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="superiority_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>superiority</code> where each element is the
result of one variable and contains the following items:
</p>

<ul>
<li> <p><strong>environments</strong> The mean for each environment, the environment index
and classification as favorable and unfavorable environments.
</p>
</li>
<li> <p><strong>index</strong> The superiority index computed for all (<code>Pi_a</code>),
favorable (<code>Pi_f</code>) and unfavorable (<code>Pi_u</code>) environments.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto, <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Lin, C.S., and M.R. Binns. 1988. A superiority measure of cultivar
performance for cultivar x location data. Can. J. Plant Sci. 68:193-198.
<a href="https://doi.org/10.4141/cjps88-018">doi:10.4141/cjps88-018</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Annicchiarico">Annicchiarico()</a></code>, <code><a href="#topic+ecovalence">ecovalence()</a></code>, <code><a href="#topic+ge_stats">ge_stats()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
out &lt;- superiority(data_ge2, ENV, GEN, PH)
print(out)


</code></pre>

<hr>
<h2 id='themes'>Personalized theme for ggplot2-based graphics</h2><span id='topic+themes'></span><span id='topic+theme_metan'></span><span id='topic+theme_metan_minimal'></span><span id='topic+transparent_color'></span><span id='topic+ggplot_color'></span><span id='topic+alpha_color'></span>

<h3>Description</h3>


<ul>
<li> <p><code>theme_metan()</code>: Theme with a gray background and major grids.
</p>
</li>
<li> <p><code>theme_metan_minimal()</code>: A minimalistic theme with half-open frame, white
background, and no grid. For more details see <code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>.
</p>
</li>
<li> <p><code>transparent_color()</code>: A helper function to return a transparent color
with Hex value of &quot;#000000FF&quot;
</p>
</li>
<li> <p><code>ggplot_color()</code>: A helper function to emulate ggplot2 default color
palette.
</p>
</li>
<li> <p><code>alpha_color()</code>: Return a semi-transparent color based on a color name
and an alpha value. For more details see <code><a href="grDevices.html#topic+colors">grDevices::colors()</a></code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>theme_metan(grid = "none", col.grid = "white", color.background = "gray95")

theme_metan_minimal()

transparent_color()

ggplot_color(n)

alpha_color(color, alpha = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="themes_+3A_grid">grid</code></td>
<td>
<p>Control the grid lines in plot. Defaults to <code>"both"</code> (x and
y major grids). Allows also <code>grid = "x"</code> for grids in x axis only,
<code>grid = "y"</code> for grid in y axis only, or <code>grid = "none"</code> for no
grids.</p>
</td></tr>
<tr><td><code id="themes_+3A_col.grid">col.grid</code></td>
<td>
<p>The color for the grid lines</p>
</td></tr>
<tr><td><code id="themes_+3A_color.background">color.background</code></td>
<td>
<p>The color for the panel background.</p>
</td></tr>
<tr><td><code id="themes_+3A_n">n</code></td>
<td>
<p>The number of colors. This works well for up to about eight colours,
but after that it becomes hard to tell the different colours apart.</p>
</td></tr>
<tr><td><code id="themes_+3A_color">color</code></td>
<td>
<p>A color name.</p>
</td></tr>
<tr><td><code id="themes_+3A_alpha">alpha</code></td>
<td>
<p>An alpha value for transparency (0 &lt; alpha &lt; 1).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>

<hr>
<h2 id='Thennarasu'>Thennarasu's stability statistics</h2><span id='topic+Thennarasu'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Performs a stability analysis based on Thennarasu (1995) statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Thennarasu(.data, env, gen, resp, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Thennarasu_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="Thennarasu_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="Thennarasu_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="Thennarasu_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure use, for example, <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="Thennarasu_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>Thennarasu</code>, which is a list containing the results
for each variable used in the argument <code>resp</code>. For each variable, a
tibble with the columns GEN, N1, N2, N3 and N4 is returned.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Thennarasu, K. 1995. On certain nonparametric procedures for
studying genotype x environment interactions and yield stability. Ph.D.
thesis. P.J. School, IARI, New Delhi, India.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
out &lt;- Thennarasu(data_ge, ENV, GEN, GY)
print(out)


</code></pre>

<hr>
<h2 id='tidyeval'>Tidy eval helpers</h2><span id='topic+tidyeval'></span><span id='topic+enquo'></span><span id='topic+enquos'></span><span id='topic+.data'></span><span id='topic++3A+3D'></span><span id='topic+as_name'></span><span id='topic+as_label'></span>

<h3>Description</h3>

<p>This page lists the tidy eval tools reexported in this package from
rlang. To learn about using tidy eval in scripts and packages at a
high level, see the <a href="https://dplyr.tidyverse.org/articles/programming.html">dplyr programming vignette</a>
and the <a href="https://ggplot2.tidyverse.org/articles/ggplot2-in-packages.html">ggplot2 in packages vignette</a>.
The <a href="https://adv-r.hadley.nz/metaprogramming.html">Metaprogramming section</a> of <a href="https://adv-r.hadley.nz">Advanced R</a> may also be useful for a deeper dive.
</p>

<ul>
<li><p> The tidy eval operators <code style="white-space: pre;">&#8288;{{&#8288;</code>, <code style="white-space: pre;">&#8288;!!&#8288;</code>, and <code style="white-space: pre;">&#8288;!!!&#8288;</code> are syntactic
constructs which are specially interpreted by tidy eval functions.
You will mostly need <code style="white-space: pre;">&#8288;{{&#8288;</code>, as <code style="white-space: pre;">&#8288;!!&#8288;</code> and <code style="white-space: pre;">&#8288;!!!&#8288;</code> are more advanced
operators which you should not have to use in simple cases.
</p>
<p>The curly-curly operator <code style="white-space: pre;">&#8288;{{&#8288;</code> allows you to tunnel data-variables
passed from function arguments inside other tidy eval functions.
<code style="white-space: pre;">&#8288;{{&#8288;</code> is designed for individual arguments. To pass multiple
arguments contained in dots, use <code>...</code> in the normal way.
</p>
<div class="sourceCode"><pre>my_function &lt;- function(data, var, ...) {
  data %&gt;%
    group_by(...) %&gt;%
    summarise(mean = mean({{ var }}))
}
</pre></div>
</li>
<li> <p><code><a href="#topic+enquo">enquo()</a></code> and <code><a href="#topic+enquos">enquos()</a></code> delay the execution of one or several
function arguments. The former returns a single expression, the
latter returns a list of expressions. Once defused, expressions
will no longer evaluate on their own. They must be injected back
into an evaluation context with <code style="white-space: pre;">&#8288;!!&#8288;</code> (for a single expression) and
<code style="white-space: pre;">&#8288;!!!&#8288;</code> (for a list of expressions).
</p>
<div class="sourceCode"><pre>my_function &lt;- function(data, var, ...) {
  # Defuse
  var &lt;- enquo(var)
  dots &lt;- enquos(...)

  # Inject
  data %&gt;%
    group_by(!!!dots) %&gt;%
    summarise(mean = mean(!!var))
}
</pre></div>
<p>In this simple case, the code is equivalent to the usage of <code style="white-space: pre;">&#8288;{{&#8288;</code>
and <code>...</code> above. Defusing with <code>enquo()</code> or <code>enquos()</code> is only
needed in more complex cases, for instance if you need to inspect
or modify the expressions in some way.
</p>
</li>
<li><p> The <code>.data</code> pronoun is an object that represents the current
slice of data. If you have a variable name in a string, use the
<code>.data</code> pronoun to subset that variable with <code>[[</code>.
</p>
<div class="sourceCode"><pre>my_var &lt;- "disp"
mtcars %&gt;% summarise(mean = mean(.data[[my_var]]))
</pre></div>
</li>
<li><p> Another tidy eval operator is <code style="white-space: pre;">&#8288;:=&#8288;</code>. It makes it possible to use
glue and curly-curly syntax on the LHS of <code>=</code>. For technical
reasons, the R language doesn't support complex expressions on
the left of <code>=</code>, so we use <code style="white-space: pre;">&#8288;:=&#8288;</code> as a workaround.
</p>
<div class="sourceCode"><pre>my_function &lt;- function(data, var, suffix = "foo") {
  # Use `{{` to tunnel function arguments and the usual glue
  # operator `{` to interpolate plain strings.
  data %&gt;%
    summarise("{{ var }}_mean_{suffix}" := mean({{ var }}))
}
</pre></div>
</li>
<li><p> Many tidy eval functions like <code>dplyr::mutate()</code> or
<code>dplyr::summarise()</code> give an automatic name to unnamed inputs. If
you need to create the same sort of automatic names by yourself,
use <code>as_label()</code>. For instance, the glue-tunnelling syntax above
can be reproduced manually with:
</p>
<div class="sourceCode"><pre>my_function &lt;- function(data, var, suffix = "foo") {
  var &lt;- enquo(var)
  prefix &lt;- as_label(var)
  data %&gt;%
    summarise("{prefix}_mean_{suffix}" := mean(!!var))
}
</pre></div>
<p>Expressions defused with <code>enquo()</code> (or tunnelled with <code style="white-space: pre;">&#8288;{{&#8288;</code>) need
not be simple column names, they can be arbitrarily complex.
<code>as_label()</code> handles those cases gracefully. If your code assumes
a simple column name, use <code>as_name()</code> instead. This is safer
because it throws an error if the input is not a name as expected.
</p>
</li></ul>


<hr>
<h2 id='transpose_df'>Transpose a data frame</h2><span id='topic+transpose_df'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Is an alternative to <code><a href="base.html#topic+t">t()</a></code> to transpose a data frame. The first
column of <code>df</code> will become column names in the transposed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transpose_df(df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transpose_df_+3A_df">df</code></td>
<td>
<p>A data frame to be transposed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing the transposed data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
df &lt;-
data.frame(
 GEN = c("G1", "G2", "G3","G4"),
 E1 = rnorm(4, 100, 20),
 E2 = rnorm(4, 10, 2),
 E3 = rnorm(4, 50, 5),
 E4 = rnorm(4, 1000, 150)
)
df
t(df)
transpose_df(df)

</code></pre>

<hr>
<h2 id='tukey_hsd'>Tukey Honest Significant Differences</h2><span id='topic+tukey_hsd'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Helper function to perform Tukey post-hoc tests. It is used in <a href="#topic+gafem">gafem</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tukey_hsd(model, ..., out = "long")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tukey_hsd_+3A_model">model</code></td>
<td>
<p>an object of class <code>aov</code> or <code>lm</code>.</p>
</td></tr>
<tr><td><code id="tukey_hsd_+3A_...">...</code></td>
<td>
<p>other arguments passed to the function
<code><a href="stats.html#topic+TukeyHSD">stats::TukeyHSD()</a></code>. These include:
</p>

<ul>
<li> <p><strong>which</strong>: A character vector listing terms in the fitted model for which the
intervals should be calculated. Defaults to all the terms.
</p>
</li>
<li> <p><strong>ordered</strong>: A logical value indicating if the levels of the factor should be
ordered according to increasing average in the sample before taking
differences. If ordered is true then the calculated differences in the means
will all be positive. The significant differences will be those for which the
lwr end point is positive.
</p>
</li></ul>
</td></tr>
<tr><td><code id="tukey_hsd_+3A_out">out</code></td>
<td>
<p>The format of outputs. If <code>out = "long"</code> a 'long' format
(tibble) is returned. If <code>out = "wide"</code>, a matrix with the adjusted
p-values for each term is returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble data frame containing the results of the pairwise
comparisons (if <code>out = "long"</code>) or a &quot;list-columns&quot; with p-values for
each term (if <code>out = "wide"</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
mod &lt;- lm(PH ~ GEN + REP, data = data_g)
tukey_hsd(mod)
tukey_hsd(mod, out = "wide")

</code></pre>

<hr>
<h2 id='utils_as'>Encode variables to a specific format</h2><span id='topic+utils_as'></span><span id='topic+as_numeric'></span><span id='topic+as_integer'></span><span id='topic+as_logical'></span><span id='topic+as_character'></span><span id='topic+as_factor'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Function to quick encode vector or columns to a specific format.
</p>

<ul>
<li> <p><code>as_numeric()</code>: Encode columns to numeric using
<code><a href="base.html#topic+as.numeric">as.numeric()</a></code>.
</p>
</li>
<li> <p><code>as_integer()</code>: Encode columns to integer using
<code><a href="base.html#topic+as.integer">as.integer()</a></code>.
</p>
</li>
<li> <p><code>as_logical()</code>: Encode columns to logical using
<code><a href="base.html#topic+as.logical">as.logical()</a></code>.
</p>
</li>
<li> <p><code>as_character()</code>: Encode columns to character using
<code><a href="base.html#topic+as.character">as.character()</a></code>.
</p>
</li>
<li> <p><code>as_factor()</code>: Encode columns to factor using
<code><a href="base.html#topic+as.factor">as.factor()</a></code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>as_numeric(.data, ..., .keep = "all", .pull = FALSE)

as_integer(.data, ..., .keep = "all", .pull = FALSE)

as_logical(.data, ..., .keep = "all", .pull = FALSE)

as_character(.data, ..., .keep = "all", .pull = FALSE)

as_factor(.data, ..., .keep = "all", .pull = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_as_+3A_.data">.data</code></td>
<td>
<p>A data frame or a vector.</p>
</td></tr>
<tr><td><code id="utils_as_+3A_...">...</code></td>
<td>
<p>If <code>.data</code> is a data
frame, then <code>...</code> are the variable(s) to encode to a format.</p>
</td></tr>
<tr><td><code id="utils_as_+3A_.keep">.keep</code></td>
<td>
<p>Allows you to control which columns from <code>.data</code> are
retained in the output.
</p>

<ul>
<li> <p><code>"all"</code> (default) retains all variables.
</p>
</li>
<li> <p><code>"used"</code> keeps any variables used to make new variables.
</p>
</li></ul>
</td></tr>
<tr><td><code id="utils_as_+3A_.pull">.pull</code></td>
<td>
<p>Allows you to pull out the last column of the output. It is
useful in combination with <code>.keep = "used"</code>. In this case, a vector
will be created with the used column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same class of <code>.data</code> with the variables in
<code>...</code> encoded to the specified format.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
library(tibble)
df &lt;-
  tibble(y = rnorm(5),
         x1 = c(1:5),
         x2 = c(TRUE, TRUE, FALSE, FALSE, FALSE),
         x3 = letters[1:5],
         x4 = as.factor(x3))
df

# Convert y to integer
as_integer(df, y)
as_integer(df$y)

# convert x3 to factor
as_factor(df, x3)

# Convert all columns to character
as_character(df, everything())

# Convert x2 to numeric and coerce to a vector
as_numeric(df, x2, .keep = "used", .pull = TRUE)


</code></pre>

<hr>
<h2 id='utils_bind'>Helper function for binding rows</h2><span id='topic+utils_bind'></span><span id='topic+rbind_fill_id'></span>

<h3>Description</h3>


<ul>
<li> <p><code><a href="#topic+rbind_fill_id">rbind_fill_id()</a></code> <a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a> Implements the common pattern of <code>do.call(rbind, dfs)</code>
with data frame identifier and filling of missing values.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>rbind_fill_id(..., .id = NULL, .fill = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_bind_+3A_...">...</code></td>
<td>
<p>The dataframes. Either a list of data frames, or a comma-separated
list of dataframes.</p>
</td></tr>
<tr><td><code id="utils_bind_+3A_.id">.id</code></td>
<td>
<p>Data frame identifier. If a comma-separated list of data frames is
supplied, the labels are taken from the names of the objects. When a list
of data frames is supplied, the labels are taken from the names of the
list. If no names are found, a numeric sequence is used instead.</p>
</td></tr>
<tr><td><code id="utils_bind_+3A_.fill">.fill</code></td>
<td>
<p>When row-binding, columns are matched by name, and any missing
columns will be filled with <code>NA</code> Defaults to <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
(df1 &lt;- data.frame(v1 = c(1, 2), v2 = c(2, 3)))
(df2 &lt;- data.frame(v3 = c(4, 5)))
rbind_fill_id(df1, df2)
rbind_fill_id(df1, df2,
             .fill = ".",
             .id = "dfs")

# Named list
list &lt;- list(a = df1, b = df2)
rbind_fill_id(list, .id = "dfs")

# Unnamed list
list &lt;- list(df1, df2)
rbind_fill_id(list, .id = "dfs")



</code></pre>

<hr>
<h2 id='utils_class'>Utilities for handling with classes</h2><span id='topic+utils_class'></span><span id='topic+add_class'></span><span id='topic+has_class'></span><span id='topic+remove_class'></span><span id='topic+set_class'></span>

<h3>Description</h3>

<p>Utilities for handling with classes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_class(x, class)

has_class(x, class)

remove_class(x, class)

set_class(x, class)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_class_+3A_x">x</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="utils_class_+3A_class">class</code></td>
<td>
<p>The class to add or remove</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>add_class()</code>: add a class to the object <code>x</code> keeping all the other class(es).
</p>
</li>
<li> <p><code>has_class()</code>: Check if a class exists in object <code>x</code> and returns a logical value.
</p>
</li>
<li> <p><code>set_class()</code>: set a class to the object <code>x</code>.
</p>
</li>
<li> <p><code>remove_class()</code>: remove a class from the object <code>x</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>The object <code>x</code> with the class added or removed.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
df &lt;-
data_ge2 %&gt;%
add_class("my_class")
class(df)
has_class(df, "my_class")
remove_class(df, "my_class") %&gt;% class()
set_class(df, "data_frame") %&gt;% class()


</code></pre>

<hr>
<h2 id='utils_data'>Utilities for data Copy-Pasta</h2><span id='topic+utils_data'></span><span id='topic+clip_read'></span><span id='topic+clip_write'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>These functions allows interacting with the system clipboard. It is possible
read from the clipboard or write a data frame or matrix to the clipboard.
</p>

<ul>
<li> <p><code>clip_read()</code> read data from the clipboard.
</p>
</li>
<li> <p><code>clip_write()</code> write data to the clipboard.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>clip_read(header = TRUE, sep = "\t", ...)

clip_write(.data, sep = "\t", row_names = FALSE, col_names = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_data_+3A_header">header</code></td>
<td>
<p>If the copied data has a header row for dataFrame, defaults to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="utils_data_+3A_sep">sep</code></td>
<td>
<p>The separator which should be used in the copied output.</p>
</td></tr>
<tr><td><code id="utils_data_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code><a href="utils.html#topic+read.table">utils::read.table()</a></code>.</p>
</td></tr>
<tr><td><code id="utils_data_+3A_.data">.data</code></td>
<td>
<p>The data that should be copied to the clipboard. Only data frames and matrices are allowed</p>
</td></tr>
<tr><td><code id="utils_data_+3A_row_names">row_names</code></td>
<td>
<p>Decides if the output should keep row names or not, defaults
to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="utils_data_+3A_col_names">col_names</code></td>
<td>
<p>Decides if the output should keep column names or not,
defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>

<hr>
<h2 id='utils_data_org'>Utilities for data organization</h2><span id='topic+utils_data_org'></span><span id='topic+add_seq_block'></span><span id='topic+recode_factor'></span><span id='topic+df_to_selegen_54'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Useful function for data organization before statistical analysis
</p>

<ul>
<li> <p><code>add_seq_block()</code>: Add a column with sequential block numeration in
multi-environment data sets.
</p>
</li>
<li> <p><code>recode_factor()</code>: Recode a factor column. A sequential numbering (with
possible prefix) is used to identify each level.
</p>
</li>
<li> <p><code>df_to_selegen_54()</code>: Given a multi-environment data with environment,
genotype, and replication, format the data to be used in the Selegen software
(model 54).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>add_seq_block(data, env, rep, new_factor = BLOCK, prefix = "", verbose = TRUE)

recode_factor(data, factor, new_factor = CODE, prefix = "", verbose = TRUE)

df_to_selegen_54(data, env, gen, rep, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_data_org_+3A_data">data</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="utils_data_org_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="utils_data_org_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="utils_data_org_+3A_new_factor">new_factor</code></td>
<td>
<p>The name of the new column created.</p>
</td></tr>
<tr><td><code id="utils_data_org_+3A_prefix">prefix</code></td>
<td>
<p>An optional prefix to bind with the new factor.</p>
</td></tr>
<tr><td><code id="utils_data_org_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
<tr><td><code id="utils_data_org_+3A_factor">factor</code></td>
<td>
<p>A column to recode.</p>
</td></tr>
<tr><td><code id="utils_data_org_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes,
that will be treated as random effect.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Resende, M.D. V. 2016. Software Selegen-REML/BLUP: a useful tool for plant
breeding. Crop Breed. Appl. Biotechnol. 16(4): 330–339.
<a href="https://doi.org/10.1590/1984-70332016v16n4a49">doi:10.1590/1984-70332016v16n4a49</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
df_ge &lt;- ge_simula(ngen = 2,
                   nenv = 3,
                   nrep = 2) %&gt;%
         add_cols(ENV = c(rep("CACIQUE", 4),
                          rep("FREDERICO", 4),
                          rep("SANTA_MARIA", 4)))
df_ge

# Add sequential block numbering over environments
add_seq_block(df_ge, ENV, REP, prefix = "B")

# Recode the 'ENV' column to "ENV1", "ENV2", and so on.
recode_factor(df_ge,
              factor = ENV,
              prefix = "ENV",
              new_factor = ENV_CODE)

# Format the data to be used in the Selegen software (model 54)
df &lt;- df_to_selegen_54(df_ge, ENV, GEN, REP) %&gt;%
recode_factor(ENV, prefix = "E", new_factor = ENV)


</code></pre>

<hr>
<h2 id='utils_mat'>Utilities for handling with matrices</h2><span id='topic+utils_mat'></span><span id='topic+make_upper_tri'></span><span id='topic+make_lower_tri'></span><span id='topic+make_lower_upper'></span><span id='topic+make_sym'></span><span id='topic+tidy_sym'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>These functions help users to make upper, lower, or symmetric matrices
easily.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_upper_tri(x, diag = NA)

make_lower_tri(x, diag = NA)

make_lower_upper(lower, upper, diag = NA)

make_sym(x, make = "upper", diag = NA)

tidy_sym(x, keep_diag = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_mat_+3A_x">x</code></td>
<td>
<p>A matrix to apply the function. It must be a symmetric (square)
matrix in <code>make_upper_tri()</code> and <code>make_lower_tri()</code> or a
triangular matrix in <code>make_sym()</code>. <code>tidy_sym()</code> accepts both
symmetrical or triangular matrices.</p>
</td></tr>
<tr><td><code id="utils_mat_+3A_diag">diag</code></td>
<td>
<p>What show in the diagonal of the matrix. Default to <code>NA</code>.</p>
</td></tr>
<tr><td><code id="utils_mat_+3A_lower">lower</code></td>
<td>
<p>A square matrix to fill the lower diagonal of the new matrix.</p>
</td></tr>
<tr><td><code id="utils_mat_+3A_upper">upper</code></td>
<td>
<p>A square matrix to fill the upper diagonal of the new matrix.</p>
</td></tr>
<tr><td><code id="utils_mat_+3A_make">make</code></td>
<td>
<p>The triangular to built. Default is <code>"upper"</code>. In this case,
a symmetric matrix will be built based on the values of a lower triangular
matrix.</p>
</td></tr>
<tr><td><code id="utils_mat_+3A_keep_diag">keep_diag</code></td>
<td>
<p>Keep diagonal values in the tidy data frame? Defaults to
<code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>make_upper_tri()</code> makes an upper triangular matrix using a symmetric
matrix.
</p>
</li>
<li> <p><code>make_lower_tri()</code> makes a lower triangular matrix using a symmetric
matrix.
</p>
</li>
<li> <p><code>make_sym()</code> makes a lower triangular matrix using a symmetric matrix.
</p>
</li>
<li> <p><code>tidy_sym()</code> transform a symmetric matrix into tidy data frame.
</p>
</li></ul>



<h3>Value</h3>

<p>An upper, lower, or symmetric matrix, or a tidy data frame.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
m &lt;- cor(select_cols(data_ge2, 5:10))
make_upper_tri(m)
make_lower_tri(m)
make_lower_tri(m) %&gt;%
make_sym(diag = 0)
tidy_sym(m)
tidy_sym(make_lower_tri(m))



</code></pre>

<hr>
<h2 id='utils_na_zero'>Utilities for handling with NA and zero values</h2><span id='topic+utils_na_zero'></span><span id='topic+fill_na'></span><span id='topic+has_na'></span><span id='topic+prop_na'></span><span id='topic+remove_rows_na'></span><span id='topic+remove_rows_all_na'></span><span id='topic+remove_cols_na'></span><span id='topic+remove_cols_all_na'></span><span id='topic+select_cols_na'></span><span id='topic+select_rows_na'></span><span id='topic+replace_na'></span><span id='topic+random_na'></span><span id='topic+has_zero'></span><span id='topic+remove_rows_zero'></span><span id='topic+remove_cols_zero'></span><span id='topic+select_cols_zero'></span><span id='topic+select_rows_zero'></span><span id='topic+replace_zero'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>NAs and zeros can increase the noise in multi-environment trial analysis.
This collection of functions will make it easier to deal with them.
</p>

<ul>
<li> <p><code>fill_na()</code>: Fills <code>NA</code> in selected columns using the next or
previous entry.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;has_na(), has_zero()&#8288;</code>: Check for <code>NAs</code> and <code style="white-space: pre;">&#8288;0s&#8288;</code> in the
data and return a logical value.
</p>
</li>
<li> <p><code>prop_na()</code> returns the proportion of <code>NAs</code> in each column of a data frame.
</p>
</li>
<li> <p><code>random_na()</code>: Generate random <code>NA</code> values in a two-way table
based on a desired proportion.
</p>
</li>
<li> <p><code>remove_cols_na()</code>, <code>remove_rows_na()</code>: Remove columns and rows that
contains at least one <code>NA</code> value.
</p>
</li>
<li> <p><code>remove_cols_all_na()</code>, <code>remove_rows_all_na()</code>: Remove columns and rows
where all values are <code>NAs</code>.
</p>
</li>
<li> <p><code>remove_cols_zero()</code>, <code>remove_rows_zero()</code>: Remove columns and rows that
contains at least one <code>0</code> value, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;select_cols_na(), select_cols_zero()&#8288;</code>: Select columns with <code>NAs</code>
and <code style="white-space: pre;">&#8288;0s&#8288;</code>, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;select_rows_na(), select_rows_zero()&#8288;</code>: Select rows with <code>NAs</code>
and <code style="white-space: pre;">&#8288;0s&#8288;</code>, respectively.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;replace_na(), replace_zero()&#8288;</code>: Replace <code>NAs</code> and <code style="white-space: pre;">&#8288;0s&#8288;</code>,
respectively, with a <code>replacement</code> value.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>fill_na(.data, ..., direction = "down")

has_na(.data)

prop_na(.data, ...)

remove_rows_na(.data, verbose = TRUE)

remove_rows_all_na(.data, verbose = TRUE)

remove_cols_na(.data, verbose = TRUE)

remove_cols_all_na(.data, verbose = TRUE)

select_cols_na(.data, verbose = TRUE)

select_rows_na(.data, verbose = TRUE)

replace_na(.data, ..., replacement = 0)

random_na(.data, prop)

has_zero(.data)

remove_rows_zero(.data, verbose = TRUE)

remove_cols_zero(.data, verbose = TRUE)

select_cols_zero(.data, verbose = TRUE)

select_rows_zero(.data, verbose = TRUE)

replace_zero(.data, ..., replacement = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_na_zero_+3A_.data">.data</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="utils_na_zero_+3A_...">...</code></td>
<td>
<p>Variables to fill  <code>NAs</code> in <code>fill_na()</code>, replace
<code>NAs</code> in <code>replace_na()</code> or zeros in <code>replace_zero()</code>. If
<code>...</code> is null then all variables in <code>.data</code> will be evaluated. It
must be a single variable name or a comma-separated list of unquoted
variables names. Select helpers are also allowed.</p>
</td></tr>
<tr><td><code id="utils_na_zero_+3A_direction">direction</code></td>
<td>
<p>Direction in which to fill missing values. Currently either
&quot;down&quot; (the default), &quot;up&quot;, &quot;downup&quot; (i.e. first down and then up) or
&quot;updown&quot; (first up and then down).</p>
</td></tr>
<tr><td><code id="utils_na_zero_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> (default) shows in console
the rows or columns deleted.</p>
</td></tr>
<tr><td><code id="utils_na_zero_+3A_replacement">replacement</code></td>
<td>
<p>The value used for replacement. Defaults to <code>0</code>. Other
possible values are Use <code>"colmean"</code>, <code>"colmin"</code>, and <code>"colmax"</code> to replace
missing values with column mean, minimum and maximum values, respectively.</p>
</td></tr>
<tr><td><code id="utils_na_zero_+3A_prop">prop</code></td>
<td>
<p>The proportion (percentage) of <code>NA</code> values to generate in
<code>.data</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with rows or columns with <code>NA</code> values deleted.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
data_naz &lt;- iris %&gt;%
              group_by(Species) %&gt;%
              doo(~head(., n = 3)) %&gt;%
              as_character(Species)
data_naz
data_naz[c(2:3, 6, 8), c(1:2, 4, 5)] &lt;- NA
data_naz[c(2, 7, 9), c(2, 3, 4)] &lt;- 0
has_na(data_naz)
has_zero(data_naz)

# Fill NA values of column GEN
fill_na(data_naz, Species)

# Remove columns
remove_cols_na(data_naz)
remove_cols_zero(data_naz)
remove_rows_na(data_naz)
remove_rows_zero(data_naz)

# Select columns
select_cols_na(data_naz)
select_cols_zero(data_naz)
select_rows_na(data_naz)
select_rows_zero(data_naz)

# Replace values
replace_na(data_naz)
replace_zero(data_naz)


</code></pre>

<hr>
<h2 id='utils_num_str'>Utilities for handling with numbers and strings</h2><span id='topic+utils_num_str'></span><span id='topic+all_upper_case'></span><span id='topic+all_lower_case'></span><span id='topic+all_title_case'></span><span id='topic+first_upper_case'></span><span id='topic+extract_number'></span><span id='topic+extract_string'></span><span id='topic+find_text_in_num'></span><span id='topic+has_text_in_num'></span><span id='topic+remove_space'></span><span id='topic+remove_strings'></span><span id='topic+replace_number'></span><span id='topic+replace_string'></span><span id='topic+round_cols'></span><span id='topic+tidy_strings'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code>all_lower_case()</code>: Translate all non-numeric strings of a data frame
to lower case.
</p>
</li>
<li> <p><code>all_upper_case()</code>: Translate all non-numeric strings of a data frame
to upper case.
</p>
</li>
<li> <p><code>all_title_case()</code>: Translate all non-numeric strings of a data frame
to title case.
</p>
</li>
<li> <p><code>first_upper_case</code>: Translate the first word of a string to upper
case.
</p>
</li>
<li> <p><code>extract_number()</code>: Extract the number(s) of a string.
</p>
</li>
<li> <p><code>extract_string()</code>: Extract all strings, ignoring case.
</p>
</li>
<li> <p><code>find_text_in_num()</code>: Find text characters in a numeric sequence and
return the row index.
</p>
</li>
<li> <p><code>has_text_in_num()</code>: Inspect columns looking for text in numeric
sequence and return a warning if text is found.
</p>
</li>
<li> <p><code>remove_space()</code>: Remove all blank spaces of a string.
</p>
</li>
<li> <p><code>remove_strings()</code>: Remove all strings of a variable.
</p>
</li>
<li> <p><code>replace_number()</code>: Replace numbers with a replacement.
</p>
</li>
<li> <p><code>replace_string()</code>: Replace all strings with a replacement, ignoring
case.
</p>
</li>
<li> <p><code>round_cols()</code>: Round a selected column or a whole data frame to
significant figures.
</p>
</li>
<li> <p><code>tidy_strings()</code>: Tidy up characters strings, non-numeric columns, or
any selected columns in a data frame by putting all word in upper case,
replacing any space, tabulation, punctuation characters by <code>'_'</code>, and
putting <code>'_'</code> between lower and upper case. Suppose that <code>str = c("Env1", "env 1", "env.1")</code> (which by definition should represent a unique
level in plant breeding trials, e.g., environment 1) is subjected to
<code>tidy_strings(str)</code>: the result will be then <code>c("ENV_1", "ENV_1", "ENV_1")</code>. See Examples section for more examples.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>all_upper_case(.data, ...)

all_lower_case(.data, ...)

all_title_case(.data, ...)

first_upper_case(.data, ...)

extract_number(.data, ..., pattern = NULL)

extract_string(.data, ..., pattern = NULL)

find_text_in_num(.data, ...)

has_text_in_num(.data)

remove_space(.data, ...)

remove_strings(.data, ...)

replace_number(
  .data,
  ...,
  pattern = NULL,
  replacement = "",
  ignore_case = FALSE
)

replace_string(
  .data,
  ...,
  pattern = NULL,
  replacement = "",
  ignore_case = FALSE
)

round_cols(.data, ..., digits = 2)

tidy_strings(.data, ..., sep = "_")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_num_str_+3A_.data">.data</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="utils_num_str_+3A_...">...</code></td>
<td>
<p>The argument depends on the function used.
</p>

<ul>
<li><p> For <code>round_cols()</code> <code>...</code> are the variables to round. If no
variable is informed, all the numeric variables from <code>data</code> are used.
</p>
</li>
<li><p> For <code>all_lower_case()</code>, <code>all_upper_case()</code>,
<code>all_title_case()</code>, <code>stract_number()</code>, <code>stract_string()</code>,
<code>remove_strings()</code>, and <code>tidy_strings()</code> <code>...</code> are the
variables to apply the function. If no variable is informed, the function
will be applied to all non-numeric variables in <code>.data</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="utils_num_str_+3A_pattern">pattern</code></td>
<td>
<p>A string to be matched. Regular Expression Syntax is also
allowed.</p>
</td></tr>
<tr><td><code id="utils_num_str_+3A_replacement">replacement</code></td>
<td>
<p>A string for replacement.</p>
</td></tr>
<tr><td><code id="utils_num_str_+3A_ignore_case">ignore_case</code></td>
<td>
<p>If <code>FALSE</code> (default), the pattern matching is case
sensitive and if <code>TRUE</code>, case is ignored during matching.</p>
</td></tr>
<tr><td><code id="utils_num_str_+3A_digits">digits</code></td>
<td>
<p>The number of significant figures.</p>
</td></tr>
<tr><td><code id="utils_num_str_+3A_sep">sep</code></td>
<td>
<p>A character string to separate the terms. Defaults to &quot;_&quot;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

################ Rounding numbers ###############
# All numeric columns
round_cols(data_ge2, digits = 1)

# Round specific columns
round_cols(data_ge2, EP, digits = 1)

########### Extract or replace numbers ##########
# Extract numbers
extract_number(data_ge, GEN)
# Replace numbers
replace_number(data_ge, GEN)
replace_number(data_ge,
               GEN,
               pattern = 1,
               replacement = "_one")

########## Extract, replace or remove strings ##########
# Extract strings
extract_string(data_ge, GEN)

# Replace strings
replace_string(data_ge, GEN)
replace_string(data_ge,
               GEN,
               pattern = "G",
               replacement = "GENOTYPE_")

# Remove strings
remove_strings(data_ge)
remove_strings(data_ge, ENV)


############ Find text in numeric sequences ###########
mixed_text &lt;- data.frame(data_ge)
mixed_text[2, 4] &lt;- "2..503"
mixed_text[3, 4] &lt;- "3.2o75"
find_text_in_num(mixed_text, GY)

############# upper, lower and title cases ############
gen_text &lt;- c("This is the first string.", "this is the second one")
all_lower_case(gen_text)
all_upper_case(gen_text)
all_title_case(gen_text)
first_upper_case(gen_text)

# A whole data frame
all_lower_case(data_ge)


############### Tidy up messy text string ##############
messy_env &lt;- c("ENV 1", "Env   1", "Env1", "env1", "Env.1", "Env_1")
tidy_strings(messy_env)

messy_gen &lt;- c("GEN1", "gen 2", "Gen.3", "gen-4", "Gen_5", "GEN_6")
tidy_strings(messy_gen)

messy_int &lt;- c("EnvGen", "Env_Gen", "env gen", "Env Gen", "ENV.GEN", "ENV_GEN")
tidy_strings(messy_int)

library(tibble)
# Or a whole data frame
df &lt;- tibble(Env = messy_env,
             gen = messy_gen,
             Env_GEN = interaction(Env, gen),
             y = rnorm(6, 300, 10))
df
tidy_strings(df)

</code></pre>

<hr>
<h2 id='utils_progress'>Utilities for text progress bar in the terminal</h2><span id='topic+utils_progress'></span><span id='topic+progress'></span><span id='topic+run_progress'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Progress bars are configurable, may include percentage, elapsed time, and
custom text.
</p>

<ul>
<li> <p><code><a href="#topic+progress">progress()</a></code>: Initiate a custom progress bar of class <code>pb_metan</code>.
</p>
</li>
<li> <p><code><a href="#topic+run_progress">run_progress()</a></code>: Run the progress bar and should be called within a 'for
loop' statement, a <code><a href="base.html#topic+lapply">lapply()</a></code> family or <code><a href="purrr.html#topic+map">purrr::map()</a></code> family of functional
programming tools.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>progress(
  min = 0,
  max = 100,
  leftd = "|",
  rightd = "|",
  char = "=",
  style = 2,
  width = getOption("width"),
  time = Sys.time()
)

run_progress(pb, actual, text = "", digits = 0, sleep = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_progress_+3A_min">min</code>, <code id="utils_progress_+3A_max">max</code></td>
<td>
<p>Numeric values for the extremes of the progress bar. Must have
<code>min &lt; max</code>.</p>
</td></tr>
<tr><td><code id="utils_progress_+3A_leftd">leftd</code>, <code id="utils_progress_+3A_rightd">rightd</code></td>
<td>
<p>The left and right delimiters for the progress bar.
Defaults to <code>"|"</code>.</p>
</td></tr>
<tr><td><code id="utils_progress_+3A_char">char</code></td>
<td>
<p>The character (or character string) to form the progress bar.</p>
</td></tr>
<tr><td><code id="utils_progress_+3A_style">style</code></td>
<td>
<p>The 'style' of the progress bar. Elapsed time is counted from
calling <code><a href="#topic+progress">progress()</a></code> up to each call of <code><a href="#topic+run_progress">run_progress()</a></code>.
</p>

<ul>
<li> <p><code>type = 1</code>: Shows a progress bar without percentage or elapsed time.
</p>
</li>
<li> <p><code>type = 2</code>: The default, shows the progress bar and its percentage.
</p>
</li>
<li> <p><code>type = 3</code>: Shows the progress bar and elapsed time.
</p>
</li>
<li> <p><code>type = 4</code>: Shows the progress bar, percentage, and elapsed time.
</p>
</li></ul>
</td></tr>
<tr><td><code id="utils_progress_+3A_width">width</code></td>
<td>
<p>The the width of the progress bar. Defaults to the number of
characters is that which fits into <code>getOption("width")</code>.</p>
</td></tr>
<tr><td><code id="utils_progress_+3A_time">time</code></td>
<td>
<p>The system time used to compute the elapsed time from calling
<code><a href="#topic+progress">progress()</a></code> to each call of <code><a href="#topic+run_progress">run_progress()</a></code>. Defaults to <code>Sys.time()</code>.</p>
</td></tr>
<tr><td><code id="utils_progress_+3A_pb">pb</code></td>
<td>
<p>An object created with <code><a href="#topic+progress">progress()</a></code></p>
</td></tr>
<tr><td><code id="utils_progress_+3A_actual">actual</code></td>
<td>
<p>The actual value, for example, a loop variable that define the
loop index value.</p>
</td></tr>
<tr><td><code id="utils_progress_+3A_text">text</code></td>
<td>
<p>An optional character string to be shown at the begining of the
progress bar.</p>
</td></tr>
<tr><td><code id="utils_progress_+3A_digits">digits</code></td>
<td>
<p>The number of significant figures in percentage value. Defaults
to <code>0</code>.</p>
</td></tr>
<tr><td><code id="utils_progress_+3A_sleep">sleep</code></td>
<td>
<p>Suspend execution for a time interval with <code><a href="base.html#topic+Sys.sleep">Sys.sleep()</a></code> within
<code><a href="#topic+run_progress">run_progress()</a></code>. Defaults to <code>0</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+progress">progress()</a></code> returns a list of class <code>pb_metan</code> that contains the set
parameters that will called by <code><a href="#topic+run_progress">run_progress()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

################### A for looping approach ################
pb &lt;-  progress()
for (i in 1:100) {
 run_progress(pb, actual = i, sleep = 0.01)
}

################### An apply family approach ##############
pb &lt;- progress(max = 10)
foo &lt;- function(...){
   run_progress(pb, ...)
   rnorm(100) %&gt;%  mean()
 }
(a &lt;- sapply(1:10, FUN = foo, sleep = 0.05))

######## A purrr functional programming approach ##########
foo2 &lt;- function(...){
     run_progress(pb2, ...)
     rnorm(100) %&gt;%  mean()
}
pb2 &lt;- progress(max = 10000,
                style = 4,
                leftd = "",
                char = ".",
                rightd = "!")

b &lt;- purrr::map_dbl(1:10000, foo2, text = "Progress bar for sampling")
hist(b)

</code></pre>

<hr>
<h2 id='utils_rows_cols'>Utilities for handling with rows and columns</h2><span id='topic+utils_rows_cols'></span><span id='topic+add_cols'></span><span id='topic+add_rows'></span><span id='topic+add_row_id'></span><span id='topic+all_pairs'></span><span id='topic+add_prefix'></span><span id='topic+add_suffix'></span><span id='topic+colnames_to_lower'></span><span id='topic+colnames_to_upper'></span><span id='topic+colnames_to_title'></span><span id='topic+column_to_first'></span><span id='topic+column_to_last'></span><span id='topic+column_to_rownames'></span><span id='topic+rownames_to_column'></span><span id='topic+remove_rownames'></span><span id='topic+column_exists'></span><span id='topic+concatenate'></span><span id='topic+get_levels'></span><span id='topic+get_levels_comb'></span><span id='topic+get_level_size'></span><span id='topic+reorder_cols'></span><span id='topic+remove_cols'></span><span id='topic+remove_rows'></span><span id='topic+select_first_col'></span><span id='topic+select_last_col'></span><span id='topic+select_numeric_cols'></span><span id='topic+select_non_numeric_cols'></span><span id='topic+select_cols'></span><span id='topic+select_rows'></span><span id='topic+tidy_colnames'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><code>add_cols()</code>: Add one or more columns to an existing data frame. If
specified <code>.before</code> or <code>.after</code> columns does not exist, columns are
appended at the end of the data. Return a data frame with all the original
columns in <code>.data</code> plus the columns declared in <code>...</code>. In
<code>add_cols()</code> columns in <code>.data</code> are available for the expressions.
So, it is possible to add a column based on existing data.
</p>
</li>
<li> <p><code>add_rows()</code>: Add one or more rows to an existing data frame. If
specified <code>.before</code> or <code>.after</code> rows does not exist, rows are
appended at the end of the data. Return a data frame with all the original
rows in <code>.data</code> plus the rows declared in <code>...</code> argument.
</p>
</li>
<li> <p><code>add_row_id()</code>: Add a column with the row id as the first column in
<code>.data</code>.
</p>
</li>
<li> <p><code>add_prefix()</code> and <code>add_suffix()</code> add prefixes and suffixes,
respectively, in variable names selected in <code>...</code> argument.
</p>
</li>
<li> <p><code>all_pairs()</code>: Get all the possible pairs between the levels of a
factor.
</p>
</li>
<li> <p><code>colnames_to_lower()</code>: Translate all column names to lower case.
</p>
</li>
<li> <p><code>colnames_to_upper()</code>: Translate all column names to upper case.
</p>
</li>
<li> <p><code>colnames_to_title()</code>: Translate all column names to title case.
</p>
</li>
<li> <p><code>column_exists()</code>: Checks if a column exists in a data frame. Return a
logical value.
</p>
</li>
<li> <p><code>columns_to_first()</code>: Move columns to first positions in <code>.data</code>.
</p>
</li>
<li> <p><code>columns_to_last()</code>: Move columns to last positions in <code>.data</code>.
</p>
</li>
<li> <p><code>columns_to_rownames()</code>: Move a column of <code>.data</code> to its row
names.
</p>
</li>
<li> <p><code>rownames_to_column()</code>: Move the row names of <code>.data</code> to a new
column.
</p>
</li>
<li> <p><code>remove_rownames()</code>: Remove the row names of <code>.data</code>.
</p>
</li>
<li> <p><code>concatenate()</code>: Concatenate columns of a data frame. If <code>drop = TRUE</code> then the existing variables are dropped. If <code>pull = TRUE</code> then the
concatenated variable is pull out to a vector. This is specially useful when
using <code>concatenate</code> to add columns to a data frame with <code>add_cols()</code>.
</p>
</li>
<li> <p><code>get_levels()</code>: Get the levels of a factor variable.
</p>
</li>
<li> <p><code>get_levels_comb()</code>: Get the combination of the levels of a factor.
</p>
</li>
<li> <p><code>get_level_size()</code>: Get the size of each level of a factor variable.
</p>
</li>
<li> <p><code>remove_cols()</code>: Remove one or more columns from a data frame.
</p>
</li>
<li> <p><code>remove_rows()</code>: Remove one or more rows from a data frame.
</p>
</li>
<li> <p><code>reorder_cols()</code>: Reorder columns in a data frame.
</p>
</li>
<li> <p><code>select_cols()</code>: Select one or more columns from a data frame.
</p>
</li>
<li> <p><code>select_first_col()</code>: Select first variable, possibly with an offset.
</p>
</li>
<li> <p><code>select_last_col()</code>: Select last variable, possibly with an offset.
</p>
</li>
<li> <p><code>select_numeric_cols()</code>: Select all the numeric columns of a data
frame.
</p>
</li>
<li> <p><code>select_non_numeric_cols()</code>: Select all the non-numeric columns of a
data frame.
</p>
</li>
<li> <p><code>select_rows()</code>: Select one or more rows from a data frame.
</p>
</li>
<li> <p><code>tidy_colnames()</code>: Tidy up column names with
<code><a href="#topic+tidy_strings">tidy_strings()</a></code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>add_cols(.data, ..., .before = NULL, .after = NULL)

add_rows(.data, ..., .before = NULL, .after = NULL)

add_row_id(.data, var = "row_id")

all_pairs(.data, levels)

add_prefix(.data, ..., prefix, sep = "_")

add_suffix(.data, ..., suffix, sep = "_")

colnames_to_lower(.data)

colnames_to_upper(.data)

colnames_to_title(.data)

column_to_first(.data, ...)

column_to_last(.data, ...)

column_to_rownames(.data, var = "rowname")

rownames_to_column(.data, var = "rowname")

remove_rownames(.data, ...)

column_exists(.data, cols)

concatenate(
  .data,
  ...,
  prefix = NULL,
  suffix = NULL,
  new_var = new_var,
  sep = "_",
  drop = FALSE,
  pull = FALSE,
  .before = NULL,
  .after = NULL
)

get_levels(.data, ...)

get_levels_comb(.data, ...)

get_level_size(.data, ...)

reorder_cols(.data, ..., .before = NULL, .after = NULL)

remove_cols(.data, ...)

remove_rows(.data, ...)

select_first_col(.data, offset = NULL)

select_last_col(.data, offset = NULL)

select_numeric_cols(.data)

select_non_numeric_cols(.data)

select_cols(.data, ...)

select_rows(.data, ...)

tidy_colnames(.data, sep = "_")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_rows_cols_+3A_.data">.data</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_...">...</code></td>
<td>
<p>The argument depends on the function used.
</p>

<ul>
<li><p> For <code>add_cols()</code> and <code>add_rows()</code> is name-value pairs. All values
must have one element for each row in <code>.data</code> when using
<code>add_cols()</code> or one element for each column in <code>.data</code> when using
<code>add_rows()</code>. Values of length 1 will be recycled when using
<code>add_cols()</code>.
</p>
</li>
<li><p> For <code>remove_cols()</code> and <code>select_cols()</code>,  <code>...</code> is the
column name or column index of the variable(s) to be dropped.
</p>
</li>
<li><p> For <code>add_prefix()</code> and <code>add_suffix()</code>,  <code>...</code> is the column
name to add the prefix or suffix, respectively. Select helpers are allowed.
</p>
</li>
<li><p> For <code>columns_to_first()</code> and <code>columns_to_last()</code>,  <code>...</code> is
the column name or column index of the variable(s) to be moved to first or
last in <code>.data</code>.
</p>
</li>
<li><p> For <code>remove_rows()</code> and <code>select_rows()</code>, <code>...</code> is an integer
row value.
</p>
</li>
<li><p> For <code>concatenate()</code>, <code>...</code> is the unquoted variable names to be
concatenated.
</p>
</li>
<li><p> For <code>get_levels()</code>, <code>get_level_comb()</code>, and
<code>get_level_size()</code> <code>...</code> is the unquoted variable names to get the
levels, levels combinations and levels size, respectively.
</p>
</li></ul>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_.before">.before</code>, <code id="utils_rows_cols_+3A_.after">.after</code></td>
<td>
<p>For <code>add_cols()</code>, <code>concatenate()</code>, and
<code>reorder_cols()</code>, one-based column index or column name where to add
the new columns, default: .after last column. For <code>add_rows()</code>,
one-based row index where to add the new rows, default: .after last row.</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_var">var</code></td>
<td>
<p>Name of column to use for rownames.</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_levels">levels</code></td>
<td>
<p>The levels of a factor or a numeric vector.</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_prefix">prefix</code>, <code id="utils_rows_cols_+3A_suffix">suffix</code></td>
<td>
<p>The prefix and suffix used in <code>add_prefix()</code> and
<code>add_suffix()</code>, respectively.</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_sep">sep</code></td>
<td>
<p>The separator to appear when using <code>concatenate()</code>,
<code>add_prefix()</code>, or <code>add_suffix()</code>. Defaults to to <code>"_"</code>.</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_cols">cols</code></td>
<td>
<p>A quoted variable name to check if it exists in <code>.data</code>.</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_new_var">new_var</code></td>
<td>
<p>The name of the new variable containing the concatenated
values. Defaults to <code>new_var</code>.</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_drop">drop</code></td>
<td>
<p>Logical argument. If <code>TRUE</code> keeps the new variable
<code>new_var</code> and drops the existing ones. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_pull">pull</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, returns the last column (on the
assumption that's the column you've created most recently), as a vector.</p>
</td></tr>
<tr><td><code id="utils_rows_cols_+3A_offset">offset</code></td>
<td>
<p>Set it to <em>n</em> to select the <em>n</em>th variable from the
end (for <code>select_last_col()</code>) of from the begin (for
<code>select_first_col()</code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)

################# Adding columns #################
# Variables x and y .after last column
data_ge %&gt;%
  add_cols(x = 10,
           y = 30)
# Variables x and y .before the variable GEN
data_ge %&gt;%
  add_cols(x = 10,
           y = 30,
           .before = GEN)

# Creating a new variable based on the existing ones.
data_ge %&gt;%
  add_cols(GY2 = GY^2,
           GY2_HM = GY2 + HM,
           .after = GY)

############### Reordering columns ###############
reorder_cols(data_ge2, NKR, .before = ENV)
reorder_cols(data_ge2, where(is.factor), .after = last_col())

######## Selecting and removing columns ##########
select_cols(data_ge2, GEN, REP)
remove_cols(data_ge2, GEN, REP)

########## Selecting and removing rows ###########
select_rows(data_ge2, 2:3)
remove_rows(data_ge2, 2:3)

########### Concatenating columns ################
concatenate(data_ge, ENV, GEN, REP)
concatenate(data_ge, ENV, GEN, REP, drop = TRUE)

# Combine with add_cols() and replace_string()
data_ge2 %&gt;%
 add_cols(ENV_GEN = concatenate(., ENV, GEN, pull = TRUE),
          .after = GEN) %&gt;%
 replace_string(ENV_GEN,
                pattern = "H",
                replacement = "HYB_")

# Use prefixes and suffixes
concatenate(data_ge2, REP, prefix = "REP", new_var = REP)

# Use prefixes and suffixes (the ear traits EH, EP, EL, and ED)
add_prefix(data_ge2, PH, EH, EP, EL, prefix = "EAR")
add_suffix(data_ge2, PH, EH, EP, EL, suffix = "EAR", sep = ".")

# Use prefixes and suffixes (colnames)
concatenate(data_ge2, REP, prefix = "REP", new_var = REP)


########### formating column names ###############
# Creating data with messy column names
df &lt;- head(data_ge, 3)
colnames(df) &lt;- c("Env", "gen", "Rep", "GY", "hm")
df
colnames_to_lower(df)
colnames_to_upper(df)
colnames_to_title(df)


################### Adding rows ##################
data_ge %&gt;%
  add_rows(GY = 10.3,
           HM = 100.11,
           .after = 1)

########## checking if a column exists ###########
column_exists(data_g, "GEN")

####### get the levels, level combinations and size of levels ########
get_levels(data_g, GEN)
get_levels_comb(data_ge, ENV, GEN)
get_level_size(data_g, GEN)

############## all possible pairs ################
all_pairs(data_g, GEN)

########## select numeric variables only #########
select_numeric_cols(data_g)
select_non_numeric_cols(data_g)

</code></pre>

<hr>
<h2 id='utils_samples'>Random Sampling</h2><span id='topic+utils_samples'></span><span id='topic+sample_random'></span><span id='topic+sample_systematic'></span>

<h3>Description</h3>


<ul>
<li> <p><code><a href="#topic+sample_random">sample_random()</a></code> performs Simple Random Sampling or Stratified Random
Sampling
</p>
</li>
<li> <p><code><a href="#topic+sample_systematic">sample_systematic()</a></code> performs systematic sampling. In this case, a regular
interval of size k (<code>k = floor(N/n)</code>) is generated considering the population
size (N) and desired sample size (n). Then, the starting member (<code>r</code>) is
randomly chosen between <code>1-k</code>. The second element is <code>r</code> + <code>k</code>, and so on.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>sample_random(data, n, prop, by = NULL, weight = NULL)

sample_systematic(data, n, r = NULL, by = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_samples_+3A_data">data</code></td>
<td>
<p>A data frame. If <code>data</code> is a <code>grouped_df</code>, the operation will be
performed on each group (stratified).</p>
</td></tr>
<tr><td><code id="utils_samples_+3A_n">n</code>, <code id="utils_samples_+3A_prop">prop</code></td>
<td>
<p>Provide either <code>n</code>, the number of rows, or <code>prop</code>, the
proportion of rows to select. If neither are supplied, <code>n = 1</code> will be
used.</p>
</td></tr>
<tr><td><code id="utils_samples_+3A_by">by</code></td>
<td>
<p>A categorical variable to compute the sample by. It is a
shortcut to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code> that allows to group the data by one
categorical variable. If more than one grouping variable needs to be used,
use <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code> to pass the data grouped.</p>
</td></tr>
<tr><td><code id="utils_samples_+3A_weight">weight</code></td>
<td>
<p>Sampling weights. This must evaluate to a vector of
non-negative numbers the same length as the input. Weights are
automatically standardised to sum to 1.</p>
</td></tr>
<tr><td><code id="utils_samples_+3A_r">r</code></td>
<td>
<p>The starting element. By default, <code>r</code> is randomly selected between
<code>1:k</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the same type as <code>data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(metan)
sample_random(data_ge, n = 5)
sample_random(data_ge,
              n = 3,
              by = ENV)

sample_systematic(data_g, n = 6)
</code></pre>

<hr>
<h2 id='utils_sets'>Utilities for set operations for many sets</h2><span id='topic+utils_sets'></span><span id='topic+set_intersect'></span><span id='topic+set_union'></span><span id='topic+set_difference'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Provides alternative function to <code><a href="base.html#topic+sets">base::union()</a></code>, <code><a href="base.html#topic+sets">base::intersect()</a></code>, and
<code><a href="base.html#topic+sets">base::setdiff()</a></code>.
</p>

<ul>
<li> <p><code>set_union()</code>: Returns the union of the sets in <code>...</code>.
</p>
</li>
<li> <p><code>set_intersect()</code>: Returns the intersect of the sets in <code>...</code>.
</p>
</li>
<li> <p><code>set_difference()</code>: Returns the difference of the sets in <code>...</code>.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>set_intersect(..., pairs = FALSE)

set_union(..., pairs = FALSE)

set_difference(..., pairs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_sets_+3A_...">...</code></td>
<td>
<p>A list or a comma-separated list of vectors in the same class. If
vector contains duplicates they will be discarded. If the list doesn't have
names the sets will be named as <code>"set_1"</code>, &quot;<code style="white-space: pre;">&#8288;Set_2"&#8288;</code>, <code>"Set_3"</code> and so on.
If vectors are given in <code>...</code>, the set names will be named with the names
of the objects provided. Data frames are also allowed, provided that common
column names exist.</p>
</td></tr>
<tr><td><code id="utils_sets_+3A_pairs">pairs</code></td>
<td>
<p>Returns the pairwise unions of the sets? Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector showing the desired operation of the sets. If <code>pairs = TRUE</code>, returns a list showing the pairwise operation of the sets.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
(A &lt;- letters[1:4])
(B &lt;- letters[2:5])
(C &lt;- letters[3:7])

set_union(A, B)
set_intersect(A, B, C)
set_difference(B, C)

# Operations with data frames
# Add a row id for better understanding
sets &lt;- data_ge %&gt;% add_row_id()

set_1 &lt;- sets[1:5,]
set_2 &lt;- sets[2:6,]
set_3 &lt;- sets[3:7,]

set_intersect(set_1, set_2, set_3)
set_difference(set_2, set_3)
set_union(set_1, set_2, set_3)


</code></pre>

<hr>
<h2 id='utils_stats'>Useful functions for computing descriptive statistics</h2><span id='topic+utils_stats'></span><span id='topic+av_dev'></span><span id='topic+ci_mean_t'></span><span id='topic+ci_mean_z'></span><span id='topic+cv'></span><span id='topic+freq_table'></span><span id='topic+freq_hist'></span><span id='topic+hmean'></span><span id='topic+gmean'></span><span id='topic+kurt'></span><span id='topic+n_missing'></span><span id='topic+n_unique'></span><span id='topic+n_valid'></span><span id='topic+pseudo_sigma'></span><span id='topic+range_data'></span><span id='topic+row_col_mean'></span><span id='topic+row_col_sum'></span><span id='topic+sd_amo'></span><span id='topic+sd_pop'></span><span id='topic+sem'></span><span id='topic+skew'></span><span id='topic+sum_dev'></span><span id='topic+ave_dev'></span><span id='topic+sum_sq_dev'></span><span id='topic+sum_sq'></span><span id='topic+var_pop'></span><span id='topic+var_amo'></span><span id='topic+cv_by'></span><span id='topic+max_by'></span><span id='topic+min_by'></span><span id='topic+means_by'></span><span id='topic+mean_by'></span><span id='topic+n_by'></span><span id='topic+sd_by'></span><span id='topic+var_by'></span><span id='topic+sem_by'></span><span id='topic+sum_by'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>

<ul>
<li> <p><strong>The following functions compute descriptive statistics by levels of
a factor or combination of factors quickly.</strong>
</p>

<ul>
<li> <p><code>cv_by()</code> For computing coefficient of variation.
</p>
</li>
<li> <p><code>max_by()</code> For computing maximum values.
</p>
</li>
<li> <p><code>mean_by()</code> For computing arithmetic means.
</p>
</li>
<li> <p><code>min_by()</code> For compuing minimum values.
</p>
</li>
<li> <p><code>n_by()</code> For getting the length.
</p>
</li>
<li> <p><code>sd_by()</code> For computing sample standard deviation.
</p>
</li>
<li> <p><code>var_by()</code> For computing sample variance.
</p>
</li>
<li> <p><code>sem_by()</code> For computing standard error of the mean.
</p>
</li></ul>

</li>
<li> <p><strong>Useful functions for descriptive statistics. All of them work
naturally with <code style="white-space: pre;">&#8288;\%&gt;\%&#8288;</code>, handle grouped data and multiple variables (all
numeric variables from <code>.data</code> by default).</strong>
</p>

<ul>
<li> <p><code>av_dev()</code> computes the average absolute deviation.
</p>
</li>
<li> <p><code>ci_mean_t()</code> computes the t-interval for the mean.
</p>
</li>
<li> <p><code>ci_mean_z()</code> computes the z-interval for the mean.
</p>
</li>
<li> <p><code>cv()</code> computes the coefficient of variation.
</p>
</li>
<li> <p><code>freq_table()</code> Computes a frequency table for either numeric and
categorical/discrete data. For numeric data, it is possible to define the
number of classes to be generated.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;hmean(), gmean()&#8288;</code> computes the harmonic and geometric means,
respectively. The harmonic mean is the reciprocal of the arithmetic mean of
the reciprocals. The geometric mean is the <em>n</em>th root of <em>n</em>
products.
</p>
</li>
<li> <p><code>kurt()</code> computes the kurtosis like used in SAS and SPSS.
</p>
</li>
<li> <p><code>range_data()</code> Computes the range of the values.
</p>
</li>
<li> <p><code>n_valid()</code> The valid (not <code>NA</code>) length of a data.
</p>
</li>
<li> <p><code>n_unique()</code> Number of unique values.
</p>
</li>
<li> <p><code>n_missing()</code> Number of missing values.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;row_col_mean(), row_col_sum()&#8288;</code> Adds a row with the mean/sum of
each variable and a column with the the mean/sum for each row of the data.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;sd_amo(), sd_pop()&#8288;</code> Computes sample and populational standard
deviation, respectively.
</p>
</li>
<li> <p><code>sem()</code> computes the standard error of the mean.
</p>
</li>
<li> <p><code>skew()</code> computes the skewness like used in SAS and SPSS.
</p>
</li>
<li> <p><code>ave_dev()</code> computes the average of the absolute deviations.
</p>
</li>
<li> <p><code>sum_dev()</code> computes the sum of the absolute deviations.
</p>
</li>
<li> <p><code>sum_sq()</code> computes the sum of the squared values.
</p>
</li>
<li> <p><code>sum_sq_dev()</code> computes the sum of the squared deviations.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;var_amo(), var_pop()&#8288;</code> computes sample and populational variance.
</p>
</li></ul>

</li></ul>

<p><code><a href="#topic+desc_stat">desc_stat()</a></code> is wrapper function around the above ones and can be
used to compute quickly all these statistics at once.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>av_dev(.data, ..., na.rm = FALSE)

ci_mean_t(.data, ..., na.rm = FALSE, level = 0.95)

ci_mean_z(.data, ..., na.rm = FALSE, level = 0.95)

cv(.data, ..., na.rm = FALSE)

freq_table(.data, var, k = NULL, digits = 3)

freq_hist(
  table,
  xlab = NULL,
  ylab = NULL,
  fill = "gray",
  color = "black",
  ygrid = TRUE
)

hmean(.data, ..., na.rm = FALSE)

gmean(.data, ..., na.rm = FALSE)

kurt(.data, ..., na.rm = FALSE)

n_missing(.data, ..., na.rm = FALSE)

n_unique(.data, ..., na.rm = FALSE)

n_valid(.data, ..., na.rm = FALSE)

pseudo_sigma(.data, ..., na.rm = FALSE)

range_data(.data, ..., na.rm = FALSE)

row_col_mean(.data, na.rm = FALSE)

row_col_sum(.data, na.rm = FALSE)

sd_amo(.data, ..., na.rm = FALSE)

sd_pop(.data, ..., na.rm = FALSE)

sem(.data, ..., na.rm = FALSE)

skew(.data, ..., na.rm = FALSE)

sum_dev(.data, ..., na.rm = FALSE)

ave_dev(.data, ..., na.rm = FALSE)

sum_sq_dev(.data, ..., na.rm = FALSE)

sum_sq(.data, ..., na.rm = FALSE)

var_pop(.data, ..., na.rm = FALSE)

var_amo(.data, ..., na.rm = FALSE)

cv_by(.data, ..., .vars = NULL, na.rm = FALSE)

max_by(.data, ..., .vars = NULL, na.rm = FALSE)

min_by(.data, ..., .vars = NULL, na.rm = FALSE)

means_by(.data, ..., .vars = NULL, na.rm = FALSE)

mean_by(.data, ..., .vars = NULL, na.rm = FALSE)

n_by(.data, ..., .vars = NULL, na.rm = FALSE)

sd_by(.data, ..., .vars = NULL, na.rm = FALSE)

var_by(.data, ..., .vars = NULL, na.rm = FALSE)

sem_by(.data, ..., .vars = NULL, na.rm = FALSE)

sum_by(.data, ..., .vars = NULL, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_stats_+3A_.data">.data</code></td>
<td>
<p>A data frame or a numeric vector.</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_...">...</code></td>
<td>
<p>The argument depends on the function used.
</p>

<ul>
<li><p> For <code style="white-space: pre;">&#8288;*_by&#8288;</code> functions, <code>...</code> is one or more categorical variables
for grouping the data. Then the statistic required will be computed for all
numeric variables in the data. If no variables are informed in <code>...</code>,
the statistic will be computed ignoring all non-numeric variables in
<code>.data</code>.
</p>
</li>
<li><p> For the other statistics, <code>...</code> is a comma-separated of unquoted
variable names to compute the statistics. If no variables are informed in n
<code>...</code>, the statistic will be computed for all numeric variables in
<code>.data</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="utils_stats_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>FALSE</code>, the default, missing values are removed with a
warning. If <code>TRUE</code>, missing values are silently removed.</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_level">level</code></td>
<td>
<p>The confidence level for the confidence interval of the mean.
Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_var">var</code></td>
<td>
<p>The variable to compute the frequency table. See <code>Details</code> for
more details.</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_k">k</code></td>
<td>
<p>The number of classes to be created. See <code>Details</code> for
more details.</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_digits">digits</code></td>
<td>
<p>The number of significant figures to show. Defaults to 2.</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_table">table</code></td>
<td>
<p>A frequency table computed with <code><a href="#topic+freq_table">freq_table()</a></code>.</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_xlab">xlab</code>, <code id="utils_stats_+3A_ylab">ylab</code></td>
<td>
<p>The <code>x</code> and <code>y</code> labels.</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_fill">fill</code>, <code id="utils_stats_+3A_color">color</code></td>
<td>
<p>The color to fill the bars and color the border of the bar,
respectively.</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_ygrid">ygrid</code></td>
<td>
<p>Shows a grid line on the <code>y</code> axis? Defaults to <code>TRUE</code>.
freq_hist &lt;- function(table,</p>
</td></tr>
<tr><td><code id="utils_stats_+3A_.vars">.vars</code></td>
<td>
<p>Used to select variables in the <code style="white-space: pre;">&#8288;*_by()&#8288;</code> functions. One or more
unquoted expressions separated by commas. Variable names can be used as if
they were positions in the data frame, so expressions like <code>x:y</code> can be
used to select a range of variables. Defaults to <code>NULL</code> (all numeric
variables are analyzed)..</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>freq_table()</code> computes a frequency table for either
numerical or categorical variables. If a variable is categorical or
discrete (integer values), the number of classes will be the number of
levels that the variable contains.
</p>
<p>If a variable (say, data) is continuous, the number of classes (k) is given by
the square root of the number of samples (n) if <code style="white-space: pre;">&#8288;n =&lt; 100&#8288;</code> or <code>5 * log10(n)</code>
if <code>n &gt; 100</code>.
</p>
<p>The amplitude (\(A\)) of the data is used to define the size of the class (\(c\)),
given by
</p>
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[c = \frac{A}{n - 1}\]
<p>The lower limit of the first class (LL1) is given by min(data) - c / 2. The
upper limit is given by LL1 + c. The limits of the other classes are given in
the same way. After the creation of the classes, the absolute and relative
frequencies within each class are computed.
</p>


<h3>Value</h3>


<ul>
<li><p> Functions <code style="white-space: pre;">&#8288;*_by()&#8288;</code> returns a <code>tbl_df</code> with the computed statistics by
each level of the factor(s) declared in <code>...</code>.
</p>
</li>
<li><p> All other functions return a named integer if the input is a data frame
or a numeric value if the input is a numeric vector.
</p>
</li>
<li> <p><code>freq_table()</code> Returns a list with the frequency table and the breaks used
for class definition. These breaks can be used to construct an histogram of
the variable.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Ferreira, Daniel Furtado. 2009. Estatistica Basica. 2 ed. Vicosa,
MG: UFLA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# means of all numeric variables by ENV
mean_by(data_ge2, GEN, ENV)

# Coefficient of variation for all numeric variables
# by GEN and ENV
cv_by(data_ge2, GEN, ENV)

# Skewness of a numeric vector
set.seed(1)
nvec &lt;- rnorm(200, 10, 1)
skew(nvec)

# Confidence interval 0.95 for the mean
# All numeric variables
# Grouped by levels of ENV
data_ge2 %&gt;%
  group_by(ENV) %&gt;%
  ci_mean_t()

# standard error of the mean
# Variable PH and EH
sem(data_ge2, PH, EH)

# Frequency table for variable NR
data_ge2 %&gt;%
  freq_table(NR)


</code></pre>

<hr>
<h2 id='utils_wd'>Set and get the Working Directory quicky</h2><span id='topic+utils_wd'></span><span id='topic+set_wd_here'></span><span id='topic+get_wd_here'></span><span id='topic+open_wd_here'></span><span id='topic+open_wd'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>

<ul>
<li> <p><code><a href="#topic+get_wd_here">get_wd_here()</a></code> gets the working directory to the path of the current script.
</p>
</li>
<li> <p><code><a href="#topic+set_wd_here">set_wd_here()</a></code> sets the working directory to the path of the current script.
</p>
</li>
<li> <p><code><a href="#topic+open_wd_here">open_wd_here()</a></code> Open the File Explorer at the directory path of the current script.
</p>
</li>
<li> <p><code><a href="#topic+open_wd">open_wd()</a></code> Open the File Explorer at the current working directory.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>set_wd_here(path = NULL)

get_wd_here(path = NULL)

open_wd_here(path = get_wd_here())

open_wd(path = getwd())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utils_wd_+3A_path">path</code></td>
<td>
<p>Path components below the project root. Defaults to <code>NULL</code>. This means that
the directory will be set to the path of the file. If the path doesn't exist, the
user will be asked if he wants to create such a folder.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code><a href="#topic+get_wd_here">get_wd_here()</a></code> returns a full-path directory name.
</p>
</li>
<li> <p><code><a href="#topic+get_wd_here">get_wd_here()</a></code> returns a message showing the current working directory.
</p>
</li>
<li> <p><code><a href="#topic+open_wd_here">open_wd_here()</a></code> Opens the File Explorer of the path returned by <code>get_wd_here()</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
get_wd_here()
set_wd_here()
open_wd_here()

## End(Not run)
</code></pre>

<hr>
<h2 id='venn_plot'>Draw Venn diagrams</h2><span id='topic+venn_plot'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Produces ggplot2-based Venn plots for 2, 3 or 4 sets. A Venn diagram shows
all possible logical relationships between several sets of data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>venn_plot(
  ...,
  names = NULL,
  show_elements = FALSE,
  split_labels = FALSE,
  split_each = 4,
  show_sets = FALSE,
  fill = ggplot_color(4),
  alpha = 0.5,
  stroke_color = "white",
  stroke_alpha = 1,
  stroke_size = 1,
  stroke_linetype = "solid",
  name_color = "black",
  name_size = 6,
  text_color = "black",
  text_size = 4,
  label_sep = ","
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="venn_plot_+3A_...">...</code></td>
<td>
<p>A list or a comma-separated list of vectors in the same class. If
vector contains duplicates they will be discarded. If the list doesn't have
names the sets will be named as <code>"set_1"</code>, &quot;<code style="white-space: pre;">&#8288;Set_2"&#8288;</code>, <code>"Set_3"</code> and so on.
If vectors are given in <code>...</code>, the set names will be named with the names
of the objects provided.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_names">names</code></td>
<td>
<p>By default, the names of the sets are set as the names of the
objects in <code>...</code> (<code>names = NULL</code>). Use <code>names</code> to override this default.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_show_elements">show_elements</code></td>
<td>
<p>Show set elements instead of count. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_split_labels">split_labels</code></td>
<td>
<p>Splits the element labels into new lines each
<code>split_each</code> elements? Defaults to <code>TRUE</code>. This is useful to split labels
into several lines when <code>show_elements = TRUE</code> is used.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_split_each">split_each</code></td>
<td>
<p>The number of elements that will apper in each line when
<code>split_labels = TRUE</code> is used.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_show_sets">show_sets</code></td>
<td>
<p>Show set names instead of count. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_fill">fill</code></td>
<td>
<p>Filling colors in circles. Defaults to the default ggplot2 color
palette. A vector of length 1 will be recycled.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_alpha">alpha</code></td>
<td>
<p>Transparency for filling circles. Defaults to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_stroke_color">stroke_color</code></td>
<td>
<p>Stroke color for drawing circles.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_stroke_alpha">stroke_alpha</code></td>
<td>
<p>Transparency for drawing circles.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_stroke_size">stroke_size</code></td>
<td>
<p>Stroke size for drawing circles.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_stroke_linetype">stroke_linetype</code></td>
<td>
<p>Line type for drawing circles. Defaults to <code>"solid"</code>.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_name_color">name_color</code></td>
<td>
<p>Text color for set names. Defaults to <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_name_size">name_size</code></td>
<td>
<p>Text size for set names.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_text_color">text_color</code></td>
<td>
<p>Text color for intersect contents.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_text_size">text_size</code></td>
<td>
<p>Text size for intersect contents.</p>
</td></tr>
<tr><td><code id="venn_plot_+3A_label_sep">label_sep</code></td>
<td>
<p>The separator for labs when <code>show_elements = TRUE</code>. Defaults
to <code>","</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
(A &lt;- letters[1:4])
(B &lt;- letters[2:5])
(C &lt;- letters[3:7])
(D &lt;- letters[4:12])

# create a Venn plot
venn_plot(A, B)

# Three sets
venn_plot(A, B, C)

# Four sets
venn_plot(A, B, C, D)


# Use a list
dfs &lt;- list(A = A, B = B, C = C, D = D)
venn_plot(dfs,
          show_elements = TRUE,
          fill = c("red", "blue", "green", "gray"),
          stroke_color = "black",
          alpha = 0.8,
          text_size = 8,
          label_sep = ".")

</code></pre>

<hr>
<h2 id='waas'>Weighted Average of Absolute Scores</h2><span id='topic+waas'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Compute the Weighted Average of Absolute Scores for AMMI analysis (Olivoto et
al., 2019).
</p>
<p>This function compute the weighted average of absolute scores, estimated as
follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[WAAS_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k =
1}^{p}EP_k\]
</p>
<p>where \(WAAS_i\) is the weighted average of absolute scores of the
<em>i</em>th genotype; \(IPCA_{ik}\) is the score of the <em>i</em>th genotype
in the <em>k</em>th IPCA; and \(EP_k\) is the explained variance of the <em>k</em>th
IPCA for <em>k = 1,2,..,p</em>, considering <em>p</em> the number of significant
PCAs, or a declared number of PCAs. For example if <code>prob = 0.05</code>, all
axis that are significant considering this probability level are used. The
number of axis can be also informed by declaring <code>naxis = x</code>. This will
override the number of significant axes according to the argument <code>prob</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>waas(
  .data,
  env,
  gen,
  rep,
  resp,
  block = NULL,
  mresp = NULL,
  wresp = NULL,
  prob = 0.05,
  naxis = NULL,
  ind_anova = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="waas_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="waas_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="waas_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="waas_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="waas_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="waas_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then a resolvable
alpha-lattice design (Patterson and Williams, 1976) is employed.
<strong>All effects, except the error, are assumed to be fixed.</strong></p>
</td></tr>
<tr><td><code id="waas_+3A_mresp">mresp</code></td>
<td>
<p>The new maximum value after rescaling the response variable. By
default, all variables in <code>resp</code> are rescaled so that de maximum value
is 100 and the minimum value is 0 (i.e., <code>mresp = NULL</code>). It must be a
character vector of the same length of <code>resp</code> if rescaling is assumed
to be different across variables, e.g., if for the first variable smaller
values are better and for the second one, higher values are better, then
<code>mresp = c("l, h")</code> must be used. Character value of length 1 will be
recycled with a warning message.</p>
</td></tr>
<tr><td><code id="waas_+3A_wresp">wresp</code></td>
<td>
<p>The weight for the response variable(s) for computing the WAASBY
index. By default, all variables in <code>resp</code> have equal weights for mean
performance and stability (i.e., <code>wresp = 50</code>). It must be a numeric
vector of the same length of <code>resp</code> to assign different weights across
variables, e.g., if for the first variable equal weights for mean
performance and stability are assumed and for the second one, a higher
weight for mean performance (e.g. 65) is assumed, then <code>wresp = c(50, 65)</code> must be used. Numeric value of length 1 will be recycled with a
warning message.</p>
</td></tr>
<tr><td><code id="waas_+3A_prob">prob</code></td>
<td>
<p>The p-value for considering an interaction principal component
axis significant.</p>
</td></tr>
<tr><td><code id="waas_+3A_naxis">naxis</code></td>
<td>
<p>The number of IPCAs to be used for computing the WAAS index.
Default is <code>NULL</code> (Significant IPCAs are used). If values are
informed, the number of IPCAS will be used independently on its
significance. Note that if two or more variables are included in
<code>resp</code>, then <code>naxis</code> must be a vector.</p>
</td></tr>
<tr><td><code id="waas_+3A_ind_anova">ind_anova</code></td>
<td>
<p>Logical argument set to <code>FALSE</code>. If <code>TRUE</code> an
within-environment ANOVA is performed.</p>
</td></tr>
<tr><td><code id="waas_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code is run
silently.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>waas</code> with the following items for each
variable:
</p>

<ul>
<li> <p><strong>individual</strong> A within-environments ANOVA considering a fixed-effect
model.
</p>
</li>
<li> <p><strong>model</strong> A data frame with the response variable, the scores of all
Principal Components, the estimates of Weighted Average of Absolute Scores,
and WAASY (the index that consider the weights for stability and productivity
in the genotype ranking.
</p>
</li>
<li> <p><strong>MeansGxE</strong> The means of genotypes in the environments
</p>
</li>
<li> <p><strong>PCA</strong> Principal Component Analysis.
</p>
</li>
<li> <p><strong>ANOVA</strong> Joint analysis of variance for the main effects and
Principal Component analysis of the interaction effect.
</p>
</li>
<li> <p><strong>Details</strong> A list summarizing the results. The following information
are showed. <code>WgtResponse</code>, the weight for the response variable in
estimating WAASB, <code>WgtWAAS</code> the weight for stability, <code>Ngen</code> the
number of genotypes, <code>Nenv</code> the number of environments, <code>OVmean</code>
the overall mean, <code>Min</code> the minimum observed (returning the genotype and
environment), <code>Max</code> the maximum observed, <code>Max</code> the maximum
observed, <code>MinENV</code> the environment with the lower mean, <code>MaxENV</code>
the environment with the larger mean observed, <code>MinGEN</code> the genotype
with the lower mean, <code>MaxGEN</code> the genotype with the larger.
</p>
</li>
<li> <p><strong>augment:</strong> Information about each observation in the dataset. This
includes predicted values in the <code>fitted</code> column, residuals in the
<code>resid</code> column, standardized residuals in the <code>stdres</code> column,
the diagonal of the 'hat' matrix in the <code>hat</code>, and standard errors for
the fitted values in the <code>se.fit</code> column.
</p>
</li>
<li> <p><strong>probint</strong> The p-value for the genotype-vs-environment interaction.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro,
V.Q. de Souza, and E. Jost. 2019a. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960. <a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+waas_means">waas_means()</a></code> <code><a href="#topic+waasb">waasb()</a></code> <code><a href="#topic+get_model_data">get_model_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
#===============================================================#
# Example 1: Analyzing all numeric variables considering p-value#
# &lt;= 0.05 to compute the WAAS.                                  #
#===============================================================#
model &lt;- waas(data_ge,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = everything())
# Residual plot (first variable)
plot(model)

# Get the WAAS index
get_model_data(model, "WAAS")

# Plot WAAS and response variable
plot_scores(model, type = 3)


#===============================================================#
# Example 2: Declaring the number of axis to be used for        #
# computing WAAS and assigning a larger weight for the response #
# variable when computing the WAASBY index.                     #
#===============================================================#

model2 &lt;- waas(data_ge,
               env = ENV,
               gen = GEN,
               rep = REP,
               resp = everything(),
               naxis = 1, # Only to compare with PC1
               wresp = 60)
# Get the WAAS index (it will be |PC1|)
get_model_data(model2)

# Get values for IPCA1
get_model_data(model2, "PC1")


#===============================================================#
# Example 3: Analyzing GY and HM assuming a random-effect model.#
# Smaller values for HM and higher values for GY are better.    #
# To estimate WAASBY, higher weight for the GY (60%) and lower  #
# weight for HM (40%) are considered for mean performance.      #
#===============================================================#

model3 &lt;- waas(data_ge,
               env = ENV,
               gen = GEN,
               rep = REP,
               resp = c(GY, HM),
               mresp = c("h, l"),
               wresp = c(60, 40))


# Get the ranks for the WAASY index
get_model_data(model3, what = "OrWAASY")


</code></pre>

<hr>
<h2 id='waas_means'>Weighted Average of Absolute Scores</h2><span id='topic+waas_means'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Compute the Weighted Average of Absolute Scores (Olivoto et al., 2019) based
on means for genotype-environment data as follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[WAAS_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k =
1}^{p}EP_k\]
</p>
<p>where \(WAAS_i\) is the weighted average of absolute scores of the
<em>i</em>th genotype; \(PCA_{ik}\) is the score of the <em>i</em>th genotype
in the <em>k</em>th IPCA; and \(EP_k\) is the explained variance of the <em>k</em>th
IPCA for <em>k = 1,2,..,p</em>, where <em>p</em> is the number of IPCAs that
explain at least an amount of the genotype-interaction variance declared in
the argument <code>min_expl_var</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>waas_means(
  .data,
  env,
  gen,
  resp,
  mresp = NULL,
  wresp = NULL,
  min_expl_var = 85,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="waas_means_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="waas_means_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="waas_means_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="waas_means_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>. Select helpers are also allowed.</p>
</td></tr>
<tr><td><code id="waas_means_+3A_mresp">mresp</code></td>
<td>
<p>The new maximum value after rescaling the response variable. By
default, all variables in <code>resp</code> are rescaled so that de maximum value
is 100 and the minimum value is 0 (i.e., <code>mresp = NULL</code>). It must be a
character vector of the same length of <code>resp</code> if rescaling is assumed
to be different across variables, e.g., if for the first variable smaller
values are better and for the second one, higher values are better, then
<code>mresp = c("l, h")</code> must be used. Character value of length 1 will be
recycled with a warning message.</p>
</td></tr>
<tr><td><code id="waas_means_+3A_wresp">wresp</code></td>
<td>
<p>The weight for the response variable(s) for computing the WAASBY
index. Must be a numeric vector of the same length of <code>resp</code>. Defaults
to 50, i.e., equal weights for stability and mean performance.</p>
</td></tr>
<tr><td><code id="waas_means_+3A_min_expl_var">min_expl_var</code></td>
<td>
<p>The minimum explained variance. Defaults to 85.
Interaction Principal Compoment Axis are iteractively retained up to the
explained variance (eigenvalues in the singular value decomposition of the
matrix with the interaction effects) be greather than or equal to
<code>min_expl_var</code>. For example, if the explained variance (in percentage)
in seven possible IPCAs are <code style="white-space: pre;">&#8288;56, 21, 9, 6, 4, 3, 1&#8288;</code>, resulting in a
cumulative proportion of <code style="white-space: pre;">&#8288;56,  77,  86,  92,  96, 99, 100&#8288;</code>, then
<code>p = 3</code>, i.e., three IPCAs will be used to compute the index WAAS.</p>
</td></tr>
<tr><td><code id="waas_means_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code is run
silently.</p>
</td></tr>
<tr><td><code id="waas_means_+3A_...">...</code></td>
<td>
<p>Arguments passed to the function
<code><a href="#topic+impute_missing_val">impute_missing_val()</a></code> for imputation of missing values in case
of unbalanced data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>waas_means</code> with the following items for each
variable:
</p>

<ul>
<li> <p><strong>model</strong> A data frame with the response variable, the scores of all
Principal Components, the estimates of Weighted Average of Absolute Scores,
and WAASY (the index that consider the weights for stability and productivity
in the genotype ranking.
</p>
</li>
<li> <p><strong>ge_means</strong> A tbl_df containing the genotype-environment means.
</p>
</li>
<li> <p><strong>ge_eff</strong> A <em>gxe</em> matrix containing the genotype-environment effects.
</p>
</li>
<li> <p><strong>eigenvalues</strong> The eigenvalues from the singular value decomposition
of the matrix withe the genotype-environment interaction effects.
</p>
</li>
<li> <p><strong>proportion</strong> The proportion of the variance explained by each IPCA.
</p>
</li>
<li> <p><strong>cum_proportion</strong> The cumulative proportion of the variance explained.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019a. Mean performance and stability in
multi-environment trials I: Combining features of AMMI and BLUP techniques.
Agron. J. 111:2949-2960. <a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+waas">waas()</a></code> <code><a href="#topic+waasb">waasb()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# Data with replicates
model &lt;- waas(data_ge,
              env = ENV,
              gen = GEN,
              rep = REP,
              resp = everything())

# Based on means of genotype-environment data
data_means &lt;- mean_by(data_ge, ENV, GEN)
model2 &lt;- waas_means(data_ge,
                     env = ENV,
                     gen = GEN,
                     resp = everything())
# The index WAAS
get_model_data(model, what = "OrWAAS")
get_model_data(model2, what = "OrWAAS")



</code></pre>

<hr>
<h2 id='waasb'>Weighted Average of Absolute Scores</h2><span id='topic+waasb'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Compute the Weighted Average of Absolute Scores (Olivoto et al., 2019) for
quantifying the stability of <em>g</em> genotypes conducted in <em>e</em>
environments using linear mixed-effect models.
</p>
<p>The weighted average of absolute scores is computed considering all
Interaction Principal Component Axis (IPCA) from the Singular Value
Decomposition (SVD) of the matrix of genotype-environment interaction (GEI)
effects generated by a linear mixed-effect model, as follows:
<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
\[WAASB_i = \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k =
1}^{p}EP_k\]
</p>
<p>where \(WAASB_i\) is the weighted average of absolute scores of the
<em>i</em>th genotype; \(IPCA_{ik}\) is the score of the <em>i</em>th genotype in the
<em>k</em>th Interaction Principal Component Axis (IPCA); and \(EP_k\) is the
explained variance of the <em>k</em>th IPCA for <em>k = 1,2,..,p</em>, considering
\(p = min(g - 1; e - 1)\).
</p>
<p>The nature of the effects in the model is
chosen with the argument <code>random</code>. By default, the experimental design
considered in each environment is a randomized complete block design. If
<code>block</code> is informed, a resolvable alpha-lattice design (Patterson and
Williams, 1976) is implemented. The following six models can be fitted
depending on the values of <code>random</code> and <code>block</code> arguments.
</p>

<ul>
<li> <p><strong>Model 1:</strong> <code>block = NULL</code> and <code>random = "gen"</code> (The
default option). This model considers a Randomized Complete Block Design in
each environment assuming genotype and genotype-environment interaction as
random effects. Environments and blocks nested within environments are
assumed to fixed factors.
</p>
</li>
<li> <p><strong>Model 2:</strong> <code>block = NULL</code> and <code>random = "env"</code>. This
model considers a Randomized Complete Block Design in each environment
treating environment, genotype-environment interaction, and blocks nested
within environments as random factors. Genotypes are assumed to be fixed
factors.
</p>
</li>
<li> <p><strong>Model 3:</strong> <code>block = NULL</code> and <code>random = "all"</code>. This
model considers a Randomized Complete Block Design in each environment
assuming a random-effect model, i.e., all effects (genotypes, environments,
genotype-vs-environment interaction and blocks nested within environments)
are assumed to be random factors.
</p>
</li>
<li> <p><strong>Model 4:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "gen"</code>. This model considers an alpha-lattice design in each environment
assuming genotype, genotype-environment interaction, and incomplete blocks
nested within complete replicates as random to make use of inter-block
information (Mohring et al., 2015). Complete replicates nested within
environments and environments are assumed to be fixed factors.
</p>
</li>
<li> <p><strong>Model 5:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "env"</code>. This model considers an alpha-lattice design in each environment
assuming genotype as fixed. All other sources of variation (environment,
genotype-environment interaction, complete replicates nested within
environments, and incomplete blocks nested within replicates) are assumed
to be random factors.
</p>
</li>
<li> <p><strong>Model 6:</strong> <code>block</code> is not <code>NULL</code> and <code>random =   "all"</code>. This model considers an alpha-lattice design in each environment
assuming all effects, except the intercept, as random factors.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>waasb(
  .data,
  env,
  gen,
  rep,
  resp,
  block = NULL,
  by = NULL,
  mresp = NULL,
  wresp = NULL,
  random = "gen",
  prob = 0.05,
  ind_anova = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="waasb_+3A_.data">.data</code></td>
<td>
<p>The dataset containing the columns related to Environments,
Genotypes, replication/block and response variable(s).</p>
</td></tr>
<tr><td><code id="waasb_+3A_env">env</code></td>
<td>
<p>The name of the column that contains the levels of the
environments.</p>
</td></tr>
<tr><td><code id="waasb_+3A_gen">gen</code></td>
<td>
<p>The name of the column that contains the levels of the genotypes.</p>
</td></tr>
<tr><td><code id="waasb_+3A_rep">rep</code></td>
<td>
<p>The name of the column that contains the levels of the
replications/blocks.</p>
</td></tr>
<tr><td><code id="waasb_+3A_resp">resp</code></td>
<td>
<p>The response variable(s). To analyze multiple variables in a
single procedure a vector of variables may be used. For example <code>resp = c(var1, var2, var3)</code>.</p>
</td></tr>
<tr><td><code id="waasb_+3A_block">block</code></td>
<td>
<p>Defaults to <code>NULL</code>. In this case, a randomized complete
block design is considered. If block is informed, then an alpha-lattice
design is employed considering block as random to make use of inter-block
information, whereas the complete replicate effect is always taken as
fixed, as no inter-replicate information was to be recovered (Mohring et
al., 2015).</p>
</td></tr>
<tr><td><code id="waasb_+3A_by">by</code></td>
<td>
<p>One variable (factor) to compute the function by. It is a shortcut
to <code><a href="dplyr.html#topic+group_by">dplyr::group_by()</a></code>.This is especially useful, for example,
when the researcher want to compute the indexes by mega-environments. In
this case, an object of class waasb_grouped is returned.
<code><a href="#topic+mtsi">mtsi()</a></code> can then be used to compute the mtsi index within each
mega-environment.</p>
</td></tr>
<tr><td><code id="waasb_+3A_mresp">mresp</code></td>
<td>
<p>The new maximum value after rescaling the response variable. By
default, all variables in <code>resp</code> are rescaled so that de maximum value
is 100 and the minimum value is 0 (i.e., <code>mresp = NULL</code>). It must be a
character vector of the same length of <code>resp</code> if rescaling is assumed
to be different across variables, e.g., if for the first variable smaller
values are better and for the second one, higher values are better, then
<code>mresp = c("l, h")</code> must be used. Character value of length 1 will be
recycled with a warning message.</p>
</td></tr>
<tr><td><code id="waasb_+3A_wresp">wresp</code></td>
<td>
<p>The weight for the response variable(s) for computing the WAASBY
index. By default, all variables in <code>resp</code> have equal weights for mean
performance and stability (i.e., <code>wresp = 50</code>). It must be a numeric
vector of the same length of <code>resp</code> to assign different weights across
variables, e.g., if for the first variable equal weights for mean
performance and stability are assumed and for the second one, a higher
weight for mean performance (e.g. 65) is assumed, then <code>wresp = c(50, 65)</code> must be used. Numeric value of length 1 will be recycled with a
warning message.</p>
</td></tr>
<tr><td><code id="waasb_+3A_random">random</code></td>
<td>
<p>The effects of the model assumed to be random. Defaults to
<code>random = "gen"</code>. See <strong>Details</strong> to see the random effects
assumed depending on the experimental design of the trials.</p>
</td></tr>
<tr><td><code id="waasb_+3A_prob">prob</code></td>
<td>
<p>The probability for estimating confidence interval for BLUP's
prediction.</p>
</td></tr>
<tr><td><code id="waasb_+3A_ind_anova">ind_anova</code></td>
<td>
<p>Logical argument set to <code>FALSE</code>. If <code>TRUE</code> an
within-environment ANOVA is performed.</p>
</td></tr>
<tr><td><code id="waasb_+3A_verbose">verbose</code></td>
<td>
<p>Logical argument. If <code>verbose = FALSE</code> the code will run
silently.</p>
</td></tr>
<tr><td><code id="waasb_+3A_...">...</code></td>
<td>
<p>Arguments passed to the function
<code><a href="#topic+impute_missing_val">impute_missing_val()</a></code> for imputation of missing values in the
matrix of BLUPs for genotype-environment interaction, thus allowing the
computation of the WAASB index.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>waasb</code> with the following items for each
variable:
</p>

<ul>
<li> <p><strong>individual</strong> A within-environments ANOVA considering a
fixed-effect model.
</p>
</li>
<li> <p><strong>fixed</strong> Test for fixed effects.
</p>
</li>
<li> <p><strong>random</strong> Variance components for random effects.
</p>
</li>
<li> <p><strong>LRT</strong> The Likelihood Ratio Test for the random effects.
</p>
</li>
<li> <p><strong>model</strong> A tibble with the response variable, the scores of all
IPCAs, the estimates of Weighted Average of Absolute Scores, and WAASBY (the
index that considers the weights for stability and mean performance in the
genotype ranking), and their respective ranks.
</p>
</li>
<li> <p><strong>BLUPgen</strong> The random effects and estimated BLUPS for genotypes (If
<code>random = "gen"</code> or <code>random = "all"</code>)
</p>
</li>
<li> <p><strong>BLUPenv</strong> The random effects and estimated BLUPS for environments,
(If <code>random = "env"</code> or <code>random = "all"</code>).
</p>
</li>
<li> <p><strong>BLUPint</strong> The random effects and estimated BLUPS of all genotypes in
all environments.
</p>
</li>
<li> <p><strong>PCA</strong> The results of Principal Component Analysis with the
eigenvalues and explained variance of the matrix of genotype-environment
effects estimated by the linear fixed-effect model.
</p>
</li>
<li> <p><strong>MeansGxE</strong> The phenotypic means of genotypes in the environments.
</p>
</li>
<li> <p><strong>Details</strong> A list summarizing the results. The following information
are shown: <code>Nenv</code>, the number of environments in the analysis;
<code>Ngen</code> the number of genotypes in the analysis; <code>mresp</code> The value
attributed to the highest value of the response variable after rescaling it;
<code>wresp</code> The weight of the response variable for estimating the WAASBY
index. <code>Mean</code> the grand mean; <code>SE</code> the standard error of the mean;
<code>SD</code> the standard deviation. <code>CV</code> the coefficient of variation of
the phenotypic means, estimating WAASB, <code>Min</code> the minimum value observed
(returning the genotype and environment), <code>Max</code> the maximum value
observed (returning the genotype and environment); <code>MinENV</code> the
environment with the lower mean, <code>MaxENV</code> the environment with the
larger mean observed, <code>MinGEN</code> the genotype with the lower mean,
<code>MaxGEN</code> the genotype with the larger.
</p>
</li>
<li> <p><strong>ESTIMATES</strong> A tibble with the genetic parameters (if <code>random = "gen"</code> or <code>random = "all"</code>) with the following columns: <code style="white-space: pre;">&#8288;Phenotypic variance&#8288;</code> the phenotypic variance; <code>Heritability</code> the broad-sense
heritability; <code>GEr2</code> the coefficient of determination of the interaction
effects; <code>h2mg</code> the heritability on the mean basis;
<code>Accuracy</code> the selective accuracy; <code>rge</code> the genotype-environment
correlation; <code>CVg</code> the genotypic coefficient of variation; <code>CVr</code>
the residual coefficient of variation; <code style="white-space: pre;">&#8288;CV ratio&#8288;</code> the ratio between
genotypic and residual coefficient of variation.
</p>
</li>
<li> <p><strong>residuals</strong> The residuals of the model.
</p>
</li>
<li> <p><strong>formula</strong> The formula used to fit the model.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in multi-environment
trials I: Combining features of AMMI and BLUP techniques. Agron. J.
111:2949-2960.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>
<p>Mohring, J., E. Williams, and H.-P. Piepho. 2015. Inter-block information: to
recover or not to recover it? TAG. Theor. Appl. Genet. 128:1541-54.
<a href="https://doi.org/10.1007/s00122-015-2530-0">doi:10.1007/s00122-015-2530-0</a>
</p>
<p>Patterson, H.D., and E.R. Williams. 1976. A new class of resolvable
incomplete block designs. Biometrika 63:83-92.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtsi">mtsi()</a></code> <code><a href="#topic+waas">waas()</a></code>
<code><a href="#topic+get_model_data">get_model_data()</a></code> <code><a href="#topic+plot_scores">plot_scores()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
#===============================================================#
# Example 1: Analyzing all numeric variables assuming genotypes #
# as random effects with equal weights for mean performance and #
# stability                                                     #
#===============================================================#
model &lt;- waasb(data_ge,
              env = ENV,
              gen = GEN,
              rep = REP,
              resp = everything())

# Genetic parameters
get_model_data(model, "genpar")



#===============================================================#
# Example 2: Analyzing variables that starts with "N"           #
# assuming environment as random effects with higher weight for #
# response variable (65) for the three traits.                  #
#===============================================================#

model2 &lt;- waasb(data_ge2,
               env = ENV,
               gen = GEN,
               rep = REP,
               random = "env",
               resp = starts_with("N"),
               wresp = 65)


# Get the index WAASBY
get_model_data(model2, what = "WAASBY")


#===============================================================#
# Example 3: Analyzing GY and HM assuming a random-effect model.#
# Smaller values for HM and higher values for GY are better.    #
# To estimate WAASBY, higher weight for the GY (60%) and lower  #
# weight for HM (40%) are considered for mean performance.      #
#===============================================================#

model3 &lt;- waasb(data_ge,
                env = ENV,
                gen = GEN,
                rep = REP,
                resp = c(GY, HM),
                random = "all",
                mresp = c("h, l"),
                wresp = c(60, 40))

# Plot the scores (response x WAASB)
plot_scores(model3, type = 3)


</code></pre>

<hr>
<h2 id='wsmp'>Weighting between stability and mean performance</h2><span id='topic+wsmp'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>This function computes the WAASY or WAASBY indexes (Olivoto et al., 2019)
considering different scenarios of weights for stability and mean
performance.
</p>
<p>After fitting a model with the functions <code><a href="#topic+waas">waas()</a></code> or
<code><a href="#topic+waasb">waasb()</a></code> it is possible to compute the superiority indexes WAASY
or WAASBY in different scenarios of weights for stability and mean
performance. The number of scenarios is defined by the arguments
<code>increment</code>. By default, twenty-one different scenarios are computed. In
this case, the the superiority index is computed considering the following
weights: stability (waasb or waas) = 100; mean performance = 0. In other
words, only stability is considered for genotype ranking. In the next
iteration, the weights becomes 95/5 (since increment = 5). In the third
scenario, the weights become 90/10, and so on up to these weights become
0/100. In the last iteration, the genotype ranking for WAASY or WAASBY
matches perfectly with the ranks of the response variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wsmp(
  model,
  mresp = 100,
  increment = 5,
  saveWAASY = 50,
  prob = 0.05,
  progbar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wsmp_+3A_model">model</code></td>
<td>
<p>An object computed with <code><a href="#topic+waas">waas()</a></code>, <code><a href="#topic+waasb">waasb()</a></code>, or <code><a href="#topic+mps">mps()</a></code>.</p>
</td></tr>
<tr><td><code id="wsmp_+3A_mresp">mresp</code></td>
<td>
<p>A numeric value that will be the new maximum value after
rescaling. By default, the variable in <code>resp</code> is rescaled so that the
original maximum and minimum values are 100 and 0, respectively. Let us
consider that for a specific trait, say, lodging incidence, lower values
are better. In this case, you should use <code>mresp = 0</code> to rescale the
response variable so that the lowest values will become 100 and the highest
values 0.</p>
</td></tr>
<tr><td><code id="wsmp_+3A_increment">increment</code></td>
<td>
<p>The increment in the weight ratio for stability and mean
performance. Se the <strong>Details</strong> section for more information.</p>
</td></tr>
<tr><td><code id="wsmp_+3A_savewaasy">saveWAASY</code></td>
<td>
<p>Automatically save the WAASY values when the weight for
stability is <code>saveWAASY</code>.</p>
</td></tr>
<tr><td><code id="wsmp_+3A_prob">prob</code></td>
<td>
<p>The p-value for considering an interaction principal component
axis significant. must be multiple of <code>increment</code>. If this assumption
is not valid, an error will be occur.</p>
</td></tr>
<tr><td><code id="wsmp_+3A_progbar">progbar</code></td>
<td>
<p>A logical argument to define if a progress bar is shown.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>wsmp</code> with the following items for each
variable
</p>

<ul>
<li><p> When computed with <code><a href="#topic+waas">waas()</a></code> or <code><a href="#topic+waasb">waasb()</a></code>.
</p>

<ul>
<li> <p><strong>scenarios</strong> A list with the model for all computed scenarios.
</p>
</li>
<li> <p><strong>WAASY</strong> The values of the WAASY estimated when the weight for the
stability in the loop match with argument <code>saveWAASY</code>.
</p>
</li>
<li> <p><strong>hetdata, hetcomb</strong> The data used to produce the heatmaps.
</p>
</li>
<li> <p><strong>Ranks</strong> All the values of WAASY estimated in the different
scenarios of WAAS/GY weighting ratio.
</p>
</li></ul>

</li>
<li><p> When computed with <code><a href="#topic+mps">mps()</a></code>
</p>
</li>
<li> <p><strong>hetcomb</strong> showing the rank for mean performance and stability in the different weights.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Tiago Olivoto <a href="mailto:tiagoolivoto@gmail.com">tiagoolivoto@gmail.com</a>
</p>


<h3>References</h3>

<p>Olivoto, T., A.D.C. Lúcio, J.A.G. da silva, V.S. Marchioro, V.Q. de
Souza, and E. Jost. 2019. Mean performance and stability in multi-environment
trials I: Combining features of AMMI and BLUP techniques. Agron. J.
<a href="https://doi.org/10.2134/agronj2019.03.0220">doi:10.2134/agronj2019.03.0220</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+resca">resca()</a></code>, <code><a href="#topic+mps">mps()</a></code>, <code><a href="#topic+mtmps">mtmps()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metan)
# using the WAASB as statistic and BLUP as mean performance
# the same as using waasb()

model &lt;- mps(data_ge2,
             env = ENV,
             gen = GEN,
             rep = REP,
             resp = PH)
scenarios &lt;- wsmp(model)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
