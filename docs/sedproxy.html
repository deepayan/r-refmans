<!DOCTYPE html><html lang="en-gb"><head><title>Help for package sedproxy</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sedproxy}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BioturbationWeights'><p>Bioturbation weights</p></a></li>
<li><a href='#ClimToProxyClim'><p>Simulate sediment archived proxy records from an input climate signal.</p></a></li>
<li><a href='#example.data'><p>Data for running the examples in package <code>sedproxy</code></p></a></li>
<li><a href='#ForamGrowthfT'><p>Foraminifer Growth Rate Function from Lombard et al. (2009)</p></a></li>
<li><a href='#gisp2.ann'><p>gisp2 ice core data at annual resolution</p></a></li>
<li><a href='#MakePFMDataframe'><p>Convert &quot;everything&quot; part of output from ClimToProxyClim to dataframe.</p>
Used internally.</a></li>
<li><a href='#N41.G.ruber.seasonality'><p>Seasonality of Globigerinoides ruber at core MD97-2141</p></a></li>
<li><a href='#N41.proxy'><p>Mg/Ca proxy based temperature reconstruction for core MD97-2141</p></a></li>
<li><a href='#N41.proxy.details'><p>Metadata for datset <code>N41.proxy</code></p></a></li>
<li><a href='#N41.t21k.climate'><p>Climate (surface temperature) at core MD97-2141 from TraCE-21ka</p></a></li>
<li><a href='#param.tab'><p>sedproxy parameters</p></a></li>
<li><a href='#PlotPFMs'><p>Plot forward modelled sedimentary proxies</p></a></li>
<li><a href='#ProxyConversion'><p>Convert between Temperature in Degrees C and Proxy Units</p></a></li>
<li><a href='#scussolini.tab1'><p>Scussolini et al. (2013) Table 1</p></a></li>
<li><a href='#sedproxy'><p>sedproxy: Simulation of Sediment Archived Climate Proxy Records</p></a></li>
<li><a href='#stage.labels'><p>Labels for proxy stages</p></a></li>
<li><a href='#stages.key'><p>Description of proxy stages</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Simulation of Sediment Archived Climate Proxy Records</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Proxy forward modelling for sediment archived climate proxies such 
  as Mg/Ca, d18O or Alkenones. The user provides a hypothesised "true" past climate, 
  such as output from a climate model, and details of the sedimentation rate and 
  sampling scheme of a sediment core. Sedproxy returns simulated proxy records. 
  Implements the methods described in Dolman and Laepple (2018) 
  &lt;<a href="https://doi.org/10.5194%2Fcp-14-1851-2018">doi:10.5194/cp-14-1851-2018</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-gb</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, mvtnorm, dplyr, tidyr, ggplot2, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://earthsystemdiagnostics.github.io/sedproxy/">https://earthsystemdiagnostics.github.io/sedproxy/</a>,
<a href="https://github.com/EarthSystemDiagnostics/sedproxy">https://github.com/EarthSystemDiagnostics/sedproxy</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-26 10:27:59 UTC; Andrew</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Laepple [aut],
  Andrew Dolman [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Dolman &lt;andrew.dolman@awi.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-26 10:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BioturbationWeights'>Bioturbation weights</h2><span id='topic+BioturbationWeights'></span>

<h3>Description</h3>

<p>For a given focal depth (or time), this function returns the probability
that material collected from that depth was originally deposited at depth(s)
z. In other words, that the material would have been found at depth z if there
had been no bioturbation. It is the convolution of the depth solution from
Berger and Heath (1968) with a uniform distribution to account for the width
of the sediment layer from which samples
were picked/extracted. It is a probability density function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BioturbationWeights(
  z,
  focal.z,
  layer.width = 1,
  sed.acc.rate,
  bio.depth,
  scale = c("time", "depth")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BioturbationWeights_+3A_z">z</code></td>
<td>
<p>A vector of times or depths at which to evaluate the bioturbation weights</p>
</td></tr>
<tr><td><code id="BioturbationWeights_+3A_focal.z">focal.z</code></td>
<td>
<p>The depth (or time) for which source dates are wanted</p>
</td></tr>
<tr><td><code id="BioturbationWeights_+3A_layer.width">layer.width</code></td>
<td>
<p>the width of the sediment layer from which samples were
taken, e.g. foraminifera were picked or alkenones were extracted, in cm.
Defaults to 1 cm. If bio.depth and layer.width are both set to zero,
each timepoint samples from a single year of the clim.signal, equivalent to
sampling an annually laminated sediment core.</p>
</td></tr>
<tr><td><code id="BioturbationWeights_+3A_sed.acc.rate">sed.acc.rate</code></td>
<td>
<p>Sediment accumulation rate in cm per 1000 years. Defaults
to 50 cm per ka. Either a single value, or vector of same length as
&quot;timepoints&quot;</p>
</td></tr>
<tr><td><code id="BioturbationWeights_+3A_bio.depth">bio.depth</code></td>
<td>
<p>Depth of the bioturbated layer in cm, defaults to 10 cm.</p>
</td></tr>
<tr><td><code id="BioturbationWeights_+3A_scale">scale</code></td>
<td>
<p>Whether to scale depths by sediment accumulation rate to give
positions in terms of time. Defaults to time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical vector of weights.
</p>


<h3>References</h3>

<p>Berger, W. H., &amp; Heath, G. R. (1968).
Vertical mixing in pelagic sediments.
Journal of Marine Research, 26(2), 134–143.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>z &lt;- 0:10000
w &lt;- BioturbationWeights(z, focal.z = 4000, layer.width = 1, sed.acc.rate = 5, bio.depth = 10)
plot(z, w, "l")
</code></pre>

<hr>
<h2 id='ClimToProxyClim'>Simulate sediment archived proxy records from an input climate signal.</h2><span id='topic+ClimToProxyClim'></span>

<h3>Description</h3>

<p><code>ClimToProxyClim</code> simulates the creation of a proxy climate
record from a climate signal that is assumed to be true.
</p>
<p>The following aspects of proxy creation are currently modelled.
</p>

<ol>
<li><p> Seasonal bias in the encoding of a proxy due to the interaction between
climate seasonality and any seasonality in the life cycle of the organism
encoding the climate signal (e.g. Foraminifera for Mg/Ca ratios, or
phytoplankton for Alkenone unsaturation indices).
</p>
</li>
<li><p> Bioturbation of the sediment archived proxy. For each requested
timepoint, the simulated proxy consists of a weighted mean of the climate
signal over a time window that is determined by the sediment accumulation
rate <em>sed.acc.rate</em> and the bioturbation depth <em>bio.depth</em> which defaults
to 10 cm. The weights are given by the depth solution to an impulse
response function (Berger and Heath, 1968).
</p>
</li>
<li><p> Aliasing of seasonal and inter-annual climate variation onto to
bioturbated (smoothed) signal. For proxies measured on a small number of
discrete particles both seasonal and inter-annual climate variation is
aliased into the proxy record. For example, Foraminifera have a life-cycle
of approximately 1 month, so they record something like the mean
temperature from a single month. If Mg/Ca is measured on e.g.
<code>n.samples</code> = 30 individuals, the measured proxy signal is a mean of
30 distinct monthly mean temperatures and will thus be a stochastic sample
of the true mean climate.
</p>
</li>
<li><p> Measurement noise/error is added as a pure Gaussian white noise process
with mean = 0, standard deviation =
<code>sqrt(sigma.meas^2 + sigma.ind^2/n.samples)</code>.
</p>
</li>
<li><p> Additionally, a random <em>bias</em> can be added to each realisation of a
proxy record. Bias is simulated as a Gaussian random variable with mean =
0, standard deviation = <code>meas.bias</code>. The same randomly generated bias
value is applied to all timepoints in a simulated proxy record, when
multiple replicate proxies are generated (<em>n.replicates</em> &gt; 1) each
replicate has a different bias applied.
</p>
</li></ol>

<p><code>ClimToProxyClim</code> returns one or more replicates of the final
simulated proxy as well as several intermediate stages (see section
<strong>Value</strong> below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ClimToProxyClim(
  clim.signal,
  timepoints,
  calibration.type = c("identity", "Uk37", "MgCa"),
  calibration = switch(calibration.type, identity = NA, Uk37 = "Mueller global", MgCa =
    "Ten planktonic species_350-500"),
  slp.int.means = NULL,
  slp.int.vcov = NULL,
  noise.type = switch(calibration.type, identity = "additive", Uk37 = "additive", MgCa
    = "multiplicative"),
  plot.sig.res = 100,
  habitat.weights = rep(1/ncol(clim.signal), ncol(clim.signal)),
  habitat.wt.args = NULL,
  bio.depth = 10,
  sed.acc.rate = 50,
  layer.width = 1,
  sigma.meas = 0,
  sigma.ind = 0,
  meas.bias = 0,
  scale.noise = switch(calibration.type, identity = FALSE, Uk37 = TRUE, MgCa = TRUE),
  n.samples = Inf,
  n.replicates = 1,
  top.of.core = NULL,
  n.bd = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ClimToProxyClim_+3A_clim.signal">clim.signal</code></td>
<td>
<p>The &quot;assumed true&quot; climate signal, e.g. climate model
output or instrumental record. A <code><a href="stats.html#topic+ts">ts</a></code> object consisting of a
years x 12 (months) x n habitats (e.g. depths) matrix of temperatures. The
time series should be at annual resolution and in reverse, i.e. &quot;most
recent timepoint first&quot; order.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_timepoints">timepoints</code></td>
<td>
<p>The timepoints for which the proxy record is to be modelled</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_calibration.type">calibration.type</code></td>
<td>
<p>Type of proxy, e.g. Uk'37 or MgCa, to which the
clim.signal is converted before the archiving and measurement of the proxy
is simulated. Defaults to &quot;identity&quot; which means no conversion takes place.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_calibration">calibration</code></td>
<td>
<p>The name of a specific calibration for which calibration parameters
are provided by sedproxy. Currently applies only to calibration.type MgCa.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_slp.int.means">slp.int.means</code></td>
<td>
<p>Optional user supplied vector of values for the slope
and intercept of the calibration function. Overides the defaults.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_slp.int.vcov">slp.int.vcov</code></td>
<td>
<p>Optional user supplied variance covariance matrix
calibration parameters. Overides the defaults.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_noise.type">noise.type</code></td>
<td>
<p>Determines whether additive or multiplicative measurement
noise is added. The appropriate type depends on the units of the proxy.
Defaults to multiplicative for MgCa, additive for Uk'37 and identity (none)
calibration types. Can be overidden with a string, &quot;additive&quot; or
&quot;multiplicative&quot; in the case that pre-converted climate signal and
measurement noise values are used in combination with an &quot;identity&quot;
calibration type.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_plot.sig.res">plot.sig.res</code></td>
<td>
<p>The resolution, in years, of the smoothed (block
averaged) version of the input climate signal returned for plotting. This
does not affect what the proxy model uses as input. If set to NA, no
smoothed climate output is generated, this can speed up some simulations.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_habitat.weights">habitat.weights</code></td>
<td>
<p>Production weights for the proxy / proxy-carrier
either as a vector of values with length = ncol(clim.signal), i.e. 1 weight
for each month x habitat combination, a matrix of the same dimensions as the
input climate signal matrix, or a function that produces an index of
productivity as a function of temperature.
Defaults to a vector of length = ncol(clim.signal) of equal weights.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_habitat.wt.args">habitat.wt.args</code></td>
<td>
<p>A named list of parameter values to be passed to
a function named in habitat.weights.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_bio.depth">bio.depth</code></td>
<td>
<p>Depth of the bioturbated layer in cm, defaults to 10 cm.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_sed.acc.rate">sed.acc.rate</code></td>
<td>
<p>Sediment accumulation rate in cm per 1000 years. Defaults
to 50 cm per ka. Either a single value, or vector of same length as
&quot;timepoints&quot;</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_layer.width">layer.width</code></td>
<td>
<p>the width of the sediment layer from which samples were
taken, e.g. foraminifera were picked or alkenones were extracted, in cm.
Defaults to 1 cm. If bio.depth and layer.width are both set to zero,
each timepoint samples from a single year of the clim.signal, equivalent to
sampling an annually laminated sediment core.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_sigma.meas">sigma.meas</code></td>
<td>
<p>The standard deviation of the measurement error
added to each simulated proxy value.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_sigma.ind">sigma.ind</code></td>
<td>
<p>The standard deviation of error between individuals
(e.g. Forams) not otherwise modelled. This could included &quot;vital effects&quot; or
aliasing of depth habitat variation not modelled via a depth resolved input
climate signal and habitat weights. sigma.ind is scaled by n.samples
before being combined with sigma.meas.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_meas.bias">meas.bias</code></td>
<td>
<p>The amount of bias to add to each simulated proxy
time-series. Each replicate proxy time-series has a constant bias added,
drawn from a normal distribution with mean = 0, sd = meas.bias. Bias
defaults to zero.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_scale.noise">scale.noise</code></td>
<td>
<p>Scale noise to proxy units. Defaults to TRUE if
calibration.type is not &quot;identity&quot;</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_n.samples">n.samples</code></td>
<td>
<p>Number of e.g. Foraminifera sampled per timepoint, this can
be either a single number, or a vector of length = timepoints. Can be set
to Inf for non-discrete proxies, e.g. for Uk’37.</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_n.replicates">n.replicates</code></td>
<td>
<p>Number of replicate proxy time-series to simulate from
the climate signal</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_top.of.core">top.of.core</code></td>
<td>
<p>The theoretical minimum age at the top of the core, ie.
the year the core was sampled, defaults to the start of clim.in</p>
</td></tr>
<tr><td><code id="ClimToProxyClim_+3A_n.bd">n.bd</code></td>
<td>
<p>Number of multiples of the bioturbation width at which to truncate
the bioturbation filter</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ClimToProxyClim</code> returns an object of class &quot;sedproxy.pfm&quot;, a list with three elements:
</p>

<ol>
<li><p> a dataframe <code>simulated.proxy</code>
</p>
</li>
<li><p> a dataframe <code>smoothed.signal</code>
</p>
</li>
<li><p> a dataframe <code>everything</code>
</p>
</li></ol>

<p>The dataframe <code>simulated.proxy</code> contains a single realisation of the
final forward modelled proxy, as well as the intermediate stages and the
original climate signal at the requested timepoints.
</p>
<p>The dataframe <code>smoothed.signal</code> contains a block averaged version the
input climate signal, defaults to 100 year means but this is set by the
parameter plot.sig.res. This is useful for plotting against the
resulting simulated proxy.
</p>
<p>The dataframe <code>everything</code> contains all of the above but with multiple
replicates of the pseudo-proxy records if requested. The data are in
&quot;long form&quot;, with the column &quot;stage&quot; inidcating the proxy stage or input
climate resolution and column &quot;value&quot; giving the values.
</p>
<p><strong>Named elements of the returned proxy record:</strong>
</p>

<dl>
<dt>timepoints</dt><dd><p>Requested timepoints</p>
</dd>
<dt>clim.signal.ann</dt><dd><p>Input climate signal at requested timepoints at annual resolution</p>
</dd>
<dt>clim.signal.smoothed</dt><dd><p>Input climate signal at regular time intervals and resolution = plot.sig.res</p>
</dd>
<dt>clim.timepoints.ssr</dt><dd><p>Input climate signal at requested timepoints, smoothed to resolution = plot.sig.res</p>
</dd>
<dt>proxy.bt</dt><dd><p>Climate signal after bioturbation</p>
</dd>
<dt>proxy.bt.sb</dt><dd><p>Climate signal after bioturbation and habitat bias</p>
</dd>
<dt>proxy.bt.sb.inf.b</dt><dd><p>Climate signal after bioturbation, habitat bias, and calibration bias</p>
</dd>
<dt>proxy.bt.sb.inf.b.n</dt><dd><p>Climate signal after bioturbation, habitat bias, and measurement error</p>
</dd>
<dt>proxy.bt.sb.sampY</dt><dd><p>Climate signal after bioturbation, habitat bias, and aliasing of inter-annual variation</p>
</dd>
<dt>proxy.bt.sb.sampYM</dt><dd><p>Climate signal after bioturbation, habitat bias, and aliasing of inter-annual and intra-annual variation such as monthly temperatures or depth habitats</p>
</dd>
<dt>proxy.bt.sb.sampYM.b</dt><dd><p>Climate signal after bioturbation, habitat bias, and aliasing of inter-annual and intra-annual variation such as monthly temperatures or depth habitats, and calibration bias</p>
</dd>
<dt>proxy.bt.sb.sampYM.b.n</dt><dd><p>Climate signal after bioturbation, habitat bias, aliasing, and measurement error</p>
</dd>
<dt>simulated.proxy</dt><dd><p>Final simulated pseudo-proxy, this will be same as proxy.bt.sb.inf.b.n when n.samples = Inf, and proxy.bt.sb.sampYM.b.n when n.samples is finite</p>
</dd>
<dt>observed.proxy</dt><dd><p>True observed proxy (when supplied)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
set.seed(26052017)
clim.in &lt;- ts(N41.t21k.climate[nrow(N41.t21k.climate):1,] - 273.15, start = -39)

PFM &lt;- ClimToProxyClim(clim.signal = clim.in,
                       timepoints = round(N41.proxy$Published.age),
                       calibration.type = "identity",
                       habitat.weights = N41.G.ruber.seasonality,
                       sed.acc.rate = N41.proxy$Sed.acc.rate.cm.ka,
                       layer.width = 1,
                       sigma.meas = 0.46,
                       sigma.ind = 0, n.samples = Inf,
                       plot.sig.res = 10, meas.bias = 1,
                       n.replicates = 10)

PlotPFMs(PFM$everything, max.replicates = 1, stage.order = "seq") +
  facet_wrap(~stage)

PlotPFMs(PFM$everything, max.replicates = 1, stage.order = "var")

PlotPFMs(PFM$everything, stage.order = "var", plot.stages = "all")

</code></pre>

<hr>
<h2 id='example.data'>Data for running the examples in package <code>sedproxy</code></h2><span id='topic+example.data'></span>

<h3>Description</h3>

<p>A set of data objects for running the examples in <code>sedproxy</code>
</p>
<p><code><a href="#topic+N41.proxy">N41.proxy</a></code>
</p>
<p><code><a href="#topic+N41.proxy.details">N41.proxy.details</a></code>
</p>
<p><code><a href="#topic+N41.G.ruber.seasonality">N41.G.ruber.seasonality</a></code>
</p>
<p><code><a href="#topic+N41.t21k.climate">N41.t21k.climate</a></code>
</p>


<h3>Details</h3>

<p>Example data
</p>

<hr>
<h2 id='ForamGrowthfT'>Foraminifer Growth Rate Function from Lombard et al. (2009)</h2><span id='topic+ForamGrowthfT'></span>

<h3>Description</h3>

<p>Implements the function for foraminifer growth rate as a function of
temperature from Lombard et al. (2009) with parametrization from FAME 1.0
(Roche et al, 2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ForamGrowthfT(
  foram = c("sacculifer", "bulloides", "pachy_d", "siphonifera", "universa", "pachy_s",
    "dutertrei", "ruber"),
  temperature_K,
  norm = FALSE,
  min.growth.thresh = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ForamGrowthfT_+3A_foram">foram</code></td>
<td>
<p>Name of foram.</p>
</td></tr>
<tr><td><code id="ForamGrowthfT_+3A_temperature_k">temperature_K</code></td>
<td>
<p>Temperature in Kelvin</p>
</td></tr>
<tr><td><code id="ForamGrowthfT_+3A_norm">norm</code></td>
<td>
<p>Optional normalizing factor</p>
</td></tr>
<tr><td><code id="ForamGrowthfT_+3A_min.growth.thresh">min.growth.thresh</code></td>
<td>
<p>Sets a lower cutoff for growth as a proportion of
the maximum growth rate for that taxon. For example in Roche et al (2018) a cutoff of
0.1 was used, meaning all growth rates less than 0.1*max were set to zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numerical vector or matrix with the same dimensions as the object
passed to temperature_K. Units are daily growth rate, unless norm == TRUE.
</p>


<h3>References</h3>

<p>Lombard, F., Labeyrie, L., Michel, E., Spero, H. J., and Lea, D. W.:
Modelling the temperature dependent growth rates of planktic foraminifera,
Marine Micropaleontology, 70, 1–7,
https://doi.org/10.1016/j.marmicro.2008.09.004, 2009.
</p>
<p>Roche, D. M., Waelbroeck, C., Metcalfe, B. and Caley, T.: FAME
(v1.0): a simple module to simulate the effect of planktonic foraminifer
species-specific habitat on their oxygen isotopic content, Geosci. Model
Dev. Discuss., 2017, 1–22, doi:10.5194/gmd-2017-251, 2017.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ForamGrowthfT(foram = 'ruber', temperature_K = (c(280, 290)), norm = 1)
</code></pre>

<hr>
<h2 id='gisp2.ann'>gisp2 ice core data at annual resolution</h2><span id='topic+gisp2.ann'></span>

<h3>Description</h3>

<p>gisp2 ice core data interpolated to annual resolution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gisp2.ann
</code></pre>


<h3>Format</h3>

<p>A data frame with 49885 rows and 3 variables:
</p>

<dl>
<dt><code>age.yr.bp</code></dt><dd><p>Age in years BP</p>
</dd>
<dt><code>temperature</code></dt><dd><p>temperature in deg C</p>
</dd>
<dt><code>temperature.rescaled</code></dt><dd><p>temperature rescaled to resemble 
a d18O record as in Löwemark et al 2008</p>
</dd> 
</dl>



<h3>Details</h3>

<p>GISP2 data from Alley, R.B.. 2004. GISP2 Ice Core Temperature and
Accumulation Data. IGBP PAGES/World Data Center for Paleoclimatology Data
Contribution Series 2004-013. NOAA/NGDC Paleoclimatology Program, Boulder CO,
USA. Interpolated to annual resolution and additionally rescaled to resemble
a d18O record. As in Fig.2 of Löwemark, L., Konstantinou, K. I. and Steinke,
S.: Bias in foraminiferal multispecies reconstructions of paleohydrographic
conditions caused by foraminiferal abundance variations and bioturbational
mixing: A model approach, Marine Geology, 256(1–4), 101–106,
doi:10.1016/j.margeo.2008.10.005, 2008.
</p>

<hr>
<h2 id='MakePFMDataframe'>Convert &quot;everything&quot; part of output from ClimToProxyClim to dataframe.
Used internally.</h2><span id='topic+MakePFMDataframe'></span>

<h3>Description</h3>

<p>Convert &quot;everything&quot; part of output from ClimToProxyClim to dataframe.
Used internally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MakePFMDataframe(PFM)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MakePFMDataframe_+3A_pfm">PFM</code></td>
<td>
<p>output from ClimToProxyClim</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe
</p>

<hr>
<h2 id='N41.G.ruber.seasonality'>Seasonality of Globigerinoides ruber at core MD97-2141</h2><span id='topic+N41.G.ruber.seasonality'></span>

<h3>Description</h3>

<p>Seasonality of Globigerinoides ruber at core MD97-2141 predicted
by the PLAFOM model (Fraile et al. 2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>N41.G.ruber.seasonality
</code></pre>


<h3>Format</h3>

<p>A vector of 12 values
</p>


<h3>Source</h3>

<p>Fraile, I., Schulz, M., Mulitza, S., &amp; Kucera, M. (2008).
Predicting the global distribution of planktonic foraminifera using a
dynamic ecosystem model. Biogeosciences, 5(3), 891–911.
</p>

<hr>
<h2 id='N41.proxy'>Mg/Ca proxy based temperature reconstruction for core MD97-2141</h2><span id='topic+N41.proxy'></span>

<h3>Description</h3>

<p>Mg/Ca proxy based temperature reconstruction for core MD97-2141, originally published in
Rosenthal et al. (2003), extracted from Shakun et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>N41.proxy
</code></pre>


<h3>Format</h3>

<p>A data frame with 216 rows and 4 variables:
</p>

<table>
<tr>
 <td style="text-align: left;">
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Published.age</code> </td><td style="text-align: left;"> Age in yr BP
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Published.temperature</code> </td><td style="text-align: left;"> Reconstructed temperature in degrees C
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Sed.acc.rate.cm.ka</code> </td><td style="text-align: left;"> Sediment accumulation rate in cm per kyr
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Published age and published temperature were extracted from
Shakun, J. D., Clark, P. U., He, F., Marcott, S. A.,
Mix, A. C., Liu, Z., … Bard, E. (2012). Global warming preceded by increasing
carbon dioxide concentrations during the last deglaciation. Nature,
484(7392), 49–54. doi: <a href="https://doi.org/10.1038/nature10915">10.1038/nature10915</a>.
</p>
<p>Sediment accumulation rates were estimated by fitting splines to the published
age and depth estimates.
</p>


<h3>Source</h3>

<p>Original reference: Rosenthal, Y., Oppo, D. W., &amp; Linsley, B. K.
(2003). The amplitude and phasing of climate change during the last
deglaciation in the Sulu Sea, western equatorial Pacific. Geophysical
Research Letters, 30(8), 1428. doi: <a href="https://doi.org/10.1029/2002GL016612">10.1029/2002GL016612</a>.
</p>

<hr>
<h2 id='N41.proxy.details'>Metadata for datset <code>N41.proxy</code></h2><span id='topic+N41.proxy.details'></span>

<h3>Description</h3>

<p>Metadata for core MD97-2141 taken from Shakun et al. (2012)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>N41.proxy.details
</code></pre>


<h3>Format</h3>

<p>A data frame with 1 rows and 17 variables:
</p>

<table>
<tr>
 <td style="text-align: left;">
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Number</code> </td><td style="text-align: left;"> Proxy ID number from Shakun et al. (2012)
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>ID.no</code> </td><td style="text-align: left;"> Proxy ID number from Shakun et al. (2012) with prefix "N"
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Core</code> </td><td style="text-align: left;"> ID code of sediment core
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Location</code> </td><td style="text-align: left;"> Location of core
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Proxy</code> </td><td style="text-align: left;"> Proxy type
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Lat</code> </td><td style="text-align: left;"> Latutide of core
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Lon</code> </td><td style="text-align: left;"> Longitude of core
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Elevation</code> </td><td style="text-align: left;"> Depth of core-top below sea level in metres
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Reference</code> </td><td style="text-align: left;"> Original reference for the proxy record
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Resolution</code> </td><td style="text-align: left;"> Average time resolution in years
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Calibration.ref</code> </td><td style="text-align: left;"> Reference for Mg/Ca calibration
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Calibration</code> </td><td style="text-align: left;"> Mg/Ca calibration formula
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Foram.sp</code> </td><td style="text-align: left;"> Foram species analyses for proxy
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Ref.14C</code> </td><td style="text-align: left;"> Reference for carbon dating
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Notes</code> </td><td style="text-align: left;">
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Geo.cluster</code> </td><td style="text-align: left;"> Coarse geographic location
   </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Archive.type</code> </td><td style="text-align: left;"> Type of proxy archive
</td>
</tr>

</table>



<h3>Source</h3>

<p>Shakun, J. D., Clark, P. U., He, F., Marcott, S. A.,
Mix, A. C., Liu, Z., … Bard, E. (2012). Global warming preceded by increasing
carbon dioxide concentrations during the last deglaciation. Nature,
484(7392), 49–54. doi: <a href="https://doi.org/10.1038/nature10915">10.1038/nature10915</a>
</p>

<hr>
<h2 id='N41.t21k.climate'>Climate (surface temperature) at core MD97-2141 from TraCE-21ka</h2><span id='topic+N41.t21k.climate'></span>

<h3>Description</h3>

<p>Modelled surface temperature at core MD97-2141. Model output
from TraCE-21ka simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>N41.t21k.climate
</code></pre>


<h3>Format</h3>

<p>A matrix with 22040 rows and 12 columns
</p>


<h3>Source</h3>

<p>Liu, Z., Otto-Bliesner, B. L., He, F., Brady, E. C., Tomas, R.,
Clark, P. U., … Cheng, J. (2009).
Transient Simulation of Last Deglaciation with a New Mechanism for
Bølling-Allerød Warming. Science, 325(5938), 310–314.
https://doi.org/10.1126/science.1171041
</p>

<hr>
<h2 id='param.tab'>sedproxy parameters</h2><span id='topic+param.tab'></span>

<h3>Description</h3>

<p>Parameters and variables required to generate a pseudo-proxy with <code>ClimToProxyClim</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>param.tab
</code></pre>


<h3>Format</h3>

<p>A data frame with 12 rows and 4 variables:
</p>

<dl>
<dt><code>Function argument</code></dt><dd><p>character Argument name in <code>ClimToProxyClim</code></p>
</dd>
<dt><code>Description</code></dt><dd><p>character Description of argument and corresponding variable/parameter</p>
</dd>
<dt><code>Possible sources</code></dt><dd><p>character Source or possible sources of values for arguments</p>
</dd>
<dt><code>Default</code></dt><dd><p>character Default values for arguments</p>
</dd>
</dl>


<hr>
<h2 id='PlotPFMs'>Plot forward modelled sedimentary proxies</h2><span id='topic+PlotPFMs'></span>

<h3>Description</h3>

<p>Plot forward modelled sedimentary proxies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotPFMs(
  PFMs,
  stage.order = c("var", "seq"),
  plot.stages = c("default"),
  max.replicates = 5,
  colr.palette = "default",
  alpha.palette = "default",
  levl.labels = "default"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotPFMs_+3A_pfms">PFMs</code></td>
<td>
<p>A dataframe of forward modelled proxies</p>
</td></tr>
<tr><td><code id="PlotPFMs_+3A_stage.order">stage.order</code></td>
<td>
<p>Controls the order in which proxy stages are plotted,
either sequentially, &quot;seq&quot;, or in order of variance, &quot;var&quot;. Defaults to var.</p>
</td></tr>
<tr><td><code id="PlotPFMs_+3A_plot.stages">plot.stages</code></td>
<td>
<p>Proxy stages to be plotted, &quot;default&quot;, &quot;all&quot;, or a custom character vector</p>
</td></tr>
<tr><td><code id="PlotPFMs_+3A_max.replicates">max.replicates</code></td>
<td>
<p>Maximum number of replicates to plot at once</p>
</td></tr>
<tr><td><code id="PlotPFMs_+3A_colr.palette">colr.palette</code></td>
<td>
<p>Colours for the proxy stages</p>
</td></tr>
<tr><td><code id="PlotPFMs_+3A_alpha.palette">alpha.palette</code></td>
<td>
<p>Alpha levels for the proxy stages</p>
</td></tr>
<tr><td><code id="PlotPFMs_+3A_levl.labels">levl.labels</code></td>
<td>
<p>Labels for the proxy stages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggplot object of class &quot;gg&quot; &quot;ggplot&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
set.seed(26052017)
clim.in &lt;- ts(N41.t21k.climate[nrow(N41.t21k.climate):1,] - 273.15)

PFM &lt;- ClimToProxyClim(clim.signal = clim.in,
                       timepoints = round(N41.proxy$Published.age),
                       calibration.type = "identity",
                       habitat.weights = N41.G.ruber.seasonality,
                       sed.acc.rate = N41.proxy$Sed.acc.rate.cm.ka,
                       sigma.meas = 0.45,
                       sigma.ind = 0,
                       n.samples = Inf,
                       plot.sig.res = 10, meas.bias = 1,
                       n.replicates = 10)

PlotPFMs(PFM$everything, max.replicates = 1, stage.order = "seq") +
  facet_wrap(~stage)

PlotPFMs(PFM$everything, max.replicates = 1, stage.order = "var")

PlotPFMs(PFM$everything, stage.order = "var", plot.stages = "all")

</code></pre>

<hr>
<h2 id='ProxyConversion'>Convert between Temperature in Degrees C and Proxy Units</h2><span id='topic+ProxyConversion'></span>

<h3>Description</h3>

<p>A wrapper function for accessing proxy - temperature conversion functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ProxyConversion(
  temperature = NULL,
  proxy.value = NULL,
  calibration.type = "identity",
  slp.int.means = NULL,
  slp.int.vcov = NULL,
  calibration = switch(calibration.type, identity = NA, Uk37 = "Mueller global", MgCa =
    "Ten planktonic species_350-500"),
  point.or.sample = c("point", "sample"),
  n = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ProxyConversion_+3A_temperature">temperature</code></td>
<td>
<p>Temperature in degrees C</p>
</td></tr>
<tr><td><code id="ProxyConversion_+3A_proxy.value">proxy.value</code></td>
<td>
<p>Temperature in proxy units</p>
</td></tr>
<tr><td><code id="ProxyConversion_+3A_calibration.type">calibration.type</code></td>
<td>
<p>Type of proxy, e.g. Uk37 or MgCa</p>
</td></tr>
<tr><td><code id="ProxyConversion_+3A_slp.int.means">slp.int.means</code></td>
<td>
<p>Optional user supplied vector of values for the slope
and intercept of the calibration function. Overides the defaults.</p>
</td></tr>
<tr><td><code id="ProxyConversion_+3A_slp.int.vcov">slp.int.vcov</code></td>
<td>
<p>Optional user supplied variance covariance matrix
calibration parameters. Overides the defaults.</p>
</td></tr>
<tr><td><code id="ProxyConversion_+3A_calibration">calibration</code></td>
<td>
<p>The name of a specific calibration for which calibration parameters
are provided by sedproxy. Currently applies only to calibration.type MgCa.</p>
</td></tr>
<tr><td><code id="ProxyConversion_+3A_point.or.sample">point.or.sample</code></td>
<td>
<p>Use the &quot;best estimate&quot; calibration parameters, or
parameters sampled from the fitted calibration model</p>
</td></tr>
<tr><td><code id="ProxyConversion_+3A_n">n</code></td>
<td>
<p>the number of replicate conversions to make in the case of sampled
calibration parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Valid entries for calibration are: &quot;Ten planktonic species_350-500&quot;, &quot;G. aequilateralis_350-500&quot;, &quot;G.
aequilateralis_500-1000&quot;, &quot;G. conglobatus_350-500&quot;, &quot;G. hirsuta_350-500&quot;,
&quot;G. inflata_350-500&quot;, &quot;G. ruber pink_250-350&quot;, &quot;G. ruber pink_350-500&quot;, &quot;G.
ruber white_250-350&quot;, &quot;G. ruber white_350-500&quot;, &quot;G. sacculifer with
sac_350-500&quot;, &quot;G. sacculifer without sac_350-500&quot;, &quot;G.
truncatulinoides_350-500&quot;, &quot;G. truncatulinoides_500-1000&quot;, &quot;N.
dutertrei_350-500&quot;, &quot;O. univesa_350-500&quot;, &quot;P. obliquiloculata_350-500&quot;
</p>


<h3>Value</h3>

<p>a vector of temperatures or proxy values
</p>


<h3>Examples</h3>

<pre><code class='language-R'># From temperature to UK'37
## With fixed calibration
ProxyConversion(temperature = c(10, 20), point.or.sample = "point",
                calibration.type = "Uk37")

## With random calibration, 5 replicates
ProxyConversion(temperature = c(1, 2), n = 5, point.or.sample = "sample",
                calibration.type = "Uk37")


## Back-transformation with same calibration
ProxyConversion(
  proxy.value = as.vector(
    ProxyConversion(
      temperature = c(21, 22),
      calibration.type = "Uk37",
      point.or.sample = "point"
    )
  ),
  point.or.sample = "point",
  calibration.type = "Uk37"
)

## Back-transformation with random calibration
ProxyConversion(
  proxy.value = as.vector(
    ProxyConversion(
      temperature = c(21, 22),
      calibration.type = "Uk37",
     point.or.sample = "point"
    )
  )
  ,
  n = 5,
  point.or.sample = "sample",
  calibration.type = "Uk37"
)

## Incompatible arguments
## Not run: 
ProxyConversion(temperature = 1, proxy.value = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='scussolini.tab1'>Scussolini et al. (2013) Table 1</h2><span id='topic+scussolini.tab1'></span>

<h3>Description</h3>

<p>Data from table 1 in Scussolini et al. (2013)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scussolini.tab1
</code></pre>


<h3>Format</h3>

<p>A dataframe with 22 rows and 6 columns
</p>


<h3>Source</h3>

<p>Scussolini, P., van Sebille, E., &amp; Durgadoo, J. V. (2013).
Paleo Agulhas rings enter the subtropical gyre during the penultimate
deglaciation. Climate of the Past, 9(6), 2631–2639.
https://doi.org/10.5194/cp-9-2631-2013
</p>

<hr>
<h2 id='sedproxy'>sedproxy: Simulation of Sediment Archived Climate Proxy Records</h2><span id='topic+sedproxy'></span>

<h3>Description</h3>

<p>The sedproxy package provides functions to simulate sediment archived proxies
</p>

<hr>
<h2 id='stage.labels'>Labels for proxy stages</h2><span id='topic+stage.labels'></span>

<h3>Description</h3>

<p>Labels for proxy stages. For plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stage.labels
</code></pre>


<h3>Format</h3>

<p>A named character vector
</p>

<hr>
<h2 id='stages.key'>Description of proxy stages</h2><span id='topic+stages.key'></span>

<h3>Description</h3>

<p>A description of the proxy stages in the output of <code>ClimToProxyClim</code>
and default labels, colours and order for plotting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stages.key
</code></pre>


<h3>Format</h3>

<p>A data frame with 13 rows and 6 variables:
</p>

<table>
<tr>
 <td style="text-align: left;">
  </td>
</tr>
<tr>
 <td style="text-align: left;">  <code>stage</code>  </td><td style="text-align: left;"> proxy stage
  </td>
</tr>
<tr>
 <td style="text-align: left;">  <code>label</code>  </td><td style="text-align: left;"> label for proxy stage
  </td>
</tr>
<tr>
 <td style="text-align: left;">  <code>description</code>  </td><td style="text-align: left;"> description of proxy stage
  </td>
</tr>
<tr>
 <td style="text-align: left;">  <code>plot.order</code>  </td><td style="text-align: left;"> default plotting order of stages
  </td>
</tr>
<tr>
 <td style="text-align: left;">  <code>plotting.colour</code>  </td><td style="text-align: left;"> default colour for plotting
  </td>
</tr>
<tr>
 <td style="text-align: left;">  <code>plotting.alpha</code>  </td><td style="text-align: left;"> default alpha level for plotting
</td>
</tr>

</table>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
