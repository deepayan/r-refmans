<!DOCTYPE html><html><head><title>Help for package missDeaths</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {missDeaths}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+,md.simdata,md.simdataobject-method'><p>operator</p></a></li>
<li><a href='#md.binom'><p>md.binom</p></a></li>
<li><a href='#md.censor'><p>Censoring simulated survival data</p></a></li>
<li><a href='#md.constant'><p>md.constant</p></a></li>
<li><a href='#md.D'><p>Prepare compatible demographic information</p></a></li>
<li><a href='#md.data'><p>md.data</p></a></li>
<li><a href='#md.death'><p>md.death</p></a></li>
<li><a href='#md.eval'><p>md.eval</p></a></li>
<li><a href='#md.exp'><p>md.exp</p></a></li>
<li><a href='#md.expprep'><p>Calculates individual expected survival beyond the observation time</p></a></li>
<li><a href='#md.impute'><p>Correctly impute missing information of possible deaths using population mortality</p></a></li>
<li><a href='#md.init'><p>Initializes the missDeaths population table cache</p></a></li>
<li><a href='#md.mvnorm'><p>md.mvnorm</p></a></li>
<li><a href='#md.norm'><p>md.norm</p></a></li>
<li><a href='#md.sample'><p>md.sample</p></a></li>
<li><a href='#md.sex'><p>md.sex</p></a></li>
<li><a href='#md.simdataobject-class'><p>md.simdataobject is an abstract class that is inherited by the</p>
md.simdata covariate generating classes such as md.binom, md.norm etc.</a></li>
<li><a href='#md.simparams'><p>md.simparams</p></a></li>
<li><a href='#md.simulate'><p>md.simulate</p></a></li>
<li><a href='#md.survcox'><p>Fit a proportional hazards regression model over disease recurrence data</p>
with missing information of possible deaths</a></li>
<li><a href='#md.survnp'><p>Nonparametric analysis of disease recurrence with missing information of possible deaths</p></a></li>
<li><a href='#md.survprob'><p>Initializes the missDeaths population table cache</p></a></li>
<li><a href='#md.survtime'><p>Initializes the missDeaths population table cache</p></a></li>
<li><a href='#md.uniform'><p>md.uniform</p></a></li>
<li><a href='#missDeaths'><p>Simulating and analyzing time to event data in the presence of population mortality</p></a></li>
<li><a href='#observed'><p>A simulated dataset with non-recorded deaths</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Date:</td>
<td>2020-10-17</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulating and Analyzing Time to Event Data in the Presence of
Population Mortality</td>
</tr>
<tr>
<td>Version:</td>
<td>2.7</td>
</tr>
<tr>
<td>Author:</td>
<td>Tomaz Stupnik [aut, cre],
  Maja Pohar Perme [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tomaz Stupnik &lt;tomaz.stupnik@guest.arnes.si&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements two methods: a nonparametric risk adjustment and a
    data imputation method that use general population mortality tables to allow a
    correct analysis of time to disease recurrence. Also includes a powerful set of
    object oriented survival data simulation functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.1), mitools</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Depends:</td>
<td>survival, rms, relsurv, cmprsk, MASS, methods</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-17 17:31:50 UTC; tomaz</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-17 18:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+2B+2Cmd.simdata+2Cmd.simdataobject-method'>operator</h2><span id='topic++2B+2Cmd.simdata+2Cmd.simdataobject-method'></span>

<h3>Description</h3>

<p>operator
</p>

<hr>
<h2 id='md.binom'>md.binom</h2><span id='topic+md.binom'></span>

<h3>Description</h3>

<p>Creates information of a Bernoulli distributed covariate with the specified probability.
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.binom(name, prob = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.binom_+3A_name">name</code></td>
<td>
<p>name of the covariate</p>
</td></tr>
<tr><td><code id="md.binom_+3A_prob">prob</code></td>
<td>
<p>probability of success (having a value of 1)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.binom("X", 0.25)

## End(Not run)

</code></pre>

<hr>
<h2 id='md.censor'>Censoring simulated survival data</h2><span id='topic+md.censor'></span>

<h3>Description</h3>

<p>The md.censor function takes the data set simulated by the <code><a href="#topic+md.simulate">md.simulate</a></code> and transforms it into 
a right censored sample by adding two columns to the original data set:<br />
- time specifies the time to event or censoring, whichever comes first, specified in days and <br />
- status specifies the censoring indicator and equals 0 if the individual is censored or &lt;&gt;0 in case of event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.censor(data, start, end, eventcolumns)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.censor_+3A_data">data</code></td>
<td>
<p>data.frame containig event times and covariates</p>
</td></tr>
<tr><td><code id="md.censor_+3A_start">start</code></td>
<td>
<p>column name specifying start dates (left censoring)</p>
</td></tr>
<tr><td><code id="md.censor_+3A_end">end</code></td>
<td>
<p>column name specifying end dates (right censoring)</p>
</td></tr>
<tr><td><code id="md.censor_+3A_eventcolumns">eventcolumns</code></td>
<td>
<p>vector of column names specifying a single event time or multiple event times (in case of competing risks)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame containing original data and columns time, maxtime and status
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
  md.sex("sex", 0.5) + 
    md.uniform("birth", as.Date("1915-1-1"), as.Date("1930-1-1")) +
      md.uniform("start", as.Date("2000-1-1"), as.Date("2005-1-1")) +
        md.death("death", survexp.us, "sex", "birth", "start") +
          md.eval("age", "as.numeric(start - birth)/365.2425", 80, FALSE) + 
            md.exp("event", "start", c("age", "sex"), c(0.1, 2), 0.05/365.2425)
            
data = md.simulate(sim, 1000)
complete = md.censor(data, "start", as.Date("2010-1-1"), c("event", "death"))

## End(Not run)

</code></pre>

<hr>
<h2 id='md.constant'>md.constant</h2><span id='topic+md.constant'></span>

<h3>Description</h3>

<p>Creates information of a covariate that contains a fixed value (either numeric or date).
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.constant(name, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.constant_+3A_name">name</code></td>
<td>
<p>name of the covariate</p>
</td></tr>
<tr><td><code id="md.constant_+3A_value">value</code></td>
<td>
<p>value of the covariate</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.constant("start", as.Date("1990-1-1")) 

## End(Not run)
</code></pre>

<hr>
<h2 id='md.D'>Prepare compatible demographic information</h2><span id='topic+md.D'></span>

<h3>Description</h3>

<p>Utility function that returns a data.frame containing basic demographic
information compatible with the <code><a href="#topic+md.survnp">md.survnp</a></code>,
<code><a href="#topic+md.survcox">md.survcox</a></code> and <code><a href="#topic+md.impute">md.impute</a></code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.D(age, sex, year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.D_+3A_age">age</code></td>
<td>
<p>vector of patient ages specified as number of days or number of years.</p>
</td></tr>
<tr><td><code id="md.D_+3A_sex">sex</code></td>
<td>
<p>vector containing 1 for males and 2 for females</p>
</td></tr>
<tr><td><code id="md.D_+3A_year">year</code></td>
<td>
<p>vector of years of entry into the study can either be supplied 
as vector of start dates or as vector of years specified in number of days from origin (1-1-1970).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+md.survcox">md.survcox</a></code>, <code><a href="#topic+md.survnp">md.survnp</a></code>
</p>

<hr>
<h2 id='md.data'>md.data</h2><span id='topic+md.data'></span>

<h3>Description</h3>

<p>Creates information of covariates that are copies of covariates from an existing data set.
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.data(data, randomsample = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.data_+3A_data">data</code></td>
<td>
<p>data.frame</p>
</td></tr>
<tr><td><code id="md.data_+3A_randomsample">randomsample</code></td>
<td>
<p>controls whether the rows of the dataset are randomly sampled (with replaceent) or simply copied</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.data(data) 

## End(Not run)
</code></pre>

<hr>
<h2 id='md.death'>md.death</h2><span id='topic+md.death'></span>

<h3>Description</h3>

<p>Creates information of a time of death variable distributed according to the specified population mortality table and demographic information.
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.death(name, poptable, sexcol, birthcol, startcol)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.death_+3A_name">name</code></td>
<td>
<p>name of the column</p>
</td></tr>
<tr><td><code id="md.death_+3A_poptable">poptable</code></td>
<td>
<p>population mortality table used to simulate times od death</p>
</td></tr>
<tr><td><code id="md.death_+3A_sexcol">sexcol</code></td>
<td>
<p>name of the column (covariate) specifying birth date</p>
</td></tr>
<tr><td><code id="md.death_+3A_birthcol">birthcol</code></td>
<td>
<p>name of the column (covariate) specifying birth date</p>
</td></tr>
<tr><td><code id="md.death_+3A_startcol">startcol</code></td>
<td>
<p>name of the column (covariate) specifying the start date from which to calculate time of death</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.sex("sex", 0.5) + 
     md.uniform("birth", as.Date("1930-1-1"), as.Date("1970-1-1")) +
       md.uniform("start", as.Date("2005-1-1"), as.Date("2010-1-1")) +
         md.death("death", survexp.us, "sex", "birth", "start") 

## End(Not run)
</code></pre>

<hr>
<h2 id='md.eval'>md.eval</h2><span id='topic+md.eval'></span>

<h3>Description</h3>

<p>Creates information of a covariate that is calculated (from other covariates) by evaluating a specified formula.
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.eval(name, eval, center = Inf, invisible = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.eval_+3A_name">name</code></td>
<td>
<p>name of the covariate</p>
</td></tr>
<tr><td><code id="md.eval_+3A_eval">eval</code></td>
<td>
<p>string specifying the formula to calculate the covariate</p>
</td></tr>
<tr><td><code id="md.eval_+3A_center">center</code></td>
<td>
<p>expected value of the calculated covariate</p>
</td></tr>
<tr><td><code id="md.eval_+3A_invisible">invisible</code></td>
<td>
<p>specifies whether the calculated covariate is included in the simulated dataset</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
    md.uniform("birth", as.Date("1915-1-1"), as.Date("1930-1-1")) +
      md.uniform("start", as.Date("2000-1-1"), as.Date("2005-1-1")) +
          md.eval("age", "as.numeric(start - birth)/365.2425", 80, FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='md.exp'>md.exp</h2><span id='topic+md.exp'></span>

<h3>Description</h3>

<p>Creates information of an event time variable distributed according to the specified exponential distribution.
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.exp(name, startcol, covariates, betas, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.exp_+3A_name">name</code></td>
<td>
<p>name of the column</p>
</td></tr>
<tr><td><code id="md.exp_+3A_startcol">startcol</code></td>
<td>
<p>column name specifying individual study start dates or a start date</p>
</td></tr>
<tr><td><code id="md.exp_+3A_covariates">covariates</code></td>
<td>
<p>names of covariate columns used</p>
</td></tr>
<tr><td><code id="md.exp_+3A_betas">betas</code></td>
<td>
<p>betas for the corresponding covariate columns</p>
</td></tr>
<tr><td><code id="md.exp_+3A_lambda">lambda</code></td>
<td>
<p>baseline lambda</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
  md.uniform("X1", 0.5) + 
    md.norm("X2") +
      md.exp("event", as.Date("1915-1-1"), c("X1", "X2"), c(0.1, 0.2), 0.05/365.2425)

## End(Not run)

</code></pre>

<hr>
<h2 id='md.expprep'>Calculates individual expected survival beyond the observation time</h2><span id='topic+md.expprep'></span>

<h3>Description</h3>

<p>Calculates individual expected survival beyond the observation time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.expprep(D, time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.expprep_+3A_d">D</code></td>
<td>
<p>Demographic information</p>
</td></tr>
<tr><td><code id="md.expprep_+3A_time">time</code></td>
<td>
<p>Observation time</p>
</td></tr>
</table>

<hr>
<h2 id='md.impute'>Correctly impute missing information of possible deaths using population mortality</h2><span id='topic+md.impute'></span>

<h3>Description</h3>

<p>An iterative approach is used in this method to estimate the conditional
distribution required to correctly impute the times of deaths using
population mortality tables.<br /><br />
Note, that simply imputing expected survival times may seem intuitive, 
but does not give unbiased estimates, since the right censored individuals 
are not a random subsample of the patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.impute(data, f, maxtime, D, ratetable, iterations = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.impute_+3A_data">data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the
formula.</p>
</td></tr>
<tr><td><code id="md.impute_+3A_f">f</code></td>
<td>
<p>a formula object, with the response on the left of a ~ operator,
and the terms on the right. The response must be a survival object as
returned by the <code>Surv</code> function.</p>
</td></tr>
<tr><td><code id="md.impute_+3A_maxtime">maxtime</code></td>
<td>
<p>maximum potential observation time (number of days).
</p>
<p>where <code>status</code>=0 equals <code>time</code>.
</p>
<p>where <code>status</code>=1 equals potential time of right censoring if no event
would be observed.</p>
</td></tr>
<tr><td><code id="md.impute_+3A_d">D</code></td>
<td>
<p>demographic information compatible with <code>md.survcox</code>, <code>md.impute</code> 
and <code>md.survnp</code>, see <code><a href="#topic+md.D">md.D</a></code>.</p>
</td></tr>
<tr><td><code id="md.impute_+3A_ratetable">ratetable</code></td>
<td>
<p>a population mortality table, default is <code>slopop</code></p>
</td></tr>
<tr><td><code id="md.impute_+3A_iterations">iterations</code></td>
<td>
<p>the number of iteration steps to be performed, default is
4</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an array of times with imputed times of death that can be used instead of the
unavailable complete data set to get unbiased estimates, ie. in <code><a href="survival.html#topic+coxph">coxph</a></code>.
</p>


<h3>References</h3>

<p>Stupnik T., Pohar Perme M. (2015) &quot;Analysing disease recurrence
with missing at risk information.&quot; Statistics in Medicine 35. p1130-43.
<a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.6766">https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.6766</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+md.survcox">md.survcox</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(missDeaths)
data(slopop)

data(observed)
observed$time = observed$time*365.2425
D = md.D(age=observed$age*365.2425, sex=observed$sex, year=(observed$year - 1970)*365.2425)
newtimes = md.impute(observed, Surv(time, status) ~ age + sex + iq + elevation, 
  observed$maxtime*365.2425, D, slopop, iterations=4)

#Cumulative incidence function
cif = survfit(Surv(observed$time, observed$status)~1)
cif$surv = 1 - cif$surv
cif$upper = 1 - cif$upper
cif$lower = 1 - cif$lower
plot(cif)

#Net survival (NOTE: std error is slightly underestimated!)
surv.net = survfit(Surv(newtimes, observed$status)~1)
summary(surv.net, times=c(3,9)*365.2425)
plot(surv.net)

#Event free survival (NOTE: std error is slightly underestimated!)
surv.efs = survfit(Surv(newtimes, 1 * (observed$status | (newtimes != observed$time)))~1)
summary(surv.efs, times=c(3,9)*365.2425)
plot(surv.efs)

</code></pre>

<hr>
<h2 id='md.init'>Initializes the missDeaths population table cache</h2><span id='topic+md.init'></span>

<h3>Description</h3>

<p>Initializes the missDeaths population table cache
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.init(poptable)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.init_+3A_poptable">poptable</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='md.mvnorm'>md.mvnorm</h2><span id='topic+md.mvnorm'></span>

<h3>Description</h3>

<p>Creates information of a vector of multi-normal covariates with the specified array of means and covariance matrix.
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.mvnorm(names, means = rep(0, length(names)), cov = diag(ncol(names)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.mvnorm_+3A_names">names</code></td>
<td>
<p>vector of covariate names</p>
</td></tr>
<tr><td><code id="md.mvnorm_+3A_means">means</code></td>
<td>
<p>vector of means, default is <code>rep(0, length(names))</code></p>
</td></tr>
<tr><td><code id="md.mvnorm_+3A_cov">cov</code></td>
<td>
<p>covariance matrix, default is <code>diag(ncol(names))</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.mvnorm(c("X1", "X2"), c(100, 0), matrix(c(225, 3, 2, 1), 2, 2))

## End(Not run)
</code></pre>

<hr>
<h2 id='md.norm'>md.norm</h2><span id='topic+md.norm'></span>

<h3>Description</h3>

<p>Creates information of a normally distributed numeric covariate with the specified mean and standard deviation.
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.norm(name, mean = 0, sd = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.norm_+3A_name">name</code></td>
<td>
<p>name of the covariate</p>
</td></tr>
<tr><td><code id="md.norm_+3A_mean">mean</code>, <code id="md.norm_+3A_sd">sd</code></td>
<td>
<p>mean and standard deviation</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.norm("X", 0, 1) 

## End(Not run)

</code></pre>

<hr>
<h2 id='md.sample'>md.sample</h2><span id='topic+md.sample'></span>

<h3>Description</h3>

<p>Creates information of a covariate that represents a random sample (with replacement) of the provided values.
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.sample(name, array, weights=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.sample_+3A_name">name</code></td>
<td>
<p>name of the covariate</p>
</td></tr>
<tr><td><code id="md.sample_+3A_array">array</code></td>
<td>
<p>vector of elements from which to choose from</p>
</td></tr>
<tr><td><code id="md.sample_+3A_weights">weights</code></td>
<td>
<p>vector of probability weights for obtaining the elements of the vector being sampled or NULL if all values have equal probabilities</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.sample("X", c(0, 1, 2), c(0.2, 0.3, 0.5)) 

## End(Not run)
</code></pre>

<hr>
<h2 id='md.sex'>md.sex</h2><span id='topic+md.sex'></span>

<h3>Description</h3>

<p>Creates information of a sex covariate that is a special case of Bernoulli covariate
specifying 1 for male and 2 for female sex. 
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.sex(name, maleperc = 0.5, asfactor = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.sex_+3A_name">name</code></td>
<td>
<p>name of the covariate</p>
</td></tr>
<tr><td><code id="md.sex_+3A_maleperc">maleperc</code></td>
<td>
<p>percentage of males (value = 1) versus females (value = 2)</p>
</td></tr>
<tr><td><code id="md.sex_+3A_asfactor">asfactor</code></td>
<td>
<p>specifies whether the resulting sex covariate is factorized using as.factor or not</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.sex("sex", 0.5)

## End(Not run)

</code></pre>

<hr>
<h2 id='md.simdataobject-class'>md.simdataobject is an abstract class that is inherited by the 
md.simdata covariate generating classes such as md.binom, md.norm etc.</h2><span id='topic+md.simdataobject-class'></span><span id='topic+md.simdataobject-init'></span>

<h3>Description</h3>

<p>md.simdataobject is an abstract class that is inherited by the 
md.simdata covariate generating classes such as md.binom, md.norm etc.
</p>
<p>Constructor of the md.simdataobject
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>name of the covariate</p>
</dd>
<dt><code>center</code></dt><dd><p>expected mean of the covariate used to center values in md.exp</p>
</dd>
<dt><code>virtual</code></dt><dd><p>specifies whether the covariate will be included in the final dataset generated by md.simulate</p>
</dd>
</dl>

<hr>
<h2 id='md.simparams'>md.simparams</h2><span id='topic+md.simparams'></span>

<h3>Description</h3>

<p>Constructs an md.simparams object that holds the parameters required to generate the simulated data set. 
The parameters specifying covariates and event time variables are appended to the md.simparams by 
adding the appropriate function call
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.simparams()
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+md.constant">md.constant</a></code>, <code><a href="#topic+md.uniform">md.uniform</a></code>, <code><a href="#topic+md.binom">md.binom</a></code>, <code><a href="#topic+md.norm">md.norm</a></code>, <code><a href="#topic+md.mvnorm">md.mvnorm</a></code>, <code><a href="#topic+md.sex">md.sex</a></code>, <code><a href="#topic+md.exp">md.exp</a></code>, <code><a href="#topic+md.death">md.death</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.sex("sex", 0.5) + 
   md.uniform("birth", as.Date("1930-1-1"), as.Date("1970-1-1")) +
   md.uniform("start", as.Date("2005-1-1"), as.Date("2010-1-1")) +
   md.death("death", survexp.us, "sex", "birth", "start") 

## End(Not run)

</code></pre>

<hr>
<h2 id='md.simulate'>md.simulate</h2><span id='topic+md.simulate'></span>

<h3>Description</h3>

<p>Creates a simulated dataset using the provided simulation parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.simulate(sim, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.simulate_+3A_sim">sim</code></td>
<td>
<p>a <code><a href="#topic+md.simparams">md.simparams</a></code> object containg simulation parameters</p>
</td></tr>
<tr><td><code id="md.simulate_+3A_n">N</code></td>
<td>
<p>number of observations</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)
ratetable = survexp.us

sim = md.simparams() +
          md.sex("sex", 1) + 
          md.uniform("Z1") +
          md.mvnorm(c("Z2", "Z3"), c(100, 0), matrix(c(225, 3, 2, 1), 2, 2)) +
          md.sample("Z4", c(1, 2, 3, 4), c(0.25, 0.25, 0.25, 0.25)) +
          md.uniform("birth", as.Date("1930-1-1"), as.Date("1970-1-1")) +
          md.constant("start", as.Date("1990-1-1")) +
          md.death("death", ratetable, "sex", "birth", "start") +
          md.eval("age", "as.numeric(start - birth)/365.2425", 80, FALSE) + 
          md.exp("event", "start", c("age", "sex", "Z1", "Z2"), 
             c(0.1, 2, 1, 0.01), 0.0001)
          
data = md.simulate(sim, 1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='md.survcox'>Fit a proportional hazards regression model over disease recurrence data 
with missing information of possible deaths</h2><span id='topic+md.survcox'></span>

<h3>Description</h3>

<p>An iterative approach is used in this method to estimate the conditional
distribution required to correctly impute the times of deaths using
population mortality tables.<br /><br />
Note, that simply imputing expected survival times may seem intuitive, 
but does not give unbiased estimates, since the right censored individuals 
are not a random subsample of the patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.survcox(data, f, maxtime, D, ratetable, iterations = 4, R = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.survcox_+3A_data">data</code></td>
<td>
<p>a data.frame in which to interpret the variables named in the
formula.</p>
</td></tr>
<tr><td><code id="md.survcox_+3A_f">f</code></td>
<td>
<p>a formula object, with the response on the left of a ~ operator,
and the terms on the right. The response must be a survival object as
returned by the <code>Surv</code> function.</p>
</td></tr>
<tr><td><code id="md.survcox_+3A_maxtime">maxtime</code></td>
<td>
<p>maximum potential observation time (number of days).
</p>
<p>where <code>status</code>=0 equals <code>time</code>.
</p>
<p>where <code>status</code>=1 equals potential time of right censoring if no event
would be observed.</p>
</td></tr>
<tr><td><code id="md.survcox_+3A_d">D</code></td>
<td>
<p>demographic information compatible with <code>ratetable</code>, see
<code><a href="#topic+md.D">md.D</a></code>.</p>
</td></tr>
<tr><td><code id="md.survcox_+3A_ratetable">ratetable</code></td>
<td>
<p>a population mortality table, default is <code>slopop</code></p>
</td></tr>
<tr><td><code id="md.survcox_+3A_iterations">iterations</code></td>
<td>
<p>the number of iteration steps to be performed, default is
4</p>
</td></tr>
<tr><td><code id="md.survcox_+3A_r">R</code></td>
<td>
<p>the number of multiple imputations performed to adjust the
estimated variance of estimates, default is 50.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>if <code>R</code> equals 1 then an object of class
<code><a href="survival.html#topic+coxph.object">coxph.object</a></code> representing the fit.
</p>
<p>if <code>R</code> &gt; 1 then the result of the <code><a href="mitools.html#topic+MIcombine">MIcombine</a></code> of
the <code>coxph</code> objects.
</p>


<h3>References</h3>

<p>Stupnik T., Pohar Perme M. (2015) &quot;Analysing disease recurrence
with missing at risk information.&quot; Statistics in Medicine 35. p1130-43.
<a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.6766">https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.6766</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+md.impute">md.impute</a></code>, <code><a href="mitools.html#topic+MIcombine">MIcombine</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)
data(slopop)

data(observed)
observed$time = observed$time*365.2425
D = md.D(age=observed$age*365.2425, sex=observed$sex, year=(observed$year - 1970)*365.2425)

#fit a cox model (NOTE: estimated std error is slightly underestimated!)
md.survcox(observed, Surv(time, status) ~ age + sex + iq + elevation, 
  observed$maxtime*365.2425, D, slopop, iterations=4, R=1)

#multiple imputations to correct the stimated std error
md.survcox(observed, Surv(time, status) ~ age + sex + iq + elevation, 
  observed$maxtime*365.2425, D, slopop, iterations=4, R=50)

## End(Not run)

</code></pre>

<hr>
<h2 id='md.survnp'>Nonparametric analysis of disease recurrence with missing information of possible deaths</h2><span id='topic+md.survnp'></span>

<h3>Description</h3>

<p>Estimates the Net and Event free survial using a is non-parametric approach
that aims to correct all individuals using the unconditional survival time
distribution obtained from the population mortality table.<br /><br />
The idea comes from realizing that the number of observed events in the data
equals the number which would be observed in case of a complete data set,
but the number of patients at risk does not. Hence, this method adjusts the
observed number at risk to mimic the one we would get if the data was
complete.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.survnp(time, status, maxtime, D, ratetable, conf.int = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.survnp_+3A_time">time</code></td>
<td>
<p>the time to event (number of days)</p>
</td></tr>
<tr><td><code id="md.survnp_+3A_status">status</code></td>
<td>
<p>the status indicator, 0=right censored, 1=event at <code>time</code></p>
</td></tr>
<tr><td><code id="md.survnp_+3A_maxtime">maxtime</code></td>
<td>
<p>maximum potential observation time (number of days).
</p>
<p>where <code>status</code>=0 equals <code>time</code>.
</p>
<p>where <code>status</code>=1 equals potential time of right censoring if no event
would be observed.</p>
</td></tr>
<tr><td><code id="md.survnp_+3A_d">D</code></td>
<td>
<p>demographic information compatible with <code>ratetable</code>, see
<code><a href="#topic+md.D">md.D</a></code>.</p>
</td></tr>
<tr><td><code id="md.survnp_+3A_ratetable">ratetable</code></td>
<td>
<p>a population mortality table, default is <code>slopop</code></p>
</td></tr>
<tr><td><code id="md.survnp_+3A_conf.int">conf.int</code></td>
<td>
<p>desired coverage of the estimated confidence interval</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components giving the estimates of net and event free
survival.
</p>
<table>
<tr><td><code>time</code></td>
<td>
<p>times where the estimates are calculated (number of days)</p>
</td></tr>
<tr><td><code>Y.net</code></td>
<td>
<p>adjusted number of patients at risk at each time in a hypothetical world where patients don't die</p>
</td></tr>
<tr><td><code>Y.efs</code></td>
<td>
<p>adjusted number of patients at risk at each time</p>
</td></tr>
<tr><td><code>surv.net</code></td>
<td>
<p>the estimated Net survival</p>
</td></tr> <tr><td><code>std.err.net</code></td>
<td>
<p>the estimated
standard error of Net survival estimates</p>
</td></tr> <tr><td><code>surv.efs</code></td>
<td>
<p>the estimated
Event free survival</p>
</td></tr> <tr><td><code>std.err.efs</code></td>
<td>
<p>the estimated standard error of
Event free survival estimates</p>
</td></tr>
</table>


<h3>References</h3>

<p>Stupnik T., Pohar Perme M. (2015) &quot;Analysing disease recurrence
with missing at risk information.&quot; Statistics in Medicine 35. p1130-43.
<a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.6766">https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.6766</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)
library(cmprsk)
data(slopop)

data(observed)
D = md.D(age=observed$age*365.2425, sex=observed$sex, year=(observed$year - 1970)*365.2425)
np = md.survnp(observed$time*365.2425, observed$status, observed$maxtime*365.2425, D, slopop)

#calculate net survival at 3 and 9 years
w = list(list(time=np$time, est=np$surv.net, var=(np$std.err.net)^2))
timepoints(w, times=c(3,9)*365.2425)

#plot the net and event free survival curves
plot(np$time, np$surv.net)
plot(np$time, np$surv.efs)

## End(Not run)

</code></pre>

<hr>
<h2 id='md.survprob'>Initializes the missDeaths population table cache</h2><span id='topic+md.survprob'></span>

<h3>Description</h3>

<p>Initializes the missDeaths population table cache
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.survprob(year, age, time, sex)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.survprob_+3A_year">year</code></td>
<td>
<p>year</p>
</td></tr>
<tr><td><code id="md.survprob_+3A_age">age</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="md.survprob_+3A_time">time</code></td>
<td>
<p>time</p>
</td></tr>
<tr><td><code id="md.survprob_+3A_sex">sex</code></td>
<td>
<p>sex</p>
</td></tr>
</table>

<hr>
<h2 id='md.survtime'>Initializes the missDeaths population table cache</h2><span id='topic+md.survtime'></span>

<h3>Description</h3>

<p>Initializes the missDeaths population table cache
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.survtime(year, age, prob, sex)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.survtime_+3A_year">year</code></td>
<td>
<p>year</p>
</td></tr>
<tr><td><code id="md.survtime_+3A_age">age</code></td>
<td>
<p>age</p>
</td></tr>
<tr><td><code id="md.survtime_+3A_prob">prob</code></td>
<td>
<p>prob</p>
</td></tr>
<tr><td><code id="md.survtime_+3A_sex">sex</code></td>
<td>
<p>sex</p>
</td></tr>
</table>

<hr>
<h2 id='md.uniform'>md.uniform</h2><span id='topic+md.uniform'></span>

<h3>Description</h3>

<p>Creates information of a uniformly distributed numeric or date covariate with the specified lower and upper limits.
This function call must be added to the <code><a href="#topic+md.simparams">md.simparams</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>md.uniform(name, min = 0, max = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="md.uniform_+3A_name">name</code></td>
<td>
<p>name of the covariate</p>
</td></tr>
<tr><td><code id="md.uniform_+3A_min">min</code>, <code id="md.uniform_+3A_max">max</code></td>
<td>
<p>lower and upper limits of the distribution. Must be finite (either numeric or date)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(missDeaths)

sim = md.simparams() +
   md.uniform("X", 0, 1)

## End(Not run)

</code></pre>

<hr>
<h2 id='missDeaths'>Simulating and analyzing time to event data in the presence of population mortality</h2><span id='topic+missDeaths'></span><span id='topic+missDeaths-package'></span>

<h3>Description</h3>

<p>In analysis of time to event data we may have a situation where we know that a 
certain non-negligible competing risk exists, but is not recorded in the data. 
Due to competing nature of the risks, ignoring such a risk may significantly 
impact the at-risk group and thus lead to biased estimates. <br /><br />
This problem can be found in several national registries of benign diseases, 
medical device implantations (e.g. hip, knee or heart pacemaker) etc. where law obliges 
physicians to report events whereas the information on patient deaths is unavailable; 
it is hence unclear how many devices are still in use at a given time.<br /><br />
Under the assumption that the survival of an individual is not influenced by the 
event under study, general population mortality tables can be used to obtain unbiased 
estimates of the measures of interest or to verify the assumption that the bias
introduced by the non-recorded deaths is truly negligible.<br /><br />
Two approaches are implemented in the missdeaths package: <br />
- an iterative imputation method <code><a href="#topic+md.survcox">md.survcox</a></code> and<br /> 
- a mortality adjusted at risk function <code><a href="#topic+md.survnp">md.survnp</a></code>.<br /><br />
The package also includes a comprehensive set of functions to simulate data 
that can be used for better understanding of these methods (See <code><a href="#topic+md.simulate">md.simulate</a></code>).
</p>


<h3>Author(s)</h3>

<p>Tomaz Stupnik &lt;tomaz.stupnik@gmail.com&gt; and Maja Pohar Perme
</p>


<h3>References</h3>

<p>Stupnik T., Pohar Perme M. (2015) &quot;Analysing disease recurrence
with missing at risk information.&quot; Statistics in Medicine 35. p1130-43.
<a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.6766">https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.6766</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(missDeaths)
ratetable = survexp.us

sim = md.simparams() +
          md.sex("sex", 0.5) + 
          md.binom("Z1", 0.5) +
          md.mvnorm(c("Z2", "Z3"), c(100, 0), matrix(c(225, 3, 2, 1), 2, 2)) +
          md.sample("Z4", c(1, 2, 3, 4), c(0.25, 0.25, 0.25, 0.25)) +
          md.uniform("birth", as.Date("1925-1-1"), as.Date("1950-1-1")) +
          md.uniform("start", as.Date("2000-1-1"), as.Date("2005-1-1")) +
          md.death("death", ratetable, "sex", "birth", "start") +
          md.eval("age", "as.numeric(start - birth)/365.2425", 80, FALSE) + 
          md.exp("event", "start", c("age", "sex", "Z1", "Z2"), 
             c(0.1, 2, 1, 0.01), 0.05/365.2425)
data = md.simulate(sim, 1000)
          
#construct a complete right censored data set
complete = md.censor(data, "start", as.Date("2010-1-1"), c("event", "death"))

#construct an observed right censored data set with non-reported deaths
observed = complete
observed$time[which(complete$status == 2)] = observed$maxtime[which(complete$status == 2)]
observed$status[which(complete$status == 2)] = 0

#estimate coefficients of the proportional hazards model
D = md.D(age=observed$age, sex=observed$sex, year=observed$start)
md.survcox(observed, Surv(time, status) ~ age + sex + Z1 + Z2, 
          observed$maxtime, D, ratetable, iterations=4, R=50)
          
#estimate net- and event-free survival
np = md.survnp(observed$time, observed$status, observed$maxtime, D, ratetable)
w = list(list(time=np$time, est=np$surv.net, var=(np$std.err.net)^2))
timepoints(w, times=c(3,9)*365.2425)
plot(np$time/365.2425, np$surv.net)
plot(np$time/365.2425, np$surv.efs)

## End(Not run)
</code></pre>

<hr>
<h2 id='observed'>A simulated dataset with non-recorded deaths</h2><span id='topic+observed'></span>

<h3>Description</h3>

<p>This data set is used to illustrate the missDeaths functions.
</p>


<h3>Format</h3>

<p>A <code>data.frame</code> containing 10000 observations.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
