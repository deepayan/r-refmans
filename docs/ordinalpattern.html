<!DOCTYPE html><html><head><title>Help for package ordinalpattern</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ordinalpattern}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#patternchange'>
<p>Changepoint Detection Using Ordinal Patterns</p></a></li>
<li><a href='#patterndependence'>
<p>Ordinal Pattern Dependence</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tests Based on Ordinal Patterns</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-6-6</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexander Duerre [aut, cre],
  Alexander Schnurr [aut],
  Angelika Silbernagel [aut]</td>
</tr>
<tr>
<td>Depends:</td>
<td>gtools,mvtnorm</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Duerre &lt;alexander.duerre@udo.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Ordinal patterns describe the dynamics of a time series by looking at the ranks of subsequent observations. By comparing ordinal patterns of two times series, Schnurr (2014) &lt;<a href="https://doi.org/10.1007%2Fs00362-013-0536-8">doi:10.1007/s00362-013-0536-8</a>&gt; defines a robust and non-parametric dependence measure: the ordinal pattern coefficient. Functions to calculate this and a method to detect a change in the pattern coefficient proposed in Schnurr and Dehling (2017) &lt;<a href="https://doi.org/10.1080%2F01621459.2016.1164706">doi:10.1080/01621459.2016.1164706</a>&gt; are provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-06 12:43:43 UTC; alexander</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-06 13:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='patternchange'>
Changepoint Detection Using Ordinal Patterns
</h2><span id='topic+patternchange'></span><span id='topic+plot.change'></span>

<h3>Description</h3>

<p>Test for a change in the dependence structure of two time series using ordinal patterns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patternchange(tsx,tsy,h=2,conf.level,weight=TRUE,weightfun=NULL,bn=log(length(tsx)),
    kernel=function(x){return(max(0,1-abs(x)))})

## S3 method for class 'change'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="patternchange_+3A_tsx">tsx</code></td>
<td>
<p>numeric vector of first univariate time series.</p>
</td></tr>
<tr><td><code id="patternchange_+3A_tsy">tsy</code></td>
<td>
<p>numeric vector of second univariate time series.</p>
</td></tr>
<tr><td><code id="patternchange_+3A_h">h</code></td>
<td>
<p>numeric value determining the length of ordinal pattern.</p>
</td></tr>
<tr><td><code id="patternchange_+3A_conf.level">conf.level</code></td>
<td>
<p>numerical value indicating the confidence level of the test.</p>
</td></tr>
<tr><td><code id="patternchange_+3A_weight">weight</code></td>
<td>
<p>logical value indicating whether one uses weights of the L1 norm or the empirical probability of identical patterns; see details.</p>
</td></tr>
<tr><td><code id="patternchange_+3A_weightfun">weightfun</code></td>
<td>
<p>function which defines the weights given the L1 norm between the patterns if <code>weight=TRUE</code>. If no weight-function is given, the canonical weight function is used; see details.</p>
</td></tr>
<tr><td><code id="patternchange_+3A_bn">bn</code></td>
<td>
<p>numerical value determining the bandwidth of the kernel estimator used to estimate the long run variance.</p>
</td></tr>
<tr><td><code id="patternchange_+3A_kernel">kernel</code></td>
<td>
<p>kernel function for estimating the long run variance.</p>
</td></tr>
<tr><td><code id="patternchange_+3A_x">x</code></td>
<td>
<p>object of class <code>"change"</code></p>
</td></tr>
<tr><td><code id="patternchange_+3A_...">...</code></td>
<td>
<p>further arguments passed to the internal plotting function (<code>plot</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given two timeseries <code>tsx</code> and <code>tsy</code> a cusum type statistic tests whether there is a change in the patter dependence or not. The test is based on a comparison of patterns of length <code>h+1</code> in <code>tsx</code> and <code>tsy</code>. One can either choose the number of identical patterns (<code>weight=FALSE</code>) or a metric that is defined by the <code>weightfun</code> argument to measure the difference between patterns (<code>weight=TRUE</code>). If no (<code>weightfun</code>) is given, the canonical weightfunction is used, which equals 1 if patterns are identical and 0 if the L1 norm of their difference attains the maximal possible value. The value is linear interpolated in between.
</p>
<p>The procedure depends on an estimate of the long run variance. Here a kernel estimator is used. A kernel function and a bandwidth can be set using the arguments <code>kernel</code> and <code>bn</code>. If none of them is given, the bartlett kernel with a bandwidth of <code>log(n)</code>, where <code>n</code> equals the length of the timeseries, is used.  
</p>


<h3>Value</h3>

<p>Object with classes <code>"change"</code> and <code>"htest"</code> containing the following values:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic. Under the null the test statistic follows asymptotically a Kolmogorov Smirnov distribution.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated time of change.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the jump height of the at most one change point model, which is under the null hypothesis always 0.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a characters string describing the test.</p>
</td></tr>
<tr><td><code>trajectory</code></td>
<td>
<p>the cumulative sum on which the tests are based on. Could be used for additional plots.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Dürre
</p>


<h3>References</h3>

<p>Schnurr, A. (2014): An ordinal pattern approach to detect and to model leverage effects and dependence structures between financial time series, <em>Statistical Papers</em>, vol. 55, 919&ndash;931.
</p>
<p>Schnurr, A., Dehling, H. (2017): Testing for Structural Breaks via Ordinal Pattern Dependence, <em>Journal of the American Statistical Association</em>, vol. 112, 706&ndash;720.
</p>


<h3>See Also</h3>

<p>Estimation of the pattern dependence is provided by <code><a href="#topic+patterndependence">patterndependence</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1066)
a1 &lt;- cbind(rnorm(100),rnorm(100))
a2 &lt;- rmvnorm(100,sigma=matrix(c(1,0.8,0.8,1),ncol=2))
A &lt;- rbind(a1,a2)
testresult &lt;- patternchange(A[,1],A[,2])
plot(testresult)
testresult
</code></pre>

<hr>
<h2 id='patterndependence'>
Ordinal Pattern Dependence
</h2><span id='topic+patterndependence'></span><span id='topic+plot.pattern'></span><span id='topic+print.pattern'></span>

<h3>Description</h3>

<p>Calculates the standard ordinal pattern coefficient and related values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>patterndependence(tsx,tsy,h=2,block=FALSE,first=TRUE)

## S3 method for class 'pattern'
plot(x, ...)
## S3 method for class 'pattern'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="patterndependence_+3A_tsx">tsx</code></td>
<td>
<p>numeric vector representing the first univariate time series.</p>
</td></tr>
<tr><td><code id="patterndependence_+3A_tsy">tsy</code></td>
<td>
<p>numeric vector representing the second univariate time series.</p>
</td></tr>
<tr><td><code id="patterndependence_+3A_h">h</code></td>
<td>
<p>numeric value determining the length of the ordinal pattern.</p>
</td></tr>
<tr><td><code id="patterndependence_+3A_block">block</code></td>
<td>
<p>logical value determining whether patterns are calculated on disjoint blocks or overlapping blocks.</p>
</td></tr>
<tr><td><code id="patterndependence_+3A_first">first</code></td>
<td>
<p>logical value indicating which observartions are dropped if <code>block == TRUE</code> and the time series length is no multiple of <code>h+1</code>.</p>
</td></tr>
<tr><td><code id="patterndependence_+3A_x">x</code></td>
<td>
<p>object of class <code>"pattern"</code>, which is the output of <code>patterndependence</code></p>
</td></tr>
<tr><td><code id="patterndependence_+3A_...">...</code></td>
<td>
<p>further arguments passed to the internal plotting function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The standard ordinal pattern coefficient is a non-parametric and robust measure of dependence between two time series. It is based on ordinal patterns, which are defined as sequences of ranks of <code>h+1</code> subsequent observations. This sequences of subseqent observations can either move one observation per time or a whole block of <code>h+1</code> observations. The former is preferred since it uses more information. If one chooses the later, one has to decide whether the first or the last observations are removed in case that the time series length is no multiple of <code>h+1</code>.
</p>
<p>Beside the standard ordinal pattern coefficient, which range from -1 to 1, one can also look at the positive and negative ordinal pattern coefficient, which roughly measures wheather there are unsual many identical or opposite patterns in the time series.  
</p>
<p>The plot function draws both time series and shows the six most frequent coinciding pattern with counts on the right. At the bottom, the location of these coinciding patterns is visualized.
</p>


<h3>Value</h3>

<p>Object of class <code>"pattern"</code> containing the following values:
</p>
<table>
<tr><td><code>patterncoef</code></td>
<td>
<p>standard ordinal pattern coefficient.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>positive ordinal pattern coefficient, see details.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>negative ordinal pattern coefficient, see details.</p>
</td></tr>
<tr><td><code>numbequal</code></td>
<td>
<p>number of equal ordinal patterns.</p>
</td></tr>
<tr><td><code>numbopposite</code></td>
<td>
<p>number of opposite ordinal patterns.</p>
</td></tr>
<tr><td><code>PatternXz</code></td>
<td>
<p>number of ordinal patterns in first time series.</p>
</td></tr>
<tr><td><code>PatternYz</code></td>
<td>
<p>number or ordinal patterns in second time series.</p>
</td></tr>
<tr><td><code>coding</code></td>
<td>
<p>coding of the ordinal patterns, used in <code>PatternXz</code> and <code>PatternYz</code>.</p>
</td></tr>
<tr><td><code>PatternX</code></td>
<td>
<p>numeric vector representing the time series of patterns in <code>tsx</code>.</p>
</td></tr>
<tr><td><code>PatternY</code></td>
<td>
<p>numeric vector representing the time series of patterns in <code>tsy</code>.</p>
</td></tr>
<tr><td><code>tsx</code></td>
<td>
<p>numeric vector representing the first univariate time series.</p>
</td></tr>
<tr><td><code>tsy</code></td>
<td>
<p>numeric vector representing the second univariate time series.</p>
</td></tr>
<tr><td><code>maxpat</code></td>
<td>
<p>number representing the maximal pattern code.</p>
</td></tr>
<tr><td><code>block</code></td>
<td>
<p>logical value determining whether patterns are calculated on disjoint blocks or overlapping blocks.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>number of consecutive observations defining one pattern</p>
</td></tr>
<tr><td><code>tablesame</code></td>
<td>
<p>numeric vector representing the number of coinciding patterns, apportioned into different patterns.</p>
</td></tr>
<tr><td><code>tablesame</code></td>
<td>
<p>numeric vector representing the number of reflected patterns, apportioned into different patterns.</p>
</td></tr>
<tr><td><code>indexsame</code></td>
<td>
<p>logic vector indicating whether patterns in both time series coincide.</p>
</td></tr>
<tr><td><code>indexsame</code></td>
<td>
<p>logic vector indicating whether patterns in both time series are reflected.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alexander Dürre
</p>


<h3>References</h3>

<p>Schnurr, A. (2014): An ordinal pattern approach to detect and to model leverage effects and dependence structures between financial time series, <em>Statistical Papers</em>, vol. 55, 919&ndash;931.
</p>
<p>Schnurr, A., Dehling, H. (2017): Testing for Structural Breaks via Ordinal Pattern Dependence, <em>Journal of the American Statistical Association</em>, vol. 112, 706&ndash;720.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1066)
patternobj &lt;- patterndependence(rnorm(100),rnorm(100))
plot(patternobj)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
