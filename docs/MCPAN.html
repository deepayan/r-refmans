<!DOCTYPE html><html><head><title>Help for package MCPAN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MCPAN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MCPAN-package'>
<p>Multiple comparison procedures based on normal approximation and extensions.</p></a></li>
<li><a href='#binomest'><p> Only for internal use.</p></a></li>
<li><a href='#binomORci'><p> Simultaneous confidence intervals for odds ratios</p></a></li>
<li><a href='#binomRDci'><p> Simultaneous confidence intervals for contrasts of independent binomial proportions (in a oneway layout)</p></a></li>
<li><a href='#binomRDtest'><p> Simultaneous test for contrasts of independent binomial proportions (in a oneway layout)</p></a></li>
<li><a href='#binomRRci'><p> Simultaneous confidence intervals for ratios of independent binomial proportions</p></a></li>
<li><a href='#bronch'><p>Rodent bronchial carcinoma data</p></a></li>
<li><a href='#censsample'><p> Random data for Poly-k</p></a></li>
<li><a href='#censsamplef'><p> Random data for Poly-k</p></a></li>
<li><a href='#corrMatgen'><p> A function to calculate the correlation matrix</p></a></li>
<li><a href='#estShannon'><p> Estimate the Shannon Index</p></a></li>
<li><a href='#estShannonf'><p> Estimate the Shannon-Wiener index</p></a></li>
<li><a href='#estSimpson'><p> Simpson index</p></a></li>
<li><a href='#estSimpsonf'><p> Estimate the Simpson index from several samples</p></a></li>
<li><a href='#HCD'><p> Hell Creek Dinosaur Data</p></a></li>
<li><a href='#liarozole'><p> Marked improvement of psoriasis after application of liarozole</p></a></li>
<li><a href='#lndest'>
<p>Point and varioance estimates for expected and log(expected values) of lognormal samples</p></a></li>
<li><a href='#lnrci'>
<p>Simultaneous confidence intervals for expected values assuming lognormal distribution.</p></a></li>
<li><a href='#methyl'><p> NTP bioassay data: effect of methyleugenol on skin fibroma</p></a></li>
<li><a href='#mosaicdiv'><p> Mosaicplot for the data in Shannonci and Simpsonci</p></a></li>
<li><a href='#multinomORci'>
<p>Simultaneous confidence intervals for odds ratios comparing multiple odds and multiple treatments in a contingency table</p></a></li>
<li><a href='#plot.sci'><p> Plot confidence intervals</p></a></li>
<li><a href='#plotCI'><p> Plot confidence intervals</p></a></li>
<li><a href='#plotCII'><p> Plot confidence intervals</p></a></li>
<li><a href='#poly3ci'><p> Simultaneous confidence intervals for contrasts of poly-3-adjusted tumour rates</p></a></li>
<li><a href='#poly3est'><p> Only for internal use.</p></a></li>
<li><a href='#poly3estf'><p> Only for internal use.</p></a></li>
<li><a href='#poly3table'><p> Summarize long term carcinogenicity data</p></a></li>
<li><a href='#poly3test'><p> Approximate simultaneous test for poly-3-adjusted tumour rates</p></a></li>
<li><a href='#powerbinom'>
<p>Approximate power for multiple contrast tests of binomial proportions.</p></a></li>
<li><a href='#powermcpn'>
<p>Approximative power calculation for multiple contrast tests</p></a></li>
<li><a href='#powermcpt'>
<p>Testversion. Power calculation for multiple contrast tests (1-way ANOVA model)</p></a></li>
<li><a href='#PQln'>
<p>Generalized pivotal quantity for log expected values of several lognormal samples.</p></a></li>
<li><a href='#print.multinomORci'>
<p>Print out put of multinomORci</p></a></li>
<li><a href='#printfunctions'><p>Print methods for the classes in this package</p></a></li>
<li><a href='#scalechoice'><p> Only for internal use.</p></a></li>
<li><a href='#SCSrank'><p>Compute a rectangular simultaneous confidence set from a sample of a joint empirical distribution.</p></a></li>
<li><a href='#Shannon'><p> Shannon index</p></a></li>
<li><a href='#Shannonci'><p> Confidence intervals for multiple contrasts of Shannon indices</p></a></li>
<li><a href='#Simpson'><p> Calculate the Simpson index</p></a></li>
<li><a href='#Simpsonci'><p> Confidence intervals for differences of Simpson indices</p></a></li>
<li><a href='#summary.binomORci'><p> Detailed print out for binomORci</p></a></li>
<li><a href='#summary.binomRDci'><p> Detailed print out for binomRDci</p></a></li>
<li><a href='#summary.binomRDtest'><p> Detailed print out for binomRDtest</p></a></li>
<li><a href='#summary.binomRRci'><p> Detailed print out for binomRRci</p></a></li>
<li><a href='#summary.poly3est'><p> Detailed print out for poly3est</p></a></li>
<li><a href='#summary.Shannonci'><p> Summary for Shannonci</p></a></li>
<li><a href='#summary.Simpsonci'><p> Summary function for Simpsonci</p></a></li>
<li><a href='#Waldci'><p> Simultaneous Wald confidence intervals</p></a></li>
<li><a href='#Waldtest'><p> Simultaneous Wald tests</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiple Comparisons Using Normal Approximation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-21</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Frank Schaarschmidt [aut, cre],
  Daniel Gerhard [aut],
  Martin Sill [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frank Schaarschmidt &lt;schaarschmidt@biostat.uni-hannover.de&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, multcomp, graphics, stats, magic, MCMCpack, plyr</td>
</tr>
<tr>
<td>Description:</td>
<td>Multiple contrast tests and simultaneous confidence
 intervals based on normal approximation. With implementations for
 binomial proportions in a 2xk setting (risk difference and odds ratio),
 poly-3-adjusted tumour rates, biodiversity indices (multinomial data) 
 and expected values under lognormal assumption. Approximative power 
 calculation for multiple contrast tests of binomial and Gaussian data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-22 07:19:33 UTC; Schaarschmidt</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-22 12:22:58 UTC</td>
</tr>
</table>
<hr>
<h2 id='MCPAN-package'>
Multiple comparison procedures based on normal approximation and extensions.
</h2><span id='topic+MCPAN-package'></span><span id='topic+MCPAN'></span>

<h3>Description</h3>

<p>Multiple contrast tests and simultaneous confidence intervals using normal approximation, if individuals are randomly assigned to treatments in a oneway layout. For some cases improvements compared to crude normal approximation are implemented.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MCPAN</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1-21</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-03-22</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>For dichotomous variables, approximate confidence intervals for the risk difference (Schaarschmidt et al. 2008) and odds ratio (Holford et al. 1989) are available. The implementation of multiple contrast methods for the risk ratio and the odds ratio may be seen as a generalization of methods in Holford et al. (1989), and the crude normal approximation as described in Gart and Nam (1988) as special cases of the framework described in Hothorn et al. (2008).
If the variable of interest is the rate of tumours in long-term rodent carcinogenicity trials (without cause of death information), 
confidence intervals for poly-k-adjusted tumour rates (Bailer and Portier, 1988) are available, as described in Schaarschmidt et al. (2008).
For abundance data of multiple species, asymptotic simultaneous confidence intervals for differences of Simpson and Shannon-indices are implemented, assuming multinomial count data (Rogers and Hsu, 2001, Fritsch and Hsu, 1999, Scherer et al., 2013).
For expected values of lognormal samples, asymptotic Wald-type intervals and a sampling based improvement are available (Schaarschmidt, 2013).
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt, Daniel Gerhard, Martin Sill
Maintainer: Frank Schaarschmidt &lt;schaarschmidt@biostat.uni-hannover.de&gt;
</p>


<h3>References</h3>

<p><em>Schaarschmidt, F., Sill, M., and Hothorn, L.A. (2008):</em> Approximate Simultaneous Confidence Intervals for Multiple Contrasts of Binomial Proportions. Biometrical Journal 50, 782-792.
</p>
<p><em>Schaarschmidt, F., Sill, M., and Hothorn, L.A. (2008):</em> Poly-k-trend tests for survival adjusted analysis of tumor rates formulated as approximate multiple contrast test. Journal of Biopharmaceutical Statistics 18, 934-948.
</p>
<p><em>Holford, T.R., Walter, S.D. and Dunnett, C.W. (1989):</em> Simultaneous interval estimates of the odds ratio in studies with two or more comparisons. Journal of Clinical Epidemiology 42, 427-434.
</p>
<p><em>Gart, J.J. and Nam, J. (1988)</em>: Approximate interval estimation of the ratio of binomial parameters: A review and corrections for skewness. Biometrics 44, 323-338.
</p>
<p><em>Schaarschmidt, F. (2013).</em> Simultaneous confidence intervals for multiple comparisons among expected values of log-normal variables. Computational Statistics and Data Analysis 58, 265-275.
</p>
<p><em>Hothorn, T., Bretz. F, and Westfall, P. (2008):</em> Simultaneous inference in general parametric models. Biometrical Journal 50(3), 346-363. 
</p>
<p><em>Bailer, J.A. and Portier, C.J. (1988):</em> Effects of treatment-induced mortality and tumor-induced mortality on tests for carcinogenicity in small samples. Biometrics 44, 417-431.
</p>
<p><em>Bretz, F., Hothorn, L. (2002):</em> Detecting dose-response using contrasts: asymptotic power and sample size determination for binomial data. Statistics in Medicine 21: 3325-3335.
</p>
<p><em>Rogers, J.A. and Hsu, J.C. (2001):</em> Multiple Comparisons of Biodiversity. Biometrical Journal 43, 617-625.
</p>
<p><em>Fritsch, K.S., and Hsu, J.C. (1999):</em> Multiple Comparison of Entropies with Application to Dinosaur Biodiversity. Biometrics 55, 1300-1305.
</p>
<p><em>Scherer, R., Schaarschmidt, F., Prescher, S., and Priesnitz, K.U. (2013):</em> Simultaneous confidence intervals for comparing biodiversity indices estimated from overdispersed count data. Biometrical Journal 55, 246-263.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# # # 1)
# Simultaneous confidence intervals 
# for 2xk tables of binomial data: 
# binomRDtest, binomRDci

# Difference of proportions

binomRDci(x=c(2,6,4,13), n=c(34,33,36,34),
 names=c("Placebo", "50", "75", "150"),
 type="Dunnett", method="ADD1")

# Odds ratios:

binomORci(x=c(2,6,4,13), n=c(34,33,36,34),
 names=c("Placebo", "50", "75", "150"),
 type="Dunnett")


# # # 
# Simultaneous confidence intervals for comparing a treatment
# (trt) to 3 controls (Var1-Var3) in terms of differences of
# Simpson indices for a community comprising 33 species.

PSM &lt;-
as.data.frame(structure(c(0, 0, 2, 0, 0, 2, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 
2, 1, 1, 1, 0, 1, 2, 50, 25, 29, 42, 1, 1, 0, 3, 14, 6, 6, 24, 
64, 56, 121, 98, 1, 1, 1, 4, 410, 357, 586, 588, 16, 29, 21, 
38, 1, 1, 1, 1, 7, 12, 7, 11, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 4, 
1, 4, 3, 11, 4, 0, 0, 1, 0, 0, 1, 5, 0, 0, 0, 1, 1, 0, 0, 1, 
0, 30, 31, 10, 42, 0, 0, 1, 0, 7, 8, 10, 13, 111, 125, 112, 73, 
2, 1, 0, 0, 67, 64, 81, 102, 0, 0, 1, 0, 0, 0, 0, 1, 21, 20, 
14, 24, 0, 1, 0, 0), .Dim = c(4L, 33L), .Dimnames = list(c("Trt", 
"Var1", "Var2", "Var3"), c("Sp1", "Sp2", "Sp3", "Sp4", "Sp5", "Sp6", 
"Sp7", "Sp8", "Sp9", "Sp10", "Sp11", "Sp12", "Sp13", "Sp14", 
"Sp15", "Sp16", "Sp17", "Sp18", "Sp19", "Sp20", "Sp21", "Sp22", 
"Sp23", "Sp24", "Sp25", "Sp26", "Sp27", "Sp28", "Sp29", "Sp30", 
"Sp31", "Sp32", "Sp33"))))

fvar&lt;-factor(row.names(PSM), levels=row.names(PSM))

Simpsonci(X=PSM, f=fvar)

# The complete data is available in package simboot.

# # #
# Simultaneous confidence intervals for ratios of expected values
# under lognormal assumption

x &lt;- rlnorm(n=40, meanlog=rep(c(0,0.1,1,1), each=10), sdlog=rep(c(0.2,0.2,0.5,0.5), each=10))
f &lt;- as.factor(rep(LETTERS[1:4], each=10))

lnrci(x=x, f=f, type="Tukey", method="GPQ", B=10000)


</code></pre>

<hr>
<h2 id='binomest'> Only for internal use.  </h2><span id='topic+binomest'></span><span id='topic+binomest.default'></span><span id='topic+binomest.formula'></span><span id='topic+binomest.table'></span>

<h3>Description</h3>

<p>Groupwise point and variance estimates for binomials,
if data are given as numeric vectors of successes x and trials n,
with I the number of levels in the one-way layout</p>


<h3>Usage</h3>

<pre><code class='language-R'>binomest(x, ...)

## Default S3 method:
binomest(x, n, names=NULL,
 method="Wald", success=NULL, ...)

## S3 method for class 'formula'
binomest(formula, data,
 method="Wald", success=NULL, ...)

## S3 method for class 'table'
binomest(x, method="Wald",
 success=NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomest_+3A_x">x</code></td>
<td>
<p>either a numeric vector of the number of successes, then <kbd>n</kbd> must be specified,
or an object of class &quot;table&quot; as can be obtained by using <a href="base.html#topic+table">table</a> on a data.frame with to categorical variables </p>
</td></tr>
<tr><td><code id="binomest_+3A_n">n</code></td>
<td>
<p>a numeric vector of the number of trials, only needed, if <kbd>x</kbd> is a numeric vector  </p>
</td></tr>
<tr><td><code id="binomest_+3A_names">names</code></td>
<td>
<p> optional character vector of group names (labels for later output), must have the same length as <kbd>x</kbd> and <kbd>n</kbd> </p>
</td></tr>
<tr><td><code id="binomest_+3A_formula">formula</code></td>
<td>
<p>a two-sided formula of the style 'response ~ treatment', where 'response' should be a categorical variable with two levels, while treatment should be a factor specifying the treatment levels</p>
</td></tr>
<tr><td><code id="binomest_+3A_data">data</code></td>
<td>
<p>a data.frame, containing the variables specified in formula</p>
</td></tr>
<tr><td><code id="binomest_+3A_method">method</code></td>
<td>
<p> a character string, specifying the method for variance estimator, with options &quot;Wald&quot;,&quot;ADD1&quot;,&quot;ADD2&quot; </p>
</td></tr>
<tr><td><code id="binomest_+3A_success">success</code></td>
<td>
<p>an optional character string, to indicate the level considered as success if data are given as table, or data.frame, or, serving as label for the event considered as success in later functions</p>
</td></tr>
<tr><td><code id="binomest_+3A_...">...</code></td>
<td>
<p> currently not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only for internal use.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>a numeric vector of the groupwise number of successes</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>a numeric vector of the groupwise number of trials (observations)</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p> a numeric vector of groupwise point estimates for the probability of success, Y/n</p>
</td></tr>
<tr><td><code>estp</code></td>
<td>
<p>a numeric vector of groupwise interval midpoints</p>
</td></tr>
<tr><td><code>varp</code></td>
<td>
<p>a numeric vector of groupwise variance estimators, to be used for CI construction</p>
</td></tr>
<tr><td><code>varcor</code></td>
<td>
<p> a numeric vector of groupwise variance estimators, to be used for correlation structures and test
these values are adjusted to be larger than zero also in cases where Y=0 or Y=n</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p> a character vector of the level names of <kbd>f</kbd></p>
</td></tr>
<tr><td><code>success</code></td>
<td>
<p> a character string naming the category which has been defined as success </p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# if data are available as counts:

nsuccess&lt;-c(1,2,6,8)
ntrials&lt;-c(20,20,20,20)
binomest(x=nsuccess, n=ntrials)

binomest(x=nsuccess, n=ntrials,
 names=c("Control", "A", "B", "C"))

# if data are available as data.frame
# with categorical response variable
# and factor as grouping variable 

data(liarozole)
binomest(Improved ~ Treatment, data=liarozole)
binomest(Improved ~ Treatment, data=liarozole, success="y")

# if data are available as table
# and factor as grouping variable 

data(liarozole)
tab&lt;-table(liarozole)

binomest(tab)
binomest(tab, success="y")


</code></pre>

<hr>
<h2 id='binomORci'> Simultaneous confidence intervals for odds ratios</h2><span id='topic+binomORci'></span><span id='topic+binomORci.default'></span><span id='topic+binomORci.formula'></span><span id='topic+binomORci.table'></span><span id='topic+binomORci.matrix'></span>

<h3>Description</h3>

<p>Approximate simultaneous confidence intervals for (weighted geometric means of) odds ratios
are constructed. Estimates are derived from fitting a glm on the logit-link,
approximate intervals are constructed on the logit-link,
and transformed to original scale.</p>


<h3>Usage</h3>

<pre><code class='language-R'>binomORci(x, ...)

## Default S3 method:
binomORci(x, n, names = NULL,
 type = "Dunnett", method="GLM", cmat = NULL,
 alternative = "two.sided", conf.level = 0.95,
 dist="MVN", ...)

## S3 method for class 'formula'
binomORci(formula, data,
 type = "Dunnett", method="GLM", cmat = NULL,
 alternative = "two.sided", conf.level = 0.95,
 dist="MVN", ...)

## S3 method for class 'table'
binomORci(x,
 type = "Dunnett",method="GLM", cmat = NULL,
 alternative = "two.sided", conf.level = 0.95,
 dist="MVN", ...)

## S3 method for class 'matrix'
binomORci(x,
 type = "Dunnett", method="GLM", cmat = NULL,
 alternative = "two.sided", conf.level = 0.95,
 dist="MVN", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomORci_+3A_x">x</code></td>
<td>
<p> a numeric vector, giving the number of successes in I independent samples,
or an object of class <kbd>"table"</kbd>, representing the 2xk-table,
or an object of class <kbd>"matrix"</kbd>, representing the 2xk-table</p>
</td></tr>
<tr><td><code id="binomORci_+3A_n">n</code></td>
<td>
<p>  numeric vector, giving the number of trials (i.e. the sample size) in each of the I groups
(only required if <kbd>x</kbd> is a numeric vector, ignored otherwise)  </p>
</td></tr>
<tr><td><code id="binomORci_+3A_names">names</code></td>
<td>
<p>an optional character string, giving the names of the groups/ sample in <kbd>x</kbd>, <kbd>n</kbd>;
if not specified the possible names of x are taken as group names (ignored if <kbd>x</kbd> is a table or matrix)</p>
</td></tr>
<tr><td><code id="binomORci_+3A_formula">formula</code></td>
<td>
<p>a two-sided formula of the style 'response ~ treatment', where 'response' should be a categorical variable with two levels,
while treatment should be a factor specifying the treatment levels</p>
</td></tr>
<tr><td><code id="binomORci_+3A_data">data</code></td>
<td>
<p>a data.frame, containing the variables specified in formula</p>
</td></tr>
<tr><td><code id="binomORci_+3A_type">type</code></td>
<td>
<p> a character string, giving the name of a contrast method,
as defined in <kbd>contrMat(multcomp)</kbd>; ignored if <kbd>cmat</kbd> is sepcified </p>
</td></tr>
<tr><td><code id="binomORci_+3A_method">method</code></td>
<td>
<p>a single character string, specifying the method for confidence interval computation; Options are <kbd>"GLM"</kbd> and <kbd>"Woolf"</kbd>.
<kbd>"GLM"</kbd> takes the maximum likelihood estimates and the their standard errors; this yields a conservative confidence intervals with uninformative limits if x=0 and x=n occures.
<kbd>"Woolf"</kbd> adds 0.5 to the cell counts, resulting in less conservative bounds. These can be liberal when extreme proportions are compared. </p>
</td></tr>
<tr><td><code id="binomORci_+3A_cmat">cmat</code></td>
<td>
<p> a optional contrast matrix </p>
</td></tr>
<tr><td><code id="binomORci_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, one of &quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot; </p>
</td></tr>
<tr><td><code id="binomORci_+3A_conf.level">conf.level</code></td>
<td>
<p> a single numeric value, simultaneous confidence level </p>
</td></tr>
<tr><td><code id="binomORci_+3A_dist">dist</code></td>
<td>
<p>a character string, <kbd>"MVN"</kbd> invokes multiplicity adjustment via the multivariate normal distribution,
<kbd>"N"</kbd> invokes use of quantiles of the univariate normal distribution</p>
</td></tr>
<tr><td><code id="binomORci_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <a href="#topic+binomest">binomest</a>, currently only <kbd>success</kbd> labelling the event which should be considered as success</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls <a href="stats.html#topic+glm">glm</a> and fits a one-way-model with family binomial on the logit-link.
Then, the point estimates and variances estimates from the fit are taken to construct simultaneous confidence
intervals for differences (of weighted arithmetic means) of log-odds.
Applying the exponential function to these intervals on the logit scale yields
intervals for ratios (of weighted geometric) of odds. For simple groupwise comparisons,
one yields intervals for oddsratios.
For the case of Dunnett-type contrasts, the calculated simultaneous confidence intervals
are those described in Holford et al. (1989).
</p>
<p>Specifying <kbd>method="GLM"</kbd> takes maximum likelihood estimates for the log-odds and their standard errors evaluated at the estimate.
</p>
<p>Specifying <kbd>method="Woolf"</kbd> takes adds 0.5 to each cell count and computes point estimates and standard errors for these continuity corrected values.
For the two-sample comparison this method is refered to as &quot;adjusted Woolf&quot; (Lawson, 2005). In this implementation, the lower bounds yielded by this method
are additionally expanded to 0, if all values in the denominator are x=n or all values in the numerator are x=0, and the upper bounds are expanded to Inf, 
if all values in the denominator are x=0 or all values in the numerator are x=n.
</p>
<p>Note, that for the case of general contrasts, the methods are not described explicitly so far.
</p>


<h3>Value</h3>

<p>A object of class &quot;binomORci&quot;, a list containing:
</p>
<table>
<tr><td><code>conf.int</code></td>
<td>
<p>a matrix with 2 columns: lower and upper confidence bounds, and M rows</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>character string, as input</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>single numeric value, as input</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>a matrix with 1 column: containing the estimates of the contrasts</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the observed number of successes</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of trials</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the estimated proportions</p>
</td></tr>
<tr><td><code>success</code></td>
<td>
<p>a character string labelling the event considered as success</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the group names</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string, specifying the method of interval construction</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p>the contrast matrix used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt, Daniel Gerhard </p>


<h3>References</h3>

<p>Holford, TR, Walter, SD and Dunnett, CW (1989). Simultaneous interval estimates of the odds ratio in
studies with two or more comparisons. Journal of Clinical Epidemiology 42, 427-434.
</p>


<h3>See Also</h3>

<p> Intervals for the risk difference <a href="#topic+binomRDci">binomRDci</a>,
summary for odds ratio confidence intervals <a href="#topic+summary.binomORci">summary.binomORci</a>
plot for confidence intervals <a href="#topic+plot.sci">plot.sci</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(liarozole)

table(liarozole)

# Comparison to the control group "Placebo",
# which is the fourth group in alpha-numeric
# order:

ORlia&lt;-binomORci(Improved ~ Treatment,
 data=liarozole, success="y", type="Dunnett", base=4)
ORlia
summary(ORlia)
plot(ORlia)

# if data are available as table:

tab&lt;-table(liarozole)
tab
ORlia2&lt;-binomORci(tab, success="y", type="Dunnett", base=4)
ORlia2

plot(ORlia2, lines=1, lineslty=3)


############################

#  Performance for extreme cases

# method="GLM" (the default)

test1&lt;-binomORci(x=c(0,1,5,20), n=c(20,20,20,20), names=c("A","B","C","D"))
test1
plot(test1)

# adjusted Woolf interval

test2&lt;-binomORci(x=c(0,1,5,20), n=c(20,20,20,20), names=c("A","B","C","D"), method="Woolf")
test2
plot(test2)

</code></pre>

<hr>
<h2 id='binomRDci'> Simultaneous confidence intervals for contrasts of independent binomial proportions (in a oneway layout) </h2><span id='topic+binomRDci'></span><span id='topic+binomRDci.default'></span><span id='topic+binomRDci.table'></span><span id='topic+binomRDci.matrix'></span><span id='topic+binomRDci.formula'></span>

<h3>Description</h3>

<p>Simultaneous asymptotic CI for contrasts of binomial proportions,
assuming that standard normal approximation holds.
The contrasts can be interpreted as differences of (weighted averages)
of proportions (risk ratios).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
binomRDci(x,...)

## Default S3 method:
binomRDci(x, n, names=NULL,
 type="Dunnett", cmat=NULL, method="Wald",
 alternative="two.sided", conf.level=0.95,
 dist="MVN", ...)

## S3 method for class 'formula'
binomRDci(formula, data,
 type="Dunnett", cmat=NULL, method="Wald",
 alternative="two.sided", conf.level=0.95,
 dist="MVN",...)

## S3 method for class 'table'
binomRDci(x, type="Dunnett",
 cmat=NULL, method="Wald", alternative="two.sided",
 conf.level=0.95, dist="MVN",...)

## S3 method for class 'matrix'
binomRDci(x, type="Dunnett",
 cmat=NULL, method="Wald", alternative="two.sided",
 conf.level=0.95, dist="MVN",...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomRDci_+3A_x">x</code></td>
<td>
<p> a numeric vector, giving the number of successes in I independent samples,
or an object of class <kbd>"table"</kbd>, representing the 2xk-table,
or an object of class <kbd>"matrix"</kbd>, representing the 2xk-table
</p>
</td></tr>
<tr><td><code id="binomRDci_+3A_n">n</code></td>
<td>
<p> a numeric vector, giving the number of trials (i.e. the sample size) in each of the I groups
(only required if <kbd>x</kbd> is a numeric vector, ignored otherwise) </p>
</td></tr>
<tr><td><code id="binomRDci_+3A_names">names</code></td>
<td>
<p>an optional character string, giving the names of the groups/ sample in <kbd>x</kbd>, <kbd>n</kbd>;
if not specified the possible names of x are taken as group names (ignored if <kbd>x</kbd> is a table or matrix)</p>
</td></tr>
<tr><td><code id="binomRDci_+3A_formula">formula</code></td>
<td>
<p>a two-sided formula of the style 'response ~ treatment', where 'response' should be a categorical variable with two levels,
while treatment should be a factor specifying the treatment levels</p>
</td></tr>
<tr><td><code id="binomRDci_+3A_data">data</code></td>
<td>
<p>a data.frame, containing the variables specified in formula</p>
</td></tr>
<tr><td><code id="binomRDci_+3A_type">type</code></td>
<td>
<p> a character string, giving the name of a contrast method,
as defined in <kbd>contrMat(multcomp)</kbd>; ignored if <kbd>cmat</kbd> is specified </p>
</td></tr>
<tr><td><code id="binomRDci_+3A_cmat">cmat</code></td>
<td>
<p> a optional contrast matrix </p>
</td></tr>
<tr><td><code id="binomRDci_+3A_method">method</code></td>
<td>
<p> a single character string, specifying the method for confidence interval construction; options are: <kbd>"Wald"</kbd>, <kbd>"ADD1"</kbd>, or <kbd>"ADD2"</kbd> </p>
</td></tr>
<tr><td><code id="binomRDci_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, one of &quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot; </p>
</td></tr>
<tr><td><code id="binomRDci_+3A_conf.level">conf.level</code></td>
<td>
<p> a single numeric value, simultaneous confidence level </p>
</td></tr>
<tr><td><code id="binomRDci_+3A_dist">dist</code></td>
<td>
<p>a character string, <kbd>"MVN"</kbd> invokes multiplicity adjustment via the multivariate normal distribution,
<kbd>"N"</kbd> invokes use of quantiles of the univariate normal distribution</p>
</td></tr>
<tr><td><code id="binomRDci_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <a href="#topic+binomest">binomest</a>, currently only <kbd>success</kbd> labelling the event which should be considered as success</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the examples for different usages.
</p>


<h3>Value</h3>

<p>A object of class &quot;binomRDci&quot;, a list containing:
</p>
<table>
<tr><td><code>conf.int</code></td>
<td>
<p>a matrix with 2 columns: lower and upper confidence bounds, and M rows</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>character string, as input</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>single numeric value, as input</p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p>the quantile used to construct the confidence intervals</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>a matrix with 1 column: containing the estimates of the contrasts</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the observed number of successes in the treatment groups</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of trials in the treatment groups</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the estimated proportions in the treatment groups</p>
</td></tr>
<tr><td><code>success</code></td>
<td>
<p>a character string labelling the event considered as success</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the group names</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string, specifying the method of interval construction</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p>the contrast matrix used</p>
</td></tr>
</table>


<h3>Note</h3>

<p> Note, that all implemented methods are approximate only. The coverage probability of the 
intervals might seriously deviate from the nominal level for small sample sizes and extreme success probabilities.
See the simulation results in Sill (2007) for details. </p>


<h3>References</h3>

 
<p>Schaarschmidt, F., Sill, M. and Hothorn, L.A. (2008):
Approximate simultaneous confidence intervals for multiple contrasts of binomial proportions.
Biometrical Journal 50, 782-792.
</p>
<p>Background references:
</p>
<p>The ideas underlying the &quot;ADD1&quot; and &quot;ADD2&quot; adjustment are described in:
</p>
<p>Agresti, A. and Caffo, B.(2000):
Simple and effective confidence intervals for proportions and differences of proportions result from adding two successes and two failures.
American Statistician 54, p. 280-288.
</p>
<p>And have been generalized for a single contrast of several proportions in:
</p>
<p>Price, R.M. and Bonett, D.G. (2004):
An improved confidence interval for a linear function of binomial proportions.
Computational Statistics and Data Analysis 45, 449-456.
</p>
<p>More detailed simulation results are available in:
</p>
<p>Sill, M. (2007):
Approximate simultaneous confidence intervals for multiple comparisons of binomial proportions.
Master thesis, Institute of Biostatistics, Leibniz University Hannover.
</p>


<h3>See Also</h3>

 <p><a href="#topic+summary.binomRDci">summary.binomRDci</a>, <a href="#topic+plot.sci">plot.sci</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
###############################################################

### Example 1 Tables 1,7,8 in Schaarschmidt et al. (2008):  ###

###############################################################

# Number of patients under observation: 
n &lt;- c(29, 24, 25, 24, 46)

# Number of patients with complete response:
cr &lt;- c(7, 11, 10, 12, 21)

# (Optional) names for the treatments
dn &lt;- c("0.3_1.0", "3", "10", "30", "90")

# Assume we aim to infer an increasing trend with increasing dosage,
# Using the changepoint contrasts (Table 7, Schaarschmidt et al., 2008)

# The results in Table 8 can be reproduced by calling:

binomRDci(n=n, x=cr, names=dn, alternative="greater",
 method="ADD2", type="Changepoint")

binomRDci(n=n, x=cr, names=dn, alternative="greater",
 method="ADD1", type="Changepoint")

binomRDci(n=n, x=cr, names=dn, alternative="greater", 
 method="Wald", type="Changepoint")

##############################################################

### Example 2, Tables 2,9,10 in Schaarschmidt et al. 2008  ###

##############################################################

# Data (Table 2)

# animals under risk
n&lt;-c(30,30,30,30)

# animals showing cancer
cancer&lt;-c(20,14,27,19)

# short names for the treatments
trtn&lt;-c("HFaFi","LFaFi","HFaNFi","LFaNFi")


# User-defined contrast matrix (Table 9),
# columns of the contrast matrix 

cmat&lt;-rbind(
"Fiber - No Fiber"=c( 0.5, 0.5,-0.5,-0.5),
"Low Fat - High Fat"=c(-0.5, 0.5,-0.5, 0.5),
"Interaction Fat:Fiber"=c(   1,  -1,   -1,  1))

cmat

# The results in Table 10 can be reproduced by calling:

# simultaneous CI using the add-2 adjustment

sci&lt;-binomRDci(x=cancer, n=n, names=trtn, method="ADD2",
 cmat=cmat, dist="MVN")

sci

# marginal CI using the basic Wald formula

ci&lt;-binomRDci(x=cancer, n=n, names=trtn, method="Wald",
 cmat=cmat, dist="N")

ci


# check, whether the intended contrasts have been defined:

summary(sci)

# plot the result:

plot(sci, lines=0, lineslty=3)


##########################################


# In simple cases, counts of successes
# and number of trials can be just typed:

ntrials &lt;- c(40,20,20,20)
xsuccesses &lt;- c(1,2,2,4)
names(xsuccesses) &lt;- LETTERS[1:4]
ex1D&lt;-binomRDci(x=xsuccesses, n=ntrials, method="ADD1",
 type="Dunnett")
ex1D

ex1W&lt;-binomRDci(x=xsuccesses, n=ntrials, method="ADD1",
 type="Williams", alternative="greater")
ex1W

# results can be plotted:
plot(ex1D, main="Comparisons to control group A", lines=0, linescol="red", lineslwd=2)

# summary gives a more detailed print out:
summary(ex1W)

# if data are represented as dichotomous variable
# in a data.frame one can make use of table:


#################################

data(liarozole)

head(liarozole)

binomRDci(Improved ~ Treatment, data=liarozole,
 type="Tukey")

# here, it might be important to define which level of the
# variable 'Improved' is to be considered as success

binomRDci(Improved ~ Treatment, data=liarozole,
 type="Dunnett", success="y", base=4)

# If data are available as a named kx2-contigency table:

tab&lt;-table(liarozole)
tab

# Comparison to the control group "Placebo",
# which is the fourth group in alpha-numeric order:

CIs&lt;-binomRDci(tab, type="Dunnett", success="y", base=4)

plot(CIs, lines=0)

</code></pre>

<hr>
<h2 id='binomRDtest'> Simultaneous test for contrasts of independent binomial proportions (in a oneway layout) </h2><span id='topic+binomRDtest'></span><span id='topic+binomRDtest.default'></span><span id='topic+binomRDtest.table'></span><span id='topic+binomRDtest.matrix'></span><span id='topic+binomRDtest.formula'></span>

<h3>Description</h3>

<p>P-value of maximum test and adjusted p-values for M contrasts of I groups
in a one-way layout. Tests are performed for contrasts of proportions,
which can be interpreted as differences of (weighted averages of) proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binomRDtest(x, ...)

## Default S3 method:
binomRDtest(x, n, names=NULL,
 type="Dunnett", cmat=NULL, method="Wald",
 alternative="two.sided", dist="MVN", ...)

## S3 method for class 'formula'
binomRDtest(formula, data,
 type="Dunnett", cmat=NULL, method="Wald",
 alternative="two.sided", dist="MVN", ...)

## S3 method for class 'table'
binomRDtest(x, type="Dunnett",
 cmat=NULL, method="Wald", alternative="two.sided",
 dist="MVN", ...)

## S3 method for class 'matrix'
binomRDtest(x, type="Dunnett",
 cmat=NULL, method="Wald", alternative="two.sided",
 dist="MVN", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomRDtest_+3A_x">x</code></td>
<td>
<p> a numeric vector, giving the number of successes in I independent samples,
or an object of class <kbd>"table"</kbd>, representing the 2xk-table,
or an object of class <kbd>"matrix"</kbd>, representing the 2xk-table
</p>
</td></tr>
<tr><td><code id="binomRDtest_+3A_n">n</code></td>
<td>
<p> a numerioc vector, giving the number of trials (i.e. the sample size) in each of the I groups </p>
</td></tr>
<tr><td><code id="binomRDtest_+3A_names">names</code></td>
<td>
<p>an optional character vector, giving the names of the groups in <kbd>x</kbd>, <kbd>n</kbd>; if not specified, possibly availbale names of x are taken as group names</p>
</td></tr>
<tr><td><code id="binomRDtest_+3A_formula">formula</code></td>
<td>
<p>a two-sided formula of the style 'response ~ treatment', where 'response' should be a categorical variable with two levels,
while treatment should be a factor specifying the treatment levels</p>
</td></tr>
<tr><td><code id="binomRDtest_+3A_data">data</code></td>
<td>
<p>a data.frame, containing the variables specified in formula</p>
</td></tr>
<tr><td><code id="binomRDtest_+3A_type">type</code></td>
<td>
<p> a character string specifying the contrast type </p>
</td></tr> 
<tr><td><code id="binomRDtest_+3A_cmat">cmat</code></td>
<td>
<p>an optional user defined contrast matrix of dimension MxI</p>
</td></tr>
<tr><td><code id="binomRDtest_+3A_method">method</code></td>
<td>
<p> a single charcter string, specifying the method for adjustment,
with options: &quot;Wald&quot; (Maximum likelihood estimators),
&quot;ADD1&quot; (add1-adjustment on the raw proportion estimates)
&quot;ADD2&quot; (add2-adjustment on proportion estimates following Agresti Caffo (2000))
</p>
</td></tr>
<tr><td><code id="binomRDtest_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the direction of the alternative hypothesis</p>
</td></tr>
<tr><td><code id="binomRDtest_+3A_dist">dist</code></td>
<td>
<p>a character string, where <kbd>"MVN"</kbd> invokes the computation of p-values using the multivariate normal distribution,
and <kbd>"N"</kbd> invokes use p-value computation using the univariate normal distribution</p>
</td></tr>
<tr><td><code id="binomRDtest_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <a href="#topic+binomest">binomest</a>, currently only <kbd>success</kbd> labelling the event which should be considered as success</p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>For usage, see the examples.
</p>


<h3>Value</h3>

<p> An object of class &quot;binomRDtest&quot;, a list containing:
</p>
<table>
<tr><td><code>teststat</code></td>
<td>
<p>a numeric vector of teststatistics of length M</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>a single numeric p-value, the p-value of the maximum test (minimum p-value)</p>
</td></tr> 
<tr><td><code>p.val.adj</code></td>
<td>
<p> a vector of length M, the adjusted p-values of the single contrasts</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>character string indicating whether the multivariate normal or normal distribution was used for computation of p-values</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a single character vector, as the input</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the observed number of successes in the treatment groups</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of trials in the treatment groups</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the estimated proportions in the treatment groups</p>
</td></tr>
<tr><td><code>success</code></td>
<td>
<p>a character string labelling the event considered as success</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>as input, a character string</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p> used contrast matrix</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note, that all implemented methods are approximate only. The size of the 
test might seriously deviate from the nominal level for small sample sizes and extreme success probabilities.
See the simulation results in Sill (2007) for details.  </p>


<h3>References</h3>

<p>Statistical procedures and characterization of coverage probabilities are described in:
Sill, M. (2007):
Approximate simultaneous confidence intervals for multiple comparisons of binomial proportions.
Master thesis, Institute of Biostatistics, Leibniz University Hannover.
</p>


<h3>See Also</h3>

 <p><a href="#topic+summary.binomRDtest">summary.binomRDtest</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
ntrials &lt;- c(40,20,20,20)
xsuccesses &lt;- c(1,2,2,4)
names(xsuccesses) &lt;- LETTERS[1:4]
binomRDtest(x=xsuccesses, n=ntrials, method="ADD1",
 type="Dunnett")

binomRDtest(x=xsuccesses, n=ntrials, method="ADD1",
 type="Williams", alternative="greater")

binomRDtest(x=xsuccesses, n=ntrials, method="ADD2",
 type="Williams", alternative="greater")
</code></pre>

<hr>
<h2 id='binomRRci'> Simultaneous confidence intervals for ratios of independent binomial proportions </h2><span id='topic+binomRRci'></span><span id='topic+binomRRci.default'></span><span id='topic+binomRRci.table'></span><span id='topic+binomRRci.matrix'></span><span id='topic+binomRRci.formula'></span>

<h3>Description</h3>

<p>Simultaneous asymptotic CI for contrasts of binomial proportions,
assuming that standard normal approximation holds on the log scale.
Confidence intervals for ratios of (weighted geometric means) of proportions are calculated
based on differences of log-proportions, and normal approximation on the log-scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
binomRRci(x,...)

## Default S3 method:
binomRRci(x, n, names=NULL,
 type="Dunnett", cmat=NULL,
 alternative="two.sided", conf.level=0.95,
 dist="MVN", ...)

## S3 method for class 'formula'
binomRRci(formula, data,
 type="Dunnett", cmat=NULL,
 alternative="two.sided", conf.level=0.95,
 dist="MVN",...)

## S3 method for class 'table'
binomRRci(x, type="Dunnett",
 cmat=NULL, alternative="two.sided",
 conf.level=0.95, dist="MVN",...)

## S3 method for class 'matrix'
binomRRci(x, type="Dunnett",
 cmat=NULL, alternative="two.sided",
 conf.level=0.95, dist="MVN",...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomRRci_+3A_x">x</code></td>
<td>
<p> a numeric vector, giving the number of successes in I independent samples,
or an object of class <kbd>"table"</kbd>, representing the 2xk-table,
or an object of class <kbd>"matrix"</kbd>, representing the 2xk-table
</p>
</td></tr>
<tr><td><code id="binomRRci_+3A_n">n</code></td>
<td>
<p> a numeric vector, giving the number of trials (i.e. the sample size) in each of the I groups
(only required if <kbd>x</kbd> is a numeric vector, ignored otherwise) </p>
</td></tr>
<tr><td><code id="binomRRci_+3A_names">names</code></td>
<td>
<p>an optional character string, giving the names of the groups/ sample in <kbd>x</kbd>, <kbd>n</kbd>;
if not specified the possible names of x are taken as group names (ignored if <kbd>x</kbd> is a table or matrix)</p>
</td></tr>
<tr><td><code id="binomRRci_+3A_formula">formula</code></td>
<td>
<p>a two-sided formula of the style 'response ~ treatment', where 'response' should be a categorical variable with two levels,
while treatment should be a factor specifying the treatment levels</p>
</td></tr>
<tr><td><code id="binomRRci_+3A_data">data</code></td>
<td>
<p>a data.frame, containing the variables specified in formula</p>
</td></tr>
<tr><td><code id="binomRRci_+3A_type">type</code></td>
<td>
<p> a character string, giving the name of a contrast method,
as defined in <kbd>contrMat(multcomp)</kbd>; ignored if <kbd>cmat</kbd> is specified </p>
</td></tr>
<tr><td><code id="binomRRci_+3A_cmat">cmat</code></td>
<td>
<p> a optional contrast matrix </p>
</td></tr>
<tr><td><code id="binomRRci_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, one of &quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot; </p>
</td></tr>
<tr><td><code id="binomRRci_+3A_conf.level">conf.level</code></td>
<td>
<p> a single numeric value, simultaneous confidence level </p>
</td></tr>
<tr><td><code id="binomRRci_+3A_dist">dist</code></td>
<td>
<p>a character string, <kbd>"MVN"</kbd> invokes multiplicity adjustment via the multivariate normal distribution,
<kbd>"N"</kbd> invokes use of quantiles of the univariate normal distribution</p>
</td></tr>
<tr><td><code id="binomRRci_+3A_...">...</code></td>
<td>
<p> arguments to be passed to <a href="#topic+binomest">binomest</a>, currently only <kbd>success</kbd> labelling the event which should be considered as success</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interval for the ratio of two independent proportions, described in section &quot;Crude Methods using first-order variance estimation&quot; in Gart and Nam (1988) are extended
to multiple contrasts. Confidence intervals are constructed based on contrasts for differences of lp=log (x+0.5)/(n+0.5), using quantiles of the multivariate normal or normal approximation.
Applying the exponential functions to the bounds results in intervals for the risk ratio.
In case that 0 occur in both, the numerator and denominator of the ratio, the interval is expanded to [0,Inf], in case that only 0s numerator go to the numerator, the lower bound is expanded to 0,
in case that only 0s go to the denominator, the upper bound is expanded to Inf.
</p>
<p>See the examples for different usages.
</p>


<h3>Value</h3>

<p>A object of class &quot;binomRDci&quot;, a list containing:
</p>
<table>
<tr><td><code>conf.int</code></td>
<td>
<p>a matrix with 2 columns: lower and upper confidence bounds, and M rows</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>character string, as input</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>single numeric value, as input</p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p>the quantile used to construct the confidence intervals</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>a matrix with 1 column: containing the estimates of the contrasts</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the observed number of successes in the treatment groups</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of trials in the treatment groups</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the estimated proportions in the treatment groups</p>
</td></tr>
<tr><td><code>success</code></td>
<td>
<p>a character string labelling the event considered as success</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>the group names</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string, specifying the method of interval construction</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p>the contrast matrix used</p>
</td></tr>
</table>


<h3>Note</h3>

<p> Note, that all implemented methods are approximate only. The coverage probability of the 
intervals might seriously deviate from the nominal level for small sample sizes and extreme success probabilities.
</p>


<h3>References</h3>

 
<p>Gart, JJ and Nam,J-m (1988): Approximate interval estimation of the ratio of binomial parameters: a review and corrections for skewness. Biometrics 44, 323-338.
</p>


<h3>See Also</h3>

 <p><a href="#topic+summary.binomRDci">summary.binomRDci</a> for the risk difference, <a href="#topic+summary.binomORci">summary.binomORci</a> for the odds ratio, <a href="#topic+plot.sci">plot.sci</a> for plotting</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# In simple cases, counts of successes
# and number of trials can be just typed:

ntrials &lt;- c(40,20,20,20)
xsuccesses &lt;- c(1,2,2,4)
names(xsuccesses) &lt;- LETTERS[1:4]
ex1D&lt;-binomRRci(x=xsuccesses, n=ntrials,
 type="Dunnett")
ex1D

ex1W&lt;-binomRRci(x=xsuccesses, n=ntrials,
 type="Williams", alternative="greater")
ex1W

# results can be plotted:
plot(ex1D, main="Comparisons to control group A")

# summary gives a more detailed print out:
summary(ex1W)

# if data are represented as dichotomous variable
# in a data.frame one can make use of table:


data(liarozole)

head(liarozole)

# here, it might be important to define which level of the
# variable 'Improved' is to be considered as success

binomRRci(Improved ~ Treatment, data=liarozole,
 type="Dunnett", success="y", base=4, alternative="greater")

# If data are available as a named kx2-contigency table:

tab&lt;-table(liarozole)
tab

binomRRci(tab, type="Dunnett", success="y", base=4, alternative="greater")


# Performance for extreme cases:


binomRRci(x=c(0,0,20,5),n=c(20,20,20,20),names=c("A","B","C","D"),
 type="Dunnett", alternative="greater")


</code></pre>

<hr>
<h2 id='bronch'>Rodent bronchial carcinoma data</h2><span id='topic+bronch'></span>

<h3>Description</h3>

<p>In a long term rodent carcinogenicity study on female B6C3F1 mice, 
the effect of vinylcyclohexene diepoxide on the incidence of murine
alveolar/bronchiolar tumors was assessed. The mice were exposed to
0 mg/ml, (group 0), 25 mg/ml (group 1), 50 mg/ml (group 2),
and 100 (group 3) mg/ml, with 50 animals per group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bronch)</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations on the following 3 variables.
</p>

<dl>
<dt>group</dt><dd><p>a factor with levels 0, 1, 2, 3, labelling the control and the three dose groups</p>
</dd>
<dt>Y</dt><dd><p>a logical vector, indicating whether a tumour was present at time of death (if TRUE), or not (if FALSE) </p>
</dd>
<dt>time</dt><dd><p>a numeric vector, the time of death, counted in days? from begin of the study</p>
</dd>
</dl>



<h3>Details</h3>

<p>Not yet checked for consistency with the source!
</p>


<h3>Source</h3>

<p>Piegorsch WW and Bailer AJ (1997): Statistics for environmental biology and toxicology.
Chapman and Hall, London.
Table 6.5, page 238.
</p>


<h3>References</h3>

<p>Portier cJ and Bailer AJ (1989): Testing for increased carcinogenicity using survival-adjusted quantal response tests.
Fundamental and Applied Toxicology 12, 731.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bronch)
# raw tumour counts:

table(bronch[c("group","Y")])

# groupwise times of death:

boxplot(time ~ group, data=bronch, horizontal=TRUE)

# Using poly3estf, we can produce the
# summary statistics as presented in 
# Table 6.6, page 239, of Piegorsch and Bailer (1997):

poly3estf(status=bronch$Y, time=bronch$time, f=bronch$group)


</code></pre>

<hr>
<h2 id='censsample'> Random data for Poly-k </h2><span id='topic+censsample'></span>

<h3>Description</h3>

<p>Random numbers from two independent Weibull distributions for Mortality and tumour induction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>censsample(n, scale.m, shape.m,
 scale.t, shape.t = 3, tmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="censsample_+3A_n">n</code></td>
<td>
<p> a single numeric value, the number of individuals </p>
</td></tr>
<tr><td><code id="censsample_+3A_scale.m">scale.m</code></td>
<td>
<p>  a single numeric value, scale parameter of the Weibull distribution for mortality </p>
</td></tr>
<tr><td><code id="censsample_+3A_shape.m">shape.m</code></td>
<td>
<p> a single numeric value, shape parameter of the Weibull distribution for mortality </p>
</td></tr>
<tr><td><code id="censsample_+3A_scale.t">scale.t</code></td>
<td>
<p> a single numeric value, scale parameter of the Weibull distribution for tumour induction </p>
</td></tr>
<tr><td><code id="censsample_+3A_shape.t">shape.t</code></td>
<td>
<p> a single numeric value, shape parameter of the Weibull distribution for tumour induction </p>
</td></tr>
<tr><td><code id="censsample_+3A_tmax">tmax</code></td>
<td>
<p> a single numeric value, maximum time in the trial </p>
</td></tr>
</table>


<h3>Value</h3>

<p> A data.frame with columns
</p>
<table>
<tr><td><code>time</code></td>
<td>
<p>a numeric vector of length <kbd>n</kbd>, the time of death of an individual</p>
</td></tr>
<tr><td><code>status</code></td>
<td>
<p>a logical vector of length <kbd>n</kbd>, the tumour status at time of death (TRUE: tumour present, FALSE: no tumour present)</p>
</td></tr>
<tr><td><code>T.t</code></td>
<td>
<p>time of tumour induction (unobservable)</p>
</td></tr>
<tr><td><code>T.m</code></td>
<td>
<p>time of death</p>
</td></tr>
<tr><td><code>tmax</code></td>
<td>
<p>maximum time of death</p>
</td></tr>
</table>

<hr>
<h2 id='censsamplef'> Random data for Poly-k  </h2><span id='topic+censsamplef'></span>

<h3>Description</h3>

<p>Random data for Poly-k for a one-way layout, with I groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>censsamplef(n, scale.m, shape.m, scale.t, shape.t = 3, tmax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="censsamplef_+3A_n">n</code></td>
<td>
<p> a numeric vector, the numbers of individuals of length I </p>
</td></tr>
<tr><td><code id="censsamplef_+3A_scale.m">scale.m</code></td>
<td>
<p>  a numeric vector, scale parameters of the Weibull distribution for mortality </p>
</td></tr>
<tr><td><code id="censsamplef_+3A_shape.m">shape.m</code></td>
<td>
<p> a numeric vector, shape parameters of the Weibull distribution for mortality </p>
</td></tr>
<tr><td><code id="censsamplef_+3A_scale.t">scale.t</code></td>
<td>
<p> a numeric vector, scale parameters of the Weibull distribution for tumour induction </p>
</td></tr>
<tr><td><code id="censsamplef_+3A_shape.t">shape.t</code></td>
<td>
<p> a numeric vector, shape parameters of the Weibull distribution for tumour induction </p>
</td></tr>
<tr><td><code id="censsamplef_+3A_tmax">tmax</code></td>
<td>
<p> a single numeric value, maximum time in the trial </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with columns
</p>
<table>
<tr><td><code>time</code></td>
<td>
<p>a numeric vector of length <kbd>n</kbd>, the time of death of an individual</p>
</td></tr>
<tr><td><code>status</code></td>
<td>
<p>a logical vector of length <kbd>n</kbd>, the tumour status at time of death (TRUE: tumour present, FALSE: no tumour present)</p>
</td></tr>
<tr><td><code>T.t</code></td>
<td>
<p>time of tumour induction (unobservable)</p>
</td></tr>
<tr><td><code>T.m</code></td>
<td>
<p>time of death</p>
</td></tr>
<tr><td><code>tmax</code></td>
<td>
<p>maximum time of death</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p>a factor of containing an appropriate grouping variable</p>
</td></tr>
</table>

<hr>
<h2 id='corrMatgen'> A function to calculate the correlation matrix </h2><span id='topic+corrMatgen'></span>

<h3>Description</h3>

<p>Correlation matrix for teststatistics and confidence intervals assuming multivariate standard normal distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corrMatgen(CM, varp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corrMatgen_+3A_cm">CM</code></td>
<td>
<p> a matrix of contrast coefficients, dimension MxI, where M=number of contrasts, and I=number of groups in a oneway layout </p>
</td></tr>
<tr><td><code id="corrMatgen_+3A_varp">varp</code></td>
<td>
<p> a numeric vector of groupwise variance estimates (length = I) </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of dimension MxM. 
</p>


<h3>References</h3>

<p>For correlation of contrasts of binomial proportion, see:
Bretz F, Hothorn L.:
Detecting dose-response using contrasts: asymptotic power and sample size determination for binomial data.
Statistics in Medicine 2002; 21: 3325-3335. </p>

<hr>
<h2 id='estShannon'> Estimate the Shannon Index </h2><span id='topic+estShannon'></span>

<h3>Description</h3>

<p>Calculates estimates of the Shannon-Wiener from count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estShannon(x, Nspec = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estShannon_+3A_x">x</code></td>
<td>
<p> a integer(numeric) vector of species counts </p>
</td></tr>
<tr><td><code id="estShannon_+3A_nspec">Nspec</code></td>
<td>
<p> a single integer value, fixing the number of species to a certain value </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, containing the elements:
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p> a single numeric value, the estimate with bias correction according to Fritsch and Hsu (1999)</p>
</td></tr>
<tr><td><code>estraw</code></td>
<td>
<p> a single numeric value, the raw estimate </p>
</td></tr>
<tr><td><code>varest</code></td>
<td>
<p> a single numeric value, the variance estimate according to Fritsch and Hsu (1999) </p>
</td></tr>
</table>


<h3>References</h3>

<p> Fritsch, KS, and Hsu, JC (1999): Multiple Comparison
of Entropies with Application to Dinosaur Biodiversity. Biometrics 55, 1300-1305. </p>


<h3>See Also</h3>

 <p><a href="#topic+estSimpsonf">estSimpsonf</a> for estimating Shannon indices pooled over several samples, grouped by a factor  </p>

<hr>
<h2 id='estShannonf'> Estimate the Shannon-Wiener index </h2><span id='topic+estShannonf'></span>

<h3>Description</h3>

<p>Calculate estimates of the Shannon-Wiener index after pooling over several samples, grouped by a factor variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estShannonf(X, f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estShannonf_+3A_x">X</code></td>
<td>
<p> a data.frame of dimension n times p with integer entries, where n is the number of samples and p is the number of species</p>
</td></tr>
<tr><td><code id="estShannonf_+3A_f">f</code></td>
<td>
<p> a factor variable of length n, grouping the observations in <kbd>X</kbd> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function splits <kbd>X</kbd> according to the levels of the grouping variable <kbd>f</kbd>, builds the sum over each column and calculates the Shannon index ove the resulting counts.
</p>


<h3>Value</h3>

<p>A list, containing the elements:
</p>
<table>
<tr><td><code>estimae</code></td>
<td>
<p> a named numeric vector, the groupwise Shannon indices with bias correction according to Fritsch and Hsu (1999)</p>
</td></tr>
<tr><td><code>estraw</code></td>
<td>
<p> a named numeric vector, the groupwise Shannon indices, without bias correction</p>
</td></tr>
<tr><td><code>varest</code></td>
<td>
<p> a named numeric vector, the groupwise variance estimates of the Shannon indices</p>
</td></tr>
<tr><td><code>table</code></td>
<td>
<p>a matrix, giving the summarized counts of the groups in the rows</p>
</td></tr>
</table>


<h3>References</h3>

<p> Fritsch, KS, and Hsu, JC (1999): Multiple Comparison
of Entropies with Application to Dinosaur Biodiversity. Biometrics 55, 1300-1305. </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(HCD)
HCD

# Groupwise point estimates:

est&lt;-estShannonf(X=HCD[,-1], f=HCD[,1])

est



</code></pre>

<hr>
<h2 id='estSimpson'> Simpson index </h2><span id='topic+estSimpson'></span>

<h3>Description</h3>

<p>Calculates the estimate of the Simpson index from a vector of counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estSimpson(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estSimpson_+3A_x">x</code></td>
<td>
<p>a integer (numeric) vector, giving the counts of p species in a community </p>
</td></tr>
</table>

<hr>
<h2 id='estSimpsonf'> Estimate the Simpson index from several samples </h2><span id='topic+estSimpsonf'></span>

<h3>Description</h3>

<p>Calculate estimates of the Simpson index after pooling over several samples, grouped by a factor variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estSimpsonf(X, f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estSimpsonf_+3A_x">X</code></td>
<td>
<p> a data.frame of dimension n times p with integer entries, where n is the number of samples and p is the number of species </p>
</td></tr>
<tr><td><code id="estSimpsonf_+3A_f">f</code></td>
<td>
<p> a factor variable of length n, grouping the observations in <kbd>X</kbd> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function splits <kbd>X</kbd> according to the levels of the grouping variable <kbd>f</kbd>, builds the sum over each column and calculates the Shannon index ove the resulting counts.
</p>


<h3>Value</h3>

<p>A list containing the items:
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p> the groupwise point estimates of the Simpson index</p>
</td></tr>
<tr><td><code>varest</code></td>
<td>
<p>the groupwise variance estimates of the Simpson index</p>
</td></tr>
<tr><td><code>table</code></td>
<td>
<p>a matrix of counts,containing the summed observations for each level of <kbd>f</kbd> in its rows</p>
</td></tr>
</table>


<h3>References</h3>

<p> Rogers, JA and Hsu, JC (2001): Multiple Comparisons of Biodiversity. Biometrical Journal 43, 617-625. </p>


<h3>See Also</h3>

 <p><a href="#topic+estShannonf">estShannonf</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Here, the estimates for the Hell Creek Dinosaur 
# example are compared to the estimates in 
# Tables 2 and 3 of Rogers and Hsu (2001).

data(HCD)
HCD

# Groupwise point estimates:

est&lt;-estSimpsonf(X=HCD[,-1], f=HCD[,1])

est

# Table 2:


cmat&lt;-rbind(
"lower-middle"=c(1,-1,0),
"lower-upper"=c(1, 0,-1),
"middle-upper"=c(0,1,-1))


# the point estimates:

# cmat %*% est$estimate
crossprod(t(cmat), est$estimate)


# the standard errors:
# sqrt(diag(cmat %*% diag(est$varest) %*% t(cmat)))

sqrt(diag(crossprod(t(cmat), crossprod(diag(est$varest), t(cmat)) ) ))


# Table 3:

cmat&lt;-rbind(
"middle-lower"=c(-1,1,0),
"upper-lower"=c(-1,0,1))

# cmat %*% est$estimate
crossprod(t(cmat), est$estimate)


# sqrt(diag(cmat %*% diag(est$varest) %*% t(cmat)))

sqrt(diag(crossprod(t(cmat), crossprod(diag(est$varest), t(cmat)) ) ))

# Note, that the point estimates are exactly
# the same as in Rogers and Hsu (2001),
# but the variance estimates are not, whenever
# the Upper group is involved.


</code></pre>

<hr>
<h2 id='HCD'> Hell Creek Dinosaur Data</h2><span id='topic+HCD'></span>

<h3>Description</h3>

<p>Counts of dinosaur families found in three stratigraphic levels of the Cretaceous period in the Hell Creek formation in North Dakota.
The eight families are the Ceratopsidae (Ce), Hadrosauridae (Ha), Hypsilophodontidae (Hy), Pachycephalosauridae (Pa), Tyrannosauridae (Ty), Ornithomimidae
(Or), Sauronithoididae (Sa) and Dromiaeosauridae (Dr).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HCD)</code></pre>


<h3>Format</h3>

<p>A data frame with 3 observations on the following 9 variables.
</p>

<dl>
<dt>Level</dt><dd><p>a factor with levels <kbd>Lower</kbd>, <kbd>Middle</kbd>, <kbd>Upper</kbd>, specifiyng the stratigraphic levels</p>
</dd>
<dt>Cr</dt><dd><p>a numeric vector, counts of the Ceratopsidae </p>
</dd>
<dt>Ha</dt><dd><p>a numeric vector, counts of the Hadrosauridae</p>
</dd>
<dt>Hy</dt><dd><p>a numeric vector, counts of the Hypsilophodontidae</p>
</dd>
<dt>Pa</dt><dd><p>a numeric vector, counts of the Pachycephalosauridae</p>
</dd>
<dt>Ty</dt><dd><p>a numeric vector, counts of the Tyrannosauridae</p>
</dd>
<dt>Or</dt><dd><p>a numeric vector, counts of the Ornithomimidae</p>
</dd>
<dt>Sa</dt><dd><p>a numeric vector, counts of the Sauronithoididae</p>
</dd>
<dt>Dr</dt><dd><p>a numeric vector, counts of the Dromiaeosauridae</p>
</dd>
</dl>



<h3>Source</h3>

<p>Table 1 in: Rogers, JA and Hsu, JC (2001): Multiple Comparisons of Biodiversity. Biometrical Journal 43, 617-625.
</p>


<h3>References</h3>

<p>Sheehan, P.M., et al. (1991): Sudden extinction of the Dinosaurs: Latest Cretaceous, Upper Great Plains, U.S.A. Science 254, 835-839.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(HCD)
str(HCD)
HCD

mat&lt;-as.matrix(HCD[,-c(1)])

rownames(mat)&lt;-HCD$Level

mosaicplot(mat, las=1)

estSimpsonf(X=HCD[,-c(1)], f=HCD$Level)

estShannonf(X=HCD[,-c(1)], f=HCD$Level)

</code></pre>

<hr>
<h2 id='liarozole'> Marked improvement of psoriasis after application of liarozole</h2><span id='topic+liarozole'></span>

<h3>Description</h3>

<p>In a placebo controlled clinical trial, patients with psoriasis were randomly assigned
to a placebo group and three dose groups (50 mg, 75 mg, and 150 mg). Variable of primary
interest was the proportion of patients with marked improvement of psoriasis.
This data.frame mimics how raw data could have been represented in a larger data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(liarozole)</code></pre>


<h3>Format</h3>

<p>A data frame with 137 observations on the following 2 variables.
</p>

<dl>
<dt>Improved</dt><dd><p>a factor with levels <kbd>n</kbd>, <kbd>y</kbd>, for &quot;no&quot; and &quot;yes&quot;</p>
</dd>
<dt>Treatment</dt><dd><p>a factor with levels <kbd>Dose150</kbd>, <kbd>Dose50</kbd>, <kbd>Dose75</kbd>, <kbd>Placebo</kbd></p>
</dd>
</dl>



<h3>Details</h3>

<p>For illustrative purpose only. Number of successes recalculated from proportions
presented in the publication, while the number of patients in group <kbd>Dose50</kbd> was not exactly clear.
</p>


<h3>Source</h3>

<p>Berth-Jones J, Todd G, Hutchinson PE, Thestrup-Pedersen K, Vanhoutte FP:
Treatment of psoriasis with oral liarozole: a dose-ranging study.
British Journal of Dermatology 2000; 143: 1170-1176.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(liarozole)
head(liarozole)
# create a contingency table:

table(liarozole)


# the order of the groups is alpha-numeric,
# and "y" for success is of higher order than
# to change the order:

liarozole$Treatment&lt;-factor(liarozole$Treatment,
 levels=c("Placebo", "Dose50", "Dose75", "Dose150"))

liarozole$Improved&lt;-factor(liarozole$Improved,
 levels=c("y", "n"))


tab&lt;-table(liarozole)
tab

# Approximate simultaneous confidence intervals
# for the differences  pDose-pPlacebo:

LCI&lt;-binomRDci(tab, type="Dunnett", 
alternative="greater", method="ADD1")

LCI

plot(LCI, main="Proportion of patients
 with marked improvement")

# Perform a test on increasing trend 
# vs. the placebo group:

Ltest&lt;-binomRDtest(tab, type="Williams", 
alternative="greater", method="ADD1")

summary(Ltest)

</code></pre>

<hr>
<h2 id='lndest'>
Point and varioance estimates for expected and log(expected values) of lognormal samples
</h2><span id='topic+lndest'></span><span id='topic+lnrest'></span>

<h3>Description</h3>

<p>Compute the ML estimates of the expected values and the log of the expected values given several samples of lognormal data, separated by a factor variable. For internal use in <code>lndci</code> and <code>lnrci</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lndest(x, f)
lnrest(x, f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lndest_+3A_x">x</code></td>
<td>

<p>a numeric vector 
</p>
</td></tr>
<tr><td><code id="lndest_+3A_f">f</code></td>
<td>

<p>a factor variable (with at least two levels)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p> a numeric vector, the point estimates for each factor level</p>
</td></tr>
<tr><td><code>varest</code></td>
<td>
<p> a numeric vector, the variance estimates (evaluated at the point estimates) for each factor level</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p> a numeric vector, the sample size of each factor level</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chen, Y-H, Zhou, X-H (2006). Interval estimates for the ratio and the difference of two log-normal means. Statistics in Medicine 25, 4099-4113.
</p>

<hr>
<h2 id='lnrci'>
Simultaneous confidence intervals for expected values assuming lognormal distribution.
</h2><span id='topic+lnrci'></span><span id='topic+lndci'></span>

<h3>Description</h3>

<p>Simultaneous confidence intervals for multiple contrasts of expected values of several (K) groups in a one-way layout, assuming lognormal distribution of the response. Multiple ratios of (weighted geometric means of) expected values can be estimated as well as multiple differences of (weighted arithmetic means of) the expected values in the K groups can be estimated. For both, ratios and differences, a method based on asymptotic normality (not recommended) and a method based on generalized pivotal quantities are available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lnrci(x, f, type = "Dunnett", cmat = NULL,
 alternative = c("two.sided", "less", "greater"),
 conf.level = 0.95, method = c("GPQ", "AN"), ...)
lndci(x, f, type = "Dunnett", cmat = NULL,
 alternative = c("two.sided", "less", "greater"),
 conf.level = 0.95, method = c("GPQ", "AN"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lnrci_+3A_x">x</code></td>
<td>

<p>a numeric vector, the response variable, assumed to be lognormally distributed, should contain only positive values
</p>
</td></tr>
<tr><td><code id="lnrci_+3A_f">f</code></td>
<td>

<p>a factor variable, of the same length as <code>x</code>, groupingt the observations in <code>x</code>
</p>
</td></tr>
<tr><td><code id="lnrci_+3A_type">type</code></td>
<td>

<p>a single character string, naming a contrast type, see <a href="multcomp.html#topic+contrMat">contrMat</a> for the options; this argument is ignored if a contrast matrix is specified in <code>cmat</code>
</p>
</td></tr>
<tr><td><code id="lnrci_+3A_cmat">cmat</code></td>
<td>

<p>a matrix with numeric entries, containing contrast coefficients; if there are K levels in <code>f</code>, the matrix should have k columns
</p>
</td></tr>
<tr><td><code id="lnrci_+3A_alternative">alternative</code></td>
<td>

<p>a single character string, with options <code>"two.sided"</code> for two-sided confidence intervals, <code>"less"</code> for upper bounds only and <code>"greater"</code> for lower bounds only
</p>
</td></tr>
<tr><td><code id="lnrci_+3A_conf.level">conf.level</code></td>
<td>

<p>a single numeric value between 0 and 1
</p>
</td></tr>
<tr><td><code id="lnrci_+3A_method">method</code></td>
<td>

<p>a single character string, naming the method by which to compute the confidence intervals; options are <code>"GPQ"</code> for a method based on generalized pivotal quantities and <code>"AN"</code> for the asymptotic normal method (not recommended).
</p>
</td></tr>
<tr><td><code id="lnrci_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to the internal methods, in particular: Argument <code>B</code> specifies the number of samples to be drawn if method <code>"GPQ"</code> (defaults to 10000), it is ignored if <code>method="AN"</code>. Second, <code>dist</code> must be a single character string as in <code><a href="#topic+Waldci">Waldci</a></code>, invoking the use of multivariate normal quantiles <code>dist="MVN"</code> or standard normal quantiles <code>dist="N"</code> when <code>method="AN"</code>; it is ignored if <code>method="GPQ"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In a setting with K treatment groups, assuming a completely randomized design and lognormal distribution of the response variable, multiple (M) ratios or differences among expected values of the K treatment groups may be of interest. The ratios or differences of interest can be specified via a character string (in argument <code>type</code>) or via an M x K matrix in argument <code>cmat</code>. Intervals for ratios can be computed (via linear contrasts on the log scale) in function <code>lnrci</code>, differences can be computed in fucntion <code>lndci</code>. A simulation study of the methods implemented here can be found in Schaarschmidt (2013).
</p>
<p>By default, the confidence intervals are adjusted for multiple comparisons. The asymptotic normal methods, rely on maximum likelihood estimates for the expected values and the corresponding variance estimates (as given in Chen and Zhou, 2006) and adjut for multiplicity via critical value from the multivariate normal distribution (correlation structure with plug-in of variance estimates).
The generalized pivotal quantity methods rely on simulating the distribution of the parameters (number of samples B=10000 by default, Krishnamoorthy and Mathew, 2003; Chen and Zhou, 2006) and compute simultaneous intervals from this sample using the function <code>SCSrank</code>.
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p>a column vector, containing the point estimates of the contrasts</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>a Mx2 matrix of confidence bounds, if M comparisons among the K samples are invoked</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string, as input</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>a numeric value, as input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt</p>


<h3>References</h3>

<p><em>Schaarschmidt, F. (2013).</em> Simultaneous confidence intervals for multiple comparisons among expected values of log-normal variables. Computational Statistics and Data Analysis 58, 265-275
</p>
<p><em>Chen, Y-H, Zhou, X-H (2006).</em> Interval estimates for the ratio and the difference of two log-normal means.
Statistics in Medicine 25, 4099-4113.
</p>
<p><em>Krishnamoorthy K, Mathew T (2003).</em> Inferences on the means of lognormal distributions using generalized p-values and generalized confidence intervals. Journal of Statistical Planning and Inference 115, 103-121.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rlnorm(n=100, meanlog=rep(c(0,0.1,1,1), each=25), sdlog=0.5)
f &lt;- as.factor(rep(LETTERS[1:4], each=25))
boxplot(x~f)

lndci(x=x, f=f, type="Dunnett", method="GPQ", B=20000)
lndci(x=x, f=f, type="Dunnett", method="AN")

lnrci(x=x, f=f, type="Tukey", method="GPQ", B=20000)
lnrci(x=x, f=f, type="Tukey", method="AN")
</code></pre>

<hr>
<h2 id='methyl'> NTP bioassay data: effect of methyleugenol on skin fibroma</h2><span id='topic+methyl'></span>

<h3>Description</h3>

<p>NTP bioassay of methyleugenol: 200 male rats were randomly assigned to 4 treatment groups with balanced sample size 50.
Individuals in treatment group 0, 1, 2, and 3 received doses of 0, 37, 75, and 150 mg methyleugenol per kg body weight, respectively.
The response variable <kbd>tumour</kbd> is the presence of skin fibroma at time of death.
The variable <kbd>death</kbd> gives individual time of death, with a final sacrifice of surviving animals at 730 days after begin of the assay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(methyl)</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations on the following 3 variables.
</p>

<dl>
<dt>group</dt><dd><p>a factor with levels <kbd>0</kbd>, <kbd>1</kbd>, <kbd>2</kbd>, <kbd>3</kbd>, specifying dose groups 0, 37, 75, and 150 mg/kg, respectively</p>
</dd>
<dt>tumour</dt><dd><p>a numeric vector, specifying whether a tumour was present at time of death</p>
</dd>
<dt>death</dt><dd><p>a numeric vector, specifying the time of death</p>
</dd>
</dl>



<h3>Source</h3>

<p>National toxicology program (2000).
</p>


<h3>References</h3>

<p>SD Peddada, GE Dinse, JK Haseman (2005): A survival-adjusted quantal response test for comparing tumour incidence rates. Applied Statistics 54, 51-61. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(methyl)
# raw tumour proportions:
table(methyl[c("group", "tumour")])

# time of death:
boxplot(death~group, data=methyl, horizontal=TRUE)

</code></pre>

<hr>
<h2 id='mosaicdiv'> Mosaicplot for the data in Shannonci and Simpsonci</h2><span id='topic+mosaicdiv'></span>

<h3>Description</h3>

<p>Create a mosaicplot from objects of class Shannonci or Simpsonci
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mosaicdiv(x, decreasing = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mosaicdiv_+3A_x">x</code></td>
<td>
<p> an object of class <kbd>"Simpsonci"</kbd> or <kbd>"Shannonci"</kbd> as can be obtained from calling <a href="#topic+Simpsonci">Simpsonci</a> or <a href="#topic+Shannonci">Shannonci</a> </p>
</td></tr>
<tr><td><code id="mosaicdiv_+3A_decreasing">decreasing</code></td>
<td>
<p> a single logical value, indicating whether the species should be plotted in the current order (if <kbd>decreasing=NULL</kbd>),
in decreasing order (if <kbd>decreasing=TRUE</kbd>), or in increasing order (if <kbd>decreasing=FALSE</kbd>) </p>
</td></tr>
<tr><td><code id="mosaicdiv_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <kbd>mosaicplot</kbd>, see <kbd>?mosaicplot</kbd> and <kbd>?par</kbd> for details </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the counts in <kbd>[["sample.estimate"]][["table"]]</kbd> to produce a mosaicplot.
</p>


<h3>Value</h3>

<p>A plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(HCD)

HCDFam &lt;- HCD[,-1]

SCI&lt;-Simpsonci(X=HCDFam, f=HCD[,1])

mosaicdiv(SCI, decreasing=TRUE, col=rainbow(n=8))

</code></pre>

<hr>
<h2 id='multinomORci'>
Simultaneous confidence intervals for odds ratios comparing multiple odds and multiple treatments in a contingency table
</h2><span id='topic+multinomORci'></span>

<h3>Description</h3>

<p>Testversion. Two methods are provided to compute simultaneous confidence intervals for the comparison of several types of odds between several multinomial samples. Asymptotic Wald-type intervals (incl. replacing zero by some small number) as well as a method that computes simultaneous percentile intervals based on samples from the joint Dirichlet-posterior distribution with vague prior. A separate multinomial distribution is assumed for each row of the contingency table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multinomORci(Ymat, cmcat=NULL, cmgroup=NULL, cimethod = "DP", 
alternative = "two.sided", conf.level = 0.95, 
bycomp = FALSE, bychr = " btw ", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multinomORci_+3A_ymat">Ymat</code></td>
<td>
<p> a <code>matrix</code> or <code>table</code>: input data as a 2-dimensional contingency table, containing the counts of the categories in the different treatment groups, with rows of the table representing the treatment groups and columns of the table representing the categories. Also <code>data.frame</code>s can be provided given that they contain counts only. Names of treatments/groups may be attached as <code>row.names</code>, names of categories may be attached as <code>col.names</code>.</p>
</td></tr>
<tr><td><code id="multinomORci_+3A_cmcat">cmcat</code></td>
<td>
<p> a <code>matrix</code> or a <code>character</code> string: the contrast matrix that specifies which odds to compute between the categories. Column number of <code>cmcat</code> must be equal to the column number of <code>Ymat</code>; or, a <code>character</code> string (<code>"Dunnett", "Tukey"</code>) invoking baseline odds or all pairwise odds between categories; if <code>NULL</code> baseline odds are computed</p>
</td></tr>
<tr><td><code id="multinomORci_+3A_cmgroup">cmgroup</code></td>
<td>
<p>a <code>matrix</code> or a <code>character</code> string: the contrast matrix that specifies, which treatment groups should be compared. Column number of <code>cmgroup</code> must be equal to the row number of <code>Ymat</code>; or, a <code>character</code> string (<code>"Dunnett", "Tukey"</code>) invoking comparisons to the first group or all pairwise comparisons between groups; if <code>NULL</code> comparisons to control are computed</p>
</td></tr>
<tr><td><code id="multinomORci_+3A_cimethod">cimethod</code></td>
<td>
<p><code>character</code> string specifyoing the method for computation: <code>"DP"</code> invokes use of the sampling method based on the Drirchlet posterior with vague prior; <code>"Wald"</code> invokes use of an asmptotic method;
</p>
</td></tr>
<tr><td><code id="multinomORci_+3A_alternative">alternative</code></td>
<td>
<p>single <code>character</code> string: <code>"two.sided"</code>: two-sicded intervals; <code>"less"</code> intervals with upper limits only; <code>"greater"</code> intervals with lower limits only.
</p>
</td></tr>
<tr><td><code id="multinomORci_+3A_conf.level">conf.level</code></td>
<td>
<p>single number: the simultaneous confidcence level</p>
</td></tr>
<tr><td><code id="multinomORci_+3A_bycomp">bycomp</code></td>
<td>
<p>logical, if <code>bycomp=FALSE</code> parameters are ordered by odds first; if <code>bycomp=TRUE</code> parameters are ordered by between-group-comparison first</p>
</td></tr>
<tr><td><code id="multinomORci_+3A_bychr">bychr</code></td>
<td>
<p>character string separating the name of the odds from the name of the between group comparison in the output
</p>
</td></tr>
<tr><td><code id="multinomORci_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to the internal functions: if <code>cimethod = "DP"</code> argument BSIM (defaults to <code>BSIM=10000</code>) 
defines the number of samples drwan from the Dirichlet posterior, and <code>prior</code> allows to define a single number, vector or matrix of alpha-parameters for the Dirichlet prior. If not specified, Dirichlet(1,1,...,1) is used as a prior, independent for each treatemnet group.
if <code>cimethod = "Wald"</code>, argument <code>addx</code> sets the quantity to be added to each cell/row/total of the contingency table.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Testversion.
</p>


<h3>Value</h3>

<p>A list with items
</p>
<table>
<tr><td><code>SCI</code></td>
<td>
<p> a <code>data.frame</code> with names of comprisons as well as the lower and upper confidence limits</p>
</td></tr>
<tr><td><code>details</code></td>
<td>
<p>a list with computational details depending on the <code>cimethod</code>:  for <code>"DP"</code>, the prior parameters, the complete sample from posterior, etc.) , for <code>"Wald"</code>-type (observations added to the table, estimated correlation matrix and covariance matrix, mulivariate normal quantiles) </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.data.frame.multinomORci">as.data.frame.multinomORci</a></code>, <code><a href="#topic+print.multinomORci">print.multinomORci</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Randomized clinical trial 2 treatment groups (injection of saline or sterile water)
# to cure chronic pain after whiplash injuries. Response are 3 (ordered) categories,
# 'no change', 'improved', 'much improved'. Source: Hand, Daly, Lunn, McConway,
# Ostrowski (1994): A handbook of small data sets. Chapman &amp; Hall, Example 124, page 993


dwi &lt;- data.frame("no.change"=c(1,14), "improved"=c(9,3), "much.improved"=c(10,3))
rownames(dwi) &lt;- c("sterile3", "saline3")

dwi

DP1dwi &lt;- multinomORci(Ymat=dwi, cmcat="Dunnett", cmgroup="Tukey", cimethod="DP", BSIM=5000)
DP1dwi 

# at logit-scale (i.e., not backtransformation)
print(DP1dwi , exp=FALSE)

## Not run: 
# Compute asymptotic Wald-type intervals
Waldwbc &lt;- multinomORci(Ymat=dwi, cmcat="Dunnett", cmgroup="Tukey", cimethod="Wald")
Waldwbc
print(Waldwbc, exp=FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.sci'> Plot confidence intervals </h2><span id='topic+plot.sci'></span><span id='topic+plot.binomRDci'></span><span id='topic+plot.binomORci'></span><span id='topic+plot.binomRRci'></span><span id='topic+plot.Shannonci'></span><span id='topic+plot.Simpsonci'></span><span id='topic+plot.poly3ci'></span>

<h3>Description</h3>

<p>Function for convenient plotting of confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sci'
plot(x, ...)
## S3 method for class 'binomRDci'
plot(x, ...)
## S3 method for class 'binomORci'
plot(x, ...)
## S3 method for class 'binomRRci'
plot(x, ...)
## S3 method for class 'poly3ci'
plot(x, ...)
## S3 method for class 'Shannonci'
plot(x, ...)
## S3 method for class 'Simpsonci'
plot(x, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.sci_+3A_x">x</code></td>
<td>
<p> an object of class <kbd>"binomRDci"</kbd>, <kbd>"binomORci"</kbd>, <kbd>"binomRRci"</kbd>, <kbd>"poly3ci"</kbd>, <kbd>"sci"</kbd> </p>
</td></tr>
<tr><td><code id="plot.sci_+3A_...">...</code></td>
<td>
<p> further arguments as described in <a href="#topic+plotCI">plotCI</a> </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts some values and calls <a href="#topic+plotCI">plotCI</a>.
</p>


<h3>Value</h3>

<p>A plot.
</p>

<hr>
<h2 id='plotCI'> Plot confidence intervals </h2><span id='topic+plotCI'></span><span id='topic+plotCI.default'></span><span id='topic+plotCI.sci'></span><span id='topic+plotCI.sci.ratio'></span><span id='topic+plotCI.confint.glht'></span>

<h3>Description</h3>

<p>A function for convenient plotting of confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
plotCI(x, ...)
## S3 method for class 'sci'
plotCI(x, ...)
## S3 method for class 'sci.ratio'
plotCI(x, ...)
## S3 method for class 'confint.glht'
plotCI(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCI_+3A_x">x</code></td>
<td>
<p> An object of class &quot;sci&quot;, &quot;sci.ratio&quot; or &quot;conf.int.glht&quot; or a list with elements <kbd>estimate</kbd>, containing a numeric vector,<kbd>conf.int</kbd>, containing a matrix with two columns, giving the lower and upper bounds, and a string <kbd>alternative</kbd>, one of &quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;  </p>
</td></tr>
<tr><td><code id="plotCI_+3A_...">...</code></td>
<td>
<p> additional arguments to be passed to <a href="#topic+plotCII">plotCII</a> and <a href="base.html#topic+plot">plot</a>, see <a href="#topic+plotCII">plotCII</a> for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots the estimates, upper and lower limits using <kbd>points</kbd> and <kbd>segments</kbd>. The names of <kbd>estimate</kbd> are passed as labels of the confidence intervals.
If infinite bounds occur, the plot region is limited by the most extreme non infinite bound or estimate.
</p>


<h3>Value</h3>

<p>A plot.
</p>


<h3>See Also</h3>

<p> Internally, the function <a href="#topic+plotCII">plotCII</a> is used.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x=c(8,9,9,18,39,44)
n=c(2000,2000,2000,2000,2000,2000)

x&lt;-binomORci(x=x, n=n, names=c("0","120","240","480","600","720"))

plotCI(x, lines=1)


</code></pre>

<hr>
<h2 id='plotCII'> Plot confidence intervals </h2><span id='topic+plotCII'></span>

<h3>Description</h3>

<p>A function for convenient plotting of confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCII(estimate, lower = NULL, upper = NULL,
 alternative = c("two.sided", "less", "greater"),
 lines = NULL, lineslty = 2, lineslwd = 1, 
 linescol = "black", CIvert = FALSE, CIlty = 1,
 CIlwd = 1, CIcex = 1, CIcol = "black", CIlength=NULL,
 HL = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCII_+3A_estimate">estimate</code></td>
<td>
<p> a (named) numeric vector, the names of the elements are taken as labels of the CI </p>
</td></tr>
<tr><td><code id="plotCII_+3A_lower">lower</code></td>
<td>
<p> an optional numeric vector, of the same length as estimate </p>
</td></tr>
<tr><td><code id="plotCII_+3A_upper">upper</code></td>
<td>
<p> an optional numeric vector, of the same length as estimate </p>
</td></tr>
<tr><td><code id="plotCII_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, one of <code>"two.sided"</code>, <code>"less"</code>, <code>"greater"</code> </p>
</td></tr>
<tr><td><code id="plotCII_+3A_lines">lines</code></td>
<td>
<p> an optional numeric (vector) giving the position(s) of line(s) to draw into the plots orthogonal to the confidence intervals </p>
</td></tr>
<tr><td><code id="plotCII_+3A_lineslty">lineslty</code></td>
<td>
<p> possible a vector of line type of the <code>lines</code>, see the options for <code>lty</code> in <code><a href="graphics.html#topic+par">par</a></code> </p>
</td></tr>
<tr><td><code id="plotCII_+3A_lineslwd">lineslwd</code></td>
<td>
<p> possible a vector of line width of the <code>lines</code>, see the options for <code>lwd</code> in <code><a href="graphics.html#topic+par">par</a></code> </p>
</td></tr>
<tr><td><code id="plotCII_+3A_linescol">linescol</code></td>
<td>
<p> possible a vector of line colors of the <code>lines</code> </p>
</td></tr>
<tr><td><code id="plotCII_+3A_civert">CIvert</code></td>
<td>
<p> logical indicating, whether confidence intervals shall be drawn horizontal (default), or vertical (if set to TRUE) </p>
</td></tr>
<tr><td><code id="plotCII_+3A_cilty">CIlty</code></td>
<td>
<p> single value, to specify the line type used for the CI, see options for <code>lty</code> in <code>?par</code> </p>
</td></tr>
<tr><td><code id="plotCII_+3A_cilwd">CIlwd</code></td>
<td>
<p> single value, to specify the width type used for the CI, see options for <code>lty</code> in <code>?par</code>  </p>
</td></tr>
<tr><td><code id="plotCII_+3A_cicex">CIcex</code></td>
<td>
<p> single value, to specify the extension of sympols in the plot, see options for <code>cex</code> in <code>?par</code>  </p>
</td></tr>
<tr><td><code id="plotCII_+3A_cicol">CIcol</code></td>
<td>
<p> single value, to specify the color used for the CI  </p>
</td></tr>
<tr><td><code id="plotCII_+3A_cilength">CIlength</code></td>
<td>
<p> single numeric value, to be passed to the argument <kbd>length</kbd> in function <a href="graphics.html#topic+arrows">arrows</a>; to specify the lengths of the CI bounds (in inches); defaults to 0.08 and 0.05 for less than 25 and more than 25 CIs, respectively </p>
</td></tr>
<tr><td><code id="plotCII_+3A_hl">HL</code></td>
<td>
<p> a logical, if TRUE (default), plot margins of the are adjusted depending on the length of the names by appropriate calls to <kbd>par</kbd>; this might be incompatible with combining the plot with others in the same device. If set to FALSE, 
its up to the user to choose appropriate plot margins by calling to <kbd>par</kbd>.   </p>
</td></tr>
<tr><td><code id="plotCII_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <kbd>plot</kbd>  </p>
</td></tr>
</table>


<h3>See Also</h3>

 <p><a href="#topic+plotCI">plotCI</a>, for more convenient methods </p>


<h3>Examples</h3>

<pre><code class='language-R'>

est&lt;-c(1,2,3)
names(est)&lt;-c("A", "B", "C")
lw=c(0,1,2)
up=c(2,3,4)

plotCII(estimate=est, lower=lw, upper=up)


plotCII(estimate=est, lower=lw, upper=up,
lines=c(-1,0,1),
lineslty=c(3,1,3),
lineslwd=c(1,2,1))

###########

names(est)&lt;-c("very long names",
 "e v e n  l o n g e r  n a m e s", "C")

plotCII(estimate=est, lower=lw, upper=up,
 CIcol=c("black","green","red"),
 HL=TRUE
)

###########


names(est)&lt;-c("very long names", 
 "e v e n  l o n g e r  n a m e s", "C")

plotCII(estimate=est, lower=lw, upper=up,
 CIcol=c("black","green","red"),
 HL=TRUE
)

op&lt;-par(no.readonly = TRUE)

layout(matrix(1:2, ncol=1))

par(mar=c(5,14,3,1))

plotCII(estimate=est, lower=lw, upper=up,
 main="Lala 1",
 CIcol=c("black","green","red"),
 lines=-1,
 HL=FALSE
)


plotCII(estimate=est, lower=lw, upper=up,
 main="Lala 2",
 CIcol=c("black","green","red"),
 lines=c(0,1),
 HL=FALSE
)

par(op)


</code></pre>

<hr>
<h2 id='poly3ci'> Simultaneous confidence intervals for contrasts of poly-3-adjusted tumour rates</h2><span id='topic+poly3ci'></span>

<h3>Description</h3>

<p>Function to calculate simultaneous confidence intervals for several contrasts
of poly-3-adjusted tumour rates in a oneway layout.
Assuming a data situation as in Peddada(2005) or Bailer and Portier (1988).
Simultaneous asymptotic CI for contrasts of tumour rates, assuming that
standard normal approximation holds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly3ci(time, status, f, type = "Dunnett",
 cmat = NULL, method = "BP", alternative = "two.sided",
 conf.level = 0.95, dist="MVN", k=3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poly3ci_+3A_time">time</code></td>
<td>
<p> a numeric vector of times of death of the individuals</p>
</td></tr>
<tr><td><code id="poly3ci_+3A_status">status</code></td>
<td>
<p> a logical (or numeric, consisting of 0,1 only) vector giving the tumour status at time of death of each individual,
where TRUE (1) = tumour present, FALSE (0) = no tumour present  </p>
</td></tr>
<tr><td><code id="poly3ci_+3A_f">f</code></td>
<td>
<p> a factor, giving the classification variable </p>
</td></tr>
<tr><td><code id="poly3ci_+3A_type">type</code></td>
<td>
<p> a character string, giving the name of a contrast method, as defined in <kbd>contrMat(multcomp)</kbd> </p>
</td></tr>
<tr><td><code id="poly3ci_+3A_cmat">cmat</code></td>
<td>
<p> a optional contrast matrix </p>
</td></tr>
<tr><td><code id="poly3ci_+3A_method">method</code></td>
<td>
<p> a single charcter string, specifying the method for adjustment,
with options: &quot;BP&quot; (Bailer Portier: assuming poly-3-adjusted rates are binomial variables),
&quot;BW&quot; (Bieler, Williams: delta method as in Bieler and Williams (1993))
&quot;ADD1&quot; (as Bailer Portier, including an add1-adjustment on the raw tumour rates)
&quot;ADD2&quot; (as Bailer Portier, including an add2-adjustment on the raw tumour rates following Agresti and Caffo (2000) for binomials)
</p>
</td></tr>
<tr><td><code id="poly3ci_+3A_alternative">alternative</code></td>
<td>
<p> a single character string </p>
</td></tr>
<tr><td><code id="poly3ci_+3A_conf.level">conf.level</code></td>
<td>
<p> a single numeric value, simultaneous confidence level </p>
</td></tr>
<tr><td><code id="poly3ci_+3A_dist">dist</code></td>
<td>
<p>a character string, <kbd>"MVN"</kbd> invokes multiplicity adjustment via the multivariate normal distribution,
<kbd>"N"</kbd> invokes use of quantiles of the univariate normal distribution</p>
</td></tr>
<tr><td><code id="poly3ci_+3A_k">k</code></td>
<td>
<p>the exponent to calculate survival adjusted proportions, default is k=3</p>
</td></tr>
<tr><td><code id="poly3ci_+3A_...">...</code></td>
<td>
<p>further arguments to be passed; currently only base, to be passed to <kbd>contrMat</kbd> to choose the control group with <kbd>type="Dunnett"</kbd></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A object of class &quot;poly3ci&quot;, a list containing:
</p>
<table>
<tr><td><code>conf.int</code></td>
<td>
<p>a matrix with 2 columns: lower and upper confidence bounds, and M rows</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>character string, as input</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>single numeric value, as input</p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p>the quantile used to construct the CIs</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p> a numeric vector with the point estimates of the contrasts</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p> as input</p>
</td></tr>
<tr><td><code>status</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p>as input, with colnames= factor levels of f</p>
</td></tr>
<tr><td><code>sample.est</code></td>
<td>
<p>a list containing sample estimates</p>
</td></tr>
</table>


<h3>Note</h3>

<p> Please note that all methods here described are only approximative, and might violate the nominal level in certain situations.
Please note further that appropriateness of the point estimates, and consequently of tests and confidence intervals is based on the assumptions in Bailer and Portier (1988),
which might be a matter of controversies. </p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>References</h3>

 
<p>The implemented methodology is described in:
</p>
<p>Schaarschmidt, F., Sill, M., and Hothorn, L.A. (2008):
Approximate Simultaneous confidence intervals for multiple contrasts of binomial proportions.
Biometrical Journal 50, 782-792.
</p>
<p>Background references are:
</p>
<p>Assumption for poly-3-adjustment:
Bailer, J.A. and Portier, C.J. (1988):
Effects of treatment-induced mortality and tumor-induced mortality on tests for carcinogenicity in small samples.
Biometrics 44, 417-431.
</p>
<p>Peddada, S.D., Dinse, G.E., and Haseman, J.K. (2005):
A survival-adjusted quantal response test for comparing tumor incidence rates.
Applied Statistics 54, 51-61.
</p>
<p>Bieler, G.S. and Williams, R.L. (1993):
Ratio estimates, the Delta Method, and quantal response tests for increased carcinogenicity.
Biometrics 49, 793-801.
</p>
<p>Statistical procedures and characterization of the coverage probabilities are described in:
Sill, M. (2007):
Approximate simultaneous confidence intervals for multiple comparisons of binomial proportions.
Master thesis, Institute of Biostatistics, Leibniz University Hannover.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#############################################################

### Methyleugenol example in Schaarschmidt et al. (2008) ####

#############################################################

# load the data:

data(methyl)

# The results in Table 5 (Schaarschmidt et al. 2008) can be
# reproduced by calling:


methylW&lt;-poly3ci(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Williams", method = "ADD1", alternative="greater" )

methylW


methylWT&lt;-poly3test(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Williams", method = "ADD1", alternative="greater" )

methylWT


plot(methylW, main="Simultaneous CI for \n Poly-3-adjusted tumour rates")

# The results in Table 6 can be reproduced by calling:

methylD&lt;-poly3ci(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Dunnett", method = "ADD1", alternative="greater" )

methylD

methylDT&lt;-poly3test(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Dunnett", method = "ADD1", alternative="greater" )

methylDT


plot(methylD, main="Simultaneous CI for Poly-3-adjusted tumour rates", cex.main=0.7)


############################################################


# unadjusted CI

methylD1&lt;-poly3ci(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Dunnett", method = "ADD1", dist="N" )

methylD1

plot(methylD1, main="Local CI for Poly-3-adjusted tumour rates")

</code></pre>

<hr>
<h2 id='poly3est'> Only for internal use. </h2><span id='topic+poly3est'></span>

<h3>Description</h3>

<p>Poly-3- adjusted point and variance estimates for long term carcinogenicity data 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly3est(time, status, tmax, method = "BP", k=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poly3est_+3A_time">time</code></td>
<td>
<p>  a numeric vector of times of death of the individuals</p>
</td></tr>
<tr><td><code id="poly3est_+3A_status">status</code></td>
<td>
<p>  a logical (or numeric, consisting of 0,1 only) vector giving the tumour status at time of death of each individual,
where TRUE (1) = tumour present, FALSE (0) = no tumour present  </p>
</td></tr>
<tr><td><code id="poly3est_+3A_tmax">tmax</code></td>
<td>
<p> a single numeric vector, the final time of the trial </p>
</td></tr>
<tr><td><code id="poly3est_+3A_method">method</code></td>
<td>
<p> a single charcter string, specifying the method for adjustment,
with options: &quot;BP&quot; (Bailer Portier: assuming poly-3-adjusted rates are binomial variables),
&quot;BW&quot; (Bieler, Williams: delta method as in Bieler-Williams (1993))
&quot;ADD1&quot; (as Bailer Portier, including an add1-adjustment on the raw tumour rates)
&quot;ADD2&quot; (as Bailer Portier, including an add2-adjustment on the raw tumour rates following Agresti Caffo (2000) for binomials)
</p>
</td></tr>
<tr><td><code id="poly3est_+3A_k">k</code></td>
<td>
<p>a single numeric value, the exponent to calculate survival adjusted proportions according to Bailer and Portier (1988), defaults to 3</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only for internal use of <a href="#topic+poly3test">poly3test</a> and <a href="#topic+poly3ci">poly3ci</a>.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>Y</code></td>
<td>
<p>number of tumours</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of individuals</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>poly-3-adjusted rates according to Bailer, Portier (1988)</p>
</td></tr>
<tr><td><code>weight</code></td>
<td>
<p>a vector of poly-3-adjusted weights, of length n </p>
</td></tr>
<tr><td><code>estp</code></td>
<td>
<p>poly-3-adjusted rate (according to method)</p>
</td></tr>
<tr><td><code>nadj</code></td>
<td>
<p>adjusted n (sum of weights)</p>
</td></tr>
<tr><td><code>varp</code></td>
<td>
<p> variance estimate (according to method)</p>
</td></tr>
<tr><td><code>varcor</code></td>
<td>
<p> variance estimate, if necessary corrected such that estimates of 0 can not occur</p>
</td></tr>
</table>


<h3>Note</h3>

<p> Please note, that appropriateness of the point estimates seriously depends on whether the assumptions in Bailer and Portier are met or not. </p>


<h3>References</h3>

<p>Bailer, J.A. and Portier, C.J. (1988):
Effects of treatment-induced mortality and tumor-induced mortality on tests for carcinogenicity in small samples.
Biometrics 44, 417-431.</p>

<hr>
<h2 id='poly3estf'> Only for internal use. </h2><span id='topic+poly3estf'></span>

<h3>Description</h3>

<p>Poly-3- adjusted point and variance estimates for long term carcinogenicity data if data are given as a numeric time vector,
a logical status vector and a factor containing a grouping variable </p>


<h3>Usage</h3>

<pre><code class='language-R'>poly3estf(time, status, tmax=NULL, f, method = "BP", k=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poly3estf_+3A_time">time</code></td>
<td>
<p>  a numeric vector of times of death of the individuals</p>
</td></tr>
<tr><td><code id="poly3estf_+3A_status">status</code></td>
<td>
<p>  a logical (or numeric, consisting of 0,1 only) vector giving the tumour status at time of death of each individual,
where TRUE (1) = tumour present, FALSE (0) = no tumour present  </p>
</td></tr>
<tr><td><code id="poly3estf_+3A_tmax">tmax</code></td>
<td>
<p> a single numeric value, the time of sacrifice in the trial, or the last last time of death, defaults to the maximal value observed in <kbd>time</kbd> </p>
</td></tr>
<tr><td><code id="poly3estf_+3A_f">f</code></td>
<td>
<p>  a factor of the same length as <kbd>time</kbd>, <kbd>status</kbd>, giving the levels of a grouping variable in a one-way layout </p>
</td></tr>
<tr><td><code id="poly3estf_+3A_method">method</code></td>
<td>
<p> a single charcter string, specifying the method for adjustment,
with options: &quot;BP&quot; (Bailer Portier: assuming poly-3-adjusted rates are binomial variables),
&quot;BW&quot; (Bieler, Williams: delta method as in Bieler-Williams (1993))
&quot;ADD1&quot; (as Bailer Portier, including an add1-adjustment on the raw tumour rates)
&quot;ADD2&quot; (as Bailer Portier, including an add2-adjustment on the raw tumour rates following Agresti Caffo (2000) for binomials)
</p>
</td></tr>
<tr><td><code id="poly3estf_+3A_k">k</code></td>
<td>
<p>a single numeric value, the exponent to calculate survival adjusted proportions according to Bailer and Portier (1988), defaults to 3</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>Y</code></td>
<td>
<p>a numeric vector, groupwise number of tumours</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p> a numeric vector, groupwise number of individuals</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p> a numeric vector, groupwise poly-3-adjusted rates according to Bailer, Portier (1988)</p>
</td></tr>
<tr><td><code>weight</code></td>
<td>
<p>a numeric vector of poly-3-adjusted weights </p>
</td></tr>
<tr><td><code>estp</code></td>
<td>
<p>a numeric vector, groupwise poly-3-adjusted rate (according to method)</p>
</td></tr>
<tr><td><code>nadj</code></td>
<td>
<p>adjusted n (sum of weights)</p>
</td></tr>
<tr><td><code>varp</code></td>
<td>
<p>a numeric vector, groupwise variance estimate (according to method)</p>
</td></tr>
<tr><td><code>varcor</code></td>
<td>
<p>a numeric vector, groupwise variance estimate, if necessary corrected such that estimates of 0 can not occur</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p>a character vector, the levels of the grouping variable <kbd>f</kbd> </p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>a single numeric value, as input</p>
</td></tr>
</table>


<h3>Note</h3>

<p> See <a href="#topic+poly3est">poly3est</a></p>


<h3>References</h3>

<p> See <a href="#topic+poly3est">poly3est</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(bronch)

poly3estf(status=bronch$Y, time=bronch$time, f=bronch$group, k=3)

poly3estf(status=bronch$Y, time=bronch$time, f=bronch$group, k=5)

</code></pre>

<hr>
<h2 id='poly3table'> Summarize long term carcinogenicity data </h2><span id='topic+poly3table'></span>

<h3>Description</h3>

<p>Function to summarize data of long term carcinogenicity trials in a text format.
Data are assumed to consist of (1) a dichotomous variable, 
defining whether the tumour of interest was present in an individual animal at time of death,
and (2) a numeric variable containing the time of death of an individual animal,
and (3) a grouping factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly3table(time, status, f, tumour = NULL, symbol = "*")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poly3table_+3A_time">time</code></td>
<td>
<p> a numeric vector, containing the time of death of an individual </p>
</td></tr>
<tr><td><code id="poly3table_+3A_status">status</code></td>
<td>
<p> a logical (or dichotomous categorical) vector </p>
</td></tr>
<tr><td><code id="poly3table_+3A_f">f</code></td>
<td>
<p> a factor, specifying treatment groups</p>
</td></tr>
<tr><td><code id="poly3table_+3A_tumour">tumour</code></td>
<td>
<p> the value which <kbd>status</kbd> obtains if a tumour is present in an individual at time of death  </p>
</td></tr>
<tr><td><code id="poly3table_+3A_symbol">symbol</code></td>
<td>
<p> symbol to indicate presence of tumour in the text representation </p>
</td></tr>
</table>


<h3>Value</h3>

<p> A named list, containing a character string for each group
</p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(methyl)
methyl
poly3table(time=methyl$death, status=methyl$tumour,
 f=methyl$group, tumour = 1, symbol = "*")

</code></pre>

<hr>
<h2 id='poly3test'> Approximate simultaneous test for poly-3-adjusted tumour rates </h2><span id='topic+poly3test'></span>

<h3>Description</h3>

<p>P-value of maximum test and adjusted p-values for M contrasts of I groups in a one-way layout.
Based on approximation of the true distribution of the M test statistics by an M-variate normal distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poly3test(time, status, f, type = "Dunnett",
 cmat = NULL, method = "BP", alternative = "two.sided",
dist="MVN", k=3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poly3test_+3A_time">time</code></td>
<td>
<p>  a numeric vector of times of death of the individuals</p>
</td></tr>
<tr><td><code id="poly3test_+3A_status">status</code></td>
<td>
<p>  a logical (or numeric, consisting of 0,1 only) vector giving the tumour status at time of death of each individual,
where TRUE (1) = tumour present, FALSE (0) = no tumour present  </p>
</td></tr>
<tr><td><code id="poly3test_+3A_f">f</code></td>
<td>
<p>  a factor of the same length as <kbd>time</kbd>, <kbd>status</kbd>, giving the levels of a grouping variable in a one-way layout </p>
</td></tr>
<tr><td><code id="poly3test_+3A_type">type</code></td>
<td>
<p> a character string specifying the contrast type </p>
</td></tr> 
<tr><td><code id="poly3test_+3A_cmat">cmat</code></td>
<td>
<p>an optional user defined contrast matrix of dimension MxI</p>
</td></tr>
<tr><td><code id="poly3test_+3A_method">method</code></td>
<td>
<p> a single charcter string, specifying the method for adjustment,
with options: &quot;BP&quot; (Bailer Portier: assuming poly-3-adjusted rates are binomial variables),
&quot;BW&quot; (Bieler, Williams: delta method as in Bieler-Williams (1993))
&quot;ADD1&quot; (as Bailer Portier, including an add1-adjustment on the raw tumour rates)
&quot;ADD2&quot; (as Bailer Portier, including an add2-adjustment on the raw tumour rates following Agresti Caffo (2000) for binomials)
</p>
</td></tr>
<tr><td><code id="poly3test_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the direction of the alternative hypothesis</p>
</td></tr>
<tr><td><code id="poly3test_+3A_dist">dist</code></td>
<td>
<p>a character string, where <kbd>"MVN"</kbd> invokes the computation of p-values using the multivariate normal distribution,
and <kbd>"N"</kbd> invokes use p-value computation using the univariate normal distribution</p>
</td></tr>
<tr><td><code id="poly3test_+3A_k">k</code></td>
<td>
<p>a single numeric value, the exponent to calculate survival adjusted proportions according to Bailer and Portier (1988), defaults to 3</p>
</td></tr>
<tr><td><code id="poly3test_+3A_...">...</code></td>
<td>
<p>further arguments to be passed; currently only <kbd>base</kbd>, to choose the control group with <kbd>type="Dunnett"</kbd></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Testversion.
</p>


<h3>Value</h3>

<p> An object of class &quot;poly3test&quot;, a list containing:
</p>
<table>
<tr><td><code>teststat</code></td>
<td>
<p>a numeric vector of teststatistics of length M</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>a single numeric p-value, the p-value of the maximum test (minimum p-value)</p>
</td></tr> 
<tr><td><code>p.val.adj</code></td>
<td>
<p> a vector of length M, the adjusted p-values of the single contrasts</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a single character vector, as the input</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>a character string specifying which distribution</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p> as input</p>
</td></tr>
<tr><td><code>status</code></td>
<td>
<p> as input</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p> as input</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>as input</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p> used contrast matrix</p>
</td></tr>
<tr><td><code>sample.est</code></td>
<td>
<p>a list containing sample estimates</p>
</td></tr>
</table>


<h3>Note</h3>

<p> Please note that all methods here described are only approximative, and might violate the nominal level in certain situations.
Please note further that appropriateness of the point estimates, and consequently of tests and confidence intervals is based on the assumptions in Bailer and Portier (1988),
which might be a matter of controversies.  </p>


<h3>References</h3>

<p>Assumptions corresponding to the poly-k-adjustment:
</p>
<p>Bailer, J.A. and Portier, C.J. (1988):
Effects of treatment-induced mortality and tumor-induced mortality on tests for carcinogenicity in small samples.
Biometrics 44, 417-431.
</p>
<p>Peddada, S.D., Dinse, G.E., and Haseman, J.K. (2005):
A survival-adjusted quantal response test for comparing tumor incidence rates.
Applied Statistics 54, 51-61.
</p>
<p>Statistical procedures and characterization of coverage probabilities are described in:
Sill, M. (2007):
Approximate simultaneous confidence intervals for multiple comparisons of binomial proportions.
Master thesis, Institute of Biostatistics, Leibniz University Hannover.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# poly-3-adjusted tumour rates with a potential
# down-turn effect for the highest dose group "4":

data(methyl)

# many-to-one:
methylD&lt;-poly3test(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Dunnett", method = "ADD1")

methylD

# Williams-Contrast:
methylW&lt;-poly3test(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Williams", method = "ADD1", alternative="greater" )

methylW

# Changepoint-Contrast:
methylCh&lt;-poly3test(time=methyl$death, status=methyl$tumour,
 f=methyl$group, type = "Change", method = "ADD1", alternative="greater" )

methylCh

</code></pre>

<hr>
<h2 id='powerbinom'>
Approximate power for multiple contrast tests of binomial proportions.
</h2><span id='topic+powerbinom'></span><span id='topic+powerbinomOR'></span>

<h3>Description</h3>

<p>Approximative power calculation for multiple contrast tests of binomial proportions (based on risk differences, or odds ratios), based on probabilities of the multivariate standard normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerbinom(p, n, alpha = 0.05, type = "Dunnett", cmat = NULL,
 rhs = 0, alternative = c("two.sided", "less", "greater"),
 ptype = c("global", "anypair", "allpair"), method = "Wald", crit = NULL, ...)

powerbinomOR(p, n, alpha = 0.05, type = "Dunnett", cmat = NULL, 
    rhs = 1, alternative = c("two.sided", "less", "greater"), 
    ptype = c("global", "anypair", "allpair"), 
    crit = NULL, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerbinom_+3A_p">p</code></td>
<td>
<p> a numeric vector of assumed true proportions under the alternative hypothesis where <code>length(p)</code> is the number of (treatment) groups in the multiple comparison problem
</p>
</td></tr>
<tr><td><code id="powerbinom_+3A_n">n</code></td>
<td>

<p>a vector (of integer values), the number of observations per (treatment) group, must have the same length as <code>p</code> </p>
</td></tr>
<tr><td><code id="powerbinom_+3A_alpha">alpha</code></td>
<td>

<p>a single numeric value, the alpha-level of the test, default is 0.05
</p>
</td></tr>
<tr><td><code id="powerbinom_+3A_type">type</code></td>
<td>

<p>a single charcater string naming the type of multiple contrast test to be applied on the proportions <kbd>p</kbd>; will be ignored if argument <code>cmat</code> is specified; for possible choices, see <code><a href="multcomp.html#topic+contrMat">contrMat</a></code>
</p>
</td></tr>
<tr><td><code id="powerbinom_+3A_cmat">cmat</code></td>
<td>

<p>optional, a matrix fo contrast coefficients (with number of columns = number of treatmenmt groups and number of rows = number of comparisons); if <code>cmat</code> is not specified, the type of multiple contrast test to be applied on the proportions <code>p</code> is chosen according to argument <code>type</code>
</p>
</td></tr>
<tr><td><code id="powerbinom_+3A_rhs">rhs</code></td>
<td>

<p>a (vector of) numeric value(s), specifying the right hand sides of the alternative hypotheses, default is 0 for the risk difference (<kbd>powerbinom</kbd>), and 1 for the odds ratio (<kbd>powerbinomOR</kbd>), if values greater or less than the default are specified, power for shifted tests (non-inferiority, superiority) is computed; Note that the latter primarily makes sense for one-sided hypotheses. A warning is given when <code>alternative ="two.sided"</code> with <code>rhs!=0</code> or <code>rhs!=1</code> for difference or oddsratios, respectively.
</p>
</td></tr>
<tr><td><code id="powerbinom_+3A_alternative">alternative</code></td>
<td>

<p>a character string, specifying the direction of the alternative hypotheses, options are &quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;; <code>alternative</code> primarily controls for which directional decisions power is calculated, in case that argument <code>crit</code> is not specified, <code>alternative</code> also controls the choice of the critical value.
</p>
</td></tr>
<tr><td><code id="powerbinom_+3A_ptype">ptype</code></td>
<td>
<p> a single character string, naming the type of rejection probability to be computed; options are <code>"global"</code> for the overall rejection probability (irrespective which contrasts are under the null or the alternative), <code>"anypair"</code> for the rejection probability considering only those contrasts under the alternative, <code>"global"</code> for the probability that all elementary alternatives are rejected. 
</p>
</td></tr>
<tr><td><code id="powerbinom_+3A_method">method</code></td>
<td>

<p>a character string, the method for variance estimation in test / confidence interval construction: one of &quot;Wald&quot;, &quot;ADD1&quot;, &quot;ADD2&quot;.
</p>
</td></tr>
<tr><td><code id="powerbinom_+3A_crit">crit</code></td>
<td>

<p>a single numeric value to serve as equicoordinate critical point in the multiple test; if it is not specified, it is computed as a quantile of the multivariate normal distribution based on the specifications in arguments <code>n</code>, <code>cmat</code> (or <code>type</code>); note that for alternatives <code>'two.sided'</code> and <code>'greater'</code>, <code>crit</code> should be a single positive value, while for alternative <code>'less'</code>, <code>crit</code> should be a single negative value. 
</p>
</td></tr>
<tr><td><code id="powerbinom_+3A_...">...</code></td>
<td>

<p>further arguments, which are passed to the functions <code>qmvnorm</code> and <code>pmvnorm</code>, mainly to control the computation errors, see <code>GenzBretz</code> in package <code>mvtnorm</code> for details
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For (standard type and user-defined) multiple contrast tests of proportions in 2xk contigency tables assuming the binomial distribution and k treatment groups, different types of rejection probabilities in the multiple testing problem can be computed.
Based on a central multivariate normal distribution, equicoordinate critical points for the test are computed, different critical points for the test can be specified in <code>crit</code>.
</p>
<p>Via computing probabilities of non-central multivariate normal distributions <code>pmvt(mvtnorm)</code> one can calculate:
</p>
<p>The global rejection probability (<code>power="global"</code>), i.e. the probability that at least one of the elementary null hypotheses is rejected, irrespective, whether this (or any contrast!) is under the corresponding elementary alternative). As a consequence this probability involves elementary type-II-errors for those contrasts which are under their elementary null hypothesis.
</p>
<p>The probability to reject at least one of those elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>ptype="anypair"</code>). Technically, this is achieved by omitting those contrasts under the elementary null and, for a given critical value, compute the rejection probability from a multivariate normal distribution with reduced dimension. Note that for <code>'two-sided'</code> alternatives, type III-errors (rejection of the two-sided null in favor of the wrong direction) are included in the power.
</p>
<p>The probability to reject all elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>power="allpair"</code>). Also here, for 'two-sided' alternatives, the type III-error contributes to the computed 'allpair power'. Note further that two-sided allpair power is simulated based on multivariate normal random numbers.
</p>
<p>Whether a given hypothesis is under the alternative hypothesis is currently checked via <code>abs(L-rhs) &gt; 10*.Machine$double.eps</code>, where L is the constrasts true value depending on <code>p</code> and the contrast matrix and rhs the right hand side of the null hypothesis. For alternatives <code>"less"</code> or <code>"greater"</code>, the corresponding checks are: <code>(L-rhs) &lt; -10*.Machine$double.eps</code> and <code> (L-rhs) &gt; 10*.Machine$double.eps</code>, respectively.
</p>
<p>For the case of differences or proportion (powerbinom) the underlying methods are closely related to those described in Bretz and Hothorn (2002). The methods here differ from that of Bretz and Hothorn (2002) by using a variance estimator in the teststatistic based of unpooled sample rpoportions, not a pooled variances estimator under H0. A description is also given in Schaarschmidt, Biesheuvel and Hothorn, 2009. The method implemented for the odds ratio corresponds to the asymptotic intervals given in Holford et al. 1989, the power computation is a straightforward generalization of the methods above, assuming asymptotic normality at the scale of log odds.
</p>


<h3>Value</h3>

<p>A list consisting of the following items:
</p>
<table>
<tr><td><code>power</code></td>
<td>
<p>a numeric value the computed power, with estimated computational error as an attribute</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>the input vector of expected groupwise proportions</p>
</td></tr> 
<tr><td><code>n</code></td>
<td>
<p>the input vector of group sample sizes</p>
</td></tr>
<tr><td><code>conexp</code></td>
<td>
<p>a data frame containing the contrast matrix, the expected values of the contrasts given p (expContrast), the right hand sides of the hypotheses (rhs, as input), the expected values of the test statistics corresponding to the contrasts and rhs, and a column of logical values indicating whether the corresponding contrasts was under the alternative (under HA)</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>a single numeric value, the critical value used for power computation</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a single character string, as input</p>
</td></tr>
<tr><td><code>ptype</code></td>
<td>
<p>a single character string, as input</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>a single numeric value, as input</p>
</td></tr>
</table>


<h3>Warning </h3>

<p>Note that the the tests for which power is computed as well as the power computation itself relies on simple approximations of binomial distribution by normal distributions. It is known that the test procedures do not control FWER for small <code>n</code> and extreme proportions <code>p</code>. Hence, computed power may substantially deviate from the true power of the methods a) due to the fact that the tests have sizes deviating from the nominal level, b) due to insufficient approximation in the power calculation. Simulations show that absolute deviations of approximate power from simulated power are large if low values of n*p or n*(1-p) are involved and if power is low (i.e. power&lt;0.3). </p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Genz A, Bretz F (1999):</em> Numerical computation of multivariate t-probabilities with application to power calculation of multiple contrasts. Journal of Statistical Computation and Simulation, 63, 4, 361-378.
</p>
<p><em>Bretz F, Hothorn LA (2002):</em> Detecting dose-response using contrasts: asymptotic power and sample size determination for binomial data. Statistics in Medicine, 21, 22, 3325-3335.
</p>
<p><em>Holford, TR, Walter, SD and Dunnett, CW (1989):</em> Simultaneous interval estimates of the odds ratio in studies with two or more comparisons. Journal of Clinical Epidemiology 42, 427-434.
</p>
<p><em>Schaarschmidt F, Biesheuvel E, Hothorn LA (2009):</em> Asymptotic simultaneous confidence intervals for many-to-one comparisons of binray proportions in randomized clinical trials. Journal of Biopharmaceutical Statistics 19, 292-310.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Assume, one wants to perform a test for increasing trend
#  using Williams type of contrasts among I=5 groups
#  (e.g. 4 doses and one control).
#  Proportions are assumed to have values
#  pi=(0.1,0.12,0.14,0.14,0.2) under the alternative.

powerbinom(p=c(0.1, 0.12, 0.14, 0.14, 0.2),
 n=c(100,100,100,100,100), type = "Williams",
 alternative = "greater")

powerbinom(p=c(0.1, 0.12, 0.14, 0.14, 0.2),
 n=c(150,150,150,150,150), type = "Williams",
 alternative = "greater")

powerbinom(p=c(0.1, 0.12, 0.14, 0.14, 0.2),
 n=c(190,140,140,140,140), type = "Williams",
 alternative = "greater")


# probability to show for at least one group (2,3,4)
# a significant reduction versus control (1)

powerbinom(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less")

# probability to show for at least one group (2,3,4)
# a significant reduction versus control (1) of more 
# than 0.05 percent

powerbinom(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less", rhs=-0.05)

# probability to show for all groups (2,3,4)
# a significant reduction versus control (1) of more 
# than 0.05 percent

powerbinom(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less", rhs=-0.05, ptype="allpair")


# probability to show for at least one group (2,3,4)
# a significant reduction versus control (1)

powerbinom(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less")


powerbinomOR(p=c(0.3, 0.15, 0.15, 0.15),
 n=c(140,140,140,140), type = "Dunnett",
 alternative = "less")
</code></pre>

<hr>
<h2 id='powermcpn'>
Approximative power calculation for multiple contrast tests 
</h2><span id='topic+powermcpn'></span>

<h3>Description</h3>

<p>Approximative power calculation for multiple contrast tests which are based on normal approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powermcpn(ExpTeststat, corrH1, crit, alternative = c("two.sided", "less", "greater"),
 alpha = 0.05, ptype = c("global", "anypair", "allpair"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powermcpn_+3A_expteststat">ExpTeststat</code></td>
<td>

<p>numeric vector: the expectation of the test statistics under the alternative
</p>
</td></tr>
<tr><td><code id="powermcpn_+3A_corrh1">corrH1</code></td>
<td>

<p>a numeric matrix, the correlation matrix of the teststatistics under the alternative, must have same number of columns and rows as length of <code>ExpTeststat</code> 
</p>
</td></tr>
<tr><td><code id="powermcpn_+3A_crit">crit</code></td>
<td>

<p>a single numeric value, the critical value of the test; if not specified a critical value is computed as an equicoordinate (1-<code>alpha</code>) quantile of a central multivariate normal distribution with correlation <code>corrH1</code>
</p>
</td></tr>
<tr><td><code id="powermcpn_+3A_alternative">alternative</code></td>
<td>

<p>a character string, specifying the direction of the alternative hypotheses, options are &quot;two.sided&quot;, &quot;less&quot;, &quot;greater&quot;; <code>alternative</code> primarily controls for which directional decisions power is calculated, in case that argument <code>crit</code> is not specified, <code>alternative</code> also controls the choice of the critical value.
</p>
</td></tr>
<tr><td><code id="powermcpn_+3A_alpha">alpha</code></td>
<td>

<p>a single numeric value: the FWER for the multiple test, defaults to 0.05
</p>
</td></tr>
<tr><td><code id="powermcpn_+3A_ptype">ptype</code></td>
<td>
<p> a single character string, naming the type of rejection probability to be computed; options are <code>"global"</code> for the overall rejection probability (irrespective which contrasts are under the null or the alternative), <code>"anypair"</code> for the rejection probability considering only those contrasts under the alternative, <code>"global"</code> for the probability that all elementary alternatives are rejected. 
</p>
</td></tr>
<tr><td><code id="powermcpn_+3A_...">...</code></td>
<td>

<p>further arguments, which are passed to the functions <code>qmvnorm</code> and <code>pmvnorm</code>, mainly to control the computation errors, see help <code>GenzBretz(mvtnorm)</code> for details
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For (standard type and user-defined) multiple contrast tests based on approximation with the multivariate normal distribution, three types of rejection probabilities in the multiple testing problem can be computed.
</p>
<p>The global rejection probability (<code>power="global"</code>), i.e. the probability that at least one of the elementary null hypotheses is rejected, irrespective, whether this (or any contrast!) is under the corresponding elementary alternative). As a consequence this probability involves elementary type-II-errors for those contrasts which are under their elementary null hypothesis.
</p>
<p>The probability to reject at least one of those elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>power="anypair"</code>). Technically, this is achieved by omitting those contrasts under the elementary null and, for a given critical value, compute the rejection probability from a multivariate normal distribution with reduced dimension. Note that for <code>'two-sided'</code> alternatives, type III-errors (rejection of the two-sided null in favor of the wrong direction) are included in the power.
</p>
<p>The probability to reject all elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>power="allpair"</code>). Also here, for 'two-sided' alternatives type III-error contribute to the computed 'allpair power'. Note further that two-sided allpair power is simulated based on multivariate normal random numbers.
</p>
<p>Whether a given hypothesis is under the alternative hypothesis is currently checked via <code>abs(ExpTeststat) &gt; 10*.Machine$double.eps</code>,  <code>ExpTeststat &lt; -10*.Machine$double.eps</code> and <code>ExpTeststat &gt; 10*.Machine$double.eps</code>, for alternatives <code>c("two.sided", "less", "greater")</code>, respectively.
</p>


<h3>Value</h3>

<p>A list consisting of the following items:
</p>
<table>
<tr><td><code>power</code></td>
<td>
<p>a numeric value the computed power, with estimated computational error as an attribute</p>
</td></tr>
<tr><td><code>conexp</code></td>
<td>
<p> the expected values of the test statistics corresponding to the contrasts and rhs, and a column with [0,1] values, indicating whether the corresponding contrasts was under the alternative (1) or under the null (0)</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>a single numeric value, the critical value used for power computation</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a single character string, as input</p>
</td></tr>
<tr><td><code>ptype</code></td>
<td>
<p>a single character string, as input</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>a single numeric value, as input</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>

<hr>
<h2 id='powermcpt'>
Testversion. Power calculation for multiple contrast tests (1-way ANOVA model)
</h2><span id='topic+powermcpt'></span>

<h3>Description</h3>

<p>Testversion. Calculate the power of a multiple contrast tests of k means in a model with homogeneous Gaussian errors, using the function pmvt(mvtnorm) to calculate multivariate t probabilities. Different options of power defineition are
&quot;global&quot;: the overall rejection probability (the probability that at the elementary null is rejected for at least one contrast, irrespective of being under the elementary null or alternative), &quot;anypair&quot;: the probability to reject any of the elementary null hypotheses for those contrasts that are under the elmentary alternatives, &quot;allpair&quot;: and the probability that all elementary nulls are rejected which are indeed under the elementary nulls. See Sections 'Details' and 'Warnings'!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powermcpt(mu, n, sd, cmat = NULL, rhs=0, type = "Dunnett",
 alternative = c("two.sided", "less", "greater"), alpha = 0.05,
 ptype = c("global", "anypair", "allpair"), crit = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powermcpt_+3A_mu">mu</code></td>
<td>
<p>a numeric vector of expected values in the k treatment groups</p>
</td></tr>
<tr><td><code id="powermcpt_+3A_n">n</code></td>
<td>
<p>a numeric vector of sample sizes in the k treatment groups</p>
</td></tr>
<tr><td><code id="powermcpt_+3A_sd">sd</code></td>
<td>
<p>a single numeric value, specifying the expected standard deviation of the residual error</p>
</td></tr>
<tr><td><code id="powermcpt_+3A_cmat">cmat</code></td>
<td>
<p>optional specification of a contrast matrix; if specified, it should have as many columns as there are groups in arguments <code>mu</code> and <code>n</code> and it should have at least 2 rows, if specified, argument <code>type</code> is ignored, if not specified, the contrast is determined by argument <code>type</code></p>
</td></tr>
<tr><td><code id="powermcpt_+3A_rhs">rhs</code></td>
<td>
<p>numeric vector, specifying the right hand side of the hyptheses to test, defaults to 0, other specifications lead to tests of non-inferiority and superiority.</p>
</td></tr>
<tr><td><code id="powermcpt_+3A_type">type</code></td>
<td>
<p> a single character string, naming one of the contrast types available in <code>contrMat(multcomp)</code>; argument is ignored if <code>cmat</code> is specified</p>
</td></tr>
<tr><td><code id="powermcpt_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, specifying the direction of the alternative hypothesis, one of <code>"two.sided","less","greater"</code>. Note that this argument governs how the multivariate t probabilities are evaluated as well as the computation of the critical value if none is specified (i.e. default <code>crit=NULL</code>)</p>
</td></tr>
<tr><td><code id="powermcpt_+3A_alpha">alpha</code></td>
<td>
<p> a single numeric value, familywise type I error to be controlled, is ignored if argument <code>crit</code> is specified</p>
</td></tr>
<tr><td><code id="powermcpt_+3A_ptype">ptype</code></td>
<td>
<p> a single character string, naming the type of rejection probability to be computed; options are <code>"global"</code> for the global rejection probability,  <code>"anypair"</code> for the rejection probability considering only those contrasts under the alternative, <code>"global"</code> for the probability that all elementary alternatives are rejected. </p>
</td></tr>
<tr><td><code id="powermcpt_+3A_crit">crit</code></td>
<td>
<p> a single numeric value to serve as equicoordinate critical point in the multiple test; if it is not specified, it is computed as a quantile of the multivariate t distribution based on the specifications in arguments <code>n</code>, <code>cmat</code> (or <code>type</code>); note that for alternatives <code>'two.sided'</code> and <code>'greater'</code>, <code>crit</code> should be a single positive value, while for alternative <code>'less'</code>, <code>crit</code> should be a single negative value. </p>
</td></tr>
<tr><td><code id="powermcpt_+3A_...">...</code></td>
<td>
<p> further arguments, which are passed to the functions <code>qmvt</code> and <code>pmvt</code>, mainly to control the computation errors, see help <code>GenzBretz(mvtnorm)</code> for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In a homoscedastic Gaussian model with k possibly different means compared by (user-defined) multiple contrast tests, different types of rejection probabilities in the multiple testing problem can be computed.
Based on a central multivariate t distribution with df=sum(n)-k appropriate equicoordinate critical points for the test are computed, different critical points can be specified in <code>crit</code>
Computing probabilities of non-central multivariate t distributions <code>pmvt(mvtnorm)</code> one can calculate:
</p>
<p>The global rejection probability (<code>power="global"</code>), i.e. the probability that at least one of the elementary null hypotheses is rejected, irrespective, whether this (or any contrast!) is under the corresponding elementary alternative). As a consequence this probability involves elementary type-II-errors for those contrasts which are under their elementary null hypothesis.
</p>
<p>The probability to reject at least one of those elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>power="anypair"</code>). Technically, this is achieved by omitting those contrasts under the elementary null and compute the rejection probability for a given criticla value from a multivariate t distribution with reduced dimension. Note that for <code>'two-sided'</code> alternatives, type III-errors (rejection of the two-sided null in favor of the wrong direction) are included in the power.
</p>
<p>The probability to reject all elementary null hypotheses which are indeed under their corresponding elementary alternatives (<code>power="allpair"</code>). Also here, for 'two-sided' alternatives type III-error contribute to the computed 'allpair power'. Note further that two-sided allpair power is simulated based on multivariate t random numbers.
</p>


<h3>Value</h3>

<p>A list consisting of the following items:
</p>
<table>
<tr><td><code>power</code></td>
<td>
<p>a numeric value the computed power, with estimated computational error as an attribute</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the input vector of expected values of group means</p>
</td></tr> 
<tr><td><code>n</code></td>
<td>
<p>the input vector of group sample sizes</p>
</td></tr>
<tr><td><code>conexp</code></td>
<td>
<p>a data frame containing the contrast matrix, the expected values of the contrasts given mu (expContrast), the right hand sides of the hypotheses (rhs, as input), the expected values of the test statistics corresponding to the contrasts and rhs, and a column of logical values indicating whether the corresponding contrasts was under the alternative (under HA)</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>a single numeric value, the critical value used for power computation</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a single character string, as input</p>
</td></tr>
<tr><td><code>ptype</code></td>
<td>
<p>a single character string, as input</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>a single numeric value, as input</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>This is a test version, which has roughly (but not for an extensive number of settings) been checked by simulation. Any reports of errors/odd behaviour/amendments are welcome.</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Genz A, Bretz F (1999):</em> Numerical computation of multivariate t-probabilities with application to power calculation of multiple contrasts. Journal of Statistical Computation and Simulation, 63, 4, 361-378.
<em>Bretz F, Hothorn LA (2002):</em> Detecting dose-response using contrasts: asymptotic power and sample size determination for binomial data. Statistics in Medicine, 21, 22, 3325-3335.
<em>Bretz F, Hayter AJ and Genz A (2001):</em> Critical point and power calculations for the studentized range test for generally correlated means. Journal of Statistical Computation and Simulation, 71, 2, 85-97.
<em>Dilba G, Bretz F, Hothorn LA, Guiard V (2006):</em> Power and sample size computations in simultaneous tests for non-inferiority based on relative margins. Statistics in Medicien 25, 1131-1147.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>powermcpt(mu=c(3,3,5,7), n=c(10,10,10,10), sd=2, type = "Dunnett",
 alternative ="greater", ptype = "global")
powermcpt(mu=c(3,3,5,7), n=c(10,10,10,10), sd=2, type = "Williams",
 alternative ="greater", ptype = "global")

powermcpt(mu=c(3,3,5,7), n=c(10,10,10,10), sd=2, type = "Dunnett",
 alternative ="greater", ptype = "anypair")
powermcpt(mu=c(3,3,5,7), n=c(10,10,10,10), sd=2, type = "Williams",
 alternative ="greater", ptype = "anypair")

powermcpt(mu=c(3,4,5,7), n=c(10,10,10,10), sd=2, type = "Dunnett",
 alternative ="greater", ptype = "allpair")
powermcpt(mu=c(3,2,1,-1), n=c(10,10,10,10), sd=2, type = "Dunnett",
 alternative ="greater", ptype = "allpair")
</code></pre>

<hr>
<h2 id='PQln'>
Generalized pivotal quantity for log expected values of several lognormal samples.
</h2><span id='topic+PQln'></span>

<h3>Description</h3>

<p>Computes samples of the generalized pivotal quantities for the log of expected values of lognormal samples according to Krishnamoorthy and Mathew (2003). For internal use in <code>lndci</code>, <code>lnrci</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PQln(nx, mlx, varlx, B = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PQln_+3A_nx">nx</code></td>
<td>

<p>a numeric (integer) vector, the sample sizes for each of K groups
</p>
</td></tr>
<tr><td><code id="PQln_+3A_mlx">mlx</code></td>
<td>

<p>a numeric vector, the sample estimates of the log mean for each of K groups
</p>
</td></tr>
<tr><td><code id="PQln_+3A_varlx">varlx</code></td>
<td>

<p>a numeric vector, the (unbiased) sample estimates of the log variance for each of K groups
</p>
</td></tr>
<tr><td><code id="PQln_+3A_b">B</code></td>
<td>

<p>a single (integer) value, the number of samples to draw, defaults to 10000
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates B samples from independent standard normal and chi^2 distributions for each of K independent groups in a one-way layout and computes the generalized pivotal quantities for the log expected value for each of the groups, according to Krishnamoorthy and Mathew (2003).
The input vectors <code>nx</code>, <code>mlx</code>, <code>varlx</code> must be vectors of length K.
</p>


<h3>Value</h3>

<p>A BxK matrix
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p>Krishnamoorthy K, Mathew T (2003): Inferences on the means of lognormal distributions using generalized p-values and generalized condence intervals. Journal of Statistical Planning and Inference 115,
103-121.
</p>

<hr>
<h2 id='print.multinomORci'>
Print out put of multinomORci
</h2><span id='topic+print.multinomORci'></span><span id='topic+as.data.frame.multinomORci'></span>

<h3>Description</h3>

<p>For output of function multinomORci: print ot confidence intervals or coerce out put to a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multinomORci'
print(x, exp = TRUE, ...)
## S3 method for class 'multinomORci'
as.data.frame(x, row.names = NULL, optional = FALSE, exp = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.multinomORci_+3A_x">x</code></td>
<td>
<p>an object of class <code>multinomORci</code></p>
</td></tr>
<tr><td><code id="print.multinomORci_+3A_exp">exp</code></td>
<td>
<p>logical; if <code>exp=TRUE</code> interval limits are exp-transformed to yield limits on the sclae of odds-ratios; if <code>exp=FALSE</code> interval limits are printed/Returned on the logit scale</p>
</td></tr>
<tr><td><code id="print.multinomORci_+3A_row.names">row.names</code></td>
<td>
<p>see <code>as.data.frame</code></p>
</td></tr>
<tr><td><code id="print.multinomORci_+3A_optional">optional</code></td>
<td>
<p>see <code>as.data.frame</code></p>
</td></tr>
<tr><td><code id="print.multinomORci_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code>print</code>, or <code>as.data.frame</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# fakle data: 3 categories (A,B,C) in 4 tretament groups c(co,d1,d2,d3)
dm &lt;- rbind(
"co" = c(15,5,5),
"d1" = c(10,10,5),
"d2" = c(5,10,10),
"d3" = c(5,5, 15))
colnames(dm)&lt;- c("A","B","C")

dm

#  define and name odds between categories
cmodds &lt;- rbind(
"B/A"=c(-1,1,0),
"C/A"=c(-1,0,1))

#  define and name comparsions between groups
cmtrt &lt;- rbind(
"d1/co"=c(-1,1,0,0),
"d2/co"=c(-1,0,1,0),
"d3/co"=c(-1,0,1,0))

TEST &lt;- multinomORci(Ymat=dm, cmcat=cmodds, cmgroup=cmtrt, cimethod="DP", BSIM=1000, prior=1)
TEST
print(TEST, exp=FALSE)
as.data.frame(TEST)

</code></pre>

<hr>
<h2 id='printfunctions'>Print methods for the classes in this package</h2><span id='topic+print.binomORci'></span><span id='topic+print.binomRDci'></span><span id='topic+print.binomRDtest'></span><span id='topic+print.binomRRci'></span><span id='topic+print.poly3ci'></span><span id='topic+print.poly3est'></span><span id='topic+print.poly3test'></span><span id='topic+print.Shannonci'></span><span id='topic+print.Simpsonci'></span>

<h3>Description</h3>

<p>Print methods for objects of the corresponding classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'binomORci'
print(x, ...)
## S3 method for class 'binomRDci'
print(x, digits = 4, ...)
## S3 method for class 'binomRDtest'
print(x, digits = 4, ...)
## S3 method for class 'binomRRci'
print(x, digits = 4, ...)
## S3 method for class 'poly3ci'
print(x, digits = 4, ...)
## S3 method for class 'poly3est'
print(x, digits = 4, ...)
## S3 method for class 'poly3test'
print(x, digits = 4, ...)
## S3 method for class 'Shannonci'
print(x, ...)
## S3 method for class 'Simpsonci'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printfunctions_+3A_x">x</code></td>
<td>
<p> an object of the corresponding class </p>
</td></tr>
<tr><td><code id="printfunctions_+3A_digits">digits</code></td>
<td>
<p>the number of digits to be used for rounding </p>
</td></tr>
<tr><td><code id="printfunctions_+3A_...">...</code></td>
<td>
<p> ... </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out.
</p>

<hr>
<h2 id='scalechoice'> Only for internal use.</h2><span id='topic+scalechoice'></span>

<h3>Description</h3>

<p>How to define scale parameters of the Weibull distribution in the poly-k-setting  </p>


<h3>Usage</h3>

<pre><code class='language-R'>scalechoice(shape = 3, pm = 0.2, t = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scalechoice_+3A_shape">shape</code></td>
<td>
<p> shape parameter (usually shape=3) </p>
</td></tr>
<tr><td><code id="scalechoice_+3A_pm">pm</code></td>
<td>
<p> a numeric value (0&lt;p&lt;1), probability that an individual dies before time t </p>
</td></tr>
<tr><td><code id="scalechoice_+3A_t">t</code></td>
<td>
<p> a numeric value, time t </p>
</td></tr>
</table>


<h3>Value</h3>

<p>a single numeric value, giving the scale parameter needed to fulfill pm(t) for the current definition of the Weibull disstribution.</p>


<h3>Note</h3>

<p>Scale parameter is defined differently than that in Peddada (2005)
</p>


<h3>See Also</h3>

 <p><kbd>?pweibull</kbd> </p>

<hr>
<h2 id='SCSrank'>Compute a rectangular simultaneous confidence set from a sample of a joint empirical distribution.</h2><span id='topic+SCSrank'></span>

<h3>Description</h3>

<p>Given a large sample of N values from an M dimensional joint empirical distribution, the rank based method of Besag et al. (1995) is used to compute a rectangular M-dimensional 'confidence' set
that includes N*conf.level values of the sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCSrank(x, conf.level = 0.95, alternative = "two.sided", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SCSrank_+3A_x">x</code></td>
<td>

<p>an N x M matrix containg N sampled values of the M dimensional distribution of interest
</p>
</td></tr>
<tr><td><code id="SCSrank_+3A_conf.level">conf.level</code></td>
<td>

<p>the simultaneous confidence level, a single numeric value between 0 and 1, defaults to 0.95 for simultaneous 95 percent sets
</p>
</td></tr>
<tr><td><code id="SCSrank_+3A_alternative">alternative</code></td>
<td>

<p>a single character string related to hypotheses testing, <code>"two.sided"</code> invokes two-sided confidence sets, <code>"less"</code> invokes sets with upper limits only and <code>"greater"</code> invokes sets with lower limits only, 
</p>
</td></tr>
<tr><td><code id="SCSrank_+3A_...">...</code></td>
<td>
<p> currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an Mx2 (<code>alternative="two.sided"</code>) matrix containing the lower and upper confidence limist for the M dimensions,
in case of <code>alternative="less"</code>, <code>alternative="greater"</code> the lower and upper bounds are replaced by <code>-Inf</code> and <code>Inf</code>, respectively.
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p>Besag J, Green P, Higdon D, Mengersen K (1995). Bayesian Computation and Stochastic Systems. Statistical Science 10, 3-66.
Mandel M, Betensky RA. Simultaneous confidence intervals based on the percentile bootstrap approach. Computational Statistics and Data Analysis 2008; 52(4): 2158-2165.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- cbind(rnorm(1000,1,2), rnorm(1000,0,2), rnorm(1000,0,0.5), rnorm(1000,2,1))
dim(x)
cm &lt;- rbind(c(-1,1,0,0), c(-1,0,1,0), c(-1, 0,0,1))
xd &lt;- t(apply(x, 1, function(x){crossprod(t(cm), matrix(x))}))
pairs(xd)

SCSrank(xd, conf.level=0.9)

</code></pre>

<hr>
<h2 id='Shannon'> Shannon index </h2><span id='topic+Shannon'></span>

<h3>Description</h3>

<p>Calculates the Shannon-Wiener index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Shannon(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Shannon_+3A_p">p</code></td>
<td>
<p>A numeric vector of proportions. </p>
</td></tr>
</table>

<hr>
<h2 id='Shannonci'> Confidence intervals for multiple contrasts of Shannon indices </h2><span id='topic+Shannonci'></span>

<h3>Description</h3>

<p>Calculates simultaneous and local confidence intervals for differences of Shannon indices under the assumption of multinomial count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Shannonci(X, f, cmat = NULL, type = "Dunnett", alternative = "two.sided",
 conf.level = 0.95, dist = "MVN", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Shannonci_+3A_x">X</code></td>
<td>
<p> a data.frame of dimensions n times p with integer entries, where n is the number of samples and p is the number of species </p>
</td></tr>
<tr><td><code id="Shannonci_+3A_f">f</code></td>
<td>
<p> a factor variable of length n, grouping the observations in <kbd>X</kbd> </p>
</td></tr>
<tr><td><code id="Shannonci_+3A_cmat">cmat</code></td>
<td>
<p> an contrast matrix; the number of columns should match the number of levels in <kbd>f</kbd> </p>
</td></tr>
<tr><td><code id="Shannonci_+3A_type">type</code></td>
<td>
<p> a single character string, currently one of &quot;Dunnett&quot;,&quot;Tukey&quot;,&quot;Sequen&quot; </p>
</td></tr>
<tr><td><code id="Shannonci_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, one of &quot;two.sided&quot;,&quot;less&quot; (upper bounds),&quot;greater&quot; (lower bounds)</p>
</td></tr>
<tr><td><code id="Shannonci_+3A_conf.level">conf.level</code></td>
<td>
<p> the confidence level of the simultaneous (or local) confidence intervals </p>
</td></tr>
<tr><td><code id="Shannonci_+3A_dist">dist</code></td>
<td>
<p> a single character string, defining the type of quantiles to be used for interval calculation; &quot;MVN&quot; invokes simultaneous intervals, &quot;N&quot; invokes unadjusted confidence intervals with coverage probability conf.level for each of them  </p>
</td></tr>
<tr><td><code id="Shannonci_+3A_...">...</code></td>
<td>
<p> further arguments to be passed; currently only <kbd>base</kbd> is used, a single integer value, specifying which group to be taken as the control in case that <kbd>type="Dunnett"</kbd>, ignored otherwise</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements confidence intervals described by Fritsch and Hsu (1999) for the difference of Shannon indices between several groups.
Deviating from Fritsch and Hsu, quantiles of the multivariate normal distribution based on a plug-in-estamator for the correlation matrix.
</p>
<p>Note, that this approach, by assuming multinomial distribution for the vectors of counts, ignores the variability of the individual samples. If such extra-multinomial variatio is present in the data, the intervals will be too narrow, coverage probability will be substantially lower than specified in 'conf.level'. Consider approaches based on bootstrap instead (e.g., package simboot).
</p>


<h3>Value</h3>

<p>A list containing the elements:
</p>
<table>
<tr><td><code>conf.int</code></td>
<td>
<p> a matrix, containing the lower and upper confidence limits in the columns</p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p>a single numeric value, the quantile used for interval calculation</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>a matrix,containing the point estimates of the contrasts in its column</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p> the contrast matrix used</p>
</td></tr>
<tr><td><code>methodname</code></td>
<td>
<p>a character string, for printing</p>
</td></tr>
<tr><td><code>sample.estimate</code></td>
<td>
<p>A list of sample estimates as returned by <a href="#topic+estShannonf">estShannonf</a> </p>
</td></tr>
</table>
<p>and some of the input arguments
</p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>References</h3>

 
<p><em>Fritsch, KS, and Hsu, JC (1999):</em> Multiple Comparison of Entropies with Application to Dinosaur Biodiversity. Biometrics 55, 1300-1305.
<em>Scherer, R, Schaarschmidt, F, Prescher, S, and Priesnitz, KU (2013):</em> Simultaneous confidence intervals for comparing biodiversity
indices estimated from overdispersed count data. Biometrical Journal 55,246-263.
</p>


<h3>See Also</h3>

 <p><a href="#topic+Simpsonci">Simpsonci</a> for simultaneous and local intervals of differences of the Simpson index </p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(HCD)

HCDcounts&lt;-HCD[,-1]
HCDf&lt;-HCD[,1]

# Comparison to the confidence bounds shown in
# Fritsch and Hsu (1999), Table 5, "Standard normal".

cmat&lt;-rbind(
"HM-HU"=c(0,1,-1),
"HL-HM"=c(1,-1,0),
"HL-HU"=c(1,0,-1)
)

Shannonci(X=HCDcounts, f=HCDf, cmat=cmat,
 alternative = "two.sided", conf.level = 0.9, dist = "N")

# Note, that the calculated confidence intervals
# differ from those published by Fritsch and Hsu (1999),
# whenever Lower is involved.



# Comparison to the lower cretaceous,
# unadjusted confidence intervals:

Shannonci(X=HCDcounts, f=HCDf, type = "Dunnett",
 alternative = "greater", conf.level = 0.9, dist = "N")

# Stepwise comparison between the strata,
# unadjusted confidence intervals:

ShannonS&lt;-Shannonci(X=HCDcounts, f=HCDf, type = "Sequen",
 alternative = "greater", conf.level = 0.9, dist = "N")


ShannonS

summary(ShannonS)

plot(ShannonS)


# A trend test based on multiple contrasts:

cmatTREND&lt;-rbind(
"U-LM"=c(-0.5,-0.5,1),
"MU-L"=c(-1,0.5,0.5),
"U-L"=c(-1,0,1)
)

TrendCI&lt;-Shannonci(X=HCDcounts, f=HCDf, cmat=cmatTREND,
 alternative = "greater", conf.level = 0.95, dist = "MVN")
TrendCI

plot(TrendCI)



  </code></pre>

<hr>
<h2 id='Simpson'> Calculate the Simpson index </h2><span id='topic+Simpson'></span>

<h3>Description</h3>

<p>Calculate the Simpson index from a vector of proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Simpson(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Simpson_+3A_p">p</code></td>
<td>
<p> a numeric vector of proportions </p>
</td></tr>
</table>

<hr>
<h2 id='Simpsonci'> Confidence intervals for differences of Simpson indices </h2><span id='topic+Simpsonci'></span>

<h3>Description</h3>

<p>Calculates simultaneous and local confidence intervals for differences of Simpson indices under the assumption of multinomial count data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Simpsonci(X, f, cmat = NULL, type = "Dunnett",
 alternative = "two.sided", conf.level = 0.95, dist = "MVN", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Simpsonci_+3A_x">X</code></td>
<td>
<p> a data.frame of dimensions n times p with integer entries, where n is the number of samples and p is the number of species  </p>
</td></tr>
<tr><td><code id="Simpsonci_+3A_f">f</code></td>
<td>
<p> a factor variable of length n, grouping the observations in <kbd>X</kbd>  </p>
</td></tr>
<tr><td><code id="Simpsonci_+3A_cmat">cmat</code></td>
<td>
<p> an contrast matrix; the number of columns should match the number of levels in <kbd>f</kbd></p>
</td></tr>
<tr><td><code id="Simpsonci_+3A_type">type</code></td>
<td>
<p> a single character string, currently one of &quot;Dunnett&quot;,&quot;Tukey&quot;,&quot;Sequen&quot; </p>
</td></tr>
<tr><td><code id="Simpsonci_+3A_alternative">alternative</code></td>
<td>
<p> a single character string, one of &quot;two.sided&quot;,&quot;less&quot; (upper bounds),&quot;greater&quot; (lower bounds) </p>
</td></tr>
<tr><td><code id="Simpsonci_+3A_conf.level">conf.level</code></td>
<td>
<p> the confidence level of the simultaneous (or local) confidence intervals </p>
</td></tr>
<tr><td><code id="Simpsonci_+3A_dist">dist</code></td>
<td>
<p> a single character string, defining the type of quantiles to be used for interval calculation; &quot;MVN&quot; invokes simultaneous intervals, &quot;N&quot; invokes unadjusted confidence intervals with coverage probability conf.level for each of them  </p>
</td></tr>
<tr><td><code id="Simpsonci_+3A_...">...</code></td>
<td>
<p> further arguments to be passed; currently only <kbd>base</kbd> is used,a single integer value, specifying which group to be taken as the control in case that <kbd>type="Dunnett"</kbd>, ignored otherwise</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements confidence intervals described by Rogers and Hsu (1999) for the difference of Shannon indices between several groups. Deviating from Fritsch and Hsu, quantiles of the multivariate normal distribution based on a plug-in-estamator for the correlation matrix.
</p>
<p>Note, that this approach, by assuming multinomial distribution for the vectors of counts, ignores the variability of the individual samples. If such extra-multinomial variatio is present in the data, the intervals will be too narrow, coverage probability will be substantially lower than specified in 'conf.level'. Consider approaches based on bootstrap instead (e.g., package simboot).
</p>


<h3>Value</h3>

<p>A list containing the elements:
</p>
<table>
<tr><td><code>conf.int</code></td>
<td>
<p> a matrix, containing the lower and upper confidence limits in the columns</p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p>a single numeric value, the quantile used for interval calculation</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>a matrix,containing the point estimates of the contrasts in its column</p>
</td></tr>
<tr><td><code>cmat</code></td>
<td>
<p> the contrast matrix used</p>
</td></tr>
<tr><td><code>methodname</code></td>
<td>
<p>a character string, for printing</p>
</td></tr>
<tr><td><code>sample.estimate</code></td>
<td>
<p>A list of sample estimates as returned by <a href="#topic+estShannonf">estShannonf</a> </p>
</td></tr>
</table>
<p>and some of the input arguments.
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt </p>


<h3>References</h3>

<p> Rogers, JA and Hsu, JC (2001): Multiple Comparisons of Biodiversity. Biometrical Journal 43, 617-625.</p>


<h3>See Also</h3>

 <p><a href="#topic+Shannonci">Shannonci</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(HCD)

HCDcounts&lt;-HCD[,-1]
HCDf&lt;-HCD[,1]

# Rogers and Hsu (2001), Table 2:
# All pair wise comparisons:

Simpsonci(X=HCDcounts, f=HCDf, type = "Tukey",
 conf.level = 0.95, dist = "MVN")

# Rogers and Hsu (2001), Table 3:
# Comparison to the lower cretaceous:

Simpsonci(X=HCDcounts, f=HCDf, type = "Dunnett",
 alternative = "less", conf.level = 0.95, dist = "MVN")


# Note, that the confidence bounds here differ
# from the bounds in Rogers and Hsu (2001) 
# in the second digit, whenever the group Upper
# is involved in the comparison.


# Stepwise comparison between the strata:

SimpsonS&lt;-Simpsonci(X=HCDcounts, f=HCDf, type = "Sequen",
 alternative = "greater", conf.level = 0.95, dist = "MVN")

SimpsonS
summary(SimpsonS)

plot(SimpsonS)

# # # Hell Creek Dinosaur data:
# Is there a downward trend in biodiversity during the 
# Creataceous period?

# A trend test based on multiple contrasts:

cmatTREND&lt;-rbind(
"U-LM"=c(-0.5,-0.5,1),
"MU-L"=c(-1,0.5,0.5),
"U-L"=c(-1,0,1)
)

TrendCI&lt;-Simpsonci(X=HCDcounts, f=HCDf, cmat=cmatTREND, 
 alternative = "greater", conf.level = 0.95, dist = "MVN")
TrendCI

plot(TrendCI)


</code></pre>

<hr>
<h2 id='summary.binomORci'> Detailed print out for binomORci </h2><span id='topic+summary.binomORci'></span>

<h3>Description</h3>

<p>Produces a more detailed print out of objects of class &quot;binomORci&quot;, including summary statistics,
the used contrast matrix and the confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'binomORci'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.binomORci_+3A_object">object</code></td>
<td>
<p> an object of class &quot;binomORci&quot; as created by function <a href="#topic+binomORci">binomORci</a> </p>
</td></tr>
<tr><td><code id="summary.binomORci_+3A_...">...</code></td>
<td>
<p> ... </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x&lt;-c(1,3,6,7,5)
n&lt;-c(30,30,30,30,30)
names&lt;-LETTERS[1:5]

ORD&lt;-binomORci(x=x, n=n, names=names,
 type="Dunnett", alternative="greater")
summary(ORD)

ORW&lt;-binomORci(x=x, n=n, names=names,
 type="Williams", alternative="greater")
summary(ORW)


</code></pre>

<hr>
<h2 id='summary.binomRDci'> Detailed print out for binomRDci </h2><span id='topic+summary.binomRDci'></span>

<h3>Description</h3>

<p>Produces a more detailed print out of objects of class &quot;binomRDci&quot;, including summary statistics,
the used contrast matrix and the confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'binomRDci'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.binomRDci_+3A_object">object</code></td>
<td>
<p> an object of class &quot;binomRDci&quot; as created by function <a href="#topic+binomRDci">binomRDci</a> </p>
</td></tr>
<tr><td><code id="summary.binomRDci_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to summary, currently only <kbd>digits</kbd> for rounding is supported </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


data(liarozole)

head(liarozole)

LiWi&lt;-binomRDci(Improved ~ Treatment, data=liarozole,
 type="Williams")

LiWi

summary(LiWi)



</code></pre>

<hr>
<h2 id='summary.binomRDtest'> Detailed print out for binomRDtest </h2><span id='topic+summary.binomRDtest'></span>

<h3>Description</h3>

<p>Produces a more detailed print out of objects of class &quot;binomRDtest&quot;,
including summary statistics,
the used contrast matrix and the p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'binomRDtest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.binomRDtest_+3A_object">object</code></td>
<td>
<p> an object of class &quot;binomRDtest&quot; as created by function <a href="#topic+binomRDtest">binomRDtest</a>  </p>
</td></tr>
<tr><td><code id="summary.binomRDtest_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to summary, currently only <kbd>digits</kbd> for rounding is supported </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

ntrials &lt;- c(40,20,20,20)
xsuccesses &lt;- c(1,2,2,4)
names(xsuccesses) &lt;- LETTERS[1:4]
test&lt;-binomRDtest(x=xsuccesses, n=ntrials, method="ADD1",
 type="Changepoint", alternative="greater")

test

summary(test)

</code></pre>

<hr>
<h2 id='summary.binomRRci'> Detailed print out for binomRRci </h2><span id='topic+summary.binomRRci'></span>

<h3>Description</h3>

<p>Produces a more detailed print out of objects of class &quot;binomRRci&quot;, including summary statistics,
the used contrast matrix and the confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'binomRRci'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.binomRRci_+3A_object">object</code></td>
<td>
<p> an object of class &quot;binomRRci&quot; as created by function <code><a href="#topic+binomRRci">binomRRci</a></code> </p>
</td></tr>
<tr><td><code id="summary.binomRRci_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to summary, currently only <code>digits</code> for rounding is supported </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


data(liarozole)

head(liarozole)

LiDu&lt;-binomRRci(Improved ~ Treatment, data=liarozole,
 type="Dunnett", alternative="greater")

LiDu

summary(LiDu)



</code></pre>

<hr>
<h2 id='summary.poly3est'> Detailed print out for poly3est </h2><span id='topic+summary.poly3est'></span>

<h3>Description</h3>

<p>Summary statistics for long-term carcinogenicity data, including poly-3-estimates.
For internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'poly3est'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.poly3est_+3A_object">object</code></td>
<td>
<p> An object of class &quot;poly3est&quot;, as can be obtained by <code><a href="#topic+poly3est">poly3est</a></code> </p>
</td></tr>
<tr><td><code id="summary.poly3est_+3A_...">...</code></td>
<td>
<p> further argument for the print out, as e.g. <code>digits</code> for rounding </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use.</p>


<h3>Value</h3>

<p>A print out.
</p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(methyl)
head(methyl)

estk3&lt;-poly3estf(time=methyl$death, status=methyl$tumour, f=methyl$group)
summary(estk3)

estk5&lt;-poly3estf(time=methyl$death, status=methyl$tumour, f=methyl$group, k=5)
summary(estk5)

</code></pre>

<hr>
<h2 id='summary.Shannonci'> Summary for Shannonci</h2><span id='topic+summary.Shannonci'></span>

<h3>Description</h3>

<p>Produces a detailed print out of the results of the function Shannonci.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Shannonci'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.Shannonci_+3A_object">object</code></td>
<td>
<p> An object of class <code>"Shannonci"</code>, see <code><a href="#topic+Shannonci">Shannonci</a></code> </p>
</td></tr>
<tr><td><code id="summary.Shannonci_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to print, currently only <code>digits</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out, comprising a table of the (possibly aggregated) data used for estimation,
the sample estimates for the Shannon index with bias corrected and raw values, its variance estimates,
the used contrast matrix, and the confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(HCD)

HCDcounts&lt;-HCD[,-1]
HCDf&lt;-HCD[,1]

# Comparison to the confidence bounds shown in
# Fritsch and Hsu (1999), Table 5, "Standard normal".

cmat&lt;-rbind(
"HM-HU"=c(0,1,-1),
"HL-HM"=c(1,-1,0),
"HL-HU"=c(1,0,-1)
)

ShannonS&lt;-Shannonci(X=HCDcounts, f=HCDf, type = "Sequen",
 alternative = "greater", conf.level = 0.9, dist = "N")

summary(ShannonS)

</code></pre>

<hr>
<h2 id='summary.Simpsonci'> Summary function for Simpsonci </h2><span id='topic+summary.Simpsonci'></span>

<h3>Description</h3>

<p>Produces a detailed print out of the results of function Simpsonci.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Simpsonci'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.Simpsonci_+3A_object">object</code></td>
<td>
<p> an object of class <code>"Simpsonci"</code> as obtained by calling <code><a href="#topic+Simpsonci">Simpsonci</a></code> </p>
</td></tr>
<tr><td><code id="summary.Simpsonci_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to print and round: currently only <code>digits</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out, comprising a table of the (possibly aggregated) data used for estimation,
the sample estimates for the Simpsons index, and its variance estimates,
the used contrast matrix, and the confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(HCD)

HCDcounts&lt;-HCD[,-1]
HCDf&lt;-HCD[,1]

SimpsonS&lt;-Simpsonci(X=HCDcounts, f=HCDf, type = "Sequen",
 alternative = "greater", conf.level = 0.95, dist = "MVN")

summary(SimpsonS)

</code></pre>

<hr>
<h2 id='Waldci'> Simultaneous Wald confidence intervals </h2><span id='topic+Waldci'></span>

<h3>Description</h3>

<p>General function for simultaneous CIs in a one-way layout using multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Waldci(cmat, estp, varp, varcor, alternative = "two.sided", conf.level = 0.95, dist="MVN")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Waldci_+3A_cmat">cmat</code></td>
<td>
<p> Contrast matrix of dimension MxI, with M = the number of contrasts, I= the number of samples </p>
</td></tr>
<tr><td><code id="Waldci_+3A_estp">estp</code></td>
<td>
<p> numeric vector of point estimates of length I, with I = the number of samples</p>
</td></tr>
<tr><td><code id="Waldci_+3A_varp">varp</code></td>
<td>
<p> numeric vector of variance estimates of length I, to be used for interval construction </p>
</td></tr>
<tr><td><code id="Waldci_+3A_varcor">varcor</code></td>
<td>
<p> numeric vector of variance estimates of length I </p>
</td></tr>
<tr><td><code id="Waldci_+3A_alternative">alternative</code></td>
<td>
<p> character string </p>
</td></tr>
<tr><td><code id="Waldci_+3A_conf.level">conf.level</code></td>
<td>
<p>  single numeric vector </p>
</td></tr>
<tr><td><code id="Waldci_+3A_dist">dist</code></td>
<td>
<p>a character string, <code>"MVN"</code> invokes multiplicity adjustment via the multivariate normal distribution,
<code>"N"</code> invokes use of quantiles of the univariate normal distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Mainly for internal use.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>conf.int</code></td>
<td>
<p>a matrix with 2 columns: lower and upper confidence bounds, and M rows</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>character string, as input</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>single numeric value, as input</p>
</td></tr>
<tr><td><code>quantile</code></td>
<td>
<p>the quantile used to construct the CIs</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt</p>


<h3>See Also</h3>

<p>For user level implementations see: 
<code><a href="#topic+binomRDci">binomRDci</a></code>, 
<code><a href="#topic+binomORci">binomORci</a></code>,
<code><a href="#topic+poly3ci">poly3ci</a></code>
</p>

<hr>
<h2 id='Waldtest'> Simultaneous Wald tests</h2><span id='topic+Waldtest'></span>

<h3>Description</h3>

<p>General function for adjusted p-values for an UIT in a one-way layout using multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Waldtest(estp, varp, cmat, alternative = "greater", dist="MVN")
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="Waldtest_+3A_estp">estp</code></td>
<td>
<p> numeric vector of point estimates of length I, with I = the number of samples</p>
</td></tr>
<tr><td><code id="Waldtest_+3A_varp">varp</code></td>
<td>
<p> numeric vector of variance estimates of length I, to be used for interval construction </p>
</td></tr>
<tr><td><code id="Waldtest_+3A_cmat">cmat</code></td>
<td>
<p> Contrast matrix of dimension MxI, with M = the number of contrasts, I= the number of samples </p>
</td></tr>
<tr><td><code id="Waldtest_+3A_alternative">alternative</code></td>
<td>
<p> character string </p>
</td></tr>
<tr><td><code id="Waldtest_+3A_dist">dist</code></td>
<td>
<p>a character string, where <code>"MVN"</code> invokes the computation of p-values using the multivariate normal distribution,
and <code>"N"</code> invokes use p-value computation using the univariate normal distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>teststat</code></td>
<td>
<p>a numeric vector of teststatistics of length M</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>a single numeric p-value, the p-value of the maximum test (minimum p-value)</p>
</td></tr> 
<tr><td><code>p.val.adj</code></td>
<td>
<p> a vector of length M, the adjusted p-values of the single contrasts</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a single character vector, as the input</p>
</td></tr>
<tr><td><code>dist</code></td>
<td>
<p>a character string specifying which distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>See Also</h3>

<p>For user level implementations see:
</p>
<p><code><a href="#topic+binomRDtest">binomRDtest</a></code>,
<code><a href="#topic+poly3test">poly3test</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
