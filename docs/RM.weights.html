<!DOCTYPE html><html lang="en"><head><title>Help for package RM.weights</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RM.weights}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RM.weights-package'>
<p>Rasch model and extensions for survey data, using Conditional Maximum likelihood (CML).</p></a></li>
<li><a href='#data.FAO_country1'><p>Food insecurity data for a GWP country (Country1).</p></a></li>
<li><a href='#data.FAO_country2'><p>Food insecurity data for a GWP pilot country (Country2).</p></a></li>
<li><a href='#data.FAO_country3'><p>Food insecurity data for a GWP pilot country (Country3).</p></a></li>
<li><a href='#data.FAO_country4'><p>Food insecurity data for a GWP pilot country (Country4).</p></a></li>
<li><a href='#equating.fun'><p>Equating scales between different application contexts.</p></a></li>
<li><a href='#EWaldtest'><p>Wald test to check sampling independence under CML.</p></a></li>
<li><a href='#ICC.fun'><p>Item caracteristic curves computation and plotting under CML.</p></a></li>
<li><a href='#internals'><p>Internal Functions</p></a></li>
<li><a href='#PC.w'><p>Estimation of the weighted partial credit model using CML</p></a></li>
<li><a href='#prob.assign'><p>Probabilistic assignment of cases to classes of severity along the latent trait.</p></a></li>
<li><a href='#RM.w'><p>Estimation of the weighted Rasch model using CML</p></a></li>
<li><a href='#RT.thres'><p>Rasch-Thurstone thresholds for trichotomous scales under CML.</p></a></li>
<li><a href='#tab.weight'><p>Rasch descriptives and weighted tables.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Weighted Rasch Modeling and Extensions using Conditional Maximum
Likelihood</td>
</tr>
<tr>
<td>Author:</td>
<td>Carlo Cafiero, Sara Viviani, Mark Nord </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sara Viviani &lt;sara.viviani@yahoo.it&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), psychotools, Hmisc</td>
</tr>
<tr>
<td>Description:</td>
<td>Rasch model and extensions for survey data, using Conditional Maximum likelihood (CML). Carlo Cafiero, Sara Viviani, Mark Nord (2018) &lt;<a href="https://doi.org/10.1016%2Fj.measurement.2017.10.065">doi:10.1016/j.measurement.2017.10.065</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3.0.0)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-04-19 13:56:37 UTC; saraviviani</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-04-20 08:47:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='RM.weights-package'>
Rasch model and extensions for survey data, using Conditional Maximum likelihood (CML). 
</h2><span id='topic+RM.weights-package'></span>

<h3>Description</h3>

<p>This package computes parameter estimates and assessment statistics of a single-parameter Rasch model for dichotomous and polytomous (partial credit) item responses using CML estimation, including optional use of sampling weights. Procedures to calculate prevalence rates of the phenomenon of interest (latent variable) and to equate item parameters across different contexts are implemented.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> RM.weights </td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package </td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0 </td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-11-14 </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;">  GPL (&gt;= 3) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Carlo Cafiero, Mark Nord, Sara Viviani
</p>
<p>Maintainer: Sara Viviani &lt;sara.viviani@fao.org&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(data.FAO_country1_2013)
# Questionnaire data and weights
XX = data.FAO_country1_2013[,1:8]
wt = data.FAO_country1_2013$wt
# Fit weighted Rasch
rr = RM.w(XX, wt)
pp = prob.assign(rr, sthres = seq(-5, 5, 0.01))

## End(Not run)
</code></pre>

<hr>
<h2 id='data.FAO_country1'>Food insecurity data for a GWP country (Country1).</h2><span id='topic+data.FAO_country1'></span>

<h3>Description</h3>

<p>The dataset includes the FIES data (Food Insecurity Experience based Scale), sampling weights, and some demographic variables for a sample country (Country1). Data have been collected by the Gallup World Poll. 
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data.FAO_country1_+3A_worried">WORRIED</code></td>
<td>
<p>FIES question n. 1. During the past 12 months, was there a time when you were worried you would run out of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_healthy">HEALTHY</code></td>
<td>
<p>FIES question n. 2. During the past 12 months, was there a time when you were unable to eat healty and nutritious food because of 
lack of money or other resources?</p>
</td></tr> 
<tr><td><code id="data.FAO_country1_+3A_fewfood">FEWFOOD</code></td>
<td>
<p>FIES question n. 3. During the past 12 months, was there a time when you ate only few kinds of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_skipped">SKIPPED</code></td>
<td>
<p>FIES question n. 4. During the past 12 months, was there a time when you had to skip a meal because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_ateless">ATELESS</code></td>
<td>
<p>FIES question n. 5. During the past 12 months, was there a time when you ate less than you thought you should because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_runout">RUNOUT</code></td>
<td>
<p>FIES question n. 6. During the past 12 months, was there a time when your household ran out of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_hungry">HUNGRY</code></td>
<td>
<p>FIES question n. 7. During the past 12 months, was there a time when you were hungry but did not eat because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_whlday">WHLDAY</code></td>
<td>
<p>FIES question n. 8. During the past 12 months, was there a time when you went without eating for a whole day because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_gender">gender</code></td>
<td>
<p>Respondents' gender.</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_age">age</code></td>
<td>
<p>Respondents' age.</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_education">education</code></td>
<td>
<p>Respondents' education.</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_urbanrural">urbanrural</code></td>
<td>
<p>Respondents' area (urban or rural).</p>
</td></tr>
<tr><td><code id="data.FAO_country1_+3A_wt">wt</code></td>
<td>
<p>Sampling weights.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(data.FAO_country1)
# Matrix of questionnaire data and weights (for the Rasch analysis)
XX.country1 = data.FAO_country1[,1:8]
wt.country1 = data.FAO_country1$wt

## End(Not run)
</code></pre>

<hr>
<h2 id='data.FAO_country2'>Food insecurity data for a GWP pilot country (Country2).</h2><span id='topic+data.FAO_country2'></span>

<h3>Description</h3>

<p>The dataset includes the FIES data (Food Insecurity Experience based Scale), sampling weights, and some demographic variables for a sample country (Country2). Data have been collected by the Gallup World Poll. 
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data.FAO_country2_+3A_worried">WORRIED</code></td>
<td>
<p>FIES question n. 1. During the past 12 months, was there a time when you were worried you would run out of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_healthy">HEALTHY</code></td>
<td>
<p>FIES question n. 2. During the past 12 months, was there a time when you were unable to eat healty and nutritious food because of 
lack of money or other resources?</p>
</td></tr> 
<tr><td><code id="data.FAO_country2_+3A_fewfood">FEWFOOD</code></td>
<td>
<p>FIES question n. 3. During the past 12 months, was there a time when you ate only few kinds of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_skipped">SKIPPED</code></td>
<td>
<p>FIES question n. 4. During the past 12 months, was there a time when you had to skip a meal because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_ateless">ATELESS</code></td>
<td>
<p>FIES question n. 5. During the past 12 months, was there a time when you ate less than you thought you should because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_runout">RUNOUT</code></td>
<td>
<p>FIES question n. 6. During the past 12 months, was there a time when your household ran out of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_hungry">HUNGRY</code></td>
<td>
<p>FIES question n. 7. During the past 12 months, was there a time when you were hungry but did not eat because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_whlday">WHLDAY</code></td>
<td>
<p>FIES question n. 8. During the past 12 months, was there a time when you went without eating for a whole day because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_gender">gender</code></td>
<td>
<p>Respondents' gender.</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_age">age</code></td>
<td>
<p>Respondents' age.</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_education">education</code></td>
<td>
<p>Respondents' education.</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_urbanrural">urbanrural</code></td>
<td>
<p>Respondents' area (urban or rural).</p>
</td></tr>
<tr><td><code id="data.FAO_country2_+3A_wt">wt</code></td>
<td>
<p>Sampling weights.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(data.FAO_country2)
# Matrix of questionnaire data and weights (for the Rasch analysis)
XX.country2 = data.FAO_country2[,1:8]
wt.country2 = data.FAO_country2$wt

## End(Not run)
</code></pre>

<hr>
<h2 id='data.FAO_country3'>Food insecurity data for a GWP pilot country (Country3).</h2><span id='topic+data.FAO_country3'></span>

<h3>Description</h3>

<p>The dataset includes the FIES data (Food Insecurity Experience based Scale), sampling weights, and some demographic variables for a sample country (Country1). Data have been collected by the Gallup World Poll. 
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data.FAO_country3_+3A_worried">WORRIED</code></td>
<td>
<p>FIES question n. 1. During the past 12 months, was there a time when you were worried you would run out of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_healthy">HEALTHY</code></td>
<td>
<p>FIES question n. 2. During the past 12 months, was there a time when you were unable to eat healty and nutritious food because of 
lack of money or other resources?</p>
</td></tr> 
<tr><td><code id="data.FAO_country3_+3A_fewfood">FEWFOOD</code></td>
<td>
<p>FIES question n. 3. During the past 12 months, was there a time when you ate only few kinds of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_skipped">SKIPPED</code></td>
<td>
<p>FIES question n. 4. During the past 12 months, was there a time when you had to skip a meal because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_ateless">ATELESS</code></td>
<td>
<p>FIES question n. 5. During the past 12 months, was there a time when you ate less than you thought you should because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_runout">RUNOUT</code></td>
<td>
<p>FIES question n. 6. During the past 12 months, was there a time when your household ran out of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_hungry">HUNGRY</code></td>
<td>
<p>FIES question n. 7. During the past 12 months, was there a time when you were hungry but did not eat because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_whlday">WHLDAY</code></td>
<td>
<p>FIES question n. 8. During the past 12 months, was there a time when you went without eating for a whole day because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_gender">gender</code></td>
<td>
<p>Respondents' gender.</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_age">age</code></td>
<td>
<p>Respondents' age.</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_education">education</code></td>
<td>
<p>Respondents' education.</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_urbanrural">urbanrural</code></td>
<td>
<p>Respondents' area (urban or rural).</p>
</td></tr>
<tr><td><code id="data.FAO_country3_+3A_wt">wt</code></td>
<td>
<p>Sampling weights.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(data.FAO_country3)
# Matrix of questionnaire data and weights (for the Rasch analysis)
XX.country3 = data.FAO_country3[,1:8]
wt.country3 = data.FAO_country3$wt

## End(Not run)
</code></pre>

<hr>
<h2 id='data.FAO_country4'>Food insecurity data for a GWP pilot country (Country4).</h2><span id='topic+data.FAO_country4'></span>

<h3>Description</h3>

<p>The dataset includes the FIES data (Food Insecurity Experience based Scale), sampling weights, and some demographic variables for a sample country (Country4). Data have been collected by the Gallup World Poll. 
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data.FAO_country4_+3A_worried">WORRIED</code></td>
<td>
<p>FIES question n. 1. During the past 12 months, was there a time when you were worried you would run out of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_healthy">HEALTHY</code></td>
<td>
<p>FIES question n. 2. During the past 12 months, was there a time when you were unable to eat healty and nutritious food because of 
lack of money or other resources?</p>
</td></tr> 
<tr><td><code id="data.FAO_country4_+3A_fewfood">FEWFOOD</code></td>
<td>
<p>FIES question n. 3. During the past 12 months, was there a time when you ate only few kinds of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_skipped">SKIPPED</code></td>
<td>
<p>FIES question n. 4. During the past 12 months, was there a time when you had to skip a meal because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_ateless">ATELESS</code></td>
<td>
<p>FIES question n. 5. During the past 12 months, was there a time when you ate less than you thought you should because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_runout">RUNOUT</code></td>
<td>
<p>FIES question n. 6. During the past 12 months, was there a time when your household ran out of food because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_hungry">HUNGRY</code></td>
<td>
<p>FIES question n. 7. During the past 12 months, was there a time when you were hungry but did not eat because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_whlday">WHLDAY</code></td>
<td>
<p>FIES question n. 8. During the past 12 months, was there a time when you went without eating for a whole day because of 
lack of money or other resources?</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_gender">gender</code></td>
<td>
<p>Respondents' gender.</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_age">age</code></td>
<td>
<p>Respondents' age.</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_education">education</code></td>
<td>
<p>Respondents' education.</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_urbanrural">urbanrural</code></td>
<td>
<p>Respondents' area (urban or rural).</p>
</td></tr>
<tr><td><code id="data.FAO_country4_+3A_wt">wt</code></td>
<td>
<p>Sampling weights.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(data.FAO_country4)
# Matrix of questionnaire data and weights (for the Rasch analysis)
XX.country4 = data.FAO_country4[,1:8]
wt.country4 = data.FAO_country4$wt

## End(Not run)
</code></pre>

<hr>
<h2 id='equating.fun'>Equating scales between different application contexts.</h2><span id='topic+equating.fun'></span>

<h3>Description</h3>

<p>This function calibrates the measure derived by a scale applied in one context (for example, country) to the metric of a reference scale, or standard (for example, the scale applied in another country, or in the same country but through a different survey, or to any other standard).
The main output is the prevalence rate in the country of interest calculated at specified thresholds along the latent trait. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>equating.fun(rr1, st=NULL, tol = .35, spec.com1 = 1:8, spec.com2=1:8, 
thres = NULL, maxuniq=3, write.file=FALSE, plot=FALSE, iterative=TRUE, excl.prior1=NULL,
excl.prior2=NULL, wt.spec=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="equating.fun_+3A_rr1">rr1</code></td>
<td>
<p>The Rasch model fitted with the <code>RM.w</code> function for the country of interest.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_st">st</code></td>
<td>
<p>Item severity parameter estimates for the reference country or the standard. The number of items for the standard may differ from the number of items of the country of interest. If left unspecified, the 2014-2016 FAO global standard for the Food Insecurity Experience Scale (FIES) is set as default.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_tol">tol</code></td>
<td>
<p>Tolerance expressed in the metric of the standard, above which items are considered unique (i.e. not contributing to the common metric between the two countries). Default is <code>0.35</code>.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_spec.com1">spec.com1</code></td>
<td>
<p>A priori numbered set of comparable items for the country of iterest to the standard. Items must be specified in the same order as they are used for the comparison.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_spec.com2">spec.com2</code></td>
<td>
<p>A priori set of comparable items for the standard. The length of <code>spec.com1</code> and <code>spec.com2</code> should be the same.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_thres">thres</code></td>
<td>
<p>Thresholds (along the latent trait) corresponding to which the comparable prevalence rates of the phenomenon of interest is calculated. Default is set to the 5-th
and the 8-th item of the standard specified in <code>st</code>.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_maxuniq">maxuniq</code></td>
<td>
<p>A priori maximum number of unique items allowed.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_write.file">write.file</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, a csv file with the relevant information about the 
equating process is created in the working directory.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_plot">plot</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, a pdf file with a plot of the equated item severities is produced in the working directory. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_iterative">iterative</code></td>
<td>
<p>Logical argument. If <code>TRUE</code>, an iterative process to identify which item is unique is performed. Otherwise, unique items are specified in the arguments <code>excl.prior1</code> and <code>excl.prior2</code> and are taken as fixed.  Default is <code>TRUE</code>. </p>
</td></tr>
<tr><td><code id="equating.fun_+3A_excl.prior1">excl.prior1</code></td>
<td>
<p>Numbered set of fixed unique items for the country of interest. It needs to be specified only if <code>iterative = FALSE</code>.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_excl.prior2">excl.prior2</code></td>
<td>
<p>Numbered set of fixed unique items for the standard. It needs to be specified only if <code>iterative = FALSE</code>.</p>
</td></tr>
<tr><td><code id="equating.fun_+3A_wt.spec">wt.spec</code></td>
<td>
<p>Specified post-stratification sampling weights. If left unspecified, prevalence rates will be calculated using the weighting variable <code>rr1$wt</code>, otherwise the variable <code>wt.spec</code> will be considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>scale</code></td>
<td>
<p>Scale parameter to be applied to the metric of the country of interest to be considered equivalent to the standard. </p>
</td></tr>
<tr><td><code>shift</code></td>
<td>
<p>Shift parameter to be applied to the metric of the country of interest to be considered equivalent to the reference country. The standardized item parameters for the country of interest will be:
b.country.st=shift+scale*b.country
where b.country are estimated item severities for the country of interest.
</p>
</td></tr>
<tr><td><code>common</code></td>
<td>
<p>Vector of characters indicating if the item in the country of interest is common compared with the standard.</p>
</td></tr>
<tr><td><code>prevs</code></td>
<td>
<p>Prevalence rates for the country of interest, calculated at the adjusted thresholds.</p>
</td></tr>
<tr><td><code>probs.rs</code></td>
<td>
<p>Probability of being bejond the adjusted thresholds calculated at each raw score.</p>
</td></tr>
<tr><td><code>cor.comm.items</code></td>
<td>
<p>Correlation between common items.</p>
</td></tr>
<tr><td><code>adj.thres</code></td>
<td>
<p>Adjusted (equated) thresholds on the country metric.</p>
</td></tr>
<tr><td><code>standard</code></td>
<td>
<p>The standard against which the country is compared. If the <code>st</code> argument is left unspecified, the 2014-2016 FAO global standard for the Food Insecurity Experience scale is returned.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a></p>


<h3>See Also</h3>

<p>prob.assign</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data.FAO_country1)
XX.country1 = data.FAO_country1[,1:8]
wt.country1 = data.FAO_country1$wt
rr1=RM.w(XX.country1, wt.country1)
data(data.FAO_country2)
XX.country2 = data.FAO_country2[,1:8]
wt.country2 = data.FAO_country2$wt
rr2=RM.w(XX.country2, wt.country2)
# Iterative equating
ee1=equating.fun(rr1, st=rr2$b, thres=c(-0.28, 1.85), spec.com1=c(1:8),spec.com2=c(1:8))
# Not iterative equating: fixing WORRIED unique
ee2=equating.fun(rr1, st=rr2$b, thres=c(-0.28, 1.85),spec.com1=c(1:8),
spec.com2=c(1:8), tol = .4,iterative=FALSE,excl.prior1=1,excl.prior2=1)
# Prevalence rates
ee1$prevs
ee2$prevs
</code></pre>

<hr>
<h2 id='EWaldtest'>Wald test to check sampling independence under CML.</h2><span id='topic+EWaldtest'></span>

<h3>Description</h3>

<p>This function performs a Wald test of sampling independence on item severity parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EWaldtest(b1, b2, se1, se2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EWaldtest_+3A_b1">b1</code></td>
<td>
<p>Item severity vector estimated on the first sample subset.</p>
</td></tr>
<tr><td><code id="EWaldtest_+3A_b2">b2</code></td>
<td>
<p>Item severity vector estimated on the second sample subset (complementary to the one used to estimate <code>b1</code>).</p>
</td></tr>
<tr><td><code id="EWaldtest_+3A_se1">se1</code></td>
<td>
<p>Item standard errors (first sub-sample).</p>
</td></tr>
<tr><td><code id="EWaldtest_+3A_se2">se2</code></td>
<td>
<p>Item standard errors (second sub-sample).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the Wald test to check if the sampling independence assumption holds. The test statistics is 
</p>
<p style="text-align: center;"><code class="reqn">
   z = \frac{\hat{b}_1 - \hat{b}_2}{\sqrt{Var(\hat{b}_1) + Var(\hat{b}_2)}},
   </code>
</p>

<p>where <code class="reqn">\hat{b}_1</code> and <code class="reqn">\hat{b}_2</code> are the ML item parameter estimates computed on two, randomly extracted and complementary, sub-samples of the overall sample, and <code class="reqn">Var(\hat{b}_1)</code> and <code class="reqn">Var(\hat{b}_2)</code> the corresponding variances.
</p>
<p>The null hypothesis is of parameter estimates equality while the alternative hypothesis is bilateral (<code class="reqn">b_1 \neq b_2</code>).
</p>
<p>The sampling independence assumption implies that item severity parameter estimates do not depend on the analysed samples, but only on the severity of the items themselves. One way to check for this assumption is to extract two (complementary) random samples from the original sample and run the Wald test, or, more accurately, to extract <code>B</code> random sub-samples and observe the p-values distribution for each item. 
</p>


<h3>Value</h3>

<p>A list with the following elements: 
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>z</code> </td><td style="text-align: left;"> The z-statistics of the Wald test. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>p</code> </td><td style="text-align: left;"> Computed p-value of the Wald test. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>tab</code> </td><td style="text-align: left;"> Descriptive table with test results. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+RM.w">RM.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data.FAO_country3)
# Questionnaire data and weights
XX.country3 = data.FAO_country3[,1:8]
wt.country3 = data.FAO_country3$wt

# Split the sample in two random sub-samples
n = nrow(XX.country3)
samp1 = sample(1:n, n/2)
samp2 = setdiff(1:n, samp1)
# Fit two Rasch models on the two sub-samples
rr1 = RM.w(XX.country3[samp1, ], wt.country3[samp1])
rr2 = RM.w(XX.country3[samp2, ], wt.country3[samp2])
# Test sampling independence
EWaldtest(rr1$b, rr2$b, rr1$se.b, rr2$se.b)$tab
</code></pre>

<hr>
<h2 id='ICC.fun'>Item caracteristic curves computation and plotting under CML.</h2><span id='topic+ICC.fun'></span>

<h3>Description</h3>

<p>Computation and plotting of item caracteristic curves (ICCs) under conditional maximum likelihood (CML).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICC.fun(b, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ICC.fun_+3A_b">b</code></td>
<td>
<p>Item severity vector estimated under CML.</p>
</td></tr>
<tr><td><code id="ICC.fun_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the ICCs are plotted.</p>
</td></tr>
</table>


<h3>Value</h3>


<table>
<tr>
 <td style="text-align: left;">
	<code>icc</code> </td><td style="text-align: left;"> Matrix of item characteristic curves. Coloumns are items
  and rows are severity levels. </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+RM.w">RM.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data.FAO_country2)
# Questionnaire data and weights
XX.country2 = data.FAO_country2[,1:8]
wt.country2 = data.FAO_country2$wt
# Fit weighted Rasch
rr.country2 = RM.w(XX.country2, wt.country2)
b=rr.country2$b
# ICC values
icc = ICC.fun(b)$icc
# ICC plot
icc = ICC.fun(b, plot = TRUE)
</code></pre>

<hr>
<h2 id='internals'>Internal Functions</h2><span id='topic+internals'></span>

<h3>Description</h3>

<p>These functions are for internal use only or not yet documented.
</p>


<h3>Author(s)</h3>

<p>Sara Viviani</p>

<hr>
<h2 id='PC.w'>Estimation of the weighted partial credit model using CML</h2><span id='topic+PC.w'></span>

<h3>Description</h3>

<p>This function estimates item and raw score parameters of a partial credit Rasch model which may include both dichotomous and polytomous item responses by using weighted CML estimation. The maximum number of response categories allowed is 4. Input data should be a 0/1 matrix (1 = Yes) for the dichotomous items and 0/1/2 or 0/1/2/3 for the polytomous items. Residual correlation, fit statistics and Rasch reliability are also reported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PC.w(XX, wt=NULL, extr=NULL, maxiter=100,minconv=.00001,country=NULL,
write.file=FALSE, recode = 0, write.iteration=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PC.w_+3A_xx">XX</code></td>
<td>
<p>Input data matrix or data frame. Rows represent respondents, columns represent items. Dichotomous items are coded 0/1, polytomous items are coded 0/1/2 or 0/1/2/3; negative responses must be coded as 0s. Missing values must be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="PC.w_+3A_wt">wt</code></td>
<td>
<p>Vector of sampling weights. 
The length must be the same as the number of rows of <code>XX</code>. 
If left unspecified, 
all the individuals will be equally weighted (<code>wt = rep(1, nrow(XX)))</code>. </p>
</td></tr>
<tr><td><code id="PC.w_+3A_extr">extr</code></td>
<td>
<p>Optional vector for the assumption on the extreme raw score parameters. Default is <code>0.5</code> and <code>(k-0.5)</code>,  <code>k</code> being the maximum number of response categories.</p>
</td></tr> 
<tr><td><code id="PC.w_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations for convergence when parameter estimation is performed.</p>
</td></tr>
<tr><td><code id="PC.w_+3A_minconv">minconv</code></td>
<td>
<p>Minimum difference between parameter estimates considering two consecutive iterations for convergence.</p>
</td></tr>
<tr><td><code id="PC.w_+3A_country">country</code></td>
<td>
<p>Optional (character) name of the dataset.</p>
</td></tr>
<tr><td><code id="PC.w_+3A_write.file">write.file</code></td>
<td>
<p>If <code>TRUE</code>, a CSV file with the main model results will be saved in the working directory.</p>
</td></tr>
<tr><td><code id="PC.w_+3A_recode">recode</code></td>
<td>
<p>It can be 0, 1, 2 or 3. <code>recode = 0</code> does not imply any category aggregation. <code>recode = 1</code> aggregates the two more severe categories (for example, Sometimes and Always). <code>recode=2</code>  aggregates the two middle categories (for example, Rarely and Sometimes). <code>recode=3</code>  aggregates the two less severe categories (for example, Never and Rarely). Default is <code>0</code>.</p>
</td></tr>
<tr><td><code id="PC.w_+3A_write.iteration">write.iteration</code></td>
<td>
<p>If set <code>TRUE</code> a CSV file with information on the iteration process is produced in the working directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The weighted CML method is used to estimate the item and Rasch-Thurstone parameters. Respondent parameters  are estimated post-hoc as maximum likelihood given the item parameters. Cases with missing responses to some items can be included, but will not be used to estimate the Rasch model. Missing responses should be coded as <code>NA</code> in the input data file. If the total possible raw score is higher than 15, computer precision limits may distort results.
</p>
<p>As the parameters for the extreme raw scores (<code>0</code> and <code>k</code>), are undefined under the CML, some assumptions are needed unless the proportions of respondents with those raw scores are so small that they can be considered to be measured without error. 
Vector <code>extr</code>  gives the option to include one assumption on the pseudo-raw-score on which raw score zero will be based and one assumption on the pseudo-raw-score on which raw score <code>k</code> will be based. The assumption for raw score zero can be a number between 0 and 1 (extremes excluded). The assumption for raw score <code>k</code> can be a number between <code>k-1</code> and <code>k</code> (extremes excluded).
</p>


<h3>Value</h3>

<p>A list with the following elements: 
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>b</code> </td><td style="text-align: left;"> Matrix of Rasch-Thurstone (R-T) thresholds (corresponding to item severity parameters in a Rasch model for dichotomous data). </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>se.b</code> </td><td style="text-align: left;"> Matrix of standard errors for R-T thresholds. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
  <code>infit</code> </td><td style="text-align: left;"> Infit statistics corresponding to each R-T threshold. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
  <code>outfit</code> </td><td style="text-align: left;"> Outfit statistics corresponding to each R-T threshold. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>reliab</code> </td><td style="text-align: left;"> Rasch reliability. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>reliab.fl</code> </td><td style="text-align: left;"> Rasch reliability (equally weighted across raw scores). To be used for comparisons. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>RS_distr</code> </td><td style="text-align: left;"> Distribution of cases across raw scores (weighted and unweighted). </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>res.cor</code> </td><td style="text-align: left;"> Matrix of residual correlation. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>a</code> </td><td style="text-align: left;"> Vector of raw score parameters. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>se.a</code> </td><td style="text-align: left;"> Vector of raw score parameter errors (or measurement errors). </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>XX</code> </td><td style="text-align: left;"> Data matrix (after recoding). </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>wt</code> </td><td style="text-align: left;"> Vector of sampling weights. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>d</code> </td><td style="text-align: left;"> Pseudo-raw-scores used for the estimation of extreme parameters. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>N_valid_w</code> </td><td style="text-align: left;"> Number of cases with any valid response.  </td>
</tr>
<tr>
 <td style="text-align: left;"> 
  <code>Perc_valid_w</code> </td><td style="text-align: left;"> Percentage of cases with any valid response. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
  <code>N_tot</code> </td><td style="text-align: left;"> Total sample size. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
  <code>N_compl</code> </td><td style="text-align: left;"> Number of complete non-extreme cases. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a>, Mark Nord <a href="mailto:mark.nord@fao.org">mark.nord@fao.org</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data.FAO_country1)
# Questionnaire data and weights
XX.country1 = data.FAO_country1[,1:8]
XX.country1[,c(7,8)] = cbind(rbinom(nrow(XX.country1), 3, .5), rbinom(nrow(XX.country1), 3, .4)) 
wt.country1 = data.FAO_country1$wt
# Fit weighted partial credit model with aggregation of the two more severe categories
rr.country1.pol2 = PC.w(XX.country1, wt.country1, recode = 1)
</code></pre>

<hr>
<h2 id='prob.assign'>Probabilistic assignment of cases to classes of severity along the latent trait.</h2><span id='topic+prob.assign'></span>

<h3>Description</h3>

<p>This function assigns cases probabilistically to classes of severity along the latent trait. This procedure is useful when different (cultural-geographical-linguistic) contexts are compared in terms of the prevalence of some phenomenon. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob.assign(rr=NULL,  rwthres = NULL, sthres = NULL, 
eps.a = NULL, flex = list(a=NULL, se.a=NULL, d=NULL, XX=NULL, wt=NULL))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prob.assign_+3A_rr">rr</code></td>
<td>
<p>An object of <code>RM.w</code> type.</p>
</td></tr>
<tr><td><code id="prob.assign_+3A_rwthres">rwthres</code></td>
<td>
<p>Raw score thresholds. If this argument is specified, corresponding thresholds on the latent trait (<code>thres</code>) are provided as output.</p>
</td></tr>
<tr><td><code id="prob.assign_+3A_sthres">sthres</code></td>
<td>
<p>Alternative argument to <code>rwthres</code>. Thresholds on the latent trait. If this argument is specified, probability of being beyond the specified thresholds (<code>sprob</code>) is provided as output.</p>
</td></tr>
<tr><td><code id="prob.assign_+3A_eps.a">eps.a</code></td>
<td>
<p>Tolerance for the algorithm that estimates thresholds on the latent trait corresponding to the specified thresholds in terms of raw score (<code>rwthres</code>). If left unspecified, the tolerance to convergence is <code>0.001</code>.</p>
</td></tr>
<tr><td><code id="prob.assign_+3A_flex">flex</code></td>
<td>
<p>Alternative argument to <code>rr</code>. If <code>rr=NULL</code>, than <code>flex</code> needs
to be specified as a list with the following arguments: <code>a</code> (person parameters), <code>se.a</code> (person parameter standard errors),
<code>d</code> (pseudo-raw-scores for estimation of extreme raw score parameters; if left unspecified leads to estimate the <code>k</code>-th raw score parameter at location <code>(k-1)+0.5</code>), <code>XX</code> (input data matrix or data frame), <code>wt</code> (sampling weights; if left unspecified leads to sampling weights equal to one for all subjects).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probabilistic assignment procedure is particularly useful when comparing results between different populations that might have interpreted some items of a scale differently. The distribution of the raw score is assumed to be a mixture of Gaussian densities, each centred on the raw score parameters (estimated using the Rasch model) and scaled with corresponding measurement errors. The resulting (complementary) cumulative prevalence, weighted by the proportion of individuals in each raw score, is as follows:
</p>
<p style="text-align: center;"><code class="reqn">
P(x)= \sum_{i=0}^N (1-\int_{-Inf}^x f_i(t)dt) p_i = 
\sum_{i=0}^N (1-F_i(x)) p_i,
</code>
</p>

<p>where <code class="reqn">f_i</code> is the probability density function (and <code class="reqn">F_i</code> is the cumulative distribution function) of severity levels centred on raw score parameter <code class="reqn">i</code> and scaled with the corresponding measurement error, <code class="reqn">p_i</code> is the proportion observed in raw score <code class="reqn">i</code>, and <code class="reqn">N</code> is the maximum number of items. The function <code class="reqn">P(x)</code> can be used to trace a continuous profile of prevalence on the latent trait for the phenomenon of interest. It allows to equate different metrics and it facilitates cross-cultural comparisons.
The <code>prob.assign</code> function can be used in two ways: providing the <code>rwthres</code> argument, i.e. specifying thresholds in terms of raw score, it provides the estimation of the thresholds on the latent trait that correspond to the raw score thresholds;  providing the <code>sthres</code> argument, i.e. specifying thresholds on the latent trait, it provides the probability of being beyond the specified thresholds for the population of interest.
</p>


<h3>Value</h3>

<p>A list with the following elements: 
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>sprob</code> </td><td style="text-align: left;"> Estimated weighted probability of being beyond thresholds provided in <code>sthres</code> (<code class="reqn">P(x)</code>). If <code>sthres</code> argument is not specified, the <code>sprob</code> value is <code>NULL</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>thres</code> </td><td style="text-align: left;"> Thresholds on the latent trait calculated corresponding to thresholds in terms of raw-score specified in <code>rwthres</code>. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	<code>f</code> </td><td style="text-align: left;"> Probability of being beyond the <code>thres</code> thresholds distributed across raw scores. If more than one assumption on the exreme raw scores is made in <code>rr</code>, it is a list of a number of elements equal to the number of assumptions made. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	<code>p</code> </td><td style="text-align: left;"> Empirical (weighted) distribution beyond the raw scores specified in <code>rwthres</code>. If only one assumption on the extreme raw scores is made, then 
  <code>colSums(f)</code> is approximately equal to <code>p</code>, where the order of approximation depends on 
  <code>eps.a</code>.</td>
</tr>
<tr>
 <td style="text-align: left;"> 
  <code>f_j</code> </td><td style="text-align: left;"> Empirical (weighted) distribution across the raw scores. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a>, Mark Nord <a href="mailto:mark.nord@fao.org">mark.nord@fao.org</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+RM.w">RM.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data.FAO_country1)
# Questionnaire data and weights
XX.country1 = data.FAO_country1[,1:8]
wt.country1 = data.FAO_country1$wt
# Fit weighted Rasch
rr.country1 = RM.w(XX.country1, wt.country1)

# Thresholds on the latent trait corresponding to a given raw score
pp.country1 = prob.assign(rr.country1, rwthres = c(3, 7))

# Table with prevalences and thresholds
tab = cbind("Raw score" = c(3, 7), "Latent trait" =  pp.country1$thres, 
"Prevalence" = colSums(pp.country1$f))
rownames(tab) = c("Thres 1","Thres 2")
tab

# Pre-defined thresholds on the latent trait
sthresh = c(-0.25, 1.81)
pp.country1.2 = prob.assign(rr.country1, sthres = sthresh)$sprob
# Probability of being beyond -0.25 on the latent trait in country 1 
pp.country1.2[1]*100
# Probability of being beyond 1.81 on the latent trait in country 1 
pp.country1.2[2]*100

# More than 2 extremes
# Fit the model
rr.country1.d = RM.w(XX.country1, wt.country1, .d = c(0.5, 7.5, 7.7))
# Probabilistic assignment
pp.country1.d = prob.assign(rr.country1.d, sthres = sthresh)$sprob
# Probability of being beyond -0.25 on the latent trait in country 1 
# using upper assumption on the extreme raw score parameter 8
pp.country1.d[[1]]*100
# Probability of being beyond -0.25 on the latent trait in country 1 
# using lower assumption on the extreme raw score parameter 8
pp.country1.d[[2]]*100
</code></pre>

<hr>
<h2 id='RM.w'>Estimation of the weighted Rasch model using CML</h2><span id='topic+RM.w'></span>

<h3>Description</h3>

<p>This function computes item and raw score parameter estimates of a Rasch model for binary item responses by using weighted CML estimation. Input data should be a 0/1 matrix (1 = Yes). Residual correlation, fit statistics and corresponding standard errors, Rasch reliability and individual fit statistics are also reported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RM.w(.data, .w = NULL, .d=NULL, country=NULL, se.control = TRUE, 
quantile.seq = NULL, write.file = FALSE, max.it=100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RM.w_+3A_.data">.data</code></td>
<td>
<p>Input 0/1 data matrix or data frame; 
affirmative responses must be coded as 1s. Rows represent respondents, columns represent items. Missing values must be coded as <code>NA</code>.</p>
</td></tr>
<tr><td><code id="RM.w_+3A_.w">.w</code></td>
<td>
<p>Vector of sampling weights. 
The length must be the same as the number of rows of <code>.data</code>. 
If left unspecified, 
all the individuals will be equally weighted (<code>.w = rep(1, nrow(.data)))</code>. </p>
</td></tr>
<tr><td><code id="RM.w_+3A_.d">.d</code></td>
<td>
<p>Optional vector for the assumption on the extreme raw score parameters. 
Default is <code>0.5</code> and <code>(k-0.5)</code>,  <code>k</code> being the maximum number of items 
(columns of <code>.data</code>).</p>
</td></tr> 
<tr><td><code id="RM.w_+3A_country">country</code></td>
<td>
<p>Optional (character) name of the dataset.</p>
</td></tr>
<tr><td><code id="RM.w_+3A_se.control">se.control</code></td>
<td>
<p>Are the measurement errors for respondent extreme parameters to be calculated based on raw scores <code>0.5</code> and <code>(k-0.5)</code>? If <code>FALSE</code>, measurement errors for those parameters are based on the pseudo-raw-scores specified in the <code>.d</code> vector. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="RM.w_+3A_quantile.seq">quantile.seq</code></td>
<td>
<p>Quantiles corresponding to the observed and the expected 
individual fit statistic distributions. Default is <code>seq(0,1,0.01)</code>.</p>
</td></tr>
<tr><td><code id="RM.w_+3A_write.file">write.file</code></td>
<td>
<p>If <code>TRUE</code>, a CSV file with the main results will be saved 
in the working directory.</p>
</td></tr>
<tr><td><code id="RM.w_+3A_max.it">max.it</code></td>
<td>
<p>Maximum number of iterations item parameters' estimation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The weighted CML method is used to estimate the item parameters. Respondent parameters  are estimated post-hoc as maximum likelihood given the item parameters. Cases with missing responses to some items can be included in the input data, but will not be used to estimate the Rasch model. Missing responses should be coded as <code>NA</code> in the input data file.
</p>
<p>As the parameters for the extreme raw scores (<code>0</code> and <code>k</code>), are undefined under the CML, some assumptions are needed unless the proportions of respondents with those raw scores are so small that they can be considered to be measured without error. 
Vector <code>.d</code>  gives the option to include up to four alternative assumptions on the pseudo-raw-scores on which calculation of parameters for extreme raw scores will be based. More in detail, <code>.d</code> can be a two, three or four element vector:
</p>

<ul>
<li><p> If <code>length(.d) = 4</code>, then the first two elements must refer to the assumptions for raw score 0, and the second two elements for raw score <code>k</code>. For instance <code>.d = c(0.1, 0.7, 7.1, 7.6)</code>, if the maximum raw score is 8.
</p>
</li>
<li><p> If <code>length(.d) = 3</code>, then the first two elements can either refer to the assumptions upon raw score <code>0</code> or raw score <code>k</code>, and the last one is defined accordingly. For instance <code>.d = c(0.1, 7.1, 7.6)</code> or <code>.d = c(0.1, 0.7, 7.6)</code>, if the maximum raw score is 8.
</p>
</li>
<li><p> If <code>length(.d) = 2</code>, then the first element must refer to the assumption for raw score <code>0</code>, and the second element for raw score <code>k</code>. For instance <code>.d = c(0.1, 7.6)</code>, if the maximum raw score is 8.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following elements: 
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>country</code> </td><td style="text-align: left;"> Name of the country or the application. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>b</code> </td><td style="text-align: left;"> Item severity parameters. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	<code>a</code> </td><td style="text-align: left;"> Raw score severity parameters. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>se.b</code> </td><td style="text-align: left;"> Item severities' standard error. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>se.a</code> </td><td style="text-align: left;"> Raw score parameters' standard error. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>infit</code> </td><td style="text-align: left;"> Items' infit statistics. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>outfit</code> </td><td style="text-align: left;"> Items' outfit statistics. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>reliab</code> </td><td style="text-align: left;"> Rasch reliability. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>reliab.fl</code> </td><td style="text-align: left;"> Rasch reliability (equally weighted across raw scores). </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>infit.person</code> </td><td style="text-align: left;"> Respondents' infits. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>outfit.person</code> </td><td style="text-align: left;"> Respondents' outfits. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>q.infit.theor</code> </td><td style="text-align: left;"> Quintiles of theoretical person infits. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>q.infit</code> </td><td style="text-align: left;"> Quintiles of person infits. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>q.outfit.theor</code> </td><td style="text-align: left;"> Quintiles of theoretical person outfits. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>q.outfit</code> </td><td style="text-align: left;"> Quintiles of person outfits. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>res.corr</code> </td><td style="text-align: left;"> Residual correlation matrix. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>se.infit</code> </td><td style="text-align: left;"> Standard errors of infits. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>mat.res</code> </td><td style="text-align: left;"> Matrix of individual residuals for each item. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>d</code> </td><td style="text-align: left;"> Pseudo raw scores for the calculation of extreme raw score parameters. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>XX</code> </td><td style="text-align: left;"> Data matrix. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>wt</code> </td><td style="text-align: left;"> Vector of post-stratification sampling weights. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>n.compl</code> </td><td style="text-align: left;"> Number of complete, non-extreme cases. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>wt.rs</code> </td><td style="text-align: left;"> Weighted (absolute) distribution of respondents across raw scores. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>wt.rs</code> </td><td style="text-align: left;"> Weighted (relative) distribution of respondents across raw scores. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>converged</code> </td><td style="text-align: left;"> Character indicating if the item estimation algorithm has reached convergence
or the maximum number of iterations has been reached without convergence. </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a>, Mark Nord <a href="mailto:mark.nord@fao.org">mark.nord@fao.org</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data.FAO_country1)
# Questionnaire data and weights
XX.country1 = data.FAO_country1[,1:8]
wt.country1 = data.FAO_country1$wt
# Fit weighted Rasch
rr.country1 = RM.w(XX.country1, wt.country1)
# Fit unweighted Rasch
rr.country1.nw = RM.w(XX.country1)

# Item severity
rr.country1$b

# Item standard error
rr.country1$se.b

# Respondent severity for each raw score
rr.country1$a

# Respondent measurement error for each raw score
rr.country1$se.a

# Item infit  
rr.country1$infit

# Item outfit 
rr.country1$outfit

# Rasch reliability based on observed distribution of cases across raw scores
rr.country1$reliab

# Rasch reliability  based on equal proportion of cases in each 
# non-extreme raw score (more comparable across datasets)
rr.country1$reliab.fl

# Checking conditional independence: residual correlation matrix 
rr.country1$res.cor

</code></pre>

<hr>
<h2 id='RT.thres'>Rasch-Thurstone thresholds for trichotomous scales under CML.</h2><span id='topic+RT.thres'></span>

<h3>Description</h3>

<p>Computes the Rasch-Thurstone thresholds for the CML estimation, starting from Rasch thresholds of a trichotomous scale. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RT.thres(R.thres)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RT.thres_+3A_r.thres">R.thres</code></td>
<td>
<p>Vector of rasch thresholds of a trichotomous scale, i.e. points on the latent trait corresponding to which the caracteristic curves of two consecutive categories cross.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Rasch-Thurstone (R-T) threshold for a given response category of an item is defined as the point on the latent trait at which the combined probability of response in that category and all more severe categories is .5. Conceptually, an R-T threshold for a given response category for a trichotomous item is comparable with the item severity parameter estimated for a dichotomous item coded 1 for that and all more severe categories and 0 for all less severe categories.
</p>


<h3>Value</h3>

<p>A list with the following elements: 
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>b1.rt</code> </td><td style="text-align: left;"> R-T threshold for the first category. </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>b2.rt</code> </td><td style="text-align: left;"> R-T threshold for the second category. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	<code>b12.rt</code> </td><td style="text-align: left;"> Vector of R-T thresholds for the first and second category. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
	</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a>, Mark Nord <a href="mailto:mark.nord@fao.org">mark.nord@fao.org</a></p>

<hr>
<h2 id='tab.weight'>Rasch descriptives and weighted tables.</h2><span id='topic+tab.weight'></span>

<h3>Description</h3>

<p>This function computes the main descriptive tables (number of affirmative responses to each item, weighted and unweighted distribution across raw scores, etc.), weighted and unweighted, for Rasch scale items and respondents. It also computes (univariate or bivariate) tables for user-specified variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tab.weight(variab, wt, XX = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tab.weight_+3A_variab">variab</code></td>
<td>
<p>It could be a single variable, or a list of two variables, 
of <code>factor</code> type.</p>
</td></tr>
<tr><td><code id="tab.weight_+3A_wt">wt</code></td>
<td>
<p>Vector of sampling weights. <code>length(variab) = length(wt)</code>.</p>
</td></tr>
<tr><td><code id="tab.weight_+3A_xx">XX</code></td>
<td>
<p>0/1 data matrix or data frame of responses to the questionnaire.
Affirmative responses must be coded as 1s. If left unspecified, basic descriptive 
statistics for Rasch analysis (number of Yes per item, weighted and unweighted 
distribution across raw scores, etc.) are not computed.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>RS.abs.w</code></td>
<td>
<p>Absolute weighted distribution across raw scores. Only computed when <code>XX</code> is not null.</p>
</td></tr>
<tr><td><code>RS.rel.w</code></td>
<td>
<p>Relative weighted distribution across raw scores. Only computed when <code>XX</code> is not null.</p>
</td></tr>
<tr><td><code>RS.abs</code></td>
<td>
<p>Absolute unweighted distribution across raw scores. Only computed when <code>XX</code> is not null.</p>
</td></tr>
<tr><td><code>RS.rel</code></td>
<td>
<p>Relative unweighted distribution across raw scores. Only computed when <code>XX</code> is not null.</p>
</td></tr>
<tr><td><code>Perc.Yes</code></td>
<td>
<p>Proportion of Yes responses to each item. Only computed when <code>XX</code> is not null.</p>
</td></tr>
<tr><td><code>Perc.Yes.w</code></td>
<td>
<p>Weighted proportion of Yes responses to each item. Only computed when <code>XX</code> is not null. Only computed when <code>XX</code> is not null.</p>
</td></tr>
<tr><td><code>rv</code></td>
<td>
<p>Vector of raw scores.</p>
</td></tr>
<tr><td><code>tab.ext.w</code></td>
<td>
<p>Weighted table for the variable <code>variab</code>. If <code>variab</code> is a list, a bivariate frequency table is computed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Viviani <a href="mailto:sara.viviani@fao.org">sara.viviani@fao.org</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data.FAO_country1)
XX.country1 = data.FAO_country1[,1:8]
wt.country1 = data.FAO_country1$wt
gender = data.FAO_country1$gender
urbanrural = data.FAO_country1$urbanrural
# Univariate weighted table by gender
tab.weight(gender, wt.country1)$tab.ext.w

# Bivariate weighted table by gender and urban/rural
tab.weight(list(gender,urbanrural), wt.country1)$tab.ext.w

# Fit Rasch descriptives
fit.descr = tab.weight(wt = wt.country1, XX = XX.country1)
# Weighted distribution across raw-scores (absolute and relative)
cbind("Abs.RS distrib." = fit.descr$RS.abs.w, 
"Rel.RS distrib." = fit.descr$RS.rel.w)
# Weighted and unweighted percentage of Yes per item
cbind("Weighted perc. of Yes" = fit.descr$Perc.Yes.w, 
      "Unweighted perc. of Yes" = fit.descr$Perc.Yes)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
