<!DOCTYPE html><html><head><title>Help for package camtrapR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {camtrapR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#camtrapR-package'>
<p>Overview of the functions in the camtrapR package</p></a></li>
<li><a href='#activityDensity'><p>Plot kernel density estimation of single-species activity</p></a></li>
<li><a href='#activityHistogram'><p>Plot histogram of single-species activity</p></a></li>
<li><a href='#activityOverlap'><p>Plot overlapping kernel densities of two-species activities</p></a></li>
<li><a href='#activityRadial'><p>Radial plots of single-species activity</p></a></li>
<li><a href='#addCopyrightTag'><p>Write a copyright tag into JPEG image metadata</p></a></li>
<li><a href='#addToPath'><p>Add a directory to PATH temporarily</p></a></li>
<li><a href='#appendSpeciesNames'><p>Add or remove species names from JPEG image filenames</p></a></li>
<li><a href='#cameraOperation'><p>Create a camera trap station operation matrix</p></a></li>
<li><a href='#camtraps'><p>Sample camera trap station information</p></a></li>
<li><a href='#camtrapsMultiSeason'><p>Sample multi-season camera trap station information</p></a></li>
<li><a href='#checkSpeciesIdentification'><p>Consistency check on species image identification</p></a></li>
<li><a href='#checkSpeciesNames'><p>Check species names against the ITIS taxonomic database</p></a></li>
<li><a href='#commOccu-class'><p>commOccu objects</p></a></li>
<li><a href='#communityModel'><p>Create a community (multi-species) occupancy model for JAGS or Nimble</p></a></li>
<li><a href='#createSpeciesFolders'><p>Create species directories for species identification</p></a></li>
<li><a href='#createStationFolders'><p>Create camera trap station directories for raw camera trap images</p></a></li>
<li><a href='#detectionHistory'><p>Species detection histories for occupancy analyses</p></a></li>
<li><a href='#detectionMaps'><p>Generate maps of observed species richness and species presences by station</p></a></li>
<li><a href='#exifTagNames'><p>Show Exif metadata of JPEG images or other image or video formats</p></a></li>
<li><a href='#filterRecordTable'><p>Filter species record table for temporal independence</p></a></li>
<li><a href='#fit+2CcommOccu-method'><p>Fit a community (multi-species) occupancy model</p></a></li>
<li><a href='#fixDateTimeOriginal'><p>Fix DateTimeOriginal Exif metadata tag in Reconyx Hyperfire cameras</p></a></li>
<li><a href='#getSpeciesImages'><p>Collect all images of a species</p></a></li>
<li><a href='#imageRename'><p>Copy and rename images based on camera trap station ID and creation date</p></a></li>
<li><a href='#OCRdataFields'><p>Optical character recognition (OCR) from data fields in digital images</p></a></li>
<li><a href='#plot_coef+2CcommOccu-method'><p>Plot effect sizes of covariates in community occupancy model</p></a></li>
<li><a href='#plot_effects+2CcommOccu-method'><p>Plot Marginal Effects of Covariates</p></a></li>
<li><a href='#predict+2CcommOccu-method'><p>Predictions from community occupancy models</p></a></li>
<li><a href='#recordTable'><p>Generate a species record table from camera trap images and videos</p></a></li>
<li><a href='#recordTableIndividual'><p>Generate a single-species record table with individual identification from</p>
camera trap images or videos</a></li>
<li><a href='#recordTableIndividualSample'><p>Sample single-species record table with custom metadata from camera trap images</p></a></li>
<li><a href='#recordTableIndividualSampleMultiSeason'><p>Sample single-species multi-season record table with custom metadata from camera trap images</p></a></li>
<li><a href='#recordTableSample'><p>Sample species record table from camera trap images</p></a></li>
<li><a href='#recordTableSampleMultiSeason'><p>Sample multi-season species record table from camera trap images</p></a></li>
<li><a href='#spatialDetectionHistory'><p>Generate a <code>capthist</code> object for spatial capture-recapture analyses</p>
from camera-trapping data</a></li>
<li><a href='#summary+2CcommOccu-method'><p>Summarize community occupancy model</p></a></li>
<li><a href='#surveyDashboard'><p>Shiny dashboard for summarizing and analyzing camera trap survey data</p></a></li>
<li><a href='#surveyReport'><p>Create a report about a camera trapping survey and species detections</p></a></li>
<li><a href='#timeShiftImages'><p>Apply time shifts to JPEG image metadata</p></a></li>
<li><a href='#timeShiftTable'><p>Sample camera trap time shift table</p></a></li>
<li><a href='#writeDateTimeOriginal'><p>Write values to DateTimeOriginal tag in image metadata</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Camera Trap Data Management and Preparation of Occupancy and
Spatial Capture-Recapture Analyses</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-24</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, generics, ggplot2, lubridate, methods, secr, sf</td>
</tr>
<tr>
<td>Suggests:</td>
<td>abind, coda, DT, knitr, lattice, leaflet, magick, mapview,
nimble, nimbleEcology, overlap, parallel, plotly, reshape2,
rjags, R.rsp, RSQLite, ritis, rmarkdown, shiny, shinydashboard,
tesseract, taxize, terra, testthat, tibble, units, unmarked,
zip</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>ExifTool (https://exiftool.org/)</td>
</tr>
<tr>
<td>Description:</td>
<td>Management of and data extraction from camera trap data in wildlife studies. The package provides a workflow for storing and sorting camera trap photos (and videos), tabulates records of species and individuals, and creates detection/non-detection matrices for occupancy and spatial capture-recapture analyses with great flexibility. In addition, it can visualise species activity data and provides simple mapping functions with GIS export.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jniedballa/camtrapR">https://github.com/jniedballa/camtrapR</a>,
<a href="https://jniedballa.github.io/camtrapR/">https://jniedballa.github.io/camtrapR/</a>,
<a href="https://groups.google.com/forum/#!forum/camtrapr">https://groups.google.com/forum/#!forum/camtrapr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://groups.google.com/forum/#!forum/camtrapr">https://groups.google.com/forum/#!forum/camtrapr</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-25 18:00:47 UTC; niedballa</td>
</tr>
<tr>
<td>Author:</td>
<td>Juergen Niedballa <a href="https://orcid.org/0000-0002-9187-2116"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Alexandre Courtiol
    <a href="https://orcid.org/0000-0003-0637-2959"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Rahel Sollmann <a href="https://orcid.org/0000-0002-1607-2039"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  John Mathai [ctb],
  Seth Timothy Wong <a href="https://orcid.org/0000-0001-8083-9268"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  An The Truong Nguyen
    <a href="https://orcid.org/0000-0003-0456-3866"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Azlan bin Mohamed <a href="https://orcid.org/0000-0003-3788-4383"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Andrew Tilker <a href="https://orcid.org/0000-0003-3630-8691"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Roshan Guharajan <a href="https://orcid.org/0000-0001-8124-5461"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Ioannis Alexiou <a href="https://orcid.org/0000-0001-5095-4767"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Andreas Wilting <a href="https://orcid.org/0000-0001-5073-9186"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Juergen Niedballa &lt;camtrapr@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-26 19:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='camtrapR-package'>
Overview of the functions in the camtrapR package
</h2><span id='topic+camtrapR-package'></span><span id='topic+camtrapR'></span>

<h3>Description</h3>

<p>This package provides a streamlined workflow for processing data generated in camera trap-based wildlife studies and prepares input for further analyses, particularly in occupancy and spatial capture-recapture frameworks.
It suggests a simple data structure and provides functions for managing digital camera trap photographs (and videos), generating record tables, maps of species richness and species detections and species activity diagrams. It further helps prepare subsequent analyses by creating detection/non-detection matrices for occupancy analyses, e.g. in the <span class="pkg">unmarked</span> or <span class="pkg">ubms</span> packages, and <code>capthist</code> objects for spatial capture-recapture analyses in the <span class="pkg">secr</span> package. In addition, basic survey statistics are computed. The functions build on one another in a logical sequence.
The only manual input needed is species (and individual) identification, which is achieved by moving images into species directories or by tagging images in image management software. Besides, a table holding basic information about camera trap station IDs, locations and trapping periods must be created in spreadsheet software.
</p>


<h3>Details</h3>

<p>Image metadata (such as date and time or user-assigned tags) are extracted from the images using Phil Harvey's ExifTool (available from <a href="https://exiftool.org/">https://exiftool.org/</a>) and the information is stored in a record table. An adjustable criterion for temporal independence of records can be applied. Maps of species presence and species richness can be generated. Several functions are available for plotting single- and two-species activity patterns.
Information about the camera-specific trapping periods (and periods of malfunction) are summarized into a matrix about camera trap operability. These, together with the record table, are used to generate species detection histories for occupancy and spatial capture-recapture analyses. The user has considerable freedom in generating the detection histories; sampling occasion length, beginning date and and occasion start times are adjustable. In addition, trapping effort (i.e. active trap nights per station and occasion) can be computed for use as a covariate / offset on detection probability.
</p>


<h3>User support</h3>

<p>The camtrapR Google group is an online support and help forum for camtrapR users. You can find it here: <a href="https://groups.google.com/forum/#!forum/camtrapr">https://groups.google.com/forum/#!forum/camtrapr</a>.
</p>


<h3>Image organisation and management</h3>

<p>The functions in this section set up a directory structure for storing camera trap images and identifying species and individuals from images. They build on one another and can be run in sequential order as needed.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+createStationFolders">createStationFolders</a></code> </td><td style="text-align: left;"> Create camera trap station directories for raw images </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+fixDateTimeOriginal">fixDateTimeOriginal</a></code>  </td><td style="text-align: left;"> Fix DateTimeOriginal Exif metadata tag in Reconyx Hyperfire cameras </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+OCRdataFields">OCRdataFields</a></code>        </td><td style="text-align: left;"> Optical character recognition (OCR) from data fields in images </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+writeDateTimeOriginal">writeDateTimeOriginal</a></code> </td><td style="text-align: left;"> Write values to DateTimeOriginal tag in image metadata </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+timeShiftImages">timeShiftImages</a></code>      </td><td style="text-align: left;"> Apply time shifts to JPEG images </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+imageRename">imageRename</a></code>          </td><td style="text-align: left;"> Copy and rename images based on station ID and image creation date </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+addCopyrightTag">addCopyrightTag</a></code>      </td><td style="text-align: left;"> Write a copyright tag into JPEG image metadata </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+appendSpeciesNames">appendSpeciesNames</a></code>   </td><td style="text-align: left;"> Add or remove species names from image filenames </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Species / individual identification</h3>

<p>These functions assist in species identification and prepare individual identification of animals.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+checkSpeciesNames">checkSpeciesNames</a></code>          </td><td style="text-align: left;"> Check species names against the ITIS taxonomic database </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+createSpeciesFolders">createSpeciesFolders</a></code>       </td><td style="text-align: left;"> Create directories for species identification</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+checkSpeciesIdentification">checkSpeciesIdentification</a></code> </td><td style="text-align: left;"> Consistency check on species image identification </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+getSpeciesImages">getSpeciesImages</a></code>           </td><td style="text-align: left;"> Gather all images of a species in a new directory </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Image data extraction</h3>

<p>These function use the directory structure built above (Section 'Image management workflow') and a table containing basic information about camera traps and/or stations (IDs, location, trapping period).
</p>

<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+recordTable">recordTable</a></code>           </td><td style="text-align: left;"> Create a species record table from camera trap images and videos </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+recordTableIndividual">recordTableIndividual</a></code> </td><td style="text-align: left;"> Create a single-species record table from camera trap images and videos with individual IDs </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+exifTagNames">exifTagNames</a></code>          </td><td style="text-align: left;"> Return Exif metadata tags and tag names from JPEG images </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+addToPath">addToPath</a></code>             </td><td style="text-align: left;"> Add the directory containing exiftool.exe to PATH temporarily (Windows only) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+filterRecordTable">filterRecordTable</a></code>     </td><td style="text-align: left;"> Filter existing record table for temporal independence. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
</td>
</tr>

</table>



<h3>Data exploration and visualisation</h3>

<p>These plots are generated from the record table and the camera trap table.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+detectionMaps">detectionMaps</a></code>     </td><td style="text-align: left;"> Generate maps of species richness and species presence by station, export shapefiles </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+activityHistogram">activityHistogram</a></code> </td><td style="text-align: left;"> Single-species diel activity histograms </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+activityDensity">activityDensity</a></code>   </td><td style="text-align: left;"> Single-species diel activity kernel density estimation plots </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+activityRadial">activityRadial</a></code>    </td><td style="text-align: left;"> Single-species diel activity radial plot </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+activityOverlap">activityOverlap</a></code>   </td><td style="text-align: left;"> Two-species diel activity overlap plots and estimates </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Prepare occupancy and spatial capture-recapture analyses, and summarise surveys</h3>


<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+cameraOperation">cameraOperation</a></code>         </td><td style="text-align: left;"> Create a camera operation matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+detectionHistory">detectionHistory</a></code>        </td><td style="text-align: left;"> Species detection histories for occupancy analyses (single and multi-season) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+spatialDetectionHistory">spatialDetectionHistory</a></code> </td><td style="text-align: left;"> Detection histories of individuals for spatial capture-recapture analyses  </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+surveyReport">surveyReport</a></code>            </td><td style="text-align: left;"> Create a report about camera trap surveys and species detections </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+surveyDashboard">surveyDashboard</a></code>         </td><td style="text-align: left;"> Shiny dashboard for summarizing and analyzing camera trap survey data </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Community (multi-species) occupancy models</h3>


<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+communityModel">communityModel</a></code>        </td><td style="text-align: left;"> Create a community (multi-species) occupancy model for JAGS or Nimble </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+commOccu-class">commOccu-class</a></code>        </td><td style="text-align: left;"> commOccu objects </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+fit+2CcommOccu-method">fit,commOccu-method</a></code>   </td><td style="text-align: left;"> Fit a community (multi-species) occupancy model </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+predict+2CcommOccu-method">predict,commOccu-method</a></code>   </td><td style="text-align: left;"> Predictions from community occupancy models </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+summary+2CcommOccu-method">summary,commOccu-method</a></code>   </td><td style="text-align: left;"> Summarize community occupancy model </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+plot_coef">plot_coef</a></code>             </td><td style="text-align: left;"> Plot effect sizes of covariates in community occupancy model </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+plot_effects">plot_effects</a></code>          </td><td style="text-align: left;"> Plot Marginal Effects of Covariates </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Sample data</h3>


<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+camtraps">camtraps</a></code>          </td><td style="text-align: left;">  Sample camera trap station information table </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+recordTableSample">recordTableSample</a></code> </td><td style="text-align: left;"> Sample species record table </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+recordTableIndividualSample">recordTableIndividualSample</a></code>  </td><td style="text-align: left;"> Single-species record table with individual IDs</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+camtrapsMultiSeason">camtrapsMultiSeason</a></code>          </td><td style="text-align: left;">  Sample multi season camera trap station information table </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+recordTableSampleMultiSeason">recordTableSampleMultiSeason</a></code> </td><td style="text-align: left;"> Sample  multi season species record table </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+recordTableIndividualSampleMultiSeason">recordTableIndividualSampleMultiSeason</a></code>  </td><td style="text-align: left;"> Single-species multi season record table with individual IDs</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+timeShiftTable">timeShiftTable</a></code>    </td><td style="text-align: left;"> Sample camera trap time shift information </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Vignettes</h3>


<table>
<tr>
 <td style="text-align: left;">

<a href="https://CRAN.R-project.org/package=camtrapR/vignettes/camtrapr1.pdf">1. Organising raw camera trap images</a>  </td>
</tr>
<tr>
 <td style="text-align: left;">
<a href="https://CRAN.R-project.org/package=camtrapR/vignettes/camtrapr2.pdf">2. Identifying species and individuals</a>  </td>
</tr>
<tr>
 <td style="text-align: left;">
<a href="https://CRAN.R-project.org/package=camtrapR/vignettes/camtrapr3.pdf">3. Extracting Data from Camera Trapping Images and Videos</a>  </td>
</tr>
<tr>
 <td style="text-align: left;">
<a href="https://CRAN.R-project.org/package=camtrapR/vignettes/camtrapr4.pdf">4. Data exploration and visualisation</a>  </td>
</tr>
<tr>
 <td style="text-align: left;">
<a href="https://CRAN.R-project.org/package=camtrapR/vignettes/camtrapr5.html">5. Multi-species occupancy models</a>  </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>
<p>Maintainer:Juergen Niedballa &lt;camtrapr@gmail.com&gt;
</p>


<h3>References</h3>

<p>Niedballa, J., Sollmann, R., Courtiol, A., Wilting, A. (2016): camtrapR: an R package for efficient camera trap data management. Methods in Ecology and Evolution, 7(12). <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12600">https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/2041-210X.12600</a> <br />
</p>
<p>camtrapR Google Group <a href="https://groups.google.com/forum/#!forum/camtrapr">https://groups.google.com/forum/#!forum/camtrapr</a> <br />
</p>
<p>Phil Harvey's ExifTool <a href="https://exiftool.org/">https://exiftool.org/</a> <br />
</p>


<h3>See Also</h3>

<p><span class="pkg">overlap</span>
<span class="pkg">unmarked</span>
<span class="pkg">ubms</span>
<span class="pkg">secr</span>
<span class="pkg">wiqid</span>
</p>

<hr>
<h2 id='activityDensity'>Plot kernel density estimation of single-species activity</h2><span id='topic+activityDensity'></span>

<h3>Description</h3>

<p>The function plots a kernel density estimation of species diel activity
using function <code><a href="overlap.html#topic+densityPlot">densityPlot</a></code> from package
<span class="pkg">overlap</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>activityDensity(
  recordTable,
  species,
  allSpecies = FALSE,
  speciesCol = "Species",
  recordDateTimeCol = "DateTimeOriginal",
  recordDateTimeFormat = "ymd HMS",
  plotR = TRUE,
  writePNG = FALSE,
  plotDirectory,
  createDir = FALSE,
  pngMaxPix = 1000,
  add.rug = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="activityDensity_+3A_recordtable">recordTable</code></td>
<td>
<p>data.frame. the record table created by
<code><a href="#topic+recordTable">recordTable</a></code></p>
</td></tr>
<tr><td><code id="activityDensity_+3A_species">species</code></td>
<td>
<p>Name of the species for which to create an kernel density
plot of activity</p>
</td></tr>
<tr><td><code id="activityDensity_+3A_allspecies">allSpecies</code></td>
<td>
<p>logical. Create plots for all species in <code>speciesCol</code>
of <code>recordTable</code>? Overrides argument <code>species</code></p>
</td></tr>
<tr><td><code id="activityDensity_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. name of the column specifying species names in
<code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityDensity_+3A_recorddatetimecol">recordDateTimeCol</code></td>
<td>
<p>character. name of the column specifying date and
time in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityDensity_+3A_recorddatetimeformat">recordDateTimeFormat</code></td>
<td>
<p>character. format of column
<code>recordDateTimeCol</code> in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityDensity_+3A_plotr">plotR</code></td>
<td>
<p>logical. Show plots in R graphics device?</p>
</td></tr>
<tr><td><code id="activityDensity_+3A_writepng">writePNG</code></td>
<td>
<p>logical. Create pngs of the plots?</p>
</td></tr>
<tr><td><code id="activityDensity_+3A_plotdirectory">plotDirectory</code></td>
<td>
<p>character. Directory in which to create png plots if
<code>writePNG = TRUE</code></p>
</td></tr>
<tr><td><code id="activityDensity_+3A_createdir">createDir</code></td>
<td>
<p>logical. Create <code>plotDirectory</code> if <code>writePNG =
TRUE</code>?</p>
</td></tr>
<tr><td><code id="activityDensity_+3A_pngmaxpix">pngMaxPix</code></td>
<td>
<p>integer. image size of png (pixels along x-axis)</p>
</td></tr>
<tr><td><code id="activityDensity_+3A_add.rug">add.rug</code></td>
<td>
<p>logical. add a rug to the plot?</p>
</td></tr>
<tr><td><code id="activityDensity_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to function
<code>densityPlot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>species</code> must be in the <code>speciesCol</code> of <code>recordTable</code>.
</p>
<p><code>recordDateTimeFormat</code> defaults to the &quot;YYYY-MM-DD HH:MM:SS&quot;
convention, e.g. &quot;2014-09-30 22:59:59&quot;. <code>recordDateTimeFormat</code> can be
interpreted either by base-R via <code><a href="base.html#topic+strptime">strptime</a></code> or in
<span class="pkg">lubridate</span> via <code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> (argument
&quot;orders&quot;). <span class="pkg">lubridate</span> will be used if there are no &quot;%&quot; characters in
<code>recordDateTimeFormat</code>.
</p>
<p>For &quot;YYYY-MM-DD HH:MM:SS&quot;, <code>recordDateTimeFormat</code> would be either
&quot;%Y-%m-%d %H:%M:%S&quot; or &quot;ymd HMS&quot;. For details on how to specify date
and time formats in R see <code><a href="base.html#topic+strptime">strptime</a></code> or
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code>.
</p>


<h3>Value</h3>

<p>Returns invisibly a vector of species record observation times in
radians, i.e. scaled to [<code class="reqn">0, 2\pi</code>]. If <code>allSpecies == TRUE</code>, all
species' vectors are returned in an invisible named list.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>Martin Ridout and Matthew Linkie (2009). Estimating overlap of
daily activity patterns from camera trap data. Journal of Agricultural,
Biological and Environmental Statistics, 14(3), 322-337 <br /> Mike Meredith
and Martin Ridout (2018). overlap: Estimates of coefficient of overlapping
for animal activity patterns. R package version 0.3.2.
<a href="https://CRAN.R-project.org/package=overlap">https://CRAN.R-project.org/package=overlap</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+activityHistogram">activityHistogram</a></code>, <code><a href="#topic+activityRadial">activityRadial</a></code>,
<code><a href="#topic+activityOverlap">activityOverlap</a></code>
<a href="https://www.kent.ac.uk/smsas/personal/msr/overlap.html">https://www.kent.ac.uk/smsas/personal/msr/overlap.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(requireNamespace("overlap")) {
# load record table
data(recordTableSample)

species4activity &lt;- "VTA"    # = Viverra tangalunga, Malay Civet

activityDensity(recordTable = recordTableSample,
                species     = species4activity)


# all species at once

activityDensity(recordTable = recordTableSample,
                allSpecies  = TRUE,
                writePNG    = FALSE,
                plotR       = TRUE,
                add.rug     = TRUE)
 }

</code></pre>

<hr>
<h2 id='activityHistogram'>Plot histogram of single-species activity</h2><span id='topic+activityHistogram'></span>

<h3>Description</h3>

<p>The function generates a histogram of species diel activity in 1-hour
intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>activityHistogram(
  recordTable,
  species,
  allSpecies = FALSE,
  speciesCol = "Species",
  recordDateTimeCol = "DateTimeOriginal",
  recordDateTimeFormat = "ymd HMS",
  plotR = TRUE,
  writePNG = FALSE,
  plotDirectory,
  createDir = FALSE,
  pngMaxPix = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="activityHistogram_+3A_recordtable">recordTable</code></td>
<td>
<p>data.frame. the record table created by
<code><a href="#topic+recordTable">recordTable</a></code></p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_species">species</code></td>
<td>
<p>Name of the single species for which to create a histogram of
activity</p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_allspecies">allSpecies</code></td>
<td>
<p>logical. Create plots for all species in <code>speciesCol</code>
of <code>recordTable</code>? Overrides argument <code>species</code></p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. name of the column specifying species names in
<code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_recorddatetimecol">recordDateTimeCol</code></td>
<td>
<p>character. name of the column specifying date and
time in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_recorddatetimeformat">recordDateTimeFormat</code></td>
<td>
<p>character. format of column
<code>recordDateTimeCol</code> in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_plotr">plotR</code></td>
<td>
<p>logical. Show plots in R graphics device?</p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_writepng">writePNG</code></td>
<td>
<p>logical. Create pngs of the plots?</p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_plotdirectory">plotDirectory</code></td>
<td>
<p>character. Directory in which to create png plots if
<code>writePNG = TRUE</code></p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_createdir">createDir</code></td>
<td>
<p>logical. Create <code>plotDirectory</code>?</p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_pngmaxpix">pngMaxPix</code></td>
<td>
<p>integer. image size of png (pixels along x-axis)</p>
</td></tr>
<tr><td><code id="activityHistogram_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to function
<code><a href="graphics.html#topic+hist">hist</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Activity is calculated from the time of day of records. The date is ignored.
</p>
<p><code>recordDateTimeFormat</code> defaults to the &quot;YYYY-MM-DD HH:MM:SS&quot;
convention, e.g. &quot;2014-09-30 22:59:59&quot;. <code>recordDateTimeFormat</code> can be
interpreted either by base-R via <code><a href="base.html#topic+strptime">strptime</a></code> or in
<span class="pkg">lubridate</span> via <code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> (argument
&quot;orders&quot;). <span class="pkg">lubridate</span> will be used if there are no &quot;%&quot; characters in
<code>recordDateTimeFormat</code>.
</p>
<p>For &quot;YYYY-MM-DD HH:MM:SS&quot;, <code>recordDateTimeFormat</code> would be either
&quot;%Y-%m-%d %H:%M:%S&quot; or &quot;ymd HMS&quot;. For details on how to specify date
and time formats in R see <code><a href="base.html#topic+strptime">strptime</a></code> or
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code>.
</p>


<h3>Value</h3>

<p>It returns invisibly a vector of species record date and time in
<code>POSIXlt</code> format. If <code>allSpecies == TRUE</code>, all species' vectors
are returned in an invisible named list.
</p>


<h3>Note</h3>

<p>If you have a sufficiently large number of records you may wish to
consider using <code><a href="#topic+activityDensity">activityDensity</a></code> instead. Please be aware that
this function (like the other activity... function of this package) use
clock time. If your survey was long enough to see changes in sunrise and
sunset times, this may result in biased representations of species activity.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+activityDensity">activityDensity</a></code>, <code><a href="#topic+activityRadial">activityRadial</a></code>,
<code><a href="#topic+activityOverlap">activityOverlap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# load record table
data(recordTableSample)

# generate activity histogram
species4activity &lt;- "VTA"    # = Viverra tangalunga, Malay Civet

activityHistogram (recordTable = recordTableSample,
                   species     = species4activity,
                   allSpecies = FALSE)

</code></pre>

<hr>
<h2 id='activityOverlap'>Plot overlapping kernel densities of two-species activities</h2><span id='topic+activityOverlap'></span>

<h3>Description</h3>

<p>This function plots kernel density estimates of two species' diel activity
data by calling the function <code><a href="overlap.html#topic+overlapPlot">overlapPlot</a></code> from package
<span class="pkg">overlap</span>. It further computes the overlap coefficient Dhat1 by calling
<code><a href="overlap.html#topic+overlapEst">overlapEst</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>activityOverlap(
  recordTable,
  speciesA,
  speciesB,
  speciesCol = "Species",
  recordDateTimeCol = "DateTimeOriginal",
  recordDateTimeFormat = "ymd HMS",
  plotR = TRUE,
  writePNG = FALSE,
  addLegend = TRUE,
  legendPosition = "topleft",
  plotDirectory,
  createDir = FALSE,
  pngMaxPix = 1000,
  add.rug = TRUE,
  overlapEstimator = c("Dhat1", "Dhat4", "Dhat5"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="activityOverlap_+3A_recordtable">recordTable</code></td>
<td>
<p>data.frame. the record table created by
<code><a href="#topic+recordTable">recordTable</a></code></p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_speciesa">speciesA</code></td>
<td>
<p>Name of species 1 (as found in <code>speciesCol</code> of
recordTable)</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_speciesb">speciesB</code></td>
<td>
<p>Name of species 2 (as found in <code>speciesCol</code> of
recordTable)</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. name of the column specifying species names in
<code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_recorddatetimecol">recordDateTimeCol</code></td>
<td>
<p>character. name of the column specifying date and
time in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_recorddatetimeformat">recordDateTimeFormat</code></td>
<td>
<p>character. format of column
<code>recordDateTimeCol</code> in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_plotr">plotR</code></td>
<td>
<p>logical. Show plots in R graphics device?</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_writepng">writePNG</code></td>
<td>
<p>logical. Create pngs of the plots?</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_addlegend">addLegend</code></td>
<td>
<p>logical. Add a legend to the plots?</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_legendposition">legendPosition</code></td>
<td>
<p>character. Position of the legend (keyword)</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_plotdirectory">plotDirectory</code></td>
<td>
<p>character. Directory in which to create png plots if
<code>writePNG = TRUE</code></p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_createdir">createDir</code></td>
<td>
<p>logical. Create <code>plotDirectory</code>?</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_pngmaxpix">pngMaxPix</code></td>
<td>
<p>integer. image size of png (pixels along x-axis)</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_add.rug">add.rug</code></td>
<td>
<p>logical. add a rug to the plot?</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_overlapestimator">overlapEstimator</code></td>
<td>
<p>character. Which overlap estimator to return (passed
on to argument <code>type</code> in <code><a href="overlap.html#topic+overlapEst">overlapEst</a></code>)</p>
</td></tr>
<tr><td><code id="activityOverlap_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to function
<code><a href="overlap.html#topic+overlapPlot">overlapPlot</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>...</code> can be graphical parameters passed on to function
<code><a href="overlap.html#topic+overlapPlot">overlapPlot</a></code>, e.g. <code>linetype</code>, <code>linewidth</code>,
<code>linecol</code> (see example below).
</p>
<p><code>recordDateTimeFormat</code> defaults to the &quot;YYYY-MM-DD HH:MM:SS&quot;
convention, e.g. &quot;2014-09-30 22:59:59&quot;. <code>recordDateTimeFormat</code> can be
interpreted either by base-R via <code><a href="base.html#topic+strptime">strptime</a></code> or in
<span class="pkg">lubridate</span> via <code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> (argument
&quot;orders&quot;). <span class="pkg">lubridate</span> will be used if there are no &quot;%&quot; characters in
<code>recordDateTimeFormat</code>.
</p>
<p>For &quot;YYYY-MM-DD HH:MM:SS&quot;, <code>recordDateTimeFormat</code> would be either
&quot;%Y-%m-%d %H:%M:%S&quot; or &quot;ymd HMS&quot;. For details on how to specify date
and time formats in R see <code><a href="base.html#topic+strptime">strptime</a></code> or
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code>.
</p>


<h3>Value</h3>

<p>Returns invisibly the <code>data.frame</code> with plot coordinates
returned by <code><a href="overlap.html#topic+overlapPlot">overlapPlot</a></code>.
</p>


<h3>Note</h3>

<p>Please be aware that the function (like the other activity... function
of this package) use clock time, not solar time. If your survey was long
enough to see changes in sunrise and sunset times, this may result in biased
representations of species activity.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>Mike Meredith and Martin Ridout (2018). overlap: Estimates of
coefficient of overlapping for animal activity patterns. R package version
0.3.2. <a href="https://CRAN.R-project.org/package=overlap">https://CRAN.R-project.org/package=overlap</a> <br /> Ridout, M.S. and
Linkie, M. (2009) Estimating overlap of daily activity patterns from camera
trap data. Journal of Agricultural, Biological and Environmental Statistics,
14, 322-337.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+activityDensity">activityDensity</a></code> <br />
<a href="https://www.kent.ac.uk/smsas/personal/msr/overlap.html">https://www.kent.ac.uk/smsas/personal/msr/overlap.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if(requireNamespace("overlap")) {

# load record table
data(recordTableSample)

# define species of interest
speciesA_for_activity &lt;- "VTA"    # = Viverra tangalunga, Malay Civet
speciesB_for_activity &lt;- "PBE"    # = Prionailurus bengalensis, Leopard Cat

# create activity overlap plot (basic)
activityOverlap (recordTable = recordTableSample,
                 speciesA    = "VTA",    # = Viverra tangalunga, Malay Civet
                 speciesB    = "PBE",    # = Prionailurus bengalensis, Leopard Cat
                 writePNG    = FALSE,
                 plotR       = TRUE
)


                                     
# create activity overlap plot (prettier and with some overlapPlot arguments set)

activityOverlap (recordTable = recordTableSample,
                 speciesA    = speciesA_for_activity,
                 speciesB    = speciesB_for_activity,
                 writePNG    = FALSE,
                 plotR       = TRUE,
                 createDir   = FALSE,
                 pngMaxPix   = 1000,
                 linecol     = c("black", "blue"),
                 linewidth   = c(5,3),
                 linetype    = c(1, 2),
                 olapcol     = "darkgrey",
                 add.rug     = TRUE,
                 extend      = "lightgrey",
                 ylim        = c(0, 0.25),
                 main        = paste("Activity overlap between ", 
                                     speciesA_for_activity, "and", 
                                     speciesB_for_activity)
)
}

</code></pre>

<hr>
<h2 id='activityRadial'>Radial plots of single-species activity</h2><span id='topic+activityRadial'></span>

<h3>Description</h3>

<p>The function generates a radial plot of species diel activity using an
adapted version of function <code><a href="plotrix.html#topic+radial.plot">radial.plot</a></code> from package
<span class="pkg">plotrix</span> (without the need to install the package). Records are
aggregated by hour. The number of independent events is used as input, which
in turn is based on the argument <code>minDeltaTime</code> in
<code><a href="#topic+recordTable">recordTable</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>activityRadial(
  recordTable,
  species,
  allSpecies = FALSE,
  speciesCol = "Species",
  recordDateTimeCol = "DateTimeOriginal",
  recordDateTimeFormat = "ymd HMS",
  byNumber = FALSE,
  plotR = TRUE,
  writePNG = FALSE,
  plotDirectory,
  createDir = FALSE,
  pngMaxPix = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="activityRadial_+3A_recordtable">recordTable</code></td>
<td>
<p>data.frame. the record table created by
<code><a href="#topic+recordTable">recordTable</a></code></p>
</td></tr>
<tr><td><code id="activityRadial_+3A_species">species</code></td>
<td>
<p>Name of the species for which to create an kernel density
plot of activity</p>
</td></tr>
<tr><td><code id="activityRadial_+3A_allspecies">allSpecies</code></td>
<td>
<p>logical. Create plots for all species in <code>speciesCol</code>
of <code>recordTable</code>? Overrides argument <code>species</code></p>
</td></tr>
<tr><td><code id="activityRadial_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. name of the column specifying species names in
<code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityRadial_+3A_recorddatetimecol">recordDateTimeCol</code></td>
<td>
<p>character. name of the column specifying date and
time in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityRadial_+3A_recorddatetimeformat">recordDateTimeFormat</code></td>
<td>
<p>character. format of column
<code>recordDateTimeCol</code> in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="activityRadial_+3A_bynumber">byNumber</code></td>
<td>
<p>logical. If FALSE, plot proportion of records. If TRUE, plot
number of records</p>
</td></tr>
<tr><td><code id="activityRadial_+3A_plotr">plotR</code></td>
<td>
<p>logical. Show plots in R graphics device?</p>
</td></tr>
<tr><td><code id="activityRadial_+3A_writepng">writePNG</code></td>
<td>
<p>logical. Create pngs of the plots?</p>
</td></tr>
<tr><td><code id="activityRadial_+3A_plotdirectory">plotDirectory</code></td>
<td>
<p>character. Directory in which to create png plots if
<code>writePNG = TRUE</code></p>
</td></tr>
<tr><td><code id="activityRadial_+3A_createdir">createDir</code></td>
<td>
<p>logical. Create <code>plotDirectory</code>?</p>
</td></tr>
<tr><td><code id="activityRadial_+3A_pngmaxpix">pngMaxPix</code></td>
<td>
<p>integer. image size of png (pixels along x-axis)</p>
</td></tr>
<tr><td><code id="activityRadial_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to function
<code><a href="plotrix.html#topic+radial.plot">radial.plot</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>radial.plot</code> was adjusted to show a clockwise 24-hour clock face. It
is recommended to set argument <code>lwd</code> to a value &gt;= 2. You may also wish
to add argument <code>rp.type="p"</code> to show a polygon instead of bars.
</p>
<p><code>recordDateTimeFormat</code> defaults to the &quot;YYYY-MM-DD HH:MM:SS&quot;
convention, e.g. &quot;2014-09-30 22:59:59&quot;. <code>recordDateTimeFormat</code> can be
interpreted either by base-R via <code><a href="base.html#topic+strptime">strptime</a></code> or in
<span class="pkg">lubridate</span> via <code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> (argument
&quot;orders&quot;). <span class="pkg">lubridate</span> will be used if there are no &quot;%&quot; characters in
<code>recordDateTimeFormat</code>.
</p>
<p>For &quot;YYYY-MM-DD HH:MM:SS&quot;, <code>recordDateTimeFormat</code> would be either
&quot;%Y-%m-%d %H:%M:%S&quot; or &quot;ymd HMS&quot;. For details on how to specify date
and time formats in R see <code><a href="base.html#topic+strptime">strptime</a></code> or
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code>.
</p>


<h3>Value</h3>

<p>Returns invisibly a data.frame containing all information needed to
create the plot: radial position, lengths, hour (for labels). If
<code>allSpecies == TRUE</code>, all species' data frames are returned in an
invisible named list.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>Lemon, J. (2006) Plotrix: a package in the red light district of
R. R-News, 6(4): 8-12. <br /> <a href="https://CRAN.R-project.org/package=plotrix">https://CRAN.R-project.org/package=plotrix</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+activityDensity">activityDensity</a></code>, <code><a href="#topic+activityHistogram">activityHistogram</a></code>,
<code><a href="#topic+activityOverlap">activityOverlap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# load record table
data(recordTableSample)

species4activity &lt;- "PBE"    # = Prionailurus bengalensis, Leopard Cat

activityRadial(recordTable       = recordTableSample,
               species           = species4activity,
               allSpecies        = FALSE,
               speciesCol        = "Species",
               recordDateTimeCol = "DateTimeOriginal",
               plotR             = TRUE,
               writePNG          = FALSE,
               lwd               = 5
)

# plot type = polygon

activityRadial(recordTable       = recordTableSample,
               species           = species4activity,
               allSpecies        = FALSE,
               speciesCol        = "Species",
               recordDateTimeCol = "DateTimeOriginal",
               plotR             = TRUE,
               writePNG          = FALSE,
               lwd               = 5,
               rp.type           = "p"      
)


</code></pre>

<hr>
<h2 id='addCopyrightTag'>Write a copyright tag into JPEG image metadata</h2><span id='topic+addCopyrightTag'></span>

<h3>Description</h3>

<p>This function writes a copyright tag into the copyright field of JPEG image
Exif metadata. It does so recursively, so it works both for images that are
sorted into subdirectories and unsorted images. Note that all images in
subdirectories of inDir will be tagged. It is not required to run this
function in the camtrapR workflow, but may be desired for data sharing or
publishing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addCopyrightTag(
  inDir,
  copyrightTag,
  askFirst = TRUE,
  keepJPG_original = TRUE,
  ignoreMinorErrors = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addCopyrightTag_+3A_indir">inDir</code></td>
<td>
<p>character. Name of the directory containing camera trap images.</p>
</td></tr>
<tr><td><code id="addCopyrightTag_+3A_copyrighttag">copyrightTag</code></td>
<td>
<p>character. The tag to be written into the Exif Copyright
field</p>
</td></tr>
<tr><td><code id="addCopyrightTag_+3A_askfirst">askFirst</code></td>
<td>
<p>logical. Ask user to confirm before execution?</p>
</td></tr>
<tr><td><code id="addCopyrightTag_+3A_keepjpg_original">keepJPG_original</code></td>
<td>
<p>logical. Keep original JPG files as .JPG_original
files (TRUE) or overwrite JPGs (FALSE)?</p>
</td></tr>
<tr><td><code id="addCopyrightTag_+3A_ignoreminorerrors">ignoreMinorErrors</code></td>
<td>
<p>logical. Ignore minor errors that would cause the
function to fail (set TRUE for images with bad MakerNotes, observed in
Panthera V4 cameras)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If askFirst = TRUE, the function will show a menu and asks the user to
confirm the action before execution. Type &quot;1&quot; to write copyright tags and
&quot;2&quot; to abort.
</p>
<p>By default Exiftool creates a copy of each JPG image and preserves the
original images (without the copyright tag) as .JPG_original files. Note
that this behaviour will instantly double the number of images in inDir and
the disk space required. If this is not desired, set keepJPG_original =
FALSE.
</p>
<p><code>ignoreMinorErrors</code> is useful if copyright tags can't be updated
correctly. This can be caused by bad MakerNotes and so far was only observed
in Panthera V4 cameras. In that case, set <code>ignoreMinorErrors</code> to
<code>TRUE</code>. This will add the &quot;-m&quot; option to the Exiftool call, thereby
ignoring minor errors and warnings and assigning the copyright tag
regardless.
</p>


<h3>Value</h3>

<p>An invisible list of Exiftool output.
</p>
<p>More importantly, the specified copyright tag is written into the Copyright
field of the Exif metadata of all images in inDir.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 

if (Sys.which("exiftool") != ""){        # only run this example if ExifTool is available

# copy sample images to temporary directory (so we don't mess around in the package directory)
wd_images_ID &lt;- system.file(file.path("pictures", "sample_images_species_dir"), 
                            package = "camtrapR")
file.copy(from = wd_images_ID, to = tempdir(), recursive = TRUE)
wd_images_ID_copy &lt;- file.path(tempdir(), "sample_images_species_dir")

# define a sample tag
copyrightTagToAdd &lt;- "Your Name (Your Organisation)"

# add the tag to the images
addCopyrightTag(inDir        = wd_images_ID_copy, 
                copyrightTag = copyrightTagToAdd)
1     # we choose "YES", i.e., we want to add a copyright tag
                
# you can check the outcome with function exifTagNames

metadat &lt;- exifTagNames(wd_images_ID_copy)
metadat [metadat$tag_name == "Copyright",]
}



## End(Not run)

</code></pre>

<hr>
<h2 id='addToPath'>Add a directory to PATH temporarily</h2><span id='topic+addToPath'></span>

<h3>Description</h3>

<p>Temporarily adds a directory to the environmental variable PATH for system
calls from within R. This allows Windows users to store exiftool.exe
anywhere on their hard drive and is useful if they cannot store the file 
in system directories. It is not needed on Linux or MacOS machines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addToPath(directory)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addToPath_+3A_directory">directory</code></td>
<td>
<p>character. the directory in the file system to add to PATH 
(e.g. the directory containing exiftool.exe).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several functions within this package depend on ExifTool. Under Windows,
exiftool.exe cannot be used if it is not in a directory path specified in
PATH. This can be solved by adding the directory containing exiftool.exe for
temporary use within the running R process. It can also be useful in other 
contexts besides Exiftool.
</p>


<h3>Value</h3>

<p>invisible logical indicating whether <code>directory</code> was added to
PATH successfully (in the running R process).
</p>


<h3>Note</h3>

<p>The directories in PATH can be queried by <code>Sys.getenv("PATH")</code>.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
exiftool_dir &lt;- "C:/Path/To/Exiftool"
addToPath(directory = exiftool_dir)

# check if it has been added to PATH
grepl(exiftool_dir,  Sys.getenv("PATH"))

</code></pre>

<hr>
<h2 id='appendSpeciesNames'>Add or remove species names from JPEG image filenames</h2><span id='topic+appendSpeciesNames'></span>

<h3>Description</h3>

<p>Add or remove species names from JPEG image filenames. It makes it easier to
find images of a species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>appendSpeciesNames(
  inDir,
  IDfrom,
  hasCameraFolders,
  metadataSpeciesTag,
  metadataHierarchyDelimitor = "|",
  removeNames = FALSE,
  writecsv = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="appendSpeciesNames_+3A_indir">inDir</code></td>
<td>
<p>character. Directory containing camera trap images sorted into
station subdirectories (e.g. inDir/StationA/)</p>
</td></tr>
<tr><td><code id="appendSpeciesNames_+3A_idfrom">IDfrom</code></td>
<td>
<p>character. Read species ID from image metadata (&quot;metadata&quot;) of
from species directory names (&quot;directory&quot;)?</p>
</td></tr>
<tr><td><code id="appendSpeciesNames_+3A_hascamerafolders">hasCameraFolders</code></td>
<td>
<p>logical. Do the station subdirectories of
<code>inDir</code> have camera-subdirectories (e.g. inDir/StationA/CameraA1;
inDir/StationA/CameraA2)?</p>
</td></tr>
<tr><td><code id="appendSpeciesNames_+3A_metadataspeciestag">metadataSpeciesTag</code></td>
<td>
<p>character. The species ID tag name in image
metadata (if IDfrom = &quot;metadata&quot;).</p>
</td></tr>
<tr><td><code id="appendSpeciesNames_+3A_metadatahierarchydelimitor">metadataHierarchyDelimitor</code></td>
<td>
<p>character. The character delimiting
hierarchy levels in image metadata tags in field &quot;HierarchicalSubject&quot;.
Either &quot;|&quot; or &quot;:&quot;.</p>
</td></tr>
<tr><td><code id="appendSpeciesNames_+3A_removenames">removeNames</code></td>
<td>
<p>logical. remove appended species names?</p>
</td></tr>
<tr><td><code id="appendSpeciesNames_+3A_writecsv">writecsv</code></td>
<td>
<p>logical. write csv table containing old and new file names
into <code>inDir</code>?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Species names can be appended or removed from image filenames. Before
running the function, you may want to run
<code><a href="#topic+checkSpeciesIdentification">checkSpeciesIdentification</a></code> to detect possible
misidentifications. As an example, the function would change an image file
name from &quot;StationA__2015-05-41__20-59-59(1).JPG&quot; to
&quot;StationA__2015-05-41__20-59-59(1)__Species Name.JPG&quot;. If species names were
appended several times by accident, they can all be removed by running the
function with <code>removeNames = TRUE</code>
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the old and new file names and
directories.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# copy sample images to another location (so we don't mess around in the package directory)
wd_images_ID &lt;- system.file("pictures/sample_images_species_dir", package = "camtrapR")
file.copy(from = wd_images_ID, to = getwd(), recursive = TRUE)       
wd_images_ID_copy &lt;- file.path(getwd(), "sample_images_species_dir")

# append species names
SpecNameAppend1 &lt;- appendSpeciesNames(inDir            = wd_images_ID_copy,
                                      IDfrom           = "directory",
                                      hasCameraFolders = FALSE,
                                      removeNames      = FALSE,
                                      writecsv         = FALSE)
  
SpecNameAppend1

# remove species names
SpecNameRemove1 &lt;- appendSpeciesNames(inDir            = wd_images_ID_copy,
                                      IDfrom           = "directory",
                                      hasCameraFolders = FALSE,
                                      removeNames      = TRUE,
                                      writecsv         = FALSE)
  
SpecNameRemove1

## End(Not run)

</code></pre>

<hr>
<h2 id='cameraOperation'>Create a camera trap station operation matrix</h2><span id='topic+cameraOperation'></span>

<h3>Description</h3>

<p>Construct a matrix of daily camera trap station operation for use in
<code><a href="#topic+detectionHistory">detectionHistory</a></code> and <code><a href="#topic+spatialDetectionHistory">spatialDetectionHistory</a></code>,
where it is needed for calculating trapping effort per occasion. It is also
used in <code><a href="#topic+surveyReport">surveyReport</a></code> to calculate the number of trap nights
durig a survey. If several cameras were deployed per station, the matrix can
contain camera- or station-specific trap operation information, or
information about sessions during repeated surveys.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cameraOperation(
  CTtable,
  stationCol = "Station",
  cameraCol,
  sessionCol,
  setupCol,
  retrievalCol,
  hasProblems = FALSE,
  byCamera,
  allCamsOn,
  camerasIndependent,
  dateFormat = "ymd",
  occasionStartTime = 0,
  writecsv = FALSE,
  outDir
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cameraOperation_+3A_cttable">CTtable</code></td>
<td>
<p>data.frame containing information about location and trapping
period of camera trap stations</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_stationcol">stationCol</code></td>
<td>
<p>character. name of the column specifying Station ID in
<code>CTtable</code></p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_cameracol">cameraCol</code></td>
<td>
<p>character. name of the column specifying Camera ID in
<code>CTtable</code> (optional). If empty, 1 camera per station is assumed.</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_sessioncol">sessionCol</code></td>
<td>
<p>character. name of the column specifying session ID in
<code>CTtable</code> (optional). Use it for creating multi-session / multi-season
detection histories (unmarked: <code><a href="unmarked.html#topic+unmarkedMultFrame">unmarkedMultFrame</a></code>;
secr: <code><a href="secr.html#topic+capthist">capthist</a></code> )</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_setupcol">setupCol</code></td>
<td>
<p>character. name of the column containing camera setup dates
in <code>CTtable</code></p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_retrievalcol">retrievalCol</code></td>
<td>
<p>character. name of the column containing camera
retrieval dates in <code>CTtable</code></p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_hasproblems">hasProblems</code></td>
<td>
<p>logical. If TRUE, function will look for columns
specifying malfunction periods in <code>CTtable</code> (naming convention:
<code>ProblemX_from</code> and <code>ProblemX_to</code>, where X is a number)</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_bycamera">byCamera</code></td>
<td>
<p>logical. If TRUE, camera operation matrix is computed by
camera, not by station (requires <code>cameraCol</code>)</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_allcamson">allCamsOn</code></td>
<td>
<p>logical. Takes effect only if <code>cameraCol</code> is defined
and if <code>byCamera</code> is FALSE. If <code>allCamsOn = TRUE</code>, all cameras at
a station need to be operational for the station to be operational (e.g. 1
camera out of 2 malfunctioning renders the station inoperational). Output
values can be 1/0/NA only (all cameras at a station operational/ at least 1
camera not operational/ no camera set up). If <code>allCamsOn = FALSE</code>, at
least 1 active camera makes a station operational.</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_camerasindependent">camerasIndependent</code></td>
<td>
<p>logical. Return number of active camera traps by
station? Only if <code>byCamera</code> is FALSE and <code>allCamsOn</code> is FALSE. If
<code>camerasIndependent</code> is TRUE, output values will be the number of
operational cameras at a station. If <code>camerasIndependent</code> is FALSE, the
value is 1 if at least 1 camera was operational, otherwise 0. In both cases,
values are NA if no camera was set up.</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_dateformat">dateFormat</code></td>
<td>
<p>character. The format of columns <code>setupCol</code> and
<code>retrievalCol</code> (and potential problem columns) in <code>CTtable</code>. Must
be interpretable by either <code>as.Date</code> or the &quot;orders&quot; argument
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> in <span class="pkg">lubridate</span>. Can be a date
or (since version 2.1) a date-time.</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_occasionstarttime">occasionStartTime</code></td>
<td>
<p>integer. time of day (the full hour) at which to
begin occasions. Replaces <code>occasionStartTime</code> from
<code><a href="#topic+detectionHistory">detectionHistory</a></code> and <code><a href="#topic+spatialDetectionHistory">spatialDetectionHistory</a></code>.</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_writecsv">writecsv</code></td>
<td>
<p>logical. Should the camera operation matrix be saved as a
.csv?</p>
</td></tr>
<tr><td><code id="cameraOperation_+3A_outdir">outDir</code></td>
<td>
<p>character. Directory into which csv is saved</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cameraCol</code> is NULL by default, meaning the function assumes there was
1 camera per station in <code>CTtable</code>. If more than 1 camera was deployed
per station, <code>cameraCol</code> needs to be specified to identify individual
cameras within a station. Likewise, <code>sessionCol</code> can be used to if
camera trap stations were operated during multiple sessions / trapping
seasons.
</p>
<p><code>dateFormat</code> defaults to &quot;YYYY-MM-DD&quot;, e.g. &quot;2014-10-31&quot;, but can be
any other date format or date-time also. It can be specified either in the
format required by <code><a href="base.html#topic+strptime">strptime</a></code> or the 'orders' argument in
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> in <span class="pkg">lubridate</span>. In the example
above, &quot;YYYY-MM-DD&quot; would be specified as &quot;%Y-%m-%d&quot; in base R or &quot;ymd&quot;
in <span class="pkg">lubridate</span>.
</p>
<p>Since version 2.1, dateFormat can be a date-time. That makes it possible to
specify the exact time cameras were set up / retrieved / malfunctioned /
worked again. This information is used to calculate the daily trapping
effort more precisely on days with incomplete effort.
</p>
<p>Previously, setup and retrival day were counted as 1, indicating a whole day
of effort on those days. Since version 2.1, setup and retrieval are assumed
to have happened at 12 noon (resulting in daily effort of 0.5 instead of 1).
Users can also specify the exact time cameras were set up (by providing a
date-time in the setup / retrieval / problem columns). See vignette 3 for
more details.
</p>
<p>If <code>hasProblems</code> is TRUE, the function tries to find columns
<code>ProblemX_from</code> and <code>ProblemX_to</code> in <code>CTtable</code>. <code>X</code> is a
consecutive number from 1 to n, specifying periods in which a camera or
station was not operational. If <code>hasProblems</code> is FALSE, cameras are
assumed to have been operational uninterruptedly from setup to retrieval
(see <code><a href="#topic+camtraps">camtraps</a></code> for details).
</p>
<p><code>allCamsOn</code> only has an effect if there was more than 1 camera at a
station. If TRUE, for the station to be considered operational, all cameras
at a station need to be operational. If FALSE, at least 1 active camera
renders the station operational. Argument <code>camerasIndependent</code> defines
if cameras record animals independently (it thus only has an effect if there
was more than 1 camera at a station). This is the case if an observation at
one camera does not increase the probability for detection at another camera
(cameras face different trails at a distance of one another).
Non-independence occurs if an animal is likely to trigger both camers (as
would be the case with 2 cameras facing each other).
</p>
<p>If <code>camerasIndependent</code> is TRUE, 2 active cameras at a station will
result in a station operation value of 2 in the resulting matrix, i.e., 2
independent trap days at 1 station and day. If <code>camerasIndependent</code> is
FALSE, 2 active cameras will return value 1, i.e., 1 trap night at 1 station
per day.
</p>
<p>Row names depend on the input arguments and contain the station name and
potentially session and camera names (if <code>sessionCol</code> and/or
<code>cameraCol</code> are defined).
</p>
<p>Naming convention is (since version 1.2) <b>Bold</b> information are from
the columns <code>stationCol</code>, <code>sessionCol</code> and <code>cameraCol</code> in
<code>CTtable</code>:
</p>
<p><b>Station</b> <br /> <b>Station</b>__SESS_<b>SessionID</b> <br />
<b>Station</b>__CAM_<b>CameraID</b> <br />
<b>Station</b>__SESS_<b>SessionID</b>__CAM_<b>CameraID</b>
</p>
<p>Session are designated with prefix &quot;__SESS_&quot;, cameras with prefix &quot;__CAM_&quot;.
Therefore, these are reserved words and may not be part of station, session
or camera names. Here's what it may look like in real life:
</p>
<p><b>Station1</b> <br /> <b>Station1</b>__SESS_<b>2019</b> <br />
<b>Station1</b>__CAM_<b>1024152</b> <br />
<b>Station1</b>__SESS_<b>2019</b>__CAM_<b>1024152</b>
</p>
<p>Functions detectionHistory and spatialDetectionHistory recognize these and
use the information accordingly.
</p>


<h3>Value</h3>

<p>A matrix. Row names always indicate Station IDs. If
<code>sessionCol</code> and/or <code>cameraCol</code> are defined, they are contained in
the row names also (camera ID only if <code>byCamera = TRUE</code>). Column names
are dates. <br /> Legend: NA: camera(s) not set up, 0: camera(s) not
operational, 1 (or higher): number of operational camera(s) or an indicator
for whether the station was operational (depending on
<code>camerasIndependent</code> and <code>allCamsOn</code>)
</p>


<h3>Note</h3>

<p>Setting <code>camerasIndependent</code> according to the sampling situation
is important for the functions <code><a href="#topic+detectionHistory">detectionHistory</a></code> and
<code><a href="#topic+spatialDetectionHistory">spatialDetectionHistory</a></code>, if sampling effort (the number of
active trap nights in a occasion) is to be computed and returned.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(camtraps)

# no problems/malfunction
camop_no_problem &lt;- cameraOperation(CTtable      = camtraps,
                                    stationCol   = "Station",
                                    setupCol     = "Setup_date",
                                    retrievalCol = "Retrieval_date",
                                    writecsv     = FALSE,
                                    hasProblems  = FALSE,
                                    dateFormat   = "dmy"
)

# with problems/malfunction
camop_problem &lt;- cameraOperation(CTtable      = camtraps,
                                 stationCol   = "Station",
                                 setupCol     = "Setup_date",
                                 retrievalCol = "Retrieval_date",
                                 writecsv     = FALSE,
                                 hasProblems  = TRUE,
                                 dateFormat   = "dmy"
)

# with problems/malfunction / dateFormat in strptime format
camop_problem_lubridate &lt;- cameraOperation(CTtable      = camtraps,
                                           stationCol   = "Station",
                                           setupCol     = "Setup_date",
                                           retrievalCol = "Retrieval_date",
                                           writecsv     = FALSE,
                                           hasProblems  = TRUE,
                                           dateFormat   = "%d/%m/%Y"
)

camop_no_problem
camop_problem
camop_problem_lubridate

</code></pre>

<hr>
<h2 id='camtraps'>Sample camera trap station information</h2><span id='topic+camtraps'></span>

<h3>Description</h3>

<p>Example camera trap station information table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(camtraps)
</code></pre>


<h3>Format</h3>

<p>A data frame with 3 rows and 7 variables</p>


<h3>Details</h3>

<p>This is a general example of how information about camera trap stations are arranged in camtrapR. It contains setup and retrieval dates and coordinates. If more than 1 camera was set up at a station (e.g. 2 cameras facing each other), a camera ID column must be added, with camera-specific information instead of station-specific information.
If cameras malfunctioned repeatedly, additional pairs of problem columns can be added, e.g. &quot;Problem2_from&quot; and &quot;Problem2_to&quot; etc..
</p>
<p>The variables are as follows:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Station</code> </td><td style="text-align: left;"> Camera trap station ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>utm_y</code> </td><td style="text-align: left;"> y coordinate of station (northing) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>utm_x</code> </td><td style="text-align: left;"> x coordinate of station (easting) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Setup_date</code> </td><td style="text-align: left;"> camera trap setup date </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Retrieval_date</code> </td><td style="text-align: left;"> camera trap retrieval date </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Problem1_from</code> </td><td style="text-align: left;"> first day of camera malfunction </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Problem1_to</code> </td><td style="text-align: left;">  last day of camera malfunction </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Note</h3>

<p>The coordinates can be in the units of any coordinate system. UTM was chosen as an example, but it could be latlong or anything else, too. <code><a href="secr.html#topic+capthist">capthist</a></code> objects (as created by <code><a href="#topic+spatialDetectionHistory">spatialDetectionHistory</a></code> for spatial capture-recapture analyses) expect the unit to be meters.
</p>

<hr>
<h2 id='camtrapsMultiSeason'>Sample multi-season camera trap station information</h2><span id='topic+camtrapsMultiSeason'></span>

<h3>Description</h3>

<p>Example multi-season camera trap station information table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(camtrapsMultiSeason)
</code></pre>


<h3>Format</h3>

<p>A data frame with 7 rows and 8 variables</p>


<h3>Details</h3>

<p>This is a general example of how information about camera trap stations from multiple seasons are arranged in camtrapR. It contains setup and retrieval dates, coordinates and a season identifier. If more than 1 camera was set up at a station (e.g. 2 cameras facing each other), a camera ID column must be added, with camera-specific information instead of station-specific information.
If cameras malfunctioned repeatedly, additional pairs of problem columns can be added, e.g. &quot;Problem2_from&quot; and &quot;Problem2_to&quot; etc..
</p>
<p>Note that season 2010 has an additional station (StationD). This is to simulate a situation where a station was not set up during an entire season.
</p>
<p>The variables are as follows:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Station</code> </td><td style="text-align: left;"> Camera trap station ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>utm_y</code> </td><td style="text-align: left;"> y coordinate of station (northing) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>utm_x</code> </td><td style="text-align: left;"> x coordinate of station (easting) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Setup_date</code> </td><td style="text-align: left;"> camera trap setup date </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Retrieval_date</code> </td><td style="text-align: left;"> camera trap retrieval date </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Problem1_from</code> </td><td style="text-align: left;"> first day of camera malfunction </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Problem1_to</code> </td><td style="text-align: left;">  last day of camera malfunction </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>session</code> </td><td style="text-align: left;">  Identified for trapping session / season </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Note</h3>

<p>The coordinates can be in the units of any coordinate system. UTM was chosen as an example, but it could be latlong or anything else, too. <code><a href="secr.html#topic+capthist">capthist</a></code> objects (as created by <code><a href="#topic+spatialDetectionHistory">spatialDetectionHistory</a></code> for spatial capture-recapture analyses) expect the unit to be meters. <code><a href="secr.html#topic+capthist">capthist</a></code> alse require session information as integer numbers starting with 1.
</p>
<p>&quot;Season&quot; and &quot;session&quot; are used synonymously here. <span class="pkg">secr</span> nomenclature is &quot;session&quot;, in <span class="pkg">unmarked</span> it is &quot;season&quot;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data were created with the following code:
data(camtraps)

camtraps_season2 &lt;- camtraps

# change 2009 to 2010
camtraps_season2[, "Setup_date"] &lt;- gsub("2009", "2010", camtraps_season2[,
    "Setup_date"])
camtraps_season2[, "Retrieval_date"] &lt;- gsub("2009", "2010", camtraps_season2[,
    "Retrieval_date"])
camtraps_season2[, "Problem1_from"] &lt;- gsub("2009", "2010", camtraps_season2[,
    "Problem1_from"])
camtraps_season2[, "Problem1_to"] &lt;- gsub("2009", "2010", camtraps_season2[,
    "Problem1_to"])

# add an extra station with different dates in session 2010
camtraps_season2 &lt;- rbind(camtraps_season2, NA)
camtraps_season2$Station[4] &lt;- "StationD"
camtraps_season2$utm_y[4] &lt;- 607050
camtraps_season2$utm_x[4] &lt;- 525000
camtraps_season2$Setup_date[4] &lt;- "04/04/2010"
camtraps_season2$Retrieval_date[4] &lt;- "17/06/2010"
camtraps_season2$Problem1_from[4] &lt;- "20/05/2010"
camtraps_season2$Problem1_to[4] &lt;- "30/05/2010"

# add season column
camtraps$session &lt;- 2009
camtraps_season2$session &lt;- 2010

# combine the tables for 2 seasons
camtrapsMultiSeason &lt;- rbind(camtraps, camtraps_season2)
</code></pre>

<hr>
<h2 id='checkSpeciesIdentification'>Consistency check on species image identification</h2><span id='topic+checkSpeciesIdentification'></span>

<h3>Description</h3>

<p>This function serves 2 purposes: 1) it assesses possible misidentification
of species and 2) compares double observer species identification (only if
metadata tagging was used for species identification).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkSpeciesIdentification(
  inDir,
  IDfrom,
  hasCameraFolders,
  metadataSpeciesTag,
  metadataSpeciesTagToCompare,
  metadataHierarchyDelimitor = "|",
  maxDeltaTime,
  excludeSpecies,
  stationsToCheck,
  writecsv = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkSpeciesIdentification_+3A_indir">inDir</code></td>
<td>
<p>character. Directory containing identified camera trap images
sorted into station subdirectories (e.g. inDir/StationA/)</p>
</td></tr>
<tr><td><code id="checkSpeciesIdentification_+3A_idfrom">IDfrom</code></td>
<td>
<p>character. Read species ID from image metadata (&quot;metadata&quot;) of
from species directory names (&quot;directory&quot;)?</p>
</td></tr>
<tr><td><code id="checkSpeciesIdentification_+3A_hascamerafolders">hasCameraFolders</code></td>
<td>
<p>logical. Do the station directories in <code>inDir</code>
have camera subdirectories (e.g. &quot;inDir/StationA/Camera1&quot; or
&quot;inDir/StationA/Camera1/Species1&quot;)?</p>
</td></tr>
<tr><td><code id="checkSpeciesIdentification_+3A_metadataspeciestag">metadataSpeciesTag</code></td>
<td>
<p>character. The species ID tag name in image
metadata (if IDfrom = &quot;metadata&quot;).</p>
</td></tr>
<tr><td><code id="checkSpeciesIdentification_+3A_metadataspeciestagtocompare">metadataSpeciesTagToCompare</code></td>
<td>
<p>character. A second species ID tag name
in image metadata (if IDfrom = &quot;metadata&quot;). For comparing double observer
species identification.</p>
</td></tr>
<tr><td><code id="checkSpeciesIdentification_+3A_metadatahierarchydelimitor">metadataHierarchyDelimitor</code></td>
<td>
<p>character. The character delimiting
hierarchy levels in image metadata tags in field &quot;HierarchicalSubject&quot;.
Either &quot;|&quot; or &quot;:&quot;</p>
</td></tr>
<tr><td><code id="checkSpeciesIdentification_+3A_maxdeltatime">maxDeltaTime</code></td>
<td>
<p>numeric. Maximum time interval between images to be
returned (in seconds)</p>
</td></tr>
<tr><td><code id="checkSpeciesIdentification_+3A_excludespecies">excludeSpecies</code></td>
<td>
<p>character. vector of species to exclude from checks</p>
</td></tr>
<tr><td><code id="checkSpeciesIdentification_+3A_stationstocheck">stationsToCheck</code></td>
<td>
<p>character. vector of stations to be checked
(optionally)</p>
</td></tr>
<tr><td><code id="checkSpeciesIdentification_+3A_writecsv">writecsv</code></td>
<td>
<p>logical. Should the resulting data.frame be saved as a .csv?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Within each station, it assesses whether there are images of a species taken
within a given time interval of another species. Often, it is unlikely that
different species are encountered within a very short time intervals at the
same location. This type of misidentification can arise easily if some
images belonging to a sequence of images were accidentally moved into
different species directories or tagged incorrectly.
</p>
<p>Double observer identification may be desirable to increase reliability of
species identification. The function returns conflicts in species
identification between 2 observers. These conflicts can then be corrected.
</p>
<p>Images may accidentally be misidentified by assigning wrong species tags or
by moving them into wrong species directories. Imagine your cameras take
sequences of images each time they are triggered and one image of the
sequence is misidentified. The time difference between these images (that
have different species assigned to them) will be very small, usually a few
seconds. This function will return all these images for you to check if they
were identified correctly.
</p>
<p>If multiple observers identify images independently using metadata tagging,
their identifications can be compared by setting
<code>metadataSpeciesTagToCompare</code>. Conflicting or missing identifications
will be reported. This feature is only available if images were identified
by metadata tagging.
</p>
<p>Species like &quot;blank&quot; or &quot;team&quot; can be ignored using <code>excludeSpecies</code>.
If only specific stations are to be checked, <code>stationsToCheck</code> can be
set.
</p>


<h3>Value</h3>

<p>A <code>list</code> containing 2 data frames. The first contains a data
frame with images file names, directories, time stamp and species ID that
were taken within <code>maxDeltaTime</code> seconds of another species image at a
particular station. The second data frame contains images with conflicting
species IDs (if <code>IDfrom = "metadata"</code> and
<code>metadataSpeciesTagToCompare</code> is defined)
</p>


<h3>Note</h3>

<p>The function will not be able to find &quot;isolated&quot; images, i.e. images
that were misidentified, but were not part of a sequence of images.
Likewise, if all images of a sequence were misidentified, they cannot be
found either. From version 0.99.0, the function can also handle images
identied with metadata tags.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


wd_images_ID &lt;- system.file("pictures/sample_images_species_dir", package = "camtrapR")

if (Sys.which("exiftool") != ""){        # only run this example if ExifTool is available
check.folders &lt;- checkSpeciesIdentification(inDir             = wd_images_ID,
                                            IDfrom            = "directory",
                                            hasCameraFolders  = FALSE,
                                            maxDeltaTime      = 120,
                                            writecsv          = FALSE)
                                     
check.folders   # In the example, 2 different species were photographed within 2 minutes. 
}


## Not run: 
# now exclude one of these 2 species 
check.folders2 &lt;- checkSpeciesIdentification(inDir             = wd_images_ID,
                                             IDfrom            = "directory",
                                             hasCameraFolders  = FALSE,
                                             maxDeltaTime      = 120,
                                             excludeSpecies    = "EGY",
                                             writecsv          = FALSE)           
  
check.folders2   # the data frame is empty

# now we check only one station
check.folders3 &lt;- checkSpeciesIdentification(inDir             = wd_images_ID,
                                             IDfrom            = "directory",
                                             hasCameraFolders  = FALSE,
                                             maxDeltaTime      = 120,
                                             stationsToCheck   = "StationB",
                                             writecsv          = FALSE)
check.folders3   # the data frame is empty

## End(Not run)


</code></pre>

<hr>
<h2 id='checkSpeciesNames'>Check species names against the ITIS taxonomic database</h2><span id='topic+checkSpeciesNames'></span>

<h3>Description</h3>

<p>The function checks species names (common or scientific names) provided by
the user with the ITIS taxonomic database (<a href="http://www.itis.gov/">http://www.itis.gov/</a>) via
functions from the package <span class="pkg">taxize</span>. It returns both common and
scientific names, the taxon authors, taxon rank name and status, the TSN
(taxonomic serial numbers) and ITIS urls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkSpeciesNames(speciesNames, searchtype, accepted = TRUE, ask = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkSpeciesNames_+3A_speciesnames">speciesNames</code></td>
<td>
<p>character. Vector of species names to check. Either
common names or scientific names.</p>
</td></tr>
<tr><td><code id="checkSpeciesNames_+3A_searchtype">searchtype</code></td>
<td>
<p>character. Type of names specified in <code>speciesNames</code>.
One of 'scientific' or 'common'.</p>
</td></tr>
<tr><td><code id="checkSpeciesNames_+3A_accepted">accepted</code></td>
<td>
<p>logical. Return only accepted valid names? If TRUE, invalid
names are returned as NA. Set to FALSE to return both accepted and
unaccepted names.</p>
</td></tr>
<tr><td><code id="checkSpeciesNames_+3A_ask">ask</code></td>
<td>
<p>logical. Should the function be run in interactive mode? If TRUE
and more than one TSN is found for a species, the user is asked to choose
one. If FALSE, NA is returned for multiple matches.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arguments <code>searchtype</code>, <code>accepted</code> and <code>ask</code> are passed on to
<code><a href="taxize.html#topic+get_tsn">get_tsn</a></code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with the names supplied by the user, matching
common and scientific names, taxon author and year, taxonomic rank, status,
TSNs (taxonomic serial numbers) and ITIS urls.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p><a href="http://www.itis.gov/">http://www.itis.gov/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 


species_common &lt;- c("Leopard Cat", "moonrat")

# ask = TRUE. Multiple matches for leopard cat will cause menu to pop up asking user input.

species.names.check1 &lt;- checkSpeciesNames(speciesNames = species_common,
                                          searchtype   = "common",
                                          accepted     = TRUE,
                                          ask          = TRUE)
2   # we choose entry 2
species.names.check1


# ask = FALSE. Multiple matches for leopard cat will cause NA.

species.names.check2 &lt;- checkSpeciesNames(speciesNames = species_common,
                                          searchtype   = "common",
                                          accepted     = TRUE,
                                          ask          = FALSE)
species.names.check2



# search for scientific names

species_scientific &lt;- c("Tragulus", "Prionailurus bengalensis")

species.names.check3 &lt;- checkSpeciesNames(speciesNames = species_scientific,
                                          searchtype   = "scientific",
                                          accepted     = TRUE,
                                          ask          = TRUE)
species.names.check3

## End(Not run)


</code></pre>

<hr>
<h2 id='commOccu-class'>commOccu objects</h2><span id='topic+commOccu-class'></span>

<h3>Description</h3>

<p>commOccu objects
</p>


<h3>Value</h3>

<p><code>commOccu</code> object
</p>


<h3>Slots</h3>


<dl>
<dt><code>modelText</code></dt><dd><p>JAGS model code as a character vector (made up of code chunks, use cat() to print)</p>
</dd>
<dt><code>params</code></dt><dd><p>Parameters to monitor in the model runs</p>
</dd>
<dt><code>inits_fun</code></dt><dd><p>Function to create start values for the MCMC chains. It being a function ensures different values in each chain</p>
</dd>
<dt><code>data</code></dt><dd><p>List with data needed to run the model (detection &amp; effort matrices, site covariates, number of species / stations / occasions)</p>
</dd>
<dt><code>input</code></dt><dd><p>Input data_list (unchanged)</p>
</dd>
<dt><code>nimble</code></dt><dd><p>logical indicator for whether it is a Nimble model</p>
</dd>
<dt><code>modelFile</code></dt><dd><p>Path of the text file containing the model code</p>
</dd>
<dt><code>covariate_info</code></dt><dd><p>Data frame containing information about covariates. Only used internally in plot_* and predict methods</p>
</dd>
<dt><code>model</code></dt><dd><p>character indicating whether it is a standard &quot;Occupancy&quot; model or Royle-Nichols (&quot;RN&quot;) occupancy model</p>
</dd>
</dl>


<h3>Note</h3>

<p>The <code>data</code> slot is a list of model input data. While the exact content depends on function input, it can be summarized as:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>y</code> </td><td style="text-align: left;"> array of detection histories. Dimensions are: y[species, station, occasion] </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>effort_binary</code> </td><td style="text-align: left;"> matrix of binary (1/0) survey effort. Only used to ensure p = 0 when effort = 0. Dimensions are: effort_binary[station, occasion] </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>site-occasion covariates</code> </td><td style="text-align: left;"> The required content of data_list$obsCovs as named matrices with dimensions [station, occasion] </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>site covariates</code> </td><td style="text-align: left;"> The required columns of data_list$siteCovs as named vectors (length = number of stations) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>M</code> </td><td style="text-align: left;"> Number of species </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>J</code> </td><td style="text-align: left;"> Number of stations </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>maxocc</code> </td><td style="text-align: left;"> Number of occasions </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>For categorical site-occasion covariates, an addition matrix containing an integer representation of the character matrix with suffix &quot;_integer&quot; is stored in the data slot.
</p>

<hr>
<h2 id='communityModel'>Create a community (multi-species) occupancy model for JAGS or Nimble</h2><span id='topic+communityModel'></span>

<h3>Description</h3>

<p>Flexibly creates complete code and input data for community occupancy models for JAGS amd Nimble (both standard occupancy models and Royle-Nichols occupancy models), and automatically sets initial values and parameters to monitor. 
Supports fixed and random effects of covariates on detection and occupancy probabilities, using both continuous and categorical covariates (both site and site-occasion covariates). 
</p>
<p>Optionally includes data augmentation (fully open community, or up to known maximum number of species, or no data augmentation). 
Allows combination of all these parameters for fast and flexible customization of community occupancy models.
</p>
<p>Incidentally, the function can also be used to create model code and input for single-species single-season occupancy models (it is the special case of the community model with only one species). 
Such a model will run slower than proper single-species model JAGS code due to the additional species loop, but it is possible.
</p>
<p>The function returns several derived quantities, e.g. species richness, Bayesian p-values (overall and by species), Freeman-Tukey residuals for actual and simulated data (by station and total). If doing data augmentation, metacommunity size and number of unseen species are returned also.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>communityModel(
  data_list,
  model = c("Occupancy", "RN"),
  occuCovs = list(fixed = NULL, independent = NULL, ranef = NULL),
  detCovs = list(fixed = NULL, ranef = NULL),
  detCovsObservation = list(fixed = NULL, ranef = NULL),
  speciesSiteRandomEffect = list(det = FALSE, occu = FALSE),
  intercepts = list(det = "fixed", occu = "fixed"),
  effortCov = "effort",
  richnessCategories = NULL,
  augmentation = NULL,
  modelFile = NULL,
  nimble = FALSE,
  keyword_quadratic = "_squared"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="communityModel_+3A_data_list">data_list</code></td>
<td>
<p>list. Contains 3 slots: ylist, siteCovs, obsCovs. ylist is a list of detection histories (can be named), e.g. from <code><a href="#topic+detectionHistory">detectionHistory</a></code>. siteCovs is a data.frame with site covariates (optional). obsCovs is a list of site-occasion level covariates (e.g. site-occasion-specific effort, which is also returned by <code><a href="#topic+detectionHistory">detectionHistory</a></code>.</p>
</td></tr>
<tr><td><code id="communityModel_+3A_model">model</code></td>
<td>
<p>character. &quot;Occupancy&quot; for standard occupancy model,  or &quot;RN&quot; for the occupancy model of Royle and Nichols (2003), which relates probability of detection of the species to the number of individuals available for detection at each station</p>
</td></tr>
<tr><td><code id="communityModel_+3A_occucovs">occuCovs</code></td>
<td>
<p>list. Up to 3 items named &quot;fixed&quot;, &quot;independent&quot;, and/or &quot;ranef&quot;. Specifies fixed, independent or random effects of covariates on occupancy probability (continuous or categorical covariates). Independent effects are only supported for continuous covariates.</p>
</td></tr>
<tr><td><code id="communityModel_+3A_detcovs">detCovs</code></td>
<td>
<p>list. Up to 3 items named &quot;fixed&quot;, &quot;independent&quot;, and/or &quot;ranef&quot;. Specifies fixed, independent or random effects of covariates on detection probability (continuous or categorical covariates). Independent effects are only supported for continuous covariates.</p>
</td></tr>
<tr><td><code id="communityModel_+3A_detcovsobservation">detCovsObservation</code></td>
<td>
<p>list. Up to 2 items named &quot;fixed&quot; and/or &quot;ranef&quot;. Specifies fixed or random effects of observation-level covariates on detection probability  (continuous or categorical covariates - categorical must be coded as character matrix)</p>
</td></tr>
<tr><td><code id="communityModel_+3A_speciessiterandomeffect">speciesSiteRandomEffect</code></td>
<td>
<p>list. Two items named &quot;det&quot; and &quot;occu&quot;. If TRUE, adds a random effect of species and station. Only implemented for detection probability.</p>
</td></tr>
<tr><td><code id="communityModel_+3A_intercepts">intercepts</code></td>
<td>
<p>list. Two items named &quot;det&quot; and &quot;occu&quot; for detection and occupancy probability intercepts. Values can be &quot;fixed&quot; (= constant across species), &quot;independent&quot; (= independent estimates for each species), or &quot;ranef&quot; (= random effect of species on intercept).</p>
</td></tr>
<tr><td><code id="communityModel_+3A_effortcov">effortCov</code></td>
<td>
<p>character. Name of list item in <code>data_list$obsCovs</code> which contains effort. This does not include effort as a covariate on detection probability, but only uses NA / not NA information to create binary effort and ensure detection probabilities p are 0 when there was no effort (p will be 0 whereever <code>effortCov</code> is NA).</p>
</td></tr>
<tr><td><code id="communityModel_+3A_richnesscategories">richnessCategories</code></td>
<td>
<p>character. Name of categorical covariate in <code>data_list$siteCovs</code> for which to calculate separate richness estimates (optional). Can be useful to obtain separate richness estimates for different areas.</p>
</td></tr>
<tr><td><code id="communityModel_+3A_augmentation">augmentation</code></td>
<td>
<p>If NULL, no data augmentation (only use species in <code>data_list$ylist</code>), otherwise named list or vector with total number of (potential) species. Names: &quot;maxknown&quot; or &quot;full&quot;. Example: <code>augmentation = c(maxknown = 30)</code> or <code>augmentation = c(full = 30)</code></p>
</td></tr>
<tr><td><code id="communityModel_+3A_modelfile">modelFile</code></td>
<td>
<p>character. Text file name to save model to</p>
</td></tr>
<tr><td><code id="communityModel_+3A_nimble">nimble</code></td>
<td>
<p>logical. If TRUE, model code will be for Nimble (incompatible with JAGS). If FALSE, model code is for JAGS.</p>
</td></tr>
<tr><td><code id="communityModel_+3A_keyword_quadratic">keyword_quadratic</code></td>
<td>
<p>character. A suffix in covariate names in the model that indicates a covariate is a quadratic effect of another covariate which does not carry the suffix in its name (e.g. if the covariate is &quot;elevation&quot;, the quadratic covariate would be &quot;elevation_squared&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For examples of implementation, see Vignette 5: Multi-species occupancy models.
</p>
<p>Fixed effects of covariates are constant across species, whereas random effect covariates differ between species. Independent effect differ between species and are independent (there is no underlying hyperdistribution).
Fixed, independent and random effects are allowed for station-level detection and occupancy covariates (a.k.a. site covariates). Fixed and random effects are also allowed for station-occasion level covariates (a.k.a. observation covariates). 
Currently independent effects are only supported for continuous site covariates, not categorical site covariates or observation-level covariates.
</p>
<p>By default, random effects will be by species. It is however possible to use categorical site covariates for grouping (continuous|categorical).
Furthermore, is is possible to use use nested random effects of species and another categorical site covariate (so that there is a random effect of species and an additional random effect of a categorical covariate within each species).
</p>
<p>Derived quantities returned by the model are:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>Bpvalue</code> </td><td style="text-align: left;"> Bayesian p-value (overall) </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Bpvalue_species</code> </td><td style="text-align: left;"> Bayesian p-value (by species) </td>
</tr>
<tr>
 <td style="text-align: left;">
    
    
    <code>Nspecies</code> </td><td style="text-align: left;"> Species richness (only in JAGS models)</td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Nspecies_station</code> </td><td style="text-align: left;"> Species richness at each sampling locations (only in JAGS models) </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>Nspecies_Covariate</code> </td><td style="text-align: left;"> Species richness by categorical covariate (when using <code>richnessCategories</code>, only in JAGS models) </td>
</tr>
<tr>
 <td style="text-align: left;">
    
    
    <code>R2</code> </td><td style="text-align: left;"> sum of Freeman-Tukey residuals of observed data within each species </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>new.R2</code> </td><td style="text-align: left;"> sum of Freeman-Tukey residuals of simulated data within each species </td>
</tr>
<tr>
 <td style="text-align: left;">
    <code>R3</code> </td><td style="text-align: left;"> Total sum of Freeman-Tukey residuals of observed data </td>
</tr>
<tr>
 <td style="text-align: left;"> 
    <code>new.R3</code> </td><td style="text-align: left;"> Total sum of Freeman-Tukey residuals of simulated data </td>
</tr>
<tr>
 <td style="text-align: left;">
    <em><code>Ntotal</code></em> </td><td style="text-align: left;"> Total metacommunity size (= observed species + n0) </td>
</tr>
<tr>
 <td style="text-align: left;">
    <em><code>n0</code></em> </td><td style="text-align: left;"> Number of unseen species in metacommunity </td>
</tr>
<tr>
 <td style="text-align: left;">
    <em><code>omega</code></em> </td><td style="text-align: left;"> Data augmentation parameter </td>
</tr>
<tr>
 <td style="text-align: left;">
    <em><code>w</code></em> </td><td style="text-align: left;"> Metacommunity membership indicator for each species
  </td>
</tr>

</table>

<p>Quantities in <em>italic</em> at the bottom are only returned in full data augmentation. <code>Nspecies</code> and <code>Nspecies_Covariate</code> are only returned in JAGS models (because Nimble models don't explicitly return latent occupancy status z).
</p>


<h3>Value</h3>

<p><code>commOccu</code> object. It is an S4 class containing all information required to run the models. See  <code><a href="#topic+commOccu-class">commOccu-class</a></code> for details.
</p>


<h3>Parameter naming convention</h3>

<p>The parameter names are assembled from building blocks. The nomenclature  is as follows:    
</p>

<table>
<tr>
 <td style="text-align: left;">
    <b>Name</b>           </td><td style="text-align: left;"> <b>Refers to</b>  </td><td style="text-align: left;">  <b>Description</b>  </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>alpha</code></b>   </td><td style="text-align: left;"> Submodel          </td><td style="text-align: left;"> detection submodel  </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>beta</code></b>    </td><td style="text-align: left;"> Submodel          </td><td style="text-align: left;"> occupancy submode </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>0</code></b>       </td><td style="text-align: left;"> Intercept         </td><td style="text-align: left;"> denotes the intercepts (alpha0, beta0)  </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>fixed</code></b>   </td><td style="text-align: left;"> Effect type       </td><td style="text-align: left;"> fixed effects (constant across species)  </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>indep</code></b>   </td><td style="text-align: left;"> Effect type       </td><td style="text-align: left;"> independent effects (separate for each species)  </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>ranef</code></b>   </td><td style="text-align: left;"> Effect type       </td><td style="text-align: left;"> random effects (of species and/or other categorical covariates)  </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>cont</code></b>    </td><td style="text-align: left;"> Covariate type    </td><td style="text-align: left;"> continuous covariates </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>categ</code></b>   </td><td style="text-align: left;"> Covariate type    </td><td style="text-align: left;"> categorical covariates </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>mean</code></b>    </td><td style="text-align: left;"> Hyperparameter    </td><td style="text-align: left;"> mean of random effect </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>sigma</code></b>   </td><td style="text-align: left;"> Hyperparameter    </td><td style="text-align: left;"> standard deviation of random effect </td>
</tr>
<tr>
 <td style="text-align: left;">
    <b><code>tau</code></b>     </td><td style="text-align: left;"> Hyperparameter    </td><td style="text-align: left;"> precision of random effect (used internally, not returned)
  </td>
</tr>

</table>

<p>For example, a fixed intercept of occupancy (constant across species) is <b><code>beta0</code></b>, and a fixed intercept of detection probability is <b><code>alpha0</code></b>.
</p>
<p>An occupancy probability intercept with a random effect of species is: 
</p>
<p><b><code>beta0.mean</code></b> community mean of the occupancy probability intercept
</p>
<p><b><code>beta0.sigma</code></b> standard deviation of the community occupancy probability intercept.
</p>
<p><b><code>beta0[1]</code></b> occupancy probability intercept of species 1 (likewise for other species). 
</p>
<p>For effects of site covariates, the pattern is:
</p>
<p><code>submodel.effectType.covariateType.CovariateName.hyperparameter</code>
</p>
<p>For example:
</p>
<p><b><code>beta.ranef.cont.habitat.mean</code></b> is the mean community effect of the continuous site covariate 'habitat' on occupancy probability.
</p>
<p><b><code>beta.ranef.cont.habitat[1]</code></b> is the effect of continuous site covariate 'habitat' on occupancy probability of species 1.
</p>
<p>Site-occasion covariates are denoted by &quot;.obs&quot; after the submodel, e.g.: 
</p>
<p><b><code>alpha.obs.fixed.cont.effort</code></b> is the fixed effect of the continuous observation-level covariate 'effort' on detection probability
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>Kry, M., and J. A. Royle. &quot;Applied hierarchical modelling in ecology - Modeling distribution, abundance and species richness using R and BUGS.&quot; Volume 1: Prelude and Static Models. Elsevier/Academic Press, 2016.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data("camtraps")

# create camera operation matrix
camop_no_problem &lt;- cameraOperation(CTtable      = camtraps,
                                    stationCol   = "Station",
                                    setupCol     = "Setup_date",
                                    retrievalCol = "Retrieval_date",
                                    hasProblems  = FALSE,
                                    dateFormat   = "dmy"
)

data("recordTableSample")

# make list of detection histories
DetHist_list &lt;- lapply(unique(recordTableSample$Species), FUN = function(x) {
  detectionHistory(
    recordTable         = recordTableSample,
    camOp                = camop_no_problem,
    stationCol           = "Station",
    speciesCol           = "Species",
    recordDateTimeCol    = "DateTimeOriginal",
    species              = x,
    occasionLength       = 7,
    day1                 = "station",
    datesAsOccasionNames = FALSE,
    includeEffort        = TRUE,
    scaleEffort          = TRUE,
    timeZone             = "Asia/Kuala_Lumpur"
  )}
)

# assign species names to list items
names(DetHist_list) &lt;- unique(recordTableSample$Species)

# extract detection histories (omit effort matrices)
ylist &lt;- lapply(DetHist_list, FUN = function(x) x$detection_history)

# create some fake covariates for demonstration
sitecovs &lt;- camtraps[, c(1:3)]
sitecovs$elevation &lt;- c(300, 500, 600)   

# scale numeric covariates
sitecovs[, c(2:4)] &lt;- scale(sitecovs[,-1])


# bundle input data for communityModel
data_list &lt;- list(ylist = ylist,
                  siteCovs = sitecovs,
                  obsCovs = list(effort = DetHist_list[[1]]$effort))


# create community model for JAGS
modelfile1 &lt;- tempfile(fileext = ".txt")
mod.jags &lt;- communityModel(data_list,
                           occuCovs = list(fixed = "utm_y", ranef = "elevation"),
                           detCovsObservation = list(fixed = "effort"),
                           intercepts = list(det = "ranef", occu = "ranef"),
                           modelFile = modelfile1)

summary(mod.jags)

# fit in JAGS
fit.jags &lt;- fit(mod.jags,
                n.iter = 1000,
                n.burnin = 500,
                chains = 3)   
summary(fit.jags)

# response curves (= marginal effect plots)
plot_effects(mod.jags, 
             fit.jags, 
             submodel = "state")
plot_effects(mod.jags, 
             fit.jags, 
             submodel = "det")
             
# effect sizes plot
plot_coef(mod.jags, 
          fit.jags, 
          submodel = "state")
plot_coef(mod.jags, 
          fit.jags, 
          submodel = "det")              

# create community model for Nimble
modelfile2 &lt;- tempfile(fileext = ".txt")
mod.nimble &lt;- communityModel(data_list,
                             occuCovs = list(fixed = "utm_x", ranef = "utm_y"),
                             detCovsObservation = list(fixed = "effort"),
                             intercepts = list(det = "ranef", occu = "ranef"),
                             modelFile = modelfile2, 
                             nimble = TRUE)      # set nimble = TRUE

# load nimbleEcology package 
# currently necessary to do explicitly, to avoid additional package dependencies
require(nimbleEcology)

# fit uncompiled model in Nimble
fit.nimble.uncomp &lt;- fit(mod.nimble, 
                         n.iter = 10, 
                         chains = 1)

# fit compiled model in Nimble
fit.nimble.comp &lt;- fit(mod.nimble, 
                       n.iter = 5000, 
                       n.burnin = 2500,
                       chains = 3, 
                       compile = TRUE)

# parameter summary statistics
summary(fit.nimble.comp)


# response curves (= marginal effect plots)
plot_effects(mod.nimble, 
             fit.nimble.comp, 
             submodel = "state")
plot_effects(mod.nimble, 
             fit.nimble.comp, 
             submodel = "det")

# effect sizes plot
plot_coef(mod.nimble, 
          fit.nimble.comp, 
          submodel = "state")
plot_coef(mod.nimble, 
          fit.nimble.comp, 
          submodel = "det")   

# traceplots
plot(fit.nimble.comp)



## End(Not run)

</code></pre>

<hr>
<h2 id='createSpeciesFolders'>Create species directories for species identification</h2><span id='topic+createSpeciesFolders'></span>

<h3>Description</h3>

<p>This function creates species subdirectories within station directories.
They can be used for species identification by manually moving images into
the respective species directories. The function can also delete empty
species directories (if species were not detected at sites). It is not
necessary to run this function if animals will be identified by metadata
tagging.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createSpeciesFolders(inDir, hasCameraFolders, species, removeFolders = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createSpeciesFolders_+3A_indir">inDir</code></td>
<td>
<p>character. Directory containing camera trap images sorted into
station subdirectories (e.g. inDir/StationA/)</p>
</td></tr>
<tr><td><code id="createSpeciesFolders_+3A_hascamerafolders">hasCameraFolders</code></td>
<td>
<p>logical. Do the station directories in <code>inDir</code>
have camera-subdirectories (e.g. inDir/StationA/CameraA1;
inDir/StationA/CameraA2)?</p>
</td></tr>
<tr><td><code id="createSpeciesFolders_+3A_species">species</code></td>
<td>
<p>character. names of species directories to be created in
every station (or station/camera) subdirectory of <code>inDir</code></p>
</td></tr>
<tr><td><code id="createSpeciesFolders_+3A_removefolders">removeFolders</code></td>
<td>
<p>logical. Indicating whether to create (TRUE) or remove
(FALSE) species directories .</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should be run after <code><a href="#topic+imageRename">imageRename</a></code>. Empty
directories can be created as containers for species identification if
images are identified with the drag &amp; drop method. After species
identification is complete, empty species directories can be deleted using
<code>removeFolders = TRUE</code>. The function will delete only directories which
are specified in <code>species</code>. If <code>hasCameraFolders</code> was set to
<code>TRUE</code> in function <code><a href="#topic+imageRename">imageRename</a></code>, <code>hasCameraFolders</code>
must be set to <code>TRUE</code> here too. Species directories will then be
created within each camera subdirectory of each station directory. if the
user wishes to identify species by metadata tagging, running this function
is not needed.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with directory names and an indicator for
whether directories were created or deleted.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# create dummy directories for tests
# (normally, you'd use directory containing renamed, unsorted images)

# this will be used as inDir
wd_createDirTest &lt;- file.path(getwd(), "createSpeciesFoldersTest")

# now we create 2 station subdirectories
dirs_to_create &lt;- file.path(wd_createDirTest, c("StationA", "StationB"))
sapply(dirs_to_create, FUN = dir.create, recursive = TRUE)

# species names for which we want to create subdirectories
species &lt;- c("Sambar Deer", "Bay Cat")

# create species subdirectories
SpecFolderCreate1 &lt;- createSpeciesFolders (inDir               = wd_createDirTest,
                                           species             = species,
                                           hasCameraFolders = FALSE,
                                           removeFolders       = FALSE)
  
SpecFolderCreate1

# check if directories were created
list.dirs(wd_createDirTest)

# delete empty species directories
SpecFolderCreate2 &lt;- createSpeciesFolders (inDir               = wd_createDirTest,
                                           species             = species,
                                           hasCameraFolders = FALSE,
                                           removeFolders       = TRUE)

SpecFolderCreate2

# check if species directories were deleted
list.dirs(wd_createDirTest)


## End(Not run)

</code></pre>

<hr>
<h2 id='createStationFolders'>Create camera trap station directories for raw camera trap images</h2><span id='topic+createStationFolders'></span>

<h3>Description</h3>

<p>This function creates camera trap station directories, if needed with camera
subdirectories. They can be used as an initial directory structure for
storing raw camera trap images.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createStationFolders(inDir, stations, cameras, createinDir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createStationFolders_+3A_indir">inDir</code></td>
<td>
<p>character. Directory in which station directories are to be
created</p>
</td></tr>
<tr><td><code id="createStationFolders_+3A_stations">stations</code></td>
<td>
<p>character. Station IDs to be used as directory names within
<code>inDir</code></p>
</td></tr>
<tr><td><code id="createStationFolders_+3A_cameras">cameras</code></td>
<td>
<p>character. Camera trap IDs to be used as subdirectory names
in each station directory (optionally)</p>
</td></tr>
<tr><td><code id="createStationFolders_+3A_createindir">createinDir</code></td>
<td>
<p>logical. If inDir does not exist, create it?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The empty directories serve as containers for saving raw camera trap images.
If more than 1 camera was set up at a station, specifying <code>cameras</code> is
required in order to keep images from different cameras separate. Otherwise,
generic filenames (e.g., IMG0001.JPG) from different cameras may lead to
accidental overwriting of images if images from these cameras are saved in
one station directory.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with station (and possibly camera) directory
names and an indicator for whether they were created successfully.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

# create dummy directory for tests (this will be used as inDir)
# (normally, you'd set up an empty directory, e.g. .../myStudy/rawImages)
wd_createStationDir &lt;- file.path(tempdir(), "createStationFoldersTest")

# now we load the sample camera trap station data frame
data(camtraps)

# create station directories in wd_createStationDir
StationFolderCreate1 &lt;- createStationFolders (inDir       = wd_createStationDir,
                                              stations    = as.character(camtraps$Station),
                                              createinDir = TRUE)
  
StationFolderCreate1

# check if directories were created
list.dirs(wd_createStationDir)


## End(Not run)

</code></pre>

<hr>
<h2 id='detectionHistory'>Species detection histories for occupancy analyses</h2><span id='topic+detectionHistory'></span>

<h3>Description</h3>

<p>This function generates species detection histories that can be used in
occupancy analyses, e.g. with package
<a href="unmarked.html#topic+unmarked-package">unmarked</a>. It generates detection histories
in different formats, with adjustable occasion length and occasion start
time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detectionHistory(
  recordTable,
  species,
  camOp,
  output = c("binary", "count"),
  stationCol = "Station",
  speciesCol = "Species",
  recordDateTimeCol = "DateTimeOriginal",
  recordDateTimeFormat = "ymd HMS",
  occasionLength,
  minActiveDaysPerOccasion,
  maxNumberDays,
  day1,
  buffer,
  includeEffort = TRUE,
  scaleEffort = FALSE,
  occasionStartTime = "deprecated",
  datesAsOccasionNames = FALSE,
  timeZone,
  writecsv = FALSE,
  outDir,
  unmarkedMultFrameInput
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detectionHistory_+3A_recordtable">recordTable</code></td>
<td>
<p>data.frame. the record table created by
<code><a href="#topic+recordTable">recordTable</a></code></p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_species">species</code></td>
<td>
<p>character. the species for which to compute the detection
history</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_camop">camOp</code></td>
<td>
<p>The camera operability matrix as created by
<code><a href="#topic+cameraOperation">cameraOperation</a></code></p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_output">output</code></td>
<td>
<p>character. Return binary detections (&quot;binary&quot;) or counts of
detections (&quot;count&quot;)</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_stationcol">stationCol</code></td>
<td>
<p>character. name of the column specifying Station ID in
<code>recordTable</code></p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. name of the column specifying species in
<code>recordTable</code></p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_recorddatetimecol">recordDateTimeCol</code></td>
<td>
<p>character. name of the column specifying date and
time in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_recorddatetimeformat">recordDateTimeFormat</code></td>
<td>
<p>character. Format of column
<code>recordDateTimeCol</code> in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_occasionlength">occasionLength</code></td>
<td>
<p>integer. occasion length in days</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_minactivedaysperoccasion">minActiveDaysPerOccasion</code></td>
<td>
<p>integer. minimum number of active trap days
for occasions to be included (optional)</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_maxnumberdays">maxNumberDays</code></td>
<td>
<p>integer. maximum number of trap days per station
(optional)</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_day1">day1</code></td>
<td>
<p>character. When should occasions begin: station setup date
(&quot;station&quot;), first day of survey (&quot;survey&quot;), a specific date (e.g.
&quot;2015-12-31&quot;)?</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_buffer">buffer</code></td>
<td>
<p>integer. Makes the first occasion begin a number of days after
station setup. (optional)</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_includeeffort">includeEffort</code></td>
<td>
<p>logical. Compute trapping effort (number of active
camera trap days per station and occasion)?</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_scaleeffort">scaleEffort</code></td>
<td>
<p>logical. scale and center effort matrix to mean = 0 and
sd = 1?</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_occasionstarttime">occasionStartTime</code></td>
<td>
<p>(DEPRECATED) integer. time of day (the full hour)
at which to begin occasions. Please use argument <code>occasionStartTime</code> in
<code><a href="#topic+cameraOperation">cameraOperation</a></code> instead.</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_datesasoccasionnames">datesAsOccasionNames</code></td>
<td>
<p>If <code>day1 = "survey"</code>, occasion names in the
detection history will be composed of first and last day of that occasion.</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_timezone">timeZone</code></td>
<td>
<p>character. Must be a value returned by
<code><a href="base.html#topic+timezones">OlsonNames</a></code></p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_writecsv">writecsv</code></td>
<td>
<p>logical. Should the detection history be saved as a .csv?</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_outdir">outDir</code></td>
<td>
<p>character. Directory into which detection history .csv file is
saved</p>
</td></tr>
<tr><td><code id="detectionHistory_+3A_unmarkedmultframeinput">unmarkedMultFrameInput</code></td>
<td>
<p>logical. Return input for multi-season
occupancy models in unmarked (argument &quot;y&quot; in
<code><a href="unmarked.html#topic+unmarkedMultFrame">unmarkedMultFrame</a></code>?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes a species detection matrix, either as a
detection-by-date or a detection-by-occasion matrix. <code>day1</code> defines if
each stations detection history will begin on that station's setup day
(<code>day1 = "station"</code>) or if all station's detection histories have a
common origin (the day the first station was set up if <code>day1 =
"survey"</code> or a fixed date if, e.g. <code>day1 = "2015-12-31"</code>). If
<code>day1</code> is a date, <code><a href="base.html#topic+as.Date">as.Date</a></code> must be able to
understand it. The most suitable format is &quot;YYYY-MM-DD&quot;, e.g. &quot;2015-12-31&quot;.
</p>
<p><code>output</code> is analogous to <code><a href="#topic+spatialDetectionHistory">spatialDetectionHistory</a></code>. It
makes the function return either counts of detections during occasions, or a
binary indicator for whether the species was detected.
</p>
<p><code>includeEffort</code> controls whether an additional effort matrix is
computed or not. This also affects the detection matrices. If
<code>includeEffort = FALSE</code>, all occasions in which a station was not set
up or malfunctioning (NA or 0 in <code>camOp</code>) will result in NAs in the
detection history. If <code>includeEffort = TRUE</code>, the record history will
only contain 0 and 1, and no NAs. The effort matrix can then be included in
occupancy models as a (continuous) observation covariate to estimate the
effect of effort on detection probability.
</p>
<p>The number of days that are aggregated is controlled by
<code>occasionLength</code>. <code>occasionStartTime</code> will be removed from the
function. It has moved to <code><a href="#topic+cameraOperation">cameraOperation</a></code>, to ensure daily
effort is computed correctly and takes the occasion start time into account.
default). This may be relevant for nocturnal animals, in which 1 whole night
would be considered an occasion.
</p>
<p>The values of <code>stationCol</code> in <code>recordTable</code> must be matched by the
row names of <code>camOp</code> (case-insensitive), otherwise an error is raised.
</p>
<p><code>recordDateTimeFormat</code> defaults to the &quot;YYYY-MM-DD HH:MM:SS&quot;
convention, e.g. &quot;2014-09-30 22:59:59&quot;. <code>recordDateTimeFormat</code> can be
interpreted either by base-R via <code><a href="base.html#topic+strptime">strptime</a></code> or in
<span class="pkg">lubridate</span> via <code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> (argument
&quot;orders&quot;). <span class="pkg">lubridate</span> will be used if there are no &quot;%&quot; characters in
<code>recordDateTimeFormat</code>.
</p>
<p>For &quot;YYYY-MM-DD HH:MM:SS&quot;, <code>recordDateTimeFormat</code> would be either
&quot;%Y-%m-%d %H:%M:%S&quot; or &quot;ymd HMS&quot;. For details on how to specify date
and time formats in R see <code><a href="base.html#topic+strptime">strptime</a></code> or
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code>.
</p>
<p>If the camera operation matrix (<code>camOp</code>) was created for a multi-season
study (argument <code>sesssionCol</code> in <code><a href="#topic+cameraOperation">cameraOperation</a></code> was set,
it will be detected automatically. Output can be for unmarkedMultFrame by
setting <code>unmarkedMultFrameInput = TRUE</code>. Each row corresponds to a
site, and the columns are in season-major, occasion-minor order, e.g.
season1-occasion1, season1-occasion2, etc.).
</p>


<h3>Value</h3>

<p>Depending on the value of <code>includeEffort</code> and
<code>scaleEffort</code>, a list with either 1, 2 or 3 elements. The first element
is the species detection history. The second is the optional effort matrix
and the third contains the effort scaling parameters.
</p>
<table>
<tr><td><code>detection_history</code></td>
<td>
<p>A species detection matrix</p>
</td></tr> <tr><td><code>effort</code></td>
<td>
<p>A matrix
giving the number of active camera trap days per station and occasion (=
camera trapping effort). It is only returned if <code>includeEffort = TRUE</code></p>
</td></tr>
<tr><td><code>effort_scaling_parameters</code></td>
<td>
<p>Scaling parameters of the effort matrix. It
is only returned if <code>includeEffort</code> and <code>scaleEffort</code> are
<code>TRUE</code></p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Setting <code>output = "count"</code> returns a count of
detections, not individuals. We strongly advise against using it as input
for models of animal abundance (such as N-Mixture models) models which use
counts as input.
</p>
<p>Please note the section about defining argument <code>timeZone</code> in the
vignette on data extraction (accessible via
<code>vignette("DataExtraction")</code> or online
(<a href="https://cran.r-project.org/package=camtrapR/vignettes/camtrapr3.pdf">https://cran.r-project.org/package=camtrapR/vignettes/camtrapr3.pdf</a>)).
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# define image directory
wd_images_ID &lt;- system.file("pictures/sample_images_species_dir", package = "camtrapR")

# load station information
data(camtraps)

# create camera operation matrix
camop_no_problem &lt;- cameraOperation(CTtable      = camtraps,
                                    stationCol   = "Station",
                                    setupCol     = "Setup_date",
                                    retrievalCol = "Retrieval_date",
                                    hasProblems  = FALSE,
                                    dateFormat   = "dmy"
)

## Not run: 
if (Sys.which("exiftool") != ""){        # only run this function if ExifTool is available
recordTableSample &lt;- recordTable(inDir               = wd_images_ID,
                                 IDfrom              = "directory",
                                 minDeltaTime        = 60,
                                 deltaTimeComparedTo = "lastRecord",
                                 exclude             = "UNID",
                                 timeZone            = "Asia/Kuala_Lumpur"
)
}

## End(Not run)
data(recordTableSample)    # load the record history, as created above


# compute detection history for a species

# without trapping effort
DetHist1 &lt;- detectionHistory(recordTable         = recordTableSample,
                            camOp                = camop_no_problem,
                            stationCol           = "Station",
                            speciesCol           = "Species",
                            recordDateTimeCol    = "DateTimeOriginal",
                            species              = "VTA",
                            occasionLength       = 7,
                            day1                 = "station",
                            datesAsOccasionNames = FALSE,
                            includeEffort        = FALSE,
                            timeZone             = "Asia/Kuala_Lumpur"
)

DetHist1                     # this is a list with 1 element
DetHist1$detection_history   # this is the contained detection/non-detection matrix


# with effort / using base R to define recordDateTimeFormat
DetHist2 &lt;- detectionHistory(recordTable          = recordTableSample,
                             camOp                = camop_no_problem,
                             stationCol           = "Station",
                             speciesCol           = "Species",
                             recordDateTimeCol    = "DateTimeOriginal",
                             species              = "VTA",
                             occasionLength       = 7,
                             day1                 = "station",
                             datesAsOccasionNames = FALSE,
                             includeEffort        = TRUE,
                             scaleEffort          = FALSE,
                             timeZone             = "Asia/Kuala_Lumpur"
)

DetHist2$detection_history  # detection history  (alternatively, use: DetHist2[[1]])
DetHist2$effort             # effort (alternatively, use: DetHist2[[2]])

# with effort / using lubridate package to define recordDateTimeFormat
DetHist2_lub &lt;- detectionHistory(recordTable          = recordTableSample,
                                 camOp                = camop_no_problem,
                                 stationCol           = "Station",
                                 speciesCol           = "Species",
                                 recordDateTimeCol    = "DateTimeOriginal",
                                 recordDateTimeFormat = "ymd HMS",
                                 species              = "VTA",
                                 occasionLength       = 7,
                                 day1                 = "station",
                                 datesAsOccasionNames = FALSE,
                                 includeEffort        = TRUE,
                                 scaleEffort          = FALSE,
                                 timeZone             = "Asia/Kuala_Lumpur"
)    

DetHist2_lub$detection_history  # detection history  (alternatively, use: DetHist2_lub[[1]])
DetHist2_lub$effort             # effort (alternatively, use: DetHist2_lub[[2]])


# multi-season detection history

# load multi-season data
data(camtrapsMultiSeason)
data(recordTableSampleMultiSeason)

# multi-season camera operation matrix
camop_season &lt;- cameraOperation(CTtable          = camtrapsMultiSeason,
                                    stationCol   = "Station",
                                    setupCol     = "Setup_date",
                                    sessionCol   = "session",
                                    retrievalCol = "Retrieval_date",
                                    hasProblems  = TRUE,
                                    dateFormat   = "dmy"
)

# multi-season detection history
DetHist_multi &lt;- detectionHistory(recordTable      = recordTableSampleMultiSeason,
                            camOp                  = camop_season,
                            stationCol             = "Station",
                            speciesCol             = "Species",
                            species                = "VTA",
                            occasionLength         = 10,
                            day1                   = "station",
                            recordDateTimeCol      = "DateTimeOriginal",
                            includeEffort          = TRUE,
                            scaleEffort            = FALSE,
                            timeZone               = "UTC",
                            unmarkedMultFrameInput = TRUE
)

DetHist_multi


</code></pre>

<hr>
<h2 id='detectionMaps'>Generate maps of observed species richness and species presences by station</h2><span id='topic+detectionMaps'></span>

<h3>Description</h3>

<p>Generates maps of observed species richness and species presence by species
and station. Output can be R graphics, PNG graphics or a shapefile for use
in GIS software.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detectionMaps(
  CTtable,
  recordTable,
  Xcol,
  Ycol,
  backgroundPolygon,
  stationCol = "Station",
  speciesCol = "Species",
  speciesToShow,
  richnessPlot = TRUE,
  speciesPlots = TRUE,
  addLegend = TRUE,
  printLabels = FALSE,
  smallPoints,
  plotR = TRUE,
  writePNG = FALSE,
  plotDirectory,
  createPlotDir = FALSE,
  pngMaxPix = 1000,
  writeShapefile = FALSE,
  shapefileName,
  shapefileDirectory,
  shapefileProjection
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detectionMaps_+3A_cttable">CTtable</code></td>
<td>
<p>data.frame. contains station IDs and coordinates</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_recordtable">recordTable</code></td>
<td>
<p>data.frame. the record table created by
<code><a href="#topic+recordTable">recordTable</a></code></p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_xcol">Xcol</code></td>
<td>
<p>character. name of the column specifying x coordinates in
<code>CTtable</code></p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_ycol">Ycol</code></td>
<td>
<p>character. name of the column specifying y coordinates in
<code>CTtable</code></p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_backgroundpolygon">backgroundPolygon</code></td>
<td>
<p>SpatialPolygons or SpatialPolygonsDataFrame.
Polygon to be plotted in the background of the map (e.g. project area
boundary)</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_stationcol">stationCol</code></td>
<td>
<p>character. name of the column specifying station ID in
<code>CTtable</code> and <code>recordTable</code></p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. name of the column specifying species in
<code>recordTable</code></p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_speciestoshow">speciesToShow</code></td>
<td>
<p>character. Species to include in the maps. If missing,
all species in <code>recordTable</code> will be included.</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_richnessplot">richnessPlot</code></td>
<td>
<p>logical. Generate a species richness plot?</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_speciesplots">speciesPlots</code></td>
<td>
<p>logical. Generate plots of all species number of
independent events?</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_addlegend">addLegend</code></td>
<td>
<p>logical. Add legends to the plots?</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_printlabels">printLabels</code></td>
<td>
<p>logical. Add station labels to the plots?</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_smallpoints">smallPoints</code></td>
<td>
<p>numeric. Number by which to decrease point sizes in plots
(optional).</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_plotr">plotR</code></td>
<td>
<p>logical. Create plots in R graphics device?</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_writepng">writePNG</code></td>
<td>
<p>logical. Create PNGs of the plots?</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_plotdirectory">plotDirectory</code></td>
<td>
<p>character. Directory in which to save the PNGs</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_createplotdir">createPlotDir</code></td>
<td>
<p>logical. Create <code>plotDirectory</code>?</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_pngmaxpix">pngMaxPix</code></td>
<td>
<p>integer. number of pixels in pngs on the longer side</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_writeshapefile">writeShapefile</code></td>
<td>
<p>logical. Create a shapefile from the output?</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_shapefilename">shapefileName</code></td>
<td>
<p>character. Name of the shapefile to be saved. If empty,
a name will be generated automatically.</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_shapefiledirectory">shapefileDirectory</code></td>
<td>
<p>character. Directory in which to save the
shapefile.</p>
</td></tr>
<tr><td><code id="detectionMaps_+3A_shapefileprojection">shapefileProjection</code></td>
<td>
<p>character. A character string of projection
arguments to use in the shapefile.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The column name <code>stationCol</code> must be identical in <code>CTtable</code> and
<code>recordTable</code> and station IDs must match.
</p>
<p>Shapefile creation depends on the packages <span class="pkg">sf</span>.
Argument <code>shapefileProjection</code> must be a valid argument of
<code><a href="sf.html#topic+st_crs">st_crs</a></code> (one of (i) character: a string accepted by GDAL, 
(ii) integer, a valid EPSG value (numeric), or (iii) an object of class crs.
If <code>shapefileProjection</code> is undefined,
the resulting shapefile will lack a coordinate reference system.
</p>


<h3>Value</h3>

<p>An invisible <code>data.frame</code> with station coordinates, numbers of
events by species at each station and total species number by station. In
addition and optionally, R graphics or png image files.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>A great resource for coordinate system information
is <a href="https://spatialreference.org/">https://spatialreference.org/</a>. Use the Proj4 string as
<code>shapefileProjection</code> argument.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# load station information
data(camtraps)

# load record table
data(recordTableSample)


# create maps
Mapstest &lt;- detectionMaps(CTtable           = camtraps,
                          recordTable       = recordTableSample,
                          Xcol              = "utm_x",
                          Ycol              = "utm_y",
                          stationCol        = "Station",
                          speciesCol        = "Species",
                          writePNG          = FALSE,
                          plotR             = TRUE,
                          printLabels       = TRUE,
                          richnessPlot      = TRUE,
                          addLegend         = TRUE
)



# with a polygon in the background, and for one species only

# make a dummy polygon for the background
library(sf)

Sr1 = st_polygon(list(cbind(c(521500,526500,527000, 521500, 521500),
                            c(607500, 608000, 603500, 603500, 607500))))
aoi &lt;- data.frame(name = "My AOI")
st_geometry(aoi) &lt;- st_geometry(Sr1)
st_crs(aoi) &lt;- 32650  # assign CRS: UTM50N

Mapstest2 &lt;- detectionMaps(CTtable           = camtraps,
                           recordTable       = recordTableSample,
                           Xcol              = "utm_x",
                           Ycol              = "utm_y",
                           backgroundPolygon = aoi,               # this was added
                           speciesToShow     = c("PBE", "VTA"),   # this was added
                           stationCol        = "Station",
                           speciesCol        = "Species",
                           writePNG          = FALSE,
                           plotR             = TRUE,
                           printLabels       = TRUE,
                           richnessPlot      = TRUE,
                           addLegend         = TRUE
)




</code></pre>

<hr>
<h2 id='exifTagNames'>Show Exif metadata of JPEG images or other image or video formats</h2><span id='topic+exifTagNames'></span>

<h3>Description</h3>

<p>The function will return metadata values, metadata tag names and group names
of Exif metadata of JPEG images or other formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exifTagNames(
  inDir,
  whichSubDir = 1,
  fileName,
  returnMetadata = "DEPRECATED",
  returnTagGroup = "DEPRECATED"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exifTagNames_+3A_indir">inDir</code></td>
<td>
<p>character. Directory containing camera trap images sorted into
station subdirectories (e.g. inDir/StationA/)</p>
</td></tr>
<tr><td><code id="exifTagNames_+3A_whichsubdir">whichSubDir</code></td>
<td>
<p>integer or character. Either number or name of
subdirectory of <code>inDir</code> in which to look for an image</p>
</td></tr>
<tr><td><code id="exifTagNames_+3A_filename">fileName</code></td>
<td>
<p>character. A filename, either the file name of an image in
<code>inDir</code> or a full path with file name (in which case <code>inDir</code> is
not needed)</p>
</td></tr>
<tr><td><code id="exifTagNames_+3A_returnmetadata">returnMetadata</code></td>
<td>
<p>deprecated and ignored</p>
</td></tr>
<tr><td><code id="exifTagNames_+3A_returntaggroup">returnTagGroup</code></td>
<td>
<p>deprecated and ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many digital cameras record information such as ambient temperature or moon
phase under maker-specific tag names in Exif metadata of JPEG images. In
addition, many technical information are stored in Exif metadata. In order
to extract those information from images and add them to the record tables
created by the functions <code><a href="#topic+recordTable">recordTable</a></code> and
<code><a href="#topic+recordTableIndividual">recordTableIndividual</a></code>, the tag names must be known so they can
be passed to these functions via the <code>additionalMetadataTags</code> argument.
</p>
<p>By default the function returns both metadata tag names and the metadata
group they belong to (via argument <code>returnTagGroup</code>). This is helpful
to unambiguously address specific metadata tags, because different groups
can contain tags of identical names, which may cause problems executing the
functions <code><a href="#topic+recordTable">recordTable</a></code> and <code><a href="#topic+recordTableIndividual">recordTableIndividual</a></code>.
The format is &quot;GROUP:tag&quot;, e.g. &quot;EXIF:Flash&quot;.
</p>


<h3>Value</h3>

<p>A data frame containing three columns: metadata tag group, tag name,
and values.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>Phil Harvey's ExifTool <a href="https://exiftool.org/">https://exiftool.org/</a> <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+recordTable">recordTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 

wd_images_ID &lt;- system.file("pictures/sample_images_species_dir", package = "camtrapR")

# specify directory, camtrapR will automatically take first image from first subdirectory
exifTagNames(inDir          = wd_images_ID)

# specify subdirectory by name, camtrapR will use first image
exifTagNames(inDir          = wd_images_ID,
             whichSubDir    = "StationA")

# specifying fileName only (line break due to R package policy)
exifTagNames(fileName       = file.path(wd_images_ID, "StationC", "TRA", 
                                        "StationC__2009-05-02__00-10-00(1).JPG"))
                                        
# specify inDir and fileName
exifTagNames(inDir          = wd_images_ID,
             fileName       = file.path("StationC", "TRA", "StationC__2009-05-02__00-10-00(1).JPG"))
             
# it also works this way
exifTagNames(inDir          = file.path(wd_images_ID, "StationC", "TRA"),
             fileName       = "StationC__2009-05-02__00-10-00(1).JPG")
             

# with tagged sample images
wd_images_ID_tagged &lt;- system.file("pictures/sample_images_indiv_tag", package = "camtrapR")
exifTagNames(inDir          = wd_images_ID_tagged)


## End(Not run)

</code></pre>

<hr>
<h2 id='filterRecordTable'>Filter species record table for temporal independence</h2><span id='topic+filterRecordTable'></span>

<h3>Description</h3>

<p>Filter species record table for temporal independence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterRecordTable(
  recordTable,
  minDeltaTime = 0,
  deltaTimeComparedTo,
  speciesCol = "Species",
  stationCol,
  cameraCol,
  camerasIndependent,
  recordDateTimeCol = "DateTimeOriginal",
  recordDateTimeFormat = "ymd HMS",
  removeDuplicateRecords = TRUE,
  exclude,
  timeZone,
  writecsv = FALSE,
  outDir,
  eventSummaryColumn,
  eventSummaryFunction,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filterRecordTable_+3A_recordtable">recordTable</code></td>
<td>
<p>data frame as created by <code><a href="#topic+recordTable">recordTable</a></code>.</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_mindeltatime">minDeltaTime</code></td>
<td>
<p>integer. Time difference between records of the same
species at the same station to be considered independent (in minutes)</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_deltatimecomparedto">deltaTimeComparedTo</code></td>
<td>
<p>character. For two records to be considered
independent, must the second one be at least <code>minDeltaTime</code> minutes
after the last independent record of the same species
(<code>"lastIndependentRecord"</code>), or <code>minDeltaTime</code> minutes after the
last record (<code>"lastRecord"</code>)?</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. name of the column specifying species in 
<code>recordTable</code></p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_stationcol">stationCol</code></td>
<td>
<p>character. Name of the camera trap station column.
Assuming &quot;Station&quot; if undefined.</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_cameracol">cameraCol</code></td>
<td>
<p>character. Name of the column specifying cameras in 
<code>recordTable</code> (optional).</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_camerasindependent">camerasIndependent</code></td>
<td>
<p>logical. If <code>TRUE</code>, species records are
considered to be independent between cameras at a station.</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_recorddatetimecol">recordDateTimeCol</code></td>
<td>
<p>character. Name of the column specifying date and 
time in <code>recordTable</code>.</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_recorddatetimeformat">recordDateTimeFormat</code></td>
<td>
<p>character. Format of column 
<code>recordDateTimeCol</code> in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_removeduplicaterecords">removeDuplicateRecords</code></td>
<td>
<p>logical. If there are several records of the
same species at the same station (also same camera if cameraID is defined)
at exactly the same time, show only one?</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_exclude">exclude</code></td>
<td>
<p>character. Vector of species names to be excluded from the
record table</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_timezone">timeZone</code></td>
<td>
<p>character. Must be a value returned by
<code><a href="base.html#topic+timezones">OlsonNames</a></code></p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_writecsv">writecsv</code></td>
<td>
<p>logical. Should the record table be saved as a .csv?</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_outdir">outDir</code></td>
<td>
<p>character. Directory to save csv to. If NULL and
<code>writecsv = TRUE</code>, recordTable will be written to <code>inDir</code>.</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_eventsummarycolumn">eventSummaryColumn</code></td>
<td>
<p>character. A column in the record table (e.g. from
a metadata tag) by to summarise non-independent records (those within
<code>minDeltaTime</code> of a given record) with a user-defined function
(<code>eventSummaryFunction</code>)</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_eventsummaryfunction">eventSummaryFunction</code></td>
<td>
<p>character. The function by which to summarise
<code>eventSummaryColumn</code> of non-independent records, e.g. &quot;sum&quot;, &quot;max&quot;
(optional)</p>
</td></tr>
<tr><td><code id="filterRecordTable_+3A_quiet">quiet</code></td>
<td>
<p>logical. If TRUE, suppress printing of progress.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing species records and additional information
about stations, date, time, filtered for temporal independence.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (Sys.which("exiftool") != ""){        # only run example if ExifTool is available

# set directory with camera trap images in station directories
wd_images_ID_species &lt;- system.file("pictures/sample_images_species_dir", 
                                    package = "camtrapR")
                                    
# create record table without temporal filtering
rec_table &lt;- recordTable(inDir                  = wd_images_ID_species,
                        IDfrom                 = "directory",
                        minDeltaTime           = 0,
                        exclude                = "UNID",
                        timeZone               = "Asia/Kuala_Lumpur",
                        removeDuplicateRecords = TRUE
                        )
                        
# filter for 60 minutes temporal independence
rec_table_filt &lt;- filterRecordTable(recordTable         = rec_table, 
                                    minDeltaTime        = 60, 
                                    stationCol          = "Station",
                                    deltaTimeComparedTo = "lastIndependentRecord")
 nrow(rec_table)
 nrow(rec_table_filt)
 
 }
</code></pre>

<hr>
<h2 id='fit+2CcommOccu-method'>Fit a community (multi-species) occupancy model</h2><span id='topic+fit+2CcommOccu-method'></span>

<h3>Description</h3>

<p>Convenience function for fitting community occupancy models (defined in a commOccu object) in JAGS or Nimble.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'commOccu'
fit(
  object,
  n.iter = 100,
  thin = 1,
  n.burnin = n.iter/2,
  n.adapt = 0,
  chains = 3,
  inits = NULL,
  compile = TRUE,
  WAIC = FALSE,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_object">object</code></td>
<td>
<p><code>commOccu</code> object</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_n.iter">n.iter</code></td>
<td>
<p>number of iterations to monitor</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_thin">thin</code></td>
<td>
<p>thinning interval for monitors</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_n.burnin">n.burnin</code></td>
<td>
<p>burnin length. Defaults to half of n.iter.</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Length of adaptive phase</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_chains">chains</code></td>
<td>
<p>number of MCMC chains to run</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_inits">inits</code></td>
<td>
<p>named list. Initial values to use. If NULL (default), the values from the inits function in <code>object</code> are used.</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_compile">compile</code></td>
<td>
<p>logical. If Nimble model, compile model with <code><a href="nimble.html#topic+compileNimble">compileNimble</a></code> before running model?</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_waic">WAIC</code></td>
<td>
<p>logical. Return WAIC (only Nimble models)</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_quiet">quiet</code></td>
<td>
<p>if TRUE messages and progress bar will be suppressed</p>
</td></tr>
<tr><td><code id="fit+2B2CcommOccu-method_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to <code><a href="nimble.html#topic+runMCMC">runMCMC</a></code> (only relevant for Nimble)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models will be fit either in JAGS or Nimble, depending on the decision made in the <code>nimble</code> argument in <code><a href="#topic+communityModel">communityModel</a></code>.
</p>
<p>For Nimble, compilation is strongly recommended for long model runs. Uncompiled models can run extremely slow. Compilation itself can take a while also, and requires that Rtools is available on the system.
</p>
<p>This is a convenience function only which hides some of the configuration options. If you require more control over model fitting, you can run all steps individually. See vignette 5 for details.
</p>


<h3>Value</h3>

<p>A coda::mcmc.list
</p>

<hr>
<h2 id='fixDateTimeOriginal'>Fix DateTimeOriginal Exif metadata tag in Reconyx Hyperfire cameras</h2><span id='topic+fixDateTimeOriginal'></span>

<h3>Description</h3>

<p>Some camera models don't store the date/time information in the standard
Exif metadata tag. Consequently, camtrapR cannot find that information. This
function uses Exiftool to update the DateTimeOriginal metadata tag in all
images within a directory to make them readable with camtrapR (and other
software).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixDateTimeOriginal(inDir, recursive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixDateTimeOriginal_+3A_indir">inDir</code></td>
<td>
<p>character. Name of the directory containing images to be fixed</p>
</td></tr>
<tr><td><code id="fixDateTimeOriginal_+3A_recursive">recursive</code></td>
<td>
<p>logical. Recursively find images in subdirectories of
<code>inDir</code>?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some Reconyx Hyperfire cameras (e.g. HC500) are known to show this problem.
</p>


<h3>Value</h3>

<p>Returns invisibly the messages returned by the Exiftool call
(warnings etc.).
</p>


<h3>Warning </h3>

<p>Please make a backup of your images before running this
function.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>This function uses the code from: <br /> Tobler, Mathias (2015).
Camera Base Version 1.7 User Guide
<a href="https://www.atrium-biodiversity.org/tools/camerabase/files/CameraBaseDoc1.7.pdf">https://www.atrium-biodiversity.org/tools/camerabase/files/CameraBaseDoc1.7.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# a hypothetical example

wd_images_hyperfire &lt;- "C:/Some/Directory"

fixDateTimeOriginal(inDir     = wd_images_hyperfire,
                    recursive = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='getSpeciesImages'>Collect all images of a species</h2><span id='topic+getSpeciesImages'></span>

<h3>Description</h3>

<p>This function will fetch all images of a particular species from all camera
trap stations and copies these images to a new location. The images which
are to be copied are found in one of 2 possible ways, 1) by providing an
existing record table (created with <code><a href="#topic+recordTable">recordTable</a></code>) or 2) by
reading species IDs from species directories or from metadata (calling
ExifTool). Earlier in the workflow, i.e., before running this function,
images should have been renamed (with <code><a href="#topic+imageRename">imageRename</a></code>) to give
images unique file names based on station ID and date/time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpeciesImages(
  species,
  recordTable,
  speciesCol = "Species",
  stationCol = "Station",
  inDir,
  outDir,
  createStationSubfolders = FALSE,
  IDfrom,
  metadataSpeciesTag,
  metadataHierarchyDelimitor = "|"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSpeciesImages_+3A_species">species</code></td>
<td>
<p>character. Species whose images are to be fetched</p>
</td></tr>
<tr><td><code id="getSpeciesImages_+3A_recordtable">recordTable</code></td>
<td>
<p>data frame. A data frame as returned by function
<code><a href="#topic+recordTable">recordTable</a></code>. If you specify this argument, do not specify
<code>inDir</code></p>
</td></tr>
<tr><td><code id="getSpeciesImages_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. Name of the column specifying species ID in
<code>recordTable</code>. Only required if <code>recordTable</code> is defined</p>
</td></tr>
<tr><td><code id="getSpeciesImages_+3A_stationcol">stationCol</code></td>
<td>
<p>character. Name of the column specifying station ID in
<code>recordTable</code>. Only required if <code>recordTable</code> is defined</p>
</td></tr>
<tr><td><code id="getSpeciesImages_+3A_indir">inDir</code></td>
<td>
<p>character. Directory containing identified (species level)
camera trap images sorted into station subdirectories (e.g.
inDir/StationA/). If you specify this argument, do not specify
<code>recordTable</code>.</p>
</td></tr>
<tr><td><code id="getSpeciesImages_+3A_outdir">outDir</code></td>
<td>
<p>character. Directory in which to save species images. A
species subdirectory will be created in <code>outDir</code> automatically.</p>
</td></tr>
<tr><td><code id="getSpeciesImages_+3A_createstationsubfolders">createStationSubfolders</code></td>
<td>
<p>logical. Save images in station directories
within the newly created species directory in <code>outDir</code>?</p>
</td></tr>
<tr><td><code id="getSpeciesImages_+3A_idfrom">IDfrom</code></td>
<td>
<p>character. Read species ID from image metadata (&quot;metadata&quot;) of
from species directory names (&quot;directory&quot;)? Only required if <code>inDir</code> is
defined.</p>
</td></tr>
<tr><td><code id="getSpeciesImages_+3A_metadataspeciestag">metadataSpeciesTag</code></td>
<td>
<p>character. The species ID tag name in image
metadata (if IDfrom = &quot;metadata&quot;). Only required if <code>inDir</code> is defined.</p>
</td></tr>
<tr><td><code id="getSpeciesImages_+3A_metadatahierarchydelimitor">metadataHierarchyDelimitor</code></td>
<td>
<p>character. The character delimiting
hierarchy levels in image metadata tags in field &quot;HierarchicalSubject&quot;.
Either &quot;|&quot; or &quot;:&quot; (if IDfrom = &quot;metadata&quot;). Only required if <code>inDir</code> is
defined and <code>IDfrom = "metadata"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function finds the images to be copied by either consulting a record
table created with <code><a href="#topic+recordTable">recordTable</a></code> or by reading species IDs from
images. The former is considerable faster because ExifTool is not called,
but requires images to be in precisely the location given by the columns
<code>Directory</code> and <code>FileName</code> in <code>recordTable</code>. To use this
feature, provide the function with a record table in argument
<code>recordTable</code>.
</p>
<p>If you'd rather read species IDs from images within the function (to make
sure all file paths are correct), images need to be in the directory
structure required by the package, e.g.
</p>
<p>&gt; inDir/Station/Species
</p>
<p>or
</p>
<p>&gt; inDir/Station/Camera/Species
</p>
<p>if using species directories for species IDs, and
</p>
<p>&gt; inDir/Station
</p>
<p>or
</p>
<p>&gt; inDir/Station/Camera
</p>
<p>if reading IDs from species metadata tags. In the latter case, only station
directories are needed. In any case, the argument <code>species</code> must match
species IDs (either the <code>speciesCol</code> in <code>recordTable</code>, species
directory names or species metadata tags).
</p>
<p>Before running the function, first rename the images using function
<code><a href="#topic+imageRename">imageRename</a></code> to provide unique file names and prevent several
images from having the same name (if generic names like &quot;IMGP0001.jpg&quot; are
used). The function will not copy images if there are duplicate filenames to
prevent overwriting images unintentionally.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with old and new directories and file names and
the copy status (<code>copy_ok</code>; TRUE if copying was successful, FALSE if
not).
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# define image directory
wd_images_ID &lt;- system.file("pictures/sample_images_species_dir", package = "camtrapR")
wd_images_ID_copy &lt;- file.path(tempdir(), "sample_images_species_dir")

species_to_copy &lt;- "VTA"    # = Viverra tangalunga, Malay Civet

specImagecopy &lt;- getSpeciesImages(species                 = species_to_copy,
                                  inDir                   = wd_images_ID,
                                  outDir                  = wd_images_ID_copy,
                                  createStationSubfolders = FALSE,
                                  IDfrom                  = "directory"
                                  )

## End(Not run)

</code></pre>

<hr>
<h2 id='imageRename'>Copy and rename images based on camera trap station ID and creation date</h2><span id='topic+imageRename'></span>

<h3>Description</h3>

<p>The function renames and copies raw camera trap images into a new location
where they can be identified. Images are renamed with camera trap station
ID, camera ID (optional), creation date and a numeric identifier for images
taken within one minute of each other at a given station. Station ID and
camera ID are derived from the raw image directory structure. The creation
date is extracted from image metadata using ExifTool.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imageRename(
  inDir,
  outDir,
  hasCameraFolders,
  keepCameraSubfolders,
  createEmptyDirectories = FALSE,
  copyImages = FALSE,
  writecsv = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="imageRename_+3A_indir">inDir</code></td>
<td>
<p>character. Directory containing camera trap images sorted into
station subdirectories (e.g. inDir/StationA/)</p>
</td></tr>
<tr><td><code id="imageRename_+3A_outdir">outDir</code></td>
<td>
<p>character. Directory into which the renamed images will be
copied</p>
</td></tr>
<tr><td><code id="imageRename_+3A_hascamerafolders">hasCameraFolders</code></td>
<td>
<p>logical. Do the station directories in <code>inDir</code>
have camera subdirectories (e.g. &quot;inDir/StationA/Camera1&quot;)?</p>
</td></tr>
<tr><td><code id="imageRename_+3A_keepcamerasubfolders">keepCameraSubfolders</code></td>
<td>
<p>logical. Should camera directories be preserved
as subdirectories of <code>outDir</code> (e.g. &quot;outDir/StationA/CameraA1&quot;)?</p>
</td></tr>
<tr><td><code id="imageRename_+3A_createemptydirectories">createEmptyDirectories</code></td>
<td>
<p>logical. If station or camera directories are
empty, should they be copied nevertheless (causing empty directories in
<code>outDir</code>, but preserving the whole directory structure)?</p>
</td></tr>
<tr><td><code id="imageRename_+3A_copyimages">copyImages</code></td>
<td>
<p>logical. Copy images to <code>outDir</code>?</p>
</td></tr>
<tr><td><code id="imageRename_+3A_writecsv">writecsv</code></td>
<td>
<p>logical. Save a data frame with a summary as a .csv? The csv
will be saved in <code>outDir</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Setting up the correct raw image directory structure is necessary for
running the function successfully. <code>inDir</code> is the main directory that
contains camera trap station subdirectories (e.g. inDir/StationA). If one
camera was deployed per station and no camera subdirectories are used within
station directories, <code>hasCameraFolders</code> can be set to <code>FALSE</code>. If
more than one camera was deployed at stations, there must be subdirectories
for the individual camera traps within the station directories (e.g.
&quot;inDir/StationA/CameraA1&quot; and &quot;inDir/StationA/CameraA2&quot;). Even if only some
stations had multiple cameras, all station will need camera subdirectories.
The argument <code>hasCameraFolders</code> must be <code>TRUE</code>. Within the camera
subdirectories, the directory structure is irrelevant.
</p>
<p>Renaming of images follows the following pattern: If <code>hasCameraFolders</code>
is TRUE, it is: &quot;StationID__CameraID__Date__Time(Number).JPG&quot;, e.g.
&quot;StationA__CameraA1__2015-01-31__18-59-59(1).JPG&quot;. If
<code>hasCameraFolders</code> is FALSE, it is:
&quot;StationID__Date__Time(Number).JPG&quot;, e.g.
&quot;StationA__2015-01-31__18-59-59(1).JPG&quot;.
</p>
<p>The purpose of the number in parentheses is to prevent assigning identical
file names to images taken at the same station (and camera) in the same
second, as can happen if cameras take sequences of images. It is a
consecutive number given to all images taken at the same station by the same
camera within one minute. The double underscore &quot;__&quot; in the image file names
is for splitting and extracting information from file names in other
functions (e.g. for retrieving camera IDs in <code><a href="#topic+recordTable">recordTable</a></code> if
camera subdirectories are not preserved (<code>keepCameraSubfolders =
FALSE</code>)).
</p>
<p>The function finds all JPEG images and extracts the image timestamp from the
image metadata using ExifTool and copies the images (with new file names)
into <code>outDir</code>, where it will set up a directory structure based on the
station IDs and, if required by <code>keepCameraSubfolders = TRUE</code>, camera
IDs (e.g. outDir/StationA/ or outDir/StationA/CameraA1).
</p>
<p><code>copyImages</code> can be set to FALSE to simulate the renaming and check the
file names of the renamed images without copying. If you are handling large
number of images (&gt;e.g., 100,000), the function may take some time to run.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with original directory and file names, new
directory and file names and an indicator for whether images were copied
successfully.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>Phil Harvey's ExifTool <a href="https://exiftool.org/">https://exiftool.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


  ## Not run: 
  
### "trial" run. create a table with file names after renaming, but don't copy images.

# first, find sample image directory in package directory:
wd_images_raw &lt;- system.file("pictures/raw_images", package = "camtrapR")

# because copyImages = FALSE, outDir does not need to be defined
renaming.table &lt;- imageRename(inDir               = wd_images_raw,     
                              hasCameraFolders = FALSE,
                              copyImages          = FALSE,
                              writecsv            = FALSE
  )


  
### a real example in which images are copied and renamed 

  # define raw image location
wd_images_raw &lt;- system.file("pictures/raw_images", package = "camtrapR") 

  # define destination for renamed images
wd_images_raw_renamed &lt;- file.path(tempdir(), "raw_images_renamed")       


  # now we have to define outDir because copyImages = TRUE
renaming.table2 &lt;- imageRename(inDir               = wd_images_raw,
                               outDir              = wd_images_raw_renamed,       
                               hasCameraFolders    = FALSE,
                               copyImages          = TRUE,
                               writecsv            = FALSE
  )
  
  # show output files
  list.files(wd_images_raw_renamed, recursive = TRUE)
  
  # output table
  renaming.table2
  
  
## End(Not run)

</code></pre>

<hr>
<h2 id='OCRdataFields'>Optical character recognition (OCR) from data fields in digital images</h2><span id='topic+OCRdataFields'></span>

<h3>Description</h3>

<p>Extracts information from the data fields in camera trap images (not the
metadata). Many camera traps include data fields in camera trap images,
often including date and time of images, and sometimes other information.
This function extracts the information from these fields using optical
character recognition provided by the package <span class="pkg">tesseract</span> after reading
images using the package <span class="pkg">magick</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OCRdataFields(inDir, geometries, invert = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OCRdataFields_+3A_indir">inDir</code></td>
<td>
<p>character. Directory containing camera trap images (or
subdirectories containing images)</p>
</td></tr>
<tr><td><code id="OCRdataFields_+3A_geometries">geometries</code></td>
<td>
<p>list. A (possibly named) list of geometry strings defining
the image area(s) to extract.</p>
</td></tr>
<tr><td><code id="OCRdataFields_+3A_invert">invert</code></td>
<td>
<p>logical. Invert colors in the image? Set to TRUE if text in
data field is white on black background. Leave if FALSE if text is black in
white background.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Normally all these information should be in the image metadata. This
function is meant as a last resort if image metadata are unreadable or were
removed from images. OCR is not perfect and may misidentify characters, so
check the output carefully.
</p>
<p>The output of this function can be used in
<code><a href="#topic+writeDateTimeOriginal">writeDateTimeOriginal</a></code> to write date/time into the
DateTimeOriginal tag in image metadata, making these images available for
automatic processing with <code><a href="#topic+recordTable">recordTable</a></code> and other functions that
extract image metadata.
</p>
<p>This function reads all images in inDir (including subdirectories), crops
them to the geometries in the &quot;geometries&quot; list, and performs optical
character recognition (OCR) on each of these fields (leveraging the magick
and tesseract packages).
</p>
<p>Geometries are defined with <code>geometry_area</code> from <span class="pkg">magick</span>. See
<code><a href="magick.html#topic+geometry">geometry</a></code> for details on how to specify geometries with
<code>geometry_area</code>. The format is: &quot;widthxheight+x_off+y_off&quot;, where:
</p>
 <dl>
<dt>width</dt><dd><p>width of the area of interest</p>
</dd> <dt>height</dt><dd><p>height
of the area of interest</p>
</dd> <dt>x_off</dt><dd><p>offset from the left side of the
image</p>
</dd> <dt>y_off</dt><dd><p>offset from the top of the image</p>
</dd> </dl>

<p>Units are pixels for all fields. digiKam can help in identifying the correct
specification for geometries. Open the Image Editor, left-click and draw a
box around the data field of interest. Ensure the entire text field is
included inside the box, but nothing else. Now note two pairs of numbers at
the bottom of the window, showing the offsets and box size as e.g.:
</p>
<p>&quot;(400, 1800) (300 x 60)&quot;
</p>
<p>This corresponds to the geometry values as follows:
</p>
<p>&quot;(x_off, y_off) (width x height)&quot;
</p>
<p>Using these values, you'd run:
</p>
<p><code>geometry_area(x_off = 400, y_off = 1800, width = 300, height = 60)</code>
</p>
<p>and receive
</p>
<p>&quot;300x60+400+1800&quot;
</p>
<p>as your geometry.
</p>
<p>OCR in tesseract has problems with white font on black background. If that
is the case in your images, set <code>invert</code> to <code>TRUE</code> to invert the
image and ensure OCR uses black text on white background.
</p>
<p>Even then, output will not be perfect. Error rates in OCR depend on multiple
factors, including the text size and font type used. We don't have control
over these, so check the output carefully and edit as required.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with original directory and file names, and
additional columns for the OCR data of each extracted geometry.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+writeDateTimeOriginal">writeDateTimeOriginal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# dontrun is to avoid forcing users to install additional dependencies

wd_images_OCR &lt;- system.file("pictures/full_size_for_ocr", package = "camtrapR")

library(magick)

# define geometries
geometry1 &lt;- geometry_area(x_off = 0, y_off = 0, width = 183, height = 37)
geometry2 &lt;- geometry_area(x_off = 196, y_off = 0, width = 200, height = 17)
geometry3 &lt;- geometry_area(x_off = 447, y_off = 0, width = 63, height = 17)
geometry4 &lt;- geometry_area(x_off = 984, y_off = 0, width = 47, height = 17)
geometry5 &lt;- geometry_area(x_off = 0, y_off = 793, width = 320, height = 17)

# combine geometries into list
geometries &lt;- list(date = geometry1, 
                   time = geometry2, 
                   sequence_id = geometry3,
                   temperature = geometry4,
                   camera_model = geometry5)

df_image_data  &lt;- OCRdataFields(inDir = wd_images_OCR,
                                geometries = geometries, 
                                invert = TRUE)       
df_image_data

# note the mistake in "camera_model"
# it should be "PC850", not "PC8S0O"
# date and time are correct though
                   

## End(Not run)



</code></pre>

<hr>
<h2 id='plot_coef+2CcommOccu-method'>Plot effect sizes of covariates in community occupancy model</h2><span id='topic+plot_coef+2CcommOccu-method'></span><span id='topic+plot_coef'></span>

<h3>Description</h3>

<p>Plot effect sizes for all species in a community (multi-species) occupancy model. Currently only supports continuous covariates, not categorical covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'commOccu'
plot_coef(
  object,
  mcmc.list,
  submodel = "state",
  ordered = TRUE,
  combine = FALSE,
  outdir,
  level = c(outer = 0.95, inner = 0.75),
  colorby = "significance",
  scales = "free_y",
  community_lines = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_object">object</code></td>
<td>
<p><code>commOccu</code> object</p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_mcmc.list">mcmc.list</code></td>
<td>
<p>mcmc.list. Output of <code><a href="generics.html#topic+fit">fit</a></code> called on a <code>commOccu</code> object</p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_submodel">submodel</code></td>
<td>
<p>character. Submodel to get plots for. Can be <code>"det"</code> or <code>"state"</code></p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_ordered">ordered</code></td>
<td>
<p>logical. Order species in plot by median effect (TRUE) or by species name (FALSE)</p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_combine">combine</code></td>
<td>
<p>logical. Combine multiple plots into one plot (via facets)?</p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_outdir">outdir</code></td>
<td>
<p>character. Directory to save plots to (optional)</p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_level">level</code></td>
<td>
<p>numeric. Probability mass to include in the uncertainty interval (two values named &quot;outer&quot; and &quot;inner&quot;, in that order). Second value (= inner interval) will be plotted thicker.</p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_colorby">colorby</code></td>
<td>
<p>character. Whether to color estimates by <code>"significance"</code> (of the effect estimates), or <code>"Bayesian p-value"</code> (of the species). Currently allows only <code>"significance"</code>.</p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_scales">scales</code></td>
<td>
<p>character. Passed to <code><a href="ggplot2.html#topic+facet_grid">facet_grid</a></code>. Can be <code>"free"</code> to scale x axes of effect estimates independently, or &quot;free_y&quot; to scale all x axes identically.</p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_community_lines">community_lines</code></td>
<td>
<p>logical. Add faint vertical lines to the plot indicating median community effect (solid line) and its confidence interval (first value from <code>level</code>).</p>
</td></tr>
<tr><td><code id="plot_coef+2B2CcommOccu-method_+3A_...">...</code></td>
<td>
<p>additional arguments for <code><a href="ggplot2.html#topic+ggsave">ggsave</a></code> - only relevant if <code>outdir</code> is defined.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users who wish to create their own visualizations can use the data stored in the ggplot output. It is accessed via e.g. <code>output$covariate_name$data</code>
</p>


<h3>Value</h3>

<p>A list of ggplot objects (one list item per covariate).
</p>

<hr>
<h2 id='plot_effects+2CcommOccu-method'>Plot Marginal Effects of Covariates</h2><span id='topic+plot_effects+2CcommOccu-method'></span><span id='topic+plot_effects'></span>

<h3>Description</h3>

<p>Plot marginal effect plots (= response curves if covariates are continuous) for all species in a community (multi-species) occupancy model. Takes into account species-specific intercepts (if any). Currently only supports continuous covariates, not categorical covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'commOccu'
plot_effects(
  object,
  mcmc.list,
  submodel = "state",
  response = "occupancy",
  draws = 1000,
  outdir,
  level = 0.95,
  keyword_quadratic = "_squared",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_effects+2B2CcommOccu-method_+3A_object">object</code></td>
<td>
<p><code>commOccu</code> object</p>
</td></tr>
<tr><td><code id="plot_effects+2B2CcommOccu-method_+3A_mcmc.list">mcmc.list</code></td>
<td>
<p>mcmc.list. Output of <code><a href="generics.html#topic+fit">fit</a></code> called on a <code>commOccu</code> object</p>
</td></tr>
<tr><td><code id="plot_effects+2B2CcommOccu-method_+3A_submodel">submodel</code></td>
<td>
<p>character. Submodel to get plots for. Can be <code>"det"</code> (detection submodel) or <code>"state"</code> (occupancy submodel)</p>
</td></tr>
<tr><td><code id="plot_effects+2B2CcommOccu-method_+3A_response">response</code></td>
<td>
<p>character. response type on y axis. Only relevant for <code>submodel = "state"</code>. Default is <code>"occupancy"</code>, can be set to <code>"abundance"</code> for Royle-Nichols models</p>
</td></tr>
<tr><td><code id="plot_effects+2B2CcommOccu-method_+3A_draws">draws</code></td>
<td>
<p>integer. Number of draws from the posterior to use when generating the plots. If fewer posterior samples than specified in <code>draws</code> are available, all posterior samples are used.</p>
</td></tr>
<tr><td><code id="plot_effects+2B2CcommOccu-method_+3A_outdir">outdir</code></td>
<td>
<p>character. Directory to save plots to (optional)</p>
</td></tr>
<tr><td><code id="plot_effects+2B2CcommOccu-method_+3A_level">level</code></td>
<td>
<p>numeric. Probability mass to include in the uncertainty interval.</p>
</td></tr>
<tr><td><code id="plot_effects+2B2CcommOccu-method_+3A_keyword_quadratic">keyword_quadratic</code></td>
<td>
<p>character. A suffix in covariate names in the model that indicates a covariate is a quadratic effect of another covariate which does not carry the suffix in its name (e.g. if the covariate is &quot;elevation&quot;, the quadratic covariate would be &quot;elevation_squared&quot;).</p>
</td></tr>
<tr><td><code id="plot_effects+2B2CcommOccu-method_+3A_...">...</code></td>
<td>
<p>additional arguments for <code><a href="ggplot2.html#topic+ggsave">ggsave</a></code> - only relevant if <code>outdir</code> is defined</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users who wish to create their own visualizations can use the data stored in the ggplot output. It is accessed via e.g. <code>output$covariate_name$data</code>
</p>


<h3>Value</h3>

<p>A list of ggplot objects (one list item per covariate).
</p>

<hr>
<h2 id='predict+2CcommOccu-method'>Predictions from community occupancy models</h2><span id='topic+predict+2CcommOccu-method'></span><span id='topic+predict'></span>

<h3>Description</h3>

<p>Create (spatial) predictions of species occupancy and species richness from community occupancy models and spatial rasters or covariate data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'commOccu'
predict(
  object,
  mcmc.list,
  type,
  draws = 1000,
  level = 0.95,
  interval = c("none", "confidence"),
  x,
  aoi = NULL,
  speciesSubset,
  batch = FALSE,
  seed
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_object">object</code></td>
<td>
<p><code>commOccu</code> object</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_mcmc.list">mcmc.list</code></td>
<td>
<p>mcmc.list. Output of <code><a href="generics.html#topic+fit">fit</a></code> called on a <code>commOccu</code> object</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_type">type</code></td>
<td>
<p>character. &quot;psi&quot; for species occupancy estimates, &quot;richness&quot; for species richness estimates, &quot;pao&quot; for percentage of area occupied (by species), &quot;psi_array&quot; for raw occupancy probabilities in an array. For Royle-Nichols models, &quot;abundance&quot; for species abundance, or &quot;lambda_array&quot; for raw species abundance estimates in an array.</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_draws">draws</code></td>
<td>
<p>Number of draws from the posterior to use when generating the plots. If fewer than draws are available, they are all used</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_level">level</code></td>
<td>
<p>Probability mass to include in the uncertainty interval</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_interval">interval</code></td>
<td>
<p>Type of interval calculation. Can be &quot;none&quot; or &quot;confidence&quot; (can be abbreviated). Calculation can be slow for type = &quot;psi&quot; with many cells and posterior samples.</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_x">x</code></td>
<td>
<p>SpatRaster or data.frame. Must be scaled with same parameters as site covariates used in model, and have same names.</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_aoi">aoi</code></td>
<td>
<p>SpatRaster with same dimensions as x (if x is a SpatRaster), indicating the area of interest (all cells with values are AOI, all NA cells are ignored). If NULL, predictions are made for all cells.</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_speciessubset">speciesSubset</code></td>
<td>
<p>species to include in richness estimates. Can be index number or species names.</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_batch">batch</code></td>
<td>
<p>logical or numeric. If FALSE, all raster cells / data frame rows will be processed at once (can be memory intensive). If TRUE, computation is conducted in batches of 1000. If numeric, it is the desired batch size.</p>
</td></tr>
<tr><td><code id="predict+2B2CcommOccu-method_+3A_seed">seed</code></td>
<td>
<p>numeric. Seed to use in <code>set.seed</code> for reproducible results (ensures that <code>draws</code> are identical).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Processing can be very memory-intensive. If memory is insufficient, use the  <code>batch</code> parameter. This can enable processing for higher numbers of <code>draws</code> or very large rasters / data frames.
</p>


<h3>Value</h3>

<p>A SpatRaster or data.frame, depending on <code>x</code>. If type = &quot;pao&quot;, a list. If type = &quot;psi_array&quot; or &quot;lambda_array&quot;, a 3D-array [cell, species, draw].
</p>

<hr>
<h2 id='recordTable'>Generate a species record table from camera trap images and videos</h2><span id='topic+recordTable'></span>

<h3>Description</h3>

<p>Generates a record table from camera trap images or videos. Images/videos
must be sorted into station directories at least. The function can read
species identification from a directory structure (Station/Species or
Station/Camera/Species) or from image metadata tags.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recordTable(
  inDir,
  IDfrom,
  cameraID,
  camerasIndependent,
  exclude,
  minDeltaTime = 0,
  deltaTimeComparedTo,
  timeZone,
  stationCol,
  writecsv = FALSE,
  outDir,
  metadataHierarchyDelimitor = "|",
  metadataSpeciesTag,
  additionalMetadataTags,
  removeDuplicateRecords = TRUE,
  returnFileNamesMissingTags = FALSE,
  eventSummaryColumn,
  eventSummaryFunction,
  video
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recordTable_+3A_indir">inDir</code></td>
<td>
<p>character. Directory containing station directories. It must
either contain images in species subdirectories (e.g.
inDir/StationA/SpeciesA) or images with species metadata tags (without
species directories, e.g. inDir/StationA).</p>
</td></tr>
<tr><td><code id="recordTable_+3A_idfrom">IDfrom</code></td>
<td>
<p>character. Read species ID from image metadata (&quot;metadata&quot;) of
from species directory names (&quot;directory&quot;)?</p>
</td></tr>
<tr><td><code id="recordTable_+3A_cameraid">cameraID</code></td>
<td>
<p>character. Where should the function look for camera IDs:
'filename', 'directory'. 'filename' requires images renamed with
<code><a href="#topic+imageRename">imageRename</a></code>. 'directory' requires a camera subdirectory within
station directories (station/camera/species). Can be missing.</p>
</td></tr>
<tr><td><code id="recordTable_+3A_camerasindependent">camerasIndependent</code></td>
<td>
<p>logical. If <code>TRUE</code>, species records are
considered to be independent between cameras at a station.</p>
</td></tr>
<tr><td><code id="recordTable_+3A_exclude">exclude</code></td>
<td>
<p>character. Vector of species names to be excluded from the
record table</p>
</td></tr>
<tr><td><code id="recordTable_+3A_mindeltatime">minDeltaTime</code></td>
<td>
<p>integer. Time difference between records of the same
species at the same station to be considered independent (in minutes)</p>
</td></tr>
<tr><td><code id="recordTable_+3A_deltatimecomparedto">deltaTimeComparedTo</code></td>
<td>
<p>character. For two records to be considered
independent, must the second one be at least <code>minDeltaTime</code> minutes
after the last independent record of the same species
(<code>"lastIndependentRecord"</code>), or <code>minDeltaTime</code> minutes after the
last record (<code>"lastRecord"</code>)?</p>
</td></tr>
<tr><td><code id="recordTable_+3A_timezone">timeZone</code></td>
<td>
<p>character. Must be a value returned by
<code><a href="base.html#topic+timezones">OlsonNames</a></code></p>
</td></tr>
<tr><td><code id="recordTable_+3A_stationcol">stationCol</code></td>
<td>
<p>character. Name of the camera trap station column.
Assuming &quot;Station&quot; if undefined.</p>
</td></tr>
<tr><td><code id="recordTable_+3A_writecsv">writecsv</code></td>
<td>
<p>logical. Should the record table be saved as a .csv?</p>
</td></tr>
<tr><td><code id="recordTable_+3A_outdir">outDir</code></td>
<td>
<p>character. Directory to save csv to. If NULL and
<code>writecsv = TRUE</code>, recordTable will be written to <code>inDir</code>.</p>
</td></tr>
<tr><td><code id="recordTable_+3A_metadatahierarchydelimitor">metadataHierarchyDelimitor</code></td>
<td>
<p>character. The character delimiting
hierarchy levels in image metadata tags in field &quot;HierarchicalSubject&quot;.
Either &quot;|&quot; or &quot;:&quot;.</p>
</td></tr>
<tr><td><code id="recordTable_+3A_metadataspeciestag">metadataSpeciesTag</code></td>
<td>
<p>character. In custom image metadata, the species
ID tag name.</p>
</td></tr>
<tr><td><code id="recordTable_+3A_additionalmetadatatags">additionalMetadataTags</code></td>
<td>
<p>character. Additional camera model-specific
metadata tags to be extracted. (If possible specify tag groups as returned
by <code><a href="#topic+exifTagNames">exifTagNames</a></code>)</p>
</td></tr>
<tr><td><code id="recordTable_+3A_removeduplicaterecords">removeDuplicateRecords</code></td>
<td>
<p>logical. If there are several records of the
same species at the same station (also same camera if cameraID is defined)
at exactly the same time, show only one?</p>
</td></tr>
<tr><td><code id="recordTable_+3A_returnfilenamesmissingtags">returnFileNamesMissingTags</code></td>
<td>
<p>logical. If species are assigned with
metadata and images are not tagged, return a few file names of these images
as a message?</p>
</td></tr>
<tr><td><code id="recordTable_+3A_eventsummarycolumn">eventSummaryColumn</code></td>
<td>
<p>character. A column in the record table (e.g. from
a metadata tag) by to summarise non-independent records (those within
<code>minDeltaTime</code> of a given record) with a user-defined function
(<code>eventSummaryFunction</code>)</p>
</td></tr>
<tr><td><code id="recordTable_+3A_eventsummaryfunction">eventSummaryFunction</code></td>
<td>
<p>character. The function by which to summarise
<code>eventSummaryColumn</code> of non-independent records, e.g. &quot;sum&quot;, &quot;max&quot;
(optional)</p>
</td></tr>
<tr><td><code id="recordTable_+3A_video">video</code></td>
<td>
<p>list. Contains information on how to handle video data
(optional). See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can handle a number of different ways of storing images, and
supports species identification by moving images into species directories as
well as metadata tagging. In every case, images need to be stored into
station directories. If images are identified by moving them into species
directories, a camera directory is optional: &quot;Station/Species/XY.JPG&quot; or
&quot;Station/Camera/Species/XY.JPG&quot;. Likewise, if images are identified using
metadata tagging, a camera directory can be used optionally:
&quot;Station/XY.JPG&quot; or &quot;Station/Camera/XY.JPG&quot;.
</p>
<p>If images are identified by metadata tagging, <code>metadataSpeciesTag</code>
specifies the metadata tag group name that contains species identification
tags. <code>metadataHierarchyDelimitor</code> is &quot;|&quot; for images tagged in DigiKam
and images tagged in Adobe Bridge / Lightroom with the default settings. It
is only necessary to change it if the default was changed in these programs.
</p>
<p><code>minDeltaTime</code> is a criterion for temporal independence of species
recorded at the same station. Setting it to 0 will make the function return
all records. Setting it to a higher value will remove records that were
taken less than <code>minDeltaTime</code> minutes after the last record
(<code>deltaTimeComparedTo = "lastRecord"</code>) or the last independent record
(<code>deltaTimeComparedTo = "lastIndependentRecord"</code>).
</p>
<p><code>removeDuplicateRecords</code> determines whether duplicate records
(identical station, species, date/time, (and camera if applicable)) are
all returned (FALSE) or collapsed into a single unique record (TRUE).
</p>
<p><code>camerasIndependent</code> defines if the cameras at a station are to be
considered independent. If <code>TRUE</code>, records of the same species taken by
different cameras are considered independent (e.g. if they face different
trails). Use <code>FALSE</code> if both cameras face each other and possibly
<code>TRUE</code> ).
</p>
<p><code>exclude</code> can be used to exclude &quot;species&quot; directories containing
irrelevant images (e.g. &quot;team&quot;, &quot;blank&quot;, &quot;unidentified&quot;). <code>stationCol</code>
can be set to match the station column name in the camera trap station table
(see <code><a href="#topic+camtraps">camtraps</a></code>).
</p>
<p>Many digital images contain Exif metadata tags such as &quot;AmbientTemperature&quot;
or &quot;MoonPhase&quot; that can be extracted if specified in <code>metadataTags</code>.
Because these are manufacturer-specific and not standardized, function
<code><a href="#topic+exifTagNames">exifTagNames</a></code> provides a vector of all available tag names.
Multiple names can be specified as a character vector as: <code>c(Tag1,
Tag2, ...)</code>. The metadata tags thus extracted may be used as covariates in
modelling species distributions.
</p>
<p><code>eventSummaryColumn</code> and <code>eventSummaryFunction</code> can be used to
extract summary statistics for independent sampling events. For example, you
assigned a &quot;count&quot; tag to your images, indicating the number of individuals
in a picture. In a sequence of pictures taken within 1 minute, most pictures
show one individual, but one image shows two individuals. You tagged the
images accordingly (count = 1 or count = 2) and run <code>recordTable</code>. Set
<code>eventSummaryColumn = "count"</code> and <code>eventSummaryFunction = "max"</code>
to obtain the maximum number of <code>count</code> in all images within
<code>minDeltaTime</code> minutes of a given record. The results is in a new
column, in this example <code>count_max</code>. You can also calculate several
statistics at the same time, by supplying vectors of values, e.g.
<code>eventSummaryColumn = c("count", "count", "camera")</code> and
<code>eventSummaryFunction = c("min", "max", "unique")</code> to get minimum and
maximum count and all unique camera IDs for that event. Note that
<code>eventSummaryColumn</code> and <code>eventSummaryFunction</code> must be of same
length.
</p>
<p>Argument <code>video</code> is a named list with 2 or 4 items. 2 items
(<code>file_formats</code>, <code>dateTimeTag</code>) are always required, and are
sufficent if <code>IDfrom = "directory"</code>. In that case, no digiKam tags will
be returned.  To return digiKam tags, two additional items are required
(<code>db_directory</code>, <code>db_filename</code>). This is essential when using
<code>IDfrom = "metadata"</code>. When using <code>IDfrom = "directory"</code>, it is
optional, but allows to extract metadata tags assigned to videos in digiKam.
This workaround is necessary because digiKam tags are not written into video
metadata, but are only saved in the digiKam database. So in contrast to JPG
images, they can not be extracted with ExifTool. It also requires that
<code>inDir</code> is in your digiKam database.
</p>
<p>The items of argument <code>video</code> are:
</p>

<table>
<tr>
 <td style="text-align: left;"> <code>file_formats</code> </td><td style="text-align: left;"> The video formats to extract (include
"jpg" if you want .JPG image metadata) </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>dateTimeTag</code> </td><td style="text-align: left;"> the
metadata tag to extract date/time from (use <code><a href="#topic+exifTagNames">exifTagNames</a></code> to
find out which tag is suitable) </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>db_directory</code> </td><td style="text-align: left;"> The directory
containing digiKam database (optional if <code>IDfrom = "directory"</code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>db_filename</code> </td><td style="text-align: left;"> The digiKam database file in <code>db_directory</code>
(optional if <code>IDfrom = "directory"</code>) </td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>

<p>See the examples below for for how to specify the argument <code>video</code>.
</p>


<h3>Value</h3>

<p>A data frame containing species records and additional information
about stations, date, time and (optionally) further metadata.
</p>


<h3>Warning </h3>

<p>Custom image metadata must be organised hierarchically
(tag group - tag; e.g. &quot;Species&quot; - &quot;Leopard Cat&quot;). Detailed information on
how to set up and use metadata tags can be found in
<a href="https://CRAN.R-project.org/package=camtrapR/vignettes/camtrapr2.pdf">vignette
2: Species and Individual Identification</a>.
</p>
<p>Custom image metadata tags must be written to the images. The function
cannot read tags from .xmp sidecar files. Make sure you set the preferences
accordingly. In DigiKam, go to Settings/Configure digiKam/Metadata. There,
make sure &quot;Write to sidecar files&quot; is unchecked.
</p>
<p>Please note the section about defining argument <code>timeZone</code> in the
vignette on data extraction (accessible via
<code>vignette("DataExtraction")</code> or online
(<a href="https://cran.r-project.org/package=camtrapR/vignettes/camtrapr3.pdf">https://cran.r-project.org/package=camtrapR/vignettes/camtrapr3.pdf</a>)).
</p>


<h3>Note</h3>

<p>The results of a number of other function will depend on the output of
this function (namely on the arguments <code>exclude</code> for excluding species
and <code>minDeltaTime</code>/ <code>deltaTimeComparedTo</code> for temporal
independence):
</p>

<table>
<tr>
 <td style="text-align: left;"> <code><a href="#topic+detectionMaps">detectionMaps</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;"> <code><a href="#topic+detectionHistory">detectionHistory</a></code>
</td>
</tr>
<tr>
 <td style="text-align: left;"> <code><a href="#topic+activityHistogram">activityHistogram</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;"> <code><a href="#topic+activityDensity">activityDensity</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+activityRadial">activityRadial</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;"> <code><a href="#topic+activityOverlap">activityOverlap</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+activityHistogram">activityHistogram</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;"> <code><a href="#topic+surveyReport">surveyReport</a></code> </td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>Phil Harvey's ExifTool <a href="https://exiftool.org/">https://exiftool.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


## Not run:    # the examples take too long to pass CRAN tests


# set directory with camera trap images in station directories
wd_images_ID_species &lt;- system.file("pictures/sample_images_species_dir", 
                                    package = "camtrapR")

if (Sys.which("exiftool") != ""){        # only run these examples if ExifTool is available


rec_table1 &lt;- recordTable(inDir               = wd_images_ID_species,
                       IDfrom                 = "directory",
                       minDeltaTime           = 60,
                       deltaTimeComparedTo    = "lastRecord",
                       writecsv               = FALSE,
                       additionalMetadataTags = c("EXIF:Model", "EXIF:Make")
)
# note argument additionalMetadataTags: it contains tag names as returned by function exifTagNames

rec_table2 &lt;- recordTable(inDir               = wd_images_ID_species,
                       IDfrom                 = "directory",
                       minDeltaTime           = 60,
                       deltaTimeComparedTo    = "lastRecord",
                       exclude                = "UNID",
                       writecsv               = FALSE,
                       timeZone               = "Asia/Kuala_Lumpur",
                       additionalMetadataTags = c("EXIF:Model", "EXIF:Make", "NonExistingTag"),
                       eventSummaryColumn     = "EXIF:Make",
                       eventSummaryFunction   = "unique"
                       )
                       
# note the warning that the last tag in "additionalMetadataTags" ("NonExistingTag") was not found


any(rec_table1$Species == "UNID")    # TRUE
any(rec_table2$Species == "UNID")    # FALSE


# here's how the removeDuplicateRecords argument works

rec_table3a &lt;- recordTable(inDir              = wd_images_ID_species,
                       IDfrom                 = "directory",
                       minDeltaTime           = 0,
                       exclude                = "UNID",
                       timeZone               = "Asia/Kuala_Lumpur",
                       removeDuplicateRecords = FALSE
)

rec_table3b &lt;- recordTable(inDir              = wd_images_ID_species,
                       IDfrom                 = "directory",
                       minDeltaTime           = 0,
                       exclude                = "UNID",
                       timeZone               = "Asia/Kuala_Lumpur",
                       removeDuplicateRecords = TRUE
)


anyDuplicated(rec_table3a[, c("Station", "Species", "DateTimeOriginal")])   # got duplicates
anyDuplicated(rec_table3b[, c("Station", "Species", "DateTimeOriginal")])   # no duplicates

# after removing duplicates, both are identical:
whichAreDuplicated &lt;- which(duplicated(rec_table3a[,c("Station", "Species", "DateTimeOriginal")]))
all(rec_table3a[-whichAreDuplicated,] == rec_table3b)


### extracting species IDs from metadata

wd_images_ID_species_tagged &lt;- system.file("pictures/sample_images_species_tag", 
                                           package = "camtrapR")

rec_table4 &lt;- recordTable(inDir               = wd_images_ID_species_tagged,
                       IDfrom                 = "metadata",
                       metadataSpeciesTag     = "Species",
                       exclude                = "unidentified")


###  Including videos
# sample videos are not included in package

# with videos, IDfrom = "directory", not extracting digiKam metadata

rec_table4 &lt;- recordTable(inDir  = wd_images_ID_species,
                          IDfrom = "directory",
                          video  = list(file_formats = c("jpg", "mp4"),
                                        dateTimeTag  = "QuickTime:CreateDate")
)

# with videos, IDfrom = "metadata", extracting digiKam metadata

rec_table5 &lt;- recordTable(inDir  = wd_images_ID_species,
                          IDfrom = "metadata",
                          metadataSpeciesTag = "Species",
                          video  = list(file_formats = c("jpg", "mp4", "avi", "mov"),
                                        dateTimeTag  = "QuickTime:CreateDate",
                                        db_directory = "C:/Users/YourName/Pictures",
                                        db_filename = "digikam4.db")
)

} else {  
# show function output if ExifTool is not available
message("ExifTool is not available. Cannot test function. Loading recordTableSample instead")
data(recordTableSample)
}


## End(Not run)

</code></pre>

<hr>
<h2 id='recordTableIndividual'>Generate a single-species record table with individual identification from
camera trap images or videos</h2><span id='topic+recordTableIndividual'></span>

<h3>Description</h3>

<p>The function generates a single-species record table containing individual
IDs, e.g. for (spatial) capture-recapture analyses. It prepares input for
the function <code><a href="#topic+spatialDetectionHistory">spatialDetectionHistory</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recordTableIndividual(
  inDir,
  hasStationFolders,
  IDfrom,
  cameraID,
  camerasIndependent,
  minDeltaTime = 0,
  deltaTimeComparedTo,
  timeZone,
  stationCol,
  writecsv = FALSE,
  outDir,
  metadataHierarchyDelimitor = "|",
  metadataIDTag,
  additionalMetadataTags,
  removeDuplicateRecords = TRUE,
  returnFileNamesMissingTags = FALSE,
  eventSummaryColumn,
  eventSummaryFunction,
  video
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recordTableIndividual_+3A_indir">inDir</code></td>
<td>
<p>character. Directory containing images of individuals. Must end
with species name (e.g. &quot;.../speciesImages/Clouded Leopard&quot;)</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_hasstationfolders">hasStationFolders</code></td>
<td>
<p>logical. Does <code>inDir</code> have station
subdirectories? If <code>TRUE</code>, station IDs will be taken from directory
names. If <code>FALSE</code>, they will be taken from image filenames (requires
images renamed with <code><a href="#topic+imageRename">imageRename</a></code>).</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_idfrom">IDfrom</code></td>
<td>
<p>character. Read individual ID from image metadata (&quot;metadata&quot;)
of from directory names (&quot;directory&quot;)?</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_cameraid">cameraID</code></td>
<td>
<p>character. Should the function look for camera IDs in the
image file names? If so, set to 'filename'. Requires images renamed with
<code><a href="#topic+imageRename">imageRename</a></code>. If missing, no camera ID will be assigned and it
will be assumed there was 1 camera only per station.</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_camerasindependent">camerasIndependent</code></td>
<td>
<p>logical. If <code>TRUE</code>, cameras at a station are
assumed to record individuals independently. If <code>FALSE</code>, cameras are
assumed to be non-independent (e.g. in pairs). Takes effect only if there
was more than 1 camera per station and cameraID = &quot;filename&quot;.</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_mindeltatime">minDeltaTime</code></td>
<td>
<p>numeric. time difference between observation of the same
individual at the same station/camera to be considered independent (in
minutes)</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_deltatimecomparedto">deltaTimeComparedTo</code></td>
<td>
<p>character. For two records to be considered
independent, must the second one be at least <code>minDeltaTime</code> minutes
after the last independent record of the same individual
(<code>"lastIndependentRecord"</code>), or <code>minDeltaTime</code> minutes after the
last record (<code>"lastRecord"</code>)?</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_timezone">timeZone</code></td>
<td>
<p>character. Must be a value returned by
<code><a href="base.html#topic+timezones">OlsonNames</a></code></p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_stationcol">stationCol</code></td>
<td>
<p>character. Name of the camera trap station column in the
output table.</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_writecsv">writecsv</code></td>
<td>
<p>logical. Should the individual record table be saved as a
.csv file?</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_outdir">outDir</code></td>
<td>
<p>character. Directory to save csv file to. If NULL and
<code>writecsv = TRUE</code>, the output csv will be written to <code>inDir</code>.</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_metadatahierarchydelimitor">metadataHierarchyDelimitor</code></td>
<td>
<p>character. The character delimiting
hierarchy levels in image metadata tags in field &quot;HierarchicalSubject&quot;.
Either &quot;|&quot; or &quot;:&quot;.</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_metadataidtag">metadataIDTag</code></td>
<td>
<p>character. In custom image metadata, the individual ID
tag name.</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_additionalmetadatatags">additionalMetadataTags</code></td>
<td>
<p>character. additional camera model-specific
metadata tags to be extracted. (If possible specify tag groups as returned
by <code><a href="#topic+exifTagNames">exifTagNames</a></code>)</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_removeduplicaterecords">removeDuplicateRecords</code></td>
<td>
<p>logical. If there are several records of the
same individual at the same station (also same camera if cameraID is
defined) at exactly the same time, show only one?</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_returnfilenamesmissingtags">returnFileNamesMissingTags</code></td>
<td>
<p>logical. If species are assigned with
metadata and images are not tagged, return a few file names of these images
as a message?</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_eventsummarycolumn">eventSummaryColumn</code></td>
<td>
<p>character. A column in the record table (e.g. from
a metadata tag) by to summarise non-independent records (those within
<code>minDeltaTime</code> of a given record) with a user-defined function
(<code>eventSummaryFunction</code>)</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_eventsummaryfunction">eventSummaryFunction</code></td>
<td>
<p>character. The function by which to summarise
<code>eventSummaryColumn</code> of non-independent records, e.g. &quot;sum&quot;, &quot;max&quot;
(optional)</p>
</td></tr>
<tr><td><code id="recordTableIndividual_+3A_video">video</code></td>
<td>
<p>list. Contains information on how to handle video data
(optional). See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can handle a number of different ways of storing images and
videos. In every case, images need to be stored in a species directory first
(e.g. using function <code><a href="#topic+getSpeciesImages">getSpeciesImages</a></code>). Station subdirectories
are optional. Camera subdirectories are not supported. This directory
structure can be created easily with function
<code><a href="#topic+getSpeciesImages">getSpeciesImages</a></code>.
</p>
<p>As with species identification, individuals can be identified in 2 different
ways: by moving images into individual directories
(&quot;Species/Station/Individual/XY.JPG&quot; or &quot;Species/Individual/XY.JPG&quot;) or by
metadata tagging (without the need for individual directories:
&quot;Species/XY.JPG&quot; or &quot;Species/Station/XY.JPG&quot;).
</p>
<p><code>minDeltaTime</code> is a criterion for temporal independence of records of
an individual at the same station/location. Setting it to 0 will make the
function return all records. <code>camerasIndependent</code> defines if the
cameras at a station are to be considered independent (e.g. <code>FALSE</code> if
both cameras face each other and possibly <code>TRUE</code> if they face different
trails). <code>stationCol</code> is the station column name to be used in the
resulting table. Station IDs are read from the station directory names if
<code>hasStationFolders = TRUE</code>. Otherwise, the function will try to extract
station IDs from the image filenames (requires images renamed with
<code><a href="#topic+imageRename">imageRename</a></code>.
</p>
<p>If individual IDs were assigned with image metadata tags,
<code>metadataIDTag</code> must be set to the name of the metadata tag group used
for individual identification. <code>metadataHierarchyDelimitor</code> is &quot;|&quot; for
images tagged in DigiKam and images tagged in Adobe Bridge/ Lightroom with
the default settings. Manufacturer-specific Exif metadata tags such as
&quot;AmbientTemperature&quot; or &quot;MoonPhase&quot; can be extracted if specified in
<code>additionalMetadataTags</code>. Multiple names can be specified as a
character vector as: <code>c(Tag1, Tag2, ...)</code>. Because they are not
standardized, function <code><a href="#topic+exifTagNames">exifTagNames</a></code> provides a vector of all
available tag names. The metadata tags thus extracted may be used as
individual covariates in spatial capture-recapture models.
</p>
<p><code>eventSummaryColumn</code> and <code>eventSummaryFunction</code> can be used to
extract summary statistics for independent sampling events. For example, you
assigned a &quot;count&quot; tag to your images, indicating the number of individuals
in a picture. In a sequence of pictures taken within 1 minute, most pictures
show one individual, but one image shows two individuals. You tagged the
images accordingly (count = 1 or count = 2) and run <code>recordTable</code>. Set
<code>eventSummaryColumn = "count"</code> and <code>eventSummaryFunction = "max"</code>
to obtain the maximum number of <code>count</code> in all images within
<code>minDeltaTime</code> minutes of a given record. The results is in a new
column, in this example <code>count_max</code>. You can also calculate several
statistics at the same time, by supplying vectors of values, e.g.
<code>eventSummaryColumn = c("count", "count", "camera")</code> and
<code>eventSummaryFunction = c("min", "max", "unique")</code> to get minimum and
maximum count and all unique camera IDs for that event. Note that
<code>eventSummaryColumn</code> and <code>eventSummaryFunction</code> must be of same
length.
</p>
<p>Argument <code>video</code> is analogous to <code><a href="#topic+recordTable">recordTable</a></code>, a named
list with 2 or 4 items. 2 items (<code>file_formats</code>, <code>dateTimeTag</code>)
are always required, and are sufficent if <code>IDfrom = "directory"</code>. In
that case, no digiKam tags will be returned.  To return digiKam tags, two
additional items are required (<code>db_directory</code>, <code>db_filename</code>).
This is essential when using <code>IDfrom = "metadata"</code>. When using
<code>IDfrom = "directory"</code>, it is optional, but allows to extract metadata
tags assigned to videos in digiKam. This workaround is necessary because
digiKam tags are not written into video metadata, but are only saved in the
digiKam database. So in contrast to JPG images, they can not be extracted
with ExifTool. It also requires that <code>inDir</code> is in your digiKam
database.
</p>
<p>The items of argument <code>video</code> are:
</p>

<table>
<tr>
 <td style="text-align: left;"> <code>file_formats</code> </td><td style="text-align: left;"> The video formats to extract (include
"jpg" if you want .JPG image metadata) </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>dateTimeTag</code> </td><td style="text-align: left;"> the
metadata tag to extract date/time from (use <code><a href="#topic+exifTagNames">exifTagNames</a></code> to
find out which tag is suitable) </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>db_directory</code> </td><td style="text-align: left;"> The directory
containing digiKam database (optional if <code>IDfrom = "directory"</code>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>db_filename</code> </td><td style="text-align: left;"> The digiKam database file in <code>db_directory</code>
(optional if <code>IDfrom = "directory"</code>) </td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>

<p>See the example below for for how to specify the argument <code>video</code>.
</p>


<h3>Value</h3>

<p>A data frame containing species records with individual IDs and
additional information about stations, date, time and (optionally) further
metadata.
</p>


<h3>Warning </h3>

<p>Be sure to read the section on individual identification
in the package vignette
(<a href="https://CRAN.R-project.org/package=camtrapR/vignettes/camtrapr2.pdf">https://CRAN.R-project.org/package=camtrapR/vignettes/camtrapr2.pdf</a>).
</p>
<p>Af you use image metadata tags for identification, the tags must be written
to the image metadata. The function cannot read tags from .xmp sidecar
files. Make sure you set the preferences of your image management software
accordingly. In DigiKam, go to Settings/Configure digiKam/Metadata. There,
make sure &quot;Write to sidecar files&quot; is unchecked.
</p>
<p>Please note the section about defining argument <code>timeZone</code> in the
vignette on data extraction (accessible via
<code>vignette("DataExtraction")</code> or online
(<a href="https://cran.r-project.org/package=camtrapR/vignettes/camtrapr3.pdf">https://cran.r-project.org/package=camtrapR/vignettes/camtrapr3.pdf</a>)).
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p>Phil Harvey's ExifTool <a href="https://exiftool.org/">https://exiftool.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run:    # the examples run too long to pass CRAN tests

 wd_images_ID_individual &lt;- system.file("pictures/sample_images_indiv_tag/LeopardCat", 
                                        package = "camtrapR")
 # missing space in species = "LeopardCat" is because of CRAN package policies
 # note argument additionalMetadataTags: contains tag names as returned by function exifTagNames

 if (Sys.which("exiftool") != ""){        # only run these examples if ExifTool is available

 rec_table_pbe &lt;- recordTableIndividual(inDir                  = wd_images_ID_individual,
                                        minDeltaTime           = 60,
                                        deltaTimeComparedTo    = "lastRecord",
                                        hasStationFolders      = FALSE,
                                        IDfrom                 = "metadata",
                                        camerasIndependent     = FALSE,
                                        writecsv               = FALSE,
                                        metadataIDTag          = "individual",
                                        additionalMetadataTags = c("EXIF:Model", "EXIF:Make"),
                                        timeZone               = "Asia/Kuala_Lumpur"
 )
 
 
 # extracting some example summary stats too 
 # a nonsensical example, get all unique cameras with which the event was photographed
 
  rec_table_pbe2 &lt;- recordTableIndividual(inDir                = wd_images_ID_individual,
                                        minDeltaTime           = 60,
                                        deltaTimeComparedTo    = "lastRecord",
                                        hasStationFolders      = FALSE,
                                        IDfrom                 = "metadata",
                                        camerasIndependent     = FALSE,
                                        writecsv               = FALSE,
                                        metadataIDTag          = "individual",
                                        additionalMetadataTags = c("EXIF:Model", "EXIF:Make"),
                                        timeZone               = "Asia/Kuala_Lumpur",
                                        eventSummaryColumn     = "EXIF:Make",
                                        eventSummaryFunction   = "unique"
 )
 
 ### Video example (the sample data don't contain a video, this is hypothetical)
 # with JPG, video mp4, avi, mov, ID = metadata
 
rec_table_ind_video &lt;- recordTableIndividual(inDir = wd_images_ID_individual,
                          hasStationFolder  = FALSE,
                          IDfrom            = "metadata", 
                          metadataIDTag     = "individual",
                          video = list(file_formats = c("jpg", "mp4", "avi", "mov"),
                                       dateTimeTag = "QuickTime:CreateDate",
                                       db_directory = "C:/Users/YourName/Pictures",
                                       db_filename = "digikam4.db")
)

  
} else {  
# show function output if ExifTool is not available
message("ExifTool is not available. Cannot test function. Loading recordTableSample instead")
data(recordTableSample)
}

## End(Not run)


</code></pre>

<hr>
<h2 id='recordTableIndividualSample'>Sample single-species record table with custom metadata from camera trap images</h2><span id='topic+recordTableIndividualSample'></span>

<h3>Description</h3>

<p>Sample single-species record table with individual IDs from the tagged sample images in the package. Generated with function <code><a href="#topic+recordTableIndividual">recordTableIndividual</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(recordTableIndividualSample)
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 rows and 17 variables</p>


<h3>Details</h3>

<p>The variables are as follows:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Station</code> </td><td style="text-align: left;"> Camera trap station ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Species</code> </td><td style="text-align: left;"> Species ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Individual</code> </td><td style="text-align: left;"> Individual ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DateTimeOriginal</code> </td><td style="text-align: left;"> Date and time as extracted from image </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Date</code> </td><td style="text-align: left;"> record date </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Time</code> </td><td style="text-align: left;"> record time of day </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.secs</code> </td><td style="text-align: left;"> time difference to first species record at a station (seconds) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.mins</code> </td><td style="text-align: left;"> time difference to first species record at a station (minutes) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.hours</code> </td><td style="text-align: left;"> time difference to first species record at a station (hours) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.days</code> </td><td style="text-align: left;"> time difference to first species record at a station (days) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Directory</code> </td><td style="text-align: left;"> Image directory </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>FileName</code> </td><td style="text-align: left;"> image filename </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>HierarchicalSubject</code> </td><td style="text-align: left;"> content of the HierarchicalSubject image metadata tag </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Model</code> </td><td style="text-align: left;"> camera model extracted from image metadata </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Make</code> </td><td style="text-align: left;"> camera make extracted from image metadata </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>metadata_Species</code> </td><td style="text-align: left;"> content of custom image metadata tag "Species" (see HierarchicalSubject) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>metadata_individual</code> </td><td style="text-align: left;"> content of custom image metadata tag "individual" (see HierarchicalSubject) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<hr>
<h2 id='recordTableIndividualSampleMultiSeason'>Sample single-species multi-season record table with custom metadata from camera trap images</h2><span id='topic+recordTableIndividualSampleMultiSeason'></span>

<h3>Description</h3>

<p>Sample single-species multi-season record table with individual IDs from the tagged sample images in the package. Generated with function <code><a href="#topic+recordTableIndividual">recordTableIndividual</a></code>, then duplicated to simulate a second year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(recordTableIndividualSampleMultiSeason)
</code></pre>


<h3>Format</h3>

<p>A data frame with 31 rows and 17 variables</p>


<h3>Details</h3>

<p>The variables are as follows:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Station</code> </td><td style="text-align: left;"> Camera trap station ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Species</code> </td><td style="text-align: left;"> Species ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Individual</code> </td><td style="text-align: left;"> Individual ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DateTimeOriginal</code> </td><td style="text-align: left;"> Date and time as extracted from image </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Date</code> </td><td style="text-align: left;"> record date </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Time</code> </td><td style="text-align: left;"> record time of day </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.secs</code> </td><td style="text-align: left;"> time difference to first species record at a station (seconds) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.mins</code> </td><td style="text-align: left;"> time difference to first species record at a station (minutes) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.hours</code> </td><td style="text-align: left;"> time difference to first species record at a station (hours) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.days</code> </td><td style="text-align: left;"> time difference to first species record at a station (days) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Directory</code> </td><td style="text-align: left;"> Image directory </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>FileName</code> </td><td style="text-align: left;"> image filename </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>HierarchicalSubject</code> </td><td style="text-align: left;"> content of the HierarchicalSubject image metadata tag </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Model</code> </td><td style="text-align: left;"> camera model extracted from image metadata </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Make</code> </td><td style="text-align: left;"> camera make extracted from image metadata </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>metadata_Species</code> </td><td style="text-align: left;"> content of custom image metadata tag "Species" (see HierarchicalSubject) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>metadata_individual</code> </td><td style="text-align: left;"> content of custom image metadata tag "individual" (see HierarchicalSubject) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># example data were created as follows:
data(recordTableIndividualSample)

recordTableIndividualSample_season2 &lt;- recordTableIndividualSample[1:10, ]
recordTableIndividualSample_season2$DateTimeOriginal &lt;- gsub("2009", "2010",
    recordTableIndividualSample_season2$DateTimeOriginal)
recordTableIndividualSampleMultiSeason &lt;- rbind(recordTableIndividualSample,
    recordTableIndividualSample_season2)
</code></pre>

<hr>
<h2 id='recordTableSample'>Sample species record table from camera trap images</h2><span id='topic+recordTableSample'></span>

<h3>Description</h3>

<p>Sample species record table from camera trap images generated from the sample images in the package with the function <code><a href="#topic+recordTable">recordTable</a></code> .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(recordTableSample)
</code></pre>


<h3>Format</h3>

<p>A data frame with 39 rows and 11 variables</p>


<h3>Details</h3>

<p>The variables are as follows:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Station</code> </td><td style="text-align: left;"> Camera trap station ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Species</code> </td><td style="text-align: left;"> Species ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DateTimeOriginal</code> </td><td style="text-align: left;"> Date and time as extracted from image </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Date</code> </td><td style="text-align: left;"> record date </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Time</code> </td><td style="text-align: left;"> record time of day </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.secs</code> </td><td style="text-align: left;"> time difference to first species record at a station (seconds) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.mins</code> </td><td style="text-align: left;"> time difference to first species record at a station (minutes) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.hours</code> </td><td style="text-align: left;"> time difference to first species record at a station (hours) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.days</code> </td><td style="text-align: left;"> time difference to first species record at a station (days) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Directory</code> </td><td style="text-align: left;"> Image directory </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>FileName</code> </td><td style="text-align: left;"> image filename </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<hr>
<h2 id='recordTableSampleMultiSeason'>Sample multi-season species record table from camera trap images</h2><span id='topic+recordTableSampleMultiSeason'></span>

<h3>Description</h3>

<p>Sample multi-season species record table from camera trap images generated from the sample images in the package with the function <code><a href="#topic+recordTable">recordTable</a></code>. Season 2009 is the same as <code><a href="#topic+recordTableSample">recordTableSample</a></code>, season 2010 was simulated by adding 1 year to these records.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(recordTableSampleMultiSeason)
</code></pre>


<h3>Format</h3>

<p>A data frame with 78 rows and 11 variables</p>


<h3>Details</h3>

<p>The variables are as follows:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Station</code> </td><td style="text-align: left;"> Camera trap station ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Species</code> </td><td style="text-align: left;"> Species ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DateTimeOriginal</code> </td><td style="text-align: left;"> Date and time as extracted from image </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Date</code> </td><td style="text-align: left;"> record date </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Time</code> </td><td style="text-align: left;"> record time of day </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.secs</code> </td><td style="text-align: left;"> time difference to first species record at a station (seconds) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.mins</code> </td><td style="text-align: left;"> time difference to first species record at a station (minutes) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.hours</code> </td><td style="text-align: left;"> time difference to first species record at a station (hours) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>delta.time.days</code> </td><td style="text-align: left;"> time difference to first species record at a station (days) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Directory</code> </td><td style="text-align: left;"> Image directory </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>FileName</code> </td><td style="text-align: left;"> image filename </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># data were created with the following code:

data(recordTableSample)
recordTableSample_season2 &lt;- recordTableSample

# substitute 2009 with 2010
recordTableSample_season2$DateTimeOriginal &lt;- gsub("2009", "2010",
    recordTableSample_season2$DateTimeOriginal)
# combine with season 2009
recordTableSampleMultiSeason &lt;- rbind(recordTableSample, recordTableSample_season2)
</code></pre>

<hr>
<h2 id='spatialDetectionHistory'>Generate a <code>capthist</code> object for spatial capture-recapture analyses
from camera-trapping data</h2><span id='topic+spatialDetectionHistory'></span>

<h3>Description</h3>

<p>This function generates spatial detection histories of individuals of a
species for spatial capture-recapture analyses with package
<code><a href="secr.html#topic+secr-package">secr</a></code>. Data are stored in a
<code><a href="secr.html#topic+capthist">capthist</a></code> object. The <code><a href="secr.html#topic+capthist">capthist</a></code> object
contains detection histories, camera-trap station location and possibly
individual and station-level covariates. Detection histories can have
adjustable occasion length and occasion start time (as in the function
<code><a href="#topic+detectionHistory">detectionHistory</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatialDetectionHistory(
  recordTableIndividual,
  species,
  camOp,
  CTtable,
  output = c("binary", "count"),
  stationCol = "Station",
  speciesCol = "Species",
  sessionCol,
  Xcol,
  Ycol,
  stationCovariateCols,
  individualCol,
  individualCovariateCols,
  recordDateTimeCol = "DateTimeOriginal",
  recordDateTimeFormat = "ymd HMS",
  occasionLength,
  minActiveDaysPerOccasion,
  occasionStartTime = "deprecated",
  maxNumberDays,
  day1,
  buffer,
  includeEffort = TRUE,
  scaleEffort = FALSE,
  binaryEffort = FALSE,
  timeZone,
  makeRMarkInput
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatialDetectionHistory_+3A_recordtableindividual">recordTableIndividual</code></td>
<td>
<p>data.frame. the record table with individual
IDs created by <code><a href="#topic+recordTableIndividual">recordTableIndividual</a></code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_species">species</code></td>
<td>
<p>character. the species for which to compute the detection
history</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_camop">camOp</code></td>
<td>
<p>The camera operability matrix as created by
<code><a href="#topic+cameraOperation">cameraOperation</a></code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_cttable">CTtable</code></td>
<td>
<p>data.frame. contains station IDs and coordinates. Same as
used in <code><a href="#topic+cameraOperation">cameraOperation</a></code>.</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_output">output</code></td>
<td>
<p>character. Return individual counts (&quot;count&quot;) or binary
observations (&quot;binary&quot;)?</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_stationcol">stationCol</code></td>
<td>
<p>character. name of the column specifying Station ID in
<code>recordTableIndividual</code> and <code>CTtable</code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. name of the column specifying species in
<code>recordTableIndividual</code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_sessioncol">sessionCol</code></td>
<td>
<p>character. name of the column specifying session IDs,
either in <code>recordTableIndividual</code> or in <code>CTtable</code>. See 'Details'
for more information. Session ID values must be a sequence of integer
numbers beginning with 1 (i.e., 1,2,3,...).</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_xcol">Xcol</code></td>
<td>
<p>character. name of the column specifying x coordinates in
<code>CTtable</code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_ycol">Ycol</code></td>
<td>
<p>character. name of the column specifying y coordinates in
<code>CTtable</code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_stationcovariatecols">stationCovariateCols</code></td>
<td>
<p>character. name of the column(s) specifying
station-level covariates in <code>CTtable</code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_individualcol">individualCol</code></td>
<td>
<p>character. name of the column specifying individual IDs
in <code>recordTableIndividual</code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_individualcovariatecols">individualCovariateCols</code></td>
<td>
<p>character. name of the column(s) specifying
individual covariates in <code>recordTableIndividual</code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_recorddatetimecol">recordDateTimeCol</code></td>
<td>
<p>character. name of the column specifying date and
time in <code>recordTableIndividual</code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_recorddatetimeformat">recordDateTimeFormat</code></td>
<td>
<p>format of column <code>recordDateTimeCol</code> in
<code>recordTableIndividual</code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_occasionlength">occasionLength</code></td>
<td>
<p>integer. occasion length in days</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_minactivedaysperoccasion">minActiveDaysPerOccasion</code></td>
<td>
<p>integer. minimum number of active trap days
for occasions to be included (optional)</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_occasionstarttime">occasionStartTime</code></td>
<td>
<p>(DEPRECATED) integer. time of day (the full hour)
at which to begin occasions. Please use argument <code>occasionStartTime</code> in
<code><a href="#topic+cameraOperation">cameraOperation</a></code> instead.</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_maxnumberdays">maxNumberDays</code></td>
<td>
<p>integer. maximum number of trap days per station
(optional)</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_day1">day1</code></td>
<td>
<p>character. When should occasions begin: station setup date
(&quot;station&quot;), first day of survey (&quot;survey&quot;), a specific date (e.g.
&quot;2015-12-31&quot;)?</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_buffer">buffer</code></td>
<td>
<p>integer. Makes the first occasion begin a number of days after
station setup. (optional)</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_includeeffort">includeEffort</code></td>
<td>
<p>logical. Include trapping effort (number of active
camera trap days per station and occasion) as usage in
<code><a href="secr.html#topic+capthist">capthist</a></code> object?</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_scaleeffort">scaleEffort</code></td>
<td>
<p>logical. scale and center effort matrix to mean = 0 and
sd = 1? Currently not used. Must be FALSE.</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_binaryeffort">binaryEffort</code></td>
<td>
<p>logical. Should effort be binary (1 if &gt;1 active day per
occasion, 0 otherwise)?</p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_timezone">timeZone</code></td>
<td>
<p>character. Must be a value returned by
<code><a href="base.html#topic+timezones">OlsonNames</a></code></p>
</td></tr>
<tr><td><code id="spatialDetectionHistory_+3A_makermarkinput">makeRMarkInput</code></td>
<td>
<p>logical. If <code>FALSE</code>, output will be a data frame
for RMark. If <code>FALSE</code> or not specified, a secr
<code><a href="secr.html#topic+capthist">capthist</a></code> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates a <code><a href="secr.html#topic+capthist">capthist</a></code> object by combining
three different objects: 1) a record table of identified individuals of a
species, 2) a camera trap station table with station coordinates and 3) a
camera operation matrix computed with <code><a href="#topic+cameraOperation">cameraOperation</a></code>. The
record table must contain a column with individual IDs and optionally
individual covariates. The camera trap station table must contain station
coordinates and optionally station-level covariates. The camera operation
matrix provides the dates stations were active or not and the number of
active stations.
</p>
<p><code>day1</code> defines if each stations detection history will begin on that
station's setup day (<code>day1 = "station"</code>) or if all station's detection
histories have a common origin (the day the first station was set up if
<code>day1 = "survey"</code> or a fixed date if, e.g. <code>day1 = "2015-12-31"</code>).
</p>
<p><code>includeEffort</code> controls whether an effort matrix is computed or not.
If TRUE, effort will be used for object <code><a href="secr.html#topic+usage">usage</a></code>
information in a <code><a href="secr.html#topic+traps">traps</a></code>. <code>binaryEffort</code> makes the
effort information binary. <code>scaleEffort</code> is currently not used and must
be set to FALSE. The reason is that <code><a href="secr.html#topic+usage">usage</a></code> can only be
either binary, or nonnegative real values, whereas scaling effort would
return negative values.
</p>
<p>The number of days that are aggregated is controlled by
<code>occasionLength</code>. <code>occasionStartTime</code> will be removed from the
function. It has moved to <code><a href="#topic+cameraOperation">cameraOperation</a></code>, to ensure daily
effort is computed correctly and takes the occasion start time into
account.
another hour than midnight (the default). This may be relevant for nocturnal
animals, in which 1 whole night would be considered an occasion.
</p>
<p>Output can be returned as individual counts per occasion (<code>output =
"count"</code>) or as binary observation (<code>output = "binary"</code>).
</p>
<p>Argument <code>sessionCol</code> can be used to a create multi-session
<code><a href="secr.html#topic+capthist">capthist</a></code> object. There are two different ways in which
the argument is interpreted. It depends on whether a column with the name
you specify in argument <code>sessionCol</code> exists in
<code>recordTableIndividual</code> or in <code>CTtable</code>. If <code>sessionCol</code> is
found in <code>recordTableIndividual</code>, the records will be assigned to the
specified sessions, and it will be assumed that all camera trap station were
used in all sessions. Alternatively, if <code>sessionCol</code> is found
in<code>CTtable</code>, it will be assumed that only a subset of stations was used
in each session, and the records will be assigned automatically (using the
station IDs to identify which session they belong into). In both cases,
session information must be provided as a sequence of integer numbers
beginnign with 1, i.e., you provide the session number directly in
<code>sessionCol</code>. See <code><a href="secr.html#topic+session">session</a></code> for more information
about sessions in <span class="pkg">secr</span>.
</p>
<p><code><a href="secr.html#topic+capthist">capthist</a></code> objects (as created by
<code><a href="#topic+spatialDetectionHistory">spatialDetectionHistory</a></code> for spatial capture-recapture
analyses) expect the units of coordinates (<code>Xcol</code> and <code>col</code> in
<code>CTtable</code>) to be meters. Therefore, please use a suitable coordinate
system (e.g. UTM).
</p>
<p><code>recordDateTimeFormat</code> defaults to the &quot;YYYY-MM-DD HH:MM:SS&quot;
convention, e.g. &quot;2014-09-30 22:59:59&quot;. <code>recordDateTimeFormat</code> can be
interpreted either by base-R via <code><a href="base.html#topic+strptime">strptime</a></code> or in
<span class="pkg">lubridate</span> via <code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> (argument
&quot;orders&quot;). <span class="pkg">lubridate</span> will be used if there are no &quot;%&quot; characters in
<code>recordDateTimeFormat</code>.
</p>
<p>For &quot;YYYY-MM-DD HH:MM:SS&quot;, <code>recordDateTimeFormat</code> would be either
&quot;%Y-%m-%d %H:%M:%S&quot; or &quot;ymd HMS&quot;. For details on how to specify date
and time formats in R see <code><a href="base.html#topic+strptime">strptime</a></code> or
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code>.
</p>


<h3>Value</h3>

<p>Output depends on argument <code>makeRMarkInput</code>:
</p>
<table>
<tr><td><code>list("makeRMarkInput = FALSE")</code></td>
<td>
<p>A <code><a href="secr.html#topic+capthist">capthist</a></code> object</p>
</td></tr>
<tr><td><code>list("makeRMarkInput = TRUE")</code></td>
<td>
<p>A data frame for use in RMark</p>
</td></tr>
</table>


<h3>Warning </h3>

<p>Please note the section about defining argument
<code>timeZone</code> in the vignette on data extraction (accessible via
<code>vignette("DataExtraction")</code> or online
(<a href="https://cran.r-project.org/package=camtrapR/vignettes/camtrapr3.pdf">https://cran.r-project.org/package=camtrapR/vignettes/camtrapr3.pdf</a>)).
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>See Also</h3>

<p><span class="pkg">secr</span> <span class="pkg">RMark</span>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(recordTableIndividualSample)
data(camtraps)

# create camera operation matrix (with problems/malfunction)
camop_problem &lt;- cameraOperation(CTtable      = camtraps,
                                 stationCol   = "Station",
                                 setupCol     = "Setup_date",
                                 retrievalCol = "Retrieval_date",
                                 writecsv     = FALSE,
                                 hasProblems  = TRUE,
                                 dateFormat   = "dmy"
)

sdh &lt;- spatialDetectionHistory(recordTableIndividual = recordTableIndividualSample,
                               species               = "LeopardCat",
                               camOp                 = camop_problem,
                               CTtable               = camtraps,
                               output                = "binary",
                               stationCol            = "Station",
                               speciesCol            = "Species",
                               Xcol                  = "utm_x",
                               Ycol                  = "utm_y",
                               individualCol         = "Individual",
                               recordDateTimeCol     = "DateTimeOriginal",
                               recordDateTimeFormat  = "ymd HMS",
                               occasionLength        = 10,
                               day1                  = "survey",
                               includeEffort         = TRUE,
                               timeZone              = "Asia/Kuala_Lumpur"
  )

# missing space in species = "LeopardCat" was introduced by recordTableIndividual
# (because of CRAN package policies.
# In your data you can have spaces in your directory names)

  summary(sdh)
  plot(sdh, tracks = TRUE)

  ## multi-season capthist object
  # see vignette "3. Extracting Data from Camera Trapping Images, creating occupancy &amp; secr input"
  
  data(camtrapsMultiSeason)
  camtrapsMultiSeason$session[camtrapsMultiSeason$session == 2009] &lt;- 1
  camtrapsMultiSeason$session[camtrapsMultiSeason$session == 2010] &lt;- 2

  data(recordTableIndividualSampleMultiSeason)

  # create camera operation matrix (with problems/malfunction)
  camop_session &lt;- cameraOperation(CTtable         = camtrapsMultiSeason,
                                      stationCol   = "Station",
                                      setupCol     = "Setup_date",
                                      sessionCol   = "session",
                                      retrievalCol = "Retrieval_date",
                                      hasProblems  = TRUE,
                                      dateFormat   = "dmy"
  )

sdh_multi &lt;- spatialDetectionHistory(recordTableIndividual = recordTableIndividualSampleMultiSeason,
                               species               = "LeopardCat",
                               output                = "binary",
                               camOp                 = camop_session,
                               CTtable               = camtrapsMultiSeason,
                               stationCol            = "Station",
                               speciesCol            = "Species",
                               sessionCol            = "session",
                               Xcol                  = "utm_x",
                               Ycol                  = "utm_y",
                               individualCol         = "Individual",
                               recordDateTimeCol     = "DateTimeOriginal",
                               recordDateTimeFormat  = "ymd HMS",
                               occasionLength        = 10,
                               day1                  = "survey",
                               includeEffort         = TRUE,
                               timeZone              = "Asia/Kuala_Lumpur",
                               stationCovariateCols  = "utm_y",         # example
                               individualCovariateCols = "Individual"   # example
  )

  summary(sdh_multi)
  plot(sdh_multi, tracks = TRUE)

</code></pre>

<hr>
<h2 id='summary+2CcommOccu-method'>Summarize community occupancy model</h2><span id='topic+summary+2CcommOccu-method'></span>

<h3>Description</h3>

<p>Gives an overview of the number of species, stations and occasions in a <code>commOccu</code> object. Also returns covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'commOccu'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2CcommOccu-method_+3A_object">object</code></td>
<td>
<p><code>commOccu</code> object</p>
</td></tr>
<tr><td><code id="summary+2B2CcommOccu-method_+3A_...">...</code></td>
<td>
<p>currently ignored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The summary method is very basic and still work in progress.
</p>


<h3>Value</h3>

<p>Model summary printed to console
</p>

<hr>
<h2 id='surveyDashboard'>Shiny dashboard for summarizing and analyzing camera trap survey data</h2><span id='topic+surveyDashboard'></span>

<h3>Description</h3>

<p>Open a Shiny dashboard to summarize a camera trapping survey. It provides an 
overview of the data, maps, can create and run occupancy models in unmarked, 
and plot species activity. 
</p>
<p>Maps are interactive and can be panned, zoomed and queried. Users can choose 
a suitable basemap in the layers button.
</p>
<p>For occupancy models, users can flexibly customize detection histories. Then 
the user can specify the model structure (by selecting site covariates on 
detection and occupancy probability from the camera trap table) and 
optionally including effort. Models are fitted automatically with unmarked. 
Response curves (marginal effect plots), model and parameter summaries are 
computed and updated automatically with every change to the model. 
Multiple models can be compared using model selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surveyDashboard(
  CTtable,
  recordTable,
  stationCol,
  cameraCol = NULL,
  xcol,
  ycol,
  crs,
  setupCol,
  retrievalCol,
  hasProblems = FALSE,
  CTdateFormat = "ymd",
  camerasIndependent,
  speciesCol = "Species",
  recordDateTimeCol = "DateTimeOriginal",
  recordDateTimeFormat = "ymd HMS",
  timeZone = "UTC",
  exclude = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="surveyDashboard_+3A_cttable">CTtable</code></td>
<td>
<p>A data.frame containing the camera trap deployment information.</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_recordtable">recordTable</code></td>
<td>
<p>A data.frame containing the camera trap records.</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_stationcol">stationCol</code></td>
<td>
<p>The column name containing the camera trap station ID</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_cameracol">cameraCol</code></td>
<td>
<p>The column name containing the camera trap IDs (optional, only if 2 or more cameras per station)</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_xcol">xcol</code></td>
<td>
<p>The column name containing the X coordinate of the camera trap station.</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_ycol">ycol</code></td>
<td>
<p>The column name containing the Y coordinate of the camera trap station.</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_crs">crs</code></td>
<td>
<p>The coordinate reference system (CRS) of the camera trap data. Must be a valid argument to <code><a href="sf.html#topic+st_crs">st_crs</a></code></p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_setupcol">setupCol</code></td>
<td>
<p>The column name containing the camera trap deployment date (and time).</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_retrievalcol">retrievalCol</code></td>
<td>
<p>The column name containing the camera trap retrieval date (optionally date-time).</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_hasproblems">hasProblems</code></td>
<td>
<p>A logical indicating whether there are periods of cameras malfunctioning</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_ctdateformat">CTdateFormat</code></td>
<td>
<p>The date format of the camera trap deployment and retrieval date and time (default: &quot;ymd&quot;).</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_camerasindependent">camerasIndependent</code></td>
<td>
<p>logical. If multiple camera per station, are they independent?</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_speciescol">speciesCol</code></td>
<td>
<p>The column name containing the species names</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_recorddatetimecol">recordDateTimeCol</code></td>
<td>
<p>The column name containing the record date and time</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_recorddatetimeformat">recordDateTimeFormat</code></td>
<td>
<p>The date/time format of <code>recordDateTimeCol</code></p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_timezone">timeZone</code></td>
<td>
<p>Time zone of records in recordTable</p>
</td></tr>
<tr><td><code id="surveyDashboard_+3A_exclude">exclude</code></td>
<td>
<p>Species to be excluded from the data set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A Shiny dashboard for camera trap survey data.
</p>


<h3>Note</h3>

<p>Current limitations include:
</p>
<p>- supports only single-season data
</p>
<p>- only single-species occupancy models
</p>
<p>- no random or interaction effects in occupancy models
</p>
<p>- no (spatial) model predictions yet (planned for Q4/2023)
</p>
<p>- no support for spatial capture-recapture models (or anything related to individual IDs)
</p>
<p>- only models in unmarked, no Bayesian models in ubms yet (likely to be included later)
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data("camtraps")
data("recordTableSample")
 
  surveyDashboard(
    CTtable = camtraps,
    recordTable = recordTableSample,
    xcol = "utm_x",
    ycol = "utm_y",
    crs = "epsg:32650",      # = UTM50N (Sabah, Malaysian Borneo)
    stationCol = "Station",
    setupCol = "Setup_date",
    retrievalCol = "Retrieval_date",
    CTdateFormat = "dmy"
  )
  
## End(Not run)
  
  

</code></pre>

<hr>
<h2 id='surveyReport'>Create a report about a camera trapping survey and species detections</h2><span id='topic+surveyReport'></span>

<h3>Description</h3>

<p>This function creates a report about a camera trapping survey and species
records. It uses a camera trap station information table and a record table
(generated with <code><a href="#topic+recordTable">recordTable</a></code>) as input. Output tables can be
saved and a zip file for simple data sharing can be created easily.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surveyReport(
  recordTable,
  CTtable,
  camOp,
  speciesCol = "Species",
  stationCol = "Station",
  cameraCol,
  setupCol,
  retrievalCol,
  CTDateFormat = "ymd",
  CTHasProblems = "deprecated",
  recordDateTimeCol = "DateTimeOriginal",
  recordDateTimeFormat = "ymd HMS",
  Xcol,
  Ycol,
  sinkpath,
  makezip
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="surveyReport_+3A_recordtable">recordTable</code></td>
<td>
<p>data.frame containing a species record table as given by
<code><a href="#topic+recordTable">recordTable</a></code></p>
</td></tr>
<tr><td><code id="surveyReport_+3A_cttable">CTtable</code></td>
<td>
<p>data.frame containing information about location and trapping
period of camera trap stations (equivalent to <code><a href="#topic+camtraps">camtraps</a></code></p>
</td></tr>
<tr><td><code id="surveyReport_+3A_camop">camOp</code></td>
<td>
<p>camera operation matrix created with
<code><a href="#topic+cameraOperation">cameraOperation</a></code></p>
</td></tr>
<tr><td><code id="surveyReport_+3A_speciescol">speciesCol</code></td>
<td>
<p>character. name of the column specifying Species ID in
<code>recordTable</code></p>
</td></tr>
<tr><td><code id="surveyReport_+3A_stationcol">stationCol</code></td>
<td>
<p>character. name of the column specifying Station ID in
<code>CTtable</code> and <code>recordTable</code></p>
</td></tr>
<tr><td><code id="surveyReport_+3A_cameracol">cameraCol</code></td>
<td>
<p>character. name of the column specifying Camera ID in
<code>CTtable</code> and <code>recordTable</code></p>
</td></tr>
<tr><td><code id="surveyReport_+3A_setupcol">setupCol</code></td>
<td>
<p>character. name of the column containing camera setup dates
in <code>CTtable</code></p>
</td></tr>
<tr><td><code id="surveyReport_+3A_retrievalcol">retrievalCol</code></td>
<td>
<p>character. name of the column containing camera
retrieval dates in <code>CTtable</code></p>
</td></tr>
<tr><td><code id="surveyReport_+3A_ctdateformat">CTDateFormat</code></td>
<td>
<p>character. The format of columns <code>setupCol</code> and
<code>retrievalCol</code> (and potential problem columns) in <code>CTtable</code>. Must
be interpretable by either <code>as.Date</code> or the &quot;orders&quot; argument
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> in <span class="pkg">lubridate</span>.</p>
</td></tr>
<tr><td><code id="surveyReport_+3A_cthasproblems">CTHasProblems</code></td>
<td>
<p>deprecated (since version 2.1)</p>
</td></tr>
<tr><td><code id="surveyReport_+3A_recorddatetimecol">recordDateTimeCol</code></td>
<td>
<p>character. The name of the column containing date
and time of records in <code>recordTable</code></p>
</td></tr>
<tr><td><code id="surveyReport_+3A_recorddatetimeformat">recordDateTimeFormat</code></td>
<td>
<p>character. The date/time format of column
<code>recordDateTimeCol</code> in <code>recordTable</code>.</p>
</td></tr>
<tr><td><code id="surveyReport_+3A_xcol">Xcol</code></td>
<td>
<p>character. name of the column specifying x coordinates in
<code>CTtable</code>. Used to create detection maps if <code>makezip</code> is TRUE.
(optional)</p>
</td></tr>
<tr><td><code id="surveyReport_+3A_ycol">Ycol</code></td>
<td>
<p>character. name of the column specifying y coordinates in
<code>CTtable</code>. Used to create detection maps if <code>makezip</code> is TRUE.
(optional)</p>
</td></tr>
<tr><td><code id="surveyReport_+3A_sinkpath">sinkpath</code></td>
<td>
<p>character. The directory into which the survey report is
saved (optional)</p>
</td></tr>
<tr><td><code id="surveyReport_+3A_makezip">makezip</code></td>
<td>
<p>logical. Create a zip file containing tables, plots and maps
in <code>sinkpath</code>?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dateFormat</code> defaults to &quot;YYYY-MM-DD&quot;, e.g. &quot;2014-10-31&quot;. It can be
specified either in the format required by <code><a href="base.html#topic+strptime">strptime</a></code> or
the 'orders' argument in <code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> in
<span class="pkg">lubridate</span>. In the example above, &quot;YYYY-MM-DD&quot; would be specified as
&quot;%Y-%m-%d&quot; or &quot;ymd&quot;.
</p>
<p><code>recordDateTimeFormat</code> defaults to the &quot;YYYY-MM-DD HH:MM:SS&quot;
convention, e.g. &quot;2014-09-30 22:59:59&quot;. <code>recordDateTimeFormat</code> can be
interpreted either by base-R via <code><a href="base.html#topic+strptime">strptime</a></code> or in
<span class="pkg">lubridate</span> via <code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code> (argument
&quot;orders&quot;). <span class="pkg">lubridate</span> will be used if there are no &quot;%&quot; characters in
<code>recordDateTimeFormat</code>.
</p>
<p>For &quot;YYYY-MM-DD HH:MM:SS&quot;, <code>recordDateTimeFormat</code> would be either
&quot;%Y-%m-%d %H:%M:%S&quot; or &quot;ymd HMS&quot;. For details on how to specify date
and time formats in R see <code><a href="base.html#topic+strptime">strptime</a></code> or
<code><a href="lubridate.html#topic+parse_date_time">parse_date_time</a></code>.
</p>
<p>Note: as of version 2.1, argument <code>CTHasProblems</code> is deprecated and
defunct. Please use <code>camOp</code> instead to provide information about
periods of camera activity and malfunction. If <code>camOp</code> is not provided
the legacy version of surveyReport (from camtrapR 2.0.3) will be run with a
warning.
</p>


<h3>Value</h3>

<p>An invisible list containing 5 <code>data.frames</code>.
</p>
<table>
<tr><td><code>survey_dates</code></td>
<td>
<p>station and image date ranges, number of total and
active trap days (calendar days and taking into account independent effort
of multiple cameras, if applicable), number of cameras per station</p>
</td></tr>
<tr><td><code>species_by_station</code></td>
<td>
<p>species numbers by station</p>
</td></tr>
<tr><td><code>events_by_species</code></td>
<td>
<p>number of events and stations by species</p>
</td></tr>
<tr><td><code>events_by_station</code></td>
<td>
<p>number of events for every species by station (only
species that were recorded)</p>
</td></tr> <tr><td><code>events_by_station2</code></td>
<td>
<p>number of events for
all species at all stations (including species that were not recorded)</p>
</td></tr>
</table>
<p>The output will be saved to a .txt file if <code>sinkpath</code> is defined.
</p>
<p>If <code>makezip</code> is TRUE, a zip file will be created in <code>sinkpath</code>. It
contains single-species activity plots, detection maps (if <code>Xcol</code> and
<code>Ycol</code> are defined), the survey report tables, the record table and the
camera trap station table, and an example R script.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+recordTable">recordTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(camtraps)
data(recordTableSample)

# since version 2.1, camera operation matrix is required as input

camop_no_problem &lt;- cameraOperation(CTtable      = camtraps,
                                    stationCol   = "Station",
                                    setupCol     = "Setup_date",
                                    retrievalCol = "Retrieval_date",
                                    writecsv     = FALSE,
                                    hasProblems  = FALSE,
                                    dateFormat   = "dmy"
)

reportTest &lt;- surveyReport (recordTable          = recordTableSample,
                            CTtable              = camtraps,
                            camOp                = camop_no_problem,
                            speciesCol           = "Species",
                            stationCol           = "Station",
                            setupCol             = "Setup_date",
                            retrievalCol         = "Retrieval_date",
                            CTDateFormat         = "dmy", 
                            recordDateTimeCol    = "DateTimeOriginal",
                            recordDateTimeFormat = "ymd HMS")

class(reportTest)  # a list with
length(reportTest) # 5 elements

reportTest[[1]]    # camera trap operation times and image date ranges
reportTest[[2]]    # number of species by station
reportTest[[3]]    # number of events and number of stations by species
reportTest[[4]]    # number of species events by station
reportTest[[5]]    # number of species events by station including 0s (non-observed species)

# with camera problems

camop_problem &lt;- cameraOperation(CTtable      = camtraps,
                                 stationCol   = "Station",
                                 setupCol     = "Setup_date",
                                 retrievalCol = "Retrieval_date",
                                 writecsv     = FALSE,
                                 hasProblems  = TRUE,
                                 dateFormat   = "dmy"
)

reportTest_problem &lt;- surveyReport (recordTable          = recordTableSample,
                                    CTtable              = camtraps,
                                    camOp                = camop_problem,
                                    speciesCol           = "Species",
                                    stationCol           = "Station",
                                    setupCol             = "Setup_date",
                                    retrievalCol         = "Retrieval_date",
                                    CTDateFormat         = "dmy", 
                                    recordDateTimeCol    = "DateTimeOriginal",
                                    recordDateTimeFormat = "ymd HMS")

reportTest_problem$survey_dates



## if camOp is missing, the legacy version (from 2.0.3) will be used:

reportTest_problem_old &lt;- surveyReport (recordTable          = recordTableSample,
                                        CTtable              = camtraps,
                                       # camOp                = camop_problem,
                                        speciesCol           = "Species",
                                        stationCol           = "Station",
                                        setupCol             = "Setup_date",
                                        retrievalCol         = "Retrieval_date",
                                        CTDateFormat         = "dmy", 
                                        recordDateTimeCol    = "DateTimeOriginal",
                                        recordDateTimeFormat = "ymd HMS")

## Not run: 
# run again with sinkpath defined
reportTest &lt;- surveyReport (recordTable          = recordTableSample,
                            CTtable              = camtraps,
                            camOp                = camop_no_problem,
                            speciesCol           = "Species",
                            stationCol           = "Station",
                            setupCol             = "Setup_date",
                            retrievalCol         = "Retrieval_date",
                            CTDateFormat         = "dmy",, 
                            recordDateTimeCol    = "DateTimeOriginal",
                            recordDateTimeFormat = "ymd HMS",
                            sinkpath             = getwd())

# have a look at the text file
readLines(list.files(getwd(), pattern = paste("survey_report_", Sys.Date(), ".txt", sep = ""), 
					 full.names = TRUE))

## End(Not run)

</code></pre>

<hr>
<h2 id='timeShiftImages'>Apply time shifts to JPEG image metadata</h2><span id='topic+timeShiftImages'></span>

<h3>Description</h3>

<p>Change the values of digital timestamps in image metadata using ExifTool. If
date/time of images were set incorrectly, they can be corrected easily in
batch mode for further analyses. Please, always make a backup of your data
before using this function to avoid data loss or damage. This is because
ExifTool will make a copy of your images and applies the time shifts to the
copies. The file extension of the original images (.JPG) will be renamed to
&quot;.JPG_original&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timeShiftImages(
  inDir,
  hasCameraFolders,
  timeShiftTable,
  stationCol,
  cameraCol,
  timeShiftColumn,
  timeShiftSignColumn,
  undo = FALSE,
  ignoreMinorErrors = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timeShiftImages_+3A_indir">inDir</code></td>
<td>
<p>character. Name of directory containing station directories
with images</p>
</td></tr>
<tr><td><code id="timeShiftImages_+3A_hascamerafolders">hasCameraFolders</code></td>
<td>
<p>logical. Do the station directories in <code>inDir</code>
have camera subdirectories (e.g. &quot;inDir/StationA/Camera1&quot;)?</p>
</td></tr>
<tr><td><code id="timeShiftImages_+3A_timeshifttable">timeShiftTable</code></td>
<td>
<p>data.frame containing information about
station-/camera-specific time shifts.</p>
</td></tr>
<tr><td><code id="timeShiftImages_+3A_stationcol">stationCol</code></td>
<td>
<p>character. name of the column specifying Station ID in
<code>timeShiftTable</code></p>
</td></tr>
<tr><td><code id="timeShiftImages_+3A_cameracol">cameraCol</code></td>
<td>
<p>character. name of the column specifying Camera ID in
<code>timeShiftTable</code> (optional)</p>
</td></tr>
<tr><td><code id="timeShiftImages_+3A_timeshiftcolumn">timeShiftColumn</code></td>
<td>
<p>character. The name of the column containing time
shift values in <code>timeShiftTable</code></p>
</td></tr>
<tr><td><code id="timeShiftImages_+3A_timeshiftsigncolumn">timeShiftSignColumn</code></td>
<td>
<p>character. The name of the column with the
direction of time shifts in <code>timeShiftTable</code>. Can only be &quot;-&quot; or &quot;+&quot;.</p>
</td></tr>
<tr><td><code id="timeShiftImages_+3A_undo">undo</code></td>
<td>
<p>logical. Undo changes and restore the original images? Please be
careful, this deletes any edited images if <code>TRUE</code></p>
</td></tr>
<tr><td><code id="timeShiftImages_+3A_ignoreminorerrors">ignoreMinorErrors</code></td>
<td>
<p>logical. Ignore minor errors that would cause the
function to fail (set TRUE for images with bad MakerNotes, observed in
Panthera V4 cameras)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>timeShiftTable</code> is a data frame with columns for station ID, camera ID
(optional), time shift value and direction of time shift (for an example see
<code><a href="#topic+timeShiftTable">timeShiftTable</a></code>). Images in <code>inDir</code> must be sorted into
station directories. If <code>hasCameraFolders = TRUE</code>, the function expects
camera subdirectories in the station directories and will only apply time
shifts to the camera subdirectories specified by <code>CameraCol</code> in
<code>timeShiftTable</code>. If <code>hasCameraFolders = FALSE</code>, shifts will be
applied to the whole station directory (including potential subdirectories).
</p>
<p>The values of <code>timeShiftColumn</code> must adhere to the following pattern:
&quot;YYYY:mm:dd HH:MM:SS&quot; (&quot;year:month:day hour:minute:second&quot;). Examples:
&quot;1:0:0 0:0:0&quot; is a shift of exactly 1 year and &quot;0:0:0 12:10:01&quot; 12 hours and
10 minutes and 1 second. Note that stating &quot;00&quot; may cause problems, so use
&quot;0&quot; instead if an entry is zero.
</p>
<p><code>timeShiftSignColumn</code> signifies the direction of the time shift. &quot;+&quot;
moves image dates into the future (i.e. the image date lagged behind the
actual date) and &quot;-&quot; moves image dates back (if the image dates were ahead
of actual time).
</p>
<p>ExifTool stores the original images as <code>.JPG_original</code> files in the
original file location. By setting <code>undo = TRUE</code>, any JPG files in the
directories specified by <code>timeShiftTable</code> will be deleted and the
original JPEGs will be restored from the JPG_original files. Please make a
backup before using <code>undo</code>.
</p>
<p>Years can have 365 or 366 days, and months 28 to 31 days. Here is how the
function handles these (from the exiftool help page): &quot;The ability to shift
dates by Y years, M months, etc, conflicts with the design goal of
maintaining a constant shift for all time values when applying a batch
shift. This is because shifting by 1 month can be equivalent to anything
from 28 to 31 days, and 1 year can be 365 or 366 days, depending on the
starting date. The inconsistency is handled by shifting the first tag found
with the actual specified shift, then calculating the equivalent time
difference in seconds for this shift and applying this difference to
subsequent tags in a batch conversion.&quot;
</p>
<p><code>ignoreMinorErrors</code> is useful if image timestamps are not updated
correctly (entries in column &quot;n_images&quot; of the output are &quot;... files weren't
updated due to errors&quot;). This can be caused by bad MakerNotes and so far was
only observed in Panthera V4 and V6 cameras. In that case, set
<code>ignoreMinorErrors</code> to <code>TRUE</code>. This will add the &quot;-m&quot; option to
the Exiftool call, thereby ignoring minor errors and warnings and applying
the time shift nevertheless.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the information about the processed
directories and the number of images.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>References</h3>

<p><a href="https://exiftool.org/#shift">https://exiftool.org/#shift</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 

# copy sample images to temporary directory (so we don't mess around in the package directory)
wd_images_ID &lt;- system.file("pictures/sample_images_species_dir", package = "camtrapR")
file.copy(from = wd_images_ID, to = tempdir(), recursive = TRUE)
wd_images_ID_copy &lt;- file.path(tempdir(), "sample_images_species_dir")

data(timeShiftTable)


timeshift_run &lt;- timeShiftImages(inDir                = wd_images_ID_copy,
                                 timeShiftTable       = timeShiftTable,
                                 stationCol           = "Station",
                                 hasCameraFolders     = FALSE,
                                 timeShiftColumn      = "timeshift",
                                 timeShiftSignColumn  = "sign",
                                 undo                 = FALSE
)


timeshift_undo &lt;- timeShiftImages(inDir               = wd_images_ID_copy,
                                  timeShiftTable      = timeShiftTable,
                                  stationCol          = "Station",
                                  hasCameraFolders    = FALSE,
                                  timeShiftColumn     = "timeshift",
                                  timeShiftSignColumn = "sign",
                                  undo                = TRUE
)

## End(Not run)

</code></pre>

<hr>
<h2 id='timeShiftTable'>Sample camera trap time shift table</h2><span id='topic+timeShiftTable'></span>

<h3>Description</h3>

<p>Sample camera trap time shift table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(timeShiftTable)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2 rows and 4 variables</p>


<h3>Details</h3>

<p>If image Exif metadata timestamps are wrong systematically (e.g. because camera system time was not set after changing batteries), it can be corrected using a <code>data.frame</code> in the following format using function <code><a href="#topic+timeShiftImages">timeShiftImages</a></code>. For details on data format, please see <code><a href="#topic+timeShiftImages">timeShiftImages</a></code>.
</p>
<p>The variables are as follows:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Station</code> </td><td style="text-align: left;"> Camera trap station ID </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>camera</code> </td><td style="text-align: left;"> Camera trap ID (optional) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>timeshift</code> </td><td style="text-align: left;"> time shift amount to be applied </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sign</code> </td><td style="text-align: left;"> direction of time shift </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<hr>
<h2 id='writeDateTimeOriginal'>Write values to DateTimeOriginal tag in image metadata</h2><span id='topic+writeDateTimeOriginal'></span>

<h3>Description</h3>

<p>This function assigns values to the DateTimeOriginal tag in image's EXIF
metadata using Exiftool. It can be used when the original DateTimeOriginal
values in the metadata were lost for whatever reason. In order to first read
the Date/Time values from the data fields in the images, see the function
<code><a href="#topic+OCRdataFields">OCRdataFields</a></code>. After running <code>OCRdataFields</code> and checking
its output you can run <code>writeDateTimeOriginal</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeDateTimeOriginal(DateTimeOriginal, fileNames, parallel, overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeDateTimeOriginal_+3A_datetimeoriginal">DateTimeOriginal</code></td>
<td>
<p>character. DateTimeOriginal values to write into
EXIF:DateTimeOriginal tag of the files in fileNames.</p>
</td></tr>
<tr><td><code id="writeDateTimeOriginal_+3A_filenames">fileNames</code></td>
<td>
<p>character. Full file names (including directories) of
images to process.</p>
</td></tr>
<tr><td><code id="writeDateTimeOriginal_+3A_parallel">parallel</code></td>
<td>
<p>A parallel cluster object. Specify if you wish to run this
function in parallel. Provide a cluster object (output of makeCluster()) -
optional.</p>
</td></tr>
<tr><td><code id="writeDateTimeOriginal_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. Overwrite existing files (TRUE) or create new
files while saving the original data as jpg_original files as a backup
(FALSE)?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first value in <code>DateTimeOriginal</code> will be assigned to the first
image in <code>fileNames</code>, and so on. Both <code>DateTimeOriginal</code> and
<code>fileNames</code> can be obtained from the output of
<code><a href="#topic+OCRdataFields">OCRdataFields</a></code>.  <code>DateTimeOriginal</code> uses the standard
&quot;YYYY-MM-SS HH:MM:SS&quot;&quot; notation. If the values extracted via
<code><a href="#topic+OCRdataFields">OCRdataFields</a></code> are in a different format you'll need to
reformat them first. Please provide them as character. Also, before using
this function, make sure that the date/time values read by
<code><a href="#topic+OCRdataFields">OCRdataFields</a></code> are correct (sometimes OCR misreads values, so
check carefully).
</p>
<p>Parallel processing is advised since the function is rather slow (due to
calling Exiftool separately on every, so about 1 second per image). If you
know how to batch-assign DateTimeOriginal values in one Exiftool call,
please let me know.
</p>
<p>The function only works on JPG images, not video files.
</p>


<h3>Value</h3>

<p>Invisible NULL. The actual output is the JPG images which now have a
DateTimeOriginal tag.
</p>


<h3>Author(s)</h3>

<p>Juergen Niedballa
</p>


<h3>See Also</h3>

<p><code><a href="#topic+OCRdataFields">OCRdataFields</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
# dontrun is to avoid forcing users to install additional dependencies

wd_images_OCR &lt;- system.file("pictures/full_size_for_ocr", package = "camtrapR")

library(magick)

# define geometries
geometry1 &lt;- geometry_area(x_off = 0, y_off = 0, width = 183, height = 37)
geometry2 &lt;- geometry_area(x_off = 196, y_off = 0, width = 200, height = 17)
geometry3 &lt;- geometry_area(x_off = 447, y_off = 0, width = 63, height = 17)
geometry4 &lt;- geometry_area(x_off = 984, y_off = 0, width = 47, height = 17)
geometry5 &lt;- geometry_area(x_off = 0, y_off = 793, width = 320, height = 17)

# combine geometries into list
geometries &lt;- list(date = geometry1, 
                   time = geometry2, 
                   sequence_id = geometry3,
                   temperature = geometry4,
                   camera_model = geometry5)

df_image_data  &lt;- OCRdataFields(inDir = wd_images_OCR,
                                geometries = geometries, 
                                invert = TRUE)       
df_image_data



library(parallel)
library(lubridate)

# prepare DateTimeOriginal column (ymd_hms() automatically respects the PM indicator)
df_image_data$DateTimeOriginal &lt;- paste(df_image_data$date, df_image_data$time)
df_image_data$DateTimeOriginal &lt;- as.character(ymd_hms(df_image_data$DateTimeOriginal))

# create cluster (3 cores)
cl &lt;- makeCluster(3)

# assign new DateTimeOriginal
writeDateTimeOriginal(DateTimeOriginal = df_image_data$DateTimeOriginal,
                      fileNames = df_image_data$filename_full,
                      parallel = cl)
                      
stopCluster(cl)
                   

## End(Not run)



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
