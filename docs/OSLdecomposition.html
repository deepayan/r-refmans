<!DOCTYPE html><html><head><title>Help for package OSLdecomposition</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OSLdecomposition}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#decompose_OSLcurve'><p>Multi-exponential CW-OSL decomposition</p></a></li>
<li><a href='#fit_OSLcurve'><p>Multi-exponential CW-OSL curve fitting</p></a></li>
<li><a href='#optimise_OSLintervals'><p>Find adequate integration intervals for CW-OSL decomposition</p></a></li>
<li><a href='#OSLdecomposition-package'><p>Signal Component Analysis for Optically Stimulated Luminescence</p></a></li>
<li><a href='#plot_OSLcurve'><p>Advanced plot function for component resolved CW-OSL curves</p></a></li>
<li><a href='#plot_PhotoCrosssections'><p>Plot comparison of CW-OSL component photoionisation cross sections of different models</p></a></li>
<li><a href='#RLum.OSL_correction'><p>Check and correct CW-OSL curves in RLum.Analysis data sets</p></a></li>
<li><a href='#RLum.OSL_decomposition'><p>Separate CW-OSL components in RLum.Analysis data sets</p></a></li>
<li><a href='#RLum.OSL_global_fitting'><p>Identify CW-OSL signal components in RLum.Analysis data sets</p></a></li>
<li><a href='#simulate_OSLcomponents'><p>Simulates signal component decay curves and whole CW-OSL curves</p></a></li>
<li><a href='#sum_OSLcurves'><p>Combine RLum OSL records to one global average curve</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Signal Component Analysis for Optically Stimulated Luminescence</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-07-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dirk Mittelstraß &lt;dirk.mittelstrass@luminescence.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Function library for the identification and separation of exponentially
    decaying signal components in continuous-wave optically stimulated luminescence measurements.
    A special emphasis is laid on luminescence dating with quartz, which is known for
    systematic errors due to signal components with unequal physical behaviour.
    Also, this package enables an easy to use signal decomposition of
    data sets imported and analysed with the R package 'Luminescence'.
    This includes the optional automatic creation of HTML reports. Further information and tutorials
    can be found at <a href="https://luminescence.de">https://luminescence.de</a>.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DirkMittelstrass/OSLdecomposition/issues">https://github.com/DirkMittelstrass/OSLdecomposition/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>Luminescence (&ge; 0.9.9), methods, utils, stats, tools,
DEoptim, minpack.lm, gridExtra, ggplot2, scales, ggpubr,
rmarkdown</td>
</tr>
<tr>
<td>Suggests:</td>
<td>kableExtra</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-08 18:47:36 UTC; DirkWinDuck</td>
</tr>
<tr>
<td>Author:</td>
<td>Dirk Mittelstraß <a href="https://orcid.org/0000-0002-9567-8791"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Sebastian Kreutzer
    <a href="https://orcid.org/0000-0002-0734-2199"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Christoph Schmidt <a href="https://orcid.org/0000-0002-2309-3209"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Jan Beyer <a href="https://orcid.org/0000-0002-1403-395X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ths],
  Johannes Heitmann [ths],
  Arno Straessner <a href="https://orcid.org/0000-0003-2460-6659"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ths]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-12 12:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='decompose_OSLcurve'>Multi-exponential CW-OSL decomposition</h2><span id='topic+decompose_OSLcurve'></span>

<h3>Description</h3>

<p>Function for determining the signal component amplitudes of a multi-exponential decay curve if
the signal component decay parameters are already given. Thus, this function decomposes CW-OSL
curves with known components of unknown intensity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decompose_OSLcurve(
  curve,
  components,
  background.fitting = FALSE,
  algorithm = "det",
  error.estimation = "empiric",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decompose_OSLcurve_+3A_curve">curve</code></td>
<td>
<p><a href="base.html#topic+data.frame">data.frame</a> or <a href="base.html#topic+matrix">matrix</a> or <a href="Luminescence.html#topic+RLum.Data.Curve-class">RLum.Data.Curve</a> (<strong>required</strong>):
CW-OSL curve x-Axis: <code style="white-space: pre;">&#8288;$time&#8288;</code> or first column as measurement time (must have constant time intervals);
y-Axis: <code style="white-space: pre;">&#8288;$signal&#8288;</code> or second column as luminescence signal. Further columns will be ignored.</p>
</td></tr>
<tr><td><code id="decompose_OSLcurve_+3A_components">components</code></td>
<td>
<p><a href="base.html#topic+data.frame">data.frame</a> or <a href="base.html#topic+numeric">numeric</a> vector (<strong>required</strong>):
Either a vector containing the decay parameters of the CW-OSL components or a table (data.frame), usually the table returned by <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>.
In case of a vector: It is recommended to use less than 7 parameters. The parameters will be sorted in decreasing order.
In case of a data.frame, one column must be named <code style="white-space: pre;">&#8288;$lambda&#8288;</code>.
It is recommended to provide also integration interval parameters (columns <code style="white-space: pre;">&#8288;$t.start&#8288;</code>, <code style="white-space: pre;">&#8288;$t.end&#8288;</code>, <code style="white-space: pre;">&#8288;$ch.start&#8288;</code>, <code style="white-space: pre;">&#8288;$ch.end&#8288;</code>),
which can be found by applying <a href="#topic+optimise_OSLintervals">optimise_OSLintervals</a> to the global mean curve, calculated by <a href="#topic+sum_OSLcurves">sum_OSLcurves</a>.
If one or more column is missing, a simple interval definition algorithm is run automatically, see section <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="decompose_OSLcurve_+3A_background.fitting">background.fitting</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
if <code>TRUE</code>, an additional signal component with a decay rate of <code class="reqn">\lambda = 0</code> is included.
This allows for an accurate estimation of slow component intensities if the data is not background
corrected. However, the additional component reduces the overall precision of the algorithm.
It can also cause implausible slow component results if the measurement duration is not sufficiently long (&gt; 30 s).</p>
</td></tr>
<tr><td><code id="decompose_OSLcurve_+3A_algorithm">algorithm</code></td>
<td>
<p><a href="base.html#topic+character">character</a> string (<em>with default</em>):
Choice of curve decomposition approach. Either <code>"det"</code> or <code>"det+nls"</code> or <code>"nls"</code>, see section <strong>Details</strong>.
^^</p>
</td></tr>
<tr><td><code id="decompose_OSLcurve_+3A_error.estimation">error.estimation</code></td>
<td>
<p><a href="base.html#topic+character">character</a> string (<em>with default</em>):
integral error estimation approach, either <code>"empiric"</code> or <code>"poisson"</code> or a <a href="base.html#topic+numeric">numeric</a> value or <code>"none"</code>,
see section <strong>Details</strong>. This argument has no effect if <code>algorithm = "nls"</code>.</p>
</td></tr>
<tr><td><code id="decompose_OSLcurve_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
enables console text output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assumes multiple exponentially decaying signal components with first-order kinetics:
</p>
<p style="text-align: center;"><code class="reqn">I(t) = n_1 \lambda_1 exp(-\lambda_1 t) + n_2 \lambda_2 exp(-\lambda_2 t) + ... + n_K \lambda_K exp(-\lambda_K t)</code>
</p>

<p>with <code class="reqn">I(t)</code> the CW-OSL signal, <code class="reqn">n</code> the signal component intensity,
<code class="reqn">\lambda</code> the signal component decay constant and <code class="reqn">K</code> the number of signal components.
For the actual decomposition procedure, the integrated version of this formula is used, see Mittelstrass et al. (2021) for details.
</p>
<p><strong>Decomposition algorithm</strong>
</p>
<p>The calculation procedure depends on the function argument <code>algorithm</code>.
This function includes two different decomposition algorithms: <code>"det"</code> for <strong>det</strong>erminant solution
and <code>"nls"</code> for <strong>n</strong>onlinear <strong>l</strong>east <strong>s</strong>quares estimate
</p>
<p><code>algorithm = "det"</code> (default)
</p>
<p>The function calculates the CW-OSL component intensities by building an equation system
which is then solved by a determinant-based approach (Cramers rule). This purely analytical
approach gives the algorithm a solution in all possible cases, even if the measurement consists just of noise
or the wrong model is used. There are also no 'false minima' events.
The statistical error is calculated by applying the <em>propagation of uncertainty</em> method on Cramers rule.
</p>
<p>The precision of this algorithm as well as the propagation of eventual systematic errors of the decay rate values,
depend on the integration intervals, given by the columns <code style="white-space: pre;">&#8288;$t.start&#8288;</code>, <code style="white-space: pre;">&#8288;$t.end&#8288;</code>, <code style="white-space: pre;">&#8288;$ch.start&#8288;</code> and <code style="white-space: pre;">&#8288;$ch.end&#8288;</code>
of the <a href="base.html#topic+data.frame">data.frame</a> used as input for the argument <code>components</code>.
In principle, these can be chosen freely. Reasonable integration intervals are defined by <a href="#topic+optimise_OSLintervals">optimise_OSLintervals</a>.
If not defined, the logarithmic mean values between life times (reciprocal decay rate) of subsequent components are
used as interval borders.
</p>
<p><code>algorithm = "nls"</code>
</p>
<p>As alternative algorithm, Levenberg-Marquardt nonlinear regression is available, see <a href="minpack.lm.html#topic+nlsLM">minpack.lm::nlsLM</a> for details.
The results are identical to that of the <code>"det"</code> algorithm in accuracy and precision. But there is the slight chance (&lt; 1 %)
of fitting failure when using the <code>"nls"</code> algorithm. Also, the statistical errors are underestimated by 20-80 %
in most cases. As advantage, the <code>"nls"</code> algorithm is less sensitive against systematic errors
caused by uncorrected signal background.
</p>
<p><code>algorithm = "det+nls"</code>
</p>
<p>Both algorithms can be combined. Then, <code>"det"</code> provides the startings values and the error estimations for
<code>"nls"</code> and returns replacement results, in case <code>"nls"</code> fails. <code>"nls"</code> compensates for potential systematic
errors in the fast and medium components intensity values due to uncorrected signal background. However, the
background signal will still affect slow component results. The slowest component will be overestimated while
the second slowest component will be underestimated. If these components are of particular interest,
it is recommended to set <code>background.fitting = TRUE</code>
</p>
<p>All three methods were tested at 5x10^6 simulated CW-OSL curves by Mittelstrass (2019) for their performance
(+++ reliable results in all cases; ++ reliable in &gt;95% of cases: + reliable in most cases):
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Characteristics</strong> </td><td style="text-align: left;"> <strong>det</strong> </td><td style="text-align: left;"> <strong>nls</strong> </td><td style="text-align: left;"> <strong>det+nls</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
Decomposition success rate </td><td style="text-align: left;"> 100 % </td><td style="text-align: left;"> &gt;99 % </td><td style="text-align: left;"> 100 % </td>
</tr>
<tr>
 <td style="text-align: left;">
Component intensity accuracy </td><td style="text-align: left;"> +++ </td><td style="text-align: left;"> +++ </td><td style="text-align: left;"> +++ </td>
</tr>
<tr>
 <td style="text-align: left;">
Accuracy in case of uncorrected background </td><td style="text-align: left;"> + </td><td style="text-align: left;"> ++ </td><td style="text-align: left;"> ++ </td>
</tr>
<tr>
 <td style="text-align: left;">
Error estimation accuracy </td><td style="text-align: left;"> +++ </td><td style="text-align: left;"> + </td><td style="text-align: left;"> ++
</td>
</tr>

</table>

<p>In summary, <code>algorithm = "det"</code> is recommended for the most cases. If the signal background level is
significant (&gt; 2 % of initial signal) but was not corrected, <code>algorithm = "det+nls"</code> is the better choice.
Setting <code>background.fitting = TRUE</code> is usually not recommended, only in case slow components shall
be investigated in measurements with uncorrected background.
</p>
<p><strong>Error estimation</strong>
</p>
<p>In case of <code>algorithm = "det"</code> or <code>"det+nls"</code> the Propagation of Uncertainty method is used to
transform signal bin error values (column <code style="white-space: pre;">&#8288;$bin.error&#8288;</code>) into component intensity error values (column <code style="white-space: pre;">&#8288;$n.error&#8288;</code>). The signal bin error
calculation depends on the argument <code>error.estimation</code>, see below.
If <code>algorithm = "nls"</code> is used, the error values provided by <a href="minpack.lm.html#topic+nlsLM">minpack.lm::nlsLM</a> are returned.
</p>
<p><code>error.estimation = "empiric"</code> (default)
</p>
<p>The standard deviation of each signal bin (signal bin = signal value of an integrated time interval) is
calculated from the <em>corrected sample variance</em> between the CW-OSL model and the actual CW-OSL curve
for that interval. Thus, statistical errors are monitored accurately without any prior knowledge required.
However, potential systematic errors are monitored insufficiently. Also, at least two (better more) data points
per signal bin are needed to estimate its standard deviation. If a signal bin consists just of one data point,
its square root value is taken as standard deviation, in accordance to the Poisson distribution.
</p>
<p><code>error.estimation = "poisson"</code> or <a href="base.html#topic+numeric">numeric</a> value
</p>
<p>Alternatively the standard error can be calculated by approximating a <strong>Poisson</strong> distributed signal error,
known as <em>Shot noise</em>. This is suitable if the lack of data points on the x-axis circumvents an empiric error
estimation, like with spatially or spectrally resolved CCD measurements. Also the parameter can be set to a <a href="base.html#topic+numeric">numeric</a>
value, which  represents the detector noise in <em>cts / s</em> and is assumed to be normal distributed.
The detector noise will be added on top of the Poisson distributed shot noise.
</p>
<p><code>error.estimation = "only.bin.RSS"</code>
</p>
<p>The error estimation is omitted but the residual sum of squares (RSS) between input curve and combined
signal component curves is calculated. However, the RSS value is divided into sections according to
the signal bins (column <code style="white-space: pre;">&#8288;$bin.RSS&#8288;</code>). The full RSS value can be calculated by summing over the complete column.
The RSS value is usually used a minimization target in fitting algorithms, like done in <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>.
The values of the <code style="white-space: pre;">&#8288;$bin.RSS&#8288;</code> column allows for weighted fitting by applying pre-factors to the bin RSS values.
For further speed advance, the calculation of <code style="white-space: pre;">&#8288;$components$n.residual&#8288;</code> and <code style="white-space: pre;">&#8288;$components$initial.signal&#8288;</code> is
also omitted.
</p>
<p><code>error.estimation = "none"</code>
</p>
<p>The error estimation is omitted. This option saves significant computing time, if the error estimation is
not of significance. For further speed advance, the calculation of <code style="white-space: pre;">&#8288;$components$n.residual&#8288;</code> and
<code style="white-space: pre;">&#8288;$components$initial.signal&#8288;</code> is also omitted.
</p>
<p><em>Systematic errors</em>
</p>
<p>The ratio of the error values of both error estimation methods can be used to detect (but not quantify) systematic
errors. <code>"poisson"</code> error values are not affected by systematic errors, while <code>"empiric"</code> errors are.
If the detector noise is known and taken into account, the relation between both values for a given
signal bin should be about <code class="reqn">empiric / poisson = 1</code>. In case of systematic errors, this ratio increases.
</p>


<h3>Value</h3>

<p>The input table <strong>components</strong> <a href="base.html#topic+data.frame">data.frame</a> will be returned with added or overwritten
columns: <code style="white-space: pre;">&#8288;$n&#8288;</code>, <code style="white-space: pre;">&#8288;$n.error&#8288;</code>, <code style="white-space: pre;">&#8288;$n.residual&#8288;</code>, <code style="white-space: pre;">&#8288;$bin&#8288;</code>, <code style="white-space: pre;">&#8288;$bin.error&#8288;</code>, <code style="white-space: pre;">&#8288;$bin.RSS&#8288;</code>, <code style="white-space: pre;">&#8288;$initial.signal&#8288;</code>.
Which columns are written depends on the selected parameters. If an input data.frame contains already
one of the above columns but parameters are selected which do not re-calculate the values, the values
of the columns are set to <code>NA</code>.
</p>


<h3>Last updates</h3>

<p>2022-07-25, DM: Extended algorithm for bin-wise RSS calculation and added error estimation option &quot;only.bin.RSS&quot;
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstraß, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Mittelstraß, D., 2019. Decomposition of weak optically stimulated luminescence signals and
its application in retrospective dosimetry at quartz (Master thesis). TU Dresden, Dresden.
</p>


<h3>See Also</h3>

<p><a href="#topic+fit_OSLcurve">fit_OSLcurve</a>, <a href="#topic+optimise_OSLintervals">optimise_OSLintervals</a>, <a href="#topic+RLum.OSL_decomposition">RLum.OSL_decomposition</a>, <a href="minpack.lm.html#topic+nlsLM">minpack.lm::nlsLM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Set some arbitrary decay parameter for a dim CW-OSL measurement of quartz
components &lt;- data.frame(name = c("fast", "medium", "slow"),
                         lambda = c(2, 0.5, 0.02),
                         n = c(1000, 1000, 10000))

# Simulate the CW-OSL curve and add some signal noise and some detection background
curve &lt;- simulate_OSLcomponents(components, simulate.curve = TRUE,
                                add.poisson.noise = TRUE, add.background = 40)

# Decompose the simulated curve
components &lt;- decompose_OSLcurve(curve, components)

# Display the component separation results
plot_OSLcurve(curve, components)

### Decomposition including signal background fitting:

# Define optimized integration intervals, including an interval for the background
components &lt;- optimise_OSLintervals(components, curve, background.component = TRUE)

# Decompose again and view results
components &lt;- decompose_OSLcurve(curve, components, background.fitting = TRUE)
plot_OSLcurve(curve, components)

</code></pre>

<hr>
<h2 id='fit_OSLcurve'>Multi-exponential CW-OSL curve fitting</h2><span id='topic+fit_OSLcurve'></span>

<h3>Description</h3>

<p>Fitting function for multi-exponentially decaying CW-OSL measurements,
based on the algorithm described by Bluszcz &amp; Adamiec (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_OSLcurve(
  curve,
  K.max = 5,
  F.threshold = 150,
  stimulation.intensity = 30,
  stimulation.wavelength = 470,
  verbose = TRUE,
  output.complex = FALSE,
  parallel.computing = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_OSLcurve_+3A_curve">curve</code></td>
<td>
<p><a href="Luminescence.html#topic+RLum.Data.Curve-class">RLum.Data.Curve</a> or <a href="base.html#topic+data.frame">data.frame</a> or <a href="base.html#topic+matrix">matrix</a> (<strong>required</strong>):
CW-OSL record or average CW-OSL curve created by <a href="#topic+sum_OSLcurves">sum_OSLcurves</a>. If no column <code style="white-space: pre;">&#8288;$time&#8288;</code> exists, the first column is defined
as measurement time (x-axis). Time intervals must be constant. If no column <code style="white-space: pre;">&#8288;$signal&#8288;</code> exists, the second column is defined
as signal values (y-axis). Further columns will be ignored</p>
</td></tr>
<tr><td><code id="fit_OSLcurve_+3A_k.max">K.max</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Maximum number of components <em>K</em>. The computing time increases exponentially with the component number.
<em>K</em> &lt; 7 is recommended</p>
</td></tr>
<tr><td><code id="fit_OSLcurve_+3A_f.threshold">F.threshold</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Fitting stop criterion. If the F-value is lower than this threshold, the fitting procedure stops and the K - 1 fit is returned</p>
</td></tr>
<tr><td><code id="fit_OSLcurve_+3A_stimulation.intensity">stimulation.intensity</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Intensity of optical stimulation in <em>mW / cm²</em>. Used to calculate photoionisation cross sections.</p>
</td></tr>
<tr><td><code id="fit_OSLcurve_+3A_stimulation.wavelength">stimulation.wavelength</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Wavelength of optical stimulation in <em>nm</em>. Used to calculate photoionisation cross sections.
If a wavelength between 465 and 480 nm is chosen, the cross sections are set into
relation with literature values to name the signal components automatically.</p>
</td></tr>
<tr><td><code id="fit_OSLcurve_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Enables console text output.</p>
</td></tr>
<tr><td><code id="fit_OSLcurve_+3A_output.complex">output.complex</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
If <code>TRUE</code>, the function returns a list of objects, see section <strong>Value</strong> for further information.
If <code>FALSE</code>, the function returns a <a href="base.html#topic+data.frame">data.frame</a> with the CW-OSL model parameters of the fitting chosen by the F-test.
Setting the parameter to <code>FALSE</code> is not recommended when fitting a global average curve created by <a href="#topic+sum_OSLcurves">sum_OSLcurves</a> as over-fitting is likely in such cases.</p>
</td></tr>
<tr><td><code id="fit_OSLcurve_+3A_parallel.computing">parallel.computing</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Enables the use of multiple CPU cores. This increases the execution speed significantly
but may need administrator rights and/or a firewall exception.
See <a href="DEoptim.html#topic+DEoptim.control">DEoptim::DEoptim.control</a> for further information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assumes multiple exponentially decaying signal components with first-order kinetics:
</p>
<p style="text-align: center;"><code class="reqn">I(t) = n_1 \lambda_1 exp(-\lambda_1 t) + n_2 \lambda_2 exp(-\lambda_2 t) + ... + n_K \lambda_K exp(-\lambda_K t)</code>
</p>

<p>with <code class="reqn">I(t)</code> the CW-OSL signal, <code class="reqn">n</code> the signal component intensity,
<code class="reqn">\lambda</code> the signal component decay constant and <code class="reqn">K</code> the number of signal components.
For actual fitting, the integrated version of this formula is used, see Mittelstraß et al. (2021) for details.
</p>
<p>The fitting algorithm is an implementation of the <em>hybrid evolutionary-linear algorithm</em> (HELA)
by Bluszcz &amp; Adamiec (2006). See there or Mittelstraß et al. (in preparation) for details.
The differential evolution part of HELA is performed by <a href="DEoptim.html#topic+DEoptim">DEoptim::DEoptim</a>.
The linear regression part of HELA is performed by <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>.
The parameter refinement by Levenberg-Marquardt fitting is performed by <a href="minpack.lm.html#topic+nlsLM">minpack.lm::nlsLM</a>.
</p>
<p><strong>F-test</strong>
</p>
<p>Bluszcz &amp; Adamiec (2006) suggest the use of an F-test to determine the correct number of signal components.
This function compares the residual square sum (<em>RSS_K</em>) value of each
fitting with the <em>RSS_K-1</em> value of the previous fitting and calculates
an <em>Improvement-in-fitting-quality</em> criterion:
</p>
<p style="text-align: center;"><code class="reqn">F_K = {(RSS_{K-1} - RSS_K)/2} / {RSS_K(N - 2K)}</code>
</p>

<p>Here, <em>N</em> is the number data points (channels) of the measurement and <em>K</em> is the number of OSL components
in the fitting model. If <em>F_K</em> falls below the threshold value (<code>F.threshold</code>), the fitting model
with <em>K</em> components is apparently not significantly better than the <em>K</em> - 1 model of the previous fitting cycle.
Thus, the <em>K</em> - 1 model will be recommended as fitting solution.
</p>
<p><strong>Photoionisation cross sections</strong>
</p>
<p>While the function is suited for the analysis of a wide variety of multi-exponential decay problems,
it is targeted to CW-OSL measurements of quartz under SAR protocol conditions (470 nm stimulation at 125 °C).
To compare the calculated OSL components with OSL components reported in published literature,
photoionisation cross sections are calculated using the <code>stimulation.wavelength</code> <code class="reqn">\lambda_{stim}</code>  and
<code>stimulation.intensity</code> <code class="reqn">\Phi_{stim}</code>:
</p>
<p style="text-align: center;"><code class="reqn">\sigma_k=\lambda_k {hc / \Phi_{stim}\lambda_{stim}}</code>
</p>

<p>Here <code class="reqn">\sigma_k</code> is the photoionisation cross section of component <em>k</em> in cm^2,
<code class="reqn">\lambda_k</code> the CW-OSL decay constant in s^-1, <em>h</em> the Planck constant and <em>c</em> the speed of light.
</p>
<p>If a <code>stimulation.intensity</code> between 460 nm and 485 nm is defined,
the components are named automatically in accordance to the
cross-sections published by Durcan and Duller (2011), Jain et al. (2003) and Singarayer and Bailey (2003).
For the Ultrafast and the Slow4 component, no consistent literature values could be found, so their range
is tentatively assigned:
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Component</strong> </td><td style="text-align: left;"> <strong>Lower limit (cm^2)</strong> </td><td style="text-align: left;"> <strong>Upper limit (cm^2)</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
Ultrafast </td><td style="text-align: left;"> 1e-16 </td><td style="text-align: left;"> 1e-15 </td>
</tr>
<tr>
 <td style="text-align: left;">
Fast </td><td style="text-align: left;"> 1.9e-17 </td><td style="text-align: left;"> 3.1e-17 </td>
</tr>
<tr>
 <td style="text-align: left;">
Medium </td><td style="text-align: left;"> 3e-18 </td><td style="text-align: left;"> 9e-18 </td>
</tr>
<tr>
 <td style="text-align: left;">
Slow1 </td><td style="text-align: left;"> 1e-18 </td><td style="text-align: left;"> 1.85e-18 </td>
</tr>
<tr>
 <td style="text-align: left;">
Slow2 </td><td style="text-align: left;"> 1.1e-19 </td><td style="text-align: left;"> 4e-19 </td>
</tr>
<tr>
 <td style="text-align: left;">
Slow3 </td><td style="text-align: left;"> 1e-20 </td><td style="text-align: left;"> 4.67e-20 </td>
</tr>
<tr>
 <td style="text-align: left;">
Slow4 </td><td style="text-align: left;"> 1e-21 </td><td style="text-align: left;"> 1e-20
</td>
</tr>

</table>



<h3>Value</h3>

<p>If <code>output.complex = FALSE</code>, a <a href="base.html#topic+data.frame">data.frame</a> is returned. It contains the signal decay rates
and signal intensities of the best fit. The best fit was either chosen by the F-test or
the last successful fitting iteration.
</p>
<p>If <code>output.complex = TRUE</code>, a <a href="base.html#topic+list">list</a> of objects is returned:
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Element</strong> </td><td style="text-align: left;"> <strong>Type</strong> </td><td style="text-align: left;"> <strong>Description</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>decay.rates</code> </td><td style="text-align: left;"> <code>numeric</code> </td><td style="text-align: left;"> <a href="base.html#topic+vector">vector</a> of the best suiting decay rates </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>K.selected</code> </td><td style="text-align: left;"> <code>numeric</code> </td><td style="text-align: left;"> number of components of the best fit </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>F.test</code> </td><td style="text-align: left;"> <code>data.frame</code> </td><td style="text-align: left;"> table containing the F-test parameter and the decay rates of each fitting model </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>F.test.print</code> </td><td style="text-align: left;"> <code>data.frame</code> </td><td style="text-align: left;"> the same table as above, but formated for pretty console and report output </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>info.text</code> </td><td style="text-align: left;"> <code>character</code> </td><td style="text-align: left;"> collected messages from the algorithms </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>component.tables</code> </td><td style="text-align: left;"> <code>list</code> </td><td style="text-align: left;"> result <a href="base.html#topic+data.frame">data.frame</a>s for all tested models </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>curve</code> </td><td style="text-align: left;"> <code>data.frame</code> </td><td style="text-align: left;"> fitted time-signal-curve </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>components</code> </td><td style="text-align: left;"> <code>data.frame</code> </td><td style="text-align: left;"> best fit; same object as <code>output.complex = FALSE</code> returns </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fit.results</code> </td><td style="text-align: left;"> <code>list</code> </td><td style="text-align: left;"> <a href="base.html#topic+list">list</a> of <a href="stats.html#topic+nls">nls</a> objects for all tested models </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>plot.data</code> </td><td style="text-align: left;"> <code>data.frame</code> </td><td style="text-align: left;"> factorized results for overview plotting with <a href="#topic+plot_PhotoCrosssections">plot_PhotoCrosssections</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>parameters</code> </td><td style="text-align: left;"> <code>list</code> </td><td style="text-align: left;"> function arguments and the needed computing time
</td>
</tr>

</table>



<h3>Last update</h3>

<p>2022-07-27, DM: Moved residual sum of squares (RSS) calculation during DE-optimization cycle to decompose_OSLcurve() to improve computing time by factor 3 to 4
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstraß, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Bluszcz, A., Adamiec, G., 2006. Application of differential evolution to fitting OSL
decay curves. Radiation Measurements 41, 886–891.
</p>
<p>Durcan, J.A., Duller, G.A.T., 2011. The fast ratio: A rapid measure for testing the dominance of the fast component in the initial OSL signal from quartz. Radiation Measurements 46, 1065–1072.
</p>
<p>Jain, M., Murray, A.S., Bøtter-Jensen, L., 2003. Characterisation of blue-light stimulated luminescence components in different quartz samples: implications for dose measurement. Radiation Measurements 37, 441–449.
</p>
<p>Mittelstraß, D., 2019. Decomposition of weak optically stimulated luminescence signals and
its application in retrospective dosimetry at quartz (Master thesis). TU Dresden, Dresden.
</p>
<p>Singarayer, J.S., Bailey, R.M., 2003. Further investigations of the quartz optically stimulated luminescence components using linear modulation.
Radiation Measurements, Proceedings of the 10th international Conference on Luminescence and Electron-Spin Resonance Dating (LED 2002) 37, 451–458.
</p>


<h3>See Also</h3>

<p><a href="#topic+RLum.OSL_decomposition">RLum.OSL_decomposition</a>, <a href="#topic+sum_OSLcurves">sum_OSLcurves</a>, <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>, <a href="#topic+plot_OSLcurve">plot_OSLcurve</a>,
<a href="#topic+plot_PhotoCrosssections">plot_PhotoCrosssections</a>, <a href="minpack.lm.html#topic+nlsLM">minpack.lm::nlsLM</a>, <a href="DEoptim.html#topic+DEoptim">DEoptim::DEoptim</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create a simple curve with just one component
curve &lt;- data.frame(
  X = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12),
  Y = c(377, 244, 163, 93, 59, 28, 17, 13, 10, 8, 9, 5))
# Perform fitting
components &lt;- fit_OSLcurve(curve, F.threshold = 3)

# Display results
plot_OSLcurve(curve, components)

</code></pre>

<hr>
<h2 id='optimise_OSLintervals'>Find adequate integration intervals for CW-OSL decomposition</h2><span id='topic+optimise_OSLintervals'></span>

<h3>Description</h3>

<p>This function defines integration intervals for CW-OSL component separation with <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>.
The underlying iterative optimisation process aims for minimum cross-correlation between the signal components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimise_OSLintervals(
  components,
  curve = NULL,
  channel.width = NA,
  channel.number = NA,
  t.start = 0,
  t.end = NA,
  background.component = FALSE,
  verbose = TRUE,
  parallel.computing = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimise_OSLintervals_+3A_components">components</code></td>
<td>
<p><a href="base.html#topic+data.frame">data.frame</a> or <a href="base.html#topic+numeric">numeric</a> vector (<strong>required</strong>):
Table or vector containing the decay constants of the signal components.
A <a href="base.html#topic+data.frame">data.frame</a> must contain a column <code style="white-space: pre;">&#8288;$lambda&#8288;</code>. Usually the <a href="base.html#topic+data.frame">data.frame</a> is provided
by <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>.</p>
</td></tr>
<tr><td><code id="optimise_OSLintervals_+3A_curve">curve</code></td>
<td>
<p><a href="base.html#topic+data.frame">data.frame</a> or <a href="base.html#topic+matrix">matrix</a> or <a href="Luminescence.html#topic+RLum.Data.Curve-class">RLum.Data.Curve</a> (<em>optional</em>):
OSL signal curve which serves as time axis template.
The input curve will be used to define <code>channel.width</code> and <code>channel.number</code></p>
</td></tr>
<tr><td><code id="optimise_OSLintervals_+3A_channel.width">channel.width</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>optional</em>):
Channel width in seconds. Necessary if <code>curve</code> is not given.</p>
</td></tr>
<tr><td><code id="optimise_OSLintervals_+3A_channel.number">channel.number</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>optional</em>):
Number of channels resp. data points. Necessary if <code>curve</code> is not given.</p>
</td></tr>
<tr><td><code id="optimise_OSLintervals_+3A_t.start">t.start</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Starting time of the first interval, per default the start of the measurement.</p>
</td></tr>
<tr><td><code id="optimise_OSLintervals_+3A_t.end">t.end</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>optional</em>):
End time of the last interval, per default the end of the measurement.</p>
</td></tr>
<tr><td><code id="optimise_OSLintervals_+3A_background.component">background.component</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
If <code>TRUE</code>, an additional interval for a component with a decay rate of zero will be
determined. This enables the calculation of the signal background level during the signal
decomposition with <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>.</p>
</td></tr>
<tr><td><code id="optimise_OSLintervals_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Enables console text output.</p>
</td></tr>
<tr><td><code id="optimise_OSLintervals_+3A_parallel.computing">parallel.computing</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Enables the use of multiple CPU cores. This increases the execution speed significantly
but may need administrator rights and/or a firewall exception.
See <a href="DEoptim.html#topic+DEoptim.control">DEoptim::DEoptim.control</a> for further information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The precision of the component separation with <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a> and the impact of
systematic decay rate errors on the component separation depends on the integration interval definition.
This function minimises the influence of an under/over-estimated decay rate to the
signal intensity calculation of other component. This is done by maximizing the denominator
determinant in Cramers rule, see Mittelstraß (2019) for details. For maximisation, the iterative
evolutionary algorithm of Storn and Price (1997) is used, available in <em>R</em> through <a href="DEoptim.html#topic+DEoptim">DEoptim::DEoptim</a>.
</p>
<p>The inclusion of a background component is supported, see <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a> for details.
</p>


<h3>Value</h3>

<p>The input table <code>components</code> <a href="base.html#topic+data.frame">data.frame</a> will be returned with four additional columns:
<code style="white-space: pre;">&#8288;$t.start&#8288;</code>, <code style="white-space: pre;">&#8288;$t.end&#8288;</code> defining the time intervals and <code style="white-space: pre;">&#8288;$ch.start&#8288;</code>, <code style="white-space: pre;">&#8288;$ch.end&#8288;</code> assigning those intervals to channel indicies.
If a <a href="base.html#topic+numeric">numeric</a> vector is given as input, a new <a href="base.html#topic+data.frame">data.frame</a> will be returned.
</p>


<h3>Last updates</h3>

<p>2020-08-23, DM: Replaced previous maximum searching algorithm with <a href="DEoptim.html#topic+DEoptim">DEoptim::DEoptim</a>
(<strong>update may have changed analysis results</strong>)
</p>
<p>2020-10-29, DM: Added <code>parallel.computing</code> argument; enhanced roxygen documentation (<em>minor update</em>)
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstraß, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Mittelstraß, D., 2019. Decomposition of weak optically stimulated luminescence signals and its application in retrospective dosimetry at quartz (Master thesis). TU Dresden, Dresden.
</p>
<p>Storn, R., Price, K., 1997. Differential Evolution – A Simple and Efficient Heuristic for global Optimization over Continuous Spaces. Journal of Global Optimization 11, 341–359.
</p>


<h3>See Also</h3>

<p><a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>, <a href="#topic+RLum.OSL_decomposition">RLum.OSL_decomposition</a>, <a href="DEoptim.html#topic+DEoptim">DEoptim::DEoptim</a>, <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
A &lt;- optimise_OSLintervals(c(2, 0.5, 0.02), channel.width = 0.1, channel.number = 200)
print(A, row.names = FALSE)

</code></pre>

<hr>
<h2 id='OSLdecomposition-package'>Signal Component Analysis for Optically Stimulated Luminescence</h2><span id='topic+OSLdecomposition-package'></span><span id='topic+OSLdecomposition'></span>

<h3>Description</h3>

<p>Function library for the identification and separation of exponentially
decaying signal components in continuous-wave optically stimulated luminescence (CW-OSL) measurements.
A special emphasis is laid on luminescence dating with quartz, which is known for
systematic errors due to CW-OSL signal components with unequal physical behaviour.
Also, this package enables an easy to use signal decomposition of
CW-OSL data sets imported and analysed with the R package 'Luminescence'.
This includes the optional automatic creation of HTML reports.
</p>


<h3>Details</h3>

<p><strong>Project website</strong>
</p>

<ul>
<li> <p><a href="https://luminescence.de">https://luminescence.de</a>
</p>
</li></ul>

<p><strong>Source code repository</strong>
</p>

<ul>
<li> <p><a href="https://github.com/DirkMittelstrass/OSLdecomposition">https://github.com/DirkMittelstrass/OSLdecomposition</a>
</p>
</li></ul>

<p><strong>Bug reporting</strong>
</p>

<ul>
<li> <p><a href="https://github.com/DirkMittelstrass/OSLdecomposition/issues">https://github.com/DirkMittelstrass/OSLdecomposition/issues</a>
</p>
</li></ul>

<p><strong>This package is part of the RLum.Network</strong>
</p>

<ul>
<li> <p><a href="https://r-luminescence.org">https://r-luminescence.org</a>
</p>
</li></ul>

<p><strong>Package maintainer</strong>
</p>
<p>Dirk Mittelstraß, Independent researcher, Dresden (Germany),<br />
<a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p><strong>Citation</strong>
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>
<p><strong>Funding</strong>
Dirk Mittelstraß created this package as part of his master thesis and further enhanced and
published it as private endeavour. He did not receive any specific grant from funding agencies
in the public, commercial or not-for-profit sectors.
</p>

<hr>
<h2 id='plot_OSLcurve'>Advanced plot function for component resolved CW-OSL curves</h2><span id='topic+plot_OSLcurve'></span>

<h3>Description</h3>

<p>This function is used for plotting CW-OSL curves and its signal components. It can handle data returned
by <a href="#topic+fit_OSLcurve">fit_OSLcurve</a> or <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>. Besides CW-OSL curves, pseudoLM-OSL curves and
residual plots can also be plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_OSLcurve(
  curve = NULL,
  components = NULL,
  display = "detailed",
  show.legend = TRUE,
  show.intervals = FALSE,
  show.crosssec = FALSE,
  show.initial = FALSE,
  theme.set = ggplot2::theme_classic(),
  title = NULL,
  hide.plot = FALSE,
  filename = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_OSLcurve_+3A_curve">curve</code></td>
<td>
<p><a href="base.html#topic+data.frame">data.frame</a> or <a href="base.html#topic+matrix">matrix</a> or <a href="Luminescence.html#topic+RLum.Data.Curve-class">RLum.Data.Curve</a> (<em>optional</em>):
CW-OSL curve x-Axis: <code style="white-space: pre;">&#8288;$time&#8288;</code> or first column as measurement time (must have constant time intervals);
y-Axis: <code style="white-space: pre;">&#8288;$signal&#8288;</code> or second column as luminescence signal.
Other columns will be plotted as component curves, in case no input object <code>components</code> is defined.
If no input is given, a CW-OSL curve will be simulated with the parameters of <code>components</code></p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_components">components</code></td>
<td>
<p><a href="base.html#topic+data.frame">data.frame</a> (<em>optional</em>):
Table with OSL component parameters. The parameters are used to approximate separate signal decay curves
for each component. Need to have at least the columns: <code style="white-space: pre;">&#8288;$names&#8288;</code>, <code style="white-space: pre;">&#8288;$lambda&#8288;</code> and <code style="white-space: pre;">&#8288;$n&#8288;</code>.
If an insufficient or no input object is provided, the 'curve&ldquo; object will be searched for
component-related signal values.</p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_display">display</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Sets the arrangement of graphs, see section <strong>Details</strong>.</p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_show.legend">show.legend</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Draws a legend in the top right corner of the first graph.</p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_show.intervals">show.intervals</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Draws vertical lines into the residual plot showing the signal bin intervals (if available) for the CW-OSL
decomposition with <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>.</p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_show.crosssec">show.crosssec</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Displays photoionisation cross section values in the component table (if available).</p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_show.initial">show.initial</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Displays signal share at the first channel in the component table (if available).</p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_theme.set">theme.set</code></td>
<td>
<p><a href="ggplot2.html#topic+ggplot2">ggplot2</a> object (<em>with default</em>):
Graphical theme of the output plot. This argument is forwarded to <a href="ggplot2.html#topic+theme_get">ggplot2::theme_set</a>.
Recommended themes are <code>ggplot2::theme_minimal()</code>, <code>ggplot2::theme_classic()</code> and <code>ggplot2::theme_bw()</code>,
see <a href="ggplot2.html#topic+ggtheme">ggplot2::theme_bw</a> or <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">here</a> for
a full list.</p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_title">title</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Plot title. Overwrites automatic titles but affects just the first (upper left)
graph in case of multi-graph display setting.
Set <code>title = NULL</code> for auto-title and <code>title = ""</code> for no title.</p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_hide.plot">hide.plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
If true, plot is not drawn but can still be saved as file or caught by <code>A &lt;- plot_OSLcurve(...)</code>.
If caught, the plot can be drawn manually for example by using <a href="gridExtra.html#topic+arrangeGrob">gridExtra::grid.arrange</a>.</p>
</td></tr>
<tr><td><code id="plot_OSLcurve_+3A_filename">filename</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>):
File name or path to save the plot as image. If just a file name is given, the image is
saved in the working directory. The image type is chosen by the file ending. Both, vector images
as well as pixel images are possible. Allowed are <code>.pdf</code>, <code>.eps</code>, <code>.svg</code> (vector graphics), <code>.jpg</code>, <code>.png</code>, <code>.bmp</code> (pixel graphics)
and more, see <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Change graph types with parameter:</strong> <code>display</code>
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>"detailed"</code> </td><td style="text-align: left;"> (default) Output plot consists of: Linear CW-OSL plot, pseudoLM-OSL plot, residual curve and component table </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"lin"</code> </td><td style="text-align: left;"> Linear CW-OSL plot only </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"compare_lin"</code> </td><td style="text-align: left;"> Linear CW-OSL plot with residual curve below and component table on bottom. Useful if two CW-OSL measurements shall be compared side by side </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"log"</code> </td><td style="text-align: left;"> CW-OSL plot with logarithmic y-Axis and linear x-Axis </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"compare_log"</code> </td><td style="text-align: left;"> CW-OSL plot with logarithmic y-Axis with residual curve below and component table on bottom. Useful if two CW-OSL measurements shall be compared side by side </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"loglog"</code> </td><td style="text-align: left;"> Double-logarithmic CW-OSL plot </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"LM"</code> </td><td style="text-align: left;"> PseudoLM-OSL plot </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"res"</code> </td><td style="text-align: left;"> Plot of residual curve: Measurement minus fitting model </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"tab"</code> </td><td style="text-align: left;"> Table of component parameters as image </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"raw"</code> </td><td style="text-align: left;"> Raw x-y plot without further data
</td>
</tr>

</table>

<p>PseudoLM-OSL curves are created using the transformation described by Bulur (2000).
The stimulation ramp duration is twice the CW-OSL duration.
See Bos and Wallinga (2012) for a detailed explanation and discussion.
</p>


<h3>Value</h3>

<p>An invisible <a href="ggplot2.html#topic+ggplot">ggplot2::ggplot</a> object containing the diagram will returned. &quot;Invisible&quot; means, the no value
will be returned (e.g. no console printout) if the function is not assigned to a variable via <code style="white-space: pre;">&#8288;&lt;-&#8288;</code>.
If the function is assigned, the returned object can be further manipulated by <a href="ggplot2.html#topic+ggplot2-package">ggplot2-package</a> methods
or manually drawn by various functions like for example <a href="gridExtra.html#topic+arrangeGrob">gridExtra::grid.arrange</a>.
</p>


<h3>Last update</h3>

<p>2021-03-29, DM: Hidden output objects are now <a href="ggplot2.html#topic+ggplot2">ggplot2</a> objects if the plot is not a composite diagram
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstraß, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Bos, A. J. J. and Wallinga, J., 2012. How to visualize quartz OSL signal components,
Radiation Measurements, 47(9)
</p>
<p>Bulur, E., 2000. A simple transformation for converting CW-OSL curves to LM-OSL curves,
Radiation Measurements, 32(2)
</p>


<h3>See Also</h3>

<p><a href="#topic+fit_OSLcurve">fit_OSLcurve</a>, [RLum.OSL_decomposition, <a href="#topic+RLum.OSL_global_fitting">RLum.OSL_global_fitting</a>, <a href="#topic+simulate_OSLcomponents">simulate_OSLcomponents</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Set some arbitrary decay parameter for a dim CW-OSL measurement of quartz
components &lt;- data.frame(name = c("fast", "medium", "slow"),
                         lambda = c(2, 0.5, 0.02),
                         n = c(1000, 1000, 10000))

# Simulate a CW-OSL curve including some signal noise
curve &lt;- simulate_OSLcomponents(components, simulate.curve = TRUE, add.poisson.noise = TRUE)

# Display the simulated curve
plot_OSLcurve(curve, components)

</code></pre>

<hr>
<h2 id='plot_PhotoCrosssections'>Plot comparison of CW-OSL component photoionisation cross sections of different models</h2><span id='topic+plot_PhotoCrosssections'></span>

<h3>Description</h3>

<p>This function takes the <code>output.complex = TRUE</code> output of <a href="#topic+fit_OSLcurve">fit_OSLcurve</a> and draws the
photoionisation cross sections of different models in relation to each other.
If a stimulation wavelength between 465 and 480 nm was chosen,
the photoionisation cross sections are also set in relation to literature values
from Singarayer and Bailey (2003), Jain et al. (2003) and Durcan and Duller (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_PhotoCrosssections(
  fit.list,
  stimulation.intensity = NULL,
  stimulation.wavelength = NULL,
  K.selected = NULL,
  title = NULL,
  hide.plot = FALSE,
  filename = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_PhotoCrosssections_+3A_fit.list">fit.list</code></td>
<td>
<p><a href="base.html#topic+list">list</a> (<strong>required</strong>):
Output object of <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>. The object must be created with the setting <code>output.complex = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_PhotoCrosssections_+3A_stimulation.intensity">stimulation.intensity</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>optional</em>):
Intensity of optical stimulation in <em>mW / cm²</em>. Used to calculate the photoionisation cross sections.
If not given, the input value for <a href="#topic+fit_OSLcurve">fit_OSLcurve</a> is used</p>
</td></tr>
<tr><td><code id="plot_PhotoCrosssections_+3A_stimulation.wavelength">stimulation.wavelength</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>optional</em>):
Wavelength of optical stimulation in nm. Used to calculate the photoionisation cross sections.
If not given, the input value for <a href="#topic+fit_OSLcurve">fit_OSLcurve</a> is used</p>
</td></tr>
<tr><td><code id="plot_PhotoCrosssections_+3A_k.selected">K.selected</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>optional</em>):
Draws a red rectangle around the <code>K = K.selected</code> row, thus highlighting the model of choice.</p>
</td></tr>
<tr><td><code id="plot_PhotoCrosssections_+3A_title">title</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Plot title. Set <code>title = NULL</code> for no title.</p>
</td></tr>
<tr><td><code id="plot_PhotoCrosssections_+3A_hide.plot">hide.plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
If true, plot is not drawn but can still be saved as file or caught by <code>A &lt;- plot_PhotoCrosssections(...)</code>.
If caught, the plot can be drawn manually for example by using <a href="gridExtra.html#topic+arrangeGrob">gridExtra::grid.arrange</a>.</p>
</td></tr>
<tr><td><code id="plot_PhotoCrosssections_+3A_filename">filename</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>):
File name or path to save the plot as image. If just a file name is given, the image is
saved in the working directory. The image type is chosen by the file ending. Both, vector images
as well as pixel images are possible. Allowed are <code>.pdf</code>, <code>.eps</code>, <code>.svg</code> (vector graphics),
<code>.jpg</code>, <code>.png</code>, <code>.bmp</code> (pixel graphics) and more, see <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The photoionisation cross section ranges of the reference components are defined as following:
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Component</strong> </td><td style="text-align: left;"> <strong>Lower limit (cm^2)</strong> </td><td style="text-align: left;"> <strong>Upper limit (cm^2)</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
Ultrafast </td><td style="text-align: left;"> 1e-16 </td><td style="text-align: left;"> 1e-15 </td>
</tr>
<tr>
 <td style="text-align: left;">
Fast </td><td style="text-align: left;"> 1.9e-17 </td><td style="text-align: left;"> 3.1e-17 </td>
</tr>
<tr>
 <td style="text-align: left;">
Medium </td><td style="text-align: left;"> 3e-18 </td><td style="text-align: left;"> 9e-18 </td>
</tr>
<tr>
 <td style="text-align: left;">
Slow1 </td><td style="text-align: left;"> 1e-18 </td><td style="text-align: left;"> 1.85e-18 </td>
</tr>
<tr>
 <td style="text-align: left;">
Slow2 </td><td style="text-align: left;"> 1.1e-19 </td><td style="text-align: left;"> 4e-19 </td>
</tr>
<tr>
 <td style="text-align: left;">
Slow3 </td><td style="text-align: left;"> 1e-20 </td><td style="text-align: left;"> 4.67e-20 </td>
</tr>
<tr>
 <td style="text-align: left;">
Slow4 </td><td style="text-align: left;"> 1e-21 </td><td style="text-align: left;"> 1e-20
</td>
</tr>

</table>



<h3>Value</h3>

<p>An invisible <a href="ggplot2.html#topic+ggplot">ggplot2::ggplot</a> object containing the diagram will returned. &quot;Invisible&quot; means, the no value
will be returned (e.g. no console printout) if the function is not assigned to a variable via <code style="white-space: pre;">&#8288;&lt;-&#8288;</code>.
If the function is assigned, the returned object can be further manipulated by <a href="ggplot2.html#topic+ggplot2-package">ggplot2-package</a> methods
or manually drawn by various functions like for example <a href="gridExtra.html#topic+arrangeGrob">gridExtra::grid.arrange</a>.
</p>


<h3>Last updates</h3>

<p>2020-11-04, DM: Added roxygen documentation
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstraß, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Durcan, J.A., Duller, G.A.T., 2011. The fast ratio: A rapid measure for testing the dominance of the fast component in the initial OSL signal from quartz. Radiation Measurements 46, 1065–1072.
</p>
<p>Jain, M., Murray, A.S., Bøtter-Jensen, L., 2003. Characterisation of blue-light stimulated luminescence components in different quartz samples: implications for dose measurement. Radiation Measurements 37, 441–449.
</p>
<p>Singarayer, J.S., Bailey, R.M., 2003. Further investigations of the quartz optically stimulated luminescence components using linear modulation.
Radiation Measurements, Proceedings of the 10th international Conference on Luminescence and Electron-Spin Resonance Dating (LED 2002) 37, 451–458.
</p>


<h3>See Also</h3>

<p><a href="#topic+fit_OSLcurve">fit_OSLcurve</a>, <a href="#topic+RLum.OSL_global_fitting">RLum.OSL_global_fitting</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Set some arbitrary decay parameter for a dim CW-OSL measurement of quartz
name &lt;- c("fast", "slow")
lambda &lt;- c(2, 0.02)
n &lt;- c(1e6, 5e7)

# Build a component table
components &lt;- data.frame(name, lambda, n)

# Simulate the CW-OSL curve and add some signal noise
curve &lt;- simulate_OSLcomponents(components, simulate.curve = TRUE, add.poisson.noise = TRUE)

# Perform nonlinear regression at the simulated curve
fit_results &lt;- fit_OSLcurve(curve, K.max = 2, output.complex = TRUE)

# Plot the fitting iterations and set them into context
plot_PhotoCrosssections(fit_results)


</code></pre>

<hr>
<h2 id='RLum.OSL_correction'>Check and correct CW-OSL curves in RLum.Analysis data sets</h2><span id='topic+RLum.OSL_correction'></span>

<h3>Description</h3>

<p>CW-OSL measurements are often affected by background signals or might be measured under
inconsistent detection settings. This function provides tools
to test and solve some common problems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RLum.OSL_correction(
  object,
  record_type = "OSL",
  background_sequence = NULL,
  subtract_offset = 0,
  check_consistency = TRUE,
  remove_light_off = TRUE,
  limit_duration = 20,
  PMT_pulse_pair_resolution = 18,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RLum.OSL_correction_+3A_object">object</code></td>
<td>
<p><a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> or <a href="base.html#topic+list">list</a> of <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> (<strong>required</strong>):
Data set of one or multiple CW-OSL measured aliquots.</p>
</td></tr>
<tr><td><code id="RLum.OSL_correction_+3A_record_type">record_type</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Type of records selected from the input <code>object</code>, see
<code>object[[]]@records[[]]@recordType</code>. Common are: <code>"OSL"</code>,<code>"SGOSL"</code> or <code>"IRSL"</code>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_correction_+3A_background_sequence">background_sequence</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> vector (<em>optional</em>):
Indices of list items with CW-OSL measurements of empty aliquots.
The records in these list items are used to calculate one average CW-OSL background curve
with <a href="#topic+sum_OSLcurves">sum_OSLcurves</a>. This background curve is subtracted from each
CW-OSL record of the data set. The attributes <code style="white-space: pre;">&#8288;@recordType&#8288;</code> of the background
measurements will be renamed to <code>"{record_type}background"</code>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_correction_+3A_subtract_offset">subtract_offset</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>optional</em>):
Signal offset value in counts per second (<em>cts/s</em>). Value is handled as background
level and will be subtracted from each CW-OSL record.</p>
</td></tr>
<tr><td><code id="RLum.OSL_correction_+3A_check_consistency">check_consistency</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
The CW-OSL component identification and separation procedure requires uniform detection parameters
throughout the whole data set. If <code>TRUE</code>, all records are compared for their
channel width and their number of channels. Those records with the most frequent
set of channel parameters keep their <code style="white-space: pre;">&#8288;@recordType&#8288;</code> attribute, while records
with other sets of measurement parameter will be enumerated <code>record_type</code>
<code>"{record_type}2"</code>, <code>"{record_type}3"</code> and so on.</p>
</td></tr>
<tr><td><code id="RLum.OSL_correction_+3A_remove_light_off">remove_light_off</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Checks if the records contain zero-signal intervals at beginning and/or end of the
measurement and removes them. Useful to tailor single-grain measurements.</p>
</td></tr>
<tr><td><code id="RLum.OSL_correction_+3A_limit_duration">limit_duration</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Reduce measurement duration to input value in seconds (<em>s</em>).
Long measurement duration can lead to over-fitting at the component identification
of Step 1 which may induce systematic errors, see Mittelstrass (2019). Thus, limiting
the OSL record length ensures sufficient accuracy regarding the Fast and Medium component analysis.
If however, slow decaying components are of interest, <code>limit_duration = NA</code> is recommended.</p>
</td></tr>
<tr><td><code id="RLum.OSL_correction_+3A_pmt_pulse_pair_resolution">PMT_pulse_pair_resolution</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Time span of the pulse-pair resolution of the PMT in nanoseconds (<em>ns</em>).
If a value is given, the signal values will be corrected for time-resolution related
non-linearity at height counting rates, see <em>Details</em>.
Set <code>PMT_pulse_pair_resolution = NA</code> if algorithm shall be omitted.</p>
</td></tr>
<tr><td><code id="RLum.OSL_correction_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Enables console text output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function processes data sets created within the <a href="Luminescence.html#topic+Luminescence-package">Luminescence-package</a> (Kreutzer et al. 2012).
Those data sets must be formatted as <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects. Output objects will also be
<a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects and are meant for further analysis with <a href="#topic+RLum.OSL_global_fitting">RLum.OSL_global_fitting</a>.
</p>
<p>The data preparation tools are executed in the following order:
</p>

<ol>
<li><p><code>check_consistency</code>
</p>
</li>
<li><p><code>remove_light_off</code>
</p>
</li>
<li><p><code>limit_duration</code>
</p>
</li>
<li><p><code>PMT_pulse_pair_resolution</code>
</p>
</li>
<li><p><code>background_sequence</code>
</p>
</li>
<li><p><code>subtract_offset</code>
</p>
</li></ol>

<p><strong>Currently, not all functions are available.</strong>
</p>
<p><strong>Details to</strong> <code>remove_light_off</code>:
The algorithm does the following: (1) Create global reference curve with <a href="#topic+sum_OSLcurves">sum_OSLcurves</a>
(2) Search for the maximum in the first half of the reference curve and remove all data points
before the maximum . Do this for all curves of the selected 'record_type'.
(3) Search for an infliction point with
negative curvature (minimum of second differential) in the second half of the reference curve.
If the next data point has at least 50% less signal, remove all data points after the infliction
point. Do this for all curves of the selected 'record_type'.
</p>
<p><strong>Details to</strong> <code>PMT_pulse_pair_resolution</code>:
</p>
<p>The algorithm corrects non-linearity of signal values due to insufficient pulse-pair resolution
of the photo-multiplier tube (PMT). Equation (6-2) of the <em>Hamamatsu Photomultiplier Handbook</em> is used:
</p>
<p style="text-align: center;"><code class="reqn">I_corrected = I_measured / (1 - I_measured * resolution)</code>
</p>

<p>The algorithm does not account for PMT saturation and PMT aging effects.
As default pulse-pair resolution 18 <em>ns</em> is pre-defined, the <em>Hamamatsu</em> H7360 series pulse-pair resolution according to the data sheet.
The H7360-02 is the default PMT in <em>Freiberg Instruments lexsyg</em> OSL/TL readers.
<em>DTU Physics Risoe</em> TL/OSL reader deploy <em>ET Enterprise</em> 9235B series PMTs as default.
For these PMTs, the pulse-pair resolutions is not given in the data sheets and relies on the operation voltage.
However, due to the pulse properties given in the data sheets, it is unlikely
that those PMTs have a better pulse-pair resolution than 18 <em>ns</em>.
</p>
<p><strong>Impact of a pulse-pair resolution correction of 18 ns</strong></p>

<table>
<tr>
 <td style="text-align: left;">
   Measured signal </td><td style="text-align: left;"> Corrected signal </td><td style="text-align: left;"> Signal underestimation </td>
</tr>
<tr>
 <td style="text-align: left;">
   1000 cts/s </td><td style="text-align: left;"> 1000 cts/s </td><td style="text-align: left;"> 0.00 % </td>
</tr>
<tr>
 <td style="text-align: left;">
   10000 cts/s </td><td style="text-align: left;"> 10002 cts/s </td><td style="text-align: left;"> 0.02 % </td>
</tr>
<tr>
 <td style="text-align: left;">
   50000 cts/s </td><td style="text-align: left;"> 50045 cts/s </td><td style="text-align: left;"> 0.09 % </td>
</tr>
<tr>
 <td style="text-align: left;">
   100000 cts/s </td><td style="text-align: left;"> 100180 cts/s </td><td style="text-align: left;"> 0.18 % </td>
</tr>
<tr>
 <td style="text-align: left;">
   500000 cts/s </td><td style="text-align: left;"> 504541 cts/s </td><td style="text-align: left;"> 0.91 % </td>
</tr>
<tr>
 <td style="text-align: left;">
   1000000 cts/s </td><td style="text-align: left;"> 1018330 cts/s </td><td style="text-align: left;"> 1.83 % </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>The input <code>object</code>, a <a href="base.html#topic+list">list</a> of <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects, is given back with eventual changes
in the elements <code>object[[]]@records[[]]@recordType</code> and <code>object[[]]@records[[]]@data</code>.
</p>
<p>The returned data set contains a new list element <code>object[["CORRECTION"]]</code> which provides
a <a href="base.html#topic+list">list</a> of the input parameters and additional data depending on the applied tools.
</p>


<h3>Last updates</h3>

<p>2022-01-02, DM: Revised <code>PMT_pulse_pair_resolution</code> algorithm.
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstrass, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Hamamatsu, 2007. Photomultiplier Tubes: Basics and Applications, Third Edition (Edition 3A).
Hamamatsu Photonics K. K., Hamamatsu City.
</p>
<p>Kreutzer, S., Schmidt, C., Fuchs, M.C., Dietze, M., Fischer, M., Fuchs, M., 2012.
Introducing an R package for luminescence dating analysis. Ancient TL, 30 (1), 1-8.
</p>
<p>Mittelstraß, D., 2019. Decomposition of weak optically stimulated luminescence signals and
its application in retrospective dosimetry at quartz (Master thesis). TU Dresden, Dresden.
</p>


<h3>See Also</h3>

<p><a href="#topic+RLum.OSL_global_fitting">RLum.OSL_global_fitting</a>, <a href="#topic+RLum.OSL_decomposition">RLum.OSL_decomposition</a>, <a href="#topic+sum_OSLcurves">sum_OSLcurves</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 'FB_10Gy' is a dose recovery test with the Fontainebleau quartz
# measured with a lexsyg research with green LED stimulation
data_path &lt;- system.file("examples", "FB_10Gy_SAR.bin", package = "OSLdecomposition")
data_set &lt;- Luminescence::read_BIN2R(data_path, fastForward = TRUE)

# To correct for the background signal, subtracted the average curve from the
# OSL curves of an empty aliquot (list item 11) from all other OSL records:
data_set_corrected &lt;- RLum.OSL_correction(data_set, background = 11, remove_light_off = FALSE)


# Plot background corrected global average CW-OSL curve
sum_OSLcurves(data_set_corrected, output.plot = TRUE, record_type = "OSL")

# Plot background curve
sum_OSLcurves(data_set_corrected, output.plot = TRUE, record_type = "OSLbackground")


</code></pre>

<hr>
<h2 id='RLum.OSL_decomposition'>Separate CW-OSL components in RLum.Analysis data sets</h2><span id='topic+RLum.OSL_decomposition'></span>

<h3>Description</h3>

<p>Calculates the CW-OSL signal component intensities for each CW-OSL measurement
under the requirement that the decay rates are already given. The signal decomposition
process uses an analytical approach described in detail in Mittelstrass (2019) and
Mittelstrass et al. (in preparation). This function processes <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> data sets created within
the <a href="Luminescence.html#topic+Luminescence-package">Luminescence-package</a> (Kreutzer et al. 2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RLum.OSL_decomposition(
  object,
  record_type = "OSL",
  K = 3,
  decay_rates = NULL,
  report = FALSE,
  report_dir = NULL,
  image_format = "pdf",
  open_report = TRUE,
  rmd_path = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RLum.OSL_decomposition_+3A_object">object</code></td>
<td>
<p><a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> or <a href="base.html#topic+list">list</a> of <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> (<strong>required</strong>):
Data set of one or multiple CW-OSL measured aliquots. The data set must either
contain a list element <code style="white-space: pre;">&#8288;$OSL_COMPONENTS&#8288;</code> or the parameter <code>decay_rates</code> must
be defined.</p>
</td></tr>
<tr><td><code id="RLum.OSL_decomposition_+3A_record_type">record_type</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Type of records, selected by the <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> attribute <code style="white-space: pre;">&#8288;@recordType&#8288;</code>.
Common are: <code>"OSL"</code>,<code>"SGOSL"</code> or <code>"IRSL"</code>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_decomposition_+3A_k">K</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Number of components. Selects the according result table in the <code style="white-space: pre;">&#8288;$OSL_COMPONENTS&#8288;</code> list item of the data set <code>object</code>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_decomposition_+3A_decay_rates">decay_rates</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> vector or <a href="base.html#topic+data.frame">data.frame</a> (<em>optional</em>):
User-defined component decay rates. If this parameter is defined, the parameter <code>K</code> will ignored.
If the input object is a <a href="base.html#topic+data.frame">data.frame</a>, then the decay rates must be stored in the column <code style="white-space: pre;">&#8288;$lambda&#8288;</code>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_decomposition_+3A_report">report</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Creates a <code>html</code> report, saves it in the <code>report_dir</code> directory.
The report contains the results and detailed information on the data processing.</p>
</td></tr>
<tr><td><code id="RLum.OSL_decomposition_+3A_report_dir">report_dir</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>):
Path of output directory if <code>report = TRUE</code>. If <code>report_dir = NULL</code> (default),
a temporary folder is used which is deleted when the R session is closed.
File paths are also allowed as parameter, then a new directory named after the OSL data file
will be created.</p>
</td></tr>
<tr><td><code id="RLum.OSL_decomposition_+3A_image_format">image_format</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Image format of the automatically saved graphs if <code>report = TRUE</code> and <code>report_dir</code> is set.
Allowed are <code>.pdf</code>, <code>.eps</code>, <code>.svg</code> (vector graphics), <code>.jpg</code>, <code>.png</code>, <code>.bmp</code> (pixel graphics)
and more, see <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a>. The images are saved in the <code>report_dir</code> subfolder <code style="white-space: pre;">&#8288;/report_figures&#8288;</code>.
Set <code>image_format = NULL</code> if no images shall be saved.</p>
</td></tr>
<tr><td><code id="RLum.OSL_decomposition_+3A_open_report">open_report</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
If set to <code>TRUE</code> a browser window displaying the report will be opened automatically.</p>
</td></tr>
<tr><td><code id="RLum.OSL_decomposition_+3A_rmd_path">rmd_path</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
<strong>For advanced users:</strong> File path to the <a href="rmarkdown.html#topic+rmarkdown">rmarkdown</a> source code file of the report.
This allows to execute a manipulated version of the report.</p>
</td></tr>
<tr><td><code id="RLum.OSL_decomposition_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Enables console text output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The workflow of this function is as follows:
</p>

<ol>
<li> <p><a href="#topic+optimise_OSLintervals">optimise_OSLintervals</a>: Approximates the optimal integration intervals. Uses the global
average curve as time axis template. If none global average curve is given, one is automatically created using <a href="#topic+sum_OSLcurves">sum_OSLcurves</a>.
</p>
</li>
<li> <p><a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>: Calculates component intensities for <strong>all</strong> <code>record_type</code> measurements.
Uses the <code>"det"</code> algorithm if a background correction was performed with <a href="#topic+RLum.OSL_correction">RLum.OSL_correction</a> or the
<code>"det+nls"</code> algorithm if no background correction was performed. For error estimation, the <code>"empiric"</code> approach is used.
</p>
</li>
<li><p> Creates a <code>html</code> report to summarize the results (<em>optional</em>).
</p>
</li></ol>

<p>Data sets must be formatted as <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects and
should have been processed with <a href="#topic+RLum.OSL_correction">RLum.OSL_correction</a> and <a href="#topic+RLum.OSL_global_fitting">RLum.OSL_global_fitting</a> beforehand.
Output objects are also <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects and are
meant for equivalent dose determination with <a href="Luminescence.html#topic+analyse_SAR.CWOSL">Luminescence::analyse_SAR.CWOSL</a>.
</p>
<p>If <code>report = TRUE</code>, a <code>html</code> report of the results is rendered by the <a href="rmarkdown.html#topic+rmarkdown-package">rmarkdown-package</a>
and saved in the working directory, which is usually the directory of the data file.
This report can be displayed, shared and published online without any requirements regarding
the operation system or installed software. However, an internet connection is needed to display
the <em>MathJax</em> encoded equations and special characters.
The <em>Rmarkdown</em> source code of the report can be found with the following command:
</p>
<p><code>system.file("rmd", "report_Step2.Rmd", package = "OSLdecomposition")</code>
</p>


<h3>Value</h3>

<p>The input <code>object</code>, a <a href="base.html#topic+list">list</a> of <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects is returned but with
a new list element <code>object[["DECOMPOSITION"]]</code>, containing:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;$decompositon.input&#8288;</code> <a href="base.html#topic+data.frame">data.frame</a>: Set of input components. Relevant is just the column <code style="white-space: pre;">&#8288;$lambda&#8288;</code>
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$results&#8288;</code> <a href="base.html#topic+data.frame">data.frame</a>: Overview table of decomposition
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$parameters&#8288;</code> <a href="base.html#topic+list">list</a>: Input and algorithm parameters
</p>
</li></ul>

<p>The <a href="Luminescence.html#topic+RLum.Data.Curve-class">RLum.Data.Curve</a> attribute <code style="white-space: pre;">&#8288;@info&#8288;</code> of each CW-OSL record contains the
new entry <code style="white-space: pre;">&#8288;$COMPONENTS&#8288;</code> with the curve-individual signal component parameters.
It can be read for example by:
</p>
<p><code>object[[i]]@records[[j]]@info[["COMPONENTS"]]</code>
</p>


<h3>Last updates</h3>

<p>2022-05-02, DM: Added new parameter <code>open_report</code> to give control over automatic browser opening
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstrass, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Kreutzer, S., Schmidt, C., Fuchs, M.C., Dietze, M., Fischer, M., Fuchs, M., 2012.
Introducing an R package for luminescence dating analysis. Ancient TL, 30 (1), 1-8.
</p>
<p>Mittelstraß, D., 2019. Decomposition of weak optically stimulated luminescence signals and
its application in retrospective dosimetry at quartz (Master thesis). TU Dresden, Dresden.
</p>


<h3>See Also</h3>

<p><a href="#topic+RLum.OSL_global_fitting">RLum.OSL_global_fitting</a>, <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>, <a href="#topic+optimise_OSLintervals">optimise_OSLintervals</a>, <a href="Luminescence.html#topic+analyse_SAR.CWOSL">Luminescence::analyse_SAR.CWOSL</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#'FB_10Gy' is a dose recovery test with the Fontainebleau quartz
# measured in a lexsyg research with green LED stimulation
data_path &lt;- system.file("examples", "FB_10Gy_SAR.bin", package = "OSLdecomposition")
data_set &lt;- Luminescence::read_BIN2R(data_path, fastForward = TRUE)

# Separate components
data_set_decomposed &lt;- RLum.OSL_decomposition(
data_set, decay_rates = c(0.8, 0.05))

</code></pre>

<hr>
<h2 id='RLum.OSL_global_fitting'>Identify CW-OSL signal components in RLum.Analysis data sets</h2><span id='topic+RLum.OSL_global_fitting'></span>

<h3>Description</h3>

<p>First, all CW-OSL records are combined to one global average CW-OSL curve,
then the multi-exponential fitting approach of Bluszcz and Adamiec (2006) is applied.
This function processes <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> data sets created within
the <a href="Luminescence.html#topic+Luminescence-package">Luminescence-package</a> (Kreutzer et al. 2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RLum.OSL_global_fitting(
  object,
  record_type = "OSL",
  K_maximum = 5,
  F_threshold = 150,
  stimulation_intensity = 35,
  stimulation_wavelength = 470,
  report = FALSE,
  report_dir = NULL,
  image_format = "pdf",
  open_report = TRUE,
  rmd_path = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RLum.OSL_global_fitting_+3A_object">object</code></td>
<td>
<p><a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> or <a href="base.html#topic+list">list</a> of <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> (<strong>required</strong>):
Data set of one or multiple CW-OSL measured aliquots.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_record_type">record_type</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Type of records, selected by the <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> attribute <code style="white-space: pre;">&#8288;@recordType&#8288;</code>.
Common are: <code>"OSL"</code>,<code>"SGOSL"</code> or <code>"IRSL"</code>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_k_maximum">K_maximum</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Maximum number of components <em>K</em>, see <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_f_threshold">F_threshold</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Fitting stop criterion, see <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_stimulation_intensity">stimulation_intensity</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Intensity of optical stimulation in <em>mW / cm²</em>. Used to calculate photo-ionisation cross-sections, see <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_stimulation_wavelength">stimulation_wavelength</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Wavelength of optical stimulation in <em>nm</em>. Used to calculate photo-ionisation cross-sections, see <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_report">report</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Creates a <code>html</code> report, saves it in the <code>report_dir</code> directory.
The report contains the results and detailed information on the data processing.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_report_dir">report_dir</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>):
Path of output directory if <code>report = TRUE</code>. If <code>report_dir = NULL</code> (default),
a temporary folder is used which is deleted when the R session is closed.
File paths are also allowed as parameter, then a new directory named after the OSL data file
will be created.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_image_format">image_format</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Image format of the automatically saved graphs if <code>report = TRUE</code> and <code>report_dir</code> is set.
Allowed are <code>.pdf</code>, <code>.eps</code>, <code>.svg</code> (vector graphics), <code>.jpg</code>, <code>.png</code>, <code>.bmp</code> (pixel graphics)
and more, see <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a>. The images are saved in the <code>report_dir</code> subfolder <code style="white-space: pre;">&#8288;/report_figures&#8288;</code>.
Set <code>image_format = NULL</code> if no images shall be saved.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_open_report">open_report</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
If set to <code>TRUE</code> a browser window displaying the report will be opened automatically.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_rmd_path">rmd_path</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
<strong>For advanced users:</strong> File path to the <a href="rmarkdown.html#topic+rmarkdown">rmarkdown</a> source code file of the report.
This allows to execute manipulated versions of the report.</p>
</td></tr>
<tr><td><code id="RLum.OSL_global_fitting_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Enables console text output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The workflow of this function is as follows:
</p>

<ol>
<li> <p><a href="#topic+sum_OSLcurves">sum_OSLcurves</a>: Combine all measurements of type <code>record_type</code> to one global average curve.
</p>
</li>
<li> <p><a href="#topic+fit_OSLcurve">fit_OSLcurve</a>: Identify OSL components by a multi-exponential fitting.
</p>
</li>
<li><p> Create a <code>html</code> report to summarize the results (<em>optional</em>).
</p>
</li></ol>

<p>Data sets must be formatted as <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects and
should have been processed with <a href="#topic+RLum.OSL_correction">RLum.OSL_correction</a> beforehand.
Output objects are also <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects and are
meant for further analysis with <a href="#topic+RLum.OSL_decomposition">RLum.OSL_decomposition</a>.
</p>
<p>If <code>report = TRUE</code>, a <code>html</code> report of the results is rendered by the <a href="rmarkdown.html#topic+rmarkdown-package">rmarkdown-package</a>
and saved in the working directory, which is usually the directory of the data file.
This report can be displayed, shared and published online without any requirements to
the operation system or installed software. However, an internet connection is needed to display
the <em>MathJax</em> encoded equations and special characters.
The <em>Rmarkdown</em> source code of the report can be found with the following command:
</p>
<p><code>system.file("rmd", "report_Step1.Rmd", package = "OSLdecomposition")</code>
</p>


<h3>Value</h3>

<p>The input <code>object</code>, a <a href="base.html#topic+list">list</a> of <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects is returned but with
a new list element <code>object[["OSL_COMPONENTS"]]</code>, containing:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;$decay.rates&#8288;</code> <a href="base.html#topic+numeric">numeric</a> vector: Decay rates of F-test recommendation or last successful fitting.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$K.selected&#8288;</code> <a href="base.html#topic+numeric">numeric</a>: Number of components of F-test recommendation or last successful fitting.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$F.test&#8288;</code> <a href="base.html#topic+data.frame">data.frame</a>: F-test table.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$F.test.print&#8288;</code> <a href="base.html#topic+data.frame">data.frame</a>: F-test table but formatted for console output and display with <a href="knitr.html#topic+kable">knitr::kable</a>.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$info.text&#8288;</code> <a href="base.html#topic+list">list</a>: Short process log.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$component.tables&#8288;</code> <a href="base.html#topic+list">list</a> of <a href="base.html#topic+data.frame">data.frame</a>s: Signal component tables for all curve models.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$curve&#8288;</code> <a href="base.html#topic+list">list</a>: Global average curve created from all  <code>record_type</code> curves in the data set.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$components&#8288;</code> <a href="base.html#topic+data.frame">data.frame</a>: Signal component table of F-test recommendation or last successful fitting.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$fit.results&#8288;</code> <a href="base.html#topic+list">list</a>: Returned fitting objects of <a href="DEoptim.html#topic+DEoptim">DEoptim::DEoptim</a> and <a href="minpack.lm.html#topic+nlsLM">minpack.lm::nlsLM</a> for all curve models.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$plot.data&#8288;</code> <a href="base.html#topic+data.frame">data.frame</a>: Model overview table for photo-ionisation cross-section plotting with <a href="#topic+plot_PhotoCrosssections">plot_PhotoCrosssections</a>.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$parameters&#8288;</code> <a href="base.html#topic+list">list</a>: Input and algorithm parameters.
</p>
</li></ul>



<h3>Last updates</h3>

<p>2022-05-02, DM: Added new parameter <code>open_report</code> to give control over automatic browser opening
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstrass, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Bluszcz, A., Adamiec, G., 2006. Application of differential evolution to fitting OSL
decay curves. Radiation Measurements 41, 886–891.
</p>
<p>Kreutzer, S., Schmidt, C., Fuchs, M.C., Dietze, M., Fischer, M., Fuchs, M., 2012.
Introducing an R package for luminescence dating analysis. Ancient TL, 30 (1), 1-8.
</p>


<h3>See Also</h3>

<p><a href="#topic+RLum.OSL_correction">RLum.OSL_correction</a>, <a href="#topic+RLum.OSL_decomposition">RLum.OSL_decomposition</a>, <a href="#topic+sum_OSLcurves">sum_OSLcurves</a>, <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 'FB_10Gy' is a dose recovery test with the Fontainebleau quartz
# measured in a lexsyg research with green LED stimulation
data_path &lt;- system.file("examples", "FB_10Gy_SAR.bin", package = "OSLdecomposition")
data_set &lt;- Luminescence::read_BIN2R(data_path, fastForward = TRUE)

# Check data set and perform background correction
data_set_corrected &lt;- RLum.OSL_correction(data_set,
 background = 11,
 remove_light_off = FALSE)

# Identify components
data_set_fitted &lt;- RLum.OSL_global_fitting(
 data_set_corrected,
 K_maximum = 2,
 stimulation_intensity = 50,
 stimulation_wavelength = 530)


</code></pre>

<hr>
<h2 id='simulate_OSLcomponents'>Simulates signal component decay curves and whole CW-OSL curves</h2><span id='topic+simulate_OSLcomponents'></span>

<h3>Description</h3>

<p>This function builds a bulk CW-OSL curve and CW-OSL component decay curves from OSL component parameters.
Therewith it supports <a href="#topic+fit_OSLcurve">fit_OSLcurve</a>, <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a> and <a href="#topic+plot_OSLcurve">plot_OSLcurve</a> by providing model and residual curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_OSLcomponents(
  components,
  curve = NULL,
  channel.width = 0.1,
  channel.number = 400,
  simulate.curve = FALSE,
  add.poisson.noise = TRUE,
  add.gaussian.noise = 0,
  add.background = 0,
  round.values = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_OSLcomponents_+3A_components">components</code></td>
<td>
<p><a href="base.html#topic+data.frame">data.frame</a> (<strong>required</strong>):
Table with component parameters. The table requires columns <code style="white-space: pre;">&#8288;$names&#8288;</code>, <code style="white-space: pre;">&#8288;$lambda&#8288;</code> and <code style="white-space: pre;">&#8288;$n&#8288;</code>, see section <strong>Examples</strong>.</p>
</td></tr>
<tr><td><code id="simulate_OSLcomponents_+3A_curve">curve</code></td>
<td>
<p><a href="base.html#topic+data.frame">data.frame</a> (<em>optional</em>):
CW-OSL curve serving as template for the time axis. The input table requires a column <code style="white-space: pre;">&#8288;$time&#8288;</code>.
If no input object is given or the object contains no column <code style="white-space: pre;">&#8288;$signal&#8288;</code>,
<code>simulate.curve</code> will be set <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulate_OSLcomponents_+3A_channel.width">channel.width</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>optional</em>):
Channel width in seconds. Necessary for curve simulation if <code>curve</code> is not given.</p>
</td></tr>
<tr><td><code id="simulate_OSLcomponents_+3A_channel.number">channel.number</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>optional</em>):
Number of channels resp. data points. Necessary for curve simulation if <code>curve</code> is not given.</p>
</td></tr>
<tr><td><code id="simulate_OSLcomponents_+3A_simulate.curve">simulate.curve</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Decides if the bulk CW-OSL signal shall be calculated from the component parameter.
If <code>FALSE</code>, the output curve will take over the column <code style="white-space: pre;">&#8288;$signal&#8288;</code> from the input <code>curve</code>.
If <code>TRUE</code>, a new column <code style="white-space: pre;">&#8288;$signal&#8288;</code> will be created which is the sum of all component curves.</p>
</td></tr>
<tr><td><code id="simulate_OSLcomponents_+3A_add.poisson.noise">add.poisson.noise</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Adds poisson distributed shot noise to <code style="white-space: pre;">&#8288;$signal&#8288;</code> if <code>simulate.curve = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulate_OSLcomponents_+3A_add.gaussian.noise">add.gaussian.noise</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Standard deviation of the detector noise in <em>cts/s</em>, added to <code style="white-space: pre;">&#8288;$signal&#8288;</code> if <code>simulate.curve = TRUE</code>.</p>
</td></tr>
<tr><td><code id="simulate_OSLcomponents_+3A_add.background">add.background</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
signal background level in <em>cts/s</em>, added to <code style="white-space: pre;">&#8288;$signal&#8288;</code> if <code>simulate.curve = TRUE</code></p>
</td></tr>
<tr><td><code id="simulate_OSLcomponents_+3A_round.values">round.values</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Rounds <code style="white-space: pre;">&#8288;$signal&#8288;</code> values to integers if <code>simulate.curve = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="base.html#topic+data.frame">data.frame</a> of a CW-OSL curve with the columns: <code style="white-space: pre;">&#8288;$time&#8288;</code>, <code style="white-space: pre;">&#8288;$signal&#8288;</code>, <code style="white-space: pre;">&#8288;$residual&#8288;</code>, <code style="white-space: pre;">&#8288;$sum&#8288;</code>
and a signal decay curve for each single component named after the entries in the column <code>components$names</code>
of the input object.
</p>


<h3>Last updates</h3>

<p>2020-10-30, DM: Renamed from <em>simulate_OSLcurve</em> to <em>simulate_OSLcomponents</em>;
Renamed argument from <em>template.curve</em> to <em>curve</em>; Rewrote roxygen documentation
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstraß, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>References</h3>

<p>Mittelstraß, D., 2019. Decomposition of weak optically stimulated luminescence signals and its application in retrospective dosimetry at quartz (Master thesis). TU Dresden, Dresden.
</p>


<h3>See Also</h3>

<p><a href="#topic+fit_OSLcurve">fit_OSLcurve</a>, <a href="#topic+decompose_OSLcurve">decompose_OSLcurve</a>, <a href="#topic+plot_OSLcurve">plot_OSLcurve</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Set some arbitrary decay parameter for a dim CW-OSL measurement of quartz
components &lt;- data.frame(name = c("fast", "medium", "slow"),
                         lambda = c(2, 0.5, 0.02),
                         n = c(1000, 1000, 10000))

# Simulate the CW-OSL curve and add some signal noise
curve &lt;- simulate_OSLcomponents(components, simulate.curve = TRUE, add.poisson.noise = TRUE)

# Display the simulated curve
plot_OSLcurve(curve, components)

</code></pre>

<hr>
<h2 id='sum_OSLcurves'>Combine RLum OSL records to one global average curve</h2><span id='topic+sum_OSLcurves'></span>

<h3>Description</h3>

<p>This function adds up all CW-OSL records of the same type saved in <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects and
calculates the arithmetic mean signal from all records for each channel.
This is useful to create global average curve with sufficient signal-to-noise ratio
for OSL components identification with <a href="#topic+fit_OSLcurve">fit_OSLcurve</a> or to create a signal background
reference curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_OSLcurves(
  object,
  record_type = "OSL",
  aliquot_selection = NULL,
  offset_value = 0,
  verbose = TRUE,
  output.plot = FALSE,
  theme.set = ggplot2::theme_classic(),
  plot.first = FALSE,
  title = "default",
  filename = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sum_OSLcurves_+3A_object">object</code></td>
<td>
<p><a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> or <a href="base.html#topic+list">list</a> of <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> (<strong>required</strong>):
Data set of one or multiple aliquots containing CW-OSL records.</p>
</td></tr>
<tr><td><code id="sum_OSLcurves_+3A_record_type">record_type</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Type of records which are selected from the input <code>object</code>,
for example: <code>"OSL"</code>,<code>"SGOSL"</code> or <code>"IRSL"</code>.</p>
</td></tr>
<tr><td><code id="sum_OSLcurves_+3A_aliquot_selection">aliquot_selection</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> vector (<em>optional</em>):
Vector specifying the indices of elements (aliquots) of a list of <a href="Luminescence.html#topic+RLum.Analysis-class">RLum.Analysis</a> objects
which shall be included.</p>
</td></tr>
<tr><td><code id="sum_OSLcurves_+3A_offset_value">offset_value</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>):
Signal offset (background) which will be subtracted from each record.</p>
</td></tr>
<tr><td><code id="sum_OSLcurves_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Enables console text output.</p>
</td></tr>
<tr><td><code id="sum_OSLcurves_+3A_output.plot">output.plot</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
returns a plot with all data points of all records and the average curve</p>
</td></tr>
<tr><td><code id="sum_OSLcurves_+3A_theme.set">theme.set</code></td>
<td>
<p><a href="ggplot2.html#topic+ggplot2">ggplot2</a> object (<em>with default</em>):
sets the graphical theme of the output plot.
See <a href="ggplot2.html#topic+ggtheme">ggplot2::theme_bw</a> for available themes</p>
</td></tr>
<tr><td><code id="sum_OSLcurves_+3A_plot.first">plot.first</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>):
Plot includes additional drawing of first <code>record_type</code> record of first <code>object</code> list element.</p>
</td></tr>
<tr><td><code id="sum_OSLcurves_+3A_title">title</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>):
Plot title. Set <code>title = "default"</code> for an automatically generated title.
Set <code>title = NULL</code> for no title.</p>
</td></tr>
<tr><td><code id="sum_OSLcurves_+3A_filename">filename</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>):
File name or path to save the plot as image. If just a file name is given, the image is
saved in the working directory. The image type is chosen by the file ending. Both, vector images
as well as pixel images are possible. Allowed are <code>.pdf</code>, <code>.eps</code>, <code>.svg</code> (vector graphics),
<code>.jpg</code>, <code>.png</code>, <code>.bmp</code> (pixel graphics) and more, see <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="base.html#topic+data.frame">data.frame</a> of the average CW-OSL curve is returned, containing two columns: <code style="white-space: pre;">&#8288;$time&#8288;</code> and <code style="white-space: pre;">&#8288;$signal&#8288;</code>.
</p>


<h3>Last updates</h3>

<p>2020-10-30, DM: Overworked plotting; Expanded roxygen documentation
</p>


<h3>Author(s)</h3>

<p>Dirk Mittelstraß, <a href="mailto:dirk.mittelstrass@luminescence.de">dirk.mittelstrass@luminescence.de</a>
</p>
<p>Please cite the package the following way:
</p>
<p>Mittelstraß, D., Schmidt, C., Beyer, J., Heitmann, J. and Straessner, A.:
R package OSLdecomposition: Automated identification and separation of quartz CW-OSL signal components, <em>in preparation</em>.
</p>


<h3>See Also</h3>

<p><a href="#topic+fit_OSLcurve">fit_OSLcurve</a>, <a href="#topic+RLum.OSL_correction">RLum.OSL_correction</a>, <a href="#topic+RLum.OSL_global_fitting">RLum.OSL_global_fitting</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 'FB_10Gy' is a dose recovery test with the Fontainebleau quartz
# measured in a lexsyg research with green LED stimulation
data_path &lt;- system.file("examples", "FB_10Gy_SAR.bin", package = "OSLdecomposition")
data_set &lt;- Luminescence::read_BIN2R(data_path, fastForward = TRUE)

# Give average CW-OSL curve back
average_curve &lt;- sum_OSLcurves(data_set)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
