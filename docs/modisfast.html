<!DOCTYPE html><html lang="en-US"><head><title>Help for package modisfast</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {modisfast}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#modisfast-package'><p>modisfast: Fast and Efficient Access to MODIS Earth Observation Data</p></a></li>
<li><a href='#entomological_data'><p>Example dataset containing abundances of mosquitoes vectors of malaria. Used in article 'use_case'.</p></a></li>
<li><a href='#mf_download_data'><p>Download several datasets given their URLs and destination path</p></a></li>
<li><a href='#mf_get_opt_param'><p>Precompute the parameter <code>opt_param</code> of the function mf_get_url</p></a></li>
<li><a href='#mf_get_url'><p>Build the URL(s) of the data to download</p></a></li>
<li><a href='#mf_import_data'><p>Import datasets downloaded using <code>modisfast</code> as a <code>terra::SpatRaster</code> object</p></a></li>
<li><a href='#mf_list_collections'><p>Get the collections available for download with the <code>modisfast</code> package</p></a></li>
<li><a href='#mf_list_variables'><p>Get information for the variables (bands) available for a given collection</p></a></li>
<li><a href='#mf_login'><p>Login to EOSDIS EarthData account</p></a></li>
<li><a href='#mf_modisfast'><p>Download (and possibly import) MODIS, VIIRS and GPM</p>
Earth Observation data</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Fast and Efficient Access to MODIS Earth Observation Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Programmatic interface to several NASA Earth Observation 'OPeNDAP' servers (Open-source Project for a Network Data Access Protocol) (<a href="https://www.opendap.org/">https://www.opendap.org/</a>). Allows for easy downloads of MODIS subsets, as well as other Earth Observation datacubes, in a time-saving and efficient way : by sampling it at the very downloading phase (spatially, temporally and dimensionally).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ptaconet/modisfast">https://github.com/ptaconet/modisfast</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ptaconet/modisfast/issues">https://github.com/ptaconet/modisfast/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>curl, dplyr, httr, lubridate, magrittr, parallel, purrr,
rvest, sf, stats, stringr, terra, xml2, cli</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, knitr, mapview, rmarkdown, spelling, testthat,
appeears</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Config/testthat/start-first:</td>
<td>mf_login, mf_list_collections,
mf_list_variables, mf_get_url, mf_download_data, mf_import_data</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-12 14:23:19 UTC; ptaconet</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Taconet <a href="https://orcid.org/0000-0001-7429-7204"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Nicolas Moiroux <a href="https://orcid.org/0000-0001-6755-6167"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [fnd],
  French National Research Institute for Sustainable Development, IRD
    [fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Taconet &lt;paul.taconet@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-12 15:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='modisfast-package'>modisfast: Fast and Efficient Access to MODIS Earth Observation Data</h2><span id='topic+modisfast'></span><span id='topic+modisfast-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Programmatic interface to several NASA Earth Observation 'OPeNDAP' servers (Open-source Project for a Network Data Access Protocol) (<a href="https://www.opendap.org/">https://www.opendap.org/</a>). Allows for easy downloads of MODIS subsets, as well as other Earth Observation datacubes, in a time-saving and efficient way : by sampling it at the very downloading phase (spatially, temporally and dimensionally).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Paul Taconet <a href="mailto:paul.taconet@gmail.com">paul.taconet@gmail.com</a> (<a href="https://orcid.org/0000-0001-7429-7204">ORCID</a>) [copyright holder]
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Nicolas Moiroux <a href="mailto:nicolas.moiroux@ird.fr">nicolas.moiroux@ird.fr</a> (<a href="https://orcid.org/0000-0001-6755-6167">ORCID</a>) [funder]
</p>
</li>
<li><p> French National Research Institute for Sustainable Development, IRD [funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ptaconet/modisfast">https://github.com/ptaconet/modisfast</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ptaconet/modisfast/issues">https://github.com/ptaconet/modisfast/issues</a>
</p>
</li></ul>


<hr>
<h2 id='entomological_data'>Example dataset containing abundances of mosquitoes vectors of malaria. Used in article 'use_case'.</h2><span id='topic+entomological_data'></span>

<h3>Description</h3>

<p>Example dataset containing abundances of mosquitoes vectors of malaria. Used in article 'use_case'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>entomological_data
</code></pre>


<h3>Format</h3>

<p>## 'entomological_data'
A data frame with 232 rows and 6 columns:
</p>

<dl>
<dt>mission</dt><dd><p>number of the entomological survey</p>
</dd>
<dt>date</dt><dd><p>date of the survey</p>
</dd>
<dt>village</dt><dd><p>3-digit code for the village of the survey</p>
</dd>
<dt>X, Y</dt><dd><p>longitude and latitude of the center of the village</p>
</dd>
<dt>n</dt><dd><p>number of mosquitoes collected</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://doi.org/10.15468/v8fvyn&gt;
</p>

<hr>
<h2 id='mf_download_data'>Download several datasets given their URLs and destination path</h2><span id='topic+mf_download_data'></span>

<h3>Description</h3>

<p>This function enables to download datasets. In a data import workflow, this function is typically used after a call to the <a href="#topic+mf_get_url">mf_get_url</a> function. The output value of <a href="#topic+mf_get_url">mf_get_url</a> can be used as input of parameter <code>df_to_dl</code> of <a href="#topic+mf_download_data">mf_download_data</a>.
</p>
<p>The download can the parallelized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mf_download_data(
  df_to_dl,
  path = tempfile("modisfast_"),
  parallel = FALSE,
  num_workers = parallel::detectCores() - 1,
  credentials = NULL,
  verbose = "inform",
  min_filesize = 5000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mf_download_data_+3A_df_to_dl">df_to_dl</code></td>
<td>
<p>data.frame. Urls and destination files of dataset to download. Typically output of <a href="#topic+mf_get_url">mf_get_url</a>. See Details for the structure</p>
</td></tr>
<tr><td><code id="mf_download_data_+3A_path">path</code></td>
<td>
<p>string. Target folder for the data to download. Default : temporary folder.</p>
</td></tr>
<tr><td><code id="mf_download_data_+3A_parallel">parallel</code></td>
<td>
<p>boolean. Parallelize the download ? Default to FALSE</p>
</td></tr>
<tr><td><code id="mf_download_data_+3A_num_workers">num_workers</code></td>
<td>
<p>integer. Number of workers in case of parallel download. Default to number of workers available in the machine minus one.</p>
</td></tr>
<tr><td><code id="mf_download_data_+3A_credentials">credentials</code></td>
<td>
<p>vector string of length 2 with username and password. optional if the function <a href="#topic+mf_login">mf_login</a> was previously executed.</p>
</td></tr>
<tr><td><code id="mf_download_data_+3A_verbose">verbose</code></td>
<td>
<p>string. Verbose mode (&quot;quiet&quot;, &quot;inform&quot;, or &quot;debug&quot;). Default &quot;inform&quot;.</p>
</td></tr>
<tr><td><code id="mf_download_data_+3A_min_filesize">min_filesize</code></td>
<td>
<p>integer. Minimum file size expected (in bites) for one file downloaded. If files downloaded are less that this value, the files will be downloaded again. Default 5000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameter <code>df_to_dl</code> must be a data.frame with the following minimal structure :
</p>

<dl>
<dt>id_roi</dt><dd><p>An id for the ROI (character string)</p>
</dd>
<dt>collection</dt><dd><p>Collection (character string)</p>
</dd>
<dt>name</dt><dd></dd>
<dt>url</dt><dd><p>URL of the file to download (character string)</p>
</dd>
</dl>



<h3>Value</h3>

<p>a data.frame with the same structure of the input data.frame <code>df_to_dl</code> + columns providing details of the data downloaded. The additional columns are :
</p>

<dl>
<dt>fileDl</dt><dd><p>Booloean (dataset downloaded or failure)</p>
</dd>
<dt>dlStatus</dt><dd><p>Download status : 1 = download ok ; 2 = download error ; 3 = dataset was already existing in destination file </p>
</dd>
<dt>fileSize</dt><dd><p>File size on disk (in bites)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

### Login to EOSDIS Earthdata with your username and password
log &lt;- mf_login(credentials = c("earthdata_un", "earthdata_pw"))

### Set-up parameters of interest
coll &lt;- "MOD11A1.061"

bands &lt;- c("LST_Day_1km", "LST_Night_1km")

time_range &lt;- as.Date(c("2017-01-01", "2017-01-30"))

roi &lt;- sf::st_as_sf(
  data.frame(
    id = "roi_test",
    geom = "POLYGON ((-5.82 9.54, -5.42 9.55, -5.41 8.84, -5.81 8.84, -5.82 9.54))"
  ),
  wkt = "geom", crs = 4326
)

### Get the URLs of the data
(urls_mod11a1 &lt;- mf_get_url(
  collection = coll,
  variables = bands,
  roi = roi,
  time_range = time_range
))

### Download the data
res_dl &lt;- mf_download_data(urls_mod11a1)

### Import the data as terra::SpatRast
modis_ts &lt;- mf_import_data(dirname(res_dl$destfile[1]), collection = coll)

### Plot the data
terra::plot(modis_ts)

## End(Not run)
</code></pre>

<hr>
<h2 id='mf_get_opt_param'>Precompute the parameter <code>opt_param</code> of the function <a href="#topic+mf_get_url">mf_get_url</a></h2><span id='topic+mf_get_opt_param'></span>

<h3>Description</h3>

<p>Precompute the parameter <code>opt_param</code> to further provide as input of the <a href="#topic+mf_get_url">mf_get_url</a> function. Useful to speed-up the overall processing time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mf_get_opt_param(collection, roi, credentials = NULL, verbose = "inform")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mf_get_opt_param_+3A_collection">collection</code></td>
<td>
<p>string. mandatory. Collection of interest (see details of <a href="#topic+mf_get_url">mf_get_url</a>).</p>
</td></tr>
<tr><td><code id="mf_get_opt_param_+3A_roi">roi</code></td>
<td>
<p>object of class <code>sf</code>. mandatory. Area of region of interest. Must be a Simple feature collection with geometry type POLYGON, composed of one or several rows (i.e. one or several ROIs), and with at least two columns: 'id' (an identifier for the roi) and 'geom' (the geometry).</p>
</td></tr>
<tr><td><code id="mf_get_opt_param_+3A_credentials">credentials</code></td>
<td>
<p>vector string of length 2 with username and password. optional if the function <a href="#topic+mf_login">mf_login</a> was previously executed.</p>
</td></tr>
<tr><td><code id="mf_get_opt_param_+3A_verbose">verbose</code></td>
<td>
<p>string. Verbose mode (&quot;quiet&quot;, &quot;inform&quot;, or &quot;debug&quot;). Default &quot;inform&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When it is needed to loop the function <a href="#topic+mf_get_url">mf_get_url</a> over several time frames, it is advised to previously run the function <code>mf_get_opt_param</code> and provide the output as input <code>opt_param</code> parameter of the <a href="#topic+mf_get_url">mf_get_url</a> function.
This will save much time, as internal parameters will be calculated only once.
</p>


<h3>Value</h3>

<p>a list with the following named objects :
</p>

<dl>
<dt>roiSpatialIndexBound</dt><dd><p>OPeNDAP indices for the spatial coordinates of the bounding box of the ROI (minLat, maxLat, minLon, maxLon)</p>
</dd>
<dt>availableVariables</dt><dd><p>Variables available for the collection of interest</p>
</dd>
<dt>roiSpatialBound</dt><dd><p>The spatial coordinates of the bounding box of the ROI expressed in the CRS of the collection</p>
</dd>
<dt>OpenDAPXVector</dt><dd><p>The X (longitude) vector</p>
</dd>
<dt>OpenDAPYVector</dt><dd><p>The Y (longitude) vector</p>
</dd>
<dt>OpenDAPtimeVector</dt><dd><p>The time vector, or NULL if the collection does not have a time vector</p>
</dd>
<dt>modis_tile</dt><dd><p>The MODIS tile(s) number(s) for the ROI or NULL if the collection is not MODIS</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Login to Earthdata

log &lt;- mf_login(credentials = c("earthdata_un", "earthdata_pw"))

# Get the optional parameters for the collection MOD11A1.061 and the following roi :
roi &lt;- sf::st_as_sf(
  data.frame(
    id = "roi_test",
    geom = "POLYGON ((-5.82 9.54, -5.42 9.55, -5.41 8.84, -5.81 8.84, -5.82 9.54))"
  ),
  wkt = "geom", crs = 4326
)

opt_param_mod11a1 &lt;- mf_get_opt_param("MOD11A1.061", roi)
str(opt_param_mod11a1)

# Now we can provide opt_param_mod11a1 as input parameter of the function mf_get_url().

time_ranges &lt;- list(
  as.Date(c("2016-01-01", "2016-01-31")),
  as.Date(c("2017-01-01", "2017-01-31")),
  as.Date(c("2018-01-01", "2018-01-31")),
  as.Date(c("2019-01-01", "2019-01-31"))
)

(urls_mod11a1 &lt;- map(.x = time_ranges, ~ mf_get_url(
  collection = "MOD11A1.061",
  variables = c("LST_Day_1km", "LST_Night_1km", "QC_Day", "QC_Night"),
  roi = roi,
  time_range = .x,
  opt_param = opt_param_mod11a1
)))

## End(Not run)
</code></pre>

<hr>
<h2 id='mf_get_url'>Build the URL(s) of the data to download</h2><span id='topic+mf_get_url'></span>

<h3>Description</h3>

<p>Builds the OPeNDAP URL(s) of the spatiotemporal datacube to
download, given a collection, variables, region and time range of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mf_get_url(
  collection,
  variables = NULL,
  roi,
  time_range,
  output_format = "nc4",
  single_netcdf = TRUE,
  opt_param = NULL,
  credentials = NULL,
  verbose = "inform"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mf_get_url_+3A_collection">collection</code></td>
<td>
<p>string. mandatory. Collection of interest (see details of <a href="#topic+mf_get_url">mf_get_url</a>).</p>
</td></tr>
<tr><td><code id="mf_get_url_+3A_variables">variables</code></td>
<td>
<p>string vector. optional. Variables to retrieve for the collection of interest. If not specified (default) all available variables will be extracted (see details of <a href="#topic+mf_get_url">mf_get_url</a>).</p>
</td></tr>
<tr><td><code id="mf_get_url_+3A_roi">roi</code></td>
<td>
<p>object of class <code>sf</code>. mandatory. Area of region of interest. Must be a Simple feature collection with geometry type POLYGON, composed of one or several rows (i.e. one or several ROIs), and with at least two columns: 'id' (an identifier for the roi) and 'geom' (the geometry).</p>
</td></tr>
<tr><td><code id="mf_get_url_+3A_time_range">time_range</code></td>
<td>
<p>date(s) / POSIXlt of interest . mandatory. Single date/datetime or time frame : vector with start and end dates/times (see details).</p>
</td></tr>
<tr><td><code id="mf_get_url_+3A_output_format">output_format</code></td>
<td>
<p>string. Output data format. optional. Available options are : &quot;nc4&quot; (default), &quot;ascii&quot;, &quot;json&quot;</p>
</td></tr>
<tr><td><code id="mf_get_url_+3A_single_netcdf">single_netcdf</code></td>
<td>
<p>boolean. optional. Get the URL either as a single file that encompasses the whole time frame (TRUE) or as multiple files (1 for each date) (FALSE). Default to TRUE. Currently enabled only for MODIS and VIIRS collections.</p>
</td></tr>
<tr><td><code id="mf_get_url_+3A_opt_param">opt_param</code></td>
<td>
<p>list of optional arguments. optional. (see details).</p>
</td></tr>
<tr><td><code id="mf_get_url_+3A_credentials">credentials</code></td>
<td>
<p>vector string of length 2 with username and password. optional if the function <a href="#topic+mf_login">mf_login</a> was previously executed.</p>
</td></tr>
<tr><td><code id="mf_get_url_+3A_verbose">verbose</code></td>
<td>
<p>string. Verbose mode (&quot;quiet&quot;, &quot;inform&quot;, or &quot;debug&quot;). Default &quot;inform&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>collection</code> : Collections available can be retrieved with the function <a href="#topic+mf_list_collections">mf_list_collections</a>
</p>
<p>Argument <code>variables</code> : For each collection, variables available can be retrieved with the function <a href="#topic+mf_list_variables">mf_list_variables</a>
</p>
<p>Argument <code>time_range</code> : Can be provided either as i) a single date (e.g. <code>as.Date("2017-01-01"))</code> or ii) a time frame provided as two bounding dates (starting and ending time) ( e.g. <code>as.Date(c("2010-01-01","2010-01-30"))</code>) or iii) a POSIXlt single time (e.g. <code>as.POSIXlt("2010-01-01 18:00:00")</code>) or iv) a POSIXlt time range (e.g. <code>as.POSIXlt(c("2010-01-01 18:00:00","2010-01-02 09:00:00"))</code>) for the half-hourly collection (GPM_3IMERGHH.06). If POSIXlt, hours must be provided in GMT.
</p>
<p>Argument <code>single_netcdf</code> : for MODIS and VIIRS products from LP DAAC: download the data as a single file encompassing the whole time frame (TRUE) or as multiple files : one for each date, which is the behavious for the other collections - GPM and SMAP) (FALSE) ?
</p>
<p>Argument <code>opt_param</code> : list of parameters related to the queried OPeNDAP server and the roi. See <a href="#topic+mf_get_opt_param">mf_get_opt_param</a> for additional details. This list can be retrieved outside the function with the function <a href="#topic+mf_get_opt_param">mf_get_opt_param</a>. If not provided, it will be automatically calculated within the <a href="#topic+mf_get_url">mf_get_url</a> function. However, providing it fastens the processing time.
It might be particularly useful to precompute it with <a href="#topic+mf_get_opt_param">mf_get_opt_param</a> in case the function is used within a loop for a single ROI.
</p>
<p>Argument <code>credentials</code> : Login to the OPeNDAP servers is required to use the function. Login can be done either within the function or outside with the function <a href="#topic+mf_login">mf_login</a>
</p>


<h3>Value</h3>

<p>a data.frame with one row for each dataset to download and 5 columns :
</p>

<dl>
<dt>id_roi</dt><dd><p>Identifier of the ROI</p>
</dd>
<dt>time_start</dt><dd><p>Start Date/time for the dataset</p>
</dd>
<dt>collection</dt><dd><p>Name of the collection</p>
</dd>
<dt>name</dt><dd><p>Indicative name for the dataset</p>
</dd>
<dt>url</dt><dd><p>https OPeNDAP URL of the dataset</p>
</dd>
<dt>maxFileSizeEstimated</dt><dd><p>Maximum estimated data size for the dataset (in bites)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

### First login to EOSDIS Earthdata with username and password.
# To create an account go to : https://urs.earthdata.nasa.gov/.
username &lt;- "earthdata_un"
password &lt;- "earthdata_pw"
log &lt;- mf_login(credentials = c(username, password))

### Get the URLs to download the following datasets :
# MODIS Terra LST Daily (MOD11A1.061) (collection)
# Day + Night bands (LST_Day_1km,LST_Night_1km) (variables)
# over a 50km x 70km region of interest (roi)
# for the time frame 2017-01-01 to 2017-01-30 (30 days) (time_range)

roi &lt;- sf::st_as_sf(
  data.frame(
    id = "roi_test",
    geom = "POLYGON ((-5.82 9.54, -5.42 9.55, -5.41 8.84, -5.81 8.84, -5.82 9.54))"
  ),
  wkt = "geom", crs = 4326
)

time_range &lt;- as.Date(c("2017-01-01", "2017-01-30"))

(urls_mod11a1 &lt;- mf_get_url(
  collection = "MOD11A1.061",
  variables = c("LST_Day_1km", "LST_Night_1km"),
  roi = roi,
  time_range = time_range
))

## Download the data :

res_dl &lt;- mf_download_data(urls_mod11a1)

## Import as terra::SpatRast

modis_ts &lt;- mf_import_data(dirname(res_dl$destfile[1]), collection = "MOD11A1.061")

## Plot the data

terra::plot(modis_ts)

## End(Not run)
</code></pre>

<hr>
<h2 id='mf_import_data'>Import datasets downloaded using <code>modisfast</code> as a <code>terra::SpatRaster</code> object</h2><span id='topic+mf_import_data'></span>

<h3>Description</h3>

<p>Import datasets downloaded using <code>modisfast</code> as a <code>terra::SpatRaster</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mf_import_data(
  path,
  collection,
  output_class = "SpatRaster",
  proj_epsg = NULL,
  roi_mask = NULL,
  vrt = FALSE,
  verbose = "inform",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mf_import_data_+3A_path">path</code></td>
<td>
<p>character string. mandatory. The path to the local directory where the data are stored.</p>
</td></tr>
<tr><td><code id="mf_import_data_+3A_collection">collection</code></td>
<td>
<p>string. mandatory. Collection of interest (see details of <a href="#topic+mf_get_url">mf_get_url</a>).</p>
</td></tr>
<tr><td><code id="mf_import_data_+3A_output_class">output_class</code></td>
<td>
<p>character string. Output object class. Currently only &quot;SpatRaster&quot; implemented.</p>
</td></tr>
<tr><td><code id="mf_import_data_+3A_proj_epsg">proj_epsg</code></td>
<td>
<p>numeric. EPSG of the desired projection for the output raster (default : source projection of the data).</p>
</td></tr>
<tr><td><code id="mf_import_data_+3A_roi_mask">roi_mask</code></td>
<td>
<p><code>SpatRaster</code> or <code>SpatVector</code> or <code>sf</code>. Area beyond which data will be masked. Typically, the input ROI of <a href="#topic+mf_get_url">mf_get_url</a> (default : NULL (no mask))</p>
</td></tr>
<tr><td><code id="mf_import_data_+3A_vrt">vrt</code></td>
<td>
<p>boolean. Import virtual raster instead of SpatRaster. Useful for very large files. (default : FALSE)</p>
</td></tr>
<tr><td><code id="mf_import_data_+3A_verbose">verbose</code></td>
<td>
<p>string. Verbose mode (&quot;quiet&quot;, &quot;inform&quot;, or &quot;debug&quot;). Default &quot;inform&quot;.</p>
</td></tr>
<tr><td><code id="mf_import_data_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>terra::SpatRast</code> object
</p>


<h3>Note</h3>

<p>Although the data downloaded through <code>modisfast</code> could be imported with any netcdf-compliant R package (<code>terra</code>, <code>stars</code>, <code>ncdf4</code>, etc.), care must be taken. In fact, depending on the collection, some “issues” were raised. These issues are independent from <code>modisfast</code> : they result most of time of a lack of full implementation of the OPeNDAP framework by the data providers. Namely, these issues are :
</p>

<ul>
<li><p>for MODIS and VIIRS collections : CRS has to be provided
</p>
</li>
<li><p>for GPM collections : CRS has to be provided + data have to be flipped
</p>
</li></ul>

<p>The function <a href="#topic+mf_import_data">mf_import_data</a> includes the processing that needs to be done at the data import phase in order to safely use the data as <code>terra</code> objects.
</p>
<p>Also note that reprojecting over large ROIs using the argument <code>proj_epsg</code> might take long. In this case, setting the argument <code>vrt</code> to TRUE might be a solution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

### Login to EOSDIS Earthdata with your username and password
log &lt;- mf_login(credentials = c("earthdata_un", "earthdata_pw"))

### Set-up parameters of interest
coll &lt;- "MOD11A1.061"

bands &lt;- c("LST_Day_1km", "LST_Night_1km")

time_range &lt;- as.Date(c("2017-01-01", "2017-01-30"))

roi &lt;- sf::st_as_sf(
  data.frame(
    id = "roi_test",
    geom = "POLYGON ((-5.82 9.54, -5.42 9.55, -5.41 8.84, -5.81 8.84, -5.82 9.54))"
  ),
  wkt = "geom", crs = 4326
)

### Get the URLs of the data
(urls_mod11a1 &lt;- mf_get_url(
  collection = coll,
  variables = bands,
  roi = roi,
  time_range = time_range
))

### Download the data
res_dl &lt;- mf_download_data(urls_mod11a1)

### Import the data as terra::SpatRast
modis_ts &lt;- mf_import_data(dirname(res_dl$destfile[1]), collection = coll)

### Plot the data
terra::plot(modis_ts)

## End(Not run)
</code></pre>

<hr>
<h2 id='mf_list_collections'>Get the collections available for download with the <code>modisfast</code> package</h2><span id='topic+mf_list_collections'></span>

<h3>Description</h3>

<p>Get the collections available for download using the package and a set of related information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mf_list_collections()
</code></pre>


<h3>Value</h3>

<p>A data.frame with the collections available, and a set of related information for each one. Main columns are :
</p>

<dl>
<dt>collection</dt><dd><p>Collection short name</p>
</dd>
<dt>source</dt><dd><p>Data provider</p>
</dd>
<dt>long_name</dt><dd><p>Collection long name</p>
</dd>
<dt>doi</dt><dd><p>DOI of the collection</p>
</dd>
<dt>start_date</dt><dd><p>First available date for the collection</p>
</dd>
<dt>url_opendapserver</dt><dd><p>URL of the OPeNDAP server of the data</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
(head(mf_list_collections()))

</code></pre>

<hr>
<h2 id='mf_list_variables'>Get information for the variables (bands) available for a given collection</h2><span id='topic+mf_list_variables'></span>

<h3>Description</h3>

<p>Get the variables available for a given collection, along with a set of related information for each.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mf_list_variables(collection, credentials = NULL, verbose = "inform")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mf_list_variables_+3A_collection">collection</code></td>
<td>
<p>string. mandatory. Collection of interest (see details of <a href="#topic+mf_get_url">mf_get_url</a>).</p>
</td></tr>
<tr><td><code id="mf_list_variables_+3A_credentials">credentials</code></td>
<td>
<p>vector string of length 2 with username and password. optional if the function <a href="#topic+mf_login">mf_login</a> was previously executed.</p>
</td></tr>
<tr><td><code id="mf_list_variables_+3A_verbose">verbose</code></td>
<td>
<p>string. Verbose mode (&quot;quiet&quot;, &quot;inform&quot;, or &quot;debug&quot;). Default &quot;inform&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with the variables available for the collection, and a set of related information for each variable.
The variables marked as &quot;extractable&quot; in the column &quot;extractable_with_modisfast&quot; can be provided as input parameter <code>variables</code> of the function <a href="#topic+mf_get_url">mf_get_url</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# login to Earthdata
log &lt;- mf_login(c("earthdata_un", "earthdata_pw"))

# Get the variables available for the collection MOD11A1.061
(df_varinfo &lt;- mf_list_variables("MOD11A1.061"))

## End(Not run)

</code></pre>

<hr>
<h2 id='mf_login'>Login to EOSDIS EarthData account</h2><span id='topic+mf_login'></span>

<h3>Description</h3>

<p>Login to EOSDIS EarthData before querying servers and download data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mf_login(credentials, verbose = "inform")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mf_login_+3A_credentials">credentials</code></td>
<td>
<p>vector string of length 2 with username and password. optional if the function <a href="#topic+mf_login">mf_login</a> was previously executed.</p>
</td></tr>
<tr><td><code id="mf_login_+3A_verbose">verbose</code></td>
<td>
<p>string. Verbose mode (&quot;quiet&quot;, &quot;inform&quot;, or &quot;debug&quot;). Default &quot;inform&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An EOSDIS EarthData account is mandatory to download the data. You can create a free account here : <a href="https://urs.earthdata.nasa.gov/">https://urs.earthdata.nasa.gov/</a>.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
username &lt;- "earthdata_un"
password &lt;- "earthdata_pw"
mf_login(credentials = c(username, password))

## End(Not run)

</code></pre>

<hr>
<h2 id='mf_modisfast'>Download (and possibly import) MODIS, VIIRS and GPM
Earth Observation data</h2><span id='topic+mf_modisfast'></span>

<h3>Description</h3>

<p>Download and possibly import MODIS, VIIRS and GPM
Earth Observation data quickly and efficiently.
This function is a wrapper for
<a href="#topic+mf_login">mf_login</a>, <a href="#topic+mf_get_url">mf_get_url</a>, <a href="#topic+mf_download_data">mf_download_data</a> and <a href="#topic+mf_import_data">mf_import_data</a>.
Whenever possible, users should prefer executing the functions <a href="#topic+mf_login">mf_login</a>,
<a href="#topic+mf_get_url">mf_get_url</a>, <a href="#topic+mf_download_data">mf_download_data</a> and <a href="#topic+mf_import_data">mf_import_data</a> sequentially
rather than using this high-level function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mf_modisfast(
  collection,
  variables,
  roi,
  time_range,
  path = tempfile("modisfast_"),
  earthdata_username,
  earthdata_password,
  parallel = FALSE,
  verbose = "inform",
  import = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mf_modisfast_+3A_collection">collection</code></td>
<td>
<p>string. mandatory. Collection of interest (see details of <a href="#topic+mf_get_url">mf_get_url</a>).</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_variables">variables</code></td>
<td>
<p>string vector. optional. Variables to retrieve for the collection of interest. If not specified (default) all available variables will be extracted (see details of <a href="#topic+mf_get_url">mf_get_url</a>).</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_roi">roi</code></td>
<td>
<p>object of class <code>sf</code>. mandatory. Area of region of interest. Must be a Simple feature collection with geometry type POLYGON, composed of one or several rows (i.e. one or several ROIs), and with at least two columns: 'id' (an identifier for the roi) and 'geom' (the geometry).</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_time_range">time_range</code></td>
<td>
<p>date(s) / POSIXlt of interest . mandatory. Single date/datetime or time frame : vector with start and end dates/times (see details).</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_path">path</code></td>
<td>
<p>string. Target folder for the data to download. Default : temporary folder.</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_earthdata_username">earthdata_username</code></td>
<td>
<p>EarthData username</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_earthdata_password">earthdata_password</code></td>
<td>
<p>EarthData username</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_parallel">parallel</code></td>
<td>
<p>boolean. Parallelize the download ? Default to FALSE</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_verbose">verbose</code></td>
<td>
<p>string. Verbose mode (&quot;quiet&quot;, &quot;inform&quot;, or &quot;debug&quot;). Default &quot;inform&quot;.</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_import">import</code></td>
<td>
<p>boolean. Import the data as a SpatRast object ? default TRUE. FALSE will download the data but not import them it in R.</p>
</td></tr>
<tr><td><code id="mf_modisfast_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <a href="#topic+mf_import_data">mf_import_data</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>if the parameter <code>import</code> is set to TRUE, a <code>terra::SpatRast</code>
object ; else a data.frame providing details of the data downloaded
(see output of <a href="#topic+mf_download_data">mf_download_data</a>).
</p>


<h3>See Also</h3>

<p><a href="#topic+mf_login">mf_login</a>, <a href="#topic+mf_get_url">mf_get_url</a>, <a href="#topic+mf_download_data">mf_download_data</a>, <a href="#topic+mf_import_data">mf_import_data</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

### Set-up parameters of interest
coll &lt;- "MOD11A1.061"

bands &lt;- c("LST_Day_1km", "LST_Night_1km")

time_range &lt;- as.Date(c("2017-01-01", "2017-01-30"))

roi &lt;- sf::st_as_sf(
  data.frame(
    id = "roi_test",
    geom = "POLYGON ((-5.82 9.54, -5.42 9.55, -5.41 8.84, -5.81 8.84, -5.82 9.54))"
  ),
  wkt = "geom", crs = 4326
)

### Download and import the data
modis_ts &lt;- mf_modisfast(
  collection = coll,
  variables = bands,
  roi = roi,
  time_range = time_range,
  earthdata_username = "earthdata_un",
  earthdata_password = "earthdata_pw"
 )

### Plot the data
terra::plot(modis_ts)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
