<!DOCTYPE html><html lang="en"><head><title>Help for package REN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {REN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#REN-package'><p>REN: Regularization Ensemble for Robust Portfolio Optimization</p></a></li>
<li><a href='#buh.clust'><p>Perform Hierarchical Clustering on Asset Correlations</p></a></li>
<li><a href='#FF25'><p>FF25 Dataset</p></a></li>
<li><a href='#insert.at'><p>Insert Values at Specified Positions in a Vector</p></a></li>
<li><a href='#perform_analysis'><p>Perform Portfolio Analysis</p></a></li>
<li><a href='#po.avg'><p>Perform LASSO or Ridge Regression for Portfolio Optimization</p></a></li>
<li><a href='#po.bhu'><p>Perform Portfolio Optimization Using Clusters and LASSO</p></a></li>
<li><a href='#po.cols'><p>Perform Simple Linear Model for Portfolio Optimization</p></a></li>
<li><a href='#po.covShrink'><p>Perform Shrinkage-Based Portfolio Optimization</p></a></li>
<li><a href='#po.grossExp'><p>Perform Gross Exposure Portfolio Optimization</p></a></li>
<li><a href='#po.JM'><p>Perform James-Stein Portfolio Optimization</p></a></li>
<li><a href='#po.SW'><p>Perform Stochastic Weight Portfolio Optimization</p></a></li>
<li><a href='#po.SW.lasso'><p>Perform LASSO Regularization with Stochastic Weight Portfolio Optimization</p></a></li>
<li><a href='#po.TZT'><p>Perform Portfolio Optimization Using TZT Method</p></a></li>
<li><a href='#prepare_data'><p>Prepare Data for Portfolio Analysis</p></a></li>
<li><a href='#ren'><p>Main Function for Portfolio Analysis</p></a></li>
<li><a href='#setup_parallel'><p>Setup Parallel Processing for Portfolio Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Regularization Ensemble for Robust Portfolio Optimization</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bonsoo Koo &lt;bonsoo.koo@monash.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Portfolio optimization is achieved through a combination of regularization techniques and ensemble methods that are designed to generate stable out-of-sample return predictions, particularly in the presence of strong correlations among assets. The package includes functions for data preparation, parallel processing, and portfolio analysis using methods such as Mean-Variance, James-Stein, LASSO, Ridge Regression, and Equal Weighting. It also provides visualization tools and performance metrics, such as the Sharpe ratio, volatility, and maximum drawdown, to assess the results.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>lubridate, glmnet, quadprog, doParallel, Matrix, tictoc,
corpcor, ggplot2, reshape2, foreach, stats, parallel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, KernSmooth, cluster, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-07 10:20:09 UTC; yez1</td>
</tr>
<tr>
<td>Author:</td>
<td>Hardik Dixit [aut],
  Shijia Wang [aut],
  Bonsoo Koo [aut, cre],
  Cash Looi [aut],
  Hong Wang [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-10 16:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='REN-package'>REN: Regularization Ensemble for Robust Portfolio Optimization</h2><span id='topic+REN'></span><span id='topic+REN-package'></span>

<h3>Description</h3>

<p>Portfolio optimization is achieved through a combination of regularization techniques and ensemble methods that are designed to generate stable out-of-sample return predictions, particularly in the presence of strong correlations among assets. The package includes functions for data preparation, parallel processing, and portfolio analysis using methods such as Mean-Variance, James-Stein, LASSO, Ridge Regression, and Equal Weighting. It also provides visualization tools and performance metrics, such as the Sharpe ratio, volatility, and maximum drawdown, to assess the results.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Bonsoo Koo <a href="mailto:bonsoo.koo@monash.edu">bonsoo.koo@monash.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Hardik Dixit
</p>
</li>
<li><p> Shijia Wang
</p>
</li>
<li><p> Cash Looi
</p>
</li>
<li><p> Hong Wang
</p>
</li></ul>


<hr>
<h2 id='buh.clust'>Perform Hierarchical Clustering on Asset Correlations</h2><span id='topic+buh.clust'></span>

<h3>Description</h3>

<p>This function performs hierarchical clustering on asset correlations and returns the clustered groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buh.clust(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buh.clust_+3A_x">x</code></td>
<td>
<p>A numeric matrix of asset returns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of asset clusters.
</p>

<hr>
<h2 id='FF25'>FF25 Dataset</h2><span id='topic+FF25'></span>

<h3>Description</h3>

<p>A dataset containing financial data for portfolio analysis with 25 portfolios formed on size and book-to-market ratios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FF25
</code></pre>


<h3>Format</h3>

<p>A data frame with 25,670 rows and 27 variables:
</p>

<dl>
<dt>X</dt><dd><p>Date in the format YYYYMMDD (int)</p>
</dd>
<dt>X.1</dt><dd><p>Another column (check what this is; update description as needed)</p>
</dd>
<dt>SMALL.LoBM</dt><dd><p>Portfolio returns for small firms with low book-to-market ratios (numeric)</p>
</dd>
<dt>ME1.BM2</dt><dd><p>Portfolio returns for medium-sized firms with book-to-market group 2 (numeric)</p>
</dd>
<dt>ME1.BM3</dt><dd><p>Portfolio returns for medium-sized firms with book-to-market group 3 (numeric)</p>
</dd>
<dt>ME1.BM4</dt><dd><p>Portfolio returns for medium-sized firms with book-to-market group 4 (numeric)</p>
</dd>
<dt>SMALL.HiBM</dt><dd><p>Portfolio returns for small firms with high book-to-market ratios (numeric)</p>
</dd>
<dt>ME2.BM1</dt><dd><p>Portfolio returns for medium-sized firms with book-to-market group 1 (numeric)</p>
</dd>
<dt>ME2.BM2</dt><dd><p>Portfolio returns for medium-sized firms with book-to-market group 2 (numeric)</p>
</dd>
<dt>ME2.BM3</dt><dd><p>Portfolio returns for medium-sized firms with book-to-market group 3 (numeric)</p>
</dd>
<dt>ME2.BM4</dt><dd><p>Portfolio returns for medium-sized firms with book-to-market group 4 (numeric)</p>
</dd>
<dt>ME2.BM5</dt><dd><p>Portfolio returns for medium-sized firms with book-to-market group 5 (numeric)</p>
</dd>
<dt>ME3.BM1</dt><dd><p>Portfolio returns for large firms with book-to-market group 1 (numeric)</p>
</dd>
<dt>ME3.BM2</dt><dd><p>Portfolio returns for large firms with book-to-market group 2 (numeric)</p>
</dd>
<dt>ME3.BM3</dt><dd><p>Portfolio returns for large firms with book-to-market group 3 (numeric)</p>
</dd>
<dt>ME3.BM4</dt><dd><p>Portfolio returns for large firms with book-to-market group 4 (numeric)</p>
</dd>
<dt>ME3.BM5</dt><dd><p>Portfolio returns for large firms with book-to-market group 5 (numeric)</p>
</dd>
<dt>ME4.BM1</dt><dd><p>Portfolio returns for firms in the fourth size and first book-to-market group (numeric)</p>
</dd>
<dt>ME4.BM2</dt><dd><p>Portfolio returns for firms in the fourth size and second book-to-market group (numeric)</p>
</dd>
<dt>ME4.BM3</dt><dd><p>Portfolio returns for firms in the fourth size and third book-to-market group (numeric)</p>
</dd>
<dt>ME4.BM4</dt><dd><p>Portfolio returns for firms in the fourth size and fourth book-to-market group (numeric)</p>
</dd>
<dt>ME4.BM5</dt><dd><p>Portfolio returns for firms in the fourth size and fifth book-to-market group (numeric)</p>
</dd>
<dt>BIG.LoBM</dt><dd><p>Portfolio returns for large firms with low book-to-market ratios (numeric)</p>
</dd>
<dt>ME5.BM2</dt><dd><p>Portfolio returns for large firms with book-to-market group 2 (numeric)</p>
</dd>
<dt>ME5.BM3</dt><dd><p>Portfolio returns for large firms with book-to-market group 3 (numeric)</p>
</dd>
<dt>ME5.BM4</dt><dd><p>Portfolio returns for large firms with book-to-market group 4 (numeric)</p>
</dd>
<dt>BIG.HiBM</dt><dd><p>Portfolio returns for large firms with high book-to-market ratios (numeric)</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;Provide any relevant source here, e.g., URL or description of data origin&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(FF25)
head(FF25)
</code></pre>

<hr>
<h2 id='insert.at'>Insert Values at Specified Positions in a Vector</h2><span id='topic+insert.at'></span>

<h3>Description</h3>

<p>This function inserts specified values at given positions in a vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insert.at(a, pos, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="insert.at_+3A_a">a</code></td>
<td>
<p>A vector.</p>
</td></tr>
<tr><td><code id="insert.at_+3A_pos">pos</code></td>
<td>
<p>A numeric vector specifying the positions to insert the values.</p>
</td></tr>
<tr><td><code id="insert.at_+3A_...">...</code></td>
<td>
<p>Values to be inserted at the specified positions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the inserted values.
</p>

<hr>
<h2 id='perform_analysis'>Perform Portfolio Analysis</h2><span id='topic+perform_analysis'></span>

<h3>Description</h3>

<p>This function performs portfolio analysis using various methods such as Mean-Variance (MV),
James-Stein (JM), LASSO, Ridge Regression, Equal Weighting (EW), among others.
It calculates weights, turnover, returns, Sharpe ratios, volatility, and maximum drawdown for each method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perform_analysis(x, mon, count, Date, num_cores = 7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="perform_analysis_+3A_x">x</code></td>
<td>
<p>A numeric matrix where each column represents asset returns and rows represent time periods.</p>
</td></tr>
<tr><td><code id="perform_analysis_+3A_mon">mon</code></td>
<td>
<p>A numeric vector representing the number of months since the start date for each time period.</p>
</td></tr>
<tr><td><code id="perform_analysis_+3A_count">count</code></td>
<td>
<p>A numeric vector indicating the number of entries per month.</p>
</td></tr>
<tr><td><code id="perform_analysis_+3A_date">Date</code></td>
<td>
<p>A vector of Date objects representing the dates of the time periods.</p>
</td></tr>
<tr><td><code id="perform_analysis_+3A_num_cores">num_cores</code></td>
<td>
<p>The number of cores to use for parallel processing. Default is 7.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function iterates through different time periods and calculates portfolio weights,
turnover, and returns for multiple methods including Mean-Variance (MV), James-Stein (JM), and various
regularization techniques. It also computes performance metrics like the Sharpe ratio, volatility,
maximum drawdown, and cumulative turnover for each method. Visualization of the cumulative returns
and turnover is generated using ggplot2.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt>cumulative_return_plot</dt><dd><p>A ggplot object representing the cumulative returns for each method.</p>
</dd>
<dt>cumulative_turnover_plot</dt><dd><p>A ggplot object representing the cumulative turnover for each method.</p>
</dd>
<dt>turnover_mean</dt><dd><p>A numeric vector of the mean turnover for each method.</p>
</dd>
<dt>sharpe_ratio</dt><dd><p>A numeric vector of the Sharpe ratio for each method.</p>
</dd>
<dt>volatility</dt><dd><p>A numeric vector of the annualized volatility for each method.</p>
</dd>
<dt>max_drawdown</dt><dd><p>A numeric vector of the maximum drawdown for each method.</p>
</dd>
<dt>vw_to_mean</dt><dd><p>The mean turnover for the volume-weighted (VW) portfolio.</p>
</dd>
<dt>vw_sharpe_ratio</dt><dd><p>The Sharpe ratio for the VW portfolio.</p>
</dd>
<dt>vw_volatility</dt><dd><p>The annualized volatility for the VW portfolio.</p>
</dd>
<dt>vw_max_drawdown</dt><dd><p>The maximum drawdown for the VW portfolio.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
# Create a larger example dataset that aligns with the function's expectations
set.seed(123)
x &lt;- matrix(runif(700), ncol = 10)  # 10 columns (assets), 70 rows (observations)
mon &lt;- rep(1:10, each = 7)          # Example month identifiers, 7 observations per month
count &lt;- rep(7, 10)                 # Example count per month (7 entries per month)
Date &lt;- as.Date('2020-01-01') + 0:69 # Example date sequence (70 days)

# Run the analysis with 2 cores
result &lt;- perform_analysis(x, mon, count, Date, num_cores = 2)

# Display results
print(result$cumulative_return_plot)
print(result$cumulative_turnover_plot)

</code></pre>

<hr>
<h2 id='po.avg'>Perform LASSO or Ridge Regression for Portfolio Optimization</h2><span id='topic+po.avg'></span>

<h3>Description</h3>

<p>This function performs LASSO, Ridge, or Elastic Net regression for portfolio optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.avg(y0, x0, method = "LASSO")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.avg_+3A_y0">y0</code></td>
<td>
<p>A numeric vector of response values.</p>
</td></tr>
<tr><td><code id="po.avg_+3A_x0">x0</code></td>
<td>
<p>A numeric matrix of predictors.</p>
</td></tr>
<tr><td><code id="po.avg_+3A_method">method</code></td>
<td>
<p>The regularization method: &quot;LASSO&quot;, &quot;RIDGE&quot;, or &quot;EN&quot; (Elastic Net).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of optimized portfolio weights.
</p>

<hr>
<h2 id='po.bhu'>Perform Portfolio Optimization Using Clusters and LASSO</h2><span id='topic+po.bhu'></span>

<h3>Description</h3>

<p>This function performs portfolio optimization using clustering and LASSO regularization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.bhu(y0, x0, group, rep)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.bhu_+3A_y0">y0</code></td>
<td>
<p>A numeric vector of response values.</p>
</td></tr>
<tr><td><code id="po.bhu_+3A_x0">x0</code></td>
<td>
<p>A numeric matrix of predictors.</p>
</td></tr>
<tr><td><code id="po.bhu_+3A_group">group</code></td>
<td>
<p>A list of asset clusters.</p>
</td></tr>
<tr><td><code id="po.bhu_+3A_rep">rep</code></td>
<td>
<p>The number of repetitions for optimization.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of optimized portfolio weights.
</p>

<hr>
<h2 id='po.cols'>Perform Simple Linear Model for Portfolio Optimization</h2><span id='topic+po.cols'></span>

<h3>Description</h3>

<p>This function uses simple linear regression to perform portfolio optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.cols(y0, x0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.cols_+3A_y0">y0</code></td>
<td>
<p>A numeric vector of response values.</p>
</td></tr>
<tr><td><code id="po.cols_+3A_x0">x0</code></td>
<td>
<p>A numeric matrix of predictors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of optimized portfolio weights.
</p>

<hr>
<h2 id='po.covShrink'>Perform Shrinkage-Based Portfolio Optimization</h2><span id='topic+po.covShrink'></span>

<h3>Description</h3>

<p>This function uses covariance shrinkage techniques for portfolio optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.covShrink(y0, x0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.covShrink_+3A_y0">y0</code></td>
<td>
<p>A numeric vector of response values.</p>
</td></tr>
<tr><td><code id="po.covShrink_+3A_x0">x0</code></td>
<td>
<p>A numeric matrix of predictors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of optimized portfolio weights.
</p>

<hr>
<h2 id='po.grossExp'>Perform Gross Exposure Portfolio Optimization</h2><span id='topic+po.grossExp'></span>

<h3>Description</h3>

<p>This function performs gross exposure portfolio optimization using LASSO.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.grossExp(y0, x0, method = "NOSHORT")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.grossExp_+3A_y0">y0</code></td>
<td>
<p>A numeric vector of response values.</p>
</td></tr>
<tr><td><code id="po.grossExp_+3A_x0">x0</code></td>
<td>
<p>A numeric matrix of predictors.</p>
</td></tr>
<tr><td><code id="po.grossExp_+3A_method">method</code></td>
<td>
<p>The regularization method: &quot;NOSHORT&quot; or &quot;EQUAL&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of optimized portfolio weights.
</p>

<hr>
<h2 id='po.JM'>Perform James-Stein Portfolio Optimization</h2><span id='topic+po.JM'></span>

<h3>Description</h3>

<p>This function uses James-Stein estimation for portfolio optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.JM(x0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.JM_+3A_x0">x0</code></td>
<td>
<p>A numeric matrix of asset returns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of optimized portfolio weights.
</p>

<hr>
<h2 id='po.SW'>Perform Stochastic Weight Portfolio Optimization</h2><span id='topic+po.SW'></span>

<h3>Description</h3>

<p>This function performs stochastic weight portfolio optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.SW(x0, b, sample)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.SW_+3A_x0">x0</code></td>
<td>
<p>A numeric matrix of asset returns.</p>
</td></tr>
<tr><td><code id="po.SW_+3A_b">b</code></td>
<td>
<p>Number of assets to select in each sample.</p>
</td></tr>
<tr><td><code id="po.SW_+3A_sample">sample</code></td>
<td>
<p>Number of random samples to generate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of optimized portfolio weights.
</p>

<hr>
<h2 id='po.SW.lasso'>Perform LASSO Regularization with Stochastic Weight Portfolio Optimization</h2><span id='topic+po.SW.lasso'></span>

<h3>Description</h3>

<p>This function performs portfolio optimization using LASSO regularization and stochastic weight selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.SW.lasso(y0, x0, b, sample)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.SW.lasso_+3A_y0">y0</code></td>
<td>
<p>A numeric vector of response values.</p>
</td></tr>
<tr><td><code id="po.SW.lasso_+3A_x0">x0</code></td>
<td>
<p>A numeric matrix of predictors.</p>
</td></tr>
<tr><td><code id="po.SW.lasso_+3A_b">b</code></td>
<td>
<p>Number of assets to select in each sample.</p>
</td></tr>
<tr><td><code id="po.SW.lasso_+3A_sample">sample</code></td>
<td>
<p>Number of random samples to generate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of optimized portfolio weights.
</p>

<hr>
<h2 id='po.TZT'>Perform Portfolio Optimization Using TZT Method</h2><span id='topic+po.TZT'></span>

<h3>Description</h3>

<p>This function performs portfolio optimization using the TZT method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>po.TZT(x0, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="po.TZT_+3A_x0">x0</code></td>
<td>
<p>A numeric matrix of asset returns.</p>
</td></tr>
<tr><td><code id="po.TZT_+3A_gamma">gamma</code></td>
<td>
<p>A numeric parameter for the TZT method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of optimized portfolio weights.
</p>

<hr>
<h2 id='prepare_data'>Prepare Data for Portfolio Analysis</h2><span id='topic+prepare_data'></span>

<h3>Description</h3>

<p>This function prepares the input data by filtering based on a specified date range, removing the date column,
and handling missing values. It also generates time-related columns and returns the processed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_data(
  dat,
  date_column_index = 1,
  start_date = "19990101",
  end_date = "20231231"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_data_+3A_dat">dat</code></td>
<td>
<p>A data frame or matrix where the first column is the date and the remaining columns are the data.</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_date_column_index">date_column_index</code></td>
<td>
<p>The index of the date column in the input data. Default is 1.</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_start_date">start_date</code></td>
<td>
<p>A character string specifying the start date for filtering the data in 'YYYYMMDD' format.
Default is '19990101'.</p>
</td></tr>
<tr><td><code id="prepare_data_+3A_end_date">end_date</code></td>
<td>
<p>A character string specifying the end date for filtering the data in 'YYYYMMDD' format.
Default is '20231231'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt>x</dt><dd><p>A matrix of the filtered data with missing values handled.</p>
</dd>
<dt>mon</dt><dd><p>A vector of integers representing the number of months from the first date in the data.</p>
</dd>
<dt>count</dt><dd><p>A vector of the number of entries per month.</p>
</dd>
<dt>Date</dt><dd><p>A vector of Date objects representing the filtered dates.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(Date = c("19990101", "19990115", "19990201", "19990301", "19990315", "19990401"),
Var1 = c(1, 2, -99.99, 4, 5, -99.99),
Var2 = c(3, -99.99, 6, 7, 8, 9),
Var3 = c(10, 11, 12, 13, -99.99, 15))
result &lt;- prepare_data(data, date_column_index = 1, start_date = '19990101', end_date = '19990430')
print(result)

</code></pre>

<hr>
<h2 id='ren'>Main Function for Portfolio Analysis</h2><span id='topic+ren'></span>

<h3>Description</h3>

<p>This function integrates data preparation, parallel setup, and portfolio analysis.
It takes raw data as input, prepares it using 'prepare_data', sets up parallel processing
using 'setup_parallel', and performs the analysis using 'perform_analysis'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ren(
  dat,
  date_column_index = 1,
  start_date = "19990101",
  end_date = "20231231",
  num_cores = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ren_+3A_dat">dat</code></td>
<td>
<p>A data frame or matrix where the first column is the date and the remaining columns are the data.</p>
</td></tr>
<tr><td><code id="ren_+3A_date_column_index">date_column_index</code></td>
<td>
<p>The index of the date column in the input data. Default is 1.</p>
</td></tr>
<tr><td><code id="ren_+3A_start_date">start_date</code></td>
<td>
<p>A character string specifying the start date for filtering the data in 'YYYYMMDD' format.
Default is '19990101'.</p>
</td></tr>
<tr><td><code id="ren_+3A_end_date">end_date</code></td>
<td>
<p>A character string specifying the end date for filtering the data in 'YYYYMMDD' format.
Default is '20231231'.</p>
</td></tr>
<tr><td><code id="ren_+3A_num_cores">num_cores</code></td>
<td>
<p>The number of cores to use for parallel processing. Default is 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The results from 'perform_analysis', including plots and performance metrics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# load the sample data
dat(FF25)
# Run the main function
result &lt;- ren(FF25)

# Display results
print(result$cumulative_return_plot)
print(result$cumulative_turnover_plot)

## End(Not run)

</code></pre>

<hr>
<h2 id='setup_parallel'>Setup Parallel Processing for Portfolio Analysis</h2><span id='topic+setup_parallel'></span>

<h3>Description</h3>

<p>This function sets up parallel processing by loading necessary libraries, allowing the user to specify the
number of cores to use, and creating a parallel backend for faster computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_parallel(num_cores = 7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup_parallel_+3A_num_cores">num_cores</code></td>
<td>
<p>The default number of cores to use for parallel processing. Default is 7.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the user to specify the number of cores for parallel processing either through the
argument <code>num_cores</code> or via interactive user input. The function also loads a set of libraries required for
portfolio analysis.
</p>


<h3>Value</h3>

<p>A parallel cluster object that can be used with functions that support parallel computation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set up parallel processing with a specified number of cores
cl &lt;- setup_parallel(num_cores = 2)  # Use 2 cores for the example
print(cl)  # Print the cluster information
parallel::stopCluster(cl)  # Stop the cluster after use to clean up
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
