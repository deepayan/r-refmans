<!DOCTYPE html><html lang="en"><head><title>Help for package BACprior</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BACprior}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BACprior-package'>
<p>Choice of the Hyperparameter Omega in the Bayesian Adjustment for Confounding (BAC) Algorithm</p></a></li>
<li><a href='#BACprior.boot'>
<p>A Bootstrap Procedure to Guide the Choice of Omega in the Bayesian Adjustment for Confounding Algorithm.</p></a></li>
<li><a href='#BACprior.CV'>
<p>A Cross-Validation Procedure for the Choice of the Omega Value in the Bayesian Adjustment for Confounding Algorithm.</p></a></li>
<li><a href='#BACprior.lm'>
<p>Sensitivity of the Bayesian Adjustment for Confounding Algorithm to the Value of the Hyperparameter Omega When the Outcome and the Exposure Are Continuous Variables.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Choice of Omega in the BAC Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Denis Talbot, Genevieve Lefebvre, Juli Atherton</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Denis Talbot &lt;denis.talbot@fmed.ulaval.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The Bayesian Adjustment for Confounding (BAC) algorithm (Wang et al., 2012)
 can be used to estimate the causal effect of a continuous exposure on a continuous outcome.
 This package provides an approximate sensitivity analysis of BAC with regards to the
 hyperparameter omega. BACprior also provides functions to guide the user in their choice
 of an appropriate omega value. The method is based on Lefebvre, Atherton and Talbot (2014).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm, leaps, boot</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-10 17:29:07 UTC; denis</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-10 18:00:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='BACprior-package'>
Choice of the Hyperparameter Omega in the Bayesian Adjustment for Confounding (BAC) Algorithm</h2><span id='topic+BACprior-package'></span><span id='topic+BACprior'></span>

<h3>Description</h3>

<p>The BACprior package contains functions to help the user select the omega value appearing in the BAC prior distribution of the covariate inclusion indicators of the outcome and exposure models. </p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> BACprior</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-10-10</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Denis Talbot, Genevieve Lefebvre, Juli Atherton.
</p>
<p>Maintainer: Denis Talbot <a href="mailto:denis.talbot@fmed.ulaval.ca">denis.talbot@fmed.ulaval.ca</a></p>


<h3>References</h3>

<p>Brookhart, M.A., van der Lan, M.J. (2006). <em>A semiparametric model selection criterion with applications to the marginal structural model</em>, Computational Statistics &amp; Data Analysis, 50, 475-498.
</p>
<p>Hoeting, J.A., Madigan D., Raftery, A.E., Volinsky C.T. (1999). <em>Bayesian model averaging : A tutorial</em>, Statistical Science, 16, 382-417.
</p>
<p>Lefebvre, G., Atherton, J., Talbot, D. (2014). <em>The effect of the prior distribution in the Bayesian Adjustment for Confounding algorithm</em>, Computational Statistics &amp; Data Analysis, 70, 227-240.
</p>
<p>Wang, C., Parmigiani, G., Dominici, F. (2012). <em>Bayesian effect estimation accounting for adjustment uncertainty</em>, Biometrics, 68 (3), 661-671.
</p>

<hr>
<h2 id='BACprior.boot'>
A Bootstrap Procedure to Guide the Choice of Omega in the Bayesian Adjustment for Confounding Algorithm.
</h2><span id='topic+BACprior.boot'></span>

<h3>Description</h3>

<p>The <code>BACprior.boot</code> function proposes a bootstrap procedure to select BAC's omega value in an attempt to minimize the mean squared error (MSE) of the exposure effect estimator. A number B of bootstrap samples are taken from the original sample. Then, the MSE is estimated for each selected omega value, considering the exposure estimate with omega = infinity from the original sample as the true value. The <code>BACprior.boot</code> function uses the <code>BACprior.lm</code> function to estimate the exposure effect.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BACprior.boot(Y, X, U, 
omega = c(1, 1.1, 1.3, 1.6, 2, 5, 10, 30, 50, 100, Inf),
maxmodels = 150, cutoff = 0.0001, B = 100)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BACprior.boot_+3A_y">Y</code></td>
<td>

<p>A vector of observed values for the continuous outcome.
</p>
</td></tr>
<tr><td><code id="BACprior.boot_+3A_x">X</code></td>
<td>

<p>A vector of observed values for the continuous exposure.
</p>
</td></tr>
<tr><td><code id="BACprior.boot_+3A_u">U</code></td>
<td>

<p>A matrix of observed values for the potential confounders, where each column contains observed values for a potential confounder. A recommended implementation is to only consider pre-exposure covariates.
</p>
</td></tr>
<tr><td><code id="BACprior.boot_+3A_omega">omega</code></td>
<td>

<p>A vector of omega values for which the bootstrap procedure is performed. The default is <code>c(1, 1.1, 1.3, 1.6, 2, 5, 10, 30, 50, 100, Inf)</code>. 
</p>
</td></tr>
<tr><td><code id="BACprior.boot_+3A_maxmodels">maxmodels</code></td>
<td>

<p>The maximum number of outcome and exposure models of each size to be considered. Larger numbers improves the approximation, but can greatly increase the computational burden. The default is <code>150</code>.
</p>
</td></tr>
<tr><td><code id="BACprior.boot_+3A_cutoff">cutoff</code></td>
<td>

<p>Minimum posterior probability needed for an outcome model to be considered in the weighted average of the posterior mean and standard deviation of the exposure effect. Smaller values of <code>cutoff</code> improves the approximation, but add computational complexity. The default is <code>0.0001</code>.
</p>
</td></tr>
<tr><td><code id="BACprior.boot_+3A_b">B</code></td>
<td>
<p>The number of bootstrap samples to be taken. Larger numbers reduce Monte Carlo error, but require more computation time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since <code>BACprior.boot</code> uses the <code>BACprior.lm</code> function to estimate the exposure effect, users should refer to the <code>BACprior.lm</code> documentation for details of implementation.
</p>
<p><code>BACprior.boot</code> assumes there are no missing values. The objects <code>X</code>, <code>Y</code> and <code>U</code> should be processed beforehand so that every case is complete. The <code>na.omit</code> function which removes cases with missing data or an imputation package might be helpful.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Best</code></td>
<td>
<p>The omega value, among the omega values given in input, which minimizes the estimated MSE.</p>
</td></tr>
<tr><td><code>MSE</code></td>
<td>
<p>The estimated MSE for each of the selected omega values.</p>
</td></tr>
</table>
<p><code>BACprior.boot</code> also returns a plot of the estimated MSEs according to the selected omega values.
</p>


<h3>Author(s)</h3>

<p>Denis Talbot, Genevieve Lefebvre, Juli Atherton.
</p>


<h3>References</h3>

<p>Brookhart, M.A., van der Laan, M.J. (2006). <em>A semiparametric model selection criterion with applications to the marginal structural model</em>, Computational Statistics &amp; Data Analysis, 50, 475-498.
</p>
<p>Lefebvre, G., Atherton, J., Talbot, D. (2014). <em>The effect of the prior distribution in the Bayesian Adjustment for Confounding algorithm</em>, Computational Statistics &amp; Data Analysis, 70, 227-240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BACprior.lm">BACprior.lm</a></code>, <code><a href="#topic+BACprior.CV">BACprior.CV</a></code>,   <code><a href="stats.html#topic+na.omit">na.omit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Required package to simulate from a multivariate normal distribution.
require(mvtnorm);


# Simulate data
# n = 500 observations with 5 covariates.
# (U1, U2, U4) is multivariate normal with mean vector 0,
# variances of 1 and 0 pairwise correlations.
# U3 and U5 are causal effects of U2 and U4, respectively.
# X is a causal effect of U1, U2 and U4.
# Y is a causal effect of U3, U4, U5 and X.

set.seed(3417817);
n = 500;
U = rmvnorm(n = n, mean = rep(0, 5), sigma = diag(1, nrow = 5) + matrix(0, nrow = 5, ncol = 5));
U[,3] = U[,2] + rnorm(n);
U[,5] = U[,4] + rnorm(n);
X = U[,1] + U[,2] + U[,4] + rnorm(n);
Y = U[,3] + 0.1*U[,4] + U[,5] + 0.1*X + rnorm(n);

# Remove  ``#'' to run example 
# BACprior.boot(Y, X, U, maxmodels = 150); 
# $best
# [1] 1
# $MSE
#  [1] 0.001467631 0.001480494 0.001505006 0.001539194 0.001580756
# 0.001803000 0.002017034 0.002375198 0.002516998 0.002662188 0.002865611
# Best omega value would be 1
BACprior.lm(Y, X, U);
# $results
#       omega Posterior mean Standard deviation
#  [1,]   1.0      0.1089228         0.02951582
#  [2,]   1.1      0.1087689         0.02971457
#  [3,]   1.3      0.1084802         0.03008991
#  [4,]   1.6      0.1080900         0.03060449
#  [5,]   2.0      0.1076376         0.03121568
#  [6,]   5.0      0.1057020         0.03426854
#  [7,]  10.0      0.1046804         0.03696670
#  [8,]  30.0      0.1044711         0.04124805
#  [9,]  50.0      0.1047315         0.04291842
# [10,] 100.0      0.1051211         0.04462874
# [11,]   Inf      0.1058021         0.04703111

# Posterior mean doesn't change much with omega,
# but posterior standard deviation greatly increases.
# This supports the choice of omega = 1.
</code></pre>

<hr>
<h2 id='BACprior.CV'>
A Cross-Validation Procedure for the Choice of the Omega Value in the Bayesian Adjustment for Confounding Algorithm.
</h2><span id='topic+BACprior.CV'></span>

<h3>Description</h3>

<p>The <code>BACprior.CV</code> function proposes two cross-validation procedures to select BAC's omega value in an attempt to minimize the mean squared error (MSE) of the exposure effect estimator. The data are split into half <code>V</code> times. Each time, the exposure effect is estimated with omega = infinity on one half of the data. On the other half of the data, the exposure effect is estimated for each of the selected omega values. A criterion to be minimized is then computed. Details can be found in Lefebvre et al. (2014), which is inspired by a procedure proposed by Brookhart and van der Laan (2006). The <code>BACprior.CV</code> function uses the <code>BACprior.lm</code> function to estimate the exposure effect.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BACprior.CV(Y, X, U, 
omega = c(1, 1.1, 1.3, 1.6, 2, 5, 10, 30, 50, 100, Inf),
maxmodels = 150, cutoff = 0.0001, V = 100, criterion = "CVm")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BACprior.CV_+3A_y">Y</code></td>
<td>

<p>A vector of observed values for the continuous outcome.
</p>
</td></tr>
<tr><td><code id="BACprior.CV_+3A_x">X</code></td>
<td>

<p>A vector of observed values for the continuous exposure.
</p>
</td></tr>
<tr><td><code id="BACprior.CV_+3A_u">U</code></td>
<td>

<p>A matrix of observed values for the potential confounders, where each column contains observed values for a potential confounder. A recommended implementation is to only consider pre-exposure covariates.
</p>
</td></tr>
<tr><td><code id="BACprior.CV_+3A_omega">omega</code></td>
<td>

<p>A vector of omega values for which the cross-validation procedure is performed. The default is <code>c(1, 1.1, 1.3, 1.6, 2, 5, 10, 30, 50, 100, Inf)</code>. 
</p>
</td></tr>
<tr><td><code id="BACprior.CV_+3A_maxmodels">maxmodels</code></td>
<td>

<p>The maximum number of outcome and exposure models of each size to be considered. Larger numbers improves the approximation, but can greatly increase the computational burden. The default is <code>150</code>.
</p>
</td></tr>
<tr><td><code id="BACprior.CV_+3A_cutoff">cutoff</code></td>
<td>

<p>Minimum posterior probability needed for an outcome model to be considered in the weighted average of the posterior mean and standard deviation of the exposure effect. Smaller values of <code>cutoff</code> improves the approximation, but add computational complexity. The default is <code>0.0001</code>.
</p>
</td></tr>
<tr><td><code id="BACprior.CV_+3A_v">V</code></td>
<td>
<p>The number of times the data are split into half. Larger numbers reduce Monte Carlo error, but require more computation time.</p>
</td></tr>
<tr><td><code id="BACprior.CV_+3A_criterion">criterion</code></td>
<td>
<p>The criterion based on MSE to be computed and minimized. The possible values are &ldquo;CVm&rdquo; and &ldquo;CV&rdquo; and the default is &ldquo;CVm&rdquo;. Both criteria are detailed in Lefebvre et al. (2014).</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Since <code>BACprior.CV</code> uses the <code>BACprior.lm</code> function to estimate the exposure effect, users should refer to the <code>BACprior.lm</code> documentation for details of implementation.
</p>
<p><code>BACprior.CV</code> assumes there are no missing values. The objects <code>X</code>, <code>Y</code> and <code>U</code> should be processed beforehand so that every case is complete. The <code>na.omit</code> function which removes cases with missing data or an imputation package might be helpful.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Best</code></td>
<td>
<p>The omega value, among the omega values given in input, which minimizes the selected criterion.</p>
</td></tr>
<tr><td><code>Criterion.Value</code></td>
<td>
<p>The criterion values for the selected omega values.</p>
</td></tr>
</table>
<p><code>BACprior.CV</code> also returns a plot of the criterion values according to the selected omega values.
</p>


<h3>Author(s)</h3>

<p>Denis Talbot, Genevieve Lefebvre, Juli Atherton.
</p>


<h3>References</h3>

<p>Brookhart, M.A., van der Laan, M.J. (2006). <em>A semiparametric model selection criterion with applications to the marginal structural model</em>, Computational Statistics &amp; Data Analysis, 50, 475-498.
</p>
<p>Lefebvre, G., Atherton, J., Talbot, D. (2014). <em>The effect of the prior distribution in the Bayesian Adjustment for Confounding algorithm</em>, Computational Statistics &amp; Data Analysis, 70, 227-240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BACprior.lm">BACprior.lm</a></code>, <code><a href="#topic+BACprior.boot">BACprior.boot</a></code>,   <code><a href="stats.html#topic+na.omit">na.omit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Required package to simulate from a multivariate normal distribution.
require(mvtnorm);


# Simulate data
# n = 500 observations with 5 covariates.
# (U1, U2, U4) is multivariate normal with mean vector 0,
# variances of 1 and 0 pairwise correlations.
# U3 and U5 are causal effects of U2 and U4, respectively.
# X is a causal effect of U1, U2 and U4.
# Y is a causal effect of U3, U4, U5 and X. 

set.seed(3417817);
n = 500;
U = rmvnorm(n = n, mean = rep(0, 5), sigma = diag(1, nrow = 5) + matrix(0, nrow = 5, ncol = 5));
U[,3] = U[,2] + rnorm(n);
U[,5] = U[,4] + rnorm(n);
X = U[,1] + U[,2] + U[,4] + rnorm(n);
Y = U[,3] + 0.1*U[,4] + U[,5] + 0.1*X + rnorm(n);

# Remove  ``#'' to run example 
# BACprior.CV(Y, X, U, maxmodels = 150, criterion = "CVm"); 

# $best
# [1] 1
# $Criterion
#  [1] 0.0008764926 0.0008817157 0.0008916412 0.0009056528 0.0009233560
#  0.0010425601 0.0012070083 0.0015884799 0.0017678894 0.0019616864 0.0022413220
# Best omega value would be 1

BACprior.lm(Y, X, U);
# $results
#       omega Posterior mean Standard deviation
#  [1,]   1.0      0.1089228         0.02951582
#  [2,]   1.1      0.1087689         0.02971457
#  [3,]   1.3      0.1084802         0.03008991
#  [4,]   1.6      0.1080900         0.03060449
#  [5,]   2.0      0.1076376         0.03121568
#  [6,]   5.0      0.1057020         0.03426854
#  [7,]  10.0      0.1046804         0.03696670
#  [8,]  30.0      0.1044711         0.04124805
#  [9,]  50.0      0.1047315         0.04291842
# [10,] 100.0      0.1051211         0.04462874
# [11,]   Inf      0.1058021         0.04703111
# Posterior mean doesn't change much with omega,
# but posterior standard deviation greatly increases.
# This supports the choice of omega = 1.
</code></pre>

<hr>
<h2 id='BACprior.lm'>
Sensitivity of the Bayesian Adjustment for Confounding Algorithm to the Value of the Hyperparameter Omega When the Outcome and the Exposure Are Continuous Variables.
</h2><span id='topic+BACprior.lm'></span>

<h3>Description</h3>

<p>The BACprior.lm function provides estimates of the posterior mean and posterior standard deviation of the exposure effect for selected values of omega in the covariate inclusion indicators' prior distribution. The output allows the user to evaluate how sensitive the BAC procedure is to the choice of the hyperparameter omega value.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BACprior.lm(Y, X, U, 
omega = c(1, 1.1, 1.3, 1.6, 2, 5, 10, 30, 50, 100, Inf),
maxmodels = 150, cutoff = 0.0001, return.best = FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BACprior.lm_+3A_y">Y</code></td>
<td>

<p>A vector of observed values for the continuous outcome.
</p>
</td></tr>
<tr><td><code id="BACprior.lm_+3A_x">X</code></td>
<td>

<p>A vector of observed values for the continuous exposure.
</p>
</td></tr>
<tr><td><code id="BACprior.lm_+3A_u">U</code></td>
<td>

<p>A matrix of observed values for the potential confounders, where each column contains observed values for a potential confounder. A recommended implementation is to only consider pre-exposure covariates.
</p>
</td></tr>
<tr><td><code id="BACprior.lm_+3A_omega">omega</code></td>
<td>

<p>A vector of omega values for which the sensitivity analysis is performed. The default is <code>c(1, 1.1, 1.3, 1.6, 2, 5, 10, 30, 50, 100, Inf)</code>. 
</p>
</td></tr>
<tr><td><code id="BACprior.lm_+3A_maxmodels">maxmodels</code></td>
<td>

<p>The maximum number of outcome and exposure models of each size to be considered. Larger numbers improves the approximation, but can greatly increase the computational burden. The default is <code>150</code>.
</p>
</td></tr>
<tr><td><code id="BACprior.lm_+3A_cutoff">cutoff</code></td>
<td>

<p>Minimum posterior probability needed for an outcome model to be considered in the weighted average of the posterior mean and standard deviation of the exposure effect. Smaller values of <code>cutoff</code> improves the approximation, but add computational complexity. The default is <code>0.0001</code>.
</p>
</td></tr>
<tr><td><code id="BACprior.lm_+3A_return.best">return.best</code></td>
<td>
<p>If <code>TRUE</code>, <code>BACprior.lm</code> returns outcome models meeting the <code>cutoff</code> criterion and their posterior probabilities. The default if <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only the best <code>maxmodels</code> of each size are recorded for both the outcome and exposure models. The marginal likelihoods of these models are a function of the corresponding BIC values. The posterior mean of the exposure effect parameter is the weighted average of the maximum likelihood estimates, where the weights are the posterior probabilities of the outcome models. The standard deviation of the exposure effect parameter accounts for both the within- and between-model variability (Hoeting et al., 1999), where the within-model variability is given by the standard error of the maximum likelihood exposure effect estimate for the model.
</p>
<p><code>BAC.prior.lm</code> assumes there are no missing values. The objects <code>X</code>, <code>Y</code> and <code>U</code> should be processed beforehand so that every case is complete. The <code>na.omit</code> function which removes cases with missing data or an imputation package might be helpful.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>results</code></td>
<td>
<p>A matrix in which the first column contains the selected <code>omega</code> values, the second column contains the posterior mean of the exposure effect for each <code>omega</code> value and the third column contains the standard deviation of the exposure effect for each <code>omega</code> value.</p>
</td></tr>
<tr><td><code>best.models</code></td>
<td>
<p>Only returned if <code>return.best = TRUE</code>. A logical matrix whose columns represent the different potential confounders in <code>U</code> and whose lines indicate which covariates are included in a given outcome model. Only outcome models that have a posterior probability larger than the <code>cutoff</code> value for at least one <code>omega</code> value are returned.</p>
</td></tr>
<tr><td><code>posterior.prob</code></td>
<td>
<p>Only returned if <code>return.best = TRUE</code>. A matrix containing the posterior probability of each outcome model in the set of <code>best.models</code> for the different <code>omega</code> values. Each line represents a different outcome model and each column corresponds to one of the selected omega value.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If either the null outcome model (intercept + exposure only) or the null exposure model (intercept only) have a nonnegligible weight, the approximate inferences given by this function might be poor. This occurs since the <code>regsubset</code> function used to find the best models of each size does not return null models.
</p>


<h3>Author(s)</h3>

<p>Denis Talbot, Genevieve Lefebvre, Juli Atherton.
</p>


<h3>References</h3>

<p>Hoeting, J.A., Madigan D., Raftery, A.E., Volinsky C.T. (1999). <em>Bayesian model averaging : A tutorial</em>, Statistical Science, 16, 382-417.
</p>
<p>Lefebvre, G., Atherton, J., Talbot, D. (2014). <em>The effect of the prior distribution in the Bayesian Adjustment for Confounding algorithm</em>, Computational Statistics &amp; Data Analysis, 70, 227-240.
</p>
<p>Wang, C., Parmigiani, G., Dominici, F. (2012). <em>Bayesian effect estimation accounting for adjustment uncertainty</em>, Biometrics, 68 (3), 661-671.
</p>


<h3>See Also</h3>

<p><code><a href="leaps.html#topic+regsubsets">regsubsets</a></code>, <code><a href="stats.html#topic+na.omit">na.omit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Required package to simulate from a multivariate normal distribution.
require(mvtnorm);
	
# Simulate data
# n = 500 observations with 10 covariates.
# (U1, U2, U4, U6, U7, U8, U9, U10) is multivariate normal
# with mean vector 0, variances of 1 and pairwise correlations of 0.25.
# U3 and U5 are causal effects of U2 and U4, respectively.
# X is a causal effect of U1, U2 and U4.
# Y is a causal effect of X, U3, U4 and U5.
# The true exposure effect is 0.1.
	ncov = 10;
	n = 500;
	U = rmvnorm(n = n, mean = rep(0, ncov),
	 sigma = diag(0.75, nrow = ncov) + matrix(0.25, nrow = ncov, ncol = ncov));
	U[,3] = U[,2] + rnorm(n);
	U[,5] = U[,4] + rnorm(n);
	X = 0.5*U[,1] + 0.5*U[,2] + U[,4] + rnorm(n);
	Y = U[,3] + 0.3*U[,4] + U[,5] + 0.1*X + rnorm(n);

	BACprior.lm(Y, X, U, omega = c(1, 1.5, 2, 5, 10, 50, 100, Inf));
	</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
