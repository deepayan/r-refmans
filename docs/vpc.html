<!DOCTYPE html><html><head><title>Help for package vpc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vpc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#vpc-package'><p>VPC package</p></a></li>
<li><a href='#add_noise'><p>Add noise / residual error to data</p></a></li>
<li><a href='#add_sim_index_number'><p>Add sim index number</p></a></li>
<li><a href='#add_stratification'><p>Adds stratification to data set</p></a></li>
<li><a href='#auto_bin'><p>Calculate appropriate bin separators for vpc</p></a></li>
<li><a href='#bin_data'><p>Function to bin data based on a vector of bin separators, e.g. for use in VPC</p></a></li>
<li><a href='#check_stratification_columns_available'><p>Check whether stratification columns are available</p></a></li>
<li><a href='#compute_kaplan'><p>Compute Kaplan-Meier statistics</p></a></li>
<li><a href='#compute_kmmc'><p>Compute KMMC statistics</p></a></li>
<li><a href='#create_vpc_theme'><p>Create new vpc theme</p></a></li>
<li><a href='#define_data_columns'><p>Define data column defaults for various softwares</p></a></li>
<li><a href='#draw_params_mvr'><p>Draw parameters from multivariate distribution</p></a></li>
<li><a href='#loq_perc'><p>Calculate percentiles below / above lloq / uloq</p></a></li>
<li><a href='#new_vpc_theme'><p>Create a customized VPC theme</p></a></li>
<li><a href='#pk_iv_1cmt'><p>Simulate PK data from a 1-compartment iv model</p></a></li>
<li><a href='#pk_oral_1cmt'><p>Simulate PK data from a 1-compartment oral model</p></a></li>
<li><a href='#plot_vpc'><p>VPC plotting function</p></a></li>
<li><a href='#quantile_cens'><p>Calculate quantiles respecting the censored data</p></a></li>
<li><a href='#read_table_nm'><p>NONMEM output table import function</p></a></li>
<li><a href='#replace_list_elements'><p>Replace list elements by name</p></a></li>
<li><a href='#rtte_obs_nm'><p>Simulated RTTE data (1x)</p></a></li>
<li><a href='#rtte_sim_nm'><p>Simulated RTTE data (100x)</p></a></li>
<li><a href='#show_default'><p>Defaults for show argument</p></a></li>
<li><a href='#show_default_tte'><p>Defaults for show argument for TTE VPC</p></a></li>
<li><a href='#sim_data'><p>Simulate data based on a model and parameter distributions</p></a></li>
<li><a href='#simple_data'><p>A small rich dataset</p></a></li>
<li><a href='#theme_empty'><p>Empty ggplot2 theme</p></a></li>
<li><a href='#theme_plain'><p>A nicer default theme for ggplot2</p></a></li>
<li><a href='#triangle_to_full'><p>Lower to full triangle</p></a></li>
<li><a href='#vpc'><p>VPC function</p></a></li>
<li><a href='#vpc_cat'><p>VPC function for categorical</p></a></li>
<li><a href='#vpc_cens'><p>VPC function for left- or right-censored data (e.g. BLOQ data)</p></a></li>
<li><a href='#vpc_tte'><p>VPC function for time-to-event (survival) data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Create Visual Predictive Checks</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-01-11</td>
</tr>
<tr>
<td>Author:</td>
<td>Ron Keizer &lt;ronkeizer@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ron Keizer &lt;ronkeizer@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Visual predictive checks are a commonly used diagnostic plot in pharmacometrics, showing how certain statistics (percentiles) for observed data compare to those same statistics for data simulated from a model. The package can generate VPCs for continuous, categorical, censored, and (repeated) time-to-event data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>classInt, dplyr, MASS, survival, ggplot2, readr, stringr,
tidyr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ronkeizer/vpc">https://github.com/ronkeizer/vpc</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testit</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-11 19:53:47 UTC; ronkeizer</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-11 20:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='vpc-package'>VPC package</h2><span id='topic+vpc-package'></span>

<h3>Description</h3>

<p>Create Visual Predictive Checks in R
</p>


<h3>Author(s)</h3>

<p>Ron Keizer <a href="mailto:ronkeizer@gmail.com">ronkeizer@gmail.com</a>
</p>

<hr>
<h2 id='add_noise'>Add noise / residual error to data</h2><span id='topic+add_noise'></span>

<h3>Description</h3>

<p>Add noise / residual error to data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_noise(x, ruv = list(proportional = 0, additive = 0, exponential = 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_noise_+3A_x">x</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="add_noise_+3A_ruv">ruv</code></td>
<td>
<p>list describing the magnitude of errors. List arguments: &quot;proportional&quot;, &quot;additive&quot;, &quot;exponential&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
ipred &lt;- c(10, 8, 6, 4, 2, 0) %&gt;% add_noise(ruv = list(proportional = 0.1, additive = 0.2))
</code></pre>

<hr>
<h2 id='add_sim_index_number'>Add sim index number</h2><span id='topic+add_sim_index_number'></span>

<h3>Description</h3>

<p>Add simulation index number to simulation when not present
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_sim_index_number(sim, id = "id", sim_label = "sim")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_sim_index_number_+3A_sim">sim</code></td>
<td>
<p>a data.frame containing the simulation data</p>
</td></tr>
<tr><td><code id="add_sim_index_number_+3A_id">id</code></td>
<td>
<p>character specifying the column name in the data.frame</p>
</td></tr>
<tr><td><code id="add_sim_index_number_+3A_sim_label">sim_label</code></td>
<td>
<p>label to indicate simulation index (if available)</p>
</td></tr>
</table>

<hr>
<h2 id='add_stratification'>Adds stratification to data set</h2><span id='topic+add_stratification'></span>

<h3>Description</h3>

<p>Adds stratification to data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_stratification(dat, strat, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_stratification_+3A_dat">dat</code></td>
<td>
<p>data.frame</p>
</td></tr>
<tr><td><code id="add_stratification_+3A_strat">strat</code></td>
<td>
<p>vector of stratification variables</p>
</td></tr>
<tr><td><code id="add_stratification_+3A_verbose">verbose</code></td>
<td>
<p>verbosity ('TRUE' or 'FALSE')</p>
</td></tr>
</table>

<hr>
<h2 id='auto_bin'>Calculate appropriate bin separators for vpc</h2><span id='topic+auto_bin'></span><span id='topic+auto_bin.numeric'></span><span id='topic+auto_bin.data.frame'></span>

<h3>Description</h3>

<p>This function calculates bin separators either using R's native binning
approaches available in the classInt library such as 'kmeans', 'jenks',
'pretty' etc. Alternatively, a custom approach is available which is based on
finding the nadirs in the density functions for the independent variable.
Default approach is k-means clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto_bin(dat, type = "kmeans", n_bins = 8, verbose = FALSE, ...)

## S3 method for class 'numeric'
auto_bin(dat, type = "kmeans", n_bins = 8, verbose = FALSE, ...)

## S3 method for class 'data.frame'
auto_bin(dat, type = "kmeans", n_bins = 8, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auto_bin_+3A_dat">dat</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="auto_bin_+3A_type">type</code></td>
<td>
<p>auto-binning type: &quot;density&quot;, &quot;time&quot;, or &quot;data&quot;</p>
</td></tr>
<tr><td><code id="auto_bin_+3A_n_bins">n_bins</code></td>
<td>
<p>number of bins to use; either a positive integer or &quot;auto&quot;. For
&quot;density&quot; the function might not return a solution with the exact number of
bins.</p>
</td></tr>
<tr><td><code id="auto_bin_+3A_verbose">verbose</code></td>
<td>
<p>show warnings and other messages (TRUE or FALSE)</p>
</td></tr>
<tr><td><code id="auto_bin_+3A_...">...</code></td>
<td>
<p>arguments passed on to underlying binning functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of bin separators
</p>

<hr>
<h2 id='bin_data'>Function to bin data based on a vector of bin separators, e.g. for use in VPC</h2><span id='topic+bin_data'></span>

<h3>Description</h3>

<p>Function to bin data based on a vector of bin separators, e.g. for use in VPC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bin_data(x, bins = c(0, 3, 5, 7), idv = "time", labeled = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bin_data_+3A_x">x</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="bin_data_+3A_bins">bins</code></td>
<td>
<p>numeric vector specifying bin separators</p>
</td></tr>
<tr><td><code id="bin_data_+3A_idv">idv</code></td>
<td>
<p>variable in the data specifies the independent variable (e.g. &quot;time&quot;)</p>
</td></tr>
<tr><td><code id="bin_data_+3A_labeled">labeled</code></td>
<td>
<p>whether a labeled factor instead of integers should be returned</p>
</td></tr>
</table>

<hr>
<h2 id='check_stratification_columns_available'>Check whether stratification columns are available</h2><span id='topic+check_stratification_columns_available'></span>

<h3>Description</h3>

<p>Check whether stratification columns are available
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_stratification_columns_available(data, stratify, type = "observation")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_stratification_columns_available_+3A_data">data</code></td>
<td>
<p>'data.frame' with observation or simulation data</p>
</td></tr>
<tr><td><code id="check_stratification_columns_available_+3A_stratify">stratify</code></td>
<td>
<p>vector of stratification columns</p>
</td></tr>
<tr><td><code id="check_stratification_columns_available_+3A_type">type</code></td>
<td>
<p>either 'observation' or 'simulation'</p>
</td></tr>
</table>

<hr>
<h2 id='compute_kaplan'>Compute Kaplan-Meier statistics</h2><span id='topic+compute_kaplan'></span>

<h3>Description</h3>

<p>Compute Kaplan-Meier statistics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_kaplan(
  dat,
  strat = "strat",
  reverse_prob = FALSE,
  rtte_conditional = TRUE,
  ci = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_kaplan_+3A_dat">dat</code></td>
<td>
<p>data.frame with events</p>
</td></tr>
<tr><td><code id="compute_kaplan_+3A_strat">strat</code></td>
<td>
<p>vector of stratification variables</p>
</td></tr>
<tr><td><code id="compute_kaplan_+3A_reverse_prob">reverse_prob</code></td>
<td>
<p>reverse the probability (i.e. return '1-probability')?</p>
</td></tr>
<tr><td><code id="compute_kaplan_+3A_rtte_conditional">rtte_conditional</code></td>
<td>
<p>'TRUE' (default) or 'FALSE'. Compute the probability for each event newly ('TRUE'), or calculate the absolute probability ('FALSE', i.e. the &quot;probability of a 1st, 2nd, 3rd event etc&quot; rather than the &quot;probability of an event happening&quot;).</p>
</td></tr>
<tr><td><code id="compute_kaplan_+3A_ci">ci</code></td>
<td>
<p>confidence interval to calculate, numeric vector of length 2</p>
</td></tr>
</table>

<hr>
<h2 id='compute_kmmc'>Compute KMMC statistics</h2><span id='topic+compute_kmmc'></span>

<h3>Description</h3>

<p>Kaplan-Meier Mean Covariate plots are a simulation-based diagnostic to study the influence of covariates and identify potential model misspecification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_kmmc(dat, strat = NULL, reverse_prob = FALSE, kmmc = "DOSE")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_kmmc_+3A_dat">dat</code></td>
<td>
<p>data.frame with events</p>
</td></tr>
<tr><td><code id="compute_kmmc_+3A_strat">strat</code></td>
<td>
<p>vector of stratification variables</p>
</td></tr>
<tr><td><code id="compute_kmmc_+3A_reverse_prob">reverse_prob</code></td>
<td>
<p>reverse the probability (i.e. return '1-probability')?</p>
</td></tr>
<tr><td><code id="compute_kmmc_+3A_kmmc">kmmc</code></td>
<td>
<p>variable to create the KMMC plot for.</p>
</td></tr>
</table>

<hr>
<h2 id='create_vpc_theme'>Create new vpc theme</h2><span id='topic+create_vpc_theme'></span>

<h3>Description</h3>

<p>Create new vpc theme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_vpc_theme(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_vpc_theme_+3A_...">...</code></td>
<td>
<p>pass arguments to 'new_vpc_theme'</p>
</td></tr>
</table>

<hr>
<h2 id='define_data_columns'>Define data column defaults for various softwares</h2><span id='topic+define_data_columns'></span>

<h3>Description</h3>

<p>Define data column defaults for various softwares
</p>


<h3>Usage</h3>

<pre><code class='language-R'>define_data_columns(sim, obs, sim_cols, obs_cols, software_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="define_data_columns_+3A_sim">sim</code></td>
<td>
<p>simulated data</p>
</td></tr>
<tr><td><code id="define_data_columns_+3A_obs">obs</code></td>
<td>
<p>observed data</p>
</td></tr>
<tr><td><code id="define_data_columns_+3A_sim_cols">sim_cols</code></td>
<td>
<p>list for mapping simulation data columns, e.g. 'list(dv = &quot;DV&quot;, id = &quot;ID&quot;, idv = &quot;TIME&quot;, pred=&quot;PRED&quot;)'</p>
</td></tr>
<tr><td><code id="define_data_columns_+3A_obs_cols">obs_cols</code></td>
<td>
<p>list for mapping observation data columns, e.g. 'list(dv = &quot;DV&quot;, id = &quot;ID&quot;, idv = &quot;TIME&quot;, pred=&quot;PRED&quot;)'</p>
</td></tr>
<tr><td><code id="define_data_columns_+3A_software_type">software_type</code></td>
<td>
<p>software type, one of 'nonmem', 'phoenix', 'PKPDsim'</p>
</td></tr>
</table>

<hr>
<h2 id='draw_params_mvr'>Draw parameters from multivariate distribution</h2><span id='topic+draw_params_mvr'></span>

<h3>Description</h3>

<p>Draw parameters from multivariate distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw_params_mvr(ids, n_sim, theta, omega_mat, par_names = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw_params_mvr_+3A_ids">ids</code></td>
<td>
<p>vector of id numbers</p>
</td></tr>
<tr><td><code id="draw_params_mvr_+3A_n_sim">n_sim</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="draw_params_mvr_+3A_theta">theta</code></td>
<td>
<p>theta vector</p>
</td></tr>
<tr><td><code id="draw_params_mvr_+3A_omega_mat">omega_mat</code></td>
<td>
<p>omega matrix</p>
</td></tr>
<tr><td><code id="draw_params_mvr_+3A_par_names">par_names</code></td>
<td>
<p>parameter names vector</p>
</td></tr>
</table>

<hr>
<h2 id='loq_perc'>Calculate percentiles below / above lloq / uloq</h2><span id='topic+loq_perc'></span>

<h3>Description</h3>

<p>Calculate percentiles below / above lloq / uloq
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loq_perc(x, limit = 1, cens = "left")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loq_perc_+3A_x">x</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="loq_perc_+3A_limit">limit</code></td>
<td>
<p>censoring limit</p>
</td></tr>
<tr><td><code id="loq_perc_+3A_cens">cens</code></td>
<td>
<p>censoring direction (left/right)</p>
</td></tr>
</table>

<hr>
<h2 id='new_vpc_theme'>Create a customized VPC theme</h2><span id='topic+new_vpc_theme'></span>

<h3>Description</h3>

<p>Create a customized VPC theme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_vpc_theme(update = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_vpc_theme_+3A_update">update</code></td>
<td>
<p>list containing the plot elements to be updated. Run 'new_vpc_theme()' with no arguments to show an overview of available plot elements.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a theme that customizes how the VPC looks, i.e. colors, fills, transparencies, linetypes an sizes, etc. The following arguments can be specified in the input list:
</p>

<ul>
<li><p>obs_color: color for observations points
</p>
</li>
<li><p>obs_size: size for observation points
</p>
</li>
<li><p>obs_median_color: color for median observation line
</p>
</li>
<li><p>obs_median_linetype: linetype for median observation line
</p>
</li>
<li><p>obs_median_size: size for median observation line
</p>
</li>
<li><p>obs_ci_fill: color for observation CI fill
</p>
</li>
<li><p>obs_ci_color: color for observation CI lines
</p>
</li>
<li><p>obs_ci_linetype: linetype for observation CI lines
</p>
</li>
<li><p>obs_ci_size: size for observations CI lines
</p>
</li>
<li><p>sim_pi_fill: fill color for simulated prediction interval areas
</p>
</li>
<li><p>sim_pi_alpha: transparency for simulated prediction interval areas
</p>
</li>
<li><p>sim_pi_color: color for simulated prediction interval lines
</p>
</li>
<li><p>sim_pi_linetype: linetype for simulated prediction interval lines
</p>
</li>
<li><p>sim_pi_size: size for simulated prediction interval lines
</p>
</li>
<li><p>sim_median_fill: fill color for simulated median area
</p>
</li>
<li><p>sim_median_alpha: transparency for simulated median area
</p>
</li>
<li><p>sim_median_color: color for simulated median line
</p>
</li>
<li><p>sim_median_linetype: linetype for simulated median line
</p>
</li>
<li><p>sim_median_size: size for simulated median line
</p>
</li>
<li><p>bin_separators_color: color for bin separator lines, NA for don't plot
</p>
</li>
<li><p>bin_separators_location: where to plot bin separators (&quot;t&quot; for top, &quot;b&quot; for bottom)
</p>
</li>
<li><p>loq_color: color of line showing limit of quantification
</p>
</li></ul>



<h3>Value</h3>

<p>A list with vpc theme specifiers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>theme1 &lt;- new_vpc_theme(update = list(
  obs_color = "red",
  obs_ci_color = "#aa0000",
  obs_alpha = .3,
  sim_pi_fill = "#cc8833",
  sim_pi_size = 2
))
vpc(simple_data$sim, simple_data$obs, vpc_theme = theme1)

</code></pre>

<hr>
<h2 id='pk_iv_1cmt'>Simulate PK data from a 1-compartment iv model</h2><span id='topic+pk_iv_1cmt'></span>

<h3>Description</h3>

<p>Simulate PK data from a 1-compartment iv model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk_iv_1cmt(
  t,
  t_inf = 1,
  tau = 24,
  dose = 120,
  CL = 0.345,
  Vc = 1.75,
  ruv = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pk_iv_1cmt_+3A_t">t</code></td>
<td>
<p>Time after dose</p>
</td></tr>
<tr><td><code id="pk_iv_1cmt_+3A_t_inf">t_inf</code></td>
<td>
<p>Infusion length</p>
</td></tr>
<tr><td><code id="pk_iv_1cmt_+3A_tau">tau</code></td>
<td>
<p>Dosing interval</p>
</td></tr>
<tr><td><code id="pk_iv_1cmt_+3A_dose">dose</code></td>
<td>
<p>Dose</p>
</td></tr>
<tr><td><code id="pk_iv_1cmt_+3A_cl">CL</code></td>
<td>
<p>Clearance</p>
</td></tr>
<tr><td><code id="pk_iv_1cmt_+3A_vc">Vc</code></td>
<td>
<p>Volume of distribution</p>
</td></tr>
<tr><td><code id="pk_iv_1cmt_+3A_ruv">ruv</code></td>
<td>
<p>Residual variability</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of predicted values, with or without added residual variability
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat1 &lt;- vpc:::pk_iv_1cmt(t = c(0:72), tau = 24, dose = 120, 
                   CL = 5, Vc = 50)
dat2 &lt;- vpc:::pk_iv_1cmt(t = c(0:72), tau = 24, dose = 120, 
                   CL = 5, Vc = 50, 
                   ruv = list(proportional = 0.1, additive = 0.1))
</code></pre>

<hr>
<h2 id='pk_oral_1cmt'>Simulate PK data from a 1-compartment oral model</h2><span id='topic+pk_oral_1cmt'></span>

<h3>Description</h3>

<p>Simulate PK data from a 1-compartment oral model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pk_oral_1cmt(t, tau = 24, dose = 120, ka = 1, ke = 1, cl = 10, ruv = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pk_oral_1cmt_+3A_t">t</code></td>
<td>
<p>Time after dose</p>
</td></tr>
<tr><td><code id="pk_oral_1cmt_+3A_tau">tau</code></td>
<td>
<p>Dosing interval</p>
</td></tr>
<tr><td><code id="pk_oral_1cmt_+3A_dose">dose</code></td>
<td>
<p>Dose</p>
</td></tr>
<tr><td><code id="pk_oral_1cmt_+3A_ka">ka</code></td>
<td>
<p>Absorption rate</p>
</td></tr>
<tr><td><code id="pk_oral_1cmt_+3A_ke">ke</code></td>
<td>
<p>Elimination rate</p>
</td></tr>
<tr><td><code id="pk_oral_1cmt_+3A_cl">cl</code></td>
<td>
<p>Clearance</p>
</td></tr>
<tr><td><code id="pk_oral_1cmt_+3A_ruv">ruv</code></td>
<td>
<p>Residual variability</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of predicted values, with or without added residual variability
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat1 &lt;- vpc:::pk_oral_1cmt(t = c(0:72), tau = 24, dose = 120, 
                     ka = 1, ke = 1, cl = 10)
dat2 &lt;- vpc:::pk_oral_1cmt(t = c(0:72), tau = 24, dose = 120, 
                     ka = 1, ke = 1, cl = 10, 
                     ruv = list(proportional = 0.1, additive = 0.1))
</code></pre>

<hr>
<h2 id='plot_vpc'>VPC plotting function</h2><span id='topic+plot_vpc'></span>

<h3>Description</h3>

<p>This function performs no parsing of data, it just plots the already calculated statistics generated using one of the 
'vpc' functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_vpc(
  db,
  show = NULL,
  vpc_theme = NULL,
  smooth = TRUE,
  log_x = FALSE,
  log_y = FALSE,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_vpc_+3A_db">db</code></td>
<td>
<p>object created using the 'vpc' function</p>
</td></tr>
<tr><td><code id="plot_vpc_+3A_show">show</code></td>
<td>
<p>what to show in VPC (obs_dv, obs_ci, pi, pi_as_area, pi_ci, obs_median, sim_median, sim_median_ci)</p>
</td></tr>
<tr><td><code id="plot_vpc_+3A_vpc_theme">vpc_theme</code></td>
<td>
<p>theme to be used in VPC. Expects list of class vpc_theme created with function vpc_theme()</p>
</td></tr>
<tr><td><code id="plot_vpc_+3A_smooth">smooth</code></td>
<td>
<p>&quot;smooth&quot; the VPC (connect bin midpoints) or show bins as rectangular boxes. Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_vpc_+3A_log_x">log_x</code></td>
<td>
<p>Boolean indicting whether x-axis should be shown as logarithmic. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_vpc_+3A_log_y">log_y</code></td>
<td>
<p>Boolean indicting whether y-axis should be shown as logarithmic. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_vpc_+3A_xlab">xlab</code></td>
<td>
<p>label for x axis</p>
</td></tr>
<tr><td><code id="plot_vpc_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="plot_vpc_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="plot_vpc_+3A_verbose">verbose</code></td>
<td>
<p>verbosity (T/F)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+sim_data">sim_data</a>, <a href="#topic+vpc_cens">vpc_cens</a>, <a href="#topic+vpc_tte">vpc_tte</a>, <a href="#topic+vpc_cat">vpc_cat</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See vpc.ronkeizer.com for more documentation and examples

library(vpc)
vpc_db &lt;- vpc(sim = simple_data$sim, obs = simple_data$obs, vpcdb = TRUE)
plot_vpc(vpc_db, title = "My new vpc", x = "Custom x label")
</code></pre>

<hr>
<h2 id='quantile_cens'>Calculate quantiles respecting the censored data</h2><span id='topic+quantile_cens'></span>

<h3>Description</h3>

<p>Calculate quantiles respecting the censored data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantile_cens(x, p = 0.5, limit = 1, cens = "left")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantile_cens_+3A_x">x</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="quantile_cens_+3A_p">p</code></td>
<td>
<p>quantile</p>
</td></tr>
<tr><td><code id="quantile_cens_+3A_limit">limit</code></td>
<td>
<p>censoring limit</p>
</td></tr>
<tr><td><code id="quantile_cens_+3A_cens">cens</code></td>
<td>
<p>censoring direction (left/right)</p>
</td></tr>
</table>

<hr>
<h2 id='read_table_nm'>NONMEM output table import function</h2><span id='topic+read_table_nm'></span>

<h3>Description</h3>

<p>Quickly import NONMEM output tables into R.
Function taken from 'modelviz' package by Benjamin Guiastrennec.
When both <code>skip</code> and <code>header</code> are <code>NULL</code>,
<code>read_nmtab</code> will automatically detect the optimal
settings to import the tables. When more than one files are
provided for a same NONMEM run, they will be combined into
a single <code>data.frame</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_table_nm(
  file = NULL,
  skip = NULL,
  header = NULL,
  rm_duplicates = FALSE,
  nonmem_tab = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_table_nm_+3A_file">file</code></td>
<td>
<p>full file name</p>
</td></tr>
<tr><td><code id="read_table_nm_+3A_skip">skip</code></td>
<td>
<p>number of lines to skip before reading data</p>
</td></tr>
<tr><td><code id="read_table_nm_+3A_header">header</code></td>
<td>
<p>logical value indicating whether the file contains the names
of the variables as its first line</p>
</td></tr>
<tr><td><code id="read_table_nm_+3A_rm_duplicates">rm_duplicates</code></td>
<td>
<p>logical value indicating whether duplicated columns should be removed</p>
</td></tr>
<tr><td><code id="read_table_nm_+3A_nonmem_tab">nonmem_tab</code></td>
<td>
<p>logical value indicating to the function whether the file is a
table or a nonmem additional output file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data &lt;- read_table_nm(file = '../models/pk/sdtab101')

## End(Not run)
</code></pre>

<hr>
<h2 id='replace_list_elements'>Replace list elements by name</h2><span id='topic+replace_list_elements'></span>

<h3>Description</h3>

<p>Replace list elements by name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_list_elements(list, replacement)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_list_elements_+3A_list">list</code></td>
<td>
<p>original list</p>
</td></tr>
<tr><td><code id="replace_list_elements_+3A_replacement">replacement</code></td>
<td>
<p>replacement list</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Finds and replaces list elements by name and throws an error if an 
element is not available in the original list. This is a local duplicate
of the PKPDmisc copy for the VPC package to reduce dependency on PKPDmisc
at this time.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
list &lt;- list(ipred = "ipred", dv = "dv", idv = "idv", "pred" = "pred")
replacement &lt;- list(dv = "conc", idv = "time")
list &lt;- replace_list_elements(list, replacement)

## End(Not run)
</code></pre>

<hr>
<h2 id='rtte_obs_nm'>Simulated RTTE data (1x)</h2><span id='topic+rtte_obs_nm'></span>

<h3>Description</h3>

<p>An example dataset with simulated repeated time-to-event data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtte_obs_nm
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 573 rows and 6 columns.
</p>

<hr>
<h2 id='rtte_sim_nm'>Simulated RTTE data (100x)</h2><span id='topic+rtte_sim_nm'></span>

<h3>Description</h3>

<p>An example dataset with simulated repeated time-to-event data (100 simulations)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtte_sim_nm
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 2000000 rows and 7 columns.
</p>

<hr>
<h2 id='show_default'>Defaults for show argument</h2><span id='topic+show_default'></span>

<h3>Description</h3>

<p>Defaults for show argument
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_default
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 11.
</p>

<hr>
<h2 id='show_default_tte'>Defaults for show argument for TTE VPC</h2><span id='topic+show_default_tte'></span>

<h3>Description</h3>

<p>Defaults for show argument for TTE VPC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_default_tte
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 11.
</p>

<hr>
<h2 id='sim_data'>Simulate data based on a model and parameter distributions</h2><span id='topic+sim_data'></span>

<h3>Description</h3>

<p>Simulate data based on a model and parameter distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_data(
  design = cbind(id = c(1, 1, 1), idv = c(0, 1, 2)),
  model = function(x) {     return(x$alpha + x$beta) },
  theta,
  omega_mat,
  par_names,
  par_values = NULL,
  draw_iiv = "mvrnorm",
  error = list(proportional = 0, additive = 0, exponential = 0),
  n = 100
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_data_+3A_design">design</code></td>
<td>
<p>a design dataset. See example</p>
</td></tr>
<tr><td><code id="sim_data_+3A_model">model</code></td>
<td>
<p>A function with the first argument the simulation design, i.e. a dataset with the columns ... The second argument to this function is a dataset with parameters for every individual. This can be supplied by the user, or generated by this sim_data if theta and omega_mat are supplied.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_theta">theta</code></td>
<td>
<p>vector of fixed effect parameters</p>
</td></tr>
<tr><td><code id="sim_data_+3A_omega_mat">omega_mat</code></td>
<td>
<p>vector of between subject random effects, specified as lower triangle</p>
</td></tr>
<tr><td><code id="sim_data_+3A_par_names">par_names</code></td>
<td>
<p>A character vector linking the parameters in the model to the variables in the dataset. See example.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_par_values">par_values</code></td>
<td>
<p>parameter values</p>
</td></tr>
<tr><td><code id="sim_data_+3A_draw_iiv">draw_iiv</code></td>
<td>
<p>draw between subject random effects?</p>
</td></tr>
<tr><td><code id="sim_data_+3A_error">error</code></td>
<td>
<p>see example</p>
</td></tr>
<tr><td><code id="sim_data_+3A_n">n</code></td>
<td>
<p>number of simulations to perform</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates the simulated dependent values for use in the VPC plotting function.
</p>


<h3>Value</h3>

<p>a vector of simulated dependent variables (for us in the VPC plotting function)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vpc">vpc</a></code>
</p>

<hr>
<h2 id='simple_data'>A small rich dataset</h2><span id='topic+simple_data'></span>

<h3>Description</h3>

<p>A small rich dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simple_data
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 2.
</p>


<h3>Details</h3>

<p>a list containing the obs and sim data for an example dataset to run a 
simple vpc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
vpc(simple_data$sim, simple_data$obs)

## End(Not run)
</code></pre>

<hr>
<h2 id='theme_empty'>Empty ggplot2 theme</h2><span id='topic+theme_empty'></span>

<h3>Description</h3>

<p>Empty ggplot2 theme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_empty()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>vpc(simple_data$sim, simple_data$obs) + theme_empty()

</code></pre>

<hr>
<h2 id='theme_plain'>A nicer default theme for ggplot2</h2><span id='topic+theme_plain'></span>

<h3>Description</h3>

<p>A nicer default theme for ggplot2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_plain()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>vpc(simple_data$sim, simple_data$obs) + theme_plain()

</code></pre>

<hr>
<h2 id='triangle_to_full'>Lower to full triangle</h2><span id='topic+triangle_to_full'></span>

<h3>Description</h3>

<p>Convert the lower triangle of a covariance matrix to a full matrix object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>triangle_to_full(vect)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triangle_to_full_+3A_vect">vect</code></td>
<td>
<p>the lower triangle of a covariance matrix</p>
</td></tr>
</table>

<hr>
<h2 id='vpc'>VPC function</h2><span id='topic+vpc'></span><span id='topic+vpc.default'></span><span id='topic+vpc_vpc'></span>

<h3>Description</h3>

<p>Creates a VPC plot from observed and simulation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpc(sim, ...)

## Default S3 method:
vpc(sim, ...)

vpc_vpc(
  sim = NULL,
  obs = NULL,
  psn_folder = NULL,
  bins = "jenks",
  n_bins = "auto",
  bin_mid = "mean",
  obs_cols = NULL,
  sim_cols = NULL,
  software = "auto",
  show = NULL,
  stratify = NULL,
  pred_corr = FALSE,
  pred_corr_lower_bnd = 0,
  pi = c(0.05, 0.95),
  ci = c(0.05, 0.95),
  uloq = NULL,
  lloq = NULL,
  log_y = FALSE,
  log_y_min = 0.001,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  smooth = TRUE,
  vpc_theme = NULL,
  facet = "wrap",
  scales = "fixed",
  labeller = NULL,
  vpcdb = FALSE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpc_+3A_sim">sim</code></td>
<td>
<p>this is usually a data.frame with observed data, containing the independent and dependent variable, a column indicating the individual, and possibly covariates. E.g. load in from NONMEM using <a href="#topic+read_table_nm">read_table_nm</a>.  However it can also be an object like a nlmixr or xpose object</p>
</td></tr>
<tr><td><code id="vpc_+3A_...">...</code></td>
<td>
<p>Other arguments sent to other methods (like xpose or nlmixr);  Note these arguments are not used in the default vpc and are ignored by the default method.</p>
</td></tr>
<tr><td><code id="vpc_+3A_obs">obs</code></td>
<td>
<p>a data.frame with observed data, containing the independent and dependent variable, a column indicating the individual, and possibly covariates. E.g. load in from NONMEM using <a href="#topic+read_table_nm">read_table_nm</a></p>
</td></tr>
<tr><td><code id="vpc_+3A_psn_folder">psn_folder</code></td>
<td>
<p>instead of specifying &quot;sim&quot; and &quot;obs&quot;, specify a PsN-generated VPC-folder</p>
</td></tr>
<tr><td><code id="vpc_+3A_bins">bins</code></td>
<td>
<p>either &quot;density&quot;, &quot;time&quot;, or &quot;data&quot;, &quot;none&quot;, or one of the approaches available in classInterval() such as &quot;jenks&quot; (default) or &quot;pretty&quot;, or a numeric vector specifying the bin separators.</p>
</td></tr>
<tr><td><code id="vpc_+3A_n_bins">n_bins</code></td>
<td>
<p>when using the &quot;auto&quot; binning method, what number of bins to aim for</p>
</td></tr>
<tr><td><code id="vpc_+3A_bin_mid">bin_mid</code></td>
<td>
<p>either &quot;mean&quot; for the mean of all timepoints (default) or &quot;middle&quot; to use the average of the bin boundaries.</p>
</td></tr>
<tr><td><code id="vpc_+3A_obs_cols">obs_cols</code></td>
<td>
<p>observation dataset column names (list elements: &quot;dv&quot;, &quot;idv&quot;, &quot;id&quot;, &quot;pred&quot;)</p>
</td></tr>
<tr><td><code id="vpc_+3A_sim_cols">sim_cols</code></td>
<td>
<p>simulation dataset column names (list elements: &quot;dv&quot;, &quot;idv&quot;, &quot;id&quot;, &quot;pred&quot;, &quot;sim&quot;)</p>
</td></tr>
<tr><td><code id="vpc_+3A_software">software</code></td>
<td>
<p>name of software platform using (e.g. nonmem, phoenix)</p>
</td></tr>
<tr><td><code id="vpc_+3A_show">show</code></td>
<td>
<p>what to show in VPC (obs_dv, obs_ci, pi, pi_as_area, pi_ci, obs_median, sim_median, sim_median_ci)</p>
</td></tr>
<tr><td><code id="vpc_+3A_stratify">stratify</code></td>
<td>
<p>character vector of stratification variables. Only 1 or 2 stratification variables can be supplied.</p>
</td></tr>
<tr><td><code id="vpc_+3A_pred_corr">pred_corr</code></td>
<td>
<p>perform prediction-correction?</p>
</td></tr>
<tr><td><code id="vpc_+3A_pred_corr_lower_bnd">pred_corr_lower_bnd</code></td>
<td>
<p>lower bound for the prediction-correction</p>
</td></tr>
<tr><td><code id="vpc_+3A_pi">pi</code></td>
<td>
<p>simulated prediction interval to plot. Default is c(0.05, 0.95),</p>
</td></tr>
<tr><td><code id="vpc_+3A_ci">ci</code></td>
<td>
<p>confidence interval to plot. Default is (0.05, 0.95)</p>
</td></tr>
<tr><td><code id="vpc_+3A_uloq">uloq</code></td>
<td>
<p>Number or NULL indicating upper limit of quantification. Default is NULL.</p>
</td></tr>
<tr><td><code id="vpc_+3A_lloq">lloq</code></td>
<td>
<p>Number or NULL indicating lower limit of quantification. Default is NULL.</p>
</td></tr>
<tr><td><code id="vpc_+3A_log_y">log_y</code></td>
<td>
<p>Boolean indicting whether y-axis should be shown as logarithmic. Default is FALSE.</p>
</td></tr>
<tr><td><code id="vpc_+3A_log_y_min">log_y_min</code></td>
<td>
<p>minimal value when using log_y argument. Default is 1e-3.</p>
</td></tr>
<tr><td><code id="vpc_+3A_xlab">xlab</code></td>
<td>
<p>label for x axis</p>
</td></tr>
<tr><td><code id="vpc_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="vpc_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="vpc_+3A_smooth">smooth</code></td>
<td>
<p>&quot;smooth&quot; the VPC (connect bin midpoints) or show bins as rectangular boxes. Default is TRUE.</p>
</td></tr>
<tr><td><code id="vpc_+3A_vpc_theme">vpc_theme</code></td>
<td>
<p>theme to be used in VPC. Expects list of class vpc_theme created with function vpc_theme()</p>
</td></tr>
<tr><td><code id="vpc_+3A_facet">facet</code></td>
<td>
<p>either &quot;wrap&quot;, &quot;columns&quot;, or &quot;rows&quot;</p>
</td></tr>
<tr><td><code id="vpc_+3A_scales">scales</code></td>
<td>
<p>either &quot;fixed&quot; (default), &quot;free_y&quot;, &quot;free_x&quot; or &quot;free&quot;</p>
</td></tr>
<tr><td><code id="vpc_+3A_labeller">labeller</code></td>
<td>
<p>ggplot2 labeller function to be passed to underlying ggplot object</p>
</td></tr>
<tr><td><code id="vpc_+3A_vpcdb">vpcdb</code></td>
<td>
<p>Boolean whether to return the underlying vpcdb rather than the plot</p>
</td></tr>
<tr><td><code id="vpc_+3A_verbose">verbose</code></td>
<td>
<p>show debugging information (TRUE or FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing calculated VPC information (when vpcdb=TRUE), or a ggplot2 object (default)
</p>


<h3>See Also</h3>

<p><a href="#topic+sim_data">sim_data</a>, <a href="#topic+vpc_cens">vpc_cens</a>, <a href="#topic+vpc_tte">vpc_tte</a>, <a href="#topic+vpc_cat">vpc_cat</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## See vpc.ronkeizer.com for more documentation and examples
library(vpc)

# Basic commands:
vpc(sim = simple_data$sim, obs = simple_data$obs)
vpc(sim = simple_data$sim, obs = simple_data$obs, lloq = 20)

</code></pre>

<hr>
<h2 id='vpc_cat'>VPC function for categorical</h2><span id='topic+vpc_cat'></span>

<h3>Description</h3>

<p>Creates a VPC plot from observed and simulation data for categorical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpc_cat(
  sim = NULL,
  obs = NULL,
  psn_folder = NULL,
  bins = "jenks",
  n_bins = "auto",
  bin_mid = "mean",
  obs_cols = NULL,
  sim_cols = NULL,
  software = "auto",
  show = NULL,
  ci = c(0.05, 0.95),
  uloq = NULL,
  lloq = NULL,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  smooth = TRUE,
  vpc_theme = NULL,
  facet = "wrap",
  labeller = NULL,
  plot = TRUE,
  vpcdb = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpc_cat_+3A_sim">sim</code></td>
<td>
<p>a data.frame with observed data, containing the independent and dependent variable, a column indicating the individual, and possibly covariates. E.g. load in from NONMEM using <a href="#topic+read_table_nm">read_table_nm</a></p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_obs">obs</code></td>
<td>
<p>a data.frame with observed data, containing the independent and dependent variable, a column indicating the individual, and possibly covariates. E.g. load in from NONMEM using <a href="#topic+read_table_nm">read_table_nm</a></p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_psn_folder">psn_folder</code></td>
<td>
<p>instead of specifying &quot;sim&quot; and &quot;obs&quot;, specify a PsN-generated VPC-folder</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_bins">bins</code></td>
<td>
<p>either &quot;density&quot;, &quot;time&quot;, or &quot;data&quot;, &quot;none&quot;, or one of the approaches available in classInterval() such as &quot;jenks&quot; (default) or &quot;pretty&quot;, or a numeric vector specifying the bin separators.</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_n_bins">n_bins</code></td>
<td>
<p>when using the &quot;auto&quot; binning method, what number of bins to aim for</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_bin_mid">bin_mid</code></td>
<td>
<p>either &quot;mean&quot; for the mean of all timepoints (default) or &quot;middle&quot; to use the average of the bin boundaries.</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_obs_cols">obs_cols</code></td>
<td>
<p>observation dataset column names (list elements: &quot;dv&quot;, &quot;idv&quot;, &quot;id&quot;, &quot;pred&quot;)</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_sim_cols">sim_cols</code></td>
<td>
<p>simulation dataset column names (list elements: &quot;dv&quot;, &quot;idv&quot;, &quot;id&quot;, &quot;pred&quot;)</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_software">software</code></td>
<td>
<p>name of software platform using (e.g. nonmem, phoenix)</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_show">show</code></td>
<td>
<p>what to show in VPC (obs_ci, pi, pi_as_area, pi_ci, obs_median, sim_median, sim_median_ci)</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_ci">ci</code></td>
<td>
<p>confidence interval to plot. Default is (0.05, 0.95)</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_uloq">uloq</code></td>
<td>
<p>Number or NULL indicating upper limit of quantification. Default is NULL.</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_lloq">lloq</code></td>
<td>
<p>Number or NULL indicating lower limit of quantification. Default is NULL.</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_smooth">smooth</code></td>
<td>
<p>&quot;smooth&quot; the VPC (connect bin midpoints) or show bins as rectangular boxes. Default is TRUE.</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_vpc_theme">vpc_theme</code></td>
<td>
<p>theme to be used in VPC. Expects list of class vpc_theme created with function vpc_theme()</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_facet">facet</code></td>
<td>
<p>either &quot;wrap&quot;, &quot;columns&quot;, or &quot;rows&quot;</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_labeller">labeller</code></td>
<td>
<p>ggplot2 labeller function to be passed to underlying ggplot object</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_plot">plot</code></td>
<td>
<p>Boolean indicting whether to plot the ggplot2 object after creation. Default is FALSE.</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_vpcdb">vpcdb</code></td>
<td>
<p>boolean whether to return the underlying vpcdb rather than the plot</p>
</td></tr>
<tr><td><code id="vpc_cat_+3A_verbose">verbose</code></td>
<td>
<p>show debugging information (TRUE or FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing calculated VPC information (when vpcdb=TRUE), or a ggplot2 object (default)
</p>


<h3>See Also</h3>

<p><a href="#topic+sim_data">sim_data</a>, <a href="#topic+vpc">vpc</a>, <a href="#topic+vpc_tte">vpc_tte</a>, <a href="#topic+vpc_cens">vpc_cens</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## See vpc.ronkeizer.com for more documentation and examples
library(vpc)

# simple function to simulate categorical data for single individual
sim_id &lt;- function(id = 1) {
  n &lt;- 10
  logit &lt;- function(x) exp(x) / (1+exp(x))
  data.frame(id = id, time = seq(1, n, length.out = n),
             dv = round(logit((1:n) - n/2 + rnorm(n, 0, 1.5))) )
}
## simple function to simulate categorical data for a trial
sim_trial &lt;- function(i = 1, n = 20) { # function to simulate categorical data for a trial
  data.frame(sim = i, do.call("rbind", lapply(1:n, sim_id)))
}

## simulate single trial for 20 individuals
obs &lt;- sim_trial(n = 20)

## simulate 200 trials of 20 individuals
sim &lt;- do.call("rbind", lapply(1:200, sim_trial, n = 20))

## Plot categorical VPC
vpc_cat(sim = sim, obs = obs)
</code></pre>

<hr>
<h2 id='vpc_cens'>VPC function for left- or right-censored data (e.g. BLOQ data)</h2><span id='topic+vpc_cens'></span>

<h3>Description</h3>

<p>Creates a VPC plot from observed and simulation data for censored data. Function can handle both left- (below lower limit of quantification) and right-censored (above upper limit of quantification) data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpc_cens(
  sim = NULL,
  obs = NULL,
  psn_folder = NULL,
  bins = "jenks",
  n_bins = 8,
  bin_mid = "mean",
  obs_cols = NULL,
  sim_cols = NULL,
  software = "auto",
  show = NULL,
  stratify = NULL,
  stratify_color = NULL,
  ci = c(0.05, 0.95),
  uloq = NULL,
  lloq = NULL,
  plot = FALSE,
  xlab = "Time",
  ylab = "Probability of &lt;LOQ",
  title = NULL,
  smooth = TRUE,
  vpc_theme = NULL,
  facet = "wrap",
  labeller = NULL,
  vpcdb = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpc_cens_+3A_sim">sim</code></td>
<td>
<p>a data.frame with observed data, containing the independent and dependent variable, a column indicating the individual, and possibly covariates. E.g. load in from NONMEM using <a href="#topic+read_table_nm">read_table_nm</a></p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_obs">obs</code></td>
<td>
<p>a data.frame with observed data, containing the independent and dependent variable, a column indicating the individual, and possibly covariates. E.g. load in from NONMEM using <a href="#topic+read_table_nm">read_table_nm</a></p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_psn_folder">psn_folder</code></td>
<td>
<p>instead of specifying &quot;sim&quot; and &quot;obs&quot;, specify a PsN-generated VPC-folder</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_bins">bins</code></td>
<td>
<p>either &quot;density&quot;, &quot;time&quot;, or &quot;data&quot;, or a numeric vector specifying the bin separators.</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_n_bins">n_bins</code></td>
<td>
<p>number of bins</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_bin_mid">bin_mid</code></td>
<td>
<p>either &quot;mean&quot; for the mean of all timepoints (default) or &quot;middle&quot; to use the average of the bin boundaries.</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_obs_cols">obs_cols</code></td>
<td>
<p>observation dataset column names (list elements: &quot;dv&quot;, &quot;idv&quot;, &quot;id&quot;, &quot;pred&quot;)</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_sim_cols">sim_cols</code></td>
<td>
<p>simulation dataset column names (list elements: &quot;dv&quot;, &quot;idv&quot;, &quot;id&quot;, &quot;pred&quot;)</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_software">software</code></td>
<td>
<p>name of software platform using (e.g. nonmem, phoenix)</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_show">show</code></td>
<td>
<p>what to show in VPC (obs_ci, pi, pi_as_area, pi_ci, obs_median, sim_median, sim_median_ci)</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_stratify">stratify</code></td>
<td>
<p>character vector of stratification variables. Only 1 or 2 stratification variables can be supplied.</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_stratify_color">stratify_color</code></td>
<td>
<p>variable to stratify and color lines for observed data. Only 1 stratification variables can be supplied.</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_ci">ci</code></td>
<td>
<p>confidence interval to plot. Default is (0.05, 0.95)</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_uloq">uloq</code></td>
<td>
<p>Number or NULL indicating upper limit of quantification. Default is NULL.</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_lloq">lloq</code></td>
<td>
<p>Number or NULL indicating lower limit of quantification. Default is NULL.</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_plot">plot</code></td>
<td>
<p>Boolean indicating whether to plot the ggplot2 object after creation. Default is FALSE.</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_xlab">xlab</code></td>
<td>
<p>ylab as numeric vector of size 2</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_ylab">ylab</code></td>
<td>
<p>ylab as numeric vector of size 2</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_smooth">smooth</code></td>
<td>
<p>&quot;smooth&quot; the VPC (connect bin midpoints) or show bins as rectangular boxes. Default is TRUE.</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_vpc_theme">vpc_theme</code></td>
<td>
<p>theme to be used in VPC. Expects list of class vpc_theme created with function vpc_theme()</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_facet">facet</code></td>
<td>
<p>either &quot;wrap&quot;, &quot;columns&quot;, or &quot;rows&quot;</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_labeller">labeller</code></td>
<td>
<p>ggplot2 labeller function to be passed to underlying ggplot object</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_vpcdb">vpcdb</code></td>
<td>
<p>boolean whether to return the underlying vpcdb rather than the plot</p>
</td></tr>
<tr><td><code id="vpc_cens_+3A_verbose">verbose</code></td>
<td>
<p>show debugging information (TRUE or FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing calculated VPC information, and a ggplot2 object
</p>


<h3>See Also</h3>

<p><a href="#topic+sim_data">sim_data</a>, <a href="#topic+vpc">vpc</a>, <a href="#topic+vpc_tte">vpc_tte</a>, <a href="#topic+vpc_cat">vpc_cat</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## See vpc.ronkeizer.com for more documentation and examples
library(vpc)

vpc_cens(sim = simple_data$sim, obs = simple_data$obs, lloq = 30)
vpc_cens(sim = simple_data$sim, obs = simple_data$obs, uloq = 120)

</code></pre>

<hr>
<h2 id='vpc_tte'>VPC function for time-to-event (survival) data</h2><span id='topic+vpc_tte'></span>

<h3>Description</h3>

<p>This function can be used for either single time-to-event (TTE) or repeated time-to-event (RTTE) data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpc_tte(
  sim = NULL,
  obs = NULL,
  psn_folder = NULL,
  rtte = FALSE,
  rtte_calc_diff = TRUE,
  rtte_conditional = TRUE,
  events = NULL,
  bins = FALSE,
  n_bins = 10,
  software = "auto",
  obs_cols = NULL,
  sim_cols = NULL,
  kmmc = NULL,
  reverse_prob = FALSE,
  stratify = NULL,
  stratify_color = NULL,
  ci = c(0.05, 0.95),
  plot = FALSE,
  xlab = "Time",
  ylab = "Survival (%)",
  show = NULL,
  as_percentage = TRUE,
  title = NULL,
  smooth = FALSE,
  vpc_theme = NULL,
  facet = "wrap",
  labeller = NULL,
  verbose = FALSE,
  vpcdb = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vpc_tte_+3A_sim">sim</code></td>
<td>
<p>a data.frame with observed data, containing the independent and dependent variable, a column indicating the individual, and possibly covariates. E.g. load in from NONMEM using <a href="#topic+read_table_nm">read_table_nm</a></p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_obs">obs</code></td>
<td>
<p>a data.frame with observed data, containing the independent and dependent variable, a column indicating the individual, and possibly covariates. E.g. load in from NONMEM using <a href="#topic+read_table_nm">read_table_nm</a></p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_psn_folder">psn_folder</code></td>
<td>
<p>instead of specifying &quot;sim&quot; and &quot;obs&quot;, specify a PsN-generated VPC-folder</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_rtte">rtte</code></td>
<td>
<p>repeated time-to-event data? Default is FALSE (treat as single-event TTE)</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_rtte_calc_diff">rtte_calc_diff</code></td>
<td>
<p>recalculate time (T/F)? When simulating in NONMEM, you will probably need to set this to TRUE to recalculate the TIME to relative times between events (unless you output the time difference between events and specify that as independent variable to the vpc_tte() function.</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_rtte_conditional">rtte_conditional</code></td>
<td>
<p>'TRUE' (default) or 'FALSE'. Compute the probability for each event newly ('TRUE'), or calculate the absolute probability ('FALSE', i.e. the &quot;probability of a 1st, 2nd, 3rd event etc&quot; rather than the &quot;probability of an event happening&quot;).</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_events">events</code></td>
<td>
<p>numeric vector describing which events to show a VPC for when repeated TTE data, e.g. c(1:4). Default is NULL, which shows all events.</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_bins">bins</code></td>
<td>
<p>either &quot;density&quot;, &quot;time&quot;, or &quot;data&quot;, or a numeric vector specifying the bin separators.</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_n_bins">n_bins</code></td>
<td>
<p>number of bins</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_software">software</code></td>
<td>
<p>name of software platform using (e.g. nonmem, phoenix)</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_obs_cols">obs_cols</code></td>
<td>
<p>observation dataset column names (list elements: &quot;dv&quot;, &quot;idv&quot;, &quot;id&quot;, &quot;pred&quot;)</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_sim_cols">sim_cols</code></td>
<td>
<p>simulation dataset column names (list elements: &quot;dv&quot;, &quot;idv&quot;, &quot;id&quot;, &quot;pred&quot;, &quot;sim&quot;)</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_kmmc">kmmc</code></td>
<td>
<p>either NULL (for regular TTE vpc, default), or a variable name for a KMMC plot (e.g. &quot;WT&quot;)</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_reverse_prob">reverse_prob</code></td>
<td>
<p>reverse the probability scale (i.e. plot 1-probability)</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_stratify">stratify</code></td>
<td>
<p>character vector of stratification variables. Only 1 or 2 stratification variables can be supplied.</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_stratify_color">stratify_color</code></td>
<td>
<p>character vector of stratification variables. Only 1 stratification variable can be supplied, cannot be used in conjunction with 'stratify'.</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_ci">ci</code></td>
<td>
<p>confidence interval to plot. Default is (0.05, 0.95)</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_plot">plot</code></td>
<td>
<p>Boolean indicating whether to plot the ggplot2 object after creation. Default is FALSE.</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_xlab">xlab</code></td>
<td>
<p>label for x-axis</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_ylab">ylab</code></td>
<td>
<p>label for y-axis</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_show">show</code></td>
<td>
<p>what to show in VPC (obs_ci, obs_median, sim_median, sim_median_ci)</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_as_percentage">as_percentage</code></td>
<td>
<p>Show y-scale from 0-100 percent? TRUE by default, if FALSE then scale from 0-1.</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_smooth">smooth</code></td>
<td>
<p>&quot;smooth&quot; the VPC (connect bin midpoints) or show bins as rectangular boxes. Default is TRUE.</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_vpc_theme">vpc_theme</code></td>
<td>
<p>theme to be used in VPC. Expects list of class vpc_theme created with function vpc_theme()</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_facet">facet</code></td>
<td>
<p>either &quot;wrap&quot;, &quot;columns&quot;, or &quot;rows&quot;</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_labeller">labeller</code></td>
<td>
<p>ggplot2 labeller function to be passed to underlying ggplot object</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE (default)</p>
</td></tr>
<tr><td><code id="vpc_tte_+3A_vpcdb">vpcdb</code></td>
<td>
<p>Boolean whether to return the underlying vpcdb rather than the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a VPC plot from observed and simulation survival data
</p>


<h3>Value</h3>

<p>a list containing calculated VPC information, and a ggplot2 object
</p>


<h3>See Also</h3>

<p><a href="#topic+sim_data">sim_data</a>, <a href="#topic+vpc">vpc</a>, <a href="#topic+vpc_tte">vpc_tte</a>, <a href="#topic+vpc_cens">vpc_cens</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See vpc-docs.ronkeizer.com for more documentation and examples.

## Example for repeated) time-to-event data
## with NONMEM-like data (e.g. simulated using a dense grid)

data(rtte_obs_nm)
data(rtte_sim_nm)

# treat RTTE as TTE, no stratification
vpc_tte(sim = rtte_sim_nm[rtte_sim_nm$sim &lt;= 20,],
       obs = rtte_obs_nm,
       rtte = FALSE,
       sim_cols=list(dv = "dv", idv = "t"), obs_cols=list(idv = "t"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
