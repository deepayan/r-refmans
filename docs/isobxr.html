<!DOCTYPE html><html lang="en"><head><title>Help for package isobxr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {isobxr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#isobxr-package'><p>isobxr: Stable Isotope Box Modelling in R</p></a></li>
<li><a href='#ANA_delta_t_Calculator'><p>Calculate delta values at t time with ODE solutions from ana_slvr</p></a></li>
<li><a href='#calculation_gauge'><p>Gauge of calculation</p></a></li>
<li><a href='#check_FORCINGS'><p>check_FORCINGS</p></a></li>
<li><a href='#clear_subset'><p>Clear a subset</p></a></li>
<li><a href='#corr_stats'><p>corr_stats</p></a></li>
<li><a href='#dec_0'><p>Print a number with 0 decimal figures</p></a></li>
<li><a href='#dec_1'><p>Print a number with 1 decimal figures</p></a></li>
<li><a href='#dec_2'><p>Print a number with 2 decimal figures</p></a></li>
<li><a href='#dec_3'><p>Print a number with 3 decimal figures</p></a></li>
<li><a href='#dec_4'><p>Print a number with 4 decimal figures</p></a></li>
<li><a href='#dec_n'><p>Print a number with n decimal figures</p></a></li>
<li><a href='#del_NaN_rows'><p>Delete rows of a dataframe containing NaN values in a given column</p></a></li>
<li><a href='#DF_verticalizer'><p>Verticalizes a dataframe</p></a></li>
<li><a href='#fit.final_space'><p>Fit n parameters to observations</p></a></li>
<li><a href='#merge_FINnD_chunks'><p>Merge results from all chunks of a given sweep.final_nD run</p></a></li>
<li><a href='#multiplot'><p>Collate multiple ggplot object into a grid format</p></a></li>
<li><a href='#plot_correlogram_all_CIfit'><p>plot_correlogram_all_CIfit</p></a></li>
<li><a href='#plot_diagram'><p>plot_diagram</p></a></li>
<li><a href='#plot_dyn_2D'><p>plot sweep.dyn_2D outputs</p></a></li>
<li><a href='#plot_freq_ADSR'><p>plot_freq_ADSR</p></a></li>
<li><a href='#plot_freq_coeff'><p>plot_freq_coeff</p></a></li>
<li><a href='#plot_freq_flux'><p>plot_freq_flux</p></a></li>
<li><a href='#plot_lda'><p>plot_lda</p></a></li>
<li><a href='#plot_LS_surfaces_ADSR'><p>plot_LS_surfaces_ADSR</p></a></li>
<li><a href='#plot_LS_surfaces_lists'><p>plot_LS_surfaces_lists</p></a></li>
<li><a href='#plot_relaxation'><p>plot relaxation</p></a></li>
<li><a href='#plot_scenario'><p>plot sim.scenario outputs</p></a></li>
<li><a href='#plot_sim_distrib'><p>plot_sim_distrib</p></a></li>
<li><a href='#plot_sim_obs'><p>plot_sim_obs</p></a></li>
<li><a href='#plot_single_run'><p>plot sim.single_run outputs</p></a></li>
<li><a href='#quiet'><p>Preventing any console prints (for sweepers only)</p></a></li>
<li><a href='#read.dyn_2D_master'><p>Read and inspect sweep.dyn_2D master files</p></a></li>
<li><a href='#read.final_nD_master'><p>Read and inspect sweep.final_nD master files</p></a></li>
<li><a href='#read.isobxr_master'><p>Read and inspect isobxr master files</p></a></li>
<li><a href='#read.scenario_master'><p>Read and inspect scenario master files</p></a></li>
<li><a href='#significance_pval_df'><p>edits a full dataframe of significance symbols from a dataframe of p-values</p></a></li>
<li><a href='#sim.scenario'><p>Simulate a scenario</p></a></li>
<li><a href='#sim.single_run'><p>Run a single isotope box-model simulation</p></a></li>
<li><a href='#solve_analytically'><p>Analytically solve stable isotope box models</p></a></li>
<li><a href='#solve_numerically'><p>Numerically solve stable isotope box models</p></a></li>
<li><a href='#sweep.dyn_2D'><p>Sweep the space of two parameters during the response to a perturbation</p></a></li>
<li><a href='#sweep.final_nD'><p>Sweep the space of n parameters at the final state of a system</p></a></li>
<li><a href='#tempdir_tree'><p>tempdir_tree</p></a></li>
<li><a href='#time_converter'><p>Convert time units in a dataframe column</p></a></li>
<li><a href='#to_tmpdir'><p>address_to_tmpdir</p></a></li>
<li><a href='#using_extdata_tutorial'><p>using_extdata_tutorial V1</p></a></li>
<li><a href='#using_extdata_tutorial_2'><p>using_extdata_tutorial_2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stable Isotope Box Modelling in R</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of functions to run simple and composite box-models to describe the 
    dynamic or static distribution of stable isotopes in open 
    or closed systems. The package also allows the sweeping of many 
    parameters in both static and dynamic conditions.
    The mathematical models used in this package are derived from Albarede, 1995, 
    Introduction to Geochemical Modelling, Cambridge University Press,
    Cambridge &lt;<a href="https://doi.org/10.1017%2FCBO9780511622960">doi:10.1017/CBO9780511622960</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ttacail/isobxr">https://github.com/ttacail/isobxr</a>,
<a href="https://ttacail.github.io/isobxr_web/">https://ttacail.github.io/isobxr_web/</a>,
<a href="https://ttacail.github.io/isobxr/">https://ttacail.github.io/isobxr/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ttacail/isobxr/issues">https://github.com/ttacail/isobxr/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>stringr, readxl, dplyr, data.table, deSolve, rlang (&ge;
0.4.11), grid, ggplot2, ggrepel, qgraph, writexl, R.utils, fs,
magrittr, tidyr, gridExtra, purrr, reshape2, tictoc</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, devtools, MASS, roxygen2, tidyselect,
grDevices</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-23 10:21:54 UTC; sz18642</td>
</tr>
<tr>
<td>Author:</td>
<td>Theo Tacail [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Theo Tacail &lt;theo.tacail@protonmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-23 14:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='isobxr-package'>isobxr: Stable Isotope Box Modelling in R</h2><span id='topic+isobxr'></span><span id='topic+isobxr-package'></span>

<h3>Description</h3>

<p>A set of functions to run simple and composite box-models to describe the dynamic or static distribution of stable isotopes in open or closed systems. The package also allows the sweeping of many parameters in both static and dynamic conditions. The mathematical models used in this package are derived from Albarede, 1995, Introduction to Geochemical Modelling, Cambridge University Press, Cambridge <a href="https://doi.org/10.1017/CBO9780511622960">doi:10.1017/CBO9780511622960</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Theo Tacail <a href="mailto:theo.tacail@protonmail.com">theo.tacail@protonmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ttacail/isobxr">https://github.com/ttacail/isobxr</a>
</p>
</li>
<li> <p><a href="https://ttacail.github.io/isobxr_web/">https://ttacail.github.io/isobxr_web/</a>
</p>
</li>
<li> <p><a href="https://ttacail.github.io/isobxr/">https://ttacail.github.io/isobxr/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ttacail/isobxr/issues">https://github.com/ttacail/isobxr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='ANA_delta_t_Calculator'>Calculate delta values at t time with ODE solutions from ana_slvr</h2><span id='topic+ANA_delta_t_Calculator'></span>

<h3>Description</h3>

<p>Calculate the delta values at t time using the ODE analytical solutions of the isotopic box model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ANA_delta_t_Calculator(
  t,
  ODE_Constants,
  ODE_Eigenvalues,
  ODE_Eigenvectors,
  BOXES_IDs,
  ratio_standard
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ANA_delta_t_Calculator_+3A_t">t</code></td>
<td>
<p>Time at which the delta values are to be calculated (numeric)</p>
</td></tr>
<tr><td><code id="ANA_delta_t_Calculator_+3A_ode_constants">ODE_Constants</code></td>
<td>
<p>Constants as determined by the analytical solver for the system of <br />
ordinary differential equations (single column dataframe).</p>
</td></tr>
<tr><td><code id="ANA_delta_t_Calculator_+3A_ode_eigenvalues">ODE_Eigenvalues</code></td>
<td>
<p>Eigenvalues as determined by the analytical solver for the system of <br />
ordinary differential equations (single column dataframe).</p>
</td></tr>
<tr><td><code id="ANA_delta_t_Calculator_+3A_ode_eigenvectors">ODE_Eigenvectors</code></td>
<td>
<p>Eigenvectors as determined by the analytical solver for the system of <br />
ordinary differential equations (multiple columns dataframe).</p>
</td></tr>
<tr><td><code id="ANA_delta_t_Calculator_+3A_boxes_ids">BOXES_IDs</code></td>
<td>
<p>Vector of character strings with the names of the boxes <br />
in the same order as used in ana_slvr.</p>
</td></tr>
<tr><td><code id="ANA_delta_t_Calculator_+3A_ratio_standard">ratio_standard</code></td>
<td>
<p>Isotope ratio of the reference material used to calculate the delta values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataframe of the delta values in all boxes at t time.
</p>

<hr>
<h2 id='calculation_gauge'>Gauge of calculation</h2><span id='topic+calculation_gauge'></span>

<h3>Description</h3>

<p>Prints a gauge of the calculation progress
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculation_gauge(i, len)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculation_gauge_+3A_i">i</code></td>
<td>
<p>Calculating step number</p>
</td></tr>
<tr><td><code id="calculation_gauge_+3A_len">len</code></td>
<td>
<p>Total calculation steps</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print summarizing the progress of calculation
</p>

<hr>
<h2 id='check_FORCINGS'>check_FORCINGS</h2><span id='topic+check_FORCINGS'></span>

<h3>Description</h3>

<p>A function to check the formatting data frames used as forcing inputs <br />
in several functions (e.g., sim.single_run)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_FORCINGS(type, FORCING, isobxr_master)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_FORCINGS_+3A_type">type</code></td>
<td>
<p>Type of forcing. As character. <br />
One value among: &quot;RAYLEIGH&quot;, &quot;ALPHA&quot;, &quot;SIZE&quot;, &quot;DELTA&quot;</p>
</td></tr>
<tr><td><code id="check_FORCINGS_+3A_forcing">FORCING</code></td>
<td>
<p>Forcing data frame.</p>
</td></tr>
<tr><td><code id="check_FORCINGS_+3A_isobxr_master">isobxr_master</code></td>
<td>
<p>Isobxr master as a list as returned from read_isobxr_master</p>
</td></tr>
</table>


<h3>Value</h3>

<p>aborts run if a mistake is found
</p>

<hr>
<h2 id='clear_subset'>Clear a subset</h2><span id='topic+clear_subset'></span>

<h3>Description</h3>

<p>Takes a previously subsetted dataframe, clears its deleted levels and resets its row indexes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clear_subset(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clear_subset_+3A_dataset">dataset</code></td>
<td>
<p>Previously subsetted dataframe.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cleared dataframe.
</p>

<hr>
<h2 id='corr_stats'>corr_stats</h2><span id='topic+corr_stats'></span>

<h3>Description</h3>

<p>edits dataframe report of linear regression and correlation tests (Pearson and Spearman)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corr_stats(data_lm, X, Y, as_character = F, n = 3, m = 4)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corr_stats_+3A_data_lm">data_lm</code></td>
<td>
<p>a data frame with X and Y data</p>
</td></tr>
<tr><td><code id="corr_stats_+3A_x">X</code></td>
<td>
<p>name of X variable column (character)</p>
</td></tr>
<tr><td><code id="corr_stats_+3A_y">Y</code></td>
<td>
<p>name of Y variable column (character)</p>
</td></tr>
<tr><td><code id="corr_stats_+3A_as_character">as_character</code></td>
<td>
<p>reports statistics formatted as characters. Default is FALSE.</p>
</td></tr>
<tr><td><code id="corr_stats_+3A_n">n</code></td>
<td>
<p>number of digits to display in correlation coefficient/rho. Default is 3. Only used if as_character = T.</p>
</td></tr>
<tr><td><code id="corr_stats_+3A_m">m</code></td>
<td>
<p>number of digits to display in regression equation parameters (slope, y-intercept). Default is 4. Only used if as_character = T.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>report of regression and correlation tests
</p>

<hr>
<h2 id='dec_0'>Print a number with 0 decimal figures</h2><span id='topic+dec_0'></span>

<h3>Description</h3>

<p>Takes a numerical value and returns a string of the rounded value, with 0 decimal figures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dec_0(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dec_0_+3A_x">x</code></td>
<td>
<p>Numerical value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string with 0 decimal figures.
</p>

<hr>
<h2 id='dec_1'>Print a number with 1 decimal figures</h2><span id='topic+dec_1'></span>

<h3>Description</h3>

<p>Takes a numerical value and returns a print with 1 decimal figures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dec_1(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dec_1_+3A_x">x</code></td>
<td>
<p>Numerical value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string with 1 decimal figure.
</p>

<hr>
<h2 id='dec_2'>Print a number with 2 decimal figures</h2><span id='topic+dec_2'></span>

<h3>Description</h3>

<p>Takes a numerical value and returns a print with 2 decimal figures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dec_2(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dec_2_+3A_x">x</code></td>
<td>
<p>Numerical value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string with 2 decimal figures.
</p>

<hr>
<h2 id='dec_3'>Print a number with 3 decimal figures</h2><span id='topic+dec_3'></span>

<h3>Description</h3>

<p>Takes a numerical value and returns a print with 3 decimal figures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dec_3(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dec_3_+3A_x">x</code></td>
<td>
<p>Numerical value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string with 3 decimal figures.
</p>

<hr>
<h2 id='dec_4'>Print a number with 4 decimal figures</h2><span id='topic+dec_4'></span>

<h3>Description</h3>

<p>Takes a numerical value and returns a print with 4 decimal figures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dec_4(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dec_4_+3A_x">x</code></td>
<td>
<p>Numerical value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string with 4 decimal figures.
</p>

<hr>
<h2 id='dec_n'>Print a number with n decimal figures</h2><span id='topic+dec_n'></span>

<h3>Description</h3>

<p>Takes a numerical value and returns a print with n decimal figures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dec_n(x, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dec_n_+3A_x">x</code></td>
<td>
<p>Numerical value</p>
</td></tr>
<tr><td><code id="dec_n_+3A_n">n</code></td>
<td>
<p>number of decimals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string with 4 decimal figures.
</p>

<hr>
<h2 id='del_NaN_rows'>Delete rows of a dataframe containing NaN values in a given column</h2><span id='topic+del_NaN_rows'></span>

<h3>Description</h3>

<p>Delete rows of a dataframe containing NaN values in a given column
</p>


<h3>Usage</h3>

<pre><code class='language-R'>del_NaN_rows(dataframe, by_col, resetrows)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="del_NaN_rows_+3A_dataframe">dataframe</code></td>
<td>
<p>dataframe</p>
</td></tr>
<tr><td><code id="del_NaN_rows_+3A_by_col">by_col</code></td>
<td>
<p>Name of column from which NaN values should be removed. Character string.</p>
</td></tr>
<tr><td><code id="del_NaN_rows_+3A_resetrows">resetrows</code></td>
<td>
<p>Logical value to reset the row numbering or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Subset of dataframe without the rows containing NaN values in column by_col
</p>

<hr>
<h2 id='DF_verticalizer'>Verticalizes a dataframe</h2><span id='topic+DF_verticalizer'></span>

<h3>Description</h3>

<p>Takes a dataframe with a set of different columns containing numerical values to be verticalized,
returns a vertical dataframe with all variables in a single column called &quot;VAR&quot; together with a &quot;VAR_TYPE&quot; column
defining the type of variable for the given row, named after the column name found in horizontal dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DF_verticalizer(df_hor, vert_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DF_verticalizer_+3A_df_hor">df_hor</code></td>
<td>
<p>Horizontal dataframe</p>
</td></tr>
<tr><td><code id="DF_verticalizer_+3A_vert_col">vert_col</code></td>
<td>
<p>Vector of the names of the columns of numerical variables to be verticalized.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vertical dataframe containing the variables to be verticalized (column &quot;VAR&quot;, numeric)
and the name of the variable (column &quot;VAR_TYPE&quot;, character strings).
</p>

<hr>
<h2 id='fit.final_space'>Fit n parameters to observations</h2><span id='topic+fit.final_space'></span>

<h3>Description</h3>

<p>A function to find the combinations of values of n parameters
producing final state delta values fitting within confidence intervals of observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.final_space(
  workdir,
  obs_file_name,
  sweep_space_digest_folders,
  fit_name = NULL,
  output_dir = NULL,
  delta_reference_box = NaN,
  excluded_boxes = NULL,
  print_correlogram = FALSE,
  print_lda = FALSE,
  print_LS_surfaces = FALSE,
  parameter_subsets = NULL,
  custom_expressions = NULL,
  save_outputs = FALSE,
  export_fit_data = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.final_space_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>0_ISOBXR_MASTER.xlsx</em></strong> master file, <br />
of the dynamic sweep master file (e.g., <strong><em>0_EXPLO_DYN_MASTER.xlsx</em></strong>) <br />
and where output files will be stored if saved by user. <br />
(character string)</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_obs_file_name">obs_file_name</code></td>
<td>
<p>Name of csv file containing observations with csv extension. <br />
Stored in workdir. Example: &quot;observations.csv&quot; <br />
Should contain the following columns: <br />
</p>

<ol>
<li> <p><strong>BOX_ID</strong>: BOX ID (e.g., A, OCEAN...) as defined in isobxr master file.
</p>
</li>
<li> <p><strong>delta.def</strong> definition of delta value, e.g., d18O
</p>
</li>
<li> <p><strong>delta.ref</strong> BOX_ID of reservoir used as a reference.
</p>
</li>
<li> <p><strong>obs.delta</strong> average observed delta numerical value
</p>
</li>
<li> <p><strong>obs.CI</strong> confidence interval of delta value
</p>
</li>
<li> <p><strong>obs.CI.def</strong> definition of confidence interval, e.g., 95
</p>
</li>
<li> <p><strong>obs.file</strong> name of data source file
</p>
</li></ol>
</td></tr>
<tr><td><code id="fit.final_space_+3A_sweep_space_digest_folders">sweep_space_digest_folders</code></td>
<td>
<p>Name of sweep.final_nD digest directory. <br />
Should start with &quot;4_FINnD&quot; and end with &quot;_digest&quot;</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_fit_name">fit_name</code></td>
<td>
<p>Name given to specific fit. If NULL,
output are named after date and time of fit.</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_output_dir">output_dir</code></td>
<td>
<p>Destination directory for fit outputs. If NULL, outputs are stored in
sweep_space_digest_folders directory. Default is NULL.</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_delta_reference_box">delta_reference_box</code></td>
<td>
<p>BOX ID of reference box, used to calculate difference
between any box delta and reference box delta. Default is NaN. <br />
delta_reference_box should match at least one of the values declared
in the delta.ref column of observation csv file.</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_excluded_boxes">excluded_boxes</code></td>
<td>
<p>list of boxes to exclude from fit. Default is NULL.</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_print_correlogram">print_correlogram</code></td>
<td>
<p>If TRUE, includes correlograms to final report when applicable. <br />
Default is FALSE. <br /></p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_print_lda">print_lda</code></td>
<td>
<p>If TRUE, includes linear discriminant analysis to final report
when applicable. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_print_ls_surfaces">print_LS_surfaces</code></td>
<td>
<p>If TRUE, includes surfaces of least squarred residuals
to final report when applicable. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_parameter_subsets">parameter_subsets</code></td>
<td>
<p>List of limits vectors for parameters to subset before fit. <br />
For instance: list(swp.A.A_B = c(1, 1.00001))
to subset the swept fractionation factor from box A to B between 1 and 1.00001.</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_custom_expressions">custom_expressions</code></td>
<td>
<p>Vector of expressions to add to the list of fitted parameters. <br />
For instance: c(&quot;m0.A/f.A_B&quot;) to add the ratios of mass of A over A to B flux
to the list of parameters.</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_save_outputs">save_outputs</code></td>
<td>
<p>If TRUE, saves all run outputs to local working directory (workdir). <br />
By default, run outputs are stored in a temporary directory and erased if not saved.
Default is FALSE.</p>
</td></tr>
<tr><td><code id="fit.final_space_+3A_export_fit_data">export_fit_data</code></td>
<td>
<p>If TRUE, exports fitted data as csv and rds files.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A observation fit graphical report, in R session or exported as pdf, and a data report as R list or xlsx if required.
</p>

<hr>
<h2 id='merge_FINnD_chunks'>Merge results from all chunks of a given sweep.final_nD run</h2><span id='topic+merge_FINnD_chunks'></span>

<h3>Description</h3>

<p>Merge results from all chunks of a given sweep.final_nD run
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_FINnD_chunks(workdir, FINnD_digest_dir.to_merge, save_outputs = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="merge_FINnD_chunks_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>0_ISOBXR_MASTER.xlsx</em></strong> master file, <br />
of the dynamic sweep master file (e.g., <strong><em>0_EXPLO_DYN_MASTER.xlsx</em></strong>) <br />
and where output files will be stored if saved by user. <br />
(character string)</p>
</td></tr>
<tr><td><code id="merge_FINnD_chunks_+3A_finnd_digest_dir.to_merge">FINnD_digest_dir.to_merge</code></td>
<td>
<p>Name of sweep.final_nD digest directory
to which current chunks should be merged. <br />
For instance: &quot;4_FINnD_0_SWEEP_FINnD_demo_001_000_digest&quot;</p>
</td></tr>
<tr><td><code id="merge_FINnD_chunks_+3A_save_outputs">save_outputs</code></td>
<td>
<p>If TRUE, saves merged chunks outputs to sweep.final_nD digest directory.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Merged chunks sweep.final_nD outputs, including results, chunk logs, chunked parameter spaces.
</p>

<hr>
<h2 id='multiplot'>Collate multiple ggplot object into a grid format</h2><span id='topic+multiplot'></span>

<h3>Description</h3>

<p>Takes a list of ggplot objects and returns a single object with a grid of the ggplot objects.
<br /> ggplot objects can be passed in ..., or to plotlist (as a list of ggplot objects)
- cols:   Number of columns in layout
- layout: A matrix specifying the layout. If present, 'cols' is ignored.
<br /> If the layout is something like matrix(c(1,2,3,3), nrow=2, byrow=TRUE),
multiplot(a, b, c, layout = matrix(c(1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,3), nrow=1, byrow=TRUE))
then plot 1 will go in the upper left, 2 will go in the upper right, and
3 will go all the way across the bottom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiplot(..., plotlist = NULL, file, cols = 1, layout = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiplot_+3A_...">...</code></td>
<td>
<p>initiation of plot list (ggplot objects)</p>
</td></tr>
<tr><td><code id="multiplot_+3A_plotlist">plotlist</code></td>
<td>
<p>the list of plots</p>
</td></tr>
<tr><td><code id="multiplot_+3A_file">file</code></td>
<td>
<p>file</p>
</td></tr>
<tr><td><code id="multiplot_+3A_cols">cols</code></td>
<td>
<p>number of columns for the facetting</p>
</td></tr>
<tr><td><code id="multiplot_+3A_layout">layout</code></td>
<td>
<p>user defined matrix layout (numeric matrix). default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot composed of multiple subplots.
</p>

<hr>
<h2 id='plot_correlogram_all_CIfit'>plot_correlogram_all_CIfit</h2><span id='topic+plot_correlogram_all_CIfit'></span>

<h3>Description</h3>

<p>Plot correlogram of CI fitted ADSR parameter values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_correlogram_all_CIfit(DF, names.swp.ADSR)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_correlogram_all_CIfit_+3A_df">DF</code></td>
<td>
<p>fit.final_space data frame</p>
</td></tr>
<tr><td><code id="plot_correlogram_all_CIfit_+3A_names.swp.adsr">names.swp.ADSR</code></td>
<td>
<p>names of swept ADSR parameters (alpha, delta, size, rayleigh, custom expressions), as vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A correlogram of CI fitted ADSR parameter values
</p>

<hr>
<h2 id='plot_diagram'>plot_diagram</h2><span id='topic+plot_diagram'></span>

<h3>Description</h3>

<p>plot diagrams for fluxes and coefficients using the qgraph network function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_diagram(input, title, matrix_layout, BOXES_master_loc, COEFF_FLUX)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_diagram_+3A_input">input</code></td>
<td>
<p>matrix of fluxes or coefficients</p>
</td></tr>
<tr><td><code id="plot_diagram_+3A_title">title</code></td>
<td>
<p>title of diagram</p>
</td></tr>
<tr><td><code id="plot_diagram_+3A_matrix_layout">matrix_layout</code></td>
<td>
<p>matrix of X,Y layout</p>
</td></tr>
<tr><td><code id="plot_diagram_+3A_boxes_master_loc">BOXES_master_loc</code></td>
<td>
<p>BOXES_master_loc</p>
</td></tr>
<tr><td><code id="plot_diagram_+3A_coeff_flux">COEFF_FLUX</code></td>
<td>
<p>&quot;COEFF&quot; or &quot;FLUX&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>diagrams for console or pdf edition (not used in shinobxr)
</p>

<hr>
<h2 id='plot_dyn_2D'>plot sweep.dyn_2D outputs</h2><span id='topic+plot_dyn_2D'></span>

<h3>Description</h3>

<p>A function to plot delta vs time from the sweep.dyn_2D runs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_dyn_2D(
  workdir,
  sweep_dir_name,
  time_unit = NULL,
  time_range = NULL,
  hidden_boxes = NULL,
  return_as_print = TRUE,
  free_y_scale = TRUE,
  swap_sweep_params = FALSE,
  show.delta_drift = FALSE,
  time_as_log10 = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_dyn_2D_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.
(character string)</p>
</td></tr>
<tr><td><code id="plot_dyn_2D_+3A_sweep_dir_name">sweep_dir_name</code></td>
<td>
<p>Full name of sweep.dyn_2D SERIES directory (character string)</p>
</td></tr>
<tr><td><code id="plot_dyn_2D_+3A_time_unit">time_unit</code></td>
<td>
<p>Time unit to use on plot if different from native time unit. <br />
Character string, to be selected among the following: <br />
<em>micros, ms, s, min, h, d, wk, mo, yr, kyr, Myr, Gyr</em> <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_dyn_2D_+3A_time_range">time_range</code></td>
<td>
<p>Time range to zoom on as vector of two values, such as: c(0,100) <br />
Values in displayed time units. <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_dyn_2D_+3A_hidden_boxes">hidden_boxes</code></td>
<td>
<p>List of boxes to hide from plots, as a vector of character strings. <br />
For instance c(&quot;SOURCE&quot;, &quot;SINK&quot;). <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_dyn_2D_+3A_return_as_print">return_as_print</code></td>
<td>
<p>If TRUE, prints delta and size vs. time plots in a single page figure on R. <br />
If FALSE, returns separately delta and size vs. time plots as list of editable R objects. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_dyn_2D_+3A_free_y_scale">free_y_scale</code></td>
<td>
<p>If TRUE, frees Y axis scale. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_dyn_2D_+3A_swap_sweep_params">swap_sweep_params</code></td>
<td>
<p>If TRUE, swaps the sweep parameter 1 and 2 representations
from color to facet scales. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_dyn_2D_+3A_show.delta_drift">show.delta_drift</code></td>
<td>
<p>If TRUE, displays drift of delta values from t0.</p>
</td></tr>
<tr><td><code id="plot_dyn_2D_+3A_time_as_log10">time_as_log10</code></td>
<td>
<p>If TRUE, uses logarithmic time scale in plot. <br />
Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A set of plots showing the evolution of delta and sizes with time.
</p>

<hr>
<h2 id='plot_freq_ADSR'>plot_freq_ADSR</h2><span id='topic+plot_freq_ADSR'></span>

<h3>Description</h3>

<p>Plot frequency profiles by fitted parameter of ADSR types
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_freq_ADSR(DF, names.swp.ADSR, parameter_subsets)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_freq_ADSR_+3A_df">DF</code></td>
<td>
<p>fit.final_space data frame</p>
</td></tr>
<tr><td><code id="plot_freq_ADSR_+3A_names.swp.adsr">names.swp.ADSR</code></td>
<td>
<p>names of swept ADSR parameters (alpha, delta, size, rayleigh, custom expressions), as vector</p>
</td></tr>
<tr><td><code id="plot_freq_ADSR_+3A_parameter_subsets">parameter_subsets</code></td>
<td>
<p>parameter subsets passed from fit.final_space</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A frequency plot of fitted parameter values.
</p>

<hr>
<h2 id='plot_freq_coeff'>plot_freq_coeff</h2><span id='topic+plot_freq_coeff'></span>

<h3>Description</h3>

<p>Plot frequency profiles by fitted coeff lists
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_freq_coeff(DF, parameter_subsets)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_freq_coeff_+3A_df">DF</code></td>
<td>
<p>fit.final_space data frame</p>
</td></tr>
<tr><td><code id="plot_freq_coeff_+3A_parameter_subsets">parameter_subsets</code></td>
<td>
<p>fitted coeff lists subsets passed from fit.final_space</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A frequency plot of fitted parameter values.
</p>

<hr>
<h2 id='plot_freq_flux'>plot_freq_flux</h2><span id='topic+plot_freq_flux'></span>

<h3>Description</h3>

<p>Plot frequency profiles by fitted flux lists
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_freq_flux(DF, parameter_subsets)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_freq_flux_+3A_df">DF</code></td>
<td>
<p>fit.final_space data frame</p>
</td></tr>
<tr><td><code id="plot_freq_flux_+3A_parameter_subsets">parameter_subsets</code></td>
<td>
<p>fitted flux lists subsets passed from fit.final_space</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A frequency plot of fitted parameter values.
</p>

<hr>
<h2 id='plot_lda'>plot_lda</h2><span id='topic+plot_lda'></span>

<h3>Description</h3>

<p>Plot linear discriminant analysis by quartiles of summed squared residuals for all ADSR parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_lda(DF, names.swp.ADSR)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_lda_+3A_df">DF</code></td>
<td>
<p>fit.final_space data frame</p>
</td></tr>
<tr><td><code id="plot_lda_+3A_names.swp.adsr">names.swp.ADSR</code></td>
<td>
<p>names of swept ADSR parameters (alpha, delta, size, rayleigh, custom expressions), as vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A linear discriminant analysis by quartiles of summed squared residuals for all ADSR parameters
</p>

<hr>
<h2 id='plot_LS_surfaces_ADSR'>plot_LS_surfaces_ADSR</h2><span id='topic+plot_LS_surfaces_ADSR'></span>

<h3>Description</h3>

<p>Plot surfaces of summed squared residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_LS_surfaces_ADSR(DF, names.swp.ADSR)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_LS_surfaces_ADSR_+3A_df">DF</code></td>
<td>
<p>fit.final_space data frame</p>
</td></tr>
<tr><td><code id="plot_LS_surfaces_ADSR_+3A_names.swp.adsr">names.swp.ADSR</code></td>
<td>
<p>names of swept ADSR parameters (alpha, delta, size, rayleigh, custom expressions), as vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of surfaces of summed squared residuals for each ADSR parameter.
</p>

<hr>
<h2 id='plot_LS_surfaces_lists'>plot_LS_surfaces_lists</h2><span id='topic+plot_LS_surfaces_lists'></span>

<h3>Description</h3>

<p>Plot surfaces of summed squared residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_LS_surfaces_lists(DF, names.swp.lists)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_LS_surfaces_lists_+3A_df">DF</code></td>
<td>
<p>fit.final_space data frame</p>
</td></tr>
<tr><td><code id="plot_LS_surfaces_lists_+3A_names.swp.lists">names.swp.lists</code></td>
<td>
<p>names of swept list parameters (flux and coeff lists), as vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of surfaces of summed squared residuals for flux lists and coeff lists.
</p>

<hr>
<h2 id='plot_relaxation'>plot relaxation</h2><span id='topic+plot_relaxation'></span>

<h3>Description</h3>

<p>A function to plot the relaxation of isotope ratios in a system,
including characteristic times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_relaxation(
  workdir,
  flux_list,
  coeff_list,
  spiked_boxes,
  spike.max_delta = 100,
  n_steps = 10000,
  hidden_boxes = NULL,
  show.residence_time = TRUE,
  show.facets = FALSE,
  time_landmarks = NULL,
  time_as_log10 = TRUE,
  isobxr_master_file = "0_ISOBXR_MASTER",
  time.resolution_cut = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_relaxation_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.
(character string)</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_flux_list">flux_list</code></td>
<td>
<p>Name of the list of fluxes and initial box sizes to be used for the run, <br />
calling (by its header name) a single column of the <strong>FLUXES</strong> sheet
of the <strong><em>isobxr excel master file</em></strong>. <br />
(character string)</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_coeff_list">coeff_list</code></td>
<td>
<p>Name of the list of fractionation coefficients to be used for the run, <br />
calling (by its header name) a single column of the <strong>COEFFS</strong> sheet
of the <strong><em>isobxr excel master file</em></strong>. <br />
(character string)</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_spiked_boxes">spiked_boxes</code></td>
<td>
<p>Vector of box names (&quot;BOX_ID&quot;) to be spiked. <br />
If several boxes are listed, initial spike will be evenly distributed from 0 to spike.max_delta value.</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_spike.max_delta">spike.max_delta</code></td>
<td>
<p>Value of the maximum spike isotope composition <br />
(in permil on the delta scale). <br />
Default is 100 permil.</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_n_steps">n_steps</code></td>
<td>
<p>Number of calculation steps. Determines the resolution of the run. <br />
Default is 10000.</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_hidden_boxes">hidden_boxes</code></td>
<td>
<p>Vector of boxes to hide from plots. <br />
For instance c(&quot;SOURCE&quot;, &quot;SINK&quot;). <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_show.residence_time">show.residence_time</code></td>
<td>
<p>If TRUE, displays box-specific residence times on plot. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_show.facets">show.facets</code></td>
<td>
<p>If TRUE, displays results in box-specific facets. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_time_landmarks">time_landmarks</code></td>
<td>
<p>Vector of time landmarks to display on x-axis (numerical values).</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_time_as_log10">time_as_log10</code></td>
<td>
<p>If TRUE, uses logarithmic time scale in plot. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_isobxr_master_file">isobxr_master_file</code></td>
<td>
<p>Name of <strong><em>isobxr excel master file</em></strong>. <br />
Default is &quot;0_ISOBXR_MASTER&quot;.</p>
</td></tr>
<tr><td><code id="plot_relaxation_+3A_time.resolution_cut">time.resolution_cut</code></td>
<td>
<p>Time below which resolution is increased. Default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plots showing the evolution of the isotopic ratios in the system until full relaxation, <br />
defined as the maximum relaxation time multiplied by 10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
plot_relaxation(workdir = "/Users/username/Documents/1_ABC_tutorial",
                flux_list = "Fx6_ABC_open_bal",
                coeff_list = "a0",
                n_steps = 1000,
                spiked_boxes = c("SOURCE"))

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_scenario'>plot sim.scenario outputs</h2><span id='topic+plot_scenario'></span>

<h3>Description</h3>

<p>A function to plot delta and size vs time from the sim.scenario runs and to include observations along simulations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_scenario(
  workdir,
  scenario_dir_name,
  shown_runs = NULL,
  time_unit = NULL,
  hidden_boxes = NULL,
  return_as_print = TRUE,
  show.facets = FALSE,
  show.run_separations = TRUE,
  observations_file = NULL,
  observations_groups = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_scenario_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.
(character string)</p>
</td></tr>
<tr><td><code id="plot_scenario_+3A_scenario_dir_name">scenario_dir_name</code></td>
<td>
<p>name of sim.scenario SERIES directory (starts with 3_SCEN)</p>
</td></tr>
<tr><td><code id="plot_scenario_+3A_shown_runs">shown_runs</code></td>
<td>
<p>Vector of successive run numbers (RUN_n) to be displayed (e.g., 1:5). <br />
Default is run 2 to last run (hides initial relaxation run)</p>
</td></tr>
<tr><td><code id="plot_scenario_+3A_time_unit">time_unit</code></td>
<td>
<p>Time unit to use on plot if different from native time unit. <br />
Character string, to be selected among the following: <br />
<em>micros, ms, s, min, h, d, wk, mo, yr, kyr, Myr, Gyr</em> <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_scenario_+3A_hidden_boxes">hidden_boxes</code></td>
<td>
<p>List of boxes to hide from plots, as a vector of character strings. <br />
For instance c(&quot;SOURCE&quot;, &quot;SINK&quot;).</p>
</td></tr>
<tr><td><code id="plot_scenario_+3A_return_as_print">return_as_print</code></td>
<td>
<p>If TRUE, prints delta and size vs. time plots in a single page figure on R. <br />
If FALSE, returns separately delta and size vs. time plots as list of two editable R objects.</p>
</td></tr>
<tr><td><code id="plot_scenario_+3A_show.facets">show.facets</code></td>
<td>
<p>If TRUE, shows delta vs. time as faceted by BOX. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot_scenario_+3A_show.run_separations">show.run_separations</code></td>
<td>
<p>If TRUE, shows limits between subruns. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_scenario_+3A_observations_file">observations_file</code></td>
<td>
<p>Name of the csv file containing observations (without csv extension). <br />
Observation csv file should contain the following columns: <br />
</p>

<ol>
<li> <p><strong>GROUP</strong>: observation subset group label if relevant
</p>
</li>
<li> <p><strong>BOX_ID</strong>: BOX ID (e.g., A, OCEAN...) as defined in isobxr master file.
</p>
</li>
<li> <p><strong>delta.def</strong> definition of delta value, e.g., d18O
</p>
</li>
<li> <p><strong>obs.delta</strong> average observed delta numerical value
</p>
</li>
<li> <p><strong>obs.CI</strong> confidence interval of delta value
</p>
</li>
<li> <p><strong>obs.CI.def</strong> definition of confidence interval, e.g., 95
</p>
</li>
<li> <p><strong>obs.counts</strong> number of observations corresponding to average delta
</p>
</li>
<li> <p><strong>Time</strong> time of observation in scenario timeline, in display time units
</p>
</li></ol>

<p>Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_scenario_+3A_observations_groups">observations_groups</code></td>
<td>
<p>vector of observations groups to include in plot, <br />
from GROUP column in observation csv file. <br />
Default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A set of plots showing the evolution of delta and sizes with time.
</p>

<hr>
<h2 id='plot_sim_distrib'>plot_sim_distrib</h2><span id='topic+plot_sim_distrib'></span>

<h3>Description</h3>

<p>Plot distributions of all and fitted simulations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sim_distrib(DF, fit.counts, observations, bx.fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_sim_distrib_+3A_df">DF</code></td>
<td>
<p>fit.final_space data frame</p>
</td></tr>
<tr><td><code id="plot_sim_distrib_+3A_fit.counts">fit.counts</code></td>
<td>
<p>counts of simulations by groups passed from fit.final_space</p>
</td></tr>
<tr><td><code id="plot_sim_distrib_+3A_observations">observations</code></td>
<td>
<p>data frame of observations</p>
</td></tr>
<tr><td><code id="plot_sim_distrib_+3A_bx.fit">bx.fit</code></td>
<td>
<p>list of boxes fitted and unfitted groups and subgroups passed from fit.final_space</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of distributions of all and fitted simulations
</p>

<hr>
<h2 id='plot_sim_obs'>plot_sim_obs</h2><span id='topic+plot_sim_obs'></span>

<h3>Description</h3>

<p>Plot simulations against observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_sim_obs(DF, bx.fit, fit.counts)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_sim_obs_+3A_df">DF</code></td>
<td>
<p>fit.final_space data frame</p>
</td></tr>
<tr><td><code id="plot_sim_obs_+3A_bx.fit">bx.fit</code></td>
<td>
<p>list of boxes fitted and unfitted groups and subgroups passed from fit.final_space</p>
</td></tr>
<tr><td><code id="plot_sim_obs_+3A_fit.counts">fit.counts</code></td>
<td>
<p>counts of simulations by groups passed from fit.final_space</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of fitted simulated delta values against observations
</p>

<hr>
<h2 id='plot_single_run'>plot sim.single_run outputs</h2><span id='topic+plot_single_run'></span>

<h3>Description</h3>

<p>A function to plot delta and size vs time from the sim.single_run outputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_single_run(
  workdir,
  RUN_ID,
  time_as_log10 = TRUE,
  time_unit = NULL,
  hidden_boxes = NULL,
  return_as_print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_single_run_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.
(character string)</p>
</td></tr>
<tr><td><code id="plot_single_run_+3A_run_id">RUN_ID</code></td>
<td>
<p>ID of the run (formerly SERIES_RUN_ID).
Corresponds to the name of the .rds file storing the results of the run.</p>
</td></tr>
<tr><td><code id="plot_single_run_+3A_time_as_log10">time_as_log10</code></td>
<td>
<p>If TRUE, uses logarithmic time scale in plot. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="plot_single_run_+3A_time_unit">time_unit</code></td>
<td>
<p>Time unit to use on plot if different from native time unit. <br />
Character string, to be selected among the following: <br />
<em>micros, ms, s, min, h, d, wk, mo, yr, kyr, Myr, Gyr</em> <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="plot_single_run_+3A_hidden_boxes">hidden_boxes</code></td>
<td>
<p>List of boxes to hide from plots, as a vector of character strings. <br />
For instance c(&quot;SOURCE&quot;, &quot;SINK&quot;).</p>
</td></tr>
<tr><td><code id="plot_single_run_+3A_return_as_print">return_as_print</code></td>
<td>
<p>If TRUE, prints delta and size vs. time plots in a single page figure on R. <br />
If FALSE, returns separately delta and size vs. time plots as list of editable R objects. <br />
Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A set of plots showing the evolution of delta and sizes with time.
</p>

<hr>
<h2 id='quiet'>Preventing any console prints (for sweepers only)</h2><span id='topic+quiet'></span>

<h3>Description</h3>

<p>Preventing any console prints (for sweepers only)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quiet(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quiet_+3A_x">x</code></td>
<td>
<p>function to quiet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>

<hr>
<h2 id='read.dyn_2D_master'>Read and inspect sweep.dyn_2D master files</h2><span id='topic+read.dyn_2D_master'></span>

<h3>Description</h3>

<p>A function to read and inspect the sweep.dyn_2D master files
and obtain a master formatted list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.dyn_2D_master(workdir, dyn_2D_master_file, isobxr_master_file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.dyn_2D_master_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.
(character string)</p>
</td></tr>
<tr><td><code id="read.dyn_2D_master_+3A_dyn_2d_master_file">dyn_2D_master_file</code></td>
<td>
<p>Name of <strong><em>sweep.dyn_2D excel master file</em></strong>.
(without file &quot;xlsx&quot; extension).</p>
</td></tr>
<tr><td><code id="read.dyn_2D_master_+3A_isobxr_master_file">isobxr_master_file</code></td>
<td>
<p>Name of <strong><em>isobxr excel master file</em></strong>.
(without file &quot;xlsx&quot; extension).
Default is &quot;0_ISOBXR_MASTER&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of formatted dyn_2D_master_file master inputs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read.dyn_2D_master(workdir = "/Users/username/Documents/1_ABC_tutorial",
                   dyn_2D_master_file = "0_SWEEP_DYN_demo",
                   isobxr_master_file = "0_ISOBXR_MASTER")

</code></pre>

<hr>
<h2 id='read.final_nD_master'>Read and inspect sweep.final_nD master files</h2><span id='topic+read.final_nD_master'></span>

<h3>Description</h3>

<p>A function to read and inspect the sweep.final_nD master files
and obtain a master formatted list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.final_nD_master(workdir, final_nD_master_file, isobxr_master_file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.final_nD_master_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.
(character string)</p>
</td></tr>
<tr><td><code id="read.final_nD_master_+3A_final_nd_master_file">final_nD_master_file</code></td>
<td>
<p>Name of <strong><em>sweep.final_nD excel master file</em></strong>.
(without file &quot;xlsx&quot; extension).</p>
</td></tr>
<tr><td><code id="read.final_nD_master_+3A_isobxr_master_file">isobxr_master_file</code></td>
<td>
<p>Name of <strong><em>isobxr excel master file</em></strong>.
(without file &quot;xlsx&quot; extension).
Default is &quot;0_ISOBXR_MASTER&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>List contains:
</p>

<ol>
<li> <p><strong>param_space</strong> data frame of shuffled all combinations of all parameters values.
</p>
</li>
<li> <p><strong>sweep.DEFAULT</strong> data frame of default run conditions <br />
(flux and coeff lists, t_max, chunk size)
</p>
</li>
<li> <p><strong>sweep_lists_ids</strong> list of names of swept parameters
</p>
</li></ol>



<h3>Value</h3>

<p>List of formatted sweep.final_nD master inputs
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read.final_nD_master(workdir = "/Users/username/Documents/1_ABC_tutorial",
                     final_nD_master_file = "0_SWEEP_FINnD_demo",
                     isobxr_master_file = "0_ISOBXR_MASTER")

</code></pre>

<hr>
<h2 id='read.isobxr_master'>Read and inspect isobxr master files</h2><span id='topic+read.isobxr_master'></span>

<h3>Description</h3>

<p>A function to read and inspect the isobxr master files
and obtain a master formatted list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.isobxr_master(
  workdir,
  isobxr_master_file = "0_ISOBXR_MASTER",
  inspect = TRUE,
  export_rds = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.isobxr_master_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.
(character string)</p>
</td></tr>
<tr><td><code id="read.isobxr_master_+3A_isobxr_master_file">isobxr_master_file</code></td>
<td>
<p>Name of <strong><em>isobxr excel master file</em></strong>.
(without file &quot;xlsx&quot; extension).
Default is &quot;0_ISOBXR_MASTER&quot;.</p>
</td></tr>
<tr><td><code id="read.isobxr_master_+3A_inspect">inspect</code></td>
<td>
<p>If TRUE, checks all inputs from isobxr master file for format
and structure errors. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="read.isobxr_master_+3A_export_rds">export_rds</code></td>
<td>
<p>If TRUE, exports rds version of isobxr master file
to working directory. <br />
Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A formatted list of data frames containing constants, box, fluxes and
fractionation coefficients descriptions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read.isobxr_master(workdir = "/Users/username/Documents/1_ABC_tutorial",
                   isobxr_master_file = "0_ISOBXR_MASTER",
                   export_rds = FALSE,
                   inspect = TRUE)

</code></pre>

<hr>
<h2 id='read.scenario_master'>Read and inspect scenario master files</h2><span id='topic+read.scenario_master'></span>

<h3>Description</h3>

<p>A function to read and inspect the scenario master files
and obtain a master formatted list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.scenario_master(
  workdir,
  scenario_master_file,
  isobxr_master_file = "0_ISOBXR_MASTER"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.scenario_master_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.
(character string)</p>
</td></tr>
<tr><td><code id="read.scenario_master_+3A_scenario_master_file">scenario_master_file</code></td>
<td>
<p>Name of <strong><em>scenario excel master file</em></strong>.
(without file &quot;xlsx&quot; extension).</p>
</td></tr>
<tr><td><code id="read.scenario_master_+3A_isobxr_master_file">isobxr_master_file</code></td>
<td>
<p>Name of <strong><em>isobxr excel master file</em></strong>.
(without file &quot;xlsx&quot; extension).
Default is &quot;0_ISOBXR_MASTER&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of formatted scenario master inputs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read.scenario_master(workdir = "/Users/username/Documents/1_ABC_tutorial",
                     scenario_master_file = "0_SCENARIO_source_change",
                     isobxr_master_file = "0_ISOBXR_MASTER")

</code></pre>

<hr>
<h2 id='significance_pval_df'>edits a full dataframe of significance symbols from a dataframe of p-values</h2><span id='topic+significance_pval_df'></span>

<h3>Description</h3>

<p>edits a full dataframe of significance symbols from a dataframe of p-values
<br /> Symbols as asterisks denote p-values lower than .0001, .001, .01, .05. ns refers to non significant (higher than .5).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>significance_pval_df(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="significance_pval_df_+3A_x">x</code></td>
<td>
<p>a data frame column of p-values or a pvalues as double (alone or in vector).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-values symbols as dataframe or as string.
</p>

<hr>
<h2 id='sim.scenario'>Simulate a scenario</h2><span id='topic+sim.scenario'></span>

<h3>Description</h3>

<p>A function to compose an isotope box model scenario,
defined by a series of successive runs, <br />
each run inheriting from the final state conditions of the previous run. <br />
It is possible to force parameters at each run, namely:
</p>

<ol>
<li> <p><strong>fluxes</strong> <br />
(overwriting all or a subset of fluxes defined in <em>0_ISOBXR_MASTER.xlsx</em> master file)
</p>
</li>
<li> <p><strong>isotope fractionation coefficients</strong> <br />
(overwriting all or a subset of coefficients defined in <em>0_ISOBXR_MASTER.xlsx</em> master file)
</p>
</li>
<li> <p><strong>box sizes</strong> <br />
(overwriting all or a subset of box sizes defined in <em>0_ISOBXR_MASTER.xlsx</em> master file)
</p>
</li>
<li> <p><strong>rayleigh isotope distillation</strong>
</p>
</li>
<li> <p><strong>isotope composition of a source box at initial state</strong>
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>sim.scenario(
  workdir,
  SERIES_ID,
  scenario_master_file,
  isobxr_master_file = "0_ISOBXR_MASTER",
  plot.hidden_boxes = NULL,
  plot.time_unit = NULL,
  export.single_run_digests = FALSE,
  export.data_as_csv_xlsx = FALSE,
  show.delta_plot = TRUE,
  save_outputs = FALSE,
  inspect_inputs = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.scenario_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_series_id">SERIES_ID</code></td>
<td>
<p>Name of the series the scenario run belongs to.
It determines the folder in which the output files will be stored inside workdir.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_scenario_master_file">scenario_master_file</code></td>
<td>
<p>Name of <strong><em>scenario excel master file</em></strong>.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_isobxr_master_file">isobxr_master_file</code></td>
<td>
<p>Name of <strong><em>isobxr excel master file</em></strong>. <br />
Default is &quot;0_ISOBXR_MASTER&quot;.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_plot.hidden_boxes">plot.hidden_boxes</code></td>
<td>
<p>list of box names (BOX_ID) to hide in scenario plot.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_plot.time_unit">plot.time_unit</code></td>
<td>
<p>Time unit to use on plot if different from native time unit. <br />
Character string, to be selected among the following:<br />
<em>micros, ms, s, min, h, d, wk, mo, yr, kyr, Myr, Gyr</em><br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_export.single_run_digests">export.single_run_digests</code></td>
<td>
<p>If TRUE, exports full digest of each single run
of the scenario.
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_export.data_as_csv_xlsx">export.data_as_csv_xlsx</code></td>
<td>
<p>If TRUE, exports full scenario result data as csv and xlsx fo full
to scenario digest directory. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_show.delta_plot">show.delta_plot</code></td>
<td>
<p>If TRUE, prints delta and size time evolution plots in R. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_save_outputs">save_outputs</code></td>
<td>
<p>If TRUE, saves all run outputs to local working directory (workdir). <br />
By default, run outputs are stored in a temporary directory and erased if not saved. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.scenario_+3A_inspect_inputs">inspect_inputs</code></td>
<td>
<p>If TRUE, inspects and proof checks format of input taken from
<strong><em>isobxr excel master file</em></strong>. <br />
(Inspection run by <code><a href="#topic+read.isobxr_master">read.isobxr_master</a></code> function.) <br />
Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Delta values and box sizes as a function of time. <br />
sim.scenario outputs are saved to workdir if save_outputs = TRUE.
</p>


<h3>sim.scenario outputs consist of</h3>


<ol>
<li> <p><strong>single run results</strong> in SERIES directory: all single runs results as rds files
</p>
</li>
<li> <p><strong>scenario digest</strong> in scenario DIGEST directory (SERIES/DIGEST):
</p>

<ol>
<li> <p><strong>isobxr master file archive</strong> as xlsx
</p>
</li>
<li> <p><strong>scenario master file archive</strong> as xlsx
</p>
</li>
<li> <p><strong>plot of delta and size vs. time</strong> as pdf
</p>
</li>
<li> <p><strong>scenario results data set</strong> as rds, containing:
</p>

<ol>
<li> <p><strong>delta_vs_t</strong> data frame of delta as a function of time
</p>
</li>
<li> <p><strong>size_vs_t</strong> data frame of box sizes as a function of time
</p>
</li>
<li> <p><strong>scenario_master</strong> list containing all inputs from scenario master file
</p>
</li>
<li> <p><strong>scenario_log</strong> data frame of scenario specific LOG excerpt
</p>
</li>
<li> <p><strong>isobxr_master</strong> list containing all inputs from isobxr master file
</p>
</li>
<li> <p><strong>paths</strong> list of scenario specific paths
</p>
</li></ol>

</li></ol>

</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
sim.scenario(workdir = "/Users/username/Documents/1_ABC_tutorial",
             SERIES_ID =  "1_source_change",
             scenario_master_file = "0_SCENARIO_source_change",
             isobxr_master_file = "0_ISOBXR_MASTER")

## End(Not run)
</code></pre>

<hr>
<h2 id='sim.single_run'>Run a single isotope box-model simulation</h2><span id='topic+sim.single_run'></span>

<h3>Description</h3>

<p>A function to run the isobxr stable isotope box model,
assessing the design of the model and automatically running <code><a href="#topic+solve_numerically">solve_numerically</a></code>
or <code><a href="#topic+solve_analytically">solve_analytically</a></code> depending on system design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.single_run(
  workdir,
  SERIES_ID,
  flux_list,
  coeff_list,
  t_max,
  n_steps,
  isobxr_master_file = "0_ISOBXR_MASTER",
  suppress_messages = FALSE,
  export.diagrams = FALSE,
  export.delta_plot = FALSE,
  export.data_as_csv_xlsx = FALSE,
  plot.time_as_log10 = TRUE,
  plot.time_unit = NULL,
  show.delta_plot = TRUE,
  inspect_inputs = TRUE,
  save_outputs = FALSE,
  return_data = FALSE,
  solver = "auto",
  n_zeros_RUN_IDs = 4,
  FORCING_RAYLEIGH = NULL,
  FORCING_SIZE = NULL,
  FORCING_DELTA = NULL,
  FORCING_ALPHA = NULL,
  COMPOSITE = FALSE,
  COMPO_SERIES_n = NaN,
  COMPO_SERIES_FAMILY = NaN,
  EXPLORER = FALSE,
  EXPLO_SERIES_n = NaN,
  EXPLO_SERIES_FAMILY = NaN,
  isobxr_master = NULL,
  diagram_pdf.widh_height = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim.single_run_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>isobxr excel master file</em></strong>
and where output files will be stored if exported by user.
(character string)</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_series_id">SERIES_ID</code></td>
<td>
<p>Name of the series the run belongs to. <br />
It determines the folder in which the output files will be stored inside workdir.<br />
(character string)</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_flux_list">flux_list</code></td>
<td>
<p>Name of the list of fluxes and initial box sizes to be used for the run, <br />
calling (by its header name) a single column of the <strong>FLUXES</strong> sheet
of the <strong><em>isobxr excel master file</em></strong>. <br />
(character string)</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_coeff_list">coeff_list</code></td>
<td>
<p>Name of the list of fractionation coefficients to be used for the run, <br />
calling (by its header name) a single column of the <strong>COEFFS</strong> sheet
of the <strong><em>isobxr excel master file</em></strong>. <br />
(character string)</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_t_max">t_max</code></td>
<td>
<p>Run duration, given in the same time units as unit declared in <strong>CONSTANTS</strong> <br />
spreadsheet of <strong><em>isobxr excel master file</em></strong> in the <strong>TIME_UNIT</strong> column.
(integer)</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_n_steps">n_steps</code></td>
<td>
<p>Number of calculation steps. <br />
It determines the resolution of the run. <br />
(integer)</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_isobxr_master_file">isobxr_master_file</code></td>
<td>
<p>Name of <strong><em>isobxr excel master file</em></strong>. <br />
Default is &quot;0_ISOBXR_MASTER&quot;.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_suppress_messages">suppress_messages</code></td>
<td>
<p>If TRUE, hides all information and warning messages regarding run. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_export.diagrams">export.diagrams</code></td>
<td>
<p>If TRUE, exports box-model flux and fractionation diagrams as pdf. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_export.delta_plot">export.delta_plot</code></td>
<td>
<p>If TRUE, exports delta and size time evolution plots of the evolution
of the system, as pdf. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_export.data_as_csv_xlsx">export.data_as_csv_xlsx</code></td>
<td>
<p>If TRUE, exports all results and run conditions as csv and xlsx files, <br />
to DIGEST directory. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_plot.time_as_log10">plot.time_as_log10</code></td>
<td>
<p>If TRUE, uses logarithmic time scale in plot. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_plot.time_unit">plot.time_unit</code></td>
<td>
<p>Time unit to use on plot if different from native time unit. <br />
Character string, to be selected among the following:<br />
<em>micros, ms, s, min, h, d, wk, mo, yr, kyr, Myr, Gyr</em><br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_show.delta_plot">show.delta_plot</code></td>
<td>
<p>If TRUE, prints delta and size time evolution plots in R.
Default is TRUE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_inspect_inputs">inspect_inputs</code></td>
<td>
<p>If TRUE, inspects and proof checks format of input taken from
<strong><em>isobxr excel master file</em></strong>. <br />
(Inspection run by <code><a href="#topic+read.isobxr_master">read.isobxr_master</a></code> function.) <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_save_outputs">save_outputs</code></td>
<td>
<p>If TRUE, saves all run outputs to local working directory (workdir). <br />
By default, run outputs are stored in a temporary directory and erased if not saved. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_return_data">return_data</code></td>
<td>
<p>If TRUE, returns all data (inputs and outputs) as a list. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_solver">solver</code></td>
<td>
<p>Determines what solver to used: &quot;analytical&quot; or &quot;numerical&quot;. <br />
Default is &quot;auto&quot; for automatic selection of adapted solver.
Note that this option returns warnings or prevents user to run when solver wished is
not adapted to system solution.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_n_zeros_run_ids">n_zeros_RUN_IDs</code></td>
<td>
<p>Number of figures used in iteration of RUNs of a given series (SERIES_ID). <br />
Default is 4: the run IDs of a given series range between 0001 and 9999.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_forcing_rayleigh">FORCING_RAYLEIGH</code></td>
<td>
<p><em>OPTIONAL</em> <br />
Dataframe describing the forcing on a fractionation coefficient
by a Rayleigh isotope distillation, <br />
as a function of flux intensities and a fundamental fractionation coefficient. <br />
Dataframe formatting details are in isobxr vignette. <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_forcing_size">FORCING_SIZE</code></td>
<td>
<p><em>OPTIONAL</em> <br />
Dataframe describing the forcing on one or several box sizes (mass of element X). <br />
The newly defined sizes for the given set of boxes
overwrite their sizes as previously defined in <strong><em>isobxr excel master file</em></strong>. <br />
Dataframe formatting details are in isobxr vignette. <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_forcing_delta">FORCING_DELTA</code></td>
<td>
<p><em>OPTIONAL</em> <br />
Dataframe describing the forcing on one or several boxes
initial isotope composition expressed as delta values. <br />
The newly defined delta values for the given set of boxes
overwrite the delta values as previously defined in <strong><em>isobxr excel master file</em></strong>. <br />
Dataframe formatting details are in isobxr vignette. <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_forcing_alpha">FORCING_ALPHA</code></td>
<td>
<p><em>OPTIONAL</em> <br />
Dataframe describing the forcing on one or several
fractionation coefficients from one reservoir to another. <br />
The newly defined alpha values for the given set of boxes
overwrite the alpha values as previously defined in <strong><em>isobxr excel master file</em></strong>. <br />
Dataframe formatting details are in isobxr vignette. <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_composite">COMPOSITE</code></td>
<td>
<p><em>NOT TO BE USED IN SINGLE RUN</em>  <br />
Logical value automatically defined in <code><a href="#topic+sim.scenario">sim.scenario</a></code>. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_compo_series_n">COMPO_SERIES_n</code></td>
<td>
<p><em>NOT TO BE USED IN SINGLE RUN</em>  <br />
Iteration of the composite run for the given series it belongs to,
automatically defined in <code><a href="#topic+sim.scenario">sim.scenario</a></code>.  <br />
Default is NaN.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_compo_series_family">COMPO_SERIES_FAMILY</code></td>
<td>
<p><em>NOT TO BE USED IN SINGLE RUN</em> <br />
Composite run series family, automatically defined in
<code><a href="#topic+sim.scenario">sim.scenario</a></code>. <br />
Default is NaN.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_explorer">EXPLORER</code></td>
<td>
<p><em>NOT TO BE USED IN SINGLE RUN</em> <br />
Logical value automatically defined in <code><a href="#topic+sweep.final_nD">sweep.final_nD</a></code>
or <code><a href="#topic+sweep.dyn_2D">sweep.dyn_2D</a></code>. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_explo_series_n">EXPLO_SERIES_n</code></td>
<td>
<p><em>NOT TO BE USED IN SINGLE RUN</em>  <br />
Iteration of the sweep run for the given series it belongs to,
automatically defined in <code><a href="#topic+sweep.final_nD">sweep.final_nD</a></code> or <code><a href="#topic+sweep.dyn_2D">sweep.dyn_2D</a></code>. <br />
Default is NaN.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_explo_series_family">EXPLO_SERIES_FAMILY</code></td>
<td>
<p><em>NOT TO BE USED IN SINGLE RUN</em>  <br />
Sweep run series family, automatically defined in
<code><a href="#topic+sweep.final_nD">sweep.final_nD</a></code> or <code><a href="#topic+sweep.dyn_2D">sweep.dyn_2D</a></code>. <br />
Default is NaN.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_isobxr_master">isobxr_master</code></td>
<td>
<p>isobxr_master list of input dataframes formatted by
<code><a href="#topic+read.isobxr_master">read.isobxr_master</a></code> <br />
Overwrites isobxr_master_file.
Default is NULL.</p>
</td></tr>
<tr><td><code id="sim.single_run_+3A_diagram_pdf.widh_height">diagram_pdf.widh_height</code></td>
<td>
<p>Vector of width and height in inches of the pdf diagrams.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A results data set as a list containing the following components:
</p>

<ol>
<li> <p><strong>inputs</strong> input data:
</p>

<ol>
<li> <p><strong>CONSTS</strong> data frame of all run specific constants.
</p>
</li>
<li> <p><strong>INITIAL</strong> data frame of delta and sizes at t = 0 in all boxes.
</p>
</li>
<li> <p><strong>FLUXES</strong> data frame of all fluxes intensities (row ID: FROM / col ID: TO)
</p>
</li>
<li> <p><strong>COEFFS</strong> data frame of all fractionation coefficient values (row ID: FROM / col ID: TO)
</p>
</li>
<li> <p><strong>BOX_META</strong> data frame of box specific metadata (e.g., flux balance, residence times, layout position )
</p>
</li>
<li> <p><strong>bx.groups</strong> list of box names grouped by relevant categories (e.g., disconnected boxes, infinite boxes)
</p>
</li>
<li> <p><strong>LOG</strong> data frame of run specific LOG excerpt.
</p>
</li></ol>

</li>
<li> <p><strong>outputs</strong> output data:
</p>

<ol>
<li> <p><strong>solver</strong>
</p>
</li>
<li> <p><strong>final_state</strong>
</p>
</li>
<li> <p><strong>delta_vs_t</strong>
</p>
</li>
<li> <p><strong>size_vs_t</strong>
</p>
</li>
<li> <p><strong>for analytical solutions</strong>
</p>

<ol>
<li> <p><strong>diffeq_solutions</strong> solutions of differential equations, <br />
including relaxation times, eigenvalues, constants, eigenvectors
</p>
</li></ol>

</li></ol>

</li>
<li> <p><strong>paths</strong> list of run specific paths
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
sim.single_run(workdir = "/Users/username/Documents/1_ABC_tutorial",
               SERIES_ID = "1_ABC_balanced_closed",
               flux_list = "Fx1_ABC_bal",
               coeff_list = "a1",
               t_max = 2500,
               n_steps = 2500)

## End(Not run)
</code></pre>

<hr>
<h2 id='solve_analytically'>Analytically solve stable isotope box models</h2><span id='topic+solve_analytically'></span>

<h3>Description</h3>

<p>An analytical solver of the system of ordinary differential <br />
equations (ODES) of stable isotope ratios of element X in all boxes. <br />
Not intended for manual use. <br />
The analytical solver finds the eigenvalues and eigenvectors of the ODES. <br />
It determines the set of analytical solutions that describes
the evolution of isotope ratios in each box over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solve_analytically(IN, paths, to_DIGEST_csv = FALSE, return_results = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="solve_analytically_+3A_in">IN</code></td>
<td>
<p>input data, edited by <code><a href="#topic+sim.single_run">sim.single_run</a></code> (list of dataframes)</p>
</td></tr>
<tr><td><code id="solve_analytically_+3A_paths">paths</code></td>
<td>
<p>paths object edited by <code><a href="#topic+sim.single_run">sim.single_run</a></code> (list of characters)</p>
</td></tr>
<tr><td><code id="solve_analytically_+3A_to_digest_csv">to_DIGEST_csv</code></td>
<td>
<p>if TRUE, edits csv outputs to DIGEST directory <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="solve_analytically_+3A_return_results">return_results</code></td>
<td>
<p>if TRUE, results returned as a list of R objects. <br />
Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Analytically determined evolution of stable isotope compositions
in all boxes over the run duration as specified in INPUT file. <br /> <br />
</p>
<p>Run outputs are stored in a temporary directory and not exported by <code><a href="#topic+solve_numerically">solve_numerically</a></code>.
<br /> <br />
The outputs of the run are stored in the rds output file in the SERIES directory
with the following file name structure:  <br />
<strong><em>SERIES_ID + RUN_n.rds</em></strong>
</p>


<h3>Optional csv outputs to the DIGEST folder are as follows</h3>


<ol>
<li><p> OUT data file with initial and final size and delta values in all boxes. <br />
(file name structure: <strong><em>out_1_A_OUT + SERIES_ID + RUN_n + .csv</em></strong>)
</p>
</li>
<li><p> ODE_SOLNs data file summarizing outputs of the analytical solutions of the ODES  <br />
(eigenvalues, eigenvectors, relaxation times, constants according to initial conditions).  <br />
(file name structure: <strong><em>out_2_A_ODE_SOLNs + SERIES_ID + RUN_n + .csv</em></strong>)
</p>
</li>
<li><p> evD data file of the evolution with time of the delta values in all boxes.  <br />
(file name structure: <strong><em>out_3_A_evD + SERIES_ID + RUN_n + .csv</em></strong>)
</p>
</li></ol>


<hr>
<h2 id='solve_numerically'>Numerically solve stable isotope box models</h2><span id='topic+solve_numerically'></span>

<h3>Description</h3>

<p>A numerical solver of the system of ordinary differential equations (ODES), <br />
describing the evolution of stable isotope ratios in all boxes of a system. <br />
Not intended for manual use. <br />
The numerical solver uses the <strong><em>deSolve::ode</em></strong> function
to integrate the stable isotopes ratios over time in each box. It allows the
calculation of the evolution of stable isotope ratio in the case of
unbalanced outward and inward fluxes of element X in a given box
resulting in the accumulation or loss of element X.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solve_numerically(IN, paths, to_DIGEST_csv = FALSE, return_results = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="solve_numerically_+3A_in">IN</code></td>
<td>
<p>input data, edited by <code><a href="#topic+sim.single_run">sim.single_run</a></code> (list of dataframes)</p>
</td></tr>
<tr><td><code id="solve_numerically_+3A_paths">paths</code></td>
<td>
<p>paths object edited by <code><a href="#topic+sim.single_run">sim.single_run</a></code> (list of characters)</p>
</td></tr>
<tr><td><code id="solve_numerically_+3A_to_digest_csv">to_DIGEST_csv</code></td>
<td>
<p>if TRUE, edits csv outputs to DIGEST directory <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="solve_numerically_+3A_return_results">return_results</code></td>
<td>
<p>if TRUE, results returned as a list of R objects. <br />
Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numerically determined evolution of stable isotope compositions <br />
and masses of element X in all boxes over the run duration as specified in INPUT file.
<br />  <br />
Run outputs are stored in a temporary directory and not exported by <code><a href="#topic+solve_numerically">solve_numerically</a></code>.
<br /> <br />
The outputs of the run are stored in the rds output file in the SERIES directory
with the following file name structure:  <br />
<strong><em>SERIES_ID + RUN_n.rds</em></strong>
</p>


<h3>Optional csv outputs to DIGEST directory are as follows</h3>


<ol>
<li><p> OUT data file storing initial and final size and delta values in all boxes.<br />
(file name structure: <strong><em>out_1_N_OUT + RUN name + .csv</em></strong>)
</p>
</li>
<li><p> evS data file storing the evolution with time of the sizes (masses of element X) of all boxes.<br />
(file name structure:  <strong><em>out_2_N_evS + RUN name + .csv</em></strong>)
</p>
</li>
<li><p> evD data file storing the evolution with time of the delta values in all boxes.<br />
(file name structure:  <strong><em>out_3_N_evD + RUN name + .csv</em></strong>)
</p>
</li></ol>


<hr>
<h2 id='sweep.dyn_2D'>Sweep the space of two parameters during the response to a perturbation</h2><span id='topic+sweep.dyn_2D'></span>

<h3>Description</h3>

<p>A function to assess the influence of two parameters (varying
over a range of values) on dynamic evolution of a system in response to a given perturbation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sweep.dyn_2D(
  workdir,
  SERIES_ID,
  plot.time_unit = NULL,
  isobxr_master_file = "0_ISOBXR_MASTER",
  sweep_master_file,
  swept_param_1,
  swept_param_2,
  export.data_as_csv_xlsx = TRUE,
  show.delta_plot = TRUE,
  save_outputs = FALSE,
  ask_confirmation = TRUE,
  keep_single_run_rds = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sweep.dyn_2D_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>0_ISOBXR_MASTER.xlsx</em></strong> master file, <br />
of the dynamic sweep master file (e.g., <strong><em>0_EXPLO_DYN_MASTER.xlsx</em></strong>) <br />
and where output files will be stored if saved by user. <br />
(character string)</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_series_id">SERIES_ID</code></td>
<td>
<p>Name of the sweep series belongs to. <br />
It determines the folder in which the output files will be stored inside workdir.<br />
(character string)</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_plot.time_unit">plot.time_unit</code></td>
<td>
<p>Time unit to use on plot if different from native time unit. <br />
Character string, to be selected among the following:<br />
<em>micros, ms, s, min, h, d, wk, mo, yr, kyr, Myr, Gyr</em><br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_isobxr_master_file">isobxr_master_file</code></td>
<td>
<p>Name of <strong><em>isobxr excel master file</em></strong>. <br />
Default is &quot;0_ISOBXR_MASTER&quot;.</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_sweep_master_file">sweep_master_file</code></td>
<td>
<p>Name of <strong><em>sweep.dyn_2D excel master file</em></strong>.
(without file &quot;xlsx&quot; extension).</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_swept_param_1">swept_param_1</code></td>
<td>
<p>Set of values of sweeping parameter 1. <br />
Formatted data frame, see vignette for further details.</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_swept_param_2">swept_param_2</code></td>
<td>
<p>Set of values of sweeping parameter 2. <br />
Formatted data frame, see vignette for further details.</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_export.data_as_csv_xlsx">export.data_as_csv_xlsx</code></td>
<td>
<p>If TRUE, exports full sweep result data as csv and xlsx fo full
to sweep digest directory. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_show.delta_plot">show.delta_plot</code></td>
<td>
<p>If TRUE, prints delta and size time evolution plots in R. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_save_outputs">save_outputs</code></td>
<td>
<p>If TRUE, saves all run outputs to local working directory (workdir). <br />
By default, run outputs are stored in a temporary directory and erased if not saved. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_ask_confirmation">ask_confirmation</code></td>
<td>
<p>If TRUE, asks confirmation to run in interactive sessions. <br />
Default is TRUE.</p>
</td></tr>
<tr><td><code id="sweep.dyn_2D_+3A_keep_single_run_rds">keep_single_run_rds</code></td>
<td>
<p>If TRUE, keeps single runs outputs (rds files in SERIES directory). <br />
Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Delta values and box sizes as a function of time in response to a perturbation,
in a 2D space of parameters
sweep.dyn_2D outputs are saved to workdir if save_outputs = TRUE.
</p>


<h3>sweep.dyn_2D outputs consist of</h3>


<ol>
<li> <p><strong>single run results</strong> in SERIES directory: all single runs results as rds files <br />
(keep_single_run_rds = TRUE)
</p>
</li>
<li> <p><strong>sweep digest</strong> in sweep DIGEST directory (SERIES/DIGEST):
</p>

<ol>
<li> <p><strong>isobxr master file archive</strong> as xlsx (export.data_as_csv_xlsx = TRUE)
</p>
</li>
<li> <p><strong>sweep.dyn_2D master file archive</strong> as xlsx (export.data_as_csv_xlsx = TRUE)
</p>
</li>
<li> <p><strong>sweep.dyn_2D LOG excerpt</strong> as csv (export.data_as_csv_xlsx = TRUE)
</p>
</li>
<li> <p><strong>delta_size_vs_t</strong> csv of delta and size vs time in 2D space (export.data_as_csv_xlsx = TRUE)
</p>
</li>
<li> <p><strong>plot of delta and size vs. time in 2D space</strong> as pdf
</p>
</li>
<li> <p><strong>sweep.dyn_2D results data set</strong> as rds, containing:
</p>

<ol>
<li> <p><strong>delta_size_vs_t</strong> data frame of delta and size as a function of time
</p>
</li>
<li> <p><strong>sweeep_master</strong> list containing all inputs from sweep master file
</p>
</li>
<li> <p><strong>sweep_log</strong> data frame of sweep specific LOG excerpt
</p>
</li>
<li> <p><strong>isobxr_master</strong> list containing all inputs from isobxr master file
</p>
</li>
<li> <p><strong>paths</strong> list of sweep specific paths
</p>
</li></ol>

</li></ol>

</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
sweep.dyn_2D(workdir = "/Users/username/Documents/1_ABC_tutorial",
             SERIES_ID = "sweep_dyn_test",
             isobxr_master_file = "0_ISOBXR_MASTER",
             sweep_master_file = "0_SWEEP_DYN_demo",
             swept_param_1 = data.frame(FROM = c("A"),
                                        TO = c("C"),
                                        ALPHA_MIN = 0.999,
                                        ALPHA_MAX = 1,
                                        ALPHA_STEPS = 0.0005,
                                        EXPLO_TYPES = "EXPLO_1_ALPHA"),
             swept_param_2 = data.frame(BOX_ID = c("B"),
                                        SIZE_MIN = 2100,
                                        SIZE_MAX = 3000,
                                        SIZE_STEPS = 300,
                                        EXPLO_TYPES = "EXPLO_1_SIZE"),
             ask_confirmation = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='sweep.final_nD'>Sweep the space of n parameters at the final state of a system</h2><span id='topic+sweep.final_nD'></span>

<h3>Description</h3>

<p>A function to assess the influence of n parameters (varying
over a range of values) on the final state of a system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sweep.final_nD(
  workdir,
  sweep_master_file,
  sweep_dir_to_complete = NULL,
  export.data_as_csv_xlsx = FALSE,
  isobxr_master_file = "0_ISOBXR_MASTER",
  save_outputs = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sweep.final_nD_+3A_workdir">workdir</code></td>
<td>
<p>Working directory of <strong><em>0_ISOBXR_MASTER.xlsx</em></strong> master file, <br />
of the dynamic sweep master file (e.g., <strong><em>0_EXPLO_DYN_MASTER.xlsx</em></strong>) <br />
and where output files will be stored if saved by user. <br />
(character string)</p>
</td></tr>
<tr><td><code id="sweep.final_nD_+3A_sweep_master_file">sweep_master_file</code></td>
<td>
<p>Name of <strong><em>sweep.final_nD excel master file</em></strong>.
(without file &quot;xlsx&quot; extension).</p>
</td></tr>
<tr><td><code id="sweep.final_nD_+3A_sweep_dir_to_complete">sweep_dir_to_complete</code></td>
<td>
<p>Name of directory of previously halted sweep.final_nD
run that the user wishes to continue. Starts with &quot;4_FINnD&quot;. <br />
Default is NULL.</p>
</td></tr>
<tr><td><code id="sweep.final_nD_+3A_export.data_as_csv_xlsx">export.data_as_csv_xlsx</code></td>
<td>
<p>If TRUE, exports chunk sweep result data as csv and xlsx fo full
to chunk digest directory. <br />
Default is FALSE.</p>
</td></tr>
<tr><td><code id="sweep.final_nD_+3A_isobxr_master_file">isobxr_master_file</code></td>
<td>
<p>Name of <strong><em>isobxr excel master file</em></strong>. <br />
Default is &quot;0_ISOBXR_MASTER&quot;.</p>
</td></tr>
<tr><td><code id="sweep.final_nD_+3A_save_outputs">save_outputs</code></td>
<td>
<p>If TRUE, saves all run outputs to local working directory (workdir). <br />
By default, run outputs are stored in a temporary directory and erased if not saved.
Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Delta values and box sizes at final state of the system, in the n-dimensions space of parameters.
sweep.final_nD outputs are saved to workdir if save_outputs = TRUE.
</p>


<h3>sweep.final_nD outputs</h3>


<ol>
<li> <p><strong>digest sweep.final_nD outputs</strong> full sweep.final_nD outputs are stored in a digest directory directly in workdir:
</p>

<ol>
<li> <p><strong>isobxr master file archive</strong> as xlsx
</p>
</li>
<li> <p><strong>global chunk_log</strong> as csv
</p>
</li>
<li> <p><strong>global chunk_log</strong> as rds
</p>
</li>
<li> <p><strong>sweep.final_nD master file archive</strong> as xlsx
</p>
</li>
<li> <p><strong>sweep.final_nD merged chunks LOG excerpt</strong> as csv
</p>
</li>
<li> <p><strong>sweep.final_nD merged param_space</strong>, current progress, as rds (space of swept parameters)
</p>
</li>
<li> <p><strong>sweep.final_nD merged results</strong>, current progress, as rds
</p>

<ol>
<li><p> data frame containing delta and size at final state across whole n-dimensions space of parameters
</p>
</li>
<li> <p><strong>sweep.final_nD param_space</strong> as planned, as rds
</p>
</li>
<li> <p><strong>sweep.final_nD sweep_default</strong> data frame of default run conditions, as rds
</p>
</li>
<li> <p><strong>sweep.final_nD sweep progress plot</strong> as pdf, follows merging of chunks
</p>
</li></ol>

</li></ol>

</li>
<li> <p><strong>chunks sweep.final_nD outputs</strong> chunk directories are edited in case total number.
of runs exceeds chunk size defined in sweep.final_nD master file. They are removed after full sweep.
</p>
</li></ol>


<hr>
<h2 id='tempdir_tree'>tempdir_tree</h2><span id='topic+tempdir_tree'></span>

<h3>Description</h3>

<p>display tree of the temporary isobxr directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tempdir_tree()
</code></pre>


<h3>Value</h3>

<p>a print of the directory tree
</p>

<hr>
<h2 id='time_converter'>Convert time units in a dataframe column</h2><span id='topic+time_converter'></span>

<h3>Description</h3>

<p>Convert the time units in plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_converter(
  dataframe,
  time_colname,
  conv_timecolname,
  former_unit,
  new_unit
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="time_converter_+3A_dataframe">dataframe</code></td>
<td>
<p>dataframe for which a column with numerical time values should be converted.</p>
</td></tr>
<tr><td><code id="time_converter_+3A_time_colname">time_colname</code></td>
<td>
<p>name of column with time (numerical) values to be converted to a different time unit. <br />
(character string)</p>
</td></tr>
<tr><td><code id="time_converter_+3A_conv_timecolname">conv_timecolname</code></td>
<td>
<p>name of the column after time units conversion.  <br />
Can be identical to time_colname. <br />
(character string)</p>
</td></tr>
<tr><td><code id="time_converter_+3A_former_unit">former_unit</code></td>
<td>
<p>former time unit. Character string among the following: <br />
<em>micros, ms, s, min, h, d, wk, mo, yr, kyr, Myr, Gyr</em></p>
</td></tr>
<tr><td><code id="time_converter_+3A_new_unit">new_unit</code></td>
<td>
<p>new time unit. Character string among the following: <br />
<em>micros, ms, s, min, h, d, wk, mo, yr, kyr, Myr, Gyr</em></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with values converted to new time unit.
</p>

<hr>
<h2 id='to_tmpdir'>address_to_tmpdir</h2><span id='topic+to_tmpdir'></span>

<h3>Description</h3>

<p>makes path to a isobxr_temp_data directory located in temporary directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_tmpdir(dir_or_file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_tmpdir_+3A_dir_or_file">dir_or_file</code></td>
<td>
<p>directory or file to address in temporary directory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>name of subdirectory or file
</p>

<hr>
<h2 id='using_extdata_tutorial'>using_extdata_tutorial V1</h2><span id='topic+using_extdata_tutorial'></span>

<h3>Description</h3>

<p>identifies workdir value referring to use of extdata tutorial files, returns correct workdir value, <br />
prevents saving outputs locally (save_run_outputs = FALSE) <br />
forces display of default graphical output to R session (plot_results = TRUE)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>using_extdata_tutorial(workdir, save_run_outputs, plot_results)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="using_extdata_tutorial_+3A_workdir">workdir</code></td>
<td>
<p>working directory value referring to extdata tutorial files, several options among the following: <br />
c(&quot;/Users/username/Documents/1_ABC_tutorial&quot;,
&quot;use_isobxr_demonstration_files&quot;,
system.file(&quot;extdata&quot;, package = &quot;isobxr&quot;),
system.file(&quot;extdata&quot;, &quot;0_ISOBXR_MASTER.xlsx&quot;, package = &quot;isobxr&quot;))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with a boolean stating whether this is a tutorial mode, a workdir value allowing reading of extdata tutorial files, save_run_outputs = FALSE, plot_results = TRUE
</p>

<hr>
<h2 id='using_extdata_tutorial_2'>using_extdata_tutorial_2</h2><span id='topic+using_extdata_tutorial_2'></span>

<h3>Description</h3>

<p>identifies workdir value referring to use of extdata tutorial files, returns correct workdir value, <br />
prevents saving outputs locally (save_run_outputs = FALSE) <br />
forces display of default graphical output to R session (plot_results = TRUE)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>using_extdata_tutorial_2(workdir, save_outputs, plot_results)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="using_extdata_tutorial_2_+3A_workdir">workdir</code></td>
<td>
<p>working directory value referring to extdata tutorial files, several options among the following: <br />
c(&quot;/Users/username/Documents/1_ABC_tutorial&quot;,
&quot;use_isobxr_demonstration_files&quot;,
system.file(&quot;extdata&quot;, package = &quot;isobxr&quot;),
system.file(&quot;extdata&quot;, &quot;0_ISOBXR_MASTER.xlsx&quot;, package = &quot;isobxr&quot;))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with a boolean stating whether this is a tutorial mode, a workdir value allowing reading of extdata tutorial files, save_run_outputs = FALSE, plot_results = TRUE
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
