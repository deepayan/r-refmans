<!DOCTYPE html><html><head><title>Help for package MultiLCIRT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MultiLCIRT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MultiLCIRT-package'><p>Multidimensional Latent Class (LC) Item Response Theory (IRT) Models</p></a></li>
<li><a href='#aggr_data'><p>Aggregate data</p></a></li>
<li><a href='#class_item'><p>Hierarchical classification of test items</p></a></li>
<li><a href='#compare_models'><p>Compare different models fitted by est_multi_poly</p></a></li>
<li><a href='#est_multi_glob'><p>Fit marginal regression models for categorical responses</p></a></li>
<li><a href='#est_multi_poly'><p>Estimate multidimensional LC IRT model for dichotomous and polytomous responses</p></a></li>
<li><a href='#est_multi_poly_clust'><p>Estimate multidimensional and multilevel LC IRT model for dichotomous and polytomous responses</p></a></li>
<li><a href='#hads'><p>Dataset about measurement of anxiety and depression in oncological patients</p></a></li>
<li><a href='#inv_glob'><p>Invert marginal logits</p></a></li>
<li><a href='#lk_obs_score'><p>Compute observed log-likelihood and score</p></a></li>
<li><a href='#lk_obs_score_clust'><p>Compute observed log-likelihood and score</p></a></li>
<li><a href='#matr_glob'><p>Matrices to compute generalized logits</p></a></li>
<li><a href='#naep'><p>NAEP dataset</p></a></li>
<li><a href='#print.class_item'><p>Print the output of class_item object</p></a></li>
<li><a href='#print.est_multi_poly'><p>Print the output of est_multi_poly object</p></a></li>
<li><a href='#print.est_multi_poly_clust'><p>Print the output of est_multi_poly_clust object</p></a></li>
<li><a href='#print.test_dim'><p>Print the output of test_dim object</p></a></li>
<li><a href='#prob_multi_glob'><p>Global probabilities</p></a></li>
<li><a href='#search.model'><p>Search for the global maximum of the log-likelihood</p></a></li>
<li><a href='#standard.matrix'><p>Standardization of a matrix of support points on the basis of a vector of probabilities</p></a></li>
<li><a href='#summary.class_item'><p>Print the output of class_item object</p></a></li>
<li><a href='#summary.est_multi_poly'><p>Print the output of test_dim object</p></a></li>
<li><a href='#summary.est_multi_poly_clust'><p>Print the output of est_multi_poly_clust object</p></a></li>
<li><a href='#summary.test_dim'><p>Print the output of test_dim object</p></a></li>
<li><a href='#test_dim'><p>Likelihood ratio testing between nested multidimensional LC IRT models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multidimensional Latent Class Item Response Theory Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.11</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-05-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francesco Bartolucci &lt;bart@stat.unipg.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Framework for the Item Response Theory analysis of dichotomous and ordinal polytomous outcomes under the assumption of multidimensionality and discreteness of the latent traits. The fitting algorithms allow for missing responses and for different item parameterizations and are based on the Expectation-Maximization paradigm. Individual covariates affecting the class weights may be included in the new version (since 2.1).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.0), MASS, limSolve</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-06-06 15:57:52 UTC; francescobartolucci</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-06-06 17:10:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='MultiLCIRT-package'>Multidimensional Latent Class (LC) Item Response Theory (IRT) Models</h2><span id='topic+MultiLCIRT-package'></span><span id='topic+MultiLCIRT'></span>

<h3>Description</h3>

<p>This package provides a flexible framework for the Item Response Theory (IRT) analysis 
of dichotomous and ordinal polytomous outcomes 
under the assumption of multidimensionality and discreteness of latent traits (abilities). 
Every level of the abilities identify a latent class of subjects. The fitting 
algorithms are based on the Expectation-Maximization (EM) paradigm and 
allow for missing responses and for different item parameterizations. The package also allows for the inclusion
individual covariates affecting the class weights.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MultiLCIRT</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.11</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-05-19</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Function <code>est_multi_poly</code> performs the parameter estimation of the following IRT models,
allowing for one or more latent traits:
</p>
<p>- Binary responses: Rasch model, 2-Parameter Logistic (2PL) model;
</p>
<p>- Ordinal polythomous responses: Samejima's Graded Response Model (GRM) and 
constrained versions with fixed 
discrimination parameters and/or additive decomposition of difficulty parameters (rating scale
parameterization); 
Muraki's Generalized Partial Credit Model and constrained versions with fixed discrimination parameters and/or 
additive decomposition of difficulty parameters, such as Partial Credit Model and Rating Scale Model.
</p>
<p>The basic input arguments for est_multi_poly are the person-item matrix of available response configurations 
and the corresponding frequencies, the number of latent classes, the type of link function, the specification of 
constraints on the discriminating and difficulty item parameters, and the allocation of items to the latent traits. 
Missing responses are coded with NA, and units and items without responses are automatically removed.
</p>
<p>Function <code>test_dim</code> performs a likelihood ratio test to choose the optimal number of latent traits (or 
dimensions) by comparing nested models that differ in the number of latent traits, being all the other
elements let equal (i.e., number of latent classes, type of link function, constraints on item parameters). 
The basic input arguments for <code>test_dim</code> are similar as those for <code>est_multi_poly</code>.
</p>
<p>Function <code>class_item</code> performs a hierarchical clustering of items based on a specified LC IRT model.
The basic input arguments are given by the number of latent classes, the type of model, and the constraints 
on the item parameters (only for polythomous responses). 
An allocation of items to the different latent traits is obtained
depending on the cut-point of the resulting dendrogram.
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)
</p>
<p>Maintainer: Francesco Bartolucci &lt;bart@stat.unipg.it&gt;
</p>


<h3>References</h3>

<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bacci, S., Bartolucci, F. and Gnaldi, M. (2014), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Communication in Statistics - Theory and Methods</em>, <b>43</b>, 787-800.
</p>
<p>Bartolucci, F., Bacci, S. and Gnaldi, M. (2014), MultiLCIRT: An R package for multidimensional latent class item response models, <em>Computational Statistics and Data Analysis</em>, <b>71</b>, 971-985.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Estimation of different Multidimensional LC IRT models with binary
## responses
# Aggregate data
data(naep)
X = as.matrix(naep)
out = aggr_data(X)
S = out$data_dis
yv = out$freq
# Define matrix to allocate each item on one dimension 
multi1 = rbind(c(1,2,9,10),c(3,5,8,11),c(4,6,7,12))
# Three-dimensional LC Rasch model with 4 latent classes
# less severe tolerance level to check convergence (to be modified)
out1 = est_multi_poly(S,yv,k=4,start=0,link=1,multi=multi1,tol=10^-6)
</code></pre>

<hr>
<h2 id='aggr_data'>Aggregate data</h2><span id='topic+aggr_data'></span>

<h3>Description</h3>

<p>Given a matrix of configurations (covariates and responses) unit-by-unit, this
function finds the corresponding matrix of distinct configurations and the corresponding 
vector of frequencies (it does not work properly with missing data).</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggr_data(data, disp=FALSE, fort=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggr_data_+3A_data">data</code></td>
<td>
<p>matrix of covariate and unit-by-unit response configurations</p>
</td></tr>
<tr><td><code id="aggr_data_+3A_disp">disp</code></td>
<td>
<p>to display partial results</p>
</td></tr>
<tr><td><code id="aggr_data_+3A_fort">fort</code></td>
<td>
<p>to use fortran routines when possible</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>data_dis</code></td>
<td>
<p>matrix of distinct configurations</p>
</td></tr>
<tr><td><code>freq</code></td>
<td>
<p>vector of corresponding frequencies</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>the index of each provided response configuration among the distinct ones</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>


<h3>Examples</h3>

<pre><code class='language-R'># draw a matrix of random responses and find distinct responses
X = matrix(sample(5,100,replace=TRUE),50,2)
out = aggr_data(X)

# find the distinct responses and the corresponding vector of frequencies
# for naep data
data(naep)
X = as.matrix(naep)
out = aggr_data(X)
length(out$freq)
</code></pre>

<hr>
<h2 id='class_item'>Hierarchical classification of test items</h2><span id='topic+class_item'></span>

<h3>Description</h3>

<p>It performs a hierarchical classification of a set of test items on the basis of 
the responses provided by a sample of subjects. The classification is based on a
sequence of likelihood ratio tests between pairs of multidimensional models suitably formulated.</p>


<h3>Usage</h3>

<pre><code class='language-R'>class_item(S, yv, k, link = 1, disc = 0, difl = 0, fort = FALSE,
           disp = FALSE, tol = 10^-10)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="class_item_+3A_s">S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use 999 for missing response)</p>
</td></tr>
<tr><td><code id="class_item_+3A_yv">yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td></tr>
<tr><td><code id="class_item_+3A_k">k</code></td>
<td>
<p>number of ability levels (or latent classes)</p>
</td></tr>
<tr><td><code id="class_item_+3A_link">link</code></td>
<td>
<p>type of link function (1 = global logits, 2 = local logits);
with global logits the Graded Response model
results; with local logits the  Partial Credit results (with dichotomous responses, global logits
is the same as using local logits resulting in the Rasch or the 2PL model depending on the value
assigned to disc)</p>
</td></tr>
<tr><td><code id="class_item_+3A_disc">disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (0 = all equal to one, 1 = free)</p>
</td></tr>
<tr><td><code id="class_item_+3A_difl">difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (0 = free, 1 = rating scale parametrization)</p>
</td></tr>
<tr><td><code id="class_item_+3A_fort">fort</code></td>
<td>
<p>to use fortran routines when possible</p>
</td></tr>
<tr><td><code id="class_item_+3A_disp">disp</code></td>
<td>
<p>to display the likelihood evolution step by step</p>
</td></tr>
<tr><td><code id="class_item_+3A_tol">tol</code></td>
<td>
<p>tolerance level for convergence</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>merge</code></td>
<td>
<p>input for the dendrogram represented by the <code>R</code> function <code>plot</code></p>
</td></tr>
<tr><td><code>height</code></td>
<td>
<p>input for the dendrogram represented by the <code>R</code> function <code>plot</code></p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>maximum log-likelihood of the model resulting from each aggregation</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters of the model resulting from each aggregation</p>
</td></tr>
<tr><td><code>lk0</code></td>
<td>
<p>maximum log-likelihood of the latent class model</p>
</td></tr>
<tr><td><code>np0</code></td>
<td>
<p>number of free parameters of the latent class model</p>
</td></tr>
<tr><td><code>groups</code></td>
<td>
<p>list of groups resulting (step-by-step) from the hierarchical clustering</p>
</td></tr>
<tr><td><code>dend</code></td>
<td>
<p>hclust object to represent the histogram</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bacci, S., Bartolucci, F. and Gnaldi, M. (2012), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Technical report</em>, http://arxiv.org/abs/1201.4667.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Model-based hierarchical classification of items from simulated data
# Setup
r = 6  # number of items
n = 1000  # sample size
bev = rep(0,r) 
k = r/2
multi = rbind(1:(r/2),(r/2+1):r)
L = chol(matrix(c(1,0.6,0.6,1),2,2))
data = matrix(0,n,r)
model = 1 
# Create data
Th = matrix(rnorm(2*n),n,2)
for(i in 1:n) for(j in 1:r){
	if(j&lt;=r/2){
    	pc = exp(Th[i,1]-bev[j]); pc = pc/(1+pc)
	}else{
		pc = exp(Th[i,2]-bev[j]); pc = pc/(1+pc)
    }
    data[i,j] = runif(1)&lt;pc
}
# Aggregate data
out = aggr_data(data)
S = out$data_dis
yv = out$freq
# Create dendrogram for items classification, by assuming k=3 latent
# classes and a Rasch parameterization
out = class_item(S,yv,k=3,link=1)
summary(out)
plot(out$dend)

## End(Not run)

## Not run: 
## Model-based hierarchical classification of NAEP items
# Aggregate data
data(naep)
X = as.matrix(naep)
out = aggr_data(X)
S = out$data_dis
yv = out$freq
# Create dendrogram for items classification, by assuming k=4 latent
# classes and a Rasch parameterization
out = class_item(S,yv,k=4,link=1)   
summary(out)
plot(out$dend)

## End(Not run)
</code></pre>

<hr>
<h2 id='compare_models'>Compare different models fitted by est_multi_poly</h2><span id='topic+compare_models'></span>

<h3>Description</h3>

<p>Given different outputs provided by est_multi_poly, the function compare the
different models providing a unified table.</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_models(out1, out2, out3=NULL, out4=NULL, out5=NULL,
               nested=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_models_+3A_out1">out1</code></td>
<td>
<p>output from the 1st fitting</p>
</td></tr>
<tr><td><code id="compare_models_+3A_out2">out2</code></td>
<td>
<p>output from the 2nd fitting</p>
</td></tr>
<tr><td><code id="compare_models_+3A_out3">out3</code></td>
<td>
<p>output from the 3rd fitting</p>
</td></tr>
<tr><td><code id="compare_models_+3A_out4">out4</code></td>
<td>
<p>output from the 4th fitting</p>
</td></tr>
<tr><td><code id="compare_models_+3A_out5">out5</code></td>
<td>
<p>output from the 5th fitting</p>
</td></tr>
<tr><td><code id="compare_models_+3A_nested">nested</code></td>
<td>
<p>to compare each model with the first in terms of LR test</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>table</code></td>
<td>
<p>table summarizing the comparison between the models</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='est_multi_glob'>Fit marginal regression models for categorical responses</h2><span id='topic+est_multi_glob'></span>

<h3>Description</h3>

<p>It estimates marginal regression models to datasets consisting of a categorical response and one or more covariates by a Fisher-scoring algorithm; this is an internal function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_multi_glob(Y, X, model, ind = 1:nrow(Y), be = NULL, Dis = NULL,
               dis = NULL, disp=FALSE, only_sc = FALSE, Int = NULL,
               der_single = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_multi_glob_+3A_y">Y</code></td>
<td>
<p>matrix of response configurations</p>
</td></tr>
<tr><td><code id="est_multi_glob_+3A_x">X</code></td>
<td>
<p>array of all distinct covariate configurations</p>
</td></tr>
<tr><td><code id="est_multi_glob_+3A_model">model</code></td>
<td>
<p>type of logit (g = global, l = local, m = multinomial)</p>
</td></tr>
<tr><td><code id="est_multi_glob_+3A_ind">ind</code></td>
<td>
<p>vector to link responses to covariates</p>
</td></tr>
<tr><td><code id="est_multi_glob_+3A_be">be</code></td>
<td>
<p>initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="est_multi_glob_+3A_dis">Dis</code></td>
<td>
<p>matrix for inequality constraints on be</p>
</td></tr>
<tr><td><code id="est_multi_glob_+3A_dis">dis</code></td>
<td>
<p>vector for inequality constraints on be</p>
</td></tr>
<tr><td><code id="est_multi_glob_+3A_disp">disp</code></td>
<td>
<p>to display partial output</p>
</td></tr>
<tr><td><code id="est_multi_glob_+3A_only_sc">only_sc</code></td>
<td>
<p>to exit giving only the score</p>
</td></tr>
<tr><td><code id="est_multi_glob_+3A_int">Int</code></td>
<td>
<p>matrix of the fixed intercepts</p>
</td></tr>  
<tr><td><code id="est_multi_glob_+3A_der_single">der_single</code></td>
<td>
<p>to require single derivatives</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>be</code></td>
<td>
<p>estimated vector of regression coefficients</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>log-likelihood at convergence</p>
</td></tr>
<tr><td><code>Pdis</code></td>
<td>
<p>matrix of the probabilities for each distinct covariate configuration</p>
</td></tr>  
<tr><td><code>P</code></td>
<td>
<p>matrix of the probabilities for each covariate configuration</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>score</p>
</td></tr>
<tr><td><code>Sc</code></td>
<td>
<p>single derivative (if der_single=TRUE)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Colombi, R. and Forcina, A. (2001), Marginal regression models for the analysis of positive
association of ordinal response variables, <em>Biometrika</em>, <b>88</b>, 1007-1019.
</p>
<p>Glonek, G. F. V. and McCullagh, P. (1995), Multivariate logistic models, <em>Journal of the Royal 
Statistical Society, Series B</em>, <b>57</b>, 533-546.</p>

<hr>
<h2 id='est_multi_poly'>Estimate multidimensional LC IRT model for dichotomous and polytomous responses</h2><span id='topic+est_multi_poly'></span>

<h3>Description</h3>

<p>The function performs maximum likelihood estimation of the parameters of the IRT models
assuming a discrete distribution for the ability. Every ability level corresponds to a latent
class of subjects in the reference population. Maximum likelihood estimation is based on Expectation-
Maximization algorithm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_multi_poly(S, yv = rep(1,ns), k, X = NULL, start = 0, link = 0,
               disc = 0, difl = 0, multi = NULL, piv = NULL,
               Phi = NULL, gac = NULL, De = NULL, fort = FALSE,
               tol = 10^-10, disp = FALSE, output = FALSE,
               out_se = FALSE, glob = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_multi_poly_+3A_s">S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use NA for missing response)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_yv">yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_k">k</code></td>
<td>
<p>number of ability levels (or latent classes)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_x">X</code></td>
<td>
<p>matrix of covariates that affects the weights</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_start">start</code></td>
<td>
<p>method of initialization of the algorithm (0 = deterministic, 1 = random, 2 = arguments given as
input)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_link">link</code></td>
<td>
<p>type of link function (0 = no link function, 1 = global logits, 2 = local logits);
with no link function the Latent Class model results; with global logits the Graded Response model
results; with local logits the  Partial Credit results (with dichotomous responses, global logits
is the same as using local logits resulting in the Rasch or the 2PL model depending on the value
assigned to disc)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_disc">disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (0 = all equal to one, 1 = free)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_difl">difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (0 = free, 1 = rating scale parameterization)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_multi">multi</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row
equal to the indices of the items measuring the dimension corresponding to that row</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_piv">piv</code></td>
<td>
<p>initial value of the vector of weights of the latent classes (if start=2)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_phi">Phi</code></td>
<td>
<p>initial value of the matrix of the conditional response probabilities (if start=2)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_gac">gac</code></td>
<td>
<p>initial value of the complete vector of discriminating indices (if start=2)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_de">De</code></td>
<td>
<p>initial value of regression coefficients for the covariates (if start=2)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_fort">fort</code></td>
<td>
<p>to use fortran routines when possible</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_tol">tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_disp">disp</code></td>
<td>
<p>to display the likelihood evolution step by step</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_output">output</code></td>
<td>
<p>to return additional outputs (Phi,Pp,Piv)</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_out_se">out_se</code></td>
<td>
<p>to return standard errors</p>
</td></tr>
<tr><td><code id="est_multi_poly_+3A_glob">glob</code></td>
<td>
<p>to use global logits in the covariates</p>
</td></tr>  
</table>


<h3>Value</h3>

<table>
<tr><td><code>piv</code></td>
<td>
<p>estimated vector of weights of the latent classes (average of the weights in case of model with covariates)</p>
</td></tr>
<tr><td><code>Th</code></td>
<td>
<p>estimated matrix of ability levels for each dimension and latent class</p>
</td></tr>
<tr><td><code>Bec</code></td>
<td>
<p>estimated vector of difficulty levels for every item (split in two vectors if difl=1)</p>
</td></tr>
<tr><td><code>gac</code></td>
<td>
<p>estimated vector of discriminating indices for every item (with all elements equal to 1
with Rasch parametrization)</p>
</td></tr>
<tr><td><code>fv</code></td>
<td>
<p>vector indicating the reference item chosen for each latent dimension</p>
</td></tr>
<tr><td><code>Phi</code></td>
<td>
<p>array of the conditional response probabilities for every item and latent class</p>
</td></tr>
<tr><td><code>De</code></td>
<td>
<p>matrix of regression coefficients for the multinomial logit model on the class weights</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>matrix of the weights for every response configuration (if output=TRUE)</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>matrix of the posterior probabilities for each response configuration and latent class
(if output=TRUE)</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>log-likelhood at convergence of the EM algorithm</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike Information Criterion index</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian Information Criterion index</p>
</td></tr>
<tr><td><code>ent</code></td>
<td>
<p>Etropy index to measure the separation of classes</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>Vector to trace the log-likelihood evolution across iterations (if output=TRUE)</p>
</td></tr>
<tr><td><code>seDe</code></td>
<td>
<p>Standard errors for De (if output=TRUE)</p>
</td></tr>
<tr><td><code>separ</code></td>
<td>
<p>Standard errors for vector of parameters containing Th and Be (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>sega</code></td>
<td>
<p>Standard errors for vector of discrimination indices (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>Vn</code></td>
<td>
<p>Estimated variance-covariance matrix for all parameter estimates (if output=TRUE)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bacci, S., Bartolucci, F. and Gnaldi, M. (2014), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Communication in Statistics - Theory and Methods</em>, <b>43</b>, 787-800.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Estimation of different Multidimensional LC IRT models with binary
# responses
# Aggregate data
data(naep)
X = as.matrix(naep)
out = aggr_data(X)
S = out$data_dis
yv = out$freq
# Define matrix to allocate each item to one dimension 
multi1 = rbind(c(1,2,9,10),c(3,5,8,11),c(4,6,7,12))
# Three-dimensional Rasch model with 3 latent classes
# the tolerance level has been rise to increase the speed (to be reported
# to a smaller value)
out1 = est_multi_poly(S,yv,k=3,start=0,link=1,multi=multi1,tol=10^-6)
## Not run: 
# Three-dimensional 2PL model with 3 latent classes
out2 = est_multi_poly(S,yv,k=3,start=0,link=1,disc=1,multi=multi1)

## End(Not run)

## Not run: 
## Estimation of different Multidimensional LC IRT models with ordinal
# responses
# Aggregate data
data(hads)
X = as.matrix(hads)
out = aggr_data(X)
S = out$data_dis
yv = out$freq
# Define matrix to allocate each item to one dimension 
multi1 = rbind(c(2,6,7,8,10,11,12),c(1,3,4,5,9,13,14))
# Bidimensional LC Graded Response Model with 3 latent classes 
# (free discriminating and free difficulty parameters)
out1 = est_multi_poly(S,yv,k=3,start=0,link=1,disc=1,multi=multi1)
# Bidimensional LC Partial Credit Model with 3 latent classes 
# (constrained discrimination and free difficulty parameters)
out2 = est_multi_poly(S,yv,k=3,start=0,link=2,multi=multi1)
# Bidimensional LC Rating Scale Model with 3 latent classes 
# (constrained discrimination and constrained difficulty parameters)
out3 = est_multi_poly(S,yv,k=3,start=0,link=2,difl=1,multi=multi1)

## End(Not run)

## Not run: 
## Estimation of LC model with covariates
# gerate covariates
be = c(0,1,-1)
X = matrix(rnorm(2000),1000,2)
u = cbind(1,X)
p = exp(u)/(1+exp(u))
c = 1+(runif(1000)&lt;p)
Y = matrix(0,1000,5)
la = c(0.3,0.7)
for(i in 1:1000) Y[i,] = runif(5)&lt;la[c[i]]
# fit the model with k=2 and k=3 classes
out1 = est_multi_poly(Y,k=2,X=X)
out2 = est_multi_poly(Y,k=3,X=X)
# fit model with k=2 and k=3 classes in fortran
out3 = est_multi_poly(Y,k=2,X=X,fort=TRUE)
out4 = est_multi_poly(Y,k=3,X=X,fort=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='est_multi_poly_clust'>Estimate multidimensional and multilevel LC IRT model for dichotomous and polytomous responses</h2><span id='topic+est_multi_poly_clust'></span>

<h3>Description</h3>

<p>The function performs maximum likelihood estimation of the parameters of the IRT models
assuming a discrete distribution for the ability and a discrete distribution for the latent variable
at cluster level. Every ability level corresponds to a latent
class of subjects in the reference population. Maximum likelihood estimation is based on Expectation-
Maximization algorithm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_multi_poly_clust(S, kU, kV, W = NULL, X = NULL, clust,
                     start = 0, link = 0,  disc = 0, difl = 0,
                     multi = 1:J, piv = NULL, Phi = NULL,
                     gac = NULL, DeU = NULL, DeV = NULL,
                     fort = FALSE, tol = 10^-10, disp = FALSE,
                     output = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_multi_poly_clust_+3A_s">S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use NA for missing response)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_ku">kU</code></td>
<td>
<p>number of support points (or latent classes at cluster level)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_kv">kV</code></td>
<td>
<p>number of ability levels (or latent classes at individual level)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_w">W</code></td>
<td>
<p>matrix of covariates that affects the weights at cluster level</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_x">X</code></td>
<td>
<p>matrix of covariates that affects the weights at individual level</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_clust">clust</code></td>
<td>
<p>vector of cluster indicator for each unit</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_start">start</code></td>
<td>
<p>method of initialization of the algorithm (0 = deterministic, 1 = random, 2 = arguments given as
input)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_link">link</code></td>
<td>
<p>type of link function (0 = no link function, 1 = global logits, 2 = local logits);
with no link function the Latent Class model results; with global logits the Graded Response model
results; with local logits the  Partial Credit results (with dichotomous responses, global logits
is the same as using local logits resulting in the Rasch or the 2PL model depending on the value
assigned to disc)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_disc">disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (0 = all equal to one, 1 = free)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_difl">difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (0 = free, 1 = rating scale parameterization)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_multi">multi</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row
equal to the indices of the items measuring the dimension corresponding to that row</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_piv">piv</code></td>
<td>
<p>initial value of the vector of weights of the latent classes (if start=2)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_phi">Phi</code></td>
<td>
<p>initial value of the matrix of the conditional response probabilities (if start=2)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_gac">gac</code></td>
<td>
<p>initial value of the complete vector of discriminating indices (if start=2)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_deu">DeU</code></td>
<td>
<p>initial value of regression coefficients for the covariates in W (if start=2)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_dev">DeV</code></td>
<td>
<p>initial value of regression coefficients for the covariates in X (if start=2)</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_fort">fort</code></td>
<td>
<p>to use fortran routines when possible</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_tol">tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_disp">disp</code></td>
<td>
<p>to display the likelihood evolution step by step</p>
</td></tr>
<tr><td><code id="est_multi_poly_clust_+3A_output">output</code></td>
<td>
<p>to return additional outputs (Phi,Pp,Piv)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>piv</code></td>
<td>
<p>estimated vector of weights of the latent classes (average of the weights in case of model with covariates)</p>
</td></tr>
<tr><td><code>Th</code></td>
<td>
<p>estimated matrix of ability levels for each dimension and latent class</p>
</td></tr>
<tr><td><code>Bec</code></td>
<td>
<p>estimated vector of difficulty levels for every item (split in two vectors if difl=1)</p>
</td></tr>
<tr><td><code>gac</code></td>
<td>
<p>estimated vector of discriminating indices for every item (with all elements equal to 1
with Rasch parametrization)</p>
</td></tr>
<tr><td><code>fv</code></td>
<td>
<p>vector indicating the reference item chosen for each latent dimension</p>
</td></tr>
<tr><td><code>Phi</code></td>
<td>
<p>array of the conditional response probabilities for every item and latent class</p>
</td></tr>
<tr><td><code>De</code></td>
<td>
<p>matrix of regression coefficients for the multinomial logit model on the class weights</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>matrix of the weights for every response configuration (if output=TRUE)</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>matrix of the posterior probabilities for each response configuration and latent class
(if output=TRUE)</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>log-likelhood at convergence of the EM algorithm</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike Information Criterion index</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian Information Criterion index</p>
</td></tr>
<tr><td><code>ent</code></td>
<td>
<p>Etropy index to measure the separation of classes</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>Vector to trace the log-likelihood evolution across iterations (if output=TRUE)</p>
</td></tr>
<tr><td><code>seDe</code></td>
<td>
<p>Standard errors for De (if output=TRUE)</p>
</td></tr>
<tr><td><code>separ</code></td>
<td>
<p>Standard errors for vector of parameters containing Th and Be (if output=TRUE)</p>
</td></tr>
<tr><td><code>sega</code></td>
<td>
<p>Standard errors for vector of discrimination indices (if output=TRUE)</p>
</td></tr>
<tr><td><code>Vn</code></td>
<td>
<p>Estimated variance-covariance matrix for all parameter estimates (if output=TRUE)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bacci, S., Bartolucci, F. and Gnaldi, M. (2014), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Communication in Statistics - Theory and Methods</em>, <b>43</b>, 787-800.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# generate covariate at cluster level
nclust = 200
W = matrix(round(rnorm(nclust)*2,0)/2,nclust,1)
la = exp(W)/(1+exp(W))
U = 1+1*(runif(nclust)&lt;la)
clust = NULL
for(h in 1:nclust){
	nh = round(runif(1,5,20))
	clust = c(clust,h*rep(1,nh))	
} 
n = length(clust)

# generate covariates
DeV = rbind(c(1.75,1.5),c(-0.25,-1.5),c(-0.5,-1),c(0.5,1))
X = matrix(round(rnorm(2*n)*2,0)/2,n,2)
Piv = cbind(0,cbind(U[clust]==1,U[clust]==2,X)%*%DeV)
Piv = exp(Piv)*(1/rowSums(exp(Piv)))
V = rep(0,n)
for(i in 1:n) V[i] = which(rmultinom(1,1,Piv[i,])==1)

# generate responses
la = c(0.2,0.5,0.8)
Y = matrix(0,n,10)
for(i in 1:n) Y[i,] = runif(10)&lt;la[V[i]]

# fit the model with k1=3 and k2=2 classes
out1 = est_multi_poly_clust(Y,kU=2,kV=3,W=W,X=X,clust=clust)
out2 = est_multi_poly_clust(Y,kU=2,kV=3,W=W,X=X,clust=clust,disp=TRUE,
                            output=TRUE)
out3 = est_multi_poly_clust(Y,kU=2,kV=3,W=W,X=X,clust=clust,disp=TRUE,
                            output=TRUE,start=2,Phi=out2$Phi,gac=out2$gac,
                            DeU=out2$DeU,DeV=out2$DeV)
# Rasch                            
out4 = est_multi_poly_clust(Y,kU=2,kV=3,W=W,X=X,clust=clust,link=1,
                            disp=TRUE,output=TRUE)
out5 = est_multi_poly_clust(Y,kU=2,kV=3,W=W,X=X,clust=clust,link=1,
                            disc=1,disp=TRUE,output=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='hads'>Dataset about measurement of anxiety and depression in oncological patients</h2><span id='topic+hads'></span>

<h3>Description</h3>

<p>This data set contains the responses of 201 oncological patients to 14 ordinal polytomous items that measure
anxiety (7 items) and depression (7 items), according to the Hospital Anxiety and Depression Scale questionnaire.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hads)</code></pre>


<h3>Format</h3>

<p>A data frame with 201 observations on 14 items:
</p>

<dl>
<dt><code>item1</code></dt><dd><p>measure of depression</p>
</dd>
<dt><code>item2</code></dt><dd><p>measure of anxiety</p>
</dd>
<dt><code>item3</code></dt><dd><p>measure of depression</p>
</dd>
<dt><code>item4</code></dt><dd><p>measure of depression</p>
</dd>
<dt><code>item5</code></dt><dd><p>measure of depression</p>
</dd>
<dt><code>item6</code></dt><dd><p>measure of anxiety</p>
</dd>
<dt><code>item7</code></dt><dd><p>measure of anxiety</p>
</dd>
<dt><code>item8</code></dt><dd><p>measure of anxiety</p>
</dd>
<dt><code>item9</code></dt><dd><p>measure of depression</p>
</dd>
<dt><code>item10</code></dt><dd><p>measure of anxiety</p>
</dd>
<dt><code>item11</code></dt><dd><p>measure of anxiety</p>
</dd>
<dt><code>item12</code></dt><dd><p>measure of anxiety</p>
</dd>
<dt><code>item13</code></dt><dd><p>measure of depression</p>
</dd>
<dt><code>item14</code></dt><dd><p>measure of depression</p>
</dd>
</dl>



<h3>Details</h3>

<p>All items have 4 response categories: the minimum value 0 corresponds to a low level of anxiety or depression, 
whereas the maximum value 3 corresponds to a high level of anxiety or depression.</p>


<h3>References</h3>

<p>Zigmond, A. and Snaith, R. (1983), The hospital anxiety and depression scale, <em>Acta Psychiatrika Scandinavica</em>,
<b>67</b>, 361-370.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hads)
## maybe str(hads) 
str(hads)
</code></pre>

<hr>
<h2 id='inv_glob'>Invert marginal logits</h2><span id='topic+inv_glob'></span>

<h3>Description</h3>

<p>Function used within <code>est_multi_glob</code> to invert marginal logits and fit the marginal
regression model; this is an internal function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>inv_glob(eta, type = "g", der = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inv_glob_+3A_eta">eta</code></td>
<td>
<p>vector of logits</p>
</td></tr>
<tr><td><code id="inv_glob_+3A_type">type</code></td>
<td>
<p>type of logit (l = local-logits, g = global-logits)</p>
</td></tr>
<tr><td><code id="inv_glob_+3A_der">der</code></td>
<td>
<p>indicator that the derivative of the canonical parameters with respect to the vector of marginal logits
is required (F = not required, T = required)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>p</code></td>
<td>
<p>vector of probabilities</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>derivative of the canonical parameters with respect to the vector of marginal logits (if der = T)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Colombi, R. and Forcina, A. (2001), Marginal regression models for the analysis of positive association
of ordinal response variables, <em>Biometrika</em>, <b>88</b>, 1007-1019.
</p>
<p>Glonek, G. F. V. and McCullagh, P. (1995), Multivariate logistic models, <em>Journal of the Royal 
Statistical Society, Series B</em>, <b>57</b>, 533-546.</p>

<hr>
<h2 id='lk_obs_score'>Compute observed log-likelihood and score</h2><span id='topic+lk_obs_score'></span>

<h3>Description</h3>

<p>Function used within <code>est_multi_poly</code> to compute observed log-likelihood and score.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lk_obs_score(par_comp, lde, lpar, lga, S, R, yv, k, rm, l, J, fv, link,
	         disc, indga, glob, refitem, miss, ltype, XXdis, Xlabel,
	         ZZ0, fort)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lk_obs_score_+3A_par_comp">par_comp</code></td>
<td>
<p>complete vector of parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_lde">lde</code></td>
<td>
<p>length of de</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_lpar">lpar</code></td>
<td>
<p>length of par</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_lga">lga</code></td>
<td>
<p>length of ga</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_s">S</code></td>
<td>
<p>matrix of responses</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_r">R</code></td>
<td>
<p>matrix of observed responses indicator</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_k">k</code></td>
<td>
<p>number of latent classes</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_rm">rm</code></td>
<td>
<p>number of dimensions</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_l">l</code></td>
<td>
<p>number of respnse categories</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_j">J</code></td>
<td>
<p>number of items</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_fv">fv</code></td>
<td>
<p>indicator of constrained parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_link">link</code></td>
<td>
<p>link function</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_disc">disc</code></td>
<td>
<p>presence of discrimination parameter</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_indga">indga</code></td>
<td>
<p>indicator of gamma parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_glob">glob</code></td>
<td>
<p>indicator of gloabl parametrization for the covariates</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_refitem">refitem</code></td>
<td>
<p>vector of reference items</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_miss">miss</code></td>
<td>
<p>indicator of presence of missing responses</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_ltype">ltype</code></td>
<td>
<p>type of logit</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_xxdis">XXdis</code></td>
<td>
<p>array of covariates</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_xlabel">Xlabel</code></td>
<td>
<p>indicator for covariate configuration</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_zz0">ZZ0</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="lk_obs_score_+3A_fort">fort</code></td>
<td>
<p>to use fortran</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>log-likelihood function</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>score vector</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='lk_obs_score_clust'>Compute observed log-likelihood and score</h2><span id='topic+lk_obs_score_clust'></span>

<h3>Description</h3>

<p>Function used within <code>est_multi_poly</code> to compute observed log-likelihood and score.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lk_obs_score_clust(par_comp, lde1, lde2, lpar, lga, S, R, kU, kV, rm,
                   l, J, fv, link, disc, indga, refitem, miss, ltype,
                   WWdis, Wlabel, XXdis, Xlabel, ZZ0, clust, fort)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lk_obs_score_clust_+3A_par_comp">par_comp</code></td>
<td>
<p>complete vector of parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_lde1">lde1</code></td>
<td>
<p>length of de</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_lde2">lde2</code></td>
<td>
<p>length of de</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_lpar">lpar</code></td>
<td>
<p>length of par</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_lga">lga</code></td>
<td>
<p>length of ga</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_s">S</code></td>
<td>
<p>matrix of responses</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_r">R</code></td>
<td>
<p>matrix of observed responses indicator</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_ku">kU</code></td>
<td>
<p>number of latent classes at cluster level</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_kv">kV</code></td>
<td>
<p>number of latent classes at individual level</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_rm">rm</code></td>
<td>
<p>number of dimensions</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_l">l</code></td>
<td>
<p>number of respnse categories</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_j">J</code></td>
<td>
<p>number of items</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_fv">fv</code></td>
<td>
<p>indicator of constrained parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_link">link</code></td>
<td>
<p>link function</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_disc">disc</code></td>
<td>
<p>presence of discrimination parameter</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_indga">indga</code></td>
<td>
<p>indicator of gamma parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_refitem">refitem</code></td>
<td>
<p>vector of reference items</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_miss">miss</code></td>
<td>
<p>indicator of presence of missing responses</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_ltype">ltype</code></td>
<td>
<p>type of logit</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_wwdis">WWdis</code></td>
<td>
<p>array of covariates at cluster level</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_wlabel">Wlabel</code></td>
<td>
<p>indicator for covariate configuration at cluster level</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_xxdis">XXdis</code></td>
<td>
<p>array of covariates at individual level</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_xlabel">Xlabel</code></td>
<td>
<p>indicator for covariate configuration at individual level</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_zz0">ZZ0</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="lk_obs_score_clust_+3A_clust">clust</code></td>
<td>
<p>vector of cluster indicator for each unit</p>
</td></tr>  
<tr><td><code id="lk_obs_score_clust_+3A_fort">fort</code></td>
<td>
<p>to use fortran</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>log-likelihood function</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>score vector</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='matr_glob'>Matrices to compute generalized logits</h2><span id='topic+matr_glob'></span>

<h3>Description</h3>

<p>It provides the matrices used to compute a vector of generalized logits on the basis of a
vector of probabilities according to the formula <em>Co*log(Ma*p)</em>; this is an internal function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>matr_glob(l, type = "g")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matr_glob_+3A_l">l</code></td>
<td>
<p>number of response categories</p>
</td></tr>
<tr><td><code id="matr_glob_+3A_type">type</code></td>
<td>
<p>type of logit (l = local-logits, g = global-logits)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Co</code></td>
<td>
<p>matrix of contrasts</p>
</td></tr>
<tr><td><code>Ma</code></td>
<td>
<p>marginalization matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Colombi, R. and Forcina, A. (2001), Marginal regression models for the analysis of positive
association of ordinal response variables, <em>Biometrika</em>, <b>88</b>, 1007-1019.
</p>
<p>Glonek, G. F. V. and McCullagh, P. (1995), Multivariate logistic models, <em>Journal of the Royal 
Statistical Society, Series B</em>, <b>57</b>, 533-546.</p>

<hr>
<h2 id='naep'>NAEP dataset</h2><span id='topic+naep'></span>

<h3>Description</h3>

<p>This dataset contains the responses of a sample of 1510 examinees to 12 binary items on Mathematics. It has been
extrapolated from a larger dataset collected in 1996 by the Educational Testing Service within the National Assessment of 
Educational Progress (NAEP) project.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(naep)</code></pre>


<h3>Format</h3>

<p>A data frame with 1510 observations on the following 12 items:
</p>

<dl>
<dt><code>Item1</code></dt><dd><p>round to thousand place</p>
</dd>
<dt><code>Item2</code></dt><dd><p>write fraction that represents shaded region</p>
</dd>
<dt><code>Item3</code></dt><dd><p>multiply two negative integers</p>
</dd>
<dt><code>Item4</code></dt><dd><p>reason about sample space (number correct)</p>
</dd>
<dt><code>Item5</code></dt><dd><p>find amount of restaurant tip</p>
</dd>
<dt><code>Item6</code></dt><dd><p>identify representative sample</p>
</dd>
<dt><code>Item7</code></dt><dd><p>read dials on a meter</p>
</dd>
<dt><code>Item8</code></dt><dd><p>find (x, y) solution of linear equation</p>
</dd>
<dt><code>Item9</code></dt><dd><p>translate words to symbols</p>
</dd>
<dt><code>Item10</code></dt><dd><p>find number of diagonals in polygon from a vertex</p>
</dd>
<dt><code>Item11</code></dt><dd><p>find perimeter (quadrilateral)</p>
</dd>
<dt><code>Item12</code></dt><dd><p>reason about betweenness</p>
</dd>
</dl>



<h3>References</h3>

<p>Bartolucci, F. and Forcina, A. (2005), Likelihood inference on the underlying structure of IRT models. <em>Psychometrika</em>,
<b>70</b>, 31-43. 
</p>
<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering items. 
<em>Psychometrika</em>, <b>72</b>, 141-157.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(naep)
## maybe str(naep)
str(naep)
</code></pre>

<hr>
<h2 id='print.class_item'>Print the output of class_item object</h2><span id='topic+print.class_item'></span>

<h3>Description</h3>

<p>Given the output from class_item, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'class_item'
print(x, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.class_item_+3A_x">x</code></td>
<td>
<p>output from class_item</p>
</td></tr>
<tr><td><code id="print.class_item_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='print.est_multi_poly'>Print the output of est_multi_poly object</h2><span id='topic+print.est_multi_poly'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly'
print(x, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.est_multi_poly_+3A_x">x</code></td>
<td>
<p>output from est_multi_poly</p>
</td></tr>
<tr><td><code id="print.est_multi_poly_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='print.est_multi_poly_clust'>Print the output of est_multi_poly_clust object</h2><span id='topic+print.est_multi_poly_clust'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_clust, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_clust'
print(x, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.est_multi_poly_clust_+3A_x">x</code></td>
<td>
<p>output from est_multi_poly_clust</p>
</td></tr>
<tr><td><code id="print.est_multi_poly_clust_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='print.test_dim'>Print the output of test_dim object</h2><span id='topic+print.test_dim'></span>

<h3>Description</h3>

<p>Given the output from test_dim, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'test_dim'
print(x, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.test_dim_+3A_x">x</code></td>
<td>
<p>output from test_dim</p>
</td></tr>
<tr><td><code id="print.test_dim_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='prob_multi_glob'>Global probabilities</h2><span id='topic+prob_multi_glob'></span>

<h3>Description</h3>

<p>It provides matrix of probabilities under different parametrizations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_multi_glob(X, model, be, ind=(1:dim(X)[3]))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prob_multi_glob_+3A_x">X</code></td>
<td>
<p>array of all distinct covariate configurations</p>
</td></tr>
<tr><td><code id="prob_multi_glob_+3A_model">model</code></td>
<td>
<p>type of logit (g = global, l = local, m = multinomial)</p>
</td></tr>
<tr><td><code id="prob_multi_glob_+3A_be">be</code></td>
<td>
<p>initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="prob_multi_glob_+3A_ind">ind</code></td>
<td>
<p>vector to link responses to covariates</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Pdis</code></td>
<td>
<p>matrix of distinct probability vectors</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>matrix of the probabilities for each covariate configuration</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Colombi, R. and Forcina, A. (2001), Marginal regression models for the analysis of positive
association of ordinal response variables, <em>Biometrika</em>, <b>88</b>, 1007-1019.
</p>
<p>Glonek, G. F. V. and McCullagh, P. (1995), Multivariate logistic models, <em>Journal of the Royal 
Statistical Society, Series B</em>, <b>57</b>, 533-546.</p>

<hr>
<h2 id='search.model'>Search for the global maximum of the log-likelihood</h2><span id='topic+search.model'></span>

<h3>Description</h3>

<p>It search for the global maximum of the log-likelihood given a vector of possible number
of classes to try for.</p>


<h3>Usage</h3>

<pre><code class='language-R'>search.model(S, yv = rep(1,ns), kv, X = NULL, link = 0, disc = 0,
             difl = 0, multi = 1:J, fort = FALSE, tol = 10^-10,
             nrep = 2, glob = FALSE, disp=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="search.model_+3A_s">S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use 999 for missing response)</p>
</td></tr>
<tr><td><code id="search.model_+3A_yv">yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td></tr>
<tr><td><code id="search.model_+3A_kv">kv</code></td>
<td>
<p>vector of the possible numbers of latent classes</p>
</td></tr>
<tr><td><code id="search.model_+3A_x">X</code></td>
<td>
<p>matrix of covariates that affects the weights</p>
</td></tr>
<tr><td><code id="search.model_+3A_link">link</code></td>
<td>
<p>type of link function (1 = global logits, 2 = local logits);
with global logits the Graded Response model
results; with local logits the  Partial Credit results (with dichotomous responses, global logits
is the same as using local logits resulting in the Rasch or the 2PL model depending on the value
assigned to disc)</p>
</td></tr>
<tr><td><code id="search.model_+3A_disc">disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (0 = all equal to one, 1 = free)</p>
</td></tr>
<tr><td><code id="search.model_+3A_difl">difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (0 = free, 1 = rating scale parametrization)</p>
</td></tr>
<tr><td><code id="search.model_+3A_multi">multi</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row
equal to the indices of the items measuring the dimension corresponding to that row</p>
</td></tr>
<tr><td><code id="search.model_+3A_fort">fort</code></td>
<td>
<p>to use fortran routines when possible</p>
</td></tr>
<tr><td><code id="search.model_+3A_tol">tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods</p>
</td></tr>
<tr><td><code id="search.model_+3A_nrep">nrep</code></td>
<td>
<p>number of repetitions of each random initialization</p>
</td></tr>
<tr><td><code id="search.model_+3A_glob">glob</code></td>
<td>
<p>to use global logits in the covariates</p>
</td></tr>
<tr><td><code id="search.model_+3A_disp">disp</code></td>
<td>
<p>to dispaly partial output</p>
</td></tr>  	         
</table>


<h3>Value</h3>

<table>
<tr><td><code>out.single</code></td>
<td>
<p>output of each single model (as from est_multi_poly) for each k in kv</p>
</td></tr>
<tr><td><code>bicv</code></td>
<td>
<p>value of BIC index for each k in kv</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>value of log-likelihood for each k in kv</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bacci, S., Bartolucci, F. and Gnaldi, M. (2012), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Technical report</em>, http://arxiv.org/abs/1201.4667.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Search Multidimensional LC IRT models for binary responses
# Aggregate data
data(naep)
X = as.matrix(naep)
out = aggr_data(X)
S = out$data_dis
yv = out$freq
# Define matrix to allocate each item on one dimension 
multi1 = rbind(c(1,2,9,10),c(3,5,8,11),c(4,6,7,12))
out2 = search.model(S, yv = yv, kv=c(1:4),multi=multi1)

## End(Not run)
</code></pre>

<hr>
<h2 id='standard.matrix'>Standardization of a matrix of support points on the basis of a vector of probabilities</h2><span id='topic+standard.matrix'></span>

<h3>Description</h3>

<p>Given a matrix of support points X and a corresponding vector of probabilities piv
it computes the mean for each dimension, the variance covariance matrix, the correlation matrix, 
Spearman correlation matrix, and the standarized matrix Y</p>


<h3>Usage</h3>

<pre><code class='language-R'>standard.matrix(X,piv)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="standard.matrix_+3A_x">X</code></td>
<td>
<p>matrix of support points for the distribution included row by row</p>
</td></tr>
<tr><td><code id="standard.matrix_+3A_piv">piv</code></td>
<td>
<p>vector of probabilities with the same number of elements as the rows of <code>X</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>mu</code></td>
<td>
<p>vector of the means</p>
</td></tr>
<tr><td><code>V</code></td>
<td>
<p>variance-covariance matrix</p>
</td></tr>
<tr><td><code>si2</code></td>
<td>
<p>vector of the variances</p>
</td></tr>
<tr><td><code>si</code></td>
<td>
<p>vector of standard deviations</p>
</td></tr>
<tr><td><code>Cor</code></td>
<td>
<p>Braives-Pearson correlation matrix</p>
</td></tr>
<tr><td><code>Sper</code></td>
<td>
<p>Spearman correlation matrix</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>matrix of standardized support points</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example of standardization of a randomly generated distribution
X = matrix(rnorm(100),20,5)
piv = runif(20); piv = piv/sum(piv)
out = standard.matrix(X,piv)
</code></pre>

<hr>
<h2 id='summary.class_item'>Print the output of class_item object</h2><span id='topic+summary.class_item'></span>

<h3>Description</h3>

<p>Given the output from class_item, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'class_item'
summary(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.class_item_+3A_object">object</code></td>
<td>
<p>output from class_item</p>
</td></tr>
<tr><td><code id="summary.class_item_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>table</code></td>
<td>
<p>summary of all the results</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='summary.est_multi_poly'>Print the output of test_dim object</h2><span id='topic+summary.est_multi_poly'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly'
summary(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.est_multi_poly_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly</p>
</td></tr>
<tr><td><code id="summary.est_multi_poly_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='summary.est_multi_poly_clust'>Print the output of est_multi_poly_clust object</h2><span id='topic+summary.est_multi_poly_clust'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_clust, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_clust'
summary(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.est_multi_poly_clust_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_clust</p>
</td></tr>
<tr><td><code id="summary.est_multi_poly_clust_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='summary.test_dim'>Print the output of test_dim object</h2><span id='topic+summary.test_dim'></span>

<h3>Description</h3>

<p>Given the output from test_dim, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'test_dim'
summary(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.test_dim_+3A_object">object</code></td>
<td>
<p>output from test_dim</p>
</td></tr>
<tr><td><code id="summary.test_dim_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>table</code></td>
<td>
<p>summary of all the results</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='test_dim'>Likelihood ratio testing between nested multidimensional LC IRT models</h2><span id='topic+test_dim'></span>

<h3>Description</h3>

<p>The function tests a certain multidimensional model (restricted model) 
against a larger multidimensional model based on a higher number of dimensions. A
typical example is testing a unidimensional model (and then the hypothesis of unidimensionality)
against a bidimensional model. Both models are estimated by <code>est_multi_poly</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_dim(S, yv, k, link = 1, disc = 0, difl = 0, multi0 = 1:J,
         multi1, tol = 10^-10, disp = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_dim_+3A_s">S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use 999 for missing response)</p>
</td></tr>
<tr><td><code id="test_dim_+3A_yv">yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td></tr>
<tr><td><code id="test_dim_+3A_k">k</code></td>
<td>
<p>number of ability levels (or latent classes)</p>
</td></tr>
<tr><td><code id="test_dim_+3A_link">link</code></td>
<td>
<p>type of link function (1 = global logits, 2 = local logits);
with global logits the Graded Response model
results; with local logits the  Partial Credit results (with dichotomous responses, global logits
is the same as using local logits resulting in the Rasch or the 2PL model depending on the value
assigned to disc)</p>
</td></tr>  <tr><td><code id="test_dim_+3A_disc">disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices 
(0 = all equal to one, 1 = free)</p>
</td></tr>
<tr><td><code id="test_dim_+3A_difl">difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (0 = free, 1 = rating scale parametrization)</p>
</td></tr>
<tr><td><code id="test_dim_+3A_multi0">multi0</code></td>
<td>
<p>matrix specifying the multidimensional structure of the restricted model</p>
</td></tr>
<tr><td><code id="test_dim_+3A_multi1">multi1</code></td>
<td>
<p>matrix specifying the multidimensional structure of the larger model</p>
</td></tr>
<tr><td><code id="test_dim_+3A_tol">tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods</p>
</td></tr>
<tr><td><code id="test_dim_+3A_disp">disp</code></td>
<td>
<p>to display intermediate output</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out0</code></td>
<td>
<p>output for the restricted model obtained from <code>est_multi_poly</code></p>
</td></tr>
<tr><td><code>out1</code></td>
<td>
<p>output for the larger model obtained from <code>est_multi_poly</code></p>
</td></tr>
<tr><td><code>dev</code></td>
<td>
<p>likelihood ratio statistic</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>number of degrees of freedom of the test</p>
</td></tr>
<tr><td><code>pv</code></td>
<td>
<p><em>p</em>-value for the test</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>command used to call the function</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci, Michela Gnaldi - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bacci, S., Bartolucci, F. and Gnaldi, M. (2012), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Technical report</em>, http://arxiv.org/abs/1201.4667.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Computation of the LR statistic testing unidimensionality on HADS data
# Aggregate data
data(hads)
X = as.matrix(hads)
out = aggr_data(X)
S = out$data_dis
yv = out$freq
# Define matrix to allocate each item on one dimension 
multi1 = rbind(c(2,6,7,8,10,11,12),c(1,3,4,5,9,13,14))
# Compare unidimensional vs bidimensional Graded Response models with free
# discrimination and free difficulty parameters
# with less severe tollerance level (to be increased)
out = test_dim(S,yv,k=3,link=1,disc=1,multi1=multi1,tol=5*10^-4)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
