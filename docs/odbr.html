<!DOCTYPE html><html lang="en-US"><head><title>Help for package odbr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {odbr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dictSP'><p>Sao Paulo OD Survey Dictionary</p></a></li>
<li><a href='#download_piggyback'><p>Download file from odbr using piggyback</p></a></li>
<li><a href='#metadata'><p>Metadata for the package</p></a></li>
<li><a href='#read_dictionary'><p>Download data dictionary from OD surveys databases</p></a></li>
<li><a href='#read_map'><p>Download spatial data from OD Surveys databases</p></a></li>
<li><a href='#read_od'><p>Download microdata from OD Surveys databases</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Download Data from Brazil's Origin Destination Surveys</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Download data from Brazil's Origin Destination Surveys. The package covers both data from household travel surveys, dictionaries of variables, and the spatial geometries of surveys conducted in different years and across various urban areas in Brazil. For some cities, the package will include enhanced versions of the data sets with variables "harmonized" across different years.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, data.table, fs, haven, piggyback, R.utils, sf</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, spelling, testthat (&ge; 3.2.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://hsvab.github.io/odbr/">https://hsvab.github.io/odbr/</a>, <a href="https://github.com/hsvab/odbr">https://github.com/hsvab/odbr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hsvab/odbr/issues">https://github.com/hsvab/odbr/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-13 12:22:23 UTC; hsvab</td>
</tr>
<tr>
<td>Author:</td>
<td>Haydee Svab [aut, cre],
  Beatriz Milz <a href="https://orcid.org/0000-0002-3064-4486"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Diego Rabatone Oliveira [aut],
  Rafael H. M. Pereira
    <a href="https://orcid.org/0000-0003-2125-7465"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Haydee Svab &lt;hsvab@hsvab.eng.br&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-14 14:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='dictSP'>Sao Paulo OD Survey Dictionary</h2><span id='topic+dictSP'></span><span id='topic+od_sao_paulo_1977_not_harmonized_dictionary_en'></span><span id='topic+od_sao_paulo_1977_not_harmonized_dictionary_es'></span><span id='topic+od_sao_paulo_1977_not_harmonized_dictionary_pt'></span><span id='topic+od_sao_paulo_1987_not_harmonized_dictionary_en'></span><span id='topic+od_sao_paulo_1987_not_harmonized_dictionary_es'></span><span id='topic+od_sao_paulo_1987_not_harmonized_dictionary_pt'></span><span id='topic+od_sao_paulo_1997_not_harmonized_dictionary_en'></span><span id='topic+od_sao_paulo_1997_not_harmonized_dictionary_es'></span><span id='topic+od_sao_paulo_1997_not_harmonized_dictionary_pt'></span><span id='topic+od_sao_paulo_2007_not_harmonized_dictionary_en'></span><span id='topic+od_sao_paulo_2007_not_harmonized_dictionary_es'></span><span id='topic+od_sao_paulo_2007_not_harmonized_dictionary_pt'></span><span id='topic+od_sao_paulo_2017_not_harmonized_dictionary_en'></span><span id='topic+od_sao_paulo_2017_not_harmonized_dictionary_es'></span><span id='topic+od_sao_paulo_2017_not_harmonized_dictionary_pt'></span>

<h3>Description</h3>

<p>These datasets contain the dictionary for the OD surveys in Sao Paulo.
Each row describes one column of the survey data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>od_sao_paulo_1977_not_harmonized_dictionary_en

od_sao_paulo_1977_not_harmonized_dictionary_es

od_sao_paulo_1977_not_harmonized_dictionary_pt

od_sao_paulo_1987_not_harmonized_dictionary_en

od_sao_paulo_1987_not_harmonized_dictionary_es

od_sao_paulo_1987_not_harmonized_dictionary_pt

od_sao_paulo_1997_not_harmonized_dictionary_en

od_sao_paulo_1997_not_harmonized_dictionary_es

od_sao_paulo_1997_not_harmonized_dictionary_pt

od_sao_paulo_2007_not_harmonized_dictionary_en

od_sao_paulo_2007_not_harmonized_dictionary_es

od_sao_paulo_2007_not_harmonized_dictionary_pt

od_sao_paulo_2017_not_harmonized_dictionary_en

od_sao_paulo_2017_not_harmonized_dictionary_es

od_sao_paulo_2017_not_harmonized_dictionary_pt
</code></pre>


<h3>Format</h3>

<p>A data frame with 4 columns:
</p>

<dl>
<dt>variable_name</dt><dd><p>Name of the variable</p>
</dd>
<dt>description</dt><dd><p>Description of the variable</p>
</dd>
<dt>categories</dt><dd><p>Examples of the categories in the variable</p>
</dd>
<dt>class</dt><dd><p>Class of the variable</p>
</dd>
</dl>

<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 76 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 76 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 93 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 93 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 93 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 110 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 76 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 110 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 124 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 76 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 124 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 128 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 76 rows and 4 columns.
</p>
<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 128 rows and 4 columns.
</p>


<h3>Source</h3>

<p><a href="https://transparencia.metrosp.com.br/dataset/pesquisa-origem-e-destino">https://transparencia.metrosp.com.br/dataset/pesquisa-origem-e-destino</a>
</p>

<hr>
<h2 id='download_piggyback'>Download file from odbr using piggyback</h2><span id='topic+download_piggyback'></span>

<h3>Description</h3>

<p>Download file from odbr using piggyback
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_piggyback(filename_to_download)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_piggyback_+3A_filename_to_download">filename_to_download</code></td>
<td>
<p>String. The name of the file to be downloaded.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string with the path to the file saved in a tempdir
</p>

<hr>
<h2 id='metadata'>Metadata for the package</h2><span id='topic+metadata'></span>

<h3>Description</h3>

<p>This dataset has the list of OD surveys available
in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metadata
</code></pre>


<h3>Format</h3>



<h4><code>metadata</code></h4>

<p>A data frame with 4 columns:
</p>

<dl>
<dt>city</dt><dd><p>City name</p>
</dd>
<dt>year</dt><dd><p>Year of the survey</p>
</dd>
<dt>harmonized</dt><dd><p>A logical value showing whether the dataset was harmonized</p>
</dd>
<dt>language</dt><dd><p>Language of the dictionary</p>
</dd>
</dl>



<hr>
<h2 id='read_dictionary'>Download data dictionary from OD surveys databases</h2><span id='topic+read_dictionary'></span>

<h3>Description</h3>

<p>Return the data dictionary of a specific Origin
Destination Survey, if available. This dictionary is intended to be used to
understand the data downloaded using the <code>odbr::read_od</code> function. It will
contain the list of variables and, for each variable, a simple description,
the available categories and its class (factor, numeric, etc).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_dictionary(
  city = "São Paulo",
  year = 2017,
  harmonize = FALSE,
  language = "pt"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_dictionary_+3A_city">city</code></td>
<td>
<p>Character. City of reference. Defaults to &quot;São Paulo&quot;.</p>
</td></tr>
<tr><td><code id="read_dictionary_+3A_year">year</code></td>
<td>
<p>Numeric. Year of reference in the format <code>yyyy</code>. Defaults to
<code>1977</code>.</p>
</td></tr>
<tr><td><code id="read_dictionary_+3A_harmonize">harmonize</code></td>
<td>
<p>Logical. When <code>FALSE</code> (Default), the function returns the raw
data. If <code>TRUE</code>, the function returns harmonized data to the same
city, across all the years.</p>
</td></tr>
<tr><td><code id="read_dictionary_+3A_language">language</code></td>
<td>
<p>Character. The language of data dictionary to be opened.
Options include <code>c("pt", "en", "es")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>"data.frame"</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(odbr)

# return data dictionary from OD Surveys, as data.frame, at a given city and year
df &lt;- read_dictionary(
  city = "Sao Paulo",
  year = 2017,
  harmonize = FALSE,
  language = "pt"
)

</code></pre>

<hr>
<h2 id='read_map'>Download spatial data from OD Surveys databases</h2><span id='topic+read_map'></span>

<h3>Description</h3>

<p><code>read_map()</code> download the geodetic data for a specific Origin Destination survey
and return it as an sf dataframe. It uses the cached data file if it was
previously downloaded to avoid extra networking consumption. To understand
the returned dataframe format, please reefer to the <code>read_dictionary()</code>
function for the same survey cohort.
It is also necessary to specify the geometry granularity wanted, be it
&quot;municipality&quot;, &quot;district&quot; or &quot;zone&quot; level of details. Of course, not all
geometries are available for all surveys.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_map(city = "São Paulo", year = 2017, harmonize = FALSE, geometry = "zone")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_map_+3A_city">city</code></td>
<td>
<p>Character. City of reference. Defaults to &quot;São Paulo&quot;.</p>
</td></tr>
<tr><td><code id="read_map_+3A_year">year</code></td>
<td>
<p>Numeric. Year of reference in the format <code>yyyy</code>. Defaults to
<code>1977</code>.</p>
</td></tr>
<tr><td><code id="read_map_+3A_harmonize">harmonize</code></td>
<td>
<p>Logical. When <code>FALSE</code> (Default), the function returns the raw
data. If <code>TRUE</code>, the function returns harmonized data to the same
city, across all the years.</p>
</td></tr>
<tr><td><code id="read_map_+3A_geometry">geometry</code></td>
<td>
<p>Character. The type of spatial data to be opened. Options
include <code>c("zone","district", "municipality")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code style="white-space: pre;">&#8288;"sf" "data.frame"&#8288;</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(odbr)

# return zone data from OD Surveys database as sf object at a given city and year
df &lt;- read_map(
  city = "Sao Paulo",
  year = 2017,
  harmonize = FALSE,
  geometry = "zone"
)

#' # return district data from OD Surveys database as sf object at a given city and year
df &lt;- read_map(
  city = "Sao Paulo",
  year = 2017,
  harmonize = FALSE,
  geometry = "district"
)

# return municipality data from OD Surveys database as sf object at a given city and year
df &lt;- read_map(
  city = "Sao Paulo",
  year = 2017,
  harmonize = FALSE,
  geometry = "municipality"
)

</code></pre>

<hr>
<h2 id='read_od'>Download microdata from OD Surveys databases</h2><span id='topic+read_od'></span>

<h3>Description</h3>

<p><code>read_od()</code> download the data for a specific Origin Destination survey and
return it as a dataframe. It uses the cached data file if it was previously
downloaded to avoid extra networking consumption. To understand the returned
dataframe format, please reefer to the <code>read_dictionary()</code> function for the
same survey cohort.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_od(city = "São Paulo", year = 2017, harmonize = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_od_+3A_city">city</code></td>
<td>
<p>Character. City of reference. Defaults to &quot;São Paulo&quot;.</p>
</td></tr>
<tr><td><code id="read_od_+3A_year">year</code></td>
<td>
<p>Numeric. Year of reference in the format <code>yyyy</code>. Defaults to
<code>1977</code>.</p>
</td></tr>
<tr><td><code id="read_od_+3A_harmonize">harmonize</code></td>
<td>
<p>Logical. When <code>FALSE</code> (Default), the function returns the raw
data. If <code>TRUE</code>, the function returns harmonized data to the same
city, across all the years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>"data.frame"</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(odbr)

# return data from OD Surveys database as data.frame
df &lt;- read_od(
  city = "Sao Paulo",
  year = 2017,
  harmonize = FALSE
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
