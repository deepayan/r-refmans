<!DOCTYPE html><html lang="en"><head><title>Help for package ELISAtools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ELISAtools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ELISAtools-package'><p>ELISA data analysis with batch correction</p></a></li>
<li><a href='#annotate.plate'><p>S3 method to annotate ELISA plate</p></a></li>
<li><a href='#avoidZero'><p>Get rid of zeros in a numeric vector</p></a></li>
<li><a href='#combineData'><p>Combine elisa_batch data</p></a></li>
<li><a href='#elisa_batch'><p>Constructor function to build an elisa_batch object</p></a></li>
<li><a href='#elisa_batch-class'><p>S4 class definition of an elisa_batch object</p></a></li>
<li><a href='#elisa_plate'><p>Constructor function to build an elisa_plate object</p></a></li>
<li><a href='#elisa_plate-class'><p>S4 class definition of an elisa_plate object</p></a></li>
<li><a href='#elisa_run'><p>Constructor function to build an elisa_run object</p></a></li>
<li><a href='#elisa_run-class'><p>S4 class definition of an elisa_run object</p></a></li>
<li><a href='#f5pl'><p>The five-parameter logistic function</p></a></li>
<li><a href='#inv.f5pl'><p>The inverse of the 5-parameter logistic function</p></a></li>
<li><a href='#load.ODs'><p>Function to load OD data</p></a></li>
<li><a href='#loadData'><p>Read data according to the design file</p></a></li>
<li><a href='#loadDB'><p>Read the saved elisa_batch data</p></a></li>
<li><a href='#plotAlignData'><p>Plot all batch data together</p></a></li>
<li><a href='#plotBatchData'><p>Plot ELISA data for one batch</p></a></li>
<li><a href='#predictAll'><p>Predict the concentration of samples based on fitting</p></a></li>
<li><a href='#prepareInitsLM'><p>Prepare initial values for fitting shifts</p></a></li>
<li><a href='#prepareRegInput'><p>Prepare the input for regressoin</p></a></li>
<li><a href='#rangeOD'><p>Get the OD ranges (min/max)</p></a></li>
<li><a href='#read.annotation'><p>Read the annotation of single ELISA plate</p></a></li>
<li><a href='#read.annotations'><p>Read the annotations of plates</p></a></li>
<li><a href='#read.plate'><p>Read the single ELISA OD plate</p></a></li>
<li><a href='#read.plates'><p>Read the ELISA OD files</p></a></li>
<li><a href='#reportHtml'><p>Report ELISA data in HTML format.</p></a></li>
<li><a href='#runFit'><p>Fit 5- or 4-parameter logistic function</p></a></li>
<li><a href='#saveDataText'><p>Save elisa_batch analysis results</p></a></li>
<li><a href='#saveDB'><p>Save the elisa_batch data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>ELISA Data Analysis with Batch Correction</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.5</td>
</tr>
<tr>
<td>Description:</td>
<td>To run data analysis for enzyme-link immunosorbent assays (ELISAs). 
	Either the five- or four-parameter logistic model will be fitted for data of single ELISA. 
	Moreover, the batch effect correction/normalization will be carried out, when there are more than one batches of ELISAs. 
	Feng (2018) &lt;<a href="https://doi.org/10.1101%2F483800">doi:10.1101/483800</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), R2HTML (&ge; 2.3.2), stringi (&ge; 1.1.7),
minpack.lm (&ge; 1.2-1), methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0.9000</td>
</tr>
<tr>
<td>Collate:</td>
<td>'BatchCorrection.R' 'ELISAplate.R' 'ELISAtools_IO.R'
'ELISAtools.R' 'Regression.R'</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-21 03:19:27 UTC; feng</td>
</tr>
<tr>
<td>Author:</td>
<td>Feng Feng [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Feng Feng &lt;ffeng@BU.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-21 15:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ELISAtools-package'>ELISA data analysis with batch correction</h2><span id='topic+ELISAtools'></span><span id='topic+ELISAtools-package'></span>

<h3>Description</h3>

<p>An R package to run ELISA data analysis 
with the ability to do batch correction/normalization
</p>


<h3>Details</h3>

<p>This package is developed to run analysis of ELISA data. 
First, the calibration data are used to fit either the five- or
four-parameter logistic model. Then the fitted model is
used to predict the concentrations of unknown samples.
If the batches of calibration data exist, 
the correction/normalization could be done. The corrected
calibration curve are then used for predication.
</p>
<p>Please refer to the vignettes to see details.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Feng Feng <a href="mailto:ffeng@BU.edu">ffeng@BU.edu</a>
</p>


<h3>References</h3>

<p>Feng, et al 2018 doi: <a href="https://doi.org/10.1101/483800">10.1101/483800</a>
</p>

<hr>
<h2 id='annotate.plate'>S3 method to annotate ELISA plate</h2><span id='topic+annotate.plate'></span>

<h3>Description</h3>

<p>to write annotations for an ELISA plate as
an input to guide the functions to read OD values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annotate.plate(
  sample.id,
  sample.prefix,
  sample.suffix,
  num.sample,
  num.std = 8,
  byRow.sample = TRUE,
  byRow.replicates = TRUE,
  replicates.sample = 3,
  replicates.std = 3,
  rows,
  columns,
  std.first = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="annotate.plate_+3A_sample.id">sample.id</code></td>
<td>
<p>character vector to specify the names/ids of
the samples on the plate. Note, standard/calibration sample
ids/names is fixed to be &quot;s1&quot;,&quot;s2&quot;, etc, which are specified
by the software and users don't need to privide.</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_sample.prefix">sample.prefix</code></td>
<td>
<p>characters will be added to the beginning of sample names</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_sample.suffix">sample.suffix</code></td>
<td>
<p>characters will be added to the end of sample names</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_num.sample">num.sample</code></td>
<td>
<p>numeric number of samples to write</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_num.std">num.std</code></td>
<td>
<p>numeric number of standards</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_byrow.sample">byRow.sample</code></td>
<td>
<p>boolean indicate whether to write sample names 
horizontally by row (TURE) or vertically by column (FALSE)</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_byrow.replicates">byRow.replicates</code></td>
<td>
<p>boolean indicate whether to write sample replicates 
horizontally by row (TURE) or vertically by column (FALSE)</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_replicates.sample">replicates.sample</code></td>
<td>
<p>numeric number of replicates for each sample</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_replicates.std">replicates.std</code></td>
<td>
<p>numeric number of replicates for each standards</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_rows">rows</code></td>
<td>
<p>numeric vector to specify which rows to be included in the annotation</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_columns">columns</code></td>
<td>
<p>numeric vector to specify which columns 
to be included in the annotation</p>
</td></tr>
<tr><td><code id="annotate.plate_+3A_std.first">std.first</code></td>
<td>
<p>boolean to indicate whether to write standards first or
the samples first.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the input to quickly write the annotations
for ELISA plate. The output is in a 96-well format and 
will be used to giude the reading of OD plates. This way
only a nxm dataframe can be used. To write non-regular
annotation, you have to do it mannually.
</p>


<h3>Value</h3>

<p>a dataframe holding the annotations for the plate.
</p>

<hr>
<h2 id='avoidZero'>Get rid of zeros in a numeric vector</h2><span id='topic+avoidZero'></span>

<h3>Description</h3>

<p>Get rid of zeros in a numeric vector before taking 
the logarithm of them. We basically replace the &quot;zeros&quot; with a negligible small 
value in order to avoid NaN upon the log-transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>avoidZero(x, fac = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="avoidZero_+3A_x">x</code></td>
<td>
<p>numeric values as input</p>
</td></tr>
<tr><td><code id="avoidZero_+3A_fac">fac</code></td>
<td>
<p>numeric a factor of scale in order to get a &quot;small&quot; value to 
replace zeros</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of value with zeros replaced.
</p>

<hr>
<h2 id='combineData'>Combine elisa_batch data</h2><span id='topic+combineData'></span>

<h3>Description</h3>

<p>Combine the two lists of elisa_batch data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combineData(eb1, eb2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combineData_+3A_eb1">eb1</code></td>
<td>
<p>list of elisa_batch data</p>
</td></tr>
<tr><td><code id="combineData_+3A_eb2">eb2</code></td>
<td>
<p>list of elisa_batch data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When combining, we not only concatenate the two data sets, 
but also combine batches, meaning the two 
batches with same batch ID will be merged into one. 
We will not merge the runs. Therefore, same batch from different
list will always have different runs. It is the user's 
responsibility to make sure the runs are different.
</p>


<h3>Value</h3>

<p>a list of elisa_batch data combining the two input lists (sorted);
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code> <code><a href="#topic+loadData">loadData</a></code> <code><a href="#topic+saveDB">saveDB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#R code to run 5-parameter logistic regression on ELISA data
#load the library
library(ELISAtools)

#get file folder
dir_file&lt;-system.file("extdata", package="ELISAtools")

batches&lt;-loadData(file.path(dir_file,"design.txt"))

#make a guess for the parameters, the other two parameters a and d 
#will be estimated based on data.
model&lt;-"5pl"
pars&lt;-c(7.2,0.5, 0.015) #5pl inits
names(pars)&lt;-c("xmid", "scal", "g")

#do fitting. model will be written into data set.
batches&lt;-runFit(pars=pars,  batches=batches, refBatch.ID=1, model=model  )

#call to do predications based on the model.
batches&lt;-predictAll(batches);

batches.old&lt;-batches;

#now suppose want to join/combine the two batches, old and new 
batches.com&lt;-combineData(batches.old, batches);

</code></pre>

<hr>
<h2 id='elisa_batch'>Constructor function to build an elisa_batch object</h2><span id='topic+elisa_batch'></span>

<h3>Description</h3>

<p>S3 method as a constructor to build the S4 
class object of elisa_batch <code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elisa_batch(
  batchID = NA_character_,
  desc = NA_character_,
  runs = list(),
  model.fit = list(),
  model.name = NA_character_,
  pars = c(-1),
  num.runs = 1,
  range.ODs = c(-1, -1),
  normFactor = NaN
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elisa_batch_+3A_batchid">batchID</code></td>
<td>
<p>character string to specify a batches</p>
</td></tr>
<tr><td><code id="elisa_batch_+3A_desc">desc</code></td>
<td>
<p>character string for the data/experiment information</p>
</td></tr>
<tr><td><code id="elisa_batch_+3A_runs">runs</code></td>
<td>
<p>list of elisa_plates in this run. There could be one or many plates in a run.</p>
</td></tr>
<tr><td><code id="elisa_batch_+3A_model.fit">model.fit</code></td>
<td>
<p>list intend to contain information for the 
fitting of nls.lm. But not using it now.</p>
</td></tr>
<tr><td><code id="elisa_batch_+3A_model.name">model.name</code></td>
<td>
<p>character string of either the 5pl (5-parameter) or 4pl 
(4-parameter) logistic function</p>
</td></tr>
<tr><td><code id="elisa_batch_+3A_pars">pars</code></td>
<td>
<p>numeric the actually parameters for the fitting.
for example for the 5pl model they are c(a, d,xmid, scal, g).</p>
</td></tr>
<tr><td><code id="elisa_batch_+3A_num.runs">num.runs</code></td>
<td>
<p>numeric the number of plates in this run.</p>
</td></tr>
<tr><td><code id="elisa_batch_+3A_range.ods">range.ODs</code></td>
<td>
<p>numeric the min and max ODs</p>
</td></tr>
<tr><td><code id="elisa_batch_+3A_normfactor">normFactor</code></td>
<td>
<p>numeric the batch effect normalization factor (&quot;S&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method as a constructor to build the S4 
class object of elisa_batch <code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code>. 
Normally this is called to build a empty object 
with default values and then load the elisa_run data into it
</p>


<h3>Value</h3>

<p>an elisa_batch object
</p>


<h3>See Also</h3>

<p><code><a href="minpack.lm.html#topic+nls.lm">nls.lm</a></code> <code><a href="#topic+elisa_run-class">elisa_run-class</a></code> <code><a href="#topic+elisa_plate-class">elisa_plate-class</a></code> 
<code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elisa_batch();
</code></pre>

<hr>
<h2 id='elisa_batch-class'>S4 class definition of an elisa_batch object</h2><span id='topic+elisa_batch-class'></span>

<h3>Description</h3>

<p><code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code> define the S4 class of an elisa_batch object
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elisa_batch-class_+3A_batchid">batchID</code></td>
<td>
<p>characters to specify the batch</p>
</td></tr>
<tr><td><code id="elisa_batch-class_+3A_runs">runs</code></td>
<td>
<p>list of elisa_run objects</p>
</td></tr>
<tr><td><code id="elisa_batch-class_+3A_num.runs">num.runs</code></td>
<td>
<p>numeric the number of elisa_runs in this batch</p>
</td></tr>
<tr><td><code id="elisa_batch-class_+3A_pars">pars</code></td>
<td>
<p>numeric the actually parameters for the fitting.
for example for the 5pl they are c(a, d,xmid, scal, g).</p>
</td></tr>
<tr><td><code id="elisa_batch-class_+3A_model.fit">model.fit</code></td>
<td>
<p>list intend to contain information for the 
fitting of nls.lm. But not using it now.</p>
</td></tr>
<tr><td><code id="elisa_batch-class_+3A_model.name">model.name</code></td>
<td>
<p>characters of either the 5pl (5-parameter) or 4pl 
(4-parameter) logistic function</p>
</td></tr>
<tr><td><code id="elisa_batch-class_+3A_range.ods">range.ODs</code></td>
<td>
<p>numeric the min and max ODs</p>
</td></tr>
<tr><td><code id="elisa_batch-class_+3A_normfactor">normFactor</code></td>
<td>
<p>numeric the batch normalization factor (&quot;S&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>defining the S4 class of the elisa_batch.
This holds the data for elisa batch. 
It contains one or many elisa_run objects.
</p>


<h3>Slots</h3>


<dl>
<dt><code>batchID</code></dt><dd><p>character</p>
</dd>
<dt><code>desc</code></dt><dd><p>character</p>
</dd>
<dt><code>runs</code></dt><dd><p>list</p>
</dd>
<dt><code>num.runs</code></dt><dd><p>numeric</p>
</dd>
<dt><code>pars</code></dt><dd><p>numeric</p>
</dd>
<dt><code>model.fit</code></dt><dd><p>list</p>
</dd>
<dt><code>model.name</code></dt><dd><p>character</p>
</dd>
<dt><code>range.ODs</code></dt><dd><p>numeic</p>
</dd>
<dt><code>normFactor</code></dt><dd><p>numeric</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="minpack.lm.html#topic+nls.lm">nls.lm</a></code> <code><a href="#topic+elisa_plate-class">elisa_plate-class</a></code> <code><a href="#topic+elisa_run-class">elisa_run-class</a></code> 
<code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elisa_batch();
</code></pre>

<hr>
<h2 id='elisa_plate'>Constructor function to build an elisa_plate object</h2><span id='topic+elisa_plate'></span>

<h3>Description</h3>

<p>S3 method as a constructor to build the S4 
class object of the elisa_plate <code><a href="#topic+elisa_plate">elisa_plate</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elisa_plate(
  batchID = NA_character_,
  expID = NA_character_,
  desc = NA_character_,
  data.std = data.frame(),
  mdata.std = data.frame(),
  data.unknown = data.frame(),
  mdata.unknown = data.frame(),
  normFactor = NaN,
  range.ODs = c(-1, -1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elisa_plate_+3A_batchid">batchID</code></td>
<td>
<p>characters to specify the batch</p>
</td></tr>
<tr><td><code id="elisa_plate_+3A_expid">expID</code></td>
<td>
<p>characters to specify experiment or plate ID</p>
</td></tr>
<tr><td><code id="elisa_plate_+3A_desc">desc</code></td>
<td>
<p>characters for the data/experiment information</p>
</td></tr>
<tr><td><code id="elisa_plate_+3A_data.std">data.std</code></td>
<td>
<p>data.frame for standard curve data</p>
</td></tr>
<tr><td><code id="elisa_plate_+3A_mdata.std">mdata.std</code></td>
<td>
<p>data.frame containing the mean ODs and concentration of the calibration data</p>
</td></tr>
<tr><td><code id="elisa_plate_+3A_data.unknown">data.unknown</code></td>
<td>
<p>data.frame for data of samples with unknown concentration
fitted with either four- or five-parameter logistic function.</p>
</td></tr>
<tr><td><code id="elisa_plate_+3A_mdata.unknown">mdata.unknown</code></td>
<td>
<p>data.frame containing the mean ODs and concentration by sample IDs.</p>
</td></tr>
<tr><td><code id="elisa_plate_+3A_normfactor">normFactor</code></td>
<td>
<p>numeric the correction factor for batch effects.</p>
</td></tr>
<tr><td><code id="elisa_plate_+3A_range.ods">range.ODs</code></td>
<td>
<p>numeric the min and max ODs in the plate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method as a constructor to build the S4 
class object of elisa_plate <code><a href="#topic+elisa_plate">elisa_plate</a></code>. 
Normally this is called to build an empty object 
with default values and then load data into it
by calling loadData <code><a href="#topic+loadData">loadData</a></code> or load.ODs 
<code><a href="#topic+load.ODs">load.ODs</a></code>
</p>


<h3>Value</h3>

<p>an elisa_plate object
</p>


<h3>See Also</h3>

<p><code><a href="minpack.lm.html#topic+nls.lm">nls.lm</a></code> <code><a href="#topic+loadData">loadData</a></code> <code><a href="#topic+elisa_plate">elisa_plate</a></code> 
<code><a href="#topic+load.ODs">load.ODs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elisa_plate();
</code></pre>

<hr>
<h2 id='elisa_plate-class'>S4 class definition of an elisa_plate object</h2><span id='topic+elisa_plate-class'></span>

<h3>Description</h3>

<p><code><a href="#topic+elisa_plate">elisa_plate</a></code> define the S4 class of an elisa_plate object
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elisa_plate-class_+3A_batchid">batchID</code></td>
<td>
<p>characters to specify the batch</p>
</td></tr>
<tr><td><code id="elisa_plate-class_+3A_expid">expID</code></td>
<td>
<p>characters to specify experiment or plate ID</p>
</td></tr>
<tr><td><code id="elisa_plate-class_+3A_desc">desc</code></td>
<td>
<p>characters for the data/experiment information</p>
</td></tr>
<tr><td><code id="elisa_plate-class_+3A_data.std">data.std</code></td>
<td>
<p>data.frame for standard curve data</p>
</td></tr>
<tr><td><code id="elisa_plate-class_+3A_data.unknown">data.unknown</code></td>
<td>
<p>data.frame containing data for samples with unknown concentration</p>
</td></tr>
<tr><td><code id="elisa_plate-class_+3A_normfactor">normFactor</code></td>
<td>
<p>numeric the correction factor for batch effects (&quot;S&quot;).</p>
</td></tr>
<tr><td><code id="elisa_plate-class_+3A_mdata.unknown">mdata.unknown</code></td>
<td>
<p>data.frame containing the mean ODs and concentration by sample IDs.</p>
</td></tr>
<tr><td><code id="elisa_plate-class_+3A_mdata.std">mdata.std</code></td>
<td>
<p>data.frame containing the mean ODs and concentrations for standard data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>defining the S4 class of the elisa_plate object.
This is the data structure to hold the elisa_plate Data. 
It contains different slots for holding both standard and 
unknown data. It also defines 
the regression model and the correction parameter 
for the batch effects.<br />  
Note: we assume each plate has its own standard curve.
</p>


<h3>Slots</h3>


<dl>
<dt><code>batchID</code></dt><dd><p>character</p>
</dd>
<dt><code>expID</code></dt><dd><p>character</p>
</dd>
<dt><code>data.std</code></dt><dd><p>data.frame</p>
</dd>
<dt><code>data.unknown</code></dt><dd><p>data.frame</p>
</dd>
<dt><code>normFactor</code></dt><dd><p>numeric</p>
</dd>
<dt><code>desc</code></dt><dd><p>character</p>
</dd>
<dt><code>range.ODs</code></dt><dd><p>numeric</p>
</dd>
<dt><code>mdata.unknown</code></dt><dd><p>data.frame</p>
</dd>
<dt><code>mdata.std</code></dt><dd><p>data.frame</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="minpack.lm.html#topic+nls.lm">nls.lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elisa_plate();
</code></pre>

<hr>
<h2 id='elisa_run'>Constructor function to build an elisa_run object</h2><span id='topic+elisa_run'></span>

<h3>Description</h3>

<p>S3 method as a constructor to build the S4 
class object of elisa_run <code><a href="#topic+elisa_run-class">elisa_run-class</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elisa_run(
  batchID = NA_character_,
  desc = NA_character_,
  plates = list(),
  num.plates = 1,
  date = NA_character_,
  range.ODs = c(-1, -1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elisa_run_+3A_batchid">batchID</code></td>
<td>
<p>characters to specify the batch</p>
</td></tr>
<tr><td><code id="elisa_run_+3A_desc">desc</code></td>
<td>
<p>characters for data/experiment information</p>
</td></tr>
<tr><td><code id="elisa_run_+3A_plates">plates</code></td>
<td>
<p>list of elisa_plates in this run. could be one or many</p>
</td></tr>
<tr><td><code id="elisa_run_+3A_num.plates">num.plates</code></td>
<td>
<p>numeric the number of plates in this run.</p>
</td></tr>
<tr><td><code id="elisa_run_+3A_date">date</code></td>
<td>
<p>charaters the date to run ELISA measurements</p>
</td></tr>
<tr><td><code id="elisa_run_+3A_range.ods">range.ODs</code></td>
<td>
<p>numeric the range of ODs for the measurements</p>
</td></tr>
</table>


<h3>Details</h3>

<p>S3 method as a constructor to build the S4 
class object of elisa_run <code><a href="#topic+elisa_run-class">elisa_run-class</a></code>. 
Normally this is called to build a empty object 
with default values and then load the elisa_run data into.
#
</p>


<h3>Value</h3>

<p>an elisa_run object
</p>


<h3>See Also</h3>

<p><code><a href="minpack.lm.html#topic+nls.lm">nls.lm</a></code> <code><a href="#topic+elisa_run-class">elisa_run-class</a></code> <code><a href="#topic+elisa_plate-class">elisa_plate-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elisa_run();
</code></pre>

<hr>
<h2 id='elisa_run-class'>S4 class definition of an elisa_run object</h2><span id='topic+elisa_run-class'></span>

<h3>Description</h3>

<p><code><a href="#topic+elisa_run-class">elisa_run-class</a></code> defines the S4 class of elisa_run
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elisa_run-class_+3A_batchid">batchID</code></td>
<td>
<p>characters to specify the batch</p>
</td></tr>
<tr><td><code id="elisa_run-class_+3A_desc">desc</code></td>
<td>
<p>characters for the data/experiment information</p>
</td></tr>
<tr><td><code id="elisa_run-class_+3A_plates">plates</code></td>
<td>
<p>list of elisa_plates</p>
</td></tr>
<tr><td><code id="elisa_run-class_+3A_num.plates">num.plates</code></td>
<td>
<p>numeric the number of plates in this run</p>
</td></tr>
<tr><td><code id="elisa_run-class_+3A_date">date</code></td>
<td>
<p>characters for the date of running the ELISA measurements</p>
</td></tr>
</table>


<h3>Details</h3>

<p>defining the S4 class of the elisa_run object.
This is list to hold the data for each elisa run. 
It contains one or many elisa plate objects.
</p>


<h3>Slots</h3>


<dl>
<dt><code>batchID</code></dt><dd><p>character</p>
</dd>
<dt><code>plates</code></dt><dd><p>list</p>
</dd>
<dt><code>desc</code></dt><dd><p>character</p>
</dd>
<dt><code>num.plates</code></dt><dd><p>numeric</p>
</dd>
<dt><code>date</code></dt><dd><p>character</p>
</dd>
<dt><code>range.ODs</code></dt><dd><p>numeric</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="minpack.lm.html#topic+nls.lm">nls.lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>elisa_run();
</code></pre>

<hr>
<h2 id='f5pl'>The five-parameter logistic function</h2><span id='topic+f5pl'></span>

<h3>Description</h3>

<p>read in the paramters and the independent variable value(s), and then return the 
5pl function value(s). For the 4pl model, set g to be 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f5pl(pars, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="f5pl_+3A_pars">pars</code></td>
<td>
<p>numeric the parameters of the 5pl (or 4pl). It has the following content: [a, d, xmid, scal, g].</p>
</td></tr>
<tr><td><code id="f5pl_+3A_x">x</code></td>
<td>
<p>numeric the log-transformed x value(s).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function has the following form <br />
f(x)=a+(d-a)/((1+exp((xmid-x)/scal))^g)
</p>


<h3>Value</h3>

<p>the 5pl function value(s).
</p>

<hr>
<h2 id='inv.f5pl'>The inverse of the 5-parameter logistic function</h2><span id='topic+inv.f5pl'></span>

<h3>Description</h3>

<p>The inverse function of the 5pl. Set the value of g to be 1, if the 4pl
is of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inv.f5pl(pars, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inv.f5pl_+3A_pars">pars</code></td>
<td>
<p>the parameters of the function. It has the following content: [a, d, xmid, scale, g].</p>
</td></tr>
<tr><td><code id="inv.f5pl_+3A_y">y</code></td>
<td>
<p>the value to be reverse calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the value of the reverse function
</p>

<hr>
<h2 id='load.ODs'>Function to load OD data</h2><span id='topic+load.ODs'></span><span id='topic+load.ODs+2Celisa_plate-method'></span>

<h3>Description</h3>

<p>Generic function to load OD data into an elisa_plate 
object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.ODs(x, plate.header, plate.data, plate.blank, annotation, ....)

## S4 method for signature 'elisa_plate'
load.ODs(x, plate.header, plate.data, plate.blank, annotation)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load.ODs_+3A_x">x</code></td>
<td>
<p>the elisa_plate object to load data into</p>
</td></tr>
<tr><td><code id="load.ODs_+3A_plate.header">plate.header</code></td>
<td>
<p>characters</p>
</td></tr>
<tr><td><code id="load.ODs_+3A_plate.data">plate.data</code></td>
<td>
<p>data.frame OD readings</p>
</td></tr>
<tr><td><code id="load.ODs_+3A_plate.blank">plate.blank</code></td>
<td>
<p>data.frame OD blank readings</p>
</td></tr>
<tr><td><code id="load.ODs_+3A_annotation">annotation</code></td>
<td>
<p>data.frame annotation to guide reading.</p>
</td></tr>
<tr><td><code id="load.ODs_+3A_....">....</code></td>
<td>
<p>other parameters that will help reading data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It loads OD data into an elisa_plate object. The data
usually read int from design file, annotation file, OD file and 
standard concentration data.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>elisa_plate</code>: to load ODs to an elisa_plate object
</p>
</li></ul>

<hr>
<h2 id='loadData'>Read data according to the design file</h2><span id='topic+loadData'></span>

<h3>Description</h3>

<p>Read the design file and then load the 
data according to the information in the design file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadData(design.file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadData_+3A_design.file">design.file</code></td>
<td>
<p>characters to specify the path and the file name of the design file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The design file contains all the information necessary
to read data. It has the following format<br />
</p>

<table>
<tr>
 <td style="text-align: left;">
ExpID</td><td style="text-align: left;">	FileName</td><td style="text-align: left;">	Batch</td><td style="text-align: left;">	Num_Plate</td><td style="text-align: left;">	Date</td><td style="text-align: left;">	AnnotationFile</td><td style="text-align: left;">	Std_Conc</td><td style="text-align: left;">	Dir_Annotation</td><td style="text-align: left;">	Dir_StdConc</td>
</tr>
<tr>
 <td style="text-align: left;">
Exp1</td><td style="text-align: left;">	file1.txt</td><td style="text-align: left;">	Batch1</td><td style="text-align: left;">	1</td><td style="text-align: left;">	9/18/2009</td><td style="text-align: left;">	annote.txt</td><td style="text-align: left;">	stdConc.txt</td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">		
Exp2</td><td style="text-align: left;">	file2.txt</td><td style="text-align: left;">	Batch2</td><td style="text-align: left;">	2</td><td style="text-align: left;">	9/18/2009</td><td style="text-align: left;">	annote.txt</td><td style="text-align: left;">	stdConc.txt</td><td style="text-align: left;"> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">		
</td>
</tr>

</table>

<p>The return data is a list of batches (<code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code>), 
which are made of one or many elisa runs(<code><a href="#topic+elisa_run-class">elisa_run-class</a></code>) 
. The
run could contain one or many elisa plates (<code><a href="#topic+elisa_plate-class">elisa_plate-class</a></code>)
with data or annotation of each plate.<br />
</p>

<table>
<tr>
 <td style="text-align: left;">
list</td><td style="text-align: left;">	|</td><td style="text-align: left;">	 </td><td style="text-align: left;">	 </td><td style="text-align: left;">	 </td><td style="text-align: left;">	 </td><td style="text-align: left;">	 </td>
</tr>
<tr>
 <td style="text-align: left;">
 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	--batch1</td><td style="text-align: left;">	|</td><td style="text-align: left;">	</td><td style="text-align: left;">	</td><td style="text-align: left;">	</td>
</tr>
<tr>
 <td style="text-align: left;">		
 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	--run1</td><td style="text-align: left;">	|</td><td style="text-align: left;">	</td>
</tr>
<tr>
 <td style="text-align: left;">		
 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	--plate1</td>
</tr>
<tr>
 <td style="text-align: left;">
 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	--plate2</td>
</tr>
<tr>
 <td style="text-align: left;">
 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	--batch2</td><td style="text-align: left;">	|</td><td style="text-align: left;">	</td><td style="text-align: left;">	</td><td style="text-align: left;">	</td>
</tr>
<tr>
 <td style="text-align: left;">
 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	 </td><td style="text-align: left;">	|</td><td style="text-align: left;">	</td><td style="text-align: left;">	</td><td style="text-align: left;">	</td>
</tr>
<tr>
 <td style="text-align: left;">				
</td>
</tr>

</table>



<h3>Value</h3>

<p>a list of batches holding different runs of elisa, which could contain
one or many elisa_plates with data and annotations for 
each plate.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code> <code><a href="#topic+elisa_plate-class">elisa_plate-class</a></code> <code><a href="#topic+elisa_run-class">elisa_run-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file.dir&lt;-system.file("extdata", package="ELISAtools")
loadData(file.path(file.dir,"design.txt"));
</code></pre>

<hr>
<h2 id='loadDB'>Read the saved elisa_batch data</h2><span id='topic+loadDB'></span>

<h3>Description</h3>

<p>Load the serialized elisa_batch data from disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadDB(db)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadDB_+3A_db">db</code></td>
<td>
<p>characters to specify the path and file name the elisa data file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Here we deserialize elisa_batch data by wrapping the readRds()
function call.
The serialized elisa_batch data are assumed to have been correctly 
analyzed. We will print a summary for what has been read.
</p>


<h3>Value</h3>

<p>a list of batches holding different runs of elisa, which could contain
one or many elisa_plates with data and annotations for 
each plate.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code> <code><a href="#topic+loadData">loadData</a></code> <code><a href="#topic+saveDB">saveDB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#R code to run 5-parameter logistic regression on ELISA data
#load the library
library(ELISAtools)

#get file folder
dir_file&lt;-system.file("extdata", package="ELISAtools")

batches&lt;-loadData(file.path(dir_file,"design.txt"))

#make a guess for the parameters, the other two parameters a and d 
#will be estimated based on data.
model&lt;-"5pl"
pars&lt;-c(7.2,0.5, 0.015) #5pl inits
names(pars)&lt;-c("xmid", "scal", "g")


#do fitting. model will be written into data set.
batches&lt;-runFit(pars=pars,  batches=batches, refBatch.ID=1, model=model  )

#now call to do predications based on the model.
batches&lt;-predictAll(batches);

#now saving the data.
saveDB(batches, file.path(tempdir(),"elisa_tool1.rds"));

loadDB(file.path(tempdir(),"elisa_tool1.rds"));
</code></pre>

<hr>
<h2 id='plotAlignData'>Plot all batch data together</h2><span id='topic+plotAlignData'></span>

<h3>Description</h3>

<p>Plot the batch data together for visualization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAlignData(batches, graph.file = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotAlignData_+3A_batches">batches</code></td>
<td>
<p>list of batch data objects either raw or analyzed data.</p>
</td></tr>
<tr><td><code id="plotAlignData_+3A_graph.file">graph.file</code></td>
<td>
<p>characters as the output graph file name. If specified, a 
SVG (*.svg) graph will be saved to the disk. Otherwise, the graph 
will be send to the stdout.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the data has been analysed, a fitted line will be drawn too. If
there are more than one batches, each batch will be plotted with different color
and different synmbols. Different batches will also be shifted/adjusted based on their
&quot;S&quot; factor, and one single fitted line (based on the &quot;reference&quot; batch) will be plotted.
</p>


<h3>Value</h3>

<p>characters which specify the graph file name, if graph.file is specified. NULL
otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load the library
library(ELISAtools)

#get file folder
dir_file&lt;-system.file("extdata", package="ELISAtools")

#load the data
batches&lt;-loadData(file.path(dir_file,"design.txt"))

#plot the raw batch data together
plotAlignData(batches);


</code></pre>

<hr>
<h2 id='plotBatchData'>Plot ELISA data for one batch</h2><span id='topic+plotBatchData'></span>

<h3>Description</h3>

<p>Plot the individual batch data for visualization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBatchData(batch, graph.file = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotBatchData_+3A_batch">batch</code></td>
<td>
<p>batch data objects with either raw or analyzed data.</p>
</td></tr>
<tr><td><code id="plotBatchData_+3A_graph.file">graph.file</code></td>
<td>
<p>characters as the output graph file name. If specified, a 
SVG (*.svg) graph will be saved to the disk. Otherwise, the graph 
will be send to the stdout.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the data has been analysed, a fitted line will be drawn too.
</p>


<h3>Value</h3>

<p>characters which is the graph file name, if graph.file is specified. NULL
otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#load the library
library(ELISAtools)

#get file folder
dir_file&lt;-system.file("extdata", package="ELISAtools")

#load the data
batches&lt;-loadData(file.path(dir_file,"design.txt"))

#plot the raw batch 1 data
plotBatchData(batches[[1]]);


</code></pre>

<hr>
<h2 id='predictAll'>Predict the concentration of samples based on fitting</h2><span id='topic+predictAll'></span>

<h3>Description</h3>

<p>Based on the 5pl or 4pl regression, predict the concentration of 
of unknown samples. Assume the regression has been accomplished.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictAll(batches)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predictAll_+3A_batches">batches</code></td>
<td>
<p>list of elisa_batch objects containing 
both the raw data and the fitted regression model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input data structure contains both the data (ODs) and
the fitted regression model. The estimation of unknonw concentration
based on the ODs and the standard curve of each plate.  
The batch effects are corrected/normalized and the corrected
concentrations also are	also written into the batch data
structure, if there are more than one batches in the data.
</p>


<h3>Value</h3>

<p>The same list of elisa_batch with estimated
sample concentrations based on ODs and the fitted regression
model. The estimated concentrations normalized/corrected
between different batches are also calculated and recorded.
</p>


<h3>References</h3>

<p>Feng 2018 doi: <a href="https://doi.org/10.1101/483800">10.1101/483800</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elisa_batch">elisa_batch</a></code> <code><a href="#topic+elisa_run">elisa_run</a></code>
<code><a href="#topic+elisa_plate">elisa_plate</a></code>
</p>

<hr>
<h2 id='prepareInitsLM'>Prepare initial values for fitting shifts</h2><span id='topic+prepareInitsLM'></span>

<h3>Description</h3>

<p>Generate the initial values for fitting shifts with 
a model of the 5-parameter logistic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepareInitsLM(batches, ref.batch = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepareInitsLM_+3A_batches">batches</code></td>
<td>
<p>list of elisa_batch data</p>
</td></tr>
<tr><td><code id="prepareInitsLM_+3A_ref.batch">ref.batch</code></td>
<td>
<p>numeric the index of the reference batch. It is 1
by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a more complicated way to prepare the initials for shifting.
</p>


<h3>Value</h3>

<p>a data list contain the following elements,
</p>

<ul>
<li> <p>inits, the initial values for the standard curves of all the plates<br />
</p>
</li>
<li> <p>ref.ibatch, the index of the reference batch<br />

This one is specified by the input ref.batch.

</p>
</li>
<li> <p>ref.irun,the index of the reference run<br />
</p>
</li>
<li> <p>ref.index,the index of the reference line in the order
of the inits vector<br />
</p>
</li></ul>


<hr>
<h2 id='prepareRegInput'>Prepare the input for regressoin</h2><span id='topic+prepareRegInput'></span>

<h3>Description</h3>

<p>Prepare the input data to feed in the fitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepareRegInput(batches)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepareRegInput_+3A_batches">batches</code></td>
<td>
<p>list of the ELISA data arranged in 
batches. Each element of list contains a batch (list)
data, and each batch contains one or many the elisa_run 
objects <code><a href="#topic+elisa_plate">elisa_plate</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of data that will feed in to do regression.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elisa_plate">elisa_plate</a></code> <code><a href="#topic+elisa_batch">elisa_batch</a></code><code><a href="#topic+elisa_run">elisa_run</a></code>
</p>

<hr>
<h2 id='rangeOD'>Get the OD ranges (min/max)</h2><span id='topic+rangeOD'></span>

<h3>Description</h3>

<p>Going through the list of  batches to get the OD range (min and max)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rangeOD(batches)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rangeOD_+3A_batches">batches</code></td>
<td>
<p>list of batches data</p>
</td></tr>
</table>

<hr>
<h2 id='read.annotation'>Read the annotation of single ELISA plate</h2><span id='topic+read.annotation'></span>

<h3>Description</h3>

<p>Parse the annotations for one single ELISA plate from
a section of a file and output the annotations for standard and unknown
separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.annotation(annotation, std.conc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.annotation_+3A_annotation">annotation</code></td>
<td>
<p>characters to specify the path and name of the annotation file</p>
</td></tr>
<tr><td><code id="read.annotation_+3A_std.conc">std.conc</code></td>
<td>
<p>data.frame containing standard concentration data. 
Only first two columns are used with first one to be the standard IDs
and second the concentrations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The annotation file may contain annotations for more than
one plate. Each plate is marked by &quot;Plate: plate 1...&quot; and 
&quot;~End&quot;. This function is fed in with the content for each section
and we do actually parsing in here. Store the annotations into 
data frame. It also parse the standard concentration and 
include this information in the data frame.
For each section,we expect
the following format<br />
</p>

<table>
<tr>
 <td style="text-align: left;">
   </td><td style="text-align: left;">	1</td><td style="text-align: left;">	2</td><td style="text-align: left;">		3</td><td style="text-align: left;">		4</td><td style="text-align: left;"> 			...</td>
</tr>
<tr>
 <td style="text-align: left;">	
  C</td><td style="text-align: left;">	s1</td><td style="text-align: left;">	s1</td><td style="text-align: left;">		sample1</td><td style="text-align: left;">		sample1</td><td style="text-align: left;">	...</td>
</tr>
<tr>
 <td style="text-align: left;">
  D</td><td style="text-align: left;">	s2</td><td style="text-align: left;">	s2</td><td style="text-align: left;">		sample2</td><td style="text-align: left;">		sample</td><td style="text-align: left;">  ...</td>
</tr>
<tr>
 <td style="text-align: left;">	
...</td><td style="text-align: left;">	...</td><td style="text-align: left;">	...</td><td style="text-align: left;">		...</td><td style="text-align: left;">		...</td><td style="text-align: left;">		...</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>In addition, the row name and column names indicate the
the plate row and column indices.
As input, the stardard and unknown are returned separately in two 
tables.
</p>


<h3>Value</h3>

<p>a list of data.frames holding the annotations for the plate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#get example annotation file path from the system folder
fileName&lt;-system.file("extdata", "annote_single.txt", package="ELISAtools")
#prepare the standard concentration file.
std.conc&lt;-data.frame(id=c("s1","s2","s3","s4","s5","s6"), conc=c(1:6))
#read the data as a data frame.
ann&lt;-read.table(fileName, header=TRUE,  sep="\t", stringsAsFactors=FALSE)

#call to do the reading.
</code></pre>

<hr>
<h2 id='read.annotations'>Read the annotations of plates</h2><span id='topic+read.annotations'></span>

<h3>Description</h3>

<p>Parse annotations for multiple ELISA plates from
files, one annotation file and one standard concentration file,
and output the annotations for standard and unknown
separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.annotations(
  annotation,
  std.conc,
  dir.annotation,
  dir.stdConc,
  num.plate = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.annotations_+3A_annotation">annotation</code></td>
<td>
<p>characters to specify the path and name of the annotation file</p>
</td></tr>
<tr><td><code id="read.annotations_+3A_std.conc">std.conc</code></td>
<td>
<p>characters to specify the standard concentration file.</p>
</td></tr>
<tr><td><code id="read.annotations_+3A_dir.annotation">dir.annotation</code></td>
<td>
<p>characters specifying the file to the annotatoin file.</p>
</td></tr>
<tr><td><code id="read.annotations_+3A_dir.stdconc">dir.stdConc</code></td>
<td>
<p>characters specifying the path to the annotatoin file.</p>
</td></tr>
<tr><td><code id="read.annotations_+3A_num.plate">num.plate</code></td>
<td>
<p>numeric indicating the number of plates in the annotation
files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The annotation file may contain annotations for more than
one plate. Each plate is marked by &quot;Plate: plate 1...&quot; and 
&quot;~End&quot;. This function parses each section in both annotation
file and standard concentration file. Then passes the section
on to do the parsing.
For each section,we expect
the following format<br />
</p>

<table>
<tr>
 <td style="text-align: left;">
   </td><td style="text-align: left;">	1</td><td style="text-align: left;">	2</td><td style="text-align: left;">		3</td><td style="text-align: left;">		4</td><td style="text-align: left;"> 			...</td>
</tr>
<tr>
 <td style="text-align: left;">	
  C</td><td style="text-align: left;">	s1</td><td style="text-align: left;">	s1</td><td style="text-align: left;">		sample1</td><td style="text-align: left;">		sample1</td><td style="text-align: left;">	...</td>
</tr>
<tr>
 <td style="text-align: left;">
  D</td><td style="text-align: left;">	s2</td><td style="text-align: left;">	s2</td><td style="text-align: left;">		sample2</td><td style="text-align: left;">		sample</td><td style="text-align: left;">  ...</td>
</tr>
<tr>
 <td style="text-align: left;">	
...</td><td style="text-align: left;">	...</td><td style="text-align: left;">	...</td><td style="text-align: left;">		...</td><td style="text-align: left;">		...</td><td style="text-align: left;">		...</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>a list of annotations for elisa plates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#get example annotation file path from the system folder
ann&lt;-system.file("extdata", "annote.txt", package="ELISAtools")
std.conc&lt;-system.file("extdata", "stdConc.txt", package="ELISAtools")

#read them in and there are 2 plates.
read.annotations(annotation=ann,  std.conc=std.conc, num.plate=2)
</code></pre>

<hr>
<h2 id='read.plate'>Read the single ELISA OD plate</h2><span id='topic+read.plate'></span>

<h3>Description</h3>

<p>Read the individual ELISA plate to parse the ODs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.plate(ODs, annotation, batchID, expID)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.plate_+3A_ods">ODs</code></td>
<td>
<p>characters containing data of ODs for one plate</p>
</td></tr>
<tr><td><code id="read.plate_+3A_annotation">annotation</code></td>
<td>
<p>list of data containing annotations of the plate</p>
</td></tr>
<tr><td><code id="read.plate_+3A_batchid">batchID</code></td>
<td>
<p>characters specifying the batchID read from the design file</p>
</td></tr>
<tr><td><code id="read.plate_+3A_expid">expID</code></td>
<td>
<p>characters specifying the expID or plateID read from the design file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input is a text file imported from the sdf file.  
We only read the first section with both the OD and blank file.
The OD data are read in according to the annotation file.
</p>


<h3>Value</h3>

<p>an object of elisa_plate holding data and annotations for 
a single plate.
</p>

<hr>
<h2 id='read.plates'>Read the ELISA OD files</h2><span id='topic+read.plates'></span>

<h3>Description</h3>

<p>Read the ELISA OD file to parse the ODs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.plates(
  fileName,
  annotations,
  num.plate = 1,
  batchID,
  expID,
  date = NA_character_
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.plates_+3A_filename">fileName</code></td>
<td>
<p>characters containing file name of OD data</p>
</td></tr>
<tr><td><code id="read.plates_+3A_annotations">annotations</code></td>
<td>
<p>list of data containing annotations of the plates</p>
</td></tr>
<tr><td><code id="read.plates_+3A_num.plate">num.plate</code></td>
<td>
<p>numeric number of OD plates in the OD file.</p>
</td></tr>
<tr><td><code id="read.plates_+3A_batchid">batchID</code></td>
<td>
<p>characters specify the batchID read from the design file</p>
</td></tr>
<tr><td><code id="read.plates_+3A_expid">expID</code></td>
<td>
<p>characters specify the expID or plateID read from the design file</p>
</td></tr>
<tr><td><code id="read.plates_+3A_date">date</code></td>
<td>
<p>characters the date running the ELISA exps.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input is a text file imported from the sdf file.  
The file may contain multiple plates of OD. We will parse 
each file section and then read them according to the 
annotation to load the data. We assume for each file the data
are for the same batch and experiment. If otherwise, please 
split the file into different ones.
</p>


<h3>Value</h3>

<p>an object of elisa_run holding data and annotations for 
one or multiple plates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#get example annotation file path from the system folder
ann&lt;-system.file("extdata", "annote.txt", package="ELISAtools")
std.conc&lt;-system.file("extdata", "stdConc.txt", package="ELISAtools")

#read them in and there are 2 plates.
annotations&lt;-read.annotations(annotation=ann,  std.conc=std.conc, num.plate=2)

#now start reading the OD plate file
fileName &lt;-system.file("extdata", "Assay_3_and_4.txt", package="ELISAtools")
plates&lt;-read.plates(fileName, annotations=annotations, num.plate=2, batchID="b1", expID="e1")

</code></pre>

<hr>
<h2 id='reportHtml'>Report ELISA data in HTML format.</h2><span id='topic+reportHtml'></span>

<h3>Description</h3>

<p>Writting the ELISA analysis results by batch in HTML format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reportHtml(batches, file.name = "report", file.dir = ".", desc = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reportHtml_+3A_batches">batches</code></td>
<td>
<p>list of elisa batch data objects. The data can be raw or after 
analyzed and batch-corrected.</p>
</td></tr>
<tr><td><code id="reportHtml_+3A_file.name">file.name</code></td>
<td>
<p>character string denoting the report file. The file will be
written in HTML format.</p>
</td></tr>
<tr><td><code id="reportHtml_+3A_file.dir">file.dir</code></td>
<td>
<p>character string denoting the directory to save the report.</p>
</td></tr>
<tr><td><code id="reportHtml_+3A_desc">desc</code></td>
<td>
<p>character string describing the project and experiment. Will be 
written into the report.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the function returns NULL. But it will save the html report to the disk.
Therefore, it is IMPORTANT to specify a directory you have write permission to
run this function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elisa_batch">elisa_batch</a></code> <code><a href="#topic+elisa_run">elisa_run</a></code>
<code><a href="#topic+elisa_plate">elisa_plate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#R code to run 5-parameter logistic regression on ELISA data
#load the library
library(ELISAtools)

##
#get file folder
dir_file&lt;-system.file("extdata", package="ELISAtools")

batches&lt;-loadData(file.path(dir_file,"design.txt"))


#----IMPORTANT-----
#please make sure you have the write permission to save the html report
reportHtml(batches,file.dir=tempdir());

</code></pre>

<hr>
<h2 id='runFit'>Fit 5- or 4-parameter logistic function</h2><span id='topic+runFit'></span>

<h3>Description</h3>

<p>Fit 5- or 4-parameter logistic function to estimate the parameters
by pooling the standard curves from all batches
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runFit(pars, a, d, batches, refBatch.ID = 1, model = c("5pl", "4pl"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runFit_+3A_pars">pars</code></td>
<td>
<p>numeric vector initial values to estimate the paramters</p>
</td></tr>
<tr><td><code id="runFit_+3A_a">a</code></td>
<td>
<p>numeric the initial value for a (the lower limit of the function)</p>
</td></tr>
<tr><td><code id="runFit_+3A_d">d</code></td>
<td>
<p>numeric the initial value for d (the upper limit of the function)</p>
</td></tr>
<tr><td><code id="runFit_+3A_batches">batches</code></td>
<td>
<p>list of the batch data used to fit the model</p>
</td></tr>
<tr><td><code id="runFit_+3A_refbatch.id">refBatch.ID</code></td>
<td>
<p>numeric or string indicating the 
reference batch, by default is set to be the first one.</p>
</td></tr>
<tr><td><code id="runFit_+3A_model">model</code></td>
<td>
<p>characters to indicate either 5-parameter logistic
function (5pl, default one) or 4-parameter logistic (4pl) to 
be used in the fitting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In this fitting, we first &quot;guess&quot; the initial values and then estimate
the parameters based on 5- or 4-parameter function by shifting every single standard 
curves towards the reference line. 
We are reasoning that the intra-batch and 
inter-batch factors affect the curve similarly by shifting the curve 
left or right without changing its shapes. So we combine them together to
to fit one single reference curve. To model the inter-batch effects, we
take the average of the shifts of curves withine each batch, and use it
to correct/normalize between different batches. <br />
To summerize, each individual curve has its own shifts, which contains 
the information about intra- and inter-batch effects. each batch has
one batch level shifts (S Factor), which is an average of shifts of 
curves within its batch and contains information about inter-batch effects.
When we try to normalize between batches, we will apply the batch level shift to 
all the curves within the same batch.
</p>


<h3>Value</h3>

<p>the batch data with the fitted model
</p>


<h3>References</h3>

<p>Feng, et al 2018 doi: <a href="https://doi.org/10.1101/483800">10.1101/483800</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#R code to run 5-parameter logistic regression on ELISA data
#load the library
library(ELISAtools)

#get file folder
dir_file&lt;-system.file("extdata", package="ELISAtools")

batches&lt;-loadData(file.path(dir_file,"design.txt"))

#make a guess for the parameters, the other two parameters a and d 
#will be estimated based on data.
model&lt;-"5pl"
pars&lt;-c(7.2,0.5, 0.015) #5pl inits
names(pars)&lt;-c("xmid", "scal", "g")


#do fitting. model will be written into data set.
batches&lt;-runFit(pars=pars,  batches=batches, refBatch.ID=1, model=model  )

</code></pre>

<hr>
<h2 id='saveDataText'>Save elisa_batch analysis results</h2><span id='topic+saveDataText'></span>

<h3>Description</h3>

<p>Save the data analysis results to disk in text format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveDataText(batches, file.name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveDataText_+3A_batches">batches</code></td>
<td>
<p>list of elisa batch data to be serialized.</p>
</td></tr>
<tr><td><code id="saveDataText_+3A_file.name">file.name</code></td>
<td>
<p>character specifying name of the output file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results are written to disk in the text format (tab-delimited) and is 
easy to be used for other analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#'#R code to run 5-parameter logistic regression on ELISA data
#load the library
library(ELISAtools)

#get file folder
dir_file&lt;-system.file("extdata", package="ELISAtools")

batches&lt;-loadData(file.path(dir_file,"design.txt"))

#make a guess for the parameters, the other two parameters a and d 
#will be estimated based on data.
model&lt;-"5pl"
pars&lt;-c(7.2,0.5, 0.015) #5pl inits
names(pars)&lt;-c("xmid", "scal", "g")


#do fitting. model will be written into data set.
batches&lt;-runFit(pars=pars,  batches=batches, refBatch.ID=1, model=model  )

#now call to do predications based on the model.
batches&lt;-predictAll(batches);

#now saving the data in text.
saveDataText(batches, file.path(tempdir(),"elisa_data.txt"));


</code></pre>

<hr>
<h2 id='saveDB'>Save the elisa_batch data</h2><span id='topic+saveDB'></span>

<h3>Description</h3>

<p>Serialize elisa_batch data to disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveDB(batches, db)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveDB_+3A_batches">batches</code></td>
<td>
<p>list of elisa batch data to be serialized.</p>
</td></tr>
<tr><td><code id="saveDB_+3A_db">db</code></td>
<td>
<p>character the file name specifying name of the db.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We serialize elisa_batch data by wrapping the saveRds()
function call.
The serialized elisa_batch data are assumed to have been correctly 
analyzed. We will print a summary for what has been saved.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+elisa_batch-class">elisa_batch-class</a></code> <code><a href="#topic+loadData">loadData</a></code> <code><a href="#topic+saveDB">saveDB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#R code to run 5-parameter logistic regression on ELISA data
#load the library
library(ELISAtools)

#get file folder
dir_file&lt;-system.file("extdata", package="ELISAtools")

batches&lt;-loadData(file.path(dir_file,"design.txt"))

#make a guess for the parameters, the other two parameters a and d 
#will be estimated based on data.
model&lt;-"5pl"
pars&lt;-c(7.2,0.5, 0.015) #5pl inits
names(pars)&lt;-c("xmid", "scal", "g")


#do fitting. model will be written into data set.
batches&lt;-runFit(pars=pars,  batches=batches, refBatch.ID=1, model=model  )

#now call to do predications based on the model.
batches&lt;-predictAll(batches);

#now saving the data.
saveDB(batches, file.path(tempdir(),"elisa_tool1.rds"));

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
