<!DOCTYPE html><html><head><title>Help for package BayesDissolution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesDissolution}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bmn'><p>Bayesian Multivariate Normal Model for Dissolution Profile Modeling</p></a></li>
<li><a href='#dis_data'><p>A dissolution data set taken from Ocana et al. (2009).</p></a></li>
<li><a href='#dissplot'><p>Dissolution Data Plot</p></a></li>
<li><a href='#f2bayes'><p>Calculation of a Bayesian 100*prob% credible interval for the F2 parameter</p></a></li>
<li><a href='#f2bca'><p>Calculation of a biased-corrected and accepted 100*level% confidence interval for the F2 parameter</p></a></li>
<li><a href='#f2boot'><p>Calculation of a bootstrap 100*level% confidence interval for the F2 parameter</p></a></li>
<li><a href='#f2calc'><p>Calculation of the f2 Statistic</p></a></li>
<li><a href='#f2gpq'><p>Calculation of a generalized pivotal quantity 100*level% confidence interval for the F2 parameter</p></a></li>
<li><a href='#f2pbs'><p>Calculation of a parametric bootstrap 100*level% confidence interval for the F2 parameter</p></a></li>
<li><a href='#ggdissplot'><p>Dissolution Data Plot</p></a></li>
<li><a href='#hgp'><p>Hierarchical Gaussian Process Model for Dissolution Profile Modeling</p></a></li>
<li><a href='#make_dis_data'><p>Class dis_data creation</p></a></li>
<li><a href='#process_results'><p>Helper function for processing results</p></a></li>
<li><a href='#runExample'><p>Run BayesDissolution Shiny App</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Models for Dissolution Testing</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits Bayesian models (amongst others) to dissolution data sets that can be used for dissolution testing. The package was originally constructed to include only the Bayesian models outlined in Pourmohamad et al. (2022) &lt;<a href="https://doi.org/10.1111%2Frssc.12535">doi:10.1111/rssc.12535</a>&gt;. However, additional Bayesian and non-Bayesian models (based on bootstrapping and generalized pivotal quanties) have also been added. More models may be added over time.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, geoR, MCMCpack, mnormt, pscl, shiny, stats</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, scales</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-30 19:05:33 UTC; pourmoht</td>
</tr>
<tr>
<td>Author:</td>
<td>Tony Pourmohamad [aut, cre],
  Steven Novick [aut],
  Robert Richardson [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tony Pourmohamad &lt;tpourmohamad@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-30 19:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bmn'>Bayesian Multivariate Normal Model for Dissolution Profile Modeling</h2><span id='topic+bmn'></span>

<h3>Description</h3>

<p>This function implements the Bayesian multivariate normal model described in Pourmohamad et al (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bmn(dis_data, B = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bmn_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
<tr><td><code id="bmn_+3A_b">B</code></td>
<td>
<p>A positive integer specifying the number of posterior samples to draw. By default <code>B</code> is set to 10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list of B posterior samples for the following parameters:
</p>

<ul>
<li><p> delta: A vector of posterior samples of delta as defined in Novick et. al 2015
</p>
</li>
<li><p> f2: A vector of posterior values of f2
</p>
</li>
<li><p> muR: A matrix of posterior samples for the reference group mean. Each row of the matrix corresponds to an observed time point, and each column of the matrix corresponds to a posterior sample.
</p>
</li>
<li><p> muT: A matrix of posterior samples for the test group mean. Each row of the matrix corresponds to an observed time point, and each column of the matrix corresponds to a posterior sample.
</p>
</li></ul>



<h3>Note</h3>

<p>You should always check MCMC diagnostics on the posterior samples before drawing conclusions.
</p>


<h3>References</h3>

<p>Novick, S., Shen, Y., Yang, H., Peterson, J., LeBlond, D., and Altan, S. (2015). Dissolution Curve Comparisons Through the F2 Parameter, a Bayesian Extension of the f2 Statistic. Journal of Biopharmaceutical Statistics, 25(2):351-371.
</p>
<p>Pourmohamad, T., Oliva Aviles, C.M., and Richardson, R. Gaussian Process Modeling for Dissolution Curve Comparisons. Journal of the Royal Statistical Society, Series C, 71(2):331-351.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
### We set B = 1000 to obtain 1000 posterior samples
B &lt;- 1000
post &lt;- bmn(dis_data, B = B)

### We can check how well the posterior samples of the means are mixing by
### plotting the individual chains by time point
burnin &lt;- B * 0.1     # A 10% burn-in
post$mu_R &lt;- post$muR[,-(1:burnin)]
post$mu_T &lt;- post$muT[,-(1:burnin)]

N &lt;- B - burnin      # Number of posterior samples after burn-in
chains &lt;- data.frame(samples = rep(c(1:N, 1:N), each = ncol(dis_data) - 1),
                     group = rep(c("muR", "muT"), each = (ncol(dis_data) - 1) * N),
                     timepoint = paste("Time Point", rep(1:(ncol(dis_data) - 1), 2 * N)),
                     values = c(c(post$mu_R), c(post$mu_T)))

g &lt;- ggplot2::ggplot(chains, ggplot2::aes(samples, values)) +
                     ggplot2::geom_line() +
                     ggplot2::labs(x = "Iterations", y = "Posterior Sample Values") +
                     ggplot2::facet_wrap(group ~ timepoint) +
                     ggplot2::theme(text = ggplot2::element_text(size = 16))

### If we want to calculate the Pr(f2 &gt; 50)
post$f2&lt;- post$f2[-(1:burnin)]
prob &lt;- sum(post$f2 &gt; 50) / (B - burnin)

### Or if we want calculate a 95% credible interval for f2
alpha &lt;- 0.05
f2_cred &lt;- c(quantile(post$f2, alpha / 2),quantile(post$f2, 1 - alpha / 2))

</code></pre>

<hr>
<h2 id='dis_data'>A dissolution data set taken from Ocana et al. (2009).</h2><span id='topic+dis_data'></span>

<h3>Description</h3>

<p>A dissolution data set that consists of dissolution measurements
taken on oral tablets made with metoclopramide hydrochloride. Of interest is
to test the similarity of metoclopramide hydrochloride tablets made with and without the
ingredient tensioactive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dis_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 9 columns:
</p>

<dl>
<dt>group</dt><dd><p>An indicator of whether the dissolution run came from the reference or test group</p>
</dd>
<dt>X1</dt><dd><p>The first time point at which measurements are made at.</p>
</dd>
<dt>X2</dt><dd><p>The second time point at which measurements are made at.</p>
</dd>
<dt>X3</dt><dd><p>The third time point at which measurements are made at.</p>
</dd>
<dt>X4</dt><dd><p>The fourth time point at which measurements are made at.</p>
</dd>
<dt>X5</dt><dd><p>The fifth time point at which measurements are made at.</p>
</dd>
<dt>X6</dt><dd><p>The sixth time point at which measurements are made at.</p>
</dd>
<dt>X7</dt><dd><p>The seventh time point at which measurements are made at.</p>
</dd>
<dt>X8</dt><dd><p>The eight time point at which measurements are made at.</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p>Ocana et al. (2009) <a href="doi:10.1016/j.chemolab.2009.07.010">doi:10.1016/j.chemolab.2009.07.010</a>
</p>

<hr>
<h2 id='dissplot'>Dissolution Data Plot</h2><span id='topic+dissplot'></span>

<h3>Description</h3>

<p>This function plots dissolution data sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dissplot(
  dis_data,
  tp = NULL,
  pch = c(19, 17),
  color = c("gray65", "black"),
  groups = c("Reference", "Test"),
  legend_location = "bottomright",
  xlab = "Time Points",
  ylab = "Percentage Dissolved",
  mean = FALSE,
  var = FALSE,
  var_label = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dissplot_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_tp">tp</code></td>
<td>
<p>An optional vector of time points at which the dissolution data is measured at.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_pch">pch</code></td>
<td>
<p>A vector of two elements specifying the plotting character to use for each group. If only one value is passed then the plotting character is the same for both groups.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_color">color</code></td>
<td>
<p>A vector of two elements specifying the color in the plot to associate with each group. If only one value is passed then the color choice is the same for both groups.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_groups">groups</code></td>
<td>
<p>A vector of two elements specifying the name to use for each group in the plot.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_legend_location">legend_location</code></td>
<td>
<p>A string that denotes the location of where the legend should appear. Possible options are &quot;left&quot;, &quot;top&quot;, &quot;bottom&quot;, &quot;right&quot;, and any logical combination of the four, e.g., &quot;bottomright&quot; or &quot;topleft&quot;.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_xlab">xlab</code></td>
<td>
<p>A string specifying the x-axis label.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_ylab">ylab</code></td>
<td>
<p>A string specifying the y-axis label.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_mean">mean</code></td>
<td>
<p>logical; if <code>TRUE</code>, plot the connected mean dissolution values for each group</p>
</td></tr>
<tr><td><code id="dissplot_+3A_var">var</code></td>
<td>
<p>logical; if <code>TRUE</code>, calculate the variance of the dissolution data at each time point for each group. The values are placed at the top of the plot over the corresponding time point.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_var_label">var_label</code></td>
<td>
<p>logical; if <code>TRUE</code>, use the group labels when printing out the variances.</p>
</td></tr>
<tr><td><code id="dissplot_+3A_...">...</code></td>
<td>
<p>other graphical parameters commonly found in <a href="graphics.html#topic+plot.default">plot.default</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a plot of the dissolution data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
dissplot(dis_data)

</code></pre>

<hr>
<h2 id='f2bayes'>Calculation of a Bayesian 100*prob% credible interval for the F2 parameter</h2><span id='topic+f2bayes'></span>

<h3>Description</h3>

<p>This function calculates a 100*prob% credible interval for the F2 parameter using Bayesian methods. The model assumes a
version of the Jerffreys' prior with a pooled variance-covariance matrix from based on the reference and test data sets.
See Novick (2015) for more details of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f2bayes(
  dis_data,
  prob = 0.9,
  B = 1000,
  ci.type = c("quantile", "HPD"),
  get.dist = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f2bayes_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
<tr><td><code id="f2bayes_+3A_prob">prob</code></td>
<td>
<p>The probability associated with the credible interval. A value between 0 and 1.</p>
</td></tr>
<tr><td><code id="f2bayes_+3A_b">B</code></td>
<td>
<p>A positive integer specifying the number of Monte Carlo samples.</p>
</td></tr>
<tr><td><code id="f2bayes_+3A_ci.type">ci.type</code></td>
<td>
<p>The type of credible interval to report. Specifying <code>quantile</code> returns a credible interval based on the posterior sample quantiles of the F2 distribution. Specifying <code>HPD</code> returns a highest posterior density interval.</p>
</td></tr>
<tr><td><code id="f2bayes_+3A_get.dist">get.dist</code></td>
<td>
<p>logical; if <code>TRUE</code>, returns the posterior samples of the F2 distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a 100*prob% credible interval for the F2 parameter calculated from the observed dissolution data.
</p>


<h3>Note</h3>

<p>Use the <code>plotdiss()</code> or <code>ggplotdiss()</code> function to visually check if it's appropriate to calculate the f2 statistic.
</p>


<h3>References</h3>

<p>Novick, S., Shen, Y., Yang, H., Peterson, J., LeBlond, D., and Altan, S. (2015). Dissolution Curve Comparisons Through the F2 Parameter, a Bayesian Extension of the f2 Statistic. Journal of Biopharmaceutical Statistics, 25(2):351-371.
</p>
<p>Pourmohamad, T., Oliva Aviles, C.M., and Richardson, R. Gaussian Process Modeling for Dissolution Curve Comparisons. Journal of the Royal Statistical Society, Series C, 71(2):331-351.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
f2bayes(dis_data, prob = 0.9, B = 1000)

</code></pre>

<hr>
<h2 id='f2bca'>Calculation of a biased-corrected and accepted 100*level% confidence interval for the F2 parameter</h2><span id='topic+f2bca'></span>

<h3>Description</h3>

<p>This function calculates a 100*level% confidence interval for the F2 parameter using biased-correctd and accelerated (BCa) boostrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f2bca(
  dis_data,
  level = 0.9,
  B = 1000,
  ci.type = c("quantile", "HPD"),
  get.dist = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f2bca_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
<tr><td><code id="f2bca_+3A_level">level</code></td>
<td>
<p>The confidence level. A value between 0 and 1.</p>
</td></tr>
<tr><td><code id="f2bca_+3A_b">B</code></td>
<td>
<p>A positive integer specifying the number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="f2bca_+3A_ci.type">ci.type</code></td>
<td>
<p>The type of confidence interval to report. Specifying <code>quantile</code> returns a bootstrap confidence interval based on the sample quantiles. Specifying <code>HPD</code> returns a highest density region interval.</p>
</td></tr>
<tr><td><code id="f2bca_+3A_get.dist">get.dist</code></td>
<td>
<p>logical; if <code>TRUE</code>, returns the posterior samples of the F2 distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a 100*level% confidence interval for the F2 parameter calculated from the observed dissolution data.
</p>


<h3>Note</h3>

<p>Use the <code>plotdiss()</code> or <code>ggplotdiss()</code> function to visually check if it's appropriate to calculate the f2 statistic.
</p>


<h3>References</h3>

<p>Liu, S. and Cai, X. and Shen, M. and Tsong, Y. (2023). In vitro dissolution profile comparison using bootstrap
bias corrected similarity factor, f2. Journal of Biopharmaceutical Statistics, 34(1):78-89.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
f2bca(dis_data, level = 0.9, B = 1000)

</code></pre>

<hr>
<h2 id='f2boot'>Calculation of a bootstrap 100*level% confidence interval for the F2 parameter</h2><span id='topic+f2boot'></span>

<h3>Description</h3>

<p>This function calculates a 100*level% confidence interval for the F2 parameter using a nonparametric bootstrap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f2boot(
  dis_data,
  level = 0.9,
  B = 1000,
  ci.type = c("quantile", "HPD"),
  get.dist = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f2boot_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
<tr><td><code id="f2boot_+3A_level">level</code></td>
<td>
<p>The confidence level. A value between 0 and 1.</p>
</td></tr>
<tr><td><code id="f2boot_+3A_b">B</code></td>
<td>
<p>A positive integer specifying the number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="f2boot_+3A_ci.type">ci.type</code></td>
<td>
<p>The type of confidence interval to report. Specifying <code>quantile</code> returns a bootstrap confidence interval based on the sample quantiles. Specifying <code>HPD</code> returns a highest density region interval.</p>
</td></tr>
<tr><td><code id="f2boot_+3A_get.dist">get.dist</code></td>
<td>
<p>logical; if <code>TRUE</code>, returns the posterior samples of the F2 distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a 100*level% confidence interval for the F2 parameter calculated from the observed dissolution data.
</p>


<h3>Note</h3>

<p>Use the <code>plotdiss()</code> or <code>ggplotdiss()</code> function to visually check if it's appropriate to calculate the f2 statistic.
</p>


<h3>References</h3>

<p>Liu, S. and Cai, X. and Shen, M. and Tsong, Y. (2023). In vitro dissolution profile comparison using bootstrap
bias corrected similarity factor, f2. Journal of Biopharmaceutical Statistics, 34(1):78-89.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
f2boot(dis_data, level = 0.9, B = 1000)

</code></pre>

<hr>
<h2 id='f2calc'>Calculation of the f2 Statistic</h2><span id='topic+f2calc'></span>

<h3>Description</h3>

<p>This function calculates the f2 statistic as described in Moore and Flanner (1996).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f2calc(dis_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f2calc_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns the f2 statistic calculated from the observed dissolution data.
</p>


<h3>Note</h3>

<p>Use the <code>plotdiss()</code> or <code>ggplotdiss()</code> function to visually check if it's appropriate to calculate the f2 statistic.
</p>


<h3>References</h3>

<p>Moore, J.W. and Flanner, H.H. (1996). Mathematical comparison of distribution profiles. Pharmaceutical Technology, 20(6):64-74.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
f2calc(dis_data)

</code></pre>

<hr>
<h2 id='f2gpq'>Calculation of a generalized pivotal quantity 100*level% confidence interval for the F2 parameter</h2><span id='topic+f2gpq'></span>

<h3>Description</h3>

<p>This function calculates a 100*level% confidence interval for the F2 parameter using generalized pivotal quantity methods based on a two variance component model with means for Time x Group, i.e.,  Dissolution ~ Time x Group + (1|Tablet:Group).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f2gpq(
  dis_data,
  level = 0.9,
  B = 10000,
  ci.type = c("quantile", "HPD"),
  get.dist = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f2gpq_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
<tr><td><code id="f2gpq_+3A_level">level</code></td>
<td>
<p>The confidence level. A value between 0 and 1.</p>
</td></tr>
<tr><td><code id="f2gpq_+3A_b">B</code></td>
<td>
<p>The number of generalized pivotal quantity samples.</p>
</td></tr>
<tr><td><code id="f2gpq_+3A_ci.type">ci.type</code></td>
<td>
<p>The type of confidence interval to report. Specifying <code>quantile</code> returns a bootstrap confidence interval based on the sample quantiles. Specifying <code>HPD</code> returns a highest density region interval.</p>
</td></tr>
<tr><td><code id="f2gpq_+3A_get.dist">get.dist</code></td>
<td>
<p>logical; if <code>TRUE</code>, returns the posterior samples of the F2 distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a 100*level% confidence interval for the F2 parameter calculated from the observed dissolution data.
</p>


<h3>Note</h3>

<p>Use the <code>plotdiss()</code> or <code>ggplotdiss()</code> function to visually check if it's appropriate to calculate the f2 statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
f2gpq(dis_data, level = 0.9, B = 10000)

</code></pre>

<hr>
<h2 id='f2pbs'>Calculation of a parametric bootstrap 100*level% confidence interval for the F2 parameter</h2><span id='topic+f2pbs'></span>

<h3>Description</h3>

<p>This function calculates a 100*level% confidence interval for the F2 parameter using a parametric bootstrap based on a two variance component model with means for Time x Group, i.e.,  Dissolution ~ Time x Group + (1|Tablet:Group).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f2pbs(
  dis_data,
  level = 0.9,
  B = 1000,
  ci.type = c("quantile", "HPD"),
  get.dist = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f2pbs_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
<tr><td><code id="f2pbs_+3A_level">level</code></td>
<td>
<p>The confidence level. A value between 0 and 1.</p>
</td></tr>
<tr><td><code id="f2pbs_+3A_b">B</code></td>
<td>
<p>A positive integer specifying the number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="f2pbs_+3A_ci.type">ci.type</code></td>
<td>
<p>The type of confidence interval to report. Specifying <code>quantile</code> returns a bootstrap confidence interval based on the sample quantiles. Specifying <code>HPD</code> returns a highest density region interval.</p>
</td></tr>
<tr><td><code id="f2pbs_+3A_get.dist">get.dist</code></td>
<td>
<p>logical; if <code>TRUE</code>, returns the posterior samples of the F2 distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a 100*level% confidence interval for the F2 parameter calculated from the observed dissolution data.
</p>


<h3>Note</h3>

<p>Use the <code>plotdiss()</code> or <code>ggplotdiss()</code> function to visually check if it's appropriate to calculate the f2 statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
f2pbs(dis_data, level = 0.9, B = 1000)

</code></pre>

<hr>
<h2 id='ggdissplot'>Dissolution Data Plot</h2><span id='topic+ggdissplot'></span>

<h3>Description</h3>

<p>Minimalist ggplot function for plotting dissolution data sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggdissplot(dis_data, show.mean = FALSE, show.SD = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggdissplot_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
<tr><td><code id="ggdissplot_+3A_show.mean">show.mean</code></td>
<td>
<p>logical; if <code>TRUE</code>, plot the connected mean dissolution values for each group.</p>
</td></tr>
<tr><td><code id="ggdissplot_+3A_show.sd">show.SD</code></td>
<td>
<p>logical; if <code>TRUE</code>, calculate the variance of the dissolution data at each time point for each group. The values are placed at the top of the plot over the corresponding time point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a plot of the dissolution data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
ggdissplot(dis_data)

</code></pre>

<hr>
<h2 id='hgp'>Hierarchical Gaussian Process Model for Dissolution Profile Modeling</h2><span id='topic+hgp'></span>

<h3>Description</h3>

<p>This function implements the Bayesian hierarchical Gaussian process model described in Pourmohamad et al (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hgp(
  dis_data,
  locs,
  B = 1000,
  n_interp = 30,
  control = list(),
  adaptive = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hgp_+3A_dis_data">dis_data</code></td>
<td>
<p>A data frame containing the dissolution data. The first column of the data frame should denote
the group labels identifying whether a given dissolution belongs to the &quot;reference&quot; or &quot;test&quot; formulation group.
For a given dissolution run, the remaining columns of the data frame contains the individual run's dissolution
measurements sorted in time. Alternatively, the user may provide a data object of class dis_data containing the
dissolution data. See the <code>make_dis_data()</code> function for the particular structure of the data object.</p>
</td></tr>
<tr><td><code id="hgp_+3A_locs">locs</code></td>
<td>
<p>A vector in ascending order that corresponds to each time point the dissolution data was measured at.</p>
</td></tr>
<tr><td><code id="hgp_+3A_b">B</code></td>
<td>
<p>A positive integer specifying the number of posterior samples to draw. By default <code>B</code> is set to 10000.</p>
</td></tr>
<tr><td><code id="hgp_+3A_n_interp">n_interp</code></td>
<td>
<p>An integer value specifying the number of time points to interpolate at. This sets the interploated points to be to <code>seq(1st time point, last time point, length = n_interp)</code>.</p>
</td></tr>
<tr><td><code id="hgp_+3A_control">control</code></td>
<td>
<p>An optional list of priors and initial values, otherwise the default values/strategies found in Pourmohamad et al (2022) will be used. More specifically, <code>control</code> can be used to define the following settings:
</p>

<ul>
<li> <p><code>sigma2_starting</code>: starting value for sigma^2
</p>
</li>
<li> <p><code>tau2_starting</code>: starting value for tau^2
</p>
</li>
<li> <p><code>phi_starting</code>: starting value for phi
</p>
</li>
<li> <p><code>psi_starting</code>: starting value for psi
</p>
</li>
<li> <p><code>sigma2_alpha</code> and <code>sigma2_beta</code>: parameters for the inverse gamma prior for sigma^2
</p>
</li>
<li> <p><code>tau2_alpha</code> and <code>tau2_beta</code>: parameters for the inverse gamma prior for tau^2
</p>
</li>
<li> <p><code>phi_alpha</code> and <code>phi_beta</code>: parameters for the gamma prior for phi
</p>
</li>
<li> <p><code>psi_alpha</code> and <code>psi_beta</code>: parameters for the gamma prior for psi
</p>
</li>
<li> <p><code>prop_phi</code>: proposal variance for the parameter phi
</p>
</li>
<li> <p><code>prop_psi</code>: proposal variance for the parameter psi
</p>
</li></ul>
</td></tr>
<tr><td><code id="hgp_+3A_adaptive">adaptive</code></td>
<td>
<p>logical; an option for using adaptive MCMC. If <code>adaptive = TRUE</code>, this will replace both <code>prop_phi</code> and <code>prop_psi</code> by using past MCMC draws to inform the proposal variance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list of summary statistics and B posterior samples for parameters of the model. More specifically it returns:
</p>

<ul>
<li><p> delta: The average delta value over the posterior samples of delta. The definition of delta is given in Novick et. al 2015.
</p>
</li>
<li><p> f2: The average f2 value over the posterior samples of f2.
</p>
</li>
<li><p> mcmc_chains: A list of posterior samples for delta, f2, the mean parameters (<code>mu_pars</code>), and the covariance parameters (<code>cov_pars</code>).
</p>
</li></ul>



<h3>Note</h3>

<p>You should always check MCMC diagnostics on the posterior samples before drawing conclusions. Likewise, plots of the predicted dissolution curves should also be checked to evaluate if the model fit to the observed data seems reasonable.
</p>


<h3>References</h3>

<p>Novick, S., Shen, Y., Yang, H., Peterson, J., LeBlond, D., and Altan, S. (2015). Dissolution Curve Comparisons Through the F2 Parameter, a Bayesian Extension of the f2 Statistic. Journal of Biopharmaceutical Statistics, 25(2):351-371.
</p>
<p>Pourmohamad, T., Oliva Aviles, C.M., and Richardson, R. Gaussian Process Modeling for Dissolution Curve Comparisons. Journal of the Royal Statistical Society, Series C, 71(2):331-351.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
### We set B = 100 to obtain 100 posterior samples, you probably want to run it
### longer for say, B = 100000, but B = 100 runs fast for illustrative purposes
### and passing CRAN checks
B &lt;- 100

tp &lt;- seq(10, 80, 10) # Time points
burnin &lt;- B * 0.1     # A 10% burn-in
thin &lt;- 10            # Keep every 10th sample, i.e., thinning
post &lt;- hgp(dis_data, locs = tp, B = B, n_interp = 100)

### Example: Removing burn-in and then thinning the posterior samples for the covariance parameters
###          and then plotting the chains
phi &lt;- post$mcmc_chains$cov_pars$phi[-c(1:burnin)]
phi &lt;- phi[seq(1, (B-burnin), thin)]
psi &lt;- post$mcmc_chains$cov_pars$psi[-c(1:burnin)]
psi &lt;- psi[seq(1, (B-burnin), thin)]
sigma_R &lt;- post$mcmc_chains$cov_pars$sigma_R[-c(1:burnin)]
sigma_R &lt;- sigma_R[seq(1, (B-burnin), thin)]
sigma_T &lt;- post$mcmc_chains$cov_pars$sigma_T[-c(1:burnin)]
sigma_T &lt;- sigma_T[seq(1, (B-burnin), thin)]
tau &lt;- post$mcmc_chains$cov_pars$tau[-c(1:burnin)]
tau &lt;- tau[seq(1, (B-burnin), thin)]

chains &lt;- data.frame( # Data frame holding posterior samples
samples = rep(1:((B-burnin)/thin), times = 5),
parameter = rep(c("phi", "psi", "sigma_R", "sigma_T", "tau"),
                each = (B-burnin)/thin),
values = c(phi, psi, sigma_R, sigma_T, tau))
chains$parameter &lt;- factor(chains$parameter,
                           labels = c(expression(phi),
                                      expression(psi),
                                      expression(sigma[R]),
                                      expression(sigma[T]),
                                      expression(tau)))
ggplot2::ggplot(chains, ggplot2::aes(samples, values)) +
 ggplot2::geom_line() +
 ggplot2::labs(x = "Iterations", y = "Posterior Sample Values") +
 ggplot2::facet_wrap(~parameter, scales = "free",
             labeller = ggplot2::label_parsed) +
 ggplot2::theme(text = ggplot2::element_text(size = 22))

ggplot2::ggplot(chains, ggplot2::aes(values)) +
 ggplot2::geom_density() +
 ggplot2::labs(x = "Values", y = "Posterior Density") +
 ggplot2::facet_wrap(~parameter, scales = "free",
            labeller = ggplot2::label_parsed) +
 ggplot2::theme(text = ggplot2::element_text(size = 22))

### Plotting the predicted dissolution profiles
dissplot(dis_data, tp)
grid &lt;- sort(c(tp, seq(min(tp), max(tp), length = 100)))
grid1 &lt;- (1:B)[-(1:burnin)][seq(1, (B-burnin), thin)]
grid2 &lt;- ((B+1):(2*B))[-(1:burnin)][seq(1, (B-burnin), thin)]
lines(grid, apply(post$mcmc_chains$mu_pars[,grid1], 1, mean),
      col = "gray65", lwd = 2)
lines(grid, apply(post$mcmc_chains$mu_pars[,grid2], 1, mean),
      col = "black", lwd = 2)
lower &lt;- apply(post$mcmc_chains$mu_pars[,grid1], 1,
               quantile, prob = 0.025)
upper &lt;- apply(post$mcmc_chains$mu_pars[,grid1], 1,
               quantile, prob = 0.975)
polygon(c(grid, rev(grid)), c(lower, rev(upper)),
        col = scales::alpha("gray65",.2), border = NA)
lower &lt;- apply(post$mcmc_chains$mu_pars[,grid2], 1,
              quantile, prob = 0.025)
upper &lt;- apply(post$mcmc_chains$mu_pars[,grid2], 1,
               quantile, prob = 0.975)
polygon(c(grid, rev(grid)), c(lower, rev(upper)),
        col = scales::alpha("black",.2), border = NA)

### If we want to calculate the Pr(f2 &gt; 50 &amp; delta &lt; 15)
prob &lt;- sum(post$mcmc_chains$f2[grid1] &gt; 50 &amp;
            post$mcmc_chains$delta[grid1] &lt; 15) / ((B - burnin)/thin)

</code></pre>

<hr>
<h2 id='make_dis_data'>Class dis_data creation</h2><span id='topic+make_dis_data'></span>

<h3>Description</h3>

<p>This function creates a data object of class dis_data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_dis_data(yRef, yTest)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_dis_data_+3A_yref">yRef</code></td>
<td>
<p>A data frame or matrix containing the dissolution data for the reference group data. The rows of the data set correspond
to the individual dissolution runs. The columns of the data frame contains the individual run's dissolution
measurements sorted in time.</p>
</td></tr>
<tr><td><code id="make_dis_data_+3A_ytest">yTest</code></td>
<td>
<p>A data frame or matrix containing the dissolution data for the test group data. The rows of the data set correspond
to the individual dissolution runs. The columns of the data frame contains the individual run's dissolution
measurements sorted in time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a data object of class dis_data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
### but need to update dis_data to be an object of class dis_data
new_dis_data &lt;- make_dis_data(yRef = dis_data[dis_data$group == "Reference", -1],
                              yTest = dis_data[dis_data$group == "Test", -1])

</code></pre>

<hr>
<h2 id='process_results'>Helper function for processing results</h2><span id='topic+process_results'></span>

<h3>Description</h3>

<p>This function helps process the final results for the different f2 functions (e.g., f2bayes).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_results(
  name,
  f2.dist,
  ci.type = c("quantile", "HPD"),
  level,
  get.dist = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="process_results_+3A_name">name</code></td>
<td>
<p>A character string denoting the type of method used to calculate the interval.</p>
</td></tr>
<tr><td><code id="process_results_+3A_f2.dist">f2.dist</code></td>
<td>
<p>A vector of samples for the F2 parameter or f2 statistic.</p>
</td></tr>
<tr><td><code id="process_results_+3A_ci.type">ci.type</code></td>
<td>
<p>The type of confidence, or credible, interval to return. The option <code>quantile</code> returns sample quantile based intervals, while the option <code>HPD</code> returns intervals based on highest density regions.</p>
</td></tr>
<tr><td><code id="process_results_+3A_level">level</code></td>
<td>
<p>The confidence level or probability associated with the confidence or credible interval, respectively. Must be a value between 0 and 1.</p>
</td></tr>
<tr><td><code id="process_results_+3A_get.dist">get.dist</code></td>
<td>
<p>logical; if <code>TRUE</code>, returns the samples of the distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a data object of class dis_data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### dis_data comes loaded with the package
out1 &lt;- f2bayes(dis_data, prob = 0.9, B = 1000, get.dist = TRUE)

out2 &lt;- process_results("bayes", out1$f2.dist, level = 0.9)

### out1 and out2 should contain the results for the info and intervals

</code></pre>

<hr>
<h2 id='runExample'>Run BayesDissolution Shiny App</h2><span id='topic+runExample'></span>

<h3>Description</h3>

<p>Runs a shiny application for calculating the different confidence and credible intervals for the F2 parameter. The different intervals are
constructed using the <code>f2bayes()</code>, <code>f2bca()</code>, <code>f2boot()</code>, <code>f2gpq()</code>, and <code>f2pbs()</code> functions. The shiny application comes
preloaded with an example excel data set based on the <code>dis_data</code> data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runExample()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>### The function requires no input to run
if(FALSE){ ## Make me TRUE to run
  runExample()
}

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
