<!DOCTYPE html><html lang="en"><head><title>Help for package CARM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CARM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CARM-package'><p>CARM:Covariate-adjusted Adaptive Randomization via Mahalanobis-distance</p></a></li>
<li><a href='#ARM'><p>Adaptive Randomization via Mahalanobis Distance</p></a></li>
<li><a href='#ARMM'><p>Adaptive Randomization via Mahalanobis distance for Multi-arm design</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Covariate-Adjusted Adaptive Randomization via
Mahalanobis-Distance</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Haoyu Yang [aut],
  Fanglu Chen [aut, cre],
  Yichen Qin [aut],
  Yang Li [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fanglu Chen &lt;chenfanglu1031@qq.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>In randomized controlled trial (RCT), balancing covariate is often one of the most important concern. CARM package provides functions to balance the covariates and generate allocation sequence by covariate-adjusted Adaptive Randomization via Mahalanobis-distance (ARM) for RCT. About what ARM is and how it works please see Y. Qin, Y. Li, W. Ma, H. Yang, and F. Hu (2022). "Adaptive randomization via Mahalanobis distance" Statistica Sinica. &lt;<a href="https://doi.org/10.5705%2Fss.202020.0440">doi:10.5705/ss.202020.0440</a>&gt;. In addition, the package is also suitable for the randomization process of multi-arm trials. For details, please see Yang H, Qin Y, Wang F, et al. (2023). "Balancing covariates in multi-arm trials via adaptive randomization" Computational Statistics &amp; Data Analysis.&lt;<a href="https://doi.org/10.1016%2Fj.csda.2022.107642">doi:10.1016/j.csda.2022.107642</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.6.0),stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>arrangements,dplyr,MASS</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-07 15:17:17 UTC; star</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-07 16:40:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='CARM-package'>CARM:Covariate-adjusted Adaptive Randomization via Mahalanobis-distance</h2><span id='topic+CARM-package'></span>

<h3>Description</h3>

<p>The CARM package provides function of implement of randomization:
</p>


<h3>ARM functions</h3>

<p>please ?ARM and ?ARMM to view function usage
</p>

<hr>
<h2 id='ARM'>Adaptive Randomization via Mahalanobis Distance</h2><span id='topic+ARM'></span>

<h3>Description</h3>

<p>Allocates patients to one of two treatments using
Adaptive Randomization via Mahalanobis Distance proposed by
Yichen Qin,Yang Li, Wei Ma, Haoyu Yang, and Feifang Hu.(2022)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARM(covariate, assignment, q = 0.75)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ARM_+3A_covariate">covariate</code></td>
<td>
<p>a data frame. A row of the dataframe
corresponds to the covariate profile of a patient.</p>
</td></tr>
<tr><td><code id="ARM_+3A_assignment">assignment</code></td>
<td>
<p>a vector. If partial patients had been allocated
, please input their allocation. IF
all the patients are not be allocated, please input
'assignment = NA' directly.</p>
</td></tr>
<tr><td><code id="ARM_+3A_q">q</code></td>
<td>
<p>the biased coin probability.
<code class="reqn">q</code> should be larger than 1/2 and less than 1, default = 0.75</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that <code class="reqn">n</code> patients are to be assigned to two treatment groups.
Consider <code class="reqn">p</code>  continuous covariates for each patient.
<code class="reqn">T_i</code> is the assignment of the <code class="reqn">i</code>th patient.
The proposed procedure to assign units to treatment groups, namely adaptive
randomization via Mahalanobis distance (ARM), is outlined below.
</p>
<p>(1) Arrange all <code class="reqn">n</code> units randomly into a sequence
<code class="reqn">x_1,...,x_n</code>.
</p>
<p>(2) Assign the first two units with <code class="reqn">T_1=1</code> and <code class="reqn">T_2=2</code>.
</p>
<p>(3) Suppose that <code class="reqn">2i</code> units have been assigned to
treatment groups,
for the <code class="reqn">2i+1</code>-th and <code class="reqn">2i+2</code>-th units:
</p>
<p>(3a) If the <code class="reqn">2i+1</code>-th unit is assigned to treatment 1 and
the <code class="reqn">2i+2</code>-th
unit to treatment 2, then calculate the potential
Mahalanobis distance, between the updated treatment groups.
with <code class="reqn">2i+2</code> units, <code class="reqn">M_1(2i + 2)</code>.
</p>
<p>(3b) Similarly, if the <code class="reqn">2i+1</code>-th unit is
assigned to treatment 2 and
the <code class="reqn">2i+2</code>-th unit to treatment 1, then calculate the
other potential Mahalanobis distance, <code class="reqn">M_2(2i + 2)</code>.
</p>
<p>(4) Assign the <code class="reqn">2i+1</code>-th unit to treatment groups
according to the
following probabilities:
</p>
<p>if <code class="reqn"> M_1(2i + 2) &lt; M_2(2i + 2)</code>, <code class="reqn">P(T_{2i+1} = 1)= q</code>;
</p>
<p>if <code class="reqn"> M_1(2i + 2) &gt; M_2(2i + 2)</code>, <code class="reqn">P(T_{2i+1} = 1)= 1-q</code>;
</p>
<p>if <code class="reqn"> M_1(2i + 2) = M_2(2i + 2)</code>, <code class="reqn">P(T_{2i+1} = 1)= 0.5</code>.
</p>
<p>(5) Repeat the last two steps until all units are assigned. If n is odd,
assign the last unit to two treatments with equal probabilities.
</p>
<p>Mahalanobis distance <code class="reqn">M(n)</code> between the sample means across
different treatment groups is:
</p>
<p style="text-align: center;"><code class="reqn">M(n)= np(1-p)(\hat{x_1} - \hat{x_2})^Tcov(x)^{-1}(\hat{x_1} - \hat{x_2}</code>
</p>

<p>See the reference for more details.
</p>


<h3>Value</h3>

<p>An object of class &quot;ARM&quot; is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>assignment</code></td>
<td>
<p>Allocation of patients.</p>
</td></tr>
<tr><td><code>sample_size</code></td>
<td>
<p>The number of patients in treatment 1 and treatment 2 respectively.</p>
</td></tr>
<tr><td><code>Mahalanobis_Distance</code></td>
<td>
<p>Mahalanobis distance between treatment groups 1 and 2.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Qin, Y., Y. Li, W. Ma, H. Yang, and F. Hu (2022). Adaptive randomization via mahalanobis distance. Statistica Sinica.DOI:&lt;10.5705/ss.202020.0440&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
#simulate covariates of patients
p &lt;- 6; n &lt;- 30
sigma &lt;- diag(p); mean &lt;- c(rep(0,p))
data &lt;- mvrnorm(n, mean, sigma)
covariate &lt;- as.data.frame(data)
#IF all the patients are not be allocated
ARM(covariate = covariate, assignment = NA, q=0.75)
#IF you had allocated partial patients
ARM(covariate = covariate,assignment = c(1,2),q=0.75)
</code></pre>

<hr>
<h2 id='ARMM'>Adaptive Randomization via Mahalanobis distance for Multi-arm design</h2><span id='topic+ARMM'></span>

<h3>Description</h3>

<p>Randomize patients into treatment groups
for multi-arm trials using ARMM proposed by Haoyu Yang, Yichen Qin,
Yang Li, Fan Wang, and Feifang Hu.(2022)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARMM(covariate, assignment, K, q = 0.75, method)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ARMM_+3A_covariate">covariate</code></td>
<td>
<p>a data frame. A row of the dataframe
corresponds to the covariate profile of a patient.</p>
</td></tr>
<tr><td><code id="ARMM_+3A_assignment">assignment</code></td>
<td>
<p>a vector. If partial patients had been allocated
, please input their allocation. IF
all the patients are not be allocated, please input
'assignment = NA' directly.</p>
</td></tr>
<tr><td><code id="ARMM_+3A_k">K</code></td>
<td>
<p>an integer; number of arms of the trial.</p>
</td></tr>
<tr><td><code id="ARMM_+3A_q">q</code></td>
<td>
<p>the biased coin probability.
<code class="reqn">q</code> should be larger than 1/2 and less than 1, default = 0.75</p>
</td></tr>
<tr><td><code id="ARMM_+3A_method">method</code></td>
<td>
<p>Methods for calculating Mahalanobis distance, input one of these texts:
'mean', 'max' or 'median'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose <code class="reqn">n</code> units (participants) are to be assigned to <code class="reqn">K</code>
treatment groups. For each unit <code class="reqn">i, i = 1, ..., n</code> and
treatment <code class="reqn">j, j = 1, ..., K</code>, define the assignment
matrix <code class="reqn">[T_{ij}]^{n*K}</code>, where
<code class="reqn">T_{ij}=1</code> indicates unit <code class="reqn">i</code> receives treatment <code class="reqn">j</code>.
Consider <code class="reqn">p</code> continuous covariates, let <code class="reqn">x_i =
(x_{i1},...,x_{in})^T</code>.
</p>
<p>The proposed method, namely the adaptive randomization
via Mahalanobis distance for multi-arm design (ARMM),
is outlined below. The implement of ARMM is similar to ARM.
</p>
<p>First assume that <code class="reqn">n</code> units are in a sequence
and then assign the first <code class="reqn">K</code> units to <code class="reqn">K</code> treatment
groups randomly
as the initialization. Then,
the following units are assigned in blocks of <code class="reqn">K</code>
sequentially and
adaptively until all the units
are assigned. For <code class="reqn">K</code> units are assigned to <code class="reqn">K</code>
groups, there are in total <code class="reqn">K!</code> possible allocations.
Calculate <code class="reqn">K!</code> potential overall
covariate imbalance measurement
according to pairwise Mahalanobis
distance under the <code class="reqn">K!</code> possible allocations.
Choose the allocation which corresponds to the smallest
Mahalanobis
distance with a probability of <code class="reqn">q</code> across all potential allocations.
Repeat the process until all units are assigned.
</p>
<p>For any pair of treatments <code class="reqn">s</code> and <code class="reqn">t</code> among the <code class="reqn">K</code>
treatment groups, calculate the Mahalanobis distance by:
</p>
<p style="text-align: center;"><code class="reqn">M_{s,t}(n) = 2n/K/K(\hat{x}_1 -\hat{x}_2)^Tcov(x)^{-1}(\hat{x}_1 -\hat{x}_2)</code>
</p>

<p>In total, there are <code class="reqn">C_K^2</code> pairs of Mahalanobis
distances among <code class="reqn">K</code> treatment groups.Finally, calculate
the mean, the median or the maximum to represent the total imbalance.
</p>
<p>See the reference for more details.
</p>


<h3>Value</h3>

<p>An object of class &quot;ARMM&quot; is a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>assignment</code></td>
<td>
<p>Allocation of patients.</p>
</td></tr>
<tr><td><code>sample_size</code></td>
<td>
<p>The number of patients from treatment 1 to treatment <code class="reqn">K</code> respectively.</p>
</td></tr>
<tr><td><code>Mahalanobis_Distance</code></td>
<td>
<p>Mahalanobis distance among treatment groups .</p>
</td></tr>
</table>


<h3>References</h3>

<p>Yang H, Qin Y, Wang F, et al. Balancing covariates in multi-arm trials via adaptive randomization. Computational Statistics &amp; Data Analysis, 2023, 179: 107642. https://doi.org/10.1016/j.csda.2022.107642
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
#simulate covariates of patients
p &lt;- 6; n &lt;- 30
sigma &lt;- diag(p); mean &lt;- c(rep(0,p))
data &lt;- mvrnorm(n, mean, sigma)
covariate &lt;- as.data.frame(data)
#IF all the patients are not be allocated
ARMM(covariate = covariate, assignment = NA, K = 3, q = 0.75, method = 'mean')
#IF you had allocated partial patients
ARMM(covariate = covariate, assignment = c(1,2), K=4, q=0.75, method = 'max')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
