<!DOCTYPE html><html><head><title>Help for package ggspectra</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ggspectra}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ggspectra-package'><p>ggspectra: Extensions to 'ggplot2' for Radiation Spectra</p></a></li>
<li><a href='#A_label'><p>Absorbance axis labels</p></a></li>
<li><a href='#A_plot'><p>Create a complete ggplot for a filter spectrum.</p></a></li>
<li><a href='#Afr_label'><p>Absorptance axis labels</p></a></li>
<li><a href='#Afr_plot'><p>Create a complete ggplot for a filter spectrum.</p></a></li>
<li><a href='#autoplot.calibration_spct'><p>Create a complete ggplot for an irradiation calibration spectrum.</p></a></li>
<li><a href='#autoplot.cps_spct'><p>Create a complete ggplot for detector-counts per second spectra.</p></a></li>
<li><a href='#autoplot.filter_spct'><p>Create a complete ggplot for a filter spectrum.</p></a></li>
<li><a href='#autoplot.generic_spct'><p>Create a complete ggplot for generic spectral data.</p></a></li>
<li><a href='#autoplot.object_spct'><p>Create a complete ggplot for a object spectrum.</p></a></li>
<li><a href='#autoplot.raw_spct'><p>Create a complete ggplot for raw detector-counts spectra.</p></a></li>
<li><a href='#autoplot.reflector_spct'><p>Create a complete ggplot for a reflector spectrum.</p></a></li>
<li><a href='#autoplot.response_spct'><p>Create a complete ggplot for a response spectrum.</p></a></li>
<li><a href='#autoplot.source_spct'><p>Create a complete ggplot for light-source spectra.</p></a></li>
<li><a href='#autoplot.waveband'><p>Create a complete ggplot for a waveband descriptor.</p></a></li>
<li><a href='#autotitle'><p>Add title, subtitle and caption to a spectral plot</p></a></li>
<li><a href='#axis_labels'><p>Default text for axis labels</p></a></li>
<li><a href='#black_or_white'><p>Chose black vs. white color based on weighted mean of RGB channels</p></a></li>
<li><a href='#cal_plot'><p>Create a complete ggplot for an irradiation calibration spectrum.</p></a></li>
<li><a href='#color_chart'><p>Create a color checker chart</p></a></li>
<li><a href='#counts_label'><p>Raw-counts axis labels</p></a></li>
<li><a href='#cps_label'><p>Counts-per-second axis labels</p></a></li>
<li><a href='#cps_plot'><p>Create a complete ggplot for detector-counts per second spectra.</p></a></li>
<li><a href='#decode_annotations'><p>Merge user supplied annotations with default ones</p></a></li>
<li><a href='#decoration'><p>Add decorations to spectrum plot (private)</p></a></li>
<li><a href='#duration2character'><p>Convert lubridate duration objects to a string if possible</p></a></li>
<li><a href='#e_plot'><p>Create a complete ggplot for light-source spectra.</p></a></li>
<li><a href='#e_rsp_plot'><p>Create a complete ggplot for response spectra.</p></a></li>
<li><a href='#exponent2prefix'><p>SI unit prefixes</p></a></li>
<li><a href='#find_idfactor'><p>Find 'idfactor'</p></a></li>
<li><a href='#generic_plot'><p>Create a complete ggplot for generic spectral data.</p></a></li>
<li><a href='#geom_spct'><p>Spectral data plots.</p></a></li>
<li><a href='#GeomSpct'><p><code>Stat*</code> Objects</p></a></li>
<li><a href='#ggplot'><p>Create a new ggplot plot from spectral data.</p></a></li>
<li><a href='#multipliers_label'><p>Calibration multipliers axis labels</p></a></li>
<li><a href='#multiplot'><p>Multiple plot function</p></a></li>
<li><a href='#O_plot'><p>Create a complete ggplot for a object spectrum.</p></a></li>
<li><a href='#plot.generic_spct'><p>Deprecated plot methods</p></a></li>
<li><a href='#q_plot'><p>Create a complete ggplot for light-source spectra.</p></a></li>
<li><a href='#q_rsp_plot'><p>Create a complete ggplot for response spectra.</p></a></li>
<li><a href='#R_plot'><p>Create a complete ggplot for a reflector spectrum.</p></a></li>
<li><a href='#raw_plot'><p>Create a complete ggplot for raw detector-counts spectra.</p></a></li>
<li><a href='#Rfr_label'><p>Reflectance axis labels</p></a></li>
<li><a href='#s.e.irrad_label'><p>spectral irradiance axis labels</p></a></li>
<li><a href='#s.e.response_label'><p>spectral response and action axis labels</p></a></li>
<li><a href='#scale_x_energy_eV_continuous'><p>Energy per photon x-scale</p></a></li>
<li><a href='#scale_x_frequency_continuous'><p>Frequency x-scale</p></a></li>
<li><a href='#scale_x_wavenumber_continuous'><p>Wavenumber x-scale</p></a></li>
<li><a href='#scale_x_wl_continuous'><p>Wavelength x-scale</p></a></li>
<li><a href='#scale_y_A_continuous'><p>Absorbance y-scale</p></a></li>
<li><a href='#scale_y_Afr_continuous'><p>Absorptance y-scale</p></a></li>
<li><a href='#scale_y_counts_continuous'><p>Raw-counts y-scale</p></a></li>
<li><a href='#scale_y_cps_continuous'><p>Counts-per-second  y-scale</p></a></li>
<li><a href='#scale_y_multipliers_continuous'><p>Calibration multipliers y-scale</p></a></li>
<li><a href='#scale_y_Rfr_continuous'><p>Reflectance y-scale</p></a></li>
<li><a href='#scale_y_s.e.irrad_continuous'><p>Spectral irradiance y-scale</p></a></li>
<li><a href='#scale_y_s.e.response_continuous'><p>Spectral response and action y-scales</p></a></li>
<li><a href='#scale_y_Tfr_continuous'><p>Transmittance y-scale</p></a></li>
<li><a href='#sec_axis_w_number'><p>Secondary axes for wavelengths</p></a></li>
<li><a href='#set_annotations_default'><p>Set defaults for autoplot annotations</p></a></li>
<li><a href='#SI_pl_format'><p>Formatter for plain labels discounting for SI multipliers</p></a></li>
<li><a href='#SI_tg_format'><p>Formatter for tagged labels using SI multipliers</p></a></li>
<li><a href='#stat_color'><p>Calculate colours from wavelength.</p></a></li>
<li><a href='#stat_find_qtys'><p>Find quantity value for target wavelength value.</p></a></li>
<li><a href='#stat_find_wls'><p>Find wavelength for target quantity value.</p></a></li>
<li><a href='#stat_label_peaks'><p>Label peaks and valleys.</p></a></li>
<li><a href='#stat_peaks'><p>Find peaks and valleys.</p></a></li>
<li><a href='#stat_spikes'><p>Find spikes</p></a></li>
<li><a href='#stat_wb_box'><p>Draw colour boxes for wavebands</p></a></li>
<li><a href='#stat_wb_column'><p>Integrate ranges under curve.</p></a></li>
<li><a href='#stat_wb_contribution'><p>Integrate ranges under spectral curve.</p></a></li>
<li><a href='#stat_wb_hbar'><p>Integrate ranges under curve.</p></a></li>
<li><a href='#stat_wb_irrad'><p>Integrate irradiance for wavebands.</p></a></li>
<li><a href='#stat_wb_label'><p>Label ranges under spectral curve.</p></a></li>
<li><a href='#stat_wb_mean'><p>Integrate ranges under curve.</p></a></li>
<li><a href='#stat_wb_relative'><p>Integrate ranges under spectral curve.</p></a></li>
<li><a href='#stat_wb_sirrad'><p>Integrate spectral irradiance for wavebands.</p></a></li>
<li><a href='#stat_wb_total'><p>Integrate ranges under spectral curve.</p></a></li>
<li><a href='#stat_wl_strip'><p>Calculate colours from wavelength.</p></a></li>
<li><a href='#stat_wl_summary'><p>Average area under curve for regions.</p></a></li>
<li><a href='#subtitle_spct.generic_spct'><p>Build a plot subtitle from object metadata (deprecated!)</p></a></li>
<li><a href='#T_plot'><p>Create a complete ggplot for a filter spectrum.</p></a></li>
<li><a href='#Tfr_label'><p>Transmittance axis labels</p></a></li>
<li><a href='#title_spct'><p>Build a plot title from object metadata (deprecated!)</p></a></li>
<li><a href='#validate_idfactor'><p>Validate idfactor</p></a></li>
<li><a href='#w_length_label'><p>Wave- axis labels</p></a></li>
<li><a href='#w_number'><p>Deprecated functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extensions to 'ggplot2' for Radiation Spectra</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-20</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pedro J. Aphalo &lt;pedro.aphalo@helsinki.fi&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Additional annotations, stats, geoms and scales for plotting 
    "light" spectra with 'ggplot2', together with specializations of ggplot()
    and autoplot() methods for spectral data and waveband definitions
    stored in objects of classes defined in package 'photobiology'. Part of the 
    'r4photobiology' suite, Aphalo P. J. (2015) &lt;<a href="https://doi.org/10.19232%2Fuv4pb.2015.1.14">doi:10.19232/uv4pb.2015.1.14</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>TRUE</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0), photobiology (&ge; 0.10.16), ggplot2 (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>photobiologyWavebands (&ge; 0.5.1), scales (&ge; 1.2.0), ggrepel
(&ge; 0.9.2), lubridate (&ge; 1.9.0), rlang (&ge; 1.0.2), tibble (&ge;
3.1.5)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.38), rmarkdown (&ge; 2.13), magrittr (&ge; 2.0.3)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://docs.r4photobiology.info/ggspectra/">https://docs.r4photobiology.info/ggspectra/</a>,
<a href="https://github.com/aphalo/ggspectra/">https://github.com/aphalo/ggspectra/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/aphalo/ggspectra/issues/">https://github.com/aphalo/ggspectra/issues/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-20 22:45:29 UTC; aphalo</td>
</tr>
<tr>
<td>Author:</td>
<td>Pedro J. Aphalo <a href="https://orcid.org/0000-0003-3385-972X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Titta K. Kotilainen
    <a href="https://orcid.org/0000-0002-2822-9734"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-21 23:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='ggspectra-package'>ggspectra: Extensions to 'ggplot2' for Radiation Spectra</h2><span id='topic+ggspectra'></span><span id='topic+ggspectra-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Additional annotations, stats, geoms and scales for plotting &quot;light&quot; spectra with 'ggplot2', together with specializations of ggplot() and autoplot() methods for spectral data and waveband definitions stored in objects of classes defined in package 'photobiology'. Part of the 'r4photobiology' suite, Aphalo P. J. (2015) <a href="https://doi.org/10.19232/uv4pb.2015.1.14">doi:10.19232/uv4pb.2015.1.14</a>.
</p>


<h3>Details</h3>

<p>Package 'ggspectra' provides a set of stats, geoms and methods
extending packages 'ggplot2' and 'photobiology'. They easy the task of
plotting radiation-related spectra and of annotating the resulting plots with
labels and summary quantities derived from the spectral data.
</p>
<p>Plot methods automate in many respects the plotting of spectral data.
'ggplot2' compatible statistics make the addition of labels or plotting of
subject-area specific summaries possible as well as the addition of labels
and wvaelength-based colour to plots easy. Available summaries are most of
those relevant to photobiology. However, many of the functions in the package
are more generaly useful for plotting UV, VIS and NIR spectra of light
emission, transmittance, reflectance, absorptance, and responses.
</p>
<p>The available summary quantities are both simple statistical summaries and
response-weighted summaries. Simple derived quantities represent summaries of a
given range of wavelengths, and can be expressed either in energy or photon
based units. Derived biologically effective quantities are used to quantify
the effect of radiation on different organisms or processes within organisms.
These effects can range from damage to perception of informational light
signals. Additional features of spectra may be important and worthwhile
annotating in plots. Of these, local maxima (peaks) and minima (valleys)
present in spectral data can also be annotated with statistics made available
by the 'ggspectra' package.
</p>
<p>Package 'ggspectra' is useful solely for plotting spectral data as most
functions depend on the x aesthetic being mapped to a variable containing
wavelength values expressed in nanometres. It works well together with
some other extensions to package 'ggplot2' such as packages 'ggrepel' and
'cowplot'.
</p>
<p>This package is part of a suite of R packages for photobiological
calculations described at the
[r4photobiology](https://www.r4photobiology.info) web site.
</p>


<h3>Note</h3>

<p>This package makes use of the new features of 'ggplot2' &gt;= 2.0.0 that make
writing this kind of extensions easy and is consequently not
compatible with earlier versions of 'ggplot2'.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Pedro J. Aphalo <a href="mailto:pedro.aphalo@helsinki.fi">pedro.aphalo@helsinki.fi</a> (<a href="https://orcid.org/0000-0003-3385-972X">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Titta K. Kotilainen (<a href="https://orcid.org/0000-0002-2822-9734">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>Aphalo, Pedro J. (2015) The r4photobiology suite. UV4Plants Bulletin, 2015:1,
21-29. <a href="https://doi.org/10.19232/uv4pb.2015.1.14">doi:10.19232/uv4pb.2015.1.14</a>.
</p>
<p><code>ggplot2</code> web site at <a href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org/</a><br />
<code>ggplot2</code> source code at <a href="https://github.com/tidyverse/ggplot2">https://github.com/tidyverse/ggplot2</a><br />
Function <code>multiplot</code> from <a href="http://www.cookbook-r.com/">http://www.cookbook-r.com/</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://docs.r4photobiology.info/ggspectra/">https://docs.r4photobiology.info/ggspectra/</a>
</p>
</li>
<li> <p><a href="https://github.com/aphalo/ggspectra/">https://github.com/aphalo/ggspectra/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/aphalo/ggspectra/issues/">https://github.com/aphalo/ggspectra/issues/</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)

ggplot(sun.spct) + geom_line() + stat_peaks(span = NULL)

ggplot(sun.spct, aes(w.length, s.e.irrad)) + geom_line() +
  stat_peaks(span = 21, geom = "point", colour = "red") +
  stat_peaks(span = 51, geom = "text", colour = "red", vjust = -0.3,
             label.fmt = "%3.0f nm")

ggplot(polyester.spct, range = UV()) + geom_line()

plot(sun.spct)

plot(polyester.spct, UV_bands(), range = UV(),
     annotations = c("=", "segments", "labels"))

</code></pre>

<hr>
<h2 id='A_label'>Absorbance axis labels</h2><span id='topic+A_label'></span><span id='topic+A_internal_label'></span><span id='topic+A_total_label'></span>

<h3>Description</h3>

<p>Generate cps axis labels in SI units,
using SI scale factors. Output can be selected as character, expression (R
default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>A_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  Tfr.type
)

A_internal_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE
)

A_total_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="A_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="A_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expresion&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="A_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="A_label_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="A_label_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="A_label_+3A_tfr.type">Tfr.type</code></td>
<td>
<p>character, either &quot;total&quot; or &quot;internal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Note</h3>

<p>Default for <code>label.text</code> depends on the value passed as argument
to <code>Tfr.type</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
A_label(Tfr.type = "internal")
A_label(Tfr.type = "total")


A_internal_label()
A_internal_label(-3)
A_internal_label(format = "R.expression")
A_internal_label(format = "LaTeX")
A_internal_label(-3, format = "LaTeX")


A_total_label()
A_total_label(-3)
A_total_label(format = "R.expression")
A_total_label(format = "LaTeX")
A_total_label(-3, format = "LaTeX")

</code></pre>

<hr>
<h2 id='A_plot'>Create a complete ggplot for a filter spectrum.</h2><span id='topic+A_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a filter_spct
object showing spectral absorbance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>A_plot(
  spct,
  w.band,
  range,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  text.size,
  chroma.type,
  idfactor,
  facets,
  na.rm,
  ylim,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="A_plot_+3A_spct">spct</code></td>
<td>
<p>a filter_spct object</p>
</td></tr>
<tr><td><code id="A_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects</p>
</td></tr>
<tr><td><code id="A_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm)</p>
</td></tr>
<tr><td><code id="A_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels</p>
</td></tr>
<tr><td><code id="A_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="A_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="A_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="A_plot_+3A_geom">geom</code></td>
<td>
<p>character.</p>
</td></tr>
<tr><td><code id="A_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="A_plot_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="A_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="A_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="A_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="A_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="A_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot objects, and can be further manipulated.
</p>

<hr>
<h2 id='Afr_label'>Absorptance axis labels</h2><span id='topic+Afr_label'></span><span id='topic+Rfr_total_label'></span>

<h3>Description</h3>

<p>Generate cps axis labels in SI units,
using SI scale factors. Output can be selected as character, expression (R
default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Afr_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["Afr"]],
  scaled = FALSE,
  normalized = FALSE
)

Rfr_total_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Afr_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="Afr_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expresion&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="Afr_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="Afr_label_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="Afr_label_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Afr_label()
Afr_label(-2)
Afr_label(-3)
Afr_label(format = "R.expression")
Afr_label(format = "LaTeX")
Afr_label(-2, format = "LaTeX")


Rfr_total_label()
Rfr_total_label(-2)
Rfr_total_label(-3)
Rfr_total_label(format = "R.expression")
Rfr_total_label(format = "LaTeX")
Rfr_total_label(-3, format = "LaTeX")

</code></pre>

<hr>
<h2 id='Afr_plot'>Create a complete ggplot for a filter spectrum.</h2><span id='topic+Afr_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a filter_spct
object showing absorptance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Afr_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  text.size,
  chroma.type,
  idfactor,
  facets,
  ylim,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Afr_plot_+3A_spct">spct</code></td>
<td>
<p>a filter_spct object.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_geom">geom</code></td>
<td>
<p>character.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="Afr_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>

<hr>
<h2 id='autoplot.calibration_spct'>Create a complete ggplot for an irradiation calibration spectrum.</h2><span id='topic+autoplot.calibration_spct'></span><span id='topic+autoplot.calibration_mspct'></span>

<h3>Description</h3>

<p>These methods return a ggplot object with an annotated plot of a
calibration_spct object or of the spectra contained in a calibration_mspct
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'calibration_spct'
autoplot(
  object,
  ...,
  w.band = getOption("photobiology.plot.bands", default = list(UVC(), UVB(), UVA(),
    PhR())),
  range = NULL,
  unit.out = "ignored",
  pc.out = FALSE,
  label.qty = "mean",
  span = NULL,
  wls.target = "HM",
  annotations = NULL,
  geom = "line",
  time.format = "",
  tz = "UTC",
  norm = NULL,
  text.size = 2.5,
  idfactor = NULL,
  facets = FALSE,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)

## S3 method for class 'calibration_mspct'
autoplot(
  object,
  ...,
  range = NULL,
  unit.out = "ignored",
  norm = getOption("ggspectra.normalize", default = "skip"),
  pc.out = FALSE,
  plot.data = "as.is",
  idfactor = TRUE,
  facets = FALSE,
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.calibration_spct_+3A_object">object</code></td>
<td>
<p>a calibration_spct object or a calibration_mspct object.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_...">...</code></td>
<td>
<p>in the case of collections of spectra, additional arguments passed
to the plot methods for individual spectra, otherwise currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_unit.out">unit.out</code></td>
<td>
<p>character IGNORED.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_annotations">annotations</code></td>
<td>
<p>a character vector (&quot;summaries&quot; is ignored). For details
please see sections Plot Annotations and Title Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by
<code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_tz">tz</code></td>
<td>
<p>character Time zone to use for title and/or subtitle.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_norm">norm</code></td>
<td>
<p>numeric normalization wavelength (nm) or character string &quot;max&quot;
for normalization at the wavelength of highest peak.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the default
&quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped to the
spectra and the user needs to use 'ggplot2' functions to manually map an
aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="autoplot.calibration_spct_+3A_plot.data">plot.data</code></td>
<td>
<p>character Data to plot. Default is &quot;as.is&quot; plotting one line
per spectrum. When passing &quot;mean&quot;, &quot;median&quot;, &quot;sum&quot;, &quot;prod&quot;, var&quot;, &quot;sd&quot;,
&quot;se&quot; as argument all the spectra must contain data at the same wavelength
values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot object, and can be further manipulated.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+normalize">normalize</a></code>,
<code><a href="photobiology.html#topic+calibration_spct">calibration_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>,
<code><a href="photobiologyWavebands.html#topic+photobiologyWavebands-package">photobiologyWavebands-package</a></code> and
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>
</p>
<p>Other autoplot methods: 
<code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a>()</code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a>()</code>,
<code><a href="#topic+autoplot.object_spct">autoplot.object_spct</a>()</code>,
<code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a>()</code>,
<code><a href="#topic+autoplot.reflector_spct">autoplot.reflector_spct</a>()</code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a>()</code>,
<code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a>()</code>,
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a>()</code>,
<code><a href="#topic+set_annotations_default">set_annotations_default</a>()</code>
</p>

<hr>
<h2 id='autoplot.cps_spct'>Create a complete ggplot for detector-counts per second spectra.</h2><span id='topic+autoplot.cps_spct'></span><span id='topic+autoplot.cps_mspct'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a
response_spct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cps_spct'
autoplot(
  object,
  ...,
  w.band = getOption("photobiology.plot.bands", default = list(UVC(), UVB(), UVA(),
    PhR())),
  range = NULL,
  norm = "skip",
  unit.out = NULL,
  pc.out = FALSE,
  label.qty = "mean",
  span = NULL,
  wls.target = "HM",
  annotations = NULL,
  geom = "line",
  time.format = "",
  tz = "UTC",
  text.size = 2.5,
  idfactor = NULL,
  facets = FALSE,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)

## S3 method for class 'cps_mspct'
autoplot(
  object,
  ...,
  range = NULL,
  norm = "skip",
  unit.out = NULL,
  pc.out = FALSE,
  idfactor = TRUE,
  facets = FALSE,
  plot.data = "as.is",
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.cps_spct_+3A_object">object</code></td>
<td>
<p>a cps_spct object.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_...">...</code></td>
<td>
<p>in the case of collections of spectra, additional arguments passed
to the plot methods for individual spectra, otherwise currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_norm">norm</code></td>
<td>
<p>numeric normalization wavelength (nm) or character string
<code>"max"</code> for normalization at the wavelength of highest peak or
<code>"skip"</code> for no change to exisitng normalization in <code>object</code>.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_unit.out">unit.out</code></td>
<td>
<p>character IGNORED.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percent instead of fraction of one for
normalized spectral data.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_annotations">annotations</code></td>
<td>
<p>a character vector (&quot;summaries&quot; is ignored). For details
please see sections Plot Annotations and Title Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by <code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_tz">tz</code></td>
<td>
<p>character Time zone to use for title and/or subtitle.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="autoplot.cps_spct_+3A_plot.data">plot.data</code></td>
<td>
<p>character Data to plot. Default is &quot;as.is&quot; plotting one line
per spectrum. When passing &quot;mean&quot;, &quot;median&quot;, &quot;sum&quot;, &quot;prod&quot;, &quot;var&quot;, &quot;sd&quot;,
&quot;se&quot; as argument all the spectra must contain data at the same wavelength
values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that scales are expanded so as to make space for the annotations. The
object returned is a ggplot objects, and can be further manipulated.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+normalize">normalize</a></code>,
<code><a href="photobiology.html#topic+cps_spct">cps_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>,
<code><a href="photobiologyWavebands.html#topic+photobiologyWavebands-package">photobiologyWavebands-package</a></code> and
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>
</p>
<p>Other autoplot methods: 
<code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a>()</code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a>()</code>,
<code><a href="#topic+autoplot.object_spct">autoplot.object_spct</a>()</code>,
<code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a>()</code>,
<code><a href="#topic+autoplot.reflector_spct">autoplot.reflector_spct</a>()</code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a>()</code>,
<code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a>()</code>,
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a>()</code>,
<code><a href="#topic+set_annotations_default">set_annotations_default</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
autoplot(white_led.cps_spct)
autoplot(white_led.cps_spct, geom = "spct")
autoplot(white_led.cps_spct, norm = "max")

two_leds.mspct &lt;-
  cps_mspct(list("LED 1" = white_led.cps_spct,
                 "LED 2" = white_led.cps_spct / 2))
autoplot(two_leds.mspct)
autoplot(two_leds.mspct, idfactor = "Spectra")
autoplot(two_leds.mspct, plot.data = "mean")

</code></pre>

<hr>
<h2 id='autoplot.filter_spct'>Create a complete ggplot for a filter spectrum.</h2><span id='topic+autoplot.filter_spct'></span><span id='topic+autoplot.filter_mspct'></span>

<h3>Description</h3>

<p>These methods return a ggplot object with an annotated plot of a filter_spct
object or of the spectra contained in a filter_mspct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'filter_spct'
autoplot(
  object,
  ...,
  w.band = getOption("photobiology.plot.bands", default = list(UVC(), UVB(), UVA(),
    PhR())),
  range = NULL,
  norm = getOption("ggspectra.norm", default = "update"),
  plot.qty = getOption("photobiology.filter.qty", default = "transmittance"),
  pc.out = FALSE,
  label.qty = NULL,
  span = NULL,
  wls.target = "HM",
  annotations = NULL,
  geom = "line",
  time.format = "",
  tz = "UTC",
  text.size = 2.5,
  chroma.type = "CMF",
  idfactor = NULL,
  facets = FALSE,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)

## S3 method for class 'filter_mspct'
autoplot(
  object,
  ...,
  range = NULL,
  norm = getOption("ggspectra.norm", default = "update"),
  plot.qty = getOption("photobiology.filter.qty", default = "transmittance"),
  pc.out = FALSE,
  plot.data = "as.is",
  idfactor = TRUE,
  facets = FALSE,
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.filter_spct_+3A_object">object</code></td>
<td>
<p>a filter_spct object or a filter_mspct object.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_...">...</code></td>
<td>
<p>in the case of collections of spectra, additional arguments passed
to the autoplot methods for individual spectra, otherwise currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min and max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_norm">norm</code></td>
<td>
<p>numeric Normalization wavelength (nm) or character string &quot;max&quot;,
or &quot;min&quot; for normalization at the corresponding wavelength, &quot;update&quot; to
update the normalization after modifying units of expression, quantity
or range but respecting the previously used criterion, or &quot;skip&quot; to force
return of <code>object</code> unchanged.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_plot.qty">plot.qty</code></td>
<td>
<p>character string one of &quot;transmittance&quot; or &quot;absorbance&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centred at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_annotations">annotations</code></td>
<td>
<p>a character vector. For details please see sections Plot
Annotations and Title Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by <code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_tz">tz</code></td>
<td>
<p>character Time zone to use for title and/or subtitle.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="autoplot.filter_spct_+3A_plot.data">plot.data</code></td>
<td>
<p>character Data to plot. Default is &quot;as.is&quot; plotting one line
per spectrum. When passing &quot;mean&quot;, &quot;median&quot;, &quot;sum&quot;, &quot;prod&quot;, var&quot;, &quot;sd&quot;,
&quot;se&quot; as argument all the spectra must contain data at the same wavelength
values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ggplot object returned can be further manipulated and added to. Except
when no annotations are added, limits are set for the x-axis and y-axis
scales. The y scale limits are expanded to include all data, or at least to
the range of expected values. The plotting of absorbance is an exception as
the y-axis is not extended past 6 a.u. In the case of absorbance, values
larger than 6 a.u. are rarely meaningful due to stray light during
measurement. However, when transmittance values below the detection limit are
rounded to zero, and later converted into absorbance, values Inf a.u. result,
disrupting the plot. Scales are further expanded so as to make space for the
annotations.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+normalize">normalize</a></code>,
<code><a href="photobiology.html#topic+filter_spct">filter_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>,
<code><a href="photobiologyWavebands.html#topic+photobiologyWavebands-package">photobiologyWavebands-package</a></code> and
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>
</p>
<p>Other autoplot methods: 
<code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a>()</code>,
<code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a>()</code>,
<code><a href="#topic+autoplot.object_spct">autoplot.object_spct</a>()</code>,
<code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a>()</code>,
<code><a href="#topic+autoplot.reflector_spct">autoplot.reflector_spct</a>()</code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a>()</code>,
<code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a>()</code>,
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a>()</code>,
<code><a href="#topic+set_annotations_default">set_annotations_default</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
autoplot(yellow_gel.spct)
autoplot(yellow_gel.spct, geom = "spct")
autoplot(yellow_gel.spct, plot.qty = "transmittance")
autoplot(yellow_gel.spct, plot.qty = "absorptance")
autoplot(yellow_gel.spct, plot.qty = "absorbance")
autoplot(yellow_gel.spct, pc.out = TRUE)
autoplot(yellow_gel.spct, annotations = c("+", "wls"))

two_filters.mspct &lt;-
 filter_mspct(list("Yellow gel" = yellow_gel.spct,
                   "Polyester film" = polyester.spct))
autoplot(two_filters.mspct)
autoplot(two_filters.mspct, idfactor = "Spectra")
autoplot(two_filters.mspct, facets = TRUE)

</code></pre>

<hr>
<h2 id='autoplot.generic_spct'>Create a complete ggplot for generic spectral data.</h2><span id='topic+autoplot.generic_spct'></span><span id='topic+autoplot.generic_mspct'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a
generic_spct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'generic_spct'
autoplot(
  object,
  ...,
  y.name,
  ymin.name = NULL,
  ymax.name = NULL,
  ylab = ggplot2::waiver(),
  w.band = getOption("photobiology.plot.bands", default = list(UVC(), UVB(), UVA(),
    PhR())),
  range = NULL,
  label.qty = "none",
  span = NULL,
  wls.target = "HM",
  annotations = NULL,
  time.format = "",
  tz = "UTC",
  text.size = 2.5,
  idfactor = NULL,
  facets = FALSE,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)

## S3 method for class 'generic_mspct'
autoplot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.generic_spct_+3A_object">object</code></td>
<td>
<p>a cps_spct object.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_...">...</code></td>
<td>
<p>in the case of collections of spectra, additional arguments passed
to the plot methods for individual spectra, otherwise currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_y.name">y.name</code>, <code id="autoplot.generic_spct_+3A_ymin.name">ymin.name</code>, <code id="autoplot.generic_spct_+3A_ymax.name">ymax.name</code></td>
<td>
<p>character Names of the columns to be mapped
to the y aesthetic.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_ylab">ylab</code></td>
<td>
<p>character or expression The y-axis label.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_annotations">annotations</code></td>
<td>
<p>a character vector (&quot;summaries&quot; is ignored). For details
please see sections Plot Annotations and Title Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by <code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_tz">tz</code></td>
<td>
<p>character Time zone to use for title and/or subtitle.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits (expansion only!).</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.generic_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>No automatic plot method is possible for objects of class <code>generic_spct</code>
as this class is meant to be mainly used only as a pure base class for
derivation. A method is provided for <code>generic_spct</code> but not for
<code>generic_mspct</code> as <code>generic_mspct</code> objects can contain an
assortment of objects including <code>generic_spct</code> and classes derived from
<code>generic_spct</code> making the spectra are unlikely be suitable for plotting
in the same ggplot.
</p>
<p>Contrary to other autoplot methods, the method for <code>generic_spct</code> does
not supply defaults to several of its parameters and cannot be used simply by
calling it with the spectrum as argument. There are also limitations on which
annotations are accepted. On-the-fly normalization is not supported.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>
<p>A <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>Note</h3>

<p>Scales are expanded so as to make space for the annotations if these
are present. The object returned is a ggplot object, and can be further
manipulated.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+normalize">normalize</a></code>,
<code><a href="photobiology.html#topic+generic_spct">generic_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>,
<code><a href="photobiologyWavebands.html#topic+photobiologyWavebands-package">photobiologyWavebands-package</a></code>,
<code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code> and
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sun.generic_spct &lt;- as.generic_spct(sun.spct)
autoplot(sun.generic_spct, y.name = "s.q.irrad")
autoplot(sun.generic_spct, y.name = "s.q.irrad",
         annotations = "")
autoplot(sun.generic_spct, y.name = "s.q.irrad",
         annotations = "title:objt:when",
         ylab = s.q.irrad_label(unit.exponent = 0))
autoplot(sun.generic_spct, y.name = "s.e.irrad",
         annotations = "colour.guide")
autoplot(sun.generic_spct, y.name = "s.q.irrad",
         ylim = c(-1e-6, 4e-6))

</code></pre>

<hr>
<h2 id='autoplot.object_spct'>Create a complete ggplot for a object spectrum.</h2><span id='topic+autoplot.object_spct'></span><span id='topic+autoplot.object_mspct'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of an
object_spct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'object_spct'
autoplot(
  object,
  ...,
  w.band = getOption("photobiology.plot.bands", default = list(UVC(), UVB(), UVA(),
    PhR())),
  range = NULL,
  norm = "skip",
  plot.qty = "all",
  pc.out = FALSE,
  label.qty = NULL,
  span = NULL,
  wls.target = "HM",
  annotations = NULL,
  geom = NULL,
  time.format = "",
  tz = "UTC",
  stacked = plot.qty == "all",
  text.size = 2.5,
  chroma.type = "CMF",
  idfactor = NULL,
  facets = NULL,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)

## S3 method for class 'object_mspct'
autoplot(
  object,
  ...,
  range = NULL,
  norm = "update",
  plot.qty = getOption("photobiology.filter.qty", default = "all"),
  pc.out = FALSE,
  plot.data = "as.is",
  idfactor = TRUE,
  facets = plot.qty == "all",
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.object_spct_+3A_object">object</code></td>
<td>
<p>an object_spct object</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_...">...</code></td>
<td>
<p>in the case of collections of spectra, additional arguments passed
to the plot methods for individual spectra, otherwise currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm)</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_norm">norm</code></td>
<td>
<p>numeric Normalization wavelength (nm) or character string &quot;max&quot;,
or &quot;min&quot; for normalization at the corresponding wavelength, &quot;update&quot; to
update the normalization after modifying units of expression, quantity
or range but respecting the previously used criterion, or &quot;skip&quot; to force
return of <code>object</code> unchanged. Always skipped for
<code>plot.qty == "all"</code>, which is the default.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_plot.qty">plot.qty</code></td>
<td>
<p>character string, one of &quot;all&quot;, &quot;transmittance&quot;,
&quot;absorbance&quot;, &quot;absorptance&quot;, or &quot;reflectance&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_annotations">annotations</code></td>
<td>
<p>a character vector. For details please see sections Plot
Annotations and Title Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by
<code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_tz">tz</code></td>
<td>
<p>character Time zone to use for title and/or subtitle.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_stacked">stacked</code></td>
<td>
<p>logical Whether to use <code>position_stack()</code> or
<code>position_identity()</code>.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="autoplot.object_spct_+3A_plot.data">plot.data</code></td>
<td>
<p>character Data to plot. Default is &quot;as.is&quot; plotting one line
per spectrum. When passing &quot;mean&quot;, &quot;median&quot;, &quot;sum&quot;, &quot;prod&quot;, var&quot;, &quot;sd&quot;,
&quot;se&quot; as argument all the spectra must contain data at the same wavelength
values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ggplot object returned can be further manipulated and added to. Except
when no annotations are added, limits are set for the x-axis and y-axis
scales. The y scale limits are expanded to include all data, or at least to
the range of expected values. Scales are further expanded so as to make space
for the annotations. When all <code>"all"</code> quantities are plotted, a single
set of spectra is accepted as input.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>Note</h3>

<p>The method for collections of object spectra of length &gt; 1 is
implemented for <code>plot.qty = "all"</code> using facets. Other plot
quantities are handled by the methods for <code>filter_spct</code> and
<code>reflector_spct</code> objects after on-the-fly conversion.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+normalize">normalize</a></code>,
<code><a href="photobiology.html#topic+object_spct">object_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>,
<code><a href="photobiologyWavebands.html#topic+photobiologyWavebands-package">photobiologyWavebands-package</a></code> and
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>
</p>
<p>Other autoplot methods: 
<code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a>()</code>,
<code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a>()</code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a>()</code>,
<code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a>()</code>,
<code><a href="#topic+autoplot.reflector_spct">autoplot.reflector_spct</a>()</code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a>()</code>,
<code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a>()</code>,
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a>()</code>,
<code><a href="#topic+set_annotations_default">set_annotations_default</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
low_res.spct &lt;- thin_wl(Ler_leaf.spct,
                        max.wl.step = 20,
                        max.slope.delta = 0.01,
                        col.names = "Tfr")
autoplot(low_res.spct)
autoplot(low_res.spct, geom = "line")

two_leaves.mspct &lt;-
  object_mspct(list("Arabidopsis leaf 1" = low_res.spct,
                    "Arabidopsis leaf 2" = low_res.spct))
autoplot(two_leaves.mspct, idfactor = "Spectra")

</code></pre>

<hr>
<h2 id='autoplot.raw_spct'>Create a complete ggplot for raw detector-counts spectra.</h2><span id='topic+autoplot.raw_spct'></span><span id='topic+autoplot.raw_mspct'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a
raw_spct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'raw_spct'
autoplot(
  object,
  ...,
  w.band = getOption("photobiology.plot.bands", default = list(UVC(), UVB(), UVA(),
    PhR())),
  range = NULL,
  unit.out = "counts",
  pc.out = FALSE,
  label.qty = "mean",
  span = NULL,
  wls.target = "HM",
  annotations = NULL,
  geom = "line",
  time.format = "",
  tz = "UTC",
  norm = "skip",
  text.size = 2.5,
  idfactor = NULL,
  facets = FALSE,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)

## S3 method for class 'raw_mspct'
autoplot(
  object,
  ...,
  range = NULL,
  norm = getOption("ggspectra.norm", default = "skip"),
  unit.out = "counts",
  pc.out = FALSE,
  idfactor = TRUE,
  facets = FALSE,
  plot.data = "as.is",
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.raw_spct_+3A_object">object</code></td>
<td>
<p>a raw_spct object.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_...">...</code></td>
<td>
<p>in the case of collections of spectra, additional arguments passed
to the plot methods for individual spectra, otherwise currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2,
with min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_unit.out">unit.out</code></td>
<td>
<p>character IGNORED.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percent instead of fraction of one for
normalized spectral data.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_annotations">annotations</code></td>
<td>
<p>a character vector (&quot;summaries&quot; is ignored). For details
please see sections Plot Annotations and Title Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by <code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_tz">tz</code></td>
<td>
<p>character Time zone to use for title and/or subtitle.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_norm">norm</code></td>
<td>
<p>numeric normalization wavelength (nm) or character string &quot;max&quot;
for normalization at the wavelength of highest peak.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="autoplot.raw_spct_+3A_plot.data">plot.data</code></td>
<td>
<p>character Data to plot. Default is &quot;as.is&quot; plotting one line
per spectrum. When passing &quot;mean&quot;, &quot;median&quot;, &quot;sum&quot;, &quot;prod&quot;, &quot;var&quot;, &quot;sd&quot;,
&quot;se&quot; as argument all the spectra must contain data at the same wavelength
values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot objects, and can be further manipulated.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+normalize">normalize</a></code>,
<code><a href="photobiology.html#topic+raw_spct">raw_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>,
<code><a href="photobiologyWavebands.html#topic+photobiologyWavebands-package">photobiologyWavebands-package</a></code> and
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>
</p>
<p>Other autoplot methods: 
<code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a>()</code>,
<code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a>()</code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a>()</code>,
<code><a href="#topic+autoplot.object_spct">autoplot.object_spct</a>()</code>,
<code><a href="#topic+autoplot.reflector_spct">autoplot.reflector_spct</a>()</code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a>()</code>,
<code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a>()</code>,
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a>()</code>,
<code><a href="#topic+set_annotations_default">set_annotations_default</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
low_res.raw_spct &lt;- thin_wl(white_led.raw_spct,
                            max.wl.step = 20,
                            max.slope.delta = 0.05,
                            col.names = "counts_3")
autoplot(low_res.raw_spct)
autoplot(low_res.raw_spct, annotations = "")

two_leds.mspct &lt;-
  raw_mspct(list("LED 1" = low_res.raw_spct,
                 "LED 2" = low_res.raw_spct))
autoplot(two_leds.mspct)
autoplot(two_leds.mspct, facets = 1) # one column

</code></pre>

<hr>
<h2 id='autoplot.reflector_spct'>Create a complete ggplot for a reflector spectrum.</h2><span id='topic+autoplot.reflector_spct'></span><span id='topic+autoplot.reflector_mspct'></span>

<h3>Description</h3>

<p>These methods return a ggplot object with an annotated plot of a
reflector_spct object or of the spectra contained in a reflector_mspct
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'reflector_spct'
autoplot(
  object,
  ...,
  w.band = getOption("photobiology.plot.bands", default = list(UVC(), UVB(), UVA(),
    PhR())),
  range = NULL,
  norm = getOption("ggspectra.norm", default = "update"),
  plot.qty = getOption("photobiology.reflector.qty", default = "reflectance"),
  pc.out = FALSE,
  label.qty = NULL,
  span = NULL,
  wls.target = "HM",
  annotations = NULL,
  geom = "line",
  time.format = "",
  tz = "UTC",
  text.size = 2.5,
  chroma.type = "CMF",
  idfactor = NULL,
  facets = FALSE,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)

## S3 method for class 'reflector_mspct'
autoplot(
  object,
  ...,
  range = NULL,
  norm = getOption("ggspectra.normalize", default = "update"),
  plot.qty = getOption("photobiology.reflector.qty", default = "reflectance"),
  pc.out = FALSE,
  plot.data = "as.is",
  idfactor = TRUE,
  facets = FALSE,
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.reflector_spct_+3A_object">object</code></td>
<td>
<p>a reflector_spct object or a reflector_mspct object.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_...">...</code></td>
<td>
<p>in the case of collections of spectra, additional arguments passed
to the plot methods for individual spectra, otherwise currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_norm">norm</code></td>
<td>
<p>numeric Normalization wavelength (nm) or character string &quot;max&quot;,
or &quot;min&quot; for normalization at the corresponding wavelength, &quot;update&quot; to
update the normalization after modifying units of expression, quantity
or range but respecting the previously used criterion, or &quot;skip&quot; to force
return of <code>object</code> unchanged.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_plot.qty">plot.qty</code></td>
<td>
<p>character string (currently ignored).</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_annotations">annotations</code></td>
<td>
<p>a character vector. For details please see sections Plot
Annotations and Title Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by
<code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_tz">tz</code></td>
<td>
<p>character Time zone to use for title and/or subtitle.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="autoplot.reflector_spct_+3A_plot.data">plot.data</code></td>
<td>
<p>character Data to plot. Default is &quot;as.is&quot; plotting one line
per spectrum. When passing &quot;mean&quot;, &quot;median&quot;, &quot;sum&quot;, &quot;prod&quot;, &quot;var&quot;, &quot;sd&quot;,
&quot;se&quot; as argument all the spectra must contain data at the same wavelength
values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ggplot object returned can be further manipulated and added to. Except
when no annotations are added, limits are set for the x-axis and y-axis
scales. The y scale limits are expanded to include all data, or at least to
the range of expected values. Scales are further expanded so as to make space
for the annotations.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+normalize">normalize</a></code>,
<code><a href="photobiology.html#topic+reflector_spct">reflector_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>,
<code><a href="photobiologyWavebands.html#topic+photobiologyWavebands-package">photobiologyWavebands-package</a></code> and
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>
</p>
<p>Other autoplot methods: 
<code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a>()</code>,
<code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a>()</code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a>()</code>,
<code><a href="#topic+autoplot.object_spct">autoplot.object_spct</a>()</code>,
<code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a>()</code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a>()</code>,
<code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a>()</code>,
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a>()</code>,
<code><a href="#topic+set_annotations_default">set_annotations_default</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
autoplot(Ler_leaf_rflt.spct)
autoplot(Ler_leaf_rflt.spct, geom = "spct")
autoplot(Ler_leaf_rflt.spct, annotations = c("+", "valleys"))

two_leaves.mspct &lt;-
 reflector_mspct(list("Arabidopsis leaf 1" = Ler_leaf_rflt.spct,
                      "Arabidopsis leaf 2" = Ler_leaf_rflt.spct / 2))
autoplot(two_leaves.mspct)
autoplot(two_leaves.mspct, idfactor = "Spectra")
autoplot(two_leaves.mspct, facets = 2)

</code></pre>

<hr>
<h2 id='autoplot.response_spct'>Create a complete ggplot for a response spectrum.</h2><span id='topic+autoplot.response_spct'></span><span id='topic+autoplot.response_mspct'></span>

<h3>Description</h3>

<p>These methods return a ggplot object with an annotated plot of a
response_spct object or of the spectra contained in a response_mspct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'response_spct'
autoplot(
  object,
  ...,
  w.band = getOption("photobiology.plot.bands", default = list(UVC(), UVB(), UVA(),
    PhR())),
  range = NULL,
  norm = getOption("ggspectra.norm", default = "max"),
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  pc.out = FALSE,
  label.qty = NULL,
  span = NULL,
  wls.target = "HM",
  annotations = NULL,
  geom = "line",
  time.format = "",
  tz = "UTC",
  text.size = 2.5,
  idfactor = NULL,
  facets = FALSE,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)

## S3 method for class 'response_mspct'
autoplot(
  object,
  ...,
  range = NULL,
  norm = getOption("ggspectra.norm", default = "max"),
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  pc.out = FALSE,
  plot.data = "as.is",
  facets = FALSE,
  idfactor = TRUE,
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.response_spct_+3A_object">object</code></td>
<td>
<p>a response_spct object or a response_mspct object.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_...">...</code></td>
<td>
<p>in the case of collections of spectra, additional arguments passed
to the plot methods for individual spectra, otherwise currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_norm">norm</code></td>
<td>
<p>numeric normalization wavelength (nm) or character string <code>"max"</code>
for normalization at the wavelength of highest peak, or <code>NULL</code> for
plotting the spectrum as is.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_unit.out">unit.out</code></td>
<td>
<p>character string indicating type of radiation units to use
for plotting: &quot;photon&quot; or its synomin &quot;quantum&quot;, or &quot;energy&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percent instead of fraction of one for
normalized spectral data.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_annotations">annotations</code></td>
<td>
<p>a character vector. For details please see sections Plot
Annotations and Title Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by
<code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_tz">tz</code></td>
<td>
<p>character Time zone to use for title and/or subtitle.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="autoplot.response_spct_+3A_plot.data">plot.data</code></td>
<td>
<p>character Data to plot. Default is &quot;as.is&quot; plotting one line
per spectrum. When passing &quot;mean&quot;, &quot;median&quot;, &quot;sum&quot;, &quot;prod&quot;, &quot;var&quot;, &quot;sd&quot;,
&quot;se&quot; as argument all the spectra must contain data at the same wavelength
values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that scales are expanded so as to make space for the annotations. The
object returned is a ggplot object, and can be further manipulated and added
to.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+normalize">normalize</a></code>,
<code><a href="photobiology.html#topic+response_spct">response_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>,
<code><a href="photobiologyWavebands.html#topic+photobiologyWavebands-package">photobiologyWavebands-package</a></code> and
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>
</p>
<p>Other autoplot methods: 
<code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a>()</code>,
<code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a>()</code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a>()</code>,
<code><a href="#topic+autoplot.object_spct">autoplot.object_spct</a>()</code>,
<code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a>()</code>,
<code><a href="#topic+autoplot.reflector_spct">autoplot.reflector_spct</a>()</code>,
<code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a>()</code>,
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a>()</code>,
<code><a href="#topic+set_annotations_default">set_annotations_default</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
autoplot(photodiode.spct)
autoplot(photodiode.spct, geom = "spct")
autoplot(photodiode.spct, unit.out = "photon")
autoplot(photodiode.spct, annotations = "")
autoplot(photodiode.spct, norm = "skip")
autoplot(photodiode.spct, norm = 400)

two_sensors.mspct &lt;-
 response_mspct(list("Photodiode" = photodiode.spct,
                     "Coupled charge device" = ccd.spct))
autoplot(two_sensors.mspct, normalize = TRUE, unit.out = "photon")
autoplot(two_sensors.mspct, normalize = TRUE, idfactor = "Spectra")
autoplot(two_sensors.mspct, normalize = TRUE, facets = 2)
autoplot(two_sensors.mspct, normalize = TRUE, geom = "spct")

</code></pre>

<hr>
<h2 id='autoplot.source_spct'>Create a complete ggplot for light-source spectra.</h2><span id='topic+autoplot.source_spct'></span><span id='topic+autoplot.source_mspct'></span>

<h3>Description</h3>

<p>These methods return a ggplot object with an annotated plot of a source_spct
object or of the spectra contained in a source_mspct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'source_spct'
autoplot(
  object,
  ...,
  w.band = getOption("photobiology.plot.bands", default =
    list(photobiologyWavebands::UVC(), photobiologyWavebands::UVB(),
    photobiologyWavebands::UVA(), photobiologyWavebands::PhR())),
  range = NULL,
  norm = getOption("ggspectra.norm", default = "update"),
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  pc.out = FALSE,
  label.qty = NULL,
  span = NULL,
  wls.target = "HM",
  annotations = NULL,
  geom = "line",
  time.format = "",
  tz = "UTC",
  text.size = 2.5,
  chroma.type = "CMF",
  idfactor = NULL,
  facets = FALSE,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)

## S3 method for class 'source_mspct'
autoplot(
  object,
  ...,
  range = NULL,
  norm = getOption("ggspectra.normalize", default = "update"),
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  pc.out = FALSE,
  idfactor = TRUE,
  facets = FALSE,
  plot.data = "as.is",
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.source_spct_+3A_object">object</code></td>
<td>
<p>a source_spct or a source_mspct object.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_...">...</code></td>
<td>
<p>in the case of collections of spectra, additional arguments passed
to the plot methods for individual spectra, otherwise currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_norm">norm</code></td>
<td>
<p>numeric Normalization wavelength (nm) or character string &quot;max&quot;,
or &quot;min&quot; for normalization at the corresponding wavelength, &quot;update&quot; to
update the normalization after modifying units of expression, quantity
or range but respecting the previously used criterion, or &quot;skip&quot; to force
return of <code>object</code> unchanged.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_unit.out">unit.out</code></td>
<td>
<p>character string indicating type of radiation units to use
for plotting: &quot;photon&quot; or its synonym &quot;quantum&quot;, or &quot;energy&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percent instead of fraction of one for
normalized spectral data.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_annotations">annotations</code></td>
<td>
<p>a character vector. For details please see sections Plot
Annotations and Title Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by
<code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_tz">tz</code></td>
<td>
<p>character Time zone to use for title and/or subtitle.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct level of the factor.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="autoplot.source_spct_+3A_plot.data">plot.data</code></td>
<td>
<p>character Data to plot. Default is &quot;as.is&quot; plotting one line
per spectrum. When passing &quot;mean&quot;, &quot;median&quot;, &quot;sum&quot;, &quot;prod&quot;, var&quot;, &quot;sd&quot;,
&quot;se&quot; as argument all the spectra must contain data at the same wavelength
values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that scales are expanded so as to make space for the annotations. The
object returned is a ggplot object, and can be further manipulated and added
to.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>Note</h3>

<p>If <code>idfactor = NULL</code>, the default for single spectra, the name of
the factor is retrieved from metadata or if no metadata found, the default
&quot;spct.idx&quot; is tried. The default for collections of spectra is to create
a factor named &quot;spct.idx&quot;, but if a different name is passed, it will be
used instead.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+normalize">normalize</a></code>,
<code><a href="photobiology.html#topic+source_spct">source_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>,
<code><a href="photobiologyWavebands.html#topic+photobiologyWavebands-package">photobiologyWavebands-package</a></code> and
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code>
</p>
<p>Other autoplot methods: 
<code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a>()</code>,
<code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a>()</code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a>()</code>,
<code><a href="#topic+autoplot.object_spct">autoplot.object_spct</a>()</code>,
<code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a>()</code>,
<code><a href="#topic+autoplot.reflector_spct">autoplot.reflector_spct</a>()</code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a>()</code>,
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a>()</code>,
<code><a href="#topic+set_annotations_default">set_annotations_default</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
autoplot(sun.spct)
autoplot(sun.spct, geom = "spct")
autoplot(sun.spct, unit.out = "photon")
autoplot(sun.spct, norm = "max")

two_suns.mspct &lt;- source_mspct(list(sun1 = sun.spct, sun2 = sun.spct / 2))
autoplot(two_suns.mspct)
autoplot(two_suns.mspct, facets = 1) # one column
autoplot(two_suns.mspct, facets = 2) # two columns
autoplot(two_suns.mspct, plot.data = "mean")

</code></pre>

<hr>
<h2 id='autoplot.waveband'>Create a complete ggplot for a waveband descriptor.</h2><span id='topic+autoplot.waveband'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a
<code>waveband</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'waveband'
autoplot(
  object,
  ...,
  w.length = NULL,
  range = c(280, 800),
  fill = 0,
  span = NULL,
  wls.target = "HM",
  unit.in = getOption("photobiology.radiation.unit", default = "energy"),
  annotations = NULL,
  geom = "line",
  wb.trim = TRUE,
  norm = NULL,
  text.size = 2.5,
  ylim = c(NA, NA),
  object.label = deparse(substitute(object)),
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autoplot.waveband_+3A_object">object</code></td>
<td>
<p>a waveband object.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_w.length">w.length</code></td>
<td>
<p>numeric vector of wavelengths (nm)</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_fill">fill</code></td>
<td>
<p>value to use as response for wavelngths outside the waveband
range.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_unit.in">unit.in</code></td>
<td>
<p>the type of unit we assume as reference &quot;energy&quot; or &quot;photon&quot;
based.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_annotations">annotations</code></td>
<td>
<p>a character vector. For details please see section Plot
Annotations.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_wb.trim">wb.trim</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_norm">norm</code></td>
<td>
<p>numeric normalization wavelength (nm) or character string &quot;max&quot;
for normalization at the wavelength of highest peak.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autoplot.waveband_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that scales are expanded so as to make space for the annotations. The
object returned is a ggplot object, and can be further manipulated.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Note</h3>

<p>Effectiveness spectra are plotted expressing the spectral effectiveness
either as <code class="reqn">1 mol^{-1} nm</code> photons of <code class="reqn">1 J^{-1} nm</code> which can selected through
formal argument <code>unit.out</code>. The value of <code>unit.in</code> has no effect on
the result when uisng BSWFs, as BSWFs are defined based on a certain base of
expression, which is enforced. In contrast, for wavebands which only define a
wavelength range, changing the assumed reference irradiance, changes the
responsivity according to Plank's law.
</p>
<p>This function creates a <code>response_spct</code> object from the <code>waveband</code>
object and plots it. Unused arguments are passed along, which means that
other plot aspects can be controlled by providing arguments for the plot
method of the <code>response_spct</code> class.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a></code>,
<code><a href="photobiology.html#topic+waveband">waveband</a></code>.
</p>
<p>Other autoplot methods: 
<code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a>()</code>,
<code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a>()</code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a>()</code>,
<code><a href="#topic+autoplot.object_spct">autoplot.object_spct</a>()</code>,
<code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a>()</code>,
<code><a href="#topic+autoplot.reflector_spct">autoplot.reflector_spct</a>()</code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a>()</code>,
<code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a>()</code>,
<code><a href="#topic+set_annotations_default">set_annotations_default</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
autoplot(waveband(c(400, 500)))
autoplot(waveband(c(400, 500)), geom = "spct")

</code></pre>

<hr>
<h2 id='autotitle'>Add title, subtitle and caption to a spectral plot</h2><span id='topic+autotitle'></span><span id='topic+ggtitle_spct'></span>

<h3>Description</h3>

<p>Add a title, subtitle and caption to a spectral plot based on automatically
extracted metadata from an spectral object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autotitle(
  object,
  object.label = deparse(substitute(object)),
  annotations = "title",
  time.format = "",
  tz = NULL,
  default.title = "title:objt"
)

ggtitle_spct(
  object,
  object.label = deparse(substitute(object)),
  annotations = "title",
  time.format = "",
  tz = NULL,
  default.title = "title:objt"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="autotitle_+3A_object">object</code></td>
<td>
<p>generic_spct The spectral object plotted.</p>
</td></tr>
<tr><td><code id="autotitle_+3A_object.label">object.label</code></td>
<td>
<p>character The name of the object being plotted.</p>
</td></tr>
<tr><td><code id="autotitle_+3A_annotations">annotations</code></td>
<td>
<p>character vector Annotations as described for
<code>plot()</code> methods, values unrelated to title are ignored.</p>
</td></tr>
<tr><td><code id="autotitle_+3A_time.format">time.format</code></td>
<td>
<p>character Format as accepted by
<code><a href="base.html#topic+strptime">strptime</a></code>.</p>
</td></tr>
<tr><td><code id="autotitle_+3A_tz">tz</code></td>
<td>
<p>character time zone used in labels.</p>
</td></tr>
<tr><td><code id="autotitle_+3A_default.title">default.title</code></td>
<td>
<p>character vector The default used for <code>annotations
= "title"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return value of <code>ggplot2::labs()</code>.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>Note</h3>

<p>Method renamed as <code>autotitle()</code> to better reflect its function;
<code>ggtitle_spct()</code> is deprecated but will remain available for backwards
compatibility.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
p &lt;- ggplot(sun.spct) +
  geom_line()

p + autotitle(sun.spct)
p + autotitle(sun.spct, annotations = "title:what")
p + autotitle(sun.spct, annotations = "title:where:when")
p + autotitle(sun.spct, annotations = "title:none:none:comment")

</code></pre>

<hr>
<h2 id='axis_labels'>Default text for axis labels</h2><span id='topic+axis_labels'></span><span id='topic+axis_labels_uk'></span><span id='topic+axis_labels_uk_comma'></span><span id='topic+axis_labels_none'></span>

<h3>Description</h3>

<p>Texts used by default for axis labels in plots are recalled from character
vectors returned by these functions. The aim is that their default values can
be easily changed or translated to other languages. They contain only the
text part, but not symbols or units of expression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>axis_labels()

axis_labels_uk()

axis_labels_uk_comma()

axis_labels_none()
</code></pre>


<h3>Details</h3>

<p>By default <code>axis_labes()</code> contains a copy of
<code>axis_labels_uk_comma()</code>. By assigning to this name a user function
that returns a named character vector using the same names as those
returned by these funtcions, it is possible to temporarily change
the default texts.
</p>


<h3>Value</h3>

<p>A character vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>axis_labels()[["w.length"]] # ending in a comma
axis_labels &lt;- axis_labels_uk
axis_labels()[["w.length"]] # no comma

</code></pre>

<hr>
<h2 id='black_or_white'>Chose black vs. white color based on weighted mean of RGB channels</h2><span id='topic+black_or_white'></span>

<h3>Description</h3>

<p>Chose black or white color based on a color to be used as background.
Usefull when using <code>geom_text</code> on top of tiles or bars, or
<code>geom_label</code> with a variable fill.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>black_or_white(colors, threshold = 0.45)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="black_or_white_+3A_colors">colors</code></td>
<td>
<p>character A vector of color definitions.</p>
</td></tr>
<tr><td><code id="black_or_white_+3A_threshold">threshold</code></td>
<td>
<p>numeric in range 0 to 1.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
black_or_white("red")
black_or_white(colors()[1:10])

</code></pre>

<hr>
<h2 id='cal_plot'>Create a complete ggplot for an irradiation calibration spectrum.</h2><span id='topic+cal_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a
calibration_spct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cal_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  norm,
  text.size,
  idfactor,
  facets,
  ylim,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cal_plot_+3A_spct">spct</code></td>
<td>
<p>a calibration_spct object</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm)</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_norm">norm</code></td>
<td>
<p>numeric Normalization wavelength (nm) or character string &quot;max&quot;,
or &quot;min&quot; for normalization at the corresponding wavelength, &quot;update&quot; to
update the normalization after modifying units of expression, quantity
or range but respecting the previously used criterion, or &quot;skip&quot; to force
return of <code>object</code> unchanged. Always skipped for
<code>plot.qty == "all"</code>, which is the default.</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="cal_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot object, and can be further manipulated.
When <code>spct</code> has more than one column with spectral data, each of these
columns is normalized individually.
</p>

<hr>
<h2 id='color_chart'>Create a color checker chart</h2><span id='topic+color_chart'></span>

<h3>Description</h3>

<p>Color-checker-chart ggplot labelled with color names or with indexes of the
colors in the vector passed as first argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>color_chart(
  colors = grDevices::colors(),
  ncol = NULL,
  use.names = NULL,
  text.size = 2,
  text.color = NULL,
  grid.color = "white"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="color_chart_+3A_colors">colors</code></td>
<td>
<p>character A vector of color definitions.</p>
</td></tr>
<tr><td><code id="color_chart_+3A_ncol">ncol</code></td>
<td>
<p>integer Number of column in the checker grid.</p>
</td></tr>
<tr><td><code id="color_chart_+3A_use.names">use.names</code></td>
<td>
<p>logical Force use of names or indexes.</p>
</td></tr>
<tr><td><code id="color_chart_+3A_text.size">text.size</code></td>
<td>
<p>numeric Size of the text labels drawn on each color tile.</p>
</td></tr>
<tr><td><code id="color_chart_+3A_text.color">text.color</code></td>
<td>
<p>character Color definition, used for text on tiles.</p>
</td></tr>
<tr><td><code id="color_chart_+3A_grid.color">grid.color</code></td>
<td>
<p>character Color definition, used for grid lines between
tiles.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Default <code>text.color</code> uses <code>black_or_white()</code> to ensure enough
contrast. Default for <code>use.names</code> depends on number of columns in the
grid, indexes are used when columns are seven or more.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
color_chart()
color_chart(grep("dark", colors(), value = TRUE), text.size = 3.5)

</code></pre>

<hr>
<h2 id='counts_label'>Raw-counts axis labels</h2><span id='topic+counts_label'></span>

<h3>Description</h3>

<p>Generate axis labels in SI units,
using SI scale factors. Output can be selected as character, expression (R
default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>counts_label(
  unit.exponent = 3,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["counts"]],
  scaled = FALSE,
  normalized = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="counts_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="counts_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expresion&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="counts_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="counts_label_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="counts_label_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
counts_label()
counts_label("R.expression")
counts_label("LaTeX")

</code></pre>

<hr>
<h2 id='cps_label'>Counts-per-second axis labels</h2><span id='topic+cps_label'></span>

<h3>Description</h3>

<p>Generate pixel response rate axis labels in cps units. Output can be selected
as character, expression (R default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cps_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["cps"]],
  scaled = FALSE,
  normalized = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cps_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="cps_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expresion&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="cps_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="cps_label_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="cps_label_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cps_label()
cps_label(3)
cps_label(format = "R.expression")
cps_label(format = "R.character")
cps_label(format = "LaTeX")
cps_label(3, format = "LaTeX")

</code></pre>

<hr>
<h2 id='cps_plot'>Create a complete ggplot for detector-counts per second spectra.</h2><span id='topic+cps_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a
cps_spct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cps_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  text.size,
  idfactor,
  facets,
  ylim,
  object.label,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cps_plot_+3A_spct">spct</code></td>
<td>
<p>a cps_spct object</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm)</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried.</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="cps_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that scales are expanded so as to make space for the annotations. The
object returned is a ggplot object, and can be further manipulated. When spct
has more than one column with spectral data, each of these columns is
normalized individually.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>

<hr>
<h2 id='decode_annotations'>Merge user supplied annotations with default ones</h2><span id='topic+decode_annotations'></span>

<h3>Description</h3>

<p>Allow users to add and subract from default annotations in addition
to providing a given set of annotations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decode_annotations(annotations, annotations.default = "colour.guide")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decode_annotations_+3A_annotations">annotations</code>, <code id="decode_annotations_+3A_annotations.default">annotations.default</code></td>
<td>
<p>character vector or a list of
character vectors.</p>
</td></tr>
</table>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>

<hr>
<h2 id='decoration'>Add decorations to spectrum plot (private)</h2><span id='topic+decoration'></span>

<h3>Description</h3>

<p>Add decorations to plots generated by the <code>autoplot()</code> methods defined in
this package. It collects code that is common to <code>autoplot()</code> methods for
different types of spectra but as it may change in the future it is not
exported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decoration(
  w.band,
  y.max,
  y.min,
  x.max,
  x.min,
  x.expanse = x.max - x.min,
  y.expanse = y.max - y.min,
  annotations,
  span,
  strict = is.null(span),
  wls.target = "HM",
  label.qty,
  label.mult = 1,
  summary.label,
  unit.out = NULL,
  time.unit = NULL,
  text.size = 2.5,
  label.color = NULL,
  chroma.type = "CMF",
  pos.shift = 0,
  na.rm = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decoration_+3A_w.band">w.band</code></td>
<td>
<p>waveband object or list of waveband objects</p>
</td></tr>
<tr><td><code id="decoration_+3A_y.max">y.max</code>, <code id="decoration_+3A_y.min">y.min</code>, <code id="decoration_+3A_x.max">x.max</code>, <code id="decoration_+3A_x.min">x.min</code>, <code id="decoration_+3A_x.expanse">x.expanse</code>, <code id="decoration_+3A_y.expanse">y.expanse</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="decoration_+3A_annotations">annotations</code></td>
<td>
<p>character vector</p>
</td></tr>
<tr><td><code id="decoration_+3A_span">span</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="decoration_+3A_strict">strict</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="decoration_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric or character vector</p>
</td></tr>
<tr><td><code id="decoration_+3A_label.qty">label.qty</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="decoration_+3A_summary.label">summary.label</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="decoration_+3A_text.size">text.size</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="decoration_+3A_label.color">label.color</code></td>
<td>
<p>color definition or name</p>
</td></tr>
<tr><td><code id="decoration_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="decoration_+3A_pos.shift">pos.shift</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="decoration_+3A_na.rm">na.rm</code></td>
<td>
<p>logical</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Vectors of character strings passed as argument to
<code>annotations</code> are parsed so that if the first member string is
<code>"+"</code>, the remaining members are added to the current default for
annotations; if it is <code>"-"</code> the remaining members are removed from the
current default for annotations; and if it is <code>"="</code> the remaining
members become the new default. If the first member is none of these three
strings, the whole vector becomes the new default. If <code>annotations</code> is
<code>NULL</code> the annotations are reset to the package defaults. When removing
annotations <code>"title*"</code>, <code>"peaks*"</code> and <code>"valleys*"</code> will
remove any variation of these annotations. The string <code>""</code> means no
annotations while <code>"reserve.space"</code> means no annotations but expand y
scale to reserve space for annotations. These two values take precedence over
any other values in the character vector. The order of the names of
annotations has no meaning: the vector is interpreted as a set except for the
three possible &quot;operators&quot; at position 1.
</p>


<h3>Value</h3>

<p>A list of ggplot &quot;components&quot; that can be added to a ggplot object
with operator <code>+</code>. The length of the list depends on the value of argument
<code>annotations</code>.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>

<hr>
<h2 id='duration2character'>Convert lubridate duration objects to a string if possible</h2><span id='topic+duration2character'></span>

<h3>Description</h3>

<p>Convert lubridate duration objects to a string if possible
</p>
<p>Convert lubridate duration objects to a string if possible
</p>


<h3>Usage</h3>

<pre><code class='language-R'>duration2character(time.unit)

duration2character(time.unit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="duration2character_+3A_time.unit">time.unit</code></td>
<td>
<p>lubridate::duration object or character</p>
</td></tr>
</table>

<hr>
<h2 id='e_plot'>Create a complete ggplot for light-source spectra.</h2><span id='topic+e_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a source_spct
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  text.size,
  chroma.type,
  idfactor,
  facets,
  ylim,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e_plot_+3A_spct">spct</code></td>
<td>
<p>a source_spct object.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="e_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percent instead of fraction of one for
normalized spectral data.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="e_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="e_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot objects, and can be further manipulated.
</p>

<hr>
<h2 id='e_rsp_plot'>Create a complete ggplot for response spectra.</h2><span id='topic+e_rsp_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a
response_spct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e_rsp_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  text.size,
  idfactor,
  facets,
  ylim,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e_rsp_plot_+3A_spct">spct</code></td>
<td>
<p>a response_spct object.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percent instead of fraction of one for
normalized spectral data.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="e_rsp_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot objects, and can be further manipulated.
</p>

<hr>
<h2 id='exponent2prefix'>SI unit prefixes</h2><span id='topic+exponent2prefix'></span><span id='topic+exponent2factor'></span><span id='topic+exponent2prefix_name'></span><span id='topic+prefix_name2exponent'></span><span id='topic+prefix2exponent'></span><span id='topic+has_SI_prefix'></span><span id='topic+nearest_SI_exponent'></span>

<h3>Description</h3>

<p>Convert SI unit prefixes into exponents of ten of multipliers and vice-versa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exponent2prefix(
  exponent,
  char.set = getOption("photobiology.fancy.chars", default = "utf8")
)

exponent2factor(exponent = 0, if.zero.exponent = "1")

exponent2prefix_name(exponent)

prefix_name2exponent(name)

prefix2exponent(
  prefix,
  char.set = getOption("photobiology.fancy.chars", default = "utf8")
)

has_SI_prefix(exponent)

nearest_SI_exponent(exponent)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exponent2prefix_+3A_exponent">exponent</code></td>
<td>
<p>numeric The power of 10 of the unit multiplier.</p>
</td></tr>
<tr><td><code id="exponent2prefix_+3A_char.set">char.set</code></td>
<td>
<p>character How to encode Greek letters and other fancy
characters in prefixes: <code>"utf8"</code>, <code>"ascii"</code>, <code>"LaTeX"</code>.
The difference between <code>"utf8"</code> and <code>"ascii"</code> is that the first
uses UTF8 character &quot;micro&quot; (similar to Greek mu) and the second uses &quot;u&quot;.</p>
</td></tr>
<tr><td><code id="exponent2prefix_+3A_if.zero.exponent">if.zero.exponent</code></td>
<td>
<p>character string to return when exponent is equal to zero.</p>
</td></tr>
<tr><td><code id="exponent2prefix_+3A_name">name</code></td>
<td>
<p>character Long SI name of multiplier.</p>
</td></tr>
<tr><td><code id="exponent2prefix_+3A_prefix">prefix</code></td>
<td>
<p>character Unit prefix used for multiplier.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>To change the default <code>char.set</code>, set R option
<code>"photobiology.fancy.chars"</code>. Implementation is based on a table of
data and extensible to any alphabet supported by R character objects by
expanding the table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
exponent2prefix(3)
exponent2prefix(0)
exponent2prefix(-6)


exponent2factor(3)
exponent2factor(0)
exponent2factor(0, NULL)
exponent2factor(0, "")
exponent2factor(-6)

</code></pre>

<hr>
<h2 id='find_idfactor'>Find 'idfactor'</h2><span id='topic+find_idfactor'></span>

<h3>Description</h3>

<p>Find if an 'idfactor' is present and needed in the plot and assemble a
suitable plot layer to handle it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_idfactor(
  spct,
  idfactor,
  annotations,
  facets = FALSE,
  num.columns = 1L,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_idfactor_+3A_spct">spct</code></td>
<td>
<p>generic_spct or derived object</p>
</td></tr>
<tr><td><code id="find_idfactor_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the default
&quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped to the
spectra and the user needs to use 'ggplot2' functions to manually map an
aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="find_idfactor_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="find_idfactor_+3A_facets">facets</code></td>
<td>
<p>logical or numeric Flag indicating if facets are to be created
when the data contains multiple spectra, if numeric the number of columns.</p>
</td></tr>
<tr><td><code id="find_idfactor_+3A_num.columns">num.columns</code></td>
<td>
<p>numeric Number of data columns from multiple scans. Relevant
only to <code>raw_spct</code> and <code>cps_spct</code> objects.</p>
</td></tr>
<tr><td><code id="find_idfactor_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing a list of ggplot components and a vector of
annotations names as members.
</p>

<hr>
<h2 id='generic_plot'>Create a complete ggplot for generic spectral data.</h2><span id='topic+generic_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a
generic_spct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generic_plot(
  spct,
  y.name,
  ymin.name,
  ymax.name,
  ylab,
  w.band,
  range,
  label.qty,
  span,
  wls.target,
  annotations,
  text.size,
  idfactor,
  facets,
  ylim,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generic_plot_+3A_spct">spct</code></td>
<td>
<p>a generic_spct object</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_y.name">y.name</code>, <code id="generic_plot_+3A_ymin.name">ymin.name</code>, <code id="generic_plot_+3A_ymax.name">ymax.name</code></td>
<td>
<p>character Names of the columns to be mapped
to the y aesthetic.</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_ylab">ylab</code></td>
<td>
<p>character or expression The y-axis label.</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm)</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried.</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="generic_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that scales are expanded so as to make space for the annotations. The
object returned is a ggplot object, and can be further manipulated. When spct
has more than one column with spectral data, each of these columns is
normalized individually.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>

<hr>
<h2 id='geom_spct'>Spectral data plots.</h2><span id='topic+geom_spct'></span>

<h3>Description</h3>

<p>For each continuous x value, <code>geom_spct</code> displays a y interval.
<code>geom_spct</code> is a special case of <code>geom_area</code>, where the minimum of
the range is fixed to 0, but stacking is not enabled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_spct(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_spct_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="geom_spct_+3A_data">data</code></td>
<td>
<p>A data frame. If specified, overrides the default data frame
defined at the top level of the plot.</p>
</td></tr>
<tr><td><code id="geom_spct_+3A_stat">stat</code></td>
<td>
<p>The statistical transformation to use on the data for this layer,
as a string.</p>
</td></tr>
<tr><td><code id="geom_spct_+3A_position">position</code></td>
<td>
<p>Position adjustment, either as a string, or the result of a
call to a position adjustment function.</p>
</td></tr>
<tr><td><code id="geom_spct_+3A_na.rm">na.rm</code></td>
<td>
<p>If FALSE (the default), removes missing values with a warning.
If TRUE silently removes missing values.</p>
</td></tr>
<tr><td><code id="geom_spct_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="geom_spct_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="geom_spct_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An spectrum plot is the analog of a line plot (see <code><a href="ggplot2.html#topic+geom_path">geom_path</a></code>),
and can be used to show how y varies over the range of x. The difference is that
the area under the line is filled.
</p>


<h3>Aesthetics</h3>

<p>See <code><a href="ggplot2.html#topic+geom_ribbon">geom_ribbon</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+geom_ribbon">geom_ribbon</a></code> for stacked areas,
<code><a href="ggplot2.html#topic+geom_path">geom_path</a></code> for lines (lines),
<code><a href="ggplot2.html#topic+geom_point">geom_point</a></code> for scatter plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) + geom_spct()

</code></pre>

<hr>
<h2 id='GeomSpct'><code>Stat*</code> Objects</h2><span id='topic+GeomSpct'></span><span id='topic+StatColor'></span><span id='topic+StatFindWls'></span><span id='topic+StatFindQty'></span><span id='topic+Stats'></span><span id='topic+StatLabelPeaks'></span><span id='topic+StatLabelValleys'></span><span id='topic+StatPeaks'></span><span id='topic+StatValleys'></span><span id='topic+StatSpikes'></span><span id='topic+StatWbBox'></span><span id='topic+wb_col_compute_group'></span><span id='topic+StatWbColumn'></span><span id='topic+StatWbContrib'></span><span id='topic+StatWbHbar'></span><span id='topic+StatWbIrrad'></span><span id='topic+StatWbLabel'></span><span id='topic+StatWbMean'></span><span id='topic+StatWbRelative'></span><span id='topic+StatWbSIrrad'></span><span id='topic+StatWbTotal'></span><span id='topic+StatColorGuide'></span><span id='topic+StatWlSummary'></span>

<h3>Description</h3>

<p>All <code>stat_*</code> functions (like <code>stat_bin</code>) return a layer that
contains a <code>Stat*</code> object (like <code>StatBin</code>). The <code>Stat*</code>
object is responsible for rendering the data in the plot.
</p>
<p>All <code>stat_*</code> functions (like <code>stat_bin</code>) return a layer that
contains a <code>Stat*</code> object (like <code>StatBin</code>). The <code>Stat*</code>
object is responsible for rendering the data in the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StatFindWls

StatFindQty

StatLabelValleys

StatValleys
</code></pre>


<h3>Format</h3>

<p>An object of class <code>StatFindWls</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 4.
</p>
<p>An object of class <code>StatFindQty</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 4.
</p>
<p>An object of class <code>StatLabelValleys</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 4.
</p>
<p>An object of class <code>StatValleys</code> (inherits from <code>Stat</code>, <code>ggproto</code>, <code>gg</code>) of length 4.
</p>


<h3>Details</h3>

<p>Each of the <code>Stat*</code> objects is a <code><a href="ggplot2.html#topic+ggproto">ggproto</a></code> object,
descended from the top-level <code>Stat</code>, and each implements various methods
and fields. To create a new type of Stat object, you typically will want to
implement one or more of the following:
</p>
<p>Each of the <code>Stat*</code> objects is a <code><a href="ggplot2.html#topic+ggproto">ggproto</a></code> object, descended
from the top-level <code>Stat</code>, and each implements various methods and
fields. To create a new type of Stat object, you typically will want to
implement one or more of the following:
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot2-ggproto">ggplot2-ggproto</a></code>
</p>
<p><code><a href="ggplot2.html#topic+ggplot2-ggproto">ggplot2-ggproto</a></code>
</p>
<p><code><a href="ggplot2.html#topic+ggplot2-ggproto">ggplot2-ggproto</a></code>
</p>
<p><code><a href="ggplot2.html#topic+ggplot2-ggproto">ggplot2-ggproto</a></code>
</p>

<hr>
<h2 id='ggplot'>Create a new ggplot plot from spectral data.</h2><span id='topic+ggplot'></span><span id='topic+ggplot.source_spct'></span><span id='topic+ggplot.response_spct'></span><span id='topic+ggplot.filter_spct'></span><span id='topic+ggplot.reflector_spct'></span><span id='topic+ggplot.cps_spct'></span><span id='topic+ggplot.calibration_spct'></span><span id='topic+ggplot.raw_spct'></span><span id='topic+ggplot.object_spct'></span><span id='topic+ggplot.generic_spct'></span><span id='topic+ggplot.generic_mspct'></span><span id='topic+ggplot.filter_mspct'></span><span id='topic+ggplot.source_mspct'></span><span id='topic+ggplot.object_mspct'></span>

<h3>Description</h3>

<p><code>ggplot()</code> initializes a ggplot object. It can be used to declare the
input spectral object for a graphic and to optionally specify the set of plot
aesthetics intended to be common throughout all subsequent layers unless
specifically overridden.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'source_spct'
ggplot(
  data,
  mapping = NULL,
  ...,
  range = NULL,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  environment = parent.frame()
)

## S3 method for class 'response_spct'
ggplot(
  data,
  mapping = NULL,
  ...,
  range = NULL,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  environment = parent.frame()
)

## S3 method for class 'filter_spct'
ggplot(
  data,
  mapping = NULL,
  ...,
  range = NULL,
  plot.qty = getOption("photobiology.filter.qty", default = "transmittance"),
  environment = parent.frame()
)

## S3 method for class 'reflector_spct'
ggplot(
  data,
  mapping = NULL,
  ...,
  range = NULL,
  plot.qty = NULL,
  environment = parent.frame()
)

## S3 method for class 'cps_spct'
ggplot(data, mapping = NULL, ..., range = NULL, environment = parent.frame())

## S3 method for class 'calibration_spct'
ggplot(data, mapping = NULL, ..., range = NULL, environment = parent.frame())

## S3 method for class 'raw_spct'
ggplot(data, mapping = NULL, ..., range = NULL, environment = parent.frame())

## S3 method for class 'object_spct'
ggplot(
  data,
  mapping = NULL,
  ...,
  range = NULL,
  plot.qty = getOption("photobiology.object.qty", default = "all"),
  environment = parent.frame()
)

## S3 method for class 'generic_spct'
ggplot(
  data,
  mapping = NULL,
  ...,
  range = NULL,
  spct_class,
  environment = parent.frame()
)

## S3 method for class 'generic_mspct'
ggplot(data, mapping = NULL, ..., range = NULL, environment = parent.frame())

## S3 method for class 'filter_mspct'
ggplot(
  data,
  mapping = NULL,
  ...,
  range = NULL,
  plot.qty = getOption("photobiology.filter.qty", default = "transmittance"),
  environment = parent.frame()
)

## S3 method for class 'source_mspct'
ggplot(
  data,
  mapping = NULL,
  ...,
  range = NULL,
  unit.out = getOption("photobiology.radiation.unit", default = "energy"),
  environment = parent.frame()
)

## S3 method for class 'object_mspct'
ggplot(
  data,
  mapping = NULL,
  ...,
  range = NULL,
  plot.qty = getOption("photobiology.object.qty", default = ifelse(length(data) &gt; 1L,
    "as.is", "all")),
  environment = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggplot_+3A_data">data</code></td>
<td>
<p>Default spectrum dataset to use for plot. If not a spectrum, the
methods used will be those defined in package <code>ggplot2</code>. See
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>. If not specified, must be supplied in each
layer added to the plot.</p>
</td></tr>
<tr><td><code id="ggplot_+3A_mapping">mapping</code></td>
<td>
<p>Default list of aesthetic mappings to use for plot. If not
specified, in the case of spectral objects, a default mapping will be used.</p>
</td></tr>
<tr><td><code id="ggplot_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
<tr><td><code id="ggplot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min and max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="ggplot_+3A_unit.out">unit.out</code></td>
<td>
<p>character string indicating type of units to use for
plotting spectral irradiance or spectral response, <code>"photon"</code> or
<code>"energy"</code>.</p>
</td></tr>
<tr><td><code id="ggplot_+3A_environment">environment</code></td>
<td>
<p>If a variable defined in the aesthetic mapping is not
found in the data, ggplot will look for it in this environment. It defaults
to using the environment in which <code>ggplot()</code> is called.</p>
</td></tr>
<tr><td><code id="ggplot_+3A_plot.qty">plot.qty</code></td>
<td>
<p>character string One of <code>"transmittance"</code>,
<code>"absorptance"</code> or <code>"absorbance"</code> for <code>filter_spct</code> objects,
and in addition to these <code>"reflectance"</code>, <code>"all"</code> or
<code>"as.is"</code> for <code>object_spct</code> objects.</p>
</td></tr>
<tr><td><code id="ggplot_+3A_spct_class">spct_class</code></td>
<td>
<p>character Class into which a <code>generic_spct</code> object
will be converted before plotting. The column names in data should
match those expected by the class constructor (see
<code><a href="photobiology.html#topic+setGenericSpct">setGenericSpct</a></code>); other arguments should be
passed by name).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ggplot()</code> is typically used to construct a plot incrementally, using
the <code>+</code> operator to add layers to the existing ggplot object. This is
advantageous in that the code is explicit about which layers are added and
the order in which they are added. For complex graphics with multiple layers,
initialization with <code>ggplot</code> is recommended.
</p>
<p>We show seven common ways to invoke <code>ggplot</code> for spectra and
collections of spectra:
</p>

<ul>
<li> <p><code>ggplot(spct)</code>
</p>
</li>
<li> <p><code>ggplot(spct, unit.out = &lt;unit.to.use&gt;)</code>
</p>
</li>
<li> <p><code>ggplot(spct, plot.qty = &lt;quantity.to.plot&gt;)</code>
</p>
</li>
<li> <p><code>ggplot(spct, range = &lt;wavelength.range&gt;)</code>
</p>
</li>
<li> <p><code>ggplot(spct) + aes(&lt;other aesthetics&gt;)</code>
</p>
</li>
<li> <p><code>ggplot(spct, aes(x, y, &lt;other aesthetics&gt;))</code>
</p>
</li>
<li> <p><code>ggplot(spct, aes())</code>
</p>
</li></ul>

<p>The first method is recommended if all layers use the same data and the same
set of automatic default x and y aesthetics. The second, third and fourth use
automatic default x and y aesthetics but first transform or trim the spectral
data to be plotted. The fifth uses automatic default x and y aesthetics and
adds mappings for other aesthetics. These patterns can be combined as needed.
The sixth disables the use of a default automatic mapping, while the seventh
delays the mapping of aesthetics and can be convenient when using different
mappings for different geoms.
</p>


<h3>Object spectra</h3>

<p>In the case of class object_spct, the arguments
<code>"all"</code> and <code>"as.is"</code> if passed to <code>plot.qty</code>, indicate in
the first case that the data are to be converted into long form, to allow
stacking, while in the second case <code>data</code> is copied unchanged to the
plot object. <code>"reflectance"</code> passed to <code>plot.qty</code> converts
<code>data</code> into a <code>replector_spct</code> object and <code>"absorbance"</code>,
<code>"absorptance"</code> and <code>"reflectance"</code>, convert <code>data</code> into a
<code>filter_spct</code>.
</p>


<h3>Collections of spectra</h3>

<p>The method for collections of spectra
accepts arguments for the same parameters as the corresponding methods for
single spectra. Heterogeneous generic collections of spectra are not
supported. When plotting collections of spectra the factor <code>spct.idx</code>
contains as levels the names of the individual members of the collection,
and can be mapped to aesthetics or used for faceting.
</p>


<h3>Note</h3>

<p>Current implementation does not merge the default mapping with user
supplied mapping. If user supplies a mapping, it is used as is, and
variables should be present in the spectral object. In contrast, when using
the default mapping, unit or quantity conversions are done on the fly when
needed. To add to the default mapping, <code>aes()</code> can be used by itself
to compose the ggplot. In all cases, except when an <code>object_spct</code> is
converted into long form, the data member of the returned plot object
retains its class and attributes.
</p>
<p>plot.qty is ignored for reflectors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(sun.spct) + geom_line()
ggplot(sun.spct, unit.out = "photon") + geom_line()

ggplot(yellow_gel.spct) + geom_line()
ggplot(yellow_gel.spct, plot.qty = "absorbance") + geom_line()

ggplot(Ler_leaf.spct) + facet_grid(~variable) + geom_line()
ggplot(Ler_leaf.spct) + aes(linetype = variable) + geom_line()

</code></pre>

<hr>
<h2 id='multipliers_label'>Calibration multipliers axis labels</h2><span id='topic+multipliers_label'></span>

<h3>Description</h3>

<p>Calibration multipliers axis labels. Output can be selected
as character, expression (R default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multipliers_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["e.mult"]],
  scaled = FALSE,
  normalized = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multipliers_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="multipliers_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expresion&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="multipliers_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="multipliers_label_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="multipliers_label_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
multipliers_label()
multipliers_label(3)
multipliers_label(format = "R.expression")
multipliers_label(format = "R.character")
multipliers_label(format = "LaTeX")
multipliers_label(3, format = "LaTeX")

</code></pre>

<hr>
<h2 id='multiplot'>Multiple plot function</h2><span id='topic+multiplot'></span>

<h3>Description</h3>

<p>Grid based; allows multiple plots arraged in a matrix and <code>print</code>ed to
any R device. ggplot objects can be passed in ..., or to plotlist (as a list
of ggplot objects)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiplot(
  ...,
  plotlist = NULL,
  ncol = 1,
  cols = ncol,
  layout = NULL,
  title = "",
  title.position = "left",
  title.fontsize = 12,
  title.fontfamily = "sans",
  title.fontface = "bold",
  title.colour = "black"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiplot_+3A_...">...</code></td>
<td>
<p>one or more ggplot objects.</p>
</td></tr>
<tr><td><code id="multiplot_+3A_plotlist">plotlist</code></td>
<td>
<p>list of ggplot objects.</p>
</td></tr>
<tr><td><code id="multiplot_+3A_ncol">ncol</code>, <code id="multiplot_+3A_cols">cols</code></td>
<td>
<p>numerical Number of columns in layout.</p>
</td></tr>
<tr><td><code id="multiplot_+3A_layout">layout</code></td>
<td>
<p>A numeric matrix specifying the layout. If present, 'cols' is
ignored.</p>
</td></tr>
<tr><td><code id="multiplot_+3A_title">title</code></td>
<td>
<p>character vector Title of the composite plot.</p>
</td></tr>
<tr><td><code id="multiplot_+3A_title.position">title.position</code></td>
<td>
<p>numeric or character, the horizontal position of the
title.</p>
</td></tr>
<tr><td><code id="multiplot_+3A_title.fontsize">title.fontsize</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="multiplot_+3A_title.fontfamily">title.fontfamily</code></td>
<td>
<p>character e.g. &quot;sans&quot;, &quot;serif&quot;, &quot;mono&quot;.</p>
</td></tr>
<tr><td><code id="multiplot_+3A_title.fontface">title.fontface</code></td>
<td>
<p>character e.g. &quot;plain&quot;, &quot;bold&quot;, &quot;italic&quot;, &quot;bold.italic&quot;.</p>
</td></tr>
<tr><td><code id="multiplot_+3A_title.colour">title.colour</code></td>
<td>
<p>character e.g. &quot;black&quot;, &quot;red&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ggplot objects can be passed in ..., or to plotlist (as a list of
ggplot objects) If the layout is something like matrix(c(1,2,3,3), nrow=2,
byrow=TRUE), then plot 1 will go in the upper left, 2 will go in the upper
right, and 3 will go all the way across the bottom.
</p>


<h3>Note</h3>

<p>Modified from example by Winston Chang found in the Cookbook for R
Licenced under CC BY-SA
</p>


<h3>References</h3>

<p><a href="http://www.cookbook-r.com/">http://www.cookbook-r.com/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
multiplot(plot(sun.spct), plot(yellow_gel.spct), ncol = 1)
multiplot(plot(sun.spct), plot(yellow_gel.spct), ncol = 1,
          title = "The sun and a yellow filter")

</code></pre>

<hr>
<h2 id='O_plot'>Create a complete ggplot for a object spectrum.</h2><span id='topic+O_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of an object_spct
displaying spectral transmittance, absorptance and reflectance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>O_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  stacked,
  text.size,
  chroma.type,
  facets,
  na.rm,
  ylim,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="O_plot_+3A_spct">spct</code></td>
<td>
<p>an object_spct object.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="O_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_geom">geom</code></td>
<td>
<p>character.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_stacked">stacked</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="O_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="O_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot object, and can be further manipulated.
</p>

<hr>
<h2 id='plot.generic_spct'>Deprecated plot methods</h2><span id='topic+plot.generic_spct'></span><span id='topic+plot.generic_mspct'></span><span id='topic+plot.waveband'></span>

<h3>Description</h3>

<p>These <code>plot()</code> methods return a ggplot object with an annotated plot of
an object of a class derived from <code>generic_spct</code>, of a class derived
from <code>generic_mspct</code> or of an object of class <code>waveband</code> for which
an <code>autoplot()</code> method exists. They are implemented as wrappers of
<code>autoplot()</code>. The generic for <code>plot()</code> is defined by base R and
specializations for objects of diverse classes are provided various packages
and R itself. The generic for <code>autoplot()</code> is defined by package
'ggplot2'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'generic_spct'
plot(x, ...)

## S3 method for class 'generic_mspct'
plot(x, ...)

## S3 method for class 'waveband'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.generic_spct_+3A_x">x</code></td>
<td>
<p>An R object derived from class <code>generic_spct</code> or derived
from class <code>generic_mspct</code>.</p>
</td></tr>
<tr><td><code id="plot.generic_spct_+3A_...">...</code></td>
<td>
<p>Named arguments passed to <code>autoplot()</code> methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Deprecation warning!</h3>

<p>These <code>plot()</code> specializatioms are provided for backwards
compatibility, but all new or updated code should call <code>autoplot()</code>
instead of <code>plot()</code> on objects of spectral and waveband classes defined
in package 'photobiology'.
</p>
<p>These methods add support for <code>plot()</code> specializations as these
specialization were provided by package 'ggspectra' years ago, before
'ggplot2' had an <code>autoplot()</code> generic. As these methods return ggplots
autoplot is a more suitable name for them.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a></code>,  <code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a></code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a></code>, <code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a></code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a></code>,  <code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a></code> and
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(sun.spct) # deprecated syntax, to be avoided
autoplot(sun.spct) # current syntax, to be used

</code></pre>

<hr>
<h2 id='q_plot'>Create a complete ggplot for light-source spectra.</h2><span id='topic+q_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a source_spct
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  text.size,
  chroma.type,
  idfactor,
  facets,
  ylim,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="q_plot_+3A_spct">spct</code></td>
<td>
<p>a source_spct object.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="q_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percent instead of fraction of one for
normalized spectral data.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector</p>
</td></tr>
<tr><td><code id="q_plot_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_facets">facets</code></td>
<td>
<p>logical Flag indicating if facets are to be created for the
levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in long
form.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="q_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="q_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot objects, and can be further manipulated.
</p>

<hr>
<h2 id='q_rsp_plot'>Create a complete ggplot for response spectra.</h2><span id='topic+q_rsp_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a
response_spct object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q_rsp_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  text.size,
  idfactor,
  facets,
  ylim,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="q_rsp_plot_+3A_spct">spct</code></td>
<td>
<p>a response_spct object.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percent instead of fraction of one for
normalized spectral data.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="q_rsp_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot objects, and can be further manipulated.
</p>

<hr>
<h2 id='R_plot'>Create a complete ggplot for a reflector spectrum.</h2><span id='topic+R_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a reflector_spct
reflectance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  text.size,
  chroma.type,
  idfactor,
  facets,
  ylim,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="R_plot_+3A_spct">spct</code></td>
<td>
<p>a filter_spct object</p>
</td></tr>
<tr><td><code id="R_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects</p>
</td></tr>
<tr><td><code id="R_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm)</p>
</td></tr>
<tr><td><code id="R_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one</p>
</td></tr>
<tr><td><code id="R_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels</p>
</td></tr>
<tr><td><code id="R_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="R_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="R_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="R_plot_+3A_geom">geom</code></td>
<td>
<p>character.</p>
</td></tr>
<tr><td><code id="R_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="R_plot_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="R_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="R_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="R_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="R_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="R_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot objects, and can be further manipulated.
</p>

<hr>
<h2 id='raw_plot'>Create a complete ggplot for raw detector-counts spectra.</h2><span id='topic+raw_plot'></span>

<h3>Description</h3>

<p>Plot method for spectra expressed as raw detector counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raw_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  relative,
  text.size,
  idfactor,
  facets,
  ylim,
  na.rm,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="raw_plot_+3A_spct">spct</code></td>
<td>
<p>a raw_spct object.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm).</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels, one of &quot;mean&quot;, &quot;total&quot;, &quot;contribution&quot;, and &quot;relative&quot;.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_geom">geom</code></td>
<td>
<p>character The name of a ggplot geometry, currently only
<code>"area"</code>, <code>"spct"</code> and <code>"line"</code>. The default <code>NULL</code>
selects between them based on <code>stacked</code>.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a ggplot object with an annotated plot of a
raw_spct object.
</p>
<p>Note that scales are expanded so as to make space for the annotations. The
object returned is a ggplot objects, and can be further manipulated. When
spct has more than one column with spectral data, each of these columns is
normalized individually.
</p>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>

<hr>
<h2 id='Rfr_label'>Reflectance axis labels</h2><span id='topic+Rfr_label'></span><span id='topic+Rfr_specular_label'></span>

<h3>Description</h3>

<p>Generate spectral reflectance labels in SI units,
using SI scale factors. Output can be selected as character, expression (R
default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rfr_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  Rfr.type
)

Rfr_specular_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Rfr_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="Rfr_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expresion&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="Rfr_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="Rfr_label_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="Rfr_label_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="Rfr_label_+3A_rfr.type">Rfr.type</code></td>
<td>
<p>character, either &quot;total&quot; or &quot;specular&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Note</h3>

<p>Default for <code>label.text</code> depends on the value passed as argument
to <code>Rfr.type</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Rfr_label(Rfr.type = "specular")
Rfr_label(Rfr.type = "total")


Rfr_specular_label()
Rfr_specular_label(-2)
Rfr_specular_label(-3)
Rfr_specular_label(format = "R.expression")
Rfr_specular_label(format = "LaTeX")
Rfr_specular_label(-3, format = "LaTeX")

</code></pre>

<hr>
<h2 id='s.e.irrad_label'>spectral irradiance axis labels</h2><span id='topic+s.e.irrad_label'></span><span id='topic+s.q.irrad_label'></span>

<h3>Description</h3>

<p>Generate axis labels in SI units,
using SI scale factors. Output can be selected as character, expression (R
default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s.e.irrad_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.e.irrad"]],
  scaled = FALSE,
  normalized = FALSE
)

s.q.irrad_label(
  unit.exponent = ifelse(normalized, 0, -6),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.q.irrad"]],
  scaled = FALSE,
  normalized = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s.e.irrad_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="s.e.irrad_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expresion&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="s.e.irrad_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="s.e.irrad_label_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="s.e.irrad_label_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
counts_label()
counts_label("R.expression")
counts_label("LaTeX")

</code></pre>

<hr>
<h2 id='s.e.response_label'>spectral response and action axis labels</h2><span id='topic+s.e.response_label'></span><span id='topic+s.q.response_label'></span><span id='topic+s.e.action_label'></span><span id='topic+s.q.action_label'></span>

<h3>Description</h3>

<p>Generate axis labels for response or action spectra in SI units,
using SI scale factors. Output can be selected as character, expression (R
default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s.e.response_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.e.response"]],
  scaled = FALSE,
  normalized = FALSE
)

s.q.response_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.q.response"]],
  scaled = FALSE,
  normalized = FALSE
)

s.e.action_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.e.action"]],
  scaled = FALSE,
  normalized = FALSE
)

s.q.action_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.q.action"]],
  scaled = FALSE,
  normalized = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s.e.response_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="s.e.response_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="s.e.response_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="s.e.response_label_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="s.e.response_label_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
s.e.response_label()
s.e.response_label(format = "R.expression")
s.e.response_label(format = "R.character")
s.e.response_label(format = "LaTeX")
s.e.response_label(unit.exponent = 3, format = "R.character")
s.q.response_label(format = "R.character")
s.e.action_label(format = "R.character")
s.q.action_label(format = "R.character")
s.e.response_label(scaled = TRUE)
s.e.response_label(scaled = TRUE, format = "R.character")
s.e.response_label(scaled = TRUE, format = "LaTeX")
s.e.response_label(normalized = 300)
s.e.response_label(normalized = 300, format = "R.character")
s.e.response_label(normalized = 300, format = "LaTeX")
s.q.response_label(scaled = TRUE)
s.q.response_label(scaled = TRUE, format = "R.character")
s.q.response_label(scaled = TRUE, format = "LaTeX")
s.q.response_label(normalized = 300)
s.q.response_label(normalized = 300, format = "R.character")
s.q.response_label(normalized = 300, format = "LaTeX")

</code></pre>

<hr>
<h2 id='scale_x_energy_eV_continuous'>Energy per photon x-scale</h2><span id='topic+scale_x_energy_eV_continuous'></span><span id='topic+scale_x_energy_J_continuous'></span>

<h3>Description</h3>

<p>Scale x continuous with defaults suitable for wavelengths expressed as energy
per photon [eV] or [J].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_x_energy_eV_continuous(
  unit.exponent = 0,
  name = w_energy_eV_label(unit.exponent = unit.exponent, label.text = label.text),
  breaks = scales::pretty_breaks(n = 7),
  labels = SI_pl_format(exponent = unit.exponent),
  label.text = axis_labels()[["energy"]],
  ...
)

scale_x_energy_J_continuous(
  unit.exponent = -18,
  name = w_energy_J_label(unit.exponent = unit.exponent, label.text = label.text),
  breaks = scales::pretty_breaks(n = 7),
  labels = SI_pl_format(exponent = unit.exponent),
  label.text = axis_labels()[["energy"]],
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_x_energy_eV_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_x_energy_eV_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_x_energy_eV_continuous_+3A_breaks">breaks</code></td>
<td>
<p>The positions of ticks or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_x_energy_eV_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them from the tick
positions.</p>
</td></tr>
<tr><td><code id="scale_x_energy_eV_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_x_energy_eV_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This scale automates the generation of axis labels when the variable
mapped to the <em>x</em> aesthetic contains numeric values for wavelengths
expressed as energy per photon. This is <strong>not</strong> how spectral data are
stored in all the packages of the R for Photobiology suite and can be used
in plots built with <code>ggplot2()</code> with explicit mapping using a
conversion function. If desired, a secondary axis can be added manually as
described in <code><a href="ggplot2.html#topic+sec_axis">sec_axis</a></code>.
</p>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(sun.spct, aes(x = wl2energy(w.length, unit = "joule"), y = s.e.irrad)) +
  geom_line() +
  scale_x_energy_J_continuous()

ggplot(sun.spct, aes(x = wl2energy(w.length, unit = "joule"), y = s.e.irrad)) +
  geom_line() +
  scale_x_energy_J_continuous(unit.exponent = -19)

ggplot(sun.spct, aes(x = wl2energy(w.length, unit = "eV"), y = s.e.irrad)) +
  geom_line() +
  scale_x_energy_eV_continuous()

ggplot(sun.spct, aes(x = wl2energy(w.length, unit = "eV"), y = s.e.irrad)) +
  geom_line() +
  scale_x_energy_eV_continuous(unit.exponent = -3)

</code></pre>

<hr>
<h2 id='scale_x_frequency_continuous'>Frequency x-scale</h2><span id='topic+scale_x_frequency_continuous'></span>

<h3>Description</h3>

<p>Scale x continuous with defaults suitable for wavelengths expressed as
frequencies [Hz].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_x_frequency_continuous(
  unit.exponent = 12,
  name = w_frequency_label(unit.exponent = unit.exponent, label.text = label.text),
  breaks = scales::pretty_breaks(n = 7),
  labels = SI_pl_format(exponent = unit.exponent),
  label.text = axis_labels()[["freq"]],
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_x_frequency_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_x_frequency_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_x_frequency_continuous_+3A_breaks">breaks</code></td>
<td>
<p>The positions of ticks or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_x_frequency_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them from the tick
positions.</p>
</td></tr>
<tr><td><code id="scale_x_frequency_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_x_frequency_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This scale automates the generation of axis labels when the variable
mapped to the <em>x</em> aesthetic contains numeric values for wavelengths
expressed as frequency. This is <strong>not</strong> how spectral data are stored in
the packages of the R for Photobiology suite and can be only used in plots
built with <code>ggplot2()</code> with explicit mapping using a conversion
function. If desired, a secondary axis can be added manually as described
in <code><a href="ggplot2.html#topic+sec_axis">sec_axis</a></code>.
</p>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(sun.spct, aes(x = wl2frequency(w.length), y = s.e.irrad)) +
  geom_line() +
  scale_x_frequency_continuous()

ggplot(sun.spct, aes(x = wl2frequency(w.length), y = s.e.irrad)) +
  geom_line() +
  scale_x_frequency_continuous(14)

</code></pre>

<hr>
<h2 id='scale_x_wavenumber_continuous'>Wavenumber x-scale</h2><span id='topic+scale_x_wavenumber_continuous'></span>

<h3>Description</h3>

<p>Scale x continuous with defaults suitable for wavelengths expressed as
wavenumbers [<code class="reqn">m^{-2}</code>].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_x_wavenumber_continuous(
  unit.exponent = -6,
  name = w_number_label(unit.exponent = unit.exponent, label.text = label.text),
  breaks = scales::pretty_breaks(n = 7),
  labels = SI_pl_format(exponent = -unit.exponent),
  label.text = axis_labels()[["w.number"]],
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_x_wavenumber_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_x_wavenumber_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_x_wavenumber_continuous_+3A_breaks">breaks</code></td>
<td>
<p>The positions of ticks or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_x_wavenumber_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them from the tick
positions.</p>
</td></tr>
<tr><td><code id="scale_x_wavenumber_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_x_wavenumber_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This scale automates the generation of axis labels when the variable
mapped to the <em>x</em> aesthetic contains numeric values for wavelengths
expressed wavenumbers. This is <strong>not</strong> how spectral data are stored in
all the packages of the R for Photobiology suite and can be used in plots
built with <code>ggplot2()</code> with explicit mapping using a conversion
function. If desired, a secondary axis can be added manually as described
in <code><a href="ggplot2.html#topic+sec_axis">sec_axis</a></code>.
</p>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(sun.spct, aes(x = wl2wavenumber(w.length), y = s.e.irrad)) +
  geom_line() +
  scale_x_wavenumber_continuous()

ggplot(sun.spct, aes(x = wl2wavenumber(w.length), y = s.e.irrad)) +
  geom_line() +
  scale_x_wavenumber_continuous(unit.exponent = -5)

</code></pre>

<hr>
<h2 id='scale_x_wl_continuous'>Wavelength x-scale</h2><span id='topic+scale_x_wl_continuous'></span>

<h3>Description</h3>

<p>Scale x continuous with defaults suitable for wavelengths in nanometres.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_x_wl_continuous(
  unit.exponent = -9,
  name = w_length_label(unit.exponent = unit.exponent, label.text = label.text),
  breaks = scales::pretty_breaks(n = 7),
  labels = SI_pl_format(exponent = unit.exponent + 9),
  label.text = axis_labels()[["w.length"]],
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_x_wl_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_x_wl_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_x_wl_continuous_+3A_breaks">breaks</code></td>
<td>
<p>The positions of ticks or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_x_wl_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them from the tick
positions.</p>
</td></tr>
<tr><td><code id="scale_x_wl_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_x_wl_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This scale automates the generation of axis labels when the variable
mapped to the <em>x</em> aesthetic contains numeric values for wavelengths
expressed in nanometres. This is how spectral data are stored in all the
packages of the R for Photobiology suite, inlcuding the the expected data
by the <code>autoplot()</code> methods defined in 'ggspectra'.
</p>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous()

ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(unit.exponent = -6)

ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(label.text = "Longitud de onda,")

autoplot(sun.spct) +
  scale_x_wl_continuous(label.text = "Longitud de onda,",
                        unit.exponent = -6)

</code></pre>

<hr>
<h2 id='scale_y_A_continuous'>Absorbance y-scale</h2><span id='topic+scale_y_A_continuous'></span><span id='topic+scale_y_A_internal_continuous'></span><span id='topic+scale_y_A_total_continuous'></span>

<h3>Description</h3>

<p>Scale y continuous with defaults suitable for spectral absorbance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_A_continuous(
  unit.exponent = 0,
  name = A_label(unit.exponent = unit.exponent, format = format, label.text = label.text,
    scaled = scaled, normalized = round(normalized, 1), Tfr.type = Tfr.type),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  Tfr.type,
  ...
)

scale_y_A_internal_continuous(
  unit.exponent = 0,
  name = A_label(unit.exponent = unit.exponent, format = format, label.text = label.text,
    scaled = scaled, normalized = round(normalized, 1), Tfr.type = "internal"),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_A_total_continuous(
  unit.exponent = 0,
  name = A_label(unit.exponent = unit.exponent, format = format, label.text = label.text,
    scaled = scaled, normalized = round(normalized, 1), Tfr.type = "total"),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_A_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_y_A_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_y_A_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_y_A_continuous_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_A_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_y_A_continuous_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="scale_y_A_continuous_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="scale_y_A_continuous_+3A_tfr.type">Tfr.type</code></td>
<td>
<p>character, either &quot;total&quot; or &quot;internal&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_A_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(yellow_gel.spct, plot.qty = "absorbance") +
  geom_line() +
  scale_y_A_continuous(Tfr.type = getTfrType(yellow_gel.spct)) +
  scale_x_wl_continuous()

ggplot(yellow_gel.spct, plot.qty = "absorbance") +
  geom_line() +
  scale_y_A_internal_continuous() +
  scale_x_wl_continuous()

ggplot(yellow_gel.spct, plot.qty = "absorbance") +
  geom_line() +
  scale_y_A_total_continuous() +
  scale_x_wl_continuous()

</code></pre>

<hr>
<h2 id='scale_y_Afr_continuous'>Absorptance y-scale</h2><span id='topic+scale_y_Afr_continuous'></span>

<h3>Description</h3>

<p>Scale y continuous with defaults suitable for spectral absorptance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_Afr_continuous(
  unit.exponent = 0,
  name = Afr_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = unit.exponent),
  limits = c(0, 1),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["Afr"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_Afr_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_y_Afr_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_y_Afr_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_y_Afr_continuous_+3A_limits">limits</code></td>
<td>
<p>One of <code>NULL</code> for default based on data range, a numeric
vector of length two (<code>NA</code> allowed) or a function that accepts the
data-based limits as argument and returns new limits.</p>
</td></tr>
<tr><td><code id="scale_y_Afr_continuous_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_Afr_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_y_Afr_continuous_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="scale_y_Afr_continuous_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="scale_y_Afr_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Afr_as_default()

ggplot(yellow_gel.spct) +
  geom_line() +
  scale_y_Afr_continuous() +
  scale_x_wl_continuous()

ggplot(yellow_gel.spct) +
  geom_line() +
  scale_y_Afr_continuous(unit.exponent = -2) +
  scale_x_wl_continuous()

ggplot(yellow_gel.spct) +
  geom_line() +
  scale_y_Afr_continuous(unit.exponent = -3) +
  scale_x_wl_continuous()

unset_filter_qty_default()

</code></pre>

<hr>
<h2 id='scale_y_counts_continuous'>Raw-counts y-scale</h2><span id='topic+scale_y_counts_continuous'></span><span id='topic+scale_y_counts_tg_continuous'></span>

<h3>Description</h3>

<p>Scale y continuous with defaults suitable for raw detector counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_counts_continuous(
  unit.exponent = ifelse(normalized, 0, 3),
  name = counts_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["counts"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_counts_tg_continuous(
  unit.exponent = ifelse(normalized, 0, 3),
  name = counts_label(unit.exponent = 0, format = format, label.text = label.text, scaled
    = scaled, normalized = round(normalized, 1)),
  labels = SI_tg_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["counts"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_counts_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_y_counts_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_y_counts_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_y_counts_continuous_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_counts_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_y_counts_continuous_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="scale_y_counts_continuous_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="scale_y_counts_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function only alters default arguments values for <code>name</code> and
<code>labels</code>, please, see documentation for
<code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code> for other parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(white_led.raw_spct) +
  geom_line() +
  scale_y_counts_continuous() +
  scale_x_wl_continuous()

ggplot(white_led.raw_spct) +
  geom_line() +
  scale_y_counts_continuous(unit.exponent = 0) +
  scale_x_wl_continuous()

ggplot(white_led.raw_spct) +
  geom_line() +
  scale_y_counts_tg_continuous() +
  scale_x_wl_continuous()

ggplot(white_led.raw_spct) +
  geom_line() +
  scale_y_counts_tg_continuous(unit.exponent = 0) +
  scale_x_wl_continuous()

norm_led.raw_spct &lt;- normalize(white_led.raw_spct[ , 1:2], norm = "max")

ggplot(norm_led.raw_spct) +
  geom_line() +
  scale_y_counts_continuous(normalized = getNormalized(norm_led.raw_spct)) +
  scale_x_wl_continuous()

ggplot(norm_led.raw_spct) +
  geom_line() +
  scale_y_counts_tg_continuous(normalized = getNormalized(norm_led.raw_spct)) +
  scale_x_wl_continuous()

</code></pre>

<hr>
<h2 id='scale_y_cps_continuous'>Counts-per-second  y-scale</h2><span id='topic+scale_y_cps_continuous'></span>

<h3>Description</h3>

<p>Scale y continuous with defaults suitable for raw detector counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_cps_continuous(
  unit.exponent = 0,
  name = cps_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["cps"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_cps_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_y_cps_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_y_cps_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_y_cps_continuous_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_cps_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_y_cps_continuous_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="scale_y_cps_continuous_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="scale_y_cps_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(white_led.cps_spct) +
  geom_line() +
  scale_y_cps_continuous() +
  scale_x_wl_continuous()

ggplot(white_led.cps_spct) +
  geom_line() +
  scale_y_cps_continuous(3) +
  scale_x_wl_continuous()

ggplot(white_led.cps_spct * 1e-4) +
  geom_line() +
  scale_y_cps_continuous(scaled = TRUE) +
  scale_x_wl_continuous()

norm_led.cps_spct &lt;- normalize(white_led.cps_spct, norm = "max")

ggplot(norm_led.cps_spct) +
  geom_line() +
  scale_y_cps_continuous(normalized = getNormalized(norm_led.cps_spct)) +
  scale_x_wl_continuous()

</code></pre>

<hr>
<h2 id='scale_y_multipliers_continuous'>Calibration multipliers y-scale</h2><span id='topic+scale_y_multipliers_continuous'></span>

<h3>Description</h3>

<p>Scale y continuous with defaults suitable for raw the calibration
multipliers used to convert pixel response rate (counts per second) into
energy irradiance units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_multipliers_continuous(
  unit.exponent = 0,
  name = multipliers_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["e.mult"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_multipliers_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_y_multipliers_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_y_multipliers_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_y_multipliers_continuous_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_multipliers_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_y_multipliers_continuous_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="scale_y_multipliers_continuous_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="scale_y_multipliers_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>

<hr>
<h2 id='scale_y_Rfr_continuous'>Reflectance y-scale</h2><span id='topic+scale_y_Rfr_continuous'></span><span id='topic+scale_y_Rfr_specular_continuous'></span><span id='topic+scale_y_Rfr_total_continuous'></span>

<h3>Description</h3>

<p>Scale y continuous with defaults suitable for spectral reflectance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_Rfr_continuous(
  unit.exponent = 0,
  name = Rfr_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1), Rfr.type = Rfr.type),
  labels = SI_pl_format(exponent = unit.exponent),
  limits = c(0, 1),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  Rfr.type,
  ...
)

scale_y_Rfr_specular_continuous(
  unit.exponent = 0,
  name = Rfr_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1), Rfr.type =
    "specular"),
  labels = SI_pl_format(exponent = unit.exponent),
  limits = c(0, 1),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_Rfr_total_continuous(
  unit.exponent = 0,
  name = Rfr_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1), Rfr.type = "total"),
  labels = SI_pl_format(exponent = unit.exponent),
  limits = c(0, 1),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_Rfr_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_y_Rfr_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_y_Rfr_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_y_Rfr_continuous_+3A_limits">limits</code></td>
<td>
<p>One of <code>NULL</code> for default based on data range, a numeric
vector of length two (<code>NA</code> allowed) or a function that accepts the
data-based limits as argument and returns new limits.</p>
</td></tr>
<tr><td><code id="scale_y_Rfr_continuous_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_Rfr_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_y_Rfr_continuous_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="scale_y_Rfr_continuous_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="scale_y_Rfr_continuous_+3A_rfr.type">Rfr.type</code></td>
<td>
<p>character, either &quot;total&quot; or &quot;spcular&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_Rfr_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(Ler_leaf_rflt.spct) +
  geom_line() +
  scale_y_Rfr_continuous(Rfr.type = getRfrType(Ler_leaf_rflt.spct)) +
  scale_x_wl_continuous()

ggplot(Ler_leaf_rflt.spct) +
  geom_line() +
  scale_y_Rfr_continuous(unit.exponent = -2,
                         Rfr.type = getRfrType(Ler_leaf_rflt.spct)) +
  scale_x_wl_continuous()

ggplot(Ler_leaf_rflt.spct) +
  geom_line() +
  scale_y_Rfr_continuous(unit.exponent = -3,
                         Rfr.type = getRfrType(Ler_leaf_rflt.spct)) +
  scale_x_wl_continuous()

ggplot(Ler_leaf_rflt.spct) +
  geom_line() +
  scale_y_Rfr_specular_continuous() +
  scale_x_wl_continuous()

</code></pre>

<hr>
<h2 id='scale_y_s.e.irrad_continuous'>Spectral irradiance y-scale</h2><span id='topic+scale_y_s.e.irrad_continuous'></span><span id='topic+scale_y_s.q.irrad_continuous'></span><span id='topic+scale_y_s.e.irrad_log10'></span><span id='topic+scale_y_s.q.irrad_log10'></span>

<h3>Description</h3>

<p>Scale y continuous with defaults suitable for raw detector counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_s.e.irrad_continuous(
  unit.exponent = 0,
  name = s.e.irrad_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.e.irrad"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_s.q.irrad_continuous(
  unit.exponent = ifelse(normalized, 0, -6),
  name = s.q.irrad_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.q.irrad"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_s.e.irrad_log10(
  unit.exponent = 0,
  name = s.e.irrad_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.e.irrad"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_s.q.irrad_log10(
  unit.exponent = ifelse(normalized, 0, -6),
  name = s.q.irrad_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.q.irrad"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_s.e.irrad_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_y_s.e.irrad_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.irrad_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.irrad_continuous_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.irrad_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.irrad_continuous_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.irrad_continuous_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="scale_y_s.e.irrad_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(sun.spct) +
  geom_line() +
  scale_y_s.e.irrad_continuous() +
  scale_x_wl_continuous()

ggplot(sun.spct) +
  geom_line() +
  scale_y_s.e.irrad_continuous(label.text = "") +
  scale_x_wl_continuous()

ggplot(sun.spct) +
  geom_line() +
  scale_y_s.e.irrad_continuous(label.text = "Irradiancia spectral,") +
  scale_x_wl_continuous(label.text = "Longitud de onda,")

ggplot(sun.spct) +
  geom_line() +
  scale_y_s.e.irrad_continuous(unit.exponent = -1) +
  scale_x_wl_continuous()

ggplot(sun.spct, unit.out = "photon") +
  geom_line() +
  scale_y_s.q.irrad_continuous() +
  scale_x_wl_continuous()

ggplot(clip_wl(sun.spct, c(295, NA))) +
  geom_line() +
  scale_y_s.e.irrad_log10() +
  scale_x_wl_continuous()

ggplot(clip_wl(sun.spct, c(295, NA)),
  unit.out = "photon") +
  geom_line(na.rm = TRUE) +
  scale_y_s.q.irrad_log10() +
  scale_x_wl_continuous()

photon_as_default()
normalized_sun.spct &lt;- normalize(sun.spct)
ggplot(normalized_sun.spct) +
  geom_line(na.rm = TRUE) +
  scale_y_s.q.irrad_continuous(normalized =
                            getNormalized(normalized_sun.spct)) +
  scale_x_wl_continuous()

unset_radiation_unit_default()

</code></pre>

<hr>
<h2 id='scale_y_s.e.response_continuous'>Spectral response and action y-scales</h2><span id='topic+scale_y_s.e.response_continuous'></span><span id='topic+scale_y_s.q.response_continuous'></span><span id='topic+scale_y_s.e.action_continuous'></span><span id='topic+scale_y_s.q.action_continuous'></span>

<h3>Description</h3>

<p>Scale y continuous with defaults suitable for response and action spectra.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_s.e.response_continuous(
  unit.exponent = 0,
  name = s.e.response_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = -unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.e.response"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_s.q.response_continuous(
  unit.exponent = 0,
  name = s.q.response_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = -unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.q.response"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_s.e.action_continuous(
  unit.exponent = 0,
  name = s.e.action_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = -unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.e.action"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_s.q.action_continuous(
  unit.exponent = 0,
  name = s.q.action_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1)),
  labels = SI_pl_format(exponent = -unit.exponent),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["s.q.action"]],
  scaled = FALSE,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_s.e.response_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_y_s.e.response_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.response_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.response_continuous_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.response_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.response_continuous_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="scale_y_s.e.response_continuous_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="scale_y_s.e.response_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(ccd.spct) +
  geom_line() +
  scale_y_s.e.action_continuous() + #  per joule
  scale_x_wl_continuous()

ggplot(ccd.spct) +
  geom_line() +
  scale_y_s.e.response_continuous() + #  per joule
  scale_x_wl_continuous()

ggplot(ccd.spct) +
  geom_line() +
  scale_y_s.e.response_continuous(unit.exponent = 6) + # per mega joule
  scale_x_wl_continuous()

ggplot(ccd.spct, unit.out = "photon") +
  geom_line() +
  scale_y_s.q.response_continuous() + # per mol
  scale_x_wl_continuous()

ggplot(ccd.spct, unit.out = "photon") +
  geom_line() +
  scale_y_s.q.response_continuous(unit.exponent = 3) + # per 1000 moles
  scale_x_wl_continuous()

norm_ccd.spct &lt;- normalize(ccd.spct, norm = "max")
ggplot(norm_ccd.spct) +
  geom_line() +
  scale_y_s.e.response_continuous(normalized = getNormalized(norm_ccd.spct)) +
  scale_x_wl_continuous()

photon_as_default()

norm_ccd.spct &lt;- normalize(ccd.spct, norm = "max")
ggplot(norm_ccd.spct) +
  geom_line() +
  scale_y_s.q.response_continuous(normalized = getNormalized(norm_ccd.spct)) +
  scale_x_wl_continuous()

ggplot(norm_ccd.spct) +
  geom_line() +
  scale_y_s.q.response_continuous(unit.exponent = 2,
                                  normalized = getNormalized(norm_ccd.spct)) +
  scale_x_wl_continuous()

unset_radiation_unit_default()

</code></pre>

<hr>
<h2 id='scale_y_Tfr_continuous'>Transmittance y-scale</h2><span id='topic+scale_y_Tfr_continuous'></span><span id='topic+scale_y_Tfr_internal_continuous'></span><span id='topic+scale_y_Tfr_total_continuous'></span>

<h3>Description</h3>

<p>Scale y continuous with defaults suitable for spectral transmittance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_y_Tfr_continuous(
  unit.exponent = 0,
  name = Tfr_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1), Tfr.type = Tfr.type),
  labels = SI_pl_format(exponent = unit.exponent),
  limits = c(0, 1),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  Tfr.type,
  ...
)

scale_y_Tfr_internal_continuous(
  unit.exponent = 0,
  name = Tfr_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1), Tfr.type =
    "internal"),
  labels = SI_pl_format(exponent = unit.exponent),
  limits = c(0, 1),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  ...
)

scale_y_Tfr_total_continuous(
  unit.exponent = 0,
  name = Tfr_label(unit.exponent = unit.exponent, format = format, label.text =
    label.text, scaled = scaled, normalized = round(normalized, 1), Tfr.type = "total"),
  labels = SI_pl_format(exponent = unit.exponent),
  limits = c(0, 1),
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_y_Tfr_continuous_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="scale_y_Tfr_continuous_+3A_name">name</code></td>
<td>
<p>The name of the scale, used for the axis-label.</p>
</td></tr>
<tr><td><code id="scale_y_Tfr_continuous_+3A_labels">labels</code></td>
<td>
<p>The tick labels or a function to generate them.</p>
</td></tr>
<tr><td><code id="scale_y_Tfr_continuous_+3A_limits">limits</code></td>
<td>
<p>One of <code>NULL</code> for default based on data range, a numeric
vector of length two (<code>NA</code> allowed) or a function that accepts the
data-based limits as argument and returns new limits.</p>
</td></tr>
<tr><td><code id="scale_y_Tfr_continuous_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expression&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_Tfr_continuous_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="scale_y_Tfr_continuous_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="scale_y_Tfr_continuous_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="scale_y_Tfr_continuous_+3A_tfr.type">Tfr.type</code></td>
<td>
<p>character, either &quot;total&quot; or &quot;internal&quot;.</p>
</td></tr>
<tr><td><code id="scale_y_Tfr_continuous_+3A_...">...</code></td>
<td>
<p>other named arguments passed to <code>scale_y_continuous</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function only alters two default arguments, please, see
documentation for <code><a href="ggplot2.html#topic+scale_continuous">scale_continuous</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Tfr_as_default()

ggplot(yellow_gel.spct) +
  geom_line() +
  scale_y_Tfr_continuous(Tfr.type = getTfrType(yellow_gel.spct)) +
  scale_x_wl_continuous()

ggplot(yellow_gel.spct) +
  geom_line() +
  scale_y_Tfr_continuous(unit.exponent = -2,
                         Tfr.type = getTfrType(yellow_gel.spct)) +
  scale_x_wl_continuous()

ggplot(yellow_gel.spct) +
  geom_line() +
  scale_y_Tfr_continuous(unit.exponent = -3,
                         Tfr.type = getTfrType(yellow_gel.spct)) +
  scale_x_wl_continuous()

ggplot(yellow_gel.spct) +
  geom_line() +
  scale_y_Tfr_total_continuous() +
  scale_x_wl_continuous()

unset_filter_qty_default()

</code></pre>

<hr>
<h2 id='sec_axis_w_number'>Secondary axes for wavelengths</h2><span id='topic+sec_axis_w_number'></span><span id='topic+sec_axis_w_frequency'></span><span id='topic+sec_axis_energy_eV'></span><span id='topic+sec_axis_energy_J'></span><span id='topic+sec_axis_wl'></span>

<h3>Description</h3>

<p>Secondary axes for wavelength data in nanometres. With suitable scaling and
name (axis label) for frequency, wave number, photon energy and wavelength.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sec_axis_w_number(unit.exponent = -6, label.text = axis_labels()[["w.number"]])

sec_axis_w_frequency(unit.exponent = 12, label.text = axis_labels()[["freq"]])

sec_axis_energy_eV(unit.exponent = 0, label.text = axis_labels()[["energy"]])

sec_axis_energy_J(unit.exponent = -18, label.text = axis_labels()[["energy"]])

sec_axis_wl(unit.exponent = -9, label.text = axis_labels()[["w.length"]])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sec_axis_w_number_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer The exponent on base 10 of the scale multiplier
used for the axis labels, e.g., 3 for <code class="reqn">10^3</code> or <code class="reqn">k</code>.</p>
</td></tr>
<tr><td><code id="sec_axis_w_number_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These secondary axis functions can be used only when the <em>x</em>
aesthetic is mapped to a numerical variable containing wavelength values
expressed in nanometres. They can be used to add a secondary x axis to
plots created using <code>ggplot()</code> or <code>autoplot()</code>.
</p>


<h3>See Also</h3>

<p>the default text used for quantity names are most easily changed
by resetting all the defaults once as explained in
<code><a href="#topic+axis_labels_uk">axis_labels_uk</a></code>, even if it is possible to override them
also in each call.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(sec.axis = sec_axis_w_number())

# Secondary axes can be added to plots built with autoplot() methods
autoplot(sun.spct) +
  scale_x_wl_continuous(sec.axis = sec_axis_w_number())

# Using 'ggplot2' scale
ggplot(sun.spct) +
  geom_line() +
  scale_x_continuous(name = w_length_label(),
                     sec.axis = sec_axis_w_number())

# change scale multipliers, SI defined
ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(-6, sec.axis = sec_axis_w_number(-3))

# change scale multipliers, not SI defined (best avoided)
ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(-8, sec.axis = sec_axis_w_number(-4))

# Change quantity name to Spanish
ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(label.text = "Longitud de onda,",
                        sec.axis = sec_axis_w_frequency(label.text = "Frecuencia,"))

# Frequency in secondary axis
ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(sec.axis = sec_axis_w_frequency())

# Energy (per photon) in atto joules
ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(sec.axis = sec_axis_energy_J())

# Energy (per photon) in electron volts
ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(sec.axis = sec_axis_energy_eV())

# Secondary axis with wavelength using a different scale factor
ggplot(sun.spct) +
  geom_line() +
  scale_x_wl_continuous(sec.axis = sec_axis_wl(-6))

# Secondary axes can be added to plots built with autoplot() methods
autoplot(sun.spct) +
  scale_x_wl_continuous(sec.axis = sec_axis_wl(-6))

</code></pre>

<hr>
<h2 id='set_annotations_default'>Set defaults for autoplot annotations</h2><span id='topic+set_annotations_default'></span><span id='topic+set_w.band_default'></span>

<h3>Description</h3>

<p>Set R options used when plotting spectra. Option
&quot;photobiology.plot.annotations&quot; is used as default argument to formal
parameter <code>annotations</code> and option &quot;photobiology.plot.bands&quot; is used
as default argument to formal parameter <code>w.band</code> in all the
<code>autoplot()</code> methods exported from package 'ggspectra'. These
convenience functions make it easier to edit these two option which are
stored as a vector of characters strings and a list of waveband objects,
respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_annotations_default(annotations = NULL)

set_w.band_default(w.band = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_annotations_default_+3A_annotations">annotations</code></td>
<td>
<p>character vector Annotations to add or remove from
defaults used by the <code>autoplot()</code> methods defined in this package..</p>
</td></tr>
<tr><td><code id="set_annotations_default_+3A_w.band">w.band</code></td>
<td>
<p>a single waveband object or a list of waveband objects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Previous value of option &quot;photobiology.plot.annotations&quot;, returned
invisibly.
</p>


<h3>Plot Annotations</h3>

<p>The recognized annotation names are: <code>"summaries"</code>, <code>"peaks"</code>,
<code>"peak.labels"</code>, <code>"valleys"</code>, <code>"valley.labels"</code>,
<code>"wls"</code>, <code>"wls.labels"</code>, <code>"colour.guide"</code>,
<code>"color.guide"</code>, <code>"boxes"</code>, <code>"segments"</code>, <code>"labels"</code>.
In addition, <code>"+"</code> is interpreted as a request to add to the already
present default annotations, <code>"-"</code> as request to remove annotations
and <code>"="</code> or missing<code>"+"</code> and <code>"-"</code> as a request to reset
annotations to those requested. If used, <code>"+"</code>, <code>"-"</code> or
<code>"="</code> must be the first member of a character vector, and followed by
one or more of the names given above. To simultaneously add and remove
annotations one can pass a <code>list</code> containing <code>character</code> vectors
each assembled as described. The vectors are applied in the order they
appear in the list. To disable all annotations pass <code>""</code> or
<code>c("=", "")</code> as argument. Adding a variation of an annotation already
present, replaces the existing one automatically: e.g., adding
<code>"peak.labels"</code> replaces<code>"peaks"</code> if present.
</p>


<h3>Title Annotations</h3>

<p>metadata retrieved from object <code>object</code> is
paased to <code>ggplot2::ggtitle()</code> as arguments for <code>title</code>,
<code>subtitle</code> and <code>caption</code>. The specification for the title is
passed as argument to <code>annotations</code>, and consists in the keyword
<code>title</code> with optional modifiers selecting the kind of metatdata to
use, separated by colons. Up to three keywords separated by colons are
accepted, and correspond to title, subtitle and caption. The recognized
keywords are: <code>"objt"</code>, <code>"class"</code>, <code>"what"</code>, <code>"when"</code>,
<code>"where"</code>, <code>"how"</code>, <code>"inst.name"</code>, <code>"inst.sn"</code>,
<code>"comment"</code> and <code>"none"</code> are recognized as modifiers to
<code>"title"</code>; <code>"none"</code> is a placeholder. Default is
<code>"title:objt"</code> or no title depending on the context.
</p>


<h3>Note</h3>

<p>The syntax used and behaviour are the same as for the
<code>annotations</code> parameter of the <code>autoplot()</code> methods for spectra,
but instead of affecting a single plot, <code>set_annotations_default()</code>
changes the default used for subsequent calls to <code>autoplot()</code>.
</p>


<h3>See Also</h3>

<p>Other autoplot methods: 
<code><a href="#topic+autoplot.calibration_spct">autoplot.calibration_spct</a>()</code>,
<code><a href="#topic+autoplot.cps_spct">autoplot.cps_spct</a>()</code>,
<code><a href="#topic+autoplot.filter_spct">autoplot.filter_spct</a>()</code>,
<code><a href="#topic+autoplot.object_spct">autoplot.object_spct</a>()</code>,
<code><a href="#topic+autoplot.raw_spct">autoplot.raw_spct</a>()</code>,
<code><a href="#topic+autoplot.reflector_spct">autoplot.reflector_spct</a>()</code>,
<code><a href="#topic+autoplot.response_spct">autoplot.response_spct</a>()</code>,
<code><a href="#topic+autoplot.source_spct">autoplot.source_spct</a>()</code>,
<code><a href="#topic+autoplot.waveband">autoplot.waveband</a>()</code>
</p>

<hr>
<h2 id='SI_pl_format'>Formatter for plain labels discounting for SI multipliers</h2><span id='topic+SI_pl_format'></span><span id='topic+SI_plain'></span>

<h3>Description</h3>

<p>The labels generated represent numbers rescaled to compensate for a change
in unit's by a factor of ten or by a power of ten.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SI_pl_format(exponent = 0, digits = 3, ...)

SI_plain(x, exponent = 0, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SI_pl_format_+3A_exponent">exponent</code></td>
<td>
<p>numeric Power of 10 to use as multiplier</p>
</td></tr>
<tr><td><code id="SI_pl_format_+3A_digits">digits</code></td>
<td>
<p>number of significant digits to show</p>
</td></tr>
<tr><td><code id="SI_pl_format_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="base.html#topic+format">format</a></code></p>
</td></tr>
<tr><td><code id="SI_pl_format_+3A_x">x</code></td>
<td>
<p>a numeric vector to format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a function with single parameter x, a numeric vector, that
returns a character vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
SI_pl_format()(1:10)
SI_pl_format()(runif(10))
SI_pl_format(exponent = 2)(runif(10))
SI_plain(1:10)
SI_plain(runif(10))
SI_plain(runif(10), digits = 2)
</code></pre>

<hr>
<h2 id='SI_tg_format'>Formatter for tagged labels using SI multipliers</h2><span id='topic+SI_tg_format'></span><span id='topic+SI_tagged'></span>

<h3>Description</h3>

<p>The labels generated represent the same numbers, but with trailing zeros
removed/added and compensated by attaching to each label an SI multiplier
&quot;prefix&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SI_tg_format(exponent = 0, digits = 3, ...)

SI_tagged(x, exponent = 0, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SI_tg_format_+3A_exponent">exponent</code></td>
<td>
<p>numeric Power of 10 to use as multiplier</p>
</td></tr>
<tr><td><code id="SI_tg_format_+3A_digits">digits</code></td>
<td>
<p>number of significant digits to show</p>
</td></tr>
<tr><td><code id="SI_tg_format_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="base.html#topic+format">format</a></code></p>
</td></tr>
<tr><td><code id="SI_tg_format_+3A_x">x</code></td>
<td>
<p>a numeric vector to format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a function with single parameter x, a numeric vector, that
returns a character vector
</p>


<h3>Note</h3>

<p>If the exponent passed has no SI prefix defined, the exponent will
be adjusted to match one.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
SI_tg_format()(1:10)
SI_tg_format()(runif(10))
SI_tg_format(exponent = 2)(runif(10))
SI_tagged(1:10)
SI_tagged(runif(10))
SI_tagged(runif(10), digits = 2)

</code></pre>

<hr>
<h2 id='stat_color'>Calculate colours from wavelength.</h2><span id='topic+stat_color'></span>

<h3>Description</h3>

<p><code>stat_color</code> computes color definitions according to human vision.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_color(
  mapping = NULL,
  data = NULL,
  geom = "point",
  chroma.type = "CMF",
  position = "identity",
  na.rm = FALSE,
  show.legend = FALSE,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_color_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs to be set
at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_color_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_color_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_color_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_color_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points
on this layer</p>
</td></tr>
<tr><td><code id="stat_color_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be
stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_color_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_color_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_color_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This can
include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The original data frame with a variable with color definitions added.
</p>


<h3>Computed variable</h3>


<dl>
<dt>wl.color</dt><dd><p>color corresponding to x-value giving wavelength in
nanometres.</p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>color</dt><dd><p>..wl.color..</p>
</dd>
<dt>fill</dt><dd><p>..wl.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+color_of">color_of</a></code>, which is used internally.
</p>
<p>Other stats functions: 
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ggplot(sun.spct) + geom_line() +
  stat_color() + scale_color_identity()

</code></pre>

<hr>
<h2 id='stat_find_qtys'>Find quantity value for target wavelength value.</h2><span id='topic+stat_find_qtys'></span>

<h3>Description</h3>

<p><code>stat_find_qtys</code> finds at which y positions values equal to an x target
are located.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_find_qtys(
  mapping = NULL,
  data = NULL,
  geom = "point",
  target = "half.maximum",
  interpolate = TRUE,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  x.label.fmt = label.fmt,
  y.label.fmt = label.fmt,
  position = "identity",
  na.rm = FALSE,
  show.legend = FALSE,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_find_qtys_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs to be
set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_target">target</code></td>
<td>
<p>numeric value indicating the spectral quantity value for which
wavelengths are to be searched and interpolated if need. The character
string &quot;half.maximum&quot; is also accepted as argument.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_interpolate">interpolate</code></td>
<td>
<p>logical Indicating whether the nearest wavelength value
in <code>x</code> should be returned or a value calculated by linear
interpolation between wavelength values straddling the target.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character  string giving a format definition for converting
values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_x.label.fmt">x.label.fmt</code></td>
<td>
<p>character  string giving a format definition for
converting $x$-values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_y.label.fmt">y.label.fmt</code></td>
<td>
<p>character  string giving a format definition for
converting $y$-values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_find_qtys_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These stats use <code>geom_point</code> by default as it is the geom most
likely to work well in almost any situation without need of tweaking. The
default aesthetics set by these stats allow their direct use with
<code>geom_text</code>, <code>geom_label</code>, <code>geom_line</code>, <code>geom_rug</code>,
<code>geom_hline</code> and <code>geom_vline</code>. The formatting of the labels
returned can be controlled by the user.
</p>


<h3>Value</h3>

<p>A data frame with one row for each match to the target subset from
the data or interpolated. As spectra are monotonic in wavelength, this
statistic will never return more than one row when used with spectra.
</p>


<h3>Computed variables</h3>

 <dl>
<dt>x</dt><dd><p>x-value at or nearest to the
match to the target as numeric</p>
</dd> <dt>y</dt><dd><p>target value or y-value nearest to
the target as numeric</p>
</dd> <dt>x.label</dt><dd><p>x-value at or nearest to the match
formatted as character</p>
</dd> <dt>y.label</dt><dd><p>target value or y-value nearest to
the target formatted as character</p>
</dd> <dt>color</dt><dd><p>color definition calculated
by assuming that x-values are wavelengths expressed in nanometres.</p>
</dd> </dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>
 <dl>
<dt>label</dt><dd><p>..x.label..</p>
</dd> <dt>xintercept</dt><dd><p>..x..</p>
</dd>
<dt>yintercept</dt><dd><p>..y..</p>
</dd> <dt>fill</dt><dd><p>..color..</p>
</dd> </dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set
with <code>aes()</code>. </p>
 <dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd> </dl>



<h3>Note</h3>

<p>These stats work nicely together with geoms <code>geom_text_repel</code> and
<code>geom_label_repel</code> from package <code><a href="ggrepel.html#topic+ggrepel">ggrepel</a></code> to
solve the problem of overlapping labels by displacing them. To discard
overlapping labels use <code>check_overlap = TRUE</code> as argument to
<code>geom_text</code>. By default the labels are character values suitable to be
plotted as is, but with a suitable <code>label.fmt</code> labels suitable for
parsing by the geoms (e.g. into expressions containing greek letters or
super or subscripts) can be also easily obtained.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+find_peaks">find_peaks</a></code>.
</p>
<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(yellow_gel.spct) + geom_line() +
  stat_find_qtys(target = "half.range")
ggplot(yellow_gel.spct) + geom_line() +
  stat_find_qtys(target = c(490, 500, 510))
ggplot(yellow_gel.spct) + geom_line() +
  stat_find_qtys(target = 500, geom = "point", colour = "red") +
  stat_find_qtys(target = 500, geom = "text", colour = "red",
             hjust = 1.1, label.fmt = "Tfr = %1.2f")
</code></pre>

<hr>
<h2 id='stat_find_wls'>Find wavelength for target quantity value.</h2><span id='topic+stat_find_wls'></span>

<h3>Description</h3>

<p><code>stat_find_wls</code> finds at which x positions values equal to a target are
located.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_find_wls(
  mapping = NULL,
  data = NULL,
  geom = "point",
  target = "half.maximum",
  interpolate = TRUE,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  x.label.fmt = label.fmt,
  y.label.fmt = label.fmt,
  position = "identity",
  na.rm = FALSE,
  show.legend = FALSE,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_find_wls_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs to be
set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_target">target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_interpolate">interpolate</code></td>
<td>
<p>logical Indicating whether the nearest wavelength value in
<code>x</code> should be returned or a value calculated by linear interpolation
between wavelength values stradling the target.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character  string giving a format definition for converting
values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_x.label.fmt">x.label.fmt</code></td>
<td>
<p>character  string giving a format definition for
converting $x$-values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_y.label.fmt">y.label.fmt</code></td>
<td>
<p>character  string giving a format definition for
converting $y$-values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_find_wls_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These stats use <code>geom_point</code> by default as it is the geom most
likely to work well in almost any situation without need of tweaking. The
default aesthetics set by these stats allow their direct use with
<code>geom_text</code>, <code>geom_label</code>, <code>geom_line</code>, <code>geom_rug</code>,
<code>geom_hline</code> and <code>geom_vline</code>. The formatting of the labels
returned can be controlled by the user.
</p>


<h3>Value</h3>

<p>A data frame with one row for each match to <code>target</code> found in
the data.
</p>


<h3>Computed variables</h3>

 <dl>
<dt>x</dt><dd><p>x-value at or nearest to the
match to the target as numeric</p>
</dd> <dt>y</dt><dd><p>target value or y-value nearest to
the target as numeric</p>
</dd> <dt>x.label</dt><dd><p>x-value at or nearest to the match
formatted as character</p>
</dd> <dt>y.label</dt><dd><p>target value or y-value nearest to
the target formatted as character</p>
</dd> <dt>wl.color</dt><dd><p>color definition calculated
by assuming that x-values are wavelengths expressed in nanometres.</p>
</dd> </dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>
 <dl>
<dt>label</dt><dd><p>..x.label..</p>
</dd> <dt>xintercept</dt><dd><p>..x..</p>
</dd>
<dt>yintercept</dt><dd><p>..y..</p>
</dd> <dt>fill</dt><dd><p>..wl.color..</p>
</dd> </dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set
with <code>aes()</code>. </p>
 <dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd> </dl>



<h3>Note</h3>

<p>These stats work nicely together with geoms <code>geom_text_repel</code> and
<code>geom_label_repel</code> from package <code><a href="ggrepel.html#topic+ggrepel">ggrepel</a></code> to
solve the problem of overlapping labels by displacing them. To discard
overlapping labels use <code>check_overlap = TRUE</code> as argument to
<code>geom_text</code>. By default the labels are character values suitable to be
plotted as is, but with a suitable <code>label.fmt</code> labels suitable for
parsing by the geoms (e.g. into expressions containing greek letters or
super or subscripts) can be also easily obtained.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+find_peaks">find_peaks</a></code>.
</p>
<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(yellow_gel.spct) + geom_line() +
  stat_find_wls(target = c(0.25, 0.5, 0.75))
ggplot(yellow_gel.spct) + geom_line() +
  stat_find_wls(target = "half.maximum", geom = "point", colour = "red") +
  stat_find_wls(target = "half.maximum", geom = "text", colour = "red",
             hjust = 1.1, label.fmt = "%3.0f nm")
</code></pre>

<hr>
<h2 id='stat_label_peaks'>Label peaks and valleys.</h2><span id='topic+stat_label_peaks'></span><span id='topic+stat_label_valleys'></span>

<h3>Description</h3>

<p><code>stat_labels_peaks</code> finds at which x positions local maxima are located,
and adds labels and colors to the data wihtout subsetting. To find local
minima, you can use <code>stat_labels_valleys</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_label_peaks(
  mapping = NULL,
  data = NULL,
  geom = "text",
  position = "identity",
  ...,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  x.label.fmt = label.fmt,
  y.label.fmt = label.fmt,
  label.fill = "",
  na.rm = TRUE,
  show.legend = FALSE,
  inherit.aes = TRUE
)

stat_label_valleys(
  mapping = NULL,
  data = NULL,
  geom = "text",
  position = "identity",
  ...,
  span = 5,
  ignore_threshold = 0,
  strict = TRUE,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  x.label.fmt = label.fmt,
  y.label.fmt = label.fmt,
  label.fill = "",
  na.rm = TRUE,
  show.legend = FALSE,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_label_peaks_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs to be
set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element. The default value is 5, meaning that a peak is bigger than two
consequtive neighbors on each side. Default: 5.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_ignore_threshold">ignore_threshold</code></td>
<td>
<p>numeric value between 0.0 and 1.0 indicating the size
threshold below which peaks will be ignored.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_strict">strict</code></td>
<td>
<p>logical flag: if TRUE, an element must be strictly greater than
all other values in its window to be considered a peak. Default: FALSE.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character  string giving a format definition for converting
values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_x.label.fmt">x.label.fmt</code></td>
<td>
<p>character  string giving a format definition for
converting $x$-values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_y.label.fmt">y.label.fmt</code></td>
<td>
<p>character  string giving a format definition for
converting $y$-values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_label.fill">label.fill</code></td>
<td>
<p>character string ot use for labels not at peaks or valleys
being highlighted.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_label_peaks_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These stats use <code>geom_text</code> by default as it is the geom most
likely to work well in almost any situation without need of tweaking. These
statistics work best with <code>geom_text_repel</code> and
<code>geom_label_repel</code> from package 'ggrepel' as they are designed so that
peak or valley labels will not overlapT any observation in the whole data
set. Default aesthetics set by these stats allow their direct use with
<code>geom_text</code>, <code>geom_label</code>, <code>geom_line</code>, <code>geom_rug</code>,
<code>geom_hline</code> and <code>geom_vline</code>. The formatting of the labels
returned can be controlled by the user.
</p>


<h3>Value</h3>

<p>The original data with additional computed variables added.
</p>


<h3>Computed variables</h3>

 <dl>
<dt>x.label</dt><dd><p>x-value at a peak (or
valley) formatted as character or otherwise the
value passed to <code>label.fill</code> which defaults to an
empty string (<code>""</code>).</p>
</dd>
<dt>y.label</dt><dd><p>y-value at the peak (or valley) formatted as character or
otherwise the value passed to <code>label.fill</code> which defaults to an
empty string (<code>""</code>).</p>
</dd>
<dt>wl.color</dt><dd><p>At peaks and valleys,
color definition calculated by assuming that x-values are wavelengths
expressed in nanometres, otherwise, <code>rgb(1, 1, 1, 0)</code> (transparent
white).</p>
</dd> </dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>
 <dl>
<dt>label</dt><dd><p>..x.label..</p>
</dd> <dt>xintercept</dt><dd><p>..x..</p>
</dd>
<dt>yintercept</dt><dd><p>..y..</p>
</dd> <dt>color</dt><dd><p>black_or_white(..wl.color..)</p>
</dd>
<dt>fill</dt><dd><p>..wl.color..</p>
</dd> </dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set
with <code>aes()</code>. </p>
 <dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd> </dl>



<h3>Note</h3>

<p>These stats work nicely together with geoms <code>geom_text_repel</code> and
<code>geom_label_repel</code> from package <code><a href="ggrepel.html#topic+ggrepel">ggrepel</a></code> to
solve the problem of overlapping labels by displacing them. To discard
overlapping labels use <code>check_overlap = TRUE</code> as argument to
<code>geom_text</code>. By default the labels are character values suitable to be
plotted as is, but with a suitable <code>label.fmt</code> labels suitable for
parsing by the geoms (e.g. into expressions containing greek letters or
super or subscripts) can be also easily obtained.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stat_peaks">stat_peaks</a></code>, <code><a href="#topic+stat_valleys">stat_valleys</a></code> and
<code><a href="photobiology.html#topic+find_peaks">find_peaks</a></code>, which is used internally.
</p>
<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) + geom_line() +
  stat_label_peaks(hjust = "left", span = 31, angle = 90, color = "red")
ggplot(sun.spct) + geom_line() +
  stat_label_valleys(hjust = "right", span = 21, angle = 90, color = "blue")

ggplot(sun.spct) + geom_line() +
  stat_peaks(span = 41, shape = 21, size = 3) +
  stat_label_peaks(span = 41, geom = "label", label.fmt = "%3.0f nm") +
  scale_fill_identity() +
  scale_color_identity() +
  expand_limits(y = c(NA, 1))

# using 'ggrepel' to avoid overlaps
# too slow for CRAN checks
## Not run: 
library(ggrepel)

ggplot(sun.spct) + geom_line() +
  stat_peaks(span = 41, shape = 21, size = 3) +
  stat_label_peaks(span = 41, geom = "label_repel", segment.colour = "red",
                   nudge_y = 0.12, label.fmt = "%3.0f nm", vjust = 1) +
  scale_fill_identity() +
  scale_color_identity() +
  expand_limits(y = c(NA, 1))

## End(Not run)

</code></pre>

<hr>
<h2 id='stat_peaks'>Find peaks and valleys.</h2><span id='topic+stat_peaks'></span><span id='topic+stat_valleys'></span>

<h3>Description</h3>

<p><code>stat_peaks</code> finds at which x positions local maxima are located. If
you want find local minima, you can use <code>stat_valleys</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_peaks(
  mapping = NULL,
  data = NULL,
  geom = "point",
  position = "identity",
  ...,
  span = 5,
  ignore_threshold = 0.01,
  strict = is.null(span),
  refine.wl = FALSE,
  method = "spline",
  chroma.type = "CMF",
  label.fmt = "%.3g",
  x.label.fmt = label.fmt,
  y.label.fmt = label.fmt,
  na.rm = FALSE,
  show.legend = FALSE,
  inherit.aes = TRUE
)

stat_valleys(
  mapping = NULL,
  data = NULL,
  geom = "point",
  position = "identity",
  ...,
  span = 5,
  ignore_threshold = -0.01,
  strict = is.null(span),
  refine.wl = FALSE,
  method = "spline",
  chroma.type = "CMF",
  label.fmt = "%.3g",
  x.label.fmt = label.fmt,
  y.label.fmt = label.fmt,
  na.rm = FALSE,
  show.legend = FALSE,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_peaks_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs to be set
at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points
on this layer</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This can
include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_span">span</code></td>
<td>
<p>integer A peak is defined as an element in a sequence which is
greater than all other elements within a window of width <code>span</code>
centered at that element. Use <code>NULL</code> for the global peak. Valleys are
the reverse.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_ignore_threshold">ignore_threshold</code></td>
<td>
<p>numeric For peaks, value between 0.0 and 1.0
indicating the relative size of peaks compared to tallest peak threshold
below which peaks will be ignored, while negative values between 0.0 and
-1.0 set a threshold so that the tallest peaks are ignored, instead of the
shortest. For valleys, value between 0.0 and 1.0 indicating the relative
depth of valleys below which valleys will be ignored, while negative values
between 0.0 and -1.0 set a threshold so that the deeper valleys are
ignored, instead of the shallower ones.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_strict">strict</code></td>
<td>
<p>logical If <code>TRUE</code>, an element must be strictly greater
than all other values in its window to be considered a peak.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_refine.wl">refine.wl</code></td>
<td>
<p>logical Flag indicating if peak or valleys locations should
be refined by fitting a function.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_method">method</code></td>
<td>
<p>character String with the name of a method used for peak
fitting. Currently only spline interpolation is implemented.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character  string giving a format definition for converting
values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_x.label.fmt">x.label.fmt</code></td>
<td>
<p>character  string giving a format definition for converting
$x$-values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_y.label.fmt">y.label.fmt</code></td>
<td>
<p>character  string giving a format definition for converting
$y$-values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be
stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_peaks_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These stats use <code>geom_point</code> by default as it is the geom most
likely to work well in almost any situation without need of tweaking. The
default aesthetics set by these stats allow their direct use with
<code>geom_text</code>, <code>geom_label</code>, <code>geom_line</code>, <code>geom_rug</code>,
<code>geom_hline</code> and <code>geom_vline</code>. The formatting of the labels
returned can be controlled by the user.
</p>


<h3>Value</h3>

<p>A data frame with one row for each peak (or valley) found in the
data.
</p>


<h3>Computed variables</h3>


<dl>
<dt>x</dt><dd><p>x-value at the peak (or valley) as numeric</p>
</dd>
<dt>y</dt><dd><p>y-value at the peak (or valley) as numeric</p>
</dd>
<dt>x.label</dt><dd><p>x-value at the peak (or valley) formatted as character</p>
</dd>
<dt>y.label</dt><dd><p>y-value at the peak (or valley) formatted as character</p>
</dd>
<dt>wl.color</dt><dd><p>color definition calculated by assuming that x-values are
wavelengths expressed in nanometres.</p>
</dd>
<dt>BW.color</dt><dd><p>color definition, either &quot;black&quot; or &quot;white&quot;, as needed to
ensure high contrast to <code>wl.color</code>.</p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>stat(x.label)</p>
</dd>
<dt>xintercept</dt><dd><p>stat(x)</p>
</dd>
<dt>yintercept</dt><dd><p>stat(y)</p>
</dd>
<dt>fill</dt><dd><p>stat(wl.color)</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>Note</h3>

<p>These stats work nicely together with geoms
<code>geom_text_repel</code> and
<code>geom_label_repel</code> from package
<code><a href="ggrepel.html#topic+ggrepel">ggrepel</a></code> to solve the problem of overlapping labels
by displacing them. To discard overlapping labels use <code>check_overlap =
  TRUE</code> as argument to <code>geom_text</code>.
By default the labels are character values suitable to be plotted as is, but
with a suitable <code>label.fmt</code> labels suitable for parsing by the geoms
(e.g. into expressions containing greek letters or super or subscripts) can
be also easily obtained.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+find_peaks">find_peaks</a></code>, which is used internally.
</p>
<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) +
  geom_line() +
  stat_peaks()

ggplot(sun.spct) +
  geom_line() +
  stat_valleys()

ggplot(sun.spct) +
  geom_line() +
  stat_peaks(span = 51, geom = "point", colour = "red") +
  stat_peaks(span = 51, geom = "text", colour = "red",
             vjust = -0.4, label.fmt = "%3.2f nm")

ggplot(sun.spct) +
  geom_line() +
  stat_peaks(span = 51, geom = "point", colour = "red", refine.wl = TRUE) +
  stat_peaks(span = 51, geom = "text", colour = "red",
             vjust = -0.4, label.fmt = "%3.2f nm",
             refine.wl = TRUE)

ggplot(sun.spct) +
  geom_line() +
  stat_peaks(span = 51, geom = "point", colour = "red", refine.wl = TRUE) +
  stat_peaks(mapping = aes(fill = after_stat(wl.colour), color = after_stat(BW.colour)),
             span = 51, geom = "label",
             size = 3, vjust = -0.2, label.fmt = "%.3g nm",
             refine.wl = TRUE) +
  stat_valleys(span = 71, geom = "point", colour = "blue", refine.wl = TRUE) +
  stat_valleys(mapping = aes(fill = after_stat(wl.colour), color = after_stat(BW.colour)),
               span = 71, geom = "label",
               size = 3, vjust = 1.2, label.fmt = "%.3g nm",
               refine.wl = TRUE) +
  expand_limits(y = 0.85) + # make room for label
  scale_fill_identity() +
  scale_color_identity()

</code></pre>

<hr>
<h2 id='stat_spikes'>Find spikes</h2><span id='topic+stat_spikes'></span>

<h3>Description</h3>

<p><code>stat_spikes</code> finds at which x positions spikes are located. Spikes
can be either upwards or downwards from the baseline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_spikes(
  mapping = NULL,
  data = NULL,
  geom = "point",
  position = "identity",
  ...,
  z.threshold = 9,
  max.spike.width = 8,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  x.label.fmt = label.fmt,
  y.label.fmt = label.fmt,
  na.rm = FALSE,
  show.legend = FALSE,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_spikes_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs to be set
at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points
on this layer</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This can
include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_z.threshold">z.threshold</code></td>
<td>
<p>numeric Modified Z values larger than <code>z.threshold</code>
are considered to be spikes.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_max.spike.width">max.spike.width</code></td>
<td>
<p>integer Wider regions with high Z values are not detected as
spikes.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character  string giving a format definition for converting
values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_x.label.fmt">x.label.fmt</code></td>
<td>
<p>character  string giving a format definition for converting
$x$-values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_y.label.fmt">y.label.fmt</code></td>
<td>
<p>character  string giving a format definition for converting
$y$-values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be
stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_spikes_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This stat uses <code>geom_point</code> by default as it is the geom most
likely to work well in almost any situation without need of tweaking. The
default aesthetics set by this stat allows its direct use with
<code>geom_text</code>, <code>geom_label</code>, <code>geom_line</code>, <code>geom_rug</code>,
<code>geom_hline</code> and <code>geom_vline</code>. The formatting of the labels
returned can be controlled by the user.
</p>


<h3>Value</h3>

<p>A data frame with one row for each peak (or valley) found in the
data.
</p>


<h3>Computed variables</h3>


<dl>
<dt>x</dt><dd><p>x-value at the peak (or valley) as numeric</p>
</dd>
<dt>y</dt><dd><p>y-value at the peak (or valley) as numeric</p>
</dd>
<dt>x.label</dt><dd><p>x-value at the peak (or valley) formatted as character</p>
</dd>
<dt>y.label</dt><dd><p>y-value at the peak (or valley) formatted as character</p>
</dd>
<dt>wl.color</dt><dd><p>color definition calculated by assuming that x-values are
wavelengths expressed in nanometres.</p>
</dd>
<dt>BW.color</dt><dd><p>color definition that either &quot;black&quot; or &quot;white&quot;, to ensure
high contrast to <code>wl.color</code>.</p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>stat(x.label)</p>
</dd>
<dt>xintercept</dt><dd><p>stat(x)</p>
</dd>
<dt>yintercept</dt><dd><p>stat(y)</p>
</dd>
<dt>fill</dt><dd><p>stat(wl.color)</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>Note</h3>

<p>This stat works nicely together with geoms
<code>geom_text_repel</code> and
<code>geom_label_repel</code> from package
<code><a href="ggrepel.html#topic+ggrepel">ggrepel</a></code> to solve the problem of overlapping labels
by displacing them. To discard overlapping labels use <code>check_overlap =
  TRUE</code> as argument to <code>geom_text</code>.
By default the labels are character values suitable to be plotted as is, but
with a suitable <code>label.fmt</code> labels suitable for parsing by the geoms
(e.g. into expressions containing greek letters or super or subscripts) can
be also easily obtained.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+find_spikes">find_spikes</a></code>, which is used internally,
for a description of the algorithm used.
</p>
<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ggplot() methods for spectral objects set a default mapping for x and y.

# two spurious(?) spikes
ggplot(sun.spct) +
  geom_line() +
  stat_spikes(colour = "red", alpha = 0.3)

# no spikes detected
ggplot(sun.spct) +
  geom_line() +
  stat_spikes(colour = "red", alpha = 0.3,
              max.spike.width = 3,
              z.threshold = 12)

# small noise spikes detected
ggplot(white_led.raw_spct) +
  geom_line() +
  stat_spikes(colour = "red", alpha = 0.3)

ggplot(white_led.raw_spct) +
  geom_line() +
  stat_spikes(colour = "red", alpha = 0.3) +
  stat_spikes(geom = "text", colour = "red", check_overlap = TRUE,
             vjust = -0.5, label.fmt = "%3.0f nm")

ggplot(white_led.raw_spct, aes(w.length, counts_2)) +
  geom_line() +
  stat_spikes(colour = "red", alpha = 0.3,
              max.spike.width = 3,
              z.threshold = 12)

</code></pre>

<hr>
<h2 id='stat_wb_box'>Draw colour boxes for wavebands</h2><span id='topic+stat_wb_box'></span>

<h3>Description</h3>

<p><code>stat_wb_box</code> plots boxes corresponding to wavebands, by default located
slightly above the peak of the spectrum. Sets suitable default aesthetics for
&quot;rect&quot; geom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_box(
  mapping = NULL,
  data = NULL,
  geom = "rect",
  w.band = NULL,
  chroma.type = "CMF",
  ypos.mult = 1.07,
  ypos.fixed = NULL,
  box.height = 0.06,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_box_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_ypos.mult">ypos.mult</code></td>
<td>
<p>numeric Multiplier constant used to compute returned
<code>y</code> values. This is numerically similar to using npc units, but values
larger than one expand the plotting area.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_ypos.fixed">ypos.fixed</code></td>
<td>
<p>numeric If not <code>NULL</code> used a constant value returned
in <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_box.height">box.height</code></td>
<td>
<p>numeric The height of the box as a fraction of the range of
$y$. This is similar to using npc units.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_box_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument
to <code>w.band</code>. Wavebeand outside the range of the spectral data are
trimmed or discarded.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of appying <code>integral.fun</code>
to the data, with default <code>integrate_xy</code>.
</p>

<dl>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd>
<dt>wb.xmin</dt><dd><p>w.band minimum</p>
</dd>
<dt>wb.xmax</dt><dd><p>w.band maximum</p>
</dd>
<dt>wb.ymin</dt><dd><p>data$y minimum</p>
</dd>
<dt>wb.ymax</dt><dd><p>data$y maximum</p>
</dd>
<dt>ymin</dt><dd><p>box bottom</p>
</dd>
<dt>ymax</dt><dd><p>box top</p>
</dd>
<dt>y</dt><dd><p>ypos.fixed or top of data, adjusted by <code>ypos.mult</code></p>
</dd>
<dt>wb.color</dt><dd><p>color of the w.band</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
<dt>BW.color</dt><dd><p><code>black_or_white(wb.color)</code></p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>xmin</dt><dd><p>stat(wb.xmin)</p>
</dd>
<dt>xmax</dt><dd><p>stat(wb.xmax)</p>
</dd>
<dt>ymin</dt><dd><p>stat(ymin)</p>
</dd>
<dt>ymax</dt><dd><p>stat(ymax)</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>Note</h3>

<p>This stat uses a panel function and ignores grouping as it is meant to
be used for annotations.The value returned as default value for <code>y</code> is
based on the y-range of spectral values for the whole data set.
</p>


<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) +
  stat_wb_box(w.band = VIS_bands()) +
  geom_line() +
  scale_fill_identity()
ggplot(sun.spct) +
  stat_wb_box(w.band = VIS_bands(), color = "white") +
  geom_line() +
  scale_fill_identity()

</code></pre>

<hr>
<h2 id='stat_wb_column'>Integrate ranges under curve.</h2><span id='topic+stat_wb_column'></span>

<h3>Description</h3>

<p><code>stat_wb_column</code> computes means under a curve. It first integrates the
area under a spectral curve and also the mean expressed per nanaometre of
wavelength for each waveband in the input. Sets suitable default aesthetics
for &quot;rect&quot; geom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_column(
  mapping = NULL,
  data = NULL,
  geom = "rect",
  w.band = NULL,
  integral.fun = integrate_xy,
  chroma.type = "CMF",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_column_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_integral.fun">integral.fun</code></td>
<td>
<p>function on $x$ and $y$.</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_column_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument
to <code>w.band</code>. Wavebeand outside the range of the spectral data are
trimmed or discarded.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of appying <code>integral.fun</code>,
with default <code>integrate_xy</code>.
</p>

<dl>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd>
<dt>wb.xmin</dt><dd><p>w.band minimum</p>
</dd>
<dt>wb.xmax</dt><dd><p>w.band maximum</p>
</dd>
<dt>wb.ymin</dt><dd><p>data$y minimum</p>
</dd>
<dt>wb.ymax</dt><dd><p>data$y maximum</p>
</dd>
<dt>wb.ymean</dt><dd><p>yint divided by wl_expanse(w.band)</p>
</dd>
<dt>y</dt><dd><p>wb.ymeam</p>
</dd>
<dt>wb.color</dt><dd><p>color of the w.band</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
<dt>BW.color</dt><dd><p><code>black_or_white(wb.color)</code></p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>xmin</dt><dd><p>..wb.xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..wb.xmax..</p>
</dd>
<dt>ymin</dt><dd><p>0</p>
</dd>
<dt>ymax</dt><dd><p>..wb.ymean..</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>Note</h3>

<p>If the argument passed to <code>w.band</code> is a BSWF it is silently
converted to a wavelength range and the average of spectral values without
weighting is returned as default value for <code>ymax</code> while the default
value for <code>ymin</code> is zero.
</p>


<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) +
  stat_wb_column(w.band = VIS_bands()) +
  geom_line() +
  scale_fill_identity()

ggplot(sun.spct) +
  stat_wb_column(w.band = VIS_bands(), alpha = 0.5) +
  geom_line() +
  scale_fill_identity()

</code></pre>

<hr>
<h2 id='stat_wb_contribution'>Integrate ranges under spectral curve.</h2><span id='topic+stat_wb_contribution'></span>

<h3>Description</h3>

<p><code>stat_wb_contribution</code> computes means under a curve. It first integrates the
area under a spectral curve and also the mean expressed per nanaometre of
wavelength for each waveband in the input. Sets suitable default aesthetics
for &quot;rect&quot;, &quot;hline&quot;, &quot;vline&quot;, &quot;text&quot; and &quot;label&quot; geoms displaying &quot;contributions&quot;
per waveband to the total of the spectral integral.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_contribution(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  integral.fun = integrate_xy,
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%1.2f",
  ypos.mult = 1.07,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_contribution_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_integral.fun">integral.fun</code></td>
<td>
<p>function on $x$ and $y$.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_label.mult">label.mult</code></td>
<td>
<p>numeric Scaling factor applied to y-integral values before
conversion into character strings.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character string giving a format definition for converting
y-integral values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_ypos.mult">ypos.mult</code></td>
<td>
<p>numeric Multiplier constant used to scale returned
<code>y</code> values.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_ypos.fixed">ypos.fixed</code></td>
<td>
<p>numeric If not <code>NULL</code> used a constant value returned
in <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_contribution_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument
to <code>w.band</code>. Wavebeand outside the range of the spectral data are
trimmed or discarded.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of appying <code>integral.fun</code>
to the data, with default <code>integrate_xy</code>.
</p>

<dl>
<dt>y.label</dt><dd><p>yint multiplied by <code>label.mult</code> and formatted
according to <code>label.fmt</code></p>
</dd>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd>
<dt>xmin</dt><dd><p>w.band minimum</p>
</dd>
<dt>xmax</dt><dd><p>w.band maximum</p>
</dd>
<dt>ymin</dt><dd><p>data$y minimum</p>
</dd>
<dt>ymax</dt><dd><p>data$y maximum</p>
</dd>
<dt>yint</dt><dd><p>data$y integral for w.band / data$y integral for whole range
of data$x</p>
</dd>
<dt>xmean</dt><dd><p>yint divided by wl_expanse(w.band)</p>
</dd>
<dt>y</dt><dd><p>ypos.fixed or top of data, adjusted by <code>ypos.mult</code></p>
</dd>
<dt>wb.color</dt><dd><p>color of the w.band</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>..y.label..</p>
</dd>
<dt>x</dt><dd><p>..x..</p>
</dd>
<dt>xmin</dt><dd><p>..xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..xmax..</p>
</dd>
<dt>ymin</dt><dd><p>..y.. - (..ymax.. - ..ymin..) * 0.03</p>
</dd>
<dt>ymax</dt><dd><p>..y.. + (..ymax.. - ..ymin..) * 0.03</p>
</dd>
<dt>yintercept</dt><dd><p>..ymean..</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.

# Using defaults
ggplot(sun.spct) +
  geom_line() +
  stat_wb_box(w.band = VIS()) +
  stat_wb_contribution(w.band = VIS()) +
  scale_fill_identity() + scale_color_identity()

# Setting position and angle of the text
ggplot(sun.spct) +
  geom_line() +
  stat_wb_box(w.band = VIS_bands()) +
  stat_wb_contribution(w.band = VIS_bands(), angle = 90, size = 2.5) +
  scale_fill_identity() + scale_color_identity()

# Showing percentages, i.e., using a different format for numbers
ggplot(sun.spct) +
  geom_line() +
  stat_wb_box(w.band = VIS_bands()) +
  stat_wb_contribution(w.band = VIS_bands(), size = 2.5,
                       label.mult = 100, label.fmt = "%3.0f%%") +
  scale_fill_identity() + scale_color_identity()

# Including the name of the waveband, i.e., changing the mapping for label
ggplot(sun.spct, range = c(NA, 410)) +
  geom_line() +
  stat_wb_box(w.band = UV_bands(), color = "white") +
  stat_wb_contribution(w.band = UV_bands(), size = 2.5,
                       label.mult = 100, label.fmt = "%3.0f%%",
                       mapping = aes(label = after_stat(paste(wb.name, y.label)))) +
  scale_fill_identity() + scale_color_identity()

</code></pre>

<hr>
<h2 id='stat_wb_hbar'>Integrate ranges under curve.</h2><span id='topic+stat_wb_hbar'></span>

<h3>Description</h3>

<p><code>stat_wb_hbar</code> computes means under a curve. It first integrates the
area under a spectral curve and also the mean expressed per nanaometre of
wavelength for each waveband in the input. Sets suitable default aesthetics
for geoms &quot;errorbarh&quot; and &quot;hline&quot; from 'ggplot', and &quot;linerangeh&quot;,
and &quot;errorbarh&quot; from 'ggstance'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_hbar(
  mapping = NULL,
  data = NULL,
  geom = "errorbarh",
  w.band = NULL,
  integral.fun = integrate_xy,
  chroma.type = "CMF",
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_hbar_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_integral.fun">integral.fun</code></td>
<td>
<p>function on $x$ and $y$.</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_ypos.fixed">ypos.fixed</code></td>
<td>
<p>numeric If not <code>NULL</code> used a constant value returned
in <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_hbar_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument to
<code>w.band</code>. Wavebeand outside the range of the spectral data are trimmed
or discarded.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of
appying <code>integral.fun</code>, with default <code>integrate_xy</code>. </p>

<dl>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd> <dt>xmin</dt><dd><p>w.band minimum</p>
</dd> <dt>xmax</dt><dd><p>w.band
maximum</p>
</dd> <dt>ymin</dt><dd><p>data$y minimum</p>
</dd> <dt>ymax</dt><dd><p>data$y maximum</p>
</dd>
<dt>yint</dt><dd><p>data$y integral for the range of <code>w.band</code></p>
</dd>
<dt>ymean</dt><dd><p>yint divided by wl_expanse(w.band)</p>
</dd> <dt>y</dt><dd><p>ypos.fixed or mean of
data</p>
</dd> <dt>wb.color</dt><dd><p>color of the w.band</p>
</dd> <dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>xmin</dt><dd><p>..xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..xmax..</p>
</dd>
<dt>yintercept</dt><dd><p>..ymean..</p>
</dd>
<dt>height</dt><dd><p>(..ymax.. - ..ymin..) * 2e-2</p>
</dd>
<dt>color</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set
with <code>aes()</code>. </p>
 <dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd> </dl>



<h3>Note</h3>

<p>If the argument passed to <code>w.band</code> is a BSWF it is silently
converted to a wavelength range and the average of spectral values without
any weighting is returned as default value for <code>y</code>.
</p>


<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) +
  geom_line() +
  stat_wb_hbar(w.band = VIS_bands(), size = 1) +
  scale_color_identity() +
  theme_bw()

ggplot(sun.spct) +
  geom_line() +
  stat_wb_hbar(w.band = PAR(), size = 1) +
  scale_color_identity() +
  theme_bw()

ggplot(sun.spct) +
  geom_line() +
  stat_wb_hbar(w.band = PAR(), size = 1, ypos.fixed = 0) +
  scale_color_identity() +
  theme_bw()

ggplot(sun.spct) +
  geom_line() +
  stat_wb_hbar(w.band = CIE(), size = 1) +
  scale_color_identity() +
  theme_bw()

</code></pre>

<hr>
<h2 id='stat_wb_irrad'>Integrate irradiance for wavebands.</h2><span id='topic+stat_wb_irrad'></span><span id='topic+stat_wb_e_irrad'></span><span id='topic+stat_wb_q_irrad'></span>

<h3>Description</h3>

<p><code>stat_wb_irrad</code> computes areas under a curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_irrad(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  time.unit,
  unit.in,
  label.qty = "total",
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  ypos.mult = 1.07,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)

stat_wb_e_irrad(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  time.unit = "second",
  unit.in = "energy",
  label.qty = "total",
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  ypos.mult = 1.07,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)

stat_wb_q_irrad(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  time.unit = "second",
  unit.in = "photon",
  label.qty = "total",
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  ypos.mult = 1.07,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_irrad_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_time.unit">time.unit</code></td>
<td>
<p>character or lubridate::duration</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_unit.in">unit.in</code></td>
<td>
<p>character One of &quot;photon&quot;,&quot;quantum&quot; or &quot;energy&quot;</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_label.qty">label.qty</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_label.mult">label.mult</code></td>
<td>
<p>numeric Scaling factor applied to y-integral values before
conversion into character strings.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character string giving a format definition for converting
y-integral values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_ypos.mult">ypos.mult</code></td>
<td>
<p>numeric Multiplier constant used to scale returned
<code>y</code> values.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_ypos.fixed">ypos.fixed</code></td>
<td>
<p>numeric If not <code>NULL</code> used a constant value returned
in <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_irrad_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument
to <code>w.band</code>. Wavebeand outside the range of the spectral data are
trimmed or discarded.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of appying <code>irrad</code>,
<code>e_irrad</code> or <code>q_irrad</code> to the data.
</p>

<dl>
<dt>y.label</dt><dd><p>yeff multiplied by <code>label.mult</code> and formatted
according to <code>label.fmt</code></p>
</dd>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd>
<dt>wb.xmin</dt><dd><p>w.band minimum</p>
</dd>
<dt>wb.xmax</dt><dd><p>w.band maximum</p>
</dd>
<dt>wb.ymin</dt><dd><p>data$y minimum</p>
</dd>
<dt>wb.ymax</dt><dd><p>data$y maximum</p>
</dd>
<dt>wb.yeff</dt><dd><p>weighted irradiance if <code>w.band</code> describes a BSWF</p>
</dd>
<dt>wb.yint</dt><dd><p>not weighted irradiance for the range of <code>w.band</code></p>
</dd>
<dt>wb.xmean</dt><dd><p>yint divided by wl_expanse(w.band)</p>
</dd>
<dt>y</dt><dd><p>ypos.fixed or top of data, adjusted by <code>ypos.mult</code></p>
</dd>
<dt>wb.color</dt><dd><p>color of the w.band</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
<dt>BW.color</dt><dd><p><code>black_or_white(wb.color)</code></p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>..y.label..</p>
</dd>
<dt>x</dt><dd><p>..x..</p>
</dd>
<dt>xmin</dt><dd><p>..wb.xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..wb.xmax..</p>
</dd>
<dt>ymin</dt><dd><p>..y.. - (..wb.ymax.. - ..wb.ymin..) * 0.03</p>
</dd>
<dt>ymax</dt><dd><p>..y.. + (..wb.ymax.. - ..wb.ymin..) * 0.03</p>
</dd>
<dt>yintercept</dt><dd><p>..wb.ymean..</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.

# using defaults for energy irradiance in W m-2
ggplot(sun.spct) +
  stat_wb_column(w.band = PAR(), alpha = 0.5) +
  stat_wb_e_irrad(w.band = PAR(), ypos.fixed = 0.32) +
  geom_line() +
  scale_fill_identity() + scale_color_identity()

# using defaults for photon irradiance in umol m-2 s-1
ggplot(sun.spct, unit.out = "photon") +
  stat_wb_column(w.band = PAR(), alpha = 0.5) +
  stat_wb_q_irrad(w.band = PAR(), ypos.fixed = 1.5e-6, label.mult = 1e6) +
  geom_line() +
  scale_fill_identity() + scale_color_identity()

# modify label format and position
ggplot(sun.spct) +
  stat_wb_column(w.band = VIS_bands(), alpha = 0.7) +
  stat_wb_e_irrad(w.band = VIS_bands(),
                  angle = 90, size = 3, hjust = "left",
                  label.fmt = "%2.0f~~W~m^{-2}", parse = TRUE,
                  ypos.fixed = 0.1) +
  geom_line() +
  scale_fill_identity() + scale_color_identity()

# Changing label mapping
ggplot(sun.spct) +
  stat_wb_column(w.band = VIS_bands(), alpha = 0.5) +
  stat_wb_e_irrad(w.band = VIS_bands(),
               label.fmt = "%.2f",
               angle = 90, color = "black", ypos.fixed = 0.1,
               hjust = "left", size = 3,
               mapping = aes(label = after_stat(paste(wb.name, ": ",
                                                signif(wb.yint, 3),
                                                sep = "")))) +
  geom_line() +
  scale_fill_identity() + scale_color_identity() +
  theme_bw()

</code></pre>

<hr>
<h2 id='stat_wb_label'>Label ranges under spectral curve.</h2><span id='topic+stat_wb_label'></span>

<h3>Description</h3>

<p><code>stat_wb_label</code> computes computes the center of a waveband. Sets
suitable default aesthetics for &quot;text&quot; and &quot;label&quot;
geoms displaying &quot;boundaries&quot; and &quot;names&quot; of wavebands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_label(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  chroma.type = "CMF",
  label.fmt = "%s",
  ypos.fixed = 0,
  position = "identity",
  na.rm = TRUE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_label_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character string giving a format definition for formating
the name of the waveband.
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_ypos.fixed">ypos.fixed</code></td>
<td>
<p>numeric If not <code>NULL</code> used a constant value returned
in <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_label_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument
to <code>w.band</code>. Wavebeand outside the range of the spectral data are
trimmed or discarded.
</p>


<h3>Computed variables</h3>


<dl>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd>
<dt>wb.xmin</dt><dd><p>w.band minimum</p>
</dd>
<dt>wb.xmax</dt><dd><p>w.band maximum</p>
</dd>
<dt>y</dt><dd><p>ypos.fixed or zero</p>
</dd>
<dt>wb.color</dt><dd><p>color of the w.band</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
<dt>wb.label</dt><dd><p>formatted wb.name</p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>..wb.label..</p>
</dd>
<dt>x</dt><dd><p>..x..</p>
</dd>
<dt>xmin</dt><dd><p>..wb.xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..wb.xmax..</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
</dl>



<h3>Note</h3>

<p>This stat uses a panel function and ignores grouping as it is meant to
be used for annotations.
</p>


<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) +
  geom_line() +
  stat_wb_box(w.band = VIS(), ymin = -0.04, ymax = 0,
  color = "black", fill = "white") +
  stat_wb_label(w.band = VIS(), ypos.fixed = -0.02, color = "black")

ggplot(sun.spct) +
  geom_line() +
  stat_wb_hbar(w.band = PAR(), ypos.fixed = 0, size = 1) +
  stat_wb_label(aes(color = ..wb.color..),
                w.band = PAR(), ypos.fixed = +0.025) +
  scale_color_identity()

</code></pre>

<hr>
<h2 id='stat_wb_mean'>Integrate ranges under curve.</h2><span id='topic+stat_wb_mean'></span>

<h3>Description</h3>

<p><code>stat_wb_mean</code> computes means under a curve. It first integrates the
area under a spectral curve and also the mean expressed per nanaometre of
wavelength for each waveband in the input. Sets suitable default aesthetics
for &quot;rect&quot;, &quot;hline&quot;, &quot;vline&quot;, &quot;text&quot; and &quot;label&quot; geoms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_mean(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  integral.fun = integrate_xy,
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  ypos.mult = 1.07,
  xpos.fixed = NULL,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_mean_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_integral.fun">integral.fun</code></td>
<td>
<p>function on $x$ and $y$.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_label.mult">label.mult</code></td>
<td>
<p>numeric Scaling factor applied to y-integral values before
conversion into character strings.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character string giving a format definition for converting
y-integral values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_ypos.mult">ypos.mult</code></td>
<td>
<p>numeric Multiplier constant used to scale returned
<code>y</code> values.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_xpos.fixed">xpos.fixed</code>, <code id="stat_wb_mean_+3A_ypos.fixed">ypos.fixed</code></td>
<td>
<p>numeric If not <code>NULL</code> used as constant value returned
in <code>x</code> or <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_mean_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument
to <code>w.band</code>. Wavebeand outside the range of the spectral data are
trimmed or discarded.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of appying <code>integral.fun</code>,
with default <code>integrate_xy</code>.
</p>

<dl>
<dt>y.label</dt><dd><p>ymean multiplied by <code>label.mult</code> and formatted
according to <code>label.fmt</code></p>
</dd>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd>
<dt>wb.xmin</dt><dd><p>w.band minimum</p>
</dd>
<dt>wb.xmax</dt><dd><p>w.band maximum</p>
</dd>
<dt>wb.ymin</dt><dd><p>data$y minimum</p>
</dd>
<dt>wb.ymax</dt><dd><p>data$y maximum</p>
</dd>
<dt>wb.yint</dt><dd><p>data$y integral for the range of <code>w.band</code></p>
</dd>
<dt>wb.xmean</dt><dd><p>yint divided by wl_expanse(w.band)</p>
</dd>
<dt>y</dt><dd><p>ypos.fixed or top of data, adjusted by <code>ypos.mult</code></p>
</dd>
<dt>wb.color</dt><dd><p>color of the w.band</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
<dt>BW.color</dt><dd><p><code>black_or_white(wb.color)</code></p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>..y.label..</p>
</dd>
<dt>x</dt><dd><p>..x..</p>
</dd>
<dt>xmin</dt><dd><p>..wb.xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..wb.xmax..</p>
</dd>
<dt>ymin</dt><dd><p>0</p>
</dd>
<dt>ymax</dt><dd><p>..wb.ymean..</p>
</dd>
<dt>yintercept</dt><dd><p>..wb.ymean..</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.

# Using defaults
ggplot(sun.spct) +
  stat_wb_column(w.band = VIS_bands()) +
  stat_wb_mean(w.band = VIS_bands(),
               color = "black") +
  scale_fill_identity() + scale_color_identity()

# Setting format for numbers, position, angle, and color
ggplot(sun.spct) +
  stat_wb_column(w.band = VIS_bands(), alpha = 0.5) +
  stat_wb_mean(w.band = VIS_bands(),
               label.fmt = "%.2f",
               angle = 90, color = "black", ypos.fixed = 0.1) +
  geom_line() +
  scale_fill_identity() + scale_color_identity() +
  theme_bw()

# Changing label mapping
ggplot(sun.spct) +
  stat_wb_column(w.band = VIS_bands(), alpha = 0.5) +
  stat_wb_mean(w.band = VIS_bands(),
               label.fmt = "%.2f",
               angle = 90, color = "black", ypos.fixed = 0.1,
               hjust = "left", size = 3,
               mapping = aes(label = after_stat(paste(wb.name, ": ", y.label, sep = "")))) +
  geom_line() +
  scale_fill_identity() + scale_color_identity() +
  theme_bw()

# example using repulsion
library(ggrepel)
ggplot(sun.spct) +
  geom_line() +
  stat_wb_hbar(w.band = VIS_bands(), size = 1.5) +
  stat_wb_mean(w.band = VIS_bands(),
               geom = "label_repel", nudge_y = +0.04, size = 3,
               segment.colour = NA, label.size = NA) +
  expand_limits(y = 0.9) +
  scale_fill_identity() + scale_color_identity() +
  theme_bw()

</code></pre>

<hr>
<h2 id='stat_wb_relative'>Integrate ranges under spectral curve.</h2><span id='topic+stat_wb_relative'></span>

<h3>Description</h3>

<p><code>stat_wb_relative</code> computes means under a curve. It first integrates the
area under a spectral curve and also the mean expressed per nanaometre of
wavelength for each waveband in the input. Sets suitable default aesthetics
for &quot;rect&quot;, &quot;hline&quot;, &quot;vline&quot;, &quot;text&quot; and &quot;label&quot; geoms displaying
values per waveband &quot;relative&quot; to the sum of the wavebands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_relative(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  integral.fun = integrate_xy,
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%1.2f",
  ypos.mult = 1.07,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_relative_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_integral.fun">integral.fun</code></td>
<td>
<p>function on $x$ and $y$.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_label.mult">label.mult</code></td>
<td>
<p>numeric Scaling factor applied to y-integral values before
conversion into character strings.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character string giving a format definition for converting
y-integral values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_ypos.mult">ypos.mult</code></td>
<td>
<p>numeric Multiplier constant used to scale returned
<code>y</code> values.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_ypos.fixed">ypos.fixed</code></td>
<td>
<p>numeric If not <code>NULL</code> used a constant value returned
in <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_relative_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument
to <code>w.band</code>. Wavebeand outside the range of the spectral data are
trimmed or discarded.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of appying <code>integral.fun</code>
to the data, with default <code>integrate_xy</code>.
</p>

<dl>
<dt>y.label</dt><dd><p>yint multiplied by <code>label.mult</code> and formatted
according to <code>label.fmt</code></p>
</dd>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd>
<dt>wb.xmin</dt><dd><p>w.band minimum</p>
</dd>
<dt>wb.xmax</dt><dd><p>w.band maximum</p>
</dd>
<dt>wb.ymin</dt><dd><p>data$y minimum</p>
</dd>
<dt>wb.ymax</dt><dd><p>data$y maximum</p>
</dd>
<dt>wb.yint</dt><dd><p>data$y integral for each mebmer of w.band / sum of data$y
integrals for all wavebands in w.band</p>
</dd>
<dt>wb.xmean</dt><dd><p>yint divided by wl_expanse(w.band)</p>
</dd>
<dt>y</dt><dd><p>ypos.fixed or top of data, adjusted by <code>ypos.mult</code></p>
</dd>
<dt>wb.color</dt><dd><p>color of the w.band</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
<dt>BW.color</dt><dd><p><code>black_or_white(wb.color)</code></p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>..y.label..</p>
</dd>
<dt>x</dt><dd><p>..x..</p>
</dd>
<dt>xmin</dt><dd><p>..wb.xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..wb.xmax..</p>
</dd>
<dt>ymin</dt><dd><p>..y.. - (..wb.ymax.. - ..wb.ymin..) * 0.03</p>
</dd>
<dt>ymax</dt><dd><p>..y.. + (..wb.ymax.. - ..wb.ymin..) * 0.03</p>
</dd>
<dt>yintercept</dt><dd><p>..wb.ymean..</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) +
  geom_line() +
  stat_wb_box(w.band = VIS()) +
  stat_wb_relative(w.band = VIS()) +
  scale_fill_identity() + scale_color_identity()

ggplot(sun.spct) +
  geom_line() +
  stat_wb_box(w.band = VIS_bands()) +
  stat_wb_relative(w.band = VIS_bands(), angle = 90, size = 2.5) +
  scale_fill_identity() + scale_color_identity()

ggplot(sun.spct) +
  geom_line() +
  stat_wb_box(w.band = VIS_bands()) +
  stat_wb_relative(w.band = VIS_bands(), angle = 90, size = 2.5,
                   label.mult = 100, label.fmt = "%3.0f%%") +
  scale_fill_identity() + scale_color_identity()

</code></pre>

<hr>
<h2 id='stat_wb_sirrad'>Integrate spectral irradiance for wavebands.</h2><span id='topic+stat_wb_sirrad'></span><span id='topic+stat_wb_e_sirrad'></span><span id='topic+stat_wb_q_sirrad'></span>

<h3>Description</h3>

<p><code>stat_wb_sirrad</code> computes areas under a curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_sirrad(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  time.unit,
  unit.in,
  label.qty = "mean",
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  ypos.mult = 0.55,
  xpos.fixed = NULL,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)

stat_wb_e_sirrad(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  time.unit = "second",
  unit.in = "energy",
  label.qty = "mean",
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  ypos.mult = 0.55,
  xpos.fixed = NULL,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)

stat_wb_q_sirrad(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  time.unit = "second",
  unit.in = "photon",
  label.qty = "mean",
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  ypos.mult = 1.07,
  xpos.fixed = NULL,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_sirrad_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_time.unit">time.unit</code></td>
<td>
<p>character or lubridate::duration</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_unit.in">unit.in</code></td>
<td>
<p>character One of &quot;photon&quot;,&quot;quantum&quot; or &quot;energy&quot;</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_label.qty">label.qty</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_label.mult">label.mult</code></td>
<td>
<p>numeric Scaling factor applied to y-integral values before
conversion into character strings.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character string giving a format definition for converting
y-integral values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_ypos.mult">ypos.mult</code></td>
<td>
<p>numeric Multiplier constant used to scale returned
<code>y</code> values.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_xpos.fixed">xpos.fixed</code>, <code id="stat_wb_sirrad_+3A_ypos.fixed">ypos.fixed</code></td>
<td>
<p>numeric If not <code>NULL</code> used a constant value returned
in <code>x</code> or <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_sirrad_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument
to <code>w.band</code>. Wavebeand outside the range of the spectral data are
trimmed or discarded.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of appying <code>irrad</code>,
<code>e_irrad</code> or <code>q_irrad</code> to the data.
</p>

<dl>
<dt>y.label</dt><dd><p>yeff multiplied by <code>label.mult</code> and formatted
according to <code>label.fmt</code></p>
</dd>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd>
<dt>wb.xmin</dt><dd><p>w.band minimum</p>
</dd>
<dt>wb.xmax</dt><dd><p>w.band maximum</p>
</dd>
<dt>wb.ymin</dt><dd><p>data$y minimum</p>
</dd>
<dt>wb.ymax</dt><dd><p>data$y maximum</p>
</dd>
<dt>wb.yeff</dt><dd><p>weighted irradiance if <code>w.band</code> describes a BSWF</p>
</dd>
<dt>wb.yint</dt><dd><p>not weighted irradiance for the range of <code>w.band</code></p>
</dd>
<dt>wb.xmean</dt><dd><p>yint divided by wl_expanse(w.band)</p>
</dd>
<dt>y</dt><dd><p>ypos.fixed or top of data, adjusted by <code>ypos.mult</code></p>
</dd>
<dt>wb.color</dt><dd><p>color of the w.band</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
<dt>BW.color</dt><dd><p><code>black_or_white(wb.color)</code></p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>..y.label..</p>
</dd>
<dt>x</dt><dd><p>..x..</p>
</dd>
<dt>xmin</dt><dd><p>..wb.xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..wb.xmax..</p>
</dd>
<dt>ymin</dt><dd><p>0</p>
</dd>
<dt>ymax</dt><dd><p>..wb.ymean..</p>
</dd>
<dt>yintercept</dt><dd><p>..wb.ymean..</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) +
  stat_wb_column(w.band = VIS_bands()) +
  stat_wb_e_sirrad(w.band = VIS_bands(), angle = 90, size = 4,
                  label.fmt = "%1.2f", ypos.fixed = 0.1) +
  geom_line() +
  scale_fill_identity() + scale_color_identity()

ggplot(sun.spct, unit.out = "photon") +
  geom_line() +
  stat_wb_hbar(w.band = PAR(), size = 1) +
  stat_wb_q_sirrad(aes(color = ..wb.color..),
                   w.band = PAR(), label.fmt = "mean = %.3g",
                   ypos.mult = 1, xpos.fixed = 390, hjust = 1) +
  scale_color_identity()

</code></pre>

<hr>
<h2 id='stat_wb_total'>Integrate ranges under spectral curve.</h2><span id='topic+stat_wb_total'></span>

<h3>Description</h3>

<p><code>stat_wb_total</code> computes integral under a curve. It first integrates the
area under a spectral curve and also the mean expressed per nanaometre of
wavelength for each waveband in the input. Sets suitable default aesthetics
for &quot;rect&quot;, &quot;hline&quot;, &quot;vline&quot;, &quot;text&quot; and &quot;label&quot; geoms displaying &quot;totals&quot;
per waveband.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wb_total(
  mapping = NULL,
  data = NULL,
  geom = "text",
  w.band = NULL,
  integral.fun = integrate_xy,
  label.mult = 1,
  chroma.type = "CMF",
  label.fmt = "%.3g",
  ypos.mult = 1.07,
  ypos.fixed = NULL,
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wb_total_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs
to be set at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_w.band">w.band</code></td>
<td>
<p>a waveband object or a list of waveband objects or numeric
vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_integral.fun">integral.fun</code></td>
<td>
<p>function on $x$ and $y$.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_label.mult">label.mult</code></td>
<td>
<p>numeric Scaling factor applied to y-integral values before
conversion into character strings.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character string giving a format definition for converting
y-integral values into character strings by means of function
<code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_ypos.mult">ypos.mult</code></td>
<td>
<p>numeric Multiplier constant used to scale returned
<code>y</code> values.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_ypos.fixed">ypos.fixed</code></td>
<td>
<p>numeric If not <code>NULL</code> used a constant value returned
in <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points on this
layer</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be stripped
before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped. <code>FALSE</code>
never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics, rather
than combining with them. This is most useful for helper functions that
define both data and aesthetics and shouldn't inherit behaviour from the
default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wb_total_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This
can include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row for each waveband object in the argument
to <code>w.band</code>. Wavebeand outside the range of the spectral data are
trimmed or discarded.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of appying <code>integral.fun</code>,
with default <code>integrate_xy</code>.
</p>

<dl>
<dt>y.label</dt><dd><p>ymean multiplied by <code>label.mult</code> and formatted
according to <code>label.fmt</code></p>
</dd>
<dt>x</dt><dd><p>w.band-midpoint</p>
</dd>
<dt>wb.xmin</dt><dd><p>w.band minimum</p>
</dd>
<dt>wb.xmax</dt><dd><p>w.band maximum</p>
</dd>
<dt>wb.ymin</dt><dd><p>data$y minimum</p>
</dd>
<dt>wb.ymax</dt><dd><p>data$y maximum</p>
</dd>
<dt>wb.yint</dt><dd><p>data$y integral for the range of <code>w.band</code></p>
</dd>
<dt>wb.xmean</dt><dd><p>yint divided by wl_expanse(w.band)</p>
</dd>
<dt>y</dt><dd><p>ypos.fixed or top of data, adjusted by <code>ypos.mult</code></p>
</dd>
<dt>wb.color</dt><dd><p>color of the w.band</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
<dt>BW.color</dt><dd><p><code>black_or_white(wb.color)</code></p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>..y.label..</p>
</dd>
<dt>x</dt><dd><p>..x..</p>
</dd>
<dt>xmin</dt><dd><p>..wb.xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..wb.xmax..</p>
</dd>
<dt>ymin</dt><dd><p>..y.. - (..wb.ymax.. - ..wb.ymin..) * 0.03</p>
</dd>
<dt>ymax</dt><dd><p>..y.. + (..wb.ymax.. - ..wb.ymin..) * 0.03</p>
</dd>
<dt>yintercept</dt><dd><p>..wb.ymean..</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(photobiologyWavebands)
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) +
  geom_line() +
  stat_wb_box(w.band = VIS()) +
  stat_wb_total(w.band = VIS()) +
  scale_fill_identity() + scale_color_identity()

ggplot(sun.spct) +
  geom_line() +
  stat_wb_box(w.band = UV_bands(), color = "white") +
  stat_wb_total(w.band = UV_bands()) +
  scale_fill_identity() + scale_color_identity()

</code></pre>

<hr>
<h2 id='stat_wl_strip'>Calculate colours from wavelength.</h2><span id='topic+stat_wl_strip'></span><span id='topic+wl_guide'></span>

<h3>Description</h3>

<p><code>stat_wl_strip</code> computes color definitions according to human vision.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wl_strip(
  mapping = NULL,
  data = NULL,
  geom = "rect",
  w.band = NULL,
  length.out = 150,
  chroma.type = "CMF",
  position = "identity",
  na.rm = TRUE,
  show.legend = FALSE,
  inherit.aes = TRUE,
  ...
)

wl_guide(
  mapping = NULL,
  data = NULL,
  chroma.type = "CMF",
  w.band = NULL,
  length.out = 150,
  ymin = -Inf,
  ymax = Inf,
  position = "identity",
  na.rm = FALSE,
  show.legend = FALSE,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wl_strip_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs to be set
at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_w.band">w.band</code></td>
<td>
<p>waveband object or a list of such objects or NULL.</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_length.out">length.out</code></td>
<td>
<p>The number of steps to use to simulate a continuous
range of colours when w.band == NULL.</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points
on this layer</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be
stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This can
include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
<tr><td><code id="stat_wl_strip_+3A_ymin">ymin</code>, <code id="stat_wl_strip_+3A_ymax">ymax</code></td>
<td>
<p>numeric used as aesthetics for plotting the guide.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>generic_spect object with new <code>x</code> values plus other computed
variables described below.
</p>


<h3>Computed variables</h3>


<dl>
<dt>x</dt><dd><p>(w.low + wl.high) / 2</p>
</dd>
<dt>wl.low</dt><dd><p>boundary of waveband</p>
</dd>
<dt>wl.high</dt><dd><p>boundary of waveband</p>
</dd>
<dt>wl.color</dt><dd><p>color corresponding to wavelength</p>
</dd>
<dt>wb.color</dt><dd><p>color corresponding to waveband</p>
</dd>
<dt>wb.name</dt><dd><p>label of w.band</p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>x</dt><dd><p>..x..</p>
</dd>
<dt>label</dt><dd><p>as.character(..wb.f..)</p>
</dd>
<dt>xmin</dt><dd><p>..wl.low..</p>
</dd>
<dt>xmax</dt><dd><p>..wl.high..</p>
</dd>
<dt>fill</dt><dd><p>..wb.color..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
</dl>



<h3>Note</h3>

<p>This stat uses a panel function and ignores grouping as it is meant to
be used for annotations.
</p>


<h3>See Also</h3>

<p><code><a href="photobiology.html#topic+color_of">color_of</a></code>, which is used internally.
</p>
<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_summary">stat_wl_summary</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) + geom_line() +
  stat_wl_strip(ymax = -0.02, ymin = -0.04) +
  scale_fill_identity()

# on some graphic devices the output may show spurious vertical lines
ggplot(sun.spct) + wl_guide(alpha = 0.33, color = NA) + geom_line()

</code></pre>

<hr>
<h2 id='stat_wl_summary'>Average area under curve for regions.</h2><span id='topic+stat_wl_summary'></span>

<h3>Description</h3>

<p><code>stat_wl_summary</code> computes the area under a curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_wl_summary(
  mapping = NULL,
  data = NULL,
  geom = "text",
  range = NULL,
  integral.fun = integrate_xy,
  label.fmt = "%.3g",
  position = "identity",
  na.rm = FALSE,
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stat_wl_summary_+3A_mapping">mapping</code></td>
<td>
<p>The aesthetic mapping, usually constructed with
<code><a href="ggplot2.html#topic+aes">aes</a></code> or <code><a href="ggplot2.html#topic+aes_">aes_</a></code>. Only needs to be set
at the layer level if you are overriding the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_data">data</code></td>
<td>
<p>A layer specific dataset - only needed if you want to override
the plot defaults.</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_geom">geom</code></td>
<td>
<p>The geometric object to use display the data</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_range">range</code></td>
<td>
<p>a numeric vector of at least length two.</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_integral.fun">integral.fun</code></td>
<td>
<p>function on $x$ and $y$.</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_label.fmt">label.fmt</code></td>
<td>
<p>character string giving a format definition for converting
y-integral values into character strings by means of function <code><a href="base.html#topic+sprintf">sprintf</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_position">position</code></td>
<td>
<p>The position adjustment to use for overlapping points
on this layer</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical value indicating whether NA values should be
stripped before the computation proceeds.</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should this layer be included in the legends?
<code>NA</code>, the default, includes if any aesthetics are mapped.
<code>FALSE</code> never includes, and <code>TRUE</code> always includes.</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders</a></code>.</p>
</td></tr>
<tr><td><code id="stat_wl_summary_+3A_...">...</code></td>
<td>
<p>other arguments passed on to <code><a href="ggplot2.html#topic+layer">layer</a></code>. This can
include aesthetics whose values you want to set, not map. See
<code><a href="ggplot2.html#topic+layer">layer</a></code> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with one row.
</p>


<h3>Computed variables</h3>

<p>What it is named integral below is the result of appying <code>integral.fun</code>,
with default <code>integrate_xy</code>.
</p>

<dl>
<dt>y.label</dt><dd><p>y formatted according to <code>label.fmt</code></p>
</dd>
<dt>x</dt><dd><p>range-midpoint</p>
</dd>
<dt>wb.xmin</dt><dd><p>range minimum</p>
</dd>
<dt>wb.xmax</dt><dd><p>range maximum</p>
</dd>
<dt>y</dt><dd><p>data$y integral for the range by the expanse of the range</p>
</dd>
</dl>



<h3>Default aesthetics</h3>

<p>Set by the statistic and available to geoms.
</p>

<dl>
<dt>label</dt><dd><p>..label..</p>
</dd>
<dt>x</dt><dd><p>..x..</p>
</dd>
<dt>xmin</dt><dd><p>..wb.xmin..</p>
</dd>
<dt>xmax</dt><dd><p>..wb.xmax..</p>
</dd>
<dt>y</dt><dd><p>..y..</p>
</dd>
<dt>ymin</dt><dd><p>0</p>
</dd>
<dt>ymax</dt><dd><p>..y..</p>
</dd>
<dt>yintercept</dt><dd><p>..y..</p>
</dd>
</dl>



<h3>Required aesthetics</h3>

<p>Required by the statistic and need to be set with <code>aes()</code>.
</p>

<dl>
<dt>x</dt><dd><p>numeric, wavelength in nanometres</p>
</dd>
<dt>y</dt><dd><p>numeric, a spectral quantity</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Other stats functions: 
<code><a href="#topic+stat_color">stat_color</a>()</code>,
<code><a href="#topic+stat_find_qtys">stat_find_qtys</a>()</code>,
<code><a href="#topic+stat_find_wls">stat_find_wls</a>()</code>,
<code><a href="#topic+stat_label_peaks">stat_label_peaks</a>()</code>,
<code><a href="#topic+stat_peaks">stat_peaks</a>()</code>,
<code><a href="#topic+stat_spikes">stat_spikes</a>()</code>,
<code><a href="#topic+stat_wb_box">stat_wb_box</a>()</code>,
<code><a href="#topic+stat_wb_column">stat_wb_column</a>()</code>,
<code><a href="#topic+stat_wb_contribution">stat_wb_contribution</a>()</code>,
<code><a href="#topic+stat_wb_hbar">stat_wb_hbar</a>()</code>,
<code><a href="#topic+stat_wb_irrad">stat_wb_irrad</a>()</code>,
<code><a href="#topic+stat_wb_label">stat_wb_label</a>()</code>,
<code><a href="#topic+stat_wb_mean">stat_wb_mean</a>()</code>,
<code><a href="#topic+stat_wb_relative">stat_wb_relative</a>()</code>,
<code><a href="#topic+stat_wb_sirrad">stat_wb_sirrad</a>()</code>,
<code><a href="#topic+stat_wb_total">stat_wb_total</a>()</code>,
<code><a href="#topic+stat_wl_strip">stat_wl_strip</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# ggplot() methods for spectral objects set a default mapping for x and y.
ggplot(sun.spct) + geom_line() +
  stat_wl_summary(geom = "hline")
ggplot(sun.spct) + geom_line() +
  stat_wl_summary(label.fmt = "mean = %.3f", color = "red", vjust = -0.3) +
  stat_wl_summary(geom = "hline", color = "red")

</code></pre>

<hr>
<h2 id='subtitle_spct.generic_spct'>Build a plot subtitle from object metadata (deprecated!)</h2><span id='topic+subtitle_spct.generic_spct'></span>

<h3>Description</h3>

<p>Build a character string to be used as plot title by quering spectral
object for its  metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subtitle_spct.generic_spct(
  x,
  default.when = character(0),
  default.where = character(0),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subtitle_spct.generic_spct_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
<tr><td><code id="subtitle_spct.generic_spct_+3A_default.when">default.when</code></td>
<td>
<p>datetime object.</p>
</td></tr>
<tr><td><code id="subtitle_spct.generic_spct_+3A_default.where">default.where</code></td>
<td>
<p>One-row data.frame with at least variables <code>lat</code>,
and <code>lon</code>.</p>
</td></tr>
<tr><td><code id="subtitle_spct.generic_spct_+3A_...">...</code></td>
<td>
<p>Additional parameters of derived methods.</p>
</td></tr>
</table>

<hr>
<h2 id='T_plot'>Create a complete ggplot for a filter spectrum.</h2><span id='topic+T_plot'></span>

<h3>Description</h3>

<p>This function returns a ggplot object with an annotated plot of a filter_spct
object showing transmittance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>T_plot(
  spct,
  w.band,
  range,
  pc.out,
  label.qty,
  span,
  wls.target,
  annotations,
  geom,
  text.size,
  chroma.type,
  idfactor,
  facets,
  na.rm,
  ylim,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="T_plot_+3A_spct">spct</code></td>
<td>
<p>a filter_spct object</p>
</td></tr>
<tr><td><code id="T_plot_+3A_w.band">w.band</code></td>
<td>
<p>list of waveband objects</p>
</td></tr>
<tr><td><code id="T_plot_+3A_range">range</code></td>
<td>
<p>an R object on which range() returns a vector of length 2, with
min annd max wavelengths (nm)</p>
</td></tr>
<tr><td><code id="T_plot_+3A_pc.out">pc.out</code></td>
<td>
<p>logical, if TRUE use percents instead of fraction of one</p>
</td></tr>
<tr><td><code id="T_plot_+3A_label.qty">label.qty</code></td>
<td>
<p>character string giving the type of summary quantity to use
for labels</p>
</td></tr>
<tr><td><code id="T_plot_+3A_span">span</code></td>
<td>
<p>a peak is defined as an element in a sequence which is greater
than all other elements within a window of width span centered at that
element.</p>
</td></tr>
<tr><td><code id="T_plot_+3A_wls.target">wls.target</code></td>
<td>
<p>numeric vector indicating the spectral quantity values for
which wavelengths are to be searched and interpolated if need. The
<code>character</code> strings &quot;half.maximum&quot; and &quot;half.range&quot; are also accepted
as arguments. A list with <code>numeric</code> and/or <code>character</code> values is
also accepted.</p>
</td></tr>
<tr><td><code id="T_plot_+3A_annotations">annotations</code></td>
<td>
<p>a character vector.</p>
</td></tr>
<tr><td><code id="T_plot_+3A_geom">geom</code></td>
<td>
<p>character.</p>
</td></tr>
<tr><td><code id="T_plot_+3A_text.size">text.size</code></td>
<td>
<p>numeric size of text in the plot decorations.</p>
</td></tr>
<tr><td><code id="T_plot_+3A_chroma.type">chroma.type</code></td>
<td>
<p>character one of &quot;CMF&quot; (color matching function) or &quot;CC&quot;
(color coordinates) or a <code><a href="photobiology.html#topic+chroma_spct">chroma_spct</a></code> object.</p>
</td></tr>
<tr><td><code id="T_plot_+3A_idfactor">idfactor</code></td>
<td>
<p>character Name of an index column in data holding a
<code>factor</code> with each spectrum in a long-form multispectrum object
corresponding to a distinct spectrum. If <code>idfactor=NULL</code> the name of
the factor is retrieved from metadata or if no metadata found, the
default &quot;spct.idx&quot; is tried. If <code>idfactor=NA</code> no aesthetic is mapped
to the spectra and the user needs to use 'ggplot2' functions to manually
map an aesthetic or use facets for the spectra.</p>
</td></tr>
<tr><td><code id="T_plot_+3A_facets">facets</code></td>
<td>
<p>logical or integer Indicating if facets are to be created for
the levels of <code>idfactor</code> when <code>spct</code> contain multiple spectra in
long form.</p>
</td></tr>
<tr><td><code id="T_plot_+3A_na.rm">na.rm</code></td>
<td>
<p>logical.</p>
</td></tr>
<tr><td><code id="T_plot_+3A_ylim">ylim</code></td>
<td>
<p>numeric y axis limits,</p>
</td></tr>
<tr><td><code id="T_plot_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot</code> object.
</p>


<h3>Note</h3>

<p>Note that scales are expanded so as to make space for the annotations.
The object returned is a ggplot objects, and can be further manipulated.
</p>

<hr>
<h2 id='Tfr_label'>Transmittance axis labels</h2><span id='topic+Tfr_label'></span><span id='topic+Tfr_internal_label'></span><span id='topic+Tfr_total_label'></span>

<h3>Description</h3>

<p>Generate cps axis labels in SI units,
using SI scale factors. Output can be selected as character, expression (R
default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tfr_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE,
  Tfr.type
)

Tfr_internal_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE
)

Tfr_total_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = NULL,
  scaled = FALSE,
  normalized = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Tfr_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer</p>
</td></tr>
<tr><td><code id="Tfr_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expresion&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="Tfr_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
<tr><td><code id="Tfr_label_+3A_scaled">scaled</code></td>
<td>
<p>logical If <code>TRUE</code> relative units are assumed.</p>
</td></tr>
<tr><td><code id="Tfr_label_+3A_normalized">normalized</code></td>
<td>
<p>logical (<code>FALSE</code>) or numeric Normalization wavelength
in manometers (nm).</p>
</td></tr>
<tr><td><code id="Tfr_label_+3A_tfr.type">Tfr.type</code></td>
<td>
<p>character, either &quot;total&quot; or &quot;internal&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Note</h3>

<p>Default for <code>label.text</code> depends on the value passed as argument
to <code>Tfr.type</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Tfr_label(Tfr.type = "internal")
Tfr_label(Tfr.type = "total")


Tfr_internal_label()
Tfr_internal_label(-2)
Tfr_internal_label(-3)
Tfr_internal_label(format = "R.expression")
Tfr_internal_label(format = "LaTeX")
Tfr_internal_label(-3, format = "LaTeX")


Tfr_total_label()
Tfr_total_label(-2)
Tfr_total_label(-3)
Tfr_total_label(format = "R.expression")
Tfr_total_label(format = "LaTeX")
Tfr_total_label(-3, format = "LaTeX")

</code></pre>

<hr>
<h2 id='title_spct'>Build a plot title from object metadata (deprecated!)</h2><span id='topic+title_spct'></span>

<h3>Description</h3>

<p>Build a character string to be used as plot title by quering spectral
object for its  metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>title_spct(x, default.what = character(0), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="title_spct_+3A_x">x</code></td>
<td>
<p>An R object.</p>
</td></tr>
<tr><td><code id="title_spct_+3A_default.what">default.what</code></td>
<td>
<p>A character string.</p>
</td></tr>
<tr><td><code id="title_spct_+3A_...">...</code></td>
<td>
<p>Additional parameters of derived methods.</p>
</td></tr>
</table>

<hr>
<h2 id='validate_idfactor'>Validate idfactor</h2><span id='topic+validate_idfactor'></span>

<h3>Description</h3>

<p>Validate idfactor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_idfactor(idfactor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_idfactor_+3A_idfactor">idfactor</code></td>
<td>
<p>character, logical, NULL or NA. If a <code>character</code> string,
it is validated as an R name, while logical values, NULL and NA are
returned unchanged.</p>
</td></tr>
</table>

<hr>
<h2 id='w_length_label'>Wave- axis labels</h2><span id='topic+w_length_label'></span><span id='topic+w_number_label'></span><span id='topic+w_frequency_label'></span><span id='topic+w_energy_eV_label'></span><span id='topic+w_energy_J_label'></span>

<h3>Description</h3>

<p>Generate wavelength, wavenumber, wave frequency, and energy per photon axis
labels in SI units, using SI scale factors. Output can be selected as
character, expression (R default devices) or LaTeX (for tikz device).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_length_label(
  unit.exponent = -9,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["w.length"]]
)

w_number_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["w.number"]]
)

w_frequency_label(
  unit.exponent = 9,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["freq"]]
)

w_energy_eV_label(
  unit.exponent = 0,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["energy"]]
)

w_energy_J_label(
  unit.exponent = -18,
  format = getOption("photobiology.math", default = "R.expression"),
  label.text = axis_labels()[["energy"]]
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w_length_label_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer The exponent in base 10 of the scale multiplier
to use.</p>
</td></tr>
<tr><td><code id="w_length_label_+3A_format">format</code></td>
<td>
<p>character string, &quot;R&quot;, &quot;R.expresion&quot;, &quot;R.character&quot;, or
&quot;LaTeX&quot;.</p>
</td></tr>
<tr><td><code id="w_length_label_+3A_label.text">label.text</code></td>
<td>
<p>character Textual portion of the labels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default labels consist in a textual name for the quantity, a
symbol separated by a comma and units with scale factor in parenthesis. The
textual names are by default in English but this default can be overridden
for example with translations to a different language. To change or
translate the default texts please see <code><a href="#topic+axis_labels_uk">axis_labels_uk</a></code>. The
markup language used for the labels can be selected through a parameter
argument, with character strings ready to be parsed into R expressions
as default.
</p>
<p>Wavelengths are assumed to be expressed in nanometres in the data. The
<code>unit.exponent</code> corresponds to that desired for the tick labels
with the corresponding axis label automatically set to an SI scale
factor if possible, and otherwise shown as a power of 10.
</p>
<p>These functions are used internally by <em>x</em> scales; see
<code><a href="#topic+sec_axis_w_number">sec_axis_w_number</a></code> and <code><a href="#topic+scale_x_wl_continuous">scale_x_wl_continuous</a></code>.
The scales and secondary axis functions should be used except when
defining new scale functions.
</p>


<h3>Value</h3>

<p>a character string or an R expression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
w_length_label()
w_length_label("R.expression")
w_length_label("LaTeX")
w_number_label()
w_number_label("R.expression")
w_frequency_label()
w_frequency_label("R.expression")
w_energy_J_label()
w_energy_eV_label()

</code></pre>

<hr>
<h2 id='w_number'>Deprecated functions</h2><span id='topic+w_number'></span><span id='topic+w_frequency'></span>

<h3>Description</h3>

<p>To convert wavelength into wavenumber or into frequency, please, use the
conversion functions from package 'photobiology' in place of the deprecated
functions <code>w_number()</code> and <code>w_frequency()</code> from this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>w_number(w.length, unit.exponent = 0)

w_frequency(w.length, unit.exponent = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="w_number_+3A_w.length">w.length</code></td>
<td>
<p>numeric wavelength (nm)</p>
</td></tr>
<tr><td><code id="w_number_+3A_unit.exponent">unit.exponent</code></td>
<td>
<p>integer Exponent of the scale multiplier implicit in
result, e.g., use 3 for kJ.</p>
</td></tr>
</table>


<h3>Deprecated</h3>

<p>These functions will be removed from package 'ggpmisc'
in the near future.
</p>


<h3>See Also</h3>

<p>See <code><a href="photobiology.html#topic+wl2wavenumber">wl2wavenumber</a></code> for the functions to
be used in all new code.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(photobiology)

wl2wavenumber(600)
wl2frequency(600)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
