<!DOCTYPE html><html><head><title>Help for package NonParRolCor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NonParRolCor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ecodata'><p>Ecological data set to exemplify the use of the functions contained in <em>NonParRolCor</em></p></a></li>
<li><a href='#ecodata2'><p>Environmental data set to exemplify the use of the functions contained in <em>NonParRolCor</em></p></a></li>
<li><a href='#NonParRolCor-package'><p>Non-parametric statistical significance test for rolling window correlation</p></a></li>
<li><a href='#plot_rolcor_estim_1win'><p>Plot the variables under analysis and the rolling correlation coefficients that are statistically significant for only one window-length</p></a></li>
<li><a href='#plot_rolcor_estim_heatmap'><p>Plot the variables under analysis and a heat map of the rolling correlation coefficients that are statistically significant</p></a></li>
<li><a href='#rolcor_estim_1win'><p>Estimates the rolling window correlation coefficients for only one window-length and their statistical significance</p></a></li>
<li><a href='#rolcor_estim_heatmap'><p>Estimates the rolling window correlation coefficients for several window-lengths and their statistical significance</p></a></li>
<li><a href='#syntheticdata'><p>Synthetic data set to exemplify the use of the functions contained in <em>NonParRolCor</em></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>a Non-Parametric Statistical Significance Test for Rolling
Window Correlation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josue M. Polanco-Martinez &lt;josue.m.polanco@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), gtools, pracma, colorspace, doParallel</td>
</tr>
<tr>
<td>Imports:</td>
<td>foreach, scales</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates and plots (as a single plot and as a heat map) the rolling window correlation coefficients between two time series and computes their statistical significance, which is carried out through a non-parametric computing-intensive method. This method addresses the effects due to the multiple testing (inflation of the Type I error) when the statistical significance is estimated for the rolling window correlation coefficients. The method is based on Monte Carlo simulations by permuting one of the variables (e.g., the dependent) under analysis and keeping fixed the other variable (e.g., the independent). We improve the computational efficiency of this method to reduce the computation time through parallel computing. The 'NonParRolCor' package also provides examples with synthetic and real-life environmental time series to exemplify its use. Methods derived from R. Telford (2013) <a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a> and J.M. Polanco-Martinez and J.L. Lopez-Martinez (2021) &lt;<a href="https://doi.org/10.1016%2Fj.ecoinf.2021.101379">doi:10.1016/j.ecoinf.2021.101379</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-30 21:03:03 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-30 19:29:11 UTC; jomopo</td>
</tr>
<tr>
<td>Author:</td>
<td>Josue M. Polanco-Martinez
    <a href="https://orcid.org/0000-0001-7164-0185"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cph,
    cre],
  Jose L. Lopez-Martinez
    <a href="https://orcid.org/0000-0002-2489-7559"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
</table>
<hr>
<h2 id='ecodata'>Ecological data set to exemplify the use of the functions contained in <em>NonParRolCor</em> 
</h2><span id='topic+ecodata'></span>

<h3>Description</h3>

<p>The data set <code><a href="#topic+ecodata">ecodata</a></code> contains four columns, the first one (named &ldquo;Years&rdquo;) is the time (years from 1989 to 2008, monthly resolution), the second (named &ldquo;SST&rdquo;) are monthly anomalies of sea surface temperature (SST) of the south of Gran Canaria (28.5 N/16.5 W) (NOAA 2021a), the third column (named &ldquo;NAO&rdquo;) are the monthly index of the North Atlantic Oscillation (NAO) (NOAA 2021b), and the last column (named &ldquo;CPUE&rdquo;) are monthly catches of common octopus (measured as CPUE or Catch Per Unit of Effort) from an artisanal fisheries from the Southwest of Gran Canaria Islands (Caballero-Alfonso et al. 2010, Polanco et al. 2011, Polanco-Martínez 2012). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ecodata)
</code></pre>


<h3>Format</h3>

<p>One file in ASCII format containing four columns and 240 rows, columns are separated by spaces. 
</p>


<h3>Source</h3>

<p>Caballero-Alfonso, A, Ganzedo, U., Trujillo-Santana, A., Polanco, J., del Pino, A. S., Ibarra-Berastegi, G., Castro-Hernández, J. (2010). The role of climatic variability on the short-term fluctuations of octopus captures at the Canary Islands. Fisheries Research, 102(3), 258-265. &lt;URL: doi: <a href="https://doi.org/10.1016/j.fishres.2009.12.006">10.1016/j.fishres.2009.12.006</a>&gt;. <br />
</p>
<p>NOAA Optimum Interpolation (OI) Sea Surface Temperature (SST) V2, &lt;URL: <a href="https://psl.noaa.gov/data/gridded/data.noaa.oisst.v2.html">https://psl.noaa.gov/data/gridded/data.noaa.oisst.v2.html</a>&gt;, accessed: 2021-02-28. <br />
</p>
<p>NAO index, &lt;URL: <a href="https://psl.noaa.gov/data/correlation/nao.data">https://psl.noaa.gov/data/correlation/nao.data</a>&gt;, accessed: 2021-02-28. <br />
</p>
<p>Polanco, J., Ganzedo, U., Sáenz, J., Caballero-Alfonso, A. M., &amp; Castro-Hernández, J. J. (2011). Wavelet analysis of correlation among Canary Islands octopus captures per unit effort, sea-surface temperatures and the North Atlantic Oscillation. Fisheries Research, 107(1-3), 177-183. &lt;URL: doi: <a href="https://doi.org/10.1016/j.fishres.2010.10.019">10.1016/j.fishres.2010.10.019</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J.M. (2012). Aplicación de técnicas estadísticas en el estudio de fenómenos ambientales y ecosistémicos, Ph.D. thesis, University of Basque Country, Spain. &lt;URL: <a href="https://addi.ehu.es/handle/10810/11295/">https://addi.ehu.es/handle/10810/11295/</a>&gt;. 
</p>

<hr>
<h2 id='ecodata2'>Environmental data set to exemplify the use of the functions contained in <em>NonParRolCor</em> 
</h2><span id='topic+ecodata2'></span>

<h3>Description</h3>

<p>The data set <code><a href="#topic+ecodata2">ecodata2</a></code> contains three columns, the first one (named &rdquo;Years&rdquo;) is the time (years from 1700 to 1936, yearly resolution), the second column (named &rdquo;TSI&rdquo;) are reconstructions of total solar irradiance (Lean 2000) and the third column the first component principal (PC1) of the reconstructed Atlantic Bluefin Tuna (BFT) captures (Ganzedo et al. 2016, Polanco-Martínez et al. 2018). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ecodata2)
</code></pre>


<h3>Format</h3>

<p>One file in ASCII format containing three columns and 237 rows, columns are separated by spaces. 
</p>


<h3>Source</h3>

<p>Lean, J. (2000). Evolution of the Sun's spectral irradiance since the Maunder Minimum. Geophysical Research Letters, 27(16), 2425-2428. &lt;URL: doi: <a href="https://doi.org/10.1029/2000GL000043">10.1029/2000GL000043</a>&gt;. Lean Web TSI data set: &lt;URL: <a href="https://www.ncei.noaa.gov/access/paleo-search/study/5788/">https://www.ncei.noaa.gov/access/paleo-search/study/5788/</a>&gt;. <br /> 
</p>
<p>Ganzedo, U., Polanco-Martínez, J. M., Caballero-Alfonso, A. M., Faria, S. H., Li, J., Castro-Hernández, J. J. (2016). Climate effects on historic bluefin tuna captures in the Gibraltar Strait and Western Mediterranean. Journal of Marine Systems, 158, 84-92. <br /> 
&lt;URL: doi: <a href="https://doi.org/10.1016/j.jmarsys.2016.02.002">10.1016/j.jmarsys.2016.02.002</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M., Caballero-Alfonso, A. M., Ganzedo, U., Castro-Hernández, J. J. (2018). A reconstructed database of historic bluefin tuna captures in the Gibraltar Strait and Western Mediterranean. Data in Brief, 16, 206-210. &lt;URL: doi: <a href="https://doi.org/10.1016/j.dib.2017.11.028">10.1016/j.dib.2017.11.028</a>&gt;. 
</p>

<hr>
<h2 id='NonParRolCor-package'>Non-parametric statistical significance test for rolling window correlation 
</h2><span id='topic+NonParRolCor-package'></span><span id='topic+NonParRolCor'></span>

<h3>Description</h3>

<p>'NonParRolCor' estimates and plots as a single plot and as a heat map 
the rolling window correlation coefficients and their statistical 
significance between two regular (sampled on identical time points) 
time series. The statistical significance is computed through a 
non-parametric computing-intensive method (Telford 2013, Polanco-Martínez 
and López-Martínez 2021). This method (test) address the effects due 
to the multiple testing problem (inflation of the Type I error) when 
the statistical significance is estimated for rolling correlation 
coefficients. The method is based on Monte Carlo simulations by permuting 
one (e.g., the dependent) of the variables under analysis and keeping 
fixed the other (e.g., the independent) variable. We improve the 
computational efficiency of this method to reduce the computation time  
through parallel computing. It has been designed especially for 
environmental (climate and ecological) data although this can be applied 
to other kinds of data sets as well. 'NonParRolCor' contains four 
functions: (1) 'rolcor_estim_1win' and (2) 'rolcor_estim_heatmap' to 
estimate the rolling window correlation coefficients and their respective 
statistical significance for only one window-length and for all possible 
window-lengths; (3) 'plot_rolcor_estim_heatmap' and (4) 
'plot_rolcor_estim_heatmap' to plot the time series under analysis 
and the correlation coefficients that are statistically significant for 
only one window-length as a simple plot and for all possible window-lengths 
as a heat map, respectively. The functions contained in 'NonParRolCor' 
are highly flexible since these contains several parameters to control 
the estimation of correlation and the features of the plots of the time 
series, e.g., to remove potential linear trend contained in the time series 
under analysis or to personalise the plot of the time series under analysis. 
The 'NonParRolCor' package also provides examples with synthetic 
('syntheticdata' data set) and real-life environmental ('ecodata' data 
sets) time series to exemplify its use. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> NonParRolCor</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.8</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-10-30</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2) </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>NonParRolCor package contains four functions: (1) <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code> and (2) <br /> <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> that estimate the rolling window correlation coefficients and their respective statistical significance for only one window-length and for all possible window-lengths, respectively; (3) <code><a href="#topic+plot_rolcor_estim_1win">plot_rolcor_estim_1win</a></code> and (4) <code><a href="#topic+plot_rolcor_estim_heatmap">plot_rolcor_estim_heatmap</a></code> that plots the time series under scrutiny and that create a simple plot and a heat map of the rolling window correlation coefficients that are statistically significant, respectively. NonParRolCor also contains three data sets: (1) <code><a href="#topic+syntheticdata">syntheticdata</a></code>, (2) <code><a href="#topic+ecodata">ecodata</a></code> and (3) <code><a href="#topic+ecodata2">ecodata2</a></code> to exemplify the use of the aforementioned functions. The significance test is based on and inspired from Telford (2013) and Polanco-Martínez (2019) whereas the simple plots and heat maps are based on Polanco-Martínez (2020). The non-parametric statistical significance test is described in detail in Polanco-Martínez and López-Martínez (2021).</p>


<h3>Note</h3>

<p>Dependencies: <em>stat</em>, <em>gtools</em>, <em>pracma</em>, <em>colorspace</em>, <em>scales</em>, <em>foreach</em>, <em>parallel</em>, <em>doParallel</em>. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br />
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez/">https://www.researchgate.net/profile/Josue-Polanco-Martinez/</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a> <br />
José L. López-Martínez.<br /> 
Faculty of Mathematics, Universidad Autónoma de Yucatán (UADY), Tizimín, MEXICO.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=552PKVEAAAAJ&amp;hl=es/">https://scholar.google.es/citations?user=552PKVEAAAAJ&amp;hl=es/</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Jose-Lopez-Martinez-3/">https://www.researchgate.net/profile/Jose-Lopez-Martinez-3/</a>.<br />
Email: <a href="mailto:jose.lopez@correo.uady.mx">jose.lopez@correo.uady.mx</a>. <br /><br /> 
Acknowledgement:<br /> 
The first author acknowledges to the SEPE (Spanish Public Service of Employment) and to the Excellence Unit GECOS (reference number CLU-2019-03), Universidad de Salamanca for its funding support. Special thanks to The Donegal Irish Pub (Portugalete) to provide space for research and code.</p>


<h3>References</h3>

<p>Polanco-Martínez, J. M. and López-Martínez, J.M. (2021). A non-parametric method to test the statistical significance in rolling window correlations, and applications to ecological time series. Ecological Informatics 60, 101379. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2021.101379">10.1016/j.ecoinf.2021.101379</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). RolWinMulCor: an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Telford, R.: Running correlations &ndash; running into problems. (2013). &lt;URL: <br /> 
<a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a>&gt;. <br />
</p>

<hr>
<h2 id='plot_rolcor_estim_1win'>Plot the variables under analysis and the rolling correlation coefficients that are statistically significant for only one window-length 
</h2><span id='topic+plot_rolcor_estim_1win'></span><span id='topic+plot_rolcor_estim_1win'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+plot_rolcor_estim_1win">plot_rolcor_estim_1win</a></code> function plots the time series under study and create a simple plot of the rolling window correlation coefficients that are statistically significant that are obtained by the <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code> function. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_rolcor_estim_1win(inputdata, corcoefs, CRITVAL, widthwin, left_win,
                  righ_win, varX="X", varY="Y", coltsX="black", coltsY="blue", 
                  rmltrd=TRUE, Scale=TRUE, HeigWin1=2.05, HeigWin2=2.75, 
                  colCOEF="black", CEXLAB=1.15, CEXAXIS=1.05, LWDtsX=1, 
                  LWDtsY=1, LWDcoef=1, colCRITVAL="black", pchCRIVAL=16) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_rolcor_estim_1win_+3A_inputdata">inputdata</code></td>
<td>
 
<p>The same data matrix (time, first and second variable) that was used with the <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code> function. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_corcoefs">corcoefs</code></td>
<td>

<p>Rolling correlation coefficients estimated with the <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code> function. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_critval">CRITVAL</code></td>
<td>
 
<p>The critical values computed through the function <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code>, which are used to determine the statistical significance.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_widthwin">widthwin</code></td>
<td>
 
<p><code>widthwin</code> contains the window-length (time-scale) that come from the function <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_left_win">left_win</code>, <code id="plot_rolcor_estim_1win_+3A_righ_win">righ_win</code></td>
<td>
 
<p>These parameters are used to accommodate (to the left and right) the times of the rolling window correlation coefficients and these are provided by the <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code> function.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_varx">varX</code>, <code id="plot_rolcor_estim_1win_+3A_vary">varY</code></td>
<td>
 
<p>Names of the first (e.g., X) and the second (e.g., Y) variables contained in <code>inputdata</code>. Please note that the names of these two variables should be provided (by default are X and Y) when these variables are plotted. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_coltsx">coltsX</code>, <code id="plot_rolcor_estim_1win_+3A_coltsy">coltsY</code></td>
<td>
 
<p>Colors to be used when the variables are plotted, by default are &ldquo;black&rdquo; for the first variable and &ldquo;blue&rdquo; for the second, but other colors can be used.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_rmltrd">rmltrd</code></td>
<td>

<p>Remove (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) the linear trend in the variables under analysis. It is advisable to remove the trend before estimating the rolling window correlation coefficients, especially, for large window-lengths. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_scale">Scale</code></td>
<td>

<p>Scale (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo;  otherwise) is used to &ldquo;normalize&rdquo; or &ldquo;standardize&rdquo; the variables under analysis. It is highly advisable to &rdquo;normalize/standardize&rdquo; the time series under study to have them in the same scales. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_heigwin1">HeigWin1</code>, <code id="plot_rolcor_estim_1win_+3A_heigwin2">HeigWin2</code></td>
<td>

<p>Proportion of window's size to plot the time series under analysis (<code>HeigWin1</code>) and the rolling window correlation coefficients (<code>HeigWin2</code>) (look at: <span class="rlang"><b>R</b></span>&gt;?layout to get more information about &ldquo;layout&rdquo;). By default <code>HeigWin1</code> and <code>HeigWin2</code> have values of 2.05 and 2.75, but other values can be used. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_colcoef">colCOEF</code></td>
<td>

<p>The color to be used when the correlation coefficients are plotted, by default the color is &ldquo;black&rdquo;, but other colors can be used.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_cexlab">CEXLAB</code>, <code id="plot_rolcor_estim_1win_+3A_cexaxis">CEXAXIS</code></td>
<td>

<p>These parameters are used to plot the sizes of the X-axis and Y-axis labels and X- and Y-axis, by default these parameters have values of 1.15 and 1.05, respectively, but it is possible to use other values. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_lwdtsx">LWDtsX</code>, <code id="plot_rolcor_estim_1win_+3A_lwdtsy">LWDtsY</code></td>
<td>

<p>Line-widths for the first and the second variable when these are plotted, by default these have values of 1, but other values (widths) can be used.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_lwdcoef">LWDcoef</code></td>
<td>

<p>The line-width to be used when the correlation coefficients are plotted, by default this parameter has a value of 1, but it is possible to use other values.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_colcritval">colCRITVAL</code></td>
<td>

<p><code>colCRITVAL</code> defines the color used to plot the correlation coefficients that are statistically significant.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_1win_+3A_pchcrival">pchCRIVAL</code></td>
<td>

<p><code>pchCRITVAL</code> is used for the type (symbols) of the plot for the correlation coefficients that are statistically significant.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+plot_rolcor_estim_1win">plot_rolcor_estim_1win</a></code> function plots the variables (time series) under analysis and for the selected window-length, the rolling correlation coefficients that are statistically significant, which are estimated through a non-parametric computing-intensive method. The <code><a href="#topic+plot_rolcor_estim_1win">plot_rolcor_estim_1win</a></code> function uses the outputs of <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code>. To implement this method we extend the works of Telford (2013), Polanco-Martínez (2019) and Polanco-Martínez (2020), and to implement the simple plot we follow to Polanco-Martínez (2020). The test/method to determine the statistical significance is described in Polanco-Martínez and López-Martínez (2021). 
</p>


<h3>Value</h3>

<p>Outputs:
A plot of the time series under analysis, and for the selected window-length, the rolling window correlation coefficients that are statistically significant. This multi-plot can be saved in your preferred format. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br />
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez/">https://www.researchgate.net/profile/Josue-Polanco-Martinez/</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>.<br />
</p>


<h3>References</h3>

<p>Polanco-Martínez, J. M. and López-Martínez, J.M. (2021). A non-parametric method to test the statistical significance in rolling window correlations, and applications to ecological time series. Ecological Informatics, 60, 101379. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2021.101379">10.1016/j.ecoinf.2021.101379</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). NonParRolCor: an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Code to test the function "plot_rolcol_estim_1win"
 # Defining NonParRolCor parameters 
 MCSim &lt;- 2 
 Np    &lt;- 2
 X_Y &lt;- rolcor_estim_1win(as.matrix(syntheticdata[1:350,]), 
                   CorMethod="pearson", widthwin=21, Align="center", 
                   rmltrd=TRUE, Scale=TRUE, MCSim=MCSim, Np=Np, prob=0.95)
 plot_rolcor_estim_1win(syntheticdata[1:350,], 
                   corcoefs=X_Y$Correlation_coefficients, 
                   CRITVAL=X_Y$CRITVAL, widthwin=X_Y$widthwin, 
                   left_win=X_Y$left_win, righ_win=X_Y$righ_win)
 </code></pre>

<hr>
<h2 id='plot_rolcor_estim_heatmap'>Plot the variables under analysis and a heat map of the rolling correlation coefficients that are statistically significant
</h2><span id='topic+plot_rolcor_estim_heatmap'></span><span id='topic+plot_rolcor_estim_heatmap'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+plot_rolcor_estim_heatmap">plot_rolcor_estim_heatmap</a></code> function plots the time series under study and create a heat map of the rolling window correlation coefficients that are statistically significant that are obtained by the <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> function. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_rolcor_estim_heatmap(inputdata, corcoefs, CRITVAL, Rwidthwin="", 
                  typewidthwin="", widthwin_1=3, widthwin_N=dim(inputdata)[1], 
                  varX="X", varY="Y", coltsX="black", coltsY="blue", LWDtsX=1, 
                  LWDtsY=1, CEXLAB=1.15, CEXAXIS=1.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_inputdata">inputdata</code></td>
<td>
 
<p>The same data matrix (time, first and second variable) that was used with the <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> function. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_corcoefs">corcoefs</code></td>
<td>

<p>Rolling correlation coefficients estimated with the <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> function. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_critval">CRITVAL</code></td>
<td>
 
<p>The critical values computed through the function <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> and that used to determine the statistical significance.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_rwidthwin">Rwidthwin</code></td>
<td>
 
<p><code>Rwidthwin</code> is a vector that contain the window lengths, which come from the function <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_typewidthwin">typewidthwin</code></td>
<td>
 
<p>Contains the type (&ldquo;FULL&rdquo; or &ldquo;PARTIAL&rdquo;) of heat map that will be plotted, this information is provided by <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code>. Please note that whether option <code>typewidthwin</code>=&ldquo;PARTIAL&rdquo; is selected, and you must provide the parameters <code>widthwin_1</code> and <code>widthwin_N</code> to plot the heat map. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_widthwin_1">widthwin_1</code></td>
<td>
 
<p>First value for the size (length) of the windows when the option <br /> <code>typewidthwin</code>=&ldquo;PARTIAL&rdquo; is selected, this value is provided by the function <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_widthwin_n">widthwin_N</code></td>
<td>
 
<p>Last value for the size (length) of the windows when the option <br /> <code>typewidthwin</code>=&ldquo;PARTIAL&rdquo; is selected, this value is provided by the function <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_varx">varX</code>, <code id="plot_rolcor_estim_heatmap_+3A_vary">varY</code></td>
<td>
 
<p>Names of the first (e.g., X) and the second (e.g., Y) variables contained in <code>inputdata</code>. Please note that the names of these two variables should be provided (by default are X and Y) when these variables are plotted. 
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_coltsx">coltsX</code>, <code id="plot_rolcor_estim_heatmap_+3A_coltsy">coltsY</code></td>
<td>
 
<p>Colors to be used when the variables are plotted, by default are &ldquo;black&rdquo; for the first variable and &ldquo;blue&rdquo; for the second, but other colors can be used.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_lwdtsx">LWDtsX</code>, <code id="plot_rolcor_estim_heatmap_+3A_lwdtsy">LWDtsY</code></td>
<td>

<p>Line-widths for the first and the second variable when these are plotted, by default these have values of 1, but other values (widths) can be used.
</p>
</td></tr>
<tr><td><code id="plot_rolcor_estim_heatmap_+3A_cexlab">CEXLAB</code>, <code id="plot_rolcor_estim_heatmap_+3A_cexaxis">CEXAXIS</code></td>
<td>

<p>These parameters are used to plot the sizes of the X-axis and Y-axis labels and X- and Y-axis, by default these parameters have values of 1.15 and 1.05, respectively, but it is possible to use other values. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+plot_rolcor_estim_heatmap">plot_rolcor_estim_heatmap</a></code> function plots the variables (time series) under analysis and a heat map of the rolling correlation coefficients that are statistically significant. This function supersedes to the function <code>heatmap_NonParRolCor</code> of the previous version of <code>NonParRolCor</code>. The <code><a href="#topic+plot_rolcor_estim_heatmap">plot_rolcor_estim_heatmap</a></code> function uses the outputs of the <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> function. To implement this method we extend the works of Telford (2013), Polanco-Martínez (2019) and Polanco-Martínez (2020), and to implement the heat map we follow to Polanco-Martínez (2020). The test/method to determine the statistical significance is described in Polanco-Martínez and López-Martínez (2021). <code><a href="#topic+plot_rolcor_estim_heatmap">plot_rolcor_estim_heatmap</a></code> uses the functions <code>diverge_hcl</code> (package:colorspace) and <code>alpha</code> (package:scales) to create the palette of colors. 
</p>


<h3>Value</h3>

<p>Outputs:
A plot of the time series under analysis and a heat map (a multi-plot via screen) of the rolling correlation coefficients statistically significant. This multi-plot can be saved in your preferred format. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br />
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez/">https://www.researchgate.net/profile/Josue-Polanco-Martinez/</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>.<br />
</p>


<h3>References</h3>

<p>Polanco-Martínez, J. M. and López-Martínez, J.M. (2021). A non-parametric method to test the statistical significance in rolling window correlations, and applications to ecological time series. Ecological Informatics, 60, 101379. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2021.101379">10.1016/j.ecoinf.2021.101379</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). NonParRolCor: an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Code to test the function "plot_rolcor_estim_heatmap"
 # Defining NonParRolCor parameters 
 TYPEWIDTHWIN="PARTIAL"
 # Number of Monte-Carlo simulations (MCSim), please use at least 1000. 
 # WARNING: MCSim=2, it's just to test this example! 
 MCSim &lt;- 2 
 Np    &lt;- 2  # Number of cores 
 X_Y &lt;- rolcor_estim_heatmap(syntheticdata[1:350,], CorMethod="pearson", 
                   typewidthwin=TYPEWIDTHWIN, widthwin_1=29,
                   widthwin_N=51, Align="center", rmltrd=TRUE, 
                   Scale=TRUE, MCSim=MCSim, Np=Np)
 plot_rolcor_estim_heatmap(syntheticdata[1:350,], X_Y$matcor, X_Y$CRITVAL, 
                   Rwidthwin=X_Y$Windows, typewidthwin=TYPEWIDTHWIN, 
                   widthwin_1=29, widthwin_N=51)
 </code></pre>

<hr>
<h2 id='rolcor_estim_1win'>Estimates the rolling window correlation coefficients for only one window-length and their statistical significance 
</h2><span id='topic+rolcor_estim_1win'></span><span id='topic+rolcor_estim_1win'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code> function estimates the rolling window correlation coefficients for only one window-length (time-scales) for two time series sampled on identical time points, and their statistical significance via a non-parametric computing-intensive method. To carry out the computational implementation we extend the works of Telford (2013), Polanco-Martínez (2019) and Polanco-Martínez (2020). The test/method to determine the statistical significance is described in Polanco-Martínez and López-Martínez (2021). The <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code> function is highly flexible since this contains several parameters to control the estimation of the correlation. A list of parameters are described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rolcor_estim_1win(inputdata, CorMethod="pearson", widthwin=3, Align="center", 
                  rmltrd=TRUE, Scale=TRUE, MCSim=1000, Np=2, prob=0.95) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rolcor_estim_1win_+3A_inputdata">inputdata</code></td>
<td>

<p>A matrix of 3 columns: time (regular/evenly spaced), the first (e.g., the independent) variable, and the second (e.g., the dependent) variable. Please verify if <code>inputdata</code> is a matrix. 
</p>
</td></tr> 
<tr><td><code id="rolcor_estim_1win_+3A_cormethod">CorMethod</code></td>
<td>

<p>The method used to estimate the correlations, by default is &ldquo;pearson,&rdquo; but other options (&ldquo;spearman&rdquo; and &ldquo;kendall&rdquo;) are available (please look at: <span class="rlang"><b>R</b></span>&gt;?cor.test).
</p>
</td></tr>
<tr><td><code id="rolcor_estim_1win_+3A_widthwin">widthwin</code></td>
<td>

<p>The window size or length that indicates the window's size to compute the rolling window correlations. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_1win_+3A_align">Align</code></td>
<td>

<p>To align the rolling object, NonParRolCor uses three options: &ldquo;left&rdquo;, &ldquo;center&rdquo;, and &ldquo;right&rdquo; (please look at: <span class="rlang"><b>R</b></span>&gt;?running). However, there are some restrictions that have been described lines above. We recommend to use the &ldquo;center&rdquo; option to ensure that variations in the correlations are aligned with the variations in the relationships of the variables under study, rather than being shifted to left or to right (Polanco-Martínez 2019, 2020), but this imply that the window-lengths must be odd. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_1win_+3A_rmltrd">rmltrd</code></td>
<td>

<p>Remove (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) the linear trend in the variables under analysis. It is advisable to remove the trend before estimating the rolling window correlation coefficients, especially, for large window-lengths. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_1win_+3A_scale">Scale</code></td>
<td>

<p>Scale (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo;  otherwise) is used to &ldquo;normalize&rdquo; or &ldquo;standardize&rdquo; the variables under analysis. It is highly advisable to &rdquo;normalize/standardize&rdquo; the time series under study to have them in the same scales. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_1win_+3A_mcsim">MCSim</code></td>
<td>

<p>Number of Monte-Carlo simulations to permute the second variable. It is advisable to use at least 1000 simulations. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_1win_+3A_np">Np</code></td>
<td>

<p>Number of CPU cores, by default is 2. Please verify the number of cores of your computer. WARNING: it is not advisable to use the maximum number of cores of your computer.
</p>
</td></tr> 
<tr><td><code id="rolcor_estim_1win_+3A_prob">prob</code></td>
<td>

<p>Numeric vector of probabilities with values in the interval [0,1], by default prob=0.95 (p=0.05), please look at <span class="rlang"><b>R</b></span>?quantile, Telford (2013) or Polanco-Martínez and López-Martínez (2021) for more information. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code> function estimates the rolling window correlation coefficients for only one window-length and their statistical significance between two time series sampled on identical time points. The function <code><a href="#topic+rolcor_estim_1win">rolcor_estim_1win</a></code> uses the functions <code>cor.test</code> (package:stats) and <code>running</code> (package:gtools) to estimate correlation coefficients and to compute the rolling window correlations, and also the functions <code>foreach</code> (package:foreach) and <code>makeCluster</code> (package:parallel) to parallelize the estimation of the statistical significance. 
</p>


<h3>Value</h3>

<p>Outputs:
A list containing six elements: <code>Correlation_coefficients</code> and <code>CRITVAL</code> contain the rolling window correlation coefficients and their respective critical values to determine the statistical significance of these coefficients, <code>CorMethod</code> is the method used to estimate the correlation coefficients (e.g., Pearson, Spearman or Kendall), <code>widthwin</code> contain the window-length (time-scales), and <code>left_win</code> and <code>righ_win</code> are used to accommodate the times of the rolling window correlation coefficients.
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br />
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez/">https://www.researchgate.net/profile/Josue-Polanco-Martinez/</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>.<br />
José L. López-Martínez.<br /> 
Faculty of Mathematics, Universidad Autónoma de Yucatán (UADY), Tizimín, MEXICO.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=552PKVEAAAAJ&amp;hl=es/">https://scholar.google.es/citations?user=552PKVEAAAAJ&amp;hl=es/</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Jose-Lopez-Martinez-3/">https://www.researchgate.net/profile/Jose-Lopez-Martinez-3/</a>.<br />
Email: <a href="mailto:jose.lopez@correo.uady.mx">jose.lopez@correo.uady.mx</a>. <br /> 
</p>


<h3>References</h3>

<p>Polanco-Martínez, J. M. and López-Martínez, J.M. (2021). A non-parametric method to test the statistical significance in rolling window correlations, and applications to ecological time series. Ecological Informatics 60, 101379. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2021.101379">10.1016/j.ecoinf.2021.101379</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). NonParRolCor: an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Telford, R.: Running correlations &ndash; running into problems. (2013). &lt;URL: <br /> 
<a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a>&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Code to test the function "rolcor_estim_1win"
 # Defining the 'NonParRolCor' parameters 
 # Number of Monte-Carlo simulations (MCSim), please use at least 1000. 
 # WARNING: MCSim=2, it's just to test this example! 
 MCSim &lt;- 2 
 Np    &lt;- 2  # Number of cores 
 X_Y &lt;- rolcor_estim_1win(syntheticdata[1:350,], CorMethod="pearson", 
                   widthwin=3, Align="center", rmltrd=TRUE, Scale=TRUE, 
                   MCSim=MCSim, Np=Np, prob=0.95)
 </code></pre>

<hr>
<h2 id='rolcor_estim_heatmap'>Estimates the rolling window correlation coefficients for several window-lengths and their statistical significance 
</h2><span id='topic+rolcor_estim_heatmap'></span><span id='topic+rolcor_estim_heatmap'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> function estimates the rolling window correlation coefficients for all the possible window-lengths (time-scales) or for a band of window-lengths for two time series sampled on identical time points, and their statistical significance via a non-parametric computing-intensive method. To carry out the computational implementation we extend the works of Telford (2013), Polanco-Martínez (2019) and Polanco-Martínez (2020). The test/method to determine the statistical significance is described in Polanco-Martínez and López-Martínez (2021). The <br /> <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> function is highly flexible since this contains several parameters to control the estimation of the correlation. A list of parameters are described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rolcor_estim_heatmap(inputdata, CorMethod="pearson", typewidthwin="FULL", 
                     widthwin_1=3, widthwin_N=dim(inputdata)[1], Align="center", 
                     rmltrd=TRUE, Scale=TRUE, MCSim=1000, prob=0.95, Np=2) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rolcor_estim_heatmap_+3A_inputdata">inputdata</code></td>
<td>

<p>A matrix of 3 columns: time (regular/evenly spaced), the first (e.g., the independent) variable, and the second (e.g., the dependent) variable. Please verify if <code>inputdata</code> is a matrix. 
</p>
</td></tr> 
<tr><td><code id="rolcor_estim_heatmap_+3A_cormethod">CorMethod</code></td>
<td>

<p>The method used to estimate the correlations, by default is &ldquo;pearson&rdquo;, but other options (&ldquo;spearman&rdquo; and &ldquo;kendall&rdquo;) are available (please look at: <span class="rlang"><b>R</b></span>&gt;?cor.test).
</p>
</td></tr>
<tr><td><code id="rolcor_estim_heatmap_+3A_typewidthwin">typewidthwin</code></td>
<td>
<p>&ldquo;FULL&rdquo; is to estimate the windows from 2, 4, ..., to dim(inputdata)[1]) if <code>Align</code> is equal to &ldquo;left&rdquo; or &ldquo;right&rdquo;, or from 3, 5,..., to dim(inputdata)[1]) if Align is &ldquo;center.&rdquo; The other option is &ldquo;PARTIAL&rdquo;, please you should take into account that <code>widthwin_1</code> and <code>widthwin_1</code> MUST be ODD if the <code>Align</code> option is &ldquo;center.&rdquo; 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_heatmap_+3A_widthwin_1">widthwin_1</code></td>
<td>

<p>First value for the size (length) of the windows when the option <br /> <code>typewidthwin</code>=&ldquo;PARTIAL&rdquo; is selected, the minimum value is 3 (the default value), but you must define this parameter (please note that <code>widthwin_1</code> &lt; <code>widthwin_N</code>). 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_heatmap_+3A_widthwin_n">widthwin_N</code></td>
<td>

<p>Last value for the size (length) of the windows when the option <br /> <code>typewidthwin</code>=&ldquo;PARTIAL&rdquo; is selected, by default is dim(inputdata)[1], but you must define this parameter (please note that <code>widthwin_1</code> &lt; <code>widthwin_N</code>).
</p>
</td></tr>
<tr><td><code id="rolcor_estim_heatmap_+3A_align">Align</code></td>
<td>

<p>To align the rolling object, NonParRolCor uses three options: &ldquo;left&rdquo;, &ldquo;center&rdquo;, and &ldquo;right&rdquo; (please look at: <span class="rlang"><b>R</b></span>&gt;?running). However, there are some restrictions, which have been described lines above. We recommend to use the &ldquo;center&rdquo; option to ensure that variations in the correlations are aligned with the variations in the relationships of the variables under study, rather than being shifted to left or to right (Polanco-Martínez 2019, 2020), but this imply that the window-lengths must be odd. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_heatmap_+3A_rmltrd">rmltrd</code></td>
<td>

<p>Remove (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) the linear trend in the variables under analysis. It is advisable to remove (at least the linear) the trend before estimating the rolling window correlation coefficients, especially, for large window-lengths. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_heatmap_+3A_scale">Scale</code></td>
<td>

<p>Scale (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo;  otherwise) is used to &ldquo;normalize&rdquo; or &ldquo;standardize&rdquo; the variables under analysis. It is highly advisable to &rdquo;normalize/standardize&rdquo; the time series under study to have them in the same scales. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_heatmap_+3A_mcsim">MCSim</code></td>
<td>

<p>Number of Monte-Carlo simulations to permute the second variable. It is advisable to use at least 1000 simulations. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_heatmap_+3A_prob">prob</code></td>
<td>

<p>Numeric vector of probabilities with values in the interval [0,1], by default prob=0.95 (p=0.05), please look at <span class="rlang"><b>R</b></span>?quantile, Telford (2013), or Polanco-Martínez and López-Martínez (2021) for more information. 
</p>
</td></tr>
<tr><td><code id="rolcor_estim_heatmap_+3A_np">Np</code></td>
<td>

<p>Number of CPU cores, by default is 2. Please verify the number of cores of your computer. WARNING: it is not advisable to use the maximum number of cores of your computer.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> function estimates the rolling window correlation coefficients and their statistical significance between two time series sampled on identical time points for all the possible window-lengths or for a band of window-lengths. This function supersedes to the function <code>estimation_NonParRolCor</code> of the previous version of <code>NonParRolCor</code>. The function <br /> <code><a href="#topic+rolcor_estim_heatmap">rolcor_estim_heatmap</a></code> uses the functions <code>cor.test</code> (package:stats) and <code>running</code> (package:gtools) to estimate the correlation coefficients and compute the rolling window correlations, and also the functions <code>foreach</code> (package:foreach) and <code>makeCluster</code> (package:parallel) to parallelize the estimation of the rolling window correlations. 
</p>


<h3>Value</h3>

<p>Outputs:
A list containing eight elements: <code>the_matrixCOR</code> and <code>CRITVAL</code> contain the rolling window correlation coefficients and their respective critical values, <code>nwin</code> and <code>Rwidthwin</code> contain the number of window-lengths (time-scales) and the window-lengths, <code>left_win</code> and <code>righ_win</code> are used to accommodate the times of the rolling window correlation coefficients, finally <code>MCSim</code> indicates the number of Monte-Carlo simulations and <code>prob</code> the significance level. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
Excellence Unit GECOS, IME, Universidad de Salamanca, Salamanca, SPAIN.<br />
BC3 - Basque Centre for Climate Change, Leioa, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en/</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez/">https://www.researchgate.net/profile/Josue-Polanco-Martinez/</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>.<br />
José L. López-Martínez.<br /> 
Faculty of Mathematics, Universidad Autónoma de Yucatán (UADY), Tizimín, MEXICO.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=552PKVEAAAAJ&amp;hl=es/">https://scholar.google.es/citations?user=552PKVEAAAAJ&amp;hl=es/</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Jose-Lopez-Martinez-3/">https://www.researchgate.net/profile/Jose-Lopez-Martinez-3/</a>.<br />
Email: <a href="mailto:jose.lopez@correo.uady.mx">jose.lopez@correo.uady.mx</a>. <br /> 
</p>


<h3>References</h3>

<p>Polanco-Martínez, J. M. and López-Martínez, J.M. (2021). A non-parametric method to test the statistical significance in rolling window correlations, and applications to ecological time series. Ecological Informatics 60, 101379. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2021.101379">10.1016/j.ecoinf.2021.101379</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). NonParRolCor: an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Telford, R.: Running correlations &ndash; running into problems. (2013). &lt;URL: <br /> 
<a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a>&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Code to test the function "rolcor_estim_heatmap"
 # Defining the 'NonParRolCor' parameters 
 TYPEWIDTHWIN="PARTIAL"
 # Number of Monte-Carlo simulations (MCSim), please use at least 1000. 
 # WARNING: MCSim=2, it's just to test this example! 
 MCSim &lt;- 2 
 Np    &lt;- 2  # Number of cores 
 X_Y &lt;- rolcor_estim_heatmap(syntheticdata[1:350,], CorMethod="pearson", 
                   typewidthwin=TYPEWIDTHWIN, widthwin_1=29, 
                   widthwin_N=51, Align="center", 
                   rmltrd=TRUE, Scale=TRUE, MCSim=MCSim, Np=Np)
 </code></pre>

<hr>
<h2 id='syntheticdata'>Synthetic data set to exemplify the use of the functions contained in <em>NonParRolCor</em> 
</h2><span id='topic+syntheticdata'></span>

<h3>Description</h3>

<p>The data set <code><a href="#topic+syntheticdata">syntheticdata</a></code> contains three columns: the first one are the &ldquo;times&rdquo; (from 1 to 500) (named &ldquo;Times&rdquo;), the second (named &ldquo;X&rdquo;) and the third (named &ldquo;Y&rdquo;) columns were generated by a bi-variate AR1 process with similar autocorrelation coefficients of 0.25. We generate two correlated bi-variate AR1 time series with positive (direct) correlation (0.85) for the first 250 elements and with negative (inverse) correlation (-0.85) for the last 250 elements (Polanco-Martínez and López-Martínez 2021). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(syntheticdata)
</code></pre>


<h3>Format</h3>

<p>One file in ASCII format containing three columns and 500 rows, columns are separated by spaces. 
</p>


<h3>Source</h3>

<p>Author's own production (Josué M. Polanco-Martínez) based on: mpiktas (&lt;URL: <a href="https://stats.stackexchange.com/users/2116/mpiktas/">https://stats.stackexchange.com/users/2116/mpiktas/</a>&gt;). How to simulate two correlated AR(1) time series?, Cross Validated. (2013). &lt;URL: <a href="https://stats.stackexchange.com/q/71831/">https://stats.stackexchange.com/q/71831/</a>&gt; (version: 2013-10-03).<br />
</p>
<p>Polanco-Martínez, J. M. and López-Martínez, J.M. (2021). A non-parametric method to test the statistical significance in rolling window correlations, and applications to ecological time series, Ecological Informatics 60, 101379. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2021.101379">10.1016/j.ecoinf.2021.101379</a>&gt;. 
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
