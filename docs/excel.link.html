<!DOCTYPE html><html><head><title>Help for package excel.link</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {excel.link}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#excel.link-package'><p>excel.link: convenient data exchange with Microsoft Excel</p></a></li>
<li><a href='#COMStop'><p>Functions from RDCOMClient package</p></a></li>
<li><a href='#current.graphics'><p>Auxiliary function for export graphics to Microsoft Excel</p></a></li>
<li><a href='#xl'><p>Data exchange with running Microsoft Excel instance.</p></a></li>
<li><a href='#xl.bind.range'><p>Active bindings to Excel ranges</p></a></li>
<li><a href='#xl.connect.table'><p>Live connection with data on Microsoft Excel sheet</p></a></li>
<li><a href='#xl.current.region'><p>Read/write from/to Excel current region.</p></a></li>
<li><a href='#xl.get.excel'><p>Returns reference to Excel application.</p></a></li>
<li><a href='#xl.index2address'><p>Converts Excel address to indexes and vice versa.</p></a></li>
<li><a href='#xl.property'><p>Excel constants and helper function for setting Excel range properties.</p></a></li>
<li><a href='#xl.read.file'><p>Functions for saving and reading data to/from Excel file.</p></a></li>
<li><a href='#xl.sheet.add'><p>Basic operations with worksheets.</p></a></li>
<li><a href='#xl.workbook.add'><p>Basic operations with Excel workbooks</p></a></li>
<li><a href='#xl.write'><p>Methods for writing data to Excel sheet</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Convenient Data Exchange with Microsoft Excel</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.13</td>
</tr>
<tr>
<td>Author:</td>
<td>Gregory Demin &lt;excel.link.feedback@gmail.com&gt;. To comply CRAN policy
    includes source code from 'RDCOMClient' (http://www.omegahat.net/RDCOMClient/) by
    Duncan Temple Lang &lt;duncan@wald.ucdavis.edu&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gregory Demin &lt;excel.link.feedback@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, grDevices, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>OS_type:</td>
<td>windows</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows access to data in running instance of Microsoft Excel
    (e. g. 'xl[a1] = xl[b2]*3' and so on). Graphics can be transferred with
    'xl[a1] = current.graphics()'. Additionally there are function for reading/writing 
    'Excel' files - 'xl.read.file'/'xl.save.file'. They are not fast but able to read/write 
    '*.xlsb'-files and password-protected files. There is an Excel workbook with 
    examples of calling R from Excel in the 'doc' folder. It tries to keep things as
    simple as possible - there are no needs in any additional
    installations besides R, only 'VBA' code in the Excel workbook.
    Microsoft Excel is required for this package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gdemin/excel.link">https://github.com/gdemin/excel.link</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gdemin/excel.link/issues">https://github.com/gdemin/excel.link/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-07 23:32:37 UTC; cekor</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-08 00:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='excel.link-package'>excel.link: convenient data exchange with Microsoft Excel</h2><span id='topic+excel.link'></span><span id='topic+excel.link-package'></span>

<h3>Description</h3>

<p>The excel.link package mainly consists of two rather independent parts: one
is for transferring data/graphics to running instance of Excel, another part
- work with data table in Excel in similar way as with usual data.frame.
</p>


<h3>Transferring data</h3>

<p>Package provided family of objects: 
<code><a href="#topic+xl">xl</a></code>, <code><a href="#topic+xlc">xlc</a></code>, <code><a href="#topic+xlr">xlr</a></code> and 
<code><a href="#topic+xlrc">xlrc</a></code>. You don't need to initialize these objects or to do any
other preliminary actions. Just after execution <code>library(excel.link)</code> 
you can transfer data to Excel active sheet by simple assignment, for 
example: <code>xlrc[a1]  = iris</code>. In this notation 'iris' dataset will be 
written with column and row names. If you doesn't need column/row names 
just remove 'r'/'c' letters (<code>xlc[a1]  = iris</code> - with column names but
without row names). To read Excel data just type something like this: 
<code>xl[a1:b5]</code>. You will get data.frame with values from range a1:a5 
without column and row names. It is possible to use named ranges (e. g. 
<code>xl[MyNamedRange]</code>). To transfer graphics use <code>xl[a1] = 
  current.graphics()</code>.
You can make active binding to Excel range:
</p>
<pre>
  xl.workbook.add()
  xl_iris %=crc% a1 # bind variable to current region around cell A1 on Excel active sheet
  xl_iris = iris # put iris data set 
  identical(xl_iris$Sepal.Width, iris$Sepal.Width)
  xl_iris$test = "Hello, world!" # add new column on Excel sheet
  xl_iris = within(xl_iris, {
     new_col = Sepal.Width * Sepal.Length # add new column on Excel sheet
     }) 
  </pre>


<h3>Live connection</h3>

<p>For example we put iris datasset to Excel sheet:
<code>xlc[a1] = iris</code>. After that we connect Excel range with R object:
<code>xl_iris = xl.connect.table("a1",row.names = FALSE, col.names =
  TRUE)</code>. So we can: 
</p>
 
<ul>
<li><p> get data from this Excel range: <code>xl_iris$Species</code> 
</p>
</li>
<li><p> add new data to this Excel range: <code>xl_iris$new_column = 42</code> 
</p>
</li>
<li><p> sort this range: <code>sort(xl_iris,column = "Sepal.Length")</code> 
</p>
</li>
<li><p> and more...
</p>
</li></ul>

<p>Live connection is faster than active binding to range but is less universal 
(for example, you can't use <code>within</code> statement with it).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xl">xl</a></code>, <code><a href="#topic+current.graphics">current.graphics</a></code>,
<code><a href="#topic+xl.connect.table">xl.connect.table</a></code>
</p>

<hr>
<h2 id='COMStop'>Functions from RDCOMClient package</h2><span id='topic+COMStop'></span><span id='topic+createCOMReference'></span><span id='topic+SCOMErrorInfo-class'></span><span id='topic+IUnknown-class'></span><span id='topic+COMIDispatch-class'></span><span id='topic+COMDate-class'></span><span id='topic+COMCurrency-class'></span><span id='topic+COMDecimal-class'></span><span id='topic+HResult-class'></span><span id='topic+VARIANT-class'></span><span id='topic+CurrencyVARIANT-class'></span><span id='topic+DateVARIANT-class'></span><span id='topic+DispatchMethods'></span><span id='topic+.COMInit'></span><span id='topic+COMCreate'></span><span id='topic+getCOMInstance'></span><span id='topic+getCLSID'></span><span id='topic++24+3C-+2CCOMIDispatch+2CANY-method'></span><span id='topic++24+2CCOMIDispatch-method'></span><span id='topic++5B+5B+2CCOMIDispatch+2Cnumeric-method'></span><span id='topic++5B+5B+2CCOMIDispatch+2CANY-method'></span><span id='topic++5B+5B+3C-+2CCOMIDispatch+2Ccharacter+2Cmissing-method'></span><span id='topic++5B+5B+3C-+2CCOMIDispatch+2Cnumeric+2CANY-method'></span><span id='topic+.COM'></span><span id='topic+asCOMArray'></span><span id='topic+isValidCOMObject'></span><span id='topic+COMList-class'></span><span id='topic+COMList'></span><span id='topic+length+2CCOMList-method'></span><span id='topic++5B+5B+2CCOMList+2Cnumeric-method'></span><span id='topic++5B+5B+3C-+2CCOMList+2Cnumeric+2CANY-method'></span><span id='topic+lapply+2CCOMList-method'></span><span id='topic+sapply+2CCOMList-method'></span><span id='topic+lapply+2CCOMIDispatch-method'></span><span id='topic+sapply+2CCOMIDispatch-method'></span><span id='topic+COMTypedList-class'></span><span id='topic+getItemClassName'></span><span id='topic+getItemClassName+2CCOMTypedList-method'></span><span id='topic++5B+5B+2CCOMTypedList+2Cnumeric-method'></span><span id='topic+COMTypedNamedList-class'></span><span id='topic+COMTypedParameterizedNamedList-class'></span><span id='topic+names+2CCOMTypedParameterizedNamedList-method'></span><span id='topic++5B+5B+2CCOMTypedList+2Ccharacter-method'></span><span id='topic+getItemClassName+2CCOMTypedNamedList-method'></span><span id='topic+names+2CCOMTypedNamedList-method'></span><span id='topic+CompiledCOMIDispatch-class'></span><span id='topic+CompiledCOMCoClass-class'></span><span id='topic+getItemClassName+2CCompiledCOMCoClass-method'></span><span id='topic++5B+5B+2CCompiledCOMCoClass+2Ccharacter-method'></span><span id='topic++5B+5B+3C-+2CCompiledCOMCoClass+2Ccharacter+2CANY-method'></span><span id='topic++24+2CCompiledCOMCoClass-method'></span><span id='topic++24+3C-+2CCompiledCOMCoClass+2Ccharacter-method'></span><span id='topic+COMNames'></span><span id='topic+names+2CCompiledCOMIDispatch-method'></span><span id='topic++24+2CCompiledCOMIDispatch-method'></span><span id='topic++5B+5B+2CCompiledCOMIDispatch+2Ccharacter-method'></span><span id='topic++5B+5B+2CCompiledCOMIDispatch+2Cnumeric-method'></span><span id='topic++24+3C-+2CCompiledCOMIDispatch+2Ccharacter-method'></span><span id='topic++5B+5B+3C-+2CCompiledCOMIDispatch+2Ccharacter+2CANY-method'></span><span id='topic++5B+2CCOMList+2Cnumeric+2Cmissing-method'></span><span id='topic++5B+2CCOMTypedNamedList+2Cnumeric+2Cmissing-method'></span><span id='topic++5B+2CCOMTypedNamedList+2Ccharacter+2Cmissing-method'></span><span id='topic++5B+5B+2CCOMTypedNamedList+2Ccharacter-method'></span><span id='topic+EnumValue-class'></span><span id='topic+show+2CEnumValue-method'></span><span id='topic+EnumValue'></span><span id='topic+EnumValue+2Ccharacter+2Cnumeric+2CEnumValue-method'></span><span id='topic+EnumValue+2Ccharacter+2CEnumValue+2CANY-method'></span><span id='topic+EnumValue+2Cnumeric+2CEnumValue+2CANY-method'></span><span id='topic+EnumValue+2Ccharacter+2Cmissing+2CEnumValue-method'></span><span id='topic+EnumValue+2Cnumeric+2Cmissing+2CEnumValue-method'></span><span id='topic+createTypeVarName'></span><span id='topic+createTypeVarName+2CCOMIDispatch-method'></span><span id='topic+createTypeVarName+2CCompiledCOMCoClass-method'></span><span id='topic+createTypeVarName+2Ccharacter-method'></span><span id='topic+getCOMElements'></span><span id='topic+RDCOMClient'></span>

<h3>Description</h3>

<p>For details about these functions see help for RDCOMClient package by 
Duncan Temple Lang <a href="mailto:duncan@wald.ucdavis.edu">duncan@wald.ucdavis.edu</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COMStop(msg, status, class = "COMError")

createCOMReference(ref, className)

DispatchMethods

.COMInit(status = TRUE)

COMCreate(name, ..., existing = TRUE)

getCOMInstance(guid, force = TRUE, silent = FALSE)

getCLSID(appName)

## S4 replacement method for signature 'COMIDispatch,ANY'
x$name &lt;- value

## S4 method for signature 'COMIDispatch'
x$name

## S4 method for signature 'COMIDispatch,numeric'
x[[i, j, ...]]

## S4 method for signature 'COMIDispatch,ANY'
x[[i, j, ...]]

## S4 replacement method for signature 'COMIDispatch,character,missing'
x[[i, j, ...]] &lt;- value

## S4 replacement method for signature 'COMIDispatch,numeric,ANY'
x[[i, j, ...]] &lt;- value

.COM(
  obj,
  name,
  ...,
  .dispatch = as.integer(3),
  .return = TRUE,
  .ids = numeric(0),
  .suppliedArgs
)

asCOMArray(obj)

isValidCOMObject(obj)

COMList(obj, class = "COMList")

## S4 method for signature 'COMList'
length(x)

## S4 method for signature 'COMList,numeric'
x[[i, j, ...]]

## S4 replacement method for signature 'COMList,numeric,ANY'
x[[i, j, ...]] &lt;- value

## S4 method for signature 'COMList'
length(x)

## S4 method for signature 'COMList'
lapply(X, FUN, ...)

## S4 method for signature 'COMList'
sapply(X, FUN, ..., simplify = TRUE, USE.NAMES = TRUE)

## S4 method for signature 'COMIDispatch'
lapply(X, FUN, ...)

## S4 method for signature 'COMIDispatch'
sapply(X, FUN, ..., simplify = TRUE, USE.NAMES = TRUE)

getItemClassName(x)

## S4 method for signature 'COMTypedList'
getItemClassName(x)

## S4 method for signature 'COMTypedList,numeric'
x[[i, j, ...]]

## S4 method for signature 'COMTypedParameterizedNamedList'
names(x)

## S4 method for signature 'COMTypedList,character'
x[[i, j, ...]]

## S4 method for signature 'COMTypedNamedList'
getItemClassName(x)

## S4 method for signature 'COMTypedNamedList'
names(x)

## S4 method for signature 'CompiledCOMCoClass'
getItemClassName(x)

## S4 method for signature 'CompiledCOMCoClass,character'
x[[i, j, ...]]

## S4 replacement method for signature 'CompiledCOMCoClass,character,ANY'
x[[i, j, ...]] &lt;- value

## S4 method for signature 'CompiledCOMCoClass'
x$name

## S4 replacement method for signature 'CompiledCOMCoClass,character'
x$name &lt;- value

COMNames(x)

## S4 method for signature 'CompiledCOMIDispatch'
names(x)

## S4 method for signature 'CompiledCOMIDispatch'
x$name

## S4 method for signature 'CompiledCOMIDispatch,character'
x[[i, j, ...]]

## S4 method for signature 'CompiledCOMIDispatch,numeric'
x[[i, j, ...]]

## S4 replacement method for signature 'CompiledCOMIDispatch,character'
x$name &lt;- value

## S4 replacement method for signature 'CompiledCOMIDispatch,character,ANY'
x[[i, j, ...]] &lt;- value

## S4 method for signature 'COMList,numeric,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'COMTypedNamedList,numeric,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'COMTypedNamedList,character,missing'
x[i, j, ..., drop = TRUE]

## S4 method for signature 'COMTypedNamedList,character'
x[[i, j, ..., exact = NA]]

## S4 method for signature 'EnumValue'
show(object)

EnumValue(id, value, obj = new("EnumValue"))

## S4 method for signature 'character,numeric,EnumValue'
EnumValue(id, value, obj = new("EnumValue"))

## S4 method for signature 'character,EnumValue,ANY'
EnumValue(id, value, obj = new("EnumValue"))

## S4 method for signature 'numeric,EnumValue,ANY'
EnumValue(id, value, obj = new("EnumValue"))

## S4 method for signature 'character,missing,EnumValue'
EnumValue(id, value, obj = new("EnumValue"))

## S4 method for signature 'numeric,missing,EnumValue'
EnumValue(id, value, obj = new("EnumValue"))

createTypeVarName(className, var, quote = TRUE)

## S4 method for signature 'COMIDispatch'
createTypeVarName(className, var, quote = TRUE)

## S4 method for signature 'CompiledCOMCoClass'
createTypeVarName(className, var, quote = TRUE)

## S4 method for signature 'character'
createTypeVarName(className, var, quote = TRUE)

getCOMElements(type, env = NA, namesOnly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="COMStop_+3A_msg">msg</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_status">status</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_class">class</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_ref">ref</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_classname">className</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_name">name</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_...">...</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_existing">existing</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_guid">guid</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_force">force</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_silent">silent</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_appname">appName</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_x">x</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_value">value</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_i">i</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_j">j</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_obj">obj</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_.dispatch">.dispatch</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_.return">.return</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_.ids">.ids</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_.suppliedargs">.suppliedArgs</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_x">X</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_fun">FUN</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_simplify">simplify</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_use.names">USE.NAMES</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_drop">drop</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_exact">exact</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_object">object</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_id">id</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_var">var</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_quote">quote</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_type">type</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_env">env</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
<tr><td><code id="COMStop_+3A_namesonly">namesOnly</code></td>
<td>
<p>See RDCOMClient documentation.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>integer</code> of length 3.
</p>


<h3>Author(s)</h3>

<p>Duncan Temple Lang <a href="mailto:duncan@wald.ucdavis.edu">duncan@wald.ucdavis.edu</a>
</p>

<hr>
<h2 id='current.graphics'>Auxiliary function for export graphics to Microsoft Excel</h2><span id='topic+current.graphics'></span>

<h3>Description</h3>

<p>Auxiliary function for export graphics to Microsoft Excel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>current.graphics(
  type = c("png", "jpeg", "bmp", "tiff"),
  filename = NULL,
  picname = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="current.graphics_+3A_type">type</code></td>
<td>
<p>file type. Ignored if argument 'filename' provided.</p>
</td></tr>
<tr><td><code id="current.graphics_+3A_filename">filename</code></td>
<td>
<p>character. filename (or full path) of file with graphics.</p>
</td></tr>
<tr><td><code id="current.graphics_+3A_picname">picname</code></td>
<td>
<p>character. Picture name in Excel.</p>
</td></tr>
<tr><td><code id="current.graphics_+3A_...">...</code></td>
<td>
<p>arguments for internally used <code><a href="grDevices.html#topic+dev.copy">dev.copy</a></code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If argument <code>type</code> provided this function will save graphics 
from windows plotting device to temporary file and return path to this 
file. Argument <code>filename</code> is intended to transfer plots to Excel from 
file-based graphics devices (see Examples) or just insert into Excel file 
with graphics. If argument <code>filename</code> is provided argument <code>type</code>
will be ignored and returned value is path to file <code>filename</code> with 
class attribute 'current.graphics'. So it could be used with expressions 
such <code>xl[a1] = current.graphics(filename="plot.png")</code>. If 
<code>picname</code> is provided then picture will be inserted in Excel with this
name. If picture <code>picname</code> already exists in Excel it will be deleted.
This argument is useful when we need to change old picture in Excel instead
of adding new picture. <code>picname</code> will be automatically prepended by
&quot;_&quot; to avoid conflicts with Excel range names.
</p>


<h3>Value</h3>

<p>Path to file with saved graphics with class attribute 
'current.graphics'. If used with argument <code>type</code> than result has 
attribute <code>temp.file = TRUE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
xl.workbook.add()
plot(sin)
xl[a1] = current.graphics()
plot(cos)
cos.plot = current.graphics()
xl.sheet.add()
xl[a1] = list("Cosine plotting",cos.plot,"End of cosine plotting")

# the same thing without graphic windows 
png("1.png")
plot(sin)
dev.off()
sin.plot = current.graphics(filename = "1.png")
png("2.png")
plot(cos)
dev.off()
cos.plot = current.graphics(filename = "2.png")
output = list("Cosine plotting",cos.plot,"Sine plotting",sin.plot)
xl.workbook.add()
xl[a1] = output

## End(Not run)

</code></pre>

<hr>
<h2 id='xl'>Data exchange with running Microsoft Excel instance.</h2><span id='topic+xl'></span><span id='topic++5B.xl'></span><span id='topic+xlrc'></span><span id='topic+xlc'></span><span id='topic+xlr'></span><span id='topic+xln'></span><span id='topic+xlrcn'></span><span id='topic+xlcn'></span><span id='topic+xlrn'></span><span id='topic++5B+5B.xl'></span><span id='topic++24.xl'></span><span id='topic++5B+5B+3C-.xl'></span><span id='topic++24+3C-.xl'></span><span id='topic++5B+3C-.xl'></span><span id='topic++5B+5B+3C-.xln'></span><span id='topic++24+3C-.xln'></span><span id='topic++5B+3C-.xln'></span><span id='topic+xl.selection'></span>

<h3>Description</h3>

<p><code>xl</code>, <code>xlc</code>, <code>xlr</code>, <code>xlrc</code> objects are already defined in
the package. It doesn't need to create or init them. Just after attaching
package one can write something like this: <code>xl[a1] = "Hello, world!"</code>
and this text should appears in <code>A1</code> cell on active sheet of active
Excel workbook. <code>xl(*)n</code> family of functions creates new worksheet for
output. You can provide sheet name and position via
<code>xl.sheet.name</code>/<code>before</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'xl'
x[str.rng, drop = !(has.rownames(x) | has.colnames(x)), na = "", ...]

## S3 method for class 'xl'
x[[str.rng, drop = !(has.rownames(x) | has.colnames(x)), na = "", ...]]

## S3 method for class 'xl'
x$str.rng

## S3 replacement method for class 'xl'
x[[str.rng, na = "", ...]] &lt;- value

## S3 replacement method for class 'xl'
x$str.rng &lt;- value

## S3 replacement method for class 'xl'
x[str.rng, na = "", ...] &lt;- value

## S3 replacement method for class 'xln'
x[[str.rng, na = "", xl.sheet.name = NULL, before = NULL, ...]] &lt;- value

## S3 replacement method for class 'xln'
x$str.rng &lt;- value

## S3 replacement method for class 'xln'
x[str.rng, na = "", xl.sheet.name = NULL, before = NULL, ...] &lt;- value

xl.selection(drop = TRUE, na = "", row.names = FALSE, col.names = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl_+3A_x">x</code></td>
<td>
<p>One of <code>xl</code>, <code>xlc</code>, <code>xlr</code>, <code>xlrc</code> objects. 
<code>xl</code> - read/write with/without column and row names, &quot;r&quot; - with 
rownames, &quot;c&quot; - with colnames</p>
</td></tr>
<tr><td><code id="xl_+3A_str.rng">str.rng</code></td>
<td>
<p>character Excel range. For single bracket operations it can be
without quotes in almost all cases.</p>
</td></tr>
<tr><td><code id="xl_+3A_drop">drop</code></td>
<td>
<p>logical. If TRUE the result is coerced to the lowest possible 
dimension. By default dimensions will be dropped if there are no columns 
and rows names.</p>
</td></tr>
<tr><td><code id="xl_+3A_na">na</code></td>
<td>
<p>character. NA representation in Excel. By default it is empty 
string.</p>
</td></tr>
<tr><td><code id="xl_+3A_...">...</code></td>
<td>
<p>additional parameters. Not yet used.</p>
</td></tr>
<tr><td><code id="xl_+3A_value">value</code></td>
<td>
<p>suitable replacement value. It will be recycled to fill excel 
range only if it is object of length 1. In other cases size of excel range 
is ignored - all data will be placed in Excel sheet starting from top-left 
cell of submitted range.</p>
</td></tr>
<tr><td><code id="xl_+3A_xl.sheet.name">xl.sheet.name</code></td>
<td>
<p>character. sheet name in active workbook (for <code>xl(*)n</code>).</p>
</td></tr>
<tr><td><code id="xl_+3A_before">before</code></td>
<td>
<p>character/numeric. sheet name or sheet number in active
workbook before which new sheet will be added (for <code>xl(*)n</code>).</p>
</td></tr>
<tr><td><code id="xl_+3A_row.names">row.names</code></td>
<td>
<p>logical value indicating whether the Excel range contains 
the row names as its first column.</p>
</td></tr>
<tr><td><code id="xl_+3A_col.names">col.names</code></td>
<td>
<p>logical value indicating whether the Excel range contains 
the column names as its first row.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>xl</code> object represents Microsoft Excel application. For 
convenient interactive usage arguments can be given without quotes in most 
cases (e. g. <code>xl[a1] = 5</code> or <code>xl[u2:u85] = "Hi"</code> or 
<code>xl[MyNamedRange] = 42</code>, but <code>xl["Sheet1!A1"] = 42</code>). When it 
used in your own functions or you need to use variable as argument it is 
recommended apply double brackets notation: <code>xl[["a1"]] = 5</code> or 
<code>xl[["u2:u85"]] = "Hi"</code> or <code>xl[["MyNamedRange"]] = 42</code>. 
Difference between <code>xl</code>, <code>xlc</code>, <code>xlrc</code> and <code>xlr</code> is 
<code>xl</code> ignore row and column names, <code>xlc</code> suppose read and write to
Excel with column names, <code>xlrc</code> - with column and row names and so on.
There is argument <code>drop</code> which is <code>TRUE</code> by default for <code>xl</code>
and <code>FALSE</code> by default for other options. <code>xl.selection</code> returns 
data.frame with data from current selection in Excel. 
All these functions never coerce characters to factors
</p>


<h3>Value</h3>

<p>Returns appropriate dataset from Excel.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cr">cr</a></code>, <code><a href="#topic+xl.current.region">xl.current.region</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:  
data(iris)
rownames(iris) = as.character(rownames(iris))
iris$Species = as.character(iris$Species)
xl.workbook.add()
xlrc$a1 = iris
xl.iris = xl.current.region("a1",row.names=TRUE,col.names=TRUE)
identical(xl.iris,iris)

xl.sheet.add("Datasets examples")
data.sets = list("Iris dataset",iris,"Cars dataset",cars,"Titanic dataset",as.data.frame(Titanic))
xlrc[a1] = data.sets


## End(Not run)
</code></pre>

<hr>
<h2 id='xl.bind.range'>Active bindings to Excel ranges</h2><span id='topic+xl.bind.range'></span><span id='topic+xl.bind.current.region'></span><span id='topic++25+3Dxl+25'></span><span id='topic++25+3Dxlr+25'></span><span id='topic++25+3Dxlc+25'></span><span id='topic++25+3Dxlrc+25'></span><span id='topic++25+3Dcr+25'></span><span id='topic++25+3Dcrr+25'></span><span id='topic++25+3Dcrc+25'></span><span id='topic++25+3Dcrrc+25'></span><span id='topic++25+3Cxl-+25'></span><span id='topic++25+3Cxlr-+25'></span><span id='topic++25+3Cxlc-+25'></span><span id='topic++25+3Cxlrc-+25'></span><span id='topic++25+3Ccr-+25'></span><span id='topic++25+3Ccrr-+25'></span><span id='topic++25+3Ccrc-+25'></span><span id='topic++25+3Ccrrc-+25'></span><span id='topic+xl.binding.address'></span>

<h3>Description</h3>

<p><code>xl.bind.range</code> and <code>xl.bind.current.region</code> create <code>sym</code> in 
environment <code>env</code> so that getting the value of <code>sym</code> return bound 
Excel range, and assigning to <code>sym</code> will write the value to be assigned 
to Excel range. In case of <code>xl.bind.range</code>  range will be updated after 
each assignment accordingly to the size of the assigned value.
<code>xl.bind.current.region</code> always returns data from current region 
(Ctrl+Shift+* in Excel) of bound range. 
<code>%=xl%</code> etc are shortcuts for <code>xl.bind.range</code> and 
<code>xl.bind.current.region</code>. &quot;r&quot; means with row names, &quot;c&quot; means with
column names. Range in most cases can be provided without quotes: <code>a1
%=xl% a1:b100</code>. Functions with '='  and with '&lt;-' in the names do the same
things - they are just for those who prefer '=' assignment and for those who
prefer '&lt;-' assignment.
Assignment and reading may be slow because these functions always read/write
entire dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.bind.range(
  sym,
  str.range,
  drop = TRUE,
  na = "",
  row.names = FALSE,
  col.names = FALSE,
  env = parent.frame()
)

xl.bind.current.region(
  sym,
  str.range,
  drop = TRUE,
  na = "",
  row.names = FALSE,
  col.names = FALSE,
  env = parent.frame()
)

sym %=xl% value

sym %=xlr% value

sym %=xlc% value

sym %=xlrc% value

sym %=cr% value

sym %=crr% value

sym %=crc% value

sym %=crrc% value

sym %&lt;xl-% value

sym %&lt;xlr-% value

sym %&lt;xlc-% value

sym %&lt;xlrc-% value

sym %&lt;cr-% value

sym %&lt;crr-% value

sym %&lt;crc-% value

sym %&lt;crrc-% value

xl.binding.address(sym)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl.bind.range_+3A_sym">sym</code></td>
<td>
<p>character/active binding.</p>
</td></tr>
<tr><td><code id="xl.bind.range_+3A_str.range">str.range</code></td>
<td>
<p>character Excel range.</p>
</td></tr>
<tr><td><code id="xl.bind.range_+3A_drop">drop</code></td>
<td>
<p>logical. If TRUE the result is coerced to the lowest possible 
dimension. By default dimensions will be dropped if there are no columns 
and rows names.</p>
</td></tr>
<tr><td><code id="xl.bind.range_+3A_na">na</code></td>
<td>
<p>character. NA representation in Excel. By default it is empty 
string.</p>
</td></tr>
<tr><td><code id="xl.bind.range_+3A_row.names">row.names</code></td>
<td>
<p>logical value indicating whether the Excel range contains 
the row names as its first column.</p>
</td></tr>
<tr><td><code id="xl.bind.range_+3A_col.names">col.names</code></td>
<td>
<p>logical value indicating whether the Excel range contains 
the column names as its first row.</p>
</td></tr>
<tr><td><code id="xl.bind.range_+3A_env">env</code></td>
<td>
<p>an environment.</p>
</td></tr>
<tr><td><code id="xl.bind.range_+3A_value">value</code></td>
<td>
<p>character Excel range address. It can be without quotes in many cases.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>xl.binding.address</code> returns list with three components about 
bound Excel range: <code>address</code>, <code>rows</code> - number of rows, 
<code>columns</code> - number of columns. All other functions don't return 
anything but create active binding to Excel range in the environment.
</p>


<h3>Author(s)</h3>

<p>Idea by Stefan Fritsch
(<a href="https://github.com/gdemin/excel.link/issues/1">https://github.com/gdemin/excel.link/issues/1</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xl">xl</a></code>, <code><a href="#topic+xlr">xlr</a></code>, <code><a href="#topic+xlc">xlc</a></code>, 
<code><a href="#topic+xlrc">xlrc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 xl.workbook.add()
 range_a1 %=xl% a1 # binding range_a1 to cell A1 on active sheet
 range_a1 # should be NA
 range_a1 = 42 # value in Excel should be changed
 identical(range_a1, 42) 
 cr_a1 %=cr% a1 # binding cr_a1 to current region around cell A1 on active sheet
 identical(cr_a1, range_a1)
 # difference between 'cr' and 'xl':  
 xl[a2] = 43
 range_a1 # 42
 xl.binding.address(range_a1)
 xl.binding.address(cr_a1)
 cr_a1 # identical to 42:43
 # make cr and xl identical: 
 range_a1 = 42:43
 identical(cr_a1, range_a1)
 
 xl_iris %=crc% a1 # bind current region A1 on active sheet with column names
 xl_iris = iris # put iris dataset to Excel sheet
 identical(xl_iris$Sepal.Width, iris$Sepal.Width) # should be TRUE
 
 xl_iris$new_col = xl_iris$Sepal.Width*xl_iris$Sepal.Length # add new column on Excel sheet
 

## End(Not run)
</code></pre>

<hr>
<h2 id='xl.connect.table'>Live connection with data on Microsoft Excel sheet</h2><span id='topic+xl.connect.table'></span><span id='topic+sort.excel.range'></span>

<h3>Description</h3>

<p><code>xl.connect.table</code> returns object that can be operated as 
usual data.frame object and this operations (e. g. subsetting, assignment) 
will be immediately reflected on connected Excel range. See examples.
Connected range is 'current region', e. g. selection which can be obtained
by pressing <code>Ctrl+Shift+*</code> when selected <code>str.rng</code> (or top-left
cell of this range is active).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.connect.table(str.rng = "A1", row.names = TRUE, col.names = TRUE, na = "")

## S3 method for class 'excel.range'
sort(x, decreasing = FALSE, column, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl.connect.table_+3A_str.rng">str.rng</code></td>
<td>
<p>string which represents Excel range</p>
</td></tr>
<tr><td><code id="xl.connect.table_+3A_row.names">row.names</code></td>
<td>
<p>a logical value indicating whether the Excel range contains 
row names as its first column</p>
</td></tr>
<tr><td><code id="xl.connect.table_+3A_col.names">col.names</code></td>
<td>
<p>a logical value indicating whether the Excel range contains 
column names as its first row</p>
</td></tr>
<tr><td><code id="xl.connect.table_+3A_na">na</code></td>
<td>
<p>character. NA representation in Excel. By default it is empty string</p>
</td></tr>
<tr><td><code id="xl.connect.table_+3A_x">x</code></td>
<td>
<p>object of class <code>excel.range</code></p>
</td></tr>
<tr><td><code id="xl.connect.table_+3A_decreasing">decreasing</code></td>
<td>
<p>logical. Should the sort be increasing or decreasing?</p>
</td></tr>
<tr><td><code id="xl.connect.table_+3A_column">column</code></td>
<td>
<p>numeric or character. Column by which we will sort. There is 
special value - 'rownames'. In this case 'x' will be sorted by row names if
it has it.</p>
</td></tr>
<tr><td><code id="xl.connect.table_+3A_...">...</code></td>
<td>
<p>arguments to be passed to or from methods or (for the default 
methods and objects without a class)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Subsetting. Indices in subsetting operations are 
numeric/character/logical vectors or empty (missing). Numeric values are 
coerced to integer as by 'as.integer' (and hence truncated towards zero). 
Character vectors will be matched to the 'colnames' of the object (or Excel
column names if <code>has.colnames = FALSE</code>). For extraction form if column
name doesn't exist error will be generated. For replacement form new column
will be created. If indices are logical vectors they indicate 
elements/slices to select. Such vectors are recycled if necessary to match 
the corresponding extent. Indices can also be negative integers, indicating
elements/slices to leave out of the selection.
</p>


<h3>Value</h3>

 
<ul>
<li> <p><code>xl.connect.table</code> returns object of 
<code>excel.range</code> class which represent data on Excel sheet. This object
can be treated similar to data.frame. So you can assign values, delete 
columns/rows and so on. For more information see examples. 
</p>
</li>
<li> <p><code>sort</code> sorts Excel range by single column (multiple columns 
currently not supported) and invisibly return NULL. 
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
### session example 

library(excel.link)
xl.workbook.add()
xl.sheet.add("Iris dataset", before = 1)
xlrc[a1] = iris
xl.iris = xl.connect.table("a1", row.names = TRUE, col.names = TRUE)
dists = dist(xl.iris[, 1:4])
clusters = hclust(dists, method = "ward.D")
xl.iris$clusters = cutree(clusters, 3)
plot(clusters)
pl.clus = current.graphics()
cross = table(xl.iris$Species, xl.iris$clusters)
plot(cross)
pl.cross = current.graphics()
xl.sheet.add("Results", before = 2)
xlrc$a1 = list("Crosstabulation", cross,pl.cross, "Dendrogram", pl.clus)

### completely senseless actions       
### to demonstrate various operations and  
### compare them with operations on usual data.frame

# preliminary operations 
data(iris)
rownames(iris) = as.character(rownames(iris))
iris$Species = as.character(iris$Species)
xl.workbook.add()

# drop dataset to Excel and connect it
xlrc[a1] = iris
xl.iris = xl.connect.table("a1", row.names = TRUE, col.names = TRUE)
identical(xl.iris[], iris)

# dim/colnames/rownames
identical(dim(xl.iris),dim(iris))
identical(colnames(xl.iris),colnames(iris))
identical(rownames(xl.iris),rownames(iris))

# sort datasets
iris = iris[order(iris$Sepal.Length), ]
sort(xl.iris, column = "Sepal.Length")
identical(xl.iris[], iris)

# sort datasets by rownames
sort(xl.iris, column = "rownames")
iris = iris[order(rownames(iris)), ]
identical(xl.iris[], iris)

# different kinds of subsetting
identical(xl.iris[,1:3], iris[,1:3])
identical(xl.iris[,3], iris[,3])
identical(xl.iris[26,1:3], iris[26,1:3])
identical(xl.iris[-26,1:3], iris[-26,1:3])
identical(xl.iris[50,], iris[50,])
identical(xl.iris$Species, iris$Species)
identical(xl.iris[,'Species', drop = FALSE], iris[,'Species', drop = FALSE])
identical(xl.iris[c(TRUE,FALSE), 'Sepal.Length'], 
             iris[c(TRUE,FALSE), 'Sepal.Length'])

# column creation and assignment 
xl.iris[,'group'] = xl.iris$Sepal.Length &gt; mean(xl.iris$Sepal.Length)
iris[,'group'] = iris$Sepal.Length &gt; mean(iris$Sepal.Length)
identical(xl.iris[], iris)

# value recycling
xl.iris$temp = c('aa','bb')
iris$temp = c('aa','bb')
identical(xl.iris[], iris)

# delete column
xl.iris[,"temp"] = NULL
iris[,"temp"] = NULL
identical(xl.iris[], iris)


## End(Not run)
</code></pre>

<hr>
<h2 id='xl.current.region'>Read/write from/to Excel current region.</h2><span id='topic+xl.current.region'></span><span id='topic+cr'></span><span id='topic+crrc'></span><span id='topic+crc'></span><span id='topic+crr'></span><span id='topic++5B+5B.cr'></span><span id='topic++5B+5B+3C-.cr'></span>

<h3>Description</h3>

<p>Current region is a region that will be selected by pressing 
<code>Ctrl+Shift+*</code> in Excel. The current region is a range bounded by any 
combination of blank rows and blank columns. <code>cr</code>, <code>crc</code>, 
<code>crr</code>, <code>crrc</code> objects are already defined in the package. It 
doesn't need to create or init them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.current.region(
  str.rng,
  drop = TRUE,
  na = "",
  row.names = FALSE,
  col.names = FALSE,
  ...
)

## S3 method for class 'cr'
x[[str.rng, drop = !(has.rownames(x) | has.colnames(x)), na = "", ...]]

## S3 replacement method for class 'cr'
x[[str.rng, na = "", ...]] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl.current.region_+3A_str.rng">str.rng</code></td>
<td>
<p>character Excel range. For single bracket operations it can be
without quotes in almost all cases.</p>
</td></tr>
<tr><td><code id="xl.current.region_+3A_drop">drop</code></td>
<td>
<p>logical. If TRUE the result is coerced to the lowest possible 
dimension. By default dimensions will be dropped if there are no columns 
and rows names.</p>
</td></tr>
<tr><td><code id="xl.current.region_+3A_na">na</code></td>
<td>
<p>character. NA representation in Excel. By default it is empty 
string.</p>
</td></tr>
<tr><td><code id="xl.current.region_+3A_row.names">row.names</code></td>
<td>
<p>logical value indicating whether the Excel range contains 
the row names as its first column.</p>
</td></tr>
<tr><td><code id="xl.current.region_+3A_col.names">col.names</code></td>
<td>
<p>logical value indicating whether the Excel range contains 
the column names as its first row.</p>
</td></tr>
<tr><td><code id="xl.current.region_+3A_...">...</code></td>
<td>
<p>additional parameters. Not yet used.</p>
</td></tr>
<tr><td><code id="xl.current.region_+3A_x">x</code></td>
<td>
<p>One of <code>cr</code>, <code>crc</code>, <code>crr</code>, <code>crrc</code> objects. 
<code>cr</code> - read/write with/without column and row names, &quot;r&quot; - with 
rownames, &quot;c&quot; - with colnames</p>
</td></tr>
<tr><td><code id="xl.current.region_+3A_value">value</code></td>
<td>
<p>suitable replacement value. All data will be placed in Excel
sheet starting from top-left cell of current region. Current region will be
cleared before writing.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>cr</code> object represents Microsoft Excel application. For 
convenient interactive usage arguments can be given without quotes in most 
cases (e. g. <code>cr[a1] = 5</code> or <code>cr[u2:u85] = "Hi"</code> or 
<code>cr[MyNamedRange] = 42</code>, but <code>cr["Sheet1!A1"] = 42</code>). When it 
used in your own functions or you need to use variable as argument it is 
recommended apply double brackets notation: <code>cr[["a1"]] = 5</code> or 
<code>cr[["u2:u85"]] = "Hi"</code> or <code>cr[["MyNamedRange"]] = 42</code>. 
Difference between <code>cr</code>, <code>crc</code>, <code>crrc</code> and <code>crr</code> is 
<code>cr</code> ignore row and column names, <code>crc</code> suppose read and write to
Excel with column names, <code>crrc</code> - with column and row names and so on.
There is argument <code>drop</code> which is <code>TRUE</code> by default for <code>cr</code>
and <code>FALSE</code> by default for other options. 
All these functions never coerce characters to factors
</p>


<h3>Value</h3>

<p>Returns appropriate dataset from Excel.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xl">xl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:  
data(iris)
data(mtcars)
xl.workbook.add()
xlc$a1 = iris
identical(crc[a1],xlc[a1:e151]) # should be TRUE
identical(crc$a1,xlc[a1:e151]) # should be TRUE
identical(crc$a1,xlc[a1]) # should be FALSE

# current region will be cleared before writing - no parts of iris dataset
crrc$a1 = mtcars 
identical(crrc$a1,xlrc[a1:l33]) # should be TRUE


## End(Not run)
</code></pre>

<hr>
<h2 id='xl.get.excel'>Returns reference to Excel application.</h2><span id='topic+xl.get.excel'></span>

<h3>Description</h3>

<p>Returns reference to Microsoft Excel application. If there is no running 
instance exists it will create a new instance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.get.excel()
</code></pre>


<h3>Value</h3>

<p>object of class 'COMIDispatch' (as returned by 
<code>COMCreate</code> from RDCOMClient package).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
xls = xl.get.excel() 

## End(Not run)
</code></pre>

<hr>
<h2 id='xl.index2address'>Converts Excel address to indexes and vice versa.</h2><span id='topic+xl.index2address'></span><span id='topic+xl.address2index'></span>

<h3>Description</h3>

<p>Converts Excel address to indexes and vice versa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.index2address(top, left, bottom = NULL, right = NULL)

xl.address2index(str.range)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl.index2address_+3A_top">top</code></td>
<td>
<p>integer top index of top-left cell</p>
</td></tr>
<tr><td><code id="xl.index2address_+3A_left">left</code></td>
<td>
<p>integer left index of top-left cell</p>
</td></tr>
<tr><td><code id="xl.index2address_+3A_bottom">bottom</code></td>
<td>
<p>integer bottom index of bottom-right cell</p>
</td></tr>
<tr><td><code id="xl.index2address_+3A_right">right</code></td>
<td>
<p>integer right index of bottom-right cell</p>
</td></tr>
<tr><td><code id="xl.index2address_+3A_str.range">str.range</code></td>
<td>
<p>character Excel range address</p>
</td></tr>
</table>


<h3>Value</h3>

<p>xl.index2address returns character address (e. g. A1:B150), 
xl.address2index returns vector with four components: top, left, bottom,
right.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
xl.address2index("A1:D150")
xl.index2address(top=1, left=1)

## Not run: 
a1 %=xl% a1
a1 = iris
addr = xl.binding.address(a1)$address
xl.address2index(addr) 


## End(Not run)

</code></pre>

<hr>
<h2 id='xl.property'>Excel constants and helper function for setting Excel range properties.</h2><span id='topic+xl.property'></span><span id='topic+xl.constants'></span>

<h3>Description</h3>

<p><code>xl.constants</code> is a list with (surprise!) Excel named constants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.property(...)

xl.constants
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl.property_+3A_...">...</code></td>
<td>
<p>names of arguments are properties as in Excel VBA, values are properties values.</p>
</td></tr>
</table>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 2024.
</p>


<h3>Value</h3>

<p>list of class <code>xl.property</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# create random matrix
rand_mat = matrix(runif(16), ncol = 4)

# put it on the new worksheet
xln[a1] = rand_mat 

# set bold font, format numbers as percent and align it
cr[a1] = xl.property(Font.Bold = TRUE, 
                     NumberFormat = "0.00%", 
                     HorizontalAlignment = xl.constants$xlCenter
                     )

## End(Not run)
</code></pre>

<hr>
<h2 id='xl.read.file'>Functions for saving and reading data to/from Excel file.</h2><span id='topic+xl.read.file'></span><span id='topic+xl.save.file'></span>

<h3>Description</h3>

<p>Functions for saving and reading data to/from Excel file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.read.file(
  filename,
  header = TRUE,
  row.names = NULL,
  col.names = NULL,
  xl.sheet = NULL,
  top.left.cell = "A1",
  na = "",
  password = NULL,
  write.res.password = NULL,
  excel.visible = FALSE
)

xl.save.file(
  r.obj,
  filename,
  row.names = TRUE,
  col.names = TRUE,
  xl.sheet = NULL,
  top.left.cell = "A1",
  na = "",
  password = NULL,
  write.res.password = NULL,
  excel.visible = FALSE,
  file.format = xl.constants$xlOpenXMLWorkbook
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl.read.file_+3A_filename">filename</code></td>
<td>
<p>a character</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_header">header</code></td>
<td>
<p>a logical value indicating whether the file contains the names
of the variables as its first line. If TRUE and top-left corner is empty
cell, first column is considered as row names. Ignored if row.names or
col.names is not NULL.</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_row.names">row.names</code></td>
<td>
<p>a logical value indicating whether the row names of r.obj
are to be read/saved along with r.obj</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_col.names">col.names</code></td>
<td>
<p>a logical value indicating whether the column names of r.obj
are to be read/saved along with r.obj</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_xl.sheet">xl.sheet</code></td>
<td>
<p>character. Name of Excel sheet where data is located/will be
saved. By default it is NULL and data will be read/saved from/to active
sheet.</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_top.left.cell">top.left.cell</code></td>
<td>
<p>character. Top-left corner of data in Excel sheet. By
default is 'A1'.</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_na">na</code></td>
<td>
<p>character. NA representation in Excel. By default it is empty
string.</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_password">password</code></td>
<td>
<p>character. Password for password-protected workbook.</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_write.res.password">write.res.password</code></td>
<td>
<p>character. Second password for editing workbook.</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_excel.visible">excel.visible</code></td>
<td>
<p>a logical value indicating will Excel visible during
this operations. FALSE by default.</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_r.obj">r.obj</code></td>
<td>
<p>R object.</p>
</td></tr>
<tr><td><code id="xl.read.file_+3A_file.format">file.format</code></td>
<td>
<p>integer. Excel file format. By default it is
<code>xl.constants$xlOpenXMLWorkbook</code>. You can use
<code>xl.constants$xlOpenXMLWorkbookMacroEnabled</code> for workbooks with macros
(*.xlsm) or <code>xl.constants$xlExcel12</code> for binary workbook (.xlsb).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>xl.read.file</code> reads only rectangular data set. It is highly
recommended to have all column names and ids in data set. Orphaned
rows/columns located apart from the main data will be ignored.
<code>xl.save.file</code> can save all objects for which <code>xl.write</code> method exists -
see examples.
</p>


<h3>Value</h3>

<p><code>xl.read.file</code> always returns data.frame. <code>xl.save.file</code>
invisibly returns NULL.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xl.write">xl.write</a></code>, <code><a href="#topic+xl.workbook.save">xl.workbook.save</a></code>,
<code><a href="#topic+xl.workbook.open">xl.workbook.open</a></code>, <code><a href="#topic+current.graphics">current.graphics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
data(iris)
xl.save.file(iris,"iris.xlsx")
xl.iris = xl.read.file("iris.xlsx")
all(iris == xl.iris) # Shoud be TRUE
unlink("iris.xlsx")

# Save to file list with different data types 
dists = dist(iris[,1:4])
clusters = hclust(dists,method="ward.D")
iris$clusters = cutree(clusters,3)
png("1.png")
plot(clusters)
dev.off()
pl.clus = current.graphics(filename="1.png")
cross = table(iris$Species,iris$clusters)
png("2.png")
plot(cross)
dev.off()
pl.cross = current.graphics(filename="2.png")
output = list("Iris",pl.clus,cross,pl.cross,"Data:","",iris)
xl.save.file(output,"output.xls")
xl.workbook.open("output.xls")
# xl.workbook.close() # close workbook
# unlink("output.xls") # delete file

# password-protected file
data(iris)
xl.save.file(iris,"iris.xlsx", password = "pass")
xl.iris = xl.read.file("iris.xlsx", password = "pass")
all(iris == xl.iris) # Shoud be TRUE
unlink("iris.xlsx")


## End(Not run)
</code></pre>

<hr>
<h2 id='xl.sheet.add'>Basic operations with worksheets.</h2><span id='topic+xl.sheet.add'></span><span id='topic+xl.sheet.duplicate'></span><span id='topic+xl.sheet.name'></span><span id='topic+xl.sheet.visible'></span><span id='topic+xl.sheet.hide'></span><span id='topic+xl.sheet.show'></span><span id='topic+xl.sheets'></span><span id='topic+xl.sheet.activate'></span><span id='topic+xl.sheet.delete'></span>

<h3>Description</h3>

<p>Basic operations with worksheets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.sheet.add(xl.sheet.name = NULL, before = NULL)

xl.sheet.duplicate(before = NULL)

xl.sheet.name(xl.sheet.name = NULL)

xl.sheet.visible(xl.sheet)

xl.sheet.hide(xl.sheet = NULL)

xl.sheet.show(xl.sheet)

xl.sheets()

xl.sheet.activate(xl.sheet)

xl.sheet.delete(xl.sheet = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl.sheet.add_+3A_xl.sheet.name">xl.sheet.name</code></td>
<td>
<p>character. sheet name/new sheet name</p>
</td></tr>
<tr><td><code id="xl.sheet.add_+3A_before">before</code></td>
<td>
<p>character/numeric. sheet name or sheet number in active
workbook before which new sheet will be added</p>
</td></tr>
<tr><td><code id="xl.sheet.add_+3A_xl.sheet">xl.sheet</code></td>
<td>
<p>character/numeric. sheet name or sheet number in active
workbook</p>
</td></tr>
</table>


<h3>Details</h3>

 
<ul>
<li> <p><code>xl.sheet.add</code> adds new sheet with given name and invisibly 
returns name of this newly added sheet. Added sheet become active. If 
<code>xl.sheet.name</code> is missing default name will be used. If <code>before</code>
argument is missing, sheet will be added at the last position. If sheet with
given name already exists error will be generated.
</p>
</li>
<li> <p><code>xl.sheet.name</code> rename active sheet. If its argument is missing
then it just return active sheet name.
</p>
</li>
<li> <p><code>xl.sheet.hide</code>/<code>xl.sheet.show</code> hide and show sheet by its
name. <code>xl.sheet.visible</code> returns current visibility status of the
sheet.
</p>
</li>
<li> <p><code>xl.sheet.activate</code> activates sheet with given name/number. If 
sheet with this name doesn't exist error will be generated.
</p>
</li>
<li> <p><code>xl.sheet.delete</code> deletes sheet with given
name/number. If name doesn't submitted it delete active sheet.
</p>
</li></ul>



<h3>Value</h3>


<ul>
<li> <p><code>xl.sheet.add</code>/<code>xl.sheet.activate</code>/<code>xl.sheet.duplicate</code>
invisibly return name of created/activated/duplicated sheet.
</p>
</li>
<li> <p><code>xl.sheets</code> returns vector of sheet names in active workbook.
</p>
</li>
<li> <p><code>xl.sheet.delete</code> invisibly returns NULL.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+xl.workbooks">xl.workbooks</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:  
xl.workbook.add()
sheets = xl.sheets()
xl.sheet.add("Second")
xl.sheet.add("First", before="Second")
for (sheet in sheets) xl.sheet.delete(sheet) # only 'First' and 'Second' exist in workbook now
xl.sheet.activate("Second") #last sheet activated 
xl.sheet.duplicate() # duplicate second sheet
xl.sheet.name() # "Second (2)"
xl.sheet.name("Third") # "Third"


## End(Not run)
</code></pre>

<hr>
<h2 id='xl.workbook.add'>Basic operations with Excel workbooks</h2><span id='topic+xl.workbook.add'></span><span id='topic+xl.workbook.open'></span><span id='topic+xl.workbook.activate'></span><span id='topic+xl.workbooks'></span><span id='topic+xl.workbook.save'></span><span id='topic+xl.workbook.close'></span>

<h3>Description</h3>

<p>Basic operations with Excel workbooks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.workbook.add(filename = NULL)

xl.workbook.open(filename, password = NULL, write.res.password = NULL)

xl.workbook.activate(xl.workbook.name)

xl.workbooks(full.names = FALSE)

xl.workbook.save(
  filename,
  password = NULL,
  write.res.password = NULL,
  file.format = xl.constants$xlOpenXMLWorkbook
)

xl.workbook.close(xl.workbook.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl.workbook.add_+3A_filename">filename</code></td>
<td>
<p>character. Excel workbook filename.</p>
</td></tr>
<tr><td><code id="xl.workbook.add_+3A_password">password</code></td>
<td>
<p>character. Password for password-protected workbook.</p>
</td></tr>
<tr><td><code id="xl.workbook.add_+3A_write.res.password">write.res.password</code></td>
<td>
<p>character. Second password for editing workbook.</p>
</td></tr>
<tr><td><code id="xl.workbook.add_+3A_xl.workbook.name">xl.workbook.name</code></td>
<td>
<p>character. Excel workbook name.</p>
</td></tr>
<tr><td><code id="xl.workbook.add_+3A_full.names">full.names</code></td>
<td>
<p>logical. Should we return full path to the workbook? FALSE,
by default.</p>
</td></tr>
<tr><td><code id="xl.workbook.add_+3A_file.format">file.format</code></td>
<td>
<p>integer. Excel file format. By default it is
<code>xl.constants$xlOpenXMLWorkbook</code>. You can use
<code>xl.constants$xlOpenXMLWorkbookMacroEnabled</code> for workbooks with macros
(*.xlsm) or <code>xl.constants$xlExcel12</code> for binary workbook (.xlsb).</p>
</td></tr>
</table>


<h3>Details</h3>

 
<ul>
<li> <p><code>xl.workbook.add</code> adds new workbook and
invisibly returns name of this newly created workbook. Added workbook become
active. If <code>filename</code> argument is provided then Excel workbook
<code>filename</code> will be used as template. 
</p>
</li>
<li> <p><code>xl.workbook.activate</code> activates workbook with given name. If
workbook with this name doesn't exist error will be generated. 
</p>
</li>
<li> <p><code>xl.workbook.save</code> saves active workbook. If only
<code>filename</code> submitted it saves in the working directory. If name of
workbook is omitted than new workbook is saved under its default name in the
current working directory. It doesn't prompt about overwriting if file
already exists.
</p>
</li>
<li> <p><code>xl.workbook.close</code> closes workbook with given
name. If name isn't submitted it closed active workbook.  It doesn't prompt
about saving so if you don't save changes before closing all changes will be
lost. 
</p>
</li></ul>



<h3>Value</h3>

 
<ul>
<li> <p><code>xl.workbook.add</code>/<code>xl.workbook.open</code>/<code>xl.workbook.activate</code>
invisibly return name of created/open/activated workbook. 
</p>
</li>
<li> <p><code>xl.workbooks</code> returns character vector of open workbooks. 
</p>
</li>
<li> <p><code>xl.workbook.save</code> invisibly returns path to the saved workbook.
</p>
</li>
<li> <p><code>xl.workbook.close</code> invisibly returns NULL.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+xl.sheets">xl.sheets</a></code>, <code><a href="#topic+xl.read.file">xl.read.file</a></code>, 
<code><a href="#topic+xl.save.file">xl.save.file</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## senseless actions
data(iris)
data(cars)
xl.workbook.add()
xlrc[a1] = iris
xl.workbook.save("iris.xlsx")
xl.workbook.add()
xlrc[a1] = cars
xl.workbook.save("cars.xlsx")
xl.workbook.activate("iris")
xl.workbook.close("cars")
xl.workbook.open("cars.xlsx")
xl.workbooks()
for (wb in xl.workbooks()) xl.workbook.close(wb)
unlink("iris.xlsx")
unlink("cars.xlsx")

# password-protected workbook
data(iris) 
xl.workbook.add()
xlrc[a1] = iris
xl.workbook.save("iris.xlsx", password = "my_password")
xl.workbook.close()
xl.workbook.open("iris.xlsx", password = "my_password")
xl.workbook.close()
unlink("iris.xlsx")

## End(Not run)
</code></pre>

<hr>
<h2 id='xl.write'>Methods for writing data to Excel sheet</h2><span id='topic+xl.write'></span><span id='topic+xl.write.current.graphics'></span><span id='topic+xl.write.list'></span><span id='topic+xl.write.matrix'></span><span id='topic+xl.write.data.frame'></span><span id='topic+xl.write.default'></span>

<h3>Description</h3>

<p>Methods for writing data to Excel sheet
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xl.write(r.obj, xl.rng, na = "", ...)

## S3 method for class 'current.graphics'
xl.write(r.obj, xl.rng, na = "", delete.file = FALSE, ...)

## S3 method for class 'list'
xl.write(r.obj, xl.rng, na = "", ...)

## S3 method for class 'matrix'
xl.write(r.obj, xl.rng, na = "", row.names = TRUE, col.names = TRUE, ...)

## S3 method for class 'data.frame'
xl.write(r.obj, xl.rng, na = "", row.names = TRUE, col.names = TRUE, ...)

## Default S3 method:
xl.write(r.obj, xl.rng, na = "", row.names = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xl.write_+3A_r.obj">r.obj</code></td>
<td>
<p>R object</p>
</td></tr>
<tr><td><code id="xl.write_+3A_xl.rng">xl.rng</code></td>
<td>
<p>An object of class <code>COMIDispatch</code> (as used in RDCOMClient 
package) - reference to Excel range</p>
</td></tr>
<tr><td><code id="xl.write_+3A_na">na</code></td>
<td>
<p>character. NA representation in Excel. By default it is empty string</p>
</td></tr>
<tr><td><code id="xl.write_+3A_...">...</code></td>
<td>
<p>arguments for further processing</p>
</td></tr>
<tr><td><code id="xl.write_+3A_delete.file">delete.file</code></td>
<td>
<p>a logical value indicating whether delete file with 
graphics after insertion in Excel</p>
</td></tr>
<tr><td><code id="xl.write_+3A_row.names">row.names</code></td>
<td>
<p>a logical value indicating whether the row names/vector 
names of r.obj should to be written along with r.obj</p>
</td></tr>
<tr><td><code id="xl.write_+3A_col.names">col.names</code></td>
<td>
<p>a logical value indicating whether the column names of r.obj
should to be written along with r.obj</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>xl.rng</code> should be COM-reference to Excel range, not string. Method 
invisibly returns number of columns and rows occupied by <code>r.obj</code> on
Excel sheet. It's useful for multiple objects writing to prevent their
overlapping. It is more convenient to use <code>xl</code> object. <code>xl.write</code>
aimed mostly for programming purposes, not for interactive usage.
</p>


<h3>Value</h3>

<p>c(rows,columns) Invisibly returns rows and columns number ocuppied by
<code>r.obj</code> on Excel sheet.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xl">xl</a></code>,
<code><a href="#topic+xlr">xlr</a></code>, <code><a href="#topic+xlc">xlc</a></code>, <code><a href="#topic+xlrc">xlrc</a></code>, 
<code><a href="#topic+current.graphics">current.graphics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
xls = xl.get.excel()
xl.workbook.add()
rng = xls[["Activesheet"]]$Cells(1,1)
nxt = xl.write(iris,rng,row.names = TRUE,col.names = TRUE)
rng = rng$Offset(nxt[1] + 1,0)
nxt = xl.write(cars,rng,row.names = TRUE,col.names = TRUE)
rng = rng$Offset(nxt[1] + 1,0)
nxt = xl.write(as.data.frame(Titanic),rng,row.names = TRUE,col.names = TRUE)

data(iris)
data(cars)
data(Titanic)
xl.sheet.add()
rng = xls[["Activesheet"]]$Cells(1,1)
data.sets = list("Iris dataset",iris,
     "Cars dataset",cars,
     "Titanic dataset",as.data.frame(Titanic))
xl.write(data.sets,rng,row.names = TRUE,col.names = TRUE)


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
