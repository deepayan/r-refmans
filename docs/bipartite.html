<!DOCTYPE html><html lang="en"><head><title>Help for package bipartite</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bipartite}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bipartite-package'>
<p>Analysis of bipartite ecological webs</p></a></li>
<li><a href='#array2linkmx'><p>Reshape a webarray to a web X link matrix</p></a></li>
<li><a href='#as.one.mode'><p>Conversion of a network matrix</p></a></li>
<li><a href='#as.tnet'><p> Ensures that networks conform to the tnet stardards</p></a></li>
<li><a href='#barrett1987'><p>Individuals caught in a pollination web in boreal Canada.</p></a></li>
<li><a href='#betalinkr'>
<p>Calculate network dissimilarity (beta diversity) and its components</p></a></li>
<li><a href='#betweenness_w'><p> Betweenness centrality in a weighted network</p></a></li>
<li><a href='#bezerra2009'><p>Individuals observed in a flower-visitation network of oil-collecting bees in a Brazilian steppe.</p></a></li>
<li><a href='#C.score'><p> Calculates the (normalised) mean number of checkerboard combinations (C-score) in a matrix</p></a></li>
<li><a href='#closeness_w'><p> Closeness centrality in a weighted network</p></a></li>
<li><a href='#clustering_tm'><p> Redefined clustering coefficient for two-mode networks</p></a></li>
<li><a href='#compart'><p>Detects compartments</p></a></li>
<li><a href='#computeModules'><p>computeModules</p></a></li>
<li><a href='#czvalues'><p>Computes c and z for network modules</p></a></li>
<li><a href='#decimalr2dtable'><p> Generates matrix with same marginal totals for non-negative decimal values</p></a></li>
<li><a href='#degreedistr'><p>Fits functions to cumulative degree distributions of both trophic levels of a network.</p></a></li>
<li><a href='#dfun'><p>Calculates standardised specialisation index d' (d prime) for each species in the lower trophic level of a bipartite network.</p></a></li>
<li><a href='#DIRT_LPA_wb_plus'><p>Functions &quot;LPA_wb_plus&quot; and &quot;DIRT_LPA_wb_plus&quot;</p></a></li>
<li><a href='#discrepancy'><p> Calculates discrepancy of a matrix</p></a></li>
<li><a href='#distance_w'><p> Distance in a weighted network</p></a></li>
<li><a href='#elberling1999'><p> No. of visits in a pollination web of arctic-alpine Sweden</p></a></li>
<li><a href='#empty'><p>Deletes empty rows and columns from a matrix.</p></a></li>
<li><a href='#endpoint'><p>Computes end-point degrees for a bipartite network</p></a></li>
<li><a href='#extinction'><p> Simulates extinction of a species from a bipartite network</p></a></li>
<li><a href='#fc'><p>Calculates the functional complementarity for the rows of a web</p></a></li>
<li><a href='#frame2webs'><p>Converts a table of observations into a network matrix</p></a></li>
<li><a href='#genweb'><p> Generate a random bipartite web</p></a></li>
<li><a href='#grouplevel'><p>Analysis of bipartite webs at the level of each of the two levels (groups) of the network</p></a></li>
<li><a href='#H2fun'><p> Specialisation of a bipartite web.</p></a></li>
<li><a href='#inouye1988'><p> A pollination network from the Snowy Mountains of New South Wales, Australia</p></a></li>
<li><a href='#junker2013'>
<p>Flower visitation network</p></a></li>
<li><a href='#kato1990'><p> No. of individuals caught in a pollination web of a Japanese beech forest</p></a></li>
<li><a href='#kevan1970'><p> A pollination network from Northern Ellesmere Island, Canada</p></a></li>
<li><a href='#linklevel'><p>Indices of a bipartite network at the link level</p></a></li>
<li><a href='#listModuleInformation'><p>listModuleInformation</p></a></li>
<li><a href='#memmott1999'><p> Flower visitation network from a meadow near Bristol, UK</p></a></li>
<li><a href='#mgen'><p>Generate simulated network according to a given probability matrix</p></a></li>
<li><a href='#moduleWeb-class'><p>Class &quot;moduleWeb&quot;</p></a></li>
<li><a href='#mosquin1967'><p> Flower visitation network from Melville Island, Northwest Territories, Canada</p></a></li>
<li><a href='#motten1982'><p>A spring flower visitation network from North Carolina, USA</p></a></li>
<li><a href='#ND'><p>Normalised degree, betweenness and closeness centrality</p></a></li>
<li><a href='#nest.smdm'><p> Computes nestedness of a matrix as WNODA (and NODF and WNODF)</p></a></li>
<li><a href='#nested'>
<p>Calculates any of several measures of nestedness</p></a></li>
<li><a href='#nestedcontribution'>
<p>Calculates the per-species contribution to nestedness (z-score relative to null model)</p></a></li>
<li><a href='#nestedness'><p>Calculates nestedness temperature of presence/absence matrices</p></a></li>
<li><a href='#nestedrank'>
<p>Calculates the rank of a species in a matrix sorted for maximum nestedness</p></a></li>
<li><a href='#networklevel'><p>Analysis of bipartite webs at the level of the entire network</p></a></li>
<li><a href='#nodespec'><p>Calculates the node-based specialisation index</p></a></li>
<li><a href='#NOS'><p>Calculates the node overlap and separation according to Strona &amp; Veech (2015)</p></a></li>
<li><a href='#npartite'><p>Computes indices for a masked-one-mode network</p></a></li>
<li><a href='#null.distr'><p> Null model based on fitted marginal distribution</p></a></li>
<li><a href='#null.t.test'><p>Compares observed pattern to random webs.</p></a></li>
<li><a href='#nullmodel'><p>Generates null models for network analysis</p></a></li>
<li><a href='#olesen2002aigrettes'><p> A flower visitation network from the Azores</p></a></li>
<li><a href='#olesen2002flores'><p> Another flower visitation network from the Azores</p></a></li>
<li><a href='#olito2015'><p> A pollination network from the Canadian Rockies</p></a></li>
<li><a href='#ollerton2003'><p>ollerton2003</p></a></li>
<li><a href='#PAC'><p>Potential for Apparent Competition</p></a></li>
<li><a href='#PDI'><p>Paired Differences Index</p></a></li>
<li><a href='#plotmatrix'><p> Plot a matrix organised by topology</p></a></li>
<li><a href='#plotModuleWeb'><p>plotModuleWeb</p></a></li>
<li><a href='#plotPAC'>
<p>Function to draw a circular plot to visualise potential apparent competition (PAC)</p></a></li>
<li><a href='#plotweb'><p>Visualize a bipartite interaction matrix (e.g. a foodweb)</p></a></li>
<li><a href='#plotweb2'><p>Visualize a tripartite interaction matrix (e.g. a tritrophic foodweb)</p></a></li>
<li><a href='#printoutModuleInformation'><p>printoutModuleInformation</p></a></li>
<li><a href='#projecting_tm'><p> Projecting binary and weighted two-mode networks onto weighted one-mode networks.</p></a></li>
<li><a href='#r2dexternal'><p>Generates null models for network analysis by considering external abundances</p></a></li>
<li><a href='#restrictednull'><p>The restricted null model accounting for modules with nested entries</p></a></li>
<li><a href='#robustness'><p> Robustness to species extinctions</p></a></li>
<li><a href='#Safariland'><p> A pollination web from Argentina</p></a></li>
<li><a href='#schemske1978'><p> A flower visitation network from Urbana, IL, USA</p></a></li>
<li><a href='#second.extinct'><p>Secondary extinctions in bipartite networks</p></a></li>
<li><a href='#shuffle.web'><p> Shuffle web entries</p></a></li>
<li><a href='#slope.bipartite'><p>Slope of extinction simulation</p></a></li>
<li><a href='#small1976'><p> A flower visitation network from a peat bog in Ottawa, Canada</p></a></li>
<li><a href='#sortmatrix'><p> Organise matrix by topology</p></a></li>
<li><a href='#sortweb'><p> Function to sort bipartite webs</p></a></li>
<li><a href='#specieslevel'><p>Calculate various indices for network properties at the species level</p></a></li>
<li><a href='#spectral.radius'><p>Calculates the spectral radius as a nestedness measurement of a bipartite matrix, possibly with regard to mass action</p></a></li>
<li><a href='#strength'><p>Computes species strength according to either of two definitions</p></a></li>
<li><a href='#swap.web'><p> Creates null model for bipartite networks</p></a></li>
<li><a href='#symmetrise_w'><p> Symmetrise_w</p></a></li>
<li><a href='#tnet_igraph'><p> Exports a tnet network to an igraph object</p></a></li>
<li><a href='#togetherness'><p> Calculates the number of identical co-presences and co-absences for species-on-islands</p></a></li>
<li><a href='#V.ratio'><p> Calculates the variance-ratio as suggested by Schluter (1984)</p></a></li>
<li><a href='#vazarr'><p> A pollination network.</p></a></li>
<li><a href='#vazcer'><p>A pollination network.</p></a></li>
<li><a href='#vazllao'><p>A pollination network.</p></a></li>
<li><a href='#vazmasc'><p>A pollination network.</p></a></li>
<li><a href='#vazmasnc'><p>A pollination network.</p></a></li>
<li><a href='#vaznull'><p> Null model with constrained connectance and moderately constrained marginal totals</p></a></li>
<li><a href='#vazquec'><p>A pollination network.</p></a></li>
<li><a href='#vazquenc'><p>A pollination network.</p></a></li>
<li><a href='#vazquez.example'><p> Examples for some analyses</p></a></li>
<li><a href='#versionlog'><p>Log of bipartite versions and changes</p></a></li>
<li><a href='#visweb'><p> Plotting function to visualize a bipartite food web</p></a></li>
<li><a href='#web2edges'><p>Conversion of a network matrix into a (weighted) edge list</p></a></li>
<li><a href='#webs2array'><p>Puts two or more webs into one array of webs</p></a></li>
<li><a href='#wine'>
<p>Weighted-Interaction Nestedness Estimator</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualising Bipartite Networks and Calculating Some (Ecological)
Indices</td>
</tr>
<tr>
<td>Version:</td>
<td>2.21</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Carsten F. Dormann
    <a href="https://orcid.org/0000-0002-9835-1794"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Jochen Fruend <a href="https://orcid.org/0000-0002-7079-3478"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Bernd Gruber <a href="https://orcid.org/0000-0003-0078-8179"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Tobias Bauer <a href="https://orcid.org/0009-0008-0026-722X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Stephen Beckett <a href="https://orcid.org/0000-0002-4410-2960"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Mariano Devoto <a href="https://orcid.org/0000-0003-3098-236X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Gabriel M.F. Felix
    <a href="https://orcid.org/0000-0002-3901-4333"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Jose M. Iriondo <a href="https://orcid.org/0000-0003-2710-3889"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Tore Opsahl <a href="https://orcid.org/0000-0003-0346-8082"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Rafael B.P. Pinheiro
    <a href="https://orcid.org/0000-0003-2342-8483"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Rouven Strauss [ctb],
  Diego P. Vazquez <a href="https://orcid.org/0000-0002-3449-5748"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0), sna, vegan</td>
</tr>
<tr>
<td>Imports:</td>
<td>corpcor, fields, igraph, MASS, methods, permute</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, utils</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/biometry/bipartite">https://github.com/biometry/bipartite</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to visualise webs and calculate a series of indices commonly used to describe pattern in (ecological) webs. It focuses on webs consisting of only two levels (bipartite), e.g. pollination webs or predator-prey-webs. Visualisation is important to get an idea of what we are actually looking at, while the indices summarise different aspects of the web's topology. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-20 15:22:11 UTC; carsten</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-20 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bipartite-package'>
Analysis of bipartite ecological webs
</h2><span id='topic+bipartite-package'></span><span id='topic+bipartite'></span>

<h3>Description</h3>

<p>Bipartite provides functions to visualise webs and calculate a series of indices commonly used to describe pattern in (ecological) networks, a.k.a. webs. It focusses on webs consisting of only two levels, e.g. pollinator-visitation or predator-prey webs. Visualisation is important to get an idea of what we are actually looking at, while the indices summarise different aspects of the webs topology.</p>


<h3>Details</h3>

<p>Note: We only had three types of bipartite webs in mind when starting this package: seed-disperser, plant-pollinator and host-parasitoid systems. In how far it makes sense to use these functionalities for other systems (or indeed even for these systems) lies in the hands of the user. Please refer to the literature cited for details on the theory behind the indices.
</p>
<p>Networks can be either binary (0/1 or FALSE/TRUE matrices) or quantitative (matrices containing estimates of pairwise interaction strength, usually assumed here to be interaction frequency).
</p>
<p>Input for most analyses is an interaction matrix of m nodes (= species) from one group (&ldquo;higher&rdquo;) with n nodes (= species) from another group (&ldquo;lower&rdquo;), i.e. a n x m matrix, where higher level nodes are in columns, lower level nodes in rows. Column and row names can be provided. This is fundamentally different from &ldquo;one-mode&rdquo; networks, which are organised as k x k matrix, i.e. one group of nodes only, in which each node can link (= interact) with each other. Such a format is incompatible with the functions we provide here. (Note, however, that functions <code><a href="#topic+as.one.mode">as.one.mode</a></code> and <code><a href="#topic+web2edges">web2edges</a></code> are convenience functions to morph bipartite networks into one-mode webs. Furthermore, some indices build on one-mode networks and <em>are</em> called from bipartite.)
</p>
<p>Before you start with the network, you have to get the data into the right shape. The function <code><a href="#topic+frame2webs">frame2webs</a></code> aims to facilitate this process. Arranging a web, e.g. by size, is supported by <code><a href="#topic+sortweb">sortweb</a></code>.
</p>
<p>The typical first step is to <b>visualise</b> the network. Two functions are on offer here: one (<code><a href="#topic+visweb">visweb</a></code>) simply plots the matrix in colours depicting the strength of an interaction and options for re-arranging columns and rows (e.g. to identify compartments or nesting). The other function (<code><a href="#topic+plotweb">plotweb</a></code>) plots the actual web with participants (as two rows of rectangles) connected by lines (proportional to interaction strength). Both can be customised by many options.
</p>
<p>The second step is to <b>calculate indices</b> describing network topography. There are <b>three</b> different levels this can be achieved at: the entire web (using function <code><a href="#topic+networklevel">networklevel</a></code>), at the level of each group (also using function <code><a href="#topic+networklevel">networklevel</a></code>) or the individual node (= species; thus somewhat inconsistently called <code><a href="#topic+specieslevel">specieslevel</a></code>). Most other functions in the package are helpers, although some can be called on their own and return the respective result (<code><a href="#topic+dfun">dfun</a></code>, <code><a href="#topic+H2fun">H2fun</a></code> and <code><a href="#topic+second.extinct">second.extinct</a></code> with <code><a href="#topic+slope.bipartite">slope.bipartite</a></code>).
</p>
<p>The third step is to <b>compare results to null models</b>. Many interaction matrices are very incomplete snapshots of the true underlying network (e.g. a one-week sampling of a pollination network on a patch of 4 x 4 meters). As a consequence, many species were rarely observed, many are singletons (only one recording). To make analyses comparable across networks with different sampling intensity and number of species per group, we need a common yardstick. We suggest that users should use a null model, i.e. an algorithm that randomises entries while constraining some web properties (such as dimensions, marginal totals or connectance). The function <code><a href="#topic+nullmodel">nullmodel</a></code> provides a few such null models, but this is a wide field of research and we make no recommendations (actually, we do: see Dormann et al. 2009 and Dormann 2011, both shipping in the doc-folder of this package). You can also simulate networks using <code><a href="#topic+genweb">genweb</a></code> or <code><a href="#topic+null.distr">null.distr</a></code>.
</p>
<p>Finally, bipartite comes with 23 quantitative pollination network data sets taken from the NCEAS interaction webs data base (use <code>data(package="bipartite")</code> to show their names) and it has a few miscellaneous functions looking at some special features of bipartite networks (such as modularity: <code><a href="#topic+computeModules">computeModules</a></code> or potential for apparent competition: <code><a href="#topic+PAC">PAC</a></code>).
</p>
<p>See help pages and vignette for details and examples.
</p>
<p>For an overview of other computing resources, data, books, journals etc. check out this page: <a href="https://github.com/briatte/awesome-network-analysis">https://github.com/briatte/awesome-network-analysis</a>.
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> bipartite</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.21</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2025-02-20</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>versionlog</h3>

<p>Please see help page <code><a href="#topic+versionlog">versionlog</a></code> for all changes and updates prior to version 2.00. This page will only list most recent changes. 
</p>

<ul>
<li><p> 2.21 (20-Feb-2025)
</p>

<dl>
<dt>Added new index &quot;spectral radius&quot;</dt><dd><p>to <code><a href="#topic+networklevel">networklevel</a></code>, as well as its own function (<code><a href="#topic+spectral.radius">spectral.radius</a></code>). It is just another way to compute nestedness of sorts. This function was contributed by Tobias Bauer!</p>
</dd>
<dt>Updated (i.e. speed-improved) <code><a href="#topic+frame2webs">frame2webs</a></code></dt><dd><p>to faster (or indeed at all) process all webs in a table. This code improvement was contributed by Tobias Bauer.</p>
</dd>
<dt>Code changes to <code><a href="#topic+as.one.mode">as.one.mode</a></code>.</dt><dd><p>Until version 2.21, projections to higher and lower level were based on reasoning what the correct weights should be from the perspective of an ecologist: If, say, species A and B interact with species a-z, then the link weight would be the sum of the minima of the two vectors A with a-z and B with a-z. In other words, the minimal overlap. In network science, the projection is defined differently, however, namely as the maximum! Thus, bringing <span class="pkg">bipartite</span>'s <code>as.one.mode</code> closer to common mathematical practice, we now use the proper definition as default. The old definition remains available by setting <span class="option">legacy=TRUE</span>. The new definition is: <code class="reqn">AA^T</code>, with diagonal set to 0. (Taken from both Thurner et al.'s 2018 and Wikipedia's entry on the Laplacian matrix).</p>
</dd>
</dl>

</li>
<li><p> 2.20 (19-May-2024)
</p>

<dl>
<dt>Code changes to</dt><dd><p><code><a href="#topic+plotweb">plotweb</a></code>,  <code><a href="#topic+plotweb2">plotweb2</a></code>, <code><a href="#topic+visweb">visweb</a></code> and  <code><a href="#topic+compart">compart</a></code> as well as the namespace, due to changes in the  <code>cca</code>-function in <span class="pkg">vegan</span>. Many thanks to Jari Oksanen (maintainer of vegan) to provide these patches!</p>
</dd>
<dt>Added new option <span class="option">effective</span> to <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>With this option, diversity, H2' and evenness indices are turned into &ldquo;effective&rdquo; diversity and evenness indices, by exponentiating them. It has been repeatedly argued that Shannon's H is ecologically difficult to interpret and should instead be exponentiated to yield the &ldquo;effective number of species, if all were equally abundant&rdquo; (e.g. Jost 2006). The same logic goes for evenness (Jost 2010) and, by extension, for H2'. Since H2' then becomes an index with data-dependent upper bound, rather than one on [0,1], this version may not fly. For diversity, exponentiating will yield the same values as indices &ldquo;vulnerability&rdquo; and &ldquo;generality&rdquo;, which is why we had removed that option from an earlier version (and now it's back). So largely this option is useful for &ldquo;interaction evenness&rdquo; and for experimenting.</p>
</dd> 
</dl>

</li>
<li><p> 2.19 (29-Nov-2023)
</p>

<dl>
<dt>Fixed missing <code>any</code> causing a problem when plotting modules,</dt><dd><p>reported by rubenroos and Celia Ferriol Gonzalez: many thanks!</p>
</dd>
<dt>When a matrix has more columns/rows than the sum of entries, <code><a href="#topic+r2dexternal">r2dexternal</a></code></dt><dd><p>will not work without external abundances. The fix is incomplete, as it is only applied to columns in the moment, and not to <code><a href="#topic+vaznullexternal">vaznullexternal</a></code> either. Thanks to Emilie Ellis for reporting!</p>
</dd>
<dt>Warning fix in internal function <code><a href="#topic+isCorrectModuleWebObject">isCorrectModuleWebObject</a></code>:</dt><dd><p>Incorrect testing of dimensions of modularity object. Thanks to Frazer Moore for reporting.</p>
</dd>
</dl>

</li>
<li><p> 2.18 (22-Oct-2022)
</p>

<dl>
<dt>Bug fix in <code><a href="#topic+robustness">robustness</a></code>:</dt><dd><p>For large matrices, the (too short) subdivision length and the possible non-zero starting values caused an error. Thanks to Rafael Pinheiro for reporting.</p>
</dd>
<dt>Small semantic</dt><dd><p>fixes newly picked up by sterner CRAN checks (e.g. non-UTF in comment; escaped ampersand in title).</p>
</dd>
</dl>

</li>
<li><p> 2.17 (release date: 12-Apr-2022)
</p>

<dl>
<dt>New null model for &quot;compound network structure&quot; using <code><a href="#topic+restrictednull">restrictednull</a></code>:</dt><dd><p>This function, contributed by Gabriel Felix, Rafael Pinheiro, and Marco Mello from the Ecological Synthesis Lab (SintECO) in São Paulo, constructs null model expectations for networks with modules. So far, nestedness could not be properly tested for <em>within</em> null model modules, only at the level of the entire network. This function uses information from previously identified modules (typically using <code><a href="#topic+computeModules">computeModules</a></code>) to generate expectations based on marginal totals and observed connectivity. It builds on <code><a href="#topic+vaznull">vaznull</a></code> in that respect, but adds the modular structure.</p>
</dd>
<dt>Major rehaul of <code><a href="#topic+mgen">mgen</a></code>:</dt><dd><p>1. the biggest change is that <span class="option">keep.species=TRUE</span> now respects the probabilities of the input web (before it had used marginal totals) already for the first interaction of each species, and tries to minimize the number of interactions assigned in this first part of the function. 2. the main part of the function has been changed, not using a while-loop anymore and thus dropping the argument <span class="option">trials</span>. 3. handling of <span class="option">autotransfrom</span> has been slightly changed, avoiding unnecessary warnings. 4. the output web now keeps dimnames of input web.</p>
</dd>
<dt>Slight changes to <code><a href="#topic+specieslevel">specieslevel</a></code>,</dt><dd><p>where the weighted betweenness values could be wrongly placed if the web contained compartments without indirect links. Thanks to Marco Mello for drawing our attention to this!</p>
</dd>
<dt><code><a href="#topic+computeModules">computeModules</a></code> used to remove</dt><dd><p>all-1 rows and columns in a binary network, as they contain no information on modules. However, this affects the modularity value. Now the function always keeps the full network. Note that all-0-values are still removed. Thanks to Elvira D'Bastiani for reporting this problem!</p>
</dd>
<dt>Substantial speed boost to <code><a href="#topic+vaznull">vaznull</a></code>,</dt><dd><p>thanks to an improvement suggested by Rafael Pinheiro!</p>
</dd>
<dt>Bug fix in <code><a href="#topic+webs2array">webs2array</a></code>,</dt><dd><p>which caused problems when called within another function.</p>
</dd>
<dt>Added index modularity (= Newman's Q) to <code><a href="#topic+networklevel">networklevel</a></code>.</dt><dd><p>No options are available, hence this value is the likelihood of the default setting of <code><a href="#topic+computeModules">computeModules</a></code>.</p>
</dd>
<dt>Bug fix in index PSI in <code><a href="#topic+specieslevel">specieslevel</a></code>,</dt><dd><p>where the beta-exponent was on the wrong matrix, and hence it did not yield species strength for beta=0.</p>
</dd>
<dt>Retired binmatnest as called by <code>nestedness</code>.</dt><dd><p>Binmatnest was one of the first nice nestedness algorithms, implemented in C++. It has been kept merely for historical reasons, as <span class="pkg">vegan</span>'s <code><a href="vegan.html#topic+nestedtemp">nestedtemp</a></code> is more reliable. We finally decided to kick binmatnest out, using this function as legacy-call to <code><a href="vegan.html#topic+nestedtemp">nestedtemp</a></code> and leaving the legacy help page. (Also makes package maintenance a bit easier: one C++ function less to think about.)</p>
</dd>
<dt>Added text-option to <code><a href="#topic+plotPAC">plotPAC</a></code>.</dt><dd><p>Species names have a tendency to always be in the way, and too long. Therefore the original function only plotted numbers. Now we added the option to plot (and scale and move) labels for each species. Not nice, but practical.</p>
</dd>
<dt>Function <code><a href="#topic+networklevel">networklevel</a></code> now</dt><dd><p>calls <span class="pkg">vegan</span>'s <code><a href="vegan.html#topic+nesteddisc">nesteddisc</a></code> when computing the index &quot;discrepancy&quot;. That function tries to handle ties in the data consistently, although for webs with many columns (or rows) with the same number of links this will still lead to slightly different values. Thanks to Valentin Stefan for drawing our attention to this! Also, we added an explicit note of this behaviour in <code>networklevel</code>.</p>
</dd>
<dt>Bug fix in <code><a href="#topic+r2dexternal">r2dexternal</a></code> and <code><a href="#topic+vaznullexternal">vaznullexternal</a></code>:</dt><dd><p>Sometimes did not yield the correct row/column sums, when margins were extremely skewed.</p>
</dd>
<dt>Addressed long-standing confusion in <code><a href="#topic+nested">nested</a></code>,</dt><dd><p> which reports some indices in [0,1], others in [0, 100] (i.e. as percent). Thanks to Jari Oksanen for reminding me of this point. All but one now report in the 0-100% range. While fixing this, also added WNODA (based on <code><a href="#topic+nest.smdm">nest.smdm</a></code>) to the fray.</p>
</dd>
</dl>

</li>
<li><p> 2.16 (release date: 08-Jan-2021)
</p>

<dl>
<dt>Bug fix in <code><a href="#topic+H2fun">H2fun</a></code>:</dt><dd><p>threw an error when <span class="option">H2_integer=TRUE</span>. Thanks to mxdub for finding and fixing this! (Sorry that I managed to click on &ldquo;comment and close&rdquo; before &ldquo;confirm accept merg&rdquo;; this github interaction is still somewhat new to me.)</p>
</dd>
<dt>Bug fix in <code><a href="#topic+betalinkr">betalinkr</a></code>:</dt><dd><p>Now standardization to proportions also works for empty webs as division by zero is avoided. 2. <code>specmx.higher.unique</code> can now be assessed even for 1-link-networks, as setting <span class="option">drop=FALSE</span> keeps the dimensions of the matrix. Thanks to Benjamin Schwarz for providing these fixes! (And don't ask me why the pull request on github does not show.)</p>
</dd>
<dt>Added multicolour-option to <span class="option">arrow.col</span> in <code><a href="#topic+plotPAC">plotPAC</a></code>,</dt><dd><p>following a question by Horacio Silva. We can now colour each arrow of the plot individually, although the sequence of colours provided may require some fiddling around.</p>
</dd>
</dl>
	
</li>
<li><p> 2.15 (release date: 04-Apr-2020)
</p>

<dl>
<dt>A pair of new functions for plotting: <code><a href="#topic+sortmatrix">sortmatrix</a></code> and <code><a href="#topic+plotmatrix">plotmatrix</a></code>,</dt><dd><p>both provided by Rafael Pinheiro and Gabriel Felix from the University of Campinas in Brazil. The functions' scope is to plot interaction networks of nested, modular and mixed topology (Pinheiro et al. 2019). As plotting is not the forte of bipartite so far, and these two functions help to add a bit of plotting facilities. Many thanks for contributing!</p>
</dd>
<dt>Bug fix in <code><a href="#topic+robustness">robustness</a></code>:</dt><dd><p>in my previous updates of the discontinued <code>class</code>-issues I managed to omit a crucial &ldquo;!&rdquo; in the code. Thanks to Hanlun Liu and Felix Neff for reporting!</p>
</dd>
<dt>Bug fix in <code><a href="#topic+extinction">extinction</a></code>:</dt><dd><p>for sparse networks, the function sometimes returned a vector rather than a matrix, due to incorrectly dropping a dimension. Thanks to Felix Neff for reporting and providing the solution!</p>
</dd>
<dt>Expanded help of <code><a href="#topic+as.one.mode">as.one.mode</a></code>:</dt><dd><p>in particular the way the weights were computed was not documented at all, as pointed out by Lennart Dittmer. This is now rectified and also the R-code now features in-line comments as to what is happening at each step.</p>
</dd>
</dl>
	
</li>
<li><p> 2.14 (release date: 07-Jan-2020)
</p>

<dl>
<dt>Updates</dt><dd><p>of <code><a href="#topic+betalinkr">betalinkr</a></code>-options.</p>
</dd>
<dt>Future R-version 4.x.x</dt><dd><p>requires discontinuation of <code>class(x) == "y"</code>-like code (rather using <code>is(x, "y")</code> or <code>inherits(x, "y")</code>). Updated accordingly.</p>
</dd>
<dt>C++-style changes</dt><dd><p>requiring identifyModules-Arguments to be labelled slightly differently. Impossible to check without setting up a linux chain, but still reason for CRAN not to accept.</p>
</dd> 
</dl>

</li>
<li><p> 2.13 (release date: 21-May-2019)
</p>

<dl>
<dt>Several small fixes,</dt><dd><p>e.g. check for binary networks in <code><a href="#topic+nullmodel">nullmodel</a></code> failed if values &lt; 1 were in the matrix.</p>
</dd>
<dt>Added a lengthy vignette,</dt><dd><p>illustrating the use of the package.</p>
</dd>
<dt>(Small) bug fix in <code><a href="#topic+empty">empty</a></code>:</dt><dd><p>something was stupidly wrong for matrices of only one row or column. Spotted by Benjamin Schwarz, thanks!</p>
</dd>
<dt>New function <code><a href="#topic+vaznullexternal">vaznullexternal</a></code>,</dt><dd><p>as wished by Matt Funaki. This is the &ldquo;normal&rdquo; <code><a href="#topic+vaznull">vaznull</a></code>-nullmodel, but now external abundances for either or both groups can be provided. Modelled on <code><a href="#topic+r2dexternal">r2dexternal</a></code>.</p>
</dd>
<dt>Important bug fix and new option in <code><a href="#topic+webs2array">webs2array</a></code>:</dt><dd><p>name indexing was wrong, so that entries were entered in wrong cells. Also, the function now also accepts a weblist as input.</p>
</dd>
<dt>New function <code><a href="#topic+betalinkr">betalinkr</a></code>:</dt><dd><p>it allows comparison of networks and partitioning of network dissimilarity. Based on betalink package/paper by Tim Poisot, but more integrated into the bipartite package, and importantly implements many more features and corrected partitioning approaches. Two more new functions come with it: <code><a href="#topic+array2linkmx">array2linkmx</a></code>, <code><a href="#topic+betalinkr_multi">betalinkr_multi</a></code>.</p>
</dd>
<dt>New function <code><a href="#topic+decimalr2dtable">decimalr2dtable</a></code>:</dt><dd><p>it allows to simulate matrices with the same marginal totals as the input, but for non-negative, non-integer inputs. Doing so, it &ldquo;smears&rdquo; out the entries over the entire matrix and will hence be meaningless for any index comparison which responds to matrix filling. An attempt to deal with webs composed of rates rather than observed interactions. Useful probably only in a very few cases, as marginal totals are unlikely to be interpretable as abundance-activity, and hence implying a very different kind of null model to <code><a href="#topic+nullmodel">nullmodel</a></code>s.</p>
</dd>
</dl>

</li>
<li><p> 2.12 (release date: 11-Mar-2019)
</p>

<dl>
<dt>New function <code><a href="#topic+nest.smdm">nest.smdm</a></code></dt><dd><p>by Rafael Pinheiro, Gabriel Felix, Marco Mello, and the team of the Ecological Synthesis Lab, University of São Paulo, which computes the nestedness measure NODF (as present in <span class="pkg">vegan</span>) more flexibly, by allowing the matrix to be sorted not only by number of filled cells (think: binary networks), but also by absolute marginal totals. NODF does not work for completely filled matrices, but this version (called NODA) does. Also, <code><a href="#topic+nest.smdm">nest.smdm</a></code> compute nesting within modules, if module identities are provided (e.g. by <code><a href="#topic+computeModules">computeModules</a></code> and the new little helper function <code><a href="#topic+module2constraints">module2constraints</a></code>). All these metrics are computed for binary or weighted networks.</p>
</dd>
<dt>Function <code><a href="#topic+NOS">NOS</a></code></dt><dd><p>yields NA when one or more nodes are 0. The original equation allows an alternative way to compute NOS, which has been implemented by tchen98: many thanks!</p>
</dd>
</dl>

</li>
<li><p> 2.11 (relase date: 12-Jul-2018)
</p>

<dl>
<dt>Change of defaults in <code><a href="#topic+metaComputeModules">metaComputeModules</a></code></dt><dd><p>, from <span class="option">DormannStrauss</span> to <span class="option">Beckett</span>. Beckett's algorithm is far less variable in its performance, thus I assumed that one would not actually need <code><a href="#topic+metaComputeModules">metaComputeModules</a></code> for it at all. However, also <span class="option">Beckett</span> is not foolproof and benefits from a few re-runs with different starting configurations. Now defaults are consistent with <code><a href="#topic+computeModules">computeModules</a></code>. Thanks to Laura Burkle for raising the issue.</p>
</dd>
<dt>Bug fix in <code><a href="#topic+nested">nested</a></code></dt><dd><p>, which didn't correctly pass through the <span class="option">normalised</span>-argument for index &quot;C score&quot;. Also the naming of &quot;C score&quot; (rather than previously &quot;C.score&quot;) was changed for consistency with <code><a href="#topic+networklevel">networklevel</a></code>. Many thanks to Carlos Zamora-Manzur for reporting!</p>
</dd>
<dt>Deprecation of the command <code>register</code> in C++17</dt><dd><p>required attention in the <code>MersenneTwister.h</code>-code used in <code>computeModules</code>. Thanks to Brian Ripley, for the R Core Team, for notifying all maintainers using this command in advance of future CRAN-submission problems!</p>
</dd>
</dl>

</li>
<li><p> 2.10 (release date: 20-Dec-2017)
</p>

<dl>
<dt>Removed option <span class="option">weighted</span></dt><dd><p>from <code><a href="#topic+CC">CC</a></code>, which had no effect on the way <code>sna::closeness</code> computes the value. Thanks to Thais Zanata for making me aware of this!</p>
</dd>
<dt>Fixed bug in option <span class="option">rescaled</span></dt><dd><p>of <code><a href="#topic+CC">CC</a></code>, which did not properly rescale values so that they sum to 1. Thanks to Thais Zanata for making me aware of this!</p>
</dd>
<dt>Added NODF</dt><dd><p>to the indices available in <code><a href="#topic+networklevel">networklevel</a></code>.</p>
</dd>
<dt>Added network of Olito &amp; Fox (2015)</dt><dd><p>as <code>olito2015</code>; data from dryad (URL given in help page).</p>
</dd>
</dl>

</li>
<li><p> 2.09 (release date: 30-Jun-2017)	
</p>

<dl>
<dt>Fixed type of object returned by <code><a href="#topic+computeModules">computeModules</a></code>,</dt><dd><p>when using <span class="option">method="DormannStrauss"</span>, which I had broken after changing the default. Many thanks to Abdul Shakoor for reporting. Also added an error catcher to exclude, from binary webs, species that interact with every other species (i.e. are all 1; all-0 were already excluded).</p>
</dd>
<dt>Fixed imprecise explanation in <code><a href="#topic+plotweb">plotweb</a></code>'s</dt><dd><p><span class="option">low/high.spacing</span>, which now correctly describes its effect on the horizontal space within a level. (Thanks to Jeff Ollerton for reporting.)</p>
</dd>
</dl>

</li>
<li><p> 2.08 (release date: 30-Mar-2017)	
</p>

<dl>
<dt>New modularity algorithm called by <code><a href="#topic+computeModules">computeModules</a></code>.</dt><dd><p>Although the excellent algorithm <code><a href="#topic+DIRT_LPA_wb_plus">DIRT_LPA_wb_plus</a></code> by Stephen Beckett has been around for a year, I never managed to find the time to put it into bipartite. By now, Stephen has even written a wrapper code so that the output is fully compatible with existing code for plotting (<code><a href="#topic+plotModuleWeb">plotModuleWeb</a></code>) there was really no argument left to postpone it. Stephen's DIRT_LPA_wb_plus will be the new default, replacing 'QuanBiMo', which remains available under <span class="option">method='DormannStrauss'</span>. While DIRT could be called recursively, thereby making modules-within-modules computable, this is not packaged yet. So currently the much slower DormannStrauss-option is the only way to get recursive modules. Many thanks to Stephen for making this code available!</p>
</dd>
<dt><code><a href="#topic+networklevel">networklevel</a></code> and <code><a href="#topic+grouplevel">grouplevel</a></code> inconsistently</dt><dd><p>returned different values for secondary extinction, because the former by default purged empty columns/rows, while the latter didn't. It does now. Thanks to Gianalberto Losapio for bringing this to my attention.</p>
</dd>
</dl>

</li>
<li><p> 2.07 (release date: 08-Nov-2016)
</p>
 
<dl>
<dt>Bug fixed in <code><a href="#topic+vaznull">vaznull</a></code>,</dt><dd><p> filled the matrix with 1s instead of 0s (although it was a &lsquo;sophisticated&rsquo; logical mistake I made, not a simple typo). Thanks to Sandra Bibiana Corea for reporting! </p>
</dd>
<dt>Small patch in C++-code of binmatnest</dt><dd><p> for compatibility with clang. Thanks to Brian Ripley for fixing one of these C++-things that I never will understand! (In this case, the original code (by Miguel Rodríguez-Gironés) defined a pointer to &quot;vector&quot;, which caused ambiguities in which &quot;vector&quot; should be used during compilation: the such defined pointer, or the std::vector.)</p>
</dd>
<dt>Smaller typographic</dt><dd><p> and referencing corrections/additions (e.g. in plotPAC).</p>
</dd> 
</dl>
 
</li>
<li><p> 2.06b (release date: 10-May-2016)
</p>
 
<dl>
<dt>Some explanation addded to <code><a href="#topic+czvalues">czvalues</a></code>,</dt><dd><p> where a z-value of NA is returned if a species is alone (in its trophic level) in a module. This is due to the way z-values are computed, and not a bug.</p>
</dd>
<dt>Function <code><a href="#topic+nestedcontribution">nestedcontribution</a></code></dt><dd><p>was not exported in the namespace. Fixed. Thanks to various people reporting this.</p>
</dd>	
</dl>
 
</li>
<li><p> 2.06 (release date: 29-Sep-2015)
</p>
 
<dl>
<dt>Bug fix in <code><a href="#topic+C.score">C.score</a></code>,</dt><dd><p> which did not compute the maximum number of possible checkerboards correctly, and hence let the normalised C-score to be incorrect. Now it uses a brute-force approach, which works fine but takes its time.</p>
</dd>	
<dt>Function <code><a href="#topic+nestedcontribution">nestedcontribution</a></code></dt><dd><p>was not exported (i.e. not listed in the namespace file). Fixed. Thanks to Wesley Dátillo for reporting.</p>
</dd>
<dt>Help page of <code><a href="#topic+specieslevel">specieslevel</a></code></dt><dd><p>now correctly described a species' degree as sum of its links. Thanks to Bernhard Hoiß for the correction!</p>
</dd>
<dt>C++-warnings addressed:</dt><dd><p>outcommented some unused variables in dendro.h and removed some fprintf-warnings in bmn5.cc</p>
</dd>
<dt>Little bug fix in <code><a href="#topic+vaznull">vaznull</a></code>:</dt><dd><p>Threw an error when matrix was without 0s. Thanks to Thais Zanata for reporting.</p>
</dd>
</dl>
 
</li>
<li><p> 2.05 (release date: 24-Nov-2014)
</p>
 
<dl>
<dt>New function <code><a href="#topic+nestedcontribution">nestedcontribution</a></code></dt><dd><p>which computes the contribution of each species to the overall nestedness, based on Bascompte et al. 2003 and as used by Saavedra et al. 2011. Many thanks to Daniel Stouffer for contributing this function!</p>
</dd>	
<dt>New function <code><a href="#topic+mgen">mgen</a></code>:</dt><dd><p>this function is based on R-code written by Diego Vázquez (many thanks for sending the code), with a bit of brushing up options by CFD. The function takes a probability matrix generated by whatever mechanism and builds a null model from it. This is a niffty little idea, making null modelling concerned with generating ideas on what makes an interaction probable and leaving the step of producing and integer-network of simulated interactions to this function.</p>
</dd>
<dt>minor fixes in <code><a href="#topic+networklevel">networklevel</a></code></dt><dd><p>&ldquo;weighted connectance&rdquo; was only returned when &ldquo;linkage density&rdquo; was in &ldquo;index&rdquo; call; now also available on its own. Also sligthly revised the help file.</p>
</dd>
<dt><code><a href="#topic+nested">nested</a></code> with option <span class="option">weighted NODF</span> called the unsorted version of this function,</dt><dd><p>while calling the same index in <code><a href="#topic+networklevel">networklevel</a></code> called the sorted. This is not nice (although not strictly wrong). Now both call the sorted version and users have to directly invoke <code>nestednodf</code> for the unsorted option. Many thanks to Julian Resasco for reporting!</p>
</dd>
<dt>Changes to the help page of <code><a href="#topic+vaznull">vaznull</a></code>:</dt><dd><p>I (CFD) misread the original paper introducing this null model and hence assumed that<code><a href="#topic+vaznull">vaznull</a></code> would constrain marginal totals <b>and</b> connectance. However, this was not intended in Diego Vázquez original implementation and never stated anywhere (except in the help pages of this function here in bipartite). Hence, the help pages were changed to now reflect both intention and actual action of this function. This also means that currently only one null model with constrained marginal totals <b>and</b> connectance is available: <code><a href="#topic+swap.web">swap.web</a></code>. Many thanks to Diego for clearing this up!</p>
</dd>
<dt>Some example code had to be re-written</dt><dd><p>to adapt to the upcoming/new structure of <span class="pkg">vegan</span>, which got rid of function <code>commsimulator</code> (replaced by <code>simulate</code>). Many thanks to Jari Oksanen for informing me about this!</p>
</dd>
<dt>Added an error message</dt><dd><p>to function <code><a href="#topic+second.extinct">second.extinct</a></code> for the case that a user wants to provide an extinction sequence for both trophic levels. There is no obvious way to simulate this across the two groups, and hence it is not implemented. Also added error messages for non-matching vector/web dimensions and alike.</p>
</dd>
</dl>
 
</li>
<li><p> 2.04 (release date: 25-Mar-2014)
</p>
 
<dl>
<dt>R-C++-communication bug fixed in <code><a href="#topic+computeModules">computeModules</a></code>:</dt><dd><p>This bug has been a constant thorn in my side. Somehow the C-code behind <code>computeModules</code> could only be called once. On second call, it returned an error because somehow it kept some old files in memory. So far, I used a work-around (unloading and re-loading the dynamic library), which only worked on Windows and Mac. I still don't fully understand it, but thanks to Tobias Hegemann (whom I paid for being more competent than myself) we now have a function running bug-free on all platforms. (Deep sigh of relief.)</p>
</dd>
<dt>The call of index &ldquo;functional complementarity&rdquo; through <code><a href="#topic+networklevel">networklevel</a></code> did not work.</dt><dd><p>Fixed this legacy issue, which was due to a confusion created by the index' earlier name of &ldquo;functional diversity&rdquo;.</p>
</dd>
<dt>Help page to <code><a href="#topic+specieslevel">specieslevel</a></code> gave incomplete name for one index:</dt><dd><p>Should be <span class="option">interaction push pull</span>; also the function itself had the &ldquo;push pull&rdquo;-bit messed up. Thanks to Natacha Chacoff for reporting!</p>
</dd>
<dt>Sequence of indices differed between lower and higher level. (Fixed.)</dt><dd><p>Both should be the same and should fit the description in the help file. Thanks to Jimmy O'Donnell for reporting!</p>
</dd>
</dl>
 
</li>
<li><p> 2.03 (release date: 15-Jan-2014)
</p>
 
<dl>
<dt>Some ghost text led to conflicts with the updated package checking.</dt><dd><p>Ghost text deleted. Thanks to Brian Ripley of the R-Team and CRAN for not only reporting the issue but also pointing to its solution!</p>
</dd>
<dt>Option <span class="option">empty.web</span> added to <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>Similar to the argument in <code><a href="#topic+networklevel">networklevel</a></code>; non-interacting species from the network were always excluded so far; new option <span class="option">FALSE</span> not fully tested yet.</p>
</dd>
<dt>Minor bug fix in <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p> &ldquo;pollination support index&rdquo; returned &ldquo;PSI&rdquo;; &ldquo;PDI&rdquo; now referenced correctly as &ldquo;paired differences index&rdquo;.</p>
</dd>
<dt>Simplification in <code><a href="#topic+grouplevel">grouplevel</a></code> and correspondingly in <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>Previously, <code>index="generality"</code> or <code>"vulnerability"</code> was identical to <code>"effective partners"</code> with option <code>weighted=TRUE</code>, but different for <code>weighted=FALSE</code> (to which only <code>"effective partners"</code> responded). We reduced this to one index called &quot;generality&quot; or &quot;vulnerability&quot; (depending on the focal group), but which will now give the non-weighted mean if option <code>weighted=FALSE</code>. It can still be called by &quot;effective partners&quot; for backward compatibility.</p>
</dd>
<dt>Function <code><a href="#topic+grouplevel">grouplevel</a></code> used <code>fd</code> wrongly!</dt><dd><p>Instead of returning the value for rows, it returned the functional diversity for columns (and vice versa). We also used the opportunity to rename the index to its correct name: &ldquo;functional complementarity&rdquo; and the function to <code><a href="#topic+fc">fc</a></code>. Help pages for <code><a href="#topic+fc">fc</a></code> and <code><a href="#topic+grouplevel">grouplevel</a></code> were adapted accordingly. Thanks to Mariano Devoto for pointing out this mistake!</p>
</dd>
<dt>New index &ldquo;weighted connectance&rdquo; in function <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>This index is simply computed as linkage density divided by number of species in the network. Note that using <span class="option">empty.web=TRUE</span> will affect this value (which is intended). Thanks to Becky Morris for suggesting to add this index here.</p>
</dd>
<dt>Help page for function <code><a href="#topic+PDI">PDI</a></code> corrected.</dt><dd><p>Thanks to Timothy Poisot for reporting some issues in the help page.</p>
</dd>
</dl>
 
</li>
<li><p> 2.02 (release date: 30-Sep-2013)
</p>
 
<dl>
<dt>Glitch fixed in <code><a href="#topic+grouplevel">grouplevel</a></code> (thus also affecting <code>networklevel</code>).</dt><dd><p>Networks with only one species in one of the two levels resulted in errors, rather than simply return NA for C-score and secondary extinction computation. Thanks to whoever it was for reporting (at the INTECOL workshop).</p>
</dd>
<dt>Minor bug fixes in  <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>Gave error messages for closeness and betweenness if the network had no shortest path. Now returns a warning and NAs instead. Reported: JF.</p>
</dd>
<dt>Minor bux fix in  <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>Failed to work when an index was listed twice in the function call. Reported: JF.</p>
</dd>
<dt>New function <code><a href="#topic+r2dexternal">r2dexternal</a></code>:</dt><dd><p>This function is a null model algorithm like Patefields (<code>r2dtable</code>, but it excepts externally measured abundances to compute the null model-expectation. Experimental.</p>
</dd>
<dt>Memory leak in <code><a href="#topic+computeModules">computeModules</a></code> fixed.</dt><dd><p>Because some object was not deleted, memory consumption of this function shot through the roof (with time). Since R has a somewhat weird way of handling memory, I think that also subsequent operations were slower (because the dynamically expanded memory is not being shrunken again, which is a problem if you use the hard drive as RAM). Thanks to Florian Hartig for investing the time to fix it!</p>
</dd>
</dl>
 
</li>
<li><p> 2.01 (release date: 28-Jun-2013)
This release features smoothing of various glitches that were introduced when we cleaned up the code for version 2.00.
</p>
 
<dl>
<dt>New index for <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>Computes the nestedness rank (as proposed by Alarcon et al. 2008). Can also be employed directly using the <b>new function</b> <code><a href="#topic+nestedrank">nestedrank</a></code> with options for weighting for number of interactions per link, normalising the rank and different method to compute the nestedness-arranged matrix.</p>
</dd>
<dt>Polishing <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>Now returns an error message if the index is not recognised, instead of an empty list.</p>
</dd>
<dt>Function <code><a href="#topic+plotweb">plotweb</a></code></dt><dd><p>received an option to plot additional individuals of a species in different ways. For a host-parasitoid network, some hosts are not parasitised. This data vector can now be interpreted in two ways, making the plotting function a bit more flexible.</p>
</dd> 
<dt>Function <code><a href="#topic+degreedistr">degreedistr</a></code></dt><dd><p>can now be invoked for each level separately. Also arguments can be passed to the plotting options.</p>
</dd>
<dt>New data set <code><a href="#topic+junker2013">junker2013</a></code>:</dt><dd><p>a nice and large pollination network. Thanks to Robert Junker for providing this data set!</p>
</dd>
<dt>Fixed computation of secondary extinction slopes for both levels simultaneously</dt><dd><p>for random extinction sequences. This was so far not possible, because the function did not combine extinction sequences of different lengths. This was simply an oversight, reported by Richard Lance. (Thanks!)</p>
</dd>
</dl>
 
</li>
<li><p> 2.00 (release date: 15-Mar-2013)
A new version number usually indicates substantial changes. In this case, we have re-named and re-grouped some of the output of <code><a href="#topic+networklevel">networklevel</a></code> and <code><a href="#topic+specieslevel">specieslevel</a></code> for greater consistency and transparency. Beware! Running the same functions now (2.00 and up) will yield different results to &lt;2.00 (because the same values are now in a different sequence).
</p>
<p>We also started carefully renaming indices and re-writing help files. The main reason is that we started this work thinking of pollination networks. Over time, however, other types of ecological networks came into focus, and now also non-ecological networks are on the table. Thus, we started (and shall continue) referring to lower and higher levels, rather than plant and pollinators, hosts and predators or even trophic levels. Thus, in our emerging nomenclature the two levels are referred to as &ldquo;groups&rdquo; (their members remain &ldquo;species&rdquo; interacting with their &ldquo;partners&rdquo; in the other group). 
</p>
<p>Please read (or at least skim) the help pages before using a function of version 2.00 for the first time. 
</p>
<p>In function <code><a href="#topic+specieslevel">specieslevel</a></code> indices can now be computed for levels separately (or together). Few user-visible changes, but complete re-structuring under the hood. Option <span class="option">species number</span> was moved to <code><a href="#topic+grouplevel">grouplevel</a></code> as <span class="option">number of species</span>.
</p>
<p>In the new function <code><a href="#topic+grouplevel">grouplevel</a></code> we collected all indices that can be computed for each of the two groups (i.e. trophic or other levels). Indices can be computed for each group separately or for both simultaneously. All group-level indices are also accessible through <code><a href="#topic+networklevel">networklevel</a></code>!
</p>
<p>In the new function <code><a href="#topic+linklevel">linklevel</a></code> we collected all indices that can be computed for each cell of the bipartite matrix. Currently, there are few such indices, however.
</p>
<p>In function <code><a href="#topic+networklevel">networklevel</a></code> we dropped the plotting options. Users wanting to plot degree distributions or extinction slopes are encouraged to use the functions <code><a href="#topic+degreedistr">degreedistr</a></code> and <code><a href="#topic+slope.bipartite">slope.bipartite</a></code>, respectively.
</p>
<p>Furthermore, due to licensing issues, we copy-pasted several functions from the package <b>tnet</b>, created and maintained by Tore Opsahl, to bipartite. We have so far called these functions from tnet, but only recently did R start to enforce license compatibility, which caused this step (bipartite being GPL and tnet being CC by-NC 3.0). We are really very grateful to Tore for allowing us to include the following functions: <code><a href="#topic+as.tnet">as.tnet</a></code>, <code><a href="#topic+betweenness_w">betweenness_w</a></code>, <code><a href="#topic+closeness_w">closeness_w</a></code>, <code><a href="#topic+clustering_tm">clustering_tm</a></code>, <code><a href="#topic+distance_w">distance_w</a></code>, <code><a href="#topic+symmetrise_w">symmetrise_w</a></code>, <code><a href="#topic+tnet_igraph">tnet_igraph</a></code>.
</p>
<p>Here a more detailed list of changes:
</p>

<dl>
<dt><code><a href="#topic+networklevel">networklevel</a></code></dt><dd>

<ul>
<li><p> Function call and output now more consistent in naming and sequence. When higher and lower level indices are given (e.g. extinction slopes, number of shared partners), the first will always be the one referring to the property of the <em>lower</em> level. From a pollinator network perspective, the first value in such a pair describes a plant-level index, the second a pollinator-level index.
</p>
</li>
<li><p> Indices <span class="option">mean interaction diversity</span> dropped from <code><a href="#topic+networklevel">networklevel</a></code>. We found no reference to this metric and saw little use for it. It is very similar to vulnerability/generality and can easily be computed from the output of <code><a href="#topic+specieslevel">specieslevel</a></code> as <code>mean(specieslevel(web, index="diversity"))</code>.
</p>
</li>
<li><p>  Now also accepts non-integer values as input. The argument <span class="option">H2_integer</span> will then automatically be set to FALSE. Will return NA for those indices that cannot be computed (e.g. Fisher's alpha). As a knock-on effect, <code><a href="#topic+H2fun">H2fun</a></code> had to be slightly adapted to round to machine precision when searching for H2min. (A somewhat technical detail, but making <code>H2fun</code> getting caught sometimes.)
</p>
</li></ul>
 
</dd>
<dt>New function <code><a href="#topic+grouplevel">grouplevel</a></code></dt><dd><p>in which we collected indices that can be computed for each of the two groups (i.e. trophic or other levels). Indices can be computed for each group separately or for both simultaneously. All group-level indices are also accessible through <code><a href="#topic+networklevel">networklevel</a></code>!</p>
</dd>
<dt>New function <code><a href="#topic+linklevel">linklevel</a></code></dt><dd><p>in which we collect indices that can be computed for each cell of the bipartite matrix.</p>
</dd>
<dt>New option to <code><a href="#topic+PDI">PDI</a></code>:</dt><dd><p><span class="option">normalise=FALSE</span> offers the option of using the index as originally proposed, although we prefer to use TRUE and made this the default. </p>
</dd>
<dt>Corrected network <code><a href="#topic+bezerra2009">bezerra2009</a></code>.</dt><dd><p>Network was actually the transpose of the correct network and hence wrongly had plant species as columns.</p>
</dd>
<dt>New function <code><a href="#topic+endpoint">endpoint</a></code></dt><dd><p>computes end-point degrees following Barrat et al. (2004); one of the indices computed at <code><a href="#topic+linklevel">linklevel</a></code>.</p>
</dd>
<dt>New function <code><a href="#topic+frame2webs">frame2webs</a></code></dt><dd><p>helps organising data into one or more webs.</p>
</dd>
<dt>New function <code><a href="#topic+webs2array">webs2array</a></code></dt><dd><p>helps organising webs into one array.</p>
</dd>
<dt>Function <code><a href="#topic+specieslevel">specieslevel</a></code></dt><dd><p>gained two new indices (thanks to Jochen Fründ): <span class="option">proportional</span> <span class="option">similarity</span> and <span class="option">proportional generality</span>. See help page of that function for details.</p>
</dd>
<dt>New function <code><a href="#topic+npartite">npartite</a></code></dt><dd><p>Experimental function to analyse more-than-2-level networks.</p>
</dd>
<dt><code><a href="#topic+visweb">visweb</a></code></dt><dd><p>now obeys the label size to make sure labels are always in the plotting area. Thanks to Zachary Grinspan 
for drawing our attention to this issue.</p>
</dd>
<dt>Little bug fix in <code><a href="#topic+second.extinct">second.extinct</a></code></dt><dd><p>Function failed for argument <span class="option">participant="both"</span> because I filled the extinction sequence with the wrong number of 0s (to achieve always the same dimensionality of results in repeated runs). Thanks to Carine Emer for reporting!</p>
</dd>
<dt><code><a href="#topic+specieslevel">specieslevel</a></code></dt><dd><p>failed to work for non-matrix data (i.e. <code>data.frames</code>). It now coerces <code>data.frames</code> to <code>matrix</code> as a first step and hence should work also on <code>data.frame</code>s. Thanks to Marina Wolowski for drawing our attention to this problem.</p>
</dd>
<dt>Minor bug fix in <code><a href="#topic+dfun">dfun</a></code>:</dt><dd><p>When external abundances were provided with a 0 in it, <code>dfun</code> could throw up <code>Inf</code>-values. Reported by Indrani Singh and fixed by Jochen Fründ.</p>
</dd>
<dt>Settings for functions called by <code><a href="#topic+nested">nested</a></code></dt><dd><p>are now enshrined in stone. The initial reason was to set only the default for one function (<code><a href="#topic+nestedness">nestedness</a></code>) to a faster setting (<span class="option">null.models=FALSE</span>), but then I decided to restrict all settings to the defaults of the functions called (except for this one option).</p>
</dd>
<dt>Bug fix for the rarely used function <code><a href="#topic+null.t.test">null.t.test</a></code>:</dt><dd><p>Did not work if only one index was given.</p>
</dd>
</dl>
 
</li></ul>
 


<h3>Author(s)</h3>

<p>Carsten F. Dormann, Jochen Fründ and Bernd Gruber, with additional code from many others (referred to in the respective help file), noticeably from Tore Opsahl's tnet package.
</p>
<p>Maintainer: Carsten Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a>
</p>


<h3>References</h3>

<p>Alarcon, R., Waser, N.M. and Ollerton, J. 2008. Year-to-year variation in the topology of a plant-pollinator interaction network. <em>Oikos</em> <b>117</b>, 1796&ndash;1807
</p>
<p>Almeida-Neto, M. and Ulrich, W. (2011) A straightforward computational approach for measuring nestedness using quantitative matrices. <em>Environmental Modelling &amp; Software</em>, <b>26</b>, 173&ndash;178
</p>
<p>Bascompte, J., Jordano, P. and Olesen, J. M. (2006) Asymmetric coevolutionary networks facilitate biodiversity maintenance. <em>Science</em> <b>312</b>, 431&ndash;433
</p>
<p>Beckett, S.J. 2016. Improved community detection in weighted bipartite networks. <em>Royal Society open science</em> <b>3</b>, 140536
</p>
<p>Bersier, L. F., Banasek-Richter, C. and Cattin, M. F. (2002) Quantitative descriptors of food-web matrices. <em>Ecology</em> <b>83</b>, 2394&ndash;2407
</p>
<p>Blüthgen, N., Menzel, F. and Blüthgen, N. (2006) Measuring specialization in species interaction networks. <em>BMC Ecology</em> <b>6</b>, 12
</p>
<p>Blüthgen, N., Menzel, F., Hovestadt, T., Fiala, B. and Blüthgen, N. (2007) Specialization, constraints, and conflicting interests in mutualistic networks. <em>Current Biology</em> <b>17</b>, 1&ndash;6
</p>
<p>Corso G., de Araújo A.I.L. and de Almeida A.M. (2008) A new nestedness estimator in community networks. <em>arXiv</em>, 0803.0007v1 [physics.bio-ph]
</p>
<p>Dalsgaard, B., A. M. Martín González, J. M. Olesen, A. Timmermann, L. H. Andersen, and J. Ollerton. (2008) Pollination networks and functional specialization: a test using Lesser Antillean plant-hummingbird assemblages. <em>Oikos</em> <b>117</b>, 789&ndash;793
</p>
<p>Devoto M., Bailey S., Craze P. &amp; Memmott J. (2012) Understanding and planning ecological restoration of plant-pollinator networks.
<em>Ecology Letters</em> <b>15</b>, 319&ndash;328
</p>
<p>Dormann, C.F., Fründ, J., Blüthgen, N., and Gruber, B. (2009) Indices, graphs and null models: analysing bipartite ecological networks. <em>The Open Ecology Journal</em> <b>2</b>, 7&ndash;24
</p>
<p>Dormann, C.F. (2011) How to be a specialist? Quantifying specialisation in pollination networks. <em>Network Biology</em> <b>1</b>, 1&ndash;20
</p>
<p>Galeano J., Pastor J.M. and Iriondo J.M. (2008) Weighted-Interaction Nestedness Estimator (WINE): A new estimator to calculate over frequency matrices. <em>arXiv</em> 0808.3397v1 [physics.bio-ph]
</p>
<p>Jost, L. (2006). Entropy and diversity. <em>Oikos</em>, <b>113</b>, 363–375. https://doi.org/10.1111/j.2006.0030-1299.14714.x
</p>
<p>Jost, L. (2010). The relation between evenness and diversity. <em>Diversity</em>, <b>2</b>, Article 2. https://doi.org/10.3390/d2020207
</p>
<p>Martín Gonzáles, A.M., Dalsgaard, B. and Olesen, J.M. (2009) Centrality measures and the importance of generalist species in pollination networks. <em>Ecological Complexity</em>, <b>7</b>, 36&ndash;43
</p>
<p>Memmott, J., Waser, N. M. and Price, M. V. (2004) Tolerance of pollination networks to species extinctions. <em>Proceedings of the Royal Society B</em> <b>271</b>, 2605&ndash;2611
</p>
<p>Morris, R. J., Lewis, O. T. and Godfray, H. C. J. (2004) Experimental evidence for apparent competition in a tropical forest food web. <em>Nature</em> <b>428</b>, 310&ndash;313
</p>
<p>Morris, R. J., Lewis, O. T. and Godfray, H. C. J. (2005) Apparent competition and insect community structure: towards a spatial perspective. <em>Annales Zoologica Fennici</em> <b>42</b>, 449&ndash;462.
</p>
<p>Müller, C. B., Adriaanse, I. C. T., Belshaw, R. and Godfray, H. C. J. (1999) The structure of an aphid-parasitoid community. <em>Journal of Animal Ecology</em> <b>68</b>, 346&ndash;370
</p>
<p>Pinheiro, R.B.P. et al. 2019. A new model explaining the origin of different topologies in interaction networks. <em>Ecology</em> <b>100</b>, 1&ndash;30
</p>
<p>Poisot, T., Lepennetier, G., Martinez, E., Ramsayer, J., and Hochberg, M.E. (2011a) Resource availability affects the structure of a natural bacteria-bacteriophage community. <em>Biology Letters</em> <b>7</b>, 201&ndash;204
</p>
<p>Poisot, T., Bever, J.D., Nemri, A., Thrall, P.H., and Hochberg, M.E. (2011b) A conceptual framework for the evolution of ecological specialisation. <em>Ecology Letters</em> <b>14</b>, 841&ndash;851
</p>
<p>Thurner, S., Hanel, R. and Klimek, P. (2018) Introduction to the Theory of Complex Systems. Oxford University Press, Oxford
</p>
<p>Tylianakis, J. M., Tscharntke, T. and Lewis, O. T. (2007) Habitat modification alters the structure of tropical host-parasitoid food webs. <em>Nature</em> <b>445</b>, 202&ndash;205
</p>
<p>Vázquez, D. P. and Aizen, M. A. (2004) Asymmetric specialization: A pervasive feature of plant-pollinator interactions. <em>Ecology</em> <b>85</b>, 1251&ndash;1257
</p>
<p>Vázquez, D.P., Chacoff, N.,P. and  Cagnolo, L. (2009) Evaluating multiple determinants of the structure of plant-animal mutualistic networks. <em>Ecology</em> <b>90</b>, 2039&ndash;2046.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Safariland)
plotweb(Safariland)
visweb(Safariland)
networklevel(Safariland)
specieslevel(Safariland)

## End(Not run)
</code></pre>

<hr>
<h2 id='array2linkmx'>Reshape a webarray to a web X link matrix</h2><span id='topic+array2linkmx'></span>

<h3>Description</h3>

<p>Function to turn an array with sites as third dimension into a web by link matrix (e.g. sites X links). This is the &quot;link community matrix&quot; to use for dissimilarity calculations. Mostly just a helper function for <code>betalinkr</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>array2linkmx(webarray)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="array2linkmx_+3A_webarray">webarray</code></td>
<td>
<p>An array of two or more networks. Assumes the third dimension is the webID in the array, which will become the first dimension in the link-matrix (output).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function converts the two-dimensional adjacency matrices (i.e., bipartite webs) to one-dimensional vectors (similar to what network people call &ldquo;edgelists&rdquo;). These vectors become rows of a matrix (which has one row per web). This makes the data available to community ecology methods, e.g. those offered by the <code>vegan</code> package. Links are treated equivalently to species in a &ldquo;normal&rdquo; community analysis (note that it makes no difference whether one or both partner of an interaction differ, in both cases the link has a different identity). The function is used here mostly as a helper for interaction dissimilarity calculations with <code>betalinkr</code>.
</p>
<p><code>dimnames</code> are optional but recommended for the webarray. Names of the third dimension will become rownames in the output. Colnames (i.e. names of links) will be created from dimnames[[1]] (&ldquo;lower species&rdquo;) and dimnames[[2]] (&ldquo;higher species&rdquo;), separated by &ldquo;__&rdquo; (double underscore).
</p>


<h3>Value</h3>

<p>A matrix with one row per web and one column per link (i.e. per combination of lower and higher species). All-zero columns may often be included.</p>


<h3>Author(s)</h3>

<p> Jochen Fründ</p>


<h3>Examples</h3>

<pre><code class='language-R'>array2linkmx(webs2array(Safariland, vazquenc))
</code></pre>

<hr>
<h2 id='as.one.mode'>Conversion of a network matrix</h2><span id='topic+as.one.mode'></span>

<h3>Description</h3>

<p>This helper function converts a bipartite matrix into a one-mode matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.one.mode(web, fill = 0, project="full", weighted=TRUE, legacy=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.one.mode_+3A_web">web</code></td>
<td>
<p>A matrix with lower trophic level species as rows, higher trophic level species 
as columns and number of interactions as entries.</p>
</td></tr>
<tr><td><code id="as.one.mode_+3A_fill">fill</code></td>
<td>
<p>What shall unobserved combinations be represented as in the one-mode matrix (see below)? Defaults to 0. Set to NA if links not possible for bipartite networks should be masked (i.e. those within a level).</p>
</td></tr>
<tr><td><code id="as.one.mode_+3A_project">project</code></td>
<td>
<p>There are different ways to convert a two-mode (bipartite) network into one-mode networks. The most common is to focus on one set (e.g. the n pollinators) and compute a n x n matrix with entries between species that pollinate the same plant (<span class="option">"higher""</span>). Similarly, one can compute a k x k matrix for the k plant species (<span class="option">"lower"</span>). Or, finally and the default, one can compute an (n+k) x (n+k) matrix in which only the observed interactions are present (<span class="option">"full"</span>). This is in fact a near-trivial, symmetric matrix with 0s between species of the same trophic level.</p>
</td></tr>
<tr><td><code id="as.one.mode_+3A_weighted">weighted</code></td>
<td>
<p>Logical; shall the strength of links be included in the one-mode output? Defaults to TRUE, but can be set to FALSE to turn a weighted two-mode into a binary one-mode network.</p>
</td></tr>
<tr><td><code id="as.one.mode_+3A_legacy">legacy</code></td>
<td>
<p>Logical, set to FALSE by default. Until version 2.21, projections to either higher or lower were based on reasoning what the correct weights should be from the perspective of an ecologist: If, say, species A and B interact with species a-z, then the link weight would be the sum of the minima of the two vectors A with a-z and B with a-z. In other words, the minimal overlap. In network science, the projection is defined differently, however, namely as the maximum! Thus, bringing <span class="pkg">bipartite</span>'s <code>as.one.mode</code> closer to common practice, we now use the proper definition as default. The old definition remains available by setting <span class="option">legacy=TRUE</span>. The new definition is: <code class="reqn">AA^T-\textrm{diag}(A)</code>, follwing Thurner et al. (2018, p. 149).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In bipartite (or: two-mode) networks, participants are of different types (e.g. pollinators and plants, actors and parties in social research). Hence, a party cannot connect to another party except through actors. A pollinator interacts with another pollinator only through the host plant.
</p>
<p>Much network theory, however, is based on one-mode networks, where all participants are listed in one vector, i.e. plants and pollinators alike, actors together with events. This function here transforms the more condensed bipartite representation into a one-mode-representation, filling the unobserved type of interactions (i.e. plants with plants and pollinators with pollinators) with 0 (unless you specify it differently in <span class="option">fill</span>).
</p>
<p>The lower trophic level (e.g. plants or rows) is listed first, then the higher trophic level (e.g. pollinators or columns). Hence, pollinator 2 becomes species number r+2, where r is the number of rows of the network matrix.
</p>
<p>In addition to the &quot;full&quot; projection, there are &quot;inner&quot; projections, yielding a network <b>only</b> of the lower or higher level (hence the argument <span class="option">project="lower"/"higher"/"full"</span>). Such an inner projection inevitably loses information: if two pollinators pollinate three plant species, then they are connected in such a projection through 3 links. The weight of each link will be different, but in the projection only one weight can be given. This is where the information is lost. Several indices (betweenness, centrality) depend on one-mode projections of this kind. Still, the user should always ask herself, whether the projection might not have unintended consequences!
</p>
<p>If <span class="option">weighted=TRUE</span>, then the returned one-mode network contains the parallel maximum (or minimum, if <span class="option">legacy=TRUE</span>) of the observed interactions between two species. That means, if two species A and B interact with species 1 to 5 in the other group, then the two interaction vectors for A with 1 to 5 and B with 1 to 5 are placed next to each other, and for every species 1 to 5 the maximum for each of these 5 values for the two vectors is retained (the parallel maximum). The idea is that the similarity between A and B is driven by their largest communality in interactions. Next, the five parallel maximal values are added to yield the final weight for this link.
</p>
<p>The benefit of this conversion is access to the wonderful R-package Social Network Analysis (<span class="pkg">sna</span>), with its many one-mode indices (such as <code>betweenness</code>, <code>closeness</code>, <code>centralization</code>, <code>degree</code>, <code>kpath.census</code> and so forth). Furthermore, <code>gplot</code> in that package also provides cool network depictions well worth checking out.
</p>
<p>With respect to <span class="pkg">bipartite</span>, <code>as.one.mode</code> is employed in the function <code><a href="#topic+nodespec">nodespec</a></code>, which itself uses the <span class="pkg">sna</span>-function <code>geodist</code>.
</p>


<h3>Value</h3>

<p>A matrix of dimension (n+k) x (n+k), where n and k are the dimensions of the input web. Both dimensions are given the names of the original web (first the lower, then the higher trophic level).
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a> </p>


<h3>References</h3>

<p>Thurner, S., Hanel, R. and Klimek, P. (2018) Introduction to the Theory of Complex Systems. Oxford University Press, Oxford
</p>


<h3>See Also</h3>

<p>Function <code>projecting_tm</code> in package <span class="pkg">tnet</span> provide an analogous ways of converting two-modes into one-modes. This function can be accessed after transforming the web-matrix into an edge list using <code><a href="#topic+web2edges">web2edges</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
image(Safariland)
image(as.one.mode(Safariland))
par(xpd=TRUE, mar=c(0, 6, 0, 6))
gplot(as.one.mode(Safariland, project="lower"), 
	label=rownames(Safariland), gmode="graph", 
	label.cex=0.6, vertex.cex=2, vertex.col="green")
</code></pre>

<hr>
<h2 id='as.tnet'> Ensures that networks conform to the tnet stardards </h2><span id='topic+as.tnet'></span>

<h3>Description</h3>

<p>Checks that a network conforms to the tnet stardards, and attaches a label. If the type parameter is not set, the network is assumed to be a binary two-mode network, a weighted one-mode network, or a longitudinal network if there are 2, 3, or 4 columns respectively. Moreover, if a matrix is entered (more than 4 columns and rows), it is assumed to be a weighted one-mode network if square or a two-mode network if non-square.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.tnet(net, type=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.tnet_+3A_net">net</code></td>
<td>
<p>A network in an edgelist or matrix format. It can be a weighted one-mode network, a binary two-mode network, a weighted two-mode netork, or a longitudinal network. If the data-object has two-columns, it is assumed to be a binary two-mode network; three columns, weighted one-mode network; four columns, longitudinal; five or more and the same number of rows and columns, weighted one-mode network; five or more and &ndash;not&ndash; the same number of rows and columns, it is assumed to be a two-mode network. </p>
</td></tr>
<tr><td><code id="as.tnet_+3A_type">type</code></td>
<td>
<p>If you would like to specify the type of network. This could be &ldquo;weighted one-mode tnet&rdquo;, &ldquo;binary two-mode tnet&rdquo;, &ldquo;weighted two-mode tnet&rdquo;, or &ldquo;longitudinal tnet&rdquo;. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the network with an attached label.</p>


<h3>Note</h3>

<p> version 1.0.0, taken, with permission, from package tnet  </p>


<h3>Author(s)</h3>

<p> Tore Opsahl; <a href="https://toreopsahl.com">https://toreopsahl.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load sample data
sample &lt;- rbind(
c(1,2,4),
c(1,3,2),
c(2,1,4),
c(2,3,4),
c(2,4,1),
c(2,5,2),
c(3,1,2),
c(3,2,4),
c(4,2,1),
c(5,2,2),
c(5,6,1),
c(6,5,1))

## Run the programme
as.tnet(sample)

</code></pre>

<hr>
<h2 id='barrett1987'>Individuals caught in a pollination web in boreal Canada.</h2><span id='topic+barrett1987'></span>

<h3>Description</h3>

<p>This study took place in the boreal forest of central New Brunswick, Canada, from May to September of 1978, 1979, and 1980. The objective was to investigate the role of animals in pollination and seed dispersal. The study was designed to provide basic descriptive information on breeding systems, pollination biology, and phenology of understory herbs.
</p>
<p>The authors recorded their data by counting the number of individual flower visitors caught on each plant species. The total number of individuals collected on each plant species provide a rough estimate of the level of visitation that each species received. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(barrett1987)</code></pre>


<h3>References</h3>

<p>Barrett, S. C. H. and Helenurm, K. (1987) The Reproductive-Biology Of Boreal Forest Herbs. 1. Breeding Systems And Pollination. <em>Canadian Journal of Botany</em> <b>65</b>, 2036&ndash;2046
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(barrett1987)
</code></pre>

<hr>
<h2 id='betalinkr'>
Calculate network dissimilarity (beta diversity) and its components
</h2><span id='topic+betalinkr'></span><span id='topic+betalinkr_multi'></span>

<h3>Description</h3>

<p>This function (<code>betalinkr</code>) is a new implementation of network dissimarility, as proposed by Tim Poisot (originally implemented in the <em>betalink</em> package). Following Poisot, dissimilarity (of a pair of networks) is partitioned into the dissimilarity due to difference in species composition (&ldquo;ST&rdquo;) and dissimilarity due to rewiring (&ldquo;OS&rdquo;, dissimilarity of shared species subweb). Different partitioning approaches and many binary and quantitative indices are available. The recommended method for additive partitioning is <code>commondenom</code> (originally proposed by Novotny 2009), for which further partitioning into different aspects of species composition differences (<code>partition.st</code>) and into replacement and richness difference components (<code>partition.rr</code>) are also available.
</p>
<p><code>betalinkr_multi</code> is a metafunction that calls <code>betalinkr</code> for all pairs of networks (passing arguments), and returns a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betalinkr(webarray, index="bray", binary=TRUE, partitioning="commondenom",
          proportions=!binary, function.dist="vegdist", distofempty="zero",
          partition.st=FALSE, partition.rr=FALSE)

betalinkr_multi(webarray, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="betalinkr_+3A_webarray">webarray</code></td>
<td>

<p>Input data, an array with three dimensions, third dimension has length 2 and separates the two webs to compare. First two dimensions are the species (typically first Lower and second Higher). For convenience, if <span class="option">webarray</span> is a list of two webs, it will be converted to array format first using <code>webs2array</code> (that function can also be used to convert single web matrices to array format, but then needs to be called explicitly). NOTE: When using <code>betalinkr_multi</code>, <span class="option">webarray</span> <b>must</b> be an array! Use <code><a href="#topic+webs2array">webs2array</a></code> when providing networks (see last example below).
</p>
</td></tr>
<tr><td><code id="betalinkr_+3A_index">index</code></td>
<td>
 
<p>The dissimilarity index, passed to &quot;method&quot; of either vegdist or betadiver (see there for naming). If <span class="option">partitioning="commondenom"</span> (and thus no external function is used), it has to be one of <span class="option">sorensen</span> (for Sorensen or Bray-Curtis dissimilarity index) or <span class="option">jaccard</span> (for Jaccard or Ruzicka); <span class="option">bray</span> is also allowed and gives the same result as <span class="option">sorensen</span>.  </p>
</td></tr>
<tr><td><code id="betalinkr_+3A_binary">binary</code></td>
<td>

<p>Should binary data or quantitative data be used (i.e., quantitative or binary versions of dissimilarity indices). If <code>TRUE</code>, webs will be converted to binary.
</p>
</td></tr>
<tr><td><code id="betalinkr_+3A_partitioning">partitioning</code></td>
<td>

<p>How should the components (&ldquo;ST&rdquo; and &ldquo;OS&rdquo;) be calculated? With <span class="option">poisot</span>, the original approach will be applied, which calculates ST as WN - OS; not recommended for partitioning as it underestimates the contribution of species composition. But with this setting, OS will reflect the uncorrected dissimilarity of shared species subwebs, which may be interesting as such.
</p>
<p>With <span class="option">commondenom</span> (recommended setting), an alternative partitioning approach is used that should give fair contributions for OS and ST. It keeps a common denominator (of the dissimilarity index) for WN, OS and ST (i.e., the denominator is based on all links of the pair of webs instead of on subsets). Thus, only the numerator of the dissimilarity index is partitioned, which ensures additivity directly by partitioning the sets of links (or link weights).
</p>
</td></tr>
<tr><td><code id="betalinkr_+3A_proportions">proportions</code></td>
<td>

<p>Should data be standardized to proportions before calculating quantitative dissimilarity metrics? Note that this is done here directly before calculating dissimilarities, thus gives a different result than if input data were already standardized. Will be set to TRUE by default if <span class="option">binary=FALSE</span> and to FALSE otherwise.
</p>
</td></tr>
<tr><td><code id="betalinkr_+3A_function.dist">function.dist</code></td>
<td>

<p>Which function to use for calculating dissimilarity? The name of <b>vegan</b> package function, either <span class="option">vegdist</span> (quantitative indices available) or <span class="option">betadiver</span> (gives compatibility to the 24 numbered indices of Koleff et al. (2003) as used by <span class="pkg">betalink</span> package, but only binary indices). Note that this argument is ignored if <code>partitioning="commondenom"</code>, which implements the dissimilarity index calculation directly.
</p>
</td></tr>
<tr><td><code id="betalinkr_+3A_distofempty">distofempty</code></td>
<td>

<p>Can be <span class="option">zero</span> or <span class="option">na</span>. How should dissimilarity be defined when there are either no links to use for OS (i.e. only links involving species just found in one of the 2 webs) or no links to use for ST (i.e. only &ldquo;rewiring links&rdquo; present)? <span class="option">zero</span> is appropriate when interested in the contribution of components OS and ST, whereas <span class="option">na</span> is appropriate when b_os should be interpreted separately as dissimilarity of shared species subwebs
</p>
</td></tr>
<tr><td><code id="betalinkr_+3A_partition.st">partition.st</code></td>
<td>

<p>A secondary partitioning of the species turnover component, following Novotny (2009), which separates ST further into dissimilarity due to absence of resource species (lower, ST.l), absence of consumer species (higher, ST.h) or absence of both (ST.lh)
</p>
<p>Only works with <span class="option">partitioning="commondenom"</span>.
</p>
</td></tr>
<tr><td><code id="betalinkr_+3A_partition.rr">partition.rr</code></td>
<td>

<p>A secondary partitioning of dissimilarity (WN and OS) into &ldquo;true&rdquo; turnover components (WN.repl, OS.repl) and a component due to richness difference (difference in network totals; WN.rich, OS.repl). This follows Legendre (2014, and references therein) and was first applied to networks by Noreika et al. (2019). The function implements &ldquo;Podani family&rdquo; indices according to Legendre's terminology.
</p>
<p>Only works with <code>partitioning="commondenom"</code>.
</p>
</td></tr>
<tr><td><code id="betalinkr_+3A_...">...</code></td>
<td>
<p>Arguments passed on to <code><a href="#topic+betalinkr">betalinkr</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic idea to calculate dissimilarity (betadiversity) between networks (links instead of species) has been proposed before. Poisot et al. (2012) came up with the idea to separate between rewiring and species turnover as causes of network dissimilarity (but see Novotny 2009). They proposed to calculate rewiring link dissimilarity (&ldquo;beta_OS&rdquo; or simply &ldquo;OS&rdquo;) by focusing on the sub-web containing only species observed in both webs (i.e. excluding links with species unique to one of the webs). Species turnover link dissimilarity (&ldquo;beta_ST&rdquo; or simply &ldquo;ST&rdquo;) is then calculated as total dissimilarity minus rewiring dissimilarity, but this assumes an additivity that is rarely given with dissimilarity indices.
Although dissimilarity values may not be additive, the number of &ldquo;unique links&rdquo; (i.e. only observed in one of the two webs) can be well partitioned into additive components.
</p>
<p>With option <span class="option">partitioning="poisot"</span>, many different dissimilarity indices can be used with <code>function.dist</code> either <code>vegdist</code> or <code>betadiver</code>, but no guarantee that all of them can be usefully interpreted (following Legendre 2014, Jaccard-family and Sorensen-family dissimilarity indices are recommended; note that with vegdist you get Sorensen-family with <span class="option">bray</span>, and with betadiver Jaccard is 15 and Sorensen is 1, although these go under different names there as Koleff et al. (2003) use the names Jaccard/Sorensen for the corresponding similarity metrics).
</p>
<p>The alternative approach (with <span class="option">partitioning="commondenom"</span>) was inspired by Legendre (2014). It avoids using an existing dissimilarity function, but rather implements calculation of dissimilarity indices directly (thus more limited options for these: only binary and quantitative Jaccard-type and Sorensen-type). Here, the same denominator as for the total dissimilarity WN is used also for its components OS and ST, thus ensuring additivity. This method was actually already proposed by Novotny (2009), who further splitted ST (see <span class="option">partition.st</span>). If your goal is indeed to partition dissimilarity into its (additive) components, use this method!
</p>
<p>Note that if you are interested only in <em>dissimilarity between subwebs (not as an additive component)</em>, you should use <span class="option">partitioning="poisot"</span> and look at OS while ignoring ST. This works also for quantitative data (with <code>binary=FALSE</code>). If this is your goal, you should probably set <span class="option">distofempty="na"</span>, returning NA/NaN if there are no interactions between shared species.
</p>
<p>To generate results identical to Poisot's <code>betalink</code> function in package <em>betalink</em>, use these settings: <span class="option">partitioning="poisot", function.dist="betadiver", distofempty="na" and binary=TRUE</span>.
</p>
<p>Again: the output for OS can differ strongly depending on the chosen options! You have to decide: do you want dissimilarity, which is inherently not additive (use <span class="option">partitioning="poisot"</span>), or do you want an additive dissimilarity component, which is not a dissimilarity itself (use <span class="option">partitioning="commondenom"</span>)?
</p>


<h3>Value</h3>

<p>A named vector of four (or more) dissimilarities (components), naming follows Poisot et al. 2012.
</p>
<table role = "presentation">
<tr><td><code>S</code></td>
<td>
<p>beta_S, the dissimilarity in species composition</p>
</td></tr>
<tr><td><code>OS</code></td>
<td>
<p>beta_OS, the dissimilarity (component) explained by &ldquo;rewiring&rdquo; among shared species</p>
</td></tr>
<tr><td><code>WN</code></td>
<td>
<p>beta_WN, the dissimilarity between the two networks</p>
</td></tr>
<tr><td><code>ST</code></td>
<td>
<p>beta_ST, the dissimilarity (component) explained by difference in species community composition</p>
</td></tr>
<tr><td><code>(others)</code></td>
<td>
<p>possibly more elements, same names as above, but with secondary partitioning added after &ldquo;.&rdquo;, see <code>partition.st</code> and <code>partition.rr</code></p>
</td></tr>
</table>
<p>For <code>betalinkr_multi</code>, output is a dataframe with one row per pair of webs compared.
</p>


<h3>Note</h3>

<p>This function allows to use quantitative dissimilarity indices, which are usually recommended. However, for quantitative networks it is far from trivial how to correctly separate (or even define) which part of the dissimilarity is due to rewiring and which due to difference in species composition! Here I use the concept that all variation between the subwebs of shared species can be attributed to rewiring, BUT this will most likely not be correct. Even if all species are shared among two networks, quantitative species dissimilarity may be large (different [relative] abundances), and this will most likely lead to changes in network frequencies (changing link weights, or even missing links) that should not be called rewiring. How to correctly define and measure that is open to discussion, but thus I would still consider the values for beta_OS as overestimates.
</p>
<p>This function should also work for one-mode networks.
</p>
<p>Why the name of the function? Short for &ldquo;betalink revised&rdquo;.
</p>
<p>Why the names of the output values? These are the indices of beta (for betadiversity); I am keeping the names used by Tim Poisot and guess what they stand for: S (Species), OS (Only Shared species links), WN (Whole Network links), ST (Species Turnover links). Some authors would call all this dissimilarity (or dissimilarity components) and reserve the term betadiversity for something not standardized between 0 and 1.
</p>
<p>For partitioning into replacement and richness difference, note that replacement in WN can mean richness difference in OS (if shared species switch from interaction with other shared species in one network to interactions with non-shared species in another network, changing the size of shared-species subweb), so finding OS.rich &gt; WN.rich is not a bug.
</p>
<p>Thanks to Carsten Dormann, Benjamin Schwarz, Benoit Gauzens, Nacho Bartomeus and Timothee Poisot for their contributions to this function.
</p>


<h3>Author(s)</h3>

<p>Jochen Fründ</p>


<h3>References</h3>

<p>Poisot, T., E. Canard, D. Mouillot, N. Mouquet, D. Gravel, and F. Jordan. 2012. The dissimilarity of species interaction networks. <em>Ecology Letters</em> <b>15</b>, 1353&ndash;1361. 
</p>
<p>Legendre, P. 2014. Interpreting the replacement and richness difference components of beta diversity. <em>Global Ecology and Biogeography</em> <b>23</b>, 1324&ndash;1334. 
</p>
<p>Koleff, P., Gaston, K.J., and J.J. Lennon. 2003. Measuring beta diversity for presence–absence data. <em>Journal of Animal Ecology</em> <b>72</b>, 367&ndash;382.
</p>
<p>Novotny, V. 2009. Beta diversity of plant-insect food webs in tropical forests: a conceptual framework. <em>Insect Conservation and Diversity</em> <b>2</b>, 5&ndash;9. 
</p>
<p>Noreika, N., Bartomeus, I., Winsa, M., Bommarco, R., and  E. Öckinger. 2019. Pollinator foraging flexibility mediates rapid plant-pollinator network restoration in semi-natural grasslands.<em>Scientific Reports</em>, <b>9</b>, 1&ndash;11. <a href="https://doi.org/10.1038/s41598-019-51912-4">doi:10.1038/s41598-019-51912-4</a>
</p>


<h3>See Also</h3>

<p><code><a href="vegan.html#topic+vegdist">vegdist</a></code> and <code><a href="vegan.html#topic+betadiver">betadiver</a></code> for vegan package functions calculating dissimilarity / betadiversity, used here unless <span class="option">partitioning="commondenom"</span>.
</p>
<p>For reshaping web data to the array input format expected here, see <code><a href="#topic+webs2array">webs2array</a></code> and <code><a href="#topic+frame2webs">frame2webs</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># two examples that give the same results as would the 
# \code{betalink} function in the package of the same name
betalinkr(webs2array(list(Safariland=Safariland, vazarr=vazarr)), 
    partitioning="poisot")
betalinkr(webs2array(list(Safariland=Safariland, vazarr=vazarr)), 
    function.dist="betadiver",index=1, partitioning="poisot")

# same data, with recommended partitioning method plus further partitioning
betalinkr(webs2array(list(Safariland=Safariland, vazarr=vazarr)), 
    partitioning="commondenom", partition.st=TRUE)

# another example (no shared links)
testdata &lt;- data.frame(higher = c("bee1","bee1","bee1","bee2","bee1","bee3"), 
  lower = c("plant1","plant2","plant1","plant2","plant3","plant4"), 
  webID = c("meadow","meadow","meadow","meadow","bog","bog"), freq=c(5,1,1,1,3,7))

# more than two webs:
betalinkr_multi(webs2array(Safariland, vazquenc, vazarr), index="jaccard")
</code></pre>

<hr>
<h2 id='betweenness_w'> Betweenness centrality in a weighted network </h2><span id='topic+betweenness_w'></span>

<h3>Description</h3>

<p> This function calculates betweenness scores for nodes in a weighted network based on the distance_w-function. <br />
Note: This algorithm relies on the igraphs package's implementation of Dijkstra's algorithm. Currently, it does not find multiple shortest paths if two exist.</p>


<h3>Usage</h3>

<pre><code class='language-R'> betweenness_w(net, directed=NULL, alpha=1) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="betweenness_w_+3A_net">net</code></td>
<td>
<p> A weighted edgelist </p>
</td></tr>
<tr><td><code id="betweenness_w_+3A_directed">directed</code></td>
<td>
<p> logical, whether the network is directed or undirected. Default is NULL, this means that the function checks whether the edgelist is directed or not.</p>
</td></tr>
<tr><td><code id="betweenness_w_+3A_alpha">alpha</code></td>
<td>
<p> sets the alpha parameter in the generalised measures from Opsahl, T., Agneessens, F., Skvoretz, J., 2010. Node Centrality in Weighted Networks: Generalizing Degree and Shortest Paths. Social Networks. If this parameter is set to 1 (default), the Dijkstra shortest paths are used. The length of these paths rely simply on the tie weights and disregards the number of nodes on the paths. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> Returns a data.frame with two columns: the first column contains the nodes' ids, and the second column contains the nodes' betweenness scores. </p>


<h3>Note</h3>

<p> version 1.0.0, taken, with permission, from package tnet  </p>


<h3>Author(s)</h3>

<p> Tore Opsahl; <a href="https://toreopsahl.com/">https://toreopsahl.com/</a> </p>


<h3>References</h3>

 <p><a href="https://toreopsahl.com/2009/02/20/betweenness-in-weighted-networks/">https://toreopsahl.com/2009/02/20/betweenness-in-weighted-networks/</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load sample data
sampledata &lt;- rbind(
c(1,2,1),
c(1,3,5),
c(2,1,1),
c(2,4,6),
c(3,1,5),
c(3,4,10),
c(4,2,6),
c(4,3,10))

## Run the programme
betweenness_w(sampledata)

</code></pre>

<hr>
<h2 id='bezerra2009'>Individuals observed in a flower-visitation network of oil-collecting bees in a Brazilian steppe.</h2><span id='topic+bezerra2009'></span>

<h3>Description</h3>

<p>Observation of 38 individual plants from 13 oil-flower species of the family Malphighiaceae. Flower visitors were collected. Only legitimate visitors were considered. Numbers in cells refer to the amount of visits of each bee species collected in each flower species.
</p>
<p>The species interaction matrix describes the number of bee visits to 138 individual plants in natural clumps of 13 Malpighiaceae species during the flowering peak of each species. The number of bee visits  to flowers was registered over four consecutive days, from 5.00 to 17.00 with a total of 1392 h of observations. 
</p>
<p>Location: Parque Nacional do Catimbau, Brazil (8°24'00&rdquo; - 37° 36'35&rdquo;S and 3° 09'30&rdquo; - 37° 14'40&rdquo;W)
</p>
<p>Biome: Caatinga (Brazilian steppe)
</p>
<p>The paper itself contrasted a network of Malpighiaceae oil-flowers and associated oil-collecting bees from a Brazilian steppe (&ldquo;caatinga&rdquo;) to whole pollination networks from all over the world available in the Interaction Web Database. The caatinga network had a perfectly balanced proportion of plants and animals (13 x 13) and was more nested and less modular than all of the 22 whole pollination networks studied. The authors concluded that the oil-flower subweb is more cohesive and resilient than whole pollination networks, reinforcing the hypothesis that each ecological service is in fact a mosaic of different subservices with a hierarchical structure (&ldquo;webs within webs&rdquo;).      
</p>
<p>Take from the NCEAS interaction web database (<a href="https://iwdb.nceas.ucsb.edu">https://iwdb.nceas.ucsb.edu</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bezerra2009)</code></pre>


<h3>References</h3>

<p>Bezerra, E.L.S., Machado, I.C.S. and Mello, M.A.R. 2009. Pollination networks of oil-flowers: a tiny world within the smallest of all worlds. <em>Journal of Animal Ecology</em> <b>78</b>, 1096&ndash;1101.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bezerra2009)
</code></pre>

<hr>
<h2 id='C.score'> Calculates the (normalised) mean number of checkerboard combinations (C-score) in a matrix </h2><span id='topic+C.score'></span>

<h3>Description</h3>

<p>Calculates the C-score for all higher-level species; the C-score represents the average number of checkerboard units for each unique species pair.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>C.score(web, normalise = TRUE, FUN = mean, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="C.score_+3A_web">web</code></td>
<td>
<p> A matrix with pollinators as columns and plants as rows. Alternatively, when used on e.g. species occurrences across islands, rows are islands. </p>
</td></tr>
<tr><td><code id="C.score_+3A_normalise">normalise</code></td>
<td>
<p> Logical; if <code>TRUE</code> (default), the C-score is ranged between 0 (no checkerboards) and 1 (only checkerboards). For <code>FALSE</code> the standard value of mean number of checkerboard pairs is returned. This is somewhat awkward for comparing different data sets, that's what the normalisation is for.</p>
</td></tr>
<tr><td><code id="C.score_+3A_fun">FUN</code></td>
<td>
<p> Function to use when summarising the C-scores for each pairwise comparison. Defaults to <code>mean</code>, but other useful functions could be <code>median</code> (because C-scores are rather skewed) or <code>hist</code> (for a nice graph). </p>
</td></tr>
<tr><td><code id="C.score_+3A_...">...</code></td>
<td>
<p> Options to be passed on to FUN, e.g. <span class="option">na.rm=T</span> for matrices with many zeros and <span class="option">normalise=TRUE</span>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>As a first step, any quantitative matrix is converted to a binary matrix of presences and absences.
</p>
<p>Then, the formula given in Stone and Roberts (1990) is calculated for all species combinations, by calling <code>designdist</code> from the package <span class="pkg">vegan</span>. See code for details.
</p>


<h3>Value</h3>

<p>Returns whatever the <span class="option">FUN</span> produces as output. Default would be a single value, i.e. the mean C-score of the web.
</p>


<h3>Note</h3>

 
<p>The normalisation, since Jan. 2015, is by brute force: the 1s and 0s are distributed for each pairwise comparison for maximum checkerboardness. (The previously used approach was incorrect!) As a consequence, large matrices will take some time to compute.
</p>
<p>The minimum is set to 0.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann </p>


<h3>References</h3>

 
<p>Gotelli, N.J. and Rohde, K. (2002) Co-occurrence of ectoparasites of marine fishes: a null model analysis. <em>Ecology Letters</em> <b>5</b>, 86&ndash;94
</p>
<p>Stone, L. and Roberts, A. (1990) The checkerboard score and species distributions. <em>Oecologia</em> <b>85</b>, 74&ndash;79
</p>


<h3>Examples</h3>

<pre><code class='language-R'>m &lt;- matrix(c(1,0,0, 1,1,0, 1,1,0, 0,1,1, 0,0,1), 5,3,TRUE)
C.score(m)
C.score(m, normalise=FALSE)
C.score(m, normalise=FALSE, FUN=print)

</code></pre>

<hr>
<h2 id='closeness_w'> Closeness centrality in a weighted network </h2><span id='topic+closeness_w'></span>

<h3>Description</h3>

<p> This function calculates closeness scores for nodes in a weighted network based on the distance_w-function. </p>


<h3>Usage</h3>

<pre><code class='language-R'> closeness_w(net, directed=NULL, gconly=TRUE, precomp.dist=NULL, alpha=1) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="closeness_w_+3A_net">net</code></td>
<td>
<p> A weighted edgelist </p>
</td></tr>
<tr><td><code id="closeness_w_+3A_directed">directed</code></td>
<td>
<p> Logical: whether the edgelist is directed or undirected. Default is NULL, then the function detects this parameter. </p>
</td></tr>
<tr><td><code id="closeness_w_+3A_gconly">gconly</code></td>
<td>
<p> Logical: whether to calculate closeness only on the main component (traditional closeness). Default is TRUE. If this parameter is set to FALSE, a closeness measure for all nodes is computed. For details, see <a href="https://toreopsahl.com/2010/03/20/closeness-centrality-in-networks-with-disconnected-components/">https://toreopsahl.com/2010/03/20/closeness-centrality-in-networks-with-disconnected-components/</a></p>
</td></tr>
<tr><td><code id="closeness_w_+3A_precomp.dist">precomp.dist</code></td>
<td>
<p> If you have already computed the distance matrix using distance_w-function, you can enter the name of the matrix-object here. </p>
</td></tr>
<tr><td><code id="closeness_w_+3A_alpha">alpha</code></td>
<td>
<p> sets the alpha parameter in the generalised measures from Opsahl, T., Agneessens, F., Skvoretz, J. (2010. Node Centrality in Weighted Networks: Generalizing Degree and Shortest Paths. <em>Social Networks</em>). If this parameter is set to 1 (default), the Dijkstra shortest paths are used. The identification procedure of these paths rely simply on the tie weights and disregards the number of nodes on the paths. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> Returns a data.frame with three columns: the first column contains the nodes' ids, the second column contains the closeness scores, and the third column contains the normalised closeness scores (i.e., divided by N-1). </p>


<h3>Note</h3>

<p> version 1.0.0, taken, with permission, from package tnet  </p>


<h3>Author(s)</h3>

<p> Tore Opsahl; <a href="https://toreopsahl.com/">https://toreopsahl.com/</a> </p>


<h3>References</h3>

 <p><a href="https://toreopsahl.com/2009/01/09/average-shortest-distance-in-weighted-networks/">https://toreopsahl.com/2009/01/09/average-shortest-distance-in-weighted-networks/</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load sample data
sampledata &lt;- rbind(
c(1,2,4),
c(1,3,2),
c(2,1,4),
c(2,3,4),
c(2,4,1),
c(2,5,2),
c(3,1,2),
c(3,2,4),
c(4,2,1),
c(5,2,2),
c(5,6,1),
c(6,5,1))

## Run the programme
closeness_w(sampledata)

</code></pre>

<hr>
<h2 id='clustering_tm'> Redefined clustering coefficient for two-mode networks </h2><span id='topic+clustering_tm'></span>

<h3>Description</h3>

<p> This function calculates the two-mode clustering coefficient as proposed by Opsahl (2010). <br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clustering_tm(net, subsample=1, seed=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clustering_tm_+3A_net">net</code></td>
<td>
<p>A binary or weighted two-mode edgelist </p>
</td></tr>
<tr><td><code id="clustering_tm_+3A_subsample">subsample</code></td>
<td>
<p>Whether a only a subset of 4-paths should we used when calculating the measure. This is particularly useful when running out of memory analysing large networks. If it is set to 1, all the 4-paths are analysed. If it set to a value below one, this is roughly the proportion of 4-paths that will be analysed. If it is set to an interger greater than 1, this number of ties that form the first part of a 4-path that will be analysed. Note: The C++ functions are better as they analyse the full network. </p>
</td></tr>
<tr><td><code id="clustering_tm_+3A_seed">seed</code></td>
<td>
<p>If a subset of 4-paths is analysed, by setting this parameter, the results are reproducable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the outcome of the equation presented in the paper</p>


<h3>Note</h3>

<p> version 1.0.0, taken, with permission, from package tnet  </p>


<h3>Author(s)</h3>

<p> Tore Opsahl; <a href="https://toreopsahl.com">https://toreopsahl.com</a> </p>


<h3>References</h3>

<p>Opsahl, T. 2010. Triadic closure in two-mode networks: Redefining the global and local clustering coefficients. <em>arXiv</em>,1006.0887  </p>

<hr>
<h2 id='compart'>Detects compartments</h2><span id='topic+compart'></span>

<h3>Description</h3>

<p>Finds number of compartments, based on multivariate ordination techniques, and labels interactions according to the compartment they belong to.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compart(web)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compart_+3A_web">web</code></td>
<td>
<p>A bipartite interaction web, i.e.~a matrix with higher (cols) and lower (rows) trophic levels.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internal function, to be called by <code><a href="#topic+networklevel">networklevel</a></code>. 
</p>


<h3>Value</h3>

<p>Returns a list with two entries:
</p>
<table role = "presentation">
<tr><td><code>cweb</code></td>
<td>
<p>A matrix similar to <code>web</code>, but now with compartment numbers instead of interaction values.</p>
</td></tr>
<tr><td><code>ncompart</code></td>
<td>
<p>The number of compartments.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Note that up to (and including) version 0.85 we used a code based on correspondence analysis (see Lewinsohn et al. 2006). This is, however, faulty for webs with many same-linked species. Hence we resorted to a brute-force search for compartments, which is orders of magnitude slower, but at least works correctly. Only in version 1.18  Juan M. Barreneche eventually found a solution that is fast and works with ties! 
</p>


<h3>Author(s)</h3>

<p> Juan M. Barreneche &lt;jumanbar@gmail.com&gt;, but please co-copy comments/questions to package maintainer: Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt; </p>


<h3>References</h3>

<p>Lewinsohn, T. M., P. I. Prado, P. Jordano, J. Bascompte, and J. M. Olesen (2006) Structure in plant-animal interaction assemblages. <em>Oikos</em> <b>113</b>, 174&ndash;184
</p>


<h3>See Also</h3>

<p> See also <code><a href="#topic+networklevel">networklevel</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'># make a nicely comparted web:
web &lt;- matrix(0, 10,10)
web[1,1:3] &lt;- 1 
web[2,4:5] &lt;- 1 
web[3:7, 6:8] &lt;- 1
web[8:10, 9:10] &lt;- 1
web &lt;- web[-c(4:5),] #oh, and make it asymmetric!
web &lt;- web[,c(1:5, 9,10, 6:8)] #oh, and make it non-diagonal
compart(web)

# or, standard, use Safariland as example:
data(Safariland)
compart(Safariland)
</code></pre>

<hr>
<h2 id='computeModules'>computeModules</h2><span id='topic+computeModules'></span><span id='topic+readModuleData'></span><span id='topic+metaComputeModules'></span>

<h3>Description</h3>

<p>This function takes a bipartite weighted graph and computes modules by applying Newman's modularity measure in a bipartite weighted version to it. 
<code>metaComputeModules</code> re-runs the algorithm several times, returning the most modular result, to stabilise modularity computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeModules(web, method="Beckett", deep = FALSE, deleteOriginalFiles = TRUE, 
	steps = 1000000, tolerance = 1e-10, experimental = FALSE, forceLPA=FALSE)
	
metaComputeModules(moduleObject, N=5, method="Beckett", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeModules_+3A_web">web</code></td>
<td>

<p><code>web</code> is the matrix representing the weighted bipartite graph (as an example, see e.g. web <code><a href="#topic+small1976">small1976</a></code> in this package). This matrix can be binary (i.e. consist only of 0s and 1s), in which case the output will be Newman's (2006) modularity.
</p>
</td></tr>
<tr><td><code id="computeModules_+3A_method">method</code></td>
<td>
<p>Choice between the algorithm(s) provided by Stephen Beckett (2016) or Dormann &amp; Strauss (2016) (<span class="option">method="DormannStrauss"</span>). Defaults to the much faster and in the majority of cases better algorithm of Beckett. (Note the optional argument <span class="option">forceLPA</span> to use his slightly inferior but even faster pure LPA algorithm.)</p>
</td></tr>
<tr><td><code id="computeModules_+3A_deep">deep</code></td>
<td>

<p>If <code>deep</code> is set to FALSE (default), a flat clustering is computed, otherwise submodules are identified recursively within modules. Works only with <span class="option">method="DormannnStrauss"</span>.
</p>
</td></tr>
<tr><td><code id="computeModules_+3A_deleteoriginalfiles">deleteOriginalFiles</code></td>
<td>

<p>If <code>deleteOriginalFiles</code> is set to TRUE (default), the files mentioned above in the description are deleted from the hard drive disk, otherwise not. Applies only to <span class="option">method="DormannnStrauss"</span>.
</p>
</td></tr>
<tr><td><code id="computeModules_+3A_steps">steps</code></td>
<td>

<p><code>steps</code> is the number of steps after which the computation of modules stops if no better division into modules than the current one can be found. Applies only to <span class="option">method="DormannnStrauss"</span>.
</p>
</td></tr>
<tr><td><code id="computeModules_+3A_tolerance">tolerance</code></td>
<td>
<p>How small should the difference between MCMC-swap results be? At some point computer precision fluctuations make the algorithm fail to converge, which is why we choose a (very low) defaults of 1E-10. Applies only to <span class="option">method="DormannnStrauss"</span>.</p>
</td></tr>
<tr><td><code id="computeModules_+3A_experimental">experimental</code></td>
<td>
<p>Logical; using an undescribed and untested version for which no detail is available? (We suggest: not yet.) Applies only to <span class="option">method="DormannnStrauss"</span>.</p>
</td></tr>
<tr><td><code id="computeModules_+3A_moduleobject">moduleObject</code></td>
<td>
<p>Output from running <code>computeModules</code>.</p>
</td></tr>
<tr><td><code id="computeModules_+3A_forcelpa">forceLPA</code></td>
<td>
<p>Logical; should the even faster pure LPA-algorithm of Beckett be used? DIRT-LPA, the default, is less likely to get trapped in a local minimum, but is slightly slower. Defaults to FALSE.  Applies only to <span class="option">method="Beckett"</span>.</p>
</td></tr>
<tr><td><code id="computeModules_+3A_n">N</code></td>
<td>
<p>Number of replicate runs; defaults to 5. Not really required for <span class="option">method="Beckett"</span>, which starts in different places anyway.</p>
</td></tr>
<tr><td><code id="computeModules_+3A_...">...</code></td>
<td>
<p>Arguments passed on to <code>computeModules</code>, which is called internally.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;moduleWeb&quot; containing information about the computed modules. For details, please refer to the corresponding documentation file. 
</p>


<h3>Note</h3>

<p>For perfectly compartmentalised networks the algorithm may throw an error message. Please add a little bit of noise (e.g. uniform between 0 and 1 or so) or a small constant (1E-5 or so) and it will work again. 
</p>
<p>When using the method <span class="option">DormannStrauss</span>, files are written onto the hard drive during the computation. These files are by default deleted after the computation terminates, unless it breaks. Details of the modularity algorithm can be found in Dormann &amp; Strauß (2013).
</p>


<h3>Author(s)</h3>

<p>Rouven Strauss, with fixes by Carsten Dormann and Tobias Hegemann; modified to accommodate Beckett's algorithm by Carsten Dormann</p>


<h3>References</h3>

 
<p>Beckett, S.J. 2016 Improved community detection in weighted bipartite networks. <em>Royal Society open science</em> <b>3</b>, 140536.
</p>
<p>Dormann, C. F., and R. Strauß. 2014. Detecting modules in quantitative bipartite networks: the QuanBiMo algorithm. <em>Methods in Ecology &amp; Evolution</em> <b>5</b> 90&ndash;98 (and <b>arXiv [q-bio.QM]</b> 1304.3218.)
</p>
<p>Liu X. &amp; Murata T. 2010. An Efficient Algorithm for Optimizing Bipartite Modularity in Bipartite Networks. <em>Journal of Advanced Computational Intelligence and Intelligent Informatics (JACIII)</em> <b>14</b> 408&ndash;415.
</p>
<p>Newman M.E.J. 2004. <em>Physical Review E</em> <b>70</b> 056131
</p>
<p>Newman, M.E.J. 2006. Modularity and community structure in networks. <em>Proceedings of the National Academy of Sciences of the United States of America</em>, <b>103</b>, 8577–-8582.
</p>


<h3>See Also</h3>

<p>See also class &quot;moduleWeb&quot;, <code>plotModuleWeb</code>, <code>listModuleInformation</code>, <code>printoutModuleInformation</code>, <code><a href="#topic+DIRT_LPA_wb_plus">DIRT_LPA_wb_plus</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	## Not run: 
		data(small1976)
		(res &lt;- computeModules(small1976)) 
		plotModuleWeb(res)
		
		# slow:
		res2 &lt;- metaComputeModules(small1976, method="DormannStrauss")
		res2
	
## End(Not run)
</code></pre>

<hr>
<h2 id='czvalues'>Computes c and z for network modules</h2><span id='topic+czvalues'></span>

<h3>Description</h3>

<p>Function to compute c and z values of module members according to Guimerà &amp; Amaral (2005), with formulae taken from Olesen et al. (2007)</p>


<h3>Usage</h3>

<pre><code class='language-R'>czvalues(moduleWebObject, weighted=FALSE, level="higher")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="czvalues_+3A_modulewebobject">moduleWebObject</code></td>
<td>
<p>A <code>moduleWeb-class</code> object as created by <code><a href="#topic+computeModules">computeModules</a></code>.</p>
</td></tr>
<tr><td><code id="czvalues_+3A_weighted">weighted</code></td>
<td>
<p>logical; if TRUE computes c and z from quantitative (=weighted) data; in this case, it will compute strength, rather than degrees for each species.</p>
</td></tr>
<tr><td><code id="czvalues_+3A_level">level</code></td>
<td>
<p>&quot;higher&quot; or &quot;lower&quot; trophic level to compute c and z values for; defaults to &quot;higher&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>c = 1 - sum( (k.it/k.i)^2)    # among-module connectivity = participation coefficient P in Guimerà &amp; Amaral
</p>
<p>z = (k.is - ks.bar) / SD.ks  # within-module degree
</p>
<p>k.is = number of links of i to other species in its own module s; 
ks.bar = average k.is of all species in module s; 
SD.ks = standard deviation of k.is of all species in module s; 
k.it = number of links of species i to module t; 
k.i = degree of species i
</p>
<p>Note that for any species alone (in its level) in a module the z-value will be NaN, since then SD.ks is 0. This is a limitation of the way the z-value is defined (in multiples of degree/strength standard deviations).
</p>
<p>Olesen et al. (2006) give critical c and z values of 0.62 and 2.6, respectively. Species exceeding these values are deemed connectors or hubs of a network. The justification of these thresholds remains unclear to me. They may also not apply for the quantitative version.
</p>


<h3>Value</h3>

<p>A list with two vectors, c and z, for all species of the selected trophic level. 
</p>


<h3>Note</h3>

<p>These indices were developed for one-mode networks; we'll have to see whether they make sense for bipartite networks, too! In particular, note that this function is based on a higher trophic level perspective. While the modules are identified using both trophic levels, c and z are computed through the strengths/degrees of only one trophic level. It would be desirable to have a truly two-level version. Since there are usually very different numbers of species in the two trophic levels, simply averaging the values of each trophic level won't do. But maybe a weighted average?
</p>
<p>Consider the following problem for computing c and z for the higher trophic level: For modules with only one species from the lower trophic level, the z-values will be NaN, since SD.ks is 0!  I decided to SET these values to 0, since they only occur when all species in that module will have the same number of links (which is obviously the case when there is only one lower-level species). Then the numerator is also 0. Thus, the value of 0 indicates that this species has no deviation from the rest of the module members (which is what I think z is supposed to represent).
</p>
<p>Since <code>computeModules</code> is experimental, also <code>czvalues</code> may not always work (i.e. if object <code>mod</code> is corrupted or ill-formed).
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a>, 20 Mar 2012</p>


<h3>References</h3>

 
<p>Guimerà, R. and Amaral, L.A.N. (2005) Functional cartography of complex metabolic networks. <em>Nature</em> <b>433</b>, 895&ndash;900.
</p>
<p>Olesen, J.M., Bascompte, J., Dupont, Y.L. and Jordano, P. (2007) The modularity of pollination networks. <em>Proceedings of the National Academy of Sciences of the USA</em> <b>104</b>, 19891-19896.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(2)
mod &lt;- computeModules(memmott1999)
cz &lt;- czvalues(mod)
plot(cz[[1]], cz[[2]], pch=16, xlab="c", ylab="z", cex=0.8, xlim=c(0,1), las=1)
abline(v=0.62) # threshold of Olesen et al. 2007
abline(h=2.5)   # dito
text(cz[[1]], cz[[2]], names(cz[[1]]), pos=4, cex=0.7)

# example for computing a c- or z-threshold:
mod &lt;- computeModules(Safariland)
czobs &lt;- czvalues(mod)
nulls &lt;- nullmodel(Safariland, N=10) # this should be larger, of course
null.mod.list &lt;- sapply(nulls, computeModules)
null.cz &lt;- lapply(null.mod.list, czvalues)
# compute 95
null.cs &lt;- sapply(null.cz, function(x) x$c) # c-values across all species in nulls
quantile(null.cs, 0.95) 
# this could now serve as thresholds for identifying particularly uncommonly high c-values
# and analogously for z, of course

## End(Not run)
</code></pre>

<hr>
<h2 id='decimalr2dtable'> Generates matrix with same marginal totals for non-negative decimal values</h2><span id='topic+decimalr2dtable'></span>

<h3>Description</h3>

<p>Function to generate null model matrices for the cases when the matrix entries are non-negative numbers, possibly non-integers. It maintains marginal totals (as does <code>r2dtable</code>), but &quot;smears&quot; them out over all cells.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decimalr2dtable(N=10, web, steps=prod(dim(web)))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="decimalr2dtable_+3A_n">N</code></td>
<td>
<p> Number of desired null model matrices. </p>
</td></tr>
<tr><td><code id="decimalr2dtable_+3A_web">web</code></td>
<td>
<p>An interaction matrix.</p>
</td></tr>
<tr><td><code id="decimalr2dtable_+3A_steps">steps</code></td>
<td>
<p>Number of successive alterations of matrix entries. Defaults to 10 times the number of cells. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a cross between <code><a href="stats.html#topic+r2dtable">r2dtable</a></code> and <code><a href="#topic+swap.web">swap.web</a></code>. Its output are N matrices of the same dimension as the input, and with same marginal totals, but with different allocation of values to the cells. 
Here is what the algorithm does:
</p>

<ol>
<li><p> Index a 2 x 2 submatrix by select randomly two rows and two columns.
</p>
</li>
<li><p> Draw a random value between 0 and the minimum of the diagonal entries in the submatrix.
</p>
</li>
<li><p> Subtract this value from the diagonals and add it to the counter-diagonal entries.
</p>
</li>
<li><p> Repeat <span class="option">steps</span> times
</p>
</li></ol>

<p>The result is a decimal-numbered matrix, typically with values &gt; 0 in each cell. 
</p>
<p>Indication: This function may be useful in some rare constellations. Imagine you sampled a plant-pollinator network and instead of counting the number of flower visits you recorded the nectar extracted by each pollinator. Then the marginal totals would indicate nectar production (plus confounding nectar attractiveness) and consumption potential for plants and pollinators, respectively. So, given that species differ in nectar production and consumption, what would you expect the network to look like? Enter <code>decimalr2dtable</code>.
</p>
<p>If external abundances (even in funny units such as biovolume in ml) are available, this function can easily provide the respective null models. See examples.
</p>


<h3>Value</h3>

<p>A list of N randomised matrices with the same dimensions as the initial web, all probably filled completely.
</p>


<h3>Note</h3>

<p>The output will typically be a fully filled matrix! Computing any index sensitive to matrix filling (such as connectance, degree, nestedness) for such a matrix is non-sensical! 
</p>
<p>Also, if used as a null model, an implicit assumption is that the values in the original matrix are meaningful as marginal totals. This may often not be the case, for example if entries are rates. Thus, probably this function is of very limited usefulness in the context of network analyses!
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt; </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+r2dtable">r2dtable</a></code>, <code><a href="#topic+vaznull">vaznull</a></code>, <code><a href="#topic+shuffle.web">shuffle.web</a></code> and <code><a href="#topic+swap.web">swap.web</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>obs &lt;- networklevel(Safariland, index="generality")

nulls &lt;- decimalr2dtable(10, Safariland)
g.dec &lt;- sapply(nulls, networklevel, index="generality")
nullsint &lt;- nullmodel(Safariland, N=10)
g.int &lt;- sapply(nullsint, networklevel, index="generality")
plot(density(g.dec[1,]), xlim=c(1, 3))
lines(density(g.int[1,]), col="red")
abline(v=obs[1], col="green")


## If you want to use external abundances to set up your null model:
set.seed(1)
ext.rows &lt;- runif(9) # imagine these are your external abundances for Safariland
ext.cols &lt;- runif(27)
# standardise to sum = 1:
ext.rows &lt;- ext.rows/sum(ext.rows)
ext.cols &lt;- ext.rows/sum(ext.cols)
web &lt;- tcrossprod(ext.rows, ext.cols) * sum(Safariland) 
# (to get to the same interaction density as original web)
#
# this can now be used as input for decimalr2dtable:
image(decimalr2dtable(N=1, web)[[1]]) # remember: white are high values!
</code></pre>

<hr>
<h2 id='degreedistr'>Fits functions to cumulative degree distributions of both trophic levels of a network.</h2><span id='topic+degreedistr'></span>

<h3>Description</h3>

<p>This function first calculates degrees for each species, then constructs a cumulative distribution with them, and finally fits three different functions to these distributions: exponential, power law and truncated power law. Coefficients and fits are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>degreedistr(web, plot.it=TRUE, pure.call=TRUE, silent=TRUE, level="both", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="degreedistr_+3A_web">web</code></td>
<td>
<p>A bipartite network matrix.</p>
</td></tr>
<tr><td><code id="degreedistr_+3A_plot.it">plot.it</code></td>
<td>
<p>Logical; returns graphs of fits when set to TRUE (default). Dark, median and light grey lines refer to exponential, power and truncated power law, respectively.</p>
</td></tr>
<tr><td><code id="degreedistr_+3A_pure.call">pure.call</code></td>
<td>
<p>Logical; adjusts par for two panels (for TRUE) or leaves this to the wrapper function (FALSE).</p>
</td></tr>
<tr><td><code id="degreedistr_+3A_silent">silent</code></td>
<td>
<p>Logical; suppresses error reporting in the <code>try</code>-function around <code>nls</code>; defaults to TRUE.</p>
</td></tr>
<tr><td><code id="degreedistr_+3A_level">level</code></td>
<td>
<p>For which level shall the degree distributions be computed: <span class="option">both</span>, <span class="option">lower</span> or <span class="option">higher</span>? Defaults to <span class="option">both</span>.</p>
</td></tr>
<tr><td><code id="degreedistr_+3A_...">...</code></td>
<td>
<p>Arguments passed on to the plot function (e.g. <span class="option">las=1</span>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Jordano et al. (2003) proposed that plant-animal networks may show scale invariance, as indicated by the presence of a power law in species degrees. They report on consistently better fits of the truncated power law, hypothesising that such patterns may arise from morphological mismatch or phenological uncoupling.
</p>
<p>Most problematic with the use of this particular approach is the extreme demand for data. The example web <code>Safariland</code> in this package is large (1130 interactions), but it provides only 5 different degree levels (for plants, only 4 for pollinators). Hence fitting three different non-linear functions to these few points is stretching it a bit.
</p>
<p>Furthermore, the least-square-fit to the cumulative distribution is not ideal. While the most common approach, it has a bias (albeit much less so than a fit to the probability density function: see Clauset et al. 2009). In an ideal world, we would want to fit the power law properly. This would require a) an estimation of the lower bound of the power law (xmin) and b) the maximum likelihood fit to the remaining data (x &gt; xmin). The data demand is however such that is unlikely that any ecological bipartite network in the near future will match it. Clauset et al. state that hundreds to thousands of data points are required to yield satisfactory estimates for xmin and the slope itself. If you happen to have this much data, please consult the software they provide (even in R!).
</p>


<h3>Value</h3>

<p>For both trophic levels, a table:
</p>
<table role = "presentation">
<tr><td><code>... trophic level dd fits</code></td>
<td>
<p>Contains coefficient estimates, estimate's standard
error and P-value, R2 and AIC for each of the three model fits, for the respective trophic level.</p>
</td></tr>
</table>
<p>If plots are returned, exponential, power law and truncated power law are given in black, dark grey and light grey, respectively.
</p>


<h3>Note</h3>

<p>The truncated power law fits two coefficients: slope and cut-off. The function only returns the slope.
R2-values for non-linear fits are not well liked among statisticians! See the discussion the R-help list (e.g. <a href="https://stat.ethz.ch/pipermail/r-help/2002-July/023461.html">https://stat.ethz.ch/pipermail/r-help/2002-July/023461.html</a>).
Finally, often data are too few to yield any fit. In this case the error message &ldquo;singular gradient&rdquo; is returned to signal this problem!
</p>
<p>Post finally, yes, I am aware that degrees are integers and unlikely to be normally distributed, and that thus the <code>nls</code> procedure is not really a good idea. My (poor) excuse: I followed the implementation of the above-cited paper and do not believe enough in degree distributions (and power laws, for that matter) to implement a proper likelihood-based approach. Check out the <span class="pkg">statnet</span> bundle for alternative approaches to this problem.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a> </p>


<h3>References</h3>

<p>Clauset, A., Shalizi, C. R., &amp; Newman, M. E. (2009). Power-law distributions in empirical data. <em>SIAM Review</em> <b>51</b>, 661&ndash;703
</p>
<p>Jordano, P., Bascompte, J. and Olesen, J. M. (2003) Invariant properties in coevolutionary networks of plant-animal interactions. <em>Ecology Letters</em> <b>6</b>, 69&ndash;81  
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+networklevel">networklevel</a></code>, where <code>degreedistr</code> is called (without picturing the results) </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
degreedistr(Safariland)
</code></pre>

<hr>
<h2 id='dfun'>Calculates standardised specialisation index d' (d prime) for each species in the lower trophic level of a bipartite network.</h2><span id='topic+dfun'></span>

<h3>Description</h3>

<p>This function returns the specialisation index d' for the lower level, which expresses how specialised a given species is in relation to what partners in the higher level are on offer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfun(web, abuns=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dfun_+3A_web">web</code></td>
<td>
<p> Web is a matrix representing the interactions observed between higher level species (columns) and lower level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey.</p>
</td></tr>
<tr><td><code id="dfun_+3A_abuns">abuns</code></td>
<td>
<p>A vector of abundances for the <b>higher</b> level, usually from independent information. If none is given (default) marginal sums are used. Note that if a web with rows or columns without any interaction is provided, these will not be purged when an independent abundances vector is given. As a consequence, these species will have a d' of NA (see note below).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The d' index is derived from Kulback-Leibler distance (as is Shannon's diversity index), and calculates how strongly a species deviates from a random sampling of interacting partners available. It ranges from 0 (no specialisation) to 1 (perfect specialist). In the case of a pollination web, a pollinator may be occurring only on one plant species, but if this species is the most dominant one, there is limited evidence for specialisation. Hence this pollinator would receive a low value. In contrast, a pollinator that occurs only on the two rarest plants would have a very high value of d'.
</p>
<p>The idea of this index is laid out in Blüthgen et al. (2006). It basically calculates the Shannon-diversity for each column (delivering the raw d-values) and re-ranges them between the theoretical maximum and minimum (yielding values between 0 and 1). dmax is given analytically (see paper or code), but dmin must be found &lsquo;heuristically&rsquo;, since the web can only contain integers. The idea behind the heuristic minimum is that d will be minimal when observed values differ least from expected values based on marginal distributions.
</p>
<p>The way this function is implemented, it calculates expected values for each cell based on the product of observed marginal sums (i.e. column and row sums) times <code>sum(web)</code>. Then it rounds off to integers and allocates the remaining interactions in two steps: First, all columns and rows with marginal sums of 0 obtain one interaction into the cell with the highest expected value. Secondly, all remaining interactions are distributed according to difference between present and expected value: those cells with highest discrepancy receive an interaction until the sum of all entries in the new web equals those in the original web. Now the d-values for this web are calculated and used as dmin.
</p>
<p>Simple rounding of expected values would lead to empty columns or rows, i.e. the dmin-web would be of lower dimension than the original web.
</p>
<p><code>dfun</code> returns the d' values for the lower trophic level. Use <code>dfun(t(web))</code> to get the d'-values for the higher trophic level (as does <code>specieslevel</code>). If you want to provide external abundances, you must provide those of the <b>other</b> trophic level! (This help file is written as if you were interested in the lower trophic level.)
</p>
<p>d' is one of several species-level network indices. It's generalisation to the entire interaction web is called H2' (see <code><a href="#topic+H2fun">H2fun</a></code>).
</p>
<p>The <code>abundances</code> vector allows to incorporate independent estimates of the abundances of the <b>higher</b> trophic level. In a pollination web, pollinator abundances may be very different from those estimated by the interaction matrix column sums. This has also, obviously, large consequences for the specialisation: A plant being pollinated by a bee that is common on this plant, but very rare in general, will show a low specialisation unless bee abundances are corrected for. Data given in the abundance vector are here used in replacement for the row sums, both in the d-function itself, as well as in the calculation of the minimum ds.
</p>
<p>In contrast to <code><a href="#topic+H2fun">H2fun</a></code>, finding the minimum value of d violates marginal totals. The idea is that we look at each species in turn. Then, we estimate how its observed number of interactions can be distributed, given the marginal totals (i.e. if 5 interactions were observed, they cannot be put into a link that only has 3 interactions across all species). So, for each species the number of interactions never exceeds the total across all species, but if we would put the web together from this sequential scan, it may well do so. In our view, this is irrelevant, because we are interested in the potential of each species separately to be perfectly specialised (given the marginal totals), not for the entire web. We leave this to <code><a href="#topic+H2fun">H2fun</a></code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dprime</code></td>
<td>
<p>d'-value for each species</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Raw d-value for each species, i.e. before ranging it between 0 and 1.</p>
</td></tr>
<tr><td><code>dmin</code></td>
<td>
<p>Minimum d-value for each species, based on a perfect nesting of the matrix; see details.</p>
</td></tr>
<tr><td><code>dmax</code></td>
<td>
<p>Maximum d-value theoretically possible given the observed number of interactions and the observed marginal distributions.</p>
</td></tr>
</table>


<h3>Note</h3>

 
<p>When independent abundances were provided, the empty rows/columns are purposefully <em>not</em> removed from the web (because they now still contain information). Logically (and as implemented), this leads to d-values for these species of NA. This makes sense: the pollinator, say, has never been observed on any of the flowers, so how can we quantify its specialisation?
</p>
<p>As detailed above, deriving the dmin-values &lsquo;heuristically&rsquo; leaves room to some variation. We are very happy with this implementation, but you may want to program something yourself ...
</p>


<h3>Author(s)</h3>

<p>Jochen Fründ and Carsten F. Dormann</p>


<h3>References</h3>

 
<p>Blüthgen, N., Menzel, F. and Blüthgen, N. (2006) Measuring specialization in species interaction networks. <em>BMC Ecology</em> <b>6</b>, 12
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+H2fun">H2fun</a></code> for a similar function for the entire network. <code><a href="#topic+specieslevel">specieslevel</a></code> for a method that, amongst other indices, calls <code>dfun</code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
dfun(Safariland) # gives d-values for the lower trophic level
# now using independent abundance estimates for higher trophic level:
dfun(Safariland, abuns=runif(ncol(Safariland)))

dfun(t(Safariland)) #gives d-values for the higher trophic level
</code></pre>

<hr>
<h2 id='DIRT_LPA_wb_plus'>Functions &quot;LPA_wb_plus&quot; and &quot;DIRT_LPA_wb_plus&quot;</h2><span id='topic+LPA_wb_plus'></span><span id='topic+convert2moduleWeb'></span><span id='topic+DIRT_LPA_wb_plus'></span>

<h3>Description</h3>

<p>Use <code><a href="#topic+computeModules">computeModules</a></code> to call this function! This function takes a bipartite weighted graph and computes modules by applying Newman's modularity measure in a bipartite weighted version to it. To do so, it uses Stephen J Beckett's DIRTLPAwb+ (or LPAwb+) algorithm, which builds on Liu &amp; Murata's approach. In contrast to the tedious MCMC-swapping QuanBiMo algorithm, this algorithm works by aggregating modules until no further improvement of modularity can be achieved.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DIRT_LPA_wb_plus(MATRIX, mini=4, reps=10)
LPA_wb_plus(MATRIX, initialmoduleguess=NA)
convert2moduleWeb(MATRIX, MODINFO)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DIRT_LPA_wb_plus_+3A_matrix">MATRIX</code></td>
<td>

<p><code>MATRIX</code> is the matrix representing the weighted bipartite graph (as an example, see e.g. web <code><a href="#topic+small1976">small1976</a></code> in this package).
</p>
</td></tr>
<tr><td><code id="DIRT_LPA_wb_plus_+3A_mini">mini</code></td>
<td>
<p>Minimal number of modules the algorithm should start with; defaults to 4. See explanation of <span class="option">initialmoduleguess</span> to understand why not starting with one module per species interaction makes sense.</p>
</td></tr>
<tr><td><code id="DIRT_LPA_wb_plus_+3A_reps">reps</code></td>
<td>
<p>Number of trials to run for each setting of <span class="option">mini</span>; defaults to 10 but my benefit from higher values.</p>
</td></tr>
<tr><td><code id="DIRT_LPA_wb_plus_+3A_initialmoduleguess">initialmoduleguess</code></td>
<td>
<p>Optional vector with labels for the modules of the longer web dimension. The <span class="option">initialmoduleguess</span> argument in <code>LPA_wb_plus</code> is used as an initial guess of the number of modules the network contains. The code then randomly assigns this many labels across the nodes of one of the types. The classical algorithm (i.e. <code>LPA_wb_plus</code>) would use an initialmoduleguess of the maximum number of modules a network can contain (i.e. assigning a different label to each node initially). <code>DIRT_LPA_wb_plus</code> exploits this. By initially assigning fewer than the maximum number of modules in the first instance nodes that may not have been placed together by the classical algorithm are placed together - creating different start points from which to attempt to maximise modularity.Defaults to <code>NA</code>, i.e. as many modules as there are species in the smaller group.</p>
</td></tr>
<tr><td><code id="DIRT_LPA_wb_plus_+3A_modinfo">MODINFO</code></td>
<td>
<p>Object returned by <code>modulesLPA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>LPA_wb_plus</code> computes the modules. <code>DIRT_LPA_wb_plus</code> is a wrapper calling <code>LPA_wb_plus</code> repeatedly to avoid getting stuck in some local minimum. Both return a simple list of row and column labels for the modules, as well as the modularity value. Using <code>convert2moduleWeb</code> turns this into the richer moduleWeb-class object produced by <code>computeModules</code>. For this object, the plotting function <code><a href="#topic+plotModuleWeb">plotModuleWeb</a></code> and summary functions <code><a href="#topic+listModuleInformation">listModuleInformation</a></code> and <code><a href="#topic+printoutModuleInformation">printoutModuleInformation</a></code> are available.
</p>


<h3>Author(s)</h3>

<p>Stephen J Beckett (<a href="https://github.com/sjbeckett/weighted-modularity-LPAwbPLUS">https://github.com/sjbeckett/weighted-modularity-LPAwbPLUS</a>), lifted, with consent of the author, by Carsten F. Dormann to bipartite</p>


<h3>References</h3>

 
<p>Beckett, S.J. 2016 Improved community detection in weighted bipartite networks. <em>Royal Society open science</em> <b>3</b>, 140536.
</p>
<p>Liu X. &amp; Murata T. 2010. An Efficient Algorithm for Optimizing Bipartite Modularity in Bipartite Networks. <em>Journal of Advanced Computational Intelligence and Intelligent Informatics (JACIII)</em> <b>14</b> 408&ndash;415.
</p>
<p>Newman M.E.J. 2004. <em>Physical Review E</em> <b>70</b> 056131
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeModules">computeModules</a></code>; see also class &quot;moduleWeb&quot;, <code><a href="#topic+listModuleInformation">listModuleInformation</a></code>, <code><a href="#topic+printoutModuleInformation">printoutModuleInformation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	## Not run: 
		(res &lt;- DIRT_LPA_wb_plus(small1976))
		mod &lt;- convert2moduleWeb(small1976, res)
		plotModuleWeb(mod)
	
## End(Not run)
</code></pre>

<hr>
<h2 id='discrepancy'> Calculates discrepancy of a matrix </h2><span id='topic+discrepancy'></span>

<h3>Description</h3>

<p>Discrepancy is the number of mismatches between a packed (binary) matrix and the maximally packed matrix (with same row sums)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrepancy(mat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="discrepancy_+3A_mat">mat</code></td>
<td>
<p>A matrix (or something that can be transformed into a matrix when <code>as.matrix</code> is called within the function) of species (in columns) on islands (in rows). If quantitative data are given (e.g. in a quantitative pollination network), these are internally transformed into a binary matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Discrepancy is a way to measure the nestedness of a matrix. In a comparative study, Ulrich &amp; Gotelli (2007) showed discrepancy to outperform all other measures and hence recommend its use (together with a fixed-columns, fixed-rows null model, such as implemented in <code>simulate.nullmodel</code> in <span class="pkg">vegan</span>, see example).
</p>
<p>This function follows the logic laid out by Brualdi &amp; Sanderson (1999), although, admittedly, I find their mathematical description highly confusing. Another implementation is given by the function <code>nesteddisc</code> in <span class="pkg">vegan</span>. The reason to write a new function is simple: I wasn't aware of <code>nesteddisc</code>! (I was sitting on a train and I wanted to use this measure later on, so I put it into a function consulting only the orignal paper. When looking for the swap algorithm to create null models, which I somehow knew to exist in <span class="pkg">vegan</span>, I stumbled across <code>nesteddisc</code>. If you are interested in the swap algorithm and come across this help page, let me re-direct you to <code>oecosimu</code> in <span class="pkg">vegan</span>.)
</p>
<p>Now that this function exists, too, I found it to differ in output from <code>nesteddisc</code>. Jari Oksanen was quick to point out, that our two implementations differ in the way they handle ties in column totals. This function is, I think, closer to the results given in Brualdi &amp; Sanderson. Jari also went on to implement different strategies to deal with ties, so my guess is that his version may be (slightly) superior to this one. Having said that, values don't differ much between the two implementations. 
</p>
<p>So what does it do: The matrix is sorted by marginal totals, yielding a matrix <b>A</b>. Then, all 1s in <b>A</b> are &ldquo;pushed&rdquo; to the left to maximally compact the matrix, yielding <b>P</b>. Discrepancy is now simply the number of disagreements between <b>A</b> and <b>P</b>, divided by two (to correct for the fact that every &ldquo;wrong&rdquo; 1 will necessarily generate a &ldquo;wrong&rdquo; 0).
</p>


<h3>Value</h3>

<p>Returns the number of mismatches, i.e. the discrepancy of the matrix from perfecct nestedness.
</p>


<h3>Note</h3>

<p> Discrepancy is well-defined only for matrices that can be sorted uniquely. For matrices with ties no foolproof way to handle them has been proposed. For small matrices, or large matrices with many ties, this will lead to different discrepancy values. See also how <code>nesteddisc</code> in <span class="pkg">vegan</span> handles this issue! (Thanks to Jari Oksanen for pointing this out!)
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann </p>


<h3>References</h3>

 
<p>Brualdi, R.A. and Sanderson, J.G. (1999) Nested species subsets, gaps, and discrepancy. <em>Oecologia</em> <b>119</b>, 256&ndash;264
</p>
<p>Ulrich, W. and Gotelli, N.J. (2007) Disentangling community patterns of nestedness and species co-occurrence. <em>Oikos</em> <b>116</b>, 2053&ndash;2061
</p>


<h3>See Also</h3>

<p><code>nestednodf</code> in <span class="pkg">vegan</span> for the best nestedness algorithm in existence today (for both binary and weighted networks!);  <code><a href="#topic+nestedness">nestedness</a></code> for the most commonly used method to calculate nestedness, <code><a href="#topic+wine">wine</a></code> for a new, unevaluated but very fast way to calculate nestedness; <code>nestedtemp</code> (another implementation of the same method used in our <code>nestedness</code>) and <code>nestedn0</code> (calculating the number of missing species, which has been shown to be a poor measure of nestedness) in <span class="pkg">vegan</span>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#nulls &lt;- replicate(100, discrepancy(commsimulator(Safariland, 
		method="quasiswap")))
nulls &lt;- simulate(vegan::nullmodel(Safariland, method="quasiswap"), nsim = 100)
null.res &lt;- apply(nulls, 3, discrepancy)
hist(null.res)
obs &lt;- discrepancy(Safariland)
abline(v=obs, lwd=3, col="grey")
c("p value"=min(sum(null.res&gt;obs), sum(null.res&lt;obs))/length(null.res))
# calculate Brualdi &amp; Sanderson's Na-value (i.e. the z-score):
c("N_a"=(unname(obs)-mean(null.res))/sd(null.res))

## End(Not run)
</code></pre>

<hr>
<h2 id='distance_w'> Distance in a weighted network </h2><span id='topic+distance_w'></span>

<h3>Description</h3>

<p> The shortest path length, or geodesic distance, between two nodes in a binary network is the minimum number of steps you need to make to go from one of them to the other. This distance is the quickest connection between nodes when all ties are the same. However, in a weighted network, all ties are not the same. See <a href="https://toreopsahl.com/2009/01/09/average-shortest-distance-in-weighted-networks/">https://toreopsahl.com/2009/01/09/average-shortest-distance-in-weighted-networks/</a> for more deatails. </p>


<h3>Usage</h3>

<pre><code class='language-R'> distance_w(net, directed=NULL, gconly=TRUE, subsample=1, seed=NULL) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distance_w_+3A_net">net</code></td>
<td>
<p>A weighted edgelist</p>
</td></tr>
<tr><td><code id="distance_w_+3A_directed">directed</code></td>
<td>
<p> logical, whether the network is directed or undirected. Default is NULL, this means that the function checks whether the edgelist is directed or not.</p>
</td></tr>
<tr><td><code id="distance_w_+3A_gconly">gconly</code></td>
<td>
<p> logical, whether the function should only be calculated for the giant component. Default is TRUE.</p>
</td></tr>
<tr><td><code id="distance_w_+3A_subsample">subsample</code></td>
<td>
<p>Whether a only a subset of starting nodes should we used when calculating the measure. This is particularly useful when running out of memory analysing large networks. If it is set to 1, all distances are analysed. If it set to a value below one, this is roughly the proportion of starting noes that will be analysed. If it is set to an interger greater than 1, this number of starting nodes that will be analysed.</p>
</td></tr>
<tr><td><code id="distance_w_+3A_seed">seed</code></td>
<td>
<p>If a subset of starting nodes is analysed, by setting this parameter, the results are reproducable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> Returns a distance matrix. </p>


<h3>Note</h3>

<p> version 1.0.0, taken, with permission, from package tnet </p>


<h3>Author(s)</h3>

<p> Tore Opsahl; <a href="https://toreopsahl.com/">https://toreopsahl.com/</a> </p>


<h3>References</h3>

 <p><a href="https://toreopsahl.com/2009/01/09/average-shortest-distance-in-weighted-networks/">https://toreopsahl.com/2009/01/09/average-shortest-distance-in-weighted-networks/</a> </p>

<hr>
<h2 id='elberling1999'> No. of visits in a pollination web of arctic-alpine Sweden</h2><span id='topic+elberling1999'></span>

<h3>Description</h3>

<p>This study took place in the subarctic alpine zone of Latnjajaure, in northern Sweden. Field work was conducted from May 21 to August 23, 1994. The objective was to describe the plant-flower visitor interaction matrix of this area and compare it with the characteristics of other subarctic alpine systems and with pollination systems of lower latitudes, especially in relation to the role of flies as flower visitors at high latitudes.
</p>
<p>The authors recorded their data by counting the number of visits of each flower visitor species to each plant species. Regardless of whether insects were observed to forage for nectar and pollen or to perform sun-basking, they were all classified as flower visitors and potential pollinators and the plant species visited were recorded. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>
<p>See also <a href="https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator">https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(elberling1999)</code></pre>


<h3>Format</h3>

<p>A data frame with 12 plant species (in rows) and 102 pollinators (columns).
</p>


<h3>References</h3>

<p>Elberling H. and Olesen J.M. (1999) The structure of a high latitude plant-flower visitor system: the dominance of flies. <em>Ecography</em> <b>22</b>, 314&ndash;323
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(barrett1987)
## maybe str(barrett1987) ; plot(barrett1987) ...
</code></pre>

<hr>
<h2 id='empty'>Deletes empty rows and columns from a matrix.</h2><span id='topic+empty'></span>

<h3>Description</h3>

<p>Gets rid of empty columns and rows in a matrix. Optionally counts removed rows and columns, and returns these values as attribute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>empty(web, count=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="empty_+3A_web">web</code></td>
<td>
<p>A matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey. </p>
</td></tr>
<tr><td><code id="empty_+3A_count">count</code></td>
<td>
<p>Logical. Shall be counted how many columns and rows were removed? Numbers are returned in attribute. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Helper function to remove empty (i.e. all-zero or all-NA) rows and columns, thereby concentrating the matrix. This function is also invoked for its side effect by <code><a href="#topic+extinction">extinction</a></code> to investigate the effect of removing a species from the network.
</p>


<h3>Value</h3>

<p>Returns matrix without empty rows or columns. Its attribute &lsquo;out&rsquo; (if <code>count=TRUE</code>) contains a named vector with the number of rows removed and the number of columns removed.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann </p>


<h3>See Also</h3>

 <p><code><a href="#topic+extinction">extinction</a></code> and <code><a href="#topic+second.extinct">second.extinct</a></code>, which repeatedly call <code>empty</code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
web &lt;- Safariland
web[,5] &lt;- 0
empty(web, count=TRUE)
attr(empty(web), "empty")

</code></pre>

<hr>
<h2 id='endpoint'>Computes end-point degrees for a bipartite network</h2><span id='topic+endpoint'></span>

<h3>Description</h3>

<p>Computes end-point degrees for a bipartite network, following the suggestion of Barrat et al. (2004)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>endpoint(web)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="endpoint_+3A_web">web</code></td>
<td>
<p> A matrix with pollinators as columns and plants as rows. Alternatively, when used on e.g. species occurrences across islands, rows are islands. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computation follows the outline of Gitarranz et al. (2004): &ldquo;the product k_i k_j of the degree of the two nodes connected by that link&rdquo;. We then set additionally endpoint degrees for all non-existing links to 0! Thus, only for existing links endpoint degrees are computed. This is (to me) not obvious from the description in Gitarranz et al. (2004).
</p>


<h3>Value</h3>

<p>A matrix of end-point degrees
</p>


<h3>Note</h3>

<p> This approach is, AFAIK, not tested by simulation; whether it is useful has still to be shown.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann </p>


<h3>References</h3>

 
<p>Barrat, A., M. Barthélemy, R. Pastor-Satorras, and A. Vespignani. 2004. The architecture of complex weighted networks. <em>Proceedings of the National Academy of Sciences of the USA</em> <b>101</b>, 3747-–3752. doi: 10.1073/pnas.0400087101.
</p>
<p>Gilarranz, L. J., J. M. Pastor, and J. Galeano. 2011. The architecture of weighted mutualistic networks. <em>Oikos</em> <b>121</b>, 1154–-1162. doi: 10.1111/j.1600-0706.2011.19592.x.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># reproduces the example of Gitarranz et al. (2011):
data(memmott1999)
ends &lt;- endpoint(memmott1999)
weights.mean &lt;- tapply(memmott1999, ends, mean)
ends.weights &lt;- tapply(ends, ends, mean)
plot(weights.mean, ends.weights, log="xy", pch=16)
</code></pre>

<hr>
<h2 id='extinction'> Simulates extinction of a species from a bipartite network </h2><span id='topic+extinction'></span>

<h3>Description</h3>

<p>Following (how I remember) the paper of Memmott et al. (2004), this function deletes a column (e.g. pollinator) or row (e.g. plant). Only a helper function for <code><a href="#topic+second.extinct">second.extinct</a></code>, really.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extinction(web, participant = "both", method = "random", ext.row=NULL, 
	ext.col=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extinction_+3A_web">web</code></td>
<td>
<p> A matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey. </p>
</td></tr>
<tr><td><code id="extinction_+3A_participant">participant</code></td>
<td>
<p>Which level of participant to remove: <span class="option">lower</span> removes a row, <span class="option">higher</span> removes a row, <span class="option">both</span> randomly picks either row or column.</p>
</td></tr>
<tr><td><code id="extinction_+3A_method">method</code></td>
<td>
<p>Determines sequence of extinctions: <span class="option">random</span> removes a random participant, while <span class="option">abundance</span> removes the least abundant species first. <span class="option">external</span> will use the externally provided vector to determine extinction sequence.</p>
</td></tr>
<tr><td><code id="extinction_+3A_ext.row">ext.row</code></td>
<td>
<p>Optional vector giving the sequence in which lower-level species are to be deleted.</p>
</td></tr>
<tr><td><code id="extinction_+3A_ext.col">ext.col</code></td>
<td>
<p>Optional vector giving the sequence in which higher-level species are to be deleted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In itself rather useless. Called repeatedly by <code><a href="#topic+second.extinct">second.extinct</a></code> to build an extinction sequence and accordingly a sequence of secondary extinctions.
</p>


<h3>Value</h3>

<p>Returns the same matrix that was given as object, just with one row or column being turned into zeros.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann </p>


<h3>References</h3>

 
<p>Memmott, J., Waser, N. M. and Price, M. V. 2004 Tolerance of pollination networks to species extinctions. <em>Proceedings of the Royal Society B</em> <b>271</b>, 2605&ndash;2611
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+second.extinct">second.extinct</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
	data(Safariland)
	(w &lt;- extinction(Safariland, participant="lower", method="abun"))
	empty(w, count=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='fc'>Calculates the functional complementarity for the rows of a web</h2><span id='topic+fd'></span><span id='topic+fc'></span>

<h3>Description</h3>

<p>A community-level measure of ecological niche complementarity measured as the total branch length of a functional dendrogram based on qualitative differences in visitor assemblages between plants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fc(web, dist="euclidean", method="average", weighted=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fc_+3A_web">web</code></td>
<td>
<p>A bipartite interaction web, i.e.~a matrix with higher (cols) and lower (rows) trophic levels.</p>
</td></tr>
<tr><td><code id="fc_+3A_dist">dist</code></td>
<td>
<p>A distance accepted by the function <code><a href="stats.html#topic+dist">dist</a></code>.</p>
</td></tr>
<tr><td><code id="fc_+3A_method">method</code></td>
<td>
<p>The linkage method to be used by <code><a href="stats.html#topic+hclust">hclust</a></code>. Any option accepted by <code><a href="stats.html#topic+hclust">hclust</a></code> is allowed; defaults to <span class="option">"average"</span>.</p>
</td></tr>
<tr><td><code id="fc_+3A_weighted">weighted</code></td>
<td>
<p>Option to analyse the web as binary or as weighted network. Default is <span class="option">weighted=TRUE</span>, but analysis presented in Devoto et al. (2012) uses <span class="option">weighted=FALSE</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>fc measures community-level ecological niche complementarity as the total branch length of a functional dendrogram based on qualitative differences in visitor assemblages between plants. For details see Devoto et al. (2012).
</p>


<h3>Value</h3>

<p>The value of fc, which is not standardised and lies anywhere between 0 and a large number.
</p>


<h3>Author(s)</h3>

<p>Mariano Devoto <a href="mailto:mdevoto@agro.uba.ar">mdevoto@agro.uba.ar</a></p>


<h3>References</h3>

 
<p>Devoto M., Bailey S., Craze P., and Memmott J. (2012) Understanding and planning ecological restoration of plant-pollinator networks.
<em>Ecology Letters</em> <b>15</b>, 319&ndash;328
</p>


<h3>See Also</h3>

<p><code><a href="#topic+networklevel">networklevel</a></code>, which uses this function.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
fc(Safariland)    
fc(t(Safariland), dist="canberra", method="complete")
</code></pre>

<hr>
<h2 id='frame2webs'>Converts a table of observations into a network matrix</h2><span id='topic+frame2webs'></span><span id='topic+edgelist2webs'></span>

<h3>Description</h3>

<p>Convenience function to convert a table of observations (i.e. an &quot;edge list&quot;, typically compiled in a spreadsheet programm) into a network matrix for further use in bipartite.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frame2webs(dframe, varnames = c("lower", "higher", "webID", "freq"), type.out = 
"list", emptylist = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="frame2webs_+3A_dframe">dframe</code></td>
<td>
<p>table (i.e. data.frame) of observations, typically simply the data read by one of the <code>read.*</code> functions; see Details for details!</p>
</td></tr>
<tr><td><code id="frame2webs_+3A_varnames">varnames</code></td>
<td>
<p>a vector of characters giving the column names in the table (data.frame) that correspond to
</p>

<ul>
<li><p> species names in lower trophic level (e.g. plants),
</p>
</li>
<li><p> species names in higher trophic level (e.g. pollinators),
</p>
</li>
<li><p> the grouping factor for a web (e.g. the site on which interactions were observed)
</p>
</li>
<li><p> optionally, a fourth column indicating the number of times an interaction was observed (or another link weight that can be summed);
</p>
</li></ul>

<p>If only three varnames are provided, it is assumed that each observed interaction is in a separate row and frequencies are calculated from the number of rows per link. By default, the names &ldquo;lower&rdquo;, &ldquo;higher&rdquo;, &ldquo;webID&rdquo; and &ldquo;freq&rdquo; are used.</p>
</td></tr>
<tr><td><code id="frame2webs_+3A_type.out">type.out</code></td>
<td>
<p>defines the type of output; it could be <span class="option">list</span> (default) or an <span class="option">array</span> with a separate slice for each network. Lists have the advantage that different webs do not have to include all species names, i.e. they can be of different dimensions (ragged). As such they are better suited for webs with non-comparable species sets. An array has the advantage that dimensions are the same, and therefore (i) comparisons can be easily made among webs and (ii) webs can be pooled more easily. The <span class="option">array</span>-option is more suitable for sets of networks from the same community.</p>
</td></tr>
<tr><td><code id="frame2webs_+3A_emptylist">emptylist</code></td>
<td>
<p>logical, defaults to <span class="option">TRUE</span>; should, for each network in the list of networks, empty columns and rows be deleted? Since this function first builds an array and from that a list, each network contains all possible links between species of the higher and lower level. When set to <span class="option">TRUE</span>, all species not observed for a given network are removed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function supports the easy handling of typical recording that are used to compose a network. The assumed structure of the underlying table is two columns for the names of the lower and higher level species, respectively, one column for a network ID (e.g. site, observer or any other grouping code) and, optionally, a number that indicates how often this interaction was observed. If not given, the number of interactions is simply computed from the number of times the same interaction occurred for each network ID. See example code below. 
</p>
<p>Typically, data are recorded (in a field book or external data logging device), read into a spreadsheet software (such as MS Excel or Open/LibreOffice Spreadsheet), where names are checked, typos corrected and so forth. This table is then imported into R and aggregated into one or more webs (or an array or a list of webs) using <code>frame2webs</code>.
</p>
<p>Each link can have multiple entries or a single entry!
</p>


<h3>Value</h3>

<p>A list or an array of networks, each to be used as input for other <span class="pkg">bipartite</span> functions.
</p>


<h3>Note</h3>

<p>Great care should be taken in checking species names, slightly different spellings will be assumed to be different species! Common problems occur because a space was added to the name or lower and higher case letters were mixed. For example, R is case sensitive and observes white space, while &ldquo;Homo sapiens&rdquo;, &ldquo;Homo sapiens &rdquo; (with a trailing space) and &ldquo;homo sapiens&rdquo; are not recognized as different in typical spreadsheet software (e.g. Excel).
</p>


<h3>Author(s)</h3>

<p> Jochen Fründ </p>


<h3>See Also</h3>

<p><code><a href="#topic+empty">empty</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>testdata &lt;- data.frame(higher = c("bee1","bee1","bee1","bee2","bee1","bee3"), 
lower = c("plant1","plant2","plant1","plant2","plant3","plant4"), 
webID = c("meadow","meadow","meadow","meadow","bog","bog"), freq=c(5,1,1,1,3,7))
frame2webs(testdata,type.out="array")
sapply(frame2webs(testdata,type.out="list"), networklevel, index=c("connectance", "C score"))
</code></pre>

<hr>
<h2 id='genweb'> Generate a random bipartite web </h2><span id='topic+genweb'></span>

<h3>Description</h3>

<p>Generates a random bipartite web, based on <code>r2dtable</code> and lognormal marginal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genweb(N1 = 10, N2 = 30, dens = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genweb_+3A_n1">N1</code></td>
<td>
<p> Number of species in the lower trophic level; or a vector of length 2 giving number of lower and higher trophic level species. Defaults to 10. Large values (&gt;70) will take much longer!</p>
</td></tr>
<tr><td><code id="genweb_+3A_n2">N2</code></td>
<td>
<p> Number of species in the higher trophic level. Ignored if N1 a vector of length 2. Defaults to 30. Large values (&gt;70) will take much longer!</p>
</td></tr>
<tr><td><code id="genweb_+3A_dens">dens</code></td>
<td>
<p> Interaction density, i.e. how many interactions there shall be, on average, for each <em>link</em>. Defaults to 2 (the median observed interaction density in the NCEAS pollination webs). Large values (&gt; 10) will take much longer to find matrices for.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to create simple, but not necessarily realistic, bipartite webs for given dimensionality and interaction density. Marginal distributions are  assumed to be lognormal, mean and standard deviation are calculated from <span class="option">N1</span>, <span class="option">N2</span> and 
<span class="option">dens</span> (see code for details).
</p>


<h3>Value</h3>

<p>A matrix with N1 x N2 species.
</p>


<h3>Note</h3>

<p> Can be a bit time-consuming for large webs, because the absolute values for both dimensions have to match perfectly. This involves a rather inelegant <code>while</code>-loop.</p>


<h3>Author(s)</h3>

<p> Jochen Fründ and Carsten F. Dormann</p>


<h3>Examples</h3>

<pre><code class='language-R'>genweb()
</code></pre>

<hr>
<h2 id='grouplevel'>Analysis of bipartite webs at the level of each of the two levels (groups) of the network</h2><span id='topic+grouplevel'></span><span id='topic+one.grouplevel'></span>

<h3>Description</h3>

<p>Calculates a variety of indices and values for each group of a bipartite network (<code>one.grouplevel</code> is the actual function to do the computations and is not intended to be called by the user)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grouplevel(web, index="ALLBUTDD", level="both", weighted=TRUE, empty.web=TRUE, 
dist="horn", CCfun=mean, logbase="e", normalise=TRUE,  extinctmethod="r", 
nrep=100, fcdist="euclidean", fcweighted=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="grouplevel_+3A_web">web</code></td>
<td>
<p>Web is a matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of host.</p>
</td></tr>
<tr><td><code id="grouplevel_+3A_index">index</code></td>
<td>
<p>One or more of the following (exact match only!):
</p>

<ul>
<li> <p><span class="option">number of species</span> in the respective trophic level,
</p>
</li>
<li> <p><span class="option">mean number of links</span>,
</p>
</li>
<li> <p><span class="option">mean number of shared partners</span>,  
</p>
</li>
<li> <p><span class="option">cluster coefficient</span>, 
</p>
</li>
<li> <p><span class="option">weighted cluster coefficient</span>,  
</p>
</li>
<li> <p><span class="option">togetherness</span>, 
</p>
</li>
<li> <p><span class="option">C score</span>, 
</p>
</li>
<li> <p><span class="option">V ratio</span>, 
</p>
</li>
<li> <p><span class="option">discrepancy</span>, 
</p>
</li>
<li> <p><span class="option">degree distribution</span>, 
</p>
</li>
<li> <p><span class="option">extinction slope</span>, 
</p>
</li>
<li> <p><span class="option">robustness</span>,  
</p>
</li>
<li> <p><span class="option">niche overlap</span>,  
</p>
</li>
<li> <p><span class="option">generality</span>,
</p>
</li>
<li> <p><span class="option">vulnerability</span>,
</p>
</li>
<li> <p><span class="option">partner diversity</span>,

</p>
</li>
<li> <p><span class="option">fc</span> (or alternatively <span class="option">functional complementarity</span>), 
</p>
</li>
<li> <p><span class="option">ALL</span> calculates all the above indices (returning a list (since degree distribution fits are a table within this list and cannot be simplified)), 
</p>
</li>
<li> <p><span class="option">ALLBUTDD</span> (default) calculates all indices except degree distribution fits. This latter has the advantage that the output can be simplified to a vector; 
</p>
</li></ul>

</td></tr>
<tr><td><code id="grouplevel_+3A_level">level</code></td>
<td>
<p>For which of the two groups (&ldquo;levels&rdquo;) should these indices be computed? Options are <span class="option">lower</span>, <span class="option">higher</span> and <span class="option">both</span> (default). For index <span class="option">robustness</span>, the indicated level is the one that will be exterminated in simulations (see <code><a href="#topic+second.extinct">second.extinct</a></code>). Although <code>grouplevel</code> can be employed on its own, it typically will be called through <code><a href="#topic+networklevel">networklevel</a></code>.</p>
</td></tr>
<tr><td><code id="grouplevel_+3A_weighted">weighted</code></td>
<td>
<p>logical; for those indices which are simply averaged across species to yield the group-level index (e.g. <span class="option">niche overlap</span>), should this averaging take into account the number of observations for a species? Defaults to <code>TRUE</code>. The logic behind this default is that we have more faith in an index value when it is based on many, rather than few, observations. Bersier et al. (2002) proposed this weighting and it is also commonly used to compute vulnerability and generality (e.g. in Tylianakis et al. 2006).</p>
</td></tr>

<tr><td><code id="grouplevel_+3A_empty.web">empty.web</code></td>
<td>
<p>Shall the empty columns and rows be deleted? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="grouplevel_+3A_dist">dist</code></td>
<td>
<p>Distance metric to be used to calculate niche overlap (calling <code>vegan::vegdist</code>); defaults to Horn's index, which is the recommendation of Krebs (1989); for other options see <code>vegdist</code> in <span class="pkg">vegan</span>.</p>
</td></tr>
<tr><td><code id="grouplevel_+3A_ccfun">CCfun</code></td>
<td>
<p>Method to use when calculating the clustering coefficient. Originally proposed as mean of cluster coefficients for each node. Defaults to <span class="option">median</span>, because cluster coefficients are strongly skewed. </p>
</td></tr>
<tr><td><code id="grouplevel_+3A_logbase">logbase</code></td>
<td>
<p>Shall various indices (partner diversity, generality/vulnerability) be calculated to the base of e (default) or 2? Log2 is the proposal for generality and vulnerability by Bersier et al. (2002), while Shannon uses ln. The choice of the base will not affect the results qualitatively, at most by a scaling factor.</p>
</td></tr>
<tr><td><code id="grouplevel_+3A_normalise">normalise</code></td>
<td>
<p>Logical; shall the C-score and togetherness metrics be normalised to a range of 0 to 1? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="grouplevel_+3A_extinctmethod">extinctmethod</code></td>
<td>
<p>Specifies how species are removed from matrix: <span class="option">random</span> or <span class="option">abundance</span> (partial matching), where abundance removes species in the order of increasing abundance (i.e. rarest first); see Memmott et al. (2004).</p>
</td></tr>
<tr><td><code id="grouplevel_+3A_nrep">nrep</code></td>
<td>
<p>Number of replicates for the extinction sequence analysis.</p>
</td></tr>
<tr><td><code id="grouplevel_+3A_fcweighted">fcweighted</code></td>
<td>
<p>Logical; when computing &quot;functional complementarity&quot; sensu function <code><a href="#topic+fc">fc</a></code>, should the weights of the matrix be used. Defaults to TRUE, but original paper (Devoto et al. 2012) is based on FALSE.</p>
</td></tr>
<tr><td><code id="grouplevel_+3A_fcdist">fcdist</code></td>
<td>
<p>Distance measure to be used to compute functional complementarity through <code><a href="#topic+fc">fc</a></code>; any measure accepted by <code><a href="stats.html#topic+dist">dist</a></code> is acceptable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements a variety of the many (and still procreating) indices describing network topography at the group level.
</p>
<p>Note that Bersier et al. (2002) have three levels of values for some of their indices: qualitative (i.e. based on binary networks), quantitative (based on networks with information on the number of interactions observed for each link), and weighted-quantitative (where each species is given a weight according to the number of interactions it has). At present, we implement a mixture of qualitative, quantitative and weighted-quantitative indices and offer the option <span class="option">weighted</span> to compute the weighted-quantitative version of some of them (<span class="option">mean number of links</span>, <span class="option">mean number of shared partners</span>, <span class="option">cluster coefficient</span>, <span class="option">partner diversity</span>, <span class="option">generality / vulnerability</span>). For all others, the mechanics behind the index do not allow a weighted mean to be computed (e.g. the distance-matrix between all species combinations used to compute <span class="option">niche.overlap</span>).
</p>
<p>All indices in this function work with real as well as integer values. 
</p>
<p>Extinction slope works on a repeated random sequence of species extinctions (within one trophic level), and calculates the number of secondary extinctions (in the other level). These values are then averaged (over the <span class="option">nrep</span> runs) and plotted against the number of species exterminated. The proportion still recent (on the y-axis) regressed against the proportion exterminated (on the x-axis) is hence standardised to values between 0 and 1 each. Through this plot, a hyperbolic regression is fitted, and the slope of this regression line is returned as an index of extinction sensitivity. The larger the slope, the later the extinction takes its toll on the other trophic level, and hence the higher the redundancy in the trophic level under consideration. Using <span class="option">plot.it=F</span> also returns the graphs (set history to recording in the plotting window). Changing the <span class="option">extinctionmethod</span> to &ldquo;abundance&rdquo; will always result in the same sequence (by increasing abundance) and hence does not require replication.
</p>
<p>Most indices are straightforward, one-line formulae; some, such as betweenness, also require a re-arranging of the matrix; and one, secondary extinction slope, internally requires iterative runs, making the function relatively slow. If you are not interested in the secondary extinction slopes, simply set <span class="option">nrep=1</span> to make it much faster.
</p>


<h3>Value</h3>

<p>The suffixes LL and HL refer to lower and higher level, respectively. If values for both levels are requested, those for the higher level are given first, followed immediately by those for the lower level.
</p>
<p>Depending on the selected indices, some or all of the below (returned as vector if &ldquo;degree distribution&rdquo; was not requested, otherwise as list):
</p>
<table role = "presentation">
<tr><td><code>mean number of species</code></td>
<td>
<p><em>sic</em>, possibly weighted (if <span class="option">weighted=TRUE</span>; the weighted mean is not something typically reported, but it seems a very plausible way to embrace the uncertainty introduced by species with very few interactions).</p>
</td></tr>
<tr><td><code>mean number of links</code></td>
<td>
<p><em>sic</em> (sum of links for each species, averaged over all species in that level), possibly weighted (if <span class="option">weighted=TRUE</span>).</p>
</td></tr>
<tr><td><code>mean number of shared partners</code></td>
<td>
<p>Based on the distance matrix between species, counting the number of species in the other level that both interact with; based on Roberts &amp; Stone (1990) and Stone &amp; Roberts (1992), i.e. for pollinators will yield mean number of plants shared by any two pollinators (Cannot be weighted.)</p>
</td></tr>
<tr><td><code>cluster coefficient</code></td>
<td>
<p>The cluster coefficient for a level is the (weighted) average cluster coefficients of its members. The cluster coefficient for each species, in turn, is simply the number of realised links divided by the number of possible links. Introduced by Watts &amp; Strogatz (1998) and described in Wikipedia under <a href="https://en.wikipedia.org/w/index.php?title=Clustering_coefficient">https://en.wikipedia.org/w/index.php?title=Clustering_coefficient</a>. If you want to use Tore Opsahl's adaptation to two-modes, please see the next index, based on his function <code>clustering_tm</code> in <span class="pkg">tnet</span>. To my knowledge, so far every study has used the &ldquo;wrong&rdquo; one, i.e. the one presented here as <span class="option">cluster coefficient</span>.</p>
</td></tr>
<tr><td><code>weighted cluster coefficient</code></td>
<td>
<p>When asking for &ldquo;weighted cluster coefficient&rdquo;, this version will automatically use interactions as weights unless the data are binary. The computation is based on <code>clustering_tm</code> in <span class="pkg">tnet</span>. See there (and more on Tore Opsahl's webpages) for help.</p>
</td></tr>
<tr><td><code>niche overlap</code></td>
<td>
<p>Mean similarity in interaction pattern between species of that level, calculated by default as Horn's index (use <span class="option">dist</span> to change this.). Values near 0 indicate no common use of niches, 1 indicates perfect niche overlap.</p>
</td></tr>

<tr><td><code>togetherness</code></td>
<td>
<p>Mean number of co-occupancies across all species-combinations; the whole matrix is scanned for submatrices of the form (0,0,1,1), representing perfect matches of co-presences and co-absences. These are counted for each pairwise species combination, and averaged (without weighting). Since the number of species differs between the levels, the same number of co-occupancies will lead to different togetherness-values for the two levels. Based on Stone &amp; Roberts (1992).</p>
</td></tr>
<tr><td><code>C score</code></td>
<td>
<p>(Normalised) mean number of checkerboard combinations across all species of the level. Values close to 1 indicate that there is evidence for disaggregation, e.g. through competition. Value close to 0 indicate aggregation of species (i.e. no repelling forces between species). Since the number of species differs between the levels, the same number of checkerboard patterns will lead to different C-scores for the two levels. See Stone and Roberts (1990) for details.</p>
</td></tr>
<tr><td><code>V ratio</code></td>
<td>
<p>Variance-ratio of species numbers to interaction numbers within species of a level. Values larger than 1 indicate positive aggregation, values between 0 and 1 indicate disaggregation of species. See Schluter (1984) for details.</p>
</td></tr>
<tr><td><code>discrepancy</code></td>
<td>
<p>Discrepancy as proposed by Brualdi &amp; Sanderson (1999); see <code><a href="#topic+discrepancy">discrepancy</a></code> for details.</p>
</td></tr>
<tr><td><code>degree distribution</code></td>
<td>
<p>Coefficients and fits for three different functions to a level's degree distributions: exponential, power law and truncated power law. See <code><a href="#topic+degreedistr">degreedistr</a></code> for details and references.</p>
</td></tr>
<tr><td><code>extinction slope</code></td>
<td>
<p>Slope of the secondary extinction sequence in one level, following extermination of species in the other level; <code>extinction slope.HL</code> refers to the robustness of the higher level to extinctions in the lower level (and vice versa); see <code><a href="#topic+slope.bipartite">slope.bipartite</a></code> and <code><a href="#topic+second.extinct">second.extinct</a></code> for details.</p>
</td></tr>
<tr><td><code>robustness</code></td>
<td>
<p>Calculates the area below the &ldquo;secondary extinction&rdquo; curve; <code>robustness.HL</code> refers to the robustness of the higher level to extinctions in the lower level (and vice versa); see <code><a href="#topic+robustness">robustness</a></code> for details. Corresponds to &ldquo;extinction slope&rdquo;.</p>
</td></tr>
<tr><td><code>functional complementarity</code></td>
<td>
<p>&ldquo;Functional complementarity&rdquo; for a given level. This measure of niche complementarity (as described by Devoto et al. 2012), is computed as the total branch length of a &ldquo;functional dendrogram&rdquo; based on qualitative differences of interactions of one level with the other. Thus, the &ldquo;functional&rdquo; aspect of functional complementarity refers to the function of sharing interactions. Should be highly correlated with niche overlap, only binary.</p>
</td></tr>
<tr><td><code>partner diversity</code></td>
<td>
<p>(Weighted) mean Shannon diversity of the number of interactions for the species of that level. Choose <span class="option">logbase=2</span> to change to a log2-based version.</p>
</td></tr>
<tr><td><code>generality/vulnerability</code></td>
<td>
<p>(Weighted) mean effective number of LL species per HL species (generality; HL species per LL species for vulnerability), weighted by their marginal totals (row sums); see Tylianakis et al. (2007) and Bersier et al. (2002). This is identical to exp(&ldquo;partner diversity&rdquo;, i.e., simply the Jost (2006)-recommended version of diversity.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If your web returns and NA for some of the indices, this can be because the index cannot be computed. For example, if the web is full (i.e. no 0-cells), extinction slopes cannot be fitted (singularity of gradient). Check if you can expect the index to be computable! If it is, and <code>grouplevel</code> doesn't do it, let me know.
</p>
<p>Some indices require rather long computation times on large webs. If you want to increase the speed by omitting some indices, here a rough guide: Ask only for the indices you are interested in! Otherwise, here is the sequence of most time-consuming indices: 
</p>

<ol>
<li><p> For somewhat larger networks (i.e. more than 2 dozen species per level), <span class="option">weighted cluster coefficient</span> is <em>very</em> time consuming (an exhaustive search for 4-loops in the one-mode projection of the network). Omitting it can dramatically boost speed.
</p>
</li>
<li><p> Typically, the slowest function is related to extinction slopes and robustness. Excluding <em>both</em> makes the function faster. 
</p>
</li>
<li><p> Degree distributions are somewhat time consuming. 
</p>
</li></ol>



<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a></p>


<h3>References</h3>

 
<p>Bascompte, J., Jordano, P. and Olesen, J. M. 2006. Asymmetric coevolutionary networks facilitate biodiversity maintenance. <em>Science</em> <b>312</b>, 431&ndash;433
</p>
<p>Bersier, L. F., Banasek-Richter, C. and Cattin, M. F. 2002. Quantitative descriptors of food-web matrices. <em>Ecology</em> <b>83</b>, 2394&ndash;2407
</p>
<p>Blüthgen, N. 2010. Why network analysis is often disconnected from community ecology: A critique and an ecologist's guide. <em>Basic and Applied Ecology</em> <b>11</b>, 185&ndash;195
</p>
<p>Blüthgen, N., Menzel, F., Hovestadt, T., Fiala, B. and Blüthgen N. 2007 Specialization, constraints and conflicting interests in mutualistic networks. <em>Current Biology</em> <b>17</b>, 1&ndash;6
</p>
<p>Devoto M., Bailey S., Craze P., and Memmott J. (2012) Understanding and planning ecological restoration of plant-pollinator networks. <em>Ecology Letters</em> <b>15</b>, 319&ndash;328. 
</p>
<p>Dormann, C.F., Fründ, J., Blüthgen, N., and Gruber, B. (2009) Indices, graphs and null models: analysing bipartite ecological networks. <em>The Open Ecology Journal</em> <b>2</b>, 7&ndash;24.
</p>
<p>Dunne, J. A., R. J. Williams, and N. D. Martinez. 2002 Food-web structure and network theory: the role of connectance and size. <em>Proceedings of the National Academy of Science USA</em> <b>99</b>, 12917&ndash;12922
</p>
<p>Gotelli, N. J., and G. R. Graves. 1996 Null Models in Ecology. Smithsonian Institution Press, Washington D.C.
</p>
<p>Jost, L. 2006. Entropy and diversity. <em>Oikos</em> <b>113</b>, 363-–375. 
</p>
<p>Krebs, C. J. 1989 <em>Ecological Methodology</em>. Harper Collins, New York.
</p>
<p>Memmott, J., Waser, N. M. and Price M. V. 2004 Tolerance of pollination networks to species extinctions. <em>Proceedings of the Royal Society B</em> <b>271</b>, 2605&ndash;2611
</p>
<p>Müller, C. B., Adriaanse, I. C. T., Belshaw, R. and Godfray, H. C. J. 1999 The structure of an aphid-parasitoid community. <em>Journal of Animal Ecology</em> <b>68</b>, 346&ndash;370
</p>
<p>Roberts, A. and Stone, L. 1990 Island-sharing by archipelago species. <em>Oecologia</em> <b>83</b>, 560&ndash;567
</p>
<p>Schluter, D. (1984) A variance test for detecting species associations, with some example applications. <em>Ecology</em> <b>65</b>, 998-1005.
</p>
<p>Stone, L. and Roberts, A. (1990) The checkerboard score and species distributions. <em>Oecologia</em> <b>85</b>, 74&ndash;79.
</p>
<p>Stone, L. and Roberts, A. (1992) Competitive exclusion, or species aggregation? An aid in deciding. <em>Oecologia</em> <b>91</b>, 419&ndash;424
</p>
<p>Tylianakis, J. M., Tscharntke, T. and Lewis, O.T. (2007) Habitat modification alters the structure of tropical host-parasitoid food webs. <em>Nature</em> <b>445</b>, 202&ndash;205
</p>
<p>Watts, D. J. and Strogatz, S. (1998) Collective dynamics of &lsquo;small-world&rsquo; networks. <em>Nature</em> <b>393</b>, 440&ndash;442
</p>


<h3>See Also</h3>

<p> This function can (and typically will) be called, with all its arguments, by <code><a href="#topic+networklevel">networklevel</a></code>. Several indices have their own function as implementation: <code><a href="#topic+second.extinct">second.extinct</a></code>, <code><a href="#topic+degreedistr">degreedistr</a></code>, <code><a href="#topic+C.score">C.score</a></code> and <code><a href="#topic+V.ratio">V.ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Safariland)
grouplevel(Safariland)
grouplevel(Safariland, level="lower", weighted=FALSE) #excludes degree distribution fits

## End(Not run)
</code></pre>

<hr>
<h2 id='H2fun'> Specialisation of a bipartite web. </h2><span id='topic+H2fun'></span>

<h3>Description</h3>

<p>Calculates the overall level of specialisation of all interacting species in a bipartite web.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H2fun(web, H2_integer=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="H2fun_+3A_web">web</code></td>
<td>
<p> A matrix representing the interactions observed between higher trophic  level species (columns) and lower trophic level species (rows). Usually this will  be number of pollinators on each species of plants or number of parasitoids on each species of prey. </p>
</td></tr>
<tr><td><code id="H2fun_+3A_h2_integer">H2_integer</code></td>
<td>
<p>logical; indicates whether web entries are integer numbers. If set to false, H2fun can be used also on rates, percentages and other non-integer values indicating the intensity of an interaction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>H2' is an index describing the level of &ldquo;complementarity specialisation&rdquo; (or should one say: selectiveness?) of an entire bipartite network (Blüthgen et al. 2006). It describes to which extent observed interactions deviate from those that would be expected given the species marginal totals. The more selective a species, the larger is H2' for the web. 
</p>
<p>H2' is an extension of d' (see <code><a href="#topic+dfun">dfun</a></code>) for the entire network. 
</p>
<p>For non-integer values, H2 max can be readily computed and is thus more reliable and much faster.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>H2</code></td>
<td>
<p>The H2'-value for the web matrix.</p>
</td></tr>
<tr><td><code>H2min</code></td>
<td>
<p>Heuristic minimum H2-value for the web matrix.</p>
</td></tr>
<tr><td><code>H2max</code></td>
<td>
<p>Heuristic maximum H2-value for the web matrix.</p>
</td></tr>
<tr><td><code>H2uncorr</code></td>
<td>
<p>Uncorrected H2-values (before ranging between min and max), rounded  to three digits.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Carsten F. Dormann and Jochen Fründ </p>


<h3>References</h3>

 
<p>Blüthgen, N., Menzel, F. and Blüthgen, N. (2006) Measuring specialization in species interaction networks. <em>BMC Ecology</em> <b>6</b>, 9.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+dfun">dfun</a></code> following the same idea for each species in the web matrix. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
H2fun(Safariland)
</code></pre>

<hr>
<h2 id='inouye1988'> A pollination network from the Snowy Mountains of New South Wales, Australia</h2><span id='topic+inouye1988'></span>

<h3>Description</h3>

<p>This data set reports a community-level study of the pollination biology of alpine plants in Kosciusko National Park in the Snowy Mountains of south-eastern New South Wales, Australia. The flora and their associated insect pollinators were observed from December 1983 until March 1984.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(inouye1988)</code></pre>


<h3>Format</h3>

<p>A data frame with 41 observations on the following 83 variables, with plant species in rows and pollinators in columns.
</p>


<h3>Details</h3>

<p>The authors recorded their data by counting the number of individual flower visitors caught on each plant species. The total number of individuals collected on each plant species provide a rough estimate of the level of visitation that each species received. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>Note</h3>

<p>Male and female pollinators were summed when moving this data set from NCEAS to bipartite.
</p>


<h3>Source</h3>

<p>NCEAS data base on interaction webs: <a href="https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator">https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator</a>
</p>


<h3>References</h3>

<p>Inouye, D.W. and G.H. Pyke (1988) Pollination biology in the Snowy Mountains of Australia: comparisons with montane Colorado, USA. <em>Australian Journal of Ecology</em> <b>13</b>: 191&ndash;210. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(inouye1988)
plotweb(inouye1988)
</code></pre>

<hr>
<h2 id='junker2013'>
Flower visitation network
</h2><span id='topic+junker2013'></span>

<h3>Description</h3>

<p>A large (56 plant species by 257 visitor species) network published by Junker et al. (2013). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(junker2013)</code></pre>


<h3>Format</h3>

<p>The format is:
int [1:56, 1:257] 0 0 0 0 0 0 1 0 0 0 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:56] &quot;Achillea.millefolium&quot; &quot;Alliaria.petiolata&quot; &quot;Bellis.perennis&quot; &quot;Bunias.orientalis&quot; ...
..$ : chr [1:257] &quot;Agrypnus.murinus&quot; &quot;Ampedus.pomorum&quot; &quot;Anaspis.frontalis&quot; &quot;Anthaxia.nitidula&quot; ...
</p>


<h3>Details</h3>

<p>I modified some entries in the table: (1) There were two instances of Prunus.sp.1.Kirsche (cherry), which I summed and represented as one. Similarly, there (2) two species named Apidae_sp._1 and Apidae_sp.1 which I merged and (3) the exact same thing for Apidae_sp._2 and Apidae_sp.2. In all cases, only one or two observations were added to the column containing more counts. I do not think that these changes will have any effect on the analyses.
</p>


<h3>References</h3>

<p>Junker, R. R., Blüthgen, N., Brehm, T., Binkenstein, J., Paulus, J., Schaefer, H. M. and Stang, M. 2013. Specialization on traits as basis for the niche-breadth of flower visitors and as structuring mechanism of ecological networks. <em>Functional Ecology</em> <b>27</b>, 329–-341
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(junker2013)
## Not run: plotweb(junker2013)
</code></pre>

<hr>
<h2 id='kato1990'> No. of individuals caught in a pollination web of a Japanese beech forest</h2><span id='topic+kato1990'></span>

<h3>Description</h3>

<p>The study took place at the Kyoto University Forest of Ashu, at the northeastern boundry of the Kyoto Prefecture in Japan, between 1984 and 1987. The paper deals with the flowering phenology of 91 plant species, the community structure of flower-visiting insects, and the spectrum of floral hosts for flower visitors. The emphasis is laid on the pattern of community organization of flower-visiting insects in a primary forest ecosystem of western Japan.
</p>
<p>The authors recorded their data by counting the number of individual flower visitors caught on each plant species. The total number of individuals collected on each plant species provide a rough estimate of the level of visitation that each species received. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction. For details and data see <a href="https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator">https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(kato1990)</code></pre>


<h3>References</h3>

<p>Kato, M., T. Makutani, T. Inoue, and T. Itino. 1990. Insect-flower relationship in the primary beech forest of Ashu, Kyoto: an overview of the flowering phenology and seasonal pattern of insect visits. <em>Contr. Biol. Lab. Kyoto Univ.</em> <b>27</b>, 309&ndash;375
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kato1990)
## maybe str(kato1990) ; plot(kato1990) ...
</code></pre>

<hr>
<h2 id='kevan1970'> A pollination network from Northern Ellesmere Island, Canada</h2><span id='topic+kevan1970'></span>

<h3>Description</h3>

<p>The total number of individuals collected on each plant species provide a rough estimate of the level of visitation that each species received.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(kevan1970)</code></pre>


<h3>Details</h3>

<p>General information
</p>
<p>This study sought to determine the importance of insect-flower relations to both plants and insects in a high arctic community as well as the degree to which some of the more common arctic plants are dependent on insects for pollination and reproduction. The research was conducted in 1967 at Hazen Camp (81 49'N, 71 18' W) near Lake Hazen on Northern Ellesmere Island, the most northerly island of the Canadian Arctic Archipelago.
</p>
<p>Data type
</p>
<p>The authors recorded their data by counting the number of individual flower visitors caught on each plant species. The total number of individuals collected on each plant species provide a rough estimate of the level of visitation that each species received. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>References</h3>

<p>Kevan, P. G. 1970. High Arctic Insect-Flower Visitor Relations: The Inter-Relationships of Arthropods and Flowers at Lake Hazen, Ellesmere Island, Northwest Territories. University of Alberta, Canada.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kevan1970)
</code></pre>

<hr>
<h2 id='linklevel'>Indices of a bipartite network at the link level</h2><span id='topic+linklevel'></span>

<h3>Description</h3>

<p>Computes various indices of a network at the link-level, i.e. for each cell of the network matrix</p>


<h3>Usage</h3>

<pre><code class='language-R'>linklevel(web, index=c("dependence", "endpoint"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linklevel_+3A_web">web</code></td>
<td>
<p> A matrix with pollinators as columns and plants as rows. Alternatively, when used on e.g. species occurrences across islands, rows are islands. </p>
</td></tr>
<tr><td><code id="linklevel_+3A_index">index</code></td>
<td>
<p>Vector of indices to be computed at the link level; options are: 
</p>

<ul>
<li> <p><span class="option">dependence</span> to compute dependence-matrix for each group level;
</p>
</li>
<li> <p><span class="option">endpoint</span> to compute end-point degrees following Barratt et al. (2004).
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>For summaries of such indices see <code><a href="#topic+networklevel">networklevel</a></code>. It's still early days for this function ...
</p>


<h3>Value</h3>

<p>Returns a list of indices, each entry being a matrix of the same dimensions as the input web.
</p>


<h3>Note</h3>

<p> This function aims to facilitate analyses at the link level. So far, most studies at this level did not correct for the fact that observations per cell are clearly non-independent, nor for the abundances of the species, which also greatly affect indices. Room for improvement, but little room for new findings ...
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a> </p>


<h3>References</h3>

 
<p>Barrat, A., Barthélemy, M., Pastor-Satorras, R. &amp; Vespignani, A. (2004) The architecture of complex weighted networks. <em>Proceedings of the National Academy of Sciences of the USA</em> <b>101</b>, 3747-–3752
</p>


<h3>See Also</h3>

<p><code><a href="#topic+endpoint">endpoint</a></code>, <code><a href="#topic+specieslevel">specieslevel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
linklevel(Safariland)
</code></pre>

<hr>
<h2 id='listModuleInformation'>listModuleInformation</h2><span id='topic+listModuleInformation'></span>

<h3>Description</h3>

<p>This function takes an object of class &quot;moduleWeb&quot; and returns information about the names of the nodes of which the computed modules exist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listModuleInformation(moduleWebObject)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="listModuleInformation_+3A_modulewebobject">moduleWebObject</code></td>
<td>
<p>Object of class &quot;moduleWeb&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the function is a list of lists of lists of vectors representing the names of the nodes involved in a certain module.
</p>
<table role = "presentation">
<tr><td><code>value[[x]][[y]][[1]]</code></td>
<td>
<p>vector with the names of the &quot;row nodes&quot; comprised by the z.th module in depth x-1 (sic!)</p>
</td></tr>
<tr><td><code>value[[x]][[y]][[2]]</code></td>
<td>
<p>vector with the names of the &quot;column nodes&quot; comprised by the z.th module in depth x-1 (sic!)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rouven Strauss</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(small1976)

moduleWebObject = computeModules(small1976);
moduleList = listModuleInformation(moduleWebObject);

## End(Not run)
</code></pre>

<hr>
<h2 id='memmott1999'> Flower visitation network from a meadow near Bristol, UK</h2><span id='topic+memmott1999'></span>

<h3>Description</h3>

<p>This study was conducted in a 150 m x 250 m meadow plot in the vicinity of Bristol, U.K. in July 1997. The objective was to describe the plant-flower visitor interaction web of this area, taking into account species abundances and their frequency of interaction. Twenty five plant species were studied, and 79 flower visitor species were recorded visiting them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(memmott1999)</code></pre>


<h3>Details</h3>

<p>The author recorded her data by counting the number of visits of each flower visitor species to each plant species, and by independently measuring the abundance of plant and animal taxa. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>Source</h3>

<p>NCEAS
</p>


<h3>References</h3>

<p>Memmott, J. 1999. The structure of a plant-pollinator food web. <em>Ecology Letters</em><b>2</b>, 276&ndash;280.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(memmott1999)
## maybe str(memmott1999) ; plot(memmott1999) ...
</code></pre>

<hr>
<h2 id='mgen'>Generate simulated network according to a given probability matrix</h2><span id='topic+mgen'></span>

<h3>Description</h3>

<p>Generic network simulating algorithm based on a probability matrix and a desired number of interactions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mgen(web, n=sum(web), keep.species=TRUE, rep.cell=TRUE, autotransform="sum_warn")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mgen_+3A_web">web</code></td>
<td>
<p>a matrix with observation (interaction) probabilities, emerging from some considerations (model) external to this function; if an original network is used, it will be converted to a probability matrix by dividing it by its sum.</p>
</td></tr>
<tr><td><code id="mgen_+3A_n">n</code></td>
<td>
<p>number of interactions to allocate into the new matrix. Note that in rare cases, the number of interactions assigned may be larger than n due to <span class="option">keep.species=TRUE</span>.</p>
</td></tr>
<tr><td><code id="mgen_+3A_keep.species">keep.species</code></td>
<td>
<p>Ensure each species has at least one interaction? Random assignment of interactions may lead to empty columns or rows and hence reduce the dimensions of the simulated web. By default, this is prevented from happening, i.e. each row/column will receive at least one interaction. Setting <span class="option">keep.species</span> to FALSE may (but need not) cause a loss of species.</p>
</td></tr>
<tr><td><code id="mgen_+3A_rep.cell">rep.cell</code></td>
<td>
<p>Whether cells can be assigned interactions repeatedly; defaults to TRUE (quantitative webs); use FALSE for binary webs</p>
</td></tr>
<tr><td><code id="mgen_+3A_autotransform">autotransform</code></td>
<td>
<p>determines how a non-probability web is converted into probabilities; option <span class="option">"sum"</span> simply divides each entry by the sum of interactions in the web (i.e. probabilities will be proportional to web entries); option <span class="option">"sum_warn"</span> (the default) does the same, but with a warning;  option <span class="option">"equiprobable"</span> is an odd name for making probabilities proportional to the product of marginal totals</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function to simulate mutualistic networks, based on the original function with the same name used by Vázquez et al. (2009). This function can be used for different purposes, as it allows any type of probability matrix to be used for constructing the simulated matrices. However, this probability matrix must be derived from some other model, either fully synthetic or based on empirical data (if an observed network is given, it will sample from observed interactions, but this is not the typical use case). This function can thus be used for implementing various types of null models, but also highly structured or specialised webs.
</p>
<p>The use of an externally generated probability matrix is a key difference to <code>genweb</code> and functions (methods) in <code>nullmodel</code>. Nevertheless, <span class="option">autotransfrom="equiprobable"</span> turns <code>mgen</code> into a null model function, with interaction probabilities according to marginal totals (row and column sums). This null model does not fix row and column totals (otherwise it is similar to the <code>r2dtable</code> null model) nor connectance (in difference to <code>vaznull</code>); also, if <span class="option">keep.species=FALSE</span>, species may be lost (i.e. have no interactions) by chance.
</p>
<p>If <span class="option">rep.cell=TRUE</span>, repeated interactions are added, thus generating a quantitative matrix with cell values as positive integers. In this case, connectance is not fixed or constrained.
If <span class="option">rep.cell=FALSE</span>, no repeated assignment of interactions is allowed, thus generating a binary matrix of zeros and ones. Note that when <span class="option">rep.cell=FALSE</span> the number of interactions to be assigned must be equal or lower than the number of (nonzero) cells in the matrix. If also <span class="option">keep.species=TRUE</span>, connectance is fixed (<code>n / prod(dim(web))</code>).
</p>


<h3>References</h3>

<p>Vázquez, D. P.; Chacoff, N. P. &amp; Cagnolo, L. 2009. Evaluating multiple determinants of the structure of mutualistic networks. <em>Ecology</em> <b>90</b> 2039&ndash;2046
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate simulated matrix from homogeneous probability matrix
probmat &lt;- matrix(1/100, 10, 10)
mgen(web=probmat, n=100)

## Generate binary matrix with probability proportional to degree
## of an observed binary matrix m
obs.mat &lt;- matrix(c(1,1,1,1,1,1,1,1,1,0,1,1,1,0,0,1,1,0,0,0,1,0,0,0,0), 5, 5)
rs &lt;- rowSums(obs.mat)
cs &lt;- colSums(obs.mat)
web &lt;- rs %*% t(cs)
web &lt;- web/sum(web)
n = sum(obs.mat)
# Allowing zero marginal sums (but there will be none here):
mgen(web, n, keep.species=FALSE, rep.cell=FALSE) 
# Not allowing zero marginal sums:
mgen(web, n, keep.species=TRUE, rep.cell=FALSE) 

## Generate quantitative matrix with probability proportional
## to interaction frequency in an observed matrix m:
# Allowing zero marginal sums:
mgen(mosquin1967, keep.species=FALSE, rep.cell=TRUE) 
# Not allowing zero marginal sums: 
mgen(mosquin1967, keep.species=TRUE, rep.cell=TRUE) 
</code></pre>

<hr>
<h2 id='moduleWeb-class'>Class &quot;moduleWeb&quot;</h2><span id='topic+moduleWeb-class'></span>

<h3>Description</h3>

<p>This class is the output of an application of the function <code>computeModules</code> to a graph. It consists of the matrix representing the original graph which has been passed to <code>computeModules</code> in order to compute modules, a matrix representing the same graph but permutated according to the identified modules, two vectors indicating the permutation of row and column indices, respectively, and information about the modules themselves.
</p>


<h3>Objects from the class</h3>

<p>Objects from the class should only be created by using the function <code>computeModules</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>likelihood</code>:</dt><dd><p>Contains a number with the likelihood-equivalent of the final proposed module structure. This value is the same value as Q (or M), the modularity as given by Newman or Guimerà &amp; Amaral (2005). </p>
</dd>	 
<dt><code>originalWeb</code>:</dt><dd><p>Object of class <code>"matrix"</code> representing the original bipartite graph in which modules have been computed.</p>
</dd>
<dt><code>moduleWeb</code>:</dt><dd><p>Object of class <code>"matrix"</code> representing the original bipartite graph but reordered such that plotting modules is possible.</p>
</dd>
<dt><code>orderA</code>:</dt><dd><p>Object of class <code>"vector"</code> representing the permutation of the rows of the original graph.</p>
</dd>
<dt><code>orderB</code>:</dt><dd><p>Object of class <code>"vector"</code> representing the permutation of the columns of the original graph.</p>
</dd>
<dt><code>modules</code>:</dt><dd><p>Object of class <code>"matrix"</code> containing for each module the information about its depth and involved nodes. The first row is just a consecutive number, so of no information; the first two columns can also be ignored. This matrix shows ALL network players (in the sequence of the original matrix, starting with rows), so first rows, then columns. There are as many rows as modules. Each row writes a number if a species is in that module, or a 0 if it isn't. For the modules of Safariland (<code>mod &lt;- computeModules(Safariland); mod@modules[-1, -c(1,2) ]</code>), the third module are species 3 and 24, i.e. <em>Schinus patagonicus</em> (third row) and Ichneumonidae4 (24 - 9 column).</p>
</dd>
</dl>



<h3>Methods</h3>

<p>Objects of this class are used in following functions:
</p>
<p>listModuleInformation(moduleWebObject)
</p>
<p>printoutModuleInformation(moduleWebObject)
</p>
<p>plotModuleWeb(moduleWebObject, plotModules=TRUE, rank=FALSE, weighted=TRUE, displayAlabels=TRUE, displayBlabels=TRUE, labsize=1, plotsize=12, xlabel=&quot;&quot;, ylabel=&quot;&quot;, square.border=&quot;white&quot;, fromDepth=0, upToDepth=-1)
</p>


<h3>Author(s)</h3>

<p>Rouven Strauss</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("moduleWeb")
</code></pre>

<hr>
<h2 id='mosquin1967'> Flower visitation network from Melville Island, Northwest Territories, Canada</h2><span id='topic+mosquin1967'></span>

<h3>Description</h3>

<p>This study took place on Melville Island, N.W.T., Canada from July 19 to July 31 1965. While collecting plants the authors made some observations on the occurence and behavior of flower visiting insects as well as on the scent and other target characteristics of flowers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mosquin1967)</code></pre>


<h3>Details</h3>

<p>The authors recorded their data by counting the number of individual flower visitors caught on each plant species. The total number of individuals collected on each plant species provide a rough estimate of the level of visitation that each species received. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>Source</h3>

<p>NCEAS</p>


<h3>References</h3>

<p>Mosquin, T., and J. E. H. Martin. 1967. Observations on the pollination biology of plants on Melville Island, N.W.T., Canada. <em>Canadian Field Naturalist</em> <b>81</b>, 201&ndash;205
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mosquin1967)
## maybe str(mosquin1967) ; plot(mosquin1967) ...
</code></pre>

<hr>
<h2 id='motten1982'>A spring flower visitation network from North Carolina, USA</h2><span id='topic+motten1982'></span>

<h3>Description</h3>

<p>This is a study of the interactions between insects visitors and spring wildflowers in piedmont North Carolina. Spring flowering, entomophilous herbs, shrubs, and understory trees were included in the study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(motten1982)</code></pre>


<h3>Details</h3>

<p>The author recorded his data by counting the number of visits of each flower visitor species to each plant species. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>References</h3>

<p>Motten, A.F. (1982) Pollination Ecology of the Spring Wildflower Community in the Deciduous Forests of Piedmont North Carolina. Doctoral Dissertation thesis, Duke University, Durham, North Carolina, USA.
</p>
<p>Motten, A.F. (1986) Pollination ecology of the spring wildflower community of a temperate deciduous forest. <em>Ecological Monographs</em> <b>56</b>, 21&ndash;42
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(motten1982)
## maybe str(motten1982) ; plot(motten1982) ...
</code></pre>

<hr>
<h2 id='ND'>Normalised degree, betweenness and closeness centrality</h2><span id='topic+ND'></span><span id='topic+BC'></span><span id='topic+CC'></span>

<h3>Description</h3>

<p>Calculates normalised degrees, and two measures of centrality, betweenness and closeness. These two are based on one-mode representations of the network and invoke functions from <span class="pkg">sna</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ND(web, normalised=TRUE)
BC(web, rescale=TRUE, cmode="undirected", weighted=TRUE, ...)
CC(web, cmode="suminvundir", rescale=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ND_+3A_web">web</code></td>
<td>
<p>A matrix with lower trophic level species as rows, higher trophic level species
as columns and number of interactions as entries.</p>
</td></tr>
<tr><td><code id="ND_+3A_normalised">normalised</code></td>
<td>
<p>Shall the degrees be normalised? If so (default), the degree for a species is divided by the number of species in the other level (see, e.g., Martín González et al. 2010).</p>
</td></tr>
<tr><td><code id="ND_+3A_rescale">rescale</code></td>
<td>
<p>If TRUE (default), centrality scores are rescaled such that they sum to 1.</p>
</td></tr>
<tr><td><code id="ND_+3A_cmode">cmode</code></td>
<td>
<p>String indicating the type of betweenness/closeness centrality being computed (directed or undirected geodesics, or a variant form - see help for <code>closeness</code> and <code>betweenness</code> in <span class="pkg">sna</span> for details). The default, <span class="option">"suminvundir"</span> for <code>CC</code> and <span class="option">"undirected"</span> for <code>BC</code>, uses a formula that can also be applied to disconnected (=compartmented) graphs. Other cmodes may not.</p>
</td></tr>
<tr><td><code id="ND_+3A_weighted">weighted</code></td>
<td>
<p>Logical; if TRUE, bipartite projection will include edge weights, i.e. number of interactions. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="ND_+3A_...">...</code></td>
<td>
<p>Options passed on to <code>betweenness</code> and <code>closeness</code>, respectively. Notice that in particular the option <span class="option">ignore.eval=FALSE</span> will yield VERY different values than the default. BC and CC use defaults of <code>sna::betweenness</code> and <code>sna::closeness</code>, respectively, but that does not imply that these settings are per se the best! (Thanks to Michael Pocock for drawing my attention to this issue!)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are convenience functions to enable easy reproduction of the type of analyses by Martín González et al. (2010). BC and CC are wrappers calling two functions from <span class="pkg">sna</span>, which uses one-mode, rather than bipartite data. 
</p>
<p>One-mode projections of two-mode networks are carried out by assigning a link to two species that share a interaction with a member of the other set (plant in case of pollinators, or pollinators in case of plants). There are different ways to do this (see <code><a href="#topic+as.one.mode">as.one.mode</a></code>), and many authors do not communicate well, which approach they have taken.
</p>
<p>If the network is fully connected, all species of the same level will be linked to each other through only one step and hence have the same betweenness. This leads to values of 0.
</p>
<p>BC reflects the number of unique shortest paths going through the focal node. Note that different packages compute divergent values for betweenness, as detailed in the vignette (section 5.4.1)! CC is the inverse of the average distance from the focal node to all other nodes.
</p>
<p>Both BC and CC can be normalised so that they sum to 1 (using <span class="option">rescale=TRUE</span>). This only affects the absolute values, but not the qualitative results.
</p>
<p>The interested user may want to also have a look at the networkX homepage (<a href="https://networkx.org">https://networkx.org</a>) for a Python-based tool to analyse, depict and manipulate (one-mode) networks. It is not specifically meant for bipartite networks such as this package, though.
</p>


<h3>Value</h3>

<p>A list with two entries, &ldquo;lower&rdquo; and &ldquo;higher&rdquo;, which contain a named vector of normalised degrees, betweenness centrality and closeness centrality, respectively. The lower-entry contains the lower trophic level species, the higher analogously the higher trophic level species.
</p>


<h3>Note</h3>

 
<p>Experimental. Should work most of the time, but not necessarily always. Also, on trials with the same data as those of Martín González et al. (2010), numerical values differed. Whether this is due to rounding errors, different non-linear least square fits in JMP and R or whatever I cannot tell. See example for my attempt to reproduce their values for the network &ldquo;Azores&rdquo; (aka <code><a href="#topic+olesen2002flores">olesen2002flores</a></code>).
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a> </p>


<h3>References</h3>

<p>Martín Gonzáles, A.M., Dalsgaard, B. and Olesen, J.M. 2010. Centrality measures and the importance of generalist species in pollination networks. <em>Ecological Complexity</em> <b> 7</b>, 36&ndash;41
</p>


<h3>See Also</h3>

<p><code>centralization</code>, <code>betweenness</code> and <code>closeness</code> in <span class="pkg">sna</span>; <code><a href="#topic+specieslevel">specieslevel</a></code> which calls them
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example:
data(olesen2002flores)
(ndi &lt;- ND(olesen2002flores))
(cci &lt;- CC(olesen2002flores))
(bci &lt;- BC(olesen2002flores))

cor.test(bci[[1]], ndi[[1]], method="spear") # 0.532
cor.test(cci[[1]], ndi[[1]], method="spear") # 0.403

cor.test(bci[[2]], ndi[[2]], method="spear") # 0.738
cor.test(cci[[2]], ndi[[2]], method="spear") # 0.827
## Not run: 
## PLANTS:
bc &lt;- bci[[1]]
cc &lt;- cci[[1]]
nd &lt;- ndi[[1]]
# CC:
summary(nls(cc ~ a*nd+b, start=list(a=1,b=1))) # lower RSE
summary(nls(cc ~ c*nd^d, start=list(c=0.072,d=0.2))) 
# BC:
summary(nls(bc ~ a*nd+b, start=list(a=1,b=1)))
summary(nls(bc ~ c*nd^d, start=list(c=2,d=2))) # lower RSE

## ANIMALS:
bc &lt;- bci[[2]]
cc &lt;- cci[[2]]
nd &lt;- ndi[[2]]
# CC:
summary(nls(cc ~ a*nd+b, start=list(a=1,b=1)))  
summary(nls(cc ~ c*nd^d, start=list(c=0.2,d=2))) # lower RSE 
# BC:
summary(nls(bc ~ a*nd+b, start=list(a=1,b=1)))
summary(nls(bc ~ c*nd^d, start=list(c=0.2,d=2))) # lower RSE

## End(Not run)
</code></pre>

<hr>
<h2 id='nest.smdm'> Computes nestedness of a matrix as WNODA (and NODF and WNODF) </h2><span id='topic+nest.smdm'></span><span id='topic+NODF'></span><span id='topic+WNODF'></span><span id='topic+WNODA'></span><span id='topic+module2constraints'></span>

<h3>Description</h3>

<p>Calculates network nestedness, also within and between modules, i.e. separate nestednesses for nodes belonging to the same module and between nodes belonging to different modules. Three nestedness metrics are implemented in the function: NODF, WNODF and WNODA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nest.smdm(x, constraints=NULL, weighted=FALSE, decreasing="fill", sort=TRUE)
  module2constraints(mod)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nest.smdm_+3A_x">x</code></td>
<td>
<p>an interaction matrix; typically with rows for lower and columns for higher level species;</p>
</td></tr>
<tr><td><code id="nest.smdm_+3A_constraints">constraints</code></td>
<td>
<p>a vector with modules for vertices of the matrix. The vector indicates first rows modules and then columns modules, following the sequence of input matrix x. If no constraints are provided, the function calculates nestedness for the entire matrix, not taking into account possible network modules.</p>
</td></tr>
<tr><td><code id="nest.smdm_+3A_weighted">weighted</code></td>
<td>
<p>Logical. Indicate whether to calculate binary or weighted version of the metrics. If set to FALSE for a weighted input matrix, the binary metric is calculated, but a warning is returned.</p>
</td></tr>
<tr><td><code id="nest.smdm_+3A_decreasing">decreasing</code></td>
<td>
<p>The matrix has to be sorted before computation of (W)NODA. This can be done either by <span class="option">"fill"</span>, i.e. sum of cells with non-zero values, or <span class="option">"abund"</span>, i.e. sum of cell values. For a binary matrix decreasing needs to be <span class="option">"fill"</span> (as no abundances are available). For weighted matrices, the argument may be <span class="option">"fill"</span> (yielding WNODF) or <span class="option">"abundance"</span> (yielding WNODA).</p>
</td></tr>
<tr><td><code id="nest.smdm_+3A_sort">sort</code></td>
<td>
<p>Logical. Should columns and rows of the matrix be sorted, in order to maximize nestedness index?</p>
</td></tr>
<tr><td><code id="nest.smdm_+3A_mod">mod</code></td>
<td>
<p>Output of a <code><a href="#topic+computeModules">computeModules</a></code>-object. Returns a vector to be used as input for <span class="option">constraints</span>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function returns a list with elements
</p>
<table role = "presentation">
<tr><td><code>WNODArow</code></td>
<td>
<p>Nestedness for rows</p>
</td></tr>
<tr><td><code>WNODAcol</code></td>
<td>
<p>Nestedness for columns</p>
</td></tr>
<tr><td><code>WNODAmatrix</code></td>
<td>
<p>Nestedness for entire matrix</p>
</td></tr>
</table>
<p>If constraints are provided, e.g. based on <code><a href="#topic+computeModules">computeModules</a></code>, output additionally includes:
</p>
<table role = "presentation">
<tr><td><code>WNODA_SM_row</code></td>
<td>
<p>Nestedness for rows belonging to the same modules</p>
</td></tr>
<tr><td><code>WNODA_DM_row</code></td>
<td>
<p>Nestedness for rows belonging to different modules</p>
</td></tr>
<tr><td><code>WNODA_SM_col</code></td>
<td>
<p>Nestedness for columns belonging to the same modules</p>
</td></tr>
<tr><td><code>WNODA_DM_col</code></td>
<td>
<p>Nestedness for columns belonging to different modules</p>
</td></tr>
<tr><td><code>WNODA_SM_matrix</code></td>
<td>
<p>Nestedness for nodes (rows and columns) belonging to the same modules</p>
</td></tr>
<tr><td><code>WNODA_DM_matrix</code></td>
<td>
<p>Nestedness for nodes (rows and columns) belonging to different modules</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Rafael Barros Pereira Pinheiro <a href="mailto:rafael-bpp@hotmail.com">rafael-bpp@hotmail.com</a>, Gabriel Felix, Marco Mello, and the team of the Ecological Synthesis Lab, University of São Paulo </p>


<h3>References</h3>

<p>Almeida-Neto M, Guimaraes PR, Guimaraes PR Jr, Loyola RD, Ulrich W (2008) A consistent metric for nestedness analysis in ecological systems: reconciling concept and measurement. <em>Oikos</em> <b>117</b>: 1227&ndash;1239
</p>
<p>Almeida-Neto, M. &amp; Ulrich, W. (2011). A straightforward computational approach for measuring nestedness using quantitative matrices. <em>Environ. Model. Softw.</em> <b>26</b>: 173&ndash;178
</p>
<p>Felix, G.M., Pinheiro, R.B.P., Poulin, R., Krasnov, B.R. &amp; Mello, M.A.R. (2017). The compound topology of a continent-wide interaction network explained by an integrative hypothesis of specialization. <em>bioRxiv</em>
</p>
<p>Flores, C.O., Valverde, S. &amp; Weitz, J.S. (2013). Multi-scale structure and geographic drivers of cross-infection within marine bacteria and phages. <em>ISME J.</em> <b>7</b>: 520&ndash;532
</p>


<h3>See Also</h3>

<p><code>vegan::nestedNODF</code>, <code><a href="#topic+computeModules">computeModules</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>nest.smdm(Safariland)
nest.smdm(Safariland, weighted=TRUE)
nest.smdm(Safariland, weighted=TRUE, decreasing="abund")
nest.smdm(Safariland, weighted=TRUE, decreasing="abund", sort=FALSE)
# identify modules using computeModules:
mod &lt;- computeModules(Safariland)
const &lt;- module2constraints(mod)
nest.smdm(Safariland, constraint=const)
nest.smdm(Safariland, constraint=const, weighted=TRUE)
</code></pre>

<hr>
<h2 id='nested'>
Calculates any of several measures of nestedness
</h2><span id='topic+nested'></span>

<h3>Description</h3>

<p>Wrapper function calling one, several or all currently implemented nestedness measures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nested(web, method = "binmatnest", rescale=FALSE, normalised=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nested_+3A_web">web</code></td>
<td>
<p>A matrix with elements of a set (e.g. plants) as rows, elements of a second set (e.g. pollinators) as columns and number of interactions as entries.</p>
</td></tr>
<tr><td><code id="nested_+3A_method">method</code></td>
<td>
<p>One or more of the following: <span class="option">discrepancy</span>, <span class="option">discrepancy2</span>, <span class="option">binmatnest</span>, <span class="option">NODF</span>, <span class="option">NODF2</span>, <span class="option">C score</span>, <span class="option">checker</span>, <span class="option">weighted NODF</span>, <span class="option">wine</span>, <span class="option">ALL</span>. See details for details on each method.</p>
</td></tr>
<tr><td><code id="nested_+3A_rescale">rescale</code></td>
<td>
<p>Should all measures be rescaled so that higher values mean higher nestedness? Defaults to FALSE, i.e. the standard interpretation of each measure is maintained.</p>
</td></tr>
<tr><td><code id="nested_+3A_normalised">normalised</code></td>
<td>
<p>Logical, defaulting to TRUE. Should C-scores be normalised to a value between 0 and 1? See <code><a href="#topic+C.score">C.score</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are seven different measures (with variations yielding ten indices) currently available:
</p>

<dl>
<dt>1</dt><dd><p>binmatnest calculates nestedness temperature following the function <code><a href="vegan.html#topic+nestedtemp">nestedtemp</a></code> (0 = cold = highly nested; 100 = hot = not nested at all).   (Note that we replaced <span class="option">binmatnest</span>, which calls the retired <code>nestedness</code>, which used the original C++-program of Miguel Rodriguez-Girones, by what used to be <code>binmatnest2</code>. Because binmatnest sometimes (and to us unexplicably) invert the matrix, we prefer the <span class="pkg">vegan</span>'s binmatnest2, now binmatnest, option. That is the implementation by Jari Oksanen in <code><a href="vegan.html#topic+nestedtemp">nestedtemp</a></code> of the same algorithm.)</p>
</dd>
<dt>2</dt><dd><p>Discrepancy calculates the number of non-nested 0s and 1s. While <code>discrepancy</code> calls the function with the same name, discrepancy2 calls <code><a href="vegan.html#topic+nesteddisc">nesteddisc</a></code>, which handles ties differently. Most of the time, these two should deliver very, very similar results. Higher values indicate lower nestedness.</p>
</dd>
<dt>3</dt><dd><p>NODF is the nestedness measure proposed by Almeida-Neto et al., correcting for matrix fill and matrix dimensions. Values of 0 indicate non-nestedness, those of 100 perfect nesting. NODF2 sorts the matrix before calculating the measure. NODF is, I understand, closer to the version presented in the paper, while NODF2 seems to make more sense for comparisons across different networks (because it is independent of the initial presentation of the matrix). Both call <code><a href="vegan.html#topic+nestednodf">nestednodf</a></code> in <span class="pkg">vegan</span>. (Yes,  I initially programmed NODF myself, only to find that it was there already. Luckily, there was a perfect agreement between my (depricated) version and nestednodf.) A weighted version is also now available (see point 6 below), following the paper of Almeida-Neto and Ulrich (2010).</p>
</dd>
<dt>4</dt><dd><p><code><a href="#topic+C.score">C.score</a></code> calculates the number of checkerboard pattern in the matrix. As default, it normalises this value between min and max, so that values of 0 indicate no checkerboards (i.e. nesting), while a value of 1 indicates a perfect checkerboard. checker is the non-normalised version, based on <code><a href="vegan.html#topic+nestedchecker">nestedchecker</a></code>.</p>
</dd>
<dt>5</dt><dd><p>wine is one of two nestedness measure using the information on the weight of a link. See <code><a href="#topic+wine">wine</a></code> for details.</p>
</dd>
<dt>6</dt><dd><p>weighted NODF is a version of 3, but now incorporating information on the weights of the link; it is the second quantitative nestedness measure, (chronologically) after wine. It uses the sorted matrix to compute NODF. If you want NODF of the unsorted, you have to directly use <code>nestednodf</code> in <span class="pkg">vegan</span>.</p>
</dd>
<dt>7</dt><dd><p>weighted NODA, or WNODA, does try to give a good nestedness measure <em>without</em> correcting for column/row expectations, as that should be left to the null model; see Félix et al. (2017) for details. Also, NODA accounts for modular structures of the network, computing nestedness separately in each (see <code><a href="#topic+nest.smdm">nest.smdm</a></code> for further details).</p>
</dd>
</dl>



<h3>Value</h3>

<p>A vector with values for each of the selected nestedness measures.
</p>


<h3>Note</h3>

<p>The idea behind this function is to encourage the comparison of different nestedness measures. That does not mean, we necessarily see much ecological sense in them (see, e.g., the paper by Blüthgen et al. 2008).
</p>
<p><code>nested</code> uses one non-default setting for the <code><a href="#topic+nestedness">nestedness</a></code> measures called: <span class="option">null.models=FALSE</span>. This is simply to speed up the computation. Null models should be built for all nestedness measures, of course, not only for <code><a href="#topic+nestedness">nestedness</a></code>!
</p>


<h3>Author(s)</h3>

<p>Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a>
</p>


<h3>References</h3>

<p>Almeida-Neto, M., Guimaraes, P., Guimaraes, P.R., Loyola, R.D. and Ulrich, W. 2008. A consistent metric for nestedness analysis in
ecological systems: reconciling concept and measurement. <em>Oikos</em> <b>117</b>, 1227&ndash;1239.
</p>
<p>Almeida-Neto, M. and Ulrich, W. (2011) A straightforward computational approach for measuring nestedness using quantitative matrices. <em>Environmental Modelling &amp; Software</em>, <b>26</b>, 173&ndash;178
</p>
<p>Blüthgen, N., J. Fründ, D. P. Vazquez, and F. Menzel. 2008. What do interaction network metrics tell us about specialisation and biological traits? <em>Ecology</em> <b>89</b>, 3387&ndash;3399.
</p>
<p>Brualdi, R.A. and Sanderson, J.G. 1999. Nested species subsets, gaps, and discrepancy. <em>Oecologia</em>  <b>119</b>, 256&ndash;264.
</p>
<p>Felix, G.M., Pinheiro, R.B.P., Poulin, R., Krasnov, B.R. &amp; Mello, M.A.R. (2017). The compound topology of a continent-wide interaction network explained by an integrative hypothesis of specialization. <em>bioRxiv</em>
</p>
<p>Galeano, J., Pastor, J.M., Iriondo and J.M. 2008. Weighted-Interaction  Nestedness Estimator (WINE): A new  estimator to calculate over frequency matrices. <em>arXiv</em> 0808.3397v2 [physics.bio-ph]
</p>
<p>Rodríguez-Gironés, M.A.  and Santamaría, L. 2006. A new algorithm to calculate the nestedness temperature of presence-absence matrices. <em>J. Biogeogr.</em>  <b>33</b>, 924&ndash;935.
</p>
<p>Stone, L. and Roberts, A. 1990. The checkerboard score and species distributions. <em>Oecologia</em> <b>85</b>, 74&ndash;79.
</p>
<p>Almeida-Neto, M. and Ulrich, W. 2010. A straightforward computational approach for measuring nestedness using quantitative matrices. Environmental Modelling &amp; Software, in press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+C.score">C.score</a></code>, <code><a href="#topic+wine">wine</a></code>, <code><a href="#topic+nestedness">nestedness</a></code>, <code><a href="#topic+discrepancy">discrepancy</a></code>; and, within <span class="pkg">vegan</span>: <code>nestedtemp</code>,   
<code>nestedchecker</code>, <code>nesteddisc</code>, <code>nestednodf</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Safariland)
nested(Safariland, "ALL")
nested(Safariland, "ALL", rescale=TRUE)
# illustration that non-normalised C.score and checker are the same:
nested(Safariland, c("C.score", "checker"), normalise=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='nestedcontribution'>
Calculates the per-species contribution to nestedness (z-score relative to null model)
</h2><span id='topic+nestedcontribution'></span>

<h3>Description</h3>

<p>Estimates the degree to which the interactions of each row and column species increase or decrease community nestedness.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nestedcontribution(web, nsimul = 99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nestedcontribution_+3A_web">web</code></td>
<td>
<p>A matrix with elements of a set (e.g., plants) as rows, elements of a second set (e.g., pollinators) as columns and number of interactions as entries. Non-binary matrices will be converted to 0/1 data.</p>
</td></tr>
<tr><td><code id="nestedcontribution_+3A_nsimul">nsimul</code></td>
<td>
<p>Number of randomizations to use as the basis for each comparison.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The idea behind nestedness contribution is to determine how individual species' interactions change community nestedness compared to a random null model that is designed to control for the effect of differences in degree. For each row and column species, this function compares observed nestedness to an ensemble of nestedness values generated by randomizing the interactions of just that focal species. Nestedness contributions are the z-scores from this comparison. Therefore, a positive contributor to community nestedness (i.e., a species whose interactions increase overall nestedness) will obtain values greater than 0 and negative contributors to nestedness will obtain values less than 0.
</p>


<h3>Value</h3>

<p>For both the &ldquo;higher trophic level&rdquo; and the &ldquo;lower trophic level&rdquo;, this function returns a data frame with the per-species nestedness contributions.
</p>


<h3>Note</h3>

<p>This function calculates per-species nestedness contributions as described in Saavedra et al. 2011&mdash;namely it is based on the metric NODF to measure nestedness and employs a probabilistic null model to randomize interactions (that is described in Bascompte et al. 2003). The underlying methodology is amenable to other choices in both of these cases; however, this is not implemented at present.
</p>
<p>The currently implemented null model replaces the observed vector of 0/1s by a probabalistic draw of 0/1s as given by the mean of mean degree in the higher trophic level (<code>rowSums(web)/ncol(web)</code>) and the mean degree for the target higher trophic level species i (<code>colSums(web)[i]/nrow(web)</code>).
</p>


<h3>Author(s)</h3>

<p>Daniel B. Stouffer <a href="mailto:daniel.stouffer@canterbury.ac.nz">daniel.stouffer@canterbury.ac.nz</a>
</p>


<h3>References</h3>

<p>Bascompte, J., Jordano, P., Melián, C.J., and Olesen, J.M. 2003. The nested assembly of plant-animal mutualistic networks. <em>Proceedings of the National Academy of Sciences of the USA</em> <b>100</b>, 9383&ndash;9387
</p>
<p>Saavedra, S., Stouffer, D.B., Uzzi, B., and Bascompte, J. 2011. Strong contributors to network persistence are the most vulnerable to extinction. <em>Nature</em> <b>478</b>, 233&ndash;235
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(Safariland)
  ## Not run: 
    nestedcontribution(Safariland)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='nestedness'>Calculates nestedness temperature of presence/absence matrices</h2><span id='topic+nestedness'></span>

<h3>Description</h3>

<p>Deprecated: Calculates matrix temperature using the binmatnest approach of Miguel Rodríguez-Gironés</p>


<h3>Usage</h3>

<pre><code class='language-R'>nestedness(m, null.models = TRUE, n.nulls = 100, popsize = 30, 
n.ind = 7, n.gen = 2000, binmatnestout=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nestedness_+3A_m">m</code></td>
<td>
 <p><code>m</code> is the matrix object for which the temperature is calculated. <code>m</code> will be converted to a binary matrix as temperature is only based on binary data</p>
</td></tr>
<tr><td><code id="nestedness_+3A_null.models">null.models</code></td>
<td>
<p>Ignored. Logical; shall the three different null models to check for significance of the matrix temperature be calculated? The null models procedure is 
quite time consuming and therefore we added this switch. Defaults to <code>null.models</code>=TRUE.</p>
</td></tr>
<tr><td><code id="nestedness_+3A_n.nulls">n.nulls</code></td>
<td>
<p>Ignored. How many null models should be calculated. Defaults to <code>n.nulls=100</code>.</p>
</td></tr>
<tr><td><code id="nestedness_+3A_popsize">popsize</code></td>
<td>
<p>Ignored. For the genetic algorithm some parameters have to be initialised. First is <code>popsize</code>, default is 30</p>
</td></tr>
<tr><td><code id="nestedness_+3A_n.ind">n.ind</code></td>
<td>
<p>Ignored. Second is number of individuals picked for the next generation. Default of <code>n.ind</code> is 7.</p>
</td></tr>
<tr><td><code id="nestedness_+3A_n.gen">n.gen</code></td>
<td>
<p>Ignored. Third is the number of generations until the genetic algorithm stops. Default of <code>n.gen</code> is 2000.</p>
</td></tr>
<tr><td><code id="nestedness_+3A_binmatnestout">binmatnestout</code></td>
<td>
<p>Ignored. If set to TRUE a file &quot;binmat.out&quot; is saved in the current working directory , which stores the original binmatnest output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a note that the original function provided here, and detailed below, has been retired. <span class="pkg">vegan</span>'s <code><a href="vegan.html#topic+nestedtemp">nestedtemp</a></code> is more stable and replaces this call whereever we use it in <span class="pkg">bipartite</span>. Indeed, calling <span class="pkg">bipartite</span>'s <code>nestedness</code> now simply call's <span class="pkg">vegan</span>'s <code><a href="vegan.html#topic+nestedtemp">nestedtemp</a></code>. The function will eventually disappear, but for now this fix is provided as legacy support for dependent packages.
</p>
<p>All arguments except first are ignored.
</p>
<p>There are several implementations of nestedness-calculators, most noticeably NTC (nestedness temperature calculator), BINMATNEST and aninhado (check Wikipedia's entry on the subject: <a href="https://en.wikipedia.org/wiki/Nestedness">https://en.wikipedia.org/wiki/Nestedness</a>). While we used BINMATNEST, this does not disqualify any of the others. Miguel was simply the first we contacted and he was readily willing to share his code. 
</p>
<p>We used BINMATNEST by calling a tweaked version of the C++ program binmatnest. In principle nestedness temperature is calculated by using a line of perfect order (using a genetic algorithm) to determine the reordering of rows and columns that leads to minimum matrix temperature of given size and fills. The deviation from this minimun temperature is the matrix temperature. In addition nestedness uses different null models to check for statistical significance of the matrix temperature. For details on what BINMATNEST does different, and better, than the original NTC see reference below. 
</p>
<p>Notice also that the original software BINMATNEST is available as a stand-alone application. Check out Miguel's homepage: <a href="http://www.eeza.csic.es/eeza/personales/rgirones.aspx">http://www.eeza.csic.es/eeza/personales/rgirones.aspx</a>
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>comm</code></td>
<td>
<p>Returns the input.</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>null model matrix</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>marginal row proportions</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>marginal col proportions</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>??</p>
</td></tr>
<tr><td><code>fill</code></td>
<td>
<p>connectance: proportion of non-zero cells</p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p>nestedness temperature</p>
</td></tr>
<tr><td><code>smooth</code></td>
<td>
<p>??</p>
</td></tr>
</table>


<h3>References</h3>

<p>Rodríguez-Gironés M.A., and Santamaría L. 2006. A new algorithm to calculate the nestedness temperature of presence-absence matrices. <em>Journal of Biogeography</em> <b>33</b>, 924&ndash;935
</p>

<hr>
<h2 id='nestedrank'>
Calculates the rank of a species in a matrix sorted for maximum nestedness
</h2><span id='topic+nestedrank'></span>

<h3>Description</h3>

<p>Ranks species according to their generality, which is measured as the position in the nestedness matrix. A generalist will interact with more species and thus have a rank closer to 1, while specialists (and rare species) will have ranks with higher values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nestedrank(web, method = "NODF", weighted=TRUE, normalise=TRUE, return.matrix=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nestedrank_+3A_web">web</code></td>
<td>
<p>A matrix with elements of a set (e.g., plants) as rows, elements of a second set (e.g., pollinators) as columns and number of interactions as entries.</p>
</td></tr>
<tr><td><code id="nestedrank_+3A_method">method</code></td>
<td>
<p>One or more of the following: <span class="option">NODF</span>, <span class="option">nodf</span>, <span class="option">binmatnest</span>, <span class="option">wine</span>, <span class="option">sort</span>. See details for details on each method.</p>
</td></tr>
<tr><td><code id="nestedrank_+3A_weighted">weighted</code></td>
<td>
<p>For NODF and wine only: should the number of interactions per link be used as weights? See help of <code>nestednodf</code> in <span class="pkg">vegan</span> for details.</p>
</td></tr>
<tr><td><code id="nestedrank_+3A_normalise">normalise</code></td>
<td>
<p>Logical; defaulting to TRUE. Divides the rank-1 by the number of species -1, thereby ranging it between 0 (most generalist) and 1 (most specialised).</p>
</td></tr>
<tr><td><code id="nestedrank_+3A_return.matrix">return.matrix</code></td>
<td>
<p>Logical, defaulting to FALSE. Should the matrix resulting from the nestedness-sorting be returned as well?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The idea is to re-arrange the network matrix according to its nestedness, so that the most &ldquo;generalist&rdquo; species with most links will be in the first row/column and decreasing from there. The nestedness matrix can be computed in different ways. There are four different methods currently available:
</p>

<dl>
<dt>NODF (or nodf)</dt><dd><p>will use <span class="pkg">vegan</span>'s  <code>nestednodf</code>-function to arrange the matrix. With <span class="option">weighted=TRUE</span>, which is the default, it will use the actual number of interactions, rather than the number of links</p>
</dd>
<dt>binmatnest</dt><dd><p>will use the <span class="pkg">vegan</span>'s <code>nestedtemp</code>-function to arrange the matrix. This is only using binary information, so weighting has no effect.</p>
</dd>
<dt>wine</dt><dd><p>will use the <code><a href="#topic+wine">wine</a></code>-function to arrange the matrix. When <span class="option">weighted=FALSE</span>, wine will be applied to a binary matrix.</p>
</dd>
<dt>sort</dt><dd><p>will simply sort the matrix by marginal totals (i.e. by number of interactions per species when <span class="option">weighted=TRUE</span> or by number links (=degree) when <span class="option">weighted=FALSE</span>. In this case the rank simply represents the abundance of the species in this network.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A list of nestedness ranks vectors for the lower and higher trophic level (smallest value for the most generalist). If <span class="option">return.matrix=TRUE</span>, a third list entry will contain the nested matrix.
</p>


<h3>Note</h3>

<p>Since nestedness is itself not a straight-forward measure of something ecologically meaningful, also these ranks may or may not be. At least there is a high chance that they represent merely abundance of each species. See example for an idea on how to check for the effect of abundance as such.
</p>


<h3>Author(s)</h3>

<p>Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a>
</p>


<h3>References</h3>

<p>Alarcon, R., Waser, N.M. and Ollerton, J. 2008. Year-to-year variation in the topology of a plant-pollinator interaction network. <em>Oikos</em> <b>117</b>, 1796&ndash;1807
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nested">nested</a></code>; <code><a href="#topic+nestedrank">nestedrank</a></code> is called by <code><a href="#topic+specieslevel">specieslevel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ranks &lt;- sapply(c("nodf", "binmatnest", "wine", "sort"), function(x) 
  nestedrank(Safariland, method=x)[[2]])
cor(ranks) # high correlation between sort and other indicate that only abundance matters

## End(Not run)
</code></pre>

<hr>
<h2 id='networklevel'>Analysis of bipartite webs at the level of the entire network</h2><span id='topic+networklevel'></span>

<h3>Description</h3>

<p>Calculates a variety of indices and values for a bipartite network
</p>


<h3>Usage</h3>

<pre><code class='language-R'>networklevel(web, index="ALLBUTDD", level="both", weighted=TRUE, 
   ISAmethod="Bluethgen",  SAmethod = "Bluethgen", extinctmethod = "r", 
   nrep = 100, CCfun=median, dist="horn", normalise=TRUE, empty.web=TRUE, 
   logbase="e", intereven="prod", H2_integer=TRUE, fcweighted=TRUE, 
   fcdist="euclidean", effective=FALSE, legacy=FALSE, mass.action.norm=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="networklevel_+3A_web">web</code></td>
<td>
<p>Web is a matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows). 
Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_index">index</code></td>
<td>
<p>One or more of the following (exact match only!). First the group of &ldquo;pure&rdquo; network indices, then those computed for each level.
</p>

<ul>
<li> <p><span class="option">connectance</span>,
</p>
</li>
<li> <p><span class="option">web asymmetry</span>,
</p>
</li>
<li> <p><span class="option">links per species</span>, 
</p>
</li>
<li> <p><span class="option">number of compartments</span>, 
</p>
</li>
<li> <p><span class="option">compartment diversity</span>, 
</p>
</li>
<li> <p><span class="option">cluster coefficient</span>, which will compute both the network-wide cluster coefficient as well as those for each level,
</p>
</li>
<li> <p><span class="option">nestedness</span> (where ties may induce variation when changing the sequence of species in <span class="option">web</span>), 
</p>
</li>
<li> <p><span class="option">NODF</span>,
</p>
</li>
<li> <p><span class="option">weighted nestedness</span> (where ties may induce variation when changing the sequence of species in <span class="option">web</span>), 
</p>
</li>
<li> <p><span class="option">weighted NODF</span>, 
</p>
</li>
<li> <p><span class="option">spectral radius</span>,
</p>
</li>
<li> <p><span class="option">ISA</span> (or alternatively <span class="option">interaction strength asymmetry</span> or 
<br /> <span class="option">dependence asymmetry</span>), 
</p>
</li>
<li> <p><span class="option">SA</span> (or alternatively <span class="option">specialisation asymmetry</span>),
</p>
</li>
<li> <p><span class="option">linkage density</span>, 
</p>
</li>
<li> <p><span class="option">weighted connectance</span>,
</p>
</li>
<li> <p><span class="option">Fisher alpha</span>, 

</p>
</li>
<li> <p><span class="option">interaction evenness</span>, 
</p>
</li>
<li> <p><span class="option">Alatalo interaction evenness</span>, 
</p>
</li>
<li> <p><span class="option">Shannon diversity</span>, 
</p>
</li>
<li> <p><span class="option">H2</span>;  
</p>
</li></ul>
<p> and/or those invoked through <code><a href="#topic+grouplevel">grouplevel</a></code>:
</p>

<ul>
<li> <p><span class="option">number of species</span> in the respective trophic level,
</p>
</li>
<li> <p><span class="option">mean number of links</span>,
</p>
</li>
<li> <p><span class="option">mean number of shared partners</span>,  
</p>
</li>
<li> <p><span class="option">weighted cluster coefficient</span>,  
</p>
</li>
<li> <p><span class="option">degree distribution</span>, 
</p>
</li>
<li> <p><span class="option">togetherness</span>, 
</p>
</li>
<li> <p><span class="option">C score</span>, 
</p>
</li>
<li> <p><span class="option">V ratio</span>, 
</p>
</li>
<li> <p><span class="option">discrepancy</span> (where ties may induce variation when changing the sequence of species in <span class="option">web</span>), 
</p>
</li>
<li> <p><span class="option">extinction slope</span> (where ties may induce variation when changing the sequence of species in <span class="option">web</span>), 
</p>
</li>
<li> <p><span class="option">robustness</span> (where ties may induce variation when changing the sequence of species in <span class="option">web</span>),  
</p>
</li>
<li> <p><span class="option">niche overlap</span>,  
</p>
</li>
<li> <p><span class="option">generality</span>,
</p>
</li>
<li> <p><span class="option">vulnerability</span>,

</p>
</li>
<li> <p><span class="option">fc</span> (or alternatively <span class="option">functional complementarity</span>).
</p>
</li></ul>
<p> Furthermore, there are some groups of indices that can be called:
</p>

<ul>
<li> <p><span class="option">ALL</span> calculates all indices (returning a list (since degree distribution fits are a table within this list and cannot be simplified)), 
</p>
</li>
<li> <p><span class="option">ALLBUTDD</span> (default) calculates all indices except degree distribution fits. This latter has the advantage that the output can be simplified to a vector; 
</p>
</li>
<li> <p><span class="option">info</span> returns more general information on the network;
</p>
</li>
<li> <p><span class="option">binary</span> returns a best-of selection of indices based on a binary network;
</p>
</li>
<li> <p><span class="option">quantitative</span> returns a best-of selection of indices based on quantitative networks;
</p>
</li>
<li> <p><span class="option">topology</span> returns indices more abstractly describing network properties. Also CHECK details below!
</p>
</li></ul>

</td></tr>
<tr><td><code id="networklevel_+3A_level">level</code></td>
<td>
<p>For which level should the level-specific indices be computed: <span class="option">both</span> (default), <span class="option">lower</span> or <span class="option">higher</span>?</p>
</td></tr>
<tr><td><code id="networklevel_+3A_weighted">weighted</code></td>
<td>
<p>Logical; should the weighted average be computed for indices that are averaged across species (at the group level)? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_isamethod">ISAmethod</code></td>
<td>
<p>Method to use for calculating interaction strength (= dependence) asymmetry; original by <span class="option">Bascompte</span> is yielding artefact results based only on the asymmetry of the web (as shown by example in Blüthgen et al. 2007 analytically in Blüthgen 2010) and should hence be avoided; <span class="option">Bluethgen</span> (default) excludes singletons and corrects for low number of interactions (range -1 to 1).</p>
</td></tr>
<tr><td><code id="networklevel_+3A_samethod">SAmethod</code></td>
<td>
<p>How to aggregate d'-based specialisation values: mean of log-transformed dependencies (<span class="option">log</span>) or Blüthgen's marginal totals-weighted mean (default); see Blüthgen et al. (2007).</p>
</td></tr>
<tr><td><code id="networklevel_+3A_extinctmethod">extinctmethod</code></td>
<td>
<p>Specifies how species are removed from matrix: <span class="option">random</span>, <span class="option">degree</span> or <span class="option">abundance</span> (partial matching). See <code><a href="#topic+second.extinct">second.extinct</a></code> for details an option to predefine the sequence externally; idea from Memmott et al. (2004).</p>
</td></tr>
<tr><td><code id="networklevel_+3A_nrep">nrep</code></td>
<td>
<p>Number of replicates for the extinction sequence analysis.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_ccfun">CCfun</code></td>
<td>
<p>Method to use when calculating the clustering coefficient. Originally proposed as mean of cluster coefficients for each species. Defaults to <span class="option">median</span>, because cluster coefficients are strongly skewed. </p>
</td></tr>
<tr><td><code id="networklevel_+3A_dist">dist</code></td>
<td>
<p>Distance metric to be used to calculate niche overlap. Any of <span class="pkg">vegan</span>'s <code>vegdist</code>-metrics can be used; defaults to Horn's index, which is the recommendation of Krebs (1989). Binary percent niche overlap would be computed with <br />  <span class="option">dist = "jaccard"</span>.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_normalise">normalise</code></td>
<td>
<p>Logical; shall the C-score and togetherness metrics be normalised to a range of 0 to 1? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_empty.web">empty.web</code></td>
<td>
<p>Shall the empty columns and rows be deleted? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_logbase">logbase</code></td>
<td>
<p>Shall the various diversity indices (linkage density, partner diversity, generality/vulnerability, interaction evenness) be calculated to the base of e (default) or 2? Log2 is the proposal for generality and vulnerability by Bersier et al. (2002), while Shannon uses ln. The choice of the base will not affect the results qualitatively, at most by a scaling factor. Note that for all these indices, we follow common practice and define 0 * log(0) = 0.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_intereven">intereven</code></td>
<td>
<p>Shall all cells of the matrix be used to calculate the interaction evenness <br />
(<span class="option">intereven = "prod"</span>)? Or, as given by Bersier et al. (2002) and Tylianakis et al. (2007), should only the realised links be used (<span class="option">intereven = "sum"</span>; default)? Prod and sum refer to using the log of the <b>product</b> of matrix dimensions (i.e. all cells) or the log of the <b>sum</b> of non-zero cells (i.e. number of links)  as denominator in the evenness formula. See last paragraph of the details-section for views on these two options!</p>
</td></tr>
<tr><td><code id="networklevel_+3A_h2_integer">H2_integer</code></td>
<td>
<p>Logical; indicates whether values in web are integers. Passed on to <code><a href="#topic+H2fun">H2fun</a></code>; see there for details.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_fcweighted">fcweighted</code></td>
<td>
<p>Logical; when computing &ldquo;functional complementarity&rdquo; sensu function <code><a href="#topic+fc">fc</a></code>, should the weights of the matrix be used. Defaults to TRUE, but original paper (Devoto et al. 2012) is based on FALSE.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_fcdist">fcdist</code></td>
<td>
<p>Distance measure to be used to compute functional complementarity through <code><a href="#topic+fc">fc</a></code>; any measure accepted by <code><a href="stats.html#topic+dist">dist</a></code> is acceptable.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_effective">effective</code></td>
<td>
<p>logical; should interaction evenness, Alatalo evenness, H2' and diversity be expressed as &ldquo;effective&rdquo; diversity? For Jost (2010, page 210) this seems to be the better decomposition of an index into a diversity and an evenness component. On a downside, H2' is then no longer ranged in [0,1], and &ldquo;diversity&rdquo; becomes the same as &ldquo;vulnerability&rdquo; and &ldquo;generality&rdquo;. For these reasons, and backward compatibility, the default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="networklevel_+3A_legacy">legacy</code></td>
<td>
<p>Logical; should the old (pre-2.00) version of <code>networklevel</code> be used? To be backward compatible, the old <code>networklevel</code>-function is still available (<code>.networklevel</code>) and can be called by setting <span class="option">legacy=TRUE</span>. This is only for the transition period until all papers in the making have been published (or binned). Index names and sometimes unclear focal level were downsides of the old implementation, which is now remedied. Thus, the use of <span class="option">legacy=TRUE</span> and the direct call of <code>.networklevel</code> are strongly discouraged!</p>
</td></tr>
<tr><td><code id="networklevel_+3A_mass.action.norm">mass.action.norm</code></td>
<td>
<p>Logical; shall the spectral radius be normalised by mass action? Defaults to FALSE. See <code><a href="#topic+spectral.radius">spectral.radius</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For explanations of any of the indices computed for a level (i.e. those with HL and/or LL suffix), please see <code><a href="#topic+grouplevel">grouplevel</a></code> for details.
</p>
<p>This function implements a variety of the many (and still procreating) indices describing network topography. Some are embarrassingly simple and mere descriptors of a network's outer appearance (such as number of species in each trophic level or the number of links (= non-zero cells) in the web). Others are variations on Shannon's diversity index applied to within column or within rows. Only extinction slope is newly implemented here, and hence described in a bit more detail.
</p>
<p>Currently, you <em>cannot</em> get the <em>qualitative</em> version of quantitative indices such as vulnerability!
</p>
<p>Integers or continuous values - what are the quantities in quantitative webs? Some web metrics expect in their typical formulation that the entries in the web-matrix are integers - e.g. H2' is defined relative to minimum and maximum based on marginal totals. Blüthgen et al. (2006) use an algorithm assuming values can only be integers. If your quantities are not constrained to be integers, multiplication and rounding may or may not give consistent results, depending on rounding errors and the factor applied. Multiplication with high numbers such as 10 000 seems to be OK. For H2' a simplified calculation applicable to continuous numbers is available (by declaring option <span class="option">H2_integer=FALSE</span> in <code><a href="#topic+H2fun">H2fun</a></code>). Note that values of H2' based on integers are not directly comparable to H2' based on continuous values (for sparse webs, H2'_continuous is much higher than H2'_integer). We tentatively think that other indices are hardly affected by non-integer values or by multiplication and rounding. Please let us know your experience.
</p>


<h3>Value</h3>

<p>The suffixes LL and HL refer to lower and higher level, respectively
</p>
<p>Depending on the selected indices, some or all of the below (returned as vector if &ldquo;degree distribution&rdquo; was not requested, otherwise as list):
</p>
<table role = "presentation">
<tr><td><code>connectance</code></td>
<td>
<p>Realised proportion of possible links (Dunne et al. 2002): sum of links divided by number of cells in the matrix (= number of higher times number of lower trophic level species). This is the <em>standardised number of species combinations</em> often used in co-occurrence analyses (Gotelli &amp; Graves 1996)</p>
</td></tr>
<tr><td><code>web asymmetry</code></td>
<td>
<p>Balance between numbers in the two levels: positive values indicate more higher-trophic level species, negative more lower-trophic level species; implemented as <code>(ncol(web)-nrow(web))/sum(dim(web))</code>; web asymmetry is a null model for what one might expect in dependence asymmetry: see Blüthgen et al. (2007).</p>
</td></tr>
<tr><td><code>links per species</code></td>
<td>
<p>Mean number of links per species (qualitative): sum of links divided by number of species.</p>
</td></tr>
<tr><td><code>number of compartments</code></td>
<td>
<p>Compartments are sub-sets of the web which are not connected (through either higher or lower trophic level) to another compartment. Mathematically, they are Jordan blocks, but this implementation is rule-based (and fast). They are also nicely visualised in the <code><a href="#topic+visweb">visweb</a></code> function.</p>
</td></tr>
<tr><td><code>compartment diversity</code></td>
<td>
<p>Shannon's diversity of compartment sizes (size = number of species from both levels); see Tylianakis et al. (2007).</p>
</td></tr>
<tr><td><code>cluster coefficient</code></td>
<td>
<p>The cluster coefficient for a network is the average cluster coefficients of its members, i.e. simply the number of realised links devided by the number of possible links. Introduced by Watts &amp; Strogatz (1998) and described in Wikipedia under <a href="https://en.wikipedia.org/w/index.php?title=Clustering_coefficient">https://en.wikipedia.org/w/index.php?title=Clustering_coefficient</a>. The cluster coefficient can be computed both for the entire network, as well as for each level (for the latter indicated by suffix HL or LL).</p>
</td></tr>
<tr><td><code>nestedness</code></td>
<td>
<p>Nestedness temperature of the matrix (0 means cold, i.e. high nestedness, 100 means hot, i.e. chaos). <code>networklevel</code> calls <code><a href="vegan.html#topic+nestedtemp">nestedtemp</a></code>! If you are interested in the different null models, please use the function <code><a href="#topic+nested">nested</a></code> or <code><a href="vegan.html#topic+nestedtemp">nestedtemp</a></code> directly.</p>
</td></tr>
<tr><td><code>NODF</code></td>
<td>
<p>Another index for nestedness, calling <code><a href="vegan.html#topic+nestednodf">nestednodf</a></code>. High values indicate nestedness. According to the analysis of Almeida-Neto et al. (2008, 2010), NODF is more consistent and &ldquo;better&rdquo; than usual measures of nestedness.</p>
</td></tr>
<tr><td><code>weighted nestedness</code></td>
<td>
<p>A nestedness version that considers interaction frequencies (and is hence weighted), proposed by Galeano et al. (2007) and implemented in <code><a href="#topic+wine">wine</a></code>. It ranges between 1 (perfect nestedness) and 0 (perfect chaos). Note that this is the OPPOSITE interpretation of nestedness temperature!</p>
</td></tr>
<tr><td><code>weighted NODF</code></td>
<td>
<p>Another quantitative (=weighted) index for nestedness, building on NODF (see <code><a href="vegan.html#topic+nestednodf">nestednodf</a></code>). High values indicate nestedness. According to the analysis of Almeida-Neto et al. (2008, 2010), NODF is more consistent and &ldquo;better&rdquo; than usual measures of nestedness.</p>
</td></tr>
<tr><td><code>spectral radius</code></td>
<td>
<p>Another nestedness index, proposed by Staniczenko et al. (2013), possibly correcting for &quot;mass action&quot;. See <code><a href="#topic+spectral.radius">spectral.radius</a></code> and/or <code><a href="#topic+massaction">massaction</a></code> for details.</p>
</td></tr>
<tr><td><code>interaction strength asymmetry</code></td>
<td>
<p>(selected using <span class="option">index = "ISA"</span>). Explaining dependence asymmetry is also a measure of specialisation, across both trophic levels. Proposed by Bascompte et al. (2006) and critised and alterations proposed by Blüthgen et al. (2007). The latter also show that dependence asymmetry can be almost entirely explained by web asymmetry (see above). Positive values (only possible of <span class="option">ISAmethod = "Bluethgen"</span>) indicate higher dependence in the higher trophic level. See function <code><a href="#topic+specieslevel">specieslevel</a></code> and its index <span class="option">interaction push/pull</span>, which quantifies the balance of affecting and being effected by other species. Similarly, index <span class="option">strength</span> quantifies the average effect of each species on all its partners.</p>
</td></tr>
<tr><td><code>specialisation asymmetry</code></td>
<td>
<p>(selected by using <span class="option">index="SA"</span>). Asymmetry (higher vs. lower trophic level) of specialisation now based on d' (see <code><a href="#topic+dfun">dfun</a></code>), which is insensitive to the dimensions of the web. Again, two options of calculation are available: the one proposed by Blüthgen et al. (2007), where they weight the specialisation value for each species by its abundance (<span class="option">SAmethod="Bluethgen"</span>) or where d'-values are log-transformed (arguing that d'-values are indeed log-normally distributed: <span class="option">SAmethod="log"</span>). Since the mean d-value for the lower trophic level is subtracted from that of the higher, positive values indicate a higher specialisation of the higher trophic level.</p>
</td></tr>
<tr><td><code>linkage density</code></td>
<td>
<p>Marginal totals-weighted diversity of interactions per species (quantitative). Actually, this is computed as the average of vulnerability and generality (Bersier et al. 2002). Does not respond to setting <code>weighted=FALSE</code>.</p>
</td></tr>
<tr><td><code>weighted connectance</code></td>
<td>
<p>Linkage density divided by number of species in the network (Bersier et al. 2002). This will respond to whether non-interacting species (e.g. unparasitised hosts) are included or not!</p>
</td></tr>
<tr><td><code>Fisher's alpha</code></td>
<td>
<p>An alternative measure of interaction diversity (using <code><a href="vegan.html#topic+fisherfit">fisherfit</a></code>).</p>
</td></tr>
<tr><td><code>interaction evenness</code></td>
<td>
<p>Shannon's evenness for the web entries. Note that the two options are rather different. By definition, IE = H/Hmax; H = -sum(p.i.mat*log(p.i.mat)), where p.i.mat = matrix/sum(entries in matrix). This means, when calculating H, do we treat all possible links as species, and the interactions (cell values) as measure of their abundance? By definition, Hmax = ln(N). The key question is: What is the right value for N? Since we treat the matrix cells as species, it is (clearly?) the number of matrix cells, i.e. number of higher trophic level species x number of lower trophic level species. We think this logic justifies our default <code>"prod"</code>. However, others argue in favour of N=number of links. Please see note for our discussion on this point. Note that <span class="option">effective=TRUE</span> will turn this into Jost (2019)'s &ldquo;effective evenness&rdquo;.</p>
</td></tr>
<tr><td><code>Alatalo interaction evenness</code></td>
<td>
<p>A different measure for web entry evenness, as proposed by Müller et al. (1999). </p>
</td></tr>
<tr><td><code>Shannon diversity</code></td>
<td>
<p>Shannon's diversity of interactions (i.e. network entries).</p>
</td></tr>
<tr><td><code>H2</code></td>
<td>
<p>H2' is a network-level measure of specialisation. It ranges between 0 (no specialisation) and 1 (complete specialisation). More specifically, H2' is a measure of discrimination, i.e. calculated in comparison to no specialisation (see <code><a href="#topic+H2fun">H2fun</a></code> for details. To avoid confusion of keys (apostrophe vs. accent), we call H2' only H2 here.</p>
</td></tr>
<tr><td><code>others now to come:</code></td>
<td>
<p>all other indices are returned as output from <code><a href="#topic+grouplevel">grouplevel</a></code>. Please see there for details, we here only provide minimal listing.</p>
</td></tr>
<tr><td><code>number of species</code></td>
<td>
</td></tr>
<tr><td><code>mean number of shared partners</code></td>
<td>
<p>in this level</p>
</td></tr>
<tr><td><code>cluster coefficient</code></td>
<td>
<p>for this level (same for both levels if <span class="option">weighted=FALSE</span>).</p>
</td></tr>
<tr><td><code>weighted cluster coefficient</code></td>
<td>
</td></tr>
<tr><td><code>niche overlap</code></td>
<td>
<p>Mean similarity in interaction pattern between species of the same level, calculated by default as Horn's index (<span class="option">dist="horn"</span>).</p>
</td></tr>
<tr><td><code>togetherness</code></td>
<td>
<p>Mean number of co-occupancies across all species combinations.</p>
</td></tr>
<tr><td><code>C score</code></td>
<td>
<p>Mean (normalised) number of checkerboard combinations across all species.</p>
</td></tr>
<tr><td><code>V ratio</code></td>
<td>
<p>Variance-ratio of species numbers to individual numbers within species for that level.</p>
</td></tr>
<tr><td><code>discrepancy</code></td>
<td>
<p>Discrepancy as proposed by Brualdi &amp; Sanderson (1999); see also <code><a href="#topic+discrepancy">discrepancy</a></code> for details. However, <code>networklevel</code> actually calls <b>vegan</b>'s <code>nesteddisc</code> to better handle ties.</p>
</td></tr>
<tr><td><code>degree distribution</code></td>
<td>
<p>See <code><a href="#topic+degreedistr">degreedistr</a></code> for details and references.</p>
</td></tr>
<tr><td><code>extinction slope</code></td>
<td>
<p>Slope of the secondary extinction sequence in that level, following extermination of species in the other level.</p>
</td></tr>
<tr><td><code>robustness</code></td>
<td>
<p>Area below the &ldquo;secondary extinction&rdquo; curve; see <code><a href="#topic+robustness">robustness</a></code> for details. Corresponds to &ldquo;extinction slope&rdquo;.</p>
</td></tr>
<tr><td><code>functional complementarity</code></td>
<td>
<p>for a given level.</p>
</td></tr>

<tr><td><code>partner diversity</code></td>
<td>
<p>(Weighted) mean Shannon diversity of the number of interactions for the species of that level. Choose <span class="option">logbase=2</span> to change to a log2-based version.</p>
</td></tr>


<tr><td><code>generality/vulnerability</code></td>
<td>
<p>(Weighted) mean effective number of LL species per HL species (generality; HL species per LL species for vulnerability), weighted by their marginal totals (row sums); see Tylianakis et al. (2007) and Bersier et al. (2002). This is identical to exp(&ldquo;partner diversity&rdquo;, i.e., simply the Jost (2006)-recommended version of diversity.</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Sum or Prod: How to calculate interaction evenness?</b> I shall first put down my argument for &ldquo;prod&rdquo; and then Jason Tylianakis' arguments for &ldquo;sum&rdquo;. 
</p>
<p>Carsten: &ldquo;I do not want to defend a position I cannot hold against the flood of qualified criticism, and shall be happy to change the default to option &ldquo;sum&rdquo; (i.e. Jason's proposal). Nevertheless, I shall make a very brief attempt to defend my (and Nico's point of view). Imagine a completely different situation: I have &ldquo;counted&rdquo; birds in a landscape. From a more meticulous colleague I know that there are 27 bird species breeding at the moment, but on that two mornings that I went out, I could only hear 15. Now I want to calculate the Shannon diversity (and evenness) of birds in that landscape. The &ldquo;normal&rdquo; (in the sense of established) approach to use the data from my 15 species. But hold on: I KNOW there are more species out there. I don't know how many (i.e. there may be more than the 27 my colleague has found), but there are at least 27. If I only use the data from my 15 species, I will get a higher evenness value than when I also include the 12 zeros. My conclusion would be: I don't want to overestimate evenness only because I couldn't look long enough, thus I use all 27 values.&rdquo;
</p>
<p>Jason: &ldquo;I would disagree because what you &ldquo;know&rdquo; is based on your meticulous colleague's &lsquo;sampling&rsquo;, which will also have its limits. If all you wanted was to know the total number of species there (assuming none have gone extinct), then what you propose is fine. However, the problem comes when you want to compare sites, and then sampling effort should be standardised. In most cases we know we don't have a full representation of the diversity (or food web) of an area, but we know for a given spatial or temporal sampling scale that one site differs from another in certain ways, and to me that is the most important. Anyway, it is all a question of scale and the precise question being asked. So what about making it an option in bipartite that you can either choose to divide by the realised links (give our 2007 paper as a ref, so people know it's comparable to that) or divide by the number of potential links, if that's the question people want to ask?&rdquo;
There you go: it's your choice!
</p>
<p><b>NA values:</b>
All error and warning messages are (or at least should be) suppressed! If your web returns and NA for some of the indices, this can be because the index cannot be computed. For example, if the web is full (i.e. no 0-cells), extinction slopes cannot be fitted (singularity of gradient). Check if you can expect the index to be computable! If it is, and networklevel doesn't do it, let me know.
</p>
<p><b>Reducing computation time:</b>
Some indices require rather long computation times on large webs. If you want to increase the speed by omitting some indices, here a rough guide: Ask only for the indices you are interested in! Otherwise, here is the sequence of most time-consuming indices: 
</p>

<ol>
<li><p> The slowest function is related to extinction slopes and robustness. Excluding both makes the function faster. 
</p>
</li>
<li> <p><span class="option">weighted cluster coefficient</span> is also very time consuming (an exhaustive search for 4-loops in the one-mode projection of the network). Omitting it can dramatically boost speed.
</p>
</li>
<li><p> Degree distributions are somewhat time consuming. 
</p>
</li>
<li><p> Fisher's alpha is computed iteratively and hence time consuming. 
</p>
</li>
<li><p> Nestedness and weighted nestedness are not the fastest of routines. 
</p>
</li>
<li><p> Number (and diversity) of compartments calls a recursive and hence relatively slow algorithm. 
</p>
</li>
<li><p> H2 and specialisation asymmetry require an iterative, heuristic search algorithm. Finally, excluding discrepancy can also moderately decrease computation time.
</p>
</li></ol>

<p><b>Does the species sequence in the data matter?</b>
Obviously, it shouldn't, and for most indices it doesn't. However, particularly indices based on binary representation of <span class="option">web</span> will have ties, where several species have the number of links. In this case, it does matter how the matrix is sorted before simulating extinctions or computing discrepancy. There is no (known) foolproof way to get this sequence &quot;right&quot; (see also &quot;Details&quot; of help for <code><a href="vegan.html#topic+nesteddisc">nesteddisc</a></code>). Re-running the same code with a shuffled network may thus yield (slightly) different values for (weighted) nestedness, togetherness, discrepancy, extinction slopes and robustness. (Thanks to Valentin Stefan for making us explicitly addressing this issue!)
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a></p>


<h3>References</h3>

 
<p>Almeida-Neto, M., Loyola, R.D., Ulrich, W., Guimaraes, P., Guimaraes, Jr., P.R. 2008. A consistent metric for nestedness analysis in ecological systems: reconciling concept and measurement. <em>Oikos</em> <b>117</b>, 1227&ndash;1239
</p>
<p>Almeida-Neto, M. &amp; Ulrich, W. (2011) A straightforward computational approach for measuring nestedness using quantitative matrices. <em>Environmental Modelling &amp; Software</em> <b>26</b>, 173&ndash;178
</p>
<p>Bascompte, J., Jordano, P. and Olesen, J. M. 2006 Asymmetric coevolutionary networks facilitate biodiversity maintenance. <em>Science</em> <b>312</b>, 431&ndash;433
</p>
<p>Bersier, L. F., Banasek-Richter, C. and Cattin, M. F. (2002) Quantitative descriptors of food-web matrices. <em>Ecology</em> <b>83</b>, 2394&ndash;2407
</p>
<p>Blüthgen, N. (2010) Why network analysis is often disconnected from community ecology: A critique and an ecologist's guide. <em>Basic and Applied Ecology</em> <b>11</b>, 185&ndash;195
</p>
<p>Blüthgen, N., Menzel, F., Hovestadt, T., Fiala, B. and Blüthgen N. 2007 Specialization, constraints and conflicting interests in mutualistic networks. <em>Current Biology</em> <b>17</b>, 1&ndash;6
</p>
<p>Burgos, E., H. Ceva, R.P.J. Perazzo, M. Devoto, D. Medan, M. Zimmermann, and A. Maria Delbue (2007) Why nestedness in mutualistic networks? <em>Journal of Theoretical Biology</em> <b>249</b>, 307&ndash;313
</p>
<p>Corso G, de Araújo AIL, de Almeida AM (2008) A new nestedness estimator in community networks. <em>arXiv</em> 0803.0007v1 [physics.bio-ph]
</p>
<p>Devoto M., Bailey S., Craze P., and Memmott J. (2012) Understanding and planning ecological restoration of plant-pollinator networks. <em>Ecology Letters</em> <b>15</b>, 319&ndash;328. http://dx.doi.org/10.1111/j.1461-0248.2012.01740.x
</p>
<p>Dormann, C.F., Fründ, J., Blüthgen, N., and Gruber, B. (2009) Indices, graphs and null models: analysing bipartite ecological networks. <em>The Open Ecology Journal</em> <b>2</b>, 7&ndash;24.
</p>
<p>Dunne, J. A., R. J. Williams, and N. D. Martinez 2002. Food-web structure and network theory: the role of connectance and size. <em>Proceedings of the National Academy of Science USA</em> <b>99</b>, 12917&ndash;12922
</p>
<p>Galeano, J., Pastor, J.M. and Iriondo, J.M. 2008. Weighted-Interaction Nestedness Estimator (WINE): A new estimator to calculate over frequency matrices. <em>arXiv</em> 0808.3397v1 [physics.bio-ph]
</p>
<p>Gotelli, N. J., and G. R. Graves. 1996 Null Models in Ecology. Smithsonian Institution Press, Washington D.C.
</p>
<p>Jost, L. 2010. The relation between evenness and diversity. <em>Diversity</em> <b>2</b>, 207&ndash;232. https://doi.org/10.3390/d2020207 
</p>
<p>Krebs, C. J. 1989. Ecological Methodology. Harper Collins, New York.
</p>
<p>Memmott, J., Waser, N. M. and Price M. V. 2004. Tolerance of pollination networks to species extinctions. <em>Proceedings of the Royal Society B</em> <b>271</b>, 2605&ndash;2611
</p>
<p>Müller, C. B., Adriaanse, I. C. T., Belshaw, R. and Godfray, H. C. J. 1999. The structure of an aphid-parasitoid community. <em>Journal of Animal Ecology</em> <b>68</b>, 346&ndash;370
</p>
<p>Roberts, A. and Stone, L. 1990 Island-sharing by archipelago species. <em>Oecologia</em> <b>83</b>, 560&ndash;567
</p>
<p>Rodríguez-Girónes M.A., and Santamaría L. 2006. A new algorithm to calculate the nestedness temperature of presence-absence matrices. <em>Journal of Biogeography</em> <b>33</b>, 924&ndash;935
</p>
<p>Schluter, D. 1984. A variance test for detecting species associations, with some example applications. <em>Ecology</em> <b>65</b>, 998-1005.
</p>
<p>Staniczenko, P., Kopp, J. &amp; Allesina, S. (2013) The ghost of nestedness in ecological networks. <em>Nat. Commun.</em> <b>4</b>, 1391. <a href="https://doi.org/10.1038/ncomms2422">doi:10.1038/ncomms2422</a>
</p>
<p>Stone, L. and Roberts, A. 1990. The checkerboard score and species distributions. <em>Oecologia</em> <b>85</b>, 74&ndash;79.
</p>
<p>Stone, L. and Roberts, A. 1992. Competitive exclusion, or species aggregation? An aid in deciding. <em>Oecologia</em> <b>91</b>, 419&ndash;424
</p>
<p>Tylianakis, J. M., Tscharntke, T. and Lewis, O.T. 2007. Habitat modification alters the structure of tropical host-parasitoid food webs. <em>Nature</em> <b>445</b>, 202&ndash;205
</p>
<p>Watts, D. J. and Strogatz, S. 1998. Collective dynamics of &lsquo;small-world&rsquo; networks. <em>Nature</em> <b>393</b>, 440&ndash;442
</p>


<h3>See Also</h3>

<p> Some functions are implemented separately: <code><a href="#topic+H2fun">H2fun</a></code>, <code><a href="#topic+second.extinct">second.extinct</a></code>, <code><a href="#topic+degreedistr">degreedistr</a></code>, <code><a href="#topic+C.score">C.score</a></code> and <code><a href="#topic+V.ratio">V.ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Safariland)
networklevel(Safariland)
networklevel(Safariland, index="ALLBUTDD") #excludes degree distribution fits

## End(Not run)
</code></pre>

<hr>
<h2 id='nodespec'>Calculates the node-based specialisation index </h2><span id='topic+nodespec'></span>

<h3>Description</h3>

<p>Calculates a specialisation index based on the node positions for all species 
in a bipartite network, separately for the higher and lower trophic level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nodespec(web, inf.replace = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nodespec_+3A_web">web</code></td>
<td>
<p>A matrix with lower trophic level species as rows, higher trophic level species as columns and number of interactions as entries.</p>
</td></tr>
<tr><td><code id="nodespec_+3A_inf.replace">inf.replace</code></td>
<td>
<p>What should infinite geodesic distances (e.g. between compartments)  be represented as? Defaults to <span class="option">NA</span>; only currently implemented alternative is <span class="option">inf.replace=Inf</span>, which replaces infinite distances by the maximum path length plus 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This index aims to describe the functional specialisation of pollinators and was proposed by Dalgaard et al. (2008). It is a purely qualitative measure. 
</p>
<p>After calculating the geodesic distances between species, i.e. the minimum number of steps from one species to another, these values are averaged for each species. 
This mean geodesic distance is interpreted as functional specialisation (Dalgaard et al. 2008).
</p>
<p>Notice that this &ldquo;new&rdquo; index is in fact little else than the inverse of (unscaled) closeness centrality in disguise.
</p>


<h3>Value</h3>

<p>A list with two components, names &ldquo;higher&rdquo; and &ldquo;lower&rdquo;, both containing the node specialisation index for each species.
</p>


<h3>Note</h3>

<p>This index is as yet unevaluated. We don't know how it responds to true specialisation at all. In fact, it is a rather good example of how to get a new thing published 
without even having demonstrated in which way it differs from existing indices of specialisation (such as standardised d included in the function <code><a href="#topic+dfun">dfun</a></code>), 
or how it performs on artificial data with known properties.
</p>
<p>One major disadvantage of any index based on path lenghts is its difficulty with compartments, i.e. species not linked to the rest of the network. There are, generally 
speaking, three ways to handle this: Firstly, ignore it (that is, set infinite distances to <code>NA</code>; our default). Secondly, leave it as it is (that is, leave infinite distances 
as infinite). This is not really an option, since then ALL species would have infinite specialisation values. Thirdly, replace infinite by the largest distance plus one (see 
comments in <code>geodist</code> in <span class="pkg">sna</span>). That would probably be a plausible thing to do, since we could argue that with a little bit extra observation we might have 
found a species linking a compartment to the rest of the network. However, this solution is &ldquo;not canonical&rdquo;, as put in <code>geodist</code> and hence biased to an 
unknown extent. To use this option, specify <span class="option">inf.replace=Inf</span>.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a></p>


<h3>References</h3>

 
<p>Dalsgaard, B., Martín González, A. M., Olesen, J. M., Timmermann, A., Andersen, L. H. and Ollerton, J. (2008) Pollination networks and functional specialization: a test using Lesser Antillean plant-hummingbird assemblages. <em>Oikos</em> <b>117</b>, 789&ndash;793
</p>


<h3>See Also</h3>

<p> See also as <code><a href="#topic+specieslevel">specieslevel</a></code>, which calls <code>nodespec</code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
nodespec(Safariland, inf.replace=Inf)
</code></pre>

<hr>
<h2 id='NOS'>Calculates the node overlap and separation according to Strona &amp; Veech (2015)</h2><span id='topic+NOS'></span>

<h3>Description</h3>

<p>This index computes a variation of nestedness, called node overlap and segragation, as well as a modularity measure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NOS(web, keep.Nij=FALSE, keep.diag=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NOS_+3A_web">web</code></td>
<td>
<p>A bipartite interaction web, i.e.~a matrix with higher (cols) and lower (rows) trophic levels.</p>
</td></tr>
<tr><td><code id="NOS_+3A_keep.nij">keep.Nij</code></td>
<td>
<p>Shall node overlap matrix for each trophic level be returned, too? Logical, defaults to FALSE.</p>
</td></tr>
<tr><td><code id="NOS_+3A_keep.diag">keep.diag</code></td>
<td>
<p>Shall the diagonal of Nij be kept at a value of 1, or rather be omitted from computations? If the diagnoal is kept, the index will not be centred on zero as described in the paper. However, the paper is unclear about this point, and hence the option to keep the diagonal (rather than setting omitting it from computation) is offered. Logical, defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>According to the authors, NOS is &ldquo;a new statistical procedure to measure both [the tendency of network nodes to share interaction partners] and the opposite one (i.e. species’ tendency against sharing interacting partners) that we call &lsquo;node segregation&rsquo;. In addition, our procedure provides also a straightforwardmeasure of modularity, that is, the tendency of a network to be compartmented into separated clusters of interacting nodes.&rdquo;
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Nbar</code></td>
<td>
<p>the NOS-value (referred to by the authors as a funny N (which with the fc-package in LaTeX is coded as <code style="white-space: pre;">&#8288;\m{J}&#8288;</code>, apparently).</p>
</td></tr> 
<tr><td><code>mod</code></td>
<td>
<p>modularity, computed as mean standard deviation of the Nij-values for each trophic level.</p>
</td></tr>
<tr><td><code>Nbar_higher</code></td>
<td>
<p>the NOS-value for the higher trophic level.</p>
</td></tr>
<tr><td><code>Nbar_lower</code></td>
<td>
<p>the NOS-value for the lower trophic level.</p>
</td></tr>
<tr><td><code>mod_higher</code></td>
<td>
<p>the mod-value for the higher trophic level.</p>
</td></tr>
<tr><td><code>mod_lower</code></td>
<td>
<p>the mod-value for the lower trophic level.</p>
</td></tr>
<tr><td><code>N_ij_higher</code></td>
<td>
<p>Optional; the matrix of NOS-values for each species pair, for the higher trophic level.</p>
</td></tr>
<tr><td><code>N_ij_lower</code></td>
<td>
<p>Optional; the matrix of NOS-values for each species pair, for the lower trophic level.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a>, with additional code provided by &ldquo;tchen98&rdquo; (on github).</p>


<h3>References</h3>

 
<p>Strona, G., and Veech, J.A. (2015) A new measure of ecological network structure based on node overlap and segregation.
<em>Methods in Ecology &amp; Evolution</em> <b>15</b>, 319&ndash;328
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grouplevel">grouplevel</a></code>, which eventually shall use this function.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
# illustrate difference between keeping/removing the diagonal:
NOS(Safariland)
NOS(Safariland, keep.diag=TRUE)
</code></pre>

<hr>
<h2 id='npartite'>Computes indices for a masked-one-mode network</h2><span id='topic+npartite'></span>

<h3>Description</h3>

<p>Computes network indices for networks that are represented as stacks of bipartite networks (&ldquo;npartite&rdquo;), thus having many impossible links.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>npartite(as.one.mode.web, index=c("connectance", "links per species", "mean degree"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="npartite_+3A_as.one.mode.web">as.one.mode.web</code></td>
<td>
<p>a one-mode representation of a network; if this is based on several bipartite networks, i.e. species in levels NOT interacting within that level OR without interactions between separated levels (e.g. 1st and 3rd) then such forbidden links must be represented as NA! For bipartite networks this can easily be achieved using as.one.mode(., fill=NA), but obviously for bipartite networks this function is obsolete.</p>
</td></tr>
<tr><td><code id="npartite_+3A_index">index</code></td>
<td>
<p>Vector of names of indices to be computed for the npartite network. Currently only <span class="option">connectance</span> and <span class="option">links per species</span> (=<span class="option">mean degree</span>) are available.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of indices.
</p>


<h3>Note</h3>

<p>An attempt is made to ensure that these indices converge to the same value as returned for a bipartite network!
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a> </p>


<h3>See Also</h3>

<p><code><a href="#topic+as.one.mode">as.one.mode</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>image(aomw &lt;- as.one.mode(Safariland, fill=NA))
npartite(aomw)
networklevel(Safariland, index=c("connectance", "links per species"))
</code></pre>

<hr>
<h2 id='null.distr'> Null model based on fitted marginal distribution </h2><span id='topic+null.distr'></span>

<h3>Description</h3>

<p>Given a network, this function fits a distribution to the marginal totals and then draws randomly from this distribution to yield a new network</p>


<h3>Usage</h3>

<pre><code class='language-R'>null.distr(N, web, distr="lognormal")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="null.distr_+3A_n">N</code></td>
<td>
<p>Number of null model web to be generated.</p>
</td></tr>
<tr><td><code id="null.distr_+3A_web">web</code></td>
<td>
<p>A (bipartite) network matrix.</p>
</td></tr>
<tr><td><code id="null.distr_+3A_distr">distr</code></td>
<td>
<p>The name of the distribution to be fitted to the marginal totals. Currently only the lognormal (<span class="option">lognormal</span> or <span class="option">log-normal</span>) and the negative binomial (<span class="option">negative binomial</span> or <span class="option">negbin</span>) are supported. Defaults to lognormal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This package provides several functions to generate null models for the observed data (see <code><a href="#topic+nullmodel">nullmodel</a></code>). However, this function deviates from any of these in that it does not hold the marginal totals as constant. Rather, it sees them as a random draw of some underlying distribution. This distribution is fitted (in a very ad hoc manner) to the data.  The inspiration for this function comes from Bl¸thgen et al. (2008).
</p>
<p>In the next step, the same number of species is drawn from this distribution randomly, and a new matrix is generated as the cross-product of these new vectors. The matrix is then standardised to sum to 1. It now serves as probability of drawing an interaction for any of its cells. 
</p>
<p>As many interactions as were observed are drawn (given the above probabilities) and hence a new, null matrix is generated.
</p>
<p>In case of the negative binomial fit (and random draw), some 0-values will result from the random draws. As a consequence, the dimension of the matrix can be dramatically lower than the observed. To avoid this, I simply add 1 to each marginal total value. Again, this is very ad hoc and not statistically justified. In fact, values already large should not receive an additional observation (as shown by Dewdney 1998 in a very different context). 
</p>
<p>NOTE 1: The fitted distribution is not supposed to represent the true distribution behind the abundances, but merely one way to have new marginal totals. In fact, in many cases the marginal totals aren't lognormal (or negative binomial), but much more skewed than that!  
</p>
<p>NOTE 2: Although the dimensions of the new, null web CAN be the same as that of the original, quite often they will be lower. This is because some species have a very low probability of being observed, and only in webs with many observations they will be. Stochasticity may render some species unobserved. <b>The consequences are potentially large!</b> As species are lost, relative linkage density goes up automatically, which affects virtually every network index!
</p>


<h3>Value</h3>

<p>A list of N new matrices with the same number of interactions, but possibly different dimensions.</p>


<h3>Author(s)</h3>

<p>Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt;</p>


<h3>References</h3>

<p>Blüthgen, N., Fründ, J., Vázquez, D. P. and Menzel, F. 2008. What do interaction network metrics tell us about specialisation and biological traits? <em>Ecology</em>, <b>89</b>, 3387&ndash;3399.
</p>
<p>Dewdney, A.K. 1998. A general theory of the sampling process with applications to the &ldquo;veil line&rdquo;. <em>Theoretical Population Biology</em>, <b>54</b>, 294&ndash;302.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+nullmodel">nullmodel</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Safariland)
null.distr(N=2, Safariland)
null.distr(N=2, Safariland, distr="negbin")

round(networklevel(Safariland, "info"), 3)
sapply(null.distr(N=5, Safariland), function(x) networklevel(x, index="info"))
# highly connected
sapply(null.distr(N=5, Safariland, distr="negbin"), function(x) networklevel(x, 
	index="info")[3])
# similarly highly connected

## End(Not run)
</code></pre>

<hr>
<h2 id='null.t.test'>Compares observed pattern to random webs.</h2><span id='topic+null.t.test'></span>

<h3>Description</h3>

<p>A little null-model function to check, if the observed values actually are much different to what one would expect under random numbers given the observed row and column totals (i.e.~information in the structure of the web, not only in its species' abundances). Random matrices are based on the function <code><a href="stats.html#topic+r2dtable">r2dtable</a></code>. The test itself is a t-test (with all its assumptions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>null.t.test(web, N = 30, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="null.t.test_+3A_web">web</code></td>
<td>
<p>A matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows).</p>
</td></tr>
<tr><td><code id="null.t.test_+3A_n">N</code></td>
<td>
<p>Number of null models to be produced; see &lsquo;Note&rsquo; below!</p>
</td></tr>
<tr><td><code id="null.t.test_+3A_...">...</code></td>
<td>
<p>Optional parameters to be passed on to the functions
<code><a href="#topic+networklevel">networklevel</a></code> and <code><a href="stats.html#topic+t.test">t.test</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is only a very rough null-model test. There are various reasons why one may consider <code>r2dtable</code> as an incorrect way to construct null models (e.g.~because it yields very different connectance values compared to the original). It is merely used here to indicate into which direction a proper development of null models may start off. Also, if the distribution of null models is very skewed, a t-test is obviously not the test of choice.
</p>
<p>Finally, not all indices will be reasonably testable (e.g.~number of species is fixed), or are returned by the function <code><a href="#topic+networklevel">networklevel</a></code> in a form that <code>null.t.test</code> can make use of (e.g.~degree distribution fits).
</p>


<h3>Value</h3>

<p>Returns a table with one row per index, and columns giving
</p>
<table role = "presentation">
<tr><td><code>obs</code></td>
<td>
<p>observed value</p>
</td></tr>
<tr><td><code>null mean</code></td>
<td>
<p>mean null model value</p>
</td></tr>
<tr><td><code>lower CI</code></td>
<td>
<p>lower 95% confidence interval (or whatever level is specified in the function's call)</p>
</td></tr>
<tr><td><code>upper CI</code></td>
<td>
<p>upper 95% confidence interval (or whatever level is specified in the function's call)</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>t-statistic</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>P-value of t statistic</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is rather slow. Using large replications in combination with iterative indices (degree distribution, compartment diversity, extinction slope, H2) may lead to rather long runtimes!
</p>


<h3>Author(s)</h3>

<p>Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mosquin1967)
null.t.test(mosquin1967, index=c("generality", "vulnerability",
    "cluster coefficient", "H2", "ISA", "SA"), nrep=2, N=10)
</code></pre>

<hr>
<h2 id='nullmodel'>Generates null models for network analysis</h2><span id='topic+nullmodel'></span>

<h3>Description</h3>

<p>A wrapper function for convenient generation of null models for quantitative and binary networks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nullmodel(web, N=1000, method="r2d", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nullmodel_+3A_web">web</code></td>
<td>
<p>Web is a matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey.</p>
</td></tr>
<tr><td><code id="nullmodel_+3A_n">N</code></td>
<td>
<p>number of null models to be generated; defaults to 1000 (more might be better, less probably not).</p>
</td></tr>
<tr><td><code id="nullmodel_+3A_method">method</code></td>
<td>
<p>Null model type. Can be given as an integer or name: 1/&quot;r2dtable&quot;, 2/&quot;swap.web&quot;, 3/&quot;vaznull&quot;, 4/&quot;shuffle.web&quot;, 5/&quot;mgen&quot;; allows for partial match of names; methods 1 to 4 works for quantitative webs, 4 and 5 for binary.</p>
</td></tr>
<tr><td><code id="nullmodel_+3A_...">...</code></td>
<td>
<p>arguments to be passed to the function generating the specific null models, see there for options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ADVICE: Look at the same-named function in <span class="pkg">vegan</span>, as well as the long list of potential null models described in <code>commsim</code> in that package. It offers a richer and more standardised implementation of null models than this (earlier) function. In particular the method <span class="option">shuffle.web</span> is potentially confusing, as it calls <span class="pkg">bipartite</span>'s <code>shuffle.web</code> for quantitative networks, but <span class="pkg">vegan</span>'s <span class="option">quasiswab</span> algorithm for binary. Since <span class="pkg">vegan</span> also now offers the argument <span class="option">greedyqswap</span> for quantitative networks, please have a look at <span class="pkg">vegan</span>'s <code><a href="#topic+nullmodel">nullmodel</a></code> function.
</p>
<p>This is only a wrapper function to facilitate and standardise the generation of null models.
</p>
<p>These null models assume that interaction weights are integers that represent frequencies that are &ldquo;individually&rdquo; counted, not decimal numbers. Multiplication by 1000 (say) and rounding does NOT necessarily make your value frequencies satisfy this assumption. Null models for &ldquo;continuously quantitative&rdquo; webs still have to be developed!
</p>
<p>A warning is returned when all entries in a quantitative network are 0 or 1 (which suggests a binary network).
</p>


<h3>Value</h3>

<p>Returns a list of <code>N</code> null model-generated networks. Species names are (obviously) dropped.
</p>


<h3>Note</h3>

<p>When a quantitative network contains only 1s (as may happen when sampling intensity is low), the quantitative null model will be extremely similar (often identical) to the observed network. This is no error. It is reflecting the fact that this network contains little (no) information beyond the abundances.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a></p>


<h3>See Also</h3>

<p> For the functions generating the null model network: <code><a href="#topic+shuffle.web">shuffle.web</a></code>, <code><a href="#topic+swap.web">swap.web</a></code>, <code><a href="#topic+vaznull">vaznull</a></code>, <code><a href="#topic+mgen">mgen</a></code>, <code>vegan::simulate</code> and <code>r2dtable</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
	data(Safariland)
	nullmodel(Safariland, N=2, method=1)
	nullmodel(Safariland&gt;0, N=2, method=4)
	# analysis example:
	obs &lt;- unlist(networklevel(Safariland, index="weighted nestedness"))
	nulls &lt;- nullmodel(Safariland, N=100, method=1)
	null &lt;- unlist(sapply(nulls, networklevel, index="weighted nestedness")) #takes a while ...
	
	plot(density(null), xlim=c(min(obs, min(null)), max(obs, max(null))), 
		main="comparison of observed with null model Patefield")
	abline(v=obs, col="red", lwd=2)    
	
	praw &lt;- sum(null&gt;obs) / length(null)
	ifelse(praw &gt; 0.5, 1-praw, praw)    # P-value
	
	# comparison of null model 4 and 5 for binary:
	nulls4 &lt;- nullmodel(Safariland&gt;0, N=100, method=4)
	nulls5 &lt;- nullmodel(Safariland&gt;0, N=100, method=5)
	null4 &lt;- unlist(sapply(nulls4, networklevel, index="weighted nestedness"))
	null5 &lt;- unlist(sapply(nulls5, networklevel, index="weighted nestedness"))
	
	
	plot(density(null4), xlim=range(c(null4, null5)), lwd=2, 
		main="comparison of null models")
	lines(density(null5), col="red", lwd=2)
	legend("topright", c("shuffle", "mgen"), col=c("black", "red"), lwd=c(2,2), 
		bty="n", cex=1.5)
	abline(v=networklevel(Safariland&gt;0, index="weighted nestedness"))
	
## End(Not run)
</code></pre>

<hr>
<h2 id='olesen2002aigrettes'> A flower visitation network from the Azores</h2><span id='topic+olesen2002aigrettes'></span>

<h3>Description</h3>

<p>The structure of pollination networks were investigated for two oceanic islands, the Azorean Flores and the Mauritian Ile aux Aigrettes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(olesen2002aigrettes)</code></pre>


<h3>Details</h3>

<p>The authors recorded their data by counting the number of visits of each flower visitor species to each plant species. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>References</h3>

<p>Olesen, J. M., L. I. Eskildsen, and S. Venkatasamy. 2002. Invasion of pollination networks on oceanic islands: importance of invader complexes and endemic super generalists. <em>Diversity and Distributions</em> <b>8</b>, 181&ndash;192.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(olesen2002aigrettes)
## maybe str(olesen2002aigrettes) ; plot(olesen2002aigrettes) ...
</code></pre>

<hr>
<h2 id='olesen2002flores'> Another flower visitation network from the Azores</h2><span id='topic+olesen2002flores'></span>

<h3>Description</h3>

<p>The structure of pollination networks were investigated for two oceanic islands, the Azorean Flores and the Mauritian Ile aux Aigrettes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(olesen2002flores)</code></pre>


<h3>Details</h3>

<p>The authors recorded their data by counting the number of visits of each flower visitor species to each plant species. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>References</h3>

<p>Olesen, J. M., L. I. Eskildsen, and S. Venkatasamy. 2002. Invasion of pollination networks on oceanic islands: importance of invader complexes and endemic super generalists. <em>Diversity and Distributions</em> <b>8</b>, 181&ndash;192
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(olesen2002flores)
## maybe str(olesen2002flores) ; plot(olesen2002flores) ...
</code></pre>

<hr>
<h2 id='olito2015'> A pollination network from the Canadian Rockies</h2><span id='topic+olito2015'></span>

<h3>Description</h3>

<p>The total number of individuals collected on each plant species provide a rough estimate of the level of visitation that each species received.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(olito2015)</code></pre>


<h3>Details</h3>

<p>The authors studied the plant–pollinator assemblage in a large, contiguous low-alpine meadow on the east face of Mt Murray, located in the Canadian Rockies in Kananaskis Country, Alberta, during summer 2010. They sampled interactions between plants and pollinators in a square 1-ha plot located at 2350–2410 m elevation on every day that weather conditions were suitable for pollinator flight, from the day of first flowering, until killing frosts occurred and pollinators were no longer observed (24 June 2010 – 26 August 2010, a total of 32 sampling days). That is, they sampled on as many days as was biologically possible. The authors recorded plant–pollinator interactions along three 2 m x 100 m transects between the lower and upper plot boundaries. 
</p>
<p>An interaction was recorded when an insect visitor was observed contacting floral reproductive structures. The authors documented interactions between 41 flowering plant species and 125 insect species, and constructed a quantitative plant–pollinator interaction matrix, with rows and columns corresponding to plant and pollinator species respectively, and cell values indicating the number of visits observed between corresponding plant and pollinator species. All network data, as well as a more detailed description of the study system and sampling methods are available as an online supplement (Supplementary material Appendix 1 – 2). Network data is also available from the Dryad Digital Repository <a href="https://doi.org/10.5061/dryad.7st32">doi:10.5061/dryad.7st32</a>.
</p>


<h3>References</h3>

<p>When using this data, please cite the original publication:
</p>
<p>Olito C, Fox JW (2015) Species traits and abundances predict metrics of plant–pollinator network structure, but not pairwise interactions. Oikos 124(4): 428&ndash;436. 
</p>
<p>Additionally, please cite the Dryad data package:
</p>
<p>Olito C, Fox JW (2014) Data from: Species traits and abundances predict metrics of plant–pollinator network structure, but not pairwise interactions. Dryad Digital Repository. <a href="https://doi.org/10.5061/dryad.7st32">doi:10.5061/dryad.7st32</a> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(olito2015)
plotweb(olito2015)
</code></pre>

<hr>
<h2 id='ollerton2003'>ollerton2003</h2><span id='topic+ollerton2003'></span>

<h3>Description</h3>

<p>A flower visitation network from an upland grassland site in the KwaZulu-Natal reagion, South Africa
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ollerton2003)</code></pre>


<h3>Format</h3>

<p>A data frame with 9 observations on the following 56 variables.
</p>


<h3>Details</h3>

<p>The study was conducted in the KwaZulu-Natal region of South Africa. During 3 months of fieldwork the flower visitors and pollinators to a assemblage of nine asclepiads at an upland grassland site were studied Two of the specialized pollination systems that were documented are new to the asclepiads: fruit chafer pollination and pompilid wasp pollination (the latter is almost unique in the angiosperms).
</p>
<p>The authors recorded their data by counting the number of individua flower visitors observed and/or caught on each plant species. The total number of individuals observed on each plant species provide a rough estimate of the level of visitation that each species received. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction. 
</p>


<h3>Source</h3>

<p>NCEAS data base on interaction webs: <a href="https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator">https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator</a> 
</p>


<h3>References</h3>

<p>Ollerton, J., S.D. Johnson, L. Cranmer and S. Kellie (2003) The pollination ecology of an assemblage of grassland asclepiads in South Africa. <em>Annals of Botany</em> <b>92</b> 807&ndash;834  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ollerton2003)
plotweb(ollerton2003)
## maybe str(ollerton2003) ; plot(ollerton2003) ...
</code></pre>

<hr>
<h2 id='PAC'>Potential for Apparent Competition</h2><span id='topic+PAC'></span>

<h3>Description</h3>

<p>Quantifies, for each pair of lower trophic level species, the potential for showing apparent competition with another species, mediated through the higher trophic level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PAC(web)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PAC_+3A_web">web</code></td>
<td>
<p>A host-parasitoid network (or alike), where the entries represent the <b>sum of parasitoids emerging from the interactions between parasitoid and host</b> (i.e. number of interactions * number of parasitoid individuals emerging from each host). Only if there is only one parasitoid per host this web will be the same as that used in all other calculations in this package!</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the potential for apparent competition (Holt 1977), following the formula given in Müller et al. (1999) and Morris et al. (2005). See also Morris et al. (2004) for an experimental test.
</p>


<h3>Value</h3>

<p>Returns a k x k matrix with entries d.ij, where k is the number of species in the lower trophic level and i and j are lower trophic level species. The matrix represents the effect of column species on row species. Diagonal entries are &ldquo;apparent intraspecific competition&rdquo;.
</p>


<h3>Note</h3>

<p>The idea is that in host-parasitoid networks one host also affects other hosts by the number of parasitoid that hatch from it and are thus added to the pool of parasitoids. An abundant, large host can (involuntarily) contribute many parasitoids to the pool, thus also increasing the parasitoid burden of other hosts. This looks like competition between the two hosts, while in fact it is mediated through the other trophic level. 
</p>
<p>Whether this concept can be usefully applied to mutualist networks (such as flower visitation networks, aka pollination webs) is still under-investigated. The study of Carvalheiro et al. (2014) provide an example for constructive use in mutualistic networks.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a></p>


<h3>References</h3>

 
<p>Carvalheiro, L.G., Biesmeijer, J.C., Benadi, G., Fründ, J., Stang, M., Bartomeus, I., Kaiser-Bunbury, C.N., Baude, M., Gomes, S.I.F., Merckx, V., Baldock, K.C.R., Bennett, A.T.D., Boada, R., Bommarco, R., Cartar, R., Chacoff, N., Dänhardt, J., Dicks, L. V., Dormann, C.F., Ekroos, J., Henson, K.S.E., Holzschuh, A., Junker, R.R., Lopezaraiza-Mikel, M., Memmott, J., Montero-Castaño, A., Nelson, I.L., Petanidou, T., Power, E.F., Rundlöf, M., Smith, H.G., Stout, J.C., Temitope, K., Tscharntke, T., Tscheulin, T., Vilà, M. &amp; Kunin, W.E.  2014 The potential for indirect effects between co-flowering plants via shared pollinators depends on resource abundance, accessibility and relatedness. <em>Ecology Letters</em> <b>17</b>, 1389&ndash;1399.
</p>
<p>Holt, R. D. 1977 Predation, apparent competition and the structure of prey communities. <em>Theoretical Population Biology</em> <b>12</b>, 197&ndash;229.
</p>
<p>Morris, R. J., Lewis, O. T. and Godfray, H. C. J. 2004 Experimental evidence for apparent competition in a tropical forest food web. <em>Nature</em> <b>428</b>, 310&ndash;313.
</p>
<p>Morris, R. J., Lewis, O. T. and Godfray, H. C. J. 2005 Apparent competition and insect community structure: towards a spatial perspective. <em>Annales Zoologica Fennici</em> <b>42</b>, 449&ndash;462.
</p>
<p>Müller, C. B., Adriaanse, I. C. T., Belshaw, R. and Godfray, H. C. J. 1999 The structure of an aphid-parasitoid community. <em>Journal of Animal Ecology</em> <b>68</b>, 346&ndash;370
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
PAC(Safariland)
</code></pre>

<hr>
<h2 id='PDI'>Paired Differences Index</h2><span id='topic+PDI'></span>

<h3>Description</h3>

<p> Computes the Paired Differences Index </p>


<h3>Usage</h3>

<pre><code class='language-R'>PDI(web, normalise=TRUE, log=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PDI_+3A_web">web</code></td>
<td>
<p>A bipartite interaction web, i.e.~a matrix with higher (cols) and lower (rows) trophic levels.</p>
</td></tr>

<tr><td><code id="PDI_+3A_normalise">normalise</code></td>
<td>
<p>Logical; divides for each species by the maximum of interactions. Thereby species can be compared among each other and values range between 0 and 1. Defaults to TRUE, which differs from Poisot et al. (2011a). Note that Tim Poisot also recommends the normalised computation as default.</p>
</td></tr>
<tr><td><code id="PDI_+3A_log">log</code></td>
<td>
<p>logical; since number of interactions is often highly skewed, the log yields a more even spread of PDI-values across species. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are many ways to skin a cat. This is a more recent addition proposed by Poisot et al. (2011a) and used for mutualistic network analysis by Poisot et al. (2011b). This function can be used alone or through <code><a href="#topic+specieslevel">specieslevel</a></code>. 
</p>
<p>If P is interaction strength (typically interaction frequency or proportion depending on argument <code>normalized</code>), then PDI for this species is computed as:
</p>
<p>sum(P1 - Pi) /(H-1), 
</p>
<p>where P1 is the highest number of interactions in a link, while Pi are the remaining values. H is the number of potential interactors (e.g. plant species if the target species is a pollinator). 
</p>


<h3>Value</h3>

<p>Returns a vector with PDI values between 0 (perfect generalist) and 1 (perfect specialist).
</p>


<h3>Note</h3>


<ol>
<li><p> When a binary web is fed to this function (e.g. <code>PDI(web&gt;0)</code>) this function returns Poisot et al.'s (2012) &ldquo;resource range&rdquo;. Resource range has a value of 0 when all resources are used, and a value of 1 when only one resource is used. It is thus more an &ldquo;unused resource range&rdquo;.
</p>
</li>
<li><p> This index was originally proposed for performance estimates with standardized resource frequency. It aims to characterize the performance decay as an organism moves away from its optimal resource. As such, it is strongly influenced by the performance on the optimal resource (by its absolute value with option <code>normalised=FALSE</code> and by its relative value in relation to the sum of all performances with <code>normalised=TRUE</code>). It is less clear what this index means for resource use data with variation in resource availability. In typical plant-flower visitor webs, PDI values may be close to 1 simply due to highly skewed plant abundance distributions.
</p>
</li>
<li><p> When interaction strength is estimated by a count variable (interaction frequency), PDI and many other indices are problematic for species with only one observation (singletons). In this case P1 is 1 (all interactions are on one plant species), all Pi are 0 and hence PDI is 1 - independent of the species' specialization. For a singleton we cannot estimate specificity, only discrimination (i.e. whether it happens to visit a common or rare plant species), as is done by d' (implemented in <code><a href="#topic+dfun">dfun</a></code>).
</p>
</li></ol>



<h3>Author(s)</h3>

<p> Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt; </p>


<h3>References</h3>

<p>Dormann, C.F. (2011) How to be a specialist? Quantifying specialisation in pollination networks. <em>Network Biology</em> <b>1</b>, 1&ndash;20
</p>
<p>Poisot, T., Lepennetier, G., Martinez, E., Ramsayer, J., and Hochberg, M.E. (2011a) Resource availability affects the structure of a natural bacteria-bacteriophage community. <em>Biology Letters</em> <b>7</b>, 201&ndash;204
</p>
<p>Poisot, T., Bever, J.D., Nemri, A., Thrall, P.H., and Hochberg, M.E. (2011b) A conceptual framework for the evolution of ecological specialisation. <em>Ecology Letters</em> <b>14</b>, 841&ndash;851
</p>
<p>Poisot, T., E. Canard, N. Mouquet, and M. E. Hochberg. 2012. A comparative study of ecological specialization estimators. <em>Methods in Ecology and Evolution</em> <b>3</b>, 537&ndash;544. 
</p>


<h3>See Also</h3>

<p> See also <code><a href="#topic+specieslevel">specieslevel</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
PDI(Safariland) # for pollinators
PDI(t(Safariland), log=TRUE) # for plants
</code></pre>

<hr>
<h2 id='plotmatrix'> Plot a matrix organised by topology </h2><span id='topic+plotmatrix'></span>

<h3>Description</h3>

<p>Plotmatrix is a function to plot binary and weighted matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotmatrix(x, background_color="white", base_color=NULL, between_color="black", 
  border_color="black", modules_colors=NULL, within_color = "black", border = FALSE, 
  row_partitions=NULL, col_partitions=NULL, binary=TRUE, plot_labels=FALSE, xlab=NA, 
  ylab=NA, offset = 0.4, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotmatrix_+3A_x">x</code></td>
<td>
<p>the first argument is an interaction matrix (rows and columns are nodes; cells are links between nodes) or the list returned by <code><a href="#topic+sortweb">sortweb</a></code>. The matrix may be binary (only 0s and 1s) or weighted.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_background_color">background_color</code></td>
<td>
<p>color of the background.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_base_color">base_color</code></td>
<td>
<p>define the base color for the gradient in weighted matrices. If <span class="option">NULL</span>, defaults to <span class="option">background_color</span>.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_between_color">between_color</code></td>
<td>
<p>color of links in the regions between modules. If the matrix is weighted, links between modules are colored following a gradient from the <span class="option">base_color</span> to the <span class="option">between_color</span>. Only applied if partitions are provided.</p>
</td></tr>  
<tr><td><code id="plotmatrix_+3A_border_color">border_color</code></td>
<td>
<p>color of the border plotted around modules (only if <span class="option">border = TRUE</span>).</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_modules_colors">modules_colors</code></td>
<td>
<p>optional vector with separate colors for modules. Its lengths must match the number of partitions. If the matrix is weighted, links in each module are colored following a gradient from the <span class="option">base_color</span> to the colors in <span class="option">modules_color</span>. Only applied if partitions are provided.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_within_color">within_color</code></td>
<td>
<p>color of links in the regions within modules. If the matrix is weighted, links within modules are colored following a gradient from the <span class="option">base_color</span> to the <span class="option">within_color</span>. If partitions are not provided, defines the color of links for the entire network.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_border">border</code></td>
<td>
<p>logical; if <span class="option">TRUE</span>, a border is plotted around each module. Only applied if partitions are provided.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_row_partitions">row_partitions</code></td>
<td>
<p>optional vector with partitions for rows. The length of the vector must be the number of rows in the matrix, each value is the partition of the respective row, following the row sequence in the matrix. Partition can be defined by numeric or character values.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_col_partitions">col_partitions</code></td>
<td>
<p>same as <span class="option">row_partitions</span>, but for columns.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_binary">binary</code></td>
<td>
<p>logical; plot the binary or weighted information of the matrix. If the matrix is binary, must be <span class="option">TRUE</span>. If the matrix is weighted and binary is <span class="option">TRUE</span>, plot the binary structure of the matrix.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_plot_labels">plot_labels</code></td>
<td>
<p>logical: shall row and column names of the matrix be plotted?</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_xlab">xlab</code></td>
<td>
<p>label for the column axis</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_ylab">ylab</code></td>
<td>
<p>label for the row axis.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_offset">offset</code></td>
<td>
<p>defines the size of each filled cell, compared to the border of each cell. Values higher than 0.4 may result in overlapping of cells.</p>
</td></tr>
<tr><td><code id="plotmatrix_+3A_...">...</code></td>
<td>
<p>arguments passed on to <code>axis</code> ornamenting the image plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invoked for its side effect of plotting the matrix.</p>


<h3>Author(s)</h3>

<p> Rafael Barros Pereira Pinheiro <a href="mailto:rafael-bpp@hotmail.com">rafael-bpp@hotmail.com</a>, Gabriel Felix, Marco Mello, and the team of the Ecological Synthesis Lab, University of São Paulo</p>


<h3>See Also</h3>

<p>The output of <code>sortmatrix</code> is used by <code><a href="#topic+plotmatrix">plotmatrix</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>S &lt;- sortmatrix(Safariland, topology = "nested", sort_by = "weights")
plotmatrix(S)
plotmatrix(S$matrix, binary=TRUE)
</code></pre>

<hr>
<h2 id='plotModuleWeb'>plotModuleWeb</h2><span id='topic+plotModuleWeb'></span><span id='topic+prepareWebForPlottingModules'></span><span id='topic+addEmptyRowToMatrix'></span><span id='topic+addEmptyColToMatrix'></span><span id='topic+getModuleCoordinates'></span><span id='topic+isCorrectModuleWebObject'></span><span id='topic+drawModules'></span>

<h3>Description</h3>

<p>This function takes an object of class <code>moduleWeb</code> and plots the modules found by function <code>computeModules(...)</code> onto the graph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotModuleWeb(moduleWebObject, plotModules = TRUE, 
rank = FALSE, weighted = TRUE, displayAlabels = TRUE, 
displayBlabels = TRUE, labsize = 1, xlabel = "", ylabel = "", 
square.border = "white", fromDepth = 0, upToDepth = -1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotModuleWeb_+3A_modulewebobject">moduleWebObject</code></td>
<td>

<p>An object of class &quot;moduleWeb&quot;.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_plotmodules">plotModules</code></td>
<td>

<p>If <code>plotModules</code> is true, modules are plotted onto the graph, otherwise only the graph itself is plotted.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_rank">rank</code></td>
<td>
<p>logical; if true, rows will be standardised for plotting, yielding a range from light to dark blue for each row; if false, values are ranged across the entire matrix. The latter is more faithful to the data, while the former makes lower levels more comparable, irrespective of marginal totals.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_weighted">weighted</code></td>
<td>

<p>If <code>weighted</code> is true, the intensity of squares representing the edges corresponds with the edge weight, otherwise all squares representing existing edges have equal intensity.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_displayalabels">displayAlabels</code></td>
<td>

<p>Row labels are plotted, iff <code>displayAlabels</code> is true.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_displayblabels">displayBlabels</code></td>
<td>

<p>Column labels are plotted, iff <code>displayBlabels</code> is true.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_labsize">labsize</code></td>
<td>

<p><code>labsize</code> is the scalar factor with which the size of the plot labels can be changed.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_xlabel">xlabel</code></td>
<td>

<p><code>xlabel</code> is the label for the x-axis.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_ylabel">ylabel</code></td>
<td>

<p><code>ylabel</code> is the label for the y-axis.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_square.border">square.border</code></td>
<td>

<p>Background color of area with squares.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_fromdepth">fromDepth</code></td>
<td>

<p>Minimal depth of modules which should be plotted.
</p>
</td></tr>
<tr><td><code id="plotModuleWeb_+3A_uptodepth">upToDepth</code></td>
<td>

<p>Maximal depth of modules which should be plotted. If upToDepth is smaller then fromDepth, all modules are plotted.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot window with appropriate size according to the dimensions of the web.
</p>


<h3>Author(s)</h3>

<p>Rouven Strauss</p>


<h3>See Also</h3>

<p>See also function <code>visweb</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(small1976)

moduleWebObject = computeModules(small1976);
plotModuleWeb(moduleWebObject);

## End(Not run)
</code></pre>

<hr>
<h2 id='plotPAC'>
Function to draw a circular plot to visualise potential apparent competition (PAC)
</h2><span id='topic+plotPAC'></span>

<h3>Description</h3>

<p>Visualises the Potential for Apparent Competition as a circular graph with species represented by circles and shared parasitoids/predators/pollinators as connecting lines. Area of circles is proportional to species' abundance, filling of circles proportional to self-loops (e.g. parasitoids emerging from this species and then attacking it again) and width of connecting lines is proportional to &ldquo;export&rdquo; of parasitoids. The function is modelled after the example given in Morris et al. (2005)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPAC(web, scaling = 1, plot.scale = 1, fill.col = rgb(0.2, 0.2, 0.2, 0.5), 
arrow.col = rgb(0.5, 0.5, 0.5, 0.5), outby = 1, label=TRUE, text = TRUE, 
circles = FALSE, radius = 1, text.cex=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPAC_+3A_web">web</code></td>
<td>
<p>A community matrix with lower trophic level in rows and higher trophic level in columns.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_scaling">scaling</code></td>
<td>
<p>A factor scaling the size of species-circles. The default of 1 may cause overlap when there are many species or some are very large. Smaller values yield smaller circles.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_plot.scale">plot.scale</code></td>
<td>
<p>Scales the whole plot to the plotting region. If you want to add labels, you may want more space around the plot and hence choose smaller values for plot.scale.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_fill.col">fill.col</code></td>
<td>
<p>Colour of the species-circles. Note that the default is using transparency, which is the fourth parameter in the <code>rgb</code>-function.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_arrow.col">arrow.col</code></td>
<td>
<p>Colour(s) of the arrows (in fact polygons) connecting species. As for <span class="option">fill.col</span>, the default uses transparency. If more than one colour is provided, the links will be coloured in a somewhat complicated sequence, starting with the species with most interactions and then down. So it might require some playing around if you want to colour a specific arrow.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_outby">outby</code></td>
<td>
<p>A factor determining by how much the text labels should be moved out from the species-circles. Values smaller than 1 will move them inside the circle-plot.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_label">label</code></td>
<td>
<p>Logical; if TRUE (default), a number will be plotted next to each species-circle.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_text">text</code></td>
<td>
<p>Logical; if TRUE (default), the name (as provided by the row names of the input matrix) will be plotted.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_circles">circles</code></td>
<td>
<p>Logical; shall species labels be put into a circle (as in the original plot of Morris et al. 2005)? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_radius">radius</code></td>
<td>
<p>A factor modifying the size of the label-circles.</p>
</td></tr>
<tr><td><code id="plotPAC_+3A_text.cex">text.cex</code></td>
<td>
<p>A multiplier to scale the point labels by; defaults to 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is modelled after Morris et al. (2005). The whole idea and application is explained there, too. The only change to their plotting is the default choice of transparency for clarity of the visual effect.
</p>


<h3>Value</h3>

<p>None. The function is invoked for its side effects (i.e. printing).
</p>


<h3>Author(s)</h3>

<p>Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a>
</p>


<h3>References</h3>

<p>Morris, R. J., Lewis, O. T. and Godfray, H. C. J. 2005. Apparent competition and insect community structure: towards a spatial perspective. <em>Annales Zoologica Fennici</em> <b>42</b>, 449&ndash;462.
</p>


<h3>See Also</h3>

<p>See also comments and notes in <code><a href="#topic+PAC">PAC</a></code>!
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(kevan1970)
plotPAC(kevan1970)
plotPAC(kevan1970, arrow.col=rainbow(30))

data(Safariland)
plotPAC(Safariland, plot.scale=1, fill.col="red", arrow.col="orange", 
	circles=TRUE, radius=1)
	

## End(Not run)
</code></pre>

<hr>
<h2 id='plotweb'>Visualize a bipartite interaction matrix (e.g. a foodweb)</h2><span id='topic+plotweb'></span>

<h3>Description</h3>

<p>A two dimensional matrix is plotted as a bipartite graph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotweb(web,
    method = "cca", empty = TRUE, labsize = 1, ybig = 1,  y.width.low = 0.1, 
    y.width.high = 0.1, low.spacing = NULL, high.spacing = NULL,
    arrow="no",  col.interaction="grey80", col.high = "grey10", 
    col.low="grey10",  bor.col.interaction ="black", bor.col.high="black", 
    bor.col.low="black", high.lablength = NULL, low.lablength = NULL,
    sequence=NULL, low.abun=NULL, low.abun.col="green", 
    bor.low.abun.col ="black", high.abun=NULL, high.abun.col="red", 
    bor.high.abun.col="black", text.rot=0, text.high.col="black", 
    text.low.col="black", adj.high=NULL, adj.low=NULL, plot.axes = FALSE,
    low.y=0.5, high.y=1.5, add=FALSE, y.lim=NULL, x.lim=NULL, low.plot=TRUE, 
    high.plot=TRUE, high.xoff = 0, low.xoff = 0, high.lab.dis = NULL, 
    low.lab.dis = NULL, abuns.type="additional")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotweb_+3A_web">web</code></td>
<td>
<p> Web is a matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_method">method</code></td>
<td>
<p> Default method is <span class="option">cca</span>, which leads to as few crossings of interactions as possible. The other option is <span class="option">normal</span>, which leaves order as given by the matrix.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_empty">empty</code></td>
<td>
<p>logical; should empty columns or empty rows be omitted from plotting; defaults to true</p>
</td></tr>
<tr><td><code id="plotweb_+3A_labsize">labsize</code></td>
<td>
<p> factor for size of labels, default is 1 </p>
</td></tr>
<tr><td><code id="plotweb_+3A_ybig">ybig</code></td>
<td>
<p> vertical distance between upper and lower boxes, default is 1</p>
</td></tr>
<tr><td><code id="plotweb_+3A_y.width.low">y.width.low</code></td>
<td>
<p> width of lower boxes, default is 0.1 </p>
</td></tr>
<tr><td><code id="plotweb_+3A_y.width.high">y.width.high</code></td>
<td>
<p> width of upper boxes, default is 0.1 </p>
</td></tr>
<tr><td><code id="plotweb_+3A_low.spacing">low.spacing</code></td>
<td>
<p> distance between lower boxes, default is NULL, so automatically spaced that length of upper and lower boxes is the same. Be aware if set to any value that x.lim may has to be adjusted to ensure that the network is not plotted outside the plotting region</p>
</td></tr>
<tr><td><code id="plotweb_+3A_high.spacing">high.spacing</code></td>
<td>
<p> distance between upper boxes, default is is NULL, so automatically spaced that length of upper and lower boxes is the same. Be aware if set to any value that x.lim may has to be adjusted to ensure that the network is not plotted outside the plotting region</p>
</td></tr>
<tr><td><code id="plotweb_+3A_arrow">arrow</code></td>
<td>
<p> display type of connection between upper and lower boxes, options are <span class="option">up</span>, <span class="option">down</span>, <span class="option">both</span>, <span class="option">up.center</span>, <span class="option">down.center</span>, <span class="option">both.center</span> and <span class="option">no</span>, default is <span class="option">no</span>, which is a polygonal connection between boxes. </p>
</td></tr>
<tr><td><code id="plotweb_+3A_col.interaction">col.interaction</code></td>
<td>
<p>color of interaction, default is grey80. </p>
</td></tr>
<tr><td><code id="plotweb_+3A_col.high">col.high</code></td>
<td>
<p>color of upper boxes, default is grey10.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_col.low">col.low</code></td>
<td>
<p>color of lower boxes, default is grey10.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_bor.col.interaction">bor.col.interaction</code></td>
<td>
<p>border color of interaction, default is black</p>
</td></tr>
<tr><td><code id="plotweb_+3A_bor.col.high">bor.col.high</code></td>
<td>
<p>border color of upper boxes, default is black</p>
</td></tr>
<tr><td><code id="plotweb_+3A_bor.col.low">bor.col.low</code></td>
<td>
<p>border color of lower boxes, default is black</p>
</td></tr>
<tr><td><code id="plotweb_+3A_high.lablength">high.lablength</code></td>
<td>
<p>number of characters of upper labels that should be plotted. If zero no labels are shown, default is NULL which plots the complete labels.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_low.lablength">low.lablength</code></td>
<td>
<p>number of characters of lower labels that should be plotted. If zero no labels are shown, default is NULL which plots the complete labels.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_sequence">sequence</code></td>
<td>
<p>list of two with two names vectors: <code>seq.high</code> and <code>seq.low</code>, which specify the order in which species are plotted. Cannot be set for <span class="option">method="cca"</span>. Defaults to <code>NULL</code>, where the sequence remains as given or is determined by the CCA internally.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_low.abun">low.abun</code></td>
<td>
<p><b>Named</b> vector with independent abundance estimates for the lower trophic level, NULL if none exists. See Notes!</p>
</td></tr>
<tr><td><code id="plotweb_+3A_low.abun.col">low.abun.col</code></td>
<td>
<p>Colour for depicting the abundance estimates for the lower trophic level; defaults to green.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_bor.low.abun.col">bor.low.abun.col</code></td>
<td>
<p>border color for depicting the abundance estimates for the lower trophic level, default is black</p>
</td></tr>
<tr><td><code id="plotweb_+3A_high.abun">high.abun</code></td>
<td>
<p><b>Named</b> vector with independent abundance estimates for the higher trophic level, NULL if none exists. See Notes!</p>
</td></tr>
<tr><td><code id="plotweb_+3A_high.abun.col">high.abun.col</code></td>
<td>
<p>Colour for depicting the abundance estimates for the lower trophic level; defaults to red.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_bor.high.abun.col">bor.high.abun.col</code></td>
<td>
<p>border color for depicting the abundance estimates for the higher trophic level, default is black</p>
</td></tr>
<tr><td><code id="plotweb_+3A_text.rot">text.rot</code></td>
<td>
<p>orientation of labels in the plot (to avoid overlapping of horizontal labels if dimension of the webs are high), default is 0 for horizontal labels, use text.rot=90 for vertical labels.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_text.high.col">text.high.col</code></td>
<td>
<p>Colour for text labels of higher trophic level, a vector of colours can be given</p>
</td></tr>
<tr><td><code id="plotweb_+3A_text.low.col">text.low.col</code></td>
<td>
<p>Colour for text labels of lower trophic level. A vector of colours can be given</p>
</td></tr>
<tr><td><code id="plotweb_+3A_adj.high">adj.high</code></td>
<td>
<p>Adjust upper labels. See adj in ?text how to adjust labels </p>
</td></tr>
<tr><td><code id="plotweb_+3A_adj.low">adj.low</code></td>
<td>
<p>Adjust upper labels. See adj in ?text how to adjust labels </p>
</td></tr>
<tr><td><code id="plotweb_+3A_plot.axes">plot.axes</code></td>
<td>
<p>axis are plotted. Sometimes useful to place boxes in higher order plots. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="plotweb_+3A_low.y">low.y</code></td>
<td>
<p>Position of the higher boxes on the y-axis. Defaults to 1.5 </p>
</td></tr>
<tr><td><code id="plotweb_+3A_high.y">high.y</code></td>
<td>
<p>Position of the higher boxes on the y-axis. Defaults to 1.5 </p>
</td></tr>
<tr><td><code id="plotweb_+3A_add">add</code></td>
<td>
<p>if set to TRUE a new bipartite network is added to the previous plot. In this way multitrophic webs can be plotted, see examples below. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plotweb_+3A_y.lim">y.lim</code></td>
<td>
<p>To set limits for y-axis. Useful if labels are plotted outside the plotting region and for multitrophic plots, see examples below </p>
</td></tr>
<tr><td><code id="plotweb_+3A_x.lim">x.lim</code></td>
<td>
<p>To set limits for x-axis. Useful if labels are plotted outside the plotting region and for multitrophic plots, see examples below </p>
</td></tr>
<tr><td><code id="plotweb_+3A_low.plot">low.plot</code></td>
<td>
<p>Defines if lower boxes should be drawn. Use in multitrophic plots to avoid plotting boxes of some trophic levels - see examples below. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="plotweb_+3A_high.plot">high.plot</code></td>
<td>
<p>Defines if higher boxes should be drawn. Use in multitrophic plots to avoid plotting boxes of some trophic levels - see examples below. Defaults to TRUE</p>
</td></tr>
<tr><td><code id="plotweb_+3A_high.xoff">high.xoff</code></td>
<td>
<p>allows to set an offset to upper boxes. Useful if high.spacing is used to centre boxes manually. Use plot.axes=TRUE for easy centring</p>
</td></tr>
<tr><td><code id="plotweb_+3A_low.xoff">low.xoff</code></td>
<td>
<p>allows to set an offset to lower boxes. Useful if low.spacing is used to centre boxes manually. Use plot.axes=TRUE for easy centring</p>
</td></tr>
<tr><td><code id="plotweb_+3A_high.lab.dis">high.lab.dis</code></td>
<td>
<p>normally labels are staggered to avoid plotting over themselves. if set to 0, higher labels are all on one horizontal line. By using ad.low the position of the labels can be adjusted. If set to any other value labels are staggered with this distance. Defaults to NULL</p>
</td></tr>
<tr><td><code id="plotweb_+3A_low.lab.dis">low.lab.dis</code></td>
<td>
<p>normally labels are staggered to avoid plotting over themselves. if set to 0, lower labels are all on one horizontal line. By using ad.low the position of the labels can be adjusted. If set to any other value labels are staggered with this distance. Defaults to NULL</p>
</td></tr>
<tr><td><code id="plotweb_+3A_abuns.type">abuns.type</code></td>
<td>
<p>How to plot abundances - are they <span class="option">independent</span> (e.g. flower cover) measurements or are they <span class="option">additional</span> (e.g. unparasitised hosts) measurements? Defaults to <span class="option">additional</span>. Option <span class="option">none</span> is interpreted in the same way as <span class="option">additional</span>. See Notes!</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a window with a bipartite graph of a food web.  For all colours vectors can be used (which are recycled if length differs. Now more trophic webs can be plotted by using <code>plotweb</code> and the <span class="option">add</span> switch, which allows to add more webs and staggering them on top of each other. Preferred option is here to order webs by yourself and use <span class="option">method="normal"</span> to keep your preferred order. See examples on three and four trophic networks.
</p>


<h3>Note</h3>

<p>Note that in previous implementations, <span class="option">low.abun</span> and <span class="option">high.abun</span> was actually treated as 'additional abundances' (e.g. unparasitised hosts). We added the parameter <span class="option">abuns.type</span> to switch between the classic function (values <span class="option">none</span> and <span class="option">additional</span>, the default for backward compatibility) and an alternative function that plots fully independent abundance estimates (<span class="option">abuns.type="independent"</span>). To change box (species) colors with <span class="option">abuns.type='independent'</span>, use <span class="option">low.abun.col</span> and <span class="option">high.abun.col</span>. The function will likely be revised again in the future, so feedback welcome.
</p>
<p>If you have total abundance measure but want to plot used and unused resources, use <span class="option">abuns.type='additional'</span> and <span class="option">low.abun= your.low.abun - rowSums(web)</span>.
</p>


<h3>Author(s)</h3>

<p> Bernd Gruber <a href="mailto:bernd.gruber@canberra.edu.au">bernd.gruber@canberra.edu.au</a> </p>


<h3>References</h3>

<p>Tylianakis, J. M., Tscharntke, T. and Lewis, O. T. (2007) Habitat modification alters the structure of tropical host-parasitoid food webs. <em>Nature</em> <b>445</b>, 202&ndash;205
</p>


<h3>See Also</h3>

<p> For a different plot of food webs see  <code><a href="#topic+visweb">visweb</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
plotweb(Safariland)

# shorter labels
plotweb(Safariland, high.lablength=3, low.lablength=0, arrow="down")

# centered triangles for displaying interacions
plotweb(Safariland, text.rot=90, arrow="down.center", col.interaction="wheat2",
	y.lim=c(-1,2.5))

#orginal sequence, up arrows and different box width
plotweb(Safariland, method="normal", arrow="up", y.width.low=0.3, low.lablength=4)
# interactions as lines
plotweb(Safariland, arrow="both", y.width.low=0.05, text.rot=90, col.high="blue", 
	col.low="green")

# add an abundance vector for lower trophic species 
low.abun = round(runif(dim(Safariland)[1],1,40)) #create
names(low.abun) &lt;- rownames(Safariland)
plotweb(Safariland, text.rot=90, low.abun=low.abun, col.interaction="purple", 
	y.width.low=0.05, y.width.high=0.05)

plotweb(Safariland, text.rot=90, low.abun=low.abun, col.interaction ="red", 
	bor.col.interaction="red", arrow="down")

# now vectors for all colours can be given, to mark certain species or 
# interactions. Colour vectors are recycled if not of appropriate length
plotweb(Safariland,col.high=c("orange","green"))
plotweb(Safariland,col.low=c("orange","green"),col.high=c("white","grey","purple"),
	text.high.col=c("blue","red"), col.interaction=c("red",rep("green",26),rep("brown",242)),
	bor.col.interaction=c(rep("green",26),rep("brown",242)),method="normal", 
	text.rot=90, low.lablength=10, high.lablength=5)


#example one (tritrophic)
plotweb(Safariland,y.width.low=0.1, y.width.high=0.05,method="normal", 
	y.lim=c(0,3), arrow="up", adj.high=c(0.5,1.5), col.high="orange",
	high.lablength=3,high.lab.dis=0)

plotweb(t(Safariland), y.width.low=0.05, y.width.high=0.1, method="normal",
	add=TRUE,low.y=1.5,high.y=2.5, col.low="green", text.low.col="red", 
	low.lab.dis=0, arrow="down", adj.low=c(0.5,1.1),low.plot=FALSE)

#example two (4 trophic with abundance)
low.abun = round(runif(dim(Safariland)[1],1,40)) #create
names(low.abun) &lt;- rownames(Safariland)
plotweb(Safariland, text.rot=90, high.abun=low.abun, col.interaction="purple", 
	y.lim=c(0,4.5), high.lablength=0, arrow="up", method="normal", 
	y.width.high=0.05)

plotweb(t(Safariland), y.width.low=0.05, y.width.high=0.1, method="normal", 
	add=TRUE, low.y=1.7,high.y=2.7, col.low="green", text.low.col="black", 
	low.lab.dis=0, arrow="down", adj.low=c(0.5,1.1), low.lablength=4, 
	high.lablength=0)

plotweb(Safariland,y.width.low=0.05, y.width.high=0.1, method="normal", 
	add=TRUE, low.y=2.95, high.y=3.95, col.low="green", text.low.col="black", 
	low.lab.dis=0, arrow="down", adj.low=c(0.5,1.1), low.lablength=4)

# now some examples with the abuns.type-option:
plotweb(Safariland, abuns.type='independent',arrow="down.center")
plotweb(Safariland, abuns.type='additional',arrow="down.center")

</code></pre>

<hr>
<h2 id='plotweb2'>Visualize a tripartite interaction matrix (e.g. a tritrophic foodweb)</h2><span id='topic+plotweb2'></span>

<h3>Description</h3>

<p>Two two dimensional matrix are plotted as a tripartite graph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotweb2(web, web2, method = "cca", empty = FALSE, labsize = 1, ybig = 1,
    y_width = 0.1, spacing = 0.05, arrow="no", col.interaction="grey80",
    col.pred = "grey10", col.prey="grey10", lab.space=1, lablength = NULL, 
    sequence=NULL, low.abun=NULL,low.abun.col="green", high.abun=NULL, 
    high.abun.col="red", method2 = "cca", empty2 = TRUE, spacing2 = 0.05,  
    arrow2="no", col.interaction2="grey80", col.pred2 = "grey30", 
    col.prey2="grey20", lablength2 = NULL, sequence.pred2=NULL,low.abun2=NULL,
    low.abun.col2="green", high.abun2=NULL, high.abun.col2="red")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotweb2_+3A_web">web</code></td>
<td>
<p> Web is a matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_web2">web2</code></td>
<td>
<p>The other web to be included.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_method">method</code></td>
<td>
<p> Default method is <span class="option">cca</span>, which leads to as few crossings of interactions as possible. The other option is <span class="option">normal</span>, which leaves order as given by the matrix.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_empty">empty</code></td>
<td>
<p>logical; should empty columns or empty rows be omitted from plotting; defaults to true</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_labsize">labsize</code></td>
<td>
<p> factor for size of labels, default is 1 </p>
</td></tr>
<tr><td><code id="plotweb2_+3A_ybig">ybig</code></td>
<td>
<p> vertical distance between upper and lower boxes, default is 1</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_y_width">y_width</code></td>
<td>
<p> width of upper and lower boxes, default is 0.1 </p>
</td></tr>
<tr><td><code id="plotweb2_+3A_spacing">spacing</code></td>
<td>
<p> horizonatal distance between boxes within a level, default is 0.05</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_arrow">arrow</code></td>
<td>
<p> display type of connection between upper and lower boxes, options are <span class="option">up</span>, <span class="option">down</span>, <span class="option">both</span> and <span class="option">no</span>, default is <span class="option">no</span>, which is a polygonal connection between boxes. </p>
</td></tr>
<tr><td><code id="plotweb2_+3A_col.interaction">col.interaction</code></td>
<td>
<p>color of interaction, default is grey80. </p>
</td></tr>
<tr><td><code id="plotweb2_+3A_col.pred">col.pred</code></td>
<td>
<p>color of upper boxes, default is grey10.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_col.prey">col.prey</code></td>
<td>
<p>color of lower boxes, default is grey10.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_lab.space">lab.space</code></td>
<td>
<p>sometimes it is neccessary to add additional space for labels below and above of the boxes, so all labels are shown, default is 1.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_lablength">lablength</code></td>
<td>
<p>number of characters of labels that should be plotted. If zero no labels are shown, default is NULL which plots the complete labels.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_sequence">sequence</code></td>
<td>
<p>list of two with two names vectors: <code>seq.pred</code> and <code>seq.prey</code>, which specify the order in which species are plotted. Cannot be set for <span class="option">method="cca"</span>. Defaults to <code>NULL</code>, where the sequence remains as given or is determined by the CCA internally.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_low.abun">low.abun</code></td>
<td>
<p>Vector with independent abundance estimates for the lower trophic level, NULL if none exists.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_low.abun.col">low.abun.col</code></td>
<td>
<p>Colour for depicting the abundance estimates for the lower trophic level; defaults to green.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_high.abun">high.abun</code></td>
<td>
<p>Vector with independent abundance estimates for the higher trophic level, NULL if none exists.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_high.abun.col">high.abun.col</code></td>
<td>
<p>Colour for depicting the abundance estimates for the lower trophic level; defaults to red.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_method2">method2</code></td>
<td>
<p> Default method is <span class="option">cca</span>, which leads to as few crossings of interactions as possible. The other option is <span class="option">normal</span>, which leaves order as given by the matrix.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_empty2">empty2</code></td>
<td>
<p>logical; should empty columns or empty rows be omitted from plotting; defaults to true</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_spacing2">spacing2</code></td>
<td>
<p> horizontal distance between boxes within one level, default is 0.05</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_arrow2">arrow2</code></td>
<td>
<p> display type of connection between upper and lower boxes, options are <span class="option">up</span>, <span class="option">down</span>, <span class="option">both</span> and <span class="option">no</span>, default is <span class="option">no</span>, which is a polygonal connection between boxes. </p>
</td></tr>
<tr><td><code id="plotweb2_+3A_col.interaction2">col.interaction2</code></td>
<td>
<p>color of interaction, default is grey80. </p>
</td></tr>
<tr><td><code id="plotweb2_+3A_col.pred2">col.pred2</code></td>
<td>
<p>color of upper boxes, default is grey10.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_col.prey2">col.prey2</code></td>
<td>
<p>color of lower boxes, default is grey10.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_lablength2">lablength2</code></td>
<td>
<p>number of characters of labels that should be plotted. If zero no labels are shown, default is NULL which plots the complete labels.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_sequence.pred2">sequence.pred2</code></td>
<td>
<p>list of two with two names vectors: <code>seq.pred</code> and <code>seq.prey</code>, which specify the order in which species are plotted. Cannot be set for <span class="option">method="cca"</span>. Defaults to <code>NULL</code>, where the sequence remains as given or is determined by the CCA internally.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_low.abun2">low.abun2</code></td>
<td>
<p>Vector with independent abundance estimates for the lower trophic level, NULL if none exists.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_low.abun.col2">low.abun.col2</code></td>
<td>
<p>Colour for depicting the abundance estimates for the lower trophic level; defaults to green.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_high.abun2">high.abun2</code></td>
<td>
<p>Vector with independent abundance estimates for the higher trophic level, NULL if none exists.</p>
</td></tr>
<tr><td><code id="plotweb2_+3A_high.abun.col2">high.abun.col2</code></td>
<td>
<p>Colour for depicting the abundance estimates for the lower trophic level; defaults to red.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a window with a tripartite graph of a food web.
</p>


<h3>Author(s)</h3>

<p> Bernd Gruber <a href="mailto:bernd.gruber@canberra.edu.au">bernd.gruber@canberra.edu.au</a> </p>


<h3>See Also</h3>

<p> For a different plot of food webs see  <code><a href="#topic+visweb">visweb</a></code> and <code><a href="#topic+plotweb">plotweb</a></code></p>

<hr>
<h2 id='printoutModuleInformation'>printoutModuleInformation</h2><span id='topic+printoutModuleInformation'></span>

<h3>Description</h3>

<p>This takes an object of the class <code>moduleWeb</code> and prints out the information about the modules stored in this object.
It is a formatted print-out of the information one gets as result of the function <code>listModuleInformation(moduleWebObject)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printoutModuleInformation(moduleWebObject)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="printoutModuleInformation_+3A_modulewebobject">moduleWebObject</code></td>
<td>
<p>An object of class <code>moduleWeb</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. This function is called for its side effects of printing the content of its object in a more acceptable format.</p>


<h3>Author(s)</h3>

<p>Rouven Strauss</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(small1976)
moduleWebObject = computeModules(small1976)
printoutModuleInformation(moduleWebObject)

## End(Not run)
</code></pre>

<hr>
<h2 id='projecting_tm'> Projecting binary and weighted two-mode networks onto weighted one-mode networks. </h2><span id='topic+projecting_tm'></span>

<h3>Description</h3>

<p> This function is the implemtation of the procedure outlined on <br />
https://toreopsahl.com/2009/05/01/projecting-two-mode-networks-onto-weighted-one-mode-networks/ </p>


<h3>Usage</h3>

<pre><code class='language-R'>projecting_tm(net, method = "sum")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="projecting_tm_+3A_net">net</code></td>
<td>
<p>A two-mode edgelist</p>
</td></tr>
<tr><td><code id="projecting_tm_+3A_method">method</code></td>
<td>
<p> The method-switch control the method used to calculate the weights.<br />
binary sets all weights to 1<br />
sum sets the weights to the number of cooccurances<br />
Newman bases the weights on Newman's (2001) method of discounting for the size of collaborations. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a one-mode network</p>


<h3>Note</h3>

<p> version 1.0.0, taken, with permission, from package tnet </p>


<h3>Author(s)</h3>

<p> Tore Opsahl; https://toreopsahl.com </p>


<h3>References</h3>

<p>Opsahl. T. 2009. Projecting two-mode networks onto weighted one-mode networks. Available at: https://toreopsahl.com/2009/05/01/projecting-two-mode-networks-onto-weighted-one-mode-networks/ </p>


<h3>Examples</h3>

<pre><code class='language-R'>#please download and investigate tnet for examples!
</code></pre>

<hr>
<h2 id='r2dexternal'>Generates null models for network analysis by considering external abundances</h2><span id='topic+r2dexternal'></span><span id='topic+vaznullexternal'></span>

<h3>Description</h3>

<p>An extension of r2dtable (and vaznull, respectively) which rescales marginal totals according to independent data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r2dexternal(N, web, abun.higher=NULL, abun.lower=NULL)

vaznullexternal(N, web, abun.higher=NULL, abun.lower=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="r2dexternal_+3A_n">N</code></td>
<td>
<p>number of null models to be generated.</p>
</td></tr>
<tr><td><code id="r2dexternal_+3A_web">web</code></td>
<td>
<p>Web is a matrix representing the interactions observed between higher level species (columns) and lower level species (rows). </p>
</td></tr>
<tr><td><code id="r2dexternal_+3A_abun.higher">abun.higher</code></td>
<td>
<p>Optional vector of externally measured abundances of the higher level. If missing (NULL) it will be replaced by column totals.</p>
</td></tr>
<tr><td><code id="r2dexternal_+3A_abun.lower">abun.lower</code></td>
<td>
<p>Optional vector of externally measured abundances of the lower level. If missing (NULL) it will be replaced by row totals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The underlying functions are <code>r2dtable</code> and <code><a href="#topic+vaznull">vaznull</a></code>, which require a vector of row and column totals or a web, respectively. In function <code><a href="#topic+nullmodel">nullmodel</a></code>, these marginal totals are computed from the observed interaction matrix. Here, external abundances can be provided. These will be rescaled and combined with the observed marginal total to construct new row and column vectors for <code>r2dtable</code>.
</p>
<p>If neither row nor column abundances are provided this function will be identical to <code>r2dtable</code> and <code><a href="#topic+vaznull">vaznull</a></code>, respectively. 
</p>


<h3>Value</h3>

<p>Returns a list of <code>N</code> null model-generated networks. Species names are (obviously) dropped.
</p>


<h3>Note</h3>

<p>Since the function contains a rounding operation, it also has to include a re-distribution of 1s to keep all species in the system. That means, if one species has been observed in the external abundances extremely rarely (compared to the others), it will be overrepresented in this null model, because otherwise it would have to be dropped altogether! If you have a better solution, please let me know.
</p>
<p>When you hand over a web with lots of empty columns/rows, chances are that you have more columns/rows than interactions. In this case you <b>must</b> provide an external abundance vector, otherwise the function will throw an error. If you cannot provide an external abundance vector, consider removing all empty columns and rows (using <code><a href="#topic+empty">empty</a></code>) before applying a null model.
</p>
<p>Also note that <code><a href="#topic+vaznull">vaznull</a></code> itself does not return a matrix with exactly the same marginal totals as the input, so don't expect any different from <code>vaznullexternal</code>!
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+nullmodel">nullmodel</a></code>, <code><a href="#topic+vaznull">vaznull</a></code>, <code><a href="#topic+mgen">mgen</a></code>, <code>vegan::simulate</code> and <code>r2dtable</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
	abun.lower &lt;- c(15,5,2,7,4,8,6,0.01,6)
	 set.seed(2)
	(abun.higher &lt;- rpois(27, lambda=4))
	abun.higher[1] &lt;- 0.001
	sum(ext.polls)
	## note: external abundances do not sum up; this is intentional!!
	r2dexternal(2, Safariland, abun.higher=abun.higher, abun.lower=abun.lower)
	r2dexternal(2, Safariland, abun.higher=abun.higher)

  vaznullexternal(2, Safariland, abun.higher=abun.higher, abun.lower=abun.lower)
	
## End(Not run)
</code></pre>

<hr>
<h2 id='restrictednull'>The restricted null model accounting for modules with nested entries</h2><span id='topic+restrictednull'></span><span id='topic+PosteriorProb'></span>

<h3>Description</h3>

<p>Null model for &quot;compound network structure&quot;, i.e. modules exhibiting nestedness, roughly maintaining marginal totals and connectance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restrictednull(web, 
              Prior.Pij = "degreeprob", 
              conditional.level = "modules", 
              N=10, 
              print.null = FALSE, 
              allow.degeneration = FALSE, 
              return.nonrm.species = FALSE, 
              connectance = TRUE, 
              byarea = FALSE, 
              R.partitions = NULL, 
              C.partitions = NULL)
              
PosteriorProb(web, 
              R.partitions = NULL, 
              C.partitions = NULL, 
              Prior.Pij = "degreeprob", 
              conditional.level="modules")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="restrictednull_+3A_web">web</code></td>
<td>
<p>Matrix with observation interactions.</p>
</td></tr>
<tr><td><code id="restrictednull_+3A_prior.pij">Prior.Pij</code></td>
<td>
<p>Method for computing &quot;a priori&quot; probabilities of interaction between species i and j. Can be defined as:
</p>

<ul>
<li> <p><span class="option">"degreeprob"</span>: the default; probability of interaction proportional to overall species degrees;
</p>
</li>
<li> <p><span class="option">"equiprobable"</span>: probability of interaction identical to all species;
</p>
</li>
<li> <p><span class="option">"degreeprob.byarea"</span>: probability of interaction proportional to species degrees in each matrix area - see &quot;areas&quot; in <span class="option">conditional.level</span> for a definition of matrix areas. 
</p>
</li></ul>

</td></tr>
<tr><td><code id="restrictednull_+3A_conditional.level">conditional.level</code></td>
<td>
<p>Level to which conditional probability of interaction among species i and j will be conditioned. Can be defined as:
</p>

<ul>
<li> <p><span class="option">"modules"</span>: the default; conditional probabilities differing between areas within and outside modules; <span class="option">R.partitions</span> and <span class="option">C.partitions</span> must be provided, e.g. based on modularity analyis; see example.
</p>
</li>
<li> <p><span class="option">"matrix"</span>: conditional probabilities identical in all matrix areas;
</p>
</li>
<li> <p><span class="option">"areas"</span>: a different set of conditional probabilities for each matrix area. A matrix area is a submatrix M[AB] of M formed by all rows of module A and all columns of module B. If A = B, then M[AB] is a module area, otherwise M[AB] is the area between two modules. Therefore, when <span class="option">conditional.level = "areas"</span>, each area has its own conditional probabilities of interaction.
</p>
</li></ul>

</td></tr>
<tr><td><code id="restrictednull_+3A_n">N</code></td>
<td>
<p>Integer number of null matrices to be produced.</p>
</td></tr>
<tr><td><code id="restrictednull_+3A_print.null">print.null</code></td>
<td>
<p>Logical: Shall the simulation progress be printed? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="restrictednull_+3A_allow.degeneration">allow.degeneration</code></td>
<td>
<p>Logical. If null matrices are allowed to degenerate, i.e. be of lower dimension that the observed. Defaults to FALSE. If TRUE, interactions are drawn without ensuring that all rows and columns must have at least one interaction.</p>
</td></tr>
<tr><td><code id="restrictednull_+3A_return.nonrm.species">return.nonrm.species</code></td>
<td>
<p>Logical. Shall the index of non-removed rows and columns should be returned in the output? Defaults to FALSE. Note: if TRUE, each null model will be a list of three, rather than a single matrix!</p>
</td></tr>
<tr><td><code id="restrictednull_+3A_connectance">connectance</code></td>
<td>
<p>Logical. Shall connectance of the null matrices be either exactly (TRUE) or approximately (FALSE) the same as the original matrix. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="restrictednull_+3A_byarea">byarea</code></td>
<td>
<p>Logical. Shall interactions be drawn independently for each matrix area (i.e. in each submatrix M[ij] of M formed by all rows of module i and all columns of module j)? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="restrictednull_+3A_r.partitions">R.partitions</code></td>
<td>
<p>Vector of integers. Partitioning of rows, used only if <span class="option">byarea = TRUE</span>.</p>
</td></tr>
<tr><td><code id="restrictednull_+3A_c.partitions">C.partitions</code></td>
<td>
<p>Vector of integers. Partitioning of columns, used only if <span class="option">byarea = TRUE</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the restricted null model used in Felix et al. (2017), Pinheiro (2019), Pinheiro et al. (2019), Mello et al. (2019) and Queiroz et al. (2020). It was derived from the <code><a href="#topic+vaznull">vaznull</a></code> model. The synthesis presented in this function and null model, reported in a series of studies, was based on the ideas first proposed by Lewinsohn et al. (2006) and followed up by Mello et al. (2009), Flores et al. (2013) and Pinheiro et al (2016).
</p>
<p>Our restricted null model was designed for testing for a compound topology, i.e. a modular network structure with internally nested modules. It allows comparing observed and expected values of nestedness between species of the same module (NODFsm), and between species of different modules (NODFdm).
</p>


<h3>Author(s)</h3>

<p>Gabriel Felix, Rafael Pinheiro, and Marco Mello from the Ecological Synthesis Lab (SintECO) in São Paulo. The code was taken, with permission and encouragement, from Gabriel's github repository (<a href="https://github.com/gabrielmfelix/Restricted-Null-Model">https://github.com/gabrielmfelix/Restricted-Null-Model</a>) and modified by Carsten F. Dormann for conformity with <span class="pkg">bipartite</span>'s naming style. The helper function <code>PosteriorProb</code>, which computes the probabilities of an interaction, given the modular structure, is not exported and hence would have to be called as <code>bipartite:::PosteriorProb</code>. See Gabriel's github page for further details.</p>


<h3>References</h3>

<p>Bezerra, E. L. S., I. C. Machado, and M. A. R. Mello. 2009. Pollination networks of oil-flowers: a tiny world within the smallest of all worlds. <em>J. Anim. Ecol.</em> <b>78</b>: 1096&ndash;1101. <a href="https://pubmed.ncbi.nlm.nih.gov/19515098/">https://pubmed.ncbi.nlm.nih.gov/19515098/</a>.
</p>
<p>Felix, G. M., R. B. P. Pinheiro, R. Poulin, B. R. Krasnov, and M. A. R. Mello. 2017. The compound topology of a continent-wide interaction network explained by an integrative hypothesis of specialization. <em>bioRxiv</em> 236687. <a href="https://doi.org/10.1101/236687">doi:10.1101/236687</a>
</p>
<p>Flores, C. O., S. Valverde, and J. S. Weitz. 2013. Multi-scale structure and geographic drivers of cross-infection within marine bacteria and phages. <em>ISME J.</em> <b>7</b>: 520-–532. <a href="https://doi.org/10.1038/ismej.2012.135">doi:10.1038/ismej.2012.135</a>.
</p>
<p>Lewinsohn, T. M., P. Inácio Prado, P. Jordano, J. Bascompte, and J. M. Olesen. 2006. Structure in plant-animal interaction assemblages. <em>Oikos</em> <b>113</b>: 174–-184. <a href="https://doi.org/10.1111/j.0030-1299.2006.14583.x">doi:10.1111/j.0030-1299.2006.14583.x</a>
</p>
<p>Mello, M. A. R., G. M. Felix, R. B. P. Pinheiro, R. L. Muylaert, C. Geiselman, S. E. Santana, M. Tschapka, N. Lotfi, F. A. Rodrigues, and R. D. Stevens. 2019. Insights into the assembly rules of a continent-wide multilayer network. <em>Nat. Ecol. Evol.</em> <b>3</b>: 1525&ndash;1532. <a href="https://doi.org/10.1038/s41559-019-1002-3">doi:10.1038/s41559-019-1002-3</a>
</p>
<p>Pinheiro, R. B. P., G. M. F. Félix, A. V Chaves, G. A. Lacorte, F. R. Santos, É. M. Braga, and M. A. R. Mello. 2016. Trade-offs and resource breadth processes as drivers of performance and specificity in a host–parasite system: a new integrative hypothesis. <em>Int. J. Parasitol.</em> <b>46</b>: 115-–121. <a href="https://doi.org/10.1016/j.ijpara.2015.10.002">doi:10.1016/j.ijpara.2015.10.002</a>
</p>
<p>Pinheiro, R. B. P., G. M. F. Felix, C. F. Dormann, and M. A. R. Mello. 2019. A new model explaining the origin of different topologies in interaction networks. <em>Ecology</em> <b>100</b>: e02796. <a href="https://doi.org/10.1002/ecy.2796">doi:10.1002/ecy.2796</a>
</p>


<h3>See Also</h3>

<p>The function <code><a href="#topic+nest.smdm">nest.smdm</a></code> computes NODFsm and NODFdm for such networks, while <code><a href="#topic+sortmatrix">sortmatrix</a></code> and <code><a href="#topic+plotmatrix">plotmatrix</a></code> facilitate drawing matrices in a way that helps visualizing a compound topology.</p>


<h3>Examples</h3>

<pre><code class='language-R'>Mod &lt;- computeModules(Safariland)

# Recover the partitions
Part &lt;- module2constraints(Mod)
row.Part &lt;- Part[1:nrow(Safariland)]
col.Part &lt;- Part[(nrow(Safariland)+1):(nrow(Safariland)+ncol(Safariland))]

# Generate randomized networks with the null model of your choice, 
# considering the interaction probabilities calculated before. 
nulls &lt;- restrictednull(web = Safariland, R.partitions = row.Part, C.partitions = col.Part)

# Calculate the same nestedness metric for all randomized networks
null &lt;- sapply(nulls, nest.smdm, constraints = Part, weighted = TRUE, decreasing = "abund")
(WNODA.null &lt;- unlist(null[1,])) # WNODArow
(WNODAsm.null &lt;- unlist(null[2,])) # WNODAcol
(WNODAdm.null &lt;- unlist(null[3,])) # WNODAmatrix
# observed values:
nest.smdm(Safariland, weighted = TRUE, decreasing = "abund")
</code></pre>

<hr>
<h2 id='robustness'> Robustness to species extinctions
</h2><span id='topic+robustness'></span>

<h3>Description</h3>

<p>Calculates the area below the extinction curve generated by <code>second.extinct</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>robustness(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="robustness_+3A_object">object</code></td>
<td>
<p>An object of type class <code>bipartite</code>, usually generated by <code><a href="#topic+second.extinct">second.extinct</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the area below the extinction curve generated by second.extinct as a measure of the robustness of the system to the loss of species.
</p>
<p>The curve, first proposed by Memmott et al. (2004), is based on the fact that if a given fraction of species of one guild (for instance, the pollinators) are eliminated, a number of species of the other guild (e.g. plants) which depend on their interactions become extinct. The slope and general shape of the curve provided a straightforward graphic description of the tolerance of a system to the extinction of its component species.
</p>
<p>An improvement of Memmott et al.'s curve was developed by Burgos et al. (2007) by introducing a quantitative measure of robustness with a single parameter R, defined as the area under the extinction curve. It is intuitive that R = 1 corresponds to a curve that decreases very mildly until the point at which almost all animal species are eliminated. This is consistent with a very robust system in which, for instance, most of the plant species survive even if a large fraction of the animal species is eliminated. Conversely R = 0 corresponds to an ATC that decreases abruptly as soon as any species is lost. This is consistent with a fragile system in which, for instance, even if a very small fraction of the animal species is eliminated, most of the plants loose all their interactions and go extinct.
</p>


<h3>Value</h3>

<p>Returns the robustness of the web to the removal of species.
</p>


<h3>Note</h3>

<p>This index complements the information given by <code><a href="#topic+slope.bipartite">slope.bipartite</a></code>, although it has the advantage of not being constrained by the shape of the particular curve (concave or convex).
</p>


<h3>Author(s)</h3>

<p> Mariano Devoto <a href="mailto:mdevoto@agro.uba.ar">mdevoto@agro.uba.ar</a></p>


<h3>References</h3>

 
<p>Burgos, E., H. Ceva, R.P.J. Perazzo, M. Devoto, D. Medan, M. Zimmermann, and A. Maria Delbue (2007) Why nestedness in mutualistic networks? <em>Journal of Theoretical Biology</em> <b>249</b>, 307&ndash;313
</p>
<p>Memmott, J., Waser, N. M. and Price, M. V. 2004 Tolerance of pollination networks to species extinctions. <em>Proceedings of the Royal Society B</em> <b>271</b>, 2605&ndash;2611
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+second.extinct">second.extinct</a></code> for generating the required input object and <code><a href="#topic+slope.bipartite">slope.bipartite</a></code> for an alternative, but inferior measure</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Safariland)
ex &lt;- second.extinct(Safariland, participant="lower", method="random", nrep=100, 
	details=FALSE)
robustness(ex)

## End(Not run)
</code></pre>

<hr>
<h2 id='Safariland'> A pollination web from Argentina</h2><span id='topic+Safariland'></span>

<h3>Description</h3>

<p>This pollination web was published by Vázquez and Simberloff (2003). See there for details on how it was measured.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Safariland)</code></pre>


<h3>Details</h3>

<p>The dataset consists of a matrix with 9 rows, representing plant species and 27 columns, representing different pollinators. Values in the matrix are observed flower visitations.
</p>
<p>This dataset is fairly representative of a pollination web: more pollinators than plants, and an awful lot of zeros in the matrix.
</p>
<p>The study was conducted in four grazed and four ungrazed sites in and around Nahuel Huapi National Park and surrounding areas in Rio Negro, Argentina from September 1999  to February 2000. For each site, the plant-pollinator interaction network was described.
</p>
<p>The authors recorded their data by counting the number of visits of each flower visitor species to each plant species. Data are presented as an interaction frequency matrix,  in which cells with positive integers indicate the frequency of interaction between  a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>Source</h3>

<p>These data can be downloaded, together with the other datasets, on the NCEAS interactionweb website <a href="https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator">https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator</a>. See also there for further details, both on the data and their usage.
</p>


<h3>References</h3>

<p>Vázquez, D. P. 2002 Interactions among Introduced Ungulates, Plants, and Pollinators: A Field Study in the Temperate Forest of the Southern Andes. Doctoral Dissertation Thesis, University of Tennessee, Knoxville, Tennessee, USA.
</p>
<p>Vázquez, D. P., and D. Simberloff. 2002 Ecological specialization and susceptibility to disturbance: conjectures and refutations. <em>American Naturalist</em> <b>159</b>, 606&ndash;623.
</p>
<p>Vázquez, D. P., and D. Simberloff. 2003 Changes in interaction biodiversity induced by an introduced ungulate. <em>Ecology Letters</em>, <b>6</b>, 1077&ndash;1083.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
plotweb(Safariland)
</code></pre>

<hr>
<h2 id='schemske1978'> A flower visitation network from Urbana, IL, USA</h2><span id='topic+schemske1978'></span>

<h3>Description</h3>

<p>Populations of seven early flowering, low-growing, perennial woodland herbs were studied in a 24 hectare sit in Brownfield Woods, close to Urbana, Illinois, U.S.A. The sequence and variety of flowers visited by individual insects were recorded for the first foraging insect observed in a randomly selected, 1 m2 quadrat located within a 10x10 m grid that included representatives of several plant species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(schemske1978)</code></pre>


<h3>Details</h3>

<p>The authors recorded their data by counting the number of visits of each flower visitor species to each plant species. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>References</h3>

<p>Schemske, D. W., M. F. Willson, M. N. Melampy, L. J. Miller, L. Verner, K. M. Schemske, and L. B. Best. 1978. Flowering Ecology of Some Spring Woodland Herbs. Ecology 59:351-366.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schemske1978)
## maybe str(schemske1978) ; plot(schemske1978) ...
</code></pre>

<hr>
<h2 id='second.extinct'>Secondary extinctions in bipartite networks</h2><span id='topic+second.extinct'></span>

<h3>Description</h3>

<p>Calculates the consequences of removing a species from a bipartite network. With plotting and slope-estimation functionality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>second.extinct(web, participant = "higher", method = "abun", nrep = 10,
  details = FALSE, ext.row=NULL, ext.col=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="second.extinct_+3A_web">web</code></td>
<td>
<p> Web is a matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey.</p>
</td></tr>
<tr><td><code id="second.extinct_+3A_participant">participant</code></td>
<td>
<p><code>high</code> (default) or <code>low</code> or <code>both</code>, depending if you want to exterminate higher trophic level species, lower trophic level species, or randomly choose species of both levels.</p>
</td></tr>
<tr><td><code id="second.extinct_+3A_method">method</code></td>
<td>
<p>Random deletion of a species (<span class="option">random</span>); according to its abundance, with least abundant going extinct first (<span class="option">abundance</span>; default) or <span class="option">"degree"</span> to build a sequence from the best-to-least connected species. This is the most extreme case, where the most generalist species goes extinct first (see Memmott et al. 1998). (Note that <span class="option">method="abundance"</span> does not work with <span class="option">participant="both"</span>; in this case a random sequence of species from both trophic levels is generated.) <span class="option">external</span> will use the externally provided vector to determine extinction sequence.</p>
</td></tr>
<tr><td><code id="second.extinct_+3A_nrep">nrep</code></td>
<td>
<p>Number of replicates of extermination sequence. Will not be considered for method abundance.</p>
</td></tr>
<tr><td><code id="second.extinct_+3A_details">details</code></td>
<td>
<p>Logical; returns details, i.e. for each replicate the sequence of secondary extinctions. If set to <code>FALSE</code> (default), replicated runs will be averaged.  Using anything but <code>FALSE</code> will not yield the correct object for further analysis. This switch is really only for understanding what <code>second.extinct</code> does and for possible debugging.</p>
</td></tr>
<tr><td><code id="second.extinct_+3A_ext.row">ext.row</code></td>
<td>
<p>Optional vector giving the sequence in which lower-level species are to be deleted.</p>
</td></tr>
<tr><td><code id="second.extinct_+3A_ext.col">ext.col</code></td>
<td>
<p>Optional vector giving the sequence in which higher-level species are to be deleted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The procedure of this function is simple. For example imagine the web to represent a pollination web, in which pollinators die one by one. Set all entries of a  column to zero, see how may rows are now also all-zero (i.e. species that are now not pollinated any more), and count these as secondary extinctions of the primary exterminated pollinator. 
</p>
<p>Internally, each extermination is achieved by a call to <code><a href="#topic+extinction">extinction</a></code>, followed by a call to <code><a href="#topic+empty">empty</a></code>, which counts the number of all-zero columns and rows.
</p>
<p>Although written for pollination webs (hence the nomenclature of pollinator and plant), it can be similarly applied to other types of bipartite networks. It is called by <code><a href="#topic+networklevel">networklevel</a></code>.
</p>


<h3>Value</h3>

<p>Function returns an object of class &ldquo;bipartite&rdquo; to ensure proper working of function <code>plot.bipartite</code>.
</p>
<p>If <span class="option">details=FALSE</span>, the returned object contains a matrix with columns representing the number of species going extinct from one step to the next, averaged across all runs.
</p>
<p>If <span class="option">details=FALSE</span>, the returned object will be a list of matrices containing the number of species going extinct at each step.
</p>
<p>The objects attribute &ldquo;exterminated&rdquo; gives the name of the trophic level (pollinator or plant).
</p>


<h3>Note</h3>

<p>Note: The length of an extinction sequence is obviously given by the number of species in the selected trophic level. When setting <span class="option">participant="both"</span>, lengths will differ for each replicate run, since it is unpredictable in which sequence species go extinct, and hence how many secondary extinctions will pre-empt further primary extinctions.
</p>
<p>Note 2: Because external abundances can be fed to this function, the web is not emptied of all-empty rows or columns. Thus the results will be different to calls to <code><a href="#topic+networklevel">networklevel</a></code> or <code><a href="#topic+grouplevel">grouplevel</a></code>, which by default empty the web!
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann </p>


<h3>References</h3>

<p>Memmott, J., Waser, N. M. and Price, M. V. (2004) Tolerance of pollination networks to species extinctions. <em>Proceedings of the Royal Society B</em> <b>271</b>, 2605&ndash;2611.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+networklevel">networklevel</a></code> calls <code>second.extinct</code>; <code><a href="#topic+extinction">extinction</a></code>
and <code><a href="#topic+empty">empty</a></code> are internal helper functions, and <code><a href="#topic+slope.bipartite">slope.bipartite</a></code>
calculates extinction slopes from the output of <code>second.extinct</code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Safariland)
(ex &lt;- second.extinct(Safariland, participant="lower", method="random", nrep=50, 
	details=TRUE))
(ex &lt;- second.extinct(Safariland, participant="lower", method="random", nrep=50, 
	details=FALSE))

## End(Not run)
</code></pre>

<hr>
<h2 id='shuffle.web'> Shuffle web entries  </h2><span id='topic+shuffle.web'></span>

<h3>Description</h3>

<p>Shuffles (= relocates) entries in a web matrix whilst maintaining the dimensionality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shuffle.web(web, N, legacy=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shuffle.web_+3A_web">web</code></td>
<td>
<p> An interaction matrix.</p>
</td></tr>
<tr><td><code id="shuffle.web_+3A_n">N</code></td>
<td>
<p> Number of desired shuffled matrices. </p>
</td></tr>
<tr><td><code id="shuffle.web_+3A_legacy">legacy</code></td>
<td>
<p>Logical; use the old or new algorithm? Defaults to TRUE, i.e. the old algorithm. The new algorithm was written by Paul Rabie and is about 3 times faster (due to avoiding a loop). For consistency reasons, the old, slow algorithm remains the default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed to behave similar to <code>r2dtable</code>, i.e. it returns a list of randomised matrices. 
In contrast to <code>r2dtable</code> is does not keep marginal sums constant! 
</p>
<p>This function is thought of as a null model for the analysis of bipartite webs. It keeps two web properties
constant: The number of interactions and the number of links (and hence connectance). A comparison of
<code>shuffle.web</code>- and <code>r2dtable</code>-based webs allows to elucidate the effect of marginal sums.
</p>


<h3>Value</h3>

<p>A list of N randomised matrices with the same dimensions as the initial web.
</p>


<h3>Note</h3>

 <p><code>shuffle.web</code> is not an extremely intelligent nullmodel. You may want to think of a better one for your specific application!
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt; </p>


<h3>References</h3>

<p>This null model can be thought of as a quantitative version of Fortuna &amp; Bascompte (2006) &ldquo;null model 1&rdquo;:
</p>
<p>Fortuna, M. A., and J. Bascompte. 2006. Habitat loss and the structure of plant-animal mutualistic networks. Ecology Letters 9: 281-286.
</p>
<p>For a very nice and thorough overview of null models in general see:
</p>
<p>Gotelli, N. J., and G. R. Graves. 1996. Null Models in Ecology. Smithsonian Institution Press, Washington D.C.
</p>
<p>For null models and their application to webs/networks see, e.g.:
</p>
<p>Vázquez, D. P., and M. A. Aizen. 2003. Null model analyses of specialization in plant-pollinator interactions. Ecology 84: 2493-2501.
</p>
<p>Vázquez, D. P., C. J. Melian, N. M. Williams, N. Blüthgen, B. R. Krasnov, and R. Poulin. 2007. Species abundance and asymmetric interaction 
strength in ecological networks. Oikos 116: 1120-1127.
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+r2dtable">r2dtable</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Safariland)

shuffle.web(Safariland, N=2)

</code></pre>

<hr>
<h2 id='slope.bipartite'>Slope of extinction simulation</h2><span id='topic+slope.bipartite'></span>

<h3>Description</h3>

<p>Fits a hyperbolic function to the extinction simulation of <code><a href="#topic+second.extinct">second.extinct</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slope.bipartite(object, plot.it = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slope.bipartite_+3A_object">object</code></td>
<td>
<p>An object of class &ldquo;bipartite&rdquo;, usually generated by <code><a href="#topic+second.extinct">second.extinct</a></code>. </p>
</td></tr>
<tr><td><code id="slope.bipartite_+3A_plot.it">plot.it</code></td>
<td>
<p>Logical; want to see the graph? </p>
</td></tr>
<tr><td><code id="slope.bipartite_+3A_...">...</code></td>
<td>
<p>Graphical parameters passed on to the <code>plot</code> command used for plotting, NOT to the <code>curve</code> command used for overlaying the curve. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function scales extinction sequences to values between 0 and 1 for each participant. The x-axis of the graph features
the proportion of exterminated participants, while the y-axis depicts the proportion of secondary extinctions.
Since these curves usually follow a hyperbolic function (see examples in Memmott et al. 2004), this is fitted to the
data.
</p>
<p>At present, only a function of type <code class="reqn">y \sim 1 - x^a</code> is fitted (using <code>nls</code>), i.e. without offset. While usually this
function provides very good fits, do check the graph and judge for yourself. Fitting this simple function makes its
parameter &lsquo;a&rsquo; a measure of extinction vulnerability. The more gradual the secondary extinctions, the lower the absolute value of &lsquo;a&rsquo;. Or, phrased differently, large absolute values of &lsquo;a&rsquo; indicate a very abrupt die-off, indicative of high initial redundancy in the network.
</p>


<h3>Value</h3>

<p>Returns one number, the exponent of the fitted hyperbolic model.
</p>


<h3>Note</h3>

<p>This function is not as vigorously tested as it should probably be. It worked fine for large networks, but small ones it may behave strangely, I fathom.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann</p>


<h3>References</h3>

<p>Memmott, J., Waser, N. M. and Price, M. V. (2004) Tolerance of pollination networks to species extinctions. <em>Proceedings of the Royal Society B</em> <b>271</b>, 2605&ndash;2611
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+second.extinct">second.extinct</a></code> for generating the required input object. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Safariland)
ex &lt;- second.extinct(Safariland, participant="lower", method="random", nrep=100,
details=FALSE)
slope.bipartite(ex)

## End(Not run)
</code></pre>

<hr>
<h2 id='small1976'> A flower visitation network from a peat bog in Ottawa, Canada</h2><span id='topic+small1976'></span>

<h3>Description</h3>

<p>The study took place in the Mer Bleue peat bog of Ottawa, Canada in 1973. The paper is a preliminary evaluation of the pollination relationships of the major entomophilous plant species of the Mer Bleue.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(small1976)</code></pre>


<h3>Details</h3>

<p>The authors recorded their data by counting the number of individual flower visitors caught on each plant species. The total number of individuals collected on each plant species provide a rough estimate of the level of visitation that each species received. Data are presented as an interaction frequency matrix, in which cells with positive integers indicate the frequency of interaction between a pair of species, and cells with zeros indicate no interaction.
</p>


<h3>Source</h3>

<p><a href="https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator">https://iwdb.nceas.ucsb.edu/resources.html#plant_pollinator</a></p>


<h3>References</h3>

<p>Small, E. 1976. Insect pollinators of the Mer Bleue peat bog of Ottawa. Canadian Field Naturalist 90:22-28.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(small1976)
## maybe str(small1976) ; plot(small1976) ...
</code></pre>

<hr>
<h2 id='sortmatrix'> Organise matrix by topology </h2><span id='topic+sortmatrix'></span>

<h3>Description</h3>

<p>Sortmatrix is used to organize matrix rows and columns in order to highlight one of the three available topologies: nested, modular, and compound
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sortmatrix(matrix, topology="compound", sort_by="degrees", row_partitions=NULL, 
      col_partitions=NULL, mod_similarity=FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sortmatrix_+3A_matrix">matrix</code></td>
<td>
<p>the interaction matrix (rows and columns are nodes; cells are links between nodes). The matrix may be binary (only 0s and 1s) or weighted.</p>
</td></tr>
<tr><td><code id="sortmatrix_+3A_topology">topology</code></td>
<td>
<p>defines for which topology the visualization is optimized. We implemented 3 topologies: nested, modular, and compound (modular with internally nested modules). Defaults to <span class="option">"nested"</span>. If <span class="option">topology = "nested"</span>, network is sorted by decreasing marginal totals. If <span class="option">topology = "modular""</span>, network is sorted based on row and column partitions. If <span class="option">topology = "compound"</span>, network is first sorted on row and column partitions, then sorted by decreasing marginal totals within each partition.</p>
</td></tr>
<tr><td><code id="sortmatrix_+3A_sort_by">sort_by</code></td>
<td>
<p>defines whether the marginal totals used for sorting are the binary marginal totals (<span class="option">sort_by = "degrees"</span>) or the weighted marginal totals (<span class="option">sort_by = "weights"</span>). If the matrix is binary, sort_by must be set to <span class="option">"degrees"</span>, which is also the default.</p>
</td></tr>
<tr><td><code id="sortmatrix_+3A_row_partitions">row_partitions</code></td>
<td>
<p>vector with row partitions to be applied in modular and compound topologies. The length of the vector must be the number of rows in the matrix, each value is the partition of the respective row, following the row sequence in the matrix. Partition can be defined by numeric or character values. Not used if topology is <span class="option">"nested"</span>.</p>
</td></tr>
<tr><td><code id="sortmatrix_+3A_col_partitions">col_partitions</code></td>
<td>
<p>same as row_partitions, but for columns.</p>
</td></tr>
<tr><td><code id="sortmatrix_+3A_mod_similarity">mod_similarity</code></td>
<td>
<p>logical; if <span class="option">mod_similarity=TRUE</span>, the order of modules is defined based on the similarity between them. So that more similar modules are closer in the plot. Similarity is based on Euclidian distances.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More than a visualization choice, the use of binary or weighted marginal totals is related to the definition of weighted nestedness. One of the most used index, WNODF (Almeida-Neto and Ulrich 2011), requires binary nestedness to account for weighted nestedness. If this index and the definition of nestedness it reflects, is used, it may be more logical to define sort_by as degrees. Other indices, as WNODA (Pinheiro et al. 2019) do not require binary nestedness, thus, there is no reason to sort by degrees rather than weights.</p>


<h3>Value</h3>

<p>The output of sortmatrix is a list with 5 elements:
</p>
<table role = "presentation">
<tr><td><code>matrix</code></td>
<td>
<p>is the sorted matrix</p>
</td></tr>
<tr><td><code>row_partitions</code></td>
<td>
<p>a vector with the partitions for rows, in the new order</p>
</td></tr>
<tr><td><code>col_partitions</code></td>
<td>
<p>a vector with the partitions for columns, in the new order</p>
</td></tr>
<tr><td><code>order_row</code></td>
<td>
<p>a vector with the position of each row of the input matrix in the sorted matrix. order_col: a vector with the position of each column of the input matrix in the sorted matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Rafael Barros Pereira Pinheiro <a href="mailto:rafael-bpp@hotmail.com">rafael-bpp@hotmail.com</a>, Gabriel Felix, Marco Mello, and the team of the Ecological Synthesis Lab, University of São Paulo</p>


<h3>References</h3>

<p>Almeida-Neto, M. and Ulrich, W. 2011. A straightforward computational approach for measuring nestedness using quantitative matrices. <em>Environ. Model. Softw.</em> <b>26</b>, 173&ndash;178
</p>
<p>Lewinsohn, T.M. et al. 2006. Structure in plant-animal interaction assemblages. <em>Oikos</em> <b>113</b>,  174&ndash;184
</p>
<p>Pinheiro, R.B.P. et al. 2019. A new model explaining the origin of different topologies in interaction networks. <em>Ecology</em> <b>100</b>, 1&ndash;30
</p>


<h3>See Also</h3>

<p>The output of <code>sortmatrix</code> is used by <code><a href="#topic+plotmatrix">plotmatrix</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>sortmatrix (Safariland, topology = "nested", sort_by = "weights")

# see example in help for "plotmatrix"
</code></pre>

<hr>
<h2 id='sortweb'> Function to sort bipartite webs </h2><span id='topic+sortweb'></span>

<h3>Description</h3>

<p> This function sorts bipartite webs by either increasing/decreasing row and column totals or by a given sequence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sortweb(web, sort.order="dec", sequence=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sortweb_+3A_web">web</code></td>
<td>
<p> A matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level 
species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey. </p>
</td></tr>
<tr><td><code id="sortweb_+3A_sort.order">sort.order</code></td>
<td>
<p> sort.order can be either<br />
<b>inc</b>: sorted by increasing row/column totals<br />
<b>dec</b>: sorted by decreasing row/column totals<br />
<b>seq</b>: sorted by a given order, see sequence for how to specify an order<br /></p>
</td></tr>
<tr><td><code id="sortweb_+3A_sequence">sequence</code></td>
<td>
<p>list of two with two named vectors: <code>seq.lower</code> and <code>seq.higher</code>, which specify the order in which species are 
sorted. To be able to sort by names obviously the given web must be a NAMED matrix, i.e. has column and row names. If you want to order 
an unnamed web, you can either order it by row/column totals are you have to simply specify the sequence as follows (example puts last row/column to the front):
web[c(9, 1:8), c(27, 1:26)]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an ordered bipartite web.
</p>


<h3>Author(s)</h3>

<p> Bernd Gruber </p>


<h3>References</h3>

<p> Vázquez, P.D., Chacoff, N.,P. and  Cagnolo, L. (2009) Evaluating multiple determinants of the structure of plant-animal mutualistic networks. <em>Ecology</em> in press.  </p>


<h3>See Also</h3>

<p> For plotting and ordered web see  <code><a href="#topic+plotweb">plotweb</a></code>, <span class="option">method="normal"</span> or  <code><a href="#topic+visweb">visweb</a></code>, <span class="option">type="none"</span>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
web &lt;- Safariland

sortweb(Safariland, sort.order="dec") 
#rarest species first:
plotweb(sortweb(Safariland, sort.order="inc"), method="normal")   
visweb(sortweb(Safariland,sort.order="inc"), type="diagonal", 
	square="compartment", text="none", frame=TRUE)

# sorted by a given (here random) sequence
sequence &lt;- list(seq.higher=sample(colnames(Safariland)), 
	seq.lower=sample(rownames(Safariland)))
web.ordered &lt;- sortweb(web, sort.order="seq", sequence=sequence)

</code></pre>

<hr>
<h2 id='specieslevel'>Calculate various indices for network properties at the species level</h2><span id='topic+specieslevel'></span>

<h3>Description</h3>

<p>Apart from the properties of the entire web, also its participants can be described
specifically. Various simple numbers and indices are calculated and returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specieslevel(web, index="ALLBUTD", level="both", logbase=exp(1), low.abun=NULL, 
	high.abun=NULL, PDI.normalise=TRUE, PSI.beta=c(1,0), nested.method="NODF", 
	nested.normalised=TRUE, nested.weighted=TRUE, empty.web=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="specieslevel_+3A_web">web</code></td>
<td>
<p> Web is a matrix representing the interactions observed between higher
trophic level species (columns) and lower trophic level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of host.</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_index">index</code></td>
<td>
<p>Vector of indices to be calculated for each trophic level of the web;
options are: 
</p>

<ul>
<li> <p><span class="option">degree</span>, 
</p>
</li>
<li> <p><span class="option">ND</span> for normalised degrees, 

</p>
</li>
<li> <p><span class="option">species strength</span> as sum of dependencies for each species, 
</p>
</li>
<li> <p><span class="option">nestedrank</span> as rank in a nested matrix,
</p>
</li>
<li> <p><span class="option">interaction push pull</span> for interaction push/pull (our version of dependence asymmetry: see details),  
</p>
</li>
<li> <p><span class="option">PDI</span> for Paired Differences Index, 
</p>
</li>
<li> <p><span class="option">resource range</span> for Poisot et al. (2012)'s index of unused resources,
</p>
</li>
<li> <p><span class="option">species specificity</span> (or coefficient of variation of interactions),
</p>
</li>
<li> <p><span class="option">PSI</span> for pollination service index (or pollinator support index, depending on the trophic level), 
</p>
</li>
<li> <p><span class="option">NS</span> for node specialisation index, 
</p>
</li>
<li> <p><span class="option">betweenness</span> for betweenness, 
</p>
</li>
<li> <p><span class="option">closeness</span> (both automatically also return their weighted counterparts proposed by Tore Opsahl in package <span class="pkg">tnet</span>),
</p>
</li>
<li> <p><span class="option">Fisher</span> for Fisher's alpha index, 
</p>
</li>
<li> <p><span class="option">diversity</span> for Shannon diversity of interactions of that species, 
</p>
</li>
<li> <p><span class="option">effective partners</span> for the effective number of interacting partners,  
</p>
</li>
<li><p><span class="option">proportional generality</span> a quantitative version of normalised degree,
</p>
</li>
<li><p><span class="option">proportional similarity</span> specialisation measured as similarity between use and availability,
</p>
</li>
<li> <p><span class="option">d</span> for Blüthgen's d', 
</p>
</li>
<li> <p><span class="option">ALL</span> for all the aforementioned. 
</p>
</li>
<li> <p><span class="option">ALLBUTD</span> (default) excludes only the dependence matrix and leads to the output being simplified to a matrix per trophic level.</p>
</li></ul>

</td></tr>
<tr><td><code id="specieslevel_+3A_level">level</code></td>
<td>
<p>For which level(s) should the indices be computed? Options are <span class="option">both</span> (default), <span class="option">lower</span> and <span class="option">higher</span>. Output for one trophic level will be returned as a data.frame (unless dependencies are also reported), while for two levels a list of two matrices (higher and lower) will be returned.</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_logbase">logbase</code></td>
<td>
<p>numeric; gives the base to which the various diversity indices (partner diversity, effective partners) shallb be calculated, typcially exp(1) (default) or 2. Log2 is the proposal for generality and vulnerability by Bersier et al. (2002), while Shannon typically uses the natural logarithm, ln. The choice of the base will not affect the results qualitatively, only by a scaling factor.</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_low.abun">low.abun</code></td>
<td>
<p>Optional vector of independent abundances of the <em>lower</em> trophic level to be passed on to <code><a href="#topic+dfun">dfun</a></code> and used as &lsquo;resource availability&rsquo; in indices proportional similarity and proportional generality.</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_high.abun">high.abun</code></td>
<td>
<p>Optional vector of independent abundances of the <em>higher</em> trophic level to be passed on to <code><a href="#topic+dfun">dfun</a></code> and used as &lsquo;resource availability&rsquo; in indices proportional similarity and proportional generality.</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_pdi.normalise">PDI.normalise</code></td>
<td>
<p>Logical; should the normalised PDI be computed? Defaults to TRUE. See function <code><a href="#topic+PDI">PDI</a></code> for details and reasoning.</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_psi.beta">PSI.beta</code></td>
<td>
<p>A length 2 vector of parameter determining the effect of floral constancy and pollen mixing on the proportion of same-species pollen delivered to a plant. Defaults to <code>c(1, 0)</code>. See section details for details.</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_nested.method">nested.method</code></td>
<td>
<p>One of <span class="option">NODF</span>, <span class="option">binmatnest</span>, <span class="option">wine</span> or <span class="option">sort</span>. See <code><a href="#topic+nestedrank">nestedrank</a></code> for details.</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_nested.normalised">nested.normalised</code></td>
<td>
<p>Logical; defaulting to TRUE. Divides the nestedrank-1 by the number of species -1, thereby ranging it between 0 (most generalist) and 1 (most specialised). Species sequences from different networks are now comparable.</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_nested.weighted">nested.weighted</code></td>
<td>
<p>Logical; should the &ldquo;nestedrank&rdquo; be computed based on weighted network (default) or binary version (FALSE)?</p>
</td></tr>
<tr><td><code id="specieslevel_+3A_empty.web">empty.web</code></td>
<td>
<p>Shall the empty columns and rows be deleted? Defaults to TRUE. option FALSE not yet fully tested</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements a variety of the many (and still procreating) indices describing species properties. Some are embarrassingly simple (such as number of interacting species for each species). Others are variations on Shannon's diversity index applied to within species.
</p>
<p>Indices based on graph theory (such as NDI, closeness, betweenness) require the data to form a connected graph. When the network is compartmented (as would be seen when plotting it using <code><a href="#topic+plotweb">plotweb</a></code>), these indices will be computed for the each compartment. However, single-link compartments (only one partner in each trophic level) will not form a proper graph and hence the indices will have a value of NA.
</p>
<p>Most indices are straightforward, one-line formulae; some, such as d', also require a re-arranging of the matrix. We (Dormann, Blüthgen, Gruber) came up with a new one, called &ldquo;Pollination Service Index&rdquo; or psi, for which a few more details seem appropriate.
</p>
<p><b>Pollination Service Index (PSI)</b>
</p>
<p>This index estimates the importance of a pollinator for all plant species. PSI is comprised of three calculation steps: firstly, we calculate, for each pollinator species, the proportion to which it visits each plant species (or, phrased anthropomorphically, the number to the question: which proportion of my visits are to dandelion?). Secondly, we calculate the proportion to which a plant is visited by each bee species (Which proportion of my pollinators are red mason bees?). Multiplying, these two proportions gives the portion of own pollen for each plant species (because this depends both on a pollinators specialisation (step 1) and the plant's specific receptiveness (step 2). Finally, we sum the proportions own pollen delivered across all plant species. This value is the PSI-value. At its maximum (which depends on the value of beta) it shows that all pollen is delivered to one plant species that completely depends on the monolectic pollinator. At its minimum, 0, it indicates that a pollinator is irrelevant to all plant species. Note that PSI can assume values from 0 to 1 (for beta=1) for species of any frequency: a bee been found only once on a plant species visited by no-one else receives a PSI of 1, even if in total 14 million visits were recorded.
</p>
<p>(This is all very complicated. So here is another attempt (by Jochen) to explain the PSI:
For PSI, importance of a pairwise interaction (for the plant) is calculated as: 'dependence'_i_on_j * per.visit.efficiency_i_visitedby_j, where per.visit.efficiency_i_visitedby_j = (average proportion visits to i by j in all visits by j)^beta.
</p>
<p>It assumes that the order of plant species visited is random (no mixing, no constancy). To account for that not being true, beta could be adjusted. However, this really waits for good empirical tests.)
</p>
<p>We envisage a penalty for the fact that a pollinator has to make two (more or less successive) visits to the same plant species: the first to take the pollen up, the second to pollinate the next. Thus, using beta=2 as an exponent in step 1 would simulate that a pollinator deposits all pollen at every visit. In a sense, beta=2 represents a complete turnover of pollen on the pollinator from one visit to the next; only the pollen of the last-visited species is transferred. That is certainly a very strong penalisation. At present we set the exponent to beta=1, because the step of controlling for &ldquo;pollen purity&rdquo; is already a major improvement. It assumes, implicitly, that pollen is perfectly mixed on the pollinator and hence pollen deposited directly proportional to frequency of visits to the different plants Also, we have no idea to which extent pollen gets mixed and/or lost during foraging flights, and the true exponent remains elusive. For a value of beta=0, PSI simplifies (and is equal) to species strength.
</p>
<p>For the perspective of the plant's effect on pollinators (then PSI = pollinator support index), this index makes less sense. Here we would rather use beta=0, because 
pollen value is not related to number of visits, so we cannot compute it from the network. 
Similarly, for other networks, such as host-parasitoids, beta=0 seems plausible, since for the host it does not matter, whether a parasitoid has visited another species before or not. In this case (beta=0), PSI is simply equal to species strength. Not just pollen turnover/carryover on the pollinator is important and influences beta, but all these considerations depend on the assumption how the proportion of conspecific pollen affects pollination (assuming many visits per flower visitation sequence). (a) If only presence of any conspecific pollen on bee is sufficient for pollination, carryover (how long pollen from one visits remains on bee) matters, beta is anywhere between 0 (infinite carryover) and 2 (one-step carryover).
(b) If the proportion of conspecific pollen on bee determines pollination success (linear relationship), carryover does not matter, the proportion can be assumed to be in an equilibrium, and beta=1.
</p>
<p>Our choice of defaults (c(1,0)) will yield species strength for plants, and PSI for pollinators, assuming, for the latter, that pollen mixes perfectly.
</p>


<h3>Value</h3>

<p>For both the &ldquo;higher trophic level&rdquo; and the &ldquo;lower trophic level&rdquo; a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>species degree</code></td>
<td>
<p>Sum of links per species.</p>
</td></tr>
<tr><td><code>normalised degree</code></td>
<td>
<p>As degree, but scaled by the number of possible partners; see <code><a href="#topic+ND">ND</a></code>.</p>
</td></tr>

<tr><td><code>species strength</code></td>
<td>
<p>Sum of dependencies of each species (used, e.g., in Bascompte et al. 2006). It aims at quantifying a species' relevance across all its partners. The alternative version of Barrat et al. (2004; also used by Poisot et al. 2012) as the sum of interactions of a species seems too trivial a measure, reflecting abundance rather than anything else. Do not take this to be the much-discussed &ldquo;interaction strength&rdquo; in food web papers, which focusses on pairwise interactions (reviewed in Berlow et al. 2004)!</p>
</td></tr>
<tr><td><code>interaction push pull</code></td>
<td>
<p>Direction of interaction asymmetry based on dependencies: positive values indicate that a species affects the species of the other level it interacts with stronger then they affect it (&ldquo;pusher&rdquo;); negative values indicate that a species is, on average, on the receiving end of the stick (&ldquo;being pulled&rdquo;); formula based on Vázquez et al. (2007), but push/pull is our own nomenclature. Values are highly correlated with species strengths (see below), but standardised to fall between -1 (being pulled) and 1 (pushing). Compared to &ldquo;strength&rdquo;, this index quantifies the net balance, rather than the average effect.</p>
</td></tr>
<tr><td><code>nestedrank</code></td>
<td>
<p>Quantifies generalism by the rank of a species in a network matrix re-arranged for maximal nestedness (Alarcon et al. 2008). A low rank (e.g. 1, 2) indicates high generality, while high ranks (up to the number of species in that level) indicate specialism or rarity.</p>
</td></tr>
<tr><td><code>PDI</code></td>
<td>
<p>Paired Differences Index as proposed by Poisot et al. (2011a,b), by default using a normalised version (<span class="option">PDI.normalise=TRUE</span>); ranges between 0 (generalist) and 1 (specialist); see <code><a href="#topic+PDI">PDI</a></code> for details and comments.</p>
</td></tr>
<tr><td><code>resource range</code></td>
<td>
<p>Poisot et al.'s (2012) &ldquo;resource range&rdquo; is a somewhat strange name for something that has a value of 0 when all resources are used, but a value of 1 when only one resource is used. It is, in fact, closer to an &ldquo;unused resource range&rdquo;.  The aforementioned Paired Difference Index is a generalisation of resource range, which is equal to resource range when the web is binary.</p>
</td></tr>
<tr><td><code>species specificity</code></td>
<td>
<p>Coefficient of variation of interactions, normalised to values between 0 and 1, following the idea of Julliard et al. (2006), as proposed by Poisot et al. (2012). Values of 0 indicate low, those of 1 a high variability (and hence suggesting low and high specificity). Since not corrected for number of observations, this index will yield high specificity for singletons, even though there is no information to support this conclusion.</p>
</td></tr> 
<tr><td><code>PSI</code></td>
<td>
<p>Pollination Service Index for the higher trophic level, and the equivalent Pollinator Support Index for the lower trophic level. See Details above for more explanations.</p>
</td></tr> 
<tr><td><code>node specialisation index</code></td>
<td>
<p>Another measure of specialisation, based on the path length between any two higher-trophic level species. Species sharing hosts/prey have an FS-value of 1. See specific function <code><a href="#topic+nodespec">nodespec</a></code> for details, problems and reference.</p>
</td></tr>
<tr><td><code>betweenness</code></td>
<td>
<p>A value describing the centrality of a species in the network by its position on the shortest paths between other nodes; see <code><a href="#topic+BC">BC</a></code> and <code>betweenness</code> in <span class="pkg">sna</span> and the dedicated section in the vignette (sec. 5.4.1).</p>
</td></tr>
<tr><td><code>weighted betweenness</code></td>
<td>
<p>Computes betweenness (proportion of shortest paths through this species), but based on weighted representation of the network. It calls <code>betweenness_w</code> from <span class="pkg">tnet</span> and often differs considerably from its binary counterpart!</p>
</td></tr>
<tr><td><code>closeness</code></td>
<td>
<p>A value describing the centrality of a species in the network by its path lengths to other nodes; see <code><a href="#topic+CC">CC</a></code> and <code>closeness</code> in <span class="pkg">sna</span>.</p>
</td></tr>
<tr><td><code>weighted closeness</code></td>
<td>
<p>Computes closeness (in one of its varieties), but based on weighted representation of the network. It calls 
<code>closeness_w</code> from <span class="pkg">tnet</span> and is usually very similar to its binary counterpart. Note that NAs indicate that these species belong to a different compartment and hence no closeness distance could be calculated.</p>
</td></tr>
<tr><td><code>Fisher alpha</code></td>
<td>
<p>Fisher's alpha diversity for each species (see <code>fisher.alpha</code> in <span class="pkg">vegan</span> for details).</p>
</td></tr>
<tr><td><code>partner diversity</code></td>
<td>
<p>Shannon diversity (when using <span class="option">logbase="e"</span>) or per-species generality/vulnerability (when using 
<span class="option">logbase=2</span>) of the interactions of each species. See also <code><a href="#topic+networklevel">networklevel</a></code> for the aggregated version of this index (i.e. averaged across all species in a trophic level).</p>
</td></tr>
<tr><td><code>effective partners</code></td>
<td>
<p><span class="option">logbase</span> to the power of &ldquo;partner.diversity&rdquo;: Bersier et al. (2002) interpret this as the effective 
number of partners, if each partner was equally common. Note that &ldquo;partner&rdquo; is a bit euphemistic when it comes to predator-prey or host-parasitoid networks.</p>
</td></tr>
<tr><td><code>proportional generality</code></td>
<td>
<p>&lsquo;Effective partners&rsquo; divided by effective number of resources (&lsquo;logbase&rsquo; to the power of &lsquo;resource diversity&rsquo;; which is calculated from high.abun/low.abun if provided, and else from marginal totals); this is the quantitative version of proportional resource use or normalised degree (i.e., the number of partner species in relation to the potential number of partner species); note that this index can be larger than 1, e.g. when a species selects for a balanced diet.</p>
</td></tr>
<tr><td><code>proportional similarity</code></td>
<td>
<p>Specialization measured as dissimilarity between resource use and availability (estimated from high.abun/low.abun if provided, else from marginal totals); proposed by Feinsinger et al. (1981).</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Specialisation of each species based on its discrimination from random selection of partners. More specifically, it returns d', which is calculated based on the  raw <code>d</code>, <code>dmin</code> and <code>dmax</code> for each species (see <code><a href="#topic+dfun">dfun</a></code>). See Blüthgen et al. (2006) for details.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>A comparison of specialisation indices is provided in Dormann (2011); the PDI is missing (since it was published later).
</p>
<p>Dependencies are still an open field of debate. Dependencies are calculated as the value in a matrix divided by the <code>rowSums</code> (for the lower trophic level) or the <code>colSums</code> (for the higher trophic level). As such, any pollinator observed only once will receive a dependency-value of 1, indicating perfect dependence on this plant species. That may or may not be true. In any case it is based on a sample size of 1, that is why the dependency asymmetry (which is based on the dependencies for both trophic levels) has come under criticism and may be rather sensitive to singletons.
</p>
<p>We here provide the code to calculate the strength of a species (i.e. sum of its dependencies), based on the current proposal by Bascompte et al. (2006). It may be a good idea to remove all singletons from the web before calculating this index, to investigate whether it is indeed driven by those scarce observations.
</p>
<p>The maximum value of the uncorrected d (i.e. the maximal potential specialization defining d'=1) is not a trivial issue. We treat it here in the same way as given in the BMC Ecology paper, but please have a look at the (raw) code for further comments.
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a> &amp; Jochen Fründ</p>


<h3>References</h3>

<p>Alarcon, R., Waser, N.M. and Ollerton, J. 2008. Year-to-year variation in the topology of a plant-pollinator interaction network. <em>Oikos</em> <b>117</b>, 1796&ndash;1807
</p>
<p>Barrat, A., M. Barthélemy, R. Pastor-Satorras, and A. Vespignani. 2004. The architecture of complex weighted networks. <em>Proceedings of the National Academy of Sciences of the USA</em> <b>101</b>, 3747–-3752. doi: 10.1073/pnas.0400087101.
</p>
<p>Bascompte, J., Jordano, P. and Olesen, J. M. (2006) Asymmetric coevolutionary networks facilitate biodiversity maintenance. <em>Science</em> <b>312</b>, 431&ndash;433
</p>
<p>Berlow, E. L., A. M. Neutel, J. E. Cohen, P. C. de Ruiter, B. Ebenman, M. Emmerson, J. W. Fox, V. A. A. Jansen, J. I. Jones, G. D. Kokkoris, D. O. Logofet, A. J. McKane, J. M. Montoya &amp; O. Petchey (2004) Interaction strengths in food webs: issues and opportunities. <em>Journal of Animal Ecology</em> <b>73</b>, 585-–598
</p>
<p>Blüthgen, N., Menzel, F. and Blüthgen, N. (2006) Measuring specialization in species interaction networks. <em>BMC Ecology</em> <b>6</b>, 9
</p>
<p>Dormann, C.F. (2011) How to be a specialist? Quantifying specialisation in pollination networks. <em>Network Biology</em> <b>1</b>, 1&ndash;20
</p>
<p>Feinsinger, P., Spears, E.E. and Poole,R. W. (1981) A simple measure of niche breadth. <em>Ecology</em> <b>62</b>, 27&ndash;32.
</p>
<p>Julliard, R., Clavel, J., Devictor, V., Jiguet, F. and Couvet, D. (2006) Spatial segregation of specialists and generalists in bird communities. <em>Ecology Letters</em> <b>9</b>, 1237-–1244
</p>
<p>Martín Gonzáles, A.M., Dalsgaard, B. and Olesen, J.M. (2010) Centrality measures and the importance of generalist species in pollination networks. <em>Ecological Complexity</em>, <b>7</b>, 36&ndash;43
</p>
<p>Opsahl, T. &amp; Panzarasa, P. (2009). Clustering in weighted networks. Social Networks, 31, 155&ndash;163
</p>
<p>Poisot, T., Lepennetier, G., Martinez, E., Ramsayer, J., and Hochberg, M.E. (2011a) Resource availability affects the structure of a natural bacteria-bacteriophage community. <em>Biology Letters</em> <b>7</b>, 201&ndash;204
</p>
<p>Poisot, T., Bever, J.D., Nemri, A., Thrall, P.H., and Hochberg, M.E. (2011b) A conceptual framework for the evolution of ecological specialisation. <em>Ecology Letters</em> <b>14</b>, 841&ndash;851
</p>
<p>Poisot, T., E. Canard, N. Mouquet, and M. E. Hochberg (2012) A comparative study of ecological specialization estimators. <em>Methods in Ecology and Evolution</em> <b>3</b>, 537-–544. doi: 10.1111/j.2041-210X.2011.00174.x.
</p>
<p>Vázquez, D. P., Melian, C. J., Williams, N. M., Blüthgen N., Krasnov B. R. and Poulin, R. (2007) Species abundance and asymmetric interaction strength in ecological networks. <em>Oikos</em> <b>116</b>, 1120&ndash;1127
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+networklevel">networklevel</a></code> for some further comments; <code><a href="#topic+dfun">dfun</a></code>, <code><a href="#topic+nodespec">nodespec</a></code>, which are called by this function </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
## Not run: 
specieslevel(Safariland)
## End(Not run)
specieslevel(Safariland, index="ALLBUTD")[[2]]
</code></pre>

<hr>
<h2 id='spectral.radius'>Calculates the spectral radius as a nestedness measurement of a bipartite matrix, possibly with regard to mass action</h2><span id='topic+spectral.radius'></span><span id='topic+massaction'></span>

<h3>Description</h3>

<p>This function calculates the spectral radius (i.e. the maximum absolute value of the Eigenvalues) 
of the square adjacency matrix corresponding tp a given bipartite matrix. This may be used as a measure of 
nestedness as described by Staniczenko et al. (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  spectral.radius(web, mass.action.norm = FALSE)
  massaction(web)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spectral.radius_+3A_web">web</code></td>
<td>
<p>A matrix with lower trophic level species as rows, higher trophic 
level species as columns and number of interactions as entries.</p>
</td></tr>
<tr><td><code id="spectral.radius_+3A_mass.action.norm">mass.action.norm</code></td>
<td>
<p>If TRUE the matrix is normalized for mass action 
using the massaction() function before calculating 
the spectral radius.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The spectral radius (i.e. the largest Eigenvalue) of the square adjacency matrix
corresponding to the given bipartite matrix.
</p>


<h3>Massaction</h3>

<p>Implementation of mass action calculations based on 
section 6.2 &quot;Effective abundance, pseudo-inverse and mass action&quot; in
the Supplementary Information of Staniczenko et al. (2013).
</p>


<h3>Author(s)</h3>

<p> Tobias Bauer <a href="mailto:tobias.bauer-2@studium.uni-hamburg.de">tobias.bauer-2@studium.uni-hamburg.de</a></p>


<h3>References</h3>

<p>Staniczenko, P., Kopp, J. &amp; Allesina, S. (2013) The ghost of nestedness in ecological networks. <em>Nat. Commun.</em> <b>4</b>, 1391. <a href="https://doi.org/10.1038/ncomms2422">doi:10.1038/ncomms2422</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(bezerra2009, package="bipartite")
  spectral.radius(bezerra2009, mass.action.norm = TRUE)
</code></pre>

<hr>
<h2 id='strength'>Computes species strength according to either of two definitions</h2><span id='topic+strength'></span>

<h3>Description</h3>

<p>Computes species strength of the higher level species as a measure of how important a species is in the network
</p>


<h3>Usage</h3>

<pre><code class='language-R'> strength(web, type="Bascompte")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strength_+3A_web">web</code></td>
<td>
<p>A matrix with lower trophic level species as rows, higher trophic level species as columns and number of interactions as entries.</p>
</td></tr>
<tr><td><code id="strength_+3A_type">type</code></td>
<td>
<p>Which definition of species strength should be used, <span class="option">Bascompte</span> (default) or <span class="option">Barrat</span>? See Details for definitions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two definitions of species strength, that of Bascompte et al. (2006) as the sum of dependencies of a species, and that of Barrat et al. (2004) as the weighted sum of links. As a consequence, Bascompte et al.'s strength sums to the number of species in the other group, while Barrat et al.'s strength is simply the number of interactions, a trivial measure of a species importance. 
</p>
<p>In contrast to the claim of Gilarranz et al. (2012, p. 1155), this definition of strength gives no information of the centrality of a species within a network structure (and neither does Bascompte et al.'s).</p>


<h3>Value</h3>

<p>A vector of species strengths for the higher level. Employ this function on the transpose of the web to compute the strengths of the lower level (see example).
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a> </p>


<h3>References</h3>

<p>Barrat, A., Barthélemy, M., Pastor-Satorras, R. &amp; Vespignani, A. (2004) The architecture of complex weighted networks. <em>Proceedings of the National Academy of Sciences of the USA</em> <b>101</b>, 3747-–3752
</p>
<p>Bascompte, J., Jordano, P. &amp; Olesen, J.M. (2006) Asymmetric coevolutionary networks facilitate biodiversity maintenance. <em>Science</em> <b>312</b>, 431-–433
</p>
<p>Gilarranz, L.J., Pastor, J.M. &amp; Galeano, J. (2012) The architecture of weighted mutualistic networks. <em>Oikos</em> <b>121</b>, 1154-–1162
</p>


<h3>See Also</h3>

<p><code><a href="#topic+specieslevel">specieslevel</a></code> which could (but doesn't yet) call <code>strength</code> (instead it uses the default always)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
s1 &lt;- strength(Safariland, type="Barrat")
s2 &lt;- strength(Safariland, type="Bascompte")
plot(s1, s2, log="x")
cor.test(s1, s2, type="ken")
# for lower level:
strength(t(Safariland))

</code></pre>

<hr>
<h2 id='swap.web'> Creates null model for bipartite networks</h2><span id='topic+swap.web'></span>

<h3>Description</h3>

<p>Function to generate null model webs under the following constraints: 1. marginal 
totals are identical to those observed (as in <code>r2dtable</code>), 2. connectance is as observed (as in <code>shuffle.web</code>.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swap.web(N, web, verbose=FALSE, c.crit=1e4)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="swap.web_+3A_n">N</code></td>
<td>
<p> Number of desired null model matrices. </p>
</td></tr>
<tr><td><code id="swap.web_+3A_web">web</code></td>
<td>
<p>An interaction matrix.</p>
</td></tr>
<tr><td><code id="swap.web_+3A_verbose">verbose</code></td>
<td>
<p>Should various verbal outputs of this function be shown? Defaults to FALSE, since it was
mainly used during the debugging period.</p>
</td></tr>
<tr><td><code id="swap.web_+3A_c.crit">c.crit</code></td>
<td>
<p>Sometimes the algorithm gets stuck in a very sparse matrix. Then <span class="option">c.crit</span> sets the number of
swaps it shall attempt before giving up and starting over on a new random matrix. Defaults to 10000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is designed to behave similar to <code>r2dtable</code>, i.e. it returns a list of randomised matrices.  In addition to <code>r2dtable</code> is also keeps the connectance constant! 
</p>
<p>This function is thought of as a very constrained null model for the analysis of bipartite webs.  It keeps two web properties constant: The marginal totals (as in <code>r2dtable</code> and the  number of links (and hence connectance). A comparison of <code>swap.web</code>- and <code>r2dtable</code>-based  webs allows to elucidate the effect of evolutionary specialisation, since the unrealised connections may represent &ldquo;forbidden links&rdquo;. 
</p>
<p>This null model is similar to the one employed by Vázquez et al. But while Vázquez starts by assigning 1s to the  allowed connections and then fills the web, <code>swap.web</code> starts with an <code>r2dtable</code>-web and successively  &ldquo;empties&rdquo; it. The two approaches should result in very similar null models, since both constrain marginal  totals and connectance.
</p>
<p>A few words on the way <code>swap.web</code> works. It starts with a random web created by <code>r2dtable</code>. Then, it finds, randomly, 2x2 submatrices with entries all larger than 0. Next, it subtracts the minimum value from the diagonal and adds it to the off-diagonal (minor diagonal). Thereby one cell becomes 0, but the column and row sums do not change. This idea is adapted from the swap-algorithm used in various binary null models by Nick Gotelli. If the random web has  too few 0s (which is I have yet to encounter), then the opposite strategy is applied.
</p>
<p>The algorithm in our implementation has some variations on finding the submatrix and constraining the number of  unsuccessfull trials before starting on a new random matrix, but they are only for speeding up the process.
</p>


<h3>Value</h3>

<p>A list of N randomised matrices with the same dimensions as the initial web.
</p>


<h3>Note</h3>

 
<p>Long stories can be told about the swap algorithm. I am not the right person to do so, but for a much more detailed coverage of the topic, for many more ways to implement null models for <b>binary</b> matrices, with various flavours of the swap and possible alternatives, first brew yourself a cup of tea and then check out the help pages of <code>simulate</code> in <span class="pkg">vegan</span>. (As usual, Jari Oksanen has spend considerable care to implement even the most bizarre and abstruse way to move 0s and 1s around. His ecological advise between the lines make his package worthwhile already! I, personally, would use <span class="option">method="quasiswap"</span>, as is done in the example to <code><a href="#topic+discrepancy">discrepancy</a></code>.)
</p>
<p>When comparing the <code>swap.web</code> algorithm with that proposed by Vázquez et al. (2007, implemented in <code><a href="#topic+vaznull">vaznull</a></code>), we found that <code>swap.web</code> contains a certain bias. The subtraction of the swap will reduce the value of low-value cells, and increase that of high-value cells. As a consequence, it produces somewhat of a dichotomy between very high and very low values. Using e.g. H2' to quantify this pattern, <code>swap.web</code> will produce very specialised networks (around 0.5), while the Vazquez-algorithm yields lower H2' values and a more even distribution of interactions within cells.
The ramifications are that <code>swap.web</code> will predict higher-than-necessary expectations. (Date of this entry: 15.1.2010)
</p>
<p>In fact, Artzy-Randrup &amp; Stone (2005) have shown that the swap algorithm is <em>fundamentally biased</em>, because some swaps are more likely than others. This applies to this version of the swap as well as to the one implemented in <code><a href="#topic+vaznull">vaznull</a></code>. So, despite heavy citation, the approach of Miklós &amp; Podani (2004) is thus also not ideal, as often claimed.
</p>
<p><code>swap.web</code> is a very constraint null model. You need to consider if it is the right one for your application!
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt; </p>


<h3>References</h3>

<p>Artzy-Randrup, Y., and Stone, L. (2005) Generating uniformly distributed random networks. <em>Physical Review E</em> <b>72</b>, 1&ndash;7
</p>
<p>Miklós, I. and Podani, J. (2004) Randomization of presence-absence matrices: comments and new algorithms. <em>Ecology</em> <b>85</b>, 86&ndash;92
</p>
<p>Vázquez, D. P., and M. A. Aizen (2003) Null model analyses of specialization in plant-pollinator interactions. <em>Ecology</em> <b>84</b>, 2493&ndash;2501
</p>
<p>Vázquez, D. P., C. J. Melian, N. M. Williams, N. Blüthgen, B. R. Krasnov, and R. Poulin (2007) Species abundance and asymmetric interaction strength in ecological networks. <em>Oikos</em> <b>116</b>, 1120&ndash;1127
</p>
<p>For a very nice and thorough overview of null models in general see:
</p>
<p>Gotelli, N. J., and G. R. Graves (1996) Null Models in Ecology. Smithsonian Institution Press, Washington D.C.
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+r2dtable">r2dtable</a></code>, <code><a href="#topic+vaznull">vaznull</a></code> and <code><a href="#topic+shuffle.web">shuffle.web</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
swap.web(Safariland, N=2)

</code></pre>

<hr>
<h2 id='symmetrise_w'> Symmetrise_w </h2><span id='topic+symmetrise_w'></span>

<h3>Description</h3>

<p> The symmetrise_w-function creates an undirected one-mode network from a directed one-mode network. </p>


<h3>Usage</h3>

<pre><code class='language-R'>symmetrise_w(net, method="MAX")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="symmetrise_w_+3A_net">net</code></td>
<td>
<p>A one-mode network </p>
</td></tr>
<tr><td><code id="symmetrise_w_+3A_method">method</code></td>
<td>
<p> the method used to decide the weight of the undirected edge. It can be: 
&quot;MAX&quot; sets the weight to the maximum of the weight(s) of the arc(s)
&quot;MIN&quot; sets the weight to the minimumof the weight(s) of the arc(s)
&quot;AMEAN&quot; sets the weight to the average (arithmetic mean) of the weight(s) of the arc(s)
&quot;SUM&quot; sets the weight to the sum of the weight(s) of the arc(s)
&quot;PROD&quot; sets the weight to the product of the weight(s) of the arc(s)
&quot;DIFF&quot; sets the weight to the absolute difference between the weight(s) of the arc(s) </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the undirected network </p>


<h3>Note</h3>

<p> version 1.0.0, taken, with permission, from package tnet </p>


<h3>Author(s)</h3>

<p> Tore Opsahl; <a href="https://toreopsahl.com/">https://toreopsahl.com/</a> </p>


<h3>References</h3>

 <p><a href="https://toreopsahl.com/2008/11/28/network-weighted-network/">https://toreopsahl.com/2008/11/28/network-weighted-network/</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load sample data
sample &lt;- rbind(
c(1,2,2),
c(1,3,2),
c(2,1,4),
c(2,3,4),
c(2,4,1),
c(2,5,2),
c(3,1,2),
c(3,2,4),
c(5,2,2),
c(5,6,1))

## Run the programme
symmetrise_w(sample, method="MAX")
</code></pre>

<hr>
<h2 id='tnet_igraph'> Exports a tnet network to an igraph object </h2><span id='topic+tnet_igraph'></span>

<h3>Description</h3>

<p>The tnet_igraph function creates an igraph object from a tnet network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tnet_igraph(net,type=NULL, directed=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tnet_igraph_+3A_net">net</code></td>
<td>
<p>A tnet network </p>
</td></tr>
<tr><td><code id="tnet_igraph_+3A_type">type</code></td>
<td>
<p> type of tnet network, see as.tnet. </p>
</td></tr>
<tr><td><code id="tnet_igraph_+3A_directed">directed</code></td>
<td>
<p> if a one-mode networks, this can be set to avoid testing whether the network is directed. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the igraph object.</p>


<h3>Note</h3>

<p> version 1.0.0, taken, with permission, from package tnet  </p>


<h3>Author(s)</h3>

<p> Tore Opsahl; <a href="https://toreopsahl.com">https://toreopsahl.com</a> </p>


<h3>References</h3>

 <p><a href="https://toreopsahl.com/">https://toreopsahl.com/</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load sample data
sample &lt;- rbind(
c(1,2,4),
c(1,3,2),
c(2,1,4),
c(2,3,4),
c(2,4,1),
c(2,5,2),
c(3,1,2),
c(3,2,4),
c(4,2,1),
c(5,2,2),
c(5,6,1),
c(6,5,1))

## Run the programme
tnet_igraph(sample, type="weighted one-mode tnet")

</code></pre>

<hr>
<h2 id='togetherness'> Calculates the number of identical co-presences and co-absences for species-on-islands </h2><span id='topic+togetherness'></span>

<h3>Description</h3>

<p>Togetherness, or T-score, describes the level of similarity in the distributional pattern of two species. Originally proposed by Stone &amp; Roberts (1992) for biogeographical situations can it also be applied e.g. to pollinators on different host plants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>togetherness(web, normalise=TRUE, FUN = mean, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="togetherness_+3A_web">web</code></td>
<td>
<p> A matrix with binary or counted interactions/links, where the higher trophic level is represented by columns.</p>
</td></tr>
<tr><td><code id="togetherness_+3A_normalise">normalise</code></td>
<td>
<p>Logical; shall index be normalised to a range of 0-1?</p>
</td></tr>
<tr><td><code id="togetherness_+3A_fun">FUN</code></td>
<td>
<p> The function to summarise species-pair T-scores with; defaults to mean.</p>
</td></tr>
<tr><td><code id="togetherness_+3A_...">...</code></td>
<td>
<p> Arguments passed on to <code>FUN</code>, especially <code>na.rm=T</code> or colours for <code>hist</code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the average (default) togetherness of all species combinations.   
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann</p>


<h3>References</h3>

 
<p>Stone, L. and Roberts, A. (1992) Competitive exclusion, or species aggregation? An aid in deciding. <em>Oecologia</em> <b>91</b>, 419&ndash;424
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+C.score">C.score</a></code> for another of Stone &amp; Roberts' indices. </p>


<h3>Examples</h3>

<pre><code class='language-R'>(m &lt;- matrix(c(0,1,0,0,1,1,0,1,1,0), ncol=2, byrow=TRUE))
togetherness(m)
# or, with two togethernesses:
(n &lt;- matrix(c(0,1,1,0,1,1,0,0,1,1,0,1,0,1), ncol=2, byrow=TRUE))
togetherness(n, normalise=FALSE)

data(Safariland)
togetherness(m)
</code></pre>

<hr>
<h2 id='V.ratio'> Calculates the variance-ratio as suggested by Schluter (1984) </h2><span id='topic+V.ratio'></span>

<h3>Description</h3>

<p>A of species association is provided by the ratio of the variance in total species number (or total density of individuals) in samples to the sum of the variances of the individual species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>V.ratio(web)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="V.ratio_+3A_web">web</code></td>
<td>
<p> A matrix with pollinators in columns and plants in rows. For biogeographical applications: rows are islands (or sites). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a rather straight-forward index, which is described and evaluated extensively in Schluter (1984). He also warns against overinterpretation of the value. In principle, V-ratios larger than 1 indicate positive, smaller than 1 negative associations. Ecologically, competition can lead to small or large values, depending on their exact effects (see discussion in the Schluter paper).
</p>


<h3>Value</h3>

<p>Returns the V-ratio, i.e. a single value representing the ratio of variance in species number and variance in individual numbers within species.
</p>


<h3>Note</h3>

 
<p>Any quantitative matrix is first transformed into a binary (presence-absence) matrix!
</p>
<p>Do not interpret without first reading the paper! It's worth it! See also applications in other studies, such as Gotelli and Rohde (2002).
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann</p>


<h3>References</h3>

 
<p>Gotelli, N.J. and Rohde, K. (2002) Co-occurrence of ectoparasites of marine fishes: a null model analysis. <em>Ecology Letters</em> <b>5</b>, 86&ndash;94
</p>
<p>Schluter, D. (1984) A variance test for detecting species associations, with some example applications. <em>Ecology</em> <b>65</b>, 998&ndash;1005
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+C.score">C.score</a></code> for another measure of species associations. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
V.ratio(Safariland)
</code></pre>

<hr>
<h2 id='vazarr'> A pollination network.</h2><span id='topic+vazarr'></span>

<h3>Description</h3>

<p>[See documentation for Safariland.]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vazarr)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:10, 1:29] 85 0 94 0 0 0 0 0 0 0 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:10] &quot;X2&quot; &quot;X1&quot; &quot;X13&quot; &quot;X4&quot; ...
..$ : chr [1:29] &quot;78&quot; &quot;65&quot; &quot;94&quot; &quot;66&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vazarr)
## maybe str(vazarr) ; plot(vazarr) ...
</code></pre>

<hr>
<h2 id='vazcer'>A pollination network.</h2><span id='topic+vazcer'></span>

<h3>Description</h3>

<p>[See documentation for Safariland.]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vazcer)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:9, 1:33] 59 0 110 0 0 0 0 0 0 0 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:9] &quot;X2&quot; &quot;X1&quot; &quot;X13&quot; &quot;X4&quot; ...
..$ : chr [1:33] &quot;78&quot; &quot;65&quot; &quot;94&quot; &quot;32&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vazcer)
## maybe str(vazcer) ; plot(vazcer) ...
</code></pre>

<hr>
<h2 id='vazllao'>A pollination network.</h2><span id='topic+vazllao'></span>

<h3>Description</h3>

<p>[See documentation for Safariland.]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vazllao)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:10, 1:29] 64 0 82 0 0 0 0 0 0 0 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:10] &quot;X2&quot; &quot;X1&quot; &quot;X13&quot; &quot;X4&quot; ...
..$ : chr [1:29] &quot;78&quot; &quot;65&quot; &quot;94&quot; &quot;32&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vazllao)
## maybe str(vazllao) ; plot(vazllao) ...
</code></pre>

<hr>
<h2 id='vazmasc'>A pollination network.</h2><span id='topic+vazmasc'></span>

<h3>Description</h3>

<p>[See documentation for Safariland.]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vazmasc)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:8, 1:26] 73 0 0 0 0 0 0 0 0 6 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:8] &quot;X2&quot; &quot;X1&quot; &quot;X13&quot; &quot;X4&quot; ...
..$ : chr [1:26] &quot;78&quot; &quot;65&quot; &quot;94&quot; &quot;32&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vazmasc)
## maybe str(vazmasc) ; plot(vazmasc) ...
</code></pre>

<hr>
<h2 id='vazmasnc'>A pollination network.</h2><span id='topic+vazmasnc'></span>

<h3>Description</h3>

<p>[See documentation for Safariland.]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vazmasnc)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:8, 1:35] 26 0 0 0 0 0 0 0 0 123 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:8] &quot;X2&quot; &quot;X1&quot; &quot;X13&quot; &quot;X4&quot; ...
..$ : chr [1:35] &quot;78&quot; &quot;65&quot; &quot;94&quot; &quot;32&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vazmasnc)
## maybe str(vazmasnc) ; plot(vazmasnc) ...
</code></pre>

<hr>
<h2 id='vaznull'> Null model with constrained connectance and moderately constrained marginal totals</h2><span id='topic+vaznull'></span>

<h3>Description</h3>

<p>  Implements Diego Vazquez proposal of a null model for pollination networks </p>


<h3>Usage</h3>

<pre><code class='language-R'> vaznull(N, web) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vaznull_+3A_n">N</code></td>
<td>
<p> Number of desired null model webs. </p>
</td></tr>
<tr><td><code id="vaznull_+3A_web">web</code></td>
<td>
<p> An interaction matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a null model network with the main constraint of a connectance that is the same as in the original network. In the process of producing this null model, marginal totals will turn out to be different from the original network, less so for large, dense webs than for small, sparse webs. <code>vaznull</code> is our implementation of the algorithm proposed by Diego Vazquez, hence its name.
<code>vaznull</code> differs from <code><a href="#topic+swap.web">swap.web</a></code> in that marginal totals are not strictly constrained! The algorithm used as well as the null model it outputs are different. 
</p>
<p>The algorithm was described as follows:
&quot;The algorithm randomized the total number of individual interactions observed in the original interaction matrix, F. To this end, the algorithm first created a binary matrix, assigning interspecific  interactions  according  to  species-specific probabilities, requiring that each species had at least one interaction. As in Vazquez et al. (2005b), the species-specific probabilities were proportional to species' relative  abundances  (probabilities  are  in  fact  approximately proportional and not equal to relative abundances because of the requirement that each species receives at  least one interaction; this requirement causes probabilities to deviate from relative abundances, especially for rare  species).  Once  the  number  of  filled  cells  in  the original matrix was reached, the remaining interactions were  distributed  among  the  filled  cells,  so  that  connectance in the original and randomized matrices was the same.&quot; (Vazquez et al. 2007, page 1122-1123).
</p>


<h3>Value</h3>

<p>A list of N randomised matrices with the same dimensions and connectivity as the initial web.
</p>


<h3>Author(s)</h3>

<p> Bernd Gruber &lt;bernd.gruber@canberra.edu.au&gt; &amp; Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt; </p>


<h3>References</h3>

<p>Vázquez, D. P., C. J. Melian, N. M. Williams, N. Blüthgen, B. R. Krasnov, and R. Poulin. 2007. Species abundance and asymmetric interaction strength in ecological networks. Oikos 116: 1120-1127.
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+r2dtable">r2dtable</a></code>, <code><a href="#topic+swap.web">swap.web</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>	## Not run: 
		data(Safariland)
		networklevel(Safariland, index="info")
		networklevel(vaznull(1, Safariland)[[1]], index="info")
		system.time(vaznull(10, Safariland))
		system.time(swap.web(10, Safariland))
	
## End(Not run)
</code></pre>

<hr>
<h2 id='vazquec'>A pollination network.</h2><span id='topic+vazquec'></span>

<h3>Description</h3>

<p>[See documentation for Safariland.]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vazquec)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:8, 1:27] 31 0 34 150 11 66 2 4 0 63 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:8] &quot;X1&quot; &quot;X13&quot; &quot;X4&quot; &quot;X15&quot; ...
..$ : chr [1:27] &quot;65&quot; &quot;94&quot; &quot;32&quot; &quot;66&quot; ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(vazquec)
## maybe str(vazquec) ; plot(vazquec) ...
</code></pre>

<hr>
<h2 id='vazquenc'>A pollination network.</h2><span id='topic+vazquenc'></span>

<h3>Description</h3>

<p>[See documentation for Safariland.]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(vazquenc)</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(vazquenc)
## maybe str(vazquenc) ; plot(vazquenc) ...
</code></pre>

<hr>
<h2 id='vazquez.example'> Examples for some analyses </h2><span id='topic+vazquez.example'></span><span id='topic+confint'></span><span id='topic+intasymm'></span><span id='topic+intereven'></span><span id='topic+mlik'></span><span id='topic+netstats'></span><span id='topic+plotmat'></span><span id='topic+quant2bin'></span><span id='topic+sortmatr'></span><span id='topic+sortmatrext'></span>

<h3>Description</h3>

<p>Describes how to use bipartite to calculate the statistics presented in Vázquez et al. (2009). Some of these functions are available in bipartite or other packages, and this help page will show how to use them in line with the publication.
</p>


<h3>Details</h3>

<p>The functions used are:
</p>

<dl>
<dt>confint:</dt><dd><p> Is the same as <code>quantile</code></p>
</dd>
<dt>intasymm:</dt><dd><p> Can be extracted using <code><a href="#topic+specieslevel">specieslevel</a></code></p>
</dd>
<dt>intereven:</dt><dd><p> Is similar to interaction evenness in <code><a href="#topic+networklevel">networklevel</a></code>, but only for a specific option</p>
</dd>

<dt>mlik:</dt><dd><p>A specific call to <code>dmultinom</code> and the calculation of the AIC; the number of parameters entering the AIC-calculation is not obvious; this depends on the constraints used by the null model. In the case of <code>r2dtable</code>, column and row totals are constrained, i.e. ncol+nrow parameters must be given. In the case of <code><a href="#topic+swap.web">swap.web</a></code>, connectance is also constrained, but how many parameters does that imply? One? In <code><a href="#topic+shuffle.web">shuffle.web</a></code>, we constrain the dimensionality and connectance, i.e. 3 (?) parameters. Vázquez et al. (2009) argue that they constrain only 2 parameters when producing the probability matrix given as pweb in the example below. We tend to disagree: the marginal probabilities of all columns and rows are given, hence k = (ncol(web) + nrow(web)). To our knowledge, there is no mathematical/statistical treatise of this problem.</p>
</dd>
<dt>netstats:</dt><dd><p>A wrapper calling the other functions, in that sense similar to <code><a href="#topic+networklevel">networklevel</a></code>, but also calling some output from <code><a href="#topic+specieslevel">specieslevel</a></code>.</p>
</dd>
<dt>plotmat:</dt><dd><p>Now part of <code><a href="#topic+visweb">visweb</a></code>, using the right options.</p>
</dd>
<dt>quant2bin:</dt><dd><p>A dedicated function to do a simple thing: <code>(web&gt;0)*1</code>.</p>
</dd>
<dt>sortmatr:</dt><dd><p>newly defined function: <code><a href="#topic+sortweb">sortweb</a></code></p>
</dd>
<dt>sortmatrext:</dt><dd><p>sort matrix by some given sequence; also part of <code><a href="#topic+sortweb">sortweb</a></code></p>
</dd>
</dl>

<p>In the example below, we use the <span class="pkg">bipartite</span>/standard R functions whenever possible. 
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt; based on code and ideas of Diego Vázquez, Natacha P. Chacoff and Luciano Cagnolo</p>


<h3>References</h3>

<p>Vázquez, P.D., Chacoff, N.,P. and  Cagnolo, L. (2009) Evaluating multiple determinants of the structure of plant-animal mutualistic networks. <em>Ecology</em> <b>90</b>, 2039&ndash;2046.
</p>


<h3>See Also</h3>

<p> See also <code><a href="#topic+networklevel">networklevel</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
	data(Safariland)
	
	# confint:
	N100 &lt;- sapply(swap.web(100, Safariland), networklevel, index="nestedness")
	quantile(unlist(N100), c(0.025, 0.975))
	# intasymm: extract values for the asymmetry of interactions and the 
	# dependency matrix for pollinators:
	specieslevel(Safariland)$"higher trophic level"$"interaction push/pull"
	specieslevel(Safariland)$"higher trophic level"$"dependence"
	# for plants:
	specieslevel(Safariland)$"lower trophic level"$"interaction push/pull"
	specieslevel(Safariland)$"lower trophic level"$"dependence"
	
	#intereven
	networklevel(Safariland, index="interaction evenness", intereven="sum")[2]
	# or, as we recommend (see help on networklevel):
	networklevel(Safariland, index="interaction evenness", intereven="prod")[2]
		
	# mlik:
	# calculates the log-likelihood of observing a network, given a probability  
	# matrix of the same size (pweb):
	dmultinom(Safariland&gt;0, prob=pweb, log=TRUE)
	# AIC (the number of parameters is given by how many constraints are put onto the 
	# null model; here, we constrain 9 rows and 27 columns, i.e. sum(dim(binweb))):
	-2*dmultinom(Safariland&gt;0, prob=pweb, log=TRUE) + 2*(sum(dim(binweb)))
	
	# netstats:
	networklevel(Safariland, 
	  index=c("connectance", "interaction evenness", "nestedness", "ISA"))
	mean(specieslevel(Safariland)$"higher trophic level"$"interaction push/pull")
	mean(specieslevel(Safariland)$"lower trophic level"$"interaction push/pull")
	
	#plotmat:
	visweb(t(unname(Safariland)), circles=TRUE, boxes=FALSE)
	
	#sortmatr/sortmatrext:
	sortweb(Safariland, sort.order="inc") #rares species first
	plotweb(sortweb(Safariland, sort.order="dec"), method="normal")
	plotweb(sortweb(web=Safariland, sort.order="seq", 
	  sequence=list(seq.higher=sample(colnames(Safariland)), 
	  seq.lower=sample(rownames(Safariland)))), 
	  method="normal")
	
## End(Not run)
</code></pre>

<hr>
<h2 id='versionlog'>Log of bipartite versions and changes</h2><span id='topic+versionlog'></span>

<h3>Description</h3>

<p>Log tracking changes, bug fixes and new functions in <span class="pkg">bipartite</span></p>


<h3>Usage</h3>

<pre><code class='language-R'>    versionlog()
</code></pre>


<h3>versionlog</h3>


<ul>
<li><p> 1.18 (release date: 06-Sep-2012)
</p>

<dl>
<dt>New function and index <code><a href="#topic+fd">fd</a></code>:</dt><dd><p><code><a href="#topic+fd">fd</a></code> computes the functional diversity for the rows of a web as a measure of ecological niche complementarity (Devoto et al. 2012). Function written and provided by Mariano Devoto. <code><a href="#topic+fd">fd</a></code> is also included in the computation of <code><a href="#topic+networklevel">networklevel</a></code>.</p>
</dd>  
<dt>New function <code><a href="#topic+czvalues">czvalues</a></code></dt><dd><p>to compute c- and z-values of the higher trophic level for modular networks. Requires a successful identification of modules through <code><a href="#topic+computeModules">computeModules</a></code>. These can then be used to identify connector species in a network.</p>
</dd>
<dt>Speed-up of <code><a href="#topic+plotweb">plotweb</a></code>:</dt><dd><p>Thanks to Dirk Raetzel, whose smart improvement made this function orders of magnitude faster! (Amazing how a total of 7 lines of code in a total of over 300 for this function can make such a vast improvement!)</p>
</dd>
<dt>Speed-up of <code><a href="#topic+compart">compart</a></code>:</dt><dd><p>Thanks to Juan M. Barreneche, whose smart improvement made this function orders of magnitude faster while using dramatically less memory.</p>
</dd>
<dt>New option for simulating extinctions in <code><a href="#topic+second.extinct">second.extinct</a></code> (and necessarily <code><a href="#topic+extinction">extinction</a></code>):</dt><dd><p>Use <span class="option">method="external"</span> to impose a specific sequence of exterminations onto the function. Provide this sequence as an index vector (e.g. <code>c(4,2,3,1)</code>) through the argument <span class="option">ext.row</span> or <span class="option">ext.col</span> (for lower and higher species level, respectively). Requested/proposed by Matt Koski. (Implementation is far from elegant and will be cleaned up in a future version.)</p>
</dd>
<dt>Modification of <code><a href="#topic+visweb">visweb</a></code>:</dt><dd><p>The user is now able to use user-defined colours (def.col) for interaction ranks (<span class="option">square="d"</span>). Thereby the number of interactions can define the colour of the cell in the plot. Makes visweb-plot prettier.</p>
</dd>
<dt>Important bug fix in <code><a href="#topic+robustness">robustness</a></code> and <code><a href="#topic+second.extinct">second.extinct</a></code>:</dt><dd><p><code><a href="#topic+robustness">robustness</a></code> sometimes interpreted wrongly which trophic level was subject to simulated extinction. That was easy to fix. En route, however, I also discovered unexpected behaviour in the <code><a href="#topic+second.extinct">second.extinct</a></code> function: it gobbled up the last species to be removed from the web. I do not think that extinction slope estimates are affected much, but robustness results may well be exhibiting a bias towards 0.5! Thanks to Silvia Santamaria for reporting this!</p>
</dd>
<dt>Little bug fix in functions <code><a href="#topic+BC">BC</a></code> and <code><a href="#topic+CC">CC</a></code>:</dt><dd><p>Functions always used unweighted networks for computing betweenness and closeness. The default is now to use weighted information, an option which can be switched off. Thanks to Michael Pocock for reporting and suggesting a fix! (Notice the help file for these functions and the large effect that the choice of settings can have on the results!)</p>
</dd>
<dt>Little bug fix in function <code><a href="#topic+computeModules">computeModules</a></code>:</dt><dd><p>Failed to work for networks with empty columns or rows. These will now be deleted (with a warning) before the analysis. Thanks to Julien Renoult for reporting.</p>
</dd>
<dt>Little bug fix in function <code><a href="#topic+plotweb">plotweb</a></code>:</dt><dd><p>Failed to work for networks with only one column or row. Thanks to Zhijiang Wang for reporting.</p>
</dd>
<dt>Minor bug fix in <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>Caused an error if a selection of indices was provided.</p>
</dd>
<dt>Corrections in the help of <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>Web asymmetry was explained the wrong way around (thanks to Bernhard Hoiß for reporting!) and there was some confusion in the help for whether quantitative or weighted-quantitative indices were implemented (Yvonne Fabian for correcting the clarification!).</p>
</dd>
</dl>

</li>
<li><p> 1.17 (release date: 20-AUG-2011)
</p>

<dl>
<dt>New specialisation index at the species level in function <code><a href="#topic+PDI">PDI</a></code>:</dt><dd><p>Computes the Paired Differences Index proposed by Poisot et al. (2011a,b). Also automatically now included in <code><a href="#topic+specieslevel">specieslevel</a></code>.</p>
</dd>
<dt>Bug fix in <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>Computation of betweenness was causing an error when the network was containing a single-link compartment. Thanks to Marco Mello for spotting!</p>
</dd>
<dt>Another PDF is included (Dormann 2011):</dt><dd><p>This paper compares specialisation indices, based on the function <code><a href="#topic+specieslevel">specieslevel</a></code>. All source code to reproduce these results is included. It can serve as a guide to the <code><a href="#topic+specieslevel">specieslevel</a></code> function and its interpretation.</p>
</dd>
</dl>

</li>
<li><p> 1.16 (release date: 29-May-2011)
</p>

<dl>
<dt>Bug fix and extended documentation in <code><a href="#topic+dfun">dfun</a></code>:</dt><dd><p>1. Sometimes d.min was larger than d.raw yielding negative d'-values. Since the search for d.min is heuristic, it can sometimes fail to yield lower values than d.raw. In these (rare) cases, d.min is now set to d.raw. 2. Documentation for a specific (but not uncommon or unreasonable) constellation added: When independent abundances were provided, the empty rows/columns are purposefully <em>not</em> removed from the web (because they now still contain information). Logically (and as implemented), this leads to d-values for these species of NA. This makes sense: the pollinator, say, has never been observed on any of the flowers, so how can we quantify its specialisation? While reasonable, it was undocumented behaviour. Thanks to Ana María Martín Gonzáles for drawing our attention to it!</p>
</dd> 
<dt>Speed improvement in <code><a href="#topic+shuffle.web">shuffle.web</a></code>:</dt><dd><p>Thanks to Paul Rabie, a faster implementation of the <code>shuffle.web</code> null model is available. Choosing the option <span class="option">legacy=FALSE</span> will deliver the null models about 3 times faster.</p>
</dd>
</dl>

</li>
<li><p> 1.15 (release date: 05-Mar-2011)
</p>

<dl>
<dt>Bug fix in <code><a href="#topic+swap.web">swap.web</a></code>:</dt><dd><p>Occasionally, an interaction too many was swapped, leading to a connectance slightly too low compared to the original matrix. Spotted and reported by Sven Hanoteaux. (For &ldquo;normal&rdquo; webs, this bug has luckily caused only very small discrepancies between the realised and the intended null web. We thus regard this error to be (luckily) of virtually no influence on the results reported in our Open Ecology Journal paper. Please also note that the help of <code>swap.web</code> recommends using <code><a href="#topic+vaznull">vaznull</a></code>.)</p>
</dd>
<dt>Bug fix in <code><a href="#topic+shuffle.web">shuffle.web</a></code>:</dt><dd><p>Some interactions were lost when there were more rows than columns. Spotted and reported by Sven Hanoteaux. (Please note that while a shameful mistake, it luckily does not affect the results reported in our Open Ecology Journal paper, where all webs analysed were asymmetric &ldquo;in the right way&rdquo;.)</p>
</dd>
<dt>Minor bug fix in <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>No output was provided when only index &ldquo;Fisher alpha&rdquo; or &ldquo;mean interaction diversity&rdquo; was selected. Thanks to Sven Hanoteaux for reporting and fixing!</p>
</dd>
</dl>
	
</li>
<li><p> 1.14 (release date: 21-Dez-2010)
</p>

<dl>
<dt>New function <code><a href="#topic+plotPAC">plotPAC</a></code>:</dt><dd><p>A plotting function to go with the <code><a href="#topic+PAC">PAC</a></code>-function, providing a nice circularly arranged bubble plot, which has been copied (in style) from Morris et al. (2005). Various colour options are available.</p>
</dd>
<dt>New index &ldquo;weighted NODF&rdquo; included in <code><a href="#topic+networklevel">networklevel</a></code> and <code><a href="#topic+nested">nested</a></code>:</dt><dd><p>Gustavo Carvallo has updated the existing function <code>nestednodf</code> in <span class="pkg">vegan</span> to compute a weighted (quantitative) version as proposed by Ulrich &amp; Almeida Neto (2011 Env. Mod. Soft). This is now linked into <span class="pkg">bipartite</span>. </p>
</dd>

<dt>New data set:</dt><dd><p>bezerra2009 is a&ldquo;full&rdquo; flower-visitation network of oil-collecting bees in Brazil. See help for details.</p>
</dd>
<dt>Minor bug fix in <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>The newly (1.13) added functionality for index &ldquo;weighted closeness&rdquo; did not work for webs without column and row names (such as null models). Also &ldquo;weighted betweenness&rdquo; was occasionally playing up.</p>
</dd>
<dt>Minor bug fix in <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>Betweenness and friends cannot be computed for fully compartmented webs (i.e. where each species interacts only with its own partner in the other trophic level). The function then failed instead of returning NA. Thanks to Nadine Sandau for reporting.</p>
</dd>
<dt>Minor bug fix in <code><a href="#topic+dfun">dfun</a></code>:</dt><dd><p>When providing independent abundances, the computation of dmin was sometimes incorrect (particularly for small webs) due to a typo. Fixed by Jochen Fründ.</p>
</dd>
<dt>Minor time-saving improvement in <code><a href="#topic+degreedistr">degreedistr</a></code>:</dt><dd><p>When provided with 3 or less point to compute the degree-distribution fit from now immediately returns NA-filled matrices. Saves the time of going through all starting values and still failing.</p>
</dd>
<dt>Change of name of function argument in <code><a href="#topic+web2edges">web2edges</a></code>:</dt><dd><p>The former <span class="option">quantitative</span> did not really reflect what it does, so it was changed to <span class="option">weight.column</span>.</p>
</dd>
<dt>Minor improvements to <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>Robustness and weighted nestedness were wrapped in <code>try</code>-functions (for very small networks). </p>
</dd>
<dt>New functionality to find modules in networks.</dt><dd><p>This is still experimental and proper references etc. will be added after testing! Please do not use for production yet (at least not without consultation). Thanks to Rouven Strauß for developing this.</p>
</dd> 
</dl>

</li>
<li><p> 1.13 (release date: 29-Sep-2010)
</p>

<dl>
<dt>Option added to <code><a href="#topic+H2fun">H2fun</a></code></dt><dd><p>to compute H2' for non-integer web. Thanks to Jochen Fründ for providing the inspiration and the code. This option is also now available in <code><a href="#topic+networklevel">networklevel</a></code>.</p>
</dd>
<dt>Changes to <code><a href="#topic+nullmodel">nullmodel</a></code>:</dt><dd><p>Upon using the modification entered in version 1.12, it turns out this is no improvement but rather a step in the wrong direction. So this function is back to its pre-1.12 working with a little bug fixed in swap.web (the helper function &lsquo;upswap&rsquo; got an option too many) that caused the alteration in the 1.12 version. Thanks to Jochen Fründ for insisting on rolling this back.</p>
</dd>
<dt>Bug fix in <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>Alatalo interaction evenness could not be called separately due to a change of name within the function. Thanks to Rachel Gibson for reporting!</p>
</dd>
<dt>New index added to <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>In addition to the binary cluster coefficient, the function now also (and automatically) computes the weighted clustering coefficient introduced by Tore Opsahl in his package <span class="pkg">tnet</span>.</p>
</dd>
<dt>New function <code><a href="#topic+web2edges">web2edges</a></code>:</dt><dd><p>Transforms a web-matrix into an edge list, as used in <span class="pkg">tnet</span> or other software (e.g. Pajek).</p>
</dd>
</dl>

</li>
<li><p> 1.12 (release date: 21-May-2010)
</p>
   
<dl>
<dt>Bug fix in <code><a href="#topic+vaznull">vaznull</a></code>:</dt><dd><p>In very poorly sampled networks, <code><a href="#topic+vaznull">vaznull</a></code> could fail because after the initial filling there were no more interactions to distribute. How an if-statement can sometimes make a difference.</p>
</dd>
<dt>Error message in <code><a href="#topic+nullmodel">nullmodel</a></code> changed to a warning.</dt><dd><p>Up to this release, the function created null models as specified. However, when a supposedly quantitative network was in fact binary, it returned an error. Now it proceeds, using the null model generating algorithm &ldquo;mgen&rdquo;, and returns a warning.</p>
</dd>
</dl>
	
</li>
<li><p> 1.11 (release date: 10-May-2010)
</p>
   
<dl>
<dt>Changes to function <code><a href="#topic+as.one.mode">as.one.mode</a></code>:</dt><dd><p>Gains options to do projections of the bipartite (=two-mode) into the one-mode modus required e.g. by <span class="pkg">sna</span>. In most publications, one focusses on only one trophic level (e.g. the pollinators) and represents the bipartite network as a one-mode, pollinators-only network. This can now be achieved using the various options in the function. See its help for details.</p>
</dd>
<dt>Bug fixes in <code><a href="#topic+BC">BC</a></code> and <code><a href="#topic+CC">CC</a></code>:</dt><dd><p>Upon re-reading the paper motivating the inclusion of these functions, I noticed an error in the previous implementation. The key point, and one that is contentious in network theory, is that there is no standard best way to project a two-mode (bipartite) network onto a one-mode network. Up until know, I used the default of <code><a href="#topic+as.one.mode">as.one.mode</a></code>. However, Martín Gonzáles et al. (2010) use the more common projection (&ldquo;higher&rdquo; and &ldquo;lower&rdquo;, respectively), and this is also now implemented in <code><a href="#topic+BC">BC</a></code> and <code><a href="#topic+CC">CC</a></code>. The interested reader may want to follow this problem up by reading the pre-print of Tore Opsahl (&ldquo;Triadic closure in two-mode networks&rdquo;) to see that this one-mode projection actually distorts the statistics employed on them.</p>
</dd>
</dl>

</li>
<li><p> 1.10 (release date: 02-May-2010)
</p>

<dl>
<dt>New function <code><a href="#topic+null.distr">null.distr</a></code>:</dt><dd><p>Fits a lognormal or negative binomial distribution to the marginal totals of a network and then draws random values from the thus specified distribution. These values represent the marginal totals to be used for constructing a null model network. The function thus serves as a way to produce null models without maintaining exactly the marginal totals, but only their distribution. Please refer to the help for some cautionary remarks on its use! In particular, null model networks are likely to be smaller than the original and there is obviously no guarantee that the marginal totals are actually distributed in the specified way!</p>
</dd>
<dt>Polishing the Vázquez pollination networks:</dt><dd><p>All species in these 8 networks are now consistently named (rather than numbered).</p>
</dd>
<dt>Polish to <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>Requesting Fisher's alpha sometimes causes convergence problems in the underlying function. This is now caught by a try, returning NA.</p>
</dd>
<dt>Rescale in <code><a href="#topic+nested">nested</a></code> gave wrong scaling for NODF:</dt><dd><p>Fixed.</p>
</dd>
</dl>

</li>
<li><p> 1.09 (release date: 22-Mar-2010)
</p>

<dl>
<dt>Bug fix in <code><a href="#topic+degreedistr">degreedistr</a></code>:</dt><dd><p>Degree distributions for the higher trophic level were calculated incorrectly. The main problem was that the scaling constant was omitted, leading to ridiculous fits. (Thanks to Roberto Molowny for reporting, correction proposal and discussion!) On improving this, I also ventured to provide multiple starting values and hence the function returns a fit for all three curves more often (but not always).</p>
</dd>
</dl>

</li>
<li><p> 1.08 (release date: 16-Mar-2010)
</p>

<dl>
<dt>Bug fix in <code><a href="#topic+ND">ND</a></code>:</dt><dd><p>Rows and columns were mixed up and a +1 was missing- oh dear. (Thanks to Marco Mello for reporting!)</p>
</dd>
</dl>

</li>
<li><p> 1.07 (release date: 18-Feb-2010)
</p>

<dl>
<dt>New function <code><a href="#topic+vaznull">vaznull</a></code>:</dt><dd><p>Null model with constrained totals and connectance proposed by Diego Vázquez, similar to <code><a href="#topic+swap.web">swap.web</a></code>, but &ldquo;better&rdquo;. See notes in <code><a href="#topic+swap.web">swap.web</a></code>-help for justification of this statement. We recommend this null model for constraining both marginal totals and connectance.</p>
</dd>
<dt>Added a new option to calculate extinction slopes:</dt><dd><p>So far, random extinction sequences and the rarest-to-commenest sequence were implemented. Now, <code><a href="#topic+second.extinct">second.extinct</a></code> also includes the option <span class="option">method="degree"</span> to build a sequence from the best-to-least connected species. This is the most extreme case, where the most generalist species goes extinct first (see Memmott et al. 1998). (In response to request by Simone Bazarian.)</p>
</dd>
<dt>Adaptations of <code><a href="#topic+nullmodel">nullmodel</a></code>:</dt><dd><p>Now includes the new vaznull as a method (3). This leads to changes in the sequence of methods! Old code 
may hence have to be adapted accordingly!</p>
</dd>
</dl>

</li>
<li><p> 1.06 (release date: 18-Dec-2009)
</p>

<dl>
<dt>New functions <code><a href="#topic+ND">ND</a></code>, <code><a href="#topic+BC">BC</a></code> and <code><a href="#topic+CC">CC</a></code>:</dt><dd><p>Simple functions to calculate normalised degree, betweenness centrality and closeness centrality. These functions and the example allows a reproduction of the type of analysis carried out in Martín González et al. (2009).</p>
</dd>
<dt>Changes to <code><a href="#topic+specieslevel">specieslevel</a></code></dt><dd><p>, which now calls <code><a href="#topic+ND">ND</a></code>, <code><a href="#topic+BC">BC</a></code> and <code><a href="#topic+CC">CC</a></code>, too.</p>
</dd>
<dt>Bug fix in <code><a href="#topic+as.one.mode">as.one.mode</a></code>:</dt><dd><p>now allows also data.frames to be turned into one-mode-style representations. Previously, only matrices could be used.</p>
</dd>
<dt>Suppression of errors and warnings in <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>When used on a full network (i.e. one without zeros), some indices in <code><a href="#topic+networklevel">networklevel</a></code> are undefined (e.g. extinction slopes). This led to a long output of warning and error messages, although internally I used the try-function to capture errors. Now, these messages are suppressed.</p>
</dd>
</dl>

</li>
<li><p> 1.05 (release date: 05-Dec-2009)
</p>

<dl>
<dt>Help description for <code><a href="#topic+PAC">PAC</a></code> was convoluted</dt><dd><p> and its suggestions for the interpretation downright wrong. Thanks to Matthew Wainhouse for reporting and simplifying it!</p>
</dd>
<dt>Resolved a long-standing issue of a warning message.</dt><dd><p>This occurred when detaching the package (<code>detach(package:bipartite)</code>) and was caused by somehow wrongly using <code>.Last.lib</code>. Deleting it solved the problem.</p>
</dd>
<dt>Fixed bug in <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>Calling this function with only one index caused it to return empty lists. Simple mistake, but better without it.</p>
</dd>		
</dl>

</li>
<li><p> 1.03 (release date: 06-Nov-2009)
</p>

<dl>
<dt>Bug fix in <code><a href="#topic+V.ratio">V.ratio</a></code>:</dt><dd><p>A small mistake for a human, but a huge bug for mankind. Sorry. (Detail: I forgot to square sigma.i, leading to strange results.) Thanks to Giorgio Mancinelli for reporting!</p>
</dd>
<dt>Error message for non-existent indices in <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>So far, <code><a href="#topic+networklevel">networklevel</a></code> returned <code>NULL</code> when an index was selected that does not exist (e.g. <code>"shannon diversity"</code> instead of <code>"diversity"</code>). Now, a helpful (?) error message is returned.</p>
</dd>
<dt>Change in defaults to index <code>"interaction evenness"</code> in <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>After a fruitful discussion with Becky Morris and Jason Tylianakis, I changed the default to <code>"sum"</code>. I also reproduce some of our communication in the help to this function, under details, to make the ecological assumptions behind either option a bit more transparent. There are good reasons for either option.</p>
</dd>
</dl>

</li>
<li><p> 1.02 (release date: 11-Sep-2009)
</p>

<dl>
<dt>Function <code><a href="#topic+plotweb">plotweb</a></code>:</dt><dd><p>Now more trophic networks can be plotted by staggering bipartite networks on top of each other. See multitrophic examples in <code><a href="#topic+plotweb">plotweb</a></code>.</p>
</dd> 
<dt>Minor corrections to <code><a href="#topic+dfun">dfun</a></code>:</dt><dd><p>This function did not return <em>exactly</em> the values of the website-version. Jochen Fründ corrected this. Please read the help of the function (final paragraph) for details.</p>
</dd>
<dt>New function <code><a href="#topic+nested">nested</a></code>:</dt><dd><p>This convenience function collects the various ways to calculate nestedness of a network in order to facilitate comparison of nestedness analyses. To do so, it heavily borrows from <span class="pkg">vegan</span>.</p>
</dd>
<dt>Bug fix to <code><a href="#topic+discrepancy">discrepancy</a></code>:</dt><dd><p>Would return a silly value (half of the number of rows) for empty matrices. This had no effect when called by <code><a href="#topic+networklevel">networklevel</a></code>, since the matrix would have been emptied. Thanks to Roberto Molowny for reporting!</p>
</dd>
<dt>Bug fix to <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>Due to a missing space, the option <span class="option">ALLBUTDD</span> did not work properly. Thanks to Etienne Laliberte for reporting!</p>
</dd>
</dl>

</li>
<li><p> 1.00 (release date: 06-Aug-2009)
</p>

<dl>
<dt>Complete overhaul of <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>After a workshop on bipartite networks in ecology, a few more indices were added (Fisher's alpha diversity of interactions, mean interaction diversity, mean number of predators) and the whole output reorganised. It now follows a gradient from less to more interesting (in our view) indices, and from indices for binary to those for quantitative networks. Also, I added several options for which indices to report (<span class="option">index="info", "binary", "quantitative", "topology"</span>). Most interestingly, perhaps, there is now a quantitative, Shannon-based series of indices. Starting with the &ldquo;mean interaction diversity&rdquo; (i.e. the Shannon-diversity of interactions of a species, averaged across all species in that trophic level), over &ldquo;Shannon diversity&rdquo; of interactions, to H2 (i.e. Shannon diversity scaled between max and min possible for this web characteristics).</p>
</dd>
<dt>Additions to, and overhaul of <code><a href="#topic+specieslevel">specieslevel</a></code>:</dt><dd><p>Similar to the above item, some indices were added, and the output simplified when calling the option <span class="option">index="ALLBUTD"</span> (only one D here!): a list with two matrices is now returned. Fisher's alpha for each species, vulnerability/generality and effective number of species for each target species are also now included. Index sequence has changed.</p>
</dd>
<dt>New function <code><a href="#topic+PAC">PAC</a></code>:</dt><dd><p>Calculates the Potential for Apparent Competition following the formula in Müller et al. (1999) and Morris et al. (2005) and the suggestion by Becky Morris and Owen Lewis. More than a theoretical concept, it was experimentally shown to be relevant (Morris et al. 2004).</p>
</dd>
<dt>Bug fix in <code><a href="#topic+H2fun">H2fun</a></code> and <code><a href="#topic+dfun">dfun</a></code>:</dt><dd><p>A line of code went missing at some point, so the maximum packing density was not optimal (but still good) in these functions. As a result, reported H2- and d-values were sometimes 0 when they should be only very close to 0.</p>
</dd>
<dt>Switch for error reporting in <code><a href="#topic+degreedistr">degreedistr</a></code>:</dt><dd><p>By default now suppresses error reporting when <code>nls</code> fails to fit a degree distribution due to too few data points. This leaves the user of <code><a href="#topic+networklevel">networklevel</a></code> somewhat less confused. Warning message now also indicates for which trophic level there were too few data points.</p>
</dd>
<dt>Bug fix in <code><a href="#topic+C.score">C.score</a></code>:</dt><dd><p>Failed when the web was very dense or very sparse, because the maximum number of checkerboard patterns was 0 then.</p>
</dd>
</dl>

</li>
<li><p> 0.94 (release date: 01-Aug-2009)
</p>

<dl>
<dt>New function <code><a href="#topic+nullmodel">nullmodel</a></code>:</dt><dd><p>A convenience wrapper function to generate different types of null models.</p>
</dd>
<dt>Small changes to <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>This function returns a list of indices. If we exclude the computation of degree distribution fits, this would be coerced to a vector. We added the option <span class="option">index="ALLBUTDD"</span> to calculate all indices BUT degree distributions. The output is then returned as vector. This is much more convenient when using networklevel on many data sets (using <code>sapply</code>).</p>
</dd>
</dl>

</li>
<li><p> 0.93 (release date: 30-Jun-2009)
</p>

<dl>
<dt>bug fix in <code><a href="#topic+slope.bipartite">slope.bipartite</a></code> and <code><a href="#topic+robustness">robustness</a></code>:</dt><dd><p>The function always selected column 3 of the object, instead of 2 for lower and 3 for higher trophic level; thanks to Antonio Rivera for spotting and reporting this error! Notice that this error must have slipped in somewhere around version 0.90/0.91, because I checked and the results reported in the Open Ecology Journal paper are valid! I seem to remember that I (CFD) modified <code><a href="#topic+slope.bipartite">slope.bipartite</a></code> when <code><a href="#topic+robustness">robustness</a></code> was added: never change a wining team!</p>
</dd>
</dl>

</li>
<li><p> 0.92 (release date: 02-Jun-2009)
</p>

<dl>
<dt>more colour options in <code><a href="#topic+visweb">visweb</a></code>:</dt><dd><p>the arguments <span class="option">box.border</span> and <span class="option">box.col</span> now allow a specification of the colour of the boxes and their borders.</p>
</dd>
<dt>bug fix <code><a href="#topic+empty">empty</a></code>:</dt><dd><p>the function returned 0 for a 1x1 matrix. Although not written for such a case, it should still do what it says on the 
tin. Thanks to Mariano Devoto for spotting and reporting!</p>
</dd>
<dt>bug fix <code><a href="#topic+wine">wine</a></code>:</dt><dd><p>returned NA for square matrices.</p>
</dd>
<dt>bug fix <code><a href="#topic+plot.wine">plot.wine</a></code>:</dt><dd><p>gave decimal places for row and column names for very small networks.</p>
</dd>
</dl>

</li>
<li><p> 0.91 (release date: 06-May-2009)
</p>

<dl>
<dt>new function <code><a href="#topic+wine">wine</a></code>:</dt><dd><p>This function replaces the (now deprecated) function <code>nestedness.corso</code> in calculating a (weighted) nestedness for bipartite networks. It was developed and implemented by Marcelino de la Cruz, Juan M. Pastor, Javier Galeano and Jose Iriondo. It is also called by <code><a href="#topic+networklevel">networklevel</a></code>. A plotting function is also available, depicting the contributions of each observed link to the web's nestedness. - <code>nestedness.corso</code> is now removed from the package. The main reason is that it served as an interim solution for <code><a href="#topic+wine">wine</a></code>, and the Corso-way of calculating nestedness is just one more of already too many. If you intend to use <code><a href="#topic+wine">wine</a></code> on binary data and interpret that as a Corso-equivalent, beware of the following two main differences (thanks to Jose Iriondo for summarising them): <em>First, the nestedness of Corso et al. varies between 0 and 1, with the highest nestedness is reached at 0 and 1 corresponds to random, whereas in <code><a href="#topic+wine">wine</a></code> is just the opposite (this is because the Manhattan distances are calculated with regard to opposite sides of the matrix). Secondly, the &lsquo;d&rsquo; in the nestedness of Corso is the sums of the &lsquo;dij&rsquo;s whereas in <code><a href="#topic+wine">wine</a></code>, the &lsquo;d&rsquo; (= &lsquo;win&rsquo; value of the object produced by <code><a href="#topic+wine">wine</a></code>) is the average of the &lsquo;dij&rsquo;s above 0.</em> So, we recommend NOT to use wine for calculating Corso's nestedness, but rather download the source code for <code>nestedness.corso</code> from an older version of <span class="pkg">bipartite</span>.</p>
</dd>
<dt>new function <code><a href="#topic+robustness">robustness</a></code>:</dt><dd><p>A better way to quantify the effect of species loss on the extinctions in the other trophic level; kindly provided by Mariano Devoto. This index is also part of <code><a href="#topic+networklevel">networklevel</a></code>.</p>
</dd>
<dt>new data set <code>ollerton2003</code>:</dt><dd><p>Another quantitative pollination network from the NCEAS database (see <code><a href="#topic+ollerton2003">ollerton2003</a></code>).</p>
</dd>
</dl>

</li>
<li><p> 0.90 (release date: 24-Mar-2009)
</p>

<dl>
<dt>example <code>vazquez.example</code>:</dt><dd><p>We added several new functionalities mainly to be able to analysis data and use network statistics as suggested by 
Vázquez et al. 2009. You can access this example by typing <code>?vazquez.example</code>.</p>
</dd>
<dt>new feature in <code><a href="#topic+visweb">visweb</a></code>:</dt><dd><p>Can now plot different sized circles to represent interactions, as proposed by Vázquez et al. (2009).</p>
</dd>
<dt>new feature in <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>We added an option to calculate interaction evenness either based on all possible links or just on realized links.</p>
</dd>
<dt>new function <code><a href="#topic+sortweb">sortweb</a></code>:</dt><dd><p>Can be used to sort webs in different ways.</p>
</dd>
<dt>data set <code>inouye1988</code>:</dt><dd><p>Another pollination network from the NCEAS database (see <code><a href="#topic+inouye1988">inouye1988</a></code>).</p>
</dd>
<dt>Function <code><a href="#topic+compart">compart</a></code>:</dt><dd><p>We replaced the CA-based approach to detecting compartments by a comprehensive and recursive approach. The latter is not affected by ties in the data set (i.e. species with the same number of links). In quantitative webs and for the networks included in bipartite, the old function was working fine, but in more recent trials it failed to detect 2-species compartments. In turn, we had to adapt <code><a href="#topic+networklevel">networklevel</a></code> and <code><a href="#topic+plotweb">plotweb</a></code>.</p>
</dd>
</dl>

</li>
<li><p> 0.85 (release date: 10-Mar-2009)
</p>

<dl>
<dt>Function <code><a href="#topic+plotweb">plotweb</a></code></dt><dd><p>New feature: text labels can now be printed in different colours. All colours can be passed as vectors and vectors are recycled if not of appropriate length </p>
</dd>
</dl>

</li>
<li><p> 0.84 (release date: 25-Feb-2009)
</p>

<dl>
<dt>Function <code><a href="#topic+plotweb">plotweb</a></code></dt><dd><p>New feature: arrow=&ldquo;center.up&rdquo;, arrow=&ldquo;center.down&rdquo;, arrow=&ldquo;center.both&rdquo;: this results in the standard presentation of bipartite networks, where interactions are displayed as centered triangles. </p>
</dd>
</dl>

</li>
<li><p> 0.83 (release date: 9-Feb-2009)
pdf of OEJ-paper added as vignette
</p>
</li>
<li><p> 0.82 (release date: 27-Jan-2009)
</p>

<dl>
<dt>Function <code><a href="#topic+plotweb">plotweb</a></code></dt><dd><p>Two new features: 1. colors of borders of boxes and interactions can be specified via setting bor.col. 2. 
Labels can now be rotated by specifying text.rot=90.</p>
</dd>
</dl>

</li>
<li><p> 0.81 (release date: 06-Jan-2009)
</p>

<dl>
<dt>Function <code><a href="#topic+nodespec">nodespec</a></code> replaces the now obsolete function <code>functspec</code>.</dt><dd><p>The inventor of functional specialisation, 
Bo Dalsgaard, understands the term &lsquo;functional specialisation&rsquo; to be restricted to the way in which plants are specialised to pollinators. Although I disagree (and think that &lsquo;functional&rsquo; actually means very little until defined for a given problem), I renamed the &lsquo;functional specialisation index&rsquo; into &lsquo;node specialisation index&rsquo;. This is not a particularly clever name, but at least it indicates that the position of nodes in a network is important when it is calculated.</p>
</dd>
<dt>Bug in <code><a href="#topic+networklevel">networklevel</a></code>:</dt><dd><p>Call to <code>nestedness.corso</code> overwrote results of <code><a href="#topic+nestedness">nestedness</a></code>.</p>
</dd>
<dt>Various changes related to the analysis of very small webs.</dt><dd><p>Very small webs should probably not be used at all for testing theories! 
Indices are usually VERY sensitive to the exact number of species, number of observations etc. Still, sometimes we simply want to calculate some index, and then <span class="pkg">bipartite</span> should handle such small networks, too. So, when going through several dozens of very small webs (sometimes only containing one species in one of the two trophic levels), several functions did not perform correctly (usually to such minor programming issues such as matrices being converted to vectors when <code>[</code> was used with <span class="option">drop=TRUE</span>, i.e. the default). Changes affected the functions <code>discrepancy</code>, <code>nestedness.corso</code>, <code>shuffle.web</code>, <code>compart</code> and <code>empty</code>. Their output remains identical, only they now also work for small webs.</p>
</dd>
<dt>Changes to <code>nestedness.corso</code> with <span class="option">weighted=TRUE</span></dt><dd><p>Galeano et al. do not describe how to deal with ties, nor do they make clear if the packed matrix should be sorted by marginal sum of links or marginal sum of interactions! Previously, we used marginal sum of interactions (because it is a weighted index), but now we moved to marginal sum of links, because that is how I interpret their paper after a third (or forth) re-reading. Furthermore, because the real maximum chaos cannot be derived (to my knowledge) algorithmically, we use the 95% quantile of 500 randomisations as maximum. This will lead to a consistently overestimated nestedness, but it is less sensitive to the number of replicates than the max. (Also, there was an error in the description of the value returned: 0 is nested, 1 is chaos!)</p>
</dd>
</dl>

</li>
<li><p> 0.8 (release date: 21-Dec-2008)
</p>

<dl>
<dt>bug fix in <code><a href="#topic+shuffle.web">shuffle.web</a></code></dt><dd><p>Function didn't work correctly when the web contained more rows than columns. (Thanks to Anna Traveset for spotting and reporting!)</p>
</dd>
<dt>minor modifications in networklevel</dt><dd><p>Sometimes additional information is available and species can be included in a network, although they have no interactions with other species. In this case, one might want to use these species in the network, too. A new option (empty.web), allows to keep empty rows and columns, although for some functions an emptied web must be used (e.g. degree distributions).</p>
</dd>
<dt>bug fix in <code><a href="#topic+H2fun">H2fun</a></code></dt><dd><p>As in the last <code><a href="#topic+H2fun">H2fun</a></code> bug fix, sometimes H2 became negative.</p>
</dd>
<dt>bug (?) fix in <code><a href="#topic+networklevel">networklevel</a></code></dt><dd><p>Shannon diversity is based on the log of interactions. If this value is 0, as it is for most network entries, an NA is produced. As a consequence, Shannon's H (now also given in output) is based not on all interactions, but only those &gt; 0. In consequence, Shannon evenness should also only be SH divided by the number of realised interactions (<code>log(sum(web&gt;0))</code>). That is now the case.</p>
</dd>
</dl>

</li>
<li><p> 0.74 (release date: 24-Oct-2008)
</p>

<dl>
<dt>functional specialisation (<code>functspec</code>) bug fix</dt><dd><p>Paths were double the true length, hence minimum was 2, rather than 1.</p>
</dd>
<dt><code><a href="#topic+H2fun">H2fun</a></code> bug fix</dt><dd><p>Since the search for H2min is heuristic, H2uncorr can sometimes be lower than H2min; in that case, H2fun returned a value greater 1, while it should be one exactly.</p>
</dd>
<dt>new function <code>nestedness.corso</code> </dt><dd><p>Calculates (weighted) nestedness according to Corso et al. (2008) and Galeano et al. (2008).</p>
</dd>
<dt>new function <code><a href="#topic+discrepancy">discrepancy</a></code></dt><dd><p>Calculates discrepancy according to Brualdi &amp; Sanderson (1999), deemed to be best ever measure of nestedness; also gives an example for a binary null model analysis based on <span class="pkg">vegan</span>'s <code>commsimulator</code>.</p>
</dd>
<dt>other</dt><dd><p>Correction of several minor typos on the help pages; removal of &quot;~&quot; in help files; same citation style throughout; new cross references (especially for the nestedness functions); in <code><a href="#topic+networklevel">networklevel</a></code>, nestedness is now calculated using <span class="pkg">vegan</span>'s <code>nestedtemp</code> due to matrix inversion problems reported for binmatnest.</p>
</dd>
</dl>

</li>
<li><p> 0.73 (release date: 1-Sept-2008)
</p>
	
<dl>
<dt>new feature <code><a href="#topic+plotweb">plotweb</a></code>:</dt><dd><p>Named abundance-vector for each level can be used.</p>
</dd>
<dt>new function <code><a href="#topic+plotweb2">plotweb2</a>:</code> (not debugged!)</dt><dd><p>For plotting tripartite networks.</p>
</dd>
</dl>

</li>
<li><p> 0.72 (release date: 12-June-2008)
</p>

<dl>
<dt>new function: functional specialisation with <code>functspec</code></dt><dd><p>See Dalgaard et al. (2008).</p>
</dd>
<dt>new function: interface to <span class="pkg">sna</span> through <code><a href="#topic+as.one.mode">as.one.mode</a></code></dt><dd><p>Allows calculation of path lengths, centrality, betweenness and other indices developed for one-mode networks.</p>
</dd>
<dt>bug-fix</dt><dd><p>Error in <code><a href="#topic+plotweb">plotweb</a></code> when no species labels were given.</p>
</dd>
</dl>

</li></ul>
 


<h3>Note</h3>

<p>This function is only invoked for its side effect of opening the help page. I simply didn't know how to do it any other way ...</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann &lt;carsten.dormann@biom.uni-freiburg.de&gt; </p>

<hr>
<h2 id='visweb'> Plotting function to visualize a bipartite food web </h2><span id='topic+visweb'></span>

<h3>Description</h3>

<p> This function draws a food web as a grid using a matrix. Colnames and rownames are used as labels and entries in the matrix are visualized by text and colours. It can also be used to plot bipartite webs in the style of Vázquez et al. (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visweb(web, type="nested",  prednames=TRUE, preynames=TRUE, labsize=1,
  plotsize=12, square="interaction", text="no", frame=NULL, textsize=1,
  textcol="red", pred.lablength=NULL, prey.lablength=NULL, clear=TRUE,
  xlabel="", ylabel="", boxes=TRUE, circles=FALSE, circle.col="black",
  circle.min=0.2, circle.max=2, outerbox.border="white", 
  outerbox.col="white", box.border="black", box.col="black", def.col="blue", 
  max.digits=4, NA.col="red")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="visweb_+3A_web">web</code></td>
<td>
<p> A matrix representing the interactions observed between higher trophic level species (columns) and lower trophic level species (rows). Usually this will be number of pollinators on each species of plants or number of parasitoids on each species of prey. </p>
</td></tr>
<tr><td><code id="visweb_+3A_type">type</code></td>
<td>
<p> type changes the sorting of rows and coloumns of the web and can be<br />
<b>nested  </b>: (sorted by row/colSums)<br />
<b>diagonal</b>: (highest number of interactions appear along the diagonal, good for showing compartments)<br />
<b>none    </b>: (as is)<br />
</p>
</td></tr>
<tr><td><code id="visweb_+3A_prednames">prednames</code></td>
<td>
<p> labels can be switched of by prednames=F</p>
</td></tr>
<tr><td><code id="visweb_+3A_preynames">preynames</code></td>
<td>
<p> labels can be switched of by preynames=F</p>
</td></tr>
<tr><td><code id="visweb_+3A_labsize">labsize</code></td>
<td>
<p> factor for size of labels </p>
</td></tr>
<tr><td><code id="visweb_+3A_plotsize">plotsize</code></td>
<td>
<p>  size of plot (length of width or height), depending on the dimension of the web in cm,  default is 12 cm.</p>
</td></tr>
<tr><td><code id="visweb_+3A_square">square</code></td>
<td>
<p> square is used to indicate number of interactions  and belonging to compartments by coloured grid cells<br />
<b>interaction</b>: (level of grey indicates the number of intercation, white means no interaction)<br />
<b>compartment</b>: (level of grey indicates belonging to the same compartment)<br />
<b>black      </b>: (black grid cells if number of interaction is bigger than one)<br />
<b>none       </b>: (no coloured squares are drawn)<br />
</p>
</td></tr>
<tr><td><code id="visweb_+3A_text">text</code></td>
<td>
<p> number of interactions or belonging are plotted into each grid cell<br /> 
<b>interaction</b>: (number of interactions are drawn)<br />
<b>compartment</b>: (belonging to same compartment indicated by capitel Letters)<br />
<b>none       </b>: (no text is shown)<br />
</p>
</td></tr>
<tr><td><code id="visweb_+3A_frame">frame</code></td>
<td>
<p> a frame is drawn around each compartment (frame=TRUE), best used with type=&ldquo;diagonal&rdquo;  </p>
</td></tr>
<tr><td><code id="visweb_+3A_textsize">textsize</code></td>
<td>
<p> factor for size of text in squares, default=1 </p>
</td></tr>
<tr><td><code id="visweb_+3A_textcol">textcol</code></td>
<td>
<p>  color of text in grid cells, default =&ldquo;red&rdquo;</p>
</td></tr>
<tr><td><code id="visweb_+3A_pred.lablength">pred.lablength</code></td>
<td>
<p>length of predators (upper) labels that should be displayed</p>
</td></tr>
<tr><td><code id="visweb_+3A_prey.lablength">prey.lablength</code></td>
<td>
<p>length of prey (lower) labels that should be displayed</p>
</td></tr>
<tr><td><code id="visweb_+3A_clear">clear</code></td>
<td>
<p> delete species with no interactions (compulsory done for &ldquo;nested&rdquo; and &ldquo;diagonal&rdquo;) </p>
</td></tr>
<tr><td><code id="visweb_+3A_xlabel">xlabel</code></td>
<td>
<p>label on the x-axis, make sure prey.lablength is set accordingly, default is empty</p>
</td></tr>
<tr><td><code id="visweb_+3A_ylabel">ylabel</code></td>
<td>
<p>label on the y-axis, make sure pred.lablength is set accordingly, default is empty</p>
</td></tr>
<tr><td><code id="visweb_+3A_boxes">boxes</code></td>
<td>
<p>logical, if boxes should be drawn. Default is set to TRUE</p>
</td></tr>
<tr><td><code id="visweb_+3A_circles">circles</code></td>
<td>
<p>logical, if circles in a Vazquez et al. style should be drawn. Default is set to FALSE, size and colours of circles and background can be set by the following arguments</p>
</td></tr>
<tr><td><code id="visweb_+3A_circle.col">circle.col</code></td>
<td>
<p>Colour of circles, works only if circles=TRUE</p>
</td></tr>
<tr><td><code id="visweb_+3A_circle.min">circle.min</code></td>
<td>
<p>minimal size of circles, use to rescale circles appropriately, default is 0.2</p>
</td></tr>
<tr><td><code id="visweb_+3A_circle.max">circle.max</code></td>
<td>
<p>maximal size of circle, , use to rescale circles appropriately, default is 2</p>
</td></tr>
<tr><td><code id="visweb_+3A_outerbox.border">outerbox.border</code></td>
<td>
<p>Colour of outerbox border if option circles=TRUE</p>
</td></tr>
<tr><td><code id="visweb_+3A_outerbox.col">outerbox.col</code></td>
<td>
<p>Colour of background if option circles=TRUE</p>
</td></tr>
<tr><td><code id="visweb_+3A_box.border">box.border</code></td>
<td>
<p>Colour of border of boxes, if option square=&ldquo;b&rdquo; is set</p>
</td></tr>
<tr><td><code id="visweb_+3A_box.col">box.col</code></td>
<td>
<p>Colour of boxes, if option square=&ldquo;b&rdquo; is set</p>
</td></tr>
<tr><td><code id="visweb_+3A_def.col">def.col</code></td>
<td>
<p>A user defined color vector for all ranks (starting from low to high) of occurring values in the network</p>
</td></tr>  
<tr><td><code id="visweb_+3A_max.digits">max.digits</code></td>
<td>
<p>defaults to 4.</p>
</td></tr>
<tr><td><code id="visweb_+3A_na.col">NA.col</code></td>
<td>
<p>Which colour should be used for missing data (NAs)? Defaults to red.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot window with appropriate size according to the dimensions of the web.
</p>


<h3>Note</h3>

<p>If labels don't fit, resize window by hand!</p>


<h3>Author(s)</h3>

<p> Bernd Gruber </p>


<h3>References</h3>

<p>Vázquez, P.D., Chacoff, N.,P. and  Cagnolo, L. (2009) Evaluating multiple determinants of the structure of plant-animal mutualistic networks. <em>Ecology</em></p>


<h3>See Also</h3>

<p> For a different plot on food web see <code><a href="#topic+plotweb">plotweb</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Safariland)
visweb(Safariland)
visweb(Safariland, type="diagonal", square="compartment", text="none", 
	frame=TRUE)
visweb(Safariland, type="nested", text="compartment")
visweb(Safariland, circles=TRUE,  boxes=FALSE,  labsize=1, circle.max=3, 
	text="no")
visweb(Safariland,square="b",box.col="green",box.border="red")

#define your colors here,length has to be the numbers of different entries
cols &lt;-0:(length(table(Safariland))-1) 
visweb(Safariland, square="defined", def.col=cols) 
</code></pre>

<hr>
<h2 id='web2edges'>Conversion of a network matrix into a (weighted) edge list</h2><span id='topic+web2edges'></span>

<h3>Description</h3>

<p>This helper function converts a bipartite matrix into an edge list, optionally weighted, as used by other packages and software, and writes this to the hard drive (optionally)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>web2edges(web, webName=NULL, weight.column=TRUE, both.directions=FALSE, 
	is.one.mode=FALSE, out.files=c("edges", "names", "groups")[1:2],
	return=TRUE, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="web2edges_+3A_web">web</code></td>
<td>
<p>A matrix with lower trophic level species as rows, higher trophic level species 
as columns and number of interactions as entries.</p>
</td></tr>
<tr><td><code id="web2edges_+3A_webname">webName</code></td>
<td>
<p>An optional name for the data file generated by the function.</p>
</td></tr>
<tr><td><code id="web2edges_+3A_weight.column">weight.column</code></td>
<td>
<p>Logical; is the web quantitative and should hence a weighted edge list be produced? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="web2edges_+3A_both.directions">both.directions</code></td>
<td>
<p>Logical; shall each link be represented twice, i.e. once from A to B and also from B to A? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="web2edges_+3A_is.one.mode">is.one.mode</code></td>
<td>
<p>Logical; if TRUE, labels for species will be used as they currently are in the web; otherwise, species will be re-labelled so that the first column will have number NROW(web) + 1. This is also the default.</p>
</td></tr>
<tr><td><code id="web2edges_+3A_out.files">out.files</code></td>
<td>
<p>String indicating which files to produce: &quot;edges&quot; writes an edge list, &quot;names&quot; writes a list with names belonging to the edges and &quot;groups&quot; writes a file assigning the species to higher and lower trophic levels. The default produces the edge list and the names file.</p>
</td></tr>
<tr><td><code id="web2edges_+3A_return">return</code></td>
<td>
<p>Logical; shall the edge list be returned by this function (for future use in R)? Defaults to TRUE. Setting <span class="option">return</span> to FALSE will cause writing of files to the hard drive!</p>
</td></tr>
<tr><td><code id="web2edges_+3A_verbose">verbose</code></td>
<td>
<p>Logical; shall some feedback tell you that the files have been generated? Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many network programs (e.g. Pajek) require input in the form of an edge list. Here each species is a number. The edge list has two column, one with the target and one with the origin of the connection. That means an interaction between 1 and 6 would be written (in one line) as:  <code>1  6</code>. In a weighted edge list, a third column represents the strength of the interaction: <code>1  6  4.77</code>.
</p>
<p>All this function does is to transform the typical interaction matrix used in bipartite into an edge list. Within R this could be used e.g. in the package <span class="pkg">tnet</span>; outside R by Pajek or others.
</p>
<p>Similar to <code><a href="#topic+as.one.mode">as.one.mode</a></code> this function is there to increase interchange between different coding standards and packages.
</p>


<h3>Value</h3>

<p>A matrix (&ldquo;edge list&rdquo;) with two (unweighted) or three (weighted) columns. 
</p>
<p>If return=FALSE, this matrix (and possibly names and groups) are written to a text-file in the working directory.
</p>


<h3>Note</h3>

 
<p>The function is used as export helper (default) or as link to <span class="pkg">tnet</span> (with return=TRUE).
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland)
web2edges(Safariland)
web2edges(as.one.mode(Safariland, project="lower"), is.one.mode=TRUE)
</code></pre>

<hr>
<h2 id='webs2array'>Puts two or more webs into one array of webs</h2><span id='topic+webs2array'></span>

<h3>Description</h3>

<p>Function to put several webs into an array, blowing the dimensions up to the union of species
</p>


<h3>Usage</h3>

<pre><code class='language-R'>webs2array(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="webs2array_+3A_x">x</code></td>
<td>
<p>either a matrix containing a web, or a list of webs.</p>
</td></tr>
<tr><td><code id="webs2array_+3A_...">...</code></td>
<td>
<p>further optional matrices provided, if x is not a list (see example). Note that this input will be ignored if x is a list!</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some analyses may require a direct comparison of two webs, e.g. computing their similarity in number of interactions per link (e.g. Poisot et al. 2012). To be able to do that, we first need to blow the single webs up to have the same dimensions, i.e. padding all species not observed in this web with 0s. This function produces a new raw matrix based on the union of species for each trophic level and puts these for all species into one array.
</p>
<p>If the function is used on a list of webs that has no names, new names will be created in the format &ldquo;web1&rdquo;, &ldquo;web2&rdquo;, etc. 
</p>


<h3>Value</h3>

<p>An array of dimensions (number of species in lower level, number of species in higher level, number of webs).</p>


<h3>Note</h3>

<p>When building the webs from a table of observed interactions, function <code><a href="#topic+frame2webs">frame2webs</a></code> allows to build a web-array when using <span class="option">type.out="array"</span>. That would be preferable (faster and only one step)!
</p>
<p>Combining webs into one array makes sense only for webs featuring overlapping communities! 
</p>


<h3>Author(s)</h3>

<p> Carsten F. Dormann <a href="mailto:carsten.dormann@biom.uni-freiburg.de">carsten.dormann@biom.uni-freiburg.de</a> and Jochen Fründ</p>


<h3>References</h3>

 
<p>Poisot, T., E. Canard, D. Mouillot, N. Mouquet, D. Gravel, and F. Jordan. 2012. The dissimilarity of species interaction networks. <em>Ecology Letters</em> <b>15</b>, 1353–-1361. doi: 10.1111/ele.12002
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland, vazquenc, vazquec)
allin1 &lt;- webs2array(Safariland, vazquenc, vazquec)
str(allin1)

# alternatively: provide a (named) list as input to web2array:
example &lt;- list(Safariland, vazquenc, vazquec)
str(webs2array(example)) # no names!

# named list as input:
example2 &lt;- list("Saf"=Safariland, "Vquenc"=vazquenc, "Vquec"=vazquec)
str(webs2array(example2)) # with names provided

# now we can compute distance between two webs:
vegdist(t(cbind(as.vector(allin1[,,1]), as.vector(allin1[,,2]), as.vector(allin1[,,3]))), 
  method="jacc")
  
</code></pre>

<hr>
<h2 id='wine'>
Weighted-Interaction Nestedness Estimator
</h2><span id='topic+wine'></span><span id='topic+plot.wine'></span>

<h3>Description</h3>

<p>Calculates the nestedness of a network taking into account the weight of the interactions, according to the method proposed by Galeano et al. (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wine(web, nreps = 1)
## S3 method for class 'wine'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wine_+3A_web">web</code></td>
<td>
<p>A matrix with elements of a set (e.g., plants) as rows, 
elements of a second set (e.g., pollinators) as columns and number 
of interactions as entries.</p>
</td></tr>
<tr><td><code id="wine_+3A_nreps">nreps</code></td>
<td>
<p>Number of replicates for constructing random networks.</p>
</td></tr>
<tr><td><code id="wine_+3A_x">x</code></td>
<td>
<p> An object resulting of applying wine function</p>
</td></tr>
<tr><td><code id="wine_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters to <code><a href="fields.html#topic+image.plot">image.plot</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nestedness estimators use presence-absence (binary) adjacency matrices as the basis for calculating nestedness, as they provide a simple description and characterization of the topology of the network. However, networks are specified not only by their topology but also by the heterogeneity in the weight (or the intensity) of the connections (Barrat et al., 2004). Characterizing links just with presence-absence data does not take into account the possible differences in intensity among links. WINE (Weighted-Interaction Nestedness Estimator) is a new nestedness estimator that takes into account the weight or intensity of each interaction (e.g., in a plant-pollinator network, the number of registered visits of a particular interaction). Thus, instead of using presence-absence matrices, WINE calculates nestedness from quantitative data matrices that include the number of events of each interaction.
</p>
<p>This was the first estimator that allows for the characterization of weighted nestedness. WINE calculates a nestedness value that approaches zero when the nestedness pattern of the original data matrix is close that of equivalent random matrices, and it approaches one as it gets closer to the nestedness of the maximal nestedness matrix. Thus, this estimator evaluates the relative position of the data matrix between the corresponding random matrices and the maximal nestedness matrix.
</p>
<p>Negatives values for this estimator can be found in some synthetic matrices that have been described as &lsquo;anti-nestedness&rsquo; matrices (Almeida-Neto et al. 2007).
</p>
<p>The calculation of the weighted-interaction nestedness estimator starts with the matrix containing the number of events of each interaction, Mij. The matrix is packed by arranging rows and columns from top to bottom and from left to right, respectively, in ascending order according to their marginal totals. Nestedness is related to the proximity of existing 
links to one another in the packed matrix, so that the most nested matrix is the one that after packing shows a minimum mixing of filled cells (links) with empty cells (no links) (Corso et al., 2008, Ulrich et al., 2009).
</p>
<p>WINE is based on the concept of estimating nestedness through the calculation of a Manhattan distance from each of the matrix cells containing a link to the cell corresponding to the intersection of the row and columns with the lowest marginal totals (number of links). This concept resembles in a way the one used by Corso et al. (2008), although the distances are measured to the opposite corner of the packed matrix. Additionally, in WINE, the Manhattan distance is replaced by a weighted Manhattan distance. The statistical significance of this nestedness index value is tested against a null model that constrains matrix fill to observed values, retains the distribution of number of events in the links but does not constrain marginal totals. 
</p>
<p>Further details can be found in Galeano et al. (2008).
</p>


<h3>Value</h3>

<p>wine returns an object of class <code>wine</code>, basically a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>win</code></td>
<td>
<p>Weighted-interaction nestedness of dataset (WIN)</p>
</td></tr>
<tr><td><code>wine</code></td>
<td>
<p>Weighted-interaction nestedness estimator (WINE): The weighted-interaction nestedness estimator value. It will be 0 for random distribution and 1 for maximal nestedness</p>
</td></tr>
<tr><td><code>zscore</code></td>
<td>
<p>z-score of the weighted-interaction nestedness</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>probability of having a z-value equal to or greater than Z (from the tabulated value of the cumulative function). Values of p&lt;0.05 indicate that the dataset is significantly nested.</p>
</td></tr>
<tr><td><code>dmax</code></td>
<td>
<p>Weighted-interaction nestedness of the maximal nestedness matrix.</p>
</td></tr>
<tr><td><code>drnd</code></td>
<td>
<p>Average weighted-interaction nestedness of random replicates</p>
</td></tr>
<tr><td><code>dij.w</code></td>
<td>
<p>Matrix of dijw values.  These values provide a measure of the contribution of each interaction (link) to total nestedness</p>
</td></tr>
<tr><td><code>dij.max</code></td>
<td>
<p>Maximal nestedness matrix</p>
</td></tr>
</table>
<p>The S3 plot method for wine displays dij.w in a coloured image plot where red cells have high weights in the network and blue cells have minimum weights.
</p>


<h3>Note</h3>

<p>This is the first approach to a weighted nestedness and a full ecological interpretation of  its meaning is still lacking. It is not possible to perform a systematic comparison between this and other nestedness indices because the latter rely just on presence absence data  whereas the former feeds on a quantitative data matrix. For a well-performed comparison of other nestedness indices see Ulrich &amp; Gotelli (2007). 
</p>
<p><code>wine</code> may return NaN for different parameters essentially for two different reasons: 
a) if <span class="option">nreps</span> is not specified, <code>wine</code> adopts <code>nreps=1</code> by default and NaN is
returned for z-score and p value. This is due to the fact that with <code>nreps=1</code> the variance of drnd is zero and z-score becomes infinite. The same outcome may occur in some cases with very low values of nreps. To ensure proper values of z-score and p-values <code>nreps=100</code> or higher is suggested.
b) if dw = drnd = dmax  <code>wine</code> equals 0/0, and if drnd = dmax <code>wine</code> tends to infinity. In both cases, NaN is returned by <code>wine</code>. This is more likely to occur in cases where the dimensions of the matrix are very low (e.g,  (<code>dim &lt; c(4,4)</code>) because in those cases the number of possible values of dw, drnd and dmax is also reduced.
</p>
<p>This is WINE version 3.2, available also in Matlab and C++ at the certificate-blocked site (https://hypatia.agricolas.upm.es/WINE/WINE.html).
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz <a href="mailto:marcelino.delacruz@upm.es">marcelino.delacruz@upm.es</a>, Juan M. Pastor <a href="mailto:juanmanuel.pastor@upm.es">juanmanuel.pastor@upm.es</a>, 
Javier Galeano <a href="mailto:javier.galeano@upm.es">javier.galeano@upm.es</a> and Jose M. Iriondo <a href="mailto:jose.iriondo@urjc.es">jose.iriondo@urjc.es</a>
</p>


<h3>References</h3>

<p>Barrat, A., Barthelemy, M., Pastor-Satorras, R., and Vespignani, A. (2004)  The architecture of complex weighted networks.  <em>PNAS</em> <b>101</b>, 3747&ndash;3752
</p>
<p>Corso G, de Araujo AIL, de Almeida AM (2008) A new nestedness estimator in community networks. <em>arXiv</em> 0803.0007v1 [physics.bio-ph]
</p>
<p>Galeano J, Pastor JM, Iriondo JM (2008) Weighted-Interaction Nestedness Estimator (WINE): A new  estimator to calculate over frequency matrices. <em>arXiv</em> 0808.3397v2 [physics.bio-ph] 
</p>
<p>Ulrich, W., Almeida-Neto, M., and Gotelli, N.J. (2009) A consumer's guide to nestedness analysis. <em>Oikos</em> 118, 3-17 
</p>
<p>Ulrich, W. and Gotelli, N.J. (2007) Null model analysis of species nestedness patterns. <em>Ecology</em> 88, 1824-1831 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nestedness">nestedness</a></code> and <code><a href="#topic+discrepancy">discrepancy</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Safariland, package="bipartite")
safariland.w &lt;- wine(Safariland, 10)
plot.wine(safariland.w)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
