<!DOCTYPE html><html lang="en"><head><title>Help for package AlgebraicHaploPackage</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AlgebraicHaploPackage}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AlgebraicHaploPackage-package'>
<p>AlgebraicHaploPackage&mdash; The package haplotype a contingency of two pairs of snips of a sample.</p></a></li>
<li><a href='#callhaplotype'>
<p>calcultes the cotigency table of the haplotypes</p></a></li>
<li><a href='#cubic'>
<p>Function that can resolve the cubic equation numerical stable and any lower dimensional case except unsolvable cases.</p></a></li>
<li><a href='#findoptimal'>
<p>Chose the most likely solution of the three potential onces.</p></a></li>
<li><a href='#haplotypeit'>
<p>Haplotype a 3 x 3 counting matrix.</p></a></li>
<li><a href='#optimalfrequency'>
<p>Evaluate potential haplotypes.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Haplotype Two Snips Out of a Paired Group of Patients</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-10-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Wolfertz</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Wolfertz &lt;Jan.wolfertz@uni-duesseldorf.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.3)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>compiler</td>
</tr>
<tr>
<td>Description:</td>
<td>Two unordered pairs of data of two different snips positions is haplotyped by resolving a small number ob closed equations.</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-10-27 14:54:33 UTC; jan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-10-31 08:46:53</td>
</tr>
</table>
<hr>
<h2 id='AlgebraicHaploPackage-package'>
AlgebraicHaploPackage&mdash; The package haplotype a contingency of two pairs of snips of a sample.
</h2><span id='topic+AlgebraicHaploPackage-package'></span><span id='topic+AlgebraicHaploPackage'></span>

<h3>Description</h3>

<p>Assume a group of patients of an unordered pair of data per snips.
The  contingency table of 2 snips on diffrent positions are calculated. A haplotype 2x2 most likely contingency table is guessed.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> AlgebraicHaploPackage</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-10-26</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL2.0
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Jan Wolfertz.
</p>
<p>Maintainer: jan.wolfertz@uni-duesseldorf.de
</p>


<h3>References</h3>

<p>[1] David Clayton.      
&quot;An r    package for analysis of whole-genome association   
studies.&quot;Human Heredity, 64(1):45 - 51, 2007.     
doi: doi:10.1001/archgenpsychiatry.2010.25. 
http://archpsyc.jamanetwork.com/article.aspx?articleid=210679.
[2] Nathan Jacobson. 
Basic Algebra I: Second Edition (Dover Books on Mathematics).   
Dover Publication, 2009.
[3] Montgomery Slatkin Laurent Excofie.          
Maximum-likelihood esti-mation of molecular haplotype
frequencies in a diploid population. 
Molecular biology and evolution, 12(5):921 - 927, 1995. 
URL
http://mbe.oxfordjournals.org/content/12/5/921.full.pdf.
[4] Tianhua Niu. 
Algorithms for inferring haplotypes. 
Genetic Epidemiology, 27:334347, 2004. 
doi: DOI: 10.1002/gepi.20024. 
URL
http://biostat.gru.edu/Journal
[5] Werner A. Stahel. 
Statistische Datenanalyse Eine. Vieweg Verlag, 2002.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print("The second example: \n")
dd=matrix(c(1212, 2, 0, 679, 0,0,75,0,0), byrow=TRUE, nrow=3)
colnames(dd)=c("CC","CT","TT")
rownames(dd)=c("CC","CT","TT")
callhaplotype(dd)
### Check the result of the cubic equation of the second example
print("##############################")
print("Check the result of the cubic equation of the second example: \n")
temp2haplo =as.numeric(t(dd));
t2h=temp2haplo
haplotypeit(t2h[1],t2h[2],t2h[3],t2h[4],t2h[5],t2h[6],t2h[7],t2h[8],t2h[9]);
rm(temp2haplo)
rm(t2h)
### Third example
print("##############################")
print("Third example : \n")
dd3=matrix(c(1030,678,123,1,1,0,0,0,0),ncol=3,byrow=TRUE)
colnames(dd3)=c("AA","AG","GG")
rownames(dd3)=c("CC","CT","TT")
callhaplotype(dd3)
###  Check for alternative solutions
print("##############################")
print("Check for alternative solutions: \n")
temp2haplo =as.numeric(t(dd3));
t2h=temp2haplo;
haplotypeit(t2h[1],t2h[2],t2h[3],t2h[4],t2h[5],t2h[6],t2h[7],t2h[8],t2h[9]);
rm(temp2haplo)
rm(t2h)
print("##############################")
print("##############################")
print("This tests the result of the first example of the article \n")
dd2=matrix(c(4,0,0,0,30,0,0,0,23),ncol=3,byrow=TRUE)
callhaplotype(dd2)
callhaplotype(dd2)/(2*57)
print("##############################")
</code></pre>

<hr>
<h2 id='callhaplotype'>
calcultes the cotigency table of the haplotypes
</h2><span id='topic+callhaplotype'></span>

<h3>Description</h3>

<p>It starts with a contigency table of pairs of haplotypes and ends up with the haplotypes one. The heterocygote cases are the middle of the column and rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>callhaplotype(dd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="callhaplotype_+3A_dd">dd</code></td>
<td>

<p>This is a  contingency table. Rows and columns are in the order are AA, AB,BB. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A 2x2  contingency table of haplotypes is calculated. The most likely solution had been choosen.
</p>


<h3>Value</h3>

<p>The haplotype contingency table is returned. All entries are numeric.
</p>


<h3>Note</h3>

<p>The differences are the coice of the solution of the cubic equations. About 4 percent differences and about 7 assuming 1 per thousand.
For data export or import you can use a different package.
</p>


<h3>Author(s)</h3>

<p>Jan Wolfertz
</p>


<h3>References</h3>

<p>David Clayton.      
&quot;An r    package for analysis of whole-genome association studies.&quot;
Human Heredity, 64(1):45 - 51, 2007.     
doi: doi:10.1001/archgenpsychiatry.2010.25. 
URL
http://archpsyc.jamanetwork.com/article.aspx?articleid=210679.
Jan Wolfertz(in press.):&quot;&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print("###########################")
dd2=matrix(c(4,0,0,0,30,0,0,0,23),ncol=3,byrow=TRUE)
callhaplotype(dd2)
callhaplotype(dd2)/(2*57)

### The second example
print("##############################")
print("The second example: \n")
dd=matrix(c(1212, 2, 0, 679, 0,0,75,0,0), byrow=TRUE, nrow=3)
colnames(dd)=c("CC","CT","TT")
rownames(dd)=c("CC","CT","TT")
callhaplotype(dd)
print("##############################")
</code></pre>

<hr>
<h2 id='cubic'>
Function that can resolve the cubic equation numerical stable and any lower dimensional case except unsolvable cases.
</h2><span id='topic+cubic'></span>

<h3>Description</h3>

<p>A*x^3+B*x^2+C*x+D=0. All coefficients had to be numeric or integers.
This function calculates from 4 coefficient all possible and senfully solutions. D=0 returns no values at all. This would be a impossibel case. It returns upto 3 potential complex solutions.
Less solutions are copied to get the tripple solution format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cubic(A, B, C, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cubic_+3A_a">A</code></td>
<td>

<p>The coefficient of x^3.
</p>
</td></tr>
<tr><td><code id="cubic_+3A_b">B</code></td>
<td>

<p>The coefficient of x^2.
</p>
</td></tr>
<tr><td><code id="cubic_+3A_c">C</code></td>
<td>

<p>The coefficient of X.
</p>
</td></tr>
<tr><td><code id="cubic_+3A_d">D</code></td>
<td>

<p>The constant.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is called by haplotypeit. The results are returned as vector of the three possible solutions: output[1],output[2],output[3].
Further data for checks of the roots.  p,q and the discriminat. 10 and 11 are only usable for symmetry checks.
</p>


<h3>Value</h3>

<p>Returns <code>cubic</code>(A,B,C,D)[c(1:3)] roots of the at most cubic equation.
</p>


<h3>Note</h3>

<p>Using cardenian formular, a well known method. 
</p>


<h3>Author(s)</h3>

<p>Jan Wolfertz
</p>


<h3>References</h3>

<p>Cardans formular as in e.g. The Mathematical Gazette (1993); 77 (Nov, No 480), 354-359 (jstor)
http://www.nickalls.org/dick/papers/maths/cubic1993.pdf
or any other book for algebraic solutions.
See also : http://de.wikipedia.org/wiki/Cardanische_Formeln
and http://en.wikipedia.org/wiki/Cubic_equation
</p>


<h3>See Also</h3>

<p>haplotypeit,callhaplotype
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cubic(1,0,0,-1)[c(1:3)]
cubic(1,1,0,0)[c(1:3)]
</code></pre>

<hr>
<h2 id='findoptimal'>
Chose the most likely solution of the three potential onces.
</h2><span id='topic+findoptimal'></span>

<h3>Description</h3>

<p>Starting with a 3x3 matrix, three potential haplotypes 2x2 matrices will be calculted and evaluated. The most likly one is choosen. A dicrete solution values are not enforced. This reduces increases the right prediction on real data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findoptimal(A, B, C, D, mmorg, exact = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findoptimal_+3A_a">A</code></td>
<td>

<p>Firts entry of the 2x2 matrix.
</p>
</td></tr>
<tr><td><code id="findoptimal_+3A_b">B</code></td>
<td>

<p>Second numeric entry of teh 2x2 matrix.
</p>
</td></tr>
<tr><td><code id="findoptimal_+3A_c">C</code></td>
<td>

<p>Third numeric entry of the 2x2 matrix.
</p>
</td></tr>
<tr><td><code id="findoptimal_+3A_d">D</code></td>
<td>

<p>Last numeric entry of the 2x2 matrix.
</p>
</td></tr>
<tr><td><code id="findoptimal_+3A_mmorg">mmorg</code></td>
<td>

<p>3x3 matrix of the pair of original snip pairs.
</p>
</td></tr>
<tr><td><code id="findoptimal_+3A_exact">exact</code></td>
<td>

<p><code>exact</code> is a parameter when data are assumed to be equal. Acutually 1e-5 is taken. Should not be larger than the invers of four times the number of people.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It chose the 2x2 model of haplotypes with the smallest prediction error. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>AA</code></td>
<td>
<p>Coefficient of x^3</p>
</td></tr>
<tr><td><code>BB</code></td>
<td>
<p>Coefficient of x^2</p>
</td></tr>
<tr><td><code>CC</code></td>
<td>
<p>Coefficient of x</p>
</td></tr>
<tr><td><code>DD</code></td>
<td>
<p>Coefficient of the intercept</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jan wolfertz
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dd2=matrix(c(4,0,0,0,30,0,0,0,23),ncol=3,byrow=TRUE)
A=c(38+0i,2+12.1655i,2-12.1655i)
B=c(0+0i,36-12.1655i,36+12.1655i)
C=c(0+0i,36-12.1655i,36+12.1655i)
D=c(76+0i,40+12.1655i,40-12.1655i)
</code></pre>

<hr>
<h2 id='haplotypeit'>
Haplotype a 3 x 3 counting matrix. 
</h2><span id='topic+haplotypeit'></span>

<h3>Description</h3>

<p>This functions recalculates the potential 2x2 haplotype matrics.
It gets a 3x3 matrixs and returns a list A,B,C,D of vectors.
A[1],B[1],C[1],D[1] is the first solution of the matrix. There are always three solutions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>haplotypeit(a, b, c, d, e, f, g, h, i)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="haplotypeit_+3A_a">a</code></td>
<td>

<p>Number of counts of matching snip pairs.
</p>
</td></tr>
<tr><td><code id="haplotypeit_+3A_b">b</code></td>
<td>

<p>Number of counts of matching snip pairs..
</p>
</td></tr>
<tr><td><code id="haplotypeit_+3A_c">c</code></td>
<td>

<p>Number of counts of matching snip pairs.
</p>
</td></tr>
<tr><td><code id="haplotypeit_+3A_d">d</code></td>
<td>

<p>Number of counts of matching snip pairs.
</p>
</td></tr>
<tr><td><code id="haplotypeit_+3A_e">e</code></td>
<td>

<p>Number of counts of matching snip pairs. 
</p>
</td></tr>
<tr><td><code id="haplotypeit_+3A_f">f</code></td>
<td>

<p>Number of counts of matching snip pairs.
</p>
</td></tr>
<tr><td><code id="haplotypeit_+3A_g">g</code></td>
<td>

<p>Number of counts of matching snip pairs.
</p>
</td></tr>
<tr><td><code id="haplotypeit_+3A_h">h</code></td>
<td>

<p>Number of counts of matching snip pairs.
</p>
</td></tr>
<tr><td><code id="haplotypeit_+3A_i">i</code></td>
<td>

<p>Number of counts of matching snip pairs.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The software automatically resolves the cases e=0 by circumventing the cubic equation. If the degree of the equation is lower additional copies of some solution will be made to produce the outputformat.
The output format is a list of four vectors of copefficients. Each vector contains three complex numbers.
</p>


<h3>Value</h3>

<p>output$A is a vector of length 3.
output$B,Output$C, output$D is eighter of length 3.
One potential solution is A[1],B[1],C[1],D[1].
</p>


<h3>Author(s)</h3>

<p>Jan wolfertz
</p>


<h3>References</h3>

<p>This methods refers to an article:
David Clayton. An r    package for analysis of whole-
genome association studies. Human Heredity, 
64(1):45 - 51, 2007.     doi: doi:10.1001/archgenpsychiatry.2010.25. URL
http://archpsyc.jamanetwork.com/article.aspx?articleid=210679.
</p>


<h3>See Also</h3>

<p>callhaplotype
</p>


<h3>Examples</h3>

<pre><code class='language-R'>haplotypeit(4,0,0,0,30,0,0,0,23)
print("##############################")
print("This tests the cubic routine")
haplotypeit(4,0,0,0,30,0,0,0,23)
### Formated of 4 digits
print("Formated of 4 digits")
round(as.numeric(Re(haplotypeit(4,0,0,0,30,0,0,0,23)$A)),digit=4)
round(as.numeric(Re(haplotypeit(4,0,0,0,30,0,0,0,23)$B)),digit=4)
round(as.numeric(Re(haplotypeit(4,0,0,0,30,0,0,0,23)$C)),digit=4)
round(as.numeric(Re(haplotypeit(4,0,0,0,30,0,0,0,23)$D)),digit=4)
### 
</code></pre>

<hr>
<h2 id='optimalfrequency'>
Evaluate potential haplotypes.
</h2><span id='topic+optimalfrequency'></span>

<h3>Description</h3>

<p>Calculate the difference of a known haplotype and the resulting unordered pair of snip pairs. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimalfrequency(mm, mmorg)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optimalfrequency_+3A_mm">mm</code></td>
<td>

<p>This is a contigency table of two haplotype snips.
2x2 matrix or ndata.frame 
</p>
</td></tr>
<tr><td><code id="optimalfrequency_+3A_mmorg">mmorg</code></td>
<td>

<p>This is a contigency table of two diplotype snips pairs.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The average squared distance to the expected result 3x3 table is used as a T statistic. The p value not to be zero is calculated.
The higher the p value the more exact is the haplotype. 
</p>


<h3>Value</h3>

<p>A list of values is returned.
</p>
<table role = "presentation">
<tr><td><code>result\$LK</code></td>
<td>
<p> Linkage disequilibrium </p>
</td></tr>
<tr><td><code>result\$Testvalue</code></td>
<td>
<p> The squared sitance multiplied by the number of entries in 3x3 matrix mmorg </p>
</td></tr>
<tr><td><code>result\$prSimilarByChange</code></td>
<td>
<p> The probability not o be equal to zero by change. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jan wolfertz.
</p>


<h3>References</h3>

<p>Stahel: Statistik fuer Naturwissenschaftler und Medizinier, pp. 107-120. 
</p>


<h3>See Also</h3>

<p>findoptimal
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
