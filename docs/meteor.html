<!DOCTYPE html><html><head><title>Help for package meteor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {meteor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dailyToHourly'><p>Estimate hourly values from daily values</p></a></li>
<li><a href='#dates'><p> date manipulation</p></a></li>
<li><a href='#dayTemp'><p>Estimate the temperature during the day</p></a></li>
<li><a href='#evapotranspiration'><p>Reference evapo-transpiration</p></a></li>
<li><a href='#ExtraTerrestrialRadiation'><p>Extra-terrestrial Radiation</p></a></li>
<li><a href='#from'><p> Date manipulation</p></a></li>
<li><a href='#FSE weather'>
<p>Read FSE formatted weather data</p></a></li>
<li><a href='#generics'><p>Generic functions</p></a></li>
<li><a href='#globe'><p>Globe temperature</p></a></li>
<li><a href='#meteor-package'>
<p>The meteor package</p></a></li>
<li><a href='#photoperiod'><p> photoperiod</p></a></li>
<li><a href='#power_weather'>
<p>Global weather data estimated from satellite data and models.</p></a></li>
<li><a href='#pwc'><p>pwc</p></a></li>
<li><a href='#vaporpressure'><p>Vapor pressure</p></a></li>
<li><a href='#Weather-class'><p>Weather class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Meteorological Data Manipulation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4-5</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 0.12.4)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>terra</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-07-13</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Robert J. Hijmans &lt;r.hijmans@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of functions for weather and climate data manipulation, and other helper functions, to support dynamic ecological modeling, particularly crop and crop disease modeling.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-13 14:16:43 UTC; rhijm</td>
</tr>
<tr>
<td>Author:</td>
<td>Robert J. Hijmans [cre, aut],
  Gerald Nelson [ctb],
  Maarten Waterloo [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-16 18:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dailyToHourly'>Estimate hourly values from daily values </h2><span id='topic+hourlyFromDailyTemp'></span><span id='topic+hourlyFromDailyRelh'></span>

<h3>Description</h3>

<p>Estimate hourly temperature from daily minimum and maximum temperature, or hourly relative humidity from average relative humidity and minimum and maximum temperature.
</p>
<p>The functions require the day of the year and latitude to compute the photoperiod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hourlyFromDailyTemp(tmin, tmax, doy, latitude)
hourlyFromDailyRelh(relh, tmin, tmax, doy, latitude)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dailyToHourly_+3A_tmin">tmin</code></td>
<td>
<p>numeric. minimum temperature (must be in C for hourlyFromDailyRelh)</p>
</td></tr>
<tr><td><code id="dailyToHourly_+3A_tmax">tmax</code></td>
<td>
<p>numeric. maximum temperature (must be in C for hourlyFromDailyRelh)</p>
</td></tr>
<tr><td><code id="dailyToHourly_+3A_relh">relh</code></td>
<td>
<p>relative humidity (percent)</p>
</td></tr>
<tr><td><code id="dailyToHourly_+3A_doy">doy</code></td>
<td>
<p>integer. Day of the year (between 1 and 365)</p>
</td></tr>
<tr><td><code id="dailyToHourly_+3A_latitude">latitude</code></td>
<td>
<p>numeric. Latitude</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hourlyFromDailyTemp(c(20,22), c(28,34), c(150,151), 52)
hourlyFromDailyRelh(80, c(20,22), c(28,34), c(150,151), 52)
</code></pre>

<hr>
<h2 id='dates'> date manipulation </h2><span id='topic+dateFromDoy'></span><span id='topic+doyFromDate'></span><span id='topic+dayFromDate'></span><span id='topic+monthFromDate'></span><span id='topic+yearFromDate'></span><span id='topic+isLeapYear'></span><span id='topic+daysInYear'></span><span id='topic+daysOfYear'></span>

<h3>Description</h3>

<p>Helper functions for manipulation of dates, includding conversion between (day of year) (DOY) to date and back, and extraction of parts of a date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dateFromDoy(doy, year)
doyFromDate(date)
dayFromDate(date)
monthFromDate(date)
yearFromDate(date)
isLeapYear(year)
daysInYear(year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dates_+3A_doy">doy</code></td>
<td>
<p>integer. Day of the year (1..365) or (1..366) for leap years </p>
</td></tr>
<tr><td><code id="dates_+3A_year">year</code></td>
<td>
<p>integer. Year, e.g. 1982 </p>
</td></tr>
<tr><td><code id="dates_+3A_date">date</code></td>
<td>
<p>Date object or character formatted 'yyyy-mm-dd', e.g. '1982-11-23' </p>
</td></tr>  
</table>


<h3>Value</h3>

<p>integer or Date
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doy &lt;- 88
year &lt;- 1970
date &lt;- dateFromDoy(doy, year)
date
dateFromDoy(-15, 2000)
doyFromDate(date)
isLeapYear(2000)
daysInYear(2000)
daysInYear(1999)
</code></pre>

<hr>
<h2 id='dayTemp'>Estimate the temperature during the day</h2><span id='topic+dayTemp'></span>

<h3>Description</h3>

<p>Estimate the mean temperature during the day (between sunrise and sunset) from daily minimum and maximum temperature.
</p>
<p>The function requires the day of the year and latitude to compute the photoperiod.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dayTemp(tmin, tmax, doy, latitude)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dayTemp_+3A_tmin">tmin</code></td>
<td>
<p>numeric. minimum temperature (any unit)</p>
</td></tr>
<tr><td><code id="dayTemp_+3A_tmax">tmax</code></td>
<td>
<p>numeric. maximum temperature (any unit)</p>
</td></tr>
<tr><td><code id="dayTemp_+3A_doy">doy</code></td>
<td>
<p>integer. Day of the year (between 1 and 365)</p>
</td></tr>
<tr><td><code id="dayTemp_+3A_latitude">latitude</code></td>
<td>
<p>numeric. Latitude</p>
</td></tr>  
</table>


<h3>Value</h3>

<p>numeric
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dayTemp(c(20,22), c(28,34), c(150,151), 52)
</code></pre>

<hr>
<h2 id='evapotranspiration'>Reference evapo-transpiration </h2><span id='topic+ET0_PenmanMonteith'></span><span id='topic+ET0_PriestleyTaylor'></span><span id='topic+ET0_Makkink'></span><span id='topic+ET0_ThornthwaiteWilmott'></span><span id='topic+ET0_ThornthwaiteWilmottCamargo'></span>

<h3>Description</h3>

<p>Functions to compute the reference evapotranspiration (ET0) from meteorological data. ET0 is a representation of the atmospheric water demand. The equations estimate the evapotranspiration rate of a short green crop (grass), completely shading the ground, of uniform height and with adequate water status in the soil profile. Actual evapotranspiration is equal reference evapotranspiration when there is ample water, but taller crops could have an evapotranspiration rate that is higher than ET0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ET0_PenmanMonteith(temp, relh, atmp, Rn, G, ra, rs)
ET0_PriestleyTaylor(temp, relh, atmp, Rn, G)
ET0_Makkink(temp, relh, atmp, Rs)
ET0_ThornthwaiteWilmott(temp, doy, latitude)
ET0_ThornthwaiteWilmottCamargo(tmin, tmax, doy, latitude, Pereira=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evapotranspiration_+3A_temp">temp</code></td>
<td>
<p>temperature (degrees C)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_relh">relh</code></td>
<td>
<p>relative humidity (percent)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_atmp">atmp</code></td>
<td>
<p>air pressure (hPa</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_rn">Rn</code></td>
<td>
<p>net radiation (J m-2 day-1)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_rs">Rs</code></td>
<td>
<p>incoming solar radiation (J m-2 day-1)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_g">G</code></td>
<td>
<p>soil heat flux (J m-2 day-1)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_ra">ra</code></td>
<td>
<p>aerodynamic resistance (s m-1)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_rs">rs</code></td>
<td>
<p>surface resistance (s m-1)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_doy">doy</code></td>
<td>
<p>integer. Day of the year (between 1&ndash;365)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_latitude">latitude</code></td>
<td>
<p>numeric. Latitude</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_tmin">tmin</code></td>
<td>
<p>numeric. minimum temperature (C)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_tmax">tmax</code></td>
<td>
<p>numeric. maximum temperature (C)</p>
</td></tr>
<tr><td><code id="evapotranspiration_+3A_pereira">Pereira</code></td>
<td>
<p>logical. If <code>TRUE</code>, the Pereira adjustment for photoperiod is used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with evaporation values (mm)
</p>


<h3>Author(s)</h3>

<p>Robert Hijmans, partly based on Python evapolib by Maarten J. Waterloo <a href="http://python.hydrology-amsterdam.nl/">http://python.hydrology-amsterdam.nl/</a>
</p>


<h3>References</h3>

<p>Allen, R.G., L.S. Pereira, D. Raes and M. Smith, 1998. Crop evapotranspiration. Guidelines for computing crop water requirements. FAO Irrigation and drainage paper 56. FAO - Food and Agriculture Organization of the United Nations, Rome, 1998. (http://www.fao.org/docrep/x0490e/x0490e07.htm)
</p>
<p>Thornthwaite, C.W., 1948. An approach toward a rational classification of climate. Geogr. Rev. 38:55-94.
</p>
<p>Willmott, C.J., Rowe, C.M. and Mintz, Y., 1985. Climatology of the terrestrial seasonal water cycle. J. Climatol. 5:589-606.
</p>
<p>Camargo, A.P., Marin, F.R., Sentelhas, P.C. and Picini, A.G., 1999. Adjust of the Thornthwaite's method to estimate the potential evapotranspiration for arid and superhumid climates, based on daily temperature amplitude. Rev. Bras. Agrometeorol. 7(2):251-257
</p>
<p>Pereira, A.R. and W.O. Pruitt, 2004. Adaptation of the Thornthwaite scheme for estimating daily reference evapotranspiration. Agricultural Water Management 66: 251-257
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ET0_PenmanMonteith(21.67, 67, 1013, 14100000, 500000, 104, 70)
ET0_PriestleyTaylor(21.65, 67, 1013, 18200000, 600000)
ET0_Makkink(21.65, 67, 1013, 24200000)
</code></pre>

<hr>
<h2 id='ExtraTerrestrialRadiation'>Extra-terrestrial Radiation</h2><span id='topic+ExtraTerrestrialRadiation'></span>

<h3>Description</h3>

<p>Compute incoming radiation (J day-1 m-2 ) at the top of the atmosphere and photoperiod (daylength, sunshine duration).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExtraTerrestrialRadiation(doy, latitude, sc=1367.7, FAO=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ExtraTerrestrialRadiation_+3A_doy">doy</code></td>
<td>
<p>integer. Day of the year</p>
</td></tr>
<tr><td><code id="ExtraTerrestrialRadiation_+3A_latitude">latitude</code></td>
<td>
<p>numeric. Latitude</p>
</td></tr>
<tr><td><code id="ExtraTerrestrialRadiation_+3A_sc">sc</code></td>
<td>
<p>numeric. The solar constant</p>
</td></tr>  
<tr><td><code id="ExtraTerrestrialRadiation_+3A_fao">FAO</code></td>
<td>
<p>logical. If <code>TRUE</code> the algorithm described by Allen et al (1998) is used. If <code>FALSE</code> the approach by Goudriaan and Van Laar (1995) is used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with incoming radiation (J/day) and 
</p>


<h3>Author(s)</h3>

<p>Robert Hijmans, based on Python meteolib by Maarten J. Waterloo and J. Delsman <a href="http://python.hydrology-amsterdam.nl/">http://python.hydrology-amsterdam.nl/</a>
</p>


<h3>References</h3>

<p>Goudriaan and Van Laar, 1995.
</p>
<p>R.G. Allen, L.S. Pereira, D. Raes and M. Smith (1998). Crop Evaporation - Guidelines for computing crop water requirements. Irrigation and drainage paper 56. FAO, Rome, Italy. <a href="https://www.fao.org/3/x0490e/x0490e07.htm">https://www.fao.org/3/x0490e/x0490e07.htm</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ExtraTerrestrialRadiation(50, 60)
ExtraTerrestrialRadiation(50, 60, FAO=TRUE)
</code></pre>

<hr>
<h2 id='from'> Date manipulation </h2><span id='topic+fromDate'></span><span id='topic+fromYear'></span><span id='topic+fromDoy'></span>

<h3>Description</h3>

<p>Helper functions for extracting information from dates. Or to create a Date from a day number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fromDate(x, v)
fromYear(y, v)
fromDoy(doy, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="from_+3A_x">x</code></td>
<td>
<p>Date or POSIX</p>
</td></tr>
<tr><td><code id="from_+3A_y">y</code></td>
<td>
<p>integer (year)</p>
</td></tr>
<tr><td><code id="from_+3A_v">v</code></td>
<td>
<p>character. Output variable. With <code>fromDate</code> it can be one of: &quot;year&quot;, &quot;month&quot;, &quot;week&quot;, &quot;day&quot;, &quot;doy&quot;. With <code>fromYear</code> it can be one of &quot;leap&quot;, &quot;ndays&quot;, &quot;days&quot;</p>
</td></tr>
<tr><td><code id="from_+3A_doy">doy</code></td>
<td>
<p>integer (day of the year)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integer or Date
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- as.Date("1999-12-30") + 1:2
d
fromDate(d, "month")
fromDate(d, "doy")

fromDoy(10, 2000)
</code></pre>

<hr>
<h2 id='FSE+20weather'>
Read FSE formatted weather data
</h2><span id='topic+readFSEwth'></span><span id='topic+writeFSEwth'></span><span id='topic+example_weather'></span>

<h3>Description</h3>

<p>Read or write FSE formatted weather data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readFSEwth(f)
writeFSEwth(w, country='AAA', station=1, lon=0, lat=0, elev=0,  path=".")

example_weather()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FSE+2B20weather_+3A_f">f</code></td>
<td>
<p>character. filename</p>
</td></tr>
<tr><td><code id="FSE+2B20weather_+3A_w">w</code></td>
<td>
<p>data.frame with daily weather data. Must include the following variables: &quot;date&quot;, &quot;srad&quot;, &quot;tmin&quot;, &quot;tmax&quot;, &quot;wind&quot;, &quot;prec&quot;, &quot;vapr&quot;. The data must be sorted by date in ascending order. &quot;date&quot; must be a <code><a href="base.html#topic+Date">Date</a></code>, the other variables must be numeric</p>
</td></tr>
<tr><td><code id="FSE+2B20weather_+3A_country">country</code></td>
<td>
<p>character code for a country (up to three letters)</p>
</td></tr>
<tr><td><code id="FSE+2B20weather_+3A_station">station</code></td>
<td>
<p>positive integer. Station number for the country</p>
</td></tr>
<tr><td><code id="FSE+2B20weather_+3A_lon">lon</code></td>
<td>
<p>numeric. Longitude of the weather station (not used by the models)</p>
</td></tr>
<tr><td><code id="FSE+2B20weather_+3A_lat">lat</code></td>
<td>
<p>numeric. Latitude of the weather station</p>
</td></tr>
<tr><td><code id="FSE+2B20weather_+3A_elev">elev</code></td>
<td>
<p>numeric. Elevation of the weather station</p>
</td></tr>
<tr><td><code id="FSE+2B20weather_+3A_path">path</code></td>
<td>
<p>character. Folder where you want to write the files. It must exist</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>readFSEwth</code>: data.frame
</p>
<p><code>writeFSEwth</code>: character (invisibly) with the filenames
</p>

<hr>
<h2 id='generics'>Generic functions</h2><span id='topic+control+3C-'></span><span id='topic+crop+3C-'></span><span id='topic+soil+3C-'></span><span id='topic+weather+3C-'></span><span id='topic+run'></span>

<h3>Description</h3>

<p>These are generic functions that are declared in this package but have no implementation here. 
</p>

<hr>
<h2 id='globe'>Globe temperature</h2><span id='topic+Tg'></span><span id='topic+Tg+2Cdata.frame-method'></span><span id='topic+Tg+2CSpatRasterDataset-method'></span><span id='topic+Tnwb'></span><span id='topic+Tnwb+2Cdata.frame-method'></span><span id='topic+Tnwb+2CSpatRasterDataset-method'></span><span id='topic+WBGT'></span><span id='topic+WBGT+2Cdata.frame-method'></span><span id='topic+WBGT+2CSpatRasterDataset-method'></span>

<h3>Description</h3>

<p>Globe temperatures (Tg, Tnwb, WBGT). 
</p>
<p>The can be computed for either a <code>data.frame</code> or a <code>SpatRasterDataset</code>. These must have variables &quot;temp&quot; (C), &quot;rhum&quot; (%), &quot;wind&quot; (m s-1), and &quot;srad&quot; (J s-1 m-2). The <code>data.frame</code> must also have a variable &quot;date&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'data.frame'
Tg(x, latitude)
## S4 method for signature 'SpatRasterDataset'
Tg(x, filename="", overwrite=FALSE, ...)

## S4 method for signature 'data.frame'
Tnwb(x, latitude, kelvin=FALSE)
## S4 method for signature 'SpatRasterDataset'
Tnwb(x, kelvin=FALSE, filename="", overwrite=FALSE, ...)

## S4 method for signature 'data.frame'
WBGT(x, latitude, kelvin=FALSE)
## S4 method for signature 'SpatRasterDataset'
WBGT(x, kelvin=FALSE, mask=NULL, filename="", overwrite=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="globe_+3A_x">x</code></td>
<td>
<p>data.frame or SpatRasterDataset</p>
</td></tr>
<tr><td><code id="globe_+3A_latitude">latitude</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="globe_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="globe_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code>filename</code> is overwritten</p>
</td></tr>  
<tr><td><code id="globe_+3A_...">...</code></td>
<td>
<p>additional arguments for writing files as in <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>    
<tr><td><code id="globe_+3A_kelvin">kelvin</code></td>
<td>
<p>logical. Set to <code>TRUE</code> of the units of temperature are in Kelvin</p>
</td></tr>
<tr><td><code id="globe_+3A_mask">mask</code></td>
<td>
<p>NULL of SpatRaster. if a SpatRaster is used, it should have one layer. No computations are done for cells that are NA, and these are set to NA in the output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric or SpatRaster
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wd &lt;- data.frame(date=as.Date("2003-08-28") + 1:3, 
		temp=c(19.1, 20.6, 19.4), 
		rhum=c(66,71,73), 
		wind=c(3.3, 1.9, 1.1), 
		srad=c(168, 178, 125))
Tg(wd, 40.96) 

Tnwb(wd, 40.96) 

WBGT(wd, 40.96) 


library(terra)
r &lt;- rast(ncol=2, nrow=2, nlyr=1)
temp &lt;- setValues(r, 21:24)
time(temp) &lt;- as.Date("2000-01-01")
rhum &lt;- setValues(r, 81:84)
wind &lt;- setValues(r, 9:12)
srad &lt;- setValues(r, 100:103)
s &lt;- sds(list(temp=temp, rhum=rhum, wind=wind, srad=srad))

x &lt;- Tg(s)
y &lt;- WBGT(s)
</code></pre>

<hr>
<h2 id='meteor-package'> 
The meteor package
</h2><span id='topic+meteor-package'></span><span id='topic+meteor'></span>

<h3>Description</h3>

<p>This pacakges contains of a number of meteorological data manipulation functions. 
Some of these are also available in other R packages. The context of this package is to make the functions available from dynamic simulation models of crops and crop diseases. 
</p>

<hr>
<h2 id='photoperiod'> photoperiod</h2><span id='topic+photoperiod'></span><span id='topic+photoperiod+2Cnumeric-method'></span><span id='topic+photoperiod+2CDate-method'></span><span id='topic+photoperiod+2Cdata.frame-method'></span><span id='topic+photoperiod+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>Compute photoperiod (daylength, sunshine duration) at a given latitude and day of the year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Date'
photoperiod(x, latitude)

## S4 method for signature 'data.frame'
photoperiod(x)

## S4 method for signature 'SpatRaster'
photoperiod(x, filename="", overwrite=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="photoperiod_+3A_x">x</code></td>
<td>
<p>Date, integer (day of the year), or data.frame (with variables &quot;date&quot; and &quot;latitude&quot;, or SpatRaster</p>
</td></tr>
<tr><td><code id="photoperiod_+3A_latitude">latitude</code></td>
<td>
<p>numeric. Latitude</p>
</td></tr>
<tr><td><code id="photoperiod_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="photoperiod_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code>filename</code> is overwritten</p>
</td></tr>  
<tr><td><code id="photoperiod_+3A_...">...</code></td>
<td>
<p>additional arguments for writing files as in <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>     
</table>


<h3>Value</h3>

<p>double. Photoperiod in hours
</p>


<h3>References</h3>

<p>Forsythe, W.C., E.J. Rykiel Jr., R.S. Stahl, H. Wu, R.M. Schoolfield, 1995. A model comparison for photoperiod as a function of latitude and day of the year. Ecological Modeling 80: 87-95.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>photoperiod(50, 52)
photoperiod(50, 5)
photoperiod(180, 55)

p &lt;- photoperiod(1:365, 52)
d &lt;- dateFromDoy(1:365, 2001)
plot(d, p)
</code></pre>

<hr>
<h2 id='power_weather'>
Global weather data estimated from satellite data and models. 
</h2><span id='topic+power_weather'></span>

<h3>Description</h3>

<p>This functions returns a data.frame with weather data from the NASA POWER database. It has the date, incoming solar radiation (srad, kJ m-2 day-1), minimum temperature (tmin, degrees C) and maximum temperature (tmax, degrees C), vapor pressure (vapr, Pa), precipitation (prec, mm), and windspeed (wind, m/s)
</p>
<p>The data are from 1983-01-01 to 2016-12-31
</p>
<p>Missing values for radiation (Jan to June 1983 and ...) and a few inbetween were replaced by the long term averages.
</p>
<p>There are no precipitation values before 1997-01-01. Missing values for precipitaion after that date were estimated as the long term average (i.e., not a particularly good method). 
</p>
<p>The data are at 1 degree spatial resolution. That is, they are the average for a large grid cell. 
</p>
<p>These are estimates. They can give a good general impression, but they are not ground observations. 
</p>
<p>Data are downloaded as-needed by tile. By default to folder called &quot;power&quot; in your working directory. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_weather(lon, lat, folder=file.path(getwd(), 'power'), tiles=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_weather_+3A_lon">lon</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="power_weather_+3A_lat">lat</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="power_weather_+3A_folder">folder</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="power_weather_+3A_tiles">tiles</code></td>
<td>
<p>logical. Download by tile?</p>
</td></tr>
<tr><td><code id="power_weather_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
w &lt;- power_weather(5, 50)
w$srad &lt;- w$srad * 1000
wth &lt;- subset(w, date &gt; as.Date('2012-01-01'))
head(wth)

## End(Not run)
</code></pre>

<hr>
<h2 id='pwc'>pwc</h2><span id='topic+pwc'></span><span id='topic+pwc+2Cnumeric-method'></span><span id='topic+pwc+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>pwc
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'numeric'
pwc(x, input="wbgt", adjust=TRUE)

## S4 method for signature 'SpatRaster'
pwc(x, input="wbgt", adjust=TRUE, filename="", overwrite=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pwc_+3A_x">x</code></td>
<td>
<p>numeric or SpatRaster</p>
</td></tr>
<tr><td><code id="pwc_+3A_input">input</code></td>
<td>
<p>character. One of &quot;wbgt&quot; or &quot;utci&quot;</p>
</td></tr>
<tr><td><code id="pwc_+3A_adjust">adjust</code></td>
<td>
<p>logical. If <code>TRUE</code>, the Smallcombe et al. (2022) adjustment for a 7-hour workday is used</p>
</td></tr>
<tr><td><code id="pwc_+3A_filename">filename</code></td>
<td>
<p>character. Output filename</p>
</td></tr>
<tr><td><code id="pwc_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code>filename</code> is overwritten</p>
</td></tr>  
<tr><td><code id="pwc_+3A_...">...</code></td>
<td>
<p>additional arguments for writing files as in <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>    
</table>


<h3>Value</h3>

<p>numeric or SpatRaster
</p>


<h3>References</h3>

<p>Smallcombe et al.. 2022
</p>
<p>Foster et al., 2022
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pwc(25)
</code></pre>

<hr>
<h2 id='vaporpressure'>Vapor pressure</h2><span id='topic+SVP'></span><span id='topic+VP'></span><span id='topic+VPD'></span><span id='topic+tDew'></span>

<h3>Description</h3>

<p>Functions to compute the saturated vapor pressure (SVP), actual vapor pressure (VP), and vapor pressure deficit (VPD) in Pascal or the dew-point temperature in C.
</p>
<p>For temperature &lt; 0C the saturation vapour pressure equation for ice is used according to Goff and Gratch (1946), whereas for temperature &gt;=0C that of Goff (1957) is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SVP(temp)
VP(temp, relh)
VPD(temp, relh)
tDew(temp, relh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vaporpressure_+3A_temp">temp</code></td>
<td>
<p>numeric. Temperature in degrees C</p>
</td></tr>
<tr><td><code id="vaporpressure_+3A_relh">relh</code></td>
<td>
<p>relative humidity (percent)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector (Pascal).
</p>


<h3>Author(s)</h3>

<p>Robert Hijmans, partly based on Python meteolib by Maarten J. Waterloo and J. Delsman <a href="http://python.hydrology-amsterdam.nl/">http://python.hydrology-amsterdam.nl/</a>
</p>


<h3>References</h3>

<p>Goff, J.A.,and S. Gratch, 1946. Low-pressure properties of water from -160 to 212 F. Transactions of the American society of heating and ventilating engineers, p. 95-122, presented at the 52nd annual meeting of the American society of heating and ventilating engineers, New York, USA.
</p>
<p>Goff, J. A. 1957. Saturation pressure of water on the new Kelvin temperature scale, Transactions of the American society of heating and ventilating engineers, pp 347-354, presented at the semi-annual meeting of the American society of heating and ventilating engineers, Murray Bay, Quebec, Canada.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>temperature &lt;- seq(-10,30,10)
SVP(temperature)
VP(temperature, 60)
VPD(temperature, 60)
tDew(temperature, 60)
</code></pre>

<hr>
<h2 id='Weather-class'>Weather class</h2><span id='topic+Weather-class'></span><span id='topic+show+2CWeather-method'></span><span id='topic++24+2CWeather-method'></span><span id='topic++24+3C-+2CWeather-method'></span><span id='topic++5B+5B+2CWeather-method'></span><span id='topic++5B+5B+3C-+2CWeather-method'></span>

<h3>Description</h3>

<p>Weather data
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("Weather", ...)</code>, or with the helper functions such as <code>weather</code>.
</p>


<h3>Slots</h3>

<p>Slots of Weather objects
</p>

<dl>
<dt><code>data</code>:</dt><dd><p>data.frame with the weather data</p>
</dd> 
<dt><code>ID</code>:</dt><dd><p>character</p>
</dd> 
<dt><code>name</code>:</dt><dd><p>character</p>
</dd> 
<dt><code>country</code>:</dt><dd><p>character</p>
</dd> 
<dt><code>longitude</code>:</dt><dd><p>numeric</p>
</dd> 
<dt><code>latitude</code>:</dt><dd><p>numeric</p>
</dd> 
<dt><code>elevation</code>:</dt><dd><p>numeric</p>
</dd> 
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>showClass("Weather")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
