<!DOCTYPE html><html><head><title>Help for package gjam</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gjam}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gjam'><p>Gibbs sampler for gjam data</p></a></li>
<li><a href='#gjam-package'>
<p>Generalized Joint Attribute Modeling</p></a></li>
<li><a href='#gjamCensorY'><p>Censor gjam response data</p></a></li>
<li><a href='#gjamConditionalParameters'><p>Parameters for gjam conditional prediction</p></a></li>
<li><a href='#gjamDeZero'><p>Compress (de-zero) gjam data</p></a></li>
<li><a href='#gjamFillMissingTimes'><p>Fill out data for time series (state-space) gjam</p></a></li>
<li><a href='#gjamIIE'><p>Indirect effects and interactions for gjam data</p></a></li>
<li><a href='#gjamIIEplot'><p>Plots indirect effects and interactions for gjam data</p></a></li>
<li><a href='#gjamOrdination'><p>Ordinate gjam data</p></a></li>
<li><a href='#gjamPlot'><p>Plot gjam analysis</p></a></li>
<li><a href='#gjamPoints2Grid'><p>Incidence point pattern to grid counts</p></a></li>
<li><a href='#gjamPredict'><p>Predict gjam data</p></a></li>
<li><a href='#gjamPriorTemplate'><p>Prior coefficients for gjam analysis</p></a></li>
<li><a href='#gjamReZero'><p>Expand (re-zero) gjam data</p></a></li>
<li><a href='#gjamSensitivity'><p>Sensitivity coefficients for gjam</p></a></li>
<li><a href='#gjamSimData'><p>Simulated data for gjam analysis</p></a></li>
<li><a href='#gjamSpec2Trait'><p>Ecological traits for gjam analysis</p></a></li>
<li><a href='#gjamTrimY'><p>Trim gjam response data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Joint Attribute Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>2.6.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-5-23</td>
</tr>
<tr>
<td>Author:</td>
<td>James S. Clark, Daniel Taylor-Rodriquez</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James S. Clark &lt;jimclark@duke.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyzes joint attribute data (e.g., species abundance) that are combinations of continuous and discrete data with Gibbs sampling.  Full model and computation details are described in Clark et al. (2018) &lt;<a href="https://doi.org/10.1002%2Fecm.1241">doi:10.1002/ecm.1241</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.5), MASS, RANN</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-23 09:43:25 UTC; jimclark</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-23 18:20:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='gjam'>Gibbs sampler for gjam data</h2><span id='topic+gjam'></span><span id='topic+print.gjam'></span><span id='topic+summary.gjam'></span>

<h3>Description</h3>

<p>Analyzes joint attribute data (e.g., species abundance) with Gibbs sampling.  
Input can be output from <code><a href="#topic+gjamSimData">gjamSimData</a></code>.  Returns a list of objects from Gibbs sampling that can be plotted by <code><a href="#topic+gjamPlot">gjamPlot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjam(formula, xdata, ydata, modelList)
  
  ## S3 method for class 'gjam'
print(x, ...)
  
  ## S3 method for class 'gjam'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjam_+3A_formula">formula</code></td>
<td>
<p>R formula for model, e.g., <code>~ x1 + x2</code>.</p>
</td></tr>
<tr><td><code id="gjam_+3A_xdata">xdata</code></td>
<td>
<p><code>data.frame</code> containing predictors in <code>formula</code>.  If not found in <code>xdata</code> variables, they must be available from the user's workspace.</p>
</td></tr>
<tr><td><code id="gjam_+3A_ydata">ydata</code></td>
<td>
<p><code>n</code> by <code>S</code> response <code>matrix</code> or <code>data.frame</code>.  Column names are unique labels, e.g., species names.  All columns will be included in the analysis.</p>
</td></tr>
<tr><td><code id="gjam_+3A_modellist">modelList</code></td>
<td>
<p><code>list</code> specifying inputs, including <code>ng</code> (number of Gibbs steps), <code>burnin</code>, and <code>typeNames</code>. Can include the number of holdouts for out-of-sample prediction, <code>holdoutN</code>.  See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="gjam_+3A_x">x</code></td>
<td>
<p>object of <code>class <a href="#topic+gjam">gjam</a></code>.</p>
</td></tr>
<tr><td><code id="gjam_+3A_object">object</code></td>
<td>
<p>currently, also an object of <code>class <a href="#topic+gjam">gjam</a></code>.</p>
</td></tr>
<tr><td><code id="gjam_+3A_...">...</code></td>
<td>
<p>further arguments not used here.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>formula</code> begins with <code>~</code>, not <code>y ~</code>.  The response <code>matrix</code> is passed in the form of a <code>n</code> by <code>S</code> matrix or <code>data.frame</code> <code>ydata</code>.  
</p>
<p>Both predictors in <code>xdata</code> and responses in <code>ydata</code> can include missing values as <code>NA</code>. Factors in <code>xdata</code> should be declared using <code>factor</code>.   For computational stability variables that are not factors are standardized by mean and variance, then transformed back to original scales in <code>output</code>.  To retain a variable in its original scale during computation include it in the character string <code>notStandard</code> as part of the <code>list modelList</code>. (example shown in the <code>vignette</code> on traits).  
</p>
<p><code>modelList</code> has these defaults and provides these options:
</p>
<p><code>ng = 2000</code>, number of Gibbs steps.  
</p>
<p><code>burnin = 500</code>, no. initial steps, must be less than <code>ng</code>.  
</p>
<p><code>typeNames</code> can be <code>'PA'</code> (presenceAbsence), <code>'CON'</code> (continuous on <code>(-Inf, Inf)</code>), <code>'CA'</code> (continuous abundance, zero censoring), <code>'DA'</code> (discrete abundance),  <code>'FC'</code> (fractional composition),
<code>'CC'</code> (count composition), <code>'OC'</code> (ordinal counts), <code>'CAT'</code> (categorical classes).  <code>typeNames</code> can be a single value that applies to all columns in <code>ydata</code>, or there can be one value for each column.
</p>
<p><code>holdoutN = 0</code>, number of observations to hold out for out-of-sample
prediction.  
</p>
<p><code>holdoutIndex = numeric(0)</code>, <code>numeric vector</code> of observations (row numbers) to holdout for out-of-sample prediction.  
</p>
<p><code>censor = NULL</code>, <code>list</code> specifying columns, values, and intervals for
censoring, see <code><a href="#topic+gjamCensorY">gjamCensorY</a></code>.
</p>
<p><code>effort = NULL</code>, <code>list</code> containing <code>'columns'</code>, a vector of length <code>&lt;= S</code> giving the names of columns in in <code>y</code>, and <code>'values'</code>, a length-<code>n</code> vector of effort or a <code>n</code> by <code>S</code> matrix (see Examples).  <code>effort</code> can be plot area, search time, etc. for discrete count data <code>'DA'</code>.
</p>
<p><code>FULL = F</code> in <code>modelList</code> will save full prediction chains in <code>$chains$ygibbs</code>.
</p>
<p><code>notStandard = NULL</code>, <code>character vector</code> of column names in <code>xdata</code> that should not be standardized.
</p>
<p><code>reductList = list(N = 20, r = 3)</code>, <code>list</code> of dimension reduction parameters, invoked when <code>reductList</code> is included in <code>modelList</code> or automatically when <code>ydata</code> has too many columns.  See <code>vignette</code> on Dimension Reduction.
</p>
<p><code>random</code>, <code>character</code> string giving the name of a column in <code>xdata</code> that will be used to specify random effects.  The random group column should be declared as a <code>factor</code>.  There should be replication, i.e., each group level occurs multiple times.
</p>
<p><code>REDUCT = F</code> in <code>modelList</code> overrides automatic dimension reduction. 
</p>
<p><code>FCgroups, CCgroups</code>, are length-<code>S vectors</code> assigned to columns in <code>ydata</code> indicating composition <code>'FC'</code> or <code>'CC'</code> group membership.  For example, if there are two 'CA' columns in <code>ydata</code> followed by two groups of fractional composition data, each having three columns, then <code>typeNames = c('CA','CA','FC','FC','FC','FC','FC','FC')</code> and <code>FCgroups = c(0,0,1,1,1,2,2,2)</code>.  note: <code>gjamSimData</code> is not currently set up to simulate multiple composition groups, but <code>gjam</code> will model it.
</p>
<p><code>PREDICTX = T</code> executes inverse prediction of <code>x</code>.  Speed-up by setting <code>PREDICTX = F</code>.
</p>
<p><code>ematAlpha = .5</code> is the probability assigned for conditional and marginal independence in the <code>ematrix</code>.
</p>
<p><code>traitList = list(plotByTrait, traitTypes, specByTrait)</code>, list of trait objects.  See vignette on Trait analysis.
</p>
<p>More detailed vignettes can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>


<h3>Value</h3>

<p>Returns an object of <code><a href="base.html#topic+class">class</a> "gjam"</code>, which is a list containing the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
<tr><td><code>chains</code></td>
<td>
<p><code>list</code> of MCMC matrices, each with <code>ng</code> rows; includes coefficients <code>bgibbs</code>(<code>Q*S</code> columns), <code>bgibbsUn</code> (unstandardized for <code>x</code>), sensitivity <code>fgibbs</code> (<code>Q1</code> columns), and <code>fbgibbs</code> (<code>Q1</code> columns, where <code>Q1 = Q - 1</code>, unless there are multilevel factors); covariance <code>sgibbs</code> has <code>S*(S + 1)/2</code> columns (<code>REDUCT == F</code>) or <code>N*r</code> columns (<code>REDUCT == T</code>).</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p><code>list</code> of diagnostics (<code>DIC, rmspeAll, rmspeBySpec, xscore, yscore</code>).</p>
</td></tr>
<tr><td><code>inputs</code></td>
<td>
<p><code>list</code> of input summaries, including <code>breakMat</code> (partition matrix), <code>classBySpec</code> (interval assignment),  <code>designTable</code> (summary of design matrix), [<code>factorBeta, interBeta, intMat, linFactor</code>] (factor and interaction information), <code>other, notOther</code> (response columns to exclude and not), [<code>standMat, standRows, standX</code>] means and variances to standardize <code>x</code>, [<code>x, xdata, y</code>] cleaned versions of data.</p>
</td></tr>
<tr><td><code>missing</code></td>
<td>
<p><code>list</code> of missing objects, including locations for predictors <code>xmiss</code> and responses <code>ymiss</code> in <code>xdata</code> and <code>ydata</code>, respectively, predictor means <code>xmissMu</code> and standard errors <code>xmissSe</code>, response means <code>ymissMu</code> and standard errors <code>ymissSe</code> .</p>
</td></tr>
<tr><td><code>modelList</code></td>
<td>
<p><code>list</code> of model specifications from input <code>modelList</code>.</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p><code>list</code> of parameter estimates, including coefficient matrices on standardized (<code>betaMu, betaSe</code>), unstandardized  (<code>betaMuUn, betaSeUn</code>), and dimensionless (<code>fBetaMu, fBetaSd</code>) scales; correlation (<code>corMu, corSe</code>) and covariance (<code>sigMu, sigSe</code>) matrices;  sensitivities to predictors (<code>fmatrix, fMu, fSe</code>); environmental response matrix (<code>ematrix</code>), with locations of zero elements, conditionally (<code>whConZero</code>) and marginally (<code>whichZero</code>), set at probability level <code>modelList$ematAlpha</code>); and latent variables (<code>wMu, wSd</code>).</p>
</td></tr>
<tr><td><code>prediction</code></td>
<td>
<p><code>list</code> of predicted values, including species <code>richness</code> (responses predicted &gt; 0); inverse predicted <code>x</code> (<code>xpredMu, xpredSd</code>) and predicted <code>y</code> (<code>ypredMu, ypredSd</code>) matrices. 
</p>
</td></tr>
</table>
<p>If <b>traits</b> are modeled, then <code>parameters</code> will additionally include <code>betaTraitMu</code>, <code>betaTraitSe</code> (coefficients), <code>sigmaTraitMu</code>, <code>sigmaTraitSe</code> (covariance).  <code>prediction</code> will additionally include <code>tMuOrd</code> (ordinal trait means), <code>tMu</code>, <code>tSe</code> (trait predictions).
</p>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs, 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamSimData">gjamSimData</a></code> simulates data
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>website 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## combinations of scales
types &lt;- c('DA','DA','OC','OC','OC','OC','CON','CON','CON','CON','CON','CA','CA','PA','PA')         
f    &lt;- gjamSimData(S = length(types), typeNames = types)
ml   &lt;- list(ng = 500, burnin = 50, typeNames = f$typeNames)
out  &lt;- gjam(f$formula, f$xdata, f$ydata, modelList = ml)
summary(out)

# repeat with ng = 5000, burnin = 500, then plot data:
pl  &lt;- list(trueValues = f$trueValues)
gjamPlot(out, plotPars = pl)

## discrete abundance with heterogeneous effort 
S   &lt;- 5                             
n   &lt;- 1000
eff &lt;- list( columns = 1:S, values = round(runif(n,.5,5),1) )
f   &lt;- gjamSimData(n, S, typeNames='DA', effort=eff)
ml  &lt;- list(ng = 2000, burnin = 500, typeNames = f$typeNames, effort = eff)
out &lt;- gjam(f$formula, f$xdata, f$ydata, modelList = ml)
summary(out)

# repeat with ng = 2000, burnin = 500, then plot data:
pl  &lt;- list(trueValues = f$trueValues)
gjamPlot(out, plotPars = pl)

## End(Not run)
</code></pre>

<hr>
<h2 id='gjam-package'>
Generalized Joint Attribute Modeling
</h2><span id='topic+gjam-package'></span><span id='topic+GJAM'></span>

<h3>Description</h3>

<p>Inference and prediction for jointly distributed responses that 
are combinations of continous and discrete data.  Functions begin with <code>'gjam'</code> to avoid conflicts with other packages.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> gjam</td>
</tr>
<tr>
 <td style="text-align: left;">
  Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 2.6.2</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2022-5-23</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
  URL: </td><td style="text-align: left;"> http://sites.nicholas.duke.edu/clarklab/code/</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>The generalized joint attribute model (gjam) analyzes multivariate data that are combinations of presence-absence, ordinal, continuous, discrete, composition, zero-inflated, and censored.  It does so as a joint distribution over response variables.  gjam provides inference on sensitivity to input variables, correlations between responses on the data scale, model selection, and prediction.  
</p>
<p>Importantly, analysis is done on the observation scale.  That is, coefficients and covariances are interpreted on the same scale as the data.  Contrast this approach with standard Generalized Linear Models, where coefficients and covariances are difficult to interpret and cannot be compared across responses that are modeled on different scales.
</p>
<p>gjam was motivated by species distribution and abundance data in ecology, but can provide an attractive alternative to traditional methods wherever observations are multivariate and combine multiple scales and mixtures of continuous and discrete data.  
</p>
<p>gjam can be used to model ecological trait data, where species traits are translated to locations as community-weighted means and modes.
</p>
<p>Posterior simulation is done by Gibbs sampling.  Analysis is done by these functions, roughly in order of how frequently they might be used:
</p>
<p><code><a href="#topic+gjam">gjam</a></code> fits model with Gibbs sampling.
</p>
<p><code><a href="#topic+gjamSimData">gjamSimData</a></code> simulates data for analysis by <code>gjam</code>.
</p>
<p><code><a href="#topic+gjamPriorTemplate">gjamPriorTemplate</a></code> sets up prior distribution for coefficients.
</p>
<p><code><a href="#topic+gjamSensitivity">gjamSensitivity</a></code> evaluates sensitivity to predictors from <code>gjam</code>.
</p>
<p><code><a href="#topic+gjamCensorY">gjamCensorY</a></code> defines censored values and intervals.
</p>
<p><code><a href="#topic+gjamTrimY">gjamTrimY</a></code> trims the response matrix and aggregates rare types.
</p>
<p><code><a href="#topic+gjamPlot">gjamPlot</a></code> plots output from <code>gjam</code>.
</p>
<p><code><a href="#topic+gjamSpec2Trait">gjamSpec2Trait</a></code> constructs plot by trait matrix.
</p>
<p><code><a href="#topic+gjamPredict">gjamPredict</a></code> does conditional prediction.
</p>
<p><code><a href="#topic+gjamConditionalParameters">gjamConditionalParameters</a></code> obtains the conditional coefficient matrices.
</p>
<p><code><a href="#topic+gjamOrdination">gjamOrdination</a></code> ordinates the response matrix.
</p>
<p><code><a href="#topic+gjamDeZero">gjamDeZero</a></code> de-zeros response matrix for storage.
</p>
<p><code><a href="#topic+gjamReZero">gjamReZero</a></code> recovers response matrix from de-zeroed format.
</p>
<p><code><a href="#topic+gjamIIE">gjamIIE</a></code> evaluates indirect effects and interactions.
</p>
<p><code><a href="#topic+gjamIIEplot">gjamIIEplot</a></code> plots indirect effects and interactions.
</p>
<p><code><a href="#topic+gjamSpec2Trait">gjamSpec2Trait</a></code> generates trait values.
</p>
<p><code><a href="#topic+gjamPoints2Grid">gjamPoints2Grid</a></code> aggregates incidence data to counts on a lattice.
</p>


<h3>Author(s)</h3>

<p>Author: James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>, Daniel Taylor-Rodriquez
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>
<p>Clark, J.S. 2016. Why species tell more about traits than traits tell us about species: Predictive models.  Ecology 97, 1979-1993.
</p>
<p>Taylor-Rodriguez, D., K. Kaufeld, E. M. Schliep, J. S. Clark, and A. E. Gelfand. 2016.  Joint species distribution modeling: dimension eduction using Dirichlet processes.  Bayesian Analysis, 12, 939-967. doi: 10.1214/16-BA1031.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjam">gjam</a></code>, 
<code><a href="#topic+gjamSimData">gjamSimData</a></code>,
<code><a href="#topic+gjamPriorTemplate">gjamPriorTemplate</a></code>,
<code><a href="#topic+gjamSensitivity">gjamSensitivity</a></code>,
<code><a href="#topic+gjamCensorY">gjamCensorY</a></code>, 
<code><a href="#topic+gjamTrimY">gjamTrimY</a></code>, 
<code><a href="#topic+gjamPredict">gjamPredict</a></code>, 
<code><a href="#topic+gjamSpec2Trait">gjamSpec2Trait</a></code>, 
<code><a href="#topic+gjamPlot">gjamPlot</a></code>,
<code><a href="#topic+gjamPredict">gjamPredict</a></code>,
<code><a href="#topic+gjamConditionalParameters">gjamConditionalParameters</a></code>,
<code><a href="#topic+gjamDeZero">gjamDeZero</a></code>,
<code><a href="#topic+gjamReZero">gjamReZero</a></code>
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>

<hr>
<h2 id='gjamCensorY'>Censor gjam response data</h2><span id='topic+gjamCensorY'></span>

<h3>Description</h3>

<p>Returns a <code>list</code> with censored values, intervals, and censored response <code>matrix y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamCensorY(values, intervals, y, type='CA', whichcol = c(1:ncol(y)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamCensorY_+3A_values">values</code></td>
<td>
<p>Values in <code>y</code> that are censored, specified by <code>intervals</code></p>
</td></tr>
<tr><td><code id="gjamCensorY_+3A_intervals">intervals</code></td>
<td>
<p><code>matrix</code> having two rows and one column for each value 
in <code>values</code>. The first row holds lower bounds.  The second row holds
upper bounds.  See <b>Examples</b>.</p>
</td></tr>
<tr><td><code id="gjamCensorY_+3A_y">y</code></td>
<td>
<p>Response <code>matrix</code>, <code>n</code> rows by <code>S</code> columns.  All values within <code>intervals</code> will be replaced with <code>values</code></p>
</td></tr>
<tr><td><code id="gjamCensorY_+3A_type">type</code></td>
<td>
<p>Response type, see <code>typeNames</code> in <code><a href="#topic+gjam">gjam</a></code></p>
</td></tr>
<tr><td><code id="gjamCensorY_+3A_whichcol">whichcol</code></td>
<td>
<p>Columns in <code>y</code> that are censored (often not all responses are
censored)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Any values in <code>y</code> that fall within censored <code>intervals</code> are replaced with censored <code>values</code>.  The example below simulates data collected on an 'octave scale': 0, 1, 2, 4, 8, ..., an approach to accelerate data collection with approximate bins.
</p>


<h3>Value</h3>

<p>Returns a list containing two elements.
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>n by S matrix updated with censored values substituted for
those falling within <code>intervals</code>.</p>
</td></tr>
<tr><td><code>censor</code></td>
<td>
<p><code>list</code> containing <code>$columns</code> that are censored and
<code>$partition</code>, a matrix with 3 rows used in <code><a href="#topic+gjam">gjam</a></code> 
and <code><a href="#topic+gjamPlot">gjamPlot</a></code>, one column per censor interval.  Rows 
are values, followed by lower and upper bounds.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamSimData">gjamSimData</a></code> simulates data
<code><a href="#topic+gjam">gjam</a></code> analyzes data
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>website 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# data in octaves
v  &lt;- up &lt;- c(0, 2^c(0:4), Inf)         
dn &lt;- c(-Inf, v[-length(v)])
i  &lt;- rbind( dn, up )  # intervals

f  &lt;- gjamSimData(n = 2000, S = 15, Q = 3, typeNames='CA')
y  &lt;- f$y
cc &lt;- c(3:6)                                                # censored columns
g  &lt;- gjamCensorY(values = v, intervals = i, y = y, whichcol = cc)
y[,cc] &lt;- g$y                                               # replace columns
ml     &lt;- list(ng = 500, burnin = 100, censor = g$censor, typeNames = f$typeNames)
output &lt;- gjam(f$formula, xdata = f$xdata, ydata = y, modelList = ml)

#repeat with ng = 2000, burnin = 500, then:
pl  &lt;- list(trueValues = f$trueValues, width = 3, height = 3)   
gjamPlot(output, pl)

# upper detection limit
up &lt;- 5
v  &lt;- up
i  &lt;- matrix(c(up,Inf),2)
rownames(i) &lt;- c('down','up')

f   &lt;- gjamSimData(typeNames='CA')   
g   &lt;- gjamCensorY(values = v, intervals = i, y = f$y)
ml  &lt;- list(ng = 500, burnin = 100, censor = g$censor, typeNames = f$typeNames)
out &lt;- gjam(f$formula, xdata = f$xdata, ydata = g$y, modelList = ml)

#repeat with ng = 2000, burnin = 500, then:
pl  &lt;- list(trueValues = f$trueValues, width = 3, height = 3)           
gjamPlot(out, pl)

# lower detection limit
lo        &lt;- .001
values    &lt;- upper &lt;- lo
intervals &lt;- matrix(c(-Inf,lo),2)
rownames(intervals) &lt;- c('lower','upper')

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamConditionalParameters'>Parameters for gjam conditional prediction</h2><span id='topic+gjamConditionalParameters'></span>

<h3>Description</h3>

<p>Conditional parameters quantify the direct effects of predictors including those that come through other species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamConditionalParameters(output, conditionOn, nsim = 2000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamConditionalParameters_+3A_output">output</code></td>
<td>
<p>object of <code><a href="base.html#topic+class">class</a></code> &quot;gjam&quot;.</p>
</td></tr>
<tr><td><code id="gjamConditionalParameters_+3A_conditionon">conditionOn</code></td>
<td>
<p>a <code>character</code> vector of responses to condition on (see <b>Details</b>).</p>
</td></tr>
<tr><td><code id="gjamConditionalParameters_+3A_nsim">nsim</code></td>
<td>
<p>number of draws from the posterior distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Responses in <code>ydata</code> are random with a joint distribution that comes through the residual covariance having mean matrix <code>parameters$sigMu</code> and standard error matrix <code>parameters$sigSe</code>. Still, it can be desirable to use some responses, along with covariates, as predictors of others. The responses (columns) in <code>ydata</code> are partitioned into two groups, a group to condition on (the names included in <code>character vector conditionOn</code>) and the remaining columns. <code>conditionOn</code> gives the names of response variables (<code>colnames</code> for <code>ydata</code>). The conditional distribution is parameterized as the sum of effects that come directly from predictors in <code>xdata</code>, in a matrix <code>C</code>, and from the other responses, i.e., those in <code>conditionOn</code>, a <code>matrix A</code>. A third matrix <code>P</code> holds the conditional covariance. If dimension reduction is used in model fitting, then there will some redundancy in conditional coefficients.
</p>
<p>See examples below.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Amu</code></td>
<td>
<p>posterior mean for matrix <code>A</code>.</p>
</td></tr> 
<tr><td><code>Ase</code></td>
<td>
<p>standard error for matrix <code>A</code>.</p>
</td></tr>
<tr><td><code>Atab</code></td>
<td>
<p>parameter summary for matrix <code>A</code>.</p>
</td></tr>
<tr><td><code>Cmu</code></td>
<td>
<p>posterior mean for matrix <code>C</code>.</p>
</td></tr> 
<tr><td><code>Cse</code></td>
<td>
<p>standard error for matrix <code>C</code>.</p>
</td></tr>
<tr><td><code>Ctab</code></td>
<td>
<p>parameter summary for matrix <code>C</code>.</p>
</td></tr>
<tr><td><code>Pmu</code></td>
<td>
<p>posterior mean for matrix <code>P</code>.</p>
</td></tr> 
<tr><td><code>Pse</code></td>
<td>
<p>standard error for matrix <code>P</code>.</p>
</td></tr>
<tr><td><code>Ptab</code></td>
<td>
<p>parameter summary for matrix <code>P</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Qiu, T., S. Shubhi, C. W. Woodall, and J.S. Clark. 2021. Niche shifts from trees to fecundity to recruitment that determine species response to climate change. Frontiers in Ecology and Evolution 9, 863. 'https://www.frontiersin.org/article/10.3389/fevo.2021.719141'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamSimData">gjamSimData</a></code> simulates data
</p>
<p><code><a href="#topic+gjam">gjam</a></code> fits the model
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>web site 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
f   &lt;- gjamSimData(n = 200, S = 10, Q = 3, typeNames = 'CA') 
ml  &lt;- list(ng = 2000, burnin = 50, typeNames = f$typeNames, holdoutN = 10)
output &lt;- gjam(f$formula, f$xdata, f$ydata, modelList = ml)

# condition on three species
gjamConditionalParameters( output, conditionOn = c('S1','S2','S3') )

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamDeZero'>Compress (de-zero) gjam data</h2><span id='topic+gjamDeZero'></span>

<h3>Description</h3>

<p>Returns a de-zeroed (sparse matrix) version of <code>matrix ymat</code> with objects needed to re-zero it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamDeZero(ymat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamDeZero_+3A_ymat">ymat</code></td>
<td>
<p><code>n</code> by <code>S</code> response <code>matrix</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many abundance data sets are mostly zeros.  <code><a href="#topic+gjamDeZero">gjamDeZero</a></code> extacts non-zero elements for storage.  
</p>


<h3>Value</h3>

<p>Returns a list containing the de-zeroed <code>ymat</code> as a vector <code>yvec</code>.
</p>
<table>
<tr><td><code>yvec</code></td>
<td>
<p>non-zero elements of <code>ymat</code></p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>no. rows of <code>ymat</code> </p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>no. cols of <code>ymat</code> </p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>index for non-zeros</p>
</td></tr>
<tr><td><code>ynames</code></td>
<td>
<p>column names of <code>ymat</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2016.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamReZero">gjamReZero</a></code> to recover <code>ymat</code>
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>website 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(repmis)
source_data("https://github.com/jimclarkatduke/gjam/blob/master/fungEnd.RData?raw=True")

ymat &lt;- gjamReZero(fungEnd$yDeZero)  # OTUs stored without zeros
length(fungEnd$yDeZero$yvec)         # size of stored version
length(ymat)                         # full size
yDeZero &lt;- gjamDeZero(ymat)
length(yDeZero$yvec)                 # recover de-zeroed vector

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamFillMissingTimes'>Fill out data for time series (state-space) gjam</h2><span id='topic+gjamFillMissingTimes'></span>

<h3>Description</h3>

<p>Fills in predictor, response, and effort matrics for time series data where there are multiple multivariate time series.  Time series gjam is here <a href="https://htmlpreview.github.io/?https://github.com/jimclarkatduke/gjam/blob/master/gjamTimeMsVignette.html">https://htmlpreview.github.io/?https://github.com/jimclarkatduke/gjam/blob/master/gjamTimeMsVignette.html</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamFillMissingTimes(xdata, ydata, edata, groupCol, timeCol, groupVars = groupCol,
                                 FILLMEANS = FALSE, typeNames = NULL, missingEffort = .1)
                       
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamFillMissingTimes_+3A_xdata">xdata</code></td>
<td>
<p><code>n by Q data.frame</code> holding predictor variables</p>
</td></tr>
<tr><td><code id="gjamFillMissingTimes_+3A_ydata">ydata</code></td>
<td>
<p><code>n by S matrix</code> holding response variables</p>
</td></tr>
<tr><td><code id="gjamFillMissingTimes_+3A_edata">edata</code></td>
<td>
<p><code>n by S matrix</code> holding effort</p>
</td></tr>
<tr><td><code id="gjamFillMissingTimes_+3A_groupcol">groupCol</code></td>
<td>
<p>column name in <code>xdata</code> for group variable, i.e., observations part of the same time series</p>
</td></tr>
<tr><td><code id="gjamFillMissingTimes_+3A_timecol">timeCol</code></td>
<td>
<p>column name in <code>xdata</code> for time index</p>
</td></tr>
<tr><td><code id="gjamFillMissingTimes_+3A_groupvars">groupVars</code></td>
<td>
<p><code>character vector</code> of column names in <code>xdata</code> having values that are fixed for a value of <code>groupCol</code>, i.e., they do not change with time index in <code>timeCol</code></p>
</td></tr>
<tr><td><code id="gjamFillMissingTimes_+3A_fillmeans">FILLMEANS</code></td>
<td>
<p>fill new rows in <code>ydata</code> with mean for <code>groupCol</code> times <code>missingEffort</code>; otherwise NA</p>
</td></tr>
<tr><td><code id="gjamFillMissingTimes_+3A_typenames">typeNames</code></td>
<td>
<p>typenames current limited to <code>'DA'</code> for discrete counts</p>
</td></tr>
<tr><td><code id="gjamFillMissingTimes_+3A_missingeffort">missingEffort</code></td>
<td>
<p>effort assigned to missing values of <code>edata</code> and <code>ydata</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Missing times in the data occur where there are gaps in <code>timeCol</code> column of <code>xdata</code> and the initial time <code>0</code> for each sequence.  New versions of the data have <code>NA</code> (<code>xdata</code>) or prior values with appropriate weight (<code>ydata</code>).  Missing times are filled in <code>xdata, ydata, edata</code>, including a time <code>0</code> which serves as a prior mean for <code>ydata</code> for time code1.  The group and time indices in columns <code>groupCol</code> and <code>timeCol</code> of <code>xdata</code> reference the time for a given time series.  Missing values in the columns <code>groupVars</code> of <code>xdata</code> are filled automatically filled in.  This assumes that values for these variables are fixed for the group.  If <code>FILLMEANS</code>, the missing  values in <code>ydata</code> are filled with means for the group and given a low weight specified in <code>missingEffort</code>.
</p>


<h3>Value</h3>

<p>A list containing the following:
</p>
<table>
<tr><td><code>xdata</code></td>
<td>
<p>filled version of <code>xdata</code></p>
</td></tr>
<tr><td><code>ydata</code></td>
<td>
<p>filled version of <code>ydata</code></p>
</td></tr>
<tr><td><code>edata</code></td>
<td>
<p>filled version of <code>edata</code></p>
</td></tr>
<tr><td><code>timeList</code></td>
<td>
<p>time indices used for computation, including, <code>timeZero</code> (row numbers in new data where each time series begins, with times = 0), <code>timeLast</code> (row numbers in new data where each time series ends), <code>rowInserts</code> (row numbers for all inserted rows), <code>noEffort</code> (rows for which effort in <code>edata</code> is filled with <code>missingEffort</code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J. S., C. L. Scher, and M. Swift. 2020. The emergent interactions that govern biodiversity change. Proceedings of the National Academy of Sciences, 117, 17074-17083.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjam">gjam</a></code> for more on <code>xdata</code>, <code>ydata</code>, and effort.
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>web site 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>

<hr>
<h2 id='gjamIIE'>Indirect effects and interactions for gjam data</h2><span id='topic+gjamIIE'></span>

<h3>Description</h3>

<p>Evaluates direct, indirect, and interactions from a <code><a href="#topic+gjam">gjam</a></code> object.  Returns a <code>list</code> of objects that can be plotted by <code><a href="#topic+gjamIIEplot">gjamIIEplot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamIIE(output, xvector, MEAN = T, keepNames = NULL, omitY = NULL, 
          sdScaleX = T, sdScaleY = F)
          
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamIIE_+3A_output">output</code></td>
<td>
<p>object of <code><a href="base.html#topic+class">class</a></code> inheriting from &quot;gjam&quot;.</p>
</td></tr>
<tr><td><code id="gjamIIE_+3A_xvector">xvector</code></td>
<td>
<p>vector of predictor values, with names, corresponding to columns in <code>output$x</code>.</p>
</td></tr>
<tr><td><code id="gjamIIE_+3A_mean">MEAN</code></td>
<td>
<p><code>logical</code>, if false, then median used.</p>
</td></tr>
<tr><td><code id="gjamIIE_+3A_omity">omitY</code></td>
<td>
<p><code>character</code> vector of columns in <code>output$y</code> to omit from calculations.</p>
</td></tr>
<tr><td><code id="gjamIIE_+3A_keepnames">keepNames</code></td>
<td>
<p><code>character</code> vector of columns in <code>output$y</code>. If omitted, all columns used.</p>
</td></tr>
<tr><td><code id="gjamIIE_+3A_sdscalex">sdScaleX</code></td>
<td>
<p>standardize coefficients to X scale.</p>
</td></tr>
<tr><td><code id="gjamIIE_+3A_sdscaley">sdScaleY</code></td>
<td>
<p>standardize coefficients to correlation scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For plotting or recovering effects.  The <code>list fit$IIE</code> has matrices for main effects (<code>mainEffect</code>), interactions (<code>intEffect</code>), direct effects (<code>dirEffect</code>), indirect effects (<code>indEffectTo</code>), and standard deviations for each.  The direct effects are the sum of main effects and interactions.  The indirect effects include main effects and interactions that come through other species, determined by covariance matrix <code>sigma</code>.  
</p>
<p>If <code>sdScaleX = T</code> effects are standandardized from the Y/X to Y scale.  This is the typical standardization for predictor variables.  If <code>sdScaleY = T</code> effects are given on the correlation scale.  If both are true effects are dimensionless.  See the gjam vignette on dimension reduction.
</p>


<h3>Value</h3>

<p>A list of objects for plotting by <code><a href="#topic+gjamIIEplot">gjamIIEplot</a></code>.
</p>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2016.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamIIEplot">gjamIIEplot</a></code> plots output from <code>gjamIIE</code>
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>web site 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
sim &lt;- gjamSimData(S = 12, Q = 5, typeNames = 'CA')
ml  &lt;- list(ng = 50, burnin = 5, typeNames = sim$typeNames)
out &lt;- gjam(sim$formula, sim$xdata, sim$ydata, modelList = ml)

xvector &lt;- colMeans(out$inputs$xStand)  #predict at mean values for data
xvector[1] &lt;- 1

fit &lt;- gjamIIE(output = out, xvector)

gjamIIEplot(fit, response = 'S1', effectMu = c('main','ind'), 
            effectSd = c('main','ind'), legLoc = 'topleft')

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamIIEplot'>Plots indirect effects and interactions for gjam data</h2><span id='topic+gjamIIEplot'></span>

<h3>Description</h3>

<p>Using the object returned by <code><a href="#topic+gjamIIEplot">gjamIIEplot</a></code> generates a plot for a response variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamIIEplot(fit, response, effectMu, effectSd = NULL, 
              ylim = NULL, col='black', legLoc = 'topleft', cex = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamIIEplot_+3A_fit">fit</code></td>
<td>
<p>object from <code>gjamIIE</code>.</p>
</td></tr>
<tr><td><code id="gjamIIEplot_+3A_response">response</code></td>
<td>
<p>name of a column in fit$y to plot.</p>
</td></tr>
<tr><td><code id="gjamIIEplot_+3A_effectmu">effectMu</code></td>
<td>
<p>character vector of mean effects to plot, can include <code>'main','int','direct','ind'</code>.</p>
</td></tr>
<tr><td><code id="gjamIIEplot_+3A_effectsd">effectSd</code></td>
<td>
<p>character vector can include all or some of <code>effectMu</code>.</p>
</td></tr>
<tr><td><code id="gjamIIEplot_+3A_ylim">ylim</code></td>
<td>
<p>vector of two values defines vertical axis range.</p>
</td></tr>
<tr><td><code id="gjamIIEplot_+3A_col">col</code></td>
<td>
<p>vector of colors for barplot.</p>
</td></tr>
<tr><td><code id="gjamIIEplot_+3A_legloc">legLoc</code></td>
<td>
<p>character for legend location.</p>
</td></tr>
<tr><td><code id="gjamIIEplot_+3A_cex">cex</code></td>
<td>
<p>font size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For plotting direct effects, interactions, and indirect effects from an object <code>fit</code> generated by <code>gjamIIE</code>.  The character vector supplied as <code>effectMu</code> can include main effects (<code>'main'</code>), interactions (<code>'int'</code>), main effects plus interactions (<code>'direct'</code>), and/or indirect effects (<code>'ind'</code>).  The list <code>effectSd</code> draws 0.95 predictive intervals for all or some of the effects listed in <code>effectM</code>u.  Bars are contributions of each effect to the <code>response</code>.
</p>
<p>For factors, effects are plotted relative to the mean over all factor levels.
</p>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamIIE">gjamIIE</a></code> generates output for <code>gjamIIEplot</code>
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>web site 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
f   &lt;- gjamSimData(S = 10, Q = 6, typeNames = 'OC')
ml  &lt;- list(ng = 50, burnin = 5, typeNames = f$typeNames)
out &lt;- gjam(f$formula, f$xdata, f$ydata, modelList = ml)

xvector &lt;- colMeans(out$inputs$xStand)  #predict at mean values for data, standardized x
xvector[1] &lt;- 1

fit &lt;- gjamIIE(out, xvector)

gjamIIEplot(fit, response = 'S1', effectMu = c('main','ind'), 
            effectSd = c('main','ind'), legLoc = 'topleft')

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamOrdination'>Ordinate gjam data</h2><span id='topic+gjamOrdination'></span>

<h3>Description</h3>

<p>Ordinate data from a gjam object using correlation corresponding to reponse matrix <code>E</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamOrdination(output, specLabs = NULL, col = NULL, cex = 1, 
                 PLOT=T, method = 'PCA')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamOrdination_+3A_output">output</code></td>
<td>
<p>object of <code><a href="base.html#topic+class">class</a></code> &quot;gjam&quot;.</p>
</td></tr>
<tr><td><code id="gjamOrdination_+3A_speclabs">specLabs</code></td>
<td>
<p><code>character vector</code> of variable names in <code>colnames(output$y)</code>.</p>
</td></tr>
<tr><td><code id="gjamOrdination_+3A_col">col</code></td>
<td>
<p><code>character vector</code> of columns in <code>output$y</code> to label in plots.</p>
</td></tr>
<tr><td><code id="gjamOrdination_+3A_cex">cex</code></td>
<td>
<p>text size in plot.</p>
</td></tr>
<tr><td><code id="gjamOrdination_+3A_plot">PLOT</code></td>
<td>
<p><code>logical</code>, if true, draw plots.</p>
</td></tr>
<tr><td><code id="gjamOrdination_+3A_method">method</code></td>
<td>
<p><code>character</code> variable can specify <code>'NMDS'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ordinates the response correlation <code>ematrix</code> contained in <code>output$parameterTables</code>.  If <code>method = 'PCA'</code> returns eigenvalues and eigenvectors.  If <code>method = 'PCA'</code> returns three NMDS dimensions.  If <code>PLOT</code>, then plots will be generated.  Uses principle components analysis or non-metric multidimensional scale (NMDS).
</p>


<h3>Value</h3>

<table>
<tr><td><code>eVecs</code></td>
<td>
 <p><code>S x S</code> or, if there is an <code>other</code> response variable to be excluded,  <code>S-1 x S-1</code> matrix of eigenvectors for species (rows) by eigenvectors (columns).</p>
</td></tr>
<tr><td><code>eValues</code></td>
<td>
<p>If <code>method = 'PCA'</code> returns length-<code>S</code> or, there is an <code>other</code> response variable to be excluded,  length-<code>S-1</code> vector of eigenvalues. If <code>method = 'NMDS'</code> this variable is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjam">gjam</a></code> fits the data
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>website 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
f      &lt;- gjamSimData(S = 30, typeNames = 'CA') 
ml     &lt;- list(ng = 1000, burnin = 200, typeNames = f$typeNames, holdoutN = 10)
output &lt;- gjam(f$formula, f$xdata, f$ydata, modelList = ml)
ePCA   &lt;- gjamOrdination(output, PLOT=TRUE)
eNMDS  &lt;- gjamOrdination(output, PLOT=TRUE, method='NMDS')

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamPlot'>Plot gjam analysis</h2><span id='topic+gjamPlot'></span>

<h3>Description</h3>

<p>Constructs plots of posterior distributions, predictive distributions, 
and additional analysis from output of <code><a href="#topic+gjam">gjam</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamPlot(output, plotPars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamPlot_+3A_output">output</code></td>
<td>
<p>object of <code><a href="base.html#topic+class">class</a></code> &quot;gjam&quot;</p>
</td></tr>
<tr><td><code id="gjamPlot_+3A_plotpars">plotPars</code></td>
<td>
<p><code>list</code> having default values described in <b>Details</b></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plotPars</code> a <code>list</code> that can contain the following, listed with default values:
</p>

<table>
<tr>
 <td style="text-align: left;">
  
    <code>PLOTY = T</code> </td><td style="text-align: left;"> plot predicted <code>y</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
  
    <code>PLOTX = T</code> </td><td style="text-align: left;"> plot inverse predicted <code>x</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code>PREDICTX = T</code> </td><td style="text-align: left;"> inverse prediction of <code>x</code>; does not work if <code>PREDICTX = F</code> in <code>link{gjam}</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
  
    <code>ncluster</code> </td><td style="text-align: left;"> number of clusters to highlight in 
    cluster diagrams, default based on <code>S</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
  
    <code>CORLINES = T</code> </td><td style="text-align: left;"> draw grid lines on grid plots of R and E.</td>
</tr>
<tr>
 <td style="text-align: left;">
  
    <code>cex = 1</code> </td><td style="text-align: left;"> text size for grid plots, see <code><a href="graphics.html#topic+par">par</a></code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
  
    <code>BETAGRID = T</code> </td><td style="text-align: left;"> draw grid of beta coefficients.</td>
</tr>
<tr>
 <td style="text-align: left;">
  
    <code>PLOTALLY = F</code> </td><td style="text-align: left;"> an individual plot for each column in <code>y</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code>SMALLPLOTS = T</code> </td><td style="text-align: left;"> avoids plot margin error on some devices, better appearance if <code>FALSE</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code>GRIDPLOTS = F</code> </td><td style="text-align: left;"> cluster and grid plots derived from parameters; matrices R and E are discussed in Clark et al. (2016).</td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code>SAVEPLOTS = F</code> </td><td style="text-align: left;"> plots saved in pdf format.</td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code>outfolder = 'gjamOutput'</code> </td><td style="text-align: left;"> folder for plot files if <code>SAVEPLOTS = T</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
  
    <code>width, height = 4</code> </td><td style="text-align: left;"> can be small values, in inches, to avoid 
    plot margin error on some devices.</td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code>specColor = 'black'</code> </td><td style="text-align: left;"> color for posterior box-and-whisker plots.</td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code>ematAlpha = .95</code> </td><td style="text-align: left;"> prob threshold used to infer that a covariance value in <code>Emat</code> is not zero.</td>
</tr>
<tr>
 <td style="text-align: left;">
    
    <code>ncluster = 4</code> </td><td style="text-align: left;"> number of clusters to identify in <code>ematrix</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
    
  </td>
</tr>

</table>

<p>The 'plot margin' errors mentioned above are device-dependent.  They can be avoided by specifying small <code>width, height</code> (in inches) and by omitting the grid plots (<code>GRIDPLOTS = F</code>).  If plotting does not produce a 'plot margin error', better appearance is obtained with <code>SMALLPLOTS = F</code>.  
</p>
<p>Names will not be legible for large numbers of species.  Specify <code>specLabs = F</code> and use a character vector for <code>specColor</code> to identify species groups (see the gjam vignette on dimension reduction).
</p>
<p>Box and whisker plots bound 0.68 and 0.95 credible and predictive intervals. 
</p>


<h3>Value</h3>

<p>Summary tables of parameter estimates are:
</p>
<table>
<tr><td><code>betaEstimates</code></td>
<td>
<p>Posterior summary of beta coefficients.</p>
</td></tr>
<tr><td><code>clusterIndex</code></td>
<td>
<p>cluster index for responses in grid/cluster plots.</p>
</td></tr>
<tr><td><code>clusterOrder</code></td>
<td>
<p>order for responses in grid/cluster plots.</p>
</td></tr>
<tr><td><code>eComs</code></td>
<td>
<p>groups based on clustering <code>ematrix</code>.</p>
</td></tr>
<tr><td><code>ematrix</code></td>
<td>
<p><code>S X S</code> response correlation matrix for E.</p>
</td></tr>
<tr><td><code>eValues</code></td>
<td>
<p>eigenvalues of <code>ematrix</code>.</p>
</td></tr>
<tr><td><code>eVecs</code></td>
<td>
<p>eigenvectors of <code>ematrix</code>.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p><code>list</code> containing DIC, score, and rmspe.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjam">gjam</a></code>
A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>website 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## ordinal data
f   &lt;- gjamSimData(S = 15, Q = 3, typeNames = 'OC') 
ml  &lt;- list(ng = 1500, burnin = 500, typeNames = f$typeNames, holdoutN = 10)
out &lt;- gjam(f$formula, f$xdata, f$ydata, modelList = ml)

# repeat with ng = 2000, burnin = 500, then plot data here:
pl  &lt;- list(trueValues = f$trueValues, width=3, height=2)
fit &lt;- gjamPlot(output = out, plotPars = pl)

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamPoints2Grid'>Incidence point pattern to grid counts</h2><span id='topic+gjamPoints2Grid'></span>

<h3>Description</h3>

<p>From point pattern data in (x, y) generates counts on a lattice supplied by the user or specified by lattice size or density.  For analysis in <code><a href="#topic+gjam">gjam</a> as counts (known effort) or count composition (unknown effort) data</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamPoints2Grid(specs, xy, nxy = NULL, dxy = NULL, 
                  predGrid = NULL, effortOnly = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamPoints2Grid_+3A_specs">specs</code></td>
<td>
<p><code>character vector</code> of species names or codes. </p>
</td></tr>
<tr><td><code id="gjamPoints2Grid_+3A_xy">xy</code></td>
<td>
<p><code>matrix</code> with rows = <code>length(specs)</code> and columns for (x, y).</p>
</td></tr>
<tr><td><code id="gjamPoints2Grid_+3A_nxy">nxy</code></td>
<td>
<p>length-2 <code>numeric vector</code> with numbers of points evenly spaced on (x, y).</p>
</td></tr>
<tr><td><code id="gjamPoints2Grid_+3A_dxy">dxy</code></td>
<td>
<p>length-2 <code>numeric vector</code> with distances for points evenly spaced on (x, y).</p>
</td></tr>
<tr><td><code id="gjamPoints2Grid_+3A_predgrid">predGrid</code></td>
<td>
<p><code>matrix</code> with 2 columns for (x, y).</p>
</td></tr>
<tr><td><code id="gjamPoints2Grid_+3A_effortonly">effortOnly</code></td>
<td>
<p><code>logical</code> to return only points where counts are positive (e.g., effort is unknown).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For incidence data with species names <code>specs</code> and locations <code>(x, y)</code> constructs a lattice based a prediction grid <code>predGrid</code>, at a density of <code>(dx, dy)</code>, or with numbers of lattice points <code>(nx, ny)</code>.  If <code>effortOnly = T</code>, returns only points with non-zero values.
</p>
<p>A prediction grid <code>predGrid</code> would be passed when counts by locations of known effort are required or where multiple groups should be assign to the same lattice points.
</p>
<p>The returned <code>gridBySpec</code> can be analyzed in <code><a href="#topic+gjam">gjam</a></code> with known effort as count data <code>"DA"</code> or with unknown effort as count composition data <code>"CC"</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>gridBySpec</code></td>
<td>
<p><code>matrix</code> with rows for grid locations, columns for counts by species.</p>
</td></tr>
<tr><td><code>predGrid</code></td>
<td>
<p><code>matrix</code> with columns for (x, y) and rows matching <code>gridBySpec</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2016.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjam">gjam</a></code>
A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## random data
n  &lt;- 100
s  &lt;- sample( letters[1:3], n, replace = TRUE)
xy &lt;- cbind( rnorm(n,0,.2), rnorm(n,10,2) )

nx &lt;- ny &lt;- 5                                    # uniform 5 X 5 lattice
f  &lt;- gjamPoints2Grid(s, xy, nxy = c(nx, ny))
plot(f$predGrid[,1], f$predGrid[,2], cex=.1, xlim=c(-1,1), ylim=c(0,20),
     xlab = 'x', ylab = 'y')
text(f$predGrid[,1], f$predGrid[,2], rowSums(f$gridBySpec))

dx &lt;- .2                                          # uniform density
dy &lt;- 1.5
g  &lt;- gjamPoints2Grid(s, xy, dxy = c(dx, dy))
text(g$predGrid[,1], g$predGrid[,2], rowSums(g$gridBySpec), col='brown')

p  &lt;- cbind( runif(30, -1, 1), runif(30, 0, 20) ) # irregular lattice
h  &lt;- gjamPoints2Grid(s, xy, predGrid = p)
text(h$predGrid[,1], h$predGrid[,2], rowSums(h$gridBySpec), col='blue')

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamPredict'>Predict gjam data</h2><span id='topic+gjamPredict'></span>

<h3>Description</h3>

<p>Predicts data from a gjam object, including conditional and out-of-sample prediction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamPredict(output, newdata = NULL, y2plot = NULL, ylim = NULL, 
              FULL = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamPredict_+3A_output">output</code></td>
<td>
<p>object of <code><a href="base.html#topic+class">class</a></code> &quot;gjam&quot;.</p>
</td></tr>
<tr><td><code id="gjamPredict_+3A_newdata">newdata</code></td>
<td>
<p>a <code>list</code> of data for prediction, see <b>Details</b>.</p>
</td></tr>
<tr><td><code id="gjamPredict_+3A_y2plot">y2plot</code></td>
<td>
<p><code>character</code> vector of columns in <code>output$y</code> to plot.</p>
</td></tr>
<tr><td><code id="gjamPredict_+3A_ylim">ylim</code></td>
<td>
<p>vector of lower and upper bounds for prediction plot</p>
</td></tr>
<tr><td><code id="gjamPredict_+3A_full">FULL</code></td>
<td>
<p>will return full chains for predictions as <code>output$ychains</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>newdata</code> is not specified, the response is predicted from <code>xdata</code>  as an in-sample prediction. If <code>newdata</code> is specified, prediction is either conditional or out-of-sample. 
</p>
<p>Conditional prediction on a new set of <code>y</code> values is done if <code>newdata</code> includes the <code>matrix ycondData</code>, which holds columns to condition on.  <code>ycondData</code> must be a <code>matrix</code> and have column names matching those in <code>y</code> that it will replace.  <code>ycondData</code> must have at least one column, but fewer than <code>ncol(y)</code> columns.  Columns not included in <code>ycondData</code> will be predicted conditionally. Note that conditional prediction can be erratic if the observations on which the prediction is conditioned are unlikely given the model.
</p>
<p>Alternatively, the <code>list newdata</code> can include a new version of <code>xdata</code> for out-of-sample prediction.  The version of <code>xdata</code> passed in <code>newdata</code> has the columns with the same names and variable types as <code>xdata</code> passed to <code><a href="#topic+gjam">gjam</a></code>.  Note that factor levels must also match those included when fitting the model.  All columns in <code>y</code> will be predicted out-of-sample.  
</p>
<p>For count composition data the effort (total count) is 1000.
</p>
<p>Because there is no out-of-sample effort for <code>'CC'</code> data, values are predicted on the [0, 1] scale.
</p>
<p>See examples below.
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>design matrix.</p>
</td></tr> 
<tr><td><code>sdList</code></td>
<td>
<p><code>list</code> of predictive means and standard errors includes <code>yMu, yPe</code> (predictive mean, SE), <code>wMu, wSe</code> (mean latent states and SEs)</p>
</td></tr>
<tr><td><code>piList</code></td>
<td>
<p>predictive intervals, only generated if <code>length(y) &lt; 10000</code>, includes <code>yLo, yHi</code> (0.025, 0.975) prediction interval, <code>wLo, wHi</code> (0.025, 0.975) for latent states </p>
</td></tr> 
<tr><td><code>prPresent</code></td>
<td>
<p><code>n x S matrix</code> of probabilities of presence</p>
</td></tr>
<tr><td><code>ematrix</code></td>
<td>
<p>effort</p>
</td></tr>
<tr><td><code>ychains</code></td>
<td>
<p>full prediction chains if <code>FULL = T</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2016.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs, 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamSimData">gjamSimData</a></code> simulates data
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>web site 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
S   &lt;- 10
f   &lt;- gjamSimData(n = 200, S = S, Q = 3, typeNames = 'CC') 
ml  &lt;- list(ng = 1500, burnin = 50, typeNames = f$typeNames, holdoutN = 10)
out &lt;- gjam(f$formula, f$xdata, f$ydata, modelList = ml)

# predict data
cols &lt;- c('#018571', '#a6611a')
par(mfrow=c(1,3),bty='n')             
gjamPredict(out, y2plot = colnames(f$ydata)) # predict the data in-sample
title('full sample')

# out-of-sample prediction
xdata     &lt;- f$xdata[1:20,]
xdata[,3] &lt;- mean(f$xdata[,3])     # mean for x[,3]
xdata[,2] &lt;- seq(-2,2,length=20)   # gradient x[,2]
newdata   &lt;- list(xdata = xdata, nsim = 50 )
p1 &lt;- gjamPredict( output = out, newdata = newdata)

# plus/minus 1 prediction SE, default effort = 1000
x2   &lt;- p1$x[,2]
ylim &lt;- c(0, max(p1$sdList$yMu[,1] + p1$sdList$yPe[,1]))
plot(x2, p1$sdList$yMu[,1],type='l',lwd=2, ylim=ylim, xlab='x2',
     ylab = 'Predicted', col = cols[1])
lines(x2, p1$sdList$yMu[,1] + p1$sdList$yPe[,1], lty=2, col = cols[1])
lines(x2, p1$sdList$yMu[,1] - p1$sdList$yPe[,1], lty=2, col = cols[1])

# upper 0.95 prediction error
lines(x2, p1$piList$yLo[,1], lty=3, col = cols[1])
lines(x2, p1$piList$yHi[,1], lty=3, col = cols[1])
title('SE and prediction, Sp 1')

# conditional prediction, assume first species is absent
ydataCond &lt;- out$inputs$y[,1,drop=FALSE]*0                 # set first column to zero
newdata   &lt;- list(ydataCond = ydataCond, nsim=50)
p0        &lt;- gjamPredict(output = out, newdata = newdata)

ydataCond &lt;- ydataCond + 10                                # first column is 10
newdata   &lt;- list(ydataCond = ydataCond, nsim=50)
p1        &lt;- gjamPredict(output = out, newdata = newdata)

s    &lt;- 4         # species chosen at random to compare
ylim &lt;- range( p0$sdList$yMu[,s], p1$sdList$yMu[,s] )
plot(out$inputs$y[,s],p0$sdList$yMu[,s], cex=.2, col=cols[1],
     xlab = 'Observed', ylab = 'Predicted', ylim = ylim)
abline(0,1,lty=2)
points(out$inputs$y[,s],p1$sdList$yMu[,s], cex=.2, col=cols[2])
title('Cond. on 1st Sp')
legend( 'topleft', c('first species absent', 'first species = 10'), 
        text.col = cols, bty = 'n')

# conditional, out-of-sample
n   &lt;- 1000
S   &lt;- 10
f   &lt;- gjamSimData(n = n, S = S, Q = 3, typeNames = 'CA') 

holdOuts &lt;- sort( sample(n, 50) )

xdata &lt;- f$xdata[-holdOuts,] # fitted data
ydata &lt;- f$ydata[-holdOuts,]

xx &lt;- f$xdata[holdOuts,]     # use for prediction
yy &lt;- f$ydata[holdOuts,]

ml  &lt;- list(ng = 2000, burnin = 500, typeNames = f$typeNames)   # fit the non-holdouts
out &lt;- gjam(f$formula, xdata, ydata, modelList = ml)

cdex &lt;- sample(S, 4)        # condition on 4 species
ndex &lt;- c(1:S)[-cdex]       # conditionally predict others

newdata &lt;- list(xdata = xx, ydataCond = yy[,cdex], nsim = 200) # conditionally predict out-of-sample
p2      &lt;- gjamPredict(output = out, newdata = newdata)

par(bty='n', mfrow=c(1,1))
plot( as.matrix(yy[,ndex]), p2$sdList$yMu[,ndex], 
      xlab = 'Observed', ylab = 'Predicted', cex=.3, col = cols[1])
abline(0,1,lty=2)
title('RMSPE')
mspeC &lt;- sqrt( mean(  (as.matrix(yy[,ndex]) - p2$sdList$yMu[,ndex])^2 ) )

#predict unconditionally, out-of-sample
newdata   &lt;- list(xdata = xx, nsim = 200 ) 
p1 &lt;- gjamPredict(out, newdata = newdata)

points( as.matrix(yy[,ndex]), p1$sdList$yMu[,ndex], col=cols[2], cex = .3)
mspeU &lt;- sqrt( mean(  (as.matrix(yy[,ndex]) - p1$sdList$yMu[,ndex])^2 ) )

e1 &lt;- paste( 'cond, out-of-sample =', round(mspeC, 2) )
e2 &lt;- paste( 'uncond, out-of-sample =', round(mspeU, 2) )

legend('topleft', c(e1, e2), text.col = cols, bty = 'n')

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamPriorTemplate'>Prior coefficients for gjam analysis</h2><span id='topic+gjamPriorTemplate'></span>

<h3>Description</h3>

<p>Constructs coefficient matrices for low and high limits on the uniform prior distribution for <code>beta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamPriorTemplate(formula, xdata, ydata, lo = NULL, hi = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamPriorTemplate_+3A_formula">formula</code></td>
<td>
<p>object of class <code>formula</code>, starting with <code>~</code>, matches the <code>formula</code> passed to <code>gjam</code></p>
</td></tr>
<tr><td><code id="gjamPriorTemplate_+3A_xdata">xdata</code></td>
<td>
<p><code>n x Q</code> observation by predictor <code>data.frame</code></p>
</td></tr>
<tr><td><code id="gjamPriorTemplate_+3A_ydata">ydata</code></td>
<td>
<p><code>n x Q</code> observation by response <code>data.frame</code></p>
</td></tr>
<tr><td><code id="gjamPriorTemplate_+3A_lo">lo</code></td>
<td>
<p><code>list</code> of lower limits</p>
</td></tr>
<tr><td><code id="gjamPriorTemplate_+3A_hi">hi</code></td>
<td>
<p><code>list</code> of upper limits</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The prior distribution for a coefficient <code>beta[q,s]</code> for predictor <code>q</code> and response <code>s</code>, is <code>dunif(lo[q,s], hi[q,s])</code>.  <code>gjamPriorTemplate</code> generates these matrices.  The default values are (<code>-Inf, Inf</code>), i.e., all values in <code>lo</code> equal to <code>-Inf</code> and <code>hi</code> equal to <code>Inf</code>.  These templates can be modified by changing specific values in <code>lo</code> and/or <code>hi</code>.  
</p>
<p>Alternatively, desired lower limits can be passed as the <code>list lo</code>, assigned to names in <code>xdata</code> (same limit for all species in <code>ydata</code>), in <code>ydata</code> (same limit for all predictors in <code>xdata</code>), or both, separating names in <code>xdata</code> and <code>ydata</code> by <code>"_"</code>.  The same convention is used for upper limits in <code>hi</code>. 
</p>
<p>These matrices are supplied in as list <code>betaPrior</code>, which is included in <code>modelList</code> passed to <code>gjam</code>.  See examples and <code>browseVignettes('gjam')</code>.
</p>
<p>Note that the informative prior slows computation.
</p>


<h3>Value</h3>

<p>A <code>list</code> containing two matrices.  <code>lo</code> is a <code>Q x S matrix</code> of lower coefficient limits.  <code>hi</code> is a <code>Q x S matrix</code> of upper coefficient limits.  Unless specied in <code>lo</code>, all values in <code>lo = -Inf</code>.  Likewise, unless specied in <code>hi</code>, all values in <code>hiBeta = -Inf</code>.
</p>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjam">gjam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(repmis)
source_data("https://github.com/jimclarkatduke/gjam/blob/master/forestTraits.RData?raw=True")

xdata       &lt;- forestTraits$xdata
plotByTree  &lt;- gjamReZero(forestTraits$treesDeZero) # re-zero
traitTypes  &lt;- forestTraits$traitTypes
specByTrait &lt;- forestTraits$specByTrait

tmp &lt;- gjamSpec2Trait(pbys = plotByTree, sbyt = specByTrait, 
                      tTypes = traitTypes)
tTypes &lt;- tmp$traitTypes
traity &lt;- tmp$plotByCWM
censor &lt;- tmp$censor

formula &lt;- as.formula(~ temp + deficit)
lo &lt;- list(temp_gmPerSeed = 0, temp_dioecious = 0 ) # positive effect on seed size, dioecy
b  &lt;- gjamPriorTemplate(formula, xdata, ydata = traity, lo = lo)

ml &lt;- list(ng=3000, burnin=1000, typeNames = tTypes, censor = censor, betaPrior = b)
out &lt;- gjam(formula, xdata, ydata = traity, modelList = ml)

S   &lt;- ncol(traity)
sc  &lt;- rep('black',S)
sc[colnames(traity) 
pl  &lt;- list(specColor = sc)           
gjamPlot(output = out, plotPars = pl)         

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamReZero'>Expand (re-zero) gjam data</h2><span id='topic+gjamReZero'></span>

<h3>Description</h3>

<p>Returns a re-zeroed <code>matrix y</code> from the de-zeroed vector, a sparse matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamReZero( yDeZero )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamReZero_+3A_ydezero">yDeZero</code></td>
<td>
<p><code>list</code> created by <code><a href="#topic+gjamReZero">gjamReZero</a></code> containing number of rows <code>n</code>, number of columns <code>S</code>, index for non-zeros <code>index</code>, the vector of non-zero values <code>yvec</code>, and the column names <code>ynames</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Many abundance data sets are mostly zeros.  <code>gjamReZero</code> recovers the full matrix from de-zeroed <code>list yDeZero</code> written by <code><a href="#topic+gjamDeZero">gjamDeZero</a></code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>ymat</code></td>
<td>
<p>re-zeroed <code>n</code> by <code>S</code> matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2016.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamDeZero">gjamDeZero</a></code> to de-zero <code>ymat</code>
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>website: 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(repmis)
source_data("https://github.com/jimclarkatduke/gjam/blob/master/fungEnd.RData?raw=True")
ymat &lt;- gjamReZero(fungEnd$yDeZero)  # OTUs stored without zeros
length(fungEnd$yDeZero$yvec)         # size of stored version
length(ymat)                         # full size

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamSensitivity'>Sensitivity coefficients for gjam</h2><span id='topic+gjamSensitivity'></span>

<h3>Description</h3>

<p>Evaluates sensitivity coefficients for full response matrix or subsets of it.
Uses output from <code><a href="#topic+gjam">gjam</a></code>.  Returns a <code>matrix</code> of samples by predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
  gjamSensitivity(output, group = NULL, nsim = 100, PERSPECIES = TRUE)
  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamSensitivity_+3A_output">output</code></td>
<td>
<p>object fitted with <code>gjam</code>.</p>
</td></tr>
<tr><td><code id="gjamSensitivity_+3A_group">group</code></td>
<td>
<p><code>character vector</code> of response-variable names from <code>output$inputs$y</code>.</p>
</td></tr>
<tr><td><code id="gjamSensitivity_+3A_nsim">nsim</code></td>
<td>
<p>number of samples from posterior distribution.</p>
</td></tr>
<tr><td><code id="gjamSensitivity_+3A_perspecies">PERSPECIES</code></td>
<td>
<p>divide variance by number of species in the group</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sensitivity to predictors of entire reponse matrix or a subset of it, identified by the <code>character string group</code>.  The equations for sensitivity are given here:
</p>
<p><code>browseVignettes('gjam')</code>
</p>


<h3>Value</h3>

<p>Returns a <code>nsim</code> by predictor matrix of sensitivities to predictor variables, evaluated by draws from the posterior. Because sensitivities may be compared across groups represented by different numbers of species, <code>PERSPECIES = TRUE</code> returns sensitivity on a per-species basis.
</p>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs, 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamSimData">gjamSimData</a></code> simulates data
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>website 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## combinations of scales
types &lt;- c('DA','DA','OC','OC','OC','OC','CC','CC','CC','CC','CC','CA','CA','PA','PA')         
f    &lt;- gjamSimData(S = length(types), typeNames = types)
ml   &lt;- list(ng = 50, burnin = 5, typeNames = f$typeNames)
out  &lt;- gjam(f$formula, f$xdata, f$ydata, modelList = ml)

ynames &lt;- colnames(f$y)
group  &lt;- ynames[types == 'OC']

full &lt;- gjamSensitivity(out)
cc   &lt;- gjamSensitivity(out, group)

nt &lt;- ncol(full)

ylim &lt;- range(rbind(full, cc))

boxplot( full, boxwex = 0.25,  at = 1:nt - .21, col='blue', log='y',
         ylim = ylim, xaxt = 'n', xlab = 'Predictors', ylab='Sensitivity')
boxplot( cc, boxwex = 0.25, at = 1:nt + .2, col='forestgreen', add=T,
         xaxt = 'n')
axis(1,at=1:nt,labels=colnames(full))
legend('bottomleft',c('full response','CC data'),
       text.col=c('blue','forestgreen'))

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamSimData'>Simulated data for gjam analysis</h2><span id='topic+gjamSimData'></span>

<h3>Description</h3>

<p>Simulates data for analysis by <code><a href="#topic+gjam">gjam</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamSimData(n = 1000, S = 10, Q = 5, x = NULL, nmiss = 0, typeNames, effort = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamSimData_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="gjamSimData_+3A_s">S</code></td>
<td>
<p>Number of response variables (columns) in <code>y</code>, typically less than
<code>n</code></p>
</td></tr>
<tr><td><code id="gjamSimData_+3A_q">Q</code></td>
<td>
<p>Number of predictors (columns) in design matrix <code>x &lt;&lt; n</code></p>
</td></tr>
<tr><td><code id="gjamSimData_+3A_x">x</code></td>
<td>
<p>design <code>matrix</code>, if supplied <code>n</code> and <code>Q</code> will be set to <code>nrow(x)</code> and <code>ncol(x)</code>, respectively</p>
</td></tr>
<tr><td><code id="gjamSimData_+3A_nmiss">nmiss</code></td>
<td>
<p>Number of missing values to in <code>x &lt;&lt; n</code></p>
</td></tr>
<tr><td><code id="gjamSimData_+3A_typenames">typeNames</code></td>
<td>
<p>Character vector of data types, see <b>Details</b></p>
</td></tr>
<tr><td><code id="gjamSimData_+3A_effort">effort</code></td>
<td>
<p>List containing '<code>columns</code>' specifying columns to which
effort applies, and '<code>values</code>', a length-<code>n</code> vector of effort per 
observation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates simulated data and parameters for analysis by <code><a href="#topic+gjam">gjam</a></code>.  Because both parameters and data are stochastic, not all simulations will give good results.   
</p>
<p><code>typeNames</code> can be '<code>PA</code>' (presenceAbsence), '<code>CA</code>'  
(continuous), '<code>DA</code>' (discrete),  '<code>FC</code>' (fractional composition),
'<code>CC</code>' (count composition), '<code>OC</code>' (ordinal counts), and '<code>CAT</code>' (categorical levels).  If more than one <code>'CAT'</code> is included, each defines a multilevel categorical reponse.
One additional type, '<code>CON</code>' (continuous), is not censored at zero by default.  
</p>
<p>If defined as a single <code>character</code> value <code>typeNames</code> applies to all columns in <code>y</code>.  If not, <code>typeNames</code> is length-<code>S</code> <code>character vector</code>, identifying each response by column in <code>y</code>.  If a column <code>'CAT'</code> is included, a random number of levels will be generated, <code>a, b, c, ...</code>.
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>website 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Value</h3>

<table>
<tr><td><code>formula</code></td>
<td>
<p>R formula for model, e.g., <code>~ x1 + x2</code></p>
</td></tr>
<tr><td><code>xdata</code></td>
<td>
<p><code>data.frame</code> includes columns for predictors in the
design matrix</p>
</td></tr>
<tr><td><code>ydata</code></td>
<td>
<p><code>data.frame</code> for the simulated response</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>response as a  <code>n</code> by <code>S</code> <code>matrix</code> as assembled in <code><a href="#topic+gjam">gjam</a></code>.</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p><code>n</code> by <code>S</code> latent states</p>
</td></tr>
<tr><td><code>typeY</code></td>
<td>
<p>vector of data types corresponding to columns in <code>y</code>, see <b>Details</b></p>
</td></tr> 
<tr><td><code>typeNames</code></td>
<td>
<p>vector of data types corresponding to columns in <code>ydata</code></p>
</td></tr> 
<tr><td><code>trueValues</code></td>
<td>
<p>list containing true parameter values <code>beta</code> (regression
coefficients), <code>sigma</code> (covariance matrix), <code>corSpec</code> (correlation 
matrix corresponding to <code>sigma</code>), and <code>cuts</code> (partition matrix for 
ordinal data).</p>
</td></tr>
<tr><td><code>effort</code></td>
<td>
<p> see <b>Arguments</b>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2016.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjam">gjam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## ordinal data, show true parameter values
sim &lt;- gjamSimData(S = 5, typeNames = 'OC')  
sim$ydata[1:5,]                              # example data
sim$trueValues$cuts                          # simulated partition
sim$trueValues$beta                          # coefficient matrix

## continuous data censored at zero, note latent w for obs y = 0
sim &lt;- gjamSimData(n = 5, S = 5, typeNames = 'CA')  
sim$w
sim$y

## continuous and discrete data
types &lt;- c(rep('DA',5), rep('CA',4))
sim   &lt;- gjamSimData(n = 10, S = length(types), Q = 4, typeNames = types)
sim$typeNames
sim$ydata
                             
## composition count data  
sim &lt;- gjamSimData(n = 10, S = 8, typeNames = 'CC')
totalCount &lt;- rowSums(sim$ydata)
cbind(sim$ydata, totalCount)  # data with sample effort

## multiple categorical responses - compare matrix y and data.frqme ydata
types &lt;- rep('CAT',2)
sim   &lt;- gjamSimData(S = length(types), typeNames = types)
head(sim$ydata)
head(sim$y)

## discrete abundance, heterogeneous effort 
S   &lt;- 5
n   &lt;- 1000
ef  &lt;- list( columns = 1:S, values = round(runif(n,.5,5),1) )
sim &lt;- gjamSimData(n, S, typeNames = 'DA', effort = ef)
sim$effort$values[1:20]

## combinations of scales, partition only for 'OC' columns
types &lt;- c('OC','OC','OC','CC','CC','CC','CC','CC','CA','CA','PA','PA')
sim   &lt;- gjamSimData(S = length(types), typeNames = types)
sim$typeNames                           
head(sim$ydata)
sim$trueValues$cuts

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamSpec2Trait'>Ecological traits for gjam analysis</h2><span id='topic+gjamSpec2Trait'></span>

<h3>Description</h3>

<p>Constructs community-weighted mean-mode (CWMM) trait matrix for analysis with <code><a href="#topic+gjam">gjam</a></code> for <code>n</code> observations, <code>S</code> species, <code>P</code> traits, and <code>M</code> total trait levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamSpec2Trait(pbys, sbyt, tTypes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamSpec2Trait_+3A_pbys">pbys</code></td>
<td>
<p><code>n x S</code> plot by species matrix (presence-absence, abundance)</p>
</td></tr>
<tr><td><code id="gjamSpec2Trait_+3A_sbyt">sbyt</code></td>
<td>
<p><code>S x P</code> species by trait matrix</p>
</td></tr>
<tr><td><code id="gjamSpec2Trait_+3A_ttypes">tTypes</code></td>
<td>
<p><code>P</code> data types for trait columns</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generates the objects needed for a trait response model (TRM).  As inputs the <code>sbyt</code> <code>data.frame</code> has <code>P</code> columns containing numeric values, ordinal scores, and categorical variables, identified by data type in <code>tTypes</code>.  Additional trait columns can appear in the <code>n x M</code> output <code>matrix plotByCWMM</code>, because each level of a category becomes a new <code>'FC'</code> column as a CWMM.  Thus, <code>M</code> can exceed <code>P</code>, depending on the number of factors in <code>sbyt</code>. The exception is for categorical traits with only two levels, which can be treated as (0, 1) censored <code>'CA'</code> data.
</p>
<p>As output, the CWMM data types are given in <code>traitTypes</code>.  
</p>
<p>The list <code>censor = NULL</code> unless some data types are censored.  In the example below there are two censored columns.
</p>
<p>A detailed vignette on trait analysis is obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>


<h3>Value</h3>

<table>
<tr><td><code>plotByCWM</code></td>
<td>
<p><code>n x M matrix</code> of community-weight means (numeric) or modes (ordinal)</p>
</td></tr>
<tr><td><code>traitTypes</code></td>
<td>
<p><code>character vector</code> of data types for traits</p>
</td></tr>
<tr><td><code>specByTrait</code></td>
<td>
<p><code>S x M matrix</code> translates species to traits</p>
</td></tr>
<tr><td><code>censor</code></td>
<td>
<p><code>list</code> of censored columns, values, and intervals; see <code><a href="#topic+gjamCensorY">gjamCensorY</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S. 2016. Why species tell us more about traits than traits tell us about species: Predictive models. Ecology 97, 1979-1993.
</p>
<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017.  Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data.  Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjam">gjam</a></code>, <code><a href="#topic+gjamCensorY">gjamCensorY</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(repmis)
source_data("https://github.com/jimclarkatduke/gjam/blob/master/forestTraits.RData?raw=True")

xdata       &lt;- forestTraits$xdata
plotByTree  &lt;- gjamReZero(forestTraits$treesDeZero) # re-zero
traitTypes  &lt;- forestTraits$traitTypes
specByTrait &lt;- forestTraits$specByTrait

tmp &lt;- gjamSpec2Trait(pbys = plotByTree, sbyt = specByTrait, 
                      tTypes = traitTypes)
tTypes &lt;- tmp$traitTypes
traity &lt;- tmp$plotByCWM
censor &lt;- tmp$censor

ml  &lt;- list(ng=2000, burnin=500, typeNames = tTypes, censor = censor)
out &lt;- gjam(~ temp + stdage + deficit, xdata, ydata = traity, modelList = ml)
gjamPlot( output = out )         

## End(Not run)
</code></pre>

<hr>
<h2 id='gjamTrimY'>Trim gjam response data</h2><span id='topic+gjamTrimY'></span>

<h3>Description</h3>

<p>Returns a <code>list</code> that includes a subset of columns in <code>y</code>.  Rare species can be aggregated into a single class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gjamTrimY(y, minObs = 2, maxCols = NULL, OTHER = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gjamTrimY_+3A_y">y</code></td>
<td>
<p><code>n</code> by <code>S</code> numeric response <code>matrix</code></p>
</td></tr>
<tr><td><code id="gjamTrimY_+3A_minobs">minObs</code></td>
<td>
<p>minimum number of non-zero observations</p>
</td></tr>
<tr><td><code id="gjamTrimY_+3A_maxcols">maxCols</code></td>
<td>
<p>maximum number of response variables</p>
</td></tr>
<tr><td><code id="gjamTrimY_+3A_other">OTHER</code></td>
<td>
<p><code>logical</code> or <code>character</code> string.  If <code>OTHER = TRUE</code>, rare species are aggregated in a new column <code>'other'</code>.  A <code>character</code> vector contains the names of columns in <code>y</code> to be aggregated with rare species in the new column <code>'other'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data sets commonly have many responses that are mostly zeros, large numbers of rare species, even singletons.  Response matrix <code>y</code> can be trimmed to include only taxa having <code>&gt; minObs</code> non-zero observations or to <code>&lt;= maxCol</code> total columns.  The option <code>OTHER</code> is recommended for composition data ('CC', 'FC'), where the <code>'other'</code> column is taken as the reference class.  If there are unidentified species they might be included in this class.  [See <code><a href="#topic+gjamSimData">gjamSimData</a></code> for <code>typeName</code> codes].  
</p>


<h3>Value</h3>

<p>Returns a <code>list</code> containing three elements.
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>trimmed version of <code>y</code>.</p>
</td></tr>
<tr><td><code>colIndex</code></td>
<td>
<p>length-<code>S vector</code> of indices for new columns in <code>y</code>.</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>number of non-zero observations by column in <code>y</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James S Clark, <a href="mailto:jimclark@duke.edu">jimclark@duke.edu</a>
</p>


<h3>References</h3>

<p>Clark, J.S., D. Nemergut, B. Seyednasrollah, P. Turner, and S. Zhang. 2017. 
Generalized joint attribute modeling for biodiversity analysis: Median-zero, multivariate, multifarious data. Ecological Monographs 87, 34-56.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gjamSimData">gjamSimData</a></code> simulates data
<code><a href="#topic+gjam">gjam</a></code> analyzes data
</p>
<p>A more detailed vignette is can be obtained with:
</p>
<p><code>browseVignettes('gjam')</code>
</p>
<p>web site 'http://sites.nicholas.duke.edu/clarklab/code/'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(repmis)
source_data("https://github.com/jimclarkatduke/gjam/blob/master/forestTraits.RData?raw=True")

y   &lt;- gjamReZero(fungEnd$yDeZero)     # re-zero data
dim(y)
y   &lt;- gjamTrimY(y, minObs = 200)$y    # species in &gt;= 200 observations
dim(y)
tail(colnames(y))    # last column is 'other'

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
