<!DOCTYPE html><html><head><title>Help for package mind</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mind}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#benchSAE'><p>Benchmark for SAE</p></a></li>
<li><a href='#data_s'>
<p>Synthetic sample dataset for Multivatiate Linear Mixed Model</p></a></li>
<li><a href='#mind.unit'><p>Fitting Unit level Multivariate Linear Mixed Model</p></a></li>
<li><a href='#predict.mind'><p>Predict method for Multivariate Linear Mixed Model</p></a></li>
<li><a href='#univ'>
<p>Synthetic population dataset for Multivatiate Linear Mixed Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Model Based Inference for Domains</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0), data.table, MASS, Matrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr,stats, JWileymisc, tm, methods</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows users to produce estimates and MSE for multivariate variables using Linear Mixed Model. The package follows the approach of Datta, Day and Basawa (1999) &lt;<a href="https://doi.org/10.1016%2FS0378-3758%2898%2900147-5">doi:10.1016/S0378-3758(98)00147-5</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://joinup.ec.europa.eu/software/page/eupl">EUPL</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Michele D'Alo' [aut],
  Stefano Falorsi [aut],
  Andrea Fasulo [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrea Fasulo &lt;fasulo@istat.it&gt;</td>
</tr>
<tr>
<td>BuildResaveData:</td>
<td>best</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-27 10:55:43 UTC; fasul</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-27 11:32:36 UTC</td>
</tr>
</table>
<hr>
<h2 id='benchSAE'>Benchmark for SAE</h2><span id='topic+benchSAE'></span>

<h3>Description</h3>

<p>Benchmarked values based on ratio adjustment of the SAE estimates</p>


<h3>Usage</h3>

<pre><code class='language-R'>benchSAE(estim_sae,benchmark_area,area,name_dom,estimator,Nest)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="benchSAE_+3A_estim_sae">estim_sae</code></td>
<td>
<p>a data frame containing the arguments <code>area</code>, <code>name_dom</code>, <code>estimator</code> and <code>Nest</code></p>
</td></tr>
<tr><td><code id="benchSAE_+3A_benchmark_area">benchmark_area</code></td>
<td>
<p>a data frame identifing the area to be benchmarked among with the benchmark value</p>
</td></tr>
<tr><td><code id="benchSAE_+3A_area">area</code></td>
<td>
<p>character, identified the name of the area to be benchmarked</p>
</td></tr>
<tr><td><code id="benchSAE_+3A_name_dom">name_dom</code></td>
<td>
<p>character, identified the name of the domains</p>
</td></tr>
<tr><td><code id="benchSAE_+3A_estimator">estimator</code></td>
<td>
<p>vector, contain the name of the estimates to be benchmarked</p>
</td></tr>
<tr><td><code id="benchSAE_+3A_nest">Nest</code></td>
<td>
<p>character, identified the name of the total population size for domain</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>benchSAE</code> function allows (i) to benchmark more than one SAE estimates at times and (ii) to  specified the broadarea to be benchmarked, from the national level to a more disaggregated level. 
</p>


<h3>Value</h3>

<p><code>benchSAE</code> produces a <code>data.frame</code> with a column of domain indicator and set of columns (as specified in <code>estimator</code>) of benchmarked point predictions.
</p>


<h3>Author(s)</h3>

<p>Developed by Michele  D'Alò
</p>


<h3>References</h3>

<p>Datta,G. S., Ghosh, M., Steorts, R. and Maples, J. (2010) Bayesian benchmarking with applications to small area estimation. Test, 20, 574–588.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example data

data(data_s);data(univ)

tot&lt;-aggregate(tot~dom+pro,univ,sum)
  
# One random effect at domain level


  formula&lt;-as.formula(cbind(emp,unemp,inact)~(1|mun)+
                        factor(sexage)+factor(edu)+factor(fore))
  
# Drop from the universe data frame variables not referenced in the formula or in the broadarea

  univ_1&lt;-univ[,-6]

# Estimate mind model benchmarking the unemployment variable

  example.1&lt;-mind.unit(formula=formula,dom="dom",data=data_s,universe=univ_1,MSE=FALSE)
  SAEest&lt;-example.1$EBLUP[,c(1,3)]
  SAEest&lt;-merge(SAEest,tot)
  SAEest$unemp&lt;-SAEest$unemp/SAEest$tot
  bench&lt;-data.frame(pro=c(10,11),bb=c(0.27,0.31))
  
# Benchmark the unemployment point estimates
  
  SAEest_bench&lt;-benchSAE(estim_sae=SAEest,
                          benchmark_area=bench,
                          area="pro",
                          name_dom="dom",
                          estimator="unemp",
                          Nest="tot")

</code></pre>

<hr>
<h2 id='data_s'>
Synthetic sample dataset for Multivatiate Linear Mixed Model
</h2><span id='topic+data_s'></span>

<h3>Description</h3>

<p>Synthetic data frame containing a sample of 9962 individuals along with socio-economic indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_s)
</code></pre>


<h3>Format</h3>

<p>A data frame with 9962 observations on 10 variables:
</p>

<dl>
<dt><code>dom</code></dt><dd><p>domain of interest codes, corresponding to the munipal codes</p>
</dd>
<dt><code>emp</code></dt><dd><p>binary variable, 1 for employed 0 otherwise</p>
</dd>
<dt><code>unemp</code></dt><dd><p>binary variable, 1 for unemployed 0 otherwise</p>
</dd>              <dt><code>inact</code></dt><dd><p>binary variable, 1 for inactive 0 otherwise</p>
</dd>
<dt><code>sexage</code></dt><dd><p>cross classification of age and sex</p>
</dd>
<dt><code>edu</code></dt><dd><p>educational level</p>
</dd>
<dt><code>fore</code></dt><dd><p>binary variable, 2 for foreigner 1 otherwise</p>
</dd>
<dt><code>mun</code></dt><dd><p>municipal codes</p>
</dd>
<dt><code>pro</code></dt><dd><p>provincial codes</p>
</dd>
<dt><code>occ_stat</code></dt><dd><p>occupational status, 1 for employed 2 for unemployed 3 for inactive</p>
</dd>
</dl>



<h3>Details</h3>

<p>The informations on the sample unit are the same collected in the syntethic population dataframe <a href="#topic+univ">univ</a> appart from the information on the occupational status that are present only for the sample units.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example data
data(data_s)
summary(data_s)
</code></pre>

<hr>
<h2 id='mind.unit'>Fitting Unit level Multivariate Linear Mixed Model</h2><span id='topic+mind.unit'></span>

<h3>Description</h3>

<p><code>mind.unit</code> is used to fit unit level multivariate linear mixed models [D'Alo', Falorsi 2021, FAO 2021]. It can be used to carry out different estimators (EBLUP, Synthetic and Projection) and the Mean Squared Error (MSE) for unplanned domain, analysis of the random effect and study of the variance components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mind.unit(formula,dom,data,universe,weights=NA,broadarea=NA,
max_iter=200,max_diff=1e-05,phi_u0=0.05,MSE=TRUE,REML=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mind.unit_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot;: a symbolic description of the model to be fitted. The details of model specification are given under 'Details'.</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_dom">dom</code></td>
<td>
<p>numeric, the domain of interest.  See also 'Details'.</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model, e.g. <code><a href="#topic+data_s">data_s</a></code>.</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_universe">universe</code></td>
<td>
<p>a data frame containing the complete list of the units belonging to the target population, along with the corresponding values of the auxiliary variables. Also an aggregated version of the universe information is possible, e.g. <code><a href="#topic+univ">univ</a></code>. See also 'Details'.</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_weights">weights</code></td>
<td>
<p>an optional column of weights to be used in the fitting process. Should be NULL or a numeric vector. If non-NULL, weighted least squares is used with weights; otherwise ordinary least squares is used. See also 'Details'.</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_broadarea">broadarea</code></td>
<td>
<p>an optional character to be used if a broadarea is required in the model. See also 'Details'.</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_max_iter">max_iter</code></td>
<td>
<p>integer scalar. Numeber of maximum iteration for the optimization of the REML criterion (default=200) .</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_max_diff">max_diff</code></td>
<td>
<p>double number. Stopping criteria to be satisfied to achieve the REML convergence (defualt=1e-05).</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_phi_u0">phi_u0</code></td>
<td>
<p>double number. Initialization value for the ratio among the variance components effect and the variance of the errors [Saei, Chambers 2003] (defualt=0.05)</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_mse">MSE</code></td>
<td>
<p>logical scalar. Should the MSE be computed (defualt=TRUE)?</p>
</td></tr>
<tr><td><code id="mind.unit_+3A_reml">REML</code></td>
<td>
<p>logical scalar. Should the estimates be chosen to optimize the REML criterion (as opposed to the maximum-likelihood)?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A typical predictor for a Multivariate Linear Mixed Model has the form <code>responses ~ random.terms+fixed.terms</code> where <code>responses</code> is the multivariate response, <code>random.terms</code> is a series of terms which specifies random intercept and <code>fixed.terms</code> is a series of terms which specified a linear predictor for <code>responses</code>.
<br /> The <code>responses</code> can be specified as a column (so the <code>responses</code> have m different values as the modalities are) or as a m-column with the columns giving the presence and absence of the modalities (using <code>cbind</code> function).
<br /> The <code>random.terms</code> in the formula will be re-ordered when both domain and marginal effect are presents so that domain effects come first, followed by the marginal. The <code>random.terms</code> must be <code>numeric</code> varaibles.
<br /> In the actual version of <code>mind</code> (i) only qualitative <code>fixed.terms</code> are allowed.
</p>
<p>The mandatory argument <code>dom</code> must be numeric and must not contain any missing value (NA).
</p>
<p>The mandatory argument <code>universe</code> is a <code>data.frame</code> conteining the auxiliary information referenced in the <code>formula</code> for each unit of the population of interest.
<br /> For computational reason it is possible use an aggregated version of the population information using the profile derived by the <code>random.terms</code> and <code>fixed.terms</code>. In this case a column equal to the summation of the population units for each profile is required.
<br /> See <a href="#topic+univ">univ</a> for more details.
</p>
<p>Non<code>-NULL weights</code> can be used to indicate that different observations have different variances. If no <code>weights</code> are specified all the units have an unitary weight. If specified must be present in <code>data</code>.
</p>
<p><code>broadarea</code> represents the grupping factor specifying the partitioning of the data. If non<code>-NULL broadarea</code> is includes different <code>mind.unit</code> fits should be performed according to <code>broadarea</code>. Must be present in <code>universe</code>.
</p>


<h3>Value</h3>

<p><code>mind.unit</code> returns an object of class &quot;<code>mind</code>&quot;. The object is a list contains 13 objects:
</p>
<table>
<tr><td><code>EBLUP</code></td>
<td>
<p>a data frame containing for the domain of interest the EBLUP estimates [Rao, Molina 2015] for the m-modalities  of the responce variable.</p>
</td></tr>
<tr><td><code>PROJ</code></td>
<td>
<p>a data frame containing for the domain of interest the Projection estimates [Kim, Rao 2011] for the m-modalities of the responce variables.</p>
</td></tr>
<tr><td><code>SYNTH</code></td>
<td>
<p>a data frame containing for the domain of interest the Synthetic estimates [Rao, Molina 2015] for the m-modalities of the responce variable.</p>
</td></tr>
<tr><td><code>mse_EBLUP</code></td>
<td>
<p>a data frame containing for the domain of interest the MSE, along with the single components G1, G2 and G3, for the EBLUP estimator for the m-modalities of the variables of interest.</p>
</td></tr>
<tr><td><code>cv_EBLUP</code></td>
<td>
<p>a data frame containing the coefficent of variation for the EBLUP estimator for the m-modalities of the variable of interest.</p>
</td></tr>
<tr><td><code>Nd</code></td>
<td>
<p>a data frame with the total population of the domain of interest.</p>
</td></tr>
<tr><td><code>nd</code></td>
<td>
<p>a data frame with the sample size of the sampled domain of interest.</p>
</td></tr>
<tr><td><code>r_effect</code></td>
<td>
<p>a list containing the random effects for each modes of the <code>responses</code> and for each <code>broadarea</code> (if any).</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>a data frame with named columns of coefficents.</p>
</td></tr>
<tr><td><code>mod_performance</code></td>
<td>
<p>a list containing fit indices, absolute error metrics, tests of overall model significance (taking into account only the <code>fixed.terms</code>) for each modes of the <code>responses</code> and for each <code>broadarea</code> (if any).</p>
</td></tr>
<tr><td><code>sigma_e</code></td>
<td>
<p>a data frame with the residuals standard deviation <code class="reqn">\sigma_e</code> for each modes of the <code>responses</code> and for each <code>broadarea</code> (if any).</p>
</td></tr>
<tr><td><code>sigma_u</code></td>
<td>
<p>a data frame with the random effects standard deviation <code class="reqn">\sigma_u</code> for each modes of the <code>responses</code>, for each random effect and for each <code>broadarea</code> (if any).</p>
</td></tr>
<tr><td><code>ICC</code></td>
<td>
<p>a data frame with the Intraclass Coefficent Correlation for each modes of the <code>responses</code>, for each random effect and and for each <code>broadarea</code> (if any).
The population ICC in this framework is:
</p>
<p style="text-align: center;"><code class="reqn">ICC = \frac{\sigma_u^2}{(\sigma_u^2+\sigma_e^2)}</code>
</p>

<p>This ICC can be generalized to allow for covariate effects, in which case the ICC is interpreted as capturing the within-class similarity of the covariate-adjusted data values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Developed by Michele D'Alo', Stefano Falorsi,  Andrea Fasulo
</p>


<h3>References</h3>

<p>Battese, G., E., Harter, R., M., Fuller, W., A., (1988). 'An Error-Components Model for Prediction of County Crop Areas Using Survey and
Satellite Data', Journal of the American Statistical Association Vol. 83, No. 401 (Mar., 1988), pp. 28-36.
</p>
<p>Datta, G., S., Day, B., Basawa, I., (1999). 'Empirical best linear unbiased and empirical Bayes prediction in multivariate small area estimation', Journal of Statistical Planning and Inference, Volume 75, Issue 2, 1 January 1999, Pages 269-279
</p>
<p>D'Alo', M., Falorsi, S., Fasulo, A., (2021). 'MIND, an R package for multivariate small area
estimation with multiple random effects', SAE2021 BIG4small. Book of short papers, Pages 43-48
</p>
<p>ESSnet on SAE, (2012). 'Guidelines for the application of the small area estimation methods in NSI sample surveys'
</p>
<p>FAO (2021). 'Guidelines on data disaggregation for SDG Indicators using survey data', pp. 105. http://www.fao.org/publications/card/en/c/CB3253EN/
</p>
<p>Harmening, S., Kreutzmann, A.K., Pannier, S., Salvati, N., Schmid, T., (2021). 'A Framework for Producing Small Area Estimates Based on Area-Level Models in R, The R package emdi vignette'
</p>
<p>Kim, J. K., Rao, J. N., (2011). 'Combining data from two independent surveys: a model-assisted approach', Biometrika 99(1), 85100.
</p>
<p>Rao, J.N., Molina, I., (2015). 'Small Area Estimation', John Wiley &amp; Sons
</p>
<p>Saei, A., Chambers, R., (2003). 'Small Area Estimation Under Linear and Generalized Linear Mixed Models With Time and Area Effects', S3RI Methodology Working Paper M03/15
</p>


<h3>See Also</h3>

<p><a href="#topic+predict.mind">predict.mind</a> has examples of fitting multivariate variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example data
data(data_s);data(univ)

# The sample units cover 104 over 333 domains in the population data frame
length(unique(data_s$dom));length(unique(univ$dom))

## Example 1
# One random effect at domain level
# Double possible formulations
formula&lt;-as.formula(occ_stat~(1|mun)+
factor(sexage)+factor(edu)+factor(fore))
#or
formula&lt;-as.formula(cbind(emp,unemp,inact)~(1|mun)+
factor(sexage)+factor(edu)+factor(fore))

# Drop from the universe data frame variables not referenced in the formula or in the broadarea
univ_1&lt;-univ[,-6]

example.1&lt;-mind.unit(formula=formula,dom="dom",data=data_s,universe=univ_1)
summary(example.1$EBLUP)
rm(univ_1)

## Example 2
# One random effect for a marginal domain
formula&lt;-as.formula(occ_stat~(1|pro)+factor(sexage)+factor(edu)+factor(fore))

# Drop from the universe data frame variables not referenced in the formula or in the broadarea
univ_2&lt;-univ[,-5]

example.2&lt;-mind.unit(formula=formula,dom="dom",data=data_s,universe=univ_2)
summary(example.2$EBLUP)
rm(univ_2)

## Example 3
# Two random effects both at domain level and marginal level
formula&lt;-as.formula(occ_stat~(1|mun)+(1|pro)+
factor(sexage)+factor(edu)+factor(fore))

example.3&lt;-mind.unit(formula=formula,dom="dom",data=data_s,universe=univ)
summary(example.3$EBLUP)

## Example 4
# One random effect at domain level and with broadarea
formula&lt;-as.formula(occ_stat~(1|mun)+factor(edu)+factor(fore))

# Drop from the universe data frame variables not referenced in the formula or in the broadarea
univ_4&lt;-univ[,-2]

example.4&lt;-mind.unit(formula=formula,dom="dom",data=data_s,universe=univ_4,broadarea="pro")
summary(example.4$EBLUP)
rm(univ_4)

</code></pre>

<hr>
<h2 id='predict.mind'>Predict method for Multivariate Linear Mixed Model</h2><span id='topic+predict.mind'></span>

<h3>Description</h3>

<p>Predicted values based on Multivariate Linear Mixed Model object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mind'
predict(object,data,type= "proj",dir_s=NULL,dir_cov=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mind_+3A_object">object</code></td>
<td>
<p>an object of class &quot;<code>mind</code>&quot;</p>
</td></tr>
<tr><td><code id="predict.mind_+3A_data">data</code></td>
<td>
<p>an object in which to look with which to predict.</p>
</td></tr>
<tr><td><code id="predict.mind_+3A_type">type</code></td>
<td>
<p>the type of prediction required. ; the predictors type are the <code>"eblup"</code>, <code>"proj"</code> and <code>"synth"</code>.The default to <code>"proj"</code>.</p>
</td></tr>
<tr><td><code id="predict.mind_+3A_dir_s">dir_s</code></td>
<td>
<p>optionally, if <code>type</code> is equal to <code>eblup</code>  a data frame with the count for each modalities of the responce variable for the covariate patterns must be provided.</p>
</td></tr>
<tr><td><code id="predict.mind_+3A_dir_cov">dir_cov</code></td>
<td>
<p>optionally, if <code>type</code> is equal to <code>eblup</code>  a data frame with the sample units count for the covariate patterns must be provided.</p>
</td></tr>
<tr><td><code id="predict.mind_+3A_...">...</code></td>
<td>
<p>arguments based from or to other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predict.mind</code> produces predicted values, obtained by means the regression parameters on the frame <code>data</code>.
In the actual version of <code>predict.mind</code> only unit level predictions are provided. If the type is equal to <code>proj</code> or  <code>synth</code> a data.frame with individual predictions for all the modalities of the responce variable will be produced. When the <code>eblup</code> predictor is chosen two more input data.frame must be provided and the function will produce predictions for all the profiles identified by the cross-classification of the domains and covariate patterns.
</p>


<h3>Value</h3>

<p>When the predictor type is set equal to <code>proj</code> or <code>synth</code> the <code>predict.mind</code> produces a <code>data.frame</code> of predictions with the columns name equal to the multivariate <code>responses</code>. If the predictor type is <code>eblup</code> a data frame with predictions for all the profile (cross-clafficiation of domain of interest and coavariate patterns) is provided.
</p>


<h3>Author(s)</h3>

<p>Developed by Andrea Fasulo
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load example data
data(data_s);data(univ)

# The sample units cover 104 over 333 domains in the population data frame
length(unique(data_s$dom));length(unique(univ$dom))


# One random effect at domain level
formula&lt;-as.formula(cbind(emp,unemp,inact)~(1|mun)+
factor(sexage)+factor(edu)+factor(fore))

# Drop from the universe data frame variables not referenced in the formula or in the broadarea
univ_1&lt;-univ[,-6]

example.1&lt;-mind.unit(formula=formula,dom="dom",data=data_s,universe=univ_1)

## Example 1
#Projection predictions
example.1.predict&lt;-predict.mind(object=example.1,data=univ,type= "proj")

# Check if the sum of the unit level predictions at 
# domain level are equal to the mind.unit Projection predictions
ck&lt;-cbind(univ,example.1.predict)
ck&lt;-aggregate(cbind(emp,unemp,inact)~dom,ck,sum)
head(ck);head(example.1$PROJ)

## Example 2
#Synthetic predictions
example.1.synth&lt;-predict.mind(object=example.1,data=univ,type="synth")
  
# Check if the sum of the unit level predictions at 
# domain level are equal to the mind.unit Synthetic predictions
ck&lt;-cbind(univ,example.1.synth)
ck&lt;-aggregate(cbind(emp,unemp,inact)~dom,ck,sum)
head(ck);head(example.1$SYNTH)

## Example 3
#EBLUP predictions
inp_1&lt;-aggregate(cbind(emp,unemp,inact)~dom+mun+sexage + edu + fore,data_s,sum)
  
inp_2&lt;-aggregate(emp+unemp+inact~dom+mun+sexage+edu +fore,data_s,sum)
  
example.1.eblup&lt;-predict.mind(object=example.1,data=univ_1,type="eblup",dir_s=inp_1,dir_cov=inp_2)
  
# Check if the sum of the predictions at 
# profile level are equal to the mind.unit Eblup predictions
ck&lt;-aggregate(cbind(emp,unemp,inact)~dom,example.1.eblup,sum)
head(ck);head(example.1$EBLUP)


</code></pre>

<hr>
<h2 id='univ'>
Synthetic population dataset for Multivatiate Linear Mixed Model</h2><span id='topic+univ'></span>

<h3>Description</h3>

<p>Synthetic population data frame containing the complete list of the units belonging to the target population along with the corresponding values of the auxiliary variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(univ)
</code></pre>


<h3>Format</h3>

<p>A data frame with 514320 observations on 7 variables:
</p>

<dl>
<dt><code>dom</code></dt><dd><p>domain of interest codes</p>
</dd>
<dt><code>sexage</code></dt><dd><p>cross classification of age and sex</p>
</dd>
<dt><code>edu</code></dt><dd><p>educational level</p>
</dd>
<dt><code>fore</code></dt><dd><p>bynary variable, 2 for foreigner 1 otherwise</p>
</dd>
<dt><code>mun</code></dt><dd><p>municipal codes</p>
</dd>
<dt><code>pro</code></dt><dd><p>provincial codes</p>
</dd>
<dt><code>tot</code></dt><dd><p>column of 1</p>
</dd>
</dl>



<h3>Details</h3>

<p>The informations on the population are the same collected in the syntethic sample <a href="#topic+data_s">data_s</a> appart from the information on the occupational status that are present only for the sample units.
</p>
<p><code><a href="#topic+mind.unit">mind.unit</a></code> allows to use a data frame of known population totals based on the marginal distribution of the profile identified by the auxiliary variables (See 'Examples').
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

# Load example data
data(data_s);data(univ)
summary(univ)


formula&lt;-as.formula(occ_stat~(1|pro)+factor(sexage)+factor(edu)+factor(fore))

# Drop from the universe data frame variables not referenced in the formula or in the broadarea
univ_1&lt;-univ[,-5]

# 1) Estimation using the complete list of the unit beloging the target population:
example.1&lt;-mind.unit(formula=formula,dom="dom",data=data_s,universe=univ_1)
rm(univ_1)

# Creation of the know population totals object:
univ_ag&lt;-aggregate(tot~-1+factor(dom)+factor(pro)+
factor(sexage)+factor(edu)+factor(fore),univ,sum)
colnames(univ_ag)&lt;-c("dom","pro","sexage","edu","fore","tot")

# Set all variables as numeric.
#Remember that only the domains codes and the random terms must to be numeric variables.
univ_ag &lt;- mutate_all(univ_ag, function(x) as.numeric(as.character(x)))

# 2) Estimation using the know population totals (totals in univ_ag) :
example.2&lt;-mind.unit(formula=formula,dom="dom",data=data_s,universe=univ_ag)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
