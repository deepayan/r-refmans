<!DOCTYPE html><html lang="en"><head><title>Help for package oneinfl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {oneinfl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dEdq_nb'><p>Compute Partial Derivatives of Expected Values for a One-inflated Zero-truncated Negative Binomial Model</p></a></li>
<li><a href='#dEdq_nb_noinfl'><p>Compute Partial Derivatives of Expected Values for Zero-truncated Negative Binomial Model</p></a></li>
<li><a href='#dEdq_pois'><p>Compute Partial Derivatives of Expected Values for a One-Inflated Positive Poisson Model</p></a></li>
<li><a href='#dEdq_pois_noinfl'><p>Compute Partial Derivatives of Expected Values for a Positive Poisson Model</p></a></li>
<li><a href='#E_negbin'><p>Expected Value for One-Inflated Zero-Truncated Negative Binomial Distribution</p></a></li>
<li><a href='#E_negbin_noinfl'><p>Expected Value for Zero-Truncated Negative Binomial Distribution</p></a></li>
<li><a href='#E_pois'><p>Expected Value for One-Inflated Poisson Distribution</p></a></li>
<li><a href='#E_pois_noinfl'><p>Expected Value for Positive Poisson Distribution</p></a></li>
<li><a href='#makeXZy'><p>Prepare Design Matrices and Response Vector</p></a></li>
<li><a href='#margins'><p>Compute Marginal Effects for One-inflated models</p></a></li>
<li><a href='#oneinfl'><p>One-Inflated Regression Model</p></a></li>
<li><a href='#oneLRT'><p>Likelihood Ratio Test for Nested Models</p></a></li>
<li><a href='#oneplot'><p>Plot Observed Data and Model Predictions</p></a></li>
<li><a href='#oneWald'><p>Wald Test for One-Inflation</p></a></li>
<li><a href='#pred'><p>Generate Predicted Frequencies for Models</p></a></li>
<li><a href='#predict.oneinflmodel'><p>Predicted Expected Response for One-Inflated or Truncated Models</p></a></li>
<li><a href='#predict.truncmodel'><p>Predicted Expected Response for One-Inflated or Truncated Models</p></a></li>
<li><a href='#roipp'><p>Generate Random Counts from a One-Inflated Poisson Process</p></a></li>
<li><a href='#roiztnb'><p>Generate Random Counts from a One-Inflated Zero-Truncated Negative Binomial Process</p></a></li>
<li><a href='#rpp'><p>Generate Random Counts from a Zero-Truncated Poisson Process</p></a></li>
<li><a href='#signifWald'><p>Wald Test for Significance of a Predictor Variable</p></a></li>
<li><a href='#summary.oneinflmodel'><p>Summarize One-Inflated Regression Models</p></a></li>
<li><a href='#summary.truncmodel'><p>Summarize Truncated Regression Models</p></a></li>
<li><a href='#truncreg'><p>Truncated Regression Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimates OIPP and OIZTNB Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Ryan T. Godwin [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ryan T. Godwin &lt;ryan.godwin@umanitoba.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates one-inflated positive Poisson (OIPP) and
    one-inflated zero-truncated negative binomial (OIZTNB) regression
    models. A suite of ancillary statistical tools are also provided,
    including: estimation of positive Poisson (PP) and zero-truncated
    negative binomial (ZTNB) models; marginal effects and their standard
    errors; diagnostic likelihood ratio and Wald tests; plotting;
    predicted counts and expected responses; and random variate
    generation. The models and tools, as well as four applications, are
    shown in Godwin, R. T. (2024). "One-inflated zero-truncated count
    regression models" arXiv preprint &lt;<a href="https://doi.org/10.48550%2FarXiv.2402.02272">doi:10.48550/arXiv.2402.02272</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-15 05:05:46 UTC; ryang</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-15 05:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dEdq_nb'>Compute Partial Derivatives of Expected Values for a One-inflated Zero-truncated Negative Binomial Model</h2><span id='topic+dEdq_nb'></span>

<h3>Description</h3>

<p>This internal function computes the partial derivatives of expected values
for a one-inflated zero-truncated negative binomial regression model with respect to covariates.
It also accounts for marginal effects of dummy variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dEdq_nb(b, g, a, X, Z, dummies, formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dEdq_nb_+3A_b">b</code></td>
<td>
<p>Numeric vector of coefficients for the rate parameter.</p>
</td></tr>
<tr><td><code id="dEdq_nb_+3A_g">g</code></td>
<td>
<p>Numeric vector of coefficients for the inflation process.</p>
</td></tr>
<tr><td><code id="dEdq_nb_+3A_a">a</code></td>
<td>
<p>Numeric scalar, the overdispersion parameter of the negative binomial distribution.</p>
</td></tr>
<tr><td><code id="dEdq_nb_+3A_x">X</code></td>
<td>
<p>Matrix of predictors for the main model, where rows correspond to observations
and columns to covariates.</p>
</td></tr>
<tr><td><code id="dEdq_nb_+3A_z">Z</code></td>
<td>
<p>Matrix of predictors for the inflation process, structured similarly to <code>X</code>.</p>
</td></tr>
<tr><td><code id="dEdq_nb_+3A_dummies">dummies</code></td>
<td>
<p>Character vector of column names from <code>X</code> and <code>Z</code> that are considered
dummy variables for which marginal effects need to be computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs the following tasks:
</p>

<ul>
<li><p> Computes partial derivatives of expected values with respect to covariates in <code>X</code> and <code>Z</code>.
</p>
</li>
<li><p> Handles marginal effects for dummy variables by comparing expected values when the dummy
variable is set to 0 versus 1.
</p>
</li></ul>

<p>The function is designed for internal use in the package and assumes that all input matrices
and vectors are correctly specified. Any unexpected input structure may result in errors.
</p>


<h3>Value</h3>

<p>A matrix of partial derivatives (or marginal effects) with rows corresponding to observations
and columns to covariates. For dummy variables, marginal effects are calculated directly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E_negbin">E_negbin</a></code> for expected values in the negative binomial model.
</p>

<hr>
<h2 id='dEdq_nb_noinfl'>Compute Partial Derivatives of Expected Values for Zero-truncated Negative Binomial Model</h2><span id='topic+dEdq_nb_noinfl'></span>

<h3>Description</h3>

<p>This internal function calculates the partial derivatives of expected values
for a regular truncated negative binomial regression model with respect to covariates.
It also adjusts for marginal effects of dummy variables when specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dEdq_nb_noinfl(b, a, X, dummies, formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dEdq_nb_noinfl_+3A_b">b</code></td>
<td>
<p>Numeric vector of coefficients for the regression model.</p>
</td></tr>
<tr><td><code id="dEdq_nb_noinfl_+3A_a">a</code></td>
<td>
<p>Numeric scalar, the overdispersion parameter of the negative binomial distribution.</p>
</td></tr>
<tr><td><code id="dEdq_nb_noinfl_+3A_x">X</code></td>
<td>
<p>Matrix of predictors for the model, where rows correspond to observations
and columns to covariates.</p>
</td></tr>
<tr><td><code id="dEdq_nb_noinfl_+3A_dummies">dummies</code></td>
<td>
<p>Character vector of column names from <code>X</code> that are considered
dummy variables for which marginal effects need to be computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs the following tasks:
</p>

<ul>
<li><p> Computes partial derivatives of expected values with respect to covariates in <code>X</code>.
</p>
</li>
<li><p> Adjusts for marginal effects of dummy variables by altering their values in the design matrix
and computing the difference in expected values.
</p>
</li></ul>

<p>It is designed for internal use and assumes correct input structure. Improper inputs may result
in errors or unexpected behavior.
</p>


<h3>Value</h3>

<p>A matrix of partial derivatives (or marginal effects) with rows corresponding to observations
and columns to covariates. Marginal effects for dummy variables are calculated by contrasting
expected values when the dummy variable is set to 0 versus 1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E_negbin_noinfl">E_negbin_noinfl</a></code> for computing expected values in the regular truncated negative binomial model.
</p>

<hr>
<h2 id='dEdq_pois'>Compute Partial Derivatives of Expected Values for a One-Inflated Positive Poisson Model</h2><span id='topic+dEdq_pois'></span>

<h3>Description</h3>

<p>This internal function calculates the partial derivatives of expected values
for a one-inflated Poisson regression model with respect to covariates.
It also computes marginal effects for specified dummy variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dEdq_pois(b, g, X, Z, dummies, formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dEdq_pois_+3A_b">b</code></td>
<td>
<p>Numeric vector of coefficients for the main Poisson model.</p>
</td></tr>
<tr><td><code id="dEdq_pois_+3A_g">g</code></td>
<td>
<p>Numeric vector of coefficients for the one-inflation process.</p>
</td></tr>
<tr><td><code id="dEdq_pois_+3A_x">X</code></td>
<td>
<p>Matrix of predictors for the main Poisson model, where rows correspond
to observations and columns to covariates.</p>
</td></tr>
<tr><td><code id="dEdq_pois_+3A_z">Z</code></td>
<td>
<p>Matrix of predictors for the one-inflation process, structured similarly to <code>X</code>.</p>
</td></tr>
<tr><td><code id="dEdq_pois_+3A_dummies">dummies</code></td>
<td>
<p>Character vector of column names from <code>X</code> and <code>Z</code> that are treated
as dummy variables for which marginal effects are computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function:
</p>

<ul>
<li><p> Computes partial derivatives of expected values with respect to covariates in <code>X</code> and <code>Z</code>.
</p>
</li>
<li><p> Handles marginal effects for dummy variables by modifying their values in the design matrices
and computing the difference in expected values.
</p>
</li></ul>

<p>It is designed for internal use and assumes correct input structure. Improper inputs may result
in errors or unexpected behavior.
</p>


<h3>Value</h3>

<p>A matrix of partial derivatives (or marginal effects) with rows corresponding to observations
and columns to covariates. For dummy variables, marginal effects are calculated by contrasting
expected values when the dummy is set to 0 versus 1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E_pois">E_pois</a></code> for computing expected values in the one-inflated Poisson model.
</p>

<hr>
<h2 id='dEdq_pois_noinfl'>Compute Partial Derivatives of Expected Values for a Positive Poisson Model</h2><span id='topic+dEdq_pois_noinfl'></span>

<h3>Description</h3>

<p>This internal function calculates the partial derivatives of expected values
for a positive Poisson regression model with respect to covariates.
It also computes marginal effects for specified dummy variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dEdq_pois_noinfl(b, X, dummies, formula)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dEdq_pois_noinfl_+3A_b">b</code></td>
<td>
<p>Numeric vector of coefficients for the Poisson model.</p>
</td></tr>
<tr><td><code id="dEdq_pois_noinfl_+3A_x">X</code></td>
<td>
<p>Matrix of predictors for the Poisson model, where rows correspond
to observations and columns to covariates.</p>
</td></tr>
<tr><td><code id="dEdq_pois_noinfl_+3A_dummies">dummies</code></td>
<td>
<p>Character vector of column names from <code>X</code> that are treated
as dummy variables for which marginal effects are computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function:
</p>

<ul>
<li><p> Computes partial derivatives of expected values with respect to covariates in <code>X</code>.
</p>
</li>
<li><p> Handles marginal effects for dummy variables by modifying their values in the design matrix
and computing the difference in expected values.
</p>
</li></ul>

<p>It is designed for internal use and assumes correct input structure. Improper inputs may result
in errors or unexpected behavior.
</p>


<h3>Value</h3>

<p>A matrix of partial derivatives (or marginal effects) with rows corresponding to observations
and columns to covariates. Marginal effects for dummy variables are calculated by contrasting
expected values when the dummy is set to 0 versus 1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+E_pois_noinfl">E_pois_noinfl</a></code> for computing expected values in the positive Poisson model.
</p>

<hr>
<h2 id='E_negbin'>Expected Value for One-Inflated Zero-Truncated Negative Binomial Distribution</h2><span id='topic+E_negbin'></span>

<h3>Description</h3>

<p>Computes the expected value from a one-inflated, zero-truncated negative binomial (OIZTNB) distribution.
This function calculates the expected value based on the model parameters and covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E_negbin(b, g, a, X, Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="E_negbin_+3A_b">b</code></td>
<td>
<p>Numeric vector of coefficients for the main model.</p>
</td></tr>
<tr><td><code id="E_negbin_+3A_g">g</code></td>
<td>
<p>Numeric vector of coefficients for the one-inflation process.</p>
</td></tr>
<tr><td><code id="E_negbin_+3A_a">a</code></td>
<td>
<p>Numeric scalar, the overdispersion parameter of the negative binomial distribution.</p>
</td></tr>
<tr><td><code id="E_negbin_+3A_x">X</code></td>
<td>
<p>Matrix of predictors for the main model, where rows correspond to observations
and columns to covariates.</p>
</td></tr>
<tr><td><code id="E_negbin_+3A_z">Z</code></td>
<td>
<p>Matrix of predictors for the one-inflation process, structured similarly to <code>X</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of expected values for each observation in the dataset.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dEdq_nb">dEdq_nb</a></code> for computing partial derivatives of expected values in the OIZTNB model.
</p>

<hr>
<h2 id='E_negbin_noinfl'>Expected Value for Zero-Truncated Negative Binomial Distribution</h2><span id='topic+E_negbin_noinfl'></span>

<h3>Description</h3>

<p>Computes the expected value from a zero-truncated negative binomial (ZTNB) distribution
based on the model parameters and covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E_negbin_noinfl(b, a, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="E_negbin_noinfl_+3A_b">b</code></td>
<td>
<p>Numeric vector of coefficients for the regression model.</p>
</td></tr>
<tr><td><code id="E_negbin_noinfl_+3A_a">a</code></td>
<td>
<p>Numeric scalar, the overdispersion parameter of the negative binomial distribution.</p>
</td></tr>
<tr><td><code id="E_negbin_noinfl_+3A_x">X</code></td>
<td>
<p>Matrix of predictors for the model, where rows correspond to observations
and columns to covariates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of expected values for each observation in the dataset.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dEdq_nb_noinfl">dEdq_nb_noinfl</a></code> for computing partial derivatives of expected values in the ZTNB model.
</p>

<hr>
<h2 id='E_pois'>Expected Value for One-Inflated Poisson Distribution</h2><span id='topic+E_pois'></span>

<h3>Description</h3>

<p>Computes the expected value from a one-inflated Poisson (OIPP) distribution
based on the model parameters and covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E_pois(b, g, X, Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="E_pois_+3A_b">b</code></td>
<td>
<p>Numeric vector of coefficients for the main Poisson model.</p>
</td></tr>
<tr><td><code id="E_pois_+3A_g">g</code></td>
<td>
<p>Numeric vector of coefficients for the one-inflation process.</p>
</td></tr>
<tr><td><code id="E_pois_+3A_x">X</code></td>
<td>
<p>Matrix of predictors for the main Poisson model, where rows correspond
to observations and columns to covariates.</p>
</td></tr>
<tr><td><code id="E_pois_+3A_z">Z</code></td>
<td>
<p>Matrix of predictors for the one-inflation process, structured similarly to <code>X</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of expected values for each observation in the dataset.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dEdq_pois">dEdq_pois</a></code> for computing partial derivatives of expected values in the OIPP model.
</p>

<hr>
<h2 id='E_pois_noinfl'>Expected Value for Positive Poisson Distribution</h2><span id='topic+E_pois_noinfl'></span>

<h3>Description</h3>

<p>Computes the expected value from a Poisson (PP) distribution based on the model parameters and covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>E_pois_noinfl(b, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="E_pois_noinfl_+3A_b">b</code></td>
<td>
<p>Numeric vector of coefficients for the Poisson model.</p>
</td></tr>
<tr><td><code id="E_pois_noinfl_+3A_x">X</code></td>
<td>
<p>Matrix of predictors for the Poisson model, where rows correspond
to observations and columns to covariates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of expected values for each observation in the dataset.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dEdq_pois_noinfl">dEdq_pois_noinfl</a></code> for computing partial derivatives of expected values in the Poisson model.
</p>

<hr>
<h2 id='makeXZy'>Prepare Design Matrices and Response Vector</h2><span id='topic+makeXZy'></span>

<h3>Description</h3>

<p>Processes a model formula and a data frame to generate design matrices (<code>X</code> and <code>Z</code>)
and a response vector (<code>y</code>) for regression models, including support for complex
formulas with <code>|</code> operators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeXZy(formula, df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeXZy_+3A_formula">formula</code></td>
<td>
<p>A symbolic description of the model, where the left-hand side specifies
the response variable and the right-hand side specifies predictors.
Formulas can include a <code>|</code> operator to separate predictors for different components of a model.</p>
</td></tr>
<tr><td><code id="makeXZy_+3A_df">df</code></td>
<td>
<p>A data frame containing the variables specified in the formula.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function processes the formula to extract and construct:
</p>

<ul>
<li> <p><code>X</code>: The main design matrix.
</p>
</li>
<li> <p><code>Z</code>: A secondary design matrix (if a <code>|</code> operator is used in the formula, separating components).
</p>
</li>
<li> <p><code>y</code>: The response variable.
</p>
</li></ul>

<p>It handles cases where the formula specifies:
</p>

<ul>
<li><p> Only the main component (e.g., <code>y ~ x1 + x2</code>).
</p>
</li>
<li><p> A secondary component using the <code>|</code> operator (e.g., <code>y ~ x1 + x2 | z1 + z2</code>).
</p>
</li></ul>



<h3>Value</h3>

<p>A list containing the following components:
</p>

<dl>
<dt><code>X</code></dt><dd><p>A design matrix for the main predictors.</p>
</dd>
<dt><code>Z</code></dt><dd><p>A design matrix for additional predictors (e.g., for a secondary process in
a two-component model).</p>
</dd>
<dt><code>y</code></dt><dd><p>The response vector extracted from the formula.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="stats.html#topic+model.matrix">model.matrix</a></code>, <code><a href="stats.html#topic+model.frame">model.frame</a></code>, <code><a href="stats.html#topic+model.response">model.response</a></code>
</p>

<hr>
<h2 id='margins'>Compute Marginal Effects for One-inflated models</h2><span id='topic+margins'></span>

<h3>Description</h3>

<p>This wrapper function calls a different function to calculate marginal effects depending on the model type.
The marginal effects of the variables are evaluated at specified points, such as the sample means or averages, or at custom-defined cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>margins(model, df, at = "AE", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="margins_+3A_model">model</code></td>
<td>
<p>An object representing a fitted model. Must be of class <code>oneinflmodel</code> or <code>truncmodel</code>.</p>
</td></tr>
<tr><td><code id="margins_+3A_df">df</code></td>
<td>
<p>A <code>data.frame</code> containing the dataset used to fit the model. The variables in the data must match those used in the model.</p>
</td></tr>
<tr><td><code id="margins_+3A_at">at</code></td>
<td>
<p>A character string or list specifying where to evaluate the marginal effects:
</p>

<ul>
<li> <p><code>"AE"</code>: Average Effect (marginal effect averaged over all data points; default).
</p>
</li>
<li> <p><code>"EM"</code>: Effect at Means (marginal effect evaluated at the sample means of the data).
</p>
</li>
<li><p> A named list: A custom case specifying representative values for variables.
</p>
</li></ul>
</td></tr>
<tr><td><code id="margins_+3A_verbose">verbose</code></td>
<td>
<p>Logical; if <code>TRUE</code> (default), prints the summary output. If <code>FALSE</code>, suppresses output table and returns a list containing several components.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes marginal effects for zero-truncated Poisson or negative binomial regression models.
It handles different model types; <code>oneinflmodel</code> for one-inflated models, and <code>truncmodel</code> for standard count models.
The marginal effects are evaluated at either all data points and averaged (<code>AE</code>, the default), at the sample means of the variables (<code>EM</code>), or at a custom case.
The marginal effects for dummy variables are actually the differences in expected outcomes for values of the dummy of 1 and 0.
The marginal effects are displayed along with their statistical significance, evaluated based on the chosen <code>at</code> parameter.
</p>


<h3>Value</h3>

<p>If <code>verbose=TRUE</code> (default), prints the marginal effects, their standard errors, z-values, p-values, and significance levels.
</p>
<p>If <code>verbose=FALSE</code>, returns a list containing the following components:
</p>

<dl>
<dt><code>where</code></dt><dd><p>A description of how the marginal effects have been evaluated.</p>
</dd>
<dt><code>dEdq</code></dt><dd><p>The marginal effect. The partial derivative of the expected count with respect to a variable <code>q</code> in the <code>X</code> and or <code>Z</code> matrix, or the difference in expectation if <code>q</code> is binary.</p>
</dd>
<dt><code>se</code></dt><dd><p>The standard errors of the marginal effects evaluated numerically and using a Jacobian via the delta method.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+dEdq_nb">dEdq_nb</a></code>, <code><a href="#topic+dEdq_nb_noinfl">dEdq_nb_noinfl</a></code>, <code><a href="#topic+dEdq_pois">dEdq_pois</a></code>,
<code><a href="#topic+dEdq_pois_noinfl">dEdq_pois_noinfl</a></code>, <code><a href="stats.html#topic+model.frame">model.frame</a></code>,
<code><a href="stats.html#topic+model.matrix">model.matrix</a></code>, <code><a href="stats.html#topic+numericDeriv">numericDeriv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(x = rnorm(100), z = rnorm(100), y = rpois(100, lambda = 5))
model &lt;- oneinfl(y ~ x | z, df = df, dist = "Poisson")
margins(model, df, at = "AE") # Average Effect
margins(model, df, at = "EM", verbose=FALSE) # Effect at Means, suppress printing
margins(model, df, at = list(x = 1, z = 0)) # Custom case

</code></pre>

<hr>
<h2 id='oneinfl'>One-Inflated Regression Model</h2><span id='topic+oneinfl'></span>

<h3>Description</h3>

<p>Fits a one-inflated positive Poisson (OIPP) or one-inflated zero-truncated negative binomial (OIZTNB) regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oneinfl(formula, df, dist = "negbin", start = NULL, method = "BFGS")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oneinfl_+3A_formula">formula</code></td>
<td>
<p>A symbolic description of the model to be fitted. Variables before the pipe <code>|</code> link to the usual Poisson rate parameter, after the pipe link to the one-inflation parameter.</p>
</td></tr>
<tr><td><code id="oneinfl_+3A_df">df</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="oneinfl_+3A_dist">dist</code></td>
<td>
<p>A character string specifying the distribution to use. Options are <code>"Poisson"</code> or <code>"negbin"</code>.</p>
</td></tr>
<tr><td><code id="oneinfl_+3A_start">start</code></td>
<td>
<p>Optional. A numeric vector of starting values for the optimization process. Defaults to <code>NULL</code>, in which case starting values are attempted to be chosen automatically.</p>
</td></tr>
<tr><td><code id="oneinfl_+3A_method">method</code></td>
<td>
<p>A character string specifying the optimization method to be passed to <code><a href="stats.html#topic+optim">optim</a></code>. Defaults to <code>"BFGS"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a regression model for one-inflated counts. One-inflated models are used when there are an excess number of ones, relative to a Poisson or negative binomial process.
</p>
<p>The function supports two distributions:
</p>

<ul>
<li> <p><code>"Poisson"</code>: One-inflated Poisson regression.
</p>
</li>
<li> <p><code>"negbin"</code>: One-inflated negative binomial regression.
</p>
</li></ul>

<p>The function uses numerical optimization via <code><a href="stats.html#topic+optim">optim</a></code> to estimate the parameters.
</p>


<h3>Value</h3>

<p>An object of class <code>"oneinflmodel"</code> containing the following components:
</p>

<dl>
<dt><code>beta</code></dt><dd><p>Estimated coefficients for the rate component of the model.</p>
</dd>
<dt><code>gamma</code></dt><dd><p>Estimated coefficients for the one-inflation component of the model.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>Dispersion parameter (only for negative binomial distribution).</p>
</dd>
<dt><code>vc</code></dt><dd><p>Variance-covariance matrix of the estimated parameters.</p>
</dd>
<dt><code>logl</code></dt><dd><p>Log-likelihood of the fitted model.</p>
</dd>
<dt><code>avgw</code></dt><dd><p>Average one-inflation probability.</p>
</dd>
<dt><code>absw</code></dt><dd><p>Mean absolute one-inflation probability.</p>
</dd>
<dt><code>dist</code></dt><dd><p>The distribution used for the model (&quot;Poisson&quot; or &quot;negbin&quot;).</p>
</dd>
<dt><code>formula</code></dt><dd><p>The formula used for the model.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code> for summarizing the fitted model.
<code><a href="#topic+margins">margins</a></code> for calculating the marginal effects of regressors.
<code><a href="#topic+oneWald">oneWald</a></code> to test for no one-inflation.
<code><a href="#topic+signifWald">signifWald</a></code> for testing the joint significance of a single regressor that appears before and after the pipe <code>|</code>.
<code><a href="#topic+oneplot">oneplot</a></code> for plotting actual and predicted counts.
<code><a href="stats.html#topic+predict">predict</a></code> for expected response/dependent variable at each observation.
<code><a href="#topic+truncreg">truncreg</a></code> for fitting positive Poisson (PP) and zero-truncated negative binomial (ZTNB) models.
<code><a href="#topic+oneLRT">oneLRT</a></code> to test for no one-inflation or no overdispersion using a nested PP, OIPP, or ZTNB model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
df &lt;- data.frame(x = rnorm(100), z = rnorm(100), y = rpois(100, lambda = 1) + 1)
model &lt;- oneinfl(y ~ x | z, df = df, dist = "Poisson")
summary(model)
margins(model, df)
oneWald(model)
predict(model, df=df)

</code></pre>

<hr>
<h2 id='oneLRT'>Likelihood Ratio Test for Nested Models</h2><span id='topic+oneLRT'></span>

<h3>Description</h3>

<p>Performs a likelihood ratio test (LRT) to compare two nested models estimated by
<code><a href="#topic+oneinfl">oneinfl</a></code> or <code><a href="#topic+truncreg">truncreg</a></code>. It calculates the LRT statistic
and its associated p-value, testing whether the more complex model provides
a significantly better fit to the data than the simpler model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oneLRT(mod0, mod1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oneLRT_+3A_mod0">mod0</code></td>
<td>
<p>A model object (typically the simpler model) estimated using
<code><a href="#topic+oneinfl">oneinfl</a></code> or <code><a href="#topic+truncreg">truncreg</a></code>.</p>
</td></tr>
<tr><td><code id="oneLRT_+3A_mod1">mod1</code></td>
<td>
<p>A model object (typically the more complex model) estimated using
<code><a href="#topic+oneinfl">oneinfl</a></code> or <code><a href="#topic+truncreg">truncreg</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function extracts the log-likelihoods and number of parameters from the two
models. It then calculates the LRT statistic:
</p>
<p style="text-align: center;"><code class="reqn">-2 \cdot (\ell_0 - \ell_1)</code>
</p>

<p>where <code class="reqn">\ell_0</code> and <code class="reqn">\ell_1</code> are the log-likelihoods of the simpler and
more complex models, respectively. The degrees of freedom for the test are
equal to the difference in the number of parameters between the models.
</p>
<p>The likelihood ratio test is commonly used to test for:
</p>

<ul>
<li> <p><em>Overdispersion</em>: Comparing a Poisson model to a negative binomial model.
</p>
</li>
<li> <p><em>One-inflation</em>: Comparing a one-inflated model to a non-one-inflated model.
</p>
</li></ul>



<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt><code>LRTstat</code></dt><dd><p>The likelihood ratio test statistic.</p>
</dd>
<dt><code>pval</code></dt><dd><p>The p-value associated with the test statistic, based
on a chi-squared distribution.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
<code><a href="#topic+truncreg">truncreg</a></code> for fitting zero-truncated models.
<code><a href="stats.html#topic+pchisq">pchisq</a></code> for the chi-squared distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example: One-inflation test
df &lt;- data.frame(y = rpois(100, lambda = 5), x = rnorm(100), z = rnorm(100))
OIZTNB &lt;- oneinfl(y ~ x | z, df = df, dist = "negbin")
ZTNB &lt;- truncreg(y ~ x, df = df, dist = "negbin")
oneLRT(OIZTNB, ZTNB)

# Example: Overdispersion test
OIPP &lt;- oneinfl(y ~ x | z, df = df, dist = "Poisson")
oneLRT(OIZTNB, OIPP)

</code></pre>

<hr>
<h2 id='oneplot'>Plot Observed Data and Model Predictions</h2><span id='topic+oneplot'></span>

<h3>Description</h3>

<p>Generates a bar plot of observed count data and overlays predicted values
from one or more models fitted using <code><a href="#topic+oneinfl">oneinfl</a></code> or <code><a href="#topic+truncreg">truncreg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oneplot(
  model1,
  model2 = NULL,
  model3 = NULL,
  model4 = NULL,
  df,
  maxpred = NULL,
  ylimit = NULL,
  ccex = 1.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oneplot_+3A_model1">model1</code></td>
<td>
<p>The first fitted model object, either a one-inflated model (class <code>"oneinflmodel"</code>)
or a truncated model (class <code>"truncmodel"</code>).</p>
</td></tr>
<tr><td><code id="oneplot_+3A_model2">model2</code></td>
<td>
<p>Optional. A second fitted model object, structured similarly to <code>model1</code>.</p>
</td></tr>
<tr><td><code id="oneplot_+3A_model3">model3</code></td>
<td>
<p>Optional. A third fitted model object.</p>
</td></tr>
<tr><td><code id="oneplot_+3A_model4">model4</code></td>
<td>
<p>Optional. A fourth fitted model object.</p>
</td></tr>
<tr><td><code id="oneplot_+3A_df">df</code></td>
<td>
<p>A data frame containing the variables used in the models.</p>
</td></tr>
<tr><td><code id="oneplot_+3A_maxpred">maxpred</code></td>
<td>
<p>Optional. The maximum count value to include in the plot. Defaults to the maximum observed count.</p>
</td></tr>
<tr><td><code id="oneplot_+3A_ylimit">ylimit</code></td>
<td>
<p>Optional. The upper limit for the y-axis. Defaults to 1.1 times the highest observed frequency.</p>
</td></tr>
<tr><td><code id="oneplot_+3A_ccex">ccex</code></td>
<td>
<p>Optional. A numeric value controlling the size of plot points and lines. Defaults to <code>1.5</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function visualizes observed count data as a bar plot and overlays predicted
values from up to four models. The function automatically detects the type of model
(Poisson or negative binomial; one-inflated or truncated) and adjusts the plot accordingly.
Predictions are generated using the <code><a href="#topic+pred">pred</a></code> function.
</p>
<p>Model types are distinguished by different point and line styles:
</p>

<ul>
<li><p> Poisson (PP): Dark magenta, triangle-down
</p>
</li>
<li><p> Zero-truncated negative binomial (ZTNB): Red, diamond
</p>
</li>
<li><p> One-inflated Poisson (OIPP): Green, triangle-up
</p>
</li>
<li><p> One-inflated zero-truncated negative binomial (OIZTNB): Blue, circle
</p>
</li></ul>

<p>The legend in the top-right corner of the plot indicates the models displayed.
</p>


<h3>Value</h3>

<p>A plot is generated but no values are returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
<code><a href="#topic+truncreg">truncreg</a></code> for fitting truncated models.
<code><a href="#topic+pred">pred</a></code> for generating predictions used in the plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
df &lt;- data.frame(x = rnorm(100), z = rnorm(100), y = rpois(100, lambda = 5) + 1)
model1 &lt;- oneinfl(y ~ x | z, df = df, dist = "Poisson")
model2 &lt;- truncreg(y ~ x, df = df, dist = "Poisson")
oneplot(model1, model2, df = df, maxpred = 10)

</code></pre>

<hr>
<h2 id='oneWald'>Wald Test for One-Inflation</h2><span id='topic+oneWald'></span>

<h3>Description</h3>

<p>Performs a Wald test to evaluate the significance of the one-inflation parameters
in a model estimated using <code><a href="#topic+oneinfl">oneinfl</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oneWald(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oneWald_+3A_model">model</code></td>
<td>
<p>A model object of class <code>"oneinflmodel"</code> estimated using
<code><a href="#topic+oneinfl">oneinfl</a></code>. The model must include one-inflation parameters (<code>gamma</code>)
and a variance-covariance matrix (<code>vc</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Wald test evaluates the null hypothesis that all one-inflation parameters
(<code>gamma</code>) are equal to zero, indicating no one-inflation. The test statistic
is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">W = \gamma^\top V^{-1} \gamma</code>
</p>

<p>where <code class="reqn">\gamma</code> is the vector of one-inflation parameters and <code class="reqn">V</code> is their
variance-covariance matrix. The p-value is computed using a chi-squared distribution
with degrees of freedom equal to the length of <code class="reqn">\gamma</code>.
</p>
<p>This test is commonly used to determine whether a one-inflated model provides
a significantly better fit than a non-one-inflated counterpart.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt><code>W</code></dt><dd><p>The Wald test statistic.</p>
</dd>
<dt><code>pval</code></dt><dd><p>The p-value associated with the test statistic, based
on a chi-squared distribution.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
<code><a href="#topic+oneLRT">oneLRT</a></code> for a likelihood ratio test of nested models.
<code><a href="stats.html#topic+pchisq">pchisq</a></code> for the chi-squared distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
df &lt;- data.frame(y = rpois(100, lambda = 5), x = rnorm(100), z = rnorm(100))
OIZTNB &lt;- oneinfl(y ~ x | z, df = df, dist = "negbin")
oneWald(OIZTNB)

</code></pre>

<hr>
<h2 id='pred'>Generate Predicted Frequencies for Models</h2><span id='topic+pred'></span>

<h3>Description</h3>

<p>Computes the predicted frequencies for a specified model, given the observed data and
maximum count value. This function supports models estimated using <code><a href="#topic+oneinfl">oneinfl</a></code>
or <code><a href="#topic+truncreg">truncreg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred(model, df, maxpred)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred_+3A_model">model</code></td>
<td>
<p>A fitted model object, either a one-inflated model (class <code>"oneinflmodel"</code>)
or a truncated model (class <code>"truncmodel"</code>).</p>
</td></tr>
<tr><td><code id="pred_+3A_df">df</code></td>
<td>
<p>A data frame containing the variables used in the model.</p>
</td></tr>
<tr><td><code id="pred_+3A_maxpred">maxpred</code></td>
<td>
<p>Optional. The maximum count value for which predictions are generated.
Defaults to the maximum observed count in <code>df</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes predicted frequencies based on the type of model and its
distribution:
</p>

<ul>
<li> <p><strong>PP (Poisson, zero-truncated):</strong> Computes predictions for a
zero-truncated Poisson model.
</p>
</li>
<li> <p><strong>ZTNB (Negative Binomial, zero-truncated):</strong> Computes predictions
for a zero-truncated negative binomial model.
</p>
</li>
<li> <p><strong>OIPP (Poisson, one-inflated):</strong> Computes predictions for a
one-inflated Poisson model.
</p>
</li>
<li> <p><strong>OIZTNB (Negative Binomial, one-inflated, zero-truncated):</strong> Computes
predictions for a one-inflated, zero-truncated negative binomial model.
</p>
</li></ul>

<p>The predictions are generated for count values from 1 to <code>maxpred</code>. For one-inflated
models, the predictions account for the one-inflation probabilities.
</p>
<p>This is an internal function primarily used by <code><a href="#topic+oneplot">oneplot</a></code> for visualization purposes.
</p>


<h3>Value</h3>

<p>A numeric vector of predicted frequencies for count values from 1 to <code>maxpred</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oneplot">oneplot</a></code> for visualizing observed and predicted frequencies.
<code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
<code><a href="#topic+truncreg">truncreg</a></code> for fitting zero-truncated models.
</p>

<hr>
<h2 id='predict.oneinflmodel'>Predicted Expected Response for One-Inflated or Truncated Models</h2><span id='topic+predict.oneinflmodel'></span>

<h3>Description</h3>

<p>Calculates the predicted expected response for a model fitted using
<code><a href="#topic+oneinfl">oneinfl</a></code> or <code><a href="#topic+truncreg">truncreg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'oneinflmodel'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.oneinflmodel_+3A_object">object</code></td>
<td>
<p>An object of class <code>oneinflmodel</code></p>
</td></tr>
<tr><td><code id="predict.oneinflmodel_+3A_...">...</code></td>
<td>
<p>Additional argument <code>df</code>, a data frame used to calculate the expected
value of the response variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the expected response based on the fitted model. The computation
differs depending on the distribution. For <code>Poisson (OIPP)</code>, predicted values are
computed using <code><a href="#topic+E_pois">E_pois</a></code>. For <code>Negative Binomial (OIZTNB)</code>, predicted
values are computed using <code><a href="#topic+E_negbin">E_negbin</a></code>.
</p>


<h3>Value</h3>

<p>A numeric vector of predicted expected responses for the observations in <code>df</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
<code><a href="#topic+E_pois">E_pois</a></code>, <code><a href="#topic+E_negbin">E_negbin</a></code>, for the expected value calculations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
df &lt;- data.frame(x = rnorm(100), z = rnorm(100), y = rpois(100, lambda = 5))
model &lt;- oneinfl(y ~ x | z, df = df, dist = "Poisson")
predict(model, df = df)

</code></pre>

<hr>
<h2 id='predict.truncmodel'>Predicted Expected Response for One-Inflated or Truncated Models</h2><span id='topic+predict.truncmodel'></span>

<h3>Description</h3>

<p>Calculates the predicted expected response for a model fitted using
<code><a href="#topic+oneinfl">oneinfl</a></code> or <code><a href="#topic+truncreg">truncreg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'truncmodel'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.truncmodel_+3A_object">object</code></td>
<td>
<p>An object of class <code>truncmodel</code></p>
</td></tr>
<tr><td><code id="predict.truncmodel_+3A_...">...</code></td>
<td>
<p>Additional argument <code>df</code>, a data frame used to calculate the expected
value of the response variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the expected response based on the fitted model. The computation
differs depending on the distribution. For <code>Poisson (PP)</code>, predicted values are computed
using <code><a href="#topic+E_pois_noinfl">E_pois_noinfl</a></code>. For <code>Negative Binomial (ZTNB)</code>, predicted values are
computed using <code><a href="#topic+E_negbin_noinfl">E_negbin_noinfl</a></code>.
</p>


<h3>Value</h3>

<p>A numeric vector of predicted expected responses for the observations in <code>df</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
<code><a href="#topic+truncreg">truncreg</a></code> for fitting truncated models.
<code><a href="#topic+E_pois_noinfl">E_pois_noinfl</a></code>, <code><a href="#topic+E_negbin_noinfl">E_negbin_noinfl</a></code> for the expected value calculations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
df &lt;- data.frame(x = rnorm(100), y = rpois(100, lambda = 5))
model &lt;- truncreg(y ~ x, df = df, dist = "Poisson")
predict(model, df = df)

</code></pre>

<hr>
<h2 id='roipp'>Generate Random Counts from a One-Inflated Poisson Process</h2><span id='topic+roipp'></span>

<h3>Description</h3>

<p>Simulates count data from a one-inflated Poisson process using specified parameters
for the rate and one-inflation components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roipp(b, g, X, Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="roipp_+3A_b">b</code></td>
<td>
<p>A numeric vector of coefficients for the rate component.</p>
</td></tr>
<tr><td><code id="roipp_+3A_g">g</code></td>
<td>
<p>A numeric vector of coefficients for the one-inflation component.</p>
</td></tr>
<tr><td><code id="roipp_+3A_x">X</code></td>
<td>
<p>A matrix or data frame of predictor variables for the rate component.</p>
</td></tr>
<tr><td><code id="roipp_+3A_z">Z</code></td>
<td>
<p>A matrix or data frame of predictor variables for the one-inflation component.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates count data from a one-inflated Poisson process. The process
combines:
</p>

<ul>
<li><p> A Poisson distribution for counts greater than one.
</p>
</li>
<li><p> A one-inflation component that adjusts the probability of observing a count of one.
</p>
</li></ul>

<p>The algorithm:
</p>

<ol>
<li><p> Calculates the rate parameter (<code class="reqn">\lambda</code>) as <code class="reqn">\exp(X \cdot b)</code>.
</p>
</li>
<li><p> Computes the one-inflation probabilities (<code class="reqn">\omega</code>) based on <code class="reqn">Z \cdot g</code>.
</p>
</li>
<li><p> Simulates counts for each observation:
</p>

<ul>
<li><p> Draws a random number to determine whether the count is one.
</p>
</li>
<li><p> Iteratively calculates probabilities for higher counts until the random number is matched.
</p>
</li></ul>

</li></ol>

<p>This function is useful for generating synthetic data for testing or simulation studies involving
one-inflated Poisson models.
</p>


<h3>Value</h3>

<p>A numeric vector of simulated count data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
set.seed(123)
X &lt;- matrix(rnorm(100), ncol = 2)
Z &lt;- matrix(rnorm(100), ncol = 2)
b &lt;- c(0.5, -0.2)
g &lt;- c(1.0, 0.3)
simulated_data &lt;- roipp(b, g, X, Z)
print(simulated_data)

</code></pre>

<hr>
<h2 id='roiztnb'>Generate Random Counts from a One-Inflated Zero-Truncated Negative Binomial Process</h2><span id='topic+roiztnb'></span>

<h3>Description</h3>

<p>Simulates count data from a one-inflated, zero-truncated negative binomial (OIZTNB) process
using specified parameters for the rate, one-inflation, and dispersion components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roiztnb(b, g, alpha, X, Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="roiztnb_+3A_b">b</code></td>
<td>
<p>A numeric vector of coefficients for the rate component.</p>
</td></tr>
<tr><td><code id="roiztnb_+3A_g">g</code></td>
<td>
<p>A numeric vector of coefficients for the one-inflation component.</p>
</td></tr>
<tr><td><code id="roiztnb_+3A_alpha">alpha</code></td>
<td>
<p>A numeric value representing the dispersion parameter for the negative binomial distribution.</p>
</td></tr>
<tr><td><code id="roiztnb_+3A_x">X</code></td>
<td>
<p>A matrix or data frame of predictor variables for the rate component.</p>
</td></tr>
<tr><td><code id="roiztnb_+3A_z">Z</code></td>
<td>
<p>A matrix or data frame of predictor variables for the one-inflation component.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates count data from a one-inflated, zero-truncated negative binomial process.
The process combines:
</p>

<ul>
<li><p> A negative binomial distribution for counts greater than one.
</p>
</li>
<li><p> A one-inflation component that adjusts the probability of observing a count of one.
</p>
</li></ul>

<p>The algorithm:
</p>

<ol>
<li><p> Calculates the rate parameter (<code class="reqn">\lambda</code>) as <code class="reqn">\exp(X \cdot b)</code>.
</p>
</li>
<li><p> Computes the one-inflation probabilities (<code class="reqn">\omega</code>) based on <code class="reqn">Z \cdot g</code>.
</p>
</li>
<li><p> Computes the negative binomial dispersion parameter (<code class="reqn">\theta = \lambda / \alpha</code>).
</p>
</li>
<li><p> Simulates counts for each observation:
</p>

<ul>
<li><p> Draws a random number to determine whether the count is one.
</p>
</li>
<li><p> Iteratively calculates probabilities for higher counts until the random number is matched.
</p>
</li></ul>

</li></ol>

<p>This function is useful for generating synthetic data for testing or simulation studies involving
one-inflated, zero-truncated negative binomial models.
</p>


<h3>Value</h3>

<p>A numeric vector of simulated count data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
set.seed(123)
X &lt;- matrix(rnorm(100), ncol = 2)
Z &lt;- matrix(rnorm(100), ncol = 2)
b &lt;- c(0.5, -0.2)
g &lt;- c(1.0, 0.3)
alpha &lt;- 1.5
simulated_data &lt;- roiztnb(b, g, alpha, X, Z)
print(simulated_data)

</code></pre>

<hr>
<h2 id='rpp'>Generate Random Counts from a Zero-Truncated Poisson Process</h2><span id='topic+rpp'></span>

<h3>Description</h3>

<p>Simulates count data from a zero-truncated Poisson process using specified parameters
for the rate component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpp(b, X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rpp_+3A_b">b</code></td>
<td>
<p>A numeric vector of coefficients for the rate component.</p>
</td></tr>
<tr><td><code id="rpp_+3A_x">X</code></td>
<td>
<p>A matrix or data frame of predictor variables for the rate component.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates count data from a zero-truncated Poisson process, which models
count data without zeros. The process involves:
</p>

<ul>
<li><p> Calculating the rate parameter (<code class="reqn">\lambda</code>) as <code class="reqn">\exp(X \cdot b)</code>.
</p>
</li>
<li><p> Iteratively computing probabilities for counts starting from 1 and adding to the cumulative
probability until a randomly drawn value is matched.
</p>
</li></ul>

<p>This function is useful for generating synthetic data for testing or simulation studies involving
zero-truncated Poisson models.
</p>


<h3>Value</h3>

<p>A numeric vector of simulated count data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+truncreg">truncreg</a></code> for fitting zero-truncated models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
set.seed(123)
X &lt;- matrix(rnorm(100), ncol = 2)
b &lt;- c(0.5, -0.2)
simulated_data &lt;- rpp(b, X)
print(simulated_data)

</code></pre>

<hr>
<h2 id='signifWald'>Wald Test for Significance of a Predictor Variable</h2><span id='topic+signifWald'></span>

<h3>Description</h3>

<p>Performs a Wald test to evaluate the joint significance of a predictor variable in both
the rate and one-inflation components of a model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signifWald(model, varname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="signifWald_+3A_model">model</code></td>
<td>
<p>A fitted model object of class <code>"oneinflmodel"</code>.</p>
</td></tr>
<tr><td><code id="signifWald_+3A_varname">varname</code></td>
<td>
<p>A character string specifying the name of the predictor variable to test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function tests the null hypothesis that the coefficients for the specified predictor
variable are jointly equal to zero in both the rate (<code>beta</code>) and one-inflation
(<code>gamma</code>) components of the model. The test statistic is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">W = \mathbf{c}^\top V^{-1} \mathbf{c}</code>
</p>

<p>where <code class="reqn">\mathbf{c}</code> is the vector of coefficients for the predictor in the rate and
one-inflation components, and <code class="reqn">V</code> is their variance-covariance matrix. The p-value is
computed using a chi-squared distribution with 2 degrees of freedom.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt><code>W</code></dt><dd><p>The Wald test statistic.</p>
</dd>
<dt><code>pval</code></dt><dd><p>The p-value associated with the test statistic, based
on a chi-squared distribution with 2 degrees of freedom.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
<code><a href="#topic+oneWald">oneWald</a></code> for a general Wald test of one-inflation parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
set.seed(123)
df &lt;- data.frame(x = rnorm(100), z = rnorm(100), y = rpois(100, lambda = 5))
model &lt;- oneinfl(y ~ x | z, df = df, dist = "Poisson")
result &lt;- signifWald(model, varname = "x")
print(result$W)    # Wald test statistic
print(result$pval) # p-value

</code></pre>

<hr>
<h2 id='summary.oneinflmodel'>Summarize One-Inflated Regression Models</h2><span id='topic+summary.oneinflmodel'></span>

<h3>Description</h3>

<p>Provides a summary of the fitted model, including estimated coefficients, standard errors,
significance levels, and other relevant statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'oneinflmodel'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.oneinflmodel_+3A_object">object</code></td>
<td>
<p>A model object of class <code>"oneinflmodel"</code> (for one-inflated models).</p>
</td></tr>
<tr><td><code id="summary.oneinflmodel_+3A_...">...</code></td>
<td>
<p>Additional arguments (currently unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a detailed summary of the fitted model, including:
</p>

<ul>
<li><p> Estimated coefficients for the rate component (<code>beta</code>).
</p>
</li>
<li><p> Estimated coefficients for the one-inflation component (<code>gamma</code>).
</p>
</li>
<li><p> Standard errors.
</p>
</li>
<li><p> z-statistics, associated p-values, and corresponding significance codes.
</p>
</li>
<li><p> Average, and average absolute, one-inflation.
</p>
</li>
<li><p> Log-likelihood of the fitted model.
</p>
</li></ul>



<h3>Value</h3>

<p>Prints a summary table of coefficients, standard errors, z-values, p-values,
significance codes, one-inflation probabilities, and log-likelihood.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oneinfl">oneinfl</a></code> for fitting one-inflated models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
df &lt;- data.frame(x = rnorm(100), z = rnorm(100), y = rpois(100, lambda = 5))
model &lt;- oneinfl(y ~ x | z, df = df, dist = "Poisson")
summary(model)

</code></pre>

<hr>
<h2 id='summary.truncmodel'>Summarize Truncated Regression Models</h2><span id='topic+summary.truncmodel'></span>

<h3>Description</h3>

<p>Provides a summary of the fitted model, including estimated coefficients, standard errors,
significance levels, and other relevant statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'truncmodel'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.truncmodel_+3A_object">object</code></td>
<td>
<p>A model object of class <code>"truncmodel"</code> (for truncated models).</p>
</td></tr>
<tr><td><code id="summary.truncmodel_+3A_...">...</code></td>
<td>
<p>Additional arguments (currently unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a detailed summary of the fitted model, including:
</p>

<ul>
<li><p> Estimated coefficients for the rate component (<code>beta</code>).
</p>
</li>
<li><p> Standard errors.
</p>
</li>
<li><p> z-statistics, associated p-values, and corresponding significance codes.
</p>
</li>
<li><p> Log-likelihood of the fitted model.
</p>
</li></ul>



<h3>Value</h3>

<p>Prints a summary table of coefficients, standard errors, z-values, p-values,
significance codes, and log-likelihood.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+truncreg">truncreg</a></code> for fitting truncated regression models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
df &lt;- data.frame(x = rnorm(100), y = rpois(100, lambda = 5))
model &lt;- truncreg(y ~ x, df = df, dist = "Poisson")
summary(model)

</code></pre>

<hr>
<h2 id='truncreg'>Truncated Regression Model</h2><span id='topic+truncreg'></span>

<h3>Description</h3>

<p>Fits a positive Poisson (PP) or zero-truncated negative binomial (ZTNB) regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truncreg(formula, df, dist = "negbin", start = NULL, method = "BFGS")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="truncreg_+3A_formula">formula</code></td>
<td>
<p>A symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="truncreg_+3A_df">df</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="truncreg_+3A_dist">dist</code></td>
<td>
<p>A character string specifying the distribution to use. Options are <code>"Poisson"</code> or <code>"negbin"</code>.</p>
</td></tr>
<tr><td><code id="truncreg_+3A_start">start</code></td>
<td>
<p>Optional. A numeric vector of starting values for the optimization process. Defaults to <code>NULL</code>, in which case starting values are attempted to be chosen automatically.</p>
</td></tr>
<tr><td><code id="truncreg_+3A_method">method</code></td>
<td>
<p>A character string specifying the optimization method to be passed to <code><a href="stats.html#topic+optim">optim</a></code>. Defaults to <code>"BFGS"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a regression model for zero-truncated counts. Zero-truncated models are used when the count data does not include zeros, such as in cases where only positive counts are observed.
</p>
<p>The function supports two distributions:
</p>

<ul>
<li> <p><code>"Poisson"</code>: Zero-truncated Poisson regression.
</p>
</li>
<li> <p><code>"negbin"</code>: Zero-truncated negative binomial regression.
</p>
</li></ul>

<p>The function uses numerical optimization via <code><a href="stats.html#topic+optim">optim</a></code> to estimate the parameters.
</p>


<h3>Value</h3>

<p>An object of class <code>"truncmodel"</code> containing the following components:
</p>

<dl>
<dt><code>beta</code></dt><dd><p>Estimated coefficients for the regression model.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>Dispersion parameter (only for negative binomial distribution).</p>
</dd>
<dt><code>vc</code></dt><dd><p>Variance-covariance matrix of the estimated parameters.</p>
</dd>
<dt><code>logl</code></dt><dd><p>Log-likelihood of the fitted model.</p>
</dd>
<dt><code>dist</code></dt><dd><p>The distribution used for the model (&quot;Poisson&quot; or &quot;negbin&quot;).</p>
</dd>
<dt><code>formula</code></dt><dd><p>The formula used for the model.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code> for summarizing the fitted model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage
df &lt;- data.frame(x = rnorm(100), y = rpois(100, lambda = 1) + 1)
model &lt;- truncreg(y ~ x, df = df, dist = "Poisson")
summary(model)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
