<!DOCTYPE html><html><head><title>Help for package metaplus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {metaplus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#metaplus-package'>
<p>Fits random effects meta-analysis models including robust models</p></a></li>
<li><a href='#AIC'><p>AIC for metaplus object</p></a></li>
<li><a href='#BIC'><p>BIC for metaplus object</p></a></li>
<li><a href='#cdp'><p>CDP meta-analysis data</p></a></li>
<li><a href='#exercise'><p>Exercise meta-analysis data</p></a></li>
<li><a href='#logLik'><p>log Likelikelihood for metaplus object</p></a></li>
<li><a href='#mag'><p>Magnesium meta-analysis data</p></a></li>
<li><a href='#marinho'><p>Marinho meta-analysis data</p></a></li>
<li><a href='#metaplus'>
<p>Fits random effects meta-analysis models, using either a standard normal distribution, a <code class="reqn">t</code>-distribution or a mixture of normals for the random effect.</p></a></li>
<li><a href='#outlierProbs'>
<p>Calculate outlier probabilities for each study.</p></a></li>
<li><a href='#plot.metaplus'>
<p>Produces forest plot for the studies together with the meta-analysis results.</p></a></li>
<li><a href='#plot.outlierProbs'>
<p>Plot outlier probabilities.</p></a></li>
<li><a href='#summary'>
<p>Summary of a metaplus object.</p></a></li>
<li><a href='#testOutliers'>
<p>Tests for the presence of outliers.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Meta-Analysis and Meta-Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-07-04</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ken Beath &lt;ken@kjbeath.id.au&gt;</td>
</tr>
<tr>
<td>Contact:</td>
<td>Ken Beath &lt;ken@kjbeath.id.au&gt;</td>
</tr>
<tr>
<td>Author:</td>
<td>Ken Beath [aut, cre],
  Ben Bolker [aut],
  R Development Core Team [aut]</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs meta-analysis and meta-regression using standard and robust methods with confidence intervals based on the profile likelihood. Robust methods are based on alternative distributions for the random effect, either the t-distribution (Lee and Thompson, 2008 &lt;<a href="https://doi.org/10.1002%2Fsim.2897">doi:10.1002/sim.2897</a>&gt; or Baker and Jackson, 2008 &lt;<a href="https://doi.org/10.1007%2Fs10729-007-9041-8">doi:10.1007/s10729-007-9041-8</a>&gt;) or mixtures of normals (Beath, 2014 &lt;<a href="https://doi.org/10.1002%2Fjrsm.1114">doi:10.1002/jrsm.1114</a>&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.2.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Imports:</td>
<td>bbmle, metafor, boot, methods, numDeriv, MASS, graphics,
stats, fastGHQuad, lme4, Rfast, parallel, doParallel, foreach,
doRNG</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-04 09:23:46 UTC; kenbeath</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-04 13:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='metaplus-package'>
Fits random effects meta-analysis models including robust models
</h2><span id='topic+metaplus-package'></span>

<h3>Description</h3>

<p>Allows fitting of random effects meta-analysis producing confidence intervals based on the profile likelihood (Hardy and Thompson, 1996). Two methods of robust meta-analysis are included, based on either the <code class="reqn">t</code>-distribution (Baker and Jackson (2008) and Lee and Thompson (2008)) or normal-mixture distribution (Beath, 2014). Tests can be performed for the need for a robust model, using a parametric bootstrap, and for the normal-mixture the identity of the outliers using the posterior probability. Plots are produced allowing a comparison between the results of each method. Where possible use has been made of the metafor package.
</p>


<h3>The metaplus function</h3>

<p>This is the main function that allows fitting the models. The metaplus objects may be plotted, using plot, and tested for outliers using testOutliers. The results of tests.outliers may also be plotted.
</p>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken@kjbeath.id.au&gt;
</p>


<h3>References</h3>

<p>Baker, R., &amp; Jackson, D. (2008). A new approach to outliers in meta-analysis. Health Care Management Science, 11(2), 121-131. doi:10.1007/s10729-007-9041-8
</p>
<p>Beath, K. J. (2014). A finite mixture method for outlier detection and robustness in meta-analysis. Research Synthesis Methods, (in press). doi:10.1002/jrsm.1114
</p>
<p>Hardy, R. J., &amp; Thompson, S. G. (1996). A likelihood approach to meta-analysis with random effects. Statistics in Medicine, 15, 619-629.
</p>
<p>Lee, K. J., &amp; Thompson, S. G. (2008). Flexible parametric models for random effects distributions. Statistics in Medicine, 27, 418-434. doi:10.1002/sim
</p>

<hr>
<h2 id='AIC'>AIC for metaplus object</h2><span id='topic+AIC.metaplus'></span>

<h3>Description</h3>

<p>Returns AIC for a metaplus object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metaplus'
AIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC_+3A_object">object</code></td>
<td>
<p>metaplus object</p>
</td></tr>
<tr><td><code id="AIC_+3A_...">...</code></td>
<td>
<p> additional argument; currently none are used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>AIC of fitted model
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mag)
mag1 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, cores = 1, data = mag)
print(AIC(mag1))
</code></pre>

<hr>
<h2 id='BIC'>BIC for metaplus object</h2><span id='topic+BIC.metaplus'></span>

<h3>Description</h3>

<p>Returns BIC for a metaplus object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metaplus'
BIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIC_+3A_object">object</code></td>
<td>
<p>metaplus object</p>
</td></tr>
<tr><td><code id="BIC_+3A_...">...</code></td>
<td>
<p> additional argument; currently none are used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>BIC of fitted model
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mag)
mag1 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, cores = 1, data = mag)
print(BIC(mag1))
</code></pre>

<hr>
<h2 id='cdp'>CDP meta-analysis data</h2><span id='topic+cdp'></span>

<h3>Description</h3>

<p>Data for the meta-analysis by Fioravanti and Yanagi (2005) of cytidinediphosphocholine (CDP-choline) for cognitive and behavioural disturbances associated with chronic cerebral disorders in the elderly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdp</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 3 variables.
</p>

<dl>
<dt><code>study</code></dt><dd><p>study authors and date</p>
</dd>
<dt><code>yi</code></dt><dd><p>study effect estimate</p>
</dd>
<dt><code>sei</code></dt><dd><p>study standard error</p>
</dd>
</dl>



<h3>Source</h3>

<p>Fioravanti and Yanagi (2005)
</p>


<h3>References</h3>

<p>Fioravanti, M., &amp; Yanagi, M. (2005). Cytidinediphosphocholine (CDP choline) for cognitive and behavioural disturbances associated with chronic cerebral disorders in the elderly (Review). The Cochrane Database of Systematic Reviews. Retrieved from http://onlinelibrary.wiley.com/doi/10.1002/14651858.CD000269.pub2/pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(cdp)
cdp1 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, cores = 1, data = cdp)

</code></pre>

<hr>
<h2 id='exercise'>Exercise meta-analysis data</h2><span id='topic+exercise'></span>

<h3>Description</h3>

<p>Lawlor &amp; Hopker (2001) performed a meta-analysis of trials of exercise in
the management of depression, which was subsequently analysed using meta-
regression (Higgins &amp; Thompson 2004) with duration of treatment as a covariate. There is a possible
outlier, the study by Reuter. While there are additional predictors, it seems excessive to use them given the small number of studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exercise</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 9 variables.
</p>

<dl>
<dt><code>study</code></dt><dd><p>study author</p>
</dd>
<dt><code>smd</code></dt><dd><p>study effect estimate</p>
</dd>
<dt><code>varsmd</code></dt><dd><p>study effect variance</p>
</dd>
<dt><code>sesmd</code></dt><dd><p>study effect standard error</p>
</dd>
<dt><code>abstract</code></dt><dd><p>study available as abstract only?</p>
</dd>
<dt><code>duration</code></dt><dd><p>length of study in weeks</p>
</dd>
<dt><code>itt</code></dt><dd><p>intention to treat analysis?</p>
</dd>
<dt><code>alloc</code></dt><dd><p>outcome assessor blinded</p>
</dd>
<dt><code>phd</code></dt><dd><p>phd thesis?</p>
</dd>
</dl>



<h3>Source</h3>

<p>Higgins and Thompson (2004)
</p>


<h3>References</h3>

<p>Higgins, J. P. T., &amp; Thompson, S. G. (2004). Controlling the risk of spurious findings from meta-regression. Statistics in Medicine, 23(11), 166382. doi:10.1002/sim.1752
</p>
<p>Lawlor, D. A., &amp; Hopker, S. W. (2001). The effectiveness of exercise as an intervention in the management of depression: systematic review and meta-regression analysis of randomised controlled trials. BMJ, 322(31 March), 18.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
exercise1 &lt;- metaplus(smd, sqrt(varsmd), mods = duration, slab = study,
    cores = 1, data = exercise)
exercise2 &lt;- metaplus(smd, sqrt(varsmd), mods = cbind(duration, itt), slab = study,
    cores = 1, data = exercise)

</code></pre>

<hr>
<h2 id='logLik'>log Likelikelihood for metaplus object</h2><span id='topic+logLik.metaplus'></span>

<h3>Description</h3>

<p>Returns the log Likelihood for a metaplus object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metaplus'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik_+3A_object">object</code></td>
<td>
<p>metaplus object</p>
</td></tr>
<tr><td><code id="logLik_+3A_...">...</code></td>
<td>
<p> additional argument; currently none are used. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The loglikelihood of the fitted model.
</p>


<h3>Author(s)</h3>

<p>Ken Beath</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mag)
mag1 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, cores = 1, data = mag)
print(logLik(mag1))
</code></pre>

<hr>
<h2 id='mag'>Magnesium meta-analysis data</h2><span id='topic+mag'></span>

<h3>Description</h3>

<p>Data for a meta-analysis of intravenous magnesium in acute myocardial infarction. An interesting question is whether the ISIS4 study is an outlier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mag</code></pre>


<h3>Format</h3>

<p>A data frame with 16 observations on the following 3 variables.
</p>

<dl>
<dt><code>study</code></dt><dd><p>study author</p>
</dd>
<dt><code>yi</code></dt><dd><p>study effect estimate</p>
</dd>
<dt><code>sei</code></dt><dd><p>study standard error</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sterne et al (2001)
</p>


<h3>References</h3>

<p>Sterne, J. A. C., Bradburn, M. J., &amp; Egger, M. (2001). Meta-analysis in Stata. In M. Egger, G. D. Smith, &amp; D. G. Altman (Eds.), Systematic Reviews in Health Care: Meta-Analysis in Context (pp. 347-369). BMJ Publishing Group.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(mag)
mag1 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, cores = 1, data = mag)
plot(mag1)

</code></pre>

<hr>
<h2 id='marinho'>Marinho meta-analysis data</h2><span id='topic+marinho'></span>

<h3>Description</h3>

<p>Data for the meta-analysis by Marinho et al (2009) to determine the effectiveness of fluoride toothpastes on caries in children.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marinho</code></pre>


<h3>Format</h3>

<p>A data frame with 70 observations on the following 11 variables.
</p>

<dl>
<dt><code>study</code></dt><dd><p>study authors and date</p>
</dd>
<dt><code>nfluor</code></dt><dd><p>number in fluoride group</p>
</dd>
<dt><code>meanfluor</code></dt><dd><p>mean effect in fluoride group</p>
</dd>
<dt><code>sdfluor</code></dt><dd><p>standard deviation of effect in fluoride group</p>
</dd>
<dt><code>nplacebo</code></dt><dd><p>number in placebo group</p>
</dd>
<dt><code>meanplacebo</code></dt><dd><p>mean effect in placebo group</p>
</dd>
<dt><code>sdplacebo</code></dt><dd><p>standard deviation of effect in placebo group</p>
</dd>
<dt><code>meaneffect</code></dt><dd><p>mean effect difference</p>
</dd>
<dt><code>seeffect</code></dt><dd><p>standard error of effect difference</p>
</dd>
</dl>



<h3>Source</h3>

<p>Marinho et al (2009)
</p>


<h3>References</h3>

<p>Marinho, V. C. C., Higgins, J. P. T., Logan, S., &amp; Sheiham, A. (2009). Fluoride toothpastes for preventing dental caries in children and adolescents (Review). The Cochrane Database of Systematic Reviews. Retrieved from http://onlinelibrary.wiley.com/doi/10.1002/14651858.CD002278/pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(marinho)
marinho1 &lt;- metaplus(meaneffect, seeffect, plotci = TRUE, slab = study, cores = 1, data = marinho)

</code></pre>

<hr>
<h2 id='metaplus'>
Fits random effects meta-analysis models, using either a standard normal distribution, a <code class="reqn">t</code>-distribution or a mixture of normals for the random effect.
</h2><span id='topic+metaplus'></span>

<h3>Description</h3>

<p>Allows fitting of random effects meta-analysis producing confidence intervals based on profile likelihood. Two methods of robust meta-analysis are included, based on either the <code class="reqn">t</code>-distribution or normal-mixture distribution. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metaplus(yi, sei, mods = NULL, random = "normal", 
 label = switch(random, "normal" = "Random Normal", "t-dist" = "Random t-distribution", 
 "mixture" = "Random mixture"), 
 plotci = FALSE, justfit = FALSE, slab = 1:length(yi), 
 useAGQ = FALSE, quadpoints = 21, notrials = 20, 
 cores = max(detectCores()%/%2, 1), data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metaplus_+3A_yi">yi</code></td>
<td>

<p>vector of observed effect size
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_sei">sei</code></td>
<td>

<p>vector of observed standard errors (note: not standard errors squared)
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_mods">mods</code></td>
<td>

<p>data frame of covariates corresponding to each study
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_random">random</code></td>
<td>

<p>The type of random effects distribution. One of &quot;normal&quot;, &quot;t-dist&quot;, &quot;mixture&quot;, for standard normal, <code class="reqn">t</code>-distribution or mixture of normals respectively.
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_label">label</code></td>
<td>

<p>The label to be used for this model when plotting
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_plotci">plotci</code></td>
<td>

<p>Should profile be plotted for each confidence interval?
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_justfit">justfit</code></td>
<td>

<p>Should model only be fitted? If justfit = TRUE then profiling and likelihood ratio statistics are not calculated. Useful for when bootstrapping.
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_slab">slab</code></td>
<td>

<p>Vector of character strings corresponding to each study.
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_useagq">useAGQ</code></td>
<td>

<p>Deprecated. No longer used.
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_quadpoints">quadpoints</code></td>
<td>

<p>Deprecated. No longer used.
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_notrials">notrials</code></td>
<td>

<p>Number of random starting values to use for mixture models.
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_cores">cores</code></td>
<td>

<p>Number of rcores to use for parallel processing of .
</p>
</td></tr>
<tr><td><code id="metaplus_+3A_data">data</code></td>
<td>

<p>Optional data frame containing some or all other data.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As well as standard normal random effects meta-analysis, fitting of robust models incorporating either a <code class="reqn">t</code>-distribution random effect (Lee and Thompson, 2008 or Baker and Jackson, 2008) or a mixture of normals (Beath, 2014) may be fitted. For all models the profile log-likelihood (Hardy and Thompson, 1996) is used to determine the confidence intervals for the parameters, with corresponding p values calculated using the likelihood ratio test, to give consistency between the confidence intervals and p values. The profile log-likelihood produces confidence intervals with better properties than REML or Der Simonian-Laird method (Brockwell and Gordon 2001, Jackson et al 2010)
</p>
<p>For the mixture normal model, multiple starting values are used. This is achieved by starting with the no outlier model, then all possible single outlier models and choosing the model with the maximum likelihood. The process is repeated by adding all possible outliers to obtain the two outlier models and the maximum likelihood chosen. The process is repeated until the likelihood is not further maximised by adding outliers. This method gives a faster fitting time and is more reliable than using random assignments, as we have usually only a small number of outliers.
</p>


<h3>Value</h3>

<table>
<tr><td><code>results</code></td>
<td>
<p>Matrix containing columns for estimate, lower 95%, upper 95% and p value, or if justfit = TRUE then only the parameter estimates</p>
</td></tr>
<tr><td><code>yi</code></td>
<td>
<p>Effect sizes</p>
</td></tr>
<tr><td><code>sei</code></td>
<td>
<p>Standard error of effect sizes</p>
</td></tr>
<tr><td><code>mods</code></td>
<td>
<p>Modifiers for meta-regression</p>
</td></tr>
<tr><td><code>slab</code></td>
<td>
<p>Study labels</p>
</td></tr>
<tr><td><code>justfit</code></td>
<td>
<p>Value of justfit passed to the method.</p>
</td></tr>
<tr><td><code>fittedmodel</code></td>
<td>
<p>final model returned by mle2</p>
</td></tr>
<tr><td><code>profile</code></td>
<td>
<p>profile likelihood returned as described in bbmle</p>
</td></tr>
<tr><td><code>random</code></td>
<td>
<p>Type of random effect</p>
</td></tr>
<tr><td><code>outlier.prob</code></td>
<td>
<p>Outlier probabilities for robust mixture model only</p>
</td></tr>
</table>


<h3>Note</h3>

<p>I have used cores = 1 in the examples, as this is required by some of the checking procedures but it can, and should be, be removed for your own use for faster execution.</p>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken@kjbeath.id.au&gt;
</p>


<h3>References</h3>

<p>Baker, R., &amp; Jackson, D. (2008). A new approach to outliers in meta-analysis. Health Care Management Science, 11(2), 121131.
</p>
<p>Beath, K. J. (2014). A finite mixture method for outlier detection and robustness in meta-analysis. Research Synthesis Methods, 5, 285-293. doi:10.1002/jrsm.1114
</p>
<p>Brockwell, S. E., &amp; Gordon, I. R. (2001). A comparison of statistical methods for meta-analysis. Statistics in Medicine, 20, 825-840.
</p>
<p>Hardy, R. J., &amp; Thompson, S. G. (1996). A likelihood approach to meta-analysis with random effects. Statistics in Medicine, 15, 619-629.
</p>
<p>Jackson, D., Bowden, J., &amp; Baker, R. (2010). How does the DerSimonian and Laird procedure for random effects meta-analysis compare with its more efficient but harder to compute counterparts? Journal of Statistical Planning and Inference, 140, 961-970. doi:10.1016/j.jspi.2009.09.017
</p>
<p>Lee, K. J., &amp; Thompson, S. G. (2008). Flexible parametric models for random effects distributions. Statistics in Medicine, 27, 418-434. doi:10.1002/sim
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(metaplus)

# perform meta-analysis for mag studies, which have no outliers
# fit standard normal random-effect model and print summary
mag.meta &lt;- metaplus(yi, sei, slab = study, data = mag)
summary(mag.meta)
# repeat, but this time plot the profile likelihood diagnostic plot using plotci
mag.meta &lt;- metaplus(yi, sei, slab = study, plotci = TRUE, cores = 1, data = mag)
# plot a forest plot with exponential transform, so that the odds ratios are plotted
plot(mag.meta, atransf = exp, at = log(c(.01, .1, 1, 10, 100)), xlab = "Odds Ratio", 
 cex = 0.75)
# repeat for t-distribution random effects
mag.tdist &lt;- metaplus(yi, sei, slab = study, 
 random = "t-dist", cores = 1, data = mag)
summary(mag.tdist)
# use parametric bootstrap to test for presence of outliers
summary(testOutliers(mag.tdist, cores = 1))
# repeat for robust mixture random effects
mag.mix &lt;- metaplus(yi, sei, slab = study, 
 random = "mixture", cores = 1, data = mag)
summary(mag.mix)
# use parametric bootstrap to test for presence of outliers
summary(testOutliers(mag.mix, cores = 1))


# perform meta-analysis for CDP studies
# where there is one outlier
cdp.meta &lt;- metaplus(yi, sei, slab = study, cores = 1, data = cdp)
summary(cdp.meta)
cdp.tdist &lt;- metaplus(yi, sei, slab = study, 
 random = "t-dist", cores = 1, data = cdp)
summary(cdp.tdist)
summary(testOutliers(cdp.tdist, cores = 1))
cdp.mix &lt;- metaplus(yi, sei, slab = study, 
 random = "mixture", cores = 1, data = cdp)
summary(cdp.mix)
summary(testOutliers(cdp.mix, cores = 1))

# extract and plot outlier probabilities
cdp.mix.outlierProbs &lt;- outlierProbs(cdp.mix)
plot(cdp.mix.outlierProbs)

# produce forest plot with summary for all 3 models, showing narrower confidence
# intervals for robust models
plot(cdp.meta, extrameta = list(cdp.tdist, cdp.mix), xlab = "Standardised Mean Difference")


# effect of exercise on depression with covariate of length of study
# fit the 3 models
exercise.meta &lt;- metaplus(smd, sqrt(varsmd), 
 mods = duration, slab = study, cores = 1, data = exercise)
summary(exercise.meta)
exercise.mix &lt;- metaplus(smd, sqrt(varsmd), 
 mods = duration, slab = study, random = "mixture", 
 cores = 1, data = exercise)
summary(exercise.mix)
exercise.testOutliers &lt;- testOutliers(exercise.mix, cores = 1)
summary(exercise.testOutliers)

# identify possible outliers
exercise.outlierProbs &lt;- outlierProbs(exercise.mix)
plot(exercise.outlierProbs)

# centre duration at different values to obtain predictions at 4, 8 and 12 weeks 
exercise$duration4 &lt;- exercise$duration-4
exercise$duration8 &lt;- exercise$duration-8
exercise$duration12 &lt;- exercise$duration-12

# fit the different models, giving each an appropriate label
exercise.nodurn &lt;- metaplus(smd, sqrt(varsmd), 
 label = "Random Mixture (No Duration)", slab = study, 
 random = "mixture", cores = 1, data = exercise)
exercise.wk4 &lt;- metaplus(smd, sqrt(varsmd), 
 mods = duration4, label = "Random Mixture (Week 4)", 
 slab = study, random = "mixture", cores = 1, data = exercise)
exercise.wk8 &lt;- metaplus(smd, sqrt(varsmd), 
 mods = duration8, label = "Random Mixture (Week 8)", 
 slab = study, random = "mixture", cores = 1, data = exercise)
exercise.wk12 &lt;- metaplus(smd, sqrt(varsmd), 
 mods = duration12, label = "Random Mixture (Week 12)", 
 slab = study, random = "mixture", cores = 1, data = exercise)
 
# produce forest plot with summary for each model with robust mixture model at different weeks
plot(exercise.nodurn, extrameta = list(exercise.wk4, exercise.wk8, 
 exercise.wk12), xlab = "Standardised mean difference")

</code></pre>

<hr>
<h2 id='outlierProbs'>
Calculate outlier probabilities for each study.</h2><span id='topic+outlierProbs'></span><span id='topic+outlierProbs.metaplus'></span>

<h3>Description</h3>

<p>For the normal mixture random effect calculates the probability that each study is an outlier based on the posterior probability of it being an outlier.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metaplus'
outlierProbs(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outlierProbs_+3A_object">object</code></td>
<td>

<p>A metaplus object with a mixture (robust) random effects distribution.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outlier probabilities are obtained as the posterior probabilities of each study being an outlier based on the fitted mixture model.
</p>


<h3>Value</h3>

<table>
<tr><td><code>outlier.prob</code></td>
<td>
<p>Posterior probability that each study is an outlier</p>
</td></tr>
<tr><td><code>slab</code></td>
<td>
<p>Labels corresponding to each study</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken@kjbeath.id.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(mag)
mag3 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, random = "mixture", cores = 1, data = mag)
mag3.outlierProbs &lt;- outlierProbs(mag3)
plot(mag3.outlierProbs)

</code></pre>

<hr>
<h2 id='plot.metaplus'>
Produces forest plot for the studies together with the meta-analysis results.
</h2><span id='topic+plot.metaplus'></span>

<h3>Description</h3>

<p>Produces a forest plot for the studies in the meta-analysis and the result of the meta-analysis. Allows the inclusion of extra results of alternative meta-analyses, to allow, for example comparison between standard and robust methods of meta-analysis. Makes extensive use of the metafor package to produce the forest plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metaplus'
plot(x, ..., extrameta = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.metaplus_+3A_x">x</code></td>
<td>

<p>metaplus object to be plotted
</p>
</td></tr>
<tr><td><code id="plot.metaplus_+3A_...">...</code></td>
<td>

<p>additional parameters to plot</p>
</td></tr>
<tr><td><code id="plot.metaplus_+3A_extrameta">extrameta</code></td>
<td>

<p>Additional metaplus objects to be plotted. Only the summary statistic is plotted at the end of the plot. This is useful for comparing standard and robust methods, or meta-regressions for various values of the predictor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot
</p>


<h3>Note</h3>

<p>On some systems the alignment of characters in the CI may be poor when saving the plots to pdf. A solution is to use the extrafont package and a fixed width font, for eample Courier New. Then if creating the plot using pdf() the parameter family = &quot;Courier New&quot; will use this font and fonts = &quot;Courier New&quot; will add it to the pdf.
</p>
<p>An alternative is to use pdf.options() with the same parameters before the plot, and pdf.options(reset = TRUE) will produce the same effect.
</p>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken@kjbeath.com.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(cdp)
# produce all 3 models for the CDP data and plot them all
cdp1 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, cores = 1, data = cdp)
cdp2 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, random = "t-dist", cores = 1, data = cdp)
cdp3 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, random = "mixture", cores = 1, data = cdp)
plot(cdp1, extrameta = list(cdp2, cdp3))

# plot effect of exercise on depression at 4, 8 and 12 weeks
data(exercise)
exercise$duration4 &lt;- exercise$duration-4
exercise$duration8 &lt;- exercise$duration-8
exercise$duration12 &lt;- exercise$duration-12

exercise.wk4 &lt;- metaplus(smd, sqrt(varsmd), mods = duration4, 
 label = "Random Mixture (Week 4)", slab = study, random = "mixture", cores = 1, data = exercise)
exercise.wk8 &lt;- metaplus(smd, sqrt(varsmd), mods = duration8, 
 label = "Random Mixture (Week 8)", slab = study, random = "mixture", cores = 1, data = exercise)
exercise.wk12 &lt;- metaplus(smd, sqrt(varsmd), mods = duration12, 
 label = "Random Mixture (Week 12)", slab = study, random = "mixture", cores = 1, data = exercise)

exercise.nodurn &lt;- metaplus(smd, sqrt(varsmd), plotci = TRUE, 
 label = "Random Mixture (No Duration)", slab = study, random = "mixture",
 cores = 1, data = exercise)

plot(exercise.nodurn, extrameta = list(exercise.wk4, exercise.wk8, exercise.wk12))

</code></pre>

<hr>
<h2 id='plot.outlierProbs'>
Plot outlier probabilities.
</h2><span id='topic+plot.outlierProbs'></span>

<h3>Description</h3>

<p>Plots the outlier probability for each study, from an outlierProbs object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'outlierProbs'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.outlierProbs_+3A_x">x</code></td>
<td>

<p>outlierProbs object to be plotted
</p>
</td></tr>
<tr><td><code id="plot.outlierProbs_+3A_...">...</code></td>
<td>

<p>additional parameters to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot
</p>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken@kjbeath.id.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(mag)
mag.mix &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, random = "mixture", cores = 1, data = mag)
mag.mix.outlierProbs &lt;- outlierProbs(mag.mix)
plot(mag.mix.outlierProbs)

</code></pre>

<hr>
<h2 id='summary'>
Summary of a metaplus object.</h2><span id='topic+summary.metaplus'></span>

<h3>Description</h3>

<p>Summarises the meta-analysis, giving the parameter estimates and goodness of fit statistics. For the robust methods this includes the values of the parameters relating to robustness. In the summary the 95% confidence intervals are calculated using the profile likelihood method. To produce corresponding p-values these are obtained from the likelihood ratio test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metaplus'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>

<p>metaplus object to summarise.</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>

<p>Additional parameters to summary.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>results</code></td>
<td>
<p>Matrix containing parameter estimates, confidence intervals and p values</p>
</td></tr>
<tr><td><code>fitstats</code></td>
<td>
<p>List containing logLikelihood, AIC and BIC</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken@kjbeath.id.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mag)
mag1 &lt;- metaplus(yi, sei, plotci = TRUE, slab = study, cores = 1, data = mag)
summary(mag1)
</code></pre>

<hr>
<h2 id='testOutliers'>
Tests for the presence of outliers.
</h2><span id='topic+testOutliers'></span><span id='topic+testOutliers.metaplus'></span>

<h3>Description</h3>

<p>For the <code class="reqn">t</code>-distribution models this is a test that the degrees of freedom is infinitite, or equivalently that it's inverse is zero. For the mixture-normal model it is a test that the proportion of outliers is zero. As both tests involve a parameter on the boundary of the parameter space, asymptotic theory does not apply, so a parametric bootstrap is performed to determine the empirical distribution of the test statistic under the null hypothesis. The observed likelihood ratio statistic is then compared to this distribution to determine the p value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metaplus'
testOutliers(object, R = 999, cores = max(detectCores()%/%2, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testOutliers_+3A_object">object</code></td>
<td>

<p>The meta-analysis for which the presence of outliers is to be tested.
</p>
</td></tr>
<tr><td><code id="testOutliers_+3A_r">R</code></td>
<td>

<p>Number of simulations (parametric bootstraps) used in testing the hypothesis. Initially, it may be useful to set this to a smaller value, to allow faster execution time.
</p>
</td></tr>
<tr><td><code id="testOutliers_+3A_cores">cores</code></td>
<td>

<p>Number of cores used to simultaneously perform simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>pvalue</code></td>
<td>
<p>p value obtained from parametric bootstrap</p>
</td></tr>
<tr><td><code>observed</code></td>
<td>
<p>Observed value of the likelihood ratio test statistic</p>
</td></tr>
<tr><td><code>sims</code></td>
<td>
<p>Simulated values of the test statistic under the null hypothesis</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Running the default number of bootstrap samples may take considerable time, of the order of hours. Use of the parallel options will improve these times. For a preliminary guide to whether there are outliers, this is indicated by a reduction in AIC or BIC with the robust model, and a change in the estimated mean effect.</p>


<h3>Author(s)</h3>

<p>Ken Beath &lt;ken@kjbeath.id.au&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(cdp)
cdp3 &lt;- metaplus(yi, sei , plotci = TRUE, slab = study, random = "mixture", cores = 1, data = cdp)
summary(testOutliers(cdp3, cores = 1))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
