<!DOCTYPE html><html lang="en"><head><title>Help for package do3PCA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {do3PCA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#doBiplot'><p>Make biplot for any type of PCA</p></a></li>
<li><a href='#phylProbPCA'><p>Probabilistic Phylogenetic PCA</p></a></li>
<li><a href='#ProbPCA'><p>Probabilistic PCA</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Probabilistic Phylogenetic Principal Component Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates probabilistic phylogenetic Principal Component Analysis (PCA) and non-phylogenetic probabilistic PCA. Provides methods to implement alternative models of trait evolution including Brownian motion (BM), Ornstein-Uhlenbeck (OU), Early Burst (EB), and Pagel's lambda. Also provides flexible biplot functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), Rdimtools</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, phytools, matrixcalc, mclust, nloptr, ratematrix, stats,
utils</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-23 15:42:47 UTC; daniel</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Caetano <a href="https://orcid.org/0000-0002-2803-4064"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Caetano &lt;caetanods1@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-24 19:10:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='doBiplot'>Make biplot for any type of PCA</h2><span id='topic+doBiplot'></span>

<h3>Description</h3>

<p>Function to make biplots for any kind of PCA. It accepts the outputs from standard PCA (princomp and prcomp). It also works with the &quot;phylProbPCA&quot; and &quot;ProbPCA&quot; functions. It provides more options to the plot than the standard &quot;stats::biplot&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doBiplot(x, choices = 1L:2L, scale = 1, pc.biplot = FALSE, col, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="doBiplot_+3A_x">x</code></td>
<td>
<p>output from PCA analysis.</p>
</td></tr>
<tr><td><code id="doBiplot_+3A_choices">choices</code></td>
<td>
<p>numeric vector of length 2. Use to choose which of the PC axes to plot. Default plots first and second axes: &quot;choices = c(1,2)&quot;.</p>
</td></tr>
<tr><td><code id="doBiplot_+3A_scale">scale</code></td>
<td>
<p>numeric value between 0 and 1. Same as in &quot;stats::biplot.princomp&quot;. See ?biplot.princomp for more information.</p>
</td></tr>
<tr><td><code id="doBiplot_+3A_pc.biplot">pc.biplot</code></td>
<td>
<p>logical. If TRUE it will produce a &quot;principal component biplot&quot; (sensu Gabriel, 1971). Same as in &quot;stats::biplot.princomp&quot;. See ?biplot.princomp for more information.</p>
</td></tr>
<tr><td><code id="doBiplot_+3A_col">col</code></td>
<td>
<p>character vector of length 3 with the colors of the biplot. First color is used for the score points (or sample sames), second color for arrows and variable names, and third color for the right and top-side ticks (plot axes).</p>
</td></tr>
<tr><td><code id="doBiplot_+3A_...">...</code></td>
<td>
<p>extra parameters for the function. Same as &quot;stats::biplot&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function has the same options as &quot;stats::biplot&quot;, with the addition of the following arguments. &quot;plot_dimnames&quot; controls is the names of the samples (species) will be plotted. &quot;add_points&quot; controls if the score points will be plotted. &quot;add_margin&quot; is a numeric value that expands the area of the plot. You can use this to make sure the names of variables and samples (species) fit the plot.
</p>


<h3>Value</h3>

<p>makes a biplot of the PCA results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phy &lt;- ratematrix::anoles$phy[[1]]
dt &lt;- as.matrix( ratematrix::anoles$data[,1:3] )

## Using probabilistic phylogenetic PCA
phylppca &lt;- phylProbPCA(phy = phy, x = dt, ret_dim = 2)
doBiplot(x = phylppca, add_margin = 0.3)

## Using standard phylogenetic PCA
phylpca &lt;- phytools::phyl.pca(tree = phy, Y = dt)
doBiplot(x = phylpca, add_margin = 0.3)

## Using probabilistic PCA
ppca &lt;- ProbPCA(x = dt)
doBiplot(x = ppca, add_margin = 0.3)

## Using standard PCA
pca1 &lt;- princomp(x = dt)
doBiplot(x = pca1, add_margin = 0.1)

## Using standard PCA
pca2 &lt;- prcomp(x = dt)
doBiplot(x = pca2, add_margin = 0.1)

</code></pre>

<hr>
<h2 id='phylProbPCA'>Probabilistic Phylogenetic PCA</h2><span id='topic+phylProbPCA'></span>

<h3>Description</h3>

<p>Function to perform probabilistic phylogenetic PCA. Allows for fit of alternative models of trait evolution using branch length transformation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylProbPCA(phy, x, ret_dim = 2, model = "BM", quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phylProbPCA_+3A_phy">phy</code></td>
<td>
<p>phylogeny in &quot;phylo&quot; format.</p>
</td></tr>
<tr><td><code id="phylProbPCA_+3A_x">x</code></td>
<td>
<p>a matrix with traits in columns and species values in rows. Rownames must match the tip labels of phylogeny.</p>
</td></tr>
<tr><td><code id="phylProbPCA_+3A_ret_dim">ret_dim</code></td>
<td>
<p>number of dimensions (PC axes) to be kept by the model.</p>
</td></tr>
<tr><td><code id="phylProbPCA_+3A_model">model</code></td>
<td>
<p>choice of model of trait evolution. One of &quot;BM&quot;, &quot;lambda&quot;, &quot;OU&quot;, or &quot;EB&quot;.</p>
</td></tr>
<tr><td><code id="phylProbPCA_+3A_quiet">quiet</code></td>
<td>
<p>if function should suppress output to the console while running</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can be used to estimate the probabilistic phylogenetic PCA (3PCA) using distinct models of trait evolution. Models are implemented using branch length transformation. Model fitting happens in two steps. First the maximum likelihood of the evolutionary covariance matrix (R) and the parameter of the model is estimated. Then the 3PCA model is estimated using the phylogenetic tree with branch lengths transformed following the MLE for the parameter of each trait evolution model.
</p>
<p>The function returns a list with the following elements. scores: the scores of the principal components; e_values: eigenvalues; e_vectors: eigenvectors or the projection; model_fit: information about the trait evolution model; loadings: the loadings of the PCs; varnames: the names of the variables; sig: the MLE of the error; mle.W: the MLE of the W matrix; Function also returns AIC, AICc, and BIC for the model.
</p>


<h3>Value</h3>

<p>returns a list of class &quot;phylPPCA&quot;. See &quot;Details&quot; for more information.
</p>


<h3>References</h3>

<p>Revell, L. J. 2009. Size-Correction and Principal Components for Interspecific Comparative Studies. Evolution 63:3258–3268. doi: 10.1111/j.1558-5646.2009.00804.x
</p>
<p>Revell, L. J. 2024. phytools 2.0: an updated R ecosystem for phylogenetic comparative methods (and other things). PeerJ 12:e16505. doi: 10.7717/peerj.16505
</p>
<p>Tipping, M. E., and C. M. Bishop. 1999. Probabilistic Principal Component Analysis. Journal of the Royal Statistical Society Series B: Statistical Methodology 61(3):611–622. doi: 10.1111/1467-9868.00196
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phy &lt;- ratematrix::anoles$phy[[1]]
dt &lt;- as.matrix( ratematrix::anoles$data[,1:3] )
ppca &lt;- phylProbPCA(phy = phy, x = dt, ret_dim = 2)
doBiplot(x = ppca, add_margin = 0.3)

</code></pre>

<hr>
<h2 id='ProbPCA'>Probabilistic PCA</h2><span id='topic+ProbPCA'></span>

<h3>Description</h3>

<p>Function to perform (non-phylogenetic) probabilistic PCA. This function is a modification (fork) of Rdimtools::do.ppca .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ProbPCA(x, ret_dim = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ProbPCA_+3A_x">x</code></td>
<td>
<p>a matrix with traits in columns and observations in rows.</p>
</td></tr>
<tr><td><code id="ProbPCA_+3A_ret_dim">ret_dim</code></td>
<td>
<p>number of dimensions (PC axes) to be kept by the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the same algorithm as Rdimtools::do.ppca. However, it returns more details from the estimation and computes AIC and AICc.
</p>
<p>The function returns a list with the following elements. scores: the scores of the principal components; projection: the eigenvectors; sig: the MLE of the error of the model; mle.W: the MLE of the W matrix: varnames: the names of the traits; loglik: the log-likelihood of the estimate. Function also returns AIC, AICc, and BIC for the model.
</p>


<h3>Value</h3>

<p>returns a list of class &quot;phylPPCA&quot;. See &quot;Details&quot; for more information.
</p>


<h3>References</h3>

<p>Tipping, M. E., and C. M. Bishop. 1999. Probabilistic Principal Component Analysis. Journal of the Royal Statistical Society Series B: Statistical Methodology 61(3):611–622. doi: 10.1111/1467-9868.00196
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dt &lt;- as.matrix( ratematrix::anoles$data[,1:3] )
ppca &lt;- ProbPCA(x = dt, ret_dim = 2)
doBiplot(x = ppca, add_margin = 0.3)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
