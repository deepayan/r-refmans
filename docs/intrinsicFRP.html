<!DOCTYPE html><html><head><title>Help for package intrinsicFRP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {intrinsicFRP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ChenFang2019BetaRankTest'><p>Asset Pricing Model Identification via Chen-Fang (2019) Beta Rank Test</p></a></li>
<li><a href='#factors'><p>Factors - monthly observations from <code>01/1970</code> to <code>12/2021</code></p></a></li>
<li><a href='#FRP'><p>Factor risk premia.</p></a></li>
<li><a href='#GKRFactorScreening'><p>Factor screening procedure of Gospodinov-Kan-Robotti (2014)</p></a></li>
<li><a href='#HACcovariance'><p>Heteroskedasticity and Autocorrelation robust covariance estimator</p></a></li>
<li><a href='#HJMisspecificationDistance'><p>Compute the HJ asset pricing model misspecification distance.</p></a></li>
<li><a href='#IterativeKleibergenPaap2006BetaRankTest'><p>Asset Pricing Model Identification via Iterative Kleibergen-Paap 2006 Beta Rank Test</p></a></li>
<li><a href='#OracleTFRP'><p>Oracle tradable factor risk premia.</p></a></li>
<li><a href='#returns'><p>Test Asset Excess Returns - monthly observations from <code>01/1970</code> to <code>12/2021</code></p></a></li>
<li><a href='#TFRP'><p>Tradable factor risk premia.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>An R Package for Factor Model Asset Pricing</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-07</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alberto Quaini &lt;alberto91quaini@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for evaluating and testing asset pricing models, including
    estimation and testing of factor risk premia, selection of "strong" risk 
    factors (factors having nonzero population correlation with test asset
    returns), heteroskedasticity and autocorrelation robust covariance matrix
    estimation and testing for model misspecification and identification. 
    The functions for estimating and testing factor risk 
    premia implement the Fama-MachBeth (1973) &lt;<a href="https://doi.org/10.1086%2F260061">doi:10.1086/260061</a>&gt; two-pass 
    approach, the misspecification-robust approaches of Kan-Robotti-Shanken (2013) 
    &lt;<a href="https://doi.org/10.1111%2Fjofi.12035">doi:10.1111/jofi.12035</a>&gt;, and the approaches based on tradable factor risk
    premia of Quaini-Trojani-Yuan (2023) &lt;<a href="https://doi.org/10.2139%2Fssrn.4574683">doi:10.2139/ssrn.4574683</a>&gt;. The 
    functions for selecting the "strong" risk factors are based on the Oracle
    estimator of Quaini-Trojani-Yuan (2023) &lt;<a href="https://doi.org/10.2139%2Fssrn.4574683">doi:10.2139/ssrn.4574683</a>&gt; and the 
    factor screening procedure of Gospodinov-Kan-Robotti (2014) &lt;<a href="https://doi.org/10.2139%2Fssrn.2579821">doi:10.2139/ssrn.2579821</a>&gt;. 
    The functions for evaluating model misspecification implement the HJ
    model misspecification distance of Kan-Robotti (2008) &lt;<a href="https://doi.org/10.1016%2Fj.jempfin.2008.03.003">doi:10.1016/j.jempfin.2008.03.003</a>&gt;,
    which is a modification of the prominent Hansen-Jagannathan (1997)
    &lt;<a href="https://doi.org/10.1111%2Fj.1540-6261.1997.tb04813.x">doi:10.1111/j.1540-6261.1997.tb04813.x</a>&gt; distance.
    The functions for testing model identification 
    specialize the Kleibergen-Paap (2006) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2005.02.011">doi:10.1016/j.jeconom.2005.02.011</a>&gt; 
    and the Chen-Fang (2019) &lt;<a href="https://doi.org/10.1111%2Fj.1540-6261.1997.tb04813.x">doi:10.1111/j.1540-6261.1997.tb04813.x</a>&gt; rank test 
    to the regression coefficient matrix of test asset returns on risk factors.
    Finally, the function for heteroskedasticity and autocorrelation robust 
    covariance estimation implements the Newey-West (1994) &lt;<a href="https://doi.org/10.2307%2F2297912">doi:10.2307/2297912</a>&gt;
    covariance estimator.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/a91quaini/intrinsicFRP">https://github.com/a91quaini/intrinsicFRP</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/a91quaini/intrinsicFRP/issues">https://github.com/a91quaini/intrinsicFRP/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, Rcpp</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-07 11:51:47 UTC; albertoquaini</td>
</tr>
<tr>
<td>Author:</td>
<td>Alberto Quaini <a href="https://orcid.org/0000-0002-1251-0599"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-08 11:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ChenFang2019BetaRankTest'>Asset Pricing Model Identification via Chen-Fang (2019) Beta Rank Test</h2><span id='topic+ChenFang2019BetaRankTest'></span>

<h3>Description</h3>

<p>Tests the null hypothesis of reduced rank in the matrix of regression
loadings for test asset excess returns on risk factors using the Chen-Fang (2019)
<a href="doi:10.3982/QE1139">doi:10.3982/QE1139</a>
beta rank test. The test applies the Kleibergen-Paap (2006) <a href="doi:10.1016/j.jeconom.2005.02.011">doi:10.1016/j.jeconom.2005.02.011</a>
iterative rank test
for initial rank estimation when <code>target_level_kp2006_rank_test &gt; 0</code>, with an
adjustment to <code>level = target_level_kp2006_rank_test / n_factors</code>. When
<code>target_level_kp2006_rank_test &lt;= 0</code>, the number of singular values above
<code>n_observations^(-1/4)</code> is used instead. It presumes that the number of factors
is less than the number of returns (<code>n_factors &lt; n_returns</code>).
All the details can be found in Chen-Fang (2019)
<a href="doi:10.3982/QE1139">doi:10.3982/QE1139</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ChenFang2019BetaRankTest(
  returns,
  factors,
  n_bootstrap = 500,
  target_level_kp2006_rank_test = 0.05,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ChenFang2019BetaRankTest_+3A_returns">returns</code></td>
<td>
<p>Matrix of test asset excess returns with dimensions <code style="white-space: pre;">&#8288;n_observations x n_returns&#8288;</code>.</p>
</td></tr>
<tr><td><code id="ChenFang2019BetaRankTest_+3A_factors">factors</code></td>
<td>
<p>Matrix of risk factors with dimensions <code style="white-space: pre;">&#8288;n_observations x n_factors&#8288;</code>.</p>
</td></tr>
<tr><td><code id="ChenFang2019BetaRankTest_+3A_n_bootstrap">n_bootstrap</code></td>
<td>
<p>The number of bootstrap samples to use in the Chen-Fang (2019) test.
Defaults to 500 if not specified.</p>
</td></tr>
<tr><td><code id="ChenFang2019BetaRankTest_+3A_target_level_kp2006_rank_test">target_level_kp2006_rank_test</code></td>
<td>
<p>The significance level for the Kleibergen-Paap (2006)
rank test used for initial rank estimation. If set above 0, it indicates the level for this
estimation within the Chen-Fang (2019) rank test. If set at 0 or negative, the initial rank
estimator defaults to the count of singular values exceeding <code>n_observations^(-1/4)</code>.
The default value is <code>0.05</code> to account for multiple testing.</p>
</td></tr>
<tr><td><code id="ChenFang2019BetaRankTest_+3A_check_arguments">check_arguments</code></td>
<td>
<p>Logical flag to determine if input arguments should be checked for validity.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the Chen-Fang (2019) rank statistic and the associated p-value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># import package data on 6 risk factors and 42 test asset excess returns
factors = intrinsicFRP::factors[,-1]
returns = intrinsicFRP::returns[,-1]

# compute the model identification test
hj_test = ChenFang2019BetaRankTest(returns, factors)

</code></pre>

<hr>
<h2 id='factors'>Factors - monthly observations from <code>01/1970</code> to <code>12/2021</code></h2><span id='topic+factors'></span>

<h3>Description</h3>

<p>Monthly observations from <code>01/1970</code> to <code>12/2021</code> of
the Fama-French <code>5</code> factors and the momentum factor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factors
</code></pre>


<h3>Format</h3>



<h4><code>factors</code></h4>

<p>A data frame with <code>624</code> rows and <code>7</code> columns:
</p>

<dl>
<dt>Date</dt><dd><p>Date in yyyymm format</p>
</dd>
<dt>...</dt><dd><p>Factor observations</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html">https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html</a>
</p>

<hr>
<h2 id='FRP'>Factor risk premia.</h2><span id='topic+FRP'></span>

<h3>Description</h3>

<p>Computes the Fama-MachBeth (1973) <a href="doi:10.1086/260061">doi:10.1086/260061</a> factor
risk premia:
<code style="white-space: pre;">&#8288;FMFRP = (beta' * beta)^{-1} * beta' * E[R]&#8288;</code> where
<code>beta = Cov[R, F] * V[F]^{-1}</code>
or the misspecification-robust factor risk premia of Kan-Robotti-Shanken (2013)
<a href="doi:10.1111/jofi.12035">doi:10.1111/jofi.12035</a>:
<code style="white-space: pre;">&#8288;KRSFRP = (beta' * V[R]^{-1} * beta)^{-1} * beta' * V[R]^{-1} * E[R]&#8288;</code>,
from data on factors <code>F</code> and test
asset excess returns <code>R</code>.
These notions of factor risk premia are by construction the negative
covariance of factors <code>F</code> with candidate SDF
<code style="white-space: pre;">&#8288;M = 1 - d' * (F - E[F])&#8288;</code>,
where SDF coefficients <code>d</code> are obtained by minimizing pricing errors:
<code style="white-space: pre;">&#8288;argmin_{d} (E[R] - Cov[R,F] * d)' * (E[R] - Cov[R,F] * d)&#8288;</code>
and
<code style="white-space: pre;">&#8288;argmin_{d} (E[R] - Cov[R,F] * d)' * V[R]^{-1} * (E[R] - Cov[R,F] * d)&#8288;</code>,
respectively.
Optionally computes the corresponding
heteroskedasticity and autocorrelation robust standard errors using the
Newey-West (1994) <a href="doi:10.2307/2297912">doi:10.2307/2297912</a> plug-in procedure to select the
number of relevant lags, i.e., <code>n_lags = 4 * (n_observations/100)^(2/9)</code>.
For the standard error computations, the function allows to internally
pre-whiten the series by fitting a VAR(1),
i.e., a vector autoregressive model of order 1.
All the details can be found in Kan-Robotti-Shanken (2013)
<a href="doi:10.1111/jofi.12035">doi:10.1111/jofi.12035</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FRP(
  returns,
  factors,
  misspecification_robust = TRUE,
  include_standard_errors = FALSE,
  hac_prewhite = FALSE,
  target_level_gkr2014_screening = 0,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FRP_+3A_returns">returns</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;n_observations x n_returns&#8288;</code>-dimensional matrix of test asset
excess returns.</p>
</td></tr>
<tr><td><code id="FRP_+3A_factors">factors</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;n_observations x n_factors&#8288;</code>-dimensional matrix of factors.</p>
</td></tr>
<tr><td><code id="FRP_+3A_misspecification_robust">misspecification_robust</code></td>
<td>
<p>A boolean: <code>TRUE</code> for the
&quot;misspecification-robust&quot; Kan-Robotti-Shanken (2013) GLS approach using the
inverse covariance matrix of returns; <code>FALSE</code> for standard Fama-MacBeth
risk premia. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="FRP_+3A_include_standard_errors">include_standard_errors</code></td>
<td>
<p>A boolean: <code>TRUE</code> if you want to compute the
factor risk premia HAC standard errors; <code>FALSE</code> otherwise.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="FRP_+3A_hac_prewhite">hac_prewhite</code></td>
<td>
<p>A boolean indicating if the series needs pre-whitening by
fitting an AR(1) in the internal heteroskedasticity and autocorrelation
robust covariance (HAC) estimation. Default is <code>false</code>.</p>
</td></tr>
<tr><td><code id="FRP_+3A_target_level_gkr2014_screening">target_level_gkr2014_screening</code></td>
<td>
<p>A number indicating the target level of
the tests underlying the factor screening procedure in Gospodinov-Kan-Robotti
(2014). If it is zero, then no factor screening procedure is
implemented. Otherwise, it implements an iterative screening procedure
based on the sequential removal of factors associated with the smallest insignificant
t-test of a nonzero SDF coefficient. The threshold for the absolute t-test is
<code>target_level_gkr2014_screening / n_factors</code>, where n_factors indicate the
number of factors in the model at the current iteration. Default is <code>0.</code>, i.e.,
no factor screening.</p>
</td></tr>
<tr><td><code id="FRP_+3A_check_arguments">check_arguments</code></td>
<td>
<p>A boolean: <code>TRUE</code> for internal check of all function
arguments; <code>FALSE</code> otherwise. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing <code>n_factors</code>-dimensional vector of factor
risk premia in <code>"risk_premia"</code>; if <code>include_standard_errors = TRUE</code>, then
it further includes <code>n_factors</code>-dimensional vector of factor risk
premia standard errors in <code>"standard_errors"</code>;
if <code>target_level_gkr2014_screening &gt;= 0</code>, it further includes the indices of
the selected factors in <code>selected_factor_indices</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># import package data on 6 risk factors and 42 test asset excess returns
factors = intrinsicFRP::factors[,-1]
returns = intrinsicFRP::returns[,-1]

# compute KRS factor risk premia and their standard errors
frp = FRP(returns, factors, include_standard_errors = TRUE)

</code></pre>

<hr>
<h2 id='GKRFactorScreening'>Factor screening procedure of Gospodinov-Kan-Robotti (2014)</h2><span id='topic+GKRFactorScreening'></span>

<h3>Description</h3>

<p>Performs the factor screening procedure of
Gospodinov-Kan-Robotti (2014) <a href="doi:10.2139/ssrn.2579821">doi:10.2139/ssrn.2579821</a>, which is
an iterative model screening procedure
based on the sequential removal of factors associated with the smallest insignificant
t-test of a nonzero misspecification-robust SDF coefficient. The significance threshold for the
absolute t-test is set to <code>target_level / n_factors</code>,
where n_factors indicates the number of factors in the model at the current iteration;
that is, it takes care of the multiple testing problem via a conservative
Bonferroni correction. Standard errors are computed with the
heteroskedasticity and autocorrelation using the Newey-West (1994)
<a href="doi:10.2307/2297912">doi:10.2307/2297912</a> estimator, where the number of lags
is selected using the Newey-West plug-in procedure:
<code>n_lags = 4 * (n_observations/100)^(2/9)</code>.
For the standard error computations, the function allows to internally
pre-whiten the series by fitting a VAR(1),
i.e., a vector autoregressive model of order 1.
All the details can be found in Gospodinov-Kan-Robotti (2014) <a href="doi:10.2139/ssrn.2579821">doi:10.2139/ssrn.2579821</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GKRFactorScreening(
  returns,
  factors,
  target_level = 0.05,
  hac_prewhite = FALSE,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GKRFactorScreening_+3A_returns">returns</code></td>
<td>
<p><code style="white-space: pre;">&#8288;n_observations x n_returns&#8288;</code>-dimensional matrix of test asset
excess returns.</p>
</td></tr>
<tr><td><code id="GKRFactorScreening_+3A_factors">factors</code></td>
<td>
<p><code style="white-space: pre;">&#8288;n_observations x n_factors&#8288;</code>-dimensional matrix of risk
factors.</p>
</td></tr>
<tr><td><code id="GKRFactorScreening_+3A_target_level">target_level</code></td>
<td>
<p>Number specifying the target significance threshold for the
tests underlying the GKR factor screening procedure.
To account for the multiple testing problem, the significance threshold for the
absolute t-test is given by <code>target_level_gkr2014_screening / n_factors</code>,
where n_factors indicate the number of factors in the model at the current iteration.
Default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="GKRFactorScreening_+3A_hac_prewhite">hac_prewhite</code></td>
<td>
<p>A boolean indicating if the series needs prewhitening by
fitting an AR(1) in the internal heteroskedasticity and autocorrelation
robust covariance (HAC) estimation. Default is <code>false</code>.</p>
</td></tr>
<tr><td><code id="GKRFactorScreening_+3A_check_arguments">check_arguments</code></td>
<td>
<p>boolean <code>TRUE</code> for internal check of all function
arguments; <code>FALSE</code> otherwise. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contaning the selected GKR SDF coefficients in <code>SDF_coefficients</code>,
their standard errors in <code>standard_errors</code>,
t-statistics in <code>t_statistics</code> and indices in the columns of the factor matrix <code>factors</code>
supplied by the user in <code>selected_factor_indices</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># import package data on 6 risk factors and 42 test asset excess returns
factors = intrinsicFRP::factors[,-1]
returns = intrinsicFRP::returns[,-1]

# Perform the GKR factor screening procedure
screen = GKRFactorScreening(returns, factors)

</code></pre>

<hr>
<h2 id='HACcovariance'>Heteroskedasticity and Autocorrelation robust covariance estimator</h2><span id='topic+HACcovariance'></span>

<h3>Description</h3>

<p>This function estimates the long-run covariance matrix of a multivariate
centred time series accounting for heteroskedasticity and autocorrelation
using the Newey-West (1994)
<a href="doi:10.2307/2297912">doi:10.2307/2297912</a> estimator.
The number is selected using the Newey-West plug-in procedure, where
<code>n_lags = 4 * (n_observations/100)^(2/9)</code>.
The function allows to internally prewhiten the series by fitting a VAR(1).
All the details can be found in Newey-West (1994)
<a href="doi:10.2307/2297912">doi:10.2307/2297912</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HACcovariance(series, prewhite = FALSE, check_arguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HACcovariance_+3A_series">series</code></td>
<td>
<p>A matrix (or vector) of data where each column is a time series.</p>
</td></tr>
<tr><td><code id="HACcovariance_+3A_prewhite">prewhite</code></td>
<td>
<p>A boolean indicating if the series needs prewhitening by
fitting an AR(1). Default is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="HACcovariance_+3A_check_arguments">check_arguments</code></td>
<td>
<p>A boolean <code>TRUE</code> for internal check of all function
arguments; <code>FALSE</code> otherwise. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A symmetric matrix (or a scalar if only one column series is provided)
representing the estimated HAC covariance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import package data on 6 risk factors and 42 test asset excess returns
returns = intrinsicFRP::returns[,-1]
factors = intrinsicFRP::factors[,-1]

# Fit a linear model of returns on factors
fit = stats::lm(returns ~ factors)

# Extract residuals from the model
residuals = stats::residuals(fit)

# Compute the HAC covariance of the residuals
hac_covariance = HACcovariance(residuals)

# Compute the HAC covariance of the residuals imposing prewhitening
hac_covariance_pw = HACcovariance(residuals, prewhite = TRUE)

</code></pre>

<hr>
<h2 id='HJMisspecificationDistance'>Compute the HJ asset pricing model misspecification distance.</h2><span id='topic+HJMisspecificationDistance'></span>

<h3>Description</h3>

<p>Computes the Kan-Robotti (2008) &lt;10.1016/j.jempfin.2008.03.003&gt;
squared model misspecification distance:
<code style="white-space: pre;">&#8288;square_distance = min_{d} (E[R] - Cov[R,F] * d)' * V[R]^{-1} * (E[R] - Cov[R,F] * d)&#8288;</code>,
where <code>R</code> denotes test asset excess returns and <code>F</code> risk factors,
and computes the associated confidence interval.
This model misspecification distance is a modification of the prominent
Hansen-Jagannathan (1997) <a href="doi:10.1111/j.1540-6261.1997.tb04813.x">doi:10.1111/j.1540-6261.1997.tb04813.x</a>
distance, adapted to the use of excess returns for the test asset, and a
SDF that is a linear function of demeaned factors.
Clearly, computation of the confidence interval is obtained by means of an
asymptotic analysis under potentially misspecified models, i.e.,
without assuming correct model specification.
Details can be found in Kan-Robotti (2008) &lt;10.1016/j.jempfin.2008.03.003&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HJMisspecificationDistance(
  returns,
  factors,
  ci_coverage = 0.95,
  hac_prewhite = FALSE,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HJMisspecificationDistance_+3A_returns">returns</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;n_observations x n_returns&#8288;</code> matrix of test asset excess returns.</p>
</td></tr>
<tr><td><code id="HJMisspecificationDistance_+3A_factors">factors</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;n_observations x n_factors&#8288;</code> matrix of risk factors.</p>
</td></tr>
<tr><td><code id="HJMisspecificationDistance_+3A_ci_coverage">ci_coverage</code></td>
<td>
<p>A number indicating the confidence interval coverage
probability. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="HJMisspecificationDistance_+3A_hac_prewhite">hac_prewhite</code></td>
<td>
<p>A boolean indicating if the series needs pre-whitening by
fitting an AR(1) in the internal heteroskedasticity and autocorrelation
robust covariance (HAC) estimation. Default is <code>false</code>.</p>
</td></tr>
<tr><td><code id="HJMisspecificationDistance_+3A_check_arguments">check_arguments</code></td>
<td>
<p>A boolean: <code>TRUE</code> for internal check of all function
arguments; <code>FALSE</code> otherwise. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>@return A list containing the squared misspecification-robust HJ
distance in <code>squared_distance</code>, and the lower and upper confidence bounds
in <code>lower_bound</code> and <code>upper_bound</code>, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import package data on 6 risk factors and 42 test asset excess returns
factors = intrinsicFRP::factors[,-1]
returns = intrinsicFRP::returns[,-1]

# Compute the HJ model misspecification distance
hj_test = HJMisspecificationDistance(returns, factors)

</code></pre>

<hr>
<h2 id='IterativeKleibergenPaap2006BetaRankTest'>Asset Pricing Model Identification via Iterative Kleibergen-Paap 2006 Beta Rank Test</h2><span id='topic+IterativeKleibergenPaap2006BetaRankTest'></span>

<h3>Description</h3>

<p>Evaluates the rank of regression loadings in an asset pricing model using the
iterative Kleibergen-Paap (2006) <a href="doi:10.1016/j.jeconom.2005.02.011">doi:10.1016/j.jeconom.2005.02.011</a> beta rank test.
It systematically tests the null hypothesis
for each potential rank <code style="white-space: pre;">&#8288;q = 0, ..., n_factors - 1&#8288;</code> and estimates the rank as the smallest <code>q</code>
that has a p-value below the significance level, adjusted for the number of factors.
The function presupposes more returns than factors (<code>n_factors &lt; n_returns</code>).
All the details can be found in Kleibergen-Paap (2006) <a href="doi:10.1016/j.jeconom.2005.02.011">doi:10.1016/j.jeconom.2005.02.011</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IterativeKleibergenPaap2006BetaRankTest(
  returns,
  factors,
  target_level = 0.05,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IterativeKleibergenPaap2006BetaRankTest_+3A_returns">returns</code></td>
<td>
<p>A matrix of test asset excess returns with dimensions <code style="white-space: pre;">&#8288;n_observations x n_returns&#8288;</code>.</p>
</td></tr>
<tr><td><code id="IterativeKleibergenPaap2006BetaRankTest_+3A_factors">factors</code></td>
<td>
<p>A matrix of risk factors with dimensions <code style="white-space: pre;">&#8288;n_observations x n_factors&#8288;</code>.</p>
</td></tr>
<tr><td><code id="IterativeKleibergenPaap2006BetaRankTest_+3A_target_level">target_level</code></td>
<td>
<p>A numeric value specifying the significance level for the test. For each
hypothesis test <code>H: rank(beta) = q</code>, the significance level is adjusted to
<code>target_level / n_factors</code>. The default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="IterativeKleibergenPaap2006BetaRankTest_+3A_check_arguments">check_arguments</code></td>
<td>
<p>Logical flag indicating whether to perform internal checks of the
function's arguments. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing estimates of the regression loading rank and the associated
iterative Kleibergen-Paap 2006 beta rank statistics and p-values for each <code>q</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># import package data on 15 risk factors and 42 test asset excess returns
factors = intrinsicFRP::factors[,-1]
returns = intrinsicFRP::returns[,-1]

# compute the model identification test
hj_test = ChenFang2019BetaRankTest(returns, factors)

</code></pre>

<hr>
<h2 id='OracleTFRP'>Oracle tradable factor risk premia.</h2><span id='topic+OracleTFRP'></span>

<h3>Description</h3>

<p>Computes Oracle tradable factor risk premia of
Quaini-Trojani-Yuan (2023) <a href="doi:10.2139/ssrn.4574683">doi:10.2139/ssrn.4574683</a> from data on
<code>K</code> factors <code style="white-space: pre;">&#8288;F = [F_1,...,F_K]'&#8288;</code> and test asset excess returns <code>R</code>:
<code style="white-space: pre;">&#8288;OTFRP = argmin_x ||TFRP - x||_2^2 + tau * sum_{k=1}^K w_k * |x_k|&#8288;</code>,
where <code>TFRP</code> is the tradable factor risk premia estimator, <code>tau &gt; 0</code> is a
penalty parameter, and the Oracle weights are given by
<code style="white-space: pre;">&#8288;w_k = 1 / ||corr[F_k, R]||_2^2&#8288;</code>.
This estimator is called &quot;Oracle&quot; in the sense that the probability that
the index set of its nonzero estimated risk premia equals the index set of
the true strong factors tends to 1 (Oracle selection), and that on the strong
factors, the estimator reaches the optimal asymptotic Normal distribution.
Here, strong factors are those that have a nonzero population marginal
correlation with asset excess returns.
Tuning of the penalty parameter <code>tau</code> is performed via Generalized Cross
Validation (GCV), Cross Validation (CV) or Rolling Validation (RV).
GCV tunes parameter <code>tau</code> by minimizing the criterium:
<code style="white-space: pre;">&#8288;||PE(tau)||_2^2 / (1-df(tau)/T)^2&#8288;</code>
where
<code style="white-space: pre;">&#8288;PE(tau) = E[R] - beta_{S(tau)} * OTFRP(tau)&#8288;</code>
are the pricing errors of the model for given tuning parameter <code>tau</code>,
with <code>S(tau)</code> being the index set of the nonzero Oracle TFRP computed with
tuning parameter <code>tau</code>, and
<code style="white-space: pre;">&#8288;beta_{S(tau)} = Cov[R, F_{S(tau)}] * (Cov[F_{S(tau)}, R] * V[R]^{-1} * Cov[R, F_{S(tau)}])^{-1}&#8288;</code>
the regression coefficients of the test assets excess returns on the
factor mimicking portfolios,
and <code style="white-space: pre;">&#8288;df(tau) = |S(tau)|&#8288;</code> are the degrees of freedom of the model, given by the
number of nonzero Oracle TFRP.
CV and RV, instead, choose the value of <code>tau</code> that minimize the criterium:
<code style="white-space: pre;">&#8288;PE(tau)' * V[PE(tau)]^{-1} PE(tau)&#8288;</code>
where <code>V[PE(tau)]</code> is the diagonal matrix collecting the marginal variances
of pricing errors <code>PE(tau)</code>, and each of these components are
aggregated over k-fold cross-validated data or over rolling windows of data,
respectively.
Oracle weights can be based on the correlation between factors and returns
(suggested approach),
on the regression coefficients of returns on factors or on the first-step
tradable risk premia estimator. Optionally computes the corresponding
heteroskedasticity and autocorrelation robust standard errors using the
Newey-West (1994) <a href="doi:10.2307/2297912">doi:10.2307/2297912</a> plug-in procedure to select the number
of relevant lags, i.e., <code>n_lags = 4 * (n_observations/100)^(2/9)</code>.
For the standard error computations, the function allows to internally
pre-whiten the series by fitting a VAR(1),
i.e., a vector autoregressive model of order 1.
All details are found in Quaini-Trojani-Yuan (2023) <a href="doi:10.2139/ssrn.4574683">doi:10.2139/ssrn.4574683</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OracleTFRP(
  returns,
  factors,
  penalty_parameters,
  weighting_type = "c",
  tuning_type = "g",
  one_stddev_rule = TRUE,
  gcv_scaling_n_assets = FALSE,
  gcv_identification_check = FALSE,
  target_level_kp2006_rank_test = 0.05,
  n_folds = 5,
  n_train_observations = 120,
  n_test_observations = 12,
  roll_shift = 12,
  relaxed = FALSE,
  include_standard_errors = FALSE,
  hac_prewhite = FALSE,
  plot_score = TRUE,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OracleTFRP_+3A_returns">returns</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;n_observations x n_returns&#8288;</code>-dimensional matrix of test asset
excess returns.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_factors">factors</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;n_observations x n_factors&#8288;</code>-dimensional matrix of factors.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_penalty_parameters">penalty_parameters</code></td>
<td>
<p>A <code>n_parameters</code>-dimensional vector of penalty
parameter values from smallest to largest.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_weighting_type">weighting_type</code></td>
<td>
<p>A character specifying the type of adaptive weights:
based on the correlation between factors and returns <code>'c'</code>; based on the
regression coefficients of returns on factors <code>'b'</code>; based on the first-step
tradable risk premia estimator <code>'a'</code>; otherwise a vector of ones (any other
character). Default is <code>'c'</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_tuning_type">tuning_type</code></td>
<td>
<p>A character indicating the parameter tuning type:
<code>'g'</code> for generalized cross validation; <code>'c'</code> for K-fold cross validation;
<code>'r'</code> for rolling validation. Default is <code>'g'</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_one_stddev_rule">one_stddev_rule</code></td>
<td>
<p>A boolean: <code>TRUE</code> for picking the most parsimonious model
whose score is not higher than one standard error above the score of the
best model; <code>FALSE</code> for picking the best model. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_gcv_scaling_n_assets">gcv_scaling_n_assets</code></td>
<td>
<p>(only relevant for <code>tuning_type ='g'</code>)
A boolean: <code>TRUE</code> for sqrt(n_assets) scaling (<code>sqrt(n_assets) / n_observations</code>);
<code>FALSE</code> otherwise (<code>1 / n_observations</code>). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_gcv_identification_check">gcv_identification_check</code></td>
<td>
<p>(only relevant for <code>tuning_type ='g'</code>)
A boolean: <code>TRUE</code> for a loose check for model
identification; <code>FALSE</code> otherwise. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_target_level_kp2006_rank_test">target_level_kp2006_rank_test</code></td>
<td>
<p>(only relevant for <code>tuning_type ='g'</code>
and if <code>gcv_identification_check</code> is
<code>TRUE</code>) A number indicating the level of the Kleibergen Paap 2006 rank test.
If it is strictly grater than zero, then the iterative Kleibergen Paap 2006 rank
test at <code>level = target_level_kp2006_rank_test / n_factors</code>
(where division by the number of factors is performed as a Bonferroni correction for
multiple testing) is used to compute an initial estimator
of the rank of the factor loadings in the Chen Fang 2019 rank test.
Otherwise, the initial rank estimator is taken to be the number of singular
values above <code>n_observations^(-1/4)</code>.
Default is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_n_folds">n_folds</code></td>
<td>
<p>(only relevant for <code>tuning_type ='c'</code>) An integer indicating
the number of k-fold for cross validation. Default is <code>5</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_n_train_observations">n_train_observations</code></td>
<td>
<p>(only relevant for <code>tuning_type ='r'</code>) The number of
observations in the rolling training set. Default is <code>120</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_n_test_observations">n_test_observations</code></td>
<td>
<p>(only relevant for <code>tuning_type ='r'</code>) The number of
observations in the test set. Default is <code>12</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_roll_shift">roll_shift</code></td>
<td>
<p>(only relevant for <code>tuning_type ='r'</code>) The number of observation
shift when moving from the rolling window to the next one. Default is <code>12</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_relaxed">relaxed</code></td>
<td>
<p>A boolean: <code>TRUE</code> if you want to compute a post-selection
unpenalized tradable factor risk premia to remove the bias due to shrinkage;
FALSE<code style="white-space: pre;">&#8288;otherwise. Default is&#8288;</code>FALSE'.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_include_standard_errors">include_standard_errors</code></td>
<td>
<p>A boolean <code>TRUE</code> if you want to compute the
adaptive tradable factor risk premia HAC standard errors; <code>FALSE</code> otherwise.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_hac_prewhite">hac_prewhite</code></td>
<td>
<p>A boolean indicating if the series needs prewhitening by
fitting an AR(1) in the internal heteroskedasticity and autocorrelation
robust covariance (HAC) estimation. Default is <code>false</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_plot_score">plot_score</code></td>
<td>
<p>A boolean: <code>TRUE</code> for plotting the model score; <code>FALSE</code> otherwise.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="OracleTFRP_+3A_check_arguments">check_arguments</code></td>
<td>
<p>A boolean <code>TRUE</code> for internal check of all function
arguments; <code>FALSE</code> otherwise. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the <code>n_factors</code>-dimensional vector of adaptive
tradable factor risk premia in <code>"risk_premia"</code>; the optimal penalty
parameter value in <code>"penalty_parameter"</code>; the model score for each penalty
parameter value in <code>"model_score"</code>;  if <code>include_standard_errors = TRUE</code>, then
it further includes <code>n_factors</code>-dimensional vector of tradable factor risk
premia standard errors in <code>"standard_errors"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># import package data on 6 risk factors and 42 test asset excess returns
factors = intrinsicFRP::factors[,-1]
returns = intrinsicFRP::returns[,-1]

penalty_parameters = seq(0., 1., length.out = 100)

# compute optimal adaptive tradable factor risk premia and their standard errors
oracle_tfrp = OracleTFRP(
returns,
factors,
penalty_parameters,
include_standard_errors = TRUE
)

</code></pre>

<hr>
<h2 id='returns'>Test Asset Excess Returns - monthly observations from <code>01/1970</code> to <code>12/2021</code></h2><span id='topic+returns'></span>

<h3>Description</h3>

<p>Monthly excess returns on the <code>25</code> Size/Book-to-Market double sorted portfolios
and the <code>17</code> industry portfolios from <code>01/1970</code> to <code>12/2021</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>returns
</code></pre>


<h3>Format</h3>



<h4><code>returns</code></h4>

<p>A data frame with <code>624</code> rows and <code>43</code> columns:
</p>

<dl>
<dt>Date</dt><dd><p>Date in yyyymm format</p>
</dd>
<dt>...</dt><dd><p>Asset excess returns</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html">https://mba.tuck.dartmouth.edu/pages/faculty/ken.french/data_library.html</a>
</p>

<hr>
<h2 id='TFRP'>Tradable factor risk premia.</h2><span id='topic+TFRP'></span>

<h3>Description</h3>

<p>Computes tradable factor risk premia from data on factors <code>F</code> and
test asset excess returns <code>R</code>:
<code>TFRP = Cov[F, R] * Var[R]^{-1} * E[R]</code>;
which are by construction the negative covariance of factors <code>F</code> with
the SDF projection on asset returns, i.e., the minimum variance SDF.
Optionally computes the corresponding heteroskedasticity and autocorrelation
robust standard errors using the Newey-West (1994) <a href="doi:10.2307/2297912">doi:10.2307/2297912</a>
plug-in procedure to select the number of relevant lags, i.e.,
<code>n_lags = 4 * (n_observations/100)^(2/9)</code>.
For the standard error computations, the function allows to internally
pre-whiten the series by fitting a VAR(1),
i.e., a vector autoregressive model of order 1.
All details are found in Quaini-Trojani-Yuan (2023) <a href="doi:10.2139/ssrn.4574683">doi:10.2139/ssrn.4574683</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TFRP(
  returns,
  factors,
  include_standard_errors = FALSE,
  hac_prewhite = FALSE,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TFRP_+3A_returns">returns</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;n_observations x n_returns&#8288;</code>-dimensional matrix of test asset
excess returns.</p>
</td></tr>
<tr><td><code id="TFRP_+3A_factors">factors</code></td>
<td>
<p>A <code style="white-space: pre;">&#8288;n_observations x n_factors&#8288;</code>-dimensional matrix of factors.</p>
</td></tr>
<tr><td><code id="TFRP_+3A_include_standard_errors">include_standard_errors</code></td>
<td>
<p>A boolean: <code>TRUE</code> if you want to compute the
tradable factor risk premia HAC standard errors; <code>FALSE</code> otherwise. Default
is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="TFRP_+3A_hac_prewhite">hac_prewhite</code></td>
<td>
<p>A boolean indicating if the series needs prewhitening by
fitting an AR(1) in the internal heteroskedasticity and autocorrelation
robust covariance (HAC) estimation. Default is <code>false</code>.</p>
</td></tr>
<tr><td><code id="TFRP_+3A_check_arguments">check_arguments</code></td>
<td>
<p>A boolean: <code>TRUE</code> for internal check of all function
arguments; <code>FALSE</code> otherwise. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing <code>n_factors</code>-dimensional vector of tradable factor
risk premia in <code>"risk_premia"</code>; if <code>include_standard_errors=TRUE</code>, then
it further includes <code>n_factors</code>-dimensional vector of tradable factor risk
premia standard errors in <code>"standard_errors"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># import package data on 6 risk factors and 42 test asset excess returns
factors = intrinsicFRP::factors[,-1]
returns = intrinsicFRP::returns[,-1]

# compute tradable factor risk premia and their standard errors
tfrp = TFRP(returns, factors, include_standard_errors = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
