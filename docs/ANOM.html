<!DOCTYPE html><html lang="en"><head><title>Help for package ANOM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ANOM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ANOM'>
<p>ANOM Decision Charts</p></a></li>
<li><a href='#ANOMgen'>
<p>Generic Function for Drawing ANOM Decision Charts</p></a></li>
<li><a href='#ANOMintern'>
<p>Internal Function</p></a></li>
<li><a href='#hemoglobin'>
<p>Hemoglobin Levels</p></a></li>
<li><a href='#math'>
<p>Math Proficiency Scores</p></a></li>
<li><a href='#spring'>
<p>Stiffness of Springs</p></a></li>
<li><a href='#waterfilter'>
<p>Comparison of Water Filters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Analysis of Means</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of means (ANOM) as used in technometrical computing. The package takes results from multiple comparisons with the grand mean (obtained with 'multcomp', 'SimComp', 'nparcomp', or 'MCPAN') or corresponding simultaneous confidence intervals as input and produces ANOM decision charts that illustrate which group means deviate significantly from the grand mean.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5</td>
</tr>
<tr>
<td>Author:</td>
<td>Philip Pallmann</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philip Pallmann &lt;p.pallmann@lancaster.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, MCPAN, multcomp, nparcomp, SimComp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, lme4, nlme, sandwich</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-04-10</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/PhilipPallmann/ANOM">https://github.com/PhilipPallmann/ANOM</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-04-12 12:45:51 UTC; pallmann</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-04-12 13:32:33 UTC</td>
</tr>
</table>
<hr>
<h2 id='ANOM'>
ANOM Decision Charts
</h2><span id='topic+ANOM'></span>

<h3>Description</h3>

<p>Compute an analysis of means (i.e., a multiple contrast test involving comparisons of each group versus the grand mean) and draw a decision chart as commonly used in technometrics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ANOM(mc, xlabel=NULL, ylabel=NULL, printn=TRUE, printp=TRUE,
     stdep=NULL, stind=NULL, pst=NULL, pbin=NULL, bg="white",
     bgrid=TRUE, axlsize=18, axtsize=25, npsize=5, psize=5,
     lwidth=1, dlstyle="dashed", fillcol="darkgray")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ANOM_+3A_mc">mc</code></td>
<td>
<p>An object of class <code>glht</code>, <code>SimCi</code>, <code>mctp</code>, or <code>binomRDci</code> involving group comparisons with the grand mean of all groups. See details.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_xlabel">xlabel</code></td>
<td>
<p>An optional character string specifying the label of the horizontal axis.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_ylabel">ylabel</code></td>
<td>
<p>An optional character string specifying the label of the vertical axis.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_printn">printn</code></td>
<td>
<p>A logical. Should per-group sample sizes be included in the chart? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_printp">printp</code></td>
<td>
<p>A logical. Should simultaneous p-values be included in the chart? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_stdep">stdep</code></td>
<td>
<p>A numerical vector giving the values of the dependent variable. Only required if an object of class <code>SimCi</code> is inserted for <code>mc</code>, otherwise ignored. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_stind">stind</code></td>
<td>
<p>A factor specifying the levels of the independent variable. Only required if an object of class <code>SimCi</code> is inserted for <code>mc</code>, otherwise ignored. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_pst">pst</code></td>
<td>
<p>An object of class <code>SimTest</code>. Only required if an object of class <code>SimCi</code> is inserted for <code>mc</code> and simultaneous p-values are to be printed (<code>printp=TRUE</code>), otherwise ignored. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_pbin">pbin</code></td>
<td>
<p>An object of class <code>binomRDtest</code>. Only required if an object of class <code>binomRDci</code> is inserted for <code>mc</code> and simultaneous p-values are to be printed (<code>printp=TRUE</code>), otherwise ignored. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_bg">bg</code></td>
<td>
<p>A character string. Should the plot's background be <code>"white"</code> (default) or <code>"gray"</code> (or <code>"grey"</code>)?</p>
</td></tr>
<tr><td><code id="ANOM_+3A_bgrid">bgrid</code></td>
<td>
<p>A logical. Should background grid lines be plotted? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_axlsize">axlsize</code></td>
<td>
<p>A numerical value specifying the font size of the axis labels. Default is <code>18</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_axtsize">axtsize</code></td>
<td>
<p>A numerical value specifying the font size of the axis titles. Default is <code>25</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_npsize">npsize</code></td>
<td>
<p>A numerical value specifying the font size of the sample sizes and p-values (if printed). Default is <code>5</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_psize">psize</code></td>
<td>
<p>A numerical value specifying the size of the points (group means). Default is <code>5</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_lwidth">lwidth</code></td>
<td>
<p>A numerical value specifying the width of the lines (grand mean, decision limits, vertical connections). Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_dlstyle">dlstyle</code></td>
<td>
<p>A character string specifying the style of the decision limits. Default is <code>"dashed"</code>.</p>
</td></tr>
<tr><td><code id="ANOM_+3A_fillcol">fillcol</code></td>
<td>
<p>A character string specifying the color of the area of no significant deviation from the grand mean. Default is <code>"darkgray"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'standard' version of ANOM is invoked by inserting a <code>glht</code> object (created with function <code>glht</code> from package <code>multcomp</code> using a contrast matrix of type <code>GrandMean</code>) for <code>mc</code>. The <code>glht</code> object must be based on one of the model types <code>aov</code>, <code>lm</code>, <code>glm</code>, <code>gls</code>, <code>lme</code>, or <code>lmer</code>. That is, ANOM is feasible not only for simple linear (ANOVA) models with Gaussian data, but indeed for a broad range of (semi-)parametric models e.g., with Poisson or binomial data, hierarchical and clustered structures, and more (Hothorn et al. 2008). If the underlying model is a Poisson or binomial GLM (involving log and logit link functions, respectively), the effects are automatically transformed back to counts (Poisson) or proportions (binomial).
</p>
<p>When analyzing binomial data, we need to distinguish between two data formats. As long as replicated observations of proportions are available for each group (i.e., a within-group variance can be estimated), we can fit a binomial GLM. However, if there is only one proportion per group (i.e., we have a 2-by-k data table), we need to fall back on some simpler procedure than a GLM. In the case of ANOM, we insert a <code>binomRDci</code> object (created with function <code>binomRDci</code> from package <code>MCPAN</code>) for <code>mc</code> with the contrasts being of type <code>GrandMean</code>. If printing out simultaneous p-values with the ANOM decision chart is desired (<code>printp=TRUE</code>), a <code>binomRDtest</code> object (generated with function <code>binomRDtest</code>) must be inserted for <code>pbin</code> (see examples). Notice that <code>printn=TRUE</code> prints the total sample size per group when inserting an object of class <code>binomRDci</code> for <code>mc</code>; by contrast, inserting a <code>glht</code> object based on a binomial GLM makes <code>printn=TRUE</code> print the number of independent observations of proportions per group.
</p>
<p>There are two options for coping with heterogeneous variances. The 'standard' version using <code>glht</code> objects is basically designed for homoscedastic data but can also cope with unequal variances by employing sandwich covariance estimates (Herberich et al. 2010). All you have to do is set the option <code>vcov=vcovHC</code> in the <code>glht</code> call (see examples).
</p>
<p>A different heterogeneity adjustment using multiple Satterthwaite degrees of freedom (Hasler and Hothorn 2008) is invoked by inserting a <code>SimCi</code> object (created with function <code>SimCiDiff</code> from package <code>SimComp</code> with the setting <code>covar.equal=FALSE</code>) for <code>mc</code>. Notice that <code>covar.equal=TRUE</code> would compute a 'standard' multiple contrast test assuming equal variances, which is just the opposite of what we want.
</p>
<p>Another instance when the <code>SimComp</code> package proves useful is for ANOM with ratios i.e., we assess each group's percentage change in comparison to the grand mean (which is always 100%). Again, we insert an object of class <code>SimCi</code> for <code>mc</code> but now we generated it with function <code>SimCiRatio</code> instead of <code>SimCiDiff</code>. Setting <code>covar.equal</code> to <code>TRUE</code> gives the homoscedastic version whereas <code>FALSE</code> calls the heteroscedastic variant using multiple degrees of freedom. 
</p>
<p>All ANOM functionality based on objects from <code>SimComp</code> requires you to submit the data (dependent and independent variable via <code>stdep</code> and <code>stind</code>, respectively) separately (see examples). Moreover, if you wish to print simultaneous p-values with your ANOM decision chart, you may compute them using function <code>SimTestDiff</code> or <code>SimTestRat</code> and insert the resulting object for <code>pst</code>. Again, don't forget to set the option <code>covar.equal=FALSE</code> if you want to account for heteroscedasticity. Make sure in all cases to perform comparisons of type <code>GrandMean</code>.
</p>
<p>Nonparametric ANOM is performed by inserting an object of class <code>mctp</code> (created with function <code>mctp</code> from package <code>nparcomp</code>) for <code>mc</code>. It is based on estimation of relative effects via global pseudo-rankings as proposed by Konietschke et al. (2012). This procedure can naturally cope with heteroscedasticity in the data.
</p>
<p>The relative effect of two independent random variables X_1 and X_2 following some distributions F_1 and F_2, respectively, is generally defined as
</p>
<p style="text-align: center;"><code class="reqn">p = P(X_1&lt;X_2) + 0.5 P(X_1=X_2).</code>
</p>

<p>Loosely speaking, p is the probability that X_1 takes smaller values than X_2 (plus half the probability of taking equal values). Hence when p&lt;0.5, X_1 is stochastically more likely to take larger values than X_2, and vice versa for p&gt;0.5.
</p>
<p>Creating the <code>mctp</code> object requires to specify a grand-mean-type contrast matrix by hand (see examples) as it is not among the options provided by the package <code>nparcomp</code>. For the test statistics you may choose one out of three asymptotic approximation methods:
</p>

<ul>
<li><p> a multivariate t approximation with Satterthwaite degrees of freedom (<code>asy.method="mult.t"</code>), which works reasonably well most of the time,
</p>
</li>
<li><p> a multivariate normal approximation (<code>asy.method="normal"</code>), which is unfavorable with small sample sizes,
</p>
</li>
<li><p> a Fisher transform (<code>asy.method="fisher"</code>), which ensures that the decision limits preserve the range of [-1, 1].
</p>
</li></ul>

<p>Make sure that the argument <code>correlation</code> in the function <code>mctp</code> is set to <code>TRUE</code>. Do not use the function <code>nparcomp</code> instead of <code>mctp</code> since it does not involve global ranking and is inoperative with ANOM-type contrast matrices.
</p>


<h3>Value</h3>

<p>An ANOM decision chart.
</p>


<h3>Note</h3>

<p>Notice that some of the more sophisticated ANOM variants (ratios, nonparametric, heteroscedastic with multiple degrees of freedom) are limited to one-way layouts without covariates.
</p>


<h3>Author(s)</h3>

<p>Philip Pallmann <a href="mailto:p.pallmann@lancaster.ac.uk">p.pallmann@lancaster.ac.uk</a>
</p>


<h3>References</h3>

<p>Djira, G. D., Hothorn, L. A. (2009) Detecting relative changes in multiple comparisons with an overall mean. Journal of Quality Technology 41(1), 60-65.
</p>
<p>Hasler, M. and Hothorn, L. A. (2008) Multiple contrast tests in the presence of heteroscedasticity. Biometrical Journal 50(5), 793&ndash;800.
</p>
<p>Herberich, E., Sikorski, J., Hothorn, T. (2010) A robust procedure for comparing multiple means under heteroscedasticity in unbalanced designs. PLoS One 5(3), e9788.
</p>
<p>Hothorn, T., Bretz, F., Westfall, P. (2008) Simultaneous inference in general parametric models. Biometrical Journal 50(3), 346&ndash;363.
</p>
<p>Konietschke, F., Hothorn, L. A., Brunner, F. (2012) Rank-based multiple test procedures and simultaneous confidence intervals. Electronic Journal of Statistics 6, 738&ndash;759.
</p>
<p>Pallmann, P. and Hothorn, L. A. (2016) Analysis of means (ANOM): A generalized approach using R. Journal of Applied Statistics, 43(8), 1541&ndash;1560.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
###############################################
### Standard ANOM (Gaussian, homoscedastic) ###
###############################################

### Devices of which brand filter bacteria significantly worse?
head(waterfilter)
str(waterfilter)

library(multcomp)
model &lt;- lm(colonies ~ brand, waterfilter)
hom &lt;- glht(model, mcp(brand="GrandMean"), alternative="less")
ANOM(hom)

############################
### Heteroscedastic ANOM ###
############################

## With sandwich covariance matrix estimate (Herberich et al. 2010)

library(multcomp)
library(sandwich)
het1 &lt;- glht(model, mcp(brand="GrandMean"), alternative="less", vcov=vcovHC)
ANOM(het1)

## With multiple degrees of freedom (Hasler and Hothorn 2008)

library(SimComp)
het2 &lt;- SimCiDiff(data=waterfilter, grp="brand", resp="colonies",
                  type="GrandMean", alternative="less", covar.equal=FALSE)
het2p &lt;- SimTestDiff(data=waterfilter, grp="brand", resp="colonies",
                     type="GrandMean", alternative="less", covar.equal=FALSE)
ANOM(het2, stdep=waterfilter$colonies, stind=waterfilter$brand, pst=het2p)

#######################
### ANOM for ratios ###
#######################

## Homoscedastic

library(SimComp)
rel &lt;- SimCiRat(data=waterfilter, grp="brand", resp="colonies",
                type="GrandMean", alternative="less", covar.equal=TRUE)
relp &lt;- SimTestRat(data=waterfilter, grp="brand", resp="colonies",
                   type="GrandMean", alternative="less", covar.equal=TRUE)
ANOM(rel, stdep=waterfilter$colonies, stind=waterfilter$brand, pst=relp)

## Heteroscedastic (with multiple degrees of freedom)

library(SimComp)
relh &lt;- SimCiRat(data=waterfilter, grp="brand", resp="colonies",
                 type="GrandMean", alternative="less", covar.equal=FALSE)
relhp &lt;- SimTestRat(data=waterfilter, grp="brand", resp="colonies",
                    type="GrandMean", alternative="less", covar.equal=FALSE)
ANOM(relh, stdep=waterfilter$colonies, stind=waterfilter$brand, pst=relhp)

##########################
### Nonparametric ANOM ###
##########################

# Compute sample sizes per group
ss &lt;- tapply(waterfilter$colonies, waterfilter$brand, length)
# Build a grand-mean-type contrast matrix
library(multcomp)
Mat &lt;- contrMat(ss, "GrandMean")

## Using a multivariate t approximation

library(nparcomp)
mult &lt;- mctp(colonies ~ brand, data=waterfilter, type="UserDefined",
             contrast.matrix=Mat, alternative="less", info=FALSE,
             correlation=TRUE, asy.method="mult.t")
ANOM(mult)
           
## Using a range-preserving Fisher transform

library(nparcomp)
fish &lt;- mctp(colonies ~ brand, data=waterfilter, type="UserDefined",
             contrast.matrix=Mat, alternative="less", info=FALSE,
             correlation=TRUE, asy.method="fisher")
ANOM(fish)

#####################################
### ANOM for binomial proportions ###
#####################################

### Which schools' math achievements differ from the grand mean?

head(math)
str(math)

## Based on Wald-type confidence intervals

library(MCPAN)
wald &lt;- binomRDci(n=math$enrolled, x=math$proficient, names=math$school,
                  alternative="two.sided", method="Wald", type="GrandMean")
waldp &lt;- binomRDtest(n=math$enrolled, x=math$proficient, names=math$school,
                     alternative="two.sided", method="Wald", type="GrandMean")
ANOM(wald, pbin=waldp)

## Based on add-2 confidence intervals

library(MCPAN)
add2 &lt;- binomRDci(n=math$enrolled, x=math$proficient, names=math$school,
                  alternative="two.sided", method="ADD2", type="GrandMean")
add2p &lt;- binomRDtest(n=math$enrolled, x=math$proficient, names=math$school,
                     alternative="two.sided", method="ADD2", type="GrandMean")
ANOM(add2, pbin=add2p)

##########################
### ANOM for variances ###
##########################

### Springs of which brand are significantly more variable?

head(spring)
str(spring)

# Compute the median weight per brand
spring$median &lt;- tapply(spring$weight, spring$brand, median)[spring$brand]
# Compute the absolute deviations from the median (robust Levene residuals)
spring$absdev &lt;- with(spring, abs(weight - median))

library(multcomp)
mod &lt;- lm(absdev ~ brand, spring)
test &lt;- glht(mod, mcp(brand="GrandMean"))
ANOM(test)
</code></pre>

<hr>
<h2 id='ANOMgen'>
Generic Function for Drawing ANOM Decision Charts
</h2><span id='topic+ANOMgen'></span>

<h3>Description</h3>

<p>Graphical representation of the analysis of means: convert simultaneous confidence intervals (that were computed with ANY method) into ANOM decision limits and draw a decision chart as commonly used in technometrics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ANOMgen(mu, n=NULL, gm=NULL, lo, up, names, alternative="two.sided",
        xlabel="Group", ylabel="Endpoint", printn=TRUE, p=NULL, bg="white",
        bgrid=TRUE, axlsize=18, axtsize=25, npsize=5, psize=5, lwidth=1,
        dlstyle="dashed", fillcol="darkgray")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ANOMgen_+3A_mu">mu</code></td>
<td>
<p>A numeric vector of group means.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_n">n</code></td>
<td>
<p>A numeric vector of sample sizes per group. Either <code>n</code> or <code>gm</code> must be provided.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_gm">gm</code></td>
<td>
<p>A single numeric value giving the grand mean of all groups. Either <code>n</code> or <code>gm</code> must be provided.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_lo">lo</code></td>
<td>
<p>A numeric vector of lower (simultaneous) confidence interval bounds for comparisons to the grand mean.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_up">up</code></td>
<td>
<p>A numeric vector of upper (simultaneous) confidence interval bounds for comparisons to the grand mean.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_names">names</code></td>
<td>
<p>An (optional) vector of characters specifying the groups' names.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the direction of the alternative hypothesis. Default is <code>"two.sided"</code>, but may be changed to one-sided alternatives (either <code>"greater"</code> or <code>"less"</code>).</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_xlabel">xlabel</code></td>
<td>
<p>A character string specifying the label of the horizontal axis.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_ylabel">ylabel</code></td>
<td>
<p>A character string specifying the label of the vertical axis.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_printn">printn</code></td>
<td>
<p>A logical. Should per-group sample sizes be included in the chart? Default is <code>TRUE</code>. If <code>n</code> ist left at <code>NULL</code>, the function automatically sets <code>printn</code> to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_p">p</code></td>
<td>
<p>An (optional) numeric vector of (simultaneous) p-values to be printed.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_bg">bg</code></td>
<td>
<p>A character string. Should the plot's background be <code>"white"</code> (default) or <code>"gray"</code> (or <code>"grey"</code>)?</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_bgrid">bgrid</code></td>
<td>
<p>A logical. Should background grid lines be plotted? Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_axlsize">axlsize</code></td>
<td>
<p>A numerical value specifying the font size of the axis labels. Default is <code>18</code>.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_axtsize">axtsize</code></td>
<td>
<p>A numerical value specifying the font size of the axis titles. Default is <code>25</code>.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_npsize">npsize</code></td>
<td>
<p>A numerical value specifying the font size of the sample sizes and p-values (if printed). Default is <code>5</code>.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_psize">psize</code></td>
<td>
<p>A numerical value specifying the size of the points (group means). Default is <code>5</code>.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_lwidth">lwidth</code></td>
<td>
<p>A numerical value specifying the width of the lines (grand mean, decision limits, vertical connections). Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_dlstyle">dlstyle</code></td>
<td>
<p>A character string specifying the style of the decision limits. Default is <code>"dashed"</code>.</p>
</td></tr>
<tr><td><code id="ANOMgen_+3A_fillcol">fillcol</code></td>
<td>
<p>A character string specifying the color of the area of no significant deviation from the grand mean. Default is <code>"darkgray"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic tool that translates (simultaneous) confidence intervals into ANOM decision limits.
</p>


<h3>Value</h3>

<p>An ANOM decision chart.
</p>


<h3>Note</h3>

<p>The confidence intervals must arise from comparisons to the grand mean; otherwise the ANOM chart is meaningless!
</p>


<h3>Author(s)</h3>

<p>Philip Pallmann <a href="mailto:p.pallmann@lancaster.ac.uk">p.pallmann@lancaster.ac.uk</a>
</p>


<h3>References</h3>

<p>Pallmann, P. and Hothorn, L. A. (2016) Analysis of means (ANOM): A generalized approach using R. Journal of Applied Statistics, 43(8), 1541&ndash;1560.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### A toy example (n given, two-sided)
groupmeans &lt;- c(2.8, 2.3, 3.4, 5.6)
samplesizes &lt;- c(5, 5, 10, 5)
low &lt;- c(-1.2, -1.7, -0.4, 1.6)
upp &lt;- c(-0.2, -0.7, 0.2, 2.6)
names &lt;- c("1st", "2nd", "3rd", "4th")
ANOMgen(mu=groupmeans, n=samplesizes, lo=low, up=upp, names=names, alternative="two.sided")

### Another toy example (gm given, one-sided, with p-values)
groupmeans &lt;- c(2.8, 2.3, 3.4, 5.6)
gm &lt;- 3.5
low &lt;- rep(-Inf, 4)
upp &lt;- c(-0.2, -0.7, 0.2, 2.6)
names &lt;- c("1st", "2nd", "3rd", "4th")
pvalues &lt;- c(0.01, 0.003, 0.8, 1)
ANOMgen(mu=groupmeans, gm=gm, lo=low, up=upp, names=names, alternative="less", p=pvalues)
</code></pre>

<hr>
<h2 id='ANOMintern'>
Internal Function
</h2><span id='topic+ANOMintern'></span>

<h3>Description</h3>

<p>Only for internal use.
</p>


<h3>Author(s)</h3>

<p>Philip Pallmann <a href="mailto:p.pallmann@lancaster.ac.uk">p.pallmann@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='hemoglobin'>
Hemoglobin Levels
</h2><span id='topic+hemoglobin'></span>

<h3>Description</h3>

<p>Hemoglobin levels of 30 male cancer patients treated with radiation or chemotherapy and one of three drugs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hemoglobin)</code></pre>


<h3>Format</h3>

<p>A data frame with 30 observations on the following 3 variables.
</p>

<dl>
<dt><code>therapy</code></dt><dd><p>A factor with 2 levels giving the types of therapy.</p>
</dd>
<dt><code>drug</code></dt><dd><p>A factor with 3 levels giving the drugs administered.</p>
</dd>
<dt><code>level</code></dt><dd><p>A numeric vector giving the patients' hemoglobin levels.</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a complete balanced two-way layout. 15 male cancer patients were radiated, and another 15 underwent chemotherapy. In addition, the patients were treated with either drug 1, 2, or 3. The endpoint of interest was the level of hemoglobin (in grams per deciliter blood).
</p>


<h3>Source</h3>

<p>Nelson, P. R., Wludyka, P. S., Copeland, K. A. F. (2005) The Analysis of Means: A Graphical Method for Comparing Means, Rates, and Proportions. Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA, and American Statistical Association (ASA), Alexandria, VA, pp. 71 ff.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hemoglobin)
str(hemoglobin)
</code></pre>

<hr>
<h2 id='math'>
Math Proficiency Scores
</h2><span id='topic+math'></span>

<h3>Description</h3>

<p>Proportion of fifth graders with proficient math test scores in 10 elementary schools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(math)</code></pre>


<h3>Format</h3>

<p>A data frame with 10 observations on the following 3 variables.
</p>

<dl>
<dt><code>school</code></dt><dd><p>A factor with 10 levels giving the ID of the school.</p>
</dd>
<dt><code>enrolled</code></dt><dd><p>A numeric vector giving the number of students taking part in the math test.</p>
</dd>
<dt><code>proficient</code></dt><dd><p>A numeric vector giving the number of students with proficient math test scores.</p>
</dd>
</dl>



<h3>Details</h3>

<p>A study compared math achievements of students from 10 elementary schools in a U.S. district; 6 of them were conventional neighborhood schools (<code>N1</code>&ndash;<code>N6</code>) and 4 alternative schools (<code>A1</code>&ndash;<code>A4</code>). 563 fifth graders took standardized math tests, and each school's proportion of students who scored proficient was recorded.
</p>


<h3>Source</h3>

<p>Nelson, P. R., Wludyka, P. S., Copeland, K. A. F. (2005) The Analysis of Means: A Graphical Method for Comparing Means, Rates, and Proportions. Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA, and American Statistical Association (ASA), Alexandria, VA, pp. 42&ndash;43.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(math)
str(math)
</code></pre>

<hr>
<h2 id='spring'>
Stiffness of Springs
</h2><span id='topic+spring'></span>

<h3>Description</h3>

<p>Weights required to stretch springs of four brands by 0.1 inches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(spring)</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 2 variables.
</p>

<dl>
<dt><code>brand</code></dt><dd><p>A factor with 4 levels giving the brands of springs.</p>
</dd>
<dt><code>weight</code></dt><dd><p>A numeric vector giving the weight required to extend the spring by 0.1 inches.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Nelson, P. R., Wludyka, P. S., Copeland, K. A. F. (2005) The Analysis of Means: A Graphical Method for Comparing Means, Rates, and Proportions. Society for Industrial and Applied Mathematics (SIAM), Philadelphia, PA, and American Statistical Association (ASA), Alexandria, VA, p. 53.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spring)
str(spring)
</code></pre>

<hr>
<h2 id='waterfilter'>
Comparison of Water Filters
</h2><span id='topic+waterfilter'></span>

<h3>Description</h3>

<p>Filtering performances of seven brands of water filters, measured as the number of bacterial colonies growing on each device.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(waterfilter)</code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on the following 2 variables.
</p>

<dl>
<dt><code>brand</code></dt><dd><p>A factor with 7 levels giving the brands of water filters.</p>
</dd>
<dt><code>colonies</code></dt><dd><p>A numeric vector giving the number of bacterial colonies found on each filter.</p>
</dd>
</dl>



<h3>Details</h3>

<p>A high number of bacterial colonies on a filter corresponds to good performance of this particular device. Note that the dataset is unbalanced (n=2 for brands 4 and 7, n=3 for all other brands).
</p>


<h3>Source</h3>

<p>Hsu, J. C. (1984) Ranking and selection and multiple comparisons with the best. In: Santner, T. J. and Tamhane, A. C. (Editors) Design of Experiments: Ranking and Selection (Essays in Honor of Robert E. Bechhofer). Marcel Dekker, New York, NY, pp. 23&ndash;33.
</p>


<h3>References</h3>

<p>Westfall, P. H., Tobias, R. D., Wolfinger, R. D. (2011) Multiple Comparisons and Multiple Tests Using SAS, Second Edition. SAS Institute Inc., Cary, NC, pp. 592&ndash;593.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(waterfilter)
str(waterfilter)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
