<!DOCTYPE html><html lang="en"><head><title>Help for package JAGStree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {JAGStree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#data1'><p>Simple Tree Data 1</p></a></li>
<li><a href='#data2'><p>Simple Tree Data 2</p></a></li>
<li><a href='#data3'><p>Simple Tree Data 3</p></a></li>
<li><a href='#makeJAGStree'><p>makeJAGStree</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Automatically Write 'JAGS' Code for Hierarchical Bayesian Models
on Trees</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mallory J Flynn &lt;mallory.flynn@stat.ubc.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>When relationships between sources of data can be represented by a tree, the generation of appropriate Markov Chain Monte Carlo modeling code to be used with 'JAGS' to run a Bayesian hierarchical model can be automatically generated by this package. Any admissible tree-structured data can be used, under the assumption that node counts are multinomial and branching probabilities are Dirichlet among sibling groups. The methodological basis used to create this package can be found in Flynn (2023) <a href="http://hdl.handle.net/2429/86174">http://hdl.handle.net/2429/86174</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/malfly/JAGStree">https://github.com/malfly/JAGStree</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.tree, gtools, mcmcplots, stats, R2jags, tidyverse,
DiagrammeR, AutoWMM</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-07 18:58:12 UTC; mallory</td>
</tr>
<tr>
<td>Author:</td>
<td>Mallory J Flynn [cre, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-11 12:00:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='data1'>Simple Tree Data 1</h2><span id='topic+data1'></span>

<h3>Description</h3>

<p>Small, artificially generated toy data set to demonstrate package functionality
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data1)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>
</p>

<dl>
<dt>from</dt><dd><p>A node label and started point of directed edge (parent node)</p>
</dd>
<dt>to</dt><dd><p>A node label and endpoint of directed edge (child node)</p>
</dd>
<dt>Estimate</dt><dd><p>A numerical value assumed to be survey count belonging to 'to' node (integer)</p>
</dd>
<dt>Total</dt><dd><p>A numerical value assumed to be survey sample size (integer)</p>
</dd>
<dt>Count</dt><dd><p>A numerical value for marginal count if leaf node (integer)</p>
</dd>
<dt>Population</dt><dd><p>A boolean value for if survey size is entire population (logical)</p>
</dd>
<dt>Description</dt><dd><p>A string describing 'to' node (string)</p>
</dd>
</dl>



<h3>References</h3>

<p>This data set was artificially created for the JAGStree package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data1)
head(data1)

</code></pre>

<hr>
<h2 id='data2'>Simple Tree Data 2</h2><span id='topic+data2'></span>

<h3>Description</h3>

<p>Small, artificially generated toy data set to demonstrate package functionality
with a simpler data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data2)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>
</p>

<dl>
<dt>from</dt><dd><p>A node label and started point of directed edge (parent node)</p>
</dd>
<dt>to</dt><dd><p>A node label and endpoint of directed edge (child node)</p>
</dd>
</dl>



<h3>References</h3>

<p>This data set was artificially created for the JAGStree package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data2)
head(data2)

</code></pre>

<hr>
<h2 id='data3'>Simple Tree Data 3</h2><span id='topic+data3'></span>

<h3>Description</h3>

<p>Small, artificially generated toy data set to demonstrate package functionality
with a multinomial distribution among node branching
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data3)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>
</p>

<dl>
<dt>from</dt><dd><p>A node label and started point of directed edge (parent node)</p>
</dd>
<dt>to</dt><dd><p>A node label and endpoint of directed edge (child node)</p>
</dd>
<dt>Estimate</dt><dd><p>A numerical value assumed to be survey count belonging to 'to' node (integer)</p>
</dd>
<dt>Total</dt><dd><p>A numerical value assumed to be survey sample size (integer)</p>
</dd>
<dt>Count</dt><dd><p>A numerical value for marginal count if leaf node (integer)</p>
</dd>
<dt>Population</dt><dd><p>A boolean value for if survey size is entire population (logical)</p>
</dd>
<dt>Description</dt><dd><p>A string describing 'to' node (string)</p>
</dd>
</dl>



<h3>References</h3>

<p>This data set was artificially created for the JAGStree package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data3)
head(data3)

</code></pre>

<hr>
<h2 id='makeJAGStree'>makeJAGStree</h2><span id='topic+makeJAGStree'></span>

<h3>Description</h3>

<p>Generates a .mod or .txt file with 'JAGS' code for Bayesian
hierarchical model on tree structured data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeJAGStree(data, prior = "lognormal", filename = "JAGSmodel.mod")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeJAGStree_+3A_data">data</code></td>
<td>
<p>A dataframe object representing tree-structure</p>
</td></tr>
<tr><td><code id="makeJAGStree_+3A_prior">prior</code></td>
<td>
<p>A string representing the choice of prior for the root
node population size; can be set to &quot;lognormal&quot; (default) or &quot;uniform&quot;</p>
</td></tr>
<tr><td><code id="makeJAGStree_+3A_filename">filename</code></td>
<td>
<p>A string containing the file name for resulting output
'JAGS' model file; must end in .mod or .txt</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A .mod or .txt file that contains code ready to run a Bayesian
hierarchical model in 'JAGS' based on the input tree-structured data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # optional use of the AutoWMM package to show tree structure
  Sys.setenv("RGL_USE_NULL" = TRUE)
  tree &lt;- makeTree(data1)
  drawTree(tree)

  makeJAGStree(data1, filename=file.path(tempdir(), "data1_JAGSscript.mod"))
  makeJAGStree(data1, filename=file.path(tempdir(), "data1_JAGSscript.txt"))

  # second example
  makeJAGStree(data2, filename=file.path(tempdir(), "data2_JAGSscript.mod"))
  makeJAGStree(data2, filename=file.path(tempdir(), "data2_JAGSscript.mod", prior = "uniform"))

  # third example, showing optional execution with MCMC in R
  makeJAGStree(data3, filename=file.path(tempdir(), "multiScript.mod"))
  makeJAGStree(data3, filename=file.path(tempdir(), "multiScript.txt"))

  mcmc.data &lt;- list( "DE" = c(50, NA),
  "ABC" = c(NA, 500, NA),
  "pZ1" = 4,     # dirichlet parameters for prior on u
  "pZ2" = 5,      # last parameter to sample U
  "pZ3" = 1,
  "pA1" = 10,      # beta parameters for prior on p
  "pA2" = 1,
  "mu" = log(1000),    # lognormal mean Z
  "tau" = 1/(0.1^2))    # lognormal precision (1/variance) of Z

  ## define parameters whose posteriors we are interested in
  mod.params &lt;- c("Z",  "ABC", "DE", "pZ", "pA")

  ## modify initial values
  mod.inits.cont &lt;- function(){ list("Z.cont" = runif(1, 700, 1500),
                                  "ABC" = c(round(runif(1, 100, 200)), NA, NA),
                                  "pA" = as.vector(rbeta(1,1,1)),
                                  "pZ" = as.vector(rdirichlet(1, c(1,1,1))))
                               }

  ## Generate list of initial values to match number of chains
  numchains &lt;- 6
  mod.initial.cont &lt;- list()
  i &lt;- 1
  while(i &lt;= numchains){
  mod.initial.cont[[i]] &lt;- mod.inits.cont()
  i = i+1
  }

  ## now fit the model in JAGS
  mod.fit &lt;- jags(data = mcmc.data,
                inits = mod.initial.cont,
                parameters.to.save = mod.params,
                n.chains = numchains,
                n.iter = 500, n.burnin = 200,
                model.file = "multiScript.mod")
  print(mod.fit)

  ## plots using mcmcplots library
  mod.fit.mcmc &lt;- as.mcmc(mod.fit)
  denplot(mod.fit.mcmc, parms = c("Z", "ABC[1]", "ABC[3]"))
  denplot(mod.fit.mcmc, parms = c("pZ", "pA"))
  traplot(mod.fit.mcmc, parms = c("Z", "ABC[1]", "ABC[3]"))
  traplot(mod.fit.mcmc, parms = c("pZ", "pA"))
  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
