<!DOCTYPE html><html lang="en"><head><title>Help for package CTRing</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CTRing}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addRingFromImage'><p>Add ring to pith to bark profile from CT scan image</p></a></li>
<li><a href='#addRingFromProfile'><p>Add ring to pith to bark profile from profile plot</p></a></li>
<li><a href='#addYears'><p>Add years to series</p></a></li>
<li><a href='#calcAvgDens'><p>Calculate average wood, earlywood and latewood density for every ring</p></a></li>
<li><a href='#checkProfile'><p>Verify position of ring transitions of a density profile</p></a></li>
<li><a href='#deleteRingFromImage'><p>Add ring to pith to bark profile from CT scan image</p></a></li>
<li><a href='#deleteRingFromProfile'><p>Delete ring from a pith to bark profile</p></a></li>
<li><a href='#densityDataFrame'><p>Convert to dataframe</p></a></li>
<li><a href='#detect_pith'><p>Automatically detect pith in a CT scan image</p></a></li>
<li><a href='#extractProfile'><p>Get profile between two points of the CTScan image matrix</p></a></li>
<li><a href='#getEwLw'><p>Establish the transition point from earlywood to latewood for a series of rings</p></a></li>
<li><a href='#getImageInfo'><p>Extract from header of CT scan image grayscale number of bits and pixel size</p></a></li>
<li><a href='#grayToDensity'><p>Convert from 8bit gray scale to density</p></a></li>
<li><a href='#imageToMatrix'><p>Convert dicom image to matrix</p></a></li>
<li><a href='#locatePathEnd'><p>Get coordinates of the end of the path on a CT scan image</p></a></li>
<li><a href='#pithCoordinates'><p>convert pith coordinates from pixels to length units</p></a></li>
<li><a href='#plotImageProfile'><p>Plot scan image, profile path and ring limits</p></a></li>
<li><a href='#plotProfile'><p>Plot density profile</p></a></li>
<li><a href='#relToPixel'><p>Change from relative to fixed pixel coordinate system</p></a></li>
<li><a href='#removeLastYear'><p>Remove the last year of a profile</p></a></li>
<li><a href='#verifyPith'><p>Check if pith location is correct</p></a></li>
<li><a href='#xBitTo8Bit'><p>Convert gray scale from measured bits to 8bit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Density Profiles of Wood from CT Scan Images</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Robert Schneider &lt;robert_schneider@uqar.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computerized tomography (CT) can be used to assess certain wood properties when wood disks or logs are scanned. Wood density profiles (i.e. variations of wood density from pith to bark) can yield important information used for studies in forest resource assessment, wood quality and dendrochronology studies. The first step consists in transforming grey values from the scan images to density values. The packages then proposes a unique method to automatically locate the pith by combining an adapted Hough Transform method and a one-dimensional edge detector. Tree ring profiles (average ring density, earlywood and latewood density, ring width and percent latewood for each ring) are then obtained.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>xRing, functional, oro.dicom</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-05 14:23:04 UTC; schnro01</td>
</tr>
<tr>
<td>Author:</td>
<td>Dipak Mahatara [aut],
  Robert Schneider [cre, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-10 09:40:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='addRingFromImage'>Add ring to pith to bark profile from CT scan image</h2><span id='topic+addRingFromImage'></span>

<h3>Description</h3>

<p>Add ring to pith to bark profile from CT scan image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addRingFromImage(n = 1, densProfile, im)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addRingFromImage_+3A_n">n</code></td>
<td>
<p>Number of rings to add</p>
</td></tr>
<tr><td><code id="addRingFromImage_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
<tr><td><code id="addRingFromImage_+3A_im">im</code></td>
<td>
<p>Density matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Corrected density profile with new ring(s) added and blue bar in plot of added ring
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
image_info &lt;- getImageInfo(hdr = hdr_df)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens,
                          n_segments = 12,
                          pixel = TRUE,
                          toPlot = FALSE)

endPath &lt;- c(472, 284)

densPath &lt;- extractProfile(im_dens,
                           image_info,
                           pith_coord,
                           endPath,
                           k = 2, r = 5,
                           threshold = 0.002)

newPath2 &lt;- addRingFromImage(n = 1, densPath, im_dens)

</code></pre>

<hr>
<h2 id='addRingFromProfile'>Add ring to pith to bark profile from profile plot</h2><span id='topic+addRingFromProfile'></span>

<h3>Description</h3>

<p>Add ring to pith to bark profile from profile plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addRingFromProfile(n = 1, densProfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addRingFromProfile_+3A_n">n</code></td>
<td>
<p>Number of rings to add</p>
</td></tr>
<tr><td><code id="addRingFromProfile_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Corrected density profile with new ring(s) added and blue bar in plot of added ring
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

path &lt;- extractProfile(im_dens, image_info, pith_coord, endPath, k = 2, r = 5, threshold = 0.002)

plotProfile(path)
newPath &lt;- addRingFromProfile(n = 1, path)

</code></pre>

<hr>
<h2 id='addYears'>Add years to series</h2><span id='topic+addYears'></span>

<h3>Description</h3>

<p>Add years to series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addYears(lastYear, densProfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addYears_+3A_lastyear">lastYear</code></td>
<td>
<p>Last year of series</p>
</td></tr>
<tr><td><code id="addYears_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Density profile with years
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

path &lt;- extractProfile(im_dens, image_info, pith_coord, endPath, k = 2, r = 5, threshold = 0.002)

path &lt;- addYears(2021, path)
</code></pre>

<hr>
<h2 id='calcAvgDens'>Calculate average wood, earlywood and latewood density for every ring</h2><span id='topic+calcAvgDens'></span>

<h3>Description</h3>

<p>Calculate average wood, earlywood and latewood density for every ring
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcAvgDens(densProfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcAvgDens_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with several vectors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

path &lt;- extractProfile(im_dens, image_info, pith_coord, endPath, k = 2, r = 5, threshold = 0.002)

pathEwLw &lt;- getEwLw(path)
plotProfile(pathEwLw)
path_avgDens &lt;- calcAvgDens(pathEwLw)
names(path_avgDens)
</code></pre>

<hr>
<h2 id='checkProfile'>Verify position of ring transitions of a density profile</h2><span id='topic+checkProfile'></span>

<h3>Description</h3>

<p>Verify position of ring transitions of a density profile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkProfile(profile_with_borders, totRings)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkProfile_+3A_profile_with_borders">profile_with_borders</code></td>
<td>
<p>xRing profile with transitions between rings located</p>
</td></tr>
<tr><td><code id="checkProfile_+3A_totrings">totRings</code></td>
<td>
<p>Total number of rings of the disk</p>
</td></tr>
</table>


<h3>Value</h3>

<p>xRing profile with corrected ring location
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
image_info &lt;- getImageInfo(hdr = hdr_df)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens,
                          n_segments = 12,
                          pixel = TRUE,
                          toPlot = FALSE)

endPath &lt;- c(472, 284)

densPath &lt;- extractProfile(im_dens,
                           image_info,
                           pith_coord,
                           endPath,
                           k = 2, r = 5,
                           threshold = 0.002)

newPath &lt;- checkProfile(densPath, 26)
</code></pre>

<hr>
<h2 id='deleteRingFromImage'>Add ring to pith to bark profile from CT scan image</h2><span id='topic+deleteRingFromImage'></span>

<h3>Description</h3>

<p>Add ring to pith to bark profile from CT scan image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deleteRingFromImage(n = 1, densProfile, im)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deleteRingFromImage_+3A_n">n</code></td>
<td>
<p>Number of rings to remove</p>
</td></tr>
<tr><td><code id="deleteRingFromImage_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
<tr><td><code id="deleteRingFromImage_+3A_im">im</code></td>
<td>
<p>Density matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Corrected density profile with ring(s) removed and red bar in plot of deleted ring
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual

densPath &lt;- extractProfile(im_dens,
                           image_info,
                           pith_coord,
                           endPath,
                           k = 2, r = 5,
                           threshold = 0.002)

newPath2 &lt;- addRingFromImage(n = 1, densPath, im_dens)
oldPath2 &lt;- deleteRingFromImage(n = 1, densPath, im_dens)
</code></pre>

<hr>
<h2 id='deleteRingFromProfile'>Delete ring from a pith to bark profile</h2><span id='topic+deleteRingFromProfile'></span>

<h3>Description</h3>

<p>Delete ring from a pith to bark profile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deleteRingFromProfile(n = 1, densProfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deleteRingFromProfile_+3A_n">n</code></td>
<td>
<p>Number of rings to remove</p>
</td></tr>
<tr><td><code id="deleteRingFromProfile_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Corrected density profile with ring(s) removed and red bar in plot of deleted ring
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

densPath &lt;- extractProfile(im_dens,
                           image_info,
                           pith_coord,
                           endPath,
                           k = 2, r = 5,
                           threshold = 0.002)

plotProfile(densPath)
newPath &lt;- addRingFromProfile(n = 1, densPath)
oldPath &lt;- deleteRingFromProfile(n = 1, newPath)
</code></pre>

<hr>
<h2 id='densityDataFrame'>Convert to dataframe</h2><span id='topic+densityDataFrame'></span>

<h3>Description</h3>

<p>Convert to dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>densityDataFrame(densProfile, sampleID = "NoID", addTransitionType = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="densityDataFrame_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
<tr><td><code id="densityDataFrame_+3A_sampleid">sampleID</code></td>
<td>
<p>Sample ID</p>
</td></tr>
<tr><td><code id="densityDataFrame_+3A_addtransitiontype">addTransitionType</code></td>
<td>
<p>add transition type to dataframe</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataframe with cambial age, density, years, transition type
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

path &lt;- extractProfile(im_dens, image_info, pith_coord, endPath, k = 2, r = 5, threshold = 0.002)

pathEwLw &lt;- getEwLw(path)
plotProfile(pathEwLw)
path_avgDens &lt;- calcAvgDens(pathEwLw)
densityDf &lt;- densityDataFrame(pathEwLw)

</code></pre>

<hr>
<h2 id='detect_pith'>Automatically detect pith in a CT scan image</h2><span id='topic+detect_pith'></span>

<h3>Description</h3>

<p>Automatically detect pith in a CT scan image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_pith(
  im,
  toPlot = TRUE,
  n_segments = 25,
  flag = TRUE,
  x_0 = 0.5,
  y_0 = 0.5,
  n_run_max = 15,
  threshold = 0.1,
  pixel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="detect_pith_+3A_im">im</code></td>
<td>
<p>Matrix of the CT scan image</p>
</td></tr>
<tr><td><code id="detect_pith_+3A_toplot">toPlot</code></td>
<td>
<p>Boolean to plot the location of the pith on the image</p>
</td></tr>
<tr><td><code id="detect_pith_+3A_n_segments">n_segments</code></td>
<td>
<p>Number of segements used to locate pith</p>
</td></tr>
<tr><td><code id="detect_pith_+3A_flag">flag</code></td>
<td>
<p>FALSE if pith location is known</p>
</td></tr>
<tr><td><code id="detect_pith_+3A_x_0">x_0</code></td>
<td>
<p>Estimate of pith location in x</p>
</td></tr>
<tr><td><code id="detect_pith_+3A_y_0">y_0</code></td>
<td>
<p>Estimate of pith location in y</p>
</td></tr>
<tr><td><code id="detect_pith_+3A_n_run_max">n_run_max</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="detect_pith_+3A_threshold">threshold</code></td>
<td>
<p>Thershold value for identifying ring transition points</p>
</td></tr>
<tr><td><code id="detect_pith_+3A_pixel">pixel</code></td>
<td>
<p>If TRUE, returns x,y coordinates in pixel numbers, else FALSE returns x,y coordinates in relative values of x and y</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x,y pith coordinates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

</code></pre>

<hr>
<h2 id='extractProfile'>Get profile between two points of the CTScan image matrix</h2><span id='topic+extractProfile'></span>

<h3>Description</h3>

<p>Get profile between two points of the CTScan image matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractProfile(
  im,
  imHeader,
  beginPath,
  endPath,
  r = 10,
  k = 2,
  threshold = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractProfile_+3A_im">im</code></td>
<td>
<p>Density matrix</p>
</td></tr>
<tr><td><code id="extractProfile_+3A_imheader">imHeader</code></td>
<td>
<p>image header</p>
</td></tr>
<tr><td><code id="extractProfile_+3A_beginpath">beginPath</code></td>
<td>
<p>X,Y coordinates of the start point of the path</p>
</td></tr>
<tr><td><code id="extractProfile_+3A_endpath">endPath</code></td>
<td>
<p>X,Y coordinates of the start point of the path</p>
</td></tr>
<tr><td><code id="extractProfile_+3A_r">r</code></td>
<td>
<p>Profile width</p>
</td></tr>
<tr><td><code id="extractProfile_+3A_k">k</code></td>
<td>
<p>Rolling window width, integer</p>
</td></tr>
<tr><td><code id="extractProfile_+3A_threshold">threshold</code></td>
<td>
<p>Threshold value between maximum and minimum density to establish change of ring</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Density profile
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

path &lt;- extractProfile(im_dens, image_info, pith_coord, endPath, k = 2, r = 5, threshold = 0.002)

</code></pre>

<hr>
<h2 id='getEwLw'>Establish the transition point from earlywood to latewood for a series of rings</h2><span id='topic+getEwLw'></span>

<h3>Description</h3>

<p>Establish the transition point from earlywood to latewood for a series of rings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEwLw(densProfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getEwLw_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>xRingList with EW to LW transition points with transition type added (1: low number of points in ring; 2: inflexion point estimated by polynomial; 3: min or max are out of range; 4: inflexion point close to min or max; 5: convex-concave)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

path &lt;- extractProfile(im_dens, image_info, pith_coord, endPath, k = 2, r = 5, threshold = 0.002)

pathEwLw &lt;- getEwLw(path)

densityDf &lt;- densityDataFrame(path)
</code></pre>

<hr>
<h2 id='getImageInfo'>Extract from header of CT scan image grayscale number of bits and pixel size</h2><span id='topic+getImageInfo'></span>

<h3>Description</h3>

<p>Extract from header of CT scan image grayscale number of bits and pixel size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getImageInfo(hdr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getImageInfo_+3A_hdr">hdr</code></td>
<td>
<p>Header dataframe</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with grayscale values, and pixel size
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
getImageInfo(hdr = hdr_df)

</code></pre>

<hr>
<h2 id='grayToDensity'>Convert from 8bit gray scale to density</h2><span id='topic+grayToDensity'></span>

<h3>Description</h3>

<p>Convert from 8bit gray scale to density
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grayToDensity(im, a = -0.1321, b = 0.01834)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="grayToDensity_+3A_im">im</code></td>
<td>
<p>Matrix of CT scan image in 8bit gray scale</p>
</td></tr>
<tr><td><code id="grayToDensity_+3A_a">a</code></td>
<td>
<p>Intercept of the calibration curve</p>
</td></tr>
<tr><td><code id="grayToDensity_+3A_b">b</code></td>
<td>
<p>Slope of the calibration curve</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of density values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
range(im_8bit)

im_dens &lt;- grayToDensity(im_8bit)
range(im_dens)

</code></pre>

<hr>
<h2 id='imageToMatrix'>Convert dicom image to matrix</h2><span id='topic+imageToMatrix'></span>

<h3>Description</h3>

<p>Convert dicom image to matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imageToMatrix(img)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imageToMatrix_+3A_img">img</code></td>
<td>
<p>Dicom image</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of image
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
dim(im)
image(im)

</code></pre>

<hr>
<h2 id='locatePathEnd'>Get coordinates of the end of the path on a CT scan image</h2><span id='topic+locatePathEnd'></span>

<h3>Description</h3>

<p>Get coordinates of the end of the path on a CT scan image
</p>


<h3>Usage</h3>

<pre><code class='language-R'>locatePathEnd(im, pithCoord)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="locatePathEnd_+3A_im">im</code></td>
<td>
<p>CT scan image</p>
</td></tr>
<tr><td><code id="locatePathEnd_+3A_pithcoord">pithCoord</code></td>
<td>
<p>X,Y coordinates of the pith</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Coordinates of the end of the path
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

</code></pre>

<hr>
<h2 id='pithCoordinates'>convert pith coordinates from pixels to length units</h2><span id='topic+pithCoordinates'></span>

<h3>Description</h3>

<p>convert pith coordinates from pixels to length units
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pithCoordinates(pith_coord, pixel_size_x, pixel_size_y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pithCoordinates_+3A_pith_coord">pith_coord</code></td>
<td>
<p>Pith coordinates in pixels</p>
</td></tr>
<tr><td><code id="pithCoordinates_+3A_pixel_size_x">pixel_size_x</code></td>
<td>
<p>Pixel size in x</p>
</td></tr>
<tr><td><code id="pithCoordinates_+3A_pixel_size_y">pixel_size_y</code></td>
<td>
<p>Pixel size in y</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Pixel coordinates in length units
</p>

<hr>
<h2 id='plotImageProfile'>Plot scan image, profile path and ring limits</h2><span id='topic+plotImageProfile'></span>

<h3>Description</h3>

<p>Plot scan image, profile path and ring limits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotImageProfile(densProfile, im)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotImageProfile_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
<tr><td><code id="plotImageProfile_+3A_im">im</code></td>
<td>
<p>Density matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual

path &lt;- extractProfile(im_dens, image_info, pith_coord, endPath, k = 2, r = 5, threshold = 0.002)

plotProfile(path)

plotImageProfile(path, im_dens)

</code></pre>

<hr>
<h2 id='plotProfile'>Plot density profile</h2><span id='topic+plotProfile'></span>

<h3>Description</h3>

<p>Plot density profile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotProfile(densProfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotProfile_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Figure
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

path &lt;- extractProfile(im_dens, image_info, pith_coord, endPath, k = 2, r = 5, threshold = 0.002)

plotProfile(path)

</code></pre>

<hr>
<h2 id='relToPixel'>Change from relative to fixed pixel coordinate system</h2><span id='topic+relToPixel'></span>

<h3>Description</h3>

<p>Change from relative to fixed pixel coordinate system
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relToPixel(pith_coord, im)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="relToPixel_+3A_pith_coord">pith_coord</code></td>
<td>
<p>Pith coordinates in relative space (x, y)</p>
</td></tr>
<tr><td><code id="relToPixel_+3A_im">im</code></td>
<td>
<p>Density matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Pixel coordinates in number of pixels (x, y)
</p>

<hr>
<h2 id='removeLastYear'>Remove the last year of a profile</h2><span id='topic+removeLastYear'></span>

<h3>Description</h3>

<p>Remove the last year of a profile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeLastYear(densProfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeLastYear_+3A_densprofile">densProfile</code></td>
<td>
<p>Density profile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Density profile with the last year removed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

endPath &lt;- c(472, 284) # manual
# not run - endPath &lt;- locatePathEnd(im_dens, pith_coord) # using the image

path &lt;- extractProfile(im_dens, image_info, pith_coord, endPath, k = 2, r = 5, threshold = 0.002)
path_last_year_2021 &lt;- addYears(2021, path)
path_last_year_2020 &lt;- removeLastYear(path_last_year_2021)
</code></pre>

<hr>
<h2 id='verifyPith'>Check if pith location is correct</h2><span id='topic+verifyPith'></span>

<h3>Description</h3>

<p>Check if pith location is correct
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verifyPith(im, pith_coord)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="verifyPith_+3A_im">im</code></td>
<td>
<p>Density matrix of image</p>
</td></tr>
<tr><td><code id="verifyPith_+3A_pith_coord">pith_coord</code></td>
<td>
<p>Pith coordinates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Corrected pith coordinates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
im_dens &lt;- grayToDensity(im_8bit)

pith_coord &lt;- detect_pith(im_dens, n_segments = 12, pixel = TRUE, toPlot = FALSE)

pith_coord_checked &lt;- verifyPith(im_dens, pith_coord)

</code></pre>

<hr>
<h2 id='xBitTo8Bit'>Convert gray scale from measured bits to 8bit</h2><span id='topic+xBitTo8Bit'></span>

<h3>Description</h3>

<p>Convert gray scale from measured bits to 8bit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xBitTo8Bit(im, bits)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xBitTo8Bit_+3A_im">im</code></td>
<td>
<p>Matrix of values in x bits</p>
</td></tr>
<tr><td><code id="xBitTo8Bit_+3A_bits">bits</code></td>
<td>
<p>Number of bits of the original gray scale</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix of gray scale values in 8bits
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(oro.dicom)
file_path &lt;- system.file("extdata", "disk.dcm", package = "CTRing")
dcm &lt;-  readDICOM(file_path)
hdr_df &lt;- dcm$hdr[[1]]
image_info &lt;- getImageInfo(hdr = hdr_df)

im &lt;- imageToMatrix(dcm$img)
range(im)

im_8bit &lt;- xBitTo8Bit(im, image_info$grayScale)
range(im_8bit)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
