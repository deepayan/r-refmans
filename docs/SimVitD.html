<!DOCTYPE html><html><head><title>Help for package SimVitD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SimVitD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#exposure.levels'><p>Generate exposures to infectious agent and vitamin D status</p></a></li>
<li><a href='#infection.count'><p>Generate whether a participant contracted a infection at exposure times.</p></a></li>
<li><a href='#infection.count.plot'><p>Plotting the times of disease on the vitamin D curves.</p></a></li>
<li><a href='#intensity.function'><p>Generate an intensity function</p></a></li>
<li><a href='#plot.exposure.levels'><p>Plotting the exposures to infection on vitamin D status curves.</p></a></li>
<li><a href='#plot.power.calc'><p>Plotting a power.calc object</p></a></li>
<li><a href='#plot.vitd.curve'><p>Plotting a vitd.curve object</p></a></li>
<li><a href='#power.calc'><p>Generate the power to detect the difference between two groups</p></a></li>
<li><a href='#print.exposure.levels'><p>Print summary of an exposure.levels object.</p></a></li>
<li><a href='#print.infection.count'><p>Print a summary of a infection.count object</p></a></li>
<li><a href='#print.power.calc'><p>Summary of a power.calc object</p></a></li>
<li><a href='#print.vitd.curve'><p>Print summary of a vitd.curve object</p></a></li>
<li><a href='#rr.curve.plot'><p>Plotting the relative risk curve for vitamin D status.</p></a></li>
<li><a href='#rr.profile.plot'><p>Plotting a vitamin D profile and relative risk curve.</p></a></li>
<li><a href='#SimVitD-package'><p>Simulation tools for vitamin D studies.</p></a></li>
<li><a href='#summary.exposure.levels'><p>Summary of a vitd.curve object</p></a></li>
<li><a href='#summary.infection.count'><p>Summary of a infection.count object</p></a></li>
<li><a href='#summary.power.calc'><p>Summary of a power.calc object</p></a></li>
<li><a href='#summary.vitd.curve'><p>Summary of a vitd.curve object</p></a></li>
<li><a href='#vitd.curve'><p>Generate Vitamin D curves</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulation Tools for Planning Vitamin D Studies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation tools for planning Vitamin D studies. Individual vitamin D status 
             profiles are simulated, modelling population heterogeneity in trial arms. 
             Exposures to infectious agents are generated, with infection depending on vitamin D status.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jason Wyse &lt;wyseja@tcd.ie&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>simpleboot</td>
</tr>
<tr>
<td>Suggests:</td>
<td>parallel</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-20 14:35:52 UTC; jason</td>
</tr>
<tr>
<td>Author:</td>
<td>Rebecca Mangan [aut],
  Jason Wyse [aut, cre],
  Lina Zgaga [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-20 15:42:32 UTC</td>
</tr>
</table>
<hr>
<h2 id='exposure.levels'>Generate exposures to infectious agent and vitamin D status</h2><span id='topic+exposure.levels'></span>

<h3>Description</h3>

<p><code><a href="#topic+exposure.levels">exposure.levels</a></code> creates a list of the exposures to an infectious agent and the status of vitamin D at the time of each exposure for each participant. The exposure times are simulated from a non homogeneous poisson process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  exposure.levels( x, rate, intensity.func = intensity.function(), start = 0, end = 1 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exposure.levels_+3A_x">x</code></td>
<td>
<p>An object of class <code>vitd.curve</code>.</p>
</td></tr>
<tr><td><code id="exposure.levels_+3A_rate">rate</code></td>
<td>
<p>Expected number of exposures per week, the rate at which exposures occur in an equivalent homogeneous Poisson process.</p>
</td></tr>
<tr><td><code id="exposure.levels_+3A_intensity.func">intensity.func</code></td>
<td>
<p>A function that takes time as sole argument and returns value between 0 and 1, scaling the rate argument. For example, exposures may be higher at certain times for seasonal infections.</p>
</td></tr>
<tr><td><code id="exposure.levels_+3A_start">start</code></td>
<td>
<p>Start time of the study in units of years.</p>
</td></tr>
<tr><td><code id="exposure.levels_+3A_end">end</code></td>
<td>
<p>End time of study in units of years.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+exposure.levels">exposure.levels</a></code> returns an object of class <code>exposure.levels</code> that is a list.
The list has the following slots.
</p>
<table>
<tr><td><code>exposures</code></td>
<td>
<p>The exposure times to infection for each participant. </p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>The vitamin D staus levels for each participant at the time of exposure to infection.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='infection.count'>Generate whether a participant contracted a infection at exposure times.</h2><span id='topic+infection.count'></span>

<h3>Description</h3>

<p>Generates probabilities of developing infection, the relative risk and whether a participant becomes infected or not at exposure times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  infection.count( expos, baseline = 0.03, RR = 3, holding.time = 2, lohi.vit = c(10,70) )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="infection.count_+3A_expos">expos</code></td>
<td>
<p>An object of class <code>exposure.levels</code>.</p>
</td></tr>
<tr><td><code id="infection.count_+3A_baseline">baseline</code></td>
<td>
<p>Numeric, baseline prevalence of developing infection at any exposure time. Probability of developing infection when a participant has maximum (fully replete) vitamin D levels.</p>
</td></tr>
<tr><td><code id="infection.count_+3A_rr">RR</code></td>
<td>
<p>Numeric, the relative risk of the study. The difference between becoming infected at highest and lowest vitamin D levels.</p>
</td></tr>
<tr><td><code id="infection.count_+3A_holding.time">holding.time</code></td>
<td>
<p>Numeric, the mean number of weeks for after becoming infected when the participant can not become re-infected. Times are simulated independently from an exponential distribution with this mean.</p>
</td></tr>
<tr><td><code id="infection.count_+3A_lohi.vit">lohi.vit</code></td>
<td>
<p>A vector of length 2 giving the level at which a participant is considered to have insufficient and sufficient vitamin D status levels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+infection.count">infection.count</a></code> returns an object of class <code>infection.count</code> that is a list.
The list has the following slots.
</p>
<table>
<tr><td><code>baseline</code></td>
<td>
<p>The baseline prevalence of disease.</p>
</td></tr>
<tr><td><code>RR</code></td>
<td>
<p>The relative risk of the study.</p>
</td></tr>
<tr><td><code>inflection</code></td>
<td>
<p>The inflection points of the relative risk curve.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>Matrix, the probability of developing infection at each exposure time for each participant.</p>
</td></tr>
<tr><td><code>relativerisk</code></td>
<td>
<p>Matrix, the relative risk of infection at each exposure time for each participant.</p>
</td></tr>
<tr><td><code>infection</code></td>
<td>
<p>Matrix, 1 if participant was infected at the corresponding exposure time, 0 if participant was not infected at exposure time.</p>
</td></tr>
<tr><td><code>count</code></td>
<td>
<p>Number of infections for each participant over the course of the study.</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>The mean number of infections for the group over the course of the study.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='infection.count.plot'>Plotting the times of disease on the vitamin D curves.</h2><span id='topic+infection.count.plot'></span>

<h3>Description</h3>

<p>Plot whether a participant was disease or not as points on top of the vitamin D curves plotted from <code>plot.vitd.curve</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    infection.count.plot( expos, infect, pch = 20, cex = 1.5, col = "red" )
  </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="infection.count.plot_+3A_expos">expos</code></td>
<td>
<p>An object of class <code>exposure.levels</code>.</p>
</td></tr>
<tr><td><code id="infection.count.plot_+3A_infect">infect</code></td>
<td>
<p>An object of class <code>infection.count</code>.</p>
</td></tr>
<tr><td><code id="infection.count.plot_+3A_pch">pch</code></td>
<td>
<p>Plotting symbol for the points.</p>
</td></tr>
<tr><td><code id="infection.count.plot_+3A_cex">cex</code></td>
<td>
<p>Standard graphical parameter.</p>
</td></tr>
<tr><td><code id="infection.count.plot_+3A_col">col</code></td>
<td>
<p>Colour of the plotted points.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='intensity.function'>Generate an intensity function</h2><span id='topic+intensity.function'></span>

<h3>Description</h3>

<p>Generates intensity function, function with time as sole argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  intensity.function( summer.rate = 0, winter.rate = 1, flu = TRUE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intensity.function_+3A_summer.rate">summer.rate</code></td>
<td>
<p>Value bwteeen 0 and 1, the rate at which exposures occur in summer months.</p>
</td></tr>
<tr><td><code id="intensity.function_+3A_winter.rate">winter.rate</code></td>
<td>
<p>Value between 0 and 1, the rate at which exposures occur in winter months.</p>
</td></tr>
<tr><td><code id="intensity.function_+3A_flu">flu</code></td>
<td>
<p>If <code>TRUE</code> define winter months as flu season (Sep-May in Northern Hemisphere, Mar-Nov in Southern Hemisphere). If <code>FALSE</code> have constant exposure rate all year.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+intensity.function">intensity.function</a></code> returns a function that takes
time as sole argument and returns value between 0 and 1,
the returned function acts as
<code>intensity.func</code> for input to <code><a href="#topic+exposure.levels">exposure.levels</a></code>.
</p>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='plot.exposure.levels'>Plotting the exposures to infection on vitamin D status curves.</h2><span id='topic+plot.exposure.levels'></span>

<h3>Description</h3>

<p>Plot the exposures to infection as points on top of the vitamin D curves plotted from <code>plot.vitd.curve</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ## S3 method for class 'exposure.levels'
plot( x, col = "blue", ... )
  </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.exposure.levels_+3A_x">x</code></td>
<td>
<p>An object of class <code>exposure.levels</code>.</p>
</td></tr>
<tr><td><code id="plot.exposure.levels_+3A_col">col</code></td>
<td>
<p>Character, value for the colour of the points.</p>
</td></tr>
<tr><td><code id="plot.exposure.levels_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='plot.power.calc'>Plotting a power.calc object</h2><span id='topic+plot.power.calc'></span>

<h3>Description</h3>

<p>Plot the power between two groups as the number of participants and the relative risk vary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ## S3 method for class 'power.calc'
plot( x, col = "hotpink", lwd = 1.5, lty = 1, ylab = NULL, 
          x.legend = NULL, y.legend = NULL, main.legend = "Risk scaling", legend.size = 1, 
          target.power = NA, which = 1L, ... )
  </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.power.calc_+3A_x">x</code></td>
<td>
<p>An object of class <code>power.calc</code>.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_col">col</code></td>
<td>
<p>Colour of the line.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_lwd">lwd</code></td>
<td>
<p>Line width.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_lty">lty</code></td>
<td>
<p>Line type.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_ylab">ylab</code></td>
<td>
<p>Title for the y-axis.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_x.legend">x.legend</code></td>
<td>
<p>The x position of the legend. If not given, tries to default to a sensible value.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_y.legend">y.legend</code></td>
<td>
<p>The y position of the legend. If not given, tries to default to a sensible value.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_main.legend">main.legend</code></td>
<td>
<p>Title for the legend.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_legend.size">legend.size</code></td>
<td>
<p>Size of the legend.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_target.power">target.power</code></td>
<td>
<p>Add a horizontal dotted line at a target power. A value of <code>NA</code> suppresses plotting.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_which">which</code></td>
<td>
<p>Type of plot. Value 1 gives a plot of power, and value 2 plot of estimated effect size.</p>
</td></tr>
<tr><td><code id="plot.power.calc_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='plot.vitd.curve'>Plotting a vitd.curve object</h2><span id='topic+plot.vitd.curve'></span>

<h3>Description</h3>

<p>Plot vitamin D status curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'vitd.curve'
plot( x, main = " ", xlab = " ", ylab = "25-hydroxyvitamin D", 
    col=1:6, add = FALSE, ylim = NULL, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.vitd.curve_+3A_x">x</code></td>
<td>
<p>An object of class <code>vitd.curve</code>.</p>
</td></tr>
<tr><td><code id="plot.vitd.curve_+3A_main">main</code></td>
<td>
<p>Main title for the plot.</p>
</td></tr>
<tr><td><code id="plot.vitd.curve_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x-axis.</p>
</td></tr>
<tr><td><code id="plot.vitd.curve_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y-axis.</p>
</td></tr>
<tr><td><code id="plot.vitd.curve_+3A_col">col</code></td>
<td>
<p>A vector of colours for the plotted status curves.</p>
</td></tr>
<tr><td><code id="plot.vitd.curve_+3A_add">add</code></td>
<td>
<p>If <code>TRUE</code>, add to current plotting window</p>
</td></tr>
<tr><td><code id="plot.vitd.curve_+3A_ylim">ylim</code></td>
<td>
<p>Gives the plotting limits on tye y-axis.</p>
</td></tr>
<tr><td><code id="plot.vitd.curve_+3A_...">...</code></td>
<td>
<p>Additional arguments to the <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='power.calc'>Generate the power to detect the difference between two groups</h2><span id='topic+power.calc'></span>

<h3>Description</h3>

<p>generates a value for the power between two groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  power.calc( n, ratio=1, N = 500, test.type, sig.level = 0.05,
    vitdcurves.placebo = NULL, vitdcurves.treatment = NULL,
  	baseline = 0.03, RR = 3, rate = 1, intensity.func = intensity.function(), 
  	holding.time = 2, lohi.vit = c(10,70), clt = NULL, mc.error = 1, boot.rep = 9999, 
  	parallel = FALSE, num.cores = NULL, verbose=FALSE )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.calc_+3A_n">n</code></td>
<td>
<p>Numeric, the number of participants in the control group.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_ratio">ratio</code></td>
<td>
<p>Ratio greater than or equal to 1 giving size of treatment group as a multiple of <code>n</code>. Defaults to groups of equal size.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_n">N</code></td>
<td>
<p>Number of simulations of the study to run.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_test.type">test.type</code></td>
<td>
<p>Type of test to calculate the power, one of &quot;count&quot; or &quot;proportions&quot;. </p>
</td></tr>
<tr><td><code id="power.calc_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level used to test for a statistically significant difference between the groups.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_vitdcurves.placebo">vitdcurves.placebo</code></td>
<td>
<p>An object of class <code>vitd.curve</code>.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_vitdcurves.treatment">vitdcurves.treatment</code></td>
<td>
<p>An object of class <code>vitd.curve</code>.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_baseline">baseline</code></td>
<td>
<p>Baseline prevalence of getting diseased at any exposure time. Probability of getting diseased when a participant has sufficient vitamin D levels.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_rr">RR</code></td>
<td>
<p>Fold risk difference between getting infection between the most deficient and most sufficient vitamin D levels.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_rate">rate</code></td>
<td>
<p>Expected number of exposures per week, the rate at which exposures occur in the equivalent homogeneous Poisson process.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_intensity.func">intensity.func</code></td>
<td>
<p>Function taking time as sole argument and returns value between 0 and 1, input to nhpp function see poisson package.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_holding.time">holding.time</code></td>
<td>
<p>Expected number of weeks for the holding time.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_lohi.vit">lohi.vit</code></td>
<td>
<p>Inflection points of the relative risk curve used in <code>infection.count</code>.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_clt">clt</code></td>
<td>
<p>Logical or vector of logical values of same length as <code>n</code> indicating whether to use Central Limit Theorem approximation for the test when <code>TRUE</code>. Default is <code>NULL</code> and determination is automatic based on whether group size is less than 35 or not. </p>
</td></tr>
<tr><td><code id="power.calc_+3A_mc.error">mc.error</code></td>
<td>
<p>Number of times to repeat the experiment at each <code>n</code> value to explore Monte Carlo error.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_boot.rep">boot.rep</code></td>
<td>
<p>Number of bootstrap samples to carry out non-parametric tests of hypotheses.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_parallel">parallel</code></td>
<td>
<p>Use parallel processing to carry out the simulations. This will parallelise over mc.error.</p>
</td></tr>
<tr><td><code id="power.calc_+3A_num.cores">num.cores</code></td>
<td>
<p>Number of cores to exploit in parallel mode. Defaults to (cores available) - 1. </p>
</td></tr>
<tr><td><code id="power.calc_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code> print out regular updates on progression. Not available when parallel is set to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+power.calc">power.calc</a></code> returns an object of class <code>power.calc</code> that is a list.
The list has the following slots.
</p>
<table>
<tr><td><code>test.type</code></td>
<td>
<p>The type of study the power has been calculated on.</p>
</td></tr>
<tr><td><code>baseline</code></td>
<td>
<p>The baseline prevalence for disease.</p>
</td></tr>
<tr><td><code>RR</code></td>
<td>
<p>The relative risk of the study.</p>
</td></tr>
<tr><td><code>npergroup</code></td>
<td>
<p>The number of participants per group in the study.</p>
</td></tr>
<tr><td><code>mc.error</code></td>
<td>
<p>Number of repetitions of experiment to approximate Monte Carlo error.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>A <code>length(RR)</code> x <code>mc.error</code> x <code>length(npergroup)</code> array of estimated power values. </p>
</td></tr>
<tr><td><code>eff.size</code></td>
<td>
<p>A <code>length(RR)</code> x <code>mc.error</code> x <code>length(npergroup)</code> array of estimated treatment effects (differences between groups).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate placebo group
placebo &lt;- vitd.curve( n = 10, type = "placebo" )

# simulate treatment group
treatment &lt;- vitd.curve( n = 10, type = "dynamic-dose" )

# intensity function for exposures to infection
intensfun &lt;- intensity.function( summer.rate = 0, winter.rate = 1 )
  
# calculate power: example only- run for much larger value of N
pow &lt;- power.calc( n = c(10,20,30), 
        N = 10,  test.type = 'count', 
        vitdcurves.placebo = placebo, vitdcurves.treatment = treatment,
        baseline = 0.03, RR = c(2,4), rate = 1, intensity.func = intensfun, boot.rep=2000 )
            
### NOT RUN ###            
# approximate the Monte Carlo error in estimation of the power-- takes longer to run
#pow &lt;- power.calc( n = c(10,20,30), 
#         N = 100, test.type = 'count', 
#         vitdcurves.placebo = placebo, vitdcurves.treatment = treatment,
#         baseline = 0.03, RR = c(2,3,4), rate = 1, 
#         intensity.func = intensfun, mc.error = 10 )

# plot power curves
plot( pow, xlab = "n", x.legend = 10, y.legend = 1, main.legend = "Relative Risk" )
</code></pre>

<hr>
<h2 id='print.exposure.levels'>Print summary of an exposure.levels object.</h2><span id='topic+print.exposure.levels'></span>

<h3>Description</h3>

<p>Print a summary of a exposure.levels object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'exposure.levels'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.exposure.levels_+3A_x">x</code></td>
<td>
<p>An object of class <code>exposure.levels</code>.</p>
</td></tr>
<tr><td><code id="print.exposure.levels_+3A_...">...</code></td>
<td>
<p>Optional arguments to lower level functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='print.infection.count'>Print a summary of a infection.count object</h2><span id='topic+print.infection.count'></span>

<h3>Description</h3>

<p>Print a summary of a infection.count object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'infection.count'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.infection.count_+3A_x">x</code></td>
<td>
<p>An object of class <code>infection.count</code>.</p>
</td></tr>
<tr><td><code id="print.infection.count_+3A_...">...</code></td>
<td>
<p>Optional arguments to lower level functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='print.power.calc'>Summary of a power.calc object</h2><span id='topic+print.power.calc'></span>

<h3>Description</h3>

<p>Print a summary of a power.calc object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'power.calc'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.power.calc_+3A_x">x</code></td>
<td>
<p>An object of class <code>power.calc</code>.</p>
</td></tr>
<tr><td><code id="print.power.calc_+3A_...">...</code></td>
<td>
<p>Optional arguments to lower level functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='print.vitd.curve'>Print summary of a vitd.curve object</h2><span id='topic+print.vitd.curve'></span>

<h3>Description</h3>

<p>Print a summary of a vitd.curve object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'vitd.curve'
print( x, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.vitd.curve_+3A_x">x</code></td>
<td>
<p>An object of class <code>vitd.curve</code>.</p>
</td></tr>
<tr><td><code id="print.vitd.curve_+3A_...">...</code></td>
<td>
<p>Optional arguments to lower level functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='rr.curve.plot'>Plotting the relative risk curve for vitamin D status.</h2><span id='topic+rr.curve.plot'></span>

<h3>Description</h3>

<p>Plot the relative risk curve for vitamin D showing times of exposure and whether a participant developed infection from exposure.</p>


<h3>Usage</h3>

<pre><code class='language-R'>    rr.curve.plot( expos, infect, idx = 1, main = NULL, xlab = "25-hydroxyvitamin D",
        ylab = "Risk scaling", col = "blue", ... )
  </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rr.curve.plot_+3A_expos">expos</code></td>
<td>
<p>An object of class <code>exposure.levels</code>.</p>
</td></tr>
<tr><td><code id="rr.curve.plot_+3A_infect">infect</code></td>
<td>
<p>An object of class <code>infection.count</code>.</p>
</td></tr>
<tr><td><code id="rr.curve.plot_+3A_idx">idx</code></td>
<td>
<p>A vector of indexes of specific exposures to plot.</p>
</td></tr>
<tr><td><code id="rr.curve.plot_+3A_main">main</code></td>
<td>
<p>Main title for the plot.</p>
</td></tr>
<tr><td><code id="rr.curve.plot_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x-axis.</p>
</td></tr>
<tr><td><code id="rr.curve.plot_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y-axis.</p>
</td></tr>
<tr><td><code id="rr.curve.plot_+3A_col">col</code></td>
<td>
<p>Character, value for the colour of the points.</p>
</td></tr>
<tr><td><code id="rr.curve.plot_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='rr.profile.plot'>Plotting a vitamin D profile and relative risk curve.</h2><span id='topic+rr.profile.plot'></span>

<h3>Description</h3>

<p>Plot a vitamin D status profile for a single participant and the relative risk curve for vitamin D (with exposure times and whether a participant was infected at that exposure time) side by side.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rr.profile.plot( x, expos, infect, idx = 1, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rr.profile.plot_+3A_x">x</code></td>
<td>
<p>An object of class <code>vitd.curve</code>.</p>
</td></tr>
<tr><td><code id="rr.profile.plot_+3A_expos">expos</code></td>
<td>
<p>An object of class <code>exposure.levels</code>.</p>
</td></tr>
<tr><td><code id="rr.profile.plot_+3A_infect">infect</code></td>
<td>
<p>An object of class <code>infection.count</code>.</p>
</td></tr>
<tr><td><code id="rr.profile.plot_+3A_idx">idx</code></td>
<td>
<p>Index of curve to plot.</p>
</td></tr>
<tr><td><code id="rr.profile.plot_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>


<h3>Examples</h3>

<pre><code class='language-R'># individual profiles
indprofiles &lt;- vitd.curve( n=10, type="placebo" )

# intensity function for exposures to infection
intensfun &lt;- intensity.function( summer.rate=0.1, winter.rate=0.9 )

# exposure times
expos &lt;- exposure.levels( indprofiles, rate=2, intensfun, end=2 )

# disease calculation
infect &lt;- infection.count( expos )

# plot RR profile
rr.profile.plot( indprofiles, expos, infect )
</code></pre>

<hr>
<h2 id='SimVitD-package'>Simulation tools for vitamin D studies.</h2><span id='topic+SimVitD-package'></span>

<h3>Description</h3>

<p>A suite of tools for statistical planning of vitamin D trials. 
</p>


<h3>Details</h3>

 
<p>The <code>SimVitD</code> package uses simulation to aid in statistical planning of vitamin D trials. The core elements of the simulation based tools involve 
</p>
<p>(i) simulation of an individual vitamin D staus profiles taking into account natural cyclic variation in summer and winter
</p>
<p>(ii) simulation of exposures to potential infections in an individual's envrionment
</p>
<p>(iii) simulation of the possibility of developing infection conditional on vitamin D status at exposure
</p>
<p>(iv) Monte Carlo estimation of power of detecting supplementation effects for a selection of different supplementation scheme and two classes of hypothesis test.
</p>
<p>The fuctions <code><a href="#topic+vitd.curve">vitd.curve</a></code> to generate individual status profiles and <code><a href="#topic+exposure.levels">exposure.levels</a></code> to simulate exposures. The accompanying vignette provides a gateway into the simulation tools. 
</p>


<h3>Author(s)</h3>

<p>Rebecca Mangan, Jason Wyse, Lina Zgaga</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate individual Vitamin D profiles
indprofiles &lt;- vitd.curve( n=10, type="placebo" )

# make a plot of all these profiles
plot( indprofiles )

# intensity function for exposures to infection
intensfun &lt;- intensity.function( summer.rate=0.1, winter.rate=0.9 )

# exposure times
expos &lt;- exposure.levels( indprofiles, rate=2, intensfun, end=2 )

# plot of exposures on top of Vitamin D profiles
plot( expos )

# disease calculation
infect &lt;- infection.count( expos )

# plot disease points on top of exposure points
infection.count.plot( expos, infect )
</code></pre>

<hr>
<h2 id='summary.exposure.levels'>Summary of a vitd.curve object</h2><span id='topic+summary.exposure.levels'></span>

<h3>Description</h3>

<p>Print a summary of a exposure.levels object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'exposure.levels'
summary( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.exposure.levels_+3A_object">object</code></td>
<td>
<p>An object of class <code>exposure.levels</code>.</p>
</td></tr>
<tr><td><code id="summary.exposure.levels_+3A_...">...</code></td>
<td>
<p>Optional arguments to lower level functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='summary.infection.count'>Summary of a infection.count object</h2><span id='topic+summary.infection.count'></span>

<h3>Description</h3>

<p>Print a summary of a infection.count object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'infection.count'
summary( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.infection.count_+3A_object">object</code></td>
<td>
<p>An object of class <code>infection.count</code>.</p>
</td></tr>
<tr><td><code id="summary.infection.count_+3A_...">...</code></td>
<td>
<p>Optional arguments to lower level functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='summary.power.calc'>Summary of a power.calc object</h2><span id='topic+summary.power.calc'></span>

<h3>Description</h3>

<p>Print a summary of a power.calc object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'power.calc'
summary( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.power.calc_+3A_object">object</code></td>
<td>
<p>An object of class <code>power.calc</code>.</p>
</td></tr>
<tr><td><code id="summary.power.calc_+3A_...">...</code></td>
<td>
<p>Optional arguments to lower level functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='summary.vitd.curve'>Summary of a vitd.curve object</h2><span id='topic+summary.vitd.curve'></span>

<h3>Description</h3>

<p>Print a summary of a vitd.curve object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'vitd.curve'
summary( object, ... )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.vitd.curve_+3A_object">object</code></td>
<td>
<p>An object of class <code>vitd.curve</code>.</p>
</td></tr>
<tr><td><code id="summary.vitd.curve_+3A_...">...</code></td>
<td>
<p>Optional arguments to lower level functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

<hr>
<h2 id='vitd.curve'>Generate Vitamin D curves</h2><span id='topic+vitd.curve'></span>

<h3>Description</h3>

<p>Generates a vitamin D status profile curve for each individual in a group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vitd.curve( n = 1, type = c("placebo","fixed-dose","dynamic-dose"), start = 0, end = 1,  
    mu = 45, amplitude = 35, dyn.dose.thresh = 50, sd.mu = 5, sd.amplitude = 5, 
    sd.dyn.dose.thresh = 5, supp.dose = 20, supp.dose.rate = Inf, weight = 1, 
    sd.weight = 0, min.thresh = 10, north.hemi = TRUE, res = 40 )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vitd.curve_+3A_n">n</code></td>
<td>
<p>Number of curves to simulate.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_type">type</code></td>
<td>
<p>One of &quot;placebo&quot;, &quot;fixed-dose&quot;, &quot;dynamic-dose&quot;.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_start">start</code></td>
<td>
<p>Time in units of years when trial started.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_end">end</code></td>
<td>
<p>Time in units of years when trial ended.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_mu">mu</code></td>
<td>
<p>The mean level of 25OHD in the trial arm around which there is cosine variation.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_amplitude">amplitude</code></td>
<td>
<p>Amplitude of cosine function describing variation around <code>mu</code></p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_dyn.dose.thresh">dyn.dose.thresh</code></td>
<td>
<p>Threshold for the concentration-controlled scheme.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_sd.mu">sd.mu</code></td>
<td>
<p>Standard deviation levels around mean; this is the standard deviation of H in vignette.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_sd.amplitude">sd.amplitude</code></td>
<td>
<p>Standard deviation of the amplitude.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_sd.dyn.dose.thresh">sd.dyn.dose.thresh</code></td>
<td>
<p>Standard deviation of the participant retained concentration in the concentration-controlled trial.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_supp.dose">supp.dose</code></td>
<td>
<p>The 25OHD nmol/l equivalent for dosage in fixed-dose supplementation.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_supp.dose.rate">supp.dose.rate</code></td>
<td>
<p>Concentration parameter for fixed-dose scheme uptake. Large values imply that all participants derive the same equivalent.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_weight">weight</code></td>
<td>
<p>For fixed-dose supplementation, this is the expected value of the proportion of the dose which is always utilized.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_sd.weight">sd.weight</code></td>
<td>
<p>Standard deviation of weight</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_min.thresh">min.thresh</code></td>
<td>
<p>The minimum detectable threshold of 25OHD. Defaults to 10 nmol/l.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_north.hemi">north.hemi</code></td>
<td>
<p>Summer/winter months as in the Northern Hemisphere if <code>TRUE</code> and Southern Hemisphere if <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="vitd.curve_+3A_res">res</code></td>
<td>
<p>Resolution parameter for plotting of vitamin D curves.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+vitd.curve">vitd.curve</a></code> returns an object of class <code>vitd.curve</code>. Curve parameter settings are returned. The slot <code>curves</code> give the curve specific parameters for each of the <code>n</code> generated curves. Additionally, <code>time</code> used for plotting gives time values passed to <code>plot.vitd.curve</code>.
</p>


<h3>Author(s)</h3>

<p>Rebecca Mangan and Jason Wyse</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
