<!DOCTYPE html><html><head><title>Help for package rbounds</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rbounds}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#angristlavy'><p>Angrist and Lavy (1999) Maimonides' Rule Data Set</p></a></li>
<li><a href='#binarysens'><p>Sensitivity Test for Matched Binary Outcome</p></a></li>
<li><a href='#FisherSens'><p>Rosenbaum Sensitivity Analysis for Fisher's Exact Test</p></a></li>
<li><a href='#hlsens'><p>Rosenbaum Bounds for Hodges-Lehmann Point Estimate</p></a></li>
<li><a href='#iv_sens'>
<p>Function to calculate Rosenbaum bounds for IV Estimator based on Wilcoxon sign rank test.</p></a></li>
<li><a href='#mcontrol'><p>Sensitivity Analysis For Multiple Matched Controls</p></a></li>
<li><a href='#print.rbounds'><p>Summarize output from rbounds object</p></a></li>
<li><a href='#psens'><p>Rosenbaum Bounds for Sign Rank</p></a></li>
<li><a href='#SumTestSens'><p>Rosenbaum Sensitivity Analysis for Unmatched Groups</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Title:</td>
<td>Perform Rosenbaum Bounds Sensitivity Tests for Matched and
Unmatched Data</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Luke J. Keele</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luke J. Keele &lt;luke.keele@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Takes matched and unmatched data and calculates Rosenbaum bounds for the treatment effect.  Calculates bounds for binary outcome data, Hodges-Lehmann point estimates, Wilcoxon signed-rank test for matched data and matched IV estimators, Wilcoxon sum rank test, and for data with multiple matched controls. The sensitivity analysis methods in this package are documented in Rosenbaum (2002) Observational Studies, &lt;<a href="https://doi.org/10.1007%2F978-1-4757-3692-2">doi:10.1007/978-1-4757-3692-2</a>&gt;, Springer-Verlag.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-28 18:22:22 UTC; ljk20</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-29 23:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='angristlavy'>Angrist and Lavy (1999) Maimonides' Rule Data Set</h2><span id='topic+angristlavy'></span>

<h3>Description</h3>

<p>Angrist and Lavy (1999) data set used by Rosenbaum (2010) to
demonstrate his instrumental variable sensitivity analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(angristlavy)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 172 observations on the following variables).
</p>
<p>clasz: Size of class or classes for each cohort.
</p>
<p>avgmath: Average math test score for each class.
</p>
<p>z: A recode of enrollment with 1 indicating a cohort with 41 or more students, i.e. two classes. 
This serves as the instrument which encourages smaller classes.
</p>
<p>pair: matched pair id
</p>


<h3>Source</h3>

<p>Angrist, Joshua and Lavy, Victor (1999). &ldquo;Using Maimonides' Rule to
Estimate the Effect of Class Size on Scholastic
Achievement.&rdquo; <em>Quarterly Journal of Economics</em> 114, 533&ndash;575.
</p>
<p>Rosenbaum, Paul R. (2010). <em>Design of Observational Studies</em>.
Springer-Verlag.
</p>


<h3>References</h3>

<p>Rosenbaum, Paul R. (2010). <em>Design of Observational Studies</em>.
Springer-Verlag.
</p>

<hr>
<h2 id='binarysens'>Sensitivity Test for Matched Binary Outcome</h2><span id='topic+binarysens'></span>

<h3>Description</h3>

 
<p>Function to calculate Rosenbaum bounds for binary data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
binarysens(x,y, Gamma=6, GammaInc=1)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="binarysens_+3A_x">x</code></td>
<td>
<p>Count of the first set of discrepant pairs in a table of treated and control outcomes.</p>
</td></tr> 
<tr><td><code id="binarysens_+3A_y">y</code></td>
<td>
<p>Count of the second set of discrepant pairs in a table of treated and control outcomes.</p>
</td></tr> 
<tr><td><code id="binarysens_+3A_gamma">Gamma</code></td>
<td>
<p>Upper-bound on gamma parameter.</p>
</td></tr> 
<tr><td><code id="binarysens_+3A_gammainc">GammaInc</code></td>
<td>
<p>To set user specified increments for gamma parameter. </p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Luke Keele, University of Pennsylvania, <a href="mailto:luke.keele@gmail.com">luke.keele@gmail.com</a></p>


<h3>References</h3>

<p>Rosenbaum, Paul R. (2002) <em>Observational Studies</em>. Springer-Verlag.</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+psens">psens</a></code>,  <code><a href="#topic+hlsens">hlsens</a></code>, <code><a href="#topic+mcontrol">mcontrol</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# Example From Rosenbaum Observational Studies Pg 112
# Success: Died From Lung Cancer
# 110 Discrepant Pairs
# 12 Discrepant Pairs

# Sensitivity Test
binarysens(12,110)

</code></pre>

<hr>
<h2 id='FisherSens'>Rosenbaum Sensitivity Analysis for Fisher's Exact Test</h2><span id='topic+FisherSens'></span>

<h3>Description</h3>

<p>Calculates sensitivity to hidden bias for Fisher's exact test for a two-by-two contingency table, following the method described in Rosenbaum (2002, sec. 4.4).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FisherSens(totalN, treatedN, totalSuccesses, treatedSuccesses, Gammas)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FisherSens_+3A_totaln">totalN</code></td>
<td>
<p>total number of observations</p>
</td></tr>
<tr><td><code id="FisherSens_+3A_treatedn">treatedN</code></td>
<td>
<p>number of treated observations</p>
</td></tr>
<tr><td><code id="FisherSens_+3A_totalsuccesses">totalSuccesses</code></td>
<td>
<p>total number of &ldquo;successes&rdquo;</p>
</td></tr>
<tr><td><code id="FisherSens_+3A_treatedsuccesses">treatedSuccesses</code></td>
<td>
<p>number of successes in treatment group</p>
</td></tr>
<tr><td><code id="FisherSens_+3A_gammas">Gammas</code></td>
<td>
<p>vector of Gammas (bounds on the differential odds of treatment) at which to test the significance of the results</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix with three columns and number of rows equal to the length of &quot;Gammas&quot;. Each row indicates the upper and lower bounds for the (one-sided) p-value for a given value of Gamma.
</p>


<h3>Author(s)</h3>

<p>Devin Caughey, MIT, <a href="mailto:caughey@mit.edu">caughey@mit.edu</a>
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+binarysens">binarysens</a></code>,
<code><a href="#topic+hlsens">hlsens</a></code>,
<code><a href="#topic+mcontrol">mcontrol</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Fisher's Lady Tasting Tea: milk first or tea first?
LadyTastingTea &lt;- matrix(c(4, 0, 0, 4), nrow = 2,
                         dimnames = list(Guess = c("Milk", "Tea"),
                                         Truth = c("Milk", "Tea")))
## Define "Milk" as "treated"/"success"
FisherSens(totalN = sum(LadyTastingTea), 
           treatedN = sum(LadyTastingTea["Milk", ]),
           totalSuccesses = sum(LadyTastingTea[, "Milk"]), 
           treatedSuccesses = sum(LadyTastingTea["Milk", "Milk"]), 
           Gammas = seq(1, 2, .2))
## Interpretation: Rejection of the null hypothesis 
## (that the lady cannot discriminate between milk-first and tea-first) 
## is insensitive to bias as large as Gamma = 2.
</code></pre>

<hr>
<h2 id='hlsens'>Rosenbaum Bounds for Hodges-Lehmann Point Estimate</h2><span id='topic+hlsens'></span>

<h3>Description</h3>

 
<p>Function to calculate Rosenbaum bounds for continuous or ordinal
outcomes based on Hodges-Lehmann point estimate. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'># Default Method 
hlsens(x, y, pr = 0.1, Gamma = 6, GammaInc = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hlsens_+3A_x">x</code></td>
<td>
<p>Treatment group outcomes in same order as treatment group.</p>
</td></tr> 
<tr><td><code id="hlsens_+3A_y">y</code></td>
<td>
<p>Control group outcomes in same order as treatment group.</p>
</td></tr> 
<tr><td><code id="hlsens_+3A_pr">pr</code></td>
<td>
<p>Search precision parameter.</p>
</td></tr> 
<tr><td><code id="hlsens_+3A_gamma">Gamma</code></td>
<td>
<p>Upper-bound on gamma parameter.</p>
</td></tr> 
<tr><td><code id="hlsens_+3A_gammainc">GammaInc</code></td>
<td>
<p>To set user specified increments for gamma parameter.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>For large data sets this function can be quite slow if pr is
set to low. If the data set is larger, it is best to set pr to .5
before trying values such as .01.  Generally, the results from the
function are insensitive to the value for pr.</p>


<h3>Author(s)</h3>

<p>Luke Keele, University of Pennsylvania, <a href="mailto:luke.keele@gmail.com">luke.keele@gmail.com</a></p>


<h3>References</h3>

<p>Rosenbaum, Paul R. (2002) <em>Observational Studies</em>.
Springer-Verlag.</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+binarysens">binarysens</a></code>,
<code><a href="#topic+psens">psens</a></code>,
<code><a href="#topic+mcontrol">mcontrol</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Replication of Rosenbaum Sensitivity Tests From Chapter 4 of
# Observational Studies

# Data: Matched Data of Lead Blood Levels in Children
trt &lt;- c(38, 23, 41, 18, 37, 36, 23, 62, 31, 34, 24, 14, 21, 17, 16, 20,
15, 10, 45, 39, 22, 35, 49, 48, 44, 35, 43, 39, 34, 13, 73, 25, 27)

ctrl &lt;- c(16, 18, 18, 24, 19, 11, 10, 15, 16, 18, 18, 13, 19, 10, 16,
16, 24, 13, 9, 14, 21, 19, 7, 18, 19, 12, 11, 22, 25, 16, 13, 11, 13)

hlsens(trt, ctrl)
</code></pre>

<hr>
<h2 id='iv_sens'>
Function to calculate Rosenbaum bounds for IV Estimator based on Wilcoxon sign rank test. 
</h2><span id='topic+iv_sens'></span>

<h3>Description</h3>

<p><code>iv_sens</code> performs a non-parametric, instrumental
variable sensitivity analysis on matched pairs following the logic of
the Neyman-Rubin framework for causal inference. The function supports
a variable-valued instrument.</p>


<h3>Usage</h3>

<pre><code class='language-R'>iv_sens(Rt, Rc, Dt, Dc, Gamma = 6, GammaInc = 1)</code></pre>


<h3>Arguments</h3>

  
<table>
<tr><td><code id="iv_sens_+3A_rt">Rt</code>, <code id="iv_sens_+3A_rc">Rc</code></td>
<td>
<p>Vectors of observed response outcomes for matched
treatment and control observations, respectively.</p>
</td></tr>
<tr><td><code id="iv_sens_+3A_dt">Dt</code>, <code id="iv_sens_+3A_dc">Dc</code></td>
<td>
<p>Vectors of observed doses for matched observations, respectively.
This is level of dose encouraged by the instrument.</p>
</td></tr>
<tr><td><code id="iv_sens_+3A_gamma">Gamma</code></td>
<td>
<p>Upper-bound on gamma parameter.</p>
</td></tr> 
<tr><td><code id="iv_sens_+3A_gammainc">GammaInc</code></td>
<td>
<p>To set user specified increments for gamma parameter.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Given matched pairs of observations on an instrument <code>Z</code>, 
which encourages dose <code>D</code>, this function performs a Rosenbaum's bounds sensitivity analysis. Note  that matching is done on levels of the instrument.</p>


<h3>Value</h3>

<p>Returns an object of class <code>rbounds</code>.</p>


<h3>Author(s)</h3>

<p>Luke Keele, University of Pennsylvania, <a href="mailto:luke.keele@gmail.com">luke.keele@gmail.com</a></p>


<h3>References</h3>

<p>Angrist, Joshua D., Imbens, Guido W., and Rubin, Donald B. (1996).
&quot;Identification of Causal Effects Using Instrumental Variables.&quot;
<em>Journal of the American Statistical Association</em> 91/434, pp.
444&ndash;455.
</p>
<p>Rosenbaum, Paul R. (1996). &quot;Comment.&quot; <em>Journal of the American 
Statistical Association</em> 91/434, pp. 465&ndash;468.
</p>
<p>Rosenbaum, Paul R. (2002). <em>Observational Studies</em>.
Springer-Verlag.
</p>
<p>Rosenbaum, Paul R. (2010). <em>Design of Observational Studies</em>.
Springer-Verlag.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+binarysens">binarysens</a></code>,  <code><a href="#topic+hlsens">hlsens</a></code>, <code><a href="#topic+mcontrol">mcontrol</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(angristlavy)

# Example from Ch 5 of Design of Observational Studies
	
#Extract Matched Outome Data
Rt &lt;- angristlavy$avgmath[angristlavy$z==1]
Rc &lt;- angristlavy$avgmath[angristlavy$z==0]

#Extract Matched Doses
#Doses Encouraged By Instrument - Here Class Size
Dt &lt;- angristlavy$clasz[angristlavy$z==1]
Dc &lt;- angristlavy$clasz[angristlavy$z==0]


#Run Sensitivity Analsyis - Rank Sum Test
iv_sens(Rc, Rt, Dc, Dt, Gamma=1.5, GammaInc=.01)


</code></pre>

<hr>
<h2 id='mcontrol'>Sensitivity Analysis For Multiple Matched Controls</h2><span id='topic+mcontrol'></span>

<h3>Description</h3>

<p>Function to calculate Rosenbaum bounds for continuous or
ordinal outcomes based on Wilcoxon sign rank test <em>p</em>-value when
there are multiple matched control units.</p>


<h3>Usage</h3>

<pre><code class='language-R'># Default Method 
mcontrol(y, grp.id, treat.id, group.size = 3, Gamma = 4, GammaInc = 1)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="mcontrol_+3A_y">y</code></td>
<td>
<p>Vector of grouped matched outcomes.</p>
</td></tr>
<tr><td><code id="mcontrol_+3A_treat.id">treat.id</code></td>
<td>
<p>A vector indicating the treated unit in each matched
group.</p>
</td></tr>
<tr><td><code id="mcontrol_+3A_grp.id">grp.id</code></td>
<td>
<p>A vector indicating matched groups.</p>
</td></tr> 
<tr><td><code id="mcontrol_+3A_group.size">group.size</code></td>
<td>
<p>The size of the matched groups. Three for one
treated unit and two control units.</p>
</td></tr>
<tr><td><code id="mcontrol_+3A_gamma">Gamma</code></td>
<td>
<p>Upper-bound on gamma parameter.</p>
</td></tr> 
<tr><td><code id="mcontrol_+3A_gammainc">GammaInc</code></td>
<td>
<p>To set increments for gamma parameter.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The matched data needs to be in a very particular form for
this function to work.  The data must be sorted by matched groups with
indicators for each matched group and for treated and control units.
The simplest way to prepare the data is to use the Match() function and
use the data.prep() function to format the data.
</p>
<p>Currently this function only takes matched data with 2 or 3 controls
units matched to each treated unit.
</p>
<p>This function does cannot handle data where the number of control units
is not the same for every treated unit.</p>


<h3>Author(s)</h3>

<p>Luke Keele, University of Pennsylvania, <a href="mailto:luke.keele@gmail.com">luke.keele@gmail.com</a></p>


<h3>References</h3>

<p>Rosenbaum, Paul R. (2002) <em>Observational Studies</em>. 
Springer-Verlag.</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+binarysens">binarysens</a></code>, <code><a href="#topic+psens">psens</a></code>, 
<code><a href="#topic+hlsens">hlsens</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> 

grp &lt;- c(1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 5, 5, 5, 6, 
         6, 6, 7, 7, 7, 8, 8, 8, 9, 9, 9, 10,10,10,11,
         11,11,12,12,12)
trt &lt;- rep(c(1,0,0), 12)
score &lt;- c(-11.39,-8.45, -19.57,-8.33, 3.06, -19.93,-18.73,-11.99,-7.55, 
            11.94, 9.4, -25.16,-0.77, -10.46,-7.27, 24.03, -8.23, 2.67,  
            -4.04, -6.67, -1.12, -14.4, -26.21,5, -1.7, -15.3, -7.73, 
            -0.87, -19.71,-12.69, -3.36, -11.21,-35.83,5.89, -10.79,2)


mcontrol(score, grp, trt, group.size=3)

</code></pre>

<hr>
<h2 id='print.rbounds'>Summarize output from rbounds object</h2><span id='topic+print.rbounds'></span><span id='topic+summary.rbounds'></span>

<h3>Description</h3>

<p>Summary method for <code>rbounds</code> object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rbounds'
print(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.rbounds_+3A_x">x</code></td>
<td>

<p>An object of class <code>rbounds</code> as produced by
<code><a href="#topic+binarysens">binarysens</a></code>, <code><a href="#topic+hlsens">hlsens</a></code>, or
<code><a href="#topic+psens">psens</a></code>.
</p>
</td></tr>
<tr><td><code id="print.rbounds_+3A_...">...</code></td>
<td>
<p>Any additional arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jason W. Morgan, Ohio State University, <a href="mailto:morgan.746@osu.edu">morgan.746@osu.edu</a>
</p>


<h3>See Also</h3>

<p>Also see <code><a href="#topic+binarysens">binarysens</a></code>, <code><a href="#topic+psens">psens</a></code>, and
<code><a href="#topic+hlsens">hlsens</a></code>.
</p>

<hr>
<h2 id='psens'>Rosenbaum Bounds for Sign Rank</h2><span id='topic+psens'></span>

<h3>Description</h3>

<p>Function to calculate Rosenbaum bounds for continuous or
ordinal outcomes based on Wilcoxon sign rank test.</p>


<h3>Usage</h3>

<pre><code class='language-R'># Default Method 
psens(x, y, Gamma = 6, GammaInc = 1)
</code></pre>


<h3>Arguments</h3>

 
<table>
<tr><td><code id="psens_+3A_x">x</code></td>
<td>
<p>Treatment group outcomes in same order as treatment group.</p>
</td></tr>
<tr><td><code id="psens_+3A_y">y</code></td>
<td>
<p>Control group outcomes in same order as treatment group.</p>
</td></tr>
<tr><td><code id="psens_+3A_gamma">Gamma</code></td>
<td>
<p>Upper-bound on gamma parameter.</p>
</td></tr> 
<tr><td><code id="psens_+3A_gammainc">GammaInc</code></td>
<td>
<p>To set user-specified increments for gamma parameter.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luke Keele, University of Pennsylvania, <a href="mailto:luke.keele@gmail.com">luke.keele@gmail.com</a></p>


<h3>References</h3>

<p>Rosenbaum, Paul R. (2002) <em>Observational Studies</em>.
Springer-Verlag.</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+binarysens">binarysens</a></code>,
<code><a href="#topic+hlsens">hlsens</a></code>,
<code><a href="#topic+mcontrol">mcontrol</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
# Replication of Rosenbaum Sensitivity Tests From Chapter 4 of
# Observational Studies

# Data:  Matched Data of Lead Blood Levels in Children
trt &lt;- c(38, 23, 41, 18, 37, 36, 23, 62, 31, 34, 24, 14, 21, 17, 16, 20,
         15, 10, 45, 39, 22, 35, 49, 48, 44, 35, 43, 39, 34, 13, 73, 25,
         27)
ctrl &lt;- c(16, 18, 18, 24, 19, 11, 10, 15, 16, 18, 18, 13, 19, 10, 16,
          16, 24, 13, 9, 14, 21, 19, 7, 18, 19, 12, 11, 22, 25, 16, 13,
          11, 13)

psens(trt, ctrl)
</code></pre>

<hr>
<h2 id='SumTestSens'>Rosenbaum Sensitivity Analysis for Unmatched Groups</h2><span id='topic+SumTestSens'></span>

<h3>Description</h3>

<p>Calculates sensitivity to hidden bias for tests based on sum statistics (e.g., Wilcoxon's rank sum test), following the method described by Rosenbaum (2002, sec. 4.6). It is meant for unmatched/unstratified data with ordinal or continuous responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SumTestSens(T, q, n, m, Gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SumTestSens_+3A_t">T</code></td>
<td>
<p>observed value of the test statistic (e.g., the sum of the ranks of the responses of the treated units; note that a higher rank corresponds to a higher response)</p>
</td></tr>
<tr><td><code id="SumTestSens_+3A_q">q</code></td>
<td>
<p>vector of functions of the responses (e.g., their ranks), sorted in  decreasing order</p>
</td></tr>
<tr><td><code id="SumTestSens_+3A_n">n</code></td>
<td>
<p>total number of observations</p>
</td></tr>
<tr><td><code id="SumTestSens_+3A_m">m</code></td>
<td>
<p>number treated units</p>
</td></tr>
<tr><td><code id="SumTestSens_+3A_gamma">Gamma</code></td>
<td>
<p>scalar indicating upper limit on the ratio of the a priori odds of treatment assignment between the treated and control groups</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function prints the upper bound of the normal approximation one-sided p-value for the test at the given value of Gamma. It also invisibly returns a list of intermediate statistics.
</p>


<h3>Warning</h3>

<p>Since &lsquo;SumTestSens&rsquo; calculates through enumeration the exact expectation and variance of the test under the null, it is very computationally intensive and may be unworkable for even medium-sized datasets.
</p>


<h3>Author(s)</h3>

<p>Devin Caughey, MIT, <a href="mailto:caughey@mit.edu">caughey@mit.edu</a>
</p>


<h3>References</h3>

<p>Paul R. Rosenbaum. Observational Studies. Springer, New York, 2nd edition, 2002, sec. 4.6</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+binarysens">binarysens</a></code>,
<code><a href="#topic+hlsens">hlsens</a></code>,
<code><a href="#topic+mcontrol">mcontrol</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example from Rosenbaum (2002, p.~146)
  mercury &lt;- data.frame(matrix(c(1, 0, 2.7,    5.3,
                                 2, 0, 0.5,   15.0,
                                 3, 0, 0.0,   11.0,
                                 4, 0, 0.0,    5.8,
                                 5, 0, 5.0,   17.0,
                                 6, 0, 0.0,    7.0,
                                 7, 0, 0.0,    8.5,
                                 8, 0, 1.3,    9.4,
                                 9, 0, 0.0,    7.8,
                                10, 0, 1.8,   12.0,
                                11, 0, 0.0,    8.7,
                                12, 0, 0.0,    4.0,
                                13, 0, 1.0,    3.0,
                                14, 0, 1.8,   12.2,
                                15, 0, 0.0,    6.1,
                                16, 0, 3.1,   10.2,
                                17, 1, 0.7,  100.0,
                                18, 1, 4.6,   70.0,
                                19, 1, 0.0,  196.0,
                                20, 1, 1.7,   69.0,
                                21, 1, 5.2,  370.0,
                                22, 1, 0.0,  270.0,
                                23, 1, 5.0,  150.0,
                                24, 1, 9.5,   60.0,
                                25, 1, 2.0,  330.0,
                                26, 1, 3.0, 1100.0,
                                27, 1, 1.0,   40.0,
                                28, 1, 3.5,  100.0,
                                29, 1, 2.0,   70.0,
                                30, 1, 5.0,  150.0,
                                31, 1, 5.5,  200.0,
                                32, 1, 2.0,  304.0,
                                33, 1, 3.0,  236.0,
                                34, 1, 4.0,  178.0,
                                35, 1, 0.0,   41.0,
                                36, 1, 2.0,  120.0,
                                37, 1, 2.2,  330.0,
                                38, 1, 0.0,   62.0,
                                39, 1, 2.0,   12.8),
                               nrow = 39, ncol = 4, byrow = TRUE))
  colnames(mercury) &lt;- c("ID", "Tr", "Pct.cu.cells", "Hg.in.blood")
  
  (T_test &lt;- rank(mercury$Hg.in.blood) %*% mercury$Tr)
  (q_test &lt;- sort(rank(mercury$Hg.in.blood), decreasing = TRUE))
  (n_test &lt;- nrow(mercury))
  (m_test &lt;- sum(mercury$Tr))

  ## Note: since this function uses exact rather than approximate
  ## formulas for the mean and variance of T, the p-values it
  ## calculates do not precisely match those in Rosenbaum (2002).

  #A single Gamma value - example not run
  #testOut2 &lt;- SumTestSens(T = T_test,
  #                         q = q_test,
  #                         n = n_test,
  #                         m = m_test,
  #                         Gamma = 35)
 
  ## Apply to vector of Gamma values
  sapply(c(1, 5, 35), SumTestSens,
         T = T_test, q = q_test, n = n_test, m = m_test) 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
