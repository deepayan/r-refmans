<!DOCTYPE html><html lang="en"><head><title>Help for package TGST</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TGST}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cal.AUC'><p>Calculate AUC</p></a></li>
<li><a href='#Check.exp.tilt'><p>Check exponential tilt model assumption</p></a></li>
<li><a href='#CV.TGST'><p>Cross Validation</p></a></li>
<li><a href='#nonpar.fnr.fpr'><p>Nonparametric FNR FPR of the rules</p></a></li>
<li><a href='#nonpar.rules'><p>Nonparametric Rules Set</p></a></li>
<li><a href='#Opt.nonpar.rule'><p>Optimal Nonparametric Rule</p></a></li>
<li><a href='#Opt.semipar.rule'><p>Optimal Semiparametric Rule</p></a></li>
<li><a href='#OptimalRule'><p>Optimal Tripartite Rule</p></a></li>
<li><a href='#Output-class'><p>Constructor of Output class</p></a></li>
<li><a href='#plot'><p>plot function.</p></a></li>
<li><a href='#ROC.nonpar'><p>Nonparametric ROC Analysis</p></a></li>
<li><a href='#ROC.semipar'><p>Semiparametric ROC Analysis</p></a></li>
<li><a href='#ROCAnalysis'><p>ROC Analysis</p></a></li>
<li><a href='#Semi.par.rule'><p>Min TMR Semiparametric Rule</p></a></li>
<li><a href='#semipar.fnr.fpr'><p>Semiparametric FNR FPR of the rules</p></a></li>
<li><a href='#Simdata'>
<p>Simulated data for package illustration</p></a></li>
<li><a href='#summary'><p>summary function.</p></a></li>
<li><a href='#TGST'><p>Create a TGST Object</p></a></li>
<li><a href='#TGST-class'><p>Constructor of TGST class</p></a></li>
<li><a href='#TGST.summ'><p>Summary of Disease Status and Risk Score</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Targeted Gold Standard Testing</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for implementing the targeted gold standard (GS) testing. You provide the true disease or treatment failure status and the risk score, tell 'TGST' the availability of GS tests and which method to use, and it returns the optimal tripartite rules. Please refer to Liu et al. (2013) &lt;<a href="https://doi.org/10.1080%2F01621459.2013.810149">doi:10.1080/01621459.2013.810149</a>&gt; for more details.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, methods, graphics, knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-20 22:12:32 UTC; yizhenxu</td>
</tr>
<tr>
<td>Author:</td>
<td>Yizhen Xu [aut, cre],
  Tao Liu [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yizhen Xu &lt;yizhen_xu@alumni.brown.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-23 09:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='cal.AUC'>Calculate AUC</h2><span id='topic+cal.AUC'></span>

<h3>Description</h3>

<p>This function gives you the AUC associated with the rules set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cal.AUC(Z, S, l, u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cal.AUC_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="cal.AUC_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
<tr><td><code id="cal.AUC_+3A_l">l</code></td>
<td>
<p>Lower cutoff of all possible tripartite rules.</p>
</td></tr>
<tr><td><code id="cal.AUC_+3A_u">u</code></td>
<td>
<p>Upper cutoff of all possible tripartite rules.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AUC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
rules = nonpar.rules( Z, S, phi)
cal.AUC(Z,S,rules[,1],rules[,2])
</code></pre>

<hr>
<h2 id='Check.exp.tilt'>Check exponential tilt model assumption</h2><span id='topic+Check.exp.tilt'></span>

<h3>Description</h3>

<p>This function provides graphical assessment to the suitability of the exponential tilt model for risk score in finding optimal tripartite rules by semiparametric approach. 
</p>
<p style="text-align: center;"><code class="reqn">g1(s)=exp(\tilde{\beta}_{0}+\beta_{1}*s)*g0(s)</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>Check.exp.tilt(Z, S)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Check.exp.tilt_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="Check.exp.tilt_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of empirical density for risk score S, joint empirical density for (S,Z=1) and (S,Z=0), and the density under the exponential tilt model assumption for (S,Z=1) and (S,Z=0).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
Check.exp.tilt( Z, S)
</code></pre>

<hr>
<h2 id='CV.TGST'>Cross Validation</h2><span id='topic+CV.TGST'></span>

<h3>Description</h3>

<p>This function allows you to compute the average of misdiagnoses rate for viral failure and the optimal risk under min-<code class="reqn">\lambda</code> rules
from K-fold cross-validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CV.TGST(Obj, lambda, K = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CV.TGST_+3A_obj">Obj</code></td>
<td>
<p>An object of class TGST.</p>
</td></tr>
<tr><td><code id="CV.TGST_+3A_lambda">lambda</code></td>
<td>
<p>A user-specified weight that reflects relative loss for the two types of misdiagnoses, taking value in <code class="reqn">[0,1]</code>. <code class="reqn">Loss=\lambda*I(FN)+(1-\lambda)*I(FP)</code>.</p>
</td></tr>
<tr><td><code id="CV.TGST_+3A_k">K</code></td>
<td>
<p>Number of folds in cross validation. The default is 10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cross-validation results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
Obj = TGST(Z, S, phi, method="nonpar")
lambda = 0.8
CV.TGST(Obj, lambda, K=10)
</code></pre>

<hr>
<h2 id='nonpar.fnr.fpr'>Nonparametric FNR FPR of the rules</h2><span id='topic+nonpar.fnr.fpr'></span>

<h3>Description</h3>

<p>This function gives you the nonparametric FNR and FPR associated with a given tripartite rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nonpar.fnr.fpr(Z, S, l, u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nonpar.fnr.fpr_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="nonpar.fnr.fpr_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
<tr><td><code id="nonpar.fnr.fpr_+3A_l">l</code></td>
<td>
<p>Lower cutoff of tripartite rule.</p>
</td></tr>
<tr><td><code id="nonpar.fnr.fpr_+3A_u">u</code></td>
<td>
<p>Upper cutoff of tripartite rule.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with 2 columns. Each row is a set of nonparametric (FNR, FPR) on an associated tripartite rule.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
rules = nonpar.rules( Z, S, phi)
nonpar.fnr.fpr(Z,S,rules[1,1],rules[1,2])
</code></pre>

<hr>
<h2 id='nonpar.rules'>Nonparametric Rules Set</h2><span id='topic+nonpar.rules'></span>

<h3>Description</h3>

<p>This function gives you all possible cutoffs <code class="reqn">[l,u]</code> for tripartite rules, by applying nonparametric search to the given data. 
</p>
<p style="text-align: center;"><code class="reqn">P(S in [l,u]) \le \phi</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>nonpar.rules(Z, S, phi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nonpar.rules_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="nonpar.rules_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
<tr><td><code id="nonpar.rules_+3A_phi">phi</code></td>
<td>
<p>Percentage of patients taking viral load test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with 2 columns. Each row is a possible tripartite rule, with output on lower and upper cutoff.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
nonpar.rules( Z, S, phi)
</code></pre>

<hr>
<h2 id='Opt.nonpar.rule'>Optimal Nonparametric Rule</h2><span id='topic+Opt.nonpar.rule'></span>

<h3>Description</h3>

<p>This function gives you the optimal nonparametric tripartite rule that minimizes the min-<code class="reqn">\lambda</code> rules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Opt.nonpar.rule(Z, S, phi, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Opt.nonpar.rule_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="Opt.nonpar.rule_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
<tr><td><code id="Opt.nonpar.rule_+3A_phi">phi</code></td>
<td>
<p>Percentage of patients taking viral load test.</p>
</td></tr>
<tr><td><code id="Opt.nonpar.rule_+3A_lambda">lambda</code></td>
<td>
<p>A user-specified weight that reflects relative loss for the two types of misdiagnoses, taking value in <code class="reqn">[0,1]</code>. <code class="reqn">Loss=\lambda*I(FN)+(1-\lambda)*I(FP)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Optimal nonparametric rule and its associated misclassification rates (FNR, FPR), optimal lambda risk, and total misclassification rate (TMR).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
lambda = 0.5
Opt.nonpar.rule( Z, S, phi, lambda)
</code></pre>

<hr>
<h2 id='Opt.semipar.rule'>Optimal Semiparametric Rule</h2><span id='topic+Opt.semipar.rule'></span>

<h3>Description</h3>

<p>This function gives you the optimal semiparametric tripartite rule that minimizes the min-<code class="reqn">\lambda</code> rules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Opt.semipar.rule(Z, S, phi, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Opt.semipar.rule_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="Opt.semipar.rule_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
<tr><td><code id="Opt.semipar.rule_+3A_phi">phi</code></td>
<td>
<p>Percentage of patients taking viral load test.</p>
</td></tr>
<tr><td><code id="Opt.semipar.rule_+3A_lambda">lambda</code></td>
<td>
<p>A user-specified weight that reflects relative loss for the two types of misdiagnoses, taking value in <code class="reqn">[0,1]</code>. <code class="reqn">Loss=\lambda*I(FN)+(1-\lambda)*I(FP)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Optimal semiparametric rule and its associated misclassification rates (FNR, FPR), optimal lambda risk, and total misclassification rate (TMR).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
lambda = 0.5
Opt.semipar.rule( Z, S, phi, lambda)
</code></pre>

<hr>
<h2 id='OptimalRule'>Optimal Tripartite Rule</h2><span id='topic+OptimalRule'></span>

<h3>Description</h3>

<p><code>OptimalRule</code> is the main function of <code>TGST</code> and it gives you the optimal tripartite rule that minimizes the min-<code class="reqn">\lambda</code> risk based on the type of user selected approach. 
The function takes the risk score and true disease status from a training data set and returns the optimal tripartite rule under the specified proportion of patients able to take gold standard test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OptimalRule(Obj, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OptimalRule_+3A_obj">Obj</code></td>
<td>
<p>An object of class TGST.</p>
</td></tr>
<tr><td><code id="OptimalRule_+3A_lambda">lambda</code></td>
<td>
<p>A user-specified weight that reflects relative loss for the two types of misdiagnoses, taking value in <code class="reqn">[0,1]</code>. <code class="reqn">Loss=\lambda*I(FN)+(1-\lambda)*I(FP)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Optimal tripartite rule.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
lambda = 0.5
Obj = TGST(Z, S, phi, method="nonpar")
OptimalRule(Obj, lambda)
</code></pre>

<hr>
<h2 id='Output-class'>Constructor of Output class</h2><span id='topic+Output-class'></span>

<h3>Description</h3>

<p>This class contains invisible results of OptimalRule function.
</p>


<h3>Details</h3>


<dl>
<dt>phi</dt><dd><p>Percentage of patients taking viral load test.</p>
</dd>
<dt>Z</dt><dd><p>A vector of true disease status (Failure Status coded as Z=1).</p>
</dd>
<dt>S</dt><dd><p>A vector of risk Score.</p>
</dd>
<dt>Rules</dt><dd><p>A matrix of all possible tripartite rules (two cutoffs) derived from the training data set.</p>
</dd>
<dt>Nonparametric</dt><dd><p>A boolean indicating if nonparametric approach should be used in calculating the misclassfication rates. If FALSE, semiparametric approach would be used.</p>
</dd>
<dt>FNR.FPR</dt><dd><p>A matrix with two columns of misclassification rates, FNR and FPR.</p>
</dd>
<dt>OptRule</dt><dd><p>A numeric vector with two elements, the lower and upper cutoffs of the optimal tripartite rule.</p>
</dd>
</dl>

<p>The Output class adds optimal rule to the TGST class.
</p>

<hr>
<h2 id='plot'>plot function.</h2><span id='topic+plot'></span><span id='topic+plot+2CTGST-method'></span><span id='topic+plot+2COutput-method'></span>

<h3>Description</h3>

<p>This function This function gives visualize object of class <code>TGST</code> or <code>Output</code>.
</p>
<p>This function This function gives visualize object of class <code>TGST</code> or <code>Output</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'TGST'
plot(x)

## S4 method for signature 'Output'
plot(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>Output object from <code><a href="#topic+TGST-class">TGST</a></code> or <code><a href="#topic+Output-class">Output</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Distribution plot.
</p>
<p>Distribution plot.
</p>

<hr>
<h2 id='ROC.nonpar'>Nonparametric ROC Analysis</h2><span id='topic+ROC.nonpar'></span>

<h3>Description</h3>

<p>This function performs ROC analysis for tripartite rules by nonparametric approach. If <code class="reqn">plot=TRUE</code>, the ROC curve is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROC.nonpar(Z, S, phi, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ROC.nonpar_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="ROC.nonpar_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
<tr><td><code id="ROC.nonpar_+3A_phi">phi</code></td>
<td>
<p>Percentage of patients taking viral load test.</p>
</td></tr>
<tr><td><code id="ROC.nonpar_+3A_plot">plot</code></td>
<td>
<p>Logical parameter indicating if ROC curve should be plotted. Default is <code>plot=TRUE</code>. If false, then only AUC is calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AUC The area under the ROC curve.
FNR Misdiagnoses rate for viral failure (false negative rate).
FPR Misdiagnoses rate for treatment failure (false positive rate).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
a = ROC.nonpar( Z, S, phi,plot=TRUE)
a$AUC
a$FNR
a$FPR
</code></pre>

<hr>
<h2 id='ROC.semipar'>Semiparametric ROC Analysis</h2><span id='topic+ROC.semipar'></span>

<h3>Description</h3>

<p>This function performs ROC analysis on the rules from nonparametric approach. If <code class="reqn">plot=TRUE</code>, the ROC curve is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROC.semipar(Z, S, phi, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ROC.semipar_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="ROC.semipar_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
<tr><td><code id="ROC.semipar_+3A_phi">phi</code></td>
<td>
<p>Percentage of patients taking viral load test.</p>
</td></tr>
<tr><td><code id="ROC.semipar_+3A_plot">plot</code></td>
<td>
<p>Logical parameter indicating if ROC curve should be plotted. Default is <code>plot=TRUE</code>. If false, then only AUC is calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AUC The area under the ROC curve.
FNR Misdiagnoses rate for viral failure (false negative rate).
FPR Misdiagnoses rate for treatment failure (false positive rate).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
a = ROC.semipar( Z, S, phi,plot=TRUE)
a$AUC
a$FNR
a$FPR
</code></pre>

<hr>
<h2 id='ROCAnalysis'>ROC Analysis</h2><span id='topic+ROCAnalysis'></span>

<h3>Description</h3>

<p>This function performs ROC analysis for tripartite rules. If <code class="reqn">plot=TRUE</code>, the ROC curve is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROCAnalysis(Obj, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ROCAnalysis_+3A_obj">Obj</code></td>
<td>
<p>An object of class TGST.</p>
</td></tr>
<tr><td><code id="ROCAnalysis_+3A_plot">plot</code></td>
<td>
<p>Logical parameter indicating if ROC curve should be plotted. Default is <code>plot=TRUE</code>. If false, then only AUC is calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AUC (the area under ROC curve) and ROC curve.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
lambda = 0.5
Obj = TGST(Z, S, phi, method="nonpar")
ROCAnalysis(Obj, plot=TRUE)
</code></pre>

<hr>
<h2 id='Semi.par.rule'>Min TMR Semiparametric Rule</h2><span id='topic+Semi.par.rule'></span>

<h3>Description</h3>

<p>This function gives you the optimal semiparametric tripartite rule that minimizes TMR (total misclassification risk).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Semi.par.rule(Z, S, phi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Semi.par.rule_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="Semi.par.rule_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
<tr><td><code id="Semi.par.rule_+3A_phi">phi</code></td>
<td>
<p>Percentage of patients taking viral load test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Semiparametric rule and its associated TMR.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
Semi.par.rule( Z, S, phi)
</code></pre>

<hr>
<h2 id='semipar.fnr.fpr'>Semiparametric FNR FPR of the rules</h2><span id='topic+semipar.fnr.fpr'></span>

<h3>Description</h3>

<p>This function gives you the semiparametric FNR and FPR associated with a given tripartite rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semipar.fnr.fpr(Z, S, l, u)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="semipar.fnr.fpr_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="semipar.fnr.fpr_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
<tr><td><code id="semipar.fnr.fpr_+3A_l">l</code></td>
<td>
<p>Lower cutoff of tripartite rule.</p>
</td></tr>
<tr><td><code id="semipar.fnr.fpr_+3A_u">u</code></td>
<td>
<p>Upper cutoff of tripartite rule.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with 2 columns. Each row is a set of semiparametric (FNR, FPR) on an associated tripartite rule.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
rules = nonpar.rules( Z, S, phi)
semipar.fnr.fpr(Z,S,rules[1,1],rules[1,2])
</code></pre>

<hr>
<h2 id='Simdata'>
Simulated data for package illustration
</h2><span id='topic+Simdata'></span>

<h3>Description</h3>

<p>A simulated dataset containing true disease status and risk score. See details for simulation setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Simdata)</code></pre>


<h3>Format</h3>

<p>A data frame with 8000 simulated observations on the following 2 variables.
</p>

<dl>
<dt><code>Z</code></dt><dd><p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</dd>
<dt><code>S</code></dt><dd><p>Risk score. Higher risk score indicates larger tendency of diseased / treatment failure.</p>
</dd>
</dl>



<h3>Details</h3>

<p>We first simulate viral status <code class="reqn">Z</code> assuming <code class="reqn">Z\sim Bernoulli(p)</code> with <code class="reqn">p=0.25</code>; and then conditional on <code class="reqn">Z</code>, simulate <code class="reqn">{S|Z=z}=ceiling(W)</code> with <code class="reqn">W\sim Gamma(\eta_z,\kappa_z)</code> where <code class="reqn">\eta</code> and <code class="reqn">\kappa</code> are shape and scale parameters.<code class="reqn">(\eta0,\kappa0)=(2.3,80)</code> and <code class="reqn">(\eta1,\kappa1)=(9.2,62)</code>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Simdata)
## maybe str(Simdata) ; plot(Simdata) ...
</code></pre>

<hr>
<h2 id='summary'>summary function.</h2><span id='topic+summary'></span><span id='topic+summary+2CTGST-method'></span>

<h3>Description</h3>

<p>This function gives the summary of the data from <code>TGST</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'TGST'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>Output object from <code><a href="#topic+TGST">TGST</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Percentage of treatment failure; 
Summary statistics (mean, standard deviation, minimum, median, maximum and IQR) of risk score by true disease status; 
Distribution plot.
</p>

<hr>
<h2 id='TGST'>Create a TGST Object</h2><span id='topic+TGST'></span>

<h3>Description</h3>

<p>Create a TGST object, usually used as an input for optimal rule search and ROC analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TGST(Z, S, phi, method = "nonpar")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TGST_+3A_z">Z</code></td>
<td>
<p>A vector of true disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="TGST_+3A_s">S</code></td>
<td>
<p>A vector of risk Score.</p>
</td></tr>
<tr><td><code id="TGST_+3A_phi">phi</code></td>
<td>
<p>Percentage of patients taking gold standard test.</p>
</td></tr>
<tr><td><code id="TGST_+3A_method">method</code></td>
<td>
<p>Method for searching for the optimal tripartite rule, options are &quot;nonpar&quot; (default) and &quot;semipar&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>TGST</code>.The class contains 6 slots: phi (percentage of gold standard tests), Z (true failure status), S (risk score), Rules (all possible tripartite rules), Nonparametric (logical indicator of the approach), and FNR.FPR (misclassification rates).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
phi = 0.1 #10% of patients taking viral load test
TGST( Z, S, phi, method="nonpar")

</code></pre>

<hr>
<h2 id='TGST-class'>Constructor of TGST class</h2><span id='topic+TGST-class'></span>

<h3>Description</h3>

<p>This class contains results of a run to search for all possible rules.
</p>


<h3>Details</h3>


<dl>
<dt>phi</dt><dd><p>Percentage of patients taking viral load test.</p>
</dd>
<dt>Z</dt><dd><p>A vector of true disease status (Failure Status coded as Z=1).</p>
</dd>
<dt>S</dt><dd><p>A vector of risk Score.</p>
</dd>
<dt>Rules</dt><dd><p>A matrix of all possible tripartite rules (two cutoffs) derived from the training data set.</p>
</dd>
<dt>Nonparametric</dt><dd><p>A boolean indicating if nonparametric approach should be used in calculating the misclassfication rates. If FALSE, semiparametric approach would be used.</p>
</dd>
<dt>FNR.FPR</dt><dd><p>A matrix with two columns of misclassification rates, FNR and FPR.</p>
</dd>
</dl>

<p>If res is the result of rankclust(), each slot of results can be reached by res[k]@slotname, where
k is the number of clusters and slotname is the name of the slot we want to reach (see <a href="#topic+Output-class">Output-class</a>).
For the slots ll, bic, icl, res[&quot;slotname&quot;] returns a vector of size K containing the values of the
slot for each number of clusters.
</p>

<hr>
<h2 id='TGST.summ'>Summary of Disease Status and Risk Score</h2><span id='topic+TGST.summ'></span>

<h3>Description</h3>

<p>This function allows you to compute the percentage of diseased (equivalent to treatment failure Z=1) and show distribution summary of risk score (S) by the true disease status (Z).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TGST.summ(Z, S)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TGST.summ_+3A_z">Z</code></td>
<td>
<p>True disease status (No disease / treatment success coded as Z=0, diseased / treatment failure coded as Z=1).</p>
</td></tr>
<tr><td><code id="TGST.summ_+3A_s">S</code></td>
<td>
<p>Risk score.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Percentage of treatment failure; 
Summary statistics (mean, standard deviation, minimum, median, maximum and IQR) of risk score by true disease status; 
Distribution plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = Simdata
Z = d$Z # True Disease Status
S = d$S # Risk Score
TGST.summ(Z,S)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
