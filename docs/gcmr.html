<!DOCTYPE html><html lang="en"><head><title>Help for package gcmr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gcmr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gcmr-package'>
<p>Gaussian Copula Marginal Regression</p></a></li>
<li><a href='#arma.cormat'>
<p>ARMA(p,q) Correlation</p></a></li>
<li><a href='#cluster.cormat'>
<p>Longitudinal/Clustered Data Correlation</p></a></li>
<li><a href='#cormat.gcmr'><p>Correlation Matrices for Gaussian Copula Regression Models</p></a></li>
<li><a href='#epilepsy'>
<p>Epilitic Seizures Data</p></a></li>
<li><a href='#gaussian.marg'>
<p>Marginals in Gaussian Copula Marginal Regression Models</p></a></li>
<li><a href='#gcmr'>
<p>Fitting Gaussian Copula Marginal Regression Models by Maximum (Simulated) Likelihood.</p></a></li>
<li><a href='#gcmr.options'>
<p>Setting Options for Fitting Gaussian Copula Marginal Regression Models</p></a></li>
<li><a href='#HUR'>
<p>Hidden Unemployment in Sao Paulo</p></a></li>
<li><a href='#ind.cormat'>
<p>Working Independence Correlation</p></a></li>
<li><a href='#malaria'>
<p>Gambia Malaria Data</p></a></li>
<li><a href='#marginal.gcmr'><p>Marginals for Gaussian Copula Marginal Regression</p></a></li>
<li><a href='#matern.cormat'>
<p>Matern Spatial Correlation</p></a></li>
<li><a href='#plot.gcmr'><p>Plot Diagnostics for Gaussian Copula Marginal Regression</p></a></li>
<li><a href='#polio'>
<p>Polio Time Series</p></a></li>
<li><a href='#profile.gcmr'>
<p>Profile Log-Likelihood for Gaussian Copula Marginal Regression Models</p></a></li>
<li><a href='#residuals.gcmr'><p>Quantile Residuals for Gaussian Copula Marginal Regression</p></a></li>
<li><a href='#scotland'>
<p>Scotland Lip Cancer Data</p></a></li>
<li><a href='#summary.gcmr'><p>Methods for gcmr Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Priority:</td>
<td>optional</td>
</tr>
<tr>
<td>Title:</td>
<td>Gaussian Copula Marginal Regression</td>
</tr>
<tr>
<td>Author:</td>
<td>Guido Masarotto and Cristiano Varin</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cristiano Varin &lt;cristiano.varin@unive.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Likelihood inference in Gaussian copula marginal
        regression models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, stats, utils, betareg, car, Formula,
lmtest, nlme, sandwich, sp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-17 21:41:25 UTC; cristianovarin</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-18 07:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='gcmr-package'>
Gaussian Copula Marginal Regression
</h2><span id='topic+gcmr-package'></span>

<h3>Description</h3>

<p>Fits Gaussian copula marginal regression models described in Song (2000) and Masarotto and Varin (2012; 2017). 
</p>


<h3>Details</h3>

<p>Gaussian copula models are frequently used to extend univariate regression models to the multivariate case. The principal merit of the approach is that the specification of the regression model is conveniently separated from the dependence structure described in the familiar form of the correlation matrix of a multivariate Gaussian distribution (Song 2000). This form of flexibility has been successfully employed in several complex applications including longitudinal data analysis, spatial statistics, genetics and time series. Some useful references can be found in Masarotto and Varin (2012; 2017) and Song et al. (2013). 
</p>
<p>This package contains <span class="rlang"><b>R</b></span> functions that implement the methodology discussed in Masarotto and Varin (2012) and Guolo and Varin (2014). The main function is <code><a href="#topic+gcmr">gcmr</a></code>, which fits Gaussian copula marginal regression models. Inference is performed through a likelihood approach. Computation of the exact likelihood is possible only for continuous responses, otherwise the likelihood function is approximated by importance sampling. See Masarotto and Varin (2017) for details.
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Guolo, A. and Varin, C. (2014). Beta regression for time series analysis of bounded data, with application to Canada Google Flu Trends. <em>The Annals of Applied Statistics</em> <b>8</b>, 74&ndash;88.
</p>
<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>
<p>Song, P. X.-K. (2000). Multivariate dispersion models generated from Gaussian copula. <em>Scandinavian Journal of Statistics</em> <b>27</b>, 305&ndash;320.
</p>
<p>Song, P. X.-K., Li, M. and Zhang, P. (2013). Copulae in Mathematical and Quantitative Finance. In <em>Vector Generalized Linear Models: A Gaussian Copula Approach</em>, 251&ndash;276. Springer Berlin Heidelberg.
</p>

<hr>
<h2 id='arma.cormat'>
ARMA(p,q) Correlation 
</h2><span id='topic+arma.cormat'></span>

<h3>Description</h3>

<p>Sets ARMA(p,q) correlation in Gaussian copula regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arma.cormat(p, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arma.cormat_+3A_p">p</code></td>
<td>

<p>order of the autoregressive component.
</p>
</td></tr>
<tr><td><code id="arma.cormat_+3A_q">q</code></td>
<td>

<p>order of the moving average component.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+cormat.gcmr">cormat.gcmr</a></code> representing a correlation matrix with ARMA(p,q) structure.
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>.
</p>

<hr>
<h2 id='cluster.cormat'>
Longitudinal/Clustered Data Correlation
</h2><span id='topic+cluster.cormat'></span>

<h3>Description</h3>

<p>Sets longitudinal/clustered data correlation in Gaussian copula regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster.cormat(id, type = c("independence", "ar1", "ma1", 
		   	    "exchangeable", "unstructured"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster.cormat_+3A_id">id</code></td>
<td>

<p>subject id. This is a vector of the same lenght of the number of observations. Please note that data must be
sorted in way that observations from the same cluster are contiguous.
</p>
</td></tr>
<tr><td><code id="cluster.cormat_+3A_type">type</code></td>
<td>

<p>a character string specifying the correlation structure. At the moment, the following are implemented: 
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>independence</code> </td><td style="text-align: left;"> working independence. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ar1</code> </td><td style="text-align: left;"> autoregressive of order 1. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>ma1</code> </td><td style="text-align: left;"> moving average of order 1. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>exchangeable</code> </td><td style="text-align: left;"> exchangeable. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>unstructured</code> </td><td style="text-align: left;"> unstructured.
</td>
</tr>

</table>

</td></tr>
</table>


<h3>Details</h3>

<p>The correlation matrices are inherited from the <code><a href="nlme.html#topic+nlme">nlme</a></code> package (Pinheiro and Bates, 2000).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+cormat.gcmr">cormat.gcmr</a></code> representing a correlation matrix for longitudinal or clustered data.
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549.
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26.
</p>
<p>Pinheiro, J.C. and Bates, D.M. (2000). <em>Mixed-Effects Models in S and S-PLUS</em>. Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>, <code><a href="nlme.html#topic+nlme">nlme</a></code>.
</p>

<hr>
<h2 id='cormat.gcmr'>Correlation Matrices for Gaussian Copula Regression Models</h2><span id='topic+cormat.gcmr'></span>

<h3>Description</h3>

<p>Class of correlation matrices available in the <code><a href="#topic+gcmr">gcmr</a></code> package. 
</p>


<h3>Value</h3>

<p>At the moment, the following are implemented:
</p>

<table>
<tr>
 <td style="text-align: left;"> 
<code><a href="#topic+ind.cormat">ind.cormat</a></code> </td><td style="text-align: left;"> working independence. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+arma.cormat">arma.cormat</a></code> </td><td style="text-align: left;"> ARMA(p,q). </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code><a href="#topic+cluster.cormat">cluster.cormat</a></code> </td><td style="text-align: left;"> longitudinal/clustered data. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+matern.cormat">matern.cormat</a></code> </td><td style="text-align: left;">  Matern spatial correlation. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>,
<code><a href="#topic+ind.cormat">ind.cormat</a></code>,
<code><a href="#topic+arma.cormat">arma.cormat</a></code>,
<code><a href="#topic+cluster.cormat">cluster.cormat</a></code>, 
<code><a href="#topic+matern.cormat">matern.cormat</a></code>.
</p>

<hr>
<h2 id='epilepsy'>
Epilitic Seizures Data
</h2><span id='topic+epilepsy'></span>

<h3>Description</h3>

<p>Longitudinal study on epilitic seizures (Thall and Vail, 1990; Diggle et al. 2002). The data consist into 59 individuals with five observations each: The baseline eight-week interval and measurements collected at subsequent visits every two-week.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(epilepsy)</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
<code>id</code> </td><td style="text-align: left;"> patient's id . </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>age</code> </td><td style="text-align: left;"> patient's age. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>trt</code> </td><td style="text-align: left;"> indicator if the patient is treated with progabide (<code>1</code>) or with placebo (<code>2</code>). </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>counts</code> </td><td style="text-align: left;"> number of epileptic seizures. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>time</code> </td><td style="text-align: left;"> observation period in weeks (<code>8</code> for baseline and <code>2</code> for subsequent visits). </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>visit</code> </td><td style="text-align: left;"> indicator if observation at baseline (<code>0</code>) or subsequent visit (<code>1</code>). </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Source</h3>

<p>Thall, P.F. and Vail S.C. (1990). Some covariance models for longitudinal count data with overdispersion. <em>Biometrics</em> <b>46</b>, 657&ndash;671.
</p>


<h3>References</h3>

<p>Diggle, P.J., Heagerty, P., Liang, K.Y. and Zeger, S.L. (2002). <em>Analysis of Longitudinal Data</em>. Oxford: Oxford University Press. Second edition.
</p>

<hr>
<h2 id='gaussian.marg'>
Marginals in Gaussian Copula Marginal Regression Models 
</h2><span id='topic+gaussian.marg'></span><span id='topic+beta.marg'></span><span id='topic+binomial.marg'></span><span id='topic+poisson.marg'></span><span id='topic+negbin.marg'></span><span id='topic+Gamma.marg'></span><span id='topic+weibull.marg'></span><span id='topic+gs.marg'></span><span id='topic+bn.marg'></span><span id='topic+ps.marg'></span><span id='topic+nb.marg'></span>

<h3>Description</h3>

<p>These functions set the marginals in Gaussian copula marginal regression models. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta.marg(link = "logit")
binomial.marg(link = "logit")
Gamma.marg(link = "inverse")
gaussian.marg(link = "identity")
negbin.marg(link = "log")
poisson.marg(link = "log")
weibull.marg(link = "log")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gaussian.marg_+3A_link">link</code></td>
<td>

<p>a specification for the model link function. See <code><a href="stats.html#topic+family">family</a></code> for the special case of generalized linear models. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Beta marginals specified by <code>beta.marg</code> are parametrized in terms of mean and dispersion as in <code>betareg</code>. See Cribari-Neto and Zeileis (2010) and Ferrari and Cribari-Neto (2004). 
</p>
<p>For binomial marginals specified by <code>binomial.marg</code>, the response is specified as a factor when the first level denotes failure and all others success or as a two-column matrix with the columns giving the numbers of successes and failures.
</p>
<p>Negative binomial marginals implemented in <code>negbin.marg</code> are parametrized such that <code class="reqn">var(Y)=E(Y)+k E(Y)^2</code>. 
</p>
<p>For back-compatibility with previous versions of the <code>gcmr</code> package, short names for the marginals <code>bn.marg</code>, <code>gs.marg</code>, <code>nb.marg</code>, and <code>ps.marg</code> remain valid as an alternative to (preferred) longer versions <code>binomial.marg</code>,  <code>gaussian.marg</code>, <code>negbin.marg</code>, and <code>poisson.marg</code>.
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+marginal.gcmr">marginal.gcmr</a></code> representing the marginal component. 
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Cribari-Neto, F. and Zeileis, A. (2010). Beta regression in R. <em>Journal of Statistical Software</em> <b>34</b>, 1&ndash;24. 
</p>
<p>Ferrari, S.L.P. and Cribari-Neto, F. (2004). Beta regression for modeling rates and proportions. <em>Journal of Applied Statistics</em> <b>31</b> (7), 799&ndash;815.
</p>
<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>, <code>betareg</code>.
</p>

<hr>
<h2 id='gcmr'>
Fitting Gaussian Copula Marginal Regression Models by Maximum (Simulated) Likelihood.
</h2><span id='topic+gcmr'></span><span id='topic+gcmr.fit'></span>

<h3>Description</h3>

<p>Fits Gaussian copula marginal regression models by maximum (simulated) likelihood.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gcmr(formula, data, subset, offset, marginal,
     cormat, start, fixed, options=gcmr.options(...), model=TRUE,...)

gcmr.fit(x=rep(1,NROW(y)), y, z=NULL, offset=NULL,
	 marginal, cormat, start, fixed, options=gcmr.options())		   
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gcmr_+3A_formula">formula</code></td>
<td>

<p>a symbolic description of the model to be fitted of type <code>y ~ x</code> or 
<code>y ~ x | z</code>, for details see below.
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_data">data</code></td>
<td>

<p>an optional data frame, list or environment (or object coercible by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a data frame) containing the variables in the model.  If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>.
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_subset">subset</code></td>
<td>

<p>an optional vector specifying a subset of observations to be used in the fitting process.
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_offset">offset</code></td>
<td>

<p>optional numeric vector with an a priori known component to be included in the linear predictor for the mean. When appropriate, offset may also be a list of two offsets for the mean and precision equation, respectively.
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_x">x</code></td>
<td>
<p>design matrix.
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_y">y</code></td>
<td>
<p>vector of observations.
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_z">z</code></td>
<td>
<p>optional design matrix for the dispersion/shape.
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_marginal">marginal</code></td>
<td>

<p>an object of class <code><a href="#topic+marginal.gcmr">marginal.gcmr</a></code> specifying the marginal part of the model. 
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_cormat">cormat</code></td>
<td>

<p>an object of class <code><a href="#topic+cormat.gcmr">cormat.gcmr</a></code> representing the correlation matrix of the errors. 
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_start">start</code></td>
<td>

<p>optional numeric vector with starting values for the model parameters.
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_fixed">fixed</code></td>
<td>

<p>optional numeric vector of the same length as the total number of parameters. If supplied, only <code>NA</code> entries in fixed will be varied. 
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_options">options</code></td>
<td>

<p>list of options passed to function <code><a href="#topic+gcmr.options">gcmr.options</a></code>.
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_model">model</code></td>
<td>

<p>logical. If <code>TRUE</code>, then the model frame is returned. 
</p>
</td></tr>
<tr><td><code id="gcmr_+3A_...">...</code></td>
<td>

<p>arguments passed to <code><a href="#topic+gcmr.options">gcmr.options</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code><a href="#topic+gcmr">gcmr</a></code> computes maximum likelihood estimation in Gaussian copula marginal regression models. Computation of the exact likelihood is possible only for continuous responses, otherwise the likelihood function is approximated by importance sampling. See Masarotto and Varin (2012; 2017) for details.
</p>
<p>Standard formula <code>y ~ x1 + x2</code> indicates that the mean response is modelled as a function of covariates <code>x1</code> and <code>x2</code> through an appropriate link function. Extended formula  <code>y ~ x1 + x2 | z1 + z2</code> indicates that the dispersion (or the shape) parameter of the marginal distribution is modelled as a function of covariates <code>z1</code> and <code>z2</code>. Dispersion (or shape) parameters are always modelled on logarithm scale. The model specification is inspired by beta regression as implemented in <code>betareg</code> (Cribari-Neto and Zeileis, 2010) through extended <code>Formula</code> objects (Zeileis and Croissant, 2010). 
</p>
<p>For binomial marginals specified by <code><a href="#topic+binomial.marg">binomial.marg</a></code> the response is specified as a factor when the first level denotes failure and all others success or as a two-column matrix with the columns giving the numbers of successes and failures. 
</p>
<p><code>gcmr.fit</code> is the workhorse function: it is not normally called directly but can be more efficient where the response vector and design matrix have already been calculated.
</p>


<h3>Value</h3>

<p>An object of class <code>"gcmr"</code> with the following components:
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p>the maximum likelihood estimate.</p>
</td></tr>
<tr><td><code>maximum</code></td>
<td>
<p>the maximum likelihood value.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>(minus) the Hessian at the maximum likelihood estimate.</p>
</td></tr>
<tr><td><code>jac</code></td>
<td>
<p>the Jacobian at the maximum likelihood estimate.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted values.</p>
</td></tr>
<tr><td><code>marginal</code></td>
<td>
<p>the marginal model used.</p>
</td></tr>
<tr><td><code>cormat</code></td>
<td>
<p>the correlation matrix used.</p>
</td></tr>
<tr><td><code>fixed</code></td>
<td>
<p>the numeric vector indicating which parameters are constants.</p>
</td></tr>
<tr><td><code>ibeta</code></td>
<td>
<p>the indices of marginal parameters.</p>
</td></tr>
<tr><td><code>igamma</code></td>
<td>
<p>the indices of dependence parameters.</p>
</td></tr>
<tr><td><code>nbeta</code></td>
<td>
<p>the number of marginal parameters.</p>
</td></tr>
<tr><td><code>ngamma</code></td>
<td>
<p>the number of dependence parameters.</p>
</td></tr>
<tr><td><code>options</code></td>
<td>
<p>the fitting options used, see <code><a href="#topic+gcmr.options">gcmr.options</a></code>.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the model formula.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the terms objects for the fitted model.</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p>the levels of the categorical regressors.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the model frame, returned only if <code>model=TRUE</code>.</p>
</td></tr>
<tr><td><code>contrasts</code></td>
<td>
<p>the contrasts corresponding to <code>levels</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the y vector used.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the model matrix used for the mean response.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>the (optional) model matrix used for the dispersion/shape.</p>
</td></tr>
<tr><td><code>offset</code></td>
<td>
<p>the offset used.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code>not.na</code></td>
<td>
<p>the vector of binary indicators of the available observations (not missing).</p>
</td></tr>
</table>
<p>Functions <code><a href="stats.html#topic+coefficients">coefficients</a></code>, <code><a href="stats.html#topic+logLik">logLik</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code>, <code><a href="#topic+vcov.gcmr">vcov.gcmr</a></code> and <code><a href="#topic+residuals.gcmr">residuals.gcmr</a></code> can be used to extract various useful features of the value returned by <code><a href="#topic+gcmr">gcmr</a></code>. Function <code><a href="#topic+plot.gcmr">plot.gcmr</a></code> produces various diagnostic plots for fitted <code>gcmr</code> objects.
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Cribari-Neto, F. and Zeileis, A. (2010). Beta regression in R. <em>Journal of Statistical Software</em> <b>34</b>, 1&ndash;24. 
</p>
<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>
<p>Rocha, A.V. and Cribari-Neto, F. (2009). Beta autoregressive moving average models. <em>Test</em> <b>18</b>, 529&ndash;545.
</p>
<p>Zeileis, A. and Croissant, Y. (2010). Extended model formulas in R: Multiple parts and multiple responses. <em>Journal of Statistical Software</em> <b>34</b>, 1&ndash;13. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cormat.gcmr">cormat.gcmr</a></code>, <code><a href="#topic+marginal.gcmr">marginal.gcmr</a></code>, <code><a href="#topic+gcmr.options">gcmr.options</a></code>, <code>Formula</code>, <code>betareg</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## negative binomial model for longitudinal data
data(epilepsy)
gcmr(counts ~ offset(log(time)) + visit + trt + visit:trt, data = epilepsy, 
subset = (id != 49), marginal = negbin.marg, cormat = cluster.cormat(id, "ar1"), 
options=gcmr.options(seed=123, nrep=100 ))
## Hidden Unemployment Rate (HUR) data (Rocha and Cribari-Neto, 2009)
## beta regression with ARMA(1,3) errors
data(HUR)
trend &lt;- scale(time(HUR))
gcmr(HUR ~ trend | trend, marginal = beta.marg, cormat = arma.cormat(1, 3))
</code></pre>

<hr>
<h2 id='gcmr.options'>
Setting Options for Fitting Gaussian Copula Marginal Regression Models
</h2><span id='topic+gcmr.options'></span>

<h3>Description</h3>

<p>Sets options that affect the fitting of Gaussian copula marginal regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gcmr.options(seed = round(runif(1, 1, 1e+05)), nrep = c(100, 1000), 
    no.se = FALSE, method = c("BFGS", "Nelder-Mead", "CG"), ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gcmr.options_+3A_seed">seed</code></td>
<td>

<p>seed of the pseudorandom generator used in the importance sampling algorithm  for likelihood approximation in case of discrete responses.
</p>
</td></tr>
<tr><td><code id="gcmr.options_+3A_nrep">nrep</code></td>
<td>

<p>Monte Carlo size of the importance sampling algorithm  for likelihood approximation in case of discrete responses. <code>nrep</code> can be a vector so that the model is fitted with a sequence of different Monte Carlo sizes. In this case, the starting values for optimization of the likelihood are taken from the previous fitting. A reasonable strategy is to fit the model with a small Monte Carlo size to obtain sensible starting values and then refit with a larger Monte Carlo size. The default value is <code>100</code> for the first optimization and <code>1000</code> for the second and definitive optimization. 
</p>
</td></tr>
<tr><td><code id="gcmr.options_+3A_no.se">no.se</code></td>
<td>

<p>logical. Should standard errors be computed and returned or not?
</p>
</td></tr>
<tr><td><code id="gcmr.options_+3A_method">method</code></td>
<td>

<p>a character string specifying the method argument passed to <code>optim</code>. The default optimization routine is the quasi-Newton algorithm <code>BFGS</code>. See <code><a href="stats.html#topic+optim">optim</a></code> for details. 
</p>
</td></tr>
<tr><td><code id="gcmr.options_+3A_...">...</code></td>
<td>

<p>arguments passed to <code><a href="stats.html#topic+optim">optim</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the options.
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin. 
</p>


<h3>References</h3>

<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>
</p>

<hr>
<h2 id='HUR'>
Hidden Unemployment in Sao Paulo
</h2><span id='topic+HUR'></span>

<h3>Description</h3>

<p>Rate of hidden unemployment due to substandard work conditions in Sao Paulo, Brazil (Rocha and Cribari-Neto, 2009). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HUR)</code></pre>


<h3>Source</h3>

<p>Institute of Applied Economic Research (Ipea), Brazil. Data obtained from the IPEAdata website <a href="http://www.ipeadata.gov.br">http://www.ipeadata.gov.br</a>.
</p>


<h3>References</h3>

<p>Rocha, A.V. and Cribari-Neto, F. (2009). Beta autoregressive moving average models. <em>Test</em> <b>18</b>, 529&ndash;545.
</p>

<hr>
<h2 id='ind.cormat'>
Working Independence Correlation
</h2><span id='topic+ind.cormat'></span>

<h3>Description</h3>

<p>Sets working independence correlation in Gaussian copula marginal regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ind.cormat()
</code></pre>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+cormat.gcmr">cormat.gcmr</a></code> representing an identity correlation matrix.
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>.
</p>

<hr>
<h2 id='malaria'>
Gambia Malaria Data
</h2><span id='topic+malaria'></span>

<h3>Description</h3>

<p>Malaria prevalence in children in Gambia. The data are constructed from the <code>gambia</code> dataframe in the <code>geoR</code> package (Diggle and Ribeiro, 2007) by village aggregation. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(malaria)</code></pre>


<h3>Format</h3>

<p>A data frame with the 65 observations with the following variables
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>x</code> </td><td style="text-align: left;"> x-coordinate of the village (UTM). </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>y</code> </td><td style="text-align: left;"> y-coordinate of the village (UTM). </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>cases</code> </td><td style="text-align: left;"> number of sampled children with malaria in each village. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>size</code> </td><td style="text-align: left;"> number of sampled children in each village. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>age</code> </td><td style="text-align: left;"> mean age of the sampled children in each village. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>netuse</code> </td><td style="text-align: left;"> frequency of sampled children who regularly sleep under a bed-net in each village. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>treated</code> </td><td style="text-align: left;"> frequency of sampled children whose bed-net is treated. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>green</code> </td><td style="text-align: left;"> measure of vegetation green-ness in the immediate vicinity of the village. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>phc</code> </td><td style="text-align: left;"> indicator variable denoting the presence (1) or absence (0) of a health center in the village. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>area</code> </td><td style="text-align: left;"> indicator of the village area (Diggle et al., 2002).</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Source</h3>

<p>Diggle, P.J. and Ribeiro Jr, P.J. (2007). <em>Model Based Geostatistics</em>. New York: Springer.
</p>


<h3>References</h3>

<p>Thomson, M., Connor, S., D Alessandro, U., Rowlingson, B., Diggle, P., Cresswell, M. and Greenwood, B. (1999). Predicting malaria infection in Gambian children from satellite data and bednet use surveys: the importance of spatial correlation in the interpretation of results. <em>American Journal of Tropical Medicine and Hygiene</em> <b>61</b>, 2&ndash;8.
</p>
<p>Diggle, P., Moyeed, R., Rowlingson, B. and Thomson, M. (2002). Childhood malaria in The Gambia: a case-study in model-based geostatistics, <em>Applied Statistics</em> <b>51</b>, 493&ndash;506.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(malaria)
</code></pre>

<hr>
<h2 id='marginal.gcmr'>Marginals for Gaussian Copula Marginal Regression</h2><span id='topic+marginal.gcmr'></span>

<h3>Description</h3>

<p>Class of marginals available in the <code>gcmr</code> library. 
</p>


<h3>Value</h3>

<p>At the moment, the following are implemented:
</p>

<table>
<tr>
 <td style="text-align: left;"> 

<code><a href="#topic+beta.marg">beta.marg</a></code> </td><td style="text-align: left;"> beta marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+binomial.marg">binomial.marg</a></code> </td><td style="text-align: left;"> binomial marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+Gamma.marg">Gamma.marg</a></code> </td><td style="text-align: left;"> Gamma marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+gaussian.marg">gaussian.marg</a></code> </td><td style="text-align: left;"> Gaussian marginals. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code><a href="#topic+negbin.marg">negbin.marg</a></code> </td><td style="text-align: left;"> negative binomial marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+poisson.marg">poisson.marg</a></code> </td><td style="text-align: left;"> Poisson marginals. </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code><a href="#topic+weibull.marg">weibull.marg</a></code> </td><td style="text-align: left;"> Weibull marginals. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>,
<code><a href="#topic+beta.marg">beta.marg</a></code>,		
<code><a href="#topic+binomial.marg">binomial.marg</a></code>,
<code><a href="#topic+gaussian.marg">gaussian.marg</a></code>,
<code><a href="#topic+Gamma.marg">Gamma.marg</a></code>,
<code><a href="#topic+negbin.marg">negbin.marg</a></code>,
<code><a href="#topic+poisson.marg">poisson.marg</a></code>,   
<code><a href="#topic+weibull.marg">weibull.marg</a></code>.
</p>

<hr>
<h2 id='matern.cormat'>
Matern Spatial Correlation
</h2><span id='topic+matern.cormat'></span>

<h3>Description</h3>

<p>Sets a Matern spatial correlation matrix in Gaussian copula marginal regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matern.cormat(D, alpha = 0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matern.cormat_+3A_d">D</code></td>
<td>

<p>matrix with values of the distances between pairs of data locations.
</p>
</td></tr>
<tr><td><code id="matern.cormat_+3A_alpha">alpha</code></td>
<td>

<p>value of the shape parameter of the Matern correlation class. The default alpha = 0.5 corresponds to an exponential correlation model. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mat\'ern correlation function is inherited from the <code>geoR</code> package (Diggle and Ribeiro, 2007).
</p>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+cormat.gcmr">cormat.gcmr</a></code> representing a Matern correlation matrix.
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Diggle, P. and Ribeiro, P.J. (2007). <em>Model-based Geostatistics</em>. Springer.
</p>
<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>.
</p>

<hr>
<h2 id='plot.gcmr'>Plot Diagnostics for Gaussian Copula Marginal Regression</h2><span id='topic+plot.gcmr'></span>

<h3>Description</h3>

<p>Various types of diagnostic plots for Gaussian copula regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gcmr'
plot(x, which = if (!time.series) 1:4 else c(1, 3, 5, 6), 
    caption = c("Residuals vs indices of obs.", "Residuals vs linear predictor", 
        "Normal plot of residuals", "Predicted vs observed values", 
        "Autocorrelation plot of residuals", "Partial ACF plot of residuals"), 
    	main = "", ask = prod(par("mfcol")) &lt; length(which) &amp;&amp; dev.interactive(), 
    	level = 0.95, col.lines = "gray",
	time.series = inherits(x$cormat, "arma.gcmr"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gcmr_+3A_x">x</code></td>
<td>
<p>a fitted model object of class <code><a href="#topic+gcmr">gcmr</a></code>.</p>
</td></tr>
<tr><td><code id="plot.gcmr_+3A_which">which</code></td>
<td>
<p>select one, or more, of the six available plots. The default choice adapts to the correlation structure and selects four plots depending on the fact that the data are a regular time series or not.</p>
</td></tr>
<tr><td><code id="plot.gcmr_+3A_caption">caption</code></td>
<td>
<p>captions to appear above the plots.</p>
</td></tr>
<tr><td><code id="plot.gcmr_+3A_main">main</code></td>
<td>
<p>title to each plot in addition to the above caption.</p>
</td></tr>
<tr><td><code id="plot.gcmr_+3A_ask">ask</code></td>
<td>
<p>if <code>TRUE</code>, then the user is asked before each plot.</p>
</td></tr>
<tr><td><code id="plot.gcmr_+3A_level">level</code></td>
<td>
<p>confidence level in the normal probability plot. The default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="plot.gcmr_+3A_col.lines">col.lines</code></td>
<td>
<p>color for lines. The default is <code>"gray"</code>.</p>
</td></tr>
<tr><td><code id="plot.gcmr_+3A_time.series">time.series</code></td>
<td>
<p>if <code>TRUE</code>, four plots suitable for time series data are displayed. The default is <code>TRUE</code> when the correlation matrix corresponds to that of ARMA(p,q) process and <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="plot.gcmr_+3A_...">...</code></td>
<td>
<p>other parameters to be passed through to plotting functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot method for <code><a href="#topic+gcmr">gcmr</a></code> objects produces six types of diagnostic plots selectable through the <code>which</code> argument. Available choices are: Quantile residuals vs indices of the observations (<code>which=1</code>); Quantile residuals vs linear predictor (<code>which=2</code>); Normal probability plot of quantile residuals (<code>which=3</code>); Fitted vs observed values (<code>which=4</code>); Autocorrelation plot of quantile residuals (<code>which=5</code>); Partial autocorrelation plot of quantile residuals (<code>which=6</code>). The latter two plots make sense for regular time series data only.
</p>
<p>The normal probability plot is computed via function <code>qqPlot</code> from the package <code>car</code> (Fox and Weisberg, 2011).
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Fox, J. and Weisberg, S. (2011). <em>An R Companion to Applied Regression</em>. Second Edition. Thousand Oaks CA: Sage. 
</p>
<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## beta regression with ARMA(1,3) errors
data(HUR)
trend &lt;- scale(time(HUR))
m &lt;- gcmr(HUR ~ trend | trend, marginal = beta.marg, cormat = arma.cormat(1, 3))
## normal probability plot
plot(m,  3)
## autocorrelation function of residuals
plot(m,  5)
</code></pre>

<hr>
<h2 id='polio'>
Polio Time Series 
</h2><span id='topic+polio'></span>

<h3>Description</h3>

<p>Time series of Polio incidences in U.S.A. from 1970 to 1983.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(polio)</code></pre>


<h3>Format</h3>

<p>A data frame with the 168 monthly observations (from January 1970 to December 1983) with the following variables
</p>

<table>
<tr>
 <td style="text-align: left;">

<code>y</code> </td><td style="text-align: left;"> time series of polio incidences. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>t*10^( -3 )</code> </td><td style="text-align: left;"> linear trend multiplied by factor <code class="reqn">10^{(-3)}</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>cos( 2*pi*t/12 )</code> </td><td style="text-align: left;"> cosine annual seasonal component. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sin( 2*pi*t/12 )</code> </td><td style="text-align: left;"> sine annual seasonal component. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>cos( 2*pi*t/6 )</code> </td><td style="text-align: left;"> cosine semi-annual seasonal component. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>sin( 2*pi*t/6 )</code> </td><td style="text-align: left;"> sine semi-annual seasonal component. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Source</h3>

<p>Zeger, S.L. (1988). A regression model for time series of counts. <em>Biometrika</em> <b>75</b>, 822&ndash;835.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(polio)
</code></pre>

<hr>
<h2 id='profile.gcmr'>
Profile Log-Likelihood for Gaussian Copula Marginal Regression Models
</h2><span id='topic+profile.gcmr'></span>

<h3>Description</h3>

<p>Computes the profile log-likelihood for mean response parameters of a Gaussian copula marginal regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gcmr'
profile(fitted, which, low, up, npoints = 10, 
        display = TRUE, alpha = 0.05, progress.bar = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile.gcmr_+3A_fitted">fitted</code></td>
<td>

<p>a fitted Gaussian copula marginal regression model of class <code><a href="#topic+gcmr">gcmr</a></code>.
</p>
</td></tr>
<tr><td><code id="profile.gcmr_+3A_which">which</code></td>
<td>

<p>the index of the regression parameter which should be profiled. 
</p>
</td></tr>
<tr><td><code id="profile.gcmr_+3A_low">low</code></td>
<td>

<p>the lower limit used in computation of the profile log-likelihood. If this is <code>missing</code>, then the lower limit is set equal to the estimate minus three times its standard error.
</p>
</td></tr>
<tr><td><code id="profile.gcmr_+3A_up">up</code></td>
<td>

<p>the upper limit used in computation of the profile log-likelihood. If this is <code>missing</code>, then the upper limit is set equal to the estimate plus three times its standard error.
</p>
</td></tr>
<tr><td><code id="profile.gcmr_+3A_npoints">npoints</code></td>
<td>

<p>number of points used in computation of the profile log-likelihood. Default is <code>10</code>.
</p>
</td></tr>
<tr><td><code id="profile.gcmr_+3A_display">display</code></td>
<td>

<p>should the profile log-likelihood be displayed or not? default is <code>TRUE</code>. 
</p>
</td></tr>
<tr><td><code id="profile.gcmr_+3A_alpha">alpha</code></td>
<td>

<p>the significance level, default is <code>0.05</code>. 
</p>
</td></tr>
<tr><td><code id="profile.gcmr_+3A_progress.bar">progress.bar</code></td>
<td>

<p>logical. If TRUE, a text progress bar is displayed. 
</p>
</td></tr>
<tr><td><code id="profile.gcmr_+3A_...">...</code></td>
<td>

<p>further arguments passed to <code>plot</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the display is requested, then the profile log-likelihood is smoothed by cubic spline interpolation. 
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table role = "presentation">
<tr><td><code>points</code></td>
<td>
<p>points at which the profile log-likelihood is evaluated.</p>
</td></tr>
<tr><td><code>profile</code></td>
<td>
<p>values of the profile log-likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## spatial binomial data
## Not run: 
data(malaria)
D &lt;- sp::spDists(cbind(malaria$x, malaria$y))/1000
m &lt;- gcmr(cbind(cases, size-cases) ~ netuse+I(green/100)+phc, data=malaria,
marginal=binomial.marg, cormat=matern.cormat(D), options=gcmr.options(seed=987))
prof &lt;- profile(m, which = 2)
prof

## End(Not run)
</code></pre>

<hr>
<h2 id='residuals.gcmr'>Quantile Residuals for Gaussian Copula Marginal Regression</h2><span id='topic+residuals.gcmr'></span>

<h3>Description</h3>

<p>Computes various type of quantile residuals for validation of a fitted Gaussian copula marginal regression model, as described in Masarotto and Varin (2012; 2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gcmr'
residuals(object, type=c("conditional","marginal"),
          method=c("random","mid"),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.gcmr_+3A_object">object</code></td>
<td>
<p>an object of class <code>gcmr</code>, typically the result of
a call to <code><a href="#topic+gcmr">gcmr</a></code>.</p>
</td></tr>
<tr><td><code id="residuals.gcmr_+3A_type">type</code></td>
<td>
<p>the type of quantile residuals which should be returned.
The alternatives are: <code>"conditional"</code> (default) and <code>"marginal"</code>.</p>
</td></tr>
<tr><td><code id="residuals.gcmr_+3A_method">method</code></td>
<td>
<p>different methods available for quantile residuals in case of discrete responses:
<code>"random"</code> for randomized quantile residuals (default), and 
<code>"mid"</code> for mid interval quantile residuals as defined in Zucchini and MacDonald (2009).</p>
</td></tr>
<tr><td><code id="residuals.gcmr_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Quantile residuals are defined in Dunn and Smyth (1996). Two different types are available:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>conditional</code> </td><td style="text-align: left;"> quantile residuals that account for the dependence. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>marginal</code> </td><td style="text-align: left;"> quantile residuals that do not account for the dependence.
</td>
</tr>

</table>

<p>Conditional quantile residuals are normal quantiles of Rosenblatt (1952) transformations and they are appropriate for validation of the marginal regression models discussed in Masarotto and Varin (2012; 2017). If the responses are discrete, then the conditional quantile residuals are not well defined. This difficulty is overcame by randomized quantile residuals available through option <code>method="random"</code>. Alternatively, Zucchini and MacDonald (2009) suggest the use of mid interval quantile residuals (<code>method="mid"</code>). 
</p>


<h3>Note</h3>

<p>Differently from randomized quantile residuals, mid quantile residuals are <b>not</b> realizations of incorrelated standard normal variables under model conditions.
</p>
<p>It is appropriate to inspect several sets of randomized quantile residuals before to take a decision about the model.
</p>
<p>See Masarotto and Varin (2012; 2017) for more details.
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Dunn, P.K. and Smyth, G.K. (1996). Randomized quantile residuals. <em>Journal of Computational and Graphical Statistics</em> <b>5</b>, 236&ndash;244.
</p>
<p>Masarotto, G. and Varin, C. (2012). Gaussian copula marginal regression. <em>Electronic Journal of Statistics</em> <b>6</b>, 1517&ndash;1549. 
</p>
<p>Masarotto, G. and Varin C. (2017). Gaussian Copula Regression in R. <em>Journal of Statistical Software</em>, <b>77</b>(8), 1&ndash;26. 
</p>
<p>Rosenblatt, M. (1952). Remarks on a multivariate transformation. <em>The Annals of Mathematical Statistics</em> <b>23</b>, 470&ndash;472.
</p>
<p>Zucchini, W. and MacDonald, I.L. (2009). <em>Hidden Markov Models for Time Series</em>. Chapman and Hall/CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gcmr">gcmr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## spatial binomial data
## Not run: 
data(malaria)
D &lt;- sp::spDists(cbind(malaria$x, malaria$y))/1000
m &lt;- gcmr(cbind(cases, size-cases) ~ netuse+I(green/100)+phc, data=malaria, 
marginal=binomial.marg, cormat=matern.cormat(D))
res &lt;- residuals(m)
## normal probability plot
qqnorm(res)
qqline(res)
## or better via plot.gcmr
plot(m, which = 3)

## End(Not run)
</code></pre>

<hr>
<h2 id='scotland'>
Scotland Lip Cancer Data
</h2><span id='topic+scotland'></span>

<h3>Description</h3>

<p>Male lip cancer in Scotland counties between 1975-1980.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(scotland)</code></pre>


<h3>Format</h3>

<p>A data frame with the 56 observations with the following variables
</p>

<table>
<tr>
 <td style="text-align: left;">

<code>observed</code> </td><td style="text-align: left;"> observed cases in each county. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>expected</code> </td><td style="text-align: left;"> expected cases in each county. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>AFF</code> </td><td style="text-align: left;"> proportion of the population employed in agriculture, fishing, or forestry. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>latitude</code> </td><td style="text-align: left;"> county latitude. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>longitude</code> </td><td style="text-align: left;"> county longitude. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Source</h3>

<p>Waller, L.A. and Gotway, C.A. (2004). <em>Applied Spatial Statistics for Public Health Data</em>. New York: John Wiley and Sons.
</p>


<h3>References</h3>

<p>Clayton D. and Kaldor J. (1987). Empirical Bayes estimates of age-standardized relative risks for use in disease mapping. <em>Biometrics</em> <b>43</b>, 671&ndash;681.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(scotland)
</code></pre>

<hr>
<h2 id='summary.gcmr'>Methods for gcmr Objects</h2><span id='topic+print.gcmr'></span><span id='topic+summary.gcmr'></span><span id='topic+print.summary.gcmr'></span><span id='topic+coef.gcmr'></span><span id='topic+vcov.gcmr'></span><span id='topic+bread.gcmr'></span><span id='topic+estfun.gcmr'></span><span id='topic+coeftest.gcmr'></span><span id='topic+logLik.gcmr'></span><span id='topic+terms.gcmr'></span><span id='topic+model.frame.gcmr'></span><span id='topic+model.matrix.gcmr'></span>

<h3>Description</h3>

<p>Methods for extracting information from fitted beta
regression model objects of class <code>"gcmr"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gcmr'
summary(object, ...)

## S3 method for class 'gcmr'
coef(object, ...)
## S3 method for class 'gcmr'
vcov(object, ...)
## S3 method for class 'gcmr'
bread(x, ...)
## S3 method for class 'gcmr'
estfun(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.gcmr_+3A_object">object</code>, <code id="summary.gcmr_+3A_x">x</code></td>
<td>
<p>a fitted marginal regression model of class <code><a href="#topic+gcmr">gcmr</a></code>.</p>
</td></tr>
<tr><td><code id="summary.gcmr_+3A_...">...</code></td>
<td>
<p>additional arguments, but currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>summary.gcmr</code> returns an object of class &quot;summary.glm&quot;, a list with some components of the <code>gcmr</code> object, plus 
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>a list with components <code>marginal</code> and <code>copula</code> containing the maximum likelihood estimates of the marginal and Gaussian copula parameters, respectively.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike Information Criterion.</p>
</td></tr>
</table>
<p>Function <code><a href="stats.html#topic+coef">coef</a></code> returns the estimated coefficients and <code><a href="stats.html#topic+vcov">vcov</a></code> their variance-covariance matrix. Functions <code>bread</code> and <code>estfun</code> extract the components of the robust sandwich variance matrix that can be computed with the <code>sandwich</code> package (Zeileis, 2004; 2006).
</p>


<h3>Author(s)</h3>

<p>Guido Masarotto and Cristiano Varin.
</p>


<h3>References</h3>

<p>Zeileis, A. (2004). Econometric computing with HC and HAC covariance matrix estimators. <em>Journal of Statistical Software</em> <b>11</b>, issue 10.
</p>
<p>Zeileis, A. (2006). Object-oriented computation of sandwich estimators. <em>Journal of Statistical Software</em> <b>16</b>, issue 9.
</p>


<h3>See Also</h3>

<p><code>bread</code>, <code>estfun</code>, <code><a href="#topic+gcmr">gcmr</a></code>, <code>sandwich</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(epilepsy)
fit &lt;- gcmr(counts ~ offset(log(time)) + visit + trt + visit:trt, data = epilepsy, 
subset = (id != 49), marginal = negbin.marg, cormat = cluster.cormat(id, "ar1"), 
options=gcmr.options(seed=123, nrep=c(25,100) ))
summary(fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
