<!DOCTYPE html><html lang="en"><head><title>Help for package shrinkTVP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {shrinkTVP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eval_pred_dens'><p>Evaluate the one-step ahead predictive density of a fitted TVP model</p></a></li>
<li><a href='#fitted.shrinkTVP'><p>Calculate fitted historical values for an estimated TVP model</p></a></li>
<li><a href='#forecast_shrinkTVP'><p>Draw from posterior predictive density of a fitted TVP model</p></a></li>
<li><a href='#LPDS'><p>Calculate the Log Predictive Density Score for a fitted TVP model</p></a></li>
<li><a href='#plot.mcmc.tvp'><p>Graphical summary of posterior distribution for a time-varying parameter</p></a></li>
<li><a href='#plot.shrinkTVP'><p>Graphical summary of posterior distribution</p></a></li>
<li><a href='#plot.shrinkTVP_forc'><p>Graphical summary of posterior predictive density</p></a></li>
<li><a href='#predict.shrinkTVP'><p>Calculate predicted historical values for an estimated TVP model</p></a></li>
<li><a href='#print.shrinkTVP'><p>Nicer printing of shrinkTVP objects</p></a></li>
<li><a href='#residuals.shrinkTVP'><p>Calculate residuals for an estimated TVP model</p></a></li>
<li><a href='#shrinkDTVP'><p>Markov Chain Monte Carlo (MCMC) for time-varying parameter models with dynamic shrinkage</p></a></li>
<li><a href='#shrinkTVP'><p>Markov Chain Monte Carlo (MCMC) for time-varying parameter models with shrinkage</p></a></li>
<li><a href='#simTVP'><p>Generate synthetic data from a time-varying parameter model</p></a></li>
<li><a href='#updateTVP'><p>One step update version of <code>shrinkTVP</code> with minimal overhead</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Efficient Bayesian Inference for Time-Varying Parameter Models
with Shrinkage</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Efficient Markov chain Monte Carlo (MCMC) algorithms for fully Bayesian estimation of time-varying parameter models with shrinkage priors, both dynamic and static. Details on the algorithms used are provided in Bitto and Frühwirth-Schnatter (2019) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2018.11.006">doi:10.1016/j.jeconom.2018.11.006</a>&gt; and  
  Cadonna et al. (2020) &lt;<a href="https://doi.org/10.3390%2Feconometrics8020020">doi:10.3390/econometrics8020020</a>&gt; and Knaus and Frühwirth-Schnatter (2023)  &lt;<a href="https://doi.org/10.48550%2FarXiv.2312.10487">doi:10.48550/arXiv.2312.10487</a>&gt;. For details on the package, please see Knaus et al. (2021) &lt;<a href="https://doi.org/10.18637%2Fjss.v100.i13">doi:10.18637/jss.v100.i13</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, GIGrvg, stochvol (&ge; 3.0.3), coda, methods, utils, zoo</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, GIGrvg, RcppProgress, stochvol, RcppGSL</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-18 18:49:34 UTC; Peter</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Knaus <a href="https://orcid.org/0000-0001-6498-7084"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Angela Bitto-Nemling [aut],
  Annalisa Cadonna <a href="https://orcid.org/0000-0003-0360-7628"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Sylvia Frühwirth-Schnatter
    <a href="https://orcid.org/0000-0003-0516-5552"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Daniel Winkler [ctb],
  Kemal Dingic [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Knaus &lt;peter.knaus@wu.ac.at&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-18 19:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='eval_pred_dens'>Evaluate the one-step ahead predictive density of a fitted TVP model</h2><span id='topic+eval_pred_dens'></span>

<h3>Description</h3>

<p><code>eval_pred_dens</code> evaluates the one-step ahead predictive density of a fitted TVP model resulting from a call to
shrinkTVP at the points supplied in <code>x</code>. For details on the approximation of the one-step ahead predictive density used,
see the vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_pred_dens(x, mod, data_test, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eval_pred_dens_+3A_x">x</code></td>
<td>
<p>a real number or a vector of real numbers, taken to be the points at which the predictive density will be evaluated.</p>
</td></tr>
<tr><td><code id="eval_pred_dens_+3A_mod">mod</code></td>
<td>
<p>an object of class <code>shrinkTVP</code>, containing the fitted model for which the predictive density should be evaluated.</p>
</td></tr>
<tr><td><code id="eval_pred_dens_+3A_data_test">data_test</code></td>
<td>
<p>a data frame with one row, containing the one-step ahead covariates. The names of the covariates have to match the
names of the covariates used during model estimation in the call to <code>shrinkTVP</code>.</p>
</td></tr>
<tr><td><code id="eval_pred_dens_+3A_log">log</code></td>
<td>
<p>a single logical value determining whether the density should be evaluated on the log scale or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is a vector of length <code>length(x)</code>, containing the values of the predictive density evaluated
at the points supplied in <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other prediction functions: 
<code><a href="#topic+LPDS">LPDS</a>()</code>,
<code><a href="#topic+fitted.shrinkTVP">fitted.shrinkTVP</a>()</code>,
<code><a href="#topic+forecast_shrinkTVP">forecast_shrinkTVP</a>()</code>,
<code><a href="#topic+predict.shrinkTVP">predict.shrinkTVP</a>()</code>,
<code><a href="#topic+residuals.shrinkTVP">residuals.shrinkTVP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
set.seed(123)
sim &lt;- simTVP(theta = c(0.2, 0, 0), beta_mean = c(1.5, -0.3, 0))
data &lt;- sim$data

# Estimate model
res &lt;- shrinkTVP(y ~ x1 + x2, data = data[1:199, ])

# Create sequence of x values where the density is to be evaluated
x_vals &lt;- seq(0, 12, by = 0.1)

# Evaluate density and plot
dens &lt;- eval_pred_dens(x_vals, res, data[200, ])
plot(x_vals, dens, type = "l")

# Add vertical line where true value of the one-step ahead y lies
abline(v = data$y[200])

</code></pre>

<hr>
<h2 id='fitted.shrinkTVP'>Calculate fitted historical values for an estimated TVP model</h2><span id='topic+fitted.shrinkTVP'></span>

<h3>Description</h3>

<p>Calculates the fitted values for an estimated TVP model, i.e. <code class="reqn">X_t'\beta_t</code>.
Note that in contrast to <code><a href="#topic+predict.shrinkTVP">predict.shrinkTVP</a></code> this does not include the error term.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkTVP'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.shrinkTVP_+3A_object">object</code></td>
<td>
<p>A <code>shrinkTVP</code> object</p>
</td></tr>
<tr><td><code id="fitted.shrinkTVP_+3A_...">...</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>shrinkTVP_fitted</code>
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other prediction functions: 
<code><a href="#topic+LPDS">LPDS</a>()</code>,
<code><a href="#topic+eval_pred_dens">eval_pred_dens</a>()</code>,
<code><a href="#topic+forecast_shrinkTVP">forecast_shrinkTVP</a>()</code>,
<code><a href="#topic+predict.shrinkTVP">predict.shrinkTVP</a>()</code>,
<code><a href="#topic+residuals.shrinkTVP">residuals.shrinkTVP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Generate synthetic data
sim &lt;- simTVP()

# Estimate a model
res &lt;- shrinkTVP(y ~ x1 + x2, sim$data)

# Calculate fitted values
fitted &lt;- fitted(res)

# Visualize
plot(fitted)
lines(sim$data$y, col = "forestgreen")

</code></pre>

<hr>
<h2 id='forecast_shrinkTVP'>Draw from posterior predictive density of a fitted TVP model</h2><span id='topic+forecast_shrinkTVP'></span>

<h3>Description</h3>

<p><code>forecast_shrinkTVP</code> draws from the posterior predictive distribution of a fitted TVP model resulting from a call to
<code>shrinkTVP</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forecast_shrinkTVP(mod, newdata, n.ahead)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forecast_shrinkTVP_+3A_mod">mod</code></td>
<td>
<p>an object of class <code>shrinkTVP</code>, containing the fitted model.</p>
</td></tr>
<tr><td><code id="forecast_shrinkTVP_+3A_newdata">newdata</code></td>
<td>
<p>a data frame containing the future covariates. The names of the covariates
have to match the names used during model estimation in the call to <code>shrinkTVP</code>.</p>
</td></tr>
<tr><td><code id="forecast_shrinkTVP_+3A_n.ahead">n.ahead</code></td>
<td>
<p>a single, positive integer indicating the forecasting horizon, i.e. how many time-points into the future
the posterior predictive distribution should be sampled from. Can not be larger than the number of rows in <code>newdata</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is a list object of class <code>shrinkTVP_forc</code> containing the samples from the
posterior predictive density.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other prediction functions: 
<code><a href="#topic+LPDS">LPDS</a>()</code>,
<code><a href="#topic+eval_pred_dens">eval_pred_dens</a>()</code>,
<code><a href="#topic+fitted.shrinkTVP">fitted.shrinkTVP</a>()</code>,
<code><a href="#topic+predict.shrinkTVP">predict.shrinkTVP</a>()</code>,
<code><a href="#topic+residuals.shrinkTVP">residuals.shrinkTVP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
set.seed(123)
sim &lt;- simTVP(theta = c(0.2, 0, 0), beta_mean = c(1.5, -0.3, 0))
data &lt;- sim$data

# Estimate model
res &lt;- shrinkTVP(y ~ x1 + x2, data = data[1:190, ])

# Forecast
forc &lt;- forecast_shrinkTVP(res, data[191:200, ])

# Plot
plot(forc)


</code></pre>

<hr>
<h2 id='LPDS'>Calculate the Log Predictive Density Score for a fitted TVP model</h2><span id='topic+LPDS'></span>

<h3>Description</h3>

<p><code>LPDS</code> calculates the one-step ahead Log Predictive Density Score (LPDS) of a fitted TVP model resulting from a call to
<code>shrinkTVP</code> For details on the approximation of the one-step ahead predictive density used, see the vignette.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LPDS(mod, data_test)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LPDS_+3A_mod">mod</code></td>
<td>
<p>an object of class <code>shrinkTVP</code>, containing the fitted model for which the LPDS should be calculated.</p>
</td></tr>
<tr><td><code id="LPDS_+3A_data_test">data_test</code></td>
<td>
<p>a data frame with one row, containing the one-step ahead covariates and response. The names of the covariates
and the response have to match the names used during model estimation in the call to <code>shrinkTVP</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A real number equaling the calculated LPDS.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other prediction functions: 
<code><a href="#topic+eval_pred_dens">eval_pred_dens</a>()</code>,
<code><a href="#topic+fitted.shrinkTVP">fitted.shrinkTVP</a>()</code>,
<code><a href="#topic+forecast_shrinkTVP">forecast_shrinkTVP</a>()</code>,
<code><a href="#topic+predict.shrinkTVP">predict.shrinkTVP</a>()</code>,
<code><a href="#topic+residuals.shrinkTVP">residuals.shrinkTVP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
set.seed(123)
sim &lt;- simTVP(theta = c(0.2, 0, 0), beta_mean = c(1.5, -0.3, 0))
data &lt;- sim$data

# Estimate model
res &lt;- shrinkTVP(y ~ x1 + x2, data = data[1:199, ])

# Calculate LPDS
LPDS(res, data[200,])


</code></pre>

<hr>
<h2 id='plot.mcmc.tvp'>Graphical summary of posterior distribution for a time-varying parameter</h2><span id='topic+plot.mcmc.tvp'></span>

<h3>Description</h3>

<p><code>plot.mcmc.tvp</code> plots empirical posterior quantiles for a time-varying parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mcmc.tvp'
plot(
  x,
  probs = c(0.025, 0.25, 0.75, 0.975),
  shaded = TRUE,
  quantlines = FALSE,
  shadecol = "skyblue",
  shadealpha = 0.5,
  quantlty = 2,
  quantcol = "black",
  quantlwd = 0.5,
  drawzero = TRUE,
  zerolty = 2,
  zerolwd = 1,
  zerocol = "grey",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mcmc.tvp_+3A_x">x</code></td>
<td>
<p><code>mcmc.tvp</code> object</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_probs">probs</code></td>
<td>
<p>vector of boundaries for credible intervals to plot for each point in time, with values in [0,1].
The largest and smallest value form the outermost credible interval, the second smallest and second largest the second outermost and so forth.
The default value is <code>c(0.025, 0.25, 0.75, 0.975)</code>. Note that there have to be the same number of probs
&lt; 0.5 as there are &gt; 0.5.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_shaded">shaded</code></td>
<td>
<p>single logical value or a vector of logical values, indicating whether or not to shade the area between the pointwise
credible intervals. If a vector is given, the first value given is used to determine if the area between the outermost credible interval
is shaded, the second for the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the
number of quantile pairs. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_quantlines">quantlines</code></td>
<td>
<p>single logical value or a vector of logical values, indicating whether or not to draw borders along the pointwise
credible intervals. If a vector is given, the first value given is used to determine whether the outermost credible interval
is marked by lines, the second for the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the
number of credible intervals. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_shadecol">shadecol</code></td>
<td>
<p>single character string or a vector of character strings. Determines the color of the shaded areas that represent
the credible intervals. If a vector is given, the first color given is used for the outermost area,
the second for the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the number
of shaded areas. Has no effect if <code>shaded = FALSE</code>. The default value is <code>"skyblue"</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_shadealpha">shadealpha</code></td>
<td>
<p>real number between 0 and 1 or a vector of real numbers between 0 and 1.
Determines the level of transparency of the shaded areas that represent
the credible intervals. If a vector is given, the first value
given is used for the outermost area, the second for the second outermost and so forth. Recycled in the usual fashion
if the vector is shorter than the number of shaded areas. Has no effect if <code>shaded = FALSE</code>.
The default value is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_quantlty">quantlty</code></td>
<td>
<p>either a single integer in [0,6] or one of the character strings <code>"blank",
"solid", "dashed", "dotted", "dotdash", "longdash", "twodash"</code> or a vector containing these. Determines the line type of the borders
drawn around the shaded areas that represent the credible intervals. Note that if a vector is supplied the elements have to either
be all integers or all character strings. If a vector is given, the first value given is used for the outermost area, the second for
the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the number of shaded areas.
Has no effect if <code>quantlines = FALSE</code>. The default value is <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_quantcol">quantcol</code></td>
<td>
<p>single character string or a vector of character strings. Determines the color of the borders drawn around the shaded
areas that represent the credible intervals. If a vector is given, the first color given is used for borders of the outermost area,
the second for the second outermost and so forth. Recycled in the usual fashion if the vector is shorter than the number
of shaded areas. Has no effect if <code>quantlines = FALSE</code>. The default value is <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_quantlwd">quantlwd</code></td>
<td>
<p>single real, positive number or a vector of real, positive numbers. Determines the line width of the borders
drawn around the shaded areas that represent the credible intervals. If a vector is given, the first number given is used for
the borders of the outermost area, the second for the second outermost and so forth. Recycled in the usual fashion if the vector
is shorter than the number of shaded areas. Has no effect if <code>quantlines = FALSE</code>. The default value is <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_drawzero">drawzero</code></td>
<td>
<p>single logical value determining whether to draw a horizontal line at zero or not. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_zerolty">zerolty</code></td>
<td>
<p>single integer in [0,6] or one of the character strings <code>"blank",
"solid", "dashed", "dotted", "dotdash", "longdash", "twodash"</code>. Determines the line type of the horizontal line at zero. Has no effect
if <code>drawzero = FALSE</code>. The default value is <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_zerolwd">zerolwd</code></td>
<td>
<p>single real, positive number. Determines the line width of the horizontal line at zero. Has no effect
if <code>drawzero = FALSE</code>. The default value is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_zerocol">zerocol</code></td>
<td>
<p>single character string. Determines the color of the horizontal line at zero. Has no effect if <code>drawzero = FALSE</code>.
The default value is <code>"grey"</code>.</p>
</td></tr>
<tr><td><code id="plot.mcmc.tvp_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects and returns invisibly.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other plotting functions: 
<code><a href="#topic+plot.shrinkTVP_forc">plot.shrinkTVP_forc</a>()</code>,
<code><a href="#topic+plot.shrinkTVP">plot.shrinkTVP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
sim &lt;- simTVP(theta = c(0.2, 0, 0), beta_mean = c(1.5, -0.3, 0))
data &lt;- sim$data

res &lt;- shrinkTVP(y ~ x1 + x2, data)
plot(res$beta$beta_x1)

</code></pre>

<hr>
<h2 id='plot.shrinkTVP'>Graphical summary of posterior distribution</h2><span id='topic+plot.shrinkTVP'></span>

<h3>Description</h3>

<p><code>plot.shrinkTVP</code> generates plots visualizing the posterior distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkTVP'
plot(
  x,
  pars = c("beta"),
  nplot = 3,
  h_borders = c(0.05, 0.05),
  w_borders = c(0.02, 0.02),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.shrinkTVP_+3A_x">x</code></td>
<td>
<p>a <code>shrinkTVP</code> object.</p>
</td></tr>
<tr><td><code id="plot.shrinkTVP_+3A_pars">pars</code></td>
<td>
<p>a character vector containing the names of the parameters to be visualized.
The names have to coincide with the names of the list elements of the <code>shrinkTVP</code>
object. Throws an error if any element of <code>pars</code> does not fulfill this criterium.
The default is <code>c("beta")</code>.</p>
</td></tr>
<tr><td><code id="plot.shrinkTVP_+3A_nplot">nplot</code></td>
<td>
<p>positive integer that indicates the number of tvp plots to display on a single
page before a new page is generated. The default value is 3.</p>
</td></tr>
<tr><td><code id="plot.shrinkTVP_+3A_h_borders">h_borders</code></td>
<td>
<p>single real, positive number smaller than 0.5 or a vector containing two such numbers. Determines
the relative amount of space (the total amount summing up to 1) left blank on the left and right of the plot, in that order.
The default is <code>c(0.05, 0.05)</code>.</p>
</td></tr>
<tr><td><code id="plot.shrinkTVP_+3A_w_borders">w_borders</code></td>
<td>
<p>single real, positive number smaller than 0.5 or a vector containing two such numbers. Determines
the relative amount of space (the total amount summing up to 1) left blank at the top and bottom of the plot, in that order.
The default is <code>c(0.02, 0.02)</code>.</p>
</td></tr>
<tr><td><code id="plot.shrinkTVP_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to the respective plotting functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects and returns invisibly.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other plotting functions: 
<code><a href="#topic+plot.mcmc.tvp">plot.mcmc.tvp</a>()</code>,
<code><a href="#topic+plot.shrinkTVP_forc">plot.shrinkTVP_forc</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
sim &lt;- simTVP(theta = c(0.2, 0, 0), beta_mean = c(1.5, -0.3, 0))
data &lt;- sim$data

output &lt;- shrinkTVP(y ~ x1 + x2, data)
plot(output)


## Will produce an error because 'hello' is not a parameter in the model
## Not run: 
plot(output, pars = c("beta", "hello"))

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.shrinkTVP_forc'>Graphical summary of posterior predictive density</h2><span id='topic+plot.shrinkTVP_forc'></span>

<h3>Description</h3>

<p><code>plot.shrinkTVP_forc</code> generates plots visualizing the posterior predictive density generated by <code>forecast_shrinkTVP</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkTVP_forc'
plot(x, showgap = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.shrinkTVP_forc_+3A_x">x</code></td>
<td>
<p>a <code>shrinkTVP_forc</code> object.</p>
</td></tr>
<tr><td><code id="plot.shrinkTVP_forc_+3A_showgap">showgap</code></td>
<td>
<p>if <code>showgap = FALSE</code>, the gap between the historical observations and the forecasts is removed.
The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.shrinkTVP_forc_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects and returns invisibly.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other plotting functions: 
<code><a href="#topic+plot.mcmc.tvp">plot.mcmc.tvp</a>()</code>,
<code><a href="#topic+plot.shrinkTVP">plot.shrinkTVP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(123)
sim &lt;- simTVP()

train &lt;- sim$data[1:190, ]
test &lt;- sim$data[191:200, ]

res &lt;- shrinkTVP(y ~ x1 + x2, train)

forecast &lt;- forecast_shrinkTVP(res, test)
plot(forecast)
lines(sim$data$y, col = "forestgreen")


</code></pre>

<hr>
<h2 id='predict.shrinkTVP'>Calculate predicted historical values for an estimated TVP model</h2><span id='topic+predict.shrinkTVP'></span>

<h3>Description</h3>

<p>Calculates the predicted past values for an estimated TVP model, i.e. <code class="reqn">X_t'\beta_t + \epsilon_t</code>.
Note that in contrast to <code><a href="#topic+fitted.shrinkTVP">fitted.shrinkTVP</a></code> this includes the error term.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkTVP'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.shrinkTVP_+3A_object">object</code></td>
<td>
<p>a <code>shrinkTVP</code> object</p>
</td></tr>
<tr><td><code id="predict.shrinkTVP_+3A_...">...</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>shrinkTVP_pred</code>.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other prediction functions: 
<code><a href="#topic+LPDS">LPDS</a>()</code>,
<code><a href="#topic+eval_pred_dens">eval_pred_dens</a>()</code>,
<code><a href="#topic+fitted.shrinkTVP">fitted.shrinkTVP</a>()</code>,
<code><a href="#topic+forecast_shrinkTVP">forecast_shrinkTVP</a>()</code>,
<code><a href="#topic+residuals.shrinkTVP">residuals.shrinkTVP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Generate synthetic data
sim &lt;- simTVP(N = 300)

# Estimate a model
res &lt;- shrinkTVP(y ~ x1 + x2, sim$data)

# Calculate predicted values
pred &lt;- predict(res)

# Visualize
plot(pred)
lines(sim$data$y, col = "forestgreen")

</code></pre>

<hr>
<h2 id='print.shrinkTVP'>Nicer printing of shrinkTVP objects</h2><span id='topic+print.shrinkTVP'></span>

<h3>Description</h3>

<p>Nicer printing of shrinkTVP objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkTVP'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.shrinkTVP_+3A_x">x</code></td>
<td>
<p>a <code>shrinkTVP</code> object.</p>
</td></tr>
<tr><td><code id="print.shrinkTVP_+3A_...">...</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Called for its side effects and returns invisibly.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>

<hr>
<h2 id='residuals.shrinkTVP'>Calculate residuals for an estimated TVP model</h2><span id='topic+residuals.shrinkTVP'></span>

<h3>Description</h3>

<p>Calculates the residuals for an estimated TVP model, i.e. <code class="reqn">y_t - X_t'\beta_t</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'shrinkTVP'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.shrinkTVP_+3A_object">object</code></td>
<td>
<p>a <code>shrinkTVP</code> object.</p>
</td></tr>
<tr><td><code id="residuals.shrinkTVP_+3A_...">...</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>shrinkTVP_resid</code>
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>See Also</h3>

<p>Other prediction functions: 
<code><a href="#topic+LPDS">LPDS</a>()</code>,
<code><a href="#topic+eval_pred_dens">eval_pred_dens</a>()</code>,
<code><a href="#topic+fitted.shrinkTVP">fitted.shrinkTVP</a>()</code>,
<code><a href="#topic+forecast_shrinkTVP">forecast_shrinkTVP</a>()</code>,
<code><a href="#topic+predict.shrinkTVP">predict.shrinkTVP</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Generate synthetic data
sim &lt;- simTVP(N = 300)

# Estimate a model
res &lt;- shrinkTVP(y ~ x1 + x2, sim$data)

# Calculate residuals
resids &lt;- residuals(res)

# Visualize
plot(resids)

</code></pre>

<hr>
<h2 id='shrinkDTVP'>Markov Chain Monte Carlo (MCMC) for time-varying parameter models with dynamic shrinkage</h2><span id='topic+shrinkDTVP'></span>

<h3>Description</h3>

<p><code>shrinkTVP</code> samples from the joint posterior distribution of the parameters of a time-varying
parameter model with dynamic triple gamma shrinkage, potentially including stochastic volatility (SV),
and returns the MCMC draws.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shrinkDTVP(
  formula,
  data,
  mod_type = "double",
  niter = 10000,
  nburn = round(niter/2),
  nthin = 1,
  learn_a_xi = TRUE,
  learn_a_tau = TRUE,
  a_xi = 0.1,
  a_tau = 0.1,
  learn_c_xi = TRUE,
  learn_c_tau = TRUE,
  c_xi = 0.1,
  c_tau = 0.1,
  a_eq_c_xi = FALSE,
  a_eq_c_tau = FALSE,
  learn_kappa2_B = TRUE,
  learn_lambda2_B = TRUE,
  kappa2_B = 20,
  lambda2_B = 20,
  a_psi = 0.5,
  c_psi = 0.5,
  iid = FALSE,
  shrink_inter = TRUE,
  hyperprior_param,
  display_progress = TRUE,
  sv = FALSE,
  sv_param,
  MH_tuning,
  starting_vals
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shrinkDTVP_+3A_formula">formula</code></td>
<td>
<p>object of class &quot;formula&quot;: a symbolic representation of the model, as in the
function <code>lm</code>. For details, see <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_data">data</code></td>
<td>
<p><em>optional</em> data frame containing the response variable and the covariates. If not found in <code>data</code>,
the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>shrinkTVP</code>
is called. No <code>NA</code>s are allowed in the response variable and the covariates.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_mod_type">mod_type</code></td>
<td>
<p>character string that reads either <code>"triple"</code>, <code>"double"</code> or <code>"ridge"</code>.
Determines whether the triple gamma, double gamma or ridge prior are used for <code>theta_sr</code> and <code>beta_mean</code>.
The default is &quot;double&quot;.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_niter">niter</code></td>
<td>
<p>positive integer, indicating the number of MCMC iterations
to perform, including the burn-in. Has to be larger than or equal to <code>nburn</code> + 2. The default value is 10000.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_nburn">nburn</code></td>
<td>
<p>non-negative integer, indicating the number of iterations discarded
as burn-in. Has to be smaller than or equal to <code>niter</code> - 2. The default value is <code>round(niter / 2)</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_nthin">nthin</code></td>
<td>
<p>positive integer, indicating the degree of thinning to be performed. Every <code>nthin</code> draw is kept and returned.
The default value is 1, implying that every draw is kept.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_learn_a_xi">learn_a_xi</code></td>
<td>
<p>logical value indicating whether to learn a_xi, the spike parameter of the state variances.
Ignored if <code>mod_type</code> is set to <code>"ridge"</code>. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_learn_a_tau">learn_a_tau</code></td>
<td>
<p>logical value indicating whether to learn a_tau, the spike parameter of the mean of the
initial values of the states. Ignored if <code>mod_type</code> is set to <code>"ridge"</code>. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_a_xi">a_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_xi. Ignored if
<code>learn_a_xi</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_a_tau">a_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_tau. Ignored if
<code>learn_a_tau</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_learn_c_xi">learn_c_xi</code></td>
<td>
<p>logical value indicating whether to learn c_xi, the tail parameter of the state variances.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code> or <code>a_eq_c_xi</code> is set to <code>TRUE</code>.
The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_learn_c_tau">learn_c_tau</code></td>
<td>
<p>logical value indicating whether to learn c_tau, the tail parameter of the mean of the
initial values of the states. Ignored if <code>mod_type</code> is not set to <code>"triple"</code> or <code>a_eq_c_tau</code> is set to <code>TRUE</code>.
The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_c_xi">c_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_xi. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code>, <code>mod_type</code> is not set to <code>"triple"</code> or <code>a_eq_c_xi</code> is set to <code>TRUE</code>.
The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_c_tau">c_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_tau. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code>, <code>mod_type</code> is not set to <code>"triple"</code>  or <code>a_eq_c_tau</code> is set to <code>TRUE</code>.
The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_a_eq_c_xi">a_eq_c_xi</code></td>
<td>
<p>logical value indicating whether to force <code>a_xi</code> and <code>c_xi</code> to be equal.
If set to <code>TRUE</code>, <code>beta_a_xi</code> and <code>alpha_a_xi</code> are used as the hyperparameters and <code>beta_c_xi</code> and <code>alpha_c_xi</code> are ignored.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_a_eq_c_tau">a_eq_c_tau</code></td>
<td>
<p>logical value indicating whether to force <code>a_tau</code> and <code>c_tau</code> to be equal.
If set to <code>TRUE</code>, <code>beta_a_tau</code> and <code>alpha_a_tau</code> are used as the hyperparameters and <code>beta_c_tau</code> and <code>alpha_c_tau</code> are ignored.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_learn_kappa2_b">learn_kappa2_B</code></td>
<td>
<p>logical value indicating whether to learn kappa2_B, the global level of shrinkage for
the state variances. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_learn_lambda2_b">learn_lambda2_B</code></td>
<td>
<p>logical value indicating whether to learn the lambda2_B parameter,
the global level of shrinkage for the mean of the initial values of the states. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_kappa2_b">kappa2_B</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for kappa2_B. Ignored if
<code>learn_kappa2_B</code> is <code>TRUE</code>. The default value is 20.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_lambda2_b">lambda2_B</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for lambda2_B. Ignored if
<code>learn_lambda2_B</code> is <code>TRUE</code>. The default value is 20.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_a_psi">a_psi</code></td>
<td>
<p>positive, real number, or a vector of length equal to the number of covariates containing
positive, real numbers. Indicates the value for a_psi, which is the pole parameter of the dynamic triple gamma.
The default value is 0.5.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_c_psi">c_psi</code></td>
<td>
<p>positive, real number, or a vector of length equal to the number of covariates containing
positive, real numbers. Indicates the value for c_psi, which is the tail parameter of the dynamic triple gamma.
The default value is 0.5.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_iid">iid</code></td>
<td>
<p>logical value indicating whether the innovations are assumed to be independent and identically distributed.
If set to <code>TRUE</code>, the innovations are assumed to be a priori iid triple gamma. If set to <code>FALSE</code>,
the prior on the innovations is the dynamic triple gamma specification of Knaus and Frühwirth-Schnatter (2023).
The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_shrink_inter">shrink_inter</code></td>
<td>
<p>logical value indicating whether to dynamically shrink the intercept. Note that shrinkage is still applied
to the <code>theta_sr</code> and <code>beta_mean</code> associated with the intercept. The intercept column is automatically determined
by the function and does not have to be included in the formula. This is done by finding the column that contains only 1s.
The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_hyperprior_param">hyperprior_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values.
Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
All hyperparameter values have to be positive, real numbers. The following hyperparameters can be
supplied:
</p>

<ul>
<li> <p><code>c0</code>: The default value is 2.5.
</p>
</li>
<li> <p><code>g0</code>: The default value is 5.
</p>
</li>
<li> <p><code>G0</code>: The default value is 5 / (2.5 - 1).
</p>
</li>
<li> <p><code>e1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>e2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>alpha_a_xi</code>: The default value is 5.
</p>
</li>
<li> <p><code>alpha_a_tau</code>: The default value is 5.
</p>
</li>
<li> <p><code>beta_a_xi</code>: The default value is 10.
</p>
</li>
<li> <p><code>beta_a_tau</code>: The default value is 10.
</p>
</li>
<li> <p><code>alpha_c_xi</code>: The default value is 5.
</p>
</li>
<li> <p><code>alpha_c_tau</code>: The default value is 5.
</p>
</li>
<li> <p><code>beta_c_xi</code>: The default value is 2.
</p>
</li>
<li> <p><code>beta_c_tau</code>: The default value is 2.
</p>
</li>
<li> <p><code>a_rho</code>: The default value is 2.
</p>
</li>
<li> <p><code>b_rho</code>: The default value is 0.95.
</p>
</li>
<li> <p><code>alpha_rho</code>: The default value is 0.5.
</p>
</li>
<li> <p><code>beta_rho</code>: The default value is 3.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_display_progress">display_progress</code></td>
<td>
<p>logical value indicating whether the progress bar and other informative output should be
displayed. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_sv">sv</code></td>
<td>
<p>logical value indicating whether to use stochastic volatility for the error of the observation
equation. For details please see <code><a href="stochvol.html#topic+stochvol">stochvol</a></code>, in particular <code><a href="stochvol.html#topic+svsample">svsample</a></code>. The default value is
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_sv_param">sv_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values for the stochastic volatility
parameters. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown. Ignored if
<code>sv</code> is <code>FALSE</code>. The following elements can be supplied:
</p>

<ul>
<li> <p><code>Bsigma_sv</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a0_sv</code>: positive, real number. The default value is 5.
</p>
</li>
<li> <p><code>b0_sv</code>: positive, real number. The default value is 1.5.
</p>
</li>
<li> <p><code>bmu</code>: real number. The default value is 0.
</p>
</li>
<li> <p><code>Bmu</code>: real number. larger than 0. The default value is 1.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_mh_tuning">MH_tuning</code></td>
<td>
<p><em>optional</em> named list containing values used to tune the MH steps for <code>a_xi</code>, <code>a_tau</code>,
<code>c_xi</code>, and <code>c_tau</code>. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
The arguments for <code>a_xi</code>(<code>a_tau</code>) are only used if <code>learn_a_xi</code>(<code>learn_a_tau</code>)
is set to <code>TRUE</code> and <code>mod_type</code> is not equal to <code>"ridge"</code>. The arguments for <code>c_xi</code>(<code>c_tau</code>) are only
used if <code>learn_c_xi</code>(<code>learn_c_tau</code>) is set to <code>TRUE</code> and <code>mod_type</code> is equal to <code>"triple"</code>. Arguments ending in &quot;adaptive&quot; are
logical values indicating whether or not to make the MH step for the respective parameter adaptive. Arguments ending in &quot;tuning_par&quot; serve two different purposes.
If the respective MH step is not set to be adaptive, it acts as the standard deviation of the proposal distribution. If the respective MH step
is set to be adaptive, it acts as the initial standard deviation. Arguments ending in &quot;target_rate&quot; define the acceptance rate the algorithm aims to achieve.
Arguments ending in &quot;max_adapt&quot; set the maximum value by which the logarithm of the standard deviation of the proposal distribution is adjusted. Finally,
arguments ending in &quot;batch_size&quot; set the batch size after which the standard deviation of the proposal distribution is adjusted.
The following elements can be supplied:
</p>

<ul>
<li> <p><code>a_xi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_xi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_xi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_xi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_xi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>a_tau_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_tau_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_tau_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_tau_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_tau_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>c_xi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_xi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>c_xi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>c_xi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>c_xi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>c_tau_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_tau_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>c_tau_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>c_tau_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>c_tau_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>rho_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>rho_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>rho_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>rho_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>rho_batch_size</code>: positive integer. The default value is 50.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkDTVP_+3A_starting_vals">starting_vals</code></td>
<td>
<p><em>optional</em> named list containing the values at which the MCMC algorithm will be initialized. In the
following <code>d</code> refers to the number of covariates, including the intercept and expanded factors.
Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown. The following elements can be supplied:
</p>

<ul>
<li> <p><code>beta_mean_st</code>: vector of length <code>d</code> containing single numbers. The default is <code>rep(0, d)</code>.
</p>
</li>
<li> <p><code>theta_sr_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>tau2_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>xi2_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>kappa2_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>lambda2_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>kappa2_B_st</code>: positive, real number. The default value is 20.
</p>
</li>
<li> <p><code>lambda2_B_st</code>: positive, real number. The default value is 20.
</p>
</li>
<li> <p><code>a_xi_st</code>: positive, real number. The default value is 0.1.
</p>
</li>
<li> <p><code>a_tau_st</code>: positive, real number. The default value is 0.1.
</p>
</li>
<li> <p><code>c_xi_st</code>: positive, real number. The default value is 0.1. Note that the prior for <code>c_xi</code> is restricted to (0, 0.5).
</p>
</li>
<li> <p><code>c_tau_st</code>: positive, real number. The default value is 0.1. Note that the prior for <code>c_tau</code> is restricted to (0, 0.5).
</p>
</li>
<li> <p><code>sv_mu_st</code>: real number. The default value is -10.
</p>
</li>
<li> <p><code>sv_phi_st</code>: positive, real number between -1 and 1. The default value is 0.5.
</p>
</li>
<li> <p><code>sv_sigma2_st </code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>C0_st</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>sigma2_st</code>: positive, real number if <code>sv</code> is <code>FALSE</code>, otherwise a vector of positive, real numbers of length <code>N</code>. The default value is 1 or a vector thereof.
</p>
</li>
<li> <p><code>h0_st</code>: real number. The default value is 0.
</p>
</li>
<li> <p><code>lambda_0_st</code> vector of length <code>d</code> containing positive, real numbers. The default value is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>rho_st</code>: vector of length <code>d</code> containing real numbers between 0 and <code>b_rho</code>. The default value is <code>rep(max(0.1, hyperprior_param$b_rho - 0.1), d)</code>.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>For details concerning the algorithms please refer to the papers by Bitto and Frühwirth-Schnatter (2019),
Cadonna et al. (2020) and Knaus and Frühwirth-Schnatter (2023).
For more details on the package and the usage of the functions, see Knaus et al. (2021).
</p>


<h3>Value</h3>

<p>The value returned is a list object of class <code>shrinkTVP</code> containing
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p><code>list</code> object containing an <code>mcmc.tvp</code> object for the parameter draws from the posterior distribution of the centered
states, one for each covariate. In the case that there is only one covariate, this becomes just a single <code>mcmc.tvp</code> object.</p>
</td></tr>
<tr><td><code>beta_mean</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of beta_mean.</p>
</td></tr>
<tr><td><code>theta_sr</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of the square root of theta.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of tau2.</p>
</td></tr>
<tr><td><code>xi2</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of xi2.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p><code>list</code> object containing an <code>mcmc.tvp</code> object for the parameter draws from the posterior distribution of psi,
one for each covariate. In the case that there is only one covariate, this becomes just a single <code>mcmc.tvp</code> object.</p>
</td></tr>
<tr><td><code>lambda_p</code></td>
<td>
<p><code>list</code> object containing an <code>mcmc.tvp</code> object for the parameter draws from the posterior distribution of lambda_p,
one for each covariate. In the case that there is only one covariate, this becomes just a single <code>mcmc.tvp</code> object.</p>
</td></tr>
<tr><td><code>kappa_p</code></td>
<td>
<p><em>(optional)</em> <code>list</code> object containing an <code>mcmc.tvp</code> object for the parameter draws from the posterior
distribution of kappa_p, one for each covariate. In the case that there is only one covariate, this becomes just a single <code>mcmc.tvp</code> object.
Not returned if <code>iid</code> is not <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>lambda2</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of lambda2.
Not returned if <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>kappa2</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of kappa2.
Not returned if <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>a_xi</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of a_xi.
Not returned if <code>learn_a_xi</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>a_tau</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of a_tau.
Not returned if <code>learn_a_tau</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>c_xi</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of c_xi.
Not returned if <code>learn_c_xi</code> is <code>FALSE</code> or <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>c_tau</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of c_tau.
Not returned if <code>learn_c_tau</code> is <code>FALSE</code> or <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>lambda2_B</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of lambda2_B.
Not returned if <code>learn_lambda2_B</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>kappa2_B</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of kappa2_B.
Not returned if <code>learn_kappa2_B</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of rho.
Not returned if <code>iid</code> is not <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of <code>sigma2</code>.
If <code>sv</code> is <code>TRUE</code>, <code>sigma2</code> is additionally an <code>mcmc.tvp</code> object.</p>
</td></tr>
<tr><td><code>C0</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of C0.
Not returned if <code>sv</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>sv_mu</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of the mu
parameter for the stochastic volatility model on the errors. Not returned if <code>sv</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>sv_phi</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of the phi
parameter for the stochastic volatility model on the errors. Not returned if <code>sv</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>sv_sigma2</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of the sigma2
parameter for the stochastic volatility model on the errors. Not returned if <code>sv</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>MH_diag</code></td>
<td>
<p><em>(optional)</em> named list containing statistics for assessing MH performance. Not returned if no MH steps are required
or none of them are specified to be adaptive.</p>
</td></tr>
<tr><td><code>internals</code></td>
<td>
<p><code>list</code> object containing two arrays that are required for calculating the LPDS.</p>
</td></tr>
<tr><td><code>priorvals</code></td>
<td>
<p><code>list</code> object containing hyperparameter values of the prior distributions, as specified by the user.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p><code>list</code> object containing the model matrix, model response and formula used.</p>
</td></tr>
<tr><td><code>summaries</code></td>
<td>
<p><code>list</code> object containing a collection of summary statistics of the posterior draws.</p>
</td></tr>
</table>
<p>To display the output, use <code>plot</code> and <code>summary</code>. The <code>summary</code> method displays the specified prior values stored in
<code>priorvals</code> and the posterior summaries stored in <code>summaries</code>, while the <code>plot</code> method calls <code>coda</code>'s <code>plot.mcmc</code>
or the <code>plot.mcmc.tvp</code> method. Furthermore, all functions that can be applied to <code>coda::mcmc</code> objects
(e.g. <code>coda::acfplot</code>) can be applied to all output elements that are <code>coda</code> compatible.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>References</h3>

<p>Bitto, A., &amp; Frühwirth-Schnatter, S. (2019). &quot;Achieving shrinkage in a time-varying parameter model framework.&quot;
<em>Journal of Econometrics</em>, 210(1), 75-97. &lt;doi:10.1016/j.jeconom.2018.11.006&gt;
</p>
<p>Cadonna, A., Frühwirth-Schnatter, S., &amp; Knaus, P. (2020). &quot;Triple the Gamma—A Unifying Shrinkage Prior for Variance and Variable Selection in Sparse State Space and TVP Models.&quot;
<em>Econometrics</em>, 8(2), 20. &lt;doi:10.3390/econometrics8020020&gt;
</p>
<p>Knaus, P., Bitto-Nemling, A., Cadonna, A., &amp; Frühwirth-Schnatter, S. (2021) &quot;Shrinkage in the Time-Varying Parameter Model Framework Using the <code>R</code> Package <code>shrinkTVP</code>.&quot;
<em>Journal of Statistical Software</em> 100(13), 1–32. &lt;doi:10.18637/jss.v100.i13&gt;
</p>
<p>Knaus, P., &amp; Frühwirth-Schnatter, S. (2023). &quot;The Dynamic Triple Gamma Prior as a Shrinkage Process Prior for Time-Varying Parameter Models.&quot; arXiv preprint arXiv:2312.10487. &lt;doi:10.48550/arXiv.2312.10487&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.shrinkTVP">plot.shrinkTVP</a></code>, <code><a href="#topic+plot.mcmc.tvp">plot.mcmc.tvp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(123)
sim &lt;- simTVP(DTG = TRUE, theta = c(0, 1, 0), beta_mean = c(1, 1, 0), rho = 0.95, c_psi = 2)
data &lt;- sim$data

## Example 1, match the true underlying process
res &lt;- shrinkDTVP(y ~ x1 + x2, data = data, c_psi = 2)
# summarize output
summary(res)

## Example 2, dynamic horseshoe
res &lt;- shrinkDTVP(y ~ x1 + x2, data = data)


## Example 3, modify hyperparameters
res &lt;- shrinkDTVP(y ~ x1 + x2, data = data,
                 hyperprior_param = list(a_rho = 1,
                                         alpha_rho = 0.5,
                                         beta_rho = 0.5))



</code></pre>

<hr>
<h2 id='shrinkTVP'>Markov Chain Monte Carlo (MCMC) for time-varying parameter models with shrinkage</h2><span id='topic+shrinkTVP'></span>

<h3>Description</h3>

<p><code>shrinkTVP</code> samples from the joint posterior distribution of the parameters of a time-varying
parameter model with shrinkage, potentially including stochastic volatility (SV), and returns the MCMC draws.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shrinkTVP(
  formula,
  data,
  mod_type = "double",
  niter = 10000,
  nburn = round(niter/2),
  nthin = 1,
  learn_a_xi = TRUE,
  learn_a_tau = TRUE,
  a_xi = 0.1,
  a_tau = 0.1,
  learn_c_xi = TRUE,
  learn_c_tau = TRUE,
  c_xi = 0.1,
  c_tau = 0.1,
  a_eq_c_xi = FALSE,
  a_eq_c_tau = FALSE,
  learn_kappa2_B = TRUE,
  learn_lambda2_B = TRUE,
  kappa2_B = 20,
  lambda2_B = 20,
  hyperprior_param,
  display_progress = TRUE,
  sv = FALSE,
  sv_param,
  MH_tuning,
  starting_vals
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shrinkTVP_+3A_formula">formula</code></td>
<td>
<p>object of class &quot;formula&quot;: a symbolic representation of the model, as in the
function <code>lm</code>. For details, see <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_data">data</code></td>
<td>
<p><em>optional</em> data frame containing the response variable and the covariates. If not found in <code>data</code>,
the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>shrinkTVP</code>
is called. No <code>NA</code>s are allowed in the response variable and the covariates.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_mod_type">mod_type</code></td>
<td>
<p>character string that reads either <code>"triple"</code>, <code>"double"</code> or <code>"ridge"</code>.
Determines whether the triple gamma, double gamma or ridge prior are used for <code>theta_sr</code> and <code>beta_mean</code>.
The default is &quot;double&quot;.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_niter">niter</code></td>
<td>
<p>positive integer, indicating the number of MCMC iterations
to perform, including the burn-in. Has to be larger than or equal to <code>nburn</code> + 2. The default value is 10000.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_nburn">nburn</code></td>
<td>
<p>non-negative integer, indicating the number of iterations discarded
as burn-in. Has to be smaller than or equal to <code>niter</code> - 2. The default value is <code>round(niter / 2)</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_nthin">nthin</code></td>
<td>
<p>positive integer, indicating the degree of thinning to be performed. Every <code>nthin</code> draw is kept and returned.
The default value is 1, implying that every draw is kept.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_learn_a_xi">learn_a_xi</code></td>
<td>
<p>logical value indicating whether to learn a_xi, the spike parameter of the state variances.
Ignored if <code>mod_type</code> is set to <code>"ridge"</code>. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_learn_a_tau">learn_a_tau</code></td>
<td>
<p>logical value indicating whether to learn a_tau, the spike parameter of the mean of the
initial values of the states. Ignored if <code>mod_type</code> is set to <code>"ridge"</code>. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_a_xi">a_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_xi. Ignored if
<code>learn_a_xi</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_a_tau">a_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_tau. Ignored if
<code>learn_a_tau</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_learn_c_xi">learn_c_xi</code></td>
<td>
<p>logical value indicating whether to learn c_xi, the tail parameter of the state variances.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code> or <code>a_eq_c_xi</code> is set to <code>TRUE</code>.
The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_learn_c_tau">learn_c_tau</code></td>
<td>
<p>logical value indicating whether to learn c_tau, the tail parameter of the mean of the
initial values of the states. Ignored if <code>mod_type</code> is not set to <code>"triple"</code> or <code>a_eq_c_tau</code> is set to <code>TRUE</code>.
The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_c_xi">c_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_xi. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code>, <code>mod_type</code> is not set to <code>"triple"</code> or <code>a_eq_c_xi</code> is set to <code>TRUE</code>.
The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_c_tau">c_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_tau. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code>, <code>mod_type</code> is not set to <code>"triple"</code>  or <code>a_eq_c_tau</code> is set to <code>TRUE</code>.
The default value is 0.1.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_a_eq_c_xi">a_eq_c_xi</code></td>
<td>
<p>logical value indicating whether to force <code>a_xi</code> and <code>c_xi</code> to be equal.
If set to <code>TRUE</code>, <code>beta_a_xi</code> and <code>alpha_a_xi</code> are used as the hyperparameters and <code>beta_c_xi</code> and <code>alpha_c_xi</code> are ignored.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_a_eq_c_tau">a_eq_c_tau</code></td>
<td>
<p>logical value indicating whether to force <code>a_tau</code> and <code>c_tau</code> to be equal.
If set to <code>TRUE</code>, <code>beta_a_tau</code> and <code>alpha_a_tau</code> are used as the hyperparameters and <code>beta_c_tau</code> and <code>alpha_c_tau</code> are ignored.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_learn_kappa2_b">learn_kappa2_B</code></td>
<td>
<p>logical value indicating whether to learn kappa2_B, the global level of shrinkage for
the state variances. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_learn_lambda2_b">learn_lambda2_B</code></td>
<td>
<p>logical value indicating whether to learn the lambda2_B parameter,
the global level of shrinkage for the mean of the initial values of the states. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_kappa2_b">kappa2_B</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for kappa2_B. Ignored if
<code>learn_kappa2_B</code> is <code>TRUE</code>. The default value is 20.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_lambda2_b">lambda2_B</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for lambda2_B. Ignored if
<code>learn_lambda2_B</code> is <code>TRUE</code>. The default value is 20.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_hyperprior_param">hyperprior_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values.
Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
All hyperparameter values have to be positive, real numbers. The following hyperparameters can be
supplied:
</p>

<ul>
<li> <p><code>c0</code>: The default value is 2.5.
</p>
</li>
<li> <p><code>g0</code>: The default value is 5.
</p>
</li>
<li> <p><code>G0</code>: The default value is 5 / (2.5 - 1).
</p>
</li>
<li> <p><code>e1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>e2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>alpha_a_xi</code>: The default value is 5.
</p>
</li>
<li> <p><code>alpha_a_tau</code>: The default value is 5.
</p>
</li>
<li> <p><code>beta_a_xi</code>: The default value is 10.
</p>
</li>
<li> <p><code>beta_a_tau</code>: The default value is 10.
</p>
</li>
<li> <p><code>alpha_c_xi</code>: The default value is 5.
</p>
</li>
<li> <p><code>alpha_c_tau</code>: The default value is 5.
</p>
</li>
<li> <p><code>beta_c_xi</code>: The default value is 2.
</p>
</li>
<li> <p><code>beta_c_tau</code>: The default value is 2.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_display_progress">display_progress</code></td>
<td>
<p>logical value indicating whether the progress bar and other informative output should be
displayed. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_sv">sv</code></td>
<td>
<p>logical value indicating whether to use stochastic volatility for the error of the observation
equation. For details please see <code><a href="stochvol.html#topic+stochvol">stochvol</a></code>, in particular <code><a href="stochvol.html#topic+svsample">svsample</a></code>. The default value is
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_sv_param">sv_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values for the stochastic volatility
parameters. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown. Ignored if
<code>sv</code> is <code>FALSE</code>. The following elements can be supplied:
</p>

<ul>
<li> <p><code>Bsigma_sv</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a0_sv</code>: positive, real number. The default value is 5.
</p>
</li>
<li> <p><code>b0_sv</code>: positive, real number. The default value is 1.5.
</p>
</li>
<li> <p><code>bmu</code>: real number. The default value is 0.
</p>
</li>
<li> <p><code>Bmu</code>: real number. larger than 0. The default value is 1.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_mh_tuning">MH_tuning</code></td>
<td>
<p><em>optional</em> named list containing values used to tune the MH steps for <code>a_xi</code>, <code>a_tau</code>,
<code>c_xi</code>, and <code>c_tau</code>. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
The arguments for <code>a_xi</code>(<code>a_tau</code>) are only used if <code>learn_a_xi</code>(<code>learn_a_tau</code>)
is set to <code>TRUE</code> and <code>mod_type</code> is not equal to <code>"ridge"</code>. The arguments for <code>c_xi</code>(<code>c_tau</code>) are only
used if <code>learn_c_xi</code>(<code>learn_c_tau</code>) is set to <code>TRUE</code> and <code>mod_type</code> is equal to <code>"triple"</code>. Arguments ending in &quot;adaptive&quot; are
logical values indicating whether or not to make the MH step for the respective parameter adaptive. Arguments ending in &quot;tuning_par&quot; serve two different purposes.
If the respective MH step is not set to be adaptive, it acts as the standard deviation of the proposal distribution. If the respective MH step
is set to be adaptive, it acts as the initial standard deviation. Arguments ending in &quot;target_rate&quot; define the acceptance rate the algorithm aims to achieve.
Arguments ending in &quot;max_adapt&quot; set the maximum value by which the logarithm of the standard deviation of the proposal distribution is adjusted. Finally,
arguments ending in &quot;batch_size&quot; set the batch size after which the standard deviation of the proposal distribution is adjusted.
The following elements can be supplied:
</p>

<ul>
<li> <p><code>a_xi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_xi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_xi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_xi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_xi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>a_tau_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_tau_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_tau_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_tau_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_tau_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>c_xi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_xi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>c_xi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>c_xi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>c_xi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>c_tau_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_tau_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>c_tau_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>c_tau_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>c_tau_batch_size</code>: positive integer. The default value is 50.
</p>
</li></ul>
</td></tr>
<tr><td><code id="shrinkTVP_+3A_starting_vals">starting_vals</code></td>
<td>
<p><em>optional</em> named list containing the values at which the MCMC algorithm will be initialized. In the
following <code>d</code> refers to the number of covariates, including the intercept and expanded factors.
Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown. The following elements can be supplied:
</p>

<ul>
<li> <p><code>beta_mean_st</code>: vector of length <code>d</code> containing single numbers. The default is <code>rep(0, d)</code>.
</p>
</li>
<li> <p><code>theta_sr_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>tau2_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>xi2_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>kappa2_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>lambda2_st</code>: vector of length <code>d</code> containing single, positive numbers. The default is <code>rep(1, d)</code>.
</p>
</li>
<li> <p><code>kappa2_B_st</code>: positive, real number. The default value is 20.
</p>
</li>
<li> <p><code>lambda2_B_st</code>: positive, real number. The default value is 20.
</p>
</li>
<li> <p><code>a_xi_st</code>: positive, real number. The default value is 0.1.
</p>
</li>
<li> <p><code>a_tau_st</code>: positive, real number. The default value is 0.1.
</p>
</li>
<li> <p><code>c_xi_st</code>: positive, real number. The default value is 0.1. Note that the prior for <code>c_xi</code> is restricted to (0, 0.5).
</p>
</li>
<li> <p><code>c_tau_st</code>: positive, real number. The default value is 0.1. Note that the prior for <code>c_tau</code> is restricted to (0, 0.5).
</p>
</li>
<li> <p><code>sv_mu_st</code>: real number. The default value is -10.
</p>
</li>
<li> <p><code>sv_phi_st</code>: positive, real number between -1 and 1. The default value is 0.5.
</p>
</li>
<li> <p><code>sv_sigma2_st </code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>C0_st</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>sigma2_st</code>: positive, real number if <code>sv</code> is <code>FALSE</code>, otherwise a vector of positive, real numbers of length <code>N</code>. The default value is 1 or a vector thereof.
</p>
</li>
<li> <p><code>h0_st</code>: real number. The default value is 0.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>For details concerning the algorithms please refer to the papers by Bitto and Frühwirth-Schnatter (2019) and Cadonna et al. (2020).
For more details on the package and the usage of the functions, see Knaus et al. (2021).
</p>


<h3>Value</h3>

<p>The value returned is a list object of class <code>shrinkTVP</code> containing
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p><code>list</code> object containing an <code>mcmc.tvp</code> object for the parameter draws from the posterior distribution of the centered
states, one for each covariate. In the case that there is only one covariate, this becomes just a single <code>mcmc.tvp</code> object.</p>
</td></tr>
<tr><td><code>beta_mean</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of beta_mean.</p>
</td></tr>
<tr><td><code>theta_sr</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of the square root of theta.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of tau2.</p>
</td></tr>
<tr><td><code>xi2</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of xi2.</p>
</td></tr>
<tr><td><code>lambda2</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of lambda2.
Not returned if <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>kappa2</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of kappa2.
Not returned if <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>a_xi</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of a_xi.
Not returned if <code>learn_a_xi</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>a_tau</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of a_tau.
Not returned if <code>learn_a_tau</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>c_xi</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of c_xi.
Not returned if <code>learn_c_xi</code> is <code>FALSE</code> or <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>c_tau</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of c_tau.
Not returned if <code>learn_c_tau</code> is <code>FALSE</code> or <code>mod_type</code> is not <code>"triple"</code>.</p>
</td></tr>
<tr><td><code>lambda2_B</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of lambda2_B.
Not returned if <code>learn_lambda2_B</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>kappa2_B</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of kappa2_B.
Not returned if <code>learn_kappa2_B</code> is <code>FALSE</code> or <code>mod_type</code> is <code>"ridge"</code>.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of <code>sigma2</code>.
If <code>sv</code> is <code>TRUE</code>, <code>sigma2</code> is additionally an <code>mcmc.tvp</code> object.</p>
</td></tr>
<tr><td><code>C0</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of C0.
Not returned if <code>sv</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>sv_mu</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of the mu
parameter for the stochastic volatility model on the errors. Not returned if <code>sv</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>sv_phi</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of the phi
parameter for the stochastic volatility model on the errors. Not returned if <code>sv</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>sv_sigma2</code></td>
<td>
<p><em>(optional)</em> <code>mcmc</code> object containing the parameter draws from the posterior distribution of the sigma2
parameter for the stochastic volatility model on the errors. Not returned if <code>sv</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>MH_diag</code></td>
<td>
<p><em>(optional)</em> named list containing statistics for assessing MH performance. Not returned if no MH steps are required
or none of them are specified to be adaptive.</p>
</td></tr>
<tr><td><code>internals</code></td>
<td>
<p><code>list</code> object containing two arrays that are required for calculating the LPDS.</p>
</td></tr>
<tr><td><code>priorvals</code></td>
<td>
<p><code>list</code> object containing hyperparameter values of the prior distributions, as specified by the user.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p><code>list</code> object containing the model matrix, model response and formula used.</p>
</td></tr>
<tr><td><code>summaries</code></td>
<td>
<p><code>list</code> object containing a collection of summary statistics of the posterior draws.</p>
</td></tr>
</table>
<p>To display the output, use <code>plot</code> and <code>summary</code>. The <code>summary</code> method displays the specified prior values stored in
<code>priorvals</code> and the posterior summaries stored in <code>summaries</code>, while the <code>plot</code> method calls <code>coda</code>'s <code>plot.mcmc</code>
or the <code>plot.mcmc.tvp</code> method. Furthermore, all functions that can be applied to <code>coda::mcmc</code> objects
(e.g. <code>coda::acfplot</code>) can be applied to all output elements that are <code>coda</code> compatible.
</p>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>References</h3>

<p>Bitto, A., &amp; Frühwirth-Schnatter, S. (2019). &quot;Achieving shrinkage in a time-varying parameter model framework.&quot;
<em>Journal of Econometrics</em>, 210(1), 75-97. &lt;doi:10.1016/j.jeconom.2018.11.006&gt;
</p>
<p>Cadonna, A., Frühwirth-Schnatter, S., &amp; Knaus, P. (2020). &quot;Triple the Gamma—A Unifying Shrinkage Prior for Variance and Variable Selection in Sparse State Space and TVP Models.&quot;
<em>Econometrics</em>, 8(2), 20. &lt;doi:10.3390/econometrics8020020&gt;
</p>
<p>Knaus, P., Bitto-Nemling, A., Cadonna, A., &amp; Frühwirth-Schnatter, S. (2021) &quot;Shrinkage in the Time-Varying Parameter Model Framework Using the <code>R</code> Package <code>shrinkTVP</code>.&quot;
<em>Journal of Statistical Software</em> 100(13), 1–32. &lt;doi:10.18637/jss.v100.i13&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.shrinkTVP">plot.shrinkTVP</a></code>, <code><a href="#topic+plot.mcmc.tvp">plot.mcmc.tvp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Example 1, learn everything
set.seed(123)
sim &lt;- simTVP(theta = c(0.2, 0, 0), beta_mean = c(1.5, -0.3, 0))
data &lt;- sim$data

res &lt;- shrinkTVP(y ~ x1 + x2, data = data)
# summarize output
summary(res)


## Example 2, hierarchical Bayesian Lasso
res &lt;- shrinkTVP(y ~ x1 + x2, data = data,
                learn_a_xi = FALSE, learn_a_tau = FALSE,
                a_xi = 1, a_tau = 1)


## Example 3, non-hierarchical Bayesian Lasso
res &lt;- shrinkTVP(y ~ x1 + x2, data = data,
                learn_a_xi = FALSE, learn_a_tau = FALSE,
                a_xi = 1, a_tau = 1,
                learn_kappa2 = FALSE, learn_lambda2 = FALSE)


## Example 4, adding stochastic volatility
res &lt;- shrinkTVP(y ~ x1 + x2, data = data,
                sv = TRUE)


## Example 4, changing some of the default hyperparameters
res &lt;- shrinkTVP(y ~ x1 + x2, data = data,
                hyperprior_param = list(beta_a_xi = 5,
                                        alpha_a_xi = 10))

## Example 5, using the triple gamma prior
res &lt;- shrinkTVP(y ~ x1 + x2, data = data,
                mod_type = "triple")


</code></pre>

<hr>
<h2 id='simTVP'>Generate synthetic data from a time-varying parameter model</h2><span id='topic+simTVP'></span>

<h3>Description</h3>

<p><code>simTVP</code> generates synthetic data from a time-varying parameter model. The covariates are always
generated i.i.d. from a Normal(0,1) distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simTVP(
  N = 200,
  d = 3,
  sv = FALSE,
  DTG = FALSE,
  sigma2 = 1,
  theta,
  beta_mean,
  sv_mu = 0,
  sv_phi = 0.98,
  sv_sigma2 = 0.2,
  a_psi = 0.5,
  c_psi = 2,
  rho = 0.9
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simTVP_+3A_n">N</code></td>
<td>
<p>integer &gt; 2. Indicates the length of the time series to be
generated. The default value is 200.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_d">d</code></td>
<td>
<p>positive integer. Indicates the number of covariates to simulate.
The default value is 3.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_sv">sv</code></td>
<td>
<p>logical value. If set to <code>TRUE</code>, the data will be generated with
stochastic volatility for the errors of the observation equation using <code><a href="stochvol.html#topic+svsim">svsim</a></code>. The default value is FALSE.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_dtg">DTG</code></td>
<td>
<p>logical value. If set to <code>TRUE</code>, the betas will be generated as dynamic triple gamma processes.
The default value is FALSE.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_sigma2">sigma2</code></td>
<td>
<p>positive real number. Determines the variance of the errors of the observation
equation. Ignored if sv is <code>TRUE</code>. The default value is 1.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_theta">theta</code></td>
<td>
<p><em>(optional)</em> vector containing positive real numbers. If supplied, these determine the variances of the
innovations of the state equation. Otherwise, the elements of <code>theta</code> are generated from a X^2(1) distribution.
Has to be of length <code>d</code> or an error will be thrown.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_beta_mean">beta_mean</code></td>
<td>
<p><em>(optional)</em> vector containing real numbers. If supplied, these determine the mean of the
initial value of the state equation. Otherwise, the elements of <code>beta_mean</code> are generated from a Normal(0,1) distribution.
Has to be of length <code>d</code> or an error will be thrown.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_sv_mu">sv_mu</code></td>
<td>
<p>real number. Determines the mean of the logarithm of the volatility. Ignored if <code>sv</code> is <code>FALSE</code>.
The default value is 0.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_sv_phi">sv_phi</code></td>
<td>
<p>real number between -1 and 1. Determines the persistence of the SV process. Ignored if <code>sv</code> is <code>FALSE</code>.
The default value is 0.98.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_sv_sigma2">sv_sigma2</code></td>
<td>
<p>positive, real number. Determines the variance of the innovations of the logarithm of the volatility.
Ignored if <code>sv</code> is <code>FALSE</code>. The default value is 0.2.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_a_psi">a_psi</code></td>
<td>
<p>positive, real number. Determines the pole parameter of the dynamic triple gamma process.
Ignored if <code>DTG</code> is <code>FALSE</code>. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_c_psi">c_psi</code></td>
<td>
<p>positive, real number. Determines the tail parameter of the dynamic triple gamma process.
Ignored if <code>DTG</code> is <code>FALSE</code>. The default value is 2.</p>
</td></tr>
<tr><td><code id="simTVP_+3A_rho">rho</code></td>
<td>
<p>real number between 0 and 1. Determines the persistence of the dynamic triple gamma process.
Ignored if <code>DTG</code> is <code>FALSE</code>. The default value is 0.9</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is a list object containing:
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>data frame that holds the simulated data.</p>
</td></tr>
<tr><td><code>true_vals</code></td>
<td>
<p>list object containing:
</p>

<ul>
<li> <p><code>theta</code>: the values of theta used in the data generating process.
</p>
</li>
<li> <p><code>beta_mean</code>: the values of beta_mean used in the data generating process.
</p>
</li>
<li> <p><code>beta</code>: the true paths of beta used for the data generating process.
</p>
</li>
<li> <p><code>sigma2</code>: the value(s) of sigma2 used in the data generating process.
</p>
</li>
<li> <p><code>lambda_p</code>: the true paths of lambda_p used for the data generating process. Not returned if DTG is <code>FALSE</code>.
</p>
</li>
<li> <p><code>lambda_p_0</code>: the values of lambda_p_0 used for the data generating process. Not returned if DTG is <code>FALSE</code>.
</p>
</li>
<li> <p><code>kappa_p</code>: the true paths of kappa_p used for the data generating process. Not returned if DTG is <code>FALSE</code>.
</p>
</li>
<li> <p><code>psi</code>: the true paths of psi used for the data generating process. Not returned if DTG is <code>FALSE</code>.
</p>
</li></ul>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a time series of length 300
res &lt;- simTVP(N = 300)

# Extract the generated data
data &lt;- res$data

# Now with stochastic volatility
res_sv &lt;- simTVP(N = 300, sv = TRUE)

# Now with dynamic triple gamma process
res_DTG &lt;- simTVP(N = 300, DTG = TRUE, c_psi = 1)

</code></pre>

<hr>
<h2 id='updateTVP'>One step update version of <code><a href="#topic+shrinkTVP">shrinkTVP</a></code> with minimal overhead</h2><span id='topic+updateTVP'></span>

<h3>Description</h3>

<p><code>updateTVP</code> draws a single sample from the joint posterior distribution of the parameters of a time-varying
parameter model with shrinkage potentially including stochastic volatility (SV). It performs <b>no input checks</b> and must
therefore be used with caution. It is designed to be used in a modular fashion within other samplers, where speed is important.
As such, no draws are saved and must be stored manually if the user wants to analyze them further.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateTVP(
  y,
  x,
  curr_draws,
  mod_type = "double",
  learn_a_xi = TRUE,
  learn_a_tau = TRUE,
  a_xi = 0.1,
  a_tau = 0.1,
  learn_c_xi = TRUE,
  learn_c_tau = TRUE,
  c_xi = 0.1,
  c_tau = 0.1,
  a_eq_c_xi = FALSE,
  a_eq_c_tau = FALSE,
  learn_kappa2_B = TRUE,
  learn_lambda2_B = TRUE,
  kappa2_B = 20,
  lambda2_B = 20,
  hyperprior_param,
  sv = FALSE,
  sv_param,
  MH_tuning
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateTVP_+3A_y">y</code></td>
<td>
<p>vector of length N containing the response variable.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_x">x</code></td>
<td>
<p>matrix of dimension Nxd containing the covariates.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_curr_draws">curr_draws</code></td>
<td>
<p>named list containing all the current draws from the joint posterior of the parameters.
Not all values are required for all model setups. The following elements can be supplied:
</p>

<ul>
<li> <p><code>beta_mean_st</code>: vector of length <code>d</code> containing single numbers.
</p>
</li>
<li> <p><code>theta_sr_st</code>: vector of length <code>d</code> containing single, positive numbers.
</p>
</li>
<li> <p><code>tau2_st</code>: <em>optional</em> vector of length <code>d</code> containing single, positive numbers. Not required if <code>mod_type</code> is <code>"ridge"</code>.
</p>
</li>
<li> <p><code>xi2_st</code>: <em>optional</em> vector of length <code>d</code> containing single, positive numbers. Not required if <code>mod_type</code> is <code>"ridge"</code>.
</p>
</li>
<li> <p><code>kappa2_st</code>: <em>optional</em> vector of length <code>d</code> containing single, positive numbers. Only required if <code>mod_type</code> is <code>"triple"</code>.
</p>
</li>
<li> <p><code>lambda2_st</code>: <em>optional</em> vector of length <code>d</code> containing single, positive numbers. Only required if <code>mod_type</code> is <code>"triple"</code>.
</p>
</li>
<li> <p><code>kappa2_B_st</code>: <em>optional</em> positive, real number. Not required if <code>mod_type</code> is <code>"ridge"</code> or <code>learn_kappa2_B</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>lambda2_B_st</code>: <em>optional</em> positive, real number. Not required if <code>mod_type</code> is <code>"ridge"</code> or <code>learn_lambda2_B</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>a_xi_st</code>: <em>optional</em> positive, real number. Not required if <code>mod_type</code> is <code>"ridge"</code> or <code>learn_a_xi</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>a_tau_st</code>: <em>optional</em> positive, real number. Not required if <code>mod_type</code> is <code>"ridge"</code> or <code>learn_a_tau</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>c_xi_st</code>: <em>optional</em> positive, real number. Note that the prior for <code>c_xi</code> is restricted to (0, 0.5).
Not required if <code>mod_type</code> is not <code>"triple"</code> or <code>learn_c_xi</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>c_tau_st</code>: <em>optional</em> positive, real number.  Note that the prior for <code>c_tau</code> is restricted to (0, 0.5).
Not required if <code>mod_type</code> is not <code>"triple"</code> or <code>learn_c_tau</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>sv_mu_st</code>: <em>optional</em> real number. Not required if <code>sv</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>sv_phi_st</code>: <em>optional</em> positive, real number between -1 and 1. Not required if <code>sv</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>sv_sigma2_st </code>: <em>optional</em> positive, real number. Not required if <code>sv</code> is <code>FALSE</code>.
</p>
</li>
<li> <p><code>C0_st</code>: <em>optional</em> positive, real number. Not required if <code>sv</code> is <code>TRUE</code>.
</p>
</li>
<li> <p><code>sigma2_st</code>: positive, real number if <code>sv</code> is <code>FALSE</code>, otherwise a vector of positive, real numbers of length <code>N</code>. The default value is 1 or a vector thereof.
</p>
</li>
<li> <p><code>h0_st</code>: <em>optional</em> real number. The default value is 0. Not required if <code>sv</code> is <code>FALSE</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="updateTVP_+3A_mod_type">mod_type</code></td>
<td>
<p>character string that reads either <code>"triple"</code>, <code>"double"</code> or <code>"ridge"</code>.
Determines whether the triple gamma, double gamma or ridge prior are used for <code>theta_sr</code> and <code>beta_mean</code>.
The default is &quot;double&quot;.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_learn_a_xi">learn_a_xi</code></td>
<td>
<p>logical value indicating whether to learn a_xi, the spike parameter of the state variances.
Ignored if <code>mod_type</code> is set to <code>"ridge"</code>. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_learn_a_tau">learn_a_tau</code></td>
<td>
<p>logical value indicating whether to learn a_tau, the spike parameter of the mean of the
initial values of the states. Ignored if <code>mod_type</code> is set to <code>"ridge"</code>. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_a_xi">a_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_xi. Ignored if
<code>learn_a_xi</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_a_tau">a_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for a_tau. Ignored if
<code>learn_a_tau</code> is <code>TRUE</code> or <code>mod_type</code> is set to <code>"ridge"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_learn_c_xi">learn_c_xi</code></td>
<td>
<p>logical value indicating whether to learn c_xi, the tail parameter of the state variances.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_learn_c_tau">learn_c_tau</code></td>
<td>
<p>logical value indicating whether to learn c_tau, the tail parameter of the mean of the
initial values of the states. Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_c_xi">c_xi</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_xi. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code> or <code>mod_type</code> is not set to <code>"triple"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_c_tau">c_tau</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for c_tau. Ignored if
<code>learn_c_xi</code> is <code>TRUE</code> or <code>mod_type</code> is not set to <code>"triple"</code>. The default value is 0.1.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_a_eq_c_xi">a_eq_c_xi</code></td>
<td>
<p>logical value indicating whether to force <code>a_xi</code> and <code>c_xi</code> to be equal.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_a_eq_c_tau">a_eq_c_tau</code></td>
<td>
<p>logical value indicating whether to force <code>a_tau</code> and <code>c_tau</code> to be equal.
Ignored if <code>mod_type</code> is not set to <code>"triple"</code>. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_learn_kappa2_b">learn_kappa2_B</code></td>
<td>
<p>logical value indicating whether to learn kappa2_B, the global level of shrinkage for
the state variances. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_learn_lambda2_b">learn_lambda2_B</code></td>
<td>
<p>logical value indicating whether to learn the lambda2_B parameter,
the global level of shrinkage for the mean of the initial values of the states. The default value is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_kappa2_b">kappa2_B</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for kappa2_B. Ignored if
<code>learn_kappa2_B</code> is <code>TRUE</code>. The default value is 20.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_lambda2_b">lambda2_B</code></td>
<td>
<p>positive, real number, indicating the (fixed) value for lambda2_B. Ignored if
<code>learn_lambda2_B</code> is <code>TRUE</code>. The default value is 20.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_hyperprior_param">hyperprior_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values.
Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
All hyperparameter values have to be positive, real numbers. The following hyperparameters can be
supplied:
</p>

<ul>
<li> <p><code>c0</code>: The default value is 2.5.
</p>
</li>
<li> <p><code>g0</code>: The default value is 5.
</p>
</li>
<li> <p><code>G0</code>: The default value is 5 / (2.5 - 1).
</p>
</li>
<li> <p><code>e1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>e2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d1</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>d2</code>: The default value is 0.001.
</p>
</li>
<li> <p><code>beta_a_xi</code>: The default value is 10.
</p>
</li>
<li> <p><code>beta_a_tau</code>: The default value is 10.
</p>
</li>
<li> <p><code>alpha_a_xi</code>: The default value is 5.
</p>
</li>
<li> <p><code>alpha_a_tau</code>: The default value is 5.
</p>
</li>
<li> <p><code>beta_c_xi</code>: The default value is 2.
</p>
</li>
<li> <p><code>alpha_c_xi</code>: The default value is 5.
</p>
</li>
<li> <p><code>beta_c_tau</code>: The default value is 2.
</p>
</li>
<li> <p><code>alpha_c_tau</code>: The default value is 5.
</p>
</li></ul>
</td></tr>
<tr><td><code id="updateTVP_+3A_sv">sv</code></td>
<td>
<p>logical value indicating whether to use stochastic volatility for the error of the observation
equation. For details please see <code><a href="stochvol.html#topic+stochvol">stochvol</a></code>, in particular <code><a href="stochvol.html#topic+svsample">svsample</a></code>. The default value is
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="updateTVP_+3A_sv_param">sv_param</code></td>
<td>
<p><em>optional</em> named list containing hyperparameter values for the stochastic volatility
parameters. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown. Ignored if
<code>sv</code> is <code>FALSE</code>. The following elements can be supplied:
</p>

<ul>
<li> <p><code>Bsigma_sv</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a0_sv</code>: positive, real number. The default value is 5.
</p>
</li>
<li> <p><code>b0_sv</code>: positive, real number. The default value is 1.5.
</p>
</li>
<li> <p><code>bmu</code>: real number. The default value is 0.
</p>
</li>
<li> <p><code>Bmu</code>: real number. larger than 0. The default value is 1.
</p>
</li></ul>
</td></tr>
<tr><td><code id="updateTVP_+3A_mh_tuning">MH_tuning</code></td>
<td>
<p><em>optional</em> named list containing values used to tune the MH steps for <code>a_xi</code>, <code>a_tau</code>,
<code>c_xi</code> and <code>c_tau</code>. Not all have to be supplied, with those missing being replaced by the default values.
Any list elements that are misnamed will be ignored and a warning will be thrown.
The arguments for <code>a_xi</code>(<code>a_tau</code>) are only used if <code>learn_a_xi</code>(<code>learn_a_tau</code>)
is set to <code>TRUE</code> and <code>mod_type</code> is not equal to <code>"ridge"</code>. The arguments for <code>c_xi</code>(<code>c_tau</code>) are only
used if <code>learn_c_xi</code>(<code>learn_c_tau</code>) is set to <code>TRUE</code> and <code>mod_type</code> is equal to <code>"triple"</code>. Arguments ending in &quot;adaptive&quot; are
logical values indicating whether or not to make the MH step for the respective parameter adaptive. Arguments ending in &quot;tuning_par&quot; serve two different purposes.
If the respective MH step is not set to be adaptive, it acts as the standard deviation of the proposal distribution. If the respective MH step
is set to be adaptive, it acts as the initial standard deviation. Arguments ending in &quot;target_rate&quot; define the acceptance rate the algorithm aims to achieve.
Arguments ending in &quot;max_adapt&quot; set the maximum value by which the logarithm of the standard deviation of the proposal distribution is adjusted. Finally,
arguments ending in &quot;batch_size&quot; set the batch size after which the standard deviation of the proposal distribution is adjusted.
The following elements can be supplied:
</p>

<ul>
<li> <p><code>a_xi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_xi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_xi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_xi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_xi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>a_tau_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>a_tau_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>a_tau_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>a_tau_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>a_tau_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>c_xi_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_xi_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>c_xi_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>c_xi_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>c_xi_batch_size</code>: positive integer. The default value is 50.
</p>
</li>
<li> <p><code>c_tau_adaptive</code>: logical value. The default is <code>TRUE</code>.
</p>
</li>
<li> <p><code>c_tau_tuning_par</code>: positive, real number. The default value is 1.
</p>
</li>
<li> <p><code>c_tau_target_rate</code>: positive, real number, between 0 and 1. The default value is 0.44.
</p>
</li>
<li> <p><code>c_tau_max_adapt</code>: positive, real number. The default value is 0.01.
</p>
</li>
<li> <p><code>c_tau_batch_size</code>: positive integer. The default value is 50.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is a named list object which can be immediately used as the <code>curr_draws</code> argument
for another draw from the posterior with <code>updateTVP</code>. Note that, depending on the model setup, some elements may be matrices of dimension zero.
It contains the following elements:
</p>
<table role = "presentation">
<tr><td><code>beta_st</code></td>
<td>
<p>dx(N + 1) matrix containing the current draw from the posterior distribution of beta.</p>
</td></tr>
<tr><td><code>beta_mean_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of beta_mean.</p>
</td></tr>
<tr><td><code>theta_sr_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of the square root of theta.</p>
</td></tr>
<tr><td><code>tau2_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of tau2.</p>
</td></tr>
<tr><td><code>xi2_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of xi2.</p>
</td></tr>
<tr><td><code>lambda2_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of lambda2.</p>
</td></tr>
<tr><td><code>kappa2_st</code></td>
<td>
<p>dx1 matrix containing the current draws from the posterior distribution of kappa2.</p>
</td></tr>
<tr><td><code>a_xi_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of a_xi.</p>
</td></tr>
<tr><td><code>a_tau_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of a_tau.</p>
</td></tr>
<tr><td><code>c_xi_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of c_xi.</p>
</td></tr>
<tr><td><code>c_tau_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of c_tau.</p>
</td></tr>
<tr><td><code>lambda2_B_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of lambda2_B.</p>
</td></tr>
<tr><td><code>kappa2_B_st</code></td>
<td>
<p><code>mcmc</code> object containing the parameter draws from the posterior distribution of kappa2_B.</p>
</td></tr>
<tr><td><code>sigma2_st</code></td>
<td>
<p>number if <code>sv</code> is <code>FALSE</code>, otherwise a vector of length <code>N</code> containing the current draws from the posterior distribution of sigma2.</p>
</td></tr>
<tr><td><code>C0_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of C0.</p>
</td></tr>
<tr><td><code>sv_mu_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of the mu parameter for the stochastic volatility model on the errors.</p>
</td></tr>
<tr><td><code>sv_phi_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of the phi parameter for the stochastic volatility model on the errors.</p>
</td></tr>
<tr><td><code>sv_sigma2_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of the sigma2 parameter for the stochastic volatility model on the errors.</p>
</td></tr>
<tr><td><code>h0_st</code></td>
<td>
<p>number representing the current draw from the posterior distribution of the h0 parameter for the stochastic volatility model on the errors.</p>
</td></tr>
<tr><td><code>internals</code></td>
<td>
<p><code>list</code> object containing two arrays that are required for calculating the LPDS and bookkeeping objects required for the adaptive MH algorithm to work.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Peter Knaus <a href="mailto:peter.knaus@wu.ac.at">peter.knaus@wu.ac.at</a>
</p>


<h3>References</h3>

<p>Bitto, A., &amp; Frühwirth-Schnatter, S. (2019). &quot;Achieving shrinkage in a time-varying parameter model framework.&quot;
<em>Journal of Econometrics</em>, 210(1), 75-97. &lt;doi:10.1016/j.jeconom.2018.11.006&gt;
</p>
<p>Cadonna, A., Frühwirth-Schnatter, S., &amp; Knaus, P. (2020). &quot;Triple the Gamma—A Unifying Shrinkage Prior for Variance and Variable Selection in Sparse State Space and TVP Models.&quot;
<em>Econometrics</em>, 8(2), 20. &lt;doi:10.3390/econometrics8020020&gt;
</p>
<p>Knaus, P., Bitto-Nemling, A., Cadonna, A., &amp; Frühwirth-Schnatter, S. (2021) &quot;Shrinkage in the Time-Varying Parameter Model Framework Using the <code>R</code> Package <code>shrinkTVP</code>.&quot;
<em>Journal of Statistical Software</em> 100(13), 1–32.&lt;doi:10.18637/jss.v100.i13&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
sim &lt;- simTVP()
y &lt;- sim$data$y
x &lt;- as.matrix(sim$data[,2:4])

# Create starting values
d &lt;- ncol(x)
curr_draws &lt;- list(beta_mean_st = rep(0, d),
                   theta_sr_st = rep(1, d),
                   tau2_st = rep(1, d),
                   xi2_st = rep(1, d),
                   lambda2_st = rep(1, d),
                   kappa2_B_st = 20,
                   lambda2_B_st = 20,
                   a_xi_st = 0.1,
                   a_tau_st = 0.1,
                   c_tau_st = 0.1,
                   sv_mu_st = -10,
                   sv_phi_st = 0.5,
                   sv_sigma2_st = 1,
                   C0_st = 1,
                   sigma2_st = 1,
                   h0_st = 0)

# Run the algorithm for 1000 iterations
# Note that curr_draws is always re-written and immediately re-used
for (i in 1:1000){
  curr_draws &lt;- updateTVP(y, x, curr_draws)
}


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
