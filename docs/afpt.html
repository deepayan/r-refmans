<!DOCTYPE html><html lang="en"><head><title>Help for package afpt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {afpt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#air2ground'>
<p>Compute groundspeed</p></a></li>
<li><a href='#altitude2density'><p>Compute density in International Standard Atmopshere</p></a></li>
<li><a href='#amplitude'><p>Flapping flight optimal amplitude</p></a></li>
<li><a href='#Bird'><p>Bird description</p></a></li>
<li><a href='#climbing_birds'>
<p>Climbing birds</p></a></li>
<li><a href='#computeAvailablePower'><p> Compute available power</p></a></li>
<li><a href='#computeBodyFrontalArea'><p>Body frontal area from scaling relation</p></a></li>
<li><a href='#computeChemicalPower'><p>Convert mechanical power to chemical power</p></a></li>
<li><a href='#computeFlappingPower'><p>Calculate aerodynamic power flapping flight</p></a></li>
<li><a href='#computeFlightPerformance'><p>Compute characteristics of a power curve</p></a></li>
<li><a href='#fDfPfunctions'><p> Coefficient for thrust dependency of drag and power factors</p></a></li>
<li><a href='#findMaximumClimbRate'><p>Find maximum climb rate</p></a></li>
<li><a href='#findMaximumPowerSpeed'><p>Finds speed for which power required equals maximum available power</p></a></li>
<li><a href='#findMaximumRangeSpeed'><p>Find maximum range speed</p></a></li>
<li><a href='#findMinimumPowerSpeed'><p>Find speed for minimum power</p></a></li>
<li><a href='#findMinimumTimeSpeed'><p>Find speed for migration time minimization</p></a></li>
<li><a href='#PowerToFroMechChem'>
<p>Convert between mechanical and chemical power</p></a></li>
<li><a href='#reducedFrequency'>
<p>Function to compute reduced frequency</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Tools for Modelling of Animal Flight Performance</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-03</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows estimation and modelling of flight costs in animal (vertebrate) flight,
    implementing the aerodynamic power model described in Klein Heerenbrink et al.
    (2015) &lt;<a href="https://doi.org/10.1098%2Frspa.2014.0952">doi:10.1098/rspa.2014.0952</a>&gt;. Taking inspiration from the program
    'Flight', developed by Colin Pennycuick (Pennycuick (2008) "Modelling the flying
    bird". Amsterdam: Elsevier. ISBN 0-19-857721-4), flight performance is estimated
    based on basic morphological measurements such as body mass, wingspan and wing
    area. 'afpt' can be used to make predictions on how animals should adjust their
    flight behaviour and wingbeat kinematics to varying flight conditions.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/MarcoKlH/afpt-r/">https://github.com/MarcoKlH/afpt-r/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/MarcoKlH/afpt-r/issues">https://github.com/MarcoKlH/afpt-r/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-03 11:37:57 UTC; marcokleinheerenbrink</td>
</tr>
<tr>
<td>Author:</td>
<td>Marco KleinHeerenbrink
    <a href="https://orcid.org/0000-0001-8172-8121"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Anders Hedenström <a href="https://orcid.org/0000-0002-1757-0945"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marco KleinHeerenbrink &lt;animalflightperformancetools@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-03 14:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='air2ground'>
Compute groundspeed</h2><span id='topic+air2ground'></span>

<h3>Description</h3>

<p>Computes groundspeed from airspeed and wind.</p>


<h3>Usage</h3>

<pre><code class='language-R'>air2ground(airSpeed, windSpeed = 0, windDir = 0, climbAngle = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="air2ground_+3A_airspeed">airSpeed</code></td>
<td>

<p>airspeed</p>
</td></tr>
<tr><td><code id="air2ground_+3A_windspeed">windSpeed</code></td>
<td>

<p>windspeed</p>
</td></tr>
<tr><td><code id="air2ground_+3A_winddir">windDir</code></td>
<td>

<p>wind direction relative to (intended) track direction in degrees</p>
</td></tr>
<tr><td><code id="air2ground_+3A_climbangle">climbAngle</code></td>
<td>

<p>climb angle in degrees</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>driftAngle</code></td>
<td>
<p>Angle between airspeed and groundspeed</p>
</td></tr>
<tr><td><code>groundSpeed</code></td>
<td>
<p>Speed over ground</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink
</p>

<hr>
<h2 id='altitude2density'>Compute density in International Standard Atmopshere</h2><span id='topic+altitude2density'></span>

<h3>Description</h3>

<p>This function computes the air density at a specified altitude in the Troposphere of the International Standard Atmosphere.</p>


<h3>Usage</h3>

<pre><code class='language-R'>altitude2density(altitude = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="altitude2density_+3A_altitude">altitude</code></td>
<td>
<p> (geopotential) altitude in meters above sealevel. </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">\rho = \rho_0 (1 + a \frac{h}{T_0}) ^ {-\frac{g_0}{Ra}+1}</code>
with <code class="reqn">\rho_0</code> = 1.225 kg/m3, <code class="reqn">a</code> = -0.0065 K/m, <code class="reqn">h</code> geopotential altitude in meters, <code class="reqn">g_0</code> = 9.80665 m/s2, and <code class="reqn">R</code> = 287.1 J/Kg/K.
</p>


<h3>Value</h3>

<p>Numerical value or array for the density in kg/m3
</p>


<h3>Author(s)</h3>

<p>M. Klein Heerenbrink
</p>


<h3>References</h3>

<p><a href="http://ntrs.nasa.gov/archive/nasa/casi.ntrs.nasa.gov/19770009539_1977009539.pdf">U.S. Standard Atmosphere, 1976, U.S. Government Printing Office, Washington, D.C.</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>altitude &lt;- seq(0,3000,100) # meters above sealevel
density &lt;- altitude2density(altitude)

</code></pre>

<hr>
<h2 id='amplitude'>Flapping flight optimal amplitude</h2><span id='topic+amplitude'></span>

<h3>Description</h3>

<p>This function returns the angular peak amplitude of the flapping motion, optimized for minimum induced power for prescribed reduced frequency (kf), strokeplane angle (phi), and thrust-to-lift ratio (TL).</p>


<h3>Usage</h3>

<pre><code class='language-R'>amplitude(kf, phi, TL)</code></pre>


<h3>Arguments</h3>

<p>Using <code class="reqn">f</code> for wingbeat frequency, <code class="reqn">b</code> for wingspan, and <code class="reqn">U</code> for air speed:
</p>
<table role = "presentation">
<tr><td><code id="amplitude_+3A_kf">kf</code></td>
<td>
<p>reduced frequency (<code class="reqn">k_f = \frac{2 \pi f b}{U}</code>); valid range between 1 and 6</p>
</td></tr>
<tr><td><code id="amplitude_+3A_phi">phi</code></td>
<td>
<p>strokeplane angle in radians; valid range between 0 and 0.87 rad (50 deg)</p>
</td></tr>
<tr><td><code id="amplitude_+3A_tl">TL</code></td>
<td>
<p>thrust requirement or the trust-to-lift ratio; valid range between 0 and 0.3</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Angular peak amplitude of the flapping motion in degrees.
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink</p>


<h3>References</h3>

<p>Klein Heerenbrink, M., Johansson, L. C. and Hedenström, A. 2015 Power of the wingbeat: modelling the effects of flapping wings in vertebrate flight. <em>Proc. R. Soc. A</em> <b>471</b>, 2177 <a href="https://doi.org/10.1098/rspa.2014.0952">doi:10.1098/rspa.2014.0952</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## reduced frequency
kf &lt;- 2*pi*4/10 # 4 Hz at 10 m/s for 1m wing span
## strokeplane angle
phi &lt;- 20*pi/180 # 20 degrees
## thrust ratio
TL &lt;- 0.2
## wingbeat amplitude
theta &lt;- amplitude(kf,phi,TL)
print(theta)
#   [1] 49.17679
</code></pre>

<hr>
<h2 id='Bird'>Bird description</h2><span id='topic+Bird'></span><span id='topic+Bird.default'></span>

<h3>Description</h3>

<p>This function creates a bird description object, which is basically just a list with predefined variable names. It is named a bird object, but could also contain a description of a bat or insect. Minimal input required to construct a bird are body mass, wing span and wing area (or wing aspect ratio). Other required variables will then be given default values, or they will be estimated from allometric relations from literature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bird(massTotal, wingSpan, wingArea, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Bird_+3A_masstotal">massTotal</code></td>
<td>
<p> Total mass that needs to be lifted in flight in kg </p>
</td></tr>
<tr><td><code id="Bird_+3A_wingspan">wingSpan</code></td>
<td>
<p> The maximum distance between the wingtips in meters </p>
</td></tr>
<tr><td><code id="Bird_+3A_wingarea">wingArea</code></td>
<td>
<p> The area of the fully stretched wings including the root area (left wing, right wing and area in between the wing roots) </p>
</td></tr>
<tr><td><code id="Bird_+3A_...">...</code></td>
<td>
<p> Any other properties of a valid bird object (see details) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function sets up a list of properties of a bird. This definition of the bird is then used by the other functions in the package to estimate flight performance. At least three properties need to be specified: <code>massTotal</code>, <code>wingSpan</code> and <code>wingArea</code>. Either <code>wingSpan</code> or <code>wingArea</code> could be replaced by <code>aspectRatio</code>; the missing variable will then be computed. If no other properties are specified, default values will be used. Wingspan and wingarea should be measured from the maximally stretched out wing as described in <cite>Pennycuick (2008)</cite>: wingspan as the maximum distance between the wingtips and wingarea as the area from a trace including the root area (where the body is).
</p>
<p>To specify custom properties, these can simply be added as additional arguments to the function. Note that <code>massTotal</code> needs to be the sum of <code>massLoad</code>, <code>massFat</code> and <code>massEmpty</code>. The function will recompute the total mass if the specified masses are inconsistent. Allometric relations use the empty weight. Muscle mass is part of the empty mass, and as such it is represented by <code>muscleMass</code> as a fraction. It is used in the estimation of the mechanical power available for flight (together with the muscle properties <code>coef.activeStrain</code> and <code>coef.isometricStress</code>). The variable <code>type</code> is used for selected  allometric relationships that are specific to that particular group. Currently, <code>bodyFrontalArea</code> distinguishes between <code>'passerine'</code> and anything else and <code>basalMetabolicRate</code> distinguishes between <code>'passerine'</code>, <code>'seabird'</code>, <code>'bat'</code> and anything else.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>name</code> </td><td style="text-align: left;"> String </td><td style="text-align: left;"> Common name</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>name.scientific</code> </td><td style="text-align: left;"> Sring </td><td style="text-align: left;"> Scientific name</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>source</code> </td><td style="text-align: left;"> String </td><td style="text-align: left;"> Source for information</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>massLoad</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Additional mass the bird is carrying (kg); <b>0</b></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>massFat</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Fat mass, i.e. fuel (kg); <b>0</b></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>massEmpty</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Empty mass, i.e. total mass - fat mass - load mass (kg)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>muscleFraction</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Fraction [0,1] of empty mass that makes up flight muscle; <b>0.17</b>*</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>type</code> </td><td style="text-align: left;"> String </td><td style="text-align: left;"> Type of bird <b><code>'other'</code></b>*, <code>'passerine'</code>*, <code>'seabird'</code>, <code>'bat'</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>bodyFrontalArea</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Reference body frontal area used for body drag (m2)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>wingbeatFrequency</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Typical wingbeat frequency (Hz)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>coef.profileDragLiftFactor</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Coefficient for lift dependent profile drag; <b>0.03</b> (<cite>Klein Heerenbrinkn et al. 2015</cite>)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>coef.bodyDragCoefficient</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Drag coefficient related to body frontal area; <b>0.2</b>**</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>coef.conversionEfficiency</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Efficiency Chemical to Mechanical energy; <b>0.23</b>*</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>coef.respirationFactor</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Multiplyer for metabolic overhead respiration; <b>1.1</b>*</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>coef.activeStrain</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Muscle duty cycle factor; <b>0.26</b>*</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>coef.isometricStress</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Maximum force produced per cross section muscle (Pa); <b>400000</b> (upper limit from <cite>Pennycuick &amp; Rezende 1984</cite>)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>basalMetabolicRate</code> </td><td style="text-align: left;"> Numeric </td><td style="text-align: left;"> Minimum energy consumption required for sustain life functions (W) *.
</td>
</tr>

</table>

<p>* as in Flight 1.25 (<cite>Pennycuick 2008</cite>)
</p>
<p>** Large body of data supporting higher body drag coefficients (&gt;0.2) than in Flight 1.25 (0.1), e.g. <cite>Pennycuick et al. (1988)</cite>, <cite>Hedenström &amp; Liechti (2001)</cite>, <cite>Henningsson &amp; Hedenström (2011)</cite> and <cite>KleinHeerenbrink et al. (2016)</cite>
</p>


<h3>Value</h3>

<p>bird object with variables required by the various power estimating functions (e.g. <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>).
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink</p>


<h3>References</h3>

<p>Hedenström, A. &amp; Liechti, F. (2001) Field estimates of body drag coefficient on the basis of dives in passerine birds. <em>J. Exp. Biol.</em> <b>204</b>, 1167–75.
</p>
<p>Henningsson, P. &amp; Hedenström, A. (2011) Aerodynamics of gliding flight in common swifts. <em>J. Exp. Biol.</em> <b>214</b>, 382–93. <a href="https://doi.org/10.1242/jeb.050609">doi:10.1242/jeb.050609</a>
</p>
<p>Klein Heerenbrink, M., Johansson, L. C. &amp; Hedenström, A. (2015) Power of the wingbeat: modelling the effects of flapping wings in vertebrate flight. <em>Proc. R. Soc. A</em> <b>471</b>. <a href="https://doi.org/10.1098/rspa.2014.0952">doi:10.1098/rspa.2014.0952</a>
</p>
<p>KleinHeerenbrink, M., Warfvinge, K. &amp; Hedenström, A. (2016) Wake analysis of aerodynamic components for the glide envelope of a jackdaw (<em>Corvus monedula</em>). <em>J. Exp. Biol.</em> <b>219</b>, 1572–1581. <a href="https://doi.org/10.1242/jeb.132480">doi:10.1242/jeb.132480</a>
</p>
<p>Pennycuick, C. J. &amp; Rezende, M. A. (1984) The specific power output of aerobic muscle, related to the power density of mitochondria. <em>J. Exp. Biol.</em>, <b>108</b>, 377–392.
</p>
<p>Pennycuick, C. J., Obrecht III, H. H. &amp; Fuller, M. R. (1988) Empirical estimates of body drag of large waterfowl and raptors. <em>J. Exp. Biol.</em> <b>135</b>, 253–264.
</p>
<p>Pennycuick, C. J. (2008). <em>Modelling the flying bird.</em> Amsterdam, The Netherlands: Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeAvailablePower">computeAvailablePower</a></code>, <code><a href="#topic+computeChemicalPower">computeChemicalPower</a></code>, <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>, <code><a href="#topic+computeBodyFrontalArea">computeBodyFrontalArea</a></code>, etc.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myBird = Bird(
  massTotal = 0.215,
  wingSpan = 0.67,
  wingArea = 0.0652,
  name = 'jackdaw',
  type =  'passerine'
)
print(myBird)
</code></pre>

<hr>
<h2 id='climbing_birds'>
Climbing birds
</h2><span id='topic+climbing_birds'></span>

<h3>Description</h3>

<p>Data extracted from <cite>Hedenström &amp; Alerstam 1992</cite>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("climbing_birds")</code></pre>


<h3>Format</h3>

<p>A data frame with 15 observations on the following 11 variables.
</p>

<dl>
<dt><code>number</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>name</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>name.scientific</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>massEmpty</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>massFat</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>wingSpan</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>wingAspect</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>wingbeatFrequency</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>climbRate</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>climbSpeed</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>climbAlitude</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hedenström A., Alerstam, T. (1992) Climbing performance of migrating birds as a basis for estimating limits for fuel-carrying capacity and muscle work. <em>J. Exp. Biol</em> <b>164</b> 19-38 <a href="https://doi.org/10.1242/jeb.164.1.19">doi:10.1242/jeb.164.1.19</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(climbing_birds)
climbingBirds &lt;- Bird(climbing_birds)
</code></pre>

<hr>
<h2 id='computeAvailablePower'> Compute available power </h2><span id='topic+computeAvailablePower'></span>

<h3>Description</h3>

<p> Estimation of maximum available power available from the muscles.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>computeAvailablePower(bird, maxPowerAero, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeAvailablePower_+3A_bird">bird</code></td>
<td>
<p>bird description object (see <code><a href="#topic+Bird">Bird</a></code>)</p>
</td></tr>
<tr><td><code id="computeAvailablePower_+3A_maxpoweraero">maxPowerAero</code></td>
<td>
<p>maximum continuous power</p>
</td></tr>
<tr><td><code id="computeAvailablePower_+3A_...">...</code></td>
<td>
<p>optional arguments (none yet)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Available power is determined as a muscle property. It is assumed that part of the muscles tissue is chemically active (mitochondria), providing the required ATP energy to the mechanically active tissue (myofibrils). The fraction of mitochondria determines the maximum sustainable power output from the muscles. With a higher fraction of myofibrils, the muscles can produce more power, but only in a short burst, until all ATP runs out.
</p>
<p>If only a <code><a href="#topic+Bird">Bird</a></code> object is provided, the function will assume that maximum power equals maximum continuous power (<code>maxPowerAero</code>). Otherwise, it will compute the burst maximum power.
</p>


<h3>Value</h3>

<p>numeric value of mechanical power
</p>


<h3>Note</h3>

<p>Available power is determined as a constant for the muscles. In reality the muscle power output depends on strainrate and stress, which in vertebrates are directly linked to wingbeat kinematics and aerodynamic loads.
</p>
<p>Flight 1.25, the model of <cite>Pennycuick (2008)</cite> uses an isometric stress of 560 kN/m2. This is much higher than any measured value (<cite>Pennycuick &amp; Rezende 1984</cite>). A more reasonable yet still very optimistic value would be 400 kn/m2, which is the default value assigned by the <code><a href="#topic+Bird">Bird</a></code> constructor.
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink
</p>


<h3>References</h3>

<p>Pennycuick, C. J. &amp; Rezende, M. A. (1984) The specific power output of aerobic muscle, related to the power density of mitochondria. <em>J. Exp. Biol.</em>, <b>108</b>, 377–392.
</p>
<p>Pennycuick, C. J. (2008). <em>Modelling the flying bird.</em> Amsterdam, The Netherlands: Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Bird">Bird</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define a bird:
myBird = Bird(
  massTotal = 0.215, #  (kg) total body mass
  wingSpan = 0.67, #  (m) maximum wing span
  wingArea = 0.0652, #  (m2) maximum wing area
  type = "passerine"
)

## for maximum continuous power
power.max &lt;- computeAvailablePower(myBird)
print(power.max)
#   [1] 5.233528

## for specified maximum continuous power:
power.max.continuous &lt;- 0.8*power.max
power.max.burst &lt;- computeAvailablePower(myBird,power.max.continuous)
print(power.max.burst)
#   [1] 5.466625

</code></pre>

<hr>
<h2 id='computeBodyFrontalArea'>Body frontal area from scaling relation</h2><span id='topic+computeBodyFrontalArea'></span>

<h3>Description</h3>

<p>Body frontal area is a parameter that relates to body drag. This function estimates body frontal area based on empirical scaling relations with mass. </p>


<h3>Usage</h3>

<pre><code class='language-R'>computeBodyFrontalArea(massEmpty, type = "other")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeBodyFrontalArea_+3A_massempty">massEmpty</code></td>
<td>
<p>empty body mass (in kg)</p>
</td></tr>
<tr><td><code id="computeBodyFrontalArea_+3A_type">type</code></td>
<td>
<p>type of bird; available options are: &ldquo;passerine&rdquo; and &ldquo;other&rdquo;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Passerine (<cite>Hedenström and Rosén 2003</cite>): <code class="reqn">S_b = 0.0129 m^{0.614}</code>
</p>
<p>Other (<cite>Pennycuick <em>et al.</em> 1988</cite>): <code class="reqn">S_b = 0.00813 m^{0.666}</code>
</p>


<h3>Value</h3>

<p>Numeric value for the body frontal area.
</p>


<h3>Note</h3>

<p>Body frontal area is used for the computation of body drag. Only use this value if it matches the used definition of the body drag coefficient.
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink
</p>


<h3>References</h3>

<p>Pennycuick, C. J., Obrecht III, H. H. and Fuller, M. R. (1988) Empirical estimates of body drag of large waterfowl and raptors. <em>J. Exp. Biol.</em> <b>135</b>, 253&ndash;264.
</p>
<p>Hedenström, A. and Rosén, M. (2003) Body frontal area in passerine birds. <em>J. Avian Biol.</em> <b>34</b>, 159&ndash;162.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Bird">Bird</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>massEmpty &lt;- 0.215 # kg
Sb &lt;- computeBodyFrontalArea(massEmpty)
print(Sb)
#   [1] 0.002920751 # m2

massEmpty &lt;- 0.215 # kg
birdType &lt;- "passerine" #
Sb &lt;- computeBodyFrontalArea(massEmpty,birdType)
print(Sb)
#   [1] 0.005020037 # m2
</code></pre>

<hr>
<h2 id='computeChemicalPower'>Convert mechanical power to chemical power</h2><span id='topic+computeChemicalPower'></span><span id='topic+computeChemicalPower.power.mechanical'></span><span id='topic+computeChemicalPower.numeric'></span>

<h3>Description</h3>

<p>Redundant after chemical power is now computed in all functions by default.
</p>
<p>Computes the chemical power, i.e. the rate at which chemical energy is consumed, during flight. It takes into account the basal metabolic rate, and the energy needed by the flight muscles to provide the mechanical power required for flight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'power.mechanical'
computeChemicalPower(power.mech, bird, ...)
## S3 method for class 'numeric'
computeChemicalPower(power.mech, bird, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeChemicalPower_+3A_power.mech">power.mech</code></td>
<td>
<p>mechanical power (either numeric (W) or as an mechanical power object (class power.mechanical)</p>
</td></tr>
<tr><td><code id="computeChemicalPower_+3A_bird">bird</code></td>
<td>
<p> object describing the relevant morphological parameters of the bird (or bat); this object should be created using the <code><a href="#topic+Bird">Bird</a></code> constructor.</p>
</td></tr>
<tr><td><code id="computeChemicalPower_+3A_...">...</code></td>
<td>
<p>optional arguments (none yet)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Chemical power is computed as
</p>
<p style="text-align: center;"><code class="reqn">P_\mathrm{chem} = R(\frac{P_\mathrm{mech}}{\eta} + \mathrm{BMR})</code>
</p>
<p> as described by <cite>Pennycuick (2008)</cite>. Here <code class="reqn">R</code> is the respiration factor, <code class="reqn">\eta</code> is the muscle conversion efficiency and <code class="reqn">\mathrm{BMR}</code> the basal metabolic rate, see <code><a href="#topic+Bird">Bird</a></code>.
</p>


<h3>Value</h3>

<p>Chemical power of same type as inpute <code>power.chem</code>.
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink
</p>


<h3>References</h3>

<p>Pennycuick, C. J. (2008). <em>Modelling the flying bird.</em> Amsterdam, The Netherlands: Elsevier.</p>


<h3>See Also</h3>

<p><code><a href="#topic+Bird">Bird</a></code>, <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>, <code><a href="#topic+mech2chem">mech2chem</a></code>, <code><a href="#topic+chem2mech">chem2mech</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define a bird:
myBird = Bird(
  massTotal = 0.215, #  (kg) total body mass
  wingSpan = 0.67, #  (m) maximum wing span
  wingArea = 0.0652, #  (m2) maximum wing area
  type = "passerine"
)

## for maximum continuous power
power.max &lt;- computeAvailablePower(myBird)
print(power.max)
#   [1] 5.233528

## convert to chemical power
power.max.chem &lt;- computeChemicalPower(power.max,myBird)
print(power.max.chem)
#   [1] 27.28913

</code></pre>

<hr>
<h2 id='computeFlappingPower'>Calculate aerodynamic power flapping flight</h2><span id='topic+computeFlappingPower'></span>

<h3>Description</h3>

<p>The function calculates the aerodynamic power required for the specified bird (or bat) at the specified flight speed.</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeFlappingPower(bird,speed,...,frequency,strokeplane)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeFlappingPower_+3A_bird">bird</code></td>
<td>
<p> object describing the relevant morphological parameters of the bird (or bat); this object should be created using the <code><a href="#topic+Bird">Bird</a></code> constructor.</p>
</td></tr>
<tr><td><code id="computeFlappingPower_+3A_speed">speed</code></td>
<td>
<p> a numeric vector of the airspeed. </p>
</td></tr>
<tr><td><code id="computeFlappingPower_+3A_...">...</code></td>
<td>
<p> optional arguments (see details) </p>
</td></tr>
<tr><td><code id="computeFlappingPower_+3A_frequency">frequency</code></td>
<td>
<p> wingbeat frequency as single numeric value, a numeric vector matching the speed vector, a closure object returning a numeric value as a function of speed, or the character string 'recompute'. The latter will recompute the default frequency for the current flight condition (density) and the current total mass of the bird (assuming the frequency in bird is the default wingbeat frequency). If not provided, the function will look for a default wingbeat frequency in the bird object. </p>
</td></tr>
<tr><td><code id="computeFlappingPower_+3A_strokeplane">strokeplane</code></td>
<td>
<p> angle of the strokeplane in degrees, as a single numeric value, a numeric vector matching the speed vector, a closure object describing the strokeplane angle as a function of speed. Alternatively providing character string &quot;opt&quot; will tell the function to optimize the strokeplane angle for minimum aerodynamic power. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function estimates aerodynamic power for a animal in forward flight based on morphology and wingbeat kinematics (<cite>Klein Heerenbrink, 2015</cite>). The model takes into account span reduction during the upstroke, which is typical for vertebrate forward flight.
...
The minimal input required for the function is a description of the animal (as provided by the Bird constructor) and the speed(range) for which to compute the aerodynamic power. Distinct from other models, this model also requires wingbeat frequency and strokeplane angle. Higher wingbeat frequency tends to lower the induced power, but it may increase profile power. If no wingbeat frequency is provided, the function will use the reference wingbeat frequency from the bird object. Otherwise the user can specify values (either as vectors or as closure object). The user can provide additional optional arguments:
</p>

<dl>
<dt><code>bodyDragCoefficient</code></dt><dd><p>  single numeric value, a numeric vector matching the speed vector, or a closure object as a function of speed. If not provided, the function will look for a default value in the bird object.</p>
</dd>
<dt><code>addedDrag</code></dt><dd><p>  single numeric value or a numeric vector matching the speed vector. This represents additional &quot;drag&quot; (in Newtons) that must be overcome (e.g. during climb). </p>
</dd>
<dt><code>flightcondition</code></dt><dd><p> object describing the atmospheric conditions (density, viscosity, gravity). </p>
</dd>
</dl>



<h4>Aerodynamic model</h4>

<p><code>computeFlappingPower</code> first computes the drag components for non-flapping flight:
</p>
<p style="text-align: center;"><code class="reqn">D_\mathrm{ind} = \frac{L^2}{q \pi b^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">D_\mathrm{pro,0} = C_{D_\mathrm{pro,0}} q S</code>
</p>

<p style="text-align: center;"><code class="reqn">D_\mathrm{pro,2} = k_{p} \frac{L^2}{q S}</code>
</p>

<p style="text-align: center;"><code class="reqn">D_\mathrm{par} = C_{D_\mathrm{b}} q S_\mathrm{b} + D_\mathrm{added}</code>
</p>

<p>which combine to the non-flapping thrust requirement <code class="reqn">T_0 = \sum D_{&lt;&gt;}</code>. Here <code class="reqn">q = \frac{1}{2}\rho U^2</code> is the dynamic pressure depending on density (<code class="reqn">\rho</code>) and speed (<code class="reqn">U</code>).
To account for how flapping the wings affects the drag on the wings, <code>computeFlappingPower</code> computes factors <code class="reqn">f_{D_\mathrm{ind}}</code>, <code class="reqn">f_{D_\mathrm{pro,0}}</code> and <code class="reqn">f_{D_\mathrm{pro,2}}</code>, which are functions of the strokeplane angle and the (reduced) wingbeat frequency. These factors relate to the returned drag factors <code>kD.ind</code>, <code>kD.pro0</code> and <code>kD.pro2</code> through
</p>
<p style="text-align: center;"><code class="reqn">k_{D,&lt;&gt;}=1+f_{D,&lt;&gt;} \frac{T}{L}</code>
</p>

<p>The actual drag in flapping flight is found by multiplying each non-flapping drag component with its respective drag factor. This means that the actual thrust requirement (thrust ratio <code class="reqn">T/L</code>) can be computed as
</p>
<p style="text-align: center;"><code class="reqn">\frac{T}{L} = \frac{T_0}{L - f_{D\mathrm{ind}}D_\mathrm{ind} - f_{D\mathrm{pro,0}}D_\mathrm{pro,0} - f_{D\mathrm{pro,2}}D_\mathrm{pro,2} }</code>
</p>

<p>Finally, <code>computeFlappingPower</code> computes the power factors in a similar way to the drag factors (i.e. <code class="reqn">k_{P,i}=1+f_{P,i}\frac{T}{L}</code>, with <code class="reqn">f_{P,i}</code> functions of strokeplane angle and wingbeat frequency).
The total aerodynamic power is then computed as
</p>
<p style="text-align: center;"><code class="reqn">P = k_{P\mathrm{ind}} D_\mathrm{ind}U + k_{P\mathrm{pro,0}} D_\mathrm{pro,0}U + k_{P\mathrm{pro,2}} D_\mathrm{pro,2}U + D_\mathrm{par}U</code>
</p>




<h4>Wingbeat optimization</h4>

<p>The underlying numerical model that is represented by functions <code class="reqn">f_{D,i}</code> and <code class="reqn">f_{P,i}</code>, has optimised the flapping amplitude for minimum induced power. This means <code>computeFlappingPower</code> implicitly optimizes flapping amplitude, which is the value <code>amplitude</code> returned in the output.
</p>
<p><code>computeFlappingPower</code> takes strokeplane angle as input. The underlying numerical model has only explored strokeplane angles over a range of 0 (vertical) to 50 degrees, the latter being defined as having the down-stroke moving forward. In many cases it will be possible to find a strokeplane angle for which the total aerodynamic power is minimal. At high speeds this optimum will be for a vertical strokeplane while at lower speeds it will be more horizontal. By passing <code>strokeplane="opt"</code> as an argument to <code>computeFlappingPower</code>, it will try to numerically find the optimal strokeplane angle, using the function <code>optimize</code>.
</p>



<h3>Value</h3>

<p>A data.frame including elements
</p>
<table role = "presentation">
<tr><td><code>speed</code></td>
<td>
<p> specified speed for which power is computed. </p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p> total aerodynamic power. </p>
</td></tr>
<tr><td><code>power.chem</code></td>
<td>
<p> total chemical power. </p>
</td></tr>
<tr><td><code>strokeplane</code></td>
<td>
<p> used strokeplane angle (either specified or optimized). </p>
</td></tr>
<tr><td><code>amplitude</code></td>
<td>
<p> wingbeat amplitude (implicitly optimized for minimum induced power). </p>
</td></tr>
<tr><td><code>frequency</code></td>
<td>
<p> wingbeat frequency (specified). </p>
</td></tr>
<tr><td><code>flags.redFreqLo</code></td>
<td>
<p> TRUE if reduced frequency too low (&lt;1; outside model range). </p>
</td></tr>
<tr><td><code>flags.redFreqHi</code></td>
<td>
<p> TRUE if reduced frequency too high (&gt;6; outside model range). </p>
</td></tr>
<tr><td><code>flags.thrustHi</code></td>
<td>
<p> TRUE if thrust requirement too high (&gt;0.3; outside model range). </p>
</td></tr>
<tr><td><code>flags.speedLo</code></td>
<td>
<p> TRUE if speed is too low (invalidating the forward flight assumption). </p>
</td></tr>
<tr><td><code>kD.ind</code></td>
<td>
<p> induced drag factor </p>
</td></tr>
<tr><td><code>kD.pro0</code></td>
<td>
<p> zero lift profile drag factor </p>
</td></tr>
<tr><td><code>kD.pro2</code></td>
<td>
<p> lift dependent profile drag factor </p>
</td></tr>
<tr><td><code>kP.ind</code></td>
<td>
<p> induced power factor </p>
</td></tr>
<tr><td><code>kP.pro0</code></td>
<td>
<p> zero lift profile power factor </p>
</td></tr>
<tr><td><code>kP.pro2</code></td>
<td>
<p> lift dependent profile power factor </p>
</td></tr>
<tr><td><code>CDpro0</code></td>
<td>
<p> used zero lift profile drag coefficient (laminar boundary layer friction) </p>
</td></tr>
<tr><td><code>ReynoldsNumber</code></td>
<td>
<p> mean chord Reynolds number </p>
</td></tr>
<tr><td><code>Dnf.ind</code></td>
<td>
<p> non-flapping induced drag (N) </p>
</td></tr>
<tr><td><code>Dnf.pro0</code></td>
<td>
<p> non-flapping zero lift profile drag (N) </p>
</td></tr>
<tr><td><code>Dnf.pro2</code></td>
<td>
<p> non-flapping lift dependent profile drag (N) </p>
</td></tr>
<tr><td><code>Dnf.par</code></td>
<td>
<p> non-flapping parasitic drag (including body drag and apparent drag due to climbing)</p>
</td></tr>
<tr><td><code>L</code></td>
<td>
<p> lift (N) </p>
</td></tr>
</table>


<h3>Note</h3>

<p>This model aims to predict the optimal flight performance for a bird. Particularly, the induced drag and induced power assume an ideal load distribution over the wing equivalent to the elliptical lift distribution for non-flapping wings. This means that induced power will typically be underestimated.
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink</p>


<h3>References</h3>

<p>Klein Heerenbrink, M., Johansson, L. C. and Hedenström, A. (2015) Power of the wingbeat: modelling the effects of flapping wings in vertebrate flight. <em>Proc. R. Soc. A</em> <b>471</b>, 2177 <a href="https://doi.org/10.1098/rspa.2014.0952">doi:10.1098/rspa.2014.0952</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Bird">Bird</a></code>, <code><a href="#topic+amplitude">amplitude</a></code>, <code><a href="#topic+fD.ind">fD.ind</a></code>, <code><a href="#topic+fD.pro0">fD.pro0</a></code>, <code><a href="#topic+fD.pro2">fD.pro2</a></code>, <code><a href="#topic+fP.ind">fP.ind</a></code>, <code><a href="#topic+fP.pro0">fP.pro0</a></code>, <code><a href="#topic+fP.pro2">fP.pro2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define a bird:
myBird = Bird(
  massTotal = 0.215, #  (kg) total body mass
  wingSpan = 0.67, #  (m) maximum wing span
  wingArea = 0.0652, #  (m2) maximum wing area
  type = "passerine"
)

## define a speed range
speedrange &lt;- seq(5,14,length.out=5)

## compute aerodynamic power for that speed range:
Paero &lt;- computeFlappingPower(myBird,speedrange)
print(Paero[c("speed","power","frequency","strokeplane")])
#   speed    power frequency strokeplane
# 1  5.00 2.789751  5.948083    46.56887
# 2  7.25 2.129466  5.948083    31.89129
# 3  9.50 2.203773  5.948083    22.51896
# 4 11.75 2.740763  5.948083    16.49120
# 5 14.00 3.673714  5.948083    12.09174

## prescribe strokeplane angle:
Paero &lt;- computeFlappingPower(myBird,speedrange,strokeplane=20)
print(Paero[c("speed","power","frequency","strokeplane")])
#   speed    power frequency strokeplane
# 1  5.00 2.950259  5.948083          20
# 2  7.25 2.141581  5.948083          20
# 3  9.50 2.204132  5.948083          20
# 4 11.75 2.741335  5.948083          20
# 5 14.00 3.676224  5.948083          20

## prescribe frequency as a function of speed:
funFrequency = function(U){19.8 - 4.7*U + 0.45*U^2 - 0.0138*U^3}
Paero &lt;- computeFlappingPower(myBird,speedrange,frequency=funFrequency,strokeplane='opt')
print(Paero[c("speed","power","frequency","strokeplane")])
#   speed    power frequency strokeplane
# 1  5.00 2.810431  5.825000    46.16223
# 2  7.25 2.356278  4.119247    25.99702
# 3  9.50 2.390251  3.930725    17.94304
# 4 11.75 2.860463  4.316291    14.52910
# 5 14.00 3.794431  4.332800    11.70058

## examine effect of frequency for a single airspeed:
speedrange &lt;- rep(10,5) #  repeated speed
freqrange &lt;- seq(3,10,length.out=5) #  frequency range
Paero &lt;- computeFlappingPower(myBird,speedrange,frequency=freqrange,strokeplane='opt')
print(Paero[c("speed","power","frequency","strokeplane")])
#   speed    power frequency strokeplane
# 1    10 2.681028      3.00    13.87797
# 2    10 2.367982      4.75    18.90949
# 3    10 2.263765      6.50    21.52433
# 4    10 2.219739      8.25    21.71519
# 5    10 2.200852     10.00    20.18503
</code></pre>

<hr>
<h2 id='computeFlightPerformance'>Compute characteristics of a power curve</h2><span id='topic+computeFlightPerformance'></span>

<h3>Description</h3>

<p>This function calculates the basic characteristic flight speeds for <code>bird</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeFlightPerformance(bird, ..., length.out=10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeFlightPerformance_+3A_bird">bird</code></td>
<td>
<p>description of the bird or bat, constructed using the <code><a href="#topic+Bird">Bird</a></code> function</p>
</td></tr>
<tr><td><code id="computeFlightPerformance_+3A_...">...</code></td>
<td>
<p>various optional arguments that are passed on to other functions; see details</p>
</td></tr>
<tr><td><code id="computeFlightPerformance_+3A_length.out">length.out</code></td>
<td>
<p>length of calculated power curve; set <code>length.out=0</code> to not compute a power curve </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optional arguments can be provided through <code>...</code>. These can be arguments of <code>computeFlappingPower</code>, e.g. <code>strokeplane</code>, <code>frequency</code>, etc., or arguments for <code>findMaximumRangeSpeed</code>, e.g. <code>windSpeed</code> and <code>windDir</code>. The latter will only affect the outcome of the maximum range speed, and should perhaps not be analysed through the current function...
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>birdWSName</code></td>
<td>
<p> variable name in work-space of the bird object </p>
</td></tr>
<tr><td><code>bird</code></td>
<td>
<p> bird object </p>
</td></tr>
<tr><td><code>table</code></td>
<td>
<p> table with characteristic speeds </p>
</td></tr>
<tr><td><code>maxClimb</code></td>
<td>
<p> table with climb performance </p>
</td></tr>
<tr><td><code>powercurve</code></td>
<td>
<p> power curve from minimum to maximum speed of length <code>lenght.out</code> </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink
</p>


<h3>References</h3>

<p>Klein Heerenbrink, M., Johansson, L. C. and Hedenström, A. (2015) Power of the wingbeat: modelling the effects of flapping wings in vertebrate flight. <em>Proc. R. Soc. A</em> <b>471</b>, 2177 <a href="https://doi.org/10.1098/rspa.2014.0952">doi:10.1098/rspa.2014.0952</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Bird">Bird</a></code>, <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # computationally intensive

## Define a bird:
myBird = Bird(
    name = "Jackdaw",
    name.scientific = "Corvus monedula",
    massTotal = 0.215, #  (kg) total body mass
    wingSpan = 0.67, #  (m) maximum wing span
    wingArea = 0.0652, #  (m2) maximum wing area
    type = "passerine"
)

## simplest performance calculation
performance.myBird &lt;- computeFlightPerformance(myBird)
performance.myBird
# Name: Jackdaw
# Sc. name: Corvus monedula
# Bird definitions: NA
#               speed power.aero power.chem strokeplane amplitude
# minimumSpeed  2.706      5.234      27.29        49.9      51.3
# minimumPower  8.031      2.093      12.27        28.1      34.5
# maximumRange 11.025      2.523      14.33        18.2      36.7
# maximumSpeed 16.590      5.235      27.29         6.8      50.2
# Maximum climb performance:
#                  speed power.aero power.chem strokeplane amplitude climbRate
# maximumClimbRate  8.89      5.234      27.29        24.5      53.9      1.18
# Minimized migration time:
#                  speed speed.migration power.aero power.chem power.dep strokeplane amplitude
# minimumTimeSpeed 11.75           1.962      2.741      15.37     3.081       16.49     38.04

## optimize strokeplane angle and use speed dependent frequency
funFrequency = function(U){19.8 - 4.7*U + 0.45*U^2 - 0.0138*U^3}
performance.myBird &lt;- computeFlightPerformance(myBird,strokeplane='opt',frequency=funFrequency)
performance.myBird
# Name: Jackdaw
# Sc. name: Corvus monedula
# Bird definitions: NA
#               speed power.aero power.chem strokeplane amplitude
# minimumSpeed  2.293      5.229      27.27        49.9      43.8
# minimumPower  8.192      2.319      13.35        21.6      42.8
# maximumRange 11.463      2.775      15.53        14.9      44.3
# maximumSpeed 16.088      5.233      27.29         8.3      64.5
# Maximum climb performance:
#                  speed power.aero power.chem strokeplane amplitude climbRate
# maximumClimbRate  8.89      5.234      27.29        24.5      53.9      1.18
# Minimized migration time:
#                  speed speed.migration power.aero power.chem power.dep strokeplane amplitude
# minimumTimeSpeed 12.07           1.905      2.964      16.43     3.081       14.13     45.13

## plot variation of speed, power and flapping kinematics
plot(performance.myBird$powercurve[c('speed','power.aero','strokeplane','frequency','amplitude')])

## plot power factors
plot(performance.myBird$powercurve[c('speed','power.aero')])
plot(performance.myBird$powercurve[c('speed','kP.ind')])
plot(performance.myBird$powercurve[c('speed','kP.pro0')])
plot(performance.myBird$powercurve[c('speed','kP.pro2')])

## End(Not run) # end dontrun

</code></pre>

<hr>
<h2 id='fDfPfunctions'> Coefficient for thrust dependency of drag and power factors </h2><span id='topic+fD.ind'></span><span id='topic+fD.pro0'></span><span id='topic+fD.pro2'></span><span id='topic+fP.ind'></span><span id='topic+fP.pro0'></span><span id='topic+fP.pro2'></span>

<h3>Description</h3>

<p>Computes the thrust requirement dependency factor for drag and power factors in flapping flight based on reduced frequency (<code>kf</code>) and strokeplane angle (<code>phi</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fD.ind(kf, phi)
fD.pro0(kf, phi)
fD.pro2(kf, phi)
fP.ind(kf, phi)
fP.pro0(kf, phi)
fP.pro2(kf, phi)
</code></pre>


<h3>Arguments</h3>

<p>Using <code class="reqn">f</code> for wingbeat frequency, <code class="reqn">b</code> for wingspan, and <code class="reqn">U</code> for air speed:
</p>
<table role = "presentation">
<tr><td><code id="fDfPfunctions_+3A_kf">kf</code></td>
<td>
<p>reduced frequency (<code class="reqn">k_f = \frac{2 \pi f b}{U}</code>); valid range between 1 and 6</p>
</td></tr>
<tr><td><code id="fDfPfunctions_+3A_phi">phi</code></td>
<td>
<p>strokeplane angle in radians; valid range between 0 and 0.87 rad (50 deg)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Flapping of the wings alters the drag components on the wing. A drag component in flapping flight can be related to the drag component in non-flapping flight as <code class="reqn">D = k_D D^\prime</code>. The factor <code class="reqn">k_D</code> depends on reduced frequency <code class="reqn">k_f</code>, strokeplane angle <code class="reqn">\phi</code> and the thrust-to-lift ratio <code class="reqn">T/L</code>: <code class="reqn">k_D = 1 + f_D(k_f,\phi) \frac{T}{L}</code>. Functions <code>fD.ind</code>,<code>fD.pro0</code> and <code>fD.pro2</code> compute <code class="reqn">f_D(k_f,\phi)</code> for induced drag, zero lift profile drag and lift dependent profile drag, respectively.
</p>
<p>Similarly, the flapping power components can be computed as: <code class="reqn">P = k_P D^\prime U</code>, again with <code class="reqn">k_P = 1 + f_P(k_f,\phi) \frac{T}{L}</code>. Functions <code>fP.ind</code>,<code>fP.pro0</code> and <code>fP.pro2</code> compute <code class="reqn">f_P(k_f,\phi)</code> for induced power, zero lift profile power and lift dependent profile power, respectively.
</p>


<h3>Value</h3>

<p>Numeric value
</p>


<h3>Note</h3>

<p>Thrust requirement is the sum of all drag components in flapping flight divided by the lift. This means the thrust requirement itself is a function of the values of <code class="reqn">f_D</code>.
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink</p>


<h3>References</h3>

<p>Klein Heerenbrink, M., Johansson, L. C. and Hedenström, A. 2015 Power of the wingbeat: modelling the effects of flapping wings in vertebrate flight. <em>Proc. R. Soc. A</em> <b>471</b>, 2177 <a href="https://doi.org/10.1098/rspa.2014.0952">doi:10.1098/rspa.2014.0952</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## reduced frequency
kf &lt;- 2*pi*4/10 # 4 Hz at 10 m/s

## strokeplane angle
phi &lt;- 20*pi/180 # 20 degrees

## thrust ratio
TL &lt;- 0.2

## induced drag factor:
fDind &lt;- fD.ind(kf,phi)
kDind &lt;- 1 + fDind*TL
print(kDind)
#   [1] 1.623659

## zero lift drag factor:
fDpro0 &lt;- fD.pro0(kf,phi)
kDpro0 &lt;- 1 + fDpro0*TL
print(kDpro0)
#   [1] 1.014899

## lift dependent profile drag factor:
fDpro2 &lt;- fD.pro2(kf,phi)
kDpro2 &lt;- 1 + fDpro2*TL
print(kDpro2)
#   [1] 1.511107

## induced power factor:
fPind &lt;- fP.ind(kf,phi)
kPind &lt;- 1 + fPind*TL
print(kPind)
#   [1] 1.996891

## zero lift power factor:
fPpro0 &lt;- fP.pro0(kf,phi)
kPpro0 &lt;- 1 + fPpro0*TL
print(kPpro0)
#   [1] 1.076046

## lift dependent profile power factor:
fPpro2 &lt;- fP.pro2(kf,phi)
kPpro2 &lt;- 1 + fPpro2*TL
print(kPpro2)
#   [1] 1.811983


</code></pre>

<hr>
<h2 id='findMaximumClimbRate'>Find maximum climb rate</h2><span id='topic+findMaximumClimbRate'></span>

<h3>Description</h3>

<p>Numerically find the maximum attainable climb rate.</p>


<h3>Usage</h3>

<pre><code class='language-R'>findMaximumClimbRate(bird, maximumPower, speed, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findMaximumClimbRate_+3A_bird">bird</code></td>
<td>
<p>bird description object (see <code><a href="#topic+Bird">Bird</a></code>)</p>
</td></tr>
<tr><td><code id="findMaximumClimbRate_+3A_maximumpower">maximumPower</code></td>
<td>
<p>numeric value for maximum available mechanical power</p>
</td></tr>
<tr><td><code id="findMaximumClimbRate_+3A_speed">speed</code></td>
<td>
<p>airspeed for which to compute the maximum climbrate</p>
</td></tr>
<tr><td><code id="findMaximumClimbRate_+3A_...">...</code></td>
<td>
<p>optional arguments for <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function searches for a climb angle between -90 and 90 degrees that matches the specified maximum power available. If no <code>speed</code> provided, the function will also find the optimal airspeed for maximum climbrate.
</p>


<h3>Value</h3>

<p> Data frame of class <code>power.mechanical</code>
</p>
<table role = "presentation">
<tr><td><code>speed</code></td>
<td>
<p>airspeed either prescribed or optimized for maximum climbrate</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>aerodynamic (mechanical) power matching maximum power</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>see <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code> for other variables</p>
</td></tr>
<tr><td><code>climbAngle</code></td>
<td>
<p> angle between flightpath and horizontal plane in degrees  </p>
</td></tr>
<tr><td><code>climbRate</code></td>
<td>
<p> rate of vertical climb </p>
</td></tr>
</table>


<h3>Note</h3>

<p>The function uses climb angle, rather than climb rate, in the search algorithm, to ensure that climb rate is always less than the airspeed (i.e. in a vertical climb the climb rate will simply equal airspeed). The actual climb rate is maximized by maximizing the product of climb angle and airspeed. However, in practice, the airspeed for best climb rate will be close to the minimum power airspeed, where the power margin is largest.</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+uniroot">uniroot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define a bird:
myBird = Bird(
  massTotal = 0.215, #  (kg) total body mass
  wingSpan = 0.67, #  (m) maximum wing span
  wingArea = 0.0652, #  (m2) maximum wing area
  type = "passerine"
)

## maximum power available:
Paero.available &lt;- computeAvailablePower(myBird)

climbSpeed &lt;- 8 #  airspeed during climb

## find maximum climbrate:
Paero.climb &lt;- findMaximumClimbRate(myBird,Paero.available,climbSpeed)
print(Paero.climb[c('speed','amplitude','frequency','climbRate')])
#   speed amplitude frequency climbRate
# 1     8  54.84965  5.948083  1.162002

</code></pre>

<hr>
<h2 id='findMaximumPowerSpeed'>Finds speed for which power required equals maximum available power</h2><span id='topic+findMaximumPowerSpeed'></span>

<h3>Description</h3>

<p>Numerically find the airspeed for which required power equals <code>maximumPower</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>findMaximumPowerSpeed(bird, maximumPower, lower, upper, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findMaximumPowerSpeed_+3A_bird">bird</code></td>
<td>
<p>bird description object (see <code><a href="#topic+Bird">Bird</a></code>)</p>
</td></tr>
<tr><td><code id="findMaximumPowerSpeed_+3A_maximumpower">maximumPower</code></td>
<td>
<p>numeric value for maximum available mechanical power</p>
</td></tr>
<tr><td><code id="findMaximumPowerSpeed_+3A_lower">lower</code></td>
<td>
<p>lower bound for search range airspeed (m/s)</p>
</td></tr>
<tr><td><code id="findMaximumPowerSpeed_+3A_upper">upper</code></td>
<td>
<p>upper bound for search range airspeed (m/s)</p>
</td></tr>
<tr><td><code id="findMaximumPowerSpeed_+3A_...">...</code></td>
<td>
<p>optional arguments to <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prepares arguments for a call to <code><a href="stats.html#topic+uniroot">uniroot</a></code>. The function searches for an airspeed between <code>lower</code> and <code>upper</code> that matches the specified maximum power available.
</p>


<h3>Value</h3>

<p>Data frame
</p>
<table role = "presentation">
<tr><td><code>speed</code></td>
<td>
<p>airspeed for which power matches maximum power</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>aerodynamic (mechanical) power matching maximum power</p>
</td></tr>
<tr><td><code>power.chem</code></td>
<td>
<p>aerodynamic (mechanical) power matching maximum power</p>
</td></tr>
<tr><td><code>strokeplane</code></td>
<td>
<p> optimized or prescribed strokeplane angle in degrees (from vertical)</p>
</td></tr>
<tr><td><code>amplitude</code></td>
<td>
<p> optimized peak amplitude in degrees (see <code><a href="#topic+amplitude">amplitude</a></code>)</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>see <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code> for other variables</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Typically this function would be used to find the maximum speed, but may in some cases also be used for the minimum flight speed. However, note that the low speed limit is likely limited by other constraints as well (e.g. stall speed).
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+uniroot">uniroot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define a bird:
myBird &lt;- Bird(
  massTotal = 0.215, #  (kg) total body mass
  wingSpan = 0.67, #  (m) maximum wing span
  wingArea = 0.0652, #  (m2) maximum wing area
  type = "passerine"
)

Paero.available  &lt;- computeAvailablePower(myBird)

## find maximum speed:
Vmin &lt;- 5
Vmax &lt;- 30
Paero.maxSpeed &lt;- findMaximumPowerSpeed(myBird,Paero.available,Vmin,Vmax)
print(Paero.maxSpeed[c('speed','power','amplitude','strokeplane','frequency')])
#      speed    power amplitude strokeplane frequency
# 1 16.58797 5.233459  50.22762    6.812345  5.948083
</code></pre>

<hr>
<h2 id='findMaximumRangeSpeed'>Find maximum range speed</h2><span id='topic+findMaximumRangeSpeed'></span>

<h3>Description</h3>

<p>This function performs a numerical optimization to find the airspeed for which <code class="reqn">\frac{P}{U}</code> is minimum. For this it uses the function <code>optimize</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findMaximumRangeSpeed(bird,lower=NULL,upper=NULL,windSpeed=0,windDir=0,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findMaximumRangeSpeed_+3A_bird">bird</code></td>
<td>
<p>bird description object (see <code><a href="#topic+Bird">Bird</a></code>)</p>
</td></tr>
<tr><td><code id="findMaximumRangeSpeed_+3A_lower">lower</code></td>
<td>
<p> lower speed limit (optional)</p>
</td></tr>
<tr><td><code id="findMaximumRangeSpeed_+3A_upper">upper</code></td>
<td>
<p> upper speed limit (optional)</p>
</td></tr>
<tr><td><code id="findMaximumRangeSpeed_+3A_windspeed">windSpeed</code></td>
<td>
<p> wind magnitude (in m/s; optional)</p>
</td></tr>
<tr><td><code id="findMaximumRangeSpeed_+3A_winddir">windDir</code></td>
<td>
<p> wind direction (in degrees; optional)</p>
</td></tr>
<tr><td><code id="findMaximumRangeSpeed_+3A_...">...</code></td>
<td>
<p> optional arguments: <code>climbAngle</code> (in degrees), and optional arguments for <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a numerical optimization to find the airspeed for which <code class="reqn">\frac{P}{U}</code> is minimum. For this it uses the function <code>optimize</code>. This airspeed is searched for between <code>lower</code>  and  <code>upper</code> (if not provided, it will make a guess based on <code>bird</code>). Flying in wind changes the ground speed, and therefore the optimum flight speed for maximum range. This can be taken into account through the optional arguments for wind magnitude (<code>windSpeed</code> in m/s) and wind direction relative to the track direction (<code>windDir</code> in degrees; <code>windDir = 0</code> tail wind); see e.g. <cite>Liechti et al. 1994</cite>.
</p>


<h3>Value</h3>

<p>Returns data.frame (power.chemical) of flight performance at maximum range speed for <code>bird</code>.</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink
</p>


<h3>References</h3>

<p>Liechti, F., Hedenström, A. and Alerstam, T. (1994). Effects of Sidewinds on Optimal Flight Speed of Birds. <em>J. Theor. Biol.</em> <b>170</b>, 219–225.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeChemicalPower">computeChemicalPower</a></code>, <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define a bird:
myBird = Bird(
  massTotal = 0.215, #  (kg) total body mass
  wingSpan = 0.67, #  (m) maximum wing span
  wingArea = 0.0652, #  (m2) maximum wing area
  type = "passerine"
)

maximumRangeSpeed.chem &lt;- findMaximumRangeSpeed(myBird)
maximumRangeSpeed.chem[c('speed','power','strokeplane','amplitude','frequency')]
#      speed    power strokeplane amplitude frequency
# 1 11.02543 14.32754    18.17729  36.69311  5.948083

maximumRangeSpeed.chem.wind &lt;- findMaximumRangeSpeed(
  myBird,
  windSpeed = 5,
  windDir = 90
)
maximumRangeSpeed.chem.wind[c('speed','power','strokeplane','amplitude','frequency')]
#      speed    power strokeplane amplitude frequency
# 1 11.81974 15.47758    16.33727  38.17508  5.948083
</code></pre>

<hr>
<h2 id='findMinimumPowerSpeed'>Find speed for minimum power</h2><span id='topic+findMinimumPowerSpeed'></span>

<h3>Description</h3>

<p>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>findMinimumPowerSpeed(bird, lower, upper, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findMinimumPowerSpeed_+3A_bird">bird</code></td>
<td>
<p>bird description object (see <code><a href="#topic+Bird">Bird</a></code>)</p>
</td></tr>
<tr><td><code id="findMinimumPowerSpeed_+3A_lower">lower</code></td>
<td>
<p> lower speed limit (optional)</p>
</td></tr>
<tr><td><code id="findMinimumPowerSpeed_+3A_upper">upper</code></td>
<td>
<p> upper speed limit (optional)</p>
</td></tr>
<tr><td><code id="findMinimumPowerSpeed_+3A_...">...</code></td>
<td>
<p> optional arguments for <code>computeFlappingPower()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is pretty much just a call to <code>optimize</code>.</p>


<h3>Value</h3>

<p>powercurve object (<code>funCalcPower</code> evaluated for the minimum speed)</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbink</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optimize">optimize</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define a bird:
myBird = Bird(
  massTotal = 0.215, #  (kg) total body mass
  wingSpan = 0.67, #  (m) maximum wing span
  wingArea = 0.0652, #  (m2) maximum wing area
  type = "passerine"
)

minimumPowerSpeed.aero &lt;- findMinimumPowerSpeed(myBird)
minimumPowerSpeed.aero[c('speed','power','strokeplane','amplitude','frequency')]
#      speed    power strokeplane amplitude frequency
# 1 8.030022 2.092976    28.14514  34.52719  5.948083
</code></pre>

<hr>
<h2 id='findMinimumTimeSpeed'>Find speed for migration time minimization</h2><span id='topic+findMinimumTimeSpeed'></span>

<h3>Description</h3>

<p>This function performs a numerical optimization to find the airspeed for which <code class="reqn">\frac{P+P_\mathrm{dep}}{U}</code> is minimum..
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findMinimumTimeSpeed(bird,
  EnergyDepositionRate=1.5*bird$basalMetabolicRate,
  lower=NULL,upper=NULL,
  windSpeed=0,windDir=0,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findMinimumTimeSpeed_+3A_bird">bird</code></td>
<td>
<p>bird description object (see <code><a href="#topic+Bird">Bird</a></code>)</p>
</td></tr>
<tr><td><code id="findMinimumTimeSpeed_+3A_energydepositionrate">EnergyDepositionRate</code></td>
<td>
<p>The rate at which the bird accumulates energy at stopover sites</p>
</td></tr>
<tr><td><code id="findMinimumTimeSpeed_+3A_lower">lower</code></td>
<td>
<p> lower speed limit (optional)</p>
</td></tr>
<tr><td><code id="findMinimumTimeSpeed_+3A_upper">upper</code></td>
<td>
<p> upper speed limit (optional)</p>
</td></tr>
<tr><td><code id="findMinimumTimeSpeed_+3A_windspeed">windSpeed</code></td>
<td>
<p> wind magnitude (in m/s; optional)</p>
</td></tr>
<tr><td><code id="findMinimumTimeSpeed_+3A_winddir">windDir</code></td>
<td>
<p> wind direction (in degrees; optional)</p>
</td></tr>
<tr><td><code id="findMinimumTimeSpeed_+3A_...">...</code></td>
<td>
<p> optional arguments: <code>climbAngle</code> (in degrees), and optional arguments for <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a numerical optimization to find the airspeed that minimizes the combination of flight time and time required to (re)gain the energy reserves to cover the flight cost. If the bird would fly faster, it would need to spend more time refueling. If it flew slower, the reduced refueling time that comes with the lower cost of transport does not offset the longer flight time. Mathematically this problem works out as  minimizing <code class="reqn">\frac{P+P_\mathrm{dep}}{U}</code> <cite>Hedenström 1998</cite>, which is technically the same optimization as for the maximum range speed (see details <code><a href="#topic+findMaximumRangeSpeed">findMaximumRangeSpeed</a></code>). The default energy deposition rate, the rate at which a bird accumulates energy during a stopover, is set to 1.5 times the basal metabolic rate (<cite>Lindström 1991</cite>).
</p>


<h3>Value</h3>

<p>Returns data.frame (power.chemical) of flight performance at maximum range speed for <code>bird</code>.</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink
</p>


<h3>References</h3>

<p>Lindström, Å. (1991) Maximum fat deposition rates in migrating birds. <em>Ornis Scand.</em> <b>22</b>, 12-19 (doi:10.2307/3676616)
</p>
<p>Hedenström, A. &amp; Alerstam, T. (1997) Optimum fuel loads in migratory birds: distinguishing between time and energy minimization. <em>J. Theor. Biol.</em> <b>189</b>, 227–34. (doi:10.1006/jtbi.1997.0505)
</p>
<p>Hedenström, A. &amp; Alerstam, T. (1998) How fast can birds migrate? <em>J. Avian Biol.</em> <b>29</b>, 424-432. (doi:10.2307/3677161)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeChemicalPower">computeChemicalPower</a></code>, <code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define a bird:
myBird = Bird(
  massTotal = 0.215, #  (kg) total body mass
  wingSpan = 0.67, #  (m) maximum wing span
  wingArea = 0.0652, #  (m2) maximum wing area
  type = "passerine"
)

minimumTimeSpeed &lt;- findMinimumTimeSpeed(myBird,1.5*myBird$basalMetabolicRate)
minimumTimeSpeed[c('speed','speed.migration',
    'power','power.chem','power.dep',
    'strokeplane','amplitude','frequency')]
#     speed speed.migration   power power.chem power.dep strokeplane amplitude frequency
#  11.74944        1.962213 2.74058   15.36634  3.080752    16.49244  38.03366  5.948083


</code></pre>

<hr>
<h2 id='PowerToFroMechChem'>
Convert between mechanical and chemical power
</h2><span id='topic+mech2chem'></span><span id='topic+chem2mech'></span>

<h3>Description</h3>

<p>Functions convert between mechanical and chemical power
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mech2chem(power.mech,bird,...)
chem2mech(power.chem,bird,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PowerToFroMechChem_+3A_power.mech">power.mech</code></td>
<td>
<p>Numerical value for mechanical power</p>
</td></tr>
<tr><td><code id="PowerToFroMechChem_+3A_power.chem">power.chem</code></td>
<td>
<p>Numerical value for chemical power</p>
</td></tr>
<tr><td><code id="PowerToFroMechChem_+3A_bird">bird</code></td>
<td>
<p> object describing the relevant morphological parameters of the bird (or bat); this object should be created using the <code><a href="#topic+Bird">Bird</a></code> constructor.</p>
</td></tr>
<tr><td><code id="PowerToFroMechChem_+3A_...">...</code></td>
<td>
<p> optional arguments (none yet)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Chemical power is computed as
</p>
<p style="text-align: center;"><code class="reqn">P_\mathrm{chem} = R(\frac{P_\mathrm{mech}}{\eta} + \mathrm{BMR})</code>
</p>
<p> as described in <cite>Pennycuick 2008</cite>. Here <code class="reqn">R</code> is the respiration factor, <code class="reqn">\eta</code> is the muscle conversion efficiency and <code class="reqn">\mathrm{BMR}</code> the basal metabolic rate, see <code><a href="#topic+Bird">Bird</a></code>.
</p>
<p>Mechanical power is simply calculated inversely:
</p>
<p style="text-align: center;"><code class="reqn">P_\mathrm{mech} = \eta(\frac{P_\mathrm{chem}}{R} - \mathrm{BMR})</code>
</p>



<h3>Value</h3>

<p>Numerical value of either chemical power (<code>mech2chem()</code>) or mechanical power (<code>chem2mech()</code>).
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink</p>


<h3>References</h3>

<p>Pennycuick, C. J. (2008). <em>Modelling the flying bird.</em> Amsterdam, The Netherlands: Elsevier.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeChemicalPower">computeChemicalPower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Define a bird:
myBird = Bird(
  massTotal = 0.215, #  (kg) total body mass
  wingSpan = 0.67, #  (m) maximum wing span
  wingArea = 0.0652, #  (m2) maximum wing area
  type = "passerine"
)

## define a speed range
speedrange &lt;- seq(5,14,length.out=5)

## compute aerodynamic power for that speed range:
Paero &lt;- computeFlappingPower(myBird,speedrange)
Pchem &lt;- Paero
Pchem$power &lt;- mech2chem(Paero$power,myBird)
print(Pchem[c("speed","power","frequency","strokeplane")])
#   speed    power frequency strokeplane
# 1  5.00 15.60151  5.948083    46.56887
# 2  7.25 12.44362  5.948083    31.89129
# 3  9.50 12.79900  5.948083    22.51896
# 4 11.75 15.36721  5.948083    16.49120
# 5 14.00 19.82915  5.948083    12.09174

Pmech &lt;- Pchem
Pmech$power &lt;- chem2mech(Pchem$power,myBird)
print(Pmech[c("speed","power","frequency","strokeplane")])
#   speed    power frequency strokeplane
# 1  5.00 2.789751  5.948083    46.56887
# 2  7.25 2.129466  5.948083    31.89129
# 3  9.50 2.203773  5.948083    22.51896
# 4 11.75 2.740763  5.948083    16.49120
# 5 14.00 3.673714  5.948083    12.09174
</code></pre>

<hr>
<h2 id='reducedFrequency'>
Function to compute reduced frequency</h2><span id='topic+reducedFrequency'></span>

<h3>Description</h3>

<p>This function computes the reduced frequency based on <code>wingSpan</code> (<code class="reqn">b</code>), wingbeat <code>frequency</code> (<code class="reqn">f</code>) and <code>speed</code> (<code class="reqn">U</code>):
<code class="reqn">k_f = \frac{2\pi b f}{U}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reducedFrequency(wingSpan, frequency, speed)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reducedFrequency_+3A_wingspan">wingSpan</code></td>
<td>
<p>Tip-to-tip distance of the fully spread wing (m)</p>
</td></tr>
<tr><td><code id="reducedFrequency_+3A_frequency">frequency</code></td>
<td>
<p>Wingbeat frequency (1/s)</p>
</td></tr>
<tr><td><code id="reducedFrequency_+3A_speed">speed</code></td>
<td>
<p>Airspeed (m/s)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This parameter is the ratio of the wingspan to the wavelength of the convected wake. For very high reduced frequencies, the wake of one wingbeat is relatively short compared to the wingspan, meaning that previous wingbeats have a large influence on the aerodynamics of the current wingbeat. When the reduced frequency is low, there is relatively little interaction between the wingbeats.
</p>
<p>This wingspan based reduced frequency should not be confused with the chord based (or half chord) based reduced frequency. That definition serves a similar function, however, it relates to the effect of unsteadyness on the aerofoil (i.e. it is somewhat like the 2D equivalent).
</p>
<p>Another related parameter of unsteadyness, often mentioned in relation to animal flight, is the Strouhal number, representing the ratio of the amplitude of the wingbeat to the wavelength of the wake. This term is historically related to vortex shedding.
</p>


<h3>Value</h3>

<p>Numeric value
</p>


<h3>Author(s)</h3>

<p>Marco Klein Heerenbrink
</p>


<h3>References</h3>

<p>Klein Heerenbrink, M., Johansson, L. C. and Hedenström, A. 2015 Power of the wingbeat: modelling the effects of flapping wings in vertebrate flight. <em>Proc. R. Soc. A</em> <b>471</b>, 2177 <a href="https://doi.org/10.1098/rspa.2014.0952">doi:10.1098/rspa.2014.0952</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeFlappingPower">computeFlappingPower</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kf &lt;- reducedFrequency(
  wingSpan = 0.67,
  frequency = 4,
  speed = 9
)
kf
# [1] 1.870993
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
