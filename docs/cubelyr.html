<!DOCTYPE html><html lang="en"><head><title>Help for package cubelyr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cubelyr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cubelyr-package'><p>cubelyr: A Data Cube 'dplyr' Backend</p></a></li>
<li><a href='#as.table.tbl_cube'><p>Coerce a <code>tbl_cube</code> to other data structures</p></a></li>
<li><a href='#as.tbl_cube'><p>Coerce an existing data structure into a <code>tbl_cube</code></p></a></li>
<li><a href='#nasa'><p>NASA spatio-temporal data</p></a></li>
<li><a href='#tbl_cube'><p>A data cube tbl</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>A Data Cube 'dplyr' Backend</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of a data cube extracted out of 'dplyr' for
    backward compatibility.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hadley/cubelyr">https://github.com/hadley/cubelyr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hadley/cubelyr/issues">https://github.com/hadley/cubelyr/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, glue, pillar, purrr, rlang, tibble, tidyselect</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat (&ge; 2.1.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-07 15:36:26 UTC; hadleywickham</td>
</tr>
<tr>
<td>Author:</td>
<td>Hadley Wickham [aut, cre],
  RStudio [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hadley Wickham &lt;hadley@rstudio.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-07 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cubelyr-package'>cubelyr: A Data Cube 'dplyr' Backend</h2><span id='topic+cubelyr'></span><span id='topic+cubelyr-package'></span>

<h3>Description</h3>

<p>An implementation of a data cube extracted out of 'dplyr' for backward compatibility.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Hadley Wickham <a href="mailto:hadley@rstudio.com">hadley@rstudio.com</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> RStudio [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/hadley/cubelyr">https://github.com/hadley/cubelyr</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/hadley/cubelyr/issues">https://github.com/hadley/cubelyr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='as.table.tbl_cube'>Coerce a <code>tbl_cube</code> to other data structures</h2><span id='topic+as.table.tbl_cube'></span><span id='topic+as.data.frame.tbl_cube'></span><span id='topic+as_tibble.tbl_cube'></span>

<h3>Description</h3>

<p>Supports conversion to tables, data frames, tibbles.
</p>
<p>For a cube, the data frame returned by
<code><a href="tibble.html#topic+as_tibble">tibble::as_tibble()</a></code> resulting data frame contains the
dimensions as character values (and not as factors).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tbl_cube'
as.table(x, ..., measure = 1L)

## S3 method for class 'tbl_cube'
as.data.frame(x, ...)

## S3 method for class 'tbl_cube'
as_tibble(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.table.tbl_cube_+3A_x">x</code></td>
<td>
<p>a <code>tbl_cube</code></p>
</td></tr>
<tr><td><code id="as.table.tbl_cube_+3A_...">...</code></td>
<td>
<p>Passed on to individual methods; otherwise ignored.</p>
</td></tr>
<tr><td><code id="as.table.tbl_cube_+3A_measure">measure</code></td>
<td>
<p>A measure name or index, default: the first measure</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table, data frame, or tibble, as appropriate.
</p>

<hr>
<h2 id='as.tbl_cube'>Coerce an existing data structure into a <code>tbl_cube</code></h2><span id='topic+as.tbl_cube'></span><span id='topic+as.tbl_cube.array'></span><span id='topic+as.tbl_cube.table'></span><span id='topic+as.tbl_cube.matrix'></span><span id='topic+as.tbl_cube.data.frame'></span>

<h3>Description</h3>

<p>Coerce an existing data structure into a <code>tbl_cube</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.tbl_cube(x, ...)

## S3 method for class 'array'
as.tbl_cube(
  x,
  dim_names = names(dimnames(x)),
  met_name = deparse(substitute(x)),
  ...
)

## S3 method for class 'table'
as.tbl_cube(x, dim_names = names(dimnames(x)), met_name = "Freq", ...)

## S3 method for class 'matrix'
as.tbl_cube(
  x,
  dim_names = names(dimnames(x)),
  met_name = deparse(substitute(x)),
  ...
)

## S3 method for class 'data.frame'
as.tbl_cube(x, dim_names = NULL, met_name = guess_met(x), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.tbl_cube_+3A_x">x</code></td>
<td>
<p>an object to convert. Built in methods will convert arrays,
tables and data frames.</p>
</td></tr>
<tr><td><code id="as.tbl_cube_+3A_...">...</code></td>
<td>
<p>Passed on to individual methods; otherwise ignored.</p>
</td></tr>
<tr><td><code id="as.tbl_cube_+3A_dim_names">dim_names</code></td>
<td>
<p>names of the dimensions. Defaults to the names of
the <code><a href="base.html#topic+dimnames">dimnames()</a></code>.</p>
</td></tr>
<tr><td><code id="as.tbl_cube_+3A_met_name">met_name</code></td>
<td>
<p>a string to use as the name for the measure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tbl_cube</code>.
</p>

<hr>
<h2 id='nasa'>NASA spatio-temporal data</h2><span id='topic+nasa'></span>

<h3>Description</h3>

<p>This data comes from the ASA 2007 data expo,
<a href="https://community.amstat.org/jointscsg-section/dataexpo/dataexpo2006">https://community.amstat.org/jointscsg-section/dataexpo/dataexpo2006</a>.
The data are geographic and
atmospheric measures on a very coarse 24 by 24 grid covering Central
America. The variables are: temperature (surface and air), ozone,
air pressure, and cloud cover (low, mid, and high). All variables are
monthly averages, with observations for Jan 1995 to Dec 2000. These data
were obtained from the NASA Langley Research Center Atmospheric Sciences
Data Center (with permission; see important copyright terms below).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nasa
</code></pre>


<h3>Format</h3>

<p>A <a href="#topic+tbl_cube">tbl_cube</a> with 41,472 observations.
</p>


<h3>Dimensions</h3>


<ul>
<li> <p><code>lat</code>, <code>long</code>: latitude and longitude
</p>
</li>
<li> <p><code>year</code>, <code>month</code>: month and year
</p>
</li></ul>



<h3>Measures</h3>


<ul>
<li> <p><code>cloudlow</code>, <code>cloudmed</code>, <code>cloudhigh</code>: cloud cover
at three heights
</p>
</li>
<li> <p><code>ozone</code>
</p>
</li>
<li> <p><code>surftemp</code> and <code>temperature</code>
</p>
</li>
<li> <p><code>pressure</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>nasa
</code></pre>

<hr>
<h2 id='tbl_cube'>A data cube tbl</h2><span id='topic+tbl_cube'></span>

<h3>Description</h3>

<p>A cube tbl stores data in a compact array format where dimension
names are not needlessly repeated. They are particularly appropriate for
experimental data where all combinations of factors are tried (e.g.
complete factorial designs), or for storing the result of aggregations.
Compared to data frames, they will occupy much less memory when variables
are crossed, not nested.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tbl_cube(dimensions, measures)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tbl_cube_+3A_dimensions">dimensions</code></td>
<td>
<p>A named list of vectors. A dimension is a variable
whose values are known before the experiment is conducted; they are
fixed by design (in <span class="pkg">reshape2</span> they are known as id variables).
<code>tbl_cubes</code> are dense which means that almost every combination of
the dimensions should have associated measurements: missing values require
an explicit NA, so if the variables are nested, not crossed, the
majority of the data structure will be empty. Dimensions are typically,
but not always, categorical variables.</p>
</td></tr>
<tr><td><code id="tbl_cube_+3A_measures">measures</code></td>
<td>
<p>A named list of arrays. A measure is something that is
actually measured, and is not known in advance. The dimension of each
array should be the same as the length of the dimensions. Measures are
typically, but not always, continuous values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>tbl_cube</code> support is currently experimental and little performance
optimisation has been done, but you may find them useful if your data
already comes in this form, or you struggle with the memory overhead of the
sparse/crossed of data frames.  There is no support for hierarchical
indices (although I think that would be a relatively straightforward
extension to storing data frames for indices rather than vectors).
</p>


<h3>Value</h3>

<p>A new data cube with class <code>tbl_cube</code>.
</p>


<h3>Implementation</h3>

<p>Manipulation functions:
</p>

<ul>
<li> <p><code>select()</code> (M)
</p>
</li>
<li> <p><code>summarise()</code> (M), corresponds to roll-up, but rather more
limited since there are no hierarchies.
</p>
</li>
<li> <p><code>filter()</code> (D), corresponds to slice/dice.
</p>
</li>
<li> <p><code>mutate()</code> (M) is not implemented, but should be relatively
straightforward given the implementation of <code>summarise</code>.
</p>
</li>
<li> <p><code>arrange()</code> (D?) Not implemented: not obvious how much sense
it would make
</p>
</li></ul>

<p>Joins: not implemented. See <code>vignettes/joins.graffle</code> for ideas.
Probably straightforward if you get the indexes right, and that's probably
some straightforward array/tensor operation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as.tbl_cube">as.tbl_cube()</a></code> for ways of coercing existing data
structures into a <code>tbl_cube</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
# The built in nasa dataset records meterological data (temperature,
# cloud cover, ozone etc) for a 4d spatio-temporal dataset (lat, long,
# month and year)
nasa
head(as.data.frame(nasa))

titanic &lt;- as.tbl_cube(Titanic)
head(as.data.frame(titanic))

admit &lt;- as.tbl_cube(UCBAdmissions)
head(as.data.frame(admit))

as.tbl_cube(esoph, dim_names = 1:3)

# Some manipulation examples with the NASA dataset --------------------------

# select() operates only on measures: it doesn't affect dimensions in any way
select(nasa, cloudhigh:cloudmid)
select(nasa, matches("temp"))

# filter() operates only on dimensions
filter(nasa, lat &gt; 0, year == 2000)
# Each component can only refer to one dimensions, ensuring that you always
# create a rectangular subset
## Not run: filter(nasa, lat &gt; long)

# Arrange is meaningless for tbl_cubes

by_loc &lt;- group_by(nasa, lat, long)
summarise(by_loc, pressure = max(pressure), temp = mean(temperature))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
