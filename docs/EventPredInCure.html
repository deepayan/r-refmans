<!DOCTYPE html><html><head><title>Help for package EventPredInCure</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EventPredInCure}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EventPredInCure-package'><p>Event Prediction Including Cured Population</p></a></li>
<li><a href='#b4pst'><p>Function to calculate survival time and censor variables before and post a time lag (delay treatment effect time)</p></a></li>
<li><a href='#Chen_2016_event_time'><p>Function to generate event time in the existence of cured population</p></a></li>
<li><a href='#Chen_2016_event_time_abovetime0'><p>Function to generate event time based on Chen 2016 method for ongoing subject</p></a></li>
<li><a href='#Chen_2016_event_time_piecewise_exp_abovetime0'><p>Function to generate event time with piecewise exponential distribution for ongoing subject in the existence of cured population</p></a></li>
<li><a href='#FH_test'><p>Fleming-Harrington weighted log-rank tests</p></a></li>
<li><a href='#finalData'><p>Final enrollment and event data after achieving the target number of events</p></a></li>
<li><a href='#fitDropout'><p>Fit time-to-dropout model</p></a></li>
<li><a href='#fitEnrollment'><p>Fit enrollment model</p></a></li>
<li><a href='#fitEvent'><p>Fit time-to-event model</p></a></li>
<li><a href='#getPrediction'><p>Enrollment and event prediction</p></a></li>
<li><a href='#interimData1'><p>Interim enrollment and event data before enrollment completion</p></a></li>
<li><a href='#interimData2'><p>Interim enrollment and event data after enrollment completion</p></a></li>
<li><a href='#loglik_Chen_exponential'><p>Log-likelihood function for exponential distribution with cured population</p></a></li>
<li><a href='#loglik_Chen_log_logistic'><p>Log-likelihood function for log-logistic distribution with cured population</p></a></li>
<li><a href='#loglik_Chen_log_normal'><p>Log-likelihood function for log-normal distribution with cured population</p></a></li>
<li><a href='#loglik_Chen_piecewise_exponential'><p>Log-likelihood function for piecewise-exponential distribution with cured population</p></a></li>
<li><a href='#loglik_Chen_weibull'><p>Log-likelihood function for Weibull distribution with cured population</p></a></li>
<li><a href='#predictEnrollment'><p>Predict enrollment</p></a></li>
<li><a href='#predictEvent'><p>Predict event time for ongoing subjects with or without cured population.</p></a></li>
<li><a href='#smed'><p>Function to output summary statistics from survfit function output</p></a></li>
<li><a href='#SP_Chen_exponential'><p>Survival probability function of the exponential distribution with cured population</p></a></li>
<li><a href='#SP_Chen_log_logistic'><p>Survival probability function of the log-logistic distribution with cured population</p></a></li>
<li><a href='#SP_Chen_log_normal'><p>Survival probability function of the log-normal distribution with cured population</p></a></li>
<li><a href='#SP_Chen_piecewise_exponential'><p>Survival probability function of the piecewise exponential distribution with cured population</p></a></li>
<li><a href='#SP_Chen_weibull'><p>Survival probability function of the Weibull distribution with cured population</p></a></li>
<li><a href='#summarizeObserved'><p>Summarize observed data</p></a></li>
<li><a href='#test_plot'><p>Function to plot KM plot for time-to-event data in simulation</p></a></li>
<li><a href='#test_procedure'><p>Function to provide summary and test statistics based on simulation.</p></a></li>
<li><a href='#tte'><p>Calculating log-rank test p-value, median time from each arm, hazard ratio between two arms, number of subjects and events in time-to-event outcomes.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Event Prediction Including Cured Population</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-19</td>
</tr>
<tr>
<td>Description:</td>
<td>Predicts enrollment and events assumed enrollment and treatment-specific time-to-event models, and calculates test statistics for time-to-event data with cured population based on the simulation.Methods for prediction event in the existence of cured population are as described in : Chen, Tai-Tsang(2016) &lt;<a href="https://doi.org/10.1186%2Fs12874-016-0117-3">doi:10.1186/s12874-016-0117-3</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>perm (&ge; 1.0.0.2), msm (&ge; 1.7.0), MLEcens (&ge; 0.1.7), KMsurv
(&ge; 0.1.5), dplyr (&ge; 1.1.0), rlang (&ge; 1.0.6), plotly (&ge;
4.10.1), survival (&ge; 2.41-3), splines (&ge; 3.5.0), Matrix (&ge;
1.2-14), mvtnorm (&ge; 1.1-3), rstpm2 (&ge; 1.6.1), numDeriv (&ge;
2016.8-1.1), tmvtnsim (&ge; 0.1.3), erify (&ge; 0.4.0), stats (&ge;
3.5.0), utils (&ge; 4.1.2), lubridate (&ge; 1.9.2), flexsurv (&ge;
2.2.2), MASS (&ge; 7.3.54)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-11 21:53:14 UTC; bo1.wei@beigenecorp.net</td>
</tr>
<tr>
<td>Author:</td>
<td>Bo Wei <a href="https://orcid.org/0000-0002-4430-2882"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Kaifeng Lu <a href="https://orcid.org/0000-0002-6160-7119"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Brent McHenry [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bo Wei &lt;bowei1990@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-12 10:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='EventPredInCure-package'>Event Prediction Including Cured Population</h2><span id='topic+EventPredInCure-package'></span>

<h3>Description</h3>

<p>Predicts enrollment and events
using assumed enrollment and/or treatment-specific time-to-event models
in the existence of the cured population. Calculate test statistics based on
the simulated data sets from the assumed enrollment and/or treatment-specific
time-to-event models in the existence of the cured population.
</p>


<h3>Details</h3>

<p>Accurately predicting the date at which a target number
of subjects or events will be achieved is critical for the planning,
monitoring, and execution of clinical trials in the existence of the cured
population. The <code>EventPredInCure</code> package provides enrollment and event
prediction capabilities using assumed enrollment and treatment-specific
time-to-event models and calculate test statistics based on the simulated
data sets from the assumed enrollment and/or treatment-specific time-to-event
models in the existence of the cured population.
</p>
<p>At the design stage, enrollment is often specified using a
piecewise Poisson process with a constant enrollment rate
during each specified time interval. At the analysis stage,
before enrollment completion, the <code>EventPredInCure</code> package
considers several models, including the homogeneous Poisson
model, the time-decay model with an enrollment
rate function <code>lambda(t) = mu/delta*(1 - exp(-delta*t))</code>,
the B-spline model with the daily enrollment rate
<code>lambda(t) = exp(B(t)*theta)</code>, and the piecewise Poisson model.
If prior information exists on the model parameters, it can
be combined with the likelihood to yield the posterior distribution.
</p>
<p>The <code>EventPredInCure</code> package offers several time-to-event models
without cured-population,including exponential, Weibull, log-logistic,
log-normal, piecewise exponential, model averaging of Weibull and log-normal,
and spline. The models including exponential, Weibull, log-logistic,
log-normal, piecewise exponential are extended to account cured-population.
In the design stage, the models including exponential, Weibull, log-logistic,
log-normal, piecewise exponential are also extended for delayed treatment
effect setting (only for generating simulated data sets in the design stage).
For time to dropout, the same set of model without cured-population and
delayed treatment effect options are considered. If enrollment is complete,
ongoing subjects who have not had the event of interest or dropped out of the
study before the data cut contribute additional events in the future.
Their event times are generated from the conditional distribution given that
they have survived at the data cut. For new subjects that need to be enrolled,
their enrollment time and event time can be generated from the
specified enrollment and time-to-event models with parameters
drawn from the posterior distribution. Time-to-dropout can be
generated in a similar fashion.
</p>
<p>The <code>EventPredInCure</code> package displays the Akaike Information
Criterion (AIC), the Bayesian Information
Criterion (BIC) and a fitted curve overlaid with observed data
to help users select the most appropriate model for enrollment
and event prediction. Prediction intervals in the prediction plot
can be used to measure prediction uncertainty, and the simulated
enrollment and event data can be used for further data exploration.
</p>
<p>The most useful function in the <code>EventPredInCure</code> package is
<code>getPrediction</code>, which combines model fitting, data simulation,
and a summary of simulation results. Other functions perform
individual tasks and can be used to select an appropriate
prediction model.
</p>
<p>The <code>EventPredInCure</code> package implements a model
parameterization that enhances the asymptotic normality of
parameter estimates. Specifically, the package utilizes the
following parameterization to achieve this goal:
</p>

<ul>
<li><p> Enrollment models
</p>

<ul>
<li><p> Poisson: <code>theta = log(rate)</code>
</p>
</li>
<li><p> Time-decay: <code>theta = c(log(mu), log(delta))</code>
</p>
</li>
<li><p> B-spline: no reparametrization is needed. The
knots as considered fixed.
</p>
</li>
<li><p> Piecewise Poisson: <code>theta = log(rates)</code>.
The left endpoints of time intervals, denoted as
<code>accrualTime</code>, are considered fixed.
</p>
</li></ul>

</li>
<li><p> Event or dropout models
</p>

<ul>
<li><p> Exponential: <code>theta = log(rate)</code>
</p>
</li>
<li><p> Weibull: <code>theta = c(log(scale), -log(shape))</code>
</p>
</li>
<li><p> Log-logistic: <code>theta = c(log(scale), -log(shape))</code>
</p>
</li>
<li><p> Log-normal: <code>theta = c(meanlog, log(sdlog))</code>
</p>
</li>
<li><p> Piecewise exponential: <code>theta = log(rates)</code>.
The left endpoints of time intervals, denoted as
<code>piecewiseSurvivalTime</code> for event model and
<code>piecewiseDropoutTime</code> for dropout model, are
considered fixed.
</p>
</li>
<li><p> Model averaging: <code>theta = c(log(weibull$scale),
    -log(weibull$shape), lnorm$meanlog, log(lnorm$sdlog))</code>.
The covariance matrix for <code>theta</code> is structured
as a block diagonal matrix, with the upper-left block
corresponding to the Weibull component and the
lower-right block corresponding to the log-normal
component. In other words, the covariance matrix is
partitioned into two distinct blocks, with no
off-diagonal elements connecting the two components.
The weight assigned to the Weibull component, denoted as
<code>w1</code>, is considered fixed.
</p>
</li>
<li><p> Spline: <code>theta</code> corresponds to the coefficients
of basis vectors. The <code>knots</code> and <code>scale</code>
are considered fixed. The <code>scale</code> can be hazard,
odds, or normal, corresponding to extensions of Weibull,
log-logistic, and log-normal distributions, respectively.
</p>
</li></ul>

</li></ul>

<p>The <code>EventPredInCure</code> package uses days as its primary time unit.
If you need to convert enrollment or event rates per month to
rates per day, simply divide by 30.4375.
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li>
<li><p> Royston, Patrick, and Mahesh KB Parmar.
&quot;Flexible parametric proportional‐hazards and proportional‐odds models for censored survival data,
with application to prognostic modelling and estimation of treatment effects.&quot;
Statistics in medicine 21.15 (2002): 2175-2197.
</p>
</li>
<li><p> Bagiella, Emilia, and Daniel F. Heitjan. &quot;Predicting analysis times in randomized clinical trials.&quot;
Statistics in medicine 20.14 (2001): 2055-2063.
</p>
</li>
<li><p> Ying, Gui‐shuang, and Daniel F. Heitjan. &quot;Weibull prediction of event times in clinical trials.&quot;
Pharmaceutical Statistics:
The Journal of Applied Statistics in the Pharmaceutical Industry 7.2 (2008): 107-120.
</p>
</li>
<li><p> Zhang, Xiaoxi, and Qi Long. &quot;Stochastic modeling and prediction for accrual in clinical trials.&quot;
Statistics in Medicine 29.6 (2010): 649-658.
</p>
</li></ul>


<hr>
<h2 id='b4pst'>Function to calculate survival time and censor variables before and post a time lag (delay treatment effect time)</h2><span id='topic+b4pst'></span>

<h3>Description</h3>

<p>calculate survival time and censor variables before and post a time lag.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b4pst(os, osc, lag)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b4pst_+3A_os">os</code></td>
<td>
<p>a vector to denote the observed times</p>
</td></tr>
<tr><td><code id="b4pst_+3A_osc">osc</code></td>
<td>
<p>a vector to denote censor variables</p>
</td></tr>
<tr><td><code id="b4pst_+3A_lag">lag</code></td>
<td>
<p>a scalar to denote the time lag</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list including the following variables:
</p>

<ul>
<li><p> b4os: overall survival time before the time lag
</p>
</li>
<li><p> b4osc: censor variable before the time lag
</p>
</li>
<li><p> pstos: overall survival time post the time lag
</p>
</li>
<li><p> pstosc: censor variable post the time log lag
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 500
event &lt;- runif(n,1, 5)
osc&lt;-1*(event&lt;=4)
os &lt;- pmin(event,4)
b4pst(os,osc,3.5)

</code></pre>

<hr>
<h2 id='Chen_2016_event_time'>Function to generate event time in the existence of cured population</h2><span id='topic+Chen_2016_event_time'></span>

<h3>Description</h3>

<p>generate event time under the delay-treatment effect and cured population setting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Chen_2016_event_time(u, hr, distribution, p, lag, a, b, mu, sd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Chen_2016_event_time_+3A_u">u</code></td>
<td>
<p>a scalar with between 0 and 1</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_+3A_hr">hr</code></td>
<td>
<p>hazard ratio if this subject in the corresponding arm vs control arm</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_+3A_distribution">distribution</code></td>
<td>
<p>the distribution for the control arm, valid values of inputs include: exponential, weibull, log-normal, log-logistic</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_+3A_p">p</code></td>
<td>
<p>the proportion of cured population in the control arm</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_+3A_lag">lag</code></td>
<td>
<p>delayed treatment effect time after treatment initialization, when the hr between treatment arm and control =1 until lag time</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_+3A_a">a</code></td>
<td>
<p>the shape parameter in the Weibull or the log-logistic distribution</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_+3A_b">b</code></td>
<td>
<p>the scale parameter in the exponential, Weibull or the log-logistic distribution</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_+3A_mu">mu</code></td>
<td>
<p>the mean in the log-normal distribution</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_+3A_sd">sd</code></td>
<td>
<p>the standard deviation in the log-normal distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the event time
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='Chen_2016_event_time_abovetime0'>Function to generate event time based on Chen 2016 method for ongoing subject</h2><span id='topic+Chen_2016_event_time_abovetime0'></span>

<h3>Description</h3>

<p>generate event time under the delay-treatment effect and cured population setting given T&gt;time0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Chen_2016_event_time_abovetime0(u, distribution, p, time0, a, b, mu, sd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Chen_2016_event_time_abovetime0_+3A_u">u</code></td>
<td>
<p>a scalar with between 0 and 1</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_abovetime0_+3A_distribution">distribution</code></td>
<td>
<p>the distribution for the control arm, valid values of inputs include: exponential, weibull, log-normal, log-logistic</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_abovetime0_+3A_p">p</code></td>
<td>
<p>the proportion of cured population in the control arm</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_abovetime0_+3A_time0">time0</code></td>
<td>
<p>the observed ongoing survival time</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_abovetime0_+3A_a">a</code></td>
<td>
<p>the shape parameter in the Weibull or the log-logistic distribution</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_abovetime0_+3A_b">b</code></td>
<td>
<p>the scale parameter in the exponential, Weibull or the log-logistic distribution</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_abovetime0_+3A_mu">mu</code></td>
<td>
<p>the mean in the log-normal distribution</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_abovetime0_+3A_sd">sd</code></td>
<td>
<p>the standard deviation in the log-normal distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the event time
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='Chen_2016_event_time_piecewise_exp_abovetime0'>Function to generate event time with piecewise exponential distribution for ongoing subject in the existence of cured population</h2><span id='topic+Chen_2016_event_time_piecewise_exp_abovetime0'></span>

<h3>Description</h3>

<p>generate event time under the delay-treatment effect and cured population setting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Chen_2016_event_time_piecewise_exp_abovetime0(
  u,
  p,
  time0 = 0,
  piecewiseSurvivalTime = 0,
  piecewisehazard
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Chen_2016_event_time_piecewise_exp_abovetime0_+3A_u">u</code></td>
<td>
<p>a scalar with between 0 and 1, which is the conditional survival probability at the event time.</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_piecewise_exp_abovetime0_+3A_p">p</code></td>
<td>
<p>the proportion of cured population in the control arm</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_piecewise_exp_abovetime0_+3A_time0">time0</code></td>
<td>
<p>the observed ongoing survival time</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_piecewise_exp_abovetime0_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the time
intervals for the piecewise exponential survival distribution.
Must start with 0, e.g., c(0, 60) breaks the time axis into 2
event intervals: [0, 60) and [60, Inf). By default, it is set to 0.</p>
</td></tr>
<tr><td><code id="Chen_2016_event_time_piecewise_exp_abovetime0_+3A_piecewisehazard">piecewisehazard</code></td>
<td>
<p>A vector that specifies the hazard rate in
intervals for the piecewise exponential survival distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the event time
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='FH_test'>Fleming-Harrington weighted log-rank tests</h2><span id='topic+FH_test'></span>

<h3>Description</h3>

<p>Calculating the Fleming-Harrington weighted log-rank tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FH_test(survival, delta, trt, rho, gamma, test = c("Futility"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FH_test_+3A_survival">survival</code></td>
<td>
<p>Time to event or censoring.</p>
</td></tr>
<tr><td><code id="FH_test_+3A_delta">delta</code></td>
<td>
<p>Event indicators.</p>
</td></tr>
<tr><td><code id="FH_test_+3A_trt">trt</code></td>
<td>
<p>Treatment assignment indicator with 1 denoting the treated group, and 0 denoting the placebo group.</p>
</td></tr>
<tr><td><code id="FH_test_+3A_rho">rho</code></td>
<td>
<p>First power parameter for the Fleming-Harrington weight which weighs on the early departures: <code class="reqn">S(t^-)^\rho(1-S(t^-))^\gamma</code>.</p>
</td></tr>
<tr><td><code id="FH_test_+3A_gamma">gamma</code></td>
<td>
<p>Second power parameter for the Fleming-Harrington weight which weighs on the late departures: <code class="reqn">S(t^-)^\rho(1-S(t^-))^\gamma</code>.</p>
</td></tr>
<tr><td><code id="FH_test_+3A_test">test</code></td>
<td>
<p>a character denotes the test type, include &quot;Superiority&quot;,&quot;Futility&quot;,&quot;Two-sided&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list 3 different components
</p>
<table>
<tr><td><code>O1</code></td>
<td>
<p>Observed number of weighted events (with a multiplication of corresponding weights) in the treatment arm.</p>
</td></tr>
<tr><td><code>E1</code></td>
<td>
<p>Expected number of weighted events (with a multiplication of corresponding weights) in the treatment arm.</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>Weighted log-rank test statistic.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>Weighted log-rank test statistic pvalue</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 500
event &lt;- runif(n,1, 5)
osc&lt;-1*(event&lt;=4)
os &lt;- pmin(event,4)
trt&lt;-c(rep(0,n/2),rep(1,n/2))
FH_test(os,osc,trt,rho=1,gamma=0)

</code></pre>

<hr>
<h2 id='finalData'>Final enrollment and event data after achieving the target number of events</h2><span id='topic+finalData'></span>

<h3>Description</h3>

<p>A data frame with 300 rows and 7 columns:
</p>

<dl>
<dt><code>trialsdt</code></dt><dd><p>The trial start date</p>
</dd>
<dt><code>usubjid</code></dt><dd><p>The unique subject ID</p>
</dd>
<dt><code>randdt</code></dt><dd><p>The randomization date</p>
</dd>
<dt><code>treatment</code></dt><dd><p>The treatment group number</p>
</dd>
<dt><code>treatment_description</code></dt><dd><p>Description of the treatment group</p>
</dd>
<dt><code>time</code></dt><dd><p>The day of event or censoring since randomization</p>
</dd>
<dt><code>event</code></dt><dd><p>The event indicator: 1 for event, 0 for non-event</p>
</dd>
<dt><code>dropout</code></dt><dd><p>The dropout indicator: 1 for dropout,
0 for non-dropout</p>
</dd>
<dt><code>cutoffdt</code></dt><dd><p>The cutoff date</p>
</dd>
</dl>

<p>For ongoing subjects, both <code>event</code> and <code>dropout</code> are equal to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>finalData
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 300 rows and 9 columns.
</p>

<hr>
<h2 id='fitDropout'>Fit time-to-dropout model</h2><span id='topic+fitDropout'></span>

<h3>Description</h3>

<p>Fits a specified time-to-dropout model to the dropout data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitDropout(
  df,
  dropout_model = "exponential",
  piecewiseDropoutTime = 0,
  by_treatment = FALSE,
  criterion = "both"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitDropout_+3A_df">df</code></td>
<td>
<p>The subject-level dropout data, including <code>time</code> and
<code>dropout</code>. The data should also include <code>treatment</code>
coded as 1, 2, and so on, and <code>treatment_description</code>
for fitting the dropout model by treatment.</p>
</td></tr>
<tr><td><code id="fitDropout_+3A_dropout_model">dropout_model</code></td>
<td>
<p>The dropout model used to analyze the dropout data
which can be set to one of the following options: &quot;exponential&quot;,
&quot;Weibull&quot;, &quot;log-logistic&quot;, &quot;log-normal&quot;, or &quot;piecewise exponential&quot;.
By default, it is set to &quot;exponential&quot;.</p>
</td></tr>
<tr><td><code id="fitDropout_+3A_piecewisedropouttime">piecewiseDropoutTime</code></td>
<td>
<p>A vector that specifies the time
intervals for the piecewise exponential dropout distribution.
Must start with 0, e.g., c(0, 60) breaks the time axis into 2
event intervals: [0, 60) and [60, Inf). By default, it is set to 0.</p>
</td></tr>
<tr><td><code id="fitDropout_+3A_by_treatment">by_treatment</code></td>
<td>
<p>A Boolean variable to control whether or not to
fit the time-to-dropout data by treatment group. By default,
it is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitDropout_+3A_criterion">criterion</code></td>
<td>
<p>A character variable to denote the criterion in model
selection to shown in the figure, which can be set to one of the following
options: &quot;aic&quot;,&quot;bic&quot; or &quot;both&quot;. By default,it is set to <code>both</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results from the model fit including key information
such as the dropout model, <code>model</code>, the estimated model parameters,
<code>theta</code>, the covariance matrix, <code>vtheta</code>, as well as the
Bayesian Information Criterion, <code>bic</code>, and Akaike Information Criterion, <code>aic</code>.
</p>
<p>If the piecewise exponential model is used, the location
of knots used in the model, <code>piecewiseDropoutTime</code>, will
be included in the list of results.
</p>
<p>When fitting the dropout model by treatment, the outcome is presented
as a list of lists, where each list element corresponds to a
specific treatment group.
</p>
<p>The fitted time-to-dropout survival curve is also returned.
</p>


<h3>References</h3>


<ul>
<li><p> Royston, Patrick, and Mahesh KB Parmar.
&quot;Flexible parametric proportional‐hazards and proportional‐odds models for censored survival data,
with application to prognostic modelling and estimation of treatment effects.&quot;
Statistics in medicine 21.15 (2002): 2175-2197.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
dropout_fit &lt;- fitDropout(df = interimData2,
                          dropout_model = "exponential")

</code></pre>

<hr>
<h2 id='fitEnrollment'>Fit enrollment model</h2><span id='topic+fitEnrollment'></span>

<h3>Description</h3>

<p>Fits a specified enrollment model to the enrollment data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitEnrollment(
  df,
  enroll_model = "b-spline",
  nknots = 0,
  accrualTime = 0,
  criterion = "both"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitEnrollment_+3A_df">df</code></td>
<td>
<p>The subject-level enrollment data, including <code>trialsdt</code>,
<code>randdt</code> and <code>cutoffdt</code>.</p>
</td></tr>
<tr><td><code id="fitEnrollment_+3A_enroll_model">enroll_model</code></td>
<td>
<p>The enrollment model which can be specified as
&quot;Poisson&quot;, &quot;Time-decay&quot;, &quot;B-spline&quot;, or
&quot;Piecewise Poisson&quot;. By default, it is set to &quot;B-spline&quot;.</p>
</td></tr>
<tr><td><code id="fitEnrollment_+3A_nknots">nknots</code></td>
<td>
<p>The number of inner knots for the B-spline enrollment
model. By default, it is set to 0.</p>
</td></tr>
<tr><td><code id="fitEnrollment_+3A_accrualtime">accrualTime</code></td>
<td>
<p>The accrual time intervals for the piecewise Poisson
model. Must start with 0, e.g., c(0, 30) breaks the time axis into
2 accrual intervals: [0, 30) and [30, Inf). By default, it is set to 0.</p>
</td></tr>
<tr><td><code id="fitEnrollment_+3A_criterion">criterion</code></td>
<td>
<p>A character variable to denote the criterion in model
selection to shown in the figure, which can be set to one of the following
options: &quot;aic&quot;,&quot;bic&quot; or &quot;both&quot;. By default,it is set to <code>both</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the time-decay model, the mean function is
<code>mu(t) = mu/delta*(t - 1/delta*(1 - exp(-delta*t)))</code>
and the rate function is
<code>lambda(t) = mu/delta*(1 - exp(-delta*t))</code>.
For the B-spline model, the daily enrollment rate is approximated as
<code>lambda(t) = exp(B(t)*theta)</code>,
where <code>B(t)</code> represents the B-spline basis functions.
</p>


<h3>Value</h3>

<p>A list of results from the model fit including key information
such as the enrollment model, <code>model</code>, the estimated model
parameters, <code>theta</code>, the covariance matrix, <code>vtheta</code>, and
the Bayesian Information Criterion, <code>bic</code>, and Akaike Information Criterion, <code>aic</code>, as well as
the design matrix <code>x</code> for the B-spline enrollment model, and
<code>accrualTime</code> for the piecewise Poisson enrollment model.
</p>
<p>The fitted enrollment curve is also returned.
</p>


<h3>References</h3>


<ul>
<li><p> Zhang, Xiaoxi, and Qi Long. &quot;Stochastic modeling and prediction for accrual in clinical trials.&quot;
Statistics in Medicine 29.6 (2010): 649-658.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
enroll_fit &lt;- fitEnrollment(df = interimData1, enroll_model = "b-spline",
                            nknots = 1)

</code></pre>

<hr>
<h2 id='fitEvent'>Fit time-to-event model</h2><span id='topic+fitEvent'></span>

<h3>Description</h3>

<p>Fits a specified time-to-event model to the event data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitEvent(
  df,
  event_model = "model averaging",
  piecewiseSurvivalTime = 0,
  k = 0,
  scale = "hazard",
  by_treatment = FALSE,
  criterion = "both"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitEvent_+3A_df">df</code></td>
<td>
<p>The subject-level event data, including <code>time</code>
and <code>event</code>. The data should also include <code>treatment</code>
coded as 1, 2, and so on, and <code>treatment_description</code>
for fitting the event model by treatment.</p>
</td></tr>
<tr><td><code id="fitEvent_+3A_event_model">event_model</code></td>
<td>
<p>The event model used to analyze the event data
which can be set to one of the following options:
&quot;exponential&quot;, &quot;Weibull&quot;, &quot;log-logistic&quot;, &quot;log-normal&quot;,
&quot;piecewise exponential&quot;, &quot;model averaging&quot;, &quot;spline&quot;,&quot;exponential with cured population&quot;,&quot;weibull with cured population&quot;,
&quot;log-normal with cured population&quot;,&quot;log-logistic with cured population&quot; or &quot;piecewise exponential with cured population&quot;.
The model averaging uses the <code>exp(-bic/2)</code> weighting and
combines Weibull and log-normal models. The spline model of
Royston and Parmar (2002) assumes that a transformation of
the survival function is modeled as a natural cubic spline
function of log time. By default, it is set to &quot;model averaging&quot;.</p>
</td></tr>
<tr><td><code id="fitEvent_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the time
intervals for the piecewise exponential survival distribution or piecewise exponential with cured population.
Must start with 0, e.g., c(0, 60) breaks the time axis into 2
event intervals: [0, 60) and [60, Inf). By default, it is set to 0.</p>
</td></tr>
<tr><td><code id="fitEvent_+3A_k">k</code></td>
<td>
<p>The number of inner knots of the spline. The default
<code>k=0</code> gives a Weibull, log-logistic or log-normal model,
if <code>scale</code> is &quot;hazard&quot;, &quot;odds&quot;, or &quot;normal&quot;, respectively.
The knots are chosen as equally-spaced quantiles of the log
uncensored survival times. The boundary knots are chosen as the
minimum and maximum log uncensored survival times.</p>
</td></tr>
<tr><td><code id="fitEvent_+3A_scale">scale</code></td>
<td>
<p>If &quot;hazard&quot;, the log cumulative hazard is modeled
as a spline function. If &quot;odds&quot;, the log cumulative odds is
modeled as a spline function. If &quot;normal&quot;, -qnorm(S(t)) is
modeled as a spline function.</p>
</td></tr>
<tr><td><code id="fitEvent_+3A_by_treatment">by_treatment</code></td>
<td>
<p>A Boolean variable to control whether or not to
fit the time-to-event data by treatment group. By default,
it is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitEvent_+3A_criterion">criterion</code></td>
<td>
<p>A character variable to denote the criterion in model
selection to shown in the figure, which can be set to one of the following
options: &quot;aic&quot;,&quot;bic&quot; or &quot;both&quot;. By default,it is set to <code>both</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results from the model fit including key information
such as the event model, <code>model</code>, the estimated model parameters,
<code>theta</code>, the covariance matrix, <code>vtheta</code>, as well as the
Bayesian Information Criterion, <code>bic</code>, and Akaike Information Criterion, <code>aic</code>.
</p>
<p>If the piecewise exponential model is used, the location
of knots used in the model, <code>piecewiseSurvivalTime</code>, will
be included in the list of results.
</p>
<p>If the model averaging option is chosen, the weight assigned
to the Weibull component is indicated by the <code>w1</code> variable.
</p>
<p>If the spline option is chosen, the <code>knots</code> and <code>scale</code>
will be included in the list of results.
</p>
<p>When fitting the event model by treatment, the outcome is presented
as a list of lists, where each list element corresponds to a
specific treatment group.
</p>
<p>The fitted time-to-event survival curve is also returned.
</p>


<h3>References</h3>


<ul>
<li><p> Royston, Patrick, and Mahesh KB Parmar.
&quot;Flexible parametric proportional‐hazards and proportional‐odds models for censored survival data,
with application to prognostic modelling and estimation of treatment effects.&quot;
Statistics in medicine 21.15 (2002): 2175-2197.
</p>
</li>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
event_fit &lt;- fitEvent(df = interimData2,
                      event_model = "piecewise exponential",
                      piecewiseSurvivalTime = c(0, 180))

</code></pre>

<hr>
<h2 id='getPrediction'>Enrollment and event prediction</h2><span id='topic+getPrediction'></span>

<h3>Description</h3>

<p>Performs enrollment and event prediction by utilizing
observed data and specified enrollment and event models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPrediction(
  df = NULL,
  to_predict = "enrollment and event",
  target_n = NA,
  target_d = NA,
  enroll_model = "b-spline",
  nknots = 0,
  lags = 30,
  accrualTime = 0,
  enroll_prior = NULL,
  event_model = "exponential",
  piecewiseSurvivalTime = 0,
  k = 0,
  scale = "hazard",
  event_prior = NULL,
  dropout_model = "exponential",
  piecewiseDropoutTime = 0,
  dropout_prior = NULL,
  fixedFollowup = FALSE,
  followupTime = 365,
  pilevel = 0.9,
  nyears = 4,
  nreps = 500,
  showEnrollment = TRUE,
  showEvent = TRUE,
  showDropout = FALSE,
  showOngoing = FALSE,
  by_treatment = FALSE,
  ngroups = 1,
  alloc = NULL,
  treatment_label = NULL,
  criterion = "both",
  seed.num = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPrediction_+3A_df">df</code></td>
<td>
<p>The subject-level enrollment and event data, including
<code>trialsdt</code>, <code>usubjid</code>, <code>randdt</code>, and <code>cutoffdt</code> for
enrollment prediction, and, additionally, <code>time</code>, <code>event</code>,
and <code>dropout</code> for event prediction. The data should also include
<code>treatment</code> coded as 1, 2, and so on, and
<code>treatment_description</code> for enrollment and
event prediction by treatment. By default, it is set to
<code>NULL</code> for enrollment and event prediction at the design stage.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_to_predict">to_predict</code></td>
<td>
<p>Specifies what to predict: &quot;enrollment only&quot;, &quot;event
only&quot;, or &quot;enrollment and event&quot;. By default, it is set to
&quot;enrollment and event&quot;.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_target_n">target_n</code></td>
<td>
<p>The target number of subjects to enroll in the study.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_target_d">target_d</code></td>
<td>
<p>The target number of events to reach in the study.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_enroll_model">enroll_model</code></td>
<td>
<p>The enrollment model which can be specified as
&quot;Poisson&quot;, &quot;Time-decay&quot;, &quot;B-spline&quot;, &quot;Piecewise Poisson&quot; or
&quot;Piecewise Uniform&quot;. By default, it is set to &quot;B-spline&quot;.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_nknots">nknots</code></td>
<td>
<p>The number of inner knots for the B-spline enrollment
model. By default, it is set to 0.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_lags">lags</code></td>
<td>
<p>The day lags to compute the average enrollment rate to
carry forward for the B-spline enrollment model. By default,
it is set to 30.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_accrualtime">accrualTime</code></td>
<td>
<p>The accrual time intervals for the piecewise
Poisson model. Must start with 0, e.g., c(0, 30) breaks the
time axis into 2 accrual intervals: [0, 30) and [30, Inf).
By default, it is set to 0.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_enroll_prior">enroll_prior</code></td>
<td>
<p>The prior of enrollment model parameters.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_event_model">event_model</code></td>
<td>
<p>The event model used to analyze the event data
which can be set to one of the following options:
&quot;exponential&quot;, &quot;Weibull&quot;, &quot;log-logistic&quot;, &quot;log-normal&quot;,
&quot;piecewise exponential&quot;, &quot;model averaging&quot;,&quot;exponential with cured population&quot;,&quot;weibull with cured population&quot;,
&quot;log-normal with cured population&quot;,&quot;log-logistic with cured population&quot;, or
&quot;piecewise exponential with cured population&quot;.
For the design stage analysis, there are additional options:&quot;exponential with cured population and delayed treatment&quot;,
&quot;weibull with cured population and delayed treatment&quot;,
&quot;log-normal with cured population and delayed treatment&quot;,&quot;log-logistic with cured population and delayed treatment&quot;
The model averaging uses the <code>exp(-bic/2)</code> weighting and combines Weibull and
log-normal models. By default, it is set to &quot;exponential&quot;.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the time
intervals for the piecewise exponential survival distribution, or piecewise exponential with cured population.
Must start with 0, e.g., c(0, 60) breaks the time axis into 2
event intervals: [0, 60) and [60, Inf). By default, it is set to 0.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_k">k</code></td>
<td>
<p>The number of inner knots of the spline event model of
Royston and Parmar (2002). The default
<code>k=0</code> gives a Weibull, log-logistic or log-normal model,
if <code>scale</code> is &quot;hazard&quot;, &quot;odds&quot;, or &quot;normal&quot;, respectively.
The knots are chosen as equally-spaced quantiles of the log
uncensored survival times. The boundary knots are chosen as the
minimum and maximum log uncensored survival times.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_scale">scale</code></td>
<td>
<p>If &quot;hazard&quot;, the log cumulative hazard is modeled
as a spline function. If &quot;odds&quot;, the log cumulative odds is
modeled as a spline function. If &quot;normal&quot;, -qnorm(S(t)) is
modeled as a spline function.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_event_prior">event_prior</code></td>
<td>
<p>The prior of event model parameters.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_dropout_model">dropout_model</code></td>
<td>
<p>The dropout model used to analyze the dropout data
which can be set to one of the following options: &quot;exponential&quot;,
&quot;Weibull&quot;, &quot;log-logistic&quot;, &quot;log-normal&quot;, or &quot;piecewise exponential&quot;.
By default, it is set to &quot;exponential&quot;.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_piecewisedropouttime">piecewiseDropoutTime</code></td>
<td>
<p>A vector that specifies the time
intervals for the piecewise exponential dropout distribution.
Must start with 0, e.g., c(0, 60) breaks the time axis into 2
event intervals: [0, 60) and [60, Inf). By default, it is set to 0.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_dropout_prior">dropout_prior</code></td>
<td>
<p>The prior of dropout model parameters.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>A Boolean variable indicating whether a fixed
follow-up design is used. By default, it is set to <code>FALSE</code>
for a variable follow-up design.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_followuptime">followupTime</code></td>
<td>
<p>The follow-up time for a fixed
follow-up design, in days. By default, it is set to 365.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_pilevel">pilevel</code></td>
<td>
<p>The prediction interval level. By default,
it is set to 0.90.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_nyears">nyears</code></td>
<td>
<p>The number of years after the data cut for prediction.
By default, it is set to 4.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_nreps">nreps</code></td>
<td>
<p>The number of replications for simulation. By default,
it is set to 500.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_showenrollment">showEnrollment</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of enrolled subjects. By default, it is set to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_showevent">showEvent</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of events. By default, it is set to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_showdropout">showDropout</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of dropouts. By default, it is set to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_showongoing">showOngoing</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of ongoing subjects. By default, it is set to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_by_treatment">by_treatment</code></td>
<td>
<p>A Boolean variable to control whether or not to
predict by treatment group. By default, it is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups for enrollment prediction
at the design stage. By default, it is set to 1.
It is replaced with the actual number of
treatment groups in the observed data if <code>df</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_alloc">alloc</code></td>
<td>
<p>The treatment allocation in a randomization block.
By default, it is set to <code>NULL</code>, which yields equal allocation
among the treatment groups.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_treatment_label">treatment_label</code></td>
<td>
<p>The treatment labels for treatments in a
randomization block for design stage prediction.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_criterion">criterion</code></td>
<td>
<p>A character variable to denote the criterion in model
selection to shown in the figure, which can be set to one of the following
options: &quot;aic&quot;,&quot;bic&quot; or &quot;both&quot;. By default,it is set to <code>both</code>.</p>
</td></tr>
<tr><td><code id="getPrediction_+3A_seed.num">seed.num</code></td>
<td>
<p>The number of the random seed. The default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the time-decay model, the mean function is
<code>mu(t) = mu/delta*(t - 1/delta*(1 - exp(-delta*t)))</code>
and the rate function is
<code>lambda(t) = mu/delta*(1 - exp(-delta*t))</code>.
For the B-spline model, the daily enrollment rate is approximated as
<code>lambda(t) = exp(B(t)*theta)</code>,
where <code>B(t)</code> represents the B-spline basis functions.
</p>
<p>The <code>enroll_prior</code> variable should be a list that
includes <code>model</code> to specify the enrollment model
(poisson, time-decay, piecewise poisson, or piecewise uniform),
<code>theta</code> and <code>vtheta</code> to indicate the parameter
values and the covariance matrix. One can use a very small
value of <code>vtheta</code> to fix the parameter values.
For the piecewise Poisson enrollment or piecewise uniform rate model, the list
should also include <code>accrualTime</code>. It should be noted
that the B-spline model is not appropriate for use as prior.
</p>
<p>For event prediction by treatment with prior information,
the <code>event_prior</code> variable should be
a list with one element per treatment. For each treatment, the
element should include <code>model</code> to specify the event (dropout)
model (exponential, weibull, log-logistic, log-normal,
or piecewise exponential, weibull with cured population,exponential with cured population,log-normal with cured population,
log-logistic with cured population,piecewise exponential with cured population,
exponential with cured population and delayed treatment,weibull with cured population and delayed treatment,
log-normal with cured population and delayed treatment,log-logistic with cured population and delayed treatment),
<code>theta</code> and <code>vtheta</code> to indicate
the parameter values and the covariance matrix.
For the piecewise exponential or piecewise exponential with cured population or piecewise exponential with cured population
and delayed treatment event model, the list
should also include <code>piecewiseSurvivalTime</code> to indicate
the location of knots. It should be noted that the model averaging
and spline options are not appropriate for use as prior.
</p>
<p>The <code>dropout_prior</code> should be a list with one element
per treatment. For each treatment, the element should include <code>w</code>
to specify the weight of the treatment in a randomization block,
<code>model</code> to specify the dropout model
(exponential, weibull, log-logistic, log-normal,
or piecewise exponential), <code>theta</code> and <code>vtheta</code> to indicate
the parameter values and the covariance matrix.
For the piecewise exponential dropout model, the list
should also include <code>piecewiseDropoutTime</code> to indicate
the location of knots.
</p>
<p>If the event prediction is not by treatment while the prior
information is given by treatment, then each element of
<code>event_prior</code> (<code>dropout_prior</code>) should also include
<code>w</code> to specify the weight of the treatment in a
randomization block. This method can only be used in the event prior with exponential, weibull, log-logistic, log-normal,
or piecewise exponential.
</p>
<p>If the prediction is not by treatment and
the prior is given for the overall study, then <code>event_prior</code>
(<code>dropout_prior</code>) is a flat list with <code>model</code>,
<code>theta</code>, and <code>vtheta</code>. For the piecewise exponential
event (dropout) model, it should also include
<code>piecewiseSurvivalTime</code> (<code>piecewiseDropoutTime</code>) to
indicate the location of knots.
</p>
<p>For analysis-stage enrollment and event prediction, the
<code>enroll_prior</code>, <code>event_prior</code>, and
<code>dropout_prior</code> are either set to <code>NULL</code> to
use the observed data only, or specify the prior distribution
of model parameters to be combined with observed data likelihood
for enhanced modeling flexibility.
</p>


<h3>Value</h3>

<p>A list that includes the fits of observed data models,
as well as simulated enrollment data for new subjects and
simulated event data for ongoing and new subjects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit1 &lt;- list(model = "piecewise uniform",
             theta = -0.58, 
             vtheta=0, accrualTime =0)
             
fit2&lt;-list()
fit2[[1]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(-2.2,0,6.5,0,1), 
                  vtheta = matrix(0,5,5))
fit2[[2]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                 theta = c(-2.2,0,6.5,46,0.65), 
                 vtheta = matrix(0,5,5))

fit3 &lt;- list()

fit3[[1]] &lt;- list(model = "exponential", 
                   theta =log(0.0003), 
                   vtheta=0)
fit3[[2]] &lt;- list(model = "exponential", 
                   theta =log(0.0003), 
                   vtheta=0)
                   
getPrediction(target_n=200,target_d=60,lags=46,enroll_prior=fit1,
              event_prior=fit2,
              dropout_prior=fit3,ngroups=2)                 



</code></pre>

<hr>
<h2 id='interimData1'>Interim enrollment and event data before enrollment completion</h2><span id='topic+interimData1'></span>

<h3>Description</h3>

<p>A data frame with 225 rows and 9 columns:
</p>

<dl>
<dt><code>trialsdt</code></dt><dd><p>The trial start date</p>
</dd>
<dt><code>usubjid</code></dt><dd><p>The unique subject ID</p>
</dd>
<dt><code>randdt</code></dt><dd><p>The randomization date</p>
</dd>
<dt><code>treatment</code></dt><dd><p>The treatment group number</p>
</dd>
<dt><code>treatment_description</code></dt><dd><p>Description of the treatment group</p>
</dd>
<dt><code>time</code></dt><dd><p>The day of event or censoring since randomization</p>
</dd>
<dt><code>event</code></dt><dd><p>The event indicator: 1 for event, 0 for non-event</p>
</dd>
<dt><code>dropout</code></dt><dd><p>The dropout indicator: 1 for dropout,
0 for non-dropout</p>
</dd>
<dt><code>cutoffdt</code></dt><dd><p>The cutoff date</p>
</dd>
</dl>

<p>For ongoing subjects, both <code>event</code> and <code>dropout</code> are equal to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interimData1
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 224 rows and 9 columns.
</p>

<hr>
<h2 id='interimData2'>Interim enrollment and event data after enrollment completion</h2><span id='topic+interimData2'></span>

<h3>Description</h3>

<p>A data frame with 300 rows and 7 columns:
</p>

<dl>
<dt><code>trialsdt</code></dt><dd><p>The trial start date</p>
</dd>
<dt><code>usubjid</code></dt><dd><p>The unique subject ID</p>
</dd>
<dt><code>randdt</code></dt><dd><p>The randomization date</p>
</dd>
<dt><code>treatment</code></dt><dd><p>The treatment group number</p>
</dd>
<dt><code>treatment_description</code></dt><dd><p>Description of the treatment group</p>
</dd>
<dt><code>time</code></dt><dd><p>The day of event or censoring since randomization</p>
</dd>
<dt><code>event</code></dt><dd><p>The event indicator: 1 for event, 0 for non-event</p>
</dd>
<dt><code>dropout</code></dt><dd><p>The dropout indicator: 1 for dropout,
0 for non-dropout</p>
</dd>
<dt><code>cutoffdt</code></dt><dd><p>The cutoff date</p>
</dd>
</dl>

<p>For ongoing subjects, both <code>event</code> and <code>dropout</code> are equal to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interimData2
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 300 rows and 9 columns.
</p>

<hr>
<h2 id='loglik_Chen_exponential'>Log-likelihood function for exponential distribution with cured population</h2><span id='topic+loglik_Chen_exponential'></span>

<h3>Description</h3>

<p>Provide log-likelihood function for exponential distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik_Chen_exponential(par, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_Chen_exponential_+3A_par">par</code></td>
<td>
<p>a vector with two elements, where the first element denotes the logistic of the proportion
of the cured population, and the second element denotes the log of the hazard rate.</p>
</td></tr>
<tr><td><code id="loglik_Chen_exponential_+3A_df">df</code></td>
<td>
<p>The subject-level event data, including <code>time</code>
and <code>event</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The negative value of the log-likelihood function given parameter
<code>par</code> and the dataset <code>df</code>
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='loglik_Chen_log_logistic'>Log-likelihood function for log-logistic distribution with cured population</h2><span id='topic+loglik_Chen_log_logistic'></span>

<h3>Description</h3>

<p>Provide log-likelihood function for log-logistic distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik_Chen_log_logistic(par, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_Chen_log_logistic_+3A_par">par</code></td>
<td>
<p>a vector with three elements, where the first element denotes the logistic of the proportion
of the cured population, and the second element and the third element denote
the log of shape and the log of the scale parameter of the log-logistic distribution.</p>
</td></tr>
<tr><td><code id="loglik_Chen_log_logistic_+3A_df">df</code></td>
<td>
<p>The subject-level event data, including <code>time</code>
and <code>event</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The negative value of the log-likelihood function given parameter
<code>par</code> and the dataset <code>df</code>
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='loglik_Chen_log_normal'>Log-likelihood function for log-normal distribution with cured population</h2><span id='topic+loglik_Chen_log_normal'></span>

<h3>Description</h3>

<p>Provide log-likelihood function for log-normal distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik_Chen_log_normal(par, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_Chen_log_normal_+3A_par">par</code></td>
<td>
<p>a vector with three elements, where the first element denotes the logistic of the proportion
of the cured population, and the second element and the third element denote
the mean and the log of standard deviation parameter of the log-normal distribution.</p>
</td></tr>
<tr><td><code id="loglik_Chen_log_normal_+3A_df">df</code></td>
<td>
<p>The subject-level event data, including <code>time</code>
and <code>event</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The negative value of the log-likelihood function given parameter
<code>par</code> and the dataset <code>df</code>
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='loglik_Chen_piecewise_exponential'>Log-likelihood function for piecewise-exponential distribution with cured population</h2><span id='topic+loglik_Chen_piecewise_exponential'></span>

<h3>Description</h3>

<p>Provide log-likelihood function for piecewise-exponential distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik_Chen_piecewise_exponential(par = NULL, df, piecewiseSurvivalTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_Chen_piecewise_exponential_+3A_par">par</code></td>
<td>
<p>a vector with m+1 elements, where the first element denotes the logistic of the proportion
of the cured population, and the rest element denotes the log of the hazard rate in intervals</p>
</td></tr>
<tr><td><code id="loglik_Chen_piecewise_exponential_+3A_df">df</code></td>
<td>
<p>The subject-level event data, including <code>time</code>
and <code>event</code>.</p>
</td></tr>
<tr><td><code id="loglik_Chen_piecewise_exponential_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector with length m that specifies the time
intervals for the piecewise exponential survival distribution.
Must start with 0, e.g., c(0, 60) breaks the time axis into 2
event intervals: [0, 60) and [60, Inf). By default, it is set to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The negative value of the log-likelihood function given parameter
<code>par</code> and the dataset <code>df</code>
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='loglik_Chen_weibull'>Log-likelihood function for Weibull distribution with cured population</h2><span id='topic+loglik_Chen_weibull'></span>

<h3>Description</h3>

<p>Provide log-likelihood function for Weibull distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik_Chen_weibull(par, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_Chen_weibull_+3A_par">par</code></td>
<td>
<p>a vector with three elements, where the first element denotes the logistic of the proportion
of the cured population, and the second element and the third element denote
the log of the shape and log of the scale parameter of the Weibull distribution.</p>
</td></tr>
<tr><td><code id="loglik_Chen_weibull_+3A_df">df</code></td>
<td>
<p>The subject-level event data, including <code>time</code>
and <code>event</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The negative value of the log-likelihood function given parameter
<code>par</code> and the dataset <code>df</code>
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='predictEnrollment'>Predict enrollment</h2><span id='topic+predictEnrollment'></span>

<h3>Description</h3>

<p>Utilizes a pre-fitted enrollment model to generate
enrollment times for new subjects and provide a prediction
interval for the expected time to reach the enrollment target.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictEnrollment(
  df = NULL,
  target_n,
  enroll_fit,
  lags = 1,
  pilevel = 0.9,
  nyears = 4,
  nreps = 500,
  by_treatment = FALSE,
  ngroups = 1,
  alloc = NULL,
  treatment_label = NULL,
  seed.num = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictEnrollment_+3A_df">df</code></td>
<td>
<p>The subject-level enrollment data, including <code>trialsdt</code>,
<code>randdt</code> and <code>cutoffdt</code>. The data should also include
<code>treatment</code> coded as 1, 2, and so on, and
<code>treatment_description</code> for prediction
by treatment group. By default, it is set to <code>NULL</code>
for enrollment prediction at the design stage.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_target_n">target_n</code></td>
<td>
<p>The target number of subjects to enroll in the study.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_enroll_fit">enroll_fit</code></td>
<td>
<p>The pre-fitted enrollment model used to
generate predictions.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_lags">lags</code></td>
<td>
<p>The day lags to compute the average enrollment rate to
carry forward for the B-spline enrollment model. By default,
it is set to 1.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_pilevel">pilevel</code></td>
<td>
<p>The prediction interval level. By default,
it is set to 0.90.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_nyears">nyears</code></td>
<td>
<p>The number of years after the data cut for prediction.
By default, it is set to 4.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_nreps">nreps</code></td>
<td>
<p>The number of replications for simulation. By default,
it is set to 500.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_by_treatment">by_treatment</code></td>
<td>
<p>A Boolean variable to control whether or not to
predict enrollment by treatment group. By default,
it is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups for enrollment prediction
at the design stage. By default, it is set to 1.
It is replaced with the actual number of
treatment groups in the observed data if <code>df</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_alloc">alloc</code></td>
<td>
<p>The treatment allocation in a randomization block.
By default, it is set to <code>NULL</code>, which yields equal allocation
among the treatment groups.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_treatment_label">treatment_label</code></td>
<td>
<p>The treatment labels for treatments in a
randomization block for design stage prediction.</p>
</td></tr>
<tr><td><code id="predictEnrollment_+3A_seed.num">seed.num</code></td>
<td>
<p>The number of the random seed. The default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>enroll_fit</code> variable can be used for enrollment prediction
at the design stage. A piecewise uniform can be parameterized
through the time intervals, <code>accrualTime</code>, which is
treated as fixed, and the enrollment rates in the intervals,
<code>accrualrate</code>, the number of patients in each intervals.
A piecewise Poisson model can be parameterized
through the time intervals, <code>accrualTime</code>, which is
treated as fixed, and the enrollment rates in the intervals,
<code>accrualIntensity</code>, the log of which is used as the
model parameter. For the homogeneous Poisson, time-decay,
and piecewise Poisson models, <code>enroll_fit</code> is used to
specify the prior distribution of model parameters, with
a very small variance being used to fix the parameter values.
It should be noted that the B-spline model is not appropriate
for use during the design stage.
</p>
<p>During the enrollment stage, <code>enroll_fit</code> is the enrollment model
fit based on the observed data. The fitted enrollment model is used to
generate enrollment times for new subjects.
</p>


<h3>Value</h3>

<p>A list of prediction results, which includes important information
such as the median, lower and upper percentiles for the estimated
time to reach the target number of subjects, as well as simulated
enrollment data for new subjects. The data for the
prediction plot is also included within the list.
</p>


<h3>References</h3>

<p>Xiaoxi Zhang and Qi Long. Stochastic modeling and prediction for
accrual in clinical trials. Stat in Med. 2010; 29:649-658.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Enrollment prediction at the design stage
fit1 &lt;- list(model = "piecewise uniform",
             theta = -0.58, 
             vtheta=0, accrualTime =0)
                  
 predictEnrollment(df = NULL, target_n=200, enroll_fit = fit1,lags=46,
                                  pilevel=0.9, nyears=4, nreps=100,by_treatment=TRUE,
                                  ngroups=2, alloc=c(1,1), treatment_label=c('a','b'))

</code></pre>

<hr>
<h2 id='predictEvent'>Predict event time for ongoing subjects with or without cured population.</h2><span id='topic+predictEvent'></span>

<h3>Description</h3>

<p>Utilizes pre-fitted time-to-event and time-to-dropout models
to generate event and dropout times for ongoing subjects
and new subjects. It also provides a
prediction interval for the expected time to reach the target
number of events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictEvent(
  df = NULL,
  target_d,
  newSubjects = NULL,
  event_fit,
  dropout_fit = NULL,
  fixedFollowup = FALSE,
  followupTime = 365,
  pilevel = 0.9,
  nyears = 4,
  nreps = 500,
  showEnrollment = TRUE,
  showEvent = TRUE,
  showDropout = FALSE,
  showOngoing = FALSE,
  by_treatment = FALSE,
  seed.num = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictEvent_+3A_df">df</code></td>
<td>
<p>The subject-level enrollment and event data,
including <code>randdt</code>, <code>cutoffdt</code>,
<code>time</code>, <code>event</code>, and <code>dropout</code>. By default, it
is set to <code>NULL</code> for event prediction at the design stage.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_target_d">target_d</code></td>
<td>
<p>The target number of events to reach in the study.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_newsubjects">newSubjects</code></td>
<td>
<p>The enrollment data for new subjects including
<code>draw</code> and <code>arrivalTime</code>. By default,
it is set to <code>NULL</code>, indicating the completion of
subject enrollment.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_event_fit">event_fit</code></td>
<td>
<p>The pre-fitted event model used to generate
predictions.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_dropout_fit">dropout_fit</code></td>
<td>
<p>The pre-fitted dropout model used to generate
predictions. By default, it is set to <code>NULL</code>,
indicating no dropout.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_fixedfollowup">fixedFollowup</code></td>
<td>
<p>A Boolean variable indicating whether a fixed
follow-up design is used. By default, it is set to <code>FALSE</code>
for a variable follow-up design.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_followuptime">followupTime</code></td>
<td>
<p>The follow-up time for a fixed
follow-up design, in days. By default, it is set to 365.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_pilevel">pilevel</code></td>
<td>
<p>The prediction interval level. By default,
it is set to 0.90.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_nyears">nyears</code></td>
<td>
<p>The number of years after the data cut for prediction.
By default, it is set to 4.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_nreps">nreps</code></td>
<td>
<p>The number of replications for simulation. By default,
it is set to 500. If <code>newSubjects</code> is not <code>NULL</code>,
the number of draws in <code>newSubjects</code> should be <code>nreps</code>.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_showenrollment">showEnrollment</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of enrolled subjects. By default, it is set to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_showevent">showEvent</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of events. By default, it is set to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_showdropout">showDropout</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of dropouts. By default, it is set to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_showongoing">showOngoing</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the number of ongoing subjects. By default, it is set to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_by_treatment">by_treatment</code></td>
<td>
<p>A Boolean variable to control whether or not to
predict event by treatment group. By default,
it is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="predictEvent_+3A_seed.num">seed.num</code></td>
<td>
<p>The number of the random seed. The default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To ensure successful event prediction at the design stage, it is
important to provide the <code>newSubjects</code> data set.
</p>
<p>To specify the event model used during the design-stage event
prediction, the <code>event_fit</code> be a list with one element
per treatment. For each treatment, the element should include <code>w</code>
to specify the weight of the treatment in a randomization block,
<code>model</code> to specify the event model
(exponential, weibull, log-logistic, log-normal,
or piecewise exponential, weibull with cured population,exponential with cured population,log-normal with cured population,
log-logistic with cured population,piecewise exponential with cured population,
exponential with cured population and delayed treatment,weibull with cured population and delayed treatment,
log-normal with cured population and delayed treatment,log-logistic with cured population and delayed treatment),
<code>theta</code> and <code>vtheta</code> to indicate
the parameter values and the covariance matrix.
For the piecewise exponential or piecewise exponential with cured population or piecewise exponential with cured population
and delayed treatment event model, the list
should also include <code>piecewiseSurvivalTime</code> to indicate
the location of knots. It should be noted that the model averaging
and spline options are not appropriate for use as prior.
</p>
<p>To specify the dropout model used during the design stage
event prediction, the <code>dropout_fit</code> should be a list
with one element per treatment. For each treatment, the element
should include <code>w</code> to specify the weight of the treatment
in a randomization block, <code>model</code> to specify the dropout model
(exponential, weibull, log-logistic, log-normal,
or piecewise exponential), <code>theta</code> and <code>vtheta</code> to indicate
the parameter values and the covariance matrix.
For the piecewise exponential dropout model, the list
should also include <code>piecewiseDropoutTime</code> to indicate
the location of knots.
</p>
<p>Following the commencement of the trial, we obtain the event
model fit and the dropout model fit based on the observed data,
denoted as <code>event_fit</code> and <code>dropout_fit</code>, respectively.
These fitted models are subsequently utilized to generate event
and dropout times for both ongoing and new subjects in the trial.
</p>


<h3>Value</h3>

<p>A list of prediction results which includes important
information such as the median, lower and upper percentiles for
the estimated day and date to reach the target number of events,
as well as simulated event data for both ongoing and new subjects.
The data for the prediction plot is also included
within this list.
</p>


<h3>References</h3>


<ul>
<li><p> Bagiella, Emilia, and Daniel F. Heitjan. &quot;Predicting analysis times in randomized clinical trials.&quot;
Statistics in medicine 20.14 (2001): 2055-2063.
</p>
</li>
<li><p> Ying, Gui‐shuang, and Daniel F. Heitjan. &quot;Weibull prediction of event times in clinical trials.&quot;
Pharmaceutical Statistics:
The Journal of Applied Statistics in the Pharmaceutical Industry 7.2 (2008): 107-120.
</p>
</li>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
fit1 &lt;- list(model = "piecewise uniform",
             theta = -0.58, 
             vtheta=0, accrualTime =0)
fit2&lt;-list()
fit2[[1]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(-2.2,0,6.5,0,1), 
                  vtheta = matrix(0,5,5))
fit2[[2]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                 theta = c(-2.2,0,6.5,46,0.65), 
                 vtheta = matrix(0,5,5))
                  
 enroll_pred &lt;- predictEnrollment(df = NULL, target_n=200, enroll_fit = fit1,lags=46,
                                  pilevel=0.9, nyears=4, nreps=100,by_treatment=TRUE,
                                  ngroups=2, alloc=c(1,1), treatment_label=c('a','b'))

 event_pred &lt;- predictEvent(df = NULL, target_d=60,
                            newSubjects = enroll_pred$newSubjects,
                            event_fit = fit2,dropout_fit = NULL,
                            pilevel=0.9, 
                            nyears=4, 
                            nreps=100,
                            by_treatment=TRUE)


</code></pre>

<hr>
<h2 id='smed'>Function to output summary statistics from survfit function output</h2><span id='topic+smed'></span>

<h3>Description</h3>

<p>Provide  summary statistics from survfit function output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smed(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smed_+3A_x">x</code></td>
<td>
<p>an object returned by &quot;survfit&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>&quot;smed&quot; returns a matrix of 5 columns of
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 500
event &lt;- runif(n,1, 5)
osc&lt;-1*(event&lt;=4)
os &lt;- pmin(event,4)

fit1&lt;-survival::survfit(survival::Surv(os,osc)~1)
smed(fit1)

</code></pre>

<hr>
<h2 id='SP_Chen_exponential'>Survival probability function of the exponential distribution with cured population</h2><span id='topic+SP_Chen_exponential'></span>

<h3>Description</h3>

<p>Calculate survival probability of the exponential distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SP_Chen_exponential(par, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SP_Chen_exponential_+3A_par">par</code></td>
<td>
<p>a vector with two elements, where the first element denotes the logistic of the proportion
of the cured population, and the second element denotes the log of the hazard rate.</p>
</td></tr>
<tr><td><code id="SP_Chen_exponential_+3A_t">t</code></td>
<td>
<p>a vector with non-negative elements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Survival probability of the exponential distribution with cured population given parameters <code>par</code> at times <code>t</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='SP_Chen_log_logistic'>Survival probability function of the log-logistic distribution with cured population</h2><span id='topic+SP_Chen_log_logistic'></span>

<h3>Description</h3>

<p>Calculate survival probability of the log-logistic distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SP_Chen_log_logistic(par, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SP_Chen_log_logistic_+3A_par">par</code></td>
<td>
<p>a vector with three elements, wwhere the first element denotes the logistic of the proportion
of the cured population, and the second element and the third element denote
the log of shape and the log of the scale parameter of the log-logistic distribution.</p>
</td></tr>
<tr><td><code id="SP_Chen_log_logistic_+3A_t">t</code></td>
<td>
<p>a vector with non-negative elements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Survival probability of the log-logistic distribution with cured population given parameters <code>par</code> at times <code>t</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='SP_Chen_log_normal'>Survival probability function of the log-normal distribution with cured population</h2><span id='topic+SP_Chen_log_normal'></span>

<h3>Description</h3>

<p>Calculate survival probability of the log-normal distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SP_Chen_log_normal(par, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SP_Chen_log_normal_+3A_par">par</code></td>
<td>
<p>a vector with three elements, where the first element denotes the logistic of the proportion
of the cured population, and the second element and the third element denote
the mean and the log of standard deviation parameter of the log-normal distribution.</p>
</td></tr>
<tr><td><code id="SP_Chen_log_normal_+3A_t">t</code></td>
<td>
<p>a vector with non-negative elements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Survival probability of the log-normal distribution with cured population given parameters <code>par</code> at times <code>t</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='SP_Chen_piecewise_exponential'>Survival probability function of the piecewise exponential distribution with cured population</h2><span id='topic+SP_Chen_piecewise_exponential'></span>

<h3>Description</h3>

<p>Calculate survival probability of the piecewise exponential distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SP_Chen_piecewise_exponential(par, t, piecewiseSurvivalTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SP_Chen_piecewise_exponential_+3A_par">par</code></td>
<td>
<p>a vector with m+1 elements, where the first element denotes the logistic of the proportion
of the cured population, and the rest element denotes the log of the hazard rate in intervals</p>
</td></tr>
<tr><td><code id="SP_Chen_piecewise_exponential_+3A_t">t</code></td>
<td>
<p>a vector with non-negative elements.</p>
</td></tr>
<tr><td><code id="SP_Chen_piecewise_exponential_+3A_piecewisesurvivaltime">piecewiseSurvivalTime</code></td>
<td>
<p>A vector that specifies the time
intervals for the piecewise exponential survival distribution.
Must start with 0, e.g., c(0, 60) breaks the time axis into 2
event intervals: [0, 60) and [60, Inf). By default, it is set to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Survival probability of the piecewise-exponential distribution with cured population given parameters <code>par</code> at times <code>t</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='SP_Chen_weibull'>Survival probability function of the Weibull distribution with cured population</h2><span id='topic+SP_Chen_weibull'></span>

<h3>Description</h3>

<p>Calculate survival probability of the Weibull distribution with cured population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SP_Chen_weibull(par, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SP_Chen_weibull_+3A_par">par</code></td>
<td>
<p>a vector with three elements, where the first element denotes the logistic of the proportion
of the cured population, and the second element and the third element denote
the log of the shape and log of the scale parameter of the Weibull distribution.</p>
</td></tr>
<tr><td><code id="SP_Chen_weibull_+3A_t">t</code></td>
<td>
<p>a vector with non-negative elements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Survival probability of the Weibull distribution with cured population given parameters <code>par</code> at times <code>t</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Chen, Tai-Tsang. &quot;Predicting analysis times in randomized clinical trials with cancer immunotherapy.&quot;
BMC medical research methodology 16.1 (2016): 1-10.
</p>
</li></ul>


<hr>
<h2 id='summarizeObserved'>Summarize observed data</h2><span id='topic+summarizeObserved'></span>

<h3>Description</h3>

<p>Provides an overview of the observed data, including
the trial start date, data cutoff date, enrollment duration,
number of subjects enrolled, number of events and dropouts,
number of subjects at risk, cumulative enrollment and event data,
daily enrollment rates, and Kaplan-Meier plots for time to event
and time to dropout.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarizeObserved(
  df,
  to_predict = "event only",
  showplot = TRUE,
  by_treatment = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarizeObserved_+3A_df">df</code></td>
<td>
<p>The subject-level data, including <code>trialsdt</code>,
<code>usubjid</code>, <code>randdt</code>, and <code>cutoffdt</code> for enrollment
prediction, as well as <code>time</code>, <code>event</code> and <code>dropout</code>
for event prediction, and <code>treatment</code> coded as 1, 2,
and so on, and <code>treatment_description</code> for prediction
by treatment group.</p>
</td></tr>
<tr><td><code id="summarizeObserved_+3A_to_predict">to_predict</code></td>
<td>
<p>Specifies what to predict: &quot;enrollment only&quot;,
&quot;event only&quot;, or &quot;enrollment and event&quot;. By default, it is set to
&quot;event only&quot;.</p>
</td></tr>
<tr><td><code id="summarizeObserved_+3A_showplot">showplot</code></td>
<td>
<p>A Boolean variable to control whether or not to
show the observed data plots. By default, it is set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="summarizeObserved_+3A_by_treatment">by_treatment</code></td>
<td>
<p>A Boolean variable to control whether or not to
summarize observed data by treatment group. By default,
it is set to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that includes a range of summary statistics,
data sets, and plots depending on the value of <code>to_predict</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
observed1 &lt;- summarizeObserved(df = interimData1,
                               to_predict = "enrollment and event")
</code></pre>

<hr>
<h2 id='test_plot'>Function to plot KM plot for time-to-event data in simulation</h2><span id='topic+test_plot'></span>

<h3>Description</h3>

<p>Plot KM plot for each arm at one realization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_plot(test0, plot.index = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_plot_+3A_test0">test0</code></td>
<td>
<p>an object obtained from test_procedure</p>
</td></tr>
<tr><td><code id="test_plot_+3A_plot.index">plot.index</code></td>
<td>
<p>the index of simulation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A KM plot for events in each arm
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit1 &lt;- list(model = "piecewise uniform",
             theta = -0.58, 
             vtheta=0, accrualTime =0)
fit2&lt;-list()
fit2[[1]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(0.5,0,6.5,0,1), 
                  vtheta = matrix(0,5,5))
fit2[[2]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                 theta = c(0.5,0,6.5,46,0.65), 
                 vtheta = matrix(0,5,5))
fit3&lt;-list()
fit3[[1]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(0.5,0,6.5,0,1), 
                  vtheta = matrix(0,5,5))
fit3[[2]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(0.5,0,6.5,0,1),
                  vtheta = matrix(0,5,5))
fit4 &lt;- list(model = "exponential", 
                   theta =log(0.0003), 
                   vtheta=0)
                   
test1&lt;-test_procedure(pilevel=0.9,nyears=4,enroll_fit=fit1,
                      dropout_fit=fit4,enroll_prior=fit1,event_prior_h0=fit3,
                      event_prior_ha=fit2,dropout_prior=NULL,
                      target_n=200,target_IA_d=40,
                      target_d=60,ialpha=0.016,falpha=0.0450,
                      lag=46,by_fitted_enroll=FALSE,
                      by_fitted_dropout=FALSE,treatment_label=c('a','b'),
                      ngroups=2,alloc=c(1,1),nreps=10, IA_included=TRUE)
test_plot(test1)

</code></pre>

<hr>
<h2 id='test_procedure'>Function to provide summary and test statistics based on simulation.</h2><span id='topic+test_procedure'></span>

<h3>Description</h3>

<p>Provides summary and test statistics based on simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_procedure(
  pilevel = 0.9,
  nyears = 4,
  enroll_fit = enroll_fit,
  dropout_fit = dropout_fit,
  enroll_prior = NULL,
  event_prior_h0 = NULL,
  event_prior_ha = NULL,
  dropout_prior = NULL,
  target_n,
  target_IA_d,
  target_d,
  ialpha = 0.025,
  falpha,
  lag,
  by_fitted_enroll = FALSE,
  by_fitted_dropout = FALSE,
  treatment_label,
  ngroups = 2,
  alloc = NULL,
  nreps = 500,
  IA_included,
  test = "Superiority",
  test_IA = "Superiority",
  Futility_boundary = 1,
  seed.num = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_procedure_+3A_pilevel">pilevel</code></td>
<td>
<p>the confidence interval, the default is 0.95.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_nyears">nyears</code></td>
<td>
<p>the year after data cutoff or follow-up.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_enroll_fit">enroll_fit</code></td>
<td>
<p>an object generated from <code>fitEnrollment</code>.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_dropout_fit">dropout_fit</code></td>
<td>
<p>an object generated from <code>fitDropout</code>.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_enroll_prior">enroll_prior</code></td>
<td>
<p>The prior of enrollment model parameters.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_event_prior_h0">event_prior_h0</code></td>
<td>
<p>The prior of event model parameters under null hypothesis</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_event_prior_ha">event_prior_ha</code></td>
<td>
<p>The prior of event model parameters under alternative hypothesis</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_dropout_prior">dropout_prior</code></td>
<td>
<p>The prior of dropout model parameters.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_target_n">target_n</code></td>
<td>
<p>The target number of subjects to enroll in the study.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_target_ia_d">target_IA_d</code></td>
<td>
<p>number of events needed for interim analysis</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_target_d">target_d</code></td>
<td>
<p>number of events needed for primary analysis</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_ialpha">ialpha</code></td>
<td>
<p>interim analysis alpha nominal value (only one interim allowed)</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_falpha">falpha</code></td>
<td>
<p>primary analysis alpha nominal value</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_lag">lag</code></td>
<td>
<p>a scalar to denote time (days). Hazard ratio before and after this time would be calculated.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_by_fitted_enroll">by_fitted_enroll</code></td>
<td>
<p>A Boolean variable to control whether or not to
predict enrollment time with fitted model. By default, it is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_by_fitted_dropout">by_fitted_dropout</code></td>
<td>
<p>A Boolean variable to control whether or not to
predict dropout time with fitted model. By default, it is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_treatment_label">treatment_label</code></td>
<td>
<p>The treatment labels for treatments in a
randomization block for design stage prediction.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_ngroups">ngroups</code></td>
<td>
<p>The number of treatment groups for enrollment prediction
at the design stage. By default, it is set to 2.
It is replaced with the actual number of
treatment groups in the observed data if <code>df</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_alloc">alloc</code></td>
<td>
<p>The treatment allocation in a randomization block.
By default, it is set to <code>NULL</code>, which yields equal allocation
among the treatment groups.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_nreps">nreps</code></td>
<td>
<p>The number of replications for simulation. By default,
it is set to 500.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_ia_included">IA_included</code></td>
<td>
<p>A Boolean variable to control whether or not to
include one interim analysis. By default, it is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_test">test</code></td>
<td>
<p>a character denotes the test type, includes &quot;Superiority&quot;,&quot;Futility&quot;,&quot;Two-sided&quot;</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_test_ia">test_IA</code></td>
<td>
<p>a character denotes the test type in interim analysis, includes &quot;Efficacy&quot;,&quot;Futility&quot;,or &quot;Efficacy and Futility&quot;</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_futility_boundary">Futility_boundary</code></td>
<td>
<p>a positive number denotes the boundary of the Futility in the scale of hazard ratio</p>
</td></tr>
<tr><td><code id="test_procedure_+3A_seed.num">seed.num</code></td>
<td>
<p>The number of the random seed. The default is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following components
</p>

<ul>
<li><p> iteration0 - the number of simulations that achieved target number of events in interim analysis and primary analysis under null hypothesis.
</p>
</li>
<li><p> iteration1 - the number of simulations that achieved target number of events in interim analysis and primary analysis under alternative hypothesis.
</p>
</li>
<li><p> simu_summary - the summary table of number of simulations that achieved or do not achieve target number of events in each analysis under null hypothesis and alternative hypothesis.
</p>
</li>
<li><p> power - the alpha and powers from log-rank test and Fleming&amp;Harrington test
</p>
</li>
<li><p> samplesize - the counts per arm and total, includes the number of patients,
events at interim analysis and primary analysis, events at interim analysis before delay,
events at primary analysis before delay
</p>
</li>
<li><p> hzratio - average hazard ratio at primary analysis and interim analysis
</p>
</li>
<li><p> hzrc - Frequencies of hazard ratios in specific zones
</p>
</li>
<li><p> hzratio2 - HR before and after delay
</p>
</li>
<li><p> median - Medians of survival time at interim analysis and primary analysis
</p>
</li>
<li><p> osrate - survival rate at milestones (1, 2 and 4 years)
</p>
</li>
<li><p> duration - Study duration for enrollment, interim analysis and primary analysis
</p>
</li>
<li><p> duration1 - Durations for interim analysis and primary analysis with 95% CI
</p>
</li>
<li><p> textH0 - the summary text of number of simulations that achieved or do not achieve target number of events in primary analysis under null hypothesis.
</p>
</li>
<li><p> textHA - the summary text of number of simulations that achieved or do not achieve target number of events in primary analysis under alternative hypothesis.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
fit1 &lt;- list(model = "piecewise uniform",
             theta = -0.58, 
             vtheta=0, accrualTime =0)
fit2&lt;-list()
fit2[[1]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(-2.2,0,6.5,0,1), 
                  vtheta = matrix(0,5,5))
fit2[[2]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                 theta = c(-2.2,0,6.5,46,0.65), 
                 vtheta = matrix(0,5,5))
fit3 &lt;-list()
fit3[[1]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(-2.2,0,6.5,0,1), 
                  vtheta = matrix(0,5,5))
fit3[[2]] &lt;- list(model = "weibull with cured population and delayed treatment", 
                  theta = c(-2.2,0,6.5,0,1),
                  vtheta = matrix(0,5,5))
fit4 &lt;-list()

fit4[[1]] &lt;- list(model = "exponential", 
                   theta =log(0.0003), 
                   vtheta=0)
fit4[[2]] &lt;- list(model = "exponential", 
                   theta =log(0.0003), 

                   vtheta=0)
test1&lt;-test_procedure(pilevel=0.9,nyears=4,enroll_fit=fit1,
                      dropout_fit=fit4,enroll_prior=fit1,event_prior_h0=fit3,
                      event_prior_ha=fit2,dropout_prior=NULL,
                      target_n=200,target_IA_d=40,target_d=60,
                      ialpha=0.016,falpha=0.0450,
                      lag=46,by_fitted_enroll=FALSE,
                      by_fitted_dropout=FALSE,treatment_label=c('a','b'),
                      ngroups=2,alloc=c(1,1),nreps=100, IA_included=TRUE)
                       
</code></pre>

<hr>
<h2 id='tte'>Calculating log-rank test p-value, median time from each arm, hazard ratio between two arms, number of subjects and events in time-to-event outcomes.</h2><span id='topic+tte'></span>

<h3>Description</h3>

<p>Calculate log-rank test p-value, median time from each arm, HR between arms, number of subjects and events
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tte(os, osc, grp, type, test = "Futility")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tte_+3A_os">os</code></td>
<td>
<p>Time to event variable</p>
</td></tr>
<tr><td><code id="tte_+3A_osc">osc</code></td>
<td>
<p>Time to event censoring variable</p>
</td></tr>
<tr><td><code id="tte_+3A_grp">grp</code></td>
<td>
<p>Treatment assignment indicator with 1 denoting the treated group, and 0 denoting the placebo group.</p>
</td></tr>
<tr><td><code id="tte_+3A_type">type</code></td>
<td>
<p>either &quot;all&quot; or &quot;logrank&quot; or &quot;hr&quot;</p>
</td></tr>
<tr><td><code id="tte_+3A_test">test</code></td>
<td>
<p>a character denotes the test type, include &quot;Superiority&quot;,&quot;Futility&quot;,&quot;Two-sided&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The control arm
</p>


<h3>Value</h3>

<p>If type='all', return a list that includes the log-rank p-value, median time from each arm, hazard ratio between arms,
and 95% confidence interval of hazard ratio, number of subjects and events; and events
If type='logrank', return a list that includes the log-rank p-value, number of subjects and events;
If type='hr', return a list that includes hazard ratio between arms, and 95% confidence interval of hazard ratio
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 500
event &lt;- runif(n,1, 5)
osc&lt;-1*(event&lt;=4)
os &lt;- pmin(event,4)
trt&lt;-c(rep(0,n/2),rep(1,n/2))
tte(os,osc,trt,type='all')

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
