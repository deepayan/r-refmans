<!DOCTYPE html><html><head><title>Help for package remiod</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {remiod}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#antidep'><p>wide format of continuous response of antidepressant data.</p></a></li>
<li><a href='#clm_MI_CR'><p>Apply Copy-Reference(CR) Method to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</p></a></li>
<li><a href='#clm_MI_delta'><p>Apply Delta adjustment to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</p></a></li>
<li><a href='#clm_MI_J2R'><p>Apply Jump-to-Reference(J2R) Method to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</p></a></li>
<li><a href='#commParams'><p>Common Parameters used by functions of <code>remiod</code></p></a></li>
<li><a href='#extract_MIdata'><p>Extract a specified number of multiple imputed datasets</p></a></li>
<li><a href='#get_class'><p>Obtain ordinal results based on log-odds (eta) and cut-offs (gamma) from MCMC</p>
Internal function to obtain ordinal results based on log-odds (eta) and cut-offs (gamma) from MCMC.</a></li>
<li><a href='#get_MI_RB'><p>Create multiple imputed datasets based on assigned imputation method.</p></a></li>
<li><a href='#get_Mlist'><p>Prepare imputation-model-related information</p></a></li>
<li><a href='#get_subset'><p>Extract specific parameters from MCMC samples</p></a></li>
<li><a href='#glm_MI_CR'><p>Apply Copy-Reference(CR) Method to Update JAGS MCMC outputs under MAR for Generalized Linear Model</p></a></li>
<li><a href='#glm_MI_delta'><p>Apply Delta adjustment to Update JAGS MCMC outputs under MAR for Generalized Linear Model</p></a></li>
<li><a href='#glm_MI_J2R'><p>Apply Jump-to-Reference(J2R) Method to Update JAGS MCMC outputs under MAR for Generalized Linear Model</p></a></li>
<li><a href='#list.models'><p>Listing the sequence of models used for imputation</p></a></li>
<li><a href='#mcmcplot'><p>Visualizing the posterior sample</p>
Creates a set of plots for visually evaluating convergence and mixing of the chains
from the MCMC sample of an object of class 'remiod'.</a></li>
<li><a href='#miAnalyze'><p>Takes multiply imputed datasets (as generated by the <code>extract_MIdata()</code> function)</p>
and runs an analysis function on each of them.</a></li>
<li><a href='#opm_MI_CR'><p>Apply Copy-Reference(CR) Method to Update JAGS MCMC outputs under MAR for probit Model</p></a></li>
<li><a href='#opm_MI_delta'><p>Apply Delta adjustment to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</p></a></li>
<li><a href='#opm_MI_J2R'><p>Apply Jump-to-Reference(J2R) Method to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</p></a></li>
<li><a href='#prep_MCMC'><p>Extract MCMC samples of monitored parameters from JointAI object. Code from JointAI.</p></a></li>
<li><a href='#remiod'><p>Reference-Based Multiple Imputation for Ordinal/Binary Response</p></a></li>
<li><a href='#schizo'><p>National Institute of Mental Health shizophrenia study</p></a></li>
<li><a href='#schizob'><p>wide format of binary response of Schizophrenia data.</p></a></li>
<li><a href='#schizow'><p>wide format of ordinal response of Schizophrenia data.</p></a></li>
<li><a href='#summary'><p>Summarize the results from an object of class remiod</p></a></li>
<li><a href='#tang_MI_RB'><p>Implement controlled multiple imputation algorithms proposed by Tang</p></a></li>
<li><a href='#updateMI'><p>Apply a MI method following initial run of <code>remoid</code> function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Reference-Based Multiple Imputation for Ordinal/Binary Response</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Reference-based multiple imputation of ordinal and binary responses under Bayesian
          framework, as described in Wang and Liu (2022) &lt;<a href="https://doi.org/10.48550/arXiv.2203.02771">doi:10.48550/arXiv.2203.02771</a>&gt;. Methods for 
          missing-not-at-random include Jump-to-Reference (J2R), Copy Reference (CR), and Delta 
          Adjustment which can generate tipping point analysis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/xsswang/remiod">https://github.com/xsswang/remiod</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>JointAI, rjags, coda, foreach, data.table, future, doFuture,
mathjaxr, survival, ggplot2, ordinal, progressr, Matrix, mcmcse</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (http://mcmc-jags.sourceforge.net/)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, bookdown, R.rsp, ggpubr, testthat (&ge;
3.0.0), spelling</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, R.rsp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-18 16:53:50 UTC; iMED</td>
</tr>
<tr>
<td>Author:</td>
<td>Ying Liu [aut],
  Tony Wang <a href="https://orcid.org/0000-0002-6760-5456"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tony Wang &lt;xwang@imedacs.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-18 17:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='antidep'>wide format of continuous response of antidepressant data.</h2><span id='topic+antidep'></span>

<h3>Description</h3>

<p>A data set containing the treatment and continuous responses measured at baseline and 4 post-baseline visits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>antidep
</code></pre>


<h3>Format</h3>

<p>A data frame with 172 rows and 6 variables:
</p>

<dl>
<dt>PID</dt><dd><p>Patient ID</p>
</dd>
<dt>tx</dt><dd><p>Treatment, 1 for treated and 0 for placebo</p>
</dd>
<dt>y0</dt><dd><p>HADM-17 measurement at the baseline</p>
</dd>
<dt>y1, y2, y4, y6</dt><dd><p>Change score of HADM-17 measurement at the post-baseline week 1, 2, 4, and 6.</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://www.lshtm.ac.uk/research/centres-projects-groups/missing-data#dia-missing-data
</p>

<hr>
<h2 id='clm_MI_CR'>Apply Copy-Reference(CR) Method to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</h2><span id='topic+clm_MI_CR'></span>

<h3>Description</h3>

<p>Internal function to obtain Copy-Reference(CR) MCMC from an MAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clm_MI_CR(object, treatment, start = NULL, end = NULL, thin = NULL,
  exclude_chains = NULL, subset = FALSE, ord_cov_dummy = TRUE,
  seed = NULL, mess = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clm_MI_CR_+3A_object">object</code></td>
<td>
<p>an object of class remoid</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_start">start</code></td>
<td>
<p>first iteration to be used.</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_end">end</code></td>
<td>
<p>last iteration to be used.</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied.</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output.</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used.</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_ord_cov_dummy">ord_cov_dummy</code></td>
<td>
<p>optional. specify whether ordinal variables should be treated as
categorical variables or continuous variables when they are
included as covariates in the sequential imputation models.
Default is <code>TRUE</code>, dummy variables will be created accordingly.</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="clm_MI_CR_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of MCMC samples with all monitored parameters.A subset of
the MCMC sample can be selected using <code>start</code>, <code>end</code> and
<code>thin</code>.
</p>

<hr>
<h2 id='clm_MI_delta'>Apply Delta adjustment to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</h2><span id='topic+clm_MI_delta'></span>

<h3>Description</h3>

<p>Internal function to obtain delta-adjusted MCMC from an MAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clm_MI_delta(object, treatment, delta = 0, start = NULL, end = NULL,
  exclude_chains = NULL, thin = NULL, subset = FALSE,
  ord_cov_dummy = TRUE, seed = NULL, mess = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clm_MI_delta_+3A_object">object</code></td>
<td>
<p>an object of class remiod</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_start">start</code></td>
<td>
<p>first iteration to be used.</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_end">end</code></td>
<td>
<p>last iteration to be used.</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output.</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied.</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used.</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_ord_cov_dummy">ord_cov_dummy</code></td>
<td>
<p>optional. specify whether ordinal variables should be treated as
categorical variables or continuous variables when they are
included as covariates in the sequential imputation models.
Default is <code>TRUE</code>, dummy variables will be created accordingly.</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="clm_MI_delta_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of MCMC samples with all monitored parameters.A subset of
the MCMC sample can be selected using <code>start</code>, <code>end</code> and
<code>thin</code>.
</p>

<hr>
<h2 id='clm_MI_J2R'>Apply Jump-to-Reference(J2R) Method to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</h2><span id='topic+clm_MI_J2R'></span>

<h3>Description</h3>

<p>Internal function to obtain Jump-to-Reference(J2R) MCMC from an MAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clm_MI_J2R(object, treatment, start = NULL, end = NULL, thin = NULL,
  exclude_chains = NULL, subset = FALSE, ord_cov_dummy = TRUE,
  seed = NULL, mess = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clm_MI_J2R_+3A_object">object</code></td>
<td>
<p>an object of class remiod</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_start">start</code></td>
<td>
<p>first iteration to be used.</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_end">end</code></td>
<td>
<p>last iteration to be used.</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied.</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output.</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used.</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_ord_cov_dummy">ord_cov_dummy</code></td>
<td>
<p>optional. specify whether ordinal variables should be treated as
categorical variables or continuous variables when they are
included as covariates in the sequential imputation models.
Default is <code>TRUE</code>, dummy variables will be created accordingly.</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="clm_MI_J2R_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of MCMC samples with all monitored parameters .A subset of
the MCMC sample can be selected using <code>start</code>, <code>end</code> and
<code>thin</code>.
</p>

<hr>
<h2 id='commParams'>Common Parameters used by functions of <code>remiod</code></h2><span id='topic+commParams'></span>

<h3>Description</h3>

<p>Common Parameters used by functions of <code>remiod</code>
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="commParams_+3A_object">object</code></td>
<td>
<p>object inheriting from class 'remoid'</p>
</td></tr>
<tr><td><code id="commParams_+3A_trtvar">trtvar</code></td>
<td>
<p>the name of treatment variable. When necessary, its reference category,
i.e. control arm, can be set in <code>refcats</code> argument.</p>
</td></tr>
<tr><td><code id="commParams_+3A_method">method</code></td>
<td>
<p>a method for obtaining multiple-imputed dataset. Options include
<code>MAR</code>, <code>J2R</code>, <code>CR</code>, and <code>delta</code> adjustment.
Default is MAR.</p>
</td></tr>
<tr><td><code id="commParams_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="commParams_+3A_algorithm">algorithm</code></td>
<td>
<p>either algorithm <code>tang_seq</code> proposed by Tang (2018) or
<code>jags</code> the original method inherited in JAGS (Plummer 2003).</p>
</td></tr>
<tr><td><code id="commParams_+3A_model_order">model_order</code></td>
<td>
<p>optional. manually specify an order for imputation models.</p>
</td></tr>
<tr><td><code id="commParams_+3A_ord_cov_dummy">ord_cov_dummy</code></td>
<td>
<p>optional. specify whether ordinal variables should be treated as
categorical variables or continuous variables when they are
included as covariates in the sequential imputation models.
Default is <code>TRUE</code>, dummy variables will be created accordingly.</p>
</td></tr>
<tr><td><code id="commParams_+3A_rinv">rinv</code></td>
<td>
<p>a small number used to adjusting Fish information matrix</p>
</td></tr>
<tr><td><code id="commParams_+3A_scheme">scheme</code></td>
<td>
<p>scheme of distribution used for proposing coefficients of imputation models.
scheme=1: beta ~ N( mean + inv(I)*score, inv(I));
scheme=2: beta ~ N( mean , inv(I)).</p>
</td></tr>
<tr><td><code id="commParams_+3A_subset">subset</code></td>
<td>
<p>subset of parameters/variables/nodes (columns in the MCMC
sample). Follows the same principle as the argument
<code>monitor_params</code> and <code>selected_parms</code>.</p>
</td></tr>
<tr><td><code id="commParams_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of the index numbers of chains that
should be excluded</p>
</td></tr>
<tr><td><code id="commParams_+3A_start">start</code></td>
<td>
<p>the first iteration of interest
(see <code><a href="coda.html#topic+window.mcmc">window.mcmc</a></code>)</p>
</td></tr>
<tr><td><code id="commParams_+3A_end">end</code></td>
<td>
<p>the last iteration of interest
(see <code><a href="coda.html#topic+window.mcmc">window.mcmc</a></code>)</p>
</td></tr>
<tr><td><code id="commParams_+3A_progress.bar">progress.bar</code></td>
<td>
<p>character string specifying the type of
progress bar. Possible values are &quot;text&quot; (default), &quot;gui&quot;,
and &quot;none&quot; (see <code><a href="rjags.html#topic+update">update</a></code>). Note: when
sampling is performed in parallel it is not possible to
display a progress bar.</p>
</td></tr>
<tr><td><code id="commParams_+3A_seed">seed</code></td>
<td>
<p>optional; seed value (for reproducibility)</p>
</td></tr>
<tr><td><code id="commParams_+3A_include">include</code></td>
<td>
<p>logical, if TRUE, raw data will be included in imputed data sets
with imputation ID = 0.</p>
</td></tr>
<tr><td><code id="commParams_+3A_mi.setting">mi.setting</code></td>
<td>
<p>a list of arguments related to multiple imputation, including
trtvar, algorithm, method, include, exclude_chains, thin, start,
end, and seed.</p>
</td></tr>
</table>

<hr>
<h2 id='extract_MIdata'>Extract a specified number of multiple imputed datasets</h2><span id='topic+extract_MIdata'></span>

<h3>Description</h3>

<p>Extract a specified number of multiple imputed datasets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_MIdata(object, method = c("MAR", "J2R", "CR", "delta"), delta = 0,
  mi.setting = NULL, M = 10, minspace = 2, mess = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_MIdata_+3A_object">object</code></td>
<td>
<p>object inheriting from class 'remoid'</p>
</td></tr>
<tr><td><code id="extract_MIdata_+3A_method">method</code></td>
<td>
<p>a method for obtaining multiple-imputed dataset. Options include
<code>MAR</code>, <code>J2R</code>, <code>CR</code>, and <code>delta</code> adjustment.
Default is MAR.</p>
</td></tr>
<tr><td><code id="extract_MIdata_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="extract_MIdata_+3A_mi.setting">mi.setting</code></td>
<td>
<p>a list of arguments related to multiple imputation, including
trtvar, algorithm, method, include, exclude_chains, thin, start,
end, and seed.</p>
</td></tr>
<tr><td><code id="extract_MIdata_+3A_m">M</code></td>
<td>
<p>number of imputed datasets</p>
</td></tr>
<tr><td><code id="extract_MIdata_+3A_minspace">minspace</code></td>
<td>
<p>minimum number of iterations between iterations to be chosen
as imputed values (to prevent strong correlation between
imputed datasets in the case of high autocorrelation of the
MCMC chains).</p>
</td></tr>
<tr><td><code id="extract_MIdata_+3A_mess">mess</code></td>
<td>
<p>logical; should messages be given? Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> in which the imputed datasets are stacked onto
each other. The variable <code>Imp_</code> indexes the imputation, while
<code>.rownr</code> links the rows to the rows of the original data.
In cross-sectional datasets the variable <code>.id</code> is added as
subject identifier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# data(schizow)

test = remiod(formula = y6 ~ tx + y0 + y1 + y3, data = schizow,
              trtvar = 'tx', algorithm = 'jags', method="MAR",
              ord_cov_dummy = FALSE, n.adapt = 10, n.chains = 1,
              n.iter = 100, thin = 2, warn = FALSE, seed = 1234)

extdt = extract_MIdata(object=test, method="J2R",mi.setting=NULL, M=10, minspace=2)


</code></pre>

<hr>
<h2 id='get_class'>Obtain ordinal results based on log-odds (eta) and cut-offs (gamma) from MCMC
Internal function to obtain ordinal results based on log-odds (eta) and cut-offs (gamma) from MCMC.</h2><span id='topic+get_class'></span>

<h3>Description</h3>

<p>Obtain ordinal results based on log-odds (eta) and cut-offs (gamma) from MCMC
Internal function to obtain ordinal results based on log-odds (eta) and cut-offs (gamma) from MCMC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_class(MCMC, impvar, eta_name, rev = FALSE, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_class_+3A_mcmc">MCMC</code></td>
<td>
<p>an matrix of MCMC samples.</p>
</td></tr>
<tr><td><code id="get_class_+3A_impvar">impvar</code></td>
<td>
<p>a name of imputation variable.</p>
</td></tr>
<tr><td><code id="get_class_+3A_eta_name">eta_name</code></td>
<td>
<p>a name of eta in mcmc samples</p>
</td></tr>
<tr><td><code id="get_class_+3A_rev">rev</code></td>
<td>
<p>logical. Reverse order or not.</p>
</td></tr>
<tr><td><code id="get_class_+3A_seed">seed</code></td>
<td>
<p>optional. A seed value for randomness.</p>
</td></tr>
</table>

<hr>
<h2 id='get_MI_RB'>Create multiple imputed datasets based on assigned imputation method.</h2><span id='topic+get_MI_RB'></span>

<h3>Description</h3>

<p>Internal function, creates multiple imputed datasets based on assigned
imputation method returns multiple imputed datasets stacked
onto each other (i.e., long format; optionally including the original,
incomplete data).<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_MI_RB(object, treatment, method = c("MAR", "J2R", "CR", "delta"),
  delta = 0, exclude_chains = NULL, start = NULL, end = NULL,
  seed = NULL, thin = NULL, subset = FALSE, include = TRUE,
  ord_cov_dummy = TRUE, mess = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_MI_RB_+3A_object">object</code></td>
<td>
<p>an object of class JointAI</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_method">method</code></td>
<td>
<p>a method for obtaining multiple-imputed dataset. Options
include MAR, J2R, CR, and Delta adjustment.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_start">start</code></td>
<td>
<p>first iteration to be used.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_end">end</code></td>
<td>
<p>last iteration to be used.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_include">include</code></td>
<td>
<p>should the original, incomplete data be included? Default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_ord_cov_dummy">ord_cov_dummy</code></td>
<td>
<p>optional. specify whether ordinal variables should be treated as
categorical variables or continuous variables when they are
included as covariates in the sequential imputation models.
Default is <code>TRUE</code>, dummy variables will be created accordingly.</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="get_MI_RB_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> in which the original data (if
<code>include = TRUE</code>) and the imputed datasets are stacked onto
each other.<br />
The variable <code>Imputation_</code> indexes the imputation, while
<code>.rownr</code> links the rows to the rows of the original data.
In cross-sectional datasets the
variable <code>.id</code> is added as subject identifier.
</p>

<hr>
<h2 id='get_Mlist'>Prepare imputation-model-related information</h2><span id='topic+get_Mlist'></span>

<h3>Description</h3>

<p>Internal function to extract information of imputation models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_Mlist(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_Mlist_+3A_object">object</code></td>
<td>
<p>object inheriting from class <code>remoid</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list include raw data, imputation models, model types, fixed effects,
random effects if any, reference categories corresponding to categorical
variables in models, and interaction terms.
</p>

<hr>
<h2 id='get_subset'>Extract specific parameters from MCMC samples</h2><span id='topic+get_subset'></span>

<h3>Description</h3>

<p>Extract specific parameters from MCMC samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_subset(object, subset, warn = TRUE, mess = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_subset_+3A_object">object</code></td>
<td>
<p>an object of class <code>MCMC</code>.</p>
</td></tr>
<tr><td><code id="get_subset_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used. See
https://nerler.github.io/JointAI/articles/SelectingParameters.html
for key-words of subseting parameters. Besides, <code>selected_parms</code>
and <code>selected_vars</code> are new key-words for arbitrarily selecting
parameters.</p>
</td></tr>
<tr><td><code id="get_subset_+3A_warn">warn</code></td>
<td>
<p>logical, should warning messages be displayed?</p>
</td></tr>
<tr><td><code id="get_subset_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(schizow)

test = remiod(formula = y6 ~ tx + y0 + y1 + y3, data = schizow,
              trtvar = 'tx', algorithm = 'jags', method="MAR",
              ord_cov_dummy = FALSE, n.adapt = 10, n.chains = 1,
              n.iter = 0, thin = 1, warn = FALSE, seed = 1234)

pms = c("beta[2]","alpha[2]","alpha[6]","alpha[9]")
mcsub = get_subset(object = test$mc.mar, subset=c(selected_parms = list(pms)))


</code></pre>

<hr>
<h2 id='glm_MI_CR'>Apply Copy-Reference(CR) Method to Update JAGS MCMC outputs under MAR for Generalized Linear Model</h2><span id='topic+glm_MI_CR'></span>

<h3>Description</h3>

<p>Internal function to obtain Copy-Reference(CR) MCMC from an MAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm_MI_CR(object, treatment, start = NULL, end = NULL, thin = NULL,
  exclude_chains = NULL, subset = FALSE, seed = 5432, mess = FALSE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glm_MI_CR_+3A_object">object</code></td>
<td>
<p>an object of class remiod</p>
</td></tr>
<tr><td><code id="glm_MI_CR_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="glm_MI_CR_+3A_start">start</code></td>
<td>
<p>first iteration to be used</p>
</td></tr>
<tr><td><code id="glm_MI_CR_+3A_end">end</code></td>
<td>
<p>last iteration to be used</p>
</td></tr>
<tr><td><code id="glm_MI_CR_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied</p>
</td></tr>
<tr><td><code id="glm_MI_CR_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output</p>
</td></tr>
<tr><td><code id="glm_MI_CR_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used</p>
</td></tr>
<tr><td><code id="glm_MI_CR_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="glm_MI_CR_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="glm_MI_CR_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of MCMC samples with all monitored parameters.A subset of
the MCMC sample can be selected using <code>start</code>, <code>end</code> and
<code>thin</code>.
</p>

<hr>
<h2 id='glm_MI_delta'>Apply Delta adjustment to Update JAGS MCMC outputs under MAR for Generalized Linear Model</h2><span id='topic+glm_MI_delta'></span>

<h3>Description</h3>

<p>Internal function to obtain delta-adjusted MCMC from an MAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm_MI_delta(object, treatment, delta = 0, start = NULL, end = NULL,
  thin = NULL, exclude_chains = NULL, subset = FALSE, seed = 5432,
  mess = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glm_MI_delta_+3A_object">object</code></td>
<td>
<p>an object of class remiod</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_start">start</code></td>
<td>
<p>first iteration to be used</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_end">end</code></td>
<td>
<p>last iteration to be used</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="glm_MI_delta_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of MCMC samples with all monitored parameters.A subset of
the MCMC sample can be selected using <code>start</code>, <code>end</code> and
<code>thin</code>.
</p>

<hr>
<h2 id='glm_MI_J2R'>Apply Jump-to-Reference(J2R) Method to Update JAGS MCMC outputs under MAR for Generalized Linear Model</h2><span id='topic+glm_MI_J2R'></span>

<h3>Description</h3>

<p>Internal function to obtain Jump-to-Reference(J2R) MCMC from an MAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm_MI_J2R(object, treatment, start = NULL, end = NULL, thin = NULL,
  exclude_chains = NULL, subset = FALSE, seed = 5432, mess = FALSE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glm_MI_J2R_+3A_object">object</code></td>
<td>
<p>an object of class remiod</p>
</td></tr>
<tr><td><code id="glm_MI_J2R_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="glm_MI_J2R_+3A_start">start</code></td>
<td>
<p>first iteration to be used</p>
</td></tr>
<tr><td><code id="glm_MI_J2R_+3A_end">end</code></td>
<td>
<p>last iteration to be used</p>
</td></tr>
<tr><td><code id="glm_MI_J2R_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied</p>
</td></tr>
<tr><td><code id="glm_MI_J2R_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output</p>
</td></tr>
<tr><td><code id="glm_MI_J2R_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used</p>
</td></tr>
<tr><td><code id="glm_MI_J2R_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="glm_MI_J2R_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="glm_MI_J2R_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of MCMC samples with all monitored parameters.A subset of
the MCMC sample can be selected using <code>start</code>, <code>end</code> and
<code>thin</code>.
</p>

<hr>
<h2 id='list.models'>Listing the sequence of models used for imputation</h2><span id='topic+list.models'></span>

<h3>Description</h3>

<p>Listing the sequence of models used for imputation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list.models(object, details = FALSE, print = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list.models_+3A_object">object</code></td>
<td>
<p>an object of class <code>remiod</code></p>
</td></tr>
<tr><td><code id="list.models_+3A_details">details</code></td>
<td>
<p>logical. Default is FALSE, where listing all models in formula format. If TRUE,
details of each models will be presented.</p>
</td></tr>
<tr><td><code id="list.models_+3A_print">print</code></td>
<td>
<p>logical. Default is TRUE to print all imputation models or detailed imputation models.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of formula of imputation models. If <code>details=TRUE</code>, information on the conditional
distributions of the covariates in each imputation models. Note: the sequence of conditional
models together specifies the joint distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# data(schizow)

test = remiod(formula = y6 ~ tx + y0 + y1 + y3, data = schizow,
              trtvar = 'tx', algorithm = 'jags', method="MAR",
              ord_cov_dummy = FALSE, n.adapt = 10, n.chains = 1,
              n.iter = 10, thin = 2, warn = FALSE, seed = 1234)

list.models(test)

</code></pre>

<hr>
<h2 id='mcmcplot'>Visualizing the posterior sample
Creates a set of plots for visually evaluating convergence and mixing of the chains
from the MCMC sample of an object of class 'remiod'.</h2><span id='topic+mcmcplot'></span>

<h3>Description</h3>

<p>Visualizing the posterior sample
Creates a set of plots for visually evaluating convergence and mixing of the chains
from the MCMC sample of an object of class 'remiod'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmcplot(object, what = c("trace", "density"), subset = c(analysis_main =
  TRUE), outcome = NULL, mi.setting = NULL, nrow = NULL, ncol = NULL,
  use_ggplot = TRUE, mess = TRUE, warn = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmcplot_+3A_object">object</code></td>
<td>
<p>an object inheriting from class 'remoid'</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_what">what</code></td>
<td>
<p>select either trace or density plots from MCMC samples</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_subset">subset</code></td>
<td>
<p>subset of parameters/variables/nodes (columns in the MCMC
sample). Follows the same principle as the argument
<code>monitor_params</code> in
<code><a href="JointAI.html#topic+model_imp">*_imp</a></code>.</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_outcome">outcome</code></td>
<td>
<p>optional; vector identifying a subset of sub-models included
in the output, either by specifying their indices (using the
order used in the list of model formulas), or their
names (LHS of the respective model formula as character
string)</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_mi.setting">mi.setting</code></td>
<td>
<p>a list of arguments for extracting MI data set, which
will be used to update the one in <code>remoid</code> object.
Default is NULL, meaning no update to the mi.setting
in <code>remoid</code> object.</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_nrow">nrow</code></td>
<td>
<p>optional; number of rows in the plot layout;
automatically chosen if unspecified</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_ncol">ncol</code></td>
<td>
<p>optional; number of columns in the plot layout;
automatically chosen if unspecified</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_use_ggplot">use_ggplot</code></td>
<td>
<p>logical; Should ggplot be used instead of the base
graphics?</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_mess">mess</code></td>
<td>
<p>logical; should messages be given? Default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_warn">warn</code></td>
<td>
<p>logical; should warnings be given? Default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="mcmcplot_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="graphics.html#topic+matplot">graphics::matplot</a></code>
</p>

<dl>
<dt><code>lty,lwd,lend</code></dt><dd><p>vector of line types, widths, and end styles.
The first element is for the first column, the second element for
the second column, etc., even if lines are not plotted for all
columns. Line types will be used cyclically until all plots are
drawn.</p>
</dd>
<dt><code>col</code></dt><dd><p>vector of colors.  Colors are used cyclically.</p>
</dd>
<dt><code>cex</code></dt><dd><p>vector of character expansion sizes, used cyclically.
This works as a multiple of <code><a href="graphics.html#topic+par">par</a>("cex")</code>.  <code>NULL</code> is
equivalent to <code>1.0</code>. </p>
</dd>
<dt><code>bg</code></dt><dd><p>vector of background (fill) colors for the open plot
symbols given by <code>pch = 21:25</code> as in <code><a href="graphics.html#topic+points">points</a></code>.  The
default <code>NA</code> corresponds to the one of the underlying function
<code><a href="graphics.html#topic+plot.xy">plot.xy</a></code>.</p>
</dd>
<dt><code>add</code></dt><dd><p>logical.  If <code>TRUE</code>, plots are added to current one,
using <code><a href="graphics.html#topic+points">points</a></code> and <code><a href="graphics.html#topic+lines">lines</a></code>.</p>
</dd>
<dt><code>verbose</code></dt><dd><p>logical.  If <code>TRUE</code>, write one line of what is
done.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>plots of traces or densities of MCMC samples for selected parameters in
imputation models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# data(schizow)

test = remiod(formula = y6 ~ tx + y0 + y1 + y3, data = schizow,
              trtvar = 'tx', algorithm = 'jags', method="MAR",
              ord_cov_dummy = FALSE, n.adapt = 10, n.chains = 1,
              n.iter = 10, thin = 2, warn = FALSE, seed = 1234)

p1 = mcmcplot(object=test, what="trace")


</code></pre>

<hr>
<h2 id='miAnalyze'>Takes multiply imputed datasets (as generated by the <code>extract_MIdata()</code> function)
and runs an analysis function on each of them.</h2><span id='topic+miAnalyze'></span>

<h3>Description</h3>

<p>Takes multiply imputed datasets (as generated by the <code>extract_MIdata()</code> function)
and runs an analysis function on each of them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>miAnalyze(formula, family = NULL, data, pool = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="miAnalyze_+3A_formula">formula</code></td>
<td>
<p>a two sided model formula (see <code><a href="stats.html#topic+formula">formula</a></code>).</p>
</td></tr>
<tr><td><code id="miAnalyze_+3A_family">family</code></td>
<td>
<p>only for <code>glm</code>: a description of the distribution and link
function to be used in the model. This can be a character string
naming a family function, a family function or the result of a
call to a family function. (For more details see below and
<code><a href="stats.html#topic+family">family</a></code>.)</p>
</td></tr>
<tr><td><code id="miAnalyze_+3A_data">data</code></td>
<td>
<p>the output object of <code>extract_MIdata()</code> function.</p>
</td></tr>
<tr><td><code id="miAnalyze_+3A_pool">pool</code></td>
<td>
<p>logical. If TRUE, estimates from each imputed data set will be
pooled together according to Rubin's rules. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rubin_rules</code> applies Rubin's rules (Rubin, 1987) for pooling together
the results from a multiple imputation procedure. The pooled point <code>Estimate</code> is
is the average across the point estimates from the complete-data analyses.
The <code>SE</code> is the square-root of the sum of two terms representing the within-variance
and the between-variance (see Little-Rubin (2002)). The function also returns
95% confidence interval, based on the estimated pooled degrees of freedom
that can be used for inference based on the t-distribution.
</p>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li><p> list of estimated coefficients and standard error from each imputed data.
</p>
</li>
<li><p> pooled estimates based Rubin's rule if <code>pool = TRUE</code>.
</p>
</li></ul>


<hr>
<h2 id='opm_MI_CR'>Apply Copy-Reference(CR) Method to Update JAGS MCMC outputs under MAR for probit Model</h2><span id='topic+opm_MI_CR'></span>

<h3>Description</h3>

<p>Internal function to obtain Copy-Reference(CR) MCMC from an MAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opm_MI_CR(object, treatment, start = NULL, end = NULL, thin = NULL,
  exclude_chains = NULL, subset = FALSE, seed = NULL, mess = FALSE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="opm_MI_CR_+3A_object">object</code></td>
<td>
<p>an object of class remoid</p>
</td></tr>
<tr><td><code id="opm_MI_CR_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="opm_MI_CR_+3A_start">start</code></td>
<td>
<p>first iteration to be used.</p>
</td></tr>
<tr><td><code id="opm_MI_CR_+3A_end">end</code></td>
<td>
<p>last iteration to be used.</p>
</td></tr>
<tr><td><code id="opm_MI_CR_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied.</p>
</td></tr>
<tr><td><code id="opm_MI_CR_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output.</p>
</td></tr>
<tr><td><code id="opm_MI_CR_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used.</p>
</td></tr>
<tr><td><code id="opm_MI_CR_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="opm_MI_CR_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="opm_MI_CR_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of MCMC samples with all monitored parameters.A subset of
the MCMC sample can be selected using <code>start</code>, <code>end</code> and
<code>thin</code>.
</p>

<hr>
<h2 id='opm_MI_delta'>Apply Delta adjustment to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</h2><span id='topic+opm_MI_delta'></span>

<h3>Description</h3>

<p>Internal function to obtain delta-adjusted MCMC from an MAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opm_MI_delta(object, treatment, delta = 0, start = NULL, end = NULL,
  thin = NULL, exclude_chains = NULL, subset = FALSE, seed = NULL,
  mess = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="opm_MI_delta_+3A_object">object</code></td>
<td>
<p>an object of class remiod</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_start">start</code></td>
<td>
<p>first iteration to be used.</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_end">end</code></td>
<td>
<p>last iteration to be used.</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied.</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output.</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used.</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="opm_MI_delta_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of MCMC samples with all monitored parameters.A subset of
the MCMC sample can be selected using <code>start</code>, <code>end</code> and
<code>thin</code>.
</p>

<hr>
<h2 id='opm_MI_J2R'>Apply Jump-to-Reference(J2R) Method to Update JAGS MCMC outputs under MAR for Cumulative Logistic Model</h2><span id='topic+opm_MI_J2R'></span>

<h3>Description</h3>

<p>Internal function to obtain Jump-to-Reference(J2R) MCMC from an MAR object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opm_MI_J2R(object, treatment, start = NULL, end = NULL, thin = NULL,
  exclude_chains = NULL, subset = FALSE, seed = NULL, mess = FALSE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="opm_MI_J2R_+3A_object">object</code></td>
<td>
<p>an object of class remiod</p>
</td></tr>
<tr><td><code id="opm_MI_J2R_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="opm_MI_J2R_+3A_start">start</code></td>
<td>
<p>first iteration to be used.</p>
</td></tr>
<tr><td><code id="opm_MI_J2R_+3A_end">end</code></td>
<td>
<p>last iteration to be used.</p>
</td></tr>
<tr><td><code id="opm_MI_J2R_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied.</p>
</td></tr>
<tr><td><code id="opm_MI_J2R_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be excluded from the output.</p>
</td></tr>
<tr><td><code id="opm_MI_J2R_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used.</p>
</td></tr>
<tr><td><code id="opm_MI_J2R_+3A_seed">seed</code></td>
<td>
<p>optional seed value.</p>
</td></tr>
<tr><td><code id="opm_MI_J2R_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="opm_MI_J2R_+3A_...">...</code></td>
<td>
<p>optional arguments pass from main function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of MCMC samples with all monitored parameters .A subset of
the MCMC sample can be selected using <code>start</code>, <code>end</code> and
<code>thin</code>.
</p>

<hr>
<h2 id='prep_MCMC'>Extract MCMC samples of monitored parameters from JointAI object. Code from JointAI.</h2><span id='topic+prep_MCMC'></span>

<h3>Description</h3>

<p>Extract MCMC samples of monitored parameters from JointAI object. Code from JointAI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_MCMC(object, treatment = NULL, delta = 0, start = NULL,
  end = NULL, thin = NULL, subset = FALSE, exclude_chains = NULL,
  warn = TRUE, mess = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_MCMC_+3A_object">object</code></td>
<td>
<p>an object of class JointAI</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_treatment">treatment</code></td>
<td>
<p>the variable name of treatment. Reference level of treatment should be coded as 0.</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_start">start</code></td>
<td>
<p>first iteration to be used</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_end">end</code></td>
<td>
<p>last iteration to be used</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_subset">subset</code></td>
<td>
<p>subset of parameters (columns of the mcmc object) to be used</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of numbers, indexing MCMC chains to be</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_warn">warn</code></td>
<td>
<p>logical, should warning messages be displayed?</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_mess">mess</code></td>
<td>
<p>logical, should messages be displayed?</p>
</td></tr>
<tr><td><code id="prep_MCMC_+3A_...">...</code></td>
<td>
<p>optional arguments passed from <code>remiod</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='remiod'>Reference-Based Multiple Imputation for Ordinal/Binary Response</h2><span id='topic+remiod'></span>

<h3>Description</h3>

<p>Reference-Based Multiple Imputation for Ordinal/Binary Response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remiod(formula, data, trtvar, refcats = NULL, family = NULL,
  method = "MAR", delta = 0, algorithm = c("tang_seq", "jags"),
  rinv = 1e-04, scheme = 2, model_order = NULL, models = NULL,
  ord_cov_dummy = TRUE, n.chains = 2, n.adapt = 100, n.iter = 1000,
  thin = 2, start = NULL, end = NULL, seed = 1234,
  exclude_chains = NULL, subset = NULL, include = FALSE, mess = TRUE,
  warn = FALSE, progress.bar = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remiod_+3A_formula">formula</code></td>
<td>
<p>a two sided model formula (see <code><a href="stats.html#topic+formula">formula</a></code>)
or a list of such formulas; (more details below).</p>
</td></tr>
<tr><td><code id="remiod_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> containing the original data
(more details below)</p>
</td></tr>
<tr><td><code id="remiod_+3A_trtvar">trtvar</code></td>
<td>
<p>the name of treatment variable. When necessary, its reference category,
i.e. control arm, can be set in <code>refcats</code> argument.</p>
</td></tr>
<tr><td><code id="remiod_+3A_refcats">refcats</code></td>
<td>
<p>optional; either one of <code>"first"</code>, <code>"last"</code>,
<code>"largest"</code> (which sets the category for all categorical
variables) or a named list specifying which category should
be used as reference category per categorical variable.
Options are the category label, the category number,
or one of &quot;first&quot; (the first category),
&quot;last&quot; (the last category) or &quot;largest&quot; (chooses the category
with the most observations).
Default is &quot;first&quot;. If reference categories are specified for
a subset of the categorical variables the default will be
used for the remaining variables.
(See also <code><a href="JointAI.html#topic+set_refcat">set_refcat</a></code>)</p>
</td></tr>
<tr><td><code id="remiod_+3A_family">family</code></td>
<td>
<p>only for <code>glm_imp</code> and <code>glmm_imp</code>/<code>glmer_imp</code>:
a description of the distribution and link function to
be used in the model. This can be a character string naming a
family function, a family function or the result of a call to
a family function. (For more details see below and
<code><a href="stats.html#topic+family">family</a></code>.)</p>
</td></tr>
<tr><td><code id="remiod_+3A_method">method</code></td>
<td>
<p>a method for obtaining multiple-imputed dataset. Options include
<code>MAR</code>, <code>J2R</code>, <code>CR</code>, and <code>delta</code> adjustment.
Default is MAR.</p>
</td></tr>
<tr><td><code id="remiod_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="remiod_+3A_algorithm">algorithm</code></td>
<td>
<p>either algorithm <code>tang_seq</code> proposed by Tang (2018) or
<code>jags</code> the original method inherited in JAGS (Plummer 2003).</p>
</td></tr>
<tr><td><code id="remiod_+3A_rinv">rinv</code></td>
<td>
<p>a small number used to adjusting Fish information matrix</p>
</td></tr>
<tr><td><code id="remiod_+3A_scheme">scheme</code></td>
<td>
<p>scheme of distribution used for proposing coefficients of imputation models.
scheme=1: beta ~ N( mean + inv(I)*score, inv(I));
scheme=2: beta ~ N( mean , inv(I)).</p>
</td></tr>
<tr><td><code id="remiod_+3A_model_order">model_order</code></td>
<td>
<p>optional. manually specify an order for imputation models.</p>
</td></tr>
<tr><td><code id="remiod_+3A_models">models</code></td>
<td>
<p>optional; named vector specifying the types of models for
(incomplete) covariates.
This arguments replaces the argument <code>meth</code> used in
earlier versions.
If <code>NULL</code> (default) models will be determined
automatically based on the class of the respective columns of
<code>data</code>.</p>
</td></tr>
<tr><td><code id="remiod_+3A_ord_cov_dummy">ord_cov_dummy</code></td>
<td>
<p>optional. specify whether ordinal variables should be treated as
categorical variables or continuous variables when they are
included as covariates in the sequential imputation models.
Default is <code>TRUE</code>, dummy variables will be created accordingly.</p>
</td></tr>
<tr><td><code id="remiod_+3A_n.chains">n.chains</code></td>
<td>
<p>number of MCMC chains</p>
</td></tr>
<tr><td><code id="remiod_+3A_n.adapt">n.adapt</code></td>
<td>
<p>number of iterations for adaptation of the MCMC samplers
(see <code><a href="rjags.html#topic+adapt">adapt</a></code>)</p>
</td></tr>
<tr><td><code id="remiod_+3A_n.iter">n.iter</code></td>
<td>
<p>number of iterations of the MCMC chain (after adaptation;
see <code><a href="rjags.html#topic+coda.samples">coda.samples</a></code>)</p>
</td></tr>
<tr><td><code id="remiod_+3A_thin">thin</code></td>
<td>
<p>thinning interval (integer; see <code><a href="coda.html#topic+window.mcmc">window.mcmc</a></code>).
For example, <code>thin = 1</code> (default) will keep the MCMC samples
from all iterations; <code>thin = 5</code> would only keep every 5th
iteration.</p>
</td></tr>
<tr><td><code id="remiod_+3A_start">start</code></td>
<td>
<p>the first iteration of interest
(see <code><a href="coda.html#topic+window.mcmc">window.mcmc</a></code>)</p>
</td></tr>
<tr><td><code id="remiod_+3A_end">end</code></td>
<td>
<p>the last iteration of interest
(see <code><a href="coda.html#topic+window.mcmc">window.mcmc</a></code>)</p>
</td></tr>
<tr><td><code id="remiod_+3A_seed">seed</code></td>
<td>
<p>optional; seed value (for reproducibility)</p>
</td></tr>
<tr><td><code id="remiod_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of the index numbers of chains that
should be excluded</p>
</td></tr>
<tr><td><code id="remiod_+3A_subset">subset</code></td>
<td>
<p>subset of parameters/variables/nodes (columns in the MCMC
sample). Follows the same principle as the argument
<code>monitor_params</code> and <code>selected_parms</code>.</p>
</td></tr>
<tr><td><code id="remiod_+3A_include">include</code></td>
<td>
<p>logical, if TRUE, raw data will be included in imputed data sets
with imputation ID = 0.</p>
</td></tr>
<tr><td><code id="remiod_+3A_mess">mess</code></td>
<td>
<p>logical; should messages be given? Default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="remiod_+3A_warn">warn</code></td>
<td>
<p>logical; should warnings be given? Default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="remiod_+3A_progress.bar">progress.bar</code></td>
<td>
<p>character string specifying the type of
progress bar. Possible values are &quot;text&quot; (default), &quot;gui&quot;,
and &quot;none&quot; (see <code><a href="rjags.html#topic+update">update</a></code>). Note: when
sampling is performed in parallel it is not possible to
display a progress bar.</p>
</td></tr>
<tr><td><code id="remiod_+3A_...">...</code></td>
<td>
<p>additional, optional arguments
</p>

<dl>
<dt><code>trunc</code></dt><dd><p>named list specifying limits of truncation for the
distribution of the named incomplete variables (see the
vignette
<a href="https://nerler.github.io/JointAI/articles/ModelSpecification.html#functions-with-restricted-support">ModelSpecification</a>)</p>
</dd>
<dt><code>hyperpars</code></dt><dd><p>list of hyper-parameters, as obtained by
<code><a href="JointAI.html#topic+default_hyperpars">default_hyperpars</a>()</code></p>
</dd>
<dt><code>scale_vars</code></dt><dd><p>named vector of (continuous) variables that
will be centred and scaled (such that mean = 0 and sd = 1)
when they enter a linear predictor to improve
convergence of the MCMC sampling. Default is that all
numeric variables and integer variables with &gt;20 different
values will be scaled.
If set to <code>FALSE</code> no scaling will be done.</p>
</dd>
<dt><code>custom</code></dt><dd><p>named list of JAGS model chunks (character strings)
that replace the model for the given variable.</p>
</dd>
<dt><code>append_data_list</code></dt><dd><p>list that will be appended to the list
containing the data that is passed to <strong>rjags</strong>
(<code>data_list</code>). This may be necessary if additional data /
variables are needed for custom (covariate) models.</p>
</dd>
<dt><code>progress.bar</code></dt><dd><p>character string specifying the type of
progress bar. Possible values are &quot;text&quot; (default), &quot;gui&quot;,
and &quot;none&quot; (see <code><a href="rjags.html#topic+update">update</a></code>). Note: when
sampling is performed in parallel it is not possible to
display a progress bar.</p>
</dd>
<dt><code>quiet</code></dt><dd><p>logical; if <code>TRUE</code> then messages generated by
<strong>rjags</strong> during compilation as well as the progress bar
for the adaptive phase will be suppressed,
(see <code><a href="rjags.html#topic+jags.model">jags.model</a></code>)</p>
</dd>
<dt><code>keep_scaled_mcmc</code></dt><dd><p>should the &quot;original&quot; MCMC sample (i.e.,
the scaled version returned by <code>coda.samples()</code>) be
kept? (The MCMC sample that is re-scaled to the scale of the
data is always kept.)</p>
</dd>
<dt><code>modelname</code></dt><dd><p>character string specifying the name of the
model file (including the ending, either .R or .txt). If
unspecified a random name will be generated.</p>
</dd>
<dt><code>modeldir</code></dt><dd><p>directory containing the model file or directory
in which the model file should be written. If unspecified a
temporary directory will be created.</p>
</dd>
<dt><code>overwrite</code></dt><dd><p>logical; whether an existing model file with
the specified <code>&lt;modeldir&gt;/&lt;modelname&gt;</code> should be
overwritten. If set to <code>FALSE</code> and a model already
exists, that model will be used. If unspecified (<code>NULL</code>)
and a file exists, the user is asked for input on how to
proceed.</p>
</dd>
<dt><code>keep_model</code></dt><dd><p>logical; whether the created JAGS model file
should be saved or removed from (<code>FALSE</code>; default) when
the sampling has finished.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A list includes (1) Information from JAGS modeling and MCMC samples
and (2) A <code>data.frame</code> in which the original data (if
<code>include = TRUE</code>) and the imputed datasets are stacked onto
each other.<br />
The variable <code>Imputation_</code> indexes the imputation, while
<code>.rownr</code> links the rows to the rows of the original data.
In cross-sectional datasets the
variable <code>.id</code> is added as subject identifier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(schizow)

test = remiod(formula = y6 ~ tx + y0 + y1 + y3, data = schizow,
              trtvar = 'tx', algorithm = 'jags', method="MAR",
              ord_cov_dummy = FALSE, n.adapt = 10, n.chains = 1,
              n.iter = 10, thin = 2, warn = FALSE, seed = 1234)


</code></pre>

<hr>
<h2 id='schizo'>National Institute of Mental Health shizophrenia study</h2><span id='topic+schizo'></span>

<h3>Description</h3>

<p>Schizophrenia data from a randomized controlled trial with
patients assigned to either drug or placebo group. &quot;Severity of
Illness&quot; was measured, at weeks 0, 1, ..., 6, on a four category
ordered scale. Most of the observations where made on weeks 0, 1, 3,
and 6.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(schizo)</code></pre>


<h3>Format</h3>

<p>A data frame with 1603 observations on 437 subjects. Five vectors
contain information on
</p>

<dl>
<dt><code>id</code></dt><dd><p>patient ID.</p>
</dd>
<dt><code>imps79</code></dt><dd><p>original response measurements on a numerical
scale.</p>
</dd>
<dt><code>imps79b</code></dt><dd><p>binary response based on the cut-off value
of 3.5 to the measurements on a numerical scale: 0 = normal to
mildly ill and 1 = moderately to extremely ill</p>
</dd>
<dt><code>imps79o</code></dt><dd><p>ordinal response on a 4 category scale,
&quot;normal or borderline mentally ill&quot; &lt; &quot;mildly or moderately ill&quot;,
&quot;markedly ill&quot;, &quot;severely or among the most extremely ill&quot;.</p>
</dd>
<dt><code>tx</code></dt><dd><p>treatment indicator: 1 for drug, 0 for placebo.</p>
</dd>
<dt><code>week</code></dt><dd><p>week.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The documentation file was copied from the <span class="pkg">mixcat</span> package
and slightly modified.</p>


<h3>Source</h3>

<p><a href="https://hedeker.people.uic.edu/ml.html">https://hedeker.people.uic.edu/ml.html</a></p>


<h3>References</h3>

<p>Hedeker, D. and R. Gibbons (2006). <em>Longitudinal Data
Analysis</em>. New Jersey, USA: John Wiley &amp; Sons.</p>

<hr>
<h2 id='schizob'>wide format of binary response of Schizophrenia data.</h2><span id='topic+schizob'></span>

<h3>Description</h3>

<p>A dataset containing the treatment and binary responses measured at baseline and 3 post-baseline visits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>schizob
</code></pre>


<h3>Format</h3>

<p>A data frame with 437 rows and 5 variables:
</p>

<dl>
<dt>tx</dt><dd><p>treatment, 1 for treated and 0 for placebo</p>
</dd>
<dt>y0</dt><dd><p>binary response at the baseline</p>
</dd>
<dt>y1, y3, y6</dt><dd><p>binary response at the post-baseline week 1, 3, and 6.</p>
</dd>
</dl>



<h3>Source</h3>

<p>long-to-wise tranformation of schizo data, i.e. schizob = data.table::dcast(schizo, id + tx ~ week, value.var = &quot;imps79b&quot;)
</p>

<hr>
<h2 id='schizow'>wide format of ordinal response of Schizophrenia data.</h2><span id='topic+schizow'></span>

<h3>Description</h3>

<p>A dataset containing the treatment and ordinal responses measured at baseline and 3 post-baseline visits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>schizow
</code></pre>


<h3>Format</h3>

<p>A data frame with 437 rows and 5 variables:
</p>

<dl>
<dt>tx</dt><dd><p>treatment, 1 for treated and 0 for placebo</p>
</dd>
<dt>y0</dt><dd><p>ordinal response at the baseline</p>
</dd>
<dt>y1, y3, y6</dt><dd><p>ordinal response at the post-baseline week 1, 3, and 6.</p>
</dd>
</dl>



<h3>Source</h3>

<p>long-to-wise tranformation of schizo data, i.e. schizow = data.table::dcast(schizo, id + tx ~ week, value.var = &quot;imps79o&quot;)
</p>

<hr>
<h2 id='summary'>Summarize the results from an object of class remiod</h2><span id='topic+summary'></span><span id='topic+summary.remiod'></span><span id='topic+print.summary.remiod'></span><span id='topic+coef.summary.remiod'></span>

<h3>Description</h3>

<p>Obtain and print the <code>summary</code>, (fixed effects) coefficients
(<code>coef</code>) and credible interval (<code>confint</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(object, ...)

## S3 method for class 'remiod'
summary(object, start = NULL, end = NULL, thin = NULL,
  quantiles = c(0.025, 0.975), outcome = NULL, exclude_chains = NULL,
  warn = TRUE, mess = TRUE, ...)

## S3 method for class 'summary.remiod'
print(x, digits = 3, ...)

## S3 method for class 'summary.remiod'
coef(object, start = NULL, end = NULL,
  thin = NULL, subset = NULL, exclude_chains = NULL, warn = TRUE,
  mess = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>object inheriting from class 'remoid'</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>additional, optional arguments
</p>

<dl>
<dt><code>trunc</code></dt><dd><p>named list specifying limits of truncation for the
distribution of the named incomplete variables (see the
vignette
<a href="https://nerler.github.io/JointAI/articles/ModelSpecification.html#functions-with-restricted-support">ModelSpecification</a>)</p>
</dd>
<dt><code>hyperpars</code></dt><dd><p>list of hyper-parameters, as obtained by
<code><a href="JointAI.html#topic+default_hyperpars">default_hyperpars</a>()</code></p>
</dd>
<dt><code>scale_vars</code></dt><dd><p>named vector of (continuous) variables that
will be centred and scaled (such that mean = 0 and sd = 1)
when they enter a linear predictor to improve
convergence of the MCMC sampling. Default is that all
numeric variables and integer variables with &gt;20 different
values will be scaled.
If set to <code>FALSE</code> no scaling will be done.</p>
</dd>
<dt><code>custom</code></dt><dd><p>named list of JAGS model chunks (character strings)
that replace the model for the given variable.</p>
</dd>
<dt><code>append_data_list</code></dt><dd><p>list that will be appended to the list
containing the data that is passed to <strong>rjags</strong>
(<code>data_list</code>). This may be necessary if additional data /
variables are needed for custom (covariate) models.</p>
</dd>
<dt><code>progress.bar</code></dt><dd><p>character string specifying the type of
progress bar. Possible values are &quot;text&quot; (default), &quot;gui&quot;,
and &quot;none&quot; (see <code><a href="rjags.html#topic+update">update</a></code>). Note: when
sampling is performed in parallel it is not possible to
display a progress bar.</p>
</dd>
<dt><code>quiet</code></dt><dd><p>logical; if <code>TRUE</code> then messages generated by
<strong>rjags</strong> during compilation as well as the progress bar
for the adaptive phase will be suppressed,
(see <code><a href="rjags.html#topic+jags.model">jags.model</a></code>)</p>
</dd>
<dt><code>keep_scaled_mcmc</code></dt><dd><p>should the &quot;original&quot; MCMC sample (i.e.,
the scaled version returned by <code>coda.samples()</code>) be
kept? (The MCMC sample that is re-scaled to the scale of the
data is always kept.)</p>
</dd>
<dt><code>modelname</code></dt><dd><p>character string specifying the name of the
model file (including the ending, either .R or .txt). If
unspecified a random name will be generated.</p>
</dd>
<dt><code>modeldir</code></dt><dd><p>directory containing the model file or directory
in which the model file should be written. If unspecified a
temporary directory will be created.</p>
</dd>
<dt><code>overwrite</code></dt><dd><p>logical; whether an existing model file with
the specified <code>&lt;modeldir&gt;/&lt;modelname&gt;</code> should be
overwritten. If set to <code>FALSE</code> and a model already
exists, that model will be used. If unspecified (<code>NULL</code>)
and a file exists, the user is asked for input on how to
proceed.</p>
</dd>
<dt><code>keep_model</code></dt><dd><p>logical; whether the created JAGS model file
should be saved or removed from (<code>FALSE</code>; default) when
the sampling has finished.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="summary_+3A_start">start</code></td>
<td>
<p>the first iteration of interest
(see <code><a href="coda.html#topic+window.mcmc">window.mcmc</a></code>)</p>
</td></tr>
<tr><td><code id="summary_+3A_end">end</code></td>
<td>
<p>the last iteration of interest
(see <code><a href="coda.html#topic+window.mcmc">window.mcmc</a></code>)</p>
</td></tr>
<tr><td><code id="summary_+3A_thin">thin</code></td>
<td>
<p>thinning interval (integer; see <code><a href="coda.html#topic+window.mcmc">window.mcmc</a></code>).
For example, <code>thin = 1</code> (default) will keep the MCMC samples
from all iterations; <code>thin = 5</code> would only keep every 5th
iteration.</p>
</td></tr>
<tr><td><code id="summary_+3A_quantiles">quantiles</code></td>
<td>
<p>posterior quantiles</p>
</td></tr>
<tr><td><code id="summary_+3A_outcome">outcome</code></td>
<td>
<p>specify outcome variable to select imputation model(s) to summarize.
Default generates summaries for all models.</p>
</td></tr>
<tr><td><code id="summary_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of the index numbers of chains that
should be excluded</p>
</td></tr>
<tr><td><code id="summary_+3A_warn">warn</code></td>
<td>
<p>logical; should warnings be given? Default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="summary_+3A_mess">mess</code></td>
<td>
<p>logical; should messages be given? Default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="summary_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.remiod</code></p>
</td></tr>
<tr><td><code id="summary_+3A_digits">digits</code></td>
<td>
<p>the minimum number of significant digits to be printed in values.</p>
</td></tr>
<tr><td><code id="summary_+3A_subset">subset</code></td>
<td>
<p>subset of parameters/variables/nodes (columns in the MCMC
sample). Follows the same principle as the argument
<code>monitor_params</code> and <code>selected_parms</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>summary information, including parameter posterior mean, posterior SD,
quantiles, tail probability <code>tail-prob</code>,  Gelman-Rubin criterion
<code>GR-crit</code>, the ratio of the Monte Carlo error and posterior standard
deviation) for specified parameters <code>MCE/SD</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# data(schizow)

test = remiod(formula = y6 ~ tx + y0 + y1 + y3, data = schizow,
              trtvar = 'tx', algorithm = 'jags', method="MAR",
              ord_cov_dummy = FALSE, n.adapt = 50, n.chains = 1,
              n.iter = 50, thin = 2, warn = FALSE, seed = 1234)

summary(object = test, outcome = c("y6","y3"))


</code></pre>

<hr>
<h2 id='tang_MI_RB'>Implement controlled multiple imputation algorithms proposed by Tang</h2><span id='topic+tang_MI_RB'></span>

<h3>Description</h3>

<p>Internal function, creates multiple imputed datasets based on assigned
imputation method with the algorithm of Tang's sequential modeling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tang_MI_RB(object, dtimp, treatment, method = "MAR", delta = 0,
  ord_cov_dummy = FALSE, exclude_chains = NULL, include = FALSE,
  thin = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tang_MI_RB_+3A_object">object</code></td>
<td>
<p>object inheriting from class 'remoid'</p>
</td></tr>
<tr><td><code id="tang_MI_RB_+3A_dtimp">dtimp</code></td>
<td>
<p>imputed complete data sets from <code>remiod</code> function.</p>
</td></tr>
<tr><td><code id="tang_MI_RB_+3A_treatment">treatment</code></td>
<td>
<p>name of the treatment variable.</p>
</td></tr>
<tr><td><code id="tang_MI_RB_+3A_method">method</code></td>
<td>
<p>a method for obtaining multiple-imputed dataset. Options include
<code>MAR</code>, <code>J2R</code>, <code>CR</code>, and <code>delta</code> adjustment.
Default is MAR.</p>
</td></tr>
<tr><td><code id="tang_MI_RB_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="tang_MI_RB_+3A_ord_cov_dummy">ord_cov_dummy</code></td>
<td>
<p>optional. specify whether ordinal variables should be treated as
categorical variables or continuous variables when they are
included as covariates in the sequential imputation models.
Default is <code>TRUE</code>, dummy variables will be created accordingly.</p>
</td></tr>
<tr><td><code id="tang_MI_RB_+3A_exclude_chains">exclude_chains</code></td>
<td>
<p>optional vector of the index numbers of chains that
should be excluded</p>
</td></tr>
<tr><td><code id="tang_MI_RB_+3A_include">include</code></td>
<td>
<p>logical, if TRUE, raw data will be included in imputed data sets
with imputation ID = 0.</p>
</td></tr>
<tr><td><code id="tang_MI_RB_+3A_thin">thin</code></td>
<td>
<p>thinning to be applied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>multiple imputed datasets stacked onto each other (i.e., long format;
optionally including the original incomplete data).<br />
The variable <code>Imputation_</code> indexes the imputation, while
<code>.rownr</code> links the rows to the rows of the original data.
In cross-sectional datasets the
variable <code>.id</code> is added as subject identifier.
</p>

<hr>
<h2 id='updateMI'>Apply a MI method following initial run of <code>remoid</code> function</h2><span id='topic+updateMI'></span>

<h3>Description</h3>

<p>Apply a MI method following initial run of <code>remoid</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateMI(object, method = c("MAR", "J2R", "CR", "delta"), delta = 0,
  mi.setting = NULL, mess = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateMI_+3A_object">object</code></td>
<td>
<p>object inheriting from class <code>remoid</code>.</p>
</td></tr>
<tr><td><code id="updateMI_+3A_method">method</code></td>
<td>
<p>a method for obtaining multiple-imputed dataset. Options include
<code>MAR</code>, <code>J2R</code>, <code>CR</code>, and <code>delta</code> adjustment.
Default is MAR.</p>
</td></tr>
<tr><td><code id="updateMI_+3A_delta">delta</code></td>
<td>
<p>specific value used for Delta adjustment, applicable only
for method=&quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="updateMI_+3A_mi.setting">mi.setting</code></td>
<td>
<p>a list of arguments for extracting MI data set, which
will be used to update the one in <code>remoid</code> object.
Default is NULL, meaning no update to the mi.setting
in <code>remoid</code> object.</p>
</td></tr>
<tr><td><code id="updateMI_+3A_mess">mess</code></td>
<td>
<p>logical; should messages be given? Default is TRUE.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
